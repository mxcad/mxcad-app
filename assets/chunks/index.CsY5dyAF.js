import{aC as h,O as B,aD as f,aE as H,aF as j,aG as Z,aH as $,aw as U,ax as c,aI as u,au as J,K,t as R,b as L,j as E,m as T,aJ as G,y as O,D as X,w as Y}from"./lib.DTykjivu.js";import{d as q,h as N,al as Q,D as g,b as W,o as ee,w as a,m as r,H as l,p as s,aw as P,a as V,t as v}from"./framework.BMMljfWr.js";import"./commonjsHelpers.Cpj98o6Y.js";const te={class:"px-3"},le={class:"d-flex algin-center mt-2 w-75"},ae={class:""},oe={class:""},se={class:""},ne={class:""},pe=q({__name:"index",setup(ie){const{isShow:A,showDialog:S}=h,k=N(1),d=Q({x:0,y:0}),w=B(!1,"Mx_AttachPictureDialog_isGetPt"),b=B(!1,"Mx_AttachPictureDialog_isGetZoomRatio"),y=B(!1,"Mx_AttachPictureDialog_isGetRotationAngle"),_=N(1),x=N(0),z=[{name:"确定",fun:async()=>{if(!f.value)return;if(f.value.url==="")return K().warning(R("请先选择图片"));S(!1);const n=L.getCurrentMxCAD();if(w.value){const o=new E;o.setMessage(R("指定插入点"));const i=await o.go();if(!i)return;d.x=i.x,d.y=i.y}if(b.value){const o=new E,i=new T(d.x,d.y);o.setBasePt(i),o.setMessage(R("指定缩放比例")),o.setUserDraw((D,p)=>{const C=D.distanceTo(i)/u.width,I=u.width*C,t=u.height*C,F=new THREE.Vector3(i.x+I,i.y+t);p.drawRect(i.toVector3(),F)});const m=await o.go();if(!m)return;_.value=G(m.distanceTo(i)/u.width,3)}if(y.value){const o=new O;o.setMessage(R("指定旋转角度"));const i=new T(d.x,d.y);o.setBasePt(i);const m=await o.go();if(!m)return;o.getDetailedResult()===X.kCoordIn?x.value=G(m,3):x.value=G(m/(Math.PI/180),3)}let M=n.drawImage(d.x,d.y,u.width*_.value,u.height*_.value,x.value,f.value.fileName||f.value.url,!0,u.width,u.height).getMcDbEntity();if(M){const o=M.trueColor;M.trueColor=new Y(o.red,o.green,o.blue,k.value*255)}},primary:!0},{name:"关闭",fun:()=>S(!1)}];return(n,e)=>{const M=g("v-combobox"),o=g("v-icon"),i=g("v-img"),m=g("v-col"),D=g("v-checkbox"),p=g("v-text-field"),C=g("v-slider"),I=g("v-row");return ee(),W(J,{title:n.t("附着图片"),modelValue:s(A),"onUpdate:modelValue":e[13]||(e[13]=t=>P(A)?A.value=t:null),"max-width":"600",footerBtnList:z},{default:a(()=>[r("div",te,[r("div",le,[l(M,{class:"mt-1 mr-2","return-object":"","item-title":"fileName","item-value":"url",items:s(j),modelValue:s(f),"onUpdate:modelValue":[e[0]||(e[0]=t=>P(f)?f.value=t:null),e[1]||(e[1]=t=>s(H)(t))],modelModifiers:{lazy:!0}},{prepend:a(()=>[r("span",ae,[V(v(n.t("名称"))+"(",1),e[14]||(e[14]=r("span",{class:"text-decoration-underline"},"N",-1)),e[15]||(e[15]=V(") ",-1))])]),_:1},8,["items","modelValue"]),l(Z,{onClick:e[2]||(e[2]=t=>s($)(s(h)))},{default:a(()=>[l(U,{"key-name":"B"},{default:a(()=>[V(v(n.t("浏览")),1)]),_:1}),e[16]||(e[16]=V()),l(o,{icon:"class:iconfont more"})]),_:1})]),l(I,{"align-stretch":"",class:"mt-2"},{default:a(()=>[l(m,{cols:8,"align-self":"auto"},{default:a(()=>[l(c,{title:n.t("预览"),class:"h-100"},{default:a(()=>{var t;return[l(i,{src:(t=s(f))==null?void 0:t.url,crossorigin:"anonymous",height:"425px"},null,8,["src"])]}),_:1},8,["title"])]),_:1}),l(m,{cols:4,"align-self":"auto"},{default:a(()=>[l(c,{title:n.t("插入点")},{default:a(()=>[l(D,{modelValue:s(w),"onUpdate:modelValue":e[3]||(e[3]=t=>P(w)?w.value=t:null)},{label:a(()=>[l(U,{"key-name":"S"},{default:a(()=>[V(v(n.t("在屏幕上指定")),1)]),_:1})]),_:1},8,["modelValue"]),l(p,{class:"mt-1",modelValue:d.x,"onUpdate:modelValue":e[4]||(e[4]=t=>d.x=t),disabled:s(w)},{prepend:a(()=>[...e[17]||(e[17]=[r("span",{class:""}," X:",-1)])]),_:1},8,["modelValue","disabled"]),l(p,{class:"mt-1",modelValue:d.y,"onUpdate:modelValue":e[5]||(e[5]=t=>d.y=t),disabled:s(w)},{prepend:a(()=>[...e[18]||(e[18]=[r("span",{class:""}," Y:",-1)])]),_:1},8,["modelValue","disabled"])]),_:1},8,["title"]),l(c,{title:n.t("缩放比例")},{default:a(()=>[l(D,{modelValue:s(b),"onUpdate:modelValue":e[6]||(e[6]=t=>P(b)?b.value=t:null)},{label:a(()=>[l(U,{"key-name":"S"},{default:a(()=>[V(v(n.t("在屏幕上指定")),1)]),_:1})]),_:1},8,["modelValue"]),l(p,{class:"mt-1 ml-1",type:"number",disabled:s(b),modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=t=>_.value=t)},null,8,["disabled","modelValue"])]),_:1},8,["title"]),l(c,{title:n.t("图像高度")},{default:a(()=>[l(p,{class:"mt-1",type:"number",modelValue:s(u).width,"onUpdate:modelValue":e[8]||(e[8]=t=>s(u).width=t)},{prepend:a(()=>[r("span",oe,v(n.t("宽度"))+":",1)]),_:1},8,["modelValue"]),l(p,{class:"mt-1",type:"number",modelValue:s(u).height,"onUpdate:modelValue":e[9]||(e[9]=t=>s(u).height=t)},{prepend:a(()=>[r("span",se,v(n.t("高度"))+":",1)]),_:1},8,["modelValue"])]),_:1},8,["title"]),l(c,{title:n.t("旋转角度")},{default:a(()=>[l(D,{class:"",modelValue:s(y),"onUpdate:modelValue":e[10]||(e[10]=t=>P(y)?y.value=t:null)},{label:a(()=>[l(U,{"key-name":"S"},{default:a(()=>[V(v(n.t("在屏幕上指定")),1)]),_:1})]),_:1},8,["modelValue"]),l(p,{class:"mt-1",type:"number",modelValue:x.value,"onUpdate:modelValue":e[11]||(e[11]=t=>x.value=t),disabled:s(y)},{prepend:a(()=>[r("span",ne,v(n.t("角度"))+":",1)]),_:1},8,["modelValue","disabled"])]),_:1},8,["title"]),l(c,{title:n.t("透明度")},{default:a(()=>[l(C,{modelValue:k.value,"onUpdate:modelValue":e[12]||(e[12]=t=>k.value=t),max:1,min:0,step:.2,"thumb-label":""},null,8,["modelValue"])]),_:1},8,["title"])]),_:1})]),_:1})])]),_:1},8,["title","modelValue"])}}});export{pe as default};
