import{ce as V,Y as h,e as _,p as b,f as A,t as w,a8 as v,b as D,aj as P,cf as U,cg as S,j as k,$ as R,E as B,m as H,ax as N,au as j}from"./lib.DTykjivu.js";import{h as y,d as F,v as L,D as T,b as X,o as Y,w as x,m as f,H as g,aw as m,p as M,t as C}from"./framework.BMMljfWr.js";import"./commonjsHelpers.Cpj98o6Y.js";const l=y(""),r=y(0),{isShow:c,showDialog:p,confirm:z,onReveal:G,onConfirm:E}=V;G((e={})=>{typeof e.text=="string"&&(l.value=e.text),typeof e.angle=="number"&&(r.value=h(THREE.MathUtils.radToDeg(e.angle),2))});const I=async()=>{const e=new k;e.setMessage(w("指定文字起点")+":"),e.setCursorType(R.kCross);const o=await e.go();if(!o)return;let i=new B;i.setMessage(w("指定文字高度")+":");let t=await i.go();if(t===null)return;const{off:n}=E(s=>{let a=new v;a.textString=s.text,a.position=new H(o),a.alignmentPoint=a.position,a.height=t,a.rotation=s.angle,D.getCurrentMxCAD().drawEntity(a),D.getCurrentMxCAD().updateDisplay(),n()});await p(!0,{text:"测试"}),n()},O=async()=>{let e=new b;e.AddMcDbEntityTypes("TEXT,MTEXT,CUSTOMENTITY");let o=new A;o.setFilter(e),o.setMessage(w("选择要编辑的文字"));let i=await o.go();if(!i.isValid())return;let t=i.getMcDbEntity();if(t)if(t instanceof v){const n=t.textString,s=t.rotation,{off:a}=E(d=>{t.textString=d.text,t.rotation=d.angle,D.getCurrentMxCAD().updateDisplay(),a()});await p(!0,{text:n,angle:s}),a()}else(t instanceof P||t instanceof U)&&S(i,o.pickPoint())};_("Mx_EditText",O);_("_DrawText",()=>{I()});const $={class:"px-3"},q={class:"px-2"},J={class:""},K={class:""},tt=F({__name:"index",setup(e){L(c,n=>{n||(l.value="",r.value=0)});const o=()=>{z({text:l.value,angle:THREE.MathUtils.degToRad(r.value)}),l.value=""},i=[{name:"确定",fun:()=>{o()},primary:!0},{name:"关闭",fun:()=>p(!1)}],t={esc:()=>p(!1),enter:()=>{o()}};return(n,s)=>{const a=T("v-textarea"),d=T("v-text-field");return Y(),X(j,{title:n.t("单行文字"),"max-width":"480",modelValue:M(c),"onUpdate:modelValue":s[2]||(s[2]=u=>m(c)?c.value=u:null),footerBtnList:i,persistent:"",keys:t},{default:x(()=>[f("div",$,[g(N,{title:n.t("文字参数")},{default:x(()=>[f("div",q,[g(a,{class:"mt-1",modelValue:M(l),"onUpdate:modelValue":s[0]||(s[0]=u=>m(l)?l.value=u:null),autofocus:"",rows:"3","no-resize":""},{prepend:x(()=>[f("span",J,C(n.t("文字内容"))+":",1)]),_:1},8,["modelValue"]),g(d,{class:"mt-1 w-50",modelValue:M(r),"onUpdate:modelValue":s[1]||(s[1]=u=>m(r)?r.value=u:null),type:"number"},{prepend:x(()=>[f("span",K,C(n.t("旋转角度"))+":",1)]),_:1},8,["modelValue"])])]),_:1},8,["title"])])]),_:1},8,["title","modelValue"])}}});export{tt as default};
