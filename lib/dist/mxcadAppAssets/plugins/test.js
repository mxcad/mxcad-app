var qU=Object.defineProperty,XU=Object.defineProperties;var YU=Object.getOwnPropertyDescriptors;var ZA=Object.getOwnPropertySymbols;var KU=Object.prototype.hasOwnProperty,ZU=Object.prototype.propertyIsEnumerable;var JA=(Ct,A)=>{if(A=Symbol[Ct])return A;throw Error("Symbol."+Ct+" is not defined")},rx=Math.pow,$A=(Ct,A,k)=>A in Ct?qU(Ct,A,{enumerable:!0,configurable:!0,writable:!0,value:k}):Ct[A]=k,wi=(Ct,A)=>{for(var k in A||(A={}))KU.call(A,k)&&$A(Ct,k,A[k]);if(ZA)for(var k of ZA(A))ZU.call(A,k)&&$A(Ct,k,A[k]);return Ct},Il=(Ct,A)=>XU(Ct,YU(A));var re=(Ct,A,k)=>new Promise((wn,os)=>{var po=Ai=>{try{Mi(k.next(Ai))}catch(Bo){os(Bo)}},$i=Ai=>{try{Mi(k.throw(Ai))}catch(Bo){os(Bo)}},Mi=Ai=>Ai.done?wn(Ai.value):Promise.resolve(Ai.value).then(po,$i);Mi((k=k.apply(Ct,A)).next())}),m1=function(Ct,A){this[0]=Ct,this[1]=A},QA=(Ct,A,k)=>{var wn=($i,Mi,Ai,Bo)=>{try{var Oa=k[$i](Mi),Op=(Mi=Oa.value)instanceof m1,Ll=Oa.done;Promise.resolve(Op?Mi[0]:Mi).then(Ts=>Op?wn($i==="return"?$i:"next",Mi[1]?{done:Ts.done,value:Ts.value}:Ts,Ai,Bo):Ai({value:Ts,done:Ll})).catch(Ts=>wn("throw",Ts,Ai,Bo))}catch(Ts){Bo(Ts)}},os=$i=>po[$i]=Mi=>new Promise((Ai,Bo)=>wn($i,Mi,Ai,Bo)),po={};return k=k.apply(Ct,A),po[Symbol.asyncIterator]=()=>po,os("next"),os("throw"),os("return"),po};var g1=(Ct,A,k)=>(A=Ct[JA("asyncIterator")])?A.call(Ct):(Ct=Ct[JA("iterator")](),A={},k=(wn,os)=>(os=Ct[wn])&&(A[wn]=po=>new Promise(($i,Mi,Ai)=>(po=os.call(Ct,po),Ai=po.done,Promise.resolve(po.value).then(Bo=>$i({value:Bo,done:Ai}),Mi)))),k("next"),k("return"),A);(function(Ct,A,k,wn,os){"use strict";var po=document.createElement("style");po.textContent=`.heading[data-v-a388a3ba]{font-size:1.5em;margin-bottom:12px}.card[data-v-a388a3ba]{background:#fff;color:#000;background-image:linear-gradient(48deg,#fff 0%,#e5efe9 100%);border-top-right-radius:16px;border-bottom-left-radius:16px;box-shadow:-20px 20px 35px 1px #0a31562e;display:flex;flex-direction:column;padding:32px;margin:40px;max-width:400px;width:100%}.card .btnEn[data-v-a388a3ba]{font-size:.7em}.content-wrapper[data-v-a388a3ba]{font-size:1.1em;margin-bottom:44px}.content-wrapper[data-v-a388a3ba]:last-child{margin-bottom:0}.button[data-v-a388a3ba]{align-items:center;background:#e5efe9;border:1px solid #5a72b5;border-radius:4px;color:#121943;cursor:pointer;display:flex;font-size:1em;font-weight:700;height:40px;justify-content:center;width:180px}.button[data-v-a388a3ba]:focus{border:2px solid transparent;box-shadow:0 0 0 2px #121943;outline:solid 4px transparent}.link[data-v-a388a3ba]{color:#121943}.link[data-v-a388a3ba]:focus{box-shadow:0 0 0 2px #121943}.input-wrapper[data-v-a388a3ba]{display:flex;flex-direction:column}.input-wrapper .label[data-v-a388a3ba]{align-items:baseline;display:flex;font-weight:700;justify-content:space-between;margin-bottom:8px}.input-wrapper .optional[data-v-a388a3ba]{color:#5a72b5;font-size:.9em}.input-wrapper .input[data-v-a388a3ba]{border:1px solid #5a72b5;border-radius:4px;height:40px;padding:8px}code[data-v-a388a3ba]{background:#e5efe9;border:1px solid #5a72b5;border-radius:4px;padding:2px 4px}.modal-header[data-v-a388a3ba]{align-items:baseline;display:flex;justify-content:space-between}.close[data-v-a388a3ba]{background:none;border:none;cursor:pointer;display:flex;height:16px;text-decoration:none;width:16px}.close svg[data-v-a388a3ba]{width:16px}.modal-wrapper[data-v-a388a3ba]{align-items:center;background:rgba(0,0,0,.7);display:flex;justify-content:center;inset:0;position:fixed}#modal[data-v-a388a3ba]{transition:opacity .25s ease-in-out}#modal .modal-body[data-v-a388a3ba]{max-width:830px;opacity:1;transform:translateY(-100px);transition:opacity .25s ease-in-out;width:100%;z-index:1}.outside-trigger[data-v-a388a3ba]{cursor:default;inset:0;position:fixed}.button__link[data-v-a388a3ba]{text-decoration:none}.button[data-v-a388a3ba]{background-color:#4caf50;border:none;color:#fff;text-align:center;text-decoration:none;font-size:16px;margin:4px 2px;-webkit-transition-duration:.4s;transition-duration:.4s;cursor:pointer;overflow:hidden;min-width:0;display:flex;align-items:center;justify-content:center}.button1[data-v-a388a3ba]{background-color:#fff;color:#000;border:2px solid #4caf50}.button1[data-v-a388a3ba]:hover{background-color:#4caf50;color:#fff}.button2[data-v-a388a3ba]{background-color:#fff;color:#000;border:2px solid #008cba}.button2[data-v-a388a3ba]:hover{background-color:#008cba;color:#fff}.btn_box[data-v-a388a3ba]{width:100%;display:flex;justify-items:center;justify-content:start;align-items:start}.btn span[data-v-a388a3ba],.button span[data-v-a388a3ba],.btn[data-v-a388a3ba],.button[data-v-a388a3ba]{display:block;align-items:center;justify-content:center;font-size:clamp(5px,1vw,1em);max-width:100%;max-height:100%;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:normal;padding:0 8px;min-width:0}.heading[data-v-9f9a60cf]{font-size:1.5em;margin-bottom:12px}.btn[data-v-9f9a60cf]{height:40px;width:100px;text-align:center;line-height:40px;font-size:1em;font-weight:700;overflow:hidden;position:relative;white-space:nowrap;text-overflow:ellipsis}.btn2[data-v-9f9a60cf]{background-color:#008cba;color:#fff;border-top-right-radius:4px;border-top-left-radius:4px}.card[data-v-9f9a60cf]{background:#fff;color:#000;background-image:linear-gradient(48deg,#fff 0%,#e5efe9 100%);border-top-right-radius:16px;border-bottom-left-radius:16px;box-shadow:-20px 20px 35px 1px #0a31562e;display:flex;flex-direction:column;padding:32px;margin:40px;max-width:400px;width:100%;height:600px}.card .btnEn[data-v-9f9a60cf]{font-size:.7em}.content-wrapper[data-v-9f9a60cf]{font-size:1.1em;margin-bottom:44px}.content-wrapper[data-v-9f9a60cf]:last-child{margin-bottom:0}.button[data-v-9f9a60cf]{align-items:center;background:#e5efe9;border:1px solid #5a72b5;border-radius:4px;color:#121943;cursor:pointer;display:flex;font-size:1em;font-weight:700;height:40px;justify-content:center;width:180px;overflow:hidden;position:relative;white-space:nowrap;text-overflow:ellipsis}.button[data-v-9f9a60cf]:focus{border:2px solid transparent;box-shadow:0 0 0 2px #121943;outline:solid 4px transparent}.link[data-v-9f9a60cf]{color:#121943}.link[data-v-9f9a60cf]:focus{box-shadow:0 0 0 2px #121943}.input-wrapper[data-v-9f9a60cf]{display:flex;flex-direction:column}.input-wrapper .label[data-v-9f9a60cf]{align-items:baseline;display:flex;font-weight:700;justify-content:space-between;margin-bottom:8px}.input-wrapper .optional[data-v-9f9a60cf]{color:#5a72b5;font-size:.9em}.input-wrapper .input[data-v-9f9a60cf]{border:1px solid #5a72b5;border-radius:4px;height:40px;padding:8px}code[data-v-9f9a60cf]{background:#e5efe9;border:1px solid #5a72b5;border-radius:4px;padding:2px 4px}.modal-header[data-v-9f9a60cf]{align-items:baseline;display:flex;justify-content:space-between}.close[data-v-9f9a60cf]{background:none;border:none;cursor:pointer;display:flex;height:16px;text-decoration:none;width:16px}.close svg[data-v-9f9a60cf]{width:16px}.modal-wrapper[data-v-9f9a60cf]{align-items:center;background:rgba(0,0,0,.7);display:flex;justify-content:center;inset:0;position:fixed}#modal[data-v-9f9a60cf]{transition:opacity .25s ease-in-out}#modal .modal-body[data-v-9f9a60cf]{max-width:830px;opacity:1;transform:translateY(-100px);transition:opacity .25s ease-in-out;width:100%;z-index:1}.outside-trigger[data-v-9f9a60cf]{cursor:default;inset:0;position:fixed}.button__link[data-v-9f9a60cf]{text-decoration:none}.button[data-v-9f9a60cf]{background-color:#4caf50;border:none;color:#fff;text-align:center;text-decoration:none;display:inline-block;font-size:16px;margin:4px 2px;-webkit-transition-duration:.4s;transition-duration:.4s;cursor:pointer}.button1[data-v-9f9a60cf]{background-color:#fff;color:#000;border:2px solid #4CAF50}.button1[data-v-9f9a60cf]:hover{background-color:#4caf50;color:#fff}.button2[data-v-9f9a60cf]{background-color:#fff;color:#000;border:2px solid #008CBA}.button2[data-v-9f9a60cf]:hover{background-color:#008cba;color:#fff}.btn_box[data-v-9f9a60cf]{width:100%;display:flex;justify-items:center;justify-content:start;align-items:start}.textBox[data-v-9f9a60cf]{position:absolute;top:30%;left:42%;background-image:linear-gradient(48deg,#fff 0%,#e5efe9 100%);color:#000;padding:10px 15px}.textBox .header[data-v-9f9a60cf]{display:flex;justify-content:space-between;align-items:center}.textBox textarea[data-v-9f9a60cf]{color:#000;background-color:#ccc;border:1px solid #5a72b5;border-radius:8px;margin-top:10px;font-size:var(--mx-font-size);padding:5px}.textBox .btnBox[data-v-9f9a60cf]{display:flex;justify-content:flex-end}.textBox .btnBox button[data-v-9f9a60cf]{background-color:#fff;color:#000;border:2px solid #008CBA;border-radius:5px;padding:5px;margin-top:10px}.textBox .btnBox button[data-v-9f9a60cf]:hover{background-color:#008cba;color:#fff}.btn span[data-v-9f9a60cf],.button span[data-v-9f9a60cf],.btn[data-v-9f9a60cf],.button[data-v-9f9a60cf]{display:block;align-items:center;justify-content:center;font-size:clamp(5px,1vw,1em);max-width:100%;max-height:100%;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:normal;padding:0 8px;min-width:0}.fcc[data-v-a83034f6]{display:flex;align-items:center;justify-content:center}.row[data-v-fff1a9fd]{display:flex;justify-content:space-between;align-items:center}.row .item[data-v-fff1a9fd]{padding:5px;width:45px;height:45px}.row .item[data-v-fff1a9fd]:hover,.row .backColor[data-v-fff1a9fd]{background-color:#fff3}.inLine[data-v-ef6011f8]{max-height:20px;overflow:hidden}.fcb[data-v-ef6011f8]{display:flex;align-items:center;justify-content:space-between}.fcb .symbolBox[data-v-ef6011f8]{display:flex;position:relative;width:40%;height:120px;border:1px solid #ccc;padding:5px}.fcb .symbolBox .symbol[data-v-ef6011f8]{position:absolute;padding:2px;top:-10px;left:10px;background-color:rgb(var(--v-theme-dialog-card-text))}.fcb .symbolBox .symbolImg[data-v-ef6011f8]{margin-top:12px;margin-right:5px;padding:5px;height:35px}.fcb .symbolBox .symbolImg[data-v-ef6011f8]:hover,.fcb .symbolBox .backColor[data-v-ef6011f8]{background-color:rgba(var(--v-theme-on-prominent),.2)}.formBox[data-v-ef6011f8]{height:250px;width:100%;border:1px solid #ccc;position:relative}.formBox .iconFont[data-v-ef6011f8]{position:absolute;width:32%;left:73px;top:50px}.formBox .iconFont .icon[data-v-ef6011f8]{width:100%}.formBox .topData[data-v-ef6011f8]{position:absolute;right:5px;top:7px;width:40%}.formBox .line[data-v-ef6011f8]{position:absolute;left:180px;top:82px;width:50%;height:4px;background-color:rgb(var(--v-theme-on-prominent))}.formBox .bottomData[data-v-ef6011f8]{position:absolute;width:25%;top:90px;right:36px}.formBox .cornerData[data-v-ef6011f8]{position:absolute;bottom:65px;right:235px}.formBox .cornerData .cornerIcon[data-v-ef6011f8]{height:25px;min-width:25px;padding:0}.formBox .cornerData .btnList[data-v-ef6011f8]{position:absolute;display:flex;width:120px;height:60px;flex-wrap:wrap;justify-content:space-around;top:30px}.formBox .leftDate[data-v-ef6011f8]{position:absolute;width:24%;bottom:75px;left:5px}.imgBox[data-v-a986481d]{width:100px;height:50px;background-color:#000;display:flex;justify-content:center;align-items:center;margin-bottom:10px}.radio[data-v-a986481d]{width:100%;display:flex;justify-content:space-between;align-items:center}.fbc[data-v-253ca580]{display:flex;justify-content:space-between;align-items:center}.btnBox[data-v-253ca580]{border:1px solid rgba(var(--v-border-color),var(--v-border-opacity));position:relative;padding:10px 0;margin-top:20px;align-items:center;justify-content:center}.btnBox .tiltle[data-v-253ca580]{display:block;position:absolute;top:-10px;left:5px}.row[data-v-253ca580]{display:flex}.item[data-v-253ca580]{height:35px;width:35px;padding:5px}.item img[data-v-253ca580]{height:25px;width:25px}.itemHover[data-v-253ca580]:hover,.checked[data-v-253ca580]{background-color:#89cbfa99}.btn[data-v-253ca580]{position:absolute;bottom:16px;right:204px;background-color:rgb(var(--v-theme-undertint-bg))!important;min-width:76px}.fbc[data-v-13e7c51f]{display:flex;justify-content:space-between;align-items:center}.btnBox[data-v-13e7c51f]{border:1px solid rgba(var(--v-border-color),var(--v-border-opacity));position:relative;padding:10px 0;margin-top:20px}.btnBox .tiltle[data-v-13e7c51f]{display:block;position:absolute;top:-10px;left:5px}.row[data-v-13e7c51f]{display:flex}.item[data-v-13e7c51f]{height:35px;width:35px;padding:5px}.item img[data-v-13e7c51f]{height:25px;width:25px}.itemHover[data-v-13e7c51f]:hover,.checked[data-v-13e7c51f]{background-color:#89cbfa99}.btn[data-v-13e7c51f]{position:absolute;bottom:16px;right:204px;background-color:rgb(var(--v-theme-undertint-bg))!important;min-width:76px}.checkBtn[data-v-13e7c51f]{background-color:#89cbfa66}.contents[data-v-7d640c71]{padding:5px}.contents .tips[data-v-7d640c71]{opacity:.6}
`,document.head.appendChild(po);const $i=k.ref(!1),Mi=k.ref(!1),Ai=t=>{$i.value=!0,Mi.value=!1,Ll.value=Object.assign(Ll.value,t||{})},Bo=t=>{Mi.value=!0,$i.value=!1,Ll.value=Object.assign(Ll.value,t||{})},Oa=()=>{$i.value=!1,Mi.value=!1},Op={title:"Modal",text:"",oncancel:Oa,onsubmit:Oa,ongetallentity:Oa,ondrawline:Oa,docommand:t=>{}},Ll=k.ref(Op),Ts=k.ref(!1),ix=k.ref(""),zp=k.ref("");document.addEventListener("mouseup",function(){zp.value=document.getSelection().toString(),zp.value===""&&(zp.value=ix.value)});function nS(){return re(this,null,function*(){try{yield navigator.clipboard.writeText(zp.value)}catch(t){console.error("Failed to copy: ",t)}})}const Up=()=>({isModalVisible:$i,isToolsVisible:Mi,isDialogVisible:Ts,showModal:Ai,showTools:Bo,hideModal:Oa,modalOptions:Ll,excelText:ix,copyTextToClipboard:nS}),rS="modulepreload",iS=function(t){return"/"+t},ox={},b1=function(n,e,i){return n()};var sx=Object.defineProperty,oS=(t,n,e)=>n in t?sx(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,an=(t,n)=>sx(t,"name",{value:n,configurable:!0}),Yo=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(n,e)=>(typeof require<"u"?require:n)[e]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),Jr=(t,n,e)=>oS(t,typeof n!="symbol"?n+"":n,e),Vp,ax=(Vp=class{constructor(t){this._listeners=new Map,this._lastMessage={},this.options=Object.assign({ignoreError:!1},t)}get listeners(){return this._listeners}on(){let t=arguments[0],n=arguments[1],e=arguments[2],{objectify:i=!0,count:s=-1}=Object.assign({},e);this._listeners.has(t)||this._listeners.set(t,new Map);let a=++Vp.listenerSeqId,o=this._listeners.get(t);return o==null||o.set(a,[n,s]),this._emitRetainEvent(t,a,o),i?{off:an(()=>{o==null||o.delete(a),(o==null?void 0:o.size)==0&&this._listeners.delete(t)},"off")}:a}onAny(t,n){return this.on("*",t,n)}_emitRetainEvent(t,n,e){t in this._lastMessage&&this._executeListener(n,e,this._lastMessage[t])}once(t,n,e){return this.on(t,n,Object.assign({},e,{count:1}))}_forEachListeners(t){let n=!1;for(let[e,i]of this._listeners.entries()){if(n)break;for(let[s,[a,o]]of i.entries()){if(n)break;n=t({event:e,listenerId:s,listener:a,count:o,eventListeners:i})===!1}}}_forEachEventListeners(t,n){let e=!1,i=[[t,this._listeners.get(t)]];for(let[s,a]of i)if(a)for(let[o,[r,u]]of a){if(e)break;e=n({event:s,listenerId:o,listener:r,count:u,eventListeners:a})===!1}}off(){if(arguments.length==1){if(typeof arguments[0]=="number")this._forEachListeners(({listenerId:t,eventListeners:n,event:e})=>{var i;if(t==arguments[0])return n.delete(t),((i=this._listeners.get(e))==null?void 0:i.size)==0&&this._listeners.delete(e),!1});else if(typeof arguments[0]=="function"){let t=arguments[0];this._forEachListeners(({listenerId:n,listener:e,eventListeners:i,event:s})=>{var a;e==t&&(i.delete(n),((a=this._listeners.get(s))==null?void 0:a.size)==0&&this._listeners.delete(s))})}}else arguments.length==2&&typeof arguments[0]=="string"&&typeof arguments[1]=="function"&&this._forEachEventListeners(arguments[0],({event:t,listenerId:n,listener:e,eventListeners:i})=>{var s;t==arguments[0]&&e==arguments[1]&&(i.delete(n),((s=this._listeners.get(t))==null?void 0:s.size)==0&&this._listeners.delete(t))})}waitFor(t,n=0){return new Promise((e,i)=>{let s,a=!1,o;n>0&&(s=setTimeout(()=>{a=!0,this.off(o),i(new Error("Timeout"))},n)),o=this.once(t,r=>{a||(clearTimeout(s),e(r))})})}offAll(t){t?this._listeners.delete(t):this._listeners.clear()}_executeListener(t,n,e){if(!n)return;let i=n.get(t);if(i)try{return i[0](e)}catch(s){if(!this.options.ignoreError)throw s}finally{i[1]>-1&&(i[1]=i[1]-1,i[1]==0&&n.delete(t))}}_executeListeners(t,n,e){let i=[];return this._forEachEventListeners(t,({event:s,listenerId:a,eventListeners:o})=>{i.push(this._executeListener(a,o,n)),typeof e=="function"&&e(a),o.size==0&&this._listeners.delete(s)}),i}emit(t,n,e){return e&&(this._lastMessage[t]=n),this._executeListeners(t,n)}emitAsync(t,n,e){return re(this,null,function*(){return yield Promise.allSettled(this.emit(t,n,e))})}},an(Vp,"l"),Vp);ax.listenerSeqId=0;var lx=ax;(t=>typeof Yo<"u"?Yo:typeof Proxy<"u"?new Proxy(t,{get:an((n,e)=>(typeof Yo<"u"?Yo:n)[e],"get")}):t)(function(t){if(typeof Yo<"u")return Yo.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function cx(){return Date.now().toString()+parseInt(String(Math.random()*1e3))}an(cx,"getId");function jp(t,n=!1){if(typeof t=="number")return!0;if(typeof t!="string"||n)return!1;try{if(t.includes(".")){let e=parseFloat(t);return t.endsWith(".")?!isNaN(e)&&String(e).length===t.length-1:!isNaN(e)&&String(e).length===t.length}else{let e=parseInt(t);return!isNaN(e)&&String(e).length===t.length}}catch(e){return!1}}an(jp,"r");function Gp(t){return jp(t)}an(Gp,"isMessageId");function ux(t){return t&&typeof t=="object"&&t.__VoerkaI18nScope__}an(ux,"isI18nScope");function hx(t){return re(this,null,function*(){let n=yield t.call(this);return n&&"__esModule"in n||Symbol.toStringTag in n?n.default:n})}an(hx,"loadAsyncModule");function dx(t){return t&&typeof t.get=="function"&&typeof t.set=="function"&&typeof t.remove=="function"}an(dx,"isStorage");function fx(t){return re(this,null,function*(){return(yield Promise.allSettled(t)).map(n=>n.status==="fulfilled"?n.value:n.reason)})}an(fx,"execAsyncs");function v1(){try{return typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"}catch(t){return!1}}an(v1,"isBrowser");var x1=class y1 extends lx{constructor(n){if(super(),Jr(this,"__VoerkaI18nManager__",!0),Jr(this,"_scopes",[]),Jr(this,"_appScope"),y1.instance)return y1.instance;if(!n)throw new Error("create VoerkaI18nManager failed, appScope is required");this._registerAppScope(n),this._registerScopes(),this._loadPlugins(),y1.instance=this,globalThis.VoerkaI18n=this}get debug(){return this.scope.debug}get logger(){return this.scope.logger}get scopes(){return this._scopes}get activeLanguage(){return this._appScope.activeLanguage}get defaultLanguage(){return this._appScope.defaultLanguage}get loader(){return this._appScope.loader}get storage(){return this.scope.storage}get languages(){return this.scope.languages}get scope(){return this._appScope}_registerScopes(){let n=globalThis.__VoerkaI18nScopes__;n&&Array.isArray(n)&&n.forEach(e=>this.register(e)),delete globalThis.__VoerkaI18nScopes__}getScope(n){return this._scopes.find(e=>e.id===n)}_loadPlugins(){let n=globalThis.__VoerkaI18nPlugins__;n&&Array.isArray(n)&&n.forEach(e=>e(this)),delete globalThis.__VoerkaI18nPlugins__}registerPlugin(n){typeof n=="function"&&n(this)}_registerAppScope(n){this._scopes.push(n),this._appScope=n,this.logger.debug("VoerkaI18nScope<"+n.id+"> is registered as appScope"),this.emitAsync("init",()=>this._appScope.activeLanguage,!0)}register(n){if(!ux(n))throw new Error("register scope failed, invalid scope");this._scopes.push(n),n.bind(this),this.logger.debug(`VoerkaI18nScope<${n.id}> is registered`)}change(n){return re(this,null,function*(){yield this._refreshScopes(n);let e=this._appScope.activeLanguage;return this.scope.saveLanguage(),this.emit("change",e,!0),this.logger.info("language changed to: "+e),e})}_refreshScopes(n){return re(this,null,function*(){let e=this._scopes.map(i=>i.refresh(n));yield fx(e)})}refresh(){return re(this,null,function*(){return yield this._refreshScopes(this.activeLanguage)})}ready(n,e){return this.waitFor("ready",e).then(i=>{n&&n.call(this,i)})}clearPatchedMessages(){this._scopes.forEach(n=>n.clearPatchedMessages())}hasLanguage(n){return this.languages.findIndex(e=>e.name==n)!=-1}clearLanguage(){this.scope.clearLanguage()}saveLanguage(){this.scope.saveLanguage()}restoreLanguage(){this.scope.restoreLanguage()}};an(x1,"VoerkaI18nManager"),Jr(x1,"instance");var px=x1,sS={get(t){if(globalThis.localStorage)return globalThis.localStorage.getItem(t)},set(t,n){globalThis.localStorage&&globalThis.localStorage.setItem(t,n)},remove(t){globalThis.localStorage&&globalThis.localStorage.removeItem(t)}},aS=[{name:"zh",title:"中文",default:!0,active:!0},{name:"en",title:"英文"}],mx=an((t,n,e=[])=>{let i=Object.getOwnPropertyDescriptors(n);for(let s of e)delete i[s];Object.defineProperties(t,i)},"copyProps"),qc=an((t,n=[t])=>{let e=Object.getPrototypeOf(t);return e===null?n:qc(e,[...n,e])},"protoChain"),lS=an((...t)=>{if(t.length===0)return;let n,e=t.map(i=>qc(i));for(;e.every(i=>i.length>0);){let i=e.map(a=>a.pop()),s=i[0];if(i.every(a=>a===s))n=s;else break}return n},"nearestCommonProto"),gx=an((t,n,e=[])=>{var i;let s=(i=lS(...t))!==null&&i!==void 0?i:Object.prototype,a=Object.create(s),o=qc(s);for(let r of t){let u=qc(r);for(let l=u.length-1;l>=0;l--){let h=u[l];o.indexOf(h)===-1&&(mx(a,h,["constructor",...e]),o.push(h))}}return a.constructor=n,a},"hardMixProtos"),_1=an(t=>t.filter((n,e)=>t.indexOf(n)==e),"unique"),Hp=an((t,n)=>{let e=n.map(a=>qc(a)),i=0,s=!0;for(;s;){s=!1;for(let a=n.length-1;a>=0;a--){let o=e[a][i];if(o!=null&&(s=!0,Object.getOwnPropertyDescriptor(o,t)!=null))return e[a][0]}i++}},"getIngredientWithProp"),cS=an((t,n=Object.prototype)=>new Proxy({},{getPrototypeOf(){return n},setPrototypeOf(){throw Error("Cannot set prototype of Proxies created by ts-mixer")},getOwnPropertyDescriptor(e,i){return Object.getOwnPropertyDescriptor(Hp(i,t)||{},i)},defineProperty(){throw new Error("Cannot define new properties on Proxies created by ts-mixer")},has(e,i){return Hp(i,t)!==void 0||n[i]!==void 0},get(e,i){return(Hp(i,t)||n)[i]},set(e,i,s){let a=Hp(i,t);if(a===void 0)throw new Error("Cannot set new properties on Proxies created by ts-mixer");return a[i]=s,!0},deleteProperty(){throw new Error("Cannot delete properties on Proxies created by ts-mixer")},ownKeys(){return t.map(Object.getOwnPropertyNames).reduce((e,i)=>i.concat(e.filter(s=>i.indexOf(s)<0)))}}),"proxyMix");an((t,n)=>cS([...t,{constructor:n}]),"softMixProtos");var yx=new WeakMap,uS=an(t=>yx.get(t),"getMixinsForClass"),hS=an((t,n)=>yx.set(t,n),"registerMixins"),bx=an((t,n)=>{var e,i;let s=_1([...Object.getOwnPropertyNames(t),...Object.getOwnPropertyNames(n)]),a={};for(let o of s)a[o]=_1([...(e=t==null?void 0:t[o])!==null&&e!==void 0?e:[],...(i=n==null?void 0:n[o])!==null&&i!==void 0?i:[]]);return a},"mergeObjectsOfDecorators"),vx=an((t,n)=>{var e,i,s,a;return{property:bx((e=t==null?void 0:t.property)!==null&&e!==void 0?e:{},(i=n==null?void 0:n.property)!==null&&i!==void 0?i:{}),method:bx((s=t==null?void 0:t.method)!==null&&s!==void 0?s:{},(a=n==null?void 0:n.method)!==null&&a!==void 0?a:{})}},"mergePropertyAndMethodDecorators"),xx=an((t,n)=>{var e,i,s,a,o,r;return{class:_1([...(e=t==null?void 0:t.class)!==null&&e!==void 0?e:[],...(i=n==null?void 0:n.class)!==null&&i!==void 0?i:[]]),static:vx((s=t==null?void 0:t.static)!==null&&s!==void 0?s:{},(a=n==null?void 0:n.static)!==null&&a!==void 0?a:{}),instance:vx((o=t==null?void 0:t.instance)!==null&&o!==void 0?o:{},(r=n==null?void 0:n.instance)!==null&&r!==void 0?r:{})}},"mergeDecorators"),w1=new Map,dS=an((...t)=>{var n;let e=new Set,i=new Set([...t]);for(;i.size>0;)for(let s of i){let a=qc(s.prototype).map(u=>u.constructor),o=(n=uS(s))!==null&&n!==void 0?n:[],r=[...a,...o].filter(u=>!e.has(u));for(let u of r)i.add(u);e.add(s),i.delete(s)}return[...e]},"findAllConstituentClasses"),fS=an((...t)=>{let n=dS(...t).map(e=>w1.get(e)).filter(e=>!!e);return n.length==0?{}:n.length==1?n[0]:n.reduce((e,i)=>xx(e,i))},"deepDecoratorSearch");an((...t)=>{let n=t.map(e=>pS(e));return n.length===0?{}:n.length===1?n[0]:n.reduce((e,i)=>xx(e,i))},"directDecoratorSearch");var pS=an(t=>{let n=w1.get(t);return n||(n={},w1.set(t,n)),n},"getDecoratorsForClass");function _x(...t){var n,e,i;let s=t.map(r=>r.prototype);function a(...r){for(let u of t)mx(this,new u(...r))}an(a,"MixedClass"),a.prototype=gx(s,a),Object.setPrototypeOf(a,gx(t,null,["prototype"]));let o=a;{let r=fS(...t);for(let u of(n=r==null?void 0:r.class)!==null&&n!==void 0?n:[]){let l=u(o);l&&(o=l)}wx((e=r==null?void 0:r.static)!==null&&e!==void 0?e:{},o),wx((i=r==null?void 0:r.instance)!==null&&i!==void 0?i:{},o.prototype)}return hS(o,t),o}an(_x,"Mixin");var wx=an((t,n)=>{let e=t.property,i=t.method;if(e)for(let s in e)for(let a of e[s])a(n,s);if(i)for(let s in i)for(let a of i[s])a(n,s,Object.getOwnPropertyDescriptor(n,s))},"applyPropAndMethodDecorators"),Ax=class{constructor(){Jr(this,"_eventEmitter")}_getEventEmitter(){return this.attached?this.manager:(this._eventEmitter||(this._eventEmitter=new lx),this._eventEmitter)}on(n,e){return this._getEventEmitter().on(n,e)}once(n,e){return this._getEventEmitter().once(n,e)}off(n,e){return this._getEventEmitter().off(n,e)}waitFor(n,e){return this._getEventEmitter().waitFor(n,e)}emit(n,e,i){return re(this,null,function*(){return yield this._getEventEmitter().emitAsync(n,e,i)})}};an(Ax,"EventEmitterMixin");var mS=Ax;function Cs(t){return t&&typeof t=="function"}an(Cs,"t");function Bl(t){if(typeof t!="object"||t===null)return!1;var n=Object.getPrototypeOf(t);if(n===null)return!0;for(var e=n;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return n===e}an(Bl,"o");var M1,gS=(M1=class extends Error{},an(M1,"m"),M1),yS=0;function Sx(t,n={timeout:0}){let e=!1,i=!1,s=!1,a,o,r=0,u,l=++yS,h=an(function(){clearTimeout(r),e=!1,i=!1,s=!1,u=new Promise((d,p)=>{a=d,o=p})},"g");h();function f(d=0,p){return re(this,null,function*(){if(typeof t=="function"&&t()){e=!0;return}return(e||i)&&h(),d>0&&(r=setTimeout(()=>{e=!0;try{p instanceof Error?o(p):a(p)}catch(b){}},d)),s=!0,u})}return an(f,"o"),f.id=l,f.resolve=d=>{if(clearTimeout(r),!!s&&!(e||i)){if(typeof t=="function"&&t())if(t())a(d);else return;else a(d);e=!0}},f.reject=d=>{clearTimeout(r),s&&(e||i||(o(typeof d=="string"?new Error(d):d instanceof Error?d:new Error),i=!0))},f.destroy=()=>{clearTimeout(r),s&&o(new gS),e=!1,s=!1,i=!1,u=null},f.reset=h,f.isResolved=()=>e,f.isRejected=()=>i,f.isPending=()=>s,f}an(Sx,"p");var Ex=class{constructor(){Jr(this,"_patching")}_getPatchKey(n){return`voerkai18n_${this.id}_${n}_patched_messages`}clearPatchedMessages(n){if(this.storage){let e=n?[n]:this.languages.map(i=>i.name);for(let i of e)this.storage.remove(this._getPatchKey(i))}}_patch(n){return re(this,null,function*(){var e;this._patching=Sx(),n||(n=this.activeLanguage),this._restorePatchedMessages(this.activeMessages,n);try{if(Cs(this.loader)){let i=yield this._loadMessagesFromLoader(n);Bl(i)&&(Object.assign(this._activeMessages,i),this._setPatchedMessages(i,n),this.emit("patched",{language:n,scope:this.id}))}}catch(i){this.logger.warn(`从远程加载语言补丁包<${n}>时出错: ${i.stack}(scope=${this.id})`)}finally{(e=this._patching)==null||e.resolve(),this._patching=void 0}})}_restorePatchedMessages(n,e){let i=this._getPatchedMessages(e);Bl(i)&&(Object.assign(n,i),this.emit("restore",{language:e,scope:this.id}),this.logger.debug(`成功恢复补丁语言包<${e}>(scope=${this.id})`))}_setPatchedMessages(n,e){if(!(!this.attached&&!this.storage))try{this.storage&&this.storage.set(this._getPatchKey(e),JSON.stringify(n))}catch(i){this.logger.error(`保存语言包补丁(${e})时出错: ${i.stack}(scope=${this.id})`)}}_getPatchedMessages(n){try{return this.storage&&this.options.cachePatch?this.storage.get(this._getPatchKey(n)):{}}catch(e){return this.logger.error(`读取语言包补丁(${n})时出错:${e.stack}(scope=${this.id})`),{}}}};an(Ex,"PatchMessageMixin");var bS=Ex,vS=an((t,n,e)=>new Promise((i,s)=>{var a=an(u=>{try{r(e.next(u))}catch(l){s(l)}},"f"),o=an(u=>{try{r(e.throw(u))}catch(l){s(l)}},"d"),r=an(u=>u.done?i(u.value):Promise.resolve(u.value).then(a,o),"u");r((e=e.apply(t,n)).next())}),"j"),A1,xS=(A1=class extends Error{},an(A1,"b"),A1),_S=0;function Tx(t,n={timeout:0}){let e=!1,i=!1,s=!1,a,o,r=0,u,l=++_S,h=an(function(){clearTimeout(r),e=!1,i=!1,s=!1,u=new Promise((d,p)=>{a=d,o=p})},"m");h();function f(){return vS(this,arguments,function*(d=n.timeout,p){if(typeof t=="function"&&t()){e=!0;return}return(e||i)&&h(),d>0&&(r=setTimeout(()=>{e=!0;try{p instanceof Error?o(p):a(p)}catch(b){}},d)),s=!0,u})}return an(f,"c"),f.id=l,f.resolve=d=>{if(clearTimeout(r),!!s&&!(e||i)){if(typeof t=="function"&&t())if(t())a(d);else return;else a(d);e=!0}},f.reject=d=>{clearTimeout(r),s&&(e||i||(o(typeof d=="string"?new Error(d):d instanceof Error?d:new Error),i=!0))},f.destroy=()=>{clearTimeout(r),s&&o(new xS),e=!1,s=!1,i=!1,u=null},f.reset=h,f.isResolved=()=>e,f.isRejected=()=>i,f.isPending=()=>s,f}an(Tx,"R");var Cx=class extends Error{};an(Cx,"VoerkaI18nError");var $h=Cx,wS=class extends $h{};an(wS,"VoerkaI18nInvalidLanguageError");var MS=class extends $h{};an(MS,"VoerkaI18nOnlyOneAppScopeError");var AS=class extends $h{};an(AS,"VoerkaI18nChangeLanguageError");var Px=class extends $h{};an(Px,"VoerkaI18nLoadLanguageError");var Dx=Px,Rx=class{constructor(){Jr(this,"_refreshSignal")}refresh(n,e){return re(this,null,function*(){this._refreshSignal||(this._refreshSignal=Tx()),n||(n=this.activeLanguage);let i=n,s,{patch:a,fallback:o}=Object.assign({fallback:!1,patch:!0},e);try{s=yield this._loadLanguageMessages(n),this._activeMessages=s,s&&!s.$remote&&a&&(yield this._patch(n))}catch(r){if(r&&r instanceof $h){let u=this.getFallbackLanguage(n);u&&u!==n&&(i=yield this.refresh(u,{patch:a,fallback:!0}))}}finally{o||(this._activeLanguage=i,(typeof this.messages[i]=="function"||!(i in this.messages))&&(this.messages[i]=this._activeMessages),this._activeParagraphs=this.paragraphs[i],this._refreshSignal.resolve(),this._refreshSignal=void 0,yield this.emit("scope/change",i,!0))}return this._setLanguageAttr(),i})}_loadLanguageMessages(n){return re(this,null,function*(){this.logger.debug(`准备加载语言包:${n}`);let e=this.messages[n],i;if(Bl(e))i=e;else if(Cs(e))try{i=yield hx.call(this,e)}catch(s){this.logger.error(`加载异步语言包<${n}>失败:${s.message}`),i=void 0}if(!i&&Cs(this.loader))try{let s=yield this._loadMessagesFromLoader(n);Bl(s)?i=Object.assign({$remote:!0},this.messages[this.defaultLanguage],s):this.logger.error(`错误的语言包<${n}>数据:${s}`)}catch(s){throw new Dx(s.message)}if(!Bl(i))throw new Dx(n);return i})}_loadMessagesFromLoader(n){return re(this,null,function*(){if(Cs(this.loader))return yield this.loader.call(this,n,this)})}ready(){let n=typeof arguments[0]=="function"?arguments[0]:void 0,e=typeof arguments[0]=="number"?arguments[0]:arguments[1];if(typeof n=="function")this.manager.ready(n,e);else return new Promise(i=>{this.manager.ready(i,e)})}changing(n){return re(this,null,function*(){var e,i;!this._refreshSignal&&!this._patching||(yield Promise.all([(e=this._refreshSignal)==null?void 0:e.call(this,n),(i=this._patching)==null?void 0:i.call(this,n)]))})}};an(Rx,"ChangeLanguageMixin");var SS=Rx,ES={warn:console.warn,error:console.error,info:console.info,debug:console.debug};function kx(t){let n,e=[],i=an((s,...a)=>{let o=a.join(" ");if(n){if(!n.debug)return;n.emit("log",{level:s,message:o})}else if(n=globalThis.VoerkaI18n,n&&n instanceof px)if(n.debug){e.push([s,o]);let r=an((u,l)=>{t?t(u,l):ES[u](l)},"log");n.on("log",({level:u,message:l})=>r(u,l)),e.forEach(([u,l])=>r(u,l))}else e.splice(0,e.length);else e.push([s,o])},"logOutput");return{warn:an((...s)=>i("warn",...s),"warn"),error:an((...s)=>i("error",...s),"error"),info:an((...s)=>i("info",...s),"info"),debug:an((...s)=>i("debug",...s),"debug")}}an(kx,"createLogger");var TS=class extends Error{constructor(n){super(`Formatters of language<${n}> is not loaded,try to call load()`)}};an(TS,"FormattersNotLoadedError");var Ix=class{constructor(n){Jr(this,"_formatters",[]),Jr(this,"_scope"),this._scope=n,this._formatters=n==null?void 0:n.options.formatters,this._registerFormatters()}get scope(){return this._scope}get formatters(){return this._formatters}_registerFormatters(){this._formatters&&this._formatters.forEach(n=>{Array.isArray(n)?this.register.apply(this,n):this.register.apply(this,[n])})}_addFormatter(n){try{if(this.scope.interpolator.addFilter(n),n){let e=this.scope.manager.scope;e.id!==this.scope.id&&e.interpolator.addFilter(n)}}catch(e){this.scope.logger.error(`fail while register formatter<${n.name}>：${e.stack}`)}}register(n,e,i){let s=this.scope,a=n.next;n.next=function(o,r,u){let l=u.getConfig;return u.getConfig=()=>Object.assign({},i,e==null?void 0:e[s.activeLanguage],l(n.name)),a.call(this,o,r,u)},this._addFormatter(n)}};an(Ix,"VoerkaI18nFormatterManager");var CS=Ix;function Lx(t){return t&&typeof t=="object"&&t.__VoerkaI18nManager__}an(Lx,"isI18nManger");var Bx=class{getLanguage(n){let e=this.languages.findIndex(i=>i.name==n);if(e!==-1)return this.languages[e]}getFallbackLanguage(n){let e=this.getLanguage(n);return e&&e.fallback||this.options.fallback||this._defaultLanguage}hasLanguage(n){return this.languages.findIndex(e=>e.name==n)!=-1}};an(Bx,"LanguageMixin");var PS=Bx,Fx=class{_getPluraMessage(n,e){try{return Array.isArray(n)?n.length>e?n[e]:n[n.length-1]:n}catch(i){return Array.isArray(n)?n[0]:n}}_getPluraValue(n){let e=null,i=[];if(Bl(n)){let s=n;for(let[a,o]of Object.entries(s)){if(Cs(o))try{s[a]=o()}catch(u){s[a]=o}let r=typeof s[a]=="number";(e==null&&r||a.startsWith("$")&&r)&&(e=s[a])}i=[s]}else Array.isArray(n)?i=n.map(s=>{try{s=Cs(s)?s():s,jp(s)&&!e&&(e=parseInt(s))}catch(a){return String(s)}return s}):n!==void 0&&(e=jp(n)?parseInt(n):0,i=[n]);return[e,i]}_getTranslateComponent(){if(!this._translateComponent){let n=this.options.component||this.appScope.options.component;typeof n=="function"?this._translateComponent=n.call(this,this):(this._translateComponent=()=>{},this.logger.warn("No translate component builder configured"))}return this._translateComponent}_getTranslateTransformer(){if(!this._translateTransformer){let n=this.options.transform||this.appScope.options.transform;typeof n=="function"&&(this._translateTransformer=n.call(this,this))}return this._translateTransformer}_getActiveMessages(n){return typeof this.messages[n]=="function"?(this.logger.warn(`When the t function specifies the language <${n}> , only synchronized language packs can be used`),this.activeMessages):this.messages[n]}translate(n,e,i){if(typeof n!="string")return this.logger.debug(`failed to translate message:${n},it is not a string`),"";let s=(i==null?void 0:i.language)||this.activeLanguage,a=this._getActiveMessages(s);n=n.replace(/\n/g,"\\n");let o=n;if(typeof n!="string")return n;let r=e===void 0?[]:Cs(e)?e():e;try{if(Gp(n))o=a[n]||n;else{let h=this.idMap[n];o=a[h]||a[n]||n}let[u,l]=this._getPluraValue(r);Array.isArray(o)&&o.length>0&&(u!==null?o=this._getPluraMessage(o,u):o=o[0]),r.length,o=this.interpolator.replace(o,...l),this._translateTransformer&&(i!=null&&i.transform)&&(o=this._translateTransformer(o,l,i))}catch(u){this.logger.error(`翻译失败：${u.stack}`)}return o}};an(Fx,"TranslateMixin");var DS=Fx,Nx=class{_getStorage(){let n=this.storage;return dx(n)?n:void 0}_getStorageKey(){return this.options.storageKey.replace("{scope}",this.id)}restoreLanguage(){let n=this._getStorage();if(n){let e=this._getStorageKey(),i=n.get(e);if(!i||!this.hasLanguage(i))return;this._activeLanguage=i,this.logger.debug(`从存储<${e}>中恢复保存的语言：${i}`)}}saveLanguage(){let n=this._getStorage();if(n){if(!this._activeLanguage)return;let e=this._getStorageKey();n.set(e,this.activeLanguage),this.logger.debug(`当前语言已保存到存储${e}=${this.activeLanguage}`)}}clearLanguage(){let n=this._getStorage();n&&n.remove(this._getStorageKey())}};an(Nx,"RestoreMixin");var RS=Nx,kS=Object.defineProperty,Ox=Object.getOwnPropertySymbols,IS=Object.prototype.hasOwnProperty,LS=Object.prototype.propertyIsEnumerable,zx=an((t,n,e)=>n in t?kS(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,"R"),Ux=an((t,n)=>{for(var e in n||(n={}))IS.call(n,e)&&zx(t,e,n[e]);if(Ox)for(var e of Ox(n))LS.call(n,e)&&zx(t,e,n[e]);return t},"b"),Xc=(t=>typeof Yo<"u"?Yo:typeof Proxy<"u"?new Proxy(t,{get:an((n,e)=>(typeof Yo<"u"?Yo:n)[e],"get")}):t)(function(t){if(typeof Yo<"u")return Yo.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),Fl={Abort:Symbol("Abort"),Throw:Symbol("Throw"),Ignore:Symbol("Ignore")},S1,Yc=(S1=class extends Error{constructor(t){super(),this.value=t}},an(S1,"a"),S1),E1,Nl=(E1=class extends Yc{},an(E1,"p"),E1),T1,Wp=(T1=class extends Yc{},an(T1,"x"),T1),C1,P1=(C1=class extends Yc{},an(C1,"g"),C1),BS={name:"error",priority:"before",args:["operate","value"],default:{operate:"ignore"},next(t,n,e){let i=n.operate.toLowerCase(),s=n.value;return e.onError=(a,o,r,u)=>{if(!(a instanceof Error)||a instanceof Yc)throw a;if(i=="throw")throw s?new Error(s):a;if(i=="abort")throw new Nl(s);if(i=="ignore")throw new Wp(s);return o},t}},FS={name:"empty",priority:"before",args:["operate","value"],default:{operate:"abort",value:""},next(t,n,e){let i=n.operate.toLowerCase(),s=n.value;return e.onEmpty=()=>{if(i=="throw")throw new P1;if(i=="abort")throw new Nl(s);if(i=="ignore")throw new Wp;return i},t}};function Qh(t,...n){if(n.length===0)return t;let e=n.map((i,s)=>{let a=Object.entries(i||{});return a.some(([o,r])=>r===void 0)?a.reduce((o,[r,u])=>(u!==void 0&&(o[r]=u),o),{}):i});return Object.assign(t,...e)}an(Qh,"F"),(t=>typeof Xc<"u"?Xc:typeof Proxy<"u"?new Proxy(t,{get:an((n,e)=>(typeof Xc<"u"?Xc:n)[e],"get")}):t)(function(t){if(typeof Xc<"u")return Xc.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function D1(t){if(typeof t!="object"||t===null)return!1;var n=Object.getPrototypeOf(t);if(n===null)return!0;for(var e=n;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return n===e}an(D1,"y");function Vx(t){return t&&typeof t=="function"}an(Vx,"v");function R1(t,n,e){if(typeof n=="string"){let i=0,s;for(;(s=t.indexOf(n,i))>-1;){let a=typeof e=="function"?e(n):e,o=t.length;t=t.substring(0,s)+a+t.substring(s+n.length),i=s+a.length+t.length-o}}else{let i;if(!n.global||!n.multiline)throw new Error("The search parameter must be enabled '/gm' option");for(;(i=n.exec(t))!==null;){i.index===n.lastIndex&&n.lastIndex++;let s=t.length,a=i[0].length,o=typeof e=="function"?e(i[0],...i):e;t=t.substring(0,i.index)+o+t.substring(i.index+a),n.lastIndex+=t.length-s}}return t}an(R1,"w"),String.prototype.replaceAll||(String.prototype.replaceAll=function(t,n){return R1(this,t,n)});function td(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}an(td,"m");function jx(t,n=!1){if(typeof t=="number")return!0;if(typeof t!="string"||n)return!1;try{if(t.includes(".")){let e=parseFloat(t);return t.endsWith(".")?!isNaN(e)&&String(e).length===t.length-1:!isNaN(e)&&String(e).length===t.length}else{let e=parseInt(t);return!isNaN(e)&&String(e).length===t.length}}catch(e){return!1}}an(jx,"C");var NS=/\n/gm,OS=/(["'])(.*?)(\1)/gm,zS=/([\s\[\,\{])(\w+)(\s*\:)/gm;function Gx(t,n){try{return JSON.parse(t,(i,s)=>n?n(i,s):s)}catch(i){}let e=t.replace(NS,(i,s,a)=>{let o=a.slice(0,s).trim(),r=a.slice(s+1).trim();return!/,$/.test(o)&&!/[\[\{\}]$/.test(o)&&!/^\}/.test(r)?`,
`:`
`});return e=e.replaceAll(OS,(i,s,a)=>`"${encodeURI(a)}"`),e=e.replaceAll(zS,(i,s,a,o)=>`${s}"${a}"${o}`),e=e.replaceAll("，",",").replaceAll("“",'"').replaceAll("”",'"'),JSON.parse(e,(i,s)=>(typeof s=="string"&&(s=decodeURI(s)),s))}an(Gx,"V");function Hx(t,n="{",e="}"){let i=0,s=0;for(;i<t.length;){let a=t.slice(i,i+n.length),o=t.slice(i,i+e.length);if(a==n){s++,t=t.substring(0,i+n.length)+`${s}%`+t.substring(i+n.length),i+=n.length+String(s).length+1;continue}if(o==e){s>0&&(t=t.substring(0,i)+`%${s}`+t.substring(i)),i+=e.length+String(s).length+1,s--;continue}i++}return t}an(Hx,"J");function Wx(t,...n){return n.length==0&&(n.push(["{","}"]),n.push(["[","]"])),n.forEach(e=>{t.includes(e[0])&&t.includes(e[1])&&(t=Hx(t,...e))}),t}an(Wx,"H");function qx(t,n,e){return[[n,new RegExp(td(n)+"\\d+%")],[e,new RegExp("%\\d+"+td(e))]].forEach(([i,s])=>{let a;for(;(a=s.exec(t))!==null;)a.index===s.lastIndex&&s.lastIndex++,t=t.replace(s,i)}),t}an(qx,"G");function qp(t,...n){return n.length==0&&(n.push(["{","}"]),n.push(["[","]"])),n.forEach(([e,i])=>{t.includes(e)&&t.includes(i)&&(t=qx(t,e,i))}),t}an(qp,"E");function Xx(t){return t?t.trim().substring(1).trim().split("|").map(n=>n.trim()).map(n=>{if(n=="")return null;let e=n.indexOf("("),i=n.lastIndexOf(")");if(e!==-1&&i!==-1){let s=n.substring(e+1,i).trim(),a=Kx(s);return[n.substring(0,e),a]}else return[n,[]]}).filter(n=>Array.isArray(n)):[]}an(Xx,"M");function Yx(...t){t.length==0&&(t.push(["{","}"]),t.push(["[","]"]));let n=t.map(([e,i])=>`(${td(e)}1%.*?%1${td(i)})`);return US.replace("__TAG_REGEXP__",n.length>0?n.join("|")+"|":"")}an(Yx,"z");var US=String.raw`((([\'\"])(.*?)\3))|__TAG_REGEXP__([\d]+\.?[\d]?)|((true|false|null)(?=[,\b\s]))|([\w\.]+)|((?<=,)\s*(?=,))(?<=\s*[,\)]?\s*)`;function Kx(t){let n=[],e;t=Wx(t);try{let i=new RegExp(Yx(),"g");for(;(e=i.exec(t))!==null;){e.index===i.lastIndex&&i.lastIndex++;let s=e[0];if(s.trim()=="")s=void 0;else if(s.startsWith("'")&&s.endsWith("'")||s.startsWith('"')&&s.endsWith('"'))s=s.substring(1,s.length-1),s=qp(s);else if(s.startsWith("{")&&s.endsWith("}")||s.startsWith("[")&&s.endsWith("]"))try{s=qp(s),s=Gx(s)}catch(a){}else["true","false","null"].includes(s)?s=JSON.parse(s):jx(s)?s=parseFloat(s):s=qp(String(s));n.push(s)}}catch(i){}return n}an(Kx,"U");var VS=new RegExp("(?<!\\\\)\\{([\\S]+\\s)?\\s*(\\w+)?((\\s*\\|\\s*\\w*(\\(.*?\\)){0,1}\\s*)*)\\s*(\\s[\\S]+)?\\}","gm");function k1(t,n,e={}){let i=t,s,a=Object.assign({replaceAll:!0},e),o=VS;for(o.lastIndex=0;(s=o.exec(i))!==null;){s.index===o.lastIndex&&o.lastIndex++;let r=s[2]||"",u=(s[1]||"").trim(),l=(s[6]||"").trim(),h=i.length,f=Xx(s[3]||"");if(Vx(n)){let d=n(r,u,l,f,s[0]);a.replaceAll?i=R1(i,s[0],d):i=i.replace(s[0],d),o.lastIndex+=i.length-h}}return i}an(k1,"O");function I1(t,n){let e=n.value;if(t.length>0){let i=t_.call(this,t,n);for(let s of i)try{e=s.call(this,e)}catch(a){if(a instanceof P1)throw a;if(a instanceof Yc){if(a.value!=null&&(e=a.value),a instanceof Nl)break}else throw a}}return this.options.isEmpty(e)||(e=`${n.prefix}${e}${n.suffix}`),e}an(I1,"I");function Zx(t,n,e,i){if(!this.options.isEmpty(t))return t;let s=i.onEmpty||e.onEmpty||this.options.onEmpty;if(typeof s!="function")return t;let a=s.call(this,t,n,i);throw a instanceof Error?a:a==Fl.Abort?new Nl:a==Fl.Ignore?new Wp:a==Fl.Throw?new P1:new Nl(a)}an(Zx,"K");function Jx(t,n,e,i,s){let a=s.onError||i.onError||this.options.onError;if(typeof a!="function")return n;let o=a.call(this,t,n,e,s);throw o instanceof Error?o:o==Fl.Abort?new Nl:o==Fl.Ignore?new Wp:o==Fl.Throw?t:new Nl(o)}an(Jx,"Q");function $x(t,n,e){var i;let s=Object.assign({},typeof t.default=="function"?t.default():t.default);return n.length==1&&D1(n[0])?Qh(s,n[0]):t.args&&((i=t.args)==null?void 0:i.length)>0&&t.args.forEach((a,o)=>{n[o]!==void 0&&(s[a]=n[o])}),a=>{let o;try{e.args=n,o=t.next.call(this,a,s,e),o=Zx.call(this,o,s,t,e)}catch(r){if(r.filter=t.name,r instanceof Yc)throw r;return this.log(`当执行过滤器器<${e.match}:${t.name}>时出错:${r.stack}`),Jx.call(this,r,a,s,t,e)}return String(o)}}an($x,"Y");function Qx(t){let n=[],e=t.map(([i,s])=>[this.getFilter.call(this,i),s]).filter(([i])=>i!=null);return e=e.reduce((i,[s,a])=>(s&&(s.priority=="before"?i.unshift([s,a]):s.priority=="after"?n.push([s,a]):i.push([s,a])),i),[]),e.concat(n)}an(Qx,"Z");function t_(t,n){let e=Qx.call(this,t),i=[];for(let[s,a]of e)i.push($x.call(this,s,a,n));return i}an(t_,"ee");var L1,jS=(L1=class{constructor(t){this.options=Qh({log:console.log,filters:{},missing:"default",filterContext:{}},t),this.addDefaultHandlers(),this.addBuildinFilters(),this.normalizeFilters()}get filters(){return this.options.filters}addDefaultHandlers(){this.options.onError=()=>Fl.Ignore,this.options.onEmpty=()=>"",this.options.isEmpty=t=>t===null||t===""}addFilter(t){if(!t.name)throw new Error("Filter name cannot be empty");if(typeof t.next!="function")throw new Error("The filter must provide a next function");return t=Qh({priority:"normal"},t),this.filters[t.name]=t}removeFilter(t){delete this.filters[t]}getFilter(t){var n;if(t in this.options.filters)return this.options.filters[t];{let e=(n=this.options.getFilter)==null?void 0:n.call(this,t);return typeof e=="function"?{name:t,next:e}:t in String.prototype?{name:t,next:an((i,s,a)=>i[t](...a.args),"next")}:e}}addBuildinFilters(){this.addFilter(BS),this.addFilter(FS)}normalizeFilters(){Object.entries(this.options.filters).forEach(([t,n])=>{let e=Qh({name:t,priority:"normal",args:null,next:an(i=>i,"next")},typeof n=="function"?{filter:n}:n);this.options.filters[t]=e})}getMissingValue(t,n){let e=this.options.missing;if(e=="default")return"";if(e=="ignore")return n;if(typeof e=="function")return e.call(this,t)}replace(t,...n){if(n.length===0)return t;if(n.length===1&&typeof n[0]=="function"&&(n[0]=n[0].call(this)),n.length===1&&D1(n[0])){let e=n[0];return k1.call(this,t,(i,s,a,o,r)=>{let u=i in e?e[i]:this.getMissingValue(i,r);return typeof u=="function"&&(u=u.call(this)),I1.call(this,o,Ux({name:i,value:u,prefix:s,suffix:a,template:t,match:r,args:[]},this.options.filterContext))})}else{let e=n.length===1&&Array.isArray(n[0])?[...n[0]]:n,i=0;return k1.call(this,t,(s,a,o,r,u)=>{let l=e.length>i?e[i++]:this.getMissingValue(i,u);return typeof l=="function"&&(l=l.call(this)),I1.call(this,r,Ux({name:s,value:l,prefix:a,suffix:o,template:t,match:u,args:[]},this.options.filterContext))},{replaceAll:!1})}}log(t,...n){this.options.debug&&this.options.log(t,...n)}},an(L1,"$"),L1);function e_(t,n,e){let{defaultValue:i,delimiter:s,matched:a}=Object.assign({delimiter:"."},e);if(!t||typeof n!="string")return i;if(!n)return t;let o=n.split(s),r=t,u,l;try{for(let h of o)if(r instanceof Map||r instanceof WeakMap){if(!r.has(h))return i;u=r,l=h,r=r.get(h)}else if(r instanceof Set){let f=parseInt(h,10);if(f>=r.size)return i;u=r,l=f,r=[...r][f]}else if(r&&typeof r=="object"&&h in r)u=r,l=Array.isArray(r)?parseInt(h):h,r=r[h];else return i}catch(h){return i}return typeof a=="function"&&a({value:r,parent:u,indexOrKey:l}),r}an(e_,"u");var n_=class{constructor(){Jr(this,"_flexVars")}_initInterpolators(){this._flexVars=new jS({filterContext:{getConfig:an(n=>{let e=this.activeMessages.$config||{};return n?e_(e,n):e},"getConfig"),scope:this}})}};an(n_,"InterpolatorMixin");var GS=n_;function r_(t,...n){if(n.length===0)return t;let e=n.map((i,s)=>{let a=Object.entries(i||{});return a.some(([o,r])=>r===void 0)?a.reduce((o,[r,u])=>(u!==void 0&&(o[r]=u),o),{}):i});return Object.assign(t,...e)}an(r_,"u");var B1=class tS extends _x(mS,bS,SS,PS,DS,GS,RS){constructor(n){super(),Jr(this,"__VoerkaI18nScope__",!0),Jr(this,"_options"),Jr(this,"_manager"),Jr(this,"_formatterManager",null),Jr(this,"_logger"),Jr(this,"_defaultLanguage","zh-CN"),Jr(this,"_activeLanguage","zh-CN"),Jr(this,"_activeMessages",{}),Jr(this,"_patchedMessages",{}),Jr(this,"_translateComponent"),Jr(this,"_translateTransformer"),Jr(this,"_activeParagraphs",{}),Jr(this,"$id",++tS.idSeq),this._options=r_({id:cx(),library:!1,debug:!1,injectLangAttr:!0,languages:[],messages:{},paragraphs:{},idMap:{},formatters:[],attached:!0,storageKey:"language",cachePatch:!0},n),this._init()}get id(){return this._options.id}get options(){return this._options}get attached(){return this._options.attached}get debug(){return this._options.debug}get library(){return this._options.library}get formatters(){return this._formatterManager}get defaultLanguage(){return this._defaultLanguage}get defaultMessages(){return this.messages[this.defaultLanguage]}get messages(){return this._options.messages}get paragraphs(){return this._options.paragraphs}get idMap(){return this._options.idMap}get languages(){return this._options.languages}get manager(){return this._manager}get appScope(){return this._manager.scope}get interpolator(){return this._flexVars}get logger(){return this._logger}get t(){return this.translate.bind(this)}get Translate(){return this._getTranslateComponent()}get activeMessages(){return this._activeMessages}get activeParagraphs(){return this._activeParagraphs}get activeLanguage(){return this._activeLanguage}get storage(){return this.getScopeOption("storage")}get loader(){return this.getScopeOption("loader")}get $t(){return(n,e,i)=>(this._getTranslateTransformer(),i||(i={}),i.transform=!0,this.translate(n,e,i))}getScopeOption(n){let e=this._options;return this.attached?e[n]||(this.library?this._manager[n]:void 0):e[n]}_initOptions(){if(!Array.isArray(this.languages))this.logger.warn("[VoerkaI18n] invalid language settings, will use default language settings."),this._options.languages=Object.assign([],aS);else if(this.languages.length==0)throw new Error("[VoerkaI18n] must provide valid language settings.");let n,e;this.languages.forEach(s=>{s.default&&(e=s.name),s.active&&(n=s.name)});let i=this._options.messages;if(e in i||(e=Object.keys(i)[0]),n in i||(n=e),!(e in i))throw new Error("[VoerkaI18n] invalid language configuration, must provide valid default and active languages.");if(this._activeLanguage=n,this._defaultLanguage=e,!this._options.library&&!this._options.storage&&(this._options.storage=sS),Cs(this.messages[this._defaultLanguage]))throw new Error("[VoerkaI18n] default language pack must be static content, can't use async load way.");this._activeMessages=this.messages[this._activeLanguage],this._activeParagraphs=this.paragraphs[this._activeLanguage]}_init(){this._logger=kx(this._options.log),this._initOptions(),this.library||this.restoreLanguage(),this._initInterpolators(),this.registerToManager(),this._formatterManager=new CS(this)}bind(n){this._manager=n,this._manager.once("init",this._initRefresh.bind(this))}_initRefresh(n){if(this.library)this.refresh(n&&n());else{let e=[];(this._defaultLanguage!==this._activeLanguage||Cs(this.activeMessages))&&e.push(this.refresh(void 0,{patch:!1})),e.push(this._patch()),Promise.all(e).then(()=>{this.emit("ready",this.activeLanguage,!0),this._setLanguageAttr()})}}registerToManager(){if(!this.attached)return;let n=!this.options.library;n&&(globalThis.VoerkaI18n&&globalThis.VoerkaI18n.scope&&v1()&&console.warn("Only can have one i18nScope with library=false"),this._manager=new px(this));let e=globalThis.VoerkaI18n;e&&Lx(e)?n?this._initRefresh():e.register(this):(globalThis.__VoerkaI18nScopes__||(globalThis.__VoerkaI18nScopes__=[]),globalThis.__VoerkaI18nScopes__.push(this))}change(n){return re(this,null,function*(){let e=this.activeLanguage;return this.attached?e=yield this._manager.change(n):e=yield this.refresh(n),e})}_setLanguageAttr(){if(!(this.library||!v1()))try{let n=this._options.injectLangAttr;if(!n)return;let e=n===!0?document.body:document.body.querySelector(n);e&&e.setAttribute("lang",this.activeLanguage)}catch(n){}}getRawMessage(n){if(Gp(n)){if(n in this.defaultMessages)return this.defaultMessages[n]}else return n}getMessageId(n){if(Gp(n))return n;if(n in this.idMap)return this.idMap[n]}};an(B1,"VoerkaI18nScope"),Jr(B1,"idSeq",0);var HS=B1;function WS(t,n,e){return i=>{let s=t.next;return t.next=function(a,o,r){let u=r.getConfig;return r.getConfig=()=>Object.assign({},e,n==null?void 0:n[i.activeLanguage],u(t.name)),s.call(this,a,o,r)},t}}an(WS,"createFormatter");function qS(t){let n=globalThis.VoerkaI18n;n?n.registerPlugin(t):(globalThis.__VoerkaI18nPlugins__||(globalThis.__VoerkaI18nPlugins__=[]),globalThis.__VoerkaI18nPlugins__.push(t))}an(qS,"definePlugin");const XS={get(t){if(globalThis.localStorage)return globalThis.localStorage.getItem(t)},set(t,n){globalThis.localStorage&&globalThis.localStorage.setItem(t,n)},remove(t){globalThis.localStorage&&globalThis.localStorage.removeItem(t)}};var YS=Object.defineProperty,Ii=(t,n)=>YS(t,"name",{value:n,configurable:!0}),Kc=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(n,e)=>(typeof require!="undefined"?require:n)[e]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function i_(t,n=!1){if(typeof t=="number")return!0;if(typeof t!="string"||n)return!1;try{if(t.includes(".")){let e=parseFloat(t);return t.endsWith(".")?!isNaN(e)&&String(e).length===t.length-1:!isNaN(e)&&String(e).length===t.length}else{let e=parseInt(t);return!isNaN(e)&&String(e).length===t.length}}catch(e){return!1}}Ii(i_,"r"),(t=>typeof Kc<"u"?Kc:typeof Proxy<"u"?new Proxy(t,{get:Ii((n,e)=>(typeof Kc<"u"?Kc:n)[e],"get")}):t)(function(t){if(typeof Kc<"u")return Kc.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function o_(t,n=3){let e=new RegExp(String.raw`(?!^)(?=(\d{${n}})+$)`,"g"),i=t.replace(e,",");return i.startsWith(",")&&(i=i.substring(1)),i.endsWith(",")&&(i=i.substring(0,i.length-2)),i}Ii(o_,"addSplitChars");function F1(t,n){let{symbol:e="",division:i=3,prefix:s="",precision:a=-1,suffix:o="",unit:r=0,radix:u=3,units:l=[],format:h="{symbol}{value}{unit}"}=n,[f,d]=String(t).split(".");r>0&&u>0&&(f.length<u*r&&(f=Array.from({length:u*r-f.length+1}).fill(0).join("")+f),d=f.substring(Number(f),f.length-u*r)+d,f=f.substring(0,f.length-u*r),f==""&&(f="0"));let p=[];p.push(o_(f,i)),d&&i_(a)&&a!=0&&(a==0||(a==-1?p.push(`.${d}`):a>0&&(a<0?d=String(parseFloat(`0.${d}`)):d=String(parseFloat(`0.${d}`).toFixed(a)).split(".")[1],p.push(`.${d}`))));const b=l[r]||"";return h.replace("{value}",p.join("")).replace("{symbol}",e).replace("{prefix}",s).replace("{suffix}",o).replace("{unit}",b)}Ii(F1,"toCurrency");var KS=[{name:"currency",args:["format","unit","precision","prefix","suffix","division","symbol","radix"],next(t,n,e){const i=e.getConfig(),s=Object.assign({},i,n);return s.format in s&&(s.format=s[s.format]),s.unit=parseInt(String(s.unit))||0,s.unit>s.units.length-1&&(s.unit=s.units.length-1),s.unit<0&&(s.unit=0),s.unit>0&&s.precision==2&&(s.precision=-1),F1(t,s)}},{"en-US":{units:[""," thousands"," millions"," billions"," trillions"],radix:3,symbol:"$",prefix:"USD",suffix:"",division:3,precision:2},"zh-CN":{units:["","万","亿","万亿","万万亿"],radix:4,symbol:"￥",prefix:"RMB",suffix:"元",division:4,precision:2}},{default:"{symbol}{value}{unit}",long:"{prefix} {symbol}{value}{unit}{suffix}",short:"{symbol}{value}{unit}",custom:"{prefix} {symbol}{value}{unit}{suffix}",format:"default"}],ZS=[{name:"number",args:["precision","division"],next(t,n,e){const i=e.getConfig();return F1(t,Object.assign({},i,n))}},{"en-US":{division:3},"zh-CN":{division:4}}];function za(t){return t instanceof Date?t:new Date(t)}Ii(za,"toDate");var JS=[{name:"timeSlots",args:["upper"],default:{upper:!0},next(t,n,e){const i=e.getConfig(),s=za(t).getHours(),a=!!n.upper;let o=i.slots.findIndex(r=>s<r);return o===-1&&(o=i.upperCases.length-1),a?i.upperCases[o]:i.lowerCases[o]}},{"en-US":{slots:[12],lowerCases:["am","pm"],upperCases:["AM","PM"]},"zh-CN":{slots:[5,8,11,13,18],lowerCases:["凌晨","早上","上午","中午","下午","晚上"],upperCases:["凌晨","早上","上午","中午","下午","晚上"]}}];function N1(t,...n){if(n.length===0)return t;let e=n.map((i,s)=>{let a=Object.entries(i||{});return a.some(([o,r])=>r===void 0)?a.reduce((o,[r,u])=>(u!==void 0&&(o[r]=u),o),{}):i});return Object.assign(t,...e)}Ii(N1,"u");var Xp={en:{month:{long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]},weekday:{long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"]}},cn:{month:{long:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],short:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},weekday:{long:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],short:["周日","周一","周二","周三","周四","周五","周六"]}}},s_={en:{slots:[12],names:["AM","PM"]},cn:{slots:[6,9,11,13,18],names:["凌晨","早上","上午","中午","下午","晚上"]}},$S="YYYY-MM-DD HH:mm:ss";function O1(t){t<0&&t>23&&(t=0);let n=[0,...s_[this.language].slots,24].findIndex(e=>e>t)-1;return s_[this.language].names[n]}Ii(O1,"h");function z1(t,n,e){let i=N1({language:"cn"},e),s=t instanceof Date?t:new Date(t||Date.now()),a=s.getHours(),o=String(a).padStart(2,"0"),r=a>12?a-12:a,u=String(r).padStart(2,"0"),l=String(s.getMinutes()),h=String(s.getSeconds()),f=String(s.getMilliseconds()),d=String(s.getFullYear()),p=s.getMonth(),b=s.getDay(),v=String(s.getDate()),x=[["HH",o],["H",a],["hh",u],["h",r],["mm",l.padStart(2,"0")],["m",l],["ss",h.padStart(2,"0")],["s",h],["SSS",f.padStart(3,"0")],["A",a>12?"PM":"AM"],["a",a>12?"pm":"am"],["t",O1.call(i,a)],["T",O1.call(i,a)],["YYYY",d],["yyyy",d],["YY",d.substring(2)],["MMM",Xp[i.language].month.short[p]],["MM",String(p+1).padStart(2,"0")],["M",p+1],["DD",v.padStart(2,"0")],["D",v],["d",b],["dd",Xp[i.language].weekday.short[b]],["ddd",Xp[i.language].weekday.short[b]],["dddd",Xp[i.language].weekday.long[b]]],w=n||$S;return x.forEach(([M,E])=>w=w.replaceAll(M,E)),w}Ii(z1,"H");function a_(t,n,e){if(typeof n=="string"){let i=0,s;for(;(s=t.indexOf(n,i))>-1;){let a=typeof e=="function"?e(n):e,o=t.length;t=t.substring(0,s)+a+t.substring(s+n.length),i=s+a.length+t.length-o}}else{let i;if(!n.global||!n.multiline)throw new Error("The search parameter must be enabled '/gm' option");for(;(i=n.exec(t))!==null;){i.index===n.lastIndex&&n.lastIndex++;let s=t.length,a=i[0].length,o=typeof e=="function"?e(i[0],...i):e;t=t.substring(0,i.index)+o+t.substring(i.index+a),n.lastIndex+=t.length-s}}return t}Ii(a_,"s"),String.prototype.replaceAll||(String.prototype.replaceAll=function(t,n){return a_(this,t,n)});var l_={local:Ii(t=>t.toLocaleString(),"local"),iso:Ii(t=>t.toISOString(),"iso"),utc:Ii(t=>t.toUTCString(),"utc"),gmt:Ii(t=>t.toGMTString(),"gmt")},QS=[{global:!0,name:"date",args:["format"],next(t,n,e){const i=e.getConfig(),s=za(t);let a=n.format||i.format;if(a in l_)return l_[a](s);if(a in i&&(a=i[a],typeof a=="function"))return a(s);if(typeof a=="string")return z1(s,a)}},{"en-US":{long:"YYYY/MM/DD HH:mm:ss",short:"YYYY/MM/DD"},"zh-CN":{long:"YYYY年M月D日 HH点mm分ss秒",short:"YYYY年M月D日"}},{format:"local"}],c_={local:Ii(t=>t.toLocaleTimeString(),"local"),timestamp:Ii(t=>t.getTime(),"timestamp")},tE=[{name:"time",args:["format"],next(t,n,e){const i=e.getConfig(),s=za(t);let a=n.format||i.format;if(a in c_)return c_[a](s);if(a in i&&(a=i[a],typeof a=="function"))return a(s);if(typeof a=="string")return z1(s,a)}},{"en-US":{long:"HH:mm:ss"},"zh-CN":{long:"HH点mm分ss秒"}},{format:"local",short:"HH:mm:ss"}],eE=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],nE=["周日","周一","周二","周三","周四","周五","周六"],rE=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],iE=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],oE=[{name:"weekday",args:["format"],next(t,n,e){const i=e.getConfig(),s=za(t).getDay(),a=n.format||"long";if(typeof a=="string"&&a in i){const o=i[a];return typeof o=="function"?o(s):o[s]}return s}},{"en-US":{long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"]},"zh-CN":{long:eE,short:nE}},{format:"long"}],sE=[{name:"month",args:["format"],next(t,n,e){const i=e.getConfig(),s=za(t).getMonth()+1,a=n.format||i.format;if(typeof a=="string"&&a in i){const o=i[a];return typeof o=="function"?o(s):o[s-1]}return s}},{"en-US":{long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]},"zh-CN":{long:rE,short:iE}},{format:"long"}],aE=[{name:"quarter",args:["format"],next(t,n,e){const i=e.getConfig(),s=za(t).getMonth()+1,a=Math.floor(s%3==0?s/3:s/3+1)-1,o=n.format||i.format;if(typeof o=="string"&&o in i){const r=i[o];return typeof r=="function"?r(a):r[a]}return a}},{"en-US":{long:["First Quarter","Second Quarter","Third Quarter","Fourth Quarter"]},"zh-CN":{long:["一季度","二季度","三季度","四季度"]}},{format:"short",short:["Q1","Q2","Q3","Q4"]}],ed=[1e3,6e4,36e5,864e5,6048e5,2592e6,31536e6,Number.MAX_SAFE_INTEGER];function u_(t,n,e){let{units:i,now:s,before:a,after:o}=N1({units:["秒","分钟","小时","天","周","个月","年"],now:"刚刚",before:"{value}{unit}前",after:"{value}{unit}后"},e),r=typeof t=="number"?new Date(t).getTime():t.getTime(),u=(n instanceof Date?n:typeof n=="number"?new Date(n):new Date).getTime(),l=r-u,h=ed.findIndex(f=>Math.abs(l)<f)-1;if(h<0&&(h=0),h>ed.length-1&&(h=ed.length-1),l<1e3&&l>-1e3)return s;if(l<=-1e3){let f=parseInt(String(Math.abs(l)/ed[h]));return a.replace("{value}",f).replace("{unit}",i[h])}else{let f=parseInt(String(Math.abs(l)/ed[h]));return o.replace("{value}",f).replace("{unit}",i[h])}}Ii(u_,"b");var lE=[{name:"relativeTime",args:["base"],default:Ii(()=>({base:new Date}),"default"),next(t,n,e){const i=e.getConfig(),s=n.base||new Date;return u_(za(t),s,i)}},{"en-US":{units:["seconds","minutes","hours","days","weeks","months","years"],now:"Just now",before:"{value} {unit} ago",after:"after {value} {unit}"},"zh-CN":{units:["秒","分钟","小时","天","周","个月","年"],now:"刚刚",before:"{value}{unit}前",after:"{value}{unit}后"}}],cE=[KS,ZS,JS,QS,tE,oE,sE,aE,lE];const uE=(t,n)=>re(this,null,function*(){return yield(yield fetch(MxPluginContext.getLoaderLanguageUrl(t,n))).json()}),hE={"zh-CN":{},"en-US":{},"ko-KR":{}},dE={" 指定输出范围第一点:":718," 指定输出范围第二点:":719," 指定第一点:":720," 指定第二点:":721," 云线框起始点:":722," 云线框结束点:":723," 审图标注点:":724," 点击开启绘制云线:":725," 再次点击结束绘制云线:":726,"指定一点:":727,"指定二点:":728,选择对象:729," 指定下一个点:":730,"\\指定插入基点":731," 指定表格插入点:":732,"指定插入点:":733,指定插入基点:734,选择标注对象:735,请选择目标文字:736," 指定填充区域内部一点:":737,"没有找到闭合区域 ":738,表面粗糙度:739,焊接符号:740,形位公差:741,选择要需要开启自定义属性的对象:742,选择要隐藏的对象:743," 指定插入点:":744," 指定一点:":745,指定夹角:746," 指定二点:":747,选择图案填充对象:748,"指定第一点:":749,"指定第二点:":750,"指定第二个角度点:":751,"指定最后一个点:":752,"指定坐标点:":753,"指定标注点:":754,请输入审批意见:755,指定云线框起始点:756,指定云线框终止点:757,指定审图标注点:758,"指定第一个角点:":759,"指定第二个角点:":760,"指定序号位置:":761,旋转符号:762,标记类型:763,"请选择需要标记的圆:":764,请设置定位点或直线或圆弧或圆:765,拖动确定标注位置:766,请指定或输入角度:767,焊缝符号:768,"请拾取定位点、直线或圆弧":769,请指定第二点:770,请设置定位点:771,请设置角度:772,请设置定位点或直线或圆弧:773,请设置引线转折点:774,拖动确定定位点:775,"请指定第一点:":776,"请指定第二点:":777,请选择目标块对象:778,请输入新块名:779,选择需要修改基点的块:780,设置基点:781,选择需要修改颜色的块:782,"输入颜色索引(0~256)":783,请选择源块:784,"选择要刷的目标块:":785,选择连接方式:786,手动逐个连线:787,自动批量连线:788,请选择连线的块:789,设置中心线长度:790,"选择要旋转的目标块:":791,设置旋转角度:792,请设置缩放比例:793,"请设置选择范围:":794,请选择目标块:795,请设置统计范围:796,"指定表格插入点:":797,选择目标曲线:798,指定长度标注点:799,选择目标对象:800,请选择目标斜率对象:801,请设置标注文字高度:802,指定斜率标注点:803,请选择目标坐标点:804,请指定标注位置:805,指定起点:806,指定终点:807,指定标注方向:808,请设置文字内容:809,请选择面积的第一个点:810,请选择下一个点:811,请选择面积标注的位置:812,请选择矩形的角点1:813,请选择矩形的角点2:814,请设置面积标注的位置:815,请选择一个测量点:816,请选择一条直线:817,请设置尺寸线的位置:818,请选择一条弧线:819,请指定尺寸线位置:820,请选择一个圆对象:821,请指定文字位置:822,请选择直线的端点或弧线:823,请指定文字的位置:824,请选择一个连续测量的标注:825,请选择第二条直线:826,请设置角度标注的位置:827," 请输入星形顶点数：":828," 指定星形中心点:":829,"请设置星形的内半径:":830," 指定星形的外半径:":831," 请输入凹凸线宽度<5>":832," 请输入凹凸线高度<10>":833,请点击确定起始点:834,请点击确定终点:835," 请输入锯齿线宽度<5>":836," 请输入锯齿线高度<10>":837," 请输入矩形宽度<5>":838," 请输入矩形高度<10>":839,请点击确定矩形中心:840," 请输入管径<10>":841," 请输入长出管口长度<5>":842,请点击确定起点:843,指定剖管线起点:844,指定剖管线终点:845,选择剖管线圆弧方向:846,左边:847,右边:848,选择模式:849,直线焊缝:850,弧线焊缝:851," 请输入焊缝半径<5>":852,指定圆弧的第二个点:853,指定圆弧的端点:854,"请输入宽度<25>":855,"请输入高度<15>":856,"请输入楼梯级数<10>":857,"请确定圆心位置 ":858,请输入圆半径:859," 请输入保温棉宽度<5>":860," 请输入保温棉高度<10>":861,请点击下一个点:862,请选择第一条线:863,请选择第二条线:864,请选择终点:865,请选择目标矩形:866,设置指北针中心点:867,设置指北针半径:868,选择提示框指向:869," 指定消息框第一点:":870," 指定消息框第二点:":871," 设置消息框指向:":872,请设置基准符文字:873,请设置文字高度:874,请设置基准符位置:875,请设置定位点或圆弧或直线:876,请设置符号位置:877,请设置圆心:878,请设置齿轮圆心:879,请设置齿轮半径:880," 请设置中心线长度10>":881,请选择第一个圆:882,请选择第二个圆:883,请设置矩形左上角点:884,请设置矩形右下角点:885,请设置圆角半径:886,请选择多边形起点:887,请选择多边形顶点:888,请输入表格提取精度:1996,选择提取范围第一个角点:1997,选择提取范围第二个角点:1998,"未识别到有效表格!":1999,"请在本地环境测试！":2e3,"选择对象:":889,指定基点:890,"指定第二个点 ":891,阵列:892,退出:893,放弃:894,"输入要进行阵列的项目数 ":895,选择圆弧对象:896,"选择复制旋转对象:":897,"请指定目标点 ":898,请指定旋转角度:899,选择要转成多边形的对象:900,设置多边形边数:901," 输入选项":902,内接于圆:903,外切于圆:904,选择要修改颜色的对象:905,输入颜色索引:906,隐藏:907,隐藏未选:908,全部显示:909,选择目标的对象:910," 指定删除方框第一点:":911," 指定删除方框第二点:":912," 选择需要精确删除的实体":913," 请选择角度复制对象":914," 请输入角度复制数量":915," 请输入角度复制的基点":916," 请输入复制角度":917,请选择顶点对象:918,请选择复制对象:919,请确定复制基点:920,请选择参考曲线:921,选择打断对象:922,指定偏移对象:923,请输入偏移距离:924,"指定伸缩对象(选择直线、多段线、圆弧)":925,伸缩至:926,选择要修改线型比例的对象:927,请输入线型比例:928,请输入阵列间距:929,请选择圆弧:930,选择排列对象:931,指定排列基点:932,"选择目标多段线:":933,"请输入圆角半径<5>":934,选择填充对象:935,请输入填充比例:936,请选择原填充图形:937,请点击填充图形内部任意一点:938,请选择线对象:939,选择等分模式:940,定距等分:941,定数等分:942,偏移等分:943,复制等分:944,请选择偏移等分对象:945,请选择复制等分对象:946,请选择需要等分的线段:947,请设置等分距离:948,请设置等分的数量:949,请设置偏移距离:950,请指定偏移点:951,请指定复制基点:952,请指定复制等分数量:953,请指定复制等分端点:954,"请选择需要矩形缩放的实体:":955,请指定矩形的角点1:956,请指定矩形角点2:957,请选择放大中心点:958,请选择放大范围:959,请设置放大倍数:960,请选择放大插入点:961,请选择一条需要打断的曲线:962,请在曲线上选取打断点:963,请输入阵列数量:964,是否开启旋转:965,是:966,否:967,"请选择需要阵列的图形:":968,请选择阵列中心点:969,"请选择闭合多边形！":970,请选择第一个点:971,请选择第二个点:972,请选择第一个闭合多边形:973,请选择第二个闭合多边形:974,请选择两个闭合多边形:975,"两个多边形没有重合边！":976,请选择目标多边形:977,请选择多边形需要添加顶点的边:978,请设置添加的顶点位置:979,请选择多边形需要删除的顶点:980,请选择多边形需要拉伸的边:981,请指定拉伸位置:982,"请设置图框方向<N>":983,横向:984,纵向:985,"请设置图框尺寸<4>":986,请设置图框位置:987,指定裁剪角点1:988,指定裁剪角点2:989,请设置道路起点:990,请设置下一点:991,"请选择目标对齐线对象(选择直线)":992,请选择目标文字对象:993,选择文字对象:994,请设置字高:995,请设置字宽:996,请选择源文字:997,请选择第一个文字:998,请选择第二个文字:999,请选择需要对齐的文字:1e3,请选择对齐方式:1001,左:1002,中:1003,右:1004,请选择对齐基点:1005,请选择需要反转的文字:1006,请选择需要去空格的文字:1007,请选择文字对象:1008,"请输入下划线宽度 ":1009,"请设置下划线距离 ":1010,"请设置下划线延长距离 ":1011,"请选择操作选项 ":1012,大写:1013,小写:1014,句首大写:1015,请选择数字对象:1016,"请选择文字插入点 ":1017,"选择要查找的范围:":1018,"请选择查找模式 ":1019,等于:1020,包含:1021,前缀为:1022,后缀为:1023,"请输入关键字 ":1024,"选择要操作的范围:":1025,选择操作方式:1026,添加:1027,删除:1028,选择操作位置:1029,前缀:1030,后缀:1031,请输入内容:1032,"请选择文本 ":1033,"请选择圆弧 ":1034,请选择文字样式:1035,请设置文字提取范围:1036,输入编号文字:2019,请选择一个单行文本:2020,请选择一个多行文本:2021,请设置文字插入点:2022,请选择单行文本:2023,下载开Demo代码:1037,下载开发包:1038,调用画圆线命令:1039,交互画直线:1040,添加图层:1041,得到所有图层:1042,得到所有文字样式:1043,得到所有图块:1044,得到所有线型:1045,写扩展数据:1046,读扩展数据:1047,测试插入一个图块:1048,绘直线:1049,绘圆弧:1050,绘圆:1051,绘PL线:1052,绘填充:1053,绘文字:1054,绘椭圆:1055,绘椭圆弧:1056,绘制多行文字:1057,绘制表格:1058,绘制二维码:1059,插入图章:1060,得到所有对象:1061,交互选择对象:1062,保存mxweb到服务器:1063,得到系统变量:1064,新建图纸:1065,白色背景色:1066,文字查找定位:1067,选择实体做块:1068,绘制单行文字:1069,选点填充:1070,设置扩展属性:1071,绘制对齐标注:1072,绘性线标注:1073,角度标注:1074,修改对象线型:1075,选择隐藏对象层:1076,添加到当前选择:1077,视区旋转:1078,写扩展记录:1079,得到命名字典:1080,添加文字样式:1081,绘自定义实体:1082,修改对象颜色:1083,修改对象不可见:1084,修改对象层:1085,修改对象显示顺序:1086,指定范围输出pdf:1087,绘制image:1088,读取对象扩展字典:1089,绘制3DPolyline:1090,绘线文本自定义实体:1091,计算交点:1092,修改文字样式:1093,偏移输入画线:1094,创建组:1095,屏幕截图jpg:1096,获取图纸相同文字:1097,指定范围输出dwg:1098,测试绘制标记圆:1099,测试Wipeout:1100,创建剪切块:1101,公差标注:1102,改所有对象颜色:1103,切剪mxweb:1104,设置当前颜色线重:1105,查找多边形区域内对象:1106,打碎对象:1107,绘半透明线:1108,添加线型:1109,修改图案比例:1110,测试文字编辑:1111,绘制条形码:1112,屏幕截图bmp:1113,修改工具:1114,文字工具:1115,绘图工具:1116,块工具:1117,测量工具:1118,标注工具:1119,其他工具:1120,多重复制:1121,弧转圆:1122,复制旋转:1123,圆转多边:1124,修改颜色:1125,圆弧切角:1126,临时隐藏:1127,方框删除:1128,角度复制:1129,顶点复制:1130,交点打断:1131,双向偏移:1132,改圆大小:1133,线型比例:1134,伸缩:1135,按弧阵列:1136,pl圆角:1137,pl线反向:1138,得到所有直线对象:1139,等分:1140,矩形缩放:1141,打断:1142,切割多边形:1143,合并多边形:1144,添加多边形顶点:1145,删除多边形顶点:1146,多边形单边拉伸:1147,星形:1148,凹凸线:1149,锯齿线:1150,中心矩形:1151,圆角矩形:1152,圆中心线:1153,管道:1154,剖管符:1155,中垂线:1156,楼梯:1157,实心圆:1158,保温棉:1159,中心线:1160,开洞:1161,消息框:1162,"基准符（1）":1163,焊缝线:1164,同心圆:1165,齿轮:1166,块中心线:1167,圆公切线:1168,"基准符（2）":1169,插入图框:1170,绘制道路:1171,绘任意多边形:1172,按线对齐:1173,改字高:1174,改字宽:1175,刷内容:1176,换内容:1177,左右对齐:1178,上下对齐:1179,文字反转:1180,文字加框:1181,下划线:1182,图名线:1183,大小写:1184,数字求和:1185,选特定字:1186,前后缀:1187,连接文字:1188,去空格:1189,文字竖向:1190,按弧对齐:1191,修改全局文字样式:1192,提取文字:1193,文字编号:1194,多单转一多:2024,单转多:2025,多转多个单:2026,多转单个单:2027,改块名:1195,刷块:1196,块连线:1197,改块基点:1198,改块颜色:1199,多块旋转:1200,多块缩放:1201,刷块角度:1202,按块选择:1203,按块全选:1204,统计单块:1205,统计多块:1206,修改块图层:1207,长度:1208,统计面积:1209,智能标高:1210,面积:1211,矩形面积:1212,点到直线的距离:1213,弧长:1214,测量圆:1215,连续测量:1216,查看分段长度:1217,面积含弧线:1218,审图标注:1219,矩形标注:1220,粗糙度标注:1221,坐标标注:1222,标斜率:1223,对齐:1224,局部放大:1225,序号标注:1226,旋转标注:1227,圆孔标记:1228,向视符号:1229,射线标注:1230,矩形标注悬停变色:1231,裁剪图纸扩展:1232,箭头直线:1233,提取表格:1985,在线编辑表格:2001,选择的文字:1234,复制到剪贴板:1235,取消:1236,确定:1237,公差代号:1238,公差1:1239,公差2:1240,附注:1241,顶端:1242,底端:1243,基准:1244,全周符号:1245,当前行:1246,增加行:1247,删除行:1248,清零:1249,直线度:1250,平面度:1251,圆度:1252,圆柱度:1253,线轮廓度:1254,面轮廓度:1255,平行度:1256,垂直度:1257,倾斜度:1258,位置度:1259,同轴度:1260,对称度:1261,圆跳动:1262,全跳动:1263,清除:1264,"请输入文本内容和编号：":1265,"文本内容：":1266,"(输入0-20个字)":1267,"起始编号：":1268,"(编号自动递增1)":1269,"编号位置：":1270,编号在前:1271,编号在后:1272,改变方向:1273,"左边文字内容：":1274,"右边文字内容：":1275,"底部文字内容：":1276,基本符号:1277,相同要求:1278,多数符号:1279,长边加横线:1280,辅助符号:1281,补充符号:1282,符号位置:1283,特殊符号:1284,左尺寸:1285,上尺寸:1286,右尺寸:1287,交错焊缝:1288,间距:1289,扩充文字:1290,虚线位置:1291,焊接说明:1292,清除行:1293,卷边焊缝:1294,I型焊缝:1295,V型焊缝:1296,单边V型焊缝:1297,单边陡侧V型坡口堆焊:1298,倾斜焊缝:1299,可移除衬垫:1300,持久衬垫:1301,带顿边V型焊缝:1302,带顿边U型焊缝:1303,带顿边单边V型焊缝:1304,带顿边单边U型焊缝:1305,端接焊缝:1306,堆焊接头:1307,封底焊缝:1308,角焊缝:1309,塞焊缝或槽焊缝:1310,点焊缝:1311,折叠接口:1312,倾斜接口:1313,"点焊缝（偏移中心）":1314,缝焊缝:1315,"缝焊缝（偏离中心）":1316,陡侧V型坡口堆焊:1317,第一种平面符号:1318,第二种凹面符号:1319,第二种凸面符号:1320,第二种平面符号:1321,第一种凸面符号:1322,第三种平面符号:1323,第一种凹面符号:1324,削平焊缝:1325,趾部平滑过渡:1326,带垫板符号:1327,三面焊缝符号:1328,周围焊接符:1329,现场符号:1330,尾部符号:1331,交错断续焊接符号:1332,喇叭形焊缝:1333,单边喇叭形焊缝:1334,堆焊缝:1335,锁边焊缝:1336,锁边坡口:1337,上:1338,下:1339,无:1340,basicSymbol:1341,auxiliarySymbol:1342,suppleSymbol:1343,specialSymbol:1344,选择要在几何图形上放置的焊缝符号:1345,"焊角宽度：":1346,"单边V型对接焊缝（前视图）":1347,"角焊缝（前视图）":1348,"单边V型对接焊缝（侧视图）":1349,"角焊缝（侧视图）":1350},fE=void 0,pE=void 0,mE={languages:[{name:"zh-CN",title:"中文",active:!0,default:!0},{name:"en-US",title:"英语"},{name:"ko-KR",title:"韩语"},{name:"zh-TW",title:"繁体中文"}],library:!0,debug:!1},gE={"zh-CN":{718:" 指定输出范围第一点:",719:" 指定输出范围第二点:",720:" 指定第一点:",721:" 指定第二点:",722:" 云线框起始点:",723:" 云线框结束点:",724:" 审图标注点:",725:" 点击开启绘制云线:",726:" 再次点击结束绘制云线:",727:"指定一点:",728:"指定二点:",729:"选择对象",730:" 指定下一个点:",731:"\\指定插入基点",732:" 指定表格插入点:",733:"指定插入点:",734:"指定插入基点",735:"选择标注对象",736:"请选择目标文字",737:" 指定填充区域内部一点:",738:"没有找到闭合区域 ",739:"表面粗糙度",740:"焊接符号",741:"形位公差",742:"选择要需要开启自定义属性的对象",743:"选择要隐藏的对象",744:" 指定插入点:",745:" 指定一点:",746:"指定夹角",747:" 指定二点:",748:"选择图案填充对象",749:"指定第一点:",750:"指定第二点:",751:"指定第二个角度点:",752:"指定最后一个点:",753:"指定坐标点:",754:"指定标注点:",755:"请输入审批意见",756:"指定云线框起始点",757:"指定云线框终止点",758:"指定审图标注点",759:"指定第一个角点:",760:"指定第二个角点:",761:"指定序号位置:",762:"旋转符号",763:"标记类型",764:"请选择需要标记的圆:",765:"请设置定位点或直线或圆弧或圆",766:"拖动确定标注位置",767:"请指定或输入角度",768:"焊缝符号",769:"请拾取定位点、直线或圆弧",770:"请指定第二点",771:"请设置定位点",772:"请设置角度",773:"请设置定位点或直线或圆弧",774:"请设置引线转折点",775:"拖动确定定位点",776:"请指定第一点:",777:"请指定第二点:",778:"请选择目标块对象",779:"请输入新块名",780:"选择需要修改基点的块",781:"设置基点",782:"选择需要修改颜色的块",783:"输入颜色索引(0~256)",784:"请选择源块",785:"选择要刷的目标块:",786:"选择连接方式",787:"手动逐个连线",788:"自动批量连线",789:"请选择连线的块",790:"设置中心线长度",791:"选择要旋转的目标块:",792:"设置旋转角度",793:"请设置缩放比例",794:"请设置选择范围:",795:"请选择目标块",796:"请设置统计范围",797:"指定表格插入点:",798:"选择目标曲线",799:"指定长度标注点",800:"选择目标对象",801:"请选择目标斜率对象",802:"请设置标注文字高度",803:"指定斜率标注点",804:"请选择目标坐标点",805:"请指定标注位置",806:"指定起点",807:"指定终点",808:"指定标注方向",809:"请设置文字内容",810:"请选择面积的第一个点",811:"请选择下一个点",812:"请选择面积标注的位置",813:"请选择矩形的角点1",814:"请选择矩形的角点2",815:"请设置面积标注的位置",816:"请选择一个测量点",817:"请选择一条直线",818:"请设置尺寸线的位置",819:"请选择一条弧线",820:"请指定尺寸线位置",821:"请选择一个圆对象",822:"请指定文字位置",823:"请选择直线的端点或弧线",824:"请指定文字的位置",825:"请选择一个连续测量的标注",826:"请选择第二条直线",827:"请设置角度标注的位置",828:" 请输入星形顶点数：",829:" 指定星形中心点:",830:"请设置星形的内半径:",831:" 指定星形的外半径:",832:" 请输入凹凸线宽度<5>",833:" 请输入凹凸线高度<10>",834:"请点击确定起始点",835:"请点击确定终点",836:" 请输入锯齿线宽度<5>",837:" 请输入锯齿线高度<10>",838:" 请输入矩形宽度<5>",839:" 请输入矩形高度<10>",840:"请点击确定矩形中心",841:" 请输入管径<10>",842:" 请输入长出管口长度<5>",843:"请点击确定起点",844:"指定剖管线起点",845:"指定剖管线终点",846:"选择剖管线圆弧方向",847:"左边",848:"右边",849:"选择模式",850:"直线焊缝",851:"弧线焊缝",852:" 请输入焊缝半径<5>",853:"指定圆弧的第二个点",854:"指定圆弧的端点",855:"请输入宽度<25>",856:"请输入高度<15>",857:"请输入楼梯级数<10>",858:"请确定圆心位置 ",859:"请输入圆半径",860:" 请输入保温棉宽度<5>",861:" 请输入保温棉高度<10>",862:"请点击下一个点",863:"请选择第一条线",864:"请选择第二条线",865:"请选择终点",866:"请选择目标矩形",867:"设置指北针中心点",868:"设置指北针半径",869:"选择提示框指向",870:" 指定消息框第一点:",871:" 指定消息框第二点:",872:" 设置消息框指向:",873:"请设置基准符文字",874:"请设置文字高度",875:"请设置基准符位置",876:"请设置定位点或圆弧或直线",877:"请设置符号位置",878:"请设置圆心",879:"请设置齿轮圆心",880:"请设置齿轮半径",881:" 请设置中心线长度10>",882:"请选择第一个圆",883:"请选择第二个圆",884:"请设置矩形左上角点",885:"请设置矩形右下角点",886:"请设置圆角半径",887:"请选择多边形起点",888:"请选择多边形顶点",889:"选择对象:",890:"指定基点",891:"指定第二个点 ",892:"阵列",893:"退出",894:"放弃",895:"输入要进行阵列的项目数 ",896:"选择圆弧对象",897:"选择复制旋转对象:",898:"请指定目标点 ",899:"请指定旋转角度",900:"选择要转成多边形的对象",901:"设置多边形边数",902:" 输入选项",903:"内接于圆",904:"外切于圆",905:"选择要修改颜色的对象",906:"输入颜色索引",907:"隐藏",908:"隐藏未选",909:"全部显示",910:"选择目标的对象",911:" 指定删除方框第一点:",912:" 指定删除方框第二点:",913:" 选择需要精确删除的实体",914:" 请选择角度复制对象",915:" 请输入角度复制数量",916:" 请输入角度复制的基点",917:" 请输入复制角度",918:"请选择顶点对象",919:"请选择复制对象",920:"请确定复制基点",921:"请选择参考曲线",922:"选择打断对象",923:"指定偏移对象",924:"请输入偏移距离",925:"指定伸缩对象(选择直线、多段线、圆弧)",926:"伸缩至",927:"选择要修改线型比例的对象",928:"请输入线型比例",929:"请输入阵列间距",930:"请选择圆弧",931:"选择排列对象",932:"指定排列基点",933:"选择目标多段线:",934:"请输入圆角半径<5>",935:"选择填充对象",936:"请输入填充比例",937:"请选择原填充图形",938:"请点击填充图形内部任意一点",939:"请选择线对象",940:"选择等分模式",941:"定距等分",942:"定数等分",943:"偏移等分",944:"复制等分",945:"请选择偏移等分对象",946:"请选择复制等分对象",947:"请选择需要等分的线段",948:"请设置等分距离",949:"请设置等分的数量",950:"请设置偏移距离",951:"请指定偏移点",952:"请指定复制基点",953:"请指定复制等分数量",954:"请指定复制等分端点",955:"请选择需要矩形缩放的实体:",956:"请指定矩形的角点1",957:"请指定矩形角点2",958:"请选择放大中心点",959:"请选择放大范围",960:"请设置放大倍数",961:"请选择放大插入点",962:"请选择一条需要打断的曲线",963:"请在曲线上选取打断点",964:"请输入阵列数量",965:"是否开启旋转",966:"是",967:"否",968:"请选择需要阵列的图形:",969:"请选择阵列中心点",970:"请选择闭合多边形！",971:"请选择第一个点",972:"请选择第二个点",973:"请选择第一个闭合多边形",974:"请选择第二个闭合多边形",975:"请选择两个闭合多边形",976:"两个多边形没有重合边！",977:"请选择目标多边形",978:"请选择多边形需要添加顶点的边",979:"请设置添加的顶点位置",980:"请选择多边形需要删除的顶点",981:"请选择多边形需要拉伸的边",982:"请指定拉伸位置",983:"请设置图框方向<N>",984:"横向",985:"纵向",986:"请设置图框尺寸<4>",987:"请设置图框位置",988:"指定裁剪角点1",989:"指定裁剪角点2",990:"请设置道路起点",991:"请设置下一点",992:"请选择目标对齐线对象(选择直线)",993:"请选择目标文字对象",994:"选择文字对象",995:"请设置字高",996:"请设置字宽",997:"请选择源文字",998:"请选择第一个文字",999:"请选择第二个文字",1e3:"请选择需要对齐的文字",1001:"请选择对齐方式",1002:"左",1003:"中",1004:"右",1005:"请选择对齐基点",1006:"请选择需要反转的文字",1007:"请选择需要去空格的文字",1008:"请选择文字对象",1009:"请输入下划线宽度 ",1010:"请设置下划线距离 ",1011:"请设置下划线延长距离 ",1012:"请选择操作选项 ",1013:"大写",1014:"小写",1015:"句首大写",1016:"请选择数字对象",1017:"请选择文字插入点 ",1018:"选择要查找的范围:",1019:"请选择查找模式 ",1020:"等于",1021:"包含",1022:"前缀为",1023:"后缀为",1024:"请输入关键字 ",1025:"选择要操作的范围:",1026:"选择操作方式",1027:"添加",1028:"删除",1029:"选择操作位置",1030:"前缀",1031:"后缀",1032:"请输入内容",1033:"请选择文本 ",1034:"请选择圆弧 ",1035:"请选择文字样式",1036:"请设置文字提取范围",1037:"下载开Demo代码",1038:"下载开发包",1039:"调用画圆线命令",1040:"交互画直线",1041:"添加图层",1042:"得到所有图层",1043:"得到所有文字样式",1044:"得到所有图块",1045:"得到所有线型",1046:"写扩展数据",1047:"读扩展数据",1048:"测试插入一个图块",1049:"绘直线",1050:"绘圆弧",1051:"绘圆",1052:"绘PL线",1053:"绘填充",1054:"绘文字",1055:"绘椭圆",1056:"绘椭圆弧",1057:"绘制多行文字",1058:"绘制表格",1059:"绘制二维码",1060:"插入图章",1061:"得到所有对象",1062:"交互选择对象",1063:"保存mxweb到服务器",1064:"得到系统变量",1065:"新建图纸",1066:"白色背景色",1067:"文字查找定位",1068:"选择实体做块",1069:"绘制单行文字",1070:"选点填充",1071:"设置扩展属性",1072:"绘制对齐标注",1073:"绘性线标注",1074:"角度标注",1075:"修改对象线型",1076:"选择隐藏对象层",1077:"添加到当前选择",1078:"视区旋转",1079:"写扩展记录",1080:"得到命名字典",1081:"添加文字样式",1082:"绘自定义实体",1083:"修改对象颜色",1084:"修改对象不可见",1085:"修改对象层",1086:"修改对象显示顺序",1087:"指定范围输出pdf",1088:"绘制image",1089:"读取对象扩展字典",1090:"绘制3DPolyline",1091:"绘线文本自定义实体",1092:"计算交点",1093:"修改文字样式",1094:"偏移输入画线",1095:"创建组",1096:"屏幕截图jpg",1097:"获取图纸相同文字",1098:"指定范围输出dwg",1099:"测试绘制标记圆",1100:"测试Wipeout",1101:"创建剪切块",1102:"公差标注",1103:"改所有对象颜色",1104:"切剪mxweb",1105:"设置当前颜色线重",1106:"查找多边形区域内对象",1107:"打碎对象",1108:"绘半透明线",1109:"添加线型",1110:"修改图案比例",1111:"测试文字编辑",1112:"绘制条形码",1113:"屏幕截图bmp",1114:"修改工具",1115:"文字工具",1116:"绘图工具",1117:"块工具",1118:"测量工具",1119:"标注工具",1120:"其他工具",1121:"多重复制",1122:"弧转圆",1123:"复制旋转",1124:"圆转多边",1125:"修改颜色",1126:"圆弧切角",1127:"临时隐藏",1128:"方框删除",1129:"角度复制",1130:"顶点复制",1131:"交点打断",1132:"双向偏移",1133:"改圆大小",1134:"线型比例",1135:"伸缩",1136:"按弧阵列",1137:"pl圆角",1138:"pl线反向",1139:"得到所有直线对象",1140:"等分",1141:"矩形缩放",1142:"打断",1143:"切割多边形",1144:"合并多边形",1145:"添加多边形顶点",1146:"删除多边形顶点",1147:"多边形单边拉伸",1148:"星形",1149:"凹凸线",1150:"锯齿线",1151:"中心矩形",1152:"圆角矩形",1153:"圆中心线",1154:"管道",1155:"剖管符",1156:"中垂线",1157:"楼梯",1158:"实心圆",1159:"保温棉",1160:"中心线",1161:"开洞",1162:"消息框",1163:"基准符（1）",1164:"焊缝线",1165:"同心圆",1166:"齿轮",1167:"块中心线",1168:"圆公切线",1169:"基准符（2）",1170:"插入图框",1171:"绘制道路",1172:"绘任意多边形",1173:"按线对齐",1174:"改字高",1175:"改字宽",1176:"刷内容",1177:"换内容",1178:"左右对齐",1179:"上下对齐",1180:"文字反转",1181:"文字加框",1182:"下划线",1183:"图名线",1184:"大小写",1185:"数字求和",1186:"选特定字",1187:"前后缀",1188:"连接文字",1189:"去空格",1190:"文字竖向",1191:"按弧对齐",1192:"修改全局文字样式",1193:"提取文字",1194:"文字编号",1195:"改块名",1196:"刷块",1197:"块连线",1198:"改块基点",1199:"改块颜色",1200:"多块旋转",1201:"多块缩放",1202:"刷块角度",1203:"按块选择",1204:"按块全选",1205:"统计单块",1206:"统计多块",1207:"修改块图层",1208:"长度",1209:"统计面积",1210:"智能标高",1211:"面积",1212:"矩形面积",1213:"点到直线的距离",1214:"弧长",1215:"测量圆",1216:"连续测量",1217:"查看分段长度",1218:"面积含弧线",1219:"审图标注",1220:"矩形标注",1221:"粗糙度标注",1222:"坐标标注",1223:"标斜率",1224:"对齐",1225:"局部放大",1226:"序号标注",1227:"旋转标注",1228:"圆孔标记",1229:"向视符号",1230:"射线标注",1231:"矩形标注悬停变色",1232:"裁剪图纸扩展",1233:"箭头直线",1234:"选择的文字",1235:"复制到剪贴板",1236:"取消",1237:"确定",1238:"公差代号",1239:"公差1",1240:"公差2",1241:"附注",1242:"顶端",1243:"底端",1244:"基准",1245:"全周符号",1246:"当前行",1247:"增加行",1248:"删除行",1249:"清零",1250:"直线度",1251:"平面度",1252:"圆度",1253:"圆柱度",1254:"线轮廓度",1255:"面轮廓度",1256:"平行度",1257:"垂直度",1258:"倾斜度",1259:"位置度",1260:"同轴度",1261:"对称度",1262:"圆跳动",1263:"全跳动",1264:"清除",1265:"请输入文本内容和编号：",1266:"文本内容：",1267:"(输入0-20个字)",1268:"起始编号：",1269:"(编号自动递增1)",1270:"编号位置：",1271:"编号在前",1272:"编号在后",1273:"改变方向",1274:"左边文字内容：",1275:"右边文字内容：",1276:"底部文字内容：",1277:"基本符号",1278:"相同要求",1279:"多数符号",1280:"长边加横线",1281:"辅助符号",1282:"补充符号",1283:"符号位置",1284:"特殊符号",1285:"左尺寸",1286:"上尺寸",1287:"右尺寸",1288:"交错焊缝",1289:"间距",1290:"扩充文字",1291:"虚线位置",1292:"焊接说明",1293:"清除行",1294:"卷边焊缝",1295:"I型焊缝",1296:"V型焊缝",1297:"单边V型焊缝",1298:"单边陡侧V型坡口堆焊",1299:"倾斜焊缝",1300:"可移除衬垫",1301:"持久衬垫",1302:"带顿边V型焊缝",1303:"带顿边U型焊缝",1304:"带顿边单边V型焊缝",1305:"带顿边单边U型焊缝",1306:"端接焊缝",1307:"堆焊接头",1308:"封底焊缝",1309:"角焊缝",1310:"塞焊缝或槽焊缝",1311:"点焊缝",1312:"折叠接口",1313:"倾斜接口",1314:"点焊缝（偏移中心）",1315:"缝焊缝",1316:"缝焊缝（偏离中心）",1317:"陡侧V型坡口堆焊",1318:"第一种平面符号",1319:"第二种凹面符号",1320:"第二种凸面符号",1321:"第二种平面符号",1322:"第一种凸面符号",1323:"第三种平面符号",1324:"第一种凹面符号",1325:"削平焊缝",1326:"趾部平滑过渡",1327:"带垫板符号",1328:"三面焊缝符号",1329:"周围焊接符",1330:"现场符号",1331:"尾部符号",1332:"交错断续焊接符号",1333:"喇叭形焊缝",1334:"单边喇叭形焊缝",1335:"堆焊缝",1336:"锁边焊缝",1337:"锁边坡口",1338:"上",1339:"下",1340:"无",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"选择要在几何图形上放置的焊缝符号",1346:"焊角宽度：",1347:"单边V型对接焊缝（前视图）",1348:"角焊缝（前视图）",1349:"单边V型对接焊缝（侧视图）",1350:"角焊缝（侧视图）",1985:"提取表格",1996:"请输入表格提取精度",1997:"选择提取范围第一个角点",1998:"选择提取范围第二个角点",1999:"未识别到有效表格!",2e3:"请在本地环境测试！",2001:"在线编辑表格",2019:"输入编号文字",2020:"请选择一个单行文本",2021:"请选择一个多行文本",2022:"请设置文字插入点",2023:"请选择单行文本",2024:"多单转一多",2025:"单转多",2026:"多转多个单",2027:"多转单个单"},"en-US":()=>b1(()=>Promise.resolve().then(()=>_O),void 0),"ko-KR":()=>b1(()=>Promise.resolve().then(()=>wO),void 0),"zh-TW":()=>b1(()=>Promise.resolve().then(()=>MO),void 0)},nd=new HS(wi({id:"mxcad-plugin__1_0_0",idMap:dE,formatters:cE,storage:XS,messages:gE,paragraphs:hE,component:fE,loader:uE,transform:pE},mE)),yE=nd.t;nd.$t,nd.Translate;const h_=k.ref();nd.on("change",t=>{h_.value=t});const dt=(t,...n)=>(h_.value,nd.t(t,...n)),bE=t=>(k.pushScopeId("data-v-a388a3ba"),t=t(),k.popScopeId(),t),vE={key:0,class:"modal-wrapper",id:"modal"},xE={class:"modal-body card"},_E={class:"modal-header"},wE={class:"heading"},ME=[bE(()=>k.createElementVNode("svg",{viewBox:"0 0 24 24"},[k.createElementVNode("path",{d:"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"})],-1))],AE={style:{"overflow-y":"auto",height:"500px"}},SE={class:"btn_box"},EE={class:"btn_box"},TE={class:"btn_box"},CE={class:"btn_box"},PE={class:"btn_box"},DE={class:"btn_box"},RE={class:"btn_box"},kE={class:"btn_box"},IE={class:"btn_box"},LE={class:"btn_box"},BE={class:"btn_box"},FE={class:"btn_box"},NE={class:"btn_box"},OE={class:"btn_box"},zE={class:"btn_box"},UE={class:"btn_box"},VE={class:"btn_box"},jE={class:"btn_box"},GE={class:"btn_box"},HE={class:"btn_box"},WE=k.defineComponent({__name:"Modal",setup(t){const{isModalVisible:n,hideModal:e,modalOptions:i}=Up(),s=k.ref(!1);return k.watch(()=>n.value,a=>{a&&(s.value=localStorage.getItem("language")==="en")}),(a,o)=>(k.openBlock(),k.createBlock(k.Teleport,{to:"body"},[k.unref(n)?(k.openBlock(),k.createElementBlock("div",vE,[k.createElementVNode("div",xE,[k.createElementVNode("div",_E,[k.createElementVNode("h2",wE,k.toDisplayString(k.unref(i).title),1),k.createElementVNode("a",{href:"#!",onClick:o[0]||(o[0]=(...r)=>k.unref(e)&&k.unref(e)(...r)),role:"button",class:"close","aria-label":"close this modal"},ME)]),k.createElementVNode("div",AE,[k.createElementVNode("div",SE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[1]||(o[1]=r=>k.unref(i).docommand("Mx_Open_DemoCode"))},k.toDisplayString(k.unref(dt)("下载开Demo代码")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[2]||(o[2]=r=>k.unref(i).docommand("Mx_Open_DevInstall"))},k.toDisplayString(k.unref(dt)("下载开发包")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[3]||(o[3]=(...r)=>k.unref(i).ondrawline&&k.unref(i).ondrawline(...r))},k.toDisplayString(k.unref(dt)("调用画圆线命令")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[4]||(o[4]=r=>k.unref(i).docommand("MxTest_DrawLine"))},k.toDisplayString(k.unref(dt)("交互画直线")),3)]),k.createElementVNode("div",EE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[5]||(o[5]=r=>k.unref(i).docommand("MxTest_AddLayer"))},k.toDisplayString(k.unref(dt)("添加图层")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[6]||(o[6]=r=>k.unref(i).docommand("MxTest_GetAllLayer"))},k.toDisplayString(k.unref(dt)("得到所有图层")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[7]||(o[7]=r=>k.unref(i).docommand("MxTest_GetAllTextStyle"))},k.toDisplayString(k.unref(dt)("得到所有文字样式")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[8]||(o[8]=r=>k.unref(i).docommand("MxTest_GetAllBlock"))},k.toDisplayString(k.unref(dt)("得到所有图块")),3)]),k.createElementVNode("div",TE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[9]||(o[9]=r=>k.unref(i).docommand("MxTest_GetAllLinetype"))},k.toDisplayString(k.unref(dt)("得到所有线型")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[10]||(o[10]=r=>k.unref(i).docommand("MxTest_WritexData"))},k.toDisplayString(k.unref(dt)("写扩展数据")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[11]||(o[11]=r=>k.unref(i).docommand("MxTest_ReadxData"))},k.toDisplayString(k.unref(dt)("读扩展数据")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[12]||(o[12]=r=>k.unref(i).docommand("MxTest_InsertBlock"))},k.toDisplayString(k.unref(dt)("测试插入一个图块")),3)]),k.createElementVNode("div",CE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[13]||(o[13]=r=>k.unref(i).docommand("Mx_Test_DrawLine"))},k.toDisplayString(k.unref(dt)("绘直线")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[14]||(o[14]=r=>k.unref(i).docommand("Mx_Test_DrawArc"))},k.toDisplayString(k.unref(dt)("绘圆弧")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[15]||(o[15]=r=>k.unref(i).docommand("Mx_Test_DrawCircle"))},k.toDisplayString(k.unref(dt)("绘圆")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[16]||(o[16]=r=>k.unref(i).docommand("Mx_Test_DrawPolyline"))},k.toDisplayString(k.unref(dt)("绘PL线")),3)]),k.createElementVNode("div",PE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[17]||(o[17]=r=>k.unref(i).docommand("Mx_Test_DrawHatch"))},k.toDisplayString(k.unref(dt)("绘填充")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[18]||(o[18]=r=>k.unref(i).docommand("Mx_Test_DrawText"))},k.toDisplayString(k.unref(dt)("绘文字")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[19]||(o[19]=r=>k.unref(i).docommand("Mx_Test_Ellipse"))},k.toDisplayString(k.unref(dt)("绘椭圆")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[20]||(o[20]=r=>k.unref(i).docommand("Mx_Test_EllipseArc"))},k.toDisplayString(k.unref(dt)("绘椭圆弧")),3)]),k.createElementVNode("div",DE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[21]||(o[21]=r=>k.unref(i).docommand("Mx_Test_MText"))},k.toDisplayString(k.unref(dt)("绘制多行文字")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[22]||(o[22]=r=>k.unref(i).docommand("Mx_Test_DrawTable"))},k.toDisplayString(k.unref(dt)("绘制表格")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[23]||(o[23]=r=>k.unref(i).docommand("Mx_Test_QRCode"))},k.toDisplayString(k.unref(dt)("绘制二维码")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[24]||(o[24]=r=>k.unref(i).docommand("MxTest_InsertStamp"))},k.toDisplayString(k.unref(dt)("插入图章")),3)]),k.createElementVNode("div",RE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[25]||(o[25]=(...r)=>k.unref(i).ongetallentity&&k.unref(i).ongetallentity(...r))},k.toDisplayString(k.unref(dt)("得到所有对象")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[26]||(o[26]=r=>k.unref(i).docommand("MxTest_SelectEntity"))},k.toDisplayString(k.unref(dt)("交互选择对象")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[27]||(o[27]=r=>k.unref(i).docommand("Mx_Export_MxWeb"))},k.toDisplayString(k.unref(dt)("保存mxweb到服务器")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[28]||(o[28]=r=>k.unref(i).docommand("MxTest_GetSysVars"))},k.toDisplayString(k.unref(dt)("得到系统变量")),3)]),k.createElementVNode("div",kE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[29]||(o[29]=r=>k.unref(i).docommand("MxTest_NewFile"))},k.toDisplayString(k.unref(dt)("新建图纸")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[30]||(o[30]=r=>k.unref(i).docommand("Mx_ViewBackgroundColor"))},k.toDisplayString(k.unref(dt)("白色背景色")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[31]||(o[31]=r=>k.unref(i).docommand("MxTest_FindText"))},k.toDisplayString(k.unref(dt)("文字查找定位")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[32]||(o[32]=r=>k.unref(i).docommand("MxTest_SelectEntitysToBlock"))},k.toDisplayString(k.unref(dt)("选择实体做块")),3)]),k.createElementVNode("div",IE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[33]||(o[33]=r=>k.unref(i).docommand("Mx_Test_Text"))},k.toDisplayString(k.unref(dt)("绘制单行文字")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[34]||(o[34]=r=>k.unref(i).docommand("MxTest_DrawHatchFormPoint"))},k.toDisplayString(k.unref(dt)("选点填充")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[35]||(o[35]=r=>k.unref(i).docommand("Mx_TestExProp"))},k.toDisplayString(k.unref(dt)("设置扩展属性")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[36]||(o[36]=r=>k.unref(i).docommand("Mx_Test_DimAligned"))},k.toDisplayString(k.unref(dt)("绘制对齐标注")),3)]),k.createElementVNode("div",LE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[37]||(o[37]=r=>k.unref(i).docommand("Mx_Test_DrawDimRotated"))},k.toDisplayString(k.unref(dt)("绘性线标注")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[38]||(o[38]=r=>k.unref(i).docommand("Mx_Test_DrawDimAngular"))},k.toDisplayString(k.unref(dt)("角度标注")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[39]||(o[39]=r=>k.unref(i).docommand("MxTest_LineTypeTest"))},k.toDisplayString(k.unref(dt)("修改对象线型")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[40]||(o[40]=r=>k.unref(i).docommand("Mx_SelectEntitHideLayer"))},k.toDisplayString(k.unref(dt)("选择隐藏对象层")),3)]),k.createElementVNode("div",BE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[41]||(o[41]=r=>k.unref(i).docommand("MxTest_TestAddCurrentSelect"))},k.toDisplayString(k.unref(dt)("添加到当前选择")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[42]||(o[42]=r=>k.unref(i).docommand("MxTest_TestSetViewAngle"))},k.toDisplayString(k.unref(dt)("视区旋转")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[43]||(o[43]=r=>k.unref(i).docommand("MxTest_WriteXRecord"))},k.toDisplayString(k.unref(dt)("写扩展记录")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[44]||(o[44]=r=>k.unref(i).docommand("MxTest_GetNamedObjectsDictionary"))},k.toDisplayString(k.unref(dt)("得到命名字典")),3)]),k.createElementVNode("div",FE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[45]||(o[45]=r=>k.unref(i).docommand("MxTest_AddTextStyleTable"))},k.toDisplayString(k.unref(dt)("添加文字样式")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[46]||(o[46]=r=>k.unref(i).docommand("MxTest_DrawCustomEntity"))},k.toDisplayString(k.unref(dt)("绘自定义实体")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[47]||(o[47]=r=>k.unref(i).docommand("Mx_Test_ChangeColor"))},k.toDisplayString(k.unref(dt)("修改对象颜色")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[48]||(o[48]=r=>k.unref(i).docommand("Mx_Test_ChangeVisible"))},k.toDisplayString(k.unref(dt)("修改对象不可见")),3)]),k.createElementVNode("div",NE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[49]||(o[49]=r=>k.unref(i).docommand("Mx_Test_ChangeEntityLayer"))},k.toDisplayString(k.unref(dt)("修改对象层")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[50]||(o[50]=r=>k.unref(i).docommand("Mx_ChaneEntityDrawOrder"))},k.toDisplayString(k.unref(dt)("修改对象显示顺序")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[51]||(o[51]=r=>k.unref(i).docommand("Mx_Export_Pdf"))},k.toDisplayString(k.unref(dt)("指定范围输出pdf")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[52]||(o[52]=r=>k.unref(i).docommand("Mx_Test_DrawImage"))},k.toDisplayString(k.unref(dt)("绘制image")),3)]),k.createElementVNode("div",OE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[53]||(o[53]=r=>k.unref(i).docommand("MxTest_GetObjectExDictionaryData"))},k.toDisplayString(k.unref(dt)("读取对象扩展字典")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[54]||(o[54]=r=>k.unref(i).docommand("Mx_Test_Draw3DPolyline"))},k.toDisplayString(k.unref(dt)("绘制3DPolyline")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[55]||(o[55]=r=>k.unref(i).docommand("MxTest_LineText"))},k.toDisplayString(k.unref(dt)("绘线文本自定义实体")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[56]||(o[56]=r=>k.unref(i).docommand("Mx_Test_IntersectWith"))},k.toDisplayString(k.unref(dt)("计算交点")),3)]),k.createElementVNode("div",zE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[57]||(o[57]=r=>k.unref(i).docommand("Mx_Test_TrueText"))},k.toDisplayString(k.unref(dt)("修改文字样式")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[58]||(o[58]=r=>k.unref(i).docommand("Mx_Test_OffsetIn_DrawLine"))},k.toDisplayString(k.unref(dt)("偏移输入画线")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[59]||(o[59]=r=>k.unref(i).docommand("Mx_Test_CreateGroup"))},k.toDisplayString(k.unref(dt)("创建组")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[60]||(o[60]=r=>k.unref(i).docommand("Mx_ScreenToJpg"))},k.toDisplayString(k.unref(dt)("屏幕截图jpg")),3)]),k.createElementVNode("div",UE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[61]||(o[61]=r=>k.unref(i).docommand("Mx_Test_GetText"))},k.toDisplayString(k.unref(dt)("获取图纸相同文字")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[62]||(o[62]=r=>k.unref(i).docommand("Mx_Cut_Dwg"))},k.toDisplayString(k.unref(dt)("指定范围输出dwg")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[63]||(o[63]=r=>k.unref(i).docommand("Mx_Test_DrawMarkCircle"))},k.toDisplayString(k.unref(dt)("测试绘制标记圆")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[64]||(o[64]=r=>k.unref(i).docommand("Mx_Test_Wipeout"))},k.toDisplayString(k.unref(dt)("测试Wipeout")),3)]),k.createElementVNode("div",VE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[65]||(o[65]=r=>k.unref(i).docommand("MxTest_SelectEntitysToSpatialFilterBlock"))},k.toDisplayString(k.unref(dt)("创建剪切块")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[66]||(o[66]=r=>k.unref(i).docommand("Mx_Test_DrawDimRotatedTol"))},k.toDisplayString(k.unref(dt)("公差标注")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[67]||(o[67]=r=>k.unref(i).docommand("MxTest_ModifyAllEntityColor"))},k.toDisplayString(k.unref(dt)("改所有对象颜色")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[68]||(o[68]=r=>k.unref(i).docommand("Mx_Cut_MxWeb"))},k.toDisplayString(k.unref(dt)("切剪mxweb")),3)]),k.createElementVNode("div",jE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[69]||(o[69]=r=>k.unref(i).docommand("Mx_Test_SetCurrentlyDraw"))},k.toDisplayString(k.unref(dt)("设置当前颜色线重")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[70]||(o[70]=r=>k.unref(i).docommand("Mx_Test_FindPolygonEntitys"))},k.toDisplayString(k.unref(dt)("查找多边形区域内对象")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[71]||(o[71]=r=>k.unref(i).docommand("MxTest_Explode"))},k.toDisplayString(k.unref(dt)("打碎对象")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[72]||(o[72]=r=>k.unref(i).docommand("Mx_Test_DrawTransparencyLine"))},k.toDisplayString(k.unref(dt)("绘半透明线")),3)]),k.createElementVNode("div",GE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[73]||(o[73]=r=>k.unref(i).docommand("MxTest_LineRecord"))},k.toDisplayString(k.unref(dt)("添加线型")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[74]||(o[74]=r=>k.unref(i).docommand("MxTest_ModifyPatternScale"))},k.toDisplayString(k.unref(dt)("修改图案比例")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[75]||(o[75]=r=>k.unref(i).docommand("Mx_DrawEditorEntity"))},k.toDisplayString(k.unref(dt)("测试文字编辑")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[76]||(o[76]=r=>k.unref(i).docommand("Mx_TestDrawBarCode"))},k.toDisplayString(k.unref(dt)("绘制条形码")),3)]),k.createElementVNode("div",HE,[k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[77]||(o[77]=r=>k.unref(i).docommand("Mx_TestdrawQrCode"))},k.toDisplayString(k.unref(dt)("绘制二维码")),3),k.createElementVNode("button",{class:k.normalizeClass(s.value?"button button2 btnEn":"button button2"),onClick:o[78]||(o[78]=r=>k.unref(i).docommand("Mx_ScreenToBmp"))},k.toDisplayString(k.unref(dt)("屏幕截图bmp")),3)])])])])):k.createCommentVNode("",!0)]))}}),cV="",ss=(t,n)=>{const e=t.__vccOpts||t;for(const[i,s]of n)e[i]=s;return e},qE=ss(WE,[["__scopeId","data-v-a388a3ba"],["__file","Modal.vue"]]),d_=t=>(k.pushScopeId("data-v-9f9a60cf"),t=t(),k.popScopeId(),t),XE={key:0,class:"modal-wrapper",id:"modal"},YE={class:"modal-body card"},KE={class:"modal-header"},ZE={class:"heading"},JE=[d_(()=>k.createElementVNode("svg",{viewBox:"0 0 24 24"},[k.createElementVNode("path",{d:"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"})],-1))],$E={style:{"border-bottom":"2px solid #008CBA","margin-bottom":"8px",display:"flex","flex-wrap":"wrap"}},QE=["onClick"],t4={style:{"overflow-y":"auto",height:"500px"}},e4={class:"btn_box"},n4={class:"btn_box"},r4={class:"btn_box"},i4={class:"btn_box"},o4={class:"btn_box"},s4={class:"btn_box"},a4={class:"btn_box"},l4={style:{"overflow-y":"auto",height:"500px"}},c4={class:"btn_box"},u4={class:"btn_box"},h4={class:"btn_box"},d4={class:"btn_box"},f4={class:"btn_box"},p4={class:"btn_box"},m4={class:"btn_box"},g4={style:{"overflow-y":"auto",height:"500px"}},y4={class:"btn_box"},b4={class:"btn_box"},v4={class:"btn_box"},x4={class:"btn_box"},_4={class:"btn_box"},w4={class:"btn_box"},M4={class:"btn_box"},A4={style:{"overflow-y":"auto",height:"500px"}},S4={class:"btn_box"},E4={class:"btn_box"},T4={class:"btn_box"},C4={class:"btn_box"},P4={style:{"overflow-y":"auto",height:"500px"}},D4={class:"btn_box"},R4={class:"btn_box"},k4={class:"btn_box"},I4={style:{"overflow-y":"auto",height:"500px"}},L4={class:"btn_box"},B4={class:"btn_box"},F4={class:"btn_box"},N4={class:"btn_box"},O4={style:{"overflow-y":"auto",height:"500px"}},z4={class:"btn_box"},U4=[d_(()=>k.createElementVNode("svg",{viewBox:"0 0 24 24"},[k.createElementVNode("path",{d:"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"})],-1))],V4={class:"btnBox"},j4=k.defineComponent({__name:"Tools",setup(t){const{isToolsVisible:n,hideModal:e,modalOptions:i,isDialogVisible:s,excelText:a,copyTextToClipboard:o}=Up(),r=k.ref("fit"),{store:u}=MxPluginContext,{setCommandFocus:l}=u.useFocus(),h=k.ref(null),f=p=>{const b=h.value,v=p.clientX-b.offsetLeft,x=p.clientY-b.offsetTop,w=M=>{b.style.left=M.clientX-v+"px",b.style.top=M.clientY-x+"px"};document.addEventListener("mousemove",w),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",w)})},d=k.ref(!1);return k.watch(()=>n.value,p=>{p&&(d.value=localStorage.getItem("language")==="en")}),(p,b)=>(k.openBlock(),k.createBlock(k.Teleport,{to:"body"},[k.unref(n)?(k.openBlock(),k.createElementBlock("div",XE,[k.createElementVNode("div",YE,[k.createElementVNode("div",KE,[k.createElementVNode("h2",ZE,k.toDisplayString(k.unref(i).title),1),k.createElementVNode("a",{href:"#!",onClick:b[0]||(b[0]=(...v)=>k.unref(e)&&k.unref(e)(...v)),role:"button",class:"close","aria-label":"close this modal"},JE)]),k.createElementVNode("div",$E,[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList([{name:k.unref(dt)("修改工具"),id:"fit"},{name:k.unref(dt)("文字工具"),id:"text"},{name:k.unref(dt)("绘图工具"),id:"draw"},{name:k.unref(dt)("块工具"),id:"block"},{name:k.unref(dt)("测量工具"),id:"count"},{name:k.unref(dt)("标注工具"),id:"dimension"},{name:k.unref(dt)("其他工具"),id:"other"}],v=>(k.openBlock(),k.createElementBlock("button",{key:v.id,onClick:()=>{r.value=v.id},class:k.normalizeClass(r.value===v.id?"btn btn2":"btn"),style:k.normalizeStyle(d.value?"font-size:var(--mx-font-size)":"")},k.toDisplayString(v.name),15,QE))),128))]),k.withDirectives(k.createElementVNode("div",t4,[k.createElementVNode("div",e4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[1]||(b[1]=v=>k.unref(i).docommand("Mx_Multicopy"))},k.toDisplayString(k.unref(dt)("多重复制")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[2]||(b[2]=v=>k.unref(i).docommand("Mx_ArcToCircle"))},k.toDisplayString(k.unref(dt)("弧转圆")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[3]||(b[3]=v=>k.unref(i).docommand("Mx_CopyRotation"))},k.toDisplayString(k.unref(dt)("复制旋转")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[4]||(b[4]=v=>k.unref(i).docommand("Mx_CricleTotoll"))},k.toDisplayString(k.unref(dt)("圆转多边")),3)]),k.createElementVNode("div",n4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[5]||(b[5]=v=>k.unref(i).docommand("Mx_ChangeColor"))},k.toDisplayString(k.unref(dt)("修改颜色")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[6]||(b[6]=v=>k.unref(i).docommand("Mx_ArcToAngle"))},k.toDisplayString(k.unref(dt)("圆弧切角")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[7]||(b[7]=v=>k.unref(i).docommand("Mx_TemHiding"))},k.toDisplayString(k.unref(dt)("临时隐藏")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[8]||(b[8]=v=>k.unref(i).docommand("Mx_BoxDel"))},k.toDisplayString(k.unref(dt)("方框删除")),3)]),k.createElementVNode("div",r4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[9]||(b[9]=v=>k.unref(i).docommand("Mx_AngleCopy"))},k.toDisplayString(k.unref(dt)("角度复制")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[10]||(b[10]=v=>k.unref(i).docommand("Mx_VertexRep"))},k.toDisplayString(k.unref(dt)("顶点复制")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[11]||(b[11]=v=>k.unref(i).docommand("Mx_IntersectBreak"))},k.toDisplayString(k.unref(dt)("交点打断")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[12]||(b[12]=v=>k.unref(i).docommand("Mx_DoubleOff"))},k.toDisplayString(k.unref(dt)("双向偏移")),3)]),k.createElementVNode("div",i4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[13]||(b[13]=v=>k.unref(i).docommand("Mx_EitCircle"))},k.toDisplayString(k.unref(dt)("改圆大小")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[14]||(b[14]=v=>k.unref(i).docommand("Mx_LayerTypeScale"))},k.toDisplayString(k.unref(dt)("线型比例")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[15]||(b[15]=v=>k.unref(i).docommand("Mx_Telescoping"))},k.toDisplayString(k.unref(dt)("伸缩")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[16]||(b[16]=v=>k.unref(i).docommand("Mx_ArcOrder"))},k.toDisplayString(k.unref(dt)("按弧阵列")),3)]),k.createElementVNode("div",o4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[17]||(b[17]=v=>k.unref(i).docommand("Mx_PlRoundCorners"))},k.toDisplayString(k.unref(dt)("pl圆角")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[18]||(b[18]=v=>k.unref(i).docommand("Mx_PlReverse"))},k.toDisplayString(k.unref(dt)("pl线反向")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[19]||(b[19]=v=>k.unref(i).docommand("Mx_TestGetAllLineByLayer"))},k.toDisplayString(k.unref(dt)("得到所有直线对象")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[20]||(b[20]=v=>k.unref(i).docommand("Mx_Bisection"))},k.toDisplayString(k.unref(dt)("等分")),3)]),k.createElementVNode("div",s4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[21]||(b[21]=v=>k.unref(i).docommand("Mx_RectangularScaling"))},k.toDisplayString(k.unref(dt)("矩形缩放")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[22]||(b[22]=v=>k.unref(i).docommand("Mx_Interrupt"))},k.toDisplayString(k.unref(dt)("打断")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[23]||(b[23]=v=>k.unref(i).docommand("Mx_PolygonClipping"))},k.toDisplayString(k.unref(dt)("切割多边形")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[24]||(b[24]=v=>k.unref(i).docommand("Mx_MergePolygons"))},k.toDisplayString(k.unref(dt)("合并多边形")),3)]),k.createElementVNode("div",a4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[25]||(b[25]=v=>k.unref(i).docommand("Mx_AddVertex"))},k.toDisplayString(k.unref(dt)("添加多边形顶点")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[26]||(b[26]=v=>k.unref(i).docommand("Mx_DeleteVertex"))},k.toDisplayString(k.unref(dt)("删除多边形顶点")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[27]||(b[27]=v=>k.unref(i).docommand("Mx_StretchPolygon"))},k.toDisplayString(k.unref(dt)("多边形单边拉伸")),3)])],512),[[k.vShow,r.value==="fit"]]),k.withDirectives(k.createElementVNode("div",l4,[k.createElementVNode("div",c4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[28]||(b[28]=v=>k.unref(i).docommand("Mx_DrawStart"))},k.toDisplayString(k.unref(dt)("星形")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[29]||(b[29]=v=>k.unref(i).docommand("Mx_ConcavoVex"))},k.toDisplayString(k.unref(dt)("凹凸线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[30]||(b[30]=v=>k.unref(i).docommand("Mx_ZigzagLine"))},k.toDisplayString(k.unref(dt)("锯齿线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[31]||(b[31]=v=>k.unref(i).docommand("Mx_CenterRect"))},k.toDisplayString(k.unref(dt)("中心矩形")),3)]),k.createElementVNode("div",u4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[32]||(b[32]=v=>k.unref(i).docommand("Mx_RREC"))},k.toDisplayString(k.unref(dt)("圆角矩形")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[33]||(b[33]=v=>k.unref(i).docommand("Mx_CCLine"))},k.toDisplayString(k.unref(dt)("圆中心线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[34]||(b[34]=v=>k.unref(i).docommand("Mx_Piping"))},k.toDisplayString(k.unref(dt)("管道")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[35]||(b[35]=v=>k.unref(i).docommand("Mx_CutPipeline"))},k.toDisplayString(k.unref(dt)("剖管符")),3)]),k.createElementVNode("div",h4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[36]||(b[36]=v=>k.unref(i).docommand("Mx_PerpLine"))},k.toDisplayString(k.unref(dt)("中垂线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[37]||(b[37]=v=>k.unref(i).docommand("Mx_StairLine"))},k.toDisplayString(k.unref(dt)("楼梯")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[38]||(b[38]=v=>k.unref(i).docommand("Mx_SolidCircle"))},k.toDisplayString(k.unref(dt)("实心圆")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[39]||(b[39]=v=>k.unref(i).docommand("Mx_CottonInsulation"))},k.toDisplayString(k.unref(dt)("保温棉")),3)]),k.createElementVNode("div",d4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[40]||(b[40]=v=>k.unref(i).docommand("Mx_CenterLine"))},k.toDisplayString(k.unref(dt)("中心线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[41]||(b[41]=v=>k.unref(i).docommand("Mx_DoHole"))},k.toDisplayString(k.unref(dt)("开洞")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[42]||(b[42]=v=>k.unref(i).docommand("Mx_MassegeBox"))},k.toDisplayString(k.unref(dt)("消息框")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[43]||(b[43]=v=>k.unref(i).docommand("Mx_DatumSymbol"))},k.toDisplayString(k.unref(dt)("基准符（1）")),3)]),k.createElementVNode("div",f4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[44]||(b[44]=v=>k.unref(i).docommand("Mx_WelLine"))},k.toDisplayString(k.unref(dt)("焊缝线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[45]||(b[45]=v=>k.unref(i).docommand("Mx_ConcentricCircles"))},k.toDisplayString(k.unref(dt)("同心圆")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[46]||(b[46]=v=>k.unref(i).docommand("Mx_Gear"))},k.toDisplayString(k.unref(dt)("齿轮")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[47]||(b[47]=v=>k.unref(i).docommand("Mx_BlkCenterLine"))},k.toDisplayString(k.unref(dt)("块中心线")),3)]),k.createElementVNode("div",p4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[48]||(b[48]=v=>k.unref(i).docommand("Mx_RoundCutPublicLine"))},k.toDisplayString(k.unref(dt)("圆公切线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[49]||(b[49]=v=>k.unref(i).docommand("Mx_DatumSymbol2"))},k.toDisplayString(k.unref(dt)("基准符（2）")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[50]||(b[50]=v=>k.unref(i).docommand("Mx_InsterFrame"))},k.toDisplayString(k.unref(dt)("插入图框")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[51]||(b[51]=v=>k.unref(i).docommand("Mx_drawRoads"))},k.toDisplayString(k.unref(dt)("绘制道路")),3)]),k.createElementVNode("div",m4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[52]||(b[52]=v=>k.unref(i).docommand("Mx_DrawPolygon"))},k.toDisplayString(k.unref(dt)("绘任意多边形")),3)])],512),[[k.vShow,r.value==="draw"]]),k.withDirectives(k.createElementVNode("div",g4,[k.createElementVNode("div",y4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[53]||(b[53]=v=>k.unref(i).docommand("Mx_AlignByLine"))},k.toDisplayString(k.unref(dt)("按线对齐")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[54]||(b[54]=v=>k.unref(i).docommand("Mx_TextHeight"))},k.toDisplayString(k.unref(dt)("改字高")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[55]||(b[55]=v=>k.unref(i).docommand("Mx_TextWidth"))},k.toDisplayString(k.unref(dt)("改字宽")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[56]||(b[56]=v=>k.unref(i).docommand("Mx_BrushCon"))},k.toDisplayString(k.unref(dt)("刷内容")),3)]),k.createElementVNode("div",b4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[57]||(b[57]=v=>k.unref(i).docommand("Mx_ReplaceCon"))},k.toDisplayString(k.unref(dt)("换内容")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[58]||(b[58]=v=>k.unref(i).docommand("Mx_AlignLeft"))},k.toDisplayString(k.unref(dt)("左右对齐")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[59]||(b[59]=v=>k.unref(i).docommand("Mx_AlignUp"))},k.toDisplayString(k.unref(dt)("上下对齐")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[60]||(b[60]=v=>k.unref(i).docommand("Mx_TextReversal"))},k.toDisplayString(k.unref(dt)("文字反转")),3)]),k.createElementVNode("div",v4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[61]||(b[61]=v=>k.unref(i).docommand("Mx_TextTraming"))},k.toDisplayString(k.unref(dt)("文字加框")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[62]||(b[62]=v=>k.unref(i).docommand("Mx_Underline"))},k.toDisplayString(k.unref(dt)("下划线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[63]||(b[63]=v=>k.unref(i).docommand("Mx_TitleLine"))},k.toDisplayString(k.unref(dt)("图名线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[64]||(b[64]=v=>k.unref(i).docommand("Mx_Case"))},k.toDisplayString(k.unref(dt)("大小写")),3)]),k.createElementVNode("div",x4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[65]||(b[65]=v=>k.unref(i).docommand("Mx_NumSum"))},k.toDisplayString(k.unref(dt)("数字求和")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[66]||(b[66]=v=>k.unref(i).docommand("Mx_SSWords"))},k.toDisplayString(k.unref(dt)("选特定字")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[67]||(b[67]=v=>k.unref(i).docommand("Mx_Prefix"))},k.toDisplayString(k.unref(dt)("前后缀")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[68]||(b[68]=v=>k.unref(i).docommand("Mx_ConnectText"))},k.toDisplayString(k.unref(dt)("连接文字")),3)]),k.createElementVNode("div",_4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[69]||(b[69]=v=>k.unref(i).docommand("Mx_TextTrim"))},k.toDisplayString(k.unref(dt)("去空格")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[70]||(b[70]=v=>k.unref(i).docommand("Mx_VerticalText"))},k.toDisplayString(k.unref(dt)("文字竖向")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[71]||(b[71]=v=>k.unref(i).docommand("Mx_AlignByArc"))},k.toDisplayString(k.unref(dt)("按弧对齐")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[72]||(b[72]=v=>k.unref(i).docommand("Mx_EditTextStyle"))},k.toDisplayString(k.unref(dt)("修改全局文字样式")),3)]),k.createElementVNode("div",w4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[73]||(b[73]=v=>k.unref(i).docommand("Mx_ExtractText"))},k.toDisplayString(k.unref(dt)("提取文字")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[74]||(b[74]=v=>k.unref(i).docommand("Mx_NumberText"))},k.toDisplayString(k.unref(dt)("文字编号")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[75]||(b[75]=v=>k.unref(i).docommand("Mx_MultipleToMText"))},k.toDisplayString(k.unref(dt)("多单转一多")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[76]||(b[76]=v=>k.unref(i).docommand("Mx_TextToMText"))},k.toDisplayString(k.unref(dt)("单转多")),3)]),k.createElementVNode("div",M4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[77]||(b[77]=v=>k.unref(i).docommand("Mx_MTextToMultiple"))},k.toDisplayString(k.unref(dt)("多转多个单")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[78]||(b[78]=v=>k.unref(i).docommand("Mx_MTextToSingle"))},k.toDisplayString(k.unref(dt)("多转单个单")),3)])],512),[[k.vShow,r.value==="text"]]),k.withDirectives(k.createElementVNode("div",A4,[k.createElementVNode("div",S4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[79]||(b[79]=v=>k.unref(i).docommand("Mx_ChangeBN"))},k.toDisplayString(k.unref(dt)("改块名")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[80]||(b[80]=v=>k.unref(i).docommand("Mx_BushBlk"))},k.toDisplayString(k.unref(dt)("刷块")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[81]||(b[81]=v=>k.unref(i).docommand("Mx_ConBlk"))},k.toDisplayString(k.unref(dt)("块连线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[82]||(b[82]=v=>k.unref(i).docommand("Mx_BlkCenterLine"))},k.toDisplayString(k.unref(dt)("块中心线")),3)]),k.createElementVNode("div",E4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[83]||(b[83]=v=>k.unref(i).docommand("Mx_BlkPt"))},k.toDisplayString(k.unref(dt)("改块基点")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[84]||(b[84]=v=>k.unref(i).docommand("Mx_BlkColor"))},k.toDisplayString(k.unref(dt)("改块颜色")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[85]||(b[85]=v=>k.unref(i).docommand("Mx_BlkRotate"))},k.toDisplayString(k.unref(dt)("多块旋转")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[86]||(b[86]=v=>k.unref(i).docommand("Mx_BlkScale"))},k.toDisplayString(k.unref(dt)("多块缩放")),3)]),k.createElementVNode("div",T4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[87]||(b[87]=v=>k.unref(i).docommand("Mx_BlkAngle"))},k.toDisplayString(k.unref(dt)("刷块角度")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[88]||(b[88]=v=>k.unref(i).docommand("Mx_BlkSelect"))},k.toDisplayString(k.unref(dt)("按块选择")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[89]||(b[89]=v=>k.unref(i).docommand("Mx_BlkAllSelect"))},k.toDisplayString(k.unref(dt)("按块全选")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[90]||(b[90]=v=>k.unref(i).docommand("Mx_SSBlk"))},k.toDisplayString(k.unref(dt)("统计单块")),3)]),k.createElementVNode("div",C4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[91]||(b[91]=v=>k.unref(i).docommand("Mx_SMBlk"))},k.toDisplayString(k.unref(dt)("统计多块")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[92]||(b[92]=v=>k.unref(i).docommand("Mx_BlkLayer"))},k.toDisplayString(k.unref(dt)("修改块图层")),3)])],512),[[k.vShow,r.value==="block"]]),k.withDirectives(k.createElementVNode("div",P4,[k.createElementVNode("div",D4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[93]||(b[93]=v=>k.unref(i).docommand("Mx_StaLength"))},k.toDisplayString(k.unref(dt)("长度")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[94]||(b[94]=v=>k.unref(i).docommand("Mx_StaArea"))},k.toDisplayString(k.unref(dt)("统计面积")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[95]||(b[95]=v=>k.unref(i).docommand("Mx_Elevation"))},k.toDisplayString(k.unref(dt)("智能标高")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[96]||(b[96]=v=>k.unref(i).docommand("Mx_Area"))},k.toDisplayString(k.unref(dt)("面积")),3)]),k.createElementVNode("div",R4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[97]||(b[97]=v=>k.unref(i).docommand("Mx_ReactArea"))},k.toDisplayString(k.unref(dt)("矩形面积")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[98]||(b[98]=v=>k.unref(i).docommand("Mx_DistFromPointToLine"))},k.toDisplayString(k.unref(dt)("点到直线的距离")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[99]||(b[99]=v=>k.unref(i).docommand("Mx_ArcLength"))},k.toDisplayString(k.unref(dt)("弧长")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[100]||(b[100]=v=>k.unref(i).docommand("Mx_MeasuringCircle"))},k.toDisplayString(k.unref(dt)("测量圆")),3)]),k.createElementVNode("div",k4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[101]||(b[101]=v=>k.unref(i).docommand("Mx_ContinueMeasurement"))},k.toDisplayString(k.unref(dt)("连续测量")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[102]||(b[102]=v=>k.unref(i).docommand("Mx_CountList"))},k.toDisplayString(k.unref(dt)("查看分段长度")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[103]||(b[103]=v=>k.unref(i).docommand("Mx_AreaArc"))},k.toDisplayString(k.unref(dt)("面积含弧线")),3)])],512),[[k.vShow,r.value==="count"]]),k.withDirectives(k.createElementVNode("div",I4,[k.createElementVNode("div",L4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[104]||(b[104]=v=>k.unref(i).docommand("Mx_Approval"))},k.toDisplayString(k.unref(dt)("审图标注")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[105]||(b[105]=v=>k.unref(i).docommand("Mx_AnnotatedRectangle"))},k.toDisplayString(k.unref(dt)("矩形标注")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[106]||(b[106]=v=>k.unref(i).docommand("Mx_Roughness"))},k.toDisplayString(k.unref(dt)("粗糙度标注")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[107]||(b[107]=v=>k.unref(i).docommand("Mx_CoordAnnotation"))},k.toDisplayString(k.unref(dt)("坐标标注")),3)]),k.createElementVNode("div",B4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[108]||(b[108]=v=>k.unref(i).docommand("Mx_StandardSlope"))},k.toDisplayString(k.unref(dt)("标斜率")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[109]||(b[109]=v=>k.unref(i).docommand("Mx_Alignment"))},k.toDisplayString(k.unref(dt)("对齐")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[110]||(b[110]=v=>k.unref(i).docommand("Mx_Enlarge"))},k.toDisplayString(k.unref(dt)("局部放大")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[111]||(b[111]=v=>k.unref(i).docommand("Mx_indexSymbol"))},k.toDisplayString(k.unref(dt)("序号标注")),3)]),k.createElementVNode("div",F4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[112]||(b[112]=v=>k.unref(i).docommand("Mx_RotationLabel"))},k.toDisplayString(k.unref(dt)("旋转标注")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[113]||(b[113]=v=>k.unref(i).docommand("Mx_RoundHoleMark"))},k.toDisplayString(k.unref(dt)("圆孔标记")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[114]||(b[114]=v=>k.unref(i).docommand("Mx_weldSymbol"))},k.toDisplayString(k.unref(dt)("焊缝符号")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[115]||(b[115]=v=>k.unref(i).docommand("Mx_DirectionaSymbol"))},k.toDisplayString(k.unref(dt)("向视符号")),3)]),k.createElementVNode("div",N4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[116]||(b[116]=v=>k.unref(i).docommand("Mx_WeldingSymbol"))},k.toDisplayString(k.unref(dt)("焊接符号")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[117]||(b[117]=v=>k.unref(i).docommand("Mx_Test_DrawGT"))},k.toDisplayString(k.unref(dt)("形位公差")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[118]||(b[118]=v=>k.unref(i).docommand("MxTest_DrawRayAnnotation"))},k.toDisplayString(k.unref(dt)("射线标注")),3)])],512),[[k.vShow,r.value==="dimension"]]),k.withDirectives(k.createElementVNode("div",O4,[k.createElementVNode("div",z4,[k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[119]||(b[119]=v=>k.unref(i).docommand("Mx_ReactChangeColor"))},k.toDisplayString(k.unref(dt)("矩形标注悬停变色")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[120]||(b[120]=v=>k.unref(i).docommand("Mx_Cut_MxWebToFile"))},k.toDisplayString(k.unref(dt)("裁剪图纸扩展")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[121]||(b[121]=v=>k.unref(i).docommand("MxTest_DrawArrowLine"))},k.toDisplayString(k.unref(dt)("箭头直线")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[122]||(b[122]=v=>k.unref(i).docommand("Mx_TestGetTable"))},k.toDisplayString(k.unref(dt)("提取表格")),3),k.createElementVNode("button",{class:k.normalizeClass(d.value?"button button2 btnEn":"button button2"),onClick:b[123]||(b[123]=v=>k.unref(i).docommand("Mx_TestEditTable"))},k.toDisplayString(k.unref(dt)("在线编辑表格")),3)])],512),[[k.vShow,r.value==="other"]])])])):k.createCommentVNode("",!0),k.unref(s)?(k.openBlock(),k.createElementBlock("div",{key:1,class:"textBox",ref_key:"model",ref:h},[k.createElementVNode("div",{class:"header",onMousedown:f},[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("选择的文字")),1),k.createElementVNode("a",{href:"#!",onClick:b[124]||(b[124]=v=>s.value=!1),role:"button",class:"close","aria-label":"close this modal"},U4)],32),k.withDirectives(k.createElementVNode("textarea",{rows:"20",cols:"50",onFocus:b[125]||(b[125]=()=>k.unref(l)(!1)),onBlur:b[126]||(b[126]=()=>k.unref(l)(!0)),"onUpdate:modelValue":b[127]||(b[127]=v=>k.isRef(a)?a.value=v:null)},null,544),[[k.vModelText,k.unref(a)]]),k.createElementVNode("div",V4,[k.createElementVNode("button",{onClick:b[128]||(b[128]=(...v)=>k.unref(o)&&k.unref(o)(...v))},k.toDisplayString(k.unref(dt)("复制到剪贴板")),1)])],512)):k.createCommentVNode("",!0)]))}}),dV="",G4=ss(j4,[["__scopeId","data-v-9f9a60cf"],["__file","Tools.vue"]]),H4=ss(k.defineComponent({__name:"Test",setup(t){return(n,e)=>(k.openBlock(),k.createElementBlock("div",null,[k.createVNode(qE),k.createVNode(G4)]))}}),[["__file","Test.vue"]]),W4={init(){Ct.MxFun.setPostMessageToParentFrameFunction(function(t){top.postMessage(t,"*")}),window.addEventListener("message",function(t){t.data.type==="sendStringToExecute"&&Ct.MxFun.sendStringToExecute(t.data.cmd,t.data)},!1)}};function q4(){W4.init()}function X4(){return re(this,null,function*(){const t=new Ct.MrxDbgUiPrPoint;t.setMessage(dt(" 指定第一点:")),t.go(n=>{if(n!=0)return;const e=t.value();let i=new Ct.MxDbLeadComment;i.point1=e.clone(),i.textHeight=Ct.MxFun.screenCoordLong2Doc(50),i.text="测试Test1",i.textWidth=Ct.MxFun.screenCoordLong2Doc(300),i.fixedSize=!1,i.fixedSize&&(i.textHeight=50,i.textWidth=250),i.color=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor();const s=new Ct.McEdGetPointWorldDrawObject;s.setDraw((a,o)=>{i.point2=a,o.drawCustomEntity(i)}),t.setBasePt(e),t.setUseBasePt(!0),t.setUserDraw(s),t.setMessage(dt(" 指定第二点:")),t.go(a=>{if(a!=0){console.log(a);return}const o=t.value();i.point2=o,Ct.MxFun.addToCurrentSpace(i)})})})}function Y4(){Ct.MxFun.getCurrentDraw().createCanvasImageData(t=>{const n=window.open();n!=null&&(n.document.write('<img src="'+t+'"/>'),setTimeout(()=>{n.print()},300))},{width:349,height:536})}function K4(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor();const n=new Ct.MrxDbgUiPrPoint,e=Ct.MxFun.getCurrentDraw(),i=new Ct.McEdGetPointWorldDrawObject,s=new Ct.MxDbRectBoxLeadComment;s.color=t.getHex(),s.color==0&&(s.color=65793),s.radius=Ct.MxFun.screenCoordLong2Doc(8),s.setLineWidth(3),s.setLineWidthByPixels(!0),n.setMessage(dt(" 云线框起始点:")),n.go(a=>{a==Ct.MrxDbgUiPrBaseReturn.kOk&&(s.point1=n.value(),i.setDraw(o=>{s.point2=o,i.drawCustomEntity(s)}),n.setUserDraw(i),n.setMessage(dt(" 云线框结束点:")),n.go(o=>{o==Ct.MrxDbgUiPrBaseReturn.kOk&&(s.point2=n.value(),i.setDraw(r=>{s.point3=r,i.drawCustomEntity(s)}),s.text="审图批注XXXXXXXXXX",s.textWidth=Ct.MxFun.screenCoordLong2Doc(200),s.textHeight=Ct.MxFun.screenCoordLong2Doc(50),s.fixedSize=!0,s.fixedSize&&(s.textHeight=20,s.textWidth=230),n.setMessage(dt(" 审图标注点:")),n.go(r=>{r==Ct.MrxDbgUiPrBaseReturn.kOk&&(s.point3=n.value(),e.addMxEntity(s))}))}))})})}function U1(t,n){let e=Ct.MxFun.screenCoordLong2World(n?t:t-t/3);return e=Ct.MxFun.worldCoordLong2Doc(e),e}function Z4(){const t=new Ct.McEdGetPointWorldDrawObject,n=new Ct.MxDbArrow,e=Ct.MxFun.getCurrentDraw(),i=new Ct.MrxDbgUiPrPoint;i.setUserDraw(t),n.setLineWidth(10),n.innerOffset=U1(10),n.outerOffset=U1(22),n.topOffset=U1(36),n.color=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor(),i.go(()=>{n.startPoint=i.value(),t.setDraw(s=>{n.endPoint=s,t.drawCustomEntity(n)}),i.go(s=>re(this,null,function*(){n.endPoint=i.value(),e.addMxEntity(n)}))})}function J4(){const t=new Ct.MrxDbgUiPrPoint,n=Ct.MxFun.getCurrentDraw(),e=new Ct.McEdGetPointWorldDrawObject,i=Ct.MxFun.screenCoordLong2Doc(16);t.setMessage(dt(" 点击开启绘制云线:")),t.go(()=>{let s=t.value();const a=new Ct.MxDbCloudLine;a.setRadius(i),a.addPoint(s),a.color=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor(),e.setDraw(o=>{s.distanceTo(o)>i&&(s=o.clone(),a.addPoint(o,!0)),e.drawCustomEntity(a)}),t.setUserDraw(e),t.setMessage(dt(" 再次点击结束绘制云线:")),t.go(()=>{n.addMxEntity(a)})})}let Yp="";function $4(){Yp=Ct.MxFun.getCurrentDraw().saveMxEntityToJson(),console.log(Yp)}function Q4(){return re(this,null,function*(){if(Yp.length==0)return;let t=Ct.MxFun.getCurrentDraw();yield t.loadMxEntityFromJson(Yp,["models/svg/mark.svg"]),t.updateDisplay()})}function tT(){const t=new Ct.MrxDbgUiPrPoint;t.setMessage(" 指定第一点:"),t.go(n=>{if(n!=0)return;const e=t.value();let i=new Ct.MxDbArea;i.addPoint(e),i.color=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor();const s=new Ct.McEdGetPointWorldDrawObject;s.setDraw((a,o)=>{let r=i.clone();r.addPoint(a),s.drawCustomEntity(r)}),t.setUserDraw(s),t.setMessage(" 指定下一点:"),t.goWhile(a=>{if(a==0){const o=t.value();i.addPoint(o)}},a=>{i.isFill=!0,i.fillOpacity=.7,i.fillColor=6697540,Ct.MxFun.getCurrentDraw().addMxEntity(i)})})}function eT(){Ct.MxFun.addCommand("BR_Comment",X4),Ct.MxFun.addCommand("BR_CheckDraw",K4),Ct.MxFun.addCommand("BR_Arrow",Z4),Ct.MxFun.addCommand("BR_CloudLine",J4),Ct.MxFun.addCommand("BR_Print",Y4),Ct.MxFun.addCommand("BR_SaveAllMxEntity",$4),Ct.MxFun.addCommand("BR_LoadAllMxEntity",Q4),Ct.MxFun.addCommand("BR_Area",tT)}function nT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.addLayer("LineLayer"),t.drawLayer="LineLayer",t.drawLine(0,0,100,0),t.drawLine(200,0,300,100),t.addLinetype("MyLineType","6,-10"),t.drawLinetype="MyLineType",t.drawLine(0,30,100,30),t.drawLine(200,30,300,130),t.drawColor=new A.McCmColor(0,0,255),t.drawLine(0,60,100,60),t.drawLine(200,60,300,160),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=4,t.drawLine(0,90,100,90),t.drawLine(200,90,300,190),t.addLinetype("MyLineType2","10,-2,3,-2"),t.drawLinetype="MyLineType2",t.drawColor=new A.McCmColor(255,0,0),t.drawLine(0,120,100,120),t.drawLine(200,120,300,220),t.addTextStyle("MyLineTypeTextStyle","txt.shx","hztxt.shx",1),t.addLinetypeEx("MyLineType3",'(12.7,("T=MxDraw","S=2.54","L=-5.08","R=0.0","X=-2.54","Y=-1.27"),-10.08)',"MyLineTypeTextStyle"),t.drawLinetype="MyLineType3",t.drawLineWidth=0,t.drawLine(350,120,600,120),t.drawColorIndex=0,t.drawLineWidth=4,t.drawLine(350,220,600,220),t.zoomAll(),t.updateDisplay()}function rT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.addLayer("ArcLayer"),t.drawLayer="ArcLayer",t.drawArc(0,1e3,100,30,200),t.addLinetype("ArcLineType","30,-5,7,-7"),t.drawLinetype="ArcLineType",t.drawColor=new A.McCmColor(255,25,0),t.drawArc(300,1e3,100,30,200),t.drawLineWidth=15,t.drawColorIndex=255,t.drawArc(600,1e3,100,30,200),t.drawArc2(800,1e3,900,1200,1e3,900),t.drawLinetype="",t.drawLineWidth=40,t.drawArc3(1200,1e3,1400,1e3,.6),t.zoomAll(),t.regen(),t.updateDisplay()}function iT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.addLayer("CircleLayer"),t.drawLayer="CircleLayer",t.drawCircle(0,800,120),t.addLinetype("CircleLineType","30,-5,7,-7"),t.drawLinetype="CircleLineType",t.drawColor=new A.McCmColor(0,25,255),t.drawCircle(300,800,120),t.addLinetype("CircleLineType","30,-5,7,-7"),t.drawLinetype="CircleLineType",t.drawLineWidth=40,t.drawCircle(600,800,120),t.zoomAll(),t.regen(),t.updateDisplay()}function oT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.addLayer("PolylineLayer"),t.drawLayer="PolylineLayer",t.pathMoveTo(0,300),t.pathLineTo(100,300),t.pathLineTo(100,400),t.pathLineTo(0,400),t.pathMakeClosed(),t.drawPathToPolyline(),t.pathMoveTo(200,300),t.pathLineTo(300,300),t.pathLineTo(300,400),t.pathLineTo(200,400),t.pathMakeClosed(),t.addLinetype("MyLineType3","30,-10"),t.drawLinetype="MyLineType3",t.drawColorIndex=255,t.drawLineWidth=5,t.drawPathToPolyline(),t.pathMoveTo(400,300),t.pathLineTo(500,300),t.pathLineTo(500,400),t.pathLineTo(400,400),t.pathMakeClosed(),t.drawLinetype="",t.drawColor=new A.McCmColor(0,25,255),t.drawLineWidth=10,t.drawPathToPolyline(),t.pathMoveTo(400,300),t.pathLineTo(500,300),t.pathLineTo(500,400),t.pathLineTo(400,400),t.pathMakeClosed(),t.drawLinetype="",t.drawColor=new A.McCmColor(255,25,0),t.drawLineWidth=10,t.drawPathToPolyline(),t.pathMoveTo(600,300),t.pathLineTo(700,300),t.pathLineTo(700,400),t.pathLineTo(600,400),t.drawLinetype="",t.drawColor=new A.McCmColor(0,255,0),t.drawLineWidth=10,t.drawPathToPolyline(),t.pathMoveTo(800,300),t.pathLineTo(900,300),t.pathLineTo(900,400),t.pathMakeClosed(),t.drawLinetype="",t.drawColor=new A.McCmColor(25,255,0),t.drawLineWidth=10,t.drawPathToPolyline(),t.pathMoveToEx(1e3,300,10,10,0),t.pathLineToEx(1e3,500,30,0,0),t.pathLineTo(1e3,580),t.drawPathToPolyline(),t.pathMoveToEx(1200,300,10,10,0),t.pathLineToEx(1200,500,30,0,0),t.pathLineTo(1200,580),t.drawColor=new A.McCmColor(25,255,0),t.drawLinetype="MyLineType3",t.drawPathToPolyline(),t.pathMoveToEx(1400,300,10,10,-.34),t.pathLineToEx(1400,500,30,0,.34),t.pathLineTo(1400,600),t.drawColor=new A.McCmColor(255,255,25),t.drawLinetype="MyLineType3",t.drawPathToPolyline(),t.zoomAll(),t.regen(),t.updateDisplay()}function sT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.addLayer("HatchLayer"),t.drawLayer="HatchLayer",t.pathMoveToEx(200,3300,0,0,.3),t.pathLineTo(300,3300),t.pathLineTo(300,3400),t.pathLineTo(200,3300),t.drawColor=new A.McCmColor(25,255,0),t.drawPathToHatch(1),t.pathMoveTo(150,3300),t.pathLineTo(250,3300),t.pathLineTo(250,3400),t.pathLineTo(150,3300),t.drawColor=new A.McCmColor(255,0,0),t.drawPathToHatch(1),t.pathMoveToEx(440,3310,0,0,0),t.pathLineTo(480,3310),t.pathLineTo(480,3360),t.pathLineTo(450,3340),t.pathMakeExclude(!0),t.pathMoveToEx(400,3300,0,0,.3),t.pathLineTo(500,3300),t.pathLineTo(500,3400),t.pathLineTo(400,3300),t.drawColor=new A.McCmColor(255,25,0),t.drawPathToHatch(1),t.addPatternDefinition("MyHatchPattern1","((45, 0,0, 0,0.125))"),t.drawPatternDefinition="MyHatchPattern1",t.pathMoveToEx(600,3300,0,0,.3),t.pathLineTo(700,3300),t.pathLineTo(700,3400),t.pathLineTo(600,3300),t.drawPathToHatch(100),t.addPatternDefinition("MyHatchPattern2","((45, 0,0, 0,0.25) (45, 0.176776695,0, 0,0.25, 0.125,-0.0625))"),t.drawPatternDefinition="MyHatchPattern2",t.pathMoveToEx(800,3300,0,0,.3),t.pathLineTo(900,3300),t.pathLineTo(900,3400),t.pathLineTo(800,3300),t.drawPathToHatch(100),t.zoomAll(),t.regen(),t.updateDisplay()}function aT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.addLayer("TextLayer"),t.drawLayer="TextLayer",t.drawText(0,1900,"绘图控件文字测试",100,0,0,1),t.drawColor=new A.McCmColor(255,25,0),t.drawText(3e3,2100,"绘图控件文字测试",100,-20,2,1),t.addTextStyle("MyTextStyle","italicc.shx","gbcbig.shx",.7),t.drawTextStyle="MyTextStyle",t.drawColor=new A.McCmColor(255,0,0),t.drawText(0,3e3,"绘图控件文字测试",100,0,0,1),t.AddTureTypeTextStyle("MyTrueTypeTextStyle"),t.drawTextStyle="MyTrueTypeTextStyle",t.drawColor=new A.McCmColor(200,255,50),t.drawText(0,3500,"绘图控件TrueType文字测试",100,0,0,1),t.zoomAll(),t.regen(),t.updateDisplay()}function lT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),A.MxCpp.App.loadFonts([],[],["syadobe","simsun"],()=>{t.AddTureTypeTextStyle("ht_style","syadobe"),t.AddTureTypeTextStyle("st_style","simsun"),t.drawTextStyle="ht_style",t.drawColor=new A.McCmColor(200,255,50);let e=t.drawText(0,3500,"绘图控件TrueType文字测试",100,0,0,1).getMcDbEntity();e&&(e.textStyle="st_style"),t.zoomAll(),t.regen(),t.updateDisplay()})}function cT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.addLayer("LineLayer"),t.drawLayer="LineLayer",t.drawEllipse(0,1400,100,0,.7),t.addLinetype("MyEllipseType","6,-10"),t.drawLinetype="MyEllipseType",t.drawColor=new A.McCmColor(200,0,0),t.drawEllipse(200,1400,80,30,.5),t.zoomAll(),t.regen(),t.updateDisplay()}function uT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.drawLineWidth=0,t.addLayer("EllipseArcLayer"),t.drawLayer="EllipseArcLayer",t.drawEllipseArc(0,1600,80,30,.4,30,200),t.addLinetype("MyEllipseArcType","6,-10"),t.drawLinetype="MyEllipseArcType",t.drawColor=new A.McCmColor(200,200,0),t.drawEllipseArc(200,1600,-80,30,.5,60,300),t.drawLinetype="",t.zoomAll(),t.regen(),t.updateDisplay()}function hT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawColorIndex=0,t.addLayer("MtextLayer"),t.drawLayer="MtextLayer",t.drawTextStyle="",t.drawMText(0,-100,"控件:\\P多行文字测试",50,400,0,1),t.zoomAll(),t.regen(),t.updateDisplay()}function dT(t){if(!t||!t.param)return;let n=A.MxCpp.getCurrentMxCAD();n.newFile(),n.drawColorIndex=0,n.drawLinetype="",n.drawLineWidth=0,n.addLayer("LineLayer"),n.drawLayer="LineLayer",n.drawLine(t.param.x1,t.param.y1,t.param.x2,t.param.y2),n.zoomAll(),n.updateDisplay(),Ct.MxFun.postMessageToParentFrame({cmd:"Mx_ParamDrawLine",message:"ok"})}function fT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.drawText(350831.77,1940511845e-2,"1.034",10,0,A.McDb.TextHorzMode.kTextLeft,A.McDb.TextVertMode.kTextVertMid),t.zoomAll(),t.regen(100)}function pT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.addDimStyle("MyDimStyle","41,0.18,141,0.09,40,200","77,1,271,3","",""),t.drawDimStyle="MyDimStyle",t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.drawDimAligned(0,4e3,300,4500,150,4600),t.zoomAll(),t.updateDisplay()}function mT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile();let n=t.addTextStyle("我的标注字体","complex.shx","gbcbig.shx",1);t.addDimStyle("MyDimStyle","41,0.18,141,0.09,40,200","77,1,271,3","",`340,${n.id}`),t.drawDimStyle="MyDimStyle",t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0;let i=t.drawDimRotated(0,7e3,600,7e3,250,7050,0).getMcDbDimension();i&&(i.setDimVarDouble(41,2),i.setDimVarDouble(44,3),i.setDimVarDouble(49,6),i.setDimVarInt(290,1)),t.drawDimRotated(0,7200,0,7600,150,7300,.771),t.zoomAll(),t.updateDisplay()}function gT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile();let n=t.addTextStyle("我的标注字体","complex.shx","gbcbig.shx",1);t.addDimStyle("MyDimStyle","41,0.18,141,0.09,40,200","77,1,271,3",'3,"DN%%c<>"',`340,${n.id}`),t.drawDimStyle="MyDimStyle",t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0;let e=t.drawDimRotated(0,7e3,600,7e3,250,7050,0).getMcDbDimension();e&&(e.setDimVarInt(71,1),e.setDimVarInt(272,1),e.setDimVarDouble(146,.5),e.setDimVarDouble(48,5.5),e.setDimVarDouble(47,2.5),e.recomputeDimBlock()),t.zoomAll(),t.updateDisplay()}function yT(){let t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.addDimStyle("MyDimStyle2","41,0.18,141,0.09,40,200","77,1,271,3","",""),t.drawDimStyle="MyDimStyle2",t.drawColorIndex=0,t.drawLinetype="",t.drawLineWidth=0,t.drawDimAngular(500,5e3,0,5500,1e3,5500,500,5500),t.zoomAll(),t.updateDisplay()}function bT(){Ct.MxFun.addCommand("Mx_Test_DrawLine",nT),Ct.MxFun.addCommand("Mx_Test_DrawArc",rT),Ct.MxFun.addCommand("Mx_Test_DrawCircle",iT),Ct.MxFun.addCommand("Mx_Test_DrawPolyline",oT),Ct.MxFun.addCommand("Mx_Test_DrawHatch",sT),Ct.MxFun.addCommand("Mx_Test_DrawText",aT),Ct.MxFun.addCommand("Mx_Test_Ellipse",cT),Ct.MxFun.addCommand("Mx_Test_EllipseArc",uT),Ct.MxFun.addCommand("Mx_Test_MText",hT),Ct.MxFun.addCommand("Mx_Test_Text",fT),Ct.MxFun.addCommand("Mx_ParamDrawLine",dT),Ct.MxFun.addCommand("Mx_Test_DimAligned",pT),Ct.MxFun.addCommand("Mx_Test_DrawDimRotated",mT),Ct.MxFun.addCommand("Mx_Test_DrawDimRotatedTol",gT),Ct.MxFun.addCommand("Mx_Test_DrawDimAngular",yT),Ct.MxFun.addCommand("Mx_Test_TrueText",lT)}Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}),Math.sign===void 0&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),e=1;e<arguments.length;e++){var i=arguments[e];if(i!=null)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])}return n});var vT="113",xT=0,f_=1,_T=2,p_=1,wT=2,rd=3,Zc=0,Si=1,id=2,m_=1,g_=0,MT=1,Jc=2,Ua=0,od=1,y_=2,b_=3,v_=4,AT=5,$c=100,ST=101,ET=102,x_=103,__=104,TT=200,CT=201,PT=202,DT=203,w_=204,M_=205,RT=206,kT=207,IT=208,LT=209,BT=210,FT=0,NT=1,OT=2,V1=3,zT=4,UT=5,VT=6,jT=7,Kp=0,GT=1,HT=2,Zp=0,j1=1,WT=2,qT=3,XT=4,YT=5,G1=300,H1=301,W1=302,A_=303,q1=304,S_=305,sd=306,X1=307,Ol=1e3,Qi=1001,ad=1002,li=1003,Jp=1004,$p=1005,pi=1006,Y1=1007,Qc=1008,Qp=1009,KT=1010,ZT=1011,tm=1012,JT=1013,E_=1014,ld=1015,K1=1016,$T=1017,QT=1018,tC=1019,em=1020,eC=1021,oa=1022,as=1023,nC=1024,rC=1025,iC=as,tu=1026,cd=1027,oC=1028,sC=1029,aC=1030,lC=1031,cC=1032,uC=1033,T_=33776,C_=33777,P_=33778,D_=33779,R_=35840,k_=35841,I_=35842,L_=35843,hC=36196,dC=37808,fC=37809,pC=37810,mC=37811,gC=37812,yC=37813,bC=37814,vC=37815,xC=37816,_C=37817,wC=37818,MC=37819,AC=37820,SC=37821,EC=2200,TC=2201,CC=2202,ud=2300,eu=2301,Z1=2302,nu=2400,ru=2401,nm=2402,PC=0,DC=1,B_=2,Fo=3e3,hd=3001,F_=3007,J1=3002,RC=3003,N_=3004,O_=3005,z_=3006,kC=3200,IC=3201,zl=0,LC=1,$1=7680,BC=519,rm=35044,dd=35048;function sa(){}Object.assign(sa.prototype,{addEventListener:function(t,n){this._listeners===void 0&&(this._listeners={});var e=this._listeners;e[t]===void 0&&(e[t]=[]),e[t].indexOf(n)===-1&&e[t].push(n)},hasEventListener:function(t,n){if(this._listeners===void 0)return!1;var e=this._listeners;return e[t]!==void 0&&e[t].indexOf(n)!==-1},removeEventListener:function(t,n){if(this._listeners!==void 0){var e=this._listeners,i=e[t];if(i!==void 0){var s=i.indexOf(n);s!==-1&&i.splice(s,1)}}},dispatchEvent:function(t){if(this._listeners!==void 0){var n=this._listeners,e=n[t.type];if(e!==void 0){t.target=this;for(var i=e.slice(0),s=0,a=i.length;s<a;s++)i[s].call(this,t)}}}});for(var Li=[],fd=0;fd<256;fd++)Li[fd]=(fd<16?"0":"")+fd.toString(16);var pr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,s=Li[t&255]+Li[t>>8&255]+Li[t>>16&255]+Li[t>>24&255]+"-"+Li[n&255]+Li[n>>8&255]+"-"+Li[n>>16&15|64]+Li[n>>24&255]+"-"+Li[e&63|128]+Li[e>>8&255]+"-"+Li[e>>16&255]+Li[e>>24&255]+Li[i&255]+Li[i>>8&255]+Li[i>>16&255]+Li[i>>24&255];return s.toUpperCase()},clamp:function(t,n,e){return Math.max(n,Math.min(e,t))},euclideanModulo:function(t,n){return(t%n+n)%n},mapLinear:function(t,n,e,i,s){return i+(t-n)*(s-i)/(e-n)},lerp:function(t,n,e){return(1-e)*t+e*n},smoothstep:function(t,n,e){return t<=n?0:t>=e?1:(t=(t-n)/(e-n),t*t*(3-2*t))},smootherstep:function(t,n,e){return t<=n?0:t>=e?1:(t=(t-n)/(e-n),t*t*t*(t*(t*6-15)+10))},randInt:function(t,n){return t+Math.floor(Math.random()*(n-t+1))},randFloat:function(t,n){return t+Math.random()*(n-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*pr.DEG2RAD},radToDeg:function(t){return t*pr.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)===0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,n,e,i,s){var a=Math.cos,o=Math.sin,r=a(e/2),u=o(e/2),l=a((n+i)/2),h=o((n+i)/2),f=a((n-i)/2),d=o((n-i)/2),p=a((i-n)/2),b=o((i-n)/2);s==="XYX"?t.set(r*h,u*f,u*d,r*l):s==="YZY"?t.set(u*d,r*h,u*f,r*l):s==="ZXZ"?t.set(u*f,u*d,r*h,r*l):s==="XZX"?t.set(r*h,u*b,u*p,r*l):s==="YXY"?t.set(u*p,r*h,u*b,r*l):s==="ZYZ"?t.set(u*b,u*p,r*h,r*l):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function on(t,n){this.x=t||0,this.y=n||0}Object.defineProperties(on.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(on.prototype,{isVector2:!0,set:function(t,n){return this.x=t,this.y=n,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this},addScaledVector:function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this},sub:function(t,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var n=this.x,e=this.y,i=t.elements;return this.x=i[0]*n+i[3]*e+i[6],this.y=i[1]*n+i[4]*e+i[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this},clampScalar:function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this},clampLength:function(t,n){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(n,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var n=this.x-t.x,e=this.y-t.y;return n*n+e*e},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this},lerpVectors:function(t,n,e){return this.subVectors(n,t).multiplyScalar(e).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,n){return n===void 0&&(n=0),this.x=t[n],this.y=t[n+1],this},toArray:function(t,n){return t===void 0&&(t=[]),n===void 0&&(n=0),t[n]=this.x,t[n+1]=this.y,t},fromBufferAttribute:function(t,n,e){return e!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this},rotateAround:function(t,n){var e=Math.cos(n),i=Math.sin(n),s=this.x-t.x,a=this.y-t.y;return this.x=s*e-a*i+t.x,this.y=s*i+a*e+t.y,this}});function Vi(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Vi.prototype,{isMatrix3:!0,set:function(t,n,e,i,s,a,o,r,u){var l=this.elements;return l[0]=t,l[1]=i,l[2]=o,l[3]=n,l[4]=s,l[5]=r,l[6]=e,l[7]=a,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(t){var n=this.elements,e=t.elements;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],this},setFromMatrix4:function(t){var n=t.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,n){var e=t.elements,i=n.elements,s=this.elements,a=e[0],o=e[3],r=e[6],u=e[1],l=e[4],h=e[7],f=e[2],d=e[5],p=e[8],b=i[0],v=i[3],x=i[6],w=i[1],M=i[4],E=i[7],D=i[2],N=i[5],V=i[8];return s[0]=a*b+o*w+r*D,s[3]=a*v+o*M+r*N,s[6]=a*x+o*E+r*V,s[1]=u*b+l*w+h*D,s[4]=u*v+l*M+h*N,s[7]=u*x+l*E+h*V,s[2]=f*b+d*w+p*D,s[5]=f*v+d*M+p*N,s[8]=f*x+d*E+p*V,this},multiplyScalar:function(t){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this},determinant:function(){var t=this.elements,n=t[0],e=t[1],i=t[2],s=t[3],a=t[4],o=t[5],r=t[6],u=t[7],l=t[8];return n*a*l-n*o*u-e*s*l+e*o*r+i*s*u-i*a*r},getInverse:function(t,n){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var e=t.elements,i=this.elements,s=e[0],a=e[1],o=e[2],r=e[3],u=e[4],l=e[5],h=e[6],f=e[7],d=e[8],p=d*u-l*f,b=l*h-d*r,v=f*r-u*h,x=s*p+a*b+o*v;if(x===0){var w="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(n===!0)throw new Error(w);return console.warn(w),this.identity()}var M=1/x;return i[0]=p*M,i[1]=(o*f-d*a)*M,i[2]=(l*a-o*u)*M,i[3]=b*M,i[4]=(d*s-o*h)*M,i[5]=(o*r-l*s)*M,i[6]=v*M,i[7]=(a*h-f*s)*M,i[8]=(u*s-a*r)*M,this},transpose:function(){var t,n=this.elements;return t=n[1],n[1]=n[3],n[3]=t,t=n[2],n[2]=n[6],n[6]=t,t=n[5],n[5]=n[7],n[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this},setUvTransform:function(t,n,e,i,s,a,o){var r=Math.cos(s),u=Math.sin(s);this.set(e*r,e*u,-e*(r*a+u*o)+a+t,-i*u,i*r,-i*(-u*a+r*o)+o+n,0,0,1)},scale:function(t,n){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=n,e[4]*=n,e[7]*=n,this},rotate:function(t){var n=Math.cos(t),e=Math.sin(t),i=this.elements,s=i[0],a=i[3],o=i[6],r=i[1],u=i[4],l=i[7];return i[0]=n*s+e*r,i[3]=n*a+e*u,i[6]=n*o+e*l,i[1]=-e*s+n*r,i[4]=-e*a+n*u,i[7]=-e*o+n*l,this},translate:function(t,n){var e=this.elements;return e[0]+=t*e[2],e[3]+=t*e[5],e[6]+=t*e[8],e[1]+=n*e[2],e[4]+=n*e[5],e[7]+=n*e[8],this},equals:function(t){for(var n=this.elements,e=t.elements,i=0;i<9;i++)if(n[i]!==e[i])return!1;return!0},fromArray:function(t,n){n===void 0&&(n=0);for(var e=0;e<9;e++)this.elements[e]=t[e+n];return this},toArray:function(t,n){t===void 0&&(t=[]),n===void 0&&(n=0);var e=this.elements;return t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3],t[n+4]=e[4],t[n+5]=e[5],t[n+6]=e[6],t[n+7]=e[7],t[n+8]=e[8],t}});var iu,Ul={getDataURL:function(t){var n;if(typeof HTMLCanvasElement=="undefined")return t.src;if(t instanceof HTMLCanvasElement)n=t;else{iu===void 0&&(iu=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),iu.width=t.width,iu.height=t.height;var e=iu.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),n=iu}return n.width>2048||n.height>2048?n.toDataURL("image/jpeg",.6):n.toDataURL("image/png")}},FC=0;function Nr(t,n,e,i,s,a,o,r,u,l){Object.defineProperty(this,"id",{value:FC++}),this.uuid=pr.generateUUID(),this.name="",this.image=t!==void 0?t:Nr.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=n!==void 0?n:Nr.DEFAULT_MAPPING,this.wrapS=e!==void 0?e:Qi,this.wrapT=i!==void 0?i:Qi,this.magFilter=s!==void 0?s:pi,this.minFilter=a!==void 0?a:Qc,this.anisotropy=u!==void 0?u:1,this.format=o!==void 0?o:as,this.internalFormat=null,this.type=r!==void 0?r:Qp,this.offset=new on(0,0),this.repeat=new on(1,1),this.center=new on(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=l!==void 0?l:Fo,this.version=0,this.onUpdate=null}Nr.DEFAULT_IMAGE=void 0,Nr.DEFAULT_MAPPING=G1,Nr.prototype=Object.assign(Object.create(sa.prototype),{constructor:Nr,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];var e={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var i=this.image;if(i.uuid===void 0&&(i.uuid=pr.generateUUID()),!n&&t.images[i.uuid]===void 0){var s;if(Array.isArray(i)){s=[];for(var a=0,o=i.length;a<o;a++)s.push(Ul.getDataURL(i[a]))}else s=Ul.getDataURL(i);t.images[i.uuid]={uuid:i.uuid,url:s}}e.image=i.uuid}return n||(t.textures[this.uuid]=e),e},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==G1)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ol:t.x=t.x-Math.floor(t.x);break;case Qi:t.x=t.x<0?0:1;break;case ad:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Ol:t.y=t.y-Math.floor(t.y);break;case Qi:t.y=t.y<0?0:1;break;case ad:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Nr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function Or(t,n,e,i){this.x=t||0,this.y=n||0,this.z=e||0,this.w=i!==void 0?i:1}Object.defineProperties(Or.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(Or.prototype,{isVector4:!0,set:function(t,n,e,i){return this.x=t,this.y=n,this.z=e,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},add:function(t,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this},addScaledVector:function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this},sub:function(t,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var n=this.x,e=this.y,i=this.z,s=this.w,a=t.elements;return this.x=a[0]*n+a[4]*e+a[8]*i+a[12]*s,this.y=a[1]*n+a[5]*e+a[9]*i+a[13]*s,this.z=a[2]*n+a[6]*e+a[10]*i+a[14]*s,this.w=a[3]*n+a[7]*e+a[11]*i+a[15]*s,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this},setAxisAngleFromRotationMatrix:function(t){var n,e,i,s,a=.01,o=.1,r=t.elements,u=r[0],l=r[4],h=r[8],f=r[1],d=r[5],p=r[9],b=r[2],v=r[6],x=r[10];if(Math.abs(l-f)<a&&Math.abs(h-b)<a&&Math.abs(p-v)<a){if(Math.abs(l+f)<o&&Math.abs(h+b)<o&&Math.abs(p+v)<o&&Math.abs(u+d+x-3)<o)return this.set(1,0,0,0),this;n=Math.PI;var w=(u+1)/2,M=(d+1)/2,E=(x+1)/2,D=(l+f)/4,N=(h+b)/4,V=(p+v)/4;return w>M&&w>E?w<a?(e=0,i=.707106781,s=.707106781):(e=Math.sqrt(w),i=D/e,s=N/e):M>E?M<a?(e=.707106781,i=0,s=.707106781):(i=Math.sqrt(M),e=D/i,s=V/i):E<a?(e=.707106781,i=.707106781,s=0):(s=Math.sqrt(E),e=N/s,i=V/s),this.set(e,i,s,n),this}var K=Math.sqrt((v-p)*(v-p)+(h-b)*(h-b)+(f-l)*(f-l));return Math.abs(K)<.001&&(K=1),this.x=(v-p)/K,this.y=(h-b)/K,this.z=(f-l)/K,this.w=Math.acos((u+d+x-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this.w=Math.max(t.w,Math.min(n.w,this.w)),this},clampScalar:function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this.w=Math.max(t,Math.min(n,this.w)),this},clampLength:function(t,n){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(n,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this},lerpVectors:function(t,n,e){return this.subVectors(n,t).multiplyScalar(e).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,n){return n===void 0&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this},toArray:function(t,n){return t===void 0&&(t=[]),n===void 0&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t},fromBufferAttribute:function(t,n,e){return e!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this}});function to(t,n,e){this.width=t,this.height=n,this.scissor=new Or(0,0,t,n),this.scissorTest=!1,this.viewport=new Or(0,0,t,n),e=e||{},this.texture=new Nr(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=n,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:pi,this.depthBuffer=e.depthBuffer!==void 0?e.depthBuffer:!0,this.stencilBuffer=e.stencilBuffer!==void 0?e.stencilBuffer:!0,this.depthTexture=e.depthTexture!==void 0?e.depthTexture:null}to.prototype=Object.assign(Object.create(sa.prototype),{constructor:to,isWebGLRenderTarget:!0,setSize:function(t,n){(this.width!==t||this.height!==n)&&(this.width=t,this.height=n,this.texture.image.width=t,this.texture.image.height=n,this.dispose()),this.viewport.set(0,0,t,n),this.scissor.set(0,0,t,n)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function U_(t,n,e){to.call(this,t,n,e),this.samples=4}U_.prototype=Object.assign(Object.create(to.prototype),{constructor:U_,isWebGLMultisampleRenderTarget:!0,copy:function(t){return to.prototype.copy.call(this,t),this.samples=t.samples,this}});function mo(t,n,e,i){this._x=t||0,this._y=n||0,this._z=e||0,this._w=i!==void 0?i:1}Object.assign(mo,{slerp:function(t,n,e,i){return e.copy(t).slerp(n,i)},slerpFlat:function(t,n,e,i,s,a,o){var r=e[i+0],u=e[i+1],l=e[i+2],h=e[i+3],f=s[a+0],d=s[a+1],p=s[a+2],b=s[a+3];if(h!==b||r!==f||u!==d||l!==p){var v=1-o,x=r*f+u*d+l*p+h*b,w=x>=0?1:-1,M=1-x*x;if(M>Number.EPSILON){var E=Math.sqrt(M),D=Math.atan2(E,x*w);v=Math.sin(v*D)/E,o=Math.sin(o*D)/E}var N=o*w;if(r=r*v+f*N,u=u*v+d*N,l=l*v+p*N,h=h*v+b*N,v===1-o){var V=1/Math.sqrt(r*r+u*u+l*l+h*h);r*=V,u*=V,l*=V,h*=V}}t[n]=r,t[n+1]=u,t[n+2]=l,t[n+3]=h}}),Object.defineProperties(mo.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(mo.prototype,{isQuaternion:!0,set:function(t,n,e,i){return this._x=t,this._y=n,this._z=e,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,n){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var e=t._x,i=t._y,s=t._z,a=t.order,o=Math.cos,r=Math.sin,u=o(e/2),l=o(i/2),h=o(s/2),f=r(e/2),d=r(i/2),p=r(s/2);return a==="XYZ"?(this._x=f*l*h+u*d*p,this._y=u*d*h-f*l*p,this._z=u*l*p+f*d*h,this._w=u*l*h-f*d*p):a==="YXZ"?(this._x=f*l*h+u*d*p,this._y=u*d*h-f*l*p,this._z=u*l*p-f*d*h,this._w=u*l*h+f*d*p):a==="ZXY"?(this._x=f*l*h-u*d*p,this._y=u*d*h+f*l*p,this._z=u*l*p+f*d*h,this._w=u*l*h-f*d*p):a==="ZYX"?(this._x=f*l*h-u*d*p,this._y=u*d*h+f*l*p,this._z=u*l*p-f*d*h,this._w=u*l*h+f*d*p):a==="YZX"?(this._x=f*l*h+u*d*p,this._y=u*d*h+f*l*p,this._z=u*l*p-f*d*h,this._w=u*l*h-f*d*p):a==="XZY"&&(this._x=f*l*h-u*d*p,this._y=u*d*h-f*l*p,this._z=u*l*p+f*d*h,this._w=u*l*h+f*d*p),n!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(t,n){var e=n/2,i=Math.sin(e);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(e),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var n=t.elements,e=n[0],i=n[4],s=n[8],a=n[1],o=n[5],r=n[9],u=n[2],l=n[6],h=n[10],f=e+o+h,d;return f>0?(d=.5/Math.sqrt(f+1),this._w=.25/d,this._x=(l-r)*d,this._y=(s-u)*d,this._z=(a-i)*d):e>o&&e>h?(d=2*Math.sqrt(1+e-o-h),this._w=(l-r)/d,this._x=.25*d,this._y=(i+a)/d,this._z=(s+u)/d):o>h?(d=2*Math.sqrt(1+o-e-h),this._w=(s-u)/d,this._x=(i+a)/d,this._y=.25*d,this._z=(r+l)/d):(d=2*Math.sqrt(1+h-e-o),this._w=(a-i)/d,this._x=(s+u)/d,this._y=(r+l)/d,this._z=.25*d),this._onChangeCallback(),this},setFromUnitVectors:function(t,n){var e=1e-6,i=t.dot(n)+1;return i<e?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*n.z-t.z*n.y,this._y=t.z*n.x-t.x*n.z,this._z=t.x*n.y-t.y*n.x,this._w=i),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(pr.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,n){var e=this.angleTo(t);if(e===0)return this;var i=Math.min(1,n/e);return this.slerp(t,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,n)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,n){var e=t._x,i=t._y,s=t._z,a=t._w,o=n._x,r=n._y,u=n._z,l=n._w;return this._x=e*l+a*o+i*u-s*r,this._y=i*l+a*r+s*o-e*u,this._z=s*l+a*u+e*r-i*o,this._w=a*l-e*o-i*r-s*u,this._onChangeCallback(),this},slerp:function(t,n){if(n===0)return this;if(n===1)return this.copy(t);var e=this._x,i=this._y,s=this._z,a=this._w,o=a*t._w+e*t._x+i*t._y+s*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=e,this._y=i,this._z=s,this;var r=1-o*o;if(r<=Number.EPSILON){var u=1-n;return this._w=u*a+n*this._w,this._x=u*e+n*this._x,this._y=u*i+n*this._y,this._z=u*s+n*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(r),h=Math.atan2(l,o),f=Math.sin((1-n)*h)/l,d=Math.sin(n*h)/l;return this._w=a*f+this._w*d,this._x=e*f+this._x*d,this._y=i*f+this._y*d,this._z=s*f+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,n){return n===void 0&&(n=0),this._x=t[n],this._y=t[n+1],this._z=t[n+2],this._w=t[n+3],this._onChangeCallback(),this},toArray:function(t,n){return t===void 0&&(t=[]),n===void 0&&(n=0),t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Q1=new oe,V_=new mo;function oe(t,n,e){this.x=t||0,this.y=n||0,this.z=e||0}Object.assign(oe.prototype,{isVector3:!0,set:function(t,n,e){return this.x=t,this.y=n,this.z=e,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this},addScaledVector:function(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this},sub:function(t,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this},multiply:function(t,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,n)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(V_.setFromEuler(t))},applyAxisAngle:function(t,n){return this.applyQuaternion(V_.setFromAxisAngle(t,n))},applyMatrix3:function(t){var n=this.x,e=this.y,i=this.z,s=t.elements;return this.x=s[0]*n+s[3]*e+s[6]*i,this.y=s[1]*n+s[4]*e+s[7]*i,this.z=s[2]*n+s[5]*e+s[8]*i,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var n=this.x,e=this.y,i=this.z,s=t.elements,a=1/(s[3]*n+s[7]*e+s[11]*i+s[15]);return this.x=(s[0]*n+s[4]*e+s[8]*i+s[12])*a,this.y=(s[1]*n+s[5]*e+s[9]*i+s[13])*a,this.z=(s[2]*n+s[6]*e+s[10]*i+s[14])*a,this},applyQuaternion:function(t){var n=this.x,e=this.y,i=this.z,s=t.x,a=t.y,o=t.z,r=t.w,u=r*n+a*i-o*e,l=r*e+o*n-s*i,h=r*i+s*e-a*n,f=-s*n-a*e-o*i;return this.x=u*r+f*-s+l*-o-h*-a,this.y=l*r+f*-a+h*-s-u*-o,this.z=h*r+f*-o+u*-a-l*-s,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var n=this.x,e=this.y,i=this.z,s=t.elements;return this.x=s[0]*n+s[4]*e+s[8]*i,this.y=s[1]*n+s[5]*e+s[9]*i,this.z=s[2]*n+s[6]*e+s[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this},clampScalar:function(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this},clampLength:function(t,n){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(n,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this},lerpVectors:function(t,n,e){return this.subVectors(n,t).multiplyScalar(e).add(t)},cross:function(t,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,n)):this.crossVectors(this,t)},crossVectors:function(t,n){var e=t.x,i=t.y,s=t.z,a=n.x,o=n.y,r=n.z;return this.x=i*r-s*o,this.y=s*a-e*r,this.z=e*o-i*a,this},projectOnVector:function(t){var n=t.lengthSq();if(n===0)return this.set(0,0,0);var e=t.dot(this)/n;return this.copy(t).multiplyScalar(e)},projectOnPlane:function(t){return Q1.copy(this).projectOnVector(t),this.sub(Q1)},reflect:function(t){return this.sub(Q1.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;var e=this.dot(t)/n;return Math.acos(pr.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var n=this.x-t.x,e=this.y-t.y,i=this.z-t.z;return n*n+e*e+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,n,e){var i=Math.sin(n)*t;return this.x=i*Math.sin(e),this.y=Math.cos(n)*t,this.z=i*Math.cos(e),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,n,e){return this.x=t*Math.sin(n),this.y=e,this.z=t*Math.cos(n),this},setFromMatrixPosition:function(t){var n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this},setFromMatrixScale:function(t){var n=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=e,this.z=i,this},setFromMatrixColumn:function(t,n){return this.fromArray(t.elements,n*4)},setFromMatrix3Column:function(t,n){return this.fromArray(t.elements,n*3)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,n){return n===void 0&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this},toArray:function(t,n){return t===void 0&&(t=[]),n===void 0&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t},fromBufferAttribute:function(t,n,e){return e!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this}});var ou=new oe,ls=new mr,NC=new oe(0,0,0),OC=new oe(1,1,1),Va=new oe,im=new oe,No=new oe;function mr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(mr.prototype,{isMatrix4:!0,set:function(t,n,e,i,s,a,o,r,u,l,h,f,d,p,b,v){var x=this.elements;return x[0]=t,x[4]=n,x[8]=e,x[12]=i,x[1]=s,x[5]=a,x[9]=o,x[13]=r,x[2]=u,x[6]=l,x[10]=h,x[14]=f,x[3]=d,x[7]=p,x[11]=b,x[15]=v,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new mr().fromArray(this.elements)},copy:function(t){var n=this.elements,e=t.elements;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],this},copyPosition:function(t){var n=this.elements,e=t.elements;return n[12]=e[12],n[13]=e[13],n[14]=e[14],this},extractBasis:function(t,n,e){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this},makeBasis:function(t,n,e){return this.set(t.x,n.x,e.x,0,t.y,n.y,e.y,0,t.z,n.z,e.z,0,0,0,0,1),this},extractRotation:function(t){var n=this.elements,e=t.elements,i=1/ou.setFromMatrixColumn(t,0).length(),s=1/ou.setFromMatrixColumn(t,1).length(),a=1/ou.setFromMatrixColumn(t,2).length();return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=0,n[4]=e[4]*s,n[5]=e[5]*s,n[6]=e[6]*s,n[7]=0,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=this.elements,e=t.x,i=t.y,s=t.z,a=Math.cos(e),o=Math.sin(e),r=Math.cos(i),u=Math.sin(i),l=Math.cos(s),h=Math.sin(s);if(t.order==="XYZ"){var f=a*l,d=a*h,p=o*l,b=o*h;n[0]=r*l,n[4]=-r*h,n[8]=u,n[1]=d+p*u,n[5]=f-b*u,n[9]=-o*r,n[2]=b-f*u,n[6]=p+d*u,n[10]=a*r}else if(t.order==="YXZ"){var v=r*l,x=r*h,w=u*l,M=u*h;n[0]=v+M*o,n[4]=w*o-x,n[8]=a*u,n[1]=a*h,n[5]=a*l,n[9]=-o,n[2]=x*o-w,n[6]=M+v*o,n[10]=a*r}else if(t.order==="ZXY"){var v=r*l,x=r*h,w=u*l,M=u*h;n[0]=v-M*o,n[4]=-a*h,n[8]=w+x*o,n[1]=x+w*o,n[5]=a*l,n[9]=M-v*o,n[2]=-a*u,n[6]=o,n[10]=a*r}else if(t.order==="ZYX"){var f=a*l,d=a*h,p=o*l,b=o*h;n[0]=r*l,n[4]=p*u-d,n[8]=f*u+b,n[1]=r*h,n[5]=b*u+f,n[9]=d*u-p,n[2]=-u,n[6]=o*r,n[10]=a*r}else if(t.order==="YZX"){var E=a*r,D=a*u,N=o*r,V=o*u;n[0]=r*l,n[4]=V-E*h,n[8]=N*h+D,n[1]=h,n[5]=a*l,n[9]=-o*l,n[2]=-u*l,n[6]=D*h+N,n[10]=E-V*h}else if(t.order==="XZY"){var E=a*r,D=a*u,N=o*r,V=o*u;n[0]=r*l,n[4]=-h,n[8]=u*l,n[1]=E*h+V,n[5]=a*l,n[9]=D*h-N,n[2]=N*h-D,n[6]=o*l,n[10]=V*h+E}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(NC,t,OC)},lookAt:function(t,n,e){var i=this.elements;return No.subVectors(t,n),No.lengthSq()===0&&(No.z=1),No.normalize(),Va.crossVectors(e,No),Va.lengthSq()===0&&(Math.abs(e.z)===1?No.x+=1e-4:No.z+=1e-4,No.normalize(),Va.crossVectors(e,No)),Va.normalize(),im.crossVectors(No,Va),i[0]=Va.x,i[4]=im.x,i[8]=No.x,i[1]=Va.y,i[5]=im.y,i[9]=No.y,i[2]=Va.z,i[6]=im.z,i[10]=No.z,this},multiply:function(t,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,n)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,n){var e=t.elements,i=n.elements,s=this.elements,a=e[0],o=e[4],r=e[8],u=e[12],l=e[1],h=e[5],f=e[9],d=e[13],p=e[2],b=e[6],v=e[10],x=e[14],w=e[3],M=e[7],E=e[11],D=e[15],N=i[0],V=i[4],K=i[8],j=i[12],Z=i[1],tt=i[5],rt=i[9],J=i[13],U=i[2],G=i[6],I=i[10],C=i[14],L=i[3],B=i[7],O=i[11],q=i[15];return s[0]=a*N+o*Z+r*U+u*L,s[4]=a*V+o*tt+r*G+u*B,s[8]=a*K+o*rt+r*I+u*O,s[12]=a*j+o*J+r*C+u*q,s[1]=l*N+h*Z+f*U+d*L,s[5]=l*V+h*tt+f*G+d*B,s[9]=l*K+h*rt+f*I+d*O,s[13]=l*j+h*J+f*C+d*q,s[2]=p*N+b*Z+v*U+x*L,s[6]=p*V+b*tt+v*G+x*B,s[10]=p*K+b*rt+v*I+x*O,s[14]=p*j+b*J+v*C+x*q,s[3]=w*N+M*Z+E*U+D*L,s[7]=w*V+M*tt+E*G+D*B,s[11]=w*K+M*rt+E*I+D*O,s[15]=w*j+M*J+E*C+D*q,this},multiplyScalar:function(t){var n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this},determinant:function(){var t=this.elements,n=t[0],e=t[4],i=t[8],s=t[12],a=t[1],o=t[5],r=t[9],u=t[13],l=t[2],h=t[6],f=t[10],d=t[14],p=t[3],b=t[7],v=t[11],x=t[15];return p*(+s*r*h-i*u*h-s*o*f+e*u*f+i*o*d-e*r*d)+b*(+n*r*d-n*u*f+s*a*f-i*a*d+i*u*l-s*r*l)+v*(+n*u*h-n*o*d-s*a*h+e*a*d+s*o*l-e*u*l)+x*(-i*o*l-n*r*h+n*o*f+i*a*h-e*a*f+e*r*l)},transpose:function(){var t=this.elements,n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,this},setPosition:function(t,n,e){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=n,i[14]=e),this},getInverse:function(t,n){var e=this.elements,i=t.elements,s=i[0],a=i[1],o=i[2],r=i[3],u=i[4],l=i[5],h=i[6],f=i[7],d=i[8],p=i[9],b=i[10],v=i[11],x=i[12],w=i[13],M=i[14],E=i[15],D=p*M*f-w*b*f+w*h*v-l*M*v-p*h*E+l*b*E,N=x*b*f-d*M*f-x*h*v+u*M*v+d*h*E-u*b*E,V=d*w*f-x*p*f+x*l*v-u*w*v-d*l*E+u*p*E,K=x*p*h-d*w*h-x*l*b+u*w*b+d*l*M-u*p*M,j=s*D+a*N+o*V+r*K;if(j===0){var Z="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(n===!0)throw new Error(Z);return console.warn(Z),this.identity()}var tt=1/j;return e[0]=D*tt,e[1]=(w*b*r-p*M*r-w*o*v+a*M*v+p*o*E-a*b*E)*tt,e[2]=(l*M*r-w*h*r+w*o*f-a*M*f-l*o*E+a*h*E)*tt,e[3]=(p*h*r-l*b*r-p*o*f+a*b*f+l*o*v-a*h*v)*tt,e[4]=N*tt,e[5]=(d*M*r-x*b*r+x*o*v-s*M*v-d*o*E+s*b*E)*tt,e[6]=(x*h*r-u*M*r-x*o*f+s*M*f+u*o*E-s*h*E)*tt,e[7]=(u*b*r-d*h*r+d*o*f-s*b*f-u*o*v+s*h*v)*tt,e[8]=V*tt,e[9]=(x*p*r-d*w*r-x*a*v+s*w*v+d*a*E-s*p*E)*tt,e[10]=(u*w*r-x*l*r+x*a*f-s*w*f-u*a*E+s*l*E)*tt,e[11]=(d*l*r-u*p*r-d*a*f+s*p*f+u*a*v-s*l*v)*tt,e[12]=K*tt,e[13]=(d*w*o-x*p*o+x*a*b-s*w*b-d*a*M+s*p*M)*tt,e[14]=(x*l*o-u*w*o-x*a*h+s*w*h+u*a*M-s*l*M)*tt,e[15]=(u*p*o-d*l*o+d*a*h-s*p*h-u*a*b+s*l*b)*tt,this},scale:function(t){var n=this.elements,e=t.x,i=t.y,s=t.z;return n[0]*=e,n[4]*=i,n[8]*=s,n[1]*=e,n[5]*=i,n[9]*=s,n[2]*=e,n[6]*=i,n[10]*=s,n[3]*=e,n[7]*=i,n[11]*=s,this},getMaxScaleOnAxis:function(){var t=this.elements,n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(n,e,i))},makeTranslation:function(t,n,e){return this.set(1,0,0,t,0,1,0,n,0,0,1,e,0,0,0,1),this},makeRotationX:function(t){var n=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,n,-e,0,0,e,n,0,0,0,0,1),this},makeRotationY:function(t){var n=Math.cos(t),e=Math.sin(t);return this.set(n,0,e,0,0,1,0,0,-e,0,n,0,0,0,0,1),this},makeRotationZ:function(t){var n=Math.cos(t),e=Math.sin(t);return this.set(n,-e,0,0,e,n,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,n){var e=Math.cos(n),i=Math.sin(n),s=1-e,a=t.x,o=t.y,r=t.z,u=s*a,l=s*o;return this.set(u*a+e,u*o-i*r,u*r+i*o,0,u*o+i*r,l*o+e,l*r-i*a,0,u*r-i*o,l*r+i*a,s*r*r+e,0,0,0,0,1),this},makeScale:function(t,n,e){return this.set(t,0,0,0,0,n,0,0,0,0,e,0,0,0,0,1),this},makeShear:function(t,n,e){return this.set(1,n,e,0,t,1,e,0,t,n,1,0,0,0,0,1),this},compose:function(t,n,e){var i=this.elements,s=n._x,a=n._y,o=n._z,r=n._w,u=s+s,l=a+a,h=o+o,f=s*u,d=s*l,p=s*h,b=a*l,v=a*h,x=o*h,w=r*u,M=r*l,E=r*h,D=e.x,N=e.y,V=e.z;return i[0]=(1-(b+x))*D,i[1]=(d+E)*D,i[2]=(p-M)*D,i[3]=0,i[4]=(d-E)*N,i[5]=(1-(f+x))*N,i[6]=(v+w)*N,i[7]=0,i[8]=(p+M)*V,i[9]=(v-w)*V,i[10]=(1-(f+b))*V,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:function(t,n,e){var i=this.elements,s=ou.set(i[0],i[1],i[2]).length(),a=ou.set(i[4],i[5],i[6]).length(),o=ou.set(i[8],i[9],i[10]).length(),r=this.determinant();r<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],ls.copy(this);var u=1/s,l=1/a,h=1/o;return ls.elements[0]*=u,ls.elements[1]*=u,ls.elements[2]*=u,ls.elements[4]*=l,ls.elements[5]*=l,ls.elements[6]*=l,ls.elements[8]*=h,ls.elements[9]*=h,ls.elements[10]*=h,n.setFromRotationMatrix(ls),e.x=s,e.y=a,e.z=o,this},makePerspective:function(t,n,e,i,s,a){a===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,r=2*s/(n-t),u=2*s/(e-i),l=(n+t)/(n-t),h=(e+i)/(e-i),f=-(a+s)/(a-s),d=-2*a*s/(a-s);return o[0]=r,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=f,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,n,e,i,s,a){var o=this.elements,r=1/(n-t),u=1/(e-i),l=1/(a-s),h=(n+t)*r,f=(e+i)*u,d=(a+s)*l;return o[0]=2*r,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-f,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var n=this.elements,e=t.elements,i=0;i<16;i++)if(n[i]!==e[i])return!1;return!0},fromArray:function(t,n){n===void 0&&(n=0);for(var e=0;e<16;e++)this.elements[e]=t[e+n];return this},toArray:function(t,n){t===void 0&&(t=[]),n===void 0&&(n=0);var e=this.elements;return t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3],t[n+4]=e[4],t[n+5]=e[5],t[n+6]=e[6],t[n+7]=e[7],t[n+8]=e[8],t[n+9]=e[9],t[n+10]=e[10],t[n+11]=e[11],t[n+12]=e[12],t[n+13]=e[13],t[n+14]=e[14],t[n+15]=e[15],t}});var j_=new mr,G_=new mo;function su(t,n,e,i){this._x=t||0,this._y=n||0,this._z=e||0,this._order=i||su.DefaultOrder}su.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],su.DefaultOrder="XYZ",Object.defineProperties(su.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(su.prototype,{isEuler:!0,set:function(t,n,e,i){return this._x=t,this._y=n,this._z=e,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,n,e){var i=pr.clamp,s=t.elements,a=s[0],o=s[4],r=s[8],u=s[1],l=s[5],h=s[9],f=s[2],d=s[6],p=s[10];return n=n||this._order,n==="XYZ"?(this._y=Math.asin(i(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,l),this._z=0)):n==="YXZ"?(this._x=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(r,p),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-f,a),this._z=0)):n==="ZXY"?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(u,a))):n==="ZYX"?(this._y=Math.asin(-i(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,l))):n==="YZX"?(this._z=Math.asin(i(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(r,p))):n==="XZY"?(this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(r,a)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+n),this._order=n,e!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(t,n,e){return j_.makeRotationFromQuaternion(t),this.setFromRotationMatrix(j_,n,e)},setFromVector3:function(t,n){return this.set(t.x,t.y,t.z,n||this._order)},reorder:function(t){return G_.setFromEuler(this),this.setFromQuaternion(G_,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,n){return t===void 0&&(t=[]),n===void 0&&(n=0),t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new oe(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});function H_(){this.mask=1}Object.assign(H_.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return(this.mask&t.mask)!==0}});var zC=0,W_=new oe,au=new mo,aa=new mr,om=new oe,pd=new oe,UC=new oe,VC=new mo,q_=new oe(1,0,0),X_=new oe(0,1,0),Y_=new oe(0,0,1),jC={type:"added"},GC={type:"removed"};function Rn(){Object.defineProperty(this,"id",{value:zC++}),this.uuid=pr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Rn.DefaultUp.clone();var t=new oe,n=new su,e=new mo,i=new oe(1,1,1);function s(){e.setFromEuler(n,!1)}function a(){n.setFromQuaternion(e,void 0,!1)}n._onChange(s),e._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:e},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new mr},normalMatrix:{value:new Vi}}),this.matrix=new mr,this.matrixWorld=new mr,this.matrixAutoUpdate=Rn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new H_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Rn.DefaultUp=new oe(0,1,0),Rn.DefaultMatrixAutoUpdate=!0,Rn.prototype=Object.assign(Object.create(sa.prototype),{constructor:Rn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,n){this.quaternion.setFromAxisAngle(t,n)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,n){return au.setFromAxisAngle(t,n),this.quaternion.multiply(au),this},rotateOnWorldAxis:function(t,n){return au.setFromAxisAngle(t,n),this.quaternion.premultiply(au),this},rotateX:function(t){return this.rotateOnAxis(q_,t)},rotateY:function(t){return this.rotateOnAxis(X_,t)},rotateZ:function(t){return this.rotateOnAxis(Y_,t)},translateOnAxis:function(t,n){return W_.copy(t).applyQuaternion(this.quaternion),this.position.add(W_.multiplyScalar(n)),this},translateX:function(t){return this.translateOnAxis(q_,t)},translateY:function(t){return this.translateOnAxis(X_,t)},translateZ:function(t){return this.translateOnAxis(Y_,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(aa.getInverse(this.matrixWorld))},lookAt:function(t,n,e){t.isVector3?om.copy(t):om.set(t,n,e);var i=this.parent;this.updateWorldMatrix(!0,!1),pd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?aa.lookAt(pd,om,this.up):aa.lookAt(om,pd,this.up),this.quaternion.setFromRotationMatrix(aa),i&&(aa.extractRotation(i.matrixWorld),au.setFromRotationMatrix(aa),this.quaternion.premultiply(au.inverse()))},add:function(t){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(jC)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}var e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(GC)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),aa.getInverse(this.matrixWorld),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),aa.multiply(t.parent.matrixWorld)),t.applyMatrix4(aa),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,n){if(this[t]===n)return this;for(var e=0,i=this.children.length;e<i;e++){var s=this.children[e],a=s.getObjectByProperty(t,n);if(a!==void 0)return a}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new oe),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new mo),this.updateMatrixWorld(!0),this.matrixWorld.decompose(pd,t,UC),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new oe),this.updateMatrixWorld(!0),this.matrixWorld.decompose(pd,VC,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new oe),this.updateMatrixWorld(!0);var n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var n=this.children,e=0,i=n.length;e<i;e++)n[e].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var n=this.children,e=0,i=n.length;e<i;e++)n[e].traverseVisible(t)}},traverseAncestors:function(t){var n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var n=this.children,e=0,i=n.length;e<i;e++)n[e].updateMatrixWorld(t)},updateWorldMatrix:function(t,n){var e=this.parent;if(t===!0&&e!==null&&e.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0)for(var i=this.children,s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)},toJSON:function(t){var n=t===void 0||typeof t=="string",e={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON());function s(x,w){return x[w.uuid]===void 0&&(x[w.uuid]=w.toJSON(t)),w.uuid}if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(t.geometries,this.geometry);var a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){var o=a.shapes;if(Array.isArray(o))for(var r=0,u=o.length;r<u;r++){var l=o[r];s(t.shapes,l)}else s(t.shapes,o)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var h=[],r=0,u=this.material.length;r<u;r++)h.push(s(t.materials,this.material[r]));i.material=h}else i.material=s(t.materials,this.material);if(this.children.length>0){i.children=[];for(var r=0;r<this.children.length;r++)i.children.push(this.children[r].toJSON(t).object)}if(n){var f=v(t.geometries),d=v(t.materials),p=v(t.textures),b=v(t.images),o=v(t.shapes);f.length>0&&(e.geometries=f),d.length>0&&(e.materials=d),p.length>0&&(e.textures=p),b.length>0&&(e.images=b),o.length>0&&(e.shapes=o)}return e.object=i,e;function v(x){var w=[];for(var M in x){var E=x[M];delete E.metadata,w.push(E)}return w}},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,n){if(n===void 0&&(n=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(var e=0;e<t.children.length;e++){var i=t.children[e];this.add(i.clone())}return this}});function la(){Rn.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}la.prototype=Object.assign(Object.create(Rn.prototype),{constructor:la,isScene:!0,copy:function(t,n){return Rn.prototype.copy.call(this,t,n),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var n=Rn.prototype.toJSON.call(this,t);return this.background!==null&&(n.object.background=this.background.toJSON(t)),this.environment!==null&&(n.object.environment=this.environment.toJSON(t)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ca=[new oe,new oe,new oe,new oe,new oe,new oe,new oe,new oe],md=new oe,sm=new cs,lu=new oe,cu=new oe,uu=new oe,ja=new oe,Ga=new oe,Vl=new oe,gd=new oe,am=new oe,lm=new oe,jl=new oe;function cs(t,n){this.min=t!==void 0?t:new oe(1/0,1/0,1/0),this.max=n!==void 0?n:new oe(-1/0,-1/0,-1/0)}Object.assign(cs.prototype,{isBox3:!0,set:function(t,n){return this.min.copy(t),this.max.copy(n),this},setFromArray:function(t){for(var n=1/0,e=1/0,i=1/0,s=-1/0,a=-1/0,o=-1/0,r=0,u=t.length;r<u;r+=3){var l=t[r],h=t[r+1],f=t[r+2];l<n&&(n=l),h<e&&(e=h),f<i&&(i=f),l>s&&(s=l),h>a&&(a=h),f>o&&(o=f)}return this.min.set(n,e,i),this.max.set(s,a,o),this},setFromBufferAttribute:function(t){for(var n=1/0,e=1/0,i=1/0,s=-1/0,a=-1/0,o=-1/0,r=0,u=t.count;r<u;r++){var l=t.getX(r),h=t.getY(r),f=t.getZ(r);l<n&&(n=l),h<e&&(e=h),f<i&&(i=f),l>s&&(s=l),h>a&&(a=h),f>o&&(o=f)}return this.min.set(n,e,i),this.max.set(s,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var n=0,e=t.length;n<e;n++)this.expandByPoint(t[n]);return this},setFromCenterAndSize:function(t,n){var e=md.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new oe),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new oe),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var n=t.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),sm.copy(n.boundingBox),sm.applyMatrix4(t.matrixWorld),this.expandByPoint(sm.min),this.expandByPoint(sm.max));for(var e=t.children,i=0,s=e.length;i<s;i++)this.expandByObject(e[i]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new oe),n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,md),md.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var n,e;return t.normal.x>0?(n=t.normal.x*this.min.x,e=t.normal.x*this.max.x):(n=t.normal.x*this.max.x,e=t.normal.x*this.min.x),t.normal.y>0?(n+=t.normal.y*this.min.y,e+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,e+=t.normal.y*this.min.y),t.normal.z>0?(n+=t.normal.z*this.min.z,e+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,e+=t.normal.z*this.min.z),n<=-t.constant&&e>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(gd),am.subVectors(this.max,gd),lu.subVectors(t.a,gd),cu.subVectors(t.b,gd),uu.subVectors(t.c,gd),ja.subVectors(cu,lu),Ga.subVectors(uu,cu),Vl.subVectors(lu,uu);var n=[0,-ja.z,ja.y,0,-Ga.z,Ga.y,0,-Vl.z,Vl.y,ja.z,0,-ja.x,Ga.z,0,-Ga.x,Vl.z,0,-Vl.x,-ja.y,ja.x,0,-Ga.y,Ga.x,0,-Vl.y,Vl.x,0];return!ty(n,lu,cu,uu,am)||(n=[1,0,0,0,1,0,0,0,1],!ty(n,lu,cu,uu,am))?!1:(lm.crossVectors(ja,Ga),n=[lm.x,lm.y,lm.z],ty(n,lu,cu,uu,am))},clampPoint:function(t,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new oe),n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){var n=md.copy(t).clamp(this.min,this.max);return n.sub(t).length()},getBoundingSphere:function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=this.getSize(md).length()*.5,t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()?this:(ca[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ca[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ca[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ca[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ca[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ca[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ca[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ca[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ca),this)},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});function ty(t,n,e,i,s){var a,o;for(a=0,o=t.length-3;a<=o;a+=3){jl.fromArray(t,a);var r=s.x*Math.abs(jl.x)+s.y*Math.abs(jl.y)+s.z*Math.abs(jl.z),u=n.dot(jl),l=e.dot(jl),h=i.dot(jl);if(Math.max(-Math.max(u,l,h),Math.min(u,l,h))>r)return!1}return!0}var HC=new cs;function ua(t,n){this.center=t!==void 0?t:new oe,this.radius=n!==void 0?n:0}Object.assign(ua.prototype,{set:function(t,n){return this.center.copy(t),this.radius=n,this},setFromPoints:function(t,n){var e=this.center;n!==void 0?e.copy(n):HC.setFromPoints(t).getCenter(e);for(var i=0,s=0,a=t.length;s<a;s++)i=Math.max(i,e.distanceToSquared(t[s]));return this.radius=Math.sqrt(i),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,n){var e=this.center.distanceToSquared(t);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new oe),n.copy(t),e>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new cs),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var ha=new oe,ey=new oe,cm=new oe,Ha=new oe,ny=new oe,um=new oe,ry=new oe;function hu(t,n){this.origin=t!==void 0?t:new oe,this.direction=n!==void 0?n:new oe(0,0,-1)}Object.assign(hu.prototype,{set:function(t,n){return this.origin.copy(t),this.direction.copy(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new oe),n.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,ha)),this},closestPointToPoint:function(t,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new oe),n.subVectors(t,this.origin);var e=n.dot(this.direction);return e<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var n=ha.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(ha.copy(this.direction).multiplyScalar(n).add(this.origin),ha.distanceToSquared(t))},distanceSqToSegment:function(t,n,e,i){ey.copy(t).add(n).multiplyScalar(.5),cm.copy(n).sub(t).normalize(),Ha.copy(this.origin).sub(ey);var s=t.distanceTo(n)*.5,a=-this.direction.dot(cm),o=Ha.dot(this.direction),r=-Ha.dot(cm),u=Ha.lengthSq(),l=Math.abs(1-a*a),h,f,d,p;if(l>0)if(h=a*r-o,f=a*o-r,p=s*l,h>=0)if(f>=-p)if(f<=p){var b=1/l;h*=b,f*=b,d=h*(h+a*f+2*o)+f*(a*h+f+2*r)+u}else f=s,h=Math.max(0,-(a*f+o)),d=-h*h+f*(f+2*r)+u;else f=-s,h=Math.max(0,-(a*f+o)),d=-h*h+f*(f+2*r)+u;else f<=-p?(h=Math.max(0,-(-a*s+o)),f=h>0?-s:Math.min(Math.max(-s,-r),s),d=-h*h+f*(f+2*r)+u):f<=p?(h=0,f=Math.min(Math.max(-s,-r),s),d=f*(f+2*r)+u):(h=Math.max(0,-(a*s+o)),f=h>0?s:Math.min(Math.max(-s,-r),s),d=-h*h+f*(f+2*r)+u);else f=a>0?-s:s,h=Math.max(0,-(a*f+o)),d=-h*h+f*(f+2*r)+u;return e&&e.copy(this.direction).multiplyScalar(h).add(this.origin),i&&i.copy(cm).multiplyScalar(f).add(ey),d},intersectSphere:function(t,n){ha.subVectors(t.center,this.origin);var e=ha.dot(this.direction),i=ha.dot(ha)-e*e,s=t.radius*t.radius;if(i>s)return null;var a=Math.sqrt(s-i),o=e-a,r=e+a;return o<0&&r<0?null:o<0?this.at(r,n):this.at(o,n)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var n=t.normal.dot(this.direction);if(n===0)return t.distanceToPoint(this.origin)===0?0:null;var e=-(this.origin.dot(t.normal)+t.constant)/n;return e>=0?e:null},intersectPlane:function(t,n){var e=this.distanceToPlane(t);return e===null?null:this.at(e,n)},intersectsPlane:function(t){var n=t.distanceToPoint(this.origin);if(n===0)return!0;var e=t.normal.dot(this.direction);return e*n<0},intersectBox:function(t,n){var e,i,s,a,o,r,u=1/this.direction.x,l=1/this.direction.y,h=1/this.direction.z,f=this.origin;return u>=0?(e=(t.min.x-f.x)*u,i=(t.max.x-f.x)*u):(e=(t.max.x-f.x)*u,i=(t.min.x-f.x)*u),l>=0?(s=(t.min.y-f.y)*l,a=(t.max.y-f.y)*l):(s=(t.max.y-f.y)*l,a=(t.min.y-f.y)*l),e>a||s>i||((s>e||e!==e)&&(e=s),(a<i||i!==i)&&(i=a),h>=0?(o=(t.min.z-f.z)*h,r=(t.max.z-f.z)*h):(o=(t.max.z-f.z)*h,r=(t.min.z-f.z)*h),e>r||o>i)||((o>e||e!==e)&&(e=o),(r<i||i!==i)&&(i=r),i<0)?null:this.at(e>=0?e:i,n)},intersectsBox:function(t){return this.intersectBox(t,ha)!==null},intersectTriangle:function(t,n,e,i,s){ny.subVectors(n,t),um.subVectors(e,t),ry.crossVectors(ny,um);var a=this.direction.dot(ry),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Ha.subVectors(this.origin,t);var r=o*this.direction.dot(um.crossVectors(Ha,um));if(r<0)return null;var u=o*this.direction.dot(ny.cross(Ha));if(u<0||r+u>a)return null;var l=-o*Ha.dot(ry);return l<0?null:this.at(l/a,s)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var iy=new oe,WC=new oe,qC=new Vi;function Ps(t,n){this.normal=t!==void 0?t:new oe(1,0,0),this.constant=n!==void 0?n:0}Object.assign(Ps.prototype,{isPlane:!0,set:function(t,n){return this.normal.copy(t),this.constant=n,this},setComponents:function(t,n,e,i){return this.normal.set(t,n,e),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this},setFromCoplanarPoints:function(t,n,e){var i=iy.subVectors(e,n).cross(WC.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new oe),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new oe);var e=t.delta(iy),i=this.normal.dot(e);if(i===0)return this.distanceToPoint(t.start)===0?n.copy(t.start):void 0;var s=-(t.start.dot(this.normal)+this.constant)/i;if(!(s<0||s>1))return n.copy(e).multiplyScalar(s).add(t.start)},intersectsLine:function(t){var n=this.distanceToPoint(t.start),e=this.distanceToPoint(t.end);return n<0&&e>0||e<0&&n>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new oe),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,n){var e=n||qC.getNormalMatrix(t),i=this.coplanarPoint(iy).applyMatrix4(t),s=this.normal.applyMatrix3(e).normalize();return this.constant=-i.dot(s),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var us=new oe,da=new oe,oy=new oe,fa=new oe,du=new oe,fu=new oe,K_=new oe,sy=new oe,ay=new oe,ly=new oe;function Bi(t,n,e){this.a=t!==void 0?t:new oe,this.b=n!==void 0?n:new oe,this.c=e!==void 0?e:new oe}Object.assign(Bi,{getNormal:function(t,n,e,i){i===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new oe),i.subVectors(e,n),us.subVectors(t,n),i.cross(us);var s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)},getBarycoord:function(t,n,e,i,s){us.subVectors(i,n),da.subVectors(e,n),oy.subVectors(t,n);var a=us.dot(us),o=us.dot(da),r=us.dot(oy),u=da.dot(da),l=da.dot(oy),h=a*u-o*o;if(s===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new oe),h===0)return s.set(-2,-1,-1);var f=1/h,d=(u*r-o*l)*f,p=(a*l-o*r)*f;return s.set(1-d-p,p,d)},containsPoint:function(t,n,e,i){return Bi.getBarycoord(t,n,e,i,fa),fa.x>=0&&fa.y>=0&&fa.x+fa.y<=1},getUV:function(t,n,e,i,s,a,o,r){return this.getBarycoord(t,n,e,i,fa),r.set(0,0),r.addScaledVector(s,fa.x),r.addScaledVector(a,fa.y),r.addScaledVector(o,fa.z),r},isFrontFacing:function(t,n,e,i){return us.subVectors(e,n),da.subVectors(t,n),us.cross(da).dot(i)<0}}),Object.assign(Bi.prototype,{set:function(t,n,e){return this.a.copy(t),this.b.copy(n),this.c.copy(e),this},setFromPointsAndIndices:function(t,n,e,i){return this.a.copy(t[n]),this.b.copy(t[e]),this.c.copy(t[i]),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return us.subVectors(this.c,this.b),da.subVectors(this.a,this.b),us.cross(da).length()*.5},getMidpoint:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new oe),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Bi.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ps),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,n){return Bi.getBarycoord(t,this.a,this.b,this.c,n)},getUV:function(t,n,e,i,s){return Bi.getUV(t,this.a,this.b,this.c,n,e,i,s)},containsPoint:function(t){return Bi.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Bi.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new oe);var e=this.a,i=this.b,s=this.c,a,o;du.subVectors(i,e),fu.subVectors(s,e),sy.subVectors(t,e);var r=du.dot(sy),u=fu.dot(sy);if(r<=0&&u<=0)return n.copy(e);ay.subVectors(t,i);var l=du.dot(ay),h=fu.dot(ay);if(l>=0&&h<=l)return n.copy(i);var f=r*h-l*u;if(f<=0&&r>=0&&l<=0)return a=r/(r-l),n.copy(e).addScaledVector(du,a);ly.subVectors(t,s);var d=du.dot(ly),p=fu.dot(ly);if(p>=0&&d<=p)return n.copy(s);var b=d*u-r*p;if(b<=0&&u>=0&&p<=0)return o=u/(u-p),n.copy(e).addScaledVector(fu,o);var v=l*p-d*h;if(v<=0&&h-l>=0&&d-p>=0)return K_.subVectors(s,i),o=(h-l)/(h-l+(d-p)),n.copy(i).addScaledVector(K_,o);var x=1/(v+b+f);return a=b*x,o=f*x,n.copy(e).addScaledVector(du,a).addScaledVector(fu,o)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var Z_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hs={h:0,s:0,l:0},hm={h:0,s:0,l:0};function Dn(t,n,e){return n===void 0&&e===void 0?this.set(t):this.setRGB(t,n,e)}function cy(t,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+(n-t)*6*e:e<1/2?n:e<2/3?t+(n-t)*6*(2/3-e):t}function uy(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function hy(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}Object.assign(Dn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},setRGB:function(t,n,e){return this.r=t,this.g=n,this.b=e,this},setHSL:function(t,n,e){if(t=pr.euclideanModulo(t,1),n=pr.clamp(n,0,1),e=pr.clamp(e,0,1),n===0)this.r=this.g=this.b=e;else{var i=e<=.5?e*(1+n):e+n-e*n,s=2*e-i;this.r=cy(s,i,t+1/3),this.g=cy(s,i,t),this.b=cy(s,i,t-1/3)}return this},setStyle:function(t){function n(f){f!==void 0&&parseFloat(f)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var e;if(e=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,s=e[1],a=e[2];switch(s){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,n(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,n(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(i[1])/360,r=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return n(i[5]),this.setHSL(o,r,u)}break}}else if(e=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=e[1],h=l.length;if(h===3)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(h===6)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var n=Z_[t];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,n){return n===void 0&&(n=2),this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},copyLinearToGamma:function(t,n){n===void 0&&(n=2);var e=n>0?1/n:1;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=uy(t.r),this.g=uy(t.g),this.b=uy(t.b),this},copyLinearToSRGB:function(t){return this.r=hy(t.r),this.g=hy(t.g),this.b=hy(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var n=this.r,e=this.g,i=this.b,s=Math.max(n,e,i),a=Math.min(n,e,i),o,r,u=(a+s)/2;if(a===s)o=0,r=0;else{var l=s-a;switch(r=u<=.5?l/(s+a):l/(2-s-a),s){case n:o=(e-i)/l+(e<i?6:0);break;case e:o=(i-n)/l+2;break;case i:o=(n-e)/l+4;break}o/=6}return t.h=o,t.s=r,t.l=u,t},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(t,n,e){return this.getHSL(hs),hs.h+=t,hs.s+=n,hs.l+=e,this.setHSL(hs.h,hs.s,hs.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this},lerpHSL:function(t,n){this.getHSL(hs),t.getHSL(hm);var e=pr.lerp(hs.h,hm.h,n),i=pr.lerp(hs.s,hm.s,n),s=pr.lerp(hs.l,hm.l,n);return this.setHSL(e,i,s),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,n){return n===void 0&&(n=0),this.r=t[n],this.g=t[n+1],this.b=t[n+2],this},toArray:function(t,n){return t===void 0&&(t=[]),n===void 0&&(n=0),t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t},toJSON:function(){return this.getHex()}}),Dn.NAMES=Z_;function dm(t,n,e,i,s,a){this.a=t,this.b=n,this.c=e,this.normal=i&&i.isVector3?i:new oe,this.vertexNormals=Array.isArray(i)?i:[],this.color=s&&s.isColor?s:new Dn,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=a!==void 0?a:0}Object.assign(dm.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var n=0,e=t.vertexNormals.length;n<e;n++)this.vertexNormals[n]=t.vertexNormals[n].clone();for(var n=0,e=t.vertexColors.length;n<e;n++)this.vertexColors[n]=t.vertexColors[n].clone();return this}});var XC=0;function er(){Object.defineProperty(this,"id",{value:XC++}),this.uuid=pr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=od,this.side=Zc,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=g_,this.opacity=1,this.transparent=!1,this.blendSrc=w_,this.blendDst=M_,this.blendEquation=$c,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=V1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=BC,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=$1,this.stencilZFail=$1,this.stencilZPass=$1,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}er.prototype=Object.assign(Object.create(sa.prototype),{constructor:er,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(t!==void 0)for(var n in t){var e=t[n];if(e===void 0){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if(n==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===m_;continue}var i=this[n];if(i===void 0){console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.");continue}i&&i.isColor?i.set(e):i&&i.isVector3&&e&&e.isVector3?i.copy(e):this[n]=e}},toJSON:function(t){var n=t===void 0||typeof t=="string";n&&(t={textures:{},images:{}});var e={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.color&&this.color.isColor&&(e.color=this.color.getHex()),this.roughness!==void 0&&(e.roughness=this.roughness),this.metalness!==void 0&&(e.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(e.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(e.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(e.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(e.specular=this.specular.getHex()),this.shininess!==void 0&&(e.shininess=this.shininess),this.clearcoat!==void 0&&(e.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(e.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(e.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,e.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(e.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(e.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(e.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(e.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(e.aoMap=this.aoMap.toJSON(t).uuid,e.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(e.bumpMap=this.bumpMap.toJSON(t).uuid,e.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(e.normalMap=this.normalMap.toJSON(t).uuid,e.normalMapType=this.normalMapType,e.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(e.displacementMap=this.displacementMap.toJSON(t).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(e.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(e.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(e.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(e.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(e.envMap=this.envMap.toJSON(t).uuid,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,this.combine!==void 0&&(e.combine=this.combine),this.envMapIntensity!==void 0&&(e.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(e.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(e.size=this.size),this.sizeAttenuation!==void 0&&(e.sizeAttenuation=this.sizeAttenuation),this.blending!==od&&(e.blending=this.blending),this.flatShading===!0&&(e.flatShading=this.flatShading),this.side!==Zc&&(e.side=this.side),this.vertexColors!==g_&&(e.vertexColors=this.vertexColors),this.opacity<1&&(e.opacity=this.opacity),this.transparent===!0&&(e.transparent=this.transparent),e.depthFunc=this.depthFunc,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.stencilWrite=this.stencilWrite,e.stencilWriteMask=this.stencilWriteMask,e.stencilFunc=this.stencilFunc,e.stencilRef=this.stencilRef,e.stencilFuncMask=this.stencilFuncMask,e.stencilFail=this.stencilFail,e.stencilZFail=this.stencilZFail,e.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(e.rotation=this.rotation),this.polygonOffset===!0&&(e.polygonOffset=!0),this.polygonOffsetFactor!==0&&(e.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(e.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(e.linewidth=this.linewidth),this.dashSize!==void 0&&(e.dashSize=this.dashSize),this.gapSize!==void 0&&(e.gapSize=this.gapSize),this.scale!==void 0&&(e.scale=this.scale),this.dithering===!0&&(e.dithering=!0),this.alphaTest>0&&(e.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(e.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(e.wireframe=this.wireframe),this.wireframeLinewidth>1&&(e.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(e.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(e.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(e.morphTargets=!0),this.morphNormals===!0&&(e.morphNormals=!0),this.skinning===!0&&(e.skinning=!0),this.visible===!1&&(e.visible=!1),this.toneMapped===!1&&(e.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(e.userData=this.userData);function i(o){var r=[];for(var u in o){var l=o[u];delete l.metadata,r.push(l)}return r}if(n){var s=i(t.textures),a=i(t.images);s.length>0&&(e.textures=s),a.length>0&&(e.images=a)}return e},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var n=t.clippingPlanes,e=null;if(n!==null){var i=n.length;e=new Array(i);for(var s=0;s!==i;++s)e[s]=n[s].clone()}return this.clippingPlanes=e,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(er.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function Fi(t){er.call(this),this.type="MeshBasicMaterial",this.color=new Dn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Fi.prototype=Object.create(er.prototype),Fi.prototype.constructor=Fi,Fi.prototype.isMeshBasicMaterial=!0,Fi.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Ir=new oe;function nr(t,n,e){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=n,this.count=t!==void 0?t.length/n:0,this.normalized=e===!0,this.usage=rm,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(nr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(nr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,n,e){t*=this.itemSize,e*=n.itemSize;for(var i=0,s=this.itemSize;i<s;i++)this.array[t+i]=n.array[e+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var n=this.array,e=0,i=0,s=t.length;i<s;i++){var a=t[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new Dn),n[e++]=a.r,n[e++]=a.g,n[e++]=a.b}return this},copyVector2sArray:function(t){for(var n=this.array,e=0,i=0,s=t.length;i<s;i++){var a=t[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new on),n[e++]=a.x,n[e++]=a.y}return this},copyVector3sArray:function(t){for(var n=this.array,e=0,i=0,s=t.length;i<s;i++){var a=t[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new oe),n[e++]=a.x,n[e++]=a.y,n[e++]=a.z}return this},copyVector4sArray:function(t){for(var n=this.array,e=0,i=0,s=t.length;i<s;i++){var a=t[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new Or),n[e++]=a.x,n[e++]=a.y,n[e++]=a.z,n[e++]=a.w}return this},applyMatrix3:function(t){for(var n=0,e=this.count;n<e;n++)Ir.x=this.getX(n),Ir.y=this.getY(n),Ir.z=this.getZ(n),Ir.applyMatrix3(t),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this},applyMatrix4:function(t){for(var n=0,e=this.count;n<e;n++)Ir.x=this.getX(n),Ir.y=this.getY(n),Ir.z=this.getZ(n),Ir.applyMatrix4(t),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this},applyNormalMatrix:function(t){for(var n=0,e=this.count;n<e;n++)Ir.x=this.getX(n),Ir.y=this.getY(n),Ir.z=this.getZ(n),Ir.applyNormalMatrix(t),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this},transformDirection:function(t){for(var n=0,e=this.count;n<e;n++)Ir.x=this.getX(n),Ir.y=this.getY(n),Ir.z=this.getZ(n),Ir.transformDirection(t),this.setXYZ(n,Ir.x,Ir.y,Ir.z);return this},set:function(t,n){return n===void 0&&(n=0),this.array.set(t,n),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,n){return this.array[t*this.itemSize]=n,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,n){return this.array[t*this.itemSize+1]=n,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,n){return this.array[t*this.itemSize+2]=n,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,n){return this.array[t*this.itemSize+3]=n,this},setXY:function(t,n,e){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=e,this},setXYZ:function(t,n,e,i){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=e,this.array[t+2]=i,this},setXYZW:function(t,n,e,i,s){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=e,this.array[t+2]=i,this.array[t+3]=s,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function dy(t,n,e){nr.call(this,new Int8Array(t),n,e)}dy.prototype=Object.create(nr.prototype),dy.prototype.constructor=dy;function fy(t,n,e){nr.call(this,new Uint8Array(t),n,e)}fy.prototype=Object.create(nr.prototype),fy.prototype.constructor=fy;function py(t,n,e){nr.call(this,new Uint8ClampedArray(t),n,e)}py.prototype=Object.create(nr.prototype),py.prototype.constructor=py;function my(t,n,e){nr.call(this,new Int16Array(t),n,e)}my.prototype=Object.create(nr.prototype),my.prototype.constructor=my;function yd(t,n,e){nr.call(this,new Uint16Array(t),n,e)}yd.prototype=Object.create(nr.prototype),yd.prototype.constructor=yd;function gy(t,n,e){nr.call(this,new Int32Array(t),n,e)}gy.prototype=Object.create(nr.prototype),gy.prototype.constructor=gy;function bd(t,n,e){nr.call(this,new Uint32Array(t),n,e)}bd.prototype=Object.create(nr.prototype),bd.prototype.constructor=bd;function Ln(t,n,e){nr.call(this,new Float32Array(t),n,e)}Ln.prototype=Object.create(nr.prototype),Ln.prototype.constructor=Ln;function yy(t,n,e){nr.call(this,new Float64Array(t),n,e)}yy.prototype=Object.create(nr.prototype),yy.prototype.constructor=yy;function J_(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(J_.prototype,{computeGroups:function(t){for(var n,e=[],i=void 0,s=t.faces,a=0;a<s.length;a++){var o=s[a];o.materialIndex!==i&&(i=o.materialIndex,n!==void 0&&(n.count=a*3-n.start,e.push(n)),n={start:a*3,materialIndex:i})}n!==void 0&&(n.count=a*3-n.start,e.push(n)),this.groups=e},fromGeometry:function(t){var n=t.faces,e=t.vertices,i=t.faceVertexUvs,s=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,o=t.morphTargets,r=o.length,u;if(r>0){u=[];for(var l=0;l<r;l++)u[l]={name:o[l].name,data:[]};this.morphTargets.position=u}var h=t.morphNormals,f=h.length,d;if(f>0){d=[];for(var l=0;l<f;l++)d[l]={name:h[l].name,data:[]};this.morphTargets.normal=d}var p=t.skinIndices,b=t.skinWeights,v=p.length===e.length,x=b.length===e.length;e.length>0&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var l=0;l<n.length;l++){var w=n[l];this.vertices.push(e[w.a],e[w.b],e[w.c]);var M=w.vertexNormals;if(M.length===3)this.normals.push(M[0],M[1],M[2]);else{var E=w.normal;this.normals.push(E,E,E)}var D=w.vertexColors;if(D.length===3)this.colors.push(D[0],D[1],D[2]);else{var N=w.color;this.colors.push(N,N,N)}if(s===!0){var V=i[0][l];V!==void 0?this.uvs.push(V[0],V[1],V[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new on,new on,new on))}if(a===!0){var V=i[1][l];V!==void 0?this.uvs2.push(V[0],V[1],V[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new on,new on,new on))}for(var K=0;K<r;K++){var j=o[K].vertices;u[K].data.push(j[w.a],j[w.b],j[w.c])}for(var K=0;K<f;K++){var Z=h[K].vertexNormals[l];d[K].data.push(Z.a,Z.b,Z.c)}v&&this.skinIndices.push(p[w.a],p[w.b],p[w.c]),x&&this.skinWeights.push(b[w.a],b[w.b],b[w.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}});function $_(t){if(t.length===0)return-1/0;for(var n=t[0],e=1,i=t.length;e<i;++e)t[e]>n&&(n=t[e]);return n}var YC=1,Ds=new mr,by=new Rn,pu=new oe,Oo=new cs,vd=new cs,mi=new oe;function Un(){Object.defineProperty(this,"id",{value:YC+=2}),this.uuid=pr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Un.prototype=Object.assign(Object.create(sa.prototype),{constructor:Un,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new($_(t)>65535?bd:yd)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,n){return this.attributes[t]=n,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,n,e){this.groups.push({start:t,count:n,materialIndex:e!==void 0?e:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,n){this.drawRange.start=t,this.drawRange.count=n},applyMatrix4:function(t){var n=this.attributes.position;n!==void 0&&(n.applyMatrix4(t),n.needsUpdate=!0);var e=this.attributes.normal;if(e!==void 0){var i=new Vi().getNormalMatrix(t);e.applyNormalMatrix(i),e.needsUpdate=!0}var s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(t),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return Ds.makeRotationX(t),this.applyMatrix4(Ds),this},rotateY:function(t){return Ds.makeRotationY(t),this.applyMatrix4(Ds),this},rotateZ:function(t){return Ds.makeRotationZ(t),this.applyMatrix4(Ds),this},translate:function(t,n,e){return Ds.makeTranslation(t,n,e),this.applyMatrix4(Ds),this},scale:function(t,n,e){return Ds.makeScale(t,n,e),this.applyMatrix4(Ds),this},lookAt:function(t){return by.lookAt(t),by.updateMatrix(),this.applyMatrix4(by.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(pu).negate(),this.translate(pu.x,pu.y,pu.z),this},setFromObject:function(t){var n=t.geometry;if(t.isPoints||t.isLine){var e=new Ln(n.vertices.length*3,3),i=new Ln(n.colors.length*3,3);if(this.setAttribute("position",e.copyVector3sArray(n.vertices)),this.setAttribute("color",i.copyColorsArray(n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){var s=new Ln(n.lineDistances.length,1);this.setAttribute("lineDistance",s.copyArray(n.lineDistances))}n.boundingSphere!==null&&(this.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(this.boundingBox=n.boundingBox.clone())}else t.isMesh&&n&&n.isGeometry&&this.fromGeometry(n);return this},setFromPoints:function(t){for(var n=[],e=0,i=t.length;e<i;e++){var s=t[e];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ln(n,3)),this},updateFromObject:function(t){var n=t.geometry;if(t.isMesh){var e=n.__directGeometry;if(n.elementsNeedUpdate===!0&&(e=void 0,n.elementsNeedUpdate=!1),e===void 0)return this.fromGeometry(n);e.verticesNeedUpdate=n.verticesNeedUpdate,e.normalsNeedUpdate=n.normalsNeedUpdate,e.colorsNeedUpdate=n.colorsNeedUpdate,e.uvsNeedUpdate=n.uvsNeedUpdate,e.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=e}var i;return n.verticesNeedUpdate===!0&&(i=this.attributes.position,i!==void 0&&(i.copyVector3sArray(n.vertices),i.needsUpdate=!0),n.verticesNeedUpdate=!1),n.normalsNeedUpdate===!0&&(i=this.attributes.normal,i!==void 0&&(i.copyVector3sArray(n.normals),i.needsUpdate=!0),n.normalsNeedUpdate=!1),n.colorsNeedUpdate===!0&&(i=this.attributes.color,i!==void 0&&(i.copyColorsArray(n.colors),i.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(i=this.attributes.uv,i!==void 0&&(i.copyVector2sArray(n.uvs),i.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,i!==void 0&&(i.copyArray(n.lineDistances),i.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=new J_().fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var n=new Float32Array(t.vertices.length*3);if(this.setAttribute("position",new nr(n,3).copyVector3sArray(t.vertices)),t.normals.length>0){var e=new Float32Array(t.normals.length*3);this.setAttribute("normal",new nr(e,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var i=new Float32Array(t.colors.length*3);this.setAttribute("color",new nr(i,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var s=new Float32Array(t.uvs.length*2);this.setAttribute("uv",new nr(s,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(t.uvs2.length*2);this.setAttribute("uv2",new nr(a,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(var o in t.morphTargets){for(var r=[],u=t.morphTargets[o],l=0,h=u.length;l<h;l++){var f=u[l],d=new Ln(f.data.length*3,3);d.name=f.name,r.push(d.copyVector3sArray(f.data))}this.morphAttributes[o]=r}if(t.skinIndices.length>0){var p=new Ln(t.skinIndices.length*4,4);this.setAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var b=new Ln(t.skinWeights.length*4,4);this.setAttribute("skinWeight",b.copyVector4sArray(t.skinWeights))}return t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new cs);var t=this.attributes.position,n=this.morphAttributes.position;if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),n)for(var e=0,i=n.length;e<i;e++){var s=n[e];Oo.setFromBufferAttribute(s),this.morphTargetsRelative?(mi.addVectors(this.boundingBox.min,Oo.min),this.boundingBox.expandByPoint(mi),mi.addVectors(this.boundingBox.max,Oo.max),this.boundingBox.expandByPoint(mi)):(this.boundingBox.expandByPoint(Oo.min),this.boundingBox.expandByPoint(Oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ua);var t=this.attributes.position,n=this.morphAttributes.position;if(t){var e=this.boundingSphere.center;if(Oo.setFromBufferAttribute(t),n)for(var i=0,s=n.length;i<s;i++){var a=n[i];vd.setFromBufferAttribute(a),this.morphTargetsRelative?(mi.addVectors(Oo.min,vd.min),Oo.expandByPoint(mi),mi.addVectors(Oo.max,vd.max),Oo.expandByPoint(mi)):(Oo.expandByPoint(vd.min),Oo.expandByPoint(vd.max))}Oo.getCenter(e);for(var o=0,i=0,s=t.count;i<s;i++)mi.fromBufferAttribute(t,i),o=Math.max(o,e.distanceToSquared(mi));if(n)for(var i=0,s=n.length;i<s;i++)for(var a=n[i],r=this.morphTargetsRelative,u=0,l=a.count;u<l;u++)mi.fromBufferAttribute(a,u),r&&(pu.fromBufferAttribute(t,u),mi.add(pu)),o=Math.max(o,e.distanceToSquared(mi));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,n=this.attributes;if(n.position){var e=n.position.array;if(n.normal===void 0)this.setAttribute("normal",new nr(new Float32Array(e.length),3));else for(var i=n.normal.array,s=0,a=i.length;s<a;s++)i[s]=0;var o=n.normal.array,r,u,l,h=new oe,f=new oe,d=new oe,p=new oe,b=new oe;if(t)for(var v=t.array,s=0,a=t.count;s<a;s+=3)r=v[s+0]*3,u=v[s+1]*3,l=v[s+2]*3,h.fromArray(e,r),f.fromArray(e,u),d.fromArray(e,l),p.subVectors(d,f),b.subVectors(h,f),p.cross(b),o[r]+=p.x,o[r+1]+=p.y,o[r+2]+=p.z,o[u]+=p.x,o[u+1]+=p.y,o[u+2]+=p.z,o[l]+=p.x,o[l+1]+=p.y,o[l+2]+=p.z;else for(var s=0,a=e.length;s<a;s+=9)h.fromArray(e,s),f.fromArray(e,s+3),d.fromArray(e,s+6),p.subVectors(d,f),b.subVectors(h,f),p.cross(b),o[s]=p.x,o[s+1]=p.y,o[s+2]=p.z,o[s+3]=p.x,o[s+4]=p.y,o[s+5]=p.z,o[s+6]=p.x,o[s+7]=p.y,o[s+8]=p.z;this.normalizeNormals(),n.normal.needsUpdate=!0}},merge:function(t,n){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}n===void 0&&(n=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var e=this.attributes;for(var i in e)if(t.attributes[i]!==void 0)for(var s=e[i],a=s.array,o=t.attributes[i],r=o.array,u=o.itemSize*n,l=Math.min(r.length,a.length-u),h=0,f=u;h<l;h++,f++)a[f]=r[h];return this},normalizeNormals:function(){for(var t=this.attributes.normal,n=0,e=t.count;n<e;n++)mi.x=t.getX(n),mi.y=t.getY(n),mi.z=t.getZ(n),mi.normalize(),t.setXYZ(n,mi.x,mi.y,mi.z)},toNonIndexed:function(){function t(v,x){for(var w=v.array,M=v.itemSize,E=new w.constructor(x.length*M),D=0,N=0,V=0,K=x.length;V<K;V++){D=x[V]*M;for(var j=0;j<M;j++)E[N++]=w[D++]}return new nr(E,M)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var n=new Un,e=this.index.array,i=this.attributes;for(var s in i){var a=i[s],o=t(a,e);n.setAttribute(s,o)}var r=this.morphAttributes;for(s in r){for(var u=[],l=r[s],h=0,f=l.length;h<f;h++){var a=l[h],o=t(a,e);u.push(o)}n.morphAttributes[s]=u}n.morphTargetsRelative=this.morphTargetsRelative;for(var d=this.groups,h=0,p=d.length;h<p;h++){var b=d[h];n.addGroup(b.start,b.count,b.materialIndex)}return n},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){var n=this.parameters;for(var e in n)n[e]!==void 0&&(t[e]=n[e]);return t}t.data={attributes:{}};var i=this.index;i!==null&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var s=this.attributes;for(var e in s){var a=s[e],o=a.toJSON();a.name!==""&&(o.name=a.name),t.data.attributes[e]=o}var r={},u=!1;for(var e in this.morphAttributes){for(var l=this.morphAttributes[e],h=[],f=0,d=l.length;f<d;f++){var a=l[f],o=a.toJSON();a.name!==""&&(o.name=a.name),h.push(o)}h.length>0&&(r[e]=h,u=!0)}u&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);var p=this.groups;p.length>0&&(t.data.groups=JSON.parse(JSON.stringify(p)));var b=this.boundingSphere;return b!==null&&(t.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),t},clone:function(){return new Un().copy(this)},copy:function(t){var n,e,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.index;s!==null&&this.setIndex(s.clone());var a=t.attributes;for(n in a){var o=a[n];this.setAttribute(n,o.clone())}var r=t.morphAttributes;for(n in r){var u=[],l=r[n];for(e=0,i=l.length;e<i;e++)u.push(l[e].clone());this.morphAttributes[n]=u}this.morphTargetsRelative=t.morphTargetsRelative;var h=t.groups;for(e=0,i=h.length;e<i;e++){var f=h[e];this.addGroup(f.start,f.count,f.materialIndex)}var d=t.boundingBox;d!==null&&(this.boundingBox=d.clone());var p=t.boundingSphere;return p!==null&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Q_=new mr,Gl=new hu,vy=new ua,Hl=new oe,Wl=new oe,ql=new oe,xy=new oe,_y=new oe,wy=new oe,fm=new oe,pm=new oe,mm=new oe,mu=new on,gu=new on,yu=new on,xd=new oe,gm=new oe;function $r(t,n){Rn.call(this),this.type="Mesh",this.geometry=t!==void 0?t:new Un,this.material=n!==void 0?n:new Fi,this.updateMorphTargets()}$r.prototype=Object.assign(Object.create(Rn.prototype),{constructor:$r,isMesh:!0,copy:function(t){return Rn.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry,n,e,i;if(t.isBufferGeometry){var s=t.morphAttributes,a=Object.keys(s);if(a.length>0){var o=s[a[0]];if(o!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},n=0,e=o.length;n<e;n++)i=o[n].name||String(n),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=n}}else{var r=t.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,n){var e=this.geometry,i=this.material,s=this.matrixWorld;if(i!==void 0&&(e.boundingSphere===null&&e.computeBoundingSphere(),vy.copy(e.boundingSphere),vy.applyMatrix4(s),t.ray.intersectsSphere(vy)!==!1&&(Q_.getInverse(s),Gl.copy(t.ray).applyMatrix4(Q_),!(e.boundingBox!==null&&Gl.intersectsBox(e.boundingBox)===!1)))){var a;if(e.isBufferGeometry){var o,r,u,l=e.index,h=e.attributes.position,f=e.morphAttributes.position,d=e.morphTargetsRelative,p=e.attributes.uv,b=e.attributes.uv2,v=e.groups,x=e.drawRange,w,M,E,D,N,V,K,j;if(l!==null)if(Array.isArray(i))for(w=0,E=v.length;w<E;w++)for(N=v[w],V=i[N.materialIndex],K=Math.max(N.start,x.start),j=Math.min(N.start+N.count,x.start+x.count),M=K,D=j;M<D;M+=3)o=l.getX(M),r=l.getX(M+1),u=l.getX(M+2),a=ym(this,V,t,Gl,h,f,d,p,b,o,r,u),a&&(a.faceIndex=Math.floor(M/3),a.face.materialIndex=N.materialIndex,n.push(a));else for(K=Math.max(0,x.start),j=Math.min(l.count,x.start+x.count),w=K,E=j;w<E;w+=3)o=l.getX(w),r=l.getX(w+1),u=l.getX(w+2),a=ym(this,i,t,Gl,h,f,d,p,b,o,r,u),a&&(a.faceIndex=Math.floor(w/3),n.push(a));else if(h!==void 0)if(Array.isArray(i))for(w=0,E=v.length;w<E;w++)for(N=v[w],V=i[N.materialIndex],K=Math.max(N.start,x.start),j=Math.min(N.start+N.count,x.start+x.count),M=K,D=j;M<D;M+=3)o=M,r=M+1,u=M+2,a=ym(this,V,t,Gl,h,f,d,p,b,o,r,u),a&&(a.faceIndex=Math.floor(M/3),a.face.materialIndex=N.materialIndex,n.push(a));else for(K=Math.max(0,x.start),j=Math.min(h.count,x.start+x.count),w=K,E=j;w<E;w+=3)o=w,r=w+1,u=w+2,a=ym(this,i,t,Gl,h,f,d,p,b,o,r,u),a&&(a.faceIndex=Math.floor(w/3),n.push(a))}else if(e.isGeometry){var Z,tt,rt,J=Array.isArray(i),U=e.vertices,G=e.faces,I,C=e.faceVertexUvs[0];C.length>0&&(I=C);for(var L=0,B=G.length;L<B;L++){var O=G[L],q=J?i[O.materialIndex]:i;if(q!==void 0&&(Z=U[O.a],tt=U[O.b],rt=U[O.c],a=t2(this,q,t,Gl,Z,tt,rt,xd),a)){if(I&&I[L]){var it=I[L];mu.copy(it[0]),gu.copy(it[1]),yu.copy(it[2]),a.uv=Bi.getUV(xd,Z,tt,rt,mu,gu,yu,new on)}a.face=O,a.faceIndex=L,n.push(a)}}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function t2(t,n,e,i,s,a,o,r){var u;if(n.side===Si?u=i.intersectTriangle(o,a,s,!0,r):u=i.intersectTriangle(s,a,o,n.side!==id,r),u===null)return null;gm.copy(r),gm.applyMatrix4(t.matrixWorld);var l=e.ray.origin.distanceTo(gm);return l<e.near||l>e.far?null:{distance:l,point:gm.clone(),object:t}}function ym(t,n,e,i,s,a,o,r,u,l,h,f){Hl.fromBufferAttribute(s,l),Wl.fromBufferAttribute(s,h),ql.fromBufferAttribute(s,f);var d=t.morphTargetInfluences;if(n.morphTargets&&a&&d){fm.set(0,0,0),pm.set(0,0,0),mm.set(0,0,0);for(var p=0,b=a.length;p<b;p++){var v=d[p],x=a[p];v!==0&&(xy.fromBufferAttribute(x,l),_y.fromBufferAttribute(x,h),wy.fromBufferAttribute(x,f),o?(fm.addScaledVector(xy,v),pm.addScaledVector(_y,v),mm.addScaledVector(wy,v)):(fm.addScaledVector(xy.sub(Hl),v),pm.addScaledVector(_y.sub(Wl),v),mm.addScaledVector(wy.sub(ql),v)))}Hl.add(fm),Wl.add(pm),ql.add(mm)}var w=t2(t,n,e,i,Hl,Wl,ql,xd);if(w){r&&(mu.fromBufferAttribute(r,l),gu.fromBufferAttribute(r,h),yu.fromBufferAttribute(r,f),w.uv=Bi.getUV(xd,Hl,Wl,ql,mu,gu,yu,new on)),u&&(mu.fromBufferAttribute(u,l),gu.fromBufferAttribute(u,h),yu.fromBufferAttribute(u,f),w.uv2=Bi.getUV(xd,Hl,Wl,ql,mu,gu,yu,new on));var M=new dm(l,h,f);Bi.getNormal(Hl,Wl,ql,M.normal),w.face=M}return w}var KC=0,Rs=new mr,My=new Rn,bm=new oe;function sr(){Object.defineProperty(this,"id",{value:KC+=2}),this.uuid=pr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}sr.prototype=Object.assign(Object.create(sa.prototype),{constructor:sr,isGeometry:!0,applyMatrix4:function(t){for(var n=new Vi().getNormalMatrix(t),e=0,i=this.vertices.length;e<i;e++){var s=this.vertices[e];s.applyMatrix4(t)}for(var e=0,i=this.faces.length;e<i;e++){var a=this.faces[e];a.normal.applyMatrix3(n).normalize();for(var o=0,r=a.vertexNormals.length;o<r;o++)a.vertexNormals[o].applyMatrix3(n).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return Rs.makeRotationX(t),this.applyMatrix4(Rs),this},rotateY:function(t){return Rs.makeRotationY(t),this.applyMatrix4(Rs),this},rotateZ:function(t){return Rs.makeRotationZ(t),this.applyMatrix4(Rs),this},translate:function(t,n,e){return Rs.makeTranslation(t,n,e),this.applyMatrix4(Rs),this},scale:function(t,n,e){return Rs.makeScale(t,n,e),this.applyMatrix4(Rs),this},lookAt:function(t){return My.lookAt(t),My.updateMatrix(),this.applyMatrix4(My.matrix),this},fromBufferGeometry:function(t){var n=this,e=t.index!==null?t.index.array:void 0,i=t.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var s=i.position.array,a=i.normal!==void 0?i.normal.array:void 0,o=i.color!==void 0?i.color.array:void 0,r=i.uv!==void 0?i.uv.array:void 0,u=i.uv2!==void 0?i.uv2.array:void 0;u!==void 0&&(this.faceVertexUvs[1]=[]);for(var l=0;l<s.length;l+=3)n.vertices.push(new oe().fromArray(s,l)),o!==void 0&&n.colors.push(new Dn().fromArray(o,l));function h(w,M,E,D){var N=o===void 0?[]:[n.colors[w].clone(),n.colors[M].clone(),n.colors[E].clone()],V=a===void 0?[]:[new oe().fromArray(a,w*3),new oe().fromArray(a,M*3),new oe().fromArray(a,E*3)],K=new dm(w,M,E,V,N,D);n.faces.push(K),r!==void 0&&n.faceVertexUvs[0].push([new on().fromArray(r,w*2),new on().fromArray(r,M*2),new on().fromArray(r,E*2)]),u!==void 0&&n.faceVertexUvs[1].push([new on().fromArray(u,w*2),new on().fromArray(u,M*2),new on().fromArray(u,E*2)])}var f=t.groups;if(f.length>0)for(var l=0;l<f.length;l++)for(var d=f[l],p=d.start,b=d.count,v=p,x=p+b;v<x;v+=3)e!==void 0?h(e[v],e[v+1],e[v+2],d.materialIndex):h(v,v+1,v+2,d.materialIndex);else if(e!==void 0)for(var l=0;l<e.length;l+=3)h(e[l],e[l+1],e[l+2]);else for(var l=0;l<s.length/3;l+=3)h(l,l+1,l+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(bm).negate(),this.translate(bm.x,bm.y,bm.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,n=this.boundingSphere.radius,e=n===0?1:1/n,i=new mr;return i.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var t=new oe,n=new oe,e=0,i=this.faces.length;e<i;e++){var s=this.faces[e],a=this.vertices[s.a],o=this.vertices[s.b],r=this.vertices[s.c];t.subVectors(r,o),n.subVectors(a,o),t.cross(n),t.normalize(),s.normal.copy(t)}},computeVertexNormals:function(t){t===void 0&&(t=!0);var n,e,i,s,a,o;for(o=new Array(this.vertices.length),n=0,e=this.vertices.length;n<e;n++)o[n]=new oe;if(t){var r,u,l,h=new oe,f=new oe;for(i=0,s=this.faces.length;i<s;i++)a=this.faces[i],r=this.vertices[a.a],u=this.vertices[a.b],l=this.vertices[a.c],h.subVectors(l,u),f.subVectors(r,u),h.cross(f),o[a.a].add(h),o[a.b].add(h),o[a.c].add(h)}else for(this.computeFaceNormals(),i=0,s=this.faces.length;i<s;i++)a=this.faces[i],o[a.a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(n=0,e=this.vertices.length;n<e;n++)o[n].normalize();for(i=0,s=this.faces.length;i<s;i++){a=this.faces[i];var d=a.vertexNormals;d.length===3?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,n,e;for(this.computeFaceNormals(),t=0,n=this.faces.length;t<n;t++){e=this.faces[t];var i=e.vertexNormals;i.length===3?(i[0].copy(e.normal),i[1].copy(e.normal),i[2].copy(e.normal)):(i[0]=e.normal.clone(),i[1]=e.normal.clone(),i[2]=e.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,n,e,i,s;for(e=0,i=this.faces.length;e<i;e++)for(s=this.faces[e],s.__originalFaceNormal?s.__originalFaceNormal.copy(s.normal):s.__originalFaceNormal=s.normal.clone(),s.__originalVertexNormals||(s.__originalVertexNormals=[]),t=0,n=s.vertexNormals.length;t<n;t++)s.__originalVertexNormals[t]?s.__originalVertexNormals[t].copy(s.vertexNormals[t]):s.__originalVertexNormals[t]=s.vertexNormals[t].clone();var a=new sr;for(a.faces=this.faces,t=0,n=this.morphTargets.length;t<n;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,r=this.morphNormals[t].vertexNormals,l,h;for(e=0,i=this.faces.length;e<i;e++)l=new oe,h={a:new oe,b:new oe,c:new oe},o.push(l),r.push(h)}var u=this.morphNormals[t];a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals();var l,h;for(e=0,i=this.faces.length;e<i;e++)s=this.faces[e],l=u.faceNormals[e],h=u.vertexNormals[e],l.copy(s.normal),h.a.copy(s.vertexNormals[0]),h.b.copy(s.vertexNormals[1]),h.c.copy(s.vertexNormals[2])}for(e=0,i=this.faces.length;e<i;e++)s=this.faces[e],s.normal=s.__originalFaceNormal,s.vertexNormals=s.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new cs),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ua),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,n,e){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}var i,s=this.vertices.length,a=this.vertices,o=t.vertices,r=this.faces,u=t.faces,l=this.colors,h=t.colors;e===void 0&&(e=0),n!==void 0&&(i=new Vi().getNormalMatrix(n));for(var f=0,d=o.length;f<d;f++){var p=o[f],b=p.clone();n!==void 0&&b.applyMatrix4(n),a.push(b)}for(var f=0,d=h.length;f<d;f++)l.push(h[f].clone());for(f=0,d=u.length;f<d;f++){var v=u[f],x,w,M,E=v.vertexNormals,D=v.vertexColors;x=new dm(v.a+s,v.b+s,v.c+s),x.normal.copy(v.normal),i!==void 0&&x.normal.applyMatrix3(i).normalize();for(var N=0,V=E.length;N<V;N++)w=E[N].clone(),i!==void 0&&w.applyMatrix3(i).normalize(),x.vertexNormals.push(w);x.color.copy(v.color);for(var N=0,V=D.length;N<V;N++)M=D[N],x.vertexColors.push(M.clone());x.materialIndex=v.materialIndex+e,r.push(x)}for(var f=0,d=t.faceVertexUvs.length;f<d;f++){var K=t.faceVertexUvs[f];this.faceVertexUvs[f]===void 0&&(this.faceVertexUvs[f]=[]);for(var N=0,V=K.length;N<V;N++){for(var j=K[N],Z=[],tt=0,rt=j.length;tt<rt;tt++)Z.push(j[tt].clone());this.faceVertexUvs[f].push(Z)}}},mergeMesh:function(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)},mergeVertices:function(){var t={},n=[],e=[],i,s,a=4,o=Math.pow(10,a),r,u,l,h,f,d;for(r=0,u=this.vertices.length;r<u;r++)i=this.vertices[r],s=Math.round(i.x*o)+"_"+Math.round(i.y*o)+"_"+Math.round(i.z*o),t[s]===void 0?(t[s]=r,n.push(this.vertices[r]),e[r]=n.length-1):e[r]=e[t[s]];var p=[];for(r=0,u=this.faces.length;r<u;r++){l=this.faces[r],l.a=e[l.a],l.b=e[l.b],l.c=e[l.c],h=[l.a,l.b,l.c];for(var b=0;b<3;b++)if(h[b]===h[(b+1)%3]){p.push(r);break}}for(r=p.length-1;r>=0;r--){var v=p[r];for(this.faces.splice(v,1),f=0,d=this.faceVertexUvs.length;f<d;f++)this.faceVertexUvs[f].splice(v,1)}var x=this.vertices.length-n.length;return this.vertices=n,x},setFromPoints:function(t){this.vertices=[];for(var n=0,e=t.length;n<e;n++){var i=t[n];this.vertices.push(new oe(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,n=t.length,e=0;e<n;e++)t[e]._id=e;function i(l,h){return l.materialIndex-h.materialIndex}t.sort(i);var s=this.faceVertexUvs[0],a=this.faceVertexUvs[1],o,r;s&&s.length===n&&(o=[]),a&&a.length===n&&(r=[]);for(var e=0;e<n;e++){var u=t[e]._id;o&&o.push(s[u]),r&&r.push(a[u])}o&&(this.faceVertexUvs[0]=o),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){var n=this.parameters;for(var e in n)n[e]!==void 0&&(t[e]=n[e]);return t}for(var i=[],s=0;s<this.vertices.length;s++){var a=this.vertices[s];i.push(a.x,a.y,a.z)}for(var o=[],r=[],u={},l=[],h={},f=[],d={},s=0;s<this.faces.length;s++){var p=this.faces[s],b=!0,v=!1,x=this.faceVertexUvs[0][s]!==void 0,w=p.normal.length()>0,M=p.vertexNormals.length>0,E=p.color.r!==1||p.color.g!==1||p.color.b!==1,D=p.vertexColors.length>0,N=0;if(N=Z(N,0,0),N=Z(N,1,b),N=Z(N,2,v),N=Z(N,3,x),N=Z(N,4,w),N=Z(N,5,M),N=Z(N,6,E),N=Z(N,7,D),o.push(N),o.push(p.a,p.b,p.c),o.push(p.materialIndex),x){var V=this.faceVertexUvs[0][s];o.push(J(V[0]),J(V[1]),J(V[2]))}if(w&&o.push(tt(p.normal)),M){var K=p.vertexNormals;o.push(tt(K[0]),tt(K[1]),tt(K[2]))}if(E&&o.push(rt(p.color)),D){var j=p.vertexColors;o.push(rt(j[0]),rt(j[1]),rt(j[2]))}}function Z(U,G,I){return I?U|1<<G:U&~(1<<G)}function tt(U){var G=U.x.toString()+U.y.toString()+U.z.toString();return u[G]!==void 0||(u[G]=r.length/3,r.push(U.x,U.y,U.z)),u[G]}function rt(U){var G=U.r.toString()+U.g.toString()+U.b.toString();return h[G]!==void 0||(h[G]=l.length,l.push(U.getHex())),h[G]}function J(U){var G=U.x.toString()+U.y.toString();return d[G]!==void 0||(d[G]=f.length/2,f.push(U.x,U.y)),d[G]}return t.data={},t.data.vertices=i,t.data.normals=r,l.length>0&&(t.data.colors=l),f.length>0&&(t.data.uvs=[f]),t.data.faces=o,t},clone:function(){return new sr().copy(this)},copy:function(t){var n,e,i,s,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.vertices;for(n=0,e=r.length;n<e;n++)this.vertices.push(r[n].clone());var u=t.colors;for(n=0,e=u.length;n<e;n++)this.colors.push(u[n].clone());var l=t.faces;for(n=0,e=l.length;n<e;n++)this.faces.push(l[n].clone());for(n=0,e=t.faceVertexUvs.length;n<e;n++){var h=t.faceVertexUvs[n];for(this.faceVertexUvs[n]===void 0&&(this.faceVertexUvs[n]=[]),i=0,s=h.length;i<s;i++){var f=h[i],d=[];for(a=0,o=f.length;a<o;a++){var p=f[a];d.push(p.clone())}this.faceVertexUvs[n].push(d)}}var b=t.morphTargets;for(n=0,e=b.length;n<e;n++){var v={};if(v.name=b[n].name,b[n].vertices!==void 0)for(v.vertices=[],i=0,s=b[n].vertices.length;i<s;i++)v.vertices.push(b[n].vertices[i].clone());if(b[n].normals!==void 0)for(v.normals=[],i=0,s=b[n].normals.length;i<s;i++)v.normals.push(b[n].normals[i].clone());this.morphTargets.push(v)}var x=t.morphNormals;for(n=0,e=x.length;n<e;n++){var w={};if(x[n].vertexNormals!==void 0)for(w.vertexNormals=[],i=0,s=x[n].vertexNormals.length;i<s;i++){var M=x[n].vertexNormals[i],E={};E.a=M.a.clone(),E.b=M.b.clone(),E.c=M.c.clone(),w.vertexNormals.push(E)}if(x[n].faceNormals!==void 0)for(w.faceNormals=[],i=0,s=x[n].faceNormals.length;i<s;i++)w.faceNormals.push(x[n].faceNormals[i].clone());this.morphNormals.push(w)}var D=t.skinWeights;for(n=0,e=D.length;n<e;n++)this.skinWeights.push(D[n].clone());var N=t.skinIndices;for(n=0,e=N.length;n<e;n++)this.skinIndices.push(N[n].clone());var V=t.lineDistances;for(n=0,e=V.length;n<e;n++)this.lineDistances.push(V[n]);var K=t.boundingBox;K!==null&&(this.boundingBox=K.clone());var j=t.boundingSphere;return j!==null&&(this.boundingSphere=j.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class ZC extends sr{constructor(n,e,i,s,a,o){super(),this.type="BoxGeometry",this.parameters={width:n,height:e,depth:i,widthSegments:s,heightSegments:a,depthSegments:o},this.fromBufferGeometry(new vm(n,e,i,s,a,o)),this.mergeVertices()}}class vm extends Un{constructor(n,e,i,s,a,o){super(),this.type="BoxBufferGeometry",this.parameters={width:n,height:e,depth:i,widthSegments:s,heightSegments:a,depthSegments:o};var r=this;n=n||1,e=e||1,i=i||1,s=Math.floor(s)||1,a=Math.floor(a)||1,o=Math.floor(o)||1;var u=[],l=[],h=[],f=[],d=0,p=0;b("z","y","x",-1,-1,i,e,n,o,a,0),b("z","y","x",1,-1,i,e,-n,o,a,1),b("x","z","y",1,1,n,i,e,s,o,2),b("x","z","y",1,-1,n,i,-e,s,o,3),b("x","y","z",1,-1,n,e,i,s,a,4),b("x","y","z",-1,-1,n,e,-i,s,a,5),this.setIndex(u),this.setAttribute("position",new Ln(l,3)),this.setAttribute("normal",new Ln(h,3)),this.setAttribute("uv",new Ln(f,2));function b(v,x,w,M,E,D,N,V,K,j,Z){var tt=D/K,rt=N/j,J=D/2,U=N/2,G=V/2,I=K+1,C=j+1,L=0,B=0,O,q,it=new oe;for(q=0;q<C;q++){var nt=q*rt-U;for(O=0;O<I;O++){var lt=O*tt-J;it[v]=lt*M,it[x]=nt*E,it[w]=G,l.push(it.x,it.y,it.z),it[v]=0,it[x]=0,it[w]=V>0?1:-1,h.push(it.x,it.y,it.z),f.push(O/K),f.push(1-q/j),L+=1}}for(q=0;q<j;q++)for(O=0;O<K;O++){var ut=d+O+I*q,vt=d+O+I*(q+1),Q=d+(O+1)+I*(q+1),gt=d+(O+1)+I*q;u.push(ut,vt,gt),u.push(vt,Q,gt),B+=6}r.addGroup(p,B,Z),p+=B,d+=L}}}function bu(t){var n={};for(var e in t){n[e]={};for(var i in t[e]){var s=t[e][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture)?n[e][i]=s.clone():Array.isArray(s)?n[e][i]=s.slice():n[e][i]=s}}return n}function ji(t){for(var n={},e=0;e<t.length;e++){var i=bu(t[e]);for(var s in i)n[s]=i[s]}return n}var JC={clone:bu,merge:ji},$C=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,QC=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function go(t){er.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=$C,this.fragmentShader=QC,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}go.prototype=Object.create(er.prototype),go.prototype.constructor=go,go.prototype.isShaderMaterial=!0,go.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=bu(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},go.prototype.toJSON=function(t){var n=er.prototype.toJSON.call(this,t);n.uniforms={};for(var e in this.uniforms){var i=this.uniforms[e],s=i.value;s&&s.isTexture?n.uniforms[e]={type:"t",value:s.toJSON(t).uuid}:s&&s.isColor?n.uniforms[e]={type:"c",value:s.getHex()}:s&&s.isVector2?n.uniforms[e]={type:"v2",value:s.toArray()}:s&&s.isVector3?n.uniforms[e]={type:"v3",value:s.toArray()}:s&&s.isVector4?n.uniforms[e]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?n.uniforms[e]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?n.uniforms[e]={type:"m4",value:s.toArray()}:n.uniforms[e]={value:s}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)this.extensions[o]===!0&&(a[o]=!0);return Object.keys(a).length>0&&(n.extensions=a),n};function pa(){Rn.call(this),this.type="Camera",this.matrixWorldInverse=new mr,this.projectionMatrix=new mr,this.projectionMatrixInverse=new mr}pa.prototype=Object.assign(Object.create(Rn.prototype),{constructor:pa,isCamera:!0,copy:function(t,n){return Rn.prototype.copy.call(this,t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new oe),this.updateMatrixWorld(!0);var n=this.matrixWorld.elements;return t.set(-n[8],-n[9],-n[10]).normalize()},updateMatrixWorld:function(t){Rn.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,n){Rn.prototype.updateWorldMatrix.call(this,t,n),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function gi(t,n,e,i){pa.call(this),this.type="PerspectiveCamera",this.fov=t!==void 0?t:50,this.zoom=1,this.near=e!==void 0?e:.1,this.far=i!==void 0?i:2e3,this.focus=10,this.aspect=n!==void 0?n:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}gi.prototype=Object.assign(Object.create(pa.prototype),{constructor:gi,isPerspectiveCamera:!0,copy:function(t,n){return pa.prototype.copy.call(this,t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var n=.5*this.getFilmHeight()/t;this.fov=pr.RAD2DEG*2*Math.atan(n),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(pr.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return pr.RAD2DEG*2*Math.atan(Math.tan(pr.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,n,e,i,s,a){this.aspect=t/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=e,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,n=t*Math.tan(pr.DEG2RAD*.5*this.fov)/this.zoom,e=2*n,i=this.aspect*e,s=-.5*i,a=this.view;if(this.view!==null&&this.view.enabled){var o=a.fullWidth,r=a.fullHeight;s+=a.offsetX*i/o,n-=a.offsetY*e/r,i*=a.width/o,e*=a.height/r}var u=this.filmOffset;u!==0&&(s+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,n,n-e,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var n=Rn.prototype.toJSON.call(this,t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}});var vu=90,xu=1;function _d(t,n,e,i){Rn.call(this),this.type="CubeCamera";var s=new gi(vu,xu,t,n);s.up.set(0,-1,0),s.lookAt(new oe(1,0,0)),this.add(s);var a=new gi(vu,xu,t,n);a.up.set(0,-1,0),a.lookAt(new oe(-1,0,0)),this.add(a);var o=new gi(vu,xu,t,n);o.up.set(0,0,1),o.lookAt(new oe(0,1,0)),this.add(o);var r=new gi(vu,xu,t,n);r.up.set(0,0,-1),r.lookAt(new oe(0,-1,0)),this.add(r);var u=new gi(vu,xu,t,n);u.up.set(0,-1,0),u.lookAt(new oe(0,0,1)),this.add(u);var l=new gi(vu,xu,t,n);l.up.set(0,-1,0),l.lookAt(new oe(0,0,-1)),this.add(l),i=i||{format:oa,magFilter:pi,minFilter:pi},this.renderTarget=new _u(e,i),this.renderTarget.texture.name="CubeCamera",this.update=function(h,f){this.parent===null&&this.updateMatrixWorld();var d=h.getRenderTarget(),p=this.renderTarget,b=p.texture.generateMipmaps;p.texture.generateMipmaps=!1,h.setRenderTarget(p,0),h.render(f,s),h.setRenderTarget(p,1),h.render(f,a),h.setRenderTarget(p,2),h.render(f,o),h.setRenderTarget(p,3),h.render(f,r),h.setRenderTarget(p,4),h.render(f,u),p.texture.generateMipmaps=b,h.setRenderTarget(p,5),h.render(f,l),h.setRenderTarget(d)},this.clear=function(h,f,d,p){for(var b=h.getRenderTarget(),v=this.renderTarget,x=0;x<6;x++)h.setRenderTarget(v,x),h.clear(f,d,p);h.setRenderTarget(b)}}_d.prototype=Object.create(Rn.prototype),_d.prototype.constructor=_d;function _u(t,n,e){Number.isInteger(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=e),to.call(this,t,t,n)}_u.prototype=Object.create(to.prototype),_u.prototype.constructor=_u,_u.prototype.isWebGLCubeRenderTarget=!0,_u.prototype.fromEquirectangularTexture=function(t,n){this.texture.type=n.type,this.texture.format=n.format,this.texture.encoding=n.encoding;var e=new la,i={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","	vWorldDirection = transformDirection( position, modelMatrix );","	#include <begin_vertex>","	#include <project_vertex>","}"].join(`
`),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","	vec3 direction = normalize( vWorldDirection );","	vec2 sampleUV;","	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","	gl_FragColor = texture2D( tEquirect, sampleUV );","}"].join(`
`)},s=new go({type:"CubemapFromEquirect",uniforms:bu(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Si,blending:Ua});s.uniforms.tEquirect.value=n;var a=new $r(new vm(5,5,5),s);e.add(a);var o=new _d(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(t,e),a.geometry.dispose(),a.material.dispose(),this};function wu(t,n,e,i,s,a,o,r,u,l,h,f){Nr.call(this,null,a,o,r,u,l,i,s,h,f),this.image={data:t||null,width:n||1,height:e||1},this.magFilter=u!==void 0?u:li,this.minFilter=l!==void 0?l:li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}wu.prototype=Object.create(Nr.prototype),wu.prototype.constructor=wu,wu.prototype.isDataTexture=!0;var Mu=new ua,xm=new oe;function wd(t,n,e,i,s,a){this.planes=[t!==void 0?t:new Ps,n!==void 0?n:new Ps,e!==void 0?e:new Ps,i!==void 0?i:new Ps,s!==void 0?s:new Ps,a!==void 0?a:new Ps]}Object.assign(wd.prototype,{set:function(t,n,e,i,s,a){var o=this.planes;return o[0].copy(t),o[1].copy(n),o[2].copy(e),o[3].copy(i),o[4].copy(s),o[5].copy(a),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){for(var n=this.planes,e=0;e<6;e++)n[e].copy(t.planes[e]);return this},setFromProjectionMatrix:function(t){var n=this.planes,e=t.elements,i=e[0],s=e[1],a=e[2],o=e[3],r=e[4],u=e[5],l=e[6],h=e[7],f=e[8],d=e[9],p=e[10],b=e[11],v=e[12],x=e[13],w=e[14],M=e[15];return n[0].setComponents(o-i,h-r,b-f,M-v).normalize(),n[1].setComponents(o+i,h+r,b+f,M+v).normalize(),n[2].setComponents(o+s,h+u,b+d,M+x).normalize(),n[3].setComponents(o-s,h-u,b-d,M-x).normalize(),n[4].setComponents(o-a,h-l,b-p,M-w).normalize(),n[5].setComponents(o+a,h+l,b+p,M+w).normalize(),this},intersectsObject:function(t){var n=t.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Mu.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Mu)},intersectsSprite:function(t){return Mu.center.set(0,0,0),Mu.radius=.7071067811865476,Mu.applyMatrix4(t.matrixWorld),this.intersectsSphere(Mu)},intersectsSphere:function(t){for(var n=this.planes,e=t.center,i=-t.radius,s=0;s<6;s++){var a=n[s].distanceToPoint(e);if(a<i)return!1}return!0},intersectsBox:function(t){for(var n=this.planes,e=0;e<6;e++){var i=n[e];if(xm.x=i.normal.x>0?t.max.x:t.min.x,xm.y=i.normal.y>0?t.max.y:t.min.y,xm.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(xm)<0)return!1}return!0},containsPoint:function(t){for(var n=this.planes,e=0;e<6;e++)if(n[e].distanceToPoint(t)<0)return!1;return!0}});var kn={common:{diffuse:{value:new Dn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Vi},uv2Transform:{value:new Vi},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new on(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Dn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Dn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Vi}},sprite:{diffuse:{value:new Dn(15658734)},opacity:{value:1},center:{value:new on(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Vi}}};function e2(){var t=null,n=!1,e=null;function i(s,a){n!==!1&&(e(s,a),t.requestAnimationFrame(i))}return{start:function(){n!==!0&&e!==null&&(t.requestAnimationFrame(i),n=!0)},stop:function(){n=!1},setAnimationLoop:function(s){e=s},setContext:function(s){t=s}}}function tP(t,n){var e=n.isWebGL2,i=new WeakMap;function s(l,h){var f=l.array,d=l.usage,p=t.createBuffer();t.bindBuffer(h,p),t.bufferData(h,f,d),l.onUploadCallback();var b=5126;return f instanceof Float32Array?b=5126:f instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):f instanceof Uint16Array?b=5123:f instanceof Int16Array?b=5122:f instanceof Uint32Array?b=5125:f instanceof Int32Array?b=5124:f instanceof Int8Array?b=5120:f instanceof Uint8Array&&(b=5121),{buffer:p,type:b,bytesPerElement:f.BYTES_PER_ELEMENT,version:l.version}}function a(l,h,f){var d=h.array,p=h.updateRange;t.bindBuffer(f,l),p.count===-1?t.bufferSubData(f,0,d):(e?t.bufferSubData(f,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):t.bufferSubData(f,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1)}function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)}function r(l){l.isInterleavedBufferAttribute&&(l=l.data);var h=i.get(l);h&&(t.deleteBuffer(h.buffer),i.delete(l))}function u(l,h){l.isInterleavedBufferAttribute&&(l=l.data);var f=i.get(l);f===void 0?i.set(l,s(l,h)):f.version<l.version&&(a(f.buffer,l,h),f.version=l.version)}return{get:o,remove:r,update:u}}function _m(t,n,e,i){sr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:n,widthSegments:e,heightSegments:i},this.fromBufferGeometry(new Au(t,n,e,i)),this.mergeVertices()}_m.prototype=Object.create(sr.prototype),_m.prototype.constructor=_m;function Au(t,n,e,i){Un.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:n,widthSegments:e,heightSegments:i},t=t||1,n=n||1;var s=t/2,a=n/2,o=Math.floor(e)||1,r=Math.floor(i)||1,u=o+1,l=r+1,h=t/o,f=n/r,d,p,b=[],v=[],x=[],w=[];for(p=0;p<l;p++){var M=p*f-a;for(d=0;d<u;d++){var E=d*h-s;v.push(E,-M,0),x.push(0,0,1),w.push(d/o),w.push(1-p/r)}}for(p=0;p<r;p++)for(d=0;d<o;d++){var D=d+u*p,N=d+u*(p+1),V=d+1+u*(p+1),K=d+1+u*p;b.push(D,N,K),b.push(N,V,K)}this.setIndex(b),this.setAttribute("position",new Ln(v,3)),this.setAttribute("normal",new Ln(x,3)),this.setAttribute("uv",new Ln(w,2))}Au.prototype=Object.create(Un.prototype),Au.prototype.constructor=Au;var eP=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,nP=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rP=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,iP=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,oP=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,sP="vec3 transformed = vec3( position );",aP=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,lP=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,cP=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,uP=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif`,hP=`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,dP=`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	varying vec3 vViewPosition;
#endif`,fP=`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	vViewPosition = - mvPosition.xyz;
#endif`,pP=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,mP=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,gP=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,yP=`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,bP=`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}`,vP=`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);
    } else if (face == 1.0) {
      uv = vec2(direction.x, -direction.z) / abs(direction.y);
    } else if (face == 2.0) {
      uv = direction.xy / abs(direction.z);
    } else if (face == 3.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);
    } else if (face == 4.0) {
      uv = direction.xz / abs(direction.y);
    } else {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);
    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,xP=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	transformedNormal = mat3( instanceMatrix ) * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,_P=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,wP=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,MP=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,AP=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,SP="gl_FragColor = linearToOutputTexel( gl_FragColor );",EP=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,TP=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,CP=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,PP=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DP=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,RP=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,kP=`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,IP=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,LP=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,BP=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,FP=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,NP=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,OP=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,zP=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif`,UP=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,VP=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,jP=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,GP=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,HP=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,WP=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,qP=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = saturate( clearcoat );	material.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,XP=`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,YP=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,KP=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,ZP=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,JP=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,$P=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,QP=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,t5=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,e5=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,n5=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,r5=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,i5=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,o5=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,s5=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,a5=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,l5=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,c5=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,u5=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,h5=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,d5=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,f5=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,p5=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,m5=`#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,g5=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,y5=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,b5=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,v5=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,x5=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,_5=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,w5=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,M5=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,A5=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,S5=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif`,E5=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}`,T5=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,C5=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,P5=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,D5=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,R5=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,k5=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,I5=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,L5=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,B5=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,F5=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,N5=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,O5=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,z5=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,U5=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,V5=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,j5=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,G5=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,H5=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,W5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,q5=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}`,X5=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}`,Y5=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,K5=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Z5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,J5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,$5=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Q5=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,t6=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,e6=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,n6=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,r6=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,i6=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,o6=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,s6=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,a6=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,l6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,c6=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,u6=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,h6=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,d6=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,f6=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,p6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,m6=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,g6=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,y6=`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,b6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,v6=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,yr={alphamap_fragment:eP,alphamap_pars_fragment:nP,alphatest_fragment:rP,aomap_fragment:iP,aomap_pars_fragment:oP,begin_vertex:sP,beginnormal_vertex:aP,bsdfs:lP,bumpmap_pars_fragment:cP,clipping_planes_fragment:uP,clipping_planes_pars_fragment:hP,clipping_planes_pars_vertex:dP,clipping_planes_vertex:fP,color_fragment:pP,color_pars_fragment:mP,color_pars_vertex:gP,color_vertex:yP,common:bP,cube_uv_reflection_fragment:vP,defaultnormal_vertex:xP,displacementmap_pars_vertex:_P,displacementmap_vertex:wP,emissivemap_fragment:MP,emissivemap_pars_fragment:AP,encodings_fragment:SP,encodings_pars_fragment:EP,envmap_fragment:TP,envmap_common_pars_fragment:CP,envmap_pars_fragment:PP,envmap_pars_vertex:DP,envmap_physical_pars_fragment:VP,envmap_vertex:RP,fog_vertex:kP,fog_pars_vertex:IP,fog_fragment:LP,fog_pars_fragment:BP,gradientmap_pars_fragment:FP,lightmap_fragment:NP,lightmap_pars_fragment:OP,lights_lambert_vertex:zP,lights_pars_begin:UP,lights_toon_fragment:jP,lights_toon_pars_fragment:GP,lights_phong_fragment:HP,lights_phong_pars_fragment:WP,lights_physical_fragment:qP,lights_physical_pars_fragment:XP,lights_fragment_begin:YP,lights_fragment_maps:KP,lights_fragment_end:ZP,logdepthbuf_fragment:JP,logdepthbuf_pars_fragment:$P,logdepthbuf_pars_vertex:QP,logdepthbuf_vertex:t5,map_fragment:e5,map_pars_fragment:n5,map_particle_fragment:r5,map_particle_pars_fragment:i5,metalnessmap_fragment:o5,metalnessmap_pars_fragment:s5,morphnormal_vertex:a5,morphtarget_pars_vertex:l5,morphtarget_vertex:c5,normal_fragment_begin:u5,normal_fragment_maps:h5,normalmap_pars_fragment:d5,clearcoat_normal_fragment_begin:f5,clearcoat_normal_fragment_maps:p5,clearcoat_normalmap_pars_fragment:m5,packing:g5,premultiplied_alpha_fragment:y5,project_vertex:b5,dithering_fragment:v5,dithering_pars_fragment:x5,roughnessmap_fragment:_5,roughnessmap_pars_fragment:w5,shadowmap_pars_fragment:M5,shadowmap_pars_vertex:A5,shadowmap_vertex:S5,shadowmask_pars_fragment:E5,skinbase_vertex:T5,skinning_pars_vertex:C5,skinning_vertex:P5,skinnormal_vertex:D5,specularmap_fragment:R5,specularmap_pars_fragment:k5,tonemapping_fragment:I5,tonemapping_pars_fragment:L5,uv_pars_fragment:B5,uv_pars_vertex:F5,uv_vertex:N5,uv2_pars_fragment:O5,uv2_pars_vertex:z5,uv2_vertex:U5,worldpos_vertex:V5,background_frag:j5,background_vert:G5,cube_frag:H5,cube_vert:W5,depth_frag:q5,depth_vert:X5,distanceRGBA_frag:Y5,distanceRGBA_vert:K5,equirect_frag:Z5,equirect_vert:J5,linedashed_frag:$5,linedashed_vert:Q5,meshbasic_frag:t6,meshbasic_vert:e6,meshlambert_frag:n6,meshlambert_vert:r6,meshmatcap_frag:i6,meshmatcap_vert:o6,meshtoon_frag:s6,meshtoon_vert:a6,meshphong_frag:l6,meshphong_vert:c6,meshphysical_frag:u6,meshphysical_vert:h6,normal_frag:d6,normal_vert:f6,points_frag:p6,points_vert:m6,shadow_frag:g6,shadow_vert:y6,sprite_frag:b6,sprite_vert:v6},ma={basic:{uniforms:ji([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.fog]),vertexShader:yr.meshbasic_vert,fragmentShader:yr.meshbasic_frag},lambert:{uniforms:ji([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.fog,kn.lights,{emissive:{value:new Dn(0)}}]),vertexShader:yr.meshlambert_vert,fragmentShader:yr.meshlambert_frag},phong:{uniforms:ji([kn.common,kn.specularmap,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,kn.lights,{emissive:{value:new Dn(0)},specular:{value:new Dn(1118481)},shininess:{value:30}}]),vertexShader:yr.meshphong_vert,fragmentShader:yr.meshphong_frag},standard:{uniforms:ji([kn.common,kn.envmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.roughnessmap,kn.metalnessmap,kn.fog,kn.lights,{emissive:{value:new Dn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:yr.meshphysical_vert,fragmentShader:yr.meshphysical_frag},toon:{uniforms:ji([kn.common,kn.specularmap,kn.aomap,kn.lightmap,kn.emissivemap,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.gradientmap,kn.fog,kn.lights,{emissive:{value:new Dn(0)},specular:{value:new Dn(1118481)},shininess:{value:30}}]),vertexShader:yr.meshtoon_vert,fragmentShader:yr.meshtoon_frag},matcap:{uniforms:ji([kn.common,kn.bumpmap,kn.normalmap,kn.displacementmap,kn.fog,{matcap:{value:null}}]),vertexShader:yr.meshmatcap_vert,fragmentShader:yr.meshmatcap_frag},points:{uniforms:ji([kn.points,kn.fog]),vertexShader:yr.points_vert,fragmentShader:yr.points_frag},dashed:{uniforms:ji([kn.common,kn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:yr.linedashed_vert,fragmentShader:yr.linedashed_frag},depth:{uniforms:ji([kn.common,kn.displacementmap]),vertexShader:yr.depth_vert,fragmentShader:yr.depth_frag},normal:{uniforms:ji([kn.common,kn.bumpmap,kn.normalmap,kn.displacementmap,{opacity:{value:1}}]),vertexShader:yr.normal_vert,fragmentShader:yr.normal_frag},sprite:{uniforms:ji([kn.sprite,kn.fog]),vertexShader:yr.sprite_vert,fragmentShader:yr.sprite_frag},background:{uniforms:{uvTransform:{value:new Vi},t2D:{value:null}},vertexShader:yr.background_vert,fragmentShader:yr.background_frag},cube:{uniforms:ji([kn.envmap,{opacity:{value:1}}]),vertexShader:yr.cube_vert,fragmentShader:yr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:yr.equirect_vert,fragmentShader:yr.equirect_frag},distanceRGBA:{uniforms:ji([kn.common,kn.displacementmap,{referencePosition:{value:new oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:yr.distanceRGBA_vert,fragmentShader:yr.distanceRGBA_frag},shadow:{uniforms:ji([kn.lights,kn.fog,{color:{value:new Dn(0)},opacity:{value:1}}]),vertexShader:yr.shadow_vert,fragmentShader:yr.shadow_frag}};ma.physical={uniforms:ji([ma.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new Dn(0)},clearcoatNormalScale:{value:new on(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:yr.meshphysical_vert,fragmentShader:yr.meshphysical_frag};function x6(t,n,e,i){var s=new Dn(0),a=0,o,r,u=null,l=0,h=null;function f(p,b,v,x){var w=b.background,M=t.xr,E=M.getSession&&M.getSession();if(E&&E.environmentBlendMode==="additive"&&(w=null),w===null?d(s,a):w&&w.isColor&&(d(w,1),x=!0),(t.autoClear||x)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.isWebGLCubeRenderTarget||w.mapping===sd)){r===void 0&&(r=new $r(new vm(1,1,1),new go({type:"BackgroundCubeMaterial",uniforms:bu(ma.cube.uniforms),vertexShader:ma.cube.vertexShader,fragmentShader:ma.cube.fragmentShader,side:Si,depthTest:!1,depthWrite:!1,fog:!1})),r.geometry.deleteAttribute("normal"),r.geometry.deleteAttribute("uv"),r.onBeforeRender=function(N,V,K){this.matrixWorld.copyPosition(K.matrixWorld)},Object.defineProperty(r.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),e.update(r));var D=w.isWebGLCubeRenderTarget?w.texture:w;r.material.uniforms.envMap.value=D,r.material.uniforms.flipEnvMap.value=D.isCubeTexture?-1:1,(u!==w||l!==D.version||h!==t.toneMapping)&&(r.material.needsUpdate=!0,u=w,l=D.version,h=t.toneMapping),p.unshift(r,r.geometry,r.material,0,0,null)}else w&&w.isTexture&&(o===void 0&&(o=new $r(new Au(2,2),new go({type:"BackgroundMaterial",uniforms:bu(ma.background.uniforms),vertexShader:ma.background.vertexShader,fragmentShader:ma.background.fragmentShader,side:Zc,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),e.update(o)),o.material.uniforms.t2D.value=w,w.matrixAutoUpdate===!0&&w.updateMatrix(),o.material.uniforms.uvTransform.value.copy(w.matrix),(u!==w||l!==w.version||h!==t.toneMapping)&&(o.material.needsUpdate=!0,u=w,l=w.version,h=t.toneMapping),p.unshift(o,o.geometry,o.material,0,0,null))}function d(p,b){n.buffers.color.setClear(p.r,p.g,p.b,b,i)}return{getClearColor:function(){return s},setClearColor:function(p,b){s.set(p),a=b!==void 0?b:1,d(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(p){a=p,d(s,a)},render:f}}function _6(t,n,e,i){var s=i.isWebGL2,a;function o(l){a=l}function r(l,h){t.drawArrays(a,l,h),e.update(h,a)}function u(l,h,f,d){if(d!==0){var p,b;if(s)p=t,b="drawArraysInstanced";else if(p=n.get("ANGLE_instanced_arrays"),b="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[b](a,h,f,d),e.update(f,a,d)}}this.setMode=o,this.render=r,this.renderInstances=u}function w6(t,n,e){var i;function s(){if(i!==void 0)return i;var V=n.get("EXT_texture_filter_anisotropic");return V!==null?i=t.getParameter(V.MAX_TEXTURE_MAX_ANISOTROPY_EXT):i=0,i}function a(V){if(V==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";V="mediump"}return V==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o=typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&t instanceof WebGL2ComputeRenderingContext,r=e.precision!==void 0?e.precision:"highp",u=a(r);u!==r&&(console.warn("THREE.WebGLRenderer:",r,"not supported, using",u,"instead."),r=u);var l=e.logarithmicDepthBuffer===!0,h=t.getParameter(34930),f=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),b=t.getParameter(34921),v=t.getParameter(36347),x=t.getParameter(36348),w=t.getParameter(36349),M=f>0,E=o||!!n.get("OES_texture_float"),D=M&&E,N=o?t.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:s,getMaxPrecision:a,precision:r,logarithmicDepthBuffer:l,maxTextures:h,maxVertexTextures:f,maxTextureSize:d,maxCubemapSize:p,maxAttributes:b,maxVertexUniforms:v,maxVaryings:x,maxFragmentUniforms:w,vertexTextures:M,floatFragmentTextures:E,floatVertexTextures:D,maxSamples:N}}function M6(){var t=this,n=null,e=0,i=!1,s=!1,a=new Ps,o=new Vi,r={value:null,needsUpdate:!1};this.uniform=r,this.numPlanes=0,this.numIntersection=0,this.init=function(h,f,d){var p=h.length!==0||f||e!==0||i;return i=f,n=l(h,d,0),e=h.length,p},this.beginShadows=function(){s=!0,l(null)},this.endShadows=function(){s=!1,u()},this.setState=function(h,f,d,p,b,v){if(!i||h===null||h.length===0||s&&!d)s?l(null):u();else{var x=s?0:e,w=x*4,M=b.clippingState||null;r.value=M,M=l(h,p,w,v);for(var E=0;E!==w;++E)M[E]=n[E];b.clippingState=M,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=x}};function u(){r.value!==n&&(r.value=n,r.needsUpdate=e>0),t.numPlanes=e,t.numIntersection=0}function l(h,f,d,p){var b=h!==null?h.length:0,v=null;if(b!==0){if(v=r.value,p!==!0||v===null){var x=d+b*4,w=f.matrixWorldInverse;o.getNormalMatrix(w),(v===null||v.length<x)&&(v=new Float32Array(x));for(var M=0,E=d;M!==b;++M,E+=4)a.copy(h[M]).applyMatrix4(w,o),a.normal.toArray(v,E),v[E+3]=a.constant}r.value=v,r.needsUpdate=!0}return t.numPlanes=b,v}}function A6(t){var n={};return{get:function(e){if(n[e]!==void 0)return n[e];var i;switch(e){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(e)}return i===null&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),n[e]=i,i}}}function S6(t,n,e){var i=new WeakMap,s=new WeakMap;function a(h){var f=h.target,d=i.get(f);d.index!==null&&n.remove(d.index);for(var p in d.attributes)n.remove(d.attributes[p]);f.removeEventListener("dispose",a),i.delete(f);var b=s.get(d);b&&(n.remove(b),s.delete(d)),e.memory.geometries--}function o(h,f){var d=i.get(f);return d||(f.addEventListener("dispose",a),f.isBufferGeometry?d=f:f.isGeometry&&(f._bufferGeometry===void 0&&(f._bufferGeometry=new Un().setFromObject(h)),d=f._bufferGeometry),i.set(f,d),e.memory.geometries++,d)}function r(h){var f=h.index,d=h.attributes;f!==null&&n.update(f,34963);for(var p in d)n.update(d[p],34962);var b=h.morphAttributes;for(var p in b)for(var v=b[p],x=0,w=v.length;x<w;x++)n.update(v[x],34962)}function u(h){var f=[],d=h.index,p=h.attributes.position,b=0;if(d!==null){var v=d.array;b=d.version;for(var x=0,w=v.length;x<w;x+=3){var M=v[x+0],E=v[x+1],D=v[x+2];f.push(M,E,E,D,D,M)}}else{var v=p.array;b=p.version;for(var x=0,w=v.length/3-1;x<w;x+=3){var M=x+0,E=x+1,D=x+2;f.push(M,E,E,D,D,M)}}var N=new($_(f)>65535?bd:yd)(f,1);N.version=b,n.update(N,34963);var V=s.get(h);V&&n.remove(V),s.set(h,N)}function l(h){var f=s.get(h);if(f){var d=h.index;d!==null&&f.version<d.version&&u(h)}else u(h);return s.get(h)}return{get:o,update:r,getWireframeAttribute:l}}function E6(t,n,e,i){var s=i.isWebGL2,a;function o(d){a=d}var r,u;function l(d){r=d.type,u=d.bytesPerElement}function h(d,p){t.drawElements(a,p,r,d*u),e.update(p,a)}function f(d,p,b,v){if(v!==0){var x,w;if(s)x=t,w="drawElementsInstanced";else if(x=n.get("ANGLE_instanced_arrays"),w="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[w](a,b,r,p*u,v),e.update(b,a,v)}}this.setMode=o,this.setIndex=l,this.render=h,this.renderInstances=f}function T6(t){var n={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,o,r){switch(r=r||1,e.calls++,o){case 4:e.triangles+=r*(a/3);break;case 1:e.lines+=r*(a/2);break;case 3:e.lines+=r*(a-1);break;case 2:e.lines+=r*a;break;case 0:e.points+=r*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function s(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0}return{memory:n,render:e,programs:null,autoReset:!0,reset:s,update:i}}function C6(t,n){return Math.abs(n[1])-Math.abs(t[1])}function P6(t){var n={},e=new Float32Array(8);function i(s,a,o,r){var u=s.morphTargetInfluences,l=u===void 0?0:u.length,h=n[a.id];if(h===void 0){h=[];for(var f=0;f<l;f++)h[f]=[f,0];n[a.id]=h}for(var d=o.morphTargets&&a.morphAttributes.position,p=o.morphNormals&&a.morphAttributes.normal,f=0;f<l;f++){var b=h[f];b[1]!==0&&(d&&a.deleteAttribute("morphTarget"+f),p&&a.deleteAttribute("morphNormal"+f))}for(var f=0;f<l;f++){var b=h[f];b[0]=f,b[1]=u[f]}h.sort(C6);for(var v=0,f=0;f<8;f++){var b=h[f];if(b){var x=b[0],w=b[1];if(w){d&&a.setAttribute("morphTarget"+f,d[x]),p&&a.setAttribute("morphNormal"+f,p[x]),e[f]=w,v+=w;continue}}e[f]=0}var M=a.morphTargetsRelative?1:1-v;r.getUniforms().setValue(t,"morphTargetBaseInfluence",M),r.getUniforms().setValue(t,"morphTargetInfluences",e)}return{update:i}}function D6(t,n,e,i){var s={};function a(r){var u=i.render.frame,l=r.geometry,h=n.get(r,l);return s[h.id]!==u&&(l.isGeometry&&h.updateFromObject(r),n.update(h),s[h.id]=u),r.isInstancedMesh&&e.update(r.instanceMatrix,34962),h}function o(){s={}}return{update:a,dispose:o}}function Wa(t,n,e,i,s,a,o,r,u,l){t=t!==void 0?t:[],n=n!==void 0?n:H1,o=o!==void 0?o:oa,Nr.call(this,t,n,e,i,s,a,o,r,u,l),this.flipY=!1}Wa.prototype=Object.create(Nr.prototype),Wa.prototype.constructor=Wa,Wa.prototype.isCubeTexture=!0,Object.defineProperty(Wa.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});function Md(t,n,e,i){Nr.call(this,null),this.image={data:t||null,width:n||1,height:e||1,depth:i||1},this.magFilter=li,this.minFilter=li,this.wrapR=Qi,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Md.prototype=Object.create(Nr.prototype),Md.prototype.constructor=Md,Md.prototype.isDataTexture2DArray=!0;function Ad(t,n,e,i){Nr.call(this,null),this.image={data:t||null,width:n||1,height:e||1,depth:i||1},this.magFilter=li,this.minFilter=li,this.wrapR=Qi,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ad.prototype=Object.create(Nr.prototype),Ad.prototype.constructor=Ad,Ad.prototype.isDataTexture3D=!0;var n2=new Nr,R6=new Md,k6=new Ad,r2=new Wa,i2=[],o2=[],s2=new Float32Array(16),a2=new Float32Array(9),l2=new Float32Array(4);function Su(t,n,e){var i=t[0];if(i<=0||i>0)return t;var s=n*e,a=i2[s];if(a===void 0&&(a=new Float32Array(s),i2[s]=a),n!==0){i.toArray(a,0);for(var o=1,r=0;o!==n;++o)r+=e,t[o].toArray(a,r)}return a}function Ko(t,n){if(t.length!==n.length)return!1;for(var e=0,i=t.length;e<i;e++)if(t[e]!==n[e])return!1;return!0}function zo(t,n){for(var e=0,i=n.length;e<i;e++)t[e]=n[e]}function c2(t,n){var e=o2[n];e===void 0&&(e=new Int32Array(n),o2[n]=e);for(var i=0;i!==n;++i)e[i]=t.allocateTextureUnit();return e}function I6(t,n){var e=this.cache;e[0]!==n&&(t.uniform1f(this.addr,n),e[0]=n)}function L6(t,n){var e=this.cache;if(n.x!==void 0)(e[0]!==n.x||e[1]!==n.y)&&(t.uniform2f(this.addr,n.x,n.y),e[0]=n.x,e[1]=n.y);else{if(Ko(e,n))return;t.uniform2fv(this.addr,n),zo(e,n)}}function B6(t,n){var e=this.cache;if(n.x!==void 0)(e[0]!==n.x||e[1]!==n.y||e[2]!==n.z)&&(t.uniform3f(this.addr,n.x,n.y,n.z),e[0]=n.x,e[1]=n.y,e[2]=n.z);else if(n.r!==void 0)(e[0]!==n.r||e[1]!==n.g||e[2]!==n.b)&&(t.uniform3f(this.addr,n.r,n.g,n.b),e[0]=n.r,e[1]=n.g,e[2]=n.b);else{if(Ko(e,n))return;t.uniform3fv(this.addr,n),zo(e,n)}}function F6(t,n){var e=this.cache;if(n.x!==void 0)(e[0]!==n.x||e[1]!==n.y||e[2]!==n.z||e[3]!==n.w)&&(t.uniform4f(this.addr,n.x,n.y,n.z,n.w),e[0]=n.x,e[1]=n.y,e[2]=n.z,e[3]=n.w);else{if(Ko(e,n))return;t.uniform4fv(this.addr,n),zo(e,n)}}function N6(t,n){var e=this.cache,i=n.elements;if(i===void 0){if(Ko(e,n))return;t.uniformMatrix2fv(this.addr,!1,n),zo(e,n)}else{if(Ko(e,i))return;l2.set(i),t.uniformMatrix2fv(this.addr,!1,l2),zo(e,i)}}function O6(t,n){var e=this.cache,i=n.elements;if(i===void 0){if(Ko(e,n))return;t.uniformMatrix3fv(this.addr,!1,n),zo(e,n)}else{if(Ko(e,i))return;a2.set(i),t.uniformMatrix3fv(this.addr,!1,a2),zo(e,i)}}function z6(t,n){var e=this.cache,i=n.elements;if(i===void 0){if(Ko(e,n))return;t.uniformMatrix4fv(this.addr,!1,n),zo(e,n)}else{if(Ko(e,i))return;s2.set(i),t.uniformMatrix4fv(this.addr,!1,s2),zo(e,i)}}function U6(t,n,e){var i=this.cache,s=e.allocateTextureUnit();i[0]!==s&&(t.uniform1i(this.addr,s),i[0]=s),e.safeSetTexture2D(n||n2,s)}function V6(t,n,e){var i=this.cache,s=e.allocateTextureUnit();i[0]!==s&&(t.uniform1i(this.addr,s),i[0]=s),e.setTexture2DArray(n||R6,s)}function j6(t,n,e){var i=this.cache,s=e.allocateTextureUnit();i[0]!==s&&(t.uniform1i(this.addr,s),i[0]=s),e.setTexture3D(n||k6,s)}function G6(t,n,e){var i=this.cache,s=e.allocateTextureUnit();i[0]!==s&&(t.uniform1i(this.addr,s),i[0]=s),e.safeSetTextureCube(n||r2,s)}function H6(t,n){var e=this.cache;e[0]!==n&&(t.uniform1i(this.addr,n),e[0]=n)}function W6(t,n){var e=this.cache;Ko(e,n)||(t.uniform2iv(this.addr,n),zo(e,n))}function q6(t,n){var e=this.cache;Ko(e,n)||(t.uniform3iv(this.addr,n),zo(e,n))}function X6(t,n){var e=this.cache;Ko(e,n)||(t.uniform4iv(this.addr,n),zo(e,n))}function Y6(t,n){var e=this.cache;e[0]!==n&&(t.uniform1ui(this.addr,n),e[0]=n)}function K6(t){switch(t){case 5126:return I6;case 35664:return L6;case 35665:return B6;case 35666:return F6;case 35674:return N6;case 35675:return O6;case 35676:return z6;case 5124:case 35670:return H6;case 35667:case 35671:return W6;case 35668:case 35672:return q6;case 35669:case 35673:return X6;case 5125:return Y6;case 35678:case 36198:case 36298:case 36306:case 35682:return U6;case 35679:case 36299:case 36307:return j6;case 35680:case 36300:case 36308:case 36293:return G6;case 36289:case 36303:case 36311:case 36292:return V6}}function Z6(t,n){t.uniform1fv(this.addr,n)}function J6(t,n){t.uniform1iv(this.addr,n)}function $6(t,n){t.uniform2iv(this.addr,n)}function Q6(t,n){t.uniform3iv(this.addr,n)}function tD(t,n){t.uniform4iv(this.addr,n)}function eD(t,n){var e=Su(n,this.size,2);t.uniform2fv(this.addr,e)}function nD(t,n){var e=Su(n,this.size,3);t.uniform3fv(this.addr,e)}function rD(t,n){var e=Su(n,this.size,4);t.uniform4fv(this.addr,e)}function iD(t,n){var e=Su(n,this.size,4);t.uniformMatrix2fv(this.addr,!1,e)}function oD(t,n){var e=Su(n,this.size,9);t.uniformMatrix3fv(this.addr,!1,e)}function sD(t,n){var e=Su(n,this.size,16);t.uniformMatrix4fv(this.addr,!1,e)}function aD(t,n,e){var i=n.length,s=c2(e,i);t.uniform1iv(this.addr,s);for(var a=0;a!==i;++a)e.safeSetTexture2D(n[a]||n2,s[a])}function lD(t,n,e){var i=n.length,s=c2(e,i);t.uniform1iv(this.addr,s);for(var a=0;a!==i;++a)e.safeSetTextureCube(n[a]||r2,s[a])}function cD(t){switch(t){case 5126:return Z6;case 35664:return eD;case 35665:return nD;case 35666:return rD;case 35674:return iD;case 35675:return oD;case 35676:return sD;case 5124:case 35670:return J6;case 35667:case 35671:return $6;case 35668:case 35672:return Q6;case 35669:case 35673:return tD;case 35678:case 36198:case 36298:case 36306:case 35682:return aD;case 35680:case 36300:case 36308:case 36293:return lD}}function uD(t,n,e){this.id=t,this.addr=e,this.cache=[],this.setValue=K6(n.type)}function u2(t,n,e){this.id=t,this.addr=e,this.cache=[],this.size=n.size,this.setValue=cD(n.type)}u2.prototype.updateCache=function(t){var n=this.cache;t instanceof Float32Array&&n.length!==t.length&&(this.cache=new Float32Array(t.length)),zo(n,t)};function h2(t){this.id=t,this.seq=[],this.map={}}h2.prototype.setValue=function(t,n,e){for(var i=this.seq,s=0,a=i.length;s!==a;++s){var o=i[s];o.setValue(t,n[o.id],e)}};var Ay=/([\w\d_]+)(\])?(\[|\.)?/g;function d2(t,n){t.seq.push(n),t.map[n.id]=n}function hD(t,n,e){var i=t.name,s=i.length;for(Ay.lastIndex=0;;){var a=Ay.exec(i),o=Ay.lastIndex,r=a[1],u=a[2]==="]",l=a[3];if(u&&(r=r|0),l===void 0||l==="["&&o+2===s){d2(e,l===void 0?new uD(r,t,n):new u2(r,t,n));break}else{var h=e.map,f=h[r];f===void 0&&(f=new h2(r),d2(e,f)),e=f}}}function qa(t,n){this.seq=[],this.map={};for(var e=t.getProgramParameter(n,35718),i=0;i<e;++i){var s=t.getActiveUniform(n,i),a=t.getUniformLocation(n,s.name);hD(s,a,this)}}qa.prototype.setValue=function(t,n,e,i){var s=this.map[n];s!==void 0&&s.setValue(t,e,i)},qa.prototype.setOptional=function(t,n,e){var i=n[e];i!==void 0&&this.setValue(t,e,i)},qa.upload=function(t,n,e,i){for(var s=0,a=n.length;s!==a;++s){var o=n[s],r=e[o.id];r.needsUpdate!==!1&&o.setValue(t,r.value,i)}},qa.seqWithValue=function(t,n){for(var e=[],i=0,s=t.length;i!==s;++i){var a=t[i];a.id in n&&e.push(a)}return e};function f2(t,n,e){var i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),i}var dD=0;function fD(t){for(var n=t.split(`
`),e=0;e<n.length;e++)n[e]=e+1+": "+n[e];return n.join(`
`)}function p2(t){switch(t){case Fo:return["Linear","( value )"];case hd:return["sRGB","( value )"];case J1:return["RGBE","( value )"];case N_:return["RGBM","( value, 7.0 )"];case O_:return["RGBM","( value, 16.0 )"];case z_:return["RGBD","( value, 256.0 )"];case F_:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case RC:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function m2(t,n,e){var i=t.getShaderParameter(n,35713),s=t.getShaderInfoLog(n).trim();if(i&&s==="")return"";var a=t.getShaderSource(n);return"THREE.WebGLShader: gl.getShaderInfoLog() "+e+`
`+s+fD(a)}function Sd(t,n){var e=p2(n);return"vec4 "+t+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function pD(t,n){var e=p2(n);return"vec4 "+t+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function mD(t,n){var e;switch(n){case j1:e="Linear";break;case WT:e="Reinhard";break;case qT:e="Uncharted2";break;case XT:e="OptimizedCineon";break;case YT:e="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+n)}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function gD(t){var n=[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(Ed).join(`
`)}function yD(t){var n=[];for(var e in t){var i=t[e];i!==!1&&n.push("#define "+e+" "+i)}return n.join(`
`)}function bD(t,n){for(var e={},i=t.getProgramParameter(n,35721),s=0;s<i;s++){var a=t.getActiveAttrib(n,s),o=a.name;e[o]=t.getAttribLocation(n,o)}return e}function Ed(t){return t!==""}function g2(t,n){return t.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function y2(t,n){return t.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}var vD=/^[ \t]*#include +<([\w\d./]+)>/gm;function Sy(t){return t.replace(vD,xD)}function xD(t,n){var e=yr[n];if(e===void 0)throw new Error("Can not resolve #include <"+n+">");return Sy(e)}var _D=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function b2(t){return t.replace(_D,wD)}function wD(t,n,e,i){for(var s="",a=parseInt(n);a<parseInt(e);a++)s+=i.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function v2(t){var n="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?n+=`
#define HIGH_PRECISION`:t.precision==="mediump"?n+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(n+=`
#define LOW_PRECISION`),n}function MD(t){var n="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===p_?n="SHADOWMAP_TYPE_PCF":t.shadowMapType===wT?n="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===rd&&(n="SHADOWMAP_TYPE_VSM"),n}function AD(t){var n="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case H1:case W1:n="ENVMAP_TYPE_CUBE";break;case sd:case X1:n="ENVMAP_TYPE_CUBE_UV";break;case A_:case q1:n="ENVMAP_TYPE_EQUIREC";break;case S_:n="ENVMAP_TYPE_SPHERE";break}return n}function SD(t){var n="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case W1:case q1:n="ENVMAP_MODE_REFRACTION";break}return n}function ED(t){var n="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Kp:n="ENVMAP_BLENDING_MULTIPLY";break;case GT:n="ENVMAP_BLENDING_MIX";break;case HT:n="ENVMAP_BLENDING_ADD";break}return n}function TD(t,n,e){var i=t.getContext(),s=e.defines,a=e.vertexShader,o=e.fragmentShader,r=MD(e),u=AD(e),l=SD(e),h=ED(e),f=t.gammaFactor>0?t.gammaFactor:1,d=e.isWebGL2?"":gD(e),p=yD(s),b=i.createProgram(),v,x,w=e.numMultiviewViews;if(e.isRawShaderMaterial?(v=[p].filter(Ed).join(`
`),v.length>0&&(v+=`
`),x=[d,p].filter(Ed).join(`
`),x.length>0&&(x+=`
`)):(v=[v2(e),"#define SHADER_NAME "+e.shaderName,p,e.instancing?"#define USE_INSTANCING":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+f,"#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+l:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+r:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ed).join(`
`),x=[d,v2(e),"#define SHADER_NAME "+e.shaderName,p,e.alphaTest?"#define ALPHATEST "+e.alphaTest+(e.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+f,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.envMap?"#define "+l:"",e.envMap?"#define "+h:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.sheen?"#define USE_SHEEN":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+r:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==Zp?"#define TONE_MAPPING":"",e.toneMapping!==Zp?yr.tonemapping_pars_fragment:"",e.toneMapping!==Zp?mD("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.outputEncoding||e.mapEncoding||e.matcapEncoding||e.envMapEncoding||e.emissiveMapEncoding||e.lightMapEncoding?yr.encodings_pars_fragment:"",e.mapEncoding?Sd("mapTexelToLinear",e.mapEncoding):"",e.matcapEncoding?Sd("matcapTexelToLinear",e.matcapEncoding):"",e.envMapEncoding?Sd("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMapEncoding?Sd("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.lightMapEncoding?Sd("lightMapTexelToLinear",e.lightMapEncoding):"",e.outputEncoding?pD("linearToOutputTexel",e.outputEncoding):"",e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(Ed).join(`
`)),a=Sy(a),a=g2(a,e),a=y2(a,e),o=Sy(o),o=g2(o,e),o=y2(o,e),a=b2(a),o=b2(o),e.isWebGL2&&!e.isRawShaderMaterial){var M=!1,E=/^\s*#version\s+300\s+es\s*\n/;e.isShaderMaterial&&a.match(E)!==null&&o.match(E)!==null&&(M=!0,a=a.replace(E,""),o=o.replace(E,"")),v=[`#version 300 es
`,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,x=[`#version 300 es
`,"#define varying in",M?"":"out highp vec4 pc_fragColor;",M?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x,w>0&&(v=v.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","layout(num_views = "+w+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),v=v.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+w+"];","uniform mat4 projectionMatrices["+w+"];","uniform mat4 viewMatrices["+w+"];","uniform mat3 normalMatrices["+w+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),x=x.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),x=x.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+w+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`)))}var D=v+a,N=x+o,V=f2(i,35633,D),K=f2(i,35632,N);if(i.attachShader(b,V),i.attachShader(b,K),e.index0AttributeName!==void 0?i.bindAttribLocation(b,0,e.index0AttributeName):e.morphTargets===!0&&i.bindAttribLocation(b,0,"position"),i.linkProgram(b),t.debug.checkShaderErrors){var j=i.getProgramInfoLog(b).trim(),Z=i.getShaderInfoLog(V).trim(),tt=i.getShaderInfoLog(K).trim(),rt=!0,J=!0;if(i.getProgramParameter(b,35714)===!1){rt=!1;var U=m2(i,V,"vertex"),G=m2(i,K,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(b,35715),"gl.getProgramInfoLog",j,U,G)}else j!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",j):(Z===""||tt==="")&&(J=!1);J&&(this.diagnostics={runnable:rt,programLog:j,vertexShader:{log:Z,prefix:v},fragmentShader:{log:tt,prefix:x}})}i.deleteShader(V),i.deleteShader(K);var I;this.getUniforms=function(){return I===void 0&&(I=new qa(i,b)),I};var C;return this.getAttributes=function(){return C===void 0&&(C=bD(i,b)),C},this.destroy=function(){i.deleteProgram(b),this.program=void 0},this.name=e.shaderName,this.id=dD++,this.cacheKey=n,this.usedTimes=1,this.program=b,this.vertexShader=V,this.fragmentShader=K,this.numMultiviewViews=w,this}function CD(t,n,e){var i=[],s=e.isWebGL2,a=e.logarithmicDepthBuffer,o=e.floatVertexTextures,r=e.precision,u=e.maxVertexUniforms,l=e.vertexTextures,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function d(v,x){var w;if(x){var M=ma[x];w={name:v.type,uniforms:JC.clone(M.uniforms),vertexShader:M.vertexShader,fragmentShader:M.fragmentShader}}else w={name:v.type,uniforms:v.uniforms,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader};return w}function p(v){var x=v.skeleton,w=x.bones;if(o)return 1024;var M=u,E=Math.floor((M-20)/4),D=Math.min(E,w.length);return D<w.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+w.length+" bones. This GPU supports "+D+"."),0):D}function b(v){var x;return v?v.isTexture?x=v.encoding:v.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),x=v.texture.encoding):x=Fo,x}this.getParameters=function(v,x,w,M,E,D,N){var V=M.fog,K=v.isMeshStandardMaterial?M.environment:null,j=v.envMap||K,Z=h[v.type],tt=N.isSkinnedMesh?p(N):0;v.precision!==null&&(r=e.getMaxPrecision(v.precision),r!==v.precision&&console.warn("THREE.WebGLProgram.getParameters:",v.precision,"not supported, using",r,"instead."));var rt=d(v,Z);v.onBeforeCompile(rt,t);var J=t.getRenderTarget(),U=J&&J.isWebGLMultiviewRenderTarget?J.numViews:0,G={isWebGL2:s,shaderID:Z,shaderName:rt.name,uniforms:rt.uniforms,vertexShader:rt.vertexShader,fragmentShader:rt.fragmentShader,defines:v.defines,isRawShaderMaterial:v.isRawShaderMaterial,isShaderMaterial:v.isShaderMaterial,precision:r,instancing:N.isInstancedMesh===!0,supportsVertexTextures:l,numMultiviewViews:U,outputEncoding:J!==null?b(J.texture):t.outputEncoding,map:!!v.map,mapEncoding:b(v.map),matcap:!!v.matcap,matcapEncoding:b(v.matcap),envMap:!!j,envMapMode:j&&j.mapping,envMapEncoding:b(j),envMapCubeUV:!!j&&(j.mapping===sd||j.mapping===X1),lightMap:!!v.lightMap,lightMapEncoding:b(v.lightMap),aoMap:!!v.aoMap,emissiveMap:!!v.emissiveMap,emissiveMapEncoding:b(v.emissiveMap),bumpMap:!!v.bumpMap,normalMap:!!v.normalMap,objectSpaceNormalMap:v.normalMapType===LC,tangentSpaceNormalMap:v.normalMapType===zl,clearcoatNormalMap:!!v.clearcoatNormalMap,displacementMap:!!v.displacementMap,roughnessMap:!!v.roughnessMap,metalnessMap:!!v.metalnessMap,specularMap:!!v.specularMap,alphaMap:!!v.alphaMap,gradientMap:!!v.gradientMap,sheen:!!v.sheen,combine:v.combine,vertexTangents:v.normalMap&&v.vertexTangents,vertexColors:v.vertexColors,vertexUvs:!!v.map||!!v.bumpMap||!!v.normalMap||!!v.specularMap||!!v.alphaMap||!!v.emissiveMap||!!v.roughnessMap||!!v.metalnessMap||!!v.clearcoatNormalMap||!!v.displacementMap,uvsVertexOnly:!(v.map||v.bumpMap||v.normalMap||v.specularMap||v.alphaMap||v.emissiveMap||v.roughnessMap||v.metalnessMap||v.clearcoatNormalMap)&&!!v.displacementMap,fog:!!V,useFog:v.fog,fogExp2:V&&V.isFogExp2,flatShading:v.flatShading,sizeAttenuation:v.sizeAttenuation,logarithmicDepthBuffer:a,skinning:v.skinning&&tt>0,maxBones:tt,useVertexTexture:o,morphTargets:v.morphTargets,morphNormals:v.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:x.directional.length,numPointLights:x.point.length,numSpotLights:x.spot.length,numRectAreaLights:x.rectArea.length,numHemiLights:x.hemi.length,numDirLightShadows:x.directionalShadowMap.length,numPointLightShadows:x.pointShadowMap.length,numSpotLightShadows:x.spotShadowMap.length,numClippingPlanes:E,numClipIntersection:D,dithering:v.dithering,shadowMapEnabled:t.shadowMap.enabled&&w.length>0,shadowMapType:t.shadowMap.type,toneMapping:v.toneMapped?t.toneMapping:Zp,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:v.premultipliedAlpha,alphaTest:v.alphaTest,doubleSided:v.side===id,flipSided:v.side===Si,depthPacking:v.depthPacking!==void 0?v.depthPacking:!1,index0AttributeName:v.index0AttributeName,extensionDerivatives:v.extensions&&v.extensions.derivatives,extensionFragDepth:v.extensions&&v.extensions.frawbuffers,extensionDrawbuffers:v.extensions&&v.extensions.drawbuffers,extensionShaderTextureLOD:v.extensions&&v.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:s||n.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:s||n.get("EXT_shader_texture_lod")!==null,onBeforeCompile:v.onBeforeCompile};return G},this.getProgramCacheKey=function(v){var x=[];if(v.shaderID?x.push(v.shaderID):(x.push(v.fragmentShader),x.push(v.vertexShader)),v.defines!==void 0)for(var w in v.defines)x.push(w),x.push(v.defines[w]);if(v.isRawShaderMaterial===void 0){for(var M=0;M<f.length;M++)x.push(v[f[M]]);x.push(t.outputEncoding),x.push(t.gammaFactor)}return x.push(v.onBeforeCompile.toString()),x.join()},this.acquireProgram=function(v,x){for(var w,M=0,E=i.length;M<E;M++){var D=i[M];if(D.cacheKey===x){w=D,++w.usedTimes;break}}return w===void 0&&(w=new TD(t,x,v),i.push(w)),w},this.releaseProgram=function(v){if(--v.usedTimes===0){var x=i.indexOf(v);i[x]=i[i.length-1],i.pop(),v.destroy()}},this.programs=i}function PD(){var t=new WeakMap;function n(a){var o=t.get(a);return o===void 0&&(o={},t.set(a,o)),o}function e(a){t.delete(a)}function i(a,o,r){t.get(a)[o]=r}function s(){t=new WeakMap}return{get:n,remove:e,update:i,dispose:s}}function DD(t,n){return t.groupOrder!==n.groupOrder?t.groupOrder-n.groupOrder:t.renderOrder!==n.renderOrder?t.renderOrder-n.renderOrder:t.program!==n.program?t.program.id-n.program.id:t.material.id!==n.material.id?t.material.id-n.material.id:t.z!==n.z?t.z-n.z:t.id-n.id}function RD(t,n){return t.groupOrder!==n.groupOrder?t.groupOrder-n.groupOrder:t.renderOrder!==n.renderOrder?t.renderOrder-n.renderOrder:t.z!==n.z?n.z-t.z:t.id-n.id}function x2(){var t=[],n=0,e=[],i=[],s={id:-1};function a(){n=0,e.length=0,i.length=0}function o(h,f,d,p,b,v){var x=t[n];return x===void 0?(x={id:h.id,object:h,geometry:f,material:d,program:d.program||s,groupOrder:p,renderOrder:h.renderOrder,z:b,group:v},t[n]=x):(x.id=h.id,x.object=h,x.geometry=f,x.material=d,x.program=d.program||s,x.groupOrder=p,x.renderOrder=h.renderOrder,x.z=b,x.group=v),n++,x}function r(h,f,d,p,b,v){var x=o(h,f,d,p,b,v);(d.transparent===!0?i:e).push(x)}function u(h,f,d,p,b,v){var x=o(h,f,d,p,b,v);(d.transparent===!0?i:e).unshift(x)}function l(h,f){e.length>1&&e.sort(h||DD),i.length>1&&i.sort(f||RD)}return{opaque:e,transparent:i,init:a,push:r,unshift:u,sort:l}}function kD(){var t=new WeakMap;function n(s){var a=s.target;a.removeEventListener("dispose",n),t.delete(a)}function e(s,a){var o=t.get(s),r;return o===void 0?(r=new x2,t.set(s,new WeakMap),t.get(s).set(a,r),s.addEventListener("dispose",n)):(r=o.get(a),r===void 0&&(r=new x2,o.set(a,r))),r}function i(){t=new WeakMap}return{get:e,dispose:i}}function ID(){var t={};return{get:function(n){if(t[n.id]!==void 0)return t[n.id];var e;switch(n.type){case"DirectionalLight":e={direction:new oe,color:new Dn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new on};break;case"SpotLight":e={position:new oe,direction:new oe,color:new Dn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new on};break;case"PointLight":e={position:new oe,color:new Dn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new on,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":e={direction:new oe,skyColor:new Dn,groundColor:new Dn};break;case"RectAreaLight":e={color:new Dn,position:new oe,halfWidth:new oe,halfHeight:new oe};break}return t[n.id]=e,e}}}var LD=0;function BD(t,n){return(n.castShadow?1:0)-(t.castShadow?1:0)}function FD(){for(var t=new ID,n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},e=0;e<9;e++)n.probe.push(new oe);var i=new oe,s=new mr,a=new mr;function o(r,u,l){for(var h=0,f=0,d=0,p=0;p<9;p++)n.probe[p].set(0,0,0);var b=0,v=0,x=0,w=0,M=0,E=0,D=0,N=0,V=l.matrixWorldInverse;r.sort(BD);for(var p=0,K=r.length;p<K;p++){var j=r[p],Z=j.color,tt=j.intensity,rt=j.distance,J=j.shadow&&j.shadow.map?j.shadow.map.texture:null;if(j.isAmbientLight)h+=Z.r*tt,f+=Z.g*tt,d+=Z.b*tt;else if(j.isLightProbe)for(var U=0;U<9;U++)n.probe[U].addScaledVector(j.sh.coefficients[U],tt);else if(j.isDirectionalLight){var G=t.get(j);if(G.color.copy(j.color).multiplyScalar(j.intensity),G.direction.setFromMatrixPosition(j.matrixWorld),i.setFromMatrixPosition(j.target.matrixWorld),G.direction.sub(i),G.direction.transformDirection(V),G.shadow=j.castShadow,j.castShadow){var I=j.shadow;G.shadowBias=I.bias,G.shadowRadius=I.radius,G.shadowMapSize=I.mapSize,n.directionalShadowMap[b]=J,n.directionalShadowMatrix[b]=j.shadow.matrix,E++}n.directional[b]=G,b++}else if(j.isSpotLight){var G=t.get(j);if(G.position.setFromMatrixPosition(j.matrixWorld),G.position.applyMatrix4(V),G.color.copy(Z).multiplyScalar(tt),G.distance=rt,G.direction.setFromMatrixPosition(j.matrixWorld),i.setFromMatrixPosition(j.target.matrixWorld),G.direction.sub(i),G.direction.transformDirection(V),G.coneCos=Math.cos(j.angle),G.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),G.decay=j.decay,G.shadow=j.castShadow,j.castShadow){var I=j.shadow;G.shadowBias=I.bias,G.shadowRadius=I.radius,G.shadowMapSize=I.mapSize,n.spotShadowMap[x]=J,n.spotShadowMatrix[x]=j.shadow.matrix,N++}n.spot[x]=G,x++}else if(j.isRectAreaLight){var G=t.get(j);G.color.copy(Z).multiplyScalar(tt),G.position.setFromMatrixPosition(j.matrixWorld),G.position.applyMatrix4(V),a.identity(),s.copy(j.matrixWorld),s.premultiply(V),a.extractRotation(s),G.halfWidth.set(j.width*.5,0,0),G.halfHeight.set(0,j.height*.5,0),G.halfWidth.applyMatrix4(a),G.halfHeight.applyMatrix4(a),n.rectArea[w]=G,w++}else if(j.isPointLight){var G=t.get(j);if(G.position.setFromMatrixPosition(j.matrixWorld),G.position.applyMatrix4(V),G.color.copy(j.color).multiplyScalar(j.intensity),G.distance=j.distance,G.decay=j.decay,G.shadow=j.castShadow,j.castShadow){var I=j.shadow;G.shadowBias=I.bias,G.shadowRadius=I.radius,G.shadowMapSize=I.mapSize,G.shadowCameraNear=I.camera.near,G.shadowCameraFar=I.camera.far,n.pointShadowMap[v]=J,n.pointShadowMatrix[v]=j.shadow.matrix,D++}n.point[v]=G,v++}else if(j.isHemisphereLight){var G=t.get(j);G.direction.setFromMatrixPosition(j.matrixWorld),G.direction.transformDirection(V),G.direction.normalize(),G.skyColor.copy(j.color).multiplyScalar(tt),G.groundColor.copy(j.groundColor).multiplyScalar(tt),n.hemi[M]=G,M++}}n.ambient[0]=h,n.ambient[1]=f,n.ambient[2]=d;var C=n.hash;(C.directionalLength!==b||C.pointLength!==v||C.spotLength!==x||C.rectAreaLength!==w||C.hemiLength!==M||C.numDirectionalShadows!==E||C.numPointShadows!==D||C.numSpotShadows!==N)&&(n.directional.length=b,n.spot.length=x,n.rectArea.length=w,n.point.length=v,n.hemi.length=M,n.directionalShadowMap.length=E,n.pointShadowMap.length=D,n.spotShadowMap.length=N,n.directionalShadowMatrix.length=E,n.pointShadowMatrix.length=D,n.spotShadowMatrix.length=N,C.directionalLength=b,C.pointLength=v,C.spotLength=x,C.rectAreaLength=w,C.hemiLength=M,C.numDirectionalShadows=E,C.numPointShadows=D,C.numSpotShadows=N,n.version=LD++)}return{setup:o,state:n}}function _2(){var t=new FD,n=[],e=[];function i(){n.length=0,e.length=0}function s(u){n.push(u)}function a(u){e.push(u)}function o(u){t.setup(n,e,u)}var r={lightsArray:n,shadowsArray:e,lights:t};return{init:i,state:r,setupLights:o,pushLight:s,pushShadow:a}}function ND(){var t=new WeakMap;function n(s){var a=s.target;a.removeEventListener("dispose",n),t.delete(a)}function e(s,a){var o;return t.has(s)===!1?(o=new _2,t.set(s,new WeakMap),t.get(s).set(a,o),s.addEventListener("dispose",n)):t.get(s).has(a)===!1?(o=new _2,t.get(s).set(a,o)):o=t.get(s).get(a),o}function i(){t=new WeakMap}return{get:e,dispose:i}}function Xl(t){er.call(this),this.type="MeshDepthMaterial",this.depthPacking=kC,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}Xl.prototype=Object.create(er.prototype),Xl.prototype.constructor=Xl,Xl.prototype.isMeshDepthMaterial=!0,Xl.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this};function Yl(t){er.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new oe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Yl.prototype=Object.create(er.prototype),Yl.prototype.constructor=Yl,Yl.prototype.isMeshDistanceMaterial=!0,Yl.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var OD=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,zD=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function w2(t,n,e){var i=new wd,s=new on,a=new on,o=new Or,r=[],u=[],l={},h={0:Si,1:Zc,2:id},f=new go({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new on},radius:{value:4}},vertexShader:zD,fragmentShader:OD}),d=f.clone();d.defines.HORIZONAL_PASS=1;var p=new Un;p.setAttribute("position",new nr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new $r(p,f),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p_,this.render=function(N,V,K){if(v.enabled!==!1&&!(v.autoUpdate===!1&&v.needsUpdate===!1)&&N.length!==0){var j=t.getRenderTarget(),Z=t.getActiveCubeFace(),tt=t.getActiveMipmapLevel(),rt=t.state;rt.setBlending(Ua),rt.buffers.color.setClear(1,1,1,1),rt.buffers.depth.setTest(!0),rt.setScissorTest(!1);for(var J=0,U=N.length;J<U;J++){var G=N[J],I=G.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",G,"has no shadow.");continue}s.copy(I.mapSize);var C=I.getFrameExtents();if(s.multiply(C),a.copy(I.mapSize),(s.x>e||s.y>e)&&(console.warn("THREE.WebGLShadowMap:",G,"has shadow exceeding max texture size, reducing"),s.x>e&&(a.x=Math.floor(e/C.x),s.x=a.x*C.x,I.mapSize.x=a.x),s.y>e&&(a.y=Math.floor(e/C.y),s.y=a.y*C.y,I.mapSize.y=a.y)),I.map===null&&!I.isPointLightShadow&&this.type===rd){var L={minFilter:pi,magFilter:pi,format:as};I.map=new to(s.x,s.y,L),I.map.texture.name=G.name+".shadowMap",I.mapPass=new to(s.x,s.y,L),I.camera.updateProjectionMatrix()}if(I.map===null){var L={minFilter:li,magFilter:li,format:as};I.map=new to(s.x,s.y,L),I.map.texture.name=G.name+".shadowMap",I.camera.updateProjectionMatrix()}t.setRenderTarget(I.map),t.clear();for(var B=I.getViewportCount(),O=0;O<B;O++){var q=I.getViewport(O);o.set(a.x*q.x,a.y*q.y,a.x*q.z,a.y*q.w),rt.viewport(o),I.updateMatrices(G,O),i=I.getFrustum(),D(V,K,I.camera,G,this.type)}!I.isPointLightShadow&&this.type===rd&&x(I,K)}v.needsUpdate=!1,t.setRenderTarget(j,Z,tt)}};function x(N,V){var K=n.update(b);f.uniforms.shadow_pass.value=N.map.texture,f.uniforms.resolution.value=N.mapSize,f.uniforms.radius.value=N.radius,t.setRenderTarget(N.mapPass),t.clear(),t.renderBufferDirect(V,null,K,f,b,null),d.uniforms.shadow_pass.value=N.mapPass.texture,d.uniforms.resolution.value=N.mapSize,d.uniforms.radius.value=N.radius,t.setRenderTarget(N.map),t.clear(),t.renderBufferDirect(V,null,K,d,b,null)}function w(N,V,K){var j=N<<0|V<<1|K<<2,Z=r[j];return Z===void 0&&(Z=new Xl({depthPacking:IC,morphTargets:N,skinning:V}),r[j]=Z),Z}function M(N,V,K){var j=N<<0|V<<1|K<<2,Z=u[j];return Z===void 0&&(Z=new Yl({morphTargets:N,skinning:V}),u[j]=Z),Z}function E(N,V,K,j,Z,tt){var rt=N.geometry,J=null,U=w,G=N.customDepthMaterial;if(K.isPointLight===!0&&(U=M,G=N.customDistanceMaterial),G===void 0){var I=!1;V.morphTargets===!0&&(rt.isBufferGeometry===!0?I=rt.morphAttributes&&rt.morphAttributes.position&&rt.morphAttributes.position.length>0:rt.isGeometry===!0&&(I=rt.morphTargets&&rt.morphTargets.length>0));var C=!1;N.isSkinnedMesh===!0&&(V.skinning===!0?C=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",N));var L=N.isInstancedMesh===!0;J=U(I,C,L)}else J=G;if(t.localClippingEnabled&&V.clipShadows===!0&&V.clippingPlanes.length!==0){var B=J.uuid,O=V.uuid,q=l[B];q===void 0&&(q={},l[B]=q);var it=q[O];it===void 0&&(it=J.clone(),q[O]=it),J=it}return J.visible=V.visible,J.wireframe=V.wireframe,tt===rd?J.side=V.shadowSide!==null?V.shadowSide:V.side:J.side=V.shadowSide!==null?V.shadowSide:h[V.side],J.clipShadows=V.clipShadows,J.clippingPlanes=V.clippingPlanes,J.clipIntersection=V.clipIntersection,J.wireframeLinewidth=V.wireframeLinewidth,J.linewidth=V.linewidth,K.isPointLight===!0&&J.isMeshDistanceMaterial===!0&&(J.referencePosition.setFromMatrixPosition(K.matrixWorld),J.nearDistance=j,J.farDistance=Z),J}function D(N,V,K,j,Z){if(N.visible!==!1){var tt=N.layers.test(V.layers);if(tt&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&Z===rd)&&(!N.frustumCulled||i.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(K.matrixWorldInverse,N.matrixWorld);var rt=n.update(N),J=N.material;if(Array.isArray(J))for(var U=rt.groups,G=0,I=U.length;G<I;G++){var C=U[G],L=J[C.materialIndex];if(L&&L.visible){var B=E(N,L,j,K.near,K.far,Z);t.renderBufferDirect(K,null,rt,B,N,C)}}else if(J.visible){var B=E(N,J,j,K.near,K.far,Z);t.renderBufferDirect(K,null,rt,B,N,null)}}for(var O=N.children,q=0,it=O.length;q<it;q++)D(O[q],V,K,j,Z)}}}function UD(t,n,e){var i=e.isWebGL2;function s(){var le=!1,Fe=new Or,Ke=null,Ze=new Or(0,0,0,0);return{setMask:function(ke){Ke!==ke&&!le&&(t.colorMask(ke,ke,ke,ke),Ke=ke)},setLocked:function(ke){le=ke},setClear:function(ke,Qe,hn,ln,Hn){Hn===!0&&(ke*=ln,Qe*=ln,hn*=ln),Fe.set(ke,Qe,hn,ln),Ze.equals(Fe)===!1&&(t.clearColor(ke,Qe,hn,ln),Ze.copy(Fe))},reset:function(){le=!1,Ke=null,Ze.set(-1,0,0,0)}}}function a(){var le=!1,Fe=null,Ke=null,Ze=null;return{setTest:function(ke){ke?Y(2929):H(2929)},setMask:function(ke){Fe!==ke&&!le&&(t.depthMask(ke),Fe=ke)},setFunc:function(ke){if(Ke!==ke){if(ke)switch(ke){case FT:t.depthFunc(512);break;case NT:t.depthFunc(519);break;case OT:t.depthFunc(513);break;case V1:t.depthFunc(515);break;case zT:t.depthFunc(514);break;case UT:t.depthFunc(518);break;case VT:t.depthFunc(516);break;case jT:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);Ke=ke}},setLocked:function(ke){le=ke},setClear:function(ke){Ze!==ke&&(t.clearDepth(ke),Ze=ke)},reset:function(){le=!1,Fe=null,Ke=null,Ze=null}}}function o(){var le=!1,Fe=null,Ke=null,Ze=null,ke=null,Qe=null,hn=null,ln=null,Hn=null;return{setTest:function(Tn){le||(Tn?Y(2960):H(2960))},setMask:function(Tn){Fe!==Tn&&!le&&(t.stencilMask(Tn),Fe=Tn)},setFunc:function(Tn,Sn,On){(Ke!==Tn||Ze!==Sn||ke!==On)&&(t.stencilFunc(Tn,Sn,On),Ke=Tn,Ze=Sn,ke=On)},setOp:function(Tn,Sn,On){(Qe!==Tn||hn!==Sn||ln!==On)&&(t.stencilOp(Tn,Sn,On),Qe=Tn,hn=Sn,ln=On)},setLocked:function(Tn){le=Tn},setClear:function(Tn){Hn!==Tn&&(t.clearStencil(Tn),Hn=Tn)},reset:function(){le=!1,Fe=null,Ke=null,Ze=null,ke=null,Qe=null,hn=null,ln=null,Hn=null}}}var r=new s,u=new a,l=new o,h=t.getParameter(34921),f=new Uint8Array(h),d=new Uint8Array(h),p=new Uint8Array(h),b={},v=null,x=null,w=null,M=null,E=null,D=null,N=null,V=null,K=null,j=!1,Z=null,tt=null,rt=null,J=null,U=null,G=t.getParameter(35661),I=!1,C=0,L=t.getParameter(7938);L.indexOf("WebGL")!==-1?(C=parseFloat(/^WebGL\ ([0-9])/.exec(L)[1]),I=C>=1):L.indexOf("OpenGL ES")!==-1&&(C=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(L)[1]),I=C>=2);var B=null,O={},q=new Or,it=new Or;function nt(le,Fe,Ke){var Ze=new Uint8Array(4),ke=t.createTexture();t.bindTexture(le,ke),t.texParameteri(le,10241,9728),t.texParameteri(le,10240,9728);for(var Qe=0;Qe<Ke;Qe++)t.texImage2D(Fe+Qe,0,6408,1,1,0,6408,5121,Ze);return ke}var lt={};lt[3553]=nt(3553,3553,1),lt[34067]=nt(34067,34069,6),r.setClear(0,0,0,1),u.setClear(1),l.setClear(0),Y(2929),u.setFunc(V1),te(!1),mt(f_),Y(2884),Dt(Ua);function ut(){for(var le=0,Fe=f.length;le<Fe;le++)f[le]=0}function vt(le){Q(le,0)}function Q(le,Fe){if(f[le]=1,d[le]===0&&(t.enableVertexAttribArray(le),d[le]=1),p[le]!==Fe){var Ke=i?t:n.get("ANGLE_instanced_arrays");Ke[i?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](le,Fe),p[le]=Fe}}function gt(){for(var le=0,Fe=d.length;le!==Fe;++le)d[le]!==f[le]&&(t.disableVertexAttribArray(le),d[le]=0)}function Y(le){b[le]!==!0&&(t.enable(le),b[le]=!0)}function H(le){b[le]!==!1&&(t.disable(le),b[le]=!1)}function at(le){return v!==le?(t.useProgram(le),v=le,!0):!1}var ft={[$c]:32774,[ST]:32778,[ET]:32779};if(i)ft[x_]=32775,ft[__]=32776;else{var wt=n.get("EXT_blend_minmax");wt!==null&&(ft[x_]=wt.MIN_EXT,ft[__]=wt.MAX_EXT)}var _t={[TT]:0,[CT]:1,[PT]:768,[w_]:770,[BT]:776,[IT]:774,[RT]:772,[DT]:769,[M_]:771,[LT]:775,[kT]:773};function Dt(le,Fe,Ke,Ze,ke,Qe,hn,ln){if(le===Ua){x&&(H(3042),x=!1);return}if(x||(Y(3042),x=!0),le!==AT){if(le!==w||ln!==j){if((M!==$c||N!==$c)&&(t.blendEquation(32774),M=$c,N=$c),ln)switch(le){case od:t.blendFuncSeparate(1,771,1,771);break;case y_:t.blendFunc(1,1);break;case b_:t.blendFuncSeparate(0,0,769,771);break;case v_:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",le);break}else switch(le){case od:t.blendFuncSeparate(770,771,1,771);break;case y_:t.blendFunc(770,1);break;case b_:t.blendFunc(0,769);break;case v_:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",le);break}E=null,D=null,V=null,K=null,w=le,j=ln}return}ke=ke||Fe,Qe=Qe||Ke,hn=hn||Ze,(Fe!==M||ke!==N)&&(t.blendEquationSeparate(ft[Fe],ft[ke]),M=Fe,N=ke),(Ke!==E||Ze!==D||Qe!==V||hn!==K)&&(t.blendFuncSeparate(_t[Ke],_t[Ze],_t[Qe],_t[hn]),E=Ke,D=Ze,V=Qe,K=hn),w=le,j=null}function Gt(le,Fe){le.side===id?H(2884):Y(2884);var Ke=le.side===Si;Fe&&(Ke=!Ke),te(Ke),le.blending===od&&le.transparent===!1?Dt(Ua):Dt(le.blending,le.blendEquation,le.blendSrc,le.blendDst,le.blendEquationAlpha,le.blendSrcAlpha,le.blendDstAlpha,le.premultipliedAlpha),u.setFunc(le.depthFunc),u.setTest(le.depthTest),u.setMask(le.depthWrite),r.setMask(le.colorWrite);var Ze=le.stencilWrite;l.setTest(Ze),Ze&&(l.setMask(le.stencilWriteMask),l.setFunc(le.stencilFunc,le.stencilRef,le.stencilFuncMask),l.setOp(le.stencilFail,le.stencilZFail,le.stencilZPass)),Ot(le.polygonOffset,le.polygonOffsetFactor,le.polygonOffsetUnits)}function te(le){Z!==le&&(le?t.frontFace(2304):t.frontFace(2305),Z=le)}function mt(le){le!==xT?(Y(2884),le!==tt&&(le===f_?t.cullFace(1029):le===_T?t.cullFace(1028):t.cullFace(1032))):H(2884),tt=le}function At(le){le!==rt&&(I&&t.lineWidth(le),rt=le)}function Ot(le,Fe,Ke){le?(Y(32823),(J!==Fe||U!==Ke)&&(t.polygonOffset(Fe,Ke),J=Fe,U=Ke)):H(32823)}function Zt(le){le?Y(3089):H(3089)}function he(le){le===void 0&&(le=33984+G-1),B!==le&&(t.activeTexture(le),B=le)}function fe(le,Fe){B===null&&he();var Ke=O[B];Ke===void 0&&(Ke={type:void 0,texture:void 0},O[B]=Ke),(Ke.type!==le||Ke.texture!==Fe)&&(t.bindTexture(le,Fe||lt[le]),Ke.type=le,Ke.texture=Fe)}function be(){var le=O[B];le!==void 0&&le.type!==void 0&&(t.bindTexture(le.type,null),le.type=void 0,le.texture=void 0)}function Me(){try{t.compressedTexImage2D.apply(t,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Pe(){try{t.texImage2D.apply(t,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function ze(){try{t.texImage3D.apply(t,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Ce(le){q.equals(le)===!1&&(t.scissor(le.x,le.y,le.z,le.w),q.copy(le))}function Le(le){it.equals(le)===!1&&(t.viewport(le.x,le.y,le.z,le.w),it.copy(le))}function Ye(){for(var le=0;le<d.length;le++)d[le]===1&&(t.disableVertexAttribArray(le),d[le]=0);b={},B=null,O={},v=null,w=null,Z=null,tt=null,r.reset(),u.reset(),l.reset()}return{buffers:{color:r,depth:u,stencil:l},initAttributes:ut,enableAttribute:vt,enableAttributeAndDivisor:Q,disableUnusedAttributes:gt,enable:Y,disable:H,useProgram:at,setBlending:Dt,setMaterial:Gt,setFlipSided:te,setCullFace:mt,setLineWidth:At,setPolygonOffset:Ot,setScissorTest:Zt,activeTexture:he,bindTexture:fe,unbindTexture:be,compressedTexImage2D:Me,texImage2D:Pe,texImage3D:ze,scissor:Ce,viewport:Le,reset:Ye}}function VD(t,n,e,i,s,a,o){var r=s.isWebGL2,u=s.maxTextures,l=s.maxCubemapSize,h=s.maxTextureSize,f=s.maxSamples,d=new WeakMap,p,b=!1;try{b=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(mt){}function v(mt,At){return b?new OffscreenCanvas(mt,At):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function x(mt,At,Ot,Zt){var he=1;if((mt.width>Zt||mt.height>Zt)&&(he=Zt/Math.max(mt.width,mt.height)),he<1||At===!0)if(typeof HTMLImageElement!="undefined"&&mt instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&mt instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&mt instanceof ImageBitmap){var fe=At?pr.floorPowerOfTwo:Math.floor,be=fe(he*mt.width),Me=fe(he*mt.height);p===void 0&&(p=v(be,Me));var Pe=Ot?v(be,Me):p;Pe.width=be,Pe.height=Me;var ze=Pe.getContext("2d");return ze.drawImage(mt,0,0,be,Me),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+mt.width+"x"+mt.height+") to ("+be+"x"+Me+")."),Pe}else return"data"in mt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+mt.width+"x"+mt.height+")."),mt;return mt}function w(mt){return pr.isPowerOfTwo(mt.width)&&pr.isPowerOfTwo(mt.height)}function M(mt){return r?!1:mt.wrapS!==Qi||mt.wrapT!==Qi||mt.minFilter!==li&&mt.minFilter!==pi}function E(mt,At){return mt.generateMipmaps&&At&&mt.minFilter!==li&&mt.minFilter!==pi}function D(mt,At,Ot,Zt){t.generateMipmap(mt);var he=i.get(At);he.__maxMipLevel=Math.log(Math.max(Ot,Zt))*Math.LOG2E}function N(mt,At,Ot){if(r===!1)return At;if(mt!==null){if(t[mt]!==void 0)return t[mt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+mt+"'")}var Zt=At;return At===6403&&(Ot===5126&&(Zt=33326),Ot===5131&&(Zt=33325),Ot===5121&&(Zt=33321)),At===6407&&(Ot===5126&&(Zt=34837),Ot===5131&&(Zt=34843),Ot===5121&&(Zt=32849)),At===6408&&(Ot===5126&&(Zt=34836),Ot===5131&&(Zt=34842),Ot===5121&&(Zt=32856)),Zt===33325||Zt===33326||Zt===34842||Zt===34836?n.get("EXT_color_buffer_float"):(Zt===34843||Zt===34837)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),Zt}function V(mt){return mt===li||mt===Jp||mt===$p?9728:9729}function K(mt){var At=mt.target;At.removeEventListener("dispose",K),Z(At),At.isVideoTexture&&d.delete(At),o.memory.textures--}function j(mt){var At=mt.target;At.removeEventListener("dispose",j),tt(At),o.memory.textures--}function Z(mt){var At=i.get(mt);At.__webglInit!==void 0&&(t.deleteTexture(At.__webglTexture),i.remove(mt))}function tt(mt){var At=i.get(mt),Ot=i.get(mt.texture);if(mt){if(Ot.__webglTexture!==void 0&&t.deleteTexture(Ot.__webglTexture),mt.depthTexture&&mt.depthTexture.dispose(),mt.isWebGLCubeRenderTarget)for(var Zt=0;Zt<6;Zt++)t.deleteFramebuffer(At.__webglFramebuffer[Zt]),At.__webglDepthbuffer&&t.deleteRenderbuffer(At.__webglDepthbuffer[Zt]);else t.deleteFramebuffer(At.__webglFramebuffer),At.__webglDepthbuffer&&t.deleteRenderbuffer(At.__webglDepthbuffer);if(mt.isWebGLMultiviewRenderTarget){t.deleteTexture(At.__webglColorTexture),t.deleteTexture(At.__webglDepthStencilTexture),o.memory.textures-=2;for(var Zt=0,he=At.__webglViewFramebuffers.length;Zt<he;Zt++)t.deleteFramebuffer(At.__webglViewFramebuffers[Zt])}i.remove(mt.texture),i.remove(mt)}}var rt=0;function J(){rt=0}function U(){var mt=rt;return mt>=u&&console.warn("THREE.WebGLTextures: Trying to use "+mt+" texture units while this GPU supports only "+u),rt+=1,mt}function G(mt,At){var Ot=i.get(mt);if(mt.isVideoTexture&&wt(mt),mt.version>0&&Ot.__version!==mt.version){var Zt=mt.image;if(Zt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Zt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{lt(Ot,mt,At);return}}e.activeTexture(33984+At),e.bindTexture(3553,Ot.__webglTexture)}function I(mt,At){var Ot=i.get(mt);if(mt.version>0&&Ot.__version!==mt.version){lt(Ot,mt,At);return}e.activeTexture(33984+At),e.bindTexture(35866,Ot.__webglTexture)}function C(mt,At){var Ot=i.get(mt);if(mt.version>0&&Ot.__version!==mt.version){lt(Ot,mt,At);return}e.activeTexture(33984+At),e.bindTexture(32879,Ot.__webglTexture)}function L(mt,At){if(mt.image.length===6){var Ot=i.get(mt);if(mt.version>0&&Ot.__version!==mt.version){nt(Ot,mt),e.activeTexture(33984+At),e.bindTexture(34067,Ot.__webglTexture),t.pixelStorei(37440,mt.flipY);for(var Zt=mt&&(mt.isCompressedTexture||mt.image[0].isCompressedTexture),he=mt.image[0]&&mt.image[0].isDataTexture,fe=[],be=0;be<6;be++)!Zt&&!he?fe[be]=x(mt.image[be],!1,!0,l):fe[be]=he?mt.image[be].image:mt.image[be];var Me=fe[0],Pe=w(Me)||r,ze=a.convert(mt.format),Ce=a.convert(mt.type),Le=N(mt.internalFormat,ze,Ce);it(34067,mt,Pe);var Ye;if(Zt){for(var be=0;be<6;be++){Ye=fe[be].mipmaps;for(var le=0;le<Ye.length;le++){var Fe=Ye[le];mt.format!==as&&mt.format!==oa?ze!==null?e.compressedTexImage2D(34069+be,le,Le,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):e.texImage2D(34069+be,le,Le,Fe.width,Fe.height,0,ze,Ce,Fe.data)}}Ot.__maxMipLevel=Ye.length-1}else{Ye=mt.mipmaps;for(var be=0;be<6;be++)if(he){e.texImage2D(34069+be,0,Le,fe[be].width,fe[be].height,0,ze,Ce,fe[be].data);for(var le=0;le<Ye.length;le++){var Fe=Ye[le],Ke=Fe.image[be].image;e.texImage2D(34069+be,le+1,Le,Ke.width,Ke.height,0,ze,Ce,Ke.data)}}else{e.texImage2D(34069+be,0,Le,ze,Ce,fe[be]);for(var le=0;le<Ye.length;le++){var Fe=Ye[le];e.texImage2D(34069+be,le+1,Le,ze,Ce,Fe.image[be])}}Ot.__maxMipLevel=Ye.length}E(mt,Pe)&&D(34067,mt,Me.width,Me.height),Ot.__version=mt.version,mt.onUpdate&&mt.onUpdate(mt)}else e.activeTexture(33984+At),e.bindTexture(34067,Ot.__webglTexture)}}function B(mt,At){e.activeTexture(33984+At),e.bindTexture(34067,i.get(mt).__webglTexture)}var O={[Ol]:10497,[Qi]:33071,[ad]:33648},q={[li]:9728,[Jp]:9984,[$p]:9986,[pi]:9729,[Y1]:9985,[Qc]:9987};function it(mt,At,Ot){Ot?(t.texParameteri(mt,10242,O[At.wrapS]),t.texParameteri(mt,10243,O[At.wrapT]),(mt===32879||mt===35866)&&t.texParameteri(mt,32882,O[At.wrapR]),t.texParameteri(mt,10240,q[At.magFilter]),t.texParameteri(mt,10241,q[At.minFilter])):(t.texParameteri(mt,10242,33071),t.texParameteri(mt,10243,33071),(mt===32879||mt===35866)&&t.texParameteri(mt,32882,33071),(At.wrapS!==Qi||At.wrapT!==Qi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(mt,10240,V(At.magFilter)),t.texParameteri(mt,10241,V(At.minFilter)),At.minFilter!==li&&At.minFilter!==pi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var Zt=n.get("EXT_texture_filter_anisotropic");if(Zt){if(At.type===ld&&n.get("OES_texture_float_linear")===null||At.type===K1&&(r||n.get("OES_texture_half_float_linear"))===null)return;(At.anisotropy>1||i.get(At).__currentAnisotropy)&&(t.texParameterf(mt,Zt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(At.anisotropy,s.getMaxAnisotropy())),i.get(At).__currentAnisotropy=At.anisotropy)}}function nt(mt,At){mt.__webglInit===void 0&&(mt.__webglInit=!0,At.addEventListener("dispose",K),mt.__webglTexture=t.createTexture(),o.memory.textures++)}function lt(mt,At,Ot){var Zt=3553;At.isDataTexture2DArray&&(Zt=35866),At.isDataTexture3D&&(Zt=32879),nt(mt,At),e.activeTexture(33984+Ot),e.bindTexture(Zt,mt.__webglTexture),t.pixelStorei(37440,At.flipY),t.pixelStorei(37441,At.premultiplyAlpha),t.pixelStorei(3317,At.unpackAlignment);var he=M(At)&&w(At.image)===!1,fe=x(At.image,he,!1,h),be=w(fe)||r,Me=a.convert(At.format),Pe=a.convert(At.type),ze=N(At.internalFormat,Me,Pe);it(Zt,At,be);var Ce,Le=At.mipmaps;if(At.isDepthTexture){if(ze=6402,At.type===ld){if(r===!1)throw new Error("Float Depth Texture only supported in WebGL2.0");ze=36012}else r&&(ze=33189);At.format===tu&&ze===6402&&At.type!==tm&&At.type!==E_&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),At.type=tm,Pe=a.convert(At.type)),At.format===cd&&(ze=34041,At.type!==em&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),At.type=em,Pe=a.convert(At.type))),e.texImage2D(3553,0,ze,fe.width,fe.height,0,Me,Pe,null)}else if(At.isDataTexture)if(Le.length>0&&be){for(var Ye=0,le=Le.length;Ye<le;Ye++)Ce=Le[Ye],e.texImage2D(3553,Ye,ze,Ce.width,Ce.height,0,Me,Pe,Ce.data);At.generateMipmaps=!1,mt.__maxMipLevel=Le.length-1}else e.texImage2D(3553,0,ze,fe.width,fe.height,0,Me,Pe,fe.data),mt.__maxMipLevel=0;else if(At.isCompressedTexture){for(var Ye=0,le=Le.length;Ye<le;Ye++)Ce=Le[Ye],At.format!==as&&At.format!==oa?Me!==null?e.compressedTexImage2D(3553,Ye,ze,Ce.width,Ce.height,0,Ce.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):e.texImage2D(3553,Ye,ze,Ce.width,Ce.height,0,Me,Pe,Ce.data);mt.__maxMipLevel=Le.length-1}else if(At.isDataTexture2DArray)e.texImage3D(35866,0,ze,fe.width,fe.height,fe.depth,0,Me,Pe,fe.data),mt.__maxMipLevel=0;else if(At.isDataTexture3D)e.texImage3D(32879,0,ze,fe.width,fe.height,fe.depth,0,Me,Pe,fe.data),mt.__maxMipLevel=0;else if(Le.length>0&&be){for(var Ye=0,le=Le.length;Ye<le;Ye++)Ce=Le[Ye],e.texImage2D(3553,Ye,ze,Me,Pe,Ce);At.generateMipmaps=!1,mt.__maxMipLevel=Le.length-1}else e.texImage2D(3553,0,ze,Me,Pe,fe),mt.__maxMipLevel=0;E(At,be)&&D(Zt,At,fe.width,fe.height),mt.__version=At.version,At.onUpdate&&At.onUpdate(At)}function ut(mt,At,Ot,Zt){var he=a.convert(At.texture.format),fe=a.convert(At.texture.type),be=N(At.texture.internalFormat,he,fe);e.texImage2D(Zt,0,be,At.width,At.height,0,he,fe,null),t.bindFramebuffer(36160,mt),t.framebufferTexture2D(36160,Ot,Zt,i.get(At.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function vt(mt,At,Ot){if(t.bindRenderbuffer(36161,mt),At.depthBuffer&&!At.stencilBuffer){if(Ot){var Zt=ft(At);t.renderbufferStorageMultisample(36161,Zt,33189,At.width,At.height)}else t.renderbufferStorage(36161,33189,At.width,At.height);t.framebufferRenderbuffer(36160,36096,36161,mt)}else if(At.depthBuffer&&At.stencilBuffer){if(Ot){var Zt=ft(At);t.renderbufferStorageMultisample(36161,Zt,35056,At.width,At.height)}else t.renderbufferStorage(36161,34041,At.width,At.height);t.framebufferRenderbuffer(36160,33306,36161,mt)}else{var he=a.convert(At.texture.format),fe=a.convert(At.texture.type),be=N(At.texture.internalFormat,he,fe);if(Ot){var Zt=ft(At);t.renderbufferStorageMultisample(36161,Zt,be,At.width,At.height)}else t.renderbufferStorage(36161,be,At.width,At.height)}t.bindRenderbuffer(36161,null)}function Q(mt,At){var Ot=At&&At.isWebGLCubeRenderTarget;if(Ot)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,mt),!(At.depthTexture&&At.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(At.depthTexture).__webglTexture||At.depthTexture.image.width!==At.width||At.depthTexture.image.height!==At.height)&&(At.depthTexture.image.width=At.width,At.depthTexture.image.height=At.height,At.depthTexture.needsUpdate=!0),G(At.depthTexture,0);var Zt=i.get(At.depthTexture).__webglTexture;if(At.depthTexture.format===tu)t.framebufferTexture2D(36160,36096,3553,Zt,0);else if(At.depthTexture.format===cd)t.framebufferTexture2D(36160,33306,3553,Zt,0);else throw new Error("Unknown depthTexture format")}function gt(mt){var At=i.get(mt),Ot=mt.isWebGLCubeRenderTarget===!0;if(mt.depthTexture){if(Ot)throw new Error("target.depthTexture not supported in Cube render targets");Q(At.__webglFramebuffer,mt)}else if(Ot){At.__webglDepthbuffer=[];for(var Zt=0;Zt<6;Zt++)t.bindFramebuffer(36160,At.__webglFramebuffer[Zt]),At.__webglDepthbuffer[Zt]=t.createRenderbuffer(),vt(At.__webglDepthbuffer[Zt],mt)}else t.bindFramebuffer(36160,At.__webglFramebuffer),At.__webglDepthbuffer=t.createRenderbuffer(),vt(At.__webglDepthbuffer,mt);t.bindFramebuffer(36160,null)}function Y(mt){var At=i.get(mt),Ot=i.get(mt.texture);mt.addEventListener("dispose",j),Ot.__webglTexture=t.createTexture(),o.memory.textures++;var Zt=mt.isWebGLCubeRenderTarget===!0,he=mt.isWebGLMultisampleRenderTarget===!0,fe=mt.isWebGLMultiviewRenderTarget===!0,be=w(mt)||r;if(Zt){At.__webglFramebuffer=[];for(var Me=0;Me<6;Me++)At.__webglFramebuffer[Me]=t.createFramebuffer()}else if(At.__webglFramebuffer=t.createFramebuffer(),he)if(r){At.__webglMultisampledFramebuffer=t.createFramebuffer(),At.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,At.__webglColorRenderbuffer);var Pe=a.convert(mt.texture.format),ze=a.convert(mt.texture.type),Ce=N(mt.texture.internalFormat,Pe,ze),Le=ft(mt);t.renderbufferStorageMultisample(36161,Le,Ce,mt.width,mt.height),t.bindFramebuffer(36160,At.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,At.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),mt.depthBuffer&&(At.__webglDepthRenderbuffer=t.createRenderbuffer(),vt(At.__webglDepthRenderbuffer,mt,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(fe){var Ye=mt.width,le=mt.height,Fe=mt.numViews;t.bindFramebuffer(36160,At.__webglFramebuffer);var Ke=n.get("OVR_multiview2");o.memory.textures+=2;var Ze=t.createTexture();t.bindTexture(35866,Ze),t.texParameteri(35866,10240,9728),t.texParameteri(35866,10241,9728),t.texImage3D(35866,0,32856,Ye,le,Fe,0,6408,5121,null),Ke.framebufferTextureMultiviewOVR(36160,36064,Ze,0,0,Fe);var ke=t.createTexture();t.bindTexture(35866,ke),t.texParameteri(35866,10240,9728),t.texParameteri(35866,10241,9728),t.texImage3D(35866,0,35056,Ye,le,Fe,0,34041,34042,null),Ke.framebufferTextureMultiviewOVR(36160,33306,ke,0,0,Fe);for(var Qe=new Array(Fe),Me=0;Me<Fe;++Me)Qe[Me]=t.createFramebuffer(),t.bindFramebuffer(36160,Qe[Me]),t.framebufferTextureLayer(36160,36064,Ze,0,Me);At.__webglColorTexture=Ze,At.__webglDepthStencilTexture=ke,At.__webglViewFramebuffers=Qe,t.bindFramebuffer(36160,null),t.bindTexture(35866,null)}if(Zt){e.bindTexture(34067,Ot.__webglTexture),it(34067,mt.texture,be);for(var Me=0;Me<6;Me++)ut(At.__webglFramebuffer[Me],mt,36064,34069+Me);E(mt.texture,be)&&D(34067,mt.texture,mt.width,mt.height),e.bindTexture(34067,null)}else fe||(e.bindTexture(3553,Ot.__webglTexture),it(3553,mt.texture,be),ut(At.__webglFramebuffer,mt,36064,3553),E(mt.texture,be)&&D(3553,mt.texture,mt.width,mt.height),e.bindTexture(3553,null));mt.depthBuffer&&gt(mt)}function H(mt){var At=mt.texture,Ot=w(mt)||r;if(E(At,Ot)){var Zt=mt.isWebGLCubeRenderTarget?34067:3553,he=i.get(At).__webglTexture;e.bindTexture(Zt,he),D(Zt,At,mt.width,mt.height),e.bindTexture(Zt,null)}}function at(mt){if(mt.isWebGLMultisampleRenderTarget)if(r){var At=i.get(mt);t.bindFramebuffer(36008,At.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,At.__webglFramebuffer);var Ot=mt.width,Zt=mt.height,he=16384;mt.depthBuffer&&(he|=256),mt.stencilBuffer&&(he|=1024),t.blitFramebuffer(0,0,Ot,Zt,0,0,Ot,Zt,he,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ft(mt){return r&&mt.isWebGLMultisampleRenderTarget?Math.min(f,mt.samples):0}function wt(mt){var At=o.render.frame;d.get(mt)!==At&&(d.set(mt,At),mt.update())}var _t=!1,Dt=!1;function Gt(mt,At){mt&&mt.isWebGLRenderTarget&&(_t===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),_t=!0),mt=mt.texture),G(mt,At)}function te(mt,At){mt&&mt.isWebGLCubeRenderTarget&&(Dt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Dt=!0),mt=mt.texture),mt&&mt.isCubeTexture||Array.isArray(mt.image)&&mt.image.length===6?L(mt,At):B(mt,At)}this.allocateTextureUnit=U,this.resetTextureUnits=J,this.setTexture2D=G,this.setTexture2DArray=I,this.setTexture3D=C,this.setTextureCube=L,this.setTextureCubeDynamic=B,this.setupRenderTarget=Y,this.updateRenderTargetMipmap=H,this.updateMultisampleRenderTarget=at,this.safeSetTexture2D=Gt,this.safeSetTextureCube=te}function jD(t,n,e){var i=e.isWebGL2;function s(a){var o;if(a===Qp)return 5121;if(a===$T)return 32819;if(a===QT)return 32820;if(a===tC)return 33635;if(a===KT)return 5120;if(a===ZT)return 5122;if(a===tm)return 5123;if(a===JT)return 5124;if(a===E_)return 5125;if(a===ld)return 5126;if(a===K1)return i?5131:(o=n.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(a===eC)return 6406;if(a===oa)return 6407;if(a===as)return 6408;if(a===nC)return 6409;if(a===rC)return 6410;if(a===tu)return 6402;if(a===cd)return 34041;if(a===oC)return 6403;if(a===sC)return 36244;if(a===aC)return 33319;if(a===lC)return 33320;if(a===cC)return 36248;if(a===uC)return 36249;if(a===T_||a===C_||a===P_||a===D_)if(o=n.get("WEBGL_compressed_texture_s3tc"),o!==null){if(a===T_)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===C_)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===P_)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===D_)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===R_||a===k_||a===I_||a===L_)if(o=n.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(a===R_)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===k_)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===I_)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===L_)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===hC)return o=n.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===dC||a===fC||a===pC||a===mC||a===gC||a===yC||a===bC||a===vC||a===xC||a===_C||a===wC||a===MC||a===AC||a===SC)return o=n.get("WEBGL_compressed_texture_astc"),o!==null?a:null;if(a===em)return i?34042:(o=n.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:s}}function Ey(t,n,e,i){to.call(this,t,n,i),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=e}Ey.prototype=Object.assign(Object.create(to.prototype),{constructor:Ey,isWebGLMultiviewRenderTarget:!0,copy:function(t){return to.prototype.copy.call(this,t),this.numViews=t.numViews,this},setNumViews:function(t){return this.numViews!==t&&(this.numViews=t,this.dispose()),this}});function GD(t,n){var e=2,i=t.extensions,s=t.properties,a,o,r,u,l,h,f,d=0;function p(){if(f===void 0){var K=i.get("OVR_multiview2");if(f=K!==null&&n.getContextAttributes().antialias===!1,f){d=n.getParameter(K.MAX_VIEWS_OVR),a=new Ey(0,0,e),h=new on,u=[],r=[],l=[];for(var j=0;j<d;j++)u[j]=new mr,r[j]=new Vi}}return f}function b(K){return K.isArrayCamera?K.cameras:(l[0]=K,l)}function v(K,j){for(var Z=b(K),tt=0;tt<Z.length;tt++)u[tt].copy(Z[tt].projectionMatrix);j.setValue(n,"projectionMatrices",u)}function x(K,j){for(var Z=b(K),tt=0;tt<Z.length;tt++)u[tt].copy(Z[tt].matrixWorldInverse);j.setValue(n,"viewMatrices",u)}function w(K,j,Z){for(var tt=b(j),rt=0;rt<tt.length;rt++)u[rt].multiplyMatrices(tt[rt].matrixWorldInverse,K.matrixWorld),r[rt].getNormalMatrix(u[rt]);Z.setValue(n,"modelViewMatrices",u),Z.setValue(n,"normalMatrices",r)}function M(K){if(K.isArrayCamera===void 0)return!0;var j=K.cameras;if(j.length>d)return!1;for(var Z=1,tt=j.length;Z<tt;Z++)if(j[0].viewport.z!==j[Z].viewport.z||j[0].viewport.w!==j[Z].viewport.w)return!1;return!0}function E(K){if(o?h.set(o.width,o.height):t.getDrawingBufferSize(h),K.isArrayCamera){var j=K.cameras[0].viewport;a.setSize(j.z,j.w),a.setNumViews(K.cameras.length)}else a.setSize(h.x,h.y),a.setNumViews(e)}function D(K){M(K)!==!1&&(o=t.getRenderTarget(),E(K),t.setRenderTarget(a))}function N(K){a===t.getRenderTarget()&&(t.setRenderTarget(o),V(K))}function V(K){var j=a,Z=j.numViews,tt=s.get(j).__webglViewFramebuffers,rt=j.width,J=j.height;if(K.isArrayCamera)for(var U=0;U<Z;U++){var G=K.cameras[U].viewport,I=G.x,C=G.y,L=I+G.z,B=C+G.w;n.bindFramebuffer(36008,tt[U]),n.blitFramebuffer(0,0,rt,J,I,C,L,B,16384,9728)}else n.bindFramebuffer(36008,tt[0]),n.blitFramebuffer(0,0,rt,J,0,0,h.x,h.y,16384,9728)}this.isAvailable=p,this.attachCamera=D,this.detachCamera=N,this.updateCameraProjectionMatricesUniform=v,this.updateCameraViewMatricesUniform=x,this.updateObjectMatricesUniforms=w}function Ty(t){gi.call(this),this.cameras=t||[]}Ty.prototype=Object.assign(Object.create(gi.prototype),{constructor:Ty,isArrayCamera:!0});function Kl(){Rn.call(this),this.type="Group"}Kl.prototype=Object.assign(Object.create(Rn.prototype),{constructor:Kl,isGroup:!0});function M2(t,n){var e=this,i=null,s=null,a="local-floor",o=null,r=[],u=new Map,l=new gi;l.layers.enable(1),l.viewport=new Or;var h=new gi;h.layers.enable(2),h.viewport=new Or;var f=new Ty([l,h]);f.layers.enable(1),f.layers.enable(2);var d=null,p=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(Z){var tt=r[Z];return tt===void 0&&(tt={},r[Z]=tt),tt.targetRay===void 0&&(tt.targetRay=new Kl,tt.targetRay.matrixAutoUpdate=!1,tt.targetRay.visible=!1),tt.targetRay},this.getControllerGrip=function(Z){var tt=r[Z];return tt===void 0&&(tt={},r[Z]=tt),tt.grip===void 0&&(tt.grip=new Kl,tt.grip.matrixAutoUpdate=!1,tt.grip.visible=!1),tt.grip};function b(Z){var tt=u.get(Z.inputSource);tt&&(tt.targetRay&&tt.targetRay.dispatchEvent({type:Z.type}),tt.grip&&tt.grip.dispatchEvent({type:Z.type}))}function v(){u.forEach(function(Z,tt){Z.targetRay&&(Z.targetRay.dispatchEvent({type:"disconnected",data:tt}),Z.targetRay.visible=!1),Z.grip&&(Z.grip.dispatchEvent({type:"disconnected",data:tt}),Z.grip.visible=!1)}),u.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),j.stop(),e.isPresenting=!1,e.dispatchEvent({type:"sessionend"})}function x(Z){s=Z,j.setContext(i),j.start(),e.isPresenting=!0,e.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(Z){a=Z},this.getReferenceSpace=function(){return s},this.getSession=function(){return i},this.setSession=function(Z){if(i=Z,i!==null){i.addEventListener("select",b),i.addEventListener("selectstart",b),i.addEventListener("selectend",b),i.addEventListener("squeeze",b),i.addEventListener("squeezestart",b),i.addEventListener("squeezeend",b),i.addEventListener("end",v);var tt=n.getContextAttributes(),rt={antialias:tt.antialias,alpha:tt.alpha,depth:tt.depth,stencil:tt.stencil},J=new XRWebGLLayer(i,n,rt);i.updateRenderState({baseLayer:J}),i.requestReferenceSpace(a).then(x),i.addEventListener("inputsourceschange",w)}};function w(Z){for(var tt=i.inputSources,rt=0;rt<r.length;rt++)u.set(tt[rt],r[rt]);for(var rt=0;rt<Z.removed.length;rt++){var J=Z.removed[rt],U=u.get(J);U&&(U.targetRay&&U.targetRay.dispatchEvent({type:"disconnected",data:J}),U.grip&&U.grip.dispatchEvent({type:"disconnected",data:J}),u.delete(J))}for(var rt=0;rt<Z.added.length;rt++){var J=Z.added[rt],U=u.get(J);U&&(U.targetRay&&U.targetRay.dispatchEvent({type:"connected",data:J}),U.grip&&U.grip.dispatchEvent({type:"connected",data:J}))}}var M=new oe,E=new oe;function D(Z,tt,rt){M.setFromMatrixPosition(tt.matrixWorld),E.setFromMatrixPosition(rt.matrixWorld);var J=M.distanceTo(E),U=tt.projectionMatrix.elements,G=rt.projectionMatrix.elements,I=U[14]/(U[10]-1),C=U[14]/(U[10]+1),L=(U[9]+1)/U[5],B=(U[9]-1)/U[5],O=(U[8]-1)/U[0],q=(G[8]+1)/G[0],it=I*O,nt=I*q,lt=J/(-O+q),ut=lt*-O;tt.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Z.translateX(ut),Z.translateZ(lt),Z.matrixWorld.compose(Z.position,Z.quaternion,Z.scale),Z.matrixWorldInverse.getInverse(Z.matrixWorld);var vt=I+lt,Q=C+lt,gt=it-ut,Y=nt+(J-ut),H=L*C/Q*vt,at=B*C/Q*vt;Z.projectionMatrix.makePerspective(gt,Y,H,at,vt,Q)}function N(Z,tt){tt===null?Z.matrixWorld.copy(Z.matrix):Z.matrixWorld.multiplyMatrices(tt.matrixWorld,Z.matrix),Z.matrixWorldInverse.getInverse(Z.matrixWorld)}this.getCamera=function(Z){f.near=h.near=l.near=Z.near,f.far=h.far=l.far=Z.far,(d!==f.near||p!==f.far)&&(i.updateRenderState({depthNear:f.near,depthFar:f.far}),d=f.near,p=f.far);var tt=Z.parent,rt=f.cameras;N(f,tt);for(var J=0;J<rt.length;J++)N(rt[J],tt);Z.matrixWorld.copy(f.matrixWorld);for(var U=Z.children,J=0,G=U.length;J<G;J++)U[J].updateMatrixWorld(!0);return D(f,l,h),f};var V=null;function K(Z,tt){if(o=tt.getViewerPose(s),o!==null){var rt=o.views,J=i.renderState.baseLayer;t.setFramebuffer(J.framebuffer);for(var U=0;U<rt.length;U++){var G=rt[U],I=J.getViewport(G),C=f.cameras[U];C.matrix.fromArray(G.transform.matrix),C.projectionMatrix.fromArray(G.projectionMatrix),C.viewport.set(I.x,I.y,I.width,I.height),U===0&&f.matrix.copy(C.matrix)}}for(var L=i.inputSources,U=0;U<r.length;U++){var B=r[U],O=L[U],q=null,it=null;O&&(B.targetRay&&(q=tt.getPose(O.targetRaySpace,s),q!==null&&(B.targetRay.matrix.fromArray(q.transform.matrix),B.targetRay.matrix.decompose(B.targetRay.position,B.targetRay.rotation,B.targetRay.scale))),B.grip&&O.gripSpace&&(it=tt.getPose(O.gripSpace,s),it!==null&&(B.grip.matrix.fromArray(it.transform.matrix),B.grip.matrix.decompose(B.grip.position,B.grip.rotation,B.grip.scale)))),B.targetRay&&(B.targetRay.visible=q!==null),B.grip&&(B.grip.visible=it!==null)}V&&V(Z,tt)}var j=new e2;j.setAnimationLoop(K),this.setAnimationLoop=function(Z){V=Z},this.dispose=function(){}}Object.assign(M2.prototype,sa.prototype);function A2(t){t=t||{};var n=t.canvas!==void 0?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e=t.context!==void 0?t.context:null,i=t.alpha!==void 0?t.alpha:!1,s=t.depth!==void 0?t.depth:!0,a=t.stencil!==void 0?t.stencil:!0,o=t.antialias!==void 0?t.antialias:!1,r=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,u=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",h=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,f=null,d=null;this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Fo,this.physicallyCorrectLights=!1,this.toneMapping=j1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p=this,b=!1,v=null,x=0,w=0,M=null,E=null,D=-1,N={geometry:null,program:null,wireframe:!1},V=null,K=null,j=new Or,Z=new Or,tt=null,rt=n.width,J=n.height,U=1,G=null,I=null,C=new Or(0,0,rt,J),L=new Or(0,0,rt,J),B=!1,O=new wd,q=new M6,it=!1,nt=!1,lt=new mr,ut=new oe;function vt(){return M===null?U:1}var Q;try{var gt={alpha:i,depth:s,stencil:a,antialias:o,premultipliedAlpha:r,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:h,xrCompatible:!0};if(n.addEventListener("webglcontextlost",Ye,!1),n.addEventListener("webglcontextrestored",le,!1),Q=e||n.getContext("webgl",gt)||n.getContext("experimental-webgl",gt),Q===null)throw n.getContext("webgl")!==null?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Tt){throw console.error("THREE.WebGLRenderer: "+Tt.message),Tt}var Y,H,at,ft,wt,_t,Dt,Gt,te,mt,At,Ot,Zt,he,fe,be,Me;function Pe(){Y=new A6(Q),H=new w6(Q,Y,t),H.isWebGL2===!1&&(Y.get("WEBGL_depth_texture"),Y.get("OES_texture_float"),Y.get("OES_texture_half_float"),Y.get("OES_texture_half_float_linear"),Y.get("OES_standard_derivatives"),Y.get("OES_element_index_uint"),Y.get("ANGLE_instanced_arrays")),Y.get("OES_texture_float_linear"),Me=new jD(Q,Y,H),at=new UD(Q,Y,H),at.scissor(Z.copy(L).multiplyScalar(U).floor()),at.viewport(j.copy(C).multiplyScalar(U).floor()),ft=new T6,wt=new PD,_t=new VD(Q,Y,at,wt,H,Me,ft),Dt=new tP(Q,H),Gt=new S6(Q,Dt,ft),te=new D6(Q,Gt,Dt,ft),he=new P6(Q),mt=new CD(p,Y,H),At=new kD,Ot=new ND,Zt=new x6(p,at,te,r),fe=new _6(Q,Y,ft,H),be=new E6(Q,Y,ft,H),ft.programs=mt.programs,p.capabilities=H,p.extensions=Y,p.properties=wt,p.renderLists=At,p.state=at,p.info=ft}Pe();var ze=new M2(p,Q);this.xr=ze;var Ce=new GD(p,Q),Le=new w2(p,te,H.maxTextureSize);this.shadowMap=Le,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){var Tt=Y.get("WEBGL_lose_context");Tt&&Tt.loseContext()},this.forceContextRestore=function(){var Tt=Y.get("WEBGL_lose_context");Tt&&Tt.restoreContext()},this.getPixelRatio=function(){return U},this.setPixelRatio=function(Tt){Tt!==void 0&&(U=Tt,this.setSize(rt,J,!1))},this.getSize=function(Tt){return Tt===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Tt=new on),Tt.set(rt,J)},this.setSize=function(Tt,Lt,ee){if(ze.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}rt=Tt,J=Lt,n.width=Math.floor(Tt*U),n.height=Math.floor(Lt*U),ee!==!1&&(n.style.width=Tt+"px",n.style.height=Lt+"px"),this.setViewport(0,0,Tt,Lt)},this.getDrawingBufferSize=function(Tt){return Tt===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Tt=new on),Tt.set(rt*U,J*U).floor()},this.setDrawingBufferSize=function(Tt,Lt,ee){rt=Tt,J=Lt,U=ee,n.width=Math.floor(Tt*ee),n.height=Math.floor(Lt*ee),this.setViewport(0,0,Tt,Lt)},this.getCurrentViewport=function(Tt){return Tt===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Tt=new Or),Tt.copy(j)},this.getViewport=function(Tt){return Tt.copy(C)},this.setViewport=function(Tt,Lt,ee,Yt){Tt.isVector4?C.set(Tt.x,Tt.y,Tt.z,Tt.w):C.set(Tt,Lt,ee,Yt),at.viewport(j.copy(C).multiplyScalar(U).floor())},this.getScissor=function(Tt){return Tt.copy(L)},this.setScissor=function(Tt,Lt,ee,Yt){Tt.isVector4?L.set(Tt.x,Tt.y,Tt.z,Tt.w):L.set(Tt,Lt,ee,Yt),at.scissor(Z.copy(L).multiplyScalar(U).floor())},this.getScissorTest=function(){return B},this.setScissorTest=function(Tt){at.setScissorTest(B=Tt)},this.setOpaqueSort=function(Tt){G=Tt},this.setTransparentSort=function(Tt){I=Tt},this.getClearColor=function(){return Zt.getClearColor()},this.setClearColor=function(){Zt.setClearColor.apply(Zt,arguments)},this.getClearAlpha=function(){return Zt.getClearAlpha()},this.setClearAlpha=function(){Zt.setClearAlpha.apply(Zt,arguments)},this.clear=function(Tt,Lt,ee){var Yt=0;(Tt===void 0||Tt)&&(Yt|=16384),(Lt===void 0||Lt)&&(Yt|=256),(ee===void 0||ee)&&(Yt|=1024),Q.clear(Yt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Ye,!1),n.removeEventListener("webglcontextrestored",le,!1),At.dispose(),Ot.dispose(),wt.dispose(),te.dispose(),ze.dispose(),Tn.stop()};function Ye(Tt){Tt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function le(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1,Pe()}function Fe(Tt){var Lt=Tt.target;Lt.removeEventListener("dispose",Fe),Ke(Lt)}function Ke(Tt){Ze(Tt),wt.remove(Tt)}function Ze(Tt){var Lt=wt.get(Tt).program;Tt.program=void 0,Lt!==void 0&&mt.releaseProgram(Lt)}function ke(Tt,Lt){Tt.render(function(ee){p.renderBufferImmediate(ee,Lt)})}this.renderBufferImmediate=function(Tt,Lt){at.initAttributes();var ee=wt.get(Tt);Tt.hasPositions&&!ee.position&&(ee.position=Q.createBuffer()),Tt.hasNormals&&!ee.normal&&(ee.normal=Q.createBuffer()),Tt.hasUvs&&!ee.uv&&(ee.uv=Q.createBuffer()),Tt.hasColors&&!ee.color&&(ee.color=Q.createBuffer());var Yt=Lt.getAttributes();Tt.hasPositions&&(Q.bindBuffer(34962,ee.position),Q.bufferData(34962,Tt.positionArray,35048),at.enableAttribute(Yt.position),Q.vertexAttribPointer(Yt.position,3,5126,!1,0,0)),Tt.hasNormals&&(Q.bindBuffer(34962,ee.normal),Q.bufferData(34962,Tt.normalArray,35048),at.enableAttribute(Yt.normal),Q.vertexAttribPointer(Yt.normal,3,5126,!1,0,0)),Tt.hasUvs&&(Q.bindBuffer(34962,ee.uv),Q.bufferData(34962,Tt.uvArray,35048),at.enableAttribute(Yt.uv),Q.vertexAttribPointer(Yt.uv,2,5126,!1,0,0)),Tt.hasColors&&(Q.bindBuffer(34962,ee.color),Q.bufferData(34962,Tt.colorArray,35048),at.enableAttribute(Yt.color),Q.vertexAttribPointer(Yt.color,3,5126,!1,0,0)),at.disableUnusedAttributes(),Q.drawArrays(4,0,Tt.count),Tt.count=0};var Qe=new la;this.renderBufferDirect=function(Tt,Lt,ee,Yt,Ve,Ue){Lt===null&&(Lt=Qe);var en=Ve.isMesh&&Ve.matrixWorld.determinant()<0,gn=cr(Tt,Lt,Yt,Ve);at.setMaterial(Yt,en);var qt=!1;(N.geometry!==ee.id||N.program!==gn.id||N.wireframe!==(Yt.wireframe===!0))&&(N.geometry=ee.id,N.program=gn.id,N.wireframe=Yt.wireframe===!0,qt=!0),(Yt.morphTargets||Yt.morphNormals)&&(he.update(Ve,ee,Yt,gn),qt=!0);var ye=ee.index,pe=ee.attributes.position;if(ye===null){if(pe===void 0||pe.count===0)return}else if(ye.count===0)return;var Te=1;Yt.wireframe===!0&&(ye=Gt.getWireframeAttribute(ee),Te=2);var We,Ie=fe;ye!==null&&(We=Dt.get(ye),Ie=be,Ie.setIndex(We)),qt&&(hn(Ve,ee,Yt,gn),ye!==null&&Q.bindBuffer(34963,We.buffer));var Ge=ye!==null?ye.count:pe.count,mn=ee.drawRange.start*Te,In=ee.drawRange.count*Te,Wn=Ue!==null?Ue.start*Te:0,vn=Ue!==null?Ue.count*Te:1/0,jn=Math.max(mn,Wn),Xn=Math.min(Ge,mn+In,Wn+vn)-1,ur=Math.max(0,Xn-jn+1);if(ur!==0){if(Ve.isMesh)Yt.wireframe===!0?(at.setLineWidth(Yt.wireframeLinewidth*vt()),Ie.setMode(1)):Ie.setMode(4);else if(Ve.isLine){var wr=Yt.linewidth;wr===void 0&&(wr=1),at.setLineWidth(wr*vt()),Ve.isLineSegments?Ie.setMode(1):Ve.isLineLoop?Ie.setMode(2):Ie.setMode(3)}else Ve.isPoints?Ie.setMode(0):Ve.isSprite&&Ie.setMode(4);Ve.isInstancedMesh?Ie.renderInstances(ee,jn,ur,Ve.count):ee.isInstancedBufferGeometry?Ie.renderInstances(ee,jn,ur,ee.maxInstancedCount):Ie.render(jn,ur)}};function hn(Tt,Lt,ee,Yt){if(!(H.isWebGL2===!1&&(Tt.isInstancedMesh||Lt.isInstancedBufferGeometry)&&Y.get("ANGLE_instanced_arrays")===null)){at.initAttributes();var Ve=Lt.attributes,Ue=Yt.getAttributes(),en=ee.defaultAttributeValues;for(var gn in Ue){var qt=Ue[gn];if(qt>=0){var ye=Ve[gn];if(ye!==void 0){var pe=ye.normalized,Te=ye.itemSize,We=Dt.get(ye);if(We===void 0)continue;var Ie=We.buffer,Ge=We.type,mn=We.bytesPerElement;if(ye.isInterleavedBufferAttribute){var In=ye.data,Wn=In.stride,vn=ye.offset;In&&In.isInstancedInterleavedBuffer?(at.enableAttributeAndDivisor(qt,In.meshPerAttribute),Lt.maxInstancedCount===void 0&&(Lt.maxInstancedCount=In.meshPerAttribute*In.count)):at.enableAttribute(qt),Q.bindBuffer(34962,Ie),Q.vertexAttribPointer(qt,Te,Ge,pe,Wn*mn,vn*mn)}else ye.isInstancedBufferAttribute?(at.enableAttributeAndDivisor(qt,ye.meshPerAttribute),Lt.maxInstancedCount===void 0&&(Lt.maxInstancedCount=ye.meshPerAttribute*ye.count)):at.enableAttribute(qt),Q.bindBuffer(34962,Ie),Q.vertexAttribPointer(qt,Te,Ge,pe,0,0)}else if(gn==="instanceMatrix"){var We=Dt.get(Tt.instanceMatrix);if(We===void 0)continue;var Ie=We.buffer,Ge=We.type;at.enableAttributeAndDivisor(qt+0,1),at.enableAttributeAndDivisor(qt+1,1),at.enableAttributeAndDivisor(qt+2,1),at.enableAttributeAndDivisor(qt+3,1),Q.bindBuffer(34962,Ie),Q.vertexAttribPointer(qt+0,4,Ge,!1,64,0),Q.vertexAttribPointer(qt+1,4,Ge,!1,64,16),Q.vertexAttribPointer(qt+2,4,Ge,!1,64,32),Q.vertexAttribPointer(qt+3,4,Ge,!1,64,48)}else if(en!==void 0){var jn=en[gn];if(jn!==void 0)switch(jn.length){case 2:Q.vertexAttrib2fv(qt,jn);break;case 3:Q.vertexAttrib3fv(qt,jn);break;case 4:Q.vertexAttrib4fv(qt,jn);break;default:Q.vertexAttrib1fv(qt,jn)}}}}at.disableUnusedAttributes()}}this.compile=function(Tt,Lt){d=Ot.get(Tt,Lt),d.init(),Tt.traverse(function(Yt){Yt.isLight&&(d.pushLight(Yt),Yt.castShadow&&d.pushShadow(Yt))}),d.setupLights(Lt);var ee={};Tt.traverse(function(Yt){if(Yt.material)if(Array.isArray(Yt.material))for(var Ve=0;Ve<Yt.material.length;Ve++)Yt.material[Ve].uuid in ee||(Pn(Yt.material[Ve],Tt,Yt),ee[Yt.material[Ve].uuid]=!0);else Yt.material.uuid in ee||(Pn(Yt.material,Tt,Yt),ee[Yt.material.uuid]=!0)})};var ln=null;function Hn(Tt){ze.isPresenting||ln&&ln(Tt)}var Tn=new e2;Tn.setAnimationLoop(Hn),typeof window!="undefined"&&Tn.setContext(window),this.setAnimationLoop=function(Tt){ln=Tt,ze.setAnimationLoop(Tt),Tn.start()},this.render=function(Tt,Lt){var ee,Yt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),ee=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Yt=arguments[3]),!(Lt&&Lt.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!b){N.geometry=null,N.program=null,N.wireframe=!1,D=-1,V=null,Tt.autoUpdate===!0&&Tt.updateMatrixWorld(),Lt.parent===null&&Lt.updateMatrixWorld(),ze.enabled&&ze.isPresenting&&(Lt=ze.getCamera(Lt)),d=Ot.get(Tt,Lt),d.init(),Tt.onBeforeRender(p,Tt,Lt,ee||M),lt.multiplyMatrices(Lt.projectionMatrix,Lt.matrixWorldInverse),O.setFromProjectionMatrix(lt),nt=this.localClippingEnabled,it=q.init(this.clippingPlanes,nt,Lt),f=At.get(Tt,Lt),f.init(),Sn(Tt,Lt,0,p.sortObjects),p.sortObjects===!0&&f.sort(G,I),it&&q.beginShadows();var Ve=d.state.shadowsArray;Le.render(Ve,Tt,Lt),d.setupLights(Lt),it&&q.endShadows(),this.info.autoReset&&this.info.reset(),ee!==void 0&&this.setRenderTarget(ee),ze.enabled&&Ce.isAvailable()&&Ce.attachCamera(Lt),Zt.render(f,Tt,Lt,Yt);var Ue=f.opaque,en=f.transparent;if(Tt.overrideMaterial){var gn=Tt.overrideMaterial;Ue.length&&On(Ue,Tt,Lt,gn),en.length&&On(en,Tt,Lt,gn)}else Ue.length&&On(Ue,Tt,Lt),en.length&&On(en,Tt,Lt);Tt.onAfterRender(p,Tt,Lt),M!==null&&(_t.updateRenderTargetMipmap(M),_t.updateMultisampleRenderTarget(M)),at.buffers.depth.setTest(!0),at.buffers.depth.setMask(!0),at.buffers.color.setMask(!0),at.setPolygonOffset(!1),ze.enabled&&Ce.isAvailable()&&Ce.detachCamera(Lt),f=null,d=null}};function Sn(Tt,Lt,ee,Yt){if(Tt.visible!==!1){var Ve=Tt.layers.test(Lt.layers);if(Ve){if(Tt.isGroup)ee=Tt.renderOrder;else if(Tt.isLOD)Tt.autoUpdate===!0&&Tt.update(Lt);else if(Tt.isLight)d.pushLight(Tt),Tt.castShadow&&d.pushShadow(Tt);else if(Tt.isSprite){if(!Tt.frustumCulled||O.intersectsSprite(Tt)){Yt&&ut.setFromMatrixPosition(Tt.matrixWorld).applyMatrix4(lt);var Ue=te.update(Tt),en=Tt.material;en.visible&&f.push(Tt,Ue,en,ee,ut.z,null)}}else if(Tt.isImmediateRenderObject)Yt&&ut.setFromMatrixPosition(Tt.matrixWorld).applyMatrix4(lt),f.push(Tt,null,Tt.material,ee,ut.z,null);else if((Tt.isMesh||Tt.isLine||Tt.isPoints)&&(Tt.isSkinnedMesh&&Tt.skeleton.frame!==ft.render.frame&&(Tt.skeleton.update(),Tt.skeleton.frame=ft.render.frame),!Tt.frustumCulled||O.intersectsObject(Tt))){Yt&&ut.setFromMatrixPosition(Tt.matrixWorld).applyMatrix4(lt);var Ue=te.update(Tt),en=Tt.material;if(Array.isArray(en))for(var gn=Ue.groups,qt=0,ye=gn.length;qt<ye;qt++){var pe=gn[qt],Te=en[pe.materialIndex];Te&&Te.visible&&f.push(Tt,Ue,Te,ee,ut.z,pe)}else en.visible&&f.push(Tt,Ue,en,ee,ut.z,null)}}for(var We=Tt.children,qt=0,ye=We.length;qt<ye;qt++)Sn(We[qt],Lt,ee,Yt)}}function On(Tt,Lt,ee,Yt){for(var Ve=0,Ue=Tt.length;Ve<Ue;Ve++){var en=Tt[Ve],gn=en.object,qt=en.geometry,ye=Yt===void 0?en.material:Yt,pe=en.group;if(ee.isArrayCamera)if(K=ee,ze.enabled&&Ce.isAvailable())qn(gn,Lt,ee,qt,ye,pe);else for(var Te=ee.cameras,We=0,Ie=Te.length;We<Ie;We++){var Ge=Te[We];gn.layers.test(Ge.layers)&&(at.viewport(j.copy(Ge.viewport)),d.setupLights(Ge),qn(gn,Lt,Ge,qt,ye,pe))}else K=null,qn(gn,Lt,ee,qt,ye,pe)}}function qn(Tt,Lt,ee,Yt,Ve,Ue){if(Tt.onBeforeRender(p,Lt,ee,Yt,Ve,Ue),d=Ot.get(Lt,K||ee),Tt.modelViewMatrix.multiplyMatrices(ee.matrixWorldInverse,Tt.matrixWorld),Tt.normalMatrix.getNormalMatrix(Tt.modelViewMatrix),Tt.isImmediateRenderObject){var en=cr(ee,Lt,Ve,Tt);at.setMaterial(Ve),N.geometry=null,N.program=null,N.wireframe=!1,ke(Tt,en)}else p.renderBufferDirect(ee,Lt,Yt,Ve,Tt,Ue);Tt.onAfterRender(p,Lt,ee,Yt,Ve,Ue),d=Ot.get(Lt,K||ee)}function Pn(Tt,Lt,ee){var Yt=wt.get(Tt),Ve=d.state.lights,Ue=d.state.shadowsArray,en=Ve.state.version,gn=mt.getParameters(Tt,Ve.state,Ue,Lt,q.numPlanes,q.numIntersection,ee),qt=mt.getProgramCacheKey(gn),ye=Yt.program,pe=!0;if(ye===void 0)Tt.addEventListener("dispose",Fe);else if(ye.cacheKey!==qt)Ze(Tt);else if(Yt.lightsStateVersion!==en)Yt.lightsStateVersion=en,pe=!1;else{if(gn.shaderID!==void 0)return;pe=!1}pe&&(ye=mt.acquireProgram(gn,qt),Yt.program=ye,Yt.uniforms=gn.uniforms,Yt.environment=Tt.isMeshStandardMaterial?Lt.environment:null,Yt.outputEncoding=p.outputEncoding,Tt.program=ye);var Te=ye.getAttributes();if(Tt.morphTargets){Tt.numSupportedMorphTargets=0;for(var We=0;We<p.maxMorphTargets;We++)Te["morphTarget"+We]>=0&&Tt.numSupportedMorphTargets++}if(Tt.morphNormals){Tt.numSupportedMorphNormals=0;for(var We=0;We<p.maxMorphNormals;We++)Te["morphNormal"+We]>=0&&Tt.numSupportedMorphNormals++}var Ie=Yt.uniforms;(!Tt.isShaderMaterial&&!Tt.isRawShaderMaterial||Tt.clipping===!0)&&(Yt.numClippingPlanes=q.numPlanes,Yt.numIntersection=q.numIntersection,Ie.clippingPlanes=q.uniform),Yt.fog=Lt.fog,Yt.needsLights=$e(Tt),Yt.lightsStateVersion=en,Yt.needsLights&&(Ie.ambientLightColor.value=Ve.state.ambient,Ie.lightProbe.value=Ve.state.probe,Ie.directionalLights.value=Ve.state.directional,Ie.spotLights.value=Ve.state.spot,Ie.rectAreaLights.value=Ve.state.rectArea,Ie.pointLights.value=Ve.state.point,Ie.hemisphereLights.value=Ve.state.hemi,Ie.directionalShadowMap.value=Ve.state.directionalShadowMap,Ie.directionalShadowMatrix.value=Ve.state.directionalShadowMatrix,Ie.spotShadowMap.value=Ve.state.spotShadowMap,Ie.spotShadowMatrix.value=Ve.state.spotShadowMatrix,Ie.pointShadowMap.value=Ve.state.pointShadowMap,Ie.pointShadowMatrix.value=Ve.state.pointShadowMatrix);var Ge=Yt.program.getUniforms(),mn=qa.seqWithValue(Ge.seq,Ie);Yt.uniformsList=mn}function cr(Tt,Lt,ee,Yt){_t.resetTextureUnits();var Ve=Lt.fog,Ue=ee.isMeshStandardMaterial?Lt.environment:null,en=wt.get(ee),gn=d.state.lights;if(it&&(nt||Tt!==V)){var qt=Tt===V&&ee.id===D;q.setState(ee.clippingPlanes,ee.clipIntersection,ee.clipShadows,Tt,en,qt)}ee.version===en.__version?(en.program===void 0||ee.fog&&en.fog!==Ve||en.environment!==Ue||en.needsLights&&en.lightsStateVersion!==gn.state.version||en.numClippingPlanes!==void 0&&(en.numClippingPlanes!==q.numPlanes||en.numIntersection!==q.numIntersection)||en.outputEncoding!==p.outputEncoding)&&Pn(ee,Lt,Yt):(Pn(ee,Lt,Yt),en.__version=ee.version);var ye=!1,pe=!1,Te=!1,We=en.program,Ie=We.getUniforms(),Ge=en.uniforms;if(at.useProgram(We.program)&&(ye=!0,pe=!0,Te=!0),ee.id!==D&&(D=ee.id,pe=!0),ye||V!==Tt){if(We.numMultiviewViews>0?Ce.updateCameraProjectionMatricesUniform(Tt,Ie):Ie.setValue(Q,"projectionMatrix",Tt.projectionMatrix),H.logarithmicDepthBuffer&&Ie.setValue(Q,"logDepthBufFC",2/(Math.log(Tt.far+1)/Math.LN2)),V!==Tt&&(V=Tt,pe=!0,Te=!0),ee.isShaderMaterial||ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshStandardMaterial||ee.envMap){var mn=Ie.map.cameraPosition;mn!==void 0&&mn.setValue(Q,ut.setFromMatrixPosition(Tt.matrixWorld))}(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial)&&Ie.setValue(Q,"isOrthographic",Tt.isOrthographicCamera===!0),(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial||ee.skinning)&&(We.numMultiviewViews>0?Ce.updateCameraViewMatricesUniform(Tt,Ie):Ie.setValue(Q,"viewMatrix",Tt.matrixWorldInverse))}if(ee.skinning){Ie.setOptional(Q,Yt,"bindMatrix"),Ie.setOptional(Q,Yt,"bindMatrixInverse");var In=Yt.skeleton;if(In){var Wn=In.bones;if(H.floatVertexTextures){if(In.boneTexture===void 0){var vn=Math.sqrt(Wn.length*4);vn=pr.ceilPowerOfTwo(vn),vn=Math.max(vn,4);var jn=new Float32Array(vn*vn*4);jn.set(In.boneMatrices);var Xn=new wu(jn,vn,vn,as,ld);In.boneMatrices=jn,In.boneTexture=Xn,In.boneTextureSize=vn}Ie.setValue(Q,"boneTexture",In.boneTexture,_t),Ie.setValue(Q,"boneTextureSize",In.boneTextureSize)}else Ie.setOptional(Q,In,"boneMatrices")}}return(pe||en.receiveShadow!==Yt.receiveShadow)&&(en.receiveShadow=Yt.receiveShadow,Ie.setValue(Q,"receiveShadow",Yt.receiveShadow)),pe&&(Ie.setValue(Q,"toneMappingExposure",p.toneMappingExposure),Ie.setValue(Q,"toneMappingWhitePoint",p.toneMappingWhitePoint),en.needsLights&&Ee(Ge,Te),Ve&&ee.fog&&Rt(Ge,Ve),ee.isMeshBasicMaterial?Yn(Ge,ee):ee.isMeshLambertMaterial?(Yn(Ge,ee),jt(Ge,ee)):ee.isMeshToonMaterial?(Yn(Ge,ee),It(Ge,ee)):ee.isMeshPhongMaterial?(Yn(Ge,ee),Xt(Ge,ee)):ee.isMeshStandardMaterial?(Yn(Ge,ee,Ue),ee.isMeshPhysicalMaterial?Kt(Ge,ee,Ue):zt(Ge,ee,Ue)):ee.isMeshMatcapMaterial?(Yn(Ge,ee),Qt(Ge,ee)):ee.isMeshDepthMaterial?(Yn(Ge,ee),me(Ge,ee)):ee.isMeshDistanceMaterial?(Yn(Ge,ee),ve(Ge,ee)):ee.isMeshNormalMaterial?(Yn(Ge,ee),Xe(Ge,ee)):ee.isLineBasicMaterial?(zn(Ge,ee),ee.isLineDashedMaterial&&Qn(Ge,ee)):ee.isPointsMaterial?Wt(Ge,ee):ee.isSpriteMaterial?St(Ge,ee):ee.isShadowMaterial&&(Ge.color.value.copy(ee.color),Ge.opacity.value=ee.opacity),Ge.ltc_1!==void 0&&(Ge.ltc_1.value=kn.LTC_1),Ge.ltc_2!==void 0&&(Ge.ltc_2.value=kn.LTC_2),qa.upload(Q,en.uniformsList,Ge,_t),ee.isShaderMaterial&&(ee.uniformsNeedUpdate=!1)),ee.isShaderMaterial&&ee.uniformsNeedUpdate===!0&&(qa.upload(Q,en.uniformsList,Ge,_t),ee.uniformsNeedUpdate=!1),ee.isSpriteMaterial&&Ie.setValue(Q,"center",Yt.center),We.numMultiviewViews>0?Ce.updateObjectMatricesUniforms(Yt,Tt,Ie):(Ie.setValue(Q,"modelViewMatrix",Yt.modelViewMatrix),Ie.setValue(Q,"normalMatrix",Yt.normalMatrix)),Ie.setValue(Q,"modelMatrix",Yt.matrixWorld),We}function Yn(Tt,Lt,ee){Tt.opacity.value=Lt.opacity,Lt.color&&Tt.diffuse.value.copy(Lt.color),Lt.emissive&&Tt.emissive.value.copy(Lt.emissive).multiplyScalar(Lt.emissiveIntensity),Lt.map&&(Tt.map.value=Lt.map),Lt.alphaMap&&(Tt.alphaMap.value=Lt.alphaMap),Lt.specularMap&&(Tt.specularMap.value=Lt.specularMap);var Yt=Lt.envMap||ee;Yt&&(Tt.envMap.value=Yt,Tt.flipEnvMap.value=Yt.isCubeTexture?-1:1,Tt.reflectivity.value=Lt.reflectivity,Tt.refractionRatio.value=Lt.refractionRatio,Tt.maxMipLevel.value=wt.get(Yt).__maxMipLevel),Lt.lightMap&&(Tt.lightMap.value=Lt.lightMap,Tt.lightMapIntensity.value=Lt.lightMapIntensity),Lt.aoMap&&(Tt.aoMap.value=Lt.aoMap,Tt.aoMapIntensity.value=Lt.aoMapIntensity);var Ve;Lt.map?Ve=Lt.map:Lt.specularMap?Ve=Lt.specularMap:Lt.displacementMap?Ve=Lt.displacementMap:Lt.normalMap?Ve=Lt.normalMap:Lt.bumpMap?Ve=Lt.bumpMap:Lt.roughnessMap?Ve=Lt.roughnessMap:Lt.metalnessMap?Ve=Lt.metalnessMap:Lt.alphaMap?Ve=Lt.alphaMap:Lt.emissiveMap&&(Ve=Lt.emissiveMap),Ve!==void 0&&(Ve.isWebGLRenderTarget&&(Ve=Ve.texture),Ve.matrixAutoUpdate===!0&&Ve.updateMatrix(),Tt.uvTransform.value.copy(Ve.matrix));var Ue;Lt.aoMap?Ue=Lt.aoMap:Lt.lightMap&&(Ue=Lt.lightMap),Ue!==void 0&&(Ue.isWebGLRenderTarget&&(Ue=Ue.texture),Ue.matrixAutoUpdate===!0&&Ue.updateMatrix(),Tt.uv2Transform.value.copy(Ue.matrix))}function zn(Tt,Lt){Tt.diffuse.value.copy(Lt.color),Tt.opacity.value=Lt.opacity}function Qn(Tt,Lt){Tt.dashSize.value=Lt.dashSize,Tt.totalSize.value=Lt.dashSize+Lt.gapSize,Tt.scale.value=Lt.scale}function Wt(Tt,Lt){Tt.diffuse.value.copy(Lt.color),Tt.opacity.value=Lt.opacity,Tt.size.value=Lt.size*U,Tt.scale.value=J*.5,Lt.map&&(Tt.map.value=Lt.map),Lt.alphaMap&&(Tt.alphaMap.value=Lt.alphaMap);var ee;Lt.map?ee=Lt.map:Lt.alphaMap&&(ee=Lt.alphaMap),ee!==void 0&&(ee.matrixAutoUpdate===!0&&ee.updateMatrix(),Tt.uvTransform.value.copy(ee.matrix))}function St(Tt,Lt){Tt.diffuse.value.copy(Lt.color),Tt.opacity.value=Lt.opacity,Tt.rotation.value=Lt.rotation,Lt.map&&(Tt.map.value=Lt.map),Lt.alphaMap&&(Tt.alphaMap.value=Lt.alphaMap);var ee;Lt.map?ee=Lt.map:Lt.alphaMap&&(ee=Lt.alphaMap),ee!==void 0&&(ee.matrixAutoUpdate===!0&&ee.updateMatrix(),Tt.uvTransform.value.copy(ee.matrix))}function Rt(Tt,Lt){Tt.fogColor.value.copy(Lt.color),Lt.isFog?(Tt.fogNear.value=Lt.near,Tt.fogFar.value=Lt.far):Lt.isFogExp2&&(Tt.fogDensity.value=Lt.density)}function jt(Tt,Lt){Lt.emissiveMap&&(Tt.emissiveMap.value=Lt.emissiveMap)}function Xt(Tt,Lt){Tt.specular.value.copy(Lt.specular),Tt.shininess.value=Math.max(Lt.shininess,1e-4),Lt.emissiveMap&&(Tt.emissiveMap.value=Lt.emissiveMap),Lt.bumpMap&&(Tt.bumpMap.value=Lt.bumpMap,Tt.bumpScale.value=Lt.bumpScale,Lt.side===Si&&(Tt.bumpScale.value*=-1)),Lt.normalMap&&(Tt.normalMap.value=Lt.normalMap,Tt.normalScale.value.copy(Lt.normalScale),Lt.side===Si&&Tt.normalScale.value.negate()),Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias)}function It(Tt,Lt){Tt.specular.value.copy(Lt.specular),Tt.shininess.value=Math.max(Lt.shininess,1e-4),Lt.gradientMap&&(Tt.gradientMap.value=Lt.gradientMap),Lt.emissiveMap&&(Tt.emissiveMap.value=Lt.emissiveMap),Lt.bumpMap&&(Tt.bumpMap.value=Lt.bumpMap,Tt.bumpScale.value=Lt.bumpScale,Lt.side===Si&&(Tt.bumpScale.value*=-1)),Lt.normalMap&&(Tt.normalMap.value=Lt.normalMap,Tt.normalScale.value.copy(Lt.normalScale),Lt.side===Si&&Tt.normalScale.value.negate()),Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias)}function zt(Tt,Lt,ee){Tt.roughness.value=Lt.roughness,Tt.metalness.value=Lt.metalness,Lt.roughnessMap&&(Tt.roughnessMap.value=Lt.roughnessMap),Lt.metalnessMap&&(Tt.metalnessMap.value=Lt.metalnessMap),Lt.emissiveMap&&(Tt.emissiveMap.value=Lt.emissiveMap),Lt.bumpMap&&(Tt.bumpMap.value=Lt.bumpMap,Tt.bumpScale.value=Lt.bumpScale,Lt.side===Si&&(Tt.bumpScale.value*=-1)),Lt.normalMap&&(Tt.normalMap.value=Lt.normalMap,Tt.normalScale.value.copy(Lt.normalScale),Lt.side===Si&&Tt.normalScale.value.negate()),Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias),(Lt.envMap||ee)&&(Tt.envMapIntensity.value=Lt.envMapIntensity)}function Kt(Tt,Lt,ee){zt(Tt,Lt,ee),Tt.reflectivity.value=Lt.reflectivity,Tt.clearcoat.value=Lt.clearcoat,Tt.clearcoatRoughness.value=Lt.clearcoatRoughness,Lt.sheen&&Tt.sheen.value.copy(Lt.sheen),Lt.clearcoatNormalMap&&(Tt.clearcoatNormalScale.value.copy(Lt.clearcoatNormalScale),Tt.clearcoatNormalMap.value=Lt.clearcoatNormalMap,Lt.side===Si&&Tt.clearcoatNormalScale.value.negate()),Tt.transparency.value=Lt.transparency}function Qt(Tt,Lt){Lt.matcap&&(Tt.matcap.value=Lt.matcap),Lt.bumpMap&&(Tt.bumpMap.value=Lt.bumpMap,Tt.bumpScale.value=Lt.bumpScale,Lt.side===Si&&(Tt.bumpScale.value*=-1)),Lt.normalMap&&(Tt.normalMap.value=Lt.normalMap,Tt.normalScale.value.copy(Lt.normalScale),Lt.side===Si&&Tt.normalScale.value.negate()),Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias)}function me(Tt,Lt){Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias)}function ve(Tt,Lt){Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias),Tt.referencePosition.value.copy(Lt.referencePosition),Tt.nearDistance.value=Lt.nearDistance,Tt.farDistance.value=Lt.farDistance}function Xe(Tt,Lt){Lt.bumpMap&&(Tt.bumpMap.value=Lt.bumpMap,Tt.bumpScale.value=Lt.bumpScale,Lt.side===Si&&(Tt.bumpScale.value*=-1)),Lt.normalMap&&(Tt.normalMap.value=Lt.normalMap,Tt.normalScale.value.copy(Lt.normalScale),Lt.side===Si&&Tt.normalScale.value.negate()),Lt.displacementMap&&(Tt.displacementMap.value=Lt.displacementMap,Tt.displacementScale.value=Lt.displacementScale,Tt.displacementBias.value=Lt.displacementBias)}function Ee(Tt,Lt){Tt.ambientLightColor.needsUpdate=Lt,Tt.lightProbe.needsUpdate=Lt,Tt.directionalLights.needsUpdate=Lt,Tt.pointLights.needsUpdate=Lt,Tt.spotLights.needsUpdate=Lt,Tt.rectAreaLights.needsUpdate=Lt,Tt.hemisphereLights.needsUpdate=Lt}function $e(Tt){return Tt.isMeshLambertMaterial||Tt.isMeshToonMaterial||Tt.isMeshPhongMaterial||Tt.isMeshStandardMaterial||Tt.isShadowMaterial||Tt.isShaderMaterial&&Tt.lights===!0}this.setFramebuffer=function(Tt){v!==Tt&&M===null&&Q.bindFramebuffer(36160,Tt),v=Tt},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return M},this.setRenderTarget=function(Tt,Lt,ee){M=Tt,x=Lt,w=ee,Tt&&wt.get(Tt).__webglFramebuffer===void 0&&_t.setupRenderTarget(Tt);var Yt=v,Ve=!1;if(Tt){var Ue=wt.get(Tt).__webglFramebuffer;Tt.isWebGLCubeRenderTarget?(Yt=Ue[Lt||0],Ve=!0):Tt.isWebGLMultisampleRenderTarget?Yt=wt.get(Tt).__webglMultisampledFramebuffer:Yt=Ue,j.copy(Tt.viewport),Z.copy(Tt.scissor),tt=Tt.scissorTest}else j.copy(C).multiplyScalar(U).floor(),Z.copy(L).multiplyScalar(U).floor(),tt=B;if(E!==Yt&&(Q.bindFramebuffer(36160,Yt),E=Yt),at.viewport(j),at.scissor(Z),at.setScissorTest(tt),Ve){var en=wt.get(Tt.texture);Q.framebufferTexture2D(36160,36064,34069+(Lt||0),en.__webglTexture,ee||0)}},this.readRenderTargetPixels=function(Tt,Lt,ee,Yt,Ve,Ue,en){if(!(Tt&&Tt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var gn=wt.get(Tt).__webglFramebuffer;if(Tt.isWebGLCubeRenderTarget&&en!==void 0&&(gn=gn[en]),gn){var qt=!1;gn!==E&&(Q.bindFramebuffer(36160,gn),qt=!0);try{var ye=Tt.texture,pe=ye.format,Te=ye.type;if(pe!==as&&Me.convert(pe)!==Q.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(Te!==Qp&&Me.convert(Te)!==Q.getParameter(35738)&&!(Te===ld&&(H.isWebGL2||Y.get("OES_texture_float")||Y.get("WEBGL_color_buffer_float")))&&!(Te===K1&&(H.isWebGL2?Y.get("EXT_color_buffer_float"):Y.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Q.checkFramebufferStatus(36160)===36053?Lt>=0&&Lt<=Tt.width-Yt&&ee>=0&&ee<=Tt.height-Ve&&Q.readPixels(Lt,ee,Yt,Ve,Me.convert(pe),Me.convert(Te),Ue):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{qt&&Q.bindFramebuffer(36160,E)}}},this.copyFramebufferToTexture=function(Tt,Lt,ee){ee===void 0&&(ee=0);var Yt=Math.pow(2,-ee),Ve=Math.floor(Lt.image.width*Yt),Ue=Math.floor(Lt.image.height*Yt),en=Me.convert(Lt.format);_t.setTexture2D(Lt,0),Q.copyTexImage2D(3553,ee,en,Tt.x,Tt.y,Ve,Ue,0),at.unbindTexture()},this.copyTextureToTexture=function(Tt,Lt,ee,Yt){var Ve=Lt.image.width,Ue=Lt.image.height,en=Me.convert(ee.format),gn=Me.convert(ee.type);_t.setTexture2D(ee,0),Lt.isDataTexture?Q.texSubImage2D(3553,Yt||0,Tt.x,Tt.y,Ve,Ue,en,gn,Lt.image.data):Q.texSubImage2D(3553,Yt||0,Tt.x,Tt.y,en,gn,Lt.image),at.unbindTexture()},this.initTexture=function(Tt){_t.setTexture2D(Tt,0),at.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Cy(t,n){this.name="",this.color=new Dn(t),this.density=n!==void 0?n:25e-5}Object.assign(Cy.prototype,{isFogExp2:!0,clone:function(){return new Cy(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});function Py(t,n,e){this.name="",this.color=new Dn(t),this.near=n!==void 0?n:1,this.far=e!==void 0?e:1e3}Object.assign(Py.prototype,{isFog:!0,clone:function(){return new Py(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}});function ga(t,n){this.array=t,this.stride=n,this.count=t!==void 0?t.length/n:0,this.usage=rm,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(ga.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Object.assign(ga.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,n,e){t*=this.stride,e*=n.stride;for(var i=0,s=this.stride;i<s;i++)this.array[t+i]=n.array[e+i];return this},set:function(t,n){return n===void 0&&(n=0),this.array.set(t,n),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Zl=new oe;function Td(t,n,e,i){this.data=t,this.itemSize=n,this.offset=e,this.normalized=i===!0}Object.defineProperties(Td.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Td.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var n=0,e=this.data.count;n<e;n++)Zl.x=this.getX(n),Zl.y=this.getY(n),Zl.z=this.getZ(n),Zl.applyMatrix4(t),this.setXYZ(n,Zl.x,Zl.y,Zl.z);return this},setX:function(t,n){return this.data.array[t*this.data.stride+this.offset]=n,this},setY:function(t,n){return this.data.array[t*this.data.stride+this.offset+1]=n,this},setZ:function(t,n){return this.data.array[t*this.data.stride+this.offset+2]=n,this},setW:function(t,n){return this.data.array[t*this.data.stride+this.offset+3]=n,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,n,e){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=e,this},setXYZ:function(t,n,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=e,this.data.array[t+2]=i,this},setXYZW:function(t,n,e,i,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=e,this.data.array[t+2]=i,this.data.array[t+3]=s,this}});function Jl(t){er.call(this),this.type="SpriteMaterial",this.color=new Dn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Jl.prototype=Object.create(er.prototype),Jl.prototype.constructor=Jl,Jl.prototype.isSpriteMaterial=!0,Jl.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Eu,Cd=new oe,Tu=new oe,Cu=new oe,Pu=new on,Pd=new on,S2=new mr,wm=new oe,Dd=new oe,Mm=new oe,E2=new on,Dy=new on,T2=new on;function Ry(t){if(Rn.call(this),this.type="Sprite",Eu===void 0){Eu=new Un;var n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new ga(n,5);Eu.setIndex([0,1,2,0,2,3]),Eu.setAttribute("position",new Td(e,3,0,!1)),Eu.setAttribute("uv",new Td(e,2,3,!1))}this.geometry=Eu,this.material=t!==void 0?t:new Jl,this.center=new on(.5,.5)}Ry.prototype=Object.assign(Object.create(Rn.prototype),{constructor:Ry,isSprite:!0,raycast:function(t,n){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Tu.setFromMatrixScale(this.matrixWorld),S2.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Cu.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Tu.multiplyScalar(-Cu.z);var e=this.material.rotation,i,s;e!==0&&(s=Math.cos(e),i=Math.sin(e));var a=this.center;Am(wm.set(-.5,-.5,0),Cu,a,Tu,i,s),Am(Dd.set(.5,-.5,0),Cu,a,Tu,i,s),Am(Mm.set(.5,.5,0),Cu,a,Tu,i,s),E2.set(0,0),Dy.set(1,0),T2.set(1,1);var o=t.ray.intersectTriangle(wm,Dd,Mm,!1,Cd);if(!(o===null&&(Am(Dd.set(-.5,.5,0),Cu,a,Tu,i,s),Dy.set(0,1),o=t.ray.intersectTriangle(wm,Mm,Dd,!1,Cd),o===null))){var r=t.ray.origin.distanceTo(Cd);r<t.near||r>t.far||n.push({distance:r,point:Cd.clone(),uv:Bi.getUV(Cd,wm,Dd,Mm,E2,Dy,T2,new on),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Rn.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this}});function Am(t,n,e,i,s,a){Pu.subVectors(t,e).addScalar(.5).multiply(i),s!==void 0?(Pd.x=a*Pu.x-s*Pu.y,Pd.y=s*Pu.x+a*Pu.y):Pd.copy(Pu),t.copy(n),t.x+=Pd.x,t.y+=Pd.y,t.applyMatrix4(S2)}var Sm=new oe,C2=new oe;function Em(){Rn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Em.prototype=Object.assign(Object.create(Rn.prototype),{constructor:Em,isLOD:!0,copy:function(t){Rn.prototype.copy.call(this,t,!1);for(var n=t.levels,e=0,i=n.length;e<i;e++){var s=n[e];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,n){n===void 0&&(n=0),n=Math.abs(n);for(var e=this.levels,i=0;i<e.length&&!(n<e[i].distance);i++);return e.splice(i,0,{distance:n,object:t}),this.add(t),this},getObjectForDistance:function(t){var n=this.levels;if(n.length>0){for(var e=1,i=n.length;e<i&&!(t<n[e].distance);e++);return n[e-1].object}return null},raycast:function(t,n){var e=this.levels;if(e.length>0){Sm.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(Sm);this.getObjectForDistance(i).raycast(t,n)}},update:function(t){var n=this.levels;if(n.length>1){Sm.setFromMatrixPosition(t.matrixWorld),C2.setFromMatrixPosition(this.matrixWorld);var e=Sm.distanceTo(C2);n[0].object.visible=!0;for(var i=1,s=n.length;i<s&&e>=n[i].distance;i++)n[i-1].object.visible=!1,n[i].object.visible=!0;for(;i<s;i++)n[i].object.visible=!1}},toJSON:function(t){var n=Rn.prototype.toJSON.call(this,t);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];for(var e=this.levels,i=0,s=e.length;i<s;i++){var a=e[i];n.object.levels.push({object:a.object.uuid,distance:a.distance})}return n}});function Rd(t,n){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),$r.call(this,t,n),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new mr,this.bindMatrixInverse=new mr}Rd.prototype=Object.assign(Object.create($r.prototype),{constructor:Rd,isSkinnedMesh:!0,bind:function(t,n){this.skeleton=t,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.getInverse(n)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new Or,n=this.geometry.attributes.skinWeight,e=0,i=n.count;e<i;e++){t.x=n.getX(e),t.y=n.getY(e),t.z=n.getZ(e),t.w=n.getW(e);var s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),n.setXYZW(e,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){$r.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var P2=new mr,HD=new mr;function Tm(t,n){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,n===void 0)this.calculateInverses();else if(this.bones.length===n.length)this.boneInverses=n.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var e=0,i=this.bones.length;e<i;e++)this.boneInverses.push(new mr)}}Object.assign(Tm.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,n=this.bones.length;t<n;t++){var e=new mr;this.bones[t]&&e.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(e)}},pose:function(){var t,n,e;for(n=0,e=this.bones.length;n<e;n++)t=this.bones[n],t&&t.matrixWorld.getInverse(this.boneInverses[n]);for(n=0,e=this.bones.length;n<e;n++)t=this.bones[n],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,n=this.boneInverses,e=this.boneMatrices,i=this.boneTexture,s=0,a=t.length;s<a;s++){var o=t[s]?t[s].matrixWorld:HD;P2.multiplyMatrices(o,n[s]),P2.toArray(e,s*16)}i!==void 0&&(i.needsUpdate=!0)},clone:function(){return new Tm(this.bones,this.boneInverses)},getBoneByName:function(t){for(var n=0,e=this.bones.length;n<e;n++){var i=this.bones[n];if(i.name===t)return i}}});function ky(){Rn.call(this),this.type="Bone"}ky.prototype=Object.assign(Object.create(Rn.prototype),{constructor:ky,isBone:!0});var D2=new mr,R2=new mr,Du=[],kd=new $r;function Iy(t,n,e){$r.call(this,t,n),this.instanceMatrix=new nr(new Float32Array(e*16),16),this.count=e,this.frustumCulled=!1}Iy.prototype=Object.assign(Object.create($r.prototype),{constructor:Iy,isInstancedMesh:!0,getMatrixAt:function(t,n){n.fromArray(this.instanceMatrix.array,t*16)},raycast:function(t,n){var e=this.matrixWorld,i=this.count;if(kd.geometry=this.geometry,kd.material=this.material,kd.material!==void 0)for(var s=0;s<i;s++)this.getMatrixAt(s,D2),R2.multiplyMatrices(e,D2),kd.matrixWorld=R2,kd.raycast(t,Du),Du.length>0&&(Du[0].instanceId=s,Du[0].object=this,n.push(Du[0]),Du.length=0)},setMatrixAt:function(t,n){n.toArray(this.instanceMatrix.array,t*16)},updateMorphTargets:function(){}});function ni(t){er.call(this),this.type="LineBasicMaterial",this.color=new Dn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}ni.prototype=Object.create(er.prototype),ni.prototype.constructor=ni,ni.prototype.isLineBasicMaterial=!0,ni.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var k2=new oe,I2=new oe,L2=new mr,Cm=new hu,Pm=new ua;function Uo(t,n,e){e===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Rn.call(this),this.type="Line",this.geometry=t!==void 0?t:new Un,this.material=n!==void 0?n:new ni}Uo.prototype=Object.assign(Object.create(Rn.prototype),{constructor:Uo,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var n=t.attributes.position,e=[0],i=1,s=n.count;i<s;i++)k2.fromBufferAttribute(n,i-1),I2.fromBufferAttribute(n,i),e[i]=e[i-1],e[i]+=k2.distanceTo(I2);t.setAttribute("lineDistance",new Ln(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices,e=t.lineDistances;e[0]=0;for(var i=1,s=a.length;i<s;i++)e[i]=e[i-1],e[i]+=a[i-1].distanceTo(a[i])}return this},raycast:function(t,n){var e=t.linePrecision,i=this.geometry,s=this.matrixWorld;if(i.boundingSphere===null&&i.computeBoundingSphere(),Pm.copy(i.boundingSphere),Pm.applyMatrix4(s),Pm.radius+=e,t.ray.intersectsSphere(Pm)!==!1){L2.getInverse(s),Cm.copy(t.ray).applyMatrix4(L2);var a=e/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,r=new oe,u=new oe,l=new oe,h=new oe,f=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var d=i.index,p=i.attributes,b=p.position.array;if(d!==null)for(var v=d.array,x=0,w=v.length-1;x<w;x+=f){var M=v[x],E=v[x+1];r.fromArray(b,M*3),u.fromArray(b,E*3);var D=Cm.distanceSqToSegment(r,u,h,l);if(!(D>o)){h.applyMatrix4(this.matrixWorld);var N=t.ray.origin.distanceTo(h);N<t.near||N>t.far||n.push({distance:N,point:l.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else for(var x=0,w=b.length/3-1;x<w;x+=f){r.fromArray(b,3*x),u.fromArray(b,3*x+3);var D=Cm.distanceSqToSegment(r,u,h,l);if(!(D>o)){h.applyMatrix4(this.matrixWorld);var N=t.ray.origin.distanceTo(h);N<t.near||N>t.far||n.push({distance:N,point:l.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else if(i.isGeometry)for(var V=i.vertices,K=V.length,x=0;x<K-1;x+=f){var D=Cm.distanceSqToSegment(V[x],V[x+1],h,l);if(!(D>o)){h.applyMatrix4(this.matrixWorld);var N=t.ray.origin.distanceTo(h);N<t.near||N>t.far||n.push({distance:N,point:l.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Dm=new oe,Rm=new oe;function ci(t,n){Uo.call(this,t,n),this.type="LineSegments"}ci.prototype=Object.assign(Object.create(Uo.prototype),{constructor:ci,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var n=t.attributes.position,e=[],i=0,s=n.count;i<s;i+=2)Dm.fromBufferAttribute(n,i),Rm.fromBufferAttribute(n,i+1),e[i]=i===0?0:e[i-1],e[i+1]=e[i]+Dm.distanceTo(Rm);t.setAttribute("lineDistance",new Ln(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(var a=t.vertices,e=t.lineDistances,i=0,s=a.length;i<s;i+=2)Dm.copy(a[i]),Rm.copy(a[i+1]),e[i]=i===0?0:e[i-1],e[i+1]=e[i]+Dm.distanceTo(Rm);return this}});function km(t,n){Uo.call(this,t,n),this.type="LineLoop"}km.prototype=Object.assign(Object.create(Uo.prototype),{constructor:km,isLineLoop:!0});function Xa(t){er.call(this),this.type="PointsMaterial",this.color=new Dn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Xa.prototype=Object.create(er.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isPointsMaterial=!0,Xa.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var B2=new mr,Ly=new hu,Im=new ua,Lm=new oe;function Bm(t,n){Rn.call(this),this.type="Points",this.geometry=t!==void 0?t:new Un,this.material=n!==void 0?n:new Xa,this.updateMorphTargets()}Bm.prototype=Object.assign(Object.create(Rn.prototype),{constructor:Bm,isPoints:!0,raycast:function(t,n){var e=this.geometry,i=this.matrixWorld,s=t.params.Points.threshold;if(e.boundingSphere===null&&e.computeBoundingSphere(),Im.copy(e.boundingSphere),Im.applyMatrix4(i),Im.radius+=s,t.ray.intersectsSphere(Im)!==!1){B2.getInverse(i),Ly.copy(t.ray).applyMatrix4(B2);var a=s/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(e.isBufferGeometry){var r=e.index,u=e.attributes,l=u.position.array;if(r!==null)for(var h=r.array,f=0,d=h.length;f<d;f++){var p=h[f];Lm.fromArray(l,p*3),By(Lm,p,o,i,t,n,this)}else for(var f=0,b=l.length/3;f<b;f++)Lm.fromArray(l,f*3),By(Lm,f,o,i,t,n,this)}else for(var v=e.vertices,f=0,b=v.length;f<b;f++)By(v[f],f,o,i,t,n,this)}},updateMorphTargets:function(){var t=this.geometry,n,e,i;if(t.isBufferGeometry){var s=t.morphAttributes,a=Object.keys(s);if(a.length>0){var o=s[a[0]];if(o!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},n=0,e=o.length;n<e;n++)i=o[n].name||String(n),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=n}}else{var r=t.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function By(t,n,e,i,s,a,o){var r=Ly.distanceSqToPoint(t);if(r<e){var u=new oe;Ly.closestPointToPoint(t,u),u.applyMatrix4(i);var l=s.ray.origin.distanceTo(u);if(l<s.near||l>s.far)return;a.push({distance:l,distanceToRay:Math.sqrt(r),point:u,index:n,face:null,object:o})}}function F2(t,n,e,i,s,a,o,r,u){Nr.call(this,t,n,e,i,s,a,o,r,u),this.format=o!==void 0?o:oa,this.minFilter=a!==void 0?a:pi,this.magFilter=s!==void 0?s:pi,this.generateMipmaps=!1}F2.prototype=Object.assign(Object.create(Nr.prototype),{constructor:F2,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Id(t,n,e,i,s,a,o,r,u,l,h,f){Nr.call(this,null,a,o,r,u,l,i,s,h,f),this.image={width:n,height:e},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}Id.prototype=Object.create(Nr.prototype),Id.prototype.constructor=Id,Id.prototype.isCompressedTexture=!0;function Fm(t,n,e,i,s,a,o,r,u){Nr.call(this,t,n,e,i,s,a,o,r,u),this.needsUpdate=!0}Fm.prototype=Object.create(Nr.prototype),Fm.prototype.constructor=Fm,Fm.prototype.isCanvasTexture=!0;function Nm(t,n,e,i,s,a,o,r,u,l){if(l=l!==void 0?l:tu,l!==tu&&l!==cd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");e===void 0&&l===tu&&(e=tm),e===void 0&&l===cd&&(e=em),Nr.call(this,null,i,s,a,o,r,l,e,u),this.image={width:t,height:n},this.magFilter=o!==void 0?o:li,this.minFilter=r!==void 0?r:li,this.flipY=!1,this.generateMipmaps=!1}Nm.prototype=Object.create(Nr.prototype),Nm.prototype.constructor=Nm,Nm.prototype.isDepthTexture=!0;function Om(t){Un.call(this),this.type="WireframeGeometry";var n=[],e,i,s,a,o,r=[0,0],u={},l,h,f,d,p=["a","b","c"],b;if(t&&t.isGeometry){var v=t.faces;for(e=0,s=v.length;e<s;e++){var x=v[e];for(i=0;i<3;i++)h=x[p[i]],f=x[p[(i+1)%3]],r[0]=Math.min(h,f),r[1]=Math.max(h,f),d=r[0]+","+r[1],u[d]===void 0&&(u[d]={index1:r[0],index2:r[1]})}for(d in u)l=u[d],b=t.vertices[l.index1],n.push(b.x,b.y,b.z),b=t.vertices[l.index2],n.push(b.x,b.y,b.z)}else if(t&&t.isBufferGeometry){var w,M,E,D,N,V,K,j;if(b=new oe,t.index!==null){for(w=t.attributes.position,M=t.index,E=t.groups,E.length===0&&(E=[{start:0,count:M.count,materialIndex:0}]),a=0,o=E.length;a<o;++a)for(D=E[a],N=D.start,V=D.count,e=N,s=N+V;e<s;e+=3)for(i=0;i<3;i++)h=M.getX(e+i),f=M.getX(e+(i+1)%3),r[0]=Math.min(h,f),r[1]=Math.max(h,f),d=r[0]+","+r[1],u[d]===void 0&&(u[d]={index1:r[0],index2:r[1]});for(d in u)l=u[d],b.fromBufferAttribute(w,l.index1),n.push(b.x,b.y,b.z),b.fromBufferAttribute(w,l.index2),n.push(b.x,b.y,b.z)}else for(w=t.attributes.position,e=0,s=w.count/3;e<s;e++)for(i=0;i<3;i++)K=3*e+i,b.fromBufferAttribute(w,K),n.push(b.x,b.y,b.z),j=3*e+(i+1)%3,b.fromBufferAttribute(w,j),n.push(b.x,b.y,b.z)}this.setAttribute("position",new Ln(n,3))}Om.prototype=Object.create(Un.prototype),Om.prototype.constructor=Om;function zm(t,n,e){sr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:n,stacks:e},this.fromBufferGeometry(new Ld(t,n,e)),this.mergeVertices()}zm.prototype=Object.create(sr.prototype),zm.prototype.constructor=zm;function Ld(t,n,e){Un.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:n,stacks:e};var i=[],s=[],a=[],o=[],r=1e-5,u=new oe,l=new oe,h=new oe,f=new oe,d=new oe,p,b;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var v=n+1;for(p=0;p<=e;p++){var x=p/e;for(b=0;b<=n;b++){var w=b/n;t(w,x,l),s.push(l.x,l.y,l.z),w-r>=0?(t(w-r,x,h),f.subVectors(l,h)):(t(w+r,x,h),f.subVectors(h,l)),x-r>=0?(t(w,x-r,h),d.subVectors(l,h)):(t(w,x+r,h),d.subVectors(h,l)),u.crossVectors(f,d).normalize(),a.push(u.x,u.y,u.z),o.push(w,x)}}for(p=0;p<e;p++)for(b=0;b<n;b++){var M=p*v+b,E=p*v+b+1,D=(p+1)*v+b+1,N=(p+1)*v+b;i.push(M,E,N),i.push(E,D,N)}this.setIndex(i),this.setAttribute("position",new Ln(s,3)),this.setAttribute("normal",new Ln(a,3)),this.setAttribute("uv",new Ln(o,2))}Ld.prototype=Object.create(Un.prototype),Ld.prototype.constructor=Ld;function Um(t,n,e,i){sr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:n,radius:e,detail:i},this.fromBufferGeometry(new Vo(t,n,e,i)),this.mergeVertices()}Um.prototype=Object.create(sr.prototype),Um.prototype.constructor=Um;function Vo(t,n,e,i){Un.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:n,radius:e,detail:i},e=e||1,i=i||0;var s=[],a=[];o(i),u(e),l(),this.setAttribute("position",new Ln(s,3)),this.setAttribute("normal",new Ln(s.slice(),3)),this.setAttribute("uv",new Ln(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(w){for(var M=new oe,E=new oe,D=new oe,N=0;N<n.length;N+=3)d(n[N+0],M),d(n[N+1],E),d(n[N+2],D),r(M,E,D,w)}function r(w,M,E,D){var N=Math.pow(2,D),V=[],K,j;for(K=0;K<=N;K++){V[K]=[];var Z=w.clone().lerp(E,K/N),tt=M.clone().lerp(E,K/N),rt=N-K;for(j=0;j<=rt;j++)j===0&&K===N?V[K][j]=Z:V[K][j]=Z.clone().lerp(tt,j/rt)}for(K=0;K<N;K++)for(j=0;j<2*(N-K)-1;j++){var J=Math.floor(j/2);j%2===0?(f(V[K][J+1]),f(V[K+1][J]),f(V[K][J])):(f(V[K][J+1]),f(V[K+1][J+1]),f(V[K+1][J]))}}function u(w){for(var M=new oe,E=0;E<s.length;E+=3)M.x=s[E+0],M.y=s[E+1],M.z=s[E+2],M.normalize().multiplyScalar(w),s[E+0]=M.x,s[E+1]=M.y,s[E+2]=M.z}function l(){for(var w=new oe,M=0;M<s.length;M+=3){w.x=s[M+0],w.y=s[M+1],w.z=s[M+2];var E=v(w)/2/Math.PI+.5,D=x(w)/Math.PI+.5;a.push(E,1-D)}p(),h()}function h(){for(var w=0;w<a.length;w+=6){var M=a[w+0],E=a[w+2],D=a[w+4],N=Math.max(M,E,D),V=Math.min(M,E,D);N>.9&&V<.1&&(M<.2&&(a[w+0]+=1),E<.2&&(a[w+2]+=1),D<.2&&(a[w+4]+=1))}}function f(w){s.push(w.x,w.y,w.z)}function d(w,M){var E=w*3;M.x=t[E+0],M.y=t[E+1],M.z=t[E+2]}function p(){for(var w=new oe,M=new oe,E=new oe,D=new oe,N=new on,V=new on,K=new on,j=0,Z=0;j<s.length;j+=9,Z+=6){w.set(s[j+0],s[j+1],s[j+2]),M.set(s[j+3],s[j+4],s[j+5]),E.set(s[j+6],s[j+7],s[j+8]),N.set(a[Z+0],a[Z+1]),V.set(a[Z+2],a[Z+3]),K.set(a[Z+4],a[Z+5]),D.copy(w).add(M).add(E).divideScalar(3);var tt=v(D);b(N,Z+0,w,tt),b(V,Z+2,M,tt),b(K,Z+4,E,tt)}}function b(w,M,E,D){D<0&&w.x===1&&(a[M]=w.x-1),E.x===0&&E.z===0&&(a[M]=D/2/Math.PI+.5)}function v(w){return Math.atan2(w.z,-w.x)}function x(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}Vo.prototype=Object.create(Un.prototype),Vo.prototype.constructor=Vo;function Vm(t,n){sr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:n},this.fromBufferGeometry(new Bd(t,n)),this.mergeVertices()}Vm.prototype=Object.create(sr.prototype),Vm.prototype.constructor=Vm;function Bd(t,n){var e=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];Vo.call(this,e,i,t,n),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:n}}Bd.prototype=Object.create(Vo.prototype),Bd.prototype.constructor=Bd;function jm(t,n){sr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:n},this.fromBufferGeometry(new Ru(t,n)),this.mergeVertices()}jm.prototype=Object.create(sr.prototype),jm.prototype.constructor=jm;function Ru(t,n){var e=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Vo.call(this,e,i,t,n),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:n}}Ru.prototype=Object.create(Vo.prototype),Ru.prototype.constructor=Ru;function Gm(t,n){sr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:n},this.fromBufferGeometry(new Fd(t,n)),this.mergeVertices()}Gm.prototype=Object.create(sr.prototype),Gm.prototype.constructor=Gm;function Fd(t,n){var e=(1+Math.sqrt(5))/2,i=[-1,e,0,1,e,0,-1,-e,0,1,-e,0,0,-1,e,0,1,e,0,-1,-e,0,1,-e,e,0,-1,e,0,1,-e,0,-1,-e,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Vo.call(this,i,s,t,n),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:n}}Fd.prototype=Object.create(Vo.prototype),Fd.prototype.constructor=Fd;function Hm(t,n){sr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:n},this.fromBufferGeometry(new Nd(t,n)),this.mergeVertices()}Hm.prototype=Object.create(sr.prototype),Hm.prototype.constructor=Hm;function Nd(t,n){var e=(1+Math.sqrt(5))/2,i=1/e,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-e,0,-i,e,0,i,-e,0,i,e,-i,-e,0,-i,e,0,i,-e,0,i,e,0,-e,0,-i,e,0,-i,-e,0,i,e,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Vo.call(this,s,a,t,n),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:n}}Nd.prototype=Object.create(Vo.prototype),Nd.prototype.constructor=Nd;function Wm(t,n,e,i,s,a){sr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:n,radius:e,radialSegments:i,closed:s},a!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new ku(t,n,e,i,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}Wm.prototype=Object.create(sr.prototype),Wm.prototype.constructor=Wm;function ku(t,n,e,i,s){Un.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:n,radius:e,radialSegments:i,closed:s},n=n||64,e=e||1,i=i||8,s=s||!1;var a=t.computeFrenetFrames(n,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o=new oe,r=new oe,u=new on,l=new oe,h,f,d=[],p=[],b=[],v=[];x(),this.setIndex(v),this.setAttribute("position",new Ln(d,3)),this.setAttribute("normal",new Ln(p,3)),this.setAttribute("uv",new Ln(b,2));function x(){for(h=0;h<n;h++)w(h);w(s===!1?n:0),E(),M()}function w(D){l=t.getPointAt(D/n,l);var N=a.normals[D],V=a.binormals[D];for(f=0;f<=i;f++){var K=f/i*Math.PI*2,j=Math.sin(K),Z=-Math.cos(K);r.x=Z*N.x+j*V.x,r.y=Z*N.y+j*V.y,r.z=Z*N.z+j*V.z,r.normalize(),p.push(r.x,r.y,r.z),o.x=l.x+e*r.x,o.y=l.y+e*r.y,o.z=l.z+e*r.z,d.push(o.x,o.y,o.z)}}function M(){for(f=1;f<=n;f++)for(h=1;h<=i;h++){var D=(i+1)*(f-1)+(h-1),N=(i+1)*f+(h-1),V=(i+1)*f+h,K=(i+1)*(f-1)+h;v.push(D,N,K),v.push(N,V,K)}}function E(){for(h=0;h<=n;h++)for(f=0;f<=i;f++)u.x=h/n,u.y=f/i,b.push(u.x,u.y)}}ku.prototype=Object.create(Un.prototype),ku.prototype.constructor=ku,ku.prototype.toJSON=function(){var t=Un.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t};function qm(t,n,e,i,s,a,o){sr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:n,tubularSegments:e,radialSegments:i,p:s,q:a},o!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Od(t,n,e,i,s,a)),this.mergeVertices()}qm.prototype=Object.create(sr.prototype),qm.prototype.constructor=qm;function Od(t,n,e,i,s,a){Un.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:n,tubularSegments:e,radialSegments:i,p:s,q:a},t=t||1,n=n||.4,e=Math.floor(e)||64,i=Math.floor(i)||8,s=s||2,a=a||3;var o=[],r=[],u=[],l=[],h,f,d=new oe,p=new oe,b=new oe,v=new oe,x=new oe,w=new oe,M=new oe;for(h=0;h<=e;++h){var E=h/e*s*Math.PI*2;for(rt(E,s,a,t,b),rt(E+.01,s,a,t,v),w.subVectors(v,b),M.addVectors(v,b),x.crossVectors(w,M),M.crossVectors(x,w),x.normalize(),M.normalize(),f=0;f<=i;++f){var D=f/i*Math.PI*2,N=-n*Math.cos(D),V=n*Math.sin(D);d.x=b.x+(N*M.x+V*x.x),d.y=b.y+(N*M.y+V*x.y),d.z=b.z+(N*M.z+V*x.z),r.push(d.x,d.y,d.z),p.subVectors(d,b).normalize(),u.push(p.x,p.y,p.z),l.push(h/e),l.push(f/i)}}for(f=1;f<=e;f++)for(h=1;h<=i;h++){var K=(i+1)*(f-1)+(h-1),j=(i+1)*f+(h-1),Z=(i+1)*f+h,tt=(i+1)*(f-1)+h;o.push(K,j,tt),o.push(j,Z,tt)}this.setIndex(o),this.setAttribute("position",new Ln(r,3)),this.setAttribute("normal",new Ln(u,3)),this.setAttribute("uv",new Ln(l,2));function rt(J,U,G,I,C){var L=Math.cos(J),B=Math.sin(J),O=G/U*J,q=Math.cos(O);C.x=I*(2+q)*.5*L,C.y=I*(2+q)*B*.5,C.z=I*Math.sin(O)*.5}}Od.prototype=Object.create(Un.prototype),Od.prototype.constructor=Od;function Xm(t,n,e,i,s){sr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:n,radialSegments:e,tubularSegments:i,arc:s},this.fromBufferGeometry(new zd(t,n,e,i,s)),this.mergeVertices()}Xm.prototype=Object.create(sr.prototype),Xm.prototype.constructor=Xm;function zd(t,n,e,i,s){Un.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:n,radialSegments:e,tubularSegments:i,arc:s},t=t||1,n=n||.4,e=Math.floor(e)||8,i=Math.floor(i)||6,s=s||Math.PI*2;var a=[],o=[],r=[],u=[],l=new oe,h=new oe,f=new oe,d,p;for(d=0;d<=e;d++)for(p=0;p<=i;p++){var b=p/i*s,v=d/e*Math.PI*2;h.x=(t+n*Math.cos(v))*Math.cos(b),h.y=(t+n*Math.cos(v))*Math.sin(b),h.z=n*Math.sin(v),o.push(h.x,h.y,h.z),l.x=t*Math.cos(b),l.y=t*Math.sin(b),f.subVectors(h,l).normalize(),r.push(f.x,f.y,f.z),u.push(p/i),u.push(d/e)}for(d=1;d<=e;d++)for(p=1;p<=i;p++){var x=(i+1)*d+p-1,w=(i+1)*(d-1)+p-1,M=(i+1)*(d-1)+p,E=(i+1)*d+p;a.push(x,w,E),a.push(w,M,E)}this.setIndex(a),this.setAttribute("position",new Ln(o,3)),this.setAttribute("normal",new Ln(r,3)),this.setAttribute("uv",new Ln(u,2))}zd.prototype=Object.create(Un.prototype),zd.prototype.constructor=zd;var WD={triangulate:function(t,n,e){e=e||2;var i=n&&n.length,s=i?n[0]*e:t.length,a=N2(t,0,s,e,!0),o=[];if(!a||a.next===a.prev)return o;var r,u,l,h,f,d,p;if(i&&(a=ZD(t,n,a,e)),t.length>80*e){r=l=t[0],u=h=t[1];for(var b=e;b<s;b+=e)f=t[b],d=t[b+1],f<r&&(r=f),d<u&&(u=d),f>l&&(l=f),d>h&&(h=d);p=Math.max(l-r,h-u),p=p!==0?1/p:0}return Vd(a,o,e,r,u,p),o}};function N2(t,n,e,i,s){var a,o;if(s===s8(t,n,e,i)>0)for(a=n;a<e;a+=i)o=U2(a,t[a],t[a+1],o);else for(a=e-i;a>=n;a-=i)o=U2(a,t[a],t[a+1],o);return o&&$l(o,o.next)&&(Gd(o),o=o.next),o}function Ud(t,n){if(!t)return t;n||(n=t);var e=t,i;do if(i=!1,!e.steiner&&($l(e,e.next)||Ni(e.prev,e,e.next)===0)){if(Gd(e),e=n=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==n);return n}function Vd(t,n,e,i,s,a,o){if(t){!o&&a&&t8(t,i,s,a);for(var r=t,u,l;t.prev!==t.next;){if(u=t.prev,l=t.next,a?XD(t,i,s,a):qD(t)){n.push(u.i/e),n.push(t.i/e),n.push(l.i/e),Gd(t),t=l.next,r=l.next;continue}if(t=l,t===r){o?o===1?(t=YD(t,n,e),Vd(t,n,e,i,s,a,2)):o===2&&KD(t,n,e,i,s,a):Vd(Ud(t),n,e,i,s,a,1);break}}}}function qD(t){var n=t.prev,e=t,i=t.next;if(Ni(n,e,i)>=0)return!1;for(var s=t.next.next;s!==t.prev;){if(Iu(n.x,n.y,e.x,e.y,i.x,i.y,s.x,s.y)&&Ni(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function XD(t,n,e,i){var s=t.prev,a=t,o=t.next;if(Ni(s,a,o)>=0)return!1;for(var r=s.x<a.x?s.x<o.x?s.x:o.x:a.x<o.x?a.x:o.x,u=s.y<a.y?s.y<o.y?s.y:o.y:a.y<o.y?a.y:o.y,l=s.x>a.x?s.x>o.x?s.x:o.x:a.x>o.x?a.x:o.x,h=s.y>a.y?s.y>o.y?s.y:o.y:a.y>o.y?a.y:o.y,f=Fy(r,u,n,e,i),d=Fy(l,h,n,e,i),p=t.prevZ,b=t.nextZ;p&&p.z>=f&&b&&b.z<=d;){if(p!==t.prev&&p!==t.next&&Iu(s.x,s.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Ni(p.prev,p,p.next)>=0||(p=p.prevZ,b!==t.prev&&b!==t.next&&Iu(s.x,s.y,a.x,a.y,o.x,o.y,b.x,b.y)&&Ni(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&Iu(s.x,s.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Ni(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;b&&b.z<=d;){if(b!==t.prev&&b!==t.next&&Iu(s.x,s.y,a.x,a.y,o.x,o.y,b.x,b.y)&&Ni(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function YD(t,n,e){var i=t;do{var s=i.prev,a=i.next.next;!$l(s,a)&&O2(s,i,i.next,a)&&jd(s,a)&&jd(a,s)&&(n.push(s.i/e),n.push(i.i/e),n.push(a.i/e),Gd(i),Gd(i.next),i=t=a),i=i.next}while(i!==t);return i}function KD(t,n,e,i,s,a){var o=t;do{for(var r=o.next.next;r!==o.prev;){if(o.i!==r.i&&r8(o,r)){var u=z2(o,r);o=Ud(o,o.next),u=Ud(u,u.next),Vd(o,n,e,i,s,a),Vd(u,n,e,i,s,a);return}r=r.next}o=o.next}while(o!==t)}function ZD(t,n,e,i){var s=[],a,o,r,u,l;for(a=0,o=n.length;a<o;a++)r=n[a]*i,u=a<o-1?n[a+1]*i:t.length,l=N2(t,r,u,i,!1),l===l.next&&(l.steiner=!0),s.push(n8(l));for(s.sort(JD),a=0;a<s.length;a++)$D(s[a],e),e=Ud(e,e.next);return e}function JD(t,n){return t.x-n.x}function $D(t,n){if(n=QD(t,n),n){var e=z2(n,t);Ud(e,e.next)}}function QD(t,n){var e=n,i=t.x,s=t.y,a=-1/0,o;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var r=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(r<=i&&r>a){if(a=r,r===i){if(s===e.y)return e;if(s===e.next.y)return e.next}o=e.x<e.next.x?e:e.next}}e=e.next}while(e!==n);if(!o)return null;if(i===a)return o.prev;var u=o,l=o.x,h=o.y,f=1/0,d;for(e=o.next;e!==u;)i>=e.x&&e.x>=l&&i!==e.x&&Iu(s<h?i:a,s,l,h,s<h?a:i,s,e.x,e.y)&&(d=Math.abs(s-e.y)/(i-e.x),(d<f||d===f&&e.x>o.x)&&jd(e,t)&&(o=e,f=d)),e=e.next;return o}function t8(t,n,e,i){var s=t;do s.z===null&&(s.z=Fy(s.x,s.y,n,e,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==t);s.prevZ.nextZ=null,s.prevZ=null,e8(s)}function e8(t){var n,e,i,s,a,o,r,u,l=1;do{for(e=t,t=null,a=null,o=0;e;){for(o++,i=e,r=0,n=0;n<l&&(r++,i=i.nextZ,!!i);n++);for(u=l;r>0||u>0&&i;)r!==0&&(u===0||!i||e.z<=i.z)?(s=e,e=e.nextZ,r--):(s=i,i=i.nextZ,u--),a?a.nextZ=s:t=s,s.prevZ=a,a=s;e=i}a.nextZ=null,l*=2}while(o>1);return t}function Fy(t,n,e,i,s){return t=32767*(t-e)*s,n=32767*(n-i)*s,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t|n<<1}function n8(t){var n=t,e=t;do(n.x<e.x||n.x===e.x&&n.y<e.y)&&(e=n),n=n.next;while(n!==t);return e}function Iu(t,n,e,i,s,a,o,r){return(s-o)*(n-r)-(t-o)*(a-r)>=0&&(t-o)*(i-r)-(e-o)*(n-r)>=0&&(e-o)*(a-r)-(s-o)*(i-r)>=0}function r8(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!i8(t,n)&&jd(t,n)&&jd(n,t)&&o8(t,n)}function Ni(t,n,e){return(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)}function $l(t,n){return t.x===n.x&&t.y===n.y}function O2(t,n,e,i){return $l(t,e)&&$l(n,i)||$l(t,i)&&$l(e,n)?!0:Ni(t,n,e)>0!=Ni(t,n,i)>0&&Ni(e,i,t)>0!=Ni(e,i,n)>0}function i8(t,n){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==n.i&&e.next.i!==n.i&&O2(e,e.next,t,n))return!0;e=e.next}while(e!==t);return!1}function jd(t,n){return Ni(t.prev,t,t.next)<0?Ni(t,n,t.next)>=0&&Ni(t,t.prev,n)>=0:Ni(t,n,t.prev)<0||Ni(t,t.next,n)<0}function o8(t,n){var e=t,i=!1,s=(t.x+n.x)/2,a=(t.y+n.y)/2;do e.y>a!=e.next.y>a&&e.next.y!==e.y&&s<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==t);return i}function z2(t,n){var e=new Ny(t.i,t.x,t.y),i=new Ny(n.i,n.x,n.y),s=t.next,a=n.prev;return t.next=n,n.prev=t,e.next=s,s.prev=e,i.next=e,e.prev=i,a.next=i,i.prev=a,i}function U2(t,n,e,i){var s=new Ny(t,n,e);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Gd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ny(t,n,e){this.i=t,this.x=n,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function s8(t,n,e,i){for(var s=0,a=n,o=e-i;a<e;a+=i)s+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return s}var Ya={area:function(t){for(var n=t.length,e=0,i=n-1,s=0;s<n;i=s++)e+=t[i].x*t[s].y-t[s].x*t[i].y;return e*.5},isClockWise:function(t){return Ya.area(t)<0},triangulateShape:function(t,n){var e=[],i=[],s=[];V2(t),j2(e,t);var a=t.length;n.forEach(V2);for(var o=0;o<n.length;o++)i.push(a),a+=n[o].length,j2(e,n[o]);for(var r=WD.triangulate(e,i),o=0;o<r.length;o+=3)s.push(r.slice(o,o+3));return s}};function V2(t){var n=t.length;n>2&&t[n-1].equals(t[0])&&t.pop()}function j2(t,n){for(var e=0;e<n.length;e++)t.push(n[e].x),t.push(n[e].y)}function Lu(t,n){sr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:n},this.fromBufferGeometry(new ya(t,n)),this.mergeVertices()}Lu.prototype=Object.create(sr.prototype),Lu.prototype.constructor=Lu,Lu.prototype.toJSON=function(){var t=sr.prototype.toJSON.call(this),n=this.parameters.shapes,e=this.parameters.options;return G2(n,e,t)};function ya(t,n){Un.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:n},t=Array.isArray(t)?t:[t];for(var e=this,i=[],s=[],a=0,o=t.length;a<o;a++){var r=t[a];u(r)}this.setAttribute("position",new Ln(i,3)),this.setAttribute("uv",new Ln(s,2)),this.computeVertexNormals();function u(l){var h=[],f=n.curveSegments!==void 0?n.curveSegments:12,d=n.steps!==void 0?n.steps:1,p=n.depth!==void 0?n.depth:100,b=n.bevelEnabled!==void 0?n.bevelEnabled:!0,v=n.bevelThickness!==void 0?n.bevelThickness:6,x=n.bevelSize!==void 0?n.bevelSize:v-2,w=n.bevelOffset!==void 0?n.bevelOffset:0,M=n.bevelSegments!==void 0?n.bevelSegments:3,E=n.extrudePath,D=n.UVGenerator!==void 0?n.UVGenerator:a8;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=n.amount);var N,V=!1,K,j,Z,tt;E&&(N=E.getSpacedPoints(d),V=!0,b=!1,K=E.computeFrenetFrames(d,!1),j=new oe,Z=new oe,tt=new oe),b||(M=0,v=0,x=0,w=0);var rt,J,U,G=l.extractPoints(f),I=G.shape,C=G.holes,L=!Ya.isClockWise(I);if(L)for(I=I.reverse(),J=0,U=C.length;J<U;J++)rt=C[J],Ya.isClockWise(rt)&&(C[J]=rt.reverse());var B=Ya.triangulateShape(I,C),O=I;for(J=0,U=C.length;J<U;J++)rt=C[J],I=I.concat(rt);function q(Ce,Le,Ye){return Le||console.error("THREE.ExtrudeGeometry: vec does not exist"),Le.clone().multiplyScalar(Ye).add(Ce)}var it,nt,lt,ut,vt,Q=I.length,gt,Y=B.length;function H(Ce,Le,Ye){var le,Fe,Ke,Ze=Ce.x-Le.x,ke=Ce.y-Le.y,Qe=Ye.x-Ce.x,hn=Ye.y-Ce.y,ln=Ze*Ze+ke*ke,Hn=Ze*hn-ke*Qe;if(Math.abs(Hn)>Number.EPSILON){var Tn=Math.sqrt(ln),Sn=Math.sqrt(Qe*Qe+hn*hn),On=Le.x-ke/Tn,qn=Le.y+Ze/Tn,Pn=Ye.x-hn/Sn,cr=Ye.y+Qe/Sn,Yn=((Pn-On)*hn-(cr-qn)*Qe)/(Ze*hn-ke*Qe);le=On+Ze*Yn-Ce.x,Fe=qn+ke*Yn-Ce.y;var zn=le*le+Fe*Fe;if(zn<=2)return new on(le,Fe);Ke=Math.sqrt(zn/2)}else{var Qn=!1;Ze>Number.EPSILON?Qe>Number.EPSILON&&(Qn=!0):Ze<-Number.EPSILON?Qe<-Number.EPSILON&&(Qn=!0):Math.sign(ke)===Math.sign(hn)&&(Qn=!0),Qn?(le=-ke,Fe=Ze,Ke=Math.sqrt(ln)):(le=Ze,Fe=ke,Ke=Math.sqrt(ln/2))}return new on(le/Ke,Fe/Ke)}for(var at=[],ft=0,wt=O.length,_t=wt-1,Dt=ft+1;ft<wt;ft++,_t++,Dt++)_t===wt&&(_t=0),Dt===wt&&(Dt=0),at[ft]=H(O[ft],O[_t],O[Dt]);var Gt=[],te,mt=at.concat();for(J=0,U=C.length;J<U;J++){for(rt=C[J],te=[],ft=0,wt=rt.length,_t=wt-1,Dt=ft+1;ft<wt;ft++,_t++,Dt++)_t===wt&&(_t=0),Dt===wt&&(Dt=0),te[ft]=H(rt[ft],rt[_t],rt[Dt]);Gt.push(te),mt=mt.concat(te)}for(it=0;it<M;it++){for(lt=it/M,ut=v*Math.cos(lt*Math.PI/2),nt=x*Math.sin(lt*Math.PI/2)+w,ft=0,wt=O.length;ft<wt;ft++)vt=q(O[ft],at[ft],nt),fe(vt.x,vt.y,-ut);for(J=0,U=C.length;J<U;J++)for(rt=C[J],te=Gt[J],ft=0,wt=rt.length;ft<wt;ft++)vt=q(rt[ft],te[ft],nt),fe(vt.x,vt.y,-ut)}for(nt=x+w,ft=0;ft<Q;ft++)vt=b?q(I[ft],mt[ft],nt):I[ft],V?(Z.copy(K.normals[0]).multiplyScalar(vt.x),j.copy(K.binormals[0]).multiplyScalar(vt.y),tt.copy(N[0]).add(Z).add(j),fe(tt.x,tt.y,tt.z)):fe(vt.x,vt.y,0);var At;for(At=1;At<=d;At++)for(ft=0;ft<Q;ft++)vt=b?q(I[ft],mt[ft],nt):I[ft],V?(Z.copy(K.normals[At]).multiplyScalar(vt.x),j.copy(K.binormals[At]).multiplyScalar(vt.y),tt.copy(N[At]).add(Z).add(j),fe(tt.x,tt.y,tt.z)):fe(vt.x,vt.y,p/d*At);for(it=M-1;it>=0;it--){for(lt=it/M,ut=v*Math.cos(lt*Math.PI/2),nt=x*Math.sin(lt*Math.PI/2)+w,ft=0,wt=O.length;ft<wt;ft++)vt=q(O[ft],at[ft],nt),fe(vt.x,vt.y,p+ut);for(J=0,U=C.length;J<U;J++)for(rt=C[J],te=Gt[J],ft=0,wt=rt.length;ft<wt;ft++)vt=q(rt[ft],te[ft],nt),V?fe(vt.x,vt.y+N[d-1].y,N[d-1].x+ut):fe(vt.x,vt.y,p+ut)}Ot(),Zt();function Ot(){var Ce=i.length/3;if(b){var Le=0,Ye=Q*Le;for(ft=0;ft<Y;ft++)gt=B[ft],be(gt[2]+Ye,gt[1]+Ye,gt[0]+Ye);for(Le=d+M*2,Ye=Q*Le,ft=0;ft<Y;ft++)gt=B[ft],be(gt[0]+Ye,gt[1]+Ye,gt[2]+Ye)}else{for(ft=0;ft<Y;ft++)gt=B[ft],be(gt[2],gt[1],gt[0]);for(ft=0;ft<Y;ft++)gt=B[ft],be(gt[0]+Q*d,gt[1]+Q*d,gt[2]+Q*d)}e.addGroup(Ce,i.length/3-Ce,0)}function Zt(){var Ce=i.length/3,Le=0;for(he(O,Le),Le+=O.length,J=0,U=C.length;J<U;J++)rt=C[J],he(rt,Le),Le+=rt.length;e.addGroup(Ce,i.length/3-Ce,1)}function he(Ce,Le){var Ye,le;for(ft=Ce.length;--ft>=0;){Ye=ft,le=ft-1,le<0&&(le=Ce.length-1);var Fe=0,Ke=d+M*2;for(Fe=0;Fe<Ke;Fe++){var Ze=Q*Fe,ke=Q*(Fe+1),Qe=Le+Ye+Ze,hn=Le+le+Ze,ln=Le+le+ke,Hn=Le+Ye+ke;Me(Qe,hn,ln,Hn)}}}function fe(Ce,Le,Ye){h.push(Ce),h.push(Le),h.push(Ye)}function be(Ce,Le,Ye){Pe(Ce),Pe(Le),Pe(Ye);var le=i.length/3,Fe=D.generateTopUV(e,i,le-3,le-2,le-1);ze(Fe[0]),ze(Fe[1]),ze(Fe[2])}function Me(Ce,Le,Ye,le){Pe(Ce),Pe(Le),Pe(le),Pe(Le),Pe(Ye),Pe(le);var Fe=i.length/3,Ke=D.generateSideWallUV(e,i,Fe-6,Fe-3,Fe-2,Fe-1);ze(Ke[0]),ze(Ke[1]),ze(Ke[3]),ze(Ke[1]),ze(Ke[2]),ze(Ke[3])}function Pe(Ce){i.push(h[Ce*3+0]),i.push(h[Ce*3+1]),i.push(h[Ce*3+2])}function ze(Ce){s.push(Ce.x),s.push(Ce.y)}}}ya.prototype=Object.create(Un.prototype),ya.prototype.constructor=ya,ya.prototype.toJSON=function(){var t=Un.prototype.toJSON.call(this),n=this.parameters.shapes,e=this.parameters.options;return G2(n,e,t)};var a8={generateTopUV:function(t,n,e,i,s){var a=n[e*3],o=n[e*3+1],r=n[i*3],u=n[i*3+1],l=n[s*3],h=n[s*3+1];return[new on(a,o),new on(r,u),new on(l,h)]},generateSideWallUV:function(t,n,e,i,s,a){var o=n[e*3],r=n[e*3+1],u=n[e*3+2],l=n[i*3],h=n[i*3+1],f=n[i*3+2],d=n[s*3],p=n[s*3+1],b=n[s*3+2],v=n[a*3],x=n[a*3+1],w=n[a*3+2];return Math.abs(r-h)<.01?[new on(o,1-u),new on(l,1-f),new on(d,1-b),new on(v,1-w)]:[new on(r,1-u),new on(h,1-f),new on(p,1-b),new on(x,1-w)]}};function G2(t,n,e){if(e.shapes=[],Array.isArray(t))for(var i=0,s=t.length;i<s;i++){var a=t[i];e.shapes.push(a.uuid)}else e.shapes.push(t.uuid);return n.extrudePath!==void 0&&(e.options.extrudePath=n.extrudePath.toJSON()),e}function Ym(t,n){sr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:n},this.fromBufferGeometry(new Hd(t,n)),this.mergeVertices()}Ym.prototype=Object.create(sr.prototype),Ym.prototype.constructor=Ym;function Hd(t,n){n=n||{};var e=n.font;if(!(e&&e.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new sr;var i=e.generateShapes(t,n.size);n.depth=n.height!==void 0?n.height:50,n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),ya.call(this,i,n),this.type="TextBufferGeometry"}Hd.prototype=Object.create(ya.prototype),Hd.prototype.constructor=Hd;function Km(t,n,e,i,s,a,o){sr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:n,heightSegments:e,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Bu(t,n,e,i,s,a,o)),this.mergeVertices()}Km.prototype=Object.create(sr.prototype),Km.prototype.constructor=Km;function Bu(t,n,e,i,s,a,o){Un.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:n,heightSegments:e,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=t||1,n=Math.max(3,Math.floor(n)||8),e=Math.max(2,Math.floor(e)||6),i=i!==void 0?i:0,s=s!==void 0?s:Math.PI*2,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI;var r=Math.min(a+o,Math.PI),u,l,h=0,f=[],d=new oe,p=new oe,b=[],v=[],x=[],w=[];for(l=0;l<=e;l++){var M=[],E=l/e,D=0;for(l==0&&a==0?D=.5/n:l==e&&r==Math.PI&&(D=-.5/n),u=0;u<=n;u++){var N=u/n;d.x=-t*Math.cos(i+N*s)*Math.sin(a+E*o),d.y=t*Math.cos(a+E*o),d.z=t*Math.sin(i+N*s)*Math.sin(a+E*o),v.push(d.x,d.y,d.z),p.copy(d).normalize(),x.push(p.x,p.y,p.z),w.push(N+D,1-E),M.push(h++)}f.push(M)}for(l=0;l<e;l++)for(u=0;u<n;u++){var V=f[l][u+1],K=f[l][u],j=f[l+1][u],Z=f[l+1][u+1];(l!==0||a>0)&&b.push(V,K,Z),(l!==e-1||r<Math.PI)&&b.push(K,j,Z)}this.setIndex(b),this.setAttribute("position",new Ln(v,3)),this.setAttribute("normal",new Ln(x,3)),this.setAttribute("uv",new Ln(w,2))}Bu.prototype=Object.create(Un.prototype),Bu.prototype.constructor=Bu;function Zm(t,n,e,i,s,a){sr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:n,thetaSegments:e,phiSegments:i,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new Wd(t,n,e,i,s,a)),this.mergeVertices()}Zm.prototype=Object.create(sr.prototype),Zm.prototype.constructor=Zm;function Wd(t,n,e,i,s,a){Un.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:n,thetaSegments:e,phiSegments:i,thetaStart:s,thetaLength:a},t=t||.5,n=n||1,s=s!==void 0?s:0,a=a!==void 0?a:Math.PI*2,e=e!==void 0?Math.max(3,e):8,i=i!==void 0?Math.max(1,i):1;var o=[],r=[],u=[],l=[],h,f=t,d=(n-t)/i,p=new oe,b=new on,v,x;for(v=0;v<=i;v++){for(x=0;x<=e;x++)h=s+x/e*a,p.x=f*Math.cos(h),p.y=f*Math.sin(h),r.push(p.x,p.y,p.z),u.push(0,0,1),b.x=(p.x/n+1)/2,b.y=(p.y/n+1)/2,l.push(b.x,b.y);f+=d}for(v=0;v<i;v++){var w=v*(e+1);for(x=0;x<e;x++){h=x+w;var M=h,E=h+e+1,D=h+e+2,N=h+1;o.push(M,E,N),o.push(E,D,N)}}this.setIndex(o),this.setAttribute("position",new Ln(r,3)),this.setAttribute("normal",new Ln(u,3)),this.setAttribute("uv",new Ln(l,2))}Wd.prototype=Object.create(Un.prototype),Wd.prototype.constructor=Wd;function Jm(t,n,e,i){sr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:n,phiStart:e,phiLength:i},this.fromBufferGeometry(new qd(t,n,e,i)),this.mergeVertices()}Jm.prototype=Object.create(sr.prototype),Jm.prototype.constructor=Jm;function qd(t,n,e,i){Un.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:n,phiStart:e,phiLength:i},n=Math.floor(n)||12,e=e||0,i=i||Math.PI*2,i=pr.clamp(i,0,Math.PI*2);var s=[],a=[],o=[],r,u=1/n,l=new oe,h=new on,f,d;for(f=0;f<=n;f++){var p=e+f*u*i,b=Math.sin(p),v=Math.cos(p);for(d=0;d<=t.length-1;d++)l.x=t[d].x*b,l.y=t[d].y,l.z=t[d].x*v,a.push(l.x,l.y,l.z),h.x=f/n,h.y=d/(t.length-1),o.push(h.x,h.y)}for(f=0;f<n;f++)for(d=0;d<t.length-1;d++){r=d+f*t.length;var x=r,w=r+t.length,M=r+t.length+1,E=r+1;s.push(x,w,E),s.push(w,M,E)}if(this.setIndex(s),this.setAttribute("position",new Ln(a,3)),this.setAttribute("uv",new Ln(o,2)),this.computeVertexNormals(),i===Math.PI*2){var D=this.attributes.normal.array,N=new oe,V=new oe,K=new oe;for(r=n*t.length*3,f=0,d=0;f<t.length;f++,d+=3)N.x=D[d+0],N.y=D[d+1],N.z=D[d+2],V.x=D[r+d+0],V.y=D[r+d+1],V.z=D[r+d+2],K.addVectors(N,V).normalize(),D[d+0]=D[r+d+0]=K.x,D[d+1]=D[r+d+1]=K.y,D[d+2]=D[r+d+2]=K.z}}qd.prototype=Object.create(Un.prototype),qd.prototype.constructor=qd;function Fu(t,n){sr.call(this),this.type="ShapeGeometry",typeof n=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),this.parameters={shapes:t,curveSegments:n},this.fromBufferGeometry(new Nu(t,n)),this.mergeVertices()}Fu.prototype=Object.create(sr.prototype),Fu.prototype.constructor=Fu,Fu.prototype.toJSON=function(){var t=sr.prototype.toJSON.call(this),n=this.parameters.shapes;return H2(n,t)};function Nu(t,n){Un.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:n},n=n||12;var e=[],i=[],s=[],a=[],o=0,r=0;if(Array.isArray(t)===!1)l(t);else for(var u=0;u<t.length;u++)l(t[u]),this.addGroup(o,r,u),o+=r,r=0;this.setIndex(e),this.setAttribute("position",new Ln(i,3)),this.setAttribute("normal",new Ln(s,3)),this.setAttribute("uv",new Ln(a,2));function l(h){var f,d,p,b=i.length/3,v=h.extractPoints(n),x=v.shape,w=v.holes;for(Ya.isClockWise(x)===!1&&(x=x.reverse()),f=0,d=w.length;f<d;f++)p=w[f],Ya.isClockWise(p)===!0&&(w[f]=p.reverse());var M=Ya.triangulateShape(x,w);for(f=0,d=w.length;f<d;f++)p=w[f],x=x.concat(p);for(f=0,d=x.length;f<d;f++){var E=x[f];i.push(E.x,E.y,0),s.push(0,0,1),a.push(E.x,E.y)}for(f=0,d=M.length;f<d;f++){var D=M[f],N=D[0]+b,V=D[1]+b,K=D[2]+b;e.push(N,V,K),r+=3}}}Nu.prototype=Object.create(Un.prototype),Nu.prototype.constructor=Nu,Nu.prototype.toJSON=function(){var t=Un.prototype.toJSON.call(this),n=this.parameters.shapes;return H2(n,t)};function H2(t,n){if(n.shapes=[],Array.isArray(t))for(var e=0,i=t.length;e<i;e++){var s=t[e];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n}function $m(t,n){Un.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:n},n=n!==void 0?n:1;var e=[],i=Math.cos(pr.DEG2RAD*n),s=[0,0],a={},o,r,u,l=["a","b","c"],h;t.isBufferGeometry?(h=new sr,h.fromBufferGeometry(t)):h=t.clone(),h.mergeVertices(),h.computeFaceNormals();for(var f=h.vertices,d=h.faces,p=0,b=d.length;p<b;p++)for(var v=d[p],x=0;x<3;x++)o=v[l[x]],r=v[l[(x+1)%3]],s[0]=Math.min(o,r),s[1]=Math.max(o,r),u=s[0]+","+s[1],a[u]===void 0?a[u]={index1:s[0],index2:s[1],face1:p,face2:void 0}:a[u].face2=p;for(u in a){var w=a[u];if(w.face2===void 0||d[w.face1].normal.dot(d[w.face2].normal)<=i){var M=f[w.index1];e.push(M.x,M.y,M.z),M=f[w.index2],e.push(M.x,M.y,M.z)}}this.setAttribute("position",new Ln(e,3))}$m.prototype=Object.create(Un.prototype),$m.prototype.constructor=$m;function Ou(t,n,e,i,s,a,o,r){sr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:n,height:e,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:r},this.fromBufferGeometry(new Ka(t,n,e,i,s,a,o,r)),this.mergeVertices()}Ou.prototype=Object.create(sr.prototype),Ou.prototype.constructor=Ou;function Ka(t,n,e,i,s,a,o,r){Un.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:n,height:e,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:r};var u=this;t=t!==void 0?t:1,n=n!==void 0?n:1,e=e||1,i=Math.floor(i)||8,s=Math.floor(s)||1,a=a!==void 0?a:!1,o=o!==void 0?o:0,r=r!==void 0?r:Math.PI*2;var l=[],h=[],f=[],d=[],p=0,b=[],v=e/2,x=0;w(),a===!1&&(t>0&&M(!0),n>0&&M(!1)),this.setIndex(l),this.setAttribute("position",new Ln(h,3)),this.setAttribute("normal",new Ln(f,3)),this.setAttribute("uv",new Ln(d,2));function w(){var E,D,N=new oe,V=new oe,K=0,j=(n-t)/e;for(D=0;D<=s;D++){var Z=[],tt=D/s,rt=tt*(n-t)+t;for(E=0;E<=i;E++){var J=E/i,U=J*r+o,G=Math.sin(U),I=Math.cos(U);V.x=rt*G,V.y=-tt*e+v,V.z=rt*I,h.push(V.x,V.y,V.z),N.set(G,j,I).normalize(),f.push(N.x,N.y,N.z),d.push(J,1-tt),Z.push(p++)}b.push(Z)}for(E=0;E<i;E++)for(D=0;D<s;D++){var C=b[D][E],L=b[D+1][E],B=b[D+1][E+1],O=b[D][E+1];l.push(C,L,O),l.push(L,B,O),K+=6}u.addGroup(x,K,0),x+=K}function M(E){var D,N,V,K=new on,j=new oe,Z=0,tt=E===!0?t:n,rt=E===!0?1:-1;for(N=p,D=1;D<=i;D++)h.push(0,v*rt,0),f.push(0,rt,0),d.push(.5,.5),p++;for(V=p,D=0;D<=i;D++){var J=D/i,U=J*r+o,G=Math.cos(U),I=Math.sin(U);j.x=tt*I,j.y=v*rt,j.z=tt*G,h.push(j.x,j.y,j.z),f.push(0,rt,0),K.x=G*.5+.5,K.y=I*.5*rt+.5,d.push(K.x,K.y),p++}for(D=0;D<i;D++){var C=N+D,L=V+D;E===!0?l.push(L,L+1,C):l.push(L+1,L,C),Z+=3}u.addGroup(x,Z,E===!0?1:2),x+=Z}}Ka.prototype=Object.create(Un.prototype),Ka.prototype.constructor=Ka;function Qm(t,n,e,i,s,a,o){Ou.call(this,0,t,n,e,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:n,radialSegments:e,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}Qm.prototype=Object.create(Ou.prototype),Qm.prototype.constructor=Qm;function tg(t,n,e,i,s,a,o){Ka.call(this,0,t,n,e,i,s,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:n,radialSegments:e,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}tg.prototype=Object.create(Ka.prototype),tg.prototype.constructor=tg;function eg(t,n,e,i){sr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:n,thetaStart:e,thetaLength:i},this.fromBufferGeometry(new Xd(t,n,e,i)),this.mergeVertices()}eg.prototype=Object.create(sr.prototype),eg.prototype.constructor=eg;function Xd(t,n,e,i){Un.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:n,thetaStart:e,thetaLength:i},t=t||1,n=n!==void 0?Math.max(3,n):8,e=e!==void 0?e:0,i=i!==void 0?i:Math.PI*2;var s=[],a=[],o=[],r=[],u,l,h=new oe,f=new on;for(a.push(0,0,0),o.push(0,0,1),r.push(.5,.5),l=0,u=3;l<=n;l++,u+=3){var d=e+l/n*i;h.x=t*Math.cos(d),h.y=t*Math.sin(d),a.push(h.x,h.y,h.z),o.push(0,0,1),f.x=(a[u]/t+1)/2,f.y=(a[u+1]/t+1)/2,r.push(f.x,f.y)}for(u=1;u<=n;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new Ln(a,3)),this.setAttribute("normal",new Ln(o,3)),this.setAttribute("uv",new Ln(r,2))}Xd.prototype=Object.create(Un.prototype),Xd.prototype.constructor=Xd;var eo=Object.freeze({__proto__:null,WireframeGeometry:Om,ParametricGeometry:zm,ParametricBufferGeometry:Ld,TetrahedronGeometry:Vm,TetrahedronBufferGeometry:Bd,OctahedronGeometry:jm,OctahedronBufferGeometry:Ru,IcosahedronGeometry:Gm,IcosahedronBufferGeometry:Fd,DodecahedronGeometry:Hm,DodecahedronBufferGeometry:Nd,PolyhedronGeometry:Um,PolyhedronBufferGeometry:Vo,TubeGeometry:Wm,TubeBufferGeometry:ku,TorusKnotGeometry:qm,TorusKnotBufferGeometry:Od,TorusGeometry:Xm,TorusBufferGeometry:zd,TextGeometry:Ym,TextBufferGeometry:Hd,SphereGeometry:Km,SphereBufferGeometry:Bu,RingGeometry:Zm,RingBufferGeometry:Wd,PlaneGeometry:_m,PlaneBufferGeometry:Au,LatheGeometry:Jm,LatheBufferGeometry:qd,ShapeGeometry:Fu,ShapeBufferGeometry:Nu,ExtrudeGeometry:Lu,ExtrudeBufferGeometry:ya,EdgesGeometry:$m,ConeGeometry:Qm,ConeBufferGeometry:tg,CylinderGeometry:Ou,CylinderBufferGeometry:Ka,CircleGeometry:eg,CircleBufferGeometry:Xd,BoxGeometry:ZC,BoxBufferGeometry:vm});function zu(t){er.call(this),this.type="ShadowMaterial",this.color=new Dn(0),this.transparent=!0,this.setValues(t)}zu.prototype=Object.create(er.prototype),zu.prototype.constructor=zu,zu.prototype.isShadowMaterial=!0,zu.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this};function Za(t){go.call(this,t),this.type="RawShaderMaterial"}Za.prototype=Object.create(go.prototype),Za.prototype.constructor=Za,Za.prototype.isRawShaderMaterial=!0;function yo(t){er.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Dn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zl,this.normalScale=new on(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}yo.prototype=Object.create(er.prototype),yo.prototype.constructor=yo,yo.prototype.isMeshStandardMaterial=!0,yo.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function Uu(t){yo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new on(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(t)}Uu.prototype=Object.create(yo.prototype),Uu.prototype.constructor=Uu,Uu.prototype.isMeshPhysicalMaterial=!0,Uu.prototype.copy=function(t){return yo.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearcoat=t.clearcoat,this.clearcoatRoughness=t.clearcoatRoughness,t.sheen?this.sheen=(this.sheen||new Dn).copy(t.sheen):this.sheen=null,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.transparency=t.transparency,this};function Ql(t){er.call(this),this.type="MeshPhongMaterial",this.color=new Dn(16777215),this.specular=new Dn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zl,this.normalScale=new on(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}Ql.prototype=Object.create(er.prototype),Ql.prototype.constructor=Ql,Ql.prototype.isMeshPhongMaterial=!0,Ql.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function Vu(t){er.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Dn(16777215),this.specular=new Dn(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zl,this.normalScale=new on(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}Vu.prototype=Object.create(er.prototype),Vu.prototype.constructor=Vu,Vu.prototype.isMeshToonMaterial=!0,Vu.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function ju(t){er.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zl,this.normalScale=new on(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}ju.prototype=Object.create(er.prototype),ju.prototype.constructor=ju,ju.prototype.isMeshNormalMaterial=!0,ju.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function Gu(t){er.call(this),this.type="MeshLambertMaterial",this.color=new Dn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}Gu.prototype=Object.create(er.prototype),Gu.prototype.constructor=Gu,Gu.prototype.isMeshLambertMaterial=!0,Gu.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function Hu(t){er.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Dn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zl,this.normalScale=new on(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}Hu.prototype=Object.create(er.prototype),Hu.prototype.constructor=Hu,Hu.prototype.isMeshMatcapMaterial=!0,Hu.prototype.copy=function(t){return er.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function Wu(t){ni.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Wu.prototype=Object.create(ni.prototype),Wu.prototype.constructor=Wu,Wu.prototype.isLineDashedMaterial=!0,Wu.prototype.copy=function(t){return ni.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var l8=Object.freeze({__proto__:null,ShadowMaterial:zu,SpriteMaterial:Jl,RawShaderMaterial:Za,ShaderMaterial:go,PointsMaterial:Xa,MeshPhysicalMaterial:Uu,MeshStandardMaterial:yo,MeshPhongMaterial:Ql,MeshToonMaterial:Vu,MeshNormalMaterial:ju,MeshLambertMaterial:Gu,MeshDepthMaterial:Xl,MeshDistanceMaterial:Yl,MeshBasicMaterial:Fi,MeshMatcapMaterial:Hu,LineDashedMaterial:Wu,LineBasicMaterial:ni,Material:er}),ui={arraySlice:function(t,n,e){return ui.isTypedArray(t)?new t.constructor(t.subarray(n,e!==void 0?e:t.length)):t.slice(n,e)},convertArray:function(t,n,e){return!t||!e&&t.constructor===n?t:typeof n.BYTES_PER_ELEMENT=="number"?new n(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function n(a,o){return t[a]-t[o]}for(var e=t.length,i=new Array(e),s=0;s!==e;++s)i[s]=s;return i.sort(n),i},sortedArray:function(t,n,e){for(var i=t.length,s=new t.constructor(i),a=0,o=0;o!==i;++a)for(var r=e[a]*n,u=0;u!==n;++u)s[o++]=t[r+u];return s},flattenJSON:function(t,n,e,i){for(var s=1,a=t[0];a!==void 0&&a[i]===void 0;)a=t[s++];if(a!==void 0){var o=a[i];if(o!==void 0)if(Array.isArray(o))do o=a[i],o!==void 0&&(n.push(a.time),e.push.apply(e,o)),a=t[s++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[i],o!==void 0&&(n.push(a.time),o.toArray(e,e.length)),a=t[s++];while(a!==void 0);else do o=a[i],o!==void 0&&(n.push(a.time),e.push(o)),a=t[s++];while(a!==void 0)}},subclip:function(t,n,e,i,s){s=s||30;var a=t.clone();a.name=n;for(var o=[],r=0;r<a.tracks.length;++r){for(var u=a.tracks[r],l=u.getValueSize(),h=[],f=[],d=0;d<u.times.length;++d){var p=u.times[d]*s;if(!(p<e||p>=i)){h.push(u.times[d]);for(var b=0;b<l;++b)f.push(u.values[d*l+b])}}h.length!==0&&(u.times=ui.convertArray(h,u.times.constructor),u.values=ui.convertArray(f,u.values.constructor),o.push(u))}a.tracks=o;for(var v=1/0,r=0;r<a.tracks.length;++r)v>a.tracks[r].times[0]&&(v=a.tracks[r].times[0]);for(var r=0;r<a.tracks.length;++r)a.tracks[r].shift(-1*v);return a.resetDuration(),a}};function bo(t,n,e,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new n.constructor(e),this.sampleValues=n,this.valueSize=e}Object.assign(bo.prototype,{evaluate:function(t){var n=this.parameterPositions,e=this._cachedIndex,i=n[e],s=n[e-1];t:{e:{var a;n:{r:if(!(t<i)){for(var o=e+2;;){if(i===void 0){if(t<s)break r;return e=n.length,this._cachedIndex=e,this.afterEnd_(e-1,t,s)}if(e===o)break;if(s=i,i=n[++e],t<i)break e}a=n.length;break n}if(!(t>=s)){var r=n[1];t<r&&(e=2,s=r);for(var o=e-2;;){if(s===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(e===o)break;if(i=s,s=n[--e-1],t>=s)break e}a=e,e=0;break n}break t}for(;e<a;){var u=e+a>>>1;t<n[u]?a=u:e=u+1}if(i=n[e],s=n[e-1],s===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(i===void 0)return e=n.length,this._cachedIndex=e,this.afterEnd_(e-1,s,t)}this._cachedIndex=e,this.intervalChanged_(e,s,i)}return this.interpolate_(e,s,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var n=this.resultBuffer,e=this.sampleValues,i=this.valueSize,s=t*i,a=0;a!==i;++a)n[a]=e[s+a];return n},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(bo.prototype,{beforeStart_:bo.prototype.copySampleValue_,afterEnd_:bo.prototype.copySampleValue_});function Oy(t,n,e,i){bo.call(this,t,n,e,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Oy.prototype=Object.assign(Object.create(bo.prototype),{constructor:Oy,DefaultSettings_:{endingStart:nu,endingEnd:nu},intervalChanged_:function(t,n,e){var i=this.parameterPositions,s=t-2,a=t+1,o=i[s],r=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case ru:s=t,o=2*n-e;break;case nm:s=i.length-2,o=n+i[s]-i[s+1];break;default:s=t,o=e}if(r===void 0)switch(this.getSettings_().endingEnd){case ru:a=t,r=2*e-n;break;case nm:a=1,r=e+i[1]-i[0];break;default:a=t-1,r=n}var u=(e-n)*.5,l=this.valueSize;this._weightPrev=u/(n-o),this._weightNext=u/(r-e),this._offsetPrev=s*l,this._offsetNext=a*l},interpolate_:function(t,n,e,i){for(var s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,r=t*o,u=r-o,l=this._offsetPrev,h=this._offsetNext,f=this._weightPrev,d=this._weightNext,p=(e-n)/(i-n),b=p*p,v=b*p,x=-f*v+2*f*b-f*p,w=(1+f)*v+(-1.5-2*f)*b+(-.5+f)*p+1,M=(-1-d)*v+(1.5+d)*b+.5*p,E=d*v-d*b,D=0;D!==o;++D)s[D]=x*a[l+D]+w*a[u+D]+M*a[r+D]+E*a[h+D];return s}});function ng(t,n,e,i){bo.call(this,t,n,e,i)}ng.prototype=Object.assign(Object.create(bo.prototype),{constructor:ng,interpolate_:function(t,n,e,i){for(var s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,r=t*o,u=r-o,l=(e-n)/(i-n),h=1-l,f=0;f!==o;++f)s[f]=a[u+f]*h+a[r+f]*l;return s}});function zy(t,n,e,i){bo.call(this,t,n,e,i)}zy.prototype=Object.assign(Object.create(bo.prototype),{constructor:zy,interpolate_:function(t){return this.copySampleValue_(t-1)}});function Gi(t,n,e,i){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ui.convertArray(n,this.TimeBufferType),this.values=ui.convertArray(e,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}Object.assign(Gi,{toJSON:function(t){var n=t.constructor,e;if(n.toJSON!==void 0)e=n.toJSON(t);else{e={name:t.name,times:ui.convertArray(t.times,Array),values:ui.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e}}),Object.assign(Gi.prototype,{constructor:Gi,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:eu,InterpolantFactoryMethodDiscrete:function(t){return new zy(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new ng(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Oy(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var n;switch(t){case ud:n=this.InterpolantFactoryMethodDiscrete;break;case eu:n=this.InterpolantFactoryMethodLinear;break;case Z1:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){var e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(e);return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=n,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ud;case this.InterpolantFactoryMethodLinear:return eu;case this.InterpolantFactoryMethodSmooth:return Z1}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0)for(var n=this.times,e=0,i=n.length;e!==i;++e)n[e]+=t;return this},scale:function(t){if(t!==1)for(var n=this.times,e=0,i=n.length;e!==i;++e)n[e]*=t;return this},trim:function(t,n){for(var e=this.times,i=e.length,s=0,a=i-1;s!==i&&e[s]<t;)++s;for(;a!==-1&&e[a]>n;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);var o=this.getValueSize();this.times=ui.arraySlice(e,s,a),this.values=ui.arraySlice(this.values,s*o,a*o)}return this},validate:function(){var t=!0,n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,i=this.values,s=e.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==s;o++){var r=e[o];if(typeof r=="number"&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,r),t=!1;break}if(a!==null&&a>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,r,a),t=!1;break}a=r}if(i!==void 0&&ui.isTypedArray(i))for(var o=0,u=i.length;o!==u;++o){var l=i[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),t=!1;break}}return t},optimize:function(){for(var t=ui.arraySlice(this.times),n=ui.arraySlice(this.values),e=this.getValueSize(),i=this.getInterpolation()===Z1,s=1,a=t.length-1,o=1;o<a;++o){var r=!1,u=t[o],l=t[o+1];if(u!==l&&(o!==1||u!==u[0]))if(i)r=!0;else for(var h=o*e,f=h-e,d=h+e,p=0;p!==e;++p){var b=n[h+p];if(b!==n[f+p]||b!==n[d+p]){r=!0;break}}if(r){if(o!==s){t[s]=t[o];for(var v=o*e,x=s*e,p=0;p!==e;++p)n[x+p]=n[v+p]}++s}}if(a>0){t[s]=t[a];for(var v=a*e,x=s*e,p=0;p!==e;++p)n[x+p]=n[v+p];++s}return s!==t.length?(this.times=ui.arraySlice(t,0,s),this.values=ui.arraySlice(n,0,s*e)):(this.times=t,this.values=n),this},clone:function(){var t=ui.arraySlice(this.times,0),n=ui.arraySlice(this.values,0),e=this.constructor,i=new e(this.name,t,n);return i.createInterpolant=this.createInterpolant,i}});function Uy(t,n,e){Gi.call(this,t,n,e)}Uy.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Uy,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ud,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Vy(t,n,e,i){Gi.call(this,t,n,e,i)}Vy.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Vy,ValueTypeName:"color"});function qu(t,n,e,i){Gi.call(this,t,n,e,i)}qu.prototype=Object.assign(Object.create(Gi.prototype),{constructor:qu,ValueTypeName:"number"});function jy(t,n,e,i){bo.call(this,t,n,e,i)}jy.prototype=Object.assign(Object.create(bo.prototype),{constructor:jy,interpolate_:function(t,n,e,i){for(var s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,r=t*o,u=(e-n)/(i-n),l=r+o;r!==l;r+=4)mo.slerpFlat(s,0,a,r-o,a,r,u);return s}});function Yd(t,n,e,i){Gi.call(this,t,n,e,i)}Yd.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Yd,ValueTypeName:"quaternion",DefaultInterpolation:eu,InterpolantFactoryMethodLinear:function(t){return new jy(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0});function Gy(t,n,e,i){Gi.call(this,t,n,e,i)}Gy.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Gy,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ud,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Xu(t,n,e,i){Gi.call(this,t,n,e,i)}Xu.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Xu,ValueTypeName:"vector"});function Zo(t,n,e){this.name=t,this.tracks=e,this.duration=n!==void 0?n:-1,this.uuid=pr.generateUUID(),this.duration<0&&this.resetDuration()}function c8(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return qu;case"vector":case"vector2":case"vector3":case"vector4":return Xu;case"color":return Vy;case"quaternion":return Yd;case"bool":case"boolean":return Uy;case"string":return Gy}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function u8(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var n=c8(t.type);if(t.times===void 0){var e=[],i=[];ui.flattenJSON(t.keys,e,i,"value"),t.times=e,t.values=i}return n.parse!==void 0?n.parse(t):new n(t.name,t.times,t.values,t.interpolation)}Object.assign(Zo,{parse:function(t){for(var n=[],e=t.tracks,i=1/(t.fps||1),s=0,a=e.length;s!==a;++s)n.push(u8(e[s]).scale(i));return new Zo(t.name,t.duration,n)},toJSON:function(t){for(var n=[],e=t.tracks,i={name:t.name,duration:t.duration,tracks:n,uuid:t.uuid},s=0,a=e.length;s!==a;++s)n.push(Gi.toJSON(e[s]));return i},CreateFromMorphTargetSequence:function(t,n,e,i){for(var s=n.length,a=[],o=0;o<s;o++){var r=[],u=[];r.push((o+s-1)%s,o,(o+1)%s),u.push(0,1,0);var l=ui.getKeyframeOrder(r);r=ui.sortedArray(r,1,l),u=ui.sortedArray(u,1,l),!i&&r[0]===0&&(r.push(s),u.push(u[0])),a.push(new qu(".morphTargetInfluences["+n[o].name+"]",r,u).scale(1/e))}return new Zo(t,-1,a)},findByName:function(t,n){var e=t;if(!Array.isArray(t)){var i=t;e=i.geometry&&i.geometry.animations||i.animations}for(var s=0;s<e.length;s++)if(e[s].name===n)return e[s];return null},CreateClipsFromMorphTargetSequences:function(t,n,e){for(var i={},s=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var r=t[a],u=r.name.match(s);if(u&&u.length>1){var l=u[1],h=i[l];h||(i[l]=h=[]),h.push(r)}}var f=[];for(var l in i)f.push(Zo.CreateFromMorphTargetSequence(l,i[l],n,e));return f},parseAnimation:function(t,n){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var e=function(E,D,N,V,K){if(N.length!==0){var j=[],Z=[];ui.flattenJSON(N,j,Z,V),j.length!==0&&K.push(new E(D,j,Z))}},i=[],s=t.name||"default",a=t.length||-1,o=t.fps||30,r=t.hierarchy||[],u=0;u<r.length;u++){var l=r[u].keys;if(!(!l||l.length===0))if(l[0].morphTargets){for(var h={},f=0;f<l.length;f++)if(l[f].morphTargets)for(var d=0;d<l[f].morphTargets.length;d++)h[l[f].morphTargets[d]]=-1;for(var p in h){for(var b=[],v=[],d=0;d!==l[f].morphTargets.length;++d){var x=l[f];b.push(x.time),v.push(x.morphTarget===p?1:0)}i.push(new qu(".morphTargetInfluence["+p+"]",b,v))}a=h.length*(o||1)}else{var w=".bones["+n[u].name+"]";e(Xu,w+".position",l,"pos",i),e(Yd,w+".quaternion",l,"rot",i),e(Xu,w+".scale",l,"scl",i)}}if(i.length===0)return null;var M=new Zo(s,a,i);return M}}),Object.assign(Zo.prototype,{resetDuration:function(){for(var t=this.tracks,n=0,e=0,i=t.length;e!==i;++e){var s=this.tracks[e];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,n=0;n<this.tracks.length;n++)t=t&&this.tracks[n].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],n=0;n<this.tracks.length;n++)t.push(this.tracks[n].clone());return new Zo(this.name,this.duration,t)}});var Yu={enabled:!1,files:{},add:function(t,n){this.enabled!==!1&&(this.files[t]=n)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function W2(t,n,e){var i=this,s=!1,a=0,o=0,r=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=e,this.itemStart=function(l){o++,s===!1&&i.onStart!==void 0&&i.onStart(l,a,o),s=!0},this.itemEnd=function(l){a++,i.onProgress!==void 0&&i.onProgress(l,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(l){i.onError!==void 0&&i.onError(l)},this.resolveURL=function(l){return r?r(l):l},this.setURLModifier=function(l){return r=l,this},this.addHandler=function(l,h){return u.push(l,h),this},this.removeHandler=function(l){var h=u.indexOf(l);return h!==-1&&u.splice(h,2),this},this.getHandler=function(l){for(var h=0,f=u.length;h<f;h+=2){var d=u[h],p=u[h+1];if(d.global&&(d.lastIndex=0),d.test(l))return p}return null}}var h8=new W2;function Tr(t){this.manager=t!==void 0?t:h8,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Tr.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var ds={};function Jo(t){Tr.call(this,t)}Jo.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Jo,load:function(t,n,e,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var s=this,a=Yu.get(t);if(a!==void 0)return s.manager.itemStart(t),setTimeout(function(){n&&n(a),s.manager.itemEnd(t)},0),a;if(ds[t]!==void 0){ds[t].push({onLoad:n,onProgress:e,onError:i});return}var o=/^data:(.*?)(;base64)?,(.*)$/,r=t.match(o);if(r){var u=r[1],l=!!r[2],h=r[3];h=decodeURIComponent(h),l&&(h=atob(h));try{var f,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var p=new Uint8Array(h.length),b=0;b<h.length;b++)p[b]=h.charCodeAt(b);d==="blob"?f=new Blob([p.buffer],{type:u}):f=p.buffer;break;case"document":var v=new DOMParser;f=v.parseFromString(h,u);break;case"json":f=JSON.parse(h);break;default:f=h;break}setTimeout(function(){n&&n(f),s.manager.itemEnd(t)},0)}catch(M){setTimeout(function(){i&&i(M),s.manager.itemError(t),s.manager.itemEnd(t)},0)}}else{ds[t]=[],ds[t].push({onLoad:n,onProgress:e,onError:i});var x=new XMLHttpRequest;x.open("GET",t,!0),x.addEventListener("load",function(M){var E=this.response,D=ds[t];if(delete ds[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Yu.add(t,E);for(var N=0,V=D.length;N<V;N++){var K=D[N];K.onLoad&&K.onLoad(E)}s.manager.itemEnd(t)}else{for(var N=0,V=D.length;N<V;N++){var K=D[N];K.onError&&K.onError(M)}s.manager.itemError(t),s.manager.itemEnd(t)}},!1),x.addEventListener("progress",function(M){for(var E=ds[t],D=0,N=E.length;D<N;D++){var V=E[D];V.onProgress&&V.onProgress(M)}},!1),x.addEventListener("error",function(M){var E=ds[t];delete ds[t];for(var D=0,N=E.length;D<N;D++){var V=E[D];V.onError&&V.onError(M)}s.manager.itemError(t),s.manager.itemEnd(t)},!1),x.addEventListener("abort",function(M){var E=ds[t];delete ds[t];for(var D=0,N=E.length;D<N;D++){var V=E[D];V.onError&&V.onError(M)}s.manager.itemError(t),s.manager.itemEnd(t)},!1),this.responseType!==void 0&&(x.responseType=this.responseType),this.withCredentials!==void 0&&(x.withCredentials=this.withCredentials),x.overrideMimeType&&x.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var w in this.requestHeader)x.setRequestHeader(w,this.requestHeader[w]);x.send(null)}return s.manager.itemStart(t),x},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});function q2(t){Tr.call(this,t)}q2.prototype=Object.assign(Object.create(Tr.prototype),{constructor:q2,load:function(t,n,e,i){var s=this,a=new Jo(s.manager);a.setPath(s.path),a.load(t,function(o){n(s.parse(JSON.parse(o)))},e,i)},parse:function(t){for(var n=[],e=0;e<t.length;e++){var i=Zo.parse(t[e]);n.push(i)}return n}});function X2(t){Tr.call(this,t)}X2.prototype=Object.assign(Object.create(Tr.prototype),{constructor:X2,load:function(t,n,e,i){var s=this,a=[],o=new Id;o.image=a;var r=new Jo(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer");function u(d){r.load(t[d],function(p){var b=s.parse(p,!0);a[d]={width:b.width,height:b.height,format:b.format,mipmaps:b.mipmaps},l+=1,l===6&&(b.mipmapCount===1&&(o.minFilter=pi),o.format=b.format,o.needsUpdate=!0,n&&n(o))},e,i)}if(Array.isArray(t))for(var l=0,h=0,f=t.length;h<f;++h)u(h);else r.load(t,function(d){var p=s.parse(d,!0);if(p.isCubemap)for(var b=p.mipmaps.length/p.mipmapCount,v=0;v<b;v++){a[v]={mipmaps:[]};for(var x=0;x<p.mipmapCount;x++)a[v].mipmaps.push(p.mipmaps[v*p.mipmapCount+x]),a[v].format=p.format,a[v].width=p.width,a[v].height=p.height}else o.image.width=p.width,o.image.height=p.height,o.mipmaps=p.mipmaps;p.mipmapCount===1&&(o.minFilter=pi),o.format=p.format,o.needsUpdate=!0,n&&n(o)},e,i);return o}});function Y2(t){Tr.call(this,t)}Y2.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Y2,load:function(t,n,e,i){var s=this,a=new wu,o=new Jo(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,function(r){var u=s.parse(r);u&&(u.image!==void 0?a.image=u.image:u.data!==void 0&&(a.image.width=u.width,a.image.height=u.height,a.image.data=u.data),a.wrapS=u.wrapS!==void 0?u.wrapS:Qi,a.wrapT=u.wrapT!==void 0?u.wrapT:Qi,a.magFilter=u.magFilter!==void 0?u.magFilter:pi,a.minFilter=u.minFilter!==void 0?u.minFilter:pi,a.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.format!==void 0&&(a.format=u.format),u.type!==void 0&&(a.type=u.type),u.mipmaps!==void 0&&(a.mipmaps=u.mipmaps,a.minFilter=Qc),u.mipmapCount===1&&(a.minFilter=pi),a.needsUpdate=!0,n&&n(a,u))},e,i),a}});function Kd(t){Tr.call(this,t)}Kd.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Kd,load:function(t,n,e,i){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var s=this,a=Yu.get(t);if(a!==void 0)return s.manager.itemStart(t),setTimeout(function(){n&&n(a),s.manager.itemEnd(t)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function r(){o.removeEventListener("load",r,!1),o.removeEventListener("error",u,!1),Yu.add(t,this),n&&n(this),s.manager.itemEnd(t)}function u(l){o.removeEventListener("load",r,!1),o.removeEventListener("error",u,!1),i&&i(l),s.manager.itemError(t),s.manager.itemEnd(t)}return o.addEventListener("load",r,!1),o.addEventListener("error",u,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(t),o.src=t,o}});function Hy(t){Tr.call(this,t)}Hy.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Hy,load:function(t,n,e,i){var s=new Wa,a=new Kd(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function r(l){a.load(t[l],function(h){s.images[l]=h,o++,o===6&&(s.needsUpdate=!0,n&&n(s))},void 0,i)}for(var u=0;u<t.length;++u)r(u);return s}});function Zd(t){Tr.call(this,t)}Zd.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Zd,load:function(t,n,e,i){var s=new Nr,a=new Kd(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(o){s.image=o;var r=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;s.format=r?oa:as,s.needsUpdate=!0,n!==void 0&&n(s)},e,i),s}});function Jn(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Jn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,n){var e=this.getUtoTmapping(t);return this.getPoint(e,n)},getPoints:function(t){t===void 0&&(t=5);for(var n=[],e=0;e<=t;e++)n.push(this.getPoint(e/t));return n},getSpacedPoints:function(t){t===void 0&&(t=5);for(var n=[],e=0;e<=t;e++)n.push(this.getPointAt(e/t));return n},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n=[],e,i=this.getPoint(0),s,a=0;for(n.push(0),s=1;s<=t;s++)e=this.getPoint(s/t),a+=e.distanceTo(i),n.push(a),i=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,n){var e=this.getLengths(),i=0,s=e.length,a;n?a=n:a=t*e[s-1];for(var o=0,r=s-1,u;o<=r;)if(i=Math.floor(o+(r-o)/2),u=e[i]-a,u<0)o=i+1;else if(u>0)r=i-1;else{r=i;break}if(i=r,e[i]===a)return i/(s-1);var l=e[i],h=e[i+1],f=h-l,d=(a-l)/f,p=(i+d)/(s-1);return p},getTangent:function(t){var n=1e-4,e=t-n,i=t+n;e<0&&(e=0),i>1&&(i=1);var s=this.getPoint(e),a=this.getPoint(i),o=a.clone().sub(s);return o.normalize()},getTangentAt:function(t){var n=this.getUtoTmapping(t);return this.getTangent(n)},computeFrenetFrames:function(t,n){var e=new oe,i=[],s=[],a=[],o=new oe,r=new mr,u,l,h;for(u=0;u<=t;u++)l=u/t,i[u]=this.getTangentAt(l),i[u].normalize();s[0]=new oe,a[0]=new oe;var f=Number.MAX_VALUE,d=Math.abs(i[0].x),p=Math.abs(i[0].y),b=Math.abs(i[0].z);for(d<=f&&(f=d,e.set(1,0,0)),p<=f&&(f=p,e.set(0,1,0)),b<=f&&e.set(0,0,1),o.crossVectors(i[0],e).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]),u=1;u<=t;u++)s[u]=s[u-1].clone(),a[u]=a[u-1].clone(),o.crossVectors(i[u-1],i[u]),o.length()>Number.EPSILON&&(o.normalize(),h=Math.acos(pr.clamp(i[u-1].dot(i[u]),-1,1)),s[u].applyMatrix4(r.makeRotationAxis(o,h))),a[u].crossVectors(i[u],s[u]);if(n===!0)for(h=Math.acos(pr.clamp(s[0].dot(s[t]),-1,1)),h/=t,i[0].dot(o.crossVectors(s[0],s[t]))>0&&(h=-h),u=1;u<=t;u++)s[u].applyMatrix4(r.makeRotationAxis(i[u],h*u)),a[u].crossVectors(i[u],s[u]);return{tangents:i,normals:s,binormals:a}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}});function $o(t,n,e,i,s,a,o,r){Jn.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=n||0,this.xRadius=e||1,this.yRadius=i||1,this.aStartAngle=s||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=r||0}$o.prototype=Object.create(Jn.prototype),$o.prototype.constructor=$o,$o.prototype.isEllipseCurve=!0,$o.prototype.getPoint=function(t,n){for(var e=n||new on,i=Math.PI*2,s=this.aEndAngle-this.aStartAngle,a=Math.abs(s)<Number.EPSILON;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);var o=this.aStartAngle+t*s,r=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){var l=Math.cos(this.aRotation),h=Math.sin(this.aRotation),f=r-this.aX,d=u-this.aY;r=f*l-d*h+this.aX,u=f*h+d*l+this.aY}return e.set(r,u)},$o.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},$o.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},$o.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this};function Jd(t,n,e,i,s,a){$o.call(this,t,n,e,e,i,s,a),this.type="ArcCurve"}Jd.prototype=Object.create($o.prototype),Jd.prototype.constructor=Jd,Jd.prototype.isArcCurve=!0;function Wy(){var t=0,n=0,e=0,i=0;function s(a,o,r,u){t=a,n=r,e=-3*a+3*o-2*r-u,i=2*a-2*o+r+u}return{initCatmullRom:function(a,o,r,u,l){s(o,r,l*(r-a),l*(u-o))},initNonuniformCatmullRom:function(a,o,r,u,l,h,f){var d=(o-a)/l-(r-a)/(l+h)+(r-o)/h,p=(r-o)/h-(u-o)/(h+f)+(u-r)/f;d*=h,p*=h,s(o,r,d,p)},calc:function(a){var o=a*a,r=o*a;return t+n*a+e*o+i*r}}}var rg=new oe,qy=new Wy,Xy=new Wy,Yy=new Wy;function jo(t,n,e,i){Jn.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=n||!1,this.curveType=e||"centripetal",this.tension=i||.5}jo.prototype=Object.create(Jn.prototype),jo.prototype.constructor=jo,jo.prototype.isCatmullRomCurve3=!0,jo.prototype.getPoint=function(t,n){var e=n||new oe,i=this.points,s=i.length,a=(s-(this.closed?0:1))*t,o=Math.floor(a),r=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:r===0&&o===s-1&&(o=s-2,r=1);var u,l,h,f;if(this.closed||o>0?u=i[(o-1)%s]:(rg.subVectors(i[0],i[1]).add(i[0]),u=rg),l=i[o%s],h=i[(o+1)%s],this.closed||o+2<s?f=i[(o+2)%s]:(rg.subVectors(i[s-1],i[s-2]).add(i[s-1]),f=rg),this.curveType==="centripetal"||this.curveType==="chordal"){var d=this.curveType==="chordal"?.5:.25,p=Math.pow(u.distanceToSquared(l),d),b=Math.pow(l.distanceToSquared(h),d),v=Math.pow(h.distanceToSquared(f),d);b<1e-4&&(b=1),p<1e-4&&(p=b),v<1e-4&&(v=b),qy.initNonuniformCatmullRom(u.x,l.x,h.x,f.x,p,b,v),Xy.initNonuniformCatmullRom(u.y,l.y,h.y,f.y,p,b,v),Yy.initNonuniformCatmullRom(u.z,l.z,h.z,f.z,p,b,v)}else this.curveType==="catmullrom"&&(qy.initCatmullRom(u.x,l.x,h.x,f.x,this.tension),Xy.initCatmullRom(u.y,l.y,h.y,f.y,this.tension),Yy.initCatmullRom(u.z,l.z,h.z,f.z,this.tension));return e.set(qy.calc(r),Xy.calc(r),Yy.calc(r)),e},jo.prototype.copy=function(t){Jn.prototype.copy.call(this,t),this.points=[];for(var n=0,e=t.points.length;n<e;n++){var i=t.points[n];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},jo.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);t.points=[];for(var n=0,e=this.points.length;n<e;n++){var i=this.points[n];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},jo.prototype.fromJSON=function(t){Jn.prototype.fromJSON.call(this,t),this.points=[];for(var n=0,e=t.points.length;n<e;n++){var i=t.points[n];this.points.push(new oe().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this};function K2(t,n,e,i,s){var a=(i-n)*.5,o=(s-e)*.5,r=t*t,u=t*r;return(2*e-2*i+a+o)*u+(-3*e+3*i-2*a-o)*r+a*t+e}function d8(t,n){var e=1-t;return e*e*n}function f8(t,n){return 2*(1-t)*t*n}function p8(t,n){return t*t*n}function $d(t,n,e,i){return d8(t,n)+f8(t,e)+p8(t,i)}function m8(t,n){var e=1-t;return e*e*e*n}function g8(t,n){var e=1-t;return 3*e*e*t*n}function y8(t,n){return 3*(1-t)*t*t*n}function b8(t,n){return t*t*t*n}function Qd(t,n,e,i,s){return m8(t,n)+g8(t,e)+y8(t,i)+b8(t,s)}function ks(t,n,e,i){Jn.call(this),this.type="CubicBezierCurve",this.v0=t||new on,this.v1=n||new on,this.v2=e||new on,this.v3=i||new on}ks.prototype=Object.create(Jn.prototype),ks.prototype.constructor=ks,ks.prototype.isCubicBezierCurve=!0,ks.prototype.getPoint=function(t,n){var e=n||new on,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return e.set(Qd(t,i.x,s.x,a.x,o.x),Qd(t,i.y,s.y,a.y,o.y)),e},ks.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ks.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ks.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this};function ba(t,n,e,i){Jn.call(this),this.type="CubicBezierCurve3",this.v0=t||new oe,this.v1=n||new oe,this.v2=e||new oe,this.v3=i||new oe}ba.prototype=Object.create(Jn.prototype),ba.prototype.constructor=ba,ba.prototype.isCubicBezierCurve3=!0,ba.prototype.getPoint=function(t,n){var e=n||new oe,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return e.set(Qd(t,i.x,s.x,a.x,o.x),Qd(t,i.y,s.y,a.y,o.y),Qd(t,i.z,s.z,a.z,o.z)),e},ba.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ba.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ba.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this};function Go(t,n){Jn.call(this),this.type="LineCurve",this.v1=t||new on,this.v2=n||new on}Go.prototype=Object.create(Jn.prototype),Go.prototype.constructor=Go,Go.prototype.isLineCurve=!0,Go.prototype.getPoint=function(t,n){var e=n||new on;return t===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Go.prototype.getPointAt=function(t,n){return this.getPoint(t,n)},Go.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},Go.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Go.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Go.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function Is(t,n){Jn.call(this),this.type="LineCurve3",this.v1=t||new oe,this.v2=n||new oe}Is.prototype=Object.create(Jn.prototype),Is.prototype.constructor=Is,Is.prototype.isLineCurve3=!0,Is.prototype.getPoint=function(t,n){var e=n||new oe;return t===1?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Is.prototype.getPointAt=function(t,n){return this.getPoint(t,n)},Is.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Is.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Is.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function Ls(t,n,e){Jn.call(this),this.type="QuadraticBezierCurve",this.v0=t||new on,this.v1=n||new on,this.v2=e||new on}Ls.prototype=Object.create(Jn.prototype),Ls.prototype.constructor=Ls,Ls.prototype.isQuadraticBezierCurve=!0,Ls.prototype.getPoint=function(t,n){var e=n||new on,i=this.v0,s=this.v1,a=this.v2;return e.set($d(t,i.x,s.x,a.x),$d(t,i.y,s.y,a.y)),e},Ls.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ls.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ls.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function va(t,n,e){Jn.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new oe,this.v1=n||new oe,this.v2=e||new oe}va.prototype=Object.create(Jn.prototype),va.prototype.constructor=va,va.prototype.isQuadraticBezierCurve3=!0,va.prototype.getPoint=function(t,n){var e=n||new oe,i=this.v0,s=this.v1,a=this.v2;return e.set($d(t,i.x,s.x,a.x),$d(t,i.y,s.y,a.y),$d(t,i.z,s.z,a.z)),e},va.prototype.copy=function(t){return Jn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},va.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},va.prototype.fromJSON=function(t){return Jn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function Bs(t){Jn.call(this),this.type="SplineCurve",this.points=t||[]}Bs.prototype=Object.create(Jn.prototype),Bs.prototype.constructor=Bs,Bs.prototype.isSplineCurve=!0,Bs.prototype.getPoint=function(t,n){var e=n||new on,i=this.points,s=(i.length-1)*t,a=Math.floor(s),o=s-a,r=i[a===0?a:a-1],u=i[a],l=i[a>i.length-2?i.length-1:a+1],h=i[a>i.length-3?i.length-1:a+2];return e.set(K2(o,r.x,u.x,l.x,h.x),K2(o,r.y,u.y,l.y,h.y)),e},Bs.prototype.copy=function(t){Jn.prototype.copy.call(this,t),this.points=[];for(var n=0,e=t.points.length;n<e;n++){var i=t.points[n];this.points.push(i.clone())}return this},Bs.prototype.toJSON=function(){var t=Jn.prototype.toJSON.call(this);t.points=[];for(var n=0,e=this.points.length;n<e;n++){var i=this.points[n];t.points.push(i.toArray())}return t},Bs.prototype.fromJSON=function(t){Jn.prototype.fromJSON.call(this,t),this.points=[];for(var n=0,e=t.points.length;n<e;n++){var i=t.points[n];this.points.push(new on().fromArray(i))}return this};var Ky=Object.freeze({__proto__:null,ArcCurve:Jd,CatmullRomCurve3:jo,CubicBezierCurve:ks,CubicBezierCurve3:ba,EllipseCurve:$o,LineCurve:Go,LineCurve3:Is,QuadraticBezierCurve:Ls,QuadraticBezierCurve3:va,SplineCurve:Bs});function Ja(){Jn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Ja.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Ja,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);t.equals(n)||this.curves.push(new Go(n,t))},getPoint:function(t){for(var n=t*this.getLength(),e=this.getCurveLengths(),i=0;i<e.length;){if(e[i]>=n){var s=e[i]-n,a=this.curves[i],o=a.getLength(),r=o===0?0:1-s/o;return a.getPointAt(r)}i++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],n=0,e=0,i=this.curves.length;e<i;e++)n+=this.curves[e].getLength(),t.push(n);return this.cacheLengths=t,t},getSpacedPoints:function(t){t===void 0&&(t=40);for(var n=[],e=0;e<=t;e++)n.push(this.getPoint(e/t));return this.autoClose&&n.push(n[0]),n},getPoints:function(t){t=t||12;for(var n=[],e,i=0,s=this.curves;i<s.length;i++)for(var a=s[i],o=a&&a.isEllipseCurve?t*2:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,r=a.getPoints(o),u=0;u<r.length;u++){var l=r[u];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Jn.prototype.copy.call(this,t),this.curves=[];for(var n=0,e=t.curves.length;n<e;n++){var i=t.curves[n];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Jn.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var n=0,e=this.curves.length;n<e;n++){var i=this.curves[n];t.curves.push(i.toJSON())}return t},fromJSON:function(t){Jn.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var n=0,e=t.curves.length;n<e;n++){var i=t.curves[n];this.curves.push(new Ky[i.type]().fromJSON(i))}return this}});function Fs(t){Ja.call(this),this.type="Path",this.currentPoint=new on,t&&this.setFromPoints(t)}Fs.prototype=Object.assign(Object.create(Ja.prototype),{constructor:Fs,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var n=1,e=t.length;n<e;n++)this.lineTo(t[n].x,t[n].y);return this},moveTo:function(t,n){return this.currentPoint.set(t,n),this},lineTo:function(t,n){var e=new Go(this.currentPoint.clone(),new on(t,n));return this.curves.push(e),this.currentPoint.set(t,n),this},quadraticCurveTo:function(t,n,e,i){var s=new Ls(this.currentPoint.clone(),new on(t,n),new on(e,i));return this.curves.push(s),this.currentPoint.set(e,i),this},bezierCurveTo:function(t,n,e,i,s,a){var o=new ks(this.currentPoint.clone(),new on(t,n),new on(e,i),new on(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this},splineThru:function(t){var n=[this.currentPoint.clone()].concat(t),e=new Bs(n);return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,n,e,i,s,a){var o=this.currentPoint.x,r=this.currentPoint.y;return this.absarc(t+o,n+r,e,i,s,a),this},absarc:function(t,n,e,i,s,a){return this.absellipse(t,n,e,e,i,s,a),this},ellipse:function(t,n,e,i,s,a,o,r){var u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(t+u,n+l,e,i,s,a,o,r),this},absellipse:function(t,n,e,i,s,a,o,r){var u=new $o(t,n,e,i,s,a,o,r);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var h=u.getPoint(1);return this.currentPoint.copy(h),this},copy:function(t){return Ja.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Ja.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Ja.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}});function tc(t){Fs.call(this,t),this.uuid=pr.generateUUID(),this.type="Shape",this.holes=[]}tc.prototype=Object.assign(Object.create(Fs.prototype),{constructor:tc,getPointsHoles:function(t){for(var n=[],e=0,i=this.holes.length;e<i;e++)n[e]=this.holes[e].getPoints(t);return n},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Fs.prototype.copy.call(this,t),this.holes=[];for(var n=0,e=t.holes.length;n<e;n++){var i=t.holes[n];this.holes.push(i.clone())}return this},toJSON:function(){var t=Fs.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var n=0,e=this.holes.length;n<e;n++){var i=this.holes[n];t.holes.push(i.toJSON())}return t},fromJSON:function(t){Fs.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var n=0,e=t.holes.length;n<e;n++){var i=t.holes[n];this.holes.push(new Fs().fromJSON(i))}return this}});function Wr(t,n){Rn.call(this),this.type="Light",this.color=new Dn(t),this.intensity=n!==void 0?n:1,this.receiveShadow=void 0}Wr.prototype=Object.assign(Object.create(Rn.prototype),{constructor:Wr,isLight:!0,copy:function(t){return Rn.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var n=Rn.prototype.toJSON.call(this,t);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}});function Zy(t,n,e){Wr.call(this,t,e),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Rn.DefaultUp),this.updateMatrix(),this.groundColor=new Dn(n)}Zy.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Zy,isHemisphereLight:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}});function xa(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new on(512,512),this.map=null,this.mapPass=null,this.matrix=new mr,this._frustum=new wd,this._frameExtents=new on(1,1),this._viewportCount=1,this._viewports=[new Or(0,0,1,1)]}Object.assign(xa.prototype,{_projScreenMatrix:new mr,_lightPositionWorld:new oe,_lookTarget:new oe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var n=this.camera,e=this.matrix,i=this._projScreenMatrix,s=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(t.matrixWorld),n.position.copy(a),s.setFromMatrixPosition(t.target.matrixWorld),n.lookAt(s),n.updateMatrixWorld(),i.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),e.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),e.multiply(n.projectionMatrix),e.multiply(n.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return this.bias!==0&&(t.bias=this.bias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}});function Jy(){xa.call(this,new gi(50,1,.5,500))}Jy.prototype=Object.assign(Object.create(xa.prototype),{constructor:Jy,isSpotLightShadow:!0,updateMatrices:function(t){var n=this.camera,e=pr.RAD2DEG*2*t.angle,i=this.mapSize.width/this.mapSize.height,s=t.distance||n.far;(e!==n.fov||i!==n.aspect||s!==n.far)&&(n.fov=e,n.aspect=i,n.far=s,n.updateProjectionMatrix()),xa.prototype.updateMatrices.call(this,t)}});function ig(t,n,e,i,s,a){Wr.call(this,t,n),this.type="SpotLight",this.position.copy(Rn.DefaultUp),this.updateMatrix(),this.target=new Rn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(o){this.intensity=o/Math.PI}}),this.distance=e!==void 0?e:0,this.angle=i!==void 0?i:Math.PI/3,this.penumbra=s!==void 0?s:0,this.decay=a!==void 0?a:1,this.shadow=new Jy}ig.prototype=Object.assign(Object.create(Wr.prototype),{constructor:ig,isSpotLight:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function $y(){xa.call(this,new gi(90,1,.5,500)),this._frameExtents=new on(4,2),this._viewportCount=6,this._viewports=[new Or(2,1,1,1),new Or(0,1,1,1),new Or(3,1,1,1),new Or(1,1,1,1),new Or(3,0,1,1),new Or(1,0,1,1)],this._cubeDirections=[new oe(1,0,0),new oe(-1,0,0),new oe(0,0,1),new oe(0,0,-1),new oe(0,1,0),new oe(0,-1,0)],this._cubeUps=[new oe(0,1,0),new oe(0,1,0),new oe(0,1,0),new oe(0,1,0),new oe(0,0,1),new oe(0,0,-1)]}$y.prototype=Object.assign(Object.create(xa.prototype),{constructor:$y,isPointLightShadow:!0,updateMatrices:function(t,n){n===void 0&&(n=0);var e=this.camera,i=this.matrix,s=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;s.setFromMatrixPosition(t.matrixWorld),e.position.copy(s),a.copy(e.position),a.add(this._cubeDirections[n]),e.up.copy(this._cubeUps[n]),e.lookAt(a),e.updateMatrixWorld(),i.makeTranslation(-s.x,-s.y,-s.z),o.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}});function og(t,n,e,i){Wr.call(this,t,n),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(s){this.intensity=s/(4*Math.PI)}}),this.distance=e!==void 0?e:0,this.decay=i!==void 0?i:1,this.shadow=new $y}og.prototype=Object.assign(Object.create(Wr.prototype),{constructor:og,isPointLight:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}});function Ku(t,n,e,i,s,a){pa.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t!==void 0?t:-1,this.right=n!==void 0?n:1,this.top=e!==void 0?e:1,this.bottom=i!==void 0?i:-1,this.near=s!==void 0?s:.1,this.far=a!==void 0?a:2e3,this.updateProjectionMatrix()}Ku.prototype=Object.assign(Object.create(pa.prototype),{constructor:Ku,isOrthographicCamera:!0,copy:function(t,n){return pa.prototype.copy.call(this,t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this},setViewOffset:function(t,n,e,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=e,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,i=(this.top+this.bottom)/2,s=e-t,a=e+t,o=i+n,r=i-n;if(this.view!==null&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,a=s+u*this.view.width,o-=l*this.view.offsetY,r=o-l*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var n=Rn.prototype.toJSON.call(this,t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}});function Qy(){xa.call(this,new Ku(-5,5,5,-5,.5,500))}Qy.prototype=Object.assign(Object.create(xa.prototype),{constructor:Qy,isDirectionalLightShadow:!0,updateMatrices:function(t){xa.prototype.updateMatrices.call(this,t)}});function sg(t,n){Wr.call(this,t,n),this.type="DirectionalLight",this.position.copy(Rn.DefaultUp),this.updateMatrix(),this.target=new Rn,this.shadow=new Qy}sg.prototype=Object.assign(Object.create(Wr.prototype),{constructor:sg,isDirectionalLight:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function tb(t,n){Wr.call(this,t,n),this.type="AmbientLight",this.castShadow=void 0}tb.prototype=Object.assign(Object.create(Wr.prototype),{constructor:tb,isAmbientLight:!0});function eb(t,n,e,i){Wr.call(this,t,n),this.type="RectAreaLight",this.width=e!==void 0?e:10,this.height=i!==void 0?i:10}eb.prototype=Object.assign(Object.create(Wr.prototype),{constructor:eb,isRectAreaLight:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var n=Wr.prototype.toJSON.call(this,t);return n.object.width=this.width,n.object.height=this.height,n}});function nb(t){Tr.call(this,t),this.textures={}}nb.prototype=Object.assign(Object.create(Tr.prototype),{constructor:nb,load:function(t,n,e,i){var s=this,a=new Jo(s.manager);a.setPath(s.path),a.load(t,function(o){n(s.parse(JSON.parse(o)))},e,i)},parse:function(t){var n=this.textures;function e(u){return n[u]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",u),n[u]}var i=new l8[t.type];if(t.uuid!==void 0&&(i.uuid=t.uuid),t.name!==void 0&&(i.name=t.name),t.color!==void 0&&i.color.setHex(t.color),t.roughness!==void 0&&(i.roughness=t.roughness),t.metalness!==void 0&&(i.metalness=t.metalness),t.sheen!==void 0&&(i.sheen=new Dn().setHex(t.sheen)),t.emissive!==void 0&&i.emissive.setHex(t.emissive),t.specular!==void 0&&i.specular.setHex(t.specular),t.shininess!==void 0&&(i.shininess=t.shininess),t.clearcoat!==void 0&&(i.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=t.clearcoatRoughness),t.vertexColors!==void 0&&(i.vertexColors=t.vertexColors),t.fog!==void 0&&(i.fog=t.fog),t.flatShading!==void 0&&(i.flatShading=t.flatShading),t.blending!==void 0&&(i.blending=t.blending),t.combine!==void 0&&(i.combine=t.combine),t.side!==void 0&&(i.side=t.side),t.opacity!==void 0&&(i.opacity=t.opacity),t.transparent!==void 0&&(i.transparent=t.transparent),t.alphaTest!==void 0&&(i.alphaTest=t.alphaTest),t.depthTest!==void 0&&(i.depthTest=t.depthTest),t.depthWrite!==void 0&&(i.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(i.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(i.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(i.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(i.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(i.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(i.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(i.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(i.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(i.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(i.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(i.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(i.rotation=t.rotation),t.linewidth!==1&&(i.linewidth=t.linewidth),t.dashSize!==void 0&&(i.dashSize=t.dashSize),t.gapSize!==void 0&&(i.gapSize=t.gapSize),t.scale!==void 0&&(i.scale=t.scale),t.polygonOffset!==void 0&&(i.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(i.skinning=t.skinning),t.morphTargets!==void 0&&(i.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(i.morphNormals=t.morphNormals),t.dithering!==void 0&&(i.dithering=t.dithering),t.visible!==void 0&&(i.visible=t.visible),t.toneMapped!==void 0&&(i.toneMapped=t.toneMapped),t.userData!==void 0&&(i.userData=t.userData),t.uniforms!==void 0)for(var s in t.uniforms){var a=t.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=e(a.value);break;case"c":i.uniforms[s].value=new Dn().setHex(a.value);break;case"v2":i.uniforms[s].value=new on().fromArray(a.value);break;case"v3":i.uniforms[s].value=new oe().fromArray(a.value);break;case"v4":i.uniforms[s].value=new Or().fromArray(a.value);break;case"m3":i.uniforms[s].value=new Vi().fromArray(a.value);case"m4":i.uniforms[s].value=new mr().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(t.defines!==void 0&&(i.defines=t.defines),t.vertexShader!==void 0&&(i.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(i.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(var o in t.extensions)i.extensions[o]=t.extensions[o];if(t.shading!==void 0&&(i.flatShading=t.shading===1),t.size!==void 0&&(i.size=t.size),t.sizeAttenuation!==void 0&&(i.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(i.map=e(t.map)),t.matcap!==void 0&&(i.matcap=e(t.matcap)),t.alphaMap!==void 0&&(i.alphaMap=e(t.alphaMap),i.transparent=!0),t.bumpMap!==void 0&&(i.bumpMap=e(t.bumpMap)),t.bumpScale!==void 0&&(i.bumpScale=t.bumpScale),t.normalMap!==void 0&&(i.normalMap=e(t.normalMap)),t.normalMapType!==void 0&&(i.normalMapType=t.normalMapType),t.normalScale!==void 0){var r=t.normalScale;Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new on().fromArray(r)}return t.displacementMap!==void 0&&(i.displacementMap=e(t.displacementMap)),t.displacementScale!==void 0&&(i.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(i.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(i.roughnessMap=e(t.roughnessMap)),t.metalnessMap!==void 0&&(i.metalnessMap=e(t.metalnessMap)),t.emissiveMap!==void 0&&(i.emissiveMap=e(t.emissiveMap)),t.emissiveIntensity!==void 0&&(i.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(i.specularMap=e(t.specularMap)),t.envMap!==void 0&&(i.envMap=e(t.envMap)),t.envMapIntensity!==void 0&&(i.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(i.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(i.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(i.lightMap=e(t.lightMap)),t.lightMapIntensity!==void 0&&(i.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(i.aoMap=e(t.aoMap)),t.aoMapIntensity!==void 0&&(i.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(i.gradientMap=e(t.gradientMap)),t.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=e(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new on().fromArray(t.clearcoatNormalScale)),i},setTextures:function(t){return this.textures=t,this}});var ec={decodeText:function(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);for(var n="",e=0,i=t.length;e<i;e++)n+=String.fromCharCode(t[e]);try{return decodeURIComponent(escape(n))}catch(s){return n}},extractUrlBase:function(t){var n=t.lastIndexOf("/");return n===-1?"./":t.substr(0,n+1)}};function rb(){Un.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}rb.prototype=Object.assign(Object.create(Un.prototype),{constructor:rb,isInstancedBufferGeometry:!0,copy:function(t){return Un.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=Un.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}});function ib(t,n,e,i){typeof e=="number"&&(i=e,e=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),nr.call(this,t,n,e),this.meshPerAttribute=i||1}ib.prototype=Object.assign(Object.create(nr.prototype),{constructor:ib,isInstancedBufferAttribute:!0,copy:function(t){return nr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=nr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}});function ob(t){Tr.call(this,t)}ob.prototype=Object.assign(Object.create(Tr.prototype),{constructor:ob,load:function(t,n,e,i){var s=this,a=new Jo(s.manager);a.setPath(s.path),a.load(t,function(o){n(s.parse(JSON.parse(o)))},e,i)},parse:function(t){var n=t.isInstancedBufferGeometry?new rb:new Un,e=t.data.index;if(e!==void 0){var i=new sb[e.type](e.array);n.setIndex(new nr(i,1))}var s=t.data.attributes;for(var a in s){var o=s[a],i=new sb[o.type](o.array),r=o.isInstancedBufferAttribute?ib:nr,u=new r(i,o.itemSize,o.normalized);o.name!==void 0&&(u.name=o.name),n.setAttribute(a,u)}var l=t.data.morphAttributes;if(l)for(var a in l){for(var h=l[a],f=[],d=0,p=h.length;d<p;d++){var o=h[d],i=new sb[o.type](o.array),u=new nr(i,o.itemSize,o.normalized);o.name!==void 0&&(u.name=o.name),f.push(u)}n.morphAttributes[a]=f}var b=t.data.morphTargetsRelative;b&&(n.morphTargetsRelative=!0);var v=t.data.groups||t.data.drawcalls||t.data.offsets;if(v!==void 0)for(var d=0,x=v.length;d!==x;++d){var w=v[d];n.addGroup(w.start,w.count,w.materialIndex)}var M=t.data.boundingSphere;if(M!==void 0){var E=new oe;M.center!==void 0&&E.fromArray(M.center),n.boundingSphere=new ua(E,M.radius)}return t.name&&(n.name=t.name),t.userData&&(n.userData=t.userData),n}});var sb={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ab(t){Tr.call(this,t)}ab.prototype=Object.assign(Object.create(Tr.prototype),{constructor:ab,load:function(t,n,e,i){var s=this,a=this.path===""?ec.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;var o=new Jo(s.manager);o.setPath(this.path),o.load(t,function(r){var u=null;try{u=JSON.parse(r)}catch(h){i!==void 0&&i(h),console.error("THREE:ObjectLoader: Can't parse "+t+".",h.message);return}var l=u.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+t);return}s.parse(u,n)},e,i)},parse:function(t,n){var e=this.parseShape(t.shapes),i=this.parseGeometries(t.geometries,e),s=this.parseImages(t.images,function(){n!==void 0&&n(r)}),a=this.parseTextures(t.textures,s),o=this.parseMaterials(t.materials,a),r=this.parseObject(t.object,i,o);return t.animations&&(r.animations=this.parseAnimations(t.animations)),(t.images===void 0||t.images.length===0)&&n!==void 0&&n(r),r},parseShape:function(t){var n={};if(t!==void 0)for(var e=0,i=t.length;e<i;e++){var s=new tc().fromJSON(t[e]);n[s.uuid]=s}return n},parseGeometries:function(t,n){var e={};if(t!==void 0)for(var i=new ob,s=0,a=t.length;s<a;s++){var o,r=t[s];switch(r.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new eo[r.type](r.width,r.height,r.widthSegments,r.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new eo[r.type](r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new eo[r.type](r.radius,r.segments,r.thetaStart,r.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new eo[r.type](r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new eo[r.type](r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new eo[r.type](r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new eo[r.type](r.radius,r.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new eo[r.type](r.innerRadius,r.outerRadius,r.thetaSegments,r.phiSegments,r.thetaStart,r.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new eo[r.type](r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new eo[r.type](r.radius,r.tube,r.tubularSegments,r.radialSegments,r.p,r.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new eo[r.type](new Ky[r.path.type]().fromJSON(r.path),r.tubularSegments,r.radius,r.radialSegments,r.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new eo[r.type](r.points,r.segments,r.phiStart,r.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new eo[r.type](r.vertices,r.indices,r.radius,r.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var f=[],u=0,l=r.shapes.length;u<l;u++){var h=n[r.shapes[u]];f.push(h)}o=new eo[r.type](f,r.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(var f=[],u=0,l=r.shapes.length;u<l;u++){var h=n[r.shapes[u]];f.push(h)}var d=r.options.extrudePath;d!==void 0&&(r.options.extrudePath=new Ky[d.type]().fromJSON(d)),o=new eo[r.type](f,r.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(r);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var p=new THREE.LegacyJSONLoader;o=p.parse(r,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+r.type+'"');continue}o.uuid=r.uuid,r.name!==void 0&&(o.name=r.name),o.isBufferGeometry===!0&&r.userData!==void 0&&(o.userData=r.userData),e[r.uuid]=o}return e},parseMaterials:function(t,n){var e={},i={};if(t!==void 0){var s=new nb;s.setTextures(n);for(var a=0,o=t.length;a<o;a++){var r=t[a];if(r.type==="MultiMaterial"){for(var u=[],l=0;l<r.materials.length;l++){var h=r.materials[l];e[h.uuid]===void 0&&(e[h.uuid]=s.parse(h)),u.push(e[h.uuid])}i[r.uuid]=u}else e[r.uuid]===void 0&&(e[r.uuid]=s.parse(r)),i[r.uuid]=e[r.uuid]}}return i},parseAnimations:function(t){for(var n=[],e=0;e<t.length;e++){var i=t[e],s=Zo.parse(i);i.uuid!==void 0&&(s.uuid=i.uuid),n.push(s)}return n},parseImages:function(t,n){var e=this,i={};function s(v){return e.manager.itemStart(v),o.load(v,function(){e.manager.itemEnd(v)},void 0,function(){e.manager.itemError(v),e.manager.itemEnd(v)})}if(t!==void 0&&t.length>0){var a=new W2(n),o=new Kd(a);o.setCrossOrigin(this.crossOrigin);for(var r=0,u=t.length;r<u;r++){var l=t[r],h=l.url;if(Array.isArray(h)){i[l.uuid]=[];for(var f=0,d=h.length;f<d;f++){var p=h[f],b=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:e.resourcePath+p;i[l.uuid].push(s(b))}}else{var b=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:e.resourcePath+l.url;i[l.uuid]=s(b)}}}return i},parseTextures:function(t,n){function e(u,l){return typeof u=="number"?u:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",u),l[u])}var i={};if(t!==void 0)for(var s=0,a=t.length;s<a;s++){var o=t[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),n[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var r;Array.isArray(n[o.image])?r=new Wa(n[o.image]):r=new Nr(n[o.image]),r.needsUpdate=!0,r.uuid=o.uuid,o.name!==void 0&&(r.name=o.name),o.mapping!==void 0&&(r.mapping=e(o.mapping,v8)),o.offset!==void 0&&r.offset.fromArray(o.offset),o.repeat!==void 0&&r.repeat.fromArray(o.repeat),o.center!==void 0&&r.center.fromArray(o.center),o.rotation!==void 0&&(r.rotation=o.rotation),o.wrap!==void 0&&(r.wrapS=e(o.wrap[0],Z2),r.wrapT=e(o.wrap[1],Z2)),o.format!==void 0&&(r.format=o.format),o.type!==void 0&&(r.type=o.type),o.encoding!==void 0&&(r.encoding=o.encoding),o.minFilter!==void 0&&(r.minFilter=e(o.minFilter,J2)),o.magFilter!==void 0&&(r.magFilter=e(o.magFilter,J2)),o.anisotropy!==void 0&&(r.anisotropy=o.anisotropy),o.flipY!==void 0&&(r.flipY=o.flipY),o.premultiplyAlpha!==void 0&&(r.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(r.unpackAlignment=o.unpackAlignment),i[o.uuid]=r}return i},parseObject:function(t,n,e){var i;function s(x){return n[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",x),n[x]}function a(x){if(x!==void 0){if(Array.isArray(x)){for(var w=[],M=0,E=x.length;M<E;M++){var D=x[M];e[D]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",D),w.push(e[D])}return w}return e[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),e[x]}}switch(t.type){case"Scene":i=new la,t.background!==void 0&&Number.isInteger(t.background)&&(i.background=new Dn(t.background)),t.fog!==void 0&&(t.fog.type==="Fog"?i.fog=new Py(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(i.fog=new Cy(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new gi(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(i.focus=t.focus),t.zoom!==void 0&&(i.zoom=t.zoom),t.filmGauge!==void 0&&(i.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(i.filmOffset=t.filmOffset),t.view!==void 0&&(i.view=Object.assign({},t.view));break;case"OrthographicCamera":i=new Ku(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(i.zoom=t.zoom),t.view!==void 0&&(i.view=Object.assign({},t.view));break;case"AmbientLight":i=new tb(t.color,t.intensity);break;case"DirectionalLight":i=new sg(t.color,t.intensity);break;case"PointLight":i=new og(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new eb(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new ig(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new Zy(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=s(t.geometry),r=a(t.material);o.bones&&o.bones.length>0?i=new Rd(o,r):i=new $r(o,r);break;case"InstancedMesh":var o=s(t.geometry),r=a(t.material),u=t.count,l=t.instanceMatrix;i=new Iy(o,r,u),i.instanceMatrix=new nr(new Float32Array(l.array),16);break;case"LOD":i=new Em;break;case"Line":i=new Uo(s(t.geometry),a(t.material),t.mode);break;case"LineLoop":i=new km(s(t.geometry),a(t.material));break;case"LineSegments":i=new ci(s(t.geometry),a(t.material));break;case"PointCloud":case"Points":i=new Bm(s(t.geometry),a(t.material));break;case"Sprite":i=new Ry(a(t.material));break;case"Group":i=new Kl;break;default:i=new Rn}if(i.uuid=t.uuid,t.name!==void 0&&(i.name=t.name),t.matrix!==void 0?(i.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(i.matrixAutoUpdate=t.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(t.position!==void 0&&i.position.fromArray(t.position),t.rotation!==void 0&&i.rotation.fromArray(t.rotation),t.quaternion!==void 0&&i.quaternion.fromArray(t.quaternion),t.scale!==void 0&&i.scale.fromArray(t.scale)),t.castShadow!==void 0&&(i.castShadow=t.castShadow),t.receiveShadow!==void 0&&(i.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(i.shadow.bias=t.shadow.bias),t.shadow.radius!==void 0&&(i.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&i.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(i.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(i.visible=t.visible),t.frustumCulled!==void 0&&(i.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(i.renderOrder=t.renderOrder),t.userData!==void 0&&(i.userData=t.userData),t.layers!==void 0&&(i.layers.mask=t.layers),t.children!==void 0)for(var h=t.children,f=0;f<h.length;f++)i.add(this.parseObject(h[f],n,e));if(t.type==="LOD"){t.autoUpdate!==void 0&&(i.autoUpdate=t.autoUpdate);for(var d=t.levels,p=0;p<d.length;p++){var b=d[p],v=i.getObjectByProperty("uuid",b.object);v!==void 0&&i.addLevel(v,b.distance)}}return i}});var v8={UVMapping:G1,CubeReflectionMapping:H1,CubeRefractionMapping:W1,EquirectangularReflectionMapping:A_,EquirectangularRefractionMapping:q1,SphericalReflectionMapping:S_,CubeUVReflectionMapping:sd,CubeUVRefractionMapping:X1},Z2={RepeatWrapping:Ol,ClampToEdgeWrapping:Qi,MirroredRepeatWrapping:ad},J2={NearestFilter:li,NearestMipmapNearestFilter:Jp,NearestMipmapLinearFilter:$p,LinearFilter:pi,LinearMipmapNearestFilter:Y1,LinearMipmapLinearFilter:Qc};function $2(t){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Tr.call(this,t),this.options=void 0}$2.prototype=Object.assign(Object.create(Tr.prototype),{constructor:$2,setOptions:function(n){return this.options=n,this},load:function(t,n,e,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var s=this,a=Yu.get(t);if(a!==void 0)return s.manager.itemStart(t),setTimeout(function(){n&&n(a),s.manager.itemEnd(t)},0),a;fetch(t).then(function(o){return o.blob()}).then(function(o){return s.options===void 0?createImageBitmap(o):createImageBitmap(o,s.options)}).then(function(o){Yu.add(t,o),n&&n(o),s.manager.itemEnd(t)}).catch(function(o){i&&i(o),s.manager.itemError(t),s.manager.itemEnd(t)}),s.manager.itemStart(t)}});function Q2(){this.type="ShapePath",this.color=new Dn,this.subPaths=[],this.currentPath=null}Object.assign(Q2.prototype,{moveTo:function(t,n){return this.currentPath=new Fs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,n),this},lineTo:function(t,n){return this.currentPath.lineTo(t,n),this},quadraticCurveTo:function(t,n,e,i){return this.currentPath.quadraticCurveTo(t,n,e,i),this},bezierCurveTo:function(t,n,e,i,s,a){return this.currentPath.bezierCurveTo(t,n,e,i,s,a),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,n){function e(I){for(var C=[],L=0,B=I.length;L<B;L++){var O=I[L],q=new tc;q.curves=O.curves,C.push(q)}return C}function i(I,C){for(var L=C.length,B=!1,O=L-1,q=0;q<L;O=q++){var it=C[O],nt=C[q],lt=nt.x-it.x,ut=nt.y-it.y;if(Math.abs(ut)>Number.EPSILON){if(ut<0&&(it=C[q],lt=-lt,nt=C[O],ut=-ut),I.y<it.y||I.y>nt.y)continue;if(I.y===it.y){if(I.x===it.x)return!0}else{var vt=ut*(I.x-it.x)-lt*(I.y-it.y);if(vt===0)return!0;if(vt<0)continue;B=!B}}else{if(I.y!==it.y)continue;if(nt.x<=I.x&&I.x<=it.x||it.x<=I.x&&I.x<=nt.x)return!0}}return B}var s=Ya.isClockWise,a=this.subPaths;if(a.length===0)return[];if(n===!0)return e(a);var o,r,u,l=[];if(a.length===1)return r=a[0],u=new tc,u.curves=r.curves,l.push(u),l;var h=!s(a[0].getPoints());h=t?!h:h;var f=[],d=[],p=[],b=0,v;d[b]=void 0,p[b]=[];for(var x=0,w=a.length;x<w;x++)r=a[x],v=r.getPoints(),o=s(v),o=t?!o:o,o?(!h&&d[b]&&b++,d[b]={s:new tc,p:v},d[b].s.curves=r.curves,h&&b++,p[b]=[]):p[b].push({h:r,p:v[0]});if(!d[0])return e(a);if(d.length>1){for(var M=!1,E=[],D=0,N=d.length;D<N;D++)f[D]=[];for(var D=0,N=d.length;D<N;D++)for(var V=p[D],K=0;K<V.length;K++){for(var j=V[K],Z=!0,tt=0;tt<d.length;tt++)i(j.p,d[tt].p)&&(D!==tt&&E.push({froms:D,tos:tt,hole:K}),Z?(Z=!1,f[tt].push(j)):M=!0);Z&&f[D].push(j)}E.length>0&&(M||(p=f))}for(var rt,x=0,J=d.length;x<J;x++){u=d[x].s,l.push(u),rt=p[x];for(var U=0,G=rt.length;U<G;U++)u.holes.push(rt[U].h)}return l}});function tw(t){this.type="Font",this.data=t}Object.assign(tw.prototype,{isFont:!0,generateShapes:function(t,n){n===void 0&&(n=100);for(var e=[],i=x8(t,n,this.data),s=0,a=i.length;s<a;s++)Array.prototype.push.apply(e,i[s].toShapes());return e}});function x8(t,n,e){for(var i=Array.from?Array.from(t):String(t).split(""),s=n/e.resolution,a=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*s,o=[],r=0,u=0,l=0;l<i.length;l++){var h=i[l];if(h===`
`)r=0,u-=a;else{var f=_8(h,s,r,u,e);r+=f.offsetX,o.push(f.path)}}return o}function _8(t,n,e,i,s){var a=s.glyphs[t]||s.glyphs["?"];if(!a){console.error('THREE.Font: character "'+t+'" does not exists in font family '+s.familyName+".");return}var o=new Q2,r,u,l,h,f,d,p,b;if(a.o)for(var v=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),x=0,w=v.length;x<w;){var M=v[x++];switch(M){case"m":r=v[x++]*n+e,u=v[x++]*n+i,o.moveTo(r,u);break;case"l":r=v[x++]*n+e,u=v[x++]*n+i,o.lineTo(r,u);break;case"q":l=v[x++]*n+e,h=v[x++]*n+i,f=v[x++]*n+e,d=v[x++]*n+i,o.quadraticCurveTo(f,d,l,h);break;case"b":l=v[x++]*n+e,h=v[x++]*n+i,f=v[x++]*n+e,d=v[x++]*n+i,p=v[x++]*n+e,b=v[x++]*n+i,o.bezierCurveTo(f,d,p,b,l,h);break}}return{offsetX:a.ha*n,path:o}}function ew(t){Tr.call(this,t)}ew.prototype=Object.assign(Object.create(Tr.prototype),{constructor:ew,load:function(t,n,e,i){var s=this,a=new Jo(this.manager);a.setPath(this.path),a.load(t,function(o){var r;try{r=JSON.parse(o)}catch(l){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(o.substring(65,o.length-2))}var u=s.parse(r);n&&n(u)},e,i)},parse:function(t){return new tw(t)}});var ag,nw={getContext:function(){return ag===void 0&&(ag=new(window.AudioContext||window.webkitAudioContext)),ag},setContext:function(t){ag=t}};function lb(t){Tr.call(this,t)}lb.prototype=Object.assign(Object.create(Tr.prototype),{constructor:lb,load:function(t,n,e,i){var s=new Jo(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(t,function(a){var o=a.slice(0),r=nw.getContext();r.decodeAudioData(o,function(u){n(u)})},e,i)}});function cb(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new oe)}Object.assign(cb.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var n=0;n<9;n++)this.coefficients[n].copy(t[n]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,n){var e=t.x,i=t.y,s=t.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScale(a[1],.488603*i),n.addScale(a[2],.488603*s),n.addScale(a[3],.488603*e),n.addScale(a[4],1.092548*(e*i)),n.addScale(a[5],1.092548*(i*s)),n.addScale(a[6],.315392*(3*s*s-1)),n.addScale(a[7],1.092548*(e*s)),n.addScale(a[8],.546274*(e*e-i*i)),n},getIrradianceAt:function(t,n){var e=t.x,i=t.y,s=t.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScale(a[1],2*.511664*i),n.addScale(a[2],2*.511664*s),n.addScale(a[3],2*.511664*e),n.addScale(a[4],2*.429043*e*i),n.addScale(a[5],2*.429043*i*s),n.addScale(a[6],.743125*s*s-.247708),n.addScale(a[7],2*.429043*e*s),n.addScale(a[8],.429043*(e*e-i*i)),n},add:function(t){for(var n=0;n<9;n++)this.coefficients[n].add(t.coefficients[n]);return this},scale:function(t){for(var n=0;n<9;n++)this.coefficients[n].multiplyScalar(t);return this},lerp:function(t,n){for(var e=0;e<9;e++)this.coefficients[e].lerp(t.coefficients[e],n);return this},equals:function(t){for(var n=0;n<9;n++)if(!this.coefficients[n].equals(t.coefficients[n]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(t,n){n===void 0&&(n=0);for(var e=this.coefficients,i=0;i<9;i++)e[i].fromArray(t,n+i*3);return this},toArray:function(t,n){t===void 0&&(t=[]),n===void 0&&(n=0);for(var e=this.coefficients,i=0;i<9;i++)e[i].toArray(t,n+i*3);return t}}),Object.assign(cb,{getBasisAt:function(t,n){var e=t.x,i=t.y,s=t.z;n[0]=.282095,n[1]=.488603*i,n[2]=.488603*s,n[3]=.488603*e,n[4]=1.092548*e*i,n[5]=1.092548*i*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*e*s,n[8]=.546274*(e*e-i*i)}});function Ns(t,n){Wr.call(this,void 0,n),this.sh=t!==void 0?t:new cb}Ns.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Ns,isLightProbe:!0,copy:function(t){return Wr.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){var n=Wr.prototype.toJSON.call(this,t);return n}});function rw(t,n,e){Ns.call(this,void 0,e);var i=new Dn().set(t),s=new Dn().set(n),a=new oe(i.r,i.g,i.b),o=new oe(s.r,s.g,s.b),r=Math.sqrt(Math.PI),u=r*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(r),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(u)}rw.prototype=Object.assign(Object.create(Ns.prototype),{constructor:rw,isHemisphereLightProbe:!0,copy:function(t){return Ns.prototype.copy.call(this,t),this},toJSON:function(t){var n=Ns.prototype.toJSON.call(this,t);return n}});function iw(t,n){Ns.call(this,void 0,n);var e=new Dn().set(t);this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}iw.prototype=Object.assign(Object.create(Ns.prototype),{constructor:iw,isAmbientLightProbe:!0,copy:function(t){return Ns.prototype.copy.call(this,t),this},toJSON:function(t){var n=Ns.prototype.toJSON.call(this,t);return n}});var ow=new mr,sw=new mr;function w8(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new gi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new gi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(w8.prototype,{update:function(t){var n=this._cache,e=n.focus!==t.focus||n.fov!==t.fov||n.aspect!==t.aspect*this.aspect||n.near!==t.near||n.far!==t.far||n.zoom!==t.zoom||n.eyeSep!==this.eyeSep;if(e){n.focus=t.focus,n.fov=t.fov,n.aspect=t.aspect*this.aspect,n.near=t.near,n.far=t.far,n.zoom=t.zoom,n.eyeSep=this.eyeSep;var i=t.projectionMatrix.clone(),s=n.eyeSep/2,a=s*n.near/n.focus,o=n.near*Math.tan(pr.DEG2RAD*n.fov*.5)/n.zoom,r,u;sw.elements[12]=-s,ow.elements[12]=s,r=-o*n.aspect+a,u=o*n.aspect+a,i.elements[0]=2*n.near/(u-r),i.elements[8]=(u+r)/(u-r),this.cameraL.projectionMatrix.copy(i),r=-o*n.aspect-a,u=o*n.aspect-a,i.elements[0]=2*n.near/(u-r),i.elements[8]=(u+r)/(u-r),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(sw),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(ow)}});function aw(t){this.autoStart=t!==void 0?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(aw.prototype,{start:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t}});var nc=new oe,lw=new mo,M8=new oe,rc=new oe;function cw(){Rn.call(this),this.type="AudioListener",this.context=nw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new aw}cw.prototype=Object.assign(Object.create(Rn.prototype),{constructor:cw,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Rn.prototype.updateMatrixWorld.call(this,t);var n=this.context.listener,e=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(nc,lw,M8),rc.set(0,0,-1).applyQuaternion(lw),n.positionX){var i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(nc.x,i),n.positionY.linearRampToValueAtTime(nc.y,i),n.positionZ.linearRampToValueAtTime(nc.z,i),n.forwardX.linearRampToValueAtTime(rc.x,i),n.forwardY.linearRampToValueAtTime(rc.y,i),n.forwardZ.linearRampToValueAtTime(rc.z,i),n.upX.linearRampToValueAtTime(e.x,i),n.upY.linearRampToValueAtTime(e.y,i),n.upZ.linearRampToValueAtTime(e.z,i)}else n.setPosition(nc.x,nc.y,nc.z),n.setOrientation(rc.x,rc.y,rc.z,e.x,e.y,e.z)}});function tf(t){Rn.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}tf.prototype=Object.assign(Object.create(Rn.prototype),{constructor:tf,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(t===void 0&&(t=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;var n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,n=this.filters.length;t<n;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,n=this.filters.length;t<n;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var ic=new oe,uw=new mo,A8=new oe,oc=new oe;function hw(t){tf.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}hw.prototype=Object.assign(Object.create(tf.prototype),{constructor:hw,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,n,e){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=e,this},updateMatrixWorld:function(t){if(Rn.prototype.updateMatrixWorld.call(this,t),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(ic,uw,A8),oc.set(0,0,1).applyQuaternion(uw);var n=this.panner;if(n.positionX){var e=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(ic.x,e),n.positionY.linearRampToValueAtTime(ic.y,e),n.positionZ.linearRampToValueAtTime(ic.z,e),n.orientationX.linearRampToValueAtTime(oc.x,e),n.orientationY.linearRampToValueAtTime(oc.y,e),n.orientationZ.linearRampToValueAtTime(oc.z,e)}else n.setPosition(ic.x,ic.y,ic.z),n.setOrientation(oc.x,oc.y,oc.z)}}});function dw(t,n){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n!==void 0?n:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}Object.assign(dw.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,n=this.getFrequencyData(),e=0;e<n.length;e++)t+=n[e];return t/n.length}});function fw(t,n,e){this.binding=t,this.valueSize=e;var i=Float64Array,s;switch(n){case"quaternion":s=this._slerp;break;case"string":case"bool":i=Array,s=this._select;break;default:s=this._lerp}this.buffer=new i(e*4),this._mixBufferRegion=s,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(fw.prototype,{accumulate:function(t,n){var e=this.buffer,i=this.valueSize,s=t*i+i,a=this.cumulativeWeight;if(a===0){for(var o=0;o!==i;++o)e[s+o]=e[o];a=n}else{a+=n;var r=n/a;this._mixBufferRegion(e,s,0,r,i)}this.cumulativeWeight=a},apply:function(t){var n=this.valueSize,e=this.buffer,i=t*n+n,s=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,s<1){var o=n*3;this._mixBufferRegion(e,i,o,1-s,n)}for(var r=n,u=n+n;r!==u;++r)if(e[r]!==e[r+n]){a.setValue(e,i);break}},saveOriginalState:function(){var t=this.binding,n=this.buffer,e=this.valueSize,i=e*3;t.getValue(n,i);for(var s=e,a=i;s!==a;++s)n[s]=n[i+s%e];this.cumulativeWeight=0},restoreOriginalState:function(){var t=this.valueSize*3;this.binding.setValue(this.buffer,t)},_select:function(t,n,e,i,s){if(i>=.5)for(var a=0;a!==s;++a)t[n+a]=t[e+a]},_slerp:function(t,n,e,i){mo.slerpFlat(t,n,t,n,t,e,i)},_lerp:function(t,n,e,i,s){for(var a=1-i,o=0;o!==s;++o){var r=n+o;t[r]=t[r]*a+t[e+o]*i}}});var ub="\\[\\]\\.:\\/",S8=new RegExp("["+ub+"]","g"),hb="[^"+ub+"]",E8="[^"+ub.replace("\\.","")+"]",T8=/((?:WC+[\/:])*)/.source.replace("WC",hb),C8=/(WCOD+)?/.source.replace("WCOD",E8),P8=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",hb),D8=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",hb),R8=new RegExp("^"+T8+C8+P8+D8+"$"),k8=["material","materials","bones"];function pw(t,n,e){var i=e||Hi.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}Object.assign(pw.prototype,{getValue:function(t,n){this.bind();var e=this._targetGroup.nCachedObjects_,i=this._bindings[e];i!==void 0&&i.getValue(t,n)},setValue:function(t,n){for(var e=this._bindings,i=this._targetGroup.nCachedObjects_,s=e.length;i!==s;++i)e[i].setValue(t,n)},bind:function(){for(var t=this._bindings,n=this._targetGroup.nCachedObjects_,e=t.length;n!==e;++n)t[n].bind()},unbind:function(){for(var t=this._bindings,n=this._targetGroup.nCachedObjects_,e=t.length;n!==e;++n)t[n].unbind()}});function Hi(t,n,e){this.path=n,this.parsedPath=e||Hi.parseTrackName(n),this.node=Hi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(Hi,{Composite:pw,create:function(t,n,e){return t&&t.isAnimationObjectGroup?new Hi.Composite(t,n,e):new Hi(t,n,e)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(S8,"")},parseTrackName:function(t){var n=R8.exec(t);if(!n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var e={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},i=e.nodeName&&e.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){var s=e.nodeName.substring(i+1);k8.indexOf(s)!==-1&&(e.nodeName=e.nodeName.substring(0,i),e.objectName=s)}if(e.propertyName===null||e.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return e},findNode:function(t,n){if(!n||n===""||n==="root"||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){var e=t.skeleton.getBoneByName(n);if(e!==void 0)return e}if(t.children){var i=function(a){for(var o=0;o<a.length;o++){var r=a[o];if(r.name===n||r.uuid===n)return r;var u=i(r.children);if(u)return u}return null},s=i(t.children);if(s)return s}return null}}),Object.assign(Hi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(n,e){n[e]=this.node[this.propertyName]},function(n,e){for(var i=this.resolvedProperty,s=0,a=i.length;s!==a;++s)n[e++]=i[s]},function(n,e){n[e]=this.resolvedProperty[this.propertyIndex]},function(n,e){this.resolvedProperty.toArray(n,e)}],SetterByBindingTypeAndVersioning:[[function(n,e){this.targetObject[this.propertyName]=n[e]},function(n,e){this.targetObject[this.propertyName]=n[e],this.targetObject.needsUpdate=!0},function(n,e){this.targetObject[this.propertyName]=n[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(n,e){for(var i=this.resolvedProperty,s=0,a=i.length;s!==a;++s)i[s]=n[e++]},function(n,e){for(var i=this.resolvedProperty,s=0,a=i.length;s!==a;++s)i[s]=n[e++];this.targetObject.needsUpdate=!0},function(n,e){for(var i=this.resolvedProperty,s=0,a=i.length;s!==a;++s)i[s]=n[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(n,e){this.resolvedProperty[this.propertyIndex]=n[e]},function(n,e){this.resolvedProperty[this.propertyIndex]=n[e],this.targetObject.needsUpdate=!0},function(n,e){this.resolvedProperty[this.propertyIndex]=n[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(n,e){this.resolvedProperty.fromArray(n,e)},function(n,e){this.resolvedProperty.fromArray(n,e),this.targetObject.needsUpdate=!0},function(n,e){this.resolvedProperty.fromArray(n,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(n,e){this.bind(),this.getValue(n,e)},setValue:function(n,e){this.bind(),this.setValue(n,e)},bind:function(){var t=this.node,n=this.parsedPath,e=n.objectName,i=n.propertyName,s=n.propertyIndex;if(t||(t=Hi.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(e){var a=n.objectIndex;switch(e){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(t[e]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[e]}if(a!==void 0){if(t[a]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[a]}}var r=t[i];if(r===void 0){var u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",t);return}var l=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);var h=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===s){s=o;break}}else{if(!t.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===s){s=o;break}}}h=this.BindingType.ArrayElement,this.resolvedProperty=r,this.propertyIndex=s}else r.fromArray!==void 0&&r.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=r):Array.isArray(r)?(h=this.BindingType.EntireArray,this.resolvedProperty=r):this.propertyName=i;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][l]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Hi.prototype,{_getValue_unbound:Hi.prototype.getValue,_setValue_unbound:Hi.prototype.setValue});function I8(){this.uuid=pr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,e=arguments.length;n!==e;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(I8.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,n=t.length,e=this.nCachedObjects_,i=this._indicesByUUID,s=this._paths,a=this._parsedPaths,o=this._bindings,r=o.length,u=void 0,l=0,h=arguments.length;l!==h;++l){var f=arguments[l],d=f.uuid,p=i[d];if(p===void 0){p=n++,i[d]=p,t.push(f);for(var b=0,v=r;b!==v;++b)o[b].push(new Hi(f,s[b],a[b]))}else if(p<e){u=t[p];var x=--e,w=t[x];i[w.uuid]=p,t[p]=w,i[d]=x,t[x]=f;for(var b=0,v=r;b!==v;++b){var M=o[b],E=M[x],D=M[p];M[p]=E,D===void 0&&(D=new Hi(f,s[b],a[b])),M[x]=D}}else t[p]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=e},remove:function(){for(var t=this._objects,n=this.nCachedObjects_,e=this._indicesByUUID,i=this._bindings,s=i.length,a=0,o=arguments.length;a!==o;++a){var r=arguments[a],u=r.uuid,l=e[u];if(l!==void 0&&l>=n){var h=n++,f=t[h];e[f.uuid]=l,t[l]=f,e[u]=h,t[h]=r;for(var d=0,p=s;d!==p;++d){var b=i[d],v=b[h],x=b[l];b[l]=v,b[h]=x}}}this.nCachedObjects_=n},uncache:function(){for(var t=this._objects,n=t.length,e=this.nCachedObjects_,i=this._indicesByUUID,s=this._bindings,a=s.length,o=0,r=arguments.length;o!==r;++o){var u=arguments[o],l=u.uuid,h=i[l];if(h!==void 0)if(delete i[l],h<e){var f=--e,d=t[f],p=--n,b=t[p];i[d.uuid]=h,t[h]=d,i[b.uuid]=f,t[f]=b,t.pop();for(var v=0,x=a;v!==x;++v){var w=s[v],M=w[f],E=w[p];w[h]=M,w[f]=E,w.pop()}}else{var p=--n,b=t[p];i[b.uuid]=h,t[h]=b,t.pop();for(var v=0,x=a;v!==x;++v){var w=s[v];w[h]=w[p],w.pop()}}}this.nCachedObjects_=e},subscribe_:function(t,n){var e=this._bindingsIndicesByPath,i=e[t],s=this._bindings;if(i!==void 0)return s[i];var a=this._paths,o=this._parsedPaths,r=this._objects,u=r.length,l=this.nCachedObjects_,h=new Array(u);i=s.length,e[t]=i,a.push(t),o.push(n),s.push(h);for(var f=l,d=r.length;f!==d;++f){var p=r[f];h[f]=new Hi(p,t,n)}return h},unsubscribe_:function(t){var n=this._bindingsIndicesByPath,e=n[t];if(e!==void 0){var i=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,r=a[o],u=t[o];n[u]=e,a[e]=r,a.pop(),s[e]=s[o],s.pop(),i[e]=i[o],i.pop()}}});function mw(t,n,e){this._mixer=t,this._clip=n,this._localRoot=e||null;for(var i=n.tracks,s=i.length,a=new Array(s),o={endingStart:nu,endingEnd:nu},r=0;r!==s;++r){var u=i[r].createInterpolant(null);a[r]=u,u.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=TC,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(mw.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,n){return this.loop=t,this.repetitions=n,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,n,e){if(t.fadeOut(n),this.fadeIn(n),e){var i=this._clip.duration,s=t._clip.duration,a=s/i,o=i/s;t.warp(1,a,n),this.warp(o,1,n)}return this},crossFadeTo:function(t,n,e){return t.crossFadeFrom(this,n,e)},stopFading:function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,n,e){var i=this._mixer,s=i.time,a=this._timeScaleInterpolant,o=this.timeScale;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);var r=a.parameterPositions,u=a.sampleValues;return r[0]=s,r[1]=s+e,u[0]=t/o,u[1]=n/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,n,e,i){if(!this.enabled){this._updateWeight(t);return}var s=this._startTime;if(s!==null){var a=(t-s)*e;if(a<0||e===0)return;this._startTime=null,n=e*a}n*=this._updateTimeScale(t);var o=this._updateTime(n),r=this._updateWeight(t);if(r>0)for(var u=this._interpolants,l=this._propertyBindings,h=0,f=u.length;h!==f;++h)u[h].evaluate(o),l[h].accumulate(i,r)},_updateWeight:function(t){var n=0;if(this.enabled){n=this.weight;var e=this._weightInterpolant;if(e!==null){var i=e.evaluate(t)[0];n*=i,t>e.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n},_updateTimeScale:function(t){var n=0;if(!this.paused){n=this.timeScale;var e=this._timeScaleInterpolant;if(e!==null){var i=e.evaluate(t)[0];n*=i,t>e.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n},_updateTime:function(t){var n=this.time+t,e=this._clip.duration,i=this.loop,s=this._loopCount,a=i===CC;if(t===0)return s===-1?n:a&&(s&1)===1?e-n:n;if(i===EC){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(n>=e)n=e;else if(n<0)n=0;else{this.time=n;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=e||n<0){var o=Math.floor(n/e);n-=e*o,s+=Math.abs(o);var r=this.repetitions-s;if(r<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=t>0?e:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(r===1){var u=t<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return e-n}return n},_setEndings:function(t,n,e){var i=this._interpolantSettings;e?(i.endingStart=ru,i.endingEnd=ru):(t?i.endingStart=this.zeroSlopeAtStart?ru:nu:i.endingStart=nm,n?i.endingEnd=this.zeroSlopeAtEnd?ru:nu:i.endingEnd=nm)},_scheduleFading:function(t,n,e){var i=this._mixer,s=i.time,a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,r=a.sampleValues;return o[0]=s,r[0]=n,o[1]=s+t,r[1]=e,this}});function gw(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}gw.prototype=Object.assign(Object.create(sa.prototype),{constructor:gw,_bindAction:function(t,n){var e=t._localRoot||this._root,i=t._clip.tracks,s=i.length,a=t._propertyBindings,o=t._interpolants,r=e.uuid,u=this._bindingsByRootAndName,l=u[r];l===void 0&&(l={},u[r]=l);for(var h=0;h!==s;++h){var f=i[h],d=f.name,p=l[d];if(p!==void 0)a[h]=p;else{if(p=a[h],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,r,d));continue}var b=n&&n._propertyBindings[h].binding.parsedPath;p=new fw(Hi.create(e,d,b),f.ValueTypeName,f.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,r,d),a[h]=p}o[h].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){var n=(t._localRoot||this._root).uuid,e=t._clip.uuid,i=this._actionsByClip[e];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,e,n)}for(var s=t._propertyBindings,a=0,o=s.length;a!==o;++a){var r=s[a];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var n=t._propertyBindings,e=0,i=n.length;e!==i;++e){var s=n[e];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var n=t._cacheIndex;return n!==null&&n<this._nActiveActions},_addInactiveAction:function(t,n,e){var i=this._actions,s=this._actionsByClip,a=s[n];if(a===void 0)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[n]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=i.length,i.push(t),a.actionByRoot[e]=t},_removeInactiveAction:function(t){var n=this._actions,e=n[n.length-1],i=t._cacheIndex;e._cacheIndex=i,n[i]=e,n.pop(),t._cacheIndex=null;var s=t._clip.uuid,a=this._actionsByClip,o=a[s],r=o.knownActions,u=r[r.length-1],l=t._byClipCacheIndex;u._byClipCacheIndex=l,r[l]=u,r.pop(),t._byClipCacheIndex=null;var h=o.actionByRoot,f=(t._localRoot||this._root).uuid;delete h[f],r.length===0&&delete a[s],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var n=t._propertyBindings,e=0,i=n.length;e!==i;++e){var s=n[e];--s.referenceCount===0&&this._removeInactiveBinding(s)}},_lendAction:function(t){var n=this._actions,e=t._cacheIndex,i=this._nActiveActions++,s=n[i];t._cacheIndex=i,n[i]=t,s._cacheIndex=e,n[e]=s},_takeBackAction:function(t){var n=this._actions,e=t._cacheIndex,i=--this._nActiveActions,s=n[i];t._cacheIndex=i,n[i]=t,s._cacheIndex=e,n[e]=s},_addInactiveBinding:function(t,n,e){var i=this._bindingsByRootAndName,s=i[n],a=this._bindings;s===void 0&&(s={},i[n]=s),s[e]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var n=this._bindings,e=t.binding,i=e.rootNode.uuid,s=e.path,a=this._bindingsByRootAndName,o=a[i],r=n[n.length-1],u=t._cacheIndex;r._cacheIndex=u,n[u]=r,n.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]},_lendBinding:function(t){var n=this._bindings,e=t._cacheIndex,i=this._nActiveBindings++,s=n[i];t._cacheIndex=i,n[i]=t,s._cacheIndex=e,n[e]=s},_takeBackBinding:function(t){var n=this._bindings,e=t._cacheIndex,i=--this._nActiveBindings,s=n[i];t._cacheIndex=i,n[i]=t,s._cacheIndex=e,n[e]=s},_lendControlInterpolant:function(){var t=this._controlInterpolants,n=this._nActiveControlInterpolants++,e=t[n];return e===void 0&&(e=new ng(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),e.__cacheIndex=n,t[n]=e),e},_takeBackControlInterpolant:function(t){var n=this._controlInterpolants,e=t.__cacheIndex,i=--this._nActiveControlInterpolants,s=n[i];t.__cacheIndex=i,n[i]=t,s.__cacheIndex=e,n[e]=s},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,n){var e=n||this._root,i=e.uuid,s=typeof t=="string"?Zo.findByName(e,t):t,a=s!==null?s.uuid:t,o=this._actionsByClip[a],r=null;if(o!==void 0){var u=o.actionByRoot[i];if(u!==void 0)return u;r=o.knownActions[0],s===null&&(s=r._clip)}if(s===null)return null;var l=new mw(this,s,n);return this._bindAction(l,r),this._addInactiveAction(l,a,i),l},existingAction:function(t,n){var e=n||this._root,i=e.uuid,s=typeof t=="string"?Zo.findByName(e,t):t,a=s?s.uuid:t,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null},stopAllAction:function(){var t=this._actions,n=this._nActiveActions,e=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var s=0;s!==n;++s)t[s].reset();for(var s=0;s!==i;++s)e[s].useCount=0;return this},update:function(t){t*=this.timeScale;for(var n=this._actions,e=this._nActiveActions,i=this.time+=t,s=Math.sign(t),a=this._accuIndex^=1,o=0;o!==e;++o){var r=n[o];r._update(i,t,s,a)}for(var u=this._bindings,l=this._nActiveBindings,o=0;o!==l;++o)u[o].apply(a);return this},setTime:function(t){this.time=0;for(var n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var n=this._actions,e=t.uuid,i=this._actionsByClip,s=i[e];if(s!==void 0){for(var a=s.knownActions,o=0,r=a.length;o!==r;++o){var u=a[o];this._deactivateAction(u);var l=u._cacheIndex,h=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=l,n[l]=h,n.pop(),this._removeInactiveBindingsForAction(u)}delete i[e]}},uncacheRoot:function(t){var n=t.uuid,e=this._actionsByClip;for(var i in e){var s=e[i].actionByRoot,a=s[n];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}var o=this._bindingsByRootAndName,r=o[n];if(r!==void 0)for(var u in r){var l=r[u];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,n){var e=this.existingAction(t,n);e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}});function db(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}db.prototype.clone=function(){return new db(this.value.clone===void 0?this.value:this.value.clone())};function yw(t,n,e){ga.call(this,t,n),this.meshPerAttribute=e||1}yw.prototype=Object.assign(Object.create(ga.prototype),{constructor:yw,isInstancedInterleavedBuffer:!0,copy:function(t){return ga.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}});function L8(t,n,e,i){this.ray=new hu(t,n),this.near=e||0,this.far=i||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function bw(t,n){return t.distance-n.distance}function fb(t,n,e,i){if(t.visible!==!1&&(t.raycast(n,e),i===!0))for(var s=t.children,a=0,o=s.length;a<o;a++)fb(s[a],n,e,!0)}Object.assign(L8.prototype,{linePrecision:1,set:function(t,n){this.ray.set(t,n)},setFromCamera:function(t,n){n&&n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n&&n.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,n,e){var i=e||[];return fb(t,this,i,n),i.sort(bw),i},intersectObjects:function(t,n,e){var i=e||[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var s=0,a=t.length;s<a;s++)fb(t[s],this,i,n);return i.sort(bw),i}});function B8(t,n,e){return this.radius=t!==void 0?t:1,this.phi=n!==void 0?n:0,this.theta=e!==void 0?e:0,this}Object.assign(B8.prototype,{set:function(t,n,e){return this.radius=t,this.phi=n,this.theta=e,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,n,e){return this.radius=Math.sqrt(t*t+n*n+e*e),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,e),this.phi=Math.acos(pr.clamp(n/this.radius,-1,1))),this}});function F8(t,n,e){return this.radius=t!==void 0?t:1,this.theta=n!==void 0?n:0,this.y=e!==void 0?e:0,this}Object.assign(F8.prototype,{set:function(t,n,e){return this.radius=t,this.theta=n,this.y=e,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,n,e){return this.radius=Math.sqrt(t*t+e*e),this.theta=Math.atan2(t,e),this.y=n,this}});var vw=new on;function xw(t,n){this.min=t!==void 0?t:new on(1/0,1/0),this.max=n!==void 0?n:new on(-1/0,-1/0)}Object.assign(xw.prototype,{set:function(t,n){return this.min.copy(t),this.max.copy(n),this},setFromPoints:function(t){this.makeEmpty();for(var n=0,e=t.length;n<e;n++)this.expandByPoint(t[n]);return this},setFromCenterAndSize:function(t,n){var e=vw.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(e),this.max.copy(t).add(e),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new on),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new on),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new on),n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new on),n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){var n=vw.copy(t).clamp(this.min,this.max);return n.sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var _w=new oe,lg=new oe;function ww(t,n){this.start=t!==void 0?t:new oe,this.end=n!==void 0?n:new oe}Object.assign(ww.prototype,{set:function(t,n){return this.start.copy(t),this.end.copy(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new oe),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new oe),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,n){return n===void 0&&(console.warn("THREE.Line3: .at() target is now required"),n=new oe),this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,n){_w.subVectors(t,this.start),lg.subVectors(this.end,this.start);var e=lg.dot(lg),i=lg.dot(_w),s=i/e;return n&&(s=pr.clamp(s,0,1)),s},closestPointToPoint:function(t,n,e){var i=this.closestPointToPointParameter(t,n);return e===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),e=new oe),this.delta(e).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}});function cg(t){Rn.call(this),this.material=t,this.render=function(){}}cg.prototype=Object.create(Rn.prototype),cg.prototype.constructor=cg,cg.prototype.isImmediateRenderObject=!0;var Mw=new oe;function ef(t,n){Rn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;for(var e=new Un,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,a=1,o=32;s<o;s++,a++){var r=s/o*Math.PI*2,u=a/o*Math.PI*2;i.push(Math.cos(r),Math.sin(r),1,Math.cos(u),Math.sin(u),1)}e.setAttribute("position",new Ln(i,3));var l=new ni({fog:!1});this.cone=new ci(e,l),this.add(this.cone),this.update()}ef.prototype=Object.create(Rn.prototype),ef.prototype.constructor=ef,ef.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ef.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),Mw.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Mw),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var $a=new oe,ug=new mr,pb=new mr;function Aw(t){var n=[];t&&t.isBone&&n.push(t);for(var e=0;e<t.children.length;e++)n.push.apply(n,Aw(t.children[e]));return n}function nf(t){for(var n=Aw(t),e=new Un,i=[],s=[],a=new Dn(0,0,1),o=new Dn(0,1,0),r=0;r<n.length;r++){var u=n[r];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}e.setAttribute("position",new Ln(i,3)),e.setAttribute("color",new Ln(s,3));var l=new ni({vertexColors:Jc,depthTest:!1,depthWrite:!1,transparent:!0});ci.call(this,e,l),this.root=t,this.bones=n,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}nf.prototype=Object.create(ci.prototype),nf.prototype.constructor=nf,nf.prototype.updateMatrixWorld=function(t){var n=this.bones,e=this.geometry,i=e.getAttribute("position");pb.getInverse(this.root.matrixWorld);for(var s=0,a=0;s<n.length;s++){var o=n[s];o.parent&&o.parent.isBone&&(ug.multiplyMatrices(pb,o.matrixWorld),$a.setFromMatrixPosition(ug),i.setXYZ(a,$a.x,$a.y,$a.z),ug.multiplyMatrices(pb,o.parent.matrixWorld),$a.setFromMatrixPosition(ug),i.setXYZ(a+1,$a.x,$a.y,$a.z),a+=2)}e.getAttribute("position").needsUpdate=!0,Rn.prototype.updateMatrixWorld.call(this,t)};function rf(t,n,e){this.light=t,this.light.updateMatrixWorld(),this.color=e;var i=new Bu(n,4,2),s=new Fi({wireframe:!0,fog:!1});$r.call(this,i,s),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}rf.prototype=Object.create($r.prototype),rf.prototype.constructor=rf,rf.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},rf.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var N8=new oe,Sw=new Dn,Ew=new Dn;function of(t,n,e){Rn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var i=new Ru(n);i.rotateY(Math.PI*.5),this.material=new Fi({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=Jc);var s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new nr(a,3)),this.add(new $r(i,this.material)),this.update()}of.prototype=Object.create(Rn.prototype),of.prototype.constructor=of,of.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},of.prototype.update=function(){var t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var n=t.geometry.getAttribute("color");Sw.copy(this.light.color),Ew.copy(this.light.groundColor);for(var e=0,i=n.count;e<i;e++){var s=e<i/2?Sw:Ew;n.setXYZ(e,s.r,s.g,s.b)}n.needsUpdate=!0}t.lookAt(N8.setFromMatrixPosition(this.light.matrixWorld).negate())};function mb(t,n,e,i){t=t||10,n=n||10,e=new Dn(e!==void 0?e:4473924),i=new Dn(i!==void 0?i:8947848);for(var s=n/2,a=t/n,o=t/2,r=[],u=[],l=0,h=0,f=-o;l<=n;l++,f+=a){r.push(-o,0,f,o,0,f),r.push(f,0,-o,f,0,o);var d=l===s?e:i;d.toArray(u,h),h+=3,d.toArray(u,h),h+=3,d.toArray(u,h),h+=3,d.toArray(u,h),h+=3}var p=new Un;p.setAttribute("position",new Ln(r,3)),p.setAttribute("color",new Ln(u,3));var b=new ni({vertexColors:Jc});ci.call(this,p,b)}mb.prototype=Object.assign(Object.create(ci.prototype),{constructor:mb,copy:function(t){return ci.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return new this.constructor().copy(this)}});function gb(t,n,e,i,s,a){t=t||10,n=n||16,e=e||8,i=i||64,s=new Dn(s!==void 0?s:4473924),a=new Dn(a!==void 0?a:8947848);var o=[],r=[],u,l,h,f,d,p,b;for(f=0;f<=n;f++)h=f/n*(Math.PI*2),u=Math.sin(h)*t,l=Math.cos(h)*t,o.push(0,0,0),o.push(u,0,l),b=f&1?s:a,r.push(b.r,b.g,b.b),r.push(b.r,b.g,b.b);for(f=0;f<=e;f++)for(b=f&1?s:a,p=t-t/e*f,d=0;d<i;d++)h=d/i*(Math.PI*2),u=Math.sin(h)*p,l=Math.cos(h)*p,o.push(u,0,l),r.push(b.r,b.g,b.b),h=(d+1)/i*(Math.PI*2),u=Math.sin(h)*p,l=Math.cos(h)*p,o.push(u,0,l),r.push(b.r,b.g,b.b);var v=new Un;v.setAttribute("position",new Ln(o,3)),v.setAttribute("color",new Ln(r,3));var x=new ni({vertexColors:Jc});ci.call(this,v,x)}gb.prototype=Object.create(ci.prototype),gb.prototype.constructor=gb;var Tw=new oe,hg=new oe,Cw=new oe;function sf(t,n,e){Rn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,n===void 0&&(n=1);var i=new Un;i.setAttribute("position",new Ln([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var s=new ni({fog:!1});this.lightPlane=new Uo(i,s),this.add(this.lightPlane),i=new Un,i.setAttribute("position",new Ln([0,0,0,0,0,1],3)),this.targetLine=new Uo(i,s),this.add(this.targetLine),this.update()}sf.prototype=Object.create(Rn.prototype),sf.prototype.constructor=sf,sf.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},sf.prototype.update=function(){Tw.setFromMatrixPosition(this.light.matrixWorld),hg.setFromMatrixPosition(this.light.target.matrixWorld),Cw.subVectors(hg,Tw),this.lightPlane.lookAt(hg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(hg),this.targetLine.scale.z=Cw.length()};var dg=new oe,ri=new pa;function fg(t){var n=new Un,e=new ni({color:16777215,vertexColors:MT}),i=[],s=[],a={},o=new Dn(16755200),r=new Dn(16711680),u=new Dn(43775),l=new Dn(16777215),h=new Dn(3355443);f("n1","n2",o),f("n2","n4",o),f("n4","n3",o),f("n3","n1",o),f("f1","f2",o),f("f2","f4",o),f("f4","f3",o),f("f3","f1",o),f("n1","f1",o),f("n2","f2",o),f("n3","f3",o),f("n4","f4",o),f("p","n1",r),f("p","n2",r),f("p","n3",r),f("p","n4",r),f("u1","u2",u),f("u2","u3",u),f("u3","u1",u),f("c","t",l),f("p","c",h),f("cn1","cn2",h),f("cn3","cn4",h),f("cf1","cf2",h),f("cf3","cf4",h);function f(p,b,v){d(p,v),d(b,v)}function d(p,b){i.push(0,0,0),s.push(b.r,b.g,b.b),a[p]===void 0&&(a[p]=[]),a[p].push(i.length/3-1)}n.setAttribute("position",new Ln(i,3)),n.setAttribute("color",new Ln(s,3)),ci.call(this,n,e),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}fg.prototype=Object.create(ci.prototype),fg.prototype.constructor=fg,fg.prototype.update=function(){var t=this.geometry,n=this.pointMap,e=1,i=1;ri.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),hi("c",n,t,ri,0,0,-1),hi("t",n,t,ri,0,0,1),hi("n1",n,t,ri,-e,-i,-1),hi("n2",n,t,ri,e,-i,-1),hi("n3",n,t,ri,-e,i,-1),hi("n4",n,t,ri,e,i,-1),hi("f1",n,t,ri,-e,-i,1),hi("f2",n,t,ri,e,-i,1),hi("f3",n,t,ri,-e,i,1),hi("f4",n,t,ri,e,i,1),hi("u1",n,t,ri,e*.7,i*1.1,-1),hi("u2",n,t,ri,-e*.7,i*1.1,-1),hi("u3",n,t,ri,0,i*2,-1),hi("cf1",n,t,ri,-e,0,1),hi("cf2",n,t,ri,e,0,1),hi("cf3",n,t,ri,0,-i,1),hi("cf4",n,t,ri,0,i,1),hi("cn1",n,t,ri,-e,0,-1),hi("cn2",n,t,ri,e,0,-1),hi("cn3",n,t,ri,0,-i,-1),hi("cn4",n,t,ri,0,i,-1),t.getAttribute("position").needsUpdate=!0};function hi(t,n,e,i,s,a,o){dg.set(s,a,o).unproject(i);var r=n[t];if(r!==void 0)for(var u=e.getAttribute("position"),l=0,h=r.length;l<h;l++)u.setXYZ(r[l],dg.x,dg.y,dg.z)}var pg=new cs;function sc(t,n){this.object=t,n===void 0&&(n=16776960);var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new Un;s.setIndex(new nr(e,1)),s.setAttribute("position",new nr(i,3)),ci.call(this,s,new ni({color:n})),this.matrixAutoUpdate=!1,this.update()}sc.prototype=Object.create(ci.prototype),sc.prototype.constructor=sc,sc.prototype.update=function(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&pg.setFromObject(this.object),!pg.isEmpty()){var n=pg.min,e=pg.max,i=this.geometry.attributes.position,s=i.array;s[0]=e.x,s[1]=e.y,s[2]=e.z,s[3]=n.x,s[4]=e.y,s[5]=e.z,s[6]=n.x,s[7]=n.y,s[8]=e.z,s[9]=e.x,s[10]=n.y,s[11]=e.z,s[12]=e.x,s[13]=e.y,s[14]=n.z,s[15]=n.x,s[16]=e.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=e.x,s[22]=n.y,s[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},sc.prototype.setFromObject=function(t){return this.object=t,this.update(),this},sc.prototype.copy=function(t){return ci.prototype.copy.call(this,t),this.object=t.object,this},sc.prototype.clone=function(){return new this.constructor().copy(this)};function mg(t,n){this.type="Box3Helper",this.box=t,n=n||16776960;var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Un;s.setIndex(new nr(e,1)),s.setAttribute("position",new Ln(i,3)),ci.call(this,s,new ni({color:n})),this.geometry.computeBoundingSphere()}mg.prototype=Object.create(ci.prototype),mg.prototype.constructor=mg,mg.prototype.updateMatrixWorld=function(t){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),Rn.prototype.updateMatrixWorld.call(this,t))};function gg(t,n,e){this.type="PlaneHelper",this.plane=t,this.size=n===void 0?1:n;var i=e!==void 0?e:16776960,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],a=new Un;a.setAttribute("position",new Ln(s,3)),a.computeBoundingSphere(),Uo.call(this,a,new ni({color:i}));var o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],r=new Un;r.setAttribute("position",new Ln(o,3)),r.computeBoundingSphere(),this.add(new $r(r,new Fi({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}gg.prototype=Object.create(Uo.prototype),gg.prototype.constructor=gg,gg.prototype.updateMatrixWorld=function(t){var n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?Si:Zc,this.lookAt(this.plane.normal),Rn.prototype.updateMatrixWorld.call(this,t)};var Pw=new oe,yg,yb;function Qa(t,n,e,i,s,a){Rn.call(this),t===void 0&&(t=new oe(0,0,1)),n===void 0&&(n=new oe(0,0,0)),e===void 0&&(e=1),i===void 0&&(i=16776960),s===void 0&&(s=.2*e),a===void 0&&(a=.2*s),yg===void 0&&(yg=new Un,yg.setAttribute("position",new Ln([0,0,0,0,1,0],3)),yb=new Ka(0,.5,1,5,1),yb.translate(0,-.5,0)),this.position.copy(n),this.line=new Uo(yg,new ni({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $r(yb,new Fi({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(e,s,a)}Qa.prototype=Object.create(Rn.prototype),Qa.prototype.constructor=Qa,Qa.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{Pw.set(t.z,0,-t.x).normalize();var n=Math.acos(t.y);this.quaternion.setFromAxisAngle(Pw,n)}},Qa.prototype.setLength=function(t,n,e){n===void 0&&(n=.2*t),e===void 0&&(e=.2*n),this.line.scale.set(1,Math.max(1e-4,t-n),1),this.line.updateMatrix(),this.cone.scale.set(e,n,e),this.cone.position.y=t,this.cone.updateMatrix()},Qa.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},Qa.prototype.copy=function(t){return Rn.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},Qa.prototype.clone=function(){return new this.constructor().copy(this)};function bb(t){t=t||1;var n=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],e=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Un;i.setAttribute("position",new Ln(n,3)),i.setAttribute("color",new Ln(e,3));var s=new ni({vertexColors:Jc});ci.call(this,i,s)}bb.prototype=Object.create(ci.prototype),bb.prototype.constructor=bb;var Zu=4,tl=8,Os=Math.pow(2,tl),Dw=[.125,.215,.35,.446,.526,.582],Rw=tl-Zu+1+Dw.length,Ju=20,zs={[Fo]:0,[hd]:1,[J1]:2,[N_]:3,[O_]:4,[z_]:5,[F_]:6},vb=new Ku,bg=V8(Ju),el=null,nl=null,{_lodPlanes:af,_sizeLods:kw,_sigmas:vg}=O8(),xg=null,zr=null,xb=null,ac=(1+Math.sqrt(5))/2,$u=1/ac,Iw=[new oe(1,1,1),new oe(-1,1,1),new oe(1,1,-1),new oe(-1,1,-1),new oe(0,ac,$u),new oe(0,ac,-$u),new oe($u,0,ac),new oe(-$u,0,ac),new oe(ac,$u,0),new oe(-ac,$u,0)];function Lw(t){zr=t,_b(bg)}Lw.prototype={constructor:Lw,fromScene:function(t,n=0,e=.1,i=100){xb=zr.getRenderTarget();var s=Bw();return z8(t,e,i,s),n>0&&zw(s,0,0,n),Ow(s),Fw(s),s},fromEquirectangular:function(t){return t.magFilter=li,t.minFilter=li,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){xb=zr.getRenderTarget();var n=Bw(t);return U8(t,n),Ow(n),Fw(n),n},compileCubemapShader:function(){nl==null&&(nl=jw(),_b(nl))},compileEquirectangularShader:function(){el==null&&(el=Vw(),_b(el))},dispose:function(){bg.dispose(),nl!=null&&nl.dispose(),el!=null&&el.dispose();for(var t=0;t<af.length;t++)af[t].dispose()}};function O8(){for(var t=[],n=[],e=[],i=tl,s=0;s<Rw;s++){var a=Math.pow(2,i);n.push(a);var o=1/a;s>tl-Zu?o=Dw[s-tl+Zu-1]:s==0&&(o=0),e.push(o);for(var r=1/(a-1),u=-r/2,l=1+r/2,h=[u,u,l,u,l,l,u,u,l,l,u,l],f=6,d=6,p=3,b=2,v=1,x=new Float32Array(p*d*f),w=new Float32Array(b*d*f),M=new Float32Array(v*d*f),E=0;E<f;E++){var D=E%3*2/3-1,N=E>2?0:-1,V=[D,N,0,D+2/3,N,0,D+2/3,N+1,0,D,N,0,D+2/3,N+1,0,D,N+1,0];x.set(V,p*d*E),w.set(h,b*d*E);var K=[E,E,E,E,E,E];M.set(K,v*d*E)}var j=new Un;j.setAttribute("position",new nr(x,p)),j.setAttribute("uv",new nr(w,b)),j.setAttribute("faceIndex",new nr(M,v)),t.push(j),i>Zu&&i--}return{_lodPlanes:t,_sizeLods:n,_sigmas:e}}function Bw(t){var n={magFilter:li,minFilter:li,generateMipmaps:!1,type:t?t.type:Qp,format:t?t.format:iC,encoding:t?t.encoding:J1,depthBuffer:!1,stencilBuffer:!1},e=Nw(n);return e.depthBuffer=!t,xg=Nw(n),e}function Fw(t){xg.dispose(),zr.setRenderTarget(xb),t.scissorTest=!1,t.setSize(t.width,t.height)}function z8(t,n,e,i){var s=90,a=1,o=new gi(s,a,n,e),r=[1,1,1,1,-1,1],u=[1,1,-1,-1,-1,1],l=zr.outputEncoding,h=zr.toneMapping,f=zr.toneMappingExposure,d=zr.getClearColor(),p=zr.getClearAlpha();zr.toneMapping=j1,zr.toneMappingExposure=1,zr.outputEncoding=Fo,t.scale.z*=-1;var b=t.background;if(b&&b.isColor){b.convertSRGBToLinear();var v=Math.max(b.r,b.g,b.b),x=Math.min(Math.max(Math.ceil(Math.log2(v)),-128),127);b=b.multiplyScalar(Math.pow(2,-x));var w=(x+128)/255;zr.setClearColor(b,w),t.background=null}for(var M=0;M<6;M++){var E=M%3;E==0?(o.up.set(0,r[M],0),o.lookAt(u[M],0,0)):E==1?(o.up.set(0,0,r[M]),o.lookAt(0,u[M],0)):(o.up.set(0,r[M],0),o.lookAt(0,0,u[M])),wb(i,E*Os,M>2?Os:0,Os,Os),zr.setRenderTarget(i),zr.render(t,o)}zr.toneMapping=h,zr.toneMappingExposure=f,zr.outputEncoding=l,zr.setClearColor(d,p),t.scale.z*=-1}function U8(t,n){var e=new la;t.isCubeTexture?nl==null&&(nl=jw()):el==null&&(el=Vw());var i=t.isCubeTexture?nl:el;e.add(new $r(af[0],i));var s=i.uniforms;s.envMap.value=t,t.isCubeTexture||s.texelSize.value.set(1/t.image.width,1/t.image.height),s.inputEncoding.value=zs[t.encoding],s.outputEncoding.value=zs[t.encoding],wb(n,0,0,3*Os,2*Os),zr.setRenderTarget(n),zr.render(e,vb)}function _b(t){var n=new la;n.add(new $r(af[0],t)),zr.compile(n,vb)}function Nw(t){var n=new to(3*Os,3*Os,t);return n.texture.mapping=sd,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function wb(t,n,e,i,s){t.viewport.set(n,e,i,s),t.scissor.set(n,e,i,s)}function Ow(t){var n=zr.autoClear;zr.autoClear=!1;for(var e=1;e<Rw;e++){var i=Math.sqrt(vg[e]*vg[e]-vg[e-1]*vg[e-1]),s=Iw[(e-1)%Iw.length];zw(t,e-1,e,i,s)}zr.autoClear=n}function zw(t,n,e,i,s){Uw(t,xg,n,e,i,"latitudinal",s),Uw(xg,t,e,e,i,"longitudinal",s)}function Uw(t,n,e,i,s,a,o){a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var r=3,u=new la;u.add(new $r(af[i],bg));var l=bg.uniforms,h=kw[e]-1,f=isFinite(s)?Math.PI/(2*h):2*Math.PI/(2*Ju-1),d=s/f,p=isFinite(s)?1+Math.floor(r*d):Ju;p>Ju&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${Ju}`);for(var b=[],v=0,x=0;x<Ju;++x){var E=x/d,w=Math.exp(-E*E/2);b.push(w),x==0?v+=w:x<p&&(v+=2*w)}for(var x=0;x<b.length;x++)b[x]=b[x]/v;l.envMap.value=t.texture,l.samples.value=p,l.weights.value=b,l.latitudinal.value=a==="latitudinal",o&&(l.poleAxis.value=o),l.dTheta.value=f,l.mipInt.value=tl-e,l.inputEncoding.value=zs[t.texture.encoding],l.outputEncoding.value=zs[t.texture.encoding];var M=kw[i],E=3*Math.max(0,Os-2*M),D=(i===0?0:2*Os)+2*M*(i>tl-Zu?i-tl+Zu:0);wb(n,E,D,3*M,2*M),zr.setRenderTarget(n),zr.render(u,vb)}function V8(t){var n=new Float32Array(t),e=new oe(0,1,0),i=new Za({defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:e},inputEncoding:{value:zs[Fo]},outputEncoding:{value:zs[Fo]}},vertexShader:Mb(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

${Ab()}

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

void main() {
	gl_FragColor = vec4(0.0);
	for (int i = 0; i < n; i++) {
		if (i >= samples)
			break;
		for (int dir = -1; dir < 2; dir += 2) {
			if (i == 0 && dir == 1)
				continue;
			vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
			if (all(equal(axis, vec3(0.0))))
				axis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);
			axis = normalize(axis);
			float theta = dTheta * float(dir * i);
			float cosTheta = cos(theta);
			// Rodrigues' axis-angle rotation
			vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross(axis, vOutputDirection) * sin(theta)
					+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
			gl_FragColor.rgb +=
					weights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);
		}
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:Ua,depthTest:!1,depthWrite:!1});return i.type="SphericalGaussianBlur",i}function Vw(){var t=new on(1,1),n=new Za({uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:zs[Fo]},outputEncoding:{value:zs[Fo]}},vertexShader:Mb(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

${Ab()}

#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv;
	uv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;
	uv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:Ua,depthTest:!1,depthWrite:!1});return n.type="EquirectangularToCubeUV",n}function jw(){var t=new Za({uniforms:{envMap:{value:null},inputEncoding:{value:zs[Fo]},outputEncoding:{value:zs[Fo]}},vertexShader:Mb(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

${Ab()}

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:Ua,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function Mb(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function Ab(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}Jn.create=function(t,n){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Jn.prototype),t.prototype.constructor=t,t.prototype.getPoint=n,t},Object.assign(Ja.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var n=this.getPoints(t);return this.createGeometry(n)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var n=this.getSpacedPoints(t);return this.createGeometry(n)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var n=new sr,e=0,i=t.length;e<i;e++){var s=t[e];n.vertices.push(new oe(s.x,s.y,s.z||0))}return n}}),Object.assign(Fs.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Object.create(jo.prototype),Object.create(jo.prototype);function Gw(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),jo.call(this,t),this.type="catmullrom"}Gw.prototype=Object.create(jo.prototype),Object.assign(Gw.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),mb.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},nf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Tr.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ec.extractUrlBase(t)}}),Tr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(ab.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(xw.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(cs.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),wd.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},ww.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(pr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),pr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),pr.ceilPowerOfTwo(t)}}),Object.assign(Vi.prototype,{flattenToArrayOffset:function(t,n){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,n)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(mr.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,n){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,n)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new oe().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,n,e,i,s,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,n,i,e,s,a)}}),Ps.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},mo.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(hu.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Bi.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,n)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Bi,{barycoordFromPoint:function(t,n,e,i,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Bi.getBarycoord(t,n,e,i,s)},normal:function(t,n,e,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Bi.getNormal(t,n,e,i)}}),Object.assign(tc.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Lu(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Fu(this,t)}}),Object.assign(on.prototype,{fromAttribute:function(t,n,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,n,e)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(oe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,n){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(n,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,n,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,n,e)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Or.prototype,{fromAttribute:function(t,n,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,n,e)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(sr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Rn.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,n){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(n,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Rn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign($r.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties($r.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),PC},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Em.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Tm.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Rd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Jn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),gi.prototype.setLens=function(t,n){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),n!==void 0&&(this.filmGauge=n),this.setFocalLength(t)},Object.defineProperties(Wr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(nr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===dd},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(dd)}}}),Object.assign(nr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?dd:rm),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Un.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,n){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(n&&n.isBufferAttribute)&&!(n&&n.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new nr(arguments[1],arguments[2]))):t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(n),this):this.setAttribute(t,n)},addDrawCall:function(t,n,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,n)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Un.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(ga.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===dd},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(ga.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?dd:rm),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ya.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(db.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(er.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Dn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===m_}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Ql.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(go.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(A2.prototype,{clearTarget:function(t,n,e,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(n,e,i)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(A2.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?hd:Fo}}}),Object.defineProperties(w2.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(to.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(tf.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var n=this,e=new lb;return e.load(t,function(i){n.setBuffer(i)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),dw.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},_d.prototype.updateCubeMap=function(t,n){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,n)},Ul.crossOrigin=void 0,Ul.loadTexture=function(t,n,e,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var s=new Zd;s.setCrossOrigin(this.crossOrigin);var a=s.load(t,e,void 0,i);return n&&(a.mapping=n),a},Ul.loadTextureCube=function(t,n,e,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var s=new Hy;s.setCrossOrigin(this.crossOrigin);var a=s.load(t,e,void 0,i);return n&&(a.mapping=n),a},Ul.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ul.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:vT}}));class _g extends Ct.MxDbAlignedDimension{constructor(){super()}getDimText(){var n=new oe(this.point1.x-this.point2.x,this.point1.y-this.point2.y,0),e=n.length();return e.toFixed(2)}create(){return new _g}getTypeName(){return this.constructor.name}}function j8(){return re(this,null,function*(){const t=new Ct.MrxDbgUiPrPoint;t.setMessage(dt("指定第一点:")),t.go(n=>{if(n!=0)return;const e=t.value();let i=new _g;i.setPoint1(e),i.setColor(65314);const s=new Ct.McEdGetPointWorldDrawObject;s.setDraw(a=>{i.setPoint2(a),s.drawCustomEntity(i)}),t.setBasePt(e),t.setUseBasePt(!0),t.setUserDraw(s),t.setMessage(dt("指定第二点:")),t.setInputToucheType(Ct.MxType.InputToucheType.kGetEnd),t.go(a=>{if(a!=0){console.log(a);return}const o=t.value();i.setPoint2(o),Ct.MxFun.getCurrentDraw().addMxEntity(i),alert("测试长度是："+i.getDimText())})})})}function G8(){const t=new Ct.MrxDbgUiPrPoint,n=Ct.MxFun.getCurrentDraw(),e=new Ct.MxDb2LineAngularDimension;e.color=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor();const i=new Ct.McEdGetPointWorldDrawObject;i.setColor(A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor()),t.setMessage(dt("指定第一点:")),t.go(s=>{s===0&&(t.setMessage(dt("指定第二个角度点:")),e.point1=t.value(),i.setDraw((a,o)=>{e.point2=a,o.drawLine(e.point1,a)}),t.setUserDraw(i),t.go(a=>{t.setMessage(dt("指定最后一个点:")),a===0&&(e.point2=t.value(),i.setDraw((o,r)=>{e.point3=o,i.drawCustomEntity(e)}),t.go(o=>{o===0&&n.addMxEntity(e)}))}))})}function H8(){const t=new Ct.MrxDbgUiPrPoint;t.setMessage(dt("指定坐标点:")),t.go(n=>{if(n!=0)return;const e=t.value();let i=new Ct.MxDbCoord;i.point1=e,i.point2=e.clone(),i.color=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor(),t.setBasePt(e),t.setUseBasePt(!0),t.setUserDraw((s,a)=>{i.point2=s,a.drawCustomEntity(i)}),t.setMessage(dt("指定标注点:")),t.go(s=>{if(s!=0){console.log(s);return}i.point2=t.value(),Ct.MxFun.addToCurrentSpace(i)})})}function W8(){new _g().rxInit(),Ct.MxFun.addCommand("Mx_Linear",j8),Ct.MxFun.addCommand("BR_AngleMeasure",G8),Ct.MxFun.addCommand("BR_CoordMeasure",H8)}function q8(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage("select entity:");let e=(yield t.go()).getMcDbEntity();if(e!==null){if(console.log("ent.objectName",e.objectName),e instanceof A.McDbBlockReference){let s=e.explode();if(s.GetCount()==0)return;let a=s.GetCount();for(let o=0;o<a;o++){let r=s.AtObject(o).val;if(r instanceof A.McDbPolyline){let u=r,l=u.numVerts();for(let h=0;h<l;h++){let f=u.getPointAt(h),d=u.getBulgeAt(h);console.log("polyline.pt"+h+":"+wo(f.val)),console.log("polyline.bulge"+h+":"+d)}}}}else if(e instanceof A.McDbPolyline){let i=e,s=i.numVerts();for(let a=0;a<s;a++){let o=i.getPointAt(a),r=i.getBulgeAt(a);console.log("polyline.pt"+a+":"+wo(o.val)),console.log("polyline.bulge"+a+":"+r)}}}})}function X8(){Ct.MxFun.addCommand("MxTest_SelectEntity",q8)}class Y8{constructor(){this.m_aryColumn=[],this.m_allData=[],this.m_dColumnHeight=14,this.m_dRowHeight=10,this.m_dRowLineWdith=0,this.m_dColumnLineWidth=.5,this.m_dRowTextHeight=6,this.m_dColumnTextHeight=10}addColumn(n,e){this.m_aryColumn.push({name:n,w:e})}addRow(n){this.m_allData.push(n)}}class Hw{constructor(){this.data=new Y8,this.pt=new A.McGePoint3d,this.dScale=1,this.mxcad=A.MxCpp.getCurrentMxCAD()}draw(n,e){return this.pt=n,this.dScale=e,this.data.m_aryColumn.length==0||this.data.m_allData.length==0?!1:(this.DrawTableHead(),this.DrawContent(),!0)}DrawTableHead(){let n=this.data,e=this.pt.clone(),i=this.pt.clone(),s=new A.McGeVector3d(0,1,0).mult(this.Scale(this.data.m_dColumnHeight));console.log(s);let a=this.Scale(this.data.m_dColumnLineWidth),o=0,r=new A.McGeVector3d(1,0,0);for(let u=0;u<n.m_aryColumn.length;u++){let l=n.m_aryColumn[u];this.DrawLine(i,i.clone().subvec(s),a),this.DrawMCText(i.clone().addvec(r.clone().mult(this.Scale(l.w)*.5)).subvec(s.clone().mult(.5)),l.name,this.Scale(n.m_dColumnTextHeight)),i.addvec(r.clone().mult(this.Scale(l.w))),o+=this.Scale(l.w)}return this.DrawLine(i,i.clone().subvec(s),a),this.DrawLine(e,e.clone().addvec(r.clone().mult(o)),a),this.DrawLine(e.clone().subvec(s),e.addvec(r.clone().mult(o)).subvec(s),a),!0}DrawContent(){let n=this.data,e=this.pt,i=0;for(let l=0;l<n.m_aryColumn.length;l++)i+=this.Scale(n.m_aryColumn[l].w);let s=this.Scale(this.data.m_dRowLineWdith),a=new A.McGeVector3d(1,0,0),o=new A.McGeVector3d(0,1,0),r=e.clone().subvec(o.clone().mult(this.Scale(n.m_dColumnHeight))),u=o.clone().mult(this.Scale(n.m_dRowHeight));for(let l=0;l<n.m_allData.length;l++){let h=r.clone();for(let f=0;f<n.m_aryColumn.length;f++){let d=n.m_aryColumn[f];this.DrawLine(h,h.clone().subvec(u),s),this.DrawMCText(h.clone().addvec(a.clone().mult(this.Scale(d.w*.5))).subvec(u.clone().mult(.5)),n.m_allData[l][f],this.Scale(n.m_dRowTextHeight)),h.addvec(a.clone().mult(this.Scale(d.w)))}this.DrawLine(h,h.clone().subvec(u),s),this.DrawLine(r,r.clone().addvec(a.clone().mult(i)),s),this.DrawLine(r.clone().subvec(u),r.clone().addvec(a.clone().mult(i)).subvec(u),s),r.subvec(u)}return!0}DrawLine(n,e,i){this.mxcad.drawLineWidth=i,this.mxcad.drawColorIndex=A.ColorIndexType.kMagenta,this.mxcad.drawLine(n.x,n.y,e.x,e.y)}DrawMCText(n,e,i){this.mxcad.drawColorIndex=0,this.mxcad.drawColor=new A.McCmColor(0,255,0),this.mxcad.drawText(n.x,n.y,e,i,0,A.McDb.TextHorzMode.kTextMid,A.McDb.TextVertMode.kTextVertMid)}Scale(n){return n*this.dScale}}var dr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ww(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qw={exports:{}};(function(t,n){var e=function(){var i=function(N,V){var K=236,j=17,Z=N,tt=a[V],rt=null,J=0,U=null,G=[],I={},C=function(Y,H){J=Z*4+17,rt=function(at){for(var ft=new Array(at),wt=0;wt<at;wt+=1){ft[wt]=new Array(at);for(var _t=0;_t<at;_t+=1)ft[wt][_t]=null}return ft}(J),L(0,0),L(J-7,0),L(0,J-7),q(),O(),nt(Y,H),Z>=7&&it(Y),U==null&&(U=vt(Z,tt,G)),lt(U,H)},L=function(Y,H){for(var at=-1;at<=7;at+=1)if(!(Y+at<=-1||J<=Y+at))for(var ft=-1;ft<=7;ft+=1)H+ft<=-1||J<=H+ft||(0<=at&&at<=6&&(ft==0||ft==6)||0<=ft&&ft<=6&&(at==0||at==6)||2<=at&&at<=4&&2<=ft&&ft<=4?rt[Y+at][H+ft]=!0:rt[Y+at][H+ft]=!1)},B=function(){for(var Y=0,H=0,at=0;at<8;at+=1){C(!0,at);var ft=r.getLostPoint(I);(at==0||Y>ft)&&(Y=ft,H=at)}return H},O=function(){for(var Y=8;Y<J-8;Y+=1)rt[Y][6]==null&&(rt[Y][6]=Y%2==0);for(var H=8;H<J-8;H+=1)rt[6][H]==null&&(rt[6][H]=H%2==0)},q=function(){for(var Y=r.getPatternPosition(Z),H=0;H<Y.length;H+=1)for(var at=0;at<Y.length;at+=1){var ft=Y[H],wt=Y[at];if(rt[ft][wt]==null)for(var _t=-2;_t<=2;_t+=1)for(var Dt=-2;Dt<=2;Dt+=1)_t==-2||_t==2||Dt==-2||Dt==2||_t==0&&Dt==0?rt[ft+_t][wt+Dt]=!0:rt[ft+_t][wt+Dt]=!1}},it=function(Y){for(var H=r.getBCHTypeNumber(Z),at=0;at<18;at+=1){var ft=!Y&&(H>>at&1)==1;rt[Math.floor(at/3)][at%3+J-8-3]=ft}for(var at=0;at<18;at+=1){var ft=!Y&&(H>>at&1)==1;rt[at%3+J-8-3][Math.floor(at/3)]=ft}},nt=function(Y,H){for(var at=tt<<3|H,ft=r.getBCHTypeInfo(at),wt=0;wt<15;wt+=1){var _t=!Y&&(ft>>wt&1)==1;wt<6?rt[wt][8]=_t:wt<8?rt[wt+1][8]=_t:rt[J-15+wt][8]=_t}for(var wt=0;wt<15;wt+=1){var _t=!Y&&(ft>>wt&1)==1;wt<8?rt[8][J-wt-1]=_t:wt<9?rt[8][15-wt-1+1]=_t:rt[8][15-wt-1]=_t}rt[J-8][8]=!Y},lt=function(Y,H){for(var at=-1,ft=J-1,wt=7,_t=0,Dt=r.getMaskFunction(H),Gt=J-1;Gt>0;Gt-=2)for(Gt==6&&(Gt-=1);;){for(var te=0;te<2;te+=1)if(rt[ft][Gt-te]==null){var mt=!1;_t<Y.length&&(mt=(Y[_t]>>>wt&1)==1);var At=Dt(ft,Gt-te);At&&(mt=!mt),rt[ft][Gt-te]=mt,wt-=1,wt==-1&&(_t+=1,wt=7)}if(ft+=at,ft<0||J<=ft){ft-=at,at=-at;break}}},ut=function(Y,H){for(var at=0,ft=0,wt=0,_t=new Array(H.length),Dt=new Array(H.length),Gt=0;Gt<H.length;Gt+=1){var te=H[Gt].dataCount,mt=H[Gt].totalCount-te;ft=Math.max(ft,te),wt=Math.max(wt,mt),_t[Gt]=new Array(te);for(var At=0;At<_t[Gt].length;At+=1)_t[Gt][At]=255&Y.getBuffer()[At+at];at+=te;var Ot=r.getErrorCorrectPolynomial(mt),Zt=l(_t[Gt],Ot.getLength()-1),he=Zt.mod(Ot);Dt[Gt]=new Array(Ot.getLength()-1);for(var At=0;At<Dt[Gt].length;At+=1){var fe=At+he.getLength()-Dt[Gt].length;Dt[Gt][At]=fe>=0?he.getAt(fe):0}}for(var be=0,At=0;At<H.length;At+=1)be+=H[At].totalCount;for(var Me=new Array(be),Pe=0,At=0;At<ft;At+=1)for(var Gt=0;Gt<H.length;Gt+=1)At<_t[Gt].length&&(Me[Pe]=_t[Gt][At],Pe+=1);for(var At=0;At<wt;At+=1)for(var Gt=0;Gt<H.length;Gt+=1)At<Dt[Gt].length&&(Me[Pe]=Dt[Gt][At],Pe+=1);return Me},vt=function(Y,H,at){for(var ft=h.getRSBlocks(Y,H),wt=f(),_t=0;_t<at.length;_t+=1){var Dt=at[_t];wt.put(Dt.getMode(),4),wt.put(Dt.getLength(),r.getLengthInBits(Dt.getMode(),Y)),Dt.write(wt)}for(var Gt=0,_t=0;_t<ft.length;_t+=1)Gt+=ft[_t].dataCount;if(wt.getLengthInBits()>Gt*8)throw"code length overflow. ("+wt.getLengthInBits()+">"+Gt*8+")";for(wt.getLengthInBits()+4<=Gt*8&&wt.put(0,4);wt.getLengthInBits()%8!=0;)wt.putBit(!1);for(;!(wt.getLengthInBits()>=Gt*8||(wt.put(K,8),wt.getLengthInBits()>=Gt*8));)wt.put(j,8);return ut(wt,ft)};I.addData=function(Y,H){H=H||"Byte";var at=null;switch(H){case"Numeric":at=d(Y);break;case"Alphanumeric":at=p(Y);break;case"Byte":at=b(Y);break;case"Kanji":at=v(Y);break;default:throw"mode:"+H}G.push(at),U=null},I.isDark=function(Y,H){if(Y<0||J<=Y||H<0||J<=H)throw Y+","+H;return rt[Y][H]},I.getModuleCount=function(){return J},I.make=function(){if(Z<1){for(var Y=1;Y<40;Y++){for(var H=h.getRSBlocks(Y,tt),at=f(),ft=0;ft<G.length;ft++){var wt=G[ft];at.put(wt.getMode(),4),at.put(wt.getLength(),r.getLengthInBits(wt.getMode(),Y)),wt.write(at)}for(var _t=0,ft=0;ft<H.length;ft++)_t+=H[ft].dataCount;if(at.getLengthInBits()<=_t*8)break}Z=Y}C(!1,B())},I.createTableTag=function(Y,H){Y=Y||2,H=typeof H=="undefined"?Y*4:H;var at="";at+='<table style="',at+=" border-width: 0px; border-style: none;",at+=" border-collapse: collapse;",at+=" padding: 0px; margin: "+H+"px;",at+='">',at+="<tbody>";for(var ft=0;ft<I.getModuleCount();ft+=1){at+="<tr>";for(var wt=0;wt<I.getModuleCount();wt+=1)at+='<td style="',at+=" border-width: 0px; border-style: none;",at+=" border-collapse: collapse;",at+=" padding: 0px; margin: 0px;",at+=" width: "+Y+"px;",at+=" height: "+Y+"px;",at+=" background-color: ",at+=I.isDark(ft,wt)?"#000000":"#ffffff",at+=";",at+='"/>';at+="</tr>"}return at+="</tbody>",at+="</table>",at},I.createSvgTag=function(Y,H,at,ft){var wt={};typeof arguments[0]=="object"&&(wt=arguments[0],Y=wt.cellSize,H=wt.margin,at=wt.alt,ft=wt.title),Y=Y||2,H=typeof H=="undefined"?Y*4:H,at=typeof at=="string"?{text:at}:at||{},at.text=at.text||null,at.id=at.text?at.id||"qrcode-description":null,ft=typeof ft=="string"?{text:ft}:ft||{},ft.text=ft.text||null,ft.id=ft.text?ft.id||"qrcode-title":null;var _t=I.getModuleCount()*Y+H*2,Dt,Gt,te,mt,At="",Ot;for(Ot="l"+Y+",0 0,"+Y+" -"+Y+",0 0,-"+Y+"z ",At+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',At+=wt.scalable?"":' width="'+_t+'px" height="'+_t+'px"',At+=' viewBox="0 0 '+_t+" "+_t+'" ',At+=' preserveAspectRatio="xMinYMin meet"',At+=ft.text||at.text?' role="img" aria-labelledby="'+Q([ft.id,at.id].join(" ").trim())+'"':"",At+=">",At+=ft.text?'<title id="'+Q(ft.id)+'">'+Q(ft.text)+"</title>":"",At+=at.text?'<description id="'+Q(at.id)+'">'+Q(at.text)+"</description>":"",At+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',At+='<path d="',te=0;te<I.getModuleCount();te+=1)for(mt=te*Y+H,Dt=0;Dt<I.getModuleCount();Dt+=1)I.isDark(te,Dt)&&(Gt=Dt*Y+H,At+="M"+Gt+","+mt+Ot);return At+='" stroke="transparent" fill="black"/>',At+="</svg>",At},I.createDataURL=function(Y,H){Y=Y||2,H=typeof H=="undefined"?Y*4:H;var at=I.getModuleCount()*Y+H*2,ft=H,wt=at-H;return D(at,at,function(_t,Dt){if(ft<=_t&&_t<wt&&ft<=Dt&&Dt<wt){var Gt=Math.floor((_t-ft)/Y),te=Math.floor((Dt-ft)/Y);return I.isDark(te,Gt)?0:1}else return 1})},I.createImgTag=function(Y,H,at){Y=Y||2,H=typeof H=="undefined"?Y*4:H;var ft=I.getModuleCount()*Y+H*2,wt="";return wt+="<img",wt+=' src="',wt+=I.createDataURL(Y,H),wt+='"',wt+=' width="',wt+=ft,wt+='"',wt+=' height="',wt+=ft,wt+='"',at&&(wt+=' alt="',wt+=Q(at),wt+='"'),wt+="/>",wt};var Q=function(Y){for(var H="",at=0;at<Y.length;at+=1){var ft=Y.charAt(at);switch(ft){case"<":H+="&lt;";break;case">":H+="&gt;";break;case"&":H+="&amp;";break;case'"':H+="&quot;";break;default:H+=ft;break}}return H},gt=function(Y){var H=1;Y=typeof Y=="undefined"?H*2:Y;var at=I.getModuleCount()*H+Y*2,ft=Y,wt=at-Y,_t,Dt,Gt,te,mt,At={"██":"█","█ ":"▀"," █":"▄","  ":" "},Ot={"██":"▀","█ ":"▀"," █":" ","  ":" "},Zt="";for(_t=0;_t<at;_t+=2){for(Gt=Math.floor((_t-ft)/H),te=Math.floor((_t+1-ft)/H),Dt=0;Dt<at;Dt+=1)mt="█",ft<=Dt&&Dt<wt&&ft<=_t&&_t<wt&&I.isDark(Gt,Math.floor((Dt-ft)/H))&&(mt=" "),ft<=Dt&&Dt<wt&&ft<=_t+1&&_t+1<wt&&I.isDark(te,Math.floor((Dt-ft)/H))?mt+=" ":mt+="█",Zt+=Y<1&&_t+1>=wt?Ot[mt]:At[mt];Zt+=`
`}return at%2&&Y>0?Zt.substring(0,Zt.length-at-1)+Array(at+1).join("▀"):Zt.substring(0,Zt.length-1)};return I.createASCII=function(Y,H){if(Y=Y||1,Y<2)return gt(H);Y-=1,H=typeof H=="undefined"?Y*2:H;var at=I.getModuleCount()*Y+H*2,ft=H,wt=at-H,_t,Dt,Gt,te,mt=Array(Y+1).join("██"),At=Array(Y+1).join("  "),Ot="",Zt="";for(_t=0;_t<at;_t+=1){for(Gt=Math.floor((_t-ft)/Y),Zt="",Dt=0;Dt<at;Dt+=1)te=1,ft<=Dt&&Dt<wt&&ft<=_t&&_t<wt&&I.isDark(Gt,Math.floor((Dt-ft)/Y))&&(te=0),Zt+=te?mt:At;for(Gt=0;Gt<Y;Gt+=1)Ot+=Zt+`
`}return Ot.substring(0,Ot.length-1)},I.renderTo2dContext=function(Y,H){H=H||2;for(var at=I.getModuleCount(),ft=0;ft<at;ft++)for(var wt=0;wt<at;wt++)Y.fillStyle=I.isDark(ft,wt)?"black":"white",Y.fillRect(ft*H,wt*H,H,H)},I};i.stringToBytesFuncs={default:function(N){for(var V=[],K=0;K<N.length;K+=1){var j=N.charCodeAt(K);V.push(j&255)}return V}},i.stringToBytes=i.stringToBytesFuncs.default,i.createStringToBytes=function(N,V){var K=function(){for(var Z=M(N),tt=function(){var O=Z.read();if(O==-1)throw"eof";return O},rt=0,J={};;){var U=Z.read();if(U==-1)break;var G=tt(),I=tt(),C=tt(),L=String.fromCharCode(U<<8|G),B=I<<8|C;J[L]=B,rt+=1}if(rt!=V)throw rt+" != "+V;return J}(),j="?".charCodeAt(0);return function(Z){for(var tt=[],rt=0;rt<Z.length;rt+=1){var J=Z.charCodeAt(rt);if(J<128)tt.push(J);else{var U=K[Z.charAt(rt)];typeof U=="number"?(U&255)==U?tt.push(U):(tt.push(U>>>8),tt.push(U&255)):tt.push(j)}}return tt}};var s={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},a={L:1,M:0,Q:3,H:2},o={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},r=function(){var N=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],V=1335,K=7973,j=21522,Z={},tt=function(rt){for(var J=0;rt!=0;)J+=1,rt>>>=1;return J};return Z.getBCHTypeInfo=function(rt){for(var J=rt<<10;tt(J)-tt(V)>=0;)J^=V<<tt(J)-tt(V);return(rt<<10|J)^j},Z.getBCHTypeNumber=function(rt){for(var J=rt<<12;tt(J)-tt(K)>=0;)J^=K<<tt(J)-tt(K);return rt<<12|J},Z.getPatternPosition=function(rt){return N[rt-1]},Z.getMaskFunction=function(rt){switch(rt){case o.PATTERN000:return function(J,U){return(J+U)%2==0};case o.PATTERN001:return function(J,U){return J%2==0};case o.PATTERN010:return function(J,U){return U%3==0};case o.PATTERN011:return function(J,U){return(J+U)%3==0};case o.PATTERN100:return function(J,U){return(Math.floor(J/2)+Math.floor(U/3))%2==0};case o.PATTERN101:return function(J,U){return J*U%2+J*U%3==0};case o.PATTERN110:return function(J,U){return(J*U%2+J*U%3)%2==0};case o.PATTERN111:return function(J,U){return(J*U%3+(J+U)%2)%2==0};default:throw"bad maskPattern:"+rt}},Z.getErrorCorrectPolynomial=function(rt){for(var J=l([1],0),U=0;U<rt;U+=1)J=J.multiply(l([1,u.gexp(U)],0));return J},Z.getLengthInBits=function(rt,J){if(1<=J&&J<10)switch(rt){case s.MODE_NUMBER:return 10;case s.MODE_ALPHA_NUM:return 9;case s.MODE_8BIT_BYTE:return 8;case s.MODE_KANJI:return 8;default:throw"mode:"+rt}else if(J<27)switch(rt){case s.MODE_NUMBER:return 12;case s.MODE_ALPHA_NUM:return 11;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 10;default:throw"mode:"+rt}else if(J<41)switch(rt){case s.MODE_NUMBER:return 14;case s.MODE_ALPHA_NUM:return 13;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 12;default:throw"mode:"+rt}else throw"type:"+J},Z.getLostPoint=function(rt){for(var J=rt.getModuleCount(),U=0,G=0;G<J;G+=1)for(var I=0;I<J;I+=1){for(var C=0,L=rt.isDark(G,I),B=-1;B<=1;B+=1)if(!(G+B<0||J<=G+B))for(var O=-1;O<=1;O+=1)I+O<0||J<=I+O||B==0&&O==0||L==rt.isDark(G+B,I+O)&&(C+=1);C>5&&(U+=3+C-5)}for(var G=0;G<J-1;G+=1)for(var I=0;I<J-1;I+=1){var q=0;rt.isDark(G,I)&&(q+=1),rt.isDark(G+1,I)&&(q+=1),rt.isDark(G,I+1)&&(q+=1),rt.isDark(G+1,I+1)&&(q+=1),(q==0||q==4)&&(U+=3)}for(var G=0;G<J;G+=1)for(var I=0;I<J-6;I+=1)rt.isDark(G,I)&&!rt.isDark(G,I+1)&&rt.isDark(G,I+2)&&rt.isDark(G,I+3)&&rt.isDark(G,I+4)&&!rt.isDark(G,I+5)&&rt.isDark(G,I+6)&&(U+=40);for(var I=0;I<J;I+=1)for(var G=0;G<J-6;G+=1)rt.isDark(G,I)&&!rt.isDark(G+1,I)&&rt.isDark(G+2,I)&&rt.isDark(G+3,I)&&rt.isDark(G+4,I)&&!rt.isDark(G+5,I)&&rt.isDark(G+6,I)&&(U+=40);for(var it=0,I=0;I<J;I+=1)for(var G=0;G<J;G+=1)rt.isDark(G,I)&&(it+=1);var nt=Math.abs(100*it/J/J-50)/5;return U+=nt*10,U},Z}(),u=function(){for(var N=new Array(256),V=new Array(256),K=0;K<8;K+=1)N[K]=1<<K;for(var K=8;K<256;K+=1)N[K]=N[K-4]^N[K-5]^N[K-6]^N[K-8];for(var K=0;K<255;K+=1)V[N[K]]=K;var j={};return j.glog=function(Z){if(Z<1)throw"glog("+Z+")";return V[Z]},j.gexp=function(Z){for(;Z<0;)Z+=255;for(;Z>=256;)Z-=255;return N[Z]},j}();function l(N,V){if(typeof N.length=="undefined")throw N.length+"/"+V;var K=function(){for(var Z=0;Z<N.length&&N[Z]==0;)Z+=1;for(var tt=new Array(N.length-Z+V),rt=0;rt<N.length-Z;rt+=1)tt[rt]=N[rt+Z];return tt}(),j={};return j.getAt=function(Z){return K[Z]},j.getLength=function(){return K.length},j.multiply=function(Z){for(var tt=new Array(j.getLength()+Z.getLength()-1),rt=0;rt<j.getLength();rt+=1)for(var J=0;J<Z.getLength();J+=1)tt[rt+J]^=u.gexp(u.glog(j.getAt(rt))+u.glog(Z.getAt(J)));return l(tt,0)},j.mod=function(Z){if(j.getLength()-Z.getLength()<0)return j;for(var tt=u.glog(j.getAt(0))-u.glog(Z.getAt(0)),rt=new Array(j.getLength()),J=0;J<j.getLength();J+=1)rt[J]=j.getAt(J);for(var J=0;J<Z.getLength();J+=1)rt[J]^=u.gexp(u.glog(Z.getAt(J))+tt);return l(rt,0).mod(Z)},j}var h=function(){var N=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],V=function(Z,tt){var rt={};return rt.totalCount=Z,rt.dataCount=tt,rt},K={},j=function(Z,tt){switch(tt){case a.L:return N[(Z-1)*4+0];case a.M:return N[(Z-1)*4+1];case a.Q:return N[(Z-1)*4+2];case a.H:return N[(Z-1)*4+3];default:return}};return K.getRSBlocks=function(Z,tt){var rt=j(Z,tt);if(typeof rt=="undefined")throw"bad rs block @ typeNumber:"+Z+"/errorCorrectionLevel:"+tt;for(var J=rt.length/3,U=[],G=0;G<J;G+=1)for(var I=rt[G*3+0],C=rt[G*3+1],L=rt[G*3+2],B=0;B<I;B+=1)U.push(V(C,L));return U},K}(),f=function(){var N=[],V=0,K={};return K.getBuffer=function(){return N},K.getAt=function(j){var Z=Math.floor(j/8);return(N[Z]>>>7-j%8&1)==1},K.put=function(j,Z){for(var tt=0;tt<Z;tt+=1)K.putBit((j>>>Z-tt-1&1)==1)},K.getLengthInBits=function(){return V},K.putBit=function(j){var Z=Math.floor(V/8);N.length<=Z&&N.push(0),j&&(N[Z]|=128>>>V%8),V+=1},K},d=function(N){var V=s.MODE_NUMBER,K=N,j={};j.getMode=function(){return V},j.getLength=function(rt){return K.length},j.write=function(rt){for(var J=K,U=0;U+2<J.length;)rt.put(Z(J.substring(U,U+3)),10),U+=3;U<J.length&&(J.length-U==1?rt.put(Z(J.substring(U,U+1)),4):J.length-U==2&&rt.put(Z(J.substring(U,U+2)),7))};var Z=function(rt){for(var J=0,U=0;U<rt.length;U+=1)J=J*10+tt(rt.charAt(U));return J},tt=function(rt){if("0"<=rt&&rt<="9")return rt.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+rt};return j},p=function(N){var V=s.MODE_ALPHA_NUM,K=N,j={};j.getMode=function(){return V},j.getLength=function(tt){return K.length},j.write=function(tt){for(var rt=K,J=0;J+1<rt.length;)tt.put(Z(rt.charAt(J))*45+Z(rt.charAt(J+1)),11),J+=2;J<rt.length&&tt.put(Z(rt.charAt(J)),6)};var Z=function(tt){if("0"<=tt&&tt<="9")return tt.charCodeAt(0)-"0".charCodeAt(0);if("A"<=tt&&tt<="Z")return tt.charCodeAt(0)-"A".charCodeAt(0)+10;switch(tt){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+tt}};return j},b=function(N){var V=s.MODE_8BIT_BYTE,K=i.stringToBytes(N),j={};return j.getMode=function(){return V},j.getLength=function(Z){return K.length},j.write=function(Z){for(var tt=0;tt<K.length;tt+=1)Z.put(K[tt],8)},j},v=function(N){var V=s.MODE_KANJI,K=i.stringToBytesFuncs.SJIS;if(!K)throw"sjis not supported.";(function(tt,rt){var J=K(tt);if(J.length!=2||(J[0]<<8|J[1])!=rt)throw"sjis not supported."})("友",38726);var j=K(N),Z={};return Z.getMode=function(){return V},Z.getLength=function(tt){return~~(j.length/2)},Z.write=function(tt){for(var rt=j,J=0;J+1<rt.length;){var U=(255&rt[J])<<8|255&rt[J+1];if(33088<=U&&U<=40956)U-=33088;else if(57408<=U&&U<=60351)U-=49472;else throw"illegal char at "+(J+1)+"/"+U;U=(U>>>8&255)*192+(U&255),tt.put(U,13),J+=2}if(J<rt.length)throw"illegal char at "+(J+1)},Z},x=function(){var N=[],V={};return V.writeByte=function(K){N.push(K&255)},V.writeShort=function(K){V.writeByte(K),V.writeByte(K>>>8)},V.writeBytes=function(K,j,Z){j=j||0,Z=Z||K.length;for(var tt=0;tt<Z;tt+=1)V.writeByte(K[tt+j])},V.writeString=function(K){for(var j=0;j<K.length;j+=1)V.writeByte(K.charCodeAt(j))},V.toByteArray=function(){return N},V.toString=function(){var K="";K+="[";for(var j=0;j<N.length;j+=1)j>0&&(K+=","),K+=N[j];return K+="]",K},V},w=function(){var N=0,V=0,K=0,j="",Z={},tt=function(J){j+=String.fromCharCode(rt(J&63))},rt=function(J){if(!(J<0)){if(J<26)return 65+J;if(J<52)return 97+(J-26);if(J<62)return 48+(J-52);if(J==62)return 43;if(J==63)return 47}throw"n:"+J};return Z.writeByte=function(J){for(N=N<<8|J&255,V+=8,K+=1;V>=6;)tt(N>>>V-6),V-=6},Z.flush=function(){if(V>0&&(tt(N<<6-V),N=0,V=0),K%3!=0)for(var J=3-K%3,U=0;U<J;U+=1)j+="="},Z.toString=function(){return j},Z},M=function(N){var V=N,K=0,j=0,Z=0,tt={};tt.read=function(){for(;Z<8;){if(K>=V.length){if(Z==0)return-1;throw"unexpected end of file./"+Z}var J=V.charAt(K);if(K+=1,J=="=")return Z=0,-1;if(J.match(/^\s$/))continue;j=j<<6|rt(J.charCodeAt(0)),Z+=6}var U=j>>>Z-8&255;return Z-=8,U};var rt=function(J){if(65<=J&&J<=90)return J-65;if(97<=J&&J<=122)return J-97+26;if(48<=J&&J<=57)return J-48+52;if(J==43)return 62;if(J==47)return 63;throw"c:"+J};return tt},E=function(N,V){var K=N,j=V,Z=new Array(N*V),tt={};tt.setPixel=function(G,I,C){Z[I*K+G]=C},tt.write=function(G){G.writeString("GIF87a"),G.writeShort(K),G.writeShort(j),G.writeByte(128),G.writeByte(0),G.writeByte(0),G.writeByte(0),G.writeByte(0),G.writeByte(0),G.writeByte(255),G.writeByte(255),G.writeByte(255),G.writeString(","),G.writeShort(0),G.writeShort(0),G.writeShort(K),G.writeShort(j),G.writeByte(0);var I=2,C=J(I);G.writeByte(I);for(var L=0;C.length-L>255;)G.writeByte(255),G.writeBytes(C,L,255),L+=255;G.writeByte(C.length-L),G.writeBytes(C,L,C.length-L),G.writeByte(0),G.writeString(";")};var rt=function(G){var I=G,C=0,L=0,B={};return B.write=function(O,q){if(O>>>q)throw"length over";for(;C+q>=8;)I.writeByte(255&(O<<C|L)),q-=8-C,O>>>=8-C,L=0,C=0;L=O<<C|L,C=C+q},B.flush=function(){C>0&&I.writeByte(L)},B},J=function(G){for(var I=1<<G,C=(1<<G)+1,L=G+1,B=U(),O=0;O<I;O+=1)B.add(String.fromCharCode(O));B.add(String.fromCharCode(I)),B.add(String.fromCharCode(C));var q=x(),it=rt(q);it.write(I,L);var nt=0,lt=String.fromCharCode(Z[nt]);for(nt+=1;nt<Z.length;){var ut=String.fromCharCode(Z[nt]);nt+=1,B.contains(lt+ut)?lt=lt+ut:(it.write(B.indexOf(lt),L),B.size()<4095&&(B.size()==1<<L&&(L+=1),B.add(lt+ut)),lt=ut)}return it.write(B.indexOf(lt),L),it.write(C,L),it.flush(),q.toByteArray()},U=function(){var G={},I=0,C={};return C.add=function(L){if(C.contains(L))throw"dup key:"+L;G[L]=I,I+=1},C.size=function(){return I},C.indexOf=function(L){return G[L]},C.contains=function(L){return typeof G[L]!="undefined"},C};return tt},D=function(N,V,K){for(var j=E(N,V),Z=0;Z<V;Z+=1)for(var tt=0;tt<N;tt+=1)j.setPixel(tt,Z,K(tt,Z));var rt=x();j.write(rt);for(var J=w(),U=rt.toByteArray(),G=0;G<U.length;G+=1)J.writeByte(U[G]);return J.flush(),"data:image/gif;base64,"+J};return i}();(function(){e.stringToBytesFuncs["UTF-8"]=function(i){function s(a){for(var o=[],r=0;r<a.length;r++){var u=a.charCodeAt(r);u<128?o.push(u):u<2048?o.push(192|u>>6,128|u&63):u<55296||u>=57344?o.push(224|u>>12,128|u>>6&63,128|u&63):(r++,u=65536+((u&1023)<<10|a.charCodeAt(r)&1023),o.push(240|u>>18,128|u>>12&63,128|u>>6&63,128|u&63))}return o}return s(i)}})(),function(i){t.exports=i()}(function(){return e})})(qw);var K8=qw.exports;const Z8=Ww(K8);function J8(t){let n={};if(n.ObjectName=t.objectName,n.id=t.getObjectID().id,n.handle=t.getHandle(),n.layer=t.layer,n.color=t.trueColor.getColorString(),n.colorVal=t.trueColor.getColorValue(t.layerId),n.linetype=t.linetype,n.textStyle=t.textStyle,n.type=t.objectName,n.dxf0=t.dxf0,t instanceof A.McDbText){let e=t;n.position=wo(e.position),n.textString=e.textString}else if(t instanceof A.McDbMText){let e=t;n.contents=e.contents,n.location=wo(e.location)}else if(t instanceof A.McDbLine){let e=t;n.startPoint=wo(e.startPoint),n.endPoint=wo(e.endPoint)}else if(t instanceof A.McDbCircle){let e=t;n.center=wo(e.center),n.radius=e.radius}else if(t instanceof A.McDbArc){let e=t;n.center=wo(e.center),n.startAngle=e.startAngle,n.endAngle=e.endAngle}else if(t instanceof A.McDbPolyline){let e=t,i=e.numVerts();n.num=i;for(let s=0;s<i;s++){let a=e.getPointAt(s),o=e.getBulgeAt(s);n["pt"+s]=wo(a.val),n["bulge"+s]=o}}else if(t instanceof A.McDbBlockReference){let e=t;n.position=wo(e.position),n.blockTransform=e.blockTransform,n.blockName=e.blockName}else if(t instanceof A.McDbAlignedDimension){let e=t;n.xLine1Point=wo(e.xLine1Point),n.xLine2Point=wo(e.xLine2Point),e.GetAllText().forEach((s,a)=>{n["txt:"+a]=s})}else if(t instanceof A.McDbRotatedDimension){let e=t;n.xLine1Point=wo(e.xLine1Point),n.xLine2Point=wo(e.xLine2Point),e.GetAllText().forEach((s,a)=>{n["txt:"+a]=s})}else if(t instanceof A.McDbDimension)t.GetAllText().forEach((s,a)=>{n["txt:"+a]=s});else if(t instanceof A.McDbHatch){let e=t;n.patternType=e.patternType(),n.patternName=e.patternName(),n.patternAngle=e.patternAngle,n.patternScale=e.patternScale,n.patternSpace=e.patternSpace,n.patternDouble=e.patternDouble,n.hatchStyle=e.hatchStyle(),n.isSolid=e.isSolid(),n.numLoops=e.numLoops;for(let i=0;i<n.numLoops;i++){let s=e.getLoopAt(i);s.vertices.forEach((a,o)=>{s["pt:"+o]={},s["pt:"+o].x=a.x,s["pt:"+o].y=a.y,s["pt:"+o].z=a.z}),n["loop:"+i]=s}n.numPatternDefinitions=e.numPatternDefinitions;for(let i=0;i<n.numPatternDefinitions;i++)n["patternDefinitions:"+i]=e.getPatternDefinitionAt(i)}else if(t instanceof A.McDbRasterImage){let e=t,i=e.getOrientation();n.orientation={},n.orientation.origin=i.origin.toVector3(),n.orientation.uCorner=i.uCorner.toVector3(),n.orientation.vOnPlane=i.vOnPlane.toVector3();let s=e.clipBoundary();n.clipBoundary={},s.forEach((o,r)=>{n.clipBoundary["pt"+r]=o.toVector3()}),n.clipBoundaryType=e.clipBoundaryType();let a=e.imageDefId().getMcDbRasterImageDef();a&&(n.filePath=a.sourceFileName)}return n}function $8(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;t.allSelect(),t.forEach(n=>{let e=n.getMcDbEntity();e&&(e=J8(e),console.log(JSON.stringify(e)))})})}function Q8(){return re(this,null,function*(){let t=new A.MxCADSelectionSet,n=new A.MxCADResbuf;n.AddString("0",8),t.allSelect(n),t.forEach(e=>{let i=e.getMcDbEntity();if(i&&i instanceof A.McDbHatch){let s={},a=i;s.patternType=a.patternType(),s.patternName=a.patternName(),s.patternAngle=a.patternAngle,s.patternScale=a.patternScale,s.patternSpace=a.patternSpace,s.patternDouble=a.patternDouble,s.hatchStyle=a.hatchStyle(),s.isSolid=a.isSolid(),s.numLoops=a.numLoops;for(let o=0;o<s.numLoops;o++){let r=a.getLoopAt(o);r.vertices.forEach((u,l)=>{r["pt:"+l]={},r["pt:"+l].x=u.x,r["pt:"+l].y=u.y,r["pt:"+l].z=u.z}),s["loop:"+o]=r}s.numPatternDefinitions=a.numPatternDefinitions;for(let o=0;o<s.numPatternDefinitions;o++)s["patternDefinitions:"+o]=a.getPatternDefinitionAt(o);console.log(s)}})})}function tR(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=t.getDatabase(),e={};e.name="GRIDMODE",e.isShow=t.getSysVarLong("GRIDMODE");let i=t.getSysVarPoint("SNAPUNIT");e.xdist=i.x,e.ydist=i.x,console.log(e);let s={};s.name="ORTHOMODE",s.isShow=t.getSysVarLong("ORTHOMODE"),console.log(s);let a={};a.name="AUTOSNAP",a.enable=(t.getSysVarLong("AUTOSNAP")&8)!=0,a.polarang=t.getSysVarDouble("POLARANG"),console.log(a);let o={};o.name="OSMODE",o.enable=(t.getSysVarLong("OSMODE")&16384)==0,o.value=t.getSysVarLong("OSMODE"),o.End=(t.getSysVarLong("OSMODE")&1)!=0,o.Mid=(t.getSysVarLong("OSMODE")&2)!=0,o.Cen=(t.getSysVarLong("OSMODE")&4)!=0,o.Node=(t.getSysVarLong("OSMODE")&8)!=0,o.Quad=(t.getSysVarLong("OSMODE")&16)!=0,o.Int=(t.getSysVarLong("OSMODE")&32)!=0,o.Ins=(t.getSysVarLong("OSMODE")&64)!=0,o.Perp=(t.getSysVarLong("OSMODE")&128)!=0,o.Tan=(t.getSysVarLong("OSMODE")&256)!=0,o.Near=(t.getSysVarLong("OSMODE")&512)!=0,console.log(o);let r={};r.name="DYNTRACE",r.enable=t.getSysVarLong("DYNTRACE")!=0,console.log(r);let u={};u.name="DYNINPUT",u.enable=t.getSysVarLong("DYNINPUT")!=0,console.log(u);let l={};l.LTSCALE=t.getSysVarDouble("LTSCALE"),l.CELTSCALE=t.getSysVarDouble("CELTSCALE"),l.CELTYPE=t.getSysVarString("CELTYPE"),l.TEXTSTYLE=t.getSysVarString("TEXTSTYLE"),l.CLAYOUTNAME=t.getSysVarString("CLAYOUTNAME"),l.CLAYER=t.getSysVarString("CLAYER"),l.CECOLOR=n.getCurrentlyTrueColor().getColorValue(),l.INSBASE=t.getSysVarPoint("INSBASE"),l.CELWEIGHT=t.getSysVarLong("CELWEIGHT"),l.PDMODE=t.getSysVarLong("PDMODE"),l.PDSIZE=t.getSysVarDouble("PDSIZE"),console.log(l)})}function eR(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity();if(e===null)return;e.getxData().forEach((s,a,o)=>{console.log(JSON.stringify({val:s,type:a,dxf:o}))})})}function nR(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity();e!==null&&e.setxDataString("DataName","xxxxx")})}function rR(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定第一点:"));let n=yield t.go();if(n)for(t.setMessage(dt(" 指定下一个点:"));;){t.setBasePt(n);let e=yield t.go();if(!e)return;let i=new A.McDbLine(n,e);A.MxCpp.getCurrentMxCAD().drawEntity(i),n=e}})}function Xw(){let t=window.location.hostname;return t.substring(0,4)!="http"&&(t=document.location.protocol+"//"+t),t}function iR(){return re(this,null,function*(){let t="http://localhost:3000/mxcad/";t.substring(0,16)=="http://localhost"&&(t=Xw()+t.substring(16));let n=t+"tree.mxweb",e=A.MxCpp.App.getCurrentMxCAD(),i=yield e.insertBlock(n,"tree");if(!i.isValid())return;let s=new A.McDbBlockReference;s.blockTableRecordId=i;let a=s.getBoundingBox();if(a.ret){let f=a.maxPt.distanceTo(a.minPt);f>1e-5&&s.setScale(e.getMxDrawObject().screenCoordLong2Doc(100)/f)}let o=new A.MxCADUiPrPoint;o.setMessage(dt("指定插入基点")),o.setUserDraw((f,d)=>{s.position=f,d.drawMcDbEntity(s)});let r=yield o.go();if(!r)return;s.position=r;let u=e.drawEntity(s);if(!u.isValid){console.log("insert error");return}s=u.getMcDbEntity(),s.disableDisplay(!0),i.getMcDbBlockTableRecord().getAllEntityId().forEach((f,d)=>{if(!f.isKindOf("McDbAttributeDefinition"))return;let p=f.getMcDbEntity(),b=p.tag,v=p.textString,x=new A.McDbAttribute;x.position=p.position,x.alignmentPoint=p.alignmentPoint,x.height=p.height,x.trueColor=p.trueColor,x.widthFactor=p.widthFactor,v.length>0?x.textString=v:x.textString="test"+d,x.tag=b,x.isInvisible=p.isInvisible,x.transformBy(s.blockTransform),x=s.appendAttribute(x).getMcDbEntity(),x.textStyle=p.textStyle,x.layer=p.layer}),s.disableDisplay(!1)})}function oR(){let e=A.MxCpp.App.getCurrentMxCAD().getDatabase().getLayerTable().getAllRecordId(),i=[];return e.forEach(s=>{let a=s.getMcDbLayerTableRecord();if(a===null)return;console.log(a),console.log("layerRec.color:"+a.color.getColorString()),console.log("layerRec.name:"+a.name);let o={};o.name=a.name,o.color=a.color.getColorString(),i.push(o)}),Ct.MxFun.postMessageToParentFrame(i),i}function sR(){let n=A.MxCpp.App.getCurrentMxCAD().getDatabase().getLayerTable();if(!n.has("xxx11")){let e=new A.McDbLayerTableRecord;e.name="xxx11",n.add(e)}n.has("xxx11")&&console.log("add layer ok")}function aR(){A.MxCpp.App.getCurrentMxCAD().getDatabase().getLinetypeTable().getAllRecordId().forEach(i=>{let s=i.getMcDbLinetypeTableRecord();s!==null&&console.log(s)})}function lR(){A.MxCpp.getCurrentMxCAD().getDatabase().getTextStyleTable().getAllRecordId().forEach(i=>{let s=i.getMcDbTextStyleTableRecord();if(s===null)return;let a={};a.name=s.name,a.font=s.font(),a.fileName=s.fileName,a.bigFontFileName=s.bigFontFileName,a.textSize=s.textSize,a.xScale=s.xScale,console.log(a)})}function cR(){return re(this,null,function*(){let n=A.MxCpp.getCurrentMxCAD().getDatabase().getTextStyleTable(),e="MyTextStyle";n.has(e,!1)&&n.get(e,!1).erase(!1);let i=new A.McDbTextStyleTableRecord;i.fileName="txt.shx",i.bigFontFileName="hztxt.shx",i.textSize=10,i.name=e,i.xScale=.7,n.add(i).isValid()&&console.log("add ok")})}function uR(){A.MxCpp.App.getCurrentMxCAD().getDatabase().getBlockTable().getAllRecordId().forEach(i=>{let s=i.getMcDbBlockTableRecord();s!==null&&(console.log(s),console.log("blkRec.name:"+s.name),console.log("blkRec.origin:"+s.origin))})}function hR(){return re(this,null,function*(){let t=new Hw;t.data.addColumn("序号",30),t.data.addColumn("名称",45),t.data.addColumn("材料",60),t.data.addColumn("长度",50);for(let s=0;s<10;s++){let a=""+s;t.data.addRow([a,"AAAA","BBBB","1000"])}let n=new A.MxCADUiPrPoint;n.setMessage(dt(" 指定表格插入点:"));let e=yield n.go();if(!e)return;let i=Ct.MxFun.screenCoordLong2Doc(100)/200;t.draw(e,i)})}function dR(){return re(this,null,function*(){const t=new Ct.MrxDbgUiPrPoint;t.setMessage(dt("指定插入点:"));let n=yield t.go();if(!n)return;let e=Ct.MxFun.getCurrentDraw();const i=Z8(5,"L");i.addData("https://www.mxdraw3d.com"),i.make();const s=i.createDataURL(),a=new Zd().load(s),o=new Fi({map:a});let r=Ct.MxFun.screenCoordLong2Doc(80),u=Ct.MxFun.screenCoordLong2Doc(80),l=new Ct.MxDbImage;l.setRenderOrder(Ct.MxType.MxDefaultRenderOrder.kCADMeshRenderOrder-1),l.setPoint1(n);let h=new oe(n.x+r,n.y+u,n.z);l.setPoint2(h),l.setMaterial(o),e.addMxEntity(l),setInterval(()=>{e.updateDisplay()},100)})}function fR(){return re(this,null,function*(){let t="http://localhost:3000/mxcad/";t.substring(0,16)=="http://localhost"&&(t=Xw()+t.substring(16));let n=t+"stamp.mxweb",e=A.MxCpp.App.getCurrentMxCAD(),i=yield e.insertBlock(n,"stamp");if(!i.isValid())return;let s=new A.McDbBlockReference;s.blockTableRecordId=i;let a=s.getBoundingBox();if(a.ret){let u=a.maxPt.distanceTo(a.minPt);u>1e-5&&s.setScale(e.getMxDrawObject().screenCoordLong2Doc(100)/u)}let o=new A.MxCADUiPrPoint;o.setMessage(dt("指定插入基点")),o.setUserDraw((u,l)=>{s.position=u,l.drawMcDbEntity(s)});let r=yield o.go();r&&(s.position=r,e.drawEntity(s))})}function pR(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=t.database.getLinetypeTable().get("TestMyLine");n.isErase()||n.erase();let e=t.addLinetypeEx("TestMyLine",'.5,-.2,["HW",STANDARD,S=.1,R=0.0,X=-0.1,Y=-.05],-.2',"");if(!e.isValid())return;let a=(yield new A.MxCADUiPrEntity().go()).getMcDbEntity();a&&(a.linetypeId=e)})}function Sb(t){t.getAllObjectName().forEach(e=>{console.log(e);let s=t.getAt(e).getMcDbObject();if(s instanceof A.McDbDictionary){let a=s;console.log(a),Sb(a)}else s instanceof A.McDbXrecord&&s.getData().PrintData()})}function mR(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择标注对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity();if(e&&e.isHaveExtensionDictionary()){let i=e.getExtensionDictionary();Sb(i)}})}function gR(){return re(this,null,function*(){let n=A.MxCpp.getCurrentMxCAD().getDatabase().getNamedObjectsDictionary();n.getAllObjectName().forEach(i=>{console.log(i);let a=n.getAt(i).getMcDbObject();if(a instanceof A.McDbDictionary){let o=a;console.log(o),Sb(o)}})})}function yR(){return re(this,null,function*(){let n=A.MxCpp.getCurrentMxCAD().getDatabase().getNamedObjectsDictionary(),e="MyDict",i=n.getAt(e);if(i.isNull()){let a=new A.McDbDictionary;i=n.addObject(e,a)}let s=i.getMcDbDictionary();if(s){let a=new A.McDbXrecord,o=new A.MxCADResbuf;o.AddString("TestData"),a.setData(o),s.addObject("MyRecord",a),console.log("write xrecord ok")}})}function bR(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择标注对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity();e&&(e.trueColor=new A.McCmColor(255,0,255))})}let Eb;function vR(){return re(this,null,function*(){if(Eb){let t=Eb.getMcDbEntity();if(!t)return;t.visible=!0}else{let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择标注对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity();if(!e)return;e.visible=!1,Eb=n}})}function xR(){return re(this,null,function*(){let t="WALL";A.MxCpp.getCurrentMxCAD().database.layerTable.has(t)||console.log("no have layer:"+t);let e=new A.MxCADUiPrEntity;e.setMessage(dt("选择对象"));let i=yield e.go();if(!i.isValid())return;let s=i.getMcDbEntity();s&&(s.layer=t)})}function _R(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;if(!(yield t.userSelect(dt("选择对象"))))return;let e=A.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder().maxDrawOrder+1;t.forEach(i=>{let s=i.getMcDbEntity();s&&(s.drawOrder=e)})})}function wR(t){let n=A.MxCpp.getCurrentMxCAD();n.mxdraw.makeCurrent(),n.loadDwgBackground(t,e=>{let i=n.getBackgroundEntity();i.setShow(t,!1);let s=i.getBackgroundDatabase(t);if(s==null)return;let a=new A.MxCompare;if(a.do(s)){let o=a.getResult();o.length>0&&i.setShow(t,!0),console.log(JSON.stringify(o))}},53962434921)}function MR(){wR("test3.mxweb")}let lf;function AR(){if(lf)lf.DoRestore(),lf=void 0;else{lf=new A.MxModifyColor;let t=new A.McCmColor;t.setColorIndex(A.ColorIndexType.kWhite),lf.Do(A.MxCpp.getCurrentDatabase(),t)}}function SR(){Ct.MxFun.addCommand("TestGetAllEntity",$8),Ct.MxFun.addCommand("MxTest_GetSysVars",tR),Ct.MxFun.addCommand("MxTest_ReadxData",eR),Ct.MxFun.addCommand("MxTest_WritexData",nR),Ct.MxFun.addCommand("MxTest_DrawLine",rR),Ct.MxFun.addCommand("MxTest_InsertBlock",iR),Ct.MxFun.addCommand("MxTest_GetAllLayer",oR),Ct.MxFun.addCommand("MxTest_AddLayer",sR),Ct.MxFun.addCommand("MxTest_GetAllTextStyle",lR),Ct.MxFun.addCommand("MxTest_GetAllBlock",uR),Ct.MxFun.addCommand("MxTest_GetAllLinetype",aR),Ct.MxFun.addCommand("Mx_Test_DrawTable",hR),Ct.MxFun.addCommand("Mx_Test_QRCode",dR),Ct.MxFun.addCommand("MxTest_InsertStamp",fR),Ct.MxFun.addCommand("MxTest_LineTypeTest",pR),Ct.MxFun.addCommand("TestGentEntityOnLayer",Q8),Ct.MxFun.addCommand("MxTest_GetNamedObjectsDictionary",gR),Ct.MxFun.addCommand("MxTest_GetObjectExDictionaryData",mR),Ct.MxFun.addCommand("MxTest_WriteXRecord",yR),Ct.MxFun.addCommand("MxTest_AddTextStyleTable",cR),Ct.MxFun.addCommand("Mx_Test_ChangeColor",bR),Ct.MxFun.addCommand("Mx_Test_ChangeVisible",vR),Ct.MxFun.addCommand("Mx_Test_ChangeEntityLayer",xR),Ct.MxFun.addCommand("Mx_ChaneEntityDrawOrder",_R),Ct.MxFun.addCommand("Mx_MxCompare",MR),Ct.MxFun.addCommand("MxTest_ModifyAllEntityColor",AR)}function ER(){return re(this,null,function*(){let{baseUrl:t="",saveDwgUrl:n="",mxfilepath:e=""}=ll().getUploadFileConfig();A.MxCpp.getCurrentMxCAD().saveFileToUrl(n,(i,s)=>{try{let a=JSON.parse(s);if(a.ret=="ok"){let o=t+e+a.file;fetch(o).then(r=>re(this,null,function*(){const u=yield r.blob();A.MxTools.saveAsFileDialog({blob:u,filename:a.file,types:[{description:"dwg图纸",accept:{"application/octet-stream":[".dwg"]}}]})}))}else console.log(s)}catch(a){console.log("Mx: sserverResult error")}})})}function TR(){return re(this,null,function*(){let{baseUrl:t="",mxfilepath:n="",saveUrl:e=""}=ll().getUploadFileConfig();A.MxCpp.getCurrentMxCAD().saveFileToUrl(e,(i,s)=>{try{let a=JSON.parse(s);if(a.ret=="ok"){let o=t+n+a.file;A.MxTools.downloadFileFromUrl(o,a.file)}else console.log(s)}catch(a){console.log("Mx: sserverResult error")}})})}function CR(){return re(this,null,function*(){A.MxCpp.getCurrentMxCAD().openWebFile("http://localhost:1337/mxcad/file/8c79da20e232495888dbb0da17459399.mxweb")})}function PR(){return re(this,null,function*(){A.MxCpp.getCurrentMxCAD().newFile()})}function DR(){return re(this,null,function*(){let t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定输出范围第一点:"));let n=yield t.go();if(!n)return;t.setMessage(dt(" 指定输出范围第二点:")),t.setUserDraw((r,u)=>{u.setColor(16711680);let l=new A.McDbPolyline;l.addVertexAt(n),l.addVertexAt(new A.McGePoint3d(n.x,r.y)),l.addVertexAt(r),l.addVertexAt(new A.McGePoint3d(r.x,n.y)),l.constantWidth=Ct.MxFun.screenCoordLong2Doc(2),l.isClosed=!0,u.drawMcDbEntity(l);let h=[];h.push(n.toVector3()),h.push(new THREE.Vector3(n.x,r.y)),h.push(r.toVector3()),h.push(new THREE.Vector3(r.x,n.y)),u.setColor(12868),u.drawSolid(h,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let e=yield t.go();if(!e)return;let{baseUrl:i="",mxfilepath:s="",printPdfUrl:a=""}=ll().getUploadFileConfig();console.log(ll().getUploadFileConfig());let o={width:"2100",height:"2970",bd_pt1_x:""+n.x,bd_pt1_y:""+n.y,bd_pt2_x:""+e.x,bd_pt2_y:""+e.y};A.MxCpp.getCurrentMxCAD().saveFileToUrl(a,(r,u)=>{try{let l=JSON.parse(u);if(l.ret=="ok"){let h=i+s+l.file;A.MxTools.downloadFileFromUrl(h,l.file)}else console.log(u)}catch(l){console.log("Mx: sserverResult error")}},void 0,JSON.stringify(o))})}function RR(){return re(this,null,function*(){let t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定输出范围第一点:"));let n=yield t.go();if(!n)return;t.setMessage(dt(" 指定输出范围第二点:")),t.setUserDraw((r,u)=>{u.setColor(16711680);let l=new A.McDbPolyline;l.addVertexAt(n),l.addVertexAt(new A.McGePoint3d(n.x,r.y)),l.addVertexAt(r),l.addVertexAt(new A.McGePoint3d(r.x,n.y)),l.constantWidth=Ct.MxFun.screenCoordLong2Doc(2),l.isClosed=!0,u.drawMcDbEntity(l);let h=[];h.push(n.toVector3()),h.push(new THREE.Vector3(n.x,r.y)),h.push(r.toVector3()),h.push(new THREE.Vector3(r.x,n.y)),u.setColor(12868),u.drawSolid(h,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let e=yield t.go();if(!e)return;let{baseUrl:i="",mxfilepath:s="",cutDwgUrl:a=""}=ll().getUploadFileConfig();console.log(ll().getUploadFileConfig());let o={bd_pt1_x:""+n.x,bd_pt1_y:""+n.y,bd_pt2_x:""+e.x,bd_pt2_y:""+e.y};A.MxCpp.getCurrentMxCAD().saveFileToUrl(a,(r,u)=>{try{let l=JSON.parse(u);if(l.ret=="ok"){let h=i+s+l.file;A.MxTools.downloadFileFromUrl(h,l.file)}else console.log(u)}catch(l){console.log("Mx: sserverResult error")}},void 0,JSON.stringify(o))})}function kR(){let t=window.location.hostname;return t.substring(0,4)!="http"&&(t=document.location.protocol+"//"+t),t}function IR(){return window.location.origin+window.location.pathname}function LR(t){window.open(t,"_blank")||console.error("弹窗被浏览器拦截")}function BR(){return re(this,null,function*(){let t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定输出范围第一点:"));let n=yield t.go();if(!n)return;t.setMessage(dt(" 指定输出范围第二点:")),t.setUserDraw((r,u)=>{u.setColor(16711680);let l=new A.McDbPolyline;l.addVertexAt(n),l.addVertexAt(new A.McGePoint3d(n.x,r.y)),l.addVertexAt(r),l.addVertexAt(new A.McGePoint3d(r.x,n.y)),l.constantWidth=Ct.MxFun.screenCoordLong2Doc(2),l.isClosed=!0,u.drawMcDbEntity(l);let h=[];h.push(n.toVector3()),h.push(new THREE.Vector3(n.x,r.y)),h.push(r.toVector3()),h.push(new THREE.Vector3(r.x,n.y)),u.setColor(12868),u.drawSolid(h,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let e=yield t.go();if(!e)return;let i=kR()+":1337/mxcad/cut_mxweb",{baseUrl:s="",mxfilepath:a=""}=ll().getUploadFileConfig();console.log(ll().getUploadFileConfig());let o={bd_pt1_x:""+n.x,bd_pt1_y:""+n.y,bd_pt2_x:""+e.x,bd_pt2_y:""+e.y};A.MxCpp.getCurrentMxCAD().saveFileToUrl(i,(r,u)=>{try{let l=JSON.parse(u);if(l.ret=="ok"){let h=s+a+l.file;LR(IR()+"?file="+h)}else console.log(u)}catch(l){console.log("Mx: sserverResult error")}},void 0,JSON.stringify(o))})}function FR(){Ct.MxFun.addCommand("Mx_Export_DWG_test",ER),Ct.MxFun.addCommand("Mx_Export_MxWeb",TR),Ct.MxFun.addCommand("Mx_Open_MxWeb",CR),Ct.MxFun.addCommand("MxTest_NewFile",PR),Ct.MxFun.addCommand("Mx_Export_Pdf",DR),Ct.MxFun.addCommand("Mx_Cut_Dwg",RR),Ct.MxFun.addCommand("Mx_Cut_MxWeb",BR)}function NR(){return re(this,null,function*(){let t="0601",n="001A",e=new A.MxCADSelectionSet,i=new A.MxCADResbuf;i.AddMcDbEntityTypes("TEXT,MTEXT,INSERT,ACAD_PROXY_ENTITY"),e.allSelect(i);let s,a,o=e.count();for(let r=0;r<o;r++){let l=e.item(r).getMcDbEntity();if(!l)return;if(l instanceof A.McDbText){let h=l;if(h.textString==t){s=h.position,a=h.getBoundingBox();break}}else if(l instanceof A.McDbMText){let h=l;if(h.contents==t){s=h.location,a=h.getBoundingBox();break}}else if(l instanceof A.McDbBlockReference){let h=l,f=h.getAllAttribute(),d=0;if(f.forEach(p=>{let b=p.getMcDbEntity();(b.textString==t||b.textString==n)&&d++}),d==2){s=h.position,a=h.getBoundingBox();break}}else if(l instanceof A.McDbProxyEntity){let h=l,f=h.getAllTextContent(),d=0;if(f.forEach(p=>{p==t&&d++}),d>=1){a=h.getBoundingBox(),a&&a.ret&&(s=new A.McGePoint3d(a.minPt.x+(a.maxPt.x-a.minPt.x)*.5,a.minPt.y+(a.maxPt.y-a.minPt.y)*.5));break}}}if(a&&a.ret){console.log(a);let r=a.minPt.distanceTo(a.maxPt)*2;Ct.MxFun.getCurrentDraw().zoomW(new THREE.Vector3(a.minPt.x-r,a.minPt.y-r,0),new THREE.Vector3(a.maxPt.x+r,a.maxPt.y+r,0))}else s?Ct.MxFun.getCurrentDraw().zoomCenter(s.x,s.y):console.log("没有找到文字:"+t)})}function OR(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择目标文字"));const n=yield t.go();if(!n.id)return;const e=n.getMcDbEntity(),i=new A.MxCADSelectionSet,s=[];i.allSelect(new A.MxCADResbuf([A.DxfCode.kEntityType,"TEXT"])),i.forEach(r=>re(this,null,function*(){let u=r.getMcDbEntity();if(u.textString==e.textString){const l=u.position;console.log("文字位置:X："+l.x+"Y："+l.y+"Z："+l.z);const h=u.height;let{minPt:f,maxPt:d,ret:p}=u.getBoundingBox();if(!p)return;const b=A.McGeVector3d.kXAxis.normalize().mult(h*4),v=A.McGeVector3d.kYAxis.normalize().mult(h*4);f.addvec(b.negate()).addvec(v.negate()),d.subvec(b).subvec(v);let x=Math.abs(f.x-d.x),w=Math.abs(f.y-d.y);if(x<1||w<1)return;let M=200,E=M*w/x;s.push({type:"image/bmp",width:M,height:E,range_pt1:f.toVector3(),range_pt2:d.toVector3()})}}));let a="";for(let r=0;r<s.length;r++){let u=yield cf(wi({},s[r]));a+='<img src="'+u+'"/>'}let o=window.open();o!=null&&o.document.write(`<div style="display:flex;align-item:center;justify-content:space-evenly;">${a}</div>`)})}function cf(t){return new Promise((n,e)=>{A.MxCpp.getCurrentMxCAD().setAttribute({ShowCoordinate:!1}),Ct.MxFun.getCurrentDraw().createCanvasImageData(i=>{let s=new A.MxCanvas2Image(document);const a=A.MxCpp.getCurrentMxCAD();let o=s.convertToImage(a.mxdraw.getCanvas(),void 0,void 0,"bmp");n(o.src),a.setAttribute({ShowCoordinate:!0})},t)})}function zR(){Ct.MxFun.addCommand("MxTest_FindText",NR),Ct.MxFun.addCommand("Mx_Test_GetText",OR)}class wg extends A.McDbCustomEntity{constructor(n){super(n),this.pt1=new A.McGePoint3d,this.pt2=new A.McGePoint3d}create(n){return new wg(n)}getTypeName(){return"McDbTestLineCustomEntity"}dwgInFields(n){return this.pt1=n.readPoint("pt1").val,this.pt2=n.readPoint("pt2").val,!0}dwgOutFields(n){return n.writePoint("pt1",this.pt1),n.writePoint("pt2",this.pt2),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n==0?(this.pt1.x+=e,this.pt1.y+=i,this.pt1.z+=s):n==1&&(this.pt2.x+=e,this.pt2.y+=i,this.pt2.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.pt1),n.append(this.pt2),n}worldDraw(n){let e=new A.McDbPolyline;e.addVertexAt(this.pt1),e.addVertexAt(this.pt2),n.drawEntity(e)}setPoint1(n){this.assertWrite(),this.pt1=n.clone()}setPoint2(n){this.assertWrite(),this.pt2=n.clone()}getPoint1(){return this.pt1}getPoint2(){return this.pt2}}function UR(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=new A.MxCADUiPrPoint;n.setMessage(dt("指定一点:"));let e=yield n.go();if(!e)return;n.setBasePt(e),n.setUseBasePt(!0),n.setMessage(dt("指定二点:"));let i=yield n.go();if(!i)return;let s=new wg;s.setPoint1(e),s.setPoint2(i),t.drawEntity(s)})}class Mg extends A.McDbCustomEntity{constructor(n){super(n),this.startPoint=new A.McGePoint3d,this.endPoint=new A.McGePoint3d,this.arrowSize=5,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Mg(n)}getTypeName(){return"McDbTestArrowLine"}dwgInFields(n){return this.startPoint=n.readPoint("startPoint").val,this.endPoint=n.readPoint("endPoint").val,this.arrowSize=n.readDouble("arrowSize").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("startPoint",this.startPoint),n.writePoint("endPoint",this.endPoint),n.writeDouble("arrowSize",this.arrowSize),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.startPoint.x+=e,this.startPoint.y+=i,this.startPoint.z+=s):n===1&&(this.endPoint.x+=e,this.endPoint.y+=i,this.endPoint.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.startPoint),n.append(this.endPoint),n}drawArrow(n,e){const i=[],s=e.sub(n).normalize().mult(this.arrowSize),a=n.clone().addvec(s.clone().rotateBy(Math.PI/6)),o=n.clone().addvec(s.clone().rotateBy(-Math.PI/6)),r=new A.McDbPolyline;r.addVertexAt(a),r.addVertexAt(n),r.addVertexAt(o);const u=n.clone().addvec(e.sub(n).mult(1/2)),l=r.clone();return l.mirror(u,u.clone().addvec(s.clone().perpVector())),i.push(r,l),i}worldDraw(n){const e=this.getAllEntity();e.forEach(i=>n.drawEntity(i)),this.getBox(e)}getAllEntity(){const n=[],e=new A.McDbLine(this.startPoint,this.endPoint);return n.push(e),n.push(...this.drawArrow(this.startPoint,this.endPoint)),n}getBox(n){let e,i=null;n.forEach(s=>{const{minPt:a,maxPt:o}=s.getBoundingBox();e||(e=a.clone()),i||(i=o.clone()),a.x<e.x&&(e.x=a.x),a.y<e.y&&(e.y=a.y),o.x>i.x&&(i.x=o.x),o.y>i.y&&(i.y=o.y)}),e&&i&&(this.assertWrite(),this.maxPt=i,this.minPt=e)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}setStartPoint(n){this.assertWrite(),this.startPoint=n.clone()}getStartPoint(){return this.startPoint}setEndPoint(n){this.assertWrite(),this.endPoint=n.clone()}getEndPoint(){return this.endPoint}setArrowSize(n){this.assertWrite(),this.arrowSize=n}getArrowSize(){return this.arrowSize}}function VR(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new Mg;n.setArrowSize(5);const e=new A.MxCADUiPrPoint;e.setMessage("请指定直线起点:");const i=yield e.go();if(!i)return;n.setStartPoint(i);const s=new A.MxCADUiPrPoint;s.setMessage("请指定直线终点:"),s.setUserDraw((o,r)=>{n.setEndPoint(o),r.drawMcDbEntity(n)});const a=yield s.go();a&&(n.setEndPoint(a),t.drawEntity(n))})}function jR(){new wg().rxInit(),new Mg().rxInit(),Ct.MxFun.addCommand("MxTest_DrawArrowLine",VR),Ct.MxFun.addCommand("MxTest_DrawCustomEntity",UR)}function GR(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;if(!(yield t.userSelect("选择要做成块的对象:"))||t.count()==0)return;let n=A.MxCpp.getCurrentMxCAD(),i=n.getDatabase().getBlockTable().add(new A.McDbBlockTableRecord),s=i.getMcDbBlockTableRecord();if(s==null)return;let a,o,r,u;if(t.forEach(d=>{let p=d.getMcDbEntity();if(!p)return;let b=p.clone();s.appendAcDbEntity(b);let v=p.getBoundingBox();v.ret&&(a?(a>v.minPt.x&&(a=v.minPt.x),o>v.minPt.y&&(o=v.minPt.y),r<v.maxPt.x&&(r=v.maxPt.x),u<v.maxPt.y&&(u=v.maxPt.y)):(a=v.minPt.x,o=v.minPt.y,r=v.maxPt.x,u=v.maxPt.y))}),a===void 0)return;let l=a+(r-a)*.5,h=o+(u-o)*.5;s.origin=new A.McGePoint3d(l,h,0);let f=new A.McDbBlockReference;f.blockTableRecordId=i,f.position=new A.McGePoint3d(l,h,0),f=n.drawEntity(f).getMcDbEntity(),t.forEach(d=>{let p=d.getMcDbEntity();p&&p.erase()})})}function HR(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;if(!(yield t.userSelect("选择要做成块的对象:"))||t.count()==0)return;let n=A.MxCpp.getCurrentMxCAD(),e=n.getDatabase().getBlockTable(),i=new A.McDbBlockTableRecord,s=e.add(i),a=s.getMcDbBlockTableRecord();if(a==null)return;let o,r,u,l;if(t.forEach(E=>{let D=E.getMcDbEntity();if(!D)return;let N=D.clone();a.appendAcDbEntity(N);let V=D.getBoundingBox();V.ret&&(o?(o>V.minPt.x&&(o=V.minPt.x),r>V.minPt.y&&(r=V.minPt.y),u<V.maxPt.x&&(u=V.maxPt.x),l<V.maxPt.y&&(l=V.maxPt.y)):(o=V.minPt.x,r=V.minPt.y,u=V.maxPt.x,l=V.maxPt.y))}),o===void 0)return;let h=o+(u-o)*.5,f=r+(l-r)*.5;a.origin=new A.McGePoint3d(h,f,0);let d=new A.McDbBlockReference;d.blockTableRecordId=s,d.position=new A.McGePoint3d(h+(u-o)*3,f+(l-r)*3,0),d=n.drawEntity(d).getMcDbEntity();let p=u-o;p<l-r&&(p=l-r),p*=.3;let b=new A.McDbCircle(h,f,0,p),v=b.getSamplePoints(p*1e-5),x=new A.McGePoint3dArray;v.forEach((E,D,N)=>{if(N===1010){const V=new A.McGePoint3d(E.x,E.y,E.z);x.append(V)}}),d.createSpatialFilter(),d.scaleFactors=new A.McGePoint3d(3,3,3),d.getSpatialFilterId().getMcDbObject().setBoundary(x),b.center=d.position,b.radius=b.radius*3,n.drawEntity(b)})}function WR(){Ct.MxFun.addCommand("MxTest_SelectEntitysToBlock",GR),Ct.MxFun.addCommand("MxTest_SelectEntitysToSpatialFilterBlock",HR)}function qR(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定填充区域内部一点:")),t.disableAllTrace(!0),t.setDisableOsnap(!0);let n=yield t.go();if(!n)return;let e=A.MxCADUtility.builderHatchFromPoint(n);if(!e){Ct.MxFun.acutPrintf(dt("没有找到闭合区域 "));return}A.MxCpp.getCurrentMxCAD().drawEntity(e)})}function XR(){Ct.MxFun.addCommand("MxTest_DrawHatchFormPoint",qR)}const Tb={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function YR(t){if(/^\d+,\s*\d+,\s*\d+$/.test(t))return t.split(",").map(Number);if(/^0x[0-9a-fA-F]{6}$/.test(t)){const n=parseInt(t,16);return[n>>16&255,n>>8&255,n&255]}else if(/^#[0-9a-fA-F]{6}$/.test(t)){const n=parseInt(t.slice(1),16);return[n>>16&255,n>>8&255,n&255]}else if(Tb[t.toLowerCase()]){const n=t.toLowerCase();if(Tb[n])return Tb[n]}else{const n=new A.McCmColor;return n.setColorIndex(256),[n.red,n.green,n.blue]}}const KR=t=>{const n=A.MxCpp.getCurrentDatabase().layerTable;if(n.has(t))return;const e=new A.McDbLayerTableRecord;e.color=new A.McCmColor(0,0,0),e.isFrozen=!1,e.isLocked=!1,e.isOff=!1,e.lineWeight=A.McDb.LineWeight.kLnWtByLayer,e.name=t,n.add(e)},rl=[{name:"color",description:"颜色",type:"str",required:!0},{name:"layer",description:"图层",type:"str",required:!0},{name:"lineweight",description:"线重",type:"float",required:!0}],il=(t,n)=>{n.layer&&KR(n.layer);const e=i=>{n.color?i.trueColor=new A.McCmColor(...YR(n.color)):i.trueColor=new A.McCmColor(A.MxCpp.getCurrentDatabase().getCurrentlyDrawColor()),n.layer?i.layer=n.layer:i.layer=A.MxCpp.getCurrentDatabase().getCurrentlyLayerName(),n.lineweight&&(i.lineweight=n.lineweight)};Array.isArray(t)?t.forEach(e):t&&e(t)},ZR=t=>{const n=t.split(",").map(s=>Number(s)),e=[];let i=0;for(;i<n.length;){const s=n[i];i++;const a=n[i];if(i++,typeof s=="undefined"||typeof a=="undefined")return e;const o=new A.McGePoint3d(s,a);e.push(o)}return e},Oi=t=>{if(typeof t=="object"&&"x"in t&&"y"in t)return new A.McGePoint3d(t.x,t.y);if(Array.isArray(t))return new A.McGePoint3d(t[0],t[1]);if(typeof t=="string"){const[n,e]=t.split(",").map(i=>Number(i));if(typeof n=="number"&&typeof e=="number")return new A.McGePoint3d(n,e)}};class JR{call(n){if(console.log(n),n&&n.pt1&&n.pt2){let e=A.MxCpp.getCurrentMxCAD();n.pt1&&(n.pt1=Oi(n.pt1)),n.pt2&&(n.pt2=Oi(n.pt2));const i=e.drawLine(n.pt1.x,n.pt1.y,n.pt2.x,n.pt2.y);il(i.getMcDbEntity(),n),e.updateDisplay()}}regist_data(){return{filename:"drawline.json",name:"draw_line",description:"根据直线的开始点和结束点绘制一个直线段",params:[{name:"pt1",description:"直线开始点",type:"tuple[float, float]",required:!0},{name:"pt2",description:"直线结束点",type:"tuple[float, float]",required:!0},...rl]}}}function $R(){Qo.regist(JR)}class QR{call(n){if(console.log(n),n&&n.cen&&n.radius){n.cen&&(n.center=Oi(n.cen));let e=A.MxCpp.getCurrentMxCAD();const i=e.drawCircle(n.center.x,n.center.y,n.radius);il(i.getMcDbEntity(),n),e.updateDisplay()}}regist_data(){return{filename:"drawcircle.json",name:"draw_circle",description:"根据圆心和半径绘制一个圆",params:[{name:"center",description:"圆的中心点",type:"tuple[float, float]",required:!0},{name:"radius",description:"圆的半径",type:"float",required:!0},...rl]}}}const tk=()=>{Qo.regist(QR)};function vo(t,n,e,i,s){const a=t.x,o=t.y,r=n.x,u=n.y,l=e.x,h=e.y,f=i.x,d=i.y,p=(a-r)*(h-d)-(o-u)*(l-f);if(p===0)return null;const b=((a-l)*(h-d)-(o-h)*(l-f))/p,v=-((a-r)*(o-h)-(o-u)*(a-l))/p,x=a+b*(r-a),w=o+b*(u-o),M=new A.McGePoint3d(x,w,0);return s||b>0&&b<1&&v>0&&v<1?M:null}function Qu(t,n){const e=n.x,i=n.y;let s=!1;for(let a=0,o=t.length-1;a<t.length;o=a++){const r=t[a].x,u=t[a].y,l=t[o].x,h=t[o].y;u>i!=h>i&&e<(l-r)*(i-u)/(h-u)+r&&(s=!s)}return s}function uf(t,n,e,i){const s=t-e,a=n-i;let o=0;return s==0?o=Math.PI/2:o=Math.atan(Math.abs(a/s)),s<0&&a>=0?o=Math.PI-o:s<0&&a<0?o=Math.PI+o:s>=0&&a<0&&(o=Math.PI*2-o),o}function hf(t,n,e,i){const s=new A.McDbArc;return s.center=t,s.radius=n,s.startAngle=e,s.endAngle=i,s}class ek{call(n){return re(this,null,function*(){console.log(n);let{center:e,radius:i,startAngle:s,endAngle:a,is3PDraw:o,point1:r,point2:u,point3:l}=n,h=A.MxCpp.getCurrentMxCAD();h.newFile(),h.zoomAll();const f=new A.MxCADUiPrPoint,d=new A.MxCADUiPrDist;if(o){if(r&&(r=Oi(r)),u&&(u=Oi(u)),l&&(l=Oi(l)),f.setKeyWords(""),!r&&(f.setMessage("指定圆弧起点"),f.setUserDraw((b,v)=>{if(!u||!l)return;const x=new A.McDbArc;x.computeArc(b.x,b.y,u.x,u.y,l.x,l.y),v.drawMcDbEntity(x)}),r=yield f.go(),!r)||!u&&(f.setMessage("指定圆弧第二个点"),f.setUserDraw((b,v)=>{if(!r||!l)return;const x=new A.McDbArc;x.computeArc(r.x,r.y,b.x,b.y,l.x,l.y),v.drawMcDbEntity(x)}),u=yield f.go(),!u)||!l&&(f.setMessage("指定圆弧的端点"),f.setUserDraw((b,v)=>{if(!r||!u)return;const x=new A.McDbArc;x.computeArc(r.x,r.y,u.x,u.y,b.x,b.y),v.drawMcDbEntity(x)}),l=yield f.go(),!l))return;const p=new A.McDbArc;console.log(r.x,r.y,u.x,u.y,l.x,l.y),p.computeArc(r.x,r.y,u.x,u.y,l.x,l.y),il(p,n),h.drawEntity(p),h.updateDisplay()}else{if(e&&(e=Oi(e)),s&&(s=s*(Math.PI/180)),a&&(a=a*(Math.PI/180)),!e){f.setMessage("指定圆弧圆心"),f.setKeyWords(""),f.setUserDraw((v,x)=>{i&&x.drawMcDbEntity(hf(v,i,s||0,a||Math.PI*2))});const b=yield f.go();if(!b)return;e=b}if(!i&&(d.setBasePt(e),d.setMessage(A._ML_String("MxAiDrawCircleArc_Radius","指定圆弧半径")),d.setKeyWords(""),d.setUserDraw((b,v)=>{if(!e)return;const x=b.distanceTo(e);v.drawMcDbEntity(hf(e,x,s||0,a||Math.PI*2))}),i=yield d.go(),!i))return;if(!s){if(!e)return;d.setBasePt(e),d.setMessage(A._ML_String("MxAiDrawCircleArc_StartAngle","指定圆弧开始角")),d.setKeyWords(""),d.setUserDraw((v,x)=>{e&&i&&(s=uf(e.x,e.y,v.x,v.y)-Math.PI,x.drawMcDbEntity(hf(e,i,s||0,a||Math.PI*2)))});const b=yield d.go();if(!b)return;d.getDetailedResult()===Ct.DetailedResult.kCoordIn&&(s=b*(Math.PI/180))}if(!a){if(!e)return;d.setBasePt(e),d.setMessage(A._ML_String("MxAiDrawCircleArc_EndAngle","指定圆弧结束角")),d.setKeyWords(""),d.setUserDraw((v,x)=>{e&&i&&(a=uf(e.x,e.y,v.x,v.y)-Math.PI,x.drawMcDbEntity(hf(e,i,s||0,a||Math.PI*2)))});const b=yield d.go();if(!b)return;d.getDetailedResult()===Ct.DetailedResult.kCoordIn&&(a=b*(Math.PI/180))}const p=hf(e,i,s,a);il(p,n),h.drawEntity(p),h.updateDisplay()}})}regist_data(){return{filename:"drawcirclearc.json",name:"draw_circle_arc",description:"绘制圆弧",params:[{name:"center",description:"圆弧圆心",type:"tuple[float, float]",required:!0},{name:"radius",description:"圆弧半径",type:"float",required:!0},{name:"startAngle",description:"圆弧开始角",type:"float",required:!0},{name:"endAngle",description:"圆弧结束角",type:"float",required:!0},{name:"is3PDraw",description:"是否三点绘制",type:"boolean",required:!0},{name:"point1",description:"三点绘制圆弧的第一个点(起点)",type:"tuple[float, float]",required:!0},{name:"point2",description:"三点绘制圆弧的第二个点",type:"tuple[float, float]",required:!0},{name:"point3",description:"三点绘制圆弧的第三个点(终点)",type:"tuple[float, float]",required:!0},...rl]}}}const nk=()=>{Qo.regist(ek)};function Yw(t=new A.McGePoint3d,n=new A.McGePoint3d,e=3){const i=n.x,s=n.y,a=t.x,o=t.y,r=Math.max(3,e),l=Math.sqrt(rx(i-a,2)+rx(s-o,2))/Math.cos(Math.PI/r),h=Math.atan2(s-o,i-a)-Math.PI/r,f=[];for(let d=0;d<r;d++){const p=h+d*2*Math.PI/r,b=a+l*Math.cos(p),v=o+l*Math.sin(p);f.push(new A.McGePoint3d(b,v))}return f}function Kw(t=new A.McGePoint3d,n=new A.McGePoint3d,e=3){const i=[];e=Math.max(3,e),i.push(n);const s=Math.PI*2/e;for(let a=1;a<e;a++){const o=Math.cos(s*a),r=Math.sin(s*a),u=t.clone(),l=n.clone(),h=l.x-u.x,f=l.y-u.y,d=h*o-f*r+u.x,p=h*r+f*o+u.y,b=new A.McGePoint3d(d,p);i.push(b)}return i}function rk(t,n,e){let i=n.x-t.x,s=n.y-t.y,a=Math.sqrt(i*i+s*s),o=Math.atan2(s,i),r=2*Math.PI/Math.max(3,e),u=[t,n];for(let l=0;l<e;l++){let h=t.x+a*Math.cos(o+l*r),f=t.y+a*Math.sin(o+l*r);t=new A.McGePoint3d(h,f),u.push(t)}return u}class ik{call(n){return re(this,null,function*(){A.MxCpp.getCurrentMxCAD().newFile(),console.log(n);let{isDrawToCenter:e,sideNum:i,startPoint:s,endPoint:a,radius:o,centerPoint:r,isTangentToTheCircle:u}=n;if(!i){const l=new A.MxCADUiPrInt;l.setMessage("输入边的数目<5>"),l.setKeyWords(""),l.clearLastInputPoint(),i=(yield l.go())||5}if(e){if(r)r=Oi(r);else{const d=new A.MxCADUiPrPoint;if(d.setMessage(`
指定正多变形的中心点`),d.setKeyWords(""),d.clearLastInputPoint(),r=yield d.go(),!r)return}let l=A.McGeVector3d.kXAxis,h;if(!o){const d=new A.MxCADUiPrDist;d.setMessage(A._ML_String("MxAiDrawPolygon_radius","指定圆的半径")),d.setKeyWords(""),d.setBasePt(r),d.setUserDraw((b,v)=>{if(u){const x=b.distanceTo(r);l=b.sub(r);const w=r.clone().addvec(b.sub(r).normalize().mult(x)),M=Yw(r,w,i),E=new A.McDbPolyline;M.forEach(D=>{E.addVertexAt(D)}),E.isClosed=!0,v.drawMcDbEntity(E)}else{h=b;const x=new A.McDbPolyline;Kw(r,b,i).forEach(w=>{x.addVertexAt(w)}),x.isClosed=!0,v.drawMcDbEntity(x)}});const p=yield d.go();if(!p)return;o=p}const f=new A.McDbPolyline;if(f.isClosed=!0,u){const d=r.clone().addvec(l.normalize().mult(o));Yw(r,d,i).forEach(b=>{f.addVertexAt(b)})}else{if(!h){const d=A.McGeVector3d.kXAxis.clone().rotateBy(Math.PI/i).mult(o);h=r.clone().addvec(d)}Kw(r,h,i).forEach(d=>{f.addVertexAt(d)})}A.MxCpp.getCurrentMxCAD().drawEntity(f)}else{const l=f=>{const d=new A.McDbPolyline;return rk(s,f,i||5).forEach(b=>{d.addVertexAt(b)}),d.isClosed=!0,d};if(s)s=Oi(s);else{const f=new A.MxCADUiPrPoint;if(f.clearLastInputPoint(),f.setMessage(`
指定边的第一个端点`),f.setKeyWords(""),s=yield f.go(),!s)return;f.setUserDraw((d,p)=>{p.drawMcDbEntity(l(d))})}if(a)a=Oi(a);else{const f=new A.MxCADUiPrPoint;f.setBasePt(s),f.setMessage(`
指定边的第二个端点`),a=yield f.go()}if(!a)return;const h=l(a);A.MxCpp.getCurrentMxCAD().drawEntity(h)}})}regist_data(){return{filename:"DrawPolygon.json",name:"draw_polygon",description:"绘制正多边形",params:[{name:"isDrawToCenter",description:"是否用圆绘制多边形",type:"boolean",required:!0},{name:"sideNum",description:"边数",type:"int",required:!0},{name:"startPoint",description:"边绘制提供开始点",type:"tuple[float, float]",required:!0},{name:"endPoint",description:"边绘制提供结束点",type:"tuple[float, float]",required:!0},{name:"radius",description:"圆的半径",type:"number",required:!0},{name:"centerPoint",description:"圆心",type:"tuple[float, float]",required:!0},{name:"isTangentToTheCircle",description:"外切于圆",type:"boolean",required:!0}]}}}const ok=()=>{Qo.regist(ik)},Zw=(t,n,e)=>{const i=Math.cos(e),s=Math.sin(e),a=n.x-t.x,o=n.y-t.y,r=a*i-o*s+t.x,u=a*s+o*i+t.y,l=n.z;return new A.McGePoint3d(r,u,l)},Cb=(t,n,e=0)=>{const i=new A.McGePoint3d((t.x+n.x)/2,(t.y+n.y)/2,(t.z+n.z)/2),s=new A.McGePoint3d(t.x,n.y,t.z),a=new A.McGePoint3d(n.x,t.y,n.z),o=Zw(i,s,e),r=Zw(i,a,e);return[t,o,n,r]},Jw=(t,n)=>[n.x>=t.x&&n.y>=t.y,n.x<t.x&&n.y>=t.y,n.x<t.x&&n.y<t.y,n.x>=t.x&&n.y<t.y];function $w(t,n,e){if(n===0&&e===0)return t;const[i,s,a,o]=t,r=i.distanceTo(o),u=i.distanceTo(s),[l,h,f,d]=Jw(i,a),p=h||f?-n:n,b=f||d?-e:e;if(r-Math.abs(p)*2<=0||u-Math.abs(b)*2<=0)return t;const v=new A.McGePoint3d(i.x+p,i.y,i.z),x=new A.McGePoint3d(i.x,i.y+b,i.z),w=new A.McGePoint3d(s.x,s.y-b,s.z),M=new A.McGePoint3d(s.x+p,s.y,s.z),E=new A.McGePoint3d(a.x-p,a.y,a.z),D=new A.McGePoint3d(a.x,s.y-b,a.z),N=new A.McGePoint3d(o.x,o.y+b,o.z),V=new A.McGePoint3d(o.x-p,o.y,o.z);return[v,x,w,M,E,D,N,V]}function sk(t,n,e){if(t.isEqualTo(n))return 0;let i=t.c().addvec(n.c().sub(t).mult(.5)),s=n.c().sub(t);s.rotateBy(Math.PI/2,A.McGeVector3d.kZAxis);let a=new A.McDbLine(i,i.c().addvec(s)),o=e.c();o.rotateBy(Math.PI/2,A.McGeVector3d.kZAxis);let r=new A.McDbLine(t,t.c().addvec(o)),u=a.IntersectWith(r,A.McDb.Intersect.kExtendBoth);if(u.isEmpty())return 0;let l=u.at(0),h=l.distanceTo(t);s.normalize(),s.mult(h);let f=l.c().addvec(s),d=l.c().subvec(s),p=f.c().sub(t),b=d.c().sub(t),v=f;return p.angleTo1(e)>b.angleTo1(e)&&(v=d),A.MxCADUtility.calcBulge(t,v,n).val}class ak{call(n){return re(this,null,function*(){console.log(n),A.MxCpp.getCurrentMxCAD().newFile();let{pt1:e,pt2:i,chamfer1Length:s,chamfer2Length:a,filletRadius:o,lineWidth:r,area:u,rectLength:l,rectWidth:h,rotationAngle:f}=n;const d=(v,x)=>{const[w,M,E,D]=Cb(v,x,f),N=new A.McDbPolyline;return N.addVertexAt(w,0,r,r),N.addVertexAt(M,0,r,r),N.addVertexAt(E,0,r,r),N.addVertexAt(D,0,r,r),N.isClosed=!0,r&&(N.constantWidth=r),N},p=(v,x)=>{let w;if(o){const M=$w(Cb(v,x,f),o,o),[E,D,N,V]=Jw(v,x);if(M.length===8){w||(w=new A.McDbPolyline);const K=(J,U,G)=>{let I=new A.McGeVector3d(G);const C=sk(J,U,I);w.addVertexAt(J,C,r,r),w.addVertexAt(U,0,r,r)},j=new A.McGeVector3d(-1,0),Z=new A.McGeVector3d(0,1),tt=new A.McGeVector3d(1,0),rt=new A.McGeVector3d(0,-1);V&&(Z.y=-1,tt.x=1,rt.y=1),D&&(j.x=1,Z.y=1,tt.x=-1,rt.y=-1),N&&(j.x=1,Z.y=-1,tt.x=-1,rt.y=1),K(M[0],M[1],j),K(M[2],M[3],Z),K(M[4],M[5],tt),K(M[6],M[7],rt),w.isClosed=!0}}else(s||a)&&(w||(w=new A.McDbPolyline),$w(Cb(v,x,f),s||a,a||s).forEach(E=>{w.addVertexAt(E)}),w.isClosed=!0);return w||(w=d(v,x)),r&&(w.constantWidth=r),w};if(e)e=Oi(e);else{const v=new A.MxCADUiPrPoint;if(v.setMessage("指定第一个角点"),v.setKeyWords(""),e=yield v.go(),!e)return}if(u&&(l&&(h=u/l),h&&(l=u/h)),l&&h&&(i=new A.McGePoint3d(e.x+h,e.y+l,0)),i)i=Oi(i);else{const v=new A.MxCADUiPrPoint;if(v.setMessage("指定第二个角点"),v.setKeyWords(""),v.setUserDraw((x,w)=>{w.drawMcDbEntity(p(e,x))}),i=yield v.go(),!i)return}const b=p(e,i);il(b,n),A.MxCpp.getCurrentMxCAD().drawEntity(b)})}regist_data(){return{filename:"drawRect.json",name:"draw_rect",description:"根据一些信息绘制矩形",params:[{name:"pt1",description:"一个对角点",type:"tuple[float, float]",required:!0},{name:"pt2",description:"另一个对角点",type:"tuple[float, float]",required:!0},{name:"lineWidth",description:"矩形线的宽",type:"float",required:!0},{name:"filletRadius",description:"圆角半径",type:"float",required:!0},{name:"chamfer1Length",description:"第一个倒角距离",type:"float",required:!0},{name:"chamfer2Length",description:"第二个倒角距离",type:"float",required:!0},{name:"rectLength",description:"长度",type:"float",required:!0},{name:"rectWidth",description:"矩形宽度",type:"float",required:!0},{name:"area",description:"面积",type:"float",required:!0},{name:"rotationAngle",description:"旋转角度",type:"float",required:!0},...rl]}}}function lk(){Qo.regist(ak)}const Us=(t,n,e,i,s)=>{const a=new A.McDbEllipse,o=new A.McGePoint3d((t.x+n.x)/2,(n.y+n.y)/2),r=t.sub(n),u=r,l=t.distanceTo(n)/2,f=e/2/l;return a.center=o,a.majorAxis=r,a.minorAxis=u,a.radiusRatio=f,a.startAngle=i,a.endAngle=s,a};class ck{call(n){return re(this,null,function*(){let{endPoint1:e,endPoint2:i,halfAxisLength:s}=n;const a=A.MxCpp.getCurrentMxCAD();a.newFile();const o=new A.MxCADUiPrPoint,r=new A.MxCADUiPrDist;if(e&&(e=Oi(e)),i&&(i=Oi(i)),!e&&(o.setMessage("指定椭圆的轴端点1"),o.setKeyWords(""),o.setUserDraw((l,h)=>{i&&s&&h.drawMcDbEntity(Us(l,i,s,0,Math.PI*2))}),e=yield o.go(),!e)||!i&&(o.setMessage("指定椭圆的轴端点2"),o.setKeyWords(""),o.setUserDraw((l,h)=>{e&&s&&h.drawMcDbEntity(Us(e,l,s,0,Math.PI*2))}),i=yield o.go(),!i))return;if(!s){r.setMessage("指定半轴长度"),r.setKeyWords("");const l=new A.McGePoint3d((e.x+i.x)/2,(i.y+i.y)/2);if(r.setBasePt(l),r.setUserDraw((h,f)=>{e&&f.drawMcDbEntity(Us(e,i,l.distanceTo(h),0,Math.PI*2))}),s=yield r.go(),!s)return}const u=Us(e,i,s,0,Math.PI*2);il(u,n),a.drawEntity(u)})}regist_data(){return{filename:"drawellipse.json",name:"draw_ellipse",description:"绘制椭圆",params:[{name:"endPoint1",description:"椭圆端点1",type:"tuple[float, float]",required:!0},{name:"endPoint2",description:"椭圆端点2",type:"tuple[float, float]",required:!0},{name:"halfAxisLength",description:"半轴长度",type:"float",required:!0},...rl]}}}class uk{call(n){return re(this,null,function*(){let{endPoint1:e,endPoint2:i,halfAxisLength:s,startAngle:a,endAngle:o}=n;const r=A.MxCpp.getCurrentMxCAD();r.newFile();const u=new A.MxCADUiPrPoint,l=new A.MxCADUiPrDist;if(e&&(e=Oi(e)),i&&(i=Oi(i)),a&&(a=a*(Math.PI/180)),o&&(o=o*(Math.PI/180)),!e&&(u.setMessage("指定椭圆的轴端点1"),u.setKeyWords(""),u.setUserDraw((p,b)=>{i&&s&&b.drawMcDbEntity(Us(p,i,s,0,Math.PI*2))}),e=yield u.go(),!e)||!i&&(u.setMessage("指定椭圆的轴端点2"),u.setKeyWords(""),u.setUserDraw((p,b)=>{e&&s&&b.drawMcDbEntity(Us(e,p,s,0,Math.PI*2))}),i=yield u.go(),!i))return;const h=new A.McGePoint3d((e.x+i.x)/2,(i.y+i.y)/2);if(!s&&(l.setMessage("指定半轴长度"),l.setKeyWords(""),l.setBasePt(h),l.setUserDraw((p,b)=>{e&&b.drawMcDbEntity(Us(e,i,h.distanceTo(p),0,Math.PI*2))}),s=yield l.go(),!s))return;const f=uf(h.x,h.y,e.x,e.y);if(!a){l.setMessage(A._ML_String("EllipticalArc_startAngle","指定起点角度")),l.setKeyWords(""),l.setUserDraw((b,v)=>{a=uf(h.x,h.y,b.x,b.y)-f-Math.PI,v.drawMcDbEntity(Us(e,i,s,a,Math.PI*2))});const p=yield l.go();if(!p)return;l.getDetailedResult()==Ct.DetailedResult.kCoordIn&&(a=p*(180/Math.PI))}if(!o){l.setLastInputPoint(h),l.setMessage(A._ML_String("EllipticalArc_endAngle","指定端点角度")),l.setKeyWords(""),l.setUserDraw((b,v)=>{o=uf(h.x,h.y,b.x,b.y)-f-Math.PI,v.drawMcDbEntity(Us(e,i,s,a,o))});const p=yield l.go();if(!p)return;l.getDetailedResult()===Ct.DetailedResult.kCoordIn&&(o=p*(180/Math.PI))}const d=Us(e,i,s,a,o);il(d,n),r.drawEntity(d)})}regist_data(){return{filename:"drawellipseArc.json",name:"draw_ellipse_arc",description:"绘制椭圆弧",params:[{name:"endPoint1",description:"椭圆弧端点1",type:"tuple[float, float]",required:!0},{name:"endPoint2",description:"椭圆弧端点2",type:"tuple[float, float]",required:!0},{name:"halfAxisLength",description:"半轴长度",type:"float",required:!0},{name:"startAngle",description:"开始角度",type:"float",required:!0},{name:"endAngle",description:"结束角度",type:"float",required:!0},...rl]}}}const hk=()=>{Qo.regist(ck),Qo.regist(uk)},Qw=class Es{constructor(n,e,i=50){this.width=50,this.isDraw=!1,this.update(n,e,i)}update(n,e,i=this.width){let s=n.clone().sub(e).normalize();s=new A.McGeVector3d(-s.y,s.x,0).mult(i/2);const a=s.clone().negate();this.outsidePoints=[n.clone().addvec(s),e.clone().addvec(s)],this.insidePoints=[n.clone().addvec(a),e.clone().addvec(a)],this.width=i,this.startPoint=n.clone(),this.endPoint=e.clone(),this.outsideLine?(this.outsideLine.startPoint=this.outsidePoints[0],this.outsideLine.endPoint=this.outsidePoints[1]):this.outsideLine=new A.McDbLine(this.outsidePoints[0],this.outsidePoints[1]),this.insideLine?(this.insideLine.startPoint=this.insidePoints[0],this.insideLine.endPoint=this.insidePoints[1]):this.insideLine=new A.McDbLine(this.insidePoints[0],this.insidePoints[1]),this.startClosedLine?(this.startClosedLine.startPoint=this.outsidePoints[0],this.startClosedLine.endPoint=this.insidePoints[0]):this.startClosedLine=new A.McDbLine(this.outsidePoints[0],this.insidePoints[0]),this.endClosedLine?(this.endClosedLine.startPoint=this.outsidePoints[1],this.endClosedLine.endPoint=this.insidePoints[1]):this.endClosedLine=new A.McDbLine(this.outsidePoints[1],this.insidePoints[1])}clone(){const n=new Es(this.startPoint,this.endPoint,this.width);return n.insideLine=this.insideLine.clone(),n.outsideLine=this.outsideLine.clone(),n}hiddenStartClosedLine(){this.startClosedLine.visible=!1}hiddenEndClosedLine(){this.endClosedLine.visible=!1}getClosedStartLineToDiffWallInsideLineIntersectionPoint(n,e=!1){return this.startClosedLine.visible?vo(n.insideLine.startPoint,n.insideLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,e):null}getClosedStartLineToDiffWallOutsideLineIntersectionPoint(n,e=!1){return this.startClosedLine.visible?vo(n.outsideLine.startPoint,n.outsideLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,e):null}getClosedEndLineToDiffWallInsideLineIntersectionPoint(n,e=!1){return this.endClosedLine.visible?vo(n.insideLine.startPoint,n.insideLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,e):null}getClosedEndLineToDiffWallOutsideLineIntersectionPoint(n,e=!1){return this.endClosedLine.visible?vo(n.outsideLine.startPoint,n.outsideLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,e):null}getInsideToDiffInsideIntersectionPoint(n,e=!1){return vo(n.insideLine.startPoint,n.insideLine.endPoint,this.insideLine.startPoint,this.insideLine.endPoint,e)}getOutsideToDiffOutsideIntersectionPoint(n,e=!1){return vo(n.outsideLine.startPoint,n.outsideLine.endPoint,this.outsideLine.startPoint,this.outsideLine.endPoint,e)}getInsideToDiffOutsideIntersectionPoint(n,e=!1){return vo(n.outsideLine.startPoint,n.outsideLine.endPoint,this.insideLine.startPoint,this.insideLine.endPoint,e)}getOutsideToDiffInsideIntersectionPoint(n,e=!1){return vo(n.insideLine.startPoint,n.insideLine.endPoint,this.outsideLine.startPoint,this.outsideLine.endPoint,e)}getClosedStartLineToDiffLineClosedStartLineIntersectionPoint(n,e=!1){return this.startClosedLine.visible?vo(n.startClosedLine.startPoint,n.startClosedLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,e):null}getClosedStartLineToDiffLineClosedEndLineIntersectionPoint(n,e=!1){return this.startClosedLine.visible?vo(n.endClosedLine.startPoint,n.endClosedLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,e):null}getClosedEndLineToDiffLineClosedStartLineIntersectionPoint(n,e=!1){return this.endClosedLine.visible?vo(n.startClosedLine.startPoint,n.startClosedLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,e):null}getClosedEndLineToDiffLineClosedEndLineIntersectionPoint(n,e=!1){return this.endClosedLine.visible?vo(n.endClosedLine.startPoint,n.endClosedLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,e):null}isCorner(n){const e=n.startPoint.sub(n.endPoint).normalize(),i=e.clone().mult(n.width),s=e.clone().mult(-n.width),a=n.insideLine.startPoint.clone().addvec(i),o=n.insideLine.startPoint.clone().addvec(s),r=n.outsideLine.startPoint.clone().addvec(s),u=n.outsideLine.startPoint.clone().addvec(i),l=n.insideLine.endPoint.clone().addvec(i),h=n.insideLine.endPoint.clone().addvec(s),f=n.outsideLine.endPoint.clone().addvec(s),d=n.outsideLine.endPoint.clone().addvec(i),p=Qu([a,o,r,u],this.startPoint),b=Qu([a,o,r,u],this.endPoint),v=Qu([l,h,f,d],this.startPoint),x=Qu([l,h,f,d],this.endPoint);return[{start:p,end:b},{start:v,end:x}]}handlingCorners(n){const[e,i]=this.isCorner(n);if(i.start){this.outsideLine.startPoint=n.outsideLine.endPoint=this.getOutsideToDiffOutsideIntersectionPoint(n,!0),this.insideLine.startPoint=n.insideLine.endPoint=this.getInsideToDiffInsideIntersectionPoint(n,!0),this.hiddenStartClosedLine(),n.hiddenEndClosedLine();return}else if(i.end){this.outsideLine.endPoint=n.insideLine.endPoint=this.getOutsideToDiffInsideIntersectionPoint(n,!0),this.insideLine.endPoint=n.outsideLine.endPoint=this.getInsideToDiffOutsideIntersectionPoint(n,!0),this.hiddenEndClosedLine(),n.hiddenEndClosedLine();return}else if(e.start){this.insideLine.startPoint=n.outsideLine.startPoint=this.getInsideToDiffOutsideIntersectionPoint(n,!0),this.outsideLine.startPoint=n.insideLine.startPoint=this.getOutsideToDiffInsideIntersectionPoint(n,!0),this.hiddenStartClosedLine(),n.hiddenStartClosedLine();return}else if(e.end){this.outsideLine.endPoint=n.outsideLine.startPoint=this.getOutsideToDiffOutsideIntersectionPoint(n,!0),this.insideLine.endPoint=n.insideLine.startPoint=this.getInsideToDiffInsideIntersectionPoint(n,!0),this.hiddenEndClosedLine(),n.hiddenStartClosedLine();return}}processingIntersection(){const n=[];Es.lines.forEach(e=>{const i=this.getInsideToDiffInsideIntersectionPoint(e),s=this.getInsideToDiffOutsideIntersectionPoint(e),a=this.getOutsideToDiffOutsideIntersectionPoint(e),o=this.getOutsideToDiffInsideIntersectionPoint(e);(i||s||a||o)&&n.push({diffLine:e,intersectionPoints:[i,s,a,o]})}),n.forEach(({diffLine:e,intersectionPoints:i})=>{const[s,a]=this.isCorner(e);s.end||s.start||a.start||a.start;const[o,r,u,l]=i,h=[e.insideLine.startPoint,e.insideLine.endPoint,e.outsideLine.endPoint,e.outsideLine.startPoint];if(Qu(h,this.startPoint),Qu(h,this.endPoint),o&&r&&u&&l){const f=vo(this.startPoint,this.endPoint,e.startPoint,e.endPoint),d=new Es(this.startPoint,f,this.width),p=new Es(f,this.endPoint,this.width),b=new Es(e.startPoint,f,e.width),v=new Es(f,e.endPoint,e.width);d.insideLine.startPoint=this.insideLine.startPoint,d.outsideLine.startPoint=this.outsideLine.startPoint,p.insideLine.endPoint=this.insideLine.endPoint,p.outsideLine.endPoint=this.outsideLine.endPoint,e.remove(),this.remove(),d.draw(),p.draw(),b.draw(),v.draw()}else if(u&&r||o&&l){const f=vo(this.startPoint,this.endPoint,e.startPoint,e.endPoint,!0),d=new Es(e.startPoint,f,e.width);d.hiddenEndClosedLine();const p=new Es(f,e.endPoint,e.width);p.hiddenStartClosedLine(),e.remove(),d.draw(),p.draw()}else{if(n.length===1)return this.handlingCorners(e);a.start?(console.log("endCorner.start"),u&&(e.outsideLine.endPoint=this.outsideLine.startPoint=u),o&&(e.insideLine.endPoint=this.insideLine.startPoint=o),this.hiddenStartClosedLine(),e.hiddenEndClosedLine()):a.end?(console.log("endCorner.end"),l&&(e.insideLine.endPoint=this.outsideLine.endPoint=l),r&&(e.outsideLine.endPoint=this.insideLine.endPoint=r),this.hiddenEndClosedLine(),e.hiddenEndClosedLine()):s.start?(console.log("startCorner.start"),r&&(e.outsideLine.startPoint=this.insideLine.startPoint=r),l&&(e.insideLine.startPoint=this.outsideLine.startPoint=l),e.hiddenStartClosedLine(),this.hiddenStartClosedLine()):s.end&&(console.log("startCorner.end"),u&&(e.outsideLine.startPoint=this.outsideLine.endPoint=u),o&&(e.insideLine.startPoint=this.insideLine.endPoint=o),e.hiddenStartClosedLine(),this.hiddenEndClosedLine())}})}draw(n=!0){if(this.isDraw)return;const e=A.MxCpp.getCurrentMxCAD();if(this.outsideLine&&this.outsideLine.erase(),this.insideLine&&this.insideLine.erase(),!e)return;this.outsideLine.trueColor=new A.McCmColor(255,0,0),this.outsideId=e.drawEntity(this.outsideLine),this.insideLine.trueColor=new A.McCmColor(0,255,255),this.insideId=e.drawEntity(this.insideLine);const i=this.outsideId.getMcDbEntity();i&&(this.outsideLine=i);const s=this.insideId.getMcDbEntity();s&&(this.insideLine=s),this.startClosedId=e.drawEntity(this.startClosedLine),this.endClosedId=e.drawEntity(this.endClosedLine);const a=this.startClosedId.getMcDbEntity();a&&(this.startClosedLine=a);const o=this.endClosedId.getMcDbEntity();o&&(this.endClosedLine=o),e.updateDisplay(),Es.lines.add(this),this.isDraw=!0,n&&this.processingIntersection()}remove(){this.endClosedId&&this.endClosedId.erase(),this.startClosedId&&this.startClosedId.erase(),this.insideId&&this.insideId.erase(),this.outsideId&&this.outsideId.erase(),Es.lines.delete(this)}};Qw.lines=new Set;let dk=Qw;class fk{call(n){if(n&&n.points){let e=A.MxCpp.getCurrentMxCAD();const i=ZR(n.points);if(i.length<2)return;i.forEach((s,a)=>{const o=i[a+1];if(!o)return;new dk(s,o,n.width).draw()}),e.updateDisplay()}}regist_data(){return{filename:"drawWall.json",name:"drawWall",description:"根据坐标点合集绘制墙",params:[{name:"points",description:"绘制墙的坐标点",type:"str",required:!0},{name:"width",description:"绘制墙的宽度",type:"float",required:!1},...rl]}}}class pk{call(n){return re(this,null,function*(){let e=A.MxCpp.App.getCurrentMxCAD();if(n.name){const s=e.getDatabase().getBlockTable().get(n.name);if(!s||!s.isValid())return;let a=new A.McDbBlockReference;a.blockTableRecordId=s;let o=a.getBoundingBox(),r=0;if(o.ret){let u=o.maxPt.distanceTo(o.minPt);u>1e-5&&(r=e.getMxDrawObject().screenCoordLong2Doc(100)/u,a.setScale(r))}a.position=new A.McGePoint3d(n.pos[0],n.pos[1]),e.drawEntity(a),e.updateDisplay()}})}regist_data(){return{filename:"insertBock.json",name:"insertBock",description:"放置插入某个物品",params:[{name:"name",description:"要放置插入的物品名称",type:"str",required:!0},{name:"pos",description:"要放置插入物品的位置",type:"tuple[float, float]",required:!0}]}}}function mk(){Qo.regist(fk),Qo.regist(pk)}class gk{call(n){return re(this,null,function*(){let e=A.MxCpp.getCurrentMxCAD();console.log(n),e.newFile();let i;const s=typeof n.isMText=="undefined"?!1:n.isMText,a=()=>{const r=new A.McDbMText;return r.textHeight=n.textSize||100,r.location=n.textPos||new A.McGePoint3d,r.contents=n.textString||"",r},o=()=>{const r=new A.McDbText;return r.height=n.textSize||100,r.textString=n.textString||"",r.position=n.textPos||new A.McGePoint3d,r};if(!n.textString){const r=new A.MxCADUiPrString;r.setMessage("请输入文字");const u=yield r.go();if(!u)return;n.textString=u}if(n.textPos)n.textPos=Oi(n.textPos);else{const r=new A.MxCADUiPrPoint;r.clearLastInputPoint(),r.setMessage("请指定文字位置");const u=yield r.go();if(r.setUserDraw((l,h)=>{if(n.textPos=l,s){const f=a();h.drawMcDbEntity(f)}else{const f=o();h.drawMcDbEntity(f)}}),!u)return;n.textPos=u}if(!n.textSize){const r=new A.MxCADUiPrPoint;r.clearLastInputPoint(),r.setMessage("通过线段长度确定文字高度");const u=yield r.go();if(u){r.setUserDraw((h,f)=>{if(n.textSize=u.distanceTo(h),s){const d=a();f.drawMcDbEntity(d)}else{const d=o();f.drawMcDbEntity(d)}});const l=yield r.go();l&&(n.textSize=l.distanceTo(u))}}if(s){const r=a();i=e.drawEntity(r)}else{const r=o();i=e.drawEntity(r)}il(i.getMcDbEntity(),n),e.updateDisplay()})}regist_data(){return{filename:"drawText.json",name:"draw_text",description:"绘制或者插入文字或者多行文字(文本)",params:[{name:"isMText",description:"绘制的文字是否为多行文字",type:"boolean",required:!0},{name:"textString",description:"绘制的文字的内容",type:"str",required:!0},{name:"textPos",description:"绘制的文字的位置",type:"tuple[float, float]",required:!0},{name:"textSize",description:"绘制的文字的高度",type:"float",required:!0},...rl]}}}function yk(){Qo.regist(gk)}class bk{call(n){if(console.log(n),n.isWithdraw){typeof n.withdrawNum!="number"&&(n.withdrawNum=1);for(let e=0;e<n.withdrawNum;e++)Ct.MxFun.sendStringToExecute("Mx_Undo")}if(n.isRestore){typeof n.restoreNum!="number"&&(n.restoreNum=1);for(let e=0;e<n.restoreNum;e++)Ct.MxFun.sendStringToExecute("Mx_Redo")}}regist_data(){return{filename:"call_withdraw_restore.json",name:"call_withdraw_restore",description:"撤回撤销和恢复",params:[{name:"isWithdraw",description:"是否要撤回或撤销",type:"boolean",required:!0},{name:"isRestore",description:"是否要恢复",type:"boolean",required:!0},{name:"withdrawNum",description:"撤回撤销(上)几步",type:"int",required:!1},{name:"restoreNum",description:"恢复(前)几步",type:"int",required:!1}]}}}function vk(){Qo.regist(bk)}class xk{constructor(){this.aryRegData=[]}regist(n){let e=new n,i=e.regist_data();A.MxCpp.Ai.addFunction(i.name,e.call),this.aryRegData.push(i)}regist_server(n){this.aryRegData.forEach(e=>{e.operation_code=n,A.MxCpp.Ai.registTool(e)}),A.MxCpp.Ai.reloadTools({operation_code:n})}}let Qo=new xk;function _k(){return re(this,null,function*(){let t=new A.MxCADUiPrString;t.setMessage(`
 human:`);let n=yield t.go();n&&A.MxCpp.Ai.chat_tool(n)})}function wk(){return re(this,null,function*(){let t=new A.MxCADUiPrString;t.setMessage(`
 输入 server_operate_code:`);let n=yield t.go();n&&Qo.regist_server(n)})}function Mk(){Ct.MxFun.addCommand("Mx_Ai",_k),Ct.MxFun.addCommand("Mx_AiRegistServer",wk),$R(),tk(),nk(),ok(),hk(),mk(),yk(),vk(),lk()}function Ak(t,n){let e=40,i=new A.MxCADResbuf;i.AddString("电杆层",0),i.AddString("INSERT",5020);let s=new A.MxCADSelectionSet;s.crossingSelect(t.x-e,t.y-e,t.x+e,t.y+e,i);let a=[];if(s.forEach(o=>{let r=o.getMcDbEntity();if(r){let u=r;n[u.getObjectID().id]&&a.push({dist:u.position.distanceTo(t),blk:n[u.getObjectID().id]})}}),a.length!=0)return a.sort((o,r)=>o.dist-r.dist),a[0].dist<e?a[0].blk:!1}function Sk(t,n,e){let i=n[t],s=i.ref,a=40,o=new A.MxCADResbuf;o.AddString("0",0),o.AddString("LINE",5020);let r=new A.MxCADSelectionSet;r.crossingSelect(s.position.x-a,s.position.y-a,s.position.x+a,s.position.y+a,o),r.forEach(u=>{let l=u.getMcDbEntity();if(l){let h=l,f=h.endPoint,d=h.startPoint.distanceTo(s.position);if(d>h.endPoint.distanceTo(s.position)&&(d=h.endPoint.distanceTo(s.position),f=h.startPoint),d<a&&!h[h.getObjectID().id]){let p=Ak(f,n);p&&(e[h.getObjectID().id]={tag1:i.tag,tag2:p.tag,handle:h.getHandle()})}}})}function Ek(){return re(this,null,function*(){let t=new A.MxCADSelectionSet,n=new A.MxCADResbuf;n.AddString("电杆层",0),n.AddString("INSERT",5020),t.allSelect(n);let e={};t.forEach(s=>{let a=s.getMcDbEntity();if(a){let o=a,r=o.getAllAttribute(),u={};r.forEach(l=>{let h=l.getMcDbEntity();h.tag=="杆号"&&(u.tag=h.textString)}),u.tag&&(u.handle=o.getHandle(),e[s.id]={ref:o,tag:u.tag},console.log(u))}});let i={};Object.keys(e).forEach(s=>{Sk(s,e,i)}),Object.keys(i).forEach(s=>{console.log(i[s])})})}function Tk(){Ct.MxFun.addCommand("MxTest_UserGetData",Ek)}class ol extends A.McDbCustomEntity{constructor(n){super(n),this.pt1=new A.McGePoint3d,this.pt2=new A.McGePoint3d,this._text="",this._textsize=10}create(n){return new ol(n)}getTypeName(){return"McDbLineText"}set text(n){this._text=n}get text(){return this._text}set textsize(n){this._textsize=n}get textsize(){return this._textsize}dwgInFields(n){return this.pt1=n.readPoint("pt1").val,this.pt2=n.readPoint("pt2").val,this._text=n.readString("text").val,this._textsize=n.readDouble("textsize").val,!0}dwgOutFields(n){return n.writePoint("pt1",this.pt1),n.writePoint("pt2",this.pt2),n.writeString("text",this._text),n.writeDouble("textsize",this._textsize),!0}fineLink(n){let e={},i=this.getObjectID(),s=this._textsize*.5,a=new A.MxCADResbuf;a.AddString("CUSTOMENTITY",5020);let o=new A.MxCADSelectionSet;return o.crossingSelect(n.x-s,n.y-s,n.x+s,n.y+s,a),o.forEach(r=>{if(r==i)return;let u=r.getMcDbEntity();if(u&&u instanceof ol){let l=u,h=l.getPoint1(),f=0,d=l.getPoint1().distanceTo(n);d>l.getPoint2().distanceTo(n)&&(d=l.getPoint2().distanceTo(n),h=l.getPoint2(),f=1),d<s&&(e[r.id]={link_point:h,link_pos:f})}}),e}moveGripPointsAt(n,e,i,s){this.assertWrite();let a=this.pt1.clone(),o=a;if(n==0?(this.pt1.x+=e,this.pt1.y+=i,this.pt1.z+=s,o=this.pt1):n==1&&(a=this.pt2.clone(),this.pt2.x+=e,this.pt2.y+=i,this.pt2.z+=s,o=this.pt2),this.getObjectID().isValid()){let r=this.fineLink(a);Object.keys(r).forEach(u=>{let h=new A.McObjectId(u).getMcDbEntity();r[u].link_pos==0?h.setPoint1(o):h.setPoint2(o)})}}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.pt1),n.append(this.pt2),n}worldDraw(n){let e=this._textsize*.4,i=this.pt2.sub(this.pt1);i.normalize().mult(e);let s=new A.McDbLine(this.pt1.clone().addvec(i),this.pt2.clone().subvec(i));n.drawEntity(s);let a=this.pt2.sub(this.pt1).mult(.5),o=this.pt1.clone().addvec(a);a.dotProduct(A.McGeVector3d.kXAxis)<0&&a.negate();let r=a.angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis),u=this._text;u.length==0&&(u=this.pt1.distanceTo(this.pt2).toFixed(2)),a.perpVector(),a.dotProduct(A.McGeVector3d.kYAxis)<0&&a.negate(),a.normalize().mult(this._textsize*.2);let l=new A.McDbText;l.textString=u,l.position=o.clone().addvec(a),l.alignmentPoint=o.clone().addvec(a),l.rotation=r,l.verticalMode=A.McDb.TextVertMode.kTextBottom,l.horizontalMode=A.McDb.TextHorzMode.kTextCenter,l.height=this._textsize,n.drawEntity(l);let h=new A.McDbCircle;h.center=this.pt1,h.radius=e,n.drawEntity(h);let f=new A.McDbCircle;f.center=this.pt2,f.radius=e,n.drawEntity(f)}setPoint1(n){this.assertWrite(),this.pt1=n.clone()}setPoint2(n){this.assertWrite(),this.pt2=n.clone()}getPoint1(){return this.pt1}getPoint2(){return this.pt2}}function Ck(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();t.newFile();let n=new A.McGePoint3d(100,100,0),e=new A.McGePoint3d(200,150,0),i=new A.McGePoint3d(400,50,0),s=new A.McGePoint3d(600,60,0),a=new A.McGePoint3d(200,300,0),o=5,r=new ol;r.setPoint1(n),r.setPoint2(e),r.textsize=o,r.text="xxxx",t.drawEntity(r);let u=new ol;u.setPoint1(e),u.setPoint2(i),u.textsize=o,t.drawEntity(u);let l=new ol;l.setPoint1(i),l.setPoint2(s),l.textsize=o,t.drawEntity(l);let h=new ol;h.setPoint1(e),h.setPoint2(a),h.textsize=o,t.drawEntity(h),t.zoomW(new A.McGePoint3d(-300,-300,0),new A.McGePoint3d(650,500,0)),t.updateDisplay()})}function Pk(){Ct.MxFun.addCommand("MxTest_LineText",Ck),new ol().rxInit()}function Dk(){Tk(),Pk()}class df extends A.McDbCustomEntity{create(n){throw new Error("Method not implemented.")}getTypeName(){throw new Error("Method not implemented.")}dwgInFields(n){throw new Error("Method not implemented.")}dwgOutFields(n){throw new Error("Method not implemented.")}worldDraw(n){throw new Error("Method not implemented.")}}class ff extends df{constructor(n){super(n),this.pt=new A.McGePoint3d}create(n){return new ff(n)}getTypeName(){return"McDbGisPoint"}dwgInFields(n){return this.pt=n.readPoint("pt").val,!0}dwgOutFields(n){return n.writePoint("pt",this.pt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n==0&&(this.pt.x+=e,this.pt.y+=i,this.pt.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.pt),n}worldDraw(n){n.drawEntity(new A.McDbPoint(this.pt))}setPoint(n){this.assertWrite(),this.pt=n.clone()}getPoint(){return this.pt}}class pf extends df{constructor(n){super(n),this.pts=[]}create(n){return new pf(n)}getTypeName(){return"McDbGisMultiPoint"}dwgInFields(n){return this.pts=n.readPoints("pts").val,!0}dwgOutFields(n){return n.writePoints("pts",this.pts),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n>=0&&n<this.pts.length&&(this.pts[n].x+=e,this.pts[n].y+=i,this.pts[n].z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return this.pts.forEach(e=>{n.append(e)}),n}worldDraw(n){this.pts.forEach(e=>{n.drawEntity(new A.McDbPoint(e))})}setPoint(n,e){this.assertWrite(),n>=0&&n<this.pts.length&&(this.pts[n]=e.clone())}getPoint(n){return n>=0&&n<this.pts.length?this.pts[n]:new A.McGePoint3d}addPoint(n){this.pts.push(n.clone())}removeAllPoint(){this.pts=[]}getPointCount(){return this.pts.length}}class mf extends df{constructor(n){super(n),this.pts=[]}create(n){return new mf(n)}getTypeName(){return"McDbGisLineString"}dwgInFields(n){return this.pts=n.readPoints("pts").val,!0}dwgOutFields(n){return n.writePoints("pts",this.pts),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n>=0&&n<this.pts.length&&(this.pts[n].x+=e,this.pts[n].y+=i,this.pts[n].z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return this.pts.forEach(e=>{n.append(e)}),n}worldDraw(n){let e=new A.McDbPolyline;this.pts.forEach(i=>{e.addVertexAt(i)}),n.drawEntity(e)}setPoint(n,e){this.assertWrite(),n>=0&&n<this.pts.length&&(this.pts[n]=e.clone())}getPoint(n){return n>=0&&n<this.pts.length?this.pts[n]:new A.McGePoint3d}addPoint(n){this.pts.push(n.clone())}removeAllPoint(){this.pts=[]}getPointCount(){return this.pts.length}}class gf extends df{constructor(n){super(n),this.ptss=[]}create(n){return new gf(n)}getTypeName(){return"McDbGisMultiLineString"}dwgInFields(n){this.ptss=[];let e=n.readLong("ptss_n");for(let i=0;i<e.val;i++){let s=n.readPoints("ptss_"+i);s.ret&&this.ptss.push(s.val)}return!0}dwgOutFields(n){return n.writeLong("ptss_n",this.ptss.length),this.ptss.forEach((e,i)=>{n.writePoints("ptss_"+i,e)}),!0}moveGripPointsAt(n,e,i,s){this.assertWrite();let a=0;for(let o=0;o<this.ptss.length;o++){let r=this.ptss[o];for(let u=0;u<r.length;u++){if(a==n){this.ptss[o][u].x+=e,this.ptss[o][u].y+=i,this.ptss[o][u].z+=s,o=this.ptss.length;break}a++}}}getGripPoints(){let n=new A.McGePoint3dArray;return this.ptss.forEach(e=>{e.forEach(i=>{n.append(i)})}),n}worldDraw(n){for(let e=0;e<this.ptss.length;e++){let i=this.ptss[e],s=new A.McDbPolyline;i.forEach(a=>{s.addVertexAt(a)}),n.drawEntity(s)}}addPoints(n){this.ptss.push(n)}removeAllPoint(){this.ptss=[]}getPointsCount(){return this.ptss.length}getPoints(n){return n>=0&&n<this.ptss.length?this.ptss[n]:[]}}class yf extends df{constructor(n){super(n),this.ptss=[]}create(n){return new yf(n)}getTypeName(){return"McDbGisPolygon"}dwgInFields(n){this.ptss=[];let e=n.readLong("ptss_n");for(let i=0;i<e.val;i++){let s=n.readPoints("ptss_"+i);s.ret&&this.ptss.push(s.val)}return!0}dwgOutFields(n){return n.writeLong("ptss_n",this.ptss.length),this.ptss.forEach((e,i)=>{n.writePoints("ptss_"+i,e)}),!0}moveGripPointsAt(n,e,i,s){this.assertWrite();let a=0;for(let o=0;o<this.ptss.length;o++){let r=this.ptss[o];for(let u=0;u<r.length;u++){if(a==n){this.ptss[o][u].x+=e,this.ptss[o][u].y+=i,this.ptss[o][u].z+=s,o=this.ptss.length;break}a++}}}getGripPoints(){let n=new A.McGePoint3dArray;return this.ptss.forEach(e=>{e.forEach(i=>{n.append(i)})}),n}worldDraw(n){let e=new A.McDbHatch;for(let i=0;i<this.ptss.length;i++){let s=this.ptss[i];s.length>2&&e.appendLoop(new A.McGePoint3dArray(s))}e.numLoops>0&&n.drawEntity(e)}addPoints(n){this.ptss.push(n)}removeAllPoint(){this.ptss=[]}getPointsCount(){return this.ptss.length}getPoints(n){return n>=0&&n<this.ptss.length?this.ptss[n]:[]}}function Rk(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage("点取一个点坐标");let e=yield n.go();if(e){let i=new ff;i.setPoint(e),t.drawEntity(i)}})}function kk(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage("点取一个点坐标");let e=new pf,i=[];for(;;){n.clearLastInputPoint(),n.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let s=yield n.go();if(s){e.addPoint(s);let a=new A.McDbPoint(s);i.push(t.drawEntity(a))}else break}e.getPointCount()>0&&t.drawEntity(e),i.forEach(s=>{s.erase()})})}function Ik(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage("点取一个点坐标");let e=new mf,i=[],s;for(;;){s&&(n.setBasePt(s),n.setUseBasePt(!0)),n.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let a=yield n.go();if(a){if(e.addPoint(a),s){let o=new A.McDbLine;o.startPoint=s,o.endPoint=a,i.push(t.drawEntity(o))}s=a}else break}e.getPointCount()>1&&t.drawEntity(e),i.forEach(a=>{a.erase()})})}function Lk(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage("点取一个点坐标"),n.setKeyWords("[下一段线(N)]");let e=new gf,i=[],s=[],a;for(;;){a?n.setBasePt(a):n.setUseBasePt(!1),n.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let o=yield n.go();if(n.isKeyWordPicked("N"))i.length>1&&e.addPoints(i),i=[],a=void 0;else if(o){if(i.push(o),a){let r=new A.McDbLine;r.startPoint=a,r.endPoint=o,s.push(t.drawEntity(r))}a=o}else break}i.length>1&&e.addPoints(i),e.getPointsCount()>0&&t.drawEntity(e),s.forEach(o=>{o.erase()})})}function Bk(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage("点取一个点坐标");let e=new yf,i=[],s=[],a;for(;;){a?n.setBasePt(a):n.setUseBasePt(!1),i.length>2&&n.setKeyWords("[闭合(C)/退出(E)]"),n.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let o=yield n.go();if(n.isKeyWordPicked("C")){let r=new A.McDbLine;r.startPoint=i[0],r.endPoint=i[i.length-1],s.push(t.drawEntity(r)),i.length>2&&e.addPoints(i),i=[],a=void 0}else{if(n.isKeyWordPicked("E"))break;if(o){if(i.push(o),a){let r=new A.McDbLine;r.startPoint=a,r.endPoint=o,s.push(t.drawEntity(r))}a=o}else break}}i.length>2&&e.addPoints(i),e.getPointsCount()>0&&t.drawEntity(e),s.forEach(o=>{o.erase()})})}function Fk(){let t=new A.MxCADSelectionSet,n=new A.MxCADResbuf;n.AddMcDbEntityTypes("McDbCustomEntity"),t.allSelect(n);let e={type:"FeatureCollection",features:[]};t.forEach(i=>{let s=i.getMcDbEntity();if(s){if(s instanceof ff){let o=s.getPoint(),r={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[o.x,o.y,o.z]}};e.features.push(r)}else if(s instanceof pf){let a=s,o=[],r=a.getPointCount();for(let l=0;l<r;l++){let h=a.getPoint(l);o.push([h.x,h.y,h.z])}let u={type:"Feature",properties:{},geometry:{type:"MultiPoint",coordinates:o}};e.features.push(u)}else if(s instanceof mf){let a=s,o=[],r=a.getPointCount();for(let l=0;l<r;l++){let h=a.getPoint(l);o.push([h.x,h.y,h.z])}let u={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:o}};e.features.push(u)}else if(s instanceof gf){let a=s,o=[],r=a.getPointsCount();for(let l=0;l<r;l++){let h=a.getPoints(l),f=[];for(let d=0;d<h.length;d++){let p=h[d];f.push([p.x,p.y,p.z])}o.push(f)}let u={type:"Feature",properties:{},geometry:{type:"MultiLineString",coordinates:o}};e.features.push(u)}else if(s instanceof yf){let a=s,o=[],r=a.getPointsCount();for(let l=0;l<r;l++){let h=a.getPoints(l),f=[];for(let d=0;d<h.length;d++){let p=h[d];f.push([p.x,p.y,p.z])}o.push(f)}let u={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:o}};e.features.push(u)}}}),console.log(JSON.stringify(e))}function Nk(){Ct.MxFun.addCommand("MxGis_DrawPoint",Rk),Ct.MxFun.addCommand("MxGis_DrawMultiPoint",kk),Ct.MxFun.addCommand("MxGis_DrawLineString",Ik),Ct.MxFun.addCommand("MxGis_DrawMultiLineString",Lk),Ct.MxFun.addCommand("MxGis_DrawPolygon",Bk),Ct.MxFun.addCommand("MxGis_Get_geojson",Fk),new ff().rxInit(),new pf().rxInit(),new mf().rxInit(),new gf().rxInit(),new yf().rxInit()}const fs=k.ref("");k.reactive([]);const sl=k.ref(300),Ok=k.reactive(["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAJdJREFUSEvdlsESwBAMRMX/f7N2HJhOJVmh0ZYr9nlUiojoCAsbbQdMKYUYY91DV8M7LFP3AXJ2boYSbA+gZudiuBSIYI8a9sD+C+y1awzzxNF2rZdaRlPaLKvNwdbx7wMtq7baqV8pCkP90jmKvycUiPrNQG1rR2Hw4kvBbkDOcgYGDcs5FMgs7LtAy91EpdH11cbBlwNPJSqCVTTcHlQAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAALNJREFUSEvdlksOgCAMBS33PzOaLjCkPvoBIYpLhE6m0AIR0Xks/Gg7YM75SCndOZxqKGFM3QeI7KYZtmB7ADW7KYZLgRbsVUMP7L9Ar93DEC3kMfnVvZH/dQPl4lagejwCg3tYAliBvPNkdmDzLmmUqasXe+age715W3gNo4+F7wC102fZa9bqBYxKogTT9rcbiCxH7NytrbcEQqdUlgCncNTObRhtX0N7GK0za/7UZyKCX603kVXE3zhDAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAJdJREFUSEvd1kEOgCAMBEDK/99cDQeMEcqyYlHxiu24KIKIyBYmXrIcqKohxnjMoWvCK5bUdcBaOreEFrYG2ErnknAqiLBHE/Zg/wV70xUJmcLzBsPUFb82pjih7P3vg8xTs+maXylqhsatQ4S5PaGGaJwGW1N7F4ML32rsBtZSjmAwYX4PGRnFvgsyaxOdqV1PbTV8OrgD32GFVQtEr98AAAAASUVORK5CYII="]),Pb=()=>{const t=A.MxCpp.getCurrentMxCAD(),{pt1:n,pt3:e}=t.getViewCADCoord(),i=e.sub(n).normalize(),s=e.clone().addvec(i.clone().mult(1e3)),a=e.clone().addvec(i.clone().mult(2e3)),o=s.clone().addvec(a.sub(s).mult(.5));let r=new A.McDbWipeout;r.setVertices(new A.McGePoint3dArray([s,new A.McGePoint3d(s.x,a.y),a,new A.McGePoint3d(a.x,s.y)])),r=t.drawEntity(r).getMcDbObject();let l=A.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder().maxDrawOrder+1;return r.drawOrder=l,{wipeout:r,midPt:o}},ps=k.ref(),Ho=MxPluginContext.useDialogIsShow();var Cr=(t=>(t.Straightness="u",t.Flatness="c",t.Roundness="e",t.Cylindricity="g",t.LineContourdegree="k",t.SurfaceContourDegree="d",t.Parallelism="f",t.Perpendicularity="b",t.TiltDegree="a",t.PositionalDegree="j",t.Coaxiality="r",t.SymmetryDegree="i",t.CircleJumping="h",t.FullBeat="t",t.None="",t))(Cr||{});class bf extends A.McDbCustomEntity{constructor(n){super(n),this.startPoint=new A.McGePoint3d,this.turningPoint=new A.McGePoint3d,this.dimPoint=new A.McGePoint3d,this.endPoint=new A.McGePoint3d,this.size=4,this.isShowFull=!1,this.toleranceContents=[],this.notesUp="",this.notesDown="",this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new bf(n)}getTypeName(){return"MxDbGeometricTolerances"}set dimSize(n){this.size=n}get dimSize(){return this.size}set isShowFullWeekSymbol(n){this.isShowFull=n}get isShowFullWeekSymbol(){return this.isShowFull}set dimToleranceContents(n){this.toleranceContents=n}get dimToleranceContents(){return this.toleranceContents}set dimNotesUp(n){this.notesUp=n}get dimNotesUp(){return this.notesUp}set dimNotesDown(n){this.notesDown=n}get dimNotesDown(){return this.notesDown}dwgInFields(n){return this.startPoint=n.readPoint("startPoint").val,this.turningPoint=n.readPoint("turningPoint").val,this.dimPoint=n.readPoint("dimPoint").val,this.endPoint=n.readPoint("endPoint").val,this.size=n.readDouble("size").val,this.isShowFull=!!n.readLong("isShowFull").val,this.notesUp=n.readString("notesUp").val,this.notesDown=n.readString("notesDown").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,this.toleranceContents=JSON.parse(n.readString("toleranceContents").val),!0}dwgOutFields(n){return n.writePoint("startPoint",this.startPoint),n.writePoint("turningPoint",this.turningPoint),n.writePoint("dimPoint",this.dimPoint),n.writePoint("endPoint",this.endPoint),n.writeDouble("size",this.size),n.writeLong("isShowFull",this.isShowFull?1:0),n.writeString("notesUp",this.notesUp),n.writeString("notesDown",this.notesDown),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),n.writeString("toleranceContents",JSON.stringify(this.toleranceContents)),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.startPoint.x+=e,this.startPoint.y+=i,this.startPoint.z+=s):n===1?(this.turningPoint.x+=e,this.turningPoint.y+=i,this.turningPoint.z+=s):n===2?(this.dimPoint.x+=e,this.dimPoint.y+=i,this.dimPoint.z+=s,this.endPoint.x+=e,this.endPoint.y+=i,this.endPoint.z+=s):n===3&&(this.endPoint.x+=e,this.endPoint.y+=i,this.endPoint.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.startPoint),n.append(this.turningPoint),n.append(this.dimPoint),n.append(this.endPoint),n}drawArrow(){const n=this.startPoint,e=this.turningPoint,i=this.size,s=e.sub(n).normalize().mult(i),a=n.clone().addvec(s),o=s.clone().rotateBy(Math.PI/2).normalize().mult(i/8),r=a.clone().addvec(o),u=a.clone().subvec(o),l=new A.McDbHatch;l.appendLoop(new A.McGePoint3dArray([n,r,u]));const h=[this.startPoint,this.turningPoint,this.dimPoint,this.endPoint],f=new A.McDbPolyline;return h.forEach(d=>f.addVertexAt(d)),[l,f]}worldDraw(n){const e=A.MxCpp.getCurrentMxCAD();["cxgdtshp","cxgdt"].forEach(o=>{e.getDatabase().getTextStyleTable().has(o)||A.MxCpp.App.loadFonts([`${o}.shx`],[],[`${o}.shx`],()=>{e.addTextStyle(o,`${o}.shx`,`${o}.shx`)})});const{MText:s,allEntityArr:a}=this.getAllEnitty();s.forEach(o=>{o.worldDraw(n)}),a.forEach(o=>{n.drawEntity(o)})}getAllEnitty(){const n=[],e=this.drawArrow();n.push(...e);const i=["k","d"];if(this.toleranceContents.length===1&&i.includes(this.toleranceContents[0].toleranceCode)&&this.isShowFull){const v=new A.McDbCircle(this.dimPoint.x,this.dimPoint.y,0,this.size*.4375);n.push(v)}const s=this.size*(7/4),a=A.McGeVector3d.kYAxis.clone().mult(s*(this.toleranceContents.length/2)),o=this.endPoint.clone().addvec(a),r=this.endPoint.clone().addvec(a.clone().negate());n.push(...this.drawCode(o.clone(),r.clone(),s));const u=A.McGeVector3d.kXAxis.clone().mult(s),{MText:l,entityArr:h,max_x:f}=this.drawToleranceContents(o.clone().addvec(u),r.clone().addvec(u),s);n.push(...h);const{MText:d,entityArr:p}=this.drawBenchmark(new A.McGePoint3d(f,o.y),new A.McGePoint3d(f,r.y),s);return n.push(...p),l.push(...d),[this.notesUp,this.notesDown].forEach((v,x)=>{const w=new A.McDbMText;w.contents=v,w.textHeight=this.size*(3/4),w.location=x==0?o.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size)):r.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate()),n.push(w)}),{allEntityArr:n,MText:l}}drawCode(n,e,i){const s=[],a=new A.McDbPolyline;a.isClosed=!0;const o=A.McGeVector3d.kXAxis.clone().mult(i);[e,n,n.clone().addvec(o),e.clone().addvec(o)].forEach(d=>a.addVertexAt(d)),s.push(a);const u=d=>{const p=[];let b=0;for(;b<d.length;){let v=b+1;for(;v<d.length&&d[v]===d[b];)v++;p.push({value:d[b],count:v-b}),b=v}return p},l=this.toleranceContents.map(d=>d.toleranceCode),h=u(l),f=A.McGeVector3d.kXAxis.clone().mult(i);return h.forEach(d=>{const p=new A.McDbMText;p.textHeight=this.size*(3/4),p.contents=d.value,p.attachment=A.McDb.AttachmentPoint.kBottomMid;const b=e.sub(n).normalize().mult(i*d.count),v=n.clone().addvec(b.clone().mult(1/2)).addvec(f.clone().mult(1/2));p.location=v,p.textStyle="cxgdt",n.addvec(b),s.push(p),p.reCompute();const{maxPt:x,minPt:w}=A.MxCADUtility.getTextEntityBox(p,!1);w.distanceTo(x)>p.textHeight*3&&x.addvec(A.McGeVector3d.kXAxis.clone().negate().mult(p.textHeight*(7/4)));const M=w.clone().addvec(x.sub(w).mult(1/2));p.move(M,v);const E=new A.McDbLine(n,n.clone().addvec(f));s.push(E)}),s}drawToleranceContents(n,e,i){const s=[],a=[],o=A.MxCpp.getCurrentMxCAD();let r=n.x;const u=A.McGeVector3d.kXAxis.clone().mult(this.size/4),l=A.McGeVector3d.kYAxis.clone().mult(i).negate();return this.toleranceContents.forEach((h,f)=>{const d=n.clone(),p=e.clone();if(h.tolerance.length){d.addvec(u).addvec(l.clone().mult(f));const b=A.McGeVector3d.kYAxis.clone().mult(i/2-this.size*(3/8)).negate();h.tolerance.forEach((v,x)=>{if(x===4||x===3&&(v==="{"||v==="@")){const w=new A.MxCADMText;w.data=[{type:"paragraph",children:[{text:v,font:"cxgdtshp.shx"}]}],w.position=d.clone().addvec(b),w.textBaseHeight=this.size*(3/4),a.push(w);const M=A.McGeVector3d.kXAxis.clone().mult(this.size),E=w.position.clone().addvec(M);d.x=p.x=E.x}else{const w=new A.McDbMText;w.contents=v,w.location=d.clone().addvec(b),w.textHeight=this.size*(3/4),x==2||x==4?w.textStyle="cxgdtshp":x==3&&v!=="{"?w.textStyle="cxgdt":w.textStyleId=o.getDatabase().getCurrentlyTextStyleId(),w.reCompute();const{maxPt:M,minPt:E}=A.MxCADUtility.getTextEntityBox(w,!1);d.x=p.x=M.x,s.push(w)}})}d.x>r&&(r=d.x)}),r>n.x&&(this.toleranceContents.forEach((h,f)=>{const d=new A.McDbPolyline,p=new A.McGePoint3d(r,n.y),b=new A.McGePoint3d(r,e.y);if([n,p.clone().addvec(u),b.clone().addvec(u)].forEach(x=>d.addVertexAt(x)),s.push(d),n.addvec(l),f===this.toleranceContents.length-1){const x=new A.McDbLine(b.clone().addvec(u),e);s.push(x)}}),r=new A.McGePoint3d(r,n.y).addvec(u).x),{entityArr:s,MText:a,max_x:r}}drawBenchmark(n,e,i){const s=A.MxCpp.getCurrentMxCAD(),a=A.McGeVector3d.kYAxis.clone().mult(i/2-this.size*(3/8)).negate(),o=A.McGeVector3d.kYAxis.clone().mult(i).negate(),r=A.McGeVector3d.kXAxis.clone().mult(this.size/4);let u=n.x;const l=[],h=[],f=(x,w)=>{const M=[];let E=w.clone();return w.addvec(r),x.length===2&&x.filter(D=>D.length!=0).length===2&&x.splice(1,0,["-"]),x.forEach((D,N)=>{D.length&&D.forEach((V,K)=>{if(K===1&&V==="{"){const j=new A.MxCADMText;j.data=[{type:"paragraph",children:[{text:V,font:"cxgdtshp.shx"}]}],j.position=w.clone().addvec(a),j.textBaseHeight=this.size*(3/4),h.push(j);const Z=A.McGeVector3d.kXAxis.clone().mult(this.size),tt=j.position.clone().addvec(Z);w.x=E.x=tt.x}else{const j=new A.McDbMText;j.contents=V,j.location=w.clone().addvec(a),j.textHeight=this.size*(3/4),K==1?j.textStyle="CXGDT":j.textStyleId=s.getDatabase().getCurrentlyTextStyleId(),j.reCompute();const{maxPt:Z,minPt:tt}=A.MxCADUtility.getTextEntityBox(j,!1);u<Z.x&&(u=Z.x),E.x=Z.x,M.push(j),w.x=Z.x}})}),u<E.x&&(u=E.x),M},d=[],p=[],b=["b1","b2","b3"];let v=n.x;if(b.forEach((x,w)=>{w!=0&&l.length&&(v=Math.max(...l),p.push(v)),l.length=0,this.toleranceContents.forEach((M,E)=>{var D;if((D=M.Benchmark[x])!=null&&D.length&&M.Benchmark[x].filter(N=>N.length).length>0){const N=new A.McGePoint3d(v,n.clone().addvec(o.clone().mult(E)).y);d.push(...f(M.Benchmark[x],N));const V=new A.McGePoint3d(u,n.y);V.addvec(r),u=V.x,l.push(u)}})}),d.length>0){p.forEach(M=>{const E=new A.McDbLine(new A.McGePoint3d(M,n.y),new A.McGePoint3d(M,e.y));d.push(E)});const x=new A.McDbLine(new A.McGePoint3d(u,n.y),new A.McGePoint3d(u,e.y)),w=new A.McDbLine(e,new A.McGePoint3d(u,e.y));d.push(x,w),this.toleranceContents.forEach((M,E)=>{E!=0&&n.addvec(o.clone());const D=new A.McDbLine(n,new A.McGePoint3d(u,n.y));d.push(D)})}return{entityArr:d,MText:h}}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbMText){const h=e.getDatabase().getCurrentlyTextStyleId();o.textStyleId=h,o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setStartPoint(n){this.startPoint=this.turningPoint=this.endPoint=this.dimPoint=n.clone()}getStartPoint(){return this.startPoint}setTurningPoint(n){this.turningPoint=this.endPoint=this.dimPoint=n.clone()}getTurningPoint(){return this.turningPoint}setEndPoint(n){this.endPoint=n.clone()}getEndPoint(){return this.endPoint}getDimPoint(){return this.dimPoint}setDimPoint(n){this.dimPoint=this.endPoint=n.clone()}getBoundingBox(){const{allEntityArr:n}=this.getAllEnitty();return this.getBox(n),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function zk(){return re(this,null,function*(){fs.value="GemoetricToleranceDialog",Ho.showDialog(!0,{title:dt("形位公差")}).then(e=>re(this,[e],function*({data:t,isCanceled:n}){if(!n){const i=t.formData,s=new bf;s.dimToleranceContents=(i==null?void 0:i.dimToleranceContents)||[],s.isShowFullWeekSymbol=(i==null?void 0:i.isShowFull)||!1,s.dimNotesDown=(i==null?void 0:i.downDim)||"",s.dimNotesUp=(i==null?void 0:i.topDim)||"";const a=new A.MxCADUiPrPoint;a.setMessage("请设置定位点或直线或圆弧或圆");const o=yield a.go();if(!o)return;s.setStartPoint(o);const r=new A.MxCADUiPrPoint;r.setMessage("请设置转折点"),r.setUserDraw((d,p)=>{const b=s.clone();b.setTurningPoint(d),p.drawMcDbEntity(b)});const u=yield r.go();if(!u)return;s.setTurningPoint(u);const l=new A.MxCADUiPrPoint;l.setMessage("拖动确定标注位置"),l.setUserDraw((d,p)=>{const b=s.clone();b.setDimPoint(d),p.drawMcDbEntity(b)});const h=yield l.go();if(h){s.setDimPoint(h);const d=new A.MxCADUiPrPoint;d.setMessage("拖动确定标注位置"),d.setUserDraw((b,v)=>{const x=s.clone();x.setEndPoint(b),v.drawMcDbEntity(x)});const p=yield d.go();p&&s.setEndPoint(p)}A.MxCpp.getCurrentMxCAD().drawEntity(s)}}))})}function Uk(){new bf().rxInit(),Ct.MxFun.addCommand("Mx_Test_DrawGT",zk)}const Vk={class:"fcc"},jk={style:{"margin-bottom":"10px"},class:"fcc"},Gk=k.defineComponent({__name:"RotateDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=k.reactive({direct:xf.right,lText:"",bText:"",rText:""}),i=k.ref();let s=null;k.onMounted(()=>{sl.value=300,a()});const a=()=>re(this,null,function*(){let l;s?l=s.getMcDbEntity():l=new Tg,l.visible=!0,l.RotateDirect=e.direct,l.leftTextStr=e.lText,l.bottomTextStr=e.bText,l.rightTextStr=e.rText;const h=A.MxCpp.getCurrentMxCAD(),{pt1:f,pt3:d}=h.getViewCADCoord(),p=d.sub(f).normalize(),b=d.clone().addvec(p.clone().mult(1e3)),v=d.clone().addvec(p.clone().mult(2e3)),x=b.clone().addvec(v.sub(b).mult(.5));l.setRotatePos(x);let w=new A.McDbWipeout;w.setVertices(new A.McGePoint3dArray([b,new A.McGePoint3d(b.x,v.y),v,new A.McGePoint3d(v.x,b.y)])),w=h.drawEntity(w).getMcDbObject();let M=A.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder(),E=M.maxDrawOrder+1;w.drawOrder=E,s||(s=h.drawEntity(l),l=s.getMcDbEntity(),n("receiveParameters",{dimHandle:l.getHandle()})),l.drawOrder=M.maxDrawOrder+2;const D=l.getBoundingBox(),N=D.minPt.sub(D.maxPt).normalize().mult(5),V=D.minPt.clone().addvec(N),K=D.maxPt.clone().addvec(N.clone().negate()),j=yield cf({type:"image/bmp",width:200,height:80,range_pt1:V.toVector3(),range_pt2:K.toVector3()});i.value.src=j,w.erase(),l.visible=!1,h.mxdraw.updateCanvasSize()}),o=()=>{e.direct=e.direct===xf.right?xf.left:xf.right,a()},r=u(()=>{a()},300);function u(l,h){let f=null;return function(...d){f&&clearTimeout(f),f=setTimeout(()=>{l.apply(this,d)},h)}}return(l,h)=>(k.openBlock(),k.createElementBlock("div",null,[k.createElementVNode("div",Vk,[k.createElementVNode("img",{ref_key:"img",ref:i,style:{margin:"10px 0px",width:"90%"}},null,512)]),k.createElementVNode("div",jk,[k.createVNode(k.unref(wn.VBtn),{onClick:o},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(k.unref(dt)("改变方向")),1)]),_:1})]),k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.lText,"onUpdate:modelValue":h[0]||(h[0]=f=>e.lText=f),onInput:k.unref(r)},{prepend:k.withCtx(()=>[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("左边文字内容：")),1)]),_:1},8,["modelValue","onInput"]),k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.rText,"onUpdate:modelValue":h[1]||(h[1]=f=>e.rText=f),onInput:k.unref(r)},{prepend:k.withCtx(()=>[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("右边文字内容：")),1)]),_:1},8,["modelValue","onInput"]),k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.bText,"onUpdate:modelValue":h[2]||(h[2]=f=>e.bText=f),onInput:k.unref(r)},{prepend:k.withCtx(()=>[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("底部文字内容：")),1)]),_:1},8,["modelValue","onInput"])]))}}),pV="",Hk=ss(Gk,[["__scopeId","data-v-a83034f6"],["__file","RotateDialog.vue"]]),Wk={style:{"padding-top":"10px"}},qk=["onClick"],Xk=["src"],Yk=k.defineComponent({__name:"RoundMarkDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=k.reactive([["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAP1JREFUWEftl9EKxCAMBI3//816pGAJou7Gk9I74ksfWnWcqElFRGp6SZOAmUTiiJlSa8oiXwc7YGYK/8NMKeVeYL9bJOet/eM20yCymbAaMEvhhaJhRhBt4hlMe89CUTAKYk30MUAw+j0D9FswyIqumjHD2IFmXgPDgHjMIDtLMwFjj6pmYG8TR5/aZXeb7Y+EiS0hUNgDZruEQGp1YCZMzDhHLr3HYK6Vg0SJYFD/O7szvyposEdhmh19jkqJGcyqBhptYrhn+k6jCXoYL4QrTKNV2Bo46a1qbuFVIba63d1mhmDxEzdxjE4Tm3iPhImdDH0XMNuJEqk9+f4D+0DNahN82WgAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAQZJREFUWEftl20PgyAMhC3//zfTpURMJeAd+BJn8MuMbuXZtVyLiIguL7lkwjQycYkyUXUJIqeTPWFaEn5DGY1x9we9P4QQhuqnW5kSIq8qDiCuoL1QNEwLogaTn/VCUTAIxBb3ypQ5MihGpf+CYVRByth7Rh2ozGtgWBBGGUadQ2UmjN+K1oE373D3yFJ1sGv7bn+YJmYHpFogRwgUb8IMjxBIWjZNTBxoekwQpmaYOBCGMSsEw4Ak42SOKijYozBZHfusjQItmFvmmZ0pVqa4EqYXYjNZJk21rZgXTO/MfZ1bM4NULSZVM6gVoJpBvz+tTNnP5omSlXzke5fUzMjCtxXwJ2F+HwPOahopb8wAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPtJREFUWEftl+EOwyAIhIvv/8yy0MSVNMqdrmtcZ381qeLHAUJFRHSb5JEF04jEJcpk1S2JfBzsBdOS8BnK5JwPBy1f9LghUkpD+dOtTIHwB54TuLaGoaNhogNa1dQLRcGY0Uh6VNpof1Htt2AYr5Ay5jljByrDGLkFhgHZvSbbAbIXKoM2l8T7Dxjz8l1q7h1dWjrYtX23D8Ok/soHNEK0ABT2BTM8QrChQmFCITJAeOlNBWPEDFCkDKMKpcx0MAxQTZmvzDM++1sh8zC9EF3zTK0Uz1D+H/m2GbgGxjZK1FJgaSMDPSMEsvU8GOQx+/0SZdjD0LoF01LoBeJUzmrUUEc9AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAP5JREFUWEftl8EOhCAMRC3//810UxMiS6AzVWJcFy8ehPI6bWkVEdHtIY8smEEkpiiTVbckcjnYC2Yk4TuUyTkfDlq+6HFDpJRO5U9YmQJRH9gmcG8NQ0fDeAeMqikKRcGYUU96VNpof1Htt2AYr5Ay5jljByrDGLkFhgHZvSbbAbLnKoM2l8T7DxjzMvpIYI823b3u9lPCpHVrAJ6I0yoWzOkRgqkoNkxeiAxwyqV3GwxzlTMwSBVKmcfBFCB790YJpAyjCq1Mnf29gWkEw0KE5pleKdYzcPvHFIW4DPOlFtm1UZuBpY0MREYIZOt9MMhj9vsUZdjD0LoFM1LoA8NFzWpEnyLbAAAAAElFTkSuQmCC"],["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPNJREFUWEftl9EOxCAIBIv//816sYmGGGFXzwfvQp+atLXjgIgiIuW55JKAMSJxxEwu5UkiXwc7YCyF/2Em59wnOGaLpLSVP8tmGkRSPywKTFOsQtEwM4j2YwumPWehKJgKok2MMUAw9X0G6LdgkJU6a8YMYweauQaGAVkxg+y4ZgJGL9W6A/f6oO63SurkozLs7nq3d8PErhKUC40JhT1gtlsINlSo3KMQvaFGDflVMGxR88wwVigz18EwQDMzXg80S2KYM2zvomFWIXqRRQlsLcMxsfUZ2WvEvEq+bGY2WBziLMVXmTm1ox/JmYA5ZcAa5wMuAbFqpB3bfgAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPdJREFUWEftl9EOgyAMAC3//82w1IwFG6AH44Et+KJRlPOKbRURSdcmmxyYRiSWmIkpXUHk62AfmJbC/zCTYny8YJkfQghT62fYjIXIs0oBEN+go1AYpgVRg8nnRqEQjAeik5dmbIwUilj6LRhixTOj14kd18w2MBSEmCF2umYOTPkpagX+5I7ieCqlVm5KprqX1b4bJvIF6HyrwnlgplsIEioapl7JuNOD15BvBUOSFTHjWUFmtoPJQLqvtQKeGWIFm3kkxUoXR7o/kjTdBdx6SO7i7jcyg6gJ++xpGFtCzk9cLWxb/d6SxUnGLFkzZCIy5sC0LL0AMqaxakmqNb4AAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAASVJREFUWEftltEOwjAIRaX//82tYRkbmS0XLJpqthcf1O709FIgImqPRR66YQYnkWKmtvYoRNOHfcOMFP6HmVrruUHOSztvCE4PlRLOUNiMQBT1smuA2w4aBXLD9CBk6xpGQLQWL5QLhkG0iat/BMO/9wClwvSsCHgKDLLCLxMzFozHDjSTCYOATBgPiJghVdq9muZjQut9HEZn5Ssw16yMwhqG4TBGHzmi9kbn1t0+7Zg8I0TYjLaC/ty7gS2raL3fMbOVLWgF+tKbsbLdQWggXwrGYwfNwJ4NucwsByNA/NkbJUZmrBmo2zJQZl5ml32Ksya9KMQxZkRhjrvFmIGtQcyqOFhNntaAAuxZwx1gtNgNgwzNfp+SmVmI6WrKAtDrLGXmCfqx7mrfNgvzAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAASBJREFUWEftl+sOgyAMhS3v/8ywVO3WEWpPhaAm8sfEVfh6eqEjIirLTRa9MEYkhiiTS1kSUXewXxhLwucrU3Je/voB50v5vUkpncqfsDIMwovUgXUC590mCgXDCIR2WYCsaopCQTAtEK2OV9oMhajUBSNA02AsVSRcHCoPhm0RdQ6V8UBQZYbAiDceVCGCrgNPnUNl6o8tqEtgdFnXYLrvWB0vrAwnY2TRbs/qnFn6tg+FyfQYHCHCyugDvY/FFiltpKKeowzizWoDhAlR2b0OkE2mwSDqeDCIQ2s3R/6qeJtNhRF1+NkaBabOM3W511DTJ7264ckUt82gF83ArS7s5Qx6TUAJ7G32wngK9f4+JEy9EN95Gml6ow7z9rmVMh/YSO1q8b/D3AAAAABJRU5ErkJggg=="],["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAQRJREFUWEftllkOwyAMRDH3PzNUjoJCUcwMS+kG32Cex6uISHQfcmTDGJGYokyI0XmR4WBvGEvC31AmhHA5qPkSrw7hve/Kn2ZlEkT+YZnAd3cYOhqm9oFVTa1QFIwarUmPShu9T6p9FwzjFVJGPWfsQGUYI0tgGJDDa3IcIHtVZdDjlHj/AaNethw578fOqZ1P++4wxXwcOOeEGAEo7E0wJUBSUFVh9pkpMBbEUhgEoTAaHqaakCqHLbSQI6ClMEpcA2JgGFUoZWowqYJQmKbCWEAI5iX7TN4EU8jyvrJ80yuBnvr0u3bgu1GBcoYdL7C0GUMbhlFp5M6UMI0A5G83jKXkA1FY7WrummwAAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAARlJREFUWEftl8ESwyAIRMX//2btkCmNkxF3tUzapsklhyg+FgQiIlLTlzxywziRCFGm1JqyyNvBvmE8Ca+hTClld1Dzpe4VIue8lD/TyhhEe+AxgXtrGDoaZnSAd5tmoSgYNTqSHl1ttN9U+y0YxiukjHrO2IHKMEZOgWFANq/JdoDsDZVBmy3x/gNGvZx95LmnLnTuttuHhKm2rSGlJE47QGEPgVE1TZ2jqi3Yx2Fe1TVnWGtC68wxXL3c80Koa0+FGYFQMEwptzozUgaBhMOoQQ8oDMbU0XdvlGgrcA+GAaGVaRORmfQMiIWYmmd6t2I0A+sf1CzIkjJdMLJrozYDrzYyMDNCIFvXg0Ees99DlGEPQ+tuGE+hB/YM7mqvcQMKAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAS5JREFUWEftltEOgyAMRS3//82w1KyzI9DbSmfMoq8qHA6XUiKitt3koQdmshMpZmprWyFa3uwHZqbwP8zUWo8Fcl7aUSE4PVRKOENhMwJR1GR9gNsbNArkhhlByNI1jIBoLV4oFwyDaBO9fwTD33uAUmFGVgQ8BQZZ4cnEjAXjsQPNZMIgIBPGAyJmSB3t0ZnmbULj/RxGZ+USmD4rs7CGYTiMkUdvTztxc+vb/vQ2eW3ohYXNWD/Pji4b8fQzKTCoflwCgyCkbng6PWRlHws15Ahorx+OtjMFhonRnYNgPCAuMxaM1JNLYWZACMbqgYZXBspM/9Ooi+vNRCE+bUYURix91emuB7YaMau6w9PkuRpQZjxjuAOMBntgkKHV9ymZWYVYOk1Zk/fj3MrMC5xn8Wqmr+N5AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAT1JREFUWEftl+0KwyAMRRvf/5l1pCwsDcZ7raXboP4ZFD+OJyY6EZG2/UiTByaJxCVmamtbEVkO9gOTKfx/M63W7VAP9Ly0z5dSyqnzM21GQbSJWzAe4PruMwtFwxiE37IBZdk0C0XB9EC8HZTaCsVYWoIxoNtgMisWLg0VgtG+jJ2hGQTCmrkExnaDoJoIdR0gO0MzcXAG9RUYn9YRzNedrOJNm9HDONPE9VdDs83f9lNhyhZiLU2b8QuiwdZXbXpDvSrNZNQlZkYwh3oEKjGswIwdK3qoBMQLNob9VhiUcRCGiTVjBoHs1pi/KihU/m5CN/wo9SkYs6O/vacAgmGs0GZiukeoeGv3XoNMMaTNxMnsFbd/D29grcOsjUNNYs4M2hXznkFznApTb9IHhlG90uf0AV5ZNBv7wGRmXh7B8Wq6WAC6AAAAAElFTkSuQmCC"],["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPFJREFUWEftl+EKhTAIhefe/5ndZcFiDM2jjaiL/Sko7dvRHYuIqJWXHJQwSiW2KMOtlUp0u9gJo0n4H8o0ZrVHqNZQ/7iVuYJYCbxQMIwHIgoFwdwBGWCISt+C2aEKqo6pzGtgdoIg6lwqkzCzL/QJfEo6XYcsVQhqy3Sfp/1lmZi5VMDa0U8IK1/ChD8hLGl7YqRMSB7T9JAkj8EcKzca2YKx4s/di/yqWMkehRnq9LO01TWYvggtRmpis2fWIOkFK4wXwlUmaRXjhce97qqTWyNGuUUZESx/4hTrtHYTOmTdDYwmjjyXMOFBGZE7GvMDi6qyam6O39AAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAANlJREFUWEftl9EOgzAIRaX//83FsKwLNkVuO5cwxSdjjT09tIBERLwFuShhjEhcYqYyb4Xo62AnjKXwHma41sMCdX4opSztn2kzPUSblRRAfYPOQsEwFsQIpj2bhYJgPBCZXJvpYyRQiKX/gkGseGZkHLHjmgkDg4IgZhA7p2YSRh9FqcCf3KHuvZTKi1VbV/sM01LVDrWBZQUo0Fk5QI71Kz14DXkoGNTO8wpl2/leuEZmftLP6KMYotPrc0OIHniUsPInzkrjocx4FR0ddzMw+qEr3ksYy+IOAd2yaqrSqYMAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPRJREFUWEftlusOgzAIhaXv/8xlYUknMZZzsM3iXP1lItKPw60iIrrd5JEF08nEFGWq6lZEhpO9YHoSPkOZWuseoNWL7hOilHKpftLKNAh/4LGAz2wYOhomOqDXTVkoCsacRtKj1kb/N9V+C4aJCiljkTN+oDKMk6/AMCDvqMl1gPyFyqCfW+H9B4xF+Wk1984MLcZGD9vdb/swTepHPnMSYSPBqlgwl68QM1MVpcgA4dC7FYwRzwBCqlDK3A5mFIhRhVbGV38mZSxE6j5z1ooRVBZiGMYDsosSDWjY2shB5gqBfD0PBkXMfp+iDHsYslswPYVeEmqyaphsodgAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAANhJREFUWEftl9EOgCAIRcP//2ZptNmY07hYD1T01Jbp8aCgRES8BXkoYSaReMRMZd4K0e1gJ8xM4TfM1FrPCfarhUpZWj9uMw2iqAFZgWkKLxQMM4JoA89g2ncUCoIREG2ij4EFI+0RoHfBWFZk1ogZxI5pJgwMAuIxY9m5NJMweqtKBfY+5PiHu+quq32Gaalqh1rAMgME6H9Jr8XWsoOY+V6h1HbkfXSUsMwgVo5S4b3EhTjp9bkhxBl4lLDyEjdL46HMeKv8Um16ahC0H/fWRjteaRcKZgc3GrBqJCUxzAAAAABJRU5ErkJggg=="]]),i=k.ref(""),s=[[1,1,Math.PI/2],[2,1,Math.PI/2],[3,1,Math.PI/2],[4,1,Math.PI/2],[1,2,Math.PI/2],[2,2,Math.PI/2],[1,1,Math.PI/4],[2,1,Math.PI/4],[3,1,Math.PI/4],[4,1,Math.PI/4],[1,2,Math.PI/4],[2,2,Math.PI/4],[1,1,Math.PI],[2,1,Math.PI],[3,1,Math.PI],[4,1,Math.PI]],a=(o,r)=>{const u=s[o*4+r];i.value=`${o}${r}`,n("receiveParameters",{param:u})};return k.onMounted(()=>{sl.value=250}),(o,r)=>(k.openBlock(),k.createElementBlock("div",Wk,[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(e,(u,l)=>(k.openBlock(),k.createElementBlock("div",{class:"row",key:l},[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(u,(h,f)=>(k.openBlock(),k.createElementBlock("div",{class:k.normalizeClass(i.value===`${l}${f}`?"item backColor":"item"),key:f,onClick:d=>a(l,f)},[k.createElementVNode("img",{src:h,style:{margin:"0",height:"35px",width:"35px"}},null,8,Xk)],10,qk))),128))]))),128))]))}}),mV="",Kk=ss(Yk,[["__scopeId","data-v-fff1a9fd"],["__file","RoundMarkDialog.vue"]]),Db=t=>(k.pushScopeId("data-v-ef6011f8"),t=t(),k.popScopeId(),t),Zk={class:"fcb"},Jk={class:"symbolBox"},$k={class:"symbol"},Qk=["onClick"],t7=["src"],e7={class:"formBox"},n7={class:"iconFont"},r7={key:0,class:"icon","aria-hidden":"true"},i7=[Db(()=>k.createElementVNode("use",{"xlink:href":"#icon-a-1"},null,-1))],o7={key:1,class:"icon","aria-hidden":"true"},s7=[Db(()=>k.createElementVNode("use",{"xlink:href":"#icon-a-2"},null,-1))],a7={class:"topData"},l7={class:"fcb inLine"},c7={style:{width:"80%"}},u7=Db(()=>k.createElementVNode("div",{class:"line"},null,-1)),h7={class:"bottomData"},d7={class:"cornerData"},f7={key:0,class:"btnList"},p7={class:"leftDate"},m7=k.defineComponent({__name:"RoughnessDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=k.reactive({textLeftStr:"",rougCornerType:"无",isRoungSameRequire:!1,isShowMostSymbols:!1,textUpStr:[""],textDownStr:[""],isAddLongLine:!1,selectSymbolNum:0}),i=k.ref();let s="";const a=k.ref(!1),o=["=","⊥","X","M","C","R","P","无"];let r=new _a,u=new A.McDbWipeout,l=new A.McGePoint3d;const h=k.reactive(["其余","全部","下料切边"]);k.onMounted(()=>{s=MxPluginContext.useTheme().isDark.value?"dark":"light",sl.value=450,ps.value?r=ps.value.clone():r=new _a,d();const{wipeout:b,midPt:v}=Pb();u=b,l=v.clone()}),k.onBeforeUnmount(()=>{u.erase(),ps.value=null});let f=null;k.watch(()=>e,(b,v)=>{b&&(e.isRoungSameRequire&&(e.isAddLongLine=!0),f&&clearTimeout(f),f=setTimeout(()=>{p()},300))},{deep:!0});const d=()=>{e.textLeftStr=r.textLeftStr,e.rougCornerType=r.rougCornerType?r.rougCornerType:"无",e.isRoungSameRequire=r.isRoungSameRequire,e.isShowMostSymbols=r.isShowMostSymbols,e.textUpStr=r.textUpStr,e.textDownStr=r.textDownStr,e.isAddLongLine=r.isAddRougLongLine,e.selectSymbolNum=r.rougMarkType},p=()=>re(this,null,function*(){var j,Z;const b=A.MxCpp.getCurrentMxCAD(),v=new _a;v.setPos(l),v.rougMarkType=e.selectSymbolNum,v.textLeftStr=e.textLeftStr,v.rougCornerType=e.rougCornerType==="无"?"":e.rougCornerType,v.isRoungSameRequire=e.isRoungSameRequire,v.isShowMostSymbols=e.isShowMostSymbols;const x=(j=e==null?void 0:e.textUpStr)==null?void 0:j.filter(tt=>tt!="");v.textUpStr=(Z=JSON.parse(JSON.stringify(x)))==null?void 0:Z.reverse(),v.textDownStr=e.textDownStr.filter(tt=>tt!=""),v.isAddRougLongLine=e.isAddLongLine;const w=b.drawEntity(v),{minPt:M,maxPt:E}=v.getBoundingBox(),D=E.sub(M).normalize().mult(2);M.addvec(D.clone().negate()),E.addvec(D);let N=(E.x-M.x)*5,V=150/230*N;const K=yield cf({type:"image/bmp",width:N,height:V,range_pt1:M.toVector3(),range_pt2:E.toVector3()});i.value.src=K,b.mxdraw.updateCanvasSize(),w.erase(),n("receiveParameters",{roughnessData:e})});return(b,v)=>(k.openBlock(),k.createElementBlock("div",null,[k.createElementVNode("div",Zk,[k.createElementVNode("img",{ref_key:"img",ref:i,style:{margin:"10px 0px",width:"55%"}},null,512),k.createElementVNode("div",Jk,[k.createElementVNode("span",$k,k.toDisplayString(k.unref(dt)("基本符号")),1),(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(k.unref(Ok),(x,w)=>(k.openBlock(),k.createElementBlock("div",{class:k.normalizeClass(e.selectSymbolNum===w?"symbolImg backColor":"symbolImg"),key:w,onClick:()=>e.selectSymbolNum=w},[k.createElementVNode("img",{src:x,style:{width:"25px",height:"25px"}},null,8,t7)],10,Qk))),128))])]),k.createElementVNode("div",e7,[k.createElementVNode("div",n7,[k.unref(s)==="dark"?(k.openBlock(),k.createElementBlock("svg",r7,i7)):k.unref(s)==="light"?(k.openBlock(),k.createElementBlock("svg",o7,s7)):k.createCommentVNode("",!0)]),k.createElementVNode("div",a7,[k.createElementVNode("div",l7,[k.createVNode(k.unref(wn.VCheckbox),{label:`${k.unref(dt)("相同要求")}`,modelValue:e.isRoungSameRequire,"onUpdate:modelValue":v[0]||(v[0]=x=>e.isRoungSameRequire=x)},null,8,["label","modelValue"]),k.createVNode(k.unref(wn.VCheckbox),{label:`${k.unref(dt)("多数符号")}`,modelValue:e.isShowMostSymbols,"onUpdate:modelValue":v[1]||(v[1]=x=>e.isShowMostSymbols=x)},null,8,["label","modelValue"])]),k.createElementVNode("div",c7,[k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.textUpStr[0],"onUpdate:modelValue":v[2]||(v[2]=x=>e.textUpStr[0]=x)},null,8,["modelValue"]),k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",disabled:e.textUpStr.filter(x=>x!="").length==0,modelValue:e.textUpStr[1],"onUpdate:modelValue":v[3]||(v[3]=x=>e.textUpStr[1]=x)},null,8,["disabled","modelValue"])])]),u7,k.createElementVNode("div",h7,[k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.textDownStr[0],"onUpdate:modelValue":v[4]||(v[4]=x=>e.textDownStr[0]=x)},null,8,["modelValue"]),k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.textDownStr[1],"onUpdate:modelValue":v[5]||(v[5]=x=>e.textDownStr[1]=x),disabled:e.textDownStr.filter(x=>x!="").length<1},null,8,["modelValue","disabled"]),k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.textDownStr[2],"onUpdate:modelValue":v[6]||(v[6]=x=>e.textDownStr[2]=x),disabled:e.textDownStr.filter(x=>x!="").length<2},null,8,["modelValue","disabled"])]),k.createElementVNode("div",d7,[k.createVNode(k.unref(wn.VBtn),{class:"cornerIcon",onClick:v[7]||(v[7]=()=>a.value=!a.value)},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(e.rougCornerType),1)]),_:1}),a.value?(k.openBlock(),k.createElementBlock("div",f7,[(k.openBlock(),k.createElementBlock(k.Fragment,null,k.renderList(o,(x,w)=>k.createVNode(k.unref(wn.VBtn),{class:"cornerIcon",key:w,onClick:M=>e.rougCornerType=x},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(x),1)]),_:2},1032,["onClick"])),64))])):k.createCommentVNode("",!0)]),k.createElementVNode("div",p7,[k.createVNode(k.unref(wn.VCheckbox),{label:`${k.unref(dt)("长边加横线")}`,modelValue:e.isAddLongLine,"onUpdate:modelValue":v[8]||(v[8]=x=>e.isAddLongLine=x),disabled:e.isRoungSameRequire},null,8,["label","modelValue","disabled"]),k.createVNode(k.unref(wn.VCombobox),{class:"mt-1 mr-2","return-object":"",items:h,modelValue:e.textLeftStr,"onUpdate:modelValue":v[9]||(v[9]=x=>e.textLeftStr=x)},null,8,["items","modelValue"])])])]))}}),bV="",g7=ss(m7,[["__scopeId","data-v-ef6011f8"],["__file","RoughnessDialog.vue"]]),y7={style:{margin:"10px 0px"}},b7={class:"imgBox"},v7=["src"],x7={style:{width:"200px"}},_7={style:{display:"flex"}},w7={style:{width:"25%"}},M7=k.defineComponent({__name:"WeldSymbolDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=k.reactive({symbolType:0,width:10});k.watch(()=>e,(s,a)=>{s&&n("receiveParameters",wi({},e))},{deep:!0});const i=[{value:0,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAABNCAYAAADuHgybAAAAAXNSR0IArs4c6QAABdZJREFUeF7tnWGPEzAMQ7f//6MPDYQQHLCmTWI39+5zm9bPrjcOIZ6Px+PjwQ8EIAABCLQReFK8baw5CAIQgMB3AhQvQYAABCDQTIDibQbOcRCAAAQoXjIAAQhAoJkAxdsMnOMgAAEIULxkAAIQgEAzAYq3GTjHQQACEKB4yUCIwMfH4/F8pYYfCEBgm4CseCc/4MnaXkmbrA9t210i3Xibb7Li5QFLc3p8+G1BjwhGW4SWz9qbfJMWL+XrE9qdm9wU9Kg+tEWJeay/xTd58VK+HoHdvcUtQd/Rh7Ydavo9N/hmUbyUrz6sJze4Iei7+tC2S067z903m+KlfLVBPTndPeQn2sjlKT3dfudcWhUvIdeF9PRk55Cj7f8E8O40IfH9FG+c2dEOQn6ET7YZ32Tojw929M6uePnWe5wz6QDHkGcBQVsWyd45jr5ZFi/l2xvMzNMcQ46+NQKTvXPTRvGuZTJ9lVsQMgWiLZNm36zJvrl9mbMtXjdQ2fGfHPLJ2shl9kvom+eUS4q3z/dPJzkFIRsD2rKJ9syb7JvTh6Z18TqBqoj95JBP1kYuK15Dz0yXXFK8PX7/8xSXIFRgQFsF1fqZk31z+dC0L14XUFVxnxzyydrIZdWLqJ/rkEuKt97ntyc4BOHtJTcXoG0TnHgbvtUacEXx8u2iNgSV03nAlXRrZ+NdHV+Kt47t8mQCvozKbiHe2VmydCG1bxTvkk21i9QhqFXHfxVUzbdq/uRcqrVRvFWpDc5VByF43dBytIVw2Sye7Jv615fXFK8aVPVrmBxytFWnp24+3tWwpXhruIanEvAwMpsNeGdjRegiSt8o3pBVdYuVIahT9WvyZH1o60hQ/hlK3yjefD+3JipDsHXh4KbJ+tAWDIPJcqVvFC8haCGgDHm1QLRVE66Zr/SN4q3xdGuqMghbFw5sQlsAltFSfKsxg+Kt4bo1lZBvYZNvwje5BdsXUHlH8W5blr9RFYJ8JZ8noq2Dcv4Zk3170VLpu6p4f4J6PD7yE2Yx8To7AtTQFoBltnS2d8+XvOafq4iqPp26PJmsD21dKco9Z7JvfONdzAohWARluGyyd2gzDNzilVTe8Y130aCOZaoQoO2MAL6d8VPtVvpG8apc/+NcZQg6EEzWh7aOBOWfofSN4s33c2uiMgRbFw5umqwPbcEwmCxX+kbxEoIWAsqQVwtEWzXhmvlK3yjeGk/DU5UhCF82uGGyNuXfjAdt2Fo+2TulNop3K475m5QhyFfz+0S0VROum493NWyvKd7JAeBbU024O6ZOzuVkbeo3R/F2vM43ZxBwAxM2rzDZO7RthmJhG8W7AKl6CQGvJlw3H+/q2FZOVvtG8Va6uzhbHYLFa24tQ9sWNotNeFdnwxXFOzkA6t811UXrx+TJ3qGtOj018x18o3hrvF2e6hCC5csGF07WxodKMAxGyx1yaV+8DpAqMzNZH9oqk1M3e7JvLh+YFG9dft9OnhzwydpcHu/bgG0umOydizbr4nWBtJnft9sm60PbW/stF0z2zekDk+IVxX9ywCdrc3q8FdGd7J2TNtvidYJEwGMEJnuHtlgWnFY7eUfxCpLhFIBs+ZO18W03Oy1989xyaVm8bpAy4zFZG8WUmZTeWZNz6ajNrngdIWU+gcn60JaZlL5Zk31z/TJA8fblm3/F1cg68yiKKZNm7yxX76yK1xVSRlTQlkFRMwPvNNxPT3X2zaZ4nSFNDsCpNtc/ymXoQlsWxf457n1iUbzukE5iM1kbxXSSDO3eybm8QZu8eG+AtPtEJmujdHdTod83OZe3aJMW7y2Qdp7KZG2U7k4iPPZMzuVN2mTFexOk6JOZrI3SjabBZ/3kXN6mTVK8t0HyeTr6m0z2Dm36fH2VG0iK96vARScEIACBvxGgeMkFBCAAgWYCFG8zcI6DAAQgQPGSAQhAAALNBCjeZuAcBwEIQIDiJQMQgAAEmglQvM3AOQ4CEIAAxUsGIAABCDQT+AY4fBYu1nCUKgAAAABJRU5ErkJggg==",name:dt("单边V型对接焊缝（前视图）"),style:"height:45%;width:100%"},{value:1,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAABGCAYAAACE2fxYAAAAAXNSR0IArs4c6QAABWpJREFUeF7tnNuS2zgQQ+X//2in5ClXJXkYs6m+QPDxM9kkDiBY42zt4ziO58EHAhCAAATaCDwo3jbWHAQBCEDgRYDiJQgQgAAEmglQvM3AOQ4CEIAAxUsGIAABCDQToHibgXMcBCAAgdHifT6P43HewPCDtvuZenr2+ocPw0ySR608jhbviYJAaAVi9Tb4tkpKZx2e6XgxXryUr04YojfhQY4Sm1+PZ/MevP6qUvnveAmERiCit8C3KLH59Xg274FM8fLmOx+G3RvwIO+Sm9uHZ3Pspd543xgIxGwgdk939c1VFy86u0nP2Sf1xkv55pg6MYWCmqB+/Ux8u85wZ4Jk8Tp/GxP0nZjO78G3eQ+iN1D2jOKNupmwXjkQV+Wh7SrB/v141s9ctnid33rR1h/0jBMpqAyK/TMUfZMuXgqqP6QZJyoGPUMXecyi2DtHMY8Ub28G/jlNMRBZOFy1ueriSyUr+Wtz5IvXORA8xGshVVuFb2qOfL6PmmcU72fPSleoBSJTrKs2V13OLzlq2m5RvGrQKKc1AhTUGie1Va6+KemieAVSrxSIbByu2lx1Ob/kKGm7TfEqQaOc1glQUOusVFbiWb0TFG8946UTXMPuqsv5RcBZm0oeKd6lWqxfpBKICqWu2lx1ORevijaKt6JpNmbyEG9AG96CZ8MGbB6v4Nutilfl22rT71+3KYShQpezZ87ayGPV0/Azl+Kt5Rua7hp2V13OxeusTSGPFG+oGmsXKwSiSqGrNlddzsWroI3irWqajbk8xBvQhrfg2bABm8dP+0bxbhpXsW06DBWa3jNdtbnqUngrdM4jxVvpbnA2D3EQmMhyV99cdSl8qdyueBWgVT3vBL2KbO1cV99cdSl0CMVb+0yGphP0EC6Zxa6+ueqieDcfHddAuOpSCPpm1Ja24dsSJqlF057xxisUh+kwVKJAWyXdutmuvk3ronjrMhuePB2G8IUDG9AWgCWyFM/qjKB469iGJxP0MDKJDa6+uepS+OnrdsVLGCS6JnwJfAsjG9+AZ3UWULx1bMOTCXoY2fgGPBu3YOsC075RvFu21WyaDkONqp+prtpcdTl7pqCN4q1sm+BsHuIgMIHleCZgwsYVpn2jeDdMq9oyHQZ0xQm4eqbwVhh3Y22HgmcU75pX5asUwlAlEm1VZOvm4lkd23PyrYqXMNSGoWq6q2+uupzfdlW0UbxVbROcy0McBCawHM8ETNi4goJvFO+GcRVbFMKArhgBV89U3gpjbqytVvGM4l3zq3SVShgqRKKtgmrtTDyr5Xur33gJQ30YKk5w9c1Vl/PbrpK227zxugbdVZdSyPlCiRFwzaSSrlsUrxKwWIQ/r0bbZ0ZqK/BMzZG1+yj5RvGueVaySikI2QLRlk20Z56rb2q65ItXDVhm/NGWSbNnFp71cM4+Rc03ijfb4cA8tTAErv7rUldd/G6dlZDeOYp5lC5eRWBZkUFbFsm+OXjWxzrzJEXfZItXEVZWGNCWRbJ3jqtvrrqU/0KheHufXdv/L61yyDMsppwyKPbOUPZMsniVgV2Njqs2V118oVxN/Nx+5UzKFa8yrKsRQttVgv378ayfecaJ6r5JFa86rCuBQNsVenN7XX1z1XWXv1BkipcgzJXLlZPx7Qq9mb14NsP971MlipcgzAdh5wb4tkNtdg+ezfJ/nz5evARBIwjRW+BblNj8ejyb90CieAmCThAiN3H17dR1fh7n64jZx9Wzu/ym+3+cRt94n++km4UcORCAQB+Bxw2/KUeLt88aToIABCCgQ4Di1fGCm0AAAl9CgOL9EqORCQEI6BCgeHW84CYQgMCXEKB4v8RoZEIAAjoE/gALvAEuttoMygAAAABJRU5ErkJggg==",name:dt("角焊缝（前视图）"),style:"height:45%;width:100%"},{value:2,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAABICAYAAAC6L9h5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFjSURBVHhe7drRioMwFEXROP//z7aB7odhrHNaTXJvcjaIj+oiRAJ3K6Xsz8ud9PO6u2f7frxejCRkJCEjCRlJyEhCRhIykpCRhIwkZCQhIwkZSchIr94dbmvLI1WcM6DaskgKDi2H9AkOLYP0DQ5Nj3QFh6ZFugOHpkO6E4emQWqBQ+mRWuJQWqQeOJQOqScOpUEagUPhkUbiUFikCDgUDikSDoVBiohDw5Ei49AwpAw41B0pEw51Q8qIQ82RMuPQn5nJ7B90tW2rJL/rNliaBf8IqdueVB9+9AIZ6v53y4jVHYkyYQ1DogxYw5EoMlYYJIqIFQ6JImGFRaIIWOGRaCRWGiQagZUOiXpipUWiHljpkagl1jRI1AJrOiS6E2taJLoDa3okuoK1DBJ9g7UcEn2CtSwSKVjLI9EZlJGEjCRkJCEjCRlJyEhCRhIykpCRhIwkZCShemBZe7RNyCvp30p5AJPejoCkZsQmAAAAAElFTkSuQmCC",name:dt("单边V型对接焊缝（侧视图）"),style:"height:90%;width:50%"},{value:3,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAACVCAYAAAAUoxXNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALmSURBVHhe7d3djtowFIVR6Pu/Mx3a6c8MAbIhiY/ttaQj31qWPsm+8vl0Ol0+hk+Xy+V0Pl+PBW79+FyBFQQDAcFAQDAQEAwEBAMBwUBAMBAQDAQEAwHBQEAwEBAMBAQDAcFAQDAQEAwEBAMBwUBAMBAQDAQEAwHBQEAwEBAMBAQDAcFAQDAQEAwEBAMBwUBAMBAQDAQEAwHBLLh+2wdLBHOHaFgimAdEw3eCeUI0/E8wK4iGPwSzkmi4EkxANAgmJJq5CeYFopmXYF4kmjkJ5g2imY9g3iSauQhmA6KZh2A2Ipo5CGZDohmfYDYmmrEJZgeiGZdgdiKaMQlmR6IZj2B2JpqxCOYAohmHYA4imjEI5kCi6Z9gDiaavgmmAdH0SzCNiKZPgmlINP0RTGOi6YtgChBNPwRThGj6IJhCRFOfYIoRTW2CKUg0dQmmKNHUJJjCRFOPYIoTTS2C6YBo6hBMJ0RTg2A6Ipr2BNMZ0bQlmA6Jph3BdEo0bQimY6I5nmA6J5pjCWYAojmOYAYhmmMIZiCi2Z9gBiOafQlmQKLZj2AGJZp9CGZgotmeYAYnmm0JZgKi2Y5gJiGabQhmIqJ5n2AmI5r3CGZConmdYCYlmtcIZmKiyQlmcqLJCAbRBATDL6JZRzD8JZrnBMMXonlMMNwQzX2CYZFolgmGu0RzSzA8JJqvBMNTovlHMKwimt8Ew2qiEQyh2aMRDLGZoxEML5k1GsHwshmjEQxvmS0awfC2maIRDJuYJRrBsJkZohEMmxo9GsGwuZGjEQy7GDUawbCbEaMRDLsaLRrBsLuRohEMhxglGsFwmBGiEQyH6j0awXC4nqMRDE30Go1gaKbHaARDU71FIxia6ykawVBCL9EIhjJ6iEYwlFI9GsFQTuVoBENJVaMRDGVVjEYwlFYtmvPH3Oyo+sMLWlkMBljmSgYBwUBAMBAQDAQEAwHBQEAwEBAMBAQDAcFAQDAQEAysdjr9BLIwNQWJI4hAAAAAAElFTkSuQmCC",name:dt("角焊缝（侧视图）"),style:"height:90%;width:60%"}];return k.onMounted(()=>{sl.value=350,n("receiveParameters",{formData:e})}),(s,a)=>(k.openBlock(),k.createElementBlock("div",null,[k.createElementVNode("p",y7,k.toDisplayString(k.unref(dt)("选择要在几何图形上放置的焊缝符号"))+"： ",1),k.createVNode(k.unref(wn.VRadioGroup),{modelValue:e.symbolType,"onUpdate:modelValue":a[0]||(a[0]=o=>e.symbolType=o)},{default:k.withCtx(()=>[(k.openBlock(),k.createElementBlock(k.Fragment,null,k.renderList(i,(o,r)=>k.createElementVNode("div",{key:r,class:"radio"},[k.createElementVNode("div",b7,[k.createElementVNode("img",{src:o.image,class:"img",style:k.normalizeStyle(o.style)},null,12,v7)]),k.createElementVNode("div",x7,[k.createVNode(k.unref(wn.VRadio),{label:o.name,value:o.value},null,8,["label","value"])])])),64))]),_:1},8,["modelValue"]),k.createElementVNode("div",_7,[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("焊角宽度：")),1),k.createElementVNode("div",w7,[k.createVNode(k.unref(wn.VTextField),{type:"number",modelValue:e.width,"onUpdate:modelValue":a[1]||(a[1]=o=>e.width=o)},null,8,["modelValue"])])])]))}}),vV="",A7=ss(M7,[["__scopeId","data-v-a986481d"],["__file","WeldSymbolDialog.vue"]]),tM=t=>(k.pushScopeId("data-v-253ca580"),t=t(),k.popScopeId(),t),S7={class:"fbc",style:{"margin-top":"10px"}},E7={style:{width:"60%",height:"140px"}},T7=tM(()=>k.createElementVNode("div",{style:{width:"35%",height:"140px"}},[k.createElementVNode("img",{style:{width:"100%",height:"100%"},src:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAArYAAAGzCAYAAADaJlTCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AACWLSURBVHhe7dbbroXYkQXR/v+fdhuXsThrR3Jdt4QIaTx0MmGfKkt2/9+/+5ckSZL0AniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUlSRdvouaQq8ChJSmyNno1WRpu3oWgn6TE8SpKSKqPNSGW0uWONno1G0U7SY3iUJCVF0W4UinZXlNFmJIp2kh7DoyQpqSjajkDRbutO9J2Rymgj6TE8SpISo2g3Qq/ot0eiaCfpETxKkhKLou0IPaLfHYminaRH8ChJSiyKtiO0jn5zNIp2kh7BoyQpsSjajlAr+lb5W7OgaCfpETxKkhKjaDfK2ejdLYp2M6BoJ+kRPEqSEqNoNwpFuyMU7WZA0U7SI3iUJCVG0W4UinZHKNrNgKKdpEfwKElKjKLdKBTtjlC0mwFFO0mP4FGSlBhFu1Eo2h2haDcDinaSHsGjJCkxinajULQ7QtFuBhTtJD2CR0lSYhTtRqFod6SMNrOgzu7WaC/pDzxKkhKjaDcKRbs9FO1mUSv6tqT/waMkKTGKdqNQtNu6Er3fWq/otyX9Dx4lSYlRtBuldfSbd80W/Y2S/gePkqTEKNqRbfS8htbRbx7JEP3dkv7AoyQpMerMJqp896nW0W/umSX62yRdgkdJUmK1o994onb0G1e0LvqN8u+Q9BgeJUmJ1Y5+44mz0bstPIm+RyjaSXoEj5KkxGpG33/iSvR+K2W0WZTRhlC0k/QIHiVJiT2JvlcTFd2XyvdHo2hXomgn6RE8SpIS24v2PVF7z5a2748WRdstinaSHsGjJCkxinYjlO09W9tuZkDRbouinaRH8ChJSoyiXW/Umc1SuRspirYrinaSHsGjJCkxina9UWd3S7QdhaLdiqKdpEfwKElKjKJdbxTtFlG0HSGKtguKdpIewaMkKTGKdr1RtFtE0XYUinYLinaSHsGjJCkxinY9UbTbiqLtCBTtFhTtJD2CR0lSYhTteqJoV4qi7QhltFlQtJP0CB4lSYlRtOuJoh2Jom1vZbRZULST9AgeJUmJUbTrhaJdJIq2vZXRZkHRTtIjeJQkJUbRrheKdnuiaNvbGj1bUbST9AgeJUmJUbTrhaLdkSjazoainaRH8ChJSoyiXQ8U7c6Kou1MKNpJegSPkqTEKNq1FkXbs6JoOxOKdpIewaMkKTGKdi1F0faqKNrOgqKdpEfwKElKjKJdSxTt7oqibQ9lR8+Xyo2kx/AoSUqMol0rUbR9Ioq2rVFXnkuqAo+SpMTKaHPHGj1bRdG2hrvRt57YK3pefkPSY3iUJCVWRpvSnc5+o9zV9CT63l13ou9IegSPkqQERnf2b9nuWngSfe+JK9H7kh7BoyRpgIwd/d3lP2Mrd6NvPXU2elfSI3iUJHWUtaO/vfznbO1q9I1azkTvSXoEj5KkjrJ15u/e/vP1tEbPetuL9pIew6MkqaPe0d9wRxRtvyqKtpIew6MkqbMz0XsjUbT7Oop2kh7DoyRJp2yj5/pHGW0kPYZHSZJUmf8PrdQcHiVJkqRs8ChJ+rdt9FySWtlGz4XwKEk/ttHzNyqjjaS2ymjzNhTt9AOPkiaxjZ73QtHuqm30fLQy2rxNGW1IGW1aKaONrlujZz2V0eaONXo2GkU7/cCjpEmU0aYHinZXULQbiaLdm1C0K5XRphWKdke20fMvKaNNLxTtriijzUgU7fQDj5ImQNGuhyjalq5E749E0e5NKNqVymjTCkW7PRTtvoKiXQ8U7ciV6P2RKNrpDzxKmgBFu16o6P6k8ndHomj3JhTtSmW0aYU6szmq/MaXlNGmF2rv2d22vzkDinb6A4+SJkDRrpde0W+PQtHuLSjakTLatNQq+q23o2jXU4/od0eiaKc/8ChpAhTtemod/eZIFO3egqJdiaJdSy2i3/kCinY9tY5+czSKdvoDj5IGo2jXW8vo90ajaPcGUbQtUbTb2kbPr2oR/c4XULTrqXX0m6NRtNMfeJQ0GEW73q5E768o2o1G0e4NqDMb6uk7dzyJ3i+//yUU7Xq6Gn1jVUabGVC00x94lDQYRbveKNodoWg3GkW77GaI/q4rKNpFymjzFWW0GaGMNmeU0WYGFO30Bx4lDUbRrjeKdkco2o1G0S6zWaK/7QqKdoSi3RdQtBuhjDZHKNrNgKKd/sCjpIEo2o1A0e5IGW1mQNEusxmiv+sqinaEot0XULQboYw2RyjazYCinf7Ao6SBKNqVjqJ3rqJod6SMNjOgaJfVqOhveYqiHaFo9wUU7Up70f6OMtocoWg3A4p2+gOPkgZqFf3WVRTt9lC0mwFFu6yu9OTdpfL92ijalY6id96qZfR7V5XR5ghFuxlQtNMfeJTUwYjo77iCot0einYzoGi32Iv2o1FnnkXPl/aeLW2/UVvL6Pey6x39DVdQtDtC0W4GFO0WUbR9OTxKemjG6O+8qow2RyjazaBm9P1RovaeH71/9Hxtu6upZfR7M5sx+juvoGh3pIw2s6gVffvF8CjpgRmjv/OOMtqQM9F7vfSIfneEqKPNlfev7GppFf3WzGaM/s6rKNqVzkbv9tI6+s0Xw6OkB3pHf0MrZXR7Uvl7T80U/X297XV2R115d7utqUX0O7PrGf1+K62j33xqluhvezE8SnqgZvT9UXpEv7snS/S397bX2R21fffM++W+livR+2et0bMZ1Iq+PVLr6DePZIj+7pfDo6SH9jq7p91IraPf3DNb9DfOJOrsjirfpfdp0wJFu6vORO+NFEXbBUW7kVpHv7lnpujv+zA8SuooirYjtYp+64xR0d+SAXV2E1W+T1vatEDRbqtm9P0MKNqN1iL6nbNGRX+L/sCjpI4o2o12NfpGTTWi75bKaJPFtr1n26Jn5furMtq0MjL6ezKgaDfa1egbNT2NvlmiaKc/8CipkyjajnYler+FqDO7chMpo012e9FueyuV0WaxjZ6vMkR/dwYU7Ua7Er3fStSZXbkhFO30Bx4ldULRbgZXovdHomhHymiT2V60P/Kkmt/qUfn3ZhJF29Go6L5Uvj8aRbsSRTv9gUdJHUTRdjRq79nS9v0ZULQrldEmsyjakpq1/PbVyr/lbSjazYDae7a0fX+0KNpuUbTTH3iU1AFFuyMU7Z6gjp4vbTejRdF2q4w2We11ZlO77d/W8rfL3ylto+fZRdF2TxRtn6D2ni1t358BRbstinb6A4+SGoui7daV6P27qDObpXI3EkW7rTLaZDNj9Hcuzra3337vCEW7zCjala5E799VdvR8rdyNFEXbFUU7/YFHSY1Re8/utP29p6gzm6VyN1IUbVdltMlkluhvq4Gi3eJs9G5WUUfPr7b9zSeos7sl2o5C0W5F0U5/4FFSQ72i376rjDaLKNqOQtFuVUabLEZEf0crLaPfy6hX9Nt3ULRbRNF2hCjaLija6Q88SmqkZ/T7d1C0W0XRdgSKdqsy2mRwtaN3yu+vymjTQuvoN7PpFf32XRTtFlG0HYWi3YKinf7Ao6RGWkW/VQtFu60o2o5A0W5RRpuZHRVtznyn3NCONi20jH4vm1bRb9VE0W4VRdsRKNotKNrpDzxKaqBW9O2WKNptRdF2BIp2izLazOqovd32O2c3V3a1tYp+K5ua0fdboWhXiqLtCNSTnf7Ao6TKorbPt/utMtq0QtGORNG2N4p2izLazGqvo932+ZUdVW5auBK9v6Bolw1VPt/+39t7Ge1aoWhHomjbG/Vkpz/wKKmiKNqSMtq0QtEuEkXb3sposyijzayo1juq3LRA0S5C0S6bKNqWKNq1QtEuQtGutzLaLCja6Q88SqokiraRMtq0QtFuTxRte1ujZ6sy2sxsGz1fULRblB09Xyo3rWyj53so2mUSRVtC0a4FinZ7omjb2xo9W1G00x94lFTBXrSPlNGmBYp2R6JoO6My2mRH0W5RdvR8qdzMiKJdFlG0jVC0a4Gi3ZEo2s6Gop3+wKOkh/ai/Z4y2tQWRdszomg7mzLaZEfRblF29Hyp3MyGol0We9E+QtGuNop2Z0XRdiYU7fQHHiU9sBftj5TRpjaKdldE0XYmZbTJjqLdouzo+VK5aa2MNlsU7TLYi/Z7KNrVFEXbKyjazYSinf7Ao6Sb9qL9GWW0qSmKtldF0XYWZbTJjqLdam3v2TbatUTRbhFF29ntRfsjFO1qomh3VRRtZ0HRTn/gUdINe9H+rDLa1BJF2zv2on0PZVefvwFFuzMo2rUUdXZLu9ntRfszKNrVEkXbO6Jo20PZ0fOlcqMfeJR00V60v6KMNpE7+zLaPRFF29ai9jbbZ29B0a60Rrdt2+c97HVmt91ksBftz6JoF7myj6LtE1G0bY268lwIj5Iu2Iv2V1C0W5yJ3ltF0fapq9E3atgr2mzffwuKdltl0X1p+14vUUeb7fMM9qL9FdTZHUXvLqJoW8OV6P1a9oqel9/QDzxKOmkv2p/Vsiu/R9tankTfu2svel6+/wZltCldid7vIeroWRZ70f6sll35PdrW8CT63l13ou/oDzxKOinqyrZ3Z/+uctfC3ehbT1yJ3s+Mol3pSvR+D1ejb8yMOrsb1dm/rdzV9iT63hNXovf1Bx4lXVB29Hx0Z/627aalu9G3njobvZsZRTtyNnq3lyvR+zMrO7MZ2dm/rdy1cjf61lNno3f1Bx4lXbT3XzizdOXvKrct3Ym+U8OZ6L3MKNpFzkTv9XQmei+L6O+fqbN/13bXw9XoG7Wcid7TH3iUVFGr6LfO2ov2rUXRtrWj6J3MKNrtOYre6W0v2r9Fq+i3ztiL9j1QtOvhKHpHf+BRUmVnovdaiaLtF+1F++zKaHNkL9qPEEXbtzgbvdtCFG2/Koq2+oFHSS9H0e7LomibXRltzqBoNwpFO7VD0e7rKNrpBx4lvdw2eq5/lNHmDcpoc1YZbUbaRs/V3jZ6rn+U0UY/8ChJ+q81eiZJLa3RMyE8SpIkSdngUZIkScoGj5IkSVI2eJQ+60vRP78kSYnhUfqkL0b/Ht7gi9G/h+y+GP17eAPLG/3nOTE8Sp/01ejfRWZfjf5dZPfV6N9FdpY7+s90UniUPumL0b+H7L4a/bvI7qvRv4vM7B3Rf7YTwqP0SV+M/j28wRejfw/ZfTH69/AGljv6z3RSeJQkaRpfif7Z38TyRv95TgqPkiRJUjZ4lCRJkrLBoyRJkpQNHiVJkqRs8ChJkiRlg0dJkiQpGzxKkiRJ2eBRkiRJygaPkiRJUjZ4lCRJkrLBoyRJkpQNHiVJkqRs8Ch9kpmZmf1G/5s5KTxKn2NmZmZx9L+dE8Kj9ClmZmYWR//bOSk8Sp9iZmZmcfS/nZPCo/QZUbSVJElTw6P0CVG0lSRJ08Oj9HpRtJUkSSngUXq1KNpKkqQ08Ci9WhRtJUlSGniUXiuKtpIkKRU8Sq8URVtJkpQOHqXXiaKtJElKCY/Sq0TRVpIkpYVH6VWiaKvvWqNnktTbGj1TCI/Sa0TRVv/YRs/fqIw2ksbYRs/fqIw2QniUXiGKtjOY4W+jaHdHzW/VVkabr9hGzyPb6HlL2+i57pnh32cZbe6q/b1aKNoJ4VFKL4q2MyijTQ8U7a7aRs9Ho2j3dhTtSmW0aYWi3Rlr9OxLymjTC0W7K8poMxJFOyE8SqlF0XYGFO16oGi350z03kgU7d6Ool2Jol0LFO2OlNHmKyja9UDRbs+Z6L2RKNrpBx6l1KJoOwOKdr1QR8/vtP3maBTt3o6iXYmiXQsU7RZXove/gqJdD9SZzdXKb45G0U4/8CilFUXbWVC066VX9NujULR7O4p2JYp2rbSKfusLymjTU4/od0eiaKcfeJRSiqLtTMpo01OP6HdHomj3ZhTtSlG0baVV9FtvR9Gupx7R745E0U4/8CilE0XbmVC0661l9HujUbR7M4p2JYp2LbWIfucLKNr11Dr6zdEo2ukHHqVU9qL9TCja9Xans9+h3WgU7d6Kot1iW/l/r+29Q5X7q1pEv/MFFO16u9PZ79BuNIp2+oFHKZUo2s6Gol1vFO2OULQbjaLdG80Q/V1XHEXvbJXR5iso2vVG0e5IGW1mQNFOP/AopRFF2xlRtOuNot0RinajUbR7oxmiv+sKinaRMtp8AUW7Ecpoc0YZbWZA0U4/8CilEEXbGVG0G4Gi3ZEy2syAot3bzBL9bVdQtIuU0eYLKNqNUEabIxTtZkDRTj/wKE0virazomgXoWh3B0W7PRTtZkDR7k1GR3/TXRTtCEW7L6BoF6Fod0cZbY5QtJsBRTv9wKM0vSjazorae3a27W/cRdFuD0W7GVC0e5M73X13+7stULQje9H+zai9Z2fb/sZdZbQ5QtFuBhTt9AOP0tSiaDubHtHvXkXRbg9FuxlQtFtRtJtVVPTszPvRfa38Rk3U3rMrbX/njXpEv3tVGW2OULSbAUW7FUW7D8CjNK0o2vY0U/T3XVVGmyMU7WZARfe9yu/Oijrz7O7zte2uppbR72UwU/T3XUHR7ghFuxlQ0X2v8rsfgEdpSlG07WHG6O+8o4w2e/aifW8to9+bSdTe87PvXt3V0jL6vVnNGP2dV1G027MX7XtrFf3Wy+FRmk4UbXsZGf09tVBHz6+2/V5to6O/aRZRZzZRV97dbmtqFf3WzEZGf08t1NHzq22/V9vI6O95OTxK04mibS+1o98YoUf0u0cyRH/3LKLObPa68v52W9Pd6FuZ1Y5+Y4Qe0e8eyRD93S+HR2kqUbTt7UxH++3zGfSIfnfPjNHfOauos7uoo/e3t3JbE0W7q85E741ytqN3ts9n0Dr6zT2zRn/rB+FRmkYUbTOgaDdSy+j3joyK/pasqDObvcr36Ru0aYGiXeRp9M0Momg7Usvo946Miv4W/cCjNIUo2mZA0W60J9H3nqoZfX9B0S6zbUfP1/bupIw2rZRF9xZt/45MKNqNdjf6Vg01o+8vKNrpBx6l4aJom0EUbUc7G73bypmiXfktQtHuraLo+fa9UhltFmv0bCtL9LfPLoq2o52N3m3lqL3d9jsRinb6gUdpuCjaZkDRbgZldFsr3x2Nol2Jot0bRdH2SFl0p7bfOfvO6Mq/OROKdqNR0X2pfH80inYlinb6gUdpqCjaZhBF29GovWdL2/dHi6LtFkW7t4mi7Z4atfhmjcq/6w2iaDsatfdsafv+aFG03aJopx94lIaJom0WFO3O2EbPn6KuPJ8BRbstinZvsteVba16/2b5e1tr9OwNKNqdsY2eP0XtPVvavj8DinZbFO30A4/SEFG0zSKKtuRM9N5d1NHzpe1mtCjarijavcVRZza1K//GWn8DfXdPGW0yi6ItORO9dxd19HxpuxktirYrinb6gUepuyjaZkKd2Vyp/N4T1JnNUrkbiaLdiqLdG8wU/X1PULTbOoreyYw6s7lS+b0nys5s1mg7CkW7FUU7/cCj1F0UbbPoFf32XWW0WUTRdhSKdqsy2mQ3ou1vb/+WFlpFv5VRr+i376Bot4ii7QhRtF1QtNMPPEpdRdE2i57R799B0W4VRdsRKNqtymiTVavO/E65aaVl9HvZ9Ix+/w6Kdoso2o5C0W5B0U4/8Ch1E0XbTFpHv/kURbtVFG1HoWi3KKNNRnc6841yc2VXW+voNzNpHf1mDRTtVlG0HYGi3YKinX7gUeoiiraZ1Iq+3RJFu60o2o5A0W5RRpts9trbbL9xdnNlV1ur6LcyqhV9u6Uy2pSiaDsC9WSnH3iUmouibSZR9Ozo3fJ5SxTtSBRte6NotyijTSZ7He22z6/sqHLTwp3OfKPcZBRFz47e2z5vjaIdiaJtb9STnX7gUWouirZZRNGWlNGmFYp2kSja9kTRblFGm0yizuzKzdkdVW5aoGi3h6JdJlG0LVG0a4WiHYmibW/Uk51+4FFqKoq2mUTRlpTRphWKdpEo2va2jZ6vymiTzTZ6vqBot6CuPG9pGz3fQ9EukyjaEop2LUTRNhJF29620fMFRTv9wKPUTBRtM4mibaSMNi1QtDsSRdsZldHmjSjaLagrz2dF0S6LvWhPKNq1QNHuSBRtZ0PRTj/wKDURRdtMomi7p4w2LVC0OyOKtrMpo80bUbRbUFeez4iiXRZ70T5C0a62KNqeEUXbmVC00w88StVF0TaTKNruoWhXG0W7K6JoO5My2rwRRbtF2dHzpXLTWhlttijaZbAX7fdQtKuNot1ZUbSdCUU7/cCjVF0UbbOIou0RinY1RdH2iijazqSMNm9E0W61be/ZWrlpjaLdiqLd7Pai/RGKdjVF0faKKNrOgqKdfuBRqiqKthnsRfszKNrVEkXbO6Jo28u2o+dLtHkjinZnULRriaLdgqLd7Pai/RkU7WqJou0dUbTtZdves7VyI4RHqZoo2mawF+3PomhXSxRt74qibWvU0aZ8/lYU7c6gaNdS1Nkt7Wa2F+3PomhXQxRtn4iibWvUlecK4VGqIoq2GexF+yso2pWiaLuKou1TUbRtaa9os33/zSjabZVF96Xte71EHW22zzPYi/ZXULQrRdF2FUXbJ/aifUtRe8+37yuER+mxvWg/u71of1WLrvwObWt4Gn3zjqNoU37jrSjabVF79xGijp5lsRftr2rRld+hbQ1Pou/ddSf6jn7gUXosirYZRNF2Nbqzf0+5q+1J9L0nrkTvvxFFu60r0fs9XI2+MbMo2q5Gd/bvKXe1PYm+d9fV6Bv6gUfpkSjaZkGd2Yzs7N+23bVyN/rWU2ejd98mirZbV6L3e7kSvT8z6sxmZGf+tu2mpbvRt546G72rH3iUbouibTbbjp6P7uzftd21dif6Tg1novfeJoq25Ez0Xk9novcy2Hb0fHRn/67trrU70XdqOBO9px94lG6Jou0b9Wr7e9vfJ3vRvrWz0bu1HUXvvBFFu8hR9E5vR9E7b9Cj8ve2/zfZi/YtXYner+0oekc/8Chdthft3+hO9J1a9qL9F+1F+zeiaLdnL9qPEEXbt7gTfaeWvWj/RXvRXj/wKF0WRVv1EUXbL4ui7RuV0eYMinajULRTO1G0/TKKdkJ4lC6Joq36KqONvv3vqYw2Z5XRZqRt9FztbaPn+kcZbYTwKJ0WRVtpZtvo+Zut0TNJY2yj50J4lE6Joq0kSVJjeJROiaKtJElSY3iUDkXRVpIkqQM8SruiaCtJktQJHqVQFG0lSZI6wqOEomgrSZLUGR4lFEVbSZKkzvAo/YiirSRJ0gB4lP6Ioq0k6S//+1LqBo/S/0TRVpL2rNGztyqjjaRq8Cj9RxRtJY23jZ6PVEabt6FoJ6kaPEr/EUVbSWNRtBuFot0VZbQZiaKdpGrwKP33v4J/o62k8SjajULR7shR9M5IFO0kVYFHfVwUbSXNg6LdCNTZ3ZXomyNRtJNUBR71YVG0lTSXKNqO0CP63ZEo2kmqAo/6qCjaSpoTRbsRekS/OxJFO0lV4FEfFUVbSXOiaDdC6+g3R6NoJ6kKPOqDomgraU4U7UZ50plvlZsZULSTVAUe9TFRtJU0L4p2I0XRdk8ZbWZA0U5SFXjUh0TRVtLcKNqNVEabM8poMwOKdpKqwKM+Ioq2kuZH0W6kMtocoWg3A4p2kqrAoz4iiraS5kfRbqQy2hyhaDcDinaSqsCjPiCKtpJyoGg3UhltjlC0mwFFO0lV4FEvF0VbSXlQtBupjDZHKNrNgKLdqow2kkJ41ItF0VZSLhTtRqFod4Si3QyovWdR229KCuFRLxVFW0n5ULQbhaLdkSjajtAi+h1JP/Col4qiraR8KNqNQp3ZnK38Vgujor9F0g886oWiaCspJ4p2o/SIfveM2aO/WdIPPOplomgrKS+KdltRtH2qdfSbe2aO/l5Jh/CoF4miraTcqOh+pvL7T7WMfu/IqOhvkVQFHvUSe9FeUm61o9944mn0zSdqd/Y3aCepCjzqJaJoKym/2tFvPHE2ereFJ9H3CEU7SVXgUS8QRVtJ71Az+v4TVHRfKt8fjaJdiaKdpCrwqOSiaCvpPa5G32iFiu5L5fujUbQrUbSTVAUelVgUbSW9C0W7Eai9Z0vb92dA0W6Lop2kKvCoxKJoK+ldKNqNQB09X9puRoui7YqinaQq8Kikomgr6X0o2o1QdmazRttRKNqtKNpJqgKPSiiKtpLeiaJdb9TZ3RJtR4mi7YKinaQq8Khkomgr6b0o2vVG0W4RRdtRKNotKNpJqgKPSiSKtpLejaJdbxTtVlG0HYGi3YKinaQq8KhEomgr6d0o2vVWRptSFG1HKKPNgqKdpCrwqCSiaCvp/Sja9UTRjlC0G4F6spNUBR6VQBRtJX0DRbueKNqRKNr2Rj3ZSaoCj5pcFG0lfQdFu16iaBuJom1v2+j5gqKdpCrwqIlF0VbSt1C064Wi3ZEo2s6Gop2kKvCoiUXRVtK3ULTrIYq2Z1C0mw1FO0lV4FGTiqKtpO+haNcDRbuzomg7E4p2kqrAoyYURVtJ30TRrrUo2l4RRdtZULSTVAUeNZko2kr6Lop2LUXR9o4o2vaybe/ZWrmRVA0eNZEo2kr6Nop2LVG0eyKKtq1RV55LqgqPmkgUbSV9G0W7VqJo+8RetG8pau/59n1JVeFRk4iirSRRtDuLot0iirY1PIm+d9de0fPyG5KqwaMmEEVbSVr06uzvlrvankTfu+tq9A1JVeBRg0XRVtJ7zdzR37j952jpbvStJ65E70uqAo8aKIq2kvLL2tHfXv5ztnI3+lYNZ6L3JFWBRw0URVtJuWXt6G8v/zlbuxp9o6aj6B1JVeBRg0TRVlJ+s0Z/69ZetP+ao+gdSVXgUQNE0VbSe9SMvt9CFG2/Koq2kqrBozqLoq2k99lGz2e0jZ6L/7uddpKqwaM6iqKtJCmXMtpIqgaP6iiKtpIkSQrhUZ1E0VaSJEm78KgOomgrSZKkQ3hUY1G0lSRJ0il4VENRtJUkSdJpeFRDUbSVJEnSaXhUI1G0lSRJ0iV4VANRtJUkSdJleFRlUbSVJEnSLXhURXvRXpIkSbfgURVF0VaSJEm34VGVRNFWkiRJj+BRFUTRVpIkSY/hUQ9F0VaSJElV4FEPRdFWkiRJVeBRD0TRVpIkSdXgUTdF0VaSJElV4VE3RNFWkiRJ1eFRF0XRVpIkSU3gURdF0VaSJElN4FEXRNFWkiRJzeBRJ0XRVpIkSU3hUSdE0VaSJEnN4fHzjv4f1CjaSpIkqQs8fto2er6Ioq0kSZK6wOOnlR09Xyt3kiRJ6gqPn7XX3vPyO5IkSeoOj590N/qWJEmSusPjJ92JviNJkqQh8Pg5d6NvSZIkaQg8fs7d6FuSJEkaAo+f8jT6piRJkrrD42fUir4tSZKkrvD4GTWj70uSJKkbPH5Ci+h3JEmS1AUeP6F29BuSJEnqBo+vVzv6DUmSJHWFx1erHf2GJEmSusPjq9WMvi9JkqQh8PhaNaPvS5IkaRg8vlat6NuSJEkaCo+vVCv6tiRJkobD4+vUir4tSZKkKeDxdWpE35UkSdI08PgqNaLvSpIkaSp4fI0a0XclSZI0HTy+xtPom5IkSZoSHl/hafRNSZIkTQuPr/Ak+p4kSZKmhsf0nkTfkyRJ0vTwmNqT6HuSJElKAY+p3Y2+JUmSpDTwmNbd6FuSJElKBY9p3Ym+I0mSpHTwmNKd6DuSJElKCY/p3Im+I0mSpLTwmM7V6BuSJElKDY+pXI2+IUmSpPTwmMqV6H1JkiS9Ah7TuBK9L0mSpNfAYwpXovclSZL0KnhM4Wz0riRJkl4Hj9M7E70nSZKk18Lj9I6idyRJkvRqeJzaUfSOJEmSXg+P0zqK3pEkSdIn4HFae9FekiRJn4HHKe1Fe0mSJH0KHqezF+0lSZL0OXicThRtJUmS9El4nEoUbSVJkvRZeJxGFG0lSZL0aXicQhRtJUmS9Hl4nEIUbSVJkvR5eBwuiraSJEnSv+FxqCjaSpIkSf+Fx2GiaCtJkiRt4HGIKNpKkiRJBTwOEUVbSZIkqYDH7qJoK0mSJAE8dhVFW0mSJCmAx26iaCtJkiTtwGM3UbSVJEmSduCxG4p2kiRJ0gE8drWNnkuSJEkn4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEmJ/N+//h9F8ivAZObHiQAAAABJRU5ErkJggg==",alt:""})],-1)),C7={class:"fbc"},P7={class:"btnBox"},D7={class:"tiltle"},R7=["onClick"],k7=["src"],I7={class:"btnBox"},L7={class:"tiltle"},B7=["onClick"],F7=["src"],N7={class:"btnBox"},O7={class:"tiltle"},z7=["onClick"],U7=["src"],V7={class:"fbc"},j7={class:"btnBox",style:{width:"45%"}},G7={class:"tiltle"},H7={style:{display:"flex","justify-content":"space-around",width:"100%"}},W7={class:"btnBox",style:{width:"50%"}},q7={class:"tiltle"},X7=["onClick"],Y7=["src"],K7={class:"fbc",style:{"margin-bottom":"5px"}},Z7={style:{width:"70%",height:"150px"}},J7={class:"fbc",style:{height:"30%"}},$7={class:"btnBox",style:{width:"25%",height:"100%",display:"flex"}},Q7={class:"tiltle"},t9={style:{width:"80%"}},e9={class:"btnBox",style:{width:"25%",height:"100%",display:"flex"}},n9={class:"tiltle"},r9={style:{width:"80%"}},i9={class:"btnBox",style:{width:"45%",height:"100%",display:"flex"}},o9={class:"tiltle"},s9={class:"fbc"},a9={style:{width:"40%","margin-left":"10px"}},l9=tM(()=>k.createElementVNode("span",null,"×",-1)),c9={style:{width:"40%","margin-right":"10px"}},u9={class:"fbc",style:{height:"55%","margin-top":"20px"}},h9={class:"btnBox",style:{width:"45%",height:"100%",display:"flex"}},d9={class:"tiltle"},f9={style:{width:"75%",padding:"0px 10px"},class:"fbc"},p9={class:"btnBox",style:{width:"30%",height:"100%",display:"flex"}},m9={class:"tiltle"},g9={style:{width:"80%"}},y9={class:"btnBox",style:{width:"20%",height:"100%",display:"flex"}},b9={class:"tiltle"},v9={class:"btnBox",style:{width:"25%",height:"150px"}},x9={class:"tiltle"},_9=k.defineComponent({__name:"WeldingSymbolDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=k.reactive([{typeName:pn.RolledEdge,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACLCAYAAABRGWr/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAM2SURBVHhe7c1BjuNGEEXBuf+lx+OFYYCIoqhuqcXKeR+IzVMW9evPficXMSbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMP41/p36Ff9Nvw3FON5xujlznG4GYhxP093KcboZiHE8TXcrx+lmIMbxNN2tHKebgRjH03S3cpxuBmIcT9PdynG6GYhxPE13K8fpZiDG8TTdrRynm4EYx9N0t3KcbgZiHE/T3cpxuhmIcTxNdyvH6WYgxvE03a0cp5uBGMfTdLdynG4GYhzvON2c0XQ3DON4x+nmjKa7YRjHO043ZzTdDcM4mqa7M5ruhmEcTdPdGU13wzCOpunujKa7YRhH03T3iKa7QRhHO043V2i6G4RxLE13V2i6G4RxLE13V2i6G4RxLE13V2m6G4JxJE13z9B0NwTjSJrunqHpbgjGcVbT7bM03Q3AOI6mu6/QdDcA4zia7r5K093mGEfRdPcdmu42xziKprvvWE23G2McYzXdfpemu40xjrCabl9hNd1uinEETXevtJpuN8S4vdV0+2qa7jbEuD1Nd++wmm43w7g1TXfvtJpuN8K4rdV0+05n0/0mGLe0mm5/wmq63QTjdlbT7U9aTbcbYNzKarr9hNV0e3OM2zib7j9lNd3eGOMWzqb7T1tNtzfFeHtn0/0dPJre3AzjrZ1N93fyaHpzI4y39Gh6c1dn0/1NMN7Oo+nN3T2a3nwY4208mt7s5NH05oMYP+7K9G5HV6Z3H8D4MVent7u7Mr37QYw/7ur0dpJnpvdvxvgjnpneT/bM9P5NGN/iq9O3/gbfmb73AoxPe8f0P3+rd0z/8wDjZa+e/iP/e/X0HycYL3vV9O2svXL6/gLjZV+dvpWv+870vQXGy65Ob/M+V6e3JxgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMTn49fsfRY10KYgEzyAAAAAASUVORK5CYII=",name:dt("卷边焊缝")},{typeName:pn.IWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAACECAYAAABVsVOaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAM/SURBVHhe7coxcgIBDARB/v9pTHhB54PwTlUn0r4+vWeAxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4THzTP9f8Uz/L8BjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZj5pn+v+KZ/l+AxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxke5197vf8A1pjJf8df5dQAAAAASUVORK5CYII=",name:dt("I型焊缝")},{typeName:pn.VWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACGCAYAAADth3khAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAO9SURBVHhe7dBBltQ6EEVB9r9pPjCApn8k7XJZdkp695yYpJ9qUN9+9D3iIB4jhMcI4TFCeIwQHiOExwjhMUJ4jBAeI4THCOExQniMEB4jhMcI4TFCeIwQHiOExwjhMUJ4jBAeI4THCOExQniMEB4jhMcI4TFCeIwQHiOExwjh8SUf0/e43sf0fRAeD1PaxXWUdgPweJjSLq6jtBuAx8OqtI33VWk7AI8vUdrF+5R2g/D4kipt47wqbQfh8WVKuzhPaTcQj6co7eJ1SrvBeDylSts4rkrbwXg8TWkXxyntbsDjaVXaxteqtL0Bj29R2sXXlHY34fEtVdpGrUrbm/D4NqVd1JR2N+LxEkq7+D+l3c14vESVtvFHlbY34/EySrv4Q2n3AB4vU6VttP+/eLyU0i7a/1c8XqpK251VafsQHi+ntNuZ0u5BPA6htNuR0u5hPA5Rpe1OqrR9GI/DKO12orRrgMdhqrTdQZW2DfA4lNJuB0q7JngcqkrblVVp2wSPwyntVqa0a4THWyjtVqS0a4bHW1Rpu5IqbZvh8TZKu5Uo7Rri8TZV2q6gStuGeLyV0m4FSrumeLxVlbYzq9K2KR5vp7SbmdKuMR4fobSbkdKuOR4fUaXtTKq0bY7HxyjtZqK0mwCPj6nSdgZV2k6Ax0cp7WagtJsEj4+q0razKm0nwePjlHadKe0mwmMLSruOlHaT4bGFKm07qdJ2Mjy2obTrRGk3IR7bqNK2gyptJ8RjK0q7DpR2k+KxlSptn1Sl7aR4bEdp9ySl3cR4bElp9wSl3eR4bKlK2ztVaTs5HttS2t1JabcAHtuq0vYOVdougMfWlHZ3UNotgsfWqrQdqUrbRfDYntJuJKXdQnicgtJuBKXdYnicQpW2V6rSdjE8TkNpdyWl3YJ4nEaVtleo0nZBPE5FaXcFpd2ieJxKlbbvqNJ2UTxOR2n3DqXdwnicktLuDKXd4nicUpW2r6jSdnE8Tktp9wql3QZ4nFaVtkdUabsBHqemtDtCabcJHqdWpe2/VGm7CR6np7T7F6XdRnhcgtJOlHab4XEJVdp+VKXtZnhchtLuI6XdhnhcRpW2P1VpuyEel6K0+0lptykel1J1drcxHpejzmw2x+OS1JFv8RuPS3o1/cbmeFzW0fQ2fFzW0fQ2fFzaV+lN/MLj0r5Kb+IXHpdXpW38xuMWPqdN/IXHLXxOm/gLjxHCY4TwGCE8RgiPEcJjhPAYITxGCI8RwmOE8BghPEYIjxHCY4TwGCE8RgiPEZ98+/4famIFigcWF7IAAAAASUVORK5CYII=",name:dt("V型焊缝")},{typeName:pn.SingleVWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIQAAACECAYAAABRRIOnAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAPJSURBVHhe7dLLstMIEERB/v+nYYDwYEy6ryy79Oo+EblplbTSt//6PsYdHkdfPI6+eBx98Tj64nH0xePoi8fRF4+jLx5HXzyOvngcffE4+uJx9MXj6IvH0RePoy8eR188jr54HH3xOPricfTF4+iLx9EXj6MvHkdfPI6+eBx98Tj64nH0xePoi8e4+/R8LHNLz1biMe4xbUbtMW1W4DFKaTeee5a2L+IxSmk37FnarsBjlNJu/KtK+xV4jFLajb9Vab8Sj1FKu/FHlfZv4DFKaTd+q9L+TTxGKe3G5j/DTzxGKe26q9L+Q3iMUtp1VqX9B/EYpbTrqkr7D+MxSmnXUZX2ATxGKe26qdI+hMcopV0nVdoH8RiltOuiSvswHqOUdh1Uab8BHqOUdldXpf1GeIxS2l1ZlfYb4jFKaXdVVdpvjMcopd0VVWm/Ax6jlHZXU6X9TniMUtpdSZX2O+IxSml3FVXa74zHKKXdFVRpfwA8Rintzq5K+4PgMUppd2ZV2h8Ij1FKu7Oq0v5geIxS2p1RlfYHxGOU0u5sqrQ/KB6jlHZnUqX9gfEYpbQ7iyrtD47HKKXdGVRpfwI8Rintjq5K+5PgMUppd2RV2p8Ij1FKu6Oq0v5keIxS2h1RlfYnxGOU0u5oqrQ/KR6jlHZHUqX9ifEYpbQ7iirtT47HKKXdEVRpfwE8Rint9lal/UXwGKW021OV9hfCY5TSbi9V2l8Mj1FKuz1UaX9BPEYp7bZWpf1F8RiltNtSlfYXxmOU0m4rVdpfHI9RSrstVGnfAI9RSru0Ku2b4DFKaZdUpX0jPEYp7VKqtG+GxyilXUKV9g3xGKW0+7Qq7ZviMUpp90lV2jfGY5TS7lOqtG+Oxyil3SdUaT98jFLavatK+/ELj1FKu3dUaT/+x2OU0m6tKu3HX3iMUtqtUaX9+AePUUq7V1VpP4jHKKXdK6q0H0/xGKW0W6pK+1HiMUppt0SV9uNLPEYp7b5Spf1YhMcopV2lSvuxGI9RSrtnqrQfL+ExSmknVdqPl/EYpbR7VKX9WIXHKKXdvSrtx2o8Rintbqq0H2/hMUpp91OV9uNtPEappbtb2o+P4DFKLdncetyOj+IxSn31/Nb9bkTwGKWqZ7fuvzFieIxSz+63Hr8xYniMejV9Y8TwGPVKen9E8Ri1NL074niMWpLeG5vgMeqr9M7YDI9RVdqPTfEY9Sxtx+Z4jHtMm7ELHkdfPI6+eBx98Tj64nH0xePoi8fRF4+jLx5HXzyOvngcffE4+uJx9MXj6IvH0dK37z8A73de+HhGe7kAAAAASUVORK5CYII=",name:dt("单边V型焊缝")},{typeName:pn.SingleSteepVWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAACGCAYAAAAYefKRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANoSURBVHhe7c8xbiRADANB///TPl9qVLpDSWYDlQhM9PXTdxXwWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMXjGP/T/a8I/s/jCL/T5rLfafNBPMYp7a5S2n0Qj3FKu6uUdh/EY5zS7iql3QfxGKe0u0hp92E8xintLlLafRiPcUq7i5R2H8ZjnNLuGqXdAzzGKe2uUdo9wGOc0u4Spd0jPMYp7S5R2j3CY5zS7hKl3SM8xintrlDaPcRjnNLuCqXdQzzGKe2uUNo9xGOc0u4Cpd1jPMYp7S5Q2j3GY5zS7gKl3WM8xinttlPaBfAYp7TbTmkXwGOc0m47pV0Aj3FKu82UdiE8xintNlPahfAYp7TbSmkXxGOc0m4rpV0Qj3FKu62UdkE8xintNlLahfEYp7TbSGkXxmOc0m4jpV0Yj3FKu22UdgPwGKe020ZpNwCPcUq7bZR2A/AYp7TbRGk3BI9xSrtNlHZD8BintNtEaTcEj3FKuy2UdoPwGKe020JpNwiPcUq7DZR2w/AYp7TbQGk3DI9xSrsNlHbD8BintJtOaTcQj3FKu+mUdgPxGKe0m05pNxCPcUq7yZR2Q/EYp7SbTGk3FI9xSrvJlHZD8RintJtKaTcYj3FKu6mUdoPxGKe0m0ppNxiPcUq7iZR2w/EYp7SbSGk3HI9xSrtplHYL8BintJtGabcAj3FKu2mUdgvwGKe0m0RptwSPcUq7SZR2S/AYp7SbRGm3BI9xSrsplHaL8BintJtCabcIj3FKuymUdovwGKe0m0BptwyPcUq7CZR2y/AYp7SbQGm3DI9xSrs0pd1CPMYp7dKUdgvxGKe0S1LaLcVjnNIuSWm3FI9xSrskpd1SPMYp7VKUdovxGKe0S1HaLcZjnNIuRWm3GI9xSrsEpd1yPMYp7RKUdsvxGKe0S1DaLcdjnNLuNaXdATzGKe1eU9odwGOc0u41pd0BPMYp7V5S2h3BY5zS7iWl3RE8xintXlHaHcJjnNLuFaXdITzGXUr/LcBj3KX03wI8xl1LPw7H4whX0m8L8DjG9vTTEjxW8VjFYxWPVTxW8VjFYxWPVTxW8VjFYxWPVTxW8VjFYxWPVTxW8VjFYxWPVTzWn/b1/Q8BUEg5iTSvRAAAAABJRU5ErkJggg==",name:dt("单边陡侧V型坡口堆焊")},{typeName:pn.InclinedWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACKCAYAAABxcgJZAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAL9SURBVHhe7ctZbiMxEATRuf+lPYbhAryEO0tSq8UlEng/Qda/971JBzBKBaNUMEoFo1QwSgWjVDBKBaNUMEoFo1QwSgWjVDBKBaNUMEoFo1QwSgWjVDBKBaNUMEoFo1QwSgWjVDBKBaOepEZvg8Kok9Ho34Aw6kRHo/+DwaiTHI3+DwijHpRGN4PCqAek0c3AMOoOndHd4DDqRml0MwmMauqM7iaCUQ1pdDMhjArS6GZSGPWHNLqZHEaBNLpZAEZ90RndLQKjPqXRzWIwbq8zulsQxq2l0c3CMG4rjW4Wh3E7aXSzCYxbSaObjWDcQmd0txmMy0ujm01hXFZndLcxjEtKoxtxXE4a3egDxmWk0Y2+wbiENLrRLxin1hndCWGcVhrd6BDG6XRGd4owTiWNbtSGcRppdKObYBxeGt3oLhiHlkY3uhvGIXVGd3oIxuGk0Y1OgXEYndGdToNxCGl0o9NhfLk0utFTYHyZNLrRU2F8iTS60dNhvFRndDejr6P3AWG81NHo/4xo9G9AGC/11+jvjI5G/weD8VI/R39mlEY3A8J4uRq9zSiNbgaFUXfqjO4GhlF3SKObCWDUjdLoZhIY1ZRGN5PBqIY0upkQRh3ojO4mhVF/SKObyWHUD53R3QIw6os0ulkIRn1Ko5vFYNxeGt0sCuPW0uhmYRi31BndLQ7jdtLoZhMYt9EZ3W0E4xbS6GZDGJeXRjebwrisNLrZHMYlpdGNOC6lM7rTB4zLSKMbfYNxep3RnX7BOLU0utGfME4rjW50CON00uhGLRinkkY3asM4hc7oTjfBOLw0utFdMA6rM7rT3TAOKY1u9DCMw0mjG50C4zDS6EanwjiENLrR6TC+VGd0p6fA+DJpdKOnwni5zuhOT4fxUml0o8tgvNTR6L8uhfFSNPqnl8B4qZ+jP3oZjFLBKBWMUsEoFYxSwSgVjFLBKBWMUsEoFYxSwSgVjFLBKBWMUsEoFYxSwSgVjFLBKBWMUsEoFYxSwSgVjFLBKL379/YfTIZSIZ+GYOYAAAAASUVORK5CYII=",name:dt("倾斜焊缝")},{typeName:pn.RemovablePadding1,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAYAAABSZ763AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAorSURBVHhe7dLLimNBDkXR/v+f7m4PEhKx/AjLkm8WZ8Oa6J4oXJD/+X//jYh1PEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8ePSemvp7/rD+DxI1L6V9LfdxOPbSn9a+nvvIHHtpT+tfR33sBjW0r/Wvo7b+CxTWkXcUVKuwYe25R2EVektGvgsU1pF3FFSrsGHtuUdhFXpLRr4LFNabftd/p+Jb/T93dsp9/wFyjtGnhsU9ptqmlzFUq7U99Mv+eqlHYNPLYp7TYp7a5AaXfqCul3XY3SroHHNqXdJqXdt91L21NXSr/vKpR2DTy2Ke02Ke2+7V7anrpa+o1XoLRr4LFNabfpXtp+0720PVXT5pNeSe++TWnXwGOb0m7TvbT9pntpe6qmzYRn6c03Ke0aeGxT2m26l7bf8ijtT9W0mXYvbb9FadfAY5vSbtO9tP2WR2l/qqbNBqXdtyjtGnhsU9ptepT23/Ao7U/VtNlwL22/QWnXwGOb0m7To7Tf9iy9OVXTZovS7huUdg08tintNj1K+23P0ptTNW02Ke22Ke0aeGxT2m16lt5sepbenKpps0lpt01p18Bjm9Ju07P0Zssr6d2pmjablHbblHYNPLYp7TY9S2+2vJLenapps01pt0lp18Bjm9Ju0yvp3YZX0rtTNW22Ke02Ke0aeGxT2m16Jb3b8Ep6d6qmzTal3SalXQOPbUq7Ta+kd9NeTW9P1bTZprTbpLRr4LFNabepptut+m7aq+ntqZo225R2m5R2DTy2Ke021XS7Vd9NezW9PVXTZpvSbpPSroHHNqXdppput+q7SerRvaumzTal3SalXQOPbUq7TbVn9w3q0b2rps02pd0mpV0Dj21Ku021e/dbv99NUo/uXTVttintNintGnhsU9ptqt273/r9bop65VtHTZttSrtNSrsGHtuUdptq9+63fr+bol751lHTZtO9tN2ktGvgsU1pt6n26Nut398nqFe+ddS02aS026a0a+CxTWm3qfbo263f3z9NnXx/V02bTUq7bUq7Bh7blHabao++3fr9/dPUyfd31bTZorT7BqVdA49tSrtNtWffb9XNp6iT7++qabNFafcNSrsGHtuUdptqz77fqptPqT37fqtu3lHTZsO9tP0GpV0Dj21Ku021Z99v1c0nqHc276hpM+1e2n6L0q6Bxzal3abau5su9c7mHTVtpjxK+29S2jXw2Ka021R7ZXNLuw71zuYdNW0+7Vl6821KuwYe25R2m2qvbG5p9y7V2Z2qafMJJ+n9tyntGnhsU9ptqr2yuaXdu1Rnd+pq6TdegdKugcc2pd2mmjY3Srt3qM7u1FXSb7sSpV0Dj21Ku001bW6UdqeUdjdKu1PfTL/nqpR2DTy2Ke021bS5UdqdUtrdKO1OfSP9jqtT2jXw2Ka021TT5ofS7oTS7kZpd6qmzavupe1fo7Rr4LFNabepps0Ppd2JmjY/lHanatqcUNr9NUq7Bh7blHabatr8UNq9Smn3Q2l3qqbNiXtp+5co7Rp4bFPabapp85vS7hVKux9Ku1M1bU4p7f4SpV0Dj21Ku001bX5T2r1CafdDaXeqps2pe2n7VyjtGnhsU9ptqmnzm9LuGaXdb0q7UzVt3qG0+yuUdg08tintNtW0qWraPKO0+01pd6qmzbuUdn+B0q6Bxzal3aaaNpXS7hGl3W9Ku1M1bd6ltPsLlHYNPLYp7TbVtKmUdvco7Sql3amaNh1Ku6tT2jXw2Ka021TTplLa3aO0q5R2p2radCjtrk5p18Bjm9JuU00bUdqJ0q5S2p2qadOltLsypV0Dj21Ku001bURpVyntRGl3qqZNl9LuypR2DTy2Ke021bQRpV2ltBOl3amaNp+gtLsqpV0Dj21Ku001be5R2v2mtBOl3amaNp+gtLsqpV0Dj21Ku001be5R2v1W0+Yepd2pmjaforS7IqVdA49tSrtNNW3uUdr9UNrdo7Q7VdPmU5R2V6S0a+CxTWm3qabNIzVtfijt7lHanapp80lKu6tR2jXw2Ka021TT5hGl3Y3S7h6l3amaNp+ktLsapV0Dj21Ku001bR5Rnd0jSrtTNW0+TWl3JUq7Bh7blHabato8ojq7R5R2p2rafJrS7kqUdg08tintNtW0eUa9s3lGaXeqps0Epd1VKO0aeGxT2m2qafOMOvn+KqXdqZo2E5R2V6G0a+CxTWm3qabNM+rk+6uUdqdq2kxR2l2B0q6Bxzal3aaaNq9Qr3w7obQ7VdNmitLuCpR2DTy2Ke021bR5hXp0f4fS7lRNm0lKu29T2jXw2Ka021TT5hXq0f0dSrtTNW0mKe2+TWnXwGOb0m5TTZtXvZrevkJpd6qmzTSl3Tcp7Rp4bFPabapp86pX09tXKO1O1bSZdi9tv0Vp18Bjm9JuU02bV72S3r1KaXeqps0Gpd23KO0aeGxT2m2qaXPiWXrzKqXdqZo2G+6l7Tco7Rp4bFPabappc+JZevMqpd2pmjZblHbfoLRr4LFNabepps2JR2l/Qml3qqbNlntpu01p18Bjm9JuU02bE4/S/oTS7lRNm01Ku21KuwYe25R2m2ranLqXtieUdqdq2my6l7ablHYNPLYp7TbVtDmltDultDtV02ab0m6T0q6Bxzal3aaaNqeUdqeUdqdq2mxT2m1S2jXw2Ka021TT5h01bU7VtHlHTZtvqGmzSWnXwGOb0u5fMfX/m/p3r+hK/1elXQOPbUq7iCtS2jXw2Ka0i7gipV0Dj21Ku4grUto18NimtIu4IqVdA49tSruIK1LaNfDYprSLuCKlXQOPH1HTJuKKato08fgxP+lbxJX9pG8fwGNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbEmP/893/f80bLRIOECQAAAABJRU5ErkJggg==",name:dt("可移除衬垫")},{typeName:pn.RemovablePadding2,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAADHCAYAAAB7oJ2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAakSURBVHhe7dPLrhtXEkVB//9PuxvwQH7ElX2OkiWKuRYQk+QuoAbF3/7f70lehsckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3i8UvUJ6dv+ATweq/qk9I1f4vFY1Selb/wSj8eqPil945d4PFb1Sekbv8TjMaVd8m6Udpd4PKa0S96N0u4Sj8eUdsm7Udpd4vGY0i55N0q7SzweU9pt9TPSe+SflHaXeDymtNvoZ6d3yjdKu0s8HlPabfRO6f22U9pd4vGY0m6jd0zvuZXS7hKPx5R2GyntJpyk5zdS2l3i8ZjSbiOl3aT/kp7bSGl3icdjSruNlHav8r2030Zpd4nHY0q7jZR2r/ZV2m6itLvE4zGl3UZKuyco7TZR2l3i8ZjSbiOl3RO+StstlHaXeDymtNtIafcUpd0WSrtLPB5T2m2ktHvKV2m7gdLuEo/HlHYbKe2epLTbQGl3icdjSruNlHZPUtptoLS7xOMxpd1GSrunKe0+ndLuEo/HlHYbKe2eprT7dEq7SzweU9ptpLR7mtLu0yntLvF4TGm3kdLuaUq7T6e0u8TjMaXdRkq7pyntPp3S7hKPx5R2Gyntnqa0+3RKu0s8HlPabaS0e5rS7tMp7S7xeExpt5HS7mlKu0+ntLvE4zGl3UZKu6cp7T6d0u4Sj8eUdhsp7Z70Vdp+OqXdJR6PKe02Uto9SWm3gdLuEo/HlHYbKe2epLTbQGl3icdjSruNlHZPUdptobS7xOMxpd1GSrunKO22UNpd4vGY0m4jpd0TvkrbLZR2l3g8prTbSGn3al+l7SZKu0s8HlPabaS0e6Xvpf0mSrtLPB5T2m2ktHuFf0vPbKO0u8TjMaXdRkq7Kf81PbuR0u4Sj8eUdhu9Y3rPrZR2l3g8prTb6N3SO26mtLvE4zGl3Ubvkt4t/cF+eT8zvU/+Sml3icdjSruNfkZ6j5jS7hKPx5R2Gynt/quv0jb/Tml3icdjSruNlHYnlHb5d0q7SzweU9ptpLQ78VXa5vuUdpd4PKa020hpd0ppl+9T2l3i8ZjSbiOl3amv0jZfU9pd4vGY0m4jpd0NpV2+prS7xOMxpd1GSrsbX6VtTGl3icdjSruNlHa3lHYxpd0lHo8p7TZS2t36Km3zT0q7SzweU9ptpLT7EUq7/JPS7hKPx5R2GyntfsRXaZu/Utpd4vGY0m4jpd2PUtrlr5R2l3g8prTbSGk3QWmXb5R2l3g8prTbSGk3QWmXb5R2l3g8prTbSGk3RWmXPyjtLvF4TGm3kdJuitIuf1DaXeLxmNJuI6XdJKVd+oP98pR2k5R26Q/2y1PaTVPabae0u8TjMaXdRkq7aUq77ZR2l3g8prTbSGn3Ckq7zZR2l3g8prTbSGn3Ckq7zZR2l3g8prTbSGn3Kkq7rZR2l3g8prTbSGn3Kkq7rZR2l3g8prTbSGn3Skq7jZR2l3g8prTbSGn3Skq7jZR2l3g8prTbSGn3akq7bZR2l3g8prTbSGn3akq7bZR2l3g8prTbSGn3BKXdJkq7SzweU9ptpLR7gtJuE6XdJR6PKe02Uto9RWm3hdLuEo/HlHYbKe2eorTbQml3icdjSruNlHZPUtptoLS7xOMxpd1GSrsnKe02UNpd4vGY0m4jpd3TlHafTml3icdjSruNlHZPU9p9OqXdJR6PKe22+nP6/Wf5c/p9A6XdJR6PKe2Sd6O0u8TjMaVd8m6Udpd4PKa0S96N0u4Sj8eUdsm7Udpd4vGY0i55N0q7SzweU9ol70Zpd4nHY0q75N0o7S7xeOzvaZO8q7+nzSUek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpP8sN9+/x86HHd2B1To+QAAAABJRU5ErkJggg==",name:dt("可移除衬垫")},{typeName:pn.DurableLiner,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADMCAYAAAAceR0nAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAgjSURBVHhe7dLBjsNGDETB/P9PJ9HBgEGUbMlc7hoz/YC6UD03/fN//0bEr+MxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbx+CNSWiX93008tqW0UvrHm3hsS2ml9I838diW0krpH2/isU1pF/GNato08dimtIv4RjVtmnhsU9pFfKOaNk08tintIr5RTZsmHtuUdqt7pG/f5pG+7aamTROPbUq7ldW0+RY1bXZS06aJxzal3cqUdt9AabeLmjZNPLYp7VamtPsGSrtd1LRp4rFNabcypd1fO0vbXdS0aeKxTWm3MqXdXztL213UtGnisU1pt7KztP1LZ2m7i5o2TTy2Ke1Wdpa2f+VV2u+ipk0Tj21Ku5Wdpe1feZX2u6hp08Rjm9JuZa/S/i+8Svtd1LRp4rFNabeyV2n/296lN7uoadPEY5vSbmWv0v63vUtvdlHTponHNqXdyt6lN7/pXXqzi5o2TTy2Ke1W9i69+U3v0ptd1LRp4rFNabeyd+nNb7mS3u2ipk0Tj21Ku5VdSe9+w5X0bhc1bZp4bFParexKevcbrqR3u6hp08Rjm9JuZVfSu2lX09td1LRp4rFNabeyK+ndtKvp7S5q2jTx2Ka0W1lNt6P6btrV9HYXNW2aeGxT2q2spttRfTdJvbrvqqZNE49tSruV1XQ7qu8mqVf3XdW0aeKxTWm3strZ/ej53ST16r6rmjZNPLYp7VZWO7sfPb+bVDu7Hz2/201NmyYe25R2K6ud3Y+e301RV77tqKZNE49tSruV1V59O3r+PkFd+bajmjZNPLYp7VZWe/Xt6Pn7BHXl245q2jTx2Ka0W1nt1bej5+8/Td35vpuaNk08tintVla7+/0nqTvfd1PTponHNqXdymrvvh/VzU9Rd77vpqZNE49tSruV1d59P6qbn6A+2eykpk0Tj21Ku5XV3n0/qpufoD7Z7KSmTROPbUq7ldWubI6061CfbHZS06aJxzal3cpqVzZH2n1KdXa7qGnTxGOb0m5ltSubI+0+pTq7XdS0aeKxTWm3spo2B6XdJ1Rnt4uaNk08tintVlbT5qC0+0RNm4PSbhc1bZp4bFParaymzUFpd5fS7qC020VNmyYe25R2K6tp86C0u0Npd1Da7aKmTROPbUq7ldW0eVDa3aG0OyjtdlHTponHNqXdymraPCjtrlLaPSjtdlHTponHNqXdymraPKtpc5XS7kFpt4uaNk08tintVlbT5pnS7gql3YPSbhc1bZp4bFParaymzTOl3TtKu2dKu13UtGnisU1pt7KaNs+Udu8o7Z4p7XZR06aJxzal3cpq2lRKu1eUds+UdruoadPEY5vSbmU1bSql3RmlXaW020VNmyYe25R2K6tpUyntzijtKqXdLmraNPHYprRbWU0bUdqJ0q5S2u2ipk0Tj21Ku5XVtBGlnSjtKqXdLmraNPHYprRbWU0bUdpVSjtR2u2ipk0Tj21Ku5XVtDlT06ZS2onSbhc1bZp4bFParaymzRml3TOlnSjtdlHTponHNqXdymranFHaPSjtzijtdlHTponHNqXdymranFHaPSjtzijtdlHTponHNqXdymravKK0OyjtzijtdlHTponHNqXdymravKI6u1eUdruoadPEY5vSbmU1bV5Rnd0rSrtd1LRp4rFNabeymjbvqE827yjtdlHTponHNqXdymravKPeber3K5R2u6hp08Rjm9JuZTVt3lF3vl+ltNtFTZsmHtuUdiuraXOFuvLtDqXdLmraNPHYprRbWU2bK9SVb3co7XZR06aJxzal3cpq2lyhXt0/obTbRU2bJh7blHYrq2lzVU23o/ruKqXdLmraNPHYprRbWU2bq66mt1co7XZR06aJxzal3cpq2lx1Jb27Smm3i5o2TTy2Ke1WVtPmqivp3VVKu13UtGnisU1pt7KaNne8S2+uUtrtoqZNE49tSruV1bS541Xa36G020VNmyYe25R2K6tpc8ertL9DabeLmjZNPLYp7VZW0+aus7S9Q2m3i5o2TTy2Ke1WVtPmrrO0vUNpt4uaNk08tintVlbT5i6l3V1Ku13UtGnisU1pt7KaNp+oaXNXTZud1LRp4rFNabe6R/r2qef0/VPP6ftOato08dimtIv4RjVtmnhsU9pFfKOaNk08tintIr5RTZsmHtuUdhHfqKZNE49tSruIb1TTponHNqVdxDeqadPEY5vSLuIb1bRp4vFHPKfvEd+qpk0TjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIgx//z7H//k+3DTA6wPAAAAAElFTkSuQmCC",name:dt("持久衬垫")},{typeName:pn.VFlangedEdgeSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAI8AAACZCAYAAAAW7GkVAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAARYSURBVHhe7cvRbh03EERB//9POwmNGIpTI1HS3V2S0weol2Hzx9/9jPgiHiNm8Bgxg8eIGTxGzOAxYgaPETN4jJjBY8QMHiNm8Bgxg8eIGTxGzOAxYgaPETN4jJjB40u9Te/xPW/T+4V4fBmlXXyN0u4iPL5MlbbxOVXaXoTHl1Laxeco7S7E40tVaRtzqrS9EI8vV6VtfExpdzEeL6G0i/cp7W7A4yWqtA2r0vYGPF6mStv4P6XdTXi8lNIu/qtK25vweKkqbeOXKm1vxOPllHbxi9LuZjxerkrb7qq0vRmPt6jStjOl3QN4vI3Sriul3UN4vE2Vtt1UafsQHm9VpW0nSrsH8Xg7pV0XVdo+iMfbVWl7uiptH8bjI5R2p1PaLYDHR1Rpe6oqbRfA42OqtD2R0m4RPD5KaXcapd1CeHxUlbanqNJ2ITw+rkrbEyjtFsPjEpR2u6vSdjE8LqFK211VabsgHpehtNuV0m5RPC6jStvdVGm7KB6XUqXtTpR2C+NxOUq7XSjtFsfjcqq0XV2VtovjcUlV2q5MabcBHpeltFtVlbYb4HFZVdqupkrbTfC4NKXdapR2G+FxaVXarqJK243wuLwqbVegtNsMj1tQ2j1NabchHrdQpe1TqrTdEI/bqNL2CUq7TfG4FaXd3aq03RSPW6nS9i5V2m6Mx+0o7e6itNscj9up0vZqVdpujsctVWl7JaXdAXjcltLuKkq7Q/C4rSptX61K20PwuLUqbV9JaXcQHrentHuVKm0PwuP2qrT9riptD8PjEZR236W0OxCPR6jS9quqtD0Qj8eo0vYrlHaH4vEoSrvPUtodjMejVGk7q0rbg/F4nCptZyjtDsfjkZR2H6nS9nA8HqlK20qVtg3weCylXUVp1wSPx6rS9k9V2jbB49GqtH1LadcIj8dT2v1LadcMj8er+u62GR5bqJrZ/blpisc21Efv//R20xiPbVR99BYDj62o9+7xG4+tfCb9b4zHdmbSv+Z4bOm9tA8fW3ov7cPHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsbW36T1+4zFiBo8RM3iMmMFjxAweI2bwGDGDx4gZPEbM4DFiBo8RH/jx8y+Pl33WETfr+QAAAABJRU5ErkJggg==",name:dt("带顿边V型焊缝")},{typeName:pn.UFlangedEdgeSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJIAAACfCAYAAAAS5YBQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAATXSURBVHhe7c7bbgM3EETB/P9PJwQTBAlRK3tmL5TsPkC9jJpr/zH6M+ICPEZU8RhRxWNEFY8RVTxGVPEYUcVjRBWPEVU8RlTxGFHFY0QVjxFVPEZU8RhRxWNEFY8RVTxGVPEYUcVjRBWPEVU8tvw3/R77rWnTxGPLmjax15o2TTyWKe1irzVtmngsU9rFXmvaNPFYprSLvda0aeKxTGkXe61p08RjmdIu9lrTponHMqVd7LWmTROPZUq72GtNmyYey5R2sdeaNk08lintYq81bZp4LFPaxV5r2jTxWKa0i73WtGnisUxpF3utadPEY5nSLvZa06aJxzKlXey1pk0Tj2VKu9hrTZsmHsuUdrHXmjZNPJYp7WKvNW2aeCxT2sVea9o08VimtIu91rRp4rFMaRd7rWnTxGOZ0i72WtOmiccypV3staZNE49lSrvYa02bJh7LlHax15o2TTyWKe1irzVtmngsU9rFXmvaNPFYprSLvda0aeKxTGkXe61p08RjmdIu9lrTponHMqVd7LWmTROPZUq72GtNmyYey5R2sdeaNk08lintYq81bZp4LFPaxV5r2jTxWKa0i73WtGnisUxpF3utadPEY8uaNrHXmjZNPLasaRN7rWnTxGPLmjaxj9KuiccWpV3sobRr4rFFaRd7KO2aeGxR2sUeSrsmHluUdrGH0q6JxxalXeyhtGvisUVpF3so7Zp4bFHaxR5r2pzAY5vSLp6ltDuBxzalXTxLaXcCj21Ku3iW0u4EHtuUdvGsNW1O4vEUpV08Q2l3Eo+nKO3iGUq7k3g8RWkXz1DancTjaUq7uJfS7gI8nqa0i3sp7S7A42lHaRv3OErbC/B4CaVd3ENpdxEeL3GUtnGto7S9CI+XUdrFtZR2F+LxMkq7uM5R2l6Ix0sp7eIaSruL8Xipo7SNc47S9mI8Xk5pF+co7W7A4+WO0jZ6jtL2Bjze4ihto+YobW/C422UdvF9R2l7Ix5vc5S28T1HaXsjHm91lLbx2lHa3ozH2x2lbdhR2j6Ax9u9Svv4v6O0fQiPj3iV9vG3V2n/EB4f8yrtf7tXaf8gHh/1Ku1/q1dp/zAeH/cq7X+bV2m/AY9bvEr73+JV2m/C4zav0v4n+yq92YjHrb5Kb36ar9KbzXjc7qv05qf4Kr15Azy+ja/Sm0/1VXrzRnh8K99J7z7Fd9K7N8Pj2/luevuuvpveviEe39Z309t38d309o3x+NYq6f0ulfT+zfH4ETrpO3fppO98CB4/Sjd964wz6XsfhsePdEdPfv/D8fjR3j39zz8Ajz/GO6X/7wfh8cd6Mv39H4zHX+PK9P1fhMcYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHuMf/02/x794jKjiMaKKx4gqHiOqeIyo4jGiiseIKh4jqniMqOIxoorHiII//vwLaaN9R7Ov7yUAAAAASUVORK5CYII=",name:dt("带顿边U型焊缝")},{typeName:pn.SingleVFlangedEdgeSeam,img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJkAAACdCAYAAACnzdqsAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAASxSURBVHhe7dJBctRAEERR7n9pgyEAk/zpmrFLyi4pf8Tb5FRr4fC3H71FHAzHiE44RnTCMaITjhGdcIzohGNEJxwjOuEY0QnHiE44RnTCMaITjhGdcIzohGNEJxwjOuEY0QnHiE44RnTCMaITjhGdcIzohOM23qM9vu7Evy2OdhrdxOdpdNMIRzuNbuJ1j6LbRjjaaXQTr1lF941wtNPoJp63iu6b4Win0U08ZxXdHwBHO41uYq2K3hwERzuNbuKxKnpzIBztNLoJVkVvDoajnUY38b9VdH8SHO00uom/qujNiXC00+gmfqmiNyfD0U6jmxjxD/YORzuNbu5uFd0b4Win0c1dVdEbMxztNLq5oyp6swEc7TS6uZsqerMJHO00urmTVXS/GRztNLq5gyp6syEc7TS6uboqerMpHO00urmyKnqzMRztNLq5qlV0PwCOdhrdXE0VvRkCRzuNbq6kit4MgqOdRjdXUUVvhsHRTqObK1hF90PhaKfRzWRV9GYwHO00upmqit4Mh6OdRjcTVdGbC8DRTqObaVbR/YXgaKfRzRRV9OZicLTT6GaCKnpzQTjaaXSzuyp6c1E42ml0s7NVdH9xONppdLOjKnpzAzjaaXSzmyp6cxM42ml0s5MqenMjONppdLOLVXR/QzjaaXTjVkVvbgpHO41unKrozY3haKfRjUsVvbk5HO00unFYRffxE452Gt2cqYrexB842ml0c5YqehP/wNFOo5szVNGb+A+OdhrdHG0V3cdDONppdHOUKnoTSzjaaXRzhCp6EyUc7TS66VZFb+IpONppdNNpFd3HS3C00+imQxW9iZfhaKfRzVdV0Zv4FBztNLr5iip6E5+Go51GN5+1iu7jy3C00+jmVVX0JlrgaKfRzSuq6E20wdFOo5tnVdGbaIWjnUY3z1hF93EIHO00ulmpojdxGBztNLp5pIrexKFwtNPohlTRmzgcjnYa3ahVdB+nwdFOo5vfquhNnApHO41u3lXRmzgdjnbaMzcavQkLHO206veP6W3Y4WinPdq1j9+IbeBop9Gm6TdiGzjavRp9I7aBo92z0dvYDo52z0TvYks42lXRm9gWjnar6D62hqMdRXcxAo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg4buFj9HuMgWNEJxwjOuEY0QnHiE44RnTCMaITjhFNvr19B8xBuQucEkh1AAAAAElFTkSuQmCC",name:dt("带顿边单边V型焊缝")},{typeName:pn.SingleUFlangedEdgeSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAACmCAYAAADNhf3/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAShSURBVHhe7c1bbmNHFATB2f+mx4YBA7YQ1LzUaiZVCcTPYTXvt7/7PvNJeJw5gceZE3icOYHHmRN4nDmBx5kTeJw5gceZE3icOYHHmRN4nDmBx5kTeJw5gceZE3icOYHHmRN4nDmBx5kTeJw5gcest2lT89/0ewiPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSruSt2kTwmOS0q7kbdqE8JiktCt5mzYhPCYp7Urepk0Ij0lKuwqlXQiPSUq7CqVdCI9JSrsKpV0Ij0lKu4q3aRPDY5LSrkBpF8NjktKuQGkXw2OS0q5AaRfDY5LSrkBpF8NjktLu2SntgnhMUto9O6VdEI9JSrtn9ihtg3hMUto9M6VdFI9JSrtnprSL4jFJafeslHZhPCYp7Z6V0i6MxySl3TNS2sXxmKS0e0ZKuzgek5R2z+ZR2sbxmKS0eyaP0vYF8JiktHsmSrsXwWOS0u5ZPErbF8FjktLuWSjtXgiPSUq7Z/AobV8Ij0lKu9sepe2L4TFJaXfTo7R9QTwmKe1ueZS2L4rHJKXdDe+l/YviMUlp99neS/sXxmOS0u4zvZf2L47HJKXdZ3kv7b8AHpOUdp/hvbT/InhMUtqd9l7afyE8JintTnov7b8YHpOUdif8KL35gnhMUtp9tB+lN18Uj0lKu4/yo/Tmi+MxSWn3p34mvRsfk5R2v+tn09v5B49JSrtf9bPp7fwPj0lKu5/xK+n9EI9JSrtHfif9zzzEY5LS7l9/kv5vfojHpNPpm/NLeEw6lb41v4XHpI9O35g/wmPSn6T/mw/HY9KvpPdzHI9JSru5hsckpd1cw2OS0m6u4TFJaTfX8JiktJtreExS2s01PCYp7eYaHpOUdnMNj0lKu7mGxySl3VzDY5LSbq7hMUlpN9fwmKS0m2t4TFLazTU8Jint5hoek5R2cw2PSUq7uYbHJKXdXMNjktJuruExSWk31/CYpLSba3hMUtrNNTwmKe3mGh6TlHZzDY9JSru5hsckpd1cw2OS0m6u4TFJaTfX8JiktJtreExS2s01PCYp7eYaHpOUdnMNj0lKu7mGx6y3aTPX8Jj1Nm3mGh5nTuBx5gQeZ07gceYEHmdO4HHmBB5nTuBx5gQeZ07gceYEHmdO4HHmBB5nTuBx5gQeZ07gceYEHmdO4HHmBB5nPti3738BHyoaKTaEOZ4AAAAASUVORK5CYII=",name:dt("带顿边单边U型焊缝")},{typeName:pn.EndWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAACiCAYAAADC8hYbAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAZbSURBVHhe7coxamBBEENB3//S3g2NqFB8RDMPKunWz/9+n2cAj8/zNR6f52s8Ps/XeHyer/H4PF/j8Xm+xuPzfI3H5/kaj8/zNR6f52s8Ps/XeHyer/H4PF/j8Xm+xuPzfI3H5/kaj8/zNR6f52s8Ps/XeJyXadOQadPyN/2P43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8Tjvb/q3ZNq0/E3/43h8nq/x+Dxf4/F5vsbj83yNx+f5Go/P8zUen+drPD7P13h8nq/x+Dxf4/F5vsbj83yNx+f5Go/P8zUen+dDP7//AH3T0OK7CueMAAAAAElFTkSuQmCC",name:dt("端接焊缝")},{typeName:pn.SurfacingJoint,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKYAAACfCAYAAABz/aISAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAHxSURBVHhe7dKxbQNBAANB9d+0rAIWf/cRHQyBSTbm57cv/EMZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlvGK2dPqMy9kPDK7WX3nUsYjs5vVdy5lvGL2tPrMCxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYyXjF7Wn3mhYxHZjer71zKeGR2s/rOpYxHZqfVb17IeM2sVl95KSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEYY+3z/ZxhhVTz23HAAAAABJRU5ErkJggg==",name:dt("堆焊接头")},{typeName:pn.BottomSeamWeld,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACpCAYAAACyCQZWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAOhSURBVHhe7dJZiuRIFAXR2v+ma6AoaGhz1xCSwiTZhfNjPBeZED9+72dyQxgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzETR4y+m00w5rdvjf6W/A/G1zGP/t5wfLw7j/6fF8L4SE8c/Z8vgfFRjhx9/xNHjr7/YBhv79PRN6/0yeh7D4TxtvaOvmWyd/Sth8B4O1tH37iLPaPv3BzG29gyen93W0ffuCmMeltG759oy+j9zWDUWjt6+xZrR29vBKPSmtG7t1o7ensDGFXWjN7lrzWjd3IYNZZGb8LWjN5JYfy6NaN3WbY0eiOE8auWRm+yzZrROxGMX7M0epP9lkZvJDBebmn0JsdYGr0RwHippdGbHG82uv8yjJeZje5zrqXRmy/BeInZ6D7XWBq9+QKMp5uN7nO92ej+YhhPNRvd53tmo/sLYTzNbHSf75uN7i+C8RSz0X08ZqP7C2A83Gx0H5/Z6P5kGA81G93HazS6PRnGw8xG9/EbjW5PhPEQs9F97mM0uj0JxkOMRre5n9Ho9gQYPzYa3ea+RqPbg2H8yGh0m3ubje4PhHG30eg2zzAa3R4I4y6j0W2eZTS6PQjGXUaj2zzPaHR7AIybjUa3eS4a3R0A42Y0usuzjUa3H8K4yWh0m+cbjW4/gHG10eg270Gjuw9gXI1Gd3mX0eh2J4yrjEa3eR8a3e2EcRUa3eW9aHS3A8ZFNLrLu9HobgeMi2h0l9DobiOMUzS6S/6g0d1GGKdodJf8Q6O7DTAO0egu+S8a3W2Acai1I0e/sZUwotaOHv3OVsKIWjt69DtbCeNQa0eOfmMrYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOYiP34+Qvm+ETtbiRVRQAAAABJRU5ErkJggg==",name:dt("封底焊缝")},{typeName:pn.FilletWeld,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAWNSURBVHhe7dLRduPWEURR//9PO+MkSsbyVouSWCAaqLPWfmkW+HT/+NWfVYvxWLUFj1Vb8Fi1BY9VW/BYtQWPVVvwWLUFj1Vb8Fi1BY9VW/BYtQWPVVvwWLUFj1Vb8Fi1BY9VW/BYtQWPVVvwWLUFj1Vb8HiYv9K96kE8HuJ92lR9gse4j9K2asBj3JT2VR/gMe6z9E0V8Bj3SPqu6h0e4x5N31b9hse4r6Tvq/6Lx7ivpv+o+oXHOPXR/a33/1H1C49xavrtrd//o+oXHuPUZ7+/9fuubo/HOPXI5q3327otHuPUo7u3tK/b4TFOafeXKe3rVniMU9q9mdK+boPHOKXd76a0r1vgMU5p996U9nV5PMYp7WRK+7o0HuOUdh+Z0r4ui8c4pd1kSvu6JB7jlHafmdK+LofHOKXdI6a0r0vhMU5p96gp7esyeIxT2n3FlPZ1CTzGKe2+akr7Wo/HOKXdd0xpX6vxGKe0+64p7WstHuOUdj8xpX2txGOc0u6nprSvdXiMU9o9w5T2tQqPcUq7Z5nSvtbgMU5p90xT2tcKPMYp7Z5tSvs6PR7jlHYJU9rXqfEYp7RLmdK+TovHOKVd0pT2dUo8xint0qa0r9PhMU5pd4Qp7etUeIxT2h1lSvs6DR7jlHZHmtK+ToHHOKXd0aa0r5fjMU5p9wpT2tdL8RintHuVKe3rZXiMU9q90pT29RI8xintXm1K+zocj3FKuzOY0r4OxWOc0u4sprSvw/AYp7Q7kynt6xA8xintzmZK+4rjMU5pd0ZT2lcUj3FKu7Oa0r5ieIxT2p3ZlPYVwWOc0u7sprSvp+MxTmm3wZT29VQ8xinttpjSvp6Gxzil3SZT2tdT8BintNtmSvv6MR7jlHYbTWlfP8JjnNJuqynt69t4jFPabTalfX0Lj3FKu+2mtK8v4zFOaXcFU9rXl/AYp7S7iint62E8xintrmRK+3oIj3FKu6uZ0r4+xWOc0u6KprSvEY9xSrurmtK+PsRjnNLuyqa0L+IxTml3dVPa1z/wGKe0u4Mp7etveIxT2t3FlPb1PzzGKe3uZEr7+jce45R2dzOlffkYp7S7oyntb47HOKXdXU1pf2M8xint7mxK+5viMU5pd3dT2t8Qj3FKu+oj/gSPcUq7+o8p7W+ExzilXf3flPY3wWOc0q7+bkr7G+AxTmlX/zSl/cXxGKe0K5vS/sJ4jFPa1cemtL8oHuOUdjWb0v6CeIxT2tXnprS/GB7jlHb1mCntL4THOKVdPW5K+4vgMU5pV18zpf0F8BintKuvm9J+OR7jlHb1PVPaL8ZjnNKuvm9K+6V4jFPa1c9Mab8Qj3FKu/q5Ke2X4TFOaVfPMaX9IjzGKe3qeaa0X4LHOKVdPdeU9gvwGKe0q+eb0v7keIxT2lXGlPYnxmOc0q5yprQ/KR7jlHaVNaX9CfEYp7SrvCntT4bHOKVdHWNK+xPhMU5pV8eZ0v4keIxT2tWxprQ/AR7jlHZ1vCntX4zHOKVdvcaU9i/EY5zSrl5nSvsX4TFOaVevNaX9C/AYp7Sr15vS/mA8xint6hymtD8Qj3FKuzqPKe0PwmOc0q7OZUr7A/AYp7Sr85nSPozHOKVdndOU9kE8xint6rymtA/hMU5pV+c2pX0Aj3FKuzq/Ke2fjMc4pV3tMKX9E/EYp7SrPaa0fxIe45R2tcuU9k/AY5zSrvaZ0v6HeIxr903v4Qd4jGv3Tm/im3iMa/dOb+KbeDxEu296D9/E4yHaPdNb+AEeq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqsW+OPPfwEO3L8pilDAyQAAAABJRU5ErkJggg==",name:dt("角焊缝")},{typeName:pn.GrooveWeldSeam,img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALwAAAC7CAYAAADfTPQTAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAARxSURBVHhe7dIxaiVADAVB3//SXk+w8DGVSZHcDZW8UThfP30nfwjH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMVxTdU0/asBjmuqpulfDXBcUzVN/2qA45qqafpXAxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3y3+90M8Bx1Wd6Tz59pvchjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+Sgr+9/dULPl8OKWbkAAAAASUVORK5CYII=",name:dt("塞焊缝或槽焊缝")},{typeName:pn.SpotWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOoAAADXCAYAAAAUcM09AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAeDSURBVHhe7dPbjhY3FAXhvP9Lk0AgIj9l98nTXtuukr6breVmBmn++qdvkuLhUVIWPErKgkdJWfAoKQseJWXBo6QseJSUBY+SsuBRUhY8SsqCR0lZ8CgpCx4lZcGjpCx4lJQFj5Ky4FFSFjxKyoJHSVnwKCkLHiVlwaOkLHiUlAWPkrLgUVIWPErKgkdJWfAoKQseFehp9E2VgUdNMiP6ORQHj3pJavSzaio86otUjX4XvQqPGmi16HfUl8OjHhoZff+u0dG/oS+BR93wNPrmm55E39NQeNQFd6NvpXgSfU+P4VEnXI2+UcWd6Du6DY/quBp9o7Kr0Td0GR4FrkTvV3Mleq9L8KjfXIne7+Bs9Fan4FE/nY3e7uhs9FZdeNze2eitzv3/0Ts14XFrZ6J3+tOZ6J3+gMctnYne6dhR9Eb/g8ftHEVvdM2Z6J1+wONWjqI3uu8oeiM+bqMX7TXGUfRmc3hc3lH0RuP1ov3G8Li0o+iNvs5R9GZDeFxWL9rrHUfRm83gcUm9aK/39aL9RvC4nF601zy9aL8JPC6lF+01Xy/abwCPy+hFe+XoRfvF4XEJvWivPL1ovzA8lteL9srVi/aLwmNpvWivfK1ouyg8ltaKtqqjFW0XhMeyWtFW9bSi7WLwWFIr2qquVrRdCB7LaUVb1deKtovAYymtaKs1tKLtIvBYSivaah2taLsAPJbRirZaTyvaFofHElrRVuuiaFccHkugaKe1taJtYXiM14q2Wl8r2haFx2itaKt9ULQrCo/RKNppL61oWxAeY7WirfZD0a4gPMaiaKd9UbQrBo+RKNppbxTtisFjJIp2EkW7QvAYh6Kd9B1Fu0LwGIeinfQLRbsi8BiFop30u1a0LQCPUSjaSZ8o2hWAxxgU7SRC0a4APMagaCe1ULQLh8cYFO2kFop24fAYgaKd1NOKtsHwGIGinXSEol0wPE5H0U46g6JdMDxOR9FOOouiXSg8TkfRTjqLol0oPE5F0U66gqJdKDxORdFOuoqiXSA8TkXRTrqKol0gPE71GW2kOyjaBcLjNBTtpDso2gXC4zQU7aS7KNqFweM0FO2kuyjahcHjNJ/RRnqCol0YPE5B0U56gqJdGDxOQdFOeuoz2oTB4xQU7aSnKNoFweMUFO2kpyjaBcHjFBTtpKco2gXB4xSf0UYagaJdEDy+jqKdNAJFuyB4fB1FO2mUz2gTBI+vo2gnjfIZbYLg8XUU7aRRKNqFwOPrKNpJo1C0C4HH11G0k0ahaBcCj6+jaCeNQtEuBB5fR9FOGoWiXQg8dpnZ+ehv6AY8NpnZtejv6AY8NpnZtejv6AY8dpnZ+ehv6AY8vo6inTQKRbsQeHwdRTtpFIp2IfD4Oop20igU7ULg8XUU7aRRKNqFwOPrKNpJo1C0C4HH11G0k0b5jDZB8Pg6inbSKJ/RJggeX0fRThqBol0QPE7xGW2kESjaBcHjFJ/RRhqBol0QPE5B0U56iqJdEDxOQdFOeoqiXRA8TkHRTnrqM9qEweMUFO2kpz6jTRg8TvMZbaQnKNqFweM0FO2kuyjahcHjNBTtpLso2oXB4zQU7aS7PqNNIDxO9RltpDso2gXC41QU7aSrKNoFwuNUFO2kqyjaBcLjVBTtpCso2oXC43QU7aSzKNqFwuN0FO2ksyjahcLjdBTtpDMo2gXDYwSKdtIRinbB8BiBop10hKJdMDxGaEVbqYWiXTg8xqBoJ7VQtAuHxxgU7SRC0a4APEahaCd9omhXAB6jULSTfteKtgXgMQ5FO+kXinZF4DEORTvpu1a0LQKPkSjaSRTtCsFjJIp22lsr2haCx1gU7bQvinbF4DFWK9pqP61oWwweo1G0015a0bYgPEZrRVvtg6JdUXiM14q2Wl8r2haFxxIo2mltrWhbGB5LaEVbrYuiXXF4LKMVbbWeVrQtDo9ltKKt1tKKtgvAYymtaKs19KL9AvBYTivaqr5WtF0EHktqRVvV1Yq2C8FjWa1oq3pa0XYxeCyrFW1VSyvaLgiPpbWirWroRfsF4bG8VrRVtl60XxQel9CKtsrUi/YLw+MyWtFWWXrRfnF4XEor2ipDL9pvAI/L6UV7zdOL9pvA45J60V7v60X7jeBxWb1or/f0ov1m8Li0XrTX1zqK3mwIj8s7it5ovKPozabwuIWj6I3G6UX7zeFxK0fRG913FL0RH7dzFL3RdUfRG/2Axy2did7p2Jnonf6Dx60dRW/EzkTv9Ac8bu9M9E7/Ohu9FcKjfjoTvdvV2eituvCo35yN3u7iSvReh/AocCV6v6Ir0Xudhkd1XIneV3c1+oYuw6NOuBp9o5Kr0Td0Gx51wZ3oO2nuRt/SY3jUDU+i783wJPqehsGjHhgZfX+EUdG39SXwqEFWjX5XfSk86gtUj34nvQaPekF69DNrGjxqgtnRz6QYeFSQkdH3VQIeJWXBo6QseJSUBY+SsuBRUhY8SsqCR0lZ8CgpCx4lZcGjpCx4lJQFj5Ky4FFSFjxKyoJHSVnwKCkLHiVlwaOkLHiUlAWPkrLgUVIWPErKgkdJWfAoKcZf3/4GIK9JdCFPKLgAAAAASUVORK5CYII=",name:dt("点焊缝")},{typeName:pn.FoldingInterface,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACtCAYAAAApmERAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAATfSURBVHhe7dLhjts6DAXhvv9L9xbForjrjBw7S5GUPAN8fw6ooNn0159+SwvCUeoOR6k7HKXucJS6w1HqDkepOxyl7nCUusNR6g5HqTscpe5wlLrDUeoOR6k7HKXucJS6w1HqDkepOxyl7nCUusNR6g5HqTscpe5wlLrDMZT9LPqbiscwNjf6mz8EjmEsN/oNNoVjGKuJfovN4BjK6qLfYxM4qqmfRJ+3MBy1iLvRZywKRy3qavR2MThqcVeidwvBUZu4Er1bAI7azLvoTXM4akPvojeN4aiNnUX3TeGozZ1F9w3hqAc4i+6bwVEPcRbdN4KjHuQsum8CRz3MKLptAkc90Ci6bQBHPdQoui2Gox5sFN0WwlEPNopuC+GohxtFt0VwlL7+q36P7orgKH39V32NbgvgKP1F0V0BHKW/RtFtMhylfyi6S4aj9M8ouk2Eo/QNRXeJcJS+oeguEY7Si2N0kwhH6QVFd0lwlF5QdJcER+kFRXdJcJTQMbpJgqOEKLpLgKOEKLpLgKOEKLpLgKOEKLpLgKOEKLpLgOMjdI/+zdUoukuA41ZWjr5PJYruEuC4tJ2i71ftGN0kwHE5u0bftRJFdwlwXMbO0fetRtFdAhzb+zT6LF1H0V0CHNu6G32GPkfRXQIcW7oavVUMiu4S4NjOleidYlF0lwDHNq5E7zQHRXcJcGzhXfRGc1F0lwDHcu+iN5qLorskOJY6i+6Vg6K7JDiWOYvulYeiuyQ4lhhFt8p3jG4S4ZhuFN0qH0V3iXBMNYpuVYOiu0Q4phlFt6oxim4T4ZiGojvVoeguGY4pRtGtaoyi22Q4TjeKblWHorsCOE5H0Z1qUXRXAMepRtGt6lB0VwTHqSi6U51RdFsEx2koulMtiu4K4TgNRXeqM4puC+E4BUV3qjOKbovhOAVFd6oxim4bwDEcRXeqMYpum8AxHEV3yncW3TeBYziK7pTrLLpvBMdQFN0p11l03wyOoSi6U56z6L4hHENRdKccZ9F9UziGOkY3mu9d9KYxHMNQdKe53kVvmsMxDEV3muNK9G4BOIah6E6xrkTvFoJjGIruFONq9HYxOIah6E6fuxO9XxSOYY7Rje75NPqsheEY5hjddLBz9H03gGOYY3RTbcfoe24GxzDH6KbSbtF33BSOYY7RTbWVo+/zEDiGOUY3HXSP/s0Ph2OYY3QjfQDHMBTdSTfhGIaiO+kmHMNQdCfdhGMYiu6km3AMQ9GddBOOoY7RjXQTjqEoupNuwDEURXfSDTiGouhOugHHcBTdSRfhGI6iO+kiHMNRdCddhOMUFN1JF+A4BUV30gU4TkPRnfQGjtNQdCe9geNUFN1JJ3CcahTdSgM4TkfRnTSA43Sj6FYCOKYYRbfSAY5pKLqTDnBMM4pupf/BMdUoupW+4JhuFN1Kf+BYYhTd6vFwLHMW3euxcCx1Ft3rkXAsdxbd63FwbOFd9EaPgWMbV6J32h6O7VyJ3mlbOLZ0NXqr7eDY1t3oM7QFHNv7NPosLQnHZVht9JskwXE5Vhf9HglwXJrlRr9BAhy3YnOjv3kCHB/Bfh79XZPgKHWHo9QdjlJ3OErd4Sh1h6PUHY5SdzhK3eEodYej1B2OUnc4St3hKHWHo9QdjlJ3OErd4Sh1h6PUHY5SdzhKjf36/R9vDJRU5LBTnQAAAABJRU5ErkJggg==",name:dt("折叠接口")},{typeName:pn.InclinedInterface,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAK0AAAC3CAYAAABg4t6+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAWfSURBVHhe7cpbjhxXDERB73/TtmAIwngclObR1c2blQeIHzL/+tHfVYfhsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxHuxt+id6nzZfxGM9kNIuidLui3isB5nSNonS7ot4rAdR2iWZ0vaLeKwHmNI2idLuG3isB1DaJZnS9ht4rG+a0jaJ0u6beKxvUtolmdL2m3isb5jSNonS7gF4rG9Q2iWZ0vYBeKwvmtI2idLuQXisL1LaJZnS9kF4rC+Y0jaJ0u6BeKwvUNolmdL2gXisT5rSNonS7sF4rE9S2iWZ0vbBeKxPmNI2idLuAjzWJyjtkkxpewEe64OmtE2itLsIj/VBSrskU9pehMf6gCltkyjtLsRjfYDSLsmUthfisf5gStskSruL8Vh/oLRLMqXtxXis35jSNonS7gl4rN9Q2iWZ0vYJeKzBlLZJlHZPwmMNlHZJprR9Eh4LprRNorR7Ih4LlHZJprR9Ih7rnSltkyjtnozHekdpl2RK2yfjsd6Y0jaJ0u4FeKw3lHZJprR9AR7rpyltkyjtXoTH+klpl2RK2xfhsX6Y0jaJ0u6FeKwflHZJprR9IR5vb0rbJEq7F+Px9pR2Saa0fTEeb21K2yRKuwV4vDWlXZIpbRfg8bamtE2itFuCx9tS2iWZ0nYJHm9pStskSrtFeLwlpV2SKW0X4fF2prRNorRbhsfbUdolmdJ2GR5vZUrbJEq7hXi8FaVdkiltF+LxNqa0TaK0W4rH21DaJZnSdikeb2FK2yRKu8V4vAWlXZIpbRfjMd6UtkmUdsvxGE9pl2RK2+V4jDalbRKl3QF4jKa0SzKl7QF4jDWlbRKl3SF4jKW0SzKl7SF4jDSlbRKl3UF4jKS0SzKl7UF4jDOlbRKl3WF4jKO0SzKl7WF4jDKlbRKl3YF4jKK0SzKl7YF4jDGlbRKl3aF4jKG0SzKl7aF4jDClbRKl3cF4jKC0SzKl7cF4PN6UtkmUdofj8XhKuyRT2h6Ox6NNaZtEaReAx6Mp7ZJMaRuAx2NNaZtEaReCx2Mp7ZJMaRuCxyNNaZtEaReExyMp7ZJMaRuEx+NMaZtEaReGx+Mo7ZJMaRuGx6NMaZtEaReIx6Mo7ZJMaRuIx2NMaZtEaReKx2Mo7ZJMaRuKxyNMaZtEaReMxyMo7ZJMaRuMx/WmtE2itAvH43pKuyRT2objcbUpbZMo7W6Ax9WUdkmmtL0BHtea0jaJ0u4meFxLaZdkStub4HGlKW2TKO1uhMeVlHZJprS9ER7XmdI2idLuZnhcR2mXZErbm+FxlSltkyjtbojHVZR2Saa0vSEe15jSNonS7qZ4XENpl2RK25vicYUpbZMo7W6MxxWUdkmmtL0xHl9uStskSrub4/HllHZJprS9OR5fakrbJEq78vGllHZJprQtH19mStskSrv6F48vo7RLMqVt/YvHl5jSNonSrn7h8SWUdkmmtK1feHy6KW2TKO3qP3h8OqVdkilt6z94fKopbZMo7ep/eHwqpV2SKW3rf3h8miltkyjtinh8GqVdkilti3h8iiltkyjtasTjUyjtkkxpWyMeLzelbRKlXf0Wj5dT2iWZ0rZ+i8dLTWmbRGlXf8TjpZR2Saa0rT/i8TJT2iZR2tWH8HgZpV2SKW3rQ3i8jNIuidKuPozHy7xPmzRKu/owHi/zPm0SvU3/+hQeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHquW+uvvfwAguGJAxsc1MAAAAABJRU5ErkJggg==",name:dt("倾斜接口")},{typeName:pn.SpotWeldSeamOffset,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADaCAYAAAA149drAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAeMSURBVHhe7dNJbiA3EAXRvv+lbTc8oF0dZA3J5BgBvE3isyQt9OOv/pCUAo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwqEGi0Tc1DB6VZHT0OykNHtXIzNHvq6bwqI9Wjv4eheBRL+wa/a16BY+60TL6fgutom/rETyqIBJ9r7dI9D1V4VEXX6NvzeRr9C39Bo/6x9voG6v4En1H/8Hj8d5E73fwJnovPh7pbfSNHb2J3h8Mj8d5Gr09xZvo/YHweIyn0dtTPY3eHgaPR3gSvdPfnkTvDoLH7d1Fb8SeRO8OgMdt3UVv9Mxd9GZzeNzSXfRG7zyJ3m0Kj1u5i94o5i56syE8buMueqM2nkTvNoLHLdxFb9TeXfRmE3hcXi3aK9dd9GYDeFxaLdqrn1q0Xxwel1WKthqjFu0XhscllaKtxqpF+0XhcTmlaKs51KL9gvC4lFK01Vxq0X4xeFxGKdpqTrVovxA8LqEUbTW3WrRfBB6nV4q2WkMt2i8Aj1MrRVutpRRtF4DHaZWirdZUiraTw+OUStFWaytF24nhcUqlaKv1laLtpPA4nVK01R5K0XZSeJxKKdpqL6VoOyE8ToWinfZUiraTweM0StFW+6JoNxk8TqEUbbW3UrSdCB6nQNFOZyhF20ngcbhStNU5KNpNAo9DlaKtzlKKthPA41AU7XSmUrQdDI/DlKKtzkXRbjA8DkPRTmcrRduB8DhEKdpKFO0GwuMQFO2knyjaDYTH7krRVvoXRbtB8NgdRTvpVxTtBsFjV6VoK11RtBsAj11RtJMIRbsB8NgVRTuphKJdZ3jshqKdVEPRrjM8dkPRTrpD0a4jPHZB0U56gqJdR3jsgqKd9ARFu47w2AVFO+kpinad4DEdRTvpDYp2neAxHUU76Q2Kdp3gMR1FO+ktinYd4DHdNdpIX1C06wCPqSjaSV9QtOsAj6ko2klfULTrAI+pKNpJX1G0S4bHNBTtpAiKdsnwmIainRRB0S4ZHtNQtJOirtEmGR7TULSToijaJcJjCop2UgsU7RLhMQVFO6kFinaJ8JiCop3UAkW7RHhMQdFOaoGiXSI8pqBoJ7VA0S4RHlNQtJNauUabRHhMQdFOauUabRLhMQVFO6mVa7RJhMcUFO2kVijaJcFjimu0kVqiaJcEjymu0UZqiaJdEjymuEYbqSWKdknw2BxFO6klinZJ8NgcRTupJYp2SfDYHEU7qSWKdknw2BxFO6klinZJ8NgcRTupJYp2SfCY4hptpJYo2iXBY4prtJFaomiXBI8prtFGaomiXRI8pqBoJ7VC0S4JHlNQtJNauUabRHhMQdFOauUabRLhMQVFO6kFinaJ8JiCop3UAkW7RHhMQdFOaoGiXSI8pqBoJ7VA0S4RHlNQtJNaoGiXCI9prtFGaoGiXSI8pqFoJ0VRtEuExzQU7aQIinbJ8JiGop0UQdEuGR5TUbSTvqJolwyPqSjaSV9do00HeExF0U76gqJdB3hMRdFO+oKiXQd4TEfRTnqLol0HeExH0U56g6JdJ3hMR9FOeoOiXSd47OIabaQ3KNp1gscuKNpJT1G06wSPXVC0k56gaNcRHrsoRVvpDkW7jvDYDUU7qYaiXWd47KYUbaUSinad4bErinYSKUXbzvDYFUU7iVC0GwCP3VG0k35VirYD4LE7inbSryjaDYLHISjaST+Vou0geByCop30E0W7gfA4DEU7iaLdQHgchqKdzkbRbjA8DkXRTmcqRdvB8DhUKdrqPBTtJoDH4Sja6SylaDsBPA5XirY6QynaTgKPUyhFW+2Pot1E8DiNUrTVvkrRdiJ4nEYp2mpPpWg7GTxOpRRttZdStJ0QHqdTirbaRynaTgiPU6Jopz2Uou2k8DilUrTV2krRdmJ4nFYp2mpNpWg7OTxOrRRttZZatJ8cHqdWi/ZaQy3aLwCP06tFe82tFu0Xgccl1KK95lSL9gvB4zJq0V5zqUX7xeBxKbVorznUov2C8LicWrTXWLVovyg8LqkW7TVGLdovDI/LqkV79VWL9ovD49LuojfKV4v2G8Dj8u6iN8pxF73ZBB638CR6p3buojcbweNW7qI3inkSvdsMHrdzF73RN3fRm03hcVt30Rs98yR6tzE8bu0ueqO6u+jNAfC4vSfRO/3fk+jdIfB4jKfR25M9id4dBo9HeRO9P8nT6O2B8HikN9H7nb2J3h8Kj0d7E73fxdvoG4fDo/7yNvrGit5E7/UfPOoXX6LvzOpL9B39Bo8Ckeh7o0Si76kIj6poEX03UzT6pm7hUQ9lRz/zXz2in6vH8KgPdoj+Ln2GRzWwSvS7qwk8qrGZot9PKfCoTrKjn6lu8KgJ+c+yHDxKisOjpDg8SorDo6Q4PEqKw6OkODxKisOjpDg8SorDo6Q4PEqKw6OkODxKisOjpDg8SorDo6Q4PEqKw6OkODxKisOjpDg8Sgr58cefJsbWo2zdXpgAAAAASUVORK5CYII=",name:dt("点焊缝（偏移中心）")},{typeName:pn.SeamWeld,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAASkAAAEWCAYAAAA6tWH6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAmsSURBVHhe7dNZDtxGEARR3f/SsmzAsEVFc5lpklXZEcD7SVRTCzA/fvVTkgrDUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUdr1bfRNaQBHLapa9HfUcnDUIjpFf38tAUcFS4n+bYqEo4KsEv3bFQFHNXZX9GfNcFf0Z6klHNXMrOjbb5oRfVet4Kgmvo2+Wdk30ffUAo4q7tPoW519Gn1LZeGooq5G30j1SfQdlYOjirkSvV/Rlei9ysBRRVyJ3sv/wwA46mVXovf605XovV6Do15yJXqvY1ei93ocjnrYlei9rjsbvdWjcNSDzkTvNMfZ6K0egaMechS90X2Ooje6HY662VH0Rs84E73TbXDUjY6iN3reUfRGt8BRNziK3uhdZ6J3mgpHTXYUvVEdR9EbTYOjJjkTvVM9R9EbTYGjJjiK3qi+o+iNvoKjvnQUvVEfR9EbfQxHfWEvuldPR9EbfQRHfWgvuld/e9G9LsNRHxhFt8qyF93rEhx10Si6Vaa96F6n4agLRtGtsu1F9zoFR500im61hr3oXodw1Amj6FZr2YvutQtHHRhFt1rTXnSvIRy1YxTdam170b0QjhoYRbfS3/aie/0BR4FRdCv93150r9/gOJWZZUe/+4lwnMrM8qPf/iQ4TmVm+dFvfxIcpzKz/Oi3PwmO05lZbvSbnwjH5Y2iW+lTFN0tDsflUXQnfWMU3S4Mx6WNolvpW6PodlE4LmsU3UqzjKLbBeG4LIrupJlG0e2CcFzSKLqVZhtFt4vBcTmj6Fa6yyi6XQiOSxlFt9LdKLpbCI5LGUW30t1G0e0icFzGKLqVnjKKbheA4zIoupOeRtHdAnBcAkV30htG0W04HJdA0Z30ForuwuEYj6I76U2j6DYYjvEoupPeRtFdMByjjaJb6W0U3QXDMRpFd1IVFN2FwjHWKLqVqqDoLhSOsSi6k6qh6C4QjpFG0a1UDUV3gXCMRNGdVBVFd2FwjDOKbqWqKLoLg2Mciu6k6ii6C4JjHIrupOoouguCYxSK7qQORtFtCByjUHQndUHRXQgcY1B0J3VC0V0IHGNQdCd1Q9FdABxjUHQndUPRXQAcY1B0J3VD0V0AHCNQdCd1RNFdABwjUHQndUXRXXM4RqDoTuqKorvmcIywjW6kzii6aw7H9ii6k7rbRjfN4dgeRXdSdxTdNYZjexTdSd1RdNcYju1toxspAUV3jeHYGkV3UoptdNMYjq1RdCeloOiuKRxbo+hOSkHRXVM4tkXRnZSEorumcGyLojspzTa6aQrHtii6k9Jso5umcGyLojspDUV3DeHYFkV3UhqK7hrCsS2K7qQ0FN01hGNbFN1JaSi6awjHtii6k9JQdNcQjm1toxspEUV3DeHY1ja6kRJRdNcQjm1toxspEUV3DeHYEkV3UqptdNMQji1RdCel2kY3DeHYEkV3UqptdNMQji1RdCelouiuGRxbouhOSkXRXTM4TmVm2dHvfiIcpzGz/Oi3PxGO05hZfvTbnwjHacwsP/rtT4TjdGaWGf3eJ8OxJYrupFTb6KYhHFui6E5KtY1uGsKxJYrupFTb6KYhHNvaRjdSIoruGsKxrW10IyWi6K4hHNvaRjdSIoruGsKxLYrupDQU3TWEY1sU3UlpKLprCMe2KLqT0lB01xCObVF0J6Wh6K4hHNui6E5KQ9FdQzi2RdGdlIaiu4ZwbIuiOynNNrppCse2KLqT0myjm6ZwbG0b3UhJKLprCsfWKLqTUlB01xSOrVF0J6Wg6K4pHFuj6E5KQNFdYzi2R9Gd1B1Fd43h2B5Fd1J3FN01hmN7FN1J3VF01xiO7VF0J3VG0V1zOEag6E7qiqK75nCMQNGd1BVFd83hGIGiO6mrbXQTAMcY2+hG6oiiuwA4xqDoTuqGorsAOMag6E7qhqK7ADjGoOhO6mYb3YTAMQpFd1IXFN2FwDEKRXdSFxTdhcAxyii6laqj6C4IjnEoupOqo+guCI5xKLqTKqPoLgyOkSi6k6qi6C4MjpEoupMqGkW3YXCMRdGdVA1Fd4FwjEXRnVTJKLoNhGM0iu6kKii6C4VjNIrupApG0W0oHONRdCe9jaK7YDjGo+hOehtFd8FwjDeKbqW3UHQXDsclUHQnvYWiu3A4LmEU3UpPo+huATgug6I76Umj6HYBOC5jFN1KT6HobhE4LmUU3Up3G0W3i8BxOaPoVrrLKLpdCI7LGUW30l0oulsMjksaRbfSbKPodjE4LmsU3UqzjKLbBeG4NIrupBlG0e2icFzaKLqVvkXR3cJwXN4oupU+NYpuF4ajfqHoTvrEKLpdHI5TmVl29LufCMepzCw/+u1PguNUZpYf/fYnwXEqM8uPfvuT4DidmWVGv/fJcBTYi+6lf+1F9/oNjhrYi+6lvehef8BRO/aie61rL7oXwlEH9qJ7rWcvutcQjjphL7rXOvaie+3CUSftRffKtxfd6xCOumAvuleuvehep+Coi/aie+XZi+51Go76wF50rxx70b0uwVEfOoreqK+j6I0uw1FfOIreqJ+j6I0+gqO+dBS9UQ9nonf6GI6a5Ch6o7qOojf6Go6a6Ch6o1rORO80BY6a7Ez0Tu87it5oKhx1k6Pojd5zFL3RdDjqRmeid3rOUfRGt8FRDziK3uh+R9Eb3QpHPeRM9E5znY3e6nY46mFnonf6ztnorR6Do15wJXqv865E7/UoHPWiK9F7jV2J3usVOKqAK9F7/edK9F6vwlGFXIner+xK9F4l4KiCrkTvV3E1+oZKwVGFfRJ9J8kn0XdUEo5q4Jvoe518E31PpeGoRmZE363k2+ibagNHNTUj+u7TZkXfVjs4KsBT0Z9Nnor+bLWGowKlRv9WRcFR4TpH/x5Fw1GLqR79nbUMHKV/PB39HbQ8HKWPbKMb6SIcJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJamAHz//AmoSckzD+QH2AAAAAElFTkSuQmCC",name:dt("缝焊缝")},{typeName:pn.SeamWeldOffset,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAARsAAAD/CAYAAADBj3IBAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAhKSURBVHhe7dTLrhvJFQVR//9Pt+WGbaipKBYfh7xk5gpgTTZOlqQB9a9f/QXwBjkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI/x1rbqHEzmyqJ+o/h5sKUcW8mnV35Et5MgX+7bq38CScuSLrFT9+1hGjny4V1Z/3jWvqv4svlqOfKhnq2++2kT1Xb5OjnyYR6tv/bRnqu/xNXLkQzxSfeeTPVJ9h4+XIz/snur9N7unes/HypEfcG/1jZXcU73n4+TIG91TvV/dPdV7PkaOvMmt1dvd3Fq95SPkyBvcUr3b3a3VW35UjrzQLdU7/nRWveHH5MiLnFVvuO6W6h1vlyPDbqnecbuz6g1vlSODzqo3POaW6h1vkSNDzqo3PO+sesPL5ciTzqo3zDqr3vBSOfKEs+oNr3OtuudlcuRB16p73uNadc9L5MgDrlX3vNe16p5xOXKna9U9P+eoumVUjtzhWnXPzzuqbhmTIze6Vt3zOY6qW0bkyA2uVfd8nqPqlqflyIlr1T2f66i65Sk5csW16p7Pd1Td8rAcOXCtuud7HFW3PCRHDhxVt3yfo+qWu+VIOKpu+V5H1S13yZELR9Ut36+qO+6SI785qm5Zw1F1y81y5DdH1S3rOKpuuUmO/NdRdct6qrrjJjnyy1F1y5qOqltO5cgvVd2xtqPqlqty3N5Rdcv6jqpbDuW4taPqlj0cVbccynFrVd2xl6PqlpTjto6qW/ZT1R0px21Vdce+qrrjDzluqao79lbVHX/IcUtV3UFVd/xDjtup6g7+o6o7/iHH7VR1B/9T1R3/l+NWqrqD31V1x//luJWq7uBSVXf8LcdtVHUHpao7/pbjNqq6g3JU3dLjFo6qWzhS1R09bqGqO7jmqLrdXI6nJK1d/e6flOMpSetXv/0n5HiVpD2q3/8Tcjwlaf3qt/+EHG8iac3q9z4gx6VVdQf3uqxuNpbj0qq6g3tVdbepHJdV1R08oqq7TeW4rKru4BFV3W0qx2VVdQePqupuQzkuq6o7eFRVdxvKcUlV3cEzqrrbUI5LquoOnlHV3YZyXFJVd/Csqu42k+OSLqsbmFDV3WZyXNJldQMTqrrbTI7LqeoOJlR1t5kcl1PVHUyo6m4zOS6nqjuYclndbCbH5VR1B1Muq5vN5Licqu5gymV1s5kcl1PVHUyp6m4jOS6nqjuYUtXdRnJcTlV3MKWqu43kuJzL6gYmVXW3kRyXc1ndwKSq7jaS43IuqxuYVNXdRnJcSlV3MKmqu43kuJSq7mBSVXcbyXEpVd3BpKruNpLjci6rG5hU1d1GclzOZXUDk6q620iOy7msbmBSVXcbyXE5Vd3BlKruNpLjcqq6gylV3W0kx+VUdQdTqrrbSI7LqeoOplxWN5vJcTlV3cGUy+pmMzkup6o7mHJZ3Wwmx+VUdQcTqrrbTI7LqeoOJlR1t5kcl1PVHUyo6m4zOS7psrqBCVXdbSbHJVV1B8+q6m4zOS6pqjt41mV1s6Ecl1TVHTyjqrsN5bisy+oGnlHV3YZyXFZVd/Coqu42lOOyqrqDR1R1t6kcl1XVHTyiqrtN5bi0qu7gXlXdbSrHpVV1B/eq6m5TOS6tqju4R1V3G8txaVXdwT2quttYjsur6g5uVdXdxnJcXlV3cIuq7jaX4/KOqls4U9Xd5nLcQlV3cKaqu83luIWq7uCaqu7ocRtV3cGRqu7ocRtV3UGp6o6/5XgTSWtWv/cBOZ6StH71239CjldJ2qP6/T8hx1OS1q9++0/I8ZSktavf/ZNy3FJVd+ztqLrlH3Lc0lF1y76quuMPOW6rqjv2dFTd8occt3VU3bKXo+qWlOPWjqpb9lHVHYdy3N5Rdcv6jqpbDuXIL1Xdsbaj6parcuSXo+qWdVV1x6kc+a+j6pb1HFW3nMqR31R1x1qOqltukiO/OapuWcNRdcvNcuTCUXXL96vqjrvkSDiqbvleR9Utd8mRcK265/scVbfcLUcOXKvu+R5H1S0PyZErrlX3fL6j6paH5ciJa9U9n+uouuUpOXKDa9U9n+eouuVpOXKja9U9n+OoumVEjtzhWnXPzzuqbhmTI3e6Vt3zc46qW0blyAOuVfe831F1y7gcedC16p73uFbd8xI58oSz6g2vc62652Vy5Eln1RtmnVVveKkcGXBWvWHGWfWGl8uRQWfVGx53Vr3hLXJk2Fn1hvucVW94qxx5kbPqDefOqje8XY680C3VO/50S/WOH5EjL3Zr9Rb/yXypHHmTW6u3O7q1esuPy5E3uqd6v7p7qvd8jBz5AfdU71dzb/UNPkqO/KB7qvff7p7qPR8rRz7AI9V3vsG91Tf4eDnyQZ6pvvcJHq2+xdfIkQ/1TPW9d3m2+iZfJ0c+3HT1Z9zrFdWfw9fKkS+yWvVvZAk58qW+sfp3sKQcWcSnVn9Xlpcji/qp6u/CdnJkY/dU7+FAjgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5Agz611//Bmp8EmEmP0iZAAAAAElFTkSuQmCC",name:dt("缝焊缝（偏离中心）")},{typeName:pn.SteepVWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALkAAACyCAYAAAAeam6fAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAVgSURBVHhe7dJLbhhHEERB3f/Ssi0DEigGIYrkdNcnHxCbQq6m59u/fY8YjseISXiMmITHiEl4jJiEx4hJeIyYhMeISXiMmITHiEl4jJiEx4hJeIyYhMeISXiMmITHiEl4jJiEx4hJeIyYhMeISXiMmITHiEl4jJiEx4hJeHzUf+ke8xR5ax4f83vaxAy/p80hPD5CaRf9Ke0O4fERSrvoT2l3CI+PUdpFX0q7g3h8jNIu+lLaHcTjY5R20ZfS7iAeH6W0i36Udofx+CilXfSjtDuMx8cp7aIXpd1hPD5OaRd9KO0u4PFxSrvoQ2l3AY9HKO2iB6XdBTweobSL+pR2l/B4hNIu6lPaXcLjMUq7qE1pdwmPxyjtoi6l3UU8HqO0i7qUdhfxeJTSLupR2l3G41FKu6hHaXcZj0cp7aIepd1lPB6ntIs6lHYF8Hic0i7qUNoVwOMVSruoQWlXAI9XKO3iPqVdETxeobSL+5R2RfB4jdIu7lLaFcHjNUq7uEdpVwiP1yjt4h6lXSE8XqW0izuUdoXweJXSLs5T2hXD41VKuzhPaVcMj9cp7eIcpV1BPF6ntItzlHYF8Xid0i7OUdoVxGMJSrt4ntKuKB5LUNrF85R2RfFYhtIunqW0K4rHMpR28RylXWE8lqG0i+co7QrjsRSlXTxDaVcYj6Uo7eLrKe2K47EUpV18PaVdcTyWo7SLr6W0K47HcpR28XWUdg3wWI7SLr6O0q4BHktS2sXnKe2a4LEkpV18ntKuCR5LUtrF5yntmuCxLKVdfJzSrhEey1Laxccp7RrhsTSlXXyM0q4RHktT2sXfU9o1w2NpSrv4e0q7ZngsT2kXf0dp1wyP5Snt4v2Udg3xWJ7SLt5PadcQjy0o7eJ9lHYN8diC0i7+TGnXFI8tKO3iz5R2TfHYhtIu3qa0a4zHNpR28TalXWM8tqG0i7cp7RrjsRWlXbymtGuOx1aUdvGa0q45HttR2sVLSrvmeGxHaRe/KO0G4LEdpV38orQbgMeWlHbxP6XdADy2pLSLdd+Kx5aUdpGfvDWl3XZKuyF4bEtpt5nSbhAe21Labaa0G4TH1pR2GynthuGxNaXdRkq7YXhsTWm3kdJuGB7bU9ptorQbiMf2lHabKO0G4nEEpd0WSruBeBxBabeB0m4oHkdQ2m2gtBuKxzGUdtMp7YbicQyl3WRKu8F4HENpN5nSbjAeR1HaTaW0G4zHUZR2EynthuNxFKXdREq74XgcR2k3idJuAR7HUdpNorRbgMdxlHaTKO0W4HEkpd0ESrsleBxJaTeB0m4JHsdS2nWntFuCx7GUdp0p7RbhcSylXWdKu0V4HE1p15XSbhEeR1PadaS0W4bH0ZR2HSntluFxPKVdN0q7ZXgcT2nXidJuIR7HU9p1orRbiMcVlHYdKO2W4nEFpV0HSruleFxBadeB0m4pHtdQ2lWmtFuMxzWUdpUp7RbjcRWlXVVKu8V4XEVpV5HSbjkeV1HaVaS0W47HdZR21SjtluNxHaVdJUq78HEdpV0lSrvwcSWlXRVKu/BxJaVdBUq7+IHHlZR2FSjt4gce11La3aS0i594XEtpd5PSLn7icS2l3U1Ku/iJx9WUdjco7eIFHldT2t2gtIsXeFxPaXea0i5e4HE9pd1JSrt4hcfy0pn07RvisbR0Nr1BMzyWls6mN2iGx9LS2fQGzfBYXjqXvn8zPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEEN++/wNOQL1V0LJ5GQAAAABJRU5ErkJggg==",name:dt("陡侧V型坡口堆焊")},{typeName:pn.none,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:dt("清除"),isChecked:!0}]),i=k.reactive([{typeName:pn.FirstPlaneSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJ8AAACfCAYAAADnGwvgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAHcSURBVHhe7dGxDQJBAANB+m8aKGCje2Gk01iaZFO/vnvDn2SEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCxmN29+rzBzIes/tXvx/KeMzuX/1+KOMxu3v1+QMZH7E7V18/lBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZ4cde7w9ec2Vfw1YpGgAAAABJRU5ErkJggg==",name:dt("第一种平面符号")},{typeName:pn.SecondConcaveSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAACZCAYAAAA4qUiHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMSSURBVHhe7c9LcttAFMVQ73/TTiapuBI0xR/IpoRbdSbQa8n++r3v5CIYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8ZNfo4+z/P8HH2+E8ZN/h3d5DlodLcDxtVGo9vMbzS63QHjJjS6y/xodLcTxk1Go9vMazS63QnjZqPRbeYzGt0egHEXGt1lPjS6OwjjLqPRbeYxGt0ehHG30eg29xuNbk+A8ZDR6Db3otHdSTAeMhrd5j6j0e1JMB42Gt3meqPR7YkwnmI0us11RqPbk2E8zWh0G9/S6P5kGE+zNLqPZ2l0L8B4qqXRfc63NLqXYDzd0ug+51ka3YswKpZG9zluaXQvw6hZGt1nv6XR/QUwqpZG99luaXR/EYy6pdF91lsa3V8I4yWWRvd5bWl0fzGMl3k1epP/vRq9uQHGS70avclfr0ZvboLxcmtG7z7ZmtG7G2G8zavRm0/0avRmAhhvtWb07hOsGb2bBMYprBm9e0drRu8mg3Eaa0dv38Ha0dsJYZzO2tHbJ9oyej8pjFPaMnr/BFtG7yeHcWpbR98xk62j73gIjI+wd/RdV9o7+q6Hwfg4R0bfd6ajo+98KIyPZYx+5ydj9DtvAOPjPXX0v7wRjG9n1tHf+sYwvrW7R3/Th8D4UezRb34ojBn4M/osL2FMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPG5GRf378A7t91CbVjKP8AAAAASUVORK5CYII=",name:dt("第二种凹面符号")},{typeName:pn.SecondConvexeSymbol,img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAACUCAYAAAAQ0fKrAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAL8SURBVHhe7dHBjtswFMXQ/v9PT7ttS9lJLNOywwucDfFkZNpff/aTLABjYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwJjaMiQ1jYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwJjaMiQ1jYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwJjaMiQ1jYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwZuDT0bfyF4xfzR79hi+E8ausNvqNXwDj491l9NsfCuMj3X30Nz0Ixkc5OvrmETNG3705jLd3ZPS9Mx0Zfe+mMN7WJ6PvXOmT0XduBuPtvDN6v7J3Ru9vAuNtvDN6fyfvjN4vDuMtvDp6e2evjt4uDOPSXh29fZJXR28XhHFZr4zePdkro3eLwbikvdGbb/LK6N0iMC5lb/Tmm+2N3iwA4zL2Rm9yy383jJfbG73J//ZGby6C8VJ7ozcZ2xu9uQDGy+yN3mTf3uiNDOMltkb3ed/W6F6EUbc1us/ntkb3EoyqrdF9jtsa3QswarZG95lna3R/MoyKrdF95tsa3Z8Io2I0us15RqPbE2E83Wh0m/ONRrcnwXiq0eg2ntHo9gQYTzMa3cY3Gt1OhvE0NLrLdWh0NxnGU4xGt7nOaHQ7EcbpRqPbXG80up0E43Q0uss6aHQ3CcapRqPbrGM0up0A4zSj0W3WMxrdHoRxGhrdZV00ujsI4xSj0W3WNRrdHoBxChrdZX00ujsA42E0ust90OjuQxin+Hd0k/v4d3RzAMZpTvjBudhJ/6cYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYE9Gvn98b42oiTSRi9wAAAABJRU5ErkJggg==",name:dt("第二种凸面符号")},{typeName:pn.SecondPlaneSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKYAAACmCAYAAABQiPR3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAO2SURBVHhe7dJbTh1BEARR9r9pjC1kYRwkF5jp7EekdH5C9VlPL3uWJoRRasMotWGU2jBKbRilNoxSG0apDaPUhlFqwyi1YZTaMEptGKU2jFIbRqkNo9SGUWrDKLVhlNowSm0YpTaMUhtGqQ2j1IZRasMotWGU2jBKbRilNoxSG0apDaPUhlFqwyi1YZTaMF7u/ehGegPj5Wh0J73CeLmPRrfSC4yXS6N7HQ/jLdLoXkfDeJs0utexMN4qje51JIy3S6N7HQfjEGl0r6NgHCaN7nUMjEOl0b2OgHG4NLrX9jBWpNG9toaxJo3utS2MVWl0ry1hrEuje20H4xTS6F5bwTiNNLrXNjBOJY3utQWM00mjey0P45TS6F5LwzitNLrXsjBOLY3utSSM00ujey0H4xLS6F5LwbiMNLrXMjAuJY3utQSMy0mje00P45LS6F5Tw7isNLrXtDAuLY3uNSWMy0uje00H4xbS6F5TwbiNNLrXNDBuJY3uNQWM20mje9Vh3FIa3asK47bS6F41GLeWRveqwLi9NLrXcBiPkEb3GgrjMdLoXsNgPEoa3WsIjMdJo3vdDuOR0uhet8J4rDS6120wHi2N7nULjMdLo3tdDqNepNG9LoVRr9LoXpfBqDfS6F6XwKh30uheP4ZRII3u9SMY9YE0ute3YVSQRvf6Foz6RBrd68sw6gFpdK8vwagHpdG9HoZRX5BG93oIRn1RGt3rUxj1DWl0rwijvimN7vUhjPqBNLoXwqgfSqN7/QejLpBG9/oHRl0kje71F0ZdKI3u9QdGXSyN7sVRN0ij+8Nh1E3S6P5gGHWjNLo/FEbdLI3uD4RRA6TR/WEwapA0uj8IRg2URveHwKjB0uj+ABhVkEb3m8OokjS63xhGFaXR/aYwqiyN7jeEURNIo/vNYNQk0uh+Ixg1kTS63wRGTSaN7jeAURNKo/vFYdSk0uh+YRg1sTS6XxRGTS6N7heEUQtIo/vFYNQi0uh+IRi1kDS6XwRGLSaN7heAUQtKo/vJYdSi0uh+Yhi1sDS6nxRGLS6N7ieEURtIo/vJYNQm0uh+Ihi1kTS6nwRGbSaN7ieAURtKo/syjNpUGt0XYdTG0ui+BKM2l0b3BRh1gDS6HwyjDpFG9wNh1EHS6H4QjDpMGt0PgFEHSqP7m2HUoT4a3d4Mow72fnQzAEap+ZS/YZTaMEptGKU2jFIbRqkNo9SGUWrDKLVhlNowSm0YpTaMUhtGqQ2j1IZRasMotWGU2jBKRU/PvwBx2jYpMoLBBAAAAABJRU5ErkJggg==",name:dt("第二种平面符号")},{typeName:pn.FirstConvexeSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAACDCAYAAACqaHhbAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAK3SURBVHhe7c3bjtNAFERR/v+nhwGBBNGy4yTu9qWqpPWyc9r58b2visdYWRgrC2NlYawsjJWFsbIwVhbGysJYWRgrC2NlYawsjJWFsbIwVhbGysJYWRgrC2NlYawsjJWFsbIwVhbGysJYWRgrC2NlYawsjLv6NfU6DcbdvDt9q4Zh3MWe0/drN4y7GDn9X72NcTezpv+uzRiHGzX9Vz3FeLhPp2/WIsZTenf6Vv2H8RJenb5RvzFeyqvTN8IxXtbW6W0wxsvbOr0NxHgrW6Z3QRhvZ8v0LgTjbW2Z3t0c4+09m97cGGOEZ9Obm2KMsjbd3xBjnGfTmxthjLU23d8EY7S16f4GGOOtTfcXx1jf1qb7C2OsP9am+4tirH+sTfcXxFiwNN1eDGPB2nR/IYy1YGm6vRDGWrE03V4EYz2xNN1eAGNtsDTdnhxjbbQ03Z4YY71A092JMdYLlqbbk2KsFy1NtyfEWG/QdHdCjPWGpen2ZBjrTZruToaxPqDp7kQY6wNL0+1JMNaHNN2dBGN9aGm6PQHG2oGmuxNgrB0sTbcHY6ydaLo7GGPtRNPdwRhrR5ruDsRYO9J0dyDG2pmmu4Mw1s403R2EsXam6e4gjDWAprsDMNYAmu4OwFgDaLo7AGMNouluMsYaRNPdZIw1iKa7yRhrEE13kzHWQJruJmKsgTTdTcRYA2m6m4ixBtJ0NxFjDabpbhLGGkzT3SSMNZimu0kYazBNd5Mw1mCa7iZhrME03U3CWINpupuEsQbTdDcJYw2m6W4SxprgcbqZhLEmeJxuJmGsCR6nm0kYa4LH6WYSxprgcbqZhLEm+Tv9NhFjZWGsLIyVhbGyMFYWxsrCWFkYKwtjZWGsLIyVhbGyMFYWxsrCWFkYKwtjZWGsLIyVhbGyMFYWxsrCWFkYKwtjxfjx9ROiaSHTn3voRQAAAABJRU5ErkJggg==",name:dt("第一种凸面符号")},{typeName:pn.none,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:dt("清除"),isChecked:!0},{typeName:pn.ThirdPlaneSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAACdCAYAAAA33qNjAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAOZSURBVHhe7cpRTl1BDARR9r9pgiISEVIND7jja89US+en7KeXPUsNYJSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYdSB3o7ui2HUYWj0txBGHSSNfhfCqEOk0e9iGHWANPotgFGbS6PfIhi1sTT6LYRRm0qj32IYtaE0+r0BRm0mjX5vglEbSaPfG2HUJtLo92YYtYE0+m0Ao4ZLo98mMGqwNPptBKOGSqPfZjBqoDT6bQijhkmj36YwapA0+m0Mo4ZIo9/mMGqANPodAKOaS6PfITCqsTT6HQSjmkqj32EwqqE0+h0Io5pJo9+hMKqRNPodDKOaSKPf4TCqgTT63QBG3SyNfjeBUTdKo9+NYNRN0uh3Mxh1gzT63RBGFUuj301hVKE0+t0YRhVJo9/NYVSBNPo9AEYtlka/h8CohdLo9yAYtUga/R4GoxZIo98DYdTF0uj3UBh1oTT6PRhGXSSNfg+HURdIo19x1A+l0a9+w6gfSKNf/YVR35RGv/oHRn1DGv3qPxj1RWn0K4RRX5BGv4ow6kFp9KsPYdQD0uhXn8KoT6TRrx6CUR9Io189DKOCNPrVl2AUSKNffRlGvZNGv/oWjHojjX71bRj1Ko1+9SMY9SKNfvVjGI+XRr+6BMajpdGvLoPxWGn0q0thPFIa/epyGI+TRr9aAuNR0uhXy2A8Rhr9aimMR0ijXy2HcXtp9KsSGLeWRr8qg3FbafSrUhi3lEa/KodxO2n0q1tg3Eoa/eo2GLeRRr+6FcYtpNGvbodxvDT6VQsYR0ujX7WBcaw0+lUrGEdKo1+1g3GcNPpVSxhHSaNftYVxjDT6VWsYR0ijX7WHsb00+tUIGFtLo1+NgbGtNPrVKBhbSqNfjYOxnTT61UgYW0mjX42FsY00+tVoGFtIo1+Nh/F2afSrLWC8VRr9ahsYb5NGv9oKxluk0a+2g7FcGv1qSxhLpdGvtoWxTBr9amsYS6TRr7aHcbk0+tURMC6VRr86BsZl0uhXR8G4RBr96jgYL5dGvzoSxkul0a+OhfEyafSro2G8RBr96ngYL0GjP+kFxku8H/1IrzBe5s/oJr2BUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUSr09PwLe560Hv6Ev1kAAAAASUVORK5CYII=",name:dt("第三种平面符号")},{typeName:pn.FirstConcaveSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAI0AAACNCAYAAACKXvmlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAALXSURBVHhe7c1LktswEARR3//S4094MZYTJZIi0Q0yK+JtUg3xx699STthlBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCcZyv0ddLWAs9Tq6USmMZWh0p1IYy9DoTqUwlqHRnUphLPU6ulEpjKVeRzcqhbHU6+hGpTCWeh3dqBTGUjS6UxmMpWh0pzIYS9HoTmUwlqLRncpgLEWjO5XBWIpGdyqDsRSN7lQGYzka3akExnI0ulMJjOVodKcSGMvR6E4lMLZAoztNh7EFGt1pOowt0OhO02FsgUZ3mg5jGzS601QY26DRnabC2AaN7jQVxlZodKdpMLZCoztNg7EdGt1pCozt0OhOU2Bsh0Z3mgJjSzS60+UwtkSjO10OY1s0utOlMLZFoztdCmNbo9GtLoOxtdHoVpfA2B6N7nQJjO2NRrc6HcYl0OhOp8O4DBrd6VQYlzEa3eo0GJdCozudBuNSRqNbnQLjckajW30M45JGo1t9BOOS0uheh2FcVhrd6xCMSxuNbnUIxuWNRrfaDeMtjEa32gXjbYxGt9oM462MRrfaBOOtvBu9UYTxdt6N3mgI422l0b0QxltLo3v9B+PtpdG9/oHxEd6N3ugPjI/xbvRGHB/n3ejNg2F8pC2jdw+E8bG2jN49DMbH2zJ69xAY9deW0bubw6hv9oze3xBGgT2j9zeCUQNHRv+zOIza4OjovxaDUTt8OvrP5jDqoCtG3ymGUR+aNfr2BBh1oitH35sAoy509ugbF8OoyY6O/msCjGrq++j3STBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSgN/Pj6CVeUv88NZ939AAAAAElFTkSuQmCC",name:dt("第一种凹面符号")},{typeName:pn.FlattenWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAC0CAYAAAAw03Z1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAR0SURBVHhe7dFBbttQEARR3//SiRU4hqLUSKRE0b9nqoG3KQ4XBD8+90tqAKOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqMGux3dLAijhqLR3YIwaiga3S0IowaqRrcLwqiBaHS3KIwaphrdLgqjhqHR3cIwapBqdLswjBqERneLw6ghqtHt4jBqCBrdBcCoAarRbQCMGoBGdyEwqrlqdBsCo5qj0V0QjGqsGt0GwajGaHQXBqOaqka3YTCqKRrdBcKohqrRbSCMaohGd6EwqplqdBsKo5qh0V0wjGqkGt0Gw6hGaHQXDqOaqEa34TCqCRrdNYBRDVSj2wYwqgEa3TWBUeGq0W0TGBWORneNYFSwanTbCEYFo9FdMxgVqhrdNoNRoWh01xBGBapGtw1hVCAa3TWFUWGq0W1TGBWGRneNYVSQanTbGEYFodFdcxgVohrdNodRIWh0NwBGBahGtwNgVAAa3Q2BUYurRrdDYNTiaHQ3CEYtrBrdDoJRC6PR3TAYtahqdDsMxnY6j753IIytdB9980AYW+k8+t6hMLbTdfStQ2FspxrdrohGd4NhbIlGd6upRreDYWypGt2uhEZ3w2Fsi0Z3q6hGt8NhbKsa3a6ARnfi2BqN7n5aNboVx9aq0e1PotGd/sDYHo3ufko1utUfGNurRrc/gUZ3+oZxBBrdna0a3eobxhGq0e2ZaHSnf2Acg0Z3Z6lGt/oHxjGq0e0ZaHSn/2AchUZ371aNbvUfjKNUo9t3otGdEMZxaHT3LtXoVgjjONXo9h1odKcSxpFodHe0anSrEsaRqtHtkWh0p7swjkWju6NUo1vdhXGsanR7BBrd6SGMo9Ho7lXV6FYPYRytGt2+gkZ32gTjeDS6e1Y1utUmGMerRrfPoNGdNsOoTzS626sa3WozjPpUjW73oNGddsGoLzS626oa3WoXjPpSjW63oNGddsOoKzS6e6Qa3Wo3jLpSjW7vodGdnoJRN2h0V6lGt3oKRt2oRreERnd6GkYBGt3dqka3ehpGgWp0e41Gd3oJRhVodPdXNbrVSzCqUI1uL2h0p5dh1B20rXeX0a1ehlF3VNtyd3ujw2DUA7RHzy+7vtGhMOqBaveeX7+vw2HUBrSqX3b7vg6FURvsGb2vQ2HURltH7+pQGLXRltF7OhxG7fBo9I4Oh1E73Bvd6y0waqdqdKu3wKidaHSnt8GoJ9yObvQ2GKU0GKU0GKU0GKU0GKU0GKU0GKU0GKU0GKU0GKU0GE/l1h39r0VhPI1bf/TfFoTxNG790X9bEMZTubVH/2xBGE/n1hz9q0VhlNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglIJ8/PoN/NebMT+KMDUAAAAASUVORK5CYII=",name:dt("削平焊缝")},{typeName:pn.ToeAareaTranSmoothly,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALUAAAC1CAYAAAAZU76pAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAATfSURBVHhe7c5Bjhs5FARR3//SHs+igYYQpErtZBWTjgTeJvQp6def/ZYOg1FqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlELfI0+UxRGhb2ObhSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRijvkaf/QtodPcv+Bp9FoQx5nV0czoa3Z3udXQTgjGGRncno9Hd6V5HNyEYY2h0dzIa3Z3udXQTgjGGRncno9Hd6V5HNyEYY2h0dzIa3Z2MRnchGGNodHcyGt2djEZ3IRhjaHR3MhrdnYxGdyEYY2h0d7LR6PZUNLoLwRhFo7sTzUb3p6LRXQjGKBrdnWg2uj/V6+gmCGMUje5ONBvdn4hGd0EYo2h0d6J3ozenodFdEMY4Gt2d5Mro3WlodBeEMY5Gdye5Onp7ChrdhWGMG41uT/DJ6P0paHQXhnEJGt2dgDbrJxqNbsMwLjEa3TYbbfb59/enoNHdAhiXodFdM9q7z//f95t2o9HtAhiXGY1uG4125e71phmN7hbBuNRodNtktL+9bTMa3S6CcanR6LYJje6+jEa3LUaj24UwLjca3TYYjW6/o9Fdg9HodjGMtxiNbnc2Gt2+Go1udzYb3S+G8Taj0e2ORqPbkdHodkez0f0NMN5mNrrfyWx0PzMa3e5kNrq/CcZbzUb3O5iN7q+Yje6fNhvd3wjj7d6N3jzh3ejNJ2aj+6fMRvc3w/iId6M3d3o3evMT70Zv7vJu9OYBGB9zZfRupSujd3/j3ejNSldG7x6C8XFXRu+SrozepVwZvUu6Onr7IIxb+GT0/ic+Gb1f4ero7U9dHb3dAMatfDr6jplPR9+x2k9G3zPyk9H3bALjdnYZ/bc77TD6X5vBuK2nRv/lSU+M/semMFZYPfrN3dwx+t3NYayTGn13i9Tou8tgPMZodHuq2ej+ABilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilUr9+/we+LQDMYXMVmgAAAABJRU5ErkJggg==",name:dt("趾部平滑过渡")}]),s=k.reactive([{typeName:pn.WithPadSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAACyCAYAAADrlOUvAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAARaSURBVHhe7dGxbUBRCARB99+07QImBT2+dqVJTmT8/PebfAjH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruK4or6Zfr2I47j6bvr3Io7j6rvp34s4jqvvpn8v4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxnNJd3qZ0t4jjOKW7vE3pbhHHcUp3eZvS3SKO45Tu8jalu0Ucxynd5W1Kd4s4jlO6y9uU7hZxHKd0l7cp3S3iOE7pLm9TulvEcZzSXd6mdLeI4zilu7xN6W4Rx3FKd3mb0t0ijuOU7vI2pbtFHMcp3eVtSneLOI5TusvblO4WcRyndJe3Kd0t4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxnNJd3qZ0t4jjOKW7vE3pbhHHcUp3eZvS3SKO45Tu8jalu0Ucxynd5W1Kd4s4jlO6y9uU7hZxHKd0l7cp3S3iOE7pLm9TulvEcZzSXd6mdLeI4zilu7xN6W4Rx3FKd3mb0t0ijuOU7vI2pbtFHMcp3eVtSneLOI5TusvblO4WcRyndJe3Kd0t4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxnNJd3qZ0t4jjOKW7vE3pbhHHcUp3eZvS3SKO45Tu8jalu0Ucxynd5W1Kd4s4jlO6y9uU7hZxHKd0l7cp3S3iOE7pLm9TulvEcZzSXd6mdLeI4zilu7xN6W4Rx3FKd3mb0t0ijuOU7vI2pbtFHMcp3eVtSneLOI5TusvblO4WcRyndJe3Kd0t4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxXH03/XsRx3H13fTvRRzH1XfTvxdxHFffTf9exHFFfS/9eRnH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JQT+/fzC8n2Uj/0mSAAAAAElFTkSuQmCC",name:dt("带垫板符号")},{typeName:pn.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACKCAYAAACaRblaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAJuSURBVHhe7dExaiQBEARB/f/T0tlHGKI0sNOQBeEk7fXXv30nv8SYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkw/kn77PSThzDO2jum3zyAcdbeMf3mAYyz9o7pNw9gnLXPT395CONM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpy1z09/eQjjrL1j+s0DGGftHdNvHsA4a++YfvMAxj9pn51+8hDGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUz+8/X9AzBU0hEUOBzfAAAAAElFTkSuQmCC",name:dt("三面焊缝符号"),rotation:0},{typeName:pn.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHUAAAB2CAYAAAD2kNwSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMnSURBVHhe7dAxbhwwEARB/f/TshMli0pbwOjYQCXLifj1v+/nz+Hx2cbjs43HZxuPzzYen208Ptt4fLbx+Gzj8dnG47ONx2cbj882Hp9tPD7beHy28fhs4/HZxuOzjcdnG4+5T0t/EOIx94npHyI85j4x/UOEx9wnpn+I8Jj7xPQPER5zN22WKe0iPOZu2ixT2kV4zN20Waa0i/CYu2mzTGkX4TF302aZ0i7CY+6mzTKlXYTH3E2bZUq7CI+5mzbLlHYRHnM3bZYp7SI85m7aLFPaRXjM3bRZprSL8Ji7abNMaRfhMXfTZpnSLsJj7qbNMqVdhMfcTZtlSrsIj7mbNsuUdhEeczdtlintIjzmbtosU9pFeMzdtFmmtIvwmLtps0xpF+Exd9NmmdIuwmPups0ypV2Ex9xNm2VKuwiPuZs2y5R2ER5zN22WKe0iPOZu2ixT2kV4zN20Waa0i/CYu2mzTGkX4TF302aZ0i7CY+6mzTKlXYTH3E2bZUq7CI+5mzbLlHYRHnM3bZYp7SI85m7aLFPaRXjM3bRZprSL8Ji7abNMaRfhMXfTZpnSLsJj7qbNMqVdhMfcTZtlSrsIj7mbNsuUdhEeczdtlintIjzmbtosU9pFeMzdtFmmtIvwmLtps0xpF+Exd9NmmdIuwmPups0ypV2Ex9xNm2VKuwiPuZs2y5R2ER5zN22WKe0iPOZu2ixT2kV4zN20Waa0i/CYu2mzTGkX4TF302aZ0i7CY+6mzTKlXYTH3E2bZUq7CI+5mzbLlHYRHnM3bZYp7SI85m7aLFPaRXjM3bRZprSL8Ji7abNMaRfhMXfTZpnSLsJj7qbNMqVdhMfcTZtlSrsIj7mbNsuUdhEeczdtlintIjzmbtosU9pFeMzdtFmmtIvwmLtps0xpF+Exd9NmmdIuwmPups0ypV2Ex9xNm2VKuwiPuZs2y5R2ER5zN22WKe0iPOZu2ixT2kV4zN20WXfTJsLjr/hJb3/FT3oL8fhs4/HZxuOzjcdnG4/PNh6fbTw+23h8tvH4bOPx2cbjs43HZxuPzzYen208Ptt4fLbx+Mz6+v4HDsQyYEjLLcEAAAAASUVORK5CYII=",name:dt("三面焊缝符号"),rotation:Math.PI*(3/2)},{typeName:pn.SurroundingWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIoAAACICAYAAAA4T3NvAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQZSURBVHhe7c7BjqRIEETB+f+fnh2pL9shSwpUGZCAP8kurkiq/vzrb8QOHCMqjhEVx4iKY0TFMaLiGFFxjKg4RlQcIyqOERXHiIpjRMUxouIYUXGMqDhGVBwjKo4RFceIimNExTGi4hhRcYyoOEZUHCMqjq9U082LcXykmen7D8fxEc5Mv/8wHG9rhfS/HoDj7ayY/ueNcbyNb9L3Rr5J37shjss7mr7xraPpGzfCcVlH0vsuR9L7G+C4pL3p7Zn2pHeL47iUPend1fakd4viuIxP6c1qPqU3C+K4hE/pzao+pTeL4Xi5rXR/F1vpfiEcL7WV7u9mK90vguNlttL9XW2l+wVwvMRWur+7rXR/MY6nG6Xbpxml2wtxPNUo3T7VKN1ehONpttL9k43S7QU4nmaUbp9ulG4vwPEUo3T7FqN0ezKO7Ubp9m1G6fZEHNsp3b2V0t2JOLYapdu3GqXbk3BspXT3dqN0ewKObZTu4ofS3Qk4tlG6ix9Kdyfg2ELpLn5TumvGsYXSXfymdNeM43RKd2FKd404Tqd0F6Z014jjdEp3YaN024TjVEp3sU3prgnHqZTuYpvSXROOUyndxTaluyYcp6rpJvZRumvAcRqlu9hH6a4Bx2mU7mIfpbsGHKdRuot9lO4acJympps4pqabBhynqekmjqnppgHHaWq6iWNqumnAcZqabuIYpbvJOE6hdBfHKN1NxnEKpbs4RuluMo5TKN3FMUp3k3GcQukujlG6m4zjFEp3cYzS3WQcp1C6i2OU7ibjOE1NN3FMTTcNOE5T000cU9NNA47T1HQTx9R004DjNEp3sY/SXQOO0yjdxT5Kdw04TqN0F/so3TXgOI3SXeyjdNeA41RKd7FN6a4Jx6mU7mKb0l0TjlMp3cU2pbsmHKcapdsYU7prwnE6pbswpbtGHKdTugtTumvEsYXSXfymdNeMYwulu/hN6a4ZxzZKd/FjlG6bcWyjdBc/lO5OwLHNKN2+3SjdnoBjq1G6fTOlu5NwbKd091ZKdyfi2G6Ubt9mlG5PxPEUo3T7FqN0ezKOpxil27cYpduTcTzNKN0+3SjdXoDjqUbp9qlG6fYiHE83SrdPM0q3F+J4iVG6fYpRur0Yx8uM0u3dbaX7i3G8zKf05m4+pTcL4Hi5rXR/F5/Sm0VwXMJWul/dVrpfDMdlfEpvVvMpvVkQx6XsSe+utie9WxTH5exNb8+2N71dGMdl7U1vu+1Nb2+A4/KOpPezHEnvb4TjLXyTvvfJN+l7N8PxVlZO//emON7WCul/PQDH27si/Y8H4fg4Hel3Hozja+xJ716IY0TFMaLiGFFxjKg4RlQcIyqOERXHiIpjRMUxouIYUXGMqDhGVBwjKo4RFceIimNExTGi4hjxP3/+/gemz7sMOoigvwAAAABJRU5ErkJggg==",name:dt("周围焊接符")},{typeName:pn.OnSiteSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOgAAADjCAYAAACPbli7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAYQSURBVHhe7dPhbhxFFAVh3v+lIQKBAlQSez2zdXtulfT9Oe7YuzOd3771e5KxcEwyA45JZsAxyQw4JpkBxyQz4JhkBhyTzIBjkhlwTDIDjklmwDHJDDgmmQHHJDPgmGQGHJPMgGOSGXBMMgOOSWbAMckMOCaZAcckM+Co+jv6WbIMjqrvo58ni+CoouhcsgCOqh9FZ5OHw1H1q+jfJA+Fo+oj0b9LHghH1Weif588CI6qz0a/I3kIHFWvRL8neQAcVV+Jfl9yMBxVX41+Z3IoHFVXRb87OQyOqiuj358cBEfVHdHfSQ6Ao+qu6G8lw+GoujP6e8lgOKreEf3dZCAcVe+K/nYyDI6qd0efIRkCR5URfY5kABxVZvR5EhGOKjv6TIkER9WE6HMlAhxVk6LPl7wRjqpp0WdM3gRH1dTosyY3w1E1Ofq8yY1wVJ0Qfe7kBjiqTok+e3IxHFUnRZ8/uRCOqhOj75FcAEfVqdF3Sb4IR9Xp0XdKXoSj6gnR90pegKPqSdH3Sz4BR9XTou+YfBCOqidG3zP5ABxVT46+b/ITOKqeHn3n5AdwVG2JvnvyHziqNkXfP/kOjqqN0XNIvsFRtTV6FlkPR9Xm6HlkNRxV1X/U/ANHVf0VPZusg6Oq/h09o6yBo6r+Hz2nrICjqn4cPa88Go6q+nn0zPJYOKrq19FzyyPhqKqPR88vj4Kjqj4XPcM8Bo6qei16ljkejqp6PXqeORqOqvp69FxzJBxVdU30bHMcHFV1XfR8cxQcVXV99JxzBBxVdU/0rDMejqq6N3rmGQtHVd0fPfeMhKOq3hc9/4yCo6reG72DjIGjqt4fvYeMgKOqvOh9RIWjqtzonUSDo6pmRO8mb4ejquZE7ydvhaOq5kXvKW+Bo6pmRu8qt8NRVXOj95Vb4aiq+dF7yy1wVNUZ0bvL5XBU1VnRO8xlcFTVedF7zCVwVNW50fvMl+CoqrOjd5qX4aiq86P3mpfgqKrnRO83n4Kjqp4VveN8GI6qemb0rvNLOKrqudH7zk/hqKrnR+89CEdV7Yjeff4HR1Xtid5//gVHVe2L7kH+hKOqdkZ3ITyqand0JxbDUVVF92IpHFVVf0f3YxkcVVXfR3dkERxVVf+N7skSOKqqfhTdl4fDUVX1s+jOPBiOqqqPRHfngXBUVX00uj8Pg6Oq6rPRPXoIHFVVr0R36QFwVFW9Gt2nw+GoqvpqdK8OhaOq6orobh0IR1XVldEdOwiOqqqro3t2CBxVVXdF9204HFVVd0Z3bjAcVVV3R/duKBxVVe+K7t8wOKqq3hndwUFwVFUZ0V0cAEdVlRXdRxmOqio7upcSHFVVE6K7KcBRVTUlup9vhqOqalp0T98ER1XVxOiuvgGOqqrJ0Z29EY6qqunRvb0JjqqqU6L7ezEcVVUnRXf4Qjiqqk6L7vFFcFRVnRrd5y/CUVV1cnSnvwBHVdXp0b1+EY4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kj7Pvp5sgSOSWbAMckMOCaZAcckM+CYZAYck8yAY5IZcEwyA45JZsAxyQw4JpkBxyQz4JhkBhyTzIBjkhlwTDIDjklmwDHJDDgmmQHHJDPgmGQGHJPMgGOSGXBMMgOOSWbAMckMOCbR/fb7H7ITK2QTDTxwAAAAAElFTkSuQmCC",name:dt("现场符号")},{typeName:pn.none,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:dt("清除"),isChecked:!0},{typeName:pn.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJEAAACNCAYAAAC3zJjDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQNSURBVHhe7dBBah1ADERB3//STpZBFOYPgXaD9KA2ml7N19++z/lPPJ7zgsdzXvB4zgsez3nB4zkveDznBY/nvODxnBc8nvOCx3Ne8HjOCx7PecHjOS94POcFj+e84PGcFzye84LHc17weM4LHs95weM5L3j8Ff+m941m2hTgMW6mzUYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMuz5Lf1eAx7jrs/R3BXiMuz5Lf1eAx7jrs/R3BXj8FdfP6c9K8HjOCx7PecHjOS94POcFj+e84PGcFzye84LHc17weM4LHs95weM5L3g85wWP57zg8ZwXPJ7zgsdzXvB4zgsez3nB4zkveDznBY/nfOjr+w916ZqBJkXEfQAAAABJRU5ErkJggg==",name:dt("三面焊缝符号"),rotation:Math.PI/2},{typeName:pn.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABjCAYAAABzLpVfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAHPSURBVHhe7dAxakMBEENB3//STsCFmyn2gwqFSDDNY6t9/e49fwLj9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunD+Nj25l+CGB/ZvtN/Qhgf2b7Tf0IYH9s+029CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthfGz7TL8JYXxk+07/CWF8ZPtO/wlhfGT7TL8JYnzsv08/CWOcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcKq/3D2Q2PYJIa+R5AAAAAElFTkSuQmCC",name:dt("三面焊缝符号"),rotation:Math.PI},{typeName:pn.TailSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAACfCAYAAADu8KuaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAOrSURBVHhe7dLRTiNBDAVR/v+nWYRYBKHsTJJ2T4+7rnReSn7028fepUkwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwarLb0U0DGDURje4awKhJotFtAxg1QTa6bwCjimWj+yYwqlA2um8Eo4pko/tmMKpANrpvCKMGy0b3TWHUQNnovjGMGiQb3TeHUQNko/sNYNSLstH9JjDqBdnofiMY9aRsdL8ZjHpCNrrfEEY9KBvdbwqjHpCN7jeGUQdlo/vNYdQB2eheHHVHNrrXJ4xKZKN7fcOoQDa61y8YBbLRvf7AqBvZ6F4Io37IRvcKYdSXbHSvFEZ9yEb3ugvj9rLRvQ7BuLVsdK/DMG4rG93rIRi3lI3u9TCM28lG93oKxq1ko3s9DeM2stG9XoJxC9noXi/D2F42utcQGFvLRvcaBmNb2eheQ2FsKRvdaziM7WSje5XA2Eo2ulcZjG1ko3uVwthCNrpXOYyXl43uNQXGS8tG95oG42Vlo3tNhfGSstG9psN4OdnoXqfAeCnZ6F6nwXgZ2ehep8J4CdnoXqfDuLxsdK8lYFxaNrrXMjAuKxvdaykYl5SN7rUcjEuKRrdaEsZlRaNbLQfj0qLRrZaCcXnR6FbLwHgJ0ehWS8B4GdHoVqfDeCnR6Fanwng50ehWp8F4SdHoVqfAeFnR6FbTYby0aHSrqTBeXjS61TQYW4hGt5oCYxvR6FblMLYSjW5VCmM70ehWZTC2FI1uVQJjW9HoVsNhbC0a3WoojO1Fo1sNg3EL0ehWQ2DcRjS61cswbiUa3eolGLcTjW71NIxbika3egrGbUWjWz0M49ai0a0egnF70ehWh2HUh2h0q0Mw6ks0utVdGPVDNLpVCqNuRKNbhTAKRKNbIYwKRKNb/YFRiWh0q18w6o5odKtvGHVANLrVJ4w6KBrdiqMeEI1uN4dRD4pGtxvDqCdEo9tNYdSTotHthjDqBdHodjMY9aJodLsRjBogGt1uAqMGiUa3G8CogaLRbXMYNVg0um0MowpEo9umMKpINLptCKMKRaPbZjCqWDS6bQSjJohGt01g1CTR6LYBjJqIRncNYNRkt6ObBjDqBI2f7D+MUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWM0mBv7/8ABNZSZLbQ7LwAAAAASUVORK5CYII=",name:dt("尾部符号")},{typeName:pn.ZSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAMUAAACwCAYAAAC/16qCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQxSURBVHhe7c85khxJEARB/P/T2CFAYNFaM33UkVlpLqKMSTDx62u/k/wPY7IyxmRljMnKGJOVMSYrY0xWxpisjDFZGWOyMsZkZYzJyhiTlTEmK2NMVsaYrIwxWRljsjLGZGWMycoYk5UxLmeF6e8Q41JWmv7PA8alrDT9nweMy1ll+j0PGDM5TXchxkxO012IMRPTdJdNjJmYprtsYsykNN3lW4yZlKa7fIsxk9J0l28xZkKa7vIjxkxI011+xJjJaLrLUxgzGU13eQpjJrI13eYpjJmIprs8jTET0XSXpzFmEpru8hLGTELTXV7CmAlsTbd5CWMmoOkuL2PMBDTd5WWMGZymu7yFMYPTdJe3MGZgmu7yNsYMTNNd3saYgWm6y9sYMyhNd/kIYwal6S4fYcyANN3lY4wZkKa7fIwxg9mabvMxxgxG0112wZjBaLrLLhgzEE132Q1jBqLpLrthzCC2ptvshjGD0HSXXTFmEJrusivGDEDTXXbHmAFousvuGHMxTXc5BGMupukuh2DMxTTd5RCMuZCmuxyGMRfSdJfDMOYimu5yKMZcRNNdDsWYC2xNtzkUYy6g6S6HY8wFNN3lcIw5maa7nIIxJ9N0l1Mw5kRb021OwZgTabrLaRhzIk13OQ1jTqLpLqdizEk03eVUjDmBprucjjEn0HSX0zHmBJrucjrGHEzTXS7BmINpusslGHMgTXe5DGMOpOkul2HMQbam21yGMQfRdJdLMeYgmu5yKcYcQNNdLseYA2i6y+UYs7Ot6TaXY8zONN1lCIzZmaa7DIExO9J0l2EwZkea7jIMxuxE012GwpidaLrLUBizE013GQpjdqDpLsNhzA403WU4jPmQprsMiTEf0nSXITHmA1vTbYbEmA9ousuwGPMBTXcZFmPepOkuQ2PMmzTdZWiMecPWdJuhMeYNmu4yPMa8QdNdhseYF2m6yxQY8yJNd5kCY16g6S7TYMwLNN1lGox5gaa7TIMxT9J0l6kw5kma7jIVxjxB012mw5gnaLrLdBjzg63pNtNhzA803WVKjPmBprtMiTHf0HSXaTHmG5ruMi3GbNiabjMtxmzQdJepMWaDprtMjTGg6S7TYwxousv0GPMPTXe5Bcb8Q9NdboEx/9B0l1tgzF803eU2GPMXTXe5Dcb8oekut8KYPzTd5VYY82Vrus2tMOaLprvcDmO+aLrL7TAuT9NdbolxeZruckuMS9uabnNLjEvTdJfbYlyaprvcFuOyNN3l1hiXpekut8a4JE13uT3GJWm6y+0xLknTXW6PcTma7rIExuWsMP0dYlzKStP/ecC4lJWm//OAcSkrTf/nAeNyVpj+DjEmK2NMVsaYrIwxWRljsjLGZGWMycoYk5UxJitjTFbGmKyMMVkZY7IyxmRljMnKGJOVMSYrY0xWxpgs6tfv/wDi6qJ+m/lFTwAAAABJRU5ErkJggg==",name:dt("交错断续焊接符号")}]),a=k.reactive([{typeName:pn.BellShapedWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAACGCAYAAAAYefKRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMJSURBVHhe7dFLbiNJEAXBvv+lewaYzaBkWaTEX2XIH2AbV2RxoT//7m8CjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCeMX905v8zr3Tm9vYPzikel7+ZlHpu+dYPziWdO3s/bM6fsnGL94xfQ7+c+zp9+4gXHpFdPv/FbPnn7jTowP+en0rd/gp9O3nojxqb47fWOq70zvX4jxZe6d3k7ynen9GzC+3L3T293dM717M8a3uWd6t6N7pncfwvh2t6Y3O7k1vfkwxo+5Nb25ulvTmwtg/Khb05urOpvuL4TxEs6m+yu5Nb25GMbLOJvur+DW9OaCGC/lbLr/tNV0e2GMl3M23X/Karq9OMZLOpvu32013W6A8bJW0+07rabbTTBe2mq6fYfVdLsRxstbTbevdDbdb4RxC6vp9lVW0+1mGLeh6e4VVtPthhi3sZpun03T3aYYt6Lp7plW0+2mGLeymm6fYTXdboxxO6vp9lGa7jbHuCVNd49YTbebY9ySprtHaLobgHFbmu5+StPdAIzb0nT3E5ruhmDcmqa779J0NwTj1jTdfYemu0EYt6bp7js03Q3CuD1Nd/fSdDcI4/Y03d1D090wjNvTdHcPTXfDMI5wnG7uoeluGMYRNN3douluGMYRNN3dcpxuBmIcQdPdGU13AzGOcZxuzmi6G4hxjON0c0bT3UCMYxynmzOa7gZiHEPT3Yqmu4EYx9B0t6LpbiDGMTTdrRynm6EYx9B0t3KcboZiHEPT3cpxuhmKcQxNdyvH6WYoxjE03a0cp5uhGMfQdLdynG6GYhxD093KcboZinEMTXcrx+lmKMYxNN2tHKeboRjH0HS3cpxuhmIcQ9PdynG6GYpxlP9Pfz9znG6GYhznkX/qI283xpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYX+3P338AJHckMzDP7f4AAAAASUVORK5CYII=",name:dt("喇叭形焊缝")},{typeName:pn.SingleBellShapedWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABnCAYAAAAdQVz5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAK5SURBVHhe7dBBjuNADAPA+f+nZ+e4CKptJ6ETtSACdWGoNpCfv/yOsliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGljG/R/9vrOr0e0JllGKdrt4NXrrBMsoRbuqUtHbJ1hGKdpVk46+cYJllKJdBXdE37mIZZSi3Te9Gr0VxDJK0e5bnonub8QyStHu065Gtx/CMkrR7lOuRrcfxjJK0e4TrkR3X8IyStHubmfRzZexjFK0u9NRtC+CZZSi3R3OoptCWEYp2qUdRfuCWEYp2iUdRfuiWEYp2qUcRfvCWEYp2iUcRfviWEYp2iWsou0GWEYp2r1rFW03wTJK0e4dq2i7EZZRinavWkXbzbCMUrR7laLdhlhGKdq9YhVtN8QyStHuWatouymWUYp2z1K02xjLKEW7Z6yi7cZYRinaPUPRbnMsoxTtrlK0a4BllKLdVYp2DbCMUrS7QtGuCZZRinZXKNo1wTJK0e4KRbsmWEYp2p1RtGuEZZSi3RlFu0ZYRinaHVG0a4ZllKLdEUW7ZlhGKdodUbRrhmWUot0RRbtmWEYp2q0o2jXEMkrRbkXRriGWUYp2K4p2DbGMUrRbUbRriGWUot2Kol1DLKMU7VYeo01TLKMU7VYeo01TLKMU7VYeo01TLKMU7UTRrimWUYp2omjXFMsoRTtRtGuKZZSinSjaNcUyStFOFO2aYhmlaCeKdk2xjFK0E0W7plhGKdqJol1TLKMU7UTRrimWUYp2omjXFMsoRTtRtGuKZdRjtDnyGG2aYnmLd/7Yd243xnLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHJ83c/vPxMESWh6J6w5AAAAAElFTkSuQmCC",name:dt("单边喇叭形焊缝")},{typeName:pn.HeapWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANZSURBVHhe7c5BrtswFMXQ7n/TbScfKALKlk3bsQpe4EyYpyS//u53cgOMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwvgqe6M3q9ka3S8A41ddMfret7hi9L0vg/Fxd45+72l3jn7vBTA+4unRf7jbk6Pf/yKMt/r26D9d7Zuj//MFGG9zdPQd5OjoO65yZPR+5OjoOx6E8RYzo3dnzI7enjU7envGzOjdQzBeamb07gozo3dHzYzeXWFm9O5mGC+zN3pzh73Rm1l7ozd32Bu9uRHGS2yN7p+wNbrfszW6v9ve6M1NMGpbo/snbY3uR7ZG90/aGt3fAKOyNbr/hq3R/afR6PZbRqPbG2BURqPbb9oa3f8YjW6/bTS6vRjG00aj2zcYjW5/0OjuLUaj2wthPGU0un2T0eztm4xGtxfBeNhodPtGox29eavR6PYiGA8bjW7finbk87cbjW4vgPEwGt292Wijzz7fr4BGdxfAeAiN7lZA2+qrGY1uJYyH0OhuBbOjt6ug0Z2EcRqN7lYyM3q3itHoVsA4jUZ3K5kZvVsJje4EjNNodLeardH9amh0J2CcQqO7FW2N7ldDozsB4xQa3a1oa3S/IhrdnYRxCo3uVjQa3a6KRncnYZzyObpZGY3uVkWju5MwTvkc3ayMRnerotHdSRinfI5uVkaju1XR6O4kjLtodLcyGt2t7HN0cxLGXTS6WxmN7lb2Obo5CeMuGt2tjEZ3K/sc3ZyEccq/o8//B/+OPl/d5+jmJIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMhF+//wCT9z8Vxt/ZFwAAAABJRU5ErkJggg==",name:dt("堆焊缝")},{typeName:pn.SeamSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACPCAYAAADKiCjpAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANiSURBVHhe7c/RTiRHEEVB//9Pr40lWxhHwbBUQ1bPuVK8nMmWpv74a7+SBzEmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKM471MfarT/u8C42ivp9+neTvdHIJxLE13U2i6OwTjWJruJlhNt4dgHEvT3U9bTbcHYRxL091PWk23h2EcS9PdT1lNtwdiHEvT3U9YTbeHYhxL0913W023B2McS9Pdd1pNt4djHEvT3XdZTbc3wDiWprvvsJpub4JxLE13V1tNtzfCOJamuyutptubYRxL091VVtPtDTGOpenuCqvp9qYYx9J0t9tqur0xxrE03e20mm5vjnEsTXe7rKbbJ8A4lqa7HVbT7ZNgHEvT3VetptsnwjiWpruvWE23T4ZxLE13v2s13T4hxrE03f2O1XT7pBjH0nT3Wavp9okxjqXp7jNW0+2TYxxL092jVtNtHMfSdPeI1XSbvzGOpenuI6vpNv9iHEvT3XtW023+g3EsTXcrq+k2/8M4lqY7WU23IcaxNN29tZpus8Q4lqa711bTbd7FOJamu3+sptt8iHEsTXcvVtNtHsI4lvbo3ct0m4cxjqU9cvOyt3f5NMaxtI9+f9nrm/w2xrG093572evv8yWMY2mr/rK33+dLGMf6zPR9voRxrEenb/NljGM9Mn2XLRjH+mj6JtswjvXedJ+tGMdaTbfZjnEsTXe5BONYmu5yCcaxNN3lEoxjabrLJRjH0nSXSzCOpekul2AcS9NdLsE4lqa7XIJxLE13uQTjWJrucgnGsU6f3nQQxrHuML3rEIxj3WF61yEYx7rD9K5DMI52+vSmQzBmE013h2DMJpruDsGYTTTdHYIxm2i6OwRjNtF0dwjGbKLp7hCM2UTT3SEYs4mmu0MwZhNNd4dgzCaa7g7BmE003R2CMZtoujsEYzbRdHcIxmyi6e4QjNlE090hGLOJprtDMGYTTXeHYBzt9OlNh2Ac6w7Tuw7BONYdpncdgnGsO0zvOgTjaCdP7zkIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmb/zx609Bd0um/KSnwAAAAABJRU5ErkJggg==",name:dt("锁边焊缝")},{typeName:pn.LockTheSlopeOpening,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAABxCAYAAADifkzQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAALeSURBVHhe7c5BjuMwFAPRvv+le2YWAwRCUXESyxQdEnib8k+gn7/7rXgYKwvGyoKxsmCsLBgrC8bKgrGyYKwsGCsLxsqCsbJgrCwYKwvGyoKxsmCsLBgrC8bKgrGyYKwsGA95HH3/Ro+j74tgfIpGd9+ERncLYHxKjW6/gRrdLoDxKTW6vbvZ6H4BjIeo0e1dzUb3i2A8TI1u70iNbhfC+BI1ur0TNbpdDOPL1Oj2DtTo9gIY36JGt8nU6PYiGN+mRreJ1Oj2QhjfNhvdJ1Gj24th/MhsdJ9gNrq/GMaPzUb3O5uN7g0wnkKNbnc1G92bYDyNGt3uZja6N8J4KjW63Yka3ZphPJ0a3e5AjW43gHEJNbp1UqPbTWBcRo1uHdTodiMYl1Kj2yup0e1mMC41G91fQY1uN4RxudnofqXZ6H5DGC8xG92vMBvdbwrjZdTo9myz0f3GMF5KjW7PpEa3m8N4OTW6PYMa3QbAaKFGt59Qo9sQGG3U6PYdanQbBKOVGt2+Qo1uw2C0U6PbI9ToNhBGu9nofkaNbkNh3MJsdE9mo/tQGLcxG90/mo3ug2Hcihrd/jcb3YfDuB01uv1HjW5vAOOW1N69uxGM21I7+v2mMG7t1dF/3AzG7R0d/faGMEbYYfQuA4wRdhi9ywBjDPfoTQYYozhH7zHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAGMU5eo8BxijO0XsMMEZxjt5jgDGKc/QeA4yVBWNlwVhZMFYWjJUFY2XBWFkwVhaMlQVjZcFYWTBWFoyVBWNlwVhZMFYWjJUFY2XBWFkwVhaMlQVjxfj5/QNv9lDtDk628AAAAABJRU5ErkJggg==",name:dt("锁边坡口")}]),o=k.reactive({symbolPos:_r.top,dottedLinePos:0,leftDim:"",rightDim1:"",rightDim2:"",topDim:"",weldingSymbolInfo:"",description:"",intWeldSeam:""}),r=[{label:dt("上"),value:1},{label:dt("下"),value:2},{label:dt("无"),value:0}],u=()=>{o.intWeldSeam=o.weldingSymbolInfo=o.leftDim=o.topDim=o.rightDim1=o.rightDim2="",p.basicSymbol.forEach(J=>{D.includes(J.typeName)&&J.position===o.symbolPos&&(J.info="")}),["rightDim1","rightDim2","leftDim","topDim"].forEach(J=>{p[J].forEach(U=>{U.position===o.symbolPos&&(U.content="")})}),p.intWeldSeam.forEach(J=>{J.position===o.symbolPos&&(J.content="")}),j()};let l=new A.McDbWipeout,h=new A.McGePoint3d,f;k.onMounted(()=>{sl.value=520;const{wipeout:rt,midPt:J}=Pb();if(l=rt,h=J.clone(),ps.value){f=ps.value.clone();const U=f.fixedPos.sub(f.weldingPosition).normalize().mult(10);f.weldingPosition=h,f.turningPoint=h.clone().addvec(U),b()}else{f=new _f,f.weldingPosition=h;const U=new A.McGeVector3d(10,10,0);f.turningPoint=h.clone().addvec(U)}j()});const d=(rt,J)=>{const U=[];for(let G=0;G<rt.length;G+=J)U.push(rt.slice(G,G+J));return U},p=k.reactive({basicSymbol:[{typeName:pn.none,position:_r.top},{typeName:pn.none,position:_r.down}],suppleSymbol:[{typeName:pn.none}],specialSymbol:[],auxiliarySymbol:[{typeName:pn.none,position:_r.top},{typeName:pn.none,position:_r.down}],rightDim1:[{position:_r.top,content:""},{position:_r.down,content:""}],rightDim2:[{position:_r.top,content:""},{position:_r.down,content:""}],leftDim:[{position:_r.top,content:""},{position:_r.down,content:""}],topDim:[{position:_r.top,content:""},{position:_r.down,content:""}],intWeldSeam:[{position:_r.top,content:""},{position:_r.down,content:""}]}),b=()=>{const rt=ps.value.clone();p.basicSymbol=rt.getBaseSymbok(),p.suppleSymbol=rt.getSuppleSymbol(),p.specialSymbol=rt.getSpecialSymbol(),p.auxiliarySymbol=rt.getAuxiliarySymbol(),p.leftDim=rt.getLeftDim(),p.topDim=rt.getTopDim(),p.intWeldSeam=rt.getIntWeldSeam(),rt.getRightDim().forEach(I=>{const C=I.content.split("×");p.rightDim1.forEach(L=>{L.position===I.position&&(L.content=C[0]||"")}),p.rightDim2.forEach(L=>{L.position===I.position&&(L.content=C[1]||"")})}),o.dottedLinePos=rt.dottedLinePos,o.description=rt.weldingSymbolInfo.replace(/\\P/g,`
`),p.specialSymbol.length&&(o.symbolPos=p.specialSymbol[0].position),["topDim","rightDim1","leftDim","rightDim2"].forEach(I=>{p[I].length==0?p[I]=[{position:_r.top,content:""},{position:_r.down,content:""}]:p[I].forEach(C=>{C.position===o.symbolPos&&(o[I]=C.content)})}),[{arr:e,flag:"basic",num:7,name:dt("basicSymbol")},{arr:i,flag:"auxi",num:3,name:dt("auxiliarySymbol")},{arr:s,flag:"supple",num:3,name:dt("suppleSymbol")},{arr:a,flag:"special",num:5,name:dt("specialSymbol")}].forEach(I=>{if(!p[I.name].length)I.name==="suppleSymbol"?p[I.name]=[{typeName:pn.none}]:p[I.name]=[{typeName:pn.none,position:_r.top},{typeName:pn.none,position:_r.down}];else{let C=p[I.name].filter(L=>L.position===o.symbolPos);I.name==="suppleSymbol"&&(C=p[I.name]),C.length&&C.forEach(L=>{const B=L.typeName,O=d(I.arr,I.num);L.info&&(o.weldingSymbolInfo=L.info),O.forEach((q,it)=>{q.forEach((nt,lt)=>{nt.typeName===B&&v(it,lt,I.num,I.flag,nt,!1)})})})}}),p.intWeldSeam.length?p.intWeldSeam.forEach(I=>{I.position===o.symbolPos&&(o.intWeldSeam=I.content)}):p.intWeldSeam=[{position:_r.top,content:""},{position:_r.down,content:""}],["basicSymbol","auxiliarySymbol","intWeldSeam"].forEach((I,C)=>{if(p[I].length!==2){const B=p[I].filter(O=>O.position===_r.top).length?_r.down:_r.top;C===2?p[I].push({content:"",position:B}):p[I].push({typeName:pn.none,position:B})}})},v=(rt,J,U,G,I,C=!0)=>{if(I.isDisable)return;const L=rt*U+J;let B=[];if(G==="basic")B=e,B.forEach(q=>q.isChecked=!1),p.basicSymbol.forEach(q=>{q.position===o.symbolPos&&(q.typeName=I.typeName),D.includes(I.typeName)&&q.position===o.symbolPos&&(q.info=o.weldingSymbolInfo)}),a.forEach(q=>q.isChecked=!1),p.specialSymbol.length=[],[s,i].forEach(q=>{q.forEach(it=>it.isDisable=!1)}),p.specialSymbol.length=0,a.forEach(q=>q.isChecked=!1),V(),B[L].isChecked=!0;else if(G==="auxi")B=i,B.forEach(O=>O.isChecked=!1),C&&p.auxiliarySymbol.forEach(O=>{O.position===o.symbolPos&&(O.typeName=I.typeName)}),B[L].isChecked=!0;else if(G==="supple"){if(B=s,B[L].isChecked)I.typeName!==pn.ThreeSidedWeldSeamSymbol&&(B[L].isChecked=!1,p.suppleSymbol=p.suppleSymbol.filter(O=>O.typeName!==I.typeName));else{if(B.forEach(O=>{O.typeName===pn.none&&(O.isChecked=!1)}),I.typeName===pn.ThreeSidedWeldSeamSymbol){const O=p.suppleSymbol.findIndex(q=>q.typeName===pn.ThreeSidedWeldSeamSymbol);B.forEach(q=>{q.typeName===pn.ThreeSidedWeldSeamSymbol&&(q.isChecked=!1)}),O>0?p.suppleSymbol[O].rotation=I.rotation:p.suppleSymbol.push({typeName:I.typeName,rotation:I.rotation})}else I.typeName===pn.none?(C&&(p.suppleSymbol.length=0,p.suppleSymbol.push({typeName:pn.none})),B.forEach(q=>{q.typeName!==pn.none&&(q.isChecked=!1)}),[a,e].forEach(q=>{q.forEach(it=>{it.isDisable&&(it.isDisable=!1)})})):I.typeName===pn.WithPadSymbol?(a.forEach(O=>{O.isChecked=!1,O.isDisable=!0}),p.specialSymbol.length=[],C&&p.suppleSymbol.push({typeName:I.typeName})):(p.suppleSymbol=p.suppleSymbol.filter(O=>O.typeName!=pn.none),C&&p.suppleSymbol.push({typeName:I.typeName}));B[L].isChecked=!0}E()}else if(G==="special"){B=a,B.forEach(q=>q.isChecked=!1),C&&(p.specialSymbol.length=0,p.specialSymbol.push({typeName:I.typeName,position:o.symbolPos})),i.forEach(q=>{q.typeName!==pn.none?(q.isDisable=!0,q.isChecked=!1):q.isChecked=!0}),p.auxiliarySymbol.length=0,p.auxiliarySymbol.push({typeName:pn.none,position:_r.top},{typeName:pn.none,position:_r.down});const O=[pn.ThreeSidedWeldSeamSymbol,pn.WithPadSymbol];s.forEach(q=>{O.includes(q.typeName)&&(q.isDisable=!0,q.isChecked=!1)}),p.suppleSymbol=p.suppleSymbol.filter(q=>!O.includes(q.typeName)),p.basicSymbol.forEach(q=>{q.typeName=pn.none}),e.forEach(q=>{q.isChecked=!1}),B[L].isChecked=!0}C&&j()},x=()=>{const rt=p.specialSymbol.length>0;p.auxiliarySymbol.forEach(U=>{U.position===o.symbolPos&&i.forEach(G=>{G.isChecked=!1,U.typeName===G.typeName&&(G.isChecked=!0)})}),p.basicSymbol.forEach(U=>{U.position===o.symbolPos&&(rt||(o.weldingSymbolInfo=(U==null?void 0:U.info)||""),U.info&&(o.weldingSymbolInfo=U.info),e.forEach(G=>{G.isChecked=!1,G.typeName===U.typeName&&(G.isChecked=!0)}))}),["topDim","rightDim1","rightDim2","leftDim"].forEach(U=>{p[U].forEach(G=>{G.position===o.symbolPos&&(o[U]=G.content)})}),p.specialSymbol.forEach(U=>U.position=o.symbolPos),p.intWeldSeam.forEach(U=>{U.position===o.symbolPos&&(o.intWeldSeam=U.content)}),E(),j()},w=()=>{p.basicSymbol.forEach(rt=>{D.includes(rt.typeName)&&rt.position===o.symbolPos&&(rt.info=o.weldingSymbolInfo)}),j()},M=rt=>{let J="item";return rt.isChecked&&(J+=" checked"),rt.isDisable||(J+=" itemHover"),J},E=()=>{if(!p.suppleSymbol.filter(J=>J.typeName===pn.WithPadSymbol).length)[e,a].forEach(U=>{U.forEach(G=>{G.isDisable&&(G.isDisable=!1)})});else if(o.symbolPos===_r.top){const J=[pn.SeamWeld,pn.SpotWeldSeam];let U=!1;e.forEach(G=>{J.includes(G.typeName)?(G.isDisable=!0,G.isChecked===!0&&(G.isChecked=!1,U=!0)):G.isDisable=!1}),U&&e.forEach(G=>{G.typeName===pn.none&&(G.isChecked=!0)}),p.basicSymbol.forEach(G=>{J.includes(G.typeName)&&G.position===o.symbolPos&&(G.typeName=pn.none)})}else o.symbolPos===_r.down&&(e.forEach(J=>{J.typeName!=pn.none?(J.isDisable=!0,J.isChecked=!1):(J.isChecked=!0,J.isDisable=!1)}),p.basicSymbol.forEach(J=>{J.position===o.symbolPos&&(J.typeName=pn.none)}));V()},D=[pn.VWeldSeam,pn.SingleVWeldSeam,pn.SingleSteepVWeldSeam,pn.InclinedWeldSeam,pn.VFlangedEdgeSeam,pn.SingleVFlangedEdgeSeam,pn.UFlangedEdgeSeam],N=()=>!p.basicSymbol.filter(J=>D.includes(J.typeName)&&J.position===o.symbolPos).length,V=()=>{p.basicSymbol.filter(J=>D.includes(J.typeName)&&J.position===o.symbolPos).length||(o.weldingSymbolInfo="")},K=k.ref(),j=rt=>re(this,null,function*(){p.suppleSymbol.filter(H=>H.typeName===pn.TailSymbol).length||(o.description=""),p.suppleSymbol.filter(H=>H.typeName===pn.ZSymbol).length?o.dottedLinePos=0:o.intWeldSeam="",p.basicSymbol.filter(H=>H.position===o.symbolPos&&D.includes(H.typeName)).length||(o.weldingSymbolInfo=""),p.suppleSymbol.filter(H=>H.typeName===pn.WithPadSymbol).length&&p.basicSymbol.forEach(H=>{H.position===_r.down&&(H.typeName=pn.none)});const C=wi({weldingSymbolInfo:o.description,dottedLinePos:o.dottedLinePos},p),L=A.MxCpp.getCurrentMxCAD();f.setSpecialSymbol(C.specialSymbol);const B=[_r.top,_r.down],O=[];B.forEach(H=>{const at=C.rightDim1.filter(_t=>_t.position===H)[0],ft=C.rightDim2.filter(_t=>_t.position===H)[0],wt=at.content&&ft.content?"×":"";O.push({position:H,content:at.content+wt+ft.content})}),f.setRightDim(O),f.setSuppleSymbol(C.suppleSymbol),f.setLeftDim(C.leftDim),f.setTopDim(C.topDim),f.setAuxiliarySymbol(C.auxiliarySymbol),f.setBaseSymbok(C.basicSymbol),f.setIntWeldSeam(C.intWeldSeam),f.dottedLinePos=C.dottedLinePos,f.weldingSymbolInfo=C.weldingSymbolInfo.replace(/\n/g,"\\P");const q=L.drawEntity(f),{minPt:it,maxPt:nt}=f.getBoundingBox(),lt=nt.sub(it).normalize().mult(2);it.addvec(lt.clone().negate()),nt.addvec(lt);let ut=new A.McGeLongArray;ut.copyFormAryId([q]),A.MxCpp.App.MxCADAssist.MxExplode(ut.imp);let vt=(nt.x-it.x)*5,Q=120/300*vt;const gt=yield cf({type:"image/bmp",width:vt,height:Q,range_pt1:it.toVector3(),range_pt2:nt.toVector3()});K.value.src=gt,L.mxdraw.updateCanvasSize();let Y=new A.MxCADSelectionSet;Y.crossingSelect(it.x,it.y,nt.x,nt.y),Y.forEach(H=>{H.erase()}),n("receiveParameters",{formData:C})}),Z=()=>{["topDim","rightDim1","leftDim","rightDim2"].forEach(J=>{p[J].forEach(U=>{U.position===o.symbolPos&&(U.content=Object.values(o)[Object.keys(o).findIndex(G=>G===J)])})}),j()},tt=()=>{p.intWeldSeam.forEach(rt=>{rt.position===o.symbolPos&&(rt.content=o.intWeldSeam)}),j()};return k.onBeforeUnmount(()=>{l.erase(),ps.value=null}),(rt,J)=>(k.openBlock(),k.createElementBlock("div",null,[k.createElementVNode("div",S7,[k.createElementVNode("div",E7,[k.createElementVNode("img",{alt:"",ref_key:"img",ref:K,style:{width:"100%",height:"100%"}},null,512)]),T7]),k.createElementVNode("div",C7,[k.createElementVNode("div",P7,[k.createElementVNode("span",D7,k.toDisplayString(k.unref(dt)("基本符号")),1),(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(d(e,7),(U,G)=>(k.openBlock(),k.createElementBlock("div",{class:"row",key:G},[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(U,(I,C)=>(k.openBlock(),k.createBlock(k.unref(wn.VTooltip),{key:I.name,text:I.name,disabled:I.isDisable},{activator:k.withCtx(({props:L})=>[k.createElementVNode("div",{class:k.normalizeClass(M(I)),onClick:B=>v(G,C,7,"basic",I)},[k.createElementVNode("img",k.mergeProps({src:I.img,alt:""},L,{style:I.isDisable?"opacity: 0.3;":""}),null,16,k7)],10,R7)]),_:2},1032,["text","disabled"]))),128))]))),128))]),k.createElementVNode("div",I7,[k.createElementVNode("span",L7,k.toDisplayString(k.unref(dt)("辅助符号")),1),(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(d(i,3),(U,G)=>(k.openBlock(),k.createElementBlock("div",{class:"row",key:G},[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(U,(I,C)=>(k.openBlock(),k.createBlock(k.unref(wn.VTooltip),{key:I.name,text:I.name,disabled:I.isDisable},{activator:k.withCtx(({props:L})=>[k.createElementVNode("div",{class:k.normalizeClass(M(I)),onClick:B=>v(G,C,3,"auxi",I)},[k.createElementVNode("img",k.mergeProps({src:I.img,alt:""},L,{style:I.isDisable?"opacity: 0.3;":""}),null,16,F7)],10,B7)]),_:2},1032,["text","disabled"]))),128))]))),128))]),k.createElementVNode("div",N7,[k.createElementVNode("span",O7,k.toDisplayString(k.unref(dt)("补充符号")),1),(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(d(s,3),(U,G)=>(k.openBlock(),k.createElementBlock("div",{class:"row",key:G},[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(U,(I,C)=>(k.openBlock(),k.createBlock(k.unref(wn.VTooltip),{key:I.name,text:I.name,disabled:I.isDisable},{activator:k.withCtx(({props:L})=>[k.createElementVNode("div",{class:k.normalizeClass(M(I)),onClick:B=>v(G,C,3,"supple",I)},[k.createElementVNode("img",k.mergeProps({src:I.img,alt:""},L,{style:I.isDisable?"opacity: 0.3;":""}),null,16,U7)],10,z7)]),_:2},1032,["text","disabled"]))),128))]))),128))])]),k.createElementVNode("div",V7,[k.createElementVNode("div",j7,[k.createElementVNode("span",G7,k.toDisplayString(k.unref(dt)("符号位置")),1),k.createVNode(k.unref(wn.VRadioGroup),{modelValue:o.symbolPos,"onUpdate:modelValue":J[0]||(J[0]=U=>o.symbolPos=U),onChange:x},{default:k.withCtx(()=>[k.createElementVNode("div",H7,[k.createVNode(k.unref(wn.VRadio),{label:"上",value:k.unref(_r).top},null,8,["value"]),k.createVNode(k.unref(wn.VRadio),{label:"下",value:k.unref(_r).down},null,8,["value"])])]),_:1},8,["modelValue"])]),k.createElementVNode("div",W7,[k.createElementVNode("span",q7,k.toDisplayString(k.unref(dt)("特殊符号")),1),(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(d(a,5),(U,G)=>(k.openBlock(),k.createElementBlock("div",{class:"row",key:G},[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(U,(I,C)=>(k.openBlock(),k.createBlock(k.unref(wn.VTooltip),{key:I.name,text:I.name,disabled:I.isDisable},{activator:k.withCtx(({props:L})=>[k.createElementVNode("div",{class:k.normalizeClass(M(I)),onClick:B=>v(G,C,5,"special",I)},[k.createElementVNode("img",k.mergeProps({src:I.img,alt:""},L,{style:I.isDisable?"opacity: 0.3;":""}),null,16,Y7)],10,X7)]),_:2},1032,["text","disabled"]))),128))]))),128))])]),k.createElementVNode("div",K7,[k.createElementVNode("div",Z7,[k.createElementVNode("div",J7,[k.createElementVNode("div",$7,[k.createElementVNode("span",Q7,k.toDisplayString(k.unref(dt)("左尺寸")),1),k.createElementVNode("div",t9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:o.leftDim,"onUpdate:modelValue":J[1]||(J[1]=U=>o.leftDim=U),onBlur:J[2]||(J[2]=U=>Z())},null,8,["modelValue"])])]),k.createElementVNode("div",e9,[k.createElementVNode("span",n9,k.toDisplayString(k.unref(dt)("上尺寸")),1),k.createElementVNode("div",r9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:o.topDim,"onUpdate:modelValue":J[3]||(J[3]=U=>o.topDim=U),onBlur:J[4]||(J[4]=U=>Z())},null,8,["modelValue"])])]),k.createElementVNode("div",i9,[k.createElementVNode("span",o9,k.toDisplayString(k.unref(dt)("右尺寸")),1),k.createElementVNode("div",s9,[k.createElementVNode("div",a9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:o.rightDim1,"onUpdate:modelValue":J[5]||(J[5]=U=>o.rightDim1=U),onBlur:J[6]||(J[6]=U=>Z())},null,8,["modelValue"])]),l9,k.createElementVNode("div",c9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:o.rightDim2,"onUpdate:modelValue":J[7]||(J[7]=U=>o.rightDim2=U),onBlur:J[8]||(J[8]=U=>Z())},null,8,["modelValue"])])])])]),k.createElementVNode("div",u9,[k.createElementVNode("div",h9,[k.createElementVNode("span",d9,k.toDisplayString(k.unref(dt)("交错焊缝")),1),k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("间距")),1),k.createElementVNode("div",f9,[k.createVNode(k.unref(wn.VTextField),{onBlur:J[9]||(J[9]=U=>tt()),type:"text",modelValue:o.intWeldSeam,"onUpdate:modelValue":J[10]||(J[10]=U=>o.intWeldSeam=U),disabled:!p.suppleSymbol.filter(U=>U.typeName===k.unref(pn).ZSymbol).length},null,8,["modelValue","disabled"])])]),k.createElementVNode("div",p9,[k.createElementVNode("span",m9,k.toDisplayString(k.unref(dt)("扩充文字")),1),k.createElementVNode("div",g9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:o.weldingSymbolInfo,"onUpdate:modelValue":J[11]||(J[11]=U=>o.weldingSymbolInfo=U),disabled:N(),onBlur:w},null,8,["modelValue","disabled"])])]),k.createElementVNode("div",y9,[k.createElementVNode("span",b9,k.toDisplayString(k.unref(dt)("虚线位置")),1),k.createVNode(k.unref(wn.VRadioGroup),{modelValue:o.dottedLinePos,"onUpdate:modelValue":J[13]||(J[13]=U=>o.dottedLinePos=U)},{default:k.withCtx(()=>[(k.openBlock(),k.createElementBlock(k.Fragment,null,k.renderList(r,U=>k.createVNode(k.unref(wn.VRadio),{onChange:J[12]||(J[12]=G=>j()),key:U.value,label:U.label,value:U.value,style:{"margin-left":"10px"},disabled:p.suppleSymbol.filter(G=>G.typeName===k.unref(pn).ZSymbol).length},null,8,["label","value","disabled"])),64))]),_:1},8,["modelValue"])])])]),k.createElementVNode("div",v9,[k.createElementVNode("span",x9,k.toDisplayString(k.unref(dt)("焊接说明")),1),k.createVNode(k.unref(wn.VTextarea),{modelValue:o.description,"onUpdate:modelValue":J[14]||(J[14]=U=>o.description=U),rows:"6",class:"mb-3",disabled:!p.suppleSymbol.filter(U=>U.typeName===k.unref(pn).TailSymbol).length,onBlur:J[15]||(J[15]=U=>j())},null,8,["modelValue","disabled"])])]),k.createVNode(k.unref(wn.VBtn),{onClick:u,class:"btn"},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(k.unref(dt)("清除行")),1)]),_:1})]))}}),xV="",w9=ss(_9,[["__scopeId","data-v-253ca580"],["__file","WeldingSymbolDialog.vue"]]),M9={class:"fbc",style:{"margin-top":"10px"}},A9={style:{width:"100%",height:"140px"}},S9={class:"fbc"},E9={class:"btnBox"},T9={class:"tiltle"},C9=["onClick"],P9=["src"],D9={style:{width:"60%"}},R9={class:"btnBox fbc",style:{padding:"10px 5px"}},k9={class:"tiltle"},I9={class:"btnBox fbc",style:{padding:"10px 5px"}},L9={class:"tiltle"},B9={class:"fbc"},F9={style:{width:"75%"}},N9={class:"btnBox"},O9={class:"tiltle"},z9={class:"fbc",style:{margin:"10px",width:"75%"}},U9={style:{width:"85%",padding:"0px 10px"},class:"fbc"},V9={class:"fbc",style:{width:"75%",margin:"0px 10px"}},j9={style:{width:"85%",padding:"0px 10px"},class:"fbc"},G9={class:"fbc"},H9={class:"tiltle"},W9={style:{width:"58%"}},q9={style:{width:"20%"}},X9={class:"btnBox"},Y9={class:"tiltle"},K9={style:{display:"flex","align-items":"center",width:"100%","justify-content":"center"}},Z9={style:{width:"50%"}},J9={style:{display:"flex",margin:"5px 0px 10px"}},$9={style:{display:"flex","margin-left":"10px"}},Q9={style:{display:"flex","justify-content":"center",width:"100%","margin-top":"5px"}},tI=k.defineComponent({__name:"GemoetricToleranceDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=[Cr.LineContourdegree,Cr.SurfaceContourDegree],i=k.reactive([{typeName:Cr.Straightness,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAFCSURBVHhe7dQxCoAwEAXR3P/SKlikmSYSYcT58Jopt9hx7cgnYIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8bH/jy6x0YYl7V7dJtNMC5rc3SfDTAua3N0nw0wPtI+8PryOozxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGJVxnJpUjwbRh+nHAAAAAElFTkSuQmCC",name:dt("直线度")},{typeName:Cr.Flatness,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABuCAYAAADGWyb7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAJ+SURBVHhe7dAxDtxQDEPB3P/SSWpjGq/1DQomgWkeVOnP//2tlRgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH+NxX5t+8BDjUV+dfvEA4zFfnv7xAOMxX57+8QDjMV+dfvEQ4zHX6WY7TXcPMR6h6W47TXcPMR6h6W47TXcPMR6h6W6763QzgHGcprvtNN0NYByn6W47TXcDGMdputtO090AxnGa7ra7TjdDGEdputtO090QxlGa7rbTdDeEcZSmu+003Q1hHKXpbrvrdDOIcYymu+003Q1iHKPpbjtNd4MYx2i6207T3SDGMZrutrtON8MYR2i6207T3TDGEZruttN0N4xxhKa77TTdDWMcoeluu+t0cwDjY5ruttN0dwDjY5ruttN0dwDjY5ruttN0dwDjY5rutrtON4cwPqLpbjtNd4cwPqLpbjtNd4cwPqLpbjtNd4cwPqLpbjNNdwcx/kzT3Xaa7g5i/Jmmu+003R3E+DNNd9tpujuI8WfX6WY7TXeHMf5E0912mu4OY/yJprvtNN0dxvgTTXfbabo7jPEn1+lmO013L2C8TdPddpruXsB4m6a77TTdvYDxNk1322m6ewHjbdfpZjtNdy9hvEXT3Xaa7l7CeIumu+003b2E8ZYvT/94CeMtX51+8SLGW746/eJFjLd8dfrFixgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+Rgr2p+//wDqI2fIuIp4ZQAAAABJRU5ErkJggg==",name:dt("平面度")},{typeName:Cr.Roundness,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAABvCAYAAADboi87AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMRSURBVHhe7c5LDiM3EETBuf+lx14LwW7JLn6SqAfEJlGU+s+//W3xOLYsHFsWji0Lx5aFY8vCsWXh2LJwbFk4tiwcWxaOLQvHloVjy8KxZeHYsnBsWTi2LBxbFo4tC8eWhWPLwjHWr+k3AnGMUZ3+IwDH461I/3sojkfalb7lMByPc0L6rkNwPMav6Tfe/JLeH4DjEb5J7/6Pb9PbjThu9U16V+0tvdmE4zZv6c1Mb+nNBhy3eEtvVnlK94txXO4p3e/wlO4X4rjUU7rfbZRuF+G4zFO6P8Uo3S7AcZlRuj3NKN1OxnGJUbo91SjdTsRxulG6Pdko3U7EcTqluwSjdDsJx6lG6TaF0t0kHKdSuksySrcTcJxG6S6R0t0EHKdRukuldFeM4xRKd8mU7opxnELpLp3SXSGOUyjdpVO6K8SxnNLdDZTuCnEsp3R3i890U4hjOaW7WyjdFeFY7jPd3ETprgjHUkp3N1G6K8KxlNLdTZTuinAspXR3m890U4RjKaW723ymmyIcSynd3eYz3RThWErp7jZKdwU4llK6u43SXQGOpZTubvOZbopwLKV0d5vPdFOEYymlu9t8ppsiHEsp3d1E6a4Ix1JKdzdRuivCsZzS3S2U7opwLKd0dwuluyIcyynd3eIz3RTiWE7p7gZKd4U4TqF0l07prhDHKZTuko3SbSGOU4zSbSqlu2Icp1G6S6V0V4zjNKN0m0bpbgKOUyndJRml2wk4TjVKtymU7ibhOJ3SXYJRup2E43SjdHuyUbqdiOMSo3R7KqW7yTguM0q3pxml28k4LjVKt6cYpdsFOC71lO53ekr3i3Bc7ind7/CU7hfiuMVberPKU7pfjOM2b+nNTG/pzQYct/omvav0TXq3CccjfJve/lffprcbcTzGr+k33vyS3h+A43FOSN91CI7H2pG+4zAcj7ci/e+hOMaoTv8RgGO0X9L7QBxbFo4tC8eWhWPLwrFl4diycGxZOLYsHFsWji0Lx5aFY8vCsWXh2LJwbFk4tiwcWxaOLQvHloVjy8Kxxfjz9x8ogK+OZ4gxTQAAAABJRU5ErkJggg==",name:dt("圆度")},{typeName:Cr.Cylindricity,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsCAYAAACPZlfNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANQSURBVHhe7c7BCuM4EATQ+f+fnt0cBoJ57cixJVWgC96lVI395//8bT+FZcvFsuVi2XKxbLlYtlwsWy6WLRfLlotly8Wy5WLZcrFsuVi2XCxbLpYtF8uWi2XLxbLlYtlysWy5WLZcLFsuli0Xy5aL5U95j95TvEfvg1j+DEW7BMdoM4Dlz1C0203RbgDLn1BF290U7Qaw/AmKdrsp2g1iGa+Ktrsp2g1iGU/RbjdFuwtYRlO0262KthewjFVF290U7S5iGUv59P6e9+1MVbS9iGWkGdF3nqBo9wWWkWZG3/tWFW2/wDLOiui731C0+xLLOCuj749StLuBZZTR6FZGorsRinY3sIzyKboZ8Sm6OaNodxPLGGfR/htn0V6qaHsTywhn0f6Os2h/pGj3AJYRqmj7hCravqui7QNYbldF2ydV0fYfRbuHsNyqirYzKNq9VNH2ISy3qqLtLMqd3YNYbqVoN5PyzWYClttU0XY25eztlff7SVhuo2i3gjLyNhnLLRTtVlGq/pXj/SQsl6ui7UrHqHvleDcRy+WqaLvSaHQ7CculzqL9SiPR3UQslzqL9iuNRHcTsVzmU3Sz0qfoZjKWy3yKblY6i/YLsFxiJLpb6SzaL8ByiZHobqUq2i7CcrrR6HalKtouwnKqKtXb8X6VKtouxHIqZeRttSraLsRymipn7+/3KynaLcZyGuWbzWxVtF2M5RRVRnbHzUxVtN2A5RSKdi+KdjMo2m3C8nFVtH2pou2Tqmi7CcvHKdq9q6LtE6pouxHLRynaHZ1F+zvOov1GLB9TRVs5i/ZXfYpuNmP5GEW7M5+imxEj0d1mLB9RRdtPRqPbd1ei+wAsH6FoN2p19A8BWN5WRdurVkTfDcHyNkW7O2ZF3wrC8hZFu6c8HX0jCMtbFO1mqTKyO24Csfyaot1uVbQNw/IrVbTdTdEuEMuvKNrtVkXbQCwvq6Ltbop2oVhepmi3WxVtQ7G8pIq2uynaBWN5iaLdbop24VgOU7RLoGgXjuUlx2iT4BhtfgDLy/5Fb0n+RW8/gmXLxbLlYtlysWy5WLZcLFsuli0Xy5aLZcvFsuVi2XKxbLlYtlwsWy6WLRfLlotly8Wy5WLZcrFsuVi2SH/+/gesHHGw7eaGswAAAABJRU5ErkJggg==",name:dt("圆柱度")},{typeName:Cr.LineContourdegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAYAAAAdHLWhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAI1SURBVHhe7c5BjqNAFETBvv+le2bZsgKMigKSUqYUm+dftn/+77eiMVYOxsrBWDkYKwdj5WCsHIyVg7FyMFYOxsrBWDkYKwdj5WCsHIyVg7FyMFYOxsrBWDkYKwdj5WCsHIyVg7FyMFYOxsrBWDkYKwdj5WCsHIyvsjfdvwxjrFnTd4dijHL19JtBGCPcPf2HAIyPenr6Tw9ifMTI9D0yMn3PAxhvd3R6O+Lo9PZmjLc5Mr2b5cj07kaMt/g2vbnKkendDRgv9216c4dv05uLMV5qb7p/wt50fyHGy+xN90/am+4vwniJvek+wd50fwHG6fam+yRb0+0FGKfbmm4TbU23kzFOtTXdJtuabidinGZrun0DTXcTMU6j6e4ttqbbSRin2Jpu32Rrup2AcQpNd2+k6W4CxtM03b3V1nR7EuNpmu7eTNPdSYynaLp7O013JzGeouluBZruTmA8RdPdCjTdncA4TNPdKjTdncA4TNPdSjTdDWIcpuluJZruBjEO03S3Ek13gxiHfU43q9F0N4hxiKa7FX1ON4MYh2i6W9HndDOIcYimuxV9TjeDGIdouluRprsBjEM03a1I090AxiGa7lb0Od0MYhz2d/p8ZX+nzwcxVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrws/vP1gI08FUACh8AAAAAElFTkSuQmCC",name:dt("线轮廓度")},{typeName:Cr.SurfaceContourDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAYAAAAdHLWhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAIvSURBVHhe7dDLauRAFERB//9PewyzMG5C/agqSSmRCbE53LIbff3su6IxVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYLyET6b3F8EYafX0PwIxxjhi+r9BGE931vRbTsZ4moTpd52I8RSfTO9f+XT6GydgPNS709sZ70zvDsZ4mHemdyu9M707COMhXk1v9vRqenMAxt09m+6P8mp6szPGXT2b7s/wbLrfEeNutqbbsz2b7nfCuIut6TbFs+l+B4zLbU23aZ5N94sxLrU13abamm4XY1xqa7pNtjXdLsS4zNZ0ewVb0+0ijMtoursSTXeLMC6h6e5qtqbbBRinbU23V6TpbgHGaZrurmprup3EOE3T3ZVpupvEOEXT3dVpupvEOEXT3R1oupvAOEXT3R1oupvAOEzT3V1oupvAOEzT3Z1ouhvEOEzT3Z1ouhvEOOxxurkbTXeDGIdoursbTXeDGIdourujx+lmEOMQTXd39DjdDGIc0v1O32cQ45Du7/SNBjAO6f5O32gA45Dud/o+gxiHdf+nbzOIsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrwtf3P04oQotbv3IGAAAAAElFTkSuQmCC",name:dt("面轮廓度")},{typeName:Cr.Parallelism,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHUAAAB2CAYAAAD2kNwSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMfSURBVHhe7cpBbiQxDARB///T3j0ag+CFDalVGiYQF7J+/vc7rsPjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbj1/ib/k/9Tf9FePwKn2nz1GfaLMDj9aq07VLaLcDj9ZR2XVXaLsDj1aq07VLaLcLj1ZR2XVXaLsLjtaq07VLaLcTjtZR2XVXaLsTjlaq07VLaLcbjlZR2XUq7DXi8jtLuCaXdBjxepUrbLqXdJjxeRWnXVaXtJjxeo0rbLqXdRjxeQ2nXVaXtRjxeoUrbLqXdZjxeQWnXVaXtZjzGq9K2S2n3Ah7jKe26lHYv4TGa0u4Jpd1LeIxVpW2X0u5FPMZS2nVVafsiHiNVadultHsZj5GUdl1V2r6MxzhV2nYp7Q7AYxylXVeVtgfgMYrS7gml3SF4jKK061LaHYTHGEq7riptD8JjhCptu5R2h+ExgtKuq0rbw/B4vCptu5R2B+LxeEq7riptD8Tj0aq07VLaHYrHoyntuqq0PRSPx1LaPaG0OxiPx1LadSntDsfjkZR2XVXaHo7H41Rp26W0C8DjcZR2XVXaBuDxKFXadintQvB4FKVdV5W2IXg8RpW2XUq7IDweQ2nXVaVtEB6PoLR7QmkXhscjKO26lHaBeHyd0q6rSttAPL6qStsupV0oHl+ltOuq0jYUj6+p0rZLaReMx9co7bqqtA3G4yuqtO1S2oXj8RVKu64qbcPxuJ3S7gml3QV43KpK2y6l3SV43Epp11Wl7SV43KZK2y6l3UV43EZp11Wl7UV43KJK2y6l3WV43EJp11Wl7WV4XK5K2y6l3YV4XE5p11Wl7YV4XEpp94TS7lI8LlOlbZfS7mI8LqO066rS9mI8LqO061LaXY7HZT7T5gml3eV4XOYzbZ76m/5fgMeRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjccR6+f3HzqUJkJd55AeAAAAAElFTkSuQmCC",name:dt("平行度")},{typeName:Cr.Perpendicularity,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAB2CAYAAAAdp2cRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAIOSURBVHhe7dAxbhwwEARB/f/TJ4c2VMroYBszQCXNjfj1Z59JYpz7GOc+xrmPce5jnPsY5z7GuY9x7mOc+xjnPsa5j3HuY5z7GOc+xrmPce5jnPsY5z7GuY9x7mPM+Xt6D2JM0XQXw5ii6S6GMUXTXQxjiqa7GMYUTXcxjCma7mIYUzTdxTCmaLqLYUzRdBfDmKLpLoYxRdNdDGOKprsYxhRNdzGMKZruYhhTNN3FMKZouothTNF0F8OYoukuhjFF010MY4qmuxjGFE13MYwpmu5iGFM03cUwpmi6i2FM0XQXw5ii6S6GMUXTXQxjiqa7GMYUTXcxjCma7mIYUzTdxTCmaLqLYUzRdBfDmKLpLoYxRdNdDGOKprsYxhRNdzGMKZruYhhTNN3FMKZouothTNF0F8OYoukuhjFF010MY4qmuxjGFE13MYwpmu5iGFM03cUwpmi6i2FM0XQXw5ii6S6GMUXTXQxjiqa7GMYUTXcxjCma7mIYUzTdxTCmaLqLYUzRdBfDmKLpLobxqe3n9E+PMT6zefqrxxif2X6f/ushxmc2T3/1GONT27/TH/0HjHMf49zHOPcxzn2Mcx/j3Mc49zHOfYxzH+Pcxzj3Mc59jHMf49zHOPcxzn2Mcx/j3Mc49zHOfYxzH+Pcxzj3Mc59jHMf49zHOPcxzn2Mcx/j3Mc49zHOfYxz2tfnG9KSrK0xvl/KAAAAAElFTkSuQmCC",name:dt("垂直度")},{typeName:Cr.TiltDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAYAAAAdHLWhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAJFSURBVHhe7dRJbsQwEEPR3P/SSSfInM9KD5ZMqUjgbT5qJRh+uuw5rGEMHxjDB8bwgTF8YAwfGMMHxvCBMXxgDB8YwwfG8IExfGAM4XXUB8IYv/we3QyCMb5Ro9sBMMa7anQ/AMa4qEb3g2CMCzW6HQhje2p0OxjG1tTodgKMbanR7SQYW1Kj24kwtqNGt5NhbEWNbk+AsQ01uj0JxhbU6PZEGLenRrcnw7g1Nbo1gHFb1ejeAMYtVaN7Exi3U43ujWDcSjW6N4NxG9Xo3hDGLVSje1MYl1eN7o1hXFo1ujeHcVnV6H4BGJdUje4XgXE51eh+IRiXUo3uF4NxGdXofkEYl1CN7heFcQlqdLswjPbU6HZxGK2p0e0GMNpSo9tNYLSkRrcbwWhHjW43g9GKGt1uCKMNNbrdFEYLanS7MYynU6PbzWE8lRrdNoDxNNXovgGMp6hG901gnK4a3TeCcapqdN8Mxmmq0X1DGKeoRvdNYRyuGt03hnGoanTfHMZhqtF9cByiGt3HG4yHq0b38QnjoarRffyA8TDV6D7+wHiIanQfCOMh1Og2JIwPU6PbKGF8iBrdxr8w3k2NbuMqGO+iRrdxNYw3U6PbuAnGm6jRbdwM49XU6DbugvEqanQbd8P4LzW6jYdgLGVTP0SMUvY1ep8BMErZ1+h9BsBYyox/cR86j95jIIzhA2P4wBg+MIYPjOEDY/jAGD4whg+M4QNj+MAYPjCGD4zhA2P4wBg+MIYPjOEDY/jAGD4whg+MYeHp+QW0S7wDo2QXJQAAAABJRU5ErkJggg==",name:dt("倾斜度")},{typeName:Cr.PositionalDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsCAYAAACPZlfNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMaSURBVHhe7dDhSuVQDIXRef+XdkZEkLBOe6rXnGTIB+tP3G3l/vnX22iFx1EXj6MuHkddPI66eBx18Tjq4nHUxeOoi8dRF4+jLh5HXTyOungcdfE46uJx1MXjqIvHURePoy4eR108tvaZ/vYf4LGtmDbN8dhWTJvmeGwrpk1zPLYV06Y5HtuKadMcj23FtGmOx7Zi2jTHY1sxbZrjsa2YNs3x2FZMm+Z4bONpekczPJb2qvTuBngs6bfStwrjsZSs9O2CeCwjO/0PxfBYwk53z9z9XcVniuHxuLv0zLuYNu/u0jNF8HjUVdp/FdPmq6u0L4DHY67SPoppE12l/WE8HnGV9hLTZmWVtgfxeMQqbVdi2qys0vYgHtOt0vZKTJsrq7Q9hMd0Srs7MW3uKO0O4TGV0m5HTJsdSrsDeEyltNsR02aH0u4AHtMo7XbFtNmltEvGYxql3a6YNruUdsl4TKO02xXTZpfSLhmPaWLaPBHT5gmlXSIeUyjtnohp84TSLhGPKZR2T8S0eUJpl4jHH5k+0m/zAjz+yPSRfpsX4PFHpo/027wAjz8yfaTf5gV4TKG0eyKmzRNKu0Q8plDaPRHT5gmlXSIeUyjtnohp84TSLhGPaZR2u2La7FLaJeMxjdJuV0ybXUq7ZDymUdrtimmzS2mXjMdUSrsdMW12KO0O4DGV0m5HTJsdSrsDeEy1Sts7MW3urNL2AB7TrdL2SkybK6u0PYTHI5R2V2LaXFml7SE8HrFK25WYNiurtD2Ix2NWaSsxbWSVtofxeNRV2n8V0+arq7QvgMfjrtL+U0ybT1dpXwSPJdy188zOJqZnCuGxjN1W++++pzAeS8lK3y6Ix5J+K32rMB5Le1V6dwM8tvDd9K5GeGwrpk1zPLYV06Y5HtuKadMcj23FtGmOx7Zi2jTHY1sxbZrjsa2YNs3x2FZMm+Z4bCumTXM8thXTpjke24pp0xyPoy4eR108jrp4HHXxOOricdTF46iLx1EXj6MuHkddPI66eBx18Tjq4nHUxeOoi8dRF4+jLh5HXTyOungcJf15+wsBQMJfZ/0u7gAAAABJRU5ErkJggg==",name:dt("位置度")},{typeName:Cr.Coaxiality,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAACDCAYAAABY+O+7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAWxSURBVHhe7c7LDuQoEEXB/v+f7pklSkViFy9DiyPFJnVx1Z//+3v9k3i8zsfjdT4er/PxeJ2Px+t8PF7n4/E6H4/X+Xi8zsfjdT4er/PxeJ2Px+t8PP5TsrT9h/B4pBHpu4fi8Rgz0+8dhMftrU7/YXM8buvr9J82xeN2WtJ3pCV9ZzM8buVtetvibXq7ER638Da9HeFtersBHj/3lN7M8ia9+xiPn3pKb1Z4Sm8+xONnamn/hVraf4THT9TS/ku1tP8Aj8vV0n4HtbRfjMelsrTdTS3tF+JxmSxtd1VL+0V4XCJL293V0n4BHqfL0vYUWdouwON0Wdq2+DV9o0WWtpPxOFWWtr8Ylb79iyxtJ+Jxmixt35qVfuutLG0n4XEapd0bK9LvvpGl7SQ8TpGl7ZOWRrz9RZa2E/A4XJa2T96kdzVv0rsnSrsJeBxOaVfzJr37xVN6U5Ol7WA8DpWlbeYpvelRS/sapd1gPA6ltMvU0n6UWtrXKO0G4nEopV0mS9sZsrTNKO0G4nEYpV0mS9uZsrTNKO0G4XEYpZ1kabtClraitBuExyGUdpKl7UpKO1HaDcLjEEo7UdqtlqWtKO0G4HEIpV2Upe0XsrSNlHYD8NhNaSdKuy8p7URp14nHbkq7SGn3tSxtI6VdJx67Ke0ipd0OlHaR0q4Tj12UdpHSbhdZ2kYxbTrx2EVpFyntdqK0i5R2HXjsorQrZWm7E6VdpLTrwGOXmDaR0m5HSruS0q4Dj82UdpHSbkdKuyimTQcemyntSkq7XSntIqVdIx6bKe1KSrudKe1KSrtGPDZT2pWUdjtT2pWUdo14bKa0Kyntdqa0KyntGvHYLKZNFNNmd0q7ktKuEY/NYtqUlHYniGlTUto14rGJ0q6ktDtBTJsopk0jHpso7UpKuxMo7UoxbRrx2ERpV1LanUBpV4pp04jHJkq7ktLuBEq7UkybRjw2UdqVlHYnUNqVYto04rGJ0q6ktDuB0q6ktGvAYxOlXUlpdwKlXUlp14DHJkq7ktLuBEq7UkybRjw2UdqVlHYnUNqVYto04rGJ0q6ktDuB0q4U06YRj02UdiWl3QmUdqWYNo14bBbTpqS0O0FMmyimTSMem8W0iWLa7E5pV1LaNeKxWUybKKbN7pR2JaVdIx6bKe1KSrudKe1KSrtGPDZT2pWUdjtT2pWUdo14bKa0KyntdhbTJlLaNeKxmdIuUtrtSGkXxbTpwGOXmDaR0m5HSruS0q4Dj12UdiWl3Y6UdiWlXQceuyjtIqXdTpR2kdKuA49dlHaR0m4nSrtIadeBxy5KuyhL2x0o7SKlXSceuyntIqXdDpR2kdKuE4/dlHZRlrZfUtqJ0q4Tj92UdqK0+0qWtpHSbgAeh1DaRVnafkFpJ0q7AXgcQmknWdqulKWtKO0G4HGILG0lS9sVsrQVpd0gPA6jtJMsbWfL0jajtBuEx2GUdpksbWeppb1kaTsIj0Mp7TK1tB+plvYZpd1APA6ltKuppf0ItbTPZGk7EI/DKe1qntKbFk/pTY3SbjAeh8vStuYpvXnrTXpXk6XtYDxOobR78ja9lbfp7ROl3QQ8TpGl7ZOV6fffUNpNwuM0Wdq+MTv95htZ2k7C41RKu1+MTr/xC6XdRDxOlaXtr3rTN3+Vpe1EPE6XpW2Pp/SmR5a2k/G4RJa2J8jSdgEel6il/c6ytF2Ex2Vqab+jWtovwuNStbTfSS3tF+JxuVra76CW9ovx+Ila2n/lKb35AI+feUpvVnpKbz7C46ee0pvZ3qR3H+Lxc2/Su9HepHcb4HEbb9PbHm/T203wuJVf0vu3fk3f2AiPW9ol/bcN8bi1r9J/2RiPR1iVfvsAPB5ndPqNw/B4tNb0rYPxeJ2Px+t8PF7n4/E6H4/X+Xi8zsfjdT4er/PxeJ2Px+t8PF7n4/E6H4/X+Xi8jvbn73/ATYsgsquSGAAAAABJRU5ErkJggg==",name:dt("同轴度")},{typeName:Cr.SymmetryDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABlCAYAAABUfC3PAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAFHSURBVHhe7dAhDsAwEMTA/v/TbVlADaKA+oBXGmKSU653d8bBGBfGuDDGhTEujHFhjAtjXBjjwhgXxrgwxoUxLoxxYYwLY1wY48Ko+XP0/hAYFdboFhlGhTW6RYZRYY1ukWFUGKM7BsAYF8a4MMaFMS6McWGMC2NcGOPCGBfGuDDGhTEujHFhjAtjXBjjwhgXxrgwxoUxLoxxYYwLY1wY48IYF8ZtbY3+5xDGLe07+qcDGLe07+ifDmDc1tbofw5hjAtjXBjjwhgXxrgwxoUxLoxxYYwLY1wY48IYF8a4MMaFMS6McWGMC2NcGOPCGBfGuDDGhTEujHFhVBijOwbAqLBGt8gwKqzRLTKMCmN0xwAY48IYF8a4MMaFMS6McWGMC2NcGOPCGBfGuDDGhTEujHFhjAtjXBjjwhgXxrgwxoUxLozRXPcDtK31g/W1X9AAAAAASUVORK5CYII=",name:dt("对称度")},{typeName:Cr.CircleJumping,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABnCAYAAAAdQVz5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAKbSURBVHhe7cxLimMxEATAvv+le8YLgzAh+bUNrz5SQmyyUvr5n98jLZZHDiyPHFgeObA8cmB55MDyyIHlkQPLIweWRw4sjxxYHjmwPHJgeeTAcjtjdA/CciuKdgFYbmMWbQOw3MIq2gdg2d676E0Alq1did4FYNnW1ehtAJbt/DX6IwDLVj6J/gnAso1Po78CsGzhm+i/ACzL+zb6MwDL0lZ5d3/m9c8gLMta5d19zOu/QViWtMqVzZjx30Asy1lltVn1CbAsZZV3u1WfAMsyVnm3u3ILxrKEVa5sr9yCsUxvlavb1X18H4hlarNo+6D85R6IZVqzaPuk/OUeiGU6q2j/pHyyCcIylVW0HymfbIKwTGMV7UfKN7sALFNYRftXyje7ACzDraL9q1mubrULwDLcLNqKot2Dol0AluEU7WYU7R4U7QKwTGGM7jOKdk+KdgFYlqZo96RoF4BlWYp2I0W7ACzLUrQbKdoFYFnSLNq+GqN7EJYlKdoVwrKcWbQthGU5inbFsCxH0a4YlqUo2hXEshRFu4JYlqFoVxTLMhTtimJZwizaFsWyBEW7wliWoGhXGMv0FO2KY5meol1xLFNTtGuAZWqKdg2wTGsWbRtgmZaiXRMsU5pF2yZYpqRo1wjLlBTtGmGZjqJdMyzTUbRrhmUqinYNsUxF0a4hlmnMom1DLNNQtGuKZRqKdk2xTEHRrjGWKSjaNcYynKJdcyzDKdo1xzLULNo2xzKUot0GWIZStNsAyzCKdptgGUbRbhMsQyjabYRlCEW7jbC8naLdZljeTtFuMyxvNYu2m2F5K0W7DbG8laLdhlje6jXabIrl7cbovimWRw4sjxxYHjmwPHJgeeTA8siB5ZEDyyMHlkcOLI9wP7//ACh6RmsONhjLAAAAAElFTkSuQmCC",name:dt("圆跳动")},{typeName:Cr.FullBeat,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAABzCAYAAACrQz3mAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQ7SURBVHhe7c9BjuQgEAXRvv+le6YWliz0wC6wE7JFSLH5GVhVP//53f4ZOW5zynGbU47bnHLc5pTjNqcctznluM0px21OOW5zynGbU47bnHLc5pTjNqcctznluM0px21OOW5zynGbU47bnHL8E5aomWGJmk45pleoi1ao65RjamuojbSG2k45prWF+ihbqO+UY0qv0JsIr9CbTjmm8w5697Z30LtOOabyLnr7pnfR2045pvEb9P4tv0HvO+WYwm/RN97wW/SNTjkubw/6ztP2oO90ynFpe9G3nnIEfa9Tjks6ir75hKPom51yXM4WV/eD8ptP2OLqflB+c0COS9niTnNw/uYTtri6nym/OyDHZWzRarQf/RO2aDXaj/4BOS5hi6tO+/nNiC2uOu3nN4NynG6Lq652O7/rtcVVV7ud3w3Kcaot7rS12/ldjy3utLXb+d2gHKfZ4k7bup9v39riTtu6n2+Dcpxii7t9636+fWOLu33rfr4NyjHcFt/0reZ8u2uLb/pWc74NyjHUFuo/iqumvF/ZQv1HcdWU9wE5htlC/aG4asp7yxbqP9a46sr7gBxDbKH+UNzp1Mgaas+KO52aTjm+bgv1Z8WdTk1pDbWl4k6nplOOr1pDbalQ97FEzWEL9aVC3ccSNZ1yfM0aaqVQ97FEzWENtVKo+1iiplOOrynUyRpqP5aoORTqpFB3WKKmU46vWaKmplB3WKLmsERNTaHusERNpxxf9UC3lkLdYYmaswe61ayh9rBETaccl1OoO1uiZlSh7myJmk45LqdQd7ZEzahC3dkSNZ1yXEqhrrREzYhCXWmJmk45LqVQJw90G1Wokwe6DchxGWuojVSoC5bjMgp10Qp1wXJcwhpqI62hNliOSyjURSvUTZDjEgp10Qp1E+Q4XaEuWqFukhynK9RFK9RNkuNUhbpohbqJcpyqUBetUDdRjtOsoTZSoW6yHKcp1EUr1E2W4zSFukhrqJ0sxykKddEKdQvIcYpCXbRC3QJyDFeoi1aoW0SO4Qp10Qp1i8gx1BpqIxXqFpJjqEJdtELdQnIMs4baSGuoXUiOYQp10Qp1i8kxTKEuWqFuMTmGKNRFK9QtKMcQhbpohboF5fi6Ql20Qt2icnxdoS5aoW5ROb5qDbWRCnULy/FVhbpohbqF5fiqQl2kNdQuLMfXFOqiFeoWl+NrCnXRCnWLy/EVhbpohboEcnxFoS5aoS6BHB+3htpIhbokcnxcoS5aoS6JHB9XqIu0htokcnxUoS5aoS6RHB9VqItWqEskx8cU6qIV6pLJ8TGFumiFumRyfEShLlqhLqEcHzET+v0J5ThsNvQfEspx2Ezo9yeV4yNmQb89qRwfc3X0mxPLcZtTjtucctzmlOM2pxy3OeW4zSnHbU45bnPKcZtTjtucctzmlOM2pxy3OeW4zSnHbU45btP58/sPTui//PWeJpwAAAAASUVORK5CYII=",name:dt("全跳动")},{typeName:Cr.None,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:dt("清除"),isChecked:!0}]),s=k.reactive({isShowFull:!1,topDim:"",downDim:""}),a=k.reactive([{toleranceCode:Cr.None,tolerance:[],Benchmark:{b1:[[],[]],b2:[[],[]],b3:[[],[]]}}]),o=()=>{a.push({toleranceCode:Cr.None,tolerance:[],Benchmark:{b1:[[],[]],b2:[[],[]],b3:[[],[]]}}),h.value+=1},r=()=>{a.splice(h.value-1,1),h.value===1?h.value=1:h.value-=1,x()},u=w=>{let M="item";return a[h.value-1].toleranceCode===w.typeName&&(M+=" checked"),M},l=(w,M)=>{const E=[];for(let D=0;D<w.length;D+=M)E.push(w.slice(D,D+M));return E},h=k.ref(1),f=(w,M,E,D)=>{const N=w*E+M;i.forEach(V=>{V.isChecked=!1}),i[N].isChecked=!0,a[h.value-1].toleranceCode=i[N].typeName,e.includes(a[h.value-1].toleranceCode)||(s.isShowFull=!1),x()};let d,p;k.onMounted(()=>{sl.value=500;const{wipeout:w,midPt:M}=Pb();d=M.clone(),ps.value?(p=ps.value.clone(),s.isShowFull=p.isShowFullWeekSymbol,s.downDim=p.dimNotesDown,s.topDim=p.dimNotesUp,a.length=0,a.push(...p.dimToleranceContents),a.forEach(D=>{Object.keys(D.Benchmark).forEach(V=>{var K,j;((K=D.Benchmark[V])==null?void 0:K.length)===3&&((j=D.Benchmark[V])==null||j.splice(1,1))})})):p=new bf,p.setStartPoint(d);const E=new A.McGeVector3d(10,10,0);p.setTurningPoint(d.clone().addvec(E)),p.setEndPoint(d.clone().addvec(E).addvec(A.McGeVector3d.kXAxis.clone().mult(5))),x()});const b=()=>{a[h.value-1]={toleranceCode:Cr.None,tolerance:[],Benchmark:{b1:[[],[]],b2:[[],[]],b3:[[],[]]}},s.downDim=s.topDim="",x()},v=k.ref(),x=()=>re(this,null,function*(){const w=a.filter(J=>J.toleranceCode!==Cr.None);p.dimToleranceContents=JSON.parse(JSON.stringify(w)),p.isShowFullWeekSymbol=s.isShowFull,p.dimNotesDown=s.downDim,p.dimNotesUp=s.topDim;const M=A.MxCpp.getCurrentMxCAD(),E=M.drawEntity(p),{minPt:D,maxPt:N}=p.getBoundingBox(),V=N.sub(D).normalize().mult(2);D.addvec(V.clone().negate()),N.addvec(V);let K=new A.McGeLongArray;K.copyFormAryId([E]),A.MxCpp.App.MxCADAssist.MxExplode(K.imp);let j=(N.x-D.x)*10,Z=120/300*j;const tt=yield cf({type:"image/bmp",width:j,height:Z,range_pt1:D.toVector3(),range_pt2:N.toVector3()});v.value.src=tt,M.mxdraw.updateCanvasSize();let rt=new A.MxCADSelectionSet;rt.crossingSelect(D.x,D.y,N.x,N.y),rt.forEach(J=>{J.erase()}),n("receiveParameters",{formData:wi({dimToleranceContents:w},s)})});return(w,M)=>(k.openBlock(),k.createElementBlock("div",null,[k.createElementVNode("div",M9,[k.createElementVNode("div",A9,[k.createElementVNode("img",{alt:"",ref_key:"img",ref:v,style:{width:"100%",height:"100%"}},null,512)])]),k.createElementVNode("div",S9,[k.createElementVNode("div",E9,[k.createElementVNode("span",T9,k.toDisplayString(k.unref(dt)("公差代号")),1),(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(l(i,5),(E,D)=>(k.openBlock(),k.createElementBlock("div",{class:"row",key:D},[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(E,(N,V)=>(k.openBlock(),k.createBlock(k.unref(wn.VTooltip),{key:N.name,text:N.name},{activator:k.withCtx(({props:K})=>[k.createElementVNode("div",{class:k.normalizeClass(u(N)),onClick:j=>f(D,V,5)},[k.createElementVNode("img",k.mergeProps({src:N.img,alt:""},K,{style:N.isDisable?"opacity: 0.3;":""}),null,16,P9)],10,C9)]),_:2},1032,["text"]))),128))]))),128))]),k.createElementVNode("div",D9,[k.createElementVNode("div",R9,[k.createElementVNode("span",k9,k.toDisplayString(k.unref(dt)("公差1")),1),k.createVNode(k.unref(wn.VCombobox),{style:{width:"15%"},items:["","S","R","φ","SR","CR","Sφ"],modelValue:a[h.value-1].tolerance[0],"onUpdate:modelValue":M[0]||(M[0]=E=>a[h.value-1].tolerance[0]=E),disabled:a[h.value-1].toleranceCode===k.unref(Cr).None,onBlur:M[1]||(M[1]=E=>x())},null,8,["modelValue","disabled"]),k.createVNode(k.unref(wn.VCombobox),{style:{width:"20%","margin-left":"10px"},"return-object":"",modelValue:a[h.value-1].tolerance[1],"onUpdate:modelValue":M[2]||(M[2]=E=>a[h.value-1].tolerance[1]=E),disabled:a[h.value-1].toleranceCode===k.unref(Cr).None,onBlur:M[3]||(M[3]=E=>x())},null,8,["modelValue","disabled"]),k.createVNode(k.unref(wn.VSelect),{style:{width:"15%","margin-left":"10px","font-size":"12px"},items:[{text:"",value:""},{text:"(+)",value:"+"},{text:"(-)",value:"-"},{text:"(◁)",value:"<"},{text:"(▷)",value:">"}],"item-title":"text","item-value":"value",modelValue:a[h.value-1].tolerance[2],"onUpdate:modelValue":[M[4]||(M[4]=E=>a[h.value-1].tolerance[2]=E),M[5]||(M[5]=E=>x())],disabled:a[h.value-1].toleranceCode===k.unref(Cr).None},null,8,["modelValue","disabled"]),k.createVNode(k.unref(wn.VSelect),{style:{width:"10%","margin-left":"10px"},"item-title":"text","item-value":"value",items:[{text:"",value:""},{text:"Ⓟ",value:"p"},{text:"Ⓜ",value:"m"},{text:"Ⓔ",value:"{"},{text:"Ⓛ",value:"l"},{text:"Ⓕ",value:"@"}],modelValue:a[h.value-1].tolerance[3],"onUpdate:modelValue":[M[6]||(M[6]=E=>a[h.value-1].tolerance[3]=E),M[7]||(M[7]=E=>x())],disabled:a[h.value-1].toleranceCode===k.unref(Cr).None},null,8,["modelValue","disabled"]),k.createVNode(k.unref(wn.VBtn),{style:{"margin-left":"10px","font-size":"12px",padding:"0px","min-width":"0px",height:"20px",width:"30px",display:"flex","align-items":"center","justify-content":"center"},class:k.normalizeClass(a[h.value-1].tolerance[4]?"checkBtn":""),disabled:a[h.value-1].toleranceCode===k.unref(Cr).None||!["m","l"].includes(a[h.value-1].tolerance[3]),onClick:M[8]||(M[8]=()=>{a[h.value-1].tolerance[4]?a[h.value-1].tolerance[4]="":a[h.value-1].tolerance[4]="}",x()})},{default:k.withCtx(()=>[k.createTextVNode("Ⓡ")]),_:1},8,["class","disabled"])]),k.createElementVNode("div",I9,[k.createElementVNode("span",L9,k.toDisplayString(k.unref(dt)("公差2")),1),k.createVNode(k.unref(wn.VCombobox),{style:{width:"10%"},disabled:""}),k.createVNode(k.unref(wn.VCombobox),{style:{width:"15%","margin-left":"10px"},disabled:""}),k.createVNode(k.unref(wn.VSelect),{style:{width:"20%","margin-left":"10px","font-size":"12px"},disabled:""}),k.createVNode(k.unref(wn.VSelect),{style:{width:"10%","margin-left":"10px"},disabled:""}),k.createVNode(k.unref(wn.VBtn),{disabled:"",style:{"margin-left":"10px","font-size":"12px",padding:"0px","min-width":"0px",height:"20px",width:"30px",display:"flex","align-items":"center","justify-content":"center"}},{default:k.withCtx(()=>[k.createTextVNode("Ⓡ")]),_:1})])])]),k.createElementVNode("div",B9,[k.createElementVNode("div",F9,[k.createElementVNode("div",N9,[k.createElementVNode("span",O9,k.toDisplayString(k.unref(dt)("附注")),1),k.createElementVNode("div",z9,[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("顶端")),1),k.createElementVNode("div",U9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:s.topDim,"onUpdate:modelValue":M[9]||(M[9]=E=>s.topDim=E),disabled:a[h.value-1].toleranceCode===k.unref(Cr).None,onBlur:M[10]||(M[10]=E=>x())},null,8,["modelValue","disabled"])])]),k.createElementVNode("div",V9,[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("底端")),1),k.createElementVNode("div",j9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:s.downDim,"onUpdate:modelValue":M[11]||(M[11]=E=>s.downDim=E),disabled:a[h.value-1].toleranceCode===k.unref(Cr).None,onBlur:M[12]||(M[12]=E=>x())},null,8,["modelValue","disabled"])])])]),k.createElementVNode("div",G9,[(k.openBlock(!0),k.createElementBlock(k.Fragment,null,k.renderList(Object.keys(a[h.value-1].Benchmark),(E,D)=>(k.openBlock(),k.createElementBlock("div",{class:"btnBox",style:{width:"32%",padding:"10px 5px 0px"},key:E},[k.createElementVNode("span",H9,k.toDisplayString(k.unref(dt)("基准"))+k.toDisplayString(D+1),1),(k.openBlock(),k.createElementBlock(k.Fragment,null,k.renderList(2,N=>k.createElementVNode("div",{class:"fbc",key:N,style:{"margin-bottom":"5px"}},[k.createElementVNode("div",W9,[k.createVNode(k.unref(wn.VTextField),{type:"text",modelValue:a[h.value-1].Benchmark[E][N-1][0],"onUpdate:modelValue":V=>a[h.value-1].Benchmark[E][N-1][0]=V,disabled:a[h.value-1].toleranceCode===k.unref(Cr).None,onBlur:M[13]||(M[13]=V=>x())},null,8,["modelValue","onUpdate:modelValue","disabled"])]),k.createVNode(k.unref(wn.VSelect),{style:{width:"40%","margin-left":"5px"},"item-title":"text","item-value":"value",items:[{text:"",value:""},{text:"Ⓜ",value:"m"},{text:"Ⓔ",value:"{"},{text:"Ⓛ",value:"l"}],modelValue:a[h.value-1].Benchmark[E][N-1][1],"onUpdate:modelValue":[V=>a[h.value-1].Benchmark[E][N-1][1]=V,M[14]||(M[14]=V=>x())],disabled:a[h.value-1].toleranceCode===k.unref(Cr).None},null,8,["modelValue","onUpdate:modelValue","disabled"])])),64))]))),128))])]),k.createElementVNode("div",q9,[k.createVNode(k.unref(wn.VCheckbox),{label:`${k.unref(dt)("全周符号")}`,modelValue:s.isShowFull,"onUpdate:modelValue":M[15]||(M[15]=E=>s.isShowFull=E),disabled:!(a.length==1&&e.includes(a[h.value-1].toleranceCode)),onChange:M[16]||(M[16]=E=>x())},null,8,["label","modelValue","disabled"]),k.createElementVNode("div",X9,[k.createElementVNode("span",Y9,k.toDisplayString(k.unref(dt)("当前行")),1),k.createElementVNode("div",K9,[k.createElementVNode("div",Z9,[k.createElementVNode("div",J9,[k.createElementVNode("span",null,k.toDisplayString(h.value),1),k.createElementVNode("div",$9,[k.createVNode(k.unref(wn.VBtn),{style:{padding:"0px","min-width":"0px",height:"20px",width:"20px","margin-right":"5px"},disabled:a.length===1,onClick:M[17]||(M[17]=()=>h.value>1?h.value-=1:h.value=1)},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString("<"))]),_:1},8,["disabled"]),k.createVNode(k.unref(wn.VBtn),{style:{padding:"0px","min-width":"0px",height:"20px",width:"20px"},disabled:a.length===1,onClick:M[18]||(M[18]=()=>h.value<a.length?h.value+=1:h.value=a.length)},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(">"))]),_:1},8,["disabled"])])]),k.createVNode(k.unref(wn.VBtn),{style:{"margin-bottom":"10px"},disabled:a.length===3,onClick:o},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(k.unref(dt)("增加行")),1)]),_:1},8,["disabled"]),k.createVNode(k.unref(wn.VBtn),{disabled:a.length===1,onClick:r},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(k.unref(dt)("删除行")),1)]),_:1},8,["disabled"])])])]),k.createElementVNode("div",Q9,[k.createVNode(k.unref(wn.VBtn),{onClick:b},{default:k.withCtx(()=>[k.createTextVNode(k.toDisplayString(k.unref(dt)("清零")),1)]),_:1})])])])]))}}),_V="",eI=ss(tI,[["__scopeId","data-v-13e7c51f"],["__file","GemoetricToleranceDialog.vue"]]),nI={class:"contents"},rI={style:{"margin-bottom":"10px"}},iI={class:"tips"},oI={class:"tips"},sI={style:{display:"flex","justify-content":"space-around",width:"100%"}},aI=k.defineComponent({__name:"NumberTextDialog",emits:["receiveParameters"],setup(t,{emit:n}){const e=k.ref(""),i=k.ref(1),s=k.ref("start"),a=()=>{const o={textContent:e.value,textNumber:Number(i.value),numPos:s.value};n("receiveParameters",o)};return k.onMounted(()=>{sl.value=350}),(o,r)=>(k.openBlock(),k.createElementBlock("div",nI,[k.createElementVNode("p",rI,k.toDisplayString(k.unref(dt)("请输入文本内容和编号：")),1),k.createVNode(k.unref(wn.VRow),null,{default:k.withCtx(()=>[k.createVNode(k.unref(wn.VCol),{cols:"3"},{default:k.withCtx(()=>[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("文本内容：")),1)]),_:1}),k.createVNode(k.unref(wn.VCol),{cols:"5"},{default:k.withCtx(()=>[k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"text",modelValue:e.value,"onUpdate:modelValue":[r[0]||(r[0]=u=>e.value=u),a]},null,8,["modelValue"])]),_:1}),k.createVNode(k.unref(wn.VCol),{cols:"4"},{default:k.withCtx(()=>[k.createElementVNode("span",iI,k.toDisplayString(k.unref(dt)("(输入0-20个字)")),1)]),_:1})]),_:1}),k.createVNode(k.unref(wn.VRow),null,{default:k.withCtx(()=>[k.createVNode(k.unref(wn.VCol),{cols:"3"},{default:k.withCtx(()=>[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("起始编号：")),1)]),_:1}),k.createVNode(k.unref(wn.VCol),{cols:"4"},{default:k.withCtx(()=>[k.createVNode(k.unref(wn.VTextField),{class:"mt-1",type:"number",modelValue:i.value,"onUpdate:modelValue":[r[1]||(r[1]=u=>i.value=u),a]},null,8,["modelValue"])]),_:1}),k.createVNode(k.unref(wn.VCol),{cols:"5"},{default:k.withCtx(()=>[k.createElementVNode("span",oI,k.toDisplayString(k.unref(dt)("(编号自动递增1)")),1)]),_:1})]),_:1}),k.createVNode(k.unref(wn.VRow),{justify:"flex-start"},{default:k.withCtx(()=>[k.createVNode(k.unref(wn.VCol),{cols:"3"},{default:k.withCtx(()=>[k.createElementVNode("span",null,k.toDisplayString(k.unref(dt)("编号位置：")),1)]),_:1}),k.createVNode(k.unref(wn.VCol),{cols:"6"},{default:k.withCtx(()=>[k.createVNode(k.unref(wn.VRadioGroup),{modelValue:s.value,"onUpdate:modelValue":[r[2]||(r[2]=u=>s.value=u),a]},{default:k.withCtx(()=>[k.createElementVNode("div",sI,[k.createVNode(k.unref(wn.VRadio),{label:k.unref(dt)("编号在前"),value:"start"},null,8,["label"]),k.createVNode(k.unref(wn.VRadio),{label:k.unref(dt)("编号在后"),value:"end"},null,8,["label"])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}}),wV="",lI=ss(aI,[["__scopeId","data-v-7d640c71"],["__file","NumberTextDialog.vue"]]),cI=ss(k.defineComponent({__name:"dialog",setup(t){const{MxDialog:n}=MxPluginContext.components,e=[{name:dt("取消"),fun:()=>{const l=A.MxCpp.getCurrentMxCAD();Ho.cancel(r),i.value=!1,l.mxdraw.clearMxCurrentSelect(),l.updateDisplay()}},{name:dt("确定"),primary:!0,fun:()=>{Ho.confirm(r),i.value=!1}}],{isShow:i,onReveal:s}=Ho,a=k.ref("弹框标题");s(l=>{l.title&&(a.value=l.title)});const o={RotateDialog:Hk,RoundMarkDialog:Kk,RoughnessDialog:g7,WeldSymbolDialog:A7,WeldingSymbolDialog:w9,GemoetricToleranceDialog:eI,NumberTextDialog:lI};let r;const u=l=>{r=l};return(l,h)=>(k.openBlock(),k.createBlock(k.unref(n),{title:a.value,modelValue:k.unref(i),"onUpdate:modelValue":h[0]||(h[0]=f=>k.isRef(i)?i.value=f:null),"max-width":k.unref(sl),footerBtnList:e},{default:k.withCtx(()=>[(k.openBlock(),k.createBlock(k.resolveDynamicComponent(o[k.unref(fs)]),{onReceiveParameters:u},null,32))]),_:1},8,["title","modelValue","max-width"]))}}),[["__file","dialog.vue"]]);function uI(){const t=document.createElement("div");document.body.appendChild(t);const n=k.createVNode(cI),e=MxPluginContext.getApp();n.appContext=e._context,k.render(n,t)}const eM=(t,n)=>{var a;const e=new _a;e.setPos(new A.McGePoint3d(0,0,0)),e.rouDimHeight=(n!=null&&n.fontSize?n.fontSize:1)*t.textBaseHeight;const i=n.props;e.rougMarkType=i.selectSymbolNum,e.textLeftStr=i.textLeftStr,e.rougCornerType=i.rougCornerType==="无"?"":i.rougCornerType,e.isRoungSameRequire=i.isRoungSameRequire,e.isShowMostSymbols=i.isShowMostSymbols;const s=(a=i==null?void 0:i.textUpStr)==null?void 0:a.filter(o=>o!="");return e.textUpStr=JSON.parse(JSON.stringify(s)).reverse(),e.textDownStr=i.textDownStr.filter(o=>o!=""),e.isAddRougLongLine=i.isAddLongLine,e};class hI extends A.MxCADBaseCustomText{constructor(){super(),this.type="MxCADTestRoughnessText"}calculate(n,e){const s=eM(n,e).getBoundingBox(),a=s.maxPt.x-s.minPt.x,o=s.maxPt.y-s.minPt.y;return{width:a,height:o}}create(n,e,i,s){const a=eM(n,e),o=a.getPos(),{minPt:r,maxPt:u}=a.getBoundingBox(),l=new A.McGePoint3d(r.x,u.y),h=o.sub(l),f=s.position.clone().addvec(h);return a.setPos(f),n.getMTextImp().entityType=="mtext"&&!n.getMTextImp().isEditState?[a]:[...a.getAllEntity()]}}function dI(){const t=MxPluginContext.registerEditorCustomTextPlugin(new hI,{onDbClick:e=>{n(!0,e)},uiData:{icon:"icon-a-1",tip:"粗糙度",onClick:()=>{n(!1)}}}),n=(e=!1,i)=>{var s,a;if(fs.value="RoughnessDialog",e){const o=new _a,r=i.props;o.rougMarkType=r.selectSymbolNum,o.textLeftStr=r.textLeftStr,o.rougCornerType=r.rougCornerType==="无"?"":r.rougCornerType,o.isRoungSameRequire=r.isRoungSameRequire,o.isShowMostSymbols=r.isShowMostSymbols,ps.value=o;const u=(s=r==null?void 0:r.textUpStr)==null?void 0:s.filter(l=>l!="");o.textUpStr=(a=JSON.parse(JSON.stringify(u)))==null?void 0:a.reverse(),o.textDownStr=r.textDownStr.filter(l=>l!=""),o.isAddRougLongLine=r.isAddLongLine}Ho.showDialog(!0,{title:yE("表面粗糙度")}).then(u=>re(this,[u],function*({data:o,isCanceled:r}){r||t(o.roughnessData,e)}))}}function fI(){dI()}class Ag extends A.McDbCustomEntity{constructor(n){super(n),this._text="",this._textsize=20,this._radius=15}create(n){return new Ag(n)}getTypeName(){return"McDbRectBoxLeadComment"}set text(n){this._text=n}get text(){return this._text}set textsize(n){this._textsize=n}get textsize(){return this._textsize}set radius(n){this._radius=n}get radius(){return this._radius}dwgInFields(n){return this.pt1=n.readPoint("pt1").val,this.pt2=n.readPoint("pt2").val,this.pt3=n.readPoint("pt3").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,this._text=n.readString("text").val,this._textsize=n.readDouble("textsize").val,!0}dwgOutFields(n){return n.writePoint("pt1",this.pt1),n.writePoint("pt2",this.pt2),n.writePoint("pt3",this.pt3),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),n.writeString("text",this._text),n.writeDouble("textsize",this._textsize),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.pt1.x+=e,this.pt1.y+=i,this.pt1.z+=s):n===1?(this.pt2.x+=e,this.pt2.y+=i,this.pt2.z+=s):n===2&&(this.pt3.x+=e,this.pt3.y+=i,this.pt3.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.pt1),n.append(this.pt2),n.append(this.pt3),n}worldDraw(n){const e=[],i=this._radius;if(this.pt1.x<this.pt2.x){const d=this.pt2.x-this.pt1.x,p=parseInt((d/(i*2)).toString());this.pt2.x=this.pt1.x+i*2*p}else{const d=this.pt1.x-this.pt2.x,p=parseInt((d/(i*2)).toString());this.pt1.x=this.pt2.x+i*2*p}if(this.pt1.y<this.pt2.y){const d=this.pt2.y-this.pt1.y,p=parseInt((d/(i*2)).toString());this.pt2.y=this.pt1.y+i*2*p}else{const d=this.pt1.y-this.pt2.y,p=parseInt((d/(i*2)).toString());this.pt1.y=this.pt2.y+i*2*p}const s=new A.McDbPolyline;s.isClosed=!0,s.addVertexAt(this.pt1),s.addVertexAt(new A.McGePoint3d(this.pt2.x,this.pt1.y)),s.addVertexAt(this.pt2),s.addVertexAt(new A.McGePoint3d(this.pt1.x,this.pt2.y));let o=s.getLength().val/i;const r=[];for(let d=1;d<=o;d++){const p=s.getPointAtDist(i*d).val;r.push(p)}r.forEach((d,p)=>{const b=new A.McDbCircle(d.x,d.y,d.z,i);if(p%2===0){const v=[];b.IntersectWith(s,A.McDb.Intersect.kOnBothOperands).forEach(x=>{v.push(x)}),b.splitCurves(v).forEach(x=>{const w=x.getPointAtDist(x.getLength().val/2).val;(w.x<Math.min(this.pt1.x,this.pt2.x)||w.x>Math.max(this.pt1.x,this.pt2.x))&&(n.drawEntity(x),e.push(x)),(w.y<Math.min(this.pt1.y,this.pt2.y)||w.y>Math.max(this.pt1.y,this.pt2.y))&&(n.drawEntity(x),e.push(x))})}});const u=[];for(let d=0;d<s.numVerts();d++){const p=s.getPointAt(d).val.distanceTo(this.pt3);u.push(p)}const l=u.indexOf(Math.min(...u)),h=s.getPointAt(l).val,f=new A.McDbPolyline;if(f.addVertexAt(h),f.addVertexAt(this.pt3),this._text){const d=new A.McDbText;d.textString=this._text,d.position=d.alignmentPoint=this.pt3,d.height=20,n.drawEntity(d),e.push(d);const{minPt:p,maxPt:b,ret:v}=d.getBoundingBox();if(!v)return;const x=b.x-p.x;f.addVertexAt(new A.McGePoint3d(this.pt3.x+x,this.pt3.y)),n.drawEntity(f),e.push(f)}else n.drawEntity(f),e.push(f);this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setPoint1(n){this.assertWrite(),this.pt1=n.clone()}setPoint2(n){this.assertWrite(),this.pt2=n.clone()}setPoint3(n){this.assertWrite(),this.pt3=n.clone()}getPoint1(){return this.pt1}getPoint2(){return this.pt2}getPoint3(){return this.pt3}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function pI(){return re(this,null,function*(){const t=new Ag,n=new A.MxCADUiPrString;n.setMessage(dt("请输入审批意见"));let e=yield n.go();e||(e="审批意见XXXX"),t.text=e;const i=new A.MxCADUiPrPoint;i.setMessage(dt("指定云线框起始点"));const s=yield i.go();if(!s)return;const a=new A.MxCADUiPrPoint;a.setMessage(dt("指定云线框终止点")),a.setUserDraw((l,h)=>{t.setPoint1(s),t.setPoint2(l),t.setPoint3(l),h.drawMcDbEntity(t)});const o=yield a.go();if(!o)return;t.setPoint2(o);const r=new A.MxCADUiPrPoint;r.setMessage(dt("指定审图标注点")),r.setUserDraw((l,h)=>{t.setPoint3(l),h.drawMcDbEntity(t)});const u=yield r.go();u&&(t.setPoint3(u),A.MxCpp.getCurrentMxCAD().drawEntity(t))})}class Sg extends A.McDbCustomEntity{constructor(n){super(n),this.pt1=new A.McGePoint3d,this.pt2=new A.McGePoint3d}create(n){return new Sg(n)}getTypeName(){return"McDbTestRectangle"}dwgInFields(n){return this.pt1=n.readPoint("pt1").val,this.pt2=n.readPoint("pt2").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("pt1",this.pt1),n.writePoint("pt2",this.pt2),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n==0?(this.pt1.x+=e,this.pt1.y+=i,this.pt1.z+=s):n==1&&(this.pt2.x+=e,this.pt2.y+=i,this.pt2.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.pt1),n.append(this.pt2),n}worldDraw(n){const e=[],i=new A.McDbPolyline;i.isClosed=!0,i.addVertexAt(this.pt1),i.addVertexAt(new A.McGePoint3d(this.pt2.x,this.pt1.y)),i.addVertexAt(this.pt2),i.addVertexAt(new A.McGePoint3d(this.pt1.x,this.pt2.y)),n.drawEntity(i),e.push(i);let s=A.MxCpp.getCurrentMxCAD();const a=new A.McGePoint3d(this.pt2.x,this.pt1.y);s.addDimStyle("MyDimStyle","41,0.18,141,0.09,40,200","77,1,271,3","",""),s.drawDimStyle="MyDimStyle";const o=s.drawDimAligned(this.pt1.x,this.pt1.y+20,a.x,a.y+20,(this.pt1.x+a.x)/2,this.pt1.y+20);n.drawEntity(o.getMcDbEntity()),e.push(o.getMcDbEntity()),o.erase();const r=s.drawDimAligned(this.pt2.x+20,this.pt2.y,a.x+20,a.y,a.x+20,(this.pt2.y+a.y)/2);n.drawEntity(r.getMcDbEntity()),e.push(r.getMcDbEntity()),r.erase(),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setPoint1(n){this.assertWrite(),this.pt1=n.clone()}setPoint2(n){this.assertWrite(),this.pt2=n.clone()}getPoint1(){return this.pt1}getPoint2(){return this.pt2}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function mI(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=new A.MxCADUiPrPoint;n.setMessage(dt("指定第一个角点:"));let e=yield n.go();if(!e)return;const i=new Sg;i.setPoint1(e),n.setMessage(dt("指定第二个角点:")),n.setUserDraw((a,o)=>{i.setPoint2(a),o.drawMcDbEntity(i)});let s=yield n.go();s&&(i.setPoint2(s),t.drawEntity(i))})}class vf extends A.McDbCustomEntity{constructor(n){super(n),this.center=new A.McGePoint3d,this._radius=1,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new vf(n)}getTypeName(){return"MxDbTestDivide"}set radius(n){this._radius=n}get radius(){return this._radius}dwgInFields(n){return this.center=n.readPoint("center").val,this._radius=n.readDouble("radius").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("center",this.center),n.writeDouble("radius",this._radius),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.center.x+=e,this.center.y+=i,this.center.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.center),n}worldDraw(n){const e=[],i=new A.McDbCircle(this.center.x,this.center.y,this.center.z,this._radius);n.drawEntity(i);const{minPt:s,maxPt:a,ret:o}=i.getBoundingBox();if(!o)return;const r=new A.McDbLine(s,a),u=new A.McDbLine(new A.McGePoint3d(s.x,a.y,0),new A.McGePoint3d(a.x,s.y,0));n.drawEntity(r),n.drawEntity(u),e.push(i),e.push(r),e.push(u),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setCenter(n){this.assertWrite(),this.center=n.clone()}getCenter(){return this.center}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function gI(){return re(this,null,function*(){const t=new A.MxCADUiPrKeyWord;t.setMessage("选择要对齐水平标注或竖直标注："),t.setKeyWords("[水平(H)/竖直(V)]");const n=yield t.go();if(!n)return;const e=new A.MxCADSelectionSet;if(!(yield e.userSelect("选择对齐标注:"))||e.count()==0)return;const i=[];if(e.forEach(l=>{const h=l.getMcDbEntity();if(h.objectName==="McDbRotatedDimension"){const f=h.clone(),d=Math.abs(f.xLine1Point.x-f.xLine2Point.x).toFixed(0),p=Math.abs(f.xLine1Point.y-f.xLine2Point.y).toFixed(0),b=Math.abs(f.dimLinePoint.x-f.xLine1Point.x)+Math.abs(f.dimLinePoint.x-f.xLine2Point.x),v=Math.abs(f.dimLinePoint.y-f.xLine1Point.y)+Math.abs(f.dimLinePoint.y-f.xLine2Point.y);n==="H"&&b.toFixed(0)==d&&i.push(h),n==="V"&&v.toFixed(0)==p&&i.push(h)}}),i.length===0)return;const s=A.MxCpp.getCurrentMxCAD(),a=new A.MxCADUiPrPoint;a.setMessage("设置尺寸线位置");const o=yield a.go();if(!o)return;i.forEach(l=>{l.dimLinePoint=o}),s.updateDisplay();const r=new A.MxCADUiPrPoint;r.setMessage("设置尺寸线界限");const u=yield r.go();u&&(i.forEach(l=>{n==="H"?(l.xLine1Point=new A.McGePoint3d(l.xLine1Point.x,u.y),l.xLine2Point=new A.McGePoint3d(l.xLine2Point.x,u.y)):n==="V"&&(l.xLine1Point=new A.McGePoint3d(u.x,l.xLine1Point.y),l.xLine2Point=new A.McGePoint3d(u.x,l.xLine2Point.y))}),s.updateDisplay())})}class Eg extends A.McDbCustomEntity{constructor(n){super(n),this.numPos=new A.McGePoint3d,this.labelPos=new A.McGePoint3d,this.labelSize=Ct.MxFun.screenCoordLong2Doc(5),this.numSize=Ct.MxFun.screenCoordLong2Doc(10),this.index="1",this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Eg(n)}getTypeName(){return"McDbTestIndex"}set symbolIndex(n){this.index=n}get symbolIndex(){return this.index}dwgInFields(n){return this.numPos=n.readPoint("numPos").val,this.labelPos=n.readPoint("labelPos").val,this.index=n.readString("index").val,this.labelSize=n.readDouble("labelSize").val,this.numSize=n.readDouble("numSize").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("labelPos",this.labelPos),n.writePoint("numPos",this.numPos),n.writeString("index",this.index),n.writeDouble("labelSize",this.labelSize),n.writeDouble("numSize",this.numSize),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.labelPos.x+=e,this.labelPos.y+=i,this.labelPos.z+=s):(this.numPos.x+=e,this.numPos.y+=i,this.numPos.z+=s,this.labelPos.x+=e,this.labelPos.y+=i,this.labelPos.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.labelPos),n.append(this.numPos),n}worldDraw(n){const e=[],i=new A.McDbHatch;i.appendCircleLoop(this.labelPos.x,this.labelPos.y,this.labelSize),n.drawEntity(i),e.push(i);const s=new A.McDbText;s.textString=this.index,s.height=this.numSize*(4/5),s.position=this.numPos.clone().subvec(A.McGeVector3d.kYAxis.clone().mult(this.numSize*(2/5))),s.alignmentPoint=s.position,s.horizontalMode=A.McDb.TextHorzMode.kTextMid,n.drawEntity(s),e.push(s);const a=new A.McDbCircle(this.numPos.x,this.numPos.y,this.numPos.z,this.numSize);n.drawEntity(a),e.push(a);const o=this.labelPos.sub(this.numPos).normalize().mult(this.numSize),r=this.numPos.addvec(o),u=new A.McDbLine(this.labelPos,r);n.drawEntity(u),e.push(u),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setLabelPos(n){this.labelPos=n.clone()}getLabelPos(){return this.labelPos}setNumPos(n){this.numPos=n.clone()}getNumPos(){return this.numPos}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function yI(){return re(this,null,function*(){let t=1;for(;;){const n=new A.MxCADUiPrPoint;n.setMessage(dt("指定标注点:"));let e=yield n.go();if(!e)break;const i=new Eg;i.setLabelPos(e);const s=new A.MxCADUiPrPoint;s.setMessage(dt("指定序号位置:")),s.setUserDraw((r,u)=>{const l=i.clone();l.setNumPos(r),u.drawMcDbEntity(l)});let a=yield s.go();if(!a)break;i.setNumPos(a),i.symbolIndex=t.toString(),A.MxCpp.getCurrentMxCAD().drawEntity(i),t+=1}})}var xf=(t=>(t[t.right=0]="right",t[t.left=1]="left",t))(xf||{});class Tg extends A.McDbCustomEntity{constructor(n){super(n),this.position=new A.McGePoint3d,this.rightText="",this.leftText="",this.bottomText="",this._textHeight=7,this.direct=0,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Tg(n)}getTypeName(){return"McDbTestRotationLabel"}set rightTextStr(n){this.rightText=n}get rightTextStr(){return this.rightText}set leftTextStr(n){this.leftText=n}get leftTextStr(){return this.leftText}set bottomTextStr(n){this.bottomText=n}get bottomTextStr(){return this.bottomText}set textHeight(n){this._textHeight=n}get textHeight(){return this._textHeight}set RotateDirect(n){this.direct=n}get RotateDirect(){return this.direct}dwgInFields(n){return this.position=n.readPoint("position").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,this.rightText=n.readString("rightText").val,this.leftText=n.readString("leftText").val,this.bottomText=n.readString("bottomText").val,this._textHeight=n.readDouble("textHeight").val,this.direct=n.readDouble("direct").val,!0}dwgOutFields(n){return n.writePoint("position",this.position),n.writePoint("maxPt",this.maxPt),n.writePoint("minPt",this.minPt),n.writeString("rightText",this.rightText),n.writeString("leftText",this.leftText),n.writeString("bottomText",this.bottomText),n.writeDouble("textHeight",this._textHeight),n.writeDouble("direct",this.direct),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.position.x+=e,this.position.y+=i,this.position.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n}getAllEntity(){const n=[],i=this.position.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(7)),s=this.position.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(7)),a=this.position.clone().addvec(A.McGeVector3d.kXAxis.clone().negate().mult(7)),o=this.direct===0?a.clone():i.clone(),r=i.clone().sub(this.position),u=this.direct===0?r.rotateBy(Math.PI/180*140):r.rotateBy(Math.PI/180*40),l=this.position.clone().addvec(u),h=o.sub(l).normalize().perpVector(),f=l.clone().addvec(h.clone().mult(.9)),d=l.clone().addvec(h.clone().negate().mult(.9)),p=new A.McDbHatch;p.appendLoop(new A.McGePoint3dArray([f,d,o])),n.push(p);const b=new A.McDbArc;return this.direct===0?b.computeArc(i.x,i.y,s.x,s.y,l.x,l.y):b.computeArc(l.x,l.y,s.x,s.y,a.x,a.y),n.push(b),n.push(...this.drawText()),n}worldDraw(n){this.getAllEntity().forEach(i=>{n.drawEntity(i)})}drawText(){const i=new A.McDbText;i.height=this._textHeight;const s=[];if(this.rightText){const a=i.clone();a.textString=this.rightText,a.horizontalMode=A.McDb.TextHorzMode.kTextLeft,a.position=a.alignmentPoint=this.position.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(10)),s.push(a)}if(this.leftText){const a=i.clone();a.textString=this.leftText,a.horizontalMode=A.McDb.TextHorzMode.kTextRight,a.position=a.alignmentPoint=this.position.clone().addvec(A.McGeVector3d.kXAxis.clone().negate().mult(10)),s.push(a)}if(this.bottomText){const a=i.clone();a.textString=this.bottomText,a.horizontalMode=A.McDb.TextHorzMode.kTextCenter,a.position=a.alignmentPoint=this.position.clone().addvec(A.McGeVector3d.kYAxis.clone().negate().mult(10));const o=this.position.clone().addvec(A.McGeVector3d.kXAxis.clone().negate().mult(7*2)),r=this.position.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(7*2)),u=new A.McDbLine(o,r);u.move(this.position,this.position.clone().addvec(A.McGeVector3d.kYAxis.clone().negate().mult(2))),s.push(u),s.push(a)}return s}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setRotatePos(n){this.position=n.clone()}getRotatePos(){return this.position}getBoundingBox(){const n=this.getAllEntity();return this.getBox(n),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function bI(){return re(this,null,function*(){fs.value="RotateDialog",Ho.showDialog(!0,{title:dt("旋转符号")}).then(e=>re(this,[e],function*({data:t,isCanceled:n}){const i=A.MxCpp.getCurrentMxCAD();if(n)t&&t.dimHandle&&i.database.handleToIdIndex(t.dimHandle).erase();else{const s=i.database.handleToIdIndex(t.dimHandle),o=s.getMcDbEntity().clone();s.erase();const r=new A.MxCADUiPrPoint;r.setMessage("请指定旋转标注位置"),r.setUserDraw((l,h)=>{const f=o.clone();f.setRotatePos(l),h.drawMcDbEntity(f)});const u=yield r.go();if(!u)return;o.visible=!0,o.setRotatePos(u),i.drawEntity(o)}}))})}class Cg extends A.McDbCustomEntity{constructor(n){super(n),this.center=new A.McGePoint3d,this.radius=0,this.circlePoints=[],this.midPoints=[],this.circleMidPts=[],this.originPt=new A.McGePoint3d,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Cg(n)}getTypeName(){return"McDbTestRoundHoleMark"}dwgInFields(n){return this.center=n.readPoint("center").val,this.originPt=n.readPoint("originPt").val,this.circlePoints=n.readPoints("circlePoints").val,this.circleMidPts=n.readPoints("circleMidPts").val,this.midPoints=n.readPoints("midPoints").val,this.radius=n.readDouble("radius").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("center",this.center),n.writePoint("originPt",this.originPt),n.writePoints("circlePoints",this.circlePoints),n.writePoints("circleMidPts",this.circleMidPts),n.writePoints("midPoints",this.midPoints),n.writeDouble("radius",this.radius),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite();const a=()=>{this.originPt.x+=e,this.originPt.y+=i,this.originPt.z+=s,this.center.x+=e,this.center.y+=i,this.center.z+=s,[...this.circleMidPts,...this.circlePoints,...this.midPoints].forEach(l=>{l.x+=e,l.y+=i,l.z+=s})},o=()=>{this.circlePoints.forEach((u,l)=>{const h=this.center.clone().addvec(u.sub(this.center).mult(.5));this.midPoints[l]=h})},r=()=>{let u=0;for(let l=0;l<this.circlePoints.length;l+=2){const h=new A.McDbArc;h.computeArc(this.circlePoints[l].x,this.circlePoints[l].y,this.circleMidPts[u].x,this.circleMidPts[u].y,this.circlePoints[l+1].x,this.circlePoints[l+1].y);const f=h.getPointAtDist(h.getLength().val/2).val;this.circleMidPts[u]=f.clone(),u+=1}};if(n===0)a();else if(n===1)this.center.clone().distanceTo(this.originPt)<1e-4?a():(this.center.x+=e,this.center.y+=i,this.center.z+=s,o());else if(n<this.circlePoints.length+2){const u=n-2,l=this.circlePoints[u].clone();l.x+=e,l.y+=i,l.z+=s,this.circlePoints[u]=l,r();const h=this.center.clone().addvec(l.sub(this.center).mult(.5));this.midPoints[u]=h}else if(n<this.circlePoints.length+2+this.circleMidPts.length){const u=n-2-this.circlePoints.length,l=this.circleMidPts[u].clone();l.x+=e,l.y+=i,l.z+=s,this.circleMidPts[u]=l,r()}else{const u=n-2-this.circlePoints.length-this.circleMidPts.length;this.center.x+=e,this.center.y+=i,this.center.z+=s,this.midPoints[u].x+=e,this.midPoints[u].y+=i,this.midPoints[u].z+=s,this.circlePoints[u].x+=e,this.circlePoints[u].y+=i,this.circlePoints[u].z+=s,r(),o()}}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.originPt),n.append(this.center),this.circlePoints.forEach(e=>{n.append(e)}),this.circleMidPts.forEach(e=>{n.append(e)}),this.midPoints.forEach(e=>{n.append(e)}),n}worldDraw(n){const e=[];for(let i=0;i<this.circlePoints.length;i+=2){const s=(i+2)/2,a=A.MxCADUtility.calcBulge(this.circlePoints[i],this.circleMidPts[s-1],this.circlePoints[i+1]).val,o=new A.McDbHatch;o.appendLoop(new A.McGePoint3dArray([this.center,this.circlePoints[i],this.circlePoints[i+1]]),[0,a,0]),n.drawEntity(o),e.push(o)}this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setRoundData(n,e,i=1,s=1,a=Math.PI/2){this.center=this.originPt=n.clone(),this.radius=e;let o;switch(i){case 1:o=A.McGeVector3d.kXAxis.clone();break;case 2:o=A.McGeVector3d.kYAxis.clone();break;case 3:o=A.McGeVector3d.kXAxis.clone().negate();break;case 4:o=A.McGeVector3d.kYAxis.clone().negate();break;default:o=A.McGeVector3d.kXAxis.clone();break}a>0&&Math.PI/2-a>1e-4&&o.rotateBy(a/2,A.McGeVector3d.kZAxis);const r=this.center.clone().addvec(o.clone().mult(this.radius)),u=this.center.clone().addvec(o.clone().rotateBy(a/2).mult(this.radius)),l=this.center.clone().addvec(o.clone().rotateBy(a).mult(this.radius));this.circlePoints=[r,l],this.circleMidPts=[u];const h=this.center.clone().addvec(r.sub(this.center).mult(.5)),f=this.center.clone().addvec(l.sub(this.center).mult(.5));this.midPoints=[h,f];const d=p=>{const b=[],v=new A.McGeMatrix3d;return v.setToRotation(Math.PI,A.McGeVector3d.kZAxis,this.center),p.forEach(x=>{b.push(x.clone().transformBy(v))}),b};s>1&&(this.circlePoints.push(...d(this.circlePoints)),this.circleMidPts.push(...d(this.circleMidPts)),this.midPoints.push(...d(this.midPoints)))}getRoundData(){return{center:this.center,radius:this.radius}}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function vI(){return re(this,null,function*(){fs.value="RoundMarkDialog",Ho.showDialog(!0,{title:dt("标记类型")}).then(e=>re(this,[e],function*({data:t,isCanceled:n}){const i=A.MxCpp.getCurrentMxCAD();if(!n){const s=new A.MxCADResbuf([A.DxfCode.kEntityType,"CIRCLE"]),a=new A.MxCADSelectionSet;if(!(yield a.userSelect(dt("请选择需要标记的圆:"),s))||a.count()==0)return;a.forEach(o=>{const r=o.getMcDbEntity(),u=new Cg;u.setRoundData(r.center,r.radius,...t.param),u.trueColor=new A.McCmColor(0,255,0),i.drawEntity(u)})}}))})}class _a extends A.McDbCustomEntity{constructor(n){super(n),this.position=new A.McGePoint3d,this.textDownString=["1.6"],this.textUpString=[],this.textLeftString="",this.CornerType="",this.markType=0,this.isSameRequire=!1,this.isAddLongLine=!1,this.isMostSymbols=!1,this.dimSize=5,this.rotation=0,this.dimHeight=10,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new _a(n)}getTypeName(){return"McDbTestRoughness"}set textDownStr(n){this.textDownString=n}get textDownStr(){return this.textDownString}set textUpStr(n){this.textUpString=n}get textUpStr(){return this.textUpString}set textLeftStr(n){this.textLeftString=n}get textLeftStr(){return this.textLeftString}set rougCornerType(n){this.CornerType=n}get rougCornerType(){return this.CornerType}set rougMarkType(n){this.markType=n}get rougMarkType(){return this.markType}set isRoungSameRequire(n){this.isSameRequire=n,n&&(this.isAddLongLine=!0)}get isRoungSameRequire(){return this.isSameRequire}set isAddRougLongLine(n){this.isAddLongLine=n}get isAddRougLongLine(){return this.isAddLongLine}set isShowMostSymbols(n){this.isMostSymbols=n}get isShowMostSymbols(){return this.isMostSymbols}set rouDimHeight(n){this.dimHeight=n}get rouDimHeight(){return this.dimHeight}dwgInFields(n){this.position=n.readPoint("position").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val;const e=n.readString("textDownStr").val;this.textDownString=e.split(",").filter(s=>s!="");const i=n.readString("textUpStr").val;return this.textUpString=i.split(",").filter(s=>s!=""),this.textLeftString=n.readString("textLeftStr").val,this.CornerType=n.readString("CornerType").val,this.markType=n.readLong("markType").val,this.dimSize=n.readDouble("dimSize").val,this.rotation=n.readDouble("rotation").val,this.dimHeight=n.readDouble("dimHeight").val,this.isSameRequire=n.readLong("isSameRequire").val==1,this.isAddLongLine=n.readLong("isAddLongLine").val==1,this.isMostSymbols=n.readLong("isMostSymbols").val==1,!0}dwgOutFields(n){n.writePoint("position",this.position),n.writePoint("maxPt",this.maxPt),n.writePoint("minPt",this.minPt);const e=this.textDownString.join(","),i=this.textUpString.join(",");return n.writeString("textDownStr",e),n.writeString("textUpStr",i),n.writeString("textLeftStr",this.textLeftString),n.writeString("CornerType",this.CornerType),n.writeLong("markType",this.markType),n.writeDouble("dimSize",this.dimSize),n.writeDouble("rotation",this.rotation),n.writeDouble("dimHeight",this.dimHeight),n.writeLong("isSameRequire",this.isSameRequire?1:0),n.writeLong("isAddLongLine",this.isAddLongLine?1:0),n.writeLong("isMostSymbols",this.isMostSymbols?1:0),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.position.x+=e,this.position.y+=i,this.position.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n}worldDraw(n){const e=this.getAllEntity();this.getBox(e),e.forEach(i=>{const s=i.clone();this.rotation&&s.rotate(this.position,this.rotation),n.drawEntity(s)})}getAllEntity(){A.MxCpp.getCurrentMxCAD();const n=this.drawShape(this.markType,this.position,this.dimSize,!0),e=n[0],i=e.getPointAt(e.numVerts()-1).val;if(this.textLeftString){const b=new A.McDbText;b.textString=this.textLeftString,b.height=this.dimSize*(9/10),b.alignmentPoint=b.position=this.position.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.dimSize*(1/10))).addvec(A.McGeVector3d.kXAxis.clone().negate().mult(this.dimSize)),b.horizontalMode=A.McDb.TextHorzMode.kTextRight,n.push(b)}if(this.CornerType){const b=new A.McDbText;b.textString=this.CornerType,b.height=this.dimSize*(7/10),b.alignmentPoint=b.position=this.position.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.dimSize*(3/10))).addvec(A.McGeVector3d.kXAxis.clone().mult(this.dimSize*(9/10))),b.horizontalMode=A.McDb.TextHorzMode.kTextLeft,n.push(b)}if(this.isSameRequire){const b=new A.McDbCircle;b.center=i.clone(),b.radius=this.dimSize*(3/10),n.push(b)}let s=i.x;const a=7/10*this.dimSize,o=i.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.dimSize*(1/2))).addvec(A.McGeVector3d.kYAxis.clone().mult(this.dimSize*(1/5)));let r=o.x,u=[];if(this.textUpString.length===1){const b=new A.McDbText;b.textString=this.textUpString[0],b.height=a,b.alignmentPoint=b.position=o,n.push(b);const{maxPt:v}=this.getTextBox(b);v.x>s&&(s=v.x),r=b.position.x}else if(this.textUpString.length===2){const b=new A.McDbText;b.textString=this.textUpString[0],b.height=a;const v=o.clone(),x=new A.McDbText;x.height=a,x.textString=this.textUpString[1];const w=i.sub(this.position).mult(2/3),M=v.clone().addvec(w),E=i.clone().addvec(w);b.alignmentPoint=b.position=new A.McGePoint3d(M.x,v.y),x.alignmentPoint=x.position=M,r=M.x;const D=this.getTextBox(b),N=this.getTextBox(x),V=D.maxPt.x>N.maxPt.x?D.maxPt.x:N.maxPt.x;s<V&&(s=V+a*.3);const K=new A.McGePoint3d(s,E.y),j=new A.McDbLine(E.x,E.y,E.z,K.x,K.y,K.y),Z=new A.McDbLine(i.x,i.y,i.z,E.x,E.y,E.z);u.push(j),n.push(x),n.push(b),n.push(Z)}if(this.textDownString.length){const b=new A.McGePoint3d(r,i.y);this.textDownString.forEach((v,x)=>{const w=new A.McDbText;w.textString=v,w.height=a;let M=new A.McGeVector3d;M=A.McGeVector3d.kYAxis.clone().negate().mult(a*(x+1+1/6)),w.alignmentPoint=w.position=b.clone().addvec(M),n.push(w);const E=this.getTextBox(w);s=s<E.maxPt.x?E.maxPt.x:s})}if(this.isAddLongLine){const b=i.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.dimSize*2)),v=new A.McDbLine(i.x,i.y,i.z,b.x,b.y,b.y);s<b.x&&(s=b.x,n.push(v))}const l=new A.McGePoint3d(s,i.y),h=new A.McDbLine(i.x,i.y,i.z,l.x,l.y,l.y);n.push(h),u.length&&u.forEach(b=>{b.endPoint.x=s,n.push(b)});const f=b=>{const v=new A.McDbArc;v.computeArc(b[0].x,b[0].y,b[1].x,b[1].y,b[2].x,b[2].y),n.push(v)};if(this.isMostSymbols){const b=this.position.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.dimSize)),v=new A.McGePoint3d(s,b.y),x=this.dimSize*(7/5),w=v.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.dimSize*(7/5))),M=A.McGeVector3d.kXAxis.clone().mult(x),E=w.clone().addvec(M.clone().rotateBy(40*(Math.PI/180))),D=w.clone().addvec(M.clone()),N=w.clone().addvec(M.clone().rotateBy(320*(Math.PI/180)));f([E,D,N]);const V=v.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.dimSize*(12/5))),K=V.clone().addvec(M.clone().rotateBy(140*(Math.PI/180))),j=V.clone().addvec(M.clone().negate()),Z=V.clone().addvec(M.clone().rotateBy(220*(Math.PI/180)));f([K,j,Z]);const tt=w.clone().addvec(V.sub(w).mult(1/3)).addvec(A.McGeVector3d.kYAxis.clone().negate().mult(this.dimSize*(4/5)));this.drawShape(2,tt,this.dimSize*(4/5),!1).forEach(rt=>{n.push(rt)})}this.getBox(n);const d=new A.McGeMatrix3d,p=this.maxPt.y-this.minPt.y;if(this.dimHeight){const b=this.dimHeight/p;d.setToScaling(b,this.position)}else d.setToScaling(1,this.position);return n.forEach(b=>{b.transformBy(d)}),n}getTextBox(n){const e=new A.McDbMText;switch(e.contents=n.textString,e.textHeight=n.height,e.location=n.position,n.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:e.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:e.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:e.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:e.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:e.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const i=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();return e.textStyleId=i,e.reCompute(),A.MxCADUtility.getTextEntityBox(e,!1)}getBox(n){let e,i=null,s;n.forEach(a=>{a instanceof A.McDbText?s=this.getTextBox(a):a instanceof A.McDbMText?(a.reCompute(),s=A.MxCADUtility.getTextEntityBox(a,!1)):s=a.getBoundingBox();const{minPt:o,maxPt:r,ret:u}=s;e||(e=o.clone()),i||(i=r.clone()),o.x<e.x&&(e.x=o.x),o.y<e.y&&(e.y=o.y),r.x>i.x&&(i.x=r.x),r.y>i.y&&(i.y=r.y)}),e&&i&&(this.maxPt=i,this.minPt=e)}drawShape(n,e,i,s){const a=[],o=A.McGeVector3d.kYAxis.clone().mult(i),r=A.McGeVector3d.kXAxis.clone().mult(i*(3/5)),u=e.clone().addvec(o),l=u.clone().addvec(r),h=u.clone().addvec(r.clone().negate());let f=i*(2/5);this.textDownStr.length>2&&s&&(f=i*(1/2));const d=e.clone().addvec(l.sub(e).mult(f));if(n===0){const p=new A.McDbPolyline;p.addVertexAt(l),p.addVertexAt(h),p.addVertexAt(e),p.addVertexAt(d),a.push(p)}else{const p=new A.McDbPolyline;p.addVertexAt(h),p.addVertexAt(e),p.addVertexAt(d),a.push(p)}if(n===1){const p=e.distanceTo(l),b=e.distanceTo(h),v=l.distanceTo(h),x=(p+b+v)/2,w=e.distanceTo(u),M=v*w/2,E=new A.McDbCircle;E.radius=M/x,E.center=u.clone().addvec(A.McGeVector3d.kYAxis.clone().negate().mult(E.radius)),a.push(E)}return a}setPos(n){this.position=n.clone()}getPos(){return this.position}setRotation(n){this.rotation=n}getRotation(){return this.rotation}getBoundingBox(){const n=this.getAllEntity();return this.getBox(n),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function xI(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD();let n=0;const e=new _a;e.rougMarkType=0,e.rougCornerType="";const i=new A.MxCADUiPrPoint;i.setMessage(dt("请设置定位点或直线或圆弧或圆")),i.setUserDraw((r,u)=>{e.setPos(r),u.drawMcDbEntity(e)});const s=yield i.go();let a=new A.MxCADResbuf([A.DxfCode.kEntityType,"LINE,ARC,CIRCLE,LWPOLYLINE"]),o=A.MxCADUtility.findEntAtPoint(s.x,s.y,s.z,-1,a);if(o.isValid()){const r=o.getMcDbEntity(),u=new A.MxCADUiPrPoint;if(u.setMessage(dt("拖动确定标注位置")),u.setUserDraw((h,f)=>{const p=r.clone().getClosestPointTo(h,!0).val;n=h.sub(p).angleTo2(A.McGeVector3d.kYAxis,A.McGeVector3d.kNegateZAxis),e.setPos(p),e.setRotation(n),f.drawMcDbEntity(e)}),u.setDisableDynInput(!0),u.disableAllTrace(!0),!(yield u.go()))return;t.drawEntity(e)}else{e.setPos(s);const r=new A.MxCADUiPrAngle;if(r.setBasePt(s),r.setMessage(dt("请指定或输入角度")),r.setUserDraw((h,f)=>{const d=new A.McDbLine(h,s);f.drawMcDbEntity(d),n=h.sub(s).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis),e.setRotation(n),f.drawMcDbEntity(e)}),!(yield r.go()))return;const l=r.value();e.setRotation(l),t.drawEntity(e)}})}class Pg extends A.McDbCustomEntity{constructor(n){super(n),this.symbolType=0,this.width=10,this.startPt=new A.McGePoint3d,this.endPt=new A.McGePoint3d,this.midPt=new A.McGePoint3d,this.directPt=new A.McGePoint3d,this.isArc=0,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Pg(n)}get weldWidth(){return this.width}set weldWidth(n){this.width=n}get weldSymbolType(){return this.symbolType}set weldSymbolType(n){this.symbolType=n}set startPoint(n){this.startPt=n.clone()}set endPoint(n){this.endPt=n.clone()}set directPoint(n){this.directPt=n.clone()}set entityHandle(n){this.entHandle=n;const s=A.MxCpp.getCurrentMxCAD().database.handleToIdIndex(this.entHandle).getMcDbCurve();this.startPt=s.getStartPoint().val,this.endPt=s.getEndPoint().val,s instanceof A.McDbArc&&(this.isArc=1,this.midPt=s.getPointAtDist(s.getLength().val/2).val)}getTypeName(){return"McDbTestWeldSymbolBefore"}dwgInFields(n){return this.startPt=n.readPoint("startPt").val,this.endPt=n.readPoint("endPt").val,this.midPt=n.readPoint("midPt").val,this.directPt=n.readPoint("directPt").val,this.symbolType=n.readLong("symbolType").val,this.entHandle=n.readString("entHandle").val,this.isArc=n.readLong("isArc").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("startPt",this.startPt),n.writePoint("endPt",this.endPt),n.writePoint("midPt",this.midPt),n.writePoint("directPt",this.directPt),n.writeLong("symbolType",this.symbolType),n.writeLong("isArc",this.isArc),n.writeString("entHandle",this.entHandle),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.startPt.x+=e,this.startPt.y+=i,this.startPt.z+=s,this.endPt.x+=e,this.endPt.y+=i,this.endPt.z+=s,this.isArc&&(this.midPt.x+=e,this.midPt.y+=i,this.midPt.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.startPt),n}worldDraw(n){const e=[],s=.626*this.width;let a;this.isArc?(a=new A.McDbArc,a.computeArc(this.startPt.x,this.startPt.y,this.midPt.x,this.midPt.y,this.endPt.x,this.endPt.y)):a=new A.McDbLine(this.startPt,this.endPt);const o=51.5*Math.PI/180;if(this.symbolType===0||this.symbolType===1){const r=a.getLength().val,u=Math.ceil(r/this.width),l=r/u;for(let h=0;h<=u;h++){const f=a.getPointAtDist(h*l).val,d=a.getFirstDeriv(f).val.normalize().mult(s),p=d.angleTo2(A.McGeVector3d.kXAxis),b=new A.McDbArc;if(b.center=f.clone().subvec(d),b.startAngle=p-o,b.endAngle=p+o,b.radius=s,this.symbolType===1){const v=b.getStartPoint().val,x=b.getEndPoint().val;if(a instanceof A.McDbLine){const w=v.distanceTo(this.directPt),M=x.distanceTo(this.directPt);w<M?b.move(x,f):b.move(v,f)}else if(a instanceof A.McDbArc){const w=a.center.distanceTo(this.directPt),M=v.distanceTo(a.center),E=x.distanceTo(a.center);w<a.radius?(M<=a.radius&&b.move(x,f),E<=a.radius&&b.move(v,f)):(M>=a.radius&&b.move(x,f),E>=a.radius&&b.move(v,f))}}n.drawEntity(b),e.push(b)}}this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}class Dg extends A.McDbCustomEntity{constructor(n){super(n),this.originPt=new A.McGePoint3d,this.symbolType=0,this.width=10,this.angle=0,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Dg(n)}getTypeName(){return"McDbTestWeldSymbolSide"}get weldSymbolType(){return this.symbolType}set weldSymbolType(n){this.symbolType=n}get weldWidth(){return this.width}set weldWidth(n){this.width=n}get weldAngle(){return this.angle}set weldAngle(n){this.angle=n}dwgInFields(n){return this.originPt=n.readPoint("originPt").val,this.symbolType=n.readLong("symbolType").val,this.angle=n.readDouble("angle").val,this.width=n.readDouble("width").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("originPt",this.originPt),n.writeLong("symbolType",this.symbolType),n.writeDouble("angle",this.angle),n.writeDouble("width",this.width),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.originPt.x+=e,this.originPt.y+=i,this.originPt.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.originPt),n}worldDraw(n){const e=[];if(this.symbolType===2){const i=this.originPt.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.width/2)),s=this.originPt.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.width/2).negate()),a=this.originPt.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.width)),o=new A.McDbHatch;o.appendLoop(new A.McGePoint3dArray([i,s,a])),this.angle&&o.rotate(this.originPt,this.angle),n.drawEntity(o),e.push(o)}else if(this.symbolType===3){const i=this.originPt.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.width)),s=this.originPt.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.width)),a=new A.McDbHatch;a.appendLoop(new A.McGePoint3dArray([i,s,this.originPt])),this.angle&&a.rotate(this.originPt,this.angle),n.drawEntity(a),e.push(a)}this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setOriginPt(n){this.originPt=n.clone()}getOriginPt(){return this.originPt}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function _I(){return re(this,null,function*(){fs.value="WeldSymbolDialog",Ho.showDialog(!0,{title:dt("焊缝符号")}).then(e=>re(this,[e],function*({data:t,isCanceled:n}){if(A.MxCpp.getCurrentMxCAD(),!n&&t){const i=t.symbolType;for(;;)if(i==0||i==1){const s=new A.MxCADUiPrPoint;s.setMessage(dt("请拾取定位点、直线或圆弧"));const a=yield s.go();if(!a)break;let o=new A.MxCADResbuf([A.DxfCode.kEntityType,"LINE,ARC,CIRCLE"]),r=A.MxCADUtility.findEntAtPoint(a.x,a.y,a.z,-1,o);const u=new Pg;if(u.weldSymbolType=i,u.weldWidth=t.width?t.width:10,r.isValid()){const p=r.getMcDbEntity().getHandle();u.entityHandle=p}else{const d=new A.MxCADUiPrPoint;d.setMessage(`${dt("请指定第二点")}`),d.setUserDraw((b,v)=>{const x=new A.McDbLine(a,b);v.drawMcDbEntity(x)});const p=yield d.go();if(!p)break;u.startPoint=a,u.endPoint=p}const l=new A.MxCADUiPrPoint;l.setDisableDynInput(!0),l.setMessage("左键确定，右键结束当前命令"),l.setUserDraw((d,p)=>{u.directPoint=d,p.setColor("#00FF00"),p.drawMcDbEntity(u)});const h=yield l.go();if(!h)break;u.directPoint=h,u.trueColor=new A.McCmColor(255,255,0),A.MxCpp.getCurrentMxCAD().drawEntity(u)}else if(i==2||i==3){const s=new Dg;s.weldSymbolType=i;const a=new A.MxCADUiPrPoint;a.setMessage(`${dt("请设置定位点")}`),a.setUserDraw((h,f)=>{s.setOriginPt(h),f.drawMcDbEntity(s)});const o=yield a.go();if(!o)break;const r=new A.MxCADUiPrAngle;r.setMessage(`${dt("请设置角度")}`),r.setBasePt(o),r.setUserDraw((h,f)=>{const p=h.sub(o).angleTo2(A.McGeVector3d.kXAxis);s.weldAngle=p,f.drawMcDbEntity(s)});let u=yield r.go();if(!u&&u!=0)break;const l=r.value();s.weldAngle=l,s.weldWidth=t.width?t.width:10,A.MxCpp.getCurrentMxCAD().drawEntity(s)}else break}}))})}class Rg extends A.McDbCustomEntity{constructor(n){super(n),this.startPt=new A.McGePoint3d,this.endPt=new A.McGePoint3d,this.size=4,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Rg(n)}getTypeName(){return"McDbTestDirectionaSymbol"}set startPoint(n){this.startPt=n.clone()}get startPoint(){return this.startPt}set endPoint(n){this.endPt=n.clone()}get endPoint(){return this.endPt}set dimSize(n){this.size=n}get dimSize(){return this.size}dwgInFields(n){return this.startPt=n.readPoint("startPt").val,this.endPt=n.readPoint("endPt").val,this.size=n.readDouble("size").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("startPt",this.startPt),n.writePoint("endPt",this.endPt),n.writeDouble("size",this.size),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.startPt.x+=e,this.startPt.y+=i,this.startPt.z+=s,this.endPt.x+=e,this.endPt.y+=i,this.endPt.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.startPt),n}worldDraw(n){const e=[],i=this.endPt.sub(this.startPt).normalize(),s=this.startPt.clone().addvec(i.clone().mult(3*this.size)),a=this.startPt.clone().addvec(i.clone().mult(this.size)),o=new A.McDbLine(this.startPt,s);n.drawEntity(o),e.push(o);const r=a.clone().addvec(i.clone().perpVector().mult(this.size*(1/8))),u=a.clone().addvec(i.clone().perpVector().mult(this.size*(1/8)).negate()),l=new A.McDbHatch;l.appendLoop(new A.McGePoint3dArray([r,u,this.startPt])),n.drawEntity(l),e.push(l),this.getBox(e)}getBox(n){let e,i=null;n.forEach(s=>{const{minPt:a,maxPt:o,ret:r}=s.getBoundingBox();e||(e=a.clone()),i||(i=o.clone()),a.x<e.x&&(e.x=a.x),a.y<e.y&&(e.y=a.y),o.x>i.x&&(i.x=o.x),o.y>i.y&&(i.y=o.y)}),e&&i&&(this.maxPt=i,this.minPt=e)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function wI(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage("请确定向视符号的起点位置");const e=yield n.go();if(!e)return;const i=new Rg;i.startPoint=e;const s=new A.MxCADUiPrPoint;s.setMessage("请确定向视符号固定长度的终点位置"),s.setUserDraw((o,r)=>{i.endPoint=o,r.drawMcDbEntity(i)});const a=yield s.go();if(a){i.endPoint=a,t.drawEntity(i);for(let o=0;o<2;o++){const r=new A.MxCADMText;r.data=[{type:"paragraph",children:[{text:"A",fontSize:.2}]}];const u=new A.MxCADUiPrPoint;o==0?u.setMessage("请确定文本位置"):o==1&&u.setMessage("请确定向视图标识的位置");const l=yield u.go();r.position=l,t.drawEntity(r)}}})}var _r=(t=>(t[t.top=1]="top",t[t.down=2]="down",t))(_r||{}),pn=(t=>(t[t.WithPadSymbol=0]="WithPadSymbol",t[t.SurroundingWeldSeamSymbol=1]="SurroundingWeldSeamSymbol",t[t.OnSiteSymbol=2]="OnSiteSymbol",t[t.ThreeSidedWeldSeamSymbol=3]="ThreeSidedWeldSeamSymbol",t[t.TailSymbol=4]="TailSymbol",t[t.ZSymbol=5]="ZSymbol",t[t.RolledEdge=6]="RolledEdge",t[t.IWeldSeam=7]="IWeldSeam",t[t.VWeldSeam=8]="VWeldSeam",t[t.SingleVWeldSeam=9]="SingleVWeldSeam",t[t.SingleSteepVWeldSeam=10]="SingleSteepVWeldSeam",t[t.InclinedWeldSeam=11]="InclinedWeldSeam",t[t.RemovablePadding1=12]="RemovablePadding1",t[t.RemovablePadding2=13]="RemovablePadding2",t[t.DurableLiner=14]="DurableLiner",t[t.VFlangedEdgeSeam=15]="VFlangedEdgeSeam",t[t.UFlangedEdgeSeam=16]="UFlangedEdgeSeam",t[t.SingleVFlangedEdgeSeam=17]="SingleVFlangedEdgeSeam",t[t.SingleUFlangedEdgeSeam=18]="SingleUFlangedEdgeSeam",t[t.EndWeldSeam=19]="EndWeldSeam",t[t.SurfacingJoint=20]="SurfacingJoint",t[t.BottomSeamWeld=21]="BottomSeamWeld",t[t.FilletWeld=22]="FilletWeld",t[t.GrooveWeldSeam=23]="GrooveWeldSeam",t[t.SpotWeldSeam=24]="SpotWeldSeam",t[t.FoldingInterface=25]="FoldingInterface",t[t.InclinedInterface=26]="InclinedInterface",t[t.SpotWeldSeamOffset=27]="SpotWeldSeamOffset",t[t.SeamWeld=28]="SeamWeld",t[t.SeamWeldOffset=29]="SeamWeldOffset",t[t.SteepVWeldSeam=30]="SteepVWeldSeam",t[t.BellShapedWeldSeam=31]="BellShapedWeldSeam",t[t.SingleBellShapedWeldSeam=32]="SingleBellShapedWeldSeam",t[t.HeapWeldSeam=33]="HeapWeldSeam",t[t.SeamSeam=34]="SeamSeam",t[t.LockTheSlopeOpening=35]="LockTheSlopeOpening",t[t.FirstPlaneSymbol=36]="FirstPlaneSymbol",t[t.SecondConcaveSymbol=37]="SecondConcaveSymbol",t[t.SecondConvexeSymbol=38]="SecondConvexeSymbol",t[t.SecondPlaneSymbol=39]="SecondPlaneSymbol",t[t.ThirdPlaneSymbol=40]="ThirdPlaneSymbol",t[t.FirstConvexeSymbol=41]="FirstConvexeSymbol",t[t.FirstConcaveSymbol=42]="FirstConcaveSymbol",t[t.FlattenWeldSeam=43]="FlattenWeldSeam",t[t.ToeAareaTranSmoothly=44]="ToeAareaTranSmoothly",t[t.none=45]="none",t))(pn||{});class _f extends A.McDbCustomEntity{constructor(n){super(n),this.size=4,this.baseSymbok=[],this.auxiliarySymbol=[],this.specialSymbol=[],this.suppleSymbol=[],this.leftDim=[],this.topDim=[],this.rightDim=[],this.dottedPos=0,this.height=this.size*(7/8),this.weldingInfo="",this.interlacedWeldSeam=[],this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new _f(n)}getTypeName(){return"McDbTestWeldingSymbol"}set weldingPosition(n){this.position=this.fixedPoint=this.turningPoint=n.clone()}get weldingPosition(){return this.position}set turningPoint(n){this.turningPt=this.fixedPoint=n.clone()}get turningPoint(){return this.turningPt}set fixedPos(n){this.fixedPoint=n.clone()}get fixedPos(){return this.fixedPoint}set dimSize(n){this.size=n,this.height=this.size*(7/8)}get dimSize(){return this.size}set dottedLinePos(n){this.dottedPos=n}get dottedLinePos(){return this.dottedPos}set weldingSymbolInfo(n){this.weldingInfo=n}get weldingSymbolInfo(){return this.weldingInfo}dwgInFields(n){this.position=n.readPoint("position").val,this.turningPt=n.readPoint("turningPt").val,this.fixedPoint=n.readPoint("fixedPoint").val,this.size=n.readDouble("size").val,this.dottedPos=n.readLong("dottedPos").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val;const e=n.readString("baseSymbok").val;this.baseSymbok=JSON.parse(e);const i=n.readString("AuxiliarySymbol").val;this.auxiliarySymbol=JSON.parse(i);const s=n.readString("specialSymbol").val;this.specialSymbol=JSON.parse(s);const a=n.readString("suppleSymbol").val;this.suppleSymbol=JSON.parse(a);const o=n.readString("leftDim").val;this.leftDim=JSON.parse(o);const r=n.readString("topDim").val;this.topDim=JSON.parse(r);const u=n.readString("rightDim").val;this.rightDim=JSON.parse(u);const l=n.readString("interlacedWeldSeam").val;return this.interlacedWeldSeam=JSON.parse(l),this.weldingInfo=n.readString("weldingInfo").val,!0}dwgOutFields(n){return n.writePoint("turningPt",this.turningPt),n.writePoint("position",this.position),n.writePoint("fixedPoint",this.fixedPoint),n.writeDouble("size",this.size),n.writeLong("dottedPos",this.dottedPos),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),n.writeString("baseSymbok",JSON.stringify(this.baseSymbok)),n.writeString("AuxiliarySymbol",JSON.stringify(this.auxiliarySymbol)),n.writeString("specialSymbol",JSON.stringify(this.specialSymbol)),n.writeString("suppleSymbol",JSON.stringify(this.suppleSymbol)),n.writeString("leftDim",JSON.stringify(this.leftDim)),n.writeString("topDim",JSON.stringify(this.topDim)),n.writeString("rightDim",JSON.stringify(this.rightDim)),n.writeString("interlacedWeldSeam",JSON.stringify(this.interlacedWeldSeam)),n.writeString("weldingInfo",this.weldingInfo),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.position.x+=e,this.position.y+=i,this.position.z+=s):n===1?(this.turningPt.x+=e,this.turningPt.y+=i,this.turningPt.z+=s):n===2&&(this.fixedPoint.x+=e,this.fixedPoint.y+=i,this.fixedPoint.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n.append(this.turningPt),n.append(this.fixedPoint),n}worldDraw(n){const e=this.getAllEntity();e.forEach((i,s)=>{s===e.length-1&&n.setupForEntity(i),n.drawEntity(i)})}getAllEntity(){const n=[],e=[];let i=this.fixedPoint.x<this.position.x,s=this.fixedPoint.clone();s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(1/8)));const a=new A.McDbPolyline;a.addVertexAt(this.position),a.addVertexAt(this.turningPt),a.addVertexAt(this.fixedPoint),e.push(a);const o=this.turningPoint.sub(this.position).normalize(),r=this.position.clone().addvec(o.mult(this.size)),u=o.clone().perpVector().mult(this.size*(1/8)),l=r.clone().addvec(u),h=r.clone().addvec(u.clone().negate()),f=new A.McDbHatch;if(f.appendLoop(new A.McGePoint3dArray([l,h,this.position])),e.push(f),this.suppleSymbol.length){const{entityArr:p,noChangeArr:b,v}=this.drawSuppleSymbol(i);s.addvec(v),n.push(...p),e.push(...b)}if(this.leftDim.length){const{entityArr:p,v:b}=this.drawLeftDim(s);s.addvec(b),n.push(...p)}if(this.specialSymbol.length){const{entityArr:p}=this.drawSpecialSymbol(s);n.push(...p),s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/2))}if(this.suppleSymbol.length&&this.suppleSymbol.filter(p=>p.typeName===0).length){const p=this.drawWidth(s);n.push(...p)}if(this.baseSymbok.length){const{entityArr:p}=this.drawBasicSymbol(s);n.push(...p)}if(this.auxiliarySymbol.length){const{entityArr:p}=this.drawAuxiliarySymbol(s);n.push(...p)}if(this.topDim.length){const{entityArr:p}=this.drawTopDim(s);n.push(...p)}if(s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(7/4))),this.rightDim.length){const{entityArr:p,v:b}=this.drawRightDim(s);s.addvec(b),n.push(...p)}if(s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(4/8))),this.suppleSymbol.length&&this.suppleSymbol.filter(p=>p.typeName===5).length){(this.baseSymbok.length||this.suppleSymbol.filter(N=>N.typeName===0))&&s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/2));const p=A.McGeVector3d.kXAxis.clone().mult(this.size*(1/16)),b=A.McGeVector3d.kYAxis.clone().mult(this.size*(17/16)),v=A.McGeVector3d.kXAxis.clone().mult(this.height).negate(),x=s.clone().addvec(b),w=s.clone().addvec(b.clone().negate()),M=x.clone().addvec(v),E=w.clone().addvec(v),D=new A.McDbPolyline;if(D.addVertexAt(M),D.addVertexAt(x),D.addVertexAt(E),D.addVertexAt(w),n.push(D),this.interlacedWeldSeam.length){let N=null;this.interlacedWeldSeam.forEach(V=>{const K=new A.McDbMText;K.contents=V.content,K.textHeight=this.height,K.attachment=A.McDb.AttachmentPoint.kTopLeft,V.position===2?K.location=s.clone().addvec(p):V.position===1&&(K.location=s.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size)).addvec(p));const j=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();K.textStyleId=j,K.reCompute();const{maxPt:Z}=A.MxCADUtility.getTextEntityBox(K,!1);(!N||N<Z.x)&&(N=Z.x),n.push(K)}),s.x=N}}if(this.suppleSymbol.length&&this.suppleSymbol.filter(p=>p.typeName===4).length){const p=this.fixedPoint.sub(s).mult(2),b=A.McGeVector3d.kYAxis.clone().mult(this.height),v=i?A.McGeVector3d.kXAxis.clone().negate().mult(this.height):A.McGeVector3d.kXAxis.clone().mult(this.height),x=s.clone().addvec(b).addvec(v),w=s.clone().addvec(b.clone().negate()).addvec(v),M=new A.McDbPolyline;if(M.addVertexAt(x),M.addVertexAt(s),M.addVertexAt(w),i&&M.move(s,s.clone().addvec(p)),e.push(M),this.weldingInfo){const E=new A.McDbMText;E.contents=this.weldingInfo;const D=i?A.McGeVector3d.kXAxis.clone().mult(this.size*(5/4)).negate():A.McGeVector3d.kXAxis.clone().mult(this.size*(5/4));E.location=s.clone().addvec(D),E.attachment=i?A.McDb.AttachmentPoint.kMiddleRight:A.McDb.AttachmentPoint.kMiddleLeft,E.textHeight=this.height,i&&E.move(s,s.clone().addvec(p)),e.push(E)}}const d=new A.McDbLine(s,this.fixedPoint);if(i&&d.move(s,this.fixedPoint),e.push(d),this.dottedPos&&!this.suppleSymbol.filter(p=>p.typeName===5).length){const p=A.McGeVector3d.kYAxis.clone().mult(this.size*.25);this.dottedPos===2&&p.negate();const b=this.fixedPoint.clone().addvec(p),v=d.clone();v.move(this.fixedPoint,b);const x=A.MxCpp.getCurrentMxCAD();let w=this.dimSize/8,M=x.database,E=x.getSysVarDouble("LTSCALE");w=w/E;let D=M.getLinetypeTable(),N="weldingDottedLineType",V=D.get(N);if(V.isNull()){let K=new A.McDbLinetypeTableRecord;K.numDashes=2,K.setDashLengthAt(0,w),K.setDashLengthAt(1,-w),K.name=N,V=D.add(K)}v.linetypeId=V,e.push(v)}if(i){let p=this.fixedPoint.clone();this.suppleSymbol.filter(b=>b.typeName===2).length&&(p=this.fixedPoint.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/4)).negate())),n.forEach(b=>{b.move(s,p)})}return n.push(...e),n}drawSuppleSymbol(n){const e=[],i=[];let s=this.fixedPoint.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.125)),a=this.fixedPoint.clone(),o=A.McGeVector3d.kYAxis.clone().mult(this.size*(1/4));if(this.suppleSymbol.filter(u=>u.typeName===1).length){const u=new A.McDbCircle(this.fixedPoint.x,this.fixedPoint.y,0,this.size*.375);i.push(u),s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(3/8))),a=new A.McGePoint3d(s.x,this.fixedPoint.y)}if(this.suppleSymbol.filter(u=>u.typeName===2).length){const u=A.McGeVector3d.kYAxis.clone().mult(this.size*.375),l=this.fixedPoint.clone().addvec(u),h=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(7/8))),f=A.McGeVector3d.kXAxis.clone().mult(this.size*(5/4)),d=l.clone().addvec(f),p=new A.McDbLine(this.fixedPoint,l);let b=new A.McDbHatch;b.appendLoop(new A.McGePoint3dArray([l,h,d]));const{maxPt:v}=b.getBoundingBox();if(a=new A.McGePoint3d(v.x,this.fixedPoint.y),n){b=new A.McDbHatch;const x=l.clone().addvec(f.clone().negate());b.appendLoop(new A.McGePoint3dArray([l,h,x]))}i.push(b),i.push(p),s.addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(7/8)))}if(this.suppleSymbol.filter(u=>u.typeName===3).length){const u=this.suppleSymbol.filter(D=>D.typeName===3)[0],l=this.dottedPos===1?s.clone().addvec(o):s.clone(),h=A.McGeVector3d.kYAxis.clone(),f=l.clone().addvec(h.clone().mult(this.size*(1/8))),d=f.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),p=f.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(3/4))),b=d.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(3/4))),v=new A.McDbPolyline;v.addVertexAt(d),v.addVertexAt(f),v.addVertexAt(p),v.addVertexAt(b);const{minPt:x,maxPt:w}=v.getBoundingBox();let M=w.x;const E=x.clone().addvec(w.sub(x).mult(1/2));if(u.rotation){v.rotate(E,u.rotation),u.rotation!=Math.PI&&v.move(l,f);const{maxPt:D}=v.getBoundingBox();M=D.x}a=new A.McGePoint3d(M,this.fixedPoint.y),e.push(v)}const r=a.sub(this.fixedPoint);return{entityArr:e,noChangeArr:i,v:r}}drawWidth(n){const e=[];let i=A.McGeVector3d.kYAxis.clone().mult(this.size*.25);const s=A.McGeVector3d.kXAxis.clone().mult(this.size/2),a=A.McGeVector3d.kYAxis.clone().mult(this.size*(7/16)).negate(),o=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size));this.dottedLinePos===2&&o.addvec(i.clone().negate());const r=o.clone().addvec(s),u=r.clone().addvec(a),l=o.clone().addvec(s.clone().negate()),h=l.clone().addvec(a),f=[r,u,h,l],d=new A.McDbPolyline;return f.forEach(p=>{d.addVertexAt(p)}),e.push(d),e}drawLeftDim(n){const e=[];let i=null;const s=A.McGeVector3d.kXAxis.clone().mult(this.size*(1/16)),a=A.McGeVector3d.kYAxis.clone().mult(this.size*(1/4));this.leftDim.forEach(r=>{const u=new A.McDbMText;if(u.contents=r.content,u.textHeight=this.height,u.attachment=A.McDb.AttachmentPoint.kTopLeft,r.position===2){const f=this.dottedPos===2&&!this.suppleSymbol.filter(d=>d.typeName===5).length?n.clone().addvec(a.negate()):n.clone();u.location=f.clone().addvec(s)}else if(r.position===1){const f=this.dottedPos===1&&this.suppleSymbol.filter(d=>d.typeName===5).length?n.clone().addvec(a):n.clone();u.location=f.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size)).addvec(s)}const l=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();u.textStyleId=l,u.reCompute();const{maxPt:h}=A.MxCADUtility.getTextEntityBox(u,!1);if((!i||i<h.x)&&(i=h.x),this.dottedLinePos&&r.position===this.dottedLinePos){const f=this.dottedLinePos===1?A.McGeVector3d.kYAxis.clone().mult(this.size/4):A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();u.location=u.location.addvec(f)}e.push(u)});const o=new A.McGePoint3d(i,n.y).sub(n);return{entityArr:e,v:o}}drawTopDim(n){const e=[],i=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*1.75));return this.topDim.forEach(s=>{const a=new A.McDbMText;if(a.contents=s.content,a.textHeight=this.height,a.attachment=A.McDb.AttachmentPoint.kBaseCenter,a.location=i.clone(),a.location=i.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),s.position===2&&(a.mirror(this.fixedPoint,n),a.attachment=A.McDb.AttachmentPoint.kBaseCenter,a.location=a.location.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height))),this.dottedLinePos&&s.position===this.dottedLinePos){const o=this.dottedLinePos===1?A.McGeVector3d.kYAxis.clone().mult(this.size/4):A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();a.location=a.location.addvec(o)}e.push(a)}),{entityArr:e}}drawRightDim(n){const e=[],i=A.McGeVector3d.kXAxis.clone();let s=null;return this.rightDim.forEach(a=>{const o=new A.McDbMText;o.contents=a.content,o.textHeight=this.height,o.attachment=A.McDb.AttachmentPoint.kTopLeft,a.position===1?o.location=n.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height+this.size/8)):a.position===2&&(o.location=n.clone());const r=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();o.textStyleId=r,o.reCompute();const{maxPt:u}=A.MxCADUtility.getTextEntityBox(o,!1);if((!s||s<u.x)&&(s=u.x),this.dottedLinePos&&a.position===this.dottedLinePos){const l=this.dottedLinePos===1?A.McGeVector3d.kYAxis.clone().mult(this.size/4):A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();o.location=o.location.addvec(l)}e.push(o)}),i.mult(Math.abs(s-n.x)),{entityArr:e,v:i}}drawBasicSymbol(n){const e=[],i=[],s=(r,u)=>{let l=[];const{maxPt:h,minPt:f}=u.getBoundingBox(),d=f.clone().addvec(h.sub(f).mult(1/2)),p=new A.McGePoint3d(d.x,n.y),b=new A.McDbMText;b.contents=r.info,b.attachment=A.McDb.AttachmentPoint.kTopCenter,b.textHeight=this.size*.3333333333333333,b.location=p.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*.9166666666666666));const v=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();b.textStyleId=v,b.reCompute();const{minPt:x,maxPt:w}=A.MxCADUtility.getTextEntityBox(b,!1);if(r.position===2){const D=b.clone();D.mirror(this.fixedPoint,n),b.attachment=A.McDb.AttachmentPoint.kTopCenter,b.location=D.location.addvec(A.McGeVector3d.kYAxis.clone().mult(b.textHeight*1.1666666666666667))}e.push(b);const E=new A.McDbLine(x,new A.McGePoint3d(w.x,x.y)).IntersectWith(u,A.McDb.Intersect.kOnBothOperands);return E.length()===2?l=[E.at(0),u.getPointAt(1).val,E.at(1)]:E.length()===1&&(l=[u.getPointAt(0).val,u.getPointAt(1).val,E.at(0)]),l},a=r=>{const u=new A.McDbPolyline;return r.forEach(l=>{u.addVertexAt(l)}),u},o=(r,u)=>{const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.375)),h=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(5/8))),f=h.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/4))),d=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/4))),p=a([l,h,f,d]),{minPt:b,maxPt:v}=p.getBoundingBox(),x=b.clone().addvec(v.sub(b).mult(1/2)),w=new A.McDbMText;w.contents=r,w.attachment=A.McDb.AttachmentPoint.kBaseFit,w.textHeight=this.size*.625,w.location=x,w.reCompute();const M=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();w.textStyleId=M,w.reCompute();const{minPt:E,maxPt:D}=A.MxCADUtility.getTextEntityBox(w,!1),N=E.clone().addvec(D.sub(E).mult(.5)),V=x.sub(N);if(w.location=x.clone().addvec(V).addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/15)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/17)),u.position===2){const K=w.clone();K.mirror(this.fixedPoint,n),w.location=K.location.addvec(A.McGeVector3d.kYAxis.clone().mult(w.textHeight*1.1666666666666667))}e.push(p,w)};return this.baseSymbok.forEach(r=>{if(e.length=0,r.typeName===6){const u=this.size*.75,l=new A.McDbArc;l.center=n.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(u)).addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/8)),l.radius=u,l.startAngle=Math.PI*(3/2),l.endAngle=0;const h=l.center.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(u)),f=h.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(1/8))),d=new A.McDbLine(f,h),p=h.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(1/8))),b=l.clone();b.mirror(p,new A.McGePoint3d(p.x,n.y));const v=d.clone();v.mirror(p,new A.McGePoint3d(p.x,n.y)),e.push(l,b,v,d)}else if(r.typeName===7){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.6875)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),h=new A.McDbLine(u,l),f=h.clone(),d=u.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/8)));f.move(u,d),e.push(h,f)}else if(r.typeName===8){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.5)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(7/8))),h=u.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(1/2))),f=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size));let d=[l,h,f];const p=a(d);if(r.info){const v=s(r,p);v.length&&(d=v)}const b=a(d);e.push(b)}else if(r.typeName===9){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.625)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),h=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.height));let f=[l,u,h];const d=a(f);if(r.info){const b=s(r,d);b.length&&(f=b)}const p=a(f);e.push(p)}else if(r.typeName===10){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.625));u.addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(1/8)));const l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),h=u.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/2)),f=h.clone().addvec(u.sub(h).mult(1/4)),d=f.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)).addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/16))),p=new A.McDbLine(f,d),v=a([l,u,h]);e.push(v,p)}else if(r.typeName===11){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/2)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height/2)),h=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/8))),f=h.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height/2)),d=new A.McDbLine(l,f),p=new A.McDbLine(u,h);e.push(d,p)}else if(r.typeName===12)o("MR",r);else if(r.typeName===13)o("R",r);else if(r.typeName===14)o("M",r);else if(r.typeName===15){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(3/8))),h=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/16))).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/2)),f=h.clone().addvec(A.McGeVector3d.kXAxis.clone().negate().mult(this.size*(5/8)));let d=[h,l,f];const p=new A.McDbLine(u,l),b=a(d);if(r.info){const x=s(r,b);x.length&&(d=x)}const v=a(d);e.push(v,p)}else if(r.typeName===17){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.6875)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(3/8))),h=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/2)),f=h.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(5/8)));let d=[h,l,f];const p=new A.McDbLine(u,l),b=a(d);if(r.info){const x=s(r,b);x.length&&(d=x)}const v=a(d);e.push(v,p)}else if(r.typeName===16){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(1/4))),h=new A.McDbLine(u,l),f=this.size*(3/8),d=new A.McDbArc;d.center=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(f)),d.radius=f,d.startAngle=Math.PI,d.endAngle=Math.PI*2;const p=d.getStartPoint().val,b=p.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4)),v=d.getEndPoint().val,x=v.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4));let w=[b,u,x];const M=a(w);if(r.info){const E=s(r,M);E.length&&(w=E);const N=new A.McDbLine(w[0],w[2]).IntersectWith(d,A.McDb.Intersect.kOnBothOperands);if(N.length()){const V=new A.McDbArc;V.computeArc(N.at(0).x,N.at(0).y,l.x,l.y,N.at(1).x,N.at(1).y),e.push(V)}else e.push(d)}else{const E=new A.McDbLine(p,b),D=new A.McDbLine(v,x);e.push(E,D,d)}e.push(h)}else if(r.typeName===18){const u=this.size*.375,l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size-u/2)),h=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),f=new A.McDbLine(l,h),d=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(1/4))),p=new A.McDbArc;p.center=d.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(u)),p.radius=u,p.startAngle=Math.PI*(3/2),p.endAngle=Math.PI*2;const b=p.getEndPoint().val,v=b.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4)),x=new A.McDbLine(b,v);e.push(x,p,f)}else if(r.typeName===19){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),h=new A.McDbLine(u,l),f=A.McGeVector3d.kXAxis.clone().mult(this.size*(3/16)),d=h.clone();d.move(u,u.clone().addvec(f));const p=h.clone();p.move(u,u.clone().addvec(f.clone().negate())),e.push(h,d,p)}else if(r.typeName===20){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*.6875)),l=A.McGeVector3d.kXAxis.clone().mult(this.size*(3/8)),h=u.clone().addvec(l),f=u.clone().addvec(l.clone().negate()),d=new A.McDbLine(h,f),p=d.clone();p.mirror(this.fixedPoint,n),e.push(d,p)}else if(r.typeName===21){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(1/4))),h=new A.McDbCircle;h.center=l,h.radius=this.size*(11/16);const f=new A.McDbLine(this.fixedPoint,n),d=h.IntersectWith(f,A.McDb.Intersect.kExtendBoth);if(d.length()===2){const p=new A.McDbArc,b=l.clone().addvec(A.McGeVector3d.kYAxis.clone().negate().mult(h.radius)),v=d.at(0),x=d.at(1);p.computeArc(v.x,v.y,b.x,b.y,x.x,x.y),p.mirror(this.fixedPoint,n);const w=new A.McDbLine(v,x);e.push(p,w)}}else if(r.typeName===22){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=A.McGeVector3d.kXAxis.clone().mult(this.height/2),h=u.clone().addvec(l),f=u.clone().addvec(l.clone().negate()),d=f.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),p=a([h,f,d]);p.isClosed=!0,e.push(p)}else if(r.typeName===23){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=A.McGeVector3d.kXAxis.clone().mult(this.size/2),h=A.McGeVector3d.kYAxis.clone().mult(this.size*(5/8)),f=u.clone().addvec(l),d=f.clone().addvec(h),p=d.clone().addvec(l.negate().mult(2)),b=p.clone().addvec(h.clone().negate()),v=a([f,d,p,b]);e.push(v)}else if(r.typeName===24){const u=new A.McDbCircle;u.center=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),u.radius=this.size*(3/8),e.push(u)}else if(r.typeName===25){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height*(2/3))),h=A.McGeVector3d.kXAxis.clone().mult(this.size*(1/8)),f=l.clone().addvec(h),d=l.clone().addvec(h.clone().negate()),p=new A.McDbLine(f,d),b=A.McGeVector3d.kYAxis.clone().mult(this.height/3),v=p.clone();v.move(f,f.clone().addvec(b)),v.endPoint=v.endPoint.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.height/3).negate());const x=p.clone();x.move(f,f.clone().addvec(b.clone().negate()));const w=new A.McDbArc;w.center=d.clone().addvec(b.clone().negate()),w.radius=this.height/3,w.startAngle=Math.PI/2,w.endAngle=Math.PI*(3/2);const M=new A.McDbArc;M.center=f,M.radius=this.height/3,M.startAngle=Math.PI*(3/2),M.endAngle=Math.PI/2,e.push(p,v,x,w,M)}else if(r.typeName===26){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size-this.height/2)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)).addvec(A.McGeVector3d.kXAxis.clone().mult(this.height/2)),h=new A.McDbLine(u,l),f=h.clone();f.move(u,u.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.height/2))),e.push(h,f)}else if(r.typeName===27){const u=new A.McDbCircle;u.center=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),u.radius=this.height/2,e.push(u)}else if(r.typeName===28){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=new A.McDbCircle;l.center=u,l.radius=this.size*(11/16);const h=A.McGeVector3d.kXAxis.clone().mult(this.height),f=u.clone().addvec(h),d=u.clone().addvec(h.clone().negate()),p=new A.McDbLine(f,d),b=A.McGeVector3d.kYAxis.clone().mult(this.height/2),v=p.clone();v.move(u,u.clone().addvec(b));const x=p.clone();x.move(u,u.clone().addvec(b.clone().negate())),e.push(l,v,x)}else if(r.typeName===29){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=A.McGeVector3d.kYAxis.clone().mult(this.size*(9/16)),h=new A.McDbCircle;h.center=u.clone().addvec(l),h.radius=this.size*(9/16);const f=A.McGeVector3d.kXAxis.clone().mult(this.height),d=u.clone().addvec(f),p=u.clone().addvec(f.clone().negate()),b=new A.McDbLine(d,p),v=h.center.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(3/16))),x=h.center.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate()),w=b.clone();w.move(u,v);const M=b.clone();M.move(u,x),e.push(h,w,M)}else if(r.typeName===30){const u=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),l=u.addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4)),h=A.McGeVector3d.kXAxis.clone().mult(this.size*(5/16)),f=l.clone().addvec(h),d=l.clone().addvec(h.clone().negate()),p=new A.McDbLine(f,d),b=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/8)),v=b.clone().addvec(h).addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),x=new A.McDbLine(b,v),w=x.clone();w.mirror(u,l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size))),e.push(p,x,w)}if(r.position===2&&e.forEach(u=>{u instanceof A.McDbMText||u.mirror(this.fixedPoint,n)}),this.dottedLinePos&&r.position===this.dottedLinePos){const u=this.dottedLinePos===1?A.McGeVector3d.kYAxis.clone().mult(this.size/4):A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();e.forEach(l=>{l.move(n,n.clone().addvec(u))})}i.push(...e)}),{entityArr:i}}drawSpecialSymbol(n){const e=[],i=[];return this.specialSymbol.forEach(s=>{if(e.length=0,s.typeName===31){const a=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*1.25)),o=A.McGeVector3d.kXAxis.clone().mult(this.size/8),r=a.clone().addvec(o),u=r.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/8)),l=new A.McDbLine(r,u),h=new A.McDbArc,f=this.size*(3/4);h.center=u.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(f)),h.radius=f,h.startAngle=Math.PI/2,h.endAngle=Math.PI;const d=a.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size)),p=l.clone();p.mirror(a,d);const b=h.clone();b.mirror(a,d),e.push(l,h,p,b)}else if(s.typeName===32){const a=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.375)),o=a.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),r=new A.McDbLine(a,o),u=a.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/4)),l=u.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/8)),h=new A.McDbLine(u,l),f=new A.McDbArc;f.center=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(3/4))),f.radius=this.size*(3/4),f.startAngle=Math.PI/2,f.endAngle=Math.PI,e.push(r,h,f)}else if(s.typeName===33){const a=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.375)),o=this.size*(9/16),r=new A.McDbArc;r.center=a.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(o)),r.radius=o,r.startAngle=0,r.endAngle=Math.PI;const u=r.clone(),l=a.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(o*2));u.mirror(l,l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size))),e.push(r,u)}else if(s.typeName===34){const a=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*.375)),o=A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate(),r=a.clone().addvec(o),u=A.McGeVector3d.kXAxis.clone().mult(this.height),l=r.clone().addvec(u),h=l.clone().addvec(o.clone().mult(7/4)),f=h.clone().addvec(u.clone().negate()),d=new A.McDbPolyline;[a,r,l,h,f].forEach(M=>d.addVertexAt(M));const b=a.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.height)),v=b.clone().addvec(u),x=new A.McDbPolyline;[b,a,v].forEach(M=>x.addVertexAt(M)),e.push(d,x)}else if(s.typeName===35){const a=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().negate().mult(this.size/4)),o=A.McGeVector3d.kXAxis.clone().mult(this.size*(7/16)),r=a.clone().addvec(o),u=r.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(7/16)).negate()),l=u.clone().addvec(o.clone().negate()),h=new A.McDbPolyline;[a,r,u,l].forEach(M=>h.addVertexAt(M));const d=a.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(5/8))),p=A.McGeVector3d.kXAxis.clone().mult(this.size*(9/16)),b=d.clone().addvec(p),v=d.clone().addvec(p.clone().negate()),x=new A.McDbPolyline;[b,a,v].forEach(M=>x.addVertexAt(M)),e.push(h,x)}if(s.position===2&&e.forEach(a=>{a.mirror(this.fixedPoint,this.fixedPoint.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*10)))}),this.dottedLinePos&&s.position===this.dottedLinePos){const a=this.dottedLinePos===1?A.McGeVector3d.kYAxis.clone().mult(this.size/4):A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();e.forEach(o=>{o.move(n,n.clone().addvec(a))})}i.push(...e)}),{entityArr:i}}drawAuxiliarySymbol(n){const e=[],i=[];return this.auxiliarySymbol.forEach(s=>{e.length=0;const a=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(21/16))),o=A.McGeVector3d.kXAxis.clone().mult(this.size*(5/8)),r=a.clone().addvec(o),u=a.clone().addvec(o.clone().negate());if(s.typeName===36){const l=new A.McDbLine(r,u);e.push(l)}else if(s.typeName===37){const l=a.clone().addvec(A.McGeVector3d.kYAxis.clone().negate().mult(this.size*.375)),h=new A.McDbArc;h.computeArc(r.x,r.y,l.x,l.y,u.x,u.y),e.push(h)}else if(s.typeName===38){const l=a.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*.375)),h=new A.McDbArc;h.computeArc(r.x,r.y,l.x,l.y,u.x,u.y),e.push(h)}else if(s.typeName===39){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4)),h=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size*(11/16))),f=l.clone().addvec(A.McGeVector3d.kXAxis.clone().negate().mult(this.size/4)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(15/16))),d=new A.McDbLine(h,f);e.push(d)}else if(s.typeName===40){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/4)),h=l.clone().addvec(A.McGeVector3d.kXAxis.clone().negate().mult(this.size*(11/16))),f=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size/4)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(15/16))),d=new A.McDbLine(h,f);e.push(d)}else if(s.typeName===41){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*.625)),h=new A.McDbArc;h.center=l,h.startAngle=0,h.endAngle=Math.PI/2,h.radius=this.size*(5/8),e.push(h)}else if(s.typeName===42){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*.625)),h=this.size*(5/8),f=l.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(h)).addvec(A.McGeVector3d.kYAxis.clone().mult(h)),d=new A.McDbArc;d.center=f,d.radius=h,d.startAngle=Math.PI,d.endAngle=Math.PI*(3/2),e.push(d)}else if(s.typeName===43){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(A.McGeVector3d.kYAxis.clone().mult(this.size)),h=A.McGeVector3d.kXAxis.clone().mult(this.size*(7/16)),f=l.clone().addvec(h),d=l.clone().addvec(h.clone().negate()),p=new A.McDbLine(f,d),b=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size/8)),v=A.McGeVector3d.kXAxis.clone().mult(this.size*(7/32)),x=b.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(7/16))).addvec(v.clone().negate()),w=x.clone().addvec(v.clone().mult(2)),M=w.sub(b),E=w.clone().addvec(M),D=[w,x,b,E],N=new A.McDbPolyline;D.forEach(V=>N.addVertexAt(V)),e.push(N,p)}else if(s.typeName===44){const l=n.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(this.size)),h=l.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(5/4))),f=h.clone().addvec(A.McGeVector3d.kYAxis.clone().mult(this.size*(3/8))),d=new A.McDbLine(h,f),p=this.size*(7/32),b=h.clone().addvec(A.McGeVector3d.kXAxis.clone().mult(p)),v=new A.McDbArc;v.center=b,v.radius=p,v.startAngle=Math.PI,v.endAngle=0;const x=v.clone();x.mirror(l,h),e.push(d,v,x)}if(s.position===2&&e.forEach(l=>{l.mirror(this.fixedPoint,n)}),this.dottedLinePos&&s.position===this.dottedLinePos){const l=this.dottedLinePos===1?A.McGeVector3d.kYAxis.clone().mult(this.size/4):A.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();e.forEach(h=>{h.move(n,n.clone().addvec(l))})}i.push(...e)}),{entityArr:i}}getBox(n){let e,i=null;n.forEach(s=>{if(s instanceof A.McDbMText){const r=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();s.textStyleId=r,s.reCompute()}const{minPt:a,maxPt:o}=s instanceof A.McDbMText?A.MxCADUtility.getTextEntityBox(s,!1):s.getBoundingBox();e||(e=a.clone()),i||(i=o.clone()),a.x<e.x&&(e.x=a.x),a.y<e.y&&(e.y=a.y),o.x>i.x&&(i.x=o.x),o.y>i.y&&(i.y=o.y)}),e&&i&&(this.assertWrite(),this.maxPt=i,this.minPt=e)}getBoundingBox(){const n=this.getAllEntity();return this.getBox(n),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}getBaseSymbok(){return this.baseSymbok}setBaseSymbok(n){const e=n.filter(i=>i.typeName!==45);this.baseSymbok=e}getAuxiliarySymbol(){return this.auxiliarySymbol}setAuxiliarySymbol(n){const e=n.filter(i=>i.typeName!==45);this.auxiliarySymbol=e}getSpecialSymbol(){return this.specialSymbol}setSpecialSymbol(n){const e=n.filter(i=>i.typeName!==45);this.specialSymbol=e}getSuppleSymbol(){return this.suppleSymbol}setSuppleSymbol(n){const e=n.filter(i=>i.typeName!==45);this.suppleSymbol=e}getLeftDim(){return this.leftDim}setLeftDim(n){const e=n.filter(i=>i.content!=="");this.leftDim=e}getTopDim(){return this.topDim}setTopDim(n){const e=n.filter(i=>i.content!=="");this.topDim=e}getRightDim(){return this.rightDim}setRightDim(n){const e=n.filter(i=>i.content!=="");this.rightDim=e}getIntWeldSeam(){return this.interlacedWeldSeam}setIntWeldSeam(n){const e=n.filter(i=>i.content!=="");this.interlacedWeldSeam=e}}function MI(){return re(this,null,function*(){fs.value="WeldingSymbolDialog",Ho.showDialog(!0,{title:dt("焊接符号")}).then(e=>re(this,[e],function*({data:t,isCanceled:n}){if(!n&&t.formData){const i=t.formData,s=new _f;if(i.specialSymbol.length&&s.setSpecialSymbol(i.specialSymbol),i.rightDim1||i.rightDim2){const v=[1,2],x=[];v.forEach(w=>{const M=i.rightDim1.filter(N=>N.position===w)[0],E=i.rightDim2.filter(N=>N.position===w)[0],D=M.content&&E.content?"×":"";x.push({position:w,content:M.content+D+E.content})}),s.setRightDim(x)}i.suppleSymbol.length&&s.setSuppleSymbol(i.suppleSymbol),i.leftDim&&s.setLeftDim(i.leftDim),i.topDim&&s.setTopDim(i.topDim),i.auxiliarySymbol.length&&s.setAuxiliarySymbol(i.auxiliarySymbol),i.basicSymbol.length&&s.setBaseSymbok(i.basicSymbol),i.intWeldSeam&&s.setIntWeldSeam(i.intWeldSeam),i.dottedLinePos&&(s.dottedLinePos=i.dottedLinePos),i.weldingSymbolInfo&&(s.weldingSymbolInfo=i.weldingSymbolInfo.replace(/\n/g,"\\P"));let a=!1;const o=new A.MxCADUiPrPoint;o.setMessage(`${dt("请设置定位点或直线或圆弧")}`);const r=yield o.go();if(!r)return;s.weldingPosition=r;const u=new A.MxCADResbuf;u.AddMcDbEntityTypes("ARC,CIRCLE");let l=A.MxCADUtility.findEntAtPoint(r.x,r.y,r.z,-1,u);l.isValid()&&(a=!0);const h=new A.MxCADUiPrPoint;h.setMessage(`${dt("请设置引线转折点")}`),h.setUserDraw((v,x)=>{if(a){const M=l.getMcDbEntity().getClosestPointTo(v,!0).val;s.weldingPosition=M}s.turningPoint=v,x.drawMcDbEntity(s)});const f=yield h.go();if(!f)return;s.turningPoint=f;const d=new A.MxCADUiPrPoint;d.setMessage(`${dt("拖动确定定位点")}`),d.setUserDraw((v,x)=>{const w=s.clone();w.fixedPos=v,x.drawMcDbEntity(w)});const p=yield d.go();p&&(s.fixedPos=p),A.MxCpp.getCurrentMxCAD().drawEntity(s)}}))})}class kg extends A.McDbCustomEntity{constructor(n){super(n),this.startPoint=new A.McGePoint3d,this.endPoint=new A.McGePoint3d,this.anchorPoint=new A.McGePoint3d,this.arrowSize=4,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new kg(n)}getTypeName(){return"McDbTestRayAnnotation"}dwgInFields(n){return this.startPoint=n.readPoint("startPoint").val,this.endPoint=n.readPoint("endPoint").val,this.anchorPoint=n.readPoint("anchorPoint").val,this.arrowSize=n.readDouble("arrowSize").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("startPoint",this.startPoint),n.writePoint("endPoint",this.endPoint),n.writePoint("anchorPoint",this.anchorPoint),n.writeDouble("arrowSize",this.arrowSize),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite();const a=new A.McDbLine(this.startPoint,this.endPoint);if(n===0){const o=this.startPoint.clone();o.x+=e,o.y+=i,o.z+=s,this.startPoint=a.getClosestPointTo(o,!0).val}else if(n===1){const o=this.endPoint.clone();o.x+=e,o.y+=i,o.z+=s,this.endPoint=a.getClosestPointTo(o,!0).val}else n===2&&(this.anchorPoint.x+=e,this.anchorPoint.y+=i,this.anchorPoint.z+=s,this.resetAnchorPoint())}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.startPoint),n.append(this.endPoint),n.append(this.anchorPoint),n}sortPointsByXAxis(n){const e=n.map(i=>i.clone());for(let i=0;i<e.length-1;i++)for(let s=0;s<e.length-1-i;s++)if(e[s].x>e[s+1].x){const a=e[s];e[s]=e[s+1],e[s+1]=a}return e}worldDraw(n){this.getAllEntity().forEach(e=>{n.drawEntity(e)})}getAllEntity(){const n=new A.McDbLine(this.startPoint,this.endPoint),e=this.startPoint.sub(this.endPoint).normalize().mult(this.arrowSize),i=this.endPoint.clone().addvec(e),s=e.clone().perpVector().mult(this.arrowSize/8),a=i.clone().addvec(s),o=i.clone().addvec(s.clone().negate()),r=new A.McDbHatch;r.appendLoop(new A.McGePoint3dArray([a,o,this.endPoint]));const u=new A.McDbMText;u.contents=`${n.getLength().val.toFixed(2)}`,u.textHeight=this.arrowSize*(7/8),u.attachment=A.McDb.AttachmentPoint.kBottomCenter,u.location=this.anchorPoint.clone(),u.textStyleId=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();const l=this.sortPointsByXAxis([this.endPoint,this.startPoint]),h=l[l.length-1].sub(l[0]),f=h.clone().angleTo2(A.McGeVector3d.kXAxis);u.rotate(u.location,f),u.location=u.location.clone().addvec(h.clone().rotateBy(Math.PI/2).normalize().mult(this.arrowSize/8)),u.reCompute();const{maxPt:d,minPt:p}=A.MxCADUtility.getTextEntityBox(u,!1),b=n.getClosestPointTo(d,!0).val,v=n.getClosestPointTo(p,!0).val,x=this.sortPointsByXAxis([b,v,this.startPoint,this.endPoint,this.anchorPoint]),w=new A.McDbLine(x[0],x[x.length-1]);return[r,w,u]}getBox(n){let e,i=null;n.forEach(s=>{s instanceof A.McDbMText&&s.reCompute();const{minPt:a,maxPt:o}=s instanceof A.McDbMText?A.MxCADUtility.getTextEntityBox(s,!1):s.getBoundingBox();e||(e=a.clone()),i||(i=o.clone()),a.x<e.x&&(e.x=a.x),a.y<e.y&&(e.y=a.y),o.x>i.x&&(i.x=o.x),o.y>i.y&&(i.y=o.y)}),e&&i&&(this.assertWrite(),this.maxPt=i,this.minPt=e)}resetAnchorPoint(){const n=new A.McDbLine(this.startPoint,this.endPoint),e=n.getClosestPointTo(this.anchorPoint,!0).val;n.getDistAtPoint(this.anchorPoint).val?this.anchorPoint=n.getPointAtDist(n.getLength().val/2).val:this.anchorPoint=e}getBoundingBox(){return this.getBox(this.getAllEntity()),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}setStartPoint(n){this.assertWrite(),this.startPoint=this.endPoint=this.anchorPoint=n.clone()}getStartPoint(){return this.startPoint}setEndPoint(n){this.assertWrite(),this.endPoint=this.anchorPoint=n.clone()}getEndPoint(){return this.endPoint}setAnchorPoint(n){this.assertWrite(),this.anchorPoint=n.clone(),this.resetAnchorPoint()}getAnchorPoint(){return this.anchorPoint}setArrowSize(n){this.assertWrite(),this.arrowSize=n}getArrowSize(){return this.arrowSize}}function AI(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new kg;n.setArrowSize(5);const e=new A.MxCADUiPrPoint;e.setMessage(dt("请指定第一点:"));const i=yield e.go();if(!i)return;n.setStartPoint(i);const s=new A.MxCADUiPrPoint;s.setMessage(dt("请指定第二点:")),s.setUserDraw((u,l)=>{n.setEndPoint(u),l.drawMcDbEntity(n)});const a=yield s.go();if(!a)return;n.setEndPoint(a);const o=new A.MxCADUiPrPoint;o.setMessage("请指定定位点:"),o.setUserDraw((u,l)=>{n.setAnchorPoint(u),l.drawMcDbEntity(n)});const r=yield o.go();r&&(n.setAnchorPoint(r),t.drawEntity(n))})}function SI(){new Ag().rxInit(),new Sg().rxInit(),new vf().rxInit(),new Eg().rxInit(),new Tg().rxInit(),new Cg().rxInit(),new _a().rxInit(),new Pg().rxInit(),new Dg().rxInit(),new Rg().rxInit(),new _f().rxInit(),new kg().rxInit(),Ct.MxFun.addCommand("Mx_Approval",pI),Ct.MxFun.addCommand("Mx_AnnotatedRectangle",mI),Ct.MxFun.addCommand("Mx_Alignment",gI),Ct.MxFun.addCommand("Mx_indexSymbol",yI),Ct.MxFun.addCommand("Mx_RotationLabel",bI),Ct.MxFun.addCommand("Mx_RoundHoleMark",vI),Ct.MxFun.addCommand("Mx_Roughness",xI),Ct.MxFun.addCommand("Mx_weldSymbol",_I),Ct.MxFun.addCommand("Mx_DirectionaSymbol",wI),Ct.MxFun.addCommand("Mx_WeldingSymbol",MI),Ct.MxFun.addCommand("MxTest_DrawRayAnnotation",AI),uI(),Uk(),fI()}function EI(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;if(!(yield t.userSelect(dt("选择对象:")))||t.count()==0)return;const n=[],e=A.MxCpp.getCurrentMxCAD(),i=new A.MxCADUiPrPoint;i.setMessage(dt("指定基点"));const s=yield i.go();if(s)for(;;){const a=new A.MxCADUiPrPoint;a.setMessage(dt("指定第二个点 ")),n.length>0?a.setKeyWords(`[${dt("阵列")}(A)/${dt("退出")}(E)/${dt("放弃")}(U)]`):a.setKeyWords(`[${dt("阵列")}(A)/${dt("退出")}(E)]`),a.setUserDraw((r,u)=>{u.drawLine(r.toVector3(),s.toVector3()),t.forEach(l=>{let h=l.getMcDbEntity();if(!h)return;let f=h.clone();f.move(s,r),u.drawMcDbEntity(f)})});const o=yield a.go();if(a.getStatus()===Ct.MrxDbgUiPrBaseReturn.kKeyWord){if(a.isKeyWordPicked("E"))return;if(a.isKeyWordPicked("U"))if(n.length>0)n[n.length-1].forEach(r=>{r.erase()}),n.pop();else return;else if(a.isKeyWordPicked("A")){const r=new A.MxCADUiPrInt;r.clearLastInputPoint(),r.setMessage(dt("输入要进行阵列的项目数 "));const u=(yield r.go())||1;let l=[];if(a.setUserDraw((f,d)=>{d.drawLine(f.toVector3(),s.toVector3()),l.length=0;let p=f.clone();l.push(p);for(let b=0;b<u-1;b++)p=p.clone().addvec(f.sub(s)),l.push(p);t.forEach(b=>{let v=b.getMcDbEntity();v&&l.forEach(x=>{let w=new A.McGeMatrix3d,M=v.clone();w.clone(),w.setToTranslation(x.sub(s)),M.transformBy(w),d.drawMcDbEntity(M)})})}),!(yield a.go()))return;n.push([]),t.forEach(f=>{let d=f.getMcDbEntity();d&&l.forEach(p=>{let b=new A.McGeMatrix3d,v=d.clone();b.clone(),b.setToTranslation(p.sub(s)),v.transformBy(b),n[n.length-1].push(e.drawEntity(v))})})}}else if(a.getStatus()===Ct.MrxDbgUiPrBaseReturn.kOk){if(!o)return;n.push([]),t.forEach(r=>{let u=r.getMcDbEntity();if(!u)return;let l=u.clone();l.move(s,o),n[n.length-1].push(e.drawEntity(l))})}else return}})}function TI(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("ARC");let n=yield A.MxCADUtility.userSelect(dt("选择圆弧对象"),t);n.length!=0&&n.forEach(e=>re(this,null,function*(){let i=yield e.getMcDbEntity(),s=i,a=s.center,o=s.radius,r=new A.McDbCircle;r.center=a,r.radius=o,i.erase(),A.MxCpp.getCurrentMxCAD().drawEntity(r)}))})}function CI(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD();let n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("选择复制旋转对象:")))||n.count()==0)return;const e=new A.MxCADUiPrPoint;e.setMessage(dt("指定基点"));const i=yield e.go(),s=new A.MxCADUiPrPoint;s.setMessage(dt("请指定目标点 ")),s.setUserDraw((h,f)=>{f.drawLine(h.toVector3(),i.toVector3()),n.forEach(d=>{let p=d.getMcDbEntity();if(!p)return;let b=p.clone();b.move(i,h),f.drawMcDbEntity(b)})});const a=yield s.go();if(!a)return;let o=[];n.forEach(h=>{let f=h.getMcDbEntity();if(!f)return;let d=f.clone();d.move(i,a),o.push(t.drawEntity(d))});let r=new A.MxCADUiPrAngle;if(r.setMessage(dt("请指定旋转角度")),r.setBasePt(a),r.setUserDraw((h,f)=>{f.drawLine(h.toVector3(),a.toVector3()),o.forEach(d=>{let p=d.getMcDbEntity();if(!p)return;let b=p.clone(),v=h.sub(a).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis);b.rotate(a,v),f.drawMcDbEntity(b)})}),!(yield r.go()))return;const l=r.value();o.forEach(h=>{let f=h.getMcDbEntity();if(!f)return;let d=f.clone();d.rotate(a,l),t.drawEntity(d),f.erase()})})}function PI(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("CIRCLE");let n=yield A.MxCADUtility.userSelect(dt("选择要转成多边形的对象"),t);if(n.length==0)return;let e=new A.MxCADUiPrInt;e.setMessage(dt("设置多边形边数"));let i=(yield e.go())||5;if(e.clearLastInputPoint(),!i)return;const s=new A.MxCADUiPrPoint;s.setMessage(dt(" 输入选项")),s.setKeyWords(`[${dt("内接于圆")}(I)/${dt("外切于圆")}(C)]`),s.clearLastInputPoint(),yield s.go();let a="inside";s.isKeyWordPicked("i")&&(a="inside"),s.isKeyWordPicked("c")&&(a="outside");let o=A.MxCpp.getCurrentMxCAD();n.forEach(r=>re(this,null,function*(){let u=yield r.getMcDbEntity(),l=u,h=[];if(a==="inside"){for(let d=0;d<i;d++){let p=l.getPointAtDist(l.getLength().val/i*d);p.ret&&h.push(p.val)}let f=new A.McDbPolyline;h.forEach(d=>{f.addVertexAt(d)}),f.isClosed=!0,o.drawEntity(f)}else if(a==="outside"){let f=90-360/(i*2),d=Math.sin(f*Math.PI/180),p=l.radius/d,b=new A.McDbCircle;b.center=l.center,b.radius=p;let v=[];for(let w=0;w<i;w++){let M=b.getPointAtDist(b.getLength().val/i*w);M.ret&&v.push(M.val)}let x=new A.McDbPolyline;v.forEach(w=>{x.addVertexAt(w)}),x.isClosed=!0,o.drawEntity(x)}u.erase()}))})}function DI(){return re(this,null,function*(){let t=yield A.MxCADUtility.userSelect(dt("选择要修改颜色的对象"));if(t.length==0)return;const n=new A.MxCADUiPrInt;n.setMessage(`${dt("输入颜色索引")}(0~256)`);let e=(yield n.go())||20,i=new A.McCmColor;i.setColorIndex(e),t.forEach(s=>re(this,null,function*(){let a=s.getMcDbEntity();a.trueColor=i}))})}function RI(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("ARC");let n=yield A.MxCADUtility.userSelect(dt("选择圆弧对象"),t);n.length!=0&&n.forEach(e=>re(this,null,function*(){let i=yield e.getMcDbEntity();if(!i)return;let s=i.clone(),a=s.getLength(),o=s.getStartPoint().val,r=A.MxCpp.getCurrentMxCAD(),u=new A.McDbCircle;u.center=s.center,u.radius=s.radius;let l=u.getDistAtPoint(o),h=u.getPointAtDist(a.val+l.val).val,f=s.getFirstDeriv(o);if(!f.ret)return;let d=o.clone();d.addvec(f.val);let p=s.getFirstDeriv(h);if(!p.ret)return;let b=h.clone();b.addvec(p.val);let v=new A.McDbLine;v.startPoint=o,v.endPoint=d;let x=new A.McDbLine;x.startPoint=h,x.endPoint=b;let w=v.IntersectWith(x,A.McDb.Intersect.kExtendBoth);if(w.length()===0)return;let M=w.at(0);v.endPoint=M,x.endPoint=M,r.drawEntity(v),r.drawEntity(x)}))})}function kI(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=new A.MxCADUiPrKeyWord;n.setMessage(dt(" 输入选项")),n.setKeyWords(`[${dt("隐藏")}(A)/${dt("隐藏未选")}(B)/${dt("全部显示")}(C)]`);const e=yield n.go();if(e){if(e==="A"||e==="B"){let i=yield A.MxCADUtility.userSelect(dt("选择目标的对象"));if(i.length==0)return;let s=[];if(i.forEach(a=>s.push(a.id)),e==="A")i.forEach(a=>re(this,null,function*(){let o=yield a.getMcDbEntity();o&&(o.visible=!1)}));else if(e==="B"){let a=new A.MxCADSelectionSet;a.allSelect(),a.forEach(o=>re(this,null,function*(){if(!s.includes(o.id)){let r=yield o.getMcDbEntity();r&&(r.visible=!1)}}))}}else if(e==="C"){let i=new A.MxCADSelectionSet;i.allSelect(),i.forEach(s=>re(this,null,function*(){let a=yield s.getMcDbEntity();a&&a.visible===!1&&(a.visible=!0)}))}else return;t.updateDisplay()}})}function II(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;let n=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor();t.setMessage(dt(" 指定删除方框第一点:"));let e=yield t.go();if(!e)return;let i=A.MxCpp.getCurrentMxCAD(),s=new Ct.MxDbRect;s.pt1=e.toVector3(),t.setUserDraw((h,f)=>{s.pt2=h.toVector3(),s.setColor(n),f.drawCustomEntity(s)}),t.setMessage(dt(" 指定删除方框第二点:")),t.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let a=yield t.go();if(!a)return;s.pt2=a.toVector3();let o=new A.McDbPolyline;o.addVertexAt(e),o.addVertexAt(new A.McGePoint3d(e.x,a.y)),o.addVertexAt(a),o.addVertexAt(new A.McGePoint3d(a.x,e.y)),o.isClosed=!0;let r=i.drawEntity(o);const u=new A.MxCADSelectionSet;for(u.crossingSelect(e.x,e.y,a.x,a.y),u.getIds().forEach(h=>{if(h&&h.id!==r.id){let f=h.getMcDbEntity(),d=f.IntersectWith(o,A.McDb.Intersect.kOnBothOperands);if(d.length()===0)h.erase();else{let p=[];d.forEach(b=>p.push(b)),f.splitCurves(p).forEach(b=>{i.drawEntity(b)}),h.erase()}}});;){const h=new A.MxCADUiPrPoint;h.setMessage(dt(" 选择需要精确删除的实体"));const f=yield h.go();if(!f)break;let d=A.MxCADUtility.findEntAtPoint(f.x,f.y,f.z,-1);i.addCurrentSelect(d)}A.MxCADUtility.getCurrentSelect().forEach(h=>{h.erase()}),i.mxdraw.clearMxCurrentSelect()})}function LI(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrEntity;n.setMessage(dt(" 请选择角度复制对象"));const e=yield n.go();if(e===null)return;const i=yield e.getMcDbEntity(),s=new A.MxCADUiPrInt;s.setMessage(dt(" 请输入角度复制数量"));const a=(yield s.go())||1,o=new A.MxCADUiPrPoint;o.setMessage(dt(" 请输入角度复制的基点"));const r=yield o.go();if(!r)return;const u=new A.MxCADUiPrAngle;if(u.setMessage(dt(" 请输入复制角度")),u.setBasePt(r),u.setUserDraw((f,d)=>{const p=f.sub(r).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis);for(let b=1;b<a+1;b++){let v=i.clone();v.rotate(r,p*b),d.drawMcDbEntity(v)}}),!(yield u.go()))return;const h=u.value();for(let f=1;f<a+1;f++){let d=i.clone();d.rotate(r,h*f),t.drawEntity(d)}})}function BI(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LWPOLYLINE");let n=yield A.MxCADUtility.userSelect(dt("请选择顶点对象"),t);if(n.length==0)return;let e=yield A.MxCADUtility.userSelect(dt("请选择复制对象"));if(e.length==0)return;const i=new A.MxCADUiPrPoint;i.setMessage(dt("请确定复制基点"));const s=yield i.go();if(!s)return;const a=A.MxCpp.getCurrentMxCAD();n.forEach(o=>{let r=o.getMcDbEntity();if(!r)return;let u=r.numVerts();for(let l=0;l<u;l++){const h=r.getPointAt(l).val;e.forEach(f=>{const p=f.getMcDbEntity().clone();p.move(s,h),a.drawEntity(p)})}})})}function FI(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择参考曲线"));let n=yield t.go(),e=yield n.getMcDbEntity();if(e===null)return;const i=A.MxCpp.App.getCurrentMxCAD();let s=e.clone(),a=new A.MxCADResbuf;a.AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE,ELLIPSE");let o=yield A.MxCADUtility.userSelect(dt("选择打断对象"),a);if(o.length==0)return;let r=i.mxdraw.viewCoordLong2Cad(.5);o.forEach(u=>re(this,null,function*(){if(u.id!==n.id){let l=yield u.getMcDbEntity(),h=l.IntersectWith(s,A.McDb.Intersect.kOnBothOperands);if(h.length()!=0){let f=[];h.forEach(b=>{f.push(b)});let d=[];f.forEach(b=>{let v=l.getClosestPointTo(b,!1);if(!v.ret)return;let x=l.getFirstDeriv(v.val);if(!x.ret)return;x.val.normalize().mult(Ct.MxFun.viewCoordLong2Cad(10));let w=v.val.clone();w.addvec(x.val);let M=v.val.clone();M.subvec(x.val);const E=l.getPointAtDist(0).val,D=l.getPointAtDist(l.getLength().val).val;if(E.distanceTo(v.val)<r||D.distanceTo(v.val)<r){const N=l.getDistAtPoint(w);d.push(v.val),N.ret?d.push(w):d.push(M)}else d.push(w),d.push(M)});let p=l.splitCurves(d);if(p.empty()){l.highlight(!1);return}p.forEach((b,v)=>{v%2==0&&i.drawEntity(b)}),l.erase()}}}))})}function NI(){return re(this,null,function*(){let t=A.MxCpp.App.getCurrentMxCAD(),n=new A.MxCADResbuf;n.AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE,ELLIPSE");let e=new A.MxCADUiPrEntity;e.setFilter(n),e.setMessage(dt("指定偏移对象"));let i=yield e.go();if(!i)return;const s=new A.MxCADUiPrDist;if(s.setMessage(dt("请输入偏移距离")),!(yield s.go()))return;const o=s.value();let r=yield i.getMcDbEntity();const u=r.getStartPoint().val,h=r.getFirstDeriv(u).val.rotateBy(A.McGeVector3d.kYAxis.angleTo1(A.McGeVector3d.kXAxis)),f=u.clone().addvec(h),d=u.clone().subvec(h);let p=r.offsetCurves(o,f);if(p.length()===0)return;p.forEach(v=>{t.drawEntity(v)});let b=r.offsetCurves(o,d);b.length()!==0&&b.forEach(v=>{t.drawEntity(v)})})}function OI(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("ARC,LINE,LWPOLYLINE");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("指定伸缩对象(选择直线、多段线、圆弧)"));const e=yield n.go();if(!e)return;const i=A.MxCpp.App.getCurrentMxCAD(),s=e.getMcDbEntity();if(s instanceof A.McDbArc){const a=s.clone(),o=a.center,r=new A.MxCADUiPrPoint;r.setMessage(dt("伸缩至")),s.visible=!1,r.setUserDraw((l,h)=>{a.endAngle=l.sub(o).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis),h.drawMcDbEntity(a)});const u=yield r.go();if(s.visible=!0,!u)return;s.endAngle=u.sub(o).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis),i.updateDisplay()}else if(s instanceof A.McDbLine){const a=s.clone(),o=new A.MxCADUiPrPoint;o.setMessage(dt("伸缩至")),s.visible=!1;let r;o.setUserDraw((l,h)=>{r=a.getClosestPointTo(l,!0).val,a.endPoint=r,h.drawMcDbEntity(a)});const u=yield o.go();if(s.visible=!0,!u)return;s.endPoint=r,i.updateDisplay()}else if(s instanceof A.McDbPolyline){const a=s.clone(),o=new A.MxCADUiPrPoint;o.setMessage(dt("伸缩至")),s.visible=!1;let r;const u=s.numVerts(),l=s.getBulgeAt(u-1),h=s.getWidthsAt(u-1);o.setUserDraw((d,p)=>{r=a.getClosestPointTo(d,!0).val,a.setPointAt(u-1,r),a.setBulgeAt(u-1,l),a.setWidthsAt(u-1,h.val1,h.val2),p.drawMcDbEntity(a)});const f=yield o.go();if(s.visible=!0,!f)return;s.setPointAt(u-1,r),s.setBulgeAt(u-1,l),s.setWidthsAt(u-1,h.val1,h.val2),i.updateDisplay()}})}function zI(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("CIRCLE");let n=yield A.MxCADUtility.userSelect(dt("选择对象"),t);if(n.length==0)return;const e=new A.MxCADUiPrDist;e.setMessage(dt("请输入圆半径"));const i=n[0].getMcDbEntity();if(e.setBasePt(i.center),e.setUserDraw((o,r)=>{const u=o.distanceTo(i.center);n.forEach(l=>{const f=l.getMcDbEntity().clone();f.radius=u,r.drawMcDbEntity(f)})}),!(yield e.go()))return;const a=e.value();n.forEach(o=>{const r=o.getMcDbEntity();r.radius=a})})}function UI(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LWPOLYLINE,ARC,LINE,CIRCLE,ELLIPSE");let n=yield A.MxCADUtility.userSelect(dt("选择要修改线型比例的对象"),t);if(n.length==0)return;const e=new A.MxCADUiPrString;if(e.setMessage(dt("请输入线型比例")),!(yield e.go()))return;const s=Number(e.value());s&&n.forEach(a=>re(this,null,function*(){let o=a.getMcDbEntity();o.linetypeScale=s}))})}function VI(){return re(this,null,function*(){const t=A.MxCpp.App.getCurrentMxCAD(),n=new A.MxCADUiPrDist;if(n.setMessage(dt("请输入阵列间距")),!(yield n.go()))return;const i=n.value(),s=new A.MxCADResbuf;s.AddMcDbEntityTypes("ARC");const a=new A.MxCADUiPrEntity;a.setFilter(s),a.setMessage(dt("请选择圆弧"));const o=yield a.go();if(!o.id)return;const r=o.getMcDbEntity(),u=yield A.MxCADUtility.userSelect(dt("选择排列对象"));if(u.length==0)return;const l=new A.MxCADUiPrPoint;l.setMessage(dt("指定排列基点"));const h=yield l.go();h&&u.forEach(f=>re(this,null,function*(){let d=f.getMcDbEntity(),p=r.getLength().val/i;if(!(p<1))for(let b=0;b<p;b++){let v=d.clone(),x=r.getPointAtDist(b*i);if(!x.ret)return;let w=x.val.sub(h),M=new A.McGeMatrix3d;M.setToTranslation(w),v.transformBy(M);let N=r.getFirstDeriv(x.val).val.rotateBy(A.McGeVector3d.kYAxis.angleTo1(A.McGeVector3d.kXAxis)).negate().angleTo2(A.McGeVector3d.kYAxis,A.McGeVector3d.kNegateZAxis);v.rotate(x.val,N),t.drawEntity(v)}}))})}function jI(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LWPOLYLINE");let n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("选择目标多段线:"),t))||n.count()==0)return;const e=new A.MxCADUiPrDist;e.setMessage(dt("请输入圆角半径<5>"));let i=5;(yield e.go())&&(i=e.value());const a=A.MxCpp.getCurrentMxCAD();n.forEach(o=>{const r=o.getMcDbEntity(),u=new A.McDbPolyline;u.trueColor=r.trueColor,u.isClosed=r.isClosed,u.colorIndex=r.colorIndex,u.layerId=r.layerId;const l=r.numVerts(),h=[];for(let f=0;f<l;f++)h.push(r.getPointAt(f).val);r.isClosed===!0&&h.push(h[0],h[1]),h.forEach((f,d)=>{if(d+2>=h.length)return;const p=h[d+1],b=h[d+2],v=new A.McDbLine(p,f),x=new A.McDbLine(p,b),w=f.sub(p).angleTo2(b.sub(p),A.McGeVector3d.kNegateZAxis);let M=i*Math.sin(Math.PI/2-w/2)/Math.sin(w/2);M<0&&(M=-M);const E=v.getPointAtDist(M).val,D=x.getPointAtDist(M).val;v.rotate(E,Math.PI/2),x.rotate(D,Math.PI/2);const N=v.IntersectWith(x,A.McDb.Intersect.kExtendBoth);if(!N.length())return;const V=N.at(0),j=new A.McDbLine(V,p).getPointAtDist(i).val;let Z=A.MxCADUtility.calcBulge(E,j,D).val;if(d===0&&r.isClosed===!1){let rt=r.getWidthsAt(d);u.addVertexAt(f,0,rt.val1,rt.val2)}let tt;r.isClosed===!0&&d+2===h.length-1?tt=r.getWidthsAt(d):tt=r.getWidthsAt(d+1),u.addVertexAt(E,Z,tt.val1,tt.val2),u.addVertexAt(D,0,tt.val1,tt.val2),d+2===h.length-1&&r.isClosed===!1&&u.addVertexAt(b,0,tt.val1,tt.val2)}),r.erase(),a.drawEntity(u)})})}function GI(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LWPOLYLINE");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择线对象")),n.setFilter(t);const e=yield n.go();if(console.log(e),!e.id)return;const i=e.getMcDbEntity(),s=i.numVerts(),a=new A.McDbPolyline;for(let r=s-1;r>=0;r--){const u=i.getPointAt(r).val;if(r>0){const l=i.getWidthsAt(r-1),h=i.getBulgeAt(r-1);a.addVertexAt(u,-h,l.val2,l.val1)}else{const l=i.getWidthsAt(r),h=i.getBulgeAt(r);a.addVertexAt(u,-h,l.val2,l.val2)}}const o=A.MxCpp.getCurrentMxCAD();a.isClosed=i.isClosed,o.drawEntity(a),i.erase()})}function HI(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;t.allSelect(new A.MxCADResbuf([A.DxfCode.kEntityType,"LINE"])),console.log("得到对象数目:"+t.count()),t.forEach(n=>{n.getMcDbEntity().highlight(!0)}),A.MxCpp.getCurrentMxCAD().updateDisplay()})}function WI(){return re(this,null,function*(){const t=new A.MxCADUiPrKeyWord;t.setMessage(dt("选择等分模式")),t.setKeyWords(`[${dt("定距等分")}(ME)/${dt("定数等分")}(DIV)/${dt("偏移等分")}(O)/${dt("复制等分")}(CO)]`);let n=yield t.go();if(!n)return;const e=new A.MxCADResbuf;e.AddMcDbEntityTypes("LINE");const i=new A.MxCADUiPrEntity;i.setFilter(e),n==="O"?i.setMessage(dt("请选择偏移等分对象")):n==="CO"?i.setMessage(dt("请选择复制等分对象")):i.setMessage(dt("请选择需要等分的线段"));const s=yield i.go();if(!s.id)return;const a=s.getMcDbEntity(),o=a.getLength().val,r=A.MxCpp.getCurrentMxCAD();if(n==="ME"){const u=new A.MxCADUiPrDist;if(u.setMessage(dt("请设置等分距离")),!(yield u.go()))return;const h=u.value(),f=o/h;for(let d=1;d<f;d++){const p=a.getPointAtDist(d*h).val,b=new vf;b.setCenter(p),r.drawEntity(b)}}else if(n==="DIV"){const u=new A.MxCADUiPrInt;if(u.setMessage(dt("请设置等分的数量")),!(yield u.go()))return;const h=u.value(),f=o/h;for(let d=1;d<h;d++){const p=a.getPointAtDist(d*f).val,b=new vf;b.setCenter(p),r.drawEntity(b)}}else if(n==="O"){const u=new A.MxCADUiPrDist;if(u.setMessage(dt("请设置偏移距离")),!(yield u.go()))return;const h=u.value();let f=1;for(;;){const d=new A.MxCADUiPrPoint;d.setMessage(dt("请指定偏移点")),d.setUserDraw((b,v)=>{a.offsetCurves(h*f,b).forEach(x=>{v.drawMcDbEntity(x)})});const p=yield d.go();if(!p)return;a.offsetCurves(h*f,p).forEach(b=>{r.drawEntity(b),f++})}}else if(n==="CO"){const u=new A.MxCADUiPrPoint;u.setMessage(dt("请指定复制基点"));const l=yield u.go();if(!l)return;const h=new A.MxCADUiPrInt;if(h.setMessage(dt("请指定复制等分数量")),!(yield h.go()))return;const d=h.value(),p=new A.MxCADUiPrPoint;p.setMessage(dt("请指定复制等分端点")),p.setUserDraw((w,M)=>{const E=new A.McDbLine(l,w);M.drawMcDbEntity(E);const D=E.getLength().val/d;for(let N=1;N<d+1;N++){const V=a.clone();V.move(l,E.getPointAtDist(D*N).val),M.drawMcDbEntity(V)}});const b=yield p.go();if(!b)return;const v=new A.McDbLine(l,b),x=v.getLength().val/d;for(let w=1;w<d+1;w++){const M=a.clone();M.move(l,v.getPointAtDist(x*w).val),r.drawEntity(M)}}})}function qI(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;if(!(yield t.userSelect(dt("请选择需要矩形缩放的实体:")))||t.count()==0)return;let n=A.MxCpp.getCurrentMxCAD(),i=n.getDatabase().getBlockTable().add(new A.McDbBlockTableRecord),s=i.getMcDbBlockTableRecord();if(s==null)return;t.forEach(M=>{const E=M.getMcDbEntity();if(!E)return;const D=E.clone();s.appendAcDbEntity(D)});let a=new A.McDbBlockReference;a.blockTableRecordId=i;const{ret:o,maxPt:r,minPt:u}=a.getBoundingBox();if(!o)return;const l=new A.McDbLine(u,r),h=l.getLength().val;s.origin=l.getPointAtDist(h/2).val;const f=new A.MxCADUiPrPoint;f.setMessage(dt("请指定矩形的角点1"));const d=yield f.go();if(!d)return;const p=new A.MxCADUiPrPoint;p.setMessage(dt("请指定矩形角点2")),p.setUserDraw((M,E)=>{let D=new A.McDbPolyline;D.addVertexAt(d),D.addVertexAt(new A.McGePoint3d(d.x,M.y)),D.addVertexAt(M),D.addVertexAt(new A.McGePoint3d(M.x,d.y)),D.isClosed=!0,E.drawMcDbEntity(D)});const b=yield p.go();if(!b)return;const v=Math.abs(d.x-b.x)/Math.abs(u.x-r.x),x=Math.abs(d.y-b.y)/Math.abs(u.y-r.y);a.scaleFactors=new A.McGePoint3d(v,x,0);const w=new A.McDbLine(d,b);a.position=w.getPointAtDist(w.getLength().val/2).val,n.drawEntity(a)})}class Ig extends A.McDbCustomEntity{constructor(n){super(n),this.center=new A.McGePoint3d,this.radius=20,this.scale=50,this.position=new A.McGePoint3d,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Ig(n)}getTypeName(){return"McDbTestEnlarge"}set enlargeCenter(n){this.center=n}get enlargeCenter(){return this.center}set enlargeRadius(n){this.radius=n}get enlargeRadius(){return this.radius}set enlargeScale(n){this.scale=n}get enlargeScale(){return this.scale}dwgInFields(n){return this.center=n.readPoint("center").val,this.position=n.readPoint("position").val,this.radius=n.readDouble("radius").val,this.scale=n.readDouble("scale").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("center",this.center),n.writePoint("position",this.position),n.writeDouble("radius",this.radius),n.writeDouble("scale",this.scale),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n==0?(this.center.x+=e,this.center.y+=i,this.center.z+=s):n==1&&(this.position.x+=e,this.position.y+=i,this.position.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.center),n.append(this.position),n}worldDraw(n){const e=[],i=new A.McDbCircle;i.center=this.center,i.radius=this.radius,n.drawEntity(i),e.push(i);const{minPt:s,maxPt:a,ret:o}=i.getBoundingBox();if(!o)return;let r=new A.MxCADSelectionSet;r.crossingSelect(s.x,s.y,a.x,a.y);const u=A.MxCpp.getCurrentMxCAD();let l=u.getDatabase().getBlockTable(),h=new A.McDbBlockTableRecord,f=l.add(h),d=f.getMcDbBlockTableRecord();if(d==null)return;r.forEach(K=>{let j=K.getMcDbEntity();if(!j)return;let Z=j.clone();d.appendAcDbEntity(Z)}),d.origin=new A.McGePoint3d(this.center.x,this.center.y,0);let p=new A.McDbBlockReference;p.blockTableRecordId=f,p.position=this.position;const b=u.drawEntity(p);p=b.getMcDbEntity();let v=i.getSamplePoints(this.radius*1e-5),x=new A.McGePoint3dArray;v.forEach((K,j,Z)=>{if(Z===1010){const tt=new A.McGePoint3d(K.x,K.y,K.z);x.append(tt)}}),p.createSpatialFilter(),p.setScale(this.scale),p.getSpatialFilterId().getMcDbObject().setBoundary(x),n.drawEntity(p),e.push(p),b.erase();const E=this.position.sub(this.center).normalize(),D=this.center.clone().addvec(E.mult(this.radius)),N=this.position.clone().subvec(E.mult(this.scale)),V=new A.McDbLine(D,N);n.drawEntity(V),e.push(V),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setPosition(n){this.assertWrite(),this.position=n.clone()}getPosition(){return this.position}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function XI(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请选择放大中心点"));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrDist;if(e.setMessage(dt("请选择放大范围")),e.setBasePt(n),e.setUserDraw((p,b)=>{const v=n.distanceTo(p),x=new A.McDbCircle(n.x,n.y,n.z,v);b.drawMcDbEntity(x)}),!(yield e.go()))return;const s=e.value(),a=A.MxCpp.getCurrentMxCAD(),o=new A.McDbCircle(n.x,n.y,n.z,s),r=new A.MxCADUiPrDist;if(r.setMessage(dt("请设置放大倍数")),r.setBasePt(n),r.setUserDraw((p,b)=>{const v=n.distanceTo(p),x=new A.McDbCircle(n.x,n.y,n.z,v);b.drawMcDbEntity(x),b.drawMcDbEntity(o)}),!(yield r.go()))return;const l=r.value(),h=new A.MxCADUiPrPoint;h.setMessage(dt("请选择放大插入点")),h.setUserDraw((p,b)=>{const v=new A.McDbCircle(p.x,p.y,p.z,l);b.drawMcDbEntity(v),b.drawMcDbEntity(o)});const f=yield h.go();if(!f)return;const d=new Ig;d.enlargeCenter=n,d.enlargeRadius=s,d.enlargeScale=l/s,d.setPosition(f),a.drawEntity(d)})}function YI(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择一条需要打断的曲线"));const n=new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE,LINE,ARC,CIRCLE,ELLIPSE"]);t.setFilter(n);const e=yield t.go();if(!e.id)return;const i=e.getMcDbEntity();i.highlight(!0);const s=new A.MxCADUiPrPoint;s.setMessage(dt("请在曲线上选取打断点"));const a=[],o=Ct.MxFun.screenCoordLong2Doc(5);for(;;){s.setUserDraw((l,h)=>{a.length>0&&a.forEach(f=>{const d=new A.McDbCircle;d.center=f,d.radius=o,h.drawMcDbEntity(d)}),h.drawCircle(new THREE.Vector3(l.x,l.y),o)});const u=yield s.go();if(!u)break;a.push(u)}const r=A.MxCpp.getCurrentMxCAD();a.length!==0&&(i.splitCurves(a).forEach(u=>{r.drawEntity(u)}),i.highlight(!1),e.erase(),r.updateDisplay())})}function KI(){return re(this,null,function*(){const t=new A.MxCADUiPrInt;t.setMessage(`${dt("请输入阵列数量")}<5>`);let n=yield t.go();n||(n=5);const e=new A.MxCADUiPrKeyWord;e.setMessage(`${dt("是否开启旋转")}？<N>`),e.setKeyWords(`[${dt("是")}(Y)/${dt("否")}(N)]`);let i=yield e.go();i||(i="N");const s=new A.MxCADSelectionSet;if(!(yield s.userSelect(dt("请选择需要阵列的图形:")))||s.count()==0)return;let a=null,o=null;s.forEach(d=>{const p=d.getMcDbEntity();if(!p)return;const{minPt:b,maxPt:v,ret:x}=p.getBoundingBox();a||(a=b.clone()),o||(o=v.clone()),console.log(a,o),b.x<a.x&&(a.x=b.x),b.y<a.y&&(a.y=b.y),v.x>o.x&&(o.x=v.x),v.y>o.y&&(o.y=v.y)});const r=new A.McDbLine(a,o),u=r.getPointAtDist(r.getLength().val/2).val,l=new A.MxCADUiPrPoint;l.setMessage(dt("请选择阵列中心点"));let h=[];l.setUserDraw((d,p)=>{h.length=0;const b=d.distanceTo(u),v=new A.McDbCircle(d.x,d.y,d.z,b);p.drawMcDbEntity(v);const x=v.getLength().val,w=v.getDistAtPoint(u).val,M=x/n;for(let E=1;E<n;E++){const D=v.getPointAtDist(E*M+w).val,V=v.getFirstDeriv(D).val.angleTo2(A.McGeVector3d.kXAxis);s.forEach(K=>{const j=K.getMcDbEntity();if(!j)return;const Z=j.clone();i==="Y"&&Z.rotate(u,V),Z.move(u,D),p.drawMcDbEntity(Z),h.push(Z)})}}),(yield l.go())&&h.forEach(d=>{A.MxCpp.getCurrentMxCAD().drawEntity(d)})})}function ZI(t,n,e){if(!Array.isArray(t))throw new Error("第一个参数必须是数组");if(!Array.isArray(n)||n.length!==2)throw new Error("第二个参数必须是一个包含两个元素的数组");function i(s,a){let o=0,r=s.length-1;for(;o<=r;){const u=Math.floor((o+r)/2),l=e.getDistAtPoint(s[u]).val,h=e.getDistAtPoint(a).val;l<h?o=u+1:r=u-1}return o}for(const s of n){const a=i(t,s);t.splice(a,0,s)}return t=th(t),{array:t}}function JI(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage("请选择一条PL线");const n=new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE"]);t.setFilter(n);const e=yield t.go();if(!e.id)return;const i=e.getMcDbEntity();if(!i.isClosed)return Ct.MxFun.acutPrintf(dt("请选择闭合多边形！"));const s=[],a=i.numVerts();for(let x=0;x<a;x++)s.push(i.getPointAt(x).val);const o=new A.MxCADUiPrPoint;o.setMessage(dt("请选择第一个点"));const r=yield o.go();if(!r)return;const u=i.getClosestPointTo(r,!1).val,l=new A.MxCADUiPrPoint;l.setMessage(dt("请选择第二个点")),l.setUserDraw((x,w)=>{w.drawMcDbEntity(new A.McDbLine(r,x))});const h=yield l.go();if(!h)return;const f=i.getClosestPointTo(h,!1).val,d=ZI(s,[u,f],i),p=[];d.array.forEach((x,w)=>{x.distanceTo(u)<1e-4&&p.push(w),x.distanceTo(f)<1e-4&&p.push(w)}),p.sort((x,w)=>x-w);const b=d.array.slice(p[0],p[1]+1),v=d.array.slice(0,p[0]+1).concat(d.array.slice(p[1]));nM([b,v]),e.erase()})}const nM=t=>{t.forEach(n=>{const e=new A.McDbPolyline;n.forEach(i=>e.addVertexAt(i)),e.isClosed=!0,A.MxCpp.getCurrentMxCAD().drawEntity(nL(e))})};function $I(){return re(this,null,function*(){new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE"]);const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择第一个闭合多边形"));const n=yield t.go();if(!n.id)return;const e=n.getMcDbEntity().clone();t.setMessage(dt("请选择第二个闭合多边形"));const i=yield t.go();if(!i.id)return;const s=i.getMcDbEntity().clone();if(!e.isClosed||!s.isClosed)return Ct.MxFun.acutPrintf(dt("请选择两个闭合多边形"));const a=A.MxCpp.getCurrentMxCAD(),o=e.IntersectWith(s,A.McDb.Intersect.kOnBothOperands);if(o.length()<2)return Ct.MxFun.acutPrintf(dt("两个多边形没有重合边！"));const r=[e,s];let u=[],l=[];r.forEach((f,d)=>{const p=[],b=f.numVerts();for(let x=0;x<b;x++){const w=f.getPointAt(x).val;p.push({point:w,dist:f.getDistAtPoint(w).val})}const v=tL(p,f,o);d===0?u.push(...v):l.push(...v)});let h=[];u[0].distanceTo(l[0])<1e-5?h.push(...u,...l.reverse()):h.push(...u,...l),h=th(h),nM([h]),n.erase(),i.erase(),a.updateDisplay()})}function th(t){const n=[];return t.forEach((e,i)=>{t.filter((a,o)=>o>i&&e.distanceTo(a)<1e-5).length||n.push(e)}),n}function QI(t){function n(a){for(let o=1;o<a.length;o++)if(a[o]-a[o-1]!==1)return!1;return!0}const e=[...new Set(t)].sort((a,o)=>a-o);if(n(e))return e.reverse();const i=[];let s=[e[0]];for(let a=1;a<e.length;a++)e[a]-e[a-1]===1?s.push(e[a]):(i.push(s),s=[e[a]]);return s.length&&i.push(s),i.forEach(a=>a.sort((o,r)=>r-o)),i.sort((a,o)=>a[a.length-1]-o[o.length-1]),i.flat()}function tL(t,n,e){let i=[];for(let h=0;h<e.length();h++)i.push(e.at(h));i=th(i);const s=th([...t.map(h=>h.point),...i]);s.sort((h,f)=>n.getDistAtPoint(h).val-n.getDistAtPoint(f).val);let a=[];s.forEach((h,f)=>{i.includes(h)&&a.push(f)});const o=new A.McDbPolyline;a=QI(a);for(let h=0;h<a.length;h++){const f=s[a[h]];o.addVertexAt(f)}const r=t.filter(h=>o.getClosestPointTo(h.point,!1).val.distanceTo(h.point)>1e-5),u=[o.getPointAt(0).val,o.getPointAt(a.length-1).val];return u.forEach(h=>{const f=r.map(v=>v.dist),d=n.getDistAtPoint(h).val;let p=0,b=f.length-1;for(;p<=b;){const v=Math.floor((p+b)/2);f[v]<d?p=v+1:b=v-1}r.splice(p,0,{point:h,dist:d})}),eL(r.map(h=>h.point),u[0],u[1])}function rM(t,n){let e=0,i=1/0;for(let s=0;s<t.length;s++){const a=t[s],o=n.distanceTo(a);o<i&&(i=o,e=s)}return e}function eL(t,n,e){if(!Array.isArray(t)||t.length<2)throw new Error("至少需要两个点");const i=rM(t,n),s=rM(t,e),a=t.length,o=[...t,...t],r=[];let u=i;for(;r.push(o[u]),!(u===s||(u=(u+1)%a,u===i)););return r}function nL(t){const n=t.numVerts(),e=[];for(let l=0;l<n;l++){const h=t.getPointAt(l).val;e.push(h)}const i=[...e];i.push(t.getPointAt(0).val);const s=[];let a=null;i.forEach((l,h)=>{let f=new A.McGeVector3d;if(h<i.length-1?f=i[h+1].sub(l):f=i[1].sub(l),a){const d=a.angleTo2(A.McGeVector3d.kXAxis),p=f.angleTo2(A.McGeVector3d.kXAxis);Math.abs(d-p)<1e-4&&s.push(h)}a=f.clone()});const o=s.findIndex(l=>l===i.length-1);o>0&&(s[o]=0);const r=s.length>0?e.filter((l,h)=>!s.includes(h)):e,u=new A.McDbPolyline;return r.forEach(l=>{u.addVertexAt(l)}),u.isClosed=!0,u}function iM(t,n){const e=[];for(let a=0;a<t.numVerts();a++){const o=t.getDistAtPoint(t.getPointAt(a).val).val;e.push(o)}let i=0,s=e.length-1;for(;i<=s;){const a=Math.floor((i+s)/2);e[a]===n||e[a]<n?i=a+1:s=a-1}return e.splice(i,0,n),{index:i,newArray:e}}function rL(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE"]),e=new A.MxCADUiPrEntity;e.setMessage(dt("请选择目标多边形")),e.setFilter(n);const i=yield e.go();if(!i)return;const s=i.getMcDbEntity(),a=new A.MxCADUiPrPoint;a.setMessage(dt("请选择多边形需要添加顶点的边"));const o=yield a.go();if(!o)return;const r=s.getClosestPointTo(o,!1);if(!r.ret)return;const u=s.getDistAtPoint(r.val).val,{index:l}=iM(s,u),{val2:h}=s.getWidthsAt(l),{val1:f}=s.getWidthsAt(l+1===s.numVerts()?0:l+1),d=new A.MxCADUiPrPoint;d.setMessage(dt("请设置添加的顶点位置")),d.setUserDraw((b,v)=>{const x=s.clone();x.addVertexAt(b,0,h,f,l),v.drawMcDbEntity(x)});const p=yield d.go();p&&(s.addVertexAt(p,0,h,f,l),t.updateDisplay())})}function iL(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE"]),e=new A.MxCADUiPrEntity;e.setMessage(dt("请选择目标多边形")),e.setFilter(n);const i=yield e.go();if(!i)return;const s=i.getMcDbEntity(),a=new A.MxCADUiPrPoint;a.setMessage(dt("请选择多边形需要删除的顶点"));const o=yield a.go();if(!o)return;const r=s.getClosestPointTo(o,!1);if(!r.ret)return;const u=s.numVerts(),l=[];for(let f=0;f<u;f++){const d=r.val.distanceTo(s.getPointAt(f).val);l.push({index:f,dist:d})}l.sort((f,d)=>f.dist-d.dist);const h=l[0].index;s.removeVertexAt(h),t.updateDisplay()})}function oL(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE"]),e=new A.MxCADUiPrEntity;e.setMessage(dt("请选择目标多边形")),e.setFilter(n);const i=yield e.go();if(!i)return;const s=i.getMcDbEntity(),a=new A.MxCADUiPrPoint;a.setMessage(dt("请选择多边形需要拉伸的边"));const o=yield a.go();if(!o)return;const r=s.getClosestPointTo(o,!1);if(!r.ret)return;const u=s.getDistAtPoint(r.val).val;let{index:l}=iM(s,u);l===s.numVerts()&&(l=0);const h=l-1<0?s.numVerts()-1:l-1,f=s.getPointAt(l).val,d=s.getPointAt(h).val,p=f.clone().addvec(d.sub(f).mult(1/2)),b=new A.MxCADUiPrPoint;b.setMessage(dt("请指定拉伸位置")),b.setUserDraw((w,M)=>{const E=s.clone(),D=w.sub(p);E.setPointAt(l,f.clone().addvec(D)),E.setPointAt(h,d.clone().addvec(D)),M.drawMcDbEntity(E)});const x=(yield b.go()).sub(p);s.setPointAt(l,f.clone().addvec(x)),s.setPointAt(h,d.clone().addvec(x)),t.updateDisplay()})}function sL(){new Ig().rxInit(),Ct.MxFun.addCommand("Mx_Multicopy",EI),Ct.MxFun.addCommand("Mx_ArcToCircle",TI),Ct.MxFun.addCommand("Mx_CopyRotation",CI),Ct.MxFun.addCommand("Mx_CricleTotoll",PI),Ct.MxFun.addCommand("Mx_ChangeColor",DI),Ct.MxFun.addCommand("Mx_ArcToAngle",RI),Ct.MxFun.addCommand("Mx_TemHiding",kI),Ct.MxFun.addCommand("Mx_BoxDel",II),Ct.MxFun.addCommand("Mx_AngleCopy",LI),Ct.MxFun.addCommand("Mx_VertexRep",BI),Ct.MxFun.addCommand("Mx_IntersectBreak",FI),Ct.MxFun.addCommand("Mx_DoubleOff",NI),Ct.MxFun.addCommand("Mx_Telescoping",OI),Ct.MxFun.addCommand("Mx_EitCircle",zI),Ct.MxFun.addCommand("Mx_LayerTypeScale",UI),Ct.MxFun.addCommand("Mx_ArcOrder",VI),Ct.MxFun.addCommand("Mx_PlRoundCorners",jI),Ct.MxFun.addCommand("Mx_PlReverse",GI),Ct.MxFun.addCommand("Mx_TestGetAllLineByLayer",HI),Ct.MxFun.addCommand("Mx_Bisection",WI),Ct.MxFun.addCommand("Mx_RectangularScaling",qI),Ct.MxFun.addCommand("Mx_Enlarge",XI),Ct.MxFun.addCommand("Mx_Interrupt",YI),Ct.MxFun.addCommand("Mx_PolarArray",KI),Ct.MxFun.addCommand("Mx_PolygonClipping",JI),Ct.MxFun.addCommand("Mx_MergePolygons",$I),MxPluginContext.addCommand("Mx_AddVertex",rL),MxPluginContext.addCommand("Mx_DeleteVertex",iL),MxPluginContext.addCommand("Mx_StretchPolygon",oL)}function aL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LINE");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择目标对齐线对象(选择直线)")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new A.MxCADUiPrEntity;let a=new A.MxCADResbuf;a.AddMcDbEntityTypes("TEXT"),s.setMessage(dt("请选择目标文字对象")),s.setFilter(a);const o=yield s.go();if(!o.id)return;const r=o.getMcDbEntity();let l=i.getFirstDeriv(i.getStartPoint().val).val.angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis),h=r.rotation;r.rotate(r.position,l-h),A.MxCpp.App.getCurrentMxCAD().updateDisplay()})}function lL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT, MTEXT");const n=yield A.MxCADUtility.userSelect(dt("选择文字对象"),t);if(n.length==0)return;const e=new A.MxCADUiPrString;e.setMessage(dt("请设置字高"));const i=yield e.go();!i||!Number(i)||(n.forEach(s=>{const a=s.getMcDbEntity();a.height=Number(i)}),A.MxCpp.getCurrentMxCAD().updateDisplay())})}function cL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT, MTEXT");const n=yield A.MxCADUtility.userSelect(dt("选择文字对象"),t);if(n.length==0)return;const e=new A.MxCADUiPrString;e.setMessage(dt("请设置字宽"));const i=yield e.go();!i||!Number(i)||(n.forEach(s=>{const a=s.getMcDbEntity();a.widthFactor=Number(i)}),A.MxCpp.getCurrentMxCAD().updateDisplay())})}function uL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择源文字")),n.setFilter(t);const e=yield n.go();if(!(e!=null&&e.id))return;const i=e.getMcDbEntity();let s=yield A.MxCADUtility.userSelect(dt("请选择目标文字"),t);if(s.length==0)return;const a=A.MxCpp.App.getCurrentMxCAD();s.forEach(o=>{let r=o.getMcDbEntity();r.textString=i.textString}),a.updateDisplay()})}function hL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("请选择第一个文字"));const e=yield n.go();if(!(e!=null&&e.id))return;const i=e.getMcDbEntity(),s=A.MxCpp.App.getCurrentMxCAD(),a=new A.MxCADUiPrEntity;a.setFilter(t),a.setMessage(dt("请选择第二个文字"));const o=yield a.go();if(!(o!=null&&o.id))return;const r=o.getMcDbEntity();let u=i.textString,l=r.textString,h=i.clone(),f=r.clone();h.textString=l,f.textString=u,s.drawEntity(h),s.drawEntity(f),e.erase(),o.erase()})}function dL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择需要对齐的文字"),t);if(n.length==0)return;const e=new A.MxCADUiPrKeyWord;e.setMessage(dt("请选择对齐方式")),e.setKeyWords(`[${dt("左")}(L)/${dt("中")}(M)/${dt("右")}(R)]`);const i=yield e.go();if(!i)return;const s=new A.MxCADUiPrPoint;s.setMessage(dt("请选择对齐基点"));const a=yield s.go();if(!a)return;const o=A.MxCpp.getCurrentMxCAD();i==="L"?n.forEach(r=>{const u=r.getMcDbEntity(),l=u.clone(),h=u.alignmentPoint,f=u.position;l.horizontalMode=A.McDb.TextHorzMode.kTextLeft,l.alignmentPoint=new A.McGePoint3d(a.x,h.y),l.position=new A.McGePoint3d(a.x,f.y),o.drawEntity(l),r.erase()}):i==="R"?n.forEach(r=>{const u=r.getMcDbEntity(),l=u.clone(),h=u.alignmentPoint,f=u.position;l.horizontalMode=A.McDb.TextHorzMode.kTextRight,l.alignmentPoint=new A.McGePoint3d(a.x,h.y),l.position=new A.McGePoint3d(a.x,f.y),o.drawEntity(l),r.erase()}):i==="M"&&n.forEach(r=>{const u=r.getMcDbEntity(),l=u.clone(),h=u.alignmentPoint,f=u.position;l.horizontalMode=A.McDb.TextHorzMode.kTextCenter,l.alignmentPoint=new A.McGePoint3d(a.x,h.y),l.position=new A.McGePoint3d(a.x,f.y),o.drawEntity(l),r.erase()})})}function fL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择需要对齐的文字"),t);if(n.length==0)return;const e=new A.MxCADUiPrPoint;e.setMessage(dt("请选择对齐基点"));const i=yield e.go();i&&(n.forEach(s=>{const a=s.getMcDbEntity(),o=a.position;a.alignmentPoint=a.position=new A.McGePoint3d(o.x,i.y)}),A.MxCpp.getCurrentMxCAD().updateDisplay())})}function pL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择需要反转的文字"),t);if(n.length==0)return;const e=A.MxCpp.App.getCurrentMxCAD();n.forEach(i=>{const s=i.getMcDbEntity(),a=s.clone();let o=s.getBoundingBox();if(!o.ret)return;const r=o.maxPt,u=o.minPt,l=new A.McDbLine(u,r),h=l.getPointAtDist(l.getLength().val/2).val,f=A.McGeVector3d.kXAxis.angleTo1(new A.McGeVector3d(-1,0,0))+s.rotation;a.rotate(h,f),i.erase(),e.drawEntity(a)})})}function mL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT, MTEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择需要去空格的文字"),t);n.length!=0&&n.forEach(e=>{const i=e.getMcDbEntity();let s;i instanceof A.McDbText?(s=i.clone(),s.textString=i.textString.replace(/\s+/g,"")):i instanceof A.McDbMText&&(s=i.clone(),s.contents=i.contents.replace(/\s+/g,"")),e.erase(),A.MxCpp.App.getCurrentMxCAD().drawEntity(s)})})}function gL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT, MTEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择文字对象"),t);n.length!=0&&n.forEach(e=>{let s=e.getMcDbEntity().getBoundingBox();if(!s.ret)return;const a=s.maxPt,o=s.minPt,r=new A.McGePoint3d(o.x,a.y),u=new A.McGePoint3d(a.x,o.y),l=o.clone().sub(a).normalize().mult(2),h=r.clone().sub(u).normalize().mult(2),f=new A.McDbPolyline;f.addVertexAt(o.addvec(l)),f.addVertexAt(r.addvec(h)),f.addVertexAt(a.subvec(l)),f.addVertexAt(u.subvec(h)),f.isClosed=!0,A.MxCpp.getCurrentMxCAD().drawEntity(f)})})}function yL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择文字对象"),t);if(n.length==0)return;const e=new A.MxCADUiPrInt;e.setMessage(dt("请输入下划线宽度 "));const i=(yield e.go())||0,s=new A.MxCADUiPrDist;s.setMessage(dt("请设置下划线距离 "));const a=yield s.go();let o=0;a&&(o=s.value());const r=new A.MxCADUiPrDist;r.setMessage(dt("请设置下划线延长距离 "));const u=yield r.go();let l=0;u&&(l=r.value()),n.forEach(h=>{let d=h.getMcDbEntity().getBoundingBox();if(!d.ret)return;const p=d.maxPt,b=d.minPt,v=new A.McDbLine(b.x,b.y,0,p.x,b.y,0),x=new A.McDbLine(p.x,b.y,0,b.x,b.y,0),w=x.getLength().val,M=v.getPointAtDist(w+l).val,E=x.getPointAtDist(w+l).val,D=new A.McDbPolyline;D.addVertexAt(M,0,i,i),D.addVertexAt(E,0,i,i);const N=D.getClosestPointTo(p,!0).val,V=N.clone().sub(p);V.normalize().mult(o);const K=N.clone().addvec(V),j=new A.McGeMatrix3d;j.setToTranslation(K.sub(N)),D.transformBy(j),A.MxCpp.getCurrentMxCAD().drawEntity(D)})})}function bL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择文字对象"),t);n.length!=0&&n.forEach(e=>{let s=e.getMcDbEntity().getBoundingBox();if(!s.ret)return;const a=s.maxPt,o=s.minPt,r=new A.McDbPolyline;r.addVertexAt(o,0,2,2),r.addVertexAt(new A.McGePoint3d(a.x,o.y),0,2,2);const u=new A.McDbPolyline;u.addVertexAt(o),u.addVertexAt(new A.McGePoint3d(a.x,o.y));const l=r.getClosestPointTo(a,!0).val,h=l.clone().sub(a),f=l.clone().sub(a);h.normalize().mult(2),f.normalize().mult(4);const d=l.clone().addvec(h),p=l.clone().addvec(f),b=new A.McGeMatrix3d,v=new A.McGeMatrix3d;b.setToTranslation(d.sub(l)),r.transformBy(b),v.setToTranslation(p.sub(l)),u.transformBy(v),A.MxCpp.getCurrentMxCAD().drawEntity(r),A.MxCpp.getCurrentMxCAD().drawEntity(u)})})}function vL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择文字对象"),t);if(n.length==0)return;const e=new A.MxCADUiPrKeyWord;e.setMessage(dt("请选择操作选项 ")),e.setKeyWords(`[${dt("大写")}(C)/${dt("小写")}(S)/${dt("句首大写")}(I)]`);const i=yield e.go();if(!i)return;const s=A.MxCpp.getCurrentMxCAD();i==="C"?n.forEach(a=>{const o=a.getMcDbEntity(),r=o.textString,u=o.clone();u.textString=r.toUpperCase(),console.log(u.textString),o.erase(),s.drawEntity(u)}):i==="S"?n.forEach(a=>{const o=a.getMcDbEntity(),r=o.textString,u=o.clone();u.textString=r.toLowerCase(),console.log(u.textString),o.erase(),s.drawEntity(u)}):i==="I"&&n.forEach(a=>{const o=a.getMcDbEntity(),r=o.textString,u=o.clone();u.textString=r.charAt(0).toUpperCase()+r.slice(1),o.erase(),s.drawEntity(u)})})}function xL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=yield A.MxCADUtility.userSelect(dt("请选择数字对象"),t);if(n.length==0)return;let e=[];if(n.forEach(u=>{const l=u.getMcDbEntity(),h=Number(l.textString);isNaN(h)||e.push(h)}),e.length!==n.length)return;let i=e.reduce((u,l)=>u+l,0);const s=new A.MxCADUiPrPoint,a=new A.McDbText;a.textString=i.toString(),a.height=10,s.setMessage(dt("请选择文字插入点 ")),s.setUserDraw((u,l)=>{a.position=u,a.alignmentPoint=u,l.drawMcDbEntity(a)});const o=yield s.go();if(!o)return;const r=A.MxCpp.getCurrentMxCAD();a.position=o,a.alignmentPoint=o,r.drawEntity(a)})}function _L(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("选择要查找的范围:"),t))||n.count()==0)return;const e=new A.MxCADUiPrKeyWord;e.setMessage(dt("请选择查找模式 ")),e.setKeyWords(`[${dt("等于")}(A)/${dt("包含")}(B)/${dt("前缀为")}(C)/${dt("后缀为")}(D)]`);const i=yield e.go();if(!i)return;const s=new A.MxCADUiPrString;s.setMessage(dt("请输入关键字 "));const a=yield s.go();if(!a)return;const o=A.MxCpp.getCurrentMxCAD();let r=[];n.forEach(u=>{const h=u.getMcDbEntity().textString;i==="A"?h===a&&r.push(u):i==="B"?h.includes(a)&&r.push(u):i==="C"?h.startsWith(a)&&r.push(u):i==="D"&&h.endsWith(a)&&r.push(u)}),r.length>0&&r.forEach(u=>{o.addCurrentSelect(u)})})}function wL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");let n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("选择要操作的范围:"),t))||n.count()==0)return;const e=new A.MxCADUiPrKeyWord;e.setMessage(dt("选择操作方式")),e.setKeyWords(`[${dt("添加")}(A)/${dt("删除")}(D)]`);let i=yield e.go();if(!i)return;const s=new A.MxCADUiPrKeyWord;s.setMessage(dt("选择操作位置")),s.setKeyWords(`[${dt("前缀")}(P)/${dt("后缀")}(S)]`);let a=yield s.go();if(!a)return;const o=new A.MxCADUiPrString;o.setMessage(dt("请输入内容"));const r=yield o.go();r&&n.forEach(u=>{const l=u.getMcDbEntity(),h=l.textString;i==="A"?a==="P"?l.textString=r+h:a==="S"&&(l.textString=h+r):i==="D"&&(a==="P"?h.startsWith(r)&&(l.textString=h.slice(r.length)):a==="S"&&h.endsWith(r)&&(l.textString=h.slice(0,-r.length)))})})}function ML(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");const n=A.MxCpp.getCurrentMxCAD();for(;;){const a=new A.MxCADUiPrPoint;a.setMessage(dt("请选择文本 "));const o=yield a.go();if(!o)break;let r=A.MxCADUtility.findEntAtPoint(o.x,o.y,o.z,-1,t);n.addCurrentSelect(r)}const e=A.MxCADUtility.getCurrentSelect();if(!e.length)return;let i="";e.forEach((a,o)=>{const r=a.getMcDbEntity();i+=r.textString,o!==0&&a.erase()});const s=e.at(0).getMcDbEntity();s.textString=i,n.mxdraw.clearMxCurrentSelect()})}function AL(){return re(this,null,function*(){new A.MxCADResbuf().AddMcDbEntityTypes("TEXT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择文本 "));const e=yield n.go();if(!e)return;const i=e.getMcDbEntity(),s=i.textString.split("").join("\\P"),a=new A.McDbMText;a.contents=s,a.textHeight=i.height,a.location=i.position,a.trueColor=i.trueColor,a.colorIndex=i.colorIndex,a.layerId=i.layerId;const o=A.MxCpp.getCurrentMxCAD();e.erase(),o.drawEntity(a)})}function SL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("TEXT");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("请选择文本 "));const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity();i.highlight(!0);const s=new A.MxCADResbuf;s.AddMcDbEntityTypes("ARC");const a=new A.MxCADUiPrEntity;a.setFilter(s),a.setMessage(dt("请选择圆弧 "));const o=yield a.go();if(!o.id)return;const r=o.getMcDbEntity();r.highlight(!0);const u=i.textString.split("");u.reverse();const l=r.getLength().val/(u.length-1),h=A.MxCpp.getCurrentMxCAD();for(let f=0;f<u.length;f++){const d=r.getPointAtDist(l*f).val,p=new A.McDbText;p.textString=u[f],p.position=p.alignmentPoint=d,p.horizontalMode=A.McDb.TextHorzMode.kTextMid,p.trueColor=i.trueColor,p.colorIndex=i.colorIndex,p.height=i.height,p.widthFactor=i.widthFactor,p.rotation=i.rotation,h.drawEntity(p)}i.highlight(!1),r.highlight(!1)})}function EL(){return re(this,null,function*(){const e=A.MxCpp.getCurrentMxCAD().getDatabase().getTextStyleTable().getAllRecordId();let i="",s=[];e.forEach((u,l)=>{const h=u.getMcDbTextStyleTableRecord();i+=`${h.name}(${l})/`,s.push(u)});const a=new A.MxCADUiPrKeyWord;a.setMessage(dt("请选择文字样式")),a.setKeyWords(`[${i}]`);const o=yield a.go(),r=new A.MxCADSelectionSet;r.allSelect(new A.MxCADResbuf([A.DxfCode.kEntityType,"TEXT, MTEXT"])),r.forEach(u=>{let l=u.getMcDbEntity();l.textStyleId=s[Number(o)]}),A.MxCpp.getCurrentMxCAD().updateDisplay()})}function TL(){return re(this,null,function*(){const t=new A.MxCADResbuf([A.DxfCode.kEntityType,"MTEXT,TEXT"]),n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("请设置文字提取范围"),t))||n.count()==0)return;let e="";n.forEach(a=>{const o=a.getMcDbEntity(),r=o.objectName;if(r==="McDbText"){const u=o.clone();e+=`${u.textString} `}else if(r==="McDbMText"){const u=o.clone();e+=u.contents.replace("\\P"," ")}});const{isDialogVisible:i,excelText:s}=Up();i.value=!0,s.value=e})}function CL(){return re(this,null,function*(){fs.value="NumberTextDialog",Ho.showDialog(!0,{title:dt("输入编号文字")}).then(e=>re(this,[e],function*({data:t,isCanceled:n}){if(!n){let{textContent:i,textNumber:s,numPos:a}=t;const o=new A.McDbText;for(o.height=Ct.MxFun.docCoordLong2Screen(20);;){let r="";a==="start"&&(r=`${s||""}${i||""}`),a==="end"&&(r=`${i||""}${s||""}`),o.textString=r;const u=new A.MxCADUiPrPoint;u.setMessage("点击左键指定文本标注的位置，右键退出"),u.setDisableOsnap(!0),u.disableAllTrace(!0),u.setDisableDynInput(!0),u.setUserDraw((h,f)=>{o.position=o.alignmentPoint=h,f.drawMcDbEntity(o)});const l=yield u.go();if(!l)break;o.position=o.alignmentPoint=l,A.MxCpp.getCurrentMxCAD().drawEntity(o),s+=1}}}))})}function PL(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择一个单行文本"));const n=new A.MxCADResbuf([A.DxfCode.kEntityType,"TEXT"]);t.setFilter(n);const e=yield t.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new A.McDbMText;switch(s.textStyleId=i.textStyleId,s.trueColor=i.trueColor,s.location=i.position,s.contents=i.textString,s.textHeight=i.height,s.colorIndex=i.colorIndex,i.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:s.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:s.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:s.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:s.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:s.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const a=A.MxCpp.getCurrentMxCAD();a.drawEntity(s),i.erase(),a.updateDisplay()})}function DL(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择一个多行文本"));const n=new A.MxCADResbuf([A.DxfCode.kEntityType,"MTEXT"]);t.setFilter(n);const e=yield t.go();if(!e.id)return;new A.McGeLongArray().copyFormAryId([e]),A.MxCpp.App.MxCADAssist.MxExplode(e)})}function RL(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择一个多行文本"));const n=new A.MxCADResbuf([A.DxfCode.kEntityType,"MTEXT"]);t.setFilter(n);const e=yield t.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new A.McDbText;s.textString=i.getTextString(),s.textStyleId=i.textStyleId,s.trueColor=i.trueColor,s.height=i.textHeight,s.colorIndex=i.colorIndex;const a=new A.MxCADUiPrPoint;a.setMessage(dt("请设置文字插入点")),a.setUserDraw((r,u)=>{s.position=s.alignmentPoint=r,u.drawMcDbEntity(s)});const o=yield a.go();s.position=s.alignmentPoint=o,A.MxCpp.getCurrentMxCAD().drawEntity(s)})}function kL(){return re(this,null,function*(){const t=new A.MxCADSelectionSet,n=new A.MxCADResbuf([A.DxfCode.kEntityType,"TEXT"]);if(yield t.userSelect(dt("请选择单行文本"),n),!t.count())return;const e=[];t.forEach(r=>{const u=r.getMcDbEntity();e.push(u)});const i=new A.McDbMText;i.textStyleId=e[0].textStyleId,i.trueColor=e[0].trueColor,i.location=e[0].position,i.contents=e[0].textString,i.textHeight=e[0].height,i.colorIndex=e[0].colorIndex;let s="";e.sort((r,u)=>u.position.y-r.position.y).forEach(r=>{s+=`${r.textString}\\P`}),i.contents=s;const a=new A.MxCADUiPrPoint;a.setMessage(dt("请设置文字插入点")),a.setUserDraw((r,u)=>{i.location=r,u.drawMcDbEntity(i)});const o=yield a.go();i.location=o,A.MxCpp.getCurrentMxCAD().drawEntity(i)})}function IL(){Ct.MxFun.addCommand("Mx_AlignByLine",aL),Ct.MxFun.addCommand("Mx_TextHeight",lL),Ct.MxFun.addCommand("Mx_TextWidth",cL),Ct.MxFun.addCommand("Mx_BrushCon",uL),Ct.MxFun.addCommand("Mx_ReplaceCon",hL),Ct.MxFun.addCommand("Mx_AlignLeft",dL),Ct.MxFun.addCommand("Mx_AlignUp",fL),Ct.MxFun.addCommand("Mx_TextReversal",pL),Ct.MxFun.addCommand("Mx_TextTrim",mL),Ct.MxFun.addCommand("Mx_TextTraming",gL),Ct.MxFun.addCommand("Mx_Underline",yL),Ct.MxFun.addCommand("Mx_TitleLine",bL),Ct.MxFun.addCommand("Mx_Case",vL),Ct.MxFun.addCommand("Mx_NumSum",xL),Ct.MxFun.addCommand("Mx_SSWords",_L),Ct.MxFun.addCommand("Mx_Prefix",wL),Ct.MxFun.addCommand("Mx_ConnectText",ML),Ct.MxFun.addCommand("Mx_VerticalText",AL),Ct.MxFun.addCommand("Mx_AlignByArc",SL),Ct.MxFun.addCommand("Mx_EditTextStyle",EL),Ct.MxFun.addCommand("Mx_ExtractText",TL),Ct.MxFun.addCommand("Mx_NumberText",CL),Ct.MxFun.addCommand("Mx_TextToMText",PL),Ct.MxFun.addCommand("Mx_MultipleToMText",kL),Ct.MxFun.addCommand("Mx_MTextToMultiple",DL),Ct.MxFun.addCommand("Mx_MTextToSingle",RL)}function LL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择目标块对象")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=new A.MxCADUiPrString;i.setMessage(dt("请输入新块名"));const s=yield i.go();if(!s)return;const a=e.getMcDbEntity().blockTableRecordId.getMcDbBlockTableRecord();console.log("原块名",a.name),a.name=s,console.log("新块名",a.name)})}function BL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("选择需要修改基点的块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new A.MxCADUiPrPoint,a=A.MxCpp.getCurrentMxCAD();s.setMessage(dt("设置基点"));const o=yield s.go();if(!o)return;let r=i.blockTableRecordId.getMcDbBlockTableRecord(),u=r.origin.clone(),l=i.blockTransform;u.transformBy(l);const h=o.sub(u);l.invert(),o.transformBy(l),r.origin=o,i.position=i.position.addvec(h),a.updateDisplay()})}function oM(t){t.getAllEntityId().forEach(n=>{let e=n.getMcDbEntity();e.colorIndex=A.ColorIndexType.kByblock,e instanceof A.McDbBlockReference&&oM(e.blockTableRecordId.getMcDbBlockTableRecord())})}function FL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("选择需要修改颜色的块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity();let s=i.blockTableRecordId.getMcDbBlockTableRecord();oM(s);const a=new A.MxCADUiPrInt;a.setMessage(dt("输入颜色索引(0~256)"));let o=(yield a.go())||0,r=new A.McCmColor;r.setColorIndex(o),i.trueColor=r,A.MxCpp.getCurrentMxCAD().updateDisplay()})}function NL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择源块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity();let s=new A.MxCADSelectionSet;(yield s.userSelect(dt("选择要刷的目标块:"),t))&&s.count()!=0&&s.forEach(a=>{const o=a.getMcDbEntity(),r=i.clone();r.position=o.position,a.erase(),A.MxCpp.getCurrentMxCAD().drawEntity(r)})})}function OL(){return re(this,null,function*(){const t=new A.MxCADUiPrKeyWord;t.setMessage(dt("选择连接方式")),t.setKeyWords(`[${dt("手动逐个连线")}(H)/${dt("自动批量连线")}(A)]`);const n=yield t.go();if(!n)return;const e=A.MxCpp.getCurrentMxCAD();let i=new A.MxCADResbuf;if(i.AddMcDbEntityTypes("INSERT"),n==="A"){let s=new A.MxCADSelectionSet;if(!(yield s.userSelect(dt("选择要刷的目标块:"),i))||s.count()==0)return;const a=new A.McDbPolyline;s.forEach(o=>{const r=o.getMcDbEntity();a.addVertexAt(r.position)}),e.drawEntity(a)}else if(n==="H"){const s=new A.McDbPolyline;for(;;){const a=new A.MxCADUiPrEntity;a.setMessage(dt("请选择连线的块")),a.setFilter(i),a.setUserDraw((u,l)=>{const h=s.clone();h.addVertexAt(u),l.drawMcDbEntity(h)});const o=yield a.go();if(!o.id)break;const r=o.getMcDbEntity();s.addVertexAt(r.position)}e.drawEntity(s)}})}function zL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择连线的块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;let s=e.getMcDbEntity().getBoundingBox();const a=new A.McDbPolyline;a.addVertexAt(s.minPt),a.addVertexAt(s.maxPt);const o=a.getPointAtDist(a.getLength().val/2).val,r=new A.MxCADUiPrDist;r.setMessage(dt("设置中心线长度")),r.setBasePt(o),r.setUserDraw((p,b)=>{const v=p.distanceTo(o);let x=new A.McDbLine(o.x+v,o.y,o.z,o.x-v,o.y,o.z),w=x.clone();w.rotate(o,Math.PI/2),b.drawMcDbEntity(w),b.drawMcDbEntity(x)});const u=yield r.go();let l=10;u&&(l=r.value());const h=A.MxCpp.App.getCurrentMxCAD();let f=new A.McDbLine(o.x+l,o.y,o.z,o.x-l,o.y,o.z);f.trueColor=new A.McCmColor(255,0,0);let d=f.clone();d.rotate(o,Math.PI/2),h.drawEntity(d),h.drawEntity(f)})}function UL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");let n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("选择要旋转的目标块:"),t))||n.count()==0)return;const e=n.item(0).getMcDbEntity(),i=new A.MxCADUiPrDist;i.setMessage(dt("设置旋转角度")),i.setBasePt(e.position);let s=0;i.setUserDraw((r,u)=>{s=r.sub(e.position).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis),n.forEach(l=>{const f=l.getMcDbEntity().clone();f.rotate(f.position,s),u.drawMcDbEntity(f)})});const a=yield i.go();if(!a)return;i.getDetailedResult()===Ct.DetailedResult.kCoordIn&&(s=a*Math.PI/180),n.forEach(r=>{const u=r.getMcDbEntity();u.rotate(u.position,s)}),A.MxCpp.getCurrentMxCAD().updateDisplay()})}function VL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");let n=new A.MxCADSelectionSet;if(!(yield n.userSelect("选择要旋转的目标块:",t))||n.count()==0)return;const e=new A.MxCADUiPrDist;e.setMessage(dt("请设置缩放比例"));let i=n.item(0).getMcDbEntity();if(e.setBasePt(i.position),e.setUserDraw((r,u)=>{const l=r.distanceTo(i.position);n.forEach(h=>{const d=h.getMcDbEntity().clone();let p=new A.McGeMatrix3d;p.setToScaling(l,d.position),d.transformBy(p),u.drawMcDbEntity(d)})}),!(yield e.go()))return;const a=e.value()||1;n.forEach(r=>{const u=r.getMcDbEntity();let l=new A.McGeMatrix3d;l.setToScaling(a,u.position),u.transformBy(l)}),A.MxCpp.getCurrentMxCAD().updateDisplay()})}function jL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择源块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const s=e.getMcDbEntity().rotation;let a=new A.MxCADSelectionSet;if(!(yield a.userSelect("选择要刷的目标块:",t))||a.count()==0)return;a.forEach(r=>{const u=r.getMcDbEntity();u.rotation=s}),A.MxCpp.getCurrentMxCAD().updateDisplay()})}function GL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择源块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const s=e.getMcDbEntity().blockName;let a=new A.MxCADSelectionSet;(yield a.userSelect(dt("请设置选择范围:"),t))&&a.count()!=0&&a.forEach(o=>{o.getMcDbEntity().blockName==s&&A.MxCpp.getCurrentMxCAD().addCurrentSelect(o)})})}function HL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择目标块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const s=e.getMcDbEntity().blockName;let a=new A.MxCADSelectionSet;a.allSelect(t),a.count()!=0&&a.forEach(o=>{o.getMcDbEntity().blockName==s&&A.MxCpp.getCurrentMxCAD().addCurrentSelect(o)})})}function WL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择目标块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const s=e.getMcDbEntity().blockName,a=new A.MxCADSelectionSet;if(!(yield a.userSelect(dt("请设置统计范围"),t))||a.count()==0)return;let o=0;a.forEach(r=>{r.getMcDbEntity().blockName==s&&(o+=1)}),console.log(`找到块${s}：共${o}个`)})}function qL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADSelectionSet;if(!(yield n.userSelect(dt("请设置统计范围"),t))||n.count()==0)return;let e=[];n.forEach(u=>{const h=u.getMcDbEntity().blockName;e.push(h)});let i=[];Array.from(new Set(e)).forEach(u=>{const l=e.filter(h=>h===u).length;i.push({blkName:u,num:l})});let s=new Hw;s.data.addColumn("名称",100),s.data.addColumn("数量",30),i.forEach(u=>{s.data.addRow([u.blkName,u.num])});let a=new A.MxCADUiPrPoint;a.setMessage(dt("指定表格插入点:"));let o=yield a.go();if(!o)return;let r=Ct.MxFun.screenCoordLong2Doc(100)/200;s.draw(o,r)})}function XL(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择目标块")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity(),s=A.MxCpp.getCurrentMxCAD(),a=s.addLayer("测试图层");i.layerId=a,console.log(i.layer),s.updateDisplay()})}function YL(){Ct.MxFun.addCommand("Mx_ChangeBN",LL),Ct.MxFun.addCommand("Mx_BushBlk",NL),Ct.MxFun.addCommand("Mx_ConBlk",OL),Ct.MxFun.addCommand("Mx_BlkCenterLine",zL),Ct.MxFun.addCommand("Mx_BlkPt",BL),Ct.MxFun.addCommand("Mx_BlkColor",FL),Ct.MxFun.addCommand("Mx_BlkRotate",UL),Ct.MxFun.addCommand("Mx_BlkScale",VL),Ct.MxFun.addCommand("Mx_BlkAngle",jL),Ct.MxFun.addCommand("Mx_BlkSelect",GL),Ct.MxFun.addCommand("Mx_BlkAllSelect",HL),Ct.MxFun.addCommand("Mx_SSBlk",WL),Ct.MxFun.addCommand("Mx_SMBlk",qL),Ct.MxFun.addCommand("Mx_BlkLayer",XL)}function KL(){return re(this,null,function*(){const t=A.MxCpp.App.getCurrentMxCAD(),n=new A.McDbText;n.height=10;let e=new A.McGePoint3d,i=new A.MxCADResbuf;i.AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE,ELLIPSE");let s=yield A.MxCADUtility.userSelect(dt("选择目标曲线"),i);if(s.length==0)return;let a=0;s.forEach(r=>re(this,null,function*(){let u=r.getMcDbEntity();a+=u.getLength().val})),n.textString=a.toFixed(2).toString();const o=new A.MxCADUiPrPoint;o.setMessage(dt("指定长度标注点")),o.setUserDraw((r,u)=>{n.position=r,n.alignmentPoint=r,u.drawMcDbEntity(n)}),e=yield o.go(),e&&(n.alignmentPoint=e,n.position=e,t.drawEntity(n))})}function ZL(){return re(this,null,function*(){const t=A.MxCpp.App.getCurrentMxCAD(),n=new A.McDbText;n.height=10;let e=new A.McGePoint3d,i=new A.MxCADResbuf;i.AddMcDbEntityTypes("CIRCLE,LWPOLYLINE,ELLIPSE");let s=yield A.MxCADUtility.userSelect(dt("选择目标对象"),i);if(s.length==0)return;let a=0;s.forEach(r=>re(this,null,function*(){let u=r.getMcDbEntity();a+=u.getArea().val})),n.textString=a.toFixed(2).toString();const o=new A.MxCADUiPrPoint;o.setMessage(dt("指定长度标注点")),o.setUserDraw((r,u)=>{n.position=r,n.alignmentPoint=r,u.drawMcDbEntity(n)}),e=yield o.go(),e&&(n.alignmentPoint=e,n.position=e,t.drawEntity(n))})}function JL(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LINE");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("请选择目标斜率对象"));const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new A.MxCADUiPrDist;if(s.setMessage(dt("请设置标注文字高度")),!(yield s.go()))return;const o=s.value(),r=new A.MxCADUiPrPoint;r.setMessage(dt("指定斜率标注点"));let u=new A.McDbBlockReference;const l=A.MxCpp.getCurrentMxCAD();r.setUserDraw((f,d)=>{const p=i.getClosestPointTo(f,!0).val,b=new A.McGePoint3d(p.x,p.y+o*4),v=new A.McDbLine(p,b),x=v.clone();x.rotate(b,Math.PI*1/2);const w=i.IntersectWith(x,A.McDb.Intersect.kExtendBoth).at(0),M=i.getClosestPointTo(p,!1).val,E=new A.McDbPolyline;E.isClosed=!0,E.addVertexAt(M),E.addVertexAt(p),E.addVertexAt(b),E.addVertexAt(w);const D=new A.McDbText;D.height=o,D.position=v.getPointAtDist(v.getLength().val/2).val,D.alignmentPoint=D.position,D.rotation=-Math.PI/2,D.horizontalMode=A.McDb.TextHorzMode.kTextMid,D.textString="1000";const N=new A.McDbText,V=new A.McDbLine(w,b);N.height=o,N.position=V.getPointAtDist(w.distanceTo(b)/2).val,N.alignmentPoint=N.position,N.horizontalMode=A.McDb.TextHorzMode.kTextMid,N.textString=(1e3*w.distanceTo(b)/v.getLength().val).toFixed(0).toString();let j=l.getDatabase().getBlockTable().add(new A.McDbBlockTableRecord),Z=j.getMcDbBlockTableRecord();Z!=null&&(Z.appendAcDbEntity(E),Z.appendAcDbEntity(D),Z.appendAcDbEntity(N),Z.name="斜率test",Z.origin=p,u.blockTableRecordId=j,u.position=p,d.drawMcDbEntity(u))}),(yield r.go())&&l.drawEntity(u)})}class Lg extends A.McDbCustomEntity{constructor(n){super(n),this.point=new A.McGePoint3d,this.position=new A.McGePoint3d,this.height=30}create(n){return new Lg(n)}getTypeName(){return"McDbTestCoordinateLabeling"}set coordinatePoint(n){this.point=n.clone()}get coordinatePoint(){return this.point}set coordinateHeight(n){this.height=n}get coordinateHeight(){return this.height}dwgInFields(n){return this.point=n.readPoint("point").val,this.position=n.readPoint("position").val,this.height=n.readDouble("height").val,!0}dwgOutFields(n){return n.writePoint("point",this.point),n.writePoint("position",this.position),n.writeDouble("height",this.height),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.point.x+=e,this.point.y+=i,this.point.z+=s):(this.position.x+=e,this.position.y+=i,this.position.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.point),n.append(this.position),n}worldDraw(n){const e=new A.McDbMText;e.textHeight=Ct.MxFun.screenCoordLong2Doc(this.height),e.attachment=A.McDb.AttachmentPoint.kMiddleLeft,e.contents=`X=${this.point.x.toFixed(3)}\\PY=${this.point.y.toFixed(3)}`,e.location=this.position,n.drawEntity(e);const s=A.MxCpp.getCurrentMxCAD().drawEntity(e),{maxPt:a,minPt:o}=s.getMcDbEntity().getBoundingBox();s.erase();const r=Math.abs(a.x-o.x),u=new A.McGePoint3d(this.position.x+r*1.2,this.position.y),l=new A.McDbPolyline;l.addVertexAt(this.point),l.addVertexAt(this.position),l.addVertexAt(u),n.drawEntity(l)}setPosition(n){this.assertWrite(),this.position=n.clone()}getPosition(){return this.position}}function $L(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请选择目标坐标点"));const n=yield t.go();if(!n)return;const e=new Lg;e.coordinatePoint=n;const i=new A.MxCADUiPrPoint;i.setMessage(dt("请指定标注位置")),i.setUserDraw((a,o)=>{e.setPosition(a),o.drawMcDbEntity(e)});const s=yield i.go();s&&(e.setPosition(s),A.MxCpp.getCurrentMxCAD().drawEntity(e))})}function QL(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("指定起点"));const n=yield t.go();if(!n)return;const e=10,i=A.MxCpp.getCurrentMxCAD(),s=new A.McDbText;s.height=e,s.textString=n.y.toFixed(2),s.position=n;const a=i.drawEntity(s);let o,r,u;setTimeout(()=>re(this,null,function*(){const l=a.getMcDbEntity().getBoundingBox(),h=l.maxPt.distanceTo(new A.McGePoint3d(l.minPt.x,l.maxPt.y));a.erase();const f=new A.MxCADUiPrPoint;if(f.setMessage(dt("指定终点")),f.setUserDraw((v,x)=>{o=new A.McDbLine(n,new A.McGePoint3d(n.x+e,n.y,0)),o.startPoint=n,o.endPoint=o.getClosestPointTo(v,!0).val,x.drawMcDbEntity(o);const w=new A.McGePoint3d(v.x,n.y+e,0),M=o.getPointAtDist(o.getLength().val-e).val,E=o.getPointAtDist(o.getLength().val-e*2).val;r=new A.McDbPolyline,r.addVertexAt(w),r.addVertexAt(M),r.addVertexAt(new A.McGePoint3d(E.x,E.y+e,0)),v.x>n.x?r.addVertexAt(new A.McGePoint3d(w.x+h,w.y,0)):r.addVertexAt(new A.McGePoint3d(w.x-h,w.y,0)),x.drawMcDbEntity(r),u=s.clone(),u.position=u.alignmentPoint=w,v.x>n.x?s.horizontalMode=A.McDb.TextHorzMode.kTextLeft:s.horizontalMode=A.McDb.TextHorzMode.kTextRight,x.drawMcDbEntity(u)}),!(yield f.go()))return;const p=new A.MxCADUiPrPoint;p.setMessage(dt("指定标注方向")),p.setUserDraw((v,x)=>{const w=r.clone(),M=u.clone();if(v.y<o.endPoint.y){w.mirror(r.getPointAt(1).val,o.endPoint);const E=w.getPointAt(0).val;M.position=M.alignmentPoint=new A.McGePoint3d(E.x,E.y-e,0)}x.drawMcDbEntity(M),x.drawMcDbEntity(w),x.drawMcDbEntity(o)});const b=yield p.go();if(b){if(b.y<o.endPoint.y){r.mirror(r.getPointAt(1).val,o.endPoint);const v=r.getPointAt(0).val;u.position=u.alignmentPoint=new A.McGePoint3d(v.x,v.y-e,0)}i.drawEntity(o),i.drawEntity(u),i.drawEntity(r)}}),0)})}class eh extends A.McDbCustomEntity{constructor(n){super(n),this.ptArr=[],this.height=30,this.dbulges=[],this.isReactFlag=!1,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new eh(n)}getTypeName(){return"McDbTestAreaComment"}set textHeight(n){this.height=n}get textHeight(){return this.height}set isReact(n){this.isReactFlag=n}get isReact(){return this.isReactFlag}dwgInFields(n){this.ptArr=n.readPoints("ptArr").val,this.pt=n.readPoint("pt").val;const e=n.readString("dbulges").val;return this.dbulges=e.split(",").map(Number),this.isReactFlag=!!n.readLong("isReactFlag").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){n.writePoints("ptArr",this.ptArr),n.writePoint("pt",this.pt);const e=this.dbulges.toString();return n.writeString("dbulges",e),n.writeLong("isReactFlag",this.isReactFlag?1:0),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.ptArr.forEach((a,o)=>{o===n&&(a.x+=e,a.y+=i,a.z+=s)}),n===this.ptArr.length&&(this.pt.x+=e,this.pt.y+=i,this.pt.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return this.ptArr.forEach(e=>{n.append(e)}),n.append(this.pt),n}worldDraw(n){const e=[],i=new A.McDbPolyline;i.isClosed=!0,this.isReactFlag?(i.addVertexAt(this.ptArr[0],0,.1,.1),i.addVertexAt(new A.McGePoint3d(this.ptArr[1].x,this.ptArr[0].y),0,.1,.1),i.addVertexAt(this.ptArr[1],0,.1,.1),i.addVertexAt(new A.McGePoint3d(this.ptArr[0].x,this.ptArr[1].y),0,.1,.1)):this.ptArr.forEach((r,u)=>{i.addVertexAt(r,this.dbulges[u],.1,.1)});const s=i.getArea().val,a=i.getLength().val,o=new A.McDbMText;o.contents=`面积：${s.toFixed(2)}\\P周长：${a.toFixed(2)} `,o.attachment=A.McDb.AttachmentPoint.kMiddleCenter,o.location=this.pt,o.textHeight=Ct.MxFun.screenCoordLong2Doc(this.height),o.trueColor=this.trueColor,n.trueColor=this.trueColor,n.drawEntity(o),n.drawEntity(i),e.push(o),e.push(i),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setPoint(n){this.assertWrite(),this.pt=n.clone()}addVertex(n,e){this.assertWrite(),this.ptArr.push(n.clone()),this.dbulges.push(e||0)}getPoint(){return this.pt}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function tB(){return re(this,null,function*(){const t=[],n=new A.MxCADUiPrPoint;n.setMessage(dt("请选择面积的第一个点"));const e=yield n.go();if(!e)return;for(t.push(e);;){const r=new A.MxCADUiPrPoint;r.setMessage(dt("请选择下一个点")),r.setKeyWords("[回退(B)/结束(O)]"),r.setUserDraw((h,f)=>{const d=new A.McDbPolyline;t.forEach(p=>{d.addVertexAt(p,0,.1,.1)}),d.addVertexAt(h),f.drawMcDbEntity(d)});const u=yield r.go(),l=r.keyWordPicked();if(l==="B")t.length>1&&t.pop();else{if(l==="O")break;if(!u)break;t.push(u)}}if(t.length<3)return;const i=A.MxCpp.getCurrentMxCAD(),s=new eh;t.forEach(r=>{s.addVertex(r,0)});const a=new A.MxCADUiPrPoint;a.setMessage(dt("请选择面积标注的位置")),a.setUserDraw((r,u)=>{u.setColor(16711680),s.setPoint(r),u.drawMcDbEntity(s)});const o=yield a.go();o&&(s.setPoint(o),s.trueColor=new A.McCmColor(255,0,0),i.drawEntity(s))})}function eB(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请选择矩形的角点1"));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrPoint;e.setMessage(dt("请选择矩形的角点2")),e.setUserDraw((r,u)=>{const l=new A.McDbPolyline;l.isClosed=!0,l.addVertexAt(n),l.addVertexAt(new A.McGePoint3d(r.x,n.y)),l.addVertexAt(r),l.addVertexAt(new A.McGePoint3d(n.x,r.y)),u.drawMcDbEntity(l)});const i=yield e.go();if(!i)return;const s=new eh;s.isReact=!0,s.addVertex(n),s.addVertex(i);const a=new A.MxCADUiPrPoint;a.setMessage(dt("请设置面积标注的位置")),a.setUserDraw((r,u)=>{u.setColor(16711680),s.setPoint(r),u.drawMcDbEntity(s)});const o=yield a.go();o&&(s.setPoint(o),s.trueColor=new A.McCmColor(255,0,0),A.MxCpp.getCurrentMxCAD().drawEntity(s))})}function nB(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请选择一个测量点"));const n=yield t.go();if(!n)return;const e=new A.MxCADResbuf([A.DxfCode.kEntityType,"LINE"]),i=new A.MxCADUiPrEntity;i.setMessage(dt("请选择一条直线")),i.setFilter(e);const s=yield i.go();if(!s.id)return;const o=s.getMcDbEntity().getClosestPointTo(n,!0).val;let r;const u=A.MxCpp.getCurrentMxCAD(),l=new A.MxCADUiPrPoint;l.setMessage(dt("请设置尺寸线的位置")),l.setUserDraw((f,d)=>{r&&r.erase(),r=u.drawDimAligned(n.x,n.y,o.x,o.y,f.x,f.y)});const h=yield l.go();if(!h){r&&r.erase();return}r&&r.erase(),u.drawDimAligned(n.x,n.y,o.x,o.y,h.x,h.y)})}class Bg extends A.McDbCustomEntity{constructor(n){super(n),this.center=new A.McGePoint3d,this.position=new A.McGePoint3d,this.height=30,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Bg(n)}getTypeName(){return"McDbTestArcComment"}set arcCenter(n){this.center=n.clone()}get arcCenter(){return this.center}set arcRadius(n){this.radius=n}get arcRadius(){return this.radius}set textHeight(n){this.height=n}get textHeight(){return this.height}set arcStartAngle(n){this.startAngle=n}get arcStartAngle(){return this.startAngle}set arcEndAngle(n){this.endAngle=n}get arcEndAngle(){return this.endAngle}dwgInFields(n){return this.position=n.readPoint("position").val,this.center=n.readPoint("center").val,this.startAngle=n.readDouble("startAngle").val,this.endAngle=n.readDouble("endAngle").val,this.radius=n.readDouble("radius").val,this.height=n.readDouble("textHeight").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("position",this.position),n.writePoint("center",this.center),n.writeDouble("startAngle",this.startAngle),n.writeDouble("endAngle",this.endAngle),n.writeDouble("radius",this.radius),n.writeDouble("textHeight",this.height),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.position.x+=e,this.position.y+=i,this.position.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n}drawLine(n,e){const i=e.sub(n).normalize().mult(Ct.MxFun.screenCoordLong2Doc(this.height*.4)),s=e.clone().addvec(i),a=e.clone().subvec(i),o=new A.McDbLine(s,a);return o.rotate(e,Math.PI/4),{line:o,pt:s}}worldDraw(n){const e=[],i=new A.McDbArc;i.center=this.center,i.startAngle=this.startAngle,i.endAngle=this.endAngle,i.radius=this.radius;const s=i.getLength().val,a=i.getPointAtDist(0).val,o=i.getPointAtDist(s).val,r=new A.McDbText;r.textString=`${s.toFixed(2)}`,r.height=Ct.MxFun.screenCoordLong2Doc(this.height),r.horizontalMode=A.McDb.TextHorzMode.kTextCenter,r.position=r.alignmentPoint=this.position;const l=i.getClosestPointTo(this.position,!0).val.distanceTo(this.position);i.offsetCurves(l,this.position).forEach(x=>{const w=x.clone(),M=w.getLength().val;this.pt1=w.getPointAtDist(0).val,this.pt2=w.getPointAtDist(M).val;const E=w.getPointAtDist(M/2).val;this.dbulge=A.MxCADUtility.calcBulge(this.pt1,E,this.pt2).val});const h=new A.McDbPolyline;h.addVertexAt(this.pt1,this.dbulge),h.addVertexAt(this.pt2);const f=this.pt1.sub(this.pt2).angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis);r.rotation=f===Math.PI?0:f;const{line:d,pt:p}=this.drawLine(a,this.pt1),{line:b,pt:v}=this.drawLine(o,this.pt2);h.trueColor=r.trueColor=d.trueColor=b.trueColor=this.trueColor,n.drawEntity(h),n.drawEntity(r),n.drawEntity(d),n.drawEntity(b),n.drawEntity(new A.McDbLine(a,p)),n.drawEntity(new A.McDbLine(o,v)),e.push(h),e.push(r),e.push(d),e.push(b),e.push(new A.McDbLine(a,p)),e.push(new A.McDbLine(o,v)),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setPosition(n){this.assertWrite(),this.position=n.clone()}getPoint(){return this.position}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function rB(){return re(this,null,function*(){const t=new A.MxCADResbuf([A.DxfCode.kEntityType,"ARC"]),n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择一条弧线")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new Bg;s.arcCenter=i.center,s.arcStartAngle=i.startAngle,s.arcEndAngle=i.endAngle,s.arcRadius=i.radius;const a=new A.MxCADUiPrPoint;a.setMessage(dt("请指定尺寸线位置")),a.setUserDraw((u,l)=>{l.setColor(16711680),s.setPosition(u),l.drawMcDbEntity(s)});const o=yield a.go();if(!o)return;s.setPosition(o),s.trueColor=new A.McCmColor(255,0,0),A.MxCpp.getCurrentMxCAD().drawEntity(s)})}class Fg extends A.McDbCustomEntity{constructor(n){super(n),this.center=new A.McGePoint3d,this.position=new A.McGePoint3d,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Fg(n)}getTypeName(){return"McDbTestMeasuringCircle"}set circleRadius(n){this.radius=n}get circleRadius(){return this.radius}dwgInFields(n){return this.center=n.readPoint("center").val,this.position=n.readPoint("position").val,this.radius=n.readDouble("radius").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("center",this.center),n.writePoint("position",this.position),n.writeDouble("radius",this.radius),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),this.position.x+=e,this.position.y+=i,this.position.z+=s}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n}worldDraw(n){const e=[],i=new A.McDbCircle;i.center=this.center,i.radius=this.radius;const s=i.getLength().val,a=i.radius,o=Math.PI*a*a,r=new A.McDbMText;r.contents=`半径：${a.toFixed(2)} \\P 周长：${s.toFixed(2)} \\P 面积：${o.toFixed(2)}`,r.textHeight=a/6,r.attachment=A.McDb.AttachmentPoint.kMiddleCenter,r.location=this.position,r.trueColor=i.trueColor=this.trueColor,n.drawEntity(r),n.drawEntity(i),e.push(r),e.push(i),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}setCenter(n){this.assertWrite(),this.center=n.clone()}getCenter(){return this.center}setPosition(n){this.assertWrite(),this.position=n.clone()}getPosition(){return this.position}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function iB(){return re(this,null,function*(){const t=new A.MxCADResbuf([A.DxfCode.kEntityType,"CIRCLE"]),n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择一个圆对象")),n.setFilter(t);const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity();i.highlight(!0);const s=new Fg;s.setCenter(i.center),s.circleRadius=i.radius;const a=new A.MxCADUiPrPoint;a.setMessage(dt("请指定文字位置")),a.setUserDraw((u,l)=>{l.setColor(16711680),s.setPosition(u),l.drawMcDbEntity(s)});const o=yield a.go();if(!o)return;s.setPosition(o),s.trueColor=new A.McCmColor(255,0,0),A.MxCpp.getCurrentMxCAD().drawEntity(s),i.highlight(!1)})}class Ng extends A.McDbCustomEntity{constructor(n){super(n),this.points=[],this.dbulges=[],this.position=new A.McGePoint3d,this.height=30,this.dimColor=new A.McCmColor(255,0,0),this.width=.1,this.showSegLength=!1,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Ng(n)}getTypeName(){return"McDbTestConMeasurement"}set textHeight(n){this.height=n}get textHeight(){return this.height}set color(n){this.dimColor=n.clone()}get color(){return this.dimColor}set conWidth(n){this.width=Ct.MxFun.screenCoordLong2Doc(n)}get conWidth(){return this.width}set isShowSegLength(n){this.showSegLength=n}get isShowSegLength(){return this.showSegLength}dwgInFields(n){this.points=n.readPoints("points").val,this.position=n.readPoint("position").val;const e=n.readString("dbulges").val;this.dbulges=e.split(",").map(Number);const i=n.readString("dimColor").val;return this.dimColor=new A.McCmColor(...i.split(",").map(Number)),this.width=n.readDouble("conWidth").val,this.showSegLength=n.readLong("showSegLength").val===1,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){const e=this.dbulges.toString(),i=`${this.dimColor.red},${this.dimColor.green},${this.dimColor.blue}`,s=this.showSegLength?1:0;return n.writePoints("points",this.points),n.writePoint("position",this.position),n.writeString("dbulges",e),n.writeString("dimColor",i),n.writeDouble("conWidth",this.width),n.writeLong("showSegLength",s),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n<this.points.length?(this.points[n].x+=e,this.points[n].y+=i,this.points[n].z+=s):(this.position.x+=e,this.position.y+=i,this.position.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return this.points.forEach(e=>{n.append(e)}),n.append(this.position),n}worldDraw(n){const e=[],i=new A.McDbPolyline,s=[];this.points.forEach((D,N)=>{let V=this.width;if(N===this.points.length-1&&(V=0),i.addVertexAt(D,this.dbulges[N],V,V),N>0){const K=this.points[N-1],j=new A.McDbPolyline;j.addVertexAt(K,this.dbulges[N-1]),j.addVertexAt(D,this.dbulges[N]);const Z=j.getLength().val,tt=j.getPointAtDist(Z/2).val,rt=new A.McDbText;rt.textString=`${Z.toFixed(2)}`,rt.height=Ct.MxFun.screenCoordLong2Doc(this.height*.6),rt.horizontalMode=A.McDb.TextHorzMode.kTextCenter;let J;K.x<=D.x?J=D.sub(K):J=K.sub(D);const U=J.clone().perpVector().normalize(),G=Ct.MxFun.screenCoordLong2Doc(this.height*.15),I=new A.McDbLine(K,D);I.getPointAtDist(I.getLength().val/2).val.y>=tt.y?tt.addvec(U.mult(G)):tt.subvec(U.mult(G)),rt.position=rt.alignmentPoint=tt;const L=J.angleTo2(A.McGeVector3d.kXAxis,A.McGeVector3d.kNegateZAxis);rt.rotation=L===Math.PI?0:L,s.push(rt)}});const a=A.MxCpp.getCurrentMxCAD(),o=a.drawEntity(i),r=o.getMcDbEntity().getLength().val,u=this.points[this.points.length-1],h=i.getFirstDeriv(u).val.clone();h.rotateBy(Math.PI/4).normalize().mult(this.width*5);const f=u.clone().addvec(h),d=u.clone().subvec(h),p=new A.McDbPolyline;p.addVertexAt(f,0,this.width,this.width),p.addVertexAt(d),o.erase();const b=new A.McDbText;b.textString=`${r.toFixed(2)}`,b.height=Ct.MxFun.screenCoordLong2Doc(this.height);const v=Ct.MxFun.screenCoordLong2Doc(4);b.position=b.alignmentPoint=new A.McGePoint3d(this.position.x+v,this.position.y+v),b.horizontalMode=A.McDb.TextHorzMode.kTextLeft;const x=a.drawEntity(b),{minPt:w,maxPt:M}=x.getMcDbEntity().getBoundingBox();x.erase();const E=new A.McGePoint3d(this.position.x+Math.abs(w.x-M.x)+v*6,this.position.y);i.addVertexAt(this.position),i.addVertexAt(E),this.showSegLength&&s.forEach(D=>{n.drawEntity(D),e.push(D)}),n.trueColor=this.dimColor,n.drawEntity(i),n.drawEntity(b),n.drawEntity(p),e.push(i),e.push(b),e.push(p),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}addVertex(n,e){this.assertWrite(),this.dbulges.push(e),this.points.push(n)}getPoints(){return this.points}setPosition(n){this.assertWrite(),this.position=n.clone()}getPosition(){return this.position}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}let sM=[];function aM(t){const n=A.MxCpp.getCurrentMxCAD();t===1?(sM.push({name:"ORTHOMODE",value:n.getSysVarLong("ORTHOMODE")},{name:"GRIDMODE",value:n.getSysVarLong("GRIDMODE")},{name:"OSMODE",value:n.getSysVarLong("OSMODE")}),n.setSysVarLong("ORTHOMODE",0),n.setSysVarLong("GRIDMODE",0),n.setSysVarLong("OSMODE",16383)):t===0&&sM.forEach(e=>{n.setSysVarLong(e.name,e.value)})}function lM(){return re(this,null,function*(){aM(1);let t=[],n=!1;const e=new A.MxCADResbuf([A.DxfCode.kEntityType,"ARC"]);let s=A.MxCpp.getCurrentMxCAD().mxdraw.screenCoordLong2Doc(.5),a=null;for(;;){const o=new A.MxCADUiPrPoint;o.setMessage(dt("请选择直线的端点或弧线")),o.setKeyWords("[回退(B)/结束(O)]"),t.length>0&&o.setBasePt(t[t.length-1].pt),o.setUserDraw((l,h)=>{const f=new A.McDbPolyline;t.forEach(d=>{f.addVertexAt(d.pt,d.dbulge,.1,.1)}),h.drawMcDbEntity(f)});const r=yield o.go(),u=o.keyWordPicked();if(u==="B")t.length>1&&t.pop(),a=null;else{if(u==="O")break;{if(!r)break;const l=A.MxCADUtility.findEntAtPoint(r.x,r.y,r.z,-1,e);if(!l.id)a=null,n?t.filter(f=>f.pt.distanceTo(r)<s).length||alert("请选择连续的线段！"):t.push({pt:r,dbulge:0});else{const h=l.getMcDbEntity(),f=h.getLength().val,d=h.getPointAtDist(0).val,p=h.getPointAtDist(f).val;if(d.distanceTo(r)<s||p.distanceTo(r)<s)if(n){const b=-t[0].dbulge,v=t[t.length-2].pt,x=t[t.length-1].pt;v.distanceTo(r)<s&&(t.slice(0,t.length-2),t.push({pt:x,dbulge:b}),t.push({pt:v,dbulge:0})),n=!1,a=l}else t.push({pt:r,dbulge:0});else if(t.length>0){const b=t[t.length-1].pt;if(d.distanceTo(b)<s||p.distanceTo(b)<s)if((a==null?void 0:a.id)===l.id){console.log("点击同一个圆弧"),t.pop();const v=t[t.length-1],x=h.getDistAtPoint(v.pt).val,w=h.getDistAtPoint(r).val;let M=h.getPointAtDist(x+(w-x)/2).val,E=new A.McDbArc;if(E.computeArc(v.pt.x,v.pt.y,M.x,M.y,r.x,r.y),E.getLength().val>h.getLength().val){const D=E.clone();E.startAngle=D.endAngle,E.endAngle=D.startAngle,M=E.getPointAtDist(E.getLength().val/2).val}v.dbulge=A.MxCADUtility.calcBulge(v.pt,M,r).val,t.push({pt:r,dbulge:0}),a=null}else{const v=d.distanceTo(b)<s?p:d;t[t.length-1].dbulge=A.MxCADUtility.calcBulge(b,r,v).val,t.push({pt:v,dbulge:0}),a=l}else alert("请选择连续的线段！")}else{const b=A.MxCADUtility.calcBulge(d,r,p).val;t.push({pt:d,dbulge:b}),t.push({pt:p,dbulge:0}),n=!0,a=l}}}}}return aM(0),t})}function oB(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=yield lM();if(n.length<2)return;const e=new Ng;n.forEach(a=>{e.addVertex(a.pt,a.dbulge)});const i=new A.MxCADUiPrPoint;i.setMessage(dt("请指定文字的位置")),i.setUserDraw((a,o)=>{e.setPosition(a),o.drawMcDbEntity(e)});const s=yield i.go();s&&(e.setPosition(s),t.drawEntity(e))})}function sB(){return re(this,null,function*(){const t=new A.MxCADUiPrEntity;t.setMessage(dt("请选择一个连续测量的标注"));const n=yield t.go();if(!n.id)return;const e=n.getMcDbEntity();if(e instanceof A.McDbCustomEntity&&e.getTypeName()==="McDbTestConMeasurement"){const i=e.clone();i.isShowSegLength=!i.isShowSegLength,A.MxCpp.getCurrentMxCAD().drawEntity(i),n.erase()}})}function aB(){return re(this,null,function*(){const t=yield lM(),n=A.MxCpp.getCurrentMxCAD(),e=new eh;t.forEach(a=>{e.addVertex(a.pt,a.dbulge)});const i=new A.MxCADUiPrPoint;i.setMessage(dt("请选择面积标注的位置")),i.setUserDraw((a,o)=>{e.setPoint(a),o.drawMcDbEntity(e)});const s=yield i.go();s&&(e.setPoint(s),e.trueColor=new A.McCmColor(255,0,0),n.drawEntity(e))})}function lB(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LINE");const n=new A.MxCADUiPrEntity;n.setMessage(dt("请选择一条直线")),n.setFilter(t);const e=yield n.go();if(!e)return;const i=e.getMcDbEntity();i.highlight(!0);const s=new A.MxCADUiPrEntity;s.setMessage(dt("请选择第二条直线")),s.setFilter(t);const a=yield s.go();if(!a)return;const o=a.getMcDbEntity();o.highlight(!0);const r=new A.MxCADUiPrPoint;r.setMessage(dt("请设置角度标注的位置"));const u=A.MxCpp.getCurrentMxCAD().addDimStyle("MyDimStyle2","41,0.18,141,0.09,40,20","77,1,271,3","",""),l=new A.McDb2LineAngularDimension;l.xLine1Start=i.startPoint,l.xLine1End=i.endPoint,l.xLine2Start=o.startPoint,l.xLine2End=o.endPoint,l.dimensionStyle=u,i.highlight(!1),o.highlight(!1),r.setUserDraw((f,d)=>{l.arcPoint=f,d.drawMcDbEntity(l)});const h=yield r.go();h&&(l.arcPoint=h,A.MxCpp.getCurrentMxCAD().drawEntity(l))})}function cB(){new eh().rxInit(),new Ng().rxInit(),new Fg().rxInit(),new Bg().rxInit(),new Lg().rxInit(),Ct.MxFun.addCommand("Mx_StaLength",KL),Ct.MxFun.addCommand("Mx_StaArea",ZL),Ct.MxFun.addCommand("Mx_StandardSlope",JL),Ct.MxFun.addCommand("Mx_CoordAnnotation",$L),Ct.MxFun.addCommand("Mx_Elevation",QL),Ct.MxFun.addCommand("Mx_Area",tB),Ct.MxFun.addCommand("Mx_ReactArea",eB),Ct.MxFun.addCommand("Mx_DistFromPointToLine",nB),Ct.MxFun.addCommand("Mx_ArcLength",rB),Ct.MxFun.addCommand("Mx_MeasuringCircle",iB),Ct.MxFun.addCommand("Mx_ContinueMeasurement",oB),Ct.MxFun.addCommand("Mx_CountList",sB),Ct.MxFun.addCommand("Mx_AreaArc",aB),Ct.MxFun.addCommand("Mx_MeasuringAngle",lB)}function uB(){return re(this,null,function*(){const t=new A.MxCADUiPrKeyWord;t.setMessage(dt("请设置图框方向<N>")),t.setKeyWords(`[${dt("横向")}(T)/${dt("纵向")}(P)]`);let n=yield t.go();switch(n){case"T":n="T";break;case"P":n="P";break;default:n="T";break}const e=new hB;e.direct=n;const i=new A.MxCADUiPrKeyWord;i.setMessage(dt("请设置图框尺寸<4>")),i.setKeyWords("[A0(0)/A1(1)/A2(2)/A3(3)/A4(4)]");let s=yield i.go();s||(s="4"),e.size=s;const a=new A.MxCADUiPrPoint;a.setMessage(dt("请设置图框位置"));let o=yield a.go();o&&(e.framePos=o,e.tableScale="1:10",e.draw())})}class hB{constructor(){this.size="4",this.direct="T",this.scale=1,this.tableData=[{width:18,data:[{rowNum:1},{label:"比例",value:`1:${this.scale}`,rowNum:1},{label:"尺寸",value:`A${this.size}`,rowNum:1}]},{width:30,data:[{label:"日期",rowNum:1},{label:"审核",rowNum:1},{label:"绘制",rowNum:1}]},{width:45,data:[{label:"图号",rowNum:1},{label:"图名",rowNum:2}]}],this.framePos=new A.McGePoint3d,this.rowNum=3,this.lableWidth=18,this.lableHeight=6,this._pos=new A.McGePoint3d,this.drawFrameOutside=()=>{const n=A.MxCpp.getCurrentMxCAD(),e=this.getFrameSpecifications(this.size,this.direct),i=A.McGeVector3d.kYAxis.clone().mult(e.height),s=A.McGeVector3d.kXAxis.clone().negate().mult(e.width),a=this.framePos.clone().addvec(i),o=this.framePos.clone().addvec(s),r=this.framePos.clone().addvec(i).addvec(s),u=new A.McDbPolyline;u.addVertexAt(this.framePos),u.addVertexAt(a),u.addVertexAt(r),u.addVertexAt(o),u.isClosed=!0,n.drawEntity(u);const l=this.framePos.clone().addvec(r.sub(this.framePos).mult(1/2)),h=5*this.scale;let f=new A.McDbPolyline;u.offsetCurves(h,l).forEach(d=>{f=d.clone(),n.drawEntity(d)}),this._pos=f.getPointAt(0).val},this.drawContent=()=>{const n=A.MxCpp.getCurrentMxCAD(),e=this.tableData.reduce((l,h)=>l+h.width,0)*this.scale,i=A.McGeVector3d.kXAxis.clone().negate().mult(this.tableData.length*this.lableWidth+e),s=A.McGeVector3d.kYAxis.clone().mult(this.lableHeight*this.rowNum),a=this._pos.clone().addvec(s),o=this._pos.clone().addvec(i).addvec(s),r=new A.McDbLine(a,o);n.drawEntity(r);let u=this._pos.clone();this.tableData.forEach(l=>{const h=A.McGeVector3d.kXAxis.clone().negate().mult(l.width*this.scale),f=A.McGeVector3d.kXAxis.clone().negate().mult(this.lableWidth);let d=0;const p=u.clone();l.data.forEach((b,v)=>{d+=b.rowNum;const x=A.McGeVector3d.kYAxis.clone().mult(this.lableHeight*d),w=p.clone().addvec(h),M=p.clone().addvec(x),E=p.clone().addvec(x).addvec(h),D=new A.McDbLine(w,E),N=new A.McDbLine(M,E);if(b.value){const tt=N.getPointAtDist(N.getLength().val/2).val,rt=this.getText(tt,b.value,this.lableHeight,b.rowNum);n.drawEntity(rt)}const V=E.clone().addvec(f),K=w.clone().addvec(f);v===0&&(u=K.clone());const j=new A.McDbLine(V,E),Z=new A.McDbLine(V,K);if(v<l.data.length-1&&(n.drawEntity(N),n.drawEntity(j)),v===l.data.length-1&&(n.drawEntity(D),n.drawEntity(Z)),b.label){const tt=j.getPointAtDist(j.getLength().val/2).val,rt=this.getText(tt,b.label,this.lableHeight,b.rowNum);n.drawEntity(rt)}})})},this.getText=(n,e,i,s)=>{const a=new A.McDbText;return a.textString=e,a.height=i*(3/5),a.position=a.alignmentPoint=n.clone().subvec(A.McGeVector3d.kYAxis.clone().mult(s*i/2+a.height*(1/2))),a.horizontalMode=A.McDb.TextHorzMode.kTextCenter,a},this.getFrameSpecifications=(n,e)=>{const i={width:0,length:0};switch(n){case"0":i.width=841,i.length=1189;break;case"1":i.width=594,i.length=841;break;case"2":i.width=420,i.length=594;break;case"3":i.width=297,i.length=420;break;case"4":i.width=210,i.length=297;break}if(e==="P")return{height:i.length*this.scale,width:i.width*this.scale};if(e==="T")return{height:i.width*this.scale,width:i.length*this.scale}},this.draw=()=>{this.direct==="T"&&this.tableData.push({width:55,data:[{label:"建设单位",rowNum:1},{label:"设计单位",rowNum:1},{label:"工程名称",rowNum:1}]}),this.lableWidth=this.lableWidth*this.scale,this.lableHeight=this.lableHeight*this.scale,this.drawFrameOutside(),this.drawContent()}}set tableScale(n){this.scale=Number(n.split(":")[1]),this.tableData.forEach(e=>{e.data.forEach(i=>{i.label==="比例"&&(i.value=`1:${this.scale}`)})})}get tableScale(){return`1:${this.scale}`}}function dB(){MxPluginContext.addCommand("Mx_InsterFrame",uB)}let al=class{constructor(n,e){this.data=n,this.text=e.text||n,this.options=e}};class fB extends al{constructor(n,e){n=n.toUpperCase(),e.mod43&&(n+=gB(yB(n))),super(n,e)}encode(){var n=Rb("*");for(let e=0;e<this.data.length;e++)n+=Rb(this.data[e])+"0";return n+=Rb("*"),{data:n,text:this.text}}valid(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}var cM=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],pB=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function Rb(t){return mB(uM(t))}function mB(t){return pB[t].toString(2)}function gB(t){return cM[t]}function uM(t){return cM.indexOf(t)}function yB(t){var n=0;for(let e=0;e<t.length;e++)n+=uM(t[e]);return n=n%43,n}const wf=0,Og=1,hM=2,bB=98,vB=103,xB=104,_B=105,wB=103,MB=106,AB=207,SB={[vB]:wf,[xB]:Og,[_B]:hM},EB={101:wf,100:Og,99:hM},dM=String.fromCharCode(208),fM=String.fromCharCode(209),pM=String.fromCharCode(210),kb="[\0-_È-Ï]",Ib="[ -È-Ï]",mM="(Ï*[0-9]{2}Ï*)",gM=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011];class xo extends al{constructor(n,e){super(n.substring(1),e),this.bytes=n.split("").map(i=>i.charCodeAt(0))}valid(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}encode(){const n=this.bytes,e=n.shift()-105,i=SB[e];if(i===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&n.unshift(AB);const s=xo.next(n,1,i);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:xo.getBar(e)+s.result+xo.getBar((s.checksum+e)%wB)+xo.getBar(MB)}}shouldEncodeAsEan128(){let n=this.options.ean128||!1;return typeof n=="string"&&(n=n.toLowerCase()==="true"),n}static getBar(n){return gM[n]?gM[n].toString():""}static correctIndex(n,e){if(e===wf){const i=n.shift();return i<32?i+64:i-32}else return e===Og?n.shift()-32:(n.shift()-48)*10+n.shift()-48}static next(n,e,i){if(!n.length)return{result:"",checksum:0};let s,a;if(n[0]>=200){a=n.shift()-105;const u=EB[a];u!==void 0?s=xo.next(n,e+1,u):((i===wf||i===Og)&&a===bB&&(n[0]=i===wf?n[0]>95?n[0]-96:n[0]:n[0]<32?n[0]+96:n[0]),s=xo.next(n,e+1,i))}else a=xo.correctIndex(n,i),s=xo.next(n,e+1,i);const o=xo.getBar(a),r=a*e;return{result:o+s.result,checksum:r+s.checksum}}}const yM=t=>t.match(new RegExp(`^${kb}*`))[0].length,bM=t=>t.match(new RegExp(`^${Ib}*`))[0].length,vM=t=>t.match(new RegExp(`^${mM}*`))[0];function Lb(t,n){const e=n?kb:Ib,i=t.match(new RegExp(`^(${e}+?)(([0-9]{2}){2,})([^0-9]|$)`));if(i)return i[1]+String.fromCharCode(204)+xM(t.substring(i[1].length));const s=t.match(new RegExp(`^${e}+`))[0];return s.length===t.length?t:s+String.fromCharCode(n?205:206)+Lb(t.substring(s.length),!n)}function xM(t){const n=vM(t),e=n.length;if(e===t.length)return t;t=t.substring(e);const i=yM(t)>=bM(t);return n+String.fromCharCode(i?206:205)+Lb(t,i)}const TB=t=>{let n;if(vM(t).length>=2)n=pM+xM(t);else{const i=yM(t)>bM(t);n=(i?dM:fM)+Lb(t,i)}return n.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(i,s)=>String.fromCharCode(203)+s)};class CB extends xo{constructor(n,e){/^[\x00-\x7F\xC8-\xD3]+$/.test(n)?super(TB(n),e):super(n,e)}}class PB extends xo{constructor(n,e){super(dM+n,e)}valid(){return new RegExp(`^${kb}+$`).test(this.data)}}class DB extends xo{constructor(n,e){super(fM+n,e)}valid(){return new RegExp(`^${Ib}+$`).test(this.data)}}class RB extends xo{constructor(n,e){super(pM+n,e)}valid(){return new RegExp(`^${mM}+$`).test(this.data)}}const zg="101",_M="01010",kB={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},IB=["LL","LG","GL","GG"],LB=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],BB=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"],ms=(t,n,e)=>{let i=t.split("").map((s,a)=>kB[n[a]]).map((s,a)=>s?s[t[a]]:"");if(e){const s=t.length-1;i=i.map((a,o)=>o<s?a+e:a)}return i.join("")};class wM extends al{constructor(n,e){super(n,e),this.fontSize=!e.flat&&e.fontSize>e.width*10?e.width*10:e.fontSize,this.guardHeight=e.height+this.fontSize/2+e.textMargin}encode(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}leftText(n,e){return this.text.substr(n,e)}leftEncode(n,e){return ms(n,e)}rightText(n,e){return this.text.substr(n,e)}rightEncode(n,e){return ms(n,e)}encodeGuarded(){const n={fontSize:this.fontSize},e={height:this.guardHeight};return[{data:zg,options:e},{data:this.leftEncode(),text:this.leftText(),options:n},{data:_M,options:e},{data:this.rightEncode(),text:this.rightText(),options:n},{data:zg,options:e}]}encodeFlat(){return{data:[zg,this.leftEncode(),_M,this.rightEncode(),zg].join(""),text:this.text}}}const MM=t=>(10-t.substr(0,12).split("").map(e=>+e).reduce((e,i,s)=>s%2?e+i*3:e+i,0)%10)%10;class FB extends wM{constructor(n,e){n.search(/^[0-9]{12}$/)!==-1&&(n+=MM(n)),super(n,e),this.lastChar=e.lastChar}valid(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===MM(this.data)}leftText(){return super.leftText(1,6)}leftEncode(){const n=this.data.substr(1,6),e=BB[this.data[0]];return super.leftEncode(n,e)}rightText(){return super.rightText(7,6)}rightEncode(){const n=this.data.substr(7,6);return super.rightEncode(n,"RRRRRR")}encodeGuarded(){const n=super.encodeGuarded();return this.options.displayValue&&(n.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(n.push({data:"00"}),n.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),n}}const AM=t=>(10-t.substr(0,7).split("").map(e=>+e).reduce((e,i,s)=>s%2?e+i:e+i*3,0)%10)%10;class NB extends wM{constructor(n,e){n.search(/^[0-9]{7}$/)!==-1&&(n+=AM(n)),super(n,e)}valid(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===AM(this.data)}leftText(){return super.leftText(0,4)}leftEncode(){const n=this.data.substr(0,4);return super.leftEncode(n,"LLLL")}rightText(){return super.rightText(4,4)}rightEncode(){const n=this.data.substr(4,4);return super.rightEncode(n,"RRRR")}}const OB=t=>t.split("").map(e=>+e).reduce((e,i,s)=>s%2?e+i*9:e+i*3,0)%10;class zB extends al{constructor(n,e){super(n,e)}valid(){return this.data.search(/^[0-9]{5}$/)!==-1}encode(){const n=LB[OB(this.data)];return{data:"1011"+ms(this.data,n,"01"),text:this.text}}}class UB extends al{constructor(n,e){super(n,e)}valid(){return this.data.search(/^[0-9]{2}$/)!==-1}encode(){const n=IB[parseInt(this.data)%4];return{data:"1011"+ms(this.data,n,"01"),text:this.text}}}class VB extends al{constructor(n,e){n.search(/^[0-9]{11}$/)!==-1&&(n+=Bb(n)),super(n,e),this.displayValue=e.displayValue,e.fontSize>e.width*10?this.fontSize=e.width*10:this.fontSize=e.fontSize,this.guardHeight=e.height+this.fontSize/2+e.textMargin}valid(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==Bb(this.data)}encode(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}flatEncoding(){var n="";return n+="101",n+=ms(this.data.substr(0,6),"LLLLLL"),n+="01010",n+=ms(this.data.substr(6,6),"RRRRRR"),n+="101",{data:n,text:this.text}}guardedEncoding(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101"+ms(this.data[0],"L"),options:{height:this.guardHeight}}),n.push({data:ms(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),n.push({data:"01010",options:{height:this.guardHeight}}),n.push({data:ms(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),n.push({data:ms(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),n}}function Bb(t){var n=0,e;for(e=1;e<11;e+=2)n+=parseInt(t[e]);for(e=0;e<11;e+=2)n+=parseInt(t[e])*3;return(10-n%10)%10}const jB=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],GB=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]];class HB extends al{constructor(n,e){if(super(n,e),this.isValid=!1,n.search(/^[0-9]{6}$/)!==-1)this.middleDigits=n,this.upcA=SM(n,"0"),this.text=e.text||`${this.upcA[0]}${n}${this.upcA[this.upcA.length-1]}`,this.isValid=!0;else if(n.search(/^[01][0-9]{7}$/)!==-1)if(this.middleDigits=n.substring(1,n.length-1),this.upcA=SM(this.middleDigits,n[0]),this.upcA[this.upcA.length-1]===n[n.length-1])this.isValid=!0;else return;else return;this.displayValue=e.displayValue,e.fontSize>e.width*10?this.fontSize=e.width*10:this.fontSize=e.fontSize,this.guardHeight=e.height+this.fontSize/2+e.textMargin}valid(){return this.isValid}encode(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}flatEncoding(){var n="";return n+="101",n+=this.encodeMiddleDigits(),n+="010101",{data:n,text:this.text}}guardedEncoding(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101",options:{height:this.guardHeight}}),n.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),n.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),n}encodeMiddleDigits(){const n=this.upcA[0],e=this.upcA[this.upcA.length-1],i=GB[parseInt(e)][parseInt(n)];return ms(this.middleDigits,i)}}function SM(t,n){const e=parseInt(t[t.length-1]),i=jB[e];let s="",a=0;for(let o=0;o<i.length;o++){let r=i[o];r==="X"?s+=t[a++]:s+=r}return s=`${n}${s}`,`${s}${Bb(s)}`}class WB extends al{constructor(n,e){n.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(n="A"+n+"A"),super(n.toUpperCase(),e),this.text=this.options.text||this.text.replace(/[A-D]/g,"")}valid(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}encode(){for(var n=[],e=this.getEncodings(),i=0;i<this.data.length;i++)n.push(e[this.data.charAt(i)]),i!==this.data.length-1&&n.push("0");return{text:this.text,data:n.join("")}}getEncodings(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}const qB={CODE39:fB,CODE128:CB,CODE128A:PB,CODE128B:DB,CODE128C:RB,EAN13:FB,EAN8:NB,EAN5:zB,EAN2:UB,UPC:VB,UPCE:HB,codabar:WB};class lc extends A.McDbCustomEntity{constructor(n){super(n),this.position=new A.McGePoint3d,this.textHeight=120,this.text="",this.codeHeight=300,this.codeWidth=10,this.codeType="CODE39",this.codeContent="ABCDEFG",this.showText=!1,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new lc(n)}getTypeName(){return"McDbTestBarCode"}set barCodePos(n){this.position=n.clone()}get barCodePos(){return this.position}set barCodeText(n){this.text=n}get barCodeText(){return this.text}set barCodeHeight(n){this.codeHeight=n}get barCodeHeight(){return this.codeHeight}set barCodeType(n){this.codeType=n}get barCodeType(){return this.codeType}set barCodeWidth(n){this.codeWidth=n}get barCodeWidth(){return this.codeWidth}set barCodeTextHeight(n){this.textHeight=n}get barCodeHeigth(){return this.textHeight}set barCodeShowText(n){this.showText=n}get barCodeShowText(){return this.showText}set barCodeContent(n){this.codeContent=n}get barCodeContent(){return this.codeContent}dwgInFields(n){this.position=n.readPoint("position").val,this.codeWidth=n.readDouble("codeWidth").val,this.codeHeight=n.readDouble("codeHeight").val,this.textHeight=n.readDouble("textHeight").val,this.text=n.readString("text").val,this.codeType=n.readString("codeType").val,this.codeContent=n.readString("codeContent").val;const e=n.readLong("showText").val;return this.showText=!!e,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){n.writePoint("position",this.position),n.writeDouble("codeWidth",this.codeWidth),n.writeDouble("codeHeight",this.codeHeight),n.writeString("text",this.text),n.writeDouble("textHeight",this.textHeight),n.writeString("codeType",this.codeType),n.writeString("codeContent",this.codeContent);const e=this.showText?1:0;return n.writeLong("showText",e),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0&&(this.position.x+=e,this.position.y+=i,this.position.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n}worldDraw(n){const e=[],i=new qB[this.codeType](this.codeContent,{flat:!0});if(!i.valid())return alert("条形码类型与内容不匹配！请重新设置！");let s=i.encode();const a=A.McGeVector3d.kYAxis.clone().mult(this.codeHeight),o=A.McGeVector3d.kXAxis.clone().mult(this.codeWidth);if(s.data.split("").forEach((r,u)=>{const l=new A.McDbHatch,h=new A.McGePoint3d(this.position.x+u*this.codeWidth,this.position.y,this.position.z),f=h.clone().addvec(a),d=f.clone().addvec(o),p=h.clone().addvec(o),b=new A.McGePoint3dArray([h,f,d,p]);l.appendLoop(b),r=="1"&&(n.drawEntity(l),e.push(l))}),this.showText){const r=this.getCodeText();n.drawEntity(r),e.push(r)}this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}getCodeText(){this.text||(this.text=this.codeContent);const n=new A.McDbText;n.textString=this.text,n.height=this.textHeight;const e=A.McGeVector3d.kYAxis.clone().negate().mult(this.textHeight*(4/3));return n.position=n.alignmentPoint=this.position.clone().addvec(e),n.horizontalMode=A.McDb.TextHorzMode.kTextLeft,n}transformBy(n){return this.position.transformBy(n),!0}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function XB(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD();t.newFile(),t.setViewBackgroundColor(255,255,255);const n=new lc;n.barCodePos=new A.McGePoint3d(100,100,0),n.barCodeShowText=!0,t.drawEntity(n);const e=new lc;e.barCodeContent="A little test!",e.barCodeType="CODE128",e.barCodePos=new A.McGePoint3d(-2e3,100,0),e.barCodeShowText=!0,t.drawEntity(e);const i=new lc;i.barCodeContent="5901234123457",i.barCodeType="EAN13",i.barCodePos=new A.McGePoint3d(-2e3,-800,0),i.barCodeShowText=!0,t.drawEntity(i);const s=new lc;s.barCodeContent="C1234567890D",s.barCodeType="codabar",s.barCodePos=new A.McGePoint3d(100,-800,0),s.barCodeShowText=!0,t.drawEntity(s),t.zoomAll(),t.zoomScale(4)})}var cc;(function(){function t(E){this.mode=e.MODE_8BIT_BYTE,this.data=E,this.parsedData=[];for(var D=0,N=this.data.length;D<N;D++){var V=[],K=this.data.charCodeAt(D);K>65536?(V[0]=240|(K&1835008)>>>18,V[1]=128|(K&258048)>>>12,V[2]=128|(K&4032)>>>6,V[3]=128|K&63):K>2048?(V[0]=224|(K&61440)>>>12,V[1]=128|(K&4032)>>>6,V[2]=128|K&63):K>128?(V[0]=192|(K&1984)>>>6,V[1]=128|K&63):V[0]=K,this.parsedData.push(V)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}t.prototype={getLength:function(E){return this.parsedData.length},write:function(E){for(var D=0,N=this.parsedData.length;D<N;D++)E.put(this.parsedData[D],8)}};function n(E,D){this.typeNumber=E,this.errorCorrectLevel=D,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}n.prototype={addData:function(E){var D=new t(E);this.dataList.push(D),this.dataCache=null},isDark:function(E,D){if(E<0||this.moduleCount<=E||D<0||this.moduleCount<=D)throw new Error(E+","+D);return this.modules[E][D]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(E,D){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var N=0;N<this.moduleCount;N++){this.modules[N]=new Array(this.moduleCount);for(var V=0;V<this.moduleCount;V++)this.modules[N][V]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(E,D),this.typeNumber>=7&&this.setupTypeNumber(E),this.dataCache==null&&(this.dataCache=n.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,D)},setupPositionProbePattern:function(E,D){for(var N=-1;N<=7;N++)if(!(E+N<=-1||this.moduleCount<=E+N))for(var V=-1;V<=7;V++)D+V<=-1||this.moduleCount<=D+V||(0<=N&&N<=6&&(V==0||V==6)||0<=V&&V<=6&&(N==0||N==6)||2<=N&&N<=4&&2<=V&&V<=4?this.modules[E+N][D+V]=!0:this.modules[E+N][D+V]=!1)},getBestMaskPattern:function(){for(var E=0,D=0,N=0;N<8;N++){this.makeImpl(!0,N);var V=a.getLostPoint(this);(N==0||E>V)&&(E=V,D=N)}return D},createMovieClip:function(E,D,N){var V=E.createEmptyMovieClip(D,N),K=1;this.make();for(var j=0;j<this.modules.length;j++)for(var Z=j*K,tt=0;tt<this.modules[j].length;tt++){var rt=tt*K,J=this.modules[j][tt];J&&(V.beginFill(0,100),V.moveTo(rt,Z),V.lineTo(rt+K,Z),V.lineTo(rt+K,Z+K),V.lineTo(rt,Z+K),V.endFill())}return V},setupTimingPattern:function(){for(var E=8;E<this.moduleCount-8;E++)this.modules[E][6]==null&&(this.modules[E][6]=E%2==0);for(var D=8;D<this.moduleCount-8;D++)this.modules[6][D]==null&&(this.modules[6][D]=D%2==0)},setupPositionAdjustPattern:function(){for(var E=a.getPatternPosition(this.typeNumber),D=0;D<E.length;D++)for(var N=0;N<E.length;N++){var V=E[D],K=E[N];if(this.modules[V][K]==null)for(var j=-2;j<=2;j++)for(var Z=-2;Z<=2;Z++)j==-2||j==2||Z==-2||Z==2||j==0&&Z==0?this.modules[V+j][K+Z]=!0:this.modules[V+j][K+Z]=!1}},setupTypeNumber:function(E){for(var D=a.getBCHTypeNumber(this.typeNumber),N=0;N<18;N++){var V=!E&&(D>>N&1)==1;this.modules[Math.floor(N/3)][N%3+this.moduleCount-8-3]=V}for(var N=0;N<18;N++){var V=!E&&(D>>N&1)==1;this.modules[N%3+this.moduleCount-8-3][Math.floor(N/3)]=V}},setupTypeInfo:function(E,D){for(var N=this.errorCorrectLevel<<3|D,V=a.getBCHTypeInfo(N),K=0;K<15;K++){var j=!E&&(V>>K&1)==1;K<6?this.modules[K][8]=j:K<8?this.modules[K+1][8]=j:this.modules[this.moduleCount-15+K][8]=j}for(var K=0;K<15;K++){var j=!E&&(V>>K&1)==1;K<8?this.modules[8][this.moduleCount-K-1]=j:K<9?this.modules[8][15-K-1+1]=j:this.modules[8][15-K-1]=j}this.modules[this.moduleCount-8][8]=!E},mapData:function(E,D){for(var N=-1,V=this.moduleCount-1,K=7,j=0,Z=this.moduleCount-1;Z>0;Z-=2)for(Z==6&&Z--;;){for(var tt=0;tt<2;tt++)if(this.modules[V][Z-tt]==null){var rt=!1;j<E.length&&(rt=(E[j]>>>K&1)==1);var J=a.getMask(D,V,Z-tt);J&&(rt=!rt),this.modules[V][Z-tt]=rt,K--,K==-1&&(j++,K=7)}if(V+=N,V<0||this.moduleCount<=V){V-=N,N=-N;break}}}},n.PAD0=236,n.PAD1=17,n.createData=function(E,D,N){for(var V=l.getRSBlocks(E,D),K=new h,j=0;j<N.length;j++){var Z=N[j];K.put(Z.mode,4),K.put(Z.getLength(),a.getLengthInBits(Z.mode,E)),Z.write(K)}for(var tt=0,j=0;j<V.length;j++)tt+=V[j].dataCount;if(K.getLengthInBits()>tt*8)throw new Error("code length overflow. ("+K.getLengthInBits()+">"+tt*8+")");for(K.getLengthInBits()+4<=tt*8&&K.put(0,4);K.getLengthInBits()%8!=0;)K.putBit(!1);for(;!(K.getLengthInBits()>=tt*8||(K.put(n.PAD0,8),K.getLengthInBits()>=tt*8));)K.put(n.PAD1,8);return n.createBytes(K,V)},n.createBytes=function(E,D){for(var N=0,V=0,K=0,j=new Array(D.length),Z=new Array(D.length),tt=0;tt<D.length;tt++){var rt=D[tt].dataCount,J=D[tt].totalCount-rt;V=Math.max(V,rt),K=Math.max(K,J),j[tt]=new Array(rt);for(var U=0;U<j[tt].length;U++)j[tt][U]=255&E.buffer[U+N];N+=rt;var G=a.getErrorCorrectPolynomial(J),I=new u(j[tt],G.getLength()-1),C=I.mod(G);Z[tt]=new Array(G.getLength()-1);for(var U=0;U<Z[tt].length;U++){var L=U+C.getLength()-Z[tt].length;Z[tt][U]=L>=0?C.get(L):0}}for(var B=0,U=0;U<D.length;U++)B+=D[U].totalCount;for(var O=new Array(B),q=0,U=0;U<V;U++)for(var tt=0;tt<D.length;tt++)U<j[tt].length&&(O[q++]=j[tt][U]);for(var U=0;U<K;U++)for(var tt=0;tt<D.length;tt++)U<Z[tt].length&&(O[q++]=Z[tt][U]);return O};for(var e={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},s={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(E){for(var D=E<<10;a.getBCHDigit(D)-a.getBCHDigit(a.G15)>=0;)D^=a.G15<<a.getBCHDigit(D)-a.getBCHDigit(a.G15);return(E<<10|D)^a.G15_MASK},getBCHTypeNumber:function(E){for(var D=E<<12;a.getBCHDigit(D)-a.getBCHDigit(a.G18)>=0;)D^=a.G18<<a.getBCHDigit(D)-a.getBCHDigit(a.G18);return E<<12|D},getBCHDigit:function(E){for(var D=0;E!=0;)D++,E>>>=1;return D},getPatternPosition:function(E){return a.PATTERN_POSITION_TABLE[E-1]},getMask:function(E,D,N){switch(E){case s.PATTERN000:return(D+N)%2==0;case s.PATTERN001:return D%2==0;case s.PATTERN010:return N%3==0;case s.PATTERN011:return(D+N)%3==0;case s.PATTERN100:return(Math.floor(D/2)+Math.floor(N/3))%2==0;case s.PATTERN101:return D*N%2+D*N%3==0;case s.PATTERN110:return(D*N%2+D*N%3)%2==0;case s.PATTERN111:return(D*N%3+(D+N)%2)%2==0;default:throw new Error("bad maskPattern:"+E)}},getErrorCorrectPolynomial:function(E){for(var D=new u([1],0),N=0;N<E;N++)D=D.multiply(new u([1,o.gexp(N)],0));return D},getLengthInBits:function(E,D){if(1<=D&&D<10)switch(E){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw new Error("mode:"+E)}else if(D<27)switch(E){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw new Error("mode:"+E)}else if(D<41)switch(E){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw new Error("mode:"+E)}else throw new Error("type:"+D)},getLostPoint:function(E){for(var D=E.getModuleCount(),N=0,V=0;V<D;V++)for(var K=0;K<D;K++){for(var j=0,Z=E.isDark(V,K),tt=-1;tt<=1;tt++)if(!(V+tt<0||D<=V+tt))for(var rt=-1;rt<=1;rt++)K+rt<0||D<=K+rt||tt==0&&rt==0||Z==E.isDark(V+tt,K+rt)&&j++;j>5&&(N+=3+j-5)}for(var V=0;V<D-1;V++)for(var K=0;K<D-1;K++){var J=0;E.isDark(V,K)&&J++,E.isDark(V+1,K)&&J++,E.isDark(V,K+1)&&J++,E.isDark(V+1,K+1)&&J++,(J==0||J==4)&&(N+=3)}for(var V=0;V<D;V++)for(var K=0;K<D-6;K++)E.isDark(V,K)&&!E.isDark(V,K+1)&&E.isDark(V,K+2)&&E.isDark(V,K+3)&&E.isDark(V,K+4)&&!E.isDark(V,K+5)&&E.isDark(V,K+6)&&(N+=40);for(var K=0;K<D;K++)for(var V=0;V<D-6;V++)E.isDark(V,K)&&!E.isDark(V+1,K)&&E.isDark(V+2,K)&&E.isDark(V+3,K)&&E.isDark(V+4,K)&&!E.isDark(V+5,K)&&E.isDark(V+6,K)&&(N+=40);for(var U=0,K=0;K<D;K++)for(var V=0;V<D;V++)E.isDark(V,K)&&U++;var G=Math.abs(100*U/D/D-50)/5;return N+=G*10,N}},o={glog:function(E){if(E<1)throw new Error("glog("+E+")");return o.LOG_TABLE[E]},gexp:function(E){for(;E<0;)E+=255;for(;E>=256;)E-=255;return o.EXP_TABLE[E]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},r=0;r<8;r++)o.EXP_TABLE[r]=1<<r;for(var r=8;r<256;r++)o.EXP_TABLE[r]=o.EXP_TABLE[r-4]^o.EXP_TABLE[r-5]^o.EXP_TABLE[r-6]^o.EXP_TABLE[r-8];for(var r=0;r<255;r++)o.LOG_TABLE[o.EXP_TABLE[r]]=r;function u(E,D){if(E.length==null)throw new Error(E.length+"/"+D);for(var N=0;N<E.length&&E[N]==0;)N++;this.num=new Array(E.length-N+D);for(var V=0;V<E.length-N;V++)this.num[V]=E[V+N]}u.prototype={get:function(E){return this.num[E]},getLength:function(){return this.num.length},multiply:function(E){for(var D=new Array(this.getLength()+E.getLength()-1),N=0;N<this.getLength();N++)for(var V=0;V<E.getLength();V++)D[N+V]^=o.gexp(o.glog(this.get(N))+o.glog(E.get(V)));return new u(D,0)},mod:function(E){if(this.getLength()-E.getLength()<0)return this;for(var D=o.glog(this.get(0))-o.glog(E.get(0)),N=new Array(this.getLength()),V=0;V<this.getLength();V++)N[V]=this.get(V);for(var V=0;V<E.getLength();V++)N[V]^=o.gexp(o.glog(E.get(V))+D);return new u(N,0).mod(E)}};function l(E,D){this.totalCount=E,this.dataCount=D}l.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],l.getRSBlocks=function(E,D){var N=l.getRsBlockTable(E,D);if(N==null)throw new Error("bad rs block @ typeNumber:"+E+"/errorCorrectLevel:"+D);for(var V=N.length/3,K=[],j=0;j<V;j++)for(var Z=N[j*3+0],tt=N[j*3+1],rt=N[j*3+2],J=0;J<Z;J++)K.push(new l(tt,rt));return K},l.getRsBlockTable=function(E,D){switch(D){case i.L:return l.RS_BLOCK_TABLE[(E-1)*4+0];case i.M:return l.RS_BLOCK_TABLE[(E-1)*4+1];case i.Q:return l.RS_BLOCK_TABLE[(E-1)*4+2];case i.H:return l.RS_BLOCK_TABLE[(E-1)*4+3];default:return}};function h(){this.buffer=[],this.length=0}h.prototype={get:function(E){var D=Math.floor(E/8);return(this.buffer[D]>>>7-E%8&1)==1},put:function(E,D){for(var N=0;N<D;N++)this.putBit((E>>>D-N-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(E){var D=Math.floor(this.length/8);this.buffer.length<=D&&this.buffer.push(0),E&&(this.buffer[D]|=128>>>this.length%8),this.length++}};var f=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function d(){return typeof CanvasRenderingContext2D!="undefined"}function p(){var E=!1,D=navigator.userAgent;if(/android/i.test(D)){E=!0;var N=D.toString().match(/android ([0-9]\.[0-9])/i);N&&N[1]&&(E=parseFloat(N[1]))}return E}var b=function(){var E=function(D,N){this._el=D,this._htOption=N};return E.prototype.draw=function(D){var N=this._htOption,V=this._el,K=D.getModuleCount();Math.floor(N.width/K),Math.floor(N.height/K),this.clear();function j(U,G){var I=document.createElementNS("http://www.w3.org/2000/svg",U);for(var C in G)G.hasOwnProperty(C)&&I.setAttribute(C,G[C]);return I}var Z=j("svg",{viewBox:"0 0 "+String(K)+" "+String(K),width:"100%",height:"100%",fill:N.colorLight});Z.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),V.appendChild(Z),Z.appendChild(j("rect",{fill:N.colorLight,width:"100%",height:"100%"})),Z.appendChild(j("rect",{fill:N.colorDark,width:"1",height:"1",id:"template"}));for(var tt=0;tt<K;tt++)for(var rt=0;rt<K;rt++)if(D.isDark(tt,rt)){var J=j("use",{x:String(rt),y:String(tt)});J.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),Z.appendChild(J)}},E.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},E}(),v=document.documentElement.tagName.toLowerCase()==="svg",x=v?b:d()?function(){function E(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function D(V,K){var j=this;if(j._fFail=K,j._fSuccess=V,j._bSupportDataURI===null){var Z=document.createElement("img"),tt=function(){j._bSupportDataURI=!1,j._fFail&&j._fFail.call(j)},rt=function(){j._bSupportDataURI=!0,j._fSuccess&&j._fSuccess.call(j)};Z.onabort=tt,Z.onerror=tt,Z.onload=rt,Z.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==";return}else j._bSupportDataURI===!0&&j._fSuccess?j._fSuccess.call(j):j._bSupportDataURI===!1&&j._fFail&&j._fFail.call(j)}var N=function(V,K){this._bIsPainted=!1,this._android=p(),this._htOption=K,V&&(this._elCanvas=document.createElement("canvas"),this._elCanvas.width=K.width,this._elCanvas.height=K.height,V.appendChild(this._elCanvas),this._el=V,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null)};return N.prototype.draw=function(V){var K=this._elImage,j=this._oContext,Z=this._htOption,tt=V.getModuleCount(),rt=Z.width/tt,J=Z.height/tt,U=Math.round(rt),G=Math.round(J);K.style.display="none",this.clear();for(var I=0;I<tt;I++)for(var C=0;C<tt;C++){var L=V.isDark(I,C),B=C*rt,O=I*J;j.strokeStyle=L?Z.colorDark:Z.colorLight,j.lineWidth=1,j.fillStyle=L?Z.colorDark:Z.colorLight,j.fillRect(B,O,rt,J),j.strokeRect(Math.floor(B)+.5,Math.floor(O)+.5,U,G),j.strokeRect(Math.ceil(B)-.5,Math.ceil(O)-.5,U,G)}this._bIsPainted=!0},N.prototype.drawMxcadHatch=function(V){const K=[];for(var j=this._htOption,Z=V.getModuleCount(),tt=j.width/Z,rt=j.height/Z,J=0;J<Z;J++)for(var U=0;U<Z;U++){var G=V.isDark(J,U),I=U*tt,C=J*rt;if(G){const L=new A.McGePoint3d(I,C,0),B=A.McGeVector3d.kYAxis.clone().negate().mult(rt),O=A.McGeVector3d.kXAxis.clone().mult(tt),q=L.clone().addvec(B),it=L.clone().addvec(O),nt=L.clone().addvec(O).addvec(B),lt=new A.McDbHatch,ut=new A.McGePoint3dArray([L,q,nt,it]);lt.appendLoop(ut),K.push(lt)}}return K},N.prototype.makeImage=function(){this._bIsPainted&&D.call(this,E)},N.prototype.isPainted=function(){return this._bIsPainted},N.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},N.prototype.round=function(V){return V&&Math.floor(V*1e3)/1e3},N}():function(){var E=function(D,N){this._el=D,this._htOption=N};return E.prototype.draw=function(D){for(var N=this._htOption,V=this._el,K=D.getModuleCount(),j=Math.floor(N.width/K),Z=Math.floor(N.height/K),tt=['<table style="border:0;border-collapse:collapse;">'],rt=0;rt<K;rt++){tt.push("<tr>");for(var J=0;J<K;J++)tt.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+j+"px;height:"+Z+"px;background-color:"+(D.isDark(rt,J)?N.colorDark:N.colorLight)+';"></td>');tt.push("</tr>")}tt.push("</table>"),V.innerHTML=tt.join("");var U=V.childNodes[0],G=(N.width-U.offsetWidth)/2,I=(N.height-U.offsetHeight)/2;G>0&&I>0&&(U.style.margin=I+"px "+G+"px")},E.prototype.clear=function(){this._el.innerHTML=""},E}();function w(E,D){for(var N=1,V=M(E),K=0,j=f.length;K<=j;K++){var Z=0;switch(D){case i.L:Z=f[K][0];break;case i.M:Z=f[K][1];break;case i.Q:Z=f[K][2];break;case i.H:Z=f[K][3];break}if(V<=Z)break;N++}if(N>f.length)throw new Error("Too long data");return N}function M(E){var D=encodeURI(E).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return D.length+(D.length!=E?3:0)}cc=function(E,D){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H},typeof D=="string"&&(D={text:D}),D)for(var N in D)this._htOption[N]=D[N];typeof E=="string"&&(E=document.getElementById(E)),this._htOption.useSVG&&(x=b),this._android=p(),this._el=E,this._oQRCode=null,this._oDrawing=new x(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},cc.prototype.makeCode=function(E){this._oQRCode=new n(w(E,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(E),this._oQRCode.make(),this._el.title=E,this._oDrawing.draw(this._oQRCode),this.makeImage()},cc.prototype.makeMxcadCode=function(E){return this._oQRCode=new n(w(E,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(E),this._oQRCode.make(),this._oDrawing.drawMxcadHatch(this._oQRCode)},cc.prototype.makeImage=function(){typeof this._oDrawing.makeImage=="function"&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},cc.prototype.clear=function(){this._oDrawing.clear()},cc.CorrectLevel=i})();class Ug extends A.McDbCustomEntity{constructor(n){super(n),this.position=new A.McGePoint3d,this.codeHeight=300,this.codeWidth=10,this.codeContent="https://demo.mxdraw3d.com:3000/mxcad/",this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Ug(n)}getTypeName(){return"McDbTestQrCode"}set qrCodePos(n){this.position=n.clone()}get qrCodePos(){return this.position}set qrCodeHeight(n){this.codeHeight=n}get qarCodeHeight(){return this.codeHeight}set qrCodeWidth(n){this.codeWidth=n}get qrCodeWidth(){return this.codeWidth}set qrCodeContent(n){this.codeContent=n}get qrCodeContent(){return this.codeContent}dwgInFields(n){return this.position=n.readPoint("position").val,this.codeWidth=n.readDouble("codeWidth").val,this.codeHeight=n.readDouble("codeHeight").val,this.codeContent=n.readString("codeContent").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("position",this.position),n.writeDouble("codeWidth",this.codeWidth),n.writeDouble("codeHeight",this.codeHeight),n.writeString("codeContent",this.codeContent),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0&&(this.position.x+=e,this.position.y+=i,this.position.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.position),n}worldDraw(n){const e=[];new cc("",{width:this.codeWidth,height:this.codeHeight}).makeMxcadCode(this.codeContent).forEach(a=>{const o=a.clone();o.move(new A.McGePoint3d(0,0,0),this.position),n.drawEntity(o),e.push(o)}),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}transformBy(n){return this.position.transformBy(n),!0}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function YB(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD();t.newFile();const n=new Ug;n.qrCodePos=new A.McGePoint3d(1e3,1e3,0),n.qrCodeContent="https://demo.mxdraw3d.com:3000/mxcad/",n.qrCodeWidth=1500,n.qrCodeHeight=1500,t.drawEntity(n),t.zoomAll()})}function KB(){new lc().rxInit(),new Ug().rxInit(),MxPluginContext.addCommand("Mx_TestDrawBarCode",XB),MxPluginContext.addCommand("Mx_TestdrawQrCode",YB)}function ZB(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请设置道路起点"));const n=yield t.go();if(!n)return;let e=n.clone();const i=30,s=20,a=A.MxCpp.getCurrentMxCAD(),o=a.getDatabase().getCurrentlyLayerName();for(;;){const r=new A.MxCADUiPrPoint;r.setMessage(dt("请设置下一点")),r.setBasePt(e),r.setUserDraw((h,f)=>{const d=new A.McDbLine(e,h);f.drawMcDbEntity(d);const p=e.sub(h).perpVector().normalize().mult(i),b=h.clone().addvec(p),v=h.clone().subvec(p);d.offsetCurves(i,b).forEach(x=>{f.drawMcDbEntity(x)}),d.offsetCurves(i,v).forEach(x=>{f.drawMcDbEntity(x)})});const u=yield r.go();if(!u)break;const l=new JB;l.startPt=e,l.endPt=u,l.drawRoads(),l.radius=s,e=u.clone()}a.getDatabase().setCurrentlyLayerName(o)})}class JB{constructor(){this.offsetDist=30,this.radius=20,this.startPt=new A.McGePoint3d,this.endPt=new A.McGePoint3d,this.mxcad=A.MxCpp.getCurrentMxCAD(),this.dTol=1e-4,this.setLayer=()=>{const n=this.mxcad.getDatabase().getLayerTable();if(!n.has("ROAD_DOTE")){const e=this.mxcad.addLayer("ROAD_DOTE");e.getMcDbLayerTableRecord().color=new A.McCmColor(255,0,0)}if(!n.has("ROAD")){const e=this.mxcad.addLayer("ROAD");e.getMcDbLayerTableRecord().color=new A.McCmColor(255,255,0)}},this.drawRoads=()=>{this.setLayer();const n=new A.McDbLine(this.startPt,this.endPt);this.mxcad.getDatabase().setCurrentlyLayerName("ROAD_DOTE");const e=this.mxcad.drawEntity(n);this.processingCross(e)},this.drawOffsetEntity=(n,e=!0)=>{if(!n.length)return;const i=[];return this.mxcad.getDatabase().setCurrentlyLayerName("ROAD"),n.forEach(s=>{const a=s.getPointAtDist(s.getLength().val/2).val,o=s.getEndPoint().val.sub(s.getStartPoint().val).perpVector().normalize().mult(this.offsetDist),r=a.clone().addvec(o),u=a.clone().subvec(o);s.offsetCurves(this.offsetDist,r).forEach(l=>{i.push(l),e&&this.mxcad.drawEntity(l)}),s.offsetCurves(this.offsetDist,u).forEach(l=>{i.push(l),e&&this.mxcad.drawEntity(l)})}),i}}processingCross(n){const e=n.getMcDbEntity(),i=e.startPoint,s=e.endPoint;this.assessTheSituation(i,s,n)}processingRoundedCorners(n,e,i,s,a=!0){const o={curveArr:[new A.McDbCurve],objId:new A.McObjectId},r=(Z,tt)=>{const rt=tt.distanceTo(Z.startPoint),J=tt.distanceTo(Z.endPoint);let U,G;return rt>J?(U=Z.endPoint.sub(Z.startPoint),G=new A.McDbLine(tt,Z.startPoint)):(U=Z.startPoint.sub(Z.endPoint),G=new A.McDbLine(tt,Z.endPoint)),{v:U,newLine:G}},u=n.IntersectWith(e,A.McDb.Intersect.kExtendBoth);if(u.length()!=1)return o;const l=u.at(0),{v:h,newLine:f}=r(n,l),{v:d,newLine:p}=r(e,l),b=h.angleTo2(d,A.McGeVector3d.kNegateZAxis);let v=i*Math.sin(Math.PI/2-b/2)/Math.sin(b/2);v<0&&(v=-v);const x=f.getPointAtDist(v).val,w=p.getPointAtDist(v).val,M=f.clone(),E=p.clone();f.startPoint=x,p.startPoint=w,M.rotate(x,Math.PI/2),E.rotate(w,Math.PI/2);const D=M.IntersectWith(E,A.McDb.Intersect.kExtendBoth);if(!D.length())return o;const N=D.at(0),K=new A.McDbLine(N,l).getPointAtDist(i).val;let j=new A.McDbArc;return j.computeArc(x.x,x.y,K.x,K.y,w.x,w.y),n.erase(),e.erase(),this.mxcad.getDatabase().setCurrentlyLayerName(s),this.mxcad.drawEntity(f),this.mxcad.drawEntity(j),a||(p.visible=!1),o.objId=this.mxcad.drawEntity(p),o.curveArr=[f,p,j],o}delectAllRoad(n,e=!0,i){if(!e&&!(i!=null&&i.length))return;const s=A.McGeVector3d.kXAxis.clone().mult(this.offsetDist+this.radius),a=A.McGeVector3d.kYAxis.clone().mult(this.offsetDist+this.radius),o=n.clone().addvec(s).addvec(a),r=n.clone().subvec(s).subvec(a),u=new A.MxCADResbuf;u.AddMcDbEntityTypes("LINE"),u.AddString("ROAD",8);const l=new A.MxCADSelectionSet;r.x>o.x?l.crossingSelect(r.x,r.y,o.x,o.y,u):l.crossingSelect(o.x,o.y,r.x,r.y,u),l.forEach(h=>{if(e)h.erase();else{const f=h.getMcDbEntity();i.forEach(d=>{const p=d.getStartPoint().val,b=d.getEndPoint().val,v=p.distanceTo(f.getClosestPointTo(p,!1).val),x=b.distanceTo(f.getClosestPointTo(b,!1).val),w=d.getPointAtDist(d.getLength().val/2).val;if(v<this.dTol){const M=w.sub(p),E=f.startPoint.sub(p),D=f.endPoint.sub(p);E.angleTo1(M)<Math.PI/2&&(f.startPoint=p),D.angleTo1(M)<Math.PI/2&&(f.endPoint=p)}else if(x<this.dTol){const M=w.sub(b),E=f.startPoint.sub(b),D=f.endPoint.sub(b);E.angleTo1(M)<Math.PI/2&&(f.startPoint=b),D.angleTo1(M)<Math.PI/2&&(f.endPoint=b)}})}})}assessTheSituation(n,e,i){const s=e.sub(n).normalize().mult(n.distanceTo(e)/5),a=s.angleTo1(A.McGeVector3d.kYAxis);(a<this.dTol||Math.abs(Math.PI-a)<this.dTol||Math.abs(a-Math.PI/2)<this.dTol)&&s.rotateBy(Math.PI/12);const o=n.clone().subvec(s),r=e.clone().addvec(s),u=new A.MxCADResbuf;u.AddString("ROAD_DOTE",8),u.AddMcDbEntityTypes("LINE");const l=new A.MxCADSelectionSet;l.crossingSelect(o.x,o.y,r.x,r.y,u);const h=i.getMcDbEntity();let f=0;if(l.count()<1)return this.drawOffsetEntity([h]);const d=[],p=[],b=[];if(l.forEach(v=>{if(v.id!=i.id){const x=v.getMcDbEntity(),w=x.IntersectWith(h,A.McDb.Intersect.kExtendBoth);if(w.length()===1){const M=w.at(0),E=M.distanceTo(h.getClosestPointTo(M,!1).val),D=M.distanceTo(x.getClosestPointTo(M,!1).val);if(E<this.dTol&&D<this.dTol){f+=1;const N=h.startPoint.distanceTo(M),V=h.endPoint.distanceTo(M),K=x.startPoint.distanceTo(M),j=x.endPoint.distanceTo(M);N>this.offsetDist&&V>this.offsetDist||K>this.offsetDist&&j>this.offsetDist?b.push(x):N<=this.offsetDist&&(K<=this.offsetDist||j<=this.offsetDist)?d.push(x):V<=this.offsetDist&&(K<=this.offsetDist||j<=this.offsetDist)&&p.push(x)}}}}),f||this.drawOffsetEntity([h]),d.length&&!b.length&&!p.length&&d.forEach(v=>{this.handleTheBeginningAndEnd(v,h,h.startPoint,"start")}),p.length&&!b.length&&!d.length&&p.forEach(v=>{this.handleTheBeginningAndEnd(v,h,h.endPoint,"end")}),p.length===1&&!b.length&&d.length===1){const v=this.handleTheBeginningAndEnd(d[0],h,h.startPoint,"start");setTimeout(()=>{if(!v.objId)return;const x=v.objId.getMcDbEntity();this.handleTheBeginningAndEnd(p[0],x,h.endPoint),v.objId.erase()},10)}if(b.length&&!d.length&&!p.length&&this.processingCrossingRoad(b,h),b.length&&d.length&&!p.length){let v=new A.McDbLine;d.forEach(x=>{const w=this.processingRoundedCorners(x,h,this.radius+this.offsetDist,"ROAD_DOTE"),M=this.drawOffsetEntity([w.curveArr[2]]);x.getxData().AtString(0).val==="isCrossingLine"?this.delectAllRoad(h.startPoint,!1,M):(this.drawOffsetEntity([w.curveArr[0]]),this.delectAllRoad(h.startPoint)),v=w.objId.getMcDbEntity(),v.setxData(new A.MxCADResbuf([{type:A.DxfCode.kExDataName,val:"isCrossingLine"},{type:A.DxfCode.kString,val:"1"}]))}),setTimeout(()=>{this.processingCrossingRoad(b,v)},10)}if(b.length&&!d.length&&p.length){let v=new A.McDbLine;p.forEach(x=>{const w=this.processingRoundedCorners(x,h,this.radius+this.offsetDist,"ROAD_DOTE"),M=this.drawOffsetEntity([w.curveArr[2]]);x.getxData().AtString(0).val==="isCrossingLine"?this.delectAllRoad(h.startPoint,!1,M):(this.drawOffsetEntity([w.curveArr[0]]),this.delectAllRoad(h.startPoint)),v=w.objId.getMcDbEntity(),v.setxData(new A.MxCADResbuf([{type:A.DxfCode.kExDataName,val:"isCrossingLine"},{type:A.DxfCode.kString,val:"1"}]))}),setTimeout(()=>{this.processingCrossingRoad(b,v)},10)}if(b.length&&d.length&&p.length){const v=this.handleTheBeginningAndEnd(d[0],h,h.startPoint);setTimeout(()=>{if(!v.objId)return;const x=v.objId.getMcDbEntity(),w=this.handleTheBeginningAndEnd(p[0],x,h.endPoint);v.objId.erase(),setTimeout(()=>{const M=w.objId.getMcDbEntity();this.processingCrossingRoad(b,M)})},10)}}crossRoundedCorners(n,e,i,s){const a=[];return e.forEach(o=>{const r=n.IntersectWith(o,A.McDb.Intersect.kOnBothOperands);if(r.length()>0){const u=r.at(0),l=u.sub(s),h=n.startPoint.sub(s),f=n.endPoint.sub(s),d=l.angleTo1(h),p=l.angleTo1(f);let b=new A.McDbLine;d<=Math.PI/2&&(b=new A.McDbLine(n.startPoint,u)),p<=Math.PI/2&&(b=new A.McDbLine(n.endPoint,u));const v=this.processingRoundedCorners(b,o,i,"ROAD",!1);a.push(v.curveArr[2])}}),a}getNewRoads(n,e,i){const s=A.McGeVector3d.kXAxis.clone().mult(this.offsetDist+this.radius),a=A.McGeVector3d.kYAxis.clone().mult(this.offsetDist+this.radius),o=n.clone().addvec(s).addvec(a),r=n.clone().subvec(s).subvec(a),u=new A.MxCADResbuf;u.AddMcDbEntityTypes("LINE"),u.AddString("ROAD",8);const l=new A.MxCADSelectionSet;l.crossingSelect(r.x,r.y,o.x,o.y,u);let h=new A.McDbLine,f=[],d=new A.McGePoint3d;l.forEach(b=>{const v=b.getMcDbEntity();v.getClosestPointTo(n,!1).val.sub(n).angleTo1(e)<Math.PI/2&&(h=v,f=this.drawOffsetEntity([i],!1),d=i.startPoint,v.highlight(!0))});const p=this.crossRoundedCorners(h,f,this.radius,d);return h.erase(),p}handleTheBeginningAndEnd(n,e,i,s){const a=this.processingRoundedCorners(n,e,this.radius+this.offsetDist,"ROAD_DOTE");if(n.getxData().AtString(0).val==="isCrossingLine"){s&&s=="start"&&this.drawOffsetEntity([a.curveArr[1]]),s&&s==="end"&&this.drawOffsetEntity([a.curveArr[0]]);const o=this.drawOffsetEntity([a.curveArr[2]]);return this.delectAllRoad(i,!1,o),a}else return this.drawOffsetEntity(a.curveArr),this.delectAllRoad(i),a}processingCrossingRoad(n,e){const i=(f,d,p)=>{f.forEach(b=>{const v=b.getStartPoint().val,x=b.getEndPoint().val,w=v.sub(d),M=x.sub(d),E=w.angleTo1(p),D=M.angleTo1(p);E<D?s([v],p):s([x],p)})},s=(f,d)=>{if(!r.length)r.push(...f);else{const p=f[0].sub(r[0]);p.angleTo1(d)<this.dTol||Math.abs(Math.PI-p.angleTo1(d))<this.dTol?r.push(...f):u.push(...f)}},a=this.drawOffsetEntity([e],!1),o=e.endPoint.sub(e.startPoint),r=[],u=[];let l=[];if(e.setxData(new A.MxCADResbuf([{type:A.DxfCode.kExDataName,val:"isCrossingLine"},{type:A.DxfCode.kString,val:"1"}])),n.forEach(f=>{f.setxData(new A.MxCADResbuf([{type:A.DxfCode.kExDataName,val:"isCrossingLine"},{type:A.DxfCode.kString,val:"1"}]));const d=f.IntersectWith(e,A.McDb.Intersect.kExtendBoth).at(0),p=e.startPoint.sub(d),b=e.endPoint.sub(d),v=new A.McDbLine(d,e.startPoint),x=new A.McDbLine(d,e.endPoint),w=d.distanceTo(e.startPoint)>this.dTol?this.getNewRoads(d,p,v):[],M=d.distanceTo(e.endPoint)>this.dTol?this.getNewRoads(d,b,x):[];w.length&&M.length&&w.forEach(E=>{const D=E.getStartPoint().val,N=E.getEndPoint().val,V=D.distanceTo(e.getClosestPointTo(D,!0).val),K=N.distanceTo(e.getClosestPointTo(N,!0).val);M.forEach(j=>{const Z=j.getStartPoint().val,tt=Z.distanceTo(e.getClosestPointTo(Z,!0).val);if(Math.abs(tt-this.offsetDist)<this.dTol){if(Math.abs(V-this.offsetDist)<this.dTol){const U=Z.sub(D);(U.angleTo1(o)<this.dTol||Math.abs(Math.PI-U.angleTo1(o))<this.dTol)&&s([Z,D],o)}if(Math.abs(K-this.offsetDist)<this.dTol){const U=Z.sub(N);(U.angleTo1(o)<this.dTol||Math.abs(Math.PI-U.angleTo1(o))<this.dTol)&&s([Z,N],o)}}const rt=j.getEndPoint().val,J=rt.distanceTo(e.getClosestPointTo(rt,!0).val);if(Math.abs(J-this.offsetDist)<this.dTol){if(Math.abs(V-this.offsetDist)<this.dTol){const U=rt.sub(D);(U.angleTo1(o)<this.dTol||Math.abs(Math.PI-U.angleTo1(o))<this.dTol)&&s([rt,D],o)}if(Math.abs(K-this.offsetDist)<this.dTol){const U=rt.sub(N);(U.angleTo1(o)<this.dTol||Math.abs(Math.PI-U.angleTo1(o))<this.dTol)&&s([rt,N],o)}}})}),w.length&&!M.length&&(i(w,d,p),l.push("end")),!w.length&&M.length&&(i(M,d,b),l.push("start"))}),!r.length||!u.length)return;const h=r[0].sub(a[0].getStartPoint().val);o.angleTo1(h)<this.dTol||Math.abs(Math.PI-o.angleTo1(h))<this.dTol?(this.countCrossRoadPt(a[0],r,l),this.countCrossRoadPt(a[1],u,l)):(this.countCrossRoadPt(a[1],r,l),this.countCrossRoadPt(a[0],u,l)),this.recombinationPtArr(r).forEach((f,d)=>{if(d%2===0){const p=new A.McDbLine(f,r[d+1]);this.mxcad.drawEntity(p)}}),this.recombinationPtArr(u).forEach((f,d)=>{if(d%2===0){const p=new A.McDbLine(f,u[d+1]);this.mxcad.drawEntity(p)}})}countCrossRoadPt(n,e,i){const s=n.getStartPoint().val,a=n.getEndPoint().val,o=s.distanceTo(e[0]),r=s.distanceTo(e[e.length-1]);o<r?((!i.length||!i.includes("start"))&&e.unshift(s),(!i.length||!i.includes("end"))&&e.push(a)):((!i.length||!i.includes("start"))&&e.push(s),(!i.length||!i.includes("end"))&&e.unshift(a))}recombinationPtArr(n){return n.sort((e,i)=>e.distanceTo(n[0])-i.distanceTo(n[0])),n}}function $B(){MxPluginContext.addCommand("Mx_drawRoads",ZB)}function QB(){return re(this,null,function*(){const t=new A.MxCADUiPrInt;t.setMessage(dt(" 请输入星形顶点数："));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrPoint;e.setMessage(dt(" 指定星形中心点:"));const i=yield e.go();if(!i)return;const s=new A.MxCADUiPrDist;s.setBasePt(i),s.setMessage(dt("请设置星形的内半径:"));const a=yield s.go();let o;a?o=s.value():o=5;const r=new A.McDbCircle(i.x,i.y,i.z,o);let u=[];const l=new A.MxCADUiPrDist;if(l.setBasePt(i),l.setMessage(dt(" 指定星形的外半径:")),l.setUserDraw((p,b)=>{let v=new A.McDbCircle(i.x,i.y,i.z,p.distanceTo(i)),x=r.getLength(),w=v.getLength();if(!x||!w)return;let M=[];for(let D=0;D<n*2;D++){let N=r.getPointAtDist(x.val/(n*2)*D);if(!N.ret)return;let V=v.getPointAtDist(w.val/(n*2)*D);if(!V.ret)return;D%2===0?M.push(N.val):M.push(V.val)}let E=new A.McDbPolyline;M.forEach(D=>{E.addVertexAt(D)}),E.isClosed=!0,b.drawMcDbEntity(E),u=[...M]}),!(yield l.go()))return;let f=A.MxCpp.getCurrentMxCAD(),d=new A.McDbPolyline;u.forEach(p=>{d.addVertexAt(p)}),d.isClosed=!0,f.drawEntity(d)})}function tF(){return re(this,null,function*(){let t=5;const n=new A.MxCADUiPrDist;n.setMessage(dt(" 请输入凹凸线宽度<5>")),(yield n.go())&&(t=n.value());let i=10;const s=new A.MxCADUiPrDist;s.setMessage(dt(" 请输入凹凸线高度<10>")),(yield s.go())&&(i=s.value());let o=new A.MxCADUiPrPoint;o.setMessage(dt("请点击确定起始点"));let r=yield o.go();if(!r)return;let u=new A.MxCADUiPrPoint;u.setMessage(dt("请点击确定终点")),u.setUserDraw((tt,rt)=>{let J=new A.McDbLine(r.x,r.y,r.z,tt.x,tt.y,tt.z);rt.drawMcDbEntity(J)});let l=yield u.go();if(!l)return;let h=new A.McDbLine(r.x,r.y,r.z,l.x,l.y,l.z),f=h.clone(),d=h.getLength(),p=h.getPointAtDist(d.val/2).val,b=A.McGeVector3d.kYAxis.angleTo1(A.McGeVector3d.kXAxis);f.rotate(p,b);let v=f.getPointAtDist(d.val/2+i/2).val,x=f.getPointAtDist(d.val/2-i/2).val,w=h.offsetCurves(i/2,v),M=h.offsetCurves(i/2,x),E=A.MxCpp.App.getCurrentMxCAD();if(w.length()===0||M.length()===0)return;let D,N;w.forEach(tt=>{D=tt.clone()}),M.forEach(tt=>{N=tt.clone()});let V=[],K=d.val/t;for(let tt=0;tt<K;tt++)tt%2===0?(V.push(D.getPointAtDist(t*tt).val),V.push(N.getPointAtDist(t*tt).val)):(V.push(N.getPointAtDist(t*tt).val),V.push(D.getPointAtDist(t*tt).val));let j=new A.McDbPolyline;V.forEach(tt=>{j.addVertexAt(tt)});let Z=h.getPointAtDist(t*parseInt(K.toString())).val;j.setPointAt(0,h.startPoint),j.setPointAt(V.length-1,Z),E.drawEntity(j)})}function eF(){return re(this,null,function*(){let t=5;const n=new A.MxCADUiPrDist;n.setMessage(dt(" 请输入锯齿线宽度<5>")),(yield n.go())&&(t=n.value());let i=10;const s=new A.MxCADUiPrDist;s.setMessage(dt(" 请输入锯齿线高度<10>")),(yield s.go())&&(i=s.value());let o=new A.MxCADUiPrPoint;o.setMessage(dt("请点击确定起始点"));let r=yield o.go();if(!r)return;let u=new A.MxCADUiPrPoint;u.setMessage(dt("请点击确定终点")),u.setUserDraw((tt,rt)=>{let J=new A.McDbLine(r.x,r.y,r.z,tt.x,tt.y,tt.z);rt.drawMcDbEntity(J)});let l=yield u.go();if(!l)return;let h=new A.McDbLine(r.x,r.y,r.z,l.x,l.y,l.z),f=h.clone(),d=h.getLength(),p=h.getPointAtDist(d.val/2).val,b=A.McGeVector3d.kYAxis.angleTo1(A.McGeVector3d.kXAxis);f.rotate(p,b);let v=f.getPointAtDist(d.val/2+i/2).val,x=f.getPointAtDist(d.val/2-i/2).val,w=h.offsetCurves(i/2,v),M=h.offsetCurves(i/2,x),E=A.MxCpp.App.getCurrentMxCAD();if(w.length()===0||M.length()===0)return;let D,N;w.forEach(tt=>{D=tt.clone()}),M.forEach(tt=>{N=tt.clone()});let V=[],K=d.val/(t/2);for(let tt=0;tt<K;tt++)tt%2===0?V.push(D.getPointAtDist(t/2*tt).val):V.push(N.getPointAtDist(t/2*tt).val);let j=new A.McDbPolyline;V.forEach(tt=>{j.addVertexAt(tt)});let Z=h.getPointAtDist(t/2*parseInt(K.toString())).val;j.setPointAt(0,h.startPoint),j.setPointAt(V.length-1,Z),E.drawEntity(j)})}function nF(){return re(this,null,function*(){let t=5;const n=new A.MxCADUiPrDist;n.setMessage(dt(" 请输入矩形宽度<5>")),(yield n.go())&&(t=n.value());let i=10;const s=new A.MxCADUiPrDist;s.setMessage(dt(" 请输入矩形高度<10>")),(yield s.go())&&(i=s.value());const o=d=>{const p=[];return p.push(new A.McGePoint3d(d.x+t/2,d.y+i/2,d.z)),p.push(new A.McGePoint3d(d.x-t/2,d.y+i/2,d.z)),p.push(new A.McGePoint3d(d.x-t/2,d.y-i/2,d.z)),p.push(new A.McGePoint3d(d.x+t/2,d.y-i/2,d.z)),p},r=new A.MxCADUiPrPoint;r.setMessage(dt("请点击确定矩形中心")),r.setUserDraw((d,p)=>{const b=o(d);let v=new A.McDbPolyline;b.forEach(x=>{v.addVertexAt(x)}),v.isClosed=!0,p.drawMcDbEntity(v)});const u=yield r.go();if(!u)return;const l=o(u);let h=new A.McDbPolyline;l.forEach(d=>{h.addVertexAt(d)});const f=A.MxCpp.App.getCurrentMxCAD();h.isClosed=!0,f.drawEntity(h)})}function rF(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("CIRCLE");let n=yield A.MxCADUtility.userSelect(dt("选择目标对象"),t);n.length!=0&&n.forEach(e=>re(this,null,function*(){let i=yield e.getMcDbEntity(),s=i.center,a=i.radius,o=A.MxCpp.App.getCurrentMxCAD(),r=new A.McDbLine(s.x+a*1.3,s.y,s.z,s.x-a*1.3,s.y,s.z);r.trueColor=new A.McCmColor(255,0,0);let u=new A.McDbLine(s.x,s.y+a*1.3,s.z,s.x,s.y-a*1.3,s.z);u.trueColor=new A.McCmColor(255,0,0),o.drawEntity(r),o.drawEntity(u)}))})}function iF(){return re(this,null,function*(){let t=10;const n=new A.MxCADUiPrDist;n.setMessage(dt(" 请输入管径<10>")),(yield n.go())&&(t=n.value());let i=10;const s=new A.MxCADUiPrDist;s.setMessage(dt(" 请输入长出管口长度<5>")),(yield s.go())&&(i=s.value());let o=new A.MxCADUiPrPoint;o.setMessage(dt("请点击确定起点"));const r=yield o.go();if(!r)return;const u=new A.MxCADUiPrPoint;u.setMessage(dt("请点击确定终点")),u.setUserDraw((N,V)=>{const K=new A.McDbLine(r.x,r.y,r.z,N.x,N.y,N.z);V.drawMcDbEntity(K)});const l=yield u.go();if(!l)return;const h=new A.McDbLine(r.x,r.y,r.z,l.x,l.y,l.z),f=A.MxCpp.App.getCurrentMxCAD();let d=h.getLength().val,p=h.getPointAtDist(d+i),b=h.getPointAtDist(0-i),v=h.getPointAtDist(d/2).val,x=A.McGeVector3d.kXAxis.angleTo1(A.McGeVector3d.kYAxis),w=h.clone();w.rotate(v,x);let M=w.getPointAtDist(d/2+t/2).val,E=w.getPointAtDist(d/2-t/2).val;h.offsetCurves(t/2,M).forEach(N=>{N.trueColor=new A.McCmColor(0,255,0),f.drawEntity(N)}),h.offsetCurves(t/2,E).forEach(N=>{N.trueColor=new A.McCmColor(0,255,0),f.drawEntity(N)});let D=f.addLinetypeEx("TestMyLine","25,-5");D.isValid()&&(h.linetypeId=D,h.endPoint=b.val,h.startPoint=p.val,h.trueColor=new A.McCmColor(255,0,0),f.drawEntity(h))})}function oF(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("指定剖管线起点"));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrPoint;e.setMessage(dt("指定剖管线终点")),e.setUserDraw((N,V)=>{let K=new A.McDbLine(n.x,n.y,n.z,N.x,N.y,N.z);V.drawMcDbEntity(K)});const i=yield e.go();if(!i)return;const s=new A.McDbLine(n.x,n.y,n.z,i.x,i.y,i.z),a=s.getLength().val,o=a/8,r=s.getPointAtDist(a/2).val,u=s.clone();u.rotate(r,Math.PI/2);const l=u.getPointAtDist(a/2+o).val,h=u.getPointAtDist(a/2-o).val,f=A.MxCpp.App.getCurrentMxCAD();let d;s.clone().offsetCurves(o,l).forEach(N=>{d=N});let p;s.clone().offsetCurves(o,h).forEach(N=>{p=N});const b=[],v=[];for(let N=0;N<4;N++)N%2!==0&&(b.push(d.getPointAtDist(N*o*2).val),v.push(p.getPointAtDist(N*o*2).val));let x,w=new A.McDbArc;w.computeArc(n.x,n.y,b[0].x,b[0].y,r.x,r.y),f.drawEntity(w);let M=new A.McDbArc;M.computeArc(n.x,n.y,v[0].x,v[0].y,r.x,r.y),f.drawEntity(M);let E=new A.McDbArc;E.computeArc(r.x,r.y,v[1].x,v[1].y,i.x,i.y),x=f.drawEntity(E);let D=new A.MxCADUiPrKeyWord;for(;;){D.setMessage(dt("选择剖管线圆弧方向")),D.setKeyWords(`[${dt("左边")}(L)/${dt("右边")}(R)]`);const N=yield D.go();if(!N)return;if(N=="L"){let V=new A.McDbArc;x.erase(),V.computeArc(r.x,r.y,v[1].x,v[1].y,i.x,i.y),x=f.drawEntity(V)}else if(N=="R"){x.erase();let V=new A.McDbArc;V.computeArc(r.x,r.y,b[1].x,b[1].y,i.x,i.y),x=f.drawEntity(V)}}})}function sF(){return re(this,null,function*(){const t=new A.MxCADUiPrKeyWord;t.setMessage(dt("选择模式")),t.setKeyWords(`[${dt("直线焊缝")}(L)/${dt("弧线焊缝")}(A)]`);const n=yield t.go();if(!n)return;let e=5;const i=new A.MxCADUiPrDist;i.setMessage(dt(" 请输入焊缝半径<5>")),(yield i.go())&&(e=i.value());let a=new A.McDbCurve;if(n==="L"){let d=new A.MxCADUiPrPoint;d.setMessage(dt("请点击确定起始点"));let p=yield d.go();if(!p)return;let b=new A.MxCADUiPrPoint;b.setMessage(dt("请点击确定终点")),b.setUserDraw((x,w)=>{let M=new A.McDbLine(p.x,p.y,p.z,x.x,x.y,x.z);w.drawMcDbEntity(M)});let v=yield b.go();if(!v)return;a=new A.McDbLine(p.x,p.y,p.z,v.x,v.y,v.z)}else if(n==="A"){let d=new A.MxCADUiPrPoint;d.setMessage(dt("指定起点"));let p=yield d.go();if(!p)return;let b=new A.MxCADUiPrPoint;b.setMessage(dt("指定圆弧的第二个点")),b.setUserDraw((E,D)=>{D.drawLine(p.toVector3(),E.toVector3())});let v=yield b.go();if(!v)return;let x=new A.MxCADUiPrPoint;x.setMessage(dt("指定圆弧的端点")),x.setUserDraw((E,D)=>{let N=new A.McDbArc;N.computeArc(p.x,p.y,v.x,v.y,E.x,E.y),D.drawMcDbEntity(N)});let w=yield x.go();if(!w)return;let M=new A.McDbArc;M.computeArc(p.x,p.y,v.x,v.y,w.x,w.y),a=M}const o=A.MxCpp.App.getCurrentMxCAD();let u=a.getLength().val/e,l=[],h,f;n==="A"&&(h=a.center,f=a.radius);for(let d=0;d<u;d++){let p=a.getPointAtDist(e*d).val,b=new A.McDbCircle(p.x,p.y,p.z,e);const v=b.IntersectWith(a,A.McDb.Intersect.kExtendBoth);if(!v.length())return;let x=[];v.forEach(E=>{x.push(E)});let w=[],M=[];b.splitCurves(x).forEach((E,D)=>{if(n==="L")D%2!==0&&l.push(E);else if(n==="A"){let N=E.clone();N.getPointAtDist(N.getLength().val/2).val.distanceTo(h)>f?w.push(N):M.push(N)}}),w.length===1&&n==="A"?l.push(w[0]):n==="A"&&w.length>1&&(M[0].rotate(b.center,Math.PI),l.push(M[0]))}l.forEach((d,p)=>{if(p===0)o.drawEntity(d);else{let b=d.IntersectWith(l[p-1],A.McDb.Intersect.kExtendThis);if(b.length()===0)return;let v=[];b.forEach(M=>{v.push(M)});let x=[];d.splitCurves(v).forEach((M,E)=>{x.push({obj_cur:M,lenth:M.getLength().val})});let w=x.map(M=>M.lenth);o.drawEntity(x[w.indexOf(Math.max(...w))].obj_cur)}})})}function aF(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LINE,LWPOLYLINE");let n=yield A.MxCADUtility.userSelect(dt("选择对象"),t);n.length!=0&&n.forEach(e=>re(this,null,function*(){let i=yield e.getMcDbEntity();if(!i)return;let s=i.clone(),a=s.getLength(),o=s.getPointAtDist(a.val/2).val;if(!s.getFirstDeriv(o).ret)return;let u=A.McGeVector3d.kYAxis.angleTo1(A.McGeVector3d.kXAxis);s.rotate(o,u);let l=A.MxCpp.App.getCurrentMxCAD();s.trueColor=new A.McCmColor(255,0,0),l.drawEntity(s)}))})}function lF(){return re(this,null,function*(){let t=25;const n=new A.MxCADUiPrDist;n.setMessage(dt("请输入宽度<25>")),(yield n.go())&&(t=n.value());let i=15;const s=new A.MxCADUiPrDist;s.setMessage(dt("请输入高度<15>")),(yield s.go())&&(i=s.value());const o=new A.MxCADUiPrInt;o.setMessage(dt("请输入楼梯级数<10>"));const r=(yield o.go())||10,u=Math.sqrt(t*t+i*i),l=new A.MxCADUiPrPoint;l.setMessage(dt("请点击确定起点"));const h=yield l.go();if(!h)return;const f=new A.MxCADUiPrPoint;f.setMessage(dt("请点击确定终点")),f.setUserDraw((w,M)=>{const E=new A.McDbLine(h.x,h.y,h.z,w.x,w.y,w.z);M.drawMcDbEntity(E)});const d=yield f.go();if(!d)return;const p=new A.McDbLine(h.x,h.y,h.z,d.x,d.y,d.z),b=[];for(let w=0;w<r+1;w++){let M=p.getPointAtDist(u*w).val;b.push(M)}const v=new A.McDbPolyline;b.forEach((w,M)=>{if(v.addVertexAt(w),M!=b.length-1){let E=new A.McGePoint3d(w.x,b[M+1].y,w.z);v.addVertexAt(E)}}),A.MxCpp.App.getCurrentMxCAD().drawEntity(v)})}function cF(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请确定圆心位置 "));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrDist;if(e.setBasePt(n),e.setMessage(dt("请输入圆半径")),e.setUserDraw((o,r)=>{const u=o.distanceTo(n),l=new A.McDbCircle;l.center=n,l.radius=u,r.drawMcDbEntity(l)}),!(yield e.go()))return;const s=e.value(),a=A.MxCpp.getCurrentMxCAD();a.pathCircle(n.x,n.y,s),a.drawPathToHatch()})}function uF(){return re(this,null,function*(){let t=5;const n=new A.MxCADUiPrDist;n.setMessage(dt(" 请输入保温棉宽度<5>")),(yield n.go())&&(t=n.value());let i=10;const s=new A.MxCADUiPrDist;s.setMessage(dt(" 请输入保温棉高度<10>")),(yield s.go())&&(i=s.value());const o=new A.MxCADUiPrPoint;o.setMessage(dt("请点击确定起点"));const r=yield o.go();if(!r)return;const u=new A.MxCADUiPrPoint;u.setMessage(dt("请点击下一个点")),u.setUserDraw((K,j)=>{const Z=new A.McDbLine(r.x,r.y,r.z,K.x,K.y,K.z);j.drawMcDbEntity(Z)});const l=yield u.go();if(!l)return;const h=new A.McDbLine(r.x,r.y,r.z,l.x,l.y,l.z);r.y<l.y&&(h.startPoint=new A.McGePoint3d(l.x,l.y,l.z),h.endPoint=new A.McGePoint3d(r.x,r.y,r.z));const f=h.getPointAtDist(h.getLength().val/2).val,d=h.clone();d.rotate(f,Math.PI/2);const p=d.getPointAtDist(h.getLength().val/2+i/2).val,b=d.getPointAtDist(h.getLength().val/2-i/2).val;let v,x;h.offsetCurves(i/2,p).forEach(K=>{v=K}),h.offsetCurves(i/2,b).forEach(K=>{x=K});let w=h.getLength().val/t*2,M=[],E=[],D=[];for(let K=0;K<w;K++)if(K%2==0){let j=x.getPointAtDist(K*(t/2)).val,Z=v.getPointAtDist(K*(t/2)).val;E.push(Z),M.push(j)}else{let j=v.getPointAtDist(K*(t/2)).val,Z=x.getPointAtDist(K*(t/2)).val;D.push(Z),M.push(j)}const N=new A.McDbPolyline;M.forEach(K=>{N.addVertexAt(K)});const V=A.MxCpp.App.getCurrentMxCAD();V.drawEntity(N),E.forEach(K=>{const j=new A.McDbArc;j.center=K,j.radius=t/2,j.startAngle=-new A.McGeVector3d(h.endPoint.x-h.startPoint.x,h.endPoint.y-h.startPoint.y).angleTo1(A.McGeVector3d.kXAxis),j.endAngle=new A.McGeVector3d(h.startPoint.x-h.endPoint.x,h.startPoint.y-h.endPoint.y).angleTo1(A.McGeVector3d.kXAxis),V.drawEntity(j)}),D.forEach(K=>{const j=new A.McDbArc;j.center=K,j.radius=t/2,j.startAngle=new A.McGeVector3d(h.startPoint.x-h.endPoint.x,h.startPoint.y-h.endPoint.y).angleTo1(A.McGeVector3d.kXAxis),j.endAngle=-new A.McGeVector3d(h.endPoint.x-h.startPoint.x,h.endPoint.y-h.startPoint.y).angleTo1(A.McGeVector3d.kXAxis),V.drawEntity(j)})})}function hF(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LINE");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("请选择第一条线"));const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity(),s=new A.McDbLine(i.startPoint,i.endPoint),a=new A.MxCADUiPrEntity;a.setFilter(t),a.setMessage(dt("请选择第二条线"));const o=yield a.go();if(!o.id)return;const r=o.getMcDbEntity(),u=new A.McDbLine(r.startPoint,r.endPoint),l=A.MxCpp.getCurrentMxCAD();let h=i.IntersectWith(u,A.McDb.Intersect.kExtendBoth);if(console.log(h.length()),h.length()===0){const f=i.getLength().val>r.getLength().val?r.clone():i.clone(),d=i.getLength().val>r.getLength().val?s:u,p=f.clone(),b=f.getPointAtDist(f.getLength().val/2).val;if(f.rotate(b,Math.PI/2),h=f.IntersectWith(d,A.McDb.Intersect.kExtendBoth),!h.length())return;const v=h.at(0).distanceTo(b)/2;p.offsetCurves(v,h.at(0)).forEach(x=>{x.trueColor=new A.McCmColor(255,0,0),l.drawEntity(x)})}else{const f=new A.McDbCircle;let d,p=s.endPoint.distanceTo(h.at(0)),b=s.startPoint.distanceTo(h.at(0));p!==0&&b!==0&&(p>b?s.startPoint=h.at(0):s.endPoint=h.at(0));let v=u.endPoint.distanceTo(h.at(0)),x=u.startPoint.distanceTo(h.at(0));v!==0&&x!==0&&(x>v?u.startPoint=h.at(0):u.endPoint=h.at(0)),s.getLength().val>u.getLength().val?(d=u.getLength().val,new A.McDbLine(r.startPoint,u.endPoint)):(d=i.getLength().val,new A.McDbLine(s.startPoint,s.endPoint)),f.center=h.at(0),f.radius=d;let w=f.IntersectWith(s,A.McDb.Intersect.kOnBothOperands),M=f.IntersectWith(u,A.McDb.Intersect.kOnBothOperands);if(!w.length()||!M.length())return;let E=w.at(0).sub(h.at(0)).angleTo2(A.McGeVector3d.kXAxis),D=M.at(0).sub(h.at(0)).angleTo2(A.McGeVector3d.kXAxis),N=new A.McDbArc;N.center=h.at(0),N.radius=d,N.startAngle=E,N.endAngle=D;const V=N.getPointAtDist(N.getLength().val/2).val,K=new A.McDbLine(h.at(0),V),j=new A.MxCADUiPrPoint;j.setMessage(dt("请选择终点")),j.setUserDraw((tt,rt)=>{let J=K.getClosestPointTo(tt,!0).val,U=K.clone();U.endPoint=J,rt.drawMcDbEntity(U)});const Z=yield j.go();if(!Z)return;K.endPoint=K.getClosestPointTo(Z,!0).val,K.trueColor=new A.McCmColor(255,0,0),l.drawEntity(K)}})}function dF(){return re(this,null,function*(){let t=new A.MxCADResbuf;t.AddMcDbEntityTypes("LWPOLYLINE");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("请选择目标矩形"));const e=yield n.go();if(!e.id)return;const i=e.getMcDbEntity();let s=[];const a=i.numVerts();for(let h=0;h<a;h++)s.push(i.getPointAt(h).val);const o=new A.MxCADUiPrPoint;let r;o.setUserDraw((h,f)=>{let d=[];s.forEach(b=>{d.push(b.distanceTo(h))}),r=d.findIndex(b=>b===Math.min(...d));let p=i.clone();p.setPointAt(r,h),f.drawMcDbEntity(p)});const u=yield o.go();if(!u)return;let l=i.clone();l.setPointAt(r,u),A.MxCpp.getCurrentMxCAD().drawEntity(l)})}function fF(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("设置指北针中心点"));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrDist;if(e.setMessage(dt("设置指北针半径")),e.setBasePt(n),e.setUserDraw((x,w)=>{const M=x.distanceTo(n);w.drawCircle(n.toVector3(),M)}),!(yield e.go()))return;const s=e.value(),a=A.MxCpp.App.getCurrentMxCAD(),o=new A.McDbCircle;o.trueColor=new A.McCmColor(0,255,0),o.center=n,o.radius=s,a.drawEntity(o);const r=new A.McGePoint3d(n.x,n.y+s),u=new A.McGePoint3d(n.x,n.y-s),l=new A.McDbLine;l.startPoint=r,l.endPoint=u;const h=l.clone();h.rotate(r,Math.PI/30);const f=l.clone();f.rotate(r,-Math.PI/30);let d,p;h.IntersectWith(o,A.McDb.Intersect.kOnBothOperands).forEach(x=>{x.x!==r.x&&x.y!==r.y&&(d=x)}),f.IntersectWith(o,A.McDb.Intersect.kOnBothOperands).forEach(x=>{x.x!==r.x&&x.y!==r.y&&(p=x)});let b=A.MxCADUtility.calcBulge(d,u,p);a.pathMoveToEx(d.x,d.y,0,0,b.val),a.pathLineTo(p.x,p.y),a.pathLineTo(r.x,r.y),a.pathLineTo(d.x,d.y),a.drawColor=new A.McCmColor(25,255,0),a.drawPathToHatch(1);const v=new A.McDbText;v.height=s/3,v.position=new A.McGePoint3d(n.x,n.y+s*1.2),v.alignmentPoint=v.position,v.textString="N",v.horizontalMode=A.McDb.TextHorzMode.kTextMid,v.trueColor=new A.McCmColor(25,255,0),a.drawEntity(v)})}function pF(){return re(this,null,function*(){const t=new A.MxCADUiPrKeyWord;t.setMessage(dt("选择提示框指向")),t.setKeyWords("[向上(U)/向下(D)]");const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrPoint;let i=A.MxCpp.getCurrentMxCAD().getCurrentDatabaseDrawColor();e.setMessage(dt(" 指定消息框第一点:"));let s=yield e.go();if(!s)return;let a=A.MxCpp.getCurrentMxCAD(),o=new Ct.MxDbRect;o.pt1=s.toVector3(),e.setUserDraw((w,M)=>{o.pt2=w.toVector3(),o.setColor(i),M.drawCustomEntity(o)}),e.setMessage(dt(" 指定消息框第二点:")),e.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let r=yield e.go();if(!r)return;o.pt2=r.toVector3();let u=new A.McDbPolyline;u.isClosed=!0;let l;s.y>r.y&&n==="U"||s.y<r.y&&n==="D"?(l=new A.McDbLine(s,new A.McGePoint3d(r.x,s.y)),u.addVertexAt(new A.McGePoint3d(r.x,s.y)),u.addVertexAt(r),u.addVertexAt(new A.McGePoint3d(s.x,r.y)),u.addVertexAt(s)):(s.y>r.y&&n==="D"||s.y<r.y&&n==="U")&&(l=new A.McDbLine(r,new A.McGePoint3d(s.x,r.y)),u.addVertexAt(new A.McGePoint3d(s.x,r.y)),u.addVertexAt(s),u.addVertexAt(new A.McGePoint3d(r.x,s.y)),u.addVertexAt(r));const h=s.distanceTo(r)/6,f=l.getPointAtDist(h).val,d=l.getPointAtDist(l.getLength().val-h).val;l.startPoint=f,l.endPoint=d;const p=new A.MxCADUiPrPoint;p.setMessage(dt(" 设置消息框指向:"));let b,v;p.setUserDraw((w,M)=>{const E=l.getClosestPointTo(w,!1).val;let D=u.getFirstDeriv(E);if(!D.ret)return;D.val.normalize().mult(h/4),b=E.clone(),b.addvec(D.val),v=E.clone(),v.subvec(D.val);let N=u.clone();N.addVertexAt(v),N.addVertexAt(w),N.addVertexAt(b),M.drawMcDbEntity(N)});let x=yield p.go();x&&(u.addVertexAt(v),u.addVertexAt(x),u.addVertexAt(b),a.drawEntity(u))})}class Vg extends A.McDbCustomEntity{constructor(n){super(n),this.basePt=new A.McGePoint3d,this.symbolPos=new A.McGePoint3d,this.angle=null,this.size=30,this.text="A",this.isEntity=!1,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new Vg(n)}getTypeName(){return"McDbTestDatumSymbol"}set datumBasePt(n){this.basePt=n.clone()}get datumBasePt(){return this.basePt}set symbolPosition(n){if(this.isEntity){const e=A.McGeVector3d.kXAxis.clone().rotateBy(this.angle).mult(this.size),i=this.basePt.clone().addvec(e.perpVector()),s=new A.McDbLine(i,this.basePt);this.symbolPos=s.getClosestPointTo(n,!0).val}else this.symbolPos=n.clone()}get symbolPosition(){return this.symbolPos}set symbolAngle(n){this.isEntity=!0,this.angle=n}get symbolAngle(){return this.angle}set symbolSize(n){this.size=n}get symbolSize(){return this.size}set symbolText(n){this.text=n}get symbolText(){return this.text}dwgInFields(n){this.basePt=n.readPoint("basePt").val,this.symbolPos=n.readPoint("symbolPos").val,this.angle=n.readDouble("angle").val,this.size=n.readDouble("size").val,this.text=n.readString("text").val;const e=n.readLong("isEntity").val;return this.isEntity=!!e,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){n.writePoint("basePt",this.basePt),n.writePoint("symbolPos",this.symbolPos),n.writeDouble("angle",this.angle),n.writeDouble("size",this.size),n.writeString("text",this.text);const e=this.isEntity?1:0;return n.writeLong("isEntity",e),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){if(this.assertWrite(),n===0)this.basePt.x+=e,this.basePt.y+=i,this.basePt.z+=s,this.symbolPos.x+=e,this.symbolPos.y+=i,this.symbolPos.z+=s,this.isEntity=!1;else if(n===1&&(this.symbolPos.x+=e,this.symbolPos.y+=i,this.symbolPos.z+=s,this.isEntity)){const a=A.McGeVector3d.kXAxis.clone().rotateBy(this.angle).mult(this.size),o=this.basePt.clone().addvec(a.perpVector()),r=new A.McDbLine(o,this.basePt);this.symbolPos=r.getClosestPointTo(this.symbolPos,!0).val}}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.basePt),n.append(this.symbolPos),n}worldDraw(n){const e=[],i=A.McGeVector3d.kXAxis.angleTo2(this.basePt.sub(this.symbolPos)),s=A.McGeVector3d.kXAxis,a=A.McGeVector3d.kYAxis,o=s.clone().mult(this.size/2),r=this.basePt.clone().addvec(o),u=this.basePt.clone().subvec(o),l=this.basePt.clone().addvec(o.clone().perpVector().mult(this.size*(4/5))),h=new A.McDbHatch,f=new A.McGePoint3dArray;f.append(r),f.append(u),f.append(l),h.appendLoop(f),h.rotate(this.basePt,Math.PI/2-i),n.drawEntity(h),e.push(h);const d=new A.McDbLine(this.basePt,this.symbolPos),p=this.symbolPos.sub(this.basePt),v=this.basePt.clone().addvec(p).clone().addvec(a.clone().negate().mult(this.size/2)),x=new A.McDbText;x.textString=this.text,x.height=this.size,x.position=v,x.alignmentPoint=x.position,x.horizontalMode=A.McDb.TextHorzMode.kTextMid,n.drawEntity(x),e.push(x);const w=v.clone().addvec(s.clone().mult(this.size*(3/4))).addvec(a.clone().negate().mult(this.size*(1/4))),M=v.clone().subvec(s.clone().mult(this.size*(3/4))).addvec(a.clone().negate().mult(this.size*(1/4))),E=M.clone().addvec(a.clone().mult(this.size*(3/2))),D=w.clone().addvec(a.clone().mult(this.size*(3/2))),N=new A.McDbPolyline;N.isClosed=!0,N.addVertexAt(w),N.addVertexAt(M),N.addVertexAt(E),N.addVertexAt(D),n.drawEntity(N),e.push(N),N.IntersectWith(d,A.McDb.Intersect.kOnBothOperands).forEach(V=>{const K=new A.McDbLine(V,this.basePt);n.drawEntity(K),e.push(K)}),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function mF(){return re(this,null,function*(){const t=new A.MxCADUiPrString;t.setMessage(dt("请设置基准符文字"));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrDist;if(e.setMessage(dt("请设置文字高度")),!(yield e.go()))return;const s=e.value(),a=new A.MxCADUiPrPoint;a.setMessage(dt("请设置基准符位置"));const o=A.MxCpp.getCurrentMxCAD();let r=new A.McDbBlockReference;a.setUserDraw((l,h)=>{const f=new A.McDbPolyline;f.addVertexAt(new A.McGePoint3d(l.x+s,l.y,0),0,2,2),f.addVertexAt(new A.McGePoint3d(l.x-s,l.y,0));const d=new A.McDbLine(l,new A.McGePoint3d(l.x,l.y+s*(8/7),0)),p=new A.McDbCircle;p.center=new A.McGePoint3d(l.x,l.y+s*(15/7),0),p.radius=s;const b=new A.McDbText;b.textString=n,b.height=s,b.position=b.alignmentPoint=new A.McGePoint3d(l.x,l.y+s*(25/14),0),b.horizontalMode=A.McDb.TextHorzMode.kTextMid;let x=o.getDatabase().getBlockTable().add(new A.McDbBlockTableRecord),w=x.getMcDbBlockTableRecord();w!=null&&(w.appendAcDbEntity(f),w.appendAcDbEntity(d),w.appendAcDbEntity(p),w.appendAcDbEntity(b),w.name="基准符",w.origin=l,r.blockTableRecordId=x,r.position=l,h.drawMcDbEntity(r))}),(yield a.go())&&o.drawEntity(r)})}function gF(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请设置定位点或圆弧或直线"));const n=yield t.go();if(!n)return;const e=new A.MxCADResbuf;e.AddMcDbEntityTypes("LINE,ARC,CIRCLE");let i=A.MxCADUtility.findEntAtPoint(n.x,n.y,n.z,-1,e);const s=new Vg;if(s.datumBasePt=n,i.isValid()){const h=i.getMcDbEntity().getFirstDeriv(n).val.angleTo2(A.McGeVector3d.kXAxis);s.symbolAngle=h}const a=new A.MxCADUiPrPoint;a.setMessage(dt("请设置符号位置")),a.setUserDraw((u,l)=>{s.symbolPosition=u,l.drawMcDbEntity(s)});const o=yield a.go();if(!o)return;s.symbolPosition=o,A.MxCpp.getCurrentMxCAD().drawEntity(s)})}function yF(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请设置圆心"));let n=yield t.go();if(!n)return;const e=A.MxCpp.getCurrentMxCAD();for(let i=1;i<4;i++){const s=new A.McDbCircle;s.center=n,s.radius=10*i,e.drawEntity(s)}})}function bF(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt("请设置齿轮圆心"));const n=yield t.go();if(!n)return;const e=new A.MxCADUiPrDist;e.setBasePt(n),e.setMessage(dt("请设置齿轮半径")),e.setUserDraw((M,E)=>{const D=new A.McDbCircle;D.center=n,D.radius=M.distanceTo(n),E.drawMcDbEntity(D)});const i=yield e.go();let s=10;i&&(s=e.value());const a=A.MxCpp.getCurrentMxCAD(),o=new A.McDbCircle;o.center=n,o.radius=s;const r=30,u=o.getLength().val/(r*2),l=new A.McGePoint3d(n.x,n.y+s,n.z),h=o.getDistAtPoint(l).val,f=o.getPointAtDist(h+u/2).val,d=o.getPointAtDist(h-u/2).val,p=[],b=new A.McDbPolyline;b.addVertexAt(f),b.addVertexAt(new A.McGePoint3d(f.x,f.y+5,f.z)),b.addVertexAt(new A.McGePoint3d(d.x,d.y+5,d.z)),b.addVertexAt(d),p.push(b);for(let M=0;M<r*2;M++){let E=b.clone(),D=o.getPointAtDist(h+M*u);if(!D.ret)return;let N=D.val.sub(l),V=new A.McGeMatrix3d;V.setToTranslation(N),E.transformBy(V);let Z=o.getFirstDeriv(D.val).val.rotateBy(A.McGeVector3d.kYAxis.angleTo1(A.McGeVector3d.kXAxis)).negate().angleTo2(A.McGeVector3d.kYAxis,A.McGeVector3d.kNegateZAxis);E.rotate(D.val,Z),p.push(E)}const v=[];p.forEach((M,E)=>{E%2!==0&&(M.IntersectWith(o,A.McDb.Intersect.kOnBothOperands).forEach(N=>{v.push(N)}),a.drawEntity(M))});const x=new A.McDbArc,w=new A.McGePoint3d(n.x,n.y-s,n.z);x.computeArc(f.x,f.y,w.x,w.y,d.x,d.y),x.splitCurves(v).forEach((M,E)=>{E%2!==0&&a.drawEntity(M)})})}function vF(){return re(this,null,function*(){const t=new A.MxCADResbuf;t.AddMcDbEntityTypes("INSERT");const n=new A.MxCADUiPrEntity;n.setFilter(t),n.setMessage(dt("请选择目标块"));const e=yield n.go();if(!e.id)return;const s=e.getMcDbEntity().getBoundingBox(),a=new A.McDbLine(s.minPt,s.maxPt),o=a.getPointAtDist(a.getLength().val/2).val,r=new A.MxCADUiPrDist;let u=10;r.setMessage(dt(" 请设置中心线长度10>")),r.setBasePt(o),r.setUserDraw((w,M)=>{const E=w.distanceTo(o),D=o.clone().addvec(A.McGeVector3d.kXAxis.normalize().mult(E)),N=o.clone().addvec(A.McGeVector3d.kXAxis.normalize().mult(E).negate()),V=o.clone().addvec(A.McGeVector3d.kYAxis.normalize().mult(E)),K=o.clone().addvec(A.McGeVector3d.kYAxis.normalize().mult(E).negate()),j=new A.McDbLine(D,N),Z=new A.McDbLine(V,K);M.drawMcDbEntity(j),M.drawMcDbEntity(Z)}),(yield r.go())&&(u=r.value());const h=A.MxCpp.getCurrentMxCAD(),f=o.clone().addvec(A.McGeVector3d.kXAxis.normalize().mult(u)),d=o.clone().addvec(A.McGeVector3d.kXAxis.normalize().mult(u).negate()),p=o.clone().addvec(A.McGeVector3d.kYAxis.normalize().mult(u)),b=o.clone().addvec(A.McGeVector3d.kYAxis.normalize().mult(u).negate()),v=new A.McDbLine(f,d),x=new A.McDbLine(p,b);h.drawEntity(v),h.drawEntity(x)})}function xF(){return re(this,null,function*(){const t=new A.MxCADResbuf([A.DxfCode.kEntityType,"CIRCLE"]),n=A.MxCpp.getCurrentMxCAD(),e=new A.MxCADUiPrEntity;e.setFilter(t),e.setMessage(dt("请选择第一个圆"));const i=yield e.go();if(!i)return;const s=new A.MxCADUiPrEntity;s.setFilter(t),s.setMessage(dt("请选择第二个圆"));const a=yield s.go();if(!a)return;const o=i.getMcDbEntity(),r=a.getMcDbEntity(),u=o.center,l=r.center,h=u.sub(l).normalize(),f=u.clone().addvec(h.clone().perpVector().mult(o.radius)),d=l.clone().addvec(h.clone().perpVector().mult(r.radius)),p=new A.McDbLine(f,d);if(Math.abs(o.radius-r.radius)>1e-4){const b=new A.McDbLine(u,l),v=p.IntersectWith(b,A.McDb.Intersect.kExtendBoth);if(v.length()>0){const x=v.at(0);let w,M;x.distanceTo(u)>x.distanceTo(l)?(w=r,M=o):(w=o,M=r);const E=x.clone().addvec(w.center.sub(x).mult(1/2)),D=x.distanceTo(w.center)/2,N=Math.asin(w.radius/(2*D)),V=w.center.sub(E),K=E.clone().addvec(V.clone().rotateBy(N*2)),j=E.clone().addvec(V.clone().rotateBy(-N*2)),Z=K.sub(w.center).normalize(),tt=j.sub(w.center).normalize(),rt=M.center.clone().addvec(Z.clone().mult(M.radius)),J=M.center.clone().addvec(tt.clone().mult(M.radius));n.drawLine(K.x,K.y,rt.x,rt.y),n.drawLine(j.x,j.y,J.x,J.y)}}else{const b=u.clone().addvec(h.clone().perpVector().negate().mult(o.radius)),v=l.clone().addvec(h.clone().perpVector().negate().mult(r.radius)),x=new A.McDbLine(b,v);n.drawEntity(p),n.drawEntity(x)}})}class jg extends A.McDbCustomEntity{constructor(n){super(n),this.point1=new A.McGePoint3d,this.point2=new A.McGePoint3d,this.radius=30,this.minPt=new A.McGePoint3d,this.maxPt=new A.McGePoint3d}create(n){return new jg(n)}getTypeName(){return"McDbTestRoundedRectangle"}set CornerPoint1(n){this.point1=n.clone()}get CornerPoint1(){return this.point1}set CornerPoint2(n){this.point2=n.clone()}get CornerPoint2(){return this.point2}set arcRadius(n){this.radius=n}get arcRadius(){return this.radius}dwgInFields(n){return this.point1=n.readPoint("point1").val,this.point2=n.readPoint("point2").val,this.radius=n.readDouble("radius").val,this.minPt=n.readPoint("minPt").val,this.maxPt=n.readPoint("maxPt").val,!0}dwgOutFields(n){return n.writePoint("point1",this.point1),n.writePoint("point2",this.point2),n.writeDouble("radius",this.radius),n.writePoint("minPt",this.minPt),n.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(n,e,i,s){this.assertWrite(),n===0?(this.point1.x+=e,this.point1.y+=i,this.point1.z+=s):n===1&&(this.point2.x+=e,this.point2.y+=i,this.point2.z+=s)}getGripPoints(){let n=new A.McGePoint3dArray;return n.append(this.point1),n.append(this.point2),n}worldDraw(n){const e=[];let i=this.radius;const s=new A.McGePoint3d(this.point1.x,this.point2.y),a=new A.McGePoint3d(this.point2.x,this.point1.y),o=this.point1.distanceTo(s),r=this.point2.distanceTo(s),u=o<r?o:r;this.radius>u/2&&(i=u/2);const l=[this.point1,s,this.point2,a],h=new A.McDbPolyline;h.isClosed=!0,l.forEach(D=>{h.addVertexAt(D)});const f=s.sub(this.point1).normalize().mult(i),d=a.sub(this.point1).normalize().mult(i),p=this.point1.clone().addvec(f).addvec(d),b=s.clone().addvec(f.clone().negate()).addvec(d),v=this.point2.clone().addvec(f.clone().negate()).addvec(d.clone().negate()),x=a.clone().addvec(f).addvec(d.clone().negate()),w=[p,b,v,x],M=[],E=1e-4;w.forEach(D=>{const N=new A.McDbCircle;N.center=D,N.radius=i;const V=h.IntersectWith(N,A.McDb.Intersect.kExtendBoth),K=[];V.length()>0&&V.forEach(j=>K.push(j)),M.push(...K),N.splitCurves(K).forEach((j,Z)=>{const tt=j.clone(),rt=tt.getLength().val,J=tt.getPointAtDist(0).val,U=tt.getPointAtDist(rt).val,G=K.filter(C=>C.distanceTo(J)<E||C.distanceTo(U)<E),I=Math.abs(rt-N.getLength().val/4);G.length===K.length&&I<E&&(n.drawEntity(j),e.push(j))})}),h.splitCurves(M).forEach((D,N)=>{const V=D.clone(),K=V.getLength().val;if(Math.abs(K-this.radius)>E&&Math.abs(K-2*this.radius)>E&&(n.drawEntity(D),e.push(D)),Math.abs(K-2*this.radius)<E){const j=V.numVerts();let Z=[];for(let tt=0;tt<j;tt++){const rt=V.getPointAt(tt).val;Z=l.filter(J=>rt.distanceTo(J)<E)}j!==3&&Z.length===0&&(n.drawEntity(D),e.push(D))}}),this.getBox(e)}getBox(n){const e=A.MxCpp.getCurrentMxCAD();let i,s=null,a;n.forEach(o=>{if(o instanceof A.McDbText){const h=new A.McDbMText;switch(h.contents=o.textString,h.textHeight=o.height,h.location=o.position,o.horizontalMode){case A.McDb.TextHorzMode.kTextLeft:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break;case A.McDb.TextHorzMode.kTextCenter:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;case A.McDb.TextHorzMode.kTextRight:h.attachment=A.McDb.AttachmentPoint.kBottomRight;break;case A.McDb.TextHorzMode.kTextMid:h.attachment=A.McDb.AttachmentPoint.kBottomCenter;break;default:h.attachment=A.McDb.AttachmentPoint.kBottomLeft;break}const f=e.getDatabase().getCurrentlyTextStyleId();h.textStyleId=f,h.reCompute(),a=A.MxCADUtility.getTextEntityBox(h,!1)}else o instanceof A.McDbMText?(o.reCompute(),a=A.MxCADUtility.getTextEntityBox(o,!1)):a=o.getBoundingBox();const{minPt:r,maxPt:u,ret:l}=a;i||(i=r.clone()),s||(s=u.clone()),r.x<i.x&&(i.x=r.x),r.y<i.y&&(i.y=r.y),u.x>s.x&&(s.x=u.x),u.y>s.y&&(s.y=u.y)}),i&&s&&(this.maxPt=s,this.minPt=i)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function _F(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint;n.setMessage(dt("请设置矩形左上角点"));const e=yield n.go();if(!e)return;let i=new Ct.MxDbRect;i.pt1=e.toVector3();const s=new A.MxCADUiPrPoint;s.setMessage(dt("请设置矩形右下角点")),s.setUserDraw((f,d)=>{i.pt2=f.toVector3(),d.drawCustomEntity(i)});const a=yield s.go();if(!a)return;let o=new A.McDbPolyline;o.addVertexAt(e),o.addVertexAt(new A.McGePoint3d(e.x,a.y)),o.addVertexAt(a),o.addVertexAt(new A.McGePoint3d(a.x,e.y)),o.isClosed=!0;const r=t.drawEntity(o),u=new A.MxCADUiPrDist;u.setMessage(dt("请设置圆角半径")),u.setBasePt(e);let l=yield u.go();l||(l=Ct.MxFun.screenCoordLong2Doc(20)),r.erase();const h=new jg;h.CornerPoint1=e,h.CornerPoint2=a,h.arcRadius=l,t.drawEntity(h)})}function wF(){return re(this,null,function*(){const t=A.MxCpp.getCurrentMxCAD(),n=[],e=new A.MxCADUiPrPoint;e.setMessage(dt("请选择多边形起点"));const i=yield e.go();if(!i)return;n.push(i);let s=null;for(;;){if(s&&s.erase(),n.length>=2){const u=new A.McDbPolyline;n.forEach(l=>u.addVertexAt(l)),s=t.drawEntity(u)}const o=new A.MxCADUiPrPoint;o.setMessage(dt("请选择多边形顶点")),o.setUserDraw((u,l)=>{const h=new A.McDbLine(u,n[n.length-1]);l.drawMcDbEntity(h)});const r=yield o.go();if(!r||(n.push(r),r&&r.distanceTo(n[0])<1e-4))break}s&&s.erase();const a=new A.McDbPolyline;th(n).forEach(o=>a.addVertexAt(o)),a.isClosed=!0,t.drawEntity(a)})}function MF(){new jg().rxInit(),new Vg().rxInit(),dB(),KB(),$B(),MxPluginContext.addCommand("Mx_DrawStart",QB),MxPluginContext.addCommand("Mx_ConcavoVex",tF),MxPluginContext.addCommand("Mx_ZigzagLine",eF),MxPluginContext.addCommand("Mx_CenterRect",nF),MxPluginContext.addCommand("Mx_RREC",_F),MxPluginContext.addCommand("Mx_CCLine",rF),MxPluginContext.addCommand("Mx_Piping",iF),MxPluginContext.addCommand("Mx_CutPipeline",oF),MxPluginContext.addCommand("Mx_WelLine",sF),MxPluginContext.addCommand("Mx_PerpLine",aF),MxPluginContext.addCommand("Mx_StairLine",lF),MxPluginContext.addCommand("Mx_SolidCircle",cF),MxPluginContext.addCommand("Mx_CottonInsulation",uF),MxPluginContext.addCommand("Mx_CenterLine",hF),MxPluginContext.addCommand("Mx_DoHole",dF),MxPluginContext.addCommand("Mx_Compass",fF),MxPluginContext.addCommand("Mx_MassegeBox",pF),MxPluginContext.addCommand("Mx_DatumSymbol",mF),MxPluginContext.addCommand("Mx_ConcentricCircles",yF),MxPluginContext.addCommand("Mx_Gear",bF),MxPluginContext.addCommand("Mx_BlkCenterLine",vF),MxPluginContext.addCommand("Mx_RoundCutPublicLine",xF),MxPluginContext.addCommand("Mx_DatumSymbol2",gF),MxPluginContext.addCommand("Mx_DrawPolygon",wF)}function Gg(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var EM={exports:{}};/*! ExcelJS 19-10-2023 */(function(t,n){(function(e){t.exports=e()})(function(){return function e(i,s,a){function o(l,h){if(!s[l]){if(!i[l]){var f=typeof Gg=="function"&&Gg;if(!h&&f)return f(l,!0);if(r)return r(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var p=s[l]={exports:{}};i[l][0].call(p.exports,function(b){return o(i[l][1][b]||b)},p,p.exports,e,i,s,a)}return s[l].exports}for(var r=typeof Gg=="function"&&Gg,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(e,i,s){const a=e("fs"),o=e("fast-csv"),r=e("dayjs/plugin/customParseFormat"),u=e("dayjs/plugin/utc"),l=e("dayjs").extend(r).extend(u),h=e("../utils/stream-buf"),{fs:{exists:f}}=e("../utils/utils"),d={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};i.exports=class{constructor(p){this.workbook=p,this.worksheet=null}readFile(p,b){return re(this,null,function*(){if(b=b||{},!(yield f(p)))throw new Error("File not found: "+p);const v=a.createReadStream(p),x=yield this.read(v,b);return v.close(),x})}read(p,b){return b=b||{},new Promise((v,x)=>{const w=this.workbook.addWorksheet(b.sheetName),M=b.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],E=b.map||function(N){if(N==="")return null;const V=Number(N);if(!Number.isNaN(V)&&V!==1/0)return V;const K=M.reduce((Z,tt)=>{if(Z)return Z;const rt=l(N,tt,!0);return rt.isValid()?rt:null},null);if(K)return new Date(K.valueOf());const j=d[N];return j!==void 0?j:N},D=o.parse(b.parserOptions).on("data",N=>{w.addRow(N.map(E))}).on("end",()=>{D.emit("worksheet",w)});D.on("worksheet",v).on("error",x),p.pipe(D)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(p,b){return new Promise((v,x)=>{b=b||{};const w=this.workbook.getWorksheet(b.sheetName||b.sheetId),M=o.format(b.formatterOptions);p.on("finish",()=>{v()}),M.on("error",x),M.pipe(p);const{dateFormat:E,dateUTC:D}=b,N=b.map||(j=>{if(j){if(j.text||j.hyperlink)return j.hyperlink||j.text||"";if(j.formula||j.result)return j.result||"";if(j instanceof Date)return E?D?l.utc(j).format(E):l(j).format(E):D?l.utc(j).format():l(j).format();if(j.error)return j.error;if(typeof j=="object")return JSON.stringify(j)}return j}),V=b.includeEmptyRows===void 0||b.includeEmptyRows;let K=1;w&&w.eachRow((j,Z)=>{if(V)for(;K++<Z-1;)M.write([]);const{values:tt}=j;tt.shift(),M.write(tt.map(N)),K=Z}),M.end()})}writeFile(p,b){const v={encoding:(b=b||{}).encoding||"utf8"},x=a.createWriteStream(p,v);return this.write(x,b)}writeBuffer(p){return re(this,null,function*(){const b=new h;return yield this.write(b,p),b.read()})}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,i,s){const a=e("../utils/col-cache");class o{constructor(u,l){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=u,l)if(typeof l=="string"){const f=a.decodeAddress(l);this.nativeCol=f.col+h,this.nativeColOff=0,this.nativeRow=f.row+h,this.nativeRowOff=0}else l.nativeCol!==void 0?(this.nativeCol=l.nativeCol||0,this.nativeColOff=l.nativeColOff||0,this.nativeRow=l.nativeRow||0,this.nativeRowOff=l.nativeRowOff||0):l.col!==void 0?(this.col=l.col+h,this.row=l.row+h):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(u){return u instanceof o||u==null?u:new o(u)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(u){this.nativeCol=Math.floor(u),this.nativeColOff=Math.floor((u-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(u){this.nativeRow=Math.floor(u),this.nativeRowOff=Math.floor((u-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(u){this.nativeCol=u.nativeCol,this.nativeColOff=u.nativeColOff,this.nativeRow=u.nativeRow,this.nativeRowOff=u.nativeRowOff}}i.exports=o},{"../utils/col-cache":19}],3:[function(e,i,s){const a=e("../utils/col-cache"),o=e("../utils/under-dash"),r=e("./enums"),{slideFormula:u}=e("../utils/shared-formula"),l=e("./note");class h{constructor(p,b,v){if(!p||!b)throw new Error("A Cell needs a Row");this._row=p,this._column=b,a.validateAddress(v),this._address=v,this._value=f.create(h.Types.Null,this),this.style=this._mergeStyle(p.style,b.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(p){this.style.numFmt=p}get font(){return this.style.font}set font(p){this.style.font=p}get alignment(){return this.style.alignment}set alignment(p){this.style.alignment=p}get border(){return this.style.border}set border(p){this.style.border=p}get fill(){return this.style.fill}set fill(p){this.style.fill=p}get protection(){return this.style.protection}set protection(p){this.style.protection=p}_mergeStyle(p,b,v){const x=p&&p.numFmt||b&&b.numFmt;x&&(v.numFmt=x);const w=p&&p.font||b&&b.font;w&&(v.font=w);const M=p&&p.alignment||b&&b.alignment;M&&(v.alignment=M);const E=p&&p.border||b&&b.border;E&&(v.border=E);const D=p&&p.fill||b&&b.fill;D&&(v.fill=D);const N=p&&p.protection||b&&b.protection;return N&&(v.protection=N),v}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===h.Types.Merge}merge(p,b){this._value.release(),this._value=f.create(h.Types.Merge,this,p),b||(this.style=p.style)}unmerge(){this.type===h.Types.Merge&&(this._value.release(),this._value=f.create(h.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(p){return this._value.type===h.Types.Merge&&this._value.isMergedTo(p)}get master(){return this.type===h.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===h.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(p){this.type!==h.Types.Merge?(this._value.release(),this._value=f.create(f.getType(p),this,p)):this._value.master.value=p}get note(){return this._comment&&this._comment.note}set note(p){this._comment=new l(p)}get text(){return this._value.toString()}get html(){return o.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(p){this.type===h.Types.String&&(this._value=f.create(h.Types.Hyperlink,this,{text:this._value.value,hyperlink:p}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:p}=this._row;return{sheetName:p.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(p){this.names=[p]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(p){const{definedNames:b}=this.workbook;b.removeAllNames(this.fullAddress),p.forEach(v=>{b.addEx(this.fullAddress,v)})}addName(p){this.workbook.definedNames.addEx(this.fullAddress,p)}removeName(p){this.workbook.definedNames.removeEx(this.fullAddress,p)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(p){this._dataValidations.add(this.address,p)}get model(){const{model:p}=this._value;return p.style=this.style,this._comment&&(p.comment=this._comment.model),p}set model(p){if(this._value.release(),this._value=f.create(p.type,this),this._value.model=p,p.comment)switch(p.comment.type){case"note":this._comment=l.fromModel(p.comment)}p.style?this.style=p.style:this.style={}}}h.Types=r.ValueType;const f={getType:d=>d==null?h.Types.Null:d instanceof String||typeof d=="string"?h.Types.String:typeof d=="number"?h.Types.Number:typeof d=="boolean"?h.Types.Boolean:d instanceof Date?h.Types.Date:d.text&&d.hyperlink?h.Types.Hyperlink:d.formula||d.sharedFormula?h.Types.Formula:d.richText?h.Types.RichText:d.sharedString?h.Types.SharedString:d.error?h.Types.Error:h.Types.JSON,types:[{t:h.Types.Null,f:class{constructor(d){this.model={address:d.address,type:h.Types.Null}}get value(){return null}set value(d){}get type(){return h.Types.Null}get effectiveType(){return h.Types.Null}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return""}release(){}toString(){return""}}},{t:h.Types.Number,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.Number,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return h.Types.Number}get effectiveType(){return h.Types.Number}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:h.Types.String,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.String,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return h.Types.String}get effectiveType(){return h.Types.String}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:h.Types.Date,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.Date,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return h.Types.Date}get effectiveType(){return h.Types.Date}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:h.Types.Hyperlink,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.Hyperlink,text:p?p.text:void 0,hyperlink:p?p.hyperlink:void 0},p&&p.tooltip&&(this.model.tooltip=p.tooltip)}get value(){const d={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(d.tooltip=this.model.tooltip),d}set value(d){this.model={text:d.text,hyperlink:d.hyperlink},d.tooltip&&(this.model.tooltip=d.tooltip)}get text(){return this.model.text}set text(d){this.model.text=d}get hyperlink(){return this.model.hyperlink}set hyperlink(d){this.model.hyperlink=d}get type(){return h.Types.Hyperlink}get effectiveType(){return h.Types.Hyperlink}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:h.Types.Formula,f:class{constructor(d,p){this.cell=d,this.model={address:d.address,type:h.Types.Formula,shareType:p?p.shareType:void 0,ref:p?p.ref:void 0,formula:p?p.formula:void 0,sharedFormula:p?p.sharedFormula:void 0,result:p?p.result:void 0}}_copyModel(d){const p={},b=v=>{const x=d[v];x&&(p[v]=x)};return b("formula"),b("result"),b("ref"),b("shareType"),b("sharedFormula"),p}get value(){return this._copyModel(this.model)}set value(d){this.model=this._copyModel(d)}validate(d){switch(f.getType(d)){case h.Types.Null:case h.Types.String:case h.Types.Number:case h.Types.Date:break;case h.Types.Hyperlink:case h.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(d){this.model.formula=d}get formulaType(){return this.model.formula?r.FormulaType.Master:this.model.sharedFormula?r.FormulaType.Shared:r.FormulaType.None}get result(){return this.model.result}set result(d){this.model.result=d}get type(){return h.Types.Formula}get effectiveType(){const d=this.model.result;return d==null?r.ValueType.Null:d instanceof String||typeof d=="string"?r.ValueType.String:typeof d=="number"?r.ValueType.Number:d instanceof Date?r.ValueType.Date:d.text&&d.hyperlink?r.ValueType.Hyperlink:d.formula?r.ValueType.Formula:r.ValueType.Null}get address(){return this.model.address}set address(d){this.model.address=d}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:d}=this.cell,p=d.findCell(this.model.sharedFormula);this._translatedFormula=p&&u(p.formula,p.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:h.Types.Merge,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.Merge,master:p?p.address:void 0},this._master=p,p&&p.addMergeRef()}get value(){return this._master.value}set value(d){d instanceof h?(this._master&&this._master.releaseMergeRef(),d.addMergeRef(),this._master=d):this._master.value=d}isMergedTo(d){return d===this._master}get master(){return this._master}get type(){return h.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:h.Types.JSON,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.String,value:JSON.stringify(p),rawValue:p}}get value(){return this.model.rawValue}set value(d){this.model.rawValue=d,this.model.value=JSON.stringify(d)}get type(){return h.Types.String}get effectiveType(){return h.Types.String}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:h.Types.SharedString,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.SharedString,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return h.Types.SharedString}get effectiveType(){return h.Types.SharedString}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:h.Types.RichText,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.String,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}toString(){return this.model.value.richText.map(d=>d.text).join("")}get type(){return h.Types.RichText}get effectiveType(){return h.Types.RichText}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:h.Types.Boolean,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.Boolean,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return h.Types.Boolean}get effectiveType(){return h.Types.Boolean}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:h.Types.Error,f:class{constructor(d,p){this.model={address:d.address,type:h.Types.Error,value:p}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return h.Types.Error}get effectiveType(){return h.Types.Error}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((d,p)=>(d[p.t]=p.f,d),[]),create(d,p,b){const v=this.types[d];if(!v)throw new Error("Could not create Value of type "+d);return new v(p,b)}};i.exports=h},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,i,s){const a=e("../utils/under-dash"),o=e("./enums"),r=e("../utils/col-cache");class u{constructor(h,f,d){this._worksheet=h,this._number=f,d!==!1&&(this.defn=d)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return r.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(h){h?(this.key=h.key,this.width=h.width!==void 0?h.width:9,this.outlineLevel=h.outlineLevel,h.style?this.style=h.style:this.style={},this.header=h.header,this._hidden=!!h.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(h){h!==void 0?(this._header=h,this.headers.forEach((f,d)=>{this._worksheet.getCell(d+1,this.number).value=f})):this._header=void 0}get key(){return this._key}set key(h){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=h,h&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(h){this._hidden=h}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(h){this._outlineLevel=h}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(h){return this.width===h.width&&this.hidden===h.hidden&&this.outlineLevel===h.outlineLevel&&a.isEqual(this.style,h.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const h=this.style;return!h||!(h.font||h.numFmt||h.alignment||h.border||h.fill||h.protection)}get headerCount(){return this.headers.length}eachCell(h,f){const d=this.number;f||(f=h,h=null),this._worksheet.eachRow(h,(p,b)=>{f(p.getCell(d),b)})}get values(){const h=[];return this.eachCell((f,d)=>{f&&f.type!==o.ValueType.Null&&(h[d]=f.value)}),h}set values(h){if(!h)return;const f=this.number;let d=0;h.hasOwnProperty("0")&&(d=1),h.forEach((p,b)=>{this._worksheet.getCell(b+d,f).value=p})}_applyStyle(h,f){return this.style[h]=f,this.eachCell(d=>{d[h]=f}),f}get numFmt(){return this.style.numFmt}set numFmt(h){this._applyStyle("numFmt",h)}get font(){return this.style.font}set font(h){this._applyStyle("font",h)}get alignment(){return this.style.alignment}set alignment(h){this._applyStyle("alignment",h)}get protection(){return this.style.protection}set protection(h){this._applyStyle("protection",h)}get border(){return this.style.border}set border(h){this._applyStyle("border",h)}get fill(){return this.style.fill}set fill(h){this._applyStyle("fill",h)}static toModel(h){const f=[];let d=null;return h&&h.forEach((p,b)=>{p.isDefault?d&&(d=null):d&&p.equivalentTo(d)?d.max=b+1:(d={min:b+1,max:b+1,width:p.width!==void 0?p.width:9,style:p.style,isCustomWidth:p.isCustomWidth,hidden:p.hidden,outlineLevel:p.outlineLevel,collapsed:p.collapsed},f.push(d))}),f.length?f:void 0}static fromModel(h,f){const d=[];let p=1,b=0;for(f=(f=f||[]).sort(function(v,x){return v.min-x.min});b<f.length;){const v=f[b++];for(;p<v.min;)d.push(new u(h,p++));for(;p<=v.max;)d.push(new u(h,p++,v))}return d.length?d:null}}i.exports=u},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,i,s){i.exports=class{constructor(a){this.model=a||{}}add(a,o){return this.model[a]=o}find(a){return this.model[a]}remove(a){this.model[a]=void 0}}},{}],6:[function(e,i,s){const a=e("../utils/under-dash"),o=e("../utils/col-cache"),r=e("../utils/cell-matrix"),u=e("./range"),l=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;i.exports=class{constructor(){this.matrixMap={}}getMatrix(h){return this.matrixMap[h]||(this.matrixMap[h]=new r)}add(h,f){const d=o.decodeEx(h);this.addEx(d,f)}addEx(h,f){const d=this.getMatrix(f);if(h.top)for(let p=h.left;p<=h.right;p++)for(let b=h.top;b<=h.bottom;b++){const v={sheetName:h.sheetName,address:o.n2l(p)+b,row:b,col:p};d.addCellEx(v)}else d.addCellEx(h)}remove(h,f){const d=o.decodeEx(h);this.removeEx(d,f)}removeEx(h,f){this.getMatrix(f).removeCellEx(h)}removeAllNames(h){a.each(this.matrixMap,f=>{f.removeCellEx(h)})}forEach(h){a.each(this.matrixMap,(f,d)=>{f.forEach(p=>{h(d,p)})})}getNames(h){return this.getNamesEx(o.decodeEx(h))}getNamesEx(h){return a.map(this.matrixMap,(f,d)=>f.findCellEx(h)&&d).filter(Boolean)}_explore(h,f){f.mark=!1;const{sheetName:d}=f,p=new u(f.row,f.col,f.row,f.col,d);let b,v;function x(M,E){const D=h.findCellAt(d,M,f.col);return!(!D||!D.mark)&&(p[E]=M,D.mark=!1,!0)}for(v=f.row-1;x(v,"top");v--);for(v=f.row+1;x(v,"bottom");v++);function w(M,E){const D=[];for(v=p.top;v<=p.bottom;v++){const N=h.findCellAt(d,v,M);if(!N||!N.mark)return!1;D.push(N)}p[E]=M;for(let N=0;N<D.length;N++)D[N].mark=!1;return!0}for(b=f.col-1;w(b,"left");b--);for(b=f.col+1;w(b,"right");b++);return p}getRanges(h,f){return(f=f||this.matrixMap[h])?(f.forEach(d=>{d.mark=!0}),{name:h,ranges:f.map(d=>d.mark&&this._explore(f,d)).filter(Boolean).map(d=>d.$shortRange)}):{name:h,ranges:[]}}normaliseMatrix(h,f){h.forEachInSheet(f,(d,p,b)=>{d&&(d.row===p&&d.col===b||(d.row=p,d.col=b,d.address=o.n2l(b)+p))})}spliceRows(h,f,d,p){a.each(this.matrixMap,b=>{b.spliceRows(h,f,d,p),this.normaliseMatrix(b,h)})}spliceColumns(h,f,d,p){a.each(this.matrixMap,b=>{b.spliceColumns(h,f,d,p),this.normaliseMatrix(b,h)})}get model(){return a.map(this.matrixMap,(h,f)=>this.getRanges(f,h)).filter(h=>h.ranges.length)}set model(h){const f=this.matrixMap={};h.forEach(d=>{const p=f[d.name]=new r;d.ranges.forEach(b=>{l.test(b.split("!").pop()||"")&&p.addCell(b)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,i,s){i.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,i,s){const a=e("../utils/col-cache"),o=e("./anchor");i.exports=class{constructor(r,u){this.worksheet=r,this.model=u}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(r){let{type:u,imageId:l,range:h,hyperlinks:f}=r;if(this.type=u,this.imageId=l,u==="image")if(typeof h=="string"){const d=a.decode(h);this.range={tl:new o(this.worksheet,{col:d.left,row:d.top},-1),br:new o(this.worksheet,{col:d.right,row:d.bottom},0),editAs:"oneCell"}}else this.range={tl:new o(this.worksheet,h.tl,0),br:h.br&&new o(this.worksheet,h.br,0),ext:h.ext,editAs:h.editAs,hyperlinks:f||h.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,i,s){const a=e("../utils/under-dash");class o{constructor(u){this.note=u}get model(){let u=null;switch(typeof this.note){case"string":u={type:"note",note:{texts:[{text:this.note}]}};break;default:u={type:"note",note:this.note}}return a.deepMerge({},o.DEFAULT_CONFIGS,u)}set model(u){const{note:l}=u,{texts:h}=l;h.length===1&&Object.keys(h[0]).length===1?this.note=h[0].text:this.note=l}static fromModel(u){const l=new o;return l.model=u,l}}o.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},i.exports=o},{"../utils/under-dash":26}],10:[function(e,i,s){const a=e("../utils/col-cache");class o{constructor(){this.decode(arguments)}setTLBR(u,l,h,f,d){if(arguments.length<4){const p=a.decodeAddress(u),b=a.decodeAddress(l);this.model={top:Math.min(p.row,b.row),left:Math.min(p.col,b.col),bottom:Math.max(p.row,b.row),right:Math.max(p.col,b.col),sheetName:h},this.setTLBR(p.row,p.col,b.row,b.col,d)}else this.model={top:Math.min(u,h),left:Math.min(l,f),bottom:Math.max(u,h),right:Math.max(l,f),sheetName:d}}decode(u){switch(u.length){case 5:this.setTLBR(u[0],u[1],u[2],u[3],u[4]);break;case 4:this.setTLBR(u[0],u[1],u[2],u[3]);break;case 3:this.setTLBR(u[0],u[1],u[2]);break;case 2:this.setTLBR(u[0],u[1]);break;case 1:{const l=u[0];if(l instanceof o)this.model={top:l.model.top,left:l.model.left,bottom:l.model.bottom,right:l.model.right,sheetName:l.sheetName};else if(l instanceof Array)this.decode(l);else if(l.top&&l.left&&l.bottom&&l.right)this.model={top:l.top,left:l.left,bottom:l.bottom,right:l.right,sheetName:l.sheetName};else{const h=a.decodeEx(l);h.top?this.model={top:h.top,left:h.left,bottom:h.bottom,right:h.right,sheetName:h.sheetName}:this.model={top:h.row,left:h.col,bottom:h.row,right:h.col,sheetName:h.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+u.length)}}get top(){return this.model.top||1}set top(u){this.model.top=u}get left(){return this.model.left||1}set left(u){this.model.left=u}get bottom(){return this.model.bottom||1}set bottom(u){this.model.bottom=u}get right(){return this.model.right||1}set right(u){this.model.right=u}get sheetName(){return this.model.sheetName}set sheetName(u){this.model.sheetName=u}get _serialisedSheetName(){const{sheetName:u}=this.model;return u?/^[a-zA-Z0-9]*$/.test(u)?u+"!":`'${u}'!`:""}expand(u,l,h,f){(!this.model.top||u<this.top)&&(this.top=u),(!this.model.left||l<this.left)&&(this.left=l),(!this.model.bottom||h>this.bottom)&&(this.bottom=h),(!this.model.right||f>this.right)&&(this.right=f)}expandRow(u){if(u){const{dimensions:l,number:h}=u;l&&this.expand(h,l.min,h,l.max)}}expandToAddress(u){const l=a.decodeEx(u);this.expand(l.row,l.col,l.row,l.col)}get tl(){return a.n2l(this.left)+this.top}get $t$l(){return`$${a.n2l(this.left)}$${this.top}`}get br(){return a.n2l(this.right)+this.bottom}get $b$r(){return`$${a.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&!(u.bottom<this.top)&&!(u.top>this.bottom)&&!(u.right<this.left)&&!(u.left>this.right)}contains(u){const l=a.decodeEx(u);return this.containsEx(l)}containsEx(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&u.row>=this.top&&u.row<=this.bottom&&u.col>=this.left&&u.col<=this.right}forEachAddress(u){for(let l=this.left;l<=this.right;l++)for(let h=this.top;h<=this.bottom;h++)u(a.encodeAddress(h,l),h,l)}}i.exports=o},{"../utils/col-cache":19}],11:[function(e,i,s){const a=e("../utils/under-dash"),o=e("./enums"),r=e("../utils/col-cache"),u=e("./cell");i.exports=class{constructor(l,h){this._worksheet=l,this._number=h,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(l){return this._cells[l-1]}getCellEx(l){let h=this._cells[l.col-1];if(!h){const f=this._worksheet.getColumn(l.col);h=new u(this,f,l.address),this._cells[l.col-1]=h}return h}getCell(l){if(typeof l=="string"){const h=this._worksheet.getColumnKey(l);l=h?h.number:r.l2n(l)}return this._cells[l-1]||this.getCellEx({address:r.encodeAddress(this._number,l),row:this._number,col:l})}splice(l,h){const f=l+h;for(var d=arguments.length,p=new Array(d>2?d-2:0),b=2;b<d;b++)p[b-2]=arguments[b];const v=p.length-h,x=this._cells.length;let w,M,E;if(v<0)for(w=l+p.length;w<=x;w++)E=this._cells[w-1],M=this._cells[w-v-1],M?(E=this.getCell(w),E.value=M.value,E.style=M.style,E._comment=M._comment):E&&(E.value=null,E.style={},E._comment=void 0);else if(v>0)for(w=x;w>=f;w--)M=this._cells[w-1],M?(E=this.getCell(w+v),E.value=M.value,E.style=M.style,E._comment=M._comment):this._cells[w+v-1]=void 0;for(w=0;w<p.length;w++)E=this.getCell(l+w),E.value=p[w],E.style={},E._comment=void 0}eachCell(l,h){if(h||(h=l,l=null),l&&l.includeEmpty){const f=this._cells.length;for(let d=1;d<=f;d++)h(this.getCell(d),d)}else this._cells.forEach((f,d)=>{f&&f.type!==o.ValueType.Null&&h(f,d+1)})}addPageBreak(l,h){const f=this._worksheet,d=Math.max(0,l-1)||0,p=Math.max(0,h-1)||16838,b={id:this._number,max:p,man:1};d&&(b.min=d),f.rowBreaks.push(b)}get values(){const l=[];return this._cells.forEach(h=>{h&&h.type!==o.ValueType.Null&&(l[h.col]=h.value)}),l}set values(l){if(this._cells=[],l)if(l instanceof Array){let h=0;l.hasOwnProperty("0")&&(h=1),l.forEach((f,d)=>{f!==void 0&&(this.getCellEx({address:r.encodeAddress(this._number,d+h),row:this._number,col:d+h}).value=f)})}else this._worksheet.eachColumnKey((h,f)=>{l[f]!==void 0&&(this.getCellEx({address:r.encodeAddress(this._number,h.number),row:this._number,col:h.number}).value=l[f])})}get hasValues(){return a.some(this._cells,l=>l&&l.type!==o.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let l=0;return this.eachCell(()=>{l++}),l}get dimensions(){let l=0,h=0;return this._cells.forEach(f=>{f&&f.type!==o.ValueType.Null&&((!l||l>f.col)&&(l=f.col),h<f.col&&(h=f.col))}),l>0?{min:l,max:h}:null}_applyStyle(l,h){return this.style[l]=h,this._cells.forEach(f=>{f&&(f[l]=h)}),h}get numFmt(){return this.style.numFmt}set numFmt(l){this._applyStyle("numFmt",l)}get font(){return this.style.font}set font(l){this._applyStyle("font",l)}get alignment(){return this.style.alignment}set alignment(l){this._applyStyle("alignment",l)}get protection(){return this.style.protection}set protection(l){this._applyStyle("protection",l)}get border(){return this.style.border}set border(l){this._applyStyle("border",l)}get fill(){return this.style.fill}set fill(l){this._applyStyle("fill",l)}get hidden(){return!!this._hidden}set hidden(l){this._hidden=l}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(l){this._outlineLevel=l}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const l=[];let h=0,f=0;return this._cells.forEach(d=>{if(d){const p=d.model;p&&((!h||h>d.col)&&(h=d.col),f<d.col&&(f=d.col),l.push(p))}}),this.height||l.length?{cells:l,number:this.number,min:h,max:f,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(l){if(l.number!==this._number)throw new Error("Invalid row number in model");let h;this._cells=[],l.cells.forEach(f=>{switch(f.type){case u.Types.Merge:break;default:{let d;if(f.address)d=r.decodeAddress(f.address);else if(h){const{row:p}=h,b=h.col+1;d={row:p,col:b,address:r.encodeAddress(p,b),$col$row:`$${r.n2l(b)}$${p}`}}h=d,this.getCellEx(d).model=f;break}}}),l.height?this.height=l.height:delete this.height,this.hidden=l.hidden,this.outlineLevel=l.outlineLevel||0,this.style=l.style&&JSON.parse(JSON.stringify(l.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,i,s){const a=e("../utils/col-cache");class o{constructor(u,l,h){this.table=u,this.column=l,this.index=h}_set(u,l){this.table.cacheState(),this.column[u]=l}get name(){return this.column.name}set name(u){this._set("name",u)}get filterButton(){return this.column.filterButton}set filterButton(u){this.column.filterButton=u}get style(){return this.column.style}set style(u){this.column.style=u}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(u){this._set("totalsRowLabel",u)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(u){this._set("totalsRowFunction",u)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(u){this._set("totalsRowResult",u)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(u){this._set("totalsRowFormula",u)}}i.exports=class{constructor(r,u){this.worksheet=r,u&&(this.table=u,this.validate(),this.store())}getFormula(r){switch(r.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${r.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${r.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${r.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${r.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${r.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${r.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${r.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${r.name}])`;case"custom":return r.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+r.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:r}=this,u=(v,x,w)=>{v[x]===void 0&&(v[x]=w)};u(r,"headerRow",!0),u(r,"totalsRow",!1),u(r,"style",{}),u(r.style,"theme","TableStyleMedium2"),u(r.style,"showFirstColumn",!1),u(r.style,"showLastColumn",!1),u(r.style,"showRowStripes",!1),u(r.style,"showColumnStripes",!1);const l=(v,x)=>{if(!v)throw new Error(x)};l(r.ref,"Table must have ref"),l(r.columns,"Table must have column definitions"),l(r.rows,"Table must have row definitions"),r.tl=a.decodeAddress(r.ref);const{row:h,col:f}=r.tl;l(h>0,"Table must be on valid row"),l(f>0,"Table must be on valid col");const{width:d,filterHeight:p,tableHeight:b}=this;r.autoFilterRef=a.encode(h,f,h+p-1,f+d-1),r.tableRef=a.encode(h,f,h+b-1,f+d-1),r.columns.forEach((v,x)=>{l(v.name,`Column ${x} must have a name`),x===0?u(v,"totalsRowLabel","Total"):(u(v,"totalsRowFunction","none"),v.totalsRowFormula=this.getFormula(v))})}store(){const r=(p,b)=>{b&&Object.keys(b).forEach(v=>{p[v]=b[v]})},{worksheet:u,table:l}=this,{row:h,col:f}=l.tl;let d=0;if(l.headerRow){const p=u.getRow(h+d++);l.columns.forEach((b,v)=>{const{style:x,name:w}=b,M=p.getCell(f+v);M.value=w,r(M,x)})}if(l.rows.forEach(p=>{const b=u.getRow(h+d++);p.forEach((v,x)=>{const w=b.getCell(f+x);w.value=v,r(w,l.columns[x].style)})}),l.totalsRow){const p=u.getRow(h+d++);l.columns.forEach((b,v)=>{const x=p.getCell(f+v);if(v===0)x.value=b.totalsRowLabel;else{const w=this.getFormula(b);x.value=w?{formula:b.totalsRowFormula,result:b.totalsRowResult}:null}r(x,b.style)})}}load(r){const{table:u}=this,{row:l,col:h}=u.tl;let f=0;if(u.headerRow){const d=r.getRow(l+f++);u.columns.forEach((p,b)=>{d.getCell(h+b).value=p.name})}if(u.rows.forEach(d=>{const p=r.getRow(l+f++);d.forEach((b,v)=>{p.getCell(h+v).value=b})}),u.totalsRow){const d=r.getRow(l+f++);u.columns.forEach((p,b)=>{const v=d.getCell(h+b);b===0?v.value=p.totalsRowLabel:this.getFormula(p)&&(v.value={formula:p.totalsRowFormula,result:p.totalsRowResult})})}}get model(){return this.table}set model(r){this.table=r}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const r=a.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let u=0;u<this._cache.tableHeight;u++){const l=this.worksheet.getRow(r.row+u);for(let h=0;h<this._cache.width;h++)l.getCell(r.col+h).value=null}else{for(let u=this.tableHeight;u<this._cache.tableHeight;u++){const l=this.worksheet.getRow(r.row+u);for(let h=0;h<this._cache.width;h++)l.getCell(r.col+h).value=null}for(let u=0;u<this.tableHeight;u++){const l=this.worksheet.getRow(r.row+u);for(let h=this.width;h<this._cache.width;h++)l.getCell(r.col+h).value=null}}this.store()}addRow(r,u){this.cacheState(),u===void 0?this.table.rows.push(r):this.table.rows.splice(u,0,r)}removeRows(r){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(r,u)}getColumn(r){const u=this.table.columns[r];return new o(this,u,r)}addColumn(r,u,l){this.cacheState(),l===void 0?(this.table.columns.push(r),this.table.rows.forEach((h,f)=>{h.push(u[f])})):(this.table.columns.splice(l,0,r),this.table.rows.forEach((h,f)=>{h.splice(l,0,u[f])}))}removeColumns(r){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(r,u),this.table.rows.forEach(l=>{l.splice(r,u)})}_assign(r,u,l){this.cacheState(),r[u]=l}get ref(){return this.table.ref}set ref(r){this._assign(this.table,"ref",r)}get name(){return this.table.name}set name(r){this.table.name=r}get displayName(){return this.table.displyName||this.table.name}set displayNamename(r){this.table.displayName=r}get headerRow(){return this.table.headerRow}set headerRow(r){this._assign(this.table,"headerRow",r)}get totalsRow(){return this.table.totalsRow}set totalsRow(r){this._assign(this.table,"totalsRow",r)}get theme(){return this.table.style.name}set theme(r){this.table.style.name=r}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(r){this.table.style.showFirstColumn=r}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(r){this.table.style.showLastColumn=r}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(r){this.table.style.showRowStripes=r}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(r){this.table.style.showColumnStripes=r}}},{"../utils/col-cache":19}],13:[function(e,i,s){const a=e("./worksheet"),o=e("./defined-names"),r=e("../xlsx/xlsx"),u=e("../csv/csv");i.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new o}get xlsx(){return this._xlsx||(this._xlsx=new r(this)),this._xlsx}get csv(){return this._csv||(this._csv=new u(this)),this._csv}get nextId(){for(let l=1;l<this._worksheets.length;l++)if(!this._worksheets[l])return l;return this._worksheets.length||1}addWorksheet(l,h){const f=this.nextId;h&&(typeof h=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),h={properties:{tabColor:{argb:h}}}):(h.argb||h.theme||h.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),h={properties:{tabColor:h}}));const d=this._worksheets.reduce((v,x)=>(x&&x.orderNo)>v?x.orderNo:v,0),p=Object.assign({},h,{id:f,name:l,orderNo:d+1,workbook:this}),b=new a(p);return this._worksheets[f]=b,b}removeWorksheetEx(l){delete this._worksheets[l.id]}removeWorksheet(l){const h=this.getWorksheet(l);h&&h.destroy()}getWorksheet(l){return l===void 0?this._worksheets.find(Boolean):typeof l=="number"?this._worksheets[l]:typeof l=="string"?this._worksheets.find(h=>h&&h.name===l):void 0}get worksheets(){return this._worksheets.slice(1).sort((l,h)=>l.orderNo-h.orderNo).filter(Boolean)}eachSheet(l){this.worksheets.forEach(h=>{l(h,h.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(l){const h=this.media.length;return this.media.push(Object.assign({},l,{type:"image"})),h}getImage(l){return this.media[l]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(l=>l.model),sheets:this.worksheets.map(l=>l.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(l){this.creator=l.creator,this.lastModifiedBy=l.lastModifiedBy,this.lastPrinted=l.lastPrinted,this.created=l.created,this.modified=l.modified,this.company=l.company,this.manager=l.manager,this.title=l.title,this.subject=l.subject,this.keywords=l.keywords,this.category=l.category,this.description=l.description,this.language=l.language,this.revision=l.revision,this.contentStatus=l.contentStatus,this.properties=l.properties,this.calcProperties=l.calcProperties,this._worksheets=[],l.worksheets.forEach(h=>{const{id:f,name:d,state:p}=h,b=l.sheets&&l.sheets.findIndex(v=>v.id===f);(this._worksheets[f]=new a({id:f,name:d,orderNo:b,state:p,workbook:this})).model=h}),this._definedNames.model=l.definedNames,this.views=l.views,this._themes=l.themes,this.media=l.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,i,s){const a=e("../utils/under-dash"),o=e("../utils/col-cache"),r=e("./range"),u=e("./row"),l=e("./column"),h=e("./enums"),f=e("./image"),d=e("./table"),p=e("./data-validations"),b=e("../utils/encryptor"),{copyStyle:v}=e("../utils/copy-style");i.exports=class{constructor(x){x=x||{},this._workbook=x.workbook,this.id=x.id,this.orderNo=x.orderNo,this.name=x.name,this.state=x.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},x.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!x.pageSetup||!x.pageSetup.fitToWidth&&!x.pageSetup.fitToHeight||x.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},x.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},x.headerFooter),this.dataValidations=new p,this.views=x.views||[],this.autoFilter=x.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(x){if(x===void 0&&(x="sheet"+this.id),this._name!==x){if(typeof x!="string")throw new Error("The name has to be a string.");if(x==="")throw new Error("The name can't be empty.");if(x==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(x))throw new Error(`Worksheet name ${x} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(x))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+x);if(x&&x.length>31&&(console.warn(`Worksheet name ${x} exceeds 31 chars. This will be truncated`),x=x.substring(0,31)),this._workbook._worksheets.find(w=>w&&w.name.toLowerCase()===x.toLowerCase()))throw new Error("Worksheet name already exists: "+x);this._name=x}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const x=new r;return this._rows.forEach(w=>{if(w){const M=w.dimensions;M&&x.expand(w.number,M.min,w.number,M.max)}}),x}get columns(){return this._columns}set columns(x){this._headerRowCount=x.reduce((E,D)=>{const N=(D.header?1:D.headers&&D.headers.length)||0;return Math.max(E,N)},0);let w=1;const M=this._columns=[];x.forEach(E=>{const D=new l(this,w++,!1);M.push(D),D.defn=E})}getColumnKey(x){return this._keys[x]}setColumnKey(x,w){this._keys[x]=w}deleteColumnKey(x){delete this._keys[x]}eachColumnKey(x){a.each(this._keys,x)}getColumn(x){if(typeof x=="string"){const w=this._keys[x];if(w)return w;x=o.l2n(x)}if(this._columns||(this._columns=[]),x>this._columns.length){let w=this._columns.length+1;for(;w<=x;)this._columns.push(new l(this,w++))}return this._columns[x-1]}spliceColumns(x,w){const M=this._rows.length;for(var E=arguments.length,D=new Array(E>2?E-2:0),N=2;N<E;N++)D[N-2]=arguments[N];if(D.length>0)for(let Z=0;Z<M;Z++){const tt=[x,w];D.forEach(J=>{tt.push(J[Z]||null)});const rt=this.getRow(Z+1);rt.splice.apply(rt,tt)}else this._rows.forEach(Z=>{Z&&Z.splice(x,w)});const V=D.length-w,K=x+w,j=this._columns.length;if(V<0)for(let Z=x+D.length;Z<=j;Z++)this.getColumn(Z).defn=this.getColumn(Z-V).defn;else if(V>0)for(let Z=j;Z>=K;Z--)this.getColumn(Z+V).defn=this.getColumn(Z).defn;for(let Z=x;Z<x+D.length;Z++)this.getColumn(Z).defn=null;this.workbook.definedNames.spliceColumns(this.name,x,w,D.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let x=0;return this.eachRow(w=>{x=Math.max(x,w.cellCount)}),x}get actualColumnCount(){const x=[];let w=0;return this.eachRow(M=>{M.eachCell(E=>{let{col:D}=E;x[D]||(x[D]=!0,w++)})}),w}_commitRow(){}get _lastRowNumber(){const x=this._rows;let w=x.length;for(;w>0&&x[w-1]===void 0;)w--;return w}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(x){return this._rows[x-1]}findRows(x,w){return this._rows.slice(x-1,x-1+w)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let x=0;return this.eachRow(()=>{x++}),x}getRow(x){let w=this._rows[x-1];return w||(w=this._rows[x-1]=new u(this,x)),w}getRows(x,w){if(w<1)return;const M=[];for(let E=x;E<x+w;E++)M.push(this.getRow(E));return M}addRow(x){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const M=this._nextRow,E=this.getRow(M);return E.values=x,this._setStyleOption(M,w[0]==="i"?w:"n"),E}addRows(x){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const M=[];return x.forEach(E=>{M.push(this.addRow(E,w))}),M}insertRow(x,w){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(x,0,w),this._setStyleOption(x,M),this.getRow(x)}insertRows(x,w){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(x,0,...w),M!=="n")for(let E=0;E<w.length;E++)M[0]==="o"&&this.findRow(w.length+x+E)!==void 0?this._copyStyle(w.length+x+E,x+E,M[1]==="+"):M[0]==="i"&&this.findRow(x-1)!==void 0&&this._copyStyle(x-1,x+E,M[1]==="+");return this.getRows(x,w.length)}_setStyleOption(x){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";w[0]==="o"&&this.findRow(x+1)!==void 0?this._copyStyle(x+1,x,w[1]==="+"):w[0]==="i"&&this.findRow(x-1)!==void 0&&this._copyStyle(x-1,x,w[1]==="+")}_copyStyle(x,w){let M=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const E=this.getRow(x),D=this.getRow(w);D.style=v(E.style),E.eachCell({includeEmpty:M},(N,V)=>{D.getCell(V).style=v(N.style)}),D.height=E.height}duplicateRow(x,w){let M=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const E=this._rows[x-1],D=new Array(w).fill(E.values);this.spliceRows(x+1,M?0:w,...D);for(let N=0;N<w;N++){const V=this._rows[x+N];V.style=E.style,V.height=E.height,E.eachCell({includeEmpty:!0},(K,j)=>{V.getCell(j).style=K.style})}}spliceRows(x,w){const M=x+w;for(var E=arguments.length,D=new Array(E>2?E-2:0),N=2;N<E;N++)D[N-2]=arguments[N];const V=D.length,K=V-w,j=this._rows.length;let Z,tt;if(K<0)for(x===j&&(this._rows[j-1]=void 0),Z=M;Z<=j;Z++)if(tt=this._rows[Z-1],tt){const rt=this.getRow(Z+K);rt.values=tt.values,rt.style=tt.style,rt.height=tt.height,tt.eachCell({includeEmpty:!0},(J,U)=>{rt.getCell(U).style=J.style}),this._rows[Z-1]=void 0}else this._rows[Z+K-1]=void 0;else if(K>0)for(Z=j;Z>=M;Z--)if(tt=this._rows[Z-1],tt){const rt=this.getRow(Z+K);rt.values=tt.values,rt.style=tt.style,rt.height=tt.height,tt.eachCell({includeEmpty:!0},(J,U)=>{if(rt.getCell(U).style=J.style,J._value.constructor.name==="MergeValue"){const G=this.getRow(J._row._number+V).getCell(U),I=J._value._master,C=this.getRow(I._row._number+V).getCell(I._column._number);G.merge(C)}})}else this._rows[Z+K-1]=void 0;for(Z=0;Z<V;Z++){const rt=this.getRow(x+Z);rt.style={},rt.values=D[Z]}this.workbook.definedNames.spliceRows(this.name,x,w,V)}eachRow(x,w){if(w||(w=x,x=void 0),x&&x.includeEmpty){const M=this._rows.length;for(let E=1;E<=M;E++)w(this.getRow(E),E)}else this._rows.forEach(M=>{M&&M.hasValues&&w(M,M.number)})}getSheetValues(){const x=[];return this._rows.forEach(w=>{w&&(x[w.number]=w.values)}),x}findCell(x,w){const M=o.getAddress(x,w),E=this._rows[M.row-1];return E?E.findCell(M.col):void 0}getCell(x,w){const M=o.getAddress(x,w);return this.getRow(M.row).getCellEx(M)}mergeCells(){for(var x=arguments.length,w=new Array(x),M=0;M<x;M++)w[M]=arguments[M];const E=new r(w);this._mergeCellsInternal(E)}mergeCellsWithoutStyle(){for(var x=arguments.length,w=new Array(x),M=0;M<x;M++)w[M]=arguments[M];const E=new r(w);this._mergeCellsInternal(E,!0)}_mergeCellsInternal(x,w){a.each(this._merges,E=>{if(E.intersects(x))throw new Error("Cannot merge already merged cells")});const M=this.getCell(x.top,x.left);for(let E=x.top;E<=x.bottom;E++)for(let D=x.left;D<=x.right;D++)(E>x.top||D>x.left)&&this.getCell(E,D).merge(M,w);this._merges[M.address]=x}_unMergeMaster(x){const w=this._merges[x.address];if(w){for(let M=w.top;M<=w.bottom;M++)for(let E=w.left;E<=w.right;E++)this.getCell(M,E).unmerge();delete this._merges[x.address]}}get hasMerges(){return a.some(this._merges,Boolean)}unMergeCells(){for(var x=arguments.length,w=new Array(x),M=0;M<x;M++)w[M]=arguments[M];const E=new r(w);for(let D=E.top;D<=E.bottom;D++)for(let N=E.left;N<=E.right;N++){const V=this.findCell(D,N);V&&(V.type===h.ValueType.Merge?this._unMergeMaster(V.master):this._merges[V.address]&&this._unMergeMaster(V))}}fillFormula(x,w,M){let E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const D=o.decode(x),{top:N,left:V,bottom:K,right:j}=D,Z=j-V+1,tt=o.encodeAddress(N,V),rt=E==="shared";let J;J=typeof M=="function"?M:Array.isArray(M)?Array.isArray(M[0])?(G,I)=>M[G-N][I-V]:(G,I)=>M[(G-N)*Z+(I-V)]:()=>{};let U=!0;for(let G=N;G<=K;G++)for(let I=V;I<=j;I++)U?(this.getCell(G,I).value={shareType:E,formula:w,ref:x,result:J(G,I)},U=!1):this.getCell(G,I).value=rt?{sharedFormula:tt,result:J(G,I)}:J(G,I)}addImage(x,w){const M={type:"image",imageId:x,range:w};this._media.push(new f(this,M))}getImages(){return this._media.filter(x=>x.type==="image")}addBackgroundImage(x){const w={type:"background",imageId:x};this._media.push(new f(this,w))}getBackgroundImageId(){const x=this._media.find(w=>w.type==="background");return x&&x.imageId}protect(x,w){return new Promise(M=>{this.sheetProtection={sheet:!0},w&&"spinCount"in w&&(w.spinCount=Number.isFinite(w.spinCount)?Math.round(Math.max(0,w.spinCount)):1e5),x&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=b.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=w&&"spinCount"in w?w.spinCount:1e5,this.sheetProtection.hashValue=b.convertPasswordToHash(x,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),w&&(this.sheetProtection=Object.assign(this.sheetProtection,w),!x&&"spinCount"in w&&delete this.sheetProtection.spinCount),M()})}unprotect(){this.sheetProtection=null}addTable(x){const w=new d(this,x);return this.tables[x.name]=w,w}getTable(x){return this.tables[x]}removeTable(x){delete this.tables[x]}getTables(){return Object.values(this.tables)}addConditionalFormatting(x){this.conditionalFormattings.push(x)}removeConditionalFormatting(x){typeof x=="number"?this.conditionalFormattings.splice(x,1):this.conditionalFormattings=x instanceof Function?this.conditionalFormattings.filter(x):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(x){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=x}get model(){const x={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(E=>E.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(E=>E.model),conditionalFormattings:this.conditionalFormattings};x.cols=l.toModel(this.columns);const w=x.rows=[],M=x.dimensions=new r;return this._rows.forEach(E=>{const D=E&&E.model;D&&(M.expand(D.number,D.min,D.number,D.max),w.push(D))}),x.merges=[],a.each(this._merges,E=>{x.merges.push(E.range)}),x}_parseRows(x){this._rows=[],x.rows.forEach(w=>{const M=new u(this,w.number);this._rows[M.number-1]=M,M.model=w})}_parseMergeCells(x){a.each(x.mergeCells,w=>{this.mergeCellsWithoutStyle(w)})}set model(x){this.name=x.name,this._columns=l.fromModel(this,x.cols),this._parseRows(x),this._parseMergeCells(x),this.dataValidations=new p(x.dataValidations),this.properties=x.properties,this.pageSetup=x.pageSetup,this.headerFooter=x.headerFooter,this.views=x.views,this.autoFilter=x.autoFilter,this._media=x.media.map(w=>new f(this,w)),this.sheetProtection=x.sheetProtection,this.tables=x.tables.reduce((w,M)=>{const E=new d;return E.model=M,w[M.name]=E,w},{}),this.conditionalFormattings=x.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,i,s){e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const a={Workbook:e("./doc/workbook")},o=e("./doc/enums");Object.keys(o).forEach(r=>{a[r]=o[r]}),i.exports=a},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,i,s){const a=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");s.bufferToString=function(o){return typeof o=="string"?o:a?a.decode(o):o.toString()}},{}],17:[function(e,i,s){const a=typeof TextEncoder=="undefined"?null:new TextEncoder("utf-8"),{Buffer:o}=e("buffer");s.stringToBuffer=function(r){return typeof r!="string"?r:a?o.from(a.encode(r).buffer):o.from(r)}},{buffer:220}],18:[function(e,i,s){const a=e("./under-dash"),o=e("./col-cache");i.exports=class{constructor(r){this.template=r,this.sheets={}}addCell(r){this.addCellEx(o.decodeEx(r))}getCell(r){return this.findCellEx(o.decodeEx(r),!0)}findCell(r){return this.findCellEx(o.decodeEx(r),!1)}findCellAt(r,u,l){const h=this.sheets[r],f=h&&h[u];return f&&f[l]}addCellEx(r){if(r.top)for(let u=r.top;u<=r.bottom;u++)for(let l=r.left;l<=r.right;l++)this.getCellAt(r.sheetName,u,l);else this.findCellEx(r,!0)}getCellEx(r){return this.findCellEx(r,!0)}findCellEx(r,u){const l=this.findSheet(r,u),h=this.findSheetRow(l,r,u);return this.findRowCell(h,r,u)}getCellAt(r,u,l){const h=this.sheets[r]||(this.sheets[r]=[]),f=h[u]||(h[u]=[]);return f[l]||(f[l]={sheetName:r,address:o.n2l(l)+u,row:u,col:l})}removeCellEx(r){const u=this.findSheet(r);if(!u)return;const l=this.findSheetRow(u,r);l&&delete l[r.col]}forEachInSheet(r,u){const l=this.sheets[r];l&&l.forEach((h,f)=>{h&&h.forEach((d,p)=>{d&&u(d,f,p)})})}forEach(r){a.each(this.sheets,(u,l)=>{this.forEachInSheet(l,r)})}map(r){const u=[];return this.forEach(l=>{u.push(r(l))}),u}findSheet(r,u){const l=r.sheetName;return this.sheets[l]?this.sheets[l]:u?this.sheets[l]=[]:void 0}findSheetRow(r,u,l){const{row:h}=u;return r&&r[h]?r[h]:l?r[h]=[]:void 0}findRowCell(r,u,l){const{col:h}=u;return r&&r[h]?r[h]:l?r[h]=this.template?Object.assign(u,JSON.parse(JSON.stringify(this.template))):u:void 0}spliceRows(r,u,l,h){const f=this.sheets[r];if(f){const d=[];for(let p=0;p<h;p++)d.push([]);f.splice(u,l,...d)}}spliceColumns(r,u,l,h){const f=this.sheets[r];if(f){const d=[];for(let p=0;p<h;p++)d.push(null);a.each(f,p=>{p.splice(u,l,...d)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,i,s){const a=/^[A-Z]+\d+$/,o={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:r=>r<=26?1:r<=676?2:3,_fill(r){let u,l,h,f,d,p=1;if(r>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&r>=1){for(;p<=26;)u=this._dictionary[p-1],this._n2l[p]=u,this._l2n[u]=p,p++;this._l2nFill=1}if(this._l2nFill<2&&r>=2){for(p=27;p<=702;)l=p-27,h=l%26,f=Math.floor(l/26),u=this._dictionary[f]+this._dictionary[h],this._n2l[p]=u,this._l2n[u]=p,p++;this._l2nFill=2}if(this._l2nFill<3&&r>=3){for(p=703;p<=16384;)l=p-703,h=l%26,f=Math.floor(l/26)%26,d=Math.floor(l/676),u=this._dictionary[d]+this._dictionary[f]+this._dictionary[h],this._n2l[p]=u,this._l2n[u]=p,p++;this._l2nFill=3}},l2n(r){if(this._l2n[r]||this._fill(r.length),!this._l2n[r])throw new Error("Out of bounds. Invalid column letter: "+r);return this._l2n[r]},n2l(r){if(r<1||r>16384)throw new Error(r+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[r]||this._fill(this._level(r)),this._n2l[r]},_hash:{},validateAddress(r){if(!a.test(r))throw new Error("Invalid Address: "+r);return!0},decodeAddress(r){const u=r.length<5&&this._hash[r];if(u)return u;let l=!1,h="",f=0,d=!1,p="",b=0;for(let x,w=0;w<r.length;w++)if(x=r.charCodeAt(w),!d&&x>=65&&x<=90)l=!0,h+=r[w],f=26*f+x-64;else if(x>=48&&x<=57)d=!0,p+=r[w],b=10*b+x-48;else if(d&&l&&x!==36)break;if(l){if(f>16384)throw new Error("Out of bounds. Invalid column letter: "+h)}else f=void 0;d||(b=void 0);const v={address:r=h+p,col:f,row:b,$col$row:`$${h}$${p}`};return f<=100&&b<=100&&(this._hash[r]=v,this._hash[v.$col$row]=v),v},getAddress(r,u){if(u){const l=this.n2l(u)+r;return this.decodeAddress(l)}return this.decodeAddress(r)},decode(r){const u=r.split(":");if(u.length===2){const l=this.decodeAddress(u[0]),h=this.decodeAddress(u[1]),f={top:Math.min(l.row,h.row),left:Math.min(l.col,h.col),bottom:Math.max(l.row,h.row),right:Math.max(l.col,h.col)};return f.tl=this.n2l(f.left)+f.top,f.br=this.n2l(f.right)+f.bottom,f.dimensions=`${f.tl}:${f.br}`,f}return this.decodeAddress(r)},decodeEx(r){const u=r.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),l=u[1]||u[2],h=u[3],f=h.split(":");if(f.length>1){let p=this.decodeAddress(f[0]),b=this.decodeAddress(f[1]);const v=Math.min(p.row,b.row),x=Math.min(p.col,b.col),w=Math.max(p.row,b.row),M=Math.max(p.col,b.col);return p=this.n2l(x)+v,b=this.n2l(M)+w,{top:v,left:x,bottom:w,right:M,sheetName:l,tl:{address:p,col:x,row:v,$col$row:`$${this.n2l(x)}$${v}`,sheetName:l},br:{address:b,col:M,row:w,$col$row:`$${this.n2l(M)}$${w}`,sheetName:l},dimensions:`${p}:${b}`}}if(h.startsWith("#"))return l?{sheetName:l,error:h}:{error:h};const d=this.decodeAddress(h);return l?wi({sheetName:l},d):d},encodeAddress:(r,u)=>o.n2l(u)+r,encode(){switch(arguments.length){case 2:return o.encodeAddress(arguments[0],arguments[1]);case 4:return`${o.encodeAddress(arguments[0],arguments[1])}:${o.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(r,u){const[l,h,,f,d]=r,[p,b]=u;return p>=l&&p<=f&&b>=h&&b<=d}};i.exports=o},{}],20:[function(e,i,s){const a=(r,u)=>wi(wi({},r),u.reduce((l,h)=>(r[h]&&(l[h]=wi({},r[h])),l),{})),o=function(r,u,l){let h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];r[l]&&(u[l]=a(r[l],h))};s.copyStyle=r=>{if(!r)return r;if(u=r,Object.keys(u).length===0)return{};var u;const l=wi({},r);return o(r,l,"font",["color"]),o(r,l,"alignment"),o(r,l,"protection"),r.border&&(o(r,l,"border"),o(r.border,l.border,"top",["color"]),o(r.border,l.border,"left",["color"]),o(r.border,l.border,"bottom",["color"]),o(r.border,l.border,"right",["color"]),o(r.border,l.border,"diagonal",["color"])),r.fill&&(o(r,l,"fill",["fgColor","bgColor","center"]),r.fill.stops&&(l.fill.stops=r.fill.stops.map(h=>a(h,["color"])))),l}},{}],21:[function(e,i,s){(function(a){(function(){const o=e("crypto"),r={hash(u){const l=o.createHash(u);for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];return l.update(a.concat(f)),l.digest()},convertPasswordToHash(u,l,h,f){if(l=l.toLowerCase(),o.getHashes().indexOf(l)<0)throw new Error(`Hash algorithm '${l}' not supported!`);const d=a.from(u,"utf16le");let p=this.hash(l,a.from(h,"base64"),d);for(let b=0;b<f;b++){const v=a.alloc(4);v.writeUInt32LE(b,0),p=this.hash(l,p,v)}return p.toString("base64")},randomBytes:u=>o.randomBytes(u)};i.exports=r}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,i,s){const{SaxesParser:a}=e("saxes"),{PassThrough:o}=e("readable-stream"),{bufferToString:r}=e("./browser-buffer-decode");i.exports=function(u){return QA(this,null,function*(){u.pipe&&!u[Symbol.asyncIterator]&&(u=u.pipe(new o));const l=new a;let h;l.on("error",x=>{h=x});let f=[];l.on("opentag",x=>f.push({eventType:"opentag",value:x})),l.on("text",x=>f.push({eventType:"text",value:x})),l.on("closetag",x=>f.push({eventType:"closetag",value:x}));try{for(var d=g1(u),p,b,v;p=!(b=yield new m1(d.next())).done;p=!1){const x=b.value;if(l.write(r(x)),h)throw h;yield f,f=[]}}catch(b){v=[b]}finally{try{p&&(b=d.return)&&(yield new m1(b.call(d)))}finally{if(v)throw v[0]}}})}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,i,s){const a=e("./col-cache"),o=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,r=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;i.exports={slideFormula:function(u,l,h){const f=a.decode(l),d=a.decode(h);return u.replace(o,(p,b,v,x,w)=>{if(w)return p;const M=r.exec(x);if(M){const E=M[1],D=M[2].toUpperCase(),N=M[3],V=M[4];if(D.length>3||D.length===3&&D>"XFD")return p;let K=a.l2n(D),j=parseInt(V,10);return E||(K+=d.col-f.col),N||(j+=d.row-f.row),(b||"")+(E||"")+a.n2l(K)+(N||"")+j}return p})}}},{"./col-cache":19}],24:[function(e,i,s){(function(a,o){(function(){const r=e("readable-stream"),u=e("./utils"),l=e("./string-buf");class h{constructor(w,M){this._data=w,this._encoding=M}get length(){return this.toBuffer().length}copy(w,M,E,D){return this.toBuffer().copy(w,M,E,D)}toBuffer(){return this._buffer||(this._buffer=o.from(this._data,this._encoding)),this._buffer}}class f{constructor(w){this._data=w}get length(){return this._data.length}copy(w,M,E,D){return this._data._buf.copy(w,M,E,D)}toBuffer(){return this._data.toBuffer()}}class d{constructor(w){this._data=w}get length(){return this._data.length}copy(w,M,E,D){this._data.copy(w,M,E,D)}toBuffer(){return this._data}}class p{constructor(w){this.size=w,this.buffer=o.alloc(w),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const w=o.alloc(this.iWrite-this.iRead);return this.buffer.copy(w,0,this.iRead,this.iWrite),w}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(w){let M;return w===0?null:w===void 0||w>=this.length?(M=this.toBuffer(),this.iRead=this.iWrite,M):(M=o.alloc(w),this.buffer.copy(M,0,this.iRead,w),this.iRead+=w,M)}write(w,M,E){const D=Math.min(E,this.size-this.iWrite);return w.copy(this.buffer,this.iWrite,M,M+D),this.iWrite+=D,D}}const b=function(x){x=x||{},this.bufSize=x.bufSize||1048576,this.buffers=[],this.batch=x.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};u.inherits(b,r.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return o.concat(this.buffers.map(x=>x.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const w=this.buffers[this.buffers.length-1];if(!w.full)return w}const x=new p(this.bufSize);return this.buffers.push(x),x},_pipe(x){return re(this,null,function*(){yield Promise.all(this.pipes.map(function(w){return new Promise(M=>{w.write(x.toBuffer(),()=>{M()})})}))})},_writeToBuffers(x){let w=0;const M=x.length;for(;w<M;)w+=this._getWritableBuffer().write(x,w,M-w)},write(x,w,M){return re(this,null,function*(){let E;if(w instanceof Function&&(M=w,w="utf8"),M=M||u.nop,x instanceof l)E=new f(x);else if(x instanceof o)E=new d(x);else{if(!(typeof x=="string"||x instanceof String||x instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");E=new h(x,w)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(E);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(E),a.nextTick(M)):(yield this._pipe(E),M());else this.paused||this.emit("data",E.toBuffer()),this._writeToBuffers(E),this.emit("readable");return!0})},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(x,w,M){const E=D=>{D?M(D):(this._flush(),this.pipes.forEach(N=>{N.end()}),this.emit("finish"))};x?this.write(x,w,E):E()},read(x){let w;if(x){for(w=[];x&&this.buffers.length&&!this.buffers[0].eod;){const M=this.buffers[0],E=M.read(x);x-=E.length,w.push(E),M.eod&&M.full&&this.buffers.shift()}return o.concat(w)}return w=this.buffers.map(M=>M.toBuffer()).filter(Boolean),this.buffers=[],o.concat(w)},setEncoding(x){this.encoding=x},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(x){this.pipes.push(x),!this.paused&&this.buffers.length&&this.end()},unpipe(x){this.pipes=this.pipes.filter(w=>w!==x)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),i.exports=b}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,i,s){(function(a){(function(){i.exports=class{constructor(o){this._buf=a.alloc(o&&o.size||16384),this._encoding=o&&o.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=a.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(o){o=o||0,this._buffer=void 0,this._inPos=o}_grow(o){let r=2*this._buf.length;for(;r<o;)r*=2;const u=a.alloc(r);this._buf.copy(u,0),this._buf=u}addText(o){this._buffer=void 0;let r=this._inPos+this._buf.write(o,this._inPos,this._encoding);for(;r>=this._buf.length-4;)this._grow(this._inPos+o.length),r=this._inPos+this._buf.write(o,this._inPos,this._encoding);this._inPos=r}addStringBuf(o){o.length&&(this._buffer=void 0,this.length+o.length>this.capacity&&this._grow(this.length+o.length),o._buf.copy(this._buf,this._inPos,0,o.length),this._inPos+=o.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,i,s){const{toString:a}=Object.prototype,o=/["&<>]/,r={each:function(u,l){u&&(Array.isArray(u)?u.forEach(l):Object.keys(u).forEach(h=>{l(u[h],h)}))},some:function(u,l){return!!u&&(Array.isArray(u)?u.some(l):Object.keys(u).some(h=>l(u[h],h)))},every:function(u,l){return!u||(Array.isArray(u)?u.every(l):Object.keys(u).every(h=>l(u[h],h)))},map:function(u,l){return u?Array.isArray(u)?u.map(l):Object.keys(u).map(h=>l(u[h],h)):[]},keyBy:(u,l)=>u.reduce((h,f)=>(h[f[l]]=f,h),{}),isEqual:function(u,l){const h=typeof u,f=typeof l,d=Array.isArray(u),p=Array.isArray(l);let b;if(h!==f)return!1;switch(typeof u){case"object":if(d||p)return!(!d||!p)&&u.length===l.length&&u.every((v,x)=>{const w=l[x];return r.isEqual(v,w)});if(u===null||l===null)return u===l;if(b=Object.keys(u),Object.keys(l).length!==b.length)return!1;for(const v of b)if(!l.hasOwnProperty(v))return!1;return r.every(u,(v,x)=>{const w=l[x];return r.isEqual(v,w)});default:return u===l}},escapeHtml(u){const l=o.exec(u);if(!l)return u;let h="",f="",d=0,p=l.index;for(;p<u.length;p++){switch(u.charAt(p)){case'"':f="&quot;";break;case"&":f="&amp;";break;case"'":f="&apos;";break;case"<":f="&lt;";break;case">":f="&gt;";break;default:continue}d!==p&&(h+=u.substring(d,p)),d=p+1,h+=f}return d!==p?h+u.substring(d,p):h},strcmp:(u,l)=>u<l?-1:u>l?1:0,isUndefined:u=>a.call(u)==="[object Undefined]",isObject:u=>a.call(u)==="[object Object]",deepMerge(){const u=arguments[0]||{},{length:l}=arguments;let h,f,d;function p(b,v){h=u[v],d=Array.isArray(b),r.isObject(b)||d?(d?(d=!1,f=h&&Array.isArray(h)?h:[]):f=h&&r.isObject(h)?h:{},u[v]=r.deepMerge(f,b)):r.isUndefined(b)||(u[v]=b)}for(let b=0;b<l;b++)r.each(arguments[b],p);return u}};i.exports=r},{}],27:[function(e,i,s){(function(a,o){(function(){const r=e("fs"),u=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,l={nop(){},promiseImmediate:h=>new Promise(f=>{a.setImmediate?o(()=>{f(h)}):setTimeout(()=>{f(h)},1)}),inherits:function(h,f,d,p){h.super_=f,p||(p=d,d=null),d&&Object.keys(d).forEach(v=>{Object.defineProperty(h,v,Object.getOwnPropertyDescriptor(d,v))});const b={constructor:{value:h,enumerable:!1,writable:!1,configurable:!0}};p&&Object.keys(p).forEach(v=>{b[v]=Object.getOwnPropertyDescriptor(p,v)}),h.prototype=Object.create(f.prototype,b)},dateToExcel:(h,f)=>25569+h.getTime()/864e5-(f?1462:0),excelToDate(h,f){const d=Math.round(24*(h-25569+(f?1462:0))*3600*1e3);return new Date(d)},parsePath(h){const f=h.lastIndexOf("/");return{path:h.substring(0,f),name:h.substring(f+1)}},getRelsPath(h){const f=l.parsePath(h);return`${f.path}/_rels/${f.name}.rels`},xmlEncode(h){const f=u.exec(h);if(!f)return h;let d="",p="",b=0,v=f.index;for(;v<h.length;v++){const x=h.charCodeAt(v);switch(x){case 34:p="&quot;";break;case 38:p="&amp;";break;case 39:p="&apos;";break;case 60:p="&lt;";break;case 62:p="&gt;";break;case 127:p="";break;default:if(x<=31&&(x<=8||x>=11&&x!==13)){p="";break}continue}b!==v&&(d+=h.substring(b,v)),b=v+1,p&&(d+=p)}return b!==v?d+h.substring(b,v):d},xmlDecode:h=>h.replace(/&([a-z]*);/g,f=>{switch(f){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return f}}),validInt(h){const f=parseInt(h,10);return Number.isNaN(f)?0:f},isDateFmt(h){return h?(h=(h=h.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:h=>new Promise(f=>{r.access(h,r.constants.F_OK,d=>{f(!d)})})},toIsoDateString:h=>h.toIsoString().subsstr(0,10),parseBoolean:h=>h===!0||h==="true"||h===1||h==="1"};i.exports=l}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,i,s){const a=e("./under-dash"),o=e("./utils");function r(h,f,d){h.push(` ${f}="${o.xmlEncode(d.toString())}"`)}function u(h,f){if(f){const d=[];a.each(f,(p,b)=>{p!==void 0&&r(d,b,p)}),h.push(d.join(""))}}class l{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(f){const d=this._xml;d.push("<?xml"),u(d,f),d.push(`?>
`)}openNode(f,d){const p=this.tos,b=this._xml;p&&this.open&&b.push(">"),this._stack.push(f),b.push("<"),b.push(f),u(b,d),this.leaf=!0,this.open=!0}addAttribute(f,d){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");d!==void 0&&r(this._xml,f,d)}addAttributes(f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");u(this._xml,f)}writeText(f){const d=this._xml;this.open&&(d.push(">"),this.open=!1),this.leaf=!1,d.push(o.xmlEncode(f.toString()))}writeXml(f){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(f)}closeNode(){const f=this._stack.pop(),d=this._xml;this.leaf?d.push("/>"):(d.push("</"),d.push(f),d.push(">")),this.open=!1,this.leaf=!1}leafNode(f,d,p){this.openNode(f,d),p!==void 0&&this.writeText(p),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const f=this._rollbacks.pop();this._xml.length>f.xml&&this._xml.splice(f.xml,this._xml.length-f.xml),this._stack.length>f.stack&&this._stack.splice(f.stack,this._stack.length-f.stack),this.leaf=f.leaf,this.open=f.open}get xml(){return this.closeAll(),this._xml.join("")}}l.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},i.exports=l},{"./under-dash":26,"./utils":27}],29:[function(e,i,s){(function(a){(function(){const o=e("events"),r=e("jszip"),u=e("./stream-buf"),{stringToBuffer:l}=e("./browser-buffer-encode");class h extends o.EventEmitter{constructor(d){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},d),this.zip=new r,this.stream=new u}append(d,p){p.hasOwnProperty("base64")&&p.base64?this.zip.file(p.name,d,{base64:!0}):(a.browser&&typeof d=="string"&&(d=l(d)),this.zip.file(p.name,d))}finalize(){return re(this,null,function*(){const d=yield this.zip.generateAsync(this.options);this.stream.end(d),this.emit("finish")})}read(d){return this.stream.read(d)}setEncoding(d){return this.stream.setEncoding(d)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(d,p){return this.stream.pipe(d,p)}unpipe(d){return this.stream.unpipe(d)}unshift(d){return this.stream.unshift(d)}wrap(d){return this.stream.wrap(d)}}i.exports={ZipWriter:h}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,i,s){i.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"年"m"月"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"年" mm"月" dd"日"'},28:{"zh-tw":'[$-404]e"年"m"月"d"日"',"zh-cn":'m"月"d"日"',"ja-jp":'[$-411]ggge"年"m"月"d"日"',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e"年"m"月"d"日"',"zh-cn":'m"月"d"日"',"ja-jp":'[$-411]ggge"年"m"月"d"日"',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy"年"m"月"d"日"',"zh-cn":'yyyy"年"m"月"d"日"',"ja-jp":'yyyy"年"m"月"d"日"',"ko-kr":'yyyy"년" mm"월" dd"일"'},32:{"zh-tw":'hh"時"mm"分"',"zh-cn":'h"时"mm"分"',"ja-jp":'h"時"mm"分"',"ko-kr":'h"시" mm"분"'},33:{"zh-tw":'hh"時"mm"分"ss"秒"',"zh-cn":'h"时"mm"分"ss"秒"',"ja-jp":'h"時"mm"分"ss"秒"',"ko-kr":'h"시" mm"분" ss"초"'},34:{"zh-tw":'上午/下午 hh"時"mm"分"',"zh-cn":'上午/下午 h"时"mm"分"',"ja-jp":'yyyy"年"m"月"',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'上午/下午 hh"時"mm"分"ss"秒"',"zh-cn":'上午/下午 h"时"mm"分"ss"秒"',"ja-jp":'m"月"d"日"',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"年"m"月"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"年" mm"月" dd"日"'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"年"m"月"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"年" mm"月" dd"日"'},51:{"zh-tw":'[$-404]e"年"m"月"d"日"',"zh-cn":'m"月"d"日"',"ja-jp":'[$-411]ggge"年"m"月"d"日"',"ko-kr":"mm-dd"},52:{"zh-tw":'上午/下午 hh"時"mm"分"',"zh-cn":'yyyy"年"m"月"',"ja-jp":'yyyy"年"m"月"',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'上午/下午 hh"時"mm"分"ss"秒"',"zh-cn":'m"月"d"日"',"ja-jp":'m"月"d"日"',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e"年"m"月"d"日"',"zh-cn":'m"月"d"日"',"ja-jp":'[$-411]ggge"年"m"月"d"日"',"ko-kr":"mm-dd"},55:{"zh-tw":'上午/下午 hh"時"mm"分"',"zh-cn":'上午/下午 h"时"mm"分"',"ja-jp":'yyyy"年"m"月"',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'上午/下午 hh"時"mm"分"ss"秒"',"zh-cn":'上午/下午 h"时"mm"分"ss"秒"',"ja-jp":'m"月"d"日"',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"年"m"月"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"年" mm"月" dd"日"'},58:{"zh-tw":'[$-404]e"年"m"月"d"日"',"zh-cn":'m"月"d"日"',"ja-jp":'[$-411]ggge"年"m"月"d"日"',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,i,s){i.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,i,s){const a=e("../../utils/parse-sax"),o=e("../../utils/xml-stream");class r{prepare(){}render(){}parseOpen(l){}parseText(l){}parseClose(l){}reconcile(l,h){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(l=>{l instanceof r?l.reset():l.xform&&l.xform.reset()})}mergeModel(l){this.model=Object.assign(this.model||{},l)}parse(l){return re(this,null,function*(){try{for(var h=g1(l),f,d,p;f=!(d=yield h.next()).done;f=!1){const b=d.value;for(const{eventType:v,value:x}of b)if(v==="opentag")this.parseOpen(x);else if(v==="text")this.parseText(x);else if(v==="closetag"&&!this.parseClose(x.name))return this.model}}catch(d){p=[d]}finally{try{f&&(d=h.return)&&(yield d.call(h))}finally{if(p)throw p[0]}}return this.model})}parseStream(l){return re(this,null,function*(){return this.parse(a(l))})}get xml(){return this.toXml(this.model)}toXml(l){const h=new o;return this.render(h,l),h.xml}static toAttribute(l,h){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(f)return h}else if(f||l!==h)return l.toString()}static toStringAttribute(l,h){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.toAttribute(l,h,f)}static toStringValue(l,h){return l===void 0?h:l}static toBoolAttribute(l,h){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(f)return h}else if(f||l!==h)return l?"1":"0"}static toBoolValue(l,h){return l===void 0?h:l==="1"}static toIntAttribute(l,h){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.toAttribute(l,h,f)}static toIntValue(l,h){return l===void 0?h:parseInt(l,10)}static toFloatAttribute(l,h){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.toAttribute(l,h,f)}static toFloatValue(l,h){return l===void 0?h:parseFloat(l)}}i.exports=r},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,i,s){const a=e("../base-xform"),o=e("../../../utils/col-cache");function r(l){try{return o.decodeEx(l),!0}catch(h){return!1}}function u(l){const h=[];let f=!1,d="";return l.split(",").forEach(p=>{if(!p)return;const b=(p.match(/'/g)||[]).length;if(!b)return void(f?d+=p+",":r(p)&&h.push(p));const v=b%2==0;!f&&v&&r(p)?h.push(p):f&&!v?(f=!1,r(d+p)&&h.push(d+p),d=""):(f=!0,d+=p+",")}),h}i.exports=class extends a{render(l,h){l.openNode("definedName",{name:h.name,localSheetId:h.localSheetId}),l.writeText(h.ranges.join(",")),l.closeNode()}parseOpen(l){switch(l.name){case"definedName":return this._parsedName=l.attributes.name,this._parsedLocalSheetId=l.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(l){this._parsedText.push(l)}parseClose(){return this.model={name:this._parsedName,ranges:u(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,i,s){const a=e("../../../utils/utils"),o=e("../base-xform");i.exports=class extends o{render(r,u){r.leafNode("sheet",{sheetId:u.id,name:u.name,state:u.state,"r:id":u.rId})}parseOpen(r){return r.name==="sheet"&&(this.model={name:a.xmlDecode(r.attributes.name),id:parseInt(r.attributes.sheetId,10),state:r.attributes.state,rId:r.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{render(o,r){o.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:r.fullCalcOnLoad?1:void 0})}parseOpen(o){return o.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{render(o,r){o.leafNode("workbookPr",{date1904:r.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(o){return o.name==="workbookPr"&&(this.model={date1904:o.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{render(o,r){const u={xWindow:r.x||0,yWindow:r.y||0,windowWidth:r.width||12e3,windowHeight:r.height||24e3,firstSheet:r.firstSheet,activeTab:r.activeTab};r.visibility&&r.visibility!=="visible"&&(u.visibility=r.visibility),o.leafNode("workbookView",u)}parseOpen(o){if(o.name==="workbookView"){const r=this.model={},u=function(h,f,d){const p=f!==void 0?r[h]=f:d;p!==void 0&&(r[h]=p)},l=function(h,f,d){const p=f!==void 0?r[h]=parseInt(f,10):d;p!==void 0&&(r[h]=p)};return l("x",o.attributes.xWindow,0),l("y",o.attributes.yWindow,0),l("width",o.attributes.windowWidth,25e3),l("height",o.attributes.windowHeight,1e4),u("visibility",o.attributes.visibility,"visible"),l("activeTab",o.attributes.activeTab,void 0),l("firstSheet",o.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../../../utils/col-cache"),r=e("../../../utils/xml-stream"),u=e("../base-xform"),l=e("../static-xform"),h=e("../list-xform"),f=e("./defined-name-xform"),d=e("./sheet-xform"),p=e("./workbook-view-xform"),b=e("./workbook-properties-xform"),v=e("./workbook-calc-properties-xform");class x extends u{constructor(){super(),this.map={fileVersion:x.STATIC_XFORMS.fileVersion,workbookPr:new b,bookViews:new h({tag:"bookViews",count:!1,childXform:new p}),sheets:new h({tag:"sheets",count:!1,childXform:new d}),definedNames:new h({tag:"definedNames",count:!1,childXform:new f}),calcPr:new v}}prepare(M){M.sheets=M.worksheets;const E=[];let D=0;M.sheets.forEach(N=>{if(N.pageSetup&&N.pageSetup.printArea&&N.pageSetup.printArea.split("&&").forEach(V=>{const K=V.split(":"),j={name:"_xlnm.Print_Area",ranges:[`'${N.name}'!$${K[0]}:$${K[1]}`],localSheetId:D};E.push(j)}),N.pageSetup&&(N.pageSetup.printTitlesRow||N.pageSetup.printTitlesColumn)){const V=[];if(N.pageSetup.printTitlesColumn){const j=N.pageSetup.printTitlesColumn.split(":");V.push(`'${N.name}'!$${j[0]}:$${j[1]}`)}if(N.pageSetup.printTitlesRow){const j=N.pageSetup.printTitlesRow.split(":");V.push(`'${N.name}'!$${j[0]}:$${j[1]}`)}const K={name:"_xlnm.Print_Titles",ranges:V,localSheetId:D};E.push(K)}D++}),E.length&&(M.definedNames=M.definedNames.concat(E)),(M.media||[]).forEach((N,V)=>{N.name=N.type+(V+1)})}render(M,E){M.openXml(r.StdDocAttributes),M.openNode("workbook",x.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(M),this.map.workbookPr.render(M,E.properties),this.map.bookViews.render(M,E.views),this.map.sheets.render(M,E.sheets),this.map.definedNames.render(M,E.definedNames),this.map.calcPr.render(M,E.calcProperties),M.closeNode()}parseOpen(M){if(this.parser)return this.parser.parseOpen(M),!0;switch(M.name){case"workbook":return!0;default:return this.parser=this.map[M.name],this.parser&&this.parser.parseOpen(M),!0}}parseText(M){this.parser&&this.parser.parseText(M)}parseClose(M){if(this.parser)return this.parser.parseClose(M)||(this.parser=void 0),!0;switch(M){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(M){const E=(M.workbookRels||[]).reduce((j,Z)=>(j[Z.Id]=Z,j),{}),D=[];let N,V=0;(M.sheets||[]).forEach(j=>{const Z=E[j.rId];Z&&(N=M.worksheetHash["xl/"+Z.Target.replace(/^(\s|\/xl\/)+/,"")],N&&(N.name=j.name,N.id=j.id,N.state=j.state,D[V++]=N))});const K=[];a.each(M.definedNames,j=>{if(j.name==="_xlnm.Print_Area"){if(N=D[j.localSheetId],N){N.pageSetup||(N.pageSetup={});const Z=o.decodeEx(j.ranges[0]);N.pageSetup.printArea=N.pageSetup.printArea?`${N.pageSetup.printArea}&&${Z.dimensions}`:Z.dimensions}}else if(j.name==="_xlnm.Print_Titles"){if(N=D[j.localSheetId],N){N.pageSetup||(N.pageSetup={});const Z=j.ranges.join(","),tt=/\$/g,rt=/\$\d+:\$\d+/,J=Z.match(rt);if(J&&J.length){const I=J[0];N.pageSetup.printTitlesRow=I.replace(tt,"")}const U=/\$[A-Z]+:\$[A-Z]+/,G=Z.match(U);if(G&&G.length){const I=G[0];N.pageSetup.printTitlesColumn=I.replace(tt,"")}}}else K.push(j)}),M.definedNames=K,M.media.forEach((j,Z)=>{j.index=Z})}}x.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},x.STATIC_XFORMS={fileVersion:new l({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},i.exports=x},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,i,s){const a=e("../strings/rich-text-xform"),o=e("../../../utils/utils"),r=e("../base-xform"),u=i.exports=function(l){this.model=l};o.inherits(u,r,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new a),this._richTextXform},render(l,h){h=h||this.model,l.openNode("comment",{ref:h.ref,authorId:0}),l.openNode("text"),h&&h.note&&h.note.texts&&h.note.texts.forEach(f=>{this.richTextXform.render(l,f)}),l.closeNode(),l.closeNode()},parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"comment":return this.model=wi({type:"note",note:{texts:[]}},l.attributes),!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(l),!0;default:return!1}},parseText(l){this.parser&&this.parser.parseText(l)},parseClose(l){switch(l){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(l),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../../../utils/utils"),r=e("../base-xform"),u=e("./comment-xform"),l=i.exports=function(){this.map={comment:new u}};o.inherits(l,r,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(h,f){f=f||this.model,h.openXml(a.StdDocAttributes),h.openNode("comments",l.COMMENTS_ATTRIBUTES),h.openNode("authors"),h.leafNode("author",null,"Author"),h.closeNode(),h.openNode("commentList"),f.comments.forEach(d=>{this.map.comment.render(h,d)}),h.closeNode(),h.closeNode()},parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(h),!0;default:return!1}},parseText(h){this.parser&&this.parser.parseText(h)},parseClose(h){switch(h){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(h),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,r,u){(r===u[2]||this.tag==="x:SizeWithCells"&&r===u[1])&&o.leafNode(this.tag)}parseOpen(o){switch(o.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,r){o.leafNode(this.tag,null,r)}parseOpen(o){switch(o.name){case this.tag:return this.text="",!0;default:return!1}}parseText(o){this.text=o}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"x:Anchor"}getAnchorRect(o){const r=Math.floor(o.left),u=Math.floor(68*(o.left-r)),l=Math.floor(o.top),h=Math.floor(18*(o.top-l)),f=Math.floor(o.right),d=Math.floor(68*(o.right-f)),p=Math.floor(o.bottom);return[r,u,l,h,f,d,p,Math.floor(18*(o.bottom-p))]}getDefaultRect(o){const r=o.col,u=Math.max(o.row-2,0);return[r,6,u,14,r+2,2,u+4,16]}render(o,r){const u=r.anchor?this.getAnchorRect(r.anchor):this.getDefaultRect(r.refAddress);o.leafNode("x:Anchor",null,u.join(", "))}parseOpen(o){switch(o.name){case this.tag:return this.text="",!0;default:return!1}}parseText(o){this.text=o}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,i,s){const a=e("../base-xform"),o=e("./vml-anchor-xform"),r=e("./style/vml-protection-xform"),u=e("./style/vml-position-xform"),l=["twoCells","oneCells","absolute"];i.exports=class extends a{constructor(){super(),this.map={"x:Anchor":new o,"x:Locked":new r({tag:"x:Locked"}),"x:LockText":new r({tag:"x:LockText"}),"x:SizeWithCells":new u({tag:"x:SizeWithCells"}),"x:MoveWithCells":new u({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(h,f){const{protection:d,editAs:p}=f.note;h.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(h,p,l),this.map["x:SizeWithCells"].render(h,p,l),this.map["x:Anchor"].render(h,f),this.map["x:Locked"].render(h,d.locked),h.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(h,d.lockText),h.leafNode("x:Row",null,f.refAddress.row-1),h.leafNode("x:Column",null,f.refAddress.col-1),h.closeNode()}parseOpen(h){switch(h.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const h=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),f=Object.keys(h).length;this.model.editAs=l[f],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform"),r=e("./vml-shape-xform");class u extends o{constructor(){super(),this.map={"v:shape":new r}}get tag(){return"xml"}render(h,f){h.openXml(a.StdDocAttributes),h.openNode(this.tag,u.DRAWING_ATTRIBUTES),h.openNode("o:shapelayout",{"v:ext":"edit"}),h.leafNode("o:idmap",{"v:ext":"edit",data:1}),h.closeNode(),h.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),h.leafNode("v:stroke",{joinstyle:"miter"}),h.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),h.closeNode(),f.comments.forEach((d,p)=>{this.map["v:shape"].render(h,d,p)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(h){case this.tag:return!1;default:return!0}}reconcile(h,f){h.anchors.forEach(d=>{d.br?this.map["xdr:twoCellAnchor"].reconcile(d,f):this.map["xdr:oneCellAnchor"].reconcile(d,f)})}}u.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},i.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,i,s){const a=e("../base-xform"),o=e("./vml-textbox-xform"),r=e("./vml-client-data-xform");class u extends a{constructor(){super(),this.map={"v:textbox":new o,"x:ClientData":new r}}get tag(){return"v:shape"}render(h,f,d){h.openNode("v:shape",u.V_SHAPE_ATTRIBUTES(f,d)),h.leafNode("v:fill",{color2:"infoBackground [80]"}),h.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),h.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(h,f),this.map["x:ClientData"].render(h,f),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:this.reset(),this.model={margins:{insetmode:h.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}u.V_SHAPE_ATTRIBUTES=(l,h)=>({id:"_x0000_s"+(1025+h),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":l.note.margins&&l.note.margins.insetmode}),i.exports=u},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"v:textbox"}conversionUnit(o,r,u){return`${parseFloat(o)*r.toFixed(2)}${u}`}reverseConversionUnit(o){return(o||"").split(",").map(r=>Number(parseFloat(this.conversionUnit(parseFloat(r),.1,"")).toFixed(2)))}render(o,r){const u={style:"mso-direction-alt:auto"};if(r&&r.note){let{inset:l}=r.note&&r.note.margins;Array.isArray(l)&&(l=l.map(h=>this.conversionUnit(h,10,"mm")).join(",")),l&&(u.inset=l)}o.openNode("v:textbox",u),o.leafNode("div",{style:"text-align:left"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:return this.model={inset:this.reverseConversionUnit(o.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(e,i,s){const a=e("./base-xform");i.exports=class extends a{createNewModel(o){return{}}parseOpen(o){return this.parser=this.parser||this.map[o.name],this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag&&(this.model=this.createNewModel(o),!0)}parseText(o){this.parser&&this.parser.parseText(o)}onParserClose(o,r){this.model[o]=r.model}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.onParserClose(o,this.parser),this.parser=void 0),!0):o!==this.tag}}},{"./base-xform":32}],49:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{render(o,r){o.openNode("HeadingPairs"),o.openNode("vt:vector",{size:2,baseType:"variant"}),o.openNode("vt:variant"),o.leafNode("vt:lpstr",void 0,"Worksheets"),o.closeNode(),o.openNode("vt:variant"),o.leafNode("vt:i4",void 0,r.length),o.closeNode(),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="HeadingPairs"}parseText(){}parseClose(o){return o!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{render(o,r){o.openNode("TitlesOfParts"),o.openNode("vt:vector",{size:r.length,baseType:"lpstr"}),r.forEach(u=>{o.leafNode("vt:lpstr",void 0,u.name)}),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="TitlesOfParts"}parseText(){}parseClose(o){return o!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform"),r=e("../simple/string-xform"),u=e("./app-heading-pairs-xform"),l=e("./app-titles-of-parts-xform");class h extends o{constructor(){super(),this.map={Company:new r({tag:"Company"}),Manager:new r({tag:"Manager"}),HeadingPairs:new u,TitleOfParts:new l}}render(d,p){d.openXml(a.StdDocAttributes),d.openNode("Properties",h.PROPERTY_ATTRIBUTES),d.leafNode("Application",void 0,"Microsoft Excel"),d.leafNode("DocSecurity",void 0,"0"),d.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(d,p.worksheets),this.map.TitleOfParts.render(d,p.worksheets),this.map.Company.render(d,p.company||""),this.map.Manager.render(d,p.manager),d.leafNode("LinksUpToDate",void 0,"false"),d.leafNode("SharedDoc",void 0,"false"),d.leafNode("HyperlinksChanged",void 0,"false"),d.leafNode("AppVersion",void 0,"16.0300"),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"Properties":return!0;default:return this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0)}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}h.DateFormat=function(f){return f.toISOString().replace(/[.]\d{3,6}/,"")},h.DateAttrs={"xsi:type":"dcterms:W3CDTF"},h.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},i.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform");class r extends o{render(l,h){l.openXml(a.StdDocAttributes),l.openNode("Types",r.PROPERTY_ATTRIBUTES);const f={};(h.media||[]).forEach(d=>{if(d.type==="image"){const p=d.extension;f[p]||(f[p]=!0,l.leafNode("Default",{Extension:p,ContentType:"image/"+p}))}}),l.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),l.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),l.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),h.worksheets.forEach(d=>{const p=`/xl/worksheets/sheet${d.id}.xml`;l.leafNode("Override",{PartName:p,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),l.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),l.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),h.sharedStrings&&h.sharedStrings.count&&l.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),h.tables&&h.tables.forEach(d=>{l.leafNode("Override",{PartName:"/xl/tables/"+d.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),h.drawings&&h.drawings.forEach(d=>{l.leafNode("Override",{PartName:`/xl/drawings/${d.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),h.commentRefs&&(l.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),h.commentRefs.forEach(d=>{let{commentName:p}=d;l.leafNode("Override",{PartName:`/xl/${p}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),l.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),l.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),l.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}r.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},i.exports=r},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform"),r=e("../simple/date-xform"),u=e("../simple/string-xform"),l=e("../simple/integer-xform");class h extends o{constructor(){super(),this.map={"dc:creator":new u({tag:"dc:creator"}),"dc:title":new u({tag:"dc:title"}),"dc:subject":new u({tag:"dc:subject"}),"dc:description":new u({tag:"dc:description"}),"dc:identifier":new u({tag:"dc:identifier"}),"dc:language":new u({tag:"dc:language"}),"cp:keywords":new u({tag:"cp:keywords"}),"cp:category":new u({tag:"cp:category"}),"cp:lastModifiedBy":new u({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new r({tag:"cp:lastPrinted",format:h.DateFormat}),"cp:revision":new l({tag:"cp:revision"}),"cp:version":new u({tag:"cp:version"}),"cp:contentStatus":new u({tag:"cp:contentStatus"}),"cp:contentType":new u({tag:"cp:contentType"}),"dcterms:created":new r({tag:"dcterms:created",attrs:h.DateAttrs,format:h.DateFormat}),"dcterms:modified":new r({tag:"dcterms:modified",attrs:h.DateAttrs,format:h.DateFormat})}}render(d,p){d.openXml(a.StdDocAttributes),d.openNode("cp:coreProperties",h.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(d,p.creator),this.map["dc:title"].render(d,p.title),this.map["dc:subject"].render(d,p.subject),this.map["dc:description"].render(d,p.description),this.map["dc:identifier"].render(d,p.identifier),this.map["dc:language"].render(d,p.language),this.map["cp:keywords"].render(d,p.keywords),this.map["cp:category"].render(d,p.category),this.map["cp:lastModifiedBy"].render(d,p.lastModifiedBy),this.map["cp:lastPrinted"].render(d,p.lastPrinted),this.map["cp:revision"].render(d,p.revision),this.map["cp:version"].render(d,p.version),this.map["cp:contentStatus"].render(d,p.contentStatus),this.map["cp:contentType"].render(d,p.contentType),this.map["dcterms:created"].render(d,p.created),this.map["dcterms:modified"].render(d,p.modified),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[d.name],this.parser)return this.parser.parseOpen(d),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+d)}}}h.DateFormat=function(f){return f.toISOString().replace(/[.]\d{3}/,"")},h.DateAttrs={"xsi:type":"dcterms:W3CDTF"},h.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},i.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{render(o,r){o.leafNode("Relationship",r)}parseOpen(o){switch(o.name){case"Relationship":return this.model=o.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform"),r=e("./relationship-xform");class u extends o{constructor(){super(),this.map={Relationship:new r}}render(h,f){f=f||this._values,h.openXml(a.StdDocAttributes),h.openNode("Relationships",u.RELATIONSHIPS_ATTRIBUTES),f.forEach(d=>{this.map.Relationship.render(h,d)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[h.name],this.parser)return this.parser.parseOpen(h),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(h))}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(h){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+h)}}}u.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},i.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:this.reset(),this.model={range:{editAs:o.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)}return!0}parseText(o){this.parser&&this.parser.parseText(o)}reconcilePicture(o,r){if(o&&o.rId){const u=r.rels[o.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(u){const l=u[1],h=r.mediaIndex[l];return r.media[h]}}}}},{"../base-xform":32}],57:[function(e,i,s){const a=e("../base-xform"),o=e("./blip-xform");i.exports=class extends a{constructor(){super(),this.map={"a:blip":new o}}get tag(){return"xdr:blipFill"}render(r,u){r.openNode(this.tag),this.map["a:blip"].render(r,u),r.openNode("a:stretch"),r.leafNode("a:fillRect"),r.closeNode(),r.closeNode()}parseOpen(r){if(this.parser)return this.parser.parseOpen(r),!0;switch(r.name){case this.tag:this.reset();break;default:this.parser=this.map[r.name],this.parser&&this.parser.parseOpen(r)}return!0}parseText(){}parseClose(r){if(this.parser)return this.parser.parseClose(r)||(this.parser=void 0),!0;switch(r){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"a:blip"}render(o,r){o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":r.rId,cstate:"print"})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"xdr:cNvPicPr"}render(o){o.openNode(this.tag),o.leafNode("a:picLocks",{noChangeAspect:"1"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(e,i,s){const a=e("../base-xform"),o=e("./hlink-click-xform"),r=e("./ext-lst-xform");i.exports=class extends a{constructor(){super(),this.map={"a:hlinkClick":new o,"a:extLst":new r}}get tag(){return"xdr:cNvPr"}render(u,l){u.openNode(this.tag,{id:l.index,name:"Picture "+l.index}),this.map["a:hlinkClick"].render(u,l),this.map["a:extLst"].render(u,l),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,i,s){const a=e("../base-xform"),o=e("../simple/integer-xform");i.exports=class extends a{constructor(r){super(),this.tag=r.tag,this.map={"xdr:col":new o({tag:"xdr:col",zero:!0}),"xdr:colOff":new o({tag:"xdr:colOff",zero:!0}),"xdr:row":new o({tag:"xdr:row",zero:!0}),"xdr:rowOff":new o({tag:"xdr:rowOff",zero:!0})}}render(r,u){r.openNode(this.tag),this.map["xdr:col"].render(r,u.nativeCol),this.map["xdr:colOff"].render(r,u.nativeColOff),this.map["xdr:row"].render(r,u.nativeRow),this.map["xdr:rowOff"].render(r,u.nativeRowOff),r.closeNode()}parseOpen(r){if(this.parser)return this.parser.parseOpen(r),!0;switch(r.name){case this.tag:this.reset();break;default:this.parser=this.map[r.name],this.parser&&this.parser.parseOpen(r)}return!0}parseText(r){this.parser&&this.parser.parseText(r)}parseClose(r){if(this.parser)return this.parser.parseClose(r)||(this.parser=void 0),!0;switch(r){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,i,s){const a=e("../../../utils/col-cache"),o=e("../../../utils/xml-stream"),r=e("../base-xform"),u=e("./two-cell-anchor-xform"),l=e("./one-cell-anchor-xform");class h extends r{constructor(){super(),this.map={"xdr:twoCellAnchor":new u,"xdr:oneCellAnchor":new l}}prepare(d){d.anchors.forEach((p,b)=>{p.anchorType=function(v){return(typeof v.range=="string"?a.decode(v.range):v.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(p),this.map[p.anchorType].prepare(p,{index:b})})}get tag(){return"xdr:wsDr"}render(d,p){d.openXml(o.StdDocAttributes),d.openNode(this.tag,h.DRAWING_ATTRIBUTES),p.anchors.forEach(b=>{this.map[b.anchorType].render(d,b)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(d){case this.tag:return!1;default:return!0}}reconcile(d,p){d.anchors.forEach(b=>{b.br?this.map["xdr:twoCellAnchor"].reconcile(b,p):this.map["xdr:oneCellAnchor"].reconcile(b,p)})}}h.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},i.exports=h},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"a:extLst"}render(o){o.openNode(this.tag),o.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),o.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),o.closeNode(),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.map={}}render(o,r){o.openNode(this.tag);const u=Math.floor(9525*r.width),l=Math.floor(9525*r.height);o.addAttribute("cx",u),o.addAttribute("cy",l),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={width:parseInt(o.attributes.cx||"0",10)/9525,height:parseInt(o.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"a:hlinkClick"}render(o,r){r.hyperlinks&&r.hyperlinks.rId&&o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":r.hyperlinks.rId,tooltip:r.hyperlinks.tooltip})}parseOpen(o){switch(o.name){case this.tag:return this.model={hyperlinks:{rId:o.attributes["r:id"],tooltip:o.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,i,s){const a=e("../base-xform"),o=e("./c-nv-pr-xform"),r=e("./c-nv-pic-pr-xform");i.exports=class extends a{constructor(){super(),this.map={"xdr:cNvPr":new o,"xdr:cNvPicPr":new r}}get tag(){return"xdr:nvPicPr"}render(u,l){u.openNode(this.tag),this.map["xdr:cNvPr"].render(u,l),this.map["xdr:cNvPicPr"].render(u,l),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,i,s){const a=e("./base-cell-anchor-xform"),o=e("../static-xform"),r=e("./cell-position-xform"),u=e("./ext-xform"),l=e("./pic-xform");i.exports=class extends a{constructor(){super(),this.map={"xdr:from":new r({tag:"xdr:from"}),"xdr:ext":new u({tag:"xdr:ext"}),"xdr:pic":new l,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(h,f){this.map["xdr:pic"].prepare(h.picture,f)}render(h,f){h.openNode(this.tag,{editAs:f.range.editAs||"oneCell"}),this.map["xdr:from"].render(h,f.range.tl),this.map["xdr:ext"].render(h,f.range.ext),this.map["xdr:pic"].render(h,f.picture),this.map["xdr:clientData"].render(h,{}),h.closeNode()}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(h,f){h.medium=this.reconcilePicture(h.picture,f)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,i,s){const a=e("../base-xform"),o=e("../static-xform"),r=e("./blip-fill-xform"),u=e("./nv-pic-pr-xform"),l=e("./sp-pr");i.exports=class extends a{constructor(){super(),this.map={"xdr:nvPicPr":new u,"xdr:blipFill":new r,"xdr:spPr":new o(l)}}get tag(){return"xdr:pic"}prepare(h,f){h.index=f.index+1}render(h,f){h.openNode(this.tag),this.map["xdr:nvPicPr"].render(h,f),this.map["xdr:blipFill"].render(h,f),this.map["xdr:spPr"].render(h,f),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:this.reset();break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(){}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(h){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,i,s){i.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,i,s){const a=e("./base-cell-anchor-xform"),o=e("../static-xform"),r=e("./cell-position-xform"),u=e("./pic-xform");i.exports=class extends a{constructor(){super(),this.map={"xdr:from":new r({tag:"xdr:from"}),"xdr:to":new r({tag:"xdr:to"}),"xdr:pic":new u,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(l,h){this.map["xdr:pic"].prepare(l.picture,h)}render(l,h){l.openNode(this.tag,{editAs:h.range.editAs||"oneCell"}),this.map["xdr:from"].render(l,h.range.tl),this.map["xdr:to"].render(l,h.range.br),this.map["xdr:pic"].render(l,h.picture),this.map["xdr:clientData"].render(l,{}),l.closeNode()}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(l,h){l.medium=this.reconcilePicture(l.picture,h)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,i,s){const a=e("./base-xform");i.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.always=!!o.always,this.count=o.count,this.empty=o.empty,this.$count=o.$count||"count",this.$=o.$,this.childXform=o.childXform,this.maxItems=o.maxItems}prepare(o,r){const{childXform:u}=this;o&&o.forEach((l,h)=>{r.index=h,u.prepare(l,r)})}render(o,r){if(this.always||r&&r.length){o.openNode(this.tag,this.$),this.count&&o.addAttribute(this.$count,r&&r.length||0);const{childXform:u}=this;(r||[]).forEach((l,h)=>{u.render(o,l,h)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(o)&&(this.parser=this.childXform,!0)}}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(o,r){if(o){const{childXform:u}=this;o.forEach(l=>{u.reconcile(l,r)})}}}},{"./base-xform":32}],72:[function(e,i,s){const a=e("../../../utils/col-cache"),o=e("../base-xform");i.exports=class extends o{get tag(){return"autoFilter"}render(r,u){if(u)if(typeof u=="string")r.leafNode("autoFilter",{ref:u});else{const l=function(d){return typeof d=="string"?d:a.getAddress(d.row,d.column).address},h=l(u.from),f=l(u.to);h&&f&&r.leafNode("autoFilter",{ref:`${h}:${f}`})}}parseOpen(r){r.name==="autoFilter"&&(this.model=r.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,i,s){const a=e("../../../utils/utils"),o=e("../base-xform"),r=e("../../../doc/range"),u=e("../../../doc/enums"),l=e("../strings/rich-text-xform");function h(f){if(f==null)return u.ValueType.Null;if(f instanceof String||typeof f=="string")return u.ValueType.String;if(typeof f=="number")return u.ValueType.Number;if(typeof f=="boolean")return u.ValueType.Boolean;if(f instanceof Date)return u.ValueType.Date;if(f.text&&f.hyperlink)return u.ValueType.Hyperlink;if(f.formula)return u.ValueType.Formula;if(f.error)return u.ValueType.Error;throw new Error("I could not understand type of value")}i.exports=class extends o{constructor(){super(),this.richTextXForm=new l}get tag(){return"c"}prepare(f,d){const p=d.styles.addStyleModel(f.style||{},function(b){switch(b.type){case u.ValueType.Formula:return h(b.result);default:return b.type}}(f));switch(p&&(f.styleId=p),f.comment&&d.comments.push(Il(wi({},f.comment),{ref:f.address})),f.type){case u.ValueType.String:case u.ValueType.RichText:d.sharedStrings&&(f.ssId=d.sharedStrings.add(f.value));break;case u.ValueType.Date:d.date1904&&(f.date1904=!0);break;case u.ValueType.Hyperlink:d.sharedStrings&&f.text!==void 0&&f.text!==null&&(f.ssId=d.sharedStrings.add(f.text)),d.hyperlinks.push({address:f.address,target:f.hyperlink,tooltip:f.tooltip});break;case u.ValueType.Merge:d.merges.add(f);break;case u.ValueType.Formula:if(d.date1904&&(f.date1904=!0),f.shareType==="shared"&&(f.si=d.siFormulae++),f.formula)d.formulae[f.address]=f;else if(f.sharedFormula){const b=d.formulae[f.sharedFormula];if(!b)throw new Error("Shared Formula master must exist above and or left of clone for cell "+f.address);b.si===void 0?(b.shareType="shared",b.si=d.siFormulae++,b.range=new r(b.address,f.address)):b.range&&b.range.expandToAddress(f.address),f.si=b.si}}}renderFormula(f,d){let p=null;switch(d.shareType){case"shared":p={t:"shared",ref:d.ref||d.range.range,si:d.si};break;case"array":p={t:"array",ref:d.ref};break;default:d.si!==void 0&&(p={t:"shared",si:d.si})}switch(h(d.result)){case u.ValueType.Null:f.leafNode("f",p,d.formula);break;case u.ValueType.String:f.addAttribute("t","str"),f.leafNode("f",p,d.formula),f.leafNode("v",null,d.result);break;case u.ValueType.Number:f.leafNode("f",p,d.formula),f.leafNode("v",null,d.result);break;case u.ValueType.Boolean:f.addAttribute("t","b"),f.leafNode("f",p,d.formula),f.leafNode("v",null,d.result?1:0);break;case u.ValueType.Error:f.addAttribute("t","e"),f.leafNode("f",p,d.formula),f.leafNode("v",null,d.result.error);break;case u.ValueType.Date:f.leafNode("f",p,d.formula),f.leafNode("v",null,a.dateToExcel(d.result,d.date1904));break;default:throw new Error("I could not understand type of value")}}render(f,d){if(d.type!==u.ValueType.Null||d.styleId){switch(f.openNode("c"),f.addAttribute("r",d.address),d.styleId&&f.addAttribute("s",d.styleId),d.type){case u.ValueType.Null:break;case u.ValueType.Number:f.leafNode("v",null,d.value);break;case u.ValueType.Boolean:f.addAttribute("t","b"),f.leafNode("v",null,d.value?"1":"0");break;case u.ValueType.Error:f.addAttribute("t","e"),f.leafNode("v",null,d.value.error);break;case u.ValueType.String:case u.ValueType.RichText:d.ssId!==void 0?(f.addAttribute("t","s"),f.leafNode("v",null,d.ssId)):d.value&&d.value.richText?(f.addAttribute("t","inlineStr"),f.openNode("is"),d.value.richText.forEach(p=>{this.richTextXForm.render(f,p)}),f.closeNode("is")):(f.addAttribute("t","str"),f.leafNode("v",null,d.value));break;case u.ValueType.Date:f.leafNode("v",null,a.dateToExcel(d.value,d.date1904));break;case u.ValueType.Hyperlink:d.ssId!==void 0?(f.addAttribute("t","s"),f.leafNode("v",null,d.ssId)):(f.addAttribute("t","str"),f.leafNode("v",null,d.text));break;case u.ValueType.Formula:this.renderFormula(f,d);break;case u.ValueType.Merge:}f.closeNode()}}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"c":return this.model={address:f.attributes.r},this.t=f.attributes.t,f.attributes.s&&(this.model.styleId=parseInt(f.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=f.attributes.si,this.model.shareType=f.attributes.t,this.model.ref=f.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){if(this.parser)this.parser.parseText(f);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+f:f;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+f:f:this.model.value=this.model.value?this.model.value+f:f}}parseClose(f){switch(f){case"c":{const{model:d}=this;if(d.formula||d.shareType)d.type=u.ValueType.Formula,d.value&&(this.t==="str"?d.result=a.xmlDecode(d.value):this.t==="b"?d.result=parseInt(d.value,10)!==0:this.t==="e"?d.result={error:d.value}:d.result=parseFloat(d.value),d.value=void 0);else if(d.value!==void 0)switch(this.t){case"s":d.type=u.ValueType.String,d.value=parseInt(d.value,10);break;case"str":d.type=u.ValueType.String,d.value=a.xmlDecode(d.value);break;case"inlineStr":d.type=u.ValueType.String;break;case"b":d.type=u.ValueType.Boolean,d.value=parseInt(d.value,10)!==0;break;case"e":d.type=u.ValueType.Error,d.value={error:d.value};break;default:d.type=u.ValueType.Number,d.value=parseFloat(d.value)}else d.styleId?d.type=u.ValueType.Null:d.type=u.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(f),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(f),!0)}}reconcile(f,d){const p=f.styleId&&d.styles&&d.styles.getStyleModel(f.styleId);switch(p&&(f.style=p),f.styleId!==void 0&&(f.styleId=void 0),f.type){case u.ValueType.String:typeof f.value=="number"&&d.sharedStrings&&(f.value=d.sharedStrings.getString(f.value)),f.value.richText&&(f.type=u.ValueType.RichText);break;case u.ValueType.Number:p&&a.isDateFmt(p.numFmt)&&(f.type=u.ValueType.Date,f.value=a.excelToDate(f.value,d.date1904));break;case u.ValueType.Formula:f.result!==void 0&&p&&a.isDateFmt(p.numFmt)&&(f.result=a.excelToDate(f.result,d.date1904)),f.shareType==="shared"&&(f.ref?d.formulae[f.si]=f.address:(f.sharedFormula=d.formulae[f.si],delete f.shareType),delete f.si)}const b=d.hyperlinkMap[f.address];b&&(f.type===u.ValueType.Formula?(f.text=f.result,f.result=void 0):(f.text=f.value,f.value=void 0),f.type=u.ValueType.Hyperlink,f.hyperlink=b);const v=d.commentsMap&&d.commentsMap[f.address];v&&(f.comment=v)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{get tag(){return"x14:cfIcon"}render(o,r){o.leafNode(this.tag,{iconSet:r.iconSet,iconId:r.iconId})}parseOpen(o){let{attributes:r}=o;this.model={iconSet:r.iconSet,iconId:a.toIntValue(r.iconId)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],75:[function(e,i,s){const{v4:a}=e("uuid"),o=e("../../base-xform"),r=e("../../composite-xform"),u=e("./databar-ext-xform"),l=e("./icon-set-ext-xform"),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class f extends r{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new u,"x14:iconSet":this.iconSetXform=new l}}get tag(){return"x14:cfRule"}static isExt(p){return p.type==="dataBar"?u.isExt(p):!(p.type!=="iconSet"||!p.custom&&!h[p.iconSet])}prepare(p){f.isExt(p)&&(p.x14Id=`{${a()}}`.toUpperCase())}render(p,b){if(f.isExt(b))switch(b.type){case"dataBar":this.renderDataBar(p,b);break;case"iconSet":this.renderIconSet(p,b)}}renderDataBar(p,b){p.openNode(this.tag,{type:"dataBar",id:b.x14Id}),this.databarXform.render(p,b),p.closeNode()}renderIconSet(p,b){p.openNode(this.tag,{type:"iconSet",priority:b.priority,id:b.x14Id||`{${a()}}`}),this.iconSetXform.render(p,b),p.closeNode()}createNewModel(p){let{attributes:b}=p;return{type:b.type,x14Id:b.id,priority:o.toIntValue(b.priority)}}onParserClose(p,b){Object.assign(this.model,b.model)}}i.exports=f},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,i,s){const a=e("../../composite-xform"),o=e("./f-ext-xform");i.exports=class extends a{constructor(){super(),this.map={"xm:f":this.fExtXform=new o}}get tag(){return"x14:cfvo"}render(r,u){r.openNode(this.tag,{type:u.type}),u.value!==void 0&&this.fExtXform.render(r,u.value),r.closeNode()}createNewModel(r){return{type:r.attributes.type}}onParserClose(r,u){switch(r){case"xm:f":this.model.value=u.model?parseFloat(u.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,i,s){const a=e("../../composite-xform"),o=e("./sqref-ext-xform"),r=e("./cf-rule-ext-xform");i.exports=class extends a{constructor(){super(),this.map={"xm:sqref":this.sqRef=new o,"x14:cfRule":this.cfRule=new r}}get tag(){return"x14:conditionalFormatting"}prepare(u,l){u.rules.forEach(h=>{this.cfRule.prepare(h,l)})}render(u,l){l.rules.some(r.isExt)&&(u.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),l.rules.filter(r.isExt).forEach(h=>this.cfRule.render(u,h)),this.sqRef.render(u,l.ref),u.closeNode())}createNewModel(){return{rules:[]}}onParserClose(u,l){switch(u){case"xm:sqref":this.model.ref=l.model;break;case"x14:cfRule":this.model.rules.push(l.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,i,s){const a=e("../../composite-xform"),o=e("./cf-rule-ext-xform"),r=e("./conditional-formatting-ext-xform");i.exports=class extends a{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new r}}get tag(){return"x14:conditionalFormattings"}hasContent(u){return u.hasExtContent===void 0&&(u.hasExtContent=u.some(l=>l.rules.some(o.isExt))),u.hasExtContent}prepare(u,l){u.forEach(h=>{this.cfXform.prepare(h,l)})}render(u,l){this.hasContent(l)&&(u.openNode(this.tag),l.forEach(h=>this.cfXform.render(u,h)),u.closeNode())}createNewModel(){return[]}onParserClose(u,l){this.model.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,i,s){const a=e("../../base-xform"),o=e("../../composite-xform"),r=e("../../style/color-xform"),u=e("./cfvo-ext-xform");i.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new u,"x14:borderColor":this.borderColorXform=new r("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new r("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new r("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new r("x14:axisColor")}}static isExt(l){return!l.gradient}get tag(){return"x14:dataBar"}render(l,h){l.openNode(this.tag,{minLength:a.toIntAttribute(h.minLength,0,!0),maxLength:a.toIntAttribute(h.maxLength,100,!0),border:a.toBoolAttribute(h.border,!1),gradient:a.toBoolAttribute(h.gradient,!0),negativeBarColorSameAsPositive:a.toBoolAttribute(h.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:a.toBoolAttribute(h.negativeBarBorderColorSameAsPositive,!0),axisPosition:a.toAttribute(h.axisPosition,"auto"),direction:a.toAttribute(h.direction,"leftToRight")}),h.cfvo.forEach(f=>{this.cfvoXform.render(l,f)}),this.borderColorXform.render(l,h.borderColor),this.negativeBorderColorXform.render(l,h.negativeBorderColor),this.negativeFillColorXform.render(l,h.negativeFillColor),this.axisColorXform.render(l,h.axisColor),l.closeNode()}createNewModel(l){let{attributes:h}=l;return{cfvo:[],minLength:a.toIntValue(h.minLength,0),maxLength:a.toIntValue(h.maxLength,100),border:a.toBoolValue(h.border,!1),gradient:a.toBoolValue(h.gradient,!0),negativeBarColorSameAsPositive:a.toBoolValue(h.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:a.toBoolValue(h.negativeBarBorderColorSameAsPositive,!0),axisPosition:a.toStringValue(h.axisPosition,"auto"),direction:a.toStringValue(h.direction,"leftToRight")}}onParserClose(l,h){const[,f]=l.split(":");switch(f){case"cfvo":this.model.cfvo.push(h.model);break;default:this.model[f]=h.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{get tag(){return"xm:f"}render(o,r){o.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],81:[function(e,i,s){const a=e("../../base-xform"),o=e("../../composite-xform"),r=e("./cfvo-ext-xform"),u=e("./cf-icon-ext-xform");i.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new r,"x14:cfIcon":this.cfIconXform=new u}}get tag(){return"x14:iconSet"}render(l,h){l.openNode(this.tag,{iconSet:a.toStringAttribute(h.iconSet),reverse:a.toBoolAttribute(h.reverse,!1),showValue:a.toBoolAttribute(h.showValue,!0),custom:a.toBoolAttribute(h.icons,!1)}),h.cfvo.forEach(f=>{this.cfvoXform.render(l,f)}),h.icons&&h.icons.forEach((f,d)=>{f.iconId=d,this.cfIconXform.render(l,f)}),l.closeNode()}createNewModel(l){let{attributes:h}=l;return{cfvo:[],iconSet:a.toStringValue(h.iconSet,"3TrafficLights"),reverse:a.toBoolValue(h.reverse,!1),showValue:a.toBoolValue(h.showValue,!0)}}onParserClose(l,h){const[,f]=l.split(":");switch(f){case"cfvo":this.model.cfvo.push(h.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(h.model);break;default:this.model[f]=h.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{get tag(){return"xm:sqref"}render(o,r){o.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],83:[function(e,i,s){const a=e("../../base-xform"),o=e("../../composite-xform"),r=e("../../../../doc/range"),u=e("./databar-xform"),l=e("./ext-lst-ref-xform"),h=e("./formula-xform"),f=e("./color-scale-xform"),d=e("./icon-set-xform"),p={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},b=x=>{const{type:w,operator:M}=x;switch(w){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:w};default:return{type:w,operator:M}}};class v extends o{constructor(){super(),this.map={dataBar:this.databarXform=new u,extLst:this.extLstRefXform=new l,formula:this.formulaXform=new h,colorScale:this.colorScaleXform=new f,iconSet:this.iconSetXform=new d}}get tag(){return"cfRule"}static isPrimitive(w){return w.type!=="iconSet"||!w.custom&&!p[w.iconSet]}render(w,M){switch(M.type){case"expression":this.renderExpression(w,M);break;case"cellIs":this.renderCellIs(w,M);break;case"top10":this.renderTop10(w,M);break;case"aboveAverage":this.renderAboveAverage(w,M);break;case"dataBar":this.renderDataBar(w,M);break;case"colorScale":this.renderColorScale(w,M);break;case"iconSet":this.renderIconSet(w,M);break;case"containsText":this.renderText(w,M);break;case"timePeriod":this.renderTimePeriod(w,M)}}renderExpression(w,M){w.openNode(this.tag,{type:"expression",dxfId:M.dxfId,priority:M.priority}),this.formulaXform.render(w,M.formulae[0]),w.closeNode()}renderCellIs(w,M){w.openNode(this.tag,{type:"cellIs",dxfId:M.dxfId,priority:M.priority,operator:M.operator}),M.formulae.forEach(E=>{this.formulaXform.render(w,E)}),w.closeNode()}renderTop10(w,M){w.leafNode(this.tag,{type:"top10",dxfId:M.dxfId,priority:M.priority,percent:a.toBoolAttribute(M.percent,!1),bottom:a.toBoolAttribute(M.bottom,!1),rank:a.toIntValue(M.rank,10,!0)})}renderAboveAverage(w,M){w.leafNode(this.tag,{type:"aboveAverage",dxfId:M.dxfId,priority:M.priority,aboveAverage:a.toBoolAttribute(M.aboveAverage,!0)})}renderDataBar(w,M){w.openNode(this.tag,{type:"dataBar",priority:M.priority}),this.databarXform.render(w,M),this.extLstRefXform.render(w,M),w.closeNode()}renderColorScale(w,M){w.openNode(this.tag,{type:"colorScale",priority:M.priority}),this.colorScaleXform.render(w,M),w.closeNode()}renderIconSet(w,M){v.isPrimitive(M)&&(w.openNode(this.tag,{type:"iconSet",priority:M.priority}),this.iconSetXform.render(w,M),w.closeNode())}renderText(w,M){w.openNode(this.tag,{type:M.operator,dxfId:M.dxfId,priority:M.priority,operator:a.toStringAttribute(M.operator,"containsText")});const E=(D=>{if(D.formulae&&D.formulae[0])return D.formulae[0];const N=new r(D.ref),{tl:V}=N;switch(D.operator){case"containsText":return`NOT(ISERROR(SEARCH("${D.text}",${V})))`;case"containsBlanks":return`LEN(TRIM(${V}))=0`;case"notContainsBlanks":return`LEN(TRIM(${V}))>0`;case"containsErrors":return`ISERROR(${V})`;case"notContainsErrors":return`NOT(ISERROR(${V}))`;default:return}})(M);E&&this.formulaXform.render(w,E),w.closeNode()}renderTimePeriod(w,M){w.openNode(this.tag,{type:"timePeriod",dxfId:M.dxfId,priority:M.priority,timePeriod:M.timePeriod});const E=(D=>{if(D.formulae&&D.formulae[0])return D.formulae[0];const N=new r(D.ref),{tl:V}=N;switch(D.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${V},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${V},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${V},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${V},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${V},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${V},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${V},1)=TODAY()-1`;case"today":return`FLOOR(${V},1)=TODAY()`;case"tomorrow":return`FLOOR(${V},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${V},1)<=6,FLOOR(${V},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${V})=MONTH(EDATE(TODAY(),0-1)),YEAR(${V})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${V})=MONTH(TODAY()),YEAR(${V})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${V})=MONTH(EDATE(TODAY(),0+1)),YEAR(${V})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(M);E&&this.formulaXform.render(w,E),w.closeNode()}createNewModel(w){let{attributes:M}=w;return Il(wi({},b(M)),{dxfId:a.toIntValue(M.dxfId),priority:a.toIntValue(M.priority),timePeriod:M.timePeriod,percent:a.toBoolValue(M.percent),bottom:a.toBoolValue(M.bottom),rank:a.toIntValue(M.rank),aboveAverage:a.toBoolValue(M.aboveAverage)})}onParserClose(w,M){switch(w){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,M.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(M.model)}}}i.exports=v},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{get tag(){return"cfvo"}render(o,r){o.leafNode(this.tag,{type:r.type,val:r.value})}parseOpen(o){this.model={type:o.attributes.type,value:a.toFloatValue(o.attributes.val)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],85:[function(e,i,s){const a=e("../../composite-xform"),o=e("../../style/color-xform"),r=e("./cfvo-xform");i.exports=class extends a{constructor(){super(),this.map={cfvo:this.cfvoXform=new r,color:this.colorXform=new o}}get tag(){return"colorScale"}render(u,l){u.openNode(this.tag),l.cfvo.forEach(h=>{this.cfvoXform.render(u,h)}),l.color.forEach(h=>{this.colorXform.render(u,h)}),u.closeNode()}createNewModel(u){return{cfvo:[],color:[]}}onParserClose(u,l){this.model[u].push(l.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,i,s){const a=e("../../composite-xform"),o=e("./cf-rule-xform");i.exports=class extends a{constructor(){super(),this.map={cfRule:new o}}get tag(){return"conditionalFormatting"}render(r,u){u.rules.some(o.isPrimitive)&&(r.openNode(this.tag,{sqref:u.ref}),u.rules.forEach(l=>{o.isPrimitive(l)&&(l.ref=u.ref,this.map.cfRule.render(r,l))}),r.closeNode())}createNewModel(r){let{attributes:u}=r;return{ref:u.sqref,rules:[]}}onParserClose(r,u){this.model.rules.push(u.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,i,s){const a=e("../../base-xform"),o=e("./conditional-formatting-xform");i.exports=class extends a{constructor(){super(),this.cfXform=new o}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(r,u){let l=r.reduce((h,f)=>Math.max(h,...f.rules.map(d=>d.priority||0)),1);r.forEach(h=>{h.rules.forEach(f=>{f.priority||(f.priority=l++),f.style&&(f.dxfId=u.styles.addDxfStyle(f.style))})})}render(r,u){u.forEach(l=>{this.cfXform.render(r,l)})}parseOpen(r){if(this.parser)return this.parser.parseOpen(r),!0;switch(r.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(r),!0;default:return!1}}parseText(r){this.parser&&this.parser.parseText(r)}parseClose(r){return!!this.parser&&(!!this.parser.parseClose(r)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(r,u){r.forEach(l=>{l.rules.forEach(h=>{h.dxfId!==void 0&&(h.style=u.styles.getDxfStyle(h.dxfId),delete h.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,i,s){const a=e("../../composite-xform"),o=e("../../style/color-xform"),r=e("./cfvo-xform");i.exports=class extends a{constructor(){super(),this.map={cfvo:this.cfvoXform=new r,color:this.colorXform=new o}}get tag(){return"dataBar"}render(u,l){u.openNode(this.tag),l.cfvo.forEach(h=>{this.cfvoXform.render(u,h)}),this.colorXform.render(u,l.color),u.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(u,l){switch(u){case"cfvo":this.model.cfvo.push(l.model);break;case"color":this.model.color=l.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,i,s){const a=e("../../base-xform"),o=e("../../composite-xform");class r extends a{get tag(){return"x14:id"}render(h,f){h.leafNode(this.tag,null,f)}parseOpen(){this.model=""}parseText(h){this.model+=h}parseClose(h){return h!==this.tag}}class u extends o{constructor(){super(),this.map={"x14:id":this.idXform=new r}}get tag(){return"ext"}render(h,f){h.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(h,f.x14Id),h.closeNode()}createNewModel(){return{}}onParserClose(h,f){this.model.x14Id=f.model}}i.exports=class extends o{constructor(){super(),this.map={ext:new u}}get tag(){return"extLst"}render(l,h){l.openNode(this.tag),this.map.ext.render(l,h),l.closeNode()}createNewModel(){return{}}onParserClose(l,h){Object.assign(this.model,h.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,i,s){const a=e("../../base-xform");i.exports=class extends a{get tag(){return"formula"}render(o,r){o.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],91:[function(e,i,s){const a=e("../../base-xform"),o=e("../../composite-xform"),r=e("./cfvo-xform");i.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new r}}get tag(){return"iconSet"}render(u,l){u.openNode(this.tag,{iconSet:a.toStringAttribute(l.iconSet,"3TrafficLights"),reverse:a.toBoolAttribute(l.reverse,!1),showValue:a.toBoolAttribute(l.showValue,!0)}),l.cfvo.forEach(h=>{this.cfvoXform.render(u,h)}),u.closeNode()}createNewModel(u){let{attributes:l}=u;return{iconSet:a.toStringValue(l.iconSet,"3TrafficLights"),reverse:a.toBoolValue(l.reverse),showValue:a.toBoolValue(l.showValue),cfvo:[]}}onParserClose(u,l){this.model[u].push(l.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,i,s){const a=e("../../../utils/utils"),o=e("../base-xform");i.exports=class extends o{get tag(){return"col"}prepare(r,u){const l=u.styles.addStyleModel(r.style||{});l&&(r.styleId=l)}render(r,u){r.openNode("col"),r.addAttribute("min",u.min),r.addAttribute("max",u.max),u.width&&r.addAttribute("width",u.width),u.styleId&&r.addAttribute("style",u.styleId),u.hidden&&r.addAttribute("hidden","1"),u.bestFit&&r.addAttribute("bestFit","1"),u.outlineLevel&&r.addAttribute("outlineLevel",u.outlineLevel),u.collapsed&&r.addAttribute("collapsed","1"),r.addAttribute("customWidth","1"),r.closeNode()}parseOpen(r){if(r.name==="col"){const u=this.model={min:parseInt(r.attributes.min||"0",10),max:parseInt(r.attributes.max||"0",10),width:r.attributes.width===void 0?void 0:parseFloat(r.attributes.width||"0")};return r.attributes.style&&(u.styleId=parseInt(r.attributes.style,10)),a.parseBoolean(r.attributes.hidden)&&(u.hidden=!0),a.parseBoolean(r.attributes.bestFit)&&(u.bestFit=!0),r.attributes.outlineLevel&&(u.outlineLevel=parseInt(r.attributes.outlineLevel,10)),a.parseBoolean(r.attributes.collapsed)&&(u.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(r,u){r.styleId&&(r.style=u.styles.getStyleModel(r.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../../../utils/utils"),r=e("../../../utils/col-cache"),u=e("../base-xform"),l=e("../../../doc/range");function h(d,p,b,v){const x=p[b];x!==void 0?d[b]=x:v!==void 0&&(d[b]=v)}function f(d,p,b,v){const x=p[b];x!==void 0?d[b]=o.parseBoolean(x):v!==void 0&&(d[b]=v)}i.exports=class extends u{get tag(){return"dataValidations"}render(d,p){const b=function(v){const x=a.map(v,(E,D)=>({address:D,dataValidation:E,marked:!1})).sort((E,D)=>a.strcmp(E.address,D.address)),w=a.keyBy(x,"address"),M=(E,D,N)=>{for(let V=0;V<D;V++){const K=r.encodeAddress(E.row+V,N);if(!v[K]||!a.isEqual(v[E.address],v[K]))return!1}return!0};return x.map(E=>{if(!E.marked){const D=r.decodeEx(E.address);if(D.dimensions)return w[D.dimensions].marked=!0,Il(wi({},E.dataValidation),{sqref:E.address});let N=1,V=r.encodeAddress(D.row+N,D.col);for(;v[V]&&a.isEqual(E.dataValidation,v[V]);)N++,V=r.encodeAddress(D.row+N,D.col);let K=1;for(;M(D,N,D.col+K);)K++;for(let j=0;j<N;j++)for(let Z=0;Z<K;Z++)V=r.encodeAddress(D.row+j,D.col+Z),w[V].marked=!0;if(N>1||K>1){const j=D.row+(N-1),Z=D.col+(K-1);return Il(wi({},E.dataValidation),{sqref:`${E.address}:${r.encodeAddress(j,Z)}`})}return Il(wi({},E.dataValidation),{sqref:E.address})}return null}).filter(Boolean)}(p);b.length&&(d.openNode("dataValidations",{count:b.length}),b.forEach(v=>{d.openNode("dataValidation"),v.type!=="any"&&(d.addAttribute("type",v.type),v.operator&&v.type!=="list"&&v.operator!=="between"&&d.addAttribute("operator",v.operator),v.allowBlank&&d.addAttribute("allowBlank","1")),v.showInputMessage&&d.addAttribute("showInputMessage","1"),v.promptTitle&&d.addAttribute("promptTitle",v.promptTitle),v.prompt&&d.addAttribute("prompt",v.prompt),v.showErrorMessage&&d.addAttribute("showErrorMessage","1"),v.errorStyle&&d.addAttribute("errorStyle",v.errorStyle),v.errorTitle&&d.addAttribute("errorTitle",v.errorTitle),v.error&&d.addAttribute("error",v.error),d.addAttribute("sqref",v.sqref),(v.formulae||[]).forEach((x,w)=>{d.openNode("formula"+(w+1)),v.type==="date"?d.writeText(o.dateToExcel(new Date(x))):d.writeText(x),d.closeNode()}),d.closeNode()}),d.closeNode())}parseOpen(d){switch(d.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=d.attributes.sqref;const p={type:d.attributes.type||"any",formulae:[]};switch(d.attributes.type&&f(p,d.attributes,"allowBlank"),f(p,d.attributes,"showInputMessage"),f(p,d.attributes,"showErrorMessage"),p.type){case"any":case"list":case"custom":break;default:h(p,d.attributes,"operator","between")}return h(p,d.attributes,"promptTitle"),h(p,d.attributes,"prompt"),h(p,d.attributes,"errorStyle"),h(p,d.attributes,"errorTitle"),h(p,d.attributes,"error"),this._dataValidation=p,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(d){this._formula&&this._formula.push(d)}parseClose(d){switch(d){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(p=>{p.includes(":")?new l(p).forEachAddress(b=>{this.model[b]=this._dataValidation}):this.model[p]=this._dataValidation}),!0;case"formula1":case"formula2":{let p=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":p=parseInt(p,10);break;case"decimal":p=parseFloat(p);break;case"date":p=o.excelToDate(parseFloat(p))}return this._dataValidation.formulae.push(p),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"dimension"}render(o,r){r&&o.leafNode("dimension",{ref:r})}parseOpen(o){return o.name==="dimension"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"drawing"}render(o,r){r&&o.leafNode(this.tag,{"r:id":r.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,i,s){const a=e("../composite-xform"),o=e("./cf-ext/conditional-formattings-ext-xform");class r extends a{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new o}}get tag(){return"ext"}hasContent(l){return this.conditionalFormattings.hasContent(l.conditionalFormattings)}prepare(l,h){this.conditionalFormattings.prepare(l.conditionalFormattings,h)}render(l,h){l.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(l,h.conditionalFormattings),l.closeNode()}createNewModel(){return{}}onParserClose(l,h){this.model[l]=h.model}}i.exports=class extends a{constructor(){super(),this.map={ext:this.ext=new r}}get tag(){return"extLst"}prepare(u,l){this.ext.prepare(u,l)}hasContent(u){return this.ext.hasContent(u)}render(u,l){this.hasContent(l)&&(u.openNode("extLst"),this.ext.render(u,l),u.closeNode())}createNewModel(){return{}}onParserClose(u,l){Object.assign(this.model,l.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"headerFooter"}render(o,r){if(r){o.addRollback();let u=!1;o.openNode("headerFooter"),r.differentFirst&&(o.addAttribute("differentFirst","1"),u=!0),r.differentOddEven&&(o.addAttribute("differentOddEven","1"),u=!0),r.oddHeader&&typeof r.oddHeader=="string"&&(o.leafNode("oddHeader",null,r.oddHeader),u=!0),r.oddFooter&&typeof r.oddFooter=="string"&&(o.leafNode("oddFooter",null,r.oddFooter),u=!0),r.evenHeader&&typeof r.evenHeader=="string"&&(o.leafNode("evenHeader",null,r.evenHeader),u=!0),r.evenFooter&&typeof r.evenFooter=="string"&&(o.leafNode("evenFooter",null,r.evenFooter),u=!0),r.firstHeader&&typeof r.firstHeader=="string"&&(o.leafNode("firstHeader",null,r.firstHeader),u=!0),r.firstFooter&&typeof r.firstFooter=="string"&&(o.leafNode("firstFooter",null,r.firstFooter),u=!0),u?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){switch(o.name){case"headerFooter":return this.model={},o.attributes.differentFirst&&(this.model.differentFirst=parseInt(o.attributes.differentFirst,0)===1),o.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(o.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(o){switch(this.currentNode){case"oddHeader":this.model.oddHeader=o;break;case"oddFooter":this.model.oddFooter=o;break;case"evenHeader":this.model.evenHeader=o;break;case"evenFooter":this.model.evenFooter=o;break;case"firstHeader":this.model.firstHeader=o;break;case"firstFooter":this.model.firstFooter=o}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"hyperlink"}render(o,r){this.isInternalLink(r)?o.leafNode("hyperlink",{ref:r.address,"r:id":r.rId,tooltip:r.tooltip,location:r.target}):o.leafNode("hyperlink",{ref:r.address,"r:id":r.rId,tooltip:r.tooltip})}parseOpen(o){return o.name==="hyperlink"&&(this.model={address:o.attributes.ref,rId:o.attributes["r:id"],tooltip:o.attributes.tooltip},o.attributes.location&&(this.model.target=o.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(o){return o.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(o.target)}}},{"../base-xform":32}],99:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"mergeCell"}render(o,r){o.leafNode("mergeCell",{ref:r})}parseOpen(o){return o.name==="mergeCell"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../../../doc/range"),r=e("../../../utils/col-cache"),u=e("../../../doc/enums");i.exports=class{constructor(){this.merges={}}add(l){if(this.merges[l.master])this.merges[l.master].expandToAddress(l.address);else{const h=`${l.master}:${l.address}`;this.merges[l.master]=new o(h)}}get mergeCells(){return a.map(this.merges,l=>l.range)}reconcile(l,h){a.each(l,f=>{const d=r.decode(f);for(let p=d.top;p<=d.bottom;p++){const b=h[p-1];for(let v=d.left;v<=d.right;v++){const x=b.cells[v-1];x?x.type===u.ValueType.Merge&&(x.master=d.tl):b.cells[v]={type:u.ValueType.Null,address:r.encodeAddress(p,v)}}}})}getMasterAddress(l){const h=this.hash[l];return h&&h.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,i,s){const a=e("../base-xform"),o=r=>r!==void 0;i.exports=class extends a{get tag(){return"outlinePr"}render(r,u){return!(!u||!o(u.summaryBelow)&&!o(u.summaryRight))&&(r.leafNode(this.tag,{summaryBelow:o(u.summaryBelow)?Number(u.summaryBelow):void 0,summaryRight:o(u.summaryRight)?Number(u.summaryRight):void 0}),!0)}parseOpen(r){return r.name===this.tag&&(this.model={summaryBelow:o(r.attributes.summaryBelow)?!!Number(r.attributes.summaryBelow):void 0,summaryRight:o(r.attributes.summaryRight)?!!Number(r.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"brk"}render(o,r){o.leafNode("brk",r)}parseOpen(o){return o.name==="brk"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../base-xform");i.exports=class extends o{get tag(){return"pageMargins"}render(r,u){if(u){const l={left:u.left,right:u.right,top:u.top,bottom:u.bottom,header:u.header,footer:u.footer};a.some(l,h=>h!==void 0)&&r.leafNode(this.tag,l)}}parseOpen(r){switch(r.name){case this.tag:return this.model={left:parseFloat(r.attributes.left||.7),right:parseFloat(r.attributes.right||.7),top:parseFloat(r.attributes.top||.75),bottom:parseFloat(r.attributes.bottom||.75),header:parseFloat(r.attributes.header||.3),footer:parseFloat(r.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"pageSetUpPr"}render(o,r){return!(!r||!r.fitToPage)&&(o.leafNode(this.tag,{fitToPage:r.fitToPage?"1":void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={fitToPage:o.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../base-xform");function r(f){return f?"1":void 0}function u(f){switch(f){case"overThenDown":return f;default:return}}function l(f){switch(f){case"atEnd":case"asDisplyed":return f;default:return}}function h(f){switch(f){case"dash":case"blank":case"NA":return f;default:return}}i.exports=class extends o{get tag(){return"pageSetup"}render(f,d){if(d){const p={paperSize:d.paperSize,orientation:d.orientation,horizontalDpi:d.horizontalDpi,verticalDpi:d.verticalDpi,pageOrder:u(d.pageOrder),blackAndWhite:r(d.blackAndWhite),draft:r(d.draft),cellComments:l(d.cellComments),errors:h(d.errors),scale:d.scale,fitToWidth:d.fitToWidth,fitToHeight:d.fitToHeight,firstPageNumber:d.firstPageNumber,useFirstPageNumber:r(d.firstPageNumber),usePrinterDefaults:r(d.usePrinterDefaults),copies:d.copies};a.some(p,b=>b!==void 0)&&f.leafNode(this.tag,p)}}parseOpen(f){switch(f.name){case this.tag:return this.model={paperSize:(d=f.attributes.paperSize,d!==void 0?parseInt(d,10):void 0),orientation:f.attributes.orientation||"portrait",horizontalDpi:parseInt(f.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(f.attributes.verticalDpi||"4294967295",10),pageOrder:f.attributes.pageOrder||"downThenOver",blackAndWhite:f.attributes.blackAndWhite==="1",draft:f.attributes.draft==="1",cellComments:f.attributes.cellComments||"None",errors:f.attributes.errors||"displayed",scale:parseInt(f.attributes.scale||"100",10),fitToWidth:parseInt(f.attributes.fitToWidth||"1",10),fitToHeight:parseInt(f.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(f.attributes.firstPageNumber||"1",10),useFirstPageNumber:f.attributes.useFirstPageNumber==="1",usePrinterDefaults:f.attributes.usePrinterDefaults==="1",copies:parseInt(f.attributes.copies||"1",10)},!0;default:return!1}var d}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"picture"}render(o,r){r&&o.leafNode(this.tag,{"r:id":r.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../base-xform");function r(u){return u?"1":void 0}i.exports=class extends o{get tag(){return"printOptions"}render(u,l){if(l){const h={headings:r(l.showRowColHeaders),gridLines:r(l.showGridLines),horizontalCentered:r(l.horizontalCentered),verticalCentered:r(l.verticalCentered)};a.some(h,f=>f!==void 0)&&u.leafNode(this.tag,h)}}parseOpen(u){switch(u.name){case this.tag:return this.model={showRowColHeaders:u.attributes.headings==="1",showGridLines:u.attributes.gridLines==="1",horizontalCentered:u.attributes.horizontalCentered==="1",verticalCentered:u.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,i,s){const a=e("./page-breaks-xform"),o=e("../list-xform");i.exports=class extends o{constructor(){super({tag:"rowBreaks",count:!0,childXform:new a})}render(r,u){if(u&&u.length){r.openNode(this.tag,this.$),this.count&&(r.addAttribute(this.$count,u.length),r.addAttribute("manualBreakCount",u.length));const{childXform:l}=this;u.forEach(h=>{l.render(r,h)}),r.closeNode()}else this.empty&&r.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,i,s){const a=e("../base-xform"),o=e("../../../utils/utils"),r=e("./cell-xform");i.exports=class extends a{constructor(u){super(),this.maxItems=u&&u.maxItems,this.map={c:new r}}get tag(){return"row"}prepare(u,l){const h=l.styles.addStyleModel(u.style);h&&(u.styleId=h);const f=this.map.c;u.cells.forEach(d=>{f.prepare(d,l)})}render(u,l,h){u.openNode("row"),u.addAttribute("r",l.number),l.height&&(u.addAttribute("ht",l.height),u.addAttribute("customHeight","1")),l.hidden&&u.addAttribute("hidden","1"),l.min>0&&l.max>0&&l.min<=l.max&&u.addAttribute("spans",`${l.min}:${l.max}`),l.styleId&&(u.addAttribute("s",l.styleId),u.addAttribute("customFormat","1")),u.addAttribute("x14ac:dyDescent","0.25"),l.outlineLevel&&u.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&u.addAttribute("collapsed","1");const f=this.map.c;l.cells.forEach(d=>{f.render(u,d,h)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;if(u.name==="row"){this.numRowsSeen+=1;const l=u.attributes.spans?u.attributes.spans.split(":").map(f=>parseInt(f,10)):[void 0,void 0],h=this.model={number:parseInt(u.attributes.r,10),min:l[0],max:l[1],cells:[]};return u.attributes.s&&(h.styleId=parseInt(u.attributes.s,10)),o.parseBoolean(u.attributes.hidden)&&(h.hidden=!0),o.parseBoolean(u.attributes.bestFit)&&(h.bestFit=!0),u.attributes.ht&&(h.height=parseFloat(u.attributes.ht)),u.attributes.outlineLevel&&(h.outlineLevel=parseInt(u.attributes.outlineLevel,10)),o.parseBoolean(u.attributes.collapsed)&&(h.collapsed=!0),!0}return this.parser=this.map[u.name],!!this.parser&&(this.parser.parseOpen(u),!0)}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(u,l){u.style=u.styleId?l.styles.getStyleModel(u.styleId):{},u.styleId!==void 0&&(u.styleId=void 0);const h=this.map.c;u.cells.forEach(f=>{h.reconcile(f,l)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../base-xform");i.exports=class extends o{get tag(){return"sheetFormatPr"}render(r,u){if(u){const l={defaultRowHeight:u.defaultRowHeight,outlineLevelRow:u.outlineLevelRow,outlineLevelCol:u.outlineLevelCol,"x14ac:dyDescent":u.dyDescent};u.defaultColWidth&&(l.defaultColWidth=u.defaultColWidth),u.defaultRowHeight&&u.defaultRowHeight===15||(l.customHeight="1"),a.some(l,h=>h!==void 0)&&r.leafNode("sheetFormatPr",l)}}parseOpen(r){return r.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(r.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(r.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(r.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(r.attributes.outlineLevelCol||"0",10)},r.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(r.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,i,s){const a=e("../base-xform"),o=e("../style/color-xform"),r=e("./page-setup-properties-xform"),u=e("./outline-properties-xform");i.exports=class extends a{constructor(){super(),this.map={tabColor:new o("tabColor"),pageSetUpPr:new r,outlinePr:new u}}get tag(){return"sheetPr"}render(l,h){if(h){l.addRollback(),l.openNode("sheetPr");let f=!1;f=this.map.tabColor.render(l,h.tabColor)||f,f=this.map.pageSetUpPr.render(l,h.pageSetup)||f,f=this.map.outlinePr.render(l,h.outlineProperties)||f,f?(l.closeNode(),l.commit()):l.rollback()}}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):l.name===this.tag?(this.reset(),!0):!!this.map[l.name]&&(this.parser=this.map[l.name],this.parser.parseOpen(l),!0)}parseText(l){return!!this.parser&&(this.parser.parseText(l),!0)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../base-xform");function r(l,h){return l?h:void 0}function u(l,h){return l===h||void 0}i.exports=class extends o{get tag(){return"sheetProtection"}render(l,h){if(h){const f={sheet:r(h.sheet,"1"),selectLockedCells:h.selectLockedCells===!1?"1":void 0,selectUnlockedCells:h.selectUnlockedCells===!1?"1":void 0,formatCells:r(h.formatCells,"0"),formatColumns:r(h.formatColumns,"0"),formatRows:r(h.formatRows,"0"),insertColumns:r(h.insertColumns,"0"),insertRows:r(h.insertRows,"0"),insertHyperlinks:r(h.insertHyperlinks,"0"),deleteColumns:r(h.deleteColumns,"0"),deleteRows:r(h.deleteRows,"0"),sort:r(h.sort,"0"),autoFilter:r(h.autoFilter,"0"),pivotTables:r(h.pivotTables,"0")};h.sheet&&(f.algorithmName=h.algorithmName,f.hashValue=h.hashValue,f.saltValue=h.saltValue,f.spinCount=h.spinCount,f.objects=r(h.objects===!1,"1"),f.scenarios=r(h.scenarios===!1,"1")),a.some(f,d=>d!==void 0)&&l.leafNode(this.tag,f)}}parseOpen(l){switch(l.name){case this.tag:return this.model={sheet:u(l.attributes.sheet,"1"),objects:l.attributes.objects!=="1"&&void 0,scenarios:l.attributes.scenarios!=="1"&&void 0,selectLockedCells:l.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:l.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:u(l.attributes.formatCells,"0"),formatColumns:u(l.attributes.formatColumns,"0"),formatRows:u(l.attributes.formatRows,"0"),insertColumns:u(l.attributes.insertColumns,"0"),insertRows:u(l.attributes.insertRows,"0"),insertHyperlinks:u(l.attributes.insertHyperlinks,"0"),deleteColumns:u(l.attributes.deleteColumns,"0"),deleteRows:u(l.attributes.deleteRows,"0"),sort:u(l.attributes.sort,"0"),autoFilter:u(l.attributes.autoFilter,"0"),pivotTables:u(l.attributes.pivotTables,"0")},l.attributes.algorithmName&&(this.model.algorithmName=l.attributes.algorithmName,this.model.hashValue=l.attributes.hashValue,this.model.saltValue=l.attributes.saltValue,this.model.spinCount=parseInt(l.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,i,s){const a=e("../../../utils/col-cache"),o=e("../base-xform"),r={frozen:"frozen",frozenSplit:"frozen",split:"split"};i.exports=class extends o{get tag(){return"sheetView"}prepare(u){switch(u.state){case"frozen":case"split":break;default:u.state="normal"}}render(u,l){u.openNode("sheetView",{workbookViewId:l.workbookViewId||0});const h=function(v,x,w){w&&u.addAttribute(v,x)};let f,d,p,b;switch(h("rightToLeft","1",l.rightToLeft===!0),h("tabSelected","1",l.tabSelected),h("showRuler","0",l.showRuler===!1),h("showRowColHeaders","0",l.showRowColHeaders===!1),h("showGridLines","0",l.showGridLines===!1),h("zoomScale",l.zoomScale,l.zoomScale),h("zoomScaleNormal",l.zoomScaleNormal,l.zoomScaleNormal),h("view",l.style,l.style),l.state){case"frozen":d=l.xSplit||0,p=l.ySplit||0,f=l.topLeftCell||a.getAddress(p+1,d+1).address,b=(l.xSplit&&l.ySplit?"bottomRight":l.xSplit&&"topRight")||"bottomLeft",u.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:f,activePane:b,state:"frozen"}),u.leafNode("selection",{pane:b,activeCell:l.activeCell,sqref:l.activeCell});break;case"split":l.activePane==="topLeft"&&(l.activePane=void 0),u.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:l.topLeftCell,activePane:l.activePane}),u.leafNode("selection",{pane:l.activePane,activeCell:l.activeCell,sqref:l.activeCell});break;case"normal":l.activeCell&&u.leafNode("selection",{activeCell:l.activeCell,sqref:l.activeCell})}u.closeNode()}parseOpen(u){switch(u.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(u.attributes.workbookViewId,10),rightToLeft:u.attributes.rightToLeft==="1",tabSelected:u.attributes.tabSelected==="1",showRuler:u.attributes.showRuler!=="0",showRowColHeaders:u.attributes.showRowColHeaders!=="0",showGridLines:u.attributes.showGridLines!=="0",zoomScale:parseInt(u.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(u.attributes.zoomScaleNormal||"100",10),style:u.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(u.attributes.xSplit||"0",10),ySplit:parseInt(u.attributes.ySplit||"0",10),topLeftCell:u.attributes.topLeftCell,activePane:u.attributes.activePane||"topLeft",state:u.attributes.state},!0;case"selection":{const l=u.attributes.pane||"topLeft";return this.selections[l]={pane:l,activeCell:u.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(u){let l,h;switch(u){case"sheetView":return this.sheetView&&this.pane?(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:r[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(l.activePane=this.pane.activePane),h=this.selections[this.pane.activePane],h&&h.activeCell&&(l.activeCell=h.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)):(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},h=this.selections.topLeft,h&&h.activeCell&&(l.activeCell=h.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"tablePart"}render(o,r){r&&o.leafNode(this.tag,{"r:id":r.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../../../utils/col-cache"),r=e("../../../utils/xml-stream"),u=e("../../rel-type"),l=e("./merges"),h=e("../base-xform"),f=e("../list-xform"),d=e("./row-xform"),p=e("./col-xform"),b=e("./dimension-xform"),v=e("./hyperlink-xform"),x=e("./merge-cell-xform"),w=e("./data-validations-xform"),M=e("./sheet-properties-xform"),E=e("./sheet-format-properties-xform"),D=e("./sheet-view-xform"),N=e("./sheet-protection-xform"),V=e("./page-margins-xform"),K=e("./page-setup-xform"),j=e("./print-options-xform"),Z=e("./auto-filter-xform"),tt=e("./picture-xform"),rt=e("./drawing-xform"),J=e("./table-part-xform"),U=e("./row-breaks-xform"),G=e("./header-footer-xform"),I=e("./cf/conditional-formattings-xform"),C=e("./ext-lst-xform"),L=(O,q)=>{if(!q||!q.length)return O;if(!O||!O.length)return q;const it={},nt={};return O.forEach(lt=>{it[lt.ref]=lt,lt.rules.forEach(ut=>{const{x14Id:vt}=ut;vt&&(nt[vt]=ut)})}),q.forEach(lt=>{lt.rules.forEach(ut=>{const vt=nt[ut.x14Id];vt?((Q,gt)=>{Object.keys(gt).forEach(Y=>{const H=Q[Y],at=gt[Y];H===void 0&&at!==void 0&&(Q[Y]=at)})})(vt,ut):it[lt.ref]?it[lt.ref].rules.push(ut):O.push({ref:lt.ref,rules:[ut]})})}),O};class B extends h{constructor(q){super();const{maxRows:it,maxCols:nt,ignoreNodes:lt}=q||{};this.ignoreNodes=lt||[],this.map={sheetPr:new M,dimension:new b,sheetViews:new f({tag:"sheetViews",count:!1,childXform:new D}),sheetFormatPr:new E,cols:new f({tag:"cols",count:!1,childXform:new p}),sheetData:new f({tag:"sheetData",count:!1,empty:!0,childXform:new d({maxItems:nt}),maxItems:it}),autoFilter:new Z,mergeCells:new f({tag:"mergeCells",count:!0,childXform:new x}),rowBreaks:new U,hyperlinks:new f({tag:"hyperlinks",count:!1,childXform:new v}),pageMargins:new V,dataValidations:new w,pageSetup:new K,headerFooter:new G,printOptions:new j,picture:new tt,drawing:new rt,sheetProtection:new N,tableParts:new f({tag:"tableParts",count:!0,childXform:new J}),conditionalFormatting:new I,extLst:new C}}prepare(q,it){it.merges=new l,q.hyperlinks=it.hyperlinks=[],q.comments=it.comments=[],it.formulae={},it.siFormulae=0,this.map.cols.prepare(q.cols,it),this.map.sheetData.prepare(q.rows,it),this.map.conditionalFormatting.prepare(q.conditionalFormattings,it),q.mergeCells=it.merges.mergeCells;const nt=q.rels=[];function lt(Q){return"rId"+(Q.length+1)}if(q.hyperlinks.forEach(Q=>{const gt=lt(nt);Q.rId=gt,nt.push({Id:gt,Type:u.Hyperlink,Target:Q.target,TargetMode:"External"})}),q.comments.length>0){const Q={Id:lt(nt),Type:u.Comments,Target:`../comments${q.id}.xml`};nt.push(Q);const gt={Id:lt(nt),Type:u.VmlDrawing,Target:`../drawings/vmlDrawing${q.id}.vml`};nt.push(gt),q.comments.forEach(Y=>{Y.refAddress=o.decodeAddress(Y.ref)}),it.commentRefs.push({commentName:"comments"+q.id,vmlDrawing:"vmlDrawing"+q.id})}const ut=[];let vt;q.media.forEach(Q=>{if(Q.type==="background"){const gt=lt(nt);vt=it.media[Q.imageId],nt.push({Id:gt,Type:u.Image,Target:`../media/${vt.name}.${vt.extension}`}),q.background={rId:gt},q.image=it.media[Q.imageId]}else if(Q.type==="image"){let{drawing:gt}=q;vt=it.media[Q.imageId],gt||(gt=q.drawing={rId:lt(nt),name:"drawing"+ ++it.drawingsCount,anchors:[],rels:[]},it.drawings.push(gt),nt.push({Id:gt.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${gt.name}.xml`}));let Y=this.preImageId===Q.imageId?ut[Q.imageId]:ut[gt.rels.length];Y||(Y=lt(gt.rels),ut[gt.rels.length]=Y,gt.rels.push({Id:Y,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${vt.name}.${vt.extension}`}));const H={picture:{rId:Y},range:Q.range};if(Q.hyperlinks&&Q.hyperlinks.hyperlink){const at=lt(gt.rels);ut[gt.rels.length]=at,H.picture.hyperlinks={tooltip:Q.hyperlinks.tooltip,rId:at},gt.rels.push({Id:at,Type:u.Hyperlink,Target:Q.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=Q.imageId,gt.anchors.push(H)}}),q.tables.forEach(Q=>{const gt=lt(nt);Q.rId=gt,nt.push({Id:gt,Type:u.Table,Target:"../tables/"+Q.target}),Q.columns.forEach(Y=>{const{style:H}=Y;H&&(Y.dxfId=it.styles.addDxfStyle(H))})}),this.map.extLst.prepare(q,it)}render(q,it){q.openXml(r.StdDocAttributes),q.openNode("worksheet",B.WORKSHEET_ATTRIBUTES);const nt=it.properties?{defaultRowHeight:it.properties.defaultRowHeight,dyDescent:it.properties.dyDescent,outlineLevelCol:it.properties.outlineLevelCol,outlineLevelRow:it.properties.outlineLevelRow}:void 0;it.properties&&it.properties.defaultColWidth&&(nt.defaultColWidth=it.properties.defaultColWidth);const lt={outlineProperties:it.properties&&it.properties.outlineProperties,tabColor:it.properties&&it.properties.tabColor,pageSetup:it.pageSetup&&it.pageSetup.fitToPage?{fitToPage:it.pageSetup.fitToPage}:void 0},ut=it.pageSetup&&it.pageSetup.margins,vt={showRowColHeaders:it.pageSetup&&it.pageSetup.showRowColHeaders,showGridLines:it.pageSetup&&it.pageSetup.showGridLines,horizontalCentered:it.pageSetup&&it.pageSetup.horizontalCentered,verticalCentered:it.pageSetup&&it.pageSetup.verticalCentered},Q=it.sheetProtection;this.map.sheetPr.render(q,lt),this.map.dimension.render(q,it.dimensions),this.map.sheetViews.render(q,it.views),this.map.sheetFormatPr.render(q,nt),this.map.cols.render(q,it.cols),this.map.sheetData.render(q,it.rows),this.map.sheetProtection.render(q,Q),this.map.autoFilter.render(q,it.autoFilter),this.map.mergeCells.render(q,it.mergeCells),this.map.conditionalFormatting.render(q,it.conditionalFormattings),this.map.dataValidations.render(q,it.dataValidations),this.map.hyperlinks.render(q,it.hyperlinks),this.map.printOptions.render(q,vt),this.map.pageMargins.render(q,ut),this.map.pageSetup.render(q,it.pageSetup),this.map.headerFooter.render(q,it.headerFooter),this.map.rowBreaks.render(q,it.rowBreaks),this.map.drawing.render(q,it.drawing),this.map.picture.render(q,it.background),this.map.tableParts.render(q,it.tables),this.map.extLst.render(q,it),it.rels&&it.rels.forEach(gt=>{gt.Type===u.VmlDrawing&&q.leafNode("legacyDrawing",{"r:id":gt.Id})}),q.closeNode()}parseOpen(q){return this.parser?(this.parser.parseOpen(q),!0):q.name==="worksheet"?(a.each(this.map,it=>{it.reset()}),!0):(this.map[q.name]&&!this.ignoreNodes.includes(q.name)&&(this.parser=this.map[q.name],this.parser.parseOpen(q)),!0)}parseText(q){this.parser&&this.parser.parseText(q)}parseClose(q){if(this.parser)return this.parser.parseClose(q)||(this.parser=void 0),!0;switch(q){case"worksheet":{const it=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(it.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(it.outlineProperties=this.map.sheetPr.model.outlineProperties);const nt={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},lt=Object.assign(nt,this.map.pageSetup.model,this.map.printOptions.model),ut=L(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:it,views:this.map.sheetViews.model,pageSetup:lt,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:ut},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(q,it){const nt=(q.relationships||[]).reduce((ut,vt)=>{if(ut[vt.Id]=vt,vt.Type===u.Comments&&(q.comments=it.comments[vt.Target].comments),vt.Type===u.VmlDrawing&&q.comments&&q.comments.length){const Q=it.vmlDrawings[vt.Target].comments;q.comments.forEach((gt,Y)=>{gt.note=Object.assign({},gt.note,Q[Y])})}return ut},{});if(it.commentsMap=(q.comments||[]).reduce((ut,vt)=>(vt.ref&&(ut[vt.ref]=vt),ut),{}),it.hyperlinkMap=(q.hyperlinks||[]).reduce((ut,vt)=>(vt.rId&&(ut[vt.address]=nt[vt.rId].Target),ut),{}),it.formulae={},q.rows=q.rows&&q.rows.filter(Boolean)||[],q.rows.forEach(ut=>{ut.cells=ut.cells&&ut.cells.filter(Boolean)||[]}),this.map.cols.reconcile(q.cols,it),this.map.sheetData.reconcile(q.rows,it),this.map.conditionalFormatting.reconcile(q.conditionalFormattings,it),q.media=[],q.drawing){const ut=nt[q.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(ut){const vt=ut[1];it.drawings[vt].anchors.forEach(Q=>{if(Q.medium){const gt={type:"image",imageId:Q.medium.index,range:Q.range,hyperlinks:Q.picture.hyperlinks};q.media.push(gt)}})}}const lt=q.background&&nt[q.background.rId];if(lt){const ut=lt.Target.split("/media/")[1],vt=it.mediaIndex&&it.mediaIndex[ut];vt!==void 0&&q.media.push({type:"background",imageId:vt})}q.tables=(q.tables||[]).map(ut=>{const vt=nt[ut.rId];return it.tables[vt.Target]}),delete q.relationships,delete q.hyperlinks,delete q.comments}}B.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},i.exports=B},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.attr=o.attr}render(o,r){r&&(o.openNode(this.tag),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this._format=o.format||function(r){try{return Number.isNaN(r.getTime())?"":r.toISOString()}catch(u){return""}},this._parse=o.parse||function(r){return new Date(r)}}render(o,r){r&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,this._format(r)):o.writeText(this._format(r)),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=this._parse(o.attributes[this.attr]):this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this.zero=o.zero}render(o,r){(r||this.zero)&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,r):o.writeText(r),o.closeNode())}parseOpen(o){return o.name===this.tag&&(this.attr?this.model=parseInt(o.attributes[this.attr],10):this.text=[],!0)}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs}render(o,r){r!==void 0&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,r):o.writeText(r),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=o.attributes[this.attr]:this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,i,s){const a=e("./base-xform"),o=e("../../utils/xml-stream");i.exports=class extends a{constructor(r){super(),this._model=r}render(r){if(!this._xml){const u=new o;(function l(h,f){h.openNode(f.tag,f.$),f.c&&f.c.forEach(d=>{l(h,d)}),f.t&&h.writeText(f.t),h.closeNode()})(u,this._model),this._xml=u.xml}r.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(r){switch(r){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,i,s){const a=e("./text-xform"),o=e("./rich-text-xform"),r=e("../base-xform");i.exports=class extends r{constructor(){super(),this.map={r:new o,t:new a}}get tag(){return"rPh"}render(u,l){if(u.openNode(this.tag,{sb:l.sb||0,eb:l.eb||0}),l&&l.hasOwnProperty("richText")&&l.richText){const{r:h}=this.map;l.richText.forEach(f=>{h.render(u,f)})}else l&&this.map.t.render(u,l.text);u.closeNode()}parseOpen(u){const{name:l}=u;return this.parser?(this.parser.parseOpen(u),!0):l===this.tag?(this.model={sb:parseInt(u.attributes.sb,10),eb:parseInt(u.attributes.eb,10)},!0):(this.parser=this.map[l],!!this.parser&&(this.parser.parseOpen(u),!0))}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){switch(u){case"r":{let l=this.model.richText;l||(l=this.model.richText=[]),l.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,i,s){const a=e("./text-xform"),o=e("../style/font-xform"),r=e("../base-xform");class u extends r{constructor(h){super(),this.model=h}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new a)}get fontXform(){return this._fontXform||(this._fontXform=new o(u.FONT_OPTIONS))}render(h,f){f=f||this.model,h.openNode("r"),f.font&&this.fontXform.render(h,f.font),this.textXform.render(h,f.text),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(h),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){switch(h){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(h),!0}}}u.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},i.exports=u},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,i,s){const a=e("./text-xform"),o=e("./rich-text-xform"),r=e("./phonetic-text-xform"),u=e("../base-xform");i.exports=class extends u{constructor(l){super(),this.model=l,this.map={r:new o,t:new a,rPh:new r}}get tag(){return"si"}render(l,h){l.openNode(this.tag),h&&h.hasOwnProperty("richText")&&h.richText?h.richText.length?h.richText.forEach(f=>{this.map.r.render(l,f)}):this.map.t.render(l,""):h!=null&&this.map.t.render(l,h),l.closeNode()}parseOpen(l){const{name:h}=l;return this.parser?(this.parser.parseOpen(l),!0):h===this.tag?(this.model={},!0):(this.parser=this.map[h],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let h=this.model.richText;h||(h=this.model.richText=[]),h.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(l){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform"),r=e("./shared-string-xform");i.exports=class extends o{constructor(u){super(),this.model=u||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new r)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(u){return this.model.values[u]}add(u){return u.richText?this.addRichText(u):this.addText(u)}addText(u){let l=this.hash[u];return l===void 0&&(l=this.hash[u]=this.model.values.length,this.model.values.push(u)),this.model.count++,l}addRichText(u){const l=this.sharedStringXform.toXml(u);let h=this.rich[l];return h===void 0&&(h=this.rich[l]=this.model.values.length,this.model.values.push(u)),this.model.count++,h}render(u,l){l=l||this._values,u.openXml(a.StdDocAttributes),u.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:l.count,uniqueCount:l.values.length});const h=this.sharedStringXform;l.values.forEach(f=>{h.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(u),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(u){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"t"}render(o,r){o.openNode("t"),/^\s|\n|\s$/.test(r)&&o.addAttribute("xml:space","preserve"),o.writeText(r),o.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(o,r)=>String.fromCharCode(parseInt(r,16)))}parseOpen(o){switch(o.name){case"t":return this._text=[],!0;default:return!1}}parseText(o){this._text.push(o)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,i,s){const a=e("../../../doc/enums"),o=e("../../../utils/utils"),r=e("../base-xform"),u={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((h,f)=>(h[f]=!0,h),{}),horizontal(h){return this.horizontalValues[h]?h:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((h,f)=>(h[f]=!0,h),{}),vertical(h){return h==="middle"?"center":this.verticalValues[h]?h:void 0},wrapText:h=>!!h||void 0,shrinkToFit:h=>!!h||void 0,textRotation(h){switch(h){case"vertical":return h;default:return(h=o.validInt(h))>=-90&&h<=90?h:void 0}},indent:h=>(h=o.validInt(h),Math.max(0,h)),readingOrder(h){switch(h){case"ltr":return a.ReadingOrder.LeftToRight;case"rtl":return a.ReadingOrder.RightToLeft;default:return}}},l={toXml(h){if(h=u.textRotation(h)){if(h==="vertical")return 255;const f=Math.round(h);if(f>=0&&f<=90)return f;if(f<0&&f>=-90)return 90-f}},toModel(h){const f=o.validInt(h);if(f!==void 0){if(f===255)return"vertical";if(f>=0&&f<=90)return f;if(f>90&&f<=180)return 90-f}}};i.exports=class extends r{get tag(){return"alignment"}render(h,f){h.addRollback(),h.openNode("alignment");let d=!1;function p(b,v){v&&(h.addAttribute(b,v),d=!0)}p("horizontal",u.horizontal(f.horizontal)),p("vertical",u.vertical(f.vertical)),p("wrapText",!!u.wrapText(f.wrapText)&&"1"),p("shrinkToFit",!!u.shrinkToFit(f.shrinkToFit)&&"1"),p("indent",u.indent(f.indent)),p("textRotation",l.toXml(f.textRotation)),p("readingOrder",u.readingOrder(f.readingOrder)),h.closeNode(),d?h.commit():h.rollback()}parseOpen(h){const f={};let d=!1;function p(b,v,x){b&&(f[v]=x,d=!0)}p(h.attributes.horizontal,"horizontal",h.attributes.horizontal),p(h.attributes.vertical,"vertical",h.attributes.vertical==="center"?"middle":h.attributes.vertical),p(h.attributes.wrapText,"wrapText",o.parseBoolean(h.attributes.wrapText)),p(h.attributes.shrinkToFit,"shrinkToFit",o.parseBoolean(h.attributes.shrinkToFit)),p(h.attributes.indent,"indent",parseInt(h.attributes.indent,10)),p(h.attributes.textRotation,"textRotation",l.toModel(h.attributes.textRotation)),p(h.attributes.readingOrder,"readingOrder",h.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=d?f:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,i,s){const a=e("../base-xform"),o=e("../../../utils/utils"),r=e("./color-xform");class u extends a{constructor(h){super(),this.name=h,this.map={color:new r}}get tag(){return this.name}render(h,f,d){const p=f&&f.color||d||this.defaultColor;h.openNode(this.name),f&&f.style&&(h.addAttribute("style",f.style),p&&this.map.color.render(h,p)),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.name:{const{style:f}=h.attributes;return this.model=f?{style:f}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.parser=void 0),!0):(h===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(h){return u.validStyleValues[h]}}u.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((l,h)=>(l[h]=!0,l),{}),i.exports=class extends a{constructor(){super(),this.map={top:new u("top"),left:new u("left"),bottom:new u("bottom"),right:new u("right"),diagonal:new u("diagonal")}}render(l,h){const{color:f}=h;function d(p,b){p&&!p.color&&h.color&&(p=Il(wi({},p),{color:h.color})),b.render(l,p,f)}l.openNode("border"),h.diagonal&&h.diagonal.style&&(h.diagonal.up&&l.addAttribute("diagonalUp","1"),h.diagonal.down&&l.addAttribute("diagonalDown","1")),d(h.left,this.map.left),d(h.right,this.map.right),d(h.top,this.map.top),d(h.bottom,this.map.bottom),d(h.diagonal,this.map.diagonal),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"border":return this.reset(),this.diagonalUp=o.parseBoolean(l.attributes.diagonalUp),this.diagonalDown=o.parseBoolean(l.attributes.diagonalDown),!0;default:return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;if(l==="border"){const h=this.model={},f=function(d,p,b){p&&(b&&Object.assign(p,b),h[d]=p)};f("left",this.map.left.model),f("right",this.map.right.model),f("top",this.map.top.model),f("bottom",this.map.bottom.model),f("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{constructor(o){super(),this.name=o||"color"}get tag(){return this.name}render(o,r){return!!r&&(o.openNode(this.name),r.argb?o.addAttribute("rgb",r.argb):r.theme!==void 0?(o.addAttribute("theme",r.theme),r.tint!==void 0&&o.addAttribute("tint",r.tint)):r.indexed!==void 0?o.addAttribute("indexed",r.indexed):o.addAttribute("auto","1"),o.closeNode(),!0)}parseOpen(o){return o.name===this.name&&(o.attributes.rgb?this.model={argb:o.attributes.rgb}:o.attributes.theme?(this.model={theme:parseInt(o.attributes.theme,10)},o.attributes.tint&&(this.model.tint=parseFloat(o.attributes.tint))):o.attributes.indexed?this.model={indexed:parseInt(o.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,i,s){const a=e("../base-xform"),o=e("./alignment-xform"),r=e("./border-xform"),u=e("./fill-xform"),l=e("./font-xform"),h=e("./numfmt-xform"),f=e("./protection-xform");i.exports=class extends a{constructor(){super(),this.map={alignment:new o,border:new r,fill:new u,font:new l,numFmt:new h,protection:new f}}get tag(){return"dxf"}render(d,p){if(d.openNode(this.tag),p.font&&this.map.font.render(d,p.font),p.numFmt&&p.numFmtId){const b={id:p.numFmtId,formatCode:p.numFmt};this.map.numFmt.render(d,b)}p.fill&&this.map.fill.render(d,p.fill),p.alignment&&this.map.alignment.render(d,p.alignment),p.border&&this.map.border.render(d,p.border),p.protection&&this.map.protection.render(d,p.protection),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d),!0}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):d!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,i,s){const a=e("../base-xform"),o=e("./color-xform");class r extends a{constructor(){super(),this.map={color:new o}}get tag(){return"stop"}render(d,p){d.openNode("stop"),d.addAttribute("position",p.position),this.map.color.render(d,p.color),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"stop":return this.model={position:parseFloat(d.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(d),!0;default:return!1}}parseText(){}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class u extends a{constructor(){super(),this.map={fgColor:new o("fgColor"),bgColor:new o("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(d,p){d.openNode("patternFill"),d.addAttribute("patternType",p.pattern),p.fgColor&&this.map.fgColor.render(d,p.fgColor),p.bgColor&&this.map.bgColor.render(d,p.bgColor),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"patternFill":return this.model={type:"pattern",pattern:d.attributes.patternType},!0;default:return this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0)}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.parser.model&&(this.model[d]=this.parser.model),this.parser=void 0),!0)}}class l extends a{constructor(){super(),this.map={stop:new r}}get name(){return"gradient"}get tag(){return"gradientFill"}render(d,p){switch(d.openNode("gradientFill"),p.gradient){case"angle":d.addAttribute("degree",p.degree);break;case"path":d.addAttribute("type","path"),p.center.left&&(d.addAttribute("left",p.center.left),p.center.right===void 0&&d.addAttribute("right",p.center.left)),p.center.right&&d.addAttribute("right",p.center.right),p.center.top&&(d.addAttribute("top",p.center.top),p.center.bottom===void 0&&d.addAttribute("bottom",p.center.top)),p.center.bottom&&d.addAttribute("bottom",p.center.bottom)}const b=this.map.stop;p.stops.forEach(v=>{b.render(d,v)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"gradientFill":{const p=this.model={stops:[]};return d.attributes.degree?(p.gradient="angle",p.degree=parseInt(d.attributes.degree,10)):d.attributes.type==="path"&&(p.gradient="path",p.center={left:d.attributes.left?parseFloat(d.attributes.left):0,top:d.attributes.top?parseFloat(d.attributes.top):0},d.attributes.right!==d.attributes.left&&(p.center.right=d.attributes.right?parseFloat(d.attributes.right):0),d.attributes.bottom!==d.attributes.top&&(p.center.bottom=d.attributes.bottom?parseFloat(d.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class h extends a{constructor(){super(),this.map={patternFill:new u,gradientFill:new l}}get tag(){return"fill"}render(d,p){switch(d.addRollback(),d.openNode("fill"),p.type){case"pattern":this.map.patternFill.render(d,p);break;case"gradient":this.map.gradientFill.render(d,p);break;default:return void d.rollback()}d.closeNode(),d.commit()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"fill":return this.model={},!0;default:return this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0)}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(d){return h.validPatternValues[d]}}h.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((f,d)=>(f[d]=!0,f),{}),h.StopXform=r,h.PatternFillXform=u,h.GradientFillXform=l,i.exports=h},{"../base-xform":32,"./color-xform":128}],131:[function(e,i,s){const a=e("./color-xform"),o=e("../simple/boolean-xform"),r=e("../simple/integer-xform"),u=e("../simple/string-xform"),l=e("./underline-xform"),h=e("../../../utils/under-dash"),f=e("../base-xform");class d extends f{constructor(b){super(),this.options=b||d.OPTIONS,this.map={b:{prop:"bold",xform:new o({tag:"b",attr:"val"})},i:{prop:"italic",xform:new o({tag:"i",attr:"val"})},u:{prop:"underline",xform:new l},charset:{prop:"charset",xform:new r({tag:"charset",attr:"val"})},color:{prop:"color",xform:new a},condense:{prop:"condense",xform:new o({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new o({tag:"extend",attr:"val"})},family:{prop:"family",xform:new r({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new o({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new u({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new u({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new o({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new o({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new r({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new u({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(b,v){const{map:x}=this;b.openNode(this.options.tagName),h.each(this.map,(w,M)=>{x[M].xform.render(b,v[w.prop])}),b.closeNode()}parseOpen(b){if(this.parser)return this.parser.parseOpen(b),!0;if(this.map[b.name])return this.parser=this.map[b.name].xform,this.parser.parseOpen(b);switch(b.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(b){this.parser&&this.parser.parseText(b)}parseClose(b){if(this.parser&&!this.parser.parseClose(b)){const v=this.map[b];return this.parser.model&&(this.model[v.prop]=this.parser.model),this.parser=void 0,!0}switch(b){case this.options.tagName:return!1;default:return!0}}}d.OPTIONS={tagName:"font",fontNameTag:"name"},i.exports=d},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,i,s){const a=e("../../../utils/under-dash"),o=e("../../defaultnumformats"),r=e("../base-xform"),u=function(){const h={};return a.each(o,(f,d)=>{f.f&&(h[f.f]=parseInt(d,10))}),h}();class l extends r{constructor(f,d){super(),this.id=f,this.formatCode=d}get tag(){return"numFmt"}render(f,d){f.leafNode("numFmt",{numFmtId:d.id,formatCode:d.formatCode})}parseOpen(f){switch(f.name){case"numFmt":return this.model={id:parseInt(f.attributes.numFmtId,10),formatCode:f.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}l.getDefaultFmtId=function(h){return u[h]},l.getDefaultFmtCode=function(h){return o[h]&&o[h].f},i.exports=l},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,i,s){const a=e("../base-xform"),o={boolean:(r,u)=>r===void 0?u:r};i.exports=class extends a{get tag(){return"protection"}render(r,u){r.addRollback(),r.openNode("protection");let l=!1;function h(f,d){d!==void 0&&(r.addAttribute(f,d),l=!0)}h("locked",o.boolean(u.locked,!0)?void 0:"0"),h("hidden",o.boolean(u.hidden,!1)?"1":void 0),r.closeNode(),l?r.commit():r.rollback()}parseOpen(r){const u={locked:r.attributes.locked!=="0",hidden:r.attributes.hidden==="1"},l=!u.locked||u.hidden;this.model=l?u:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,i,s){const a=e("../base-xform"),o=e("./alignment-xform"),r=e("./protection-xform");i.exports=class extends a{constructor(u){super(),this.xfId=!(!u||!u.xfId),this.map={alignment:new o,protection:new r}}get tag(){return"xf"}render(u,l){u.openNode("xf",{numFmtId:l.numFmtId||0,fontId:l.fontId||0,fillId:l.fillId||0,borderId:l.borderId||0}),this.xfId&&u.addAttribute("xfId",l.xfId||0),l.numFmtId&&u.addAttribute("applyNumberFormat","1"),l.fontId&&u.addAttribute("applyFont","1"),l.fillId&&u.addAttribute("applyFill","1"),l.borderId&&u.addAttribute("applyBorder","1"),l.alignment&&u.addAttribute("applyAlignment","1"),l.protection&&u.addAttribute("applyProtection","1"),l.alignment&&this.map.alignment.render(u,l.alignment),l.protection&&this.map.protection.render(u,l.protection),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"xf":return this.model={numFmtId:parseInt(u.attributes.numFmtId,10),fontId:parseInt(u.attributes.fontId,10),fillId:parseInt(u.attributes.fillId,10),borderId:parseInt(u.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(u.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(u),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):u!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,i,s){const a=e("../../../doc/enums"),o=e("../../../utils/xml-stream"),r=e("../base-xform"),u=e("../static-xform"),l=e("../list-xform"),h=e("./font-xform"),f=e("./fill-xform"),d=e("./border-xform"),p=e("./numfmt-xform"),b=e("./style-xform"),v=e("./dxf-xform");class x extends r{constructor(M){super(),this.map={numFmts:new l({tag:"numFmts",count:!0,childXform:new p}),fonts:new l({tag:"fonts",count:!0,childXform:new h,$:{"x14ac:knownFonts":1}}),fills:new l({tag:"fills",count:!0,childXform:new f}),borders:new l({tag:"borders",count:!0,childXform:new d}),cellStyleXfs:new l({tag:"cellStyleXfs",count:!0,childXform:new b}),cellXfs:new l({tag:"cellXfs",count:!0,childXform:new b({xfId:!0})}),dxfs:new l({tag:"dxfs",always:!0,count:!0,childXform:new v}),numFmt:new p,font:new h,fill:new f,border:new d,style:new b({xfId:!0}),cellStyles:x.STATIC_XFORMS.cellStyles,tableStyles:x.STATIC_XFORMS.tableStyles,extLst:x.STATIC_XFORMS.extLst},M&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(M,E){E=E||this.model,M.openXml(o.StdDocAttributes),M.openNode("styleSheet",x.STYLESHEET_ATTRIBUTES),this.index?(E.numFmts&&E.numFmts.length&&(M.openNode("numFmts",{count:E.numFmts.length}),E.numFmts.forEach(D=>{M.writeXml(D)}),M.closeNode()),E.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),M.openNode("fonts",{count:E.fonts.length,"x14ac:knownFonts":1}),E.fonts.forEach(D=>{M.writeXml(D)}),M.closeNode(),M.openNode("fills",{count:E.fills.length}),E.fills.forEach(D=>{M.writeXml(D)}),M.closeNode(),M.openNode("borders",{count:E.borders.length}),E.borders.forEach(D=>{M.writeXml(D)}),M.closeNode(),this.map.cellStyleXfs.render(M,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),M.openNode("cellXfs",{count:E.styles.length}),E.styles.forEach(D=>{M.writeXml(D)}),M.closeNode()):(this.map.numFmts.render(M,E.numFmts),this.map.fonts.render(M,E.fonts),this.map.fills.render(M,E.fills),this.map.borders.render(M,E.borders),this.map.cellStyleXfs.render(M,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(M,E.styles)),x.STATIC_XFORMS.cellStyles.render(M),this.map.dxfs.render(M,E.dxfs),x.STATIC_XFORMS.tableStyles.render(M),x.STATIC_XFORMS.extLst.render(M),M.closeNode()}parseOpen(M){if(this.parser)return this.parser.parseOpen(M),!0;switch(M.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[M.name],this.parser&&this.parser.parseOpen(M),!0}}parseText(M){this.parser&&this.parser.parseText(M)}parseClose(M){if(this.parser)return this.parser.parseClose(M)||(this.parser=void 0),!0;switch(M){case"styleSheet":{this.model={};const E=(D,N)=>{N.model&&N.model.length&&(this.model[D]=N.model)};if(E("numFmts",this.map.numFmts),E("fonts",this.map.fonts),E("fills",this.map.fills),E("borders",this.map.borders),E("styles",this.map.cellXfs),E("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const D=this.index.numFmt;this.model.numFmts.forEach(N=>{D[N.id]=N.formatCode})}return!1}default:return!0}}addStyleModel(M,E){if(!M)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(M))return this.weakMap.get(M);const D={};if(E=E||a.ValueType.Number,M.numFmt)D.numFmtId=this._addNumFmtStr(M.numFmt);else switch(E){case a.ValueType.Number:D.numFmtId=this._addNumFmtStr("General");break;case a.ValueType.Date:D.numFmtId=this._addNumFmtStr("mm-dd-yy")}M.font&&(D.fontId=this._addFont(M.font)),M.border&&(D.borderId=this._addBorder(M.border)),M.fill&&(D.fillId=this._addFill(M.fill)),M.alignment&&(D.alignment=M.alignment),M.protection&&(D.protection=M.protection);const N=this._addStyle(D);return this.weakMap&&this.weakMap.set(M,N),N}getStyleModel(M){const E=this.model.styles[M];if(!E)return null;let D=this.index.model[M];if(D)return D;if(D=this.index.model[M]={},E.numFmtId){const V=this.index.numFmt[E.numFmtId]||p.getDefaultFmtCode(E.numFmtId);V&&(D.numFmt=V)}function N(V,K,j){if(j||j===0){const Z=K[j];Z&&(D[V]=Z)}}return N("font",this.model.fonts,E.fontId),N("border",this.model.borders,E.borderId),N("fill",this.model.fills,E.fillId),E.alignment&&(D.alignment=E.alignment),E.protection&&(D.protection=E.protection),D}addDxfStyle(M){return M.numFmt&&(M.numFmtId=this._addNumFmtStr(M.numFmt)),this.model.dxfs.push(M),this.model.dxfs.length-1}getDxfStyle(M){return this.model.dxfs[M]}_addStyle(M){const E=this.map.style.toXml(M);let D=this.index.style[E];return D===void 0&&(D=this.index.style[E]=this.model.styles.length,this.model.styles.push(E)),D}_addNumFmtStr(M){let E=p.getDefaultFmtId(M);if(E!==void 0||(E=this.index.numFmt[M],E!==void 0))return E;E=this.index.numFmt[M]=164+this.model.numFmts.length;const D=this.map.numFmt.toXml({id:E,formatCode:M});return this.model.numFmts.push(D),E}_addFont(M){const E=this.map.font.toXml(M);let D=this.index.font[E];return D===void 0&&(D=this.index.font[E]=this.model.fonts.length,this.model.fonts.push(E)),D}_addBorder(M){const E=this.map.border.toXml(M);let D=this.index.border[E];return D===void 0&&(D=this.index.border[E]=this.model.borders.length,this.model.borders.push(E)),D}_addFill(M){const E=this.map.fill.toXml(M);let D=this.index.fill[E];return D===void 0&&(D=this.index.fill[E]=this.model.fills.length,this.model.fills.push(E)),D}}x.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},x.STATIC_XFORMS={cellStyles:new u({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new u({tag:"dxfs",$:{count:0}}),tableStyles:new u({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new u({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},x.Mock=class extends x{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(w){return w.autodrain(),Promise.resolve()}addStyleModel(w,M){switch(M){case a.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const w={numFmtId:p.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(w)}return this._dateStyleId}getStyleModel(){return{}}},i.exports=x},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,i,s){const a=e("../base-xform");class o extends a{constructor(u){super(),this.model=u}get tag(){return"u"}render(u,l){if((l=l||this.model)===!0)u.leafNode("u");else{const h=o.Attributes[l];h&&u.leafNode("u",h)}}parseOpen(u){u.name==="u"&&(this.model=u.attributes.val||!0)}parseText(){}parseClose(){return!1}}o.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},i.exports=o},{"../base-xform":32}],137:[function(e,i,s){const a=e("../base-xform"),o=e("./filter-column-xform");i.exports=class extends a{constructor(){super(),this.map={filterColumn:new o}}get tag(){return"autoFilter"}prepare(r){r.columns.forEach((u,l)=>{this.map.filterColumn.prepare(u,{index:l})})}render(r,u){return r.openNode(this.tag,{ref:u.autoFilterRef}),u.columns.forEach(l=>{this.map.filterColumn.render(r,l)}),r.closeNode(),!0}parseOpen(r){if(this.parser)return this.parser.parseOpen(r),!0;switch(r.name){case this.tag:return this.model={autoFilterRef:r.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[r.name],this.parser)return this.parseOpen(r),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(r))}}parseText(r){this.parser&&this.parser.parseText(r)}parseClose(r){if(this.parser)return this.parser.parseClose(r)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(r){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+r)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"customFilter"}render(o,r){o.leafNode(this.tag,{val:r.val,operator:r.operator})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val,operator:o.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,i,s){const a=e("../base-xform"),o=e("../list-xform"),r=e("./custom-filter-xform"),u=e("./filter-xform");i.exports=class extends a{constructor(){super(),this.map={customFilters:new o({tag:"customFilters",count:!1,empty:!0,childXform:new r}),filters:new o({tag:"filters",count:!1,empty:!0,childXform:new u})}}get tag(){return"filterColumn"}prepare(l,h){l.colId=h.index.toString()}render(l,h){return h.customFilters?(l.openNode(this.tag,{colId:h.colId,hiddenButton:h.filterButton?"0":"1"}),this.map.customFilters.render(l,h.customFilters),l.closeNode(),!0):(l.leafNode(this.tag,{colId:h.colId,hiddenButton:h.filterButton?"0":"1"}),!0)}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;const{attributes:h}=l;switch(l.name){case this.tag:return this.model={filterButton:h.hiddenButton==="0"},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"filter"}render(o,r){o.leafNode(this.tag,{val:r.val})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"tableColumn"}prepare(o,r){o.id=r.index+1}render(o,r){return o.leafNode(this.tag,{id:r.id.toString(),name:r.name,totalsRowLabel:r.totalsRowLabel,totalsRowFunction:r.totalsRowFunction,dxfId:r.dxfId}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:r}=o;return this.model={name:r.name,totalsRowLabel:r.totalsRowLabel,totalsRowFunction:r.totalsRowFunction,dxfId:r.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,i,s){const a=e("../base-xform");i.exports=class extends a{get tag(){return"tableStyleInfo"}render(o,r){return o.leafNode(this.tag,{name:r.theme?r.theme:void 0,showFirstColumn:r.showFirstColumn?"1":"0",showLastColumn:r.showLastColumn?"1":"0",showRowStripes:r.showRowStripes?"1":"0",showColumnStripes:r.showColumnStripes?"1":"0"}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:r}=o;return this.model={theme:r.name?r.name:null,showFirstColumn:r.showFirstColumn==="1",showLastColumn:r.showLastColumn==="1",showRowStripes:r.showRowStripes==="1",showColumnStripes:r.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,i,s){const a=e("../../../utils/xml-stream"),o=e("../base-xform"),r=e("../list-xform"),u=e("./auto-filter-xform"),l=e("./table-column-xform"),h=e("./table-style-info-xform");class f extends o{constructor(){super(),this.map={autoFilter:new u,tableColumns:new r({tag:"tableColumns",count:!0,empty:!0,childXform:new l}),tableStyleInfo:new h}}prepare(p,b){this.map.autoFilter.prepare(p),this.map.tableColumns.prepare(p.columns,b)}get tag(){return"table"}render(p,b){p.openXml(a.StdDocAttributes),p.openNode(this.tag,Il(wi({},f.TABLE_ATTRIBUTES),{id:b.id,name:b.name,displayName:b.displayName||b.name,ref:b.tableRef,totalsRowCount:b.totalsRow?"1":void 0,totalsRowShown:b.totalsRow?void 0:"1",headerRowCount:b.headerRow?"1":"0"})),this.map.autoFilter.render(p,b),this.map.tableColumns.render(p,b.columns),this.map.tableStyleInfo.render(p,b.style),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;const{name:b,attributes:v}=p;switch(b){case this.tag:this.reset(),this.model={name:v.name,displayName:v.displayName||v.name,tableRef:v.ref,totalsRow:v.totalsRowCount==="1",headerRow:v.headerRowCount==="1"};break;default:this.parser=this.map[p.name],this.parser&&this.parser.parseOpen(p)}return!0}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser)return this.parser.parseClose(p)||(this.parser=void 0),!0;switch(p){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((b,v)=>{this.model.columns[v].filterButton=b.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(p,b){p.columns.forEach(v=>{v.dxfId!==void 0&&(v.style=b.styles.getDxfStyle(v.dxfId))})}}f.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},i.exports=f},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,i,s){(function(a,o){(function(){const r=e("fs"),u=e("jszip"),{PassThrough:l}=e("readable-stream"),h=e("../utils/zip-stream"),f=e("../utils/stream-buf"),d=e("../utils/utils"),p=e("../utils/xml-stream"),{bufferToString:b}=e("../utils/browser-buffer-decode"),v=e("./xform/style/styles-xform"),x=e("./xform/core/core-xform"),w=e("./xform/strings/shared-strings-xform"),M=e("./xform/core/relationships-xform"),E=e("./xform/core/content-types-xform"),D=e("./xform/core/app-xform"),N=e("./xform/book/workbook-xform"),V=e("./xform/sheet/worksheet-xform"),K=e("./xform/drawing/drawing-xform"),j=e("./xform/table/table-xform"),Z=e("./xform/comment/comments-xform"),tt=e("./xform/comment/vml-notes-xform"),rt=e("./xml/theme1");class J{constructor(G){this.workbook=G}readFile(G,I){return re(this,null,function*(){if(!(yield d.fs.exists(G)))throw new Error("File not found: "+G);const C=r.createReadStream(G);try{const L=yield this.read(C,I);return C.close(),L}catch(L){throw C.close(),L}})}parseRels(G){return new M().parseStream(G)}parseWorkbook(G){return new N().parseStream(G)}parseSharedStrings(G){return new w().parseStream(G)}reconcile(G,I){const C=new N,L=new V(I),B=new K,O=new j;C.reconcile(G);const q={media:G.media,mediaIndex:G.mediaIndex};Object.keys(G.drawings).forEach(lt=>{const ut=G.drawings[lt],vt=G.drawingRels[lt];vt&&(q.rels=vt.reduce((Q,gt)=>(Q[gt.Id]=gt,Q),{}),(ut.anchors||[]).forEach(Q=>{const gt=Q.picture&&Q.picture.hyperlinks;gt&&q.rels[gt.rId]&&(gt.hyperlink=q.rels[gt.rId].Target,delete gt.rId)}),B.reconcile(ut,q))});const it={styles:G.styles};Object.values(G.tables).forEach(lt=>{O.reconcile(lt,it)});const nt={styles:G.styles,sharedStrings:G.sharedStrings,media:G.media,mediaIndex:G.mediaIndex,date1904:G.properties&&G.properties.date1904,drawings:G.drawings,comments:G.comments,tables:G.tables,vmlDrawings:G.vmlDrawings};G.worksheets.forEach(lt=>{lt.relationships=G.worksheetRels[lt.sheetNo],L.reconcile(lt,nt)}),delete G.worksheetHash,delete G.worksheetRels,delete G.globalRels,delete G.sharedStrings,delete G.workbookRels,delete G.sheetDefs,delete G.styles,delete G.mediaIndex,delete G.drawings,delete G.drawingRels,delete G.vmlDrawings}_processWorksheetEntry(G,I,C,L,B){return re(this,null,function*(){const O=new V(L),q=yield O.parseStream(G);q.sheetNo=C,I.worksheetHash[B]=q,I.worksheets.push(q)})}_processCommentEntry(G,I,C){return re(this,null,function*(){const L=new Z,B=yield L.parseStream(G);I.comments[`../${C}.xml`]=B})}_processTableEntry(G,I,C){return re(this,null,function*(){const L=new j,B=yield L.parseStream(G);I.tables[`../tables/${C}.xml`]=B})}_processWorksheetRelsEntry(G,I,C){return re(this,null,function*(){const L=new M,B=yield L.parseStream(G);I.worksheetRels[C]=B})}_processMediaEntry(G,I,C){return re(this,null,function*(){const L=C.lastIndexOf(".");if(L>=1){const B=C.substr(L+1),O=C.substr(0,L);yield new Promise((q,it)=>{const nt=new f;nt.on("finish",()=>{I.mediaIndex[C]=I.media.length,I.mediaIndex[O]=I.media.length;const lt={type:"image",name:O,extension:B,buffer:nt.toBuffer()};I.media.push(lt),q()}),G.on("error",lt=>{it(lt)}),G.pipe(nt)})}})}_processDrawingEntry(G,I,C){return re(this,null,function*(){const L=new K,B=yield L.parseStream(G);I.drawings[C]=B})}_processDrawingRelsEntry(G,I,C){return re(this,null,function*(){const L=new M,B=yield L.parseStream(G);I.drawingRels[C]=B})}_processVmlDrawingEntry(G,I,C){return re(this,null,function*(){const L=new tt,B=yield L.parseStream(G);I.vmlDrawings[`../drawings/${C}.vml`]=B})}_processThemeEntry(G,I,C){return re(this,null,function*(){yield new Promise((L,B)=>{const O=new f;G.on("error",B),O.on("error",B),O.on("finish",()=>{I.themes[C]=O.read().toString(),L()}),G.pipe(O)})})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}read(G,I){return re(this,null,function*(){!G[Symbol.asyncIterator]&&G.pipe&&(G=G.pipe(new l));const C=[];try{for(var L=g1(G),B,O,q;B=!(O=yield L.next()).done;B=!1){const it=O.value;C.push(it)}}catch(O){q=[O]}finally{try{B&&(O=L.return)&&(yield O.call(L))}finally{if(q)throw q[0]}}return this.load(o.concat(C),I)})}load(G,I){return re(this,null,function*(){let C;C=I&&I.base64?o.from(G.toString(),"base64"):G;const L={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},B=yield u.loadAsync(C);for(const O of Object.values(B.files))if(!O.dir){let q,it=O.name;if(it[0]==="/"&&(it=it.substr(1)),it.match(/xl\/media\//)||it.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))q=new l,q.write(yield O.async("nodebuffer"));else{let nt;q=new l({writableObjectMode:!0,readableObjectMode:!0}),nt=a.browser?b(yield O.async("nodebuffer")):yield O.async("string");const lt=16384;for(let ut=0;ut<nt.length;ut+=lt)q.write(nt.substring(ut,ut+lt))}switch(q.end(),it){case"_rels/.rels":L.globalRels=yield this.parseRels(q);break;case"xl/workbook.xml":{const nt=yield this.parseWorkbook(q);L.sheets=nt.sheets,L.definedNames=nt.definedNames,L.views=nt.views,L.properties=nt.properties,L.calcProperties=nt.calcProperties;break}case"xl/_rels/workbook.xml.rels":L.workbookRels=yield this.parseRels(q);break;case"xl/sharedStrings.xml":L.sharedStrings=new w,yield L.sharedStrings.parseStream(q);break;case"xl/styles.xml":L.styles=new v,yield L.styles.parseStream(q);break;case"docProps/app.xml":{const nt=new D,lt=yield nt.parseStream(q);L.company=lt.company,L.manager=lt.manager;break}case"docProps/core.xml":{const nt=new x,lt=yield nt.parseStream(q);Object.assign(L,lt);break}default:{let nt=it.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(nt){yield this._processWorksheetEntry(q,L,nt[1],I,it);break}if(nt=it.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),nt){yield this._processWorksheetRelsEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),nt){yield this._processThemeEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),nt){yield this._processMediaEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),nt){yield this._processDrawingEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/(comments\d+)[.]xml/),nt){yield this._processCommentEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/tables\/(table\d+)[.]xml/),nt){yield this._processTableEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),nt){yield this._processDrawingRelsEntry(q,L,nt[1]);break}if(nt=it.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),nt){yield this._processVmlDrawingEntry(q,L,nt[1]);break}}}}return this.reconcile(L,I),this.workbook.model=L,this.workbook})}addMedia(G,I){return re(this,null,function*(){yield Promise.all(I.media.map(C=>re(this,null,function*(){if(C.type==="image"){const L=`xl/media/${C.name}.${C.extension}`;if(C.filename){const B=yield function(O,q){return new Promise((it,nt)=>{r.readFile(O,q,(lt,ut)=>{lt?nt(lt):it(ut)})})}(C.filename);return G.append(B,{name:L})}if(C.buffer)return G.append(C.buffer,{name:L});if(C.base64){const B=C.base64,O=B.substring(B.indexOf(",")+1);return G.append(O,{name:L,base64:!0})}}throw new Error("Unsupported media")})))})}addDrawings(G,I){const C=new K,L=new M;I.worksheets.forEach(B=>{const{drawing:O}=B;if(O){C.prepare(O,{});let q=C.toXml(O);G.append(q,{name:`xl/drawings/${O.name}.xml`}),q=L.toXml(O.rels),G.append(q,{name:`xl/drawings/_rels/${O.name}.xml.rels`})}})}addTables(G,I){const C=new j;I.worksheets.forEach(L=>{const{tables:B}=L;B.forEach(O=>{C.prepare(O,{});const q=C.toXml(O);G.append(q,{name:"xl/tables/"+O.target})})})}addContentTypes(G,I){return re(this,null,function*(){const C=new E().toXml(I);G.append(C,{name:"[Content_Types].xml"})})}addApp(G,I){return re(this,null,function*(){const C=new D().toXml(I);G.append(C,{name:"docProps/app.xml"})})}addCore(G,I){return re(this,null,function*(){const C=new x;G.append(C.toXml(I),{name:"docProps/core.xml"})})}addThemes(G,I){return re(this,null,function*(){const C=I.themes||{theme1:rt};Object.keys(C).forEach(L=>{const B=C[L],O=`xl/theme/${L}.xml`;G.append(B,{name:O})})})}addOfficeRels(G){return re(this,null,function*(){const I=new M().toXml([{Id:"rId1",Type:J.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:J.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:J.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);G.append(I,{name:"_rels/.rels"})})}addWorkbookRels(G,I){return re(this,null,function*(){let C=1;const L=[{Id:"rId"+C++,Type:J.RelType.Styles,Target:"styles.xml"},{Id:"rId"+C++,Type:J.RelType.Theme,Target:"theme/theme1.xml"}];I.sharedStrings.count&&L.push({Id:"rId"+C++,Type:J.RelType.SharedStrings,Target:"sharedStrings.xml"}),I.worksheets.forEach(O=>{O.rId="rId"+C++,L.push({Id:O.rId,Type:J.RelType.Worksheet,Target:`worksheets/sheet${O.id}.xml`})});const B=new M().toXml(L);G.append(B,{name:"xl/_rels/workbook.xml.rels"})})}addSharedStrings(G,I){return re(this,null,function*(){I.sharedStrings&&I.sharedStrings.count&&G.append(I.sharedStrings.xml,{name:"xl/sharedStrings.xml"})})}addStyles(G,I){return re(this,null,function*(){const{xml:C}=I.styles;C&&G.append(C,{name:"xl/styles.xml"})})}addWorkbook(G,I){return re(this,null,function*(){const C=new N;G.append(C.toXml(I),{name:"xl/workbook.xml"})})}addWorksheets(G,I){return re(this,null,function*(){const C=new V,L=new M,B=new Z,O=new tt;I.worksheets.forEach(q=>{let it=new p;C.render(it,q),G.append(it.xml,{name:`xl/worksheets/sheet${q.id}.xml`}),q.rels&&q.rels.length&&(it=new p,L.render(it,q.rels),G.append(it.xml,{name:`xl/worksheets/_rels/sheet${q.id}.xml.rels`})),q.comments.length>0&&(it=new p,B.render(it,q),G.append(it.xml,{name:`xl/comments${q.id}.xml`}),it=new p,O.render(it,q),G.append(it.xml,{name:`xl/drawings/vmlDrawing${q.id}.vml`}))})})}_finalize(G){return new Promise((I,C)=>{G.on("finish",()=>{I(this)}),G.on("error",C),G.finalize()})}prepareModel(G,I){G.creator=G.creator||"ExcelJS",G.lastModifiedBy=G.lastModifiedBy||"ExcelJS",G.created=G.created||new Date,G.modified=G.modified||new Date,G.useSharedStrings=I.useSharedStrings===void 0||I.useSharedStrings,G.useStyles=I.useStyles===void 0||I.useStyles,G.sharedStrings=new w,G.styles=G.useStyles?new v(!0):new v.Mock;const C=new N,L=new V;C.prepare(G);const B={sharedStrings:G.sharedStrings,styles:G.styles,date1904:G.properties.date1904,drawingsCount:0,media:G.media};B.drawings=G.drawings=[],B.commentRefs=G.commentRefs=[];let O=0;G.tables=[],G.worksheets.forEach(q=>{q.tables.forEach(it=>{O++,it.target=`table${O}.xml`,it.id=O,G.tables.push(it)}),L.prepare(q,B)})}write(G,I){return re(this,null,function*(){I=I||{};const{model:C}=this.workbook,L=new h.ZipWriter(I.zip);return L.pipe(G),this.prepareModel(C,I),yield this.addContentTypes(L,C),yield this.addOfficeRels(L,C),yield this.addWorkbookRels(L,C),yield this.addWorksheets(L,C),yield this.addSharedStrings(L,C),yield this.addDrawings(L,C),yield this.addTables(L,C),yield Promise.all([this.addThemes(L,C),this.addStyles(L,C)]),yield this.addMedia(L,C),yield Promise.all([this.addApp(L,C),this.addCore(L,C)]),yield this.addWorkbook(L,C),this._finalize(L)})}writeFile(G,I){const C=r.createWriteStream(G);return new Promise((L,B)=>{C.on("finish",()=>{L()}),C.on("error",O=>{B(O)}),this.write(C,I).then(()=>{C.end()}).catch(O=>{B(O)})})}writeBuffer(G){return re(this,null,function*(){const I=new f;return yield this.write(I,G),I.read()})}}J.RelType=e("./rel-type"),i.exports=J}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,i,s){i.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/> <a:font script="Hang" typeface="맑은 고딕"/> <a:font script="Hans" typeface="宋体"/> <a:font script="Hant" typeface="新細明體"/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/> <a:font script="Hang" typeface="맑은 고딕"/> <a:font script="Hans" typeface="宋体"/> <a:font script="Hant" typeface="新細明體"/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(e,i,s){(function(a){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvFormatterStream=void 0;const o=e("stream"),r=e("./formatter");class u extends o.Transform{constructor(h){super({writableObjectMode:h.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=h,this.rowFormatter=new r.RowFormatter(h),this.hasWrittenBOM=!h.writeBOM}transform(h){return this.rowFormatter.rowTransform=h,this}_transform(h,f,d){let p=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(h,(b,v)=>b?(p=!0,d(b)):(v&&v.forEach(x=>{this.push(a.from(x,"utf8"))}),p=!0,d()))}catch(b){if(p)throw b;d(b)}}_flush(h){this.rowFormatter.finish((f,d)=>f?h(f):(d&&d.forEach(p=>{this.push(a.from(p,"utf8"))}),h()))}}s.CsvFormatterStream=u}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.FormatterOptions=void 0,s.FormatterOptions=class{constructor(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var o;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,a||{}),(a==null?void 0:a.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(a==null?void 0:a.quote)===!0?this.quote='"':(a==null?void 0:a.quote)===!1&&(this.quote=""),typeof(a==null?void 0:a.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((o=a.writeHeaders)===null||o===void 0||o),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,i,s){var a=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0}),s.FieldFormatter=void 0;const o=a(e("lodash.isboolean")),r=a(e("lodash.isnil")),u=a(e("lodash.escaperegexp"));s.FieldFormatter=class{constructor(l){this._headers=null,this.formatterOptions=l,l.headers!==null&&(this.headers=l.headers),this.REPLACE_REGEXP=new RegExp(l.quote,"g");const h=`[${l.delimiter}${u.default(l.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(h)}set headers(l){this._headers=l}shouldQuote(l,h){const f=h?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return o.default(f)?f:Array.isArray(f)?f[l]:this._headers!==null&&f[this._headers[l]]}format(l,h,f){const d=(""+(r.default(l)?"":l)).replace(/\0/g,""),{formatterOptions:p}=this;return p.quote!==""&&d.indexOf(p.quote)!==-1?this.quoteField(d.replace(this.REPLACE_REGEXP,p.escapedQuote)):d.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(h,f)?this.quoteField(d):d}quoteField(l){const{quote:h}=this.formatterOptions;return`${h}${l}${h}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,i,s){var a=function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(s,"__esModule",{value:!0}),s.RowFormatter=void 0;const o=a(e("lodash.isfunction")),r=a(e("lodash.isequal")),u=e("./FieldFormatter"),l=e("../types");class h{constructor(d){this.rowCount=0,this.formatterOptions=d,this.fieldFormatter=new u.FieldFormatter(d),this.headers=d.headers,this.shouldWriteHeaders=d.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),d.transform&&(this.rowTransform=d.transform)}static isRowHashArray(d){return!!Array.isArray(d)&&Array.isArray(d[0])&&d[0].length===2}static isRowArray(d){return Array.isArray(d)&&!this.isRowHashArray(d)}static gatherHeaders(d){return h.isRowHashArray(d)?d.map(p=>p[0]):Array.isArray(d)?d:Object.keys(d)}static createTransform(d){return l.isSyncTransform(d)?(p,b)=>{let v=null;try{v=d(p)}catch(x){return b(x)}return b(null,v)}:(p,b)=>{d(p,b)}}set rowTransform(d){if(!o.default(d))throw new TypeError("The transform should be a function");this._rowTransform=h.createTransform(d)}format(d,p){this.callTransformer(d,(b,v)=>{if(b)return p(b);if(!d)return p(null);const x=[];if(v){const{shouldFormatColumns:w,headers:M}=this.checkHeaders(v);if(this.shouldWriteHeaders&&M&&!this.hasWrittenHeaders&&(x.push(this.formatColumns(M,!0)),this.hasWrittenHeaders=!0),w){const E=this.gatherColumns(v);x.push(this.formatColumns(E,!1))}}return p(null,x)})}finish(d){const p=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return d(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));p.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&p.push(this.formatterOptions.rowDelimiter),d(null,p)}checkHeaders(d){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const p=h.gatherHeaders(d);return this.headers=p,this.fieldFormatter.headers=p,this.shouldWriteHeaders?{shouldFormatColumns:!r.default(p,d),headers:p}:{shouldFormatColumns:!0,headers:null}}gatherColumns(d){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(d)?h.isRowHashArray(d)?this.headers.map((p,b)=>{const v=d[b];return v?v[1]:""}):h.isRowArray(d)&&!this.shouldWriteHeaders?d:this.headers.map((p,b)=>d[b]):this.headers.map(p=>d[p])}callTransformer(d,p){return this._rowTransform?this._rowTransform(d,p):p(null,d)}formatColumns(d,p){const b=d.map((x,w)=>this.fieldFormatter.format(x,w,p)).join(this.formatterOptions.delimiter),{rowCount:v}=this;return this.rowCount+=1,v?[this.formatterOptions.rowDelimiter,b].join(""):b}}s.RowFormatter=h},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.FieldFormatter=s.RowFormatter=void 0;var a=e("./RowFormatter");Object.defineProperty(s,"RowFormatter",{enumerable:!0,get:function(){return a.RowFormatter}});var o=e("./FieldFormatter");Object.defineProperty(s,"FieldFormatter",{enumerable:!0,get:function(){return o.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,i,s){(function(a){(function(){var o=Object.create?function(w,M,E,D){D===void 0&&(D=E),Object.defineProperty(w,D,{enumerable:!0,get:function(){return M[E]}})}:function(w,M,E,D){D===void 0&&(D=E),w[D]=M[E]},r=Object.create?function(w,M){Object.defineProperty(w,"default",{enumerable:!0,value:M})}:function(w,M){w.default=M},u=function(w){if(w&&w.__esModule)return w;var M={};if(w!=null)for(var E in w)E!=="default"&&Object.prototype.hasOwnProperty.call(w,E)&&o(M,w,E);return r(M,w),M},l=function(w,M){for(var E in w)E==="default"||Object.prototype.hasOwnProperty.call(M,E)||o(M,w,E)};Object.defineProperty(s,"__esModule",{value:!0}),s.writeToPath=s.writeToString=s.writeToBuffer=s.writeToStream=s.write=s.format=s.FormatterOptions=s.CsvFormatterStream=void 0;const h=e("util"),f=e("stream"),d=u(e("fs")),p=e("./FormatterOptions"),b=e("./CsvFormatterStream");l(e("./types"),s);var v=e("./CsvFormatterStream");Object.defineProperty(s,"CsvFormatterStream",{enumerable:!0,get:function(){return v.CsvFormatterStream}});var x=e("./FormatterOptions");Object.defineProperty(s,"FormatterOptions",{enumerable:!0,get:function(){return x.FormatterOptions}}),s.format=w=>new b.CsvFormatterStream(new p.FormatterOptions(w)),s.write=(w,M)=>{const E=s.format(M),D=h.promisify((N,V)=>{E.write(N,void 0,V)});return w.reduce((N,V)=>N.then(()=>D(V)),Promise.resolve()).then(()=>E.end()).catch(N=>{E.emit("error",N)}),E},s.writeToStream=(w,M,E)=>s.write(M,E).pipe(w),s.writeToBuffer=function(w){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const E=[],D=new f.Writable({write(N,V,K){E.push(N),K()}});return new Promise((N,V)=>{D.on("error",V).on("finish",()=>N(a.concat(E))),s.write(w,M).pipe(D)})},s.writeToString=(w,M)=>s.writeToBuffer(w,M).then(E=>E.toString()),s.writeToPath=(w,M,E)=>{const D=d.createWriteStream(w,{encoding:"utf8"});return s.write(M,E).pipe(D)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSyncTransform=void 0,s.isSyncTransform=a=>a.length===1},{}],153:[function(e,i,s){(function(a){(function(){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvParserStream=void 0;const o=e("string_decoder"),r=e("stream"),u=e("./transforms"),l=e("./parser");class h extends r.Transform{constructor(d){super({objectMode:d.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=d,this.parser=new l.Parser(d),this.headerTransformer=new u.HeaderTransformer(d),this.decoder=new o.StringDecoder(d.encoding),this.rowTransformerValidator=new u.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(d){return this.rowTransformerValidator.rowTransform=d,this}validate(d){return this.rowTransformerValidator.rowValidator=d,this}emit(d){if(d==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var p=arguments.length,b=new Array(p>1?p-1:0),v=1;v<p;v++)b[v-1]=arguments[v];return super.emit(d,...b)}_transform(d,p,b){if(this.hasHitRowLimit)return b();const v=h.wrapDoneCallback(b);try{const{lines:x}=this,w=x+this.decoder.write(d),M=this.parse(w,!0);return this.processRows(M,v)}catch(x){return v(x)}}_flush(d){const p=h.wrapDoneCallback(d);if(this.hasHitRowLimit)return p();try{const b=this.lines+this.decoder.end(),v=this.parse(b,!1);return this.processRows(v,p)}catch(b){return p(b)}}parse(d,p){if(!d)return[];const{line:b,rows:v}=this.parser.parse(d,p);return this.lines=b,v}processRows(d,p){const b=d.length,v=x=>{const w=D=>D?p(D):x%100!=0?v(x+1):void a(()=>v(x+1));if(this.checkAndEmitHeaders(),x>=b||this.hasHitRowLimit)return p();if(this.parsedLineCount+=1,this.shouldSkipLine)return w();const M=d[x];this.rowCount+=1,this.parsedRowCount+=1;const E=this.rowCount;return this.transformRow(M,(D,N)=>{if(D)return this.rowCount-=1,w(D);if(!N)return w(new Error("expected transform result"));if(N.isValid){if(N.row)return this.pushRow(N.row,w)}else this.emit("data-invalid",N.row,E,N.reason);return w()})};v(0)}transformRow(d,p){try{this.headerTransformer.transform(d,(b,v)=>b?p(b):v?v.isValid?v.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(v.row,p):this.skipRow(p):(this.rowCount-=1,this.parsedRowCount-=1,p(null,{row:null,isValid:!0})):this.shouldEmitRows?p(null,{isValid:!1,row:d}):this.skipRow(p):p(new Error("Expected result from header transform")))}catch(b){p(b)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(d){return this.rowCount-=1,d(null,{row:null,isValid:!0})}pushRow(d,p){try{this.parserOptions.objectMode?this.push(d):this.push(JSON.stringify(d)),p()}catch(b){p(b)}}static wrapDoneCallback(d){let p=!1;return function(b){if(b){if(p)throw b;return p=!0,void d(b)}for(var v=arguments.length,x=new Array(v>1?v-1:0),w=1;w<v;w++)x[w-1]=arguments[w];d(...x)}}}s.CsvParserStream=h}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,i,s){var a=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(s,"__esModule",{value:!0}),s.ParserOptions=void 0;const o=a(e("lodash.escaperegexp")),r=a(e("lodash.isnil"));s.ParserOptions=class{constructor(u){var l;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,u||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=o.default(this.delimiter),this.escapeChar=(l=this.escape)!==null&&l!==void 0?l:this.quote,this.supportsComments=!r.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,i,s){var a=Object.create?function(v,x,w,M){M===void 0&&(M=w),Object.defineProperty(v,M,{enumerable:!0,get:function(){return x[w]}})}:function(v,x,w,M){M===void 0&&(M=w),v[M]=x[w]},o=Object.create?function(v,x){Object.defineProperty(v,"default",{enumerable:!0,value:x})}:function(v,x){v.default=x},r=function(v){if(v&&v.__esModule)return v;var x={};if(v!=null)for(var w in v)w!=="default"&&Object.prototype.hasOwnProperty.call(v,w)&&a(x,v,w);return o(x,v),x},u=function(v,x){for(var w in v)w==="default"||Object.prototype.hasOwnProperty.call(x,w)||a(x,v,w)};Object.defineProperty(s,"__esModule",{value:!0}),s.parseString=s.parseFile=s.parseStream=s.parse=s.ParserOptions=s.CsvParserStream=void 0;const l=r(e("fs")),h=e("stream"),f=e("./ParserOptions"),d=e("./CsvParserStream");u(e("./types"),s);var p=e("./CsvParserStream");Object.defineProperty(s,"CsvParserStream",{enumerable:!0,get:function(){return p.CsvParserStream}});var b=e("./ParserOptions");Object.defineProperty(s,"ParserOptions",{enumerable:!0,get:function(){return b.ParserOptions}}),s.parse=v=>new d.CsvParserStream(new f.ParserOptions(v)),s.parseStream=(v,x)=>v.pipe(new d.CsvParserStream(new f.ParserOptions(x))),s.parseFile=function(v){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return l.createReadStream(v).pipe(new d.CsvParserStream(new f.ParserOptions(x)))},s.parseString=(v,x)=>{const w=new h.Readable;return w.push(v),w.push(null),w.pipe(new d.CsvParserStream(new f.ParserOptions(x)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Parser=void 0;const a=e("./Scanner"),o=e("./RowParser"),r=e("./Token");class u{constructor(h){this.parserOptions=h,this.rowParser=new o.RowParser(this.parserOptions)}static removeBOM(h){return h&&h.charCodeAt(0)===65279?h.slice(1):h}parse(h,f){const d=new a.Scanner({line:u.removeBOM(h),parserOptions:this.parserOptions,hasMoreData:f});return this.parserOptions.supportsComments?this.parseWithComments(d):this.parseWithoutComments(d)}parseWithoutComments(h){const f=[];let d=!0;for(;d;)d=this.parseRow(h,f);return{line:h.line,rows:f}}parseWithComments(h){const{parserOptions:f}=this,d=[];for(let p=h.nextCharacterToken;p!==null;p=h.nextCharacterToken)if(r.Token.isTokenComment(p,f)){if(h.advancePastLine()===null)return{line:h.lineFromCursor,rows:d};if(!h.hasMoreCharacters)return{line:h.lineFromCursor,rows:d};h.truncateToCursor()}else if(!this.parseRow(h,d))break;return{line:h.line,rows:d}}parseRow(h,f){if(!h.nextNonSpaceToken)return!1;const d=this.rowParser.parse(h);return d!==null&&(this.parserOptions.ignoreEmpty&&o.RowParser.isEmptyRow(d)||f.push(d),!0)}}s.Parser=u},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.RowParser=void 0;const a=e("./column"),o=e("./Token");s.RowParser=class{constructor(r){this.parserOptions=r,this.columnParser=new a.ColumnParser(r)}static isEmptyRow(r){return r.join("").replace(/\s+/g,"")===""}parse(r){const{parserOptions:u}=this,{hasMoreData:l}=r,h=r,f=[];let d=this.getStartToken(h,f);for(;d;){if(o.Token.isTokenRowDelimiter(d))return h.advancePastToken(d),!h.hasMoreCharacters&&o.Token.isTokenCarriageReturn(d,u)&&l?null:(h.truncateToCursor(),f);if(!this.shouldSkipColumnParse(h,d,f)){const p=this.columnParser.parse(h);if(p===null)return null;f.push(p)}d=h.nextNonSpaceToken}return l?null:(h.truncateToCursor(),f)}getStartToken(r,u){const l=r.nextNonSpaceToken;return l!==null&&o.Token.isTokenDelimiter(l,this.parserOptions)?(u.push(""),r.nextNonSpaceToken):l}shouldSkipColumnParse(r,u,l){const{parserOptions:h}=this;if(o.Token.isTokenDelimiter(u,h)){r.advancePastToken(u);const f=r.nextCharacterToken;if(!r.hasMoreCharacters||f!==null&&o.Token.isTokenRowDelimiter(f)||f!==null&&o.Token.isTokenDelimiter(f,h))return l.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Scanner=void 0;const a=e("./Token"),o=/((?:\r\n)|\n|\r)/;s.Scanner=class{constructor(r){this.cursor=0,this.line=r.line,this.lineLength=this.line.length,this.parserOptions=r.parserOptions,this.hasMoreData=r.hasMoreData,this.cursor=r.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:r}=this,u=this.parserOptions.NEXT_TOKEN_REGEXP;if(r.search(u)===-1)return null;const l=u.exec(r);if(l==null)return null;const h=l[1],f=this.cursor+(l.index||0);return new a.Token({token:h,startCursor:f,endCursor:f+h.length-1})}get nextCharacterToken(){const{cursor:r,lineLength:u}=this;return u<=r?null:new a.Token({token:this.line[r],startCursor:r,endCursor:r})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const r=o.exec(this.lineFromCursor);return r?(this.cursor+=(r.index||0)+r[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(r){return this.cursor=r,this}advanceToToken(r){return this.cursor=r.startCursor,this}advancePastToken(r){return this.cursor=r.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.Token=void 0,s.Token=class{constructor(a){this.token=a.token,this.startCursor=a.startCursor,this.endCursor=a.endCursor}static isTokenRowDelimiter(a){const o=a.token;return o==="\r"||o===`
`||o===`\r
`}static isTokenCarriageReturn(a,o){return a.token===o.carriageReturn}static isTokenComment(a,o){return o.supportsComments&&!!a&&a.token===o.comment}static isTokenEscapeCharacter(a,o){return a.token===o.escapeChar}static isTokenQuote(a,o){return a.token===o.quote}static isTokenDelimiter(a,o){return a.token===o.delimiter}}},{}],160:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnFormatter=void 0,s.ColumnFormatter=class{constructor(a){a.trim?this.format=o=>o.trim():a.ltrim?this.format=o=>o.trimLeft():a.rtrim?this.format=o=>o.trimRight():this.format=o=>o}}},{}],161:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnParser=void 0;const a=e("./NonQuotedColumnParser"),o=e("./QuotedColumnParser"),r=e("../Token");s.ColumnParser=class{constructor(u){this.parserOptions=u,this.quotedColumnParser=new o.QuotedColumnParser(u),this.nonQuotedColumnParser=new a.NonQuotedColumnParser(u)}parse(u){const{nextNonSpaceToken:l}=u;return l!==null&&r.Token.isTokenQuote(l,this.parserOptions)?(u.advanceToToken(l),this.quotedColumnParser.parse(u)):this.nonQuotedColumnParser.parse(u)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.NonQuotedColumnParser=void 0;const a=e("./ColumnFormatter"),o=e("../Token");s.NonQuotedColumnParser=class{constructor(r){this.parserOptions=r,this.columnFormatter=new a.ColumnFormatter(r)}parse(r){if(!r.hasMoreCharacters)return null;const{parserOptions:u}=this,l=[];let h=r.nextCharacterToken;for(;h&&!o.Token.isTokenDelimiter(h,u)&&!o.Token.isTokenRowDelimiter(h);h=r.nextCharacterToken)l.push(h.token),r.advancePastToken(h);return this.columnFormatter.format(l.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.QuotedColumnParser=void 0;const a=e("./ColumnFormatter"),o=e("../Token");s.QuotedColumnParser=class{constructor(r){this.parserOptions=r,this.columnFormatter=new a.ColumnFormatter(r)}parse(r){if(!r.hasMoreCharacters)return null;const u=r.cursor,{foundClosingQuote:l,col:h}=this.gatherDataBetweenQuotes(r);if(!l){if(r.advanceTo(u),!r.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${r.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(r),h}gatherDataBetweenQuotes(r){const{parserOptions:u}=this;let l=!1,h=!1;const f=[];let d=r.nextCharacterToken;for(;!h&&d!==null;d=r.nextCharacterToken){const p=o.Token.isTokenQuote(d,u);if(!l&&p)l=!0;else if(l)if(o.Token.isTokenEscapeCharacter(d,u)){r.advancePastToken(d);const b=r.nextCharacterToken;b!==null&&(o.Token.isTokenQuote(b,u)||o.Token.isTokenEscapeCharacter(b,u))?(f.push(b.token),d=b):p?h=!0:f.push(d.token)}else p?h=!0:f.push(d.token);r.advancePastToken(d)}return{col:this.columnFormatter.format(f.join("")),foundClosingQuote:h}}checkForMalformedColumn(r){const{parserOptions:u}=this,{nextNonSpaceToken:l}=r;if(l){const h=o.Token.isTokenDelimiter(l,u),f=o.Token.isTokenRowDelimiter(l);if(!h&&!f){const d=r.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${u.escapedDelimiter}' OR new line got: '${l.token}'. at '${d}`)}r.advanceToToken(l)}else r.hasMoreData||r.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.ColumnFormatter=s.QuotedColumnParser=s.NonQuotedColumnParser=s.ColumnParser=void 0;var a=e("./ColumnParser");Object.defineProperty(s,"ColumnParser",{enumerable:!0,get:function(){return a.ColumnParser}});var o=e("./NonQuotedColumnParser");Object.defineProperty(s,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}});var r=e("./QuotedColumnParser");Object.defineProperty(s,"QuotedColumnParser",{enumerable:!0,get:function(){return r.QuotedColumnParser}});var u=e("./ColumnFormatter");Object.defineProperty(s,"ColumnFormatter",{enumerable:!0,get:function(){return u.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.QuotedColumnParser=s.NonQuotedColumnParser=s.ColumnParser=s.Token=s.Scanner=s.RowParser=s.Parser=void 0;var a=e("./Parser");Object.defineProperty(s,"Parser",{enumerable:!0,get:function(){return a.Parser}});var o=e("./RowParser");Object.defineProperty(s,"RowParser",{enumerable:!0,get:function(){return o.RowParser}});var r=e("./Scanner");Object.defineProperty(s,"Scanner",{enumerable:!0,get:function(){return r.Scanner}});var u=e("./Token");Object.defineProperty(s,"Token",{enumerable:!0,get:function(){return u.Token}});var l=e("./column");Object.defineProperty(s,"ColumnParser",{enumerable:!0,get:function(){return l.ColumnParser}}),Object.defineProperty(s,"NonQuotedColumnParser",{enumerable:!0,get:function(){return l.NonQuotedColumnParser}}),Object.defineProperty(s,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,i,s){var a=function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(s,"__esModule",{value:!0}),s.HeaderTransformer=void 0;const o=a(e("lodash.isundefined")),r=a(e("lodash.isfunction")),u=a(e("lodash.uniq")),l=a(e("lodash.groupby"));s.HeaderTransformer=class{constructor(h){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=h,h.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(h.headers)?this.setHeaders(h.headers):r.default(h.headers)&&(this.headersTransform=h.headers)}transform(h,f){return this.shouldMapRow(h)?f(null,this.processRow(h)):f(null,{row:null,isValid:!0})}shouldMapRow(h){const{parserOptions:f}=this;if(!this.headersTransform&&f.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(h)){if(this.headersTransform)this.setHeaders(this.headersTransform(h));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(h)}return!1}return!0}processRow(h){if(!this.headers)return{row:h,isValid:!0};const{parserOptions:f}=this;if(!f.discardUnmappedColumns&&h.length>this.headersLength){if(!f.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${h.length}`);return{row:h,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${h.length}`}}return f.strictColumnHandling&&h.length<this.headersLength?{row:h,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${h.length}`}:{row:this.mapHeaders(h),isValid:!0}}mapHeaders(h){const f={},{headers:d,headersLength:p}=this;for(let b=0;b<p;b+=1){const v=d[b];if(!o.default(v)){const x=h[b];o.default(x)?f[v]="":f[v]=x}}return f}setHeaders(h){var f;const d=h.filter(p=>!!p);if(u.default(d).length!==d.length){const p=l.default(d),b=Object.keys(p).filter(v=>p[v].length>1);throw new Error("Duplicate headers found "+JSON.stringify(b))}this.headers=h,this.receivedHeaders=!0,this.headersLength=((f=this.headers)===null||f===void 0?void 0:f.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,i,s){var a=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0}),s.RowTransformerValidator=void 0;const o=a(e("lodash.isfunction")),r=e("../types");class u{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(h){return r.isSyncTransform(h)?(f,d)=>{let p=null;try{p=h(f)}catch(b){return d(b)}return d(null,p)}:h}static createValidator(h){return r.isSyncValidate(h)?(f,d)=>{d(null,{row:f,isValid:h(f)})}:(f,d)=>{h(f,(p,b,v)=>p?d(p):d(null,b?{row:f,isValid:b,reason:v}:{row:f,isValid:!1,reason:v}))}}set rowTransform(h){if(!o.default(h))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(h)}set rowValidator(h){if(!o.default(h))throw new TypeError("The validate should be a function");this._rowValidator=u.createValidator(h)}transformAndValidate(h,f){return this.callTransformer(h,(d,p)=>d?f(d):p?this.callValidator(p,(b,v)=>b?f(b):v&&!v.isValid?f(null,{row:p,isValid:!1,reason:v.reason}):f(null,{row:p,isValid:!0})):f(null,{row:null,isValid:!0}))}callTransformer(h,f){return this._rowTransform?this._rowTransform(h,f):f(null,h)}callValidator(h,f){return this._rowValidator?this._rowValidator(h,f):f(null,{row:h,isValid:!0})}}s.RowTransformerValidator=u},{"../types":169,"lodash.isfunction":446}],168:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.HeaderTransformer=s.RowTransformerValidator=void 0;var a=e("./RowTransformerValidator");Object.defineProperty(s,"RowTransformerValidator",{enumerable:!0,get:function(){return a.RowTransformerValidator}});var o=e("./HeaderTransformer");Object.defineProperty(s,"HeaderTransformer",{enumerable:!0,get:function(){return o.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.isSyncValidate=s.isSyncTransform=void 0,s.isSyncTransform=a=>a.length===1,s.isSyncValidate=a=>a.length===1},{}],170:[function(e,i,s){const a=s;a.bignum=e("bn.js"),a.define=e("./asn1/api").define,a.base=e("./asn1/base"),a.constants=e("./asn1/constants"),a.decoders=e("./asn1/decoders"),a.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,i,s){const a=e("./encoders"),o=e("./decoders"),r=e("inherits");function u(l,h){this.name=l,this.body=h,this.decoders={},this.encoders={}}s.define=function(l,h){return new u(l,h)},u.prototype._createNamed=function(l){const h=this.name;function f(d){this._initNamed(d,h)}return r(f,l),f.prototype._initNamed=function(d,p){l.call(this,d,p)},new f(this)},u.prototype._getDecoder=function(l){return l=l||"der",this.decoders.hasOwnProperty(l)||(this.decoders[l]=this._createNamed(o[l])),this.decoders[l]},u.prototype.decode=function(l,h,f){return this._getDecoder(h).decode(l,f)},u.prototype._getEncoder=function(l){return l=l||"der",this.encoders.hasOwnProperty(l)||(this.encoders[l]=this._createNamed(a[l])),this.encoders[l]},u.prototype.encode=function(l,h,f){return this._getEncoder(h).encode(l,f)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,i,s){const a=e("inherits"),o=e("../base/reporter").Reporter,r=e("safer-buffer").Buffer;function u(h,f){o.call(this,f),r.isBuffer(h)?(this.base=h,this.offset=0,this.length=h.length):this.error("Input not Buffer")}function l(h,f){if(Array.isArray(h))this.length=0,this.value=h.map(function(d){return l.isEncoderBuffer(d)||(d=new l(d,f)),this.length+=d.length,d},this);else if(typeof h=="number"){if(!(0<=h&&h<=255))return f.error("non-byte EncoderBuffer value");this.value=h,this.length=1}else if(typeof h=="string")this.value=h,this.length=r.byteLength(h);else{if(!r.isBuffer(h))return f.error("Unsupported type: "+typeof h);this.value=h,this.length=h.length}}a(u,o),s.DecoderBuffer=u,u.isDecoderBuffer=function(h){return h instanceof u?!0:typeof h=="object"&&r.isBuffer(h.base)&&h.constructor.name==="DecoderBuffer"&&typeof h.offset=="number"&&typeof h.length=="number"&&typeof h.save=="function"&&typeof h.restore=="function"&&typeof h.isEmpty=="function"&&typeof h.readUInt8=="function"&&typeof h.skip=="function"&&typeof h.raw=="function"},u.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},u.prototype.restore=function(h){const f=new u(this.base);return f.offset=h.offset,f.length=this.offset,this.offset=h.offset,o.prototype.restore.call(this,h.reporter),f},u.prototype.isEmpty=function(){return this.offset===this.length},u.prototype.readUInt8=function(h){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(h||"DecoderBuffer overrun")},u.prototype.skip=function(h,f){if(!(this.offset+h<=this.length))return this.error(f||"DecoderBuffer overrun");const d=new u(this.base);return d._reporterState=this._reporterState,d.offset=this.offset,d.length=this.offset+h,this.offset+=h,d},u.prototype.raw=function(h){return this.base.slice(h?h.offset:this.offset,this.length)},s.EncoderBuffer=l,l.isEncoderBuffer=function(h){return h instanceof l?!0:typeof h=="object"&&h.constructor.name==="EncoderBuffer"&&typeof h.length=="number"&&typeof h.join=="function"},l.prototype.join=function(h,f){return h||(h=r.alloc(this.length)),f||(f=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(d){d.join(h,f),f+=d.length}):(typeof this.value=="number"?h[f]=this.value:typeof this.value=="string"?h.write(this.value,f):r.isBuffer(this.value)&&this.value.copy(h,f),f+=this.length)),h}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,i,s){const a=s;a.Reporter=e("./reporter").Reporter,a.DecoderBuffer=e("./buffer").DecoderBuffer,a.EncoderBuffer=e("./buffer").EncoderBuffer,a.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,i,s){const a=e("../base/reporter").Reporter,o=e("../base/buffer").EncoderBuffer,r=e("../base/buffer").DecoderBuffer,u=e("minimalistic-assert"),l=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],h=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(l);function f(p,b,v){const x={};this._baseState=x,x.name=v,x.enc=p,x.parent=b||null,x.children=null,x.tag=null,x.args=null,x.reverseArgs=null,x.choice=null,x.optional=!1,x.any=!1,x.obj=!1,x.use=null,x.useDecoder=null,x.key=null,x.default=null,x.explicit=null,x.implicit=null,x.contains=null,x.parent||(x.children=[],this._wrap())}i.exports=f;const d=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];f.prototype.clone=function(){const p=this._baseState,b={};d.forEach(function(x){b[x]=p[x]});const v=new this.constructor(b.parent);return v._baseState=b,v},f.prototype._wrap=function(){const p=this._baseState;h.forEach(function(b){this[b]=function(){const v=new this.constructor(this);return p.children.push(v),v[b].apply(v,arguments)}},this)},f.prototype._init=function(p){const b=this._baseState;u(b.parent===null),p.call(this),b.children=b.children.filter(function(v){return v._baseState.parent===this},this),u.equal(b.children.length,1,"Root node can have only one child")},f.prototype._useArgs=function(p){const b=this._baseState,v=p.filter(function(x){return x instanceof this.constructor},this);p=p.filter(function(x){return!(x instanceof this.constructor)},this),v.length!==0&&(u(b.children===null),b.children=v,v.forEach(function(x){x._baseState.parent=this},this)),p.length!==0&&(u(b.args===null),b.args=p,b.reverseArgs=p.map(function(x){if(typeof x!="object"||x.constructor!==Object)return x;const w={};return Object.keys(x).forEach(function(M){M==(0|M)&&(M|=0);const E=x[M];w[E]=M}),w}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(p){f.prototype[p]=function(){const b=this._baseState;throw new Error(p+" not implemented for encoding: "+b.enc)}}),l.forEach(function(p){f.prototype[p]=function(){const b=this._baseState,v=Array.prototype.slice.call(arguments);return u(b.tag===null),b.tag=p,this._useArgs(v),this}}),f.prototype.use=function(p){u(p);const b=this._baseState;return u(b.use===null),b.use=p,this},f.prototype.optional=function(){return this._baseState.optional=!0,this},f.prototype.def=function(p){const b=this._baseState;return u(b.default===null),b.default=p,b.optional=!0,this},f.prototype.explicit=function(p){const b=this._baseState;return u(b.explicit===null&&b.implicit===null),b.explicit=p,this},f.prototype.implicit=function(p){const b=this._baseState;return u(b.explicit===null&&b.implicit===null),b.implicit=p,this},f.prototype.obj=function(){const p=this._baseState,b=Array.prototype.slice.call(arguments);return p.obj=!0,b.length!==0&&this._useArgs(b),this},f.prototype.key=function(p){const b=this._baseState;return u(b.key===null),b.key=p,this},f.prototype.any=function(){return this._baseState.any=!0,this},f.prototype.choice=function(p){const b=this._baseState;return u(b.choice===null),b.choice=p,this._useArgs(Object.keys(p).map(function(v){return p[v]})),this},f.prototype.contains=function(p){const b=this._baseState;return u(b.use===null),b.contains=p,this},f.prototype._decode=function(p,b){const v=this._baseState;if(v.parent===null)return p.wrapResult(v.children[0]._decode(p,b));let x,w=v.default,M=!0,E=null;if(v.key!==null&&(E=p.enterKey(v.key)),v.optional){let D=null;if(v.explicit!==null?D=v.explicit:v.implicit!==null?D=v.implicit:v.tag!==null&&(D=v.tag),D!==null||v.any){if(M=this._peekTag(p,D,v.any),p.isError(M))return M}else{const N=p.save();try{v.choice===null?this._decodeGeneric(v.tag,p,b):this._decodeChoice(p,b),M=!0}catch(V){M=!1}p.restore(N)}}if(v.obj&&M&&(x=p.enterObject()),M){if(v.explicit!==null){const N=this._decodeTag(p,v.explicit);if(p.isError(N))return N;p=N}const D=p.offset;if(v.use===null&&v.choice===null){let N;v.any&&(N=p.save());const V=this._decodeTag(p,v.implicit!==null?v.implicit:v.tag,v.any);if(p.isError(V))return V;v.any?w=p.raw(N):p=V}if(b&&b.track&&v.tag!==null&&b.track(p.path(),D,p.length,"tagged"),b&&b.track&&v.tag!==null&&b.track(p.path(),p.offset,p.length,"content"),v.any||(w=v.choice===null?this._decodeGeneric(v.tag,p,b):this._decodeChoice(p,b)),p.isError(w))return w;if(v.any||v.choice!==null||v.children===null||v.children.forEach(function(N){N._decode(p,b)}),v.contains&&(v.tag==="octstr"||v.tag==="bitstr")){const N=new r(w);w=this._getUse(v.contains,p._reporterState.obj)._decode(N,b)}}return v.obj&&M&&(w=p.leaveObject(x)),v.key===null||w===null&&M!==!0?E!==null&&p.exitKey(E):p.leaveKey(E,v.key,w),w},f.prototype._decodeGeneric=function(p,b,v){const x=this._baseState;return p==="seq"||p==="set"?null:p==="seqof"||p==="setof"?this._decodeList(b,p,x.args[0],v):/str$/.test(p)?this._decodeStr(b,p,v):p==="objid"&&x.args?this._decodeObjid(b,x.args[0],x.args[1],v):p==="objid"?this._decodeObjid(b,null,null,v):p==="gentime"||p==="utctime"?this._decodeTime(b,p,v):p==="null_"?this._decodeNull(b,v):p==="bool"?this._decodeBool(b,v):p==="objDesc"?this._decodeStr(b,p,v):p==="int"||p==="enum"?this._decodeInt(b,x.args&&x.args[0],v):x.use!==null?this._getUse(x.use,b._reporterState.obj)._decode(b,v):b.error("unknown tag: "+p)},f.prototype._getUse=function(p,b){const v=this._baseState;return v.useDecoder=this._use(p,b),u(v.useDecoder._baseState.parent===null),v.useDecoder=v.useDecoder._baseState.children[0],v.implicit!==v.useDecoder._baseState.implicit&&(v.useDecoder=v.useDecoder.clone(),v.useDecoder._baseState.implicit=v.implicit),v.useDecoder},f.prototype._decodeChoice=function(p,b){const v=this._baseState;let x=null,w=!1;return Object.keys(v.choice).some(function(M){const E=p.save(),D=v.choice[M];try{const N=D._decode(p,b);if(p.isError(N))return!1;x={type:M,value:N},w=!0}catch(N){return p.restore(E),!1}return!0},this),w?x:p.error("Choice not matched")},f.prototype._createEncoderBuffer=function(p){return new o(p,this.reporter)},f.prototype._encode=function(p,b,v){const x=this._baseState;if(x.default!==null&&x.default===p)return;const w=this._encodeValue(p,b,v);return w===void 0||this._skipDefault(w,b,v)?void 0:w},f.prototype._encodeValue=function(p,b,v){const x=this._baseState;if(x.parent===null)return x.children[0]._encode(p,b||new a);let w=null;if(this.reporter=b,x.optional&&p===void 0){if(x.default===null)return;p=x.default}let M=null,E=!1;if(x.any)w=this._createEncoderBuffer(p);else if(x.choice)w=this._encodeChoice(p,b);else if(x.contains)M=this._getUse(x.contains,v)._encode(p,b),E=!0;else if(x.children)M=x.children.map(function(D){if(D._baseState.tag==="null_")return D._encode(null,b,p);if(D._baseState.key===null)return b.error("Child should have a key");const N=b.enterKey(D._baseState.key);if(typeof p!="object")return b.error("Child expected, but input is not object");const V=D._encode(p[D._baseState.key],b,p);return b.leaveKey(N),V},this).filter(function(D){return D}),M=this._createEncoderBuffer(M);else if(x.tag==="seqof"||x.tag==="setof"){if(!x.args||x.args.length!==1)return b.error("Too many args for : "+x.tag);if(!Array.isArray(p))return b.error("seqof/setof, but data is not Array");const D=this.clone();D._baseState.implicit=null,M=this._createEncoderBuffer(p.map(function(N){const V=this._baseState;return this._getUse(V.args[0],p)._encode(N,b)},D))}else x.use!==null?w=this._getUse(x.use,v)._encode(p,b):(M=this._encodePrimitive(x.tag,p),E=!0);if(!x.any&&x.choice===null){const D=x.implicit!==null?x.implicit:x.tag,N=x.implicit===null?"universal":"context";D===null?x.use===null&&b.error("Tag could be omitted only for .use()"):x.use===null&&(w=this._encodeComposite(D,E,N,M))}return x.explicit!==null&&(w=this._encodeComposite(x.explicit,!1,"context",w)),w},f.prototype._encodeChoice=function(p,b){const v=this._baseState,x=v.choice[p.type];return x||u(!1,p.type+" not found in "+JSON.stringify(Object.keys(v.choice))),x._encode(p.value,b)},f.prototype._encodePrimitive=function(p,b){const v=this._baseState;if(/str$/.test(p))return this._encodeStr(b,p);if(p==="objid"&&v.args)return this._encodeObjid(b,v.reverseArgs[0],v.args[1]);if(p==="objid")return this._encodeObjid(b,null,null);if(p==="gentime"||p==="utctime")return this._encodeTime(b,p);if(p==="null_")return this._encodeNull();if(p==="int"||p==="enum")return this._encodeInt(b,v.args&&v.reverseArgs[0]);if(p==="bool")return this._encodeBool(b);if(p==="objDesc")return this._encodeStr(b,p);throw new Error("Unsupported tag: "+p)},f.prototype._isNumstr=function(p){return/^[0-9 ]*$/.test(p)},f.prototype._isPrintstr=function(p){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(p)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,i,s){const a=e("inherits");function o(u){this._reporterState={obj:null,path:[],options:u||{},errors:[]}}function r(u,l){this.path=u,this.rethrow(l)}s.Reporter=o,o.prototype.isError=function(u){return u instanceof r},o.prototype.save=function(){const u=this._reporterState;return{obj:u.obj,pathLen:u.path.length}},o.prototype.restore=function(u){const l=this._reporterState;l.obj=u.obj,l.path=l.path.slice(0,u.pathLen)},o.prototype.enterKey=function(u){return this._reporterState.path.push(u)},o.prototype.exitKey=function(u){const l=this._reporterState;l.path=l.path.slice(0,u-1)},o.prototype.leaveKey=function(u,l,h){const f=this._reporterState;this.exitKey(u),f.obj!==null&&(f.obj[l]=h)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const u=this._reporterState,l=u.obj;return u.obj={},l},o.prototype.leaveObject=function(u){const l=this._reporterState,h=l.obj;return l.obj=u,h},o.prototype.error=function(u){let l;const h=this._reporterState,f=u instanceof r;if(l=f?u:new r(h.path.map(function(d){return"["+JSON.stringify(d)+"]"}).join(""),u.message||u,u.stack),!h.options.partial)throw l;return f||h.errors.push(l),l},o.prototype.wrapResult=function(u){const l=this._reporterState;return l.options.partial?{result:this.isError(u)?null:u,errors:l.errors}:u},a(r,Error),r.prototype.rethrow=function(u){if(this.message=u+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,r),!this.stack)try{throw new Error(this.message)}catch(l){this.stack=l.stack}return this}},{inherits:440}],176:[function(e,i,s){function a(o){const r={};return Object.keys(o).forEach(function(u){(0|u)==u&&(u|=0);const l=o[u];r[l]=u}),r}s.tagClass={0:"universal",1:"application",2:"context",3:"private"},s.tagClassByName=a(s.tagClass),s.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},s.tagByName=a(s.tag)},{}],177:[function(e,i,s){const a=s;a._reverse=function(o){const r={};return Object.keys(o).forEach(function(u){(0|u)==u&&(u|=0);const l=o[u];r[l]=u}),r},a.der=e("./der")},{"./der":176}],178:[function(e,i,s){const a=e("inherits"),o=e("bn.js"),r=e("../base/buffer").DecoderBuffer,u=e("../base/node"),l=e("../constants/der");function h(b){this.enc="der",this.name=b.name,this.entity=b,this.tree=new f,this.tree._init(b.body)}function f(b){u.call(this,"der",b)}function d(b,v){let x=b.readUInt8(v);if(b.isError(x))return x;const w=l.tagClass[x>>6],M=(32&x)==0;if((31&x)==31){let E=x;for(x=0;(128&E)==128;){if(E=b.readUInt8(v),b.isError(E))return E;x<<=7,x|=127&E}}else x&=31;return{cls:w,primitive:M,tag:x,tagStr:l.tag[x]}}function p(b,v,x){let w=b.readUInt8(x);if(b.isError(w))return w;if(!v&&w===128)return null;if(!(128&w))return w;const M=127&w;if(M>4)return b.error("length octect is too long");w=0;for(let E=0;E<M;E++){w<<=8;const D=b.readUInt8(x);if(b.isError(D))return D;w|=D}return w}i.exports=h,h.prototype.decode=function(b,v){return r.isDecoderBuffer(b)||(b=new r(b,v)),this.tree._decode(b,v)},a(f,u),f.prototype._peekTag=function(b,v,x){if(b.isEmpty())return!1;const w=b.save(),M=d(b,'Failed to peek tag: "'+v+'"');return b.isError(M)?M:(b.restore(w),M.tag===v||M.tagStr===v||M.tagStr+"of"===v||x)},f.prototype._decodeTag=function(b,v,x){const w=d(b,'Failed to decode tag of "'+v+'"');if(b.isError(w))return w;let M=p(b,w.primitive,'Failed to get length of "'+v+'"');if(b.isError(M))return M;if(!x&&w.tag!==v&&w.tagStr!==v&&w.tagStr+"of"!==v)return b.error('Failed to match tag: "'+v+'"');if(w.primitive||M!==null)return b.skip(M,'Failed to match body of: "'+v+'"');const E=b.save(),D=this._skipUntilEnd(b,'Failed to skip indefinite length body: "'+this.tag+'"');return b.isError(D)?D:(M=b.offset-E.offset,b.restore(E),b.skip(M,'Failed to match body of: "'+v+'"'))},f.prototype._skipUntilEnd=function(b,v){for(;;){const x=d(b,v);if(b.isError(x))return x;const w=p(b,x.primitive,v);if(b.isError(w))return w;let M;if(M=x.primitive||w!==null?b.skip(w):this._skipUntilEnd(b,v),b.isError(M))return M;if(x.tagStr==="end")break}},f.prototype._decodeList=function(b,v,x,w){const M=[];for(;!b.isEmpty();){const E=this._peekTag(b,"end");if(b.isError(E))return E;const D=x.decode(b,"der",w);if(b.isError(D)&&E)break;M.push(D)}return M},f.prototype._decodeStr=function(b,v){if(v==="bitstr"){const x=b.readUInt8();return b.isError(x)?x:{unused:x,data:b.raw()}}if(v==="bmpstr"){const x=b.raw();if(x.length%2==1)return b.error("Decoding of string type: bmpstr length mismatch");let w="";for(let M=0;M<x.length/2;M++)w+=String.fromCharCode(x.readUInt16BE(2*M));return w}if(v==="numstr"){const x=b.raw().toString("ascii");return this._isNumstr(x)?x:b.error("Decoding of string type: numstr unsupported characters")}if(v==="octstr"||v==="objDesc")return b.raw();if(v==="printstr"){const x=b.raw().toString("ascii");return this._isPrintstr(x)?x:b.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(v)?b.raw().toString():b.error("Decoding of string type: "+v+" unsupported")},f.prototype._decodeObjid=function(b,v,x){let w;const M=[];let E=0,D=0;for(;!b.isEmpty();)D=b.readUInt8(),E<<=7,E|=127&D,!(128&D)&&(M.push(E),E=0);128&D&&M.push(E);const N=M[0]/40|0,V=M[0]%40;if(w=x?M:[N,V].concat(M.slice(1)),v){let K=v[w.join(" ")];K===void 0&&(K=v[w.join(".")]),K!==void 0&&(w=K)}return w},f.prototype._decodeTime=function(b,v){const x=b.raw().toString();let w,M,E,D,N,V;if(v==="gentime")w=0|x.slice(0,4),M=0|x.slice(4,6),E=0|x.slice(6,8),D=0|x.slice(8,10),N=0|x.slice(10,12),V=0|x.slice(12,14);else{if(v!=="utctime")return b.error("Decoding "+v+" time is not supported yet");w=0|x.slice(0,2),M=0|x.slice(2,4),E=0|x.slice(4,6),D=0|x.slice(6,8),N=0|x.slice(8,10),V=0|x.slice(10,12),w=w<70?2e3+w:1900+w}return Date.UTC(w,M-1,E,D,N,V,0)},f.prototype._decodeNull=function(){return null},f.prototype._decodeBool=function(b){const v=b.readUInt8();return b.isError(v)?v:v!==0},f.prototype._decodeInt=function(b,v){const x=b.raw();let w=new o(x);return v&&(w=v[w.toString(10)]||w),w},f.prototype._use=function(b,v){return typeof b=="function"&&(b=b(v)),b._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,i,s){const a=s;a.der=e("./der"),a.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,i,s){const a=e("inherits"),o=e("safer-buffer").Buffer,r=e("./der");function u(l){r.call(this,l),this.enc="pem"}a(u,r),i.exports=u,u.prototype.decode=function(l,h){const f=l.toString().split(/[\r\n]+/g),d=h.label.toUpperCase(),p=/^-----(BEGIN|END) ([^-]+)-----$/;let b=-1,v=-1;for(let M=0;M<f.length;M++){const E=f[M].match(p);if(E!==null&&E[2]===d){if(b!==-1){if(E[1]!=="END")break;v=M;break}if(E[1]!=="BEGIN")break;b=M}}if(b===-1||v===-1)throw new Error("PEM section not found for: "+d);const x=f.slice(b+1,v).join("");x.replace(/[^a-z0-9+/=]+/gi,"");const w=o.from(x,"base64");return r.prototype.decode.call(this,w,h)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,i,s){const a=e("inherits"),o=e("safer-buffer").Buffer,r=e("../base/node"),u=e("../constants/der");function l(d){this.enc="der",this.name=d.name,this.entity=d,this.tree=new h,this.tree._init(d.body)}function h(d){r.call(this,"der",d)}function f(d){return d<10?"0"+d:d}i.exports=l,l.prototype.encode=function(d,p){return this.tree._encode(d,p).join()},a(h,r),h.prototype._encodeComposite=function(d,p,b,v){const x=function(E,D,N,V){let K;if(E==="seqof"?E="seq":E==="setof"&&(E="set"),u.tagByName.hasOwnProperty(E))K=u.tagByName[E];else{if(typeof E!="number"||(0|E)!==E)return V.error("Unknown tag: "+E);K=E}return K>=31?V.error("Multi-octet tag encoding unsupported"):(D||(K|=32),K|=u.tagClassByName[N||"universal"]<<6,K)}(d,p,b,this.reporter);if(v.length<128){const E=o.alloc(2);return E[0]=x,E[1]=v.length,this._createEncoderBuffer([E,v])}let w=1;for(let E=v.length;E>=256;E>>=8)w++;const M=o.alloc(2+w);M[0]=x,M[1]=128|w;for(let E=1+w,D=v.length;D>0;E--,D>>=8)M[E]=255&D;return this._createEncoderBuffer([M,v])},h.prototype._encodeStr=function(d,p){if(p==="bitstr")return this._createEncoderBuffer([0|d.unused,d.data]);if(p==="bmpstr"){const b=o.alloc(2*d.length);for(let v=0;v<d.length;v++)b.writeUInt16BE(d.charCodeAt(v),2*v);return this._createEncoderBuffer(b)}return p==="numstr"?this._isNumstr(d)?this._createEncoderBuffer(d):this.reporter.error("Encoding of string type: numstr supports only digits and space"):p==="printstr"?this._isPrintstr(d)?this._createEncoderBuffer(d):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(p)||p==="objDesc"?this._createEncoderBuffer(d):this.reporter.error("Encoding of string type: "+p+" unsupported")},h.prototype._encodeObjid=function(d,p,b){if(typeof d=="string"){if(!p)return this.reporter.error("string objid given, but no values map found");if(!p.hasOwnProperty(d))return this.reporter.error("objid not found in values map");d=p[d].split(/[\s.]+/g);for(let M=0;M<d.length;M++)d[M]|=0}else if(Array.isArray(d)){d=d.slice();for(let M=0;M<d.length;M++)d[M]|=0}if(!Array.isArray(d))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(d));if(!b){if(d[1]>=40)return this.reporter.error("Second objid identifier OOB");d.splice(0,2,40*d[0]+d[1])}let v=0;for(let M=0;M<d.length;M++){let E=d[M];for(v++;E>=128;E>>=7)v++}const x=o.alloc(v);let w=x.length-1;for(let M=d.length-1;M>=0;M--){let E=d[M];for(x[w--]=127&E;(E>>=7)>0;)x[w--]=128|127&E}return this._createEncoderBuffer(x)},h.prototype._encodeTime=function(d,p){let b;const v=new Date(d);return p==="gentime"?b=[f(v.getUTCFullYear()),f(v.getUTCMonth()+1),f(v.getUTCDate()),f(v.getUTCHours()),f(v.getUTCMinutes()),f(v.getUTCSeconds()),"Z"].join(""):p==="utctime"?b=[f(v.getUTCFullYear()%100),f(v.getUTCMonth()+1),f(v.getUTCDate()),f(v.getUTCHours()),f(v.getUTCMinutes()),f(v.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+p+" time is not supported yet"),this._encodeStr(b,"octstr")},h.prototype._encodeNull=function(){return this._createEncoderBuffer("")},h.prototype._encodeInt=function(d,p){if(typeof d=="string"){if(!p)return this.reporter.error("String int or enum given, but no values map");if(!p.hasOwnProperty(d))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(d));d=p[d]}if(typeof d!="number"&&!o.isBuffer(d)){const x=d.toArray();!d.sign&&128&x[0]&&x.unshift(0),d=o.from(x)}if(o.isBuffer(d)){let x=d.length;d.length===0&&x++;const w=o.alloc(x);return d.copy(w),d.length===0&&(w[0]=0),this._createEncoderBuffer(w)}if(d<128)return this._createEncoderBuffer(d);if(d<256)return this._createEncoderBuffer([0,d]);let b=1;for(let x=d;x>=256;x>>=8)b++;const v=new Array(b);for(let x=v.length-1;x>=0;x--)v[x]=255&d,d>>=8;return 128&v[0]&&v.unshift(0),this._createEncoderBuffer(o.from(v))},h.prototype._encodeBool=function(d){return this._createEncoderBuffer(d?255:0)},h.prototype._use=function(d,p){return typeof d=="function"&&(d=d(p)),d._getEncoder("der").tree},h.prototype._skipDefault=function(d,p,b){const v=this._baseState;let x;if(v.default===null)return!1;const w=d.join();if(v.defaultBuffer===void 0&&(v.defaultBuffer=this._encodeValue(v.default,p,b).join()),w.length!==v.defaultBuffer.length)return!1;for(x=0;x<w.length;x++)if(w[x]!==v.defaultBuffer[x])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,i,s){const a=s;a.der=e("./der"),a.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,i,s){const a=e("inherits"),o=e("./der");function r(u){o.call(this,u),this.enc="pem"}a(r,o),i.exports=r,r.prototype.encode=function(u,l){const h=o.prototype.encode.call(this,u).toString("base64"),f=["-----BEGIN "+l.label+"-----"];for(let d=0;d<h.length;d+=64)f.push(h.slice(d,d+64));return f.push("-----END "+l.label+"-----"),f.join(`
`)}},{"./der":181,inherits:440}],184:[function(e,i,s){(function(a,o){function r(U,G){if(!U)throw new Error(G||"Assertion failed")}function u(U,G){U.super_=G;var I=function(){};I.prototype=G.prototype,U.prototype=new I,U.prototype.constructor=U}function l(U,G,I){if(l.isBN(U))return U;this.negative=0,this.words=null,this.length=0,this.red=null,U!==null&&(G!=="le"&&G!=="be"||(I=G,G=10),this._init(U||0,G||10,I||"be"))}var h;typeof a=="object"?a.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{h=typeof window!="undefined"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch(U){}function f(U,G){var I=U.charCodeAt(G);return I>=65&&I<=70?I-55:I>=97&&I<=102?I-87:I-48&15}function d(U,G,I){var C=f(U,I);return I-1>=G&&(C|=f(U,I-1)<<4),C}function p(U,G,I,C){for(var L=0,B=Math.min(U.length,I),O=G;O<B;O++){var q=U.charCodeAt(O)-48;L*=C,L+=q>=49?q-49+10:q>=17?q-17+10:q}return L}l.isBN=function(U){return U instanceof l||U!==null&&typeof U=="object"&&U.constructor.wordSize===l.wordSize&&Array.isArray(U.words)},l.max=function(U,G){return U.cmp(G)>0?U:G},l.min=function(U,G){return U.cmp(G)<0?U:G},l.prototype._init=function(U,G,I){if(typeof U=="number")return this._initNumber(U,G,I);if(typeof U=="object")return this._initArray(U,G,I);G==="hex"&&(G=16),r(G===(0|G)&&G>=2&&G<=36);var C=0;(U=U.toString().replace(/\s+/g,""))[0]==="-"&&(C++,this.negative=1),C<U.length&&(G===16?this._parseHex(U,C,I):(this._parseBase(U,G,C),I==="le"&&this._initArray(this.toArray(),G,I)))},l.prototype._initNumber=function(U,G,I){U<0&&(this.negative=1,U=-U),U<67108864?(this.words=[67108863&U],this.length=1):U<4503599627370496?(this.words=[67108863&U,U/67108864&67108863],this.length=2):(r(U<9007199254740992),this.words=[67108863&U,U/67108864&67108863,1],this.length=3),I==="le"&&this._initArray(this.toArray(),G,I)},l.prototype._initArray=function(U,G,I){if(r(typeof U.length=="number"),U.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(U.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var L,B,O=0;if(I==="be")for(C=U.length-1,L=0;C>=0;C-=3)B=U[C]|U[C-1]<<8|U[C-2]<<16,this.words[L]|=B<<O&67108863,this.words[L+1]=B>>>26-O&67108863,(O+=24)>=26&&(O-=26,L++);else if(I==="le")for(C=0,L=0;C<U.length;C+=3)B=U[C]|U[C+1]<<8|U[C+2]<<16,this.words[L]|=B<<O&67108863,this.words[L+1]=B>>>26-O&67108863,(O+=24)>=26&&(O-=26,L++);return this.strip()},l.prototype._parseHex=function(U,G,I){this.length=Math.ceil((U.length-G)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var L,B=0,O=0;if(I==="be")for(C=U.length-1;C>=G;C-=2)L=d(U,G,C)<<B,this.words[O]|=67108863&L,B>=18?(B-=18,O+=1,this.words[O]|=L>>>26):B+=8;else for(C=(U.length-G)%2==0?G+1:G;C<U.length;C+=2)L=d(U,G,C)<<B,this.words[O]|=67108863&L,B>=18?(B-=18,O+=1,this.words[O]|=L>>>26):B+=8;this.strip()},l.prototype._parseBase=function(U,G,I){this.words=[0],this.length=1;for(var C=0,L=1;L<=67108863;L*=G)C++;C--,L=L/G|0;for(var B=U.length-I,O=B%C,q=Math.min(B,B-O)+I,it=0,nt=I;nt<q;nt+=C)it=p(U,nt,nt+C,G),this.imuln(L),this.words[0]+it<67108864?this.words[0]+=it:this._iaddn(it);if(O!==0){var lt=1;for(it=p(U,nt,U.length,G),nt=0;nt<O;nt++)lt*=G;this.imuln(lt),this.words[0]+it<67108864?this.words[0]+=it:this._iaddn(it)}this.strip()},l.prototype.copy=function(U){U.words=new Array(this.length);for(var G=0;G<this.length;G++)U.words[G]=this.words[G];U.length=this.length,U.negative=this.negative,U.red=this.red},l.prototype.clone=function(){var U=new l(null);return this.copy(U),U},l.prototype._expand=function(U){for(;this.length<U;)this.words[this.length++]=0;return this},l.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},l.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],x=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function w(U,G,I){I.negative=G.negative^U.negative;var C=U.length+G.length|0;I.length=C,C=C-1|0;var L=0|U.words[0],B=0|G.words[0],O=L*B,q=67108863&O,it=O/67108864|0;I.words[0]=q;for(var nt=1;nt<C;nt++){for(var lt=it>>>26,ut=67108863&it,vt=Math.min(nt,G.length-1),Q=Math.max(0,nt-U.length+1);Q<=vt;Q++){var gt=nt-Q|0;lt+=(O=(L=0|U.words[gt])*(B=0|G.words[Q])+ut)/67108864|0,ut=67108863&O}I.words[nt]=0|ut,it=0|lt}return it!==0?I.words[nt]=0|it:I.length--,I.strip()}l.prototype.toString=function(U,G){var I;if(G=0|G||1,(U=U||10)===16||U==="hex"){I="";for(var C=0,L=0,B=0;B<this.length;B++){var O=this.words[B],q=(16777215&(O<<C|L)).toString(16);I=(L=O>>>24-C&16777215)!==0||B!==this.length-1?b[6-q.length]+q+I:q+I,(C+=2)>=26&&(C-=26,B--)}for(L!==0&&(I=L.toString(16)+I);I.length%G!=0;)I="0"+I;return this.negative!==0&&(I="-"+I),I}if(U===(0|U)&&U>=2&&U<=36){var it=v[U],nt=x[U];I="";var lt=this.clone();for(lt.negative=0;!lt.isZero();){var ut=lt.modn(nt).toString(U);I=(lt=lt.idivn(nt)).isZero()?ut+I:b[it-ut.length]+ut+I}for(this.isZero()&&(I="0"+I);I.length%G!=0;)I="0"+I;return this.negative!==0&&(I="-"+I),I}r(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var U=this.words[0];return this.length===2?U+=67108864*this.words[1]:this.length===3&&this.words[2]===1?U+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-U:U},l.prototype.toJSON=function(){return this.toString(16)},l.prototype.toBuffer=function(U,G){return r(h!==void 0),this.toArrayLike(h,U,G)},l.prototype.toArray=function(U,G){return this.toArrayLike(Array,U,G)},l.prototype.toArrayLike=function(U,G,I){var C=this.byteLength(),L=I||Math.max(1,C);r(C<=L,"byte array longer than desired length"),r(L>0,"Requested array length <= 0"),this.strip();var B,O,q=G==="le",it=new U(L),nt=this.clone();if(q){for(O=0;!nt.isZero();O++)B=nt.andln(255),nt.iushrn(8),it[O]=B;for(;O<L;O++)it[O]=0}else{for(O=0;O<L-C;O++)it[O]=0;for(O=0;!nt.isZero();O++)B=nt.andln(255),nt.iushrn(8),it[L-O-1]=B}return it},Math.clz32?l.prototype._countBits=function(U){return 32-Math.clz32(U)}:l.prototype._countBits=function(U){var G=U,I=0;return G>=4096&&(I+=13,G>>>=13),G>=64&&(I+=7,G>>>=7),G>=8&&(I+=4,G>>>=4),G>=2&&(I+=2,G>>>=2),I+G},l.prototype._zeroBits=function(U){if(U===0)return 26;var G=U,I=0;return!(8191&G)&&(I+=13,G>>>=13),!(127&G)&&(I+=7,G>>>=7),!(15&G)&&(I+=4,G>>>=4),!(3&G)&&(I+=2,G>>>=2),!(1&G)&&I++,I},l.prototype.bitLength=function(){var U=this.words[this.length-1],G=this._countBits(U);return 26*(this.length-1)+G},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var U=0,G=0;G<this.length;G++){var I=this._zeroBits(this.words[G]);if(U+=I,I!==26)break}return U},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(U){return this.negative!==0?this.abs().inotn(U).iaddn(1):this.clone()},l.prototype.fromTwos=function(U){return this.testn(U-1)?this.notn(U).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(U){for(;this.length<U.length;)this.words[this.length++]=0;for(var G=0;G<U.length;G++)this.words[G]=this.words[G]|U.words[G];return this.strip()},l.prototype.ior=function(U){return r((this.negative|U.negative)==0),this.iuor(U)},l.prototype.or=function(U){return this.length>U.length?this.clone().ior(U):U.clone().ior(this)},l.prototype.uor=function(U){return this.length>U.length?this.clone().iuor(U):U.clone().iuor(this)},l.prototype.iuand=function(U){var G;G=this.length>U.length?U:this;for(var I=0;I<G.length;I++)this.words[I]=this.words[I]&U.words[I];return this.length=G.length,this.strip()},l.prototype.iand=function(U){return r((this.negative|U.negative)==0),this.iuand(U)},l.prototype.and=function(U){return this.length>U.length?this.clone().iand(U):U.clone().iand(this)},l.prototype.uand=function(U){return this.length>U.length?this.clone().iuand(U):U.clone().iuand(this)},l.prototype.iuxor=function(U){var G,I;this.length>U.length?(G=this,I=U):(G=U,I=this);for(var C=0;C<I.length;C++)this.words[C]=G.words[C]^I.words[C];if(this!==G)for(;C<G.length;C++)this.words[C]=G.words[C];return this.length=G.length,this.strip()},l.prototype.ixor=function(U){return r((this.negative|U.negative)==0),this.iuxor(U)},l.prototype.xor=function(U){return this.length>U.length?this.clone().ixor(U):U.clone().ixor(this)},l.prototype.uxor=function(U){return this.length>U.length?this.clone().iuxor(U):U.clone().iuxor(this)},l.prototype.inotn=function(U){r(typeof U=="number"&&U>=0);var G=0|Math.ceil(U/26),I=U%26;this._expand(G),I>0&&G--;for(var C=0;C<G;C++)this.words[C]=67108863&~this.words[C];return I>0&&(this.words[C]=~this.words[C]&67108863>>26-I),this.strip()},l.prototype.notn=function(U){return this.clone().inotn(U)},l.prototype.setn=function(U,G){r(typeof U=="number"&&U>=0);var I=U/26|0,C=U%26;return this._expand(I+1),this.words[I]=G?this.words[I]|1<<C:this.words[I]&~(1<<C),this.strip()},l.prototype.iadd=function(U){var G,I,C;if(this.negative!==0&&U.negative===0)return this.negative=0,G=this.isub(U),this.negative^=1,this._normSign();if(this.negative===0&&U.negative!==0)return U.negative=0,G=this.isub(U),U.negative=1,G._normSign();this.length>U.length?(I=this,C=U):(I=U,C=this);for(var L=0,B=0;B<C.length;B++)G=(0|I.words[B])+(0|C.words[B])+L,this.words[B]=67108863&G,L=G>>>26;for(;L!==0&&B<I.length;B++)G=(0|I.words[B])+L,this.words[B]=67108863&G,L=G>>>26;if(this.length=I.length,L!==0)this.words[this.length]=L,this.length++;else if(I!==this)for(;B<I.length;B++)this.words[B]=I.words[B];return this},l.prototype.add=function(U){var G;return U.negative!==0&&this.negative===0?(U.negative=0,G=this.sub(U),U.negative^=1,G):U.negative===0&&this.negative!==0?(this.negative=0,G=U.sub(this),this.negative=1,G):this.length>U.length?this.clone().iadd(U):U.clone().iadd(this)},l.prototype.isub=function(U){if(U.negative!==0){U.negative=0;var G=this.iadd(U);return U.negative=1,G._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(U),this.negative=1,this._normSign();var I,C,L=this.cmp(U);if(L===0)return this.negative=0,this.length=1,this.words[0]=0,this;L>0?(I=this,C=U):(I=U,C=this);for(var B=0,O=0;O<C.length;O++)B=(G=(0|I.words[O])-(0|C.words[O])+B)>>26,this.words[O]=67108863&G;for(;B!==0&&O<I.length;O++)B=(G=(0|I.words[O])+B)>>26,this.words[O]=67108863&G;if(B===0&&O<I.length&&I!==this)for(;O<I.length;O++)this.words[O]=I.words[O];return this.length=Math.max(this.length,O),I!==this&&(this.negative=1),this.strip()},l.prototype.sub=function(U){return this.clone().isub(U)};var M=function(U,G,I){var C,L,B,O=U.words,q=G.words,it=I.words,nt=0,lt=0|O[0],ut=8191&lt,vt=lt>>>13,Q=0|O[1],gt=8191&Q,Y=Q>>>13,H=0|O[2],at=8191&H,ft=H>>>13,wt=0|O[3],_t=8191&wt,Dt=wt>>>13,Gt=0|O[4],te=8191&Gt,mt=Gt>>>13,At=0|O[5],Ot=8191&At,Zt=At>>>13,he=0|O[6],fe=8191&he,be=he>>>13,Me=0|O[7],Pe=8191&Me,ze=Me>>>13,Ce=0|O[8],Le=8191&Ce,Ye=Ce>>>13,le=0|O[9],Fe=8191&le,Ke=le>>>13,Ze=0|q[0],ke=8191&Ze,Qe=Ze>>>13,hn=0|q[1],ln=8191&hn,Hn=hn>>>13,Tn=0|q[2],Sn=8191&Tn,On=Tn>>>13,qn=0|q[3],Pn=8191&qn,cr=qn>>>13,Yn=0|q[4],zn=8191&Yn,Qn=Yn>>>13,Wt=0|q[5],St=8191&Wt,Rt=Wt>>>13,jt=0|q[6],Xt=8191&jt,It=jt>>>13,zt=0|q[7],Kt=8191&zt,Qt=zt>>>13,me=0|q[8],ve=8191&me,Xe=me>>>13,Ee=0|q[9],$e=8191&Ee,Tt=Ee>>>13;I.negative=U.negative^G.negative,I.length=19;var Lt=(nt+(C=Math.imul(ut,ke))|0)+((8191&(L=(L=Math.imul(ut,Qe))+Math.imul(vt,ke)|0))<<13)|0;nt=((B=Math.imul(vt,Qe))+(L>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,C=Math.imul(gt,ke),L=(L=Math.imul(gt,Qe))+Math.imul(Y,ke)|0,B=Math.imul(Y,Qe);var ee=(nt+(C=C+Math.imul(ut,ln)|0)|0)+((8191&(L=(L=L+Math.imul(ut,Hn)|0)+Math.imul(vt,ln)|0))<<13)|0;nt=((B=B+Math.imul(vt,Hn)|0)+(L>>>13)|0)+(ee>>>26)|0,ee&=67108863,C=Math.imul(at,ke),L=(L=Math.imul(at,Qe))+Math.imul(ft,ke)|0,B=Math.imul(ft,Qe),C=C+Math.imul(gt,ln)|0,L=(L=L+Math.imul(gt,Hn)|0)+Math.imul(Y,ln)|0,B=B+Math.imul(Y,Hn)|0;var Yt=(nt+(C=C+Math.imul(ut,Sn)|0)|0)+((8191&(L=(L=L+Math.imul(ut,On)|0)+Math.imul(vt,Sn)|0))<<13)|0;nt=((B=B+Math.imul(vt,On)|0)+(L>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,C=Math.imul(_t,ke),L=(L=Math.imul(_t,Qe))+Math.imul(Dt,ke)|0,B=Math.imul(Dt,Qe),C=C+Math.imul(at,ln)|0,L=(L=L+Math.imul(at,Hn)|0)+Math.imul(ft,ln)|0,B=B+Math.imul(ft,Hn)|0,C=C+Math.imul(gt,Sn)|0,L=(L=L+Math.imul(gt,On)|0)+Math.imul(Y,Sn)|0,B=B+Math.imul(Y,On)|0;var Ve=(nt+(C=C+Math.imul(ut,Pn)|0)|0)+((8191&(L=(L=L+Math.imul(ut,cr)|0)+Math.imul(vt,Pn)|0))<<13)|0;nt=((B=B+Math.imul(vt,cr)|0)+(L>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,C=Math.imul(te,ke),L=(L=Math.imul(te,Qe))+Math.imul(mt,ke)|0,B=Math.imul(mt,Qe),C=C+Math.imul(_t,ln)|0,L=(L=L+Math.imul(_t,Hn)|0)+Math.imul(Dt,ln)|0,B=B+Math.imul(Dt,Hn)|0,C=C+Math.imul(at,Sn)|0,L=(L=L+Math.imul(at,On)|0)+Math.imul(ft,Sn)|0,B=B+Math.imul(ft,On)|0,C=C+Math.imul(gt,Pn)|0,L=(L=L+Math.imul(gt,cr)|0)+Math.imul(Y,Pn)|0,B=B+Math.imul(Y,cr)|0;var Ue=(nt+(C=C+Math.imul(ut,zn)|0)|0)+((8191&(L=(L=L+Math.imul(ut,Qn)|0)+Math.imul(vt,zn)|0))<<13)|0;nt=((B=B+Math.imul(vt,Qn)|0)+(L>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,C=Math.imul(Ot,ke),L=(L=Math.imul(Ot,Qe))+Math.imul(Zt,ke)|0,B=Math.imul(Zt,Qe),C=C+Math.imul(te,ln)|0,L=(L=L+Math.imul(te,Hn)|0)+Math.imul(mt,ln)|0,B=B+Math.imul(mt,Hn)|0,C=C+Math.imul(_t,Sn)|0,L=(L=L+Math.imul(_t,On)|0)+Math.imul(Dt,Sn)|0,B=B+Math.imul(Dt,On)|0,C=C+Math.imul(at,Pn)|0,L=(L=L+Math.imul(at,cr)|0)+Math.imul(ft,Pn)|0,B=B+Math.imul(ft,cr)|0,C=C+Math.imul(gt,zn)|0,L=(L=L+Math.imul(gt,Qn)|0)+Math.imul(Y,zn)|0,B=B+Math.imul(Y,Qn)|0;var en=(nt+(C=C+Math.imul(ut,St)|0)|0)+((8191&(L=(L=L+Math.imul(ut,Rt)|0)+Math.imul(vt,St)|0))<<13)|0;nt=((B=B+Math.imul(vt,Rt)|0)+(L>>>13)|0)+(en>>>26)|0,en&=67108863,C=Math.imul(fe,ke),L=(L=Math.imul(fe,Qe))+Math.imul(be,ke)|0,B=Math.imul(be,Qe),C=C+Math.imul(Ot,ln)|0,L=(L=L+Math.imul(Ot,Hn)|0)+Math.imul(Zt,ln)|0,B=B+Math.imul(Zt,Hn)|0,C=C+Math.imul(te,Sn)|0,L=(L=L+Math.imul(te,On)|0)+Math.imul(mt,Sn)|0,B=B+Math.imul(mt,On)|0,C=C+Math.imul(_t,Pn)|0,L=(L=L+Math.imul(_t,cr)|0)+Math.imul(Dt,Pn)|0,B=B+Math.imul(Dt,cr)|0,C=C+Math.imul(at,zn)|0,L=(L=L+Math.imul(at,Qn)|0)+Math.imul(ft,zn)|0,B=B+Math.imul(ft,Qn)|0,C=C+Math.imul(gt,St)|0,L=(L=L+Math.imul(gt,Rt)|0)+Math.imul(Y,St)|0,B=B+Math.imul(Y,Rt)|0;var gn=(nt+(C=C+Math.imul(ut,Xt)|0)|0)+((8191&(L=(L=L+Math.imul(ut,It)|0)+Math.imul(vt,Xt)|0))<<13)|0;nt=((B=B+Math.imul(vt,It)|0)+(L>>>13)|0)+(gn>>>26)|0,gn&=67108863,C=Math.imul(Pe,ke),L=(L=Math.imul(Pe,Qe))+Math.imul(ze,ke)|0,B=Math.imul(ze,Qe),C=C+Math.imul(fe,ln)|0,L=(L=L+Math.imul(fe,Hn)|0)+Math.imul(be,ln)|0,B=B+Math.imul(be,Hn)|0,C=C+Math.imul(Ot,Sn)|0,L=(L=L+Math.imul(Ot,On)|0)+Math.imul(Zt,Sn)|0,B=B+Math.imul(Zt,On)|0,C=C+Math.imul(te,Pn)|0,L=(L=L+Math.imul(te,cr)|0)+Math.imul(mt,Pn)|0,B=B+Math.imul(mt,cr)|0,C=C+Math.imul(_t,zn)|0,L=(L=L+Math.imul(_t,Qn)|0)+Math.imul(Dt,zn)|0,B=B+Math.imul(Dt,Qn)|0,C=C+Math.imul(at,St)|0,L=(L=L+Math.imul(at,Rt)|0)+Math.imul(ft,St)|0,B=B+Math.imul(ft,Rt)|0,C=C+Math.imul(gt,Xt)|0,L=(L=L+Math.imul(gt,It)|0)+Math.imul(Y,Xt)|0,B=B+Math.imul(Y,It)|0;var qt=(nt+(C=C+Math.imul(ut,Kt)|0)|0)+((8191&(L=(L=L+Math.imul(ut,Qt)|0)+Math.imul(vt,Kt)|0))<<13)|0;nt=((B=B+Math.imul(vt,Qt)|0)+(L>>>13)|0)+(qt>>>26)|0,qt&=67108863,C=Math.imul(Le,ke),L=(L=Math.imul(Le,Qe))+Math.imul(Ye,ke)|0,B=Math.imul(Ye,Qe),C=C+Math.imul(Pe,ln)|0,L=(L=L+Math.imul(Pe,Hn)|0)+Math.imul(ze,ln)|0,B=B+Math.imul(ze,Hn)|0,C=C+Math.imul(fe,Sn)|0,L=(L=L+Math.imul(fe,On)|0)+Math.imul(be,Sn)|0,B=B+Math.imul(be,On)|0,C=C+Math.imul(Ot,Pn)|0,L=(L=L+Math.imul(Ot,cr)|0)+Math.imul(Zt,Pn)|0,B=B+Math.imul(Zt,cr)|0,C=C+Math.imul(te,zn)|0,L=(L=L+Math.imul(te,Qn)|0)+Math.imul(mt,zn)|0,B=B+Math.imul(mt,Qn)|0,C=C+Math.imul(_t,St)|0,L=(L=L+Math.imul(_t,Rt)|0)+Math.imul(Dt,St)|0,B=B+Math.imul(Dt,Rt)|0,C=C+Math.imul(at,Xt)|0,L=(L=L+Math.imul(at,It)|0)+Math.imul(ft,Xt)|0,B=B+Math.imul(ft,It)|0,C=C+Math.imul(gt,Kt)|0,L=(L=L+Math.imul(gt,Qt)|0)+Math.imul(Y,Kt)|0,B=B+Math.imul(Y,Qt)|0;var ye=(nt+(C=C+Math.imul(ut,ve)|0)|0)+((8191&(L=(L=L+Math.imul(ut,Xe)|0)+Math.imul(vt,ve)|0))<<13)|0;nt=((B=B+Math.imul(vt,Xe)|0)+(L>>>13)|0)+(ye>>>26)|0,ye&=67108863,C=Math.imul(Fe,ke),L=(L=Math.imul(Fe,Qe))+Math.imul(Ke,ke)|0,B=Math.imul(Ke,Qe),C=C+Math.imul(Le,ln)|0,L=(L=L+Math.imul(Le,Hn)|0)+Math.imul(Ye,ln)|0,B=B+Math.imul(Ye,Hn)|0,C=C+Math.imul(Pe,Sn)|0,L=(L=L+Math.imul(Pe,On)|0)+Math.imul(ze,Sn)|0,B=B+Math.imul(ze,On)|0,C=C+Math.imul(fe,Pn)|0,L=(L=L+Math.imul(fe,cr)|0)+Math.imul(be,Pn)|0,B=B+Math.imul(be,cr)|0,C=C+Math.imul(Ot,zn)|0,L=(L=L+Math.imul(Ot,Qn)|0)+Math.imul(Zt,zn)|0,B=B+Math.imul(Zt,Qn)|0,C=C+Math.imul(te,St)|0,L=(L=L+Math.imul(te,Rt)|0)+Math.imul(mt,St)|0,B=B+Math.imul(mt,Rt)|0,C=C+Math.imul(_t,Xt)|0,L=(L=L+Math.imul(_t,It)|0)+Math.imul(Dt,Xt)|0,B=B+Math.imul(Dt,It)|0,C=C+Math.imul(at,Kt)|0,L=(L=L+Math.imul(at,Qt)|0)+Math.imul(ft,Kt)|0,B=B+Math.imul(ft,Qt)|0,C=C+Math.imul(gt,ve)|0,L=(L=L+Math.imul(gt,Xe)|0)+Math.imul(Y,ve)|0,B=B+Math.imul(Y,Xe)|0;var pe=(nt+(C=C+Math.imul(ut,$e)|0)|0)+((8191&(L=(L=L+Math.imul(ut,Tt)|0)+Math.imul(vt,$e)|0))<<13)|0;nt=((B=B+Math.imul(vt,Tt)|0)+(L>>>13)|0)+(pe>>>26)|0,pe&=67108863,C=Math.imul(Fe,ln),L=(L=Math.imul(Fe,Hn))+Math.imul(Ke,ln)|0,B=Math.imul(Ke,Hn),C=C+Math.imul(Le,Sn)|0,L=(L=L+Math.imul(Le,On)|0)+Math.imul(Ye,Sn)|0,B=B+Math.imul(Ye,On)|0,C=C+Math.imul(Pe,Pn)|0,L=(L=L+Math.imul(Pe,cr)|0)+Math.imul(ze,Pn)|0,B=B+Math.imul(ze,cr)|0,C=C+Math.imul(fe,zn)|0,L=(L=L+Math.imul(fe,Qn)|0)+Math.imul(be,zn)|0,B=B+Math.imul(be,Qn)|0,C=C+Math.imul(Ot,St)|0,L=(L=L+Math.imul(Ot,Rt)|0)+Math.imul(Zt,St)|0,B=B+Math.imul(Zt,Rt)|0,C=C+Math.imul(te,Xt)|0,L=(L=L+Math.imul(te,It)|0)+Math.imul(mt,Xt)|0,B=B+Math.imul(mt,It)|0,C=C+Math.imul(_t,Kt)|0,L=(L=L+Math.imul(_t,Qt)|0)+Math.imul(Dt,Kt)|0,B=B+Math.imul(Dt,Qt)|0,C=C+Math.imul(at,ve)|0,L=(L=L+Math.imul(at,Xe)|0)+Math.imul(ft,ve)|0,B=B+Math.imul(ft,Xe)|0;var Te=(nt+(C=C+Math.imul(gt,$e)|0)|0)+((8191&(L=(L=L+Math.imul(gt,Tt)|0)+Math.imul(Y,$e)|0))<<13)|0;nt=((B=B+Math.imul(Y,Tt)|0)+(L>>>13)|0)+(Te>>>26)|0,Te&=67108863,C=Math.imul(Fe,Sn),L=(L=Math.imul(Fe,On))+Math.imul(Ke,Sn)|0,B=Math.imul(Ke,On),C=C+Math.imul(Le,Pn)|0,L=(L=L+Math.imul(Le,cr)|0)+Math.imul(Ye,Pn)|0,B=B+Math.imul(Ye,cr)|0,C=C+Math.imul(Pe,zn)|0,L=(L=L+Math.imul(Pe,Qn)|0)+Math.imul(ze,zn)|0,B=B+Math.imul(ze,Qn)|0,C=C+Math.imul(fe,St)|0,L=(L=L+Math.imul(fe,Rt)|0)+Math.imul(be,St)|0,B=B+Math.imul(be,Rt)|0,C=C+Math.imul(Ot,Xt)|0,L=(L=L+Math.imul(Ot,It)|0)+Math.imul(Zt,Xt)|0,B=B+Math.imul(Zt,It)|0,C=C+Math.imul(te,Kt)|0,L=(L=L+Math.imul(te,Qt)|0)+Math.imul(mt,Kt)|0,B=B+Math.imul(mt,Qt)|0,C=C+Math.imul(_t,ve)|0,L=(L=L+Math.imul(_t,Xe)|0)+Math.imul(Dt,ve)|0,B=B+Math.imul(Dt,Xe)|0;var We=(nt+(C=C+Math.imul(at,$e)|0)|0)+((8191&(L=(L=L+Math.imul(at,Tt)|0)+Math.imul(ft,$e)|0))<<13)|0;nt=((B=B+Math.imul(ft,Tt)|0)+(L>>>13)|0)+(We>>>26)|0,We&=67108863,C=Math.imul(Fe,Pn),L=(L=Math.imul(Fe,cr))+Math.imul(Ke,Pn)|0,B=Math.imul(Ke,cr),C=C+Math.imul(Le,zn)|0,L=(L=L+Math.imul(Le,Qn)|0)+Math.imul(Ye,zn)|0,B=B+Math.imul(Ye,Qn)|0,C=C+Math.imul(Pe,St)|0,L=(L=L+Math.imul(Pe,Rt)|0)+Math.imul(ze,St)|0,B=B+Math.imul(ze,Rt)|0,C=C+Math.imul(fe,Xt)|0,L=(L=L+Math.imul(fe,It)|0)+Math.imul(be,Xt)|0,B=B+Math.imul(be,It)|0,C=C+Math.imul(Ot,Kt)|0,L=(L=L+Math.imul(Ot,Qt)|0)+Math.imul(Zt,Kt)|0,B=B+Math.imul(Zt,Qt)|0,C=C+Math.imul(te,ve)|0,L=(L=L+Math.imul(te,Xe)|0)+Math.imul(mt,ve)|0,B=B+Math.imul(mt,Xe)|0;var Ie=(nt+(C=C+Math.imul(_t,$e)|0)|0)+((8191&(L=(L=L+Math.imul(_t,Tt)|0)+Math.imul(Dt,$e)|0))<<13)|0;nt=((B=B+Math.imul(Dt,Tt)|0)+(L>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,C=Math.imul(Fe,zn),L=(L=Math.imul(Fe,Qn))+Math.imul(Ke,zn)|0,B=Math.imul(Ke,Qn),C=C+Math.imul(Le,St)|0,L=(L=L+Math.imul(Le,Rt)|0)+Math.imul(Ye,St)|0,B=B+Math.imul(Ye,Rt)|0,C=C+Math.imul(Pe,Xt)|0,L=(L=L+Math.imul(Pe,It)|0)+Math.imul(ze,Xt)|0,B=B+Math.imul(ze,It)|0,C=C+Math.imul(fe,Kt)|0,L=(L=L+Math.imul(fe,Qt)|0)+Math.imul(be,Kt)|0,B=B+Math.imul(be,Qt)|0,C=C+Math.imul(Ot,ve)|0,L=(L=L+Math.imul(Ot,Xe)|0)+Math.imul(Zt,ve)|0,B=B+Math.imul(Zt,Xe)|0;var Ge=(nt+(C=C+Math.imul(te,$e)|0)|0)+((8191&(L=(L=L+Math.imul(te,Tt)|0)+Math.imul(mt,$e)|0))<<13)|0;nt=((B=B+Math.imul(mt,Tt)|0)+(L>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,C=Math.imul(Fe,St),L=(L=Math.imul(Fe,Rt))+Math.imul(Ke,St)|0,B=Math.imul(Ke,Rt),C=C+Math.imul(Le,Xt)|0,L=(L=L+Math.imul(Le,It)|0)+Math.imul(Ye,Xt)|0,B=B+Math.imul(Ye,It)|0,C=C+Math.imul(Pe,Kt)|0,L=(L=L+Math.imul(Pe,Qt)|0)+Math.imul(ze,Kt)|0,B=B+Math.imul(ze,Qt)|0,C=C+Math.imul(fe,ve)|0,L=(L=L+Math.imul(fe,Xe)|0)+Math.imul(be,ve)|0,B=B+Math.imul(be,Xe)|0;var mn=(nt+(C=C+Math.imul(Ot,$e)|0)|0)+((8191&(L=(L=L+Math.imul(Ot,Tt)|0)+Math.imul(Zt,$e)|0))<<13)|0;nt=((B=B+Math.imul(Zt,Tt)|0)+(L>>>13)|0)+(mn>>>26)|0,mn&=67108863,C=Math.imul(Fe,Xt),L=(L=Math.imul(Fe,It))+Math.imul(Ke,Xt)|0,B=Math.imul(Ke,It),C=C+Math.imul(Le,Kt)|0,L=(L=L+Math.imul(Le,Qt)|0)+Math.imul(Ye,Kt)|0,B=B+Math.imul(Ye,Qt)|0,C=C+Math.imul(Pe,ve)|0,L=(L=L+Math.imul(Pe,Xe)|0)+Math.imul(ze,ve)|0,B=B+Math.imul(ze,Xe)|0;var In=(nt+(C=C+Math.imul(fe,$e)|0)|0)+((8191&(L=(L=L+Math.imul(fe,Tt)|0)+Math.imul(be,$e)|0))<<13)|0;nt=((B=B+Math.imul(be,Tt)|0)+(L>>>13)|0)+(In>>>26)|0,In&=67108863,C=Math.imul(Fe,Kt),L=(L=Math.imul(Fe,Qt))+Math.imul(Ke,Kt)|0,B=Math.imul(Ke,Qt),C=C+Math.imul(Le,ve)|0,L=(L=L+Math.imul(Le,Xe)|0)+Math.imul(Ye,ve)|0,B=B+Math.imul(Ye,Xe)|0;var Wn=(nt+(C=C+Math.imul(Pe,$e)|0)|0)+((8191&(L=(L=L+Math.imul(Pe,Tt)|0)+Math.imul(ze,$e)|0))<<13)|0;nt=((B=B+Math.imul(ze,Tt)|0)+(L>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,C=Math.imul(Fe,ve),L=(L=Math.imul(Fe,Xe))+Math.imul(Ke,ve)|0,B=Math.imul(Ke,Xe);var vn=(nt+(C=C+Math.imul(Le,$e)|0)|0)+((8191&(L=(L=L+Math.imul(Le,Tt)|0)+Math.imul(Ye,$e)|0))<<13)|0;nt=((B=B+Math.imul(Ye,Tt)|0)+(L>>>13)|0)+(vn>>>26)|0,vn&=67108863;var jn=(nt+(C=Math.imul(Fe,$e))|0)+((8191&(L=(L=Math.imul(Fe,Tt))+Math.imul(Ke,$e)|0))<<13)|0;return nt=((B=Math.imul(Ke,Tt))+(L>>>13)|0)+(jn>>>26)|0,jn&=67108863,it[0]=Lt,it[1]=ee,it[2]=Yt,it[3]=Ve,it[4]=Ue,it[5]=en,it[6]=gn,it[7]=qt,it[8]=ye,it[9]=pe,it[10]=Te,it[11]=We,it[12]=Ie,it[13]=Ge,it[14]=mn,it[15]=In,it[16]=Wn,it[17]=vn,it[18]=jn,nt!==0&&(it[19]=nt,I.length++),I};function E(U,G,I){return new D().mulp(U,G,I)}function D(U,G){this.x=U,this.y=G}Math.imul||(M=w),l.prototype.mulTo=function(U,G){var I=this.length+U.length;return this.length===10&&U.length===10?M(this,U,G):I<63?w(this,U,G):I<1024?function(C,L,B){B.negative=L.negative^C.negative,B.length=C.length+L.length;for(var O=0,q=0,it=0;it<B.length-1;it++){var nt=q;q=0;for(var lt=67108863&O,ut=Math.min(it,L.length-1),vt=Math.max(0,it-C.length+1);vt<=ut;vt++){var Q=it-vt,gt=(0|C.words[Q])*(0|L.words[vt]),Y=67108863&gt;lt=67108863&(Y=Y+lt|0),q+=(nt=(nt=nt+(gt/67108864|0)|0)+(Y>>>26)|0)>>>26,nt&=67108863}B.words[it]=lt,O=nt,nt=q}return O!==0?B.words[it]=O:B.length--,B.strip()}(this,U,G):E(this,U,G)},D.prototype.makeRBT=function(U){for(var G=new Array(U),I=l.prototype._countBits(U)-1,C=0;C<U;C++)G[C]=this.revBin(C,I,U);return G},D.prototype.revBin=function(U,G,I){if(U===0||U===I-1)return U;for(var C=0,L=0;L<G;L++)C|=(1&U)<<G-L-1,U>>=1;return C},D.prototype.permute=function(U,G,I,C,L,B){for(var O=0;O<B;O++)C[O]=G[U[O]],L[O]=I[U[O]]},D.prototype.transform=function(U,G,I,C,L,B){this.permute(B,U,G,I,C,L);for(var O=1;O<L;O<<=1)for(var q=O<<1,it=Math.cos(2*Math.PI/q),nt=Math.sin(2*Math.PI/q),lt=0;lt<L;lt+=q)for(var ut=it,vt=nt,Q=0;Q<O;Q++){var gt=I[lt+Q],Y=C[lt+Q],H=I[lt+Q+O],at=C[lt+Q+O],ft=ut*H-vt*at;at=ut*at+vt*H,H=ft,I[lt+Q]=gt+H,C[lt+Q]=Y+at,I[lt+Q+O]=gt-H,C[lt+Q+O]=Y-at,Q!==q&&(ft=it*ut-nt*vt,vt=it*vt+nt*ut,ut=ft)}},D.prototype.guessLen13b=function(U,G){var I=1|Math.max(G,U),C=1&I,L=0;for(I=I/2|0;I;I>>>=1)L++;return 1<<L+1+C},D.prototype.conjugate=function(U,G,I){if(!(I<=1))for(var C=0;C<I/2;C++){var L=U[C];U[C]=U[I-C-1],U[I-C-1]=L,L=G[C],G[C]=-G[I-C-1],G[I-C-1]=-L}},D.prototype.normalize13b=function(U,G){for(var I=0,C=0;C<G/2;C++){var L=8192*Math.round(U[2*C+1]/G)+Math.round(U[2*C]/G)+I;U[C]=67108863&L,I=L<67108864?0:L/67108864|0}return U},D.prototype.convert13b=function(U,G,I,C){for(var L=0,B=0;B<G;B++)L+=0|U[B],I[2*B]=8191&L,L>>>=13,I[2*B+1]=8191&L,L>>>=13;for(B=2*G;B<C;++B)I[B]=0;r(L===0),r((-8192&L)==0)},D.prototype.stub=function(U){for(var G=new Array(U),I=0;I<U;I++)G[I]=0;return G},D.prototype.mulp=function(U,G,I){var C=2*this.guessLen13b(U.length,G.length),L=this.makeRBT(C),B=this.stub(C),O=new Array(C),q=new Array(C),it=new Array(C),nt=new Array(C),lt=new Array(C),ut=new Array(C),vt=I.words;vt.length=C,this.convert13b(U.words,U.length,O,C),this.convert13b(G.words,G.length,nt,C),this.transform(O,B,q,it,C,L),this.transform(nt,B,lt,ut,C,L);for(var Q=0;Q<C;Q++){var gt=q[Q]*lt[Q]-it[Q]*ut[Q];it[Q]=q[Q]*ut[Q]+it[Q]*lt[Q],q[Q]=gt}return this.conjugate(q,it,C),this.transform(q,it,vt,B,C,L),this.conjugate(vt,B,C),this.normalize13b(vt,C),I.negative=U.negative^G.negative,I.length=U.length+G.length,I.strip()},l.prototype.mul=function(U){var G=new l(null);return G.words=new Array(this.length+U.length),this.mulTo(U,G)},l.prototype.mulf=function(U){var G=new l(null);return G.words=new Array(this.length+U.length),E(this,U,G)},l.prototype.imul=function(U){return this.clone().mulTo(U,this)},l.prototype.imuln=function(U){r(typeof U=="number"),r(U<67108864);for(var G=0,I=0;I<this.length;I++){var C=(0|this.words[I])*U,L=(67108863&C)+(67108863&G);G>>=26,G+=C/67108864|0,G+=L>>>26,this.words[I]=67108863&L}return G!==0&&(this.words[I]=G,this.length++),this},l.prototype.muln=function(U){return this.clone().imuln(U)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(U){var G=function(B){for(var O=new Array(B.bitLength()),q=0;q<O.length;q++){var it=q/26|0,nt=q%26;O[q]=(B.words[it]&1<<nt)>>>nt}return O}(U);if(G.length===0)return new l(1);for(var I=this,C=0;C<G.length&&G[C]===0;C++,I=I.sqr());if(++C<G.length)for(var L=I.sqr();C<G.length;C++,L=L.sqr())G[C]!==0&&(I=I.mul(L));return I},l.prototype.iushln=function(U){r(typeof U=="number"&&U>=0);var G,I=U%26,C=(U-I)/26,L=67108863>>>26-I<<26-I;if(I!==0){var B=0;for(G=0;G<this.length;G++){var O=this.words[G]&L,q=(0|this.words[G])-O<<I;this.words[G]=q|B,B=O>>>26-I}B&&(this.words[G]=B,this.length++)}if(C!==0){for(G=this.length-1;G>=0;G--)this.words[G+C]=this.words[G];for(G=0;G<C;G++)this.words[G]=0;this.length+=C}return this.strip()},l.prototype.ishln=function(U){return r(this.negative===0),this.iushln(U)},l.prototype.iushrn=function(U,G,I){var C;r(typeof U=="number"&&U>=0),C=G?(G-G%26)/26:0;var L=U%26,B=Math.min((U-L)/26,this.length),O=67108863^67108863>>>L<<L,q=I;if(C-=B,C=Math.max(0,C),q){for(var it=0;it<B;it++)q.words[it]=this.words[it];q.length=B}if(B!==0)if(this.length>B)for(this.length-=B,it=0;it<this.length;it++)this.words[it]=this.words[it+B];else this.words[0]=0,this.length=1;var nt=0;for(it=this.length-1;it>=0&&(nt!==0||it>=C);it--){var lt=0|this.words[it];this.words[it]=nt<<26-L|lt>>>L,nt=lt&O}return q&&nt!==0&&(q.words[q.length++]=nt),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},l.prototype.ishrn=function(U,G,I){return r(this.negative===0),this.iushrn(U,G,I)},l.prototype.shln=function(U){return this.clone().ishln(U)},l.prototype.ushln=function(U){return this.clone().iushln(U)},l.prototype.shrn=function(U){return this.clone().ishrn(U)},l.prototype.ushrn=function(U){return this.clone().iushrn(U)},l.prototype.testn=function(U){r(typeof U=="number"&&U>=0);var G=U%26,I=(U-G)/26,C=1<<G;return!(this.length<=I)&&!!(this.words[I]&C)},l.prototype.imaskn=function(U){r(typeof U=="number"&&U>=0);var G=U%26,I=(U-G)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=I)return this;if(G!==0&&I++,this.length=Math.min(I,this.length),G!==0){var C=67108863^67108863>>>G<<G;this.words[this.length-1]&=C}return this.strip()},l.prototype.maskn=function(U){return this.clone().imaskn(U)},l.prototype.iaddn=function(U){return r(typeof U=="number"),r(U<67108864),U<0?this.isubn(-U):this.negative!==0?this.length===1&&(0|this.words[0])<U?(this.words[0]=U-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(U),this.negative=1,this):this._iaddn(U)},l.prototype._iaddn=function(U){this.words[0]+=U;for(var G=0;G<this.length&&this.words[G]>=67108864;G++)this.words[G]-=67108864,G===this.length-1?this.words[G+1]=1:this.words[G+1]++;return this.length=Math.max(this.length,G+1),this},l.prototype.isubn=function(U){if(r(typeof U=="number"),r(U<67108864),U<0)return this.iaddn(-U);if(this.negative!==0)return this.negative=0,this.iaddn(U),this.negative=1,this;if(this.words[0]-=U,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var G=0;G<this.length&&this.words[G]<0;G++)this.words[G]+=67108864,this.words[G+1]-=1;return this.strip()},l.prototype.addn=function(U){return this.clone().iaddn(U)},l.prototype.subn=function(U){return this.clone().isubn(U)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(U,G,I){var C,L,B=U.length+I;this._expand(B);var O=0;for(C=0;C<U.length;C++){L=(0|this.words[C+I])+O;var q=(0|U.words[C])*G;O=((L-=67108863&q)>>26)-(q/67108864|0),this.words[C+I]=67108863&L}for(;C<this.length-I;C++)O=(L=(0|this.words[C+I])+O)>>26,this.words[C+I]=67108863&L;if(O===0)return this.strip();for(r(O===-1),O=0,C=0;C<this.length;C++)O=(L=-(0|this.words[C])+O)>>26,this.words[C]=67108863&L;return this.negative=1,this.strip()},l.prototype._wordDiv=function(U,G){var I=(this.length,U.length),C=this.clone(),L=U,B=0|L.words[L.length-1];(I=26-this._countBits(B))!==0&&(L=L.ushln(I),C.iushln(I),B=0|L.words[L.length-1]);var O,q=C.length-L.length;if(G!=="mod"){(O=new l(null)).length=q+1,O.words=new Array(O.length);for(var it=0;it<O.length;it++)O.words[it]=0}var nt=C.clone()._ishlnsubmul(L,1,q);nt.negative===0&&(C=nt,O&&(O.words[q]=1));for(var lt=q-1;lt>=0;lt--){var ut=67108864*(0|C.words[L.length+lt])+(0|C.words[L.length+lt-1]);for(ut=Math.min(ut/B|0,67108863),C._ishlnsubmul(L,ut,lt);C.negative!==0;)ut--,C.negative=0,C._ishlnsubmul(L,1,lt),C.isZero()||(C.negative^=1);O&&(O.words[lt]=ut)}return O&&O.strip(),C.strip(),G!=="div"&&I!==0&&C.iushrn(I),{div:O||null,mod:C}},l.prototype.divmod=function(U,G,I){return r(!U.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&U.negative===0?(B=this.neg().divmod(U,G),G!=="mod"&&(C=B.div.neg()),G!=="div"&&(L=B.mod.neg(),I&&L.negative!==0&&L.iadd(U)),{div:C,mod:L}):this.negative===0&&U.negative!==0?(B=this.divmod(U.neg(),G),G!=="mod"&&(C=B.div.neg()),{div:C,mod:B.mod}):this.negative&U.negative?(B=this.neg().divmod(U.neg(),G),G!=="div"&&(L=B.mod.neg(),I&&L.negative!==0&&L.isub(U)),{div:B.div,mod:L}):U.length>this.length||this.cmp(U)<0?{div:new l(0),mod:this}:U.length===1?G==="div"?{div:this.divn(U.words[0]),mod:null}:G==="mod"?{div:null,mod:new l(this.modn(U.words[0]))}:{div:this.divn(U.words[0]),mod:new l(this.modn(U.words[0]))}:this._wordDiv(U,G);var C,L,B},l.prototype.div=function(U){return this.divmod(U,"div",!1).div},l.prototype.mod=function(U){return this.divmod(U,"mod",!1).mod},l.prototype.umod=function(U){return this.divmod(U,"mod",!0).mod},l.prototype.divRound=function(U){var G=this.divmod(U);if(G.mod.isZero())return G.div;var I=G.div.negative!==0?G.mod.isub(U):G.mod,C=U.ushrn(1),L=U.andln(1),B=I.cmp(C);return B<0||L===1&&B===0?G.div:G.div.negative!==0?G.div.isubn(1):G.div.iaddn(1)},l.prototype.modn=function(U){r(U<=67108863);for(var G=(1<<26)%U,I=0,C=this.length-1;C>=0;C--)I=(G*I+(0|this.words[C]))%U;return I},l.prototype.idivn=function(U){r(U<=67108863);for(var G=0,I=this.length-1;I>=0;I--){var C=(0|this.words[I])+67108864*G;this.words[I]=C/U|0,G=C%U}return this.strip()},l.prototype.divn=function(U){return this.clone().idivn(U)},l.prototype.egcd=function(U){r(U.negative===0),r(!U.isZero());var G=this,I=U.clone();G=G.negative!==0?G.umod(U):G.clone();for(var C=new l(1),L=new l(0),B=new l(0),O=new l(1),q=0;G.isEven()&&I.isEven();)G.iushrn(1),I.iushrn(1),++q;for(var it=I.clone(),nt=G.clone();!G.isZero();){for(var lt=0,ut=1;!(G.words[0]&ut)&&lt<26;++lt,ut<<=1);if(lt>0)for(G.iushrn(lt);lt-- >0;)(C.isOdd()||L.isOdd())&&(C.iadd(it),L.isub(nt)),C.iushrn(1),L.iushrn(1);for(var vt=0,Q=1;!(I.words[0]&Q)&&vt<26;++vt,Q<<=1);if(vt>0)for(I.iushrn(vt);vt-- >0;)(B.isOdd()||O.isOdd())&&(B.iadd(it),O.isub(nt)),B.iushrn(1),O.iushrn(1);G.cmp(I)>=0?(G.isub(I),C.isub(B),L.isub(O)):(I.isub(G),B.isub(C),O.isub(L))}return{a:B,b:O,gcd:I.iushln(q)}},l.prototype._invmp=function(U){r(U.negative===0),r(!U.isZero());var G=this,I=U.clone();G=G.negative!==0?G.umod(U):G.clone();for(var C,L=new l(1),B=new l(0),O=I.clone();G.cmpn(1)>0&&I.cmpn(1)>0;){for(var q=0,it=1;!(G.words[0]&it)&&q<26;++q,it<<=1);if(q>0)for(G.iushrn(q);q-- >0;)L.isOdd()&&L.iadd(O),L.iushrn(1);for(var nt=0,lt=1;!(I.words[0]&lt)&&nt<26;++nt,lt<<=1);if(nt>0)for(I.iushrn(nt);nt-- >0;)B.isOdd()&&B.iadd(O),B.iushrn(1);G.cmp(I)>=0?(G.isub(I),L.isub(B)):(I.isub(G),B.isub(L))}return(C=G.cmpn(1)===0?L:B).cmpn(0)<0&&C.iadd(U),C},l.prototype.gcd=function(U){if(this.isZero())return U.abs();if(U.isZero())return this.abs();var G=this.clone(),I=U.clone();G.negative=0,I.negative=0;for(var C=0;G.isEven()&&I.isEven();C++)G.iushrn(1),I.iushrn(1);for(;;){for(;G.isEven();)G.iushrn(1);for(;I.isEven();)I.iushrn(1);var L=G.cmp(I);if(L<0){var B=G;G=I,I=B}else if(L===0||I.cmpn(1)===0)break;G.isub(I)}return I.iushln(C)},l.prototype.invm=function(U){return this.egcd(U).a.umod(U)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(U){return this.words[0]&U},l.prototype.bincn=function(U){r(typeof U=="number");var G=U%26,I=(U-G)/26,C=1<<G;if(this.length<=I)return this._expand(I+1),this.words[I]|=C,this;for(var L=C,B=I;L!==0&&B<this.length;B++){var O=0|this.words[B];L=(O+=L)>>>26,O&=67108863,this.words[B]=O}return L!==0&&(this.words[B]=L,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(U){var G,I=U<0;if(this.negative!==0&&!I)return-1;if(this.negative===0&&I)return 1;if(this.strip(),this.length>1)G=1;else{I&&(U=-U),r(U<=67108863,"Number is too big");var C=0|this.words[0];G=C===U?0:C<U?-1:1}return this.negative!==0?0|-G:G},l.prototype.cmp=function(U){if(this.negative!==0&&U.negative===0)return-1;if(this.negative===0&&U.negative!==0)return 1;var G=this.ucmp(U);return this.negative!==0?0|-G:G},l.prototype.ucmp=function(U){if(this.length>U.length)return 1;if(this.length<U.length)return-1;for(var G=0,I=this.length-1;I>=0;I--){var C=0|this.words[I],L=0|U.words[I];if(C!==L){C<L?G=-1:C>L&&(G=1);break}}return G},l.prototype.gtn=function(U){return this.cmpn(U)===1},l.prototype.gt=function(U){return this.cmp(U)===1},l.prototype.gten=function(U){return this.cmpn(U)>=0},l.prototype.gte=function(U){return this.cmp(U)>=0},l.prototype.ltn=function(U){return this.cmpn(U)===-1},l.prototype.lt=function(U){return this.cmp(U)===-1},l.prototype.lten=function(U){return this.cmpn(U)<=0},l.prototype.lte=function(U){return this.cmp(U)<=0},l.prototype.eqn=function(U){return this.cmpn(U)===0},l.prototype.eq=function(U){return this.cmp(U)===0},l.red=function(U){return new rt(U)},l.prototype.toRed=function(U){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),U.convertTo(this)._forceRed(U)},l.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(U){return this.red=U,this},l.prototype.forceRed=function(U){return r(!this.red,"Already a number in reduction context"),this._forceRed(U)},l.prototype.redAdd=function(U){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,U)},l.prototype.redIAdd=function(U){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,U)},l.prototype.redSub=function(U){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,U)},l.prototype.redISub=function(U){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,U)},l.prototype.redShl=function(U){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,U)},l.prototype.redMul=function(U){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,U),this.red.mul(this,U)},l.prototype.redIMul=function(U){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,U),this.red.imul(this,U)},l.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(U){return r(this.red&&!U.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,U)};var N={k256:null,p224:null,p192:null,p25519:null};function V(U,G){this.name=U,this.p=new l(G,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K(){V.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function j(){V.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function Z(){V.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function tt(){V.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function rt(U){if(typeof U=="string"){var G=l._prime(U);this.m=G.p,this.prime=G}else r(U.gtn(1),"modulus must be greater than 1"),this.m=U,this.prime=null}function J(U){rt.call(this,U),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}V.prototype._tmp=function(){var U=new l(null);return U.words=new Array(Math.ceil(this.n/13)),U},V.prototype.ireduce=function(U){var G,I=U;do this.split(I,this.tmp),G=(I=(I=this.imulK(I)).iadd(this.tmp)).bitLength();while(G>this.n);var C=G<this.n?-1:I.ucmp(this.p);return C===0?(I.words[0]=0,I.length=1):C>0?I.isub(this.p):I.strip!==void 0?I.strip():I._strip(),I},V.prototype.split=function(U,G){U.iushrn(this.n,0,G)},V.prototype.imulK=function(U){return U.imul(this.k)},u(K,V),K.prototype.split=function(U,G){for(var I=Math.min(U.length,9),C=0;C<I;C++)G.words[C]=U.words[C];if(G.length=I,U.length<=9)return U.words[0]=0,void(U.length=1);var L=U.words[9];for(G.words[G.length++]=4194303&L,C=10;C<U.length;C++){var B=0|U.words[C];U.words[C-10]=(4194303&B)<<4|L>>>22,L=B}L>>>=22,U.words[C-10]=L,L===0&&U.length>10?U.length-=10:U.length-=9},K.prototype.imulK=function(U){U.words[U.length]=0,U.words[U.length+1]=0,U.length+=2;for(var G=0,I=0;I<U.length;I++){var C=0|U.words[I];G+=977*C,U.words[I]=67108863&G,G=64*C+(G/67108864|0)}return U.words[U.length-1]===0&&(U.length--,U.words[U.length-1]===0&&U.length--),U},u(j,V),u(Z,V),u(tt,V),tt.prototype.imulK=function(U){for(var G=0,I=0;I<U.length;I++){var C=19*(0|U.words[I])+G,L=67108863&C;C>>>=26,U.words[I]=L,G=C}return G!==0&&(U.words[U.length++]=G),U},l._prime=function(U){if(N[U])return N[U];var G;if(U==="k256")G=new K;else if(U==="p224")G=new j;else if(U==="p192")G=new Z;else{if(U!=="p25519")throw new Error("Unknown prime "+U);G=new tt}return N[U]=G,G},rt.prototype._verify1=function(U){r(U.negative===0,"red works only with positives"),r(U.red,"red works only with red numbers")},rt.prototype._verify2=function(U,G){r((U.negative|G.negative)==0,"red works only with positives"),r(U.red&&U.red===G.red,"red works only with red numbers")},rt.prototype.imod=function(U){return this.prime?this.prime.ireduce(U)._forceRed(this):U.umod(this.m)._forceRed(this)},rt.prototype.neg=function(U){return U.isZero()?U.clone():this.m.sub(U)._forceRed(this)},rt.prototype.add=function(U,G){this._verify2(U,G);var I=U.add(G);return I.cmp(this.m)>=0&&I.isub(this.m),I._forceRed(this)},rt.prototype.iadd=function(U,G){this._verify2(U,G);var I=U.iadd(G);return I.cmp(this.m)>=0&&I.isub(this.m),I},rt.prototype.sub=function(U,G){this._verify2(U,G);var I=U.sub(G);return I.cmpn(0)<0&&I.iadd(this.m),I._forceRed(this)},rt.prototype.isub=function(U,G){this._verify2(U,G);var I=U.isub(G);return I.cmpn(0)<0&&I.iadd(this.m),I},rt.prototype.shl=function(U,G){return this._verify1(U),this.imod(U.ushln(G))},rt.prototype.imul=function(U,G){return this._verify2(U,G),this.imod(U.imul(G))},rt.prototype.mul=function(U,G){return this._verify2(U,G),this.imod(U.mul(G))},rt.prototype.isqr=function(U){return this.imul(U,U.clone())},rt.prototype.sqr=function(U){return this.mul(U,U)},rt.prototype.sqrt=function(U){if(U.isZero())return U.clone();var G=this.m.andln(3);if(r(G%2==1),G===3){var I=this.m.add(new l(1)).iushrn(2);return this.pow(U,I)}for(var C=this.m.subn(1),L=0;!C.isZero()&&C.andln(1)===0;)L++,C.iushrn(1);r(!C.isZero());var B=new l(1).toRed(this),O=B.redNeg(),q=this.m.subn(1).iushrn(1),it=this.m.bitLength();for(it=new l(2*it*it).toRed(this);this.pow(it,q).cmp(O)!==0;)it.redIAdd(O);for(var nt=this.pow(it,C),lt=this.pow(U,C.addn(1).iushrn(1)),ut=this.pow(U,C),vt=L;ut.cmp(B)!==0;){for(var Q=ut,gt=0;Q.cmp(B)!==0;gt++)Q=Q.redSqr();r(gt<vt);var Y=this.pow(nt,new l(1).iushln(vt-gt-1));lt=lt.redMul(Y),nt=Y.redSqr(),ut=ut.redMul(nt),vt=gt}return lt},rt.prototype.invm=function(U){var G=U._invmp(this.m);return G.negative!==0?(G.negative=0,this.imod(G).redNeg()):this.imod(G)},rt.prototype.pow=function(U,G){if(G.isZero())return new l(1).toRed(this);if(G.cmpn(1)===0)return U.clone();var I=new Array(16);I[0]=new l(1).toRed(this),I[1]=U;for(var C=2;C<I.length;C++)I[C]=this.mul(I[C-1],U);var L=I[0],B=0,O=0,q=G.bitLength()%26;for(q===0&&(q=26),C=G.length-1;C>=0;C--){for(var it=G.words[C],nt=q-1;nt>=0;nt--){var lt=it>>nt&1;L!==I[0]&&(L=this.sqr(L)),lt!==0||B!==0?(B<<=1,B|=lt,(++O===4||C===0&&nt===0)&&(L=this.mul(L,I[B]),O=0,B=0)):O=0}q=26}return L},rt.prototype.convertTo=function(U){var G=U.umod(this.m);return G===U?G.clone():G},rt.prototype.convertFrom=function(U){var G=U.clone();return G.red=null,G},l.mont=function(U){return new J(U)},u(J,rt),J.prototype.convertTo=function(U){return this.imod(U.ushln(this.shift))},J.prototype.convertFrom=function(U){var G=this.imod(U.mul(this.rinv));return G.red=null,G},J.prototype.imul=function(U,G){if(U.isZero()||G.isZero())return U.words[0]=0,U.length=1,U;var I=U.imul(G),C=I.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),L=I.isub(C).iushrn(this.shift),B=L;return L.cmp(this.m)>=0?B=L.isub(this.m):L.cmpn(0)<0&&(B=L.iadd(this.m)),B._forceRed(this)},J.prototype.mul=function(U,G){if(U.isZero()||G.isZero())return new l(0)._forceRed(this);var I=U.mul(G),C=I.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),L=I.isub(C).iushrn(this.shift),B=L;return L.cmp(this.m)>=0?B=L.isub(this.m):L.cmpn(0)<0&&(B=L.iadd(this.m)),B._forceRed(this)},J.prototype.invm=function(U){return this.imod(U._invmp(this.m).mul(this.r2))._forceRed(this)}})(i===void 0||i)},{buffer:188}],185:[function(e,i,s){s.byteLength=function(p){var b=f(p),v=b[0],x=b[1];return 3*(v+x)/4-x},s.toByteArray=function(p){var b,v,x=f(p),w=x[0],M=x[1],E=new r(function(V,K,j){return 3*(K+j)/4-j}(0,w,M)),D=0,N=M>0?w-4:w;for(v=0;v<N;v+=4)b=o[p.charCodeAt(v)]<<18|o[p.charCodeAt(v+1)]<<12|o[p.charCodeAt(v+2)]<<6|o[p.charCodeAt(v+3)],E[D++]=b>>16&255,E[D++]=b>>8&255,E[D++]=255&b;return M===2&&(b=o[p.charCodeAt(v)]<<2|o[p.charCodeAt(v+1)]>>4,E[D++]=255&b),M===1&&(b=o[p.charCodeAt(v)]<<10|o[p.charCodeAt(v+1)]<<4|o[p.charCodeAt(v+2)]>>2,E[D++]=b>>8&255,E[D++]=255&b),E},s.fromByteArray=function(p){for(var b,v=p.length,x=v%3,w=[],M=0,E=v-x;M<E;M+=16383)w.push(d(p,M,M+16383>E?E:M+16383));return x===1?(b=p[v-1],w.push(a[b>>2]+a[b<<4&63]+"==")):x===2&&(b=(p[v-2]<<8)+p[v-1],w.push(a[b>>10]+a[b>>4&63]+a[b<<2&63]+"=")),w.join("")};for(var a=[],o=[],r=typeof Uint8Array!="undefined"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,h=u.length;l<h;++l)a[l]=u[l],o[u.charCodeAt(l)]=l;function f(p){var b=p.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=p.indexOf("=");return v===-1&&(v=b),[v,v===b?0:4-v%4]}function d(p,b,v){for(var x,w,M=[],E=b;E<v;E+=3)x=(p[E]<<16&16711680)+(p[E+1]<<8&65280)+(255&p[E+2]),M.push(a[(w=x)>>18&63]+a[w>>12&63]+a[w>>6&63]+a[63&w]);return M.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],186:[function(e,i,s){(function(a,o){function r(I,C){if(!I)throw new Error(C||"Assertion failed")}function u(I,C){I.super_=C;var L=function(){};L.prototype=C.prototype,I.prototype=new L,I.prototype.constructor=I}function l(I,C,L){if(l.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&(C!=="le"&&C!=="be"||(L=C,C=10),this._init(I||0,C||10,L||"be"))}var h;typeof a=="object"?a.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{h=typeof window!="undefined"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch(I){}function f(I,C){var L=I.charCodeAt(C);return L>=48&&L<=57?L-48:L>=65&&L<=70?L-55:L>=97&&L<=102?L-87:void r(!1,"Invalid character in "+I)}function d(I,C,L){var B=f(I,L);return L-1>=C&&(B|=f(I,L-1)<<4),B}function p(I,C,L,B){for(var O=0,q=0,it=Math.min(I.length,L),nt=C;nt<it;nt++){var lt=I.charCodeAt(nt)-48;O*=B,q=lt>=49?lt-49+10:lt>=17?lt-17+10:lt,r(lt>=0&&q<B,"Invalid character"),O+=q}return O}function b(I,C){I.words=C.words,I.length=C.length,I.negative=C.negative,I.red=C.red}if(l.isBN=function(I){return I instanceof l||I!==null&&typeof I=="object"&&I.constructor.wordSize===l.wordSize&&Array.isArray(I.words)},l.max=function(I,C){return I.cmp(C)>0?I:C},l.min=function(I,C){return I.cmp(C)<0?I:C},l.prototype._init=function(I,C,L){if(typeof I=="number")return this._initNumber(I,C,L);if(typeof I=="object")return this._initArray(I,C,L);C==="hex"&&(C=16),r(C===(0|C)&&C>=2&&C<=36);var B=0;(I=I.toString().replace(/\s+/g,""))[0]==="-"&&(B++,this.negative=1),B<I.length&&(C===16?this._parseHex(I,B,L):(this._parseBase(I,C,B),L==="le"&&this._initArray(this.toArray(),C,L)))},l.prototype._initNumber=function(I,C,L){I<0&&(this.negative=1,I=-I),I<67108864?(this.words=[67108863&I],this.length=1):I<4503599627370496?(this.words=[67108863&I,I/67108864&67108863],this.length=2):(r(I<9007199254740992),this.words=[67108863&I,I/67108864&67108863,1],this.length=3),L==="le"&&this._initArray(this.toArray(),C,L)},l.prototype._initArray=function(I,C,L){if(r(typeof I.length=="number"),I.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(I.length/3),this.words=new Array(this.length);for(var B=0;B<this.length;B++)this.words[B]=0;var O,q,it=0;if(L==="be")for(B=I.length-1,O=0;B>=0;B-=3)q=I[B]|I[B-1]<<8|I[B-2]<<16,this.words[O]|=q<<it&67108863,this.words[O+1]=q>>>26-it&67108863,(it+=24)>=26&&(it-=26,O++);else if(L==="le")for(B=0,O=0;B<I.length;B+=3)q=I[B]|I[B+1]<<8|I[B+2]<<16,this.words[O]|=q<<it&67108863,this.words[O+1]=q>>>26-it&67108863,(it+=24)>=26&&(it-=26,O++);return this._strip()},l.prototype._parseHex=function(I,C,L){this.length=Math.ceil((I.length-C)/6),this.words=new Array(this.length);for(var B=0;B<this.length;B++)this.words[B]=0;var O,q=0,it=0;if(L==="be")for(B=I.length-1;B>=C;B-=2)O=d(I,C,B)<<q,this.words[it]|=67108863&O,q>=18?(q-=18,it+=1,this.words[it]|=O>>>26):q+=8;else for(B=(I.length-C)%2==0?C+1:C;B<I.length;B+=2)O=d(I,C,B)<<q,this.words[it]|=67108863&O,q>=18?(q-=18,it+=1,this.words[it]|=O>>>26):q+=8;this._strip()},l.prototype._parseBase=function(I,C,L){this.words=[0],this.length=1;for(var B=0,O=1;O<=67108863;O*=C)B++;B--,O=O/C|0;for(var q=I.length-L,it=q%B,nt=Math.min(q,q-it)+L,lt=0,ut=L;ut<nt;ut+=B)lt=p(I,ut,ut+B,C),this.imuln(O),this.words[0]+lt<67108864?this.words[0]+=lt:this._iaddn(lt);if(it!==0){var vt=1;for(lt=p(I,ut,I.length,C),ut=0;ut<it;ut++)vt*=C;this.imuln(vt),this.words[0]+lt<67108864?this.words[0]+=lt:this._iaddn(lt)}this._strip()},l.prototype.copy=function(I){I.words=new Array(this.length);for(var C=0;C<this.length;C++)I.words[C]=this.words[C];I.length=this.length,I.negative=this.negative,I.red=this.red},l.prototype._move=function(I){b(I,this)},l.prototype.clone=function(){var I=new l(null);return this.copy(I),I},l.prototype._expand=function(I){for(;this.length<I;)this.words[this.length++]=0;return this},l.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol!="undefined"&&typeof Symbol.for=="function")try{l.prototype[Symbol.for("nodejs.util.inspect.custom")]=v}catch(I){l.prototype.inspect=v}else l.prototype.inspect=v;function v(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var x=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],M=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];l.prototype.toString=function(I,C){var L;if(C=0|C||1,(I=I||10)===16||I==="hex"){L="";for(var B=0,O=0,q=0;q<this.length;q++){var it=this.words[q],nt=(16777215&(it<<B|O)).toString(16);O=it>>>24-B&16777215,(B+=2)>=26&&(B-=26,q--),L=O!==0||q!==this.length-1?x[6-nt.length]+nt+L:nt+L}for(O!==0&&(L=O.toString(16)+L);L.length%C!=0;)L="0"+L;return this.negative!==0&&(L="-"+L),L}if(I===(0|I)&&I>=2&&I<=36){var lt=w[I],ut=M[I];L="";var vt=this.clone();for(vt.negative=0;!vt.isZero();){var Q=vt.modrn(ut).toString(I);L=(vt=vt.idivn(ut)).isZero()?Q+L:x[lt-Q.length]+Q+L}for(this.isZero()&&(L="0"+L);L.length%C!=0;)L="0"+L;return this.negative!==0&&(L="-"+L),L}r(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var I=this.words[0];return this.length===2?I+=67108864*this.words[1]:this.length===3&&this.words[2]===1?I+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-I:I},l.prototype.toJSON=function(){return this.toString(16,2)},h&&(l.prototype.toBuffer=function(I,C){return this.toArrayLike(h,I,C)}),l.prototype.toArray=function(I,C){return this.toArrayLike(Array,I,C)};function E(I,C,L){L.negative=C.negative^I.negative;var B=I.length+C.length|0;L.length=B,B=B-1|0;var O=0|I.words[0],q=0|C.words[0],it=O*q,nt=67108863&it,lt=it/67108864|0;L.words[0]=nt;for(var ut=1;ut<B;ut++){for(var vt=lt>>>26,Q=67108863&lt,gt=Math.min(ut,C.length-1),Y=Math.max(0,ut-I.length+1);Y<=gt;Y++){var H=ut-Y|0;vt+=(it=(O=0|I.words[H])*(q=0|C.words[Y])+Q)/67108864|0,Q=67108863&it}L.words[ut]=0|Q,lt=0|vt}return lt!==0?L.words[ut]=0|lt:L.length--,L._strip()}l.prototype.toArrayLike=function(I,C,L){this._strip();var B=this.byteLength(),O=L||Math.max(1,B);r(B<=O,"byte array longer than desired length"),r(O>0,"Requested array length <= 0");var q=function(it,nt){return it.allocUnsafe?it.allocUnsafe(nt):new it(nt)}(I,O);return this["_toArrayLike"+(C==="le"?"LE":"BE")](q,B),q},l.prototype._toArrayLikeLE=function(I,C){for(var L=0,B=0,O=0,q=0;O<this.length;O++){var it=this.words[O]<<q|B;I[L++]=255&it,L<I.length&&(I[L++]=it>>8&255),L<I.length&&(I[L++]=it>>16&255),q===6?(L<I.length&&(I[L++]=it>>24&255),B=0,q=0):(B=it>>>24,q+=2)}if(L<I.length)for(I[L++]=B;L<I.length;)I[L++]=0},l.prototype._toArrayLikeBE=function(I,C){for(var L=I.length-1,B=0,O=0,q=0;O<this.length;O++){var it=this.words[O]<<q|B;I[L--]=255&it,L>=0&&(I[L--]=it>>8&255),L>=0&&(I[L--]=it>>16&255),q===6?(L>=0&&(I[L--]=it>>24&255),B=0,q=0):(B=it>>>24,q+=2)}if(L>=0)for(I[L--]=B;L>=0;)I[L--]=0},Math.clz32?l.prototype._countBits=function(I){return 32-Math.clz32(I)}:l.prototype._countBits=function(I){var C=I,L=0;return C>=4096&&(L+=13,C>>>=13),C>=64&&(L+=7,C>>>=7),C>=8&&(L+=4,C>>>=4),C>=2&&(L+=2,C>>>=2),L+C},l.prototype._zeroBits=function(I){if(I===0)return 26;var C=I,L=0;return!(8191&C)&&(L+=13,C>>>=13),!(127&C)&&(L+=7,C>>>=7),!(15&C)&&(L+=4,C>>>=4),!(3&C)&&(L+=2,C>>>=2),!(1&C)&&L++,L},l.prototype.bitLength=function(){var I=this.words[this.length-1],C=this._countBits(I);return 26*(this.length-1)+C},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var I=0,C=0;C<this.length;C++){var L=this._zeroBits(this.words[C]);if(I+=L,L!==26)break}return I},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(I){return this.negative!==0?this.abs().inotn(I).iaddn(1):this.clone()},l.prototype.fromTwos=function(I){return this.testn(I-1)?this.notn(I).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(I){for(;this.length<I.length;)this.words[this.length++]=0;for(var C=0;C<I.length;C++)this.words[C]=this.words[C]|I.words[C];return this._strip()},l.prototype.ior=function(I){return r((this.negative|I.negative)==0),this.iuor(I)},l.prototype.or=function(I){return this.length>I.length?this.clone().ior(I):I.clone().ior(this)},l.prototype.uor=function(I){return this.length>I.length?this.clone().iuor(I):I.clone().iuor(this)},l.prototype.iuand=function(I){var C;C=this.length>I.length?I:this;for(var L=0;L<C.length;L++)this.words[L]=this.words[L]&I.words[L];return this.length=C.length,this._strip()},l.prototype.iand=function(I){return r((this.negative|I.negative)==0),this.iuand(I)},l.prototype.and=function(I){return this.length>I.length?this.clone().iand(I):I.clone().iand(this)},l.prototype.uand=function(I){return this.length>I.length?this.clone().iuand(I):I.clone().iuand(this)},l.prototype.iuxor=function(I){var C,L;this.length>I.length?(C=this,L=I):(C=I,L=this);for(var B=0;B<L.length;B++)this.words[B]=C.words[B]^L.words[B];if(this!==C)for(;B<C.length;B++)this.words[B]=C.words[B];return this.length=C.length,this._strip()},l.prototype.ixor=function(I){return r((this.negative|I.negative)==0),this.iuxor(I)},l.prototype.xor=function(I){return this.length>I.length?this.clone().ixor(I):I.clone().ixor(this)},l.prototype.uxor=function(I){return this.length>I.length?this.clone().iuxor(I):I.clone().iuxor(this)},l.prototype.inotn=function(I){r(typeof I=="number"&&I>=0);var C=0|Math.ceil(I/26),L=I%26;this._expand(C),L>0&&C--;for(var B=0;B<C;B++)this.words[B]=67108863&~this.words[B];return L>0&&(this.words[B]=~this.words[B]&67108863>>26-L),this._strip()},l.prototype.notn=function(I){return this.clone().inotn(I)},l.prototype.setn=function(I,C){r(typeof I=="number"&&I>=0);var L=I/26|0,B=I%26;return this._expand(L+1),this.words[L]=C?this.words[L]|1<<B:this.words[L]&~(1<<B),this._strip()},l.prototype.iadd=function(I){var C,L,B;if(this.negative!==0&&I.negative===0)return this.negative=0,C=this.isub(I),this.negative^=1,this._normSign();if(this.negative===0&&I.negative!==0)return I.negative=0,C=this.isub(I),I.negative=1,C._normSign();this.length>I.length?(L=this,B=I):(L=I,B=this);for(var O=0,q=0;q<B.length;q++)C=(0|L.words[q])+(0|B.words[q])+O,this.words[q]=67108863&C,O=C>>>26;for(;O!==0&&q<L.length;q++)C=(0|L.words[q])+O,this.words[q]=67108863&C,O=C>>>26;if(this.length=L.length,O!==0)this.words[this.length]=O,this.length++;else if(L!==this)for(;q<L.length;q++)this.words[q]=L.words[q];return this},l.prototype.add=function(I){var C;return I.negative!==0&&this.negative===0?(I.negative=0,C=this.sub(I),I.negative^=1,C):I.negative===0&&this.negative!==0?(this.negative=0,C=I.sub(this),this.negative=1,C):this.length>I.length?this.clone().iadd(I):I.clone().iadd(this)},l.prototype.isub=function(I){if(I.negative!==0){I.negative=0;var C=this.iadd(I);return I.negative=1,C._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(I),this.negative=1,this._normSign();var L,B,O=this.cmp(I);if(O===0)return this.negative=0,this.length=1,this.words[0]=0,this;O>0?(L=this,B=I):(L=I,B=this);for(var q=0,it=0;it<B.length;it++)q=(C=(0|L.words[it])-(0|B.words[it])+q)>>26,this.words[it]=67108863&C;for(;q!==0&&it<L.length;it++)q=(C=(0|L.words[it])+q)>>26,this.words[it]=67108863&C;if(q===0&&it<L.length&&L!==this)for(;it<L.length;it++)this.words[it]=L.words[it];return this.length=Math.max(this.length,it),L!==this&&(this.negative=1),this._strip()},l.prototype.sub=function(I){return this.clone().isub(I)};var D=function(I,C,L){var B,O,q,it=I.words,nt=C.words,lt=L.words,ut=0,vt=0|it[0],Q=8191&vt,gt=vt>>>13,Y=0|it[1],H=8191&Y,at=Y>>>13,ft=0|it[2],wt=8191&ft,_t=ft>>>13,Dt=0|it[3],Gt=8191&Dt,te=Dt>>>13,mt=0|it[4],At=8191&mt,Ot=mt>>>13,Zt=0|it[5],he=8191&Zt,fe=Zt>>>13,be=0|it[6],Me=8191&be,Pe=be>>>13,ze=0|it[7],Ce=8191&ze,Le=ze>>>13,Ye=0|it[8],le=8191&Ye,Fe=Ye>>>13,Ke=0|it[9],Ze=8191&Ke,ke=Ke>>>13,Qe=0|nt[0],hn=8191&Qe,ln=Qe>>>13,Hn=0|nt[1],Tn=8191&Hn,Sn=Hn>>>13,On=0|nt[2],qn=8191&On,Pn=On>>>13,cr=0|nt[3],Yn=8191&cr,zn=cr>>>13,Qn=0|nt[4],Wt=8191&Qn,St=Qn>>>13,Rt=0|nt[5],jt=8191&Rt,Xt=Rt>>>13,It=0|nt[6],zt=8191&It,Kt=It>>>13,Qt=0|nt[7],me=8191&Qt,ve=Qt>>>13,Xe=0|nt[8],Ee=8191&Xe,$e=Xe>>>13,Tt=0|nt[9],Lt=8191&Tt,ee=Tt>>>13;L.negative=I.negative^C.negative,L.length=19;var Yt=(ut+(B=Math.imul(Q,hn))|0)+((8191&(O=(O=Math.imul(Q,ln))+Math.imul(gt,hn)|0))<<13)|0;ut=((q=Math.imul(gt,ln))+(O>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,B=Math.imul(H,hn),O=(O=Math.imul(H,ln))+Math.imul(at,hn)|0,q=Math.imul(at,ln);var Ve=(ut+(B=B+Math.imul(Q,Tn)|0)|0)+((8191&(O=(O=O+Math.imul(Q,Sn)|0)+Math.imul(gt,Tn)|0))<<13)|0;ut=((q=q+Math.imul(gt,Sn)|0)+(O>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,B=Math.imul(wt,hn),O=(O=Math.imul(wt,ln))+Math.imul(_t,hn)|0,q=Math.imul(_t,ln),B=B+Math.imul(H,Tn)|0,O=(O=O+Math.imul(H,Sn)|0)+Math.imul(at,Tn)|0,q=q+Math.imul(at,Sn)|0;var Ue=(ut+(B=B+Math.imul(Q,qn)|0)|0)+((8191&(O=(O=O+Math.imul(Q,Pn)|0)+Math.imul(gt,qn)|0))<<13)|0;ut=((q=q+Math.imul(gt,Pn)|0)+(O>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,B=Math.imul(Gt,hn),O=(O=Math.imul(Gt,ln))+Math.imul(te,hn)|0,q=Math.imul(te,ln),B=B+Math.imul(wt,Tn)|0,O=(O=O+Math.imul(wt,Sn)|0)+Math.imul(_t,Tn)|0,q=q+Math.imul(_t,Sn)|0,B=B+Math.imul(H,qn)|0,O=(O=O+Math.imul(H,Pn)|0)+Math.imul(at,qn)|0,q=q+Math.imul(at,Pn)|0;var en=(ut+(B=B+Math.imul(Q,Yn)|0)|0)+((8191&(O=(O=O+Math.imul(Q,zn)|0)+Math.imul(gt,Yn)|0))<<13)|0;ut=((q=q+Math.imul(gt,zn)|0)+(O>>>13)|0)+(en>>>26)|0,en&=67108863,B=Math.imul(At,hn),O=(O=Math.imul(At,ln))+Math.imul(Ot,hn)|0,q=Math.imul(Ot,ln),B=B+Math.imul(Gt,Tn)|0,O=(O=O+Math.imul(Gt,Sn)|0)+Math.imul(te,Tn)|0,q=q+Math.imul(te,Sn)|0,B=B+Math.imul(wt,qn)|0,O=(O=O+Math.imul(wt,Pn)|0)+Math.imul(_t,qn)|0,q=q+Math.imul(_t,Pn)|0,B=B+Math.imul(H,Yn)|0,O=(O=O+Math.imul(H,zn)|0)+Math.imul(at,Yn)|0,q=q+Math.imul(at,zn)|0;var gn=(ut+(B=B+Math.imul(Q,Wt)|0)|0)+((8191&(O=(O=O+Math.imul(Q,St)|0)+Math.imul(gt,Wt)|0))<<13)|0;ut=((q=q+Math.imul(gt,St)|0)+(O>>>13)|0)+(gn>>>26)|0,gn&=67108863,B=Math.imul(he,hn),O=(O=Math.imul(he,ln))+Math.imul(fe,hn)|0,q=Math.imul(fe,ln),B=B+Math.imul(At,Tn)|0,O=(O=O+Math.imul(At,Sn)|0)+Math.imul(Ot,Tn)|0,q=q+Math.imul(Ot,Sn)|0,B=B+Math.imul(Gt,qn)|0,O=(O=O+Math.imul(Gt,Pn)|0)+Math.imul(te,qn)|0,q=q+Math.imul(te,Pn)|0,B=B+Math.imul(wt,Yn)|0,O=(O=O+Math.imul(wt,zn)|0)+Math.imul(_t,Yn)|0,q=q+Math.imul(_t,zn)|0,B=B+Math.imul(H,Wt)|0,O=(O=O+Math.imul(H,St)|0)+Math.imul(at,Wt)|0,q=q+Math.imul(at,St)|0;var qt=(ut+(B=B+Math.imul(Q,jt)|0)|0)+((8191&(O=(O=O+Math.imul(Q,Xt)|0)+Math.imul(gt,jt)|0))<<13)|0;ut=((q=q+Math.imul(gt,Xt)|0)+(O>>>13)|0)+(qt>>>26)|0,qt&=67108863,B=Math.imul(Me,hn),O=(O=Math.imul(Me,ln))+Math.imul(Pe,hn)|0,q=Math.imul(Pe,ln),B=B+Math.imul(he,Tn)|0,O=(O=O+Math.imul(he,Sn)|0)+Math.imul(fe,Tn)|0,q=q+Math.imul(fe,Sn)|0,B=B+Math.imul(At,qn)|0,O=(O=O+Math.imul(At,Pn)|0)+Math.imul(Ot,qn)|0,q=q+Math.imul(Ot,Pn)|0,B=B+Math.imul(Gt,Yn)|0,O=(O=O+Math.imul(Gt,zn)|0)+Math.imul(te,Yn)|0,q=q+Math.imul(te,zn)|0,B=B+Math.imul(wt,Wt)|0,O=(O=O+Math.imul(wt,St)|0)+Math.imul(_t,Wt)|0,q=q+Math.imul(_t,St)|0,B=B+Math.imul(H,jt)|0,O=(O=O+Math.imul(H,Xt)|0)+Math.imul(at,jt)|0,q=q+Math.imul(at,Xt)|0;var ye=(ut+(B=B+Math.imul(Q,zt)|0)|0)+((8191&(O=(O=O+Math.imul(Q,Kt)|0)+Math.imul(gt,zt)|0))<<13)|0;ut=((q=q+Math.imul(gt,Kt)|0)+(O>>>13)|0)+(ye>>>26)|0,ye&=67108863,B=Math.imul(Ce,hn),O=(O=Math.imul(Ce,ln))+Math.imul(Le,hn)|0,q=Math.imul(Le,ln),B=B+Math.imul(Me,Tn)|0,O=(O=O+Math.imul(Me,Sn)|0)+Math.imul(Pe,Tn)|0,q=q+Math.imul(Pe,Sn)|0,B=B+Math.imul(he,qn)|0,O=(O=O+Math.imul(he,Pn)|0)+Math.imul(fe,qn)|0,q=q+Math.imul(fe,Pn)|0,B=B+Math.imul(At,Yn)|0,O=(O=O+Math.imul(At,zn)|0)+Math.imul(Ot,Yn)|0,q=q+Math.imul(Ot,zn)|0,B=B+Math.imul(Gt,Wt)|0,O=(O=O+Math.imul(Gt,St)|0)+Math.imul(te,Wt)|0,q=q+Math.imul(te,St)|0,B=B+Math.imul(wt,jt)|0,O=(O=O+Math.imul(wt,Xt)|0)+Math.imul(_t,jt)|0,q=q+Math.imul(_t,Xt)|0,B=B+Math.imul(H,zt)|0,O=(O=O+Math.imul(H,Kt)|0)+Math.imul(at,zt)|0,q=q+Math.imul(at,Kt)|0;var pe=(ut+(B=B+Math.imul(Q,me)|0)|0)+((8191&(O=(O=O+Math.imul(Q,ve)|0)+Math.imul(gt,me)|0))<<13)|0;ut=((q=q+Math.imul(gt,ve)|0)+(O>>>13)|0)+(pe>>>26)|0,pe&=67108863,B=Math.imul(le,hn),O=(O=Math.imul(le,ln))+Math.imul(Fe,hn)|0,q=Math.imul(Fe,ln),B=B+Math.imul(Ce,Tn)|0,O=(O=O+Math.imul(Ce,Sn)|0)+Math.imul(Le,Tn)|0,q=q+Math.imul(Le,Sn)|0,B=B+Math.imul(Me,qn)|0,O=(O=O+Math.imul(Me,Pn)|0)+Math.imul(Pe,qn)|0,q=q+Math.imul(Pe,Pn)|0,B=B+Math.imul(he,Yn)|0,O=(O=O+Math.imul(he,zn)|0)+Math.imul(fe,Yn)|0,q=q+Math.imul(fe,zn)|0,B=B+Math.imul(At,Wt)|0,O=(O=O+Math.imul(At,St)|0)+Math.imul(Ot,Wt)|0,q=q+Math.imul(Ot,St)|0,B=B+Math.imul(Gt,jt)|0,O=(O=O+Math.imul(Gt,Xt)|0)+Math.imul(te,jt)|0,q=q+Math.imul(te,Xt)|0,B=B+Math.imul(wt,zt)|0,O=(O=O+Math.imul(wt,Kt)|0)+Math.imul(_t,zt)|0,q=q+Math.imul(_t,Kt)|0,B=B+Math.imul(H,me)|0,O=(O=O+Math.imul(H,ve)|0)+Math.imul(at,me)|0,q=q+Math.imul(at,ve)|0;var Te=(ut+(B=B+Math.imul(Q,Ee)|0)|0)+((8191&(O=(O=O+Math.imul(Q,$e)|0)+Math.imul(gt,Ee)|0))<<13)|0;ut=((q=q+Math.imul(gt,$e)|0)+(O>>>13)|0)+(Te>>>26)|0,Te&=67108863,B=Math.imul(Ze,hn),O=(O=Math.imul(Ze,ln))+Math.imul(ke,hn)|0,q=Math.imul(ke,ln),B=B+Math.imul(le,Tn)|0,O=(O=O+Math.imul(le,Sn)|0)+Math.imul(Fe,Tn)|0,q=q+Math.imul(Fe,Sn)|0,B=B+Math.imul(Ce,qn)|0,O=(O=O+Math.imul(Ce,Pn)|0)+Math.imul(Le,qn)|0,q=q+Math.imul(Le,Pn)|0,B=B+Math.imul(Me,Yn)|0,O=(O=O+Math.imul(Me,zn)|0)+Math.imul(Pe,Yn)|0,q=q+Math.imul(Pe,zn)|0,B=B+Math.imul(he,Wt)|0,O=(O=O+Math.imul(he,St)|0)+Math.imul(fe,Wt)|0,q=q+Math.imul(fe,St)|0,B=B+Math.imul(At,jt)|0,O=(O=O+Math.imul(At,Xt)|0)+Math.imul(Ot,jt)|0,q=q+Math.imul(Ot,Xt)|0,B=B+Math.imul(Gt,zt)|0,O=(O=O+Math.imul(Gt,Kt)|0)+Math.imul(te,zt)|0,q=q+Math.imul(te,Kt)|0,B=B+Math.imul(wt,me)|0,O=(O=O+Math.imul(wt,ve)|0)+Math.imul(_t,me)|0,q=q+Math.imul(_t,ve)|0,B=B+Math.imul(H,Ee)|0,O=(O=O+Math.imul(H,$e)|0)+Math.imul(at,Ee)|0,q=q+Math.imul(at,$e)|0;var We=(ut+(B=B+Math.imul(Q,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(Q,ee)|0)+Math.imul(gt,Lt)|0))<<13)|0;ut=((q=q+Math.imul(gt,ee)|0)+(O>>>13)|0)+(We>>>26)|0,We&=67108863,B=Math.imul(Ze,Tn),O=(O=Math.imul(Ze,Sn))+Math.imul(ke,Tn)|0,q=Math.imul(ke,Sn),B=B+Math.imul(le,qn)|0,O=(O=O+Math.imul(le,Pn)|0)+Math.imul(Fe,qn)|0,q=q+Math.imul(Fe,Pn)|0,B=B+Math.imul(Ce,Yn)|0,O=(O=O+Math.imul(Ce,zn)|0)+Math.imul(Le,Yn)|0,q=q+Math.imul(Le,zn)|0,B=B+Math.imul(Me,Wt)|0,O=(O=O+Math.imul(Me,St)|0)+Math.imul(Pe,Wt)|0,q=q+Math.imul(Pe,St)|0,B=B+Math.imul(he,jt)|0,O=(O=O+Math.imul(he,Xt)|0)+Math.imul(fe,jt)|0,q=q+Math.imul(fe,Xt)|0,B=B+Math.imul(At,zt)|0,O=(O=O+Math.imul(At,Kt)|0)+Math.imul(Ot,zt)|0,q=q+Math.imul(Ot,Kt)|0,B=B+Math.imul(Gt,me)|0,O=(O=O+Math.imul(Gt,ve)|0)+Math.imul(te,me)|0,q=q+Math.imul(te,ve)|0,B=B+Math.imul(wt,Ee)|0,O=(O=O+Math.imul(wt,$e)|0)+Math.imul(_t,Ee)|0,q=q+Math.imul(_t,$e)|0;var Ie=(ut+(B=B+Math.imul(H,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(H,ee)|0)+Math.imul(at,Lt)|0))<<13)|0;ut=((q=q+Math.imul(at,ee)|0)+(O>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,B=Math.imul(Ze,qn),O=(O=Math.imul(Ze,Pn))+Math.imul(ke,qn)|0,q=Math.imul(ke,Pn),B=B+Math.imul(le,Yn)|0,O=(O=O+Math.imul(le,zn)|0)+Math.imul(Fe,Yn)|0,q=q+Math.imul(Fe,zn)|0,B=B+Math.imul(Ce,Wt)|0,O=(O=O+Math.imul(Ce,St)|0)+Math.imul(Le,Wt)|0,q=q+Math.imul(Le,St)|0,B=B+Math.imul(Me,jt)|0,O=(O=O+Math.imul(Me,Xt)|0)+Math.imul(Pe,jt)|0,q=q+Math.imul(Pe,Xt)|0,B=B+Math.imul(he,zt)|0,O=(O=O+Math.imul(he,Kt)|0)+Math.imul(fe,zt)|0,q=q+Math.imul(fe,Kt)|0,B=B+Math.imul(At,me)|0,O=(O=O+Math.imul(At,ve)|0)+Math.imul(Ot,me)|0,q=q+Math.imul(Ot,ve)|0,B=B+Math.imul(Gt,Ee)|0,O=(O=O+Math.imul(Gt,$e)|0)+Math.imul(te,Ee)|0,q=q+Math.imul(te,$e)|0;var Ge=(ut+(B=B+Math.imul(wt,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(wt,ee)|0)+Math.imul(_t,Lt)|0))<<13)|0;ut=((q=q+Math.imul(_t,ee)|0)+(O>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,B=Math.imul(Ze,Yn),O=(O=Math.imul(Ze,zn))+Math.imul(ke,Yn)|0,q=Math.imul(ke,zn),B=B+Math.imul(le,Wt)|0,O=(O=O+Math.imul(le,St)|0)+Math.imul(Fe,Wt)|0,q=q+Math.imul(Fe,St)|0,B=B+Math.imul(Ce,jt)|0,O=(O=O+Math.imul(Ce,Xt)|0)+Math.imul(Le,jt)|0,q=q+Math.imul(Le,Xt)|0,B=B+Math.imul(Me,zt)|0,O=(O=O+Math.imul(Me,Kt)|0)+Math.imul(Pe,zt)|0,q=q+Math.imul(Pe,Kt)|0,B=B+Math.imul(he,me)|0,O=(O=O+Math.imul(he,ve)|0)+Math.imul(fe,me)|0,q=q+Math.imul(fe,ve)|0,B=B+Math.imul(At,Ee)|0,O=(O=O+Math.imul(At,$e)|0)+Math.imul(Ot,Ee)|0,q=q+Math.imul(Ot,$e)|0;var mn=(ut+(B=B+Math.imul(Gt,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(Gt,ee)|0)+Math.imul(te,Lt)|0))<<13)|0;ut=((q=q+Math.imul(te,ee)|0)+(O>>>13)|0)+(mn>>>26)|0,mn&=67108863,B=Math.imul(Ze,Wt),O=(O=Math.imul(Ze,St))+Math.imul(ke,Wt)|0,q=Math.imul(ke,St),B=B+Math.imul(le,jt)|0,O=(O=O+Math.imul(le,Xt)|0)+Math.imul(Fe,jt)|0,q=q+Math.imul(Fe,Xt)|0,B=B+Math.imul(Ce,zt)|0,O=(O=O+Math.imul(Ce,Kt)|0)+Math.imul(Le,zt)|0,q=q+Math.imul(Le,Kt)|0,B=B+Math.imul(Me,me)|0,O=(O=O+Math.imul(Me,ve)|0)+Math.imul(Pe,me)|0,q=q+Math.imul(Pe,ve)|0,B=B+Math.imul(he,Ee)|0,O=(O=O+Math.imul(he,$e)|0)+Math.imul(fe,Ee)|0,q=q+Math.imul(fe,$e)|0;var In=(ut+(B=B+Math.imul(At,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(At,ee)|0)+Math.imul(Ot,Lt)|0))<<13)|0;ut=((q=q+Math.imul(Ot,ee)|0)+(O>>>13)|0)+(In>>>26)|0,In&=67108863,B=Math.imul(Ze,jt),O=(O=Math.imul(Ze,Xt))+Math.imul(ke,jt)|0,q=Math.imul(ke,Xt),B=B+Math.imul(le,zt)|0,O=(O=O+Math.imul(le,Kt)|0)+Math.imul(Fe,zt)|0,q=q+Math.imul(Fe,Kt)|0,B=B+Math.imul(Ce,me)|0,O=(O=O+Math.imul(Ce,ve)|0)+Math.imul(Le,me)|0,q=q+Math.imul(Le,ve)|0,B=B+Math.imul(Me,Ee)|0,O=(O=O+Math.imul(Me,$e)|0)+Math.imul(Pe,Ee)|0,q=q+Math.imul(Pe,$e)|0;var Wn=(ut+(B=B+Math.imul(he,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(he,ee)|0)+Math.imul(fe,Lt)|0))<<13)|0;ut=((q=q+Math.imul(fe,ee)|0)+(O>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,B=Math.imul(Ze,zt),O=(O=Math.imul(Ze,Kt))+Math.imul(ke,zt)|0,q=Math.imul(ke,Kt),B=B+Math.imul(le,me)|0,O=(O=O+Math.imul(le,ve)|0)+Math.imul(Fe,me)|0,q=q+Math.imul(Fe,ve)|0,B=B+Math.imul(Ce,Ee)|0,O=(O=O+Math.imul(Ce,$e)|0)+Math.imul(Le,Ee)|0,q=q+Math.imul(Le,$e)|0;var vn=(ut+(B=B+Math.imul(Me,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(Me,ee)|0)+Math.imul(Pe,Lt)|0))<<13)|0;ut=((q=q+Math.imul(Pe,ee)|0)+(O>>>13)|0)+(vn>>>26)|0,vn&=67108863,B=Math.imul(Ze,me),O=(O=Math.imul(Ze,ve))+Math.imul(ke,me)|0,q=Math.imul(ke,ve),B=B+Math.imul(le,Ee)|0,O=(O=O+Math.imul(le,$e)|0)+Math.imul(Fe,Ee)|0,q=q+Math.imul(Fe,$e)|0;var jn=(ut+(B=B+Math.imul(Ce,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(Ce,ee)|0)+Math.imul(Le,Lt)|0))<<13)|0;ut=((q=q+Math.imul(Le,ee)|0)+(O>>>13)|0)+(jn>>>26)|0,jn&=67108863,B=Math.imul(Ze,Ee),O=(O=Math.imul(Ze,$e))+Math.imul(ke,Ee)|0,q=Math.imul(ke,$e);var Xn=(ut+(B=B+Math.imul(le,Lt)|0)|0)+((8191&(O=(O=O+Math.imul(le,ee)|0)+Math.imul(Fe,Lt)|0))<<13)|0;ut=((q=q+Math.imul(Fe,ee)|0)+(O>>>13)|0)+(Xn>>>26)|0,Xn&=67108863;var ur=(ut+(B=Math.imul(Ze,Lt))|0)+((8191&(O=(O=Math.imul(Ze,ee))+Math.imul(ke,Lt)|0))<<13)|0;return ut=((q=Math.imul(ke,ee))+(O>>>13)|0)+(ur>>>26)|0,ur&=67108863,lt[0]=Yt,lt[1]=Ve,lt[2]=Ue,lt[3]=en,lt[4]=gn,lt[5]=qt,lt[6]=ye,lt[7]=pe,lt[8]=Te,lt[9]=We,lt[10]=Ie,lt[11]=Ge,lt[12]=mn,lt[13]=In,lt[14]=Wn,lt[15]=vn,lt[16]=jn,lt[17]=Xn,lt[18]=ur,ut!==0&&(lt[19]=ut,L.length++),L};function N(I,C,L){L.negative=C.negative^I.negative,L.length=I.length+C.length;for(var B=0,O=0,q=0;q<L.length-1;q++){var it=O;O=0;for(var nt=67108863&B,lt=Math.min(q,C.length-1),ut=Math.max(0,q-I.length+1);ut<=lt;ut++){var vt=q-ut,Q=(0|I.words[vt])*(0|C.words[ut]),gt=67108863&Q;nt=67108863&(gt=gt+nt|0),O+=(it=(it=it+(Q/67108864|0)|0)+(gt>>>26)|0)>>>26,it&=67108863}L.words[q]=nt,B=it,it=O}return B!==0?L.words[q]=B:L.length--,L._strip()}function V(I,C,L){return N(I,C,L)}Math.imul||(D=E),l.prototype.mulTo=function(I,C){var L=this.length+I.length;return this.length===10&&I.length===10?D(this,I,C):L<63?E(this,I,C):L<1024?N(this,I,C):V(this,I,C)},l.prototype.mul=function(I){var C=new l(null);return C.words=new Array(this.length+I.length),this.mulTo(I,C)},l.prototype.mulf=function(I){var C=new l(null);return C.words=new Array(this.length+I.length),V(this,I,C)},l.prototype.imul=function(I){return this.clone().mulTo(I,this)},l.prototype.imuln=function(I){var C=I<0;C&&(I=-I),r(typeof I=="number"),r(I<67108864);for(var L=0,B=0;B<this.length;B++){var O=(0|this.words[B])*I,q=(67108863&O)+(67108863&L);L>>=26,L+=O/67108864|0,L+=q>>>26,this.words[B]=67108863&q}return L!==0&&(this.words[B]=L,this.length++),C?this.ineg():this},l.prototype.muln=function(I){return this.clone().imuln(I)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(I){var C=function(q){for(var it=new Array(q.bitLength()),nt=0;nt<it.length;nt++){var lt=nt/26|0,ut=nt%26;it[nt]=q.words[lt]>>>ut&1}return it}(I);if(C.length===0)return new l(1);for(var L=this,B=0;B<C.length&&C[B]===0;B++,L=L.sqr());if(++B<C.length)for(var O=L.sqr();B<C.length;B++,O=O.sqr())C[B]!==0&&(L=L.mul(O));return L},l.prototype.iushln=function(I){r(typeof I=="number"&&I>=0);var C,L=I%26,B=(I-L)/26,O=67108863>>>26-L<<26-L;if(L!==0){var q=0;for(C=0;C<this.length;C++){var it=this.words[C]&O,nt=(0|this.words[C])-it<<L;this.words[C]=nt|q,q=it>>>26-L}q&&(this.words[C]=q,this.length++)}if(B!==0){for(C=this.length-1;C>=0;C--)this.words[C+B]=this.words[C];for(C=0;C<B;C++)this.words[C]=0;this.length+=B}return this._strip()},l.prototype.ishln=function(I){return r(this.negative===0),this.iushln(I)},l.prototype.iushrn=function(I,C,L){var B;r(typeof I=="number"&&I>=0),B=C?(C-C%26)/26:0;var O=I%26,q=Math.min((I-O)/26,this.length),it=67108863^67108863>>>O<<O,nt=L;if(B-=q,B=Math.max(0,B),nt){for(var lt=0;lt<q;lt++)nt.words[lt]=this.words[lt];nt.length=q}if(q!==0)if(this.length>q)for(this.length-=q,lt=0;lt<this.length;lt++)this.words[lt]=this.words[lt+q];else this.words[0]=0,this.length=1;var ut=0;for(lt=this.length-1;lt>=0&&(ut!==0||lt>=B);lt--){var vt=0|this.words[lt];this.words[lt]=ut<<26-O|vt>>>O,ut=vt&it}return nt&&ut!==0&&(nt.words[nt.length++]=ut),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},l.prototype.ishrn=function(I,C,L){return r(this.negative===0),this.iushrn(I,C,L)},l.prototype.shln=function(I){return this.clone().ishln(I)},l.prototype.ushln=function(I){return this.clone().iushln(I)},l.prototype.shrn=function(I){return this.clone().ishrn(I)},l.prototype.ushrn=function(I){return this.clone().iushrn(I)},l.prototype.testn=function(I){r(typeof I=="number"&&I>=0);var C=I%26,L=(I-C)/26,B=1<<C;return!(this.length<=L)&&!!(this.words[L]&B)},l.prototype.imaskn=function(I){r(typeof I=="number"&&I>=0);var C=I%26,L=(I-C)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=L)return this;if(C!==0&&L++,this.length=Math.min(L,this.length),C!==0){var B=67108863^67108863>>>C<<C;this.words[this.length-1]&=B}return this._strip()},l.prototype.maskn=function(I){return this.clone().imaskn(I)},l.prototype.iaddn=function(I){return r(typeof I=="number"),r(I<67108864),I<0?this.isubn(-I):this.negative!==0?this.length===1&&(0|this.words[0])<=I?(this.words[0]=I-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(I),this.negative=1,this):this._iaddn(I)},l.prototype._iaddn=function(I){this.words[0]+=I;for(var C=0;C<this.length&&this.words[C]>=67108864;C++)this.words[C]-=67108864,C===this.length-1?this.words[C+1]=1:this.words[C+1]++;return this.length=Math.max(this.length,C+1),this},l.prototype.isubn=function(I){if(r(typeof I=="number"),r(I<67108864),I<0)return this.iaddn(-I);if(this.negative!==0)return this.negative=0,this.iaddn(I),this.negative=1,this;if(this.words[0]-=I,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var C=0;C<this.length&&this.words[C]<0;C++)this.words[C]+=67108864,this.words[C+1]-=1;return this._strip()},l.prototype.addn=function(I){return this.clone().iaddn(I)},l.prototype.subn=function(I){return this.clone().isubn(I)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(I,C,L){var B,O,q=I.length+L;this._expand(q);var it=0;for(B=0;B<I.length;B++){O=(0|this.words[B+L])+it;var nt=(0|I.words[B])*C;it=((O-=67108863&nt)>>26)-(nt/67108864|0),this.words[B+L]=67108863&O}for(;B<this.length-L;B++)it=(O=(0|this.words[B+L])+it)>>26,this.words[B+L]=67108863&O;if(it===0)return this._strip();for(r(it===-1),it=0,B=0;B<this.length;B++)it=(O=-(0|this.words[B])+it)>>26,this.words[B]=67108863&O;return this.negative=1,this._strip()},l.prototype._wordDiv=function(I,C){var L=(this.length,I.length),B=this.clone(),O=I,q=0|O.words[O.length-1];(L=26-this._countBits(q))!==0&&(O=O.ushln(L),B.iushln(L),q=0|O.words[O.length-1]);var it,nt=B.length-O.length;if(C!=="mod"){(it=new l(null)).length=nt+1,it.words=new Array(it.length);for(var lt=0;lt<it.length;lt++)it.words[lt]=0}var ut=B.clone()._ishlnsubmul(O,1,nt);ut.negative===0&&(B=ut,it&&(it.words[nt]=1));for(var vt=nt-1;vt>=0;vt--){var Q=67108864*(0|B.words[O.length+vt])+(0|B.words[O.length+vt-1]);for(Q=Math.min(Q/q|0,67108863),B._ishlnsubmul(O,Q,vt);B.negative!==0;)Q--,B.negative=0,B._ishlnsubmul(O,1,vt),B.isZero()||(B.negative^=1);it&&(it.words[vt]=Q)}return it&&it._strip(),B._strip(),C!=="div"&&L!==0&&B.iushrn(L),{div:it||null,mod:B}},l.prototype.divmod=function(I,C,L){return r(!I.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&I.negative===0?(q=this.neg().divmod(I,C),C!=="mod"&&(B=q.div.neg()),C!=="div"&&(O=q.mod.neg(),L&&O.negative!==0&&O.iadd(I)),{div:B,mod:O}):this.negative===0&&I.negative!==0?(q=this.divmod(I.neg(),C),C!=="mod"&&(B=q.div.neg()),{div:B,mod:q.mod}):this.negative&I.negative?(q=this.neg().divmod(I.neg(),C),C!=="div"&&(O=q.mod.neg(),L&&O.negative!==0&&O.isub(I)),{div:q.div,mod:O}):I.length>this.length||this.cmp(I)<0?{div:new l(0),mod:this}:I.length===1?C==="div"?{div:this.divn(I.words[0]),mod:null}:C==="mod"?{div:null,mod:new l(this.modrn(I.words[0]))}:{div:this.divn(I.words[0]),mod:new l(this.modrn(I.words[0]))}:this._wordDiv(I,C);var B,O,q},l.prototype.div=function(I){return this.divmod(I,"div",!1).div},l.prototype.mod=function(I){return this.divmod(I,"mod",!1).mod},l.prototype.umod=function(I){return this.divmod(I,"mod",!0).mod},l.prototype.divRound=function(I){var C=this.divmod(I);if(C.mod.isZero())return C.div;var L=C.div.negative!==0?C.mod.isub(I):C.mod,B=I.ushrn(1),O=I.andln(1),q=L.cmp(B);return q<0||O===1&&q===0?C.div:C.div.negative!==0?C.div.isubn(1):C.div.iaddn(1)},l.prototype.modrn=function(I){var C=I<0;C&&(I=-I),r(I<=67108863);for(var L=(1<<26)%I,B=0,O=this.length-1;O>=0;O--)B=(L*B+(0|this.words[O]))%I;return C?-B:B},l.prototype.modn=function(I){return this.modrn(I)},l.prototype.idivn=function(I){var C=I<0;C&&(I=-I),r(I<=67108863);for(var L=0,B=this.length-1;B>=0;B--){var O=(0|this.words[B])+67108864*L;this.words[B]=O/I|0,L=O%I}return this._strip(),C?this.ineg():this},l.prototype.divn=function(I){return this.clone().idivn(I)},l.prototype.egcd=function(I){r(I.negative===0),r(!I.isZero());var C=this,L=I.clone();C=C.negative!==0?C.umod(I):C.clone();for(var B=new l(1),O=new l(0),q=new l(0),it=new l(1),nt=0;C.isEven()&&L.isEven();)C.iushrn(1),L.iushrn(1),++nt;for(var lt=L.clone(),ut=C.clone();!C.isZero();){for(var vt=0,Q=1;!(C.words[0]&Q)&&vt<26;++vt,Q<<=1);if(vt>0)for(C.iushrn(vt);vt-- >0;)(B.isOdd()||O.isOdd())&&(B.iadd(lt),O.isub(ut)),B.iushrn(1),O.iushrn(1);for(var gt=0,Y=1;!(L.words[0]&Y)&&gt<26;++gt,Y<<=1);if(gt>0)for(L.iushrn(gt);gt-- >0;)(q.isOdd()||it.isOdd())&&(q.iadd(lt),it.isub(ut)),q.iushrn(1),it.iushrn(1);C.cmp(L)>=0?(C.isub(L),B.isub(q),O.isub(it)):(L.isub(C),q.isub(B),it.isub(O))}return{a:q,b:it,gcd:L.iushln(nt)}},l.prototype._invmp=function(I){r(I.negative===0),r(!I.isZero());var C=this,L=I.clone();C=C.negative!==0?C.umod(I):C.clone();for(var B,O=new l(1),q=new l(0),it=L.clone();C.cmpn(1)>0&&L.cmpn(1)>0;){for(var nt=0,lt=1;!(C.words[0]&lt)&&nt<26;++nt,lt<<=1);if(nt>0)for(C.iushrn(nt);nt-- >0;)O.isOdd()&&O.iadd(it),O.iushrn(1);for(var ut=0,vt=1;!(L.words[0]&vt)&&ut<26;++ut,vt<<=1);if(ut>0)for(L.iushrn(ut);ut-- >0;)q.isOdd()&&q.iadd(it),q.iushrn(1);C.cmp(L)>=0?(C.isub(L),O.isub(q)):(L.isub(C),q.isub(O))}return(B=C.cmpn(1)===0?O:q).cmpn(0)<0&&B.iadd(I),B},l.prototype.gcd=function(I){if(this.isZero())return I.abs();if(I.isZero())return this.abs();var C=this.clone(),L=I.clone();C.negative=0,L.negative=0;for(var B=0;C.isEven()&&L.isEven();B++)C.iushrn(1),L.iushrn(1);for(;;){for(;C.isEven();)C.iushrn(1);for(;L.isEven();)L.iushrn(1);var O=C.cmp(L);if(O<0){var q=C;C=L,L=q}else if(O===0||L.cmpn(1)===0)break;C.isub(L)}return L.iushln(B)},l.prototype.invm=function(I){return this.egcd(I).a.umod(I)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(I){return this.words[0]&I},l.prototype.bincn=function(I){r(typeof I=="number");var C=I%26,L=(I-C)/26,B=1<<C;if(this.length<=L)return this._expand(L+1),this.words[L]|=B,this;for(var O=B,q=L;O!==0&&q<this.length;q++){var it=0|this.words[q];O=(it+=O)>>>26,it&=67108863,this.words[q]=it}return O!==0&&(this.words[q]=O,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(I){var C,L=I<0;if(this.negative!==0&&!L)return-1;if(this.negative===0&&L)return 1;if(this._strip(),this.length>1)C=1;else{L&&(I=-I),r(I<=67108863,"Number is too big");var B=0|this.words[0];C=B===I?0:B<I?-1:1}return this.negative!==0?0|-C:C},l.prototype.cmp=function(I){if(this.negative!==0&&I.negative===0)return-1;if(this.negative===0&&I.negative!==0)return 1;var C=this.ucmp(I);return this.negative!==0?0|-C:C},l.prototype.ucmp=function(I){if(this.length>I.length)return 1;if(this.length<I.length)return-1;for(var C=0,L=this.length-1;L>=0;L--){var B=0|this.words[L],O=0|I.words[L];if(B!==O){B<O?C=-1:B>O&&(C=1);break}}return C},l.prototype.gtn=function(I){return this.cmpn(I)===1},l.prototype.gt=function(I){return this.cmp(I)===1},l.prototype.gten=function(I){return this.cmpn(I)>=0},l.prototype.gte=function(I){return this.cmp(I)>=0},l.prototype.ltn=function(I){return this.cmpn(I)===-1},l.prototype.lt=function(I){return this.cmp(I)===-1},l.prototype.lten=function(I){return this.cmpn(I)<=0},l.prototype.lte=function(I){return this.cmp(I)<=0},l.prototype.eqn=function(I){return this.cmpn(I)===0},l.prototype.eq=function(I){return this.cmp(I)===0},l.red=function(I){return new U(I)},l.prototype.toRed=function(I){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),I.convertTo(this)._forceRed(I)},l.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(I){return this.red=I,this},l.prototype.forceRed=function(I){return r(!this.red,"Already a number in reduction context"),this._forceRed(I)},l.prototype.redAdd=function(I){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,I)},l.prototype.redIAdd=function(I){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,I)},l.prototype.redSub=function(I){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,I)},l.prototype.redISub=function(I){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,I)},l.prototype.redShl=function(I){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,I)},l.prototype.redMul=function(I){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,I),this.red.mul(this,I)},l.prototype.redIMul=function(I){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,I),this.red.imul(this,I)},l.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(I){return r(this.red&&!I.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,I)};var K={k256:null,p224:null,p192:null,p25519:null};function j(I,C){this.name=I,this.p=new l(C,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function Z(){j.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function tt(){j.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function rt(){j.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function J(){j.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function U(I){if(typeof I=="string"){var C=l._prime(I);this.m=C.p,this.prime=C}else r(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}function G(I){U.call(this,I),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}j.prototype._tmp=function(){var I=new l(null);return I.words=new Array(Math.ceil(this.n/13)),I},j.prototype.ireduce=function(I){var C,L=I;do this.split(L,this.tmp),C=(L=(L=this.imulK(L)).iadd(this.tmp)).bitLength();while(C>this.n);var B=C<this.n?-1:L.ucmp(this.p);return B===0?(L.words[0]=0,L.length=1):B>0?L.isub(this.p):L.strip!==void 0?L.strip():L._strip(),L},j.prototype.split=function(I,C){I.iushrn(this.n,0,C)},j.prototype.imulK=function(I){return I.imul(this.k)},u(Z,j),Z.prototype.split=function(I,C){for(var L=Math.min(I.length,9),B=0;B<L;B++)C.words[B]=I.words[B];if(C.length=L,I.length<=9)return I.words[0]=0,void(I.length=1);var O=I.words[9];for(C.words[C.length++]=4194303&O,B=10;B<I.length;B++){var q=0|I.words[B];I.words[B-10]=(4194303&q)<<4|O>>>22,O=q}O>>>=22,I.words[B-10]=O,O===0&&I.length>10?I.length-=10:I.length-=9},Z.prototype.imulK=function(I){I.words[I.length]=0,I.words[I.length+1]=0,I.length+=2;for(var C=0,L=0;L<I.length;L++){var B=0|I.words[L];C+=977*B,I.words[L]=67108863&C,C=64*B+(C/67108864|0)}return I.words[I.length-1]===0&&(I.length--,I.words[I.length-1]===0&&I.length--),I},u(tt,j),u(rt,j),u(J,j),J.prototype.imulK=function(I){for(var C=0,L=0;L<I.length;L++){var B=19*(0|I.words[L])+C,O=67108863&B;B>>>=26,I.words[L]=O,C=B}return C!==0&&(I.words[I.length++]=C),I},l._prime=function(I){if(K[I])return K[I];var C;if(I==="k256")C=new Z;else if(I==="p224")C=new tt;else if(I==="p192")C=new rt;else{if(I!=="p25519")throw new Error("Unknown prime "+I);C=new J}return K[I]=C,C},U.prototype._verify1=function(I){r(I.negative===0,"red works only with positives"),r(I.red,"red works only with red numbers")},U.prototype._verify2=function(I,C){r((I.negative|C.negative)==0,"red works only with positives"),r(I.red&&I.red===C.red,"red works only with red numbers")},U.prototype.imod=function(I){return this.prime?this.prime.ireduce(I)._forceRed(this):(b(I,I.umod(this.m)._forceRed(this)),I)},U.prototype.neg=function(I){return I.isZero()?I.clone():this.m.sub(I)._forceRed(this)},U.prototype.add=function(I,C){this._verify2(I,C);var L=I.add(C);return L.cmp(this.m)>=0&&L.isub(this.m),L._forceRed(this)},U.prototype.iadd=function(I,C){this._verify2(I,C);var L=I.iadd(C);return L.cmp(this.m)>=0&&L.isub(this.m),L},U.prototype.sub=function(I,C){this._verify2(I,C);var L=I.sub(C);return L.cmpn(0)<0&&L.iadd(this.m),L._forceRed(this)},U.prototype.isub=function(I,C){this._verify2(I,C);var L=I.isub(C);return L.cmpn(0)<0&&L.iadd(this.m),L},U.prototype.shl=function(I,C){return this._verify1(I),this.imod(I.ushln(C))},U.prototype.imul=function(I,C){return this._verify2(I,C),this.imod(I.imul(C))},U.prototype.mul=function(I,C){return this._verify2(I,C),this.imod(I.mul(C))},U.prototype.isqr=function(I){return this.imul(I,I.clone())},U.prototype.sqr=function(I){return this.mul(I,I)},U.prototype.sqrt=function(I){if(I.isZero())return I.clone();var C=this.m.andln(3);if(r(C%2==1),C===3){var L=this.m.add(new l(1)).iushrn(2);return this.pow(I,L)}for(var B=this.m.subn(1),O=0;!B.isZero()&&B.andln(1)===0;)O++,B.iushrn(1);r(!B.isZero());var q=new l(1).toRed(this),it=q.redNeg(),nt=this.m.subn(1).iushrn(1),lt=this.m.bitLength();for(lt=new l(2*lt*lt).toRed(this);this.pow(lt,nt).cmp(it)!==0;)lt.redIAdd(it);for(var ut=this.pow(lt,B),vt=this.pow(I,B.addn(1).iushrn(1)),Q=this.pow(I,B),gt=O;Q.cmp(q)!==0;){for(var Y=Q,H=0;Y.cmp(q)!==0;H++)Y=Y.redSqr();r(H<gt);var at=this.pow(ut,new l(1).iushln(gt-H-1));vt=vt.redMul(at),ut=at.redSqr(),Q=Q.redMul(ut),gt=H}return vt},U.prototype.invm=function(I){var C=I._invmp(this.m);return C.negative!==0?(C.negative=0,this.imod(C).redNeg()):this.imod(C)},U.prototype.pow=function(I,C){if(C.isZero())return new l(1).toRed(this);if(C.cmpn(1)===0)return I.clone();var L=new Array(16);L[0]=new l(1).toRed(this),L[1]=I;for(var B=2;B<L.length;B++)L[B]=this.mul(L[B-1],I);var O=L[0],q=0,it=0,nt=C.bitLength()%26;for(nt===0&&(nt=26),B=C.length-1;B>=0;B--){for(var lt=C.words[B],ut=nt-1;ut>=0;ut--){var vt=lt>>ut&1;O!==L[0]&&(O=this.sqr(O)),vt!==0||q!==0?(q<<=1,q|=vt,(++it===4||B===0&&ut===0)&&(O=this.mul(O,L[q]),it=0,q=0)):it=0}nt=26}return O},U.prototype.convertTo=function(I){var C=I.umod(this.m);return C===I?C.clone():C},U.prototype.convertFrom=function(I){var C=I.clone();return C.red=null,C},l.mont=function(I){return new G(I)},u(G,U),G.prototype.convertTo=function(I){return this.imod(I.ushln(this.shift))},G.prototype.convertFrom=function(I){var C=this.imod(I.mul(this.rinv));return C.red=null,C},G.prototype.imul=function(I,C){if(I.isZero()||C.isZero())return I.words[0]=0,I.length=1,I;var L=I.imul(C),B=L.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),O=L.isub(B).iushrn(this.shift),q=O;return O.cmp(this.m)>=0?q=O.isub(this.m):O.cmpn(0)<0&&(q=O.iadd(this.m)),q._forceRed(this)},G.prototype.mul=function(I,C){if(I.isZero()||C.isZero())return new l(0)._forceRed(this);var L=I.mul(C),B=L.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),O=L.isub(B).iushrn(this.shift),q=O;return O.cmp(this.m)>=0?q=O.isub(this.m):O.cmpn(0)<0&&(q=O.iadd(this.m)),q._forceRed(this)},G.prototype.invm=function(I){return this.imod(I._invmp(this.m).mul(this.r2))._forceRed(this)}})(i===void 0||i)},{buffer:188}],187:[function(e,i,s){var a;function o(u){this.rand=u}if(i.exports=function(u){return a||(a=new o(null)),a.generate(u)},i.exports.Rand=o,o.prototype.generate=function(u){return this._rand(u)},o.prototype._rand=function(u){if(this.rand.getBytes)return this.rand.getBytes(u);for(var l=new Uint8Array(u),h=0;h<l.length;h++)l[h]=this.rand.getByte();return l},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(u){var l=new Uint8Array(u);return self.crypto.getRandomValues(l),l}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(u){var l=new Uint8Array(u);return self.msCrypto.getRandomValues(l),l}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var r=e("crypto");if(typeof r.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(u){return r.randomBytes(u)}}catch(u){}},{crypto:188}],188:[function(e,i,s){},{}],189:[function(e,i,s){var a=e("safe-buffer").Buffer;function o(d){a.isBuffer(d)||(d=a.from(d));for(var p=d.length/4|0,b=new Array(p),v=0;v<p;v++)b[v]=d.readUInt32BE(4*v);return b}function r(d){for(;0<d.length;d++)d[0]=0}function u(d,p,b,v,x){for(var w,M,E,D,N=b[0],V=b[1],K=b[2],j=b[3],Z=d[0]^p[0],tt=d[1]^p[1],rt=d[2]^p[2],J=d[3]^p[3],U=4,G=1;G<x;G++)w=N[Z>>>24]^V[tt>>>16&255]^K[rt>>>8&255]^j[255&J]^p[U++],M=N[tt>>>24]^V[rt>>>16&255]^K[J>>>8&255]^j[255&Z]^p[U++],E=N[rt>>>24]^V[J>>>16&255]^K[Z>>>8&255]^j[255&tt]^p[U++],D=N[J>>>24]^V[Z>>>16&255]^K[tt>>>8&255]^j[255&rt]^p[U++],Z=w,tt=M,rt=E,J=D;return w=(v[Z>>>24]<<24|v[tt>>>16&255]<<16|v[rt>>>8&255]<<8|v[255&J])^p[U++],M=(v[tt>>>24]<<24|v[rt>>>16&255]<<16|v[J>>>8&255]<<8|v[255&Z])^p[U++],E=(v[rt>>>24]<<24|v[J>>>16&255]<<16|v[Z>>>8&255]<<8|v[255&tt])^p[U++],D=(v[J>>>24]<<24|v[Z>>>16&255]<<16|v[tt>>>8&255]<<8|v[255&rt])^p[U++],[w>>>=0,M>>>=0,E>>>=0,D>>>=0]}var l=[0,1,2,4,8,16,32,64,128,27,54],h=function(){for(var d=new Array(256),p=0;p<256;p++)d[p]=p<128?p<<1:p<<1^283;for(var b=[],v=[],x=[[],[],[],[]],w=[[],[],[],[]],M=0,E=0,D=0;D<256;++D){var N=E^E<<1^E<<2^E<<3^E<<4;N=N>>>8^255&N^99,b[M]=N,v[N]=M;var V=d[M],K=d[V],j=d[K],Z=257*d[N]^16843008*N;x[0][M]=Z<<24|Z>>>8,x[1][M]=Z<<16|Z>>>16,x[2][M]=Z<<8|Z>>>24,x[3][M]=Z,Z=16843009*j^65537*K^257*V^16843008*M,w[0][N]=Z<<24|Z>>>8,w[1][N]=Z<<16|Z>>>16,w[2][N]=Z<<8|Z>>>24,w[3][N]=Z,M===0?M=E=1:(M=V^d[d[d[j^V]]],E^=d[d[E]])}return{SBOX:b,INV_SBOX:v,SUB_MIX:x,INV_SUB_MIX:w}}();function f(d){this._key=o(d),this._reset()}f.blockSize=16,f.keySize=32,f.prototype.blockSize=f.blockSize,f.prototype.keySize=f.keySize,f.prototype._reset=function(){for(var d=this._key,p=d.length,b=p+6,v=4*(b+1),x=[],w=0;w<p;w++)x[w]=d[w];for(w=p;w<v;w++){var M=x[w-1];w%p==0?(M=M<<8|M>>>24,M=h.SBOX[M>>>24]<<24|h.SBOX[M>>>16&255]<<16|h.SBOX[M>>>8&255]<<8|h.SBOX[255&M],M^=l[w/p|0]<<24):p>6&&w%p==4&&(M=h.SBOX[M>>>24]<<24|h.SBOX[M>>>16&255]<<16|h.SBOX[M>>>8&255]<<8|h.SBOX[255&M]),x[w]=x[w-p]^M}for(var E=[],D=0;D<v;D++){var N=v-D,V=x[N-(D%4?0:4)];E[D]=D<4||N<=4?V:h.INV_SUB_MIX[0][h.SBOX[V>>>24]]^h.INV_SUB_MIX[1][h.SBOX[V>>>16&255]]^h.INV_SUB_MIX[2][h.SBOX[V>>>8&255]]^h.INV_SUB_MIX[3][h.SBOX[255&V]]}this._nRounds=b,this._keySchedule=x,this._invKeySchedule=E},f.prototype.encryptBlockRaw=function(d){return u(d=o(d),this._keySchedule,h.SUB_MIX,h.SBOX,this._nRounds)},f.prototype.encryptBlock=function(d){var p=this.encryptBlockRaw(d),b=a.allocUnsafe(16);return b.writeUInt32BE(p[0],0),b.writeUInt32BE(p[1],4),b.writeUInt32BE(p[2],8),b.writeUInt32BE(p[3],12),b},f.prototype.decryptBlock=function(d){var p=(d=o(d))[1];d[1]=d[3],d[3]=p;var b=u(d,this._invKeySchedule,h.INV_SUB_MIX,h.INV_SBOX,this._nRounds),v=a.allocUnsafe(16);return v.writeUInt32BE(b[0],0),v.writeUInt32BE(b[3],4),v.writeUInt32BE(b[2],8),v.writeUInt32BE(b[1],12),v},f.prototype.scrub=function(){r(this._keySchedule),r(this._invKeySchedule),r(this._key)},i.exports.AES=f},{"safe-buffer":494}],190:[function(e,i,s){var a=e("./aes"),o=e("safe-buffer").Buffer,r=e("cipher-base"),u=e("inherits"),l=e("./ghash"),h=e("buffer-xor"),f=e("./incr32");function d(p,b,v,x){r.call(this);var w=o.alloc(4,0);this._cipher=new a.AES(b);var M=this._cipher.encryptBlock(w);this._ghash=new l(M),v=function(E,D,N){if(D.length===12)return E._finID=o.concat([D,o.from([0,0,0,1])]),o.concat([D,o.from([0,0,0,2])]);var V=new l(N),K=D.length,j=K%16;V.update(D),j&&(j=16-j,V.update(o.alloc(j,0))),V.update(o.alloc(8,0));var Z=8*K,tt=o.alloc(8);tt.writeUIntBE(Z,0,8),V.update(tt),E._finID=V.state;var rt=o.from(E._finID);return f(rt),rt}(this,v,M),this._prev=o.from(v),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=x,this._alen=0,this._len=0,this._mode=p,this._authTag=null,this._called=!1}u(d,r),d.prototype._update=function(p){if(!this._called&&this._alen){var b=16-this._alen%16;b<16&&(b=o.alloc(b,0),this._ghash.update(b))}this._called=!0;var v=this._mode.encrypt(this,p);return this._decrypt?this._ghash.update(p):this._ghash.update(v),this._len+=p.length,v},d.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var p=h(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(b,v){var x=0;b.length!==v.length&&x++;for(var w=Math.min(b.length,v.length),M=0;M<w;++M)x+=b[M]^v[M];return x}(p,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=p,this._cipher.scrub()},d.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},d.prototype.setAuthTag=function(p){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=p},d.prototype.setAAD=function(p){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(p),this._alen+=p.length},i.exports=d},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,i,s){var a=e("./encrypter"),o=e("./decrypter"),r=e("./modes/list.json");s.createCipher=s.Cipher=a.createCipher,s.createCipheriv=s.Cipheriv=a.createCipheriv,s.createDecipher=s.Decipher=o.createDecipher,s.createDecipheriv=s.Decipheriv=o.createDecipheriv,s.listCiphers=s.getCiphers=function(){return Object.keys(r)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,i,s){var a=e("./authCipher"),o=e("safe-buffer").Buffer,r=e("./modes"),u=e("./streamCipher"),l=e("cipher-base"),h=e("./aes"),f=e("evp_bytestokey");function d(v,x,w){l.call(this),this._cache=new p,this._last=void 0,this._cipher=new h.AES(x),this._prev=o.from(w),this._mode=v,this._autopadding=!0}function p(){this.cache=o.allocUnsafe(0)}function b(v,x,w){var M=r[v.toLowerCase()];if(!M)throw new TypeError("invalid suite type");if(typeof w=="string"&&(w=o.from(w)),M.mode!=="GCM"&&w.length!==M.iv)throw new TypeError("invalid iv length "+w.length);if(typeof x=="string"&&(x=o.from(x)),x.length!==M.key/8)throw new TypeError("invalid key length "+x.length);return M.type==="stream"?new u(M.module,x,w,!0):M.type==="auth"?new a(M.module,x,w,!0):new d(M.module,x,w)}e("inherits")(d,l),d.prototype._update=function(v){var x,w;this._cache.add(v);for(var M=[];x=this._cache.get(this._autopadding);)w=this._mode.decrypt(this,x),M.push(w);return o.concat(M)},d.prototype._final=function(){var v=this._cache.flush();if(this._autopadding)return function(x){var w=x[15];if(w<1||w>16)throw new Error("unable to decrypt data");for(var M=-1;++M<w;)if(x[M+(16-w)]!==w)throw new Error("unable to decrypt data");if(w!==16)return x.slice(0,16-w)}(this._mode.decrypt(this,v));if(v)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(v){return this._autopadding=!!v,this},p.prototype.add=function(v){this.cache=o.concat([this.cache,v])},p.prototype.get=function(v){var x;if(v){if(this.cache.length>16)return x=this.cache.slice(0,16),this.cache=this.cache.slice(16),x}else if(this.cache.length>=16)return x=this.cache.slice(0,16),this.cache=this.cache.slice(16),x;return null},p.prototype.flush=function(){if(this.cache.length)return this.cache},s.createDecipher=function(v,x){var w=r[v.toLowerCase()];if(!w)throw new TypeError("invalid suite type");var M=f(x,!1,w.key,w.iv);return b(v,M.key,M.iv)},s.createDecipheriv=b},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,i,s){var a=e("./modes"),o=e("./authCipher"),r=e("safe-buffer").Buffer,u=e("./streamCipher"),l=e("cipher-base"),h=e("./aes"),f=e("evp_bytestokey");function d(x,w,M){l.call(this),this._cache=new b,this._cipher=new h.AES(w),this._prev=r.from(M),this._mode=x,this._autopadding=!0}e("inherits")(d,l),d.prototype._update=function(x){var w,M;this._cache.add(x);for(var E=[];w=this._cache.get();)M=this._mode.encrypt(this,w),E.push(M);return r.concat(E)};var p=r.alloc(16,16);function b(){this.cache=r.allocUnsafe(0)}function v(x,w,M){var E=a[x.toLowerCase()];if(!E)throw new TypeError("invalid suite type");if(typeof w=="string"&&(w=r.from(w)),w.length!==E.key/8)throw new TypeError("invalid key length "+w.length);if(typeof M=="string"&&(M=r.from(M)),E.mode!=="GCM"&&M.length!==E.iv)throw new TypeError("invalid iv length "+M.length);return E.type==="stream"?new u(E.module,w,M):E.type==="auth"?new o(E.module,w,M):new d(E.module,w,M)}d.prototype._final=function(){var x=this._cache.flush();if(this._autopadding)return x=this._mode.encrypt(this,x),this._cipher.scrub(),x;if(!x.equals(p))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(x){return this._autopadding=!!x,this},b.prototype.add=function(x){this.cache=r.concat([this.cache,x])},b.prototype.get=function(){if(this.cache.length>15){var x=this.cache.slice(0,16);return this.cache=this.cache.slice(16),x}return null},b.prototype.flush=function(){for(var x=16-this.cache.length,w=r.allocUnsafe(x),M=-1;++M<x;)w.writeUInt8(x,M);return r.concat([this.cache,w])},s.createCipheriv=v,s.createCipher=function(x,w){var M=a[x.toLowerCase()];if(!M)throw new TypeError("invalid suite type");var E=f(w,!1,M.key,M.iv);return v(x,E.key,E.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,i,s){var a=e("safe-buffer").Buffer,o=a.alloc(16,0);function r(l){var h=a.allocUnsafe(16);return h.writeUInt32BE(l[0]>>>0,0),h.writeUInt32BE(l[1]>>>0,4),h.writeUInt32BE(l[2]>>>0,8),h.writeUInt32BE(l[3]>>>0,12),h}function u(l){this.h=l,this.state=a.alloc(16,0),this.cache=a.allocUnsafe(0)}u.prototype.ghash=function(l){for(var h=-1;++h<l.length;)this.state[h]^=l[h];this._multiply()},u.prototype._multiply=function(){for(var l,h,f,d=[(l=this.h).readUInt32BE(0),l.readUInt32BE(4),l.readUInt32BE(8),l.readUInt32BE(12)],p=[0,0,0,0],b=-1;++b<128;){for(this.state[~~(b/8)]&1<<7-b%8&&(p[0]^=d[0],p[1]^=d[1],p[2]^=d[2],p[3]^=d[3]),f=(1&d[3])!=0,h=3;h>0;h--)d[h]=d[h]>>>1|(1&d[h-1])<<31;d[0]=d[0]>>>1,f&&(d[0]=d[0]^225<<24)}this.state=r(p)},u.prototype.update=function(l){var h;for(this.cache=a.concat([this.cache,l]);this.cache.length>=16;)h=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(h)},u.prototype.final=function(l,h){return this.cache.length&&this.ghash(a.concat([this.cache,o],16)),this.ghash(r([0,l,0,h])),this.state},i.exports=u},{"safe-buffer":494}],195:[function(e,i,s){i.exports=function(a){for(var o,r=a.length;r--;){if((o=a.readUInt8(r))!==255){o++,a.writeUInt8(o,r);break}a.writeUInt8(0,r)}}},{}],196:[function(e,i,s){var a=e("buffer-xor");s.encrypt=function(o,r){var u=a(r,o._prev);return o._prev=o._cipher.encryptBlock(u),o._prev},s.decrypt=function(o,r){var u=o._prev;o._prev=r;var l=o._cipher.decryptBlock(r);return a(l,u)}},{"buffer-xor":219}],197:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("buffer-xor");function r(u,l,h){var f=l.length,d=o(l,u._cache);return u._cache=u._cache.slice(f),u._prev=a.concat([u._prev,h?l:d]),d}s.encrypt=function(u,l,h){for(var f,d=a.allocUnsafe(0);l.length;){if(u._cache.length===0&&(u._cache=u._cipher.encryptBlock(u._prev),u._prev=a.allocUnsafe(0)),!(u._cache.length<=l.length)){d=a.concat([d,r(u,l,h)]);break}f=u._cache.length,d=a.concat([d,r(u,l.slice(0,f),h)]),l=l.slice(f)}return d}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,i,s){var a=e("safe-buffer").Buffer;function o(u,l,h){for(var f,d,p=-1,b=0;++p<8;)f=l&1<<7-p?128:0,b+=(128&(d=u._cipher.encryptBlock(u._prev)[0]^f))>>p%8,u._prev=r(u._prev,h?f:d);return b}function r(u,l){var h=u.length,f=-1,d=a.allocUnsafe(u.length);for(u=a.concat([u,a.from([l])]);++f<h;)d[f]=u[f]<<1|u[f+1]>>7;return d}s.encrypt=function(u,l,h){for(var f=l.length,d=a.allocUnsafe(f),p=-1;++p<f;)d[p]=o(u,l[p],h);return d}},{"safe-buffer":494}],199:[function(e,i,s){var a=e("safe-buffer").Buffer;function o(r,u,l){var h=r._cipher.encryptBlock(r._prev)[0]^u;return r._prev=a.concat([r._prev.slice(1),a.from([l?u:h])]),h}s.encrypt=function(r,u,l){for(var h=u.length,f=a.allocUnsafe(h),d=-1;++d<h;)f[d]=o(r,u[d],l);return f}},{"safe-buffer":494}],200:[function(e,i,s){var a=e("buffer-xor"),o=e("safe-buffer").Buffer,r=e("../incr32");function u(l){var h=l._cipher.encryptBlockRaw(l._prev);return r(l._prev),h}s.encrypt=function(l,h){var f=Math.ceil(h.length/16),d=l._cache.length;l._cache=o.concat([l._cache,o.allocUnsafe(16*f)]);for(var p=0;p<f;p++){var b=u(l),v=d+16*p;l._cache.writeUInt32BE(b[0],v+0),l._cache.writeUInt32BE(b[1],v+4),l._cache.writeUInt32BE(b[2],v+8),l._cache.writeUInt32BE(b[3],v+12)}var x=l._cache.slice(0,h.length);return l._cache=l._cache.slice(h.length),a(h,x)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,i,s){s.encrypt=function(a,o){return a._cipher.encryptBlock(o)},s.decrypt=function(a,o){return a._cipher.decryptBlock(o)}},{}],202:[function(e,i,s){var a={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},o=e("./list.json");for(var r in o)o[r].module=a[o[r].mode];i.exports=o},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,i,s){i.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,i,s){(function(a){(function(){var o=e("buffer-xor");function r(u){return u._prev=u._cipher.encryptBlock(u._prev),u._prev}s.encrypt=function(u,l){for(;u._cache.length<l.length;)u._cache=a.concat([u._cache,r(u)]);var h=u._cache.slice(0,l.length);return u._cache=u._cache.slice(l.length),o(l,h)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,i,s){var a=e("./aes"),o=e("safe-buffer").Buffer,r=e("cipher-base");function u(l,h,f,d){r.call(this),this._cipher=new a.AES(h),this._prev=o.from(f),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=d,this._mode=l}e("inherits")(u,r),u.prototype._update=function(l){return this._mode.encrypt(this,l,this._decrypt)},u.prototype._final=function(){this._cipher.scrub()},i.exports=u},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,i,s){var a=e("browserify-des"),o=e("browserify-aes/browser"),r=e("browserify-aes/modes"),u=e("browserify-des/modes"),l=e("evp_bytestokey");function h(d,p,b){if(d=d.toLowerCase(),r[d])return o.createCipheriv(d,p,b);if(u[d])return new a({key:p,iv:b,mode:d});throw new TypeError("invalid suite type")}function f(d,p,b){if(d=d.toLowerCase(),r[d])return o.createDecipheriv(d,p,b);if(u[d])return new a({key:p,iv:b,mode:d,decrypt:!0});throw new TypeError("invalid suite type")}s.createCipher=s.Cipher=function(d,p){var b,v;if(d=d.toLowerCase(),r[d])b=r[d].key,v=r[d].iv;else{if(!u[d])throw new TypeError("invalid suite type");b=8*u[d].key,v=u[d].iv}var x=l(p,!1,b,v);return h(d,x.key,x.iv)},s.createCipheriv=s.Cipheriv=h,s.createDecipher=s.Decipher=function(d,p){var b,v;if(d=d.toLowerCase(),r[d])b=r[d].key,v=r[d].iv;else{if(!u[d])throw new TypeError("invalid suite type");b=8*u[d].key,v=u[d].iv}var x=l(p,!1,b,v);return f(d,x.key,x.iv)},s.createDecipheriv=s.Decipheriv=f,s.listCiphers=s.getCiphers=function(){return Object.keys(u).concat(o.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,i,s){var a=e("cipher-base"),o=e("des.js"),r=e("inherits"),u=e("safe-buffer").Buffer,l={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};function h(f){a.call(this);var d,p=f.mode.toLowerCase(),b=l[p];d=f.decrypt?"decrypt":"encrypt";var v=f.key;u.isBuffer(v)||(v=u.from(v)),p!=="des-ede"&&p!=="des-ede-cbc"||(v=u.concat([v,v.slice(0,8)]));var x=f.iv;u.isBuffer(x)||(x=u.from(x)),this._des=b.create({key:v,iv:x,type:d})}l.des=l["des-cbc"],l.des3=l["des-ede3-cbc"],i.exports=h,r(h,a),h.prototype._update=function(f){return u.from(this._des.update(f))},h.prototype._final=function(){return u.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,i,s){s["des-ecb"]={key:8,iv:0},s["des-cbc"]=s.des={key:8,iv:8},s["des-ede3-cbc"]=s.des3={key:24,iv:8},s["des-ede3"]={key:24,iv:0},s["des-ede-cbc"]={key:16,iv:8},s["des-ede"]={key:16,iv:0}},{}],209:[function(e,i,s){(function(a){(function(){var o=e("bn.js"),r=e("randombytes");function u(h){var f,d=h.modulus.byteLength();do f=new o(r(d));while(f.cmp(h.modulus)>=0||!f.umod(h.prime1)||!f.umod(h.prime2));return f}function l(h,f){var d=function(K){var j=u(K);return{blinder:j.toRed(o.mont(K.modulus)).redPow(new o(K.publicExponent)).fromRed(),unblinder:j.invm(K.modulus)}}(f),p=f.modulus.byteLength(),b=new o(h).mul(d.blinder).umod(f.modulus),v=b.toRed(o.mont(f.prime1)),x=b.toRed(o.mont(f.prime2)),w=f.coefficient,M=f.prime1,E=f.prime2,D=v.redPow(f.exponent1).fromRed(),N=x.redPow(f.exponent2).fromRed(),V=D.isub(N).imul(w).umod(M).imul(E);return N.iadd(V).imul(d.unblinder).umod(f.modulus).toArrayLike(a,"be",p)}l.getr=u,i.exports=l}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,i,s){i.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,i,s){i.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,i,s){i.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("create-hash"),r=e("readable-stream"),u=e("inherits"),l=e("./sign"),h=e("./verify"),f=e("./algorithms.json");function d(x){r.Writable.call(this);var w=f[x];if(!w)throw new Error("Unknown message digest");this._hashType=w.hash,this._hash=o(w.hash),this._tag=w.id,this._signType=w.sign}function p(x){r.Writable.call(this);var w=f[x];if(!w)throw new Error("Unknown message digest");this._hash=o(w.hash),this._tag=w.id,this._signType=w.sign}function b(x){return new d(x)}function v(x){return new p(x)}Object.keys(f).forEach(function(x){f[x].id=a.from(f[x].id,"hex"),f[x.toLowerCase()]=f[x]}),u(d,r.Writable),d.prototype._write=function(x,w,M){this._hash.update(x),M()},d.prototype.update=function(x,w){return typeof x=="string"&&(x=a.from(x,w)),this._hash.update(x),this},d.prototype.sign=function(x,w){this.end();var M=this._hash.digest(),E=l(M,x,this._hashType,this._signType,this._tag);return w?E.toString(w):E},u(p,r.Writable),p.prototype._write=function(x,w,M){this._hash.update(x),M()},p.prototype.update=function(x,w){return typeof x=="string"&&(x=a.from(x,w)),this._hash.update(x),this},p.prototype.verify=function(x,w,M){typeof w=="string"&&(w=a.from(w,M)),this.end();var E=this._hash.digest();return h(w,E,x,this._signType,this._tag)},i.exports={Sign:b,Verify:v,createSign:b,createVerify:v}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("create-hmac"),r=e("browserify-rsa"),u=e("elliptic").ec,l=e("bn.js"),h=e("parse-asn1"),f=e("./curves.json");function d(x,w,M,E){if((x=a.from(x.toArray())).length<w.byteLength()){var D=a.alloc(w.byteLength()-x.length);x=a.concat([D,x])}var N=M.length,V=function(Z,tt){Z=(Z=p(Z,tt)).mod(tt);var rt=a.from(Z.toArray());if(rt.length<tt.byteLength()){var J=a.alloc(tt.byteLength()-rt.length);rt=a.concat([J,rt])}return rt}(M,w),K=a.alloc(N);K.fill(1);var j=a.alloc(N);return j=o(E,j).update(K).update(a.from([0])).update(x).update(V).digest(),K=o(E,j).update(K).digest(),{k:j=o(E,j).update(K).update(a.from([1])).update(x).update(V).digest(),v:K=o(E,j).update(K).digest()}}function p(x,w){var M=new l(x),E=(x.length<<3)-w.bitLength();return E>0&&M.ishrn(E),M}function b(x,w,M){var E,D;do{for(E=a.alloc(0);8*E.length<x.bitLength();)w.v=o(M,w.k).update(w.v).digest(),E=a.concat([E,w.v]);D=p(E,x),w.k=o(M,w.k).update(w.v).update(a.from([0])).digest(),w.v=o(M,w.k).update(w.v).digest()}while(D.cmp(x)!==-1);return D}function v(x,w,M,E){return x.toRed(l.mont(M)).redPow(w).fromRed().mod(E)}i.exports=function(x,w,M,E,D){var N=h(w);if(N.curve){if(E!=="ecdsa"&&E!=="ecdsa/rsa")throw new Error("wrong private key type");return function(Z,tt){var rt=f[tt.curve.join(".")];if(!rt)throw new Error("unknown curve "+tt.curve.join("."));var J=new u(rt).keyFromPrivate(tt.privateKey).sign(Z);return a.from(J.toDER())}(x,N)}if(N.type==="dsa"){if(E!=="dsa")throw new Error("wrong private key type");return function(Z,tt,rt){for(var J,U=tt.params.priv_key,G=tt.params.p,I=tt.params.q,C=tt.params.g,L=new l(0),B=p(Z,I).mod(I),O=!1,q=d(U,I,Z,rt);O===!1;)J=b(I,q,rt),L=v(C,J,G,I),(O=J.invm(I).imul(B.add(U.mul(L))).mod(I)).cmpn(0)===0&&(O=!1,L=new l(0));return function(it,nt){it=it.toArray(),nt=nt.toArray(),128&it[0]&&(it=[0].concat(it)),128&nt[0]&&(nt=[0].concat(nt));var lt=[48,it.length+nt.length+4,2,it.length];return lt=lt.concat(it,[2,nt.length],nt),a.from(lt)}(L,O)}(x,N,M)}if(E!=="rsa"&&E!=="ecdsa/rsa")throw new Error("wrong private key type");x=a.concat([D,x]);for(var V=N.modulus.byteLength(),K=[0,1];x.length+K.length+1<V;)K.push(255);K.push(0);for(var j=-1;++j<x.length;)K.push(x[j]);return r(K,N)},i.exports.getKey=d,i.exports.makeKey=b},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("bn.js"),r=e("elliptic").ec,u=e("parse-asn1"),l=e("./curves.json");function h(f,d){if(f.cmpn(0)<=0)throw new Error("invalid sig");if(f.cmp(d)>=d)throw new Error("invalid sig")}i.exports=function(f,d,p,b,v){var x=u(p);if(x.type==="ec"){if(b!=="ecdsa"&&b!=="ecdsa/rsa")throw new Error("wrong public key type");return function(K,j,Z){var tt=l[Z.data.algorithm.curve.join(".")];if(!tt)throw new Error("unknown curve "+Z.data.algorithm.curve.join("."));var rt=new r(tt),J=Z.data.subjectPrivateKey.data;return rt.verify(j,K,J)}(f,d,x)}if(x.type==="dsa"){if(b!=="dsa")throw new Error("wrong public key type");return function(K,j,Z){var tt=Z.data.p,rt=Z.data.q,J=Z.data.g,U=Z.data.pub_key,G=u.signature.decode(K,"der"),I=G.s,C=G.r;h(I,rt),h(C,rt);var L=o.mont(tt),B=I.invm(rt);return J.toRed(L).redPow(new o(j).mul(B).mod(rt)).fromRed().mul(U.toRed(L).redPow(C.mul(B).mod(rt)).fromRed()).mod(tt).mod(rt).cmp(C)===0}(f,d,x)}if(b!=="rsa"&&b!=="ecdsa/rsa")throw new Error("wrong public key type");d=a.concat([v,d]);for(var w=x.modulus.byteLength(),M=[1],E=0;d.length+M.length+2<w;)M.push(255),E++;M.push(0);for(var D=-1;++D<d.length;)M.push(d[D]);M=a.from(M);var N=o.mont(x.modulus);f=(f=new o(f).toRed(N)).redPow(new o(x.publicExponent)),f=a.from(f.fromRed().toArray());var V=E<8?1:0;for(w=Math.min(f.length,M.length),f.length!==M.length&&(V=1),D=-1;++D<w;)V|=f[D]^M[D];return V===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,i,s){},{}],217:[function(e,i,s){var a=e("buffer"),o=a.Buffer;function r(l,h){for(var f in l)h[f]=l[f]}function u(l,h,f){return o(l,h,f)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?i.exports=a:(r(a,s),s.Buffer=u),r(o,u),u.from=function(l,h,f){if(typeof l=="number")throw new TypeError("Argument must not be a number");return o(l,h,f)},u.alloc=function(l,h,f){if(typeof l!="number")throw new TypeError("Argument must be a number");var d=o(l);return h!==void 0?typeof f=="string"?d.fill(h,f):d.fill(h):d.fill(0),d},u.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o(l)},u.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(l)}},{buffer:220}],218:[function(e,i,s){var a=e("safe-buffer").Buffer,o=a.isEncoding||function(x){switch((x=""+x)&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(x){var w;switch(this.encoding=function(M){var E=function(D){if(!D)return"utf8";for(var N;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(N)return;D=(""+D).toLowerCase(),N=!0}}(M);if(typeof E!="string"&&(a.isEncoding===o||!o(M)))throw new Error("Unknown encoding: "+M);return E||M}(x),this.encoding){case"utf16le":this.text=h,this.end=f,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=d,this.end=p,w=3;break;default:return this.write=b,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(w)}function u(x){return x<=127?0:x>>5==6?2:x>>4==14?3:x>>3==30?4:x>>6==2?-1:-2}function l(x){var w=this.lastTotal-this.lastNeed,M=function(E,D,N){if((192&D[0])!=128)return E.lastNeed=0,"�";if(E.lastNeed>1&&D.length>1){if((192&D[1])!=128)return E.lastNeed=1,"�";if(E.lastNeed>2&&D.length>2&&(192&D[2])!=128)return E.lastNeed=2,"�"}}(this,x);return M!==void 0?M:this.lastNeed<=x.length?(x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(x.copy(this.lastChar,w,0,x.length),void(this.lastNeed-=x.length))}function h(x,w){if((x.length-w)%2==0){var M=x.toString("utf16le",w);if(M){var E=M.charCodeAt(M.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],M.slice(0,-1)}return M}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function f(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var M=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,M)}return w}function d(x,w){var M=(x.length-w)%3;return M===0?x.toString("base64",w):(this.lastNeed=3-M,this.lastTotal=3,M===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-M))}function p(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}s.StringDecoder=r,r.prototype.write=function(x){if(x.length===0)return"";var w,M;if(this.lastNeed){if((w=this.fillLast(x))===void 0)return"";M=this.lastNeed,this.lastNeed=0}else M=0;return M<x.length?w?w+this.text(x,M):this.text(x,M):w||""},r.prototype.end=function(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"�":w},r.prototype.text=function(x,w){var M=function(D,N,V){var K=N.length-1;if(K<V)return 0;var j=u(N[K]);return j>=0?(j>0&&(D.lastNeed=j-1),j):--K<V||j===-2?0:(j=u(N[K]))>=0?(j>0&&(D.lastNeed=j-2),j):--K<V||j===-2?0:(j=u(N[K]))>=0?(j>0&&(j===2?j=0:D.lastNeed=j-3),j):0}(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=M;var E=x.length-(M-this.lastNeed);return x.copy(this.lastChar,0,E),x.toString("utf8",w,E)},r.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length}},{"safe-buffer":217}],219:[function(e,i,s){(function(a){(function(){i.exports=function(o,r){for(var u=Math.min(o.length,r.length),l=new a(u),h=0;h<u;++h)l[h]=o[h]^r[h];return l}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,i,s){(function(a){(function(){var o=e("base64-js"),r=e("ieee754");s.Buffer=l,s.SlowBuffer=function(Y){return+Y!=Y&&(Y=0),l.alloc(+Y)},s.INSPECT_MAX_BYTES=50;function u(Y){if(Y>2147483647)throw new RangeError('The value "'+Y+'" is invalid for option "size"');var H=new Uint8Array(Y);return H.__proto__=l.prototype,H}function l(Y,H,at){if(typeof Y=="number"){if(typeof H=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(Y)}return h(Y,H,at)}function h(Y,H,at){if(typeof Y=="string")return function(_t,Dt){if(typeof Dt=="string"&&Dt!==""||(Dt="utf8"),!l.isEncoding(Dt))throw new TypeError("Unknown encoding: "+Dt);var Gt=0|v(_t,Dt),te=u(Gt),mt=te.write(_t,Dt);return mt!==Gt&&(te=te.slice(0,mt)),te}(Y,H);if(ArrayBuffer.isView(Y))return p(Y);if(Y==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(Q(Y,ArrayBuffer)||Y&&Q(Y.buffer,ArrayBuffer))return function(_t,Dt,Gt){if(Dt<0||_t.byteLength<Dt)throw new RangeError('"offset" is outside of buffer bounds');if(_t.byteLength<Dt+(Gt||0))throw new RangeError('"length" is outside of buffer bounds');var te;return te=Dt===void 0&&Gt===void 0?new Uint8Array(_t):Gt===void 0?new Uint8Array(_t,Dt):new Uint8Array(_t,Dt,Gt),te.__proto__=l.prototype,te}(Y,H,at);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ft=Y.valueOf&&Y.valueOf();if(ft!=null&&ft!==Y)return l.from(ft,H,at);var wt=function(_t){if(l.isBuffer(_t)){var Dt=0|b(_t.length),Gt=u(Dt);return Gt.length===0||_t.copy(Gt,0,0,Dt),Gt}if(_t.length!==void 0)return typeof _t.length!="number"||gt(_t.length)?u(0):p(_t);if(_t.type==="Buffer"&&Array.isArray(_t.data))return p(_t.data)}(Y);if(wt)return wt;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return l.from(Y[Symbol.toPrimitive]("string"),H,at);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}function f(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function d(Y){return f(Y),u(Y<0?0:0|b(Y))}function p(Y){for(var H=Y.length<0?0:0|b(Y.length),at=u(H),ft=0;ft<H;ft+=1)at[ft]=255&Y[ft];return at}function b(Y){if(Y>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|Y}function v(Y,H){if(l.isBuffer(Y))return Y.length;if(ArrayBuffer.isView(Y)||Q(Y,ArrayBuffer))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);var at=Y.length,ft=arguments.length>2&&arguments[2]===!0;if(!ft&&at===0)return 0;for(var wt=!1;;)switch(H){case"ascii":case"latin1":case"binary":return at;case"utf8":case"utf-8":return lt(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*at;case"hex":return at>>>1;case"base64":return ut(Y).length;default:if(wt)return ft?-1:lt(Y).length;H=(""+H).toLowerCase(),wt=!0}}function x(Y,H,at){var ft=!1;if((H===void 0||H<0)&&(H=0),H>this.length||((at===void 0||at>this.length)&&(at=this.length),at<=0)||(at>>>=0)<=(H>>>=0))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return G(this,H,at);case"utf8":case"utf-8":return rt(this,H,at);case"ascii":return J(this,H,at);case"latin1":case"binary":return U(this,H,at);case"base64":return tt(this,H,at);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,H,at);default:if(ft)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),ft=!0}}function w(Y,H,at){var ft=Y[H];Y[H]=Y[at],Y[at]=ft}function M(Y,H,at,ft,wt){if(Y.length===0)return-1;if(typeof at=="string"?(ft=at,at=0):at>2147483647?at=2147483647:at<-2147483648&&(at=-2147483648),gt(at=+at)&&(at=wt?0:Y.length-1),at<0&&(at=Y.length+at),at>=Y.length){if(wt)return-1;at=Y.length-1}else if(at<0){if(!wt)return-1;at=0}if(typeof H=="string"&&(H=l.from(H,ft)),l.isBuffer(H))return H.length===0?-1:E(Y,H,at,ft,wt);if(typeof H=="number")return H&=255,typeof Uint8Array.prototype.indexOf=="function"?wt?Uint8Array.prototype.indexOf.call(Y,H,at):Uint8Array.prototype.lastIndexOf.call(Y,H,at):E(Y,[H],at,ft,wt);throw new TypeError("val must be string, number or Buffer")}function E(Y,H,at,ft,wt){var _t,Dt=1,Gt=Y.length,te=H.length;if(ft!==void 0&&((ft=String(ft).toLowerCase())==="ucs2"||ft==="ucs-2"||ft==="utf16le"||ft==="utf-16le")){if(Y.length<2||H.length<2)return-1;Dt=2,Gt/=2,te/=2,at/=2}function mt(he,fe){return Dt===1?he[fe]:he.readUInt16BE(fe*Dt)}if(wt){var At=-1;for(_t=at;_t<Gt;_t++)if(mt(Y,_t)===mt(H,At===-1?0:_t-At)){if(At===-1&&(At=_t),_t-At+1===te)return At*Dt}else At!==-1&&(_t-=_t-At),At=-1}else for(at+te>Gt&&(at=Gt-te),_t=at;_t>=0;_t--){for(var Ot=!0,Zt=0;Zt<te;Zt++)if(mt(Y,_t+Zt)!==mt(H,Zt)){Ot=!1;break}if(Ot)return _t}return-1}function D(Y,H,at,ft){at=Number(at)||0;var wt=Y.length-at;ft?(ft=Number(ft))>wt&&(ft=wt):ft=wt;var _t=H.length;ft>_t/2&&(ft=_t/2);for(var Dt=0;Dt<ft;++Dt){var Gt=parseInt(H.substr(2*Dt,2),16);if(gt(Gt))return Dt;Y[at+Dt]=Gt}return Dt}function N(Y,H,at,ft){return vt(lt(H,Y.length-at),Y,at,ft)}function V(Y,H,at,ft){return vt(function(wt){for(var _t=[],Dt=0;Dt<wt.length;++Dt)_t.push(255&wt.charCodeAt(Dt));return _t}(H),Y,at,ft)}function K(Y,H,at,ft){return V(Y,H,at,ft)}function j(Y,H,at,ft){return vt(ut(H),Y,at,ft)}function Z(Y,H,at,ft){return vt(function(wt,_t){for(var Dt,Gt,te,mt=[],At=0;At<wt.length&&!((_t-=2)<0);++At)Dt=wt.charCodeAt(At),Gt=Dt>>8,te=Dt%256,mt.push(te),mt.push(Gt);return mt}(H,Y.length-at),Y,at,ft)}function tt(Y,H,at){return H===0&&at===Y.length?o.fromByteArray(Y):o.fromByteArray(Y.slice(H,at))}function rt(Y,H,at){at=Math.min(Y.length,at);for(var ft=[],wt=H;wt<at;){var _t,Dt,Gt,te,mt=Y[wt],At=null,Ot=mt>239?4:mt>223?3:mt>191?2:1;if(wt+Ot<=at)switch(Ot){case 1:mt<128&&(At=mt);break;case 2:(192&(_t=Y[wt+1]))==128&&(te=(31&mt)<<6|63&_t)>127&&(At=te);break;case 3:_t=Y[wt+1],Dt=Y[wt+2],(192&_t)==128&&(192&Dt)==128&&(te=(15&mt)<<12|(63&_t)<<6|63&Dt)>2047&&(te<55296||te>57343)&&(At=te);break;case 4:_t=Y[wt+1],Dt=Y[wt+2],Gt=Y[wt+3],(192&_t)==128&&(192&Dt)==128&&(192&Gt)==128&&(te=(15&mt)<<18|(63&_t)<<12|(63&Dt)<<6|63&Gt)>65535&&te<1114112&&(At=te)}At===null?(At=65533,Ot=1):At>65535&&(At-=65536,ft.push(At>>>10&1023|55296),At=56320|1023&At),ft.push(At),wt+=Ot}return function(Zt){var he=Zt.length;if(he<=4096)return String.fromCharCode.apply(String,Zt);for(var fe="",be=0;be<he;)fe+=String.fromCharCode.apply(String,Zt.slice(be,be+=4096));return fe}(ft)}s.kMaxLength=2147483647,l.TYPED_ARRAY_SUPPORT=function(){try{var Y=new Uint8Array(1);return Y.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Y.foo()===42}catch(H){return!1}}(),l.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=function(Y,H,at){return h(Y,H,at)},l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(Y,H,at){return function(ft,wt,_t){return f(ft),ft<=0?u(ft):wt!==void 0?typeof _t=="string"?u(ft).fill(wt,_t):u(ft).fill(wt):u(ft)}(Y,H,at)},l.allocUnsafe=function(Y){return d(Y)},l.allocUnsafeSlow=function(Y){return d(Y)},l.isBuffer=function(Y){return Y!=null&&Y._isBuffer===!0&&Y!==l.prototype},l.compare=function(Y,H){if(Q(Y,Uint8Array)&&(Y=l.from(Y,Y.offset,Y.byteLength)),Q(H,Uint8Array)&&(H=l.from(H,H.offset,H.byteLength)),!l.isBuffer(Y)||!l.isBuffer(H))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Y===H)return 0;for(var at=Y.length,ft=H.length,wt=0,_t=Math.min(at,ft);wt<_t;++wt)if(Y[wt]!==H[wt]){at=Y[wt],ft=H[wt];break}return at<ft?-1:ft<at?1:0},l.isEncoding=function(Y){switch(String(Y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(Y,H){if(!Array.isArray(Y))throw new TypeError('"list" argument must be an Array of Buffers');if(Y.length===0)return l.alloc(0);var at;if(H===void 0)for(H=0,at=0;at<Y.length;++at)H+=Y[at].length;var ft=l.allocUnsafe(H),wt=0;for(at=0;at<Y.length;++at){var _t=Y[at];if(Q(_t,Uint8Array)&&(_t=l.from(_t)),!l.isBuffer(_t))throw new TypeError('"list" argument must be an Array of Buffers');_t.copy(ft,wt),wt+=_t.length}return ft},l.byteLength=v,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var Y=this.length;if(Y%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var H=0;H<Y;H+=2)w(this,H,H+1);return this},l.prototype.swap32=function(){var Y=this.length;if(Y%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var H=0;H<Y;H+=4)w(this,H,H+3),w(this,H+1,H+2);return this},l.prototype.swap64=function(){var Y=this.length;if(Y%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var H=0;H<Y;H+=8)w(this,H,H+7),w(this,H+1,H+6),w(this,H+2,H+5),w(this,H+3,H+4);return this},l.prototype.toString=function(){var Y=this.length;return Y===0?"":arguments.length===0?rt(this,0,Y):x.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(Y){if(!l.isBuffer(Y))throw new TypeError("Argument must be a Buffer");return this===Y||l.compare(this,Y)===0},l.prototype.inspect=function(){var Y="",H=s.INSPECT_MAX_BYTES;return Y=this.toString("hex",0,H).replace(/(.{2})/g,"$1 ").trim(),this.length>H&&(Y+=" ... "),"<Buffer "+Y+">"},l.prototype.compare=function(Y,H,at,ft,wt){if(Q(Y,Uint8Array)&&(Y=l.from(Y,Y.offset,Y.byteLength)),!l.isBuffer(Y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Y);if(H===void 0&&(H=0),at===void 0&&(at=Y?Y.length:0),ft===void 0&&(ft=0),wt===void 0&&(wt=this.length),H<0||at>Y.length||ft<0||wt>this.length)throw new RangeError("out of range index");if(ft>=wt&&H>=at)return 0;if(ft>=wt)return-1;if(H>=at)return 1;if(this===Y)return 0;for(var _t=(wt>>>=0)-(ft>>>=0),Dt=(at>>>=0)-(H>>>=0),Gt=Math.min(_t,Dt),te=this.slice(ft,wt),mt=Y.slice(H,at),At=0;At<Gt;++At)if(te[At]!==mt[At]){_t=te[At],Dt=mt[At];break}return _t<Dt?-1:Dt<_t?1:0},l.prototype.includes=function(Y,H,at){return this.indexOf(Y,H,at)!==-1},l.prototype.indexOf=function(Y,H,at){return M(this,Y,H,at,!0)},l.prototype.lastIndexOf=function(Y,H,at){return M(this,Y,H,at,!1)},l.prototype.write=function(Y,H,at,ft){if(H===void 0)ft="utf8",at=this.length,H=0;else if(at===void 0&&typeof H=="string")ft=H,at=this.length,H=0;else{if(!isFinite(H))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");H>>>=0,isFinite(at)?(at>>>=0,ft===void 0&&(ft="utf8")):(ft=at,at=void 0)}var wt=this.length-H;if((at===void 0||at>wt)&&(at=wt),Y.length>0&&(at<0||H<0)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");ft||(ft="utf8");for(var _t=!1;;)switch(ft){case"hex":return D(this,Y,H,at);case"utf8":case"utf-8":return N(this,Y,H,at);case"ascii":return V(this,Y,H,at);case"latin1":case"binary":return K(this,Y,H,at);case"base64":return j(this,Y,H,at);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,Y,H,at);default:if(_t)throw new TypeError("Unknown encoding: "+ft);ft=(""+ft).toLowerCase(),_t=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function J(Y,H,at){var ft="";at=Math.min(Y.length,at);for(var wt=H;wt<at;++wt)ft+=String.fromCharCode(127&Y[wt]);return ft}function U(Y,H,at){var ft="";at=Math.min(Y.length,at);for(var wt=H;wt<at;++wt)ft+=String.fromCharCode(Y[wt]);return ft}function G(Y,H,at){var ft=Y.length;(!H||H<0)&&(H=0),(!at||at<0||at>ft)&&(at=ft);for(var wt="",_t=H;_t<at;++_t)wt+=nt(Y[_t]);return wt}function I(Y,H,at){for(var ft=Y.slice(H,at),wt="",_t=0;_t<ft.length;_t+=2)wt+=String.fromCharCode(ft[_t]+256*ft[_t+1]);return wt}function C(Y,H,at){if(Y%1!=0||Y<0)throw new RangeError("offset is not uint");if(Y+H>at)throw new RangeError("Trying to access beyond buffer length")}function L(Y,H,at,ft,wt,_t){if(!l.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(H>wt||H<_t)throw new RangeError('"value" argument is out of bounds');if(at+ft>Y.length)throw new RangeError("Index out of range")}function B(Y,H,at,ft,wt,_t){if(at+ft>Y.length)throw new RangeError("Index out of range");if(at<0)throw new RangeError("Index out of range")}function O(Y,H,at,ft,wt){return H=+H,at>>>=0,wt||B(Y,0,at,4),r.write(Y,H,at,ft,23,4),at+4}function q(Y,H,at,ft,wt){return H=+H,at>>>=0,wt||B(Y,0,at,8),r.write(Y,H,at,ft,52,8),at+8}l.prototype.slice=function(Y,H){var at=this.length;(Y=~~Y)<0?(Y+=at)<0&&(Y=0):Y>at&&(Y=at),(H=H===void 0?at:~~H)<0?(H+=at)<0&&(H=0):H>at&&(H=at),H<Y&&(H=Y);var ft=this.subarray(Y,H);return ft.__proto__=l.prototype,ft},l.prototype.readUIntLE=function(Y,H,at){Y>>>=0,H>>>=0,at||C(Y,H,this.length);for(var ft=this[Y],wt=1,_t=0;++_t<H&&(wt*=256);)ft+=this[Y+_t]*wt;return ft},l.prototype.readUIntBE=function(Y,H,at){Y>>>=0,H>>>=0,at||C(Y,H,this.length);for(var ft=this[Y+--H],wt=1;H>0&&(wt*=256);)ft+=this[Y+--H]*wt;return ft},l.prototype.readUInt8=function(Y,H){return Y>>>=0,H||C(Y,1,this.length),this[Y]},l.prototype.readUInt16LE=function(Y,H){return Y>>>=0,H||C(Y,2,this.length),this[Y]|this[Y+1]<<8},l.prototype.readUInt16BE=function(Y,H){return Y>>>=0,H||C(Y,2,this.length),this[Y]<<8|this[Y+1]},l.prototype.readUInt32LE=function(Y,H){return Y>>>=0,H||C(Y,4,this.length),(this[Y]|this[Y+1]<<8|this[Y+2]<<16)+16777216*this[Y+3]},l.prototype.readUInt32BE=function(Y,H){return Y>>>=0,H||C(Y,4,this.length),16777216*this[Y]+(this[Y+1]<<16|this[Y+2]<<8|this[Y+3])},l.prototype.readIntLE=function(Y,H,at){Y>>>=0,H>>>=0,at||C(Y,H,this.length);for(var ft=this[Y],wt=1,_t=0;++_t<H&&(wt*=256);)ft+=this[Y+_t]*wt;return ft>=(wt*=128)&&(ft-=Math.pow(2,8*H)),ft},l.prototype.readIntBE=function(Y,H,at){Y>>>=0,H>>>=0,at||C(Y,H,this.length);for(var ft=H,wt=1,_t=this[Y+--ft];ft>0&&(wt*=256);)_t+=this[Y+--ft]*wt;return _t>=(wt*=128)&&(_t-=Math.pow(2,8*H)),_t},l.prototype.readInt8=function(Y,H){return Y>>>=0,H||C(Y,1,this.length),128&this[Y]?-1*(255-this[Y]+1):this[Y]},l.prototype.readInt16LE=function(Y,H){Y>>>=0,H||C(Y,2,this.length);var at=this[Y]|this[Y+1]<<8;return 32768&at?4294901760|at:at},l.prototype.readInt16BE=function(Y,H){Y>>>=0,H||C(Y,2,this.length);var at=this[Y+1]|this[Y]<<8;return 32768&at?4294901760|at:at},l.prototype.readInt32LE=function(Y,H){return Y>>>=0,H||C(Y,4,this.length),this[Y]|this[Y+1]<<8|this[Y+2]<<16|this[Y+3]<<24},l.prototype.readInt32BE=function(Y,H){return Y>>>=0,H||C(Y,4,this.length),this[Y]<<24|this[Y+1]<<16|this[Y+2]<<8|this[Y+3]},l.prototype.readFloatLE=function(Y,H){return Y>>>=0,H||C(Y,4,this.length),r.read(this,Y,!0,23,4)},l.prototype.readFloatBE=function(Y,H){return Y>>>=0,H||C(Y,4,this.length),r.read(this,Y,!1,23,4)},l.prototype.readDoubleLE=function(Y,H){return Y>>>=0,H||C(Y,8,this.length),r.read(this,Y,!0,52,8)},l.prototype.readDoubleBE=function(Y,H){return Y>>>=0,H||C(Y,8,this.length),r.read(this,Y,!1,52,8)},l.prototype.writeUIntLE=function(Y,H,at,ft){Y=+Y,H>>>=0,at>>>=0,ft||L(this,Y,H,at,Math.pow(2,8*at)-1,0);var wt=1,_t=0;for(this[H]=255&Y;++_t<at&&(wt*=256);)this[H+_t]=Y/wt&255;return H+at},l.prototype.writeUIntBE=function(Y,H,at,ft){Y=+Y,H>>>=0,at>>>=0,ft||L(this,Y,H,at,Math.pow(2,8*at)-1,0);var wt=at-1,_t=1;for(this[H+wt]=255&Y;--wt>=0&&(_t*=256);)this[H+wt]=Y/_t&255;return H+at},l.prototype.writeUInt8=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,1,255,0),this[H]=255&Y,H+1},l.prototype.writeUInt16LE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,2,65535,0),this[H]=255&Y,this[H+1]=Y>>>8,H+2},l.prototype.writeUInt16BE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,2,65535,0),this[H]=Y>>>8,this[H+1]=255&Y,H+2},l.prototype.writeUInt32LE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,4,4294967295,0),this[H+3]=Y>>>24,this[H+2]=Y>>>16,this[H+1]=Y>>>8,this[H]=255&Y,H+4},l.prototype.writeUInt32BE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,4,4294967295,0),this[H]=Y>>>24,this[H+1]=Y>>>16,this[H+2]=Y>>>8,this[H+3]=255&Y,H+4},l.prototype.writeIntLE=function(Y,H,at,ft){if(Y=+Y,H>>>=0,!ft){var wt=Math.pow(2,8*at-1);L(this,Y,H,at,wt-1,-wt)}var _t=0,Dt=1,Gt=0;for(this[H]=255&Y;++_t<at&&(Dt*=256);)Y<0&&Gt===0&&this[H+_t-1]!==0&&(Gt=1),this[H+_t]=(Y/Dt>>0)-Gt&255;return H+at},l.prototype.writeIntBE=function(Y,H,at,ft){if(Y=+Y,H>>>=0,!ft){var wt=Math.pow(2,8*at-1);L(this,Y,H,at,wt-1,-wt)}var _t=at-1,Dt=1,Gt=0;for(this[H+_t]=255&Y;--_t>=0&&(Dt*=256);)Y<0&&Gt===0&&this[H+_t+1]!==0&&(Gt=1),this[H+_t]=(Y/Dt>>0)-Gt&255;return H+at},l.prototype.writeInt8=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,1,127,-128),Y<0&&(Y=255+Y+1),this[H]=255&Y,H+1},l.prototype.writeInt16LE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,2,32767,-32768),this[H]=255&Y,this[H+1]=Y>>>8,H+2},l.prototype.writeInt16BE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,2,32767,-32768),this[H]=Y>>>8,this[H+1]=255&Y,H+2},l.prototype.writeInt32LE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,4,2147483647,-2147483648),this[H]=255&Y,this[H+1]=Y>>>8,this[H+2]=Y>>>16,this[H+3]=Y>>>24,H+4},l.prototype.writeInt32BE=function(Y,H,at){return Y=+Y,H>>>=0,at||L(this,Y,H,4,2147483647,-2147483648),Y<0&&(Y=4294967295+Y+1),this[H]=Y>>>24,this[H+1]=Y>>>16,this[H+2]=Y>>>8,this[H+3]=255&Y,H+4},l.prototype.writeFloatLE=function(Y,H,at){return O(this,Y,H,!0,at)},l.prototype.writeFloatBE=function(Y,H,at){return O(this,Y,H,!1,at)},l.prototype.writeDoubleLE=function(Y,H,at){return q(this,Y,H,!0,at)},l.prototype.writeDoubleBE=function(Y,H,at){return q(this,Y,H,!1,at)},l.prototype.copy=function(Y,H,at,ft){if(!l.isBuffer(Y))throw new TypeError("argument should be a Buffer");if(at||(at=0),ft||ft===0||(ft=this.length),H>=Y.length&&(H=Y.length),H||(H=0),ft>0&&ft<at&&(ft=at),ft===at||Y.length===0||this.length===0)return 0;if(H<0)throw new RangeError("targetStart out of bounds");if(at<0||at>=this.length)throw new RangeError("Index out of range");if(ft<0)throw new RangeError("sourceEnd out of bounds");ft>this.length&&(ft=this.length),Y.length-H<ft-at&&(ft=Y.length-H+at);var wt=ft-at;if(this===Y&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(H,at,ft);else if(this===Y&&at<H&&H<ft)for(var _t=wt-1;_t>=0;--_t)Y[_t+H]=this[_t+at];else Uint8Array.prototype.set.call(Y,this.subarray(at,ft),H);return wt},l.prototype.fill=function(Y,H,at,ft){if(typeof Y=="string"){if(typeof H=="string"?(ft=H,H=0,at=this.length):typeof at=="string"&&(ft=at,at=this.length),ft!==void 0&&typeof ft!="string")throw new TypeError("encoding must be a string");if(typeof ft=="string"&&!l.isEncoding(ft))throw new TypeError("Unknown encoding: "+ft);if(Y.length===1){var wt=Y.charCodeAt(0);(ft==="utf8"&&wt<128||ft==="latin1")&&(Y=wt)}}else typeof Y=="number"&&(Y&=255);if(H<0||this.length<H||this.length<at)throw new RangeError("Out of range index");if(at<=H)return this;var _t;if(H>>>=0,at=at===void 0?this.length:at>>>0,Y||(Y=0),typeof Y=="number")for(_t=H;_t<at;++_t)this[_t]=Y;else{var Dt=l.isBuffer(Y)?Y:l.from(Y,ft),Gt=Dt.length;if(Gt===0)throw new TypeError('The value "'+Y+'" is invalid for argument "value"');for(_t=0;_t<at-H;++_t)this[_t+H]=Dt[_t%Gt]}return this};var it=/[^+/0-9A-Za-z-_]/g;function nt(Y){return Y<16?"0"+Y.toString(16):Y.toString(16)}function lt(Y,H){var at;H=H||1/0;for(var ft=Y.length,wt=null,_t=[],Dt=0;Dt<ft;++Dt){if((at=Y.charCodeAt(Dt))>55295&&at<57344){if(!wt){if(at>56319){(H-=3)>-1&&_t.push(239,191,189);continue}if(Dt+1===ft){(H-=3)>-1&&_t.push(239,191,189);continue}wt=at;continue}if(at<56320){(H-=3)>-1&&_t.push(239,191,189),wt=at;continue}at=65536+(wt-55296<<10|at-56320)}else wt&&(H-=3)>-1&&_t.push(239,191,189);if(wt=null,at<128){if((H-=1)<0)break;_t.push(at)}else if(at<2048){if((H-=2)<0)break;_t.push(at>>6|192,63&at|128)}else if(at<65536){if((H-=3)<0)break;_t.push(at>>12|224,at>>6&63|128,63&at|128)}else{if(!(at<1114112))throw new Error("Invalid code point");if((H-=4)<0)break;_t.push(at>>18|240,at>>12&63|128,at>>6&63|128,63&at|128)}}return _t}function ut(Y){return o.toByteArray(function(H){if((H=(H=H.split("=")[0]).trim().replace(it,"")).length<2)return"";for(;H.length%4!=0;)H+="=";return H}(Y))}function vt(Y,H,at,ft){for(var wt=0;wt<ft&&!(wt+at>=H.length||wt>=Y.length);++wt)H[wt+at]=Y[wt];return wt}function Q(Y,H){return Y instanceof H||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===H.name}function gt(Y){return Y!=Y}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("stream").Transform,r=e("string_decoder").StringDecoder;function u(l){o.call(this),this.hashMode=typeof l=="string",this.hashMode?this[l]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(u,o),u.prototype.update=function(l,h,f){typeof l=="string"&&(l=a.from(l,h));var d=this._update(l);return this.hashMode?this:(f&&(d=this._toString(d,f)),d)},u.prototype.setAutoPadding=function(){},u.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},u.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},u.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},u.prototype._transform=function(l,h,f){var d;try{this.hashMode?this._update(l):this.push(this._update(l))}catch(p){d=p}finally{f(d)}},u.prototype._flush=function(l){var h;try{this.push(this.__final())}catch(f){h=f}l(h)},u.prototype._finalOrDigest=function(l){var h=this.__final()||a.alloc(0);return l&&(h=this._toString(h,l,!0)),h},u.prototype._toString=function(l,h,f){if(this._decoder||(this._decoder=new r(h),this._encoding=h),this._encoding!==h)throw new Error("can't switch encodings");var d=this._decoder.write(l);return f&&(d+=this._decoder.end()),d},i.exports=u},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,i,s){var a=e("../internals/is-callable"),o=e("../internals/try-to-string"),r=TypeError;i.exports=function(u){if(a(u))return u;throw new r(o(u)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,i,s){var a=e("../internals/is-constructor"),o=e("../internals/try-to-string"),r=TypeError;i.exports=function(u){if(a(u))return u;throw new r(o(u)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,i,s){var a=e("../internals/is-callable"),o=String,r=TypeError;i.exports=function(u){if(typeof u=="object"||a(u))return u;throw new r("Can't set "+o(u)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,i,s){var a=e("../internals/well-known-symbol"),o=e("../internals/object-create"),r=e("../internals/object-define-property").f,u=a("unscopables"),l=Array.prototype;l[u]===void 0&&r(l,u,{configurable:!0,value:o(null)}),i.exports=function(h){l[u][h]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,i,s){var a=e("../internals/object-is-prototype-of"),o=TypeError;i.exports=function(r,u){if(a(u,r))return r;throw new o("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,i,s){var a=e("../internals/is-object"),o=String,r=TypeError;i.exports=function(u){if(a(u))return u;throw new r(o(u)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,i,s){var a=e("../internals/to-indexed-object"),o=e("../internals/to-absolute-index"),r=e("../internals/length-of-array-like"),u=function(l){return function(h,f,d){var p,b=a(h),v=r(b),x=o(d,v);if(l&&f!=f){for(;v>x;)if((p=b[x++])!=p)return!0}else for(;v>x;x++)if((l||x in b)&&b[x]===f)return l||x||0;return!l&&-1}};i.exports={includes:u(!0),indexOf:u(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,i,s){var a=e("../internals/function-bind-context"),o=e("../internals/function-uncurry-this"),r=e("../internals/indexed-object"),u=e("../internals/to-object"),l=e("../internals/length-of-array-like"),h=e("../internals/array-species-create"),f=o([].push),d=function(p){var b=p===1,v=p===2,x=p===3,w=p===4,M=p===6,E=p===7,D=p===5||M;return function(N,V,K,j){for(var Z,tt,rt=u(N),J=r(rt),U=a(V,K),G=l(J),I=0,C=j||h,L=b?C(N,G):v||E?C(N,0):void 0;G>I;I++)if((D||I in J)&&(tt=U(Z=J[I],I,rt),p))if(b)L[I]=tt;else if(tt)switch(p){case 3:return!0;case 5:return Z;case 6:return I;case 2:f(L,Z)}else switch(p){case 4:return!1;case 7:f(L,Z)}return M?-1:x||w?w:L}};i.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,i,s){var a=e("../internals/to-absolute-index"),o=e("../internals/length-of-array-like"),r=e("../internals/create-property"),u=Array,l=Math.max;i.exports=function(h,f,d){for(var p=o(h),b=a(f,p),v=a(d===void 0?p:d,p),x=u(l(v-b,0)),w=0;b<v;b++,w++)r(x,w,h[b]);return x.length=w,x}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,i,s){var a=e("../internals/function-uncurry-this");i.exports=a([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,i,s){var a=e("../internals/is-array"),o=e("../internals/is-constructor"),r=e("../internals/is-object"),u=e("../internals/well-known-symbol")("species"),l=Array;i.exports=function(h){var f;return a(h)&&(f=h.constructor,(o(f)&&(f===l||a(f.prototype))||r(f)&&(f=f[u])===null)&&(f=void 0)),f===void 0?l:f}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,i,s){var a=e("../internals/array-species-constructor");i.exports=function(o,r){return new(a(o))(r===0?0:r)}},{"../internals/array-species-constructor":232}],234:[function(e,i,s){var a=e("../internals/well-known-symbol")("iterator"),o=!1;try{var r=0,u={next:function(){return{done:!!r++}},return:function(){o=!0}};u[a]=function(){return this},Array.from(u,function(){throw 2})}catch(l){}i.exports=function(l,h){try{if(!h&&!o)return!1}catch(p){return!1}var f=!1;try{var d={};d[a]=function(){return{next:function(){return{done:f=!0}}}},l(d)}catch(p){}return f}},{"../internals/well-known-symbol":357}],235:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=a({}.toString),r=a("".slice);i.exports=function(u){return r(o(u),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,i,s){var a=e("../internals/to-string-tag-support"),o=e("../internals/is-callable"),r=e("../internals/classof-raw"),u=e("../internals/well-known-symbol")("toStringTag"),l=Object,h=r(function(){return arguments}())==="Arguments";i.exports=a?r:function(f){var d,p,b;return f===void 0?"Undefined":f===null?"Null":typeof(p=function(v,x){try{return v[x]}catch(w){}}(d=l(f),u))=="string"?p:h?r(d):(b=r(d))==="Object"&&o(d.callee)?"Arguments":b}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,i,s){var a=e("../internals/has-own-property"),o=e("../internals/own-keys"),r=e("../internals/object-get-own-property-descriptor"),u=e("../internals/object-define-property");i.exports=function(l,h,f){for(var d=o(h),p=u.f,b=r.f,v=0;v<d.length;v++){var x=d[v];a(l,x)||f&&a(f,x)||p(l,x,b(h,x))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,i,s){var a=e("../internals/well-known-symbol")("match");i.exports=function(o){var r=/./;try{"/./"[o](r)}catch(u){try{return r[a]=!1,"/./"[o](r)}catch(l){}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,i,s){var a=e("../internals/fails");i.exports=!a(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},{"../internals/fails":260}],240:[function(e,i,s){i.exports=function(a,o){return{value:a,done:o}}},{}],241:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/object-define-property"),r=e("../internals/create-property-descriptor");i.exports=a?function(u,l,h){return o.f(u,l,r(1,h))}:function(u,l,h){return u[l]=h,u}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,i,s){i.exports=function(a,o){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:o}}},{}],243:[function(e,i,s){var a=e("../internals/to-property-key"),o=e("../internals/object-define-property"),r=e("../internals/create-property-descriptor");i.exports=function(u,l,h){var f=a(l);f in u?o.f(u,f,r(0,h)):u[f]=h}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,i,s){var a=e("../internals/make-built-in"),o=e("../internals/object-define-property");i.exports=function(r,u,l){return l.get&&a(l.get,u,{getter:!0}),l.set&&a(l.set,u,{setter:!0}),o.f(r,u,l)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,i,s){var a=e("../internals/is-callable"),o=e("../internals/object-define-property"),r=e("../internals/make-built-in"),u=e("../internals/define-global-property");i.exports=function(l,h,f,d){d||(d={});var p=d.enumerable,b=d.name!==void 0?d.name:h;if(a(f)&&r(f,b,d),d.global)p?l[h]=f:u(h,f);else{try{d.unsafe?l[h]&&(p=!0):delete l[h]}catch(v){}p?l[h]=f:o.f(l,h,{value:f,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return l}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,i,s){var a=e("../internals/global"),o=Object.defineProperty;i.exports=function(r,u){try{o(a,r,{value:u,configurable:!0,writable:!0})}catch(l){a[r]=u}return u}},{"../internals/global":274}],247:[function(e,i,s){var a=e("../internals/fails");i.exports=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(e,i,s){var a=typeof document=="object"&&document.all,o=a===void 0&&a!==void 0;i.exports={all:a,IS_HTMLDDA:o}},{}],249:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/is-object"),r=a.document,u=o(r)&&o(r.createElement);i.exports=function(l){return u?r.createElement(l):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,i,s){var a=e("../internals/engine-is-deno"),o=e("../internals/engine-is-node");i.exports=!a&&!o&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,i,s){i.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(e,i,s){var a=e("../internals/engine-user-agent");i.exports=/ipad|iphone|ipod/i.test(a)&&typeof Pebble!="undefined"},{"../internals/engine-user-agent":256}],253:[function(e,i,s){var a=e("../internals/engine-user-agent");i.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(a)},{"../internals/engine-user-agent":256}],254:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/classof-raw");i.exports=o(a.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,i,s){var a=e("../internals/engine-user-agent");i.exports=/web0s(?!.*chrome)/i.test(a)},{"../internals/engine-user-agent":256}],256:[function(e,i,s){i.exports=typeof navigator!="undefined"&&String(navigator.userAgent)||""},{}],257:[function(e,i,s){var a,o,r=e("../internals/global"),u=e("../internals/engine-user-agent"),l=r.process,h=r.Deno,f=l&&l.versions||h&&h.version,d=f&&f.v8;d&&(o=(a=d.split("."))[0]>0&&a[0]<4?1:+(a[0]+a[1])),!o&&u&&(!(a=u.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=u.match(/Chrome\/(\d+)/))&&(o=+a[1]),i.exports=o},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,i,s){i.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/object-get-own-property-descriptor").f,r=e("../internals/create-non-enumerable-property"),u=e("../internals/define-built-in"),l=e("../internals/define-global-property"),h=e("../internals/copy-constructor-properties"),f=e("../internals/is-forced");i.exports=function(d,p){var b,v,x,w,M,E=d.target,D=d.global,N=d.stat;if(b=D?a:N?a[E]||l(E,{}):(a[E]||{}).prototype)for(v in p){if(w=p[v],x=d.dontCallGetSet?(M=o(b,v))&&M.value:b[v],!f(D?v:E+(N?".":"#")+v,d.forced)&&x!==void 0){if(typeof w==typeof x)continue;h(w,x)}(d.sham||x&&x.sham)&&r(w,"sham",!0),u(b,v,w,d)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,i,s){i.exports=function(a){try{return!!a()}catch(o){return!0}}},{}],261:[function(e,i,s){var a=e("../internals/function-bind-native"),o=Function.prototype,r=o.apply,u=o.call;i.exports=typeof Reflect=="object"&&Reflect.apply||(a?u.bind(r):function(){return u.apply(r,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,i,s){var a=e("../internals/function-uncurry-this-clause"),o=e("../internals/a-callable"),r=e("../internals/function-bind-native"),u=a(a.bind);i.exports=function(l,h){return o(l),h===void 0?l:r?u(l,h):function(){return l.apply(h,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,i,s){var a=e("../internals/fails");i.exports=!a(function(){var o=function(){}.bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,i,s){var a=e("../internals/function-bind-native"),o=Function.prototype.call;i.exports=a?o.bind(o):function(){return o.apply(o,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/has-own-property"),r=Function.prototype,u=a&&Object.getOwnPropertyDescriptor,l=o(r,"name"),h=l&&function(){}.name==="something",f=l&&(!a||a&&u(r,"name").configurable);i.exports={EXISTS:l,PROPER:h,CONFIGURABLE:f}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/a-callable");i.exports=function(r,u,l){try{return a(o(Object.getOwnPropertyDescriptor(r,u)[l]))}catch(h){}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,i,s){var a=e("../internals/classof-raw"),o=e("../internals/function-uncurry-this");i.exports=function(r){if(a(r)==="Function")return o(r)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,i,s){var a=e("../internals/function-bind-native"),o=Function.prototype,r=o.call,u=a&&o.bind.bind(r,r);i.exports=a?u:function(l){return function(){return r.apply(l,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/is-callable"),r=function(u){return o(u)?u:void 0};i.exports=function(u,l){return arguments.length<2?r(a[u]):a[u]&&a[u][l]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,i,s){var a=e("../internals/classof"),o=e("../internals/get-method"),r=e("../internals/is-null-or-undefined"),u=e("../internals/iterators"),l=e("../internals/well-known-symbol")("iterator");i.exports=function(h){if(!r(h))return o(h,l)||o(h,"@@iterator")||u[a(h)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,i,s){var a=e("../internals/function-call"),o=e("../internals/a-callable"),r=e("../internals/an-object"),u=e("../internals/try-to-string"),l=e("../internals/get-iterator-method"),h=TypeError;i.exports=function(f,d){var p=arguments.length<2?l(f):d;if(o(p))return r(a(p,f));throw new h(u(f)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/is-array"),r=e("../internals/is-callable"),u=e("../internals/classof-raw"),l=e("../internals/to-string"),h=a([].push);i.exports=function(f){if(r(f))return f;if(o(f)){for(var d=f.length,p=[],b=0;b<d;b++){var v=f[b];typeof v=="string"?h(p,v):typeof v!="number"&&u(v)!=="Number"&&u(v)!=="String"||h(p,l(v))}var x=p.length,w=!0;return function(M,E){if(w)return w=!1,E;if(o(this))return E;for(var D=0;D<x;D++)if(p[D]===M)return E}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,i,s){var a=e("../internals/a-callable"),o=e("../internals/is-null-or-undefined");i.exports=function(r,u){var l=r[u];return o(l)?void 0:a(l)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,i,s){(function(a){(function(){var o=function(r){return r&&r.Math===Math&&r};i.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof a=="object"&&a)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],275:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/to-object"),r=a({}.hasOwnProperty);i.exports=Object.hasOwn||function(u,l){return r(o(u),l)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,i,s){i.exports={}},{}],277:[function(e,i,s){i.exports=function(a,o){try{arguments.length===1?console.error(a):console.error(a,o)}catch(r){}}},{}],278:[function(e,i,s){var a=e("../internals/get-built-in");i.exports=a("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/fails"),r=e("../internals/document-create-element");i.exports=!a&&!o(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/fails"),r=e("../internals/classof-raw"),u=Object,l=a("".split);i.exports=o(function(){return!u("z").propertyIsEnumerable(0)})?function(h){return r(h)==="String"?l(h,""):u(h)}:u},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/is-callable"),r=e("../internals/shared-store"),u=a(Function.toString);o(r.inspectSource)||(r.inspectSource=function(l){return u(l)}),i.exports=r.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,i,s){var a,o,r,u=e("../internals/weak-map-basic-detection"),l=e("../internals/global"),h=e("../internals/is-object"),f=e("../internals/create-non-enumerable-property"),d=e("../internals/has-own-property"),p=e("../internals/shared-store"),b=e("../internals/shared-key"),v=e("../internals/hidden-keys"),x=l.TypeError,w=l.WeakMap;if(u||p.state){var M=p.state||(p.state=new w);M.get=M.get,M.has=M.has,M.set=M.set,a=function(D,N){if(M.has(D))throw new x("Object already initialized");return N.facade=D,M.set(D,N),N},o=function(D){return M.get(D)||{}},r=function(D){return M.has(D)}}else{var E=b("state");v[E]=!0,a=function(D,N){if(d(D,E))throw new x("Object already initialized");return N.facade=D,f(D,E,N),N},o=function(D){return d(D,E)?D[E]:{}},r=function(D){return d(D,E)}}i.exports={set:a,get:o,has:r,enforce:function(D){return r(D)?o(D):a(D,{})},getterFor:function(D){return function(N){var V;if(!h(N)||(V=o(N)).type!==D)throw new x("Incompatible receiver, "+D+" required");return V}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,i,s){var a=e("../internals/well-known-symbol"),o=e("../internals/iterators"),r=a("iterator"),u=Array.prototype;i.exports=function(l){return l!==void 0&&(o.Array===l||u[r]===l)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,i,s){var a=e("../internals/classof-raw");i.exports=Array.isArray||function(o){return a(o)==="Array"}},{"../internals/classof-raw":235}],285:[function(e,i,s){var a=e("../internals/document-all"),o=a.all;i.exports=a.IS_HTMLDDA?function(r){return typeof r=="function"||r===o}:function(r){return typeof r=="function"}},{"../internals/document-all":248}],286:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/fails"),r=e("../internals/is-callable"),u=e("../internals/classof"),l=e("../internals/get-built-in"),h=e("../internals/inspect-source"),f=function(){},d=[],p=l("Reflect","construct"),b=/^\s*(?:class|function)\b/,v=a(b.exec),x=!b.test(f),w=function(E){if(!r(E))return!1;try{return p(f,d,E),!0}catch(D){return!1}},M=function(E){if(!r(E))return!1;switch(u(E)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return x||!!v(b,h(E))}catch(D){return!0}};M.sham=!0,i.exports=!p||o(function(){var E;return w(w.call)||!w(Object)||!w(function(){E=!0})||E})?M:w},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,i,s){var a=e("../internals/fails"),o=e("../internals/is-callable"),r=/#|\.prototype\./,u=function(p,b){var v=h[l(p)];return v===d||v!==f&&(o(b)?a(b):!!b)},l=u.normalize=function(p){return String(p).replace(r,".").toLowerCase()},h=u.data={},f=u.NATIVE="N",d=u.POLYFILL="P";i.exports=u},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,i,s){i.exports=function(a){return a==null}},{}],289:[function(e,i,s){var a=e("../internals/is-callable"),o=e("../internals/document-all"),r=o.all;i.exports=o.IS_HTMLDDA?function(u){return typeof u=="object"?u!==null:a(u)||u===r}:function(u){return typeof u=="object"?u!==null:a(u)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,i,s){i.exports=!1},{}],291:[function(e,i,s){var a=e("../internals/is-object"),o=e("../internals/classof-raw"),r=e("../internals/well-known-symbol")("match");i.exports=function(u){var l;return a(u)&&((l=u[r])!==void 0?!!l:o(u)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,i,s){var a=e("../internals/get-built-in"),o=e("../internals/is-callable"),r=e("../internals/object-is-prototype-of"),u=e("../internals/use-symbol-as-uid"),l=Object;i.exports=u?function(h){return typeof h=="symbol"}:function(h){var f=a("Symbol");return o(f)&&r(f.prototype,l(h))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,i,s){var a=e("../internals/function-bind-context"),o=e("../internals/function-call"),r=e("../internals/an-object"),u=e("../internals/try-to-string"),l=e("../internals/is-array-iterator-method"),h=e("../internals/length-of-array-like"),f=e("../internals/object-is-prototype-of"),d=e("../internals/get-iterator"),p=e("../internals/get-iterator-method"),b=e("../internals/iterator-close"),v=TypeError,x=function(M,E){this.stopped=M,this.result=E},w=x.prototype;i.exports=function(M,E,D){var N,V,K,j,Z,tt,rt,J=D&&D.that,U=!(!D||!D.AS_ENTRIES),G=!(!D||!D.IS_RECORD),I=!(!D||!D.IS_ITERATOR),C=!(!D||!D.INTERRUPTED),L=a(E,J),B=function(q){return N&&b(N,"normal",q),new x(!0,q)},O=function(q){return U?(r(q),C?L(q[0],q[1],B):L(q[0],q[1])):C?L(q,B):L(q)};if(G)N=M.iterator;else if(I)N=M;else{if(!(V=p(M)))throw new v(u(M)+" is not iterable");if(l(V)){for(K=0,j=h(M);j>K;K++)if((Z=O(M[K]))&&f(w,Z))return Z;return new x(!1)}N=d(M,V)}for(tt=G?M.next:N.next;!(rt=o(tt,N)).done;){try{Z=O(rt.value)}catch(q){b(N,"throw",q)}if(typeof Z=="object"&&Z&&f(w,Z))return Z}return new x(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,i,s){var a=e("../internals/function-call"),o=e("../internals/an-object"),r=e("../internals/get-method");i.exports=function(u,l,h){var f,d;o(u);try{if(!(f=r(u,"return"))){if(l==="throw")throw h;return h}f=a(f,u)}catch(p){d=!0,f=p}if(l==="throw")throw h;if(d)throw f;return o(f),h}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,i,s){var a=e("../internals/iterators-core").IteratorPrototype,o=e("../internals/object-create"),r=e("../internals/create-property-descriptor"),u=e("../internals/set-to-string-tag"),l=e("../internals/iterators"),h=function(){return this};i.exports=function(f,d,p,b){var v=d+" Iterator";return f.prototype=o(a,{next:r(+!b,p)}),u(f,v,!1,!0),l[v]=h,f}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/function-call"),r=e("../internals/is-pure"),u=e("../internals/function-name"),l=e("../internals/is-callable"),h=e("../internals/iterator-create-constructor"),f=e("../internals/object-get-prototype-of"),d=e("../internals/object-set-prototype-of"),p=e("../internals/set-to-string-tag"),b=e("../internals/create-non-enumerable-property"),v=e("../internals/define-built-in"),x=e("../internals/well-known-symbol"),w=e("../internals/iterators"),M=e("../internals/iterators-core"),E=u.PROPER,D=u.CONFIGURABLE,N=M.IteratorPrototype,V=M.BUGGY_SAFARI_ITERATORS,K=x("iterator"),j=function(){return this};i.exports=function(Z,tt,rt,J,U,G,I){h(rt,tt,J);var C,L,B,O=function(Q){if(Q===U&&ut)return ut;if(!V&&Q&&Q in nt)return nt[Q];switch(Q){case"keys":case"values":case"entries":return function(){return new rt(this,Q)}}return function(){return new rt(this)}},q=tt+" Iterator",it=!1,nt=Z.prototype,lt=nt[K]||nt["@@iterator"]||U&&nt[U],ut=!V&&lt||O(U),vt=tt==="Array"&&nt.entries||lt;if(vt&&(C=f(vt.call(new Z)))!==Object.prototype&&C.next&&(r||f(C)===N||(d?d(C,N):l(C[K])||v(C,K,j)),p(C,q,!0,!0),r&&(w[q]=j)),E&&U==="values"&&lt&&lt.name!=="values"&&(!r&&D?b(nt,"name","values"):(it=!0,ut=function(){return o(lt,this)})),U)if(L={values:O("values"),keys:G?ut:O("keys"),entries:O("entries")},I)for(B in L)(V||it||!(B in nt))&&v(nt,B,L[B]);else a({target:tt,proto:!0,forced:V||it},L);return r&&!I||nt[K]===ut||v(nt,K,ut,{name:U}),w[tt]=ut,L}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,i,s){var a,o,r,u=e("../internals/fails"),l=e("../internals/is-callable"),h=e("../internals/is-object"),f=e("../internals/object-create"),d=e("../internals/object-get-prototype-of"),p=e("../internals/define-built-in"),b=e("../internals/well-known-symbol"),v=e("../internals/is-pure"),x=b("iterator"),w=!1;[].keys&&("next"in(r=[].keys())?(o=d(d(r)))!==Object.prototype&&(a=o):w=!0),!h(a)||u(function(){var M={};return a[x].call(M)!==M})?a={}:v&&(a=f(a)),l(a[x])||p(a,x,function(){return this}),i.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:w}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,i,s){arguments[4][276][0].apply(s,arguments)},{dup:276}],299:[function(e,i,s){var a=e("../internals/to-length");i.exports=function(o){return a(o.length)}},{"../internals/to-length":343}],300:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/fails"),r=e("../internals/is-callable"),u=e("../internals/has-own-property"),l=e("../internals/descriptors"),h=e("../internals/function-name").CONFIGURABLE,f=e("../internals/inspect-source"),d=e("../internals/internal-state"),p=d.enforce,b=d.get,v=String,x=Object.defineProperty,w=a("".slice),M=a("".replace),E=a([].join),D=l&&!o(function(){return x(function(){},"length",{value:8}).length!==8}),N=String(String).split("String"),V=i.exports=function(K,j,Z){w(v(j),0,7)==="Symbol("&&(j="["+M(v(j),/^Symbol\(([^)]*)\)/,"$1")+"]"),Z&&Z.getter&&(j="get "+j),Z&&Z.setter&&(j="set "+j),(!u(K,"name")||h&&K.name!==j)&&(l?x(K,"name",{value:j,configurable:!0}):K.name=j),D&&Z&&u(Z,"arity")&&K.length!==Z.arity&&x(K,"length",{value:Z.arity});try{Z&&u(Z,"constructor")&&Z.constructor?l&&x(K,"prototype",{writable:!1}):K.prototype&&(K.prototype=void 0)}catch(rt){}var tt=p(K);return u(tt,"source")||(tt.source=E(N,typeof j=="string"?j:"")),K};Function.prototype.toString=V(function(){return r(this)&&b(this).source||f(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,i,s){var a=Math.ceil,o=Math.floor;i.exports=Math.trunc||function(r){var u=+r;return(u>0?o:a)(u)}},{}],302:[function(e,i,s){var a,o,r,u,l,h=e("../internals/global"),f=e("../internals/function-bind-context"),d=e("../internals/object-get-own-property-descriptor").f,p=e("../internals/task").set,b=e("../internals/queue"),v=e("../internals/engine-is-ios"),x=e("../internals/engine-is-ios-pebble"),w=e("../internals/engine-is-webos-webkit"),M=e("../internals/engine-is-node"),E=h.MutationObserver||h.WebKitMutationObserver,D=h.document,N=h.process,V=h.Promise,K=d(h,"queueMicrotask"),j=K&&K.value;if(!j){var Z=new b,tt=function(){var rt,J;for(M&&(rt=N.domain)&&rt.exit();J=Z.get();)try{J()}catch(U){throw Z.head&&a(),U}rt&&rt.enter()};v||M||w||!E||!D?!x&&V&&V.resolve?((u=V.resolve(void 0)).constructor=V,l=f(u.then,u),a=function(){l(tt)}):M?a=function(){N.nextTick(tt)}:(p=f(p,h),a=function(){p(tt)}):(o=!0,r=D.createTextNode(""),new E(tt).observe(r,{characterData:!0}),a=function(){r.data=o=!o}),j=function(rt){Z.head||a(),Z.add(rt)}}i.exports=j},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,i,s){var a=e("../internals/a-callable"),o=TypeError,r=function(u){var l,h;this.promise=new u(function(f,d){if(l!==void 0||h!==void 0)throw new o("Bad Promise constructor");l=f,h=d}),this.resolve=a(l),this.reject=a(h)};i.exports.f=function(u){return new r(u)}},{"../internals/a-callable":222}],304:[function(e,i,s){var a=e("../internals/is-regexp"),o=TypeError;i.exports=function(r){if(a(r))throw new o("The method doesn't accept regular expressions");return r}},{"../internals/is-regexp":291}],305:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/function-uncurry-this"),r=e("../internals/function-call"),u=e("../internals/fails"),l=e("../internals/object-keys"),h=e("../internals/object-get-own-property-symbols"),f=e("../internals/object-property-is-enumerable"),d=e("../internals/to-object"),p=e("../internals/indexed-object"),b=Object.assign,v=Object.defineProperty,x=o([].concat);i.exports=!b||u(function(){if(a&&b({b:1},b(v({},"a",{enumerable:!0,get:function(){v(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var w={},M={},E=Symbol("assign detection");return w[E]=7,"abcdefghijklmnopqrst".split("").forEach(function(D){M[D]=D}),b({},w)[E]!==7||l(b({},M)).join("")!=="abcdefghijklmnopqrst"})?function(w,M){for(var E=d(w),D=arguments.length,N=1,V=h.f,K=f.f;D>N;)for(var j,Z=p(arguments[N++]),tt=V?x(l(Z),V(Z)):l(Z),rt=tt.length,J=0;rt>J;)j=tt[J++],a&&!r(K,Z,j)||(E[j]=Z[j]);return E}:b},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,i,s){var a,o=e("../internals/an-object"),r=e("../internals/object-define-properties"),u=e("../internals/enum-bug-keys"),l=e("../internals/hidden-keys"),h=e("../internals/html"),f=e("../internals/document-create-element"),d=e("../internals/shared-key"),p=d("IE_PROTO"),b=function(){},v=function(M){return"<script>"+M+"<\/script>"},x=function(M){M.write(v("")),M.close();var E=M.parentWindow.Object;return M=null,E},w=function(){try{a=new ActiveXObject("htmlfile")}catch(N){}var M,E;w=typeof document!="undefined"?document.domain&&a?x(a):((E=f("iframe")).style.display="none",h.appendChild(E),E.src="javascript:",(M=E.contentWindow.document).open(),M.write(v("document.F=Object")),M.close(),M.F):x(a);for(var D=u.length;D--;)delete w.prototype[u[D]];return w()};l[p]=!0,i.exports=Object.create||function(M,E){var D;return M!==null?(b.prototype=o(M),D=new b,b.prototype=null,D[p]=M):D=w(),E===void 0?D:r.f(D,E)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/v8-prototype-define-bug"),r=e("../internals/object-define-property"),u=e("../internals/an-object"),l=e("../internals/to-indexed-object"),h=e("../internals/object-keys");s.f=a&&!o?Object.defineProperties:function(f,d){u(f);for(var p,b=l(d),v=h(d),x=v.length,w=0;x>w;)r.f(f,p=v[w++],b[p]);return f}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/ie8-dom-define"),r=e("../internals/v8-prototype-define-bug"),u=e("../internals/an-object"),l=e("../internals/to-property-key"),h=TypeError,f=Object.defineProperty,d=Object.getOwnPropertyDescriptor;s.f=a?r?function(p,b,v){if(u(p),b=l(b),u(v),typeof p=="function"&&b==="prototype"&&"value"in v&&"writable"in v&&!v.writable){var x=d(p,b);x&&x.writable&&(p[b]=v.value,v={configurable:"configurable"in v?v.configurable:x.configurable,enumerable:"enumerable"in v?v.enumerable:x.enumerable,writable:!1})}return f(p,b,v)}:f:function(p,b,v){if(u(p),b=l(b),u(v),o)try{return f(p,b,v)}catch(x){}if("get"in v||"set"in v)throw new h("Accessors not supported");return"value"in v&&(p[b]=v.value),p}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/function-call"),r=e("../internals/object-property-is-enumerable"),u=e("../internals/create-property-descriptor"),l=e("../internals/to-indexed-object"),h=e("../internals/to-property-key"),f=e("../internals/has-own-property"),d=e("../internals/ie8-dom-define"),p=Object.getOwnPropertyDescriptor;s.f=a?p:function(b,v){if(b=l(b),v=h(v),d)try{return p(b,v)}catch(x){}if(f(b,v))return u(!o(r.f,b,v),b[v])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,i,s){var a=e("../internals/classof-raw"),o=e("../internals/to-indexed-object"),r=e("../internals/object-get-own-property-names").f,u=e("../internals/array-slice-simple"),l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];i.exports.f=function(h){return l&&a(h)==="Window"?function(f){try{return r(f)}catch(d){return u(l)}}(h):r(o(h))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,i,s){var a=e("../internals/object-keys-internal"),o=e("../internals/enum-bug-keys").concat("length","prototype");s.f=Object.getOwnPropertyNames||function(r){return a(r,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,i,s){s.f=Object.getOwnPropertySymbols},{}],313:[function(e,i,s){var a=e("../internals/has-own-property"),o=e("../internals/is-callable"),r=e("../internals/to-object"),u=e("../internals/shared-key"),l=e("../internals/correct-prototype-getter"),h=u("IE_PROTO"),f=Object,d=f.prototype;i.exports=l?f.getPrototypeOf:function(p){var b=r(p);if(a(b,h))return b[h];var v=b.constructor;return o(v)&&b instanceof v?v.prototype:b instanceof f?d:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,i,s){var a=e("../internals/function-uncurry-this");i.exports=a({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=e("../internals/has-own-property"),r=e("../internals/to-indexed-object"),u=e("../internals/array-includes").indexOf,l=e("../internals/hidden-keys"),h=a([].push);i.exports=function(f,d){var p,b=r(f),v=0,x=[];for(p in b)!o(l,p)&&o(b,p)&&h(x,p);for(;d.length>v;)o(b,p=d[v++])&&(~u(x,p)||h(x,p));return x}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,i,s){var a=e("../internals/object-keys-internal"),o=e("../internals/enum-bug-keys");i.exports=Object.keys||function(r){return a(r,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,i,s){var a={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,r=o&&!a.call({1:2},1);s.f=r?function(u){var l=o(this,u);return!!l&&l.enumerable}:a},{}],318:[function(e,i,s){var a=e("../internals/function-uncurry-this-accessor"),o=e("../internals/an-object"),r=e("../internals/a-possible-prototype");i.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var u,l=!1,h={};try{(u=a(Object.prototype,"__proto__","set"))(h,[]),l=h instanceof Array}catch(f){}return function(f,d){return o(f),r(d),l?u(f,d):f.__proto__=d,f}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/fails"),r=e("../internals/function-uncurry-this"),u=e("../internals/object-get-prototype-of"),l=e("../internals/object-keys"),h=e("../internals/to-indexed-object"),f=r(e("../internals/object-property-is-enumerable").f),d=r([].push),p=a&&o(function(){var v=Object.create(null);return v[2]=2,!f(v,2)}),b=function(v){return function(x){for(var w,M=h(x),E=l(M),D=p&&u(M)===null,N=E.length,V=0,K=[];N>V;)w=E[V++],a&&!(D?w in M:f(M,w))||d(K,v?[w,M[w]]:M[w]);return K}};i.exports={entries:b(!0),values:b(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,i,s){var a=e("../internals/function-call"),o=e("../internals/is-callable"),r=e("../internals/is-object"),u=TypeError;i.exports=function(l,h){var f,d;if(h==="string"&&o(f=l.toString)&&!r(d=a(f,l))||o(f=l.valueOf)&&!r(d=a(f,l))||h!=="string"&&o(f=l.toString)&&!r(d=a(f,l)))return d;throw new u("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,i,s){var a=e("../internals/get-built-in"),o=e("../internals/function-uncurry-this"),r=e("../internals/object-get-own-property-names"),u=e("../internals/object-get-own-property-symbols"),l=e("../internals/an-object"),h=o([].concat);i.exports=a("Reflect","ownKeys")||function(f){var d=r.f(l(f)),p=u.f;return p?h(d,p(f)):d}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,i,s){var a=e("../internals/global");i.exports=a},{"../internals/global":274}],323:[function(e,i,s){i.exports=function(a){try{return{error:!1,value:a()}}catch(o){return{error:!0,value:o}}}},{}],324:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/promise-native-constructor"),r=e("../internals/is-callable"),u=e("../internals/is-forced"),l=e("../internals/inspect-source"),h=e("../internals/well-known-symbol"),f=e("../internals/engine-is-browser"),d=e("../internals/engine-is-deno"),p=e("../internals/is-pure"),b=e("../internals/engine-v8-version"),v=o&&o.prototype,x=h("species"),w=!1,M=r(a.PromiseRejectionEvent),E=u("Promise",function(){var D=l(o),N=D!==String(o);if(!N&&b===66||p&&(!v.catch||!v.finally))return!0;if(!b||b<51||!/native code/.test(D)){var V=new o(function(j){j(1)}),K=function(j){j(function(){},function(){})};if((V.constructor={})[x]=K,!(w=V.then(function(){})instanceof K))return!0}return!N&&(f||d)&&!M});i.exports={CONSTRUCTOR:E,REJECTION_EVENT:M,SUBCLASSING:w}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,i,s){var a=e("../internals/global");i.exports=a.Promise},{"../internals/global":274}],326:[function(e,i,s){var a=e("../internals/an-object"),o=e("../internals/is-object"),r=e("../internals/new-promise-capability");i.exports=function(u,l){if(a(u),o(l)&&l.constructor===u)return l;var h=r.f(u);return(0,h.resolve)(l),h.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,i,s){var a=e("../internals/promise-native-constructor"),o=e("../internals/check-correctness-of-iteration"),r=e("../internals/promise-constructor-detection").CONSTRUCTOR;i.exports=r||!o(function(u){a.all(u).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,i,s){var a=function(){this.head=null,this.tail=null};a.prototype={add:function(o){var r={item:o,next:null},u=this.tail;u?u.next=r:this.head=r,this.tail=r},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}},i.exports=a},{}],329:[function(e,i,s){var a=e("../internals/is-null-or-undefined"),o=TypeError;i.exports=function(r){if(a(r))throw new o("Can't call method on "+r);return r}},{"../internals/is-null-or-undefined":288}],330:[function(e,i,s){var a=e("../internals/get-built-in"),o=e("../internals/define-built-in-accessor"),r=e("../internals/well-known-symbol"),u=e("../internals/descriptors"),l=r("species");i.exports=function(h){var f=a(h);u&&f&&!f[l]&&o(f,l,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,i,s){var a=e("../internals/object-define-property").f,o=e("../internals/has-own-property"),r=e("../internals/well-known-symbol")("toStringTag");i.exports=function(u,l,h){u&&!h&&(u=u.prototype),u&&!o(u,r)&&a(u,r,{configurable:!0,value:l})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,i,s){var a=e("../internals/shared"),o=e("../internals/uid"),r=a("keys");i.exports=function(u){return r[u]||(r[u]=o(u))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/define-global-property"),r=a["__core-js_shared__"]||o("__core-js_shared__",{});i.exports=r},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,i,s){var a=e("../internals/is-pure"),o=e("../internals/shared-store");(i.exports=function(r,u){return o[r]||(o[r]=u!==void 0?u:{})})("versions",[]).push({version:"3.33.0",mode:a?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,i,s){var a=e("../internals/an-object"),o=e("../internals/a-constructor"),r=e("../internals/is-null-or-undefined"),u=e("../internals/well-known-symbol")("species");i.exports=function(l,h){var f,d=a(l).constructor;return d===void 0||r(f=a(d)[u])?h:o(f)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,i,s){var a=e("../internals/engine-v8-version"),o=e("../internals/fails"),r=e("../internals/global").String;i.exports=!!Object.getOwnPropertySymbols&&!o(function(){var u=Symbol("symbol detection");return!r(u)||!(Object(u)instanceof Symbol)||!Symbol.sham&&a&&a<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,i,s){var a=e("../internals/function-call"),o=e("../internals/get-built-in"),r=e("../internals/well-known-symbol"),u=e("../internals/define-built-in");i.exports=function(){var l=o("Symbol"),h=l&&l.prototype,f=h&&h.valueOf,d=r("toPrimitive");h&&!h[d]&&u(h,d,function(p){return a(f,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,i,s){var a=e("../internals/symbol-constructor-detection");i.exports=a&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,i,s){var a,o,r,u,l=e("../internals/global"),h=e("../internals/function-apply"),f=e("../internals/function-bind-context"),d=e("../internals/is-callable"),p=e("../internals/has-own-property"),b=e("../internals/fails"),v=e("../internals/html"),x=e("../internals/array-slice"),w=e("../internals/document-create-element"),M=e("../internals/validate-arguments-length"),E=e("../internals/engine-is-ios"),D=e("../internals/engine-is-node"),N=l.setImmediate,V=l.clearImmediate,K=l.process,j=l.Dispatch,Z=l.Function,tt=l.MessageChannel,rt=l.String,J=0,U={};b(function(){a=l.location});var G=function(B){if(p(U,B)){var O=U[B];delete U[B],O()}},I=function(B){return function(){G(B)}},C=function(B){G(B.data)},L=function(B){l.postMessage(rt(B),a.protocol+"//"+a.host)};N&&V||(N=function(B){M(arguments.length,1);var O=d(B)?B:Z(B),q=x(arguments,1);return U[++J]=function(){h(O,void 0,q)},o(J),J},V=function(B){delete U[B]},D?o=function(B){K.nextTick(I(B))}:j&&j.now?o=function(B){j.now(I(B))}:tt&&!E?(u=(r=new tt).port2,r.port1.onmessage=C,o=f(u.postMessage,u)):l.addEventListener&&d(l.postMessage)&&!l.importScripts&&a&&a.protocol!=="file:"&&!b(L)?(o=L,l.addEventListener("message",C,!1)):o="onreadystatechange"in w("script")?function(B){v.appendChild(w("script")).onreadystatechange=function(){v.removeChild(this),G(B)}}:function(B){setTimeout(I(B),0)}),i.exports={set:N,clear:V}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,i,s){var a=e("../internals/to-integer-or-infinity"),o=Math.max,r=Math.min;i.exports=function(u,l){var h=a(u);return h<0?o(h+l,0):r(h,l)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,i,s){var a=e("../internals/indexed-object"),o=e("../internals/require-object-coercible");i.exports=function(r){return a(o(r))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,i,s){var a=e("../internals/math-trunc");i.exports=function(o){var r=+o;return r!=r||r===0?0:a(r)}},{"../internals/math-trunc":301}],343:[function(e,i,s){var a=e("../internals/to-integer-or-infinity"),o=Math.min;i.exports=function(r){return r>0?o(a(r),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,i,s){var a=e("../internals/require-object-coercible"),o=Object;i.exports=function(r){return o(a(r))}},{"../internals/require-object-coercible":329}],345:[function(e,i,s){var a=e("../internals/function-call"),o=e("../internals/is-object"),r=e("../internals/is-symbol"),u=e("../internals/get-method"),l=e("../internals/ordinary-to-primitive"),h=e("../internals/well-known-symbol"),f=TypeError,d=h("toPrimitive");i.exports=function(p,b){if(!o(p)||r(p))return p;var v,x=u(p,d);if(x){if(b===void 0&&(b="default"),v=a(x,p,b),!o(v)||r(v))return v;throw new f("Can't convert object to primitive value")}return b===void 0&&(b="number"),l(p,b)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,i,s){var a=e("../internals/to-primitive"),o=e("../internals/is-symbol");i.exports=function(r){var u=a(r,"string");return o(u)?u:u+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,i,s){var a={};a[e("../internals/well-known-symbol")("toStringTag")]="z",i.exports=String(a)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(e,i,s){var a=e("../internals/classof"),o=String;i.exports=function(r){if(a(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(r)}},{"../internals/classof":236}],349:[function(e,i,s){var a=String;i.exports=function(o){try{return a(o)}catch(r){return"Object"}}},{}],350:[function(e,i,s){var a=e("../internals/function-uncurry-this"),o=0,r=Math.random(),u=a(1 .toString);i.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+u(++o+r,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,i,s){var a=e("../internals/symbol-constructor-detection");i.exports=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(e,i,s){var a=e("../internals/descriptors"),o=e("../internals/fails");i.exports=a&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,i,s){var a=TypeError;i.exports=function(o,r){if(o<r)throw new a("Not enough arguments");return o}},{}],354:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/is-callable"),r=a.WeakMap;i.exports=o(r)&&/native code/.test(String(r))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,i,s){var a=e("../internals/path"),o=e("../internals/has-own-property"),r=e("../internals/well-known-symbol-wrapped"),u=e("../internals/object-define-property").f;i.exports=function(l){var h=a.Symbol||(a.Symbol={});o(h,l)||u(h,l,{value:r.f(l)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,i,s){var a=e("../internals/well-known-symbol");s.f=a},{"../internals/well-known-symbol":357}],357:[function(e,i,s){var a=e("../internals/global"),o=e("../internals/shared"),r=e("../internals/has-own-property"),u=e("../internals/uid"),l=e("../internals/symbol-constructor-detection"),h=e("../internals/use-symbol-as-uid"),f=a.Symbol,d=o("wks"),p=h?f.for||f:f&&f.withoutSetter||u;i.exports=function(b){return r(d,b)||(d[b]=l&&r(f,b)?f[b]:p("Symbol."+b)),d[b]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/array-iteration").findIndex,r=e("../internals/add-to-unscopables"),u=!0;"findIndex"in[]&&Array(1).findIndex(function(){u=!1}),a({target:"Array",proto:!0,forced:u},{findIndex:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),r("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/array-iteration").find,r=e("../internals/add-to-unscopables"),u=!0;"find"in[]&&Array(1).find(function(){u=!1}),a({target:"Array",proto:!0,forced:u},{find:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),r("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/array-includes").includes,r=e("../internals/fails"),u=e("../internals/add-to-unscopables");a({target:"Array",proto:!0,forced:r(function(){return!Array(1).includes()})},{includes:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),u("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,i,s){var a=e("../internals/to-indexed-object"),o=e("../internals/add-to-unscopables"),r=e("../internals/iterators"),u=e("../internals/internal-state"),l=e("../internals/object-define-property").f,h=e("../internals/iterator-define"),f=e("../internals/create-iter-result-object"),d=e("../internals/is-pure"),p=e("../internals/descriptors"),b=u.set,v=u.getterFor("Array Iterator");i.exports=h(Array,"Array",function(w,M){b(this,{type:"Array Iterator",target:a(w),index:0,kind:M})},function(){var w=v(this),M=w.target,E=w.kind,D=w.index++;if(!M||D>=M.length)return w.target=void 0,f(void 0,!0);switch(E){case"keys":return f(D,!1);case"values":return f(M[D],!1)}return f([D,M[D]],!1)},"values");var x=r.Arguments=r.Array;if(o("keys"),o("values"),o("entries"),!d&&p&&x.name!=="values")try{l(x,"name",{value:"values"})}catch(w){}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/get-built-in"),r=e("../internals/function-apply"),u=e("../internals/function-call"),l=e("../internals/function-uncurry-this"),h=e("../internals/fails"),f=e("../internals/is-callable"),d=e("../internals/is-symbol"),p=e("../internals/array-slice"),b=e("../internals/get-json-replacer-function"),v=e("../internals/symbol-constructor-detection"),x=String,w=o("JSON","stringify"),M=l(/./.exec),E=l("".charAt),D=l("".charCodeAt),N=l("".replace),V=l(1 .toString),K=/[\uD800-\uDFFF]/g,j=/^[\uD800-\uDBFF]$/,Z=/^[\uDC00-\uDFFF]$/,tt=!v||h(function(){var G=o("Symbol")("stringify detection");return w([G])!=="[null]"||w({a:G})!=="{}"||w(Object(G))!=="{}"}),rt=h(function(){return w("\uDF06\uD834")!=='"\\udf06\\ud834"'||w("\uDEAD")!=='"\\udead"'}),J=function(G,I){var C=p(arguments),L=b(I);if(f(L)||G!==void 0&&!d(G))return C[1]=function(B,O){if(f(L)&&(O=u(L,this,x(B),O)),!d(O))return O},r(w,null,C)},U=function(G,I,C){var L=E(C,I-1),B=E(C,I+1);return M(j,G)&&!M(Z,B)||M(Z,G)&&!M(j,L)?"\\u"+V(D(G,0),16):G};w&&a({target:"JSON",stat:!0,arity:3,forced:tt||rt},{stringify:function(G,I,C){var L=p(arguments),B=r(tt?J:w,null,L);return rt&&typeof B=="string"?N(B,K,U):B}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,i,s){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(a){return a!=a}})},{"../internals/export":259}],364:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/object-assign");a({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/symbol-constructor-detection"),r=e("../internals/fails"),u=e("../internals/object-get-own-property-symbols"),l=e("../internals/to-object");a({target:"Object",stat:!0,forced:!o||r(function(){u.f(1)})},{getOwnPropertySymbols:function(h){var f=u.f;return f?f(l(h)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/to-object"),r=e("../internals/object-keys");a({target:"Object",stat:!0,forced:e("../internals/fails")(function(){r(1)})},{keys:function(u){return r(o(u))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/object-to-array").values;a({target:"Object",stat:!0},{values:function(r){return o(r)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/function-call"),r=e("../internals/a-callable"),u=e("../internals/new-promise-capability"),l=e("../internals/perform"),h=e("../internals/iterate");a({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(f){var d=this,p=u.f(d),b=p.resolve,v=p.reject,x=l(function(){var w=r(d.resolve),M=[],E=0,D=1;h(f,function(N){var V=E++,K=!1;D++,o(w,d,N).then(function(j){K||(K=!0,M[V]=j,--D||b(M))},v)}),--D||b(M)});return x.error&&v(x.value),p.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/is-pure"),r=e("../internals/promise-constructor-detection").CONSTRUCTOR,u=e("../internals/promise-native-constructor"),l=e("../internals/get-built-in"),h=e("../internals/is-callable"),f=e("../internals/define-built-in"),d=u&&u.prototype;if(a({target:"Promise",proto:!0,forced:r,real:!0},{catch:function(b){return this.then(void 0,b)}}),!o&&h(u)){var p=l("Promise").prototype.catch;d.catch!==p&&f(d,"catch",p,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,i,s){var a,o,r,u=e("../internals/export"),l=e("../internals/is-pure"),h=e("../internals/engine-is-node"),f=e("../internals/global"),d=e("../internals/function-call"),p=e("../internals/define-built-in"),b=e("../internals/object-set-prototype-of"),v=e("../internals/set-to-string-tag"),x=e("../internals/set-species"),w=e("../internals/a-callable"),M=e("../internals/is-callable"),E=e("../internals/is-object"),D=e("../internals/an-instance"),N=e("../internals/species-constructor"),V=e("../internals/task").set,K=e("../internals/microtask"),j=e("../internals/host-report-errors"),Z=e("../internals/perform"),tt=e("../internals/queue"),rt=e("../internals/internal-state"),J=e("../internals/promise-native-constructor"),U=e("../internals/promise-constructor-detection"),G=e("../internals/new-promise-capability"),I=U.CONSTRUCTOR,C=U.REJECTION_EVENT,L=U.SUBCLASSING,B=rt.getterFor("Promise"),O=rt.set,q=J&&J.prototype,it=J,nt=q,lt=f.TypeError,ut=f.document,vt=f.process,Q=G.f,gt=Q,Y=!!(ut&&ut.createEvent&&f.dispatchEvent),H=function(Ot){var Zt;return!(!E(Ot)||!M(Zt=Ot.then))&&Zt},at=function(Ot,Zt){var he,fe,be,Me=Zt.value,Pe=Zt.state===1,ze=Pe?Ot.ok:Ot.fail,Ce=Ot.resolve,Le=Ot.reject,Ye=Ot.domain;try{ze?(Pe||(Zt.rejection===2&&Gt(Zt),Zt.rejection=1),ze===!0?he=Me:(Ye&&Ye.enter(),he=ze(Me),Ye&&(Ye.exit(),be=!0)),he===Ot.promise?Le(new lt("Promise-chain cycle")):(fe=H(he))?d(fe,he,Ce,Le):Ce(he)):Le(Me)}catch(le){Ye&&!be&&Ye.exit(),Le(le)}},ft=function(Ot,Zt){Ot.notified||(Ot.notified=!0,K(function(){for(var he,fe=Ot.reactions;he=fe.get();)at(he,Ot);Ot.notified=!1,Zt&&!Ot.rejection&&_t(Ot)}))},wt=function(Ot,Zt,he){var fe,be;Y?((fe=ut.createEvent("Event")).promise=Zt,fe.reason=he,fe.initEvent(Ot,!1,!0),f.dispatchEvent(fe)):fe={promise:Zt,reason:he},!C&&(be=f["on"+Ot])?be(fe):Ot==="unhandledrejection"&&j("Unhandled promise rejection",he)},_t=function(Ot){d(V,f,function(){var Zt,he=Ot.facade,fe=Ot.value;if(Dt(Ot)&&(Zt=Z(function(){h?vt.emit("unhandledRejection",fe,he):wt("unhandledrejection",he,fe)}),Ot.rejection=h||Dt(Ot)?2:1,Zt.error))throw Zt.value})},Dt=function(Ot){return Ot.rejection!==1&&!Ot.parent},Gt=function(Ot){d(V,f,function(){var Zt=Ot.facade;h?vt.emit("rejectionHandled",Zt):wt("rejectionhandled",Zt,Ot.value)})},te=function(Ot,Zt,he){return function(fe){Ot(Zt,fe,he)}},mt=function(Ot,Zt,he){Ot.done||(Ot.done=!0,he&&(Ot=he),Ot.value=Zt,Ot.state=2,ft(Ot,!0))},At=function(Ot,Zt,he){if(!Ot.done){Ot.done=!0,he&&(Ot=he);try{if(Ot.facade===Zt)throw new lt("Promise can't be resolved itself");var fe=H(Zt);fe?K(function(){var be={done:!1};try{d(fe,Zt,te(At,be,Ot),te(mt,be,Ot))}catch(Me){mt(be,Me,Ot)}}):(Ot.value=Zt,Ot.state=1,ft(Ot,!1))}catch(be){mt({done:!1},be,Ot)}}};if(I&&(nt=(it=function(Ot){D(this,nt),w(Ot),d(a,this);var Zt=B(this);try{Ot(te(At,Zt),te(mt,Zt))}catch(he){mt(Zt,he)}}).prototype,(a=function(Ot){O(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new tt,rejection:!1,state:0,value:void 0})}).prototype=p(nt,"then",function(Ot,Zt){var he=B(this),fe=Q(N(this,it));return he.parent=!0,fe.ok=!M(Ot)||Ot,fe.fail=M(Zt)&&Zt,fe.domain=h?vt.domain:void 0,he.state===0?he.reactions.add(fe):K(function(){at(fe,he)}),fe.promise}),o=function(){var Ot=new a,Zt=B(Ot);this.promise=Ot,this.resolve=te(At,Zt),this.reject=te(mt,Zt)},G.f=Q=function(Ot){return Ot===it||Ot===void 0?new o(Ot):gt(Ot)},!l&&M(J)&&q!==Object.prototype)){r=q.then,L||p(q,"then",function(Ot,Zt){var he=this;return new it(function(fe,be){d(r,he,fe,be)}).then(Ot,Zt)},{unsafe:!0});try{delete q.constructor}catch(Ot){}b&&b(q,nt)}u({global:!0,constructor:!0,wrap:!0,forced:I},{Promise:it}),v(it,"Promise",!1,!0),x("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/is-pure"),r=e("../internals/promise-native-constructor"),u=e("../internals/fails"),l=e("../internals/get-built-in"),h=e("../internals/is-callable"),f=e("../internals/species-constructor"),d=e("../internals/promise-resolve"),p=e("../internals/define-built-in"),b=r&&r.prototype;if(a({target:"Promise",proto:!0,real:!0,forced:!!r&&u(function(){b.finally.call({then:function(){}},function(){})})},{finally:function(x){var w=f(this,l("Promise")),M=h(x);return this.then(M?function(E){return d(w,x()).then(function(){return E})}:x,M?function(E){return d(w,x()).then(function(){throw E})}:x)}}),!o&&h(r)){var v=l("Promise").prototype.finally;b.finally!==v&&p(b,"finally",v,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,i,s){e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/function-call"),r=e("../internals/a-callable"),u=e("../internals/new-promise-capability"),l=e("../internals/perform"),h=e("../internals/iterate");a({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(f){var d=this,p=u.f(d),b=p.reject,v=l(function(){var x=r(d.resolve);h(f,function(w){o(x,d,w).then(p.resolve,b)})});return v.error&&b(v.value),p.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/function-call"),r=e("../internals/new-promise-capability");a({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(u){var l=r.f(this);return o(l.reject,void 0,u),l.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/get-built-in"),r=e("../internals/is-pure"),u=e("../internals/promise-native-constructor"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR,h=e("../internals/promise-resolve"),f=o("Promise"),d=r&&!l;a({target:"Promise",stat:!0,forced:r||l},{resolve:function(p){return h(d&&this===f?u:this,p)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/function-uncurry-this"),r=e("../internals/to-absolute-index"),u=RangeError,l=String.fromCharCode,h=String.fromCodePoint,f=o([].join);a({target:"String",stat:!0,arity:1,forced:!!h&&h.length!==1},{fromCodePoint:function(d){for(var p,b=[],v=arguments.length,x=0;v>x;){if(p=+arguments[x++],r(p,1114111)!==p)throw new u(p+" is not a valid code point");b[x]=p<65536?l(p):l(55296+((p-=65536)>>10),p%1024+56320)}return f(b,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/function-uncurry-this"),r=e("../internals/not-a-regexp"),u=e("../internals/require-object-coercible"),l=e("../internals/to-string"),h=e("../internals/correct-is-regexp-logic"),f=o("".indexOf);a({target:"String",proto:!0,forced:!h("includes")},{includes:function(d){return!!~f(l(u(this)),l(r(d)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,i,s){e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/global"),r=e("../internals/function-call"),u=e("../internals/function-uncurry-this"),l=e("../internals/is-pure"),h=e("../internals/descriptors"),f=e("../internals/symbol-constructor-detection"),d=e("../internals/fails"),p=e("../internals/has-own-property"),b=e("../internals/object-is-prototype-of"),v=e("../internals/an-object"),x=e("../internals/to-indexed-object"),w=e("../internals/to-property-key"),M=e("../internals/to-string"),E=e("../internals/create-property-descriptor"),D=e("../internals/object-create"),N=e("../internals/object-keys"),V=e("../internals/object-get-own-property-names"),K=e("../internals/object-get-own-property-names-external"),j=e("../internals/object-get-own-property-symbols"),Z=e("../internals/object-get-own-property-descriptor"),tt=e("../internals/object-define-property"),rt=e("../internals/object-define-properties"),J=e("../internals/object-property-is-enumerable"),U=e("../internals/define-built-in"),G=e("../internals/define-built-in-accessor"),I=e("../internals/shared"),C=e("../internals/shared-key"),L=e("../internals/hidden-keys"),B=e("../internals/uid"),O=e("../internals/well-known-symbol"),q=e("../internals/well-known-symbol-wrapped"),it=e("../internals/well-known-symbol-define"),nt=e("../internals/symbol-define-to-primitive"),lt=e("../internals/set-to-string-tag"),ut=e("../internals/internal-state"),vt=e("../internals/array-iteration").forEach,Q=C("hidden"),gt=ut.set,Y=ut.getterFor("Symbol"),H=Object.prototype,at=o.Symbol,ft=at&&at.prototype,wt=o.RangeError,_t=o.TypeError,Dt=o.QObject,Gt=Z.f,te=tt.f,mt=K.f,At=J.f,Ot=u([].push),Zt=I("symbols"),he=I("op-symbols"),fe=I("wks"),be=!Dt||!Dt.prototype||!Dt.prototype.findChild,Me=function(Ze,ke,Qe){var hn=Gt(H,ke);hn&&delete H[ke],te(Ze,ke,Qe),hn&&Ze!==H&&te(H,ke,hn)},Pe=h&&d(function(){return D(te({},"a",{get:function(){return te(this,"a",{value:7}).a}})).a!==7})?Me:te,ze=function(Ze,ke){var Qe=Zt[Ze]=D(ft);return gt(Qe,{type:"Symbol",tag:Ze,description:ke}),h||(Qe.description=ke),Qe},Ce=function(Ze,ke,Qe){Ze===H&&Ce(he,ke,Qe),v(Ze);var hn=w(ke);return v(Qe),p(Zt,hn)?(Qe.enumerable?(p(Ze,Q)&&Ze[Q][hn]&&(Ze[Q][hn]=!1),Qe=D(Qe,{enumerable:E(0,!1)})):(p(Ze,Q)||te(Ze,Q,E(1,{})),Ze[Q][hn]=!0),Pe(Ze,hn,Qe)):te(Ze,hn,Qe)},Le=function(Ze,ke){v(Ze);var Qe=x(ke),hn=N(Qe).concat(Ke(Qe));return vt(hn,function(ln){h&&!r(Ye,Qe,ln)||Ce(Ze,ln,Qe[ln])}),Ze},Ye=function(Ze){var ke=w(Ze),Qe=r(At,this,ke);return!(this===H&&p(Zt,ke)&&!p(he,ke))&&(!(Qe||!p(this,ke)||!p(Zt,ke)||p(this,Q)&&this[Q][ke])||Qe)},le=function(Ze,ke){var Qe=x(Ze),hn=w(ke);if(Qe!==H||!p(Zt,hn)||p(he,hn)){var ln=Gt(Qe,hn);return!ln||!p(Zt,hn)||p(Qe,Q)&&Qe[Q][hn]||(ln.enumerable=!0),ln}},Fe=function(Ze){var ke=mt(x(Ze)),Qe=[];return vt(ke,function(hn){p(Zt,hn)||p(L,hn)||Ot(Qe,hn)}),Qe},Ke=function(Ze){var ke=Ze===H,Qe=mt(ke?he:x(Ze)),hn=[];return vt(Qe,function(ln){!p(Zt,ln)||ke&&!p(H,ln)||Ot(hn,Zt[ln])}),hn};f||(U(ft=(at=function(){if(b(ft,this))throw new _t("Symbol is not a constructor");var Ze=arguments.length&&arguments[0]!==void 0?M(arguments[0]):void 0,ke=B(Ze),Qe=function(hn){this===H&&r(Qe,he,hn),p(this,Q)&&p(this[Q],ke)&&(this[Q][ke]=!1);var ln=E(1,hn);try{Pe(this,ke,ln)}catch(Hn){if(!(Hn instanceof wt))throw Hn;Me(this,ke,ln)}};return h&&be&&Pe(H,ke,{configurable:!0,set:Qe}),ze(ke,Ze)}).prototype,"toString",function(){return Y(this).tag}),U(at,"withoutSetter",function(Ze){return ze(B(Ze),Ze)}),J.f=Ye,tt.f=Ce,rt.f=Le,Z.f=le,V.f=K.f=Fe,j.f=Ke,q.f=function(Ze){return ze(O(Ze),Ze)},h&&(G(ft,"description",{configurable:!0,get:function(){return Y(this).description}}),l||U(H,"propertyIsEnumerable",Ye,{unsafe:!0}))),a({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:at}),vt(N(fe),function(Ze){it(Ze)}),a({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){be=!0},useSimple:function(){be=!1}}),a({target:"Object",stat:!0,forced:!f,sham:!h},{create:function(Ze,ke){return ke===void 0?D(Ze):Le(D(Ze),ke)},defineProperty:Ce,defineProperties:Le,getOwnPropertyDescriptor:le}),a({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:Fe}),nt(),lt(at,"Symbol"),L[Q]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/get-built-in"),r=e("../internals/has-own-property"),u=e("../internals/to-string"),l=e("../internals/shared"),h=e("../internals/symbol-registry-detection"),f=l("string-to-symbol-registry"),d=l("symbol-to-string-registry");a({target:"Symbol",stat:!0,forced:!h},{for:function(p){var b=u(p);if(r(f,b))return f[b];var v=o("Symbol")(b);return f[b]=v,d[v]=b,v}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,i,s){e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,i,s){var a=e("../internals/export"),o=e("../internals/has-own-property"),r=e("../internals/is-symbol"),u=e("../internals/try-to-string"),l=e("../internals/shared"),h=e("../internals/symbol-registry-detection"),f=l("symbol-to-string-registry");a({target:"Symbol",stat:!0,forced:!h},{keyFor:function(d){if(!r(d))throw new TypeError(u(d)+" is not a symbol");if(o(f,d))return f[d]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,i,s){function a(o){return Object.prototype.toString.call(o)}s.isArray=function(o){return Array.isArray?Array.isArray(o):a(o)==="[object Array]"},s.isBoolean=function(o){return typeof o=="boolean"},s.isNull=function(o){return o===null},s.isNullOrUndefined=function(o){return o==null},s.isNumber=function(o){return typeof o=="number"},s.isString=function(o){return typeof o=="string"},s.isSymbol=function(o){return typeof o=="symbol"},s.isUndefined=function(o){return o===void 0},s.isRegExp=function(o){return a(o)==="[object RegExp]"},s.isObject=function(o){return typeof o=="object"&&o!==null},s.isDate=function(o){return a(o)==="[object Date]"},s.isError=function(o){return a(o)==="[object Error]"||o instanceof Error},s.isFunction=function(o){return typeof o=="function"},s.isPrimitive=function(o){return o===null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||typeof o=="symbol"||o===void 0},s.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,i,s){(function(a){(function(){var o=e("elliptic"),r=e("bn.js");i.exports=function(f){return new l(f)};var u={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function l(f){this.curveType=u[f],this.curveType||(this.curveType={name:f}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}function h(f,d,p){Array.isArray(f)||(f=f.toArray());var b=new a(f);if(p&&b.length<p){var v=new a(p-b.length);v.fill(0),b=a.concat([v,b])}return d?b.toString(d):b}u.p224=u.secp224r1,u.p256=u.secp256r1=u.prime256v1,u.p192=u.secp192r1=u.prime192v1,u.p384=u.secp384r1,u.p521=u.secp521r1,l.prototype.generateKeys=function(f,d){return this.keys=this.curve.genKeyPair(),this.getPublicKey(f,d)},l.prototype.computeSecret=function(f,d,p){return d=d||"utf8",a.isBuffer(f)||(f=new a(f,d)),h(this.curve.keyFromPublic(f).getPublic().mul(this.keys.getPrivate()).getX(),p,this.curveType.byteLength)},l.prototype.getPublicKey=function(f,d){var p=this.keys.getPublic(d==="compressed",!0);return d==="hybrid"&&(p[p.length-1]%2?p[0]=7:p[0]=6),h(p,f)},l.prototype.getPrivateKey=function(f){return h(this.keys.getPrivate(),f)},l.prototype.setPublicKey=function(f,d){return d=d||"utf8",a.isBuffer(f)||(f=new a(f,d)),this.keys._importPublic(f),this},l.prototype.setPrivateKey=function(f,d){d=d||"utf8",a.isBuffer(f)||(f=new a(f,d));var p=new r(f);return p=p.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(p),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,i,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],386:[function(e,i,s){var a=e("inherits"),o=e("md5.js"),r=e("ripemd160"),u=e("sha.js"),l=e("cipher-base");function h(f){l.call(this,"digest"),this._hash=f}a(h,l),h.prototype._update=function(f){this._hash.update(f)},h.prototype._final=function(){return this._hash.digest()},i.exports=function(f){return(f=f.toLowerCase())==="md5"?new o:f==="rmd160"||f==="ripemd160"?new r:new h(u(f))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,i,s){var a=e("md5.js");i.exports=function(o){return new a().update(o).digest()}},{"md5.js":450}],388:[function(e,i,s){var a=e("inherits"),o=e("./legacy"),r=e("cipher-base"),u=e("safe-buffer").Buffer,l=e("create-hash/md5"),h=e("ripemd160"),f=e("sha.js"),d=u.alloc(128);function p(b,v){r.call(this,"digest"),typeof v=="string"&&(v=u.from(v));var x=b==="sha512"||b==="sha384"?128:64;this._alg=b,this._key=v,v.length>x?v=(b==="rmd160"?new h:f(b)).update(v).digest():v.length<x&&(v=u.concat([v,d],x));for(var w=this._ipad=u.allocUnsafe(x),M=this._opad=u.allocUnsafe(x),E=0;E<x;E++)w[E]=54^v[E],M[E]=92^v[E];this._hash=b==="rmd160"?new h:f(b),this._hash.update(w)}a(p,r),p.prototype._update=function(b){this._hash.update(b)},p.prototype._final=function(){var b=this._hash.digest();return(this._alg==="rmd160"?new h:f(this._alg)).update(this._opad).update(b).digest()},i.exports=function(b,v){return(b=b.toLowerCase())==="rmd160"||b==="ripemd160"?new p("rmd160",v):b==="md5"?new o(l,v):new p(b,v)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,i,s){var a=e("inherits"),o=e("safe-buffer").Buffer,r=e("cipher-base"),u=o.alloc(128);function l(h,f){r.call(this,"digest"),typeof f=="string"&&(f=o.from(f)),this._alg=h,this._key=f,f.length>64?f=h(f):f.length<64&&(f=o.concat([f,u],64));for(var d=this._ipad=o.allocUnsafe(64),p=this._opad=o.allocUnsafe(64),b=0;b<64;b++)d[b]=54^f[b],p[b]=92^f[b];this._hash=[d]}a(l,r),l.prototype._update=function(h){this._hash.push(h)},l.prototype._final=function(){var h=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,h]))},i.exports=l},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,i,s){s.randomBytes=s.rng=s.pseudoRandomBytes=s.prng=e("randombytes"),s.createHash=s.Hash=e("create-hash"),s.createHmac=s.Hmac=e("create-hmac");var a=e("browserify-sign/algos"),o=Object.keys(a),r=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);s.getHashes=function(){return r};var u=e("pbkdf2");s.pbkdf2=u.pbkdf2,s.pbkdf2Sync=u.pbkdf2Sync;var l=e("browserify-cipher");s.Cipher=l.Cipher,s.createCipher=l.createCipher,s.Cipheriv=l.Cipheriv,s.createCipheriv=l.createCipheriv,s.Decipher=l.Decipher,s.createDecipher=l.createDecipher,s.Decipheriv=l.Decipheriv,s.createDecipheriv=l.createDecipheriv,s.getCiphers=l.getCiphers,s.listCiphers=l.listCiphers;var h=e("diffie-hellman");s.DiffieHellmanGroup=h.DiffieHellmanGroup,s.createDiffieHellmanGroup=h.createDiffieHellmanGroup,s.getDiffieHellman=h.getDiffieHellman,s.createDiffieHellman=h.createDiffieHellman,s.DiffieHellman=h.DiffieHellman;var f=e("browserify-sign");s.createSign=f.createSign,s.Sign=f.Sign,s.createVerify=f.createVerify,s.Verify=f.Verify,s.createECDH=e("create-ecdh");var d=e("public-encrypt");s.publicEncrypt=d.publicEncrypt,s.privateEncrypt=d.privateEncrypt,s.publicDecrypt=d.publicDecrypt,s.privateDecrypt=d.privateDecrypt;var p=e("randomfill");s.randomFill=p.randomFill,s.randomFillSync=p.randomFillSync,s.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},s.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,i,s){(function(a,o){typeof s=="object"&&i!==void 0?i.exports=o():(a=typeof globalThis!="undefined"?globalThis:a||self).dayjs=o()})(void 0,function(){var a=6e4,o=36e5,r="millisecond",u="second",l="minute",h="hour",f="day",d="week",p="month",b="quarter",v="year",x="date",w="Invalid Date",M=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,D={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(C){var L=["th","st","nd","rd"],B=C%100;return"["+C+(L[(B-20)%10]||L[B]||L[0])+"]"}},N=function(C,L,B){var O=String(C);return!O||O.length>=L?C:""+Array(L+1-O.length).join(B)+C},V={s:N,z:function(C){var L=-C.utcOffset(),B=Math.abs(L),O=Math.floor(B/60),q=B%60;return(L<=0?"+":"-")+N(O,2,"0")+":"+N(q,2,"0")},m:function C(L,B){if(L.date()<B.date())return-C(B,L);var O=12*(B.year()-L.year())+(B.month()-L.month()),q=L.clone().add(O,p),it=B-q<0,nt=L.clone().add(O+(it?-1:1),p);return+(-(O+(B-q)/(it?q-nt:nt-q))||0)},a:function(C){return C<0?Math.ceil(C)||0:Math.floor(C)},p:function(C){return{M:p,y:v,w:d,d:f,D:x,h,m:l,s:u,ms:r,Q:b}[C]||String(C||"").toLowerCase().replace(/s$/,"")},u:function(C){return C===void 0}},K="en",j={};j[K]=D;var Z="$isDayjsObject",tt=function(C){return C instanceof G||!(!C||!C[Z])},rt=function C(L,B,O){var q;if(!L)return K;if(typeof L=="string"){var it=L.toLowerCase();j[it]&&(q=it),B&&(j[it]=B,q=it);var nt=L.split("-");if(!q&&nt.length>1)return C(nt[0])}else{var lt=L.name;j[lt]=L,q=lt}return!O&&q&&(K=q),q||!O&&K},J=function(C,L){if(tt(C))return C.clone();var B=typeof L=="object"?L:{};return B.date=C,B.args=arguments,new G(B)},U=V;U.l=rt,U.i=tt,U.w=function(C,L){return J(C,{locale:L.$L,utc:L.$u,x:L.$x,$offset:L.$offset})};var G=function(){function C(B){this.$L=rt(B.locale,null,!0),this.parse(B),this.$x=this.$x||B.x||{},this[Z]=!0}var L=C.prototype;return L.parse=function(B){this.$d=function(O){var q=O.date,it=O.utc;if(q===null)return new Date(NaN);if(U.u(q))return new Date;if(q instanceof Date)return new Date(q);if(typeof q=="string"&&!/Z$/i.test(q)){var nt=q.match(M);if(nt){var lt=nt[2]-1||0,ut=(nt[7]||"0").substring(0,3);return it?new Date(Date.UTC(nt[1],lt,nt[3]||1,nt[4]||0,nt[5]||0,nt[6]||0,ut)):new Date(nt[1],lt,nt[3]||1,nt[4]||0,nt[5]||0,nt[6]||0,ut)}}return new Date(q)}(B),this.init()},L.init=function(){var B=this.$d;this.$y=B.getFullYear(),this.$M=B.getMonth(),this.$D=B.getDate(),this.$W=B.getDay(),this.$H=B.getHours(),this.$m=B.getMinutes(),this.$s=B.getSeconds(),this.$ms=B.getMilliseconds()},L.$utils=function(){return U},L.isValid=function(){return this.$d.toString()!==w},L.isSame=function(B,O){var q=J(B);return this.startOf(O)<=q&&q<=this.endOf(O)},L.isAfter=function(B,O){return J(B)<this.startOf(O)},L.isBefore=function(B,O){return this.endOf(O)<J(B)},L.$g=function(B,O,q){return U.u(B)?this[O]:this.set(q,B)},L.unix=function(){return Math.floor(this.valueOf()/1e3)},L.valueOf=function(){return this.$d.getTime()},L.startOf=function(B,O){var q=this,it=!!U.u(O)||O,nt=U.p(B),lt=function(ft,wt){var _t=U.w(q.$u?Date.UTC(q.$y,wt,ft):new Date(q.$y,wt,ft),q);return it?_t:_t.endOf(f)},ut=function(ft,wt){return U.w(q.toDate()[ft].apply(q.toDate("s"),(it?[0,0,0,0]:[23,59,59,999]).slice(wt)),q)},vt=this.$W,Q=this.$M,gt=this.$D,Y="set"+(this.$u?"UTC":"");switch(nt){case v:return it?lt(1,0):lt(31,11);case p:return it?lt(1,Q):lt(0,Q+1);case d:var H=this.$locale().weekStart||0,at=(vt<H?vt+7:vt)-H;return lt(it?gt-at:gt+(6-at),Q);case f:case x:return ut(Y+"Hours",0);case h:return ut(Y+"Minutes",1);case l:return ut(Y+"Seconds",2);case u:return ut(Y+"Milliseconds",3);default:return this.clone()}},L.endOf=function(B){return this.startOf(B,!1)},L.$set=function(B,O){var q,it=U.p(B),nt="set"+(this.$u?"UTC":""),lt=(q={},q[f]=nt+"Date",q[x]=nt+"Date",q[p]=nt+"Month",q[v]=nt+"FullYear",q[h]=nt+"Hours",q[l]=nt+"Minutes",q[u]=nt+"Seconds",q[r]=nt+"Milliseconds",q)[it],ut=it===f?this.$D+(O-this.$W):O;if(it===p||it===v){var vt=this.clone().set(x,1);vt.$d[lt](ut),vt.init(),this.$d=vt.set(x,Math.min(this.$D,vt.daysInMonth())).$d}else lt&&this.$d[lt](ut);return this.init(),this},L.set=function(B,O){return this.clone().$set(B,O)},L.get=function(B){return this[U.p(B)]()},L.add=function(B,O){var q,it=this;B=Number(B);var nt=U.p(O),lt=function(Q){var gt=J(it);return U.w(gt.date(gt.date()+Math.round(Q*B)),it)};if(nt===p)return this.set(p,this.$M+B);if(nt===v)return this.set(v,this.$y+B);if(nt===f)return lt(1);if(nt===d)return lt(7);var ut=(q={},q[l]=a,q[h]=o,q[u]=1e3,q)[nt]||1,vt=this.$d.getTime()+B*ut;return U.w(vt,this)},L.subtract=function(B,O){return this.add(-1*B,O)},L.format=function(B){var O=this,q=this.$locale();if(!this.isValid())return q.invalidDate||w;var it=B||"YYYY-MM-DDTHH:mm:ssZ",nt=U.z(this),lt=this.$H,ut=this.$m,vt=this.$M,Q=q.weekdays,gt=q.months,Y=q.meridiem,H=function(wt,_t,Dt,Gt){return wt&&(wt[_t]||wt(O,it))||Dt[_t].slice(0,Gt)},at=function(wt){return U.s(lt%12||12,wt,"0")},ft=Y||function(wt,_t,Dt){var Gt=wt<12?"AM":"PM";return Dt?Gt.toLowerCase():Gt};return it.replace(E,function(wt,_t){return _t||function(Dt){switch(Dt){case"YY":return String(O.$y).slice(-2);case"YYYY":return U.s(O.$y,4,"0");case"M":return vt+1;case"MM":return U.s(vt+1,2,"0");case"MMM":return H(q.monthsShort,vt,gt,3);case"MMMM":return H(gt,vt);case"D":return O.$D;case"DD":return U.s(O.$D,2,"0");case"d":return String(O.$W);case"dd":return H(q.weekdaysMin,O.$W,Q,2);case"ddd":return H(q.weekdaysShort,O.$W,Q,3);case"dddd":return Q[O.$W];case"H":return String(lt);case"HH":return U.s(lt,2,"0");case"h":return at(1);case"hh":return at(2);case"a":return ft(lt,ut,!0);case"A":return ft(lt,ut,!1);case"m":return String(ut);case"mm":return U.s(ut,2,"0");case"s":return String(O.$s);case"ss":return U.s(O.$s,2,"0");case"SSS":return U.s(O.$ms,3,"0");case"Z":return nt}return null}(wt)||nt.replace(":","")})},L.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},L.diff=function(B,O,q){var it,nt=this,lt=U.p(O),ut=J(B),vt=(ut.utcOffset()-this.utcOffset())*a,Q=this-ut,gt=function(){return U.m(nt,ut)};switch(lt){case v:it=gt()/12;break;case p:it=gt();break;case b:it=gt()/3;break;case d:it=(Q-vt)/6048e5;break;case f:it=(Q-vt)/864e5;break;case h:it=Q/o;break;case l:it=Q/a;break;case u:it=Q/1e3;break;default:it=Q}return q?it:U.a(it)},L.daysInMonth=function(){return this.endOf(p).$D},L.$locale=function(){return j[this.$L]},L.locale=function(B,O){if(!B)return this.$L;var q=this.clone(),it=rt(B,O,!0);return it&&(q.$L=it),q},L.clone=function(){return U.w(this.$d,this)},L.toDate=function(){return new Date(this.valueOf())},L.toJSON=function(){return this.isValid()?this.toISOString():null},L.toISOString=function(){return this.$d.toISOString()},L.toString=function(){return this.$d.toUTCString()},C}(),I=G.prototype;return J.prototype=I,[["$ms",r],["$s",u],["$m",l],["$H",h],["$W",f],["$M",p],["$y",v],["$D",x]].forEach(function(C){I[C[1]]=function(L){return this.$g(L,C[0],C[1])}}),J.extend=function(C,L){return C.$i||(C(L,G,J),C.$i=!0),J},J.locale=rt,J.isDayjs=tt,J.unix=function(C){return J(1e3*C)},J.en=j[K],J.Ls=j,J.p={},J})},{}],392:[function(e,i,s){(function(a,o){typeof s=="object"&&i!==void 0?i.exports=o():(a=typeof globalThis!="undefined"?globalThis:a||self).dayjs_plugin_customParseFormat=o()})(void 0,function(){var a={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,u=/\d\d?/,l=/\d*[^-_:/,()\s\d]+/,h={},f=function(M){return(M=+M)+(M>68?1900:2e3)},d=function(M){return function(E){this[M]=+E}},p=[/[+-]\d\d:?(\d\d)?|Z/,function(M){(this.zone||(this.zone={})).offset=function(E){if(!E||E==="Z")return 0;var D=E.match(/([+-]|\d\d)/g),N=60*D[1]+(+D[2]||0);return N===0?0:D[0]==="+"?-N:N}(M)}],b=function(M){var E=h[M];return E&&(E.indexOf?E:E.s.concat(E.f))},v=function(M,E){var D,N=h.meridiem;if(N){for(var V=1;V<=24;V+=1)if(M.indexOf(N(V,0,E))>-1){D=V>12;break}}else D=M===(E?"pm":"PM");return D},x={A:[l,function(M){this.afternoon=v(M,!1)}],a:[l,function(M){this.afternoon=v(M,!0)}],S:[/\d/,function(M){this.milliseconds=100*+M}],SS:[r,function(M){this.milliseconds=10*+M}],SSS:[/\d{3}/,function(M){this.milliseconds=+M}],s:[u,d("seconds")],ss:[u,d("seconds")],m:[u,d("minutes")],mm:[u,d("minutes")],H:[u,d("hours")],h:[u,d("hours")],HH:[u,d("hours")],hh:[u,d("hours")],D:[u,d("day")],DD:[r,d("day")],Do:[l,function(M){var E=h.ordinal,D=M.match(/\d+/);if(this.day=D[0],E)for(var N=1;N<=31;N+=1)E(N).replace(/\[|\]/g,"")===M&&(this.day=N)}],M:[u,d("month")],MM:[r,d("month")],MMM:[l,function(M){var E=b("months"),D=(b("monthsShort")||E.map(function(N){return N.slice(0,3)})).indexOf(M)+1;if(D<1)throw new Error;this.month=D%12||D}],MMMM:[l,function(M){var E=b("months").indexOf(M)+1;if(E<1)throw new Error;this.month=E%12||E}],Y:[/[+-]?\d+/,d("year")],YY:[r,function(M){this.year=f(M)}],YYYY:[/\d{4}/,d("year")],Z:p,ZZ:p};function w(M){var E,D;E=M,D=h&&h.formats;for(var N=(M=E.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(J,U,G){var I=G&&G.toUpperCase();return U||D[G]||a[G]||D[I].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(C,L,B){return L||B.slice(1)})})).match(o),V=N.length,K=0;K<V;K+=1){var j=N[K],Z=x[j],tt=Z&&Z[0],rt=Z&&Z[1];N[K]=rt?{regex:tt,parser:rt}:j.replace(/^\[|\]$/g,"")}return function(J){for(var U={},G=0,I=0;G<V;G+=1){var C=N[G];if(typeof C=="string")I+=C.length;else{var L=C.regex,B=C.parser,O=J.slice(I),q=L.exec(O)[0];B.call(U,q),J=J.replace(q,"")}}return function(it){var nt=it.afternoon;if(nt!==void 0){var lt=it.hours;nt?lt<12&&(it.hours+=12):lt===12&&(it.hours=0),delete it.afternoon}}(U),U}}return function(M,E,D){D.p.customParseFormat=!0,M&&M.parseTwoDigitYear&&(f=M.parseTwoDigitYear);var N=E.prototype,V=N.parse;N.parse=function(K){var j=K.date,Z=K.utc,tt=K.args;this.$u=Z;var rt=tt[1];if(typeof rt=="string"){var J=tt[2]===!0,U=tt[3]===!0,G=J||U,I=tt[2];U&&(I=tt[2]),h=this.$locale(),!J&&I&&(h=D.Ls[I]),this.$d=function(O,q,it){try{if(["x","X"].indexOf(q)>-1)return new Date((q==="X"?1e3:1)*O);var nt=w(q)(O),lt=nt.year,ut=nt.month,vt=nt.day,Q=nt.hours,gt=nt.minutes,Y=nt.seconds,H=nt.milliseconds,at=nt.zone,ft=new Date,wt=vt||(lt||ut?1:ft.getDate()),_t=lt||ft.getFullYear(),Dt=0;lt&&!ut||(Dt=ut>0?ut-1:ft.getMonth());var Gt=Q||0,te=gt||0,mt=Y||0,At=H||0;return at?new Date(Date.UTC(_t,Dt,wt,Gt,te,mt,At+60*at.offset*1e3)):it?new Date(Date.UTC(_t,Dt,wt,Gt,te,mt,At)):new Date(_t,Dt,wt,Gt,te,mt,At)}catch(Ot){return new Date("")}}(j,rt,Z),this.init(),I&&I!==!0&&(this.$L=this.locale(I).$L),G&&j!=this.format(rt)&&(this.$d=new Date("")),h={}}else if(rt instanceof Array)for(var C=rt.length,L=1;L<=C;L+=1){tt[1]=rt[L-1];var B=D.apply(this,tt);if(B.isValid()){this.$d=B.$d,this.$L=B.$L,this.init();break}L===C&&(this.$d=new Date(""))}else V.call(this,K)}}})},{}],393:[function(e,i,s){(function(a,o){typeof s=="object"&&i!==void 0?i.exports=o():(a=typeof globalThis!="undefined"?globalThis:a||self).dayjs_plugin_utc=o()})(void 0,function(){var a="minute",o=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(u,l,h){var f=l.prototype;h.utc=function(M){var E={date:M,utc:!0,args:arguments};return new l(E)},f.utc=function(M){var E=h(this.toDate(),{locale:this.$L,utc:!0});return M?E.add(this.utcOffset(),a):E},f.local=function(){return h(this.toDate(),{locale:this.$L,utc:!1})};var d=f.parse;f.parse=function(M){M.utc&&(this.$u=!0),this.$utils().u(M.$offset)||(this.$offset=M.$offset),d.call(this,M)};var p=f.init;f.init=function(){if(this.$u){var M=this.$d;this.$y=M.getUTCFullYear(),this.$M=M.getUTCMonth(),this.$D=M.getUTCDate(),this.$W=M.getUTCDay(),this.$H=M.getUTCHours(),this.$m=M.getUTCMinutes(),this.$s=M.getUTCSeconds(),this.$ms=M.getUTCMilliseconds()}else p.call(this)};var b=f.utcOffset;f.utcOffset=function(M,E){var D=this.$utils().u;if(D(M))return this.$u?0:D(this.$offset)?b.call(this):this.$offset;if(typeof M=="string"&&(M=function(j){j===void 0&&(j="");var Z=j.match(o);if(!Z)return null;var tt=(""+Z[0]).match(r)||["-",0,0],rt=tt[0],J=60*+tt[1]+ +tt[2];return J===0?0:rt==="+"?J:-J}(M))===null)return this;var N=Math.abs(M)<=16?60*M:M,V=this;if(E)return V.$offset=N,V.$u=M===0,V;if(M!==0){var K=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(V=this.local().add(N+K,a)).$offset=N,V.$x.$localOffset=K}else V=this.utc();return V};var v=f.format;f.format=function(M){var E=M||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return v.call(this,E)},f.valueOf=function(){var M=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*M},f.isUTC=function(){return!!this.$u},f.toISOString=function(){return this.toDate().toISOString()},f.toString=function(){return this.toDate().toUTCString()};var x=f.toDate;f.toDate=function(M){return M==="s"&&this.$offset?h(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():x.call(this)};var w=f.diff;f.diff=function(M,E,D){if(M&&this.$u===M.$u)return w.call(this,M,E,D);var N=this.local(),V=h(M).local();return w.call(N,V,E,D)}}})},{}],394:[function(e,i,s){s.utils=e("./des/utils"),s.Cipher=e("./des/cipher"),s.DES=e("./des/des"),s.CBC=e("./des/cbc"),s.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,i,s){var a=e("minimalistic-assert"),o=e("inherits"),r={};function u(l){a.equal(l.length,8,"Invalid IV length"),this.iv=new Array(8);for(var h=0;h<this.iv.length;h++)this.iv[h]=l[h]}s.instantiate=function(l){function h(b){l.call(this,b),this._cbcInit()}o(h,l);for(var f=Object.keys(r),d=0;d<f.length;d++){var p=f[d];h.prototype[p]=r[p]}return h.create=function(b){return new h(b)},h},r._cbcInit=function(){var l=new u(this.options.iv);this._cbcState=l},r._update=function(l,h,f,d){var p=this._cbcState,b=this.constructor.super_.prototype,v=p.iv;if(this.type==="encrypt"){for(var x=0;x<this.blockSize;x++)v[x]^=l[h+x];for(b._update.call(this,v,0,f,d),x=0;x<this.blockSize;x++)v[x]=f[d+x]}else{for(b._update.call(this,l,h,f,d),x=0;x<this.blockSize;x++)f[d+x]^=v[x];for(x=0;x<this.blockSize;x++)v[x]=l[h+x]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,i,s){var a=e("minimalistic-assert");function o(r){this.options=r,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=r.padding!==!1}i.exports=o,o.prototype._init=function(){},o.prototype.update=function(r){return r.length===0?[]:this.type==="decrypt"?this._updateDecrypt(r):this._updateEncrypt(r)},o.prototype._buffer=function(r,u){for(var l=Math.min(this.buffer.length-this.bufferOff,r.length-u),h=0;h<l;h++)this.buffer[this.bufferOff+h]=r[u+h];return this.bufferOff+=l,l},o.prototype._flushBuffer=function(r,u){return this._update(this.buffer,0,r,u),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(r){var u=0,l=0,h=(this.bufferOff+r.length)/this.blockSize|0,f=new Array(h*this.blockSize);this.bufferOff!==0&&(u+=this._buffer(r,u),this.bufferOff===this.buffer.length&&(l+=this._flushBuffer(f,l)));for(var d=r.length-(r.length-u)%this.blockSize;u<d;u+=this.blockSize)this._update(r,u,f,l),l+=this.blockSize;for(;u<r.length;u++,this.bufferOff++)this.buffer[this.bufferOff]=r[u];return f},o.prototype._updateDecrypt=function(r){for(var u=0,l=0,h=Math.ceil((this.bufferOff+r.length)/this.blockSize)-1,f=new Array(h*this.blockSize);h>0;h--)u+=this._buffer(r,u),l+=this._flushBuffer(f,l);return u+=this._buffer(r,u),f},o.prototype.final=function(r){var u,l;return r&&(u=this.update(r)),l=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),u?u.concat(l):l},o.prototype._pad=function(r,u){if(u===0)return!1;for(;u<r.length;)r[u++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var r=new Array(this.blockSize);return this._update(this.buffer,0,r,0),r},o.prototype._unpad=function(r){return r},o.prototype._finalDecrypt=function(){a.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var r=new Array(this.blockSize);return this._flushBuffer(r,0),this._unpad(r)}},{"minimalistic-assert":453}],397:[function(e,i,s){var a=e("minimalistic-assert"),o=e("inherits"),r=e("./utils"),u=e("./cipher");function l(){this.tmp=new Array(2),this.keys=null}function h(d){u.call(this,d);var p=new l;this._desState=p,this.deriveKeys(p,d.key)}o(h,u),i.exports=h,h.create=function(d){return new h(d)};var f=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];h.prototype.deriveKeys=function(d,p){d.keys=new Array(32),a.equal(p.length,this.blockSize,"Invalid key length");var b=r.readUInt32BE(p,0),v=r.readUInt32BE(p,4);r.pc1(b,v,d.tmp,0),b=d.tmp[0],v=d.tmp[1];for(var x=0;x<d.keys.length;x+=2){var w=f[x>>>1];b=r.r28shl(b,w),v=r.r28shl(v,w),r.pc2(b,v,d.keys,x)}},h.prototype._update=function(d,p,b,v){var x=this._desState,w=r.readUInt32BE(d,p),M=r.readUInt32BE(d,p+4);r.ip(w,M,x.tmp,0),w=x.tmp[0],M=x.tmp[1],this.type==="encrypt"?this._encrypt(x,w,M,x.tmp,0):this._decrypt(x,w,M,x.tmp,0),w=x.tmp[0],M=x.tmp[1],r.writeUInt32BE(b,w,v),r.writeUInt32BE(b,M,v+4)},h.prototype._pad=function(d,p){if(this.padding===!1)return!1;for(var b=d.length-p,v=p;v<d.length;v++)d[v]=b;return!0},h.prototype._unpad=function(d){if(this.padding===!1)return d;for(var p=d[d.length-1],b=d.length-p;b<d.length;b++)a.equal(d[b],p);return d.slice(0,d.length-p)},h.prototype._encrypt=function(d,p,b,v,x){for(var w=p,M=b,E=0;E<d.keys.length;E+=2){var D=d.keys[E],N=d.keys[E+1];r.expand(M,d.tmp,0),D^=d.tmp[0],N^=d.tmp[1];var V=r.substitute(D,N),K=M;M=(w^r.permute(V))>>>0,w=K}r.rip(M,w,v,x)},h.prototype._decrypt=function(d,p,b,v,x){for(var w=b,M=p,E=d.keys.length-2;E>=0;E-=2){var D=d.keys[E],N=d.keys[E+1];r.expand(w,d.tmp,0),D^=d.tmp[0],N^=d.tmp[1];var V=r.substitute(D,N),K=w;w=(M^r.permute(V))>>>0,M=K}r.rip(w,M,v,x)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,i,s){var a=e("minimalistic-assert"),o=e("inherits"),r=e("./cipher"),u=e("./des");function l(f,d){a.equal(d.length,24,"Invalid key length");var p=d.slice(0,8),b=d.slice(8,16),v=d.slice(16,24);this.ciphers=f==="encrypt"?[u.create({type:"encrypt",key:p}),u.create({type:"decrypt",key:b}),u.create({type:"encrypt",key:v})]:[u.create({type:"decrypt",key:v}),u.create({type:"encrypt",key:b}),u.create({type:"decrypt",key:p})]}function h(f){r.call(this,f);var d=new l(this.type,this.options.key);this._edeState=d}o(h,r),i.exports=h,h.create=function(f){return new h(f)},h.prototype._update=function(f,d,p,b){var v=this._edeState;v.ciphers[0]._update(f,d,p,b),v.ciphers[1]._update(p,b,p,b),v.ciphers[2]._update(p,b,p,b)},h.prototype._pad=u.prototype._pad,h.prototype._unpad=u.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,i,s){s.readUInt32BE=function(u,l){return(u[0+l]<<24|u[1+l]<<16|u[2+l]<<8|u[3+l])>>>0},s.writeUInt32BE=function(u,l,h){u[0+h]=l>>>24,u[1+h]=l>>>16&255,u[2+h]=l>>>8&255,u[3+h]=255&l},s.ip=function(u,l,h,f){for(var d=0,p=0,b=6;b>=0;b-=2){for(var v=0;v<=24;v+=8)d<<=1,d|=l>>>v+b&1;for(v=0;v<=24;v+=8)d<<=1,d|=u>>>v+b&1}for(b=6;b>=0;b-=2){for(v=1;v<=25;v+=8)p<<=1,p|=l>>>v+b&1;for(v=1;v<=25;v+=8)p<<=1,p|=u>>>v+b&1}h[f+0]=d>>>0,h[f+1]=p>>>0},s.rip=function(u,l,h,f){for(var d=0,p=0,b=0;b<4;b++)for(var v=24;v>=0;v-=8)d<<=1,d|=l>>>v+b&1,d<<=1,d|=u>>>v+b&1;for(b=4;b<8;b++)for(v=24;v>=0;v-=8)p<<=1,p|=l>>>v+b&1,p<<=1,p|=u>>>v+b&1;h[f+0]=d>>>0,h[f+1]=p>>>0},s.pc1=function(u,l,h,f){for(var d=0,p=0,b=7;b>=5;b--){for(var v=0;v<=24;v+=8)d<<=1,d|=l>>v+b&1;for(v=0;v<=24;v+=8)d<<=1,d|=u>>v+b&1}for(v=0;v<=24;v+=8)d<<=1,d|=l>>v+b&1;for(b=1;b<=3;b++){for(v=0;v<=24;v+=8)p<<=1,p|=l>>v+b&1;for(v=0;v<=24;v+=8)p<<=1,p|=u>>v+b&1}for(v=0;v<=24;v+=8)p<<=1,p|=u>>v+b&1;h[f+0]=d>>>0,h[f+1]=p>>>0},s.r28shl=function(u,l){return u<<l&268435455|u>>>28-l};var a=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];s.pc2=function(u,l,h,f){for(var d=0,p=0,b=a.length>>>1,v=0;v<b;v++)d<<=1,d|=u>>>a[v]&1;for(v=b;v<a.length;v++)p<<=1,p|=l>>>a[v]&1;h[f+0]=d>>>0,h[f+1]=p>>>0},s.expand=function(u,l,h){var f=0,d=0;f=(1&u)<<5|u>>>27;for(var p=23;p>=15;p-=4)f<<=6,f|=u>>>p&63;for(p=11;p>=3;p-=4)d|=u>>>p&63,d<<=6;d|=(31&u)<<1|u>>>31,l[h+0]=f>>>0,l[h+1]=d>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];s.substitute=function(u,l){for(var h=0,f=0;f<4;f++)h<<=4,h|=o[64*f+(u>>>18-6*f&63)];for(f=0;f<4;f++)h<<=4,h|=o[256+64*f+(l>>>18-6*f&63)];return h>>>0};var r=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];s.permute=function(u){for(var l=0,h=0;h<r.length;h++)l<<=1,l|=u>>>r[h]&1;return l>>>0},s.padSplit=function(u,l,h){for(var f=u.toString(2);f.length<l;)f="0"+f;for(var d=[],p=0;p<l;p+=h)d.push(f.slice(p,p+h));return d.join(" ")}},{}],400:[function(e,i,s){(function(a){(function(){var o=e("./lib/generatePrime"),r=e("./lib/primes.json"),u=e("./lib/dh"),l={binary:!0,hex:!0,base64:!0};s.DiffieHellmanGroup=s.createDiffieHellmanGroup=s.getDiffieHellman=function(h){var f=new a(r[h].prime,"hex"),d=new a(r[h].gen,"hex");return new u(f,d)},s.createDiffieHellman=s.DiffieHellman=function h(f,d,p,b){return a.isBuffer(d)||l[d]===void 0?h(f,"binary",d,p):(d=d||"binary",b=b||"binary",p=p||new a([2]),a.isBuffer(p)||(p=new a(p,b)),typeof f=="number"?new u(o(f,p),p,!0):(a.isBuffer(f)||(f=new a(f,d)),new u(f,p,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,i,s){(function(a){(function(){var o=e("bn.js"),r=new(e("miller-rabin")),u=new o(24),l=new o(11),h=new o(10),f=new o(3),d=new o(7),p=e("./generatePrime"),b=e("randombytes");function v(D,N){return N=N||"utf8",a.isBuffer(D)||(D=new a(D,N)),this._pub=new o(D),this}function x(D,N){return N=N||"utf8",a.isBuffer(D)||(D=new a(D,N)),this._priv=new o(D),this}i.exports=M;var w={};function M(D,N,V){this.setGenerator(N),this.__prime=new o(D),this._prime=o.mont(this.__prime),this._primeLen=D.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,V?(this.setPublicKey=v,this.setPrivateKey=x):this._primeCode=8}function E(D,N){var V=new a(D.toArray());return N?V.toString(N):V}Object.defineProperty(M.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(D,N){var V=N.toString("hex"),K=[V,D.toString(16)].join("_");if(K in w)return w[K];var j,Z=0;if(D.isEven()||!p.simpleSieve||!p.fermatTest(D)||!r.test(D))return Z+=1,Z+=V==="02"||V==="05"?8:4,w[K]=Z,Z;switch(r.test(D.shrn(1))||(Z+=2),V){case"02":D.mod(u).cmp(l)&&(Z+=8);break;case"05":(j=D.mod(h)).cmp(f)&&j.cmp(d)&&(Z+=8);break;default:Z+=4}return w[K]=Z,Z}(this.__prime,this.__gen)),this._primeCode}}),M.prototype.generateKeys=function(){return this._priv||(this._priv=new o(b(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},M.prototype.computeSecret=function(D){var N=(D=(D=new o(D)).toRed(this._prime)).redPow(this._priv).fromRed(),V=new a(N.toArray()),K=this.getPrime();if(V.length<K.length){var j=new a(K.length-V.length);j.fill(0),V=a.concat([j,V])}return V},M.prototype.getPublicKey=function(D){return E(this._pub,D)},M.prototype.getPrivateKey=function(D){return E(this._priv,D)},M.prototype.getPrime=function(D){return E(this.__prime,D)},M.prototype.getGenerator=function(D){return E(this._gen,D)},M.prototype.setGenerator=function(D,N){return N=N||"utf8",a.isBuffer(D)||(D=new a(D,N)),this.__gen=D,this._gen=new o(D),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,i,s){var a=e("randombytes");i.exports=D,D.simpleSieve=M,D.fermatTest=E;var o=e("bn.js"),r=new o(24),u=new(e("miller-rabin")),l=new o(1),h=new o(2),f=new o(5),d=(new o(16),new o(8),new o(10)),p=new o(3),b=(new o(7),new o(11)),v=new o(4),x=(new o(12),null);function w(){if(x!==null)return x;var N=[];N[0]=2;for(var V=1,K=3;K<1048576;K+=2){for(var j=Math.ceil(Math.sqrt(K)),Z=0;Z<V&&N[Z]<=j&&K%N[Z]!=0;Z++);V!==Z&&N[Z]<=j||(N[V++]=K)}return x=N,N}function M(N){for(var V=w(),K=0;K<V.length;K++)if(N.modn(V[K])===0)return N.cmpn(V[K])===0;return!0}function E(N){var V=o.mont(N);return h.toRed(V).redPow(N.subn(1)).fromRed().cmpn(1)===0}function D(N,V){if(N<16)return new o(V===2||V===5?[140,123]:[140,39]);var K,j;for(V=new o(V);;){for(K=new o(a(Math.ceil(N/8)));K.bitLength()>N;)K.ishrn(1);if(K.isEven()&&K.iadd(l),K.testn(1)||K.iadd(h),V.cmp(h)){if(!V.cmp(f))for(;K.mod(d).cmp(p);)K.iadd(v)}else for(;K.mod(r).cmp(b);)K.iadd(v);if(M(j=K.shrn(1))&&M(K)&&E(j)&&E(K)&&u.test(j)&&u.test(K))return K}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,i,s){i.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,i,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],405:[function(e,i,s){var a=s;a.version=e("../package.json").version,a.utils=e("./elliptic/utils"),a.rand=e("brorand"),a.curve=e("./elliptic/curve"),a.curves=e("./elliptic/curves"),a.ec=e("./elliptic/ec"),a.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,i,s){var a=e("bn.js"),o=e("../utils"),r=o.getNAF,u=o.getJSF,l=o.assert;function h(d,p){this.type=d,this.p=new a(p.p,16),this.red=p.prime?a.red(p.prime):a.mont(this.p),this.zero=new a(0).toRed(this.red),this.one=new a(1).toRed(this.red),this.two=new a(2).toRed(this.red),this.n=p.n&&new a(p.n,16),this.g=p.g&&this.pointFromJSON(p.g,p.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var b=this.n&&this.p.div(this.n);!b||b.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function f(d,p){this.curve=d,this.type=p,this.precomputed=null}i.exports=h,h.prototype.point=function(){throw new Error("Not implemented")},h.prototype.validate=function(){throw new Error("Not implemented")},h.prototype._fixedNafMul=function(d,p){l(d.precomputed);var b=d._getDoubles(),v=r(p,1,this._bitLength),x=(1<<b.step+1)-(b.step%2==0?2:1);x/=3;var w,M,E=[];for(w=0;w<v.length;w+=b.step){M=0;for(var D=w+b.step-1;D>=w;D--)M=(M<<1)+v[D];E.push(M)}for(var N=this.jpoint(null,null,null),V=this.jpoint(null,null,null),K=x;K>0;K--){for(w=0;w<E.length;w++)(M=E[w])===K?V=V.mixedAdd(b.points[w]):M===-K&&(V=V.mixedAdd(b.points[w].neg()));N=N.add(V)}return N.toP()},h.prototype._wnafMul=function(d,p){var b=4,v=d._getNAFPoints(b);b=v.wnd;for(var x=v.points,w=r(p,b,this._bitLength),M=this.jpoint(null,null,null),E=w.length-1;E>=0;E--){for(var D=0;E>=0&&w[E]===0;E--)D++;if(E>=0&&D++,M=M.dblp(D),E<0)break;var N=w[E];l(N!==0),M=d.type==="affine"?N>0?M.mixedAdd(x[N-1>>1]):M.mixedAdd(x[-N-1>>1].neg()):N>0?M.add(x[N-1>>1]):M.add(x[-N-1>>1].neg())}return d.type==="affine"?M.toP():M},h.prototype._wnafMulAdd=function(d,p,b,v,x){var w,M,E,D=this._wnafT1,N=this._wnafT2,V=this._wnafT3,K=0;for(w=0;w<v;w++){var j=(E=p[w])._getNAFPoints(d);D[w]=j.wnd,N[w]=j.points}for(w=v-1;w>=1;w-=2){var Z=w-1,tt=w;if(D[Z]===1&&D[tt]===1){var rt=[p[Z],null,null,p[tt]];p[Z].y.cmp(p[tt].y)===0?(rt[1]=p[Z].add(p[tt]),rt[2]=p[Z].toJ().mixedAdd(p[tt].neg())):p[Z].y.cmp(p[tt].y.redNeg())===0?(rt[1]=p[Z].toJ().mixedAdd(p[tt]),rt[2]=p[Z].add(p[tt].neg())):(rt[1]=p[Z].toJ().mixedAdd(p[tt]),rt[2]=p[Z].toJ().mixedAdd(p[tt].neg()));var J=[-3,-1,-5,-7,0,7,5,1,3],U=u(b[Z],b[tt]);for(K=Math.max(U[0].length,K),V[Z]=new Array(K),V[tt]=new Array(K),M=0;M<K;M++){var G=0|U[0][M],I=0|U[1][M];V[Z][M]=J[3*(G+1)+(I+1)],V[tt][M]=0,N[Z]=rt}}else V[Z]=r(b[Z],D[Z],this._bitLength),V[tt]=r(b[tt],D[tt],this._bitLength),K=Math.max(V[Z].length,K),K=Math.max(V[tt].length,K)}var C=this.jpoint(null,null,null),L=this._wnafT4;for(w=K;w>=0;w--){for(var B=0;w>=0;){var O=!0;for(M=0;M<v;M++)L[M]=0|V[M][w],L[M]!==0&&(O=!1);if(!O)break;B++,w--}if(w>=0&&B++,C=C.dblp(B),w<0)break;for(M=0;M<v;M++){var q=L[M];q!==0&&(q>0?E=N[M][q-1>>1]:q<0&&(E=N[M][-q-1>>1].neg()),C=E.type==="affine"?C.mixedAdd(E):C.add(E))}}for(w=0;w<v;w++)N[w]=null;return x?C:C.toP()},h.BasePoint=f,f.prototype.eq=function(){throw new Error("Not implemented")},f.prototype.validate=function(){return this.curve.validate(this)},h.prototype.decodePoint=function(d,p){d=o.toArray(d,p);var b=this.p.byteLength();if((d[0]===4||d[0]===6||d[0]===7)&&d.length-1==2*b)return d[0]===6?l(d[d.length-1]%2==0):d[0]===7&&l(d[d.length-1]%2==1),this.point(d.slice(1,1+b),d.slice(1+b,1+2*b));if((d[0]===2||d[0]===3)&&d.length-1===b)return this.pointFromX(d.slice(1,1+b),d[0]===3);throw new Error("Unknown point format")},f.prototype.encodeCompressed=function(d){return this.encode(d,!0)},f.prototype._encode=function(d){var p=this.curve.p.byteLength(),b=this.getX().toArray("be",p);return d?[this.getY().isEven()?2:3].concat(b):[4].concat(b,this.getY().toArray("be",p))},f.prototype.encode=function(d,p){return o.encode(this._encode(p),d)},f.prototype.precompute=function(d){if(this.precomputed)return this;var p={doubles:null,naf:null,beta:null};return p.naf=this._getNAFPoints(8),p.doubles=this._getDoubles(4,d),p.beta=this._getBeta(),this.precomputed=p,this},f.prototype._hasDoubles=function(d){if(!this.precomputed)return!1;var p=this.precomputed.doubles;return!!p&&p.points.length>=Math.ceil((d.bitLength()+1)/p.step)},f.prototype._getDoubles=function(d,p){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var b=[this],v=this,x=0;x<p;x+=d){for(var w=0;w<d;w++)v=v.dbl();b.push(v)}return{step:d,points:b}},f.prototype._getNAFPoints=function(d){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var p=[this],b=(1<<d)-1,v=b===1?null:this.dbl(),x=1;x<b;x++)p[x]=p[x-1].add(v);return{wnd:d,points:p}},f.prototype._getBeta=function(){return null},f.prototype.dblp=function(d){for(var p=this,b=0;b<d;b++)p=p.dbl();return p}},{"../utils":419,"bn.js":420}],407:[function(e,i,s){var a=e("../utils"),o=e("bn.js"),r=e("inherits"),u=e("./base"),l=a.assert;function h(d){this.twisted=(0|d.a)!=1,this.mOneA=this.twisted&&(0|d.a)==-1,this.extended=this.mOneA,u.call(this,"edwards",d),this.a=new o(d.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(d.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(d.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),l(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|d.c)==1}function f(d,p,b,v,x){u.BasePoint.call(this,d,"projective"),p===null&&b===null&&v===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(p,16),this.y=new o(b,16),this.z=v?new o(v,16):this.curve.one,this.t=x&&new o(x,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}r(h,u),i.exports=h,h.prototype._mulA=function(d){return this.mOneA?d.redNeg():this.a.redMul(d)},h.prototype._mulC=function(d){return this.oneC?d:this.c.redMul(d)},h.prototype.jpoint=function(d,p,b,v){return this.point(d,p,b,v)},h.prototype.pointFromX=function(d,p){(d=new o(d,16)).red||(d=d.toRed(this.red));var b=d.redSqr(),v=this.c2.redSub(this.a.redMul(b)),x=this.one.redSub(this.c2.redMul(this.d).redMul(b)),w=v.redMul(x.redInvm()),M=w.redSqrt();if(M.redSqr().redSub(w).cmp(this.zero)!==0)throw new Error("invalid point");var E=M.fromRed().isOdd();return(p&&!E||!p&&E)&&(M=M.redNeg()),this.point(d,M)},h.prototype.pointFromY=function(d,p){(d=new o(d,16)).red||(d=d.toRed(this.red));var b=d.redSqr(),v=b.redSub(this.c2),x=b.redMul(this.d).redMul(this.c2).redSub(this.a),w=v.redMul(x.redInvm());if(w.cmp(this.zero)===0){if(p)throw new Error("invalid point");return this.point(this.zero,d)}var M=w.redSqrt();if(M.redSqr().redSub(w).cmp(this.zero)!==0)throw new Error("invalid point");return M.fromRed().isOdd()!==p&&(M=M.redNeg()),this.point(M,d)},h.prototype.validate=function(d){if(d.isInfinity())return!0;d.normalize();var p=d.x.redSqr(),b=d.y.redSqr(),v=p.redMul(this.a).redAdd(b),x=this.c2.redMul(this.one.redAdd(this.d.redMul(p).redMul(b)));return v.cmp(x)===0},r(f,u.BasePoint),h.prototype.pointFromJSON=function(d){return f.fromJSON(this,d)},h.prototype.point=function(d,p,b,v){return new f(this,d,p,b,v)},f.fromJSON=function(d,p){return new f(d,p[0],p[1],p[2])},f.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},f.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},f.prototype._extDbl=function(){var d=this.x.redSqr(),p=this.y.redSqr(),b=this.z.redSqr();b=b.redIAdd(b);var v=this.curve._mulA(d),x=this.x.redAdd(this.y).redSqr().redISub(d).redISub(p),w=v.redAdd(p),M=w.redSub(b),E=v.redSub(p),D=x.redMul(M),N=w.redMul(E),V=x.redMul(E),K=M.redMul(w);return this.curve.point(D,N,K,V)},f.prototype._projDbl=function(){var d,p,b,v,x,w,M=this.x.redAdd(this.y).redSqr(),E=this.x.redSqr(),D=this.y.redSqr();if(this.curve.twisted){var N=(v=this.curve._mulA(E)).redAdd(D);this.zOne?(d=M.redSub(E).redSub(D).redMul(N.redSub(this.curve.two)),p=N.redMul(v.redSub(D)),b=N.redSqr().redSub(N).redSub(N)):(x=this.z.redSqr(),w=N.redSub(x).redISub(x),d=M.redSub(E).redISub(D).redMul(w),p=N.redMul(v.redSub(D)),b=N.redMul(w))}else v=E.redAdd(D),x=this.curve._mulC(this.z).redSqr(),w=v.redSub(x).redSub(x),d=this.curve._mulC(M.redISub(v)).redMul(w),p=this.curve._mulC(v).redMul(E.redISub(D)),b=v.redMul(w);return this.curve.point(d,p,b)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},f.prototype._extAdd=function(d){var p=this.y.redSub(this.x).redMul(d.y.redSub(d.x)),b=this.y.redAdd(this.x).redMul(d.y.redAdd(d.x)),v=this.t.redMul(this.curve.dd).redMul(d.t),x=this.z.redMul(d.z.redAdd(d.z)),w=b.redSub(p),M=x.redSub(v),E=x.redAdd(v),D=b.redAdd(p),N=w.redMul(M),V=E.redMul(D),K=w.redMul(D),j=M.redMul(E);return this.curve.point(N,V,j,K)},f.prototype._projAdd=function(d){var p,b,v=this.z.redMul(d.z),x=v.redSqr(),w=this.x.redMul(d.x),M=this.y.redMul(d.y),E=this.curve.d.redMul(w).redMul(M),D=x.redSub(E),N=x.redAdd(E),V=this.x.redAdd(this.y).redMul(d.x.redAdd(d.y)).redISub(w).redISub(M),K=v.redMul(D).redMul(V);return this.curve.twisted?(p=v.redMul(N).redMul(M.redSub(this.curve._mulA(w))),b=D.redMul(N)):(p=v.redMul(N).redMul(M.redSub(w)),b=this.curve._mulC(D).redMul(N)),this.curve.point(K,p,b)},f.prototype.add=function(d){return this.isInfinity()?d:d.isInfinity()?this:this.curve.extended?this._extAdd(d):this._projAdd(d)},f.prototype.mul=function(d){return this._hasDoubles(d)?this.curve._fixedNafMul(this,d):this.curve._wnafMul(this,d)},f.prototype.mulAdd=function(d,p,b){return this.curve._wnafMulAdd(1,[this,p],[d,b],2,!1)},f.prototype.jmulAdd=function(d,p,b){return this.curve._wnafMulAdd(1,[this,p],[d,b],2,!0)},f.prototype.normalize=function(){if(this.zOne)return this;var d=this.z.redInvm();return this.x=this.x.redMul(d),this.y=this.y.redMul(d),this.t&&(this.t=this.t.redMul(d)),this.z=this.curve.one,this.zOne=!0,this},f.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},f.prototype.getX=function(){return this.normalize(),this.x.fromRed()},f.prototype.getY=function(){return this.normalize(),this.y.fromRed()},f.prototype.eq=function(d){return this===d||this.getX().cmp(d.getX())===0&&this.getY().cmp(d.getY())===0},f.prototype.eqXToP=function(d){var p=d.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(p)===0)return!0;for(var b=d.clone(),v=this.curve.redN.redMul(this.z);;){if(b.iadd(this.curve.n),b.cmp(this.curve.p)>=0)return!1;if(p.redIAdd(v),this.x.cmp(p)===0)return!0}},f.prototype.toP=f.prototype.normalize,f.prototype.mixedAdd=f.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,i,s){var a=s;a.base=e("./base"),a.short=e("./short"),a.mont=e("./mont"),a.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,i,s){var a=e("bn.js"),o=e("inherits"),r=e("./base"),u=e("../utils");function l(f){r.call(this,"mont",f),this.a=new a(f.a,16).toRed(this.red),this.b=new a(f.b,16).toRed(this.red),this.i4=new a(4).toRed(this.red).redInvm(),this.two=new a(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function h(f,d,p){r.BasePoint.call(this,f,"projective"),d===null&&p===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new a(d,16),this.z=new a(p,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(l,r),i.exports=l,l.prototype.validate=function(f){var d=f.normalize().x,p=d.redSqr(),b=p.redMul(d).redAdd(p.redMul(this.a)).redAdd(d);return b.redSqrt().redSqr().cmp(b)===0},o(h,r.BasePoint),l.prototype.decodePoint=function(f,d){return this.point(u.toArray(f,d),1)},l.prototype.point=function(f,d){return new h(this,f,d)},l.prototype.pointFromJSON=function(f){return h.fromJSON(this,f)},h.prototype.precompute=function(){},h.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},h.fromJSON=function(f,d){return new h(f,d[0],d[1]||f.one)},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.z.cmpn(0)===0},h.prototype.dbl=function(){var f=this.x.redAdd(this.z).redSqr(),d=this.x.redSub(this.z).redSqr(),p=f.redSub(d),b=f.redMul(d),v=p.redMul(d.redAdd(this.curve.a24.redMul(p)));return this.curve.point(b,v)},h.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},h.prototype.diffAdd=function(f,d){var p=this.x.redAdd(this.z),b=this.x.redSub(this.z),v=f.x.redAdd(f.z),x=f.x.redSub(f.z).redMul(p),w=v.redMul(b),M=d.z.redMul(x.redAdd(w).redSqr()),E=d.x.redMul(x.redISub(w).redSqr());return this.curve.point(M,E)},h.prototype.mul=function(f){for(var d=f.clone(),p=this,b=this.curve.point(null,null),v=[];d.cmpn(0)!==0;d.iushrn(1))v.push(d.andln(1));for(var x=v.length-1;x>=0;x--)v[x]===0?(p=p.diffAdd(b,this),b=b.dbl()):(b=p.diffAdd(b,this),p=p.dbl());return b},h.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},h.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},h.prototype.eq=function(f){return this.getX().cmp(f.getX())===0},h.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,i,s){var a=e("../utils"),o=e("bn.js"),r=e("inherits"),u=e("./base"),l=a.assert;function h(p){u.call(this,"short",p),this.a=new o(p.a,16).toRed(this.red),this.b=new o(p.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(p),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function f(p,b,v,x){u.BasePoint.call(this,p,"affine"),b===null&&v===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(b,16),this.y=new o(v,16),x&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function d(p,b,v,x){u.BasePoint.call(this,p,"jacobian"),b===null&&v===null&&x===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(b,16),this.y=new o(v,16),this.z=new o(x,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}r(h,u),i.exports=h,h.prototype._getEndomorphism=function(p){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var b,v;if(p.beta)b=new o(p.beta,16).toRed(this.red);else{var x=this._getEndoRoots(this.p);b=(b=x[0].cmp(x[1])<0?x[0]:x[1]).toRed(this.red)}if(p.lambda)v=new o(p.lambda,16);else{var w=this._getEndoRoots(this.n);this.g.mul(w[0]).x.cmp(this.g.x.redMul(b))===0?v=w[0]:(v=w[1],l(this.g.mul(v).x.cmp(this.g.x.redMul(b))===0))}return{beta:b,lambda:v,basis:p.basis?p.basis.map(function(M){return{a:new o(M.a,16),b:new o(M.b,16)}}):this._getEndoBasis(v)}}},h.prototype._getEndoRoots=function(p){var b=p===this.p?this.red:o.mont(p),v=new o(2).toRed(b).redInvm(),x=v.redNeg(),w=new o(3).toRed(b).redNeg().redSqrt().redMul(v);return[x.redAdd(w).fromRed(),x.redSub(w).fromRed()]},h.prototype._getEndoBasis=function(p){for(var b,v,x,w,M,E,D,N,V,K=this.n.ushrn(Math.floor(this.n.bitLength()/2)),j=p,Z=this.n.clone(),tt=new o(1),rt=new o(0),J=new o(0),U=new o(1),G=0;j.cmpn(0)!==0;){var I=Z.div(j);N=Z.sub(I.mul(j)),V=J.sub(I.mul(tt));var C=U.sub(I.mul(rt));if(!x&&N.cmp(K)<0)b=D.neg(),v=tt,x=N.neg(),w=V;else if(x&&++G==2)break;D=N,Z=j,j=N,J=tt,tt=V,U=rt,rt=C}M=N.neg(),E=V;var L=x.sqr().add(w.sqr());return M.sqr().add(E.sqr()).cmp(L)>=0&&(M=b,E=v),x.negative&&(x=x.neg(),w=w.neg()),M.negative&&(M=M.neg(),E=E.neg()),[{a:x,b:w},{a:M,b:E}]},h.prototype._endoSplit=function(p){var b=this.endo.basis,v=b[0],x=b[1],w=x.b.mul(p).divRound(this.n),M=v.b.neg().mul(p).divRound(this.n),E=w.mul(v.a),D=M.mul(x.a),N=w.mul(v.b),V=M.mul(x.b);return{k1:p.sub(E).sub(D),k2:N.add(V).neg()}},h.prototype.pointFromX=function(p,b){(p=new o(p,16)).red||(p=p.toRed(this.red));var v=p.redSqr().redMul(p).redIAdd(p.redMul(this.a)).redIAdd(this.b),x=v.redSqrt();if(x.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var w=x.fromRed().isOdd();return(b&&!w||!b&&w)&&(x=x.redNeg()),this.point(p,x)},h.prototype.validate=function(p){if(p.inf)return!0;var b=p.x,v=p.y,x=this.a.redMul(b),w=b.redSqr().redMul(b).redIAdd(x).redIAdd(this.b);return v.redSqr().redISub(w).cmpn(0)===0},h.prototype._endoWnafMulAdd=function(p,b,v){for(var x=this._endoWnafT1,w=this._endoWnafT2,M=0;M<p.length;M++){var E=this._endoSplit(b[M]),D=p[M],N=D._getBeta();E.k1.negative&&(E.k1.ineg(),D=D.neg(!0)),E.k2.negative&&(E.k2.ineg(),N=N.neg(!0)),x[2*M]=D,x[2*M+1]=N,w[2*M]=E.k1,w[2*M+1]=E.k2}for(var V=this._wnafMulAdd(1,x,w,2*M,v),K=0;K<2*M;K++)x[K]=null,w[K]=null;return V},r(f,u.BasePoint),h.prototype.point=function(p,b,v){return new f(this,p,b,v)},h.prototype.pointFromJSON=function(p,b){return f.fromJSON(this,p,b)},f.prototype._getBeta=function(){if(this.curve.endo){var p=this.precomputed;if(p&&p.beta)return p.beta;var b=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(p){var v=this.curve,x=function(w){return v.point(w.x.redMul(v.endo.beta),w.y)};p.beta=b,b.precomputed={beta:null,naf:p.naf&&{wnd:p.naf.wnd,points:p.naf.points.map(x)},doubles:p.doubles&&{step:p.doubles.step,points:p.doubles.points.map(x)}}}return b}},f.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},f.fromJSON=function(p,b,v){typeof b=="string"&&(b=JSON.parse(b));var x=p.point(b[0],b[1],v);if(!b[2])return x;function w(E){return p.point(E[0],E[1],v)}var M=b[2];return x.precomputed={beta:null,doubles:M.doubles&&{step:M.doubles.step,points:[x].concat(M.doubles.points.map(w))},naf:M.naf&&{wnd:M.naf.wnd,points:[x].concat(M.naf.points.map(w))}},x},f.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},f.prototype.isInfinity=function(){return this.inf},f.prototype.add=function(p){if(this.inf)return p;if(p.inf)return this;if(this.eq(p))return this.dbl();if(this.neg().eq(p))return this.curve.point(null,null);if(this.x.cmp(p.x)===0)return this.curve.point(null,null);var b=this.y.redSub(p.y);b.cmpn(0)!==0&&(b=b.redMul(this.x.redSub(p.x).redInvm()));var v=b.redSqr().redISub(this.x).redISub(p.x),x=b.redMul(this.x.redSub(v)).redISub(this.y);return this.curve.point(v,x)},f.prototype.dbl=function(){if(this.inf)return this;var p=this.y.redAdd(this.y);if(p.cmpn(0)===0)return this.curve.point(null,null);var b=this.curve.a,v=this.x.redSqr(),x=p.redInvm(),w=v.redAdd(v).redIAdd(v).redIAdd(b).redMul(x),M=w.redSqr().redISub(this.x.redAdd(this.x)),E=w.redMul(this.x.redSub(M)).redISub(this.y);return this.curve.point(M,E)},f.prototype.getX=function(){return this.x.fromRed()},f.prototype.getY=function(){return this.y.fromRed()},f.prototype.mul=function(p){return p=new o(p,16),this.isInfinity()?this:this._hasDoubles(p)?this.curve._fixedNafMul(this,p):this.curve.endo?this.curve._endoWnafMulAdd([this],[p]):this.curve._wnafMul(this,p)},f.prototype.mulAdd=function(p,b,v){var x=[this,b],w=[p,v];return this.curve.endo?this.curve._endoWnafMulAdd(x,w):this.curve._wnafMulAdd(1,x,w,2)},f.prototype.jmulAdd=function(p,b,v){var x=[this,b],w=[p,v];return this.curve.endo?this.curve._endoWnafMulAdd(x,w,!0):this.curve._wnafMulAdd(1,x,w,2,!0)},f.prototype.eq=function(p){return this===p||this.inf===p.inf&&(this.inf||this.x.cmp(p.x)===0&&this.y.cmp(p.y)===0)},f.prototype.neg=function(p){if(this.inf)return this;var b=this.curve.point(this.x,this.y.redNeg());if(p&&this.precomputed){var v=this.precomputed,x=function(w){return w.neg()};b.precomputed={naf:v.naf&&{wnd:v.naf.wnd,points:v.naf.points.map(x)},doubles:v.doubles&&{step:v.doubles.step,points:v.doubles.points.map(x)}}}return b},f.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},r(d,u.BasePoint),h.prototype.jpoint=function(p,b,v){return new d(this,p,b,v)},d.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var p=this.z.redInvm(),b=p.redSqr(),v=this.x.redMul(b),x=this.y.redMul(b).redMul(p);return this.curve.point(v,x)},d.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},d.prototype.add=function(p){if(this.isInfinity())return p;if(p.isInfinity())return this;var b=p.z.redSqr(),v=this.z.redSqr(),x=this.x.redMul(b),w=p.x.redMul(v),M=this.y.redMul(b.redMul(p.z)),E=p.y.redMul(v.redMul(this.z)),D=x.redSub(w),N=M.redSub(E);if(D.cmpn(0)===0)return N.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var V=D.redSqr(),K=V.redMul(D),j=x.redMul(V),Z=N.redSqr().redIAdd(K).redISub(j).redISub(j),tt=N.redMul(j.redISub(Z)).redISub(M.redMul(K)),rt=this.z.redMul(p.z).redMul(D);return this.curve.jpoint(Z,tt,rt)},d.prototype.mixedAdd=function(p){if(this.isInfinity())return p.toJ();if(p.isInfinity())return this;var b=this.z.redSqr(),v=this.x,x=p.x.redMul(b),w=this.y,M=p.y.redMul(b).redMul(this.z),E=v.redSub(x),D=w.redSub(M);if(E.cmpn(0)===0)return D.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var N=E.redSqr(),V=N.redMul(E),K=v.redMul(N),j=D.redSqr().redIAdd(V).redISub(K).redISub(K),Z=D.redMul(K.redISub(j)).redISub(w.redMul(V)),tt=this.z.redMul(E);return this.curve.jpoint(j,Z,tt)},d.prototype.dblp=function(p){if(p===0)return this;if(this.isInfinity())return this;if(!p)return this.dbl();var b;if(this.curve.zeroA||this.curve.threeA){var v=this;for(b=0;b<p;b++)v=v.dbl();return v}var x=this.curve.a,w=this.curve.tinv,M=this.x,E=this.y,D=this.z,N=D.redSqr().redSqr(),V=E.redAdd(E);for(b=0;b<p;b++){var K=M.redSqr(),j=V.redSqr(),Z=j.redSqr(),tt=K.redAdd(K).redIAdd(K).redIAdd(x.redMul(N)),rt=M.redMul(j),J=tt.redSqr().redISub(rt.redAdd(rt)),U=rt.redISub(J),G=tt.redMul(U);G=G.redIAdd(G).redISub(Z);var I=V.redMul(D);b+1<p&&(N=N.redMul(Z)),M=J,D=I,V=G}return this.curve.jpoint(M,V.redMul(w),D)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},d.prototype._zeroDbl=function(){var p,b,v;if(this.zOne){var x=this.x.redSqr(),w=this.y.redSqr(),M=w.redSqr(),E=this.x.redAdd(w).redSqr().redISub(x).redISub(M);E=E.redIAdd(E);var D=x.redAdd(x).redIAdd(x),N=D.redSqr().redISub(E).redISub(E),V=M.redIAdd(M);V=(V=V.redIAdd(V)).redIAdd(V),p=N,b=D.redMul(E.redISub(N)).redISub(V),v=this.y.redAdd(this.y)}else{var K=this.x.redSqr(),j=this.y.redSqr(),Z=j.redSqr(),tt=this.x.redAdd(j).redSqr().redISub(K).redISub(Z);tt=tt.redIAdd(tt);var rt=K.redAdd(K).redIAdd(K),J=rt.redSqr(),U=Z.redIAdd(Z);U=(U=U.redIAdd(U)).redIAdd(U),p=J.redISub(tt).redISub(tt),b=rt.redMul(tt.redISub(p)).redISub(U),v=(v=this.y.redMul(this.z)).redIAdd(v)}return this.curve.jpoint(p,b,v)},d.prototype._threeDbl=function(){var p,b,v;if(this.zOne){var x=this.x.redSqr(),w=this.y.redSqr(),M=w.redSqr(),E=this.x.redAdd(w).redSqr().redISub(x).redISub(M);E=E.redIAdd(E);var D=x.redAdd(x).redIAdd(x).redIAdd(this.curve.a),N=D.redSqr().redISub(E).redISub(E);p=N;var V=M.redIAdd(M);V=(V=V.redIAdd(V)).redIAdd(V),b=D.redMul(E.redISub(N)).redISub(V),v=this.y.redAdd(this.y)}else{var K=this.z.redSqr(),j=this.y.redSqr(),Z=this.x.redMul(j),tt=this.x.redSub(K).redMul(this.x.redAdd(K));tt=tt.redAdd(tt).redIAdd(tt);var rt=Z.redIAdd(Z),J=(rt=rt.redIAdd(rt)).redAdd(rt);p=tt.redSqr().redISub(J),v=this.y.redAdd(this.z).redSqr().redISub(j).redISub(K);var U=j.redSqr();U=(U=(U=U.redIAdd(U)).redIAdd(U)).redIAdd(U),b=tt.redMul(rt.redISub(p)).redISub(U)}return this.curve.jpoint(p,b,v)},d.prototype._dbl=function(){var p=this.curve.a,b=this.x,v=this.y,x=this.z,w=x.redSqr().redSqr(),M=b.redSqr(),E=v.redSqr(),D=M.redAdd(M).redIAdd(M).redIAdd(p.redMul(w)),N=b.redAdd(b),V=(N=N.redIAdd(N)).redMul(E),K=D.redSqr().redISub(V.redAdd(V)),j=V.redISub(K),Z=E.redSqr();Z=(Z=(Z=Z.redIAdd(Z)).redIAdd(Z)).redIAdd(Z);var tt=D.redMul(j).redISub(Z),rt=v.redAdd(v).redMul(x);return this.curve.jpoint(K,tt,rt)},d.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var p=this.x.redSqr(),b=this.y.redSqr(),v=this.z.redSqr(),x=b.redSqr(),w=p.redAdd(p).redIAdd(p),M=w.redSqr(),E=this.x.redAdd(b).redSqr().redISub(p).redISub(x),D=(E=(E=(E=E.redIAdd(E)).redAdd(E).redIAdd(E)).redISub(M)).redSqr(),N=x.redIAdd(x);N=(N=(N=N.redIAdd(N)).redIAdd(N)).redIAdd(N);var V=w.redIAdd(E).redSqr().redISub(M).redISub(D).redISub(N),K=b.redMul(V);K=(K=K.redIAdd(K)).redIAdd(K);var j=this.x.redMul(D).redISub(K);j=(j=j.redIAdd(j)).redIAdd(j);var Z=this.y.redMul(V.redMul(N.redISub(V)).redISub(E.redMul(D)));Z=(Z=(Z=Z.redIAdd(Z)).redIAdd(Z)).redIAdd(Z);var tt=this.z.redAdd(E).redSqr().redISub(v).redISub(D);return this.curve.jpoint(j,Z,tt)},d.prototype.mul=function(p,b){return p=new o(p,b),this.curve._wnafMul(this,p)},d.prototype.eq=function(p){if(p.type==="affine")return this.eq(p.toJ());if(this===p)return!0;var b=this.z.redSqr(),v=p.z.redSqr();if(this.x.redMul(v).redISub(p.x.redMul(b)).cmpn(0)!==0)return!1;var x=b.redMul(this.z),w=v.redMul(p.z);return this.y.redMul(w).redISub(p.y.redMul(x)).cmpn(0)===0},d.prototype.eqXToP=function(p){var b=this.z.redSqr(),v=p.toRed(this.curve.red).redMul(b);if(this.x.cmp(v)===0)return!0;for(var x=p.clone(),w=this.curve.redN.redMul(b);;){if(x.iadd(this.curve.n),x.cmp(this.curve.p)>=0)return!1;if(v.redIAdd(w),this.x.cmp(v)===0)return!0}},d.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},d.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,i,s){var a,o=s,r=e("hash.js"),u=e("./curve"),l=e("./utils").assert;function h(d){d.type==="short"?this.curve=new u.short(d):d.type==="edwards"?this.curve=new u.edwards(d):this.curve=new u.mont(d),this.g=this.curve.g,this.n=this.curve.n,this.hash=d.hash,l(this.g.validate(),"Invalid curve"),l(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function f(d,p){Object.defineProperty(o,d,{configurable:!0,enumerable:!0,get:function(){var b=new h(p);return Object.defineProperty(o,d,{configurable:!0,enumerable:!0,value:b}),b}})}o.PresetCurve=h,f("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),f("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),f("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),f("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),f("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),f("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),f("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{a=e("./precomputed/secp256k1")}catch(d){a=void 0}f("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",a]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,i,s){var a=e("bn.js"),o=e("hmac-drbg"),r=e("../utils"),u=e("../curves"),l=e("brorand"),h=r.assert,f=e("./key"),d=e("./signature");function p(b){if(!(this instanceof p))return new p(b);typeof b=="string"&&(h(Object.prototype.hasOwnProperty.call(u,b),"Unknown curve "+b),b=u[b]),b instanceof u.PresetCurve&&(b={curve:b}),this.curve=b.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=b.curve.g,this.g.precompute(b.curve.n.bitLength()+1),this.hash=b.hash||b.curve.hash}i.exports=p,p.prototype.keyPair=function(b){return new f(this,b)},p.prototype.keyFromPrivate=function(b,v){return f.fromPrivate(this,b,v)},p.prototype.keyFromPublic=function(b,v){return f.fromPublic(this,b,v)},p.prototype.genKeyPair=function(b){b||(b={});for(var v=new o({hash:this.hash,pers:b.pers,persEnc:b.persEnc||"utf8",entropy:b.entropy||l(this.hash.hmacStrength),entropyEnc:b.entropy&&b.entropyEnc||"utf8",nonce:this.n.toArray()}),x=this.n.byteLength(),w=this.n.sub(new a(2));;){var M=new a(v.generate(x));if(!(M.cmp(w)>0))return M.iaddn(1),this.keyFromPrivate(M)}},p.prototype._truncateToN=function(b,v){var x=8*b.byteLength()-this.n.bitLength();return x>0&&(b=b.ushrn(x)),!v&&b.cmp(this.n)>=0?b.sub(this.n):b},p.prototype.sign=function(b,v,x,w){typeof x=="object"&&(w=x,x=null),w||(w={}),v=this.keyFromPrivate(v,x),b=this._truncateToN(new a(b,16));for(var M=this.n.byteLength(),E=v.getPrivate().toArray("be",M),D=b.toArray("be",M),N=new o({hash:this.hash,entropy:E,nonce:D,pers:w.pers,persEnc:w.persEnc||"utf8"}),V=this.n.sub(new a(1)),K=0;;K++){var j=w.k?w.k(K):new a(N.generate(this.n.byteLength()));if(!((j=this._truncateToN(j,!0)).cmpn(1)<=0||j.cmp(V)>=0)){var Z=this.g.mul(j);if(!Z.isInfinity()){var tt=Z.getX(),rt=tt.umod(this.n);if(rt.cmpn(0)!==0){var J=j.invm(this.n).mul(rt.mul(v.getPrivate()).iadd(b));if((J=J.umod(this.n)).cmpn(0)!==0){var U=(Z.getY().isOdd()?1:0)|(tt.cmp(rt)!==0?2:0);return w.canonical&&J.cmp(this.nh)>0&&(J=this.n.sub(J),U^=1),new d({r:rt,s:J,recoveryParam:U})}}}}}},p.prototype.verify=function(b,v,x,w){b=this._truncateToN(new a(b,16)),x=this.keyFromPublic(x,w);var M=(v=new d(v,"hex")).r,E=v.s;if(M.cmpn(1)<0||M.cmp(this.n)>=0||E.cmpn(1)<0||E.cmp(this.n)>=0)return!1;var D,N=E.invm(this.n),V=N.mul(b).umod(this.n),K=N.mul(M).umod(this.n);return this.curve._maxwellTrick?!(D=this.g.jmulAdd(V,x.getPublic(),K)).isInfinity()&&D.eqXToP(M):!(D=this.g.mulAdd(V,x.getPublic(),K)).isInfinity()&&D.getX().umod(this.n).cmp(M)===0},p.prototype.recoverPubKey=function(b,v,x,w){h((3&x)===x,"The recovery param is more than two bits"),v=new d(v,w);var M=this.n,E=new a(b),D=v.r,N=v.s,V=1&x,K=x>>1;if(D.cmp(this.curve.p.umod(this.curve.n))>=0&&K)throw new Error("Unable to find sencond key candinate");D=K?this.curve.pointFromX(D.add(this.curve.n),V):this.curve.pointFromX(D,V);var j=v.r.invm(M),Z=M.sub(E).mul(j).umod(M),tt=N.mul(j).umod(M);return this.g.mulAdd(Z,D,tt)},p.prototype.getKeyRecoveryParam=function(b,v,x,w){if((v=new d(v,w)).recoveryParam!==null)return v.recoveryParam;for(var M=0;M<4;M++){var E;try{E=this.recoverPubKey(b,v,M)}catch(D){continue}if(E.eq(x))return M}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,i,s){var a=e("bn.js"),o=e("../utils").assert;function r(u,l){this.ec=u,this.priv=null,this.pub=null,l.priv&&this._importPrivate(l.priv,l.privEnc),l.pub&&this._importPublic(l.pub,l.pubEnc)}i.exports=r,r.fromPublic=function(u,l,h){return l instanceof r?l:new r(u,{pub:l,pubEnc:h})},r.fromPrivate=function(u,l,h){return l instanceof r?l:new r(u,{priv:l,privEnc:h})},r.prototype.validate=function(){var u=this.getPublic();return u.isInfinity()?{result:!1,reason:"Invalid public key"}:u.validate()?u.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},r.prototype.getPublic=function(u,l){return typeof u=="string"&&(l=u,u=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),l?this.pub.encode(l,u):this.pub},r.prototype.getPrivate=function(u){return u==="hex"?this.priv.toString(16,2):this.priv},r.prototype._importPrivate=function(u,l){this.priv=new a(u,l||16),this.priv=this.priv.umod(this.ec.curve.n)},r.prototype._importPublic=function(u,l){if(u.x||u.y)return this.ec.curve.type==="mont"?o(u.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||o(u.x&&u.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(u.x,u.y));this.pub=this.ec.curve.decodePoint(u,l)},r.prototype.derive=function(u){return u.validate()||o(u.validate(),"public point not validated"),u.mul(this.priv).getX()},r.prototype.sign=function(u,l,h){return this.ec.sign(u,this,l,h)},r.prototype.verify=function(u,l){return this.ec.verify(u,l,this)},r.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,i,s){var a=e("bn.js"),o=e("../utils"),r=o.assert;function u(p,b){if(p instanceof u)return p;this._importDER(p,b)||(r(p.r&&p.s,"Signature without r or s"),this.r=new a(p.r,16),this.s=new a(p.s,16),p.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=p.recoveryParam)}function l(){this.place=0}function h(p,b){var v=p[b.place++];if(!(128&v))return v;var x=15&v;if(x===0||x>4)return!1;for(var w=0,M=0,E=b.place;M<x;M++,E++)w<<=8,w|=p[E],w>>>=0;return!(w<=127)&&(b.place=E,w)}function f(p){for(var b=0,v=p.length-1;!p[b]&&!(128&p[b+1])&&b<v;)b++;return b===0?p:p.slice(b)}function d(p,b){if(b<128)p.push(b);else{var v=1+(Math.log(b)/Math.LN2>>>3);for(p.push(128|v);--v;)p.push(b>>>(v<<3)&255);p.push(b)}}i.exports=u,u.prototype._importDER=function(p,b){p=o.toArray(p,b);var v=new l;if(p[v.place++]!==48)return!1;var x=h(p,v);if(x===!1||x+v.place!==p.length||p[v.place++]!==2)return!1;var w=h(p,v);if(w===!1)return!1;var M=p.slice(v.place,w+v.place);if(v.place+=w,p[v.place++]!==2)return!1;var E=h(p,v);if(E===!1||p.length!==E+v.place)return!1;var D=p.slice(v.place,E+v.place);if(M[0]===0){if(!(128&M[1]))return!1;M=M.slice(1)}if(D[0]===0){if(!(128&D[1]))return!1;D=D.slice(1)}return this.r=new a(M),this.s=new a(D),this.recoveryParam=null,!0},u.prototype.toDER=function(p){var b=this.r.toArray(),v=this.s.toArray();for(128&b[0]&&(b=[0].concat(b)),128&v[0]&&(v=[0].concat(v)),b=f(b),v=f(v);!(v[0]||128&v[1]);)v=v.slice(1);var x=[2];d(x,b.length),(x=x.concat(b)).push(2),d(x,v.length);var w=x.concat(v),M=[48];return d(M,w.length),M=M.concat(w),o.encode(M,p)}},{"../utils":419,"bn.js":420}],415:[function(e,i,s){var a=e("hash.js"),o=e("../curves"),r=e("../utils"),u=r.assert,l=r.parseBytes,h=e("./key"),f=e("./signature");function d(p){if(u(p==="ed25519","only tested with ed25519 so far"),!(this instanceof d))return new d(p);p=o[p].curve,this.curve=p,this.g=p.g,this.g.precompute(p.n.bitLength()+1),this.pointClass=p.point().constructor,this.encodingLength=Math.ceil(p.n.bitLength()/8),this.hash=a.sha512}i.exports=d,d.prototype.sign=function(p,b){p=l(p);var v=this.keyFromSecret(b),x=this.hashInt(v.messagePrefix(),p),w=this.g.mul(x),M=this.encodePoint(w),E=this.hashInt(M,v.pubBytes(),p).mul(v.priv()),D=x.add(E).umod(this.curve.n);return this.makeSignature({R:w,S:D,Rencoded:M})},d.prototype.verify=function(p,b,v){p=l(p),b=this.makeSignature(b);var x=this.keyFromPublic(v),w=this.hashInt(b.Rencoded(),x.pubBytes(),p),M=this.g.mul(b.S());return b.R().add(x.pub().mul(w)).eq(M)},d.prototype.hashInt=function(){for(var p=this.hash(),b=0;b<arguments.length;b++)p.update(arguments[b]);return r.intFromLE(p.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(p){return h.fromPublic(this,p)},d.prototype.keyFromSecret=function(p){return h.fromSecret(this,p)},d.prototype.makeSignature=function(p){return p instanceof f?p:new f(this,p)},d.prototype.encodePoint=function(p){var b=p.getY().toArray("le",this.encodingLength);return b[this.encodingLength-1]|=p.getX().isOdd()?128:0,b},d.prototype.decodePoint=function(p){var b=(p=r.parseBytes(p)).length-1,v=p.slice(0,b).concat(-129&p[b]),x=(128&p[b])!=0,w=r.intFromLE(v);return this.curve.pointFromY(w,x)},d.prototype.encodeInt=function(p){return p.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(p){return r.intFromLE(p)},d.prototype.isPoint=function(p){return p instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,i,s){var a=e("../utils"),o=a.assert,r=a.parseBytes,u=a.cachedProperty;function l(h,f){this.eddsa=h,this._secret=r(f.secret),h.isPoint(f.pub)?this._pub=f.pub:this._pubBytes=r(f.pub)}l.fromPublic=function(h,f){return f instanceof l?f:new l(h,{pub:f})},l.fromSecret=function(h,f){return f instanceof l?f:new l(h,{secret:f})},l.prototype.secret=function(){return this._secret},u(l,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),u(l,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),u(l,"privBytes",function(){var h=this.eddsa,f=this.hash(),d=h.encodingLength-1,p=f.slice(0,h.encodingLength);return p[0]&=248,p[d]&=127,p[d]|=64,p}),u(l,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),u(l,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),u(l,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),l.prototype.sign=function(h){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(h,this)},l.prototype.verify=function(h,f){return this.eddsa.verify(h,f,this)},l.prototype.getSecret=function(h){return o(this._secret,"KeyPair is public only"),a.encode(this.secret(),h)},l.prototype.getPublic=function(h){return a.encode(this.pubBytes(),h)},i.exports=l},{"../utils":419}],417:[function(e,i,s){var a=e("bn.js"),o=e("../utils"),r=o.assert,u=o.cachedProperty,l=o.parseBytes;function h(f,d){this.eddsa=f,typeof d!="object"&&(d=l(d)),Array.isArray(d)&&(d={R:d.slice(0,f.encodingLength),S:d.slice(f.encodingLength)}),r(d.R&&d.S,"Signature without R or S"),f.isPoint(d.R)&&(this._R=d.R),d.S instanceof a&&(this._S=d.S),this._Rencoded=Array.isArray(d.R)?d.R:d.Rencoded,this._Sencoded=Array.isArray(d.S)?d.S:d.Sencoded}u(h,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),u(h,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),u(h,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),u(h,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),h.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},h.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},i.exports=h},{"../utils":419,"bn.js":420}],418:[function(e,i,s){i.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,i,s){var a=s,o=e("bn.js"),r=e("minimalistic-assert"),u=e("minimalistic-crypto-utils");a.assert=r,a.toArray=u.toArray,a.zero2=u.zero2,a.toHex=u.toHex,a.encode=u.encode,a.getNAF=function(l,h,f){var d=new Array(Math.max(l.bitLength(),f)+1);d.fill(0);for(var p=1<<h+1,b=l.clone(),v=0;v<d.length;v++){var x,w=b.andln(p-1);b.isOdd()?(x=w>(p>>1)-1?(p>>1)-w:w,b.isubn(x)):x=0,d[v]=x,b.iushrn(1)}return d},a.getJSF=function(l,h){var f=[[],[]];l=l.clone(),h=h.clone();for(var d,p=0,b=0;l.cmpn(-p)>0||h.cmpn(-b)>0;){var v,x,w=l.andln(3)+p&3,M=h.andln(3)+b&3;w===3&&(w=-1),M===3&&(M=-1),v=1&w?(d=l.andln(7)+p&7)!==3&&d!==5||M!==2?w:-w:0,f[0].push(v),x=1&M?(d=h.andln(7)+b&7)!==3&&d!==5||w!==2?M:-M:0,f[1].push(x),2*p===v+1&&(p=1-p),2*b===x+1&&(b=1-b),l.iushrn(1),h.iushrn(1)}return f},a.cachedProperty=function(l,h,f){var d="_"+h;l.prototype[h]=function(){return this[d]!==void 0?this[d]:this[d]=f.call(this)}},a.parseBytes=function(l){return typeof l=="string"?a.toArray(l,"hex"):l},a.intFromLE=function(l){return new o(l,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,i,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],421:[function(e,i,s){i.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,i,s){var a=Object.create||function(j){var Z=function(){};return Z.prototype=j,new Z},o=Object.keys||function(j){var Z=[];for(var tt in j)Object.prototype.hasOwnProperty.call(j,tt)&&Z.push(tt);return tt},r=Function.prototype.bind||function(j){var Z=this;return function(){return Z.apply(j,arguments)}};function u(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=a(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}i.exports=u,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._maxListeners=void 0;var l,h=10;try{var f={};Object.defineProperty&&Object.defineProperty(f,"x",{value:0}),l=f.x===0}catch(j){l=!1}function d(j){return j._maxListeners===void 0?u.defaultMaxListeners:j._maxListeners}function p(j,Z,tt){if(Z)j.call(tt);else for(var rt=j.length,J=K(j,rt),U=0;U<rt;++U)J[U].call(tt)}function b(j,Z,tt,rt){if(Z)j.call(tt,rt);else for(var J=j.length,U=K(j,J),G=0;G<J;++G)U[G].call(tt,rt)}function v(j,Z,tt,rt,J){if(Z)j.call(tt,rt,J);else for(var U=j.length,G=K(j,U),I=0;I<U;++I)G[I].call(tt,rt,J)}function x(j,Z,tt,rt,J,U){if(Z)j.call(tt,rt,J,U);else for(var G=j.length,I=K(j,G),C=0;C<G;++C)I[C].call(tt,rt,J,U)}function w(j,Z,tt,rt){if(Z)j.apply(tt,rt);else for(var J=j.length,U=K(j,J),G=0;G<J;++G)U[G].apply(tt,rt)}function M(j,Z,tt,rt){var J,U,G;if(typeof tt!="function")throw new TypeError('"listener" argument must be a function');if((U=j._events)?(U.newListener&&(j.emit("newListener",Z,tt.listener?tt.listener:tt),U=j._events),G=U[Z]):(U=j._events=a(null),j._eventsCount=0),G){if(typeof G=="function"?G=U[Z]=rt?[tt,G]:[G,tt]:rt?G.unshift(tt):G.push(tt),!G.warned&&(J=d(j))&&J>0&&G.length>J){G.warned=!0;var I=new Error("Possible EventEmitter memory leak detected. "+G.length+' "'+String(Z)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');I.name="MaxListenersExceededWarning",I.emitter=j,I.type=Z,I.count=G.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",I.name,I.message)}}else G=U[Z]=tt,++j._eventsCount;return j}function E(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var j=new Array(arguments.length),Z=0;Z<j.length;++Z)j[Z]=arguments[Z];this.listener.apply(this.target,j)}}function D(j,Z,tt){var rt={fired:!1,wrapFn:void 0,target:j,type:Z,listener:tt},J=r.call(E,rt);return J.listener=tt,rt.wrapFn=J,J}function N(j,Z,tt){var rt=j._events;if(!rt)return[];var J=rt[Z];return J?typeof J=="function"?tt?[J.listener||J]:[J]:tt?function(U){for(var G=new Array(U.length),I=0;I<G.length;++I)G[I]=U[I].listener||U[I];return G}(J):K(J,J.length):[]}function V(j){var Z=this._events;if(Z){var tt=Z[j];if(typeof tt=="function")return 1;if(tt)return tt.length}return 0}function K(j,Z){for(var tt=new Array(Z),rt=0;rt<Z;++rt)tt[rt]=j[rt];return tt}l?Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(j){if(typeof j!="number"||j<0||j!=j)throw new TypeError('"defaultMaxListeners" must be a positive number');h=j}}):u.defaultMaxListeners=h,u.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||isNaN(j))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=j,this},u.prototype.getMaxListeners=function(){return d(this)},u.prototype.emit=function(j){var Z,tt,rt,J,U,G,I=j==="error";if(G=this._events)I=I&&G.error==null;else if(!I)return!1;if(I){if(arguments.length>1&&(Z=arguments[1]),Z instanceof Error)throw Z;var C=new Error('Unhandled "error" event. ('+Z+")");throw C.context=Z,C}if(!(tt=G[j]))return!1;var L=typeof tt=="function";switch(rt=arguments.length){case 1:p(tt,L,this);break;case 2:b(tt,L,this,arguments[1]);break;case 3:v(tt,L,this,arguments[1],arguments[2]);break;case 4:x(tt,L,this,arguments[1],arguments[2],arguments[3]);break;default:for(J=new Array(rt-1),U=1;U<rt;U++)J[U-1]=arguments[U];w(tt,L,this,J)}return!0},u.prototype.addListener=function(j,Z){return M(this,j,Z,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(j,Z){return M(this,j,Z,!0)},u.prototype.once=function(j,Z){if(typeof Z!="function")throw new TypeError('"listener" argument must be a function');return this.on(j,D(this,j,Z)),this},u.prototype.prependOnceListener=function(j,Z){if(typeof Z!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(j,D(this,j,Z)),this},u.prototype.removeListener=function(j,Z){var tt,rt,J,U,G;if(typeof Z!="function")throw new TypeError('"listener" argument must be a function');if(!(rt=this._events))return this;if(!(tt=rt[j]))return this;if(tt===Z||tt.listener===Z)--this._eventsCount==0?this._events=a(null):(delete rt[j],rt.removeListener&&this.emit("removeListener",j,tt.listener||Z));else if(typeof tt!="function"){for(J=-1,U=tt.length-1;U>=0;U--)if(tt[U]===Z||tt[U].listener===Z){G=tt[U].listener,J=U;break}if(J<0)return this;J===0?tt.shift():function(I,C){for(var L=C,B=L+1,O=I.length;B<O;L+=1,B+=1)I[L]=I[B];I.pop()}(tt,J),tt.length===1&&(rt[j]=tt[0]),rt.removeListener&&this.emit("removeListener",j,G||Z)}return this},u.prototype.removeAllListeners=function(j){var Z,tt,rt;if(!(tt=this._events))return this;if(!tt.removeListener)return arguments.length===0?(this._events=a(null),this._eventsCount=0):tt[j]&&(--this._eventsCount==0?this._events=a(null):delete tt[j]),this;if(arguments.length===0){var J,U=o(tt);for(rt=0;rt<U.length;++rt)(J=U[rt])!=="removeListener"&&this.removeAllListeners(J);return this.removeAllListeners("removeListener"),this._events=a(null),this._eventsCount=0,this}if(typeof(Z=tt[j])=="function")this.removeListener(j,Z);else if(Z)for(rt=Z.length-1;rt>=0;rt--)this.removeListener(j,Z[rt]);return this},u.prototype.listeners=function(j){return N(this,j,!0)},u.prototype.rawListeners=function(j){return N(this,j,!1)},u.listenerCount=function(j,Z){return typeof j.listenerCount=="function"?j.listenerCount(Z):V.call(j,Z)},u.prototype.listenerCount=V,u.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("md5.js");i.exports=function(r,u,l,h){if(a.isBuffer(r)||(r=a.from(r,"binary")),u&&(a.isBuffer(u)||(u=a.from(u,"binary")),u.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var f=l/8,d=a.alloc(f),p=a.alloc(h||0),b=a.alloc(0);f>0||h>0;){var v=new o;v.update(b),v.update(r),u&&v.update(u),b=v.digest();var x=0;if(f>0){var w=d.length-f;x=Math.min(f,b.length),b.copy(d,w,0,x),f-=x}if(x<b.length&&h>0){var M=p.length-h,E=Math.min(h,b.length-x);b.copy(p,M,x,x+E),h-=E}}return b.fill(0),{key:d,iv:p}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.CsvParserStream=s.ParserOptions=s.parseFile=s.parseStream=s.parseString=s.parse=s.FormatterOptions=s.CsvFormatterStream=s.writeToPath=s.writeToString=s.writeToBuffer=s.writeToStream=s.write=s.format=void 0;var a=e("@fast-csv/format");Object.defineProperty(s,"format",{enumerable:!0,get:function(){return a.format}}),Object.defineProperty(s,"write",{enumerable:!0,get:function(){return a.write}}),Object.defineProperty(s,"writeToStream",{enumerable:!0,get:function(){return a.writeToStream}}),Object.defineProperty(s,"writeToBuffer",{enumerable:!0,get:function(){return a.writeToBuffer}}),Object.defineProperty(s,"writeToString",{enumerable:!0,get:function(){return a.writeToString}}),Object.defineProperty(s,"writeToPath",{enumerable:!0,get:function(){return a.writeToPath}}),Object.defineProperty(s,"CsvFormatterStream",{enumerable:!0,get:function(){return a.CsvFormatterStream}}),Object.defineProperty(s,"FormatterOptions",{enumerable:!0,get:function(){return a.FormatterOptions}});var o=e("@fast-csv/parse");Object.defineProperty(s,"parse",{enumerable:!0,get:function(){return o.parse}}),Object.defineProperty(s,"parseString",{enumerable:!0,get:function(){return o.parseString}}),Object.defineProperty(s,"parseStream",{enumerable:!0,get:function(){return o.parseStream}}),Object.defineProperty(s,"parseFile",{enumerable:!0,get:function(){return o.parseFile}}),Object.defineProperty(s,"ParserOptions",{enumerable:!0,get:function(){return o.ParserOptions}}),Object.defineProperty(s,"CsvParserStream",{enumerable:!0,get:function(){return o.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("readable-stream").Transform;function r(u){o.call(this),this._block=a.allocUnsafe(u),this._blockSize=u,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(r,o),r.prototype._transform=function(u,l,h){var f=null;try{this.update(u,l)}catch(d){f=d}h(f)},r.prototype._flush=function(u){var l=null;try{this.push(this.digest())}catch(h){l=h}u(l)},r.prototype.update=function(u,l){if(function(v,x){if(!a.isBuffer(v)&&typeof v!="string")throw new TypeError(x+" must be a string or a buffer")}(u,"Data"),this._finalized)throw new Error("Digest already called");a.isBuffer(u)||(u=a.from(u,l));for(var h=this._block,f=0;this._blockOffset+u.length-f>=this._blockSize;){for(var d=this._blockOffset;d<this._blockSize;)h[d++]=u[f++];this._update(),this._blockOffset=0}for(;f<u.length;)h[this._blockOffset++]=u[f++];for(var p=0,b=8*u.length;b>0;++p)this._length[p]+=b,(b=this._length[p]/4294967296|0)>0&&(this._length[p]-=4294967296*b);return this},r.prototype._update=function(){throw new Error("_update is not implemented")},r.prototype.digest=function(u){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var l=this._digest();u!==void 0&&(l=l.toString(u)),this._block.fill(0),this._blockOffset=0;for(var h=0;h<4;++h)this._length[h]=0;return l},r.prototype._digest=function(){throw new Error("_digest is not implemented")},i.exports=r},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,i,s){var a=s;a.utils=e("./hash/utils"),a.common=e("./hash/common"),a.sha=e("./hash/sha"),a.ripemd=e("./hash/ripemd"),a.hmac=e("./hash/hmac"),a.sha1=a.sha.sha1,a.sha256=a.sha.sha256,a.sha224=a.sha.sha224,a.sha384=a.sha.sha384,a.sha512=a.sha.sha512,a.ripemd160=a.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,i,s){var a=e("./utils"),o=e("minimalistic-assert");function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}s.BlockHash=r,r.prototype.update=function(u,l){if(u=a.toArray(u,l),this.pending?this.pending=this.pending.concat(u):this.pending=u,this.pendingTotal+=u.length,this.pending.length>=this._delta8){var h=(u=this.pending).length%this._delta8;this.pending=u.slice(u.length-h,u.length),this.pending.length===0&&(this.pending=null),u=a.join32(u,0,u.length-h,this.endian);for(var f=0;f<u.length;f+=this._delta32)this._update(u,f,f+this._delta32)}return this},r.prototype.digest=function(u){return this.update(this._pad()),o(this.pending===null),this._digest(u)},r.prototype._pad=function(){var u=this.pendingTotal,l=this._delta8,h=l-(u+this.padLength)%l,f=new Array(h+this.padLength);f[0]=128;for(var d=1;d<h;d++)f[d]=0;if(u<<=3,this.endian==="big"){for(var p=8;p<this.padLength;p++)f[d++]=0;f[d++]=0,f[d++]=0,f[d++]=0,f[d++]=0,f[d++]=u>>>24&255,f[d++]=u>>>16&255,f[d++]=u>>>8&255,f[d++]=255&u}else for(f[d++]=255&u,f[d++]=u>>>8&255,f[d++]=u>>>16&255,f[d++]=u>>>24&255,f[d++]=0,f[d++]=0,f[d++]=0,f[d++]=0,p=8;p<this.padLength;p++)f[d++]=0;return f}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,i,s){var a=e("./utils"),o=e("minimalistic-assert");function r(u,l,h){if(!(this instanceof r))return new r(u,l,h);this.Hash=u,this.blockSize=u.blockSize/8,this.outSize=u.outSize/8,this.inner=null,this.outer=null,this._init(a.toArray(l,h))}i.exports=r,r.prototype._init=function(u){u.length>this.blockSize&&(u=new this.Hash().update(u).digest()),o(u.length<=this.blockSize);for(var l=u.length;l<this.blockSize;l++)u.push(0);for(l=0;l<u.length;l++)u[l]^=54;for(this.inner=new this.Hash().update(u),l=0;l<u.length;l++)u[l]^=106;this.outer=new this.Hash().update(u)},r.prototype.update=function(u,l){return this.inner.update(u,l),this},r.prototype.digest=function(u){return this.outer.update(this.inner.digest()),this.outer.digest(u)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,i,s){var a=e("./utils"),o=e("./common"),r=a.rotl32,u=a.sum32,l=a.sum32_3,h=a.sum32_4,f=o.BlockHash;function d(){if(!(this instanceof d))return new d;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function p(D,N,V,K){return D<=15?N^V^K:D<=31?N&V|~N&K:D<=47?(N|~V)^K:D<=63?N&K|V&~K:N^(V|~K)}function b(D){return D<=15?0:D<=31?1518500249:D<=47?1859775393:D<=63?2400959708:2840853838}function v(D){return D<=15?1352829926:D<=31?1548603684:D<=47?1836072691:D<=63?2053994217:0}a.inherits(d,f),s.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(D,N){for(var V=this.h[0],K=this.h[1],j=this.h[2],Z=this.h[3],tt=this.h[4],rt=V,J=K,U=j,G=Z,I=tt,C=0;C<80;C++){var L=u(r(h(V,p(C,K,j,Z),D[x[C]+N],b(C)),M[C]),tt);V=tt,tt=Z,Z=r(j,10),j=K,K=L,L=u(r(h(rt,p(79-C,J,U,G),D[w[C]+N],v(C)),E[C]),I),rt=I,I=G,G=r(U,10),U=J,J=L}L=l(this.h[1],j,G),this.h[1]=l(this.h[2],Z,I),this.h[2]=l(this.h[3],tt,rt),this.h[3]=l(this.h[4],V,J),this.h[4]=l(this.h[0],K,U),this.h[0]=L},d.prototype._digest=function(D){return D==="hex"?a.toHex32(this.h,"little"):a.split32(this.h,"little")};var x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],w=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],M=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],E=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,i,s){s.sha1=e("./sha/1"),s.sha224=e("./sha/224"),s.sha256=e("./sha/256"),s.sha384=e("./sha/384"),s.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,i,s){var a=e("../utils"),o=e("../common"),r=e("./common"),u=a.rotl32,l=a.sum32,h=a.sum32_5,f=r.ft_1,d=o.BlockHash,p=[1518500249,1859775393,2400959708,3395469782];function b(){if(!(this instanceof b))return new b;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}a.inherits(b,d),i.exports=b,b.blockSize=512,b.outSize=160,b.hmacStrength=80,b.padLength=64,b.prototype._update=function(v,x){for(var w=this.W,M=0;M<16;M++)w[M]=v[x+M];for(;M<w.length;M++)w[M]=u(w[M-3]^w[M-8]^w[M-14]^w[M-16],1);var E=this.h[0],D=this.h[1],N=this.h[2],V=this.h[3],K=this.h[4];for(M=0;M<w.length;M++){var j=~~(M/20),Z=h(u(E,5),f(j,D,N,V),K,w[M],p[j]);K=V,V=N,N=u(D,30),D=E,E=Z}this.h[0]=l(this.h[0],E),this.h[1]=l(this.h[1],D),this.h[2]=l(this.h[2],N),this.h[3]=l(this.h[3],V),this.h[4]=l(this.h[4],K)},b.prototype._digest=function(v){return v==="hex"?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,i,s){var a=e("../utils"),o=e("./256");function r(){if(!(this instanceof r))return new r;o.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}a.inherits(r,o),i.exports=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(u){return u==="hex"?a.toHex32(this.h.slice(0,7),"big"):a.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,i,s){var a=e("../utils"),o=e("../common"),r=e("./common"),u=e("minimalistic-assert"),l=a.sum32,h=a.sum32_4,f=a.sum32_5,d=r.ch32,p=r.maj32,b=r.s0_256,v=r.s1_256,x=r.g0_256,w=r.g1_256,M=o.BlockHash,E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function D(){if(!(this instanceof D))return new D;M.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=E,this.W=new Array(64)}a.inherits(D,M),i.exports=D,D.blockSize=512,D.outSize=256,D.hmacStrength=192,D.padLength=64,D.prototype._update=function(N,V){for(var K=this.W,j=0;j<16;j++)K[j]=N[V+j];for(;j<K.length;j++)K[j]=h(w(K[j-2]),K[j-7],x(K[j-15]),K[j-16]);var Z=this.h[0],tt=this.h[1],rt=this.h[2],J=this.h[3],U=this.h[4],G=this.h[5],I=this.h[6],C=this.h[7];for(u(this.k.length===K.length),j=0;j<K.length;j++){var L=f(C,v(U),d(U,G,I),this.k[j],K[j]),B=l(b(Z),p(Z,tt,rt));C=I,I=G,G=U,U=l(J,L),J=rt,rt=tt,tt=Z,Z=l(L,B)}this.h[0]=l(this.h[0],Z),this.h[1]=l(this.h[1],tt),this.h[2]=l(this.h[2],rt),this.h[3]=l(this.h[3],J),this.h[4]=l(this.h[4],U),this.h[5]=l(this.h[5],G),this.h[6]=l(this.h[6],I),this.h[7]=l(this.h[7],C)},D.prototype._digest=function(N){return N==="hex"?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,i,s){var a=e("../utils"),o=e("./512");function r(){if(!(this instanceof r))return new r;o.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}a.inherits(r,o),i.exports=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(u){return u==="hex"?a.toHex32(this.h.slice(0,12),"big"):a.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,i,s){var a=e("../utils"),o=e("../common"),r=e("minimalistic-assert"),u=a.rotr64_hi,l=a.rotr64_lo,h=a.shr64_hi,f=a.shr64_lo,d=a.sum64,p=a.sum64_hi,b=a.sum64_lo,v=a.sum64_4_hi,x=a.sum64_4_lo,w=a.sum64_5_hi,M=a.sum64_5_lo,E=o.BlockHash,D=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function N(){if(!(this instanceof N))return new N;E.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=D,this.W=new Array(160)}function V(B,O,q,it,nt){var lt=B&q^~B&nt;return lt<0&&(lt+=4294967296),lt}function K(B,O,q,it,nt,lt){var ut=O&it^~O&lt;return ut<0&&(ut+=4294967296),ut}function j(B,O,q,it,nt){var lt=B&q^B&nt^q&nt;return lt<0&&(lt+=4294967296),lt}function Z(B,O,q,it,nt,lt){var ut=O&it^O&lt^it&lt;return ut<0&&(ut+=4294967296),ut}function tt(B,O){var q=u(B,O,28)^u(O,B,2)^u(O,B,7);return q<0&&(q+=4294967296),q}function rt(B,O){var q=l(B,O,28)^l(O,B,2)^l(O,B,7);return q<0&&(q+=4294967296),q}function J(B,O){var q=u(B,O,14)^u(B,O,18)^u(O,B,9);return q<0&&(q+=4294967296),q}function U(B,O){var q=l(B,O,14)^l(B,O,18)^l(O,B,9);return q<0&&(q+=4294967296),q}function G(B,O){var q=u(B,O,1)^u(B,O,8)^h(B,O,7);return q<0&&(q+=4294967296),q}function I(B,O){var q=l(B,O,1)^l(B,O,8)^f(B,O,7);return q<0&&(q+=4294967296),q}function C(B,O){var q=u(B,O,19)^u(O,B,29)^h(B,O,6);return q<0&&(q+=4294967296),q}function L(B,O){var q=l(B,O,19)^l(O,B,29)^f(B,O,6);return q<0&&(q+=4294967296),q}a.inherits(N,E),i.exports=N,N.blockSize=1024,N.outSize=512,N.hmacStrength=192,N.padLength=128,N.prototype._prepareBlock=function(B,O){for(var q=this.W,it=0;it<32;it++)q[it]=B[O+it];for(;it<q.length;it+=2){var nt=C(q[it-4],q[it-3]),lt=L(q[it-4],q[it-3]),ut=q[it-14],vt=q[it-13],Q=G(q[it-30],q[it-29]),gt=I(q[it-30],q[it-29]),Y=q[it-32],H=q[it-31];q[it]=v(nt,lt,ut,vt,Q,gt,Y,H),q[it+1]=x(nt,lt,ut,vt,Q,gt,Y,H)}},N.prototype._update=function(B,O){this._prepareBlock(B,O);var q=this.W,it=this.h[0],nt=this.h[1],lt=this.h[2],ut=this.h[3],vt=this.h[4],Q=this.h[5],gt=this.h[6],Y=this.h[7],H=this.h[8],at=this.h[9],ft=this.h[10],wt=this.h[11],_t=this.h[12],Dt=this.h[13],Gt=this.h[14],te=this.h[15];r(this.k.length===q.length);for(var mt=0;mt<q.length;mt+=2){var At=Gt,Ot=te,Zt=J(H,at),he=U(H,at),fe=V(H,at,ft,wt,_t),be=K(H,at,ft,wt,_t,Dt),Me=this.k[mt],Pe=this.k[mt+1],ze=q[mt],Ce=q[mt+1],Le=w(At,Ot,Zt,he,fe,be,Me,Pe,ze,Ce),Ye=M(At,Ot,Zt,he,fe,be,Me,Pe,ze,Ce);At=tt(it,nt),Ot=rt(it,nt),Zt=j(it,nt,lt,ut,vt),he=Z(it,nt,lt,ut,vt,Q);var le=p(At,Ot,Zt,he),Fe=b(At,Ot,Zt,he);Gt=_t,te=Dt,_t=ft,Dt=wt,ft=H,wt=at,H=p(gt,Y,Le,Ye),at=b(Y,Y,Le,Ye),gt=vt,Y=Q,vt=lt,Q=ut,lt=it,ut=nt,it=p(Le,Ye,le,Fe),nt=b(Le,Ye,le,Fe)}d(this.h,0,it,nt),d(this.h,2,lt,ut),d(this.h,4,vt,Q),d(this.h,6,gt,Y),d(this.h,8,H,at),d(this.h,10,ft,wt),d(this.h,12,_t,Dt),d(this.h,14,Gt,te)},N.prototype._digest=function(B){return B==="hex"?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,i,s){var a=e("../utils").rotr32;function o(l,h,f){return l&h^~l&f}function r(l,h,f){return l&h^l&f^h&f}function u(l,h,f){return l^h^f}s.ft_1=function(l,h,f,d){return l===0?o(h,f,d):l===1||l===3?u(h,f,d):l===2?r(h,f,d):void 0},s.ch32=o,s.maj32=r,s.p32=u,s.s0_256=function(l){return a(l,2)^a(l,13)^a(l,22)},s.s1_256=function(l){return a(l,6)^a(l,11)^a(l,25)},s.g0_256=function(l){return a(l,7)^a(l,18)^l>>>3},s.g1_256=function(l){return a(l,17)^a(l,19)^l>>>10}},{"../utils":437}],437:[function(e,i,s){var a=e("minimalistic-assert"),o=e("inherits");function r(f,d){return(64512&f.charCodeAt(d))==55296&&!(d<0||d+1>=f.length)&&(64512&f.charCodeAt(d+1))==56320}function u(f){return(f>>>24|f>>>8&65280|f<<8&16711680|(255&f)<<24)>>>0}function l(f){return f.length===1?"0"+f:f}function h(f){return f.length===7?"0"+f:f.length===6?"00"+f:f.length===5?"000"+f:f.length===4?"0000"+f:f.length===3?"00000"+f:f.length===2?"000000"+f:f.length===1?"0000000"+f:f}s.inherits=o,s.toArray=function(f,d){if(Array.isArray(f))return f.slice();if(!f)return[];var p=[];if(typeof f=="string")if(d){if(d==="hex")for((f=f.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(f="0"+f),v=0;v<f.length;v+=2)p.push(parseInt(f[v]+f[v+1],16))}else for(var b=0,v=0;v<f.length;v++){var x=f.charCodeAt(v);x<128?p[b++]=x:x<2048?(p[b++]=x>>6|192,p[b++]=63&x|128):r(f,v)?(x=65536+((1023&x)<<10)+(1023&f.charCodeAt(++v)),p[b++]=x>>18|240,p[b++]=x>>12&63|128,p[b++]=x>>6&63|128,p[b++]=63&x|128):(p[b++]=x>>12|224,p[b++]=x>>6&63|128,p[b++]=63&x|128)}else for(v=0;v<f.length;v++)p[v]=0|f[v];return p},s.toHex=function(f){for(var d="",p=0;p<f.length;p++)d+=l(f[p].toString(16));return d},s.htonl=u,s.toHex32=function(f,d){for(var p="",b=0;b<f.length;b++){var v=f[b];d==="little"&&(v=u(v)),p+=h(v.toString(16))}return p},s.zero2=l,s.zero8=h,s.join32=function(f,d,p,b){var v=p-d;a(v%4==0);for(var x=new Array(v/4),w=0,M=d;w<x.length;w++,M+=4){var E;E=b==="big"?f[M]<<24|f[M+1]<<16|f[M+2]<<8|f[M+3]:f[M+3]<<24|f[M+2]<<16|f[M+1]<<8|f[M],x[w]=E>>>0}return x},s.split32=function(f,d){for(var p=new Array(4*f.length),b=0,v=0;b<f.length;b++,v+=4){var x=f[b];d==="big"?(p[v]=x>>>24,p[v+1]=x>>>16&255,p[v+2]=x>>>8&255,p[v+3]=255&x):(p[v+3]=x>>>24,p[v+2]=x>>>16&255,p[v+1]=x>>>8&255,p[v]=255&x)}return p},s.rotr32=function(f,d){return f>>>d|f<<32-d},s.rotl32=function(f,d){return f<<d|f>>>32-d},s.sum32=function(f,d){return f+d>>>0},s.sum32_3=function(f,d,p){return f+d+p>>>0},s.sum32_4=function(f,d,p,b){return f+d+p+b>>>0},s.sum32_5=function(f,d,p,b,v){return f+d+p+b+v>>>0},s.sum64=function(f,d,p,b){var v=f[d],x=b+f[d+1]>>>0,w=(x<b?1:0)+p+v;f[d]=w>>>0,f[d+1]=x},s.sum64_hi=function(f,d,p,b){return(d+b>>>0<d?1:0)+f+p>>>0},s.sum64_lo=function(f,d,p,b){return d+b>>>0},s.sum64_4_hi=function(f,d,p,b,v,x,w,M){var E=0,D=d;return E+=(D=D+b>>>0)<d?1:0,E+=(D=D+x>>>0)<x?1:0,f+p+v+w+(E+=(D=D+M>>>0)<M?1:0)>>>0},s.sum64_4_lo=function(f,d,p,b,v,x,w,M){return d+b+x+M>>>0},s.sum64_5_hi=function(f,d,p,b,v,x,w,M,E,D){var N=0,V=d;return N+=(V=V+b>>>0)<d?1:0,N+=(V=V+x>>>0)<x?1:0,N+=(V=V+M>>>0)<M?1:0,f+p+v+w+E+(N+=(V=V+D>>>0)<D?1:0)>>>0},s.sum64_5_lo=function(f,d,p,b,v,x,w,M,E,D){return d+b+x+M+D>>>0},s.rotr64_hi=function(f,d,p){return(d<<32-p|f>>>p)>>>0},s.rotr64_lo=function(f,d,p){return(f<<32-p|d>>>p)>>>0},s.shr64_hi=function(f,d,p){return f>>>p},s.shr64_lo=function(f,d,p){return(f<<32-p|d>>>p)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,i,s){var a=e("hash.js"),o=e("minimalistic-crypto-utils"),r=e("minimalistic-assert");function u(l){if(!(this instanceof u))return new u(l);this.hash=l.hash,this.predResist=!!l.predResist,this.outLen=this.hash.outSize,this.minEntropy=l.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var h=o.toArray(l.entropy,l.entropyEnc||"hex"),f=o.toArray(l.nonce,l.nonceEnc||"hex"),d=o.toArray(l.pers,l.persEnc||"hex");r(h.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(h,f,d)}i.exports=u,u.prototype._init=function(l,h,f){var d=l.concat(h).concat(f);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var p=0;p<this.V.length;p++)this.K[p]=0,this.V[p]=1;this._update(d),this._reseed=1,this.reseedInterval=281474976710656},u.prototype._hmac=function(){return new a.hmac(this.hash,this.K)},u.prototype._update=function(l){var h=this._hmac().update(this.V).update([0]);l&&(h=h.update(l)),this.K=h.digest(),this.V=this._hmac().update(this.V).digest(),l&&(this.K=this._hmac().update(this.V).update([1]).update(l).digest(),this.V=this._hmac().update(this.V).digest())},u.prototype.reseed=function(l,h,f,d){typeof h!="string"&&(d=f,f=h,h=null),l=o.toArray(l,h),f=o.toArray(f,d),r(l.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(l.concat(f||[])),this._reseed=1},u.prototype.generate=function(l,h,f,d){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof h!="string"&&(d=f,f=h,h=null),f&&(f=o.toArray(f,d||"hex"),this._update(f));for(var p=[];p.length<l;)this.V=this._hmac().update(this.V).digest(),p=p.concat(this.V);var b=p.slice(0,l);return this._update(f),this._reseed++,o.encode(b,h)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,i,s){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(a,o,r,u,l){var h,f,d=8*l-u-1,p=(1<<d)-1,b=p>>1,v=-7,x=r?l-1:0,w=r?-1:1,M=a[o+x];for(x+=w,h=M&(1<<-v)-1,M>>=-v,v+=d;v>0;h=256*h+a[o+x],x+=w,v-=8);for(f=h&(1<<-v)-1,h>>=-v,v+=u;v>0;f=256*f+a[o+x],x+=w,v-=8);if(h===0)h=1-b;else{if(h===p)return f?NaN:1/0*(M?-1:1);f+=Math.pow(2,u),h-=b}return(M?-1:1)*f*Math.pow(2,h-u)},s.write=function(a,o,r,u,l,h){var f,d,p,b=8*h-l-1,v=(1<<b)-1,x=v>>1,w=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=u?0:h-1,E=u?1:-1,D=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(d=isNaN(o)?1:0,f=v):(f=Math.floor(Math.log(o)/Math.LN2),o*(p=Math.pow(2,-f))<1&&(f--,p*=2),(o+=f+x>=1?w/p:w*Math.pow(2,1-x))*p>=2&&(f++,p/=2),f+x>=v?(d=0,f=v):f+x>=1?(d=(o*p-1)*Math.pow(2,l),f+=x):(d=o*Math.pow(2,x-1)*Math.pow(2,l),f=0));l>=8;a[r+M]=255&d,M+=E,d/=256,l-=8);for(f=f<<l|d,b+=l;b>0;a[r+M]=255&f,M+=E,f/=256,b-=8);a[r+M-E]|=128*D}},{}],440:[function(e,i,s){typeof Object.create=="function"?i.exports=function(a,o){o&&(a.super_=o,a.prototype=Object.create(o.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:i.exports=function(a,o){if(o){a.super_=o;var r=function(){};r.prototype=o.prototype,a.prototype=new r,a.prototype.constructor=a}}},{}],441:[function(e,i,s){(function(a,o,r,u,l,h,f,d){(function(){/*!

  	JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  	<http://stuartk.com/jszip>

  	(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  	Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

  	JSZip uses the library pako released under the MIT license :
  	https://github.com/nodeca/pako/blob/main/LICENSE
  	*/(function(p){typeof s=="object"&&i!==void 0?i.exports=p():(typeof window!="undefined"?window:o!==void 0?o:typeof self!="undefined"?self:this).JSZip=p()})(function(){return function p(b,v,x){function w(D,N){if(!v[D]){if(!b[D]){var V=typeof e=="function"&&e;if(!N&&V)return V(D,!0);if(M)return M(D,!0);var K=new Error("Cannot find module '"+D+"'");throw K.code="MODULE_NOT_FOUND",K}var j=v[D]={exports:{}};b[D][0].call(j.exports,function(Z){return w(b[D][1][Z]||Z)},j,j.exports,p,b,v,x)}return v[D].exports}for(var M=typeof e=="function"&&e,E=0;E<x.length;E++)w(x[E]);return w}({1:[function(p,b,v){var x=p("./utils"),w=p("./support"),M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";v.encode=function(E){for(var D,N,V,K,j,Z,tt,rt=[],J=0,U=E.length,G=U,I=x.getTypeOf(E)!=="string";J<E.length;)G=U-J,V=I?(D=E[J++],N=J<U?E[J++]:0,J<U?E[J++]:0):(D=E.charCodeAt(J++),N=J<U?E.charCodeAt(J++):0,J<U?E.charCodeAt(J++):0),K=D>>2,j=(3&D)<<4|N>>4,Z=1<G?(15&N)<<2|V>>6:64,tt=2<G?63&V:64,rt.push(M.charAt(K)+M.charAt(j)+M.charAt(Z)+M.charAt(tt));return rt.join("")},v.decode=function(E){var D,N,V,K,j,Z,tt=0,rt=0,J="data:";if(E.substr(0,J.length)===J)throw new Error("Invalid base64 input, it looks like a data url.");var U,G=3*(E=E.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(E.charAt(E.length-1)===M.charAt(64)&&G--,E.charAt(E.length-2)===M.charAt(64)&&G--,G%1!=0)throw new Error("Invalid base64 input, bad content length.");for(U=w.uint8array?new Uint8Array(0|G):new Array(0|G);tt<E.length;)D=M.indexOf(E.charAt(tt++))<<2|(K=M.indexOf(E.charAt(tt++)))>>4,N=(15&K)<<4|(j=M.indexOf(E.charAt(tt++)))>>2,V=(3&j)<<6|(Z=M.indexOf(E.charAt(tt++))),U[rt++]=D,j!==64&&(U[rt++]=N),Z!==64&&(U[rt++]=V);return U}},{"./support":30,"./utils":32}],2:[function(p,b,v){var x=p("./external"),w=p("./stream/DataWorker"),M=p("./stream/Crc32Probe"),E=p("./stream/DataLengthProbe");function D(N,V,K,j,Z){this.compressedSize=N,this.uncompressedSize=V,this.crc32=K,this.compression=j,this.compressedContent=Z}D.prototype={getContentWorker:function(){var N=new w(x.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new E("data_length")),V=this;return N.on("end",function(){if(this.streamInfo.data_length!==V.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),N},getCompressedWorker:function(){return new w(x.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},D.createWorkerFrom=function(N,V,K){return N.pipe(new M).pipe(new E("uncompressedSize")).pipe(V.compressWorker(K)).pipe(new E("compressedSize")).withStreamInfo("compression",V)},b.exports=D},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(p,b,v){var x=p("./stream/GenericWorker");v.STORE={magic:"\0\0",compressWorker:function(){return new x("STORE compression")},uncompressWorker:function(){return new x("STORE decompression")}},v.DEFLATE=p("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(p,b,v){var x=p("./utils"),w=function(){for(var M,E=[],D=0;D<256;D++){M=D;for(var N=0;N<8;N++)M=1&M?3988292384^M>>>1:M>>>1;E[D]=M}return E}();b.exports=function(M,E){return M!==void 0&&M.length?x.getTypeOf(M)!=="string"?function(D,N,V,K){var j=w,Z=0+V;D^=-1;for(var tt=0;tt<Z;tt++)D=D>>>8^j[255&(D^N[tt])];return-1^D}(0|E,M,M.length):function(D,N,V,K){var j=w,Z=0+V;D^=-1;for(var tt=0;tt<Z;tt++)D=D>>>8^j[255&(D^N.charCodeAt(tt))];return-1^D}(0|E,M,M.length):0}},{"./utils":32}],5:[function(p,b,v){v.base64=!1,v.binary=!1,v.dir=!1,v.createFolders=!0,v.date=null,v.compression=null,v.compressionOptions=null,v.comment=null,v.unixPermissions=null,v.dosPermissions=null},{}],6:[function(p,b,v){var x;x=typeof Promise!="undefined"?Promise:p("lie"),b.exports={Promise:x}},{lie:37}],7:[function(p,b,v){var x=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",w=p("pako"),M=p("./utils"),E=p("./stream/GenericWorker"),D=x?"uint8array":"array";function N(V,K){E.call(this,"FlateWorker/"+V),this._pako=null,this._pakoAction=V,this._pakoOptions=K,this.meta={}}v.magic="\b\0",M.inherits(N,E),N.prototype.processChunk=function(V){this.meta=V.meta,this._pako===null&&this._createPako(),this._pako.push(M.transformTo(D,V.data),!1)},N.prototype.flush=function(){E.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},N.prototype.cleanUp=function(){E.prototype.cleanUp.call(this),this._pako=null},N.prototype._createPako=function(){this._pako=new w[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var V=this;this._pako.onData=function(K){V.push({data:K,meta:V.meta})}},v.compressWorker=function(V){return new N("Deflate",V)},v.uncompressWorker=function(){return new N("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(p,b,v){function x(j,Z){var tt,rt="";for(tt=0;tt<Z;tt++)rt+=String.fromCharCode(255&j),j>>>=8;return rt}function w(j,Z,tt,rt,J,U){var G,I,C=j.file,L=j.compression,B=U!==D.utf8encode,O=M.transformTo("string",U(C.name)),q=M.transformTo("string",D.utf8encode(C.name)),it=C.comment,nt=M.transformTo("string",U(it)),lt=M.transformTo("string",D.utf8encode(it)),ut=q.length!==C.name.length,vt=lt.length!==it.length,Q="",gt="",Y="",H=C.dir,at=C.date,ft={crc32:0,compressedSize:0,uncompressedSize:0};Z&&!tt||(ft.crc32=j.crc32,ft.compressedSize=j.compressedSize,ft.uncompressedSize=j.uncompressedSize);var wt=0;Z&&(wt|=8),B||!ut&&!vt||(wt|=2048);var _t=0,Dt=0;H&&(_t|=16),J==="UNIX"?(Dt=798,_t|=function(te,mt){var At=te;return te||(At=mt?16893:33204),(65535&At)<<16}(C.unixPermissions,H)):(Dt=20,_t|=function(te){return 63&(te||0)}(C.dosPermissions)),G=at.getUTCHours(),G<<=6,G|=at.getUTCMinutes(),G<<=5,G|=at.getUTCSeconds()/2,I=at.getUTCFullYear()-1980,I<<=4,I|=at.getUTCMonth()+1,I<<=5,I|=at.getUTCDate(),ut&&(gt=x(1,1)+x(N(O),4)+q,Q+="up"+x(gt.length,2)+gt),vt&&(Y=x(1,1)+x(N(nt),4)+lt,Q+="uc"+x(Y.length,2)+Y);var Gt="";return Gt+=`
\0`,Gt+=x(wt,2),Gt+=L.magic,Gt+=x(G,2),Gt+=x(I,2),Gt+=x(ft.crc32,4),Gt+=x(ft.compressedSize,4),Gt+=x(ft.uncompressedSize,4),Gt+=x(O.length,2),Gt+=x(Q.length,2),{fileRecord:V.LOCAL_FILE_HEADER+Gt+O+Q,dirRecord:V.CENTRAL_FILE_HEADER+x(Dt,2)+Gt+x(nt.length,2)+"\0\0\0\0"+x(_t,4)+x(rt,4)+O+Q+nt}}var M=p("../utils"),E=p("../stream/GenericWorker"),D=p("../utf8"),N=p("../crc32"),V=p("../signature");function K(j,Z,tt,rt){E.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Z,this.zipPlatform=tt,this.encodeFileName=rt,this.streamFiles=j,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}M.inherits(K,E),K.prototype.push=function(j){var Z=j.meta.percent||0,tt=this.entriesCount,rt=this._sources.length;this.accumulate?this.contentBuffer.push(j):(this.bytesWritten+=j.data.length,E.prototype.push.call(this,{data:j.data,meta:{currentFile:this.currentFile,percent:tt?(Z+100*(tt-rt-1))/tt:100}}))},K.prototype.openedSource=function(j){this.currentSourceOffset=this.bytesWritten,this.currentFile=j.file.name;var Z=this.streamFiles&&!j.file.dir;if(Z){var tt=w(j,Z,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:tt.fileRecord,meta:{percent:0}})}else this.accumulate=!0},K.prototype.closedSource=function(j){this.accumulate=!1;var Z=this.streamFiles&&!j.file.dir,tt=w(j,Z,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(tt.dirRecord),Z)this.push({data:function(rt){return V.DATA_DESCRIPTOR+x(rt.crc32,4)+x(rt.compressedSize,4)+x(rt.uncompressedSize,4)}(j),meta:{percent:100}});else for(this.push({data:tt.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},K.prototype.flush=function(){for(var j=this.bytesWritten,Z=0;Z<this.dirRecords.length;Z++)this.push({data:this.dirRecords[Z],meta:{percent:100}});var tt=this.bytesWritten-j,rt=function(J,U,G,I,C){var L=M.transformTo("string",C(I));return V.CENTRAL_DIRECTORY_END+"\0\0\0\0"+x(J,2)+x(J,2)+x(U,4)+x(G,4)+x(L.length,2)+L}(this.dirRecords.length,tt,j,this.zipComment,this.encodeFileName);this.push({data:rt,meta:{percent:100}})},K.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},K.prototype.registerPrevious=function(j){this._sources.push(j);var Z=this;return j.on("data",function(tt){Z.processChunk(tt)}),j.on("end",function(){Z.closedSource(Z.previous.streamInfo),Z._sources.length?Z.prepareNextSource():Z.end()}),j.on("error",function(tt){Z.error(tt)}),this},K.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},K.prototype.error=function(j){var Z=this._sources;if(!E.prototype.error.call(this,j))return!1;for(var tt=0;tt<Z.length;tt++)try{Z[tt].error(j)}catch(rt){}return!0},K.prototype.lock=function(){E.prototype.lock.call(this);for(var j=this._sources,Z=0;Z<j.length;Z++)j[Z].lock()},b.exports=K},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(p,b,v){var x=p("../compressions"),w=p("./ZipFileWorker");v.generateWorker=function(M,E,D){var N=new w(E.streamFiles,D,E.platform,E.encodeFileName),V=0;try{M.forEach(function(K,j){V++;var Z=function(U,G){var I=U||G,C=x[I];if(!C)throw new Error(I+" is not a valid compression method !");return C}(j.options.compression,E.compression),tt=j.options.compressionOptions||E.compressionOptions||{},rt=j.dir,J=j.date;j._compressWorker(Z,tt).withStreamInfo("file",{name:K,dir:rt,date:J,comment:j.comment||"",unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions}).pipe(N)}),N.entriesCount=V}catch(K){N.error(K)}return N}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(p,b,v){function x(){if(!(this instanceof x))return new x;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var w=new x;for(var M in this)typeof this[M]!="function"&&(w[M]=this[M]);return w}}(x.prototype=p("./object")).loadAsync=p("./load"),x.support=p("./support"),x.defaults=p("./defaults"),x.version="3.10.1",x.loadAsync=function(w,M){return new x().loadAsync(w,M)},x.external=p("./external"),b.exports=x},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(p,b,v){var x=p("./utils"),w=p("./external"),M=p("./utf8"),E=p("./zipEntries"),D=p("./stream/Crc32Probe"),N=p("./nodejsUtils");function V(K){return new w.Promise(function(j,Z){var tt=K.decompressed.getContentWorker().pipe(new D);tt.on("error",function(rt){Z(rt)}).on("end",function(){tt.streamInfo.crc32!==K.decompressed.crc32?Z(new Error("Corrupted zip : CRC32 mismatch")):j()}).resume()})}b.exports=function(K,j){var Z=this;return j=x.extend(j||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:M.utf8decode}),N.isNode&&N.isStream(K)?w.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):x.prepareContent("the loaded zip file",K,!0,j.optimizedBinaryString,j.base64).then(function(tt){var rt=new E(j);return rt.load(tt),rt}).then(function(tt){var rt=[w.Promise.resolve(tt)],J=tt.files;if(j.checkCRC32)for(var U=0;U<J.length;U++)rt.push(V(J[U]));return w.Promise.all(rt)}).then(function(tt){for(var rt=tt.shift(),J=rt.files,U=0;U<J.length;U++){var G=J[U],I=G.fileNameStr,C=x.resolve(G.fileNameStr);Z.file(C,G.decompressed,{binary:!0,optimizedBinaryString:!0,date:G.date,dir:G.dir,comment:G.fileCommentStr.length?G.fileCommentStr:null,unixPermissions:G.unixPermissions,dosPermissions:G.dosPermissions,createFolders:j.createFolders}),G.dir||(Z.file(C).unsafeOriginalName=I)}return rt.zipComment.length&&(Z.comment=rt.zipComment),Z})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(p,b,v){var x=p("../utils"),w=p("../stream/GenericWorker");function M(E,D){w.call(this,"Nodejs stream input adapter for "+E),this._upstreamEnded=!1,this._bindStream(D)}x.inherits(M,w),M.prototype._bindStream=function(E){var D=this;(this._stream=E).pause(),E.on("data",function(N){D.push({data:N,meta:{percent:0}})}).on("error",function(N){D.isPaused?this.generatedError=N:D.error(N)}).on("end",function(){D.isPaused?D._upstreamEnded=!0:D.end()})},M.prototype.pause=function(){return!!w.prototype.pause.call(this)&&(this._stream.pause(),!0)},M.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},b.exports=M},{"../stream/GenericWorker":28,"../utils":32}],13:[function(p,b,v){var x=p("readable-stream").Readable;function w(M,E,D){x.call(this,E),this._helper=M;var N=this;M.on("data",function(V,K){N.push(V)||N._helper.pause(),D&&D(K)}).on("error",function(V){N.emit("error",V)}).on("end",function(){N.push(null)})}p("../utils").inherits(w,x),w.prototype._read=function(){this._helper.resume()},b.exports=w},{"../utils":32,"readable-stream":16}],14:[function(p,b,v){b.exports={isNode:r!==void 0,newBufferFrom:function(x,w){if(r.from&&r.from!==Uint8Array.from)return r.from(x,w);if(typeof x=="number")throw new Error('The "data" argument must not be a number');return new r(x,w)},allocBuffer:function(x){if(r.alloc)return r.alloc(x);var w=new r(x);return w.fill(0),w},isBuffer:function(x){return r.isBuffer(x)},isStream:function(x){return x&&typeof x.on=="function"&&typeof x.pause=="function"&&typeof x.resume=="function"}}},{}],15:[function(p,b,v){function x(C,L,B){var O,q=M.getTypeOf(L),it=M.extend(B||{},N);it.date=it.date||new Date,it.compression!==null&&(it.compression=it.compression.toUpperCase()),typeof it.unixPermissions=="string"&&(it.unixPermissions=parseInt(it.unixPermissions,8)),it.unixPermissions&&16384&it.unixPermissions&&(it.dir=!0),it.dosPermissions&&16&it.dosPermissions&&(it.dir=!0),it.dir&&(C=J(C)),it.createFolders&&(O=rt(C))&&U.call(this,O,!0);var nt=q==="string"&&it.binary===!1&&it.base64===!1;B&&B.binary!==void 0||(it.binary=!nt),(L instanceof V&&L.uncompressedSize===0||it.dir||!L||L.length===0)&&(it.base64=!1,it.binary=!0,L="",it.compression="STORE",q="string");var lt;lt=L instanceof V||L instanceof E?L:Z.isNode&&Z.isStream(L)?new tt(C,L):M.prepareContent(C,L,it.binary,it.optimizedBinaryString,it.base64);var ut=new K(C,lt,it);this.files[C]=ut}var w=p("./utf8"),M=p("./utils"),E=p("./stream/GenericWorker"),D=p("./stream/StreamHelper"),N=p("./defaults"),V=p("./compressedObject"),K=p("./zipObject"),j=p("./generate"),Z=p("./nodejsUtils"),tt=p("./nodejs/NodejsStreamInputAdapter"),rt=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var L=C.lastIndexOf("/");return 0<L?C.substring(0,L):""},J=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},U=function(C,L){return L=L!==void 0?L:N.createFolders,C=J(C),this.files[C]||x.call(this,C,null,{dir:!0,createFolders:L}),this.files[C]};function G(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var L,B,O;for(L in this.files)O=this.files[L],(B=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&C(B,O)},filter:function(C){var L=[];return this.forEach(function(B,O){C(B,O)&&L.push(O)}),L},file:function(C,L,B){if(arguments.length!==1)return C=this.root+C,x.call(this,C,L,B),this;if(G(C)){var O=C;return this.filter(function(it,nt){return!nt.dir&&O.test(it)})}var q=this.files[this.root+C];return q&&!q.dir?q:null},folder:function(C){if(!C)return this;if(G(C))return this.filter(function(q,it){return it.dir&&C.test(q)});var L=this.root+C,B=U.call(this,L),O=this.clone();return O.root=B.name,O},remove:function(C){C=this.root+C;var L=this.files[C];if(L||(C.slice(-1)!=="/"&&(C+="/"),L=this.files[C]),L&&!L.dir)delete this.files[C];else for(var B=this.filter(function(q,it){return it.name.slice(0,C.length)===C}),O=0;O<B.length;O++)delete this.files[B[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var L,B={};try{if((B=M.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:w.utf8encode})).type=B.type.toLowerCase(),B.compression=B.compression.toUpperCase(),B.type==="binarystring"&&(B.type="string"),!B.type)throw new Error("No output type specified.");M.checkSupport(B.type),B.platform!=="darwin"&&B.platform!=="freebsd"&&B.platform!=="linux"&&B.platform!=="sunos"||(B.platform="UNIX"),B.platform==="win32"&&(B.platform="DOS");var O=B.comment||this.comment||"";L=j.generateWorker(this,B,O)}catch(q){(L=new E("error")).error(q)}return new D(L,B.type||"string",B.mimeType)},generateAsync:function(C,L){return this.generateInternalStream(C).accumulate(L)},generateNodeStream:function(C,L){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(L)}};b.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(p,b,v){b.exports=p("stream")},{stream:void 0}],17:[function(p,b,v){var x=p("./DataReader");function w(M){x.call(this,M);for(var E=0;E<this.data.length;E++)M[E]=255&M[E]}p("../utils").inherits(w,x),w.prototype.byteAt=function(M){return this.data[this.zero+M]},w.prototype.lastIndexOfSignature=function(M){for(var E=M.charCodeAt(0),D=M.charCodeAt(1),N=M.charCodeAt(2),V=M.charCodeAt(3),K=this.length-4;0<=K;--K)if(this.data[K]===E&&this.data[K+1]===D&&this.data[K+2]===N&&this.data[K+3]===V)return K-this.zero;return-1},w.prototype.readAndCheckSignature=function(M){var E=M.charCodeAt(0),D=M.charCodeAt(1),N=M.charCodeAt(2),V=M.charCodeAt(3),K=this.readData(4);return E===K[0]&&D===K[1]&&N===K[2]&&V===K[3]},w.prototype.readData=function(M){if(this.checkOffset(M),M===0)return[];var E=this.data.slice(this.zero+this.index,this.zero+this.index+M);return this.index+=M,E},b.exports=w},{"../utils":32,"./DataReader":18}],18:[function(p,b,v){var x=p("../utils");function w(M){this.data=M,this.length=M.length,this.index=0,this.zero=0}w.prototype={checkOffset:function(M){this.checkIndex(this.index+M)},checkIndex:function(M){if(this.length<this.zero+M||M<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+M+"). Corrupted zip ?")},setIndex:function(M){this.checkIndex(M),this.index=M},skip:function(M){this.setIndex(this.index+M)},byteAt:function(){},readInt:function(M){var E,D=0;for(this.checkOffset(M),E=this.index+M-1;E>=this.index;E--)D=(D<<8)+this.byteAt(E);return this.index+=M,D},readString:function(M){return x.transformTo("string",this.readData(M))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var M=this.readInt(4);return new Date(Date.UTC(1980+(M>>25&127),(M>>21&15)-1,M>>16&31,M>>11&31,M>>5&63,(31&M)<<1))}},b.exports=w},{"../utils":32}],19:[function(p,b,v){var x=p("./Uint8ArrayReader");function w(M){x.call(this,M)}p("../utils").inherits(w,x),w.prototype.readData=function(M){this.checkOffset(M);var E=this.data.slice(this.zero+this.index,this.zero+this.index+M);return this.index+=M,E},b.exports=w},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(p,b,v){var x=p("./DataReader");function w(M){x.call(this,M)}p("../utils").inherits(w,x),w.prototype.byteAt=function(M){return this.data.charCodeAt(this.zero+M)},w.prototype.lastIndexOfSignature=function(M){return this.data.lastIndexOf(M)-this.zero},w.prototype.readAndCheckSignature=function(M){return M===this.readData(4)},w.prototype.readData=function(M){this.checkOffset(M);var E=this.data.slice(this.zero+this.index,this.zero+this.index+M);return this.index+=M,E},b.exports=w},{"../utils":32,"./DataReader":18}],21:[function(p,b,v){var x=p("./ArrayReader");function w(M){x.call(this,M)}p("../utils").inherits(w,x),w.prototype.readData=function(M){if(this.checkOffset(M),M===0)return new Uint8Array(0);var E=this.data.subarray(this.zero+this.index,this.zero+this.index+M);return this.index+=M,E},b.exports=w},{"../utils":32,"./ArrayReader":17}],22:[function(p,b,v){var x=p("../utils"),w=p("../support"),M=p("./ArrayReader"),E=p("./StringReader"),D=p("./NodeBufferReader"),N=p("./Uint8ArrayReader");b.exports=function(V){var K=x.getTypeOf(V);return x.checkSupport(K),K!=="string"||w.uint8array?K==="nodebuffer"?new D(V):w.uint8array?new N(x.transformTo("uint8array",V)):new M(x.transformTo("array",V)):new E(V)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(p,b,v){v.LOCAL_FILE_HEADER="PK",v.CENTRAL_FILE_HEADER="PK",v.CENTRAL_DIRECTORY_END="PK",v.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",v.ZIP64_CENTRAL_DIRECTORY_END="PK",v.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(p,b,v){var x=p("./GenericWorker"),w=p("../utils");function M(E){x.call(this,"ConvertWorker to "+E),this.destType=E}w.inherits(M,x),M.prototype.processChunk=function(E){this.push({data:w.transformTo(this.destType,E.data),meta:E.meta})},b.exports=M},{"../utils":32,"./GenericWorker":28}],25:[function(p,b,v){var x=p("./GenericWorker"),w=p("../crc32");function M(){x.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}p("../utils").inherits(M,x),M.prototype.processChunk=function(E){this.streamInfo.crc32=w(E.data,this.streamInfo.crc32||0),this.push(E)},b.exports=M},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(p,b,v){var x=p("../utils"),w=p("./GenericWorker");function M(E){w.call(this,"DataLengthProbe for "+E),this.propName=E,this.withStreamInfo(E,0)}x.inherits(M,w),M.prototype.processChunk=function(E){if(E){var D=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=D+E.data.length}w.prototype.processChunk.call(this,E)},b.exports=M},{"../utils":32,"./GenericWorker":28}],27:[function(p,b,v){var x=p("../utils"),w=p("./GenericWorker");function M(E){w.call(this,"DataWorker");var D=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,E.then(function(N){D.dataIsReady=!0,D.data=N,D.max=N&&N.length||0,D.type=x.getTypeOf(N),D.isPaused||D._tickAndRepeat()},function(N){D.error(N)})}x.inherits(M,w),M.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this.data=null},M.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,x.delay(this._tickAndRepeat,[],this)),!0)},M.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(x.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},M.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var E=null,D=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":E=this.data.substring(this.index,D);break;case"uint8array":E=this.data.subarray(this.index,D);break;case"array":case"nodebuffer":E=this.data.slice(this.index,D)}return this.index=D,this.push({data:E,meta:{percent:this.max?this.index/this.max*100:0}})},b.exports=M},{"../utils":32,"./GenericWorker":28}],28:[function(p,b,v){function x(w){this.name=w||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}x.prototype={push:function(w){this.emit("data",w)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(w){this.emit("error",w)}return!0},error:function(w){return!this.isFinished&&(this.isPaused?this.generatedError=w:(this.isFinished=!0,this.emit("error",w),this.previous&&this.previous.error(w),this.cleanUp()),!0)},on:function(w,M){return this._listeners[w].push(M),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(w,M){if(this._listeners[w])for(var E=0;E<this._listeners[w].length;E++)this._listeners[w][E].call(this,M)},pipe:function(w){return w.registerPrevious(this)},registerPrevious:function(w){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=w.streamInfo,this.mergeStreamInfo(),this.previous=w;var M=this;return w.on("data",function(E){M.processChunk(E)}),w.on("end",function(){M.end()}),w.on("error",function(E){M.error(E)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var w=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),w=!0),this.previous&&this.previous.resume(),!w},flush:function(){},processChunk:function(w){this.push(w)},withStreamInfo:function(w,M){return this.extraStreamInfo[w]=M,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var w in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,w)&&(this.streamInfo[w]=this.extraStreamInfo[w])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var w="Worker "+this.name;return this.previous?this.previous+" -> "+w:w}},b.exports=x},{}],29:[function(p,b,v){var x=p("../utils"),w=p("./ConvertWorker"),M=p("./GenericWorker"),E=p("../base64"),D=p("../support"),N=p("../external"),V=null;if(D.nodestream)try{V=p("../nodejs/NodejsStreamOutputAdapter")}catch(j){}function K(j,Z,tt){var rt=Z;switch(Z){case"blob":case"arraybuffer":rt="uint8array";break;case"base64":rt="string"}try{this._internalType=rt,this._outputType=Z,this._mimeType=tt,x.checkSupport(rt),this._worker=j.pipe(new w(rt)),j.lock()}catch(J){this._worker=new M("error"),this._worker.error(J)}}K.prototype={accumulate:function(j){return function(Z,tt){return new N.Promise(function(rt,J){var U=[],G=Z._internalType,I=Z._outputType,C=Z._mimeType;Z.on("data",function(L,B){U.push(L),tt&&tt(B)}).on("error",function(L){U=[],J(L)}).on("end",function(){try{var L=function(B,O,q){switch(B){case"blob":return x.newBlob(x.transformTo("arraybuffer",O),q);case"base64":return E.encode(O);default:return x.transformTo(B,O)}}(I,function(B,O){var q,it=0,nt=null,lt=0;for(q=0;q<O.length;q++)lt+=O[q].length;switch(B){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for(nt=new Uint8Array(lt),q=0;q<O.length;q++)nt.set(O[q],it),it+=O[q].length;return nt;case"nodebuffer":return r.concat(O);default:throw new Error("concat : unsupported type '"+B+"'")}}(G,U),C);rt(L)}catch(B){J(B)}U=[]}).resume()})}(this,j)},on:function(j,Z){var tt=this;return j==="data"?this._worker.on(j,function(rt){Z.call(tt,rt.data,rt.meta)}):this._worker.on(j,function(){x.delay(Z,arguments,tt)}),this},resume:function(){return x.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(j){if(x.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new V(this,{objectMode:this._outputType!=="nodebuffer"},j)}},b.exports=K},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(p,b,v){if(v.base64=!0,v.array=!0,v.string=!0,v.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",v.nodebuffer=r!==void 0,v.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")v.blob=!1;else{var x=new ArrayBuffer(0);try{v.blob=new Blob([x],{type:"application/zip"}).size===0}catch(M){try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);w.append(x),v.blob=w.getBlob("application/zip").size===0}catch(E){v.blob=!1}}}try{v.nodestream=!!p("readable-stream").Readable}catch(M){v.nodestream=!1}},{"readable-stream":16}],31:[function(p,b,v){for(var x=p("./utils"),w=p("./support"),M=p("./nodejsUtils"),E=p("./stream/GenericWorker"),D=new Array(256),N=0;N<256;N++)D[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function V(){E.call(this,"utf-8 decode"),this.leftOver=null}function K(){E.call(this,"utf-8 encode")}D[254]=D[254]=1,v.utf8encode=function(j){return w.nodebuffer?M.newBufferFrom(j,"utf-8"):function(Z){var tt,rt,J,U,G,I=Z.length,C=0;for(U=0;U<I;U++)(64512&(rt=Z.charCodeAt(U)))==55296&&U+1<I&&(64512&(J=Z.charCodeAt(U+1)))==56320&&(rt=65536+(rt-55296<<10)+(J-56320),U++),C+=rt<128?1:rt<2048?2:rt<65536?3:4;for(tt=w.uint8array?new Uint8Array(C):new Array(C),U=G=0;G<C;U++)(64512&(rt=Z.charCodeAt(U)))==55296&&U+1<I&&(64512&(J=Z.charCodeAt(U+1)))==56320&&(rt=65536+(rt-55296<<10)+(J-56320),U++),rt<128?tt[G++]=rt:(rt<2048?tt[G++]=192|rt>>>6:(rt<65536?tt[G++]=224|rt>>>12:(tt[G++]=240|rt>>>18,tt[G++]=128|rt>>>12&63),tt[G++]=128|rt>>>6&63),tt[G++]=128|63&rt);return tt}(j)},v.utf8decode=function(j){return w.nodebuffer?x.transformTo("nodebuffer",j).toString("utf-8"):function(Z){var tt,rt,J,U,G=Z.length,I=new Array(2*G);for(tt=rt=0;tt<G;)if((J=Z[tt++])<128)I[rt++]=J;else if(4<(U=D[J]))I[rt++]=65533,tt+=U-1;else{for(J&=U===2?31:U===3?15:7;1<U&&tt<G;)J=J<<6|63&Z[tt++],U--;1<U?I[rt++]=65533:J<65536?I[rt++]=J:(J-=65536,I[rt++]=55296|J>>10&1023,I[rt++]=56320|1023&J)}return I.length!==rt&&(I.subarray?I=I.subarray(0,rt):I.length=rt),x.applyFromCharCode(I)}(j=x.transformTo(w.uint8array?"uint8array":"array",j))},x.inherits(V,E),V.prototype.processChunk=function(j){var Z=x.transformTo(w.uint8array?"uint8array":"array",j.data);if(this.leftOver&&this.leftOver.length){if(w.uint8array){var tt=Z;(Z=new Uint8Array(tt.length+this.leftOver.length)).set(this.leftOver,0),Z.set(tt,this.leftOver.length)}else Z=this.leftOver.concat(Z);this.leftOver=null}var rt=function(U,G){var I;for((G=G||U.length)>U.length&&(G=U.length),I=G-1;0<=I&&(192&U[I])==128;)I--;return I<0||I===0?G:I+D[U[I]]>G?I:G}(Z),J=Z;rt!==Z.length&&(w.uint8array?(J=Z.subarray(0,rt),this.leftOver=Z.subarray(rt,Z.length)):(J=Z.slice(0,rt),this.leftOver=Z.slice(rt,Z.length))),this.push({data:v.utf8decode(J),meta:j.meta})},V.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:v.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},v.Utf8DecodeWorker=V,x.inherits(K,E),K.prototype.processChunk=function(j){this.push({data:v.utf8encode(j.data),meta:j.meta})},v.Utf8EncodeWorker=K},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(p,b,v){var x=p("./support"),w=p("./base64"),M=p("./nodejsUtils"),E=p("./external");function D(tt){return tt}function N(tt,rt){for(var J=0;J<tt.length;++J)rt[J]=255&tt.charCodeAt(J);return rt}p("setimmediate"),v.newBlob=function(tt,rt){v.checkSupport("blob");try{return new Blob([tt],{type:rt})}catch(U){try{var J=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return J.append(tt),J.getBlob(rt)}catch(G){throw new Error("Bug : can't construct the Blob.")}}};var V={stringifyByChunk:function(tt,rt,J){var U=[],G=0,I=tt.length;if(I<=J)return String.fromCharCode.apply(null,tt);for(;G<I;)rt==="array"||rt==="nodebuffer"?U.push(String.fromCharCode.apply(null,tt.slice(G,Math.min(G+J,I)))):U.push(String.fromCharCode.apply(null,tt.subarray(G,Math.min(G+J,I)))),G+=J;return U.join("")},stringifyByChar:function(tt){for(var rt="",J=0;J<tt.length;J++)rt+=String.fromCharCode(tt[J]);return rt},applyCanBeUsed:{uint8array:function(){try{return x.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(tt){return!1}}(),nodebuffer:function(){try{return x.nodebuffer&&String.fromCharCode.apply(null,M.allocBuffer(1)).length===1}catch(tt){return!1}}()}};function K(tt){var rt=65536,J=v.getTypeOf(tt),U=!0;if(J==="uint8array"?U=V.applyCanBeUsed.uint8array:J==="nodebuffer"&&(U=V.applyCanBeUsed.nodebuffer),U)for(;1<rt;)try{return V.stringifyByChunk(tt,J,rt)}catch(G){rt=Math.floor(rt/2)}return V.stringifyByChar(tt)}function j(tt,rt){for(var J=0;J<tt.length;J++)rt[J]=tt[J];return rt}v.applyFromCharCode=K;var Z={};Z.string={string:D,array:function(tt){return N(tt,new Array(tt.length))},arraybuffer:function(tt){return Z.string.uint8array(tt).buffer},uint8array:function(tt){return N(tt,new Uint8Array(tt.length))},nodebuffer:function(tt){return N(tt,M.allocBuffer(tt.length))}},Z.array={string:K,array:D,arraybuffer:function(tt){return new Uint8Array(tt).buffer},uint8array:function(tt){return new Uint8Array(tt)},nodebuffer:function(tt){return M.newBufferFrom(tt)}},Z.arraybuffer={string:function(tt){return K(new Uint8Array(tt))},array:function(tt){return j(new Uint8Array(tt),new Array(tt.byteLength))},arraybuffer:D,uint8array:function(tt){return new Uint8Array(tt)},nodebuffer:function(tt){return M.newBufferFrom(new Uint8Array(tt))}},Z.uint8array={string:K,array:function(tt){return j(tt,new Array(tt.length))},arraybuffer:function(tt){return tt.buffer},uint8array:D,nodebuffer:function(tt){return M.newBufferFrom(tt)}},Z.nodebuffer={string:K,array:function(tt){return j(tt,new Array(tt.length))},arraybuffer:function(tt){return Z.nodebuffer.uint8array(tt).buffer},uint8array:function(tt){return j(tt,new Uint8Array(tt.length))},nodebuffer:D},v.transformTo=function(tt,rt){if(rt=rt||"",!tt)return rt;v.checkSupport(tt);var J=v.getTypeOf(rt);return Z[J][tt](rt)},v.resolve=function(tt){for(var rt=tt.split("/"),J=[],U=0;U<rt.length;U++){var G=rt[U];G==="."||G===""&&U!==0&&U!==rt.length-1||(G===".."?J.pop():J.push(G))}return J.join("/")},v.getTypeOf=function(tt){return typeof tt=="string"?"string":Object.prototype.toString.call(tt)==="[object Array]"?"array":x.nodebuffer&&M.isBuffer(tt)?"nodebuffer":x.uint8array&&tt instanceof Uint8Array?"uint8array":x.arraybuffer&&tt instanceof ArrayBuffer?"arraybuffer":void 0},v.checkSupport=function(tt){if(!x[tt.toLowerCase()])throw new Error(tt+" is not supported by this platform")},v.MAX_VALUE_16BITS=65535,v.MAX_VALUE_32BITS=-1,v.pretty=function(tt){var rt,J,U="";for(J=0;J<(tt||"").length;J++)U+="\\x"+((rt=tt.charCodeAt(J))<16?"0":"")+rt.toString(16).toUpperCase();return U},v.delay=function(tt,rt,J){d(function(){tt.apply(J||null,rt||[])})},v.inherits=function(tt,rt){function J(){}J.prototype=rt.prototype,tt.prototype=new J},v.extend=function(){var tt,rt,J={};for(tt=0;tt<arguments.length;tt++)for(rt in arguments[tt])Object.prototype.hasOwnProperty.call(arguments[tt],rt)&&J[rt]===void 0&&(J[rt]=arguments[tt][rt]);return J},v.prepareContent=function(tt,rt,J,U,G){return E.Promise.resolve(rt).then(function(I){return x.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader!="undefined"?new E.Promise(function(C,L){var B=new FileReader;B.onload=function(O){C(O.target.result)},B.onerror=function(O){L(O.target.error)},B.readAsArrayBuffer(I)}):I}).then(function(I){var C=v.getTypeOf(I);return C?(C==="arraybuffer"?I=v.transformTo("uint8array",I):C==="string"&&(G?I=w.decode(I):J&&U!==!0&&(I=function(L){return N(L,x.uint8array?new Uint8Array(L.length):new Array(L.length))}(I))),I):E.Promise.reject(new Error("Can't read the data of '"+tt+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(p,b,v){var x=p("./reader/readerFor"),w=p("./utils"),M=p("./signature"),E=p("./zipEntry"),D=p("./support");function N(V){this.files=[],this.loadOptions=V}N.prototype={checkSignature:function(V){if(!this.reader.readAndCheckSignature(V)){this.reader.index-=4;var K=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+w.pretty(K)+", expected "+w.pretty(V)+")")}},isSignature:function(V,K){var j=this.reader.index;this.reader.setIndex(V);var Z=this.reader.readString(4)===K;return this.reader.setIndex(j),Z},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var V=this.reader.readData(this.zipCommentLength),K=D.uint8array?"uint8array":"array",j=w.transformTo(K,V);this.zipComment=this.loadOptions.decodeFileName(j)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var V,K,j,Z=this.zip64EndOfCentralSize-44;0<Z;)V=this.reader.readInt(2),K=this.reader.readInt(4),j=this.reader.readData(K),this.zip64ExtensibleData[V]={id:V,length:K,value:j}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var V,K;for(V=0;V<this.files.length;V++)K=this.files[V],this.reader.setIndex(K.localHeaderOffset),this.checkSignature(M.LOCAL_FILE_HEADER),K.readLocalPart(this.reader),K.handleUTF8(),K.processAttributes()},readCentralDir:function(){var V;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(M.CENTRAL_FILE_HEADER);)(V=new E({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(V);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var V=this.reader.lastIndexOfSignature(M.CENTRAL_DIRECTORY_END);if(V<0)throw this.isSignature(0,M.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(V);var K=V;if(this.checkSignature(M.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===w.MAX_VALUE_16BITS||this.diskWithCentralDirStart===w.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===w.MAX_VALUE_16BITS||this.centralDirRecords===w.MAX_VALUE_16BITS||this.centralDirSize===w.MAX_VALUE_32BITS||this.centralDirOffset===w.MAX_VALUE_32BITS){if(this.zip64=!0,(V=this.reader.lastIndexOfSignature(M.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(V),this.checkSignature(M.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,M.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(M.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(M.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var j=this.centralDirOffset+this.centralDirSize;this.zip64&&(j+=20,j+=12+this.zip64EndOfCentralSize);var Z=K-j;if(0<Z)this.isSignature(K,M.CENTRAL_FILE_HEADER)||(this.reader.zero=Z);else if(Z<0)throw new Error("Corrupted zip: missing "+Math.abs(Z)+" bytes.")},prepareReader:function(V){this.reader=x(V)},load:function(V){this.prepareReader(V),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},b.exports=N},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(p,b,v){var x=p("./reader/readerFor"),w=p("./utils"),M=p("./compressedObject"),E=p("./crc32"),D=p("./utf8"),N=p("./compressions"),V=p("./support");function K(j,Z){this.options=j,this.loadOptions=Z}K.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(j){var Z,tt;if(j.skip(22),this.fileNameLength=j.readInt(2),tt=j.readInt(2),this.fileName=j.readData(this.fileNameLength),j.skip(tt),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((Z=function(rt){for(var J in N)if(Object.prototype.hasOwnProperty.call(N,J)&&N[J].magic===rt)return N[J];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+w.pretty(this.compressionMethod)+" unknown (inner file : "+w.transformTo("string",this.fileName)+")");this.decompressed=new M(this.compressedSize,this.uncompressedSize,this.crc32,Z,j.readData(this.compressedSize))},readCentralPart:function(j){this.versionMadeBy=j.readInt(2),j.skip(2),this.bitFlag=j.readInt(2),this.compressionMethod=j.readString(2),this.date=j.readDate(),this.crc32=j.readInt(4),this.compressedSize=j.readInt(4),this.uncompressedSize=j.readInt(4);var Z=j.readInt(2);if(this.extraFieldsLength=j.readInt(2),this.fileCommentLength=j.readInt(2),this.diskNumberStart=j.readInt(2),this.internalFileAttributes=j.readInt(2),this.externalFileAttributes=j.readInt(4),this.localHeaderOffset=j.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");j.skip(Z),this.readExtraFields(j),this.parseZIP64ExtraField(j),this.fileComment=j.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var j=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),j==0&&(this.dosPermissions=63&this.externalFileAttributes),j==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var j=x(this.extraFields[1].value);this.uncompressedSize===w.MAX_VALUE_32BITS&&(this.uncompressedSize=j.readInt(8)),this.compressedSize===w.MAX_VALUE_32BITS&&(this.compressedSize=j.readInt(8)),this.localHeaderOffset===w.MAX_VALUE_32BITS&&(this.localHeaderOffset=j.readInt(8)),this.diskNumberStart===w.MAX_VALUE_32BITS&&(this.diskNumberStart=j.readInt(4))}},readExtraFields:function(j){var Z,tt,rt,J=j.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});j.index+4<J;)Z=j.readInt(2),tt=j.readInt(2),rt=j.readData(tt),this.extraFields[Z]={id:Z,length:tt,value:rt};j.setIndex(J)},handleUTF8:function(){var j=V.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=D.utf8decode(this.fileName),this.fileCommentStr=D.utf8decode(this.fileComment);else{var Z=this.findExtraFieldUnicodePath();if(Z!==null)this.fileNameStr=Z;else{var tt=w.transformTo(j,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(tt)}var rt=this.findExtraFieldUnicodeComment();if(rt!==null)this.fileCommentStr=rt;else{var J=w.transformTo(j,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(J)}}},findExtraFieldUnicodePath:function(){var j=this.extraFields[28789];if(j){var Z=x(j.value);return Z.readInt(1)!==1||E(this.fileName)!==Z.readInt(4)?null:D.utf8decode(Z.readData(j.length-5))}return null},findExtraFieldUnicodeComment:function(){var j=this.extraFields[25461];if(j){var Z=x(j.value);return Z.readInt(1)!==1||E(this.fileComment)!==Z.readInt(4)?null:D.utf8decode(Z.readData(j.length-5))}return null}},b.exports=K},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(p,b,v){function x(Z,tt,rt){this.name=Z,this.dir=rt.dir,this.date=rt.date,this.comment=rt.comment,this.unixPermissions=rt.unixPermissions,this.dosPermissions=rt.dosPermissions,this._data=tt,this._dataBinary=rt.binary,this.options={compression:rt.compression,compressionOptions:rt.compressionOptions}}var w=p("./stream/StreamHelper"),M=p("./stream/DataWorker"),E=p("./utf8"),D=p("./compressedObject"),N=p("./stream/GenericWorker");x.prototype={internalStream:function(Z){var tt=null,rt="string";try{if(!Z)throw new Error("No output type specified.");var J=(rt=Z.toLowerCase())==="string"||rt==="text";rt!=="binarystring"&&rt!=="text"||(rt="string"),tt=this._decompressWorker();var U=!this._dataBinary;U&&!J&&(tt=tt.pipe(new E.Utf8EncodeWorker)),!U&&J&&(tt=tt.pipe(new E.Utf8DecodeWorker))}catch(G){(tt=new N("error")).error(G)}return new w(tt,rt,"")},async:function(Z,tt){return this.internalStream(Z).accumulate(tt)},nodeStream:function(Z,tt){return this.internalStream(Z||"nodebuffer").toNodejsStream(tt)},_compressWorker:function(Z,tt){if(this._data instanceof D&&this._data.compression.magic===Z.magic)return this._data.getCompressedWorker();var rt=this._decompressWorker();return this._dataBinary||(rt=rt.pipe(new E.Utf8EncodeWorker)),D.createWorkerFrom(rt,Z,tt)},_decompressWorker:function(){return this._data instanceof D?this._data.getContentWorker():this._data instanceof N?this._data:new M(this._data)}};for(var V=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],K=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},j=0;j<V.length;j++)x.prototype[V[j]]=K;b.exports=x},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(p,b,v){(function(x){var w,M,E=x.MutationObserver||x.WebKitMutationObserver;if(E){var D=0,N=new E(Z),V=x.document.createTextNode("");N.observe(V,{characterData:!0}),w=function(){V.data=D=++D%2}}else if(x.setImmediate||x.MessageChannel===void 0)w="document"in x&&"onreadystatechange"in x.document.createElement("script")?function(){var tt=x.document.createElement("script");tt.onreadystatechange=function(){Z(),tt.onreadystatechange=null,tt.parentNode.removeChild(tt),tt=null},x.document.documentElement.appendChild(tt)}:function(){setTimeout(Z,0)};else{var K=new x.MessageChannel;K.port1.onmessage=Z,w=function(){K.port2.postMessage(0)}}var j=[];function Z(){var tt,rt;M=!0;for(var J=j.length;J;){for(rt=j,j=[],tt=-1;++tt<J;)rt[tt]();J=j.length}M=!1}b.exports=function(tt){j.push(tt)!==1||M||w()}}).call(this,o!==void 0?o:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(p,b,v){var x=p("immediate");function w(){}var M={},E=["REJECTED"],D=["FULFILLED"],N=["PENDING"];function V(J){if(typeof J!="function")throw new TypeError("resolver must be a function");this.state=N,this.queue=[],this.outcome=void 0,J!==w&&tt(this,J)}function K(J,U,G){this.promise=J,typeof U=="function"&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),typeof G=="function"&&(this.onRejected=G,this.callRejected=this.otherCallRejected)}function j(J,U,G){x(function(){var I;try{I=U(G)}catch(C){return M.reject(J,C)}I===J?M.reject(J,new TypeError("Cannot resolve promise with itself")):M.resolve(J,I)})}function Z(J){var U=J&&J.then;if(J&&(typeof J=="object"||typeof J=="function")&&typeof U=="function")return function(){U.apply(J,arguments)}}function tt(J,U){var G=!1;function I(B){G||(G=!0,M.reject(J,B))}function C(B){G||(G=!0,M.resolve(J,B))}var L=rt(function(){U(C,I)});L.status==="error"&&I(L.value)}function rt(J,U){var G={};try{G.value=J(U),G.status="success"}catch(I){G.status="error",G.value=I}return G}(b.exports=V).prototype.finally=function(J){if(typeof J!="function")return this;var U=this.constructor;return this.then(function(G){return U.resolve(J()).then(function(){return G})},function(G){return U.resolve(J()).then(function(){throw G})})},V.prototype.catch=function(J){return this.then(null,J)},V.prototype.then=function(J,U){if(typeof J!="function"&&this.state===D||typeof U!="function"&&this.state===E)return this;var G=new this.constructor(w);return this.state!==N?j(G,this.state===D?J:U,this.outcome):this.queue.push(new K(G,J,U)),G},K.prototype.callFulfilled=function(J){M.resolve(this.promise,J)},K.prototype.otherCallFulfilled=function(J){j(this.promise,this.onFulfilled,J)},K.prototype.callRejected=function(J){M.reject(this.promise,J)},K.prototype.otherCallRejected=function(J){j(this.promise,this.onRejected,J)},M.resolve=function(J,U){var G=rt(Z,U);if(G.status==="error")return M.reject(J,G.value);var I=G.value;if(I)tt(J,I);else{J.state=D,J.outcome=U;for(var C=-1,L=J.queue.length;++C<L;)J.queue[C].callFulfilled(U)}return J},M.reject=function(J,U){J.state=E,J.outcome=U;for(var G=-1,I=J.queue.length;++G<I;)J.queue[G].callRejected(U);return J},V.resolve=function(J){return J instanceof this?J:M.resolve(new this(w),J)},V.reject=function(J){var U=new this(w);return M.reject(U,J)},V.all=function(J){var U=this;if(Object.prototype.toString.call(J)!=="[object Array]")return this.reject(new TypeError("must be an array"));var G=J.length,I=!1;if(!G)return this.resolve([]);for(var C=new Array(G),L=0,B=-1,O=new this(w);++B<G;)q(J[B],B);return O;function q(it,nt){U.resolve(it).then(function(lt){C[nt]=lt,++L!==G||I||(I=!0,M.resolve(O,C))},function(lt){I||(I=!0,M.reject(O,lt))})}},V.race=function(J){if(Object.prototype.toString.call(J)!=="[object Array]")return this.reject(new TypeError("must be an array"));var U=J.length,G=!1;if(!U)return this.resolve([]);for(var I,C=-1,L=new this(w);++C<U;)I=J[C],this.resolve(I).then(function(B){G||(G=!0,M.resolve(L,B))},function(B){G||(G=!0,M.reject(L,B))});return L}},{immediate:36}],38:[function(p,b,v){var x={};(0,p("./lib/utils/common").assign)(x,p("./lib/deflate"),p("./lib/inflate"),p("./lib/zlib/constants")),b.exports=x},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(p,b,v){var x=p("./zlib/deflate"),w=p("./utils/common"),M=p("./utils/strings"),E=p("./zlib/messages"),D=p("./zlib/zstream"),N=Object.prototype.toString;function V(j){if(!(this instanceof V))return new V(j);this.options=w.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},j||{});var Z=this.options;Z.raw&&0<Z.windowBits?Z.windowBits=-Z.windowBits:Z.gzip&&0<Z.windowBits&&Z.windowBits<16&&(Z.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var tt=x.deflateInit2(this.strm,Z.level,Z.method,Z.windowBits,Z.memLevel,Z.strategy);if(tt!==0)throw new Error(E[tt]);if(Z.header&&x.deflateSetHeader(this.strm,Z.header),Z.dictionary){var rt;if(rt=typeof Z.dictionary=="string"?M.string2buf(Z.dictionary):N.call(Z.dictionary)==="[object ArrayBuffer]"?new Uint8Array(Z.dictionary):Z.dictionary,(tt=x.deflateSetDictionary(this.strm,rt))!==0)throw new Error(E[tt]);this._dict_set=!0}}function K(j,Z){var tt=new V(Z);if(tt.push(j,!0),tt.err)throw tt.msg||E[tt.err];return tt.result}V.prototype.push=function(j,Z){var tt,rt,J=this.strm,U=this.options.chunkSize;if(this.ended)return!1;rt=Z===~~Z?Z:Z===!0?4:0,typeof j=="string"?J.input=M.string2buf(j):N.call(j)==="[object ArrayBuffer]"?J.input=new Uint8Array(j):J.input=j,J.next_in=0,J.avail_in=J.input.length;do{if(J.avail_out===0&&(J.output=new w.Buf8(U),J.next_out=0,J.avail_out=U),(tt=x.deflate(J,rt))!==1&&tt!==0)return this.onEnd(tt),!(this.ended=!0);J.avail_out!==0&&(J.avail_in!==0||rt!==4&&rt!==2)||(this.options.to==="string"?this.onData(M.buf2binstring(w.shrinkBuf(J.output,J.next_out))):this.onData(w.shrinkBuf(J.output,J.next_out)))}while((0<J.avail_in||J.avail_out===0)&&tt!==1);return rt===4?(tt=x.deflateEnd(this.strm),this.onEnd(tt),this.ended=!0,tt===0):rt!==2||(this.onEnd(0),!(J.avail_out=0))},V.prototype.onData=function(j){this.chunks.push(j)},V.prototype.onEnd=function(j){j===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=w.flattenChunks(this.chunks)),this.chunks=[],this.err=j,this.msg=this.strm.msg},v.Deflate=V,v.deflate=K,v.deflateRaw=function(j,Z){return(Z=Z||{}).raw=!0,K(j,Z)},v.gzip=function(j,Z){return(Z=Z||{}).gzip=!0,K(j,Z)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(p,b,v){var x=p("./zlib/inflate"),w=p("./utils/common"),M=p("./utils/strings"),E=p("./zlib/constants"),D=p("./zlib/messages"),N=p("./zlib/zstream"),V=p("./zlib/gzheader"),K=Object.prototype.toString;function j(tt){if(!(this instanceof j))return new j(tt);this.options=w.assign({chunkSize:16384,windowBits:0,to:""},tt||{});var rt=this.options;rt.raw&&0<=rt.windowBits&&rt.windowBits<16&&(rt.windowBits=-rt.windowBits,rt.windowBits===0&&(rt.windowBits=-15)),!(0<=rt.windowBits&&rt.windowBits<16)||tt&&tt.windowBits||(rt.windowBits+=32),15<rt.windowBits&&rt.windowBits<48&&!(15&rt.windowBits)&&(rt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var J=x.inflateInit2(this.strm,rt.windowBits);if(J!==E.Z_OK)throw new Error(D[J]);this.header=new V,x.inflateGetHeader(this.strm,this.header)}function Z(tt,rt){var J=new j(rt);if(J.push(tt,!0),J.err)throw J.msg||D[J.err];return J.result}j.prototype.push=function(tt,rt){var J,U,G,I,C,L,B=this.strm,O=this.options.chunkSize,q=this.options.dictionary,it=!1;if(this.ended)return!1;U=rt===~~rt?rt:rt===!0?E.Z_FINISH:E.Z_NO_FLUSH,typeof tt=="string"?B.input=M.binstring2buf(tt):K.call(tt)==="[object ArrayBuffer]"?B.input=new Uint8Array(tt):B.input=tt,B.next_in=0,B.avail_in=B.input.length;do{if(B.avail_out===0&&(B.output=new w.Buf8(O),B.next_out=0,B.avail_out=O),(J=x.inflate(B,E.Z_NO_FLUSH))===E.Z_NEED_DICT&&q&&(L=typeof q=="string"?M.string2buf(q):K.call(q)==="[object ArrayBuffer]"?new Uint8Array(q):q,J=x.inflateSetDictionary(this.strm,L)),J===E.Z_BUF_ERROR&&it===!0&&(J=E.Z_OK,it=!1),J!==E.Z_STREAM_END&&J!==E.Z_OK)return this.onEnd(J),!(this.ended=!0);B.next_out&&(B.avail_out!==0&&J!==E.Z_STREAM_END&&(B.avail_in!==0||U!==E.Z_FINISH&&U!==E.Z_SYNC_FLUSH)||(this.options.to==="string"?(G=M.utf8border(B.output,B.next_out),I=B.next_out-G,C=M.buf2string(B.output,G),B.next_out=I,B.avail_out=O-I,I&&w.arraySet(B.output,B.output,G,I,0),this.onData(C)):this.onData(w.shrinkBuf(B.output,B.next_out)))),B.avail_in===0&&B.avail_out===0&&(it=!0)}while((0<B.avail_in||B.avail_out===0)&&J!==E.Z_STREAM_END);return J===E.Z_STREAM_END&&(U=E.Z_FINISH),U===E.Z_FINISH?(J=x.inflateEnd(this.strm),this.onEnd(J),this.ended=!0,J===E.Z_OK):U!==E.Z_SYNC_FLUSH||(this.onEnd(E.Z_OK),!(B.avail_out=0))},j.prototype.onData=function(tt){this.chunks.push(tt)},j.prototype.onEnd=function(tt){tt===E.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=w.flattenChunks(this.chunks)),this.chunks=[],this.err=tt,this.msg=this.strm.msg},v.Inflate=j,v.inflate=Z,v.inflateRaw=function(tt,rt){return(rt=rt||{}).raw=!0,Z(tt,rt)},v.ungzip=Z},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(p,b,v){var x=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";v.assign=function(E){for(var D=Array.prototype.slice.call(arguments,1);D.length;){var N=D.shift();if(N){if(typeof N!="object")throw new TypeError(N+"must be non-object");for(var V in N)N.hasOwnProperty(V)&&(E[V]=N[V])}}return E},v.shrinkBuf=function(E,D){return E.length===D?E:E.subarray?E.subarray(0,D):(E.length=D,E)};var w={arraySet:function(E,D,N,V,K){if(D.subarray&&E.subarray)E.set(D.subarray(N,N+V),K);else for(var j=0;j<V;j++)E[K+j]=D[N+j]},flattenChunks:function(E){var D,N,V,K,j,Z;for(D=V=0,N=E.length;D<N;D++)V+=E[D].length;for(Z=new Uint8Array(V),D=K=0,N=E.length;D<N;D++)j=E[D],Z.set(j,K),K+=j.length;return Z}},M={arraySet:function(E,D,N,V,K){for(var j=0;j<V;j++)E[K+j]=D[N+j]},flattenChunks:function(E){return[].concat.apply([],E)}};v.setTyped=function(E){E?(v.Buf8=Uint8Array,v.Buf16=Uint16Array,v.Buf32=Int32Array,v.assign(v,w)):(v.Buf8=Array,v.Buf16=Array,v.Buf32=Array,v.assign(v,M))},v.setTyped(x)},{}],42:[function(p,b,v){var x=p("./common"),w=!0,M=!0;try{String.fromCharCode.apply(null,[0])}catch(V){w=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(V){M=!1}for(var E=new x.Buf8(256),D=0;D<256;D++)E[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;function N(V,K){if(K<65537&&(V.subarray&&M||!V.subarray&&w))return String.fromCharCode.apply(null,x.shrinkBuf(V,K));for(var j="",Z=0;Z<K;Z++)j+=String.fromCharCode(V[Z]);return j}E[254]=E[254]=1,v.string2buf=function(V){var K,j,Z,tt,rt,J=V.length,U=0;for(tt=0;tt<J;tt++)(64512&(j=V.charCodeAt(tt)))==55296&&tt+1<J&&(64512&(Z=V.charCodeAt(tt+1)))==56320&&(j=65536+(j-55296<<10)+(Z-56320),tt++),U+=j<128?1:j<2048?2:j<65536?3:4;for(K=new x.Buf8(U),tt=rt=0;rt<U;tt++)(64512&(j=V.charCodeAt(tt)))==55296&&tt+1<J&&(64512&(Z=V.charCodeAt(tt+1)))==56320&&(j=65536+(j-55296<<10)+(Z-56320),tt++),j<128?K[rt++]=j:(j<2048?K[rt++]=192|j>>>6:(j<65536?K[rt++]=224|j>>>12:(K[rt++]=240|j>>>18,K[rt++]=128|j>>>12&63),K[rt++]=128|j>>>6&63),K[rt++]=128|63&j);return K},v.buf2binstring=function(V){return N(V,V.length)},v.binstring2buf=function(V){for(var K=new x.Buf8(V.length),j=0,Z=K.length;j<Z;j++)K[j]=V.charCodeAt(j);return K},v.buf2string=function(V,K){var j,Z,tt,rt,J=K||V.length,U=new Array(2*J);for(j=Z=0;j<J;)if((tt=V[j++])<128)U[Z++]=tt;else if(4<(rt=E[tt]))U[Z++]=65533,j+=rt-1;else{for(tt&=rt===2?31:rt===3?15:7;1<rt&&j<J;)tt=tt<<6|63&V[j++],rt--;1<rt?U[Z++]=65533:tt<65536?U[Z++]=tt:(tt-=65536,U[Z++]=55296|tt>>10&1023,U[Z++]=56320|1023&tt)}return N(U,Z)},v.utf8border=function(V,K){var j;for((K=K||V.length)>V.length&&(K=V.length),j=K-1;0<=j&&(192&V[j])==128;)j--;return j<0||j===0?K:j+E[V[j]]>K?j:K}},{"./common":41}],43:[function(p,b,v){b.exports=function(x,w,M,E){for(var D=65535&x|0,N=x>>>16&65535|0,V=0;M!==0;){for(M-=V=2e3<M?2e3:M;N=N+(D=D+w[E++]|0)|0,--V;);D%=65521,N%=65521}return D|N<<16|0}},{}],44:[function(p,b,v){b.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(p,b,v){var x=function(){for(var w,M=[],E=0;E<256;E++){w=E;for(var D=0;D<8;D++)w=1&w?3988292384^w>>>1:w>>>1;M[E]=w}return M}();b.exports=function(w,M,E,D){var N=x,V=D+E;w^=-1;for(var K=D;K<V;K++)w=w>>>8^N[255&(w^M[K])];return-1^w}},{}],46:[function(p,b,v){var x,w=p("../utils/common"),M=p("./trees"),E=p("./adler32"),D=p("./crc32"),N=p("./messages"),V=-2,K=258,j=262,Z=113;function tt(Q,gt){return Q.msg=N[gt],gt}function rt(Q){return(Q<<1)-(4<Q?9:0)}function J(Q){for(var gt=Q.length;0<=--gt;)Q[gt]=0}function U(Q){var gt=Q.state,Y=gt.pending;Y>Q.avail_out&&(Y=Q.avail_out),Y!==0&&(w.arraySet(Q.output,gt.pending_buf,gt.pending_out,Y,Q.next_out),Q.next_out+=Y,gt.pending_out+=Y,Q.total_out+=Y,Q.avail_out-=Y,gt.pending-=Y,gt.pending===0&&(gt.pending_out=0))}function G(Q,gt){M._tr_flush_block(Q,0<=Q.block_start?Q.block_start:-1,Q.strstart-Q.block_start,gt),Q.block_start=Q.strstart,U(Q.strm)}function I(Q,gt){Q.pending_buf[Q.pending++]=gt}function C(Q,gt){Q.pending_buf[Q.pending++]=gt>>>8&255,Q.pending_buf[Q.pending++]=255&gt}function L(Q,gt){var Y,H,at=Q.max_chain_length,ft=Q.strstart,wt=Q.prev_length,_t=Q.nice_match,Dt=Q.strstart>Q.w_size-j?Q.strstart-(Q.w_size-j):0,Gt=Q.window,te=Q.w_mask,mt=Q.prev,At=Q.strstart+K,Ot=Gt[ft+wt-1],Zt=Gt[ft+wt];Q.prev_length>=Q.good_match&&(at>>=2),_t>Q.lookahead&&(_t=Q.lookahead);do if(Gt[(Y=gt)+wt]===Zt&&Gt[Y+wt-1]===Ot&&Gt[Y]===Gt[ft]&&Gt[++Y]===Gt[ft+1]){ft+=2,Y++;do;while(Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&Gt[++ft]===Gt[++Y]&&ft<At);if(H=K-(At-ft),ft=At-K,wt<H){if(Q.match_start=gt,_t<=(wt=H))break;Ot=Gt[ft+wt-1],Zt=Gt[ft+wt]}}while((gt=mt[gt&te])>Dt&&--at!=0);return wt<=Q.lookahead?wt:Q.lookahead}function B(Q){var gt,Y,H,at,ft,wt,_t,Dt,Gt,te,mt=Q.w_size;do{if(at=Q.window_size-Q.lookahead-Q.strstart,Q.strstart>=mt+(mt-j)){for(w.arraySet(Q.window,Q.window,mt,mt,0),Q.match_start-=mt,Q.strstart-=mt,Q.block_start-=mt,gt=Y=Q.hash_size;H=Q.head[--gt],Q.head[gt]=mt<=H?H-mt:0,--Y;);for(gt=Y=mt;H=Q.prev[--gt],Q.prev[gt]=mt<=H?H-mt:0,--Y;);at+=mt}if(Q.strm.avail_in===0)break;if(wt=Q.strm,_t=Q.window,Dt=Q.strstart+Q.lookahead,te=void 0,(Gt=at)<(te=wt.avail_in)&&(te=Gt),Y=te===0?0:(wt.avail_in-=te,w.arraySet(_t,wt.input,wt.next_in,te,Dt),wt.state.wrap===1?wt.adler=E(wt.adler,_t,te,Dt):wt.state.wrap===2&&(wt.adler=D(wt.adler,_t,te,Dt)),wt.next_in+=te,wt.total_in+=te,te),Q.lookahead+=Y,Q.lookahead+Q.insert>=3)for(ft=Q.strstart-Q.insert,Q.ins_h=Q.window[ft],Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[ft+1])&Q.hash_mask;Q.insert&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[ft+3-1])&Q.hash_mask,Q.prev[ft&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=ft,ft++,Q.insert--,!(Q.lookahead+Q.insert<3)););}while(Q.lookahead<j&&Q.strm.avail_in!==0)}function O(Q,gt){for(var Y,H;;){if(Q.lookahead<j){if(B(Q),Q.lookahead<j&&gt===0)return 1;if(Q.lookahead===0)break}if(Y=0,Q.lookahead>=3&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+3-1])&Q.hash_mask,Y=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),Y!==0&&Q.strstart-Y<=Q.w_size-j&&(Q.match_length=L(Q,Y)),Q.match_length>=3)if(H=M._tr_tally(Q,Q.strstart-Q.match_start,Q.match_length-3),Q.lookahead-=Q.match_length,Q.match_length<=Q.max_lazy_match&&Q.lookahead>=3){for(Q.match_length--;Q.strstart++,Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+3-1])&Q.hash_mask,Y=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart,--Q.match_length!=0;);Q.strstart++}else Q.strstart+=Q.match_length,Q.match_length=0,Q.ins_h=Q.window[Q.strstart],Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+1])&Q.hash_mask;else H=M._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++;if(H&&(G(Q,!1),Q.strm.avail_out===0))return 1}return Q.insert=Q.strstart<2?Q.strstart:2,gt===4?(G(Q,!0),Q.strm.avail_out===0?3:4):Q.last_lit&&(G(Q,!1),Q.strm.avail_out===0)?1:2}function q(Q,gt){for(var Y,H,at;;){if(Q.lookahead<j){if(B(Q),Q.lookahead<j&&gt===0)return 1;if(Q.lookahead===0)break}if(Y=0,Q.lookahead>=3&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+3-1])&Q.hash_mask,Y=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),Q.prev_length=Q.match_length,Q.prev_match=Q.match_start,Q.match_length=2,Y!==0&&Q.prev_length<Q.max_lazy_match&&Q.strstart-Y<=Q.w_size-j&&(Q.match_length=L(Q,Y),Q.match_length<=5&&(Q.strategy===1||Q.match_length===3&&4096<Q.strstart-Q.match_start)&&(Q.match_length=2)),Q.prev_length>=3&&Q.match_length<=Q.prev_length){for(at=Q.strstart+Q.lookahead-3,H=M._tr_tally(Q,Q.strstart-1-Q.prev_match,Q.prev_length-3),Q.lookahead-=Q.prev_length-1,Q.prev_length-=2;++Q.strstart<=at&&(Q.ins_h=(Q.ins_h<<Q.hash_shift^Q.window[Q.strstart+3-1])&Q.hash_mask,Y=Q.prev[Q.strstart&Q.w_mask]=Q.head[Q.ins_h],Q.head[Q.ins_h]=Q.strstart),--Q.prev_length!=0;);if(Q.match_available=0,Q.match_length=2,Q.strstart++,H&&(G(Q,!1),Q.strm.avail_out===0))return 1}else if(Q.match_available){if((H=M._tr_tally(Q,0,Q.window[Q.strstart-1]))&&G(Q,!1),Q.strstart++,Q.lookahead--,Q.strm.avail_out===0)return 1}else Q.match_available=1,Q.strstart++,Q.lookahead--}return Q.match_available&&(H=M._tr_tally(Q,0,Q.window[Q.strstart-1]),Q.match_available=0),Q.insert=Q.strstart<2?Q.strstart:2,gt===4?(G(Q,!0),Q.strm.avail_out===0?3:4):Q.last_lit&&(G(Q,!1),Q.strm.avail_out===0)?1:2}function it(Q,gt,Y,H,at){this.good_length=Q,this.max_lazy=gt,this.nice_length=Y,this.max_chain=H,this.func=at}function nt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new w.Buf16(1146),this.dyn_dtree=new w.Buf16(122),this.bl_tree=new w.Buf16(78),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new w.Buf16(16),this.heap=new w.Buf16(573),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new w.Buf16(573),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lt(Q){var gt;return Q&&Q.state?(Q.total_in=Q.total_out=0,Q.data_type=2,(gt=Q.state).pending=0,gt.pending_out=0,gt.wrap<0&&(gt.wrap=-gt.wrap),gt.status=gt.wrap?42:Z,Q.adler=gt.wrap===2?0:1,gt.last_flush=0,M._tr_init(gt),0):tt(Q,V)}function ut(Q){var gt=lt(Q);return gt===0&&function(Y){Y.window_size=2*Y.w_size,J(Y.head),Y.max_lazy_match=x[Y.level].max_lazy,Y.good_match=x[Y.level].good_length,Y.nice_match=x[Y.level].nice_length,Y.max_chain_length=x[Y.level].max_chain,Y.strstart=0,Y.block_start=0,Y.lookahead=0,Y.insert=0,Y.match_length=Y.prev_length=2,Y.match_available=0,Y.ins_h=0}(Q.state),gt}function vt(Q,gt,Y,H,at,ft){if(!Q)return V;var wt=1;if(gt===-1&&(gt=6),H<0?(wt=0,H=-H):15<H&&(wt=2,H-=16),at<1||9<at||Y!==8||H<8||15<H||gt<0||9<gt||ft<0||4<ft)return tt(Q,V);H===8&&(H=9);var _t=new nt;return(Q.state=_t).strm=Q,_t.wrap=wt,_t.gzhead=null,_t.w_bits=H,_t.w_size=1<<_t.w_bits,_t.w_mask=_t.w_size-1,_t.hash_bits=at+7,_t.hash_size=1<<_t.hash_bits,_t.hash_mask=_t.hash_size-1,_t.hash_shift=~~((_t.hash_bits+3-1)/3),_t.window=new w.Buf8(2*_t.w_size),_t.head=new w.Buf16(_t.hash_size),_t.prev=new w.Buf16(_t.w_size),_t.lit_bufsize=1<<at+6,_t.pending_buf_size=4*_t.lit_bufsize,_t.pending_buf=new w.Buf8(_t.pending_buf_size),_t.d_buf=1*_t.lit_bufsize,_t.l_buf=3*_t.lit_bufsize,_t.level=gt,_t.strategy=ft,_t.method=Y,ut(Q)}x=[new it(0,0,0,0,function(Q,gt){var Y=65535;for(Y>Q.pending_buf_size-5&&(Y=Q.pending_buf_size-5);;){if(Q.lookahead<=1){if(B(Q),Q.lookahead===0&&gt===0)return 1;if(Q.lookahead===0)break}Q.strstart+=Q.lookahead,Q.lookahead=0;var H=Q.block_start+Y;if((Q.strstart===0||Q.strstart>=H)&&(Q.lookahead=Q.strstart-H,Q.strstart=H,G(Q,!1),Q.strm.avail_out===0)||Q.strstart-Q.block_start>=Q.w_size-j&&(G(Q,!1),Q.strm.avail_out===0))return 1}return Q.insert=0,gt===4?(G(Q,!0),Q.strm.avail_out===0?3:4):(Q.strstart>Q.block_start&&(G(Q,!1),Q.strm.avail_out),1)}),new it(4,4,8,4,O),new it(4,5,16,8,O),new it(4,6,32,32,O),new it(4,4,16,16,q),new it(8,16,32,32,q),new it(8,16,128,128,q),new it(8,32,128,256,q),new it(32,128,258,1024,q),new it(32,258,258,4096,q)],v.deflateInit=function(Q,gt){return vt(Q,gt,8,15,8,0)},v.deflateInit2=vt,v.deflateReset=ut,v.deflateResetKeep=lt,v.deflateSetHeader=function(Q,gt){return Q&&Q.state?Q.state.wrap!==2?V:(Q.state.gzhead=gt,0):V},v.deflate=function(Q,gt){var Y,H,at,ft;if(!Q||!Q.state||5<gt||gt<0)return Q?tt(Q,V):V;if(H=Q.state,!Q.output||!Q.input&&Q.avail_in!==0||H.status===666&&gt!==4)return tt(Q,Q.avail_out===0?-5:V);if(H.strm=Q,Y=H.last_flush,H.last_flush=gt,H.status===42)if(H.wrap===2)Q.adler=0,I(H,31),I(H,139),I(H,8),H.gzhead?(I(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),I(H,255&H.gzhead.time),I(H,H.gzhead.time>>8&255),I(H,H.gzhead.time>>16&255),I(H,H.gzhead.time>>24&255),I(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),I(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(I(H,255&H.gzhead.extra.length),I(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(Q.adler=D(Q.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(I(H,0),I(H,0),I(H,0),I(H,0),I(H,0),I(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),I(H,3),H.status=Z);else{var wt=8+(H.w_bits-8<<4)<<8;wt|=(2<=H.strategy||H.level<2?0:H.level<6?1:H.level===6?2:3)<<6,H.strstart!==0&&(wt|=32),wt+=31-wt%31,H.status=Z,C(H,wt),H.strstart!==0&&(C(H,Q.adler>>>16),C(H,65535&Q.adler)),Q.adler=1}if(H.status===69)if(H.gzhead.extra){for(at=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>at&&(Q.adler=D(Q.adler,H.pending_buf,H.pending-at,at)),U(Q),at=H.pending,H.pending!==H.pending_buf_size));)I(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>at&&(Q.adler=D(Q.adler,H.pending_buf,H.pending-at,at)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(H.status===73)if(H.gzhead.name){at=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>at&&(Q.adler=D(Q.adler,H.pending_buf,H.pending-at,at)),U(Q),at=H.pending,H.pending===H.pending_buf_size)){ft=1;break}ft=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,I(H,ft)}while(ft!==0);H.gzhead.hcrc&&H.pending>at&&(Q.adler=D(Q.adler,H.pending_buf,H.pending-at,at)),ft===0&&(H.gzindex=0,H.status=91)}else H.status=91;if(H.status===91)if(H.gzhead.comment){at=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>at&&(Q.adler=D(Q.adler,H.pending_buf,H.pending-at,at)),U(Q),at=H.pending,H.pending===H.pending_buf_size)){ft=1;break}ft=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,I(H,ft)}while(ft!==0);H.gzhead.hcrc&&H.pending>at&&(Q.adler=D(Q.adler,H.pending_buf,H.pending-at,at)),ft===0&&(H.status=103)}else H.status=103;if(H.status===103&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&U(Q),H.pending+2<=H.pending_buf_size&&(I(H,255&Q.adler),I(H,Q.adler>>8&255),Q.adler=0,H.status=Z)):H.status=Z),H.pending!==0){if(U(Q),Q.avail_out===0)return H.last_flush=-1,0}else if(Q.avail_in===0&&rt(gt)<=rt(Y)&&gt!==4)return tt(Q,-5);if(H.status===666&&Q.avail_in!==0)return tt(Q,-5);if(Q.avail_in!==0||H.lookahead!==0||gt!==0&&H.status!==666){var _t=H.strategy===2?function(Dt,Gt){for(var te;;){if(Dt.lookahead===0&&(B(Dt),Dt.lookahead===0)){if(Gt===0)return 1;break}if(Dt.match_length=0,te=M._tr_tally(Dt,0,Dt.window[Dt.strstart]),Dt.lookahead--,Dt.strstart++,te&&(G(Dt,!1),Dt.strm.avail_out===0))return 1}return Dt.insert=0,Gt===4?(G(Dt,!0),Dt.strm.avail_out===0?3:4):Dt.last_lit&&(G(Dt,!1),Dt.strm.avail_out===0)?1:2}(H,gt):H.strategy===3?function(Dt,Gt){for(var te,mt,At,Ot,Zt=Dt.window;;){if(Dt.lookahead<=K){if(B(Dt),Dt.lookahead<=K&&Gt===0)return 1;if(Dt.lookahead===0)break}if(Dt.match_length=0,Dt.lookahead>=3&&0<Dt.strstart&&(mt=Zt[At=Dt.strstart-1])===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]){Ot=Dt.strstart+K;do;while(mt===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]&&mt===Zt[++At]&&At<Ot);Dt.match_length=K-(Ot-At),Dt.match_length>Dt.lookahead&&(Dt.match_length=Dt.lookahead)}if(Dt.match_length>=3?(te=M._tr_tally(Dt,1,Dt.match_length-3),Dt.lookahead-=Dt.match_length,Dt.strstart+=Dt.match_length,Dt.match_length=0):(te=M._tr_tally(Dt,0,Dt.window[Dt.strstart]),Dt.lookahead--,Dt.strstart++),te&&(G(Dt,!1),Dt.strm.avail_out===0))return 1}return Dt.insert=0,Gt===4?(G(Dt,!0),Dt.strm.avail_out===0?3:4):Dt.last_lit&&(G(Dt,!1),Dt.strm.avail_out===0)?1:2}(H,gt):x[H.level].func(H,gt);if(_t!==3&&_t!==4||(H.status=666),_t===1||_t===3)return Q.avail_out===0&&(H.last_flush=-1),0;if(_t===2&&(gt===1?M._tr_align(H):gt!==5&&(M._tr_stored_block(H,0,0,!1),gt===3&&(J(H.head),H.lookahead===0&&(H.strstart=0,H.block_start=0,H.insert=0))),U(Q),Q.avail_out===0))return H.last_flush=-1,0}return gt!==4?0:H.wrap<=0?1:(H.wrap===2?(I(H,255&Q.adler),I(H,Q.adler>>8&255),I(H,Q.adler>>16&255),I(H,Q.adler>>24&255),I(H,255&Q.total_in),I(H,Q.total_in>>8&255),I(H,Q.total_in>>16&255),I(H,Q.total_in>>24&255)):(C(H,Q.adler>>>16),C(H,65535&Q.adler)),U(Q),0<H.wrap&&(H.wrap=-H.wrap),H.pending!==0?0:1)},v.deflateEnd=function(Q){var gt;return Q&&Q.state?(gt=Q.state.status)!==42&&gt!==69&&gt!==73&&gt!==91&&gt!==103&&gt!==Z&&gt!==666?tt(Q,V):(Q.state=null,gt===Z?tt(Q,-3):0):V},v.deflateSetDictionary=function(Q,gt){var Y,H,at,ft,wt,_t,Dt,Gt,te=gt.length;if(!Q||!Q.state||(ft=(Y=Q.state).wrap)===2||ft===1&&Y.status!==42||Y.lookahead)return V;for(ft===1&&(Q.adler=E(Q.adler,gt,te,0)),Y.wrap=0,te>=Y.w_size&&(ft===0&&(J(Y.head),Y.strstart=0,Y.block_start=0,Y.insert=0),Gt=new w.Buf8(Y.w_size),w.arraySet(Gt,gt,te-Y.w_size,Y.w_size,0),gt=Gt,te=Y.w_size),wt=Q.avail_in,_t=Q.next_in,Dt=Q.input,Q.avail_in=te,Q.next_in=0,Q.input=gt,B(Y);Y.lookahead>=3;){for(H=Y.strstart,at=Y.lookahead-2;Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[H+3-1])&Y.hash_mask,Y.prev[H&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=H,H++,--at;);Y.strstart=H,Y.lookahead=2,B(Y)}return Y.strstart+=Y.lookahead,Y.block_start=Y.strstart,Y.insert=Y.lookahead,Y.lookahead=0,Y.match_length=Y.prev_length=2,Y.match_available=0,Q.next_in=_t,Q.input=Dt,Q.avail_in=wt,Y.wrap=ft,0},v.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(p,b,v){b.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(p,b,v){b.exports=function(x,w){var M,E,D,N,V,K,j,Z,tt,rt,J,U,G,I,C,L,B,O,q,it,nt,lt,ut,vt,Q;M=x.state,E=x.next_in,vt=x.input,D=E+(x.avail_in-5),N=x.next_out,Q=x.output,V=N-(w-x.avail_out),K=N+(x.avail_out-257),j=M.dmax,Z=M.wsize,tt=M.whave,rt=M.wnext,J=M.window,U=M.hold,G=M.bits,I=M.lencode,C=M.distcode,L=(1<<M.lenbits)-1,B=(1<<M.distbits)-1;t:do{G<15&&(U+=vt[E++]<<G,G+=8,U+=vt[E++]<<G,G+=8),O=I[U&L];e:for(;;){if(U>>>=q=O>>>24,G-=q,(q=O>>>16&255)==0)Q[N++]=65535&O;else{if(!(16&q)){if(!(64&q)){O=I[(65535&O)+(U&(1<<q)-1)];continue e}if(32&q){M.mode=12;break t}x.msg="invalid literal/length code",M.mode=30;break t}it=65535&O,(q&=15)&&(G<q&&(U+=vt[E++]<<G,G+=8),it+=U&(1<<q)-1,U>>>=q,G-=q),G<15&&(U+=vt[E++]<<G,G+=8,U+=vt[E++]<<G,G+=8),O=C[U&B];n:for(;;){if(U>>>=q=O>>>24,G-=q,!(16&(q=O>>>16&255))){if(!(64&q)){O=C[(65535&O)+(U&(1<<q)-1)];continue n}x.msg="invalid distance code",M.mode=30;break t}if(nt=65535&O,G<(q&=15)&&(U+=vt[E++]<<G,(G+=8)<q&&(U+=vt[E++]<<G,G+=8)),j<(nt+=U&(1<<q)-1)){x.msg="invalid distance too far back",M.mode=30;break t}if(U>>>=q,G-=q,(q=N-V)<nt){if(tt<(q=nt-q)&&M.sane){x.msg="invalid distance too far back",M.mode=30;break t}if(ut=J,(lt=0)===rt){if(lt+=Z-q,q<it){for(it-=q;Q[N++]=J[lt++],--q;);lt=N-nt,ut=Q}}else if(rt<q){if(lt+=Z+rt-q,(q-=rt)<it){for(it-=q;Q[N++]=J[lt++],--q;);if(lt=0,rt<it){for(it-=q=rt;Q[N++]=J[lt++],--q;);lt=N-nt,ut=Q}}}else if(lt+=rt-q,q<it){for(it-=q;Q[N++]=J[lt++],--q;);lt=N-nt,ut=Q}for(;2<it;)Q[N++]=ut[lt++],Q[N++]=ut[lt++],Q[N++]=ut[lt++],it-=3;it&&(Q[N++]=ut[lt++],1<it&&(Q[N++]=ut[lt++]))}else{for(lt=N-nt;Q[N++]=Q[lt++],Q[N++]=Q[lt++],Q[N++]=Q[lt++],2<(it-=3););it&&(Q[N++]=Q[lt++],1<it&&(Q[N++]=Q[lt++]))}break}}break}}while(E<D&&N<K);E-=it=G>>3,U&=(1<<(G-=it<<3))-1,x.next_in=E,x.next_out=N,x.avail_in=E<D?D-E+5:5-(E-D),x.avail_out=N<K?K-N+257:257-(N-K),M.hold=U,M.bits=G}},{}],49:[function(p,b,v){var x=p("../utils/common"),w=p("./adler32"),M=p("./crc32"),E=p("./inffast"),D=p("./inftrees"),N=-2;function V(L){return(L>>>24&255)+(L>>>8&65280)+((65280&L)<<8)+((255&L)<<24)}function K(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new x.Buf16(320),this.work=new x.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(L){var B;return L&&L.state?(B=L.state,L.total_in=L.total_out=B.total=0,L.msg="",B.wrap&&(L.adler=1&B.wrap),B.mode=1,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new x.Buf32(852),B.distcode=B.distdyn=new x.Buf32(592),B.sane=1,B.back=-1,0):N}function Z(L){var B;return L&&L.state?((B=L.state).wsize=0,B.whave=0,B.wnext=0,j(L)):N}function tt(L,B){var O,q;return L&&L.state?(q=L.state,B<0?(O=0,B=-B):(O=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?N:(q.window!==null&&q.wbits!==B&&(q.window=null),q.wrap=O,q.wbits=B,Z(L))):N}function rt(L,B){var O,q;return L?(q=new K,(L.state=q).window=null,(O=tt(L,B))!==0&&(L.state=null),O):N}var J,U,G=!0;function I(L){if(G){var B;for(J=new x.Buf32(512),U=new x.Buf32(32),B=0;B<144;)L.lens[B++]=8;for(;B<256;)L.lens[B++]=9;for(;B<280;)L.lens[B++]=7;for(;B<288;)L.lens[B++]=8;for(D(1,L.lens,0,288,J,0,L.work,{bits:9}),B=0;B<32;)L.lens[B++]=5;D(2,L.lens,0,32,U,0,L.work,{bits:5}),G=!1}L.lencode=J,L.lenbits=9,L.distcode=U,L.distbits=5}function C(L,B,O,q){var it,nt=L.state;return nt.window===null&&(nt.wsize=1<<nt.wbits,nt.wnext=0,nt.whave=0,nt.window=new x.Buf8(nt.wsize)),q>=nt.wsize?(x.arraySet(nt.window,B,O-nt.wsize,nt.wsize,0),nt.wnext=0,nt.whave=nt.wsize):(q<(it=nt.wsize-nt.wnext)&&(it=q),x.arraySet(nt.window,B,O-q,it,nt.wnext),(q-=it)?(x.arraySet(nt.window,B,O-q,q,0),nt.wnext=q,nt.whave=nt.wsize):(nt.wnext+=it,nt.wnext===nt.wsize&&(nt.wnext=0),nt.whave<nt.wsize&&(nt.whave+=it))),0}v.inflateReset=Z,v.inflateReset2=tt,v.inflateResetKeep=j,v.inflateInit=function(L){return rt(L,15)},v.inflateInit2=rt,v.inflate=function(L,B){var O,q,it,nt,lt,ut,vt,Q,gt,Y,H,at,ft,wt,_t,Dt,Gt,te,mt,At,Ot,Zt,he,fe,be=0,Me=new x.Buf8(4),Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return N;(O=L.state).mode===12&&(O.mode=13),lt=L.next_out,it=L.output,vt=L.avail_out,nt=L.next_in,q=L.input,ut=L.avail_in,Q=O.hold,gt=O.bits,Y=ut,H=vt,Zt=0;t:for(;;)switch(O.mode){case 1:if(O.wrap===0){O.mode=13;break}for(;gt<16;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(2&O.wrap&&Q===35615){Me[O.check=0]=255&Q,Me[1]=Q>>>8&255,O.check=M(O.check,Me,2,0),gt=Q=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&Q)<<8)+(Q>>8))%31){L.msg="incorrect header check",O.mode=30;break}if((15&Q)!=8){L.msg="unknown compression method",O.mode=30;break}if(gt-=4,Ot=8+(15&(Q>>>=4)),O.wbits===0)O.wbits=Ot;else if(Ot>O.wbits){L.msg="invalid window size",O.mode=30;break}O.dmax=1<<Ot,L.adler=O.check=1,O.mode=512&Q?10:12,gt=Q=0;break;case 2:for(;gt<16;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(O.flags=Q,(255&O.flags)!=8){L.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){L.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=Q>>8&1),512&O.flags&&(Me[0]=255&Q,Me[1]=Q>>>8&255,O.check=M(O.check,Me,2,0)),gt=Q=0,O.mode=3;case 3:for(;gt<32;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}O.head&&(O.head.time=Q),512&O.flags&&(Me[0]=255&Q,Me[1]=Q>>>8&255,Me[2]=Q>>>16&255,Me[3]=Q>>>24&255,O.check=M(O.check,Me,4,0)),gt=Q=0,O.mode=4;case 4:for(;gt<16;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}O.head&&(O.head.xflags=255&Q,O.head.os=Q>>8),512&O.flags&&(Me[0]=255&Q,Me[1]=Q>>>8&255,O.check=M(O.check,Me,2,0)),gt=Q=0,O.mode=5;case 5:if(1024&O.flags){for(;gt<16;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}O.length=Q,O.head&&(O.head.extra_len=Q),512&O.flags&&(Me[0]=255&Q,Me[1]=Q>>>8&255,O.check=M(O.check,Me,2,0)),gt=Q=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(ut<(at=O.length)&&(at=ut),at&&(O.head&&(Ot=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),x.arraySet(O.head.extra,q,nt,at,Ot)),512&O.flags&&(O.check=M(O.check,q,at,nt)),ut-=at,nt+=at,O.length-=at),O.length))break t;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(ut===0)break t;for(at=0;Ot=q[nt+at++],O.head&&Ot&&O.length<65536&&(O.head.name+=String.fromCharCode(Ot)),Ot&&at<ut;);if(512&O.flags&&(O.check=M(O.check,q,at,nt)),ut-=at,nt+=at,Ot)break t}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(ut===0)break t;for(at=0;Ot=q[nt+at++],O.head&&Ot&&O.length<65536&&(O.head.comment+=String.fromCharCode(Ot)),Ot&&at<ut;);if(512&O.flags&&(O.check=M(O.check,q,at,nt)),ut-=at,nt+=at,Ot)break t}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;gt<16;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(Q!==(65535&O.check)){L.msg="header crc mismatch",O.mode=30;break}gt=Q=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),L.adler=O.check=0,O.mode=12;break;case 10:for(;gt<32;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}L.adler=O.check=V(Q),gt=Q=0,O.mode=11;case 11:if(O.havedict===0)return L.next_out=lt,L.avail_out=vt,L.next_in=nt,L.avail_in=ut,O.hold=Q,O.bits=gt,2;L.adler=O.check=1,O.mode=12;case 12:if(B===5||B===6)break t;case 13:if(O.last){Q>>>=7&gt,gt-=7&gt,O.mode=27;break}for(;gt<3;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}switch(O.last=1&Q,gt-=1,3&(Q>>>=1)){case 0:O.mode=14;break;case 1:if(I(O),O.mode=20,B!==6)break;Q>>>=2,gt-=2;break t;case 2:O.mode=17;break;case 3:L.msg="invalid block type",O.mode=30}Q>>>=2,gt-=2;break;case 14:for(Q>>>=7&gt,gt-=7&gt;gt<32;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if((65535&Q)!=(Q>>>16^65535)){L.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&Q,gt=Q=0,O.mode=15,B===6)break t;case 15:O.mode=16;case 16:if(at=O.length){if(ut<at&&(at=ut),vt<at&&(at=vt),at===0)break t;x.arraySet(it,q,nt,at,lt),ut-=at,nt+=at,vt-=at,lt+=at,O.length-=at;break}O.mode=12;break;case 17:for(;gt<14;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(O.nlen=257+(31&Q),Q>>>=5,gt-=5,O.ndist=1+(31&Q),Q>>>=5,gt-=5,O.ncode=4+(15&Q),Q>>>=4,gt-=4,286<O.nlen||30<O.ndist){L.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;gt<3;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}O.lens[Pe[O.have++]]=7&Q,Q>>>=3,gt-=3}for(;O.have<19;)O.lens[Pe[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,he={bits:O.lenbits},Zt=D(0,O.lens,0,19,O.lencode,0,O.work,he),O.lenbits=he.bits,Zt){L.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;Dt=(be=O.lencode[Q&(1<<O.lenbits)-1])>>>16&255,Gt=65535&be,!((_t=be>>>24)<=gt);){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(Gt<16)Q>>>=_t,gt-=_t,O.lens[O.have++]=Gt;else{if(Gt===16){for(fe=_t+2;gt<fe;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(Q>>>=_t,gt-=_t,O.have===0){L.msg="invalid bit length repeat",O.mode=30;break}Ot=O.lens[O.have-1],at=3+(3&Q),Q>>>=2,gt-=2}else if(Gt===17){for(fe=_t+3;gt<fe;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}gt-=_t,Ot=0,at=3+(7&(Q>>>=_t)),Q>>>=3,gt-=3}else{for(fe=_t+7;gt<fe;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}gt-=_t,Ot=0,at=11+(127&(Q>>>=_t)),Q>>>=7,gt-=7}if(O.have+at>O.nlen+O.ndist){L.msg="invalid bit length repeat",O.mode=30;break}for(;at--;)O.lens[O.have++]=Ot}}if(O.mode===30)break;if(O.lens[256]===0){L.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,he={bits:O.lenbits},Zt=D(1,O.lens,0,O.nlen,O.lencode,0,O.work,he),O.lenbits=he.bits,Zt){L.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,he={bits:O.distbits},Zt=D(2,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,he),O.distbits=he.bits,Zt){L.msg="invalid distances set",O.mode=30;break}if(O.mode=20,B===6)break t;case 20:O.mode=21;case 21:if(6<=ut&&258<=vt){L.next_out=lt,L.avail_out=vt,L.next_in=nt,L.avail_in=ut,O.hold=Q,O.bits=gt,E(L,H),lt=L.next_out,it=L.output,vt=L.avail_out,nt=L.next_in,q=L.input,ut=L.avail_in,Q=O.hold,gt=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;Dt=(be=O.lencode[Q&(1<<O.lenbits)-1])>>>16&255,Gt=65535&be,!((_t=be>>>24)<=gt);){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(Dt&&!(240&Dt)){for(te=_t,mt=Dt,At=Gt;Dt=(be=O.lencode[At+((Q&(1<<te+mt)-1)>>te)])>>>16&255,Gt=65535&be,!(te+(_t=be>>>24)<=gt);){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}Q>>>=te,gt-=te,O.back+=te}if(Q>>>=_t,gt-=_t,O.back+=_t,O.length=Gt,Dt===0){O.mode=26;break}if(32&Dt){O.back=-1,O.mode=12;break}if(64&Dt){L.msg="invalid literal/length code",O.mode=30;break}O.extra=15&Dt,O.mode=22;case 22:if(O.extra){for(fe=O.extra;gt<fe;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}O.length+=Q&(1<<O.extra)-1,Q>>>=O.extra,gt-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;Dt=(be=O.distcode[Q&(1<<O.distbits)-1])>>>16&255,Gt=65535&be,!((_t=be>>>24)<=gt);){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(!(240&Dt)){for(te=_t,mt=Dt,At=Gt;Dt=(be=O.distcode[At+((Q&(1<<te+mt)-1)>>te)])>>>16&255,Gt=65535&be,!(te+(_t=be>>>24)<=gt);){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}Q>>>=te,gt-=te,O.back+=te}if(Q>>>=_t,gt-=_t,O.back+=_t,64&Dt){L.msg="invalid distance code",O.mode=30;break}O.offset=Gt,O.extra=15&Dt,O.mode=24;case 24:if(O.extra){for(fe=O.extra;gt<fe;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}O.offset+=Q&(1<<O.extra)-1,Q>>>=O.extra,gt-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){L.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(vt===0)break t;if(at=H-vt,O.offset>at){if((at=O.offset-at)>O.whave&&O.sane){L.msg="invalid distance too far back",O.mode=30;break}ft=at>O.wnext?(at-=O.wnext,O.wsize-at):O.wnext-at,at>O.length&&(at=O.length),wt=O.window}else wt=it,ft=lt-O.offset,at=O.length;for(vt<at&&(at=vt),vt-=at,O.length-=at;it[lt++]=wt[ft++],--at;);O.length===0&&(O.mode=21);break;case 26:if(vt===0)break t;it[lt++]=O.length,vt--,O.mode=21;break;case 27:if(O.wrap){for(;gt<32;){if(ut===0)break t;ut--,Q|=q[nt++]<<gt,gt+=8}if(H-=vt,L.total_out+=H,O.total+=H,H&&(L.adler=O.check=O.flags?M(O.check,it,H,lt-H):w(O.check,it,H,lt-H)),H=vt,(O.flags?Q:V(Q))!==O.check){L.msg="incorrect data check",O.mode=30;break}gt=Q=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;gt<32;){if(ut===0)break t;ut--,Q+=q[nt++]<<gt,gt+=8}if(Q!==(4294967295&O.total)){L.msg="incorrect length check",O.mode=30;break}gt=Q=0}O.mode=29;case 29:Zt=1;break t;case 30:Zt=-3;break t;case 31:return-4;case 32:default:return N}return L.next_out=lt,L.avail_out=vt,L.next_in=nt,L.avail_in=ut,O.hold=Q,O.bits=gt,(O.wsize||H!==L.avail_out&&O.mode<30&&(O.mode<27||B!==4))&&C(L,L.output,L.next_out,H-L.avail_out)?(O.mode=31,-4):(Y-=L.avail_in,H-=L.avail_out,L.total_in+=Y,L.total_out+=H,O.total+=H,O.wrap&&H&&(L.adler=O.check=O.flags?M(O.check,it,H,L.next_out-H):w(O.check,it,H,L.next_out-H)),L.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(Y==0&&H===0||B===4)&&Zt===0&&(Zt=-5),Zt)},v.inflateEnd=function(L){if(!L||!L.state)return N;var B=L.state;return B.window&&(B.window=null),L.state=null,0},v.inflateGetHeader=function(L,B){var O;return L&&L.state&&2&(O=L.state).wrap?((O.head=B).done=!1,0):N},v.inflateSetDictionary=function(L,B){var O,q=B.length;return L&&L.state?(O=L.state).wrap!==0&&O.mode!==11?N:O.mode===11&&w(1,B,q,0)!==O.check?-3:C(L,B,q,q)?(O.mode=31,-4):(O.havedict=1,0):N},v.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(p,b,v){var x=p("../utils/common"),w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],M=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];b.exports=function(N,V,K,j,Z,tt,rt,J){var U,G,I,C,L,B,O,q,it,nt=J.bits,lt=0,ut=0,vt=0,Q=0,gt=0,Y=0,H=0,at=0,ft=0,wt=0,_t=null,Dt=0,Gt=new x.Buf16(16),te=new x.Buf16(16),mt=null,At=0;for(lt=0;lt<=15;lt++)Gt[lt]=0;for(ut=0;ut<j;ut++)Gt[V[K+ut]]++;for(gt=nt,Q=15;1<=Q&&Gt[Q]===0;Q--);if(Q<gt&&(gt=Q),Q===0)return Z[tt++]=20971520,Z[tt++]=20971520,J.bits=1,0;for(vt=1;vt<Q&&Gt[vt]===0;vt++);for(gt<vt&&(gt=vt),lt=at=1;lt<=15;lt++)if(at<<=1,(at-=Gt[lt])<0)return-1;if(0<at&&(N===0||Q!==1))return-1;for(te[1]=0,lt=1;lt<15;lt++)te[lt+1]=te[lt]+Gt[lt];for(ut=0;ut<j;ut++)V[K+ut]!==0&&(rt[te[V[K+ut]]++]=ut);if(B=N===0?(_t=mt=rt,19):N===1?(_t=w,Dt-=257,mt=M,At-=257,256):(_t=E,mt=D,-1),lt=vt,L=tt,H=ut=wt=0,I=-1,C=(ft=1<<(Y=gt))-1,N===1&&852<ft||N===2&&592<ft)return 1;for(;;){for(O=lt-H,it=rt[ut]<B?(q=0,rt[ut]):rt[ut]>B?(q=mt[At+rt[ut]],_t[Dt+rt[ut]]):(q=96,0),U=1<<lt-H,vt=G=1<<Y;Z[L+(wt>>H)+(G-=U)]=O<<24|q<<16|it|0,G!==0;);for(U=1<<lt-1;wt&U;)U>>=1;if(U!==0?(wt&=U-1,wt+=U):wt=0,ut++,--Gt[lt]==0){if(lt===Q)break;lt=V[K+rt[ut]]}if(gt<lt&&(wt&C)!==I){for(H===0&&(H=gt),L+=vt,at=1<<(Y=lt-H);Y+H<Q&&!((at-=Gt[Y+H])<=0);)Y++,at<<=1;if(ft+=1<<Y,N===1&&852<ft||N===2&&592<ft)return 1;Z[I=wt&C]=gt<<24|Y<<16|L-tt|0}}return wt!==0&&(Z[L+wt]=lt-H<<24|64<<16|0),J.bits=gt,0}},{"../utils/common":41}],51:[function(p,b,v){b.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(p,b,v){var x=p("../utils/common");function w(mt){for(var At=mt.length;0<=--At;)mt[At]=0}var M=256,E=286,D=30,N=15,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=new Array(576);w(tt);var rt=new Array(60);w(rt);var J=new Array(512);w(J);var U=new Array(256);w(U);var G=new Array(29);w(G);var I,C,L,B=new Array(D);function O(mt,At,Ot,Zt,he){this.static_tree=mt,this.extra_bits=At,this.extra_base=Ot,this.elems=Zt,this.max_length=he,this.has_stree=mt&&mt.length}function q(mt,At){this.dyn_tree=mt,this.max_code=0,this.stat_desc=At}function it(mt){return mt<256?J[mt]:J[256+(mt>>>7)]}function nt(mt,At){mt.pending_buf[mt.pending++]=255&At,mt.pending_buf[mt.pending++]=At>>>8&255}function lt(mt,At,Ot){mt.bi_valid>16-Ot?(mt.bi_buf|=At<<mt.bi_valid&65535,nt(mt,mt.bi_buf),mt.bi_buf=At>>16-mt.bi_valid,mt.bi_valid+=Ot-16):(mt.bi_buf|=At<<mt.bi_valid&65535,mt.bi_valid+=Ot)}function ut(mt,At,Ot){lt(mt,Ot[2*At],Ot[2*At+1])}function vt(mt,At){for(var Ot=0;Ot|=1&mt,mt>>>=1,Ot<<=1,0<--At;);return Ot>>>1}function Q(mt,At,Ot){var Zt,he,fe=new Array(16),be=0;for(Zt=1;Zt<=N;Zt++)fe[Zt]=be=be+Ot[Zt-1]<<1;for(he=0;he<=At;he++){var Me=mt[2*he+1];Me!==0&&(mt[2*he]=vt(fe[Me]++,Me))}}function gt(mt){var At;for(At=0;At<E;At++)mt.dyn_ltree[2*At]=0;for(At=0;At<D;At++)mt.dyn_dtree[2*At]=0;for(At=0;At<19;At++)mt.bl_tree[2*At]=0;mt.dyn_ltree[512]=1,mt.opt_len=mt.static_len=0,mt.last_lit=mt.matches=0}function Y(mt){8<mt.bi_valid?nt(mt,mt.bi_buf):0<mt.bi_valid&&(mt.pending_buf[mt.pending++]=mt.bi_buf),mt.bi_buf=0,mt.bi_valid=0}function H(mt,At,Ot,Zt){var he=2*At,fe=2*Ot;return mt[he]<mt[fe]||mt[he]===mt[fe]&&Zt[At]<=Zt[Ot]}function at(mt,At,Ot){for(var Zt=mt.heap[Ot],he=Ot<<1;he<=mt.heap_len&&(he<mt.heap_len&&H(At,mt.heap[he+1],mt.heap[he],mt.depth)&&he++,!H(At,Zt,mt.heap[he],mt.depth));)mt.heap[Ot]=mt.heap[he],Ot=he,he<<=1;mt.heap[Ot]=Zt}function ft(mt,At,Ot){var Zt,he,fe,be,Me=0;if(mt.last_lit!==0)for(;Zt=mt.pending_buf[mt.d_buf+2*Me]<<8|mt.pending_buf[mt.d_buf+2*Me+1],he=mt.pending_buf[mt.l_buf+Me],Me++,Zt===0?ut(mt,he,At):(ut(mt,(fe=U[he])+M+1,At),(be=V[fe])!==0&&lt(mt,he-=G[fe],be),ut(mt,fe=it(--Zt),Ot),(be=K[fe])!==0&&lt(mt,Zt-=B[fe],be)),Me<mt.last_lit;);ut(mt,256,At)}function wt(mt,At){var Ot,Zt,he,fe=At.dyn_tree,be=At.stat_desc.static_tree,Me=At.stat_desc.has_stree,Pe=At.stat_desc.elems,ze=-1;for(mt.heap_len=0,mt.heap_max=573,Ot=0;Ot<Pe;Ot++)fe[2*Ot]!==0?(mt.heap[++mt.heap_len]=ze=Ot,mt.depth[Ot]=0):fe[2*Ot+1]=0;for(;mt.heap_len<2;)fe[2*(he=mt.heap[++mt.heap_len]=ze<2?++ze:0)]=1,mt.depth[he]=0,mt.opt_len--,Me&&(mt.static_len-=be[2*he+1]);for(At.max_code=ze,Ot=mt.heap_len>>1;1<=Ot;Ot--)at(mt,fe,Ot);for(he=Pe;Ot=mt.heap[1],mt.heap[1]=mt.heap[mt.heap_len--],at(mt,fe,1),Zt=mt.heap[1],mt.heap[--mt.heap_max]=Ot,mt.heap[--mt.heap_max]=Zt,fe[2*he]=fe[2*Ot]+fe[2*Zt],mt.depth[he]=(mt.depth[Ot]>=mt.depth[Zt]?mt.depth[Ot]:mt.depth[Zt])+1,fe[2*Ot+1]=fe[2*Zt+1]=he,mt.heap[1]=he++,at(mt,fe,1),2<=mt.heap_len;);mt.heap[--mt.heap_max]=mt.heap[1],function(Ce,Le){var Ye,le,Fe,Ke,Ze,ke,Qe=Le.dyn_tree,hn=Le.max_code,ln=Le.stat_desc.static_tree,Hn=Le.stat_desc.has_stree,Tn=Le.stat_desc.extra_bits,Sn=Le.stat_desc.extra_base,On=Le.stat_desc.max_length,qn=0;for(Ke=0;Ke<=N;Ke++)Ce.bl_count[Ke]=0;for(Qe[2*Ce.heap[Ce.heap_max]+1]=0,Ye=Ce.heap_max+1;Ye<573;Ye++)On<(Ke=Qe[2*Qe[2*(le=Ce.heap[Ye])+1]+1]+1)&&(Ke=On,qn++),Qe[2*le+1]=Ke,hn<le||(Ce.bl_count[Ke]++,Ze=0,Sn<=le&&(Ze=Tn[le-Sn]),ke=Qe[2*le],Ce.opt_len+=ke*(Ke+Ze),Hn&&(Ce.static_len+=ke*(ln[2*le+1]+Ze)));if(qn!==0){do{for(Ke=On-1;Ce.bl_count[Ke]===0;)Ke--;Ce.bl_count[Ke]--,Ce.bl_count[Ke+1]+=2,Ce.bl_count[On]--,qn-=2}while(0<qn);for(Ke=On;Ke!==0;Ke--)for(le=Ce.bl_count[Ke];le!==0;)hn<(Fe=Ce.heap[--Ye])||(Qe[2*Fe+1]!==Ke&&(Ce.opt_len+=(Ke-Qe[2*Fe+1])*Qe[2*Fe],Qe[2*Fe+1]=Ke),le--)}}(mt,At),Q(fe,ze,mt.bl_count)}function _t(mt,At,Ot){var Zt,he,fe=-1,be=At[1],Me=0,Pe=7,ze=4;for(be===0&&(Pe=138,ze=3),At[2*(Ot+1)+1]=65535,Zt=0;Zt<=Ot;Zt++)he=be,be=At[2*(Zt+1)+1],++Me<Pe&&he===be||(Me<ze?mt.bl_tree[2*he]+=Me:he!==0?(he!==fe&&mt.bl_tree[2*he]++,mt.bl_tree[32]++):Me<=10?mt.bl_tree[34]++:mt.bl_tree[36]++,fe=he,ze=(Me=0)===be?(Pe=138,3):he===be?(Pe=6,3):(Pe=7,4))}function Dt(mt,At,Ot){var Zt,he,fe=-1,be=At[1],Me=0,Pe=7,ze=4;for(be===0&&(Pe=138,ze=3),Zt=0;Zt<=Ot;Zt++)if(he=be,be=At[2*(Zt+1)+1],!(++Me<Pe&&he===be)){if(Me<ze)for(;ut(mt,he,mt.bl_tree),--Me!=0;);else he!==0?(he!==fe&&(ut(mt,he,mt.bl_tree),Me--),ut(mt,16,mt.bl_tree),lt(mt,Me-3,2)):Me<=10?(ut(mt,17,mt.bl_tree),lt(mt,Me-3,3)):(ut(mt,18,mt.bl_tree),lt(mt,Me-11,7));fe=he,ze=(Me=0)===be?(Pe=138,3):he===be?(Pe=6,3):(Pe=7,4)}}w(B);var Gt=!1;function te(mt,At,Ot,Zt){lt(mt,0+(Zt?1:0),3),function(he,fe,be,Me){Y(he),nt(he,be),nt(he,~be),x.arraySet(he.pending_buf,he.window,fe,be,he.pending),he.pending+=be}(mt,At,Ot)}v._tr_init=function(mt){Gt||(function(){var At,Ot,Zt,he,fe,be=new Array(16);for(he=Zt=0;he<28;he++)for(G[he]=Zt,At=0;At<1<<V[he];At++)U[Zt++]=he;for(U[Zt-1]=he,he=fe=0;he<16;he++)for(B[he]=fe,At=0;At<1<<K[he];At++)J[fe++]=he;for(fe>>=7;he<D;he++)for(B[he]=fe<<7,At=0;At<1<<K[he]-7;At++)J[256+fe++]=he;for(Ot=0;Ot<=N;Ot++)be[Ot]=0;for(At=0;At<=143;)tt[2*At+1]=8,At++,be[8]++;for(;At<=255;)tt[2*At+1]=9,At++,be[9]++;for(;At<=279;)tt[2*At+1]=7,At++,be[7]++;for(;At<=287;)tt[2*At+1]=8,At++,be[8]++;for(Q(tt,287,be),At=0;At<D;At++)rt[2*At+1]=5,rt[2*At]=vt(At,5);I=new O(tt,V,257,E,N),C=new O(rt,K,0,D,N),L=new O(new Array(0),j,0,19,7)}(),Gt=!0),mt.l_desc=new q(mt.dyn_ltree,I),mt.d_desc=new q(mt.dyn_dtree,C),mt.bl_desc=new q(mt.bl_tree,L),mt.bi_buf=0,mt.bi_valid=0,gt(mt)},v._tr_stored_block=te,v._tr_flush_block=function(mt,At,Ot,Zt){var he,fe,be=0;0<mt.level?(mt.strm.data_type===2&&(mt.strm.data_type=function(Me){var Pe,ze=4093624447;for(Pe=0;Pe<=31;Pe++,ze>>>=1)if(1&ze&&Me.dyn_ltree[2*Pe]!==0)return 0;if(Me.dyn_ltree[18]!==0||Me.dyn_ltree[20]!==0||Me.dyn_ltree[26]!==0)return 1;for(Pe=32;Pe<M;Pe++)if(Me.dyn_ltree[2*Pe]!==0)return 1;return 0}(mt)),wt(mt,mt.l_desc),wt(mt,mt.d_desc),be=function(Me){var Pe;for(_t(Me,Me.dyn_ltree,Me.l_desc.max_code),_t(Me,Me.dyn_dtree,Me.d_desc.max_code),wt(Me,Me.bl_desc),Pe=18;3<=Pe&&Me.bl_tree[2*Z[Pe]+1]===0;Pe--);return Me.opt_len+=3*(Pe+1)+5+5+4,Pe}(mt),he=mt.opt_len+3+7>>>3,(fe=mt.static_len+3+7>>>3)<=he&&(he=fe)):he=fe=Ot+5,Ot+4<=he&&At!==-1?te(mt,At,Ot,Zt):mt.strategy===4||fe===he?(lt(mt,2+(Zt?1:0),3),ft(mt,tt,rt)):(lt(mt,4+(Zt?1:0),3),function(Me,Pe,ze,Ce){var Le;for(lt(Me,Pe-257,5),lt(Me,ze-1,5),lt(Me,Ce-4,4),Le=0;Le<Ce;Le++)lt(Me,Me.bl_tree[2*Z[Le]+1],3);Dt(Me,Me.dyn_ltree,Pe-1),Dt(Me,Me.dyn_dtree,ze-1)}(mt,mt.l_desc.max_code+1,mt.d_desc.max_code+1,be+1),ft(mt,mt.dyn_ltree,mt.dyn_dtree)),gt(mt),Zt&&Y(mt)},v._tr_tally=function(mt,At,Ot){return mt.pending_buf[mt.d_buf+2*mt.last_lit]=At>>>8&255,mt.pending_buf[mt.d_buf+2*mt.last_lit+1]=255&At,mt.pending_buf[mt.l_buf+mt.last_lit]=255&Ot,mt.last_lit++,At===0?mt.dyn_ltree[2*Ot]++:(mt.matches++,At--,mt.dyn_ltree[2*(U[Ot]+M+1)]++,mt.dyn_dtree[2*it(At)]++),mt.last_lit===mt.lit_bufsize-1},v._tr_align=function(mt){lt(mt,2,3),ut(mt,256,tt),function(At){At.bi_valid===16?(nt(At,At.bi_buf),At.bi_buf=0,At.bi_valid=0):8<=At.bi_valid&&(At.pending_buf[At.pending++]=255&At.bi_buf,At.bi_buf>>=8,At.bi_valid-=8)}(mt)}},{"../utils/common":41}],53:[function(p,b,v){b.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(p,b,v){(function(x){(function(w,M){if(!w.setImmediate){var E,D,N,V,K=1,j={},Z=!1,tt=w.document,rt=Object.getPrototypeOf&&Object.getPrototypeOf(w);rt=rt&&rt.setTimeout?rt:w,E={}.toString.call(w.process)==="[object process]"?function(I){a.nextTick(function(){U(I)})}:function(){if(w.postMessage&&!w.importScripts){var I=!0,C=w.onmessage;return w.onmessage=function(){I=!1},w.postMessage("","*"),w.onmessage=C,I}}()?(V="setImmediate$"+Math.random()+"$",w.addEventListener?w.addEventListener("message",G,!1):w.attachEvent("onmessage",G),function(I){w.postMessage(V+I,"*")}):w.MessageChannel?((N=new MessageChannel).port1.onmessage=function(I){U(I.data)},function(I){N.port2.postMessage(I)}):tt&&"onreadystatechange"in tt.createElement("script")?(D=tt.documentElement,function(I){var C=tt.createElement("script");C.onreadystatechange=function(){U(I),C.onreadystatechange=null,D.removeChild(C),C=null},D.appendChild(C)}):function(I){setTimeout(U,0,I)},rt.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var C=new Array(arguments.length-1),L=0;L<C.length;L++)C[L]=arguments[L+1];var B={callback:I,args:C};return j[K]=B,E(K),K++},rt.clearImmediate=J}function J(I){delete j[I]}function U(I){if(Z)setTimeout(U,0,I);else{var C=j[I];if(C){Z=!0;try{(function(L){var B=L.callback,O=L.args;switch(O.length){case 0:B();break;case 1:B(O[0]);break;case 2:B(O[0],O[1]);break;case 3:B(O[0],O[1],O[2]);break;default:B.apply(void 0,O)}})(C)}finally{J(I),Z=!1}}}}function G(I){I.source===w&&typeof I.data=="string"&&I.data.indexOf(V)===0&&U(+I.data.slice(V.length))}})(typeof self=="undefined"?x===void 0?this:x:self)}).call(this,o!==void 0?o:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,i,s){(function(a){(function(){var o=/[\\^$.*+?()[\]{}|]/g,r=RegExp(o.source),u=typeof a=="object"&&a&&a.Object===Object&&a,l=typeof self=="object"&&self&&self.Object===Object&&self,h=u||l||Function("return this")(),f=Object.prototype.toString,d=h.Symbol,p=d?d.prototype:void 0,b=p?p.toString:void 0;function v(x){if(typeof x=="string")return x;if(function(M){return typeof M=="symbol"||function(E){return!!E&&typeof E=="object"}(M)&&f.call(M)=="[object Symbol]"}(x))return b?b.call(x):"";var w=x+"";return w=="0"&&1/x==-1/0?"-0":w}i.exports=function(x){var w;return(x=(w=x)==null?"":v(w))&&r.test(x)?x.replace(o,"\\$&"):x}}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],443:[function(e,i,s){(function(a){(function(){var o="[object Arguments]",r="[object Map]",u="[object Object]",l="[object Set]",h=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,f=/^\w*$/,d=/^\./,p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,b=/\\(\\)?/g,v=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w[o]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w["[object Error]"]=w["[object Function]"]=w[r]=w["[object Number]"]=w[u]=w["[object RegExp]"]=w[l]=w["[object String]"]=w["[object WeakMap]"]=!1;var M=typeof a=="object"&&a&&a.Object===Object&&a,E=typeof self=="object"&&self&&self.Object===Object&&self,D=M||E||Function("return this")(),N=typeof s=="object"&&s&&!s.nodeType&&s,V=N&&typeof i=="object"&&i&&!i.nodeType&&i,K=V&&V.exports===N&&M.process,j=function(){try{return K&&K.binding("util")}catch(qt){}}(),Z=j&&j.isTypedArray;function tt(qt,ye,pe,Te){for(var We=-1,Ie=qt?qt.length:0;++We<Ie;){var Ge=qt[We];ye(Te,Ge,pe(Ge),qt)}return Te}function rt(qt,ye){for(var pe=-1,Te=qt?qt.length:0;++pe<Te;)if(ye(qt[pe],pe,qt))return!0;return!1}function J(qt){var ye=!1;if(qt!=null&&typeof qt.toString!="function")try{ye=!!(qt+"")}catch(pe){}return ye}function U(qt){var ye=-1,pe=Array(qt.size);return qt.forEach(function(Te,We){pe[++ye]=[We,Te]}),pe}function G(qt){var ye=-1,pe=Array(qt.size);return qt.forEach(function(Te){pe[++ye]=Te}),pe}var I,C,L,B=Array.prototype,O=Function.prototype,q=Object.prototype,it=D["__core-js_shared__"],nt=(I=/[^.]+$/.exec(it&&it.keys&&it.keys.IE_PROTO||""))?"Symbol(src)_1."+I:"",lt=O.toString,ut=q.hasOwnProperty,vt=q.toString,Q=RegExp("^"+lt.call(ut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gt=D.Symbol,Y=D.Uint8Array,H=q.propertyIsEnumerable,at=B.splice,ft=(C=Object.keys,L=Object,function(qt){return C(L(qt))}),wt=zn(D,"DataView"),_t=zn(D,"Map"),Dt=zn(D,"Promise"),Gt=zn(D,"Set"),te=zn(D,"WeakMap"),mt=zn(Object,"create"),At=zt(wt),Ot=zt(_t),Zt=zt(Dt),he=zt(Gt),fe=zt(te),be=gt?gt.prototype:void 0,Me=be?be.valueOf:void 0,Pe=be?be.toString:void 0;function ze(qt){var ye=-1,pe=qt?qt.length:0;for(this.clear();++ye<pe;){var Te=qt[ye];this.set(Te[0],Te[1])}}function Ce(qt){var ye=-1,pe=qt?qt.length:0;for(this.clear();++ye<pe;){var Te=qt[ye];this.set(Te[0],Te[1])}}function Le(qt){var ye=-1,pe=qt?qt.length:0;for(this.clear();++ye<pe;){var Te=qt[ye];this.set(Te[0],Te[1])}}function Ye(qt){var ye=-1,pe=qt?qt.length:0;for(this.__data__=new Le;++ye<pe;)this.add(qt[ye])}function le(qt){this.__data__=new Ce(qt)}function Fe(qt,ye){var pe=Ee(qt)||Xe(qt)?function(Ge,mn){for(var In=-1,Wn=Array(Ge);++In<Ge;)Wn[In]=mn(In);return Wn}(qt.length,String):[],Te=pe.length,We=!!Te;for(var Ie in qt)!ye&&!ut.call(qt,Ie)||We&&(Ie=="length"||Wt(Ie,Te))||pe.push(Ie);return pe}function Ke(qt,ye){for(var pe=qt.length;pe--;)if(ve(qt[pe][0],ye))return pe;return-1}function Ze(qt,ye,pe,Te){return Qe(qt,function(We,Ie,Ge){ye(Te,We,pe(We),Ge)}),Te}ze.prototype.clear=function(){this.__data__=mt?mt(null):{}},ze.prototype.delete=function(qt){return this.has(qt)&&delete this.__data__[qt]},ze.prototype.get=function(qt){var ye=this.__data__;if(mt){var pe=ye[qt];return pe==="__lodash_hash_undefined__"?void 0:pe}return ut.call(ye,qt)?ye[qt]:void 0},ze.prototype.has=function(qt){var ye=this.__data__;return mt?ye[qt]!==void 0:ut.call(ye,qt)},ze.prototype.set=function(qt,ye){return this.__data__[qt]=mt&&ye===void 0?"__lodash_hash_undefined__":ye,this},Ce.prototype.clear=function(){this.__data__=[]},Ce.prototype.delete=function(qt){var ye=this.__data__,pe=Ke(ye,qt);return!(pe<0)&&(pe==ye.length-1?ye.pop():at.call(ye,pe,1),!0)},Ce.prototype.get=function(qt){var ye=this.__data__,pe=Ke(ye,qt);return pe<0?void 0:ye[pe][1]},Ce.prototype.has=function(qt){return Ke(this.__data__,qt)>-1},Ce.prototype.set=function(qt,ye){var pe=this.__data__,Te=Ke(pe,qt);return Te<0?pe.push([qt,ye]):pe[Te][1]=ye,this},Le.prototype.clear=function(){this.__data__={hash:new ze,map:new(_t||Ce),string:new ze}},Le.prototype.delete=function(qt){return Yn(this,qt).delete(qt)},Le.prototype.get=function(qt){return Yn(this,qt).get(qt)},Le.prototype.has=function(qt){return Yn(this,qt).has(qt)},Le.prototype.set=function(qt,ye){return Yn(this,qt).set(qt,ye),this},Ye.prototype.add=Ye.prototype.push=function(qt){return this.__data__.set(qt,"__lodash_hash_undefined__"),this},Ye.prototype.has=function(qt){return this.__data__.has(qt)},le.prototype.clear=function(){this.__data__=new Ce},le.prototype.delete=function(qt){return this.__data__.delete(qt)},le.prototype.get=function(qt){return this.__data__.get(qt)},le.prototype.has=function(qt){return this.__data__.has(qt)},le.prototype.set=function(qt,ye){var pe=this.__data__;if(pe instanceof Ce){var Te=pe.__data__;if(!_t||Te.length<199)return Te.push([qt,ye]),this;pe=this.__data__=new Le(Te)}return pe.set(qt,ye),this};var ke,Qe=(ke=function(qt,ye){return qt&&hn(qt,ye,en)},function(qt,ye){if(qt==null)return qt;if(!$e(qt))return ke(qt,ye);for(var pe=qt.length,Te=-1,We=Object(qt);++Te<pe&&ye(We[Te],Te,We)!==!1;);return qt}),hn=function(qt){return function(ye,pe,Te){for(var We=-1,Ie=Object(ye),Ge=Te(ye),mn=Ge.length;mn--;){var In=Ge[qt?mn:++We];if(pe(Ie[In],In,Ie)===!1)break}return ye}}();function ln(qt,ye){for(var pe=0,Te=(ye=St(ye,qt)?[ye]:Pn(ye)).length;qt!=null&&pe<Te;)qt=qt[It(ye[pe++])];return pe&&pe==Te?qt:void 0}function Hn(qt,ye){return qt!=null&&ye in Object(qt)}function Tn(qt,ye,pe,Te,We){return qt===ye||(qt==null||ye==null||!ee(qt)&&!Yt(ye)?qt!=qt&&ye!=ye:function(Ie,Ge,mn,In,Wn,vn){var jn=Ee(Ie),Xn=Ee(Ge),ur="[object Array]",wr="[object Array]";jn||(ur=(ur=Qn(Ie))==o?u:ur),Xn||(wr=(wr=Qn(Ge))==o?u:wr);var Ur=ur==u&&!J(Ie),qr=wr==u&&!J(Ge),Ei=ur==wr;if(Ei&&!Ur)return vn||(vn=new le),jn||Ue(Ie)?cr(Ie,Ge,mn,In,Wn,vn):function($n,rr,ii,Mo,Lr,Xr,di){switch(ii){case"[object DataView]":if($n.byteLength!=rr.byteLength||$n.byteOffset!=rr.byteOffset)return!1;$n=$n.buffer,rr=rr.buffer;case"[object ArrayBuffer]":return!($n.byteLength!=rr.byteLength||!Mo(new Y($n),new Y(rr)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ve(+$n,+rr);case"[object Error]":return $n.name==rr.name&&$n.message==rr.message;case"[object RegExp]":case"[object String]":return $n==rr+"";case r:var Br=U;case l:var ys=2&Xr;if(Br||(Br=G),$n.size!=rr.size&&!ys)return!1;var Ti=di.get($n);if(Ti)return Ti==rr;Xr|=1,di.set($n,rr);var ro=cr(Br($n),Br(rr),Mo,Lr,Xr,di);return di.delete($n),ro;case"[object Symbol]":if(Me)return Me.call($n)==Me.call(rr)}return!1}(Ie,Ge,ur,mn,In,Wn,vn);if(!(2&Wn)){var Wi=Ur&&ut.call(Ie,"__wrapped__"),ar=qr&&ut.call(Ge,"__wrapped__");if(Wi||ar){var no=Wi?Ie.value():Ie,ts=ar?Ge.value():Ge;return vn||(vn=new le),mn(no,ts,In,Wn,vn)}}return Ei?(vn||(vn=new le),function($n,rr,ii,Mo,Lr,Xr){var di=2&Lr,Br=en($n),ys=Br.length,Ti=en(rr).length;if(ys!=Ti&&!di)return!1;for(var ro=ys;ro--;){var zi=Br[ro];if(!(di?zi in rr:ut.call(rr,zi)))return!1}var ih=Xr.get($n);if(ih&&Xr.get(rr))return ih==rr;var Ci=!0;Xr.set($n,rr),Xr.set(rr,$n);for(var hc=di;++ro<ys;){zi=Br[ro];var wa=$n[zi],yi=rr[zi];if(Mo)var Ma=di?Mo(yi,wa,zi,rr,$n,Xr):Mo(wa,yi,zi,$n,rr,Xr);if(!(Ma===void 0?wa===yi||ii(wa,yi,Mo,Lr,Xr):Ma)){Ci=!1;break}hc||(hc=zi=="constructor")}if(Ci&&!hc){var io=$n.constructor,Vs=rr.constructor;io==Vs||!("constructor"in $n)||!("constructor"in rr)||typeof io=="function"&&io instanceof io&&typeof Vs=="function"&&Vs instanceof Vs||(Ci=!1)}return Xr.delete($n),Xr.delete(rr),Ci}(Ie,Ge,mn,In,Wn,vn)):!1}(qt,ye,Tn,pe,Te,We))}function Sn(qt){return!(!ee(qt)||function(ye){return!!nt&&nt in ye}(qt))&&(Tt(qt)||J(qt)?Q:v).test(zt(qt))}function On(qt){return typeof qt=="function"?qt:qt==null?gn:typeof qt=="object"?Ee(qt)?function(Te,We){return St(Te)&&Rt(We)?jt(It(Te),We):function(Ie){var Ge=function(mn,In,Wn){var vn=mn==null?void 0:ln(mn,In);return vn===void 0?Wn:vn}(Ie,Te);return Ge===void 0&&Ge===We?function(mn,In){return mn!=null&&function(Wn,vn,jn){vn=St(vn,Wn)?[vn]:Pn(vn);for(var Xn,ur=-1,wr=vn.length;++ur<wr;){var Ur=It(vn[ur]);if(!(Xn=Wn!=null&&jn(Wn,Ur)))break;Wn=Wn[Ur]}return Xn||!!(wr=Wn?Wn.length:0)&&Lt(wr)&&Wt(Ur,wr)&&(Ee(Wn)||Xe(Wn))}(mn,In,Hn)}(Ie,Te):Tn(We,Ge,void 0,3)}}(qt[0],qt[1]):function(Te){var We=function(Ie){for(var Ge=en(Ie),mn=Ge.length;mn--;){var In=Ge[mn],Wn=Ie[In];Ge[mn]=[In,Wn,Rt(Wn)]}return Ge}(Te);return We.length==1&&We[0][2]?jt(We[0][0],We[0][1]):function(Ie){return Ie===Te||function(Ge,mn,In,Wn){var vn=In.length,jn=vn,Xn=!Wn;if(Ge==null)return!jn;for(Ge=Object(Ge);vn--;){var ur=In[vn];if(Xn&&ur[2]?ur[1]!==Ge[ur[0]]:!(ur[0]in Ge))return!1}for(;++vn<jn;){var wr=(ur=In[vn])[0],Ur=Ge[wr],qr=ur[1];if(Xn&&ur[2]){if(Ur===void 0&&!(wr in Ge))return!1}else{var Ei=new le;if(Wn)var Wi=Wn(Ur,qr,wr,Ge,mn,Ei);if(!(Wi===void 0?Tn(qr,Ur,Wn,3,Ei):Wi))return!1}}return!0}(Ie,Te,We)}}(qt):St(ye=qt)?(pe=It(ye),function(Te){return Te==null?void 0:Te[pe]}):function(Te){return function(We){return ln(We,Te)}}(ye);var ye,pe}function qn(qt){if(pe=(ye=qt)&&ye.constructor,Te=typeof pe=="function"&&pe.prototype||q,ye!==Te)return ft(qt);var ye,pe,Te,We=[];for(var Ie in Object(qt))ut.call(qt,Ie)&&Ie!="constructor"&&We.push(Ie);return We}function Pn(qt){return Ee(qt)?qt:Xt(qt)}function cr(qt,ye,pe,Te,We,Ie){var Ge=2&We,mn=qt.length,In=ye.length;if(mn!=In&&!(Ge&&In>mn))return!1;var Wn=Ie.get(qt);if(Wn&&Ie.get(ye))return Wn==ye;var vn=-1,jn=!0,Xn=1&We?new Ye:void 0;for(Ie.set(qt,ye),Ie.set(ye,qt);++vn<mn;){var ur=qt[vn],wr=ye[vn];if(Te)var Ur=Ge?Te(wr,ur,vn,ye,qt,Ie):Te(ur,wr,vn,qt,ye,Ie);if(Ur!==void 0){if(Ur)continue;jn=!1;break}if(Xn){if(!rt(ye,function(qr,Ei){if(!Xn.has(Ei)&&(ur===qr||pe(ur,qr,Te,We,Ie)))return Xn.add(Ei)})){jn=!1;break}}else if(ur!==wr&&!pe(ur,wr,Te,We,Ie)){jn=!1;break}}return Ie.delete(qt),Ie.delete(ye),jn}function Yn(qt,ye){var pe,Te,We=qt.__data__;return((Te=typeof(pe=ye))=="string"||Te=="number"||Te=="symbol"||Te=="boolean"?pe!=="__proto__":pe===null)?We[typeof ye=="string"?"string":"hash"]:We.map}function zn(qt,ye){var pe=function(Te,We){return Te==null?void 0:Te[We]}(qt,ye);return Sn(pe)?pe:void 0}var Qn=function(qt){return vt.call(qt)};function Wt(qt,ye){return!!(ye=ye==null?9007199254740991:ye)&&(typeof qt=="number"||x.test(qt))&&qt>-1&&qt%1==0&&qt<ye}function St(qt,ye){if(Ee(qt))return!1;var pe=typeof qt;return!(pe!="number"&&pe!="symbol"&&pe!="boolean"&&qt!=null&&!Ve(qt))||f.test(qt)||!h.test(qt)||ye!=null&&qt in Object(ye)}function Rt(qt){return qt==qt&&!ee(qt)}function jt(qt,ye){return function(pe){return pe!=null&&pe[qt]===ye&&(ye!==void 0||qt in Object(pe))}}(wt&&Qn(new wt(new ArrayBuffer(1)))!="[object DataView]"||_t&&Qn(new _t)!=r||Dt&&Qn(Dt.resolve())!="[object Promise]"||Gt&&Qn(new Gt)!=l||te&&Qn(new te)!="[object WeakMap]")&&(Qn=function(qt){var ye=vt.call(qt),pe=ye==u?qt.constructor:void 0,Te=pe?zt(pe):void 0;if(Te)switch(Te){case At:return"[object DataView]";case Ot:return r;case Zt:return"[object Promise]";case he:return l;case fe:return"[object WeakMap]"}return ye});var Xt=me(function(qt){var ye;qt=(ye=qt)==null?"":function(Te){if(typeof Te=="string")return Te;if(Ve(Te))return Pe?Pe.call(Te):"";var We=Te+"";return We=="0"&&1/Te==-1/0?"-0":We}(ye);var pe=[];return d.test(qt)&&pe.push(""),qt.replace(p,function(Te,We,Ie,Ge){pe.push(Ie?Ge.replace(b,"$1"):We||Te)}),pe});function It(qt){if(typeof qt=="string"||Ve(qt))return qt;var ye=qt+"";return ye=="0"&&1/qt==-1/0?"-0":ye}function zt(qt){if(qt!=null){try{return lt.call(qt)}catch(ye){}try{return qt+""}catch(ye){}}return""}var Kt,Qt=(Kt=function(qt,ye,pe){ut.call(qt,pe)?qt[pe].push(ye):qt[pe]=[ye]},function(qt,ye){var pe=Ee(qt)?tt:Ze,Te={};return pe(qt,Kt,On(ye),Te)});function me(qt,ye){if(typeof qt!="function"||ye&&typeof ye!="function")throw new TypeError("Expected a function");var pe=function(){var Te=arguments,We=ye?ye.apply(this,Te):Te[0],Ie=pe.cache;if(Ie.has(We))return Ie.get(We);var Ge=qt.apply(this,Te);return pe.cache=Ie.set(We,Ge),Ge};return pe.cache=new(me.Cache||Le),pe}function ve(qt,ye){return qt===ye||qt!=qt&&ye!=ye}function Xe(qt){return function(ye){return Yt(ye)&&$e(ye)}(qt)&&ut.call(qt,"callee")&&(!H.call(qt,"callee")||vt.call(qt)==o)}me.Cache=Le;var Ee=Array.isArray;function $e(qt){return qt!=null&&Lt(qt.length)&&!Tt(qt)}function Tt(qt){var ye=ee(qt)?vt.call(qt):"";return ye=="[object Function]"||ye=="[object GeneratorFunction]"}function Lt(qt){return typeof qt=="number"&&qt>-1&&qt%1==0&&qt<=9007199254740991}function ee(qt){var ye=typeof qt;return!!qt&&(ye=="object"||ye=="function")}function Yt(qt){return!!qt&&typeof qt=="object"}function Ve(qt){return typeof qt=="symbol"||Yt(qt)&&vt.call(qt)=="[object Symbol]"}var Ue=Z?function(qt){return function(ye){return qt(ye)}}(Z):function(qt){return Yt(qt)&&Lt(qt.length)&&!!w[vt.call(qt)]};function en(qt){return $e(qt)?Fe(qt):qn(qt)}function gn(qt){return qt}i.exports=Qt}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],444:[function(e,i,s){var a=Object.prototype.toString;i.exports=function(o){return o===!0||o===!1||function(r){return!!r&&typeof r=="object"}(o)&&a.call(o)=="[object Boolean]"}},{}],445:[function(e,i,s){(function(a){(function(){var o="[object Arguments]",r="[object Map]",u="[object Object]",l="[object Set]",h=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[o]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[r]=d["[object Number]"]=d[u]=d["[object RegExp]"]=d[l]=d["[object String]"]=d["[object WeakMap]"]=!1;var p=typeof a=="object"&&a&&a.Object===Object&&a,b=typeof self=="object"&&self&&self.Object===Object&&self,v=p||b||Function("return this")(),x=typeof s=="object"&&s&&!s.nodeType&&s,w=x&&typeof i=="object"&&i&&!i.nodeType&&i,M=w&&w.exports===x,E=M&&p.process,D=function(){try{return E&&E.binding&&E.binding("util")}catch(It){}}(),N=D&&D.isTypedArray;function V(It,zt){for(var Kt=-1,Qt=It==null?0:It.length;++Kt<Qt;)if(zt(It[Kt],Kt,It))return!0;return!1}function K(It){var zt=-1,Kt=Array(It.size);return It.forEach(function(Qt,me){Kt[++zt]=[me,Qt]}),Kt}function j(It){var zt=-1,Kt=Array(It.size);return It.forEach(function(Qt){Kt[++zt]=Qt}),Kt}var Z,tt,rt,J=Array.prototype,U=Function.prototype,G=Object.prototype,I=v["__core-js_shared__"],C=U.toString,L=G.hasOwnProperty,B=(Z=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+Z:"",O=G.toString,q=RegExp("^"+C.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),it=M?v.Buffer:void 0,nt=v.Symbol,lt=v.Uint8Array,ut=G.propertyIsEnumerable,vt=J.splice,Q=nt?nt.toStringTag:void 0,gt=Object.getOwnPropertySymbols,Y=it?it.isBuffer:void 0,H=(tt=Object.keys,rt=Object,function(It){return tt(rt(It))}),at=Hn(v,"DataView"),ft=Hn(v,"Map"),wt=Hn(v,"Promise"),_t=Hn(v,"Set"),Dt=Hn(v,"WeakMap"),Gt=Hn(Object,"create"),te=qn(at),mt=qn(ft),At=qn(wt),Ot=qn(_t),Zt=qn(Dt),he=nt?nt.prototype:void 0,fe=he?he.valueOf:void 0;function be(It){var zt=-1,Kt=It==null?0:It.length;for(this.clear();++zt<Kt;){var Qt=It[zt];this.set(Qt[0],Qt[1])}}function Me(It){var zt=-1,Kt=It==null?0:It.length;for(this.clear();++zt<Kt;){var Qt=It[zt];this.set(Qt[0],Qt[1])}}function Pe(It){var zt=-1,Kt=It==null?0:It.length;for(this.clear();++zt<Kt;){var Qt=It[zt];this.set(Qt[0],Qt[1])}}function ze(It){var zt=-1,Kt=It==null?0:It.length;for(this.__data__=new Pe;++zt<Kt;)this.add(It[zt])}function Ce(It){var zt=this.__data__=new Me(It);this.size=zt.size}function Le(It,zt){var Kt=Yn(It),Qt=!Kt&&cr(It),me=!Kt&&!Qt&&zn(It),ve=!Kt&&!Qt&&!me&&jt(It),Xe=Kt||Qt||me||ve,Ee=Xe?function(Lt,ee){for(var Yt=-1,Ve=Array(Lt);++Yt<Lt;)Ve[Yt]=ee(Yt);return Ve}(It.length,String):[],$e=Ee.length;for(var Tt in It)!zt&&!L.call(It,Tt)||Xe&&(Tt=="length"||me&&(Tt=="offset"||Tt=="parent")||ve&&(Tt=="buffer"||Tt=="byteLength"||Tt=="byteOffset")||On(Tt,$e))||Ee.push(Tt);return Ee}function Ye(It,zt){for(var Kt=It.length;Kt--;)if(Pn(It[Kt][0],zt))return Kt;return-1}function le(It){return It==null?It===void 0?"[object Undefined]":"[object Null]":Q&&Q in Object(It)?function(zt){var Kt=L.call(zt,Q),Qt=zt[Q];try{zt[Q]=void 0;var me=!0}catch(Xe){}var ve=O.call(zt);return me&&(Kt?zt[Q]=Qt:delete zt[Q]),ve}(It):function(zt){return O.call(zt)}(It)}function Fe(It){return Rt(It)&&le(It)==o}function Ke(It,zt,Kt,Qt,me){return It===zt||(It==null||zt==null||!Rt(It)&&!Rt(zt)?It!=It&&zt!=zt:function(ve,Xe,Ee,$e,Tt,Lt){var ee=Yn(ve),Yt=Yn(Xe),Ve=ee?"[object Array]":Sn(ve),Ue=Yt?"[object Array]":Sn(Xe),en=(Ve=Ve==o?u:Ve)==u,gn=(Ue=Ue==o?u:Ue)==u,qt=Ve==Ue;if(qt&&zn(ve)){if(!zn(Xe))return!1;ee=!0,en=!1}if(qt&&!en)return Lt||(Lt=new Ce),ee||jt(ve)?Qe(ve,Xe,Ee,$e,Tt,Lt):function(Ie,Ge,mn,In,Wn,vn,jn){switch(mn){case"[object DataView]":if(Ie.byteLength!=Ge.byteLength||Ie.byteOffset!=Ge.byteOffset)return!1;Ie=Ie.buffer,Ge=Ge.buffer;case"[object ArrayBuffer]":return!(Ie.byteLength!=Ge.byteLength||!vn(new lt(Ie),new lt(Ge)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Pn(+Ie,+Ge);case"[object Error]":return Ie.name==Ge.name&&Ie.message==Ge.message;case"[object RegExp]":case"[object String]":return Ie==Ge+"";case r:var Xn=K;case l:var ur=1&In;if(Xn||(Xn=j),Ie.size!=Ge.size&&!ur)return!1;var wr=jn.get(Ie);if(wr)return wr==Ge;In|=2,jn.set(Ie,Ge);var Ur=Qe(Xn(Ie),Xn(Ge),In,Wn,vn,jn);return jn.delete(Ie),Ur;case"[object Symbol]":if(fe)return fe.call(Ie)==fe.call(Ge)}return!1}(ve,Xe,Ve,Ee,$e,Tt,Lt);if(!(1&Ee)){var ye=en&&L.call(ve,"__wrapped__"),pe=gn&&L.call(Xe,"__wrapped__");if(ye||pe){var Te=ye?ve.value():ve,We=pe?Xe.value():Xe;return Lt||(Lt=new Ce),Tt(Te,We,Ee,$e,Lt)}}return qt?(Lt||(Lt=new Ce),function(Ie,Ge,mn,In,Wn,vn){var jn=1&mn,Xn=hn(Ie),ur=Xn.length,wr=hn(Ge).length;if(ur!=wr&&!jn)return!1;for(var Ur=ur;Ur--;){var qr=Xn[Ur];if(!(jn?qr in Ge:L.call(Ge,qr)))return!1}var Ei=vn.get(Ie);if(Ei&&vn.get(Ge))return Ei==Ge;var Wi=!0;vn.set(Ie,Ge),vn.set(Ge,Ie);for(var ar=jn;++Ur<ur;){qr=Xn[Ur];var no=Ie[qr],ts=Ge[qr];if(In)var $n=jn?In(ts,no,qr,Ge,Ie,vn):In(no,ts,qr,Ie,Ge,vn);if(!($n===void 0?no===ts||Wn(no,ts,mn,In,vn):$n)){Wi=!1;break}ar||(ar=qr=="constructor")}if(Wi&&!ar){var rr=Ie.constructor,ii=Ge.constructor;rr==ii||!("constructor"in Ie)||!("constructor"in Ge)||typeof rr=="function"&&rr instanceof rr&&typeof ii=="function"&&ii instanceof ii||(Wi=!1)}return vn.delete(Ie),vn.delete(Ge),Wi}(ve,Xe,Ee,$e,Tt,Lt)):!1}(It,zt,Kt,Qt,Ke,me))}function Ze(It){return!(!St(It)||function(zt){return!!B&&B in zt}(It))&&(Qn(It)?q:h).test(qn(It))}function ke(It){if(Kt=(zt=It)&&zt.constructor,Qt=typeof Kt=="function"&&Kt.prototype||G,zt!==Qt)return H(It);var zt,Kt,Qt,me=[];for(var ve in Object(It))L.call(It,ve)&&ve!="constructor"&&me.push(ve);return me}function Qe(It,zt,Kt,Qt,me,ve){var Xe=1&Kt,Ee=It.length,$e=zt.length;if(Ee!=$e&&!(Xe&&$e>Ee))return!1;var Tt=ve.get(It);if(Tt&&ve.get(zt))return Tt==zt;var Lt=-1,ee=!0,Yt=2&Kt?new ze:void 0;for(ve.set(It,zt),ve.set(zt,It);++Lt<Ee;){var Ve=It[Lt],Ue=zt[Lt];if(Qt)var en=Xe?Qt(Ue,Ve,Lt,zt,It,ve):Qt(Ve,Ue,Lt,It,zt,ve);if(en!==void 0){if(en)continue;ee=!1;break}if(Yt){if(!V(zt,function(gn,qt){if(ye=qt,!Yt.has(ye)&&(Ve===gn||me(Ve,gn,Kt,Qt,ve)))return Yt.push(qt);var ye})){ee=!1;break}}else if(Ve!==Ue&&!me(Ve,Ue,Kt,Qt,ve)){ee=!1;break}}return ve.delete(It),ve.delete(zt),ee}function hn(It){return function(zt,Kt,Qt){var me=Kt(zt);return Yn(zt)?me:function(ve,Xe){for(var Ee=-1,$e=Xe.length,Tt=ve.length;++Ee<$e;)ve[Tt+Ee]=Xe[Ee];return ve}(me,Qt(zt))}(It,Xt,Tn)}function ln(It,zt){var Kt,Qt,me=It.__data__;return((Qt=typeof(Kt=zt))=="string"||Qt=="number"||Qt=="symbol"||Qt=="boolean"?Kt!=="__proto__":Kt===null)?me[typeof zt=="string"?"string":"hash"]:me.map}function Hn(It,zt){var Kt=function(Qt,me){return Qt==null?void 0:Qt[me]}(It,zt);return Ze(Kt)?Kt:void 0}be.prototype.clear=function(){this.__data__=Gt?Gt(null):{},this.size=0},be.prototype.delete=function(It){var zt=this.has(It)&&delete this.__data__[It];return this.size-=zt?1:0,zt},be.prototype.get=function(It){var zt=this.__data__;if(Gt){var Kt=zt[It];return Kt==="__lodash_hash_undefined__"?void 0:Kt}return L.call(zt,It)?zt[It]:void 0},be.prototype.has=function(It){var zt=this.__data__;return Gt?zt[It]!==void 0:L.call(zt,It)},be.prototype.set=function(It,zt){var Kt=this.__data__;return this.size+=this.has(It)?0:1,Kt[It]=Gt&&zt===void 0?"__lodash_hash_undefined__":zt,this},Me.prototype.clear=function(){this.__data__=[],this.size=0},Me.prototype.delete=function(It){var zt=this.__data__,Kt=Ye(zt,It);return!(Kt<0)&&(Kt==zt.length-1?zt.pop():vt.call(zt,Kt,1),--this.size,!0)},Me.prototype.get=function(It){var zt=this.__data__,Kt=Ye(zt,It);return Kt<0?void 0:zt[Kt][1]},Me.prototype.has=function(It){return Ye(this.__data__,It)>-1},Me.prototype.set=function(It,zt){var Kt=this.__data__,Qt=Ye(Kt,It);return Qt<0?(++this.size,Kt.push([It,zt])):Kt[Qt][1]=zt,this},Pe.prototype.clear=function(){this.size=0,this.__data__={hash:new be,map:new(ft||Me),string:new be}},Pe.prototype.delete=function(It){var zt=ln(this,It).delete(It);return this.size-=zt?1:0,zt},Pe.prototype.get=function(It){return ln(this,It).get(It)},Pe.prototype.has=function(It){return ln(this,It).has(It)},Pe.prototype.set=function(It,zt){var Kt=ln(this,It),Qt=Kt.size;return Kt.set(It,zt),this.size+=Kt.size==Qt?0:1,this},ze.prototype.add=ze.prototype.push=function(It){return this.__data__.set(It,"__lodash_hash_undefined__"),this},ze.prototype.has=function(It){return this.__data__.has(It)},Ce.prototype.clear=function(){this.__data__=new Me,this.size=0},Ce.prototype.delete=function(It){var zt=this.__data__,Kt=zt.delete(It);return this.size=zt.size,Kt},Ce.prototype.get=function(It){return this.__data__.get(It)},Ce.prototype.has=function(It){return this.__data__.has(It)},Ce.prototype.set=function(It,zt){var Kt=this.__data__;if(Kt instanceof Me){var Qt=Kt.__data__;if(!ft||Qt.length<199)return Qt.push([It,zt]),this.size=++Kt.size,this;Kt=this.__data__=new Pe(Qt)}return Kt.set(It,zt),this.size=Kt.size,this};var Tn=gt?function(It){return It==null?[]:(It=Object(It),function(zt,Kt){for(var Qt=-1,me=zt==null?0:zt.length,ve=0,Xe=[];++Qt<me;){var Ee=zt[Qt];Kt(Ee,Qt,zt)&&(Xe[ve++]=Ee)}return Xe}(gt(It),function(zt){return ut.call(It,zt)}))}:function(){return[]},Sn=le;function On(It,zt){return!!(zt=zt==null?9007199254740991:zt)&&(typeof It=="number"||f.test(It))&&It>-1&&It%1==0&&It<zt}function qn(It){if(It!=null){try{return C.call(It)}catch(zt){}try{return It+""}catch(zt){}}return""}function Pn(It,zt){return It===zt||It!=It&&zt!=zt}(at&&Sn(new at(new ArrayBuffer(1)))!="[object DataView]"||ft&&Sn(new ft)!=r||wt&&Sn(wt.resolve())!="[object Promise]"||_t&&Sn(new _t)!=l||Dt&&Sn(new Dt)!="[object WeakMap]")&&(Sn=function(It){var zt=le(It),Kt=zt==u?It.constructor:void 0,Qt=Kt?qn(Kt):"";if(Qt)switch(Qt){case te:return"[object DataView]";case mt:return r;case At:return"[object Promise]";case Ot:return l;case Zt:return"[object WeakMap]"}return zt});var cr=Fe(function(){return arguments}())?Fe:function(It){return Rt(It)&&L.call(It,"callee")&&!ut.call(It,"callee")},Yn=Array.isArray,zn=Y||function(){return!1};function Qn(It){if(!St(It))return!1;var zt=le(It);return zt=="[object Function]"||zt=="[object GeneratorFunction]"||zt=="[object AsyncFunction]"||zt=="[object Proxy]"}function Wt(It){return typeof It=="number"&&It>-1&&It%1==0&&It<=9007199254740991}function St(It){var zt=typeof It;return It!=null&&(zt=="object"||zt=="function")}function Rt(It){return It!=null&&typeof It=="object"}var jt=N?function(It){return function(zt){return It(zt)}}(N):function(It){return Rt(It)&&Wt(It.length)&&!!d[le(It)]};function Xt(It){return(zt=It)!=null&&Wt(zt.length)&&!Qn(zt)?Le(It):ke(It);var zt}i.exports=function(It,zt){return Ke(It,zt)}}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],446:[function(e,i,s){(function(a){(function(){var o=typeof a=="object"&&a&&a.Object===Object&&a,r=typeof self=="object"&&self&&self.Object===Object&&self,u=o||r||Function("return this")(),l=Object.prototype,h=l.hasOwnProperty,f=l.toString,d=u.Symbol,p=d?d.toStringTag:void 0;function b(v){return v==null?v===void 0?"[object Undefined]":"[object Null]":p&&p in Object(v)?function(x){var w=h.call(x,p),M=x[p];try{x[p]=void 0;var E=!0}catch(N){}var D=f.call(x);return E&&(w?x[p]=M:delete x[p]),D}(v):function(x){return f.call(x)}(v)}i.exports=function(v){if(!function(w){var M=typeof w;return w!=null&&(M=="object"||M=="function")}(v))return!1;var x=b(v);return x=="[object Function]"||x=="[object GeneratorFunction]"||x=="[object AsyncFunction]"||x=="[object Proxy]"}}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],447:[function(e,i,s){i.exports=function(a){return a==null}},{}],448:[function(e,i,s){i.exports=function(a){return a===void 0}},{}],449:[function(e,i,s){(function(a){(function(){var o=/^\[object .+?Constructor\]$/,r=typeof a=="object"&&a&&a.Object===Object&&a,u=typeof self=="object"&&self&&self.Object===Object&&self,l=r||u||Function("return this")();function h(lt,ut){return!!(lt&&lt.length)&&function(vt,Q,gt){if(Q!=Q)return function(at,ft,wt,_t){for(var Dt=at.length,Gt=wt+(_t?1:-1);_t?Gt--:++Gt<Dt;)if(ft(at[Gt],Gt,at))return Gt;return-1}(vt,d,gt);for(var Y=gt-1,H=vt.length;++Y<H;)if(vt[Y]===Q)return Y;return-1}(lt,ut,0)>-1}function f(lt,ut,vt){for(var Q=-1,gt=lt?lt.length:0;++Q<gt;)if(vt(ut,lt[Q]))return!0;return!1}function d(lt){return lt!=lt}function p(lt,ut){return lt.has(ut)}function b(lt){var ut=-1,vt=Array(lt.size);return lt.forEach(function(Q){vt[++ut]=Q}),vt}var v,x=Array.prototype,w=Function.prototype,M=Object.prototype,E=l["__core-js_shared__"],D=(v=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",N=w.toString,V=M.hasOwnProperty,K=M.toString,j=RegExp("^"+N.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Z=x.splice,tt=it(l,"Map"),rt=it(l,"Set"),J=it(Object,"create");function U(lt){var ut=-1,vt=lt?lt.length:0;for(this.clear();++ut<vt;){var Q=lt[ut];this.set(Q[0],Q[1])}}function G(lt){var ut=-1,vt=lt?lt.length:0;for(this.clear();++ut<vt;){var Q=lt[ut];this.set(Q[0],Q[1])}}function I(lt){var ut=-1,vt=lt?lt.length:0;for(this.clear();++ut<vt;){var Q=lt[ut];this.set(Q[0],Q[1])}}function C(lt){var ut=-1,vt=lt?lt.length:0;for(this.__data__=new I;++ut<vt;)this.add(lt[ut])}function L(lt,ut){for(var vt,Q,gt=lt.length;gt--;)if((vt=lt[gt][0])===(Q=ut)||vt!=vt&&Q!=Q)return gt;return-1}function B(lt){return!(!nt(lt)||(ut=lt,D&&D in ut))&&(function(vt){var Q=nt(vt)?K.call(vt):"";return Q=="[object Function]"||Q=="[object GeneratorFunction]"}(lt)||function(vt){var Q=!1;if(vt!=null&&typeof vt.toString!="function")try{Q=!!(vt+"")}catch(gt){}return Q}(lt)?j:o).test(function(vt){if(vt!=null){try{return N.call(vt)}catch(Q){}try{return vt+""}catch(Q){}}return""}(lt));var ut}U.prototype.clear=function(){this.__data__=J?J(null):{}},U.prototype.delete=function(lt){return this.has(lt)&&delete this.__data__[lt]},U.prototype.get=function(lt){var ut=this.__data__;if(J){var vt=ut[lt];return vt==="__lodash_hash_undefined__"?void 0:vt}return V.call(ut,lt)?ut[lt]:void 0},U.prototype.has=function(lt){var ut=this.__data__;return J?ut[lt]!==void 0:V.call(ut,lt)},U.prototype.set=function(lt,ut){return this.__data__[lt]=J&&ut===void 0?"__lodash_hash_undefined__":ut,this},G.prototype.clear=function(){this.__data__=[]},G.prototype.delete=function(lt){var ut=this.__data__,vt=L(ut,lt);return!(vt<0)&&(vt==ut.length-1?ut.pop():Z.call(ut,vt,1),!0)},G.prototype.get=function(lt){var ut=this.__data__,vt=L(ut,lt);return vt<0?void 0:ut[vt][1]},G.prototype.has=function(lt){return L(this.__data__,lt)>-1},G.prototype.set=function(lt,ut){var vt=this.__data__,Q=L(vt,lt);return Q<0?vt.push([lt,ut]):vt[Q][1]=ut,this},I.prototype.clear=function(){this.__data__={hash:new U,map:new(tt||G),string:new U}},I.prototype.delete=function(lt){return q(this,lt).delete(lt)},I.prototype.get=function(lt){return q(this,lt).get(lt)},I.prototype.has=function(lt){return q(this,lt).has(lt)},I.prototype.set=function(lt,ut){return q(this,lt).set(lt,ut),this},C.prototype.add=C.prototype.push=function(lt){return this.__data__.set(lt,"__lodash_hash_undefined__"),this},C.prototype.has=function(lt){return this.__data__.has(lt)};var O=rt&&1/b(new rt([,-0]))[1]==1/0?function(lt){return new rt(lt)}:function(){};function q(lt,ut){var vt,Q,gt=lt.__data__;return((Q=typeof(vt=ut))=="string"||Q=="number"||Q=="symbol"||Q=="boolean"?vt!=="__proto__":vt===null)?gt[typeof ut=="string"?"string":"hash"]:gt.map}function it(lt,ut){var vt=function(Q,gt){return Q==null?void 0:Q[gt]}(lt,ut);return B(vt)?vt:void 0}function nt(lt){var ut=typeof lt;return!!lt&&(ut=="object"||ut=="function")}i.exports=function(lt){return lt&&lt.length?function(ut,vt,Q){var gt=-1,Y=h,H=ut.length,at=!0,ft=[],wt=ft;if(Q)at=!1,Y=f;else if(H>=200){var _t=vt?null:O(ut);if(_t)return b(_t);at=!1,Y=p,wt=new C}else wt=vt?[]:ft;t:for(;++gt<H;){var Dt=ut[gt],Gt=vt?vt(Dt):Dt;if(Dt=Q||Dt!==0?Dt:0,at&&Gt==Gt){for(var te=wt.length;te--;)if(wt[te]===Gt)continue t;vt&&wt.push(Gt),ft.push(Dt)}else Y(wt,Gt,Q)||(wt!==ft&&wt.push(Gt),ft.push(Dt))}return ft}(lt):[]}}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],450:[function(e,i,s){var a=e("inherits"),o=e("hash-base"),r=e("safe-buffer").Buffer,u=new Array(16);function l(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function h(v,x){return v<<x|v>>>32-x}function f(v,x,w,M,E,D,N){return h(v+(x&w|~x&M)+E+D|0,N)+x|0}function d(v,x,w,M,E,D,N){return h(v+(x&M|w&~M)+E+D|0,N)+x|0}function p(v,x,w,M,E,D,N){return h(v+(x^w^M)+E+D|0,N)+x|0}function b(v,x,w,M,E,D,N){return h(v+(w^(x|~M))+E+D|0,N)+x|0}a(l,o),l.prototype._update=function(){for(var v=u,x=0;x<16;++x)v[x]=this._block.readInt32LE(4*x);var w=this._a,M=this._b,E=this._c,D=this._d;w=f(w,M,E,D,v[0],3614090360,7),D=f(D,w,M,E,v[1],3905402710,12),E=f(E,D,w,M,v[2],606105819,17),M=f(M,E,D,w,v[3],3250441966,22),w=f(w,M,E,D,v[4],4118548399,7),D=f(D,w,M,E,v[5],1200080426,12),E=f(E,D,w,M,v[6],2821735955,17),M=f(M,E,D,w,v[7],4249261313,22),w=f(w,M,E,D,v[8],1770035416,7),D=f(D,w,M,E,v[9],2336552879,12),E=f(E,D,w,M,v[10],4294925233,17),M=f(M,E,D,w,v[11],2304563134,22),w=f(w,M,E,D,v[12],1804603682,7),D=f(D,w,M,E,v[13],4254626195,12),E=f(E,D,w,M,v[14],2792965006,17),w=d(w,M=f(M,E,D,w,v[15],1236535329,22),E,D,v[1],4129170786,5),D=d(D,w,M,E,v[6],3225465664,9),E=d(E,D,w,M,v[11],643717713,14),M=d(M,E,D,w,v[0],3921069994,20),w=d(w,M,E,D,v[5],3593408605,5),D=d(D,w,M,E,v[10],38016083,9),E=d(E,D,w,M,v[15],3634488961,14),M=d(M,E,D,w,v[4],3889429448,20),w=d(w,M,E,D,v[9],568446438,5),D=d(D,w,M,E,v[14],3275163606,9),E=d(E,D,w,M,v[3],4107603335,14),M=d(M,E,D,w,v[8],1163531501,20),w=d(w,M,E,D,v[13],2850285829,5),D=d(D,w,M,E,v[2],4243563512,9),E=d(E,D,w,M,v[7],1735328473,14),w=p(w,M=d(M,E,D,w,v[12],2368359562,20),E,D,v[5],4294588738,4),D=p(D,w,M,E,v[8],2272392833,11),E=p(E,D,w,M,v[11],1839030562,16),M=p(M,E,D,w,v[14],4259657740,23),w=p(w,M,E,D,v[1],2763975236,4),D=p(D,w,M,E,v[4],1272893353,11),E=p(E,D,w,M,v[7],4139469664,16),M=p(M,E,D,w,v[10],3200236656,23),w=p(w,M,E,D,v[13],681279174,4),D=p(D,w,M,E,v[0],3936430074,11),E=p(E,D,w,M,v[3],3572445317,16),M=p(M,E,D,w,v[6],76029189,23),w=p(w,M,E,D,v[9],3654602809,4),D=p(D,w,M,E,v[12],3873151461,11),E=p(E,D,w,M,v[15],530742520,16),w=b(w,M=p(M,E,D,w,v[2],3299628645,23),E,D,v[0],4096336452,6),D=b(D,w,M,E,v[7],1126891415,10),E=b(E,D,w,M,v[14],2878612391,15),M=b(M,E,D,w,v[5],4237533241,21),w=b(w,M,E,D,v[12],1700485571,6),D=b(D,w,M,E,v[3],2399980690,10),E=b(E,D,w,M,v[10],4293915773,15),M=b(M,E,D,w,v[1],2240044497,21),w=b(w,M,E,D,v[8],1873313359,6),D=b(D,w,M,E,v[15],4264355552,10),E=b(E,D,w,M,v[6],2734768916,15),M=b(M,E,D,w,v[13],1309151649,21),w=b(w,M,E,D,v[4],4149444226,6),D=b(D,w,M,E,v[11],3174756917,10),E=b(E,D,w,M,v[2],718787259,15),M=b(M,E,D,w,v[9],3951481745,21),this._a=this._a+w|0,this._b=this._b+M|0,this._c=this._c+E|0,this._d=this._d+D|0},l.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var v=r.allocUnsafe(16);return v.writeInt32LE(this._a,0),v.writeInt32LE(this._b,4),v.writeInt32LE(this._c,8),v.writeInt32LE(this._d,12),v},i.exports=l},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,i,s){var a=e("bn.js"),o=e("brorand");function r(u){this.rand=u||new o.Rand}i.exports=r,r.create=function(u){return new r(u)},r.prototype._randbelow=function(u){var l=u.bitLength(),h=Math.ceil(l/8);do var f=new a(this.rand.generate(h));while(f.cmp(u)>=0);return f},r.prototype._randrange=function(u,l){var h=l.sub(u);return u.add(this._randbelow(h))},r.prototype.test=function(u,l,h){var f=u.bitLength(),d=a.mont(u),p=new a(1).toRed(d);l||(l=Math.max(1,f/48|0));for(var b=u.subn(1),v=0;!b.testn(v);v++);for(var x=u.shrn(v),w=b.toRed(d);l>0;l--){var M=this._randrange(new a(2),b);h&&h(M);var E=M.toRed(d).redPow(x);if(E.cmp(p)!==0&&E.cmp(w)!==0){for(var D=1;D<v;D++){if((E=E.redSqr()).cmp(p)===0)return!1;if(E.cmp(w)===0)break}if(D===v)return!1}}return!0},r.prototype.getDivisor=function(u,l){var h=u.bitLength(),f=a.mont(u),d=new a(1).toRed(f);l||(l=Math.max(1,h/48|0));for(var p=u.subn(1),b=0;!p.testn(b);b++);for(var v=u.shrn(b),x=p.toRed(f);l>0;l--){var w=this._randrange(new a(2),p),M=u.gcd(w);if(M.cmpn(1)!==0)return M;var E=w.toRed(f).redPow(v);if(E.cmp(d)!==0&&E.cmp(x)!==0){for(var D=1;D<b;D++){if((E=E.redSqr()).cmp(d)===0)return E.fromRed().subn(1).gcd(u);if(E.cmp(x)===0)break}if(D===b)return(E=E.redSqr()).fromRed().subn(1).gcd(u)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,i,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],453:[function(e,i,s){function a(o,r){if(!o)throw new Error(r||"Assertion failed")}i.exports=a,a.equal=function(o,r,u){if(o!=r)throw new Error(u||"Assertion failed: "+o+" != "+r)}},{}],454:[function(e,i,s){var a=s;function o(u){return u.length===1?"0"+u:u}function r(u){for(var l="",h=0;h<u.length;h++)l+=o(u[h].toString(16));return l}a.toArray=function(u,l){if(Array.isArray(u))return u.slice();if(!u)return[];var h=[];if(typeof u!="string"){for(var f=0;f<u.length;f++)h[f]=0|u[f];return h}if(l==="hex")for((u=u.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(u="0"+u),f=0;f<u.length;f+=2)h.push(parseInt(u[f]+u[f+1],16));else for(f=0;f<u.length;f++){var d=u.charCodeAt(f),p=d>>8,b=255&d;p?h.push(p,b):h.push(b)}return h},a.zero2=o,a.toHex=r,a.encode=function(u,l){return l==="hex"?r(u):u}},{}],455:[function(e,i,s){i.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,i,s){var a=e("asn1.js");s.certificate=e("./certificate");var o=a.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});s.RSAPrivateKey=o;var r=a.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});s.RSAPublicKey=r;var u=a.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())});s.PublicKey=u;var l=a.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),h=a.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(l),this.key("subjectPrivateKey").octstr())});s.PrivateKey=h;var f=a.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});s.EncryptedPrivateKey=f;var d=a.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});s.DSAPrivateKey=d,s.DSAparam=a.define("DSAparam",function(){this.int()});var p=a.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(b),this.key("publicKey").optional().explicit(1).bitstr())});s.ECPrivateKey=p;var b=a.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});s.signature=a.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,i,s){var a=e("asn1.js"),o=a.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),r=a.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),u=a.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),l=a.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(u),this.key("subjectPublicKey").bitstr())}),h=a.define("RelativeDistinguishedName",function(){this.setof(r)}),f=a.define("RDNSequence",function(){this.seqof(h)}),d=a.define("Name",function(){this.choice({rdnSequence:this.use(f)})}),p=a.define("Validity",function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))}),b=a.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),v=a.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(u),this.key("issuer").use(d),this.key("validity").use(p),this.key("subject").use(d),this.key("subjectPublicKeyInfo").use(l),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(b).optional())}),x=a.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(v),this.key("signatureAlgorithm").use(u),this.key("signatureValue").bitstr())});i.exports=x},{"asn1.js":170}],458:[function(e,i,s){var a=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,u=e("evp_bytestokey"),l=e("browserify-aes"),h=e("safe-buffer").Buffer;i.exports=function(f,d){var p,b=f.toString(),v=b.match(a);if(v){var x="aes"+v[1],w=h.from(v[2],"hex"),M=h.from(v[3].replace(/[\r\n]/g,""),"base64"),E=u(d,w.slice(0,8),parseInt(v[1],10)).key,D=[],N=l.createDecipheriv(x,E,w);D.push(N.update(M)),D.push(N.final()),p=h.concat(D)}else{var V=b.match(r);p=h.from(V[2].replace(/[\r\n]/g,""),"base64")}return{tag:b.match(o)[1],data:p}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,i,s){var a=e("./asn1"),o=e("./aesid.json"),r=e("./fixProc"),u=e("browserify-aes"),l=e("pbkdf2"),h=e("safe-buffer").Buffer;function f(d){var p;typeof d!="object"||h.isBuffer(d)||(p=d.passphrase,d=d.key),typeof d=="string"&&(d=h.from(d));var b,v,x=r(d,p),w=x.tag,M=x.data;switch(w){case"CERTIFICATE":v=a.certificate.decode(M,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(v||(v=a.PublicKey.decode(M,"der")),b=v.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPublicKey.decode(v.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return v.subjectPrivateKey=v.subjectPublicKey,{type:"ec",data:v};case"1.2.840.10040.4.1":return v.algorithm.params.pub_key=a.DSAparam.decode(v.subjectPublicKey.data,"der"),{type:"dsa",data:v.algorithm.params};default:throw new Error("unknown key id "+b)}case"ENCRYPTED PRIVATE KEY":M=function(E,D){var N=E.algorithm.decrypt.kde.kdeparams.salt,V=parseInt(E.algorithm.decrypt.kde.kdeparams.iters.toString(),10),K=o[E.algorithm.decrypt.cipher.algo.join(".")],j=E.algorithm.decrypt.cipher.iv,Z=E.subjectPrivateKey,tt=parseInt(K.split("-")[1],10)/8,rt=l.pbkdf2Sync(D,N,V,tt,"sha1"),J=u.createDecipheriv(K,rt,j),U=[];return U.push(J.update(Z)),U.push(J.final()),h.concat(U)}(M=a.EncryptedPrivateKey.decode(M,"der"),p);case"PRIVATE KEY":switch(b=(v=a.PrivateKey.decode(M,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPrivateKey.decode(v.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:v.algorithm.curve,privateKey:a.ECPrivateKey.decode(v.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return v.algorithm.params.priv_key=a.DSAparam.decode(v.subjectPrivateKey,"der"),{type:"dsa",params:v.algorithm.params};default:throw new Error("unknown key id "+b)}case"RSA PUBLIC KEY":return a.RSAPublicKey.decode(M,"der");case"RSA PRIVATE KEY":return a.RSAPrivateKey.decode(M,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:a.DSAPrivateKey.decode(M,"der")};case"EC PRIVATE KEY":return{curve:(M=a.ECPrivateKey.decode(M,"der")).parameters.value,privateKey:M.privateKey};default:throw new Error("unknown key type "+w)}}i.exports=f,f.signature=a.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,i,s){s.pbkdf2=e("./lib/async"),s.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,i,s){(function(a){(function(){var o,r,u=e("safe-buffer").Buffer,l=e("./precondition"),h=e("./default-encoding"),f=e("./sync"),d=e("./to-buffer"),p=a.crypto&&a.crypto.subtle,b={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},v=[];function x(){return r||(r=a.process&&a.process.nextTick?a.process.nextTick:a.queueMicrotask?a.queueMicrotask:a.setImmediate?a.setImmediate:a.setTimeout)}function w(M,E,D,N,V){return p.importKey("raw",M,{name:"PBKDF2"},!1,["deriveBits"]).then(function(K){return p.deriveBits({name:"PBKDF2",salt:E,iterations:D,hash:{name:V}},K,N<<3)}).then(function(K){return u.from(K)})}i.exports=function(M,E,D,N,V,K){typeof V=="function"&&(K=V,V=void 0);var j=b[(V=V||"sha1").toLowerCase()];if(j&&typeof a.Promise=="function"){if(l(D,N),M=d(M,h,"Password"),E=d(E,h,"Salt"),typeof K!="function")throw new Error("No callback provided to pbkdf2");(function(Z,tt){Z.then(function(rt){x()(function(){tt(null,rt)})},function(rt){x()(function(){tt(rt)})})})(function(Z){if(a.process&&!a.process.browser||!p||!p.importKey||!p.deriveBits)return Promise.resolve(!1);if(v[Z]!==void 0)return v[Z];var tt=w(o=o||u.alloc(8),o,10,128,Z).then(function(){return!0}).catch(function(){return!1});return v[Z]=tt,tt}(j).then(function(Z){return Z?w(M,E,D,N,j):f(M,E,D,N,V)}),K)}else x()(function(){var Z;try{Z=f(M,E,D,N,V)}catch(tt){return K(tt)}K(null,Z)})}}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,i,s){(function(a,o){(function(){var r;o.process&&o.process.browser?r="utf-8":o.process&&o.process.version?r=parseInt(a.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":r="utf-8",i.exports=r}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:467}],463:[function(e,i,s){var a=Math.pow(2,30)-1;i.exports=function(o,r){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof r!="number")throw new TypeError("Key length not a number");if(r<0||r>a||r!=r)throw new TypeError("Bad key length")}},{}],464:[function(e,i,s){var a=e("create-hash/md5"),o=e("ripemd160"),r=e("sha.js"),u=e("safe-buffer").Buffer,l=e("./precondition"),h=e("./default-encoding"),f=e("./to-buffer"),d=u.alloc(128),p={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function b(v,x,w){var M=function(j){function Z(tt){return r(j).update(tt).digest()}return j==="rmd160"||j==="ripemd160"?function(tt){return new o().update(tt).digest()}:j==="md5"?a:Z}(v),E=v==="sha512"||v==="sha384"?128:64;x.length>E?x=M(x):x.length<E&&(x=u.concat([x,d],E));for(var D=u.allocUnsafe(E+p[v]),N=u.allocUnsafe(E+p[v]),V=0;V<E;V++)D[V]=54^x[V],N[V]=92^x[V];var K=u.allocUnsafe(E+w+4);D.copy(K,0,0,E),this.ipad1=K,this.ipad2=D,this.opad=N,this.alg=v,this.blocksize=E,this.hash=M,this.size=p[v]}b.prototype.run=function(v,x){return v.copy(x,this.blocksize),this.hash(x).copy(this.opad,this.blocksize),this.hash(this.opad)},i.exports=function(v,x,w,M,E){l(w,M);var D=new b(E=E||"sha1",v=f(v,h,"Password"),(x=f(x,h,"Salt")).length),N=u.allocUnsafe(M),V=u.allocUnsafe(x.length+4);x.copy(V,0,0,x.length);for(var K=0,j=p[E],Z=Math.ceil(M/j),tt=1;tt<=Z;tt++){V.writeUInt32BE(tt,x.length);for(var rt=D.run(V,D.ipad1),J=rt,U=1;U<w;U++){J=D.run(J,D.ipad2);for(var G=0;G<j;G++)rt[G]^=J[G]}rt.copy(N,K),K+=j}return N}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,i,s){var a=e("safe-buffer").Buffer;i.exports=function(o,r,u){if(a.isBuffer(o))return o;if(typeof o=="string")return a.from(o,r);if(ArrayBuffer.isView(o))return a.from(o.buffer);throw new TypeError(u+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,i,s){(function(a){(function(){a===void 0||!a.version||a.version.indexOf("v0.")===0||a.version.indexOf("v1.")===0&&a.version.indexOf("v1.8.")!==0?i.exports={nextTick:function(o,r,u,l){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var h,f,d=arguments.length;switch(d){case 0:case 1:return a.nextTick(o);case 2:return a.nextTick(function(){o.call(null,r)});case 3:return a.nextTick(function(){o.call(null,r,u)});case 4:return a.nextTick(function(){o.call(null,r,u,l)});default:for(h=new Array(d-1),f=0;f<h.length;)h[f++]=arguments[f];return a.nextTick(function(){o.apply(null,h)})}}}:i.exports=a}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,i,s){var a,o,r=i.exports={};function u(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function h(E){if(a===setTimeout)return setTimeout(E,0);if((a===u||!a)&&setTimeout)return a=setTimeout,setTimeout(E,0);try{return a(E,0)}catch(D){try{return a.call(null,E,0)}catch(N){return a.call(this,E,0)}}}(function(){try{a=typeof setTimeout=="function"?setTimeout:u}catch(E){a=u}try{o=typeof clearTimeout=="function"?clearTimeout:l}catch(E){o=l}})();var f,d=[],p=!1,b=-1;function v(){p&&f&&(p=!1,f.length?d=f.concat(d):b=-1,d.length&&x())}function x(){if(!p){var E=h(v);p=!0;for(var D=d.length;D;){for(f=d,d=[];++b<D;)f&&f[b].run();b=-1,D=d.length}f=null,p=!1,function(N){if(o===clearTimeout)return clearTimeout(N);if((o===l||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(N);try{o(N)}catch(V){try{return o.call(null,N)}catch(K){return o.call(this,N)}}}(E)}}function w(E,D){this.fun=E,this.array=D}function M(){}r.nextTick=function(E){var D=new Array(arguments.length-1);if(arguments.length>1)for(var N=1;N<arguments.length;N++)D[N-1]=arguments[N];d.push(new w(E,D)),d.length!==1||p||h(x)},w.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=M,r.addListener=M,r.once=M,r.off=M,r.removeListener=M,r.removeAllListeners=M,r.emit=M,r.prependListener=M,r.prependOnceListener=M,r.listeners=function(E){return[]},r.binding=function(E){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(E){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],468:[function(e,i,s){s.publicEncrypt=e("./publicEncrypt"),s.privateDecrypt=e("./privateDecrypt"),s.privateEncrypt=function(a,o){return s.publicEncrypt(a,o,!0)},s.publicDecrypt=function(a,o){return s.privateDecrypt(a,o,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,i,s){var a=e("create-hash"),o=e("safe-buffer").Buffer;function r(u){var l=o.allocUnsafe(4);return l.writeUInt32BE(u,0),l}i.exports=function(u,l){for(var h,f=o.alloc(0),d=0;f.length<l;)h=r(d++),f=o.concat([f,a("sha1").update(u).update(h).digest()]);return f.slice(0,l)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,i,s){arguments[4][184][0].apply(s,arguments)},{buffer:188,dup:184}],471:[function(e,i,s){var a=e("parse-asn1"),o=e("./mgf"),r=e("./xor"),u=e("bn.js"),l=e("browserify-rsa"),h=e("create-hash"),f=e("./withPublic"),d=e("safe-buffer").Buffer;i.exports=function(p,b,v){var x;x=p.padding?p.padding:v?1:4;var w,M=a(p),E=M.modulus.byteLength();if(b.length>E||new u(b).cmp(M.modulus)>=0)throw new Error("decryption error");w=v?f(new u(b),M):l(b,M);var D=d.alloc(E-w.length);if(w=d.concat([D,w],E),x===4)return function(N,V){var K=N.modulus.byteLength(),j=h("sha1").update(d.alloc(0)).digest(),Z=j.length;if(V[0]!==0)throw new Error("decryption error");var tt=V.slice(1,Z+1),rt=V.slice(Z+1),J=r(tt,o(rt,Z)),U=r(rt,o(J,K-Z-1));if(function(I,C){I=d.from(I),C=d.from(C);var L=0,B=I.length;I.length!==C.length&&(L++,B=Math.min(I.length,C.length));for(var O=-1;++O<B;)L+=I[O]^C[O];return L}(j,U.slice(0,Z)))throw new Error("decryption error");for(var G=Z;U[G]===0;)G++;if(U[G++]!==1)throw new Error("decryption error");return U.slice(G)}(M,w);if(x===1)return function(N,V,K){for(var j=V.slice(0,2),Z=2,tt=0;V[Z++]!==0;)if(Z>=V.length){tt++;break}var rt=V.slice(2,Z-1);if((j.toString("hex")!=="0002"&&!K||j.toString("hex")!=="0001"&&K)&&tt++,rt.length<8&&tt++,tt)throw new Error("decryption error");return V.slice(Z)}(0,w,v);if(x===3)return w;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,i,s){var a=e("parse-asn1"),o=e("randombytes"),r=e("create-hash"),u=e("./mgf"),l=e("./xor"),h=e("bn.js"),f=e("./withPublic"),d=e("browserify-rsa"),p=e("safe-buffer").Buffer;i.exports=function(b,v,x){var w;w=b.padding?b.padding:x?1:4;var M,E=a(b);if(w===4)M=function(D,N){var V=D.modulus.byteLength(),K=N.length,j=r("sha1").update(p.alloc(0)).digest(),Z=j.length,tt=2*Z;if(K>V-tt-2)throw new Error("message too long");var rt=p.alloc(V-K-tt-2),J=V-Z-1,U=o(Z),G=l(p.concat([j,rt,p.alloc(1,1),N],J),u(U,J)),I=l(U,u(G,Z));return new h(p.concat([p.alloc(1),I,G],V))}(E,v);else if(w===1)M=function(D,N,V){var K,j=N.length,Z=D.modulus.byteLength();if(j>Z-11)throw new Error("message too long");return K=V?p.alloc(Z-j-3,255):function(tt){for(var rt,J=p.allocUnsafe(tt),U=0,G=o(2*tt),I=0;U<tt;)I===G.length&&(G=o(2*tt),I=0),(rt=G[I++])&&(J[U++]=rt);return J}(Z-j-3),new h(p.concat([p.from([0,V?1:2]),K,p.alloc(1),N],Z))}(E,v,x);else{if(w!==3)throw new Error("unknown padding");if((M=new h(v)).cmp(E.modulus)>=0)throw new Error("data too long for modulus")}return x?d(M,E):f(M,E)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,i,s){var a=e("bn.js"),o=e("safe-buffer").Buffer;i.exports=function(r,u){return o.from(r.toRed(a.mont(u.modulus)).redPow(new a(u.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,i,s){i.exports=function(a,o){for(var r=a.length,u=-1;++u<r;)a[u]^=o[u];return a}},{}],475:[function(e,i,s){(function(a,o){(function(){var r=e("safe-buffer").Buffer,u=o.crypto||o.msCrypto;u&&u.getRandomValues?i.exports=function(l,h){if(l>4294967295)throw new RangeError("requested too many random bytes");var f=r.allocUnsafe(l);if(l>0)if(l>65536)for(var d=0;d<l;d+=65536)u.getRandomValues(f.slice(d,d+65536));else u.getRandomValues(f);return typeof h=="function"?a.nextTick(function(){h(null,f)}):f}:i.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,i,s){(function(a,o){(function(){function r(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var u=e("safe-buffer"),l=e("randombytes"),h=u.Buffer,f=u.kMaxLength,d=o.crypto||o.msCrypto,p=Math.pow(2,32)-1;function b(w,M){if(typeof w!="number"||w!=w)throw new TypeError("offset must be a number");if(w>p||w<0)throw new TypeError("offset must be a uint32");if(w>f||w>M)throw new RangeError("offset out of range")}function v(w,M,E){if(typeof w!="number"||w!=w)throw new TypeError("size must be a number");if(w>p||w<0)throw new TypeError("size must be a uint32");if(w+M>E||w>f)throw new RangeError("buffer too small")}function x(w,M,E,D){if(a.browser){var N=w.buffer,V=new Uint8Array(N,M,E);return d.getRandomValues(V),D?void a.nextTick(function(){D(null,w)}):w}if(!D)return l(E).copy(w,M),w;l(E,function(K,j){if(K)return D(K);j.copy(w,M),D(null,w)})}d&&d.getRandomValues||!a.browser?(s.randomFill=function(w,M,E,D){if(!(h.isBuffer(w)||w instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof M=="function")D=M,M=0,E=w.length;else if(typeof E=="function")D=E,E=w.length-M;else if(typeof D!="function")throw new TypeError('"cb" argument must be a function');return b(M,w.length),v(E,M,w.length),x(w,M,E,D)},s.randomFillSync=function(w,M,E){if(M===void 0&&(M=0),!(h.isBuffer(w)||w instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return b(M,w.length),E===void 0&&(E=w.length-M),v(E,M,w.length),x(w,M,E)}):(s.randomFill=r,s.randomFillSync=r)}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,i,s){var a={};function o(u,l,h){h||(h=Error);var f=function(d){var p,b;function v(x,w,M){return d.call(this,function(E,D,N){return typeof l=="string"?l:l(E,D,N)}(x,w,M))||this}return b=d,(p=v).prototype=Object.create(b.prototype),p.prototype.constructor=p,p.__proto__=b,v}(h);f.prototype.name=h.name,f.prototype.code=u,a[u]=f}function r(u,l){if(Array.isArray(u)){var h=u.length;return u=u.map(function(f){return String(f)}),h>2?"one of ".concat(l," ").concat(u.slice(0,h-1).join(", "),", or ")+u[h-1]:h===2?"one of ".concat(l," ").concat(u[0]," or ").concat(u[1]):"of ".concat(l," ").concat(u[0])}return"of ".concat(l," ").concat(String(u))}o("ERR_INVALID_OPT_VALUE",function(u,l){return'The value "'+l+'" is invalid for option "'+u+'"'},TypeError),o("ERR_INVALID_ARG_TYPE",function(u,l,h){var f,d,p;if(typeof l=="string"&&(d="not ",l.substr(0,d.length)===d)?(f="must not be",l=l.replace(/^not /,"")):f="must be",function(v,x,w){return(w===void 0||w>v.length)&&(w=v.length),v.substring(w-x.length,w)===x}(u," argument"))p="The ".concat(u," ").concat(f," ").concat(r(l,"type"));else{var b=function(v,x,w){return typeof w!="number"&&(w=0),!(w+x.length>v.length)&&v.indexOf(x,w)!==-1}(u,".")?"property":"argument";p='The "'.concat(u,'" ').concat(b," ").concat(f," ").concat(r(l,"type"))}return p+=". Received type ".concat(typeof h)},TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),i.exports.codes=a},{}],478:[function(e,i,s){(function(a){(function(){var o=Object.keys||function(v){var x=[];for(var w in v)x.push(w);return x};i.exports=d;var r=e("./_stream_readable"),u=e("./_stream_writable");e("inherits")(d,r);for(var l=o(u.prototype),h=0;h<l.length;h++){var f=l[h];d.prototype[f]||(d.prototype[f]=u.prototype[f])}function d(v){if(!(this instanceof d))return new d(v);r.call(this,v),u.call(this,v),this.allowHalfOpen=!0,v&&(v.readable===!1&&(this.readable=!1),v.writable===!1&&(this.writable=!1),v.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p)))}function p(){this._writableState.ended||a.nextTick(b,this)}function b(v){v.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(v){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=v,this._writableState.destroyed=v)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,i,s){i.exports=o;var a=e("./_stream_transform");function o(r){if(!(this instanceof o))return new o(r);a.call(this,r)}e("inherits")(o,a),o.prototype._transform=function(r,u,l){l(null,r)}},{"./_stream_transform":481,inherits:440}],480:[function(e,i,s){(function(a,o){(function(){var r;i.exports=J,J.ReadableState=rt,e("events").EventEmitter;var u=function(Y,H){return Y.listeners(H).length},l=e("./internal/streams/stream"),h=e("buffer").Buffer,f=(o!==void 0?o:typeof window!="undefined"?window:typeof self!="undefined"?self:{}).Uint8Array||function(){},d,p=e("util");d=p&&p.debuglog?p.debuglog("stream"):function(){};var b,v,x,w=e("./internal/streams/buffer_list"),M=e("./internal/streams/destroy"),E=e("./internal/streams/state").getHighWaterMark,D=e("../errors").codes,N=D.ERR_INVALID_ARG_TYPE,V=D.ERR_STREAM_PUSH_AFTER_EOF,K=D.ERR_METHOD_NOT_IMPLEMENTED,j=D.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(J,l);var Z=M.errorOrDestroy,tt=["error","close","destroy","pause","resume"];function rt(Y,H,at){r=r||e("./_stream_duplex"),Y=Y||{},typeof at!="boolean"&&(at=H instanceof r),this.objectMode=!!Y.objectMode,at&&(this.objectMode=this.objectMode||!!Y.readableObjectMode),this.highWaterMark=E(this,Y,"readableHighWaterMark",at),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Y.emitClose!==!1,this.autoDestroy=!!Y.autoDestroy,this.destroyed=!1,this.defaultEncoding=Y.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Y.encoding&&(b||(b=e("string_decoder/").StringDecoder),this.decoder=new b(Y.encoding),this.encoding=Y.encoding)}function J(Y){if(r=r||e("./_stream_duplex"),!(this instanceof J))return new J(Y);var H=this instanceof r;this._readableState=new rt(Y,this,H),this.readable=!0,Y&&(typeof Y.read=="function"&&(this._read=Y.read),typeof Y.destroy=="function"&&(this._destroy=Y.destroy)),l.call(this)}function U(Y,H,at,ft,wt){d("readableAddChunk",H);var _t,Dt=Y._readableState;if(H===null)Dt.reading=!1,function(Gt,te){if(d("onEofChunk"),!te.ended){if(te.decoder){var mt=te.decoder.end();mt&&mt.length&&(te.buffer.push(mt),te.length+=te.objectMode?1:mt.length)}te.ended=!0,te.sync?C(Gt):(te.needReadable=!1,te.emittedReadable||(te.emittedReadable=!0,L(Gt)))}}(Y,Dt);else if(wt||(_t=function(Gt,te){var mt;At=te,h.isBuffer(At)||At instanceof f||typeof te=="string"||te===void 0||Gt.objectMode||(mt=new N("chunk",["string","Buffer","Uint8Array"],te));var At;return mt}(Dt,H)),_t)Z(Y,_t);else if(Dt.objectMode||H&&H.length>0)if(typeof H=="string"||Dt.objectMode||Object.getPrototypeOf(H)===h.prototype||(H=function(Gt){return h.from(Gt)}(H)),ft)Dt.endEmitted?Z(Y,new j):G(Y,Dt,H,!0);else if(Dt.ended)Z(Y,new V);else{if(Dt.destroyed)return!1;Dt.reading=!1,Dt.decoder&&!at?(H=Dt.decoder.write(H),Dt.objectMode||H.length!==0?G(Y,Dt,H,!1):B(Y,Dt)):G(Y,Dt,H,!1)}else ft||(Dt.reading=!1,B(Y,Dt));return!Dt.ended&&(Dt.length<Dt.highWaterMark||Dt.length===0)}function G(Y,H,at,ft){H.flowing&&H.length===0&&!H.sync?(H.awaitDrain=0,Y.emit("data",at)):(H.length+=H.objectMode?1:at.length,ft?H.buffer.unshift(at):H.buffer.push(at),H.needReadable&&C(Y)),B(Y,H)}Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(Y){this._readableState&&(this._readableState.destroyed=Y)}}),J.prototype.destroy=M.destroy,J.prototype._undestroy=M.undestroy,J.prototype._destroy=function(Y,H){H(Y)},J.prototype.push=function(Y,H){var at,ft=this._readableState;return ft.objectMode?at=!0:typeof Y=="string"&&((H=H||ft.defaultEncoding)!==ft.encoding&&(Y=h.from(Y,H),H=""),at=!0),U(this,Y,H,!1,at)},J.prototype.unshift=function(Y){return U(this,Y,null,!0,!1)},J.prototype.isPaused=function(){return this._readableState.flowing===!1},J.prototype.setEncoding=function(Y){b||(b=e("string_decoder/").StringDecoder);var H=new b(Y);this._readableState.decoder=H,this._readableState.encoding=this._readableState.decoder.encoding;for(var at=this._readableState.buffer.head,ft="";at!==null;)ft+=H.write(at.data),at=at.next;return this._readableState.buffer.clear(),ft!==""&&this._readableState.buffer.push(ft),this._readableState.length=ft.length,this};function I(Y,H){return Y<=0||H.length===0&&H.ended?0:H.objectMode?1:Y!=Y?H.flowing&&H.length?H.buffer.head.data.length:H.length:(Y>H.highWaterMark&&(H.highWaterMark=function(at){return at>=1073741824?at=1073741824:(at--,at|=at>>>1,at|=at>>>2,at|=at>>>4,at|=at>>>8,at|=at>>>16,at++),at}(Y)),Y<=H.length?Y:H.ended?H.length:(H.needReadable=!0,0))}function C(Y){var H=Y._readableState;d("emitReadable",H.needReadable,H.emittedReadable),H.needReadable=!1,H.emittedReadable||(d("emitReadable",H.flowing),H.emittedReadable=!0,a.nextTick(L,Y))}function L(Y){var H=Y._readableState;d("emitReadable_",H.destroyed,H.length,H.ended),H.destroyed||!H.length&&!H.ended||(Y.emit("readable"),H.emittedReadable=!1),H.needReadable=!H.flowing&&!H.ended&&H.length<=H.highWaterMark,lt(Y)}function B(Y,H){H.readingMore||(H.readingMore=!0,a.nextTick(O,Y,H))}function O(Y,H){for(;!H.reading&&!H.ended&&(H.length<H.highWaterMark||H.flowing&&H.length===0);){var at=H.length;if(d("maybeReadMore read 0"),Y.read(0),at===H.length)break}H.readingMore=!1}function q(Y){var H=Y._readableState;H.readableListening=Y.listenerCount("readable")>0,H.resumeScheduled&&!H.paused?H.flowing=!0:Y.listenerCount("data")>0&&Y.resume()}function it(Y){d("readable nexttick read 0"),Y.read(0)}function nt(Y,H){d("resume",H.reading),H.reading||Y.read(0),H.resumeScheduled=!1,Y.emit("resume"),lt(Y),H.flowing&&!H.reading&&Y.read(0)}function lt(Y){var H=Y._readableState;for(d("flow",H.flowing);H.flowing&&Y.read()!==null;);}function ut(Y,H){return H.length===0?null:(H.objectMode?at=H.buffer.shift():!Y||Y>=H.length?(at=H.decoder?H.buffer.join(""):H.buffer.length===1?H.buffer.first():H.buffer.concat(H.length),H.buffer.clear()):at=H.buffer.consume(Y,H.decoder),at);var at}function vt(Y){var H=Y._readableState;d("endReadable",H.endEmitted),H.endEmitted||(H.ended=!0,a.nextTick(Q,H,Y))}function Q(Y,H){if(d("endReadableNT",Y.endEmitted,Y.length),!Y.endEmitted&&Y.length===0&&(Y.endEmitted=!0,H.readable=!1,H.emit("end"),Y.autoDestroy)){var at=H._writableState;(!at||at.autoDestroy&&at.finished)&&H.destroy()}}function gt(Y,H){for(var at=0,ft=Y.length;at<ft;at++)if(Y[at]===H)return at;return-1}J.prototype.read=function(Y){d("read",Y),Y=parseInt(Y,10);var H=this._readableState,at=Y;if(Y!==0&&(H.emittedReadable=!1),Y===0&&H.needReadable&&((H.highWaterMark!==0?H.length>=H.highWaterMark:H.length>0)||H.ended))return d("read: emitReadable",H.length,H.ended),H.length===0&&H.ended?vt(this):C(this),null;if((Y=I(Y,H))===0&&H.ended)return H.length===0&&vt(this),null;var ft,wt=H.needReadable;return d("need readable",wt),(H.length===0||H.length-Y<H.highWaterMark)&&d("length less than watermark",wt=!0),H.ended||H.reading?d("reading or ended",wt=!1):wt&&(d("do read"),H.reading=!0,H.sync=!0,H.length===0&&(H.needReadable=!0),this._read(H.highWaterMark),H.sync=!1,H.reading||(Y=I(at,H))),(ft=Y>0?ut(Y,H):null)===null?(H.needReadable=H.length<=H.highWaterMark,Y=0):(H.length-=Y,H.awaitDrain=0),H.length===0&&(H.ended||(H.needReadable=!0),at!==Y&&H.ended&&vt(this)),ft!==null&&this.emit("data",ft),ft},J.prototype._read=function(Y){Z(this,new K("_read()"))},J.prototype.pipe=function(Y,H){var at=this,ft=this._readableState;switch(ft.pipesCount){case 0:ft.pipes=Y;break;case 1:ft.pipes=[ft.pipes,Y];break;default:ft.pipes.push(Y)}ft.pipesCount+=1,d("pipe count=%d opts=%j",ft.pipesCount,H);var wt=(!H||H.end!==!1)&&Y!==a.stdout&&Y!==a.stderr?Dt:he;function _t(fe,be){d("onunpipe"),fe===at&&be&&be.hasUnpiped===!1&&(be.hasUnpiped=!0,d("cleanup"),Y.removeListener("close",Ot),Y.removeListener("finish",Zt),Y.removeListener("drain",Gt),Y.removeListener("error",At),Y.removeListener("unpipe",_t),at.removeListener("end",Dt),at.removeListener("end",he),at.removeListener("data",mt),te=!0,!ft.awaitDrain||Y._writableState&&!Y._writableState.needDrain||Gt())}function Dt(){d("onend"),Y.end()}ft.endEmitted?a.nextTick(wt):at.once("end",wt),Y.on("unpipe",_t);var Gt=function(fe){return function(){var be=fe._readableState;d("pipeOnDrain",be.awaitDrain),be.awaitDrain&&be.awaitDrain--,be.awaitDrain===0&&u(fe,"data")&&(be.flowing=!0,lt(fe))}}(at);Y.on("drain",Gt);var te=!1;function mt(fe){d("ondata");var be=Y.write(fe);d("dest.write",be),be===!1&&((ft.pipesCount===1&&ft.pipes===Y||ft.pipesCount>1&&gt(ft.pipes,Y)!==-1)&&!te&&(d("false write response, pause",ft.awaitDrain),ft.awaitDrain++),at.pause())}function At(fe){d("onerror",fe),he(),Y.removeListener("error",At),u(Y,"error")===0&&Z(Y,fe)}function Ot(){Y.removeListener("finish",Zt),he()}function Zt(){d("onfinish"),Y.removeListener("close",Ot),he()}function he(){d("unpipe"),at.unpipe(Y)}return at.on("data",mt),function(fe,be,Me){if(typeof fe.prependListener=="function")return fe.prependListener(be,Me);fe._events&&fe._events[be]?Array.isArray(fe._events[be])?fe._events[be].unshift(Me):fe._events[be]=[Me,fe._events[be]]:fe.on(be,Me)}(Y,"error",At),Y.once("close",Ot),Y.once("finish",Zt),Y.emit("pipe",at),ft.flowing||(d("pipe resume"),at.resume()),Y},J.prototype.unpipe=function(Y){var H=this._readableState,at={hasUnpiped:!1};if(H.pipesCount===0)return this;if(H.pipesCount===1)return Y&&Y!==H.pipes||(Y||(Y=H.pipes),H.pipes=null,H.pipesCount=0,H.flowing=!1,Y&&Y.emit("unpipe",this,at)),this;if(!Y){var ft=H.pipes,wt=H.pipesCount;H.pipes=null,H.pipesCount=0,H.flowing=!1;for(var _t=0;_t<wt;_t++)ft[_t].emit("unpipe",this,{hasUnpiped:!1});return this}var Dt=gt(H.pipes,Y);return Dt===-1||(H.pipes.splice(Dt,1),H.pipesCount-=1,H.pipesCount===1&&(H.pipes=H.pipes[0]),Y.emit("unpipe",this,at)),this},J.prototype.on=function(Y,H){var at=l.prototype.on.call(this,Y,H),ft=this._readableState;return Y==="data"?(ft.readableListening=this.listenerCount("readable")>0,ft.flowing!==!1&&this.resume()):Y==="readable"&&(ft.endEmitted||ft.readableListening||(ft.readableListening=ft.needReadable=!0,ft.flowing=!1,ft.emittedReadable=!1,d("on readable",ft.length,ft.reading),ft.length?C(this):ft.reading||a.nextTick(it,this))),at},J.prototype.addListener=J.prototype.on,J.prototype.removeListener=function(Y,H){var at=l.prototype.removeListener.call(this,Y,H);return Y==="readable"&&a.nextTick(q,this),at},J.prototype.removeAllListeners=function(Y){var H=l.prototype.removeAllListeners.apply(this,arguments);return Y!=="readable"&&Y!==void 0||a.nextTick(q,this),H},J.prototype.resume=function(){var Y=this._readableState;return Y.flowing||(d("resume"),Y.flowing=!Y.readableListening,function(H,at){at.resumeScheduled||(at.resumeScheduled=!0,a.nextTick(nt,H,at))}(this,Y)),Y.paused=!1,this},J.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},J.prototype.wrap=function(Y){var H=this,at=this._readableState,ft=!1;for(var wt in Y.on("end",function(){if(d("wrapped end"),at.decoder&&!at.ended){var Dt=at.decoder.end();Dt&&Dt.length&&H.push(Dt)}H.push(null)}),Y.on("data",function(Dt){d("wrapped data"),at.decoder&&(Dt=at.decoder.write(Dt)),at.objectMode&&Dt==null||(at.objectMode||Dt&&Dt.length)&&(H.push(Dt)||(ft=!0,Y.pause()))}),Y)this[wt]===void 0&&typeof Y[wt]=="function"&&(this[wt]=function(Dt){return function(){return Y[Dt].apply(Y,arguments)}}(wt));for(var _t=0;_t<tt.length;_t++)Y.on(tt[_t],this.emit.bind(this,tt[_t]));return this._read=function(Dt){d("wrapped _read",Dt),ft&&(ft=!1,Y.resume())},this},typeof Symbol=="function"&&(J.prototype[Symbol.asyncIterator]=function(){return v===void 0&&(v=e("./internal/streams/async_iterator")),v(this)}),Object.defineProperty(J.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(J.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(J.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Y){this._readableState&&(this._readableState.flowing=Y)}}),J._fromList=ut,Object.defineProperty(J.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(J.from=function(Y,H){return x===void 0&&(x=e("./internal/streams/from")),x(J,Y,H)})}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,i,s){i.exports=d;var a=e("../errors").codes,o=a.ERR_METHOD_NOT_IMPLEMENTED,r=a.ERR_MULTIPLE_CALLBACK,u=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=a.ERR_TRANSFORM_WITH_LENGTH_0,h=e("./_stream_duplex");function f(v,x){var w=this._transformState;w.transforming=!1;var M=w.writecb;if(M===null)return this.emit("error",new r);w.writechunk=null,w.writecb=null,x!=null&&this.push(x),M(v);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function d(v){if(!(this instanceof d))return new d(v);h.call(this,v),this._transformState={afterTransform:f.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,v&&(typeof v.transform=="function"&&(this._transform=v.transform),typeof v.flush=="function"&&(this._flush=v.flush)),this.on("prefinish",p)}function p(){var v=this;typeof this._flush!="function"||this._readableState.destroyed?b(this,null,null):this._flush(function(x,w){b(v,x,w)})}function b(v,x,w){if(x)return v.emit("error",x);if(w!=null&&v.push(w),v._writableState.length)throw new l;if(v._transformState.transforming)throw new u;return v.push(null)}e("inherits")(d,h),d.prototype.push=function(v,x){return this._transformState.needTransform=!1,h.prototype.push.call(this,v,x)},d.prototype._transform=function(v,x,w){w(new o("_transform()"))},d.prototype._write=function(v,x,w){var M=this._transformState;if(M.writecb=w,M.writechunk=v,M.writeencoding=x,!M.transforming){var E=this._readableState;(M.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},d.prototype._read=function(v){var x=this._transformState;x.writechunk===null||x.transforming?x.needTransform=!0:(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform))},d.prototype._destroy=function(v,x){h.prototype._destroy.call(this,v,function(w){x(w)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,i,s){(function(a,o){(function(){function r(O){var q=this;this.next=null,this.entry=null,this.finish=function(){(function(it,nt,lt){var ut=it.entry;for(it.entry=null;ut;){var vt=ut.callback;nt.pendingcb--,vt(lt),ut=ut.next}nt.corkedRequestsFree.next=it})(q,O)}}var u;i.exports=J,J.WritableState=rt;var l={deprecate:e("util-deprecate")},h=e("./internal/streams/stream"),f=e("buffer").Buffer,d=(o!==void 0?o:typeof window!="undefined"?window:typeof self!="undefined"?self:{}).Uint8Array||function(){},p,b=e("./internal/streams/destroy"),v=e("./internal/streams/state").getHighWaterMark,x=e("../errors").codes,w=x.ERR_INVALID_ARG_TYPE,M=x.ERR_METHOD_NOT_IMPLEMENTED,E=x.ERR_MULTIPLE_CALLBACK,D=x.ERR_STREAM_CANNOT_PIPE,N=x.ERR_STREAM_DESTROYED,V=x.ERR_STREAM_NULL_VALUES,K=x.ERR_STREAM_WRITE_AFTER_END,j=x.ERR_UNKNOWN_ENCODING,Z=b.errorOrDestroy;function tt(){}function rt(O,q,it){u=u||e("./_stream_duplex"),O=O||{},typeof it!="boolean"&&(it=q instanceof u),this.objectMode=!!O.objectMode,it&&(this.objectMode=this.objectMode||!!O.writableObjectMode),this.highWaterMark=v(this,O,"writableHighWaterMark",it),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var nt=O.decodeStrings===!1;this.decodeStrings=!nt,this.defaultEncoding=O.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(lt){(function(ut,vt){var Q=ut._writableState,gt=Q.sync,Y=Q.writecb;if(typeof Y!="function")throw new E;if(function(at){at.writing=!1,at.writecb=null,at.length-=at.writelen,at.writelen=0}(Q),vt)(function(at,ft,wt,_t,Dt){--ft.pendingcb,wt?(a.nextTick(Dt,_t),a.nextTick(B,at,ft),at._writableState.errorEmitted=!0,Z(at,_t)):(Dt(_t),at._writableState.errorEmitted=!0,Z(at,_t),B(at,ft))})(ut,Q,gt,vt,Y);else{var H=C(Q)||ut.destroyed;H||Q.corked||Q.bufferProcessing||!Q.bufferedRequest||I(ut,Q),gt?a.nextTick(G,ut,Q,H,Y):G(ut,Q,H,Y)}})(q,lt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function J(O){var q=this instanceof(u=u||e("./_stream_duplex"));if(!q&&!p.call(J,this))return new J(O);this._writableState=new rt(O,this,q),this.writable=!0,O&&(typeof O.write=="function"&&(this._write=O.write),typeof O.writev=="function"&&(this._writev=O.writev),typeof O.destroy=="function"&&(this._destroy=O.destroy),typeof O.final=="function"&&(this._final=O.final)),h.call(this)}function U(O,q,it,nt,lt,ut,vt){q.writelen=nt,q.writecb=vt,q.writing=!0,q.sync=!0,q.destroyed?q.onwrite(new N("write")):it?O._writev(lt,q.onwrite):O._write(lt,ut,q.onwrite),q.sync=!1}function G(O,q,it,nt){it||function(lt,ut){ut.length===0&&ut.needDrain&&(ut.needDrain=!1,lt.emit("drain"))}(O,q),q.pendingcb--,nt(),B(O,q)}function I(O,q){q.bufferProcessing=!0;var it=q.bufferedRequest;if(O._writev&&it&&it.next){var nt=q.bufferedRequestCount,lt=new Array(nt),ut=q.corkedRequestsFree;ut.entry=it;for(var vt=0,Q=!0;it;)lt[vt]=it,it.isBuf||(Q=!1),it=it.next,vt+=1;lt.allBuffers=Q,U(O,q,!0,q.length,lt,"",ut.finish),q.pendingcb++,q.lastBufferedRequest=null,ut.next?(q.corkedRequestsFree=ut.next,ut.next=null):q.corkedRequestsFree=new r(q),q.bufferedRequestCount=0}else{for(;it;){var gt=it.chunk,Y=it.encoding,H=it.callback;if(U(O,q,!1,q.objectMode?1:gt.length,gt,Y,H),it=it.next,q.bufferedRequestCount--,q.writing)break}it===null&&(q.lastBufferedRequest=null)}q.bufferedRequest=it,q.bufferProcessing=!1}function C(O){return O.ending&&O.length===0&&O.bufferedRequest===null&&!O.finished&&!O.writing}function L(O,q){O._final(function(it){q.pendingcb--,it&&Z(O,it),q.prefinished=!0,O.emit("prefinish"),B(O,q)})}function B(O,q){var it=C(q);if(it&&(function(lt,ut){ut.prefinished||ut.finalCalled||(typeof lt._final!="function"||ut.destroyed?(ut.prefinished=!0,lt.emit("prefinish")):(ut.pendingcb++,ut.finalCalled=!0,a.nextTick(L,lt,ut)))}(O,q),q.pendingcb===0&&(q.finished=!0,O.emit("finish"),q.autoDestroy))){var nt=O._readableState;(!nt||nt.autoDestroy&&nt.endEmitted)&&O.destroy()}return it}e("inherits")(J,h),rt.prototype.getBuffer=function(){for(var O=this.bufferedRequest,q=[];O;)q.push(O),O=O.next;return q},function(){try{Object.defineProperty(rt.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(O){}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(J,Symbol.hasInstance,{value:function(O){return!!p.call(this,O)||this===J&&O&&O._writableState instanceof rt}})):p=function(O){return O instanceof this},J.prototype.pipe=function(){Z(this,new D)},J.prototype.write=function(O,q,it){var nt,lt=this._writableState,ut=!1,vt=!lt.objectMode&&(nt=O,f.isBuffer(nt)||nt instanceof d);return vt&&!f.isBuffer(O)&&(O=function(Q){return f.from(Q)}(O)),typeof q=="function"&&(it=q,q=null),vt?q="buffer":q||(q=lt.defaultEncoding),typeof it!="function"&&(it=tt),lt.ending?function(Q,gt){var Y=new K;Z(Q,Y),a.nextTick(gt,Y)}(this,it):(vt||function(Q,gt,Y,H){var at;return Y===null?at=new V:typeof Y=="string"||gt.objectMode||(at=new w("chunk",["string","Buffer"],Y)),!at||(Z(Q,at),a.nextTick(H,at),!1)}(this,lt,O,it))&&(lt.pendingcb++,ut=function(Q,gt,Y,H,at,ft){if(!Y){var wt=function(te,mt,At){return te.objectMode||te.decodeStrings===!1||typeof mt!="string"||(mt=f.from(mt,At)),mt}(gt,H,at);H!==wt&&(Y=!0,at="buffer",H=wt)}var _t=gt.objectMode?1:H.length;gt.length+=_t;var Dt=gt.length<gt.highWaterMark;if(Dt||(gt.needDrain=!0),gt.writing||gt.corked){var Gt=gt.lastBufferedRequest;gt.lastBufferedRequest={chunk:H,encoding:at,isBuf:Y,callback:ft,next:null},Gt?Gt.next=gt.lastBufferedRequest:gt.bufferedRequest=gt.lastBufferedRequest,gt.bufferedRequestCount+=1}else U(Q,gt,!1,_t,H,at,ft);return Dt}(this,lt,vt,O,q,it)),ut},J.prototype.cork=function(){this._writableState.corked++},J.prototype.uncork=function(){var O=this._writableState;O.corked&&(O.corked--,O.writing||O.corked||O.bufferProcessing||!O.bufferedRequest||I(this,O))},J.prototype.setDefaultEncoding=function(O){if(typeof O=="string"&&(O=O.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((O+"").toLowerCase())>-1))throw new j(O);return this._writableState.defaultEncoding=O,this},Object.defineProperty(J.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(J.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),J.prototype._write=function(O,q,it){it(new M("_write()"))},J.prototype._writev=null,J.prototype.end=function(O,q,it){var nt=this._writableState;return typeof O=="function"?(it=O,O=null,q=null):typeof q=="function"&&(it=q,q=null),O!=null&&this.write(O,q),nt.corked&&(nt.corked=1,this.uncork()),nt.ending||function(lt,ut,vt){ut.ending=!0,B(lt,ut),vt&&(ut.finished?a.nextTick(vt):lt.once("finish",vt)),ut.ended=!0,lt.writable=!1}(this,nt,it),this},Object.defineProperty(J.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(O){this._writableState&&(this._writableState.destroyed=O)}}),J.prototype.destroy=b.destroy,J.prototype._undestroy=b.undestroy,J.prototype._destroy=function(O,q){q(O)}}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,i,s){(function(a){(function(){var o;function r(N,V,K){return(V=function(j){var Z=function(tt,rt){if(typeof tt!="object"||tt===null)return tt;var J=tt[Symbol.toPrimitive];if(J!==void 0){var U=J.call(tt,rt||"default");if(typeof U!="object")return U;throw new TypeError("@@toPrimitive must return a primitive value.")}return(rt==="string"?String:Number)(tt)}(j,"string");return typeof Z=="symbol"?Z:String(Z)}(V))in N?Object.defineProperty(N,V,{value:K,enumerable:!0,configurable:!0,writable:!0}):N[V]=K,N}var u=e("./end-of-stream"),l=Symbol("lastResolve"),h=Symbol("lastReject"),f=Symbol("error"),d=Symbol("ended"),p=Symbol("lastPromise"),b=Symbol("handlePromise"),v=Symbol("stream");function x(N,V){return{value:N,done:V}}function w(N){var V=N[l];if(V!==null){var K=N[v].read();K!==null&&(N[p]=null,N[l]=null,N[h]=null,V(x(K,!1)))}}function M(N){a.nextTick(w,N)}var E=Object.getPrototypeOf(function(){}),D=Object.setPrototypeOf((r(o={get stream(){return this[v]},next:function(){var N=this,V=this[f];if(V!==null)return Promise.reject(V);if(this[d])return Promise.resolve(x(void 0,!0));if(this[v].destroyed)return new Promise(function(tt,rt){a.nextTick(function(){N[f]?rt(N[f]):tt(x(void 0,!0))})});var K,j=this[p];if(j)K=new Promise(function(tt,rt){return function(J,U){tt.then(function(){rt[d]?J(x(void 0,!0)):rt[b](J,U)},U)}}(j,this));else{var Z=this[v].read();if(Z!==null)return Promise.resolve(x(Z,!1));K=new Promise(this[b])}return this[p]=K,K}},Symbol.asyncIterator,function(){return this}),r(o,"return",function(){var N=this;return new Promise(function(V,K){N[v].destroy(null,function(j){j?K(j):V(x(void 0,!0))})})}),o),E);i.exports=function(N){var V,K=Object.create(D,(r(V={},v,{value:N,writable:!0}),r(V,l,{value:null,writable:!0}),r(V,h,{value:null,writable:!0}),r(V,f,{value:null,writable:!0}),r(V,d,{value:N._readableState.endEmitted,writable:!0}),r(V,b,{value:function(j,Z){var tt=K[v].read();tt?(K[p]=null,K[l]=null,K[h]=null,j(x(tt,!1))):(K[l]=j,K[h]=Z)},writable:!0}),V));return K[p]=null,u(N,function(j){if(j&&j.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Z=K[h];return Z!==null&&(K[p]=null,K[l]=null,K[h]=null,Z(j)),void(K[f]=j)}var tt=K[l];tt!==null&&(K[p]=null,K[l]=null,K[h]=null,tt(x(void 0,!0))),K[d]=!0}),N.on("readable",M.bind(null,K)),K}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,i,s){function a(p,b){var v=Object.keys(p);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(p);b&&(x=x.filter(function(w){return Object.getOwnPropertyDescriptor(p,w).enumerable})),v.push.apply(v,x)}return v}function o(p){for(var b=1;b<arguments.length;b++){var v=arguments[b]!=null?arguments[b]:{};b%2?a(Object(v),!0).forEach(function(x){r(p,x,v[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(v)):a(Object(v)).forEach(function(x){Object.defineProperty(p,x,Object.getOwnPropertyDescriptor(v,x))})}return p}function r(p,b,v){return(b=l(b))in p?Object.defineProperty(p,b,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[b]=v,p}function u(p,b){for(var v=0;v<b.length;v++){var x=b[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,l(x.key),x)}}function l(p){var b=function(v,x){if(typeof v!="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var M=w.call(v,x||"default");if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}(p,"string");return typeof b=="symbol"?b:String(b)}var h=e("buffer").Buffer,f=e("util").inspect,d=f&&f.custom||"inspect";i.exports=function(){function p(){(function(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")})(this,p),this.head=null,this.tail=null,this.length=0}var b,v;return b=p,(v=[{key:"push",value:function(x){var w={data:x,next:null};this.length>0?this.tail.next=w:this.head=w,this.tail=w,++this.length}},{key:"unshift",value:function(x){var w={data:x,next:this.head};this.length===0&&(this.tail=w),this.head=w,++this.length}},{key:"shift",value:function(){if(this.length!==0){var x=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,x}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(x){if(this.length===0)return"";for(var w=this.head,M=""+w.data;w=w.next;)M+=x+w.data;return M}},{key:"concat",value:function(x){if(this.length===0)return h.alloc(0);for(var w,M,E,D=h.allocUnsafe(x>>>0),N=this.head,V=0;N;)w=N.data,M=D,E=V,h.prototype.copy.call(w,M,E),V+=N.data.length,N=N.next;return D}},{key:"consume",value:function(x,w){var M;return x<this.head.data.length?(M=this.head.data.slice(0,x),this.head.data=this.head.data.slice(x)):M=x===this.head.data.length?this.shift():w?this._getString(x):this._getBuffer(x),M}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(x){var w=this.head,M=1,E=w.data;for(x-=E.length;w=w.next;){var D=w.data,N=x>D.length?D.length:x;if(N===D.length?E+=D:E+=D.slice(0,x),(x-=N)==0){N===D.length?(++M,w.next?this.head=w.next:this.head=this.tail=null):(this.head=w,w.data=D.slice(N));break}++M}return this.length-=M,E}},{key:"_getBuffer",value:function(x){var w=h.allocUnsafe(x),M=this.head,E=1;for(M.data.copy(w),x-=M.data.length;M=M.next;){var D=M.data,N=x>D.length?D.length:x;if(D.copy(w,w.length-x,0,N),(x-=N)==0){N===D.length?(++E,M.next?this.head=M.next:this.head=this.tail=null):(this.head=M,M.data=D.slice(N));break}++E}return this.length-=E,w}},{key:d,value:function(x,w){return f(this,o(o({},w),{},{depth:0,customInspect:!1}))}}])&&u(b.prototype,v),Object.defineProperty(b,"prototype",{writable:!1}),p}()},{buffer:220,util:188}],485:[function(e,i,s){(function(a){(function(){function o(l,h){u(l,h),r(l)}function r(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function u(l,h){l.emit("error",h)}i.exports={destroy:function(l,h){var f=this,d=this._readableState&&this._readableState.destroyed,p=this._writableState&&this._writableState.destroyed;return d||p?(h?h(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(u,this,l)):a.nextTick(u,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(b){!h&&b?f._writableState?f._writableState.errorEmitted?a.nextTick(r,f):(f._writableState.errorEmitted=!0,a.nextTick(o,f,b)):a.nextTick(o,f,b):h?(a.nextTick(r,f),h(b)):a.nextTick(r,f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(l,h){var f=l._readableState,d=l._writableState;f&&f.autoDestroy||d&&d.autoDestroy?l.destroy(h):l.emit("error",h)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,i,s){var a=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}i.exports=function r(u,l,h){if(typeof l=="function")return r(u,null,l);l||(l={}),h=function(N){var V=!1;return function(){if(!V){V=!0;for(var K=arguments.length,j=new Array(K),Z=0;Z<K;Z++)j[Z]=arguments[Z];N.apply(this,j)}}}(h||o);var f=l.readable||l.readable!==!1&&u.readable,d=l.writable||l.writable!==!1&&u.writable,p=function(){u.writable||v()},b=u._writableState&&u._writableState.finished,v=function(){d=!1,b=!0,f||h.call(u)},x=u._readableState&&u._readableState.endEmitted,w=function(){f=!1,x=!0,d||h.call(u)},M=function(N){h.call(u,N)},E=function(){var N;return f&&!x?(u._readableState&&u._readableState.ended||(N=new a),h.call(u,N)):d&&!b?(u._writableState&&u._writableState.ended||(N=new a),h.call(u,N)):void 0},D=function(){u.req.on("finish",v)};return function(N){return N.setHeader&&typeof N.abort=="function"}(u)?(u.on("complete",v),u.on("abort",E),u.req?D():u.on("request",D)):d&&!u._writableState&&(u.on("end",p),u.on("close",p)),u.on("end",w),u.on("finish",v),l.error!==!1&&u.on("error",M),u.on("close",E),function(){u.removeListener("complete",v),u.removeListener("abort",E),u.removeListener("request",D),u.req&&u.req.removeListener("finish",v),u.removeListener("end",p),u.removeListener("close",p),u.removeListener("finish",v),u.removeListener("end",w),u.removeListener("error",M),u.removeListener("close",E)}}},{"../../../errors":477}],487:[function(e,i,s){i.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,i,s){var a,o=e("../../../errors").codes,r=o.ERR_MISSING_ARGS,u=o.ERR_STREAM_DESTROYED;function l(b){if(b)throw b}function h(b,v,x,w){w=function(D){var N=!1;return function(){N||(N=!0,D.apply(void 0,arguments))}}(w);var M=!1;b.on("close",function(){M=!0}),a===void 0&&(a=e("./end-of-stream")),a(b,{readable:v,writable:x},function(D){if(D)return w(D);M=!0,w()});var E=!1;return function(D){if(!M&&!E)return E=!0,function(N){return N.setHeader&&typeof N.abort=="function"}(b)?b.abort():typeof b.destroy=="function"?b.destroy():void w(D||new u("pipe"))}}function f(b){b()}function d(b,v){return b.pipe(v)}function p(b){return b.length?typeof b[b.length-1]!="function"?l:b.pop():l}i.exports=function(){for(var b=arguments.length,v=new Array(b),x=0;x<b;x++)v[x]=arguments[x];var w,M=p(v);if(Array.isArray(v[0])&&(v=v[0]),v.length<2)throw new r("streams");var E=v.map(function(D,N){var V=N<v.length-1;return h(D,V,N>0,function(K){w||(w=K),K&&E.forEach(f),V||(E.forEach(f),M(w))})});return v.reduce(d)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,i,s){var a=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;i.exports={getHighWaterMark:function(o,r,u,l){var h=function(f,d,p){return f.highWaterMark!=null?f.highWaterMark:d?f[p]:null}(r,l,u);if(h!=null){if(!isFinite(h)||Math.floor(h)!==h||h<0)throw new a(l?u:"highWaterMark",h);return Math.floor(h)}return o.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,i,s){i.exports=e("events").EventEmitter},{events:422}],491:[function(e,i,s){(s=i.exports=e("./lib/_stream_readable.js")).Stream=s,s.Readable=s,s.Writable=e("./lib/_stream_writable.js"),s.Duplex=e("./lib/_stream_duplex.js"),s.Transform=e("./lib/_stream_transform.js"),s.PassThrough=e("./lib/_stream_passthrough.js"),s.finished=e("./lib/internal/streams/end-of-stream.js"),s.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,i,s){var a=function(o){var r=Object.prototype,u=r.hasOwnProperty,l=Object.defineProperty||function(B,O,q){B[O]=q.value},h=typeof Symbol=="function"?Symbol:{},f=h.iterator||"@@iterator",d=h.asyncIterator||"@@asyncIterator",p=h.toStringTag||"@@toStringTag";function b(B,O,q){return Object.defineProperty(B,O,{value:q,enumerable:!0,configurable:!0,writable:!0}),B[O]}try{b({},"")}catch(B){b=function(O,q,it){return O[q]=it}}function v(B,O,q,it){var nt=O&&O.prototype instanceof M?O:M,lt=Object.create(nt.prototype),ut=new I(it||[]);return l(lt,"_invoke",{value:rt(B,q,ut)}),lt}function x(B,O,q){try{return{type:"normal",arg:B.call(O,q)}}catch(it){return{type:"throw",arg:it}}}o.wrap=v;var w={};function M(){}function E(){}function D(){}var N={};b(N,f,function(){return this});var V=Object.getPrototypeOf,K=V&&V(V(C([])));K&&K!==r&&u.call(K,f)&&(N=K);var j=D.prototype=M.prototype=Object.create(N);function Z(B){["next","throw","return"].forEach(function(O){b(B,O,function(q){return this._invoke(O,q)})})}function tt(B,O){var q;l(this,"_invoke",{value:function(it,nt){function lt(){return new O(function(ut,vt){(function Q(gt,Y,H,at){var ft=x(B[gt],B,Y);if(ft.type!=="throw"){var wt=ft.arg,_t=wt.value;return _t&&typeof _t=="object"&&u.call(_t,"__await")?O.resolve(_t.__await).then(function(Dt){Q("next",Dt,H,at)},function(Dt){Q("throw",Dt,H,at)}):O.resolve(_t).then(function(Dt){wt.value=Dt,H(wt)},function(Dt){return Q("throw",Dt,H,at)})}at(ft.arg)})(it,nt,ut,vt)})}return q=q?q.then(lt,lt):lt()}})}function rt(B,O,q){var it="suspendedStart";return function(nt,lt){if(it==="executing")throw new Error("Generator is already running");if(it==="completed"){if(nt==="throw")throw lt;return L()}for(q.method=nt,q.arg=lt;;){var ut=q.delegate;if(ut){var vt=J(ut,q);if(vt){if(vt===w)continue;return vt}}if(q.method==="next")q.sent=q._sent=q.arg;else if(q.method==="throw"){if(it==="suspendedStart")throw it="completed",q.arg;q.dispatchException(q.arg)}else q.method==="return"&&q.abrupt("return",q.arg);it="executing";var Q=x(B,O,q);if(Q.type==="normal"){if(it=q.done?"completed":"suspendedYield",Q.arg===w)continue;return{value:Q.arg,done:q.done}}Q.type==="throw"&&(it="completed",q.method="throw",q.arg=Q.arg)}}}function J(B,O){var q=O.method,it=B.iterator[q];if(it===void 0)return O.delegate=null,q==="throw"&&B.iterator.return&&(O.method="return",O.arg=void 0,J(B,O),O.method==="throw")||q!=="return"&&(O.method="throw",O.arg=new TypeError("The iterator does not provide a '"+q+"' method")),w;var nt=x(it,B.iterator,O.arg);if(nt.type==="throw")return O.method="throw",O.arg=nt.arg,O.delegate=null,w;var lt=nt.arg;return lt?lt.done?(O[B.resultName]=lt.value,O.next=B.nextLoc,O.method!=="return"&&(O.method="next",O.arg=void 0),O.delegate=null,w):lt:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,w)}function U(B){var O={tryLoc:B[0]};1 in B&&(O.catchLoc=B[1]),2 in B&&(O.finallyLoc=B[2],O.afterLoc=B[3]),this.tryEntries.push(O)}function G(B){var O=B.completion||{};O.type="normal",delete O.arg,B.completion=O}function I(B){this.tryEntries=[{tryLoc:"root"}],B.forEach(U,this),this.reset(!0)}function C(B){if(B){var O=B[f];if(O)return O.call(B);if(typeof B.next=="function")return B;if(!isNaN(B.length)){var q=-1,it=function nt(){for(;++q<B.length;)if(u.call(B,q))return nt.value=B[q],nt.done=!1,nt;return nt.value=void 0,nt.done=!0,nt};return it.next=it}}return{next:L}}function L(){return{value:void 0,done:!0}}return E.prototype=D,l(j,"constructor",{value:D,configurable:!0}),l(D,"constructor",{value:E,configurable:!0}),E.displayName=b(D,p,"GeneratorFunction"),o.isGeneratorFunction=function(B){var O=typeof B=="function"&&B.constructor;return!!O&&(O===E||(O.displayName||O.name)==="GeneratorFunction")},o.mark=function(B){return Object.setPrototypeOf?Object.setPrototypeOf(B,D):(B.__proto__=D,b(B,p,"GeneratorFunction")),B.prototype=Object.create(j),B},o.awrap=function(B){return{__await:B}},Z(tt.prototype),b(tt.prototype,d,function(){return this}),o.AsyncIterator=tt,o.async=function(B,O,q,it,nt){nt===void 0&&(nt=Promise);var lt=new tt(v(B,O,q,it),nt);return o.isGeneratorFunction(O)?lt:lt.next().then(function(ut){return ut.done?ut.value:lt.next()})},Z(j),b(j,p,"Generator"),b(j,f,function(){return this}),b(j,"toString",function(){return"[object Generator]"}),o.keys=function(B){var O=Object(B),q=[];for(var it in O)q.push(it);return q.reverse(),function nt(){for(;q.length;){var lt=q.pop();if(lt in O)return nt.value=lt,nt.done=!1,nt}return nt.done=!0,nt}},o.values=C,I.prototype={constructor:I,reset:function(B){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(G),!B)for(var O in this)O.charAt(0)==="t"&&u.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=void 0)},stop:function(){this.done=!0;var B=this.tryEntries[0].completion;if(B.type==="throw")throw B.arg;return this.rval},dispatchException:function(B){if(this.done)throw B;var O=this;function q(Q,gt){return lt.type="throw",lt.arg=B,O.next=Q,gt&&(O.method="next",O.arg=void 0),!!gt}for(var it=this.tryEntries.length-1;it>=0;--it){var nt=this.tryEntries[it],lt=nt.completion;if(nt.tryLoc==="root")return q("end");if(nt.tryLoc<=this.prev){var ut=u.call(nt,"catchLoc"),vt=u.call(nt,"finallyLoc");if(ut&&vt){if(this.prev<nt.catchLoc)return q(nt.catchLoc,!0);if(this.prev<nt.finallyLoc)return q(nt.finallyLoc)}else if(ut){if(this.prev<nt.catchLoc)return q(nt.catchLoc,!0)}else{if(!vt)throw new Error("try statement without catch or finally");if(this.prev<nt.finallyLoc)return q(nt.finallyLoc)}}}},abrupt:function(B,O){for(var q=this.tryEntries.length-1;q>=0;--q){var it=this.tryEntries[q];if(it.tryLoc<=this.prev&&u.call(it,"finallyLoc")&&this.prev<it.finallyLoc){var nt=it;break}}nt&&(B==="break"||B==="continue")&&nt.tryLoc<=O&&O<=nt.finallyLoc&&(nt=null);var lt=nt?nt.completion:{};return lt.type=B,lt.arg=O,nt?(this.method="next",this.next=nt.finallyLoc,w):this.complete(lt)},complete:function(B,O){if(B.type==="throw")throw B.arg;return B.type==="break"||B.type==="continue"?this.next=B.arg:B.type==="return"?(this.rval=this.arg=B.arg,this.method="return",this.next="end"):B.type==="normal"&&O&&(this.next=O),w},finish:function(B){for(var O=this.tryEntries.length-1;O>=0;--O){var q=this.tryEntries[O];if(q.finallyLoc===B)return this.complete(q.completion,q.afterLoc),G(q),w}},catch:function(B){for(var O=this.tryEntries.length-1;O>=0;--O){var q=this.tryEntries[O];if(q.tryLoc===B){var it=q.completion;if(it.type==="throw"){var nt=it.arg;G(q)}return nt}}throw new Error("illegal catch attempt")},delegateYield:function(B,O,q){return this.delegate={iterator:C(B),resultName:O,nextLoc:q},this.method==="next"&&(this.arg=void 0),w}},o}(typeof i=="object"?i.exports:{});try{regeneratorRuntime=a}catch(o){typeof globalThis=="object"?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}},{}],493:[function(e,i,s){var a=e("buffer").Buffer,o=e("inherits"),r=e("hash-base"),u=new Array(16),l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],d=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],p=[0,1518500249,1859775393,2400959708,2840853838],b=[1352829926,1548603684,1836072691,2053994217,0];function v(){r.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function x(V,K){return V<<K|V>>>32-K}function w(V,K,j,Z,tt,rt,J,U){return x(V+(K^j^Z)+rt+J|0,U)+tt|0}function M(V,K,j,Z,tt,rt,J,U){return x(V+(K&j|~K&Z)+rt+J|0,U)+tt|0}function E(V,K,j,Z,tt,rt,J,U){return x(V+((K|~j)^Z)+rt+J|0,U)+tt|0}function D(V,K,j,Z,tt,rt,J,U){return x(V+(K&Z|j&~Z)+rt+J|0,U)+tt|0}function N(V,K,j,Z,tt,rt,J,U){return x(V+(K^(j|~Z))+rt+J|0,U)+tt|0}o(v,r),v.prototype._update=function(){for(var V=u,K=0;K<16;++K)V[K]=this._block.readInt32LE(4*K);for(var j=0|this._a,Z=0|this._b,tt=0|this._c,rt=0|this._d,J=0|this._e,U=0|this._a,G=0|this._b,I=0|this._c,C=0|this._d,L=0|this._e,B=0;B<80;B+=1){var O,q;B<16?(O=w(j,Z,tt,rt,J,V[l[B]],p[0],f[B]),q=N(U,G,I,C,L,V[h[B]],b[0],d[B])):B<32?(O=M(j,Z,tt,rt,J,V[l[B]],p[1],f[B]),q=D(U,G,I,C,L,V[h[B]],b[1],d[B])):B<48?(O=E(j,Z,tt,rt,J,V[l[B]],p[2],f[B]),q=E(U,G,I,C,L,V[h[B]],b[2],d[B])):B<64?(O=D(j,Z,tt,rt,J,V[l[B]],p[3],f[B]),q=M(U,G,I,C,L,V[h[B]],b[3],d[B])):(O=N(j,Z,tt,rt,J,V[l[B]],p[4],f[B]),q=w(U,G,I,C,L,V[h[B]],b[4],d[B])),j=J,J=rt,rt=x(tt,10),tt=Z,Z=O,U=L,L=C,C=x(I,10),I=G,G=q}var it=this._b+tt+C|0;this._b=this._c+rt+L|0,this._c=this._d+J+U|0,this._d=this._e+j+G|0,this._e=this._a+Z+I|0,this._a=it},v.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var V=a.alloc?a.alloc(20):new a(20);return V.writeInt32LE(this._a,0),V.writeInt32LE(this._b,4),V.writeInt32LE(this._c,8),V.writeInt32LE(this._d,12),V.writeInt32LE(this._e,16),V},i.exports=v},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,i,s){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var a=e("buffer"),o=a.Buffer;function r(l,h){for(var f in l)h[f]=l[f]}function u(l,h,f){return o(l,h,f)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?i.exports=a:(r(a,s),s.Buffer=u),u.prototype=Object.create(o.prototype),r(o,u),u.from=function(l,h,f){if(typeof l=="number")throw new TypeError("Argument must not be a number");return o(l,h,f)},u.alloc=function(l,h,f){if(typeof l!="number")throw new TypeError("Argument must be a number");var d=o(l);return h!==void 0?typeof f=="string"?d.fill(h,f):d.fill(h):d.fill(0),d},u.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o(l)},u.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(l)}},{buffer:220}],495:[function(e,i,s){(function(a){(function(){var o,r=e("buffer"),u=r.Buffer,l={};for(o in r)r.hasOwnProperty(o)&&o!=="SlowBuffer"&&o!=="Buffer"&&(l[o]=r[o]);var h=l.Buffer={};for(o in u)u.hasOwnProperty(o)&&o!=="allocUnsafe"&&o!=="allocUnsafeSlow"&&(h[o]=u[o]);if(l.Buffer.prototype=u.prototype,h.from&&h.from!==Uint8Array.from||(h.from=function(f,d,p){if(typeof f=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof f);if(f&&f.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);return u(f,d,p)}),h.alloc||(h.alloc=function(f,d,p){if(typeof f!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof f);if(f<0||f>=2*(1<<30))throw new RangeError('The value "'+f+'" is invalid for option "size"');var b=u(f);return d&&d.length!==0?typeof p=="string"?b.fill(d,p):b.fill(d):b.fill(0),b}),!l.kStringMaxLength)try{l.kStringMaxLength=a.binding("buffer").kStringMaxLength}catch(f){}l.constants||(l.constants={MAX_LENGTH:l.kMaxLength},l.kStringMaxLength&&(l.constants.MAX_STRING_LENGTH=l.kStringMaxLength)),i.exports=l}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0});const a=e("xmlchars/xml/1.0/ed5"),o=e("xmlchars/xml/1.1/ed2"),r=e("xmlchars/xmlns/1.0/ed3");var u=a.isS,l=a.isChar,h=a.isNameStartChar,f=a.isNameChar,d=a.S_LIST,p=a.NAME_RE,b=o.isChar,v=r.isNCNameStartChar,x=r.isNCNameChar,w=r.NC_NAME_RE;const M="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",D={__proto__:null,xml:M,xmlns:E},N={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},V=C=>C===34||C===39,K=[34,39],j=[...K,91,62],Z=[...K,60,93],tt=[61,63,...d],rt=[...d,62,38,60];function J(C,L,B){switch(L){case"xml":B!==M&&C.fail(`xml prefix must be bound to ${M}.`);break;case"xmlns":B!==E&&C.fail(`xmlns prefix must be bound to ${E}.`)}switch(B){case E:C.fail(L===""?`the default namespace may not be set to ${B}.`:`may not assign a prefix (even "xmlns") to the URI ${E}.`);break;case M:switch(L){case"xml":break;case"":C.fail(`the default namespace may not be set to ${B}.`);break;default:C.fail("may not assign the xml namespace to another prefix.")}}}const U=C=>w.test(C),G=C=>p.test(C);s.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const I={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};s.SaxesParser=class{constructor(C){this.opt=C!=null?C:{},this.fragmentOpt=!!this.opt.fragment;const L=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,L){this.nameStartCheck=v,this.nameCheck=x,this.isName=U,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},D);const B=this.opt.additionalNamespaces;B!=null&&(function(O,q){for(const it of Object.keys(q))J(O,it,q[it])}(this,B),Object.assign(this.ns,B))}else this.nameStartCheck=h,this.nameCheck=f,this.isName=G,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var C;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:L}=this;this.state=L?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=L,this.xmlDeclPossible=!L,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:B}=this.opt;if(B===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");B="1.0"}this.setXMLVersion(B),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(N),(C=this.readyHandler)===null||C===void 0||C.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(C,L){this[I[C]]=L}off(C){this[I[C]]=void 0}makeError(C){var L;let B=(L=this.fileName)!==null&&L!==void 0?L:"";return this.trackPosition&&(B.length>0&&(B+=":"),B+=`${this.line}:${this.column}`),B.length>0&&(B+=": "),new Error(B+C)}fail(C){const L=this.makeError(C),B=this.errorHandler;if(B===void 0)throw L;return B(L),this}write(C){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let L=!1;C===null?(L=!0,C=""):typeof C=="object"&&(C=C.toString()),this.carriedFromPrevious!==void 0&&(C=`${this.carriedFromPrevious}${C}`,this.carriedFromPrevious=void 0);let B=C.length;const O=C.charCodeAt(B-1);!L&&(O===13||O>=55296&&O<=56319)&&(this.carriedFromPrevious=C[B-1],B--,C=C.slice(0,B));const{stateTable:q}=this;for(this.chunk=C,this.i=0;this.i<B;)q[this.state].call(this);return this.chunkPosition+=B,L?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:C,i:L}=this;if(this.prevI=L,this.i=L+1,L>=C.length)return-1;const B=C.charCodeAt(L);if(this.column++,B<55296){if(B>=32||B===9)return B;switch(B){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return C.charCodeAt(L+1)===10&&(this.i=L+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),B}}if(B>56319)return B>=57344&&B<=65533||this.fail("disallowed character."),B;const O=65536+1024*(B-55296)+(C.charCodeAt(L+1)-56320);return this.i=L+2,O>1114111&&this.fail("disallowed character."),O}getCode11(){const{chunk:C,i:L}=this;if(this.prevI=L,this.i=L+1,L>=C.length)return-1;const B=C.charCodeAt(L);if(this.column++,B<55296){if(B>31&&B<127||B>159&&B!==8232||B===9)return B;switch(B){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const q=C.charCodeAt(L+1);q!==10&&q!==133||(this.i=L+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),B}}if(B>56319)return B>=57344&&B<=65533||this.fail("disallowed character."),B;const O=65536+1024*(B-55296)+(C.charCodeAt(L+1)-56320);return this.i=L+2,O>1114111&&this.fail("disallowed character."),O}getCodeNorm(){const C=this.getCode();return C===-2?10:C}unget(){this.i=this.prevI,this.column--}captureTo(C){let{i:L}=this;const{chunk:B}=this;for(;;){const O=this.getCode(),q=O===-2,it=q?10:O;if(it===-1||C.includes(it))return this.text+=B.slice(L,this.prevI),it;q&&(this.text+=B.slice(L,this.prevI)+`
`,L=this.i)}}captureToChar(C){let{i:L}=this;const{chunk:B}=this;for(;;){let O=this.getCode();switch(O){case-2:this.text+=B.slice(L,this.prevI)+`
`,L=this.i,O=10;break;case-1:return this.text+=B.slice(L),!1}if(O===C)return this.text+=B.slice(L,this.prevI),!0}}captureNameChars(){const{chunk:C,i:L}=this;for(;;){const B=this.getCode();if(B===-1)return this.name+=C.slice(L),-1;if(!f(B))return this.name+=C.slice(L,this.prevI),B===-2?10:B}}skipSpaces(){for(;;){const C=this.getCodeNorm();if(C===-1||!u(C))return C}}setXMLVersion(C){this.currentXMLVersion=C,C==="1.0"?(this.isChar=l,this.getCode=this.getCode10):(this.isChar=b,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const C=this.i,L=this.skipSpaces();switch(this.prevI!==C&&(this.xmlDeclPossible=!1),L){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var C;const L=this.captureTo(j);switch(L){case 62:(C=this.doctypeHandler)===null||C===void 0||C.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(L),L===91?this.state=4:V(L)&&(this.state=3,this.q=L)}}sDoctypeQuote(){const C=this.q;this.captureToChar(C)&&(this.text+=String.fromCodePoint(C),this.q=null,this.state=2)}sDTD(){const C=this.captureTo(Z);C!==-1&&(this.text+=String.fromCodePoint(C),C===93?this.state=2:C===60?this.state=6:V(C)&&(this.state=5,this.q=C))}sDTDQuoted(){const C=this.q;this.captureToChar(C)&&(this.text+=String.fromCodePoint(C),this.state=4,this.q=null)}sDTDOpenWaka(){const C=this.getCodeNorm();switch(this.text+=String.fromCodePoint(C),C){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const C=String.fromCodePoint(this.getCodeNorm()),L=this.openWakaBang+=C;this.text+=C,L!=="-"&&(this.state=L==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const C=this.getCodeNorm();this.text+=String.fromCodePoint(C),this.state=C===45?10:8}sDTDCommentEnded(){const C=this.getCodeNorm();this.text+=String.fromCodePoint(C),C===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const C=this.getCodeNorm();this.text+=String.fromCodePoint(C),C===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:C}=this;const{chunk:L}=this;t:for(;;)switch(this.getCode()){case-2:this.entity+=L.slice(C,this.prevI)+`
`,C=this.i;break;case 59:{const{entityReturnState:B}=this,O=this.entity+L.slice(C,this.prevI);let q;this.state=B,O===""?(this.fail("empty entity name."),q="&;"):(q=this.parseEntity(O),this.entity=""),B===13&&this.textHandler===void 0||(this.text+=q);break t}case-1:this.entity+=L.slice(C);break t}}sOpenWaka(){const C=this.getCode();if(h(C))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(C){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var C;const L=this.getCodeNorm();L===45?(this.state=19,(C=this.commentHandler)===null||C===void 0||C.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(L),this.state=17)}sCommentEnded(){const C=this.getCodeNorm();C!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(C),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const C=this.getCodeNorm();C===93?this.state=22:(this.text+="]"+String.fromCodePoint(C),this.state=20)}sCDataEnding2(){var C;const L=this.getCodeNorm();switch(L){case 62:(C=this.cdataHandler)===null||C===void 0||C.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(L),this.state=20}}sPIFirstChar(){const C=this.getCodeNorm();this.nameStartCheck(C)?(this.piTarget+=String.fromCodePoint(C),this.state=24):C===63||u(C)?(this.fail("processing instruction without a target."),this.state=C===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(C),this.state=24)}sPIRest(){const{chunk:C,i:L}=this;for(;;){const B=this.getCodeNorm();if(B===-1)return void(this.piTarget+=C.slice(L));if(!this.nameCheck(B)){this.piTarget+=C.slice(L,this.prevI);const O=B===63;O||u(B)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=O?33:27):this.state=O?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(B));break}}}sPIBody(){if(this.text.length===0){const C=this.getCodeNorm();C===63?this.state=26:u(C)||(this.text=String.fromCodePoint(C))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var C;const L=this.getCodeNorm();if(L===62){const{piTarget:B}=this;B.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(C=this.piHandler)===null||C===void 0||C.call(this,{target:B,body:this.text}),this.piTarget=this.text="",this.state=13}else L===63?this.text+="?":(this.text+="?"+String.fromCodePoint(L),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const C=this.skipSpaces();C!==63?C!==-1&&(this.state=28,this.name=String.fromCodePoint(C)):this.state=33}sXMLDeclName(){const C=this.captureTo(tt);if(C===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(u(C)||C===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=C===61?30:29}}sXMLDeclEq(){const C=this.getCodeNorm();if(C===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(C)||(C!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const C=this.getCodeNorm();if(C===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(C)||(V(C)?this.q=C:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const C=this.captureTo([this.q,63]);if(C===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(C===-1)return;const L=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const B=L;this.xmlDecl.version=B,/^1\.[0-9]+$/.test(B)?this.opt.forceXMLVersion||this.setXMLVersion(B):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(L)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=L;break;case"standalone":L!=="yes"&&L!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=L}this.name="",this.state=32}sXMLDeclSeparator(){const C=this.getCodeNorm();C!==63?(u(C)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var C;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(C=this.xmldeclHandler)===null||C===void 0||C.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var C;const L=this.captureNameChars();if(L===-1)return;const B=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=B.ns=Object.create(null)),(C=this.openTagStartHandler)===null||C===void 0||C.call(this,B),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),L){case 62:this.openTag();break;case 47:this.state=35;break;default:u(L)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const C=this.skipSpaces();C!==-1&&(h(C)?(this.unget(),this.state=37):C===62?this.openTag():C===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const C=this.captureNameChars();C===61?this.state=39:u(C)?this.state=38:C===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):C!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const C=this.skipSpaces();switch(C){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",C===62?this.openTag():h(C)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const C=this.getCodeNorm();V(C)?(this.q=C,this.state=40):u(C)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:C,chunk:L}=this;let{i:B}=this;for(;;)switch(this.getCode()){case C:return this.pushAttrib(this.name,this.text+L.slice(B,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=L.slice(B,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=L.slice(B,this.prevI)+" ",B=this.i;break;case 60:return this.text+=L.slice(B,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=L.slice(B))}}sAttribValueClosed(){const C=this.getCodeNorm();u(C)?this.state=36:C===62?this.openTag():C===47?this.state=35:h(C)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const C=this.captureTo(rt);switch(C){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",C===62?this.openTag():this.state=36}}sCloseTag(){const C=this.captureNameChars();C===62?this.closeTag():u(C)?this.state=44:C!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:C,forbiddenState:L}=this;const{chunk:B,textHandler:O}=this;t:for(;;)switch(this.getCode()){case 60:if(this.state=15,O!==void 0){const{text:q}=this,it=B.slice(C,this.prevI);q.length!==0?(O(q+it),this.text=""):it.length!==0&&O(it)}L=0;break t;case 38:this.state=14,this.entityReturnState=13,O!==void 0&&(this.text+=B.slice(C,this.prevI)),L=0;break t;case 93:switch(L){case 0:L=1;break;case 1:L=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:L===2&&this.fail('the string "]]>" is disallowed in char data.'),L=0;break;case-2:O!==void 0&&(this.text+=B.slice(C,this.prevI)+`
`),C=this.i,L=0;break;case-1:O!==void 0&&(this.text+=B.slice(C));break t;default:L=0}this.forbiddenState=L}handleTextOutsideRoot(){let{i:C}=this;const{chunk:L,textHandler:B}=this;let O=!1;t:for(;;){const q=this.getCode();switch(q){case 60:if(this.state=15,B!==void 0){const{text:it}=this,nt=L.slice(C,this.prevI);it.length!==0?(B(it+nt),this.text=""):nt.length!==0&&B(nt)}break t;case 38:this.state=14,this.entityReturnState=13,B!==void 0&&(this.text+=L.slice(C,this.prevI)),O=!0;break t;case-2:B!==void 0&&(this.text+=L.slice(C,this.prevI)+`
`),C=this.i;break;case-1:B!==void 0&&(this.text+=L.slice(C));break t;default:u(q)||(O=!0)}}O&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(C,L){var B;const{prefix:O,local:q}=this.qname(C),it={name:C,prefix:O,local:q,value:L};if(this.attribList.push(it),(B=this.attributeHandler)===null||B===void 0||B.call(this,it),O==="xmlns"){const nt=L.trim();this.currentXMLVersion==="1.0"&&nt===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[q]=nt,J(this,q,nt)}else if(C==="xmlns"){const nt=L.trim();this.topNS[""]=nt,J(this,"",nt)}}pushAttribPlain(C,L){var B;const O={name:C,value:L};this.attribList.push(O),(B=this.attributeHandler)===null||B===void 0||B.call(this,O)}end(){var C,L;this.sawRoot||this.fail("document must contain a root element.");const{tags:B}=this;for(;B.length>0;){const q=B.pop();this.fail("unclosed tag: "+q.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:O}=this;return O.length!==0&&((C=this.textHandler)===null||C===void 0||C.call(this,O),this.text=""),this._closed=!0,(L=this.endHandler)===null||L===void 0||L.call(this),this._init(),this}resolve(C){var L,B;let O=this.topNS[C];if(O!==void 0)return O;const{tags:q}=this;for(let it=q.length-1;it>=0;it--)if(O=q[it].ns[C],O!==void 0)return O;return O=this.ns[C],O!==void 0?O:(B=(L=this.opt).resolvePrefix)===null||B===void 0?void 0:B.call(L,C)}qname(C){const L=C.indexOf(":");if(L===-1)return{prefix:"",local:C};const B=C.slice(L+1),O=C.slice(0,L);return(O===""||B===""||B.includes(":"))&&this.fail(`malformed name: ${C}.`),{prefix:O,local:B}}processAttribsNS(){var C;const{attribList:L}=this,B=this.tag;{const{prefix:it,local:nt}=this.qname(B.name);B.prefix=it,B.local=nt;const lt=B.uri=(C=this.resolve(it))!==null&&C!==void 0?C:"";it!==""&&(it==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),lt===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(it)}.`),B.uri=it))}if(L.length===0)return;const{attributes:O}=B,q=new Set;for(const it of L){const{name:nt,prefix:lt,local:ut}=it;let vt,Q;lt===""?(vt=nt==="xmlns"?E:"",Q=nt):(vt=this.resolve(lt),vt===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(lt)}.`),vt=lt),Q=`{${vt}}${ut}`),q.has(Q)&&this.fail(`duplicate attribute: ${Q}.`),q.add(Q),it.uri=vt,O[nt]=it}this.attribList=[]}processAttribsPlain(){const{attribList:C}=this,L=this.tag.attributes;for(const{name:B,value:O}of C)L[B]!==void 0&&this.fail(`duplicate attribute: ${B}.`),L[B]=O;this.attribList=[]}openTag(){var C;this.processAttribs();const{tags:L}=this,B=this.tag;B.isSelfClosing=!1,(C=this.openTagHandler)===null||C===void 0||C.call(this,B),L.push(B),this.state=13,this.name=""}openSelfClosingTag(){var C,L,B;this.processAttribs();const{tags:O}=this,q=this.tag;q.isSelfClosing=!0,(C=this.openTagHandler)===null||C===void 0||C.call(this,q),(L=this.closeTagHandler)===null||L===void 0||L.call(this,q),(this.tag=(B=O[O.length-1])!==null&&B!==void 0?B:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:C,name:L}=this;if(this.state=13,this.name="",L==="")return this.fail("weird empty close tag."),void(this.text+="</>");const B=this.closeTagHandler;let O=C.length;for(;O-- >0;){const q=this.tag=C.pop();if(this.topNS=q.ns,B==null||B(q),q.name===L)break;this.fail("unexpected close tag.")}O===0?this.closedRoot=!0:O<0&&(this.fail(`unmatched closing tag: ${L}.`),this.text+=`</${L}>`)}parseEntity(C){if(C[0]!=="#"){const B=this.ENTITIES[C];return B!==void 0?B:(this.fail(this.isName(C)?"undefined entity.":"disallowed character in entity name."),`&${C};`)}let L=NaN;return C[1]==="x"&&/^#x[0-9a-f]+$/i.test(C)?L=parseInt(C.slice(2),16):/^#[0-9]+$/.test(C)&&(L=parseInt(C.slice(1),10)),this.isChar(L)?String.fromCodePoint(L):(this.fail("malformed character entity."),`&${C};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,i,s){var a=e("safe-buffer").Buffer;function o(r,u){this._block=a.alloc(r),this._finalSize=u,this._blockSize=r,this._len=0}o.prototype.update=function(r,u){typeof r=="string"&&(u=u||"utf8",r=a.from(r,u));for(var l=this._block,h=this._blockSize,f=r.length,d=this._len,p=0;p<f;){for(var b=d%h,v=Math.min(f-p,h-b),x=0;x<v;x++)l[b+x]=r[p+x];p+=v,(d+=v)%h==0&&this._update(l)}return this._len+=f,this},o.prototype.digest=function(r){var u=this._len%this._blockSize;this._block[u]=128,this._block.fill(0,u+1),u>=this._finalSize&&(this._update(this._block),this._block.fill(0));var l=8*this._len;if(l<=4294967295)this._block.writeUInt32BE(l,this._blockSize-4);else{var h=(4294967295&l)>>>0,f=(l-h)/4294967296;this._block.writeUInt32BE(f,this._blockSize-8),this._block.writeUInt32BE(h,this._blockSize-4)}this._update(this._block);var d=this._hash();return r?d.toString(r):d},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},i.exports=o},{"safe-buffer":494}],498:[function(e,i,s){var a=i.exports=function(o){o=o.toLowerCase();var r=a[o];if(!r)throw new Error(o+" is not supported (we accept pull requests)");return new r};a.sha=e("./sha"),a.sha1=e("./sha1"),a.sha224=e("./sha224"),a.sha256=e("./sha256"),a.sha384=e("./sha384"),a.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,i,s){var a=e("inherits"),o=e("./hash"),r=e("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function h(){this.init(),this._w=l,o.call(this,64,56)}function f(p){return p<<30|p>>>2}function d(p,b,v,x){return p===0?b&v|~b&x:p===2?b&v|b&x|v&x:b^v^x}a(h,o),h.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},h.prototype._update=function(p){for(var b,v=this._w,x=0|this._a,w=0|this._b,M=0|this._c,E=0|this._d,D=0|this._e,N=0;N<16;++N)v[N]=p.readInt32BE(4*N);for(;N<80;++N)v[N]=v[N-3]^v[N-8]^v[N-14]^v[N-16];for(var V=0;V<80;++V){var K=~~(V/20),j=0|((b=x)<<5|b>>>27)+d(K,w,M,E)+D+v[V]+u[K];D=E,E=M,M=f(w),w=x,x=j}this._a=x+this._a|0,this._b=w+this._b|0,this._c=M+this._c|0,this._d=E+this._d|0,this._e=D+this._e|0},h.prototype._hash=function(){var p=r.allocUnsafe(20);return p.writeInt32BE(0|this._a,0),p.writeInt32BE(0|this._b,4),p.writeInt32BE(0|this._c,8),p.writeInt32BE(0|this._d,12),p.writeInt32BE(0|this._e,16),p},i.exports=h},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,i,s){var a=e("inherits"),o=e("./hash"),r=e("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function h(){this.init(),this._w=l,o.call(this,64,56)}function f(b){return b<<5|b>>>27}function d(b){return b<<30|b>>>2}function p(b,v,x,w){return b===0?v&x|~v&w:b===2?v&x|v&w|x&w:v^x^w}a(h,o),h.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},h.prototype._update=function(b){for(var v,x=this._w,w=0|this._a,M=0|this._b,E=0|this._c,D=0|this._d,N=0|this._e,V=0;V<16;++V)x[V]=b.readInt32BE(4*V);for(;V<80;++V)x[V]=(v=x[V-3]^x[V-8]^x[V-14]^x[V-16])<<1|v>>>31;for(var K=0;K<80;++K){var j=~~(K/20),Z=f(w)+p(j,M,E,D)+N+x[K]+u[j]|0;N=D,D=E,E=d(M),M=w,w=Z}this._a=w+this._a|0,this._b=M+this._b|0,this._c=E+this._c|0,this._d=D+this._d|0,this._e=N+this._e|0},h.prototype._hash=function(){var b=r.allocUnsafe(20);return b.writeInt32BE(0|this._a,0),b.writeInt32BE(0|this._b,4),b.writeInt32BE(0|this._c,8),b.writeInt32BE(0|this._d,12),b.writeInt32BE(0|this._e,16),b},i.exports=h},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,i,s){var a=e("inherits"),o=e("./sha256"),r=e("./hash"),u=e("safe-buffer").Buffer,l=new Array(64);function h(){this.init(),this._w=l,r.call(this,64,56)}a(h,o),h.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},h.prototype._hash=function(){var f=u.allocUnsafe(28);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f},i.exports=h},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,i,s){var a=e("inherits"),o=e("./hash"),r=e("safe-buffer").Buffer,u=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=new Array(64);function h(){this.init(),this._w=l,o.call(this,64,56)}function f(x,w,M){return M^x&(w^M)}function d(x,w,M){return x&w|M&(x|w)}function p(x){return(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10)}function b(x){return(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7)}function v(x){return(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3}a(h,o),h.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},h.prototype._update=function(x){for(var w,M=this._w,E=0|this._a,D=0|this._b,N=0|this._c,V=0|this._d,K=0|this._e,j=0|this._f,Z=0|this._g,tt=0|this._h,rt=0;rt<16;++rt)M[rt]=x.readInt32BE(4*rt);for(;rt<64;++rt)M[rt]=0|(((w=M[rt-2])>>>17|w<<15)^(w>>>19|w<<13)^w>>>10)+M[rt-7]+v(M[rt-15])+M[rt-16];for(var J=0;J<64;++J){var U=tt+b(K)+f(K,j,Z)+u[J]+M[J]|0,G=p(E)+d(E,D,N)|0;tt=Z,Z=j,j=K,K=V+U|0,V=N,N=D,D=E,E=U+G|0}this._a=E+this._a|0,this._b=D+this._b|0,this._c=N+this._c|0,this._d=V+this._d|0,this._e=K+this._e|0,this._f=j+this._f|0,this._g=Z+this._g|0,this._h=tt+this._h|0},h.prototype._hash=function(){var x=r.allocUnsafe(32);return x.writeInt32BE(this._a,0),x.writeInt32BE(this._b,4),x.writeInt32BE(this._c,8),x.writeInt32BE(this._d,12),x.writeInt32BE(this._e,16),x.writeInt32BE(this._f,20),x.writeInt32BE(this._g,24),x.writeInt32BE(this._h,28),x},i.exports=h},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,i,s){var a=e("inherits"),o=e("./sha512"),r=e("./hash"),u=e("safe-buffer").Buffer,l=new Array(160);function h(){this.init(),this._w=l,r.call(this,128,112)}a(h,o),h.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},h.prototype._hash=function(){var f=u.allocUnsafe(48);function d(p,b,v){f.writeInt32BE(p,v),f.writeInt32BE(b,v+4)}return d(this._ah,this._al,0),d(this._bh,this._bl,8),d(this._ch,this._cl,16),d(this._dh,this._dl,24),d(this._eh,this._el,32),d(this._fh,this._fl,40),f},i.exports=h},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,i,s){var a=e("inherits"),o=e("./hash"),r=e("safe-buffer").Buffer,u=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=new Array(160);function h(){this.init(),this._w=l,o.call(this,128,112)}function f(D,N,V){return V^D&(N^V)}function d(D,N,V){return D&N|V&(D|N)}function p(D,N){return(D>>>28|N<<4)^(N>>>2|D<<30)^(N>>>7|D<<25)}function b(D,N){return(D>>>14|N<<18)^(D>>>18|N<<14)^(N>>>9|D<<23)}function v(D,N){return(D>>>1|N<<31)^(D>>>8|N<<24)^D>>>7}function x(D,N){return(D>>>1|N<<31)^(D>>>8|N<<24)^(D>>>7|N<<25)}function w(D,N){return(D>>>19|N<<13)^(N>>>29|D<<3)^D>>>6}function M(D,N){return(D>>>19|N<<13)^(N>>>29|D<<3)^(D>>>6|N<<26)}function E(D,N){return D>>>0<N>>>0?1:0}a(h,o),h.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},h.prototype._update=function(D){for(var N=this._w,V=0|this._ah,K=0|this._bh,j=0|this._ch,Z=0|this._dh,tt=0|this._eh,rt=0|this._fh,J=0|this._gh,U=0|this._hh,G=0|this._al,I=0|this._bl,C=0|this._cl,L=0|this._dl,B=0|this._el,O=0|this._fl,q=0|this._gl,it=0|this._hl,nt=0;nt<32;nt+=2)N[nt]=D.readInt32BE(4*nt),N[nt+1]=D.readInt32BE(4*nt+4);for(;nt<160;nt+=2){var lt=N[nt-30],ut=N[nt-30+1],vt=v(lt,ut),Q=x(ut,lt),gt=w(lt=N[nt-4],ut=N[nt-4+1]),Y=M(ut,lt),H=N[nt-14],at=N[nt-14+1],ft=N[nt-32],wt=N[nt-32+1],_t=Q+at|0,Dt=vt+H+E(_t,Q)|0;Dt=(Dt=Dt+gt+E(_t=_t+Y|0,Y)|0)+ft+E(_t=_t+wt|0,wt)|0,N[nt]=Dt,N[nt+1]=_t}for(var Gt=0;Gt<160;Gt+=2){Dt=N[Gt],_t=N[Gt+1];var te=d(V,K,j),mt=d(G,I,C),At=p(V,G),Ot=p(G,V),Zt=b(tt,B),he=b(B,tt),fe=u[Gt],be=u[Gt+1],Me=f(tt,rt,J),Pe=f(B,O,q),ze=it+he|0,Ce=U+Zt+E(ze,it)|0;Ce=(Ce=(Ce=Ce+Me+E(ze=ze+Pe|0,Pe)|0)+fe+E(ze=ze+be|0,be)|0)+Dt+E(ze=ze+_t|0,_t)|0;var Le=Ot+mt|0,Ye=At+te+E(Le,Ot)|0;U=J,it=q,J=rt,q=O,rt=tt,O=B,tt=Z+Ce+E(B=L+ze|0,L)|0,Z=j,L=C,j=K,C=I,K=V,I=G,V=Ce+Ye+E(G=ze+Le|0,ze)|0}this._al=this._al+G|0,this._bl=this._bl+I|0,this._cl=this._cl+C|0,this._dl=this._dl+L|0,this._el=this._el+B|0,this._fl=this._fl+O|0,this._gl=this._gl+q|0,this._hl=this._hl+it|0,this._ah=this._ah+V+E(this._al,G)|0,this._bh=this._bh+K+E(this._bl,I)|0,this._ch=this._ch+j+E(this._cl,C)|0,this._dh=this._dh+Z+E(this._dl,L)|0,this._eh=this._eh+tt+E(this._el,B)|0,this._fh=this._fh+rt+E(this._fl,O)|0,this._gh=this._gh+J+E(this._gl,q)|0,this._hh=this._hh+U+E(this._hl,it)|0},h.prototype._hash=function(){var D=r.allocUnsafe(64);function N(V,K,j){D.writeInt32BE(V,j),D.writeInt32BE(K,j+4)}return N(this._ah,this._al,0),N(this._bh,this._bl,8),N(this._ch,this._cl,16),N(this._dh,this._dl,24),N(this._eh,this._el,32),N(this._fh,this._fl,40),N(this._gh,this._gl,48),N(this._hh,this._hl,56),D},i.exports=h},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,i,s){i.exports=o;var a=e("events").EventEmitter;function o(){a.call(this)}e("inherits")(o,a),o.Readable=e("readable-stream/readable.js"),o.Writable=e("readable-stream/writable.js"),o.Duplex=e("readable-stream/duplex.js"),o.Transform=e("readable-stream/transform.js"),o.PassThrough=e("readable-stream/passthrough.js"),o.Stream=o,o.prototype.pipe=function(r,u){var l=this;function h(w){r.writable&&r.write(w)===!1&&l.pause&&l.pause()}function f(){l.readable&&l.resume&&l.resume()}l.on("data",h),r.on("drain",f),r._isStdio||u&&u.end===!1||(l.on("end",p),l.on("close",b));var d=!1;function p(){d||(d=!0,r.end())}function b(){d||(d=!0,typeof r.destroy=="function"&&r.destroy())}function v(w){if(x(),a.listenerCount(this,"error")===0)throw w}function x(){l.removeListener("data",h),r.removeListener("drain",f),l.removeListener("end",p),l.removeListener("close",b),l.removeListener("error",v),r.removeListener("error",v),l.removeListener("end",x),l.removeListener("close",x),r.removeListener("close",x)}return l.on("error",v),r.on("error",v),l.on("end",x),l.on("close",x),r.on("close",x),r.emit("pipe",l),r}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,i,s){var a={}.toString;i.exports=Array.isArray||function(o){return a.call(o)=="[object Array]"}},{}],507:[function(e,i,s){i.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,i,s){var a=e("process-nextick-args"),o=Object.keys||function(x){var w=[];for(var M in x)w.push(M);return w};i.exports=p;var r=Object.create(e("core-util-is"));r.inherits=e("inherits");var u=e("./_stream_readable"),l=e("./_stream_writable");r.inherits(p,u);for(var h=o(l.prototype),f=0;f<h.length;f++){var d=h[f];p.prototype[d]||(p.prototype[d]=l.prototype[d])}function p(x){if(!(this instanceof p))return new p(x);u.call(this,x),l.call(this,x),x&&x.readable===!1&&(this.readable=!1),x&&x.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,x&&x.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",b)}function b(){this.allowHalfOpen||this._writableState.ended||a.nextTick(v,this)}function v(x){x.end()}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(p.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=x,this._writableState.destroyed=x)}}),p.prototype._destroy=function(x,w){this.push(null),this.end(),a.nextTick(w,x)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,i,s){i.exports=r;var a=e("./_stream_transform"),o=Object.create(e("core-util-is"));function r(u){if(!(this instanceof r))return new r(u);a.call(this,u)}o.inherits=e("inherits"),o.inherits(r,a),r.prototype._transform=function(u,l,h){h(null,u)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,i,s){(function(a,o){(function(){var r=e("process-nextick-args");i.exports=V;var u,l=e("isarray");V.ReadableState=N,e("events").EventEmitter;var h=function(it,nt){return it.listeners(nt).length},f=e("./internal/streams/stream"),d=e("safe-buffer").Buffer,p=(o!==void 0?o:typeof window!="undefined"?window:typeof self!="undefined"?self:{}).Uint8Array||function(){},b=Object.create(e("core-util-is"));b.inherits=e("inherits");var v=e("util"),x=void 0;x=v&&v.debuglog?v.debuglog("stream"):function(){};var w,M=e("./internal/streams/BufferList"),E=e("./internal/streams/destroy");b.inherits(V,f);var D=["error","close","destroy","pause","resume"];function N(it,nt){it=it||{};var lt=nt instanceof(u=u||e("./_stream_duplex"));this.objectMode=!!it.objectMode,lt&&(this.objectMode=this.objectMode||!!it.readableObjectMode);var ut=it.highWaterMark,vt=it.readableHighWaterMark,Q=this.objectMode?16:16384;this.highWaterMark=ut||ut===0?ut:lt&&(vt||vt===0)?vt:Q,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new M,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=it.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,it.encoding&&(w||(w=e("string_decoder/").StringDecoder),this.decoder=new w(it.encoding),this.encoding=it.encoding)}function V(it){if(u=u||e("./_stream_duplex"),!(this instanceof V))return new V(it);this._readableState=new N(it,this),this.readable=!0,it&&(typeof it.read=="function"&&(this._read=it.read),typeof it.destroy=="function"&&(this._destroy=it.destroy)),f.call(this)}function K(it,nt,lt,ut,vt){var Q,gt=it._readableState;return nt===null?(gt.reading=!1,function(Y,H){if(!H.ended){if(H.decoder){var at=H.decoder.end();at&&at.length&&(H.buffer.push(at),H.length+=H.objectMode?1:at.length)}H.ended=!0,tt(Y)}}(it,gt)):(vt||(Q=function(Y,H){var at;ft=H,d.isBuffer(ft)||ft instanceof p||typeof H=="string"||H===void 0||Y.objectMode||(at=new TypeError("Invalid non-string/buffer chunk"));var ft;return at}(gt,nt)),Q?it.emit("error",Q):gt.objectMode||nt&&nt.length>0?(typeof nt=="string"||gt.objectMode||Object.getPrototypeOf(nt)===d.prototype||(nt=function(Y){return d.from(Y)}(nt)),ut?gt.endEmitted?it.emit("error",new Error("stream.unshift() after end event")):j(it,gt,nt,!0):gt.ended?it.emit("error",new Error("stream.push() after EOF")):(gt.reading=!1,gt.decoder&&!lt?(nt=gt.decoder.write(nt),gt.objectMode||nt.length!==0?j(it,gt,nt,!1):J(it,gt)):j(it,gt,nt,!1))):ut||(gt.reading=!1)),function(Y){return!Y.ended&&(Y.needReadable||Y.length<Y.highWaterMark||Y.length===0)}(gt)}function j(it,nt,lt,ut){nt.flowing&&nt.length===0&&!nt.sync?(it.emit("data",lt),it.read(0)):(nt.length+=nt.objectMode?1:lt.length,ut?nt.buffer.unshift(lt):nt.buffer.push(lt),nt.needReadable&&tt(it)),J(it,nt)}Object.defineProperty(V.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(it){this._readableState&&(this._readableState.destroyed=it)}}),V.prototype.destroy=E.destroy,V.prototype._undestroy=E.undestroy,V.prototype._destroy=function(it,nt){this.push(null),nt(it)},V.prototype.push=function(it,nt){var lt,ut=this._readableState;return ut.objectMode?lt=!0:typeof it=="string"&&((nt=nt||ut.defaultEncoding)!==ut.encoding&&(it=d.from(it,nt),nt=""),lt=!0),K(this,it,nt,!1,lt)},V.prototype.unshift=function(it){return K(this,it,null,!0,!1)},V.prototype.isPaused=function(){return this._readableState.flowing===!1},V.prototype.setEncoding=function(it){return w||(w=e("string_decoder/").StringDecoder),this._readableState.decoder=new w(it),this._readableState.encoding=it,this};function Z(it,nt){return it<=0||nt.length===0&&nt.ended?0:nt.objectMode?1:it!=it?nt.flowing&&nt.length?nt.buffer.head.data.length:nt.length:(it>nt.highWaterMark&&(nt.highWaterMark=function(lt){return lt>=8388608?lt=8388608:(lt--,lt|=lt>>>1,lt|=lt>>>2,lt|=lt>>>4,lt|=lt>>>8,lt|=lt>>>16,lt++),lt}(it)),it<=nt.length?it:nt.ended?nt.length:(nt.needReadable=!0,0))}function tt(it){var nt=it._readableState;nt.needReadable=!1,nt.emittedReadable||(x("emitReadable",nt.flowing),nt.emittedReadable=!0,nt.sync?r.nextTick(rt,it):rt(it))}function rt(it){x("emit readable"),it.emit("readable"),C(it)}function J(it,nt){nt.readingMore||(nt.readingMore=!0,r.nextTick(U,it,nt))}function U(it,nt){for(var lt=nt.length;!nt.reading&&!nt.flowing&&!nt.ended&&nt.length<nt.highWaterMark&&(x("maybeReadMore read 0"),it.read(0),lt!==nt.length);)lt=nt.length;nt.readingMore=!1}function G(it){x("readable nexttick read 0"),it.read(0)}function I(it,nt){nt.reading||(x("resume read 0"),it.read(0)),nt.resumeScheduled=!1,nt.awaitDrain=0,it.emit("resume"),C(it),nt.flowing&&!nt.reading&&it.read(0)}function C(it){var nt=it._readableState;for(x("flow",nt.flowing);nt.flowing&&it.read()!==null;);}function L(it,nt){return nt.length===0?null:(nt.objectMode?lt=nt.buffer.shift():!it||it>=nt.length?(lt=nt.decoder?nt.buffer.join(""):nt.buffer.length===1?nt.buffer.head.data:nt.buffer.concat(nt.length),nt.buffer.clear()):lt=function(ut,vt,Q){var gt;return ut<vt.head.data.length?(gt=vt.head.data.slice(0,ut),vt.head.data=vt.head.data.slice(ut)):gt=ut===vt.head.data.length?vt.shift():Q?function(Y,H){var at=H.head,ft=1,wt=at.data;for(Y-=wt.length;at=at.next;){var _t=at.data,Dt=Y>_t.length?_t.length:Y;if(Dt===_t.length?wt+=_t:wt+=_t.slice(0,Y),(Y-=Dt)===0){Dt===_t.length?(++ft,at.next?H.head=at.next:H.head=H.tail=null):(H.head=at,at.data=_t.slice(Dt));break}++ft}return H.length-=ft,wt}(ut,vt):function(Y,H){var at=d.allocUnsafe(Y),ft=H.head,wt=1;for(ft.data.copy(at),Y-=ft.data.length;ft=ft.next;){var _t=ft.data,Dt=Y>_t.length?_t.length:Y;if(_t.copy(at,at.length-Y,0,Dt),(Y-=Dt)===0){Dt===_t.length?(++wt,ft.next?H.head=ft.next:H.head=H.tail=null):(H.head=ft,ft.data=_t.slice(Dt));break}++wt}return H.length-=wt,at}(ut,vt),gt}(it,nt.buffer,nt.decoder),lt);var lt}function B(it){var nt=it._readableState;if(nt.length>0)throw new Error('"endReadable()" called on non-empty stream');nt.endEmitted||(nt.ended=!0,r.nextTick(O,nt,it))}function O(it,nt){it.endEmitted||it.length!==0||(it.endEmitted=!0,nt.readable=!1,nt.emit("end"))}function q(it,nt){for(var lt=0,ut=it.length;lt<ut;lt++)if(it[lt]===nt)return lt;return-1}V.prototype.read=function(it){x("read",it),it=parseInt(it,10);var nt=this._readableState,lt=it;if(it!==0&&(nt.emittedReadable=!1),it===0&&nt.needReadable&&(nt.length>=nt.highWaterMark||nt.ended))return x("read: emitReadable",nt.length,nt.ended),nt.length===0&&nt.ended?B(this):tt(this),null;if((it=Z(it,nt))===0&&nt.ended)return nt.length===0&&B(this),null;var ut,vt=nt.needReadable;return x("need readable",vt),(nt.length===0||nt.length-it<nt.highWaterMark)&&x("length less than watermark",vt=!0),nt.ended||nt.reading?x("reading or ended",vt=!1):vt&&(x("do read"),nt.reading=!0,nt.sync=!0,nt.length===0&&(nt.needReadable=!0),this._read(nt.highWaterMark),nt.sync=!1,nt.reading||(it=Z(lt,nt))),(ut=it>0?L(it,nt):null)===null?(nt.needReadable=!0,it=0):nt.length-=it,nt.length===0&&(nt.ended||(nt.needReadable=!0),lt!==it&&nt.ended&&B(this)),ut!==null&&this.emit("data",ut),ut},V.prototype._read=function(it){this.emit("error",new Error("_read() is not implemented"))},V.prototype.pipe=function(it,nt){var lt=this,ut=this._readableState;switch(ut.pipesCount){case 0:ut.pipes=it;break;case 1:ut.pipes=[ut.pipes,it];break;default:ut.pipes.push(it)}ut.pipesCount+=1,x("pipe count=%d opts=%j",ut.pipesCount,nt);var vt=(!nt||nt.end!==!1)&&it!==a.stdout&&it!==a.stderr?gt:Gt;function Q(te,mt){x("onunpipe"),te===lt&&mt&&mt.hasUnpiped===!1&&(mt.hasUnpiped=!0,x("cleanup"),it.removeListener("close",_t),it.removeListener("finish",Dt),it.removeListener("drain",Y),it.removeListener("error",wt),it.removeListener("unpipe",Q),lt.removeListener("end",gt),lt.removeListener("end",Gt),lt.removeListener("data",ft),H=!0,!ut.awaitDrain||it._writableState&&!it._writableState.needDrain||Y())}function gt(){x("onend"),it.end()}ut.endEmitted?r.nextTick(vt):lt.once("end",vt),it.on("unpipe",Q);var Y=function(te){return function(){var mt=te._readableState;x("pipeOnDrain",mt.awaitDrain),mt.awaitDrain&&mt.awaitDrain--,mt.awaitDrain===0&&h(te,"data")&&(mt.flowing=!0,C(te))}}(lt);it.on("drain",Y);var H=!1,at=!1;function ft(te){x("ondata"),at=!1,it.write(te)!==!1||at||((ut.pipesCount===1&&ut.pipes===it||ut.pipesCount>1&&q(ut.pipes,it)!==-1)&&!H&&(x("false write response, pause",ut.awaitDrain),ut.awaitDrain++,at=!0),lt.pause())}function wt(te){x("onerror",te),Gt(),it.removeListener("error",wt),h(it,"error")===0&&it.emit("error",te)}function _t(){it.removeListener("finish",Dt),Gt()}function Dt(){x("onfinish"),it.removeListener("close",_t),Gt()}function Gt(){x("unpipe"),lt.unpipe(it)}return lt.on("data",ft),function(te,mt,At){if(typeof te.prependListener=="function")return te.prependListener(mt,At);te._events&&te._events[mt]?l(te._events[mt])?te._events[mt].unshift(At):te._events[mt]=[At,te._events[mt]]:te.on(mt,At)}(it,"error",wt),it.once("close",_t),it.once("finish",Dt),it.emit("pipe",lt),ut.flowing||(x("pipe resume"),lt.resume()),it},V.prototype.unpipe=function(it){var nt=this._readableState,lt={hasUnpiped:!1};if(nt.pipesCount===0)return this;if(nt.pipesCount===1)return it&&it!==nt.pipes||(it||(it=nt.pipes),nt.pipes=null,nt.pipesCount=0,nt.flowing=!1,it&&it.emit("unpipe",this,lt)),this;if(!it){var ut=nt.pipes,vt=nt.pipesCount;nt.pipes=null,nt.pipesCount=0,nt.flowing=!1;for(var Q=0;Q<vt;Q++)ut[Q].emit("unpipe",this,{hasUnpiped:!1});return this}var gt=q(nt.pipes,it);return gt===-1||(nt.pipes.splice(gt,1),nt.pipesCount-=1,nt.pipesCount===1&&(nt.pipes=nt.pipes[0]),it.emit("unpipe",this,lt)),this},V.prototype.on=function(it,nt){var lt=f.prototype.on.call(this,it,nt);if(it==="data")this._readableState.flowing!==!1&&this.resume();else if(it==="readable"){var ut=this._readableState;ut.endEmitted||ut.readableListening||(ut.readableListening=ut.needReadable=!0,ut.emittedReadable=!1,ut.reading?ut.length&&tt(this):r.nextTick(G,this))}return lt},V.prototype.addListener=V.prototype.on,V.prototype.resume=function(){var it=this._readableState;return it.flowing||(x("resume"),it.flowing=!0,function(nt,lt){lt.resumeScheduled||(lt.resumeScheduled=!0,r.nextTick(I,nt,lt))}(this,it)),this},V.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this},V.prototype.wrap=function(it){var nt=this,lt=this._readableState,ut=!1;for(var vt in it.on("end",function(){if(x("wrapped end"),lt.decoder&&!lt.ended){var gt=lt.decoder.end();gt&&gt.length&&nt.push(gt)}nt.push(null)}),it.on("data",function(gt){x("wrapped data"),lt.decoder&&(gt=lt.decoder.write(gt)),lt.objectMode&&gt==null||(lt.objectMode||gt&&gt.length)&&(nt.push(gt)||(ut=!0,it.pause()))}),it)this[vt]===void 0&&typeof it[vt]=="function"&&(this[vt]=function(gt){return function(){return it[gt].apply(it,arguments)}}(vt));for(var Q=0;Q<D.length;Q++)it.on(D[Q],this.emit.bind(this,D[Q]));return this._read=function(gt){x("wrapped _read",gt),ut&&(ut=!1,it.resume())},this},Object.defineProperty(V.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),V._fromList=L}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,i,s){i.exports=u;var a=e("./_stream_duplex"),o=Object.create(e("core-util-is"));function r(f,d){var p=this._transformState;p.transforming=!1;var b=p.writecb;if(!b)return this.emit("error",new Error("write callback called multiple times"));p.writechunk=null,p.writecb=null,d!=null&&this.push(d),b(f);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function u(f){if(!(this instanceof u))return new u(f);a.call(this,f),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",l)}function l(){var f=this;typeof this._flush=="function"?this._flush(function(d,p){h(f,d,p)}):h(this,null,null)}function h(f,d,p){if(d)return f.emit("error",d);if(p!=null&&f.push(p),f._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(f._transformState.transforming)throw new Error("Calling transform done when still transforming");return f.push(null)}o.inherits=e("inherits"),o.inherits(u,a),u.prototype.push=function(f,d){return this._transformState.needTransform=!1,a.prototype.push.call(this,f,d)},u.prototype._transform=function(f,d,p){throw new Error("_transform() is not implemented")},u.prototype._write=function(f,d,p){var b=this._transformState;if(b.writecb=p,b.writechunk=f,b.writeencoding=d,!b.transforming){var v=this._readableState;(b.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},u.prototype._read=function(f){var d=this._transformState;d.writechunk!==null&&d.writecb&&!d.transforming?(d.transforming=!0,this._transform(d.writechunk,d.writeencoding,d.afterTransform)):d.needTransform=!0},u.prototype._destroy=function(f,d){var p=this;a.prototype._destroy.call(this,f,function(b){d(b),p.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,i,s){(function(a,o,r){(function(){var u=e("process-nextick-args");function l(J){var U=this;this.next=null,this.entry=null,this.finish=function(){(function(G,I,C){var L=G.entry;for(G.entry=null;L;){var B=L.callback;I.pendingcb--,B(C),L=L.next}I.corkedRequestsFree.next=G})(U,J)}}i.exports=N;var h,f=!a.browser&&["v0.10","v0.9."].indexOf(a.version.slice(0,5))>-1?r:u.nextTick;N.WritableState=D;var d=Object.create(e("core-util-is"));d.inherits=e("inherits");var p={deprecate:e("util-deprecate")},b=e("./internal/streams/stream"),v=e("safe-buffer").Buffer,x=(o!==void 0?o:typeof window!="undefined"?window:typeof self!="undefined"?self:{}).Uint8Array||function(){},w,M=e("./internal/streams/destroy");function E(){}function D(J,U){h=h||e("./_stream_duplex"),J=J||{};var G=U instanceof h;this.objectMode=!!J.objectMode,G&&(this.objectMode=this.objectMode||!!J.writableObjectMode);var I=J.highWaterMark,C=J.writableHighWaterMark,L=this.objectMode?16:16384;this.highWaterMark=I||I===0?I:G&&(C||C===0)?C:L,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var B=J.decodeStrings===!1;this.decodeStrings=!B,this.defaultEncoding=J.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(O){(function(q,it){var nt=q._writableState,lt=nt.sync,ut=nt.writecb;if(function(Q){Q.writing=!1,Q.writecb=null,Q.length-=Q.writelen,Q.writelen=0}(nt),it)(function(Q,gt,Y,H,at){--gt.pendingcb,Y?(u.nextTick(at,H),u.nextTick(rt,Q,gt),Q._writableState.errorEmitted=!0,Q.emit("error",H)):(at(H),Q._writableState.errorEmitted=!0,Q.emit("error",H),rt(Q,gt))})(q,nt,lt,it,ut);else{var vt=Z(nt);vt||nt.corked||nt.bufferProcessing||!nt.bufferedRequest||j(q,nt),lt?f(K,q,nt,vt,ut):K(q,nt,vt,ut)}})(U,O)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function N(J){if(h=h||e("./_stream_duplex"),!(w.call(N,this)||this instanceof h))return new N(J);this._writableState=new D(J,this),this.writable=!0,J&&(typeof J.write=="function"&&(this._write=J.write),typeof J.writev=="function"&&(this._writev=J.writev),typeof J.destroy=="function"&&(this._destroy=J.destroy),typeof J.final=="function"&&(this._final=J.final)),b.call(this)}function V(J,U,G,I,C,L,B){U.writelen=I,U.writecb=B,U.writing=!0,U.sync=!0,G?J._writev(C,U.onwrite):J._write(C,L,U.onwrite),U.sync=!1}function K(J,U,G,I){G||function(C,L){L.length===0&&L.needDrain&&(L.needDrain=!1,C.emit("drain"))}(J,U),U.pendingcb--,I(),rt(J,U)}function j(J,U){U.bufferProcessing=!0;var G=U.bufferedRequest;if(J._writev&&G&&G.next){var I=U.bufferedRequestCount,C=new Array(I),L=U.corkedRequestsFree;L.entry=G;for(var B=0,O=!0;G;)C[B]=G,G.isBuf||(O=!1),G=G.next,B+=1;C.allBuffers=O,V(J,U,!0,U.length,C,"",L.finish),U.pendingcb++,U.lastBufferedRequest=null,L.next?(U.corkedRequestsFree=L.next,L.next=null):U.corkedRequestsFree=new l(U),U.bufferedRequestCount=0}else{for(;G;){var q=G.chunk,it=G.encoding,nt=G.callback;if(V(J,U,!1,U.objectMode?1:q.length,q,it,nt),G=G.next,U.bufferedRequestCount--,U.writing)break}G===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=G,U.bufferProcessing=!1}function Z(J){return J.ending&&J.length===0&&J.bufferedRequest===null&&!J.finished&&!J.writing}function tt(J,U){J._final(function(G){U.pendingcb--,G&&J.emit("error",G),U.prefinished=!0,J.emit("prefinish"),rt(J,U)})}function rt(J,U){var G=Z(U);return G&&(function(I,C){C.prefinished||C.finalCalled||(typeof I._final=="function"?(C.pendingcb++,C.finalCalled=!0,u.nextTick(tt,I,C)):(C.prefinished=!0,I.emit("prefinish")))}(J,U),U.pendingcb===0&&(U.finished=!0,J.emit("finish"))),G}d.inherits(N,b),D.prototype.getBuffer=function(){for(var J=this.bufferedRequest,U=[];J;)U.push(J),J=J.next;return U},function(){try{Object.defineProperty(D.prototype,"buffer",{get:p.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(J){}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(w=Function.prototype[Symbol.hasInstance],Object.defineProperty(N,Symbol.hasInstance,{value:function(J){return!!w.call(this,J)||this===N&&J&&J._writableState instanceof D}})):w=function(J){return J instanceof this},N.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},N.prototype.write=function(J,U,G){var I,C=this._writableState,L=!1,B=!C.objectMode&&(I=J,v.isBuffer(I)||I instanceof x);return B&&!v.isBuffer(J)&&(J=function(O){return v.from(O)}(J)),typeof U=="function"&&(G=U,U=null),B?U="buffer":U||(U=C.defaultEncoding),typeof G!="function"&&(G=E),C.ended?function(O,q){var it=new Error("write after end");O.emit("error",it),u.nextTick(q,it)}(this,G):(B||function(O,q,it,nt){var lt=!0,ut=!1;return it===null?ut=new TypeError("May not write null values to stream"):typeof it=="string"||it===void 0||q.objectMode||(ut=new TypeError("Invalid non-string/buffer chunk")),ut&&(O.emit("error",ut),u.nextTick(nt,ut),lt=!1),lt}(this,C,J,G))&&(C.pendingcb++,L=function(O,q,it,nt,lt,ut){if(!it){var vt=function(H,at,ft){return H.objectMode||H.decodeStrings===!1||typeof at!="string"||(at=v.from(at,ft)),at}(q,nt,lt);nt!==vt&&(it=!0,lt="buffer",nt=vt)}var Q=q.objectMode?1:nt.length;q.length+=Q;var gt=q.length<q.highWaterMark;if(gt||(q.needDrain=!0),q.writing||q.corked){var Y=q.lastBufferedRequest;q.lastBufferedRequest={chunk:nt,encoding:lt,isBuf:it,callback:ut,next:null},Y?Y.next=q.lastBufferedRequest:q.bufferedRequest=q.lastBufferedRequest,q.bufferedRequestCount+=1}else V(O,q,!1,Q,nt,lt,ut);return gt}(this,C,B,J,U,G)),L},N.prototype.cork=function(){this._writableState.corked++},N.prototype.uncork=function(){var J=this._writableState;J.corked&&(J.corked--,J.writing||J.corked||J.bufferProcessing||!J.bufferedRequest||j(this,J))},N.prototype.setDefaultEncoding=function(J){if(typeof J=="string"&&(J=J.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((J+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+J);return this._writableState.defaultEncoding=J,this},Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),N.prototype._write=function(J,U,G){G(new Error("_write() is not implemented"))},N.prototype._writev=null,N.prototype.end=function(J,U,G){var I=this._writableState;typeof J=="function"?(G=J,J=null,U=null):typeof U=="function"&&(G=U,U=null),J!=null&&this.write(J,U),I.corked&&(I.corked=1,this.uncork()),I.ending||function(C,L,B){L.ending=!0,rt(C,L),B&&(L.finished?u.nextTick(B):C.once("finish",B)),L.ended=!0,C.writable=!1}(this,I,G)},Object.defineProperty(N.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(J){this._writableState&&(this._writableState.destroyed=J)}}),N.prototype.destroy=M.destroy,N.prototype._undestroy=M.undestroy,N.prototype._destroy=function(J,U){this.end(),U(J)}}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,i,s){var a=e("safe-buffer").Buffer,o=e("util");i.exports=function(){function r(){(function(u,l){if(!(u instanceof l))throw new TypeError("Cannot call a class as a function")})(this,r),this.head=null,this.tail=null,this.length=0}return r.prototype.push=function(u){var l={data:u,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length},r.prototype.unshift=function(u){var l={data:u,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length},r.prototype.shift=function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(u){if(this.length===0)return"";for(var l=this.head,h=""+l.data;l=l.next;)h+=u+l.data;return h},r.prototype.concat=function(u){if(this.length===0)return a.alloc(0);for(var l,h,f,d=a.allocUnsafe(u>>>0),p=this.head,b=0;p;)l=p.data,h=d,f=b,l.copy(h,f),b+=p.data.length,p=p.next;return d},r}(),o&&o.inspect&&o.inspect.custom&&(i.exports.prototype[o.inspect.custom]=function(){var r=o.inspect({length:this.length});return this.constructor.name+" "+r})},{"safe-buffer":520,util:188}],514:[function(e,i,s){var a=e("process-nextick-args");function o(r,u){r.emit("error",u)}i.exports={destroy:function(r,u){var l=this,h=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return h||f?(u?u(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(o,this,r)):a.nextTick(o,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(d){!u&&d?l._writableState?l._writableState.errorEmitted||(l._writableState.errorEmitted=!0,a.nextTick(o,l,d)):a.nextTick(o,l,d):u&&u(d)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,i,s){arguments[4][490][0].apply(s,arguments)},{dup:490,events:422}],516:[function(e,i,s){i.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,i,s){(s=i.exports=e("./lib/_stream_readable.js")).Stream=s,s.Readable=s,s.Writable=e("./lib/_stream_writable.js"),s.Duplex=e("./lib/_stream_duplex.js"),s.Transform=e("./lib/_stream_transform.js"),s.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,i,s){i.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,i,s){i.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,i,s){arguments[4][217][0].apply(s,arguments)},{buffer:220,dup:217}],521:[function(e,i,s){arguments[4][218][0].apply(s,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,i,s){arguments[4][218][0].apply(s,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,i,s){(function(a,o){(function(){var r=e("process/browser.js").nextTick,u=Function.prototype.apply,l=Array.prototype.slice,h={},f=0;function d(p,b){this._id=p,this._clearFn=b}s.setTimeout=function(){return new d(u.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new d(u.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(p){p.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(p,b){clearTimeout(p._idleTimeoutId),p._idleTimeout=b},s.unenroll=function(p){clearTimeout(p._idleTimeoutId),p._idleTimeout=-1},s._unrefActive=s.active=function(p){clearTimeout(p._idleTimeoutId);var b=p._idleTimeout;b>=0&&(p._idleTimeoutId=setTimeout(function(){p._onTimeout&&p._onTimeout()},b))},s.setImmediate=typeof a=="function"?a:function(p){var b=f++,v=!(arguments.length<2)&&l.call(arguments,1);return h[b]=!0,r(function(){h[b]&&(v?p.apply(null,v):p.call(null),s.clearImmediate(b))}),b},s.clearImmediate=typeof o=="function"?o:function(p){delete h[p]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,i,s){(function(a){(function(){function o(r){try{if(!a.localStorage)return!1}catch(l){return!1}var u=a.localStorage[r];return u!=null&&String(u).toLowerCase()==="true"}i.exports=function(r,u){if(o("noDeprecation"))return r;var l=!1;return function(){if(!l){if(o("throwDeprecation"))throw new Error(u);o("traceDeprecation")?console.trace(u):console.warn(u),l=!0}return r.apply(this,arguments)}}}).call(this)}).call(this,typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],525:[function(e,i,s){typeof Object.create=="function"?i.exports=function(a,o){a.super_=o,a.prototype=Object.create(o.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:i.exports=function(a,o){a.super_=o;var r=function(){};r.prototype=o.prototype,a.prototype=new r,a.prototype.constructor=a}},{}],526:[function(e,i,s){i.exports=function(a){return a&&typeof a=="object"&&typeof a.copy=="function"&&typeof a.fill=="function"&&typeof a.readUInt8=="function"}},{}],527:[function(e,i,s){(function(a,o){(function(){var r=/%[sdj%]/g;s.format=function(C){if(!D(C)){for(var L=[],B=0;B<arguments.length;B++)L.push(h(arguments[B]));return L.join(" ")}B=1;for(var O=arguments,q=O.length,it=String(C).replace(r,function(lt){if(lt==="%%")return"%";if(B>=q)return lt;switch(lt){case"%s":return String(O[B++]);case"%d":return Number(O[B++]);case"%j":try{return JSON.stringify(O[B++])}catch(ut){return"[Circular]"}default:return lt}}),nt=O[B];B<q;nt=O[++B])M(nt)||!K(nt)?it+=" "+nt:it+=" "+h(nt);return it},s.deprecate=function(C,L){if(N(o.process))return function(){return s.deprecate(C,L).apply(this,arguments)};if(a.noDeprecation===!0)return C;var B=!1;return function(){if(!B){if(a.throwDeprecation)throw new Error(L);a.traceDeprecation?console.trace(L):console.error(L),B=!0}return C.apply(this,arguments)}};var u,l={};function h(C,L){var B={seen:[],stylize:d};return arguments.length>=3&&(B.depth=arguments[2]),arguments.length>=4&&(B.colors=arguments[3]),w(L)?B.showHidden=L:L&&s._extend(B,L),N(B.showHidden)&&(B.showHidden=!1),N(B.depth)&&(B.depth=2),N(B.colors)&&(B.colors=!1),N(B.customInspect)&&(B.customInspect=!0),B.colors&&(B.stylize=f),p(B,C,B.depth)}function f(C,L){var B=h.styles[L];return B?"\x1B["+h.colors[B][0]+"m"+C+"\x1B["+h.colors[B][1]+"m":C}function d(C,L){return C}function p(C,L,B){if(C.customInspect&&L&&tt(L.inspect)&&L.inspect!==s.inspect&&(!L.constructor||L.constructor.prototype!==L)){var O=L.inspect(B,C);return D(O)||(O=p(C,O,B)),O}var q=function(Y,H){if(N(H))return Y.stylize("undefined","undefined");if(D(H)){var at="'"+JSON.stringify(H).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Y.stylize(at,"string")}if(E(H))return Y.stylize(""+H,"number");if(w(H))return Y.stylize(""+H,"boolean");if(M(H))return Y.stylize("null","null")}(C,L);if(q)return q;var it=Object.keys(L),nt=function(Y){var H={};return Y.forEach(function(at,ft){H[at]=!0}),H}(it);if(C.showHidden&&(it=Object.getOwnPropertyNames(L)),Z(L)&&(it.indexOf("message")>=0||it.indexOf("description")>=0))return b(L);if(it.length===0){if(tt(L)){var lt=L.name?": "+L.name:"";return C.stylize("[Function"+lt+"]","special")}if(V(L))return C.stylize(RegExp.prototype.toString.call(L),"regexp");if(j(L))return C.stylize(Date.prototype.toString.call(L),"date");if(Z(L))return b(L)}var ut,vt="",Q=!1,gt=["{","}"];return x(L)&&(Q=!0,gt=["[","]"]),tt(L)&&(vt=" [Function"+(L.name?": "+L.name:"")+"]"),V(L)&&(vt=" "+RegExp.prototype.toString.call(L)),j(L)&&(vt=" "+Date.prototype.toUTCString.call(L)),Z(L)&&(vt=" "+b(L)),it.length!==0||Q&&L.length!=0?B<0?V(L)?C.stylize(RegExp.prototype.toString.call(L),"regexp"):C.stylize("[Object]","special"):(C.seen.push(L),ut=Q?function(Y,H,at,ft,wt){for(var _t=[],Dt=0,Gt=H.length;Dt<Gt;++Dt)I(H,String(Dt))?_t.push(v(Y,H,at,ft,String(Dt),!0)):_t.push("");return wt.forEach(function(te){te.match(/^\d+$/)||_t.push(v(Y,H,at,ft,te,!0))}),_t}(C,L,B,nt,it):it.map(function(Y){return v(C,L,B,nt,Y,Q)}),C.seen.pop(),function(Y,H,at){return Y.reduce(function(ft,wt){return wt.indexOf(`
`)>=0,ft+wt.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?at[0]+(H===""?"":H+`
 `)+" "+Y.join(`,
  `)+" "+at[1]:at[0]+H+" "+Y.join(", ")+" "+at[1]}(ut,vt,gt)):gt[0]+vt+gt[1]}function b(C){return"["+Error.prototype.toString.call(C)+"]"}function v(C,L,B,O,q,it){var nt,lt,ut;if((ut=Object.getOwnPropertyDescriptor(L,q)||{value:L[q]}).get?lt=ut.set?C.stylize("[Getter/Setter]","special"):C.stylize("[Getter]","special"):ut.set&&(lt=C.stylize("[Setter]","special")),I(O,q)||(nt="["+q+"]"),lt||(C.seen.indexOf(ut.value)<0?(lt=M(B)?p(C,ut.value,null):p(C,ut.value,B-1)).indexOf(`
`)>-1&&(lt=it?lt.split(`
`).map(function(vt){return"  "+vt}).join(`
`).substr(2):`
`+lt.split(`
`).map(function(vt){return"   "+vt}).join(`
`)):lt=C.stylize("[Circular]","special")),N(nt)){if(it&&q.match(/^\d+$/))return lt;(nt=JSON.stringify(""+q)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(nt=nt.substr(1,nt.length-2),nt=C.stylize(nt,"name")):(nt=nt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),nt=C.stylize(nt,"string"))}return nt+": "+lt}function x(C){return Array.isArray(C)}function w(C){return typeof C=="boolean"}function M(C){return C===null}function E(C){return typeof C=="number"}function D(C){return typeof C=="string"}function N(C){return C===void 0}function V(C){return K(C)&&rt(C)==="[object RegExp]"}function K(C){return typeof C=="object"&&C!==null}function j(C){return K(C)&&rt(C)==="[object Date]"}function Z(C){return K(C)&&(rt(C)==="[object Error]"||C instanceof Error)}function tt(C){return typeof C=="function"}function rt(C){return Object.prototype.toString.call(C)}function J(C){return C<10?"0"+C.toString(10):C.toString(10)}s.debuglog=function(C){if(N(u)&&(u=a.env.NODE_DEBUG||""),C=C.toUpperCase(),!l[C])if(new RegExp("\\b"+C+"\\b","i").test(u)){var L=a.pid;l[C]=function(){var B=s.format.apply(s,arguments);console.error("%s %d: %s",C,L,B)}}else l[C]=function(){};return l[C]},s.inspect=h,h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},h.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},s.isArray=x,s.isBoolean=w,s.isNull=M,s.isNullOrUndefined=function(C){return C==null},s.isNumber=E,s.isString=D,s.isSymbol=function(C){return typeof C=="symbol"},s.isUndefined=N,s.isRegExp=V,s.isObject=K,s.isDate=j,s.isError=Z,s.isFunction=tt,s.isPrimitive=function(C){return C===null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||typeof C=="symbol"||C===void 0},s.isBuffer=e("./support/isBuffer");var U=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function G(){var C=new Date,L=[J(C.getHours()),J(C.getMinutes()),J(C.getSeconds())].join(":");return[C.getDate(),U[C.getMonth()],L].join(" ")}function I(C,L){return Object.prototype.hasOwnProperty.call(C,L)}s.log=function(){console.log("%s - %s",G(),s.format.apply(s,arguments))},s.inherits=e("inherits"),s._extend=function(C,L){if(!L||!K(L))return C;for(var B=Object.keys(L),O=B.length;O--;)C[B[O]]=L[B[O]];return C}}).call(this)}).call(this,e("_process"),typeof dr!="undefined"?dr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"v1",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(s,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(s,"v4",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"v5",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(s,"NIL",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(s,"validate",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(s,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(s,"parse",{enumerable:!0,get:function(){return p.default}});var a=b(e("./v1.js")),o=b(e("./v3.js")),r=b(e("./v4.js")),u=b(e("./v5.js")),l=b(e("./nil.js")),h=b(e("./version.js")),f=b(e("./validate.js")),d=b(e("./stringify.js")),p=b(e("./parse.js"));function b(v){return v&&v.__esModule?v:{default:v}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,i,s){function a(p){return 14+(p+64>>>9<<4)+1}function o(p,b){const v=(65535&p)+(65535&b);return(p>>16)+(b>>16)+(v>>16)<<16|65535&v}function r(p,b,v,x,w,M){return o((E=o(o(b,p),o(x,M)))<<(D=w)|E>>>32-D,v);var E,D}function u(p,b,v,x,w,M,E){return r(b&v|~b&x,p,b,w,M,E)}function l(p,b,v,x,w,M,E){return r(b&x|v&~x,p,b,w,M,E)}function h(p,b,v,x,w,M,E){return r(b^v^x,p,b,w,M,E)}function f(p,b,v,x,w,M,E){return r(v^(b|~x),p,b,w,M,E)}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var d=function(p){if(typeof p=="string"){const b=unescape(encodeURIComponent(p));p=new Uint8Array(b.length);for(let v=0;v<b.length;++v)p[v]=b.charCodeAt(v)}return function(b){const v=[],x=32*b.length;for(let w=0;w<x;w+=8){const M=b[w>>5]>>>w%32&255,E=parseInt("0123456789abcdef".charAt(M>>>4&15)+"0123456789abcdef".charAt(15&M),16);v.push(E)}return v}(function(b,v){b[v>>5]|=128<<v%32,b[a(v)-1]=v;let x=1732584193,w=-271733879,M=-1732584194,E=271733878;for(let D=0;D<b.length;D+=16){const N=x,V=w,K=M,j=E;x=u(x,w,M,E,b[D],7,-680876936),E=u(E,x,w,M,b[D+1],12,-389564586),M=u(M,E,x,w,b[D+2],17,606105819),w=u(w,M,E,x,b[D+3],22,-1044525330),x=u(x,w,M,E,b[D+4],7,-176418897),E=u(E,x,w,M,b[D+5],12,1200080426),M=u(M,E,x,w,b[D+6],17,-1473231341),w=u(w,M,E,x,b[D+7],22,-45705983),x=u(x,w,M,E,b[D+8],7,1770035416),E=u(E,x,w,M,b[D+9],12,-1958414417),M=u(M,E,x,w,b[D+10],17,-42063),w=u(w,M,E,x,b[D+11],22,-1990404162),x=u(x,w,M,E,b[D+12],7,1804603682),E=u(E,x,w,M,b[D+13],12,-40341101),M=u(M,E,x,w,b[D+14],17,-1502002290),w=u(w,M,E,x,b[D+15],22,1236535329),x=l(x,w,M,E,b[D+1],5,-165796510),E=l(E,x,w,M,b[D+6],9,-1069501632),M=l(M,E,x,w,b[D+11],14,643717713),w=l(w,M,E,x,b[D],20,-373897302),x=l(x,w,M,E,b[D+5],5,-701558691),E=l(E,x,w,M,b[D+10],9,38016083),M=l(M,E,x,w,b[D+15],14,-660478335),w=l(w,M,E,x,b[D+4],20,-405537848),x=l(x,w,M,E,b[D+9],5,568446438),E=l(E,x,w,M,b[D+14],9,-1019803690),M=l(M,E,x,w,b[D+3],14,-187363961),w=l(w,M,E,x,b[D+8],20,1163531501),x=l(x,w,M,E,b[D+13],5,-1444681467),E=l(E,x,w,M,b[D+2],9,-51403784),M=l(M,E,x,w,b[D+7],14,1735328473),w=l(w,M,E,x,b[D+12],20,-1926607734),x=h(x,w,M,E,b[D+5],4,-378558),E=h(E,x,w,M,b[D+8],11,-2022574463),M=h(M,E,x,w,b[D+11],16,1839030562),w=h(w,M,E,x,b[D+14],23,-35309556),x=h(x,w,M,E,b[D+1],4,-1530992060),E=h(E,x,w,M,b[D+4],11,1272893353),M=h(M,E,x,w,b[D+7],16,-155497632),w=h(w,M,E,x,b[D+10],23,-1094730640),x=h(x,w,M,E,b[D+13],4,681279174),E=h(E,x,w,M,b[D],11,-358537222),M=h(M,E,x,w,b[D+3],16,-722521979),w=h(w,M,E,x,b[D+6],23,76029189),x=h(x,w,M,E,b[D+9],4,-640364487),E=h(E,x,w,M,b[D+12],11,-421815835),M=h(M,E,x,w,b[D+15],16,530742520),w=h(w,M,E,x,b[D+2],23,-995338651),x=f(x,w,M,E,b[D],6,-198630844),E=f(E,x,w,M,b[D+7],10,1126891415),M=f(M,E,x,w,b[D+14],15,-1416354905),w=f(w,M,E,x,b[D+5],21,-57434055),x=f(x,w,M,E,b[D+12],6,1700485571),E=f(E,x,w,M,b[D+3],10,-1894986606),M=f(M,E,x,w,b[D+10],15,-1051523),w=f(w,M,E,x,b[D+1],21,-2054922799),x=f(x,w,M,E,b[D+8],6,1873313359),E=f(E,x,w,M,b[D+15],10,-30611744),M=f(M,E,x,w,b[D+6],15,-1560198380),w=f(w,M,E,x,b[D+13],21,1309151649),x=f(x,w,M,E,b[D+4],6,-145523070),E=f(E,x,w,M,b[D+11],10,-1120210379),M=f(M,E,x,w,b[D+2],15,718787259),w=f(w,M,E,x,b[D+9],21,-343485551),x=o(x,N),w=o(w,V),M=o(M,K),E=o(E,j)}return[x,w,M,E]}(function(b){if(b.length===0)return[];const v=8*b.length,x=new Uint32Array(a(v));for(let w=0;w<v;w+=8)x[w>>5]|=(255&b[w/8])<<w%32;return x}(p),8*p.length))};s.default=d},{}],530:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,s.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,o=(a=e("./validate.js"))&&a.__esModule?a:{default:a},r=function(u){if(!(0,o.default)(u))throw TypeError("Invalid UUID");let l;const h=new Uint8Array(16);return h[0]=(l=parseInt(u.slice(0,8),16))>>>24,h[1]=l>>>16&255,h[2]=l>>>8&255,h[3]=255&l,h[4]=(l=parseInt(u.slice(9,13),16))>>>8,h[5]=255&l,h[6]=(l=parseInt(u.slice(14,18),16))>>>8,h[7]=255&l,h[8]=(l=parseInt(u.slice(19,23),16))>>>8,h[9]=255&l,h[10]=(l=parseInt(u.slice(24,36),16))/1099511627776&255,h[11]=l/4294967296&255,h[12]=l>>>24&255,h[13]=l>>>16&255,h[14]=l>>>8&255,h[15]=255&l,h};s.default=r},{"./validate.js":541}],532:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,s.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,i,s){let a;Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(){if(!a&&(a=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(o)};const o=new Uint8Array(16)},{}],534:[function(e,i,s){function a(u,l,h,f){switch(u){case 0:return l&h^~l&f;case 1:return l^h^f;case 2:return l&h^l&f^h&f;case 3:return l^h^f}}function o(u,l){return u<<l|u>>>32-l}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var r=function(u){const l=[1518500249,1859775393,2400959708,3395469782],h=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof u=="string"){const b=unescape(encodeURIComponent(u));u=[];for(let v=0;v<b.length;++v)u.push(b.charCodeAt(v))}else Array.isArray(u)||(u=Array.prototype.slice.call(u));u.push(128);const f=u.length/4+2,d=Math.ceil(f/16),p=new Array(d);for(let b=0;b<d;++b){const v=new Uint32Array(16);for(let x=0;x<16;++x)v[x]=u[64*b+4*x]<<24|u[64*b+4*x+1]<<16|u[64*b+4*x+2]<<8|u[64*b+4*x+3];p[b]=v}p[d-1][14]=8*(u.length-1)/Math.pow(2,32),p[d-1][14]=Math.floor(p[d-1][14]),p[d-1][15]=8*(u.length-1)&4294967295;for(let b=0;b<d;++b){const v=new Uint32Array(80);for(let N=0;N<16;++N)v[N]=p[b][N];for(let N=16;N<80;++N)v[N]=o(v[N-3]^v[N-8]^v[N-14]^v[N-16],1);let x=h[0],w=h[1],M=h[2],E=h[3],D=h[4];for(let N=0;N<80;++N){const V=Math.floor(N/20),K=o(x,5)+a(V,w,M,E)+D+l[V]+v[N]>>>0;D=E,E=M,M=o(w,30)>>>0,w=x,x=K}h[0]=h[0]+x>>>0,h[1]=h[1]+w>>>0,h[2]=h[2]+M>>>0,h[3]=h[3]+E>>>0,h[4]=h[4]+D>>>0}return[h[0]>>24&255,h[0]>>16&255,h[0]>>8&255,255&h[0],h[1]>>24&255,h[1]>>16&255,h[1]>>8&255,255&h[1],h[2]>>24&255,h[2]>>16&255,h[2]>>8&255,255&h[2],h[3]>>24&255,h[3]>>16&255,h[3]>>8&255,255&h[3],h[4]>>24&255,h[4]>>16&255,h[4]>>8&255,255&h[4]]};s.default=r},{}],535:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,o=(a=e("./validate.js"))&&a.__esModule?a:{default:a};const r=[];for(let l=0;l<256;++l)r.push((l+256).toString(16).substr(1));var u=function(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const f=(r[l[h+0]]+r[l[h+1]]+r[l[h+2]]+r[l[h+3]]+"-"+r[l[h+4]]+r[l[h+5]]+"-"+r[l[h+6]]+r[l[h+7]]+"-"+r[l[h+8]]+r[l[h+9]]+"-"+r[l[h+10]]+r[l[h+11]]+r[l[h+12]]+r[l[h+13]]+r[l[h+14]]+r[l[h+15]]).toLowerCase();if(!(0,o.default)(f))throw TypeError("Stringified UUID is invalid");return f};s.default=u},{"./validate.js":541}],536:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=r(e("./rng.js")),o=r(e("./stringify.js"));function r(p){return p&&p.__esModule?p:{default:p}}let u,l,h=0,f=0;var d=function(p,b,v){let x=b&&v||0;const w=b||new Array(16);let M=(p=p||{}).node||u,E=p.clockseq!==void 0?p.clockseq:l;if(M==null||E==null){const Z=p.random||(p.rng||a.default)();M==null&&(M=u=[1|Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]]),E==null&&(E=l=16383&(Z[6]<<8|Z[7]))}let D=p.msecs!==void 0?p.msecs:Date.now(),N=p.nsecs!==void 0?p.nsecs:f+1;const V=D-h+(N-f)/1e4;if(V<0&&p.clockseq===void 0&&(E=E+1&16383),(V<0||D>h)&&p.nsecs===void 0&&(N=0),N>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=D,f=N,l=E,D+=122192928e5;const K=(1e4*(268435455&D)+N)%4294967296;w[x++]=K>>>24&255,w[x++]=K>>>16&255,w[x++]=K>>>8&255,w[x++]=255&K;const j=D/4294967296*1e4&268435455;w[x++]=j>>>8&255,w[x++]=255&j,w[x++]=j>>>24&15|16,w[x++]=j>>>16&255,w[x++]=E>>>8|128,w[x++]=255&E;for(let Z=0;Z<6;++Z)w[x+Z]=M[Z];return b||(0,o.default)(w)};s.default=d},{"./rng.js":533,"./stringify.js":535}],537:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=r(e("./v35.js")),o=r(e("./md5.js"));function r(l){return l&&l.__esModule?l:{default:l}}var u=(0,a.default)("v3",48,o.default);s.default=u},{"./md5.js":529,"./v35.js":538}],538:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(h,f,d){function p(b,v,x,w){if(typeof b=="string"&&(b=function(E){E=unescape(encodeURIComponent(E));const D=[];for(let N=0;N<E.length;++N)D.push(E.charCodeAt(N));return D}(b)),typeof v=="string"&&(v=(0,o.default)(v)),v.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let M=new Uint8Array(16+b.length);if(M.set(v),M.set(b,v.length),M=d(M),M[6]=15&M[6]|f,M[8]=63&M[8]|128,x){w=w||0;for(let E=0;E<16;++E)x[w+E]=M[E];return x}return(0,a.default)(M)}try{p.name=h}catch(b){}return p.DNS=u,p.URL=l,p},s.URL=s.DNS=void 0;var a=r(e("./stringify.js")),o=r(e("./parse.js"));function r(h){return h&&h.__esModule?h:{default:h}}const u="6ba7b810-9dad-11d1-80b4-00c04fd430c8";s.DNS=u;const l="6ba7b811-9dad-11d1-80b4-00c04fd430c8";s.URL=l},{"./parse.js":531,"./stringify.js":535}],539:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=r(e("./rng.js")),o=r(e("./stringify.js"));function r(l){return l&&l.__esModule?l:{default:l}}var u=function(l,h,f){const d=(l=l||{}).random||(l.rng||a.default)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,h){f=f||0;for(let p=0;p<16;++p)h[f+p]=d[p];return h}return(0,o.default)(d)};s.default=u},{"./rng.js":533,"./stringify.js":535}],540:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=r(e("./v35.js")),o=r(e("./sha1.js"));function r(l){return l&&l.__esModule?l:{default:l}}var u=(0,a.default)("v5",80,o.default);s.default=u},{"./sha1.js":534,"./v35.js":538}],541:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,o=(a=e("./regex.js"))&&a.__esModule?a:{default:a},r=function(u){return typeof u=="string"&&o.default.test(u)};s.default=r},{"./regex.js":532}],542:[function(e,i,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a,o=(a=e("./validate.js"))&&a.__esModule?a:{default:a},r=function(u){if(!(0,o.default)(u))throw TypeError("Invalid UUID");return parseInt(u.substr(14,1),16)};s.default=r},{"./validate.js":541}],543:[function(e,i,s){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(s,"__esModule",{value:!0}),s.CHAR=`	
\r -퟿-�𐀀-􏿿`,s.S=` 	\r
`,s.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",s.NAME_CHAR="-"+s.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",s.CHAR_RE=new RegExp("^["+s.CHAR+"]$","u"),s.S_RE=new RegExp("^["+s.S+"]+$","u"),s.NAME_START_CHAR_RE=new RegExp("^["+s.NAME_START_CHAR+"]$","u"),s.NAME_CHAR_RE=new RegExp("^["+s.NAME_CHAR+"]$","u"),s.NAME_RE=new RegExp("^["+s.NAME_START_CHAR+"]["+s.NAME_CHAR+"]*$","u"),s.NMTOKEN_RE=new RegExp("^["+s.NAME_CHAR+"]+$","u");function a(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}s.S_LIST=[32,10,13,9],s.isChar=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},s.isS=function(o){return o===32||o===10||o===13||o===9},s.isNameStartChar=a,s.isNameChar=function(o){return a(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],544:[function(e,i,s){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(s,"__esModule",{value:!0}),s.CHAR="-퟿-�𐀀-􏿿",s.RESTRICTED_CHAR="-\b\v\f---",s.S=` 	\r
`,s.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",s.NAME_CHAR="-"+s.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",s.CHAR_RE=new RegExp("^["+s.CHAR+"]$","u"),s.RESTRICTED_CHAR_RE=new RegExp("^["+s.RESTRICTED_CHAR+"]$","u"),s.S_RE=new RegExp("^["+s.S+"]+$","u"),s.NAME_START_CHAR_RE=new RegExp("^["+s.NAME_START_CHAR+"]$","u"),s.NAME_CHAR_RE=new RegExp("^["+s.NAME_CHAR+"]$","u"),s.NAME_RE=new RegExp("^["+s.NAME_START_CHAR+"]["+s.NAME_CHAR+"]*$","u"),s.NMTOKEN_RE=new RegExp("^["+s.NAME_CHAR+"]+$","u");function a(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}s.S_LIST=[32,10,13,9],s.isChar=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},s.isRestrictedChar=function(o){return o>=1&&o<=8||o===11||o===12||o>=14&&o<=31||o>=127&&o<=132||o>=134&&o<=159},s.isCharAndNotRestricted=function(o){return o===9||o===10||o===13||o>31&&o<127||o===133||o>159&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},s.isS=function(o){return o===32||o===10||o===13||o===9},s.isNameStartChar=a,s.isNameChar=function(o){return a(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],545:[function(e,i,s){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function a(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}Object.defineProperty(s,"__esModule",{value:!0}),s.NC_NAME_START_CHAR="A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",s.NC_NAME_CHAR="-"+s.NC_NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",s.NC_NAME_START_CHAR_RE=new RegExp("^["+s.NC_NAME_START_CHAR+"]$","u"),s.NC_NAME_CHAR_RE=new RegExp("^["+s.NC_NAME_CHAR+"]$","u"),s.NC_NAME_RE=new RegExp("^["+s.NC_NAME_START_CHAR+"]["+s.NC_NAME_CHAR+"]*$","u"),s.isNCNameStartChar=a,s.isNCNameChar=function(o){return a(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}]},{},[15])(15)})})(EM);var AF=EM.exports,TM={exports:{}};(function(t,n){(function(e,i){i()})(dr,function(){function e(l,h){return typeof h=="undefined"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function i(l,h,f){var d=new XMLHttpRequest;d.open("GET",l),d.responseType="blob",d.onload=function(){u(d.response,h,f)},d.onerror=function(){console.error("could not download file")},d.send()}function s(l){var h=new XMLHttpRequest;h.open("HEAD",l,!1);try{h.send()}catch(f){}return 200<=h.status&&299>=h.status}function a(l){try{l.dispatchEvent(new MouseEvent("click"))}catch(f){var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof dr=="object"&&dr.global===dr?dr:void 0,r=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(l,h,f){var d=o.URL||o.webkitURL,p=document.createElement("a");h=h||l.name||"download",p.download=h,p.rel="noopener",typeof l=="string"?(p.href=l,p.origin===location.origin?a(p):s(p.href)?i(l,h,f):a(p,p.target="_blank")):(p.href=d.createObjectURL(l),setTimeout(function(){d.revokeObjectURL(p.href)},4e4),setTimeout(function(){a(p)},0))}:"msSaveOrOpenBlob"in navigator?function(l,h,f){if(h=h||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(e(l,f),h);else if(s(l))i(l,h,f);else{var d=document.createElement("a");d.href=l,d.target="_blank",setTimeout(function(){a(d)})}}:function(l,h,f,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof l=="string")return i(l,h,f);var p=l.type==="application/octet-stream",b=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||p&&b||r)&&typeof FileReader!="undefined"){var x=new FileReader;x.onloadend=function(){var E=x.result;E=v?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=E:location=E,d=null},x.readAsDataURL(l)}else{var w=o.URL||o.webkitURL,M=w.createObjectURL(l);d?d.location=M:location.href=M,d=null,setTimeout(function(){w.revokeObjectURL(M)},4e4)}});o.saveAs=u.saveAs=u,t.exports=u})})(TM);var SF=TM.exports;const CM=(t,n)=>{const e=t.numVerts(),i=[];for(let s=0;s<e;s++)if(s<e-1){const a=t.getBulgeAt(s),o=t.getPointAt(s).val,r=t.getPointAt(s+1).val;if(n&&(o.transformBy(n),r.transformBy(n)),a){const u=(t.getDistAtPoint(o).val+t.getDistAtPoint(r).val)/2,l=t.getPointAtDist(u).val,h=new A.McDbArc;h.computeArc(o.x,o.y,l.x,l.y,r.x,r.y),i.push(h)}else{const u=new A.McDbLine(o,r);i.push(u)}}else t.isClosed&&i.push(new A.McDbLine(t.getPointAt(0).val,t.getPointAt(e-1).val));return i};function EF(){return re(this,null,function*(){const t=yield PM();t&&t.length&&CF(t)})}function PM(){return re(this,null,function*(){let t=2;const n=1e-4,e=new A.MxCADUiPrDist;e.setMessage(dt("请输入表格提取精度")+`(${t})`);const i=yield e.go();i&&(t=i);const s=new A.MxCADUiPrPoint;s.setMessage(dt("选择提取范围第一个角点"));const a=yield s.go();if(!a)return;s.setMessage(dt("选择提取范围第二个角点")),s.setUserDraw((j,Z)=>{const tt=[j,new A.McGePoint3d(j.x,a.y),a,new A.McGePoint3d(a.x,j.y)];let rt=new A.McDbPolyline;rt.isClosed=!0,tt.forEach(I=>rt.addVertexAt(I)),Z.setColor(16777215),Z.drawMcDbEntity(rt);const J=new THREE.BufferGeometry;J.setFromPoints([new THREE.Vector3(j.x,j.y,j.z),new THREE.Vector3(j.x,a.y,a.z),new THREE.Vector3(a.x,a.y,a.z),new THREE.Vector3(a.x,j.y,j.z)]),J.attributes.uv=new THREE.BufferAttribute(new Float32Array([0,0,1,0,1,1,0,1]),2),J.setIndex([0,1,2,0,2,3]);const U=new THREE.MeshBasicMaterial({color:19712,transparent:!0,opacity:.5,side:THREE.DoubleSide}),G=new THREE.Mesh(J,U);Z.drawEntity(G)});const o=yield s.go();if(!o)return;const r=new A.McGePoint3d(Math.min(a.x,o.x)-t,Math.min(a.y,o.y)-t,0),u=new A.McGePoint3d(Math.max(a.x,o.x)+t,Math.max(a.y,o.y)+t,0),l=[],h=[],f=(j,Z)=>{j.getAllEntityId().forEach(tt=>{let rt=tt.getMcDbEntity();if(rt instanceof A.McDbBlockReference){let J=rt,U=J.blockTransform.clone();U.preMultBy(Z),f(J.blockTableRecordId.getMcDbBlockTableRecord(),U)}else if(h.push({handle:rt.getHandle(),mart:Z}),rt instanceof A.McDbPolyline){const J=CM(rt,Z);l.push(...J)}else l.push(rt)})},d=new A.MxCADSelectionSet;if(yield d.crossingSelect(r.x,r.y,u.x,u.y),!d.count())return MxPluginContext.useMessage().error(dt("未识别到有效表格!")),[];d.forEach(j=>{const Z=j.getMcDbEntity();if(Z instanceof A.McDbBlockReference){let tt=Z.blockTableRecordId.getMcDbBlockTableRecord();const rt=Z.blockTransform.clone();f(tt,rt)}else if(Z instanceof A.McDbPolyline){const tt=CM(Z);l.push(...tt)}else l.push(Z)});const p=l.filter(j=>j.objectName==="McDbLine");if(!p.length)return MxPluginContext.useMessage().error(dt("未识别到有效表格!")),[];const b=[],v=[];if(p.forEach(j=>{const Z=A.McGeVector3d.kXAxis,tt=A.McGeVector3d.kYAxis,rt=j.clone(),J=h.find(G=>G.handle===j.getHandle());J&&(rt.startPoint=rt.startPoint.clone().transformBy(J.mart),rt.endPoint=rt.endPoint.transformBy(J.mart));const U=rt.startPoint.sub(rt.endPoint).normalize().mult(n);(Z.angleTo1(U)<n||Math.abs(Z.angleTo1(U)-Math.PI)<n)&&b.push(new A.McDbLine(rt.startPoint.addvec(U),rt.endPoint.subvec(U))),(tt.angleTo1(U)<n||Math.abs(tt.angleTo1(U)-Math.PI)<n)&&v.push(new A.McDbLine(rt.startPoint.addvec(U),rt.endPoint.subvec(U)))}),!b.length||!v.length)return MxPluginContext.useMessage().error(dt("未识别到有效表格!")),[];const x=(j,Z=1e-4)=>{const tt=Math.abs(Math.floor(Math.log10(Z))),rt=Math.pow(10,tt);return Math.round(j*rt)/rt};let w=[];b.forEach(j=>{v.forEach(Z=>{const tt=j.IntersectWith(Z,A.McDb.Intersect.kOnBothOperands);tt.length()&&tt.forEach(rt=>{rt.x=x(rt.x,n),rt.y=x(rt.y,n),DM([r,new A.McGePoint3d(r.x,u.y),u,new A.McGePoint3d(u.x,r.y)],[rt])&&w.push(rt)})})}),w=th(w);const M=Array.from(new Set(w.map(j=>j.x))).sort((j,Z)=>j-Z),E=Array.from(new Set(w.map(j=>j.y))).sort((j,Z)=>Z-j),D=[];if(E.forEach((j,Z)=>{const tt=[],rt=w.filter(J=>J.y===j);rt.length?(M.forEach((J,U)=>{const G=rt.findIndex(I=>I.x===J);G===-1?(Z===0||Z===E.length-1)&&(U===0||Z===M.length-1)?tt.push(new A.McGePoint3d(J,j)):tt.push(null):tt.push(rt[G])}),D.push(tt)):D.push(null)}),!D.length)return MxPluginContext.useMessage().error(dt("未识别到有效表格!")),[];const N=[],V=TF(D),K=j=>{let Z="";const tt=l.filter(rt=>{const J=rt.clone();let U,G;if(J instanceof A.McDbText){const{minPt:I,maxPt:C}=J.getBoundingBox();U=I,G=C}else if(rt instanceof A.McDbMText){const I=A.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();J.textStyleId=I,J.reCompute();const{minPt:C,maxPt:L}=A.MxCADUtility.getTextEntityBox(J,!1);U=C,G=L}if(G&&U){const I=h.find(C=>C.handle===rt.getHandle());return I&&(U.transformBy(I.mart),G.transformBy(I.mart)),DM(j.flat(),[U.clone().addvec(G.sub(U).mult(.5))])}else return!1});return tt.length&&tt.forEach(rt=>{rt instanceof A.McDbText?Z+=`${rt.textString}
`:rt instanceof A.McDbMText&&(Z+=`${rt.contents}
`)}),Z};return V.forEach(j=>re(this,null,function*(){if(j.merged){const{fullRangeKeys:Z,matrix:tt}=j.merged,rt=K(tt);N.push({type:1,content:rt,name:Z.join("+")})}else if(j.standalone){const{key:Z,matrix:tt}=j.standalone,rt=K(tt);N.push({type:0,content:rt,name:Z})}})),N})}function TF(t){const n=t.length,e=t[0].length;if(n<2||e<2)return;const i={},s={};for(let l=0;l<=n-2;l++)for(let h=0;h<=e-2;h++){const f=`${String.fromCharCode(65+h)}${l+1}`;i[f]=[[t[l][h],t[l][h+1]],[t[l+1][h],t[l+1][h+1]]],s[f]={row:l,col:h}}const a=l=>l.some(h=>h.some(f=>f===null)),o=new Set,r=[],u=l=>{let h=1/0,f=-1/0,d=1/0,p=-1/0;Array.from(l).forEach(w=>{const{row:M,col:E}=s[w];h=Math.min(h,M),f=Math.max(f,M),d=Math.min(d,E),p=Math.max(p,E)});const b=[];for(let w=h;w<=f;w++)for(let M=d;M<=p;M++){const E=`${String.fromCharCode(65+M)}${w+1}`;b.push(E),o.add(E)}const v=(w,M)=>w<n&&M<e?t[w][M]:null,x=[[v(h,d),v(h,p+1)],[v(f+1,d),v(f+1,p+1)]];return{fullRangeKeys:b,newMatrix:x}};for(const l in i){if(o.has(l)||!a(i[l]))continue;const h=new Set,f=[l];for(h.add(l),o.add(l);f.length>0;){const v=f.shift(),{row:x,col:w}=s[v],M=i[v],[E,D]=M[0],[N,V]=M[1],K=w>0?`${String.fromCharCode(64+w)}${x+1}`:null,j=w<e-2?`${String.fromCharCode(66+w)}${x+1}`:null;E===null&&K&&i[K]&&!h.has(K)&&i[K][0][1]===null&&(h.add(K),f.push(K),o.add(K)),D===null&&j&&i[j]&&!h.has(j)&&i[j][0][0]===null&&(h.add(j),f.push(j),o.add(j)),N===null&&K&&i[K]&&!h.has(K)&&i[K][1][1]===null&&(h.add(K),f.push(K),o.add(K)),V===null&&j&&i[j]&&!h.has(j)&&i[j][1][0]===null&&(h.add(j),f.push(j),o.add(j))}if(h.size===1&&f.push(l),!u(h).newMatrix.flat().every(v=>v!==null))for(;f.length>0;){const v=f.shift(),{row:x,col:w}=s[v],M=i[v],[E,D]=M[0],[N,V]=M[1],K=x>0?`${String.fromCharCode(65+w)}${x}`:null,j=x<n-2?`${String.fromCharCode(65+w)}${x+2}`:null;E===null&&K&&i[K]&&!h.has(K)&&i[K][1][0]===null&&(h.add(K),f.push(K),o.add(K)),D===null&&K&&i[K]&&!h.has(K)&&i[K][1][1]===null&&(h.add(K),f.push(K),o.add(K)),N===null&&j&&i[j]&&!h.has(j)&&i[j][0][0]===null&&(h.add(j),f.push(j),o.add(j)),V===null&&j&&i[j]&&!h.has(j)&&i[j][0][1]===null&&(h.add(j),f.push(j),o.add(j))}const{fullRangeKeys:d,newMatrix:p}=u(h);(v=>{const x=new Set;for(const w of v){const M=w.match(/^[A-Z]+/);M&&x.add(M[0])}return x.size===1})(d)?r.push({merged:{fullRangeKeys:d,matrix:p}}):PF(t,d).forEach(x=>{r.push({merged:{fullRangeKeys:u(new Set(x.name.split("+"))).fullRangeKeys,matrix:x.data}})})}for(const l in i)o.has(l)||r.push({standalone:{key:l,matrix:i[l]}});return r}function DM(t,n){const e=t.map(l=>l.x),i=t.map(l=>l.y),s=Math.min(...e),a=Math.max(...e),o=Math.min(...i),r=Math.max(...i),u=l=>l.x>=s&&l.x<=a&&l.y>=o&&l.y<=r;return n.every(l=>u(l))}function CF(t,n="tableData.xlsx"){return re(this,null,function*(){const e=new AF.Workbook,i=e.addWorksheet("Sheet1"),s=/^([A-Z]+)(\d+)$/,a=[],o=[];function r(p){const b=p.match(s);if(!b)throw new Error(`无效的单元格名: ${p}`);const[,v,x]=b;let w=0;for(let M=0;M<v.length;M++)w=w*26+(v.charCodeAt(M)-64);return{row:parseInt(x),col:w}}for(const p of t)if(p.type===1){const v=p.name.split("+").map(N=>N.trim()).map(r),x=Math.min(...v.map(N=>N.row)),w=Math.max(...v.map(N=>N.row)),M=Math.min(...v.map(N=>N.col)),E=Math.max(...v.map(N=>N.col));a.push({start:{row:x,col:M},end:{row:w,col:E}}),i.mergeCells(x,M,w,E);const D=i.getCell(x,M);D.value=p.content,D.alignment={horizontal:"center",vertical:"middle"}}else if(p.type===0){const b=r(p.name);o.push({row:b.row,col:b.col,value:p.content})}for(const p of o)if(!a.some(v=>p.row>=v.start.row&&p.row<=v.end.row&&p.col>=v.start.col&&p.col<=v.end.col)){const v=i.getCell(p.row,p.col);v.value=p.value}const u={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}};let l=1,h=1;[...o,...a.flatMap(p=>[p.start,{row:p.end.row,col:p.end.col}])].forEach(p=>{l=Math.max(l,p.row),h=Math.max(h,p.col)});for(let p=1;p<=l;p++)for(let b=1;b<=h;b++){const v=i.getCell(p,b);v.value!==null&&v.value!==void 0&&(v.border=u,v.alignment||(v.alignment={horizontal:"center",vertical:"middle",wrapText:!0}))}const f=yield e.xlsx.writeBuffer(),d=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});SF.saveAs(d,n)})}function PF(t,n){if(!t||t.length===0||t[0].length<2)throw new Error("Matrix must be at least 1x2");const e=new Map;for(const d of n){const p=d.trim().toUpperCase(),b=p.match(/^([A-Z])(\d+)$/);if(!b)continue;const v=b[1].charCodeAt(0)-65,x=parseInt(b[2],10)-1;x>=0&&v>=0&&x<=t.length-2&&v<=t[0].length-2&&e.set(p,{row:x,col:v})}if(e.size===0)return console.log("No valid submatrices found in input."),[];const i=new Map;e.forEach((d,p)=>{i.has(d.col)||i.set(d.col,new Map),i.get(d.col).set(d.row,p)});const s=Array.from(i.keys()).sort((d,p)=>d-p);if(s.length<2)return console.log("Need at least two columns for combination."),[];const a=s[0],o=s[s.length-1],r=i.get(a),u=i.get(o),l=Array.from(r.keys()).sort((d,p)=>d-p),h=Array.from(u.keys()).sort((d,p)=>d-p),f=[];for(const d of l){const p=r.get(d),b=d+1;for(const v of h){const x=u.get(v),w=v+1;if(b>w)continue;const M=`${p}+${x}`;try{const E=`${String.fromCharCode(65+o)}${b}`,D=`${String.fromCharCode(65+a)}${w}`;if(!e.has(E)||!e.has(D)){console.warn(`Required blocks not found for ${M}: ${E}, ${D}`);continue}const N=e.get(E),V=e.get(D),K=t[d][a],j=t[N.row][N.col+1],Z=t[V.row+1][V.col],tt=t[v+1][o+1],rt=[[K,j],[Z,tt]];if(!rt.flat().filter(J=>!J).length){f.push({name:M,data:rt});break}}catch(E){console.warn(`Error processing ${M}:`,E);continue}}}return f}function DF(){return location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1"}function RF(){return re(this,null,function*(){if(!DF())return MxPluginContext.useMessage().warning(dt("请在本地环境测试！"));const t=yield PM();t&&t.length&&window.open(`http://localhost:5500/dist/spreadJs.html?tableData=${JSON.stringify(t)}`)})}const RM=12868,kF=16711680;class Fb extends Ct.MxDbEntity{constructor(){super(...arguments),this.points=[],this.isFill=!1,this.fillColor=6697540,this.fillOpacity=.7}getTypeName(){return"MxDbTestReact"}create(){return new Fb}worldDraw(n){if(this.points.length<3){this.points.length==2&&n.drawLine(this.points[0],this.points[1]);return}let e=this.points[0],i=this.points.length;for(let s=1;s<i;s++){let a=this.points[s];n.drawLine(e,a),e=a}if(n.drawLine(e,this.points[0]),n.getType()==Ct.McGiWorldDrawType.kWorldDraw&&this.isFill){n.setColor(this.fillColor),n.setOpacity(this.fillOpacity),n.setRenderOrder(n.getRenderOrder()-1);const s=new Ct.MxDbHatch;s.points=this.points,s.worldDraw(n)}}getGripPoints(){return this.points}moveGripPointsAt(n,e){return n>=this.points.length?!1:(this.points[n].add(e),!0)}dwgIn(n){this.onDwgIn(n);let e=n.points;return this.points=[],e.forEach(i=>{this.points.push(new THREE.Vector3(i.x,i.y,i.z))}),this.dwgInHelp(n,["isFill","fillColor","fillOpacity"]),!0}dwgOut(n){return this.onDwgOut(n),n.points=this.points,this.dwgOutHelp(n,["isFill","fillColor","fillOpacity"]),n}addPoint(n){this.points.push(n.clone())}getPoints(){return this.points}clearPoint(){this.points=[]}}function IF(t,n){let e=0;return function(...i){const s=Date.now();s-e>=n&&(t.apply(this,i),e=s)}}let kM=0;function LF(){const t=A.MxCpp.getCurrentMxCAD(),n=document.getElementById("myCanvas"),e=s=>{const a=Ct.MxFun.getCurrentDraw(),o=a.getAllMxEntity(),r=a.findMxEntityAtPoint(s);o.length&&(o.forEach(u=>{u.getTypeName()==="MxDbTestReact"&&(r.includes(u)?u.fillColor=kF:u.fillColor=RM,u.setNeedUpdateDisplay(!0))}),t.updateDisplay())};kM||n==null||n.addEventListener("mousemove",IF(s=>{const a=t.mxdraw.viewCoord2Cad(s.clientX,s.clientY,0);e(a)},100)),t.newFile();const i=new Fb;i.addPoint(new THREE.Vector3(1e3,1e3)),i.addPoint(new THREE.Vector3(1e3,3e3)),i.addPoint(new THREE.Vector3(3e3,3e3)),i.addPoint(new THREE.Vector3(3e3,1e3)),i.isFill=!0,i.fillColor=RM,i.fillOpacity=.5,Ct.MxFun.getCurrentDraw().addMxEntity(i),kM+=1}function BF(){return re(this,null,function*(){let t=new A.MxCADUiPrPoint;t.setMessage(dt("指定裁剪角点1"));const n=yield t.go();if(!n)return;t.setMessage(dt("指定裁剪角点2")),t.setUserDraw((r,u)=>{u.setColor(16711680);let l=new A.McDbPolyline;l.addVertexAt(n),l.addVertexAt(new A.McGePoint3d(n.x,r.y)),l.addVertexAt(r),l.addVertexAt(new A.McGePoint3d(r.x,n.y)),l.constantWidth=Ct.MxFun.screenCoordLong2Doc(2),l.isClosed=!0,u.drawMcDbEntity(l);let h=[];h.push(n.toVector3()),h.push(new THREE.Vector3(n.x,r.y)),h.push(r.toVector3()),h.push(new THREE.Vector3(r.x,n.y)),u.setColor(12868),u.drawSolid(h,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let e=yield t.go();if(!e)return;let i=window.location.protocol,s=window.location.hostname,a=i+"//"+s+":1337/mxcad/cut_mxweb",o={bd_pt1_x:""+n.x,bd_pt1_y:""+n.y,bd_pt2_x:""+e.x,bd_pt2_y:""+e.y};A.MxCpp.getCurrentMxCAD().saveFileToUrl(a,(r,u)=>{try{let l=JSON.parse(u);if(l.ret=="ok"){let h=i+"//"+s+":1337/mxcad/file/"+l.file;FF(h,"MxWeb"+Math.random())}else console.log(u)}catch(l){console.log("Mx: sserverResult error")}},void 0,JSON.stringify(o))})}function FF(t,n){return re(this,null,function*(){var f;let e=A.MxCpp.App.getCurrentMxCAD(),i=yield e.insertBlock(t,n);if(!i.isValid())return;let s=new A.McDbBlockReference;s.blockTableRecordId=i;const a=(f=i.getMcDbBlockTableRecord())==null?void 0:f.getAllEntityId();if(!a)return;a.length===1&&a[0].isKindOf("McDbBlockReference")&&(s.blockTableRecordId=a[0].getMcDbEntity().blockTableRecordId);let o=s.getBoundingBox(),r=s.blockTableRecordId.getMcDbBlockTableRecord();r.origin=o.minPt.clone().addvec(o.maxPt.sub(o.minPt).mult(.5));let u=new A.MxCADUiPrPoint;u.setMessage("指定插入基点"),u.setUserDraw((d,p)=>{s.position=d,p.drawMcDbEntity(s)});let l=yield u.go();if(!l)return;s.position=l;let h=e.drawEntity(s);if(h.isValid){let d=new A.McGeLongArray;d.copyFormAryId([h]),A.MxCpp.App.MxCADAssist.MxExplode(d.imp)}else{console.log("insert error");return}})}function NF(){MxPluginContext.addCommand("Mx_ReactChangeColor",LF),MxPluginContext.addCommand("Mx_Cut_MxWebToFile",BF),MxPluginContext.addCommand("Mx_TestGetTable",EF),MxPluginContext.addCommand("Mx_TestEditTable",RF)}var IM={exports:{}};(function(t,n){(function(e,i){t.exports=i()})(dr,function(){var e,i,s;function a(r,u){if(!e)e=u;else if(!i)i=u;else{var l="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",h={};e(h),s=u(h),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([l],{type:"text/javascript"})))}}a(["exports"],function(r){var u="2.8.2",l=h;function h(g,c,y,_){this.cx=3*g,this.bx=3*(y-g)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(_-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=g,this.p1y=_,this.p2x=y,this.p2y=_}h.prototype.sampleCurveX=function(g){return((this.ax*g+this.bx)*g+this.cx)*g},h.prototype.sampleCurveY=function(g){return((this.ay*g+this.by)*g+this.cy)*g},h.prototype.sampleCurveDerivativeX=function(g){return(3*this.ax*g+2*this.bx)*g+this.cx},h.prototype.solveCurveX=function(g,c){var y,_,T,R,z;for(c===void 0&&(c=1e-6),T=g,z=0;z<8;z++){if(R=this.sampleCurveX(T)-g,Math.abs(R)<c)return T;var W=this.sampleCurveDerivativeX(T);if(Math.abs(W)<1e-6)break;T-=R/W}if((T=g)<(y=0))return y;if(T>(_=1))return _;for(;y<_;){if(R=this.sampleCurveX(T),Math.abs(R-g)<c)return T;g>R?y=T:_=T,T=.5*(_-y)+y}return T},h.prototype.solve=function(g,c){return this.sampleCurveY(this.solveCurveX(g,c))};var f=d;function d(g,c){this.x=g,this.y=c}d.prototype={clone:function(){return new d(this.x,this.y)},add:function(g){return this.clone()._add(g)},sub:function(g){return this.clone()._sub(g)},multByPoint:function(g){return this.clone()._multByPoint(g)},divByPoint:function(g){return this.clone()._divByPoint(g)},mult:function(g){return this.clone()._mult(g)},div:function(g){return this.clone()._div(g)},rotate:function(g){return this.clone()._rotate(g)},rotateAround:function(g,c){return this.clone()._rotateAround(g,c)},matMult:function(g){return this.clone()._matMult(g)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(g){return this.x===g.x&&this.y===g.y},dist:function(g){return Math.sqrt(this.distSqr(g))},distSqr:function(g){var c=g.x-this.x,y=g.y-this.y;return c*c+y*y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(g){return Math.atan2(this.y-g.y,this.x-g.x)},angleWith:function(g){return this.angleWithSep(g.x,g.y)},angleWithSep:function(g,c){return Math.atan2(this.x*c-this.y*g,this.x*g+this.y*c)},_matMult:function(g){var c=g[2]*this.x+g[3]*this.y;return this.x=g[0]*this.x+g[1]*this.y,this.y=c,this},_add:function(g){return this.x+=g.x,this.y+=g.y,this},_sub:function(g){return this.x-=g.x,this.y-=g.y,this},_mult:function(g){return this.x*=g,this.y*=g,this},_div:function(g){return this.x/=g,this.y/=g,this},_multByPoint:function(g){return this.x*=g.x,this.y*=g.y,this},_divByPoint:function(g){return this.x/=g.x,this.y/=g.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var g=this.y;return this.y=this.x,this.x=-g,this},_rotate:function(g){var c=Math.cos(g),y=Math.sin(g),_=y*this.x+c*this.y;return this.x=c*this.x-y*this.y,this.y=_,this},_rotateAround:function(g,c){var y=Math.cos(g),_=Math.sin(g),T=c.y+_*(this.x-c.x)+y*(this.y-c.y);return this.x=c.x+y*(this.x-c.x)-_*(this.y-c.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(g){return g instanceof d?g:Array.isArray(g)?new d(g[0],g[1]):g};var p=typeof self!="undefined"?self:{};const b=Math.PI/180,v=180/Math.PI;function x(g){return g*b}function w(g){return g*v}const M=[[0,0],[1,0],[1,1],[0,1]];function E(g){if(g<=0)return 0;if(g>=1)return 1;const c=g*g,y=c*g;return 4*(g<.5?y:3*(g-c)+y-.75)}function D(g,c,y,_){const T=new l(g,c,y,_);return function(R){return T.solve(R)}}const N=D(.25,.1,.25,1);function V(g,c,y){return Math.min(y,Math.max(c,g))}function K(g,c,y){return(y=V((y-g)/(c-g),0,1))*y*(3-2*y)}function j(g,c,y){const _=y-c,T=((g-c)%_+_)%_+c;return T===c?y:T}function Z(g,c,y){if(!g.length)return y(null,[]);let _=g.length;const T=new Array(g.length);let R=null;g.forEach((z,W)=>{c(z,(et,st)=>{et&&(R=et),T[W]=st,--_==0&&y(R,T)})})}function tt(g){const c=[];for(const y in g)c.push(g[y]);return c}function rt(g,...c){for(const y of c)for(const _ in y)g[_]=y[_];return g}let J=1;function U(){return J++}function G(){return function g(c){return c?(c^Math.random()*(16>>c/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,g)}()}function I(g){return g<=1?1:Math.pow(2,Math.ceil(Math.log(g)/Math.LN2))}function C(g){return!!g&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(g)}function L(g,c){g.forEach(y=>{c[y]&&(c[y]=c[y].bind(c))})}function B(g,c){return g.indexOf(c,g.length-c.length)!==-1}function O(g,c,y){const _={};for(const T in g)_[T]=c.call(y||this,g[T],T,g);return _}function q(g,c,y){const _={};for(const T in g)c.call(y||this,g[T],T,g)&&(_[T]=g[T]);return _}function it(g){return Array.isArray(g)?g.map(it):typeof g=="object"&&g?O(g,it):g}const nt={};function lt(g){nt[g]||(typeof console!="undefined"&&console.warn(g),nt[g]=!0)}function ut(g,c,y){return(y.y-g.y)*(c.x-g.x)>(c.y-g.y)*(y.x-g.x)}function vt(g){let c=0;for(let y,_,T=0,R=g.length,z=R-1;T<R;z=T++)y=g[T],_=g[z],c+=(_.x-y.x)*(y.y+_.y);return c}function Q(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function gt(g){const c={};if(g.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(y,_,T,R)=>{const z=T||R;return c[_]=!z||z.toLowerCase(),""}),c["max-age"]){const y=parseInt(c["max-age"],10);isNaN(y)?delete c["max-age"]:c["max-age"]=y}return c}let Y,H,at,ft,wt=null;function _t(g){if(wt==null){const c=g.navigator?g.navigator.userAgent:null;wt=!!g.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return wt}function Dt(g){try{const c=p[g];return c.setItem("_mapbox_test_",1),c.removeItem("_mapbox_test_"),!0}catch(c){return!1}}const Gt={now:()=>at!==void 0?at:p.performance.now(),setNow(g){at=g},restoreNow(){at=void 0},frame(g){const c=p.requestAnimationFrame(g);return{cancel:()=>p.cancelAnimationFrame(c)}},getImageData(g,c=0){const{width:y,height:_}=g;ft||(ft=p.document.createElement("canvas"));const T=ft.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return(y>ft.width||_>ft.height)&&(ft.width=y,ft.height=_),T.clearRect(-c,-c,y+2*c,_+2*c),T.drawImage(g,0,0,y,_),T.getImageData(-c,-c,y+2*c,_+2*c)},resolveURL:g=>(Y||(Y=p.document.createElement("a")),Y.href=g,Y.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(H==null&&(H=p.matchMedia("(prefers-reduced-motion: reduce)")),H.matches)}};let te;const mt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(te==null){const g=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{te={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):g}catch(c){te=g}}return te},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},At={supported:!1,testSupport:function(g){!he&&Zt&&(fe?be(g):Ot=g)}};let Ot,Zt,he=!1,fe=!1;function be(g){const c=g.createTexture();g.bindTexture(g.TEXTURE_2D,c);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Zt),g.isContextLost())return;At.supported=!0}catch(y){}g.deleteTexture(c),he=!0}p.document&&(Zt=p.document.createElement("img"),Zt.onload=function(){Ot&&be(Ot),Ot=null,fe=!0},Zt.onerror=function(){he=!0,Ot=null},Zt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Me="01",Pe="NO_ACCESS_TOKEN";function ze(g){return g.indexOf("mapbox:")===0}function Ce(g){return mt.API_URL_REGEX.test(g)}const Le=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ye(g){const c=g.match(Le);if(!c)throw new Error("Unable to parse URL object");return{protocol:c[1],authority:c[2],path:c[3]||"/",params:c[4]?c[4].split("&"):[]}}function le(g){const c=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${c}`}function Fe(g){if(!g)return null;const c=g.split(".");if(!c||c.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(c[1]).split("").map(y=>"%"+("00"+y.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(y){return null}}class Ke{constructor(c){this.type=c,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(c){const y=Fe(mt.ACCESS_TOKEN);let _="";return _=y&&y.u?p.btoa(encodeURIComponent(y.u).replace(/%([0-9A-F]{2})/g,(T,R)=>String.fromCharCode(+("0x"+R)))):mt.ACCESS_TOKEN||"",c?`mapbox.eventData.${c}:${_}`:`mapbox.eventData:${_}`}fetchEventData(){const c=Dt("localStorage"),y=this.getStorageKey(),_=this.getStorageKey("uuid");if(c)try{const T=p.localStorage.getItem(y);T&&(this.eventData=JSON.parse(T));const R=p.localStorage.getItem(_);R&&(this.anonId=R)}catch(T){lt("Unable to read from LocalStorage")}}saveEventData(){const c=Dt("localStorage"),y=this.getStorageKey(),_=this.getStorageKey("uuid");if(c)try{p.localStorage.setItem(_,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(y,JSON.stringify(this.eventData))}catch(T){lt("Unable to write to LocalStorage")}}processRequests(c){}postEvent(c,y,_,T){if(!mt.EVENTS_URL)return;const R=Ye(mt.EVENTS_URL);R.params.push(`access_token=${T||mt.ACCESS_TOKEN||""}`);const z={event:this.type,created:new Date(c).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:u,skuId:Me,userId:this.anonId},W=y?rt(z,y):z,et={url:le(R),headers:{"Content-Type":"text/plain"},body:JSON.stringify([W])};this.pendingRequest=It(et,st=>{this.pendingRequest=null,_(st),this.saveEventData(),this.processRequests(T)})}queueRequest(c,y){this.queue.push(c),this.processRequests(y)}}const Ze=new class extends Ke{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,c){mt.EVENTS_URL&&mt.ACCESS_TOKEN&&Array.isArray(g)&&g.some(y=>ze(y)||Ce(y))&&this.queueRequest(Date.now(),c)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const c=Fe(mt.ACCESS_TOKEN),y=c?c.u:mt.ACCESS_TOKEN;let _=y!==this.eventData.tokenU;C(this.anonId)||(this.anonId=G(),_=!0);const T=this.queue.shift();if(this.eventData.lastSuccess){const R=new Date(this.eventData.lastSuccess),z=new Date(T),W=(T-this.eventData.lastSuccess)/864e5;_=_||W>=1||W<-1||R.getDate()!==z.getDate()}else _=!0;_?this.postEvent(T,{"enabled.telemetry":!1},R=>{R||(this.eventData.lastSuccess=T,this.eventData.tokenU=y)},g):this.processRequests()}},ke=Ze.postTurnstileEvent.bind(Ze),Qe=new class extends Ke{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,c,y,_){this.skuToken=c,this.errorCb=_,mt.EVENTS_URL&&(y||mt.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},y):this.errorCb(new Error(Pe)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:c,timestamp:y}=this.queue.shift();c&&this.success[c]||(this.anonId||this.fetchEventData(),C(this.anonId)||(this.anonId=G()),this.postEvent(y,{skuToken:this.skuToken},_=>{_?this.errorCb(_):c&&(this.success[c]=!0)},g))}},hn=Qe.postMapLoadEvent.bind(Qe),ln=new class extends Ke{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,c,y,_){if(!mt.API_URL||!mt.SESSION_PATH)return;const T=Ye(mt.API_URL+mt.SESSION_PATH);T.params.push(`sku=${c||""}`),T.params.push(`access_token=${_||mt.ACCESS_TOKEN||""}`);const R={url:le(T),headers:{"Content-Type":"text/plain"}};this.pendingRequest=zt(R,z=>{this.pendingRequest=null,y(z),this.saveEventData(),this.processRequests(_)})}getSessionAPI(g,c,y,_){this.skuToken=c,this.errorCb=_,mt.SESSION_PATH&&mt.API_URL&&(y||mt.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},y):this.errorCb(new Error(Pe)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:c,timestamp:y}=this.queue.shift();c&&this.success[c]||this.getSession(y,this.skuToken,_=>{_?this.errorCb(_):c&&(this.success[c]=!0)},g)}},Hn=ln.getSessionAPI.bind(ln),Tn=new Set,Sn="mapbox-tiles";let On,qn,Pn=500,cr=50;function Yn(){p.caches&&!On&&(On=p.caches.open(Sn))}function zn(g){const c=g.indexOf("?");return c<0?g:g.slice(0,c)}let Qn=1/0;const Wt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Wt);class St extends Error{constructor(c,y,_){y===401&&Ce(_)&&(c+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(c),this.status=y,this.url=_}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Rt=Q()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,jt=function(g,c){if(!(/^file:/.test(y=g.url)||/^file:/.test(Rt())&&!/^\w+:/.test(y))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(_,T){const R=new p.AbortController,z=new p.Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:Rt(),signal:R.signal});let W=!1,et=!1;const st=(ht=z.url).indexOf("sku=")>0&&Ce(ht);var ht;_.type==="json"&&z.headers.set("Accept","application/json");const pt=(Et,kt,Ft)=>{if(et)return;if(Et&&Et.message!=="SecurityError"&&lt(Et),kt&&Ft)return bt(kt);const Vt=Date.now();p.fetch(z).then($t=>{if($t.ok){const ue=st?$t.clone():null;return bt($t,ue,Vt)}return T(new St($t.statusText,$t.status,_.url))}).catch($t=>{$t.code!==20&&T(new Error($t.message))})},bt=(Et,kt,Ft)=>{(_.type==="arrayBuffer"?Et.arrayBuffer():_.type==="json"?Et.json():Et.text()).then(Vt=>{et||(kt&&Ft&&function($t,ue,ge){if(Yn(),!On)return;const xe={status:ue.status,statusText:ue.statusText,headers:new p.Headers};ue.headers.forEach((Be,Oe)=>xe.headers.set(Oe,Be));const _e=gt(ue.headers.get("Cache-Control")||"");if(_e["no-store"])return;_e["max-age"]&&xe.headers.set("Expires",new Date(ge+1e3*_e["max-age"]).toUTCString());const we=xe.headers.get("Expires");we&&(new Date(we).getTime()-ge<42e4||function(Be,Oe){if(qn===void 0)try{new Response(new ReadableStream),qn=!0}catch(Je){qn=!1}qn?Oe(Be.body):Be.blob().then(Oe)}(ue,Be=>{const Oe=new p.Response(Be,xe);Yn(),On&&On.then(Je=>Je.put(zn($t.url),Oe)).catch(Je=>lt(Je.message))}))}(z,kt,Ft),W=!0,T(null,Vt,Et.headers.get("Cache-Control"),Et.headers.get("Expires")))}).catch(Vt=>{et||T(new Error(Vt.message))})};return st?function(Et,kt){if(Yn(),!On)return kt(null);const Ft=zn(Et.url);On.then(Vt=>{Vt.match(Ft).then($t=>{const ue=function(ge){if(!ge)return!1;const xe=new Date(ge.headers.get("Expires")||0),_e=gt(ge.headers.get("Cache-Control")||"");return xe>Date.now()&&!_e["no-cache"]}($t);Vt.delete(Ft),ue&&Vt.put(Ft,$t.clone()),kt(null,$t,ue)}).catch(kt)}).catch(kt)}(z,pt):pt(null,null),{cancel:()=>{et=!0,W||R.abort()}}}(g,c);if(Q()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",g,c,void 0,!0)}var y;return function(_,T){const R=new p.XMLHttpRequest;R.open(_.method||"GET",_.url,!0),_.type==="arrayBuffer"&&(R.responseType="arraybuffer");for(const z in _.headers)R.setRequestHeader(z,_.headers[z]);return _.type==="json"&&(R.responseType="text",R.setRequestHeader("Accept","application/json")),R.withCredentials=_.credentials==="include",R.onerror=()=>{T(new Error(R.statusText))},R.onload=()=>{if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){let z=R.response;if(_.type==="json")try{z=JSON.parse(R.response)}catch(W){return T(W)}T(null,z,R.getResponseHeader("Cache-Control"),R.getResponseHeader("Expires"))}else T(new St(R.statusText,R.status,_.url))},R.send(_.body),{cancel:()=>R.abort()}}(g,c)},Xt=function(g,c){return jt(rt(g,{type:"arrayBuffer"}),c)},It=function(g,c){return jt(rt(g,{method:"POST"}),c)},zt=function(g,c){return jt(rt(g,{method:"GET"}),c)};function Kt(g){const c=p.document.createElement("a");return c.href=g,c.protocol===p.document.location.protocol&&c.host===p.document.location.host}const Qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let me,ve;me=[],ve=0;const Xe=function(g,c){if(At.supported&&(g.headers||(g.headers={}),g.headers.accept="image/webp,*/*"),ve>=mt.MAX_PARALLEL_IMAGE_REQUESTS){const R={requestParameters:g,callback:c,cancelled:!1,cancel(){this.cancelled=!0}};return me.push(R),R}ve++;let y=!1;const _=()=>{if(!y)for(y=!0,ve--;me.length&&ve<mt.MAX_PARALLEL_IMAGE_REQUESTS;){const R=me.shift(),{requestParameters:z,callback:W,cancelled:et}=R;et||(R.cancel=Xe(z,W).cancel)}},T=Xt(g,(R,z,W,et)=>{_(),R?c(R):z&&(p.createImageBitmap?function(st,ht){const pt=new p.Blob([new Uint8Array(st)],{type:"image/png"});p.createImageBitmap(pt).then(bt=>{ht(null,bt)}).catch(bt=>{ht(new Error(`Could not load image because of ${bt.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(z,(st,ht)=>c(st,ht,W,et)):function(st,ht){const pt=new p.Image,bt=p.URL;pt.onload=()=>{ht(null,pt),bt.revokeObjectURL(pt.src),pt.onload=null,p.requestAnimationFrame(()=>{pt.src=Qt})},pt.onerror=()=>ht(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Et=new p.Blob([new Uint8Array(st)],{type:"image/png"});pt.src=st.byteLength?bt.createObjectURL(Et):Qt}(z,(st,ht)=>c(st,ht,W,et)))});return{cancel:()=>{T.cancel(),_()}}};function Ee(g,c,y){y[g]&&y[g].indexOf(c)!==-1||(y[g]=y[g]||[],y[g].push(c))}function $e(g,c,y){if(y&&y[g]){const _=y[g].indexOf(c);_!==-1&&y[g].splice(_,1)}}class Tt{constructor(c,y={}){rt(this,y),this.type=c}}class Lt extends Tt{constructor(c,y={}){super("error",rt({error:c},y))}}class ee{on(c,y){return this._listeners=this._listeners||{},Ee(c,y,this._listeners),this}off(c,y){return $e(c,y,this._listeners),$e(c,y,this._oneTimeListeners),this}once(c,y){return y?(this._oneTimeListeners=this._oneTimeListeners||{},Ee(c,y,this._oneTimeListeners),this):new Promise(_=>this.once(c,_))}fire(c,y){typeof c=="string"&&(c=new Tt(c,y||{}));const _=c.type;if(this.listens(_)){c.target=this;const T=this._listeners&&this._listeners[_]?this._listeners[_].slice():[];for(const W of T)W.call(this,c);const R=this._oneTimeListeners&&this._oneTimeListeners[_]?this._oneTimeListeners[_].slice():[];for(const W of R)$e(_,W,this._oneTimeListeners),W.call(this,c);const z=this._eventedParent;z&&(rt(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),z.fire(c))}else c instanceof Lt&&console.error(c.error);return this}listens(c){return!!(this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c))}setEventedParent(c,y){return this._eventedParent=c,this._eventedParentData=y,this}}var Yt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ve(g,...c){for(const y of c)for(const _ in y)g[_]=y[_];return g}function Ue(g){return g instanceof Number||g instanceof String||g instanceof Boolean?g.valueOf():g}function en(g){if(Array.isArray(g))return g.map(en);if(g instanceof Object&&!(g instanceof Number||g instanceof String||g instanceof Boolean)){const c={};for(const y in g)c[y]=en(g[y]);return c}return Ue(g)}class gn extends Error{constructor(c,y){super(y),this.message=y,this.key=c}}class qt{constructor(c,y=[]){this.parent=c,this.bindings={};for(const[_,T]of y)this.bindings[_]=T}concat(c){return new qt(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const ye={kind:"null"},pe={kind:"number"},Te={kind:"string"},We={kind:"boolean"},Ie={kind:"color"},Ge={kind:"object"},mn={kind:"value"},In={kind:"collator"},Wn={kind:"formatted"},vn={kind:"resolvedImage"};function jn(g,c){return{kind:"array",itemType:g,N:c}}function Xn(g){if(g.kind==="array"){const c=Xn(g.itemType);return typeof g.N=="number"?`array<${c}, ${g.N}>`:g.itemType.kind==="value"?"array":`array<${c}>`}return g.kind}const ur=[ye,pe,Te,We,Ie,Wn,Ge,jn(mn),vn];function wr(g,c){if(c.kind==="error")return null;if(g.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!wr(g.itemType,c.itemType))&&(typeof g.N!="number"||g.N===c.N))return null}else{if(g.kind===c.kind)return null;if(g.kind==="value"){for(const y of ur)if(!wr(y,c))return null}}return`Expected ${Xn(g)} but found ${Xn(c)} instead.`}function Ur(g,c){return c.some(y=>y.kind===g.kind)}function qr(g,c){return c.some(y=>y==="null"?g===null:y==="array"?Array.isArray(g):y==="object"?g&&!Array.isArray(g)&&typeof g=="object":y===typeof g)}function Ei(g){var c={exports:{}};return g(c,c.exports),c.exports}var Wi=Ei(function(g,c){var y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function _(W){return(W=Math.round(W))<0?0:W>255?255:W}function T(W){return _(W[W.length-1]==="%"?parseFloat(W)/100*255:parseInt(W))}function R(W){return(et=W[W.length-1]==="%"?parseFloat(W)/100:parseFloat(W))<0?0:et>1?1:et;var et}function z(W,et,st){return st<0?st+=1:st>1&&(st-=1),6*st<1?W+(et-W)*st*6:2*st<1?et:3*st<2?W+(et-W)*(2/3-st)*6:W}try{c.parseCSSColor=function(W){var et,st=W.replace(/ /g,"").toLowerCase();if(st in y)return y[st].slice();if(st[0]==="#")return st.length===4?(et=parseInt(st.substr(1),16))>=0&&et<=4095?[(3840&et)>>4|(3840&et)>>8,240&et|(240&et)>>4,15&et|(15&et)<<4,1]:null:st.length===7&&(et=parseInt(st.substr(1),16))>=0&&et<=16777215?[(16711680&et)>>16,(65280&et)>>8,255&et,1]:null;var ht=st.indexOf("("),pt=st.indexOf(")");if(ht!==-1&&pt+1===st.length){var bt=st.substr(0,ht),Et=st.substr(ht+1,pt-(ht+1)).split(","),kt=1;switch(bt){case"rgba":if(Et.length!==4)return null;kt=R(Et.pop());case"rgb":return Et.length!==3?null:[T(Et[0]),T(Et[1]),T(Et[2]),kt];case"hsla":if(Et.length!==4)return null;kt=R(Et.pop());case"hsl":if(Et.length!==3)return null;var Ft=(parseFloat(Et[0])%360+360)%360/360,Vt=R(Et[1]),$t=R(Et[2]),ue=$t<=.5?$t*(Vt+1):$t+Vt-$t*Vt,ge=2*$t-ue;return[_(255*z(ge,ue,Ft+1/3)),_(255*z(ge,ue,Ft)),_(255*z(ge,ue,Ft-1/3)),kt];default:return null}}return null}}catch(W){}});class ar{constructor(c,y,_,T=1){this.r=c,this.g=y,this.b=_,this.a=T}static parse(c){if(!c)return;if(c instanceof ar)return c;if(typeof c!="string")return;const y=Wi.parseCSSColor(c);return y?new ar(y[0]/255*y[3],y[1]/255*y[3],y[2]/255*y[3],y[3]):void 0}toString(){const[c,y,_,T]=this.toArray();return`rgba(${Math.round(c)},${Math.round(y)},${Math.round(_)},${T})`}toArray(){const{r:c,g:y,b:_,a:T}=this;return T===0?[0,0,0,0]:[255*c/T,255*y/T,255*_/T,T]}}ar.black=new ar(0,0,0,1),ar.white=new ar(1,1,1,1),ar.transparent=new ar(0,0,0,0),ar.red=new ar(1,0,0,1),ar.blue=new ar(0,0,1,1);class no{constructor(c,y,_){this.sensitivity=c?y?"variant":"case":y?"accent":"base",this.locale=_,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,y){return this.collator.compare(c,y)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ts{constructor(c,y,_,T,R){this.text=c.normalize?c.normalize():c,this.image=y,this.scale=_,this.fontStack=T,this.textColor=R}}class $n{constructor(c){this.sections=c}static fromString(c){return new $n([new ts(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof $n?c:$n.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}serialize(){const c=["format"];for(const y of this.sections){if(y.image){c.push(["image",y.image.name]);continue}c.push(y.text);const _={};y.fontStack&&(_["text-font"]=["literal",y.fontStack.split(",")]),y.scale&&(_["font-scale"]=y.scale),y.textColor&&(_["text-color"]=["rgba"].concat(y.textColor.toArray())),c.push(_)}return c}}class rr{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new rr({name:c,available:!1}):null}serialize(){return["image",this.name]}}function ii(g,c,y,_){return typeof g=="number"&&g>=0&&g<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof y=="number"&&y>=0&&y<=255?_===void 0||typeof _=="number"&&_>=0&&_<=1?null:`Invalid rgba value [${[g,c,y,_].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof _=="number"?[g,c,y,_]:[g,c,y]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Mo(g){if(g===null||typeof g=="string"||typeof g=="boolean"||typeof g=="number"||g instanceof ar||g instanceof no||g instanceof $n||g instanceof rr)return!0;if(Array.isArray(g)){for(const c of g)if(!Mo(c))return!1;return!0}if(typeof g=="object"){for(const c in g)if(!Mo(g[c]))return!1;return!0}return!1}function Lr(g){if(g===null)return ye;if(typeof g=="string")return Te;if(typeof g=="boolean")return We;if(typeof g=="number")return pe;if(g instanceof ar)return Ie;if(g instanceof no)return In;if(g instanceof $n)return Wn;if(g instanceof rr)return vn;if(Array.isArray(g)){const c=g.length;let y;for(const _ of g){const T=Lr(_);if(y){if(y===T)continue;y=mn;break}y=T}return jn(y||mn,c)}return Ge}function Xr(g){const c=typeof g;return g===null?"":c==="string"||c==="number"||c==="boolean"?String(g):g instanceof ar||g instanceof $n||g instanceof rr?g.toString():JSON.stringify(g)}class di{constructor(c,y){this.type=c,this.value=y}static parse(c,y){if(c.length!==2)return y.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!Mo(c[1]))return y.error("invalid value");const _=c[1];let T=Lr(_);const R=y.expectedType;return T.kind!=="array"||T.N!==0||!R||R.kind!=="array"||typeof R.N=="number"&&R.N!==0||(T=R),new di(T,_)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ar?["rgba"].concat(this.value.toArray()):this.value instanceof $n?this.value.serialize():this.value}}class Br{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const ys={string:Te,number:pe,boolean:We,object:Ge};class Ti{constructor(c,y){this.type=c,this.args=y}static parse(c,y){if(c.length<2)return y.error("Expected at least one argument.");let _,T=1;const R=c[0];if(R==="array"){let W,et;if(c.length>2){const st=c[1];if(typeof st!="string"||!(st in ys)||st==="object")return y.error('The item type argument of "array" must be one of string, number, boolean',1);W=ys[st],T++}else W=mn;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return y.error('The length argument to "array" must be a positive integer literal',2);et=c[2],T++}_=jn(W,et)}else _=ys[R];const z=[];for(;T<c.length;T++){const W=y.parse(c[T],T,mn);if(!W)return null;z.push(W)}return new Ti(_,z)}evaluate(c){for(let y=0;y<this.args.length;y++){const _=this.args[y].evaluate(c);if(!wr(this.type,Lr(_)))return _;if(y===this.args.length-1)throw new Br(`Expected value to be of type ${Xn(this.type)}, but found ${Xn(Lr(_))} instead.`)}return null}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){const c=this.type,y=[c.kind];if(c.kind==="array"){const _=c.itemType;if(_.kind==="string"||_.kind==="number"||_.kind==="boolean"){y.push(_.kind);const T=c.N;(typeof T=="number"||this.args.length>1)&&y.push(T)}}return y.concat(this.args.map(_=>_.serialize()))}}class ro{constructor(c){this.type=Wn,this.sections=c}static parse(c,y){if(c.length<2)return y.error("Expected at least one argument.");const _=c[1];if(!Array.isArray(_)&&typeof _=="object")return y.error("First argument must be an image or text section.");const T=[];let R=!1;for(let z=1;z<=c.length-1;++z){const W=c[z];if(R&&typeof W=="object"&&!Array.isArray(W)){R=!1;let et=null;if(W["font-scale"]&&(et=y.parse(W["font-scale"],1,pe),!et))return null;let st=null;if(W["text-font"]&&(st=y.parse(W["text-font"],1,jn(Te)),!st))return null;let ht=null;if(W["text-color"]&&(ht=y.parse(W["text-color"],1,Ie),!ht))return null;const pt=T[T.length-1];pt.scale=et,pt.font=st,pt.textColor=ht}else{const et=y.parse(c[z],1,mn);if(!et)return null;const st=et.type.kind;if(st!=="string"&&st!=="value"&&st!=="null"&&st!=="resolvedImage")return y.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");R=!0,T.push({content:et,scale:null,font:null,textColor:null})}}return new ro(T)}evaluate(c){return new $n(this.sections.map(y=>{const _=y.content.evaluate(c);return Lr(_)===vn?new ts("",_,null,null,null):new ts(Xr(_),null,y.scale?y.scale.evaluate(c):null,y.font?y.font.evaluate(c).join(","):null,y.textColor?y.textColor.evaluate(c):null)}))}eachChild(c){for(const y of this.sections)c(y.content),y.scale&&c(y.scale),y.font&&c(y.font),y.textColor&&c(y.textColor)}outputDefined(){return!1}serialize(){const c=["format"];for(const y of this.sections){c.push(y.content.serialize());const _={};y.scale&&(_["font-scale"]=y.scale.serialize()),y.font&&(_["text-font"]=y.font.serialize()),y.textColor&&(_["text-color"]=y.textColor.serialize()),c.push(_)}return c}}class zi{constructor(c){this.type=vn,this.input=c}static parse(c,y){if(c.length!==2)return y.error("Expected two arguments.");const _=y.parse(c[1],1,Te);return _?new zi(_):y.error("No image name provided.")}evaluate(c){const y=this.input.evaluate(c),_=rr.fromString(y);return _&&c.availableImages&&(_.available=c.availableImages.indexOf(y)>-1),_}eachChild(c){c(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ih={"to-boolean":We,"to-color":Ie,"to-number":pe,"to-string":Te};class Ci{constructor(c,y){this.type=c,this.args=y}static parse(c,y){if(c.length<2)return y.error("Expected at least one argument.");const _=c[0];if((_==="to-boolean"||_==="to-string")&&c.length!==2)return y.error("Expected one argument.");const T=ih[_],R=[];for(let z=1;z<c.length;z++){const W=y.parse(c[z],z,mn);if(!W)return null;R.push(W)}return new Ci(T,R)}evaluate(c){if(this.type.kind==="boolean")return!!this.args[0].evaluate(c);if(this.type.kind==="color"){let y,_;for(const T of this.args){if(y=T.evaluate(c),_=null,y instanceof ar)return y;if(typeof y=="string"){const R=c.parseColor(y);if(R)return R}else if(Array.isArray(y)&&(_=y.length<3||y.length>4?`Invalid rbga value ${JSON.stringify(y)}: expected an array containing either three or four numeric values.`:ii(y[0],y[1],y[2],y[3]),!_))return new ar(y[0]/255,y[1]/255,y[2]/255,y[3])}throw new Br(_||`Could not parse color from value '${typeof y=="string"?y:String(JSON.stringify(y))}'`)}if(this.type.kind==="number"){let y=null;for(const _ of this.args){if(y=_.evaluate(c),y===null)return 0;const T=Number(y);if(!isNaN(T))return T}throw new Br(`Could not convert ${JSON.stringify(y)} to number.`)}return this.type.kind==="formatted"?$n.fromString(Xr(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?rr.fromString(Xr(this.args[0].evaluate(c))):Xr(this.args[0].evaluate(c))}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ro([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new zi(this.args[0]).serialize();const c=[`to-${this.type.kind}`];return this.eachChild(y=>{c.push(y.serialize())}),c}}const hc=["Unknown","Point","LineString","Polygon"];class wa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?hc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,y=this.featureDistanceData.scale,{x:_,y:T}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(_*y-c[0])+this.featureDistanceData.bearing[1]*(T*y-c[1])}return 0}parseColor(c){let y=this._parseColorCache[c];return y||(y=this._parseColorCache[c]=ar.parse(c)),y}}class yi{constructor(c,y,_,T){this.name=c,this.type=y,this._evaluate=_,this.args=T}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(c=>c.serialize()))}static parse(c,y){const _=c[0],T=yi.definitions[_];if(!T)return y.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0);const R=Array.isArray(T)?T[0]:T.type,z=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,W=z.filter(([st])=>!Array.isArray(st)||st.length===c.length-1);let et=null;for(const[st,ht]of W){et=new js(y.registry,y.path,null,y.scope);const pt=[];let bt=!1;for(let Et=1;Et<c.length;Et++){const kt=c[Et],Ft=Array.isArray(st)?st[Et-1]:st.type,Vt=et.parse(kt,1+pt.length,Ft);if(!Vt){bt=!0;break}pt.push(Vt)}if(!bt)if(Array.isArray(st)&&st.length!==pt.length)et.error(`Expected ${st.length} arguments, but found ${pt.length} instead.`);else{for(let Et=0;Et<pt.length;Et++){const kt=Array.isArray(st)?st[Et]:st.type,Ft=pt[Et];et.concat(Et+1).checkSubtype(kt,Ft.type)}if(et.errors.length===0)return new yi(_,R,ht,pt)}}if(W.length===1)y.errors.push(...et.errors);else{const st=(W.length?W:z).map(([pt])=>{return bt=pt,Array.isArray(bt)?`(${bt.map(Xn).join(", ")})`:`(${Xn(bt.type)}...)`;var bt}).join(" | "),ht=[];for(let pt=1;pt<c.length;pt++){const bt=y.parse(c[pt],1+ht.length);if(!bt)return null;ht.push(Xn(bt.type))}y.error(`Expected arguments of type ${st}, but found (${ht.join(", ")}) instead.`)}return null}static register(c,y){yi.definitions=y;for(const _ in y)c[_]=yi}}class Ma{constructor(c,y,_){this.type=In,this.locale=_,this.caseSensitive=c,this.diacriticSensitive=y}static parse(c,y){if(c.length!==2)return y.error("Expected one argument.");const _=c[1];if(typeof _!="object"||Array.isArray(_))return y.error("Collator options argument must be an object.");const T=y.parse(_["case-sensitive"]!==void 0&&_["case-sensitive"],1,We);if(!T)return null;const R=y.parse(_["diacritic-sensitive"]!==void 0&&_["diacritic-sensitive"],1,We);if(!R)return null;let z=null;return _.locale&&(z=y.parse(_.locale,1,Te),!z)?null:new Ma(T,R,z)}evaluate(c){return new no(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}serialize(){const c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]}}const io=8192;function Vs(g,c){g[0]=Math.min(g[0],c[0]),g[1]=Math.min(g[1],c[1]),g[2]=Math.max(g[2],c[0]),g[3]=Math.max(g[3],c[1])}function oh(g,c){return!(g[0]<=c[0]||g[2]>=c[2]||g[1]<=c[1]||g[3]>=c[3])}function qg(g,c){const y=(180+g[0])/360,_=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+g[1]*Math.PI/360)))/360,T=Math.pow(2,c.z);return[Math.round(y*T*io),Math.round(_*T*io)]}function sh(g,c,y){const _=g[0]-c[0],T=g[1]-c[1],R=g[0]-y[0],z=g[1]-y[1];return _*z-R*T==0&&_*R<=0&&T*z<=0}function Sf(g,c){let y=!1;for(let z=0,W=c.length;z<W;z++){const et=c[z];for(let st=0,ht=et.length;st<ht-1;st++){if(sh(g,et[st],et[st+1]))return!1;(T=et[st])[1]>(_=g)[1]!=(R=et[st+1])[1]>_[1]&&_[0]<(R[0]-T[0])*(_[1]-T[1])/(R[1]-T[1])+T[0]&&(y=!y)}}var _,T,R;return y}function Nb(g,c){for(let y=0;y<c.length;y++)if(Sf(g,c[y]))return!0;return!1}function Xg(g,c,y,_){const T=_[0]-y[0],R=_[1]-y[1],z=(g[0]-y[0])*R-T*(g[1]-y[1]),W=(c[0]-y[0])*R-T*(c[1]-y[1]);return z>0&&W<0||z<0&&W>0}function Ob(g,c,y){for(const st of y)for(let ht=0;ht<st.length-1;++ht)if((W=[(z=st[ht+1])[0]-(R=st[ht])[0],z[1]-R[1]])[0]*(et=[(T=c)[0]-(_=g)[0],T[1]-_[1]])[1]-W[1]*et[0]!=0&&Xg(_,T,R,z)&&Xg(R,z,_,T))return!0;var _,T,R,z,W,et;return!1}function Yg(g,c){for(let y=0;y<g.length;++y)if(!Sf(g[y],c))return!1;for(let y=0;y<g.length-1;++y)if(Ob(g[y],g[y+1],c))return!1;return!0}function zb(g,c){for(let y=0;y<c.length;y++)if(Yg(g,c[y]))return!0;return!1}function ah(g,c,y){const _=[];for(let T=0;T<g.length;T++){const R=[];for(let z=0;z<g[T].length;z++){const W=qg(g[T][z],y);Vs(c,W),R.push(W)}_.push(R)}return _}function dc(g,c,y){const _=[];for(let T=0;T<g.length;T++){const R=ah(g[T],c,y);_.push(R)}return _}function Kg(g,c,y,_){if(g[0]<y[0]||g[0]>y[2]){const T=.5*_;let R=g[0]-y[0]>T?-_:y[0]-g[0]>T?_:0;R===0&&(R=g[0]-y[2]>T?-_:y[2]-g[0]>T?_:0),g[0]+=R}Vs(c,g)}function Zg(g,c,y,_){const T=Math.pow(2,_.z)*io,R=[_.x*io,_.y*io],z=[];if(!g)return z;for(const W of g)for(const et of W){const st=[et.x+R[0],et.y+R[1]];Kg(st,c,y,T),z.push(st)}return z}function Jg(g,c,y,_){const T=Math.pow(2,_.z)*io,R=[_.x*io,_.y*io],z=[];if(!g)return z;for(const et of g){const st=[];for(const ht of et){const pt=[ht.x+R[0],ht.y+R[1]];Vs(c,pt),st.push(pt)}z.push(st)}if(c[2]-c[0]<=T/2){(W=c)[0]=W[1]=1/0,W[2]=W[3]=-1/0;for(const et of z)for(const st of et)Kg(st,c,y,T)}var W;return z}class Aa{constructor(c,y){this.type=We,this.geojson=c,this.geometries=y}static parse(c,y){if(c.length!==2)return y.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Mo(c[1])){const _=c[1];if(_.type==="FeatureCollection")for(let T=0;T<_.features.length;++T){const R=_.features[T].geometry.type;if(R==="Polygon"||R==="MultiPolygon")return new Aa(_,_.features[T].geometry)}else if(_.type==="Feature"){const T=_.geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new Aa(_,_.geometry)}else if(_.type==="Polygon"||_.type==="MultiPolygon")return new Aa(_,_)}return y.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(y,_){const T=[1/0,1/0,-1/0,-1/0],R=[1/0,1/0,-1/0,-1/0],z=y.canonicalID();if(!z)return!1;if(_.type==="Polygon"){const W=ah(_.coordinates,R,z),et=Zg(y.geometry(),T,R,z);if(!oh(T,R))return!1;for(const st of et)if(!Sf(st,W))return!1}if(_.type==="MultiPolygon"){const W=dc(_.coordinates,R,z),et=Zg(y.geometry(),T,R,z);if(!oh(T,R))return!1;for(const st of et)if(!Nb(st,W))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(y,_){const T=[1/0,1/0,-1/0,-1/0],R=[1/0,1/0,-1/0,-1/0],z=y.canonicalID();if(!z)return!1;if(_.type==="Polygon"){const W=ah(_.coordinates,R,z),et=Jg(y.geometry(),T,R,z);if(!oh(T,R))return!1;for(const st of et)if(!Yg(st,W))return!1}if(_.type==="MultiPolygon"){const W=dc(_.coordinates,R,z),et=Jg(y.geometry(),T,R,z);if(!oh(T,R))return!1;for(const st of et)if(!zb(st,W))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function qi(g){if(g instanceof yi&&(g.name==="get"&&g.args.length===1||g.name==="feature-state"||g.name==="has"&&g.args.length===1||g.name==="properties"||g.name==="geometry-type"||g.name==="id"||/^filter-/.test(g.name))||g instanceof Aa)return!1;let c=!0;return g.eachChild(y=>{c&&!qi(y)&&(c=!1)}),c}function fc(g){if(g instanceof yi&&g.name==="feature-state")return!1;let c=!0;return g.eachChild(y=>{c&&!fc(y)&&(c=!1)}),c}function pc(g,c){if(g instanceof yi&&c.indexOf(g.name)>=0)return!1;let y=!0;return g.eachChild(_=>{y&&!pc(_,c)&&(y=!1)}),y}class Sa{constructor(c,y){this.type=y.type,this.name=c,this.boundExpression=y}static parse(c,y){if(c.length!==2||typeof c[1]!="string")return y.error("'var' expression requires exactly one string literal argument.");const _=c[1];return y.scope.has(_)?new Sa(_,y.scope.get(_)):y.error(`Unknown variable "${_}". Make sure "${_}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class js{constructor(c,y=[],_,T=new qt,R=[]){this.registry=c,this.path=y,this.key=y.map(z=>`[${z}]`).join(""),this.scope=T,this.errors=R,this.expectedType=_}parse(c,y,_,T,R={}){return y?this.concat(y,_,T)._parse(c,R):this._parse(c,R)}_parse(c,y){function _(T,R,z){return z==="assert"?new Ti(R,[T]):z==="coerce"?new Ci(R,[T]):T}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const T=c[0];if(typeof T!="string")return this.error(`Expression name must be a string, but found ${typeof T} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const R=this.registry[T];if(R){let z=R.parse(c,this);if(!z)return null;if(this.expectedType){const W=this.expectedType,et=z.type;if(W.kind!=="string"&&W.kind!=="number"&&W.kind!=="boolean"&&W.kind!=="object"&&W.kind!=="array"||et.kind!=="value")if(W.kind!=="color"&&W.kind!=="formatted"&&W.kind!=="resolvedImage"||et.kind!=="value"&&et.kind!=="string"){if(this.checkSubtype(W,et))return null}else z=_(z,W,y.typeAnnotation||"coerce");else z=_(z,W,y.typeAnnotation||"assert")}if(!(z instanceof di)&&z.type.kind!=="resolvedImage"&&lh(z)){const W=new wa;try{z=new di(z.type,z.evaluate(W))}catch(et){return this.error(et.message),null}}return z}return this.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,y,_){const T=typeof c=="number"?this.path.concat(c):this.path,R=_?this.scope.concat(_):this.scope;return new js(this.registry,T,y||null,R,this.errors)}error(c,...y){const _=`${this.key}${y.map(T=>`[${T}]`).join("")}`;this.errors.push(new gn(_,c))}checkSubtype(c,y){const _=wr(c,y);return _&&this.error(_),_}}function lh(g){if(g instanceof Sa)return lh(g.boundExpression);if(g instanceof yi&&g.name==="error"||g instanceof Ma||g instanceof Aa)return!1;const c=g instanceof Ci||g instanceof Ti;let y=!0;return g.eachChild(_=>{y=c?y&&lh(_):y&&_ instanceof di}),!!y&&qi(g)&&pc(g,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function mc(g,c){const y=g.length-1;let _,T,R=0,z=y,W=0;for(;R<=z;)if(W=Math.floor((R+z)/2),_=g[W],T=g[W+1],_<=c){if(W===y||c<T)return W;R=W+1}else{if(!(_>c))throw new Br("Input is not a number.");z=W-1}return 0}class gc{constructor(c,y,_){this.type=c,this.input=y,this.labels=[],this.outputs=[];for(const[T,R]of _)this.labels.push(T),this.outputs.push(R)}static parse(c,y){if(c.length-1<4)return y.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return y.error("Expected an even number of arguments.");const _=y.parse(c[1],1,pe);if(!_)return null;const T=[];let R=null;y.expectedType&&y.expectedType.kind!=="value"&&(R=y.expectedType);for(let z=1;z<c.length;z+=2){const W=z===1?-1/0:c[z],et=c[z+1],st=z,ht=z+1;if(typeof W!="number")return y.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',st);if(T.length&&T[T.length-1][0]>=W)return y.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',st);const pt=y.parse(et,ht,R);if(!pt)return null;R=R||pt.type,T.push([W,pt])}return new gc(R,_,T)}evaluate(c){const y=this.labels,_=this.outputs;if(y.length===1)return _[0].evaluate(c);const T=this.input.evaluate(c);if(T<=y[0])return _[0].evaluate(c);const R=y.length;return T>=y[R-1]?_[R-1].evaluate(c):_[mc(y,T)].evaluate(c)}eachChild(c){c(this.input);for(const y of this.outputs)c(y)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}serialize(){const c=["step",this.input.serialize()];for(let y=0;y<this.labels.length;y++)y>0&&c.push(this.labels[y]),c.push(this.outputs[y].serialize());return c}}function Nn(g,c,y){return g*(1-y)+c*y}var ch=Object.freeze({__proto__:null,number:Nn,color:function(g,c,y){return new ar(Nn(g.r,c.r,y),Nn(g.g,c.g,y),Nn(g.b,c.b,y),Nn(g.a,c.a,y))},array:function(g,c,y){return g.map((_,T)=>Nn(_,c[T],y))}});const $g=.95047,Qg=1.08883,Ef=4/29,Tf=6/29,Cf=3*Tf*Tf,t0=Math.PI/180,e0=180/Math.PI;function uh(g){return g>.008856451679035631?Math.pow(g,1/3):g/Cf+Ef}function Gs(g){return g>Tf?g*g*g:Cf*(g-Ef)}function cl(g){return 255*(g<=.0031308?12.92*g:1.055*Math.pow(g,1/2.4)-.055)}function Pf(g){return(g/=255)<=.04045?g/12.92:Math.pow((g+.055)/1.055,2.4)}function hh(g){const c=Pf(g.r),y=Pf(g.g),_=Pf(g.b),T=uh((.4124564*c+.3575761*y+.1804375*_)/$g),R=uh((.2126729*c+.7151522*y+.072175*_)/1);return{l:116*R-16,a:500*(T-R),b:200*(R-uh((.0193339*c+.119192*y+.9503041*_)/Qg)),alpha:g.a}}function Df(g){let c=(g.l+16)/116,y=isNaN(g.a)?c:c+g.a/500,_=isNaN(g.b)?c:c-g.b/200;return c=1*Gs(c),y=$g*Gs(y),_=Qg*Gs(_),new ar(cl(3.2404542*y-1.5371385*c-.4985314*_),cl(-.969266*y+1.8760108*c+.041556*_),cl(.0556434*y-.2040259*c+1.0572252*_),g.alpha)}function Ub(g,c,y){const _=c-g;return g+y*(_>180||_<-180?_-360*Math.round(_/360):_)}const yc={forward:hh,reverse:Df,interpolate:function(g,c,y){return{l:Nn(g.l,c.l,y),a:Nn(g.a,c.a,y),b:Nn(g.b,c.b,y),alpha:Nn(g.alpha,c.alpha,y)}}},bc={forward:function(g){const{l:c,a:y,b:_}=hh(g),T=Math.atan2(_,y)*e0;return{h:T<0?T+360:T,c:Math.sqrt(y*y+_*_),l:c,alpha:g.a}},reverse:function(g){const c=g.h*t0,y=g.c;return Df({l:g.l,a:Math.cos(c)*y,b:Math.sin(c)*y,alpha:g.alpha})},interpolate:function(g,c,y){return{h:Ub(g.h,c.h,y),c:Nn(g.c,c.c,y),l:Nn(g.l,c.l,y),alpha:Nn(g.alpha,c.alpha,y)}}};var Rf=Object.freeze({__proto__:null,lab:yc,hcl:bc});class oo{constructor(c,y,_,T,R){this.type=c,this.operator=y,this.interpolation=_,this.input=T,this.labels=[],this.outputs=[];for(const[z,W]of R)this.labels.push(z),this.outputs.push(W)}static interpolationFactor(c,y,_,T){let R=0;if(c.name==="exponential")R=dh(y,c.base,_,T);else if(c.name==="linear")R=dh(y,1,_,T);else if(c.name==="cubic-bezier"){const z=c.controlPoints;R=new l(z[0],z[1],z[2],z[3]).solve(dh(y,1,_,T))}return R}static parse(c,y){let[_,T,R,...z]=c;if(!Array.isArray(T)||T.length===0)return y.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){const st=T[1];if(typeof st!="number")return y.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:st}}else{if(T[0]!=="cubic-bezier")return y.error(`Unknown interpolation type ${String(T[0])}`,1,0);{const st=T.slice(1);if(st.length!==4||st.some(ht=>typeof ht!="number"||ht<0||ht>1))return y.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:st}}}if(c.length-1<4)return y.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return y.error("Expected an even number of arguments.");if(R=y.parse(R,2,pe),!R)return null;const W=[];let et=null;_==="interpolate-hcl"||_==="interpolate-lab"?et=Ie:y.expectedType&&y.expectedType.kind!=="value"&&(et=y.expectedType);for(let st=0;st<z.length;st+=2){const ht=z[st],pt=z[st+1],bt=st+3,Et=st+4;if(typeof ht!="number")return y.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',bt);if(W.length&&W[W.length-1][0]>=ht)return y.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',bt);const kt=y.parse(pt,Et,et);if(!kt)return null;et=et||kt.type,W.push([ht,kt])}return et.kind==="number"||et.kind==="color"||et.kind==="array"&&et.itemType.kind==="number"&&typeof et.N=="number"?new oo(et,_,T,R,W):y.error(`Type ${Xn(et)} is not interpolatable.`)}evaluate(c){const y=this.labels,_=this.outputs;if(y.length===1)return _[0].evaluate(c);const T=this.input.evaluate(c);if(T<=y[0])return _[0].evaluate(c);const R=y.length;if(T>=y[R-1])return _[R-1].evaluate(c);const z=mc(y,T),W=oo.interpolationFactor(this.interpolation,T,y[z],y[z+1]),et=_[z].evaluate(c),st=_[z+1].evaluate(c);return this.operator==="interpolate"?ch[this.type.kind.toLowerCase()](et,st,W):this.operator==="interpolate-hcl"?bc.reverse(bc.interpolate(bc.forward(et),bc.forward(st),W)):yc.reverse(yc.interpolate(yc.forward(et),yc.forward(st),W))}eachChild(c){c(this.input);for(const y of this.outputs)c(y)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}serialize(){let c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const y=[this.operator,c,this.input.serialize()];for(let _=0;_<this.labels.length;_++)y.push(this.labels[_],this.outputs[_].serialize());return y}}function dh(g,c,y,_){const T=_-y,R=g-y;return T===0?0:c===1?R/T:(Math.pow(c,R)-1)/(Math.pow(c,T)-1)}class vc{constructor(c,y){this.type=c,this.args=y}static parse(c,y){if(c.length<2)return y.error("Expectected at least one argument.");let _=null;const T=y.expectedType;T&&T.kind!=="value"&&(_=T);const R=[];for(const W of c.slice(1)){const et=y.parse(W,1+R.length,_,void 0,{typeAnnotation:"omit"});if(!et)return null;_=_||et.type,R.push(et)}const z=T&&R.some(W=>wr(T,W.type));return new vc(z?mn:_,R)}evaluate(c){let y,_=null,T=0;for(const R of this.args){if(T++,_=R.evaluate(c),_&&_ instanceof rr&&!_.available&&(y||(y=_),_=null,T===this.args.length))return y;if(_!==null)break}return _}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){const c=["coalesce"];return this.eachChild(y=>{c.push(y.serialize())}),c}}class xc{constructor(c,y){this.type=y.type,this.bindings=[].concat(c),this.result=y}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const y of this.bindings)c(y[1]);c(this.result)}static parse(c,y){if(c.length<4)return y.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const _=[];for(let R=1;R<c.length-1;R+=2){const z=c[R];if(typeof z!="string")return y.error(`Expected string, but found ${typeof z} instead.`,R);if(/[^a-zA-Z0-9_]/.test(z))return y.error("Variable names must contain only alphanumeric characters or '_'.",R);const W=y.parse(c[R+1],R+1);if(!W)return null;_.push([z,W])}const T=y.parse(c[c.length-1],c.length-1,y.expectedType,_);return T?new xc(_,T):null}outputDefined(){return this.result.outputDefined()}serialize(){const c=["let"];for(const[y,_]of this.bindings)c.push(y,_.serialize());return c.push(this.result.serialize()),c}}class kf{constructor(c,y,_){this.type=c,this.index=y,this.input=_}static parse(c,y){if(c.length!==3)return y.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const _=y.parse(c[1],1,pe),T=y.parse(c[2],2,jn(y.expectedType||mn));return _&&T?new kf(T.type.itemType,_,T):null}evaluate(c){const y=this.index.evaluate(c),_=this.input.evaluate(c);if(y<0)throw new Br(`Array index out of bounds: ${y} < 0.`);if(y>=_.length)throw new Br(`Array index out of bounds: ${y} > ${_.length-1}.`);if(y!==Math.floor(y))throw new Br(`Array index must be an integer, but found ${y} instead.`);return _[y]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class fh{constructor(c,y){this.type=We,this.needle=c,this.haystack=y}static parse(c,y){if(c.length!==3)return y.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const _=y.parse(c[1],1,mn),T=y.parse(c[2],2,mn);return _&&T?Ur(_.type,[We,Te,pe,ye,mn])?new fh(_,T):y.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(_.type)} instead`):null}evaluate(c){const y=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(_==null)return!1;if(!qr(y,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(Lr(y))} instead.`);if(!qr(_,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${Xn(Lr(_))} instead.`);return _.indexOf(y)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ph{constructor(c,y,_){this.type=pe,this.needle=c,this.haystack=y,this.fromIndex=_}static parse(c,y){if(c.length<=2||c.length>=5)return y.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const _=y.parse(c[1],1,mn),T=y.parse(c[2],2,mn);if(!_||!T)return null;if(!Ur(_.type,[We,Te,pe,ye,mn]))return y.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(_.type)} instead`);if(c.length===4){const R=y.parse(c[3],3,pe);return R?new ph(_,T,R):null}return new ph(_,T)}evaluate(c){const y=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(!qr(y,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(Lr(y))} instead.`);if(!qr(_,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${Xn(Lr(_))} instead.`);if(this.fromIndex){const T=this.fromIndex.evaluate(c);return _.indexOf(y,T)}return _.indexOf(y)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class mh{constructor(c,y,_,T,R,z){this.inputType=c,this.type=y,this.input=_,this.cases=T,this.outputs=R,this.otherwise=z}static parse(c,y){if(c.length<5)return y.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return y.error("Expected an even number of arguments.");let _,T;y.expectedType&&y.expectedType.kind!=="value"&&(T=y.expectedType);const R={},z=[];for(let st=2;st<c.length-1;st+=2){let ht=c[st];const pt=c[st+1];Array.isArray(ht)||(ht=[ht]);const bt=y.concat(st);if(ht.length===0)return bt.error("Expected at least one branch label.");for(const kt of ht){if(typeof kt!="number"&&typeof kt!="string")return bt.error("Branch labels must be numbers or strings.");if(typeof kt=="number"&&Math.abs(kt)>Number.MAX_SAFE_INTEGER)return bt.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof kt=="number"&&Math.floor(kt)!==kt)return bt.error("Numeric branch labels must be integer values.");if(_){if(bt.checkSubtype(_,Lr(kt)))return null}else _=Lr(kt);if(R[String(kt)]!==void 0)return bt.error("Branch labels must be unique.");R[String(kt)]=z.length}const Et=y.parse(pt,st,T);if(!Et)return null;T=T||Et.type,z.push(Et)}const W=y.parse(c[1],1,mn);if(!W)return null;const et=y.parse(c[c.length-1],c.length-1,T);return et?W.type.kind!=="value"&&y.concat(1).checkSubtype(_,W.type)?null:new mh(_,T,W,R,z,et):null}evaluate(c){const y=this.input.evaluate(c);return(Lr(y)===this.inputType&&this.outputs[this.cases[y]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const c=["match",this.input.serialize()],y=Object.keys(this.cases).sort(),_=[],T={};for(const z of y){const W=T[this.cases[z]];W===void 0?(T[this.cases[z]]=_.length,_.push([this.cases[z],[z]])):_[W][1].push(z)}const R=z=>this.inputType.kind==="number"?Number(z):z;for(const[z,W]of _)c.push(W.length===1?R(W[0]):W.map(R)),c.push(this.outputs[z].serialize());return c.push(this.otherwise.serialize()),c}}class gh{constructor(c,y,_){this.type=c,this.branches=y,this.otherwise=_}static parse(c,y){if(c.length<4)return y.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return y.error("Expected an odd number of arguments.");let _;y.expectedType&&y.expectedType.kind!=="value"&&(_=y.expectedType);const T=[];for(let z=1;z<c.length-1;z+=2){const W=y.parse(c[z],z,We);if(!W)return null;const et=y.parse(c[z+1],z+1,_);if(!et)return null;T.push([W,et]),_=_||et.type}const R=y.parse(c[c.length-1],c.length-1,_);return R?new gh(_,T,R):null}evaluate(c){for(const[y,_]of this.branches)if(y.evaluate(c))return _.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[y,_]of this.branches)c(y),c(_);c(this.otherwise)}outputDefined(){return this.branches.every(([c,y])=>y.outputDefined())&&this.otherwise.outputDefined()}serialize(){const c=["case"];return this.eachChild(y=>{c.push(y.serialize())}),c}}class yh{constructor(c,y,_,T){this.type=c,this.input=y,this.beginIndex=_,this.endIndex=T}static parse(c,y){if(c.length<=2||c.length>=5)return y.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const _=y.parse(c[1],1,mn),T=y.parse(c[2],2,pe);if(!_||!T)return null;if(!Ur(_.type,[jn(mn),Te,mn]))return y.error(`Expected first argument to be of type array or string, but found ${Xn(_.type)} instead`);if(c.length===4){const R=y.parse(c[3],3,pe);return R?new yh(_.type,_,T,R):null}return new yh(_.type,_,T)}evaluate(c){const y=this.input.evaluate(c),_=this.beginIndex.evaluate(c);if(!qr(y,["string","array"]))throw new Br(`Expected first argument to be of type array or string, but found ${Xn(Lr(y))} instead.`);if(this.endIndex){const T=this.endIndex.evaluate(c);return y.slice(_,T)}return y.slice(_)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function n0(g,c){return g==="=="||g==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function r0(g,c,y,_){return _.compare(c,y)===0}function ul(g,c,y){const _=g!=="=="&&g!=="!=";return class eS{constructor(R,z,W){this.type=We,this.lhs=R,this.rhs=z,this.collator=W,this.hasUntypedArgument=R.type.kind==="value"||z.type.kind==="value"}static parse(R,z){if(R.length!==3&&R.length!==4)return z.error("Expected two or three arguments.");const W=R[0];let et=z.parse(R[1],1,mn);if(!et)return null;if(!n0(W,et.type))return z.concat(1).error(`"${W}" comparisons are not supported for type '${Xn(et.type)}'.`);let st=z.parse(R[2],2,mn);if(!st)return null;if(!n0(W,st.type))return z.concat(2).error(`"${W}" comparisons are not supported for type '${Xn(st.type)}'.`);if(et.type.kind!==st.type.kind&&et.type.kind!=="value"&&st.type.kind!=="value")return z.error(`Cannot compare types '${Xn(et.type)}' and '${Xn(st.type)}'.`);_&&(et.type.kind==="value"&&st.type.kind!=="value"?et=new Ti(st.type,[et]):et.type.kind!=="value"&&st.type.kind==="value"&&(st=new Ti(et.type,[st])));let ht=null;if(R.length===4){if(et.type.kind!=="string"&&st.type.kind!=="string"&&et.type.kind!=="value"&&st.type.kind!=="value")return z.error("Cannot use collator to compare non-string types.");if(ht=z.parse(R[3],3,In),!ht)return null}return new eS(et,st,ht)}evaluate(R){const z=this.lhs.evaluate(R),W=this.rhs.evaluate(R);if(_&&this.hasUntypedArgument){const et=Lr(z),st=Lr(W);if(et.kind!==st.kind||et.kind!=="string"&&et.kind!=="number")throw new Br(`Expected arguments for "${g}" to be (string, string) or (number, number), but found (${et.kind}, ${st.kind}) instead.`)}if(this.collator&&!_&&this.hasUntypedArgument){const et=Lr(z),st=Lr(W);if(et.kind!=="string"||st.kind!=="string")return c(R,z,W)}return this.collator?y(R,z,W,this.collator.evaluate(R)):c(R,z,W)}eachChild(R){R(this.lhs),R(this.rhs),this.collator&&R(this.collator)}outputDefined(){return!0}serialize(){const R=[g];return this.eachChild(z=>{R.push(z.serialize())}),R}}}const Vb=ul("==",function(g,c,y){return c===y},r0),jb=ul("!=",function(g,c,y){return c!==y},function(g,c,y,_){return!r0(0,c,y,_)}),i0=ul("<",function(g,c,y){return c<y},function(g,c,y,_){return _.compare(c,y)<0}),Gb=ul(">",function(g,c,y){return c>y},function(g,c,y,_){return _.compare(c,y)>0}),Hb=ul("<=",function(g,c,y){return c<=y},function(g,c,y,_){return _.compare(c,y)<=0}),Wb=ul(">=",function(g,c,y){return c>=y},function(g,c,y,_){return _.compare(c,y)>=0});class If{constructor(c,y,_,T,R){this.type=Te,this.number=c,this.locale=y,this.currency=_,this.minFractionDigits=T,this.maxFractionDigits=R}static parse(c,y){if(c.length!==3)return y.error("Expected two arguments.");const _=y.parse(c[1],1,pe);if(!_)return null;const T=c[2];if(typeof T!="object"||Array.isArray(T))return y.error("NumberFormat options argument must be an object.");let R=null;if(T.locale&&(R=y.parse(T.locale,1,Te),!R))return null;let z=null;if(T.currency&&(z=y.parse(T.currency,1,Te),!z))return null;let W=null;if(T["min-fraction-digits"]&&(W=y.parse(T["min-fraction-digits"],1,pe),!W))return null;let et=null;return T["max-fraction-digits"]&&(et=y.parse(T["max-fraction-digits"],1,pe),!et)?null:new If(_,R,z,W,et)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]}}class bh{constructor(c){this.type=pe,this.input=c}static parse(c,y){if(c.length!==2)return y.error(`Expected 1 argument, but found ${c.length-1} instead.`);const _=y.parse(c[1],1);return _?_.type.kind!=="array"&&_.type.kind!=="string"&&_.type.kind!=="value"?y.error(`Expected argument of type string or array, but found ${Xn(_.type)} instead.`):new bh(_):null}evaluate(c){const y=this.input.evaluate(c);if(typeof y=="string"||Array.isArray(y))return y.length;throw new Br(`Expected value to be of type string or array, but found ${Xn(Lr(y))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}serialize(){const c=["length"];return this.eachChild(y=>{c.push(y.serialize())}),c}}const Ea={"==":Vb,"!=":jb,">":Gb,"<":i0,">=":Wb,"<=":Hb,array:Ti,at:kf,boolean:Ti,case:gh,coalesce:vc,collator:Ma,format:ro,image:zi,in:fh,"index-of":ph,interpolate:oo,"interpolate-hcl":oo,"interpolate-lab":oo,length:bh,let:xc,literal:di,match:mh,number:Ti,"number-format":If,object:Ti,slice:yh,step:gc,string:Ti,"to-boolean":Ci,"to-color":Ci,"to-number":Ci,"to-string":Ci,var:Sa,within:Aa};function Lf(g,[c,y,_,T]){c=c.evaluate(g),y=y.evaluate(g),_=_.evaluate(g);const R=T?T.evaluate(g):1,z=ii(c,y,_,R);if(z)throw new Br(z);return new ar(c/255*R,y/255*R,_/255*R,R)}function o0(g,c){return g in c}function Bf(g,c){const y=c[g];return y===void 0?null:y}function Hs(g){return{type:g}}function Ff(g){return{result:"success",value:g}}function Ta(g){return{result:"error",value:g}}function hl(g){return g["property-type"]==="data-driven"||g["property-type"]==="cross-faded-data-driven"}function s0(g){return!!g.expression&&g.expression.parameters.indexOf("zoom")>-1}function Nf(g){return!!g.expression&&g.expression.interpolated}function Mr(g){return g instanceof Number?"number":g instanceof String?"string":g instanceof Boolean?"boolean":Array.isArray(g)?"array":g===null?"null":typeof g}function Ca(g){return typeof g=="object"&&g!==null&&!Array.isArray(g)}function a0(g){return g}function Of(g,c){const y=c.type==="color",_=g.stops&&typeof g.stops[0][0]=="object",T=_||!(_||g.property!==void 0),R=g.type||(Nf(c)?"exponential":"interval");if(y&&((g=Ve({},g)).stops&&(g.stops=g.stops.map(st=>[st[0],ar.parse(st[1])])),g.default=ar.parse(g.default?g.default:c.default)),g.colorSpace&&g.colorSpace!=="rgb"&&!Rf[g.colorSpace])throw new Error(`Unknown color space: ${g.colorSpace}`);let z,W,et;if(R==="exponential")z=zf;else if(R==="interval")z=Xb;else if(R==="categorical"){z=qb,W=Object.create(null);for(const st of g.stops)W[st[0]]=st[1];et=typeof g.stops[0][0]}else{if(R!=="identity")throw new Error(`Unknown function type "${R}"`);z=l0}if(_){const st={},ht=[];for(let Et=0;Et<g.stops.length;Et++){const kt=g.stops[Et],Ft=kt[0].zoom;st[Ft]===void 0&&(st[Ft]={zoom:Ft,type:g.type,property:g.property,default:g.default,stops:[]},ht.push(Ft)),st[Ft].stops.push([kt[0].value,kt[1]])}const pt=[];for(const Et of ht)pt.push([st[Et].zoom,Of(st[Et],c)]);const bt={name:"linear"};return{kind:"composite",interpolationType:bt,interpolationFactor:oo.interpolationFactor.bind(void 0,bt),zoomStops:pt.map(Et=>Et[0]),evaluate:({zoom:Et},kt)=>zf({stops:pt,base:g.base},c,Et).evaluate(Et,kt)}}if(T){const st=R==="exponential"?{name:"exponential",base:g.base!==void 0?g.base:1}:null;return{kind:"camera",interpolationType:st,interpolationFactor:oo.interpolationFactor.bind(void 0,st),zoomStops:g.stops.map(ht=>ht[0]),evaluate:({zoom:ht})=>z(g,c,ht,W,et)}}return{kind:"source",evaluate(st,ht){const pt=ht&&ht.properties?ht.properties[g.property]:void 0;return pt===void 0?_c(g.default,c.default):z(g,c,pt,W,et)}}}function _c(g,c,y){return g!==void 0?g:c!==void 0?c:y!==void 0?y:void 0}function qb(g,c,y,_,T){return _c(typeof y===T?_[y]:void 0,g.default,c.default)}function Xb(g,c,y){if(Mr(y)!=="number")return _c(g.default,c.default);const _=g.stops.length;if(_===1||y<=g.stops[0][0])return g.stops[0][1];if(y>=g.stops[_-1][0])return g.stops[_-1][1];const T=mc(g.stops.map(R=>R[0]),y);return g.stops[T][1]}function zf(g,c,y){const _=g.base!==void 0?g.base:1;if(Mr(y)!=="number")return _c(g.default,c.default);const T=g.stops.length;if(T===1||y<=g.stops[0][0])return g.stops[0][1];if(y>=g.stops[T-1][0])return g.stops[T-1][1];const R=mc(g.stops.map(ht=>ht[0]),y),z=function(ht,pt,bt,Et){const kt=Et-bt,Ft=ht-bt;return kt===0?0:pt===1?Ft/kt:(Math.pow(pt,Ft)-1)/(Math.pow(pt,kt)-1)}(y,_,g.stops[R][0],g.stops[R+1][0]),W=g.stops[R][1],et=g.stops[R+1][1];let st=ch[c.type]||a0;if(g.colorSpace&&g.colorSpace!=="rgb"){const ht=Rf[g.colorSpace];st=(pt,bt)=>ht.reverse(ht.interpolate(ht.forward(pt),ht.forward(bt),z))}return typeof W.evaluate=="function"?{evaluate(...ht){const pt=W.evaluate.apply(void 0,ht),bt=et.evaluate.apply(void 0,ht);if(pt!==void 0&&bt!==void 0)return st(pt,bt,z)}}:st(W,et,z)}function l0(g,c,y){return c.type==="color"?y=ar.parse(y):c.type==="formatted"?y=$n.fromString(y.toString()):c.type==="resolvedImage"?y=rr.fromString(y.toString()):Mr(y)===c.type||c.type==="enum"&&c.values[y]||(y=void 0),_c(y,g.default,c.default)}yi.register(Ea,{error:[{kind:"error"},[Te],(g,[c])=>{throw new Br(c.evaluate(g))}],typeof:[Te,[mn],(g,[c])=>Xn(Lr(c.evaluate(g)))],"to-rgba":[jn(pe,4),[Ie],(g,[c])=>c.evaluate(g).toArray()],rgb:[Ie,[pe,pe,pe],Lf],rgba:[Ie,[pe,pe,pe,pe],Lf],has:{type:We,overloads:[[[Te],(g,[c])=>o0(c.evaluate(g),g.properties())],[[Te,Ge],(g,[c,y])=>o0(c.evaluate(g),y.evaluate(g))]]},get:{type:mn,overloads:[[[Te],(g,[c])=>Bf(c.evaluate(g),g.properties())],[[Te,Ge],(g,[c,y])=>Bf(c.evaluate(g),y.evaluate(g))]]},"feature-state":[mn,[Te],(g,[c])=>Bf(c.evaluate(g),g.featureState||{})],properties:[Ge,[],g=>g.properties()],"geometry-type":[Te,[],g=>g.geometryType()],id:[mn,[],g=>g.id()],zoom:[pe,[],g=>g.globals.zoom],pitch:[pe,[],g=>g.globals.pitch||0],"distance-from-center":[pe,[],g=>g.distanceFromCenter()],"heatmap-density":[pe,[],g=>g.globals.heatmapDensity||0],"line-progress":[pe,[],g=>g.globals.lineProgress||0],"sky-radial-progress":[pe,[],g=>g.globals.skyRadialProgress||0],accumulated:[mn,[],g=>g.globals.accumulated===void 0?null:g.globals.accumulated],"+":[pe,Hs(pe),(g,c)=>{let y=0;for(const _ of c)y+=_.evaluate(g);return y}],"*":[pe,Hs(pe),(g,c)=>{let y=1;for(const _ of c)y*=_.evaluate(g);return y}],"-":{type:pe,overloads:[[[pe,pe],(g,[c,y])=>c.evaluate(g)-y.evaluate(g)],[[pe],(g,[c])=>-c.evaluate(g)]]},"/":[pe,[pe,pe],(g,[c,y])=>c.evaluate(g)/y.evaluate(g)],"%":[pe,[pe,pe],(g,[c,y])=>c.evaluate(g)%y.evaluate(g)],ln2:[pe,[],()=>Math.LN2],pi:[pe,[],()=>Math.PI],e:[pe,[],()=>Math.E],"^":[pe,[pe,pe],(g,[c,y])=>Math.pow(c.evaluate(g),y.evaluate(g))],sqrt:[pe,[pe],(g,[c])=>Math.sqrt(c.evaluate(g))],log10:[pe,[pe],(g,[c])=>Math.log(c.evaluate(g))/Math.LN10],ln:[pe,[pe],(g,[c])=>Math.log(c.evaluate(g))],log2:[pe,[pe],(g,[c])=>Math.log(c.evaluate(g))/Math.LN2],sin:[pe,[pe],(g,[c])=>Math.sin(c.evaluate(g))],cos:[pe,[pe],(g,[c])=>Math.cos(c.evaluate(g))],tan:[pe,[pe],(g,[c])=>Math.tan(c.evaluate(g))],asin:[pe,[pe],(g,[c])=>Math.asin(c.evaluate(g))],acos:[pe,[pe],(g,[c])=>Math.acos(c.evaluate(g))],atan:[pe,[pe],(g,[c])=>Math.atan(c.evaluate(g))],min:[pe,Hs(pe),(g,c)=>Math.min(...c.map(y=>y.evaluate(g)))],max:[pe,Hs(pe),(g,c)=>Math.max(...c.map(y=>y.evaluate(g)))],abs:[pe,[pe],(g,[c])=>Math.abs(c.evaluate(g))],round:[pe,[pe],(g,[c])=>{const y=c.evaluate(g);return y<0?-Math.round(-y):Math.round(y)}],floor:[pe,[pe],(g,[c])=>Math.floor(c.evaluate(g))],ceil:[pe,[pe],(g,[c])=>Math.ceil(c.evaluate(g))],"filter-==":[We,[Te,mn],(g,[c,y])=>g.properties()[c.value]===y.value],"filter-id-==":[We,[mn],(g,[c])=>g.id()===c.value],"filter-type-==":[We,[Te],(g,[c])=>g.geometryType()===c.value],"filter-<":[We,[Te,mn],(g,[c,y])=>{const _=g.properties()[c.value],T=y.value;return typeof _==typeof T&&_<T}],"filter-id-<":[We,[mn],(g,[c])=>{const y=g.id(),_=c.value;return typeof y==typeof _&&y<_}],"filter->":[We,[Te,mn],(g,[c,y])=>{const _=g.properties()[c.value],T=y.value;return typeof _==typeof T&&_>T}],"filter-id->":[We,[mn],(g,[c])=>{const y=g.id(),_=c.value;return typeof y==typeof _&&y>_}],"filter-<=":[We,[Te,mn],(g,[c,y])=>{const _=g.properties()[c.value],T=y.value;return typeof _==typeof T&&_<=T}],"filter-id-<=":[We,[mn],(g,[c])=>{const y=g.id(),_=c.value;return typeof y==typeof _&&y<=_}],"filter->=":[We,[Te,mn],(g,[c,y])=>{const _=g.properties()[c.value],T=y.value;return typeof _==typeof T&&_>=T}],"filter-id->=":[We,[mn],(g,[c])=>{const y=g.id(),_=c.value;return typeof y==typeof _&&y>=_}],"filter-has":[We,[mn],(g,[c])=>c.value in g.properties()],"filter-has-id":[We,[],g=>g.id()!==null&&g.id()!==void 0],"filter-type-in":[We,[jn(Te)],(g,[c])=>c.value.indexOf(g.geometryType())>=0],"filter-id-in":[We,[jn(mn)],(g,[c])=>c.value.indexOf(g.id())>=0],"filter-in-small":[We,[Te,jn(mn)],(g,[c,y])=>y.value.indexOf(g.properties()[c.value])>=0],"filter-in-large":[We,[Te,jn(mn)],(g,[c,y])=>function(_,T,R,z){for(;R<=z;){const W=R+z>>1;if(T[W]===_)return!0;T[W]>_?z=W-1:R=W+1}return!1}(g.properties()[c.value],y.value,0,y.value.length-1)],all:{type:We,overloads:[[[We,We],(g,[c,y])=>c.evaluate(g)&&y.evaluate(g)],[Hs(We),(g,c)=>{for(const y of c)if(!y.evaluate(g))return!1;return!0}]]},any:{type:We,overloads:[[[We,We],(g,[c,y])=>c.evaluate(g)||y.evaluate(g)],[Hs(We),(g,c)=>{for(const y of c)if(y.evaluate(g))return!0;return!1}]]},"!":[We,[We],(g,[c])=>!c.evaluate(g)],"is-supported-script":[We,[Te],(g,[c])=>{const y=g.globals&&g.globals.isSupportedScript;return!y||y(c.evaluate(g))}],upcase:[Te,[Te],(g,[c])=>c.evaluate(g).toUpperCase()],downcase:[Te,[Te],(g,[c])=>c.evaluate(g).toLowerCase()],concat:[Te,Hs(mn),(g,c)=>c.map(y=>Xr(y.evaluate(g))).join("")],"resolved-locale":[Te,[In],(g,[c])=>c.evaluate(g).resolvedLocale()]});class vh{constructor(c,y){this.expression=c,this._warningHistory={},this._evaluator=new wa,this._defaultValue=y?function(_){return _.type==="color"&&Ca(_.default)?new ar(0,0,0,0):_.type==="color"?ar.parse(_.default)||null:_.default===void 0?null:_.default}(y):null,this._enumValues=y&&y.type==="enum"?y.values:null}evaluateWithoutErrorHandling(c,y,_,T,R,z,W,et){return this._evaluator.globals=c,this._evaluator.feature=y,this._evaluator.featureState=_,this._evaluator.canonical=T||null,this._evaluator.availableImages=R||null,this._evaluator.formattedSection=z,this._evaluator.featureTileCoord=W||null,this._evaluator.featureDistanceData=et||null,this.expression.evaluate(this._evaluator)}evaluate(c,y,_,T,R,z,W,et){this._evaluator.globals=c,this._evaluator.feature=y||null,this._evaluator.featureState=_||null,this._evaluator.canonical=T||null,this._evaluator.availableImages=R||null,this._evaluator.formattedSection=z||null,this._evaluator.featureTileCoord=W||null,this._evaluator.featureDistanceData=et||null;try{const st=this.expression.evaluate(this._evaluator);if(st==null||typeof st=="number"&&st!=st)return this._defaultValue;if(this._enumValues&&!(st in this._enumValues))throw new Br(`Expected value to be one of ${Object.keys(this._enumValues).map(ht=>JSON.stringify(ht)).join(", ")}, but found ${JSON.stringify(st)} instead.`);return st}catch(st){return this._warningHistory[st.message]||(this._warningHistory[st.message]=!0,typeof console!="undefined"&&console.warn(st.message)),this._defaultValue}}}function dl(g){return Array.isArray(g)&&g.length>0&&typeof g[0]=="string"&&g[0]in Ea}function wc(g,c){const y=new js(Ea,[],c?function(T){const R={color:Ie,string:Te,number:pe,enum:Te,boolean:We,formatted:Wn,resolvedImage:vn};return T.type==="array"?jn(R[T.value]||mn,T.length):R[T.type]}(c):void 0),_=y.parse(g,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?Ff(new vh(_,c)):Ta(y.errors)}class Uf{constructor(c,y){this.kind=c,this._styleExpression=y,this.isStateDependent=c!=="constant"&&!fc(y.expression)}evaluateWithoutErrorHandling(c,y,_,T,R,z){return this._styleExpression.evaluateWithoutErrorHandling(c,y,_,T,R,z)}evaluate(c,y,_,T,R,z){return this._styleExpression.evaluate(c,y,_,T,R,z)}}class Vf{constructor(c,y,_,T){this.kind=c,this.zoomStops=_,this._styleExpression=y,this.isStateDependent=c!=="camera"&&!fc(y.expression),this.interpolationType=T}evaluateWithoutErrorHandling(c,y,_,T,R,z){return this._styleExpression.evaluateWithoutErrorHandling(c,y,_,T,R,z)}evaluate(c,y,_,T,R,z){return this._styleExpression.evaluate(c,y,_,T,R,z)}interpolationFactor(c,y,_){return this.interpolationType?oo.interpolationFactor(this.interpolationType,c,y,_):0}}function c0(g,c){if((g=wc(g,c)).result==="error")return g;const y=g.value.expression,_=qi(y);if(!_&&!hl(c))return Ta([new gn("","data expressions not supported")]);const T=pc(y,["zoom","pitch","distance-from-center"]);if(!T&&!s0(c))return Ta([new gn("","zoom expressions not supported")]);const R=_h(y);return R||T?R instanceof gn?Ta([R]):R instanceof oo&&!Nf(c)?Ta([new gn("",'"interpolate" expressions cannot be used with this property')]):Ff(R?new Vf(_?"camera":"composite",g.value,R.labels,R instanceof oo?R.interpolation:void 0):new Uf(_?"constant":"source",g.value)):Ta([new gn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class xh{constructor(c,y){this._parameters=c,this._specification=y,Ve(this,Of(this._parameters,this._specification))}static deserialize(c){return new xh(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function _h(g){let c=null;if(g instanceof xc)c=_h(g.result);else if(g instanceof vc){for(const y of g.args)if(c=_h(y),c)break}else(g instanceof gc||g instanceof oo)&&g.input instanceof yi&&g.input.name==="zoom"&&(c=g);return c instanceof gn||g.eachChild(y=>{const _=_h(y);_ instanceof gn?c=_:!c&&_?c=new gn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&_&&c!==_&&(c=new gn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}class yn{constructor(c,y,_,T){this.message=(c?`${c}: `:"")+_,T&&(this.identifier=T),y!=null&&y.__line__&&(this.line=y.__line__)}}function Ao(g){const c=g.key,y=g.value,_=g.valueSpec||{},T=g.objectElementValidators||{},R=g.style,z=g.styleSpec;let W=[];const et=Mr(y);if(et!=="object")return[new yn(c,y,`object expected, ${et} found`)];for(const st in y){const ht=st.split(".")[0],pt=_[ht]||_["*"];let bt;T[ht]?bt=T[ht]:_[ht]?bt=fi:T["*"]?bt=T["*"]:_["*"]&&(bt=fi),bt?W=W.concat(bt({key:(c&&`${c}.`)+st,value:y[st],valueSpec:pt,style:R,styleSpec:z,object:y,objectKey:st},y)):W.push(new yn(c,y[st],`unknown property "${st}"`))}for(const st in _)T[st]||_[st].required&&_[st].default===void 0&&y[st]===void 0&&W.push(new yn(c,y,`missing required property "${st}"`));return W}function Mc(g){const c=g.value,y=g.valueSpec,_=g.style,T=g.styleSpec,R=g.key,z=g.arrayElementValidator||fi;if(Mr(c)!=="array")return[new yn(R,c,`array expected, ${Mr(c)} found`)];if(y.length&&c.length!==y.length)return[new yn(R,c,`array length ${y.length} expected, length ${c.length} found`)];if(y["min-length"]&&c.length<y["min-length"])return[new yn(R,c,`array length at least ${y["min-length"]} expected, length ${c.length} found`)];let W={type:y.value,values:y.values,minimum:y.minimum,maximum:y.maximum,function:void 0};T.$version<7&&(W.function=y.function),Mr(y.value)==="object"&&(W=y.value);let et=[];for(let st=0;st<c.length;st++)et=et.concat(z({array:c,arrayIndex:st,value:c[st],valueSpec:W,style:_,styleSpec:T,key:`${R}[${st}]`}));return et}function u0(g){const c=g.key,y=g.value,_=g.valueSpec;let T=Mr(y);if(T==="number"&&y!=y&&(T="NaN"),T!=="number")return[new yn(c,y,`number expected, ${T} found`)];if("minimum"in _){let R=_.minimum;if(Mr(_.minimum)==="array"&&(R=_.minimum[g.arrayIndex]),y<R)return[new yn(c,y,`${y} is less than the minimum value ${R}`)]}if("maximum"in _){let R=_.maximum;if(Mr(_.maximum)==="array"&&(R=_.maximum[g.arrayIndex]),y>R)return[new yn(c,y,`${y} is greater than the maximum value ${R}`)]}return[]}function h0(g){const c=g.valueSpec,y=Ue(g.value.type);let _,T,R,z={};const W=y!=="categorical"&&g.value.property===void 0,et=!W,st=Mr(g.value.stops)==="array"&&Mr(g.value.stops[0])==="array"&&Mr(g.value.stops[0][0])==="object",ht=Ao({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(Et){if(y==="identity")return[new yn(Et.key,Et.value,'identity function may not have a "stops" property')];let kt=[];const Ft=Et.value;return kt=kt.concat(Mc({key:Et.key,value:Ft,valueSpec:Et.valueSpec,style:Et.style,styleSpec:Et.styleSpec,arrayElementValidator:pt})),Mr(Ft)==="array"&&Ft.length===0&&kt.push(new yn(Et.key,Ft,"array must have at least one stop")),kt},default:function(Et){return fi({key:Et.key,value:Et.value,valueSpec:c,style:Et.style,styleSpec:Et.styleSpec})}}});return y==="identity"&&W&&ht.push(new yn(g.key,g.value,'missing required property "property"')),y==="identity"||g.value.stops||ht.push(new yn(g.key,g.value,'missing required property "stops"')),y==="exponential"&&g.valueSpec.expression&&!Nf(g.valueSpec)&&ht.push(new yn(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(et&&!hl(g.valueSpec)?ht.push(new yn(g.key,g.value,"property functions not supported")):W&&!s0(g.valueSpec)&&ht.push(new yn(g.key,g.value,"zoom functions not supported"))),y!=="categorical"&&!st||g.value.property!==void 0||ht.push(new yn(g.key,g.value,'"property" property is required')),ht;function pt(Et){let kt=[];const Ft=Et.value,Vt=Et.key;if(Mr(Ft)!=="array")return[new yn(Vt,Ft,`array expected, ${Mr(Ft)} found`)];if(Ft.length!==2)return[new yn(Vt,Ft,`array length 2 expected, length ${Ft.length} found`)];if(st){if(Mr(Ft[0])!=="object")return[new yn(Vt,Ft,`object expected, ${Mr(Ft[0])} found`)];if(Ft[0].zoom===void 0)return[new yn(Vt,Ft,"object stop key must have zoom")];if(Ft[0].value===void 0)return[new yn(Vt,Ft,"object stop key must have value")];const $t=Ue(Ft[0].zoom);if(typeof $t!="number")return[new yn(Vt,Ft[0].zoom,"stop zoom values must be numbers")];if(R&&R>$t)return[new yn(Vt,Ft[0].zoom,"stop zoom values must appear in ascending order")];$t!==R&&(R=$t,T=void 0,z={}),kt=kt.concat(Ao({key:`${Vt}[0]`,value:Ft[0],valueSpec:{zoom:{}},style:Et.style,styleSpec:Et.styleSpec,objectElementValidators:{zoom:u0,value:bt}}))}else kt=kt.concat(bt({key:`${Vt}[0]`,value:Ft[0],valueSpec:{},style:Et.style,styleSpec:Et.styleSpec},Ft));return dl(en(Ft[1]))?kt.concat([new yn(`${Vt}[1]`,Ft[1],"expressions are not allowed in function stops.")]):kt.concat(fi({key:`${Vt}[1]`,value:Ft[1],valueSpec:c,style:Et.style,styleSpec:Et.styleSpec}))}function bt(Et,kt){const Ft=Mr(Et.value),Vt=Ue(Et.value),$t=Et.value!==null?Et.value:kt;if(_){if(Ft!==_)return[new yn(Et.key,$t,`${Ft} stop domain type must match previous stop domain type ${_}`)]}else _=Ft;if(Ft!=="number"&&Ft!=="string"&&Ft!=="boolean"&&typeof Vt!="number"&&typeof Vt!="string"&&typeof Vt!="boolean")return[new yn(Et.key,$t,"stop domain value must be a number, string, or boolean")];if(Ft!=="number"&&y!=="categorical"){let ue=`number expected, ${Ft} found`;return hl(c)&&y===void 0&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new yn(Et.key,$t,ue)]}return y!=="categorical"||Ft!=="number"||typeof Vt=="number"&&isFinite(Vt)&&Math.floor(Vt)===Vt?y!=="categorical"&&Ft==="number"&&typeof Vt=="number"&&typeof T=="number"&&T!==void 0&&Vt<T?[new yn(Et.key,$t,"stop domain values must appear in ascending order")]:(T=Vt,y==="categorical"&&Vt in z?[new yn(Et.key,$t,"stop domain values must be unique")]:(z[Vt]=!0,[])):[new yn(Et.key,$t,`integer expected, found ${String(Vt)}`)]}}function fl(g){const c=(g.expressionContext==="property"?c0:wc)(en(g.value),g.valueSpec);if(c.result==="error")return c.value.map(_=>new yn(`${g.key}${_.key}`,g.value,_.message));const y=c.value.expression||c.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!y.outputDefined())return[new yn(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!fc(y))return[new yn(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return bs(y,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!pc(y,["zoom","feature-state"]))return[new yn(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!qi(y))return[new yn(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function bs(g,c){const y=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(c.valueSpec&&c.valueSpec.expression)for(const T of c.valueSpec.expression.parameters)y.delete(T);if(y.size===0)return[];const _=[];return g instanceof yi&&y.has(g.name)?[new yn(c.key,c.value,`["${g.name}"] expression is not supported in a filter for a ${c.object.type} layer with id: ${c.object.id}`)]:(g.eachChild(T=>{_.push(...bs(T,c))}),_)}function Ac(g){const c=g.key,y=g.value,_=g.valueSpec,T=[];return Array.isArray(_.values)?_.values.indexOf(Ue(y))===-1&&T.push(new yn(c,y,`expected one of [${_.values.join(", ")}], ${JSON.stringify(y)} found`)):Object.keys(_.values).indexOf(Ue(y))===-1&&T.push(new yn(c,y,`expected one of [${Object.keys(_.values).join(", ")}], ${JSON.stringify(y)} found`)),T}function Ws(g){if(g===!0||g===!1)return!0;if(!Array.isArray(g)||g.length===0)return!1;switch(g[0]){case"has":return g.length>=2&&g[1]!=="$id"&&g[1]!=="$type";case"in":return g.length>=3&&(typeof g[1]!="string"||Array.isArray(g[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return g.length!==3||Array.isArray(g[1])||Array.isArray(g[2]);case"any":case"all":for(const c of g.slice(1))if(!Ws(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}function qs(g,c="fill"){if(g==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ws(g)||(g=Sc(g));const y=g;let _=!0;try{_=function(st){if(!Xs(st))return st;let ht=en(st);return d0(ht),ht=jf(ht),ht}(y)}catch(st){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(y,null,2)}
        `)}const T=Yt[`filter_${c}`],R=wc(_,T);let z=null;if(R.result==="error")throw new Error(R.value.map(st=>`${st.key}: ${st.message}`).join(", "));z=(st,ht,pt)=>R.value.evaluate(st,ht,{},pt);let W=null,et=null;if(_!==y){const st=wc(y,T);if(st.result==="error")throw new Error(st.value.map(ht=>`${ht.key}: ${ht.message}`).join(", "));W=(ht,pt,bt,Et,kt)=>st.value.evaluate(ht,pt,{},bt,void 0,void 0,Et,kt),et=!qi(st.value.expression)}return z=z,{filter:z,dynamicFilter:W||void 0,needGeometry:wh(_),needFeature:!!et}}function jf(g){if(!Array.isArray(g))return g;const c=function(y){if(f0.has(y[0])){for(let _=1;_<y.length;_++)if(Xs(y[_]))return!0}return y}(g);return c===!0?c:c.map(y=>jf(y))}function d0(g){let c=!1;const y=[];if(g[0]==="case"){for(let _=1;_<g.length-1;_+=2)c=c||Xs(g[_]),y.push(g[_+1]);y.push(g[g.length-1])}else if(g[0]==="match"){c=c||Xs(g[1]);for(let _=2;_<g.length-1;_+=2)y.push(g[_+1]);y.push(g[g.length-1])}else if(g[0]==="step"){c=c||Xs(g[1]);for(let _=1;_<g.length-1;_+=2)y.push(g[_+1])}c&&(g.length=0,g.push("any",...y));for(let _=1;_<g.length;_++)d0(g[_])}function Xs(g){if(!Array.isArray(g))return!1;if((c=g[0])==="pitch"||c==="distance-from-center")return!0;var c;for(let y=1;y<g.length;y++)if(Xs(g[y]))return!0;return!1}const f0=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Gf(g,c){return g<c?-1:g>c?1:0}function wh(g){if(!Array.isArray(g))return!1;if(g[0]==="within")return!0;for(let c=1;c<g.length;c++)if(wh(g[c]))return!0;return!1}function Sc(g){if(!g)return!0;const c=g[0];return g.length<=1?c!=="any":c==="=="?Ec(g[1],g[2],"=="):c==="!="?Tc(Ec(g[1],g[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Ec(g[1],g[2],c):c==="any"?(y=g.slice(1),["any"].concat(y.map(Sc))):c==="all"?["all"].concat(g.slice(1).map(Sc)):c==="none"?["all"].concat(g.slice(1).map(Sc).map(Tc)):c==="in"?Hf(g[1],g.slice(2)):c==="!in"?Tc(Hf(g[1],g.slice(2))):c==="has"?Wf(g[1]):c==="!has"?Tc(Wf(g[1])):c!=="within"||g;var y}function Ec(g,c,y){switch(g){case"$type":return[`filter-type-${y}`,c];case"$id":return[`filter-id-${y}`,c];default:return[`filter-${y}`,g,c]}}function Hf(g,c){if(c.length===0)return!1;switch(g){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(y=>typeof y!=typeof c[0])?["filter-in-large",g,["literal",c.sort(Gf)]]:["filter-in-small",g,["literal",c]]}}function Wf(g){switch(g){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",g]}}function Tc(g){return["!",g]}function Ys(g){return Ws(en(g.value))?fl(Ve({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):qf(g)}function qf(g){const c=g.value,y=g.key;if(Mr(c)!=="array")return[new yn(y,c,`array expected, ${Mr(c)} found`)];const _=g.styleSpec;let T,R=[];if(c.length<1)return[new yn(y,c,"filter array must have at least 1 element")];switch(R=R.concat(Ac({key:`${y}[0]`,value:c[0],valueSpec:_.filter_operator,style:g.style,styleSpec:g.styleSpec})),Ue(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&Ue(c[1])==="$type"&&R.push(new yn(y,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&R.push(new yn(y,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(T=Mr(c[1]),T!=="string"&&R.push(new yn(`${y}[1]`,c[1],`string expected, ${T} found`)));for(let z=2;z<c.length;z++)T=Mr(c[z]),Ue(c[1])==="$type"?R=R.concat(Ac({key:`${y}[${z}]`,value:c[z],valueSpec:_.geometry_type,style:g.style,styleSpec:g.styleSpec})):T!=="string"&&T!=="number"&&T!=="boolean"&&R.push(new yn(`${y}[${z}]`,c[z],`string, number, or boolean expected, ${T} found`));break;case"any":case"all":case"none":for(let z=1;z<c.length;z++)R=R.concat(qf({key:`${y}[${z}]`,value:c[z],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":T=Mr(c[1]),c.length!==2?R.push(new yn(y,c,`filter array for "${c[0]}" operator must have 2 elements`)):T!=="string"&&R.push(new yn(`${y}[1]`,c[1],`string expected, ${T} found`));break;case"within":T=Mr(c[1]),c.length!==2?R.push(new yn(y,c,`filter array for "${c[0]}" operator must have 2 elements`)):T!=="object"&&R.push(new yn(`${y}[1]`,c[1],`object expected, ${T} found`))}return R}function Xf(g,c){const y=g.key,_=g.style,T=g.styleSpec,R=g.value,z=g.objectKey,W=T[`${c}_${g.layerType}`];if(!W)return[];const et=z.match(/^(.*)-transition$/);if(c==="paint"&&et&&W[et[1]]&&W[et[1]].transition)return fi({key:y,value:R,valueSpec:T.transition,style:_,styleSpec:T});const st=g.valueSpec||W[z];if(!st)return[new yn(y,R,`unknown property "${z}"`)];let ht;if(Mr(R)==="string"&&hl(st)&&!st.tokens&&(ht=/^{([^}]+)}$/.exec(R)))return[new yn(y,R,`"${z}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ht[1])} }\`.`)];const pt=[];return g.layerType==="symbol"&&(z==="text-field"&&_&&!_.glyphs&&pt.push(new yn(y,R,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&Ca(en(R))&&Ue(R.type)==="identity"&&pt.push(new yn(y,R,'"text-font" does not support identity functions'))),pt.concat(fi({key:g.key,value:R,valueSpec:st,style:_,styleSpec:T,expressionContext:"property",propertyType:c,propertyKey:z}))}function Mh(g){return Xf(g,"paint")}function Yf(g){return Xf(g,"layout")}function p0(g){let c=[];const y=g.value,_=g.key,T=g.style,R=g.styleSpec;y.type||y.ref||c.push(new yn(_,y,'either "type" or "ref" is required'));let z=Ue(y.type);const W=Ue(y.ref);if(y.id){const et=Ue(y.id);for(let st=0;st<g.arrayIndex;st++){const ht=T.layers[st];Ue(ht.id)===et&&c.push(new yn(_,y.id,`duplicate layer id "${y.id}", previously used at line ${ht.id.__line__}`))}}if("ref"in y){let et;["type","source","source-layer","filter","layout"].forEach(st=>{st in y&&c.push(new yn(_,y[st],`"${st}" is prohibited for ref layers`))}),T.layers.forEach(st=>{Ue(st.id)===W&&(et=st)}),et?et.ref?c.push(new yn(_,y.ref,"ref cannot reference another ref layer")):z=Ue(et.type):typeof W=="string"&&c.push(new yn(_,y.ref,`ref layer "${W}" not found`))}else if(z!=="background"&&z!=="sky")if(y.source){const et=T.sources&&T.sources[y.source],st=et&&Ue(et.type);et?st==="vector"&&z==="raster"?c.push(new yn(_,y.source,`layer "${y.id}" requires a raster source`)):st==="raster"&&z!=="raster"?c.push(new yn(_,y.source,`layer "${y.id}" requires a vector source`)):st!=="vector"||y["source-layer"]?st==="raster-dem"&&z!=="hillshade"?c.push(new yn(_,y.source,"raster-dem source can only be used with layer type 'hillshade'.")):z!=="line"||!y.paint||!y.paint["line-gradient"]||st==="geojson"&&et.lineMetrics||c.push(new yn(_,y,`layer "${y.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new yn(_,y,`layer "${y.id}" must specify a "source-layer"`)):c.push(new yn(_,y.source,`source "${y.source}" not found`))}else c.push(new yn(_,y,'missing required property "source"'));return c=c.concat(Ao({key:_,value:y,valueSpec:R.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>fi({key:`${_}.type`,value:y.type,valueSpec:R.layer.type,style:g.style,styleSpec:g.styleSpec,object:y,objectKey:"type"}),filter:et=>Ys(Ve({layerType:z},et)),layout:et=>Ao({layer:y,key:et.key,value:et.value,valueSpec:{},style:et.style,styleSpec:et.styleSpec,objectElementValidators:{"*":st=>Yf(Ve({layerType:z},st))}}),paint:et=>Ao({layer:y,key:et.key,value:et.value,valueSpec:{},style:et.style,styleSpec:et.styleSpec,objectElementValidators:{"*":st=>Mh(Ve({layerType:z},st))}})}})),c}function vs(g){const c=g.value,y=g.key,_=Mr(c);return _!=="string"?[new yn(y,c,`string expected, ${_} found`)]:[]}const m0={promoteId:function({key:g,value:c}){if(Mr(c)==="string")return vs({key:g,value:c});{const y=[];for(const _ in c)y.push(...vs({key:`${g}.${_}`,value:c[_]}));return y}}};function g0(g){const c=g.value,y=g.key,_=g.styleSpec,T=g.style;if(!c.type)return[new yn(y,c,'"type" is required')];const R=Ue(c.type);let z;switch(R){case"vector":case"raster":case"raster-dem":return z=Ao({key:y,value:c,valueSpec:_[`source_${R.replace("-","_")}`],style:g.style,styleSpec:_,objectElementValidators:m0}),z;case"geojson":if(z=Ao({key:y,value:c,valueSpec:_.source_geojson,style:T,styleSpec:_,objectElementValidators:m0}),c.cluster)for(const W in c.clusterProperties){const[et,st]=c.clusterProperties[W],ht=typeof et=="string"?[et,["accumulated"],["get",W]]:et;z.push(...fl({key:`${y}.${W}.map`,value:st,expressionContext:"cluster-map"})),z.push(...fl({key:`${y}.${W}.reduce`,value:ht,expressionContext:"cluster-reduce"}))}return z;case"video":return Ao({key:y,value:c,valueSpec:_.source_video,style:T,styleSpec:_});case"image":return Ao({key:y,value:c,valueSpec:_.source_image,style:T,styleSpec:_});case"canvas":return[new yn(y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ac({key:`${y}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:T,styleSpec:_})}}function y0(g){const c=g.value,y=g.styleSpec,_=y.light,T=g.style;let R=[];const z=Mr(c);if(c===void 0)return R;if(z!=="object")return R=R.concat([new yn("light",c,`object expected, ${z} found`)]),R;for(const W in c){const et=W.match(/^(.*)-transition$/);R=R.concat(et&&_[et[1]]&&_[et[1]].transition?fi({key:W,value:c[W],valueSpec:y.transition,style:T,styleSpec:y}):_[W]?fi({key:W,value:c[W],valueSpec:_[W],style:T,styleSpec:y}):[new yn(W,c[W],`unknown property "${W}"`)])}return R}function b0(g){const c=g.value,y=g.key,_=g.style,T=g.styleSpec,R=T.terrain;let z=[];const W=Mr(c);if(c===void 0)return z;if(W!=="object")return z=z.concat([new yn("terrain",c,`object expected, ${W} found`)]),z;for(const et in c){const st=et.match(/^(.*)-transition$/);z=z.concat(st&&R[st[1]]&&R[st[1]].transition?fi({key:et,value:c[et],valueSpec:T.transition,style:_,styleSpec:T}):R[et]?fi({key:et,value:c[et],valueSpec:R[et],style:_,styleSpec:T}):[new yn(et,c[et],`unknown property "${et}"`)])}if(c.source){const et=_.sources&&_.sources[c.source],st=et&&Ue(et.type);et?st!=="raster-dem"&&z.push(new yn(y,c.source,`terrain cannot be used with a source of type ${String(st)}, it only be used with a "raster-dem" source type`)):z.push(new yn(y,c.source,`source "${c.source}" not found`))}else z.push(new yn(y,c,'terrain is missing required property "source"'));return z}function v0(g){const c=g.value,y=g.style,_=g.styleSpec,T=_.fog;let R=[];const z=Mr(c);if(c===void 0)return R;if(z!=="object")return R=R.concat([new yn("fog",c,`object expected, ${z} found`)]),R;for(const W in c){const et=W.match(/^(.*)-transition$/);R=R.concat(et&&T[et[1]]&&T[et[1]].transition?fi({key:W,value:c[W],valueSpec:_.transition,style:y,styleSpec:_}):T[W]?fi({key:W,value:c[W],valueSpec:T[W],style:y,styleSpec:_}):[new yn(W,c[W],`unknown property "${W}"`)])}return R}const Cc={"*":()=>[],array:Mc,boolean:function(g){const c=g.value,y=g.key,_=Mr(c);return _!=="boolean"?[new yn(y,c,`boolean expected, ${_} found`)]:[]},number:u0,color:function(g){const c=g.key,y=g.value,_=Mr(y);return _!=="string"?[new yn(c,y,`color expected, ${_} found`)]:Wi.parseCSSColor(y)===null?[new yn(c,y,`color expected, "${y}" found`)]:[]},enum:Ac,filter:Ys,function:h0,layer:p0,object:Ao,source:g0,light:y0,terrain:b0,fog:v0,string:vs,formatted:function(g){return vs(g).length===0?[]:fl(g)},resolvedImage:function(g){return vs(g).length===0?[]:fl(g)},projection:function(g){const c=g.value,y=g.styleSpec,_=y.projection,T=g.style;let R=[];const z=Mr(c);if(z==="object")for(const W in c)R=R.concat(fi({key:W,value:c[W],valueSpec:_[W],style:T,styleSpec:y}));else z!=="string"&&(R=R.concat([new yn("projection",c,`object or string expected, ${z} found`)]));return R}};function fi(g){const c=g.value,y=g.valueSpec,_=g.styleSpec;return y.expression&&Ca(Ue(c))?h0(g):y.expression&&dl(en(c))?fl(g):y.type&&Cc[y.type]?Cc[y.type](g):Ao(Ve({},g,{valueSpec:y.type?_[y.type]:y}))}function so(g){const c=g.value,y=g.key,_=vs(g);return _.length||(c.indexOf("{fontstack}")===-1&&_.push(new yn(y,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&_.push(new yn(y,c,'"glyphs" url must include a "{range}" token'))),_}function Pc(g,c=Yt){return xs(fi({key:"",value:g,valueSpec:c.$root,styleSpec:c,style:g,objectElementValidators:{glyphs:so,"*":()=>[]}}))}const Yb=g=>xs(Mh(g)),Kb=g=>xs(Yf(g));function xs(g){return g.slice().sort((c,y)=>c.line&&y.line?c.line-y.line:0)}function x0(g,c){let y=!1;if(c&&c.length)for(const _ of c)g.fire(new Lt(new Error(_.message))),y=!0;return y}var Ks=es;function es(g,c,y){var _=this.cells=[];if(g instanceof ArrayBuffer){this.arrayBuffer=g;var T=new Int32Array(this.arrayBuffer);g=T[0],this.d=(c=T[1])+2*(y=T[2]);for(var R=0;R<this.d*this.d;R++){var z=T[3+R],W=T[3+R+1];_.push(z===W?null:T.subarray(z,W))}var et=T[3+_.length+1];this.keys=T.subarray(T[3+_.length],et),this.bboxes=T.subarray(et),this.insert=this._insertReadonly}else{this.d=c+2*y;for(var st=0;st<this.d*this.d;st++)_.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=g,this.padding=y,this.scale=c/g,this.uid=0;var ht=y/c*g;this.min=-ht,this.max=g+ht}es.prototype.insert=function(g,c,y,_,T){this._forEachCell(c,y,_,T,this._insertCell,this.uid++),this.keys.push(g),this.bboxes.push(c),this.bboxes.push(y),this.bboxes.push(_),this.bboxes.push(T)},es.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},es.prototype._insertCell=function(g,c,y,_,T,R){this.cells[T].push(R)},es.prototype.query=function(g,c,y,_,T){var R=this.min,z=this.max;if(g<=R&&c<=R&&z<=y&&z<=_&&!T)return Array.prototype.slice.call(this.keys);var W=[];return this._forEachCell(g,c,y,_,this._queryCell,W,{},T),W},es.prototype._queryCell=function(g,c,y,_,T,R,z,W){var et=this.cells[T];if(et!==null)for(var st=this.keys,ht=this.bboxes,pt=0;pt<et.length;pt++){var bt=et[pt];if(z[bt]===void 0){var Et=4*bt;(W?W(ht[Et+0],ht[Et+1],ht[Et+2],ht[Et+3]):g<=ht[Et+2]&&c<=ht[Et+3]&&y>=ht[Et+0]&&_>=ht[Et+1])?(z[bt]=!0,R.push(st[bt])):z[bt]=!1}}},es.prototype._forEachCell=function(g,c,y,_,T,R,z,W){for(var et=this._convertToCellCoord(g),st=this._convertToCellCoord(c),ht=this._convertToCellCoord(y),pt=this._convertToCellCoord(_),bt=et;bt<=ht;bt++)for(var Et=st;Et<=pt;Et++){var kt=this.d*Et+bt;if((!W||W(this._convertFromCellCoord(bt),this._convertFromCellCoord(Et),this._convertFromCellCoord(bt+1),this._convertFromCellCoord(Et+1)))&&T.call(this,g,c,y,_,kt,R,z,W))return}},es.prototype._convertFromCellCoord=function(g){return(g-this.padding)/this.scale},es.prototype._convertToCellCoord=function(g){return Math.max(0,Math.min(this.d-1,Math.floor(g*this.scale)+this.padding))},es.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var g=this.cells,c=3+this.cells.length+1+1,y=0,_=0;_<this.cells.length;_++)y+=this.cells[_].length;var T=new Int32Array(c+y+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;for(var R=c,z=0;z<g.length;z++){var W=g[z];T[3+z]=R,T.set(W,R),R+=W.length}return T[3+g.length]=R,T.set(this.keys,R),T[3+g.length+1]=R+=this.keys.length,T.set(this.bboxes,R),R+=this.bboxes.length,T.buffer};const pl={};function xn(g,c,y={}){Object.defineProperty(g,"_classRegistryKey",{value:c,writeable:!1}),pl[c]={klass:g,omit:y.omit||[]}}xn(Object,"Object"),Ks.serialize=function(g,c){const y=g.toArrayBuffer();return c&&c.push(y),{buffer:y}},Ks.deserialize=function(g){return new Ks(g.buffer)},Object.defineProperty(Ks,"name",{value:"Grid"}),xn(Ks,"Grid"),xn(ar,"Color"),xn(Error,"Error"),xn(St,"AJAXError"),xn(rr,"ResolvedImage"),xn(xh,"StylePropertyFunction"),xn(vh,"StyleExpression",{omit:["_evaluator"]}),xn(Vf,"ZoomDependentExpression"),xn(Uf,"ZoomConstantExpression"),xn(yi,"CompoundExpression",{omit:["_evaluate"]});for(const g in Ea)pl[Ea[g]._classRegistryKey]||xn(Ea[g],`Expression${g}`);function _0(g){return g&&typeof ArrayBuffer!="undefined"&&(g instanceof ArrayBuffer||g.constructor&&g.constructor.name==="ArrayBuffer")}function Ah(g){return p.ImageBitmap&&g instanceof p.ImageBitmap}function Dc(g,c){if(g==null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||g instanceof Boolean||g instanceof Number||g instanceof String||g instanceof Date||g instanceof RegExp)return g;if(_0(g)||Ah(g))return c&&c.push(g),g;if(ArrayBuffer.isView(g)){const y=g;return c&&c.push(y.buffer),y}if(g instanceof p.ImageData)return c&&c.push(g.data.buffer),g;if(Array.isArray(g)){const y=[];for(const _ of g)y.push(Dc(_,c));return y}if(typeof g=="object"){const y=g.constructor,_=y._classRegistryKey;if(!_)throw new Error(`can't serialize object of unregistered class ${_}`);const T=y.serialize?y.serialize(g,c):{};if(!y.serialize){for(const R in g)g.hasOwnProperty(R)&&(pl[_].omit.indexOf(R)>=0||(T[R]=Dc(g[R],c)));g instanceof Error&&(T.message=g.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return _!=="Object"&&(T.$name=_),T}throw new Error("can't serialize object of type "+typeof g)}function ml(g){if(g==null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||g instanceof Boolean||g instanceof Number||g instanceof String||g instanceof Date||g instanceof RegExp||_0(g)||Ah(g)||ArrayBuffer.isView(g)||g instanceof p.ImageData)return g;if(Array.isArray(g))return g.map(ml);if(typeof g=="object"){const c=g.$name||"Object",{klass:y}=pl[c];if(!y)throw new Error(`can't deserialize unregistered class ${c}`);if(y.deserialize)return y.deserialize(g);const _=Object.create(y.prototype);for(const T of Object.keys(g))T!=="$name"&&(_[T]=ml(g[T]));return _}throw new Error("can't deserialize object of type "+typeof g)}class Kf{constructor(){this.first=!0}update(c,y){const _=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=_,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=_,!0):(this.lastFloorZoom>_?(this.lastIntegerZoom=_+1,this.lastIntegerZoomTime=y):this.lastFloorZoom<_&&(this.lastIntegerZoom=_,this.lastIntegerZoomTime=y),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=_,!0))}}const w0=g=>g>=1536&&g<=1791,Sh=g=>g>=1872&&g<=1919,Rc=g=>g>=2208&&g<=2303,Zf=g=>g>=11904&&g<=12031,M0=g=>g>=12032&&g<=12255,Jf=g=>g>=12272&&g<=12287,Eh=g=>g>=12288&&g<=12351,kc=g=>g>=12352&&g<=12447,Th=g=>g>=12448&&g<=12543,A0=g=>g>=12544&&g<=12591,S0=g=>g>=12704&&g<=12735,E0=g=>g>=12736&&g<=12783,$f=g=>g>=12784&&g<=12799,T0=g=>g>=12800&&g<=13055,C0=g=>g>=13056&&g<=13311,P0=g=>g>=13312&&g<=19903,Qf=g=>g>=19968&&g<=40959,D0=g=>g>=40960&&g<=42127,R0=g=>g>=42128&&g<=42191,k0=g=>g>=44032&&g<=55215,Ic=g=>g>=63744&&g<=64255,tp=g=>g>=64336&&g<=65023,I0=g=>g>=65040&&g<=65055,gl=g=>g>=65072&&g<=65103,L0=g=>g>=65104&&g<=65135,Ch=g=>g>=65136&&g<=65279,ep=g=>g>=65280&&g<=65519;function Ph(g){for(const c of g)if(Dh(c.charCodeAt(0)))return!0;return!1}function B0(g){for(const c of g)if(!F0(c.charCodeAt(0)))return!1;return!0}function F0(g){return!(w0(g)||Sh(g)||Rc(g)||tp(g)||Ch(g))}function Dh(g){return!(g!==746&&g!==747&&(g<4352||!(S0(g)||A0(g)||gl(g)&&!(g>=65097&&g<=65103)||Ic(g)||C0(g)||Zf(g)||E0(g)||!(!Eh(g)||g>=12296&&g<=12305||g>=12308&&g<=12319||g===12336)||P0(g)||Qf(g)||T0(g)||(c=>c>=12592&&c<=12687)(g)||(c=>c>=43360&&c<=43391)(g)||(c=>c>=55216&&c<=55295)(g)||(c=>c>=4352&&c<=4607)(g)||k0(g)||kc(g)||Jf(g)||(c=>c>=12688&&c<=12703)(g)||M0(g)||$f(g)||Th(g)&&g!==12540||!(!ep(g)||g===65288||g===65289||g===65293||g>=65306&&g<=65310||g===65339||g===65341||g===65343||g>=65371&&g<=65503||g===65507||g>=65512&&g<=65519)||!(!L0(g)||g>=65112&&g<=65118||g>=65123&&g<=65126)||(c=>c>=5120&&c<=5759)(g)||(c=>c>=6320&&c<=6399)(g)||I0(g)||(c=>c>=19904&&c<=19967)(g)||D0(g)||R0(g))))}function Rh(g){return!(Dh(g)||function(c){return!!((y=>y>=128&&y<=255)(c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||(y=>y>=8192&&y<=8303)(c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||(y=>y>=8448&&y<=8527)(c)||(y=>y>=8528&&y<=8591)(c)||(y=>y>=8960&&y<=9215)(c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||(y=>y>=9216&&y<=9279)(c)&&c!==9251||(y=>y>=9280&&y<=9311)(c)||(y=>y>=9312&&y<=9471)(c)||(y=>y>=9632&&y<=9727)(c)||(y=>y>=9728&&y<=9983)(c)&&!(c>=9754&&c<=9759)||(y=>y>=11008&&y<=11263)(c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Eh(c)||Th(c)||(y=>y>=57344&&y<=63743)(c)||gl(c)||L0(c)||ep(c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(g))}function kh(g){return g>=1424&&g<=2303||tp(g)||Ch(g)}function Zb(g,c){return!(!c&&kh(g)||g>=2304&&g<=3583||g>=3840&&g<=4255||(y=>y>=6016&&y<=6143)(g))}function Jb(g){for(const c of g)if(kh(c.charCodeAt(0)))return!0;return!1}const np="deferred",Lc="loading",rp="loaded";let ip=null,Xi="unavailable",ao=null;const Bc=function(g){g&&typeof g=="string"&&g.indexOf("NetworkError")>-1&&(Xi="error"),ip&&ip(g)};function Pa(){op.fire(new Tt("pluginStateChange",{pluginStatus:Xi,pluginURL:ao}))}const op=new ee,Ih=function(){return Xi},yl=function(){if(Xi!==np||!ao)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Xi=Lc,Pa(),ao&&Xt({url:ao},g=>{g?Bc(g):(Xi=rp,Pa())})},So={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Xi===rp||So.applyArabicShaping!=null,isLoading:()=>Xi===Lc,setState(g){Xi=g.pluginStatus,ao=g.pluginURL},isParsed:()=>So.applyArabicShaping!=null&&So.processBidirectionalText!=null&&So.processStyledBidirectionalText!=null,getPluginURL:()=>ao};class Dr{constructor(c,y){this.zoom=c,y?(this.now=y.now,this.fadeDuration=y.fadeDuration,this.zoomHistory=y.zoomHistory,this.transition=y.transition,this.pitch=y.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Kf,this.transition={},this.pitch=0)}isSupportedScript(c){return function(y,_){for(const T of y)if(!Zb(T.charCodeAt(0),_))return!1;return!0}(c,So.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,y=c-Math.floor(c),_=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:y+(1-y)*_}:{fromScale:.5,toScale:1,t:1-(1-_)*y}}}class Fc{constructor(c,y){this.property=c,this.value=y,this.expression=function(_,T){if(Ca(_))return new xh(_,T);if(dl(_)){const R=c0(_,T);if(R.result==="error")throw new Error(R.value.map(z=>`${z.key}: ${z.message}`).join(", "));return R.value}{let R=_;return typeof _=="string"&&T.type==="color"&&(R=ar.parse(_)),{kind:"constant",evaluate:()=>R}}}(y===void 0?c.specification.default:y,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,y,_){return this.property.possiblyEvaluate(this,c,y,_)}}class bl{constructor(c){this.property=c,this.value=new Fc(c,void 0)}transitioned(c,y){return new m(this.property,this.value,y,rt({},c.transition,this.transition),c.now)}untransitioned(){return new m(this.property,this.value,null,{},0)}}class P{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return it(this._values[c].value.value)}setValue(c,y){this._values.hasOwnProperty(c)||(this._values[c]=new bl(this._values[c].property)),this._values[c].value=new Fc(this._values[c].property,y===null?void 0:it(y))}getTransition(c){return it(this._values[c].transition)}setTransition(c,y){this._values.hasOwnProperty(c)||(this._values[c]=new bl(this._values[c].property)),this._values[c].transition=it(y)||void 0}serialize(){const c={};for(const y of Object.keys(this._values)){const _=this.getValue(y);_!==void 0&&(c[y]=_);const T=this.getTransition(y);T!==void 0&&(c[`${y}-transition`]=T)}return c}transitioned(c,y){const _=new S(this._properties);for(const T of Object.keys(this._values))_._values[T]=this._values[T].transitioned(c,y._values[T]);return _}untransitioned(){const c=new S(this._properties);for(const y of Object.keys(this._values))c._values[y]=this._values[y].untransitioned();return c}}class m{constructor(c,y,_,T,R){const z=T.delay||0,W=T.duration||0;R=R||0,this.property=c,this.value=y,this.begin=R+z,this.end=this.begin+W,c.specification.transition&&(T.delay||T.duration)&&(this.prior=_)}possiblyEvaluate(c,y,_){const T=c.now||0,R=this.value.possiblyEvaluate(c,y,_),z=this.prior;if(z){if(T>this.end)return this.prior=null,R;if(this.value.isDataDriven())return this.prior=null,R;if(T<this.begin)return z.possiblyEvaluate(c,y,_);{const W=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(z.possiblyEvaluate(c,y,_),R,E(W))}}return R}}class S{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,y,_){const T=new $(this._properties);for(const R of Object.keys(this._values))T._values[R]=this._values[R].possiblyEvaluate(c,y,_);return T}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class F{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}getValue(c){return it(this._values[c].value)}setValue(c,y){this._values[c]=new Fc(this._values[c].property,y===null?void 0:it(y))}serialize(){const c={};for(const y of Object.keys(this._values)){const _=this.getValue(y);_!==void 0&&(c[y]=_)}return c}possiblyEvaluate(c,y,_){const T=new $(this._properties);for(const R of Object.keys(this._values))T._values[R]=this._values[R].possiblyEvaluate(c,y,_);return T}}class X{constructor(c,y,_){this.property=c,this.value=y,this.parameters=_}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,y,_,T){return this.property.evaluate(this.value,this.parameters,c,y,_,T)}}class ${constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class ot{constructor(c){this.specification=c}possiblyEvaluate(c,y){return c.expression.evaluate(y)}interpolate(c,y,_){const T=ch[this.specification.type];return T?T(c,y,_):c}}class ct{constructor(c,y){this.specification=c,this.overrides=y}possiblyEvaluate(c,y,_,T){return new X(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(y,null,{},_,T)}:c.expression,y)}interpolate(c,y,_){if(c.value.kind!=="constant"||y.value.kind!=="constant")return c;if(c.value.value===void 0||y.value.value===void 0)return new X(this,{kind:"constant",value:void 0},c.parameters);const T=ch[this.specification.type];return T?new X(this,{kind:"constant",value:T(c.value.value,y.value.value,_)},c.parameters):c}evaluate(c,y,_,T,R,z){return c.kind==="constant"?c.value:c.evaluate(y,_,T,R,z)}}class yt extends ct{possiblyEvaluate(c,y,_,T){if(c.value===void 0)return new X(this,{kind:"constant",value:void 0},y);if(c.expression.kind==="constant"){const R=c.expression.evaluate(y,null,{},_,T),z=c.property.specification.type==="resolvedImage"&&typeof R!="string"?R.name:R,W=this._calculate(z,z,z,y);return new X(this,{kind:"constant",value:W},y)}if(c.expression.kind==="camera"){const R=this._calculate(c.expression.evaluate({zoom:y.zoom-1}),c.expression.evaluate({zoom:y.zoom}),c.expression.evaluate({zoom:y.zoom+1}),y);return new X(this,{kind:"constant",value:R},y)}return new X(this,c.expression,y)}evaluate(c,y,_,T,R,z){if(c.kind==="source"){const W=c.evaluate(y,_,T,R,z);return this._calculate(W,W,W,y)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(y.zoom)-1},_,T),c.evaluate({zoom:Math.floor(y.zoom)},_,T),c.evaluate({zoom:Math.floor(y.zoom)+1},_,T),y):c.value}_calculate(c,y,_,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:c,to:y,other:_}:{from:_,to:y,other:c}}interpolate(c){return c}}class xt{constructor(c){this.specification=c}possiblyEvaluate(c,y,_,T){if(c.value!==void 0){if(c.expression.kind==="constant"){const R=c.expression.evaluate(y,null,{},_,T);return this._calculate(R,R,R,y)}return this._calculate(c.expression.evaluate(new Dr(Math.floor(y.zoom-1),y)),c.expression.evaluate(new Dr(Math.floor(y.zoom),y)),c.expression.evaluate(new Dr(Math.floor(y.zoom+1),y)),y)}}_calculate(c,y,_,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:c,to:y}:{from:_,to:y}}interpolate(c){return c}}class Mt{constructor(c){this.specification=c}possiblyEvaluate(c,y,_,T){return!!c.expression.evaluate(y,null,{},_,T)}interpolate(){return!1}}class Pt{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const y in c){const _=c[y];_.specification.overridable&&this.overridableProperties.push(y);const T=this.defaultPropertyValues[y]=new Fc(_,void 0),R=this.defaultTransitionablePropertyValues[y]=new bl(_);this.defaultTransitioningPropertyValues[y]=R.untransitioned(),this.defaultPossiblyEvaluatedValues[y]=T.possiblyEvaluate({})}}}function Nt(g,c){return 256*(g=V(Math.floor(g),0,255))+V(Math.floor(c),0,255)}xn(ct,"DataDrivenProperty"),xn(ot,"DataConstantProperty"),xn(yt,"CrossFadedDataDrivenProperty"),xn(xt,"CrossFadedProperty"),xn(Mt,"ColorRampProperty");const Ht={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ut{constructor(c,y){this._structArray=c,this._pos1=y*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,y){return c._trim(),y&&(c.isTransferred=!0,y.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const y=Object.create(this.prototype);return y.arrayBuffer=c.arrayBuffer,y.length=c.length,y.capacity=c.arrayBuffer.byteLength/y.bytesPerElement,y._refreshViews(),y}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const y=this.uint8;this._refreshViews(),y&&this.uint8.set(y)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ae(g,c=1){let y=0,_=0;return{members:g.map(T=>{const R=Ht[T.type].BYTES_PER_ELEMENT,z=y=Jt(y,Math.max(c,R)),W=T.components||1;return _=Math.max(_,R),y+=R*W,{name:T.name,type:T.type,components:W,offset:z}}),size:Jt(y,Math.max(_,c)),alignment:c}}function Jt(g,c){return Math.ceil(g/c)*c}class ie extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,y){const _=this.length;return this.resize(_+1),this.emplace(_,c,y)}emplace(c,y,_){const T=2*c;return this.int16[T+0]=y,this.int16[T+1]=_,c}}ie.prototype.bytesPerElement=4,xn(ie,"StructArrayLayout2i4");class se extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,c,y,_)}emplace(c,y,_,T){const R=3*c;return this.int16[R+0]=y,this.int16[R+1]=_,this.int16[R+2]=T,c}}se.prototype.bytesPerElement=6,xn(se,"StructArrayLayout3i6");class ce extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,y,_,T){const R=this.length;return this.resize(R+1),this.emplace(R,c,y,_,T)}emplace(c,y,_,T,R){const z=4*c;return this.int16[z+0]=y,this.int16[z+1]=_,this.int16[z+2]=T,this.int16[z+3]=R,c}}ce.prototype.bytesPerElement=8,xn(ce,"StructArrayLayout4i8");class ne extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W){const et=this.length;return this.resize(et+1),this.emplace(et,c,y,_,T,R,z,W)}emplace(c,y,_,T,R,z,W,et){const st=6*c,ht=12*c,pt=3*c;return this.int16[st+0]=y,this.int16[st+1]=_,this.uint8[ht+4]=T,this.uint8[ht+5]=R,this.uint8[ht+6]=z,this.uint8[ht+7]=W,this.float32[pt+2]=et,c}}ne.prototype.bytesPerElement=12,xn(ne,"StructArrayLayout2i4ub1f12");class de extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_,T){const R=this.length;return this.resize(R+1),this.emplace(R,c,y,_,T)}emplace(c,y,_,T,R){const z=4*c;return this.float32[z+0]=y,this.float32[z+1]=_,this.float32[z+2]=T,this.float32[z+3]=R,c}}de.prototype.bytesPerElement=16,xn(de,"StructArrayLayout4f16");class Ae extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W,et,st,ht){const pt=this.length;return this.resize(pt+1),this.emplace(pt,c,y,_,T,R,z,W,et,st,ht)}emplace(c,y,_,T,R,z,W,et,st,ht,pt){const bt=10*c;return this.uint16[bt+0]=y,this.uint16[bt+1]=_,this.uint16[bt+2]=T,this.uint16[bt+3]=R,this.uint16[bt+4]=z,this.uint16[bt+5]=W,this.uint16[bt+6]=et,this.uint16[bt+7]=st,this.uint16[bt+8]=ht,this.uint16[bt+9]=pt,c}}Ae.prototype.bytesPerElement=20,xn(Ae,"StructArrayLayout10ui20");class Re extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W,et){const st=this.length;return this.resize(st+1),this.emplace(st,c,y,_,T,R,z,W,et)}emplace(c,y,_,T,R,z,W,et,st){const ht=8*c;return this.uint16[ht+0]=y,this.uint16[ht+1]=_,this.uint16[ht+2]=T,this.uint16[ht+3]=R,this.uint16[ht+4]=z,this.uint16[ht+5]=W,this.uint16[ht+6]=et,this.uint16[ht+7]=st,c}}Re.prototype.bytesPerElement=16,xn(Re,"StructArrayLayout8ui16");class je extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z){const W=this.length;return this.resize(W+1),this.emplace(W,c,y,_,T,R,z)}emplace(c,y,_,T,R,z,W){const et=6*c;return this.int16[et+0]=y,this.int16[et+1]=_,this.int16[et+2]=T,this.int16[et+3]=R,this.int16[et+4]=z,this.int16[et+5]=W,c}}je.prototype.bytesPerElement=12,xn(je,"StructArrayLayout6i12");class Ne extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt){const $t=this.length;return this.resize($t+1),this.emplace($t,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt)}emplace(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t){const ue=16*c;return this.int16[ue+0]=y,this.int16[ue+1]=_,this.int16[ue+2]=T,this.int16[ue+3]=R,this.uint16[ue+4]=z,this.uint16[ue+5]=W,this.uint16[ue+6]=et,this.uint16[ue+7]=st,this.int16[ue+8]=ht,this.int16[ue+9]=pt,this.int16[ue+10]=bt,this.int16[ue+11]=Et,this.int16[ue+12]=kt,this.int16[ue+13]=Ft,this.int16[ue+14]=Vt,this.int16[ue+15]=$t,c}}Ne.prototype.bytesPerElement=32,xn(Ne,"StructArrayLayout4i4ui4i4i32");class cn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,c,y,_)}emplace(c,y,_,T){const R=3*c;return this.float32[R+0]=y,this.float32[R+1]=_,this.float32[R+2]=T,c}}cn.prototype.bytesPerElement=12,xn(cn,"StructArrayLayout3f12");class Se extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const y=this.length;return this.resize(y+1),this.emplace(y,c)}emplace(c,y){return this.uint32[1*c+0]=y,c}}Se.prototype.bytesPerElement=4,xn(Se,"StructArrayLayout1ul4");class un extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et){const kt=this.length;return this.resize(kt+1),this.emplace(kt,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et)}emplace(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt){const Ft=20*c,Vt=10*c;return this.int16[Ft+0]=y,this.int16[Ft+1]=_,this.int16[Ft+2]=T,this.int16[Ft+3]=R,this.int16[Ft+4]=z,this.float32[Vt+3]=W,this.float32[Vt+4]=et,this.float32[Vt+5]=st,this.float32[Vt+6]=ht,this.int16[Ft+14]=pt,this.uint32[Vt+8]=bt,this.uint16[Ft+18]=Et,this.uint16[Ft+19]=kt,c}}un.prototype.bytesPerElement=40,xn(un,"StructArrayLayout5i4f1i1ul2ui40");class rn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W){const et=this.length;return this.resize(et+1),this.emplace(et,c,y,_,T,R,z,W)}emplace(c,y,_,T,R,z,W,et){const st=8*c;return this.int16[st+0]=y,this.int16[st+1]=_,this.int16[st+2]=T,this.int16[st+4]=R,this.int16[st+5]=z,this.int16[st+6]=W,this.int16[st+7]=et,c}}rn.prototype.bytesPerElement=16,xn(rn,"StructArrayLayout3i2i2i16");class En extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R){const z=this.length;return this.resize(z+1),this.emplace(z,c,y,_,T,R)}emplace(c,y,_,T,R,z){const W=4*c,et=8*c;return this.float32[W+0]=y,this.float32[W+1]=_,this.float32[W+2]=T,this.int16[et+6]=R,this.int16[et+7]=z,c}}En.prototype.bytesPerElement=16,xn(En,"StructArrayLayout2f1f2i16");class He extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_,T){const R=this.length;return this.resize(R+1),this.emplace(R,c,y,_,T)}emplace(c,y,_,T,R){const z=12*c,W=3*c;return this.uint8[z+0]=y,this.uint8[z+1]=_,this.float32[W+1]=T,this.float32[W+2]=R,c}}He.prototype.bytesPerElement=12,xn(He,"StructArrayLayout2ub2f12");class _n extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y,_){const T=this.length;return this.resize(T+1),this.emplace(T,c,y,_)}emplace(c,y,_,T){const R=3*c;return this.uint16[R+0]=y,this.uint16[R+1]=_,this.uint16[R+2]=T,c}}_n.prototype.bytesPerElement=6,xn(_n,"StructArrayLayout3ui6");class Fn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t,ue,ge,xe,_e){const we=this.length;return this.resize(we+1),this.emplace(we,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t,ue,ge,xe,_e)}emplace(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t,ue,ge,xe,_e,we){const Be=30*c,Oe=15*c,Je=60*c;return this.int16[Be+0]=y,this.int16[Be+1]=_,this.int16[Be+2]=T,this.float32[Oe+2]=R,this.float32[Oe+3]=z,this.uint16[Be+8]=W,this.uint16[Be+9]=et,this.uint32[Oe+5]=st,this.uint32[Oe+6]=ht,this.uint32[Oe+7]=pt,this.uint16[Be+16]=bt,this.uint16[Be+17]=Et,this.uint16[Be+18]=kt,this.float32[Oe+10]=Ft,this.float32[Oe+11]=Vt,this.uint8[Je+48]=$t,this.uint8[Je+49]=ue,this.uint8[Je+50]=ge,this.uint32[Oe+13]=xe,this.int16[Be+28]=_e,this.uint8[Je+58]=we,c}}Fn.prototype.bytesPerElement=60,xn(Fn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Mn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t,ue,ge,xe,_e,we,Be,Oe,Je,tn,De,qe,nn,fn){const sn=this.length;return this.resize(sn+1),this.emplace(sn,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t,ue,ge,xe,_e,we,Be,Oe,Je,tn,De,qe,nn,fn)}emplace(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt,$t,ue,ge,xe,_e,we,Be,Oe,Je,tn,De,qe,nn,fn,sn){const dn=38*c,Kn=19*c;return this.int16[dn+0]=y,this.int16[dn+1]=_,this.int16[dn+2]=T,this.float32[Kn+2]=R,this.float32[Kn+3]=z,this.int16[dn+8]=W,this.int16[dn+9]=et,this.int16[dn+10]=st,this.int16[dn+11]=ht,this.int16[dn+12]=pt,this.int16[dn+13]=bt,this.uint16[dn+14]=Et,this.uint16[dn+15]=kt,this.uint16[dn+16]=Ft,this.uint16[dn+17]=Vt,this.uint16[dn+18]=$t,this.uint16[dn+19]=ue,this.uint16[dn+20]=ge,this.uint16[dn+21]=xe,this.uint16[dn+22]=_e,this.uint16[dn+23]=we,this.uint16[dn+24]=Be,this.uint16[dn+25]=Oe,this.uint16[dn+26]=Je,this.uint16[dn+27]=tn,this.uint16[dn+28]=De,this.uint32[Kn+15]=qe,this.float32[Kn+16]=nn,this.float32[Kn+17]=fn,this.float32[Kn+18]=sn,c}}Mn.prototype.bytesPerElement=76,xn(Mn,"StructArrayLayout3i2f6i15ui1ul3f76");class An extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const y=this.length;return this.resize(y+1),this.emplace(y,c)}emplace(c,y){return this.float32[1*c+0]=y,c}}An.prototype.bytesPerElement=4,xn(An,"StructArrayLayout1f4");class Vn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W){const et=this.length;return this.resize(et+1),this.emplace(et,c,y,_,T,R,z,W)}emplace(c,y,_,T,R,z,W,et){const st=7*c;return this.float32[st+0]=y,this.float32[st+1]=_,this.float32[st+2]=T,this.float32[st+3]=R,this.float32[st+4]=z,this.float32[st+5]=W,this.float32[st+6]=et,c}}Vn.prototype.bytesPerElement=28,xn(Vn,"StructArrayLayout7f28");class ir extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R){const z=this.length;return this.resize(z+1),this.emplace(z,c,y,_,T,R)}emplace(c,y,_,T,R,z){const W=5*c;return this.float32[W+0]=y,this.float32[W+1]=_,this.float32[W+2]=T,this.float32[W+3]=R,this.float32[W+4]=z,c}}ir.prototype.bytesPerElement=20,xn(ir,"StructArrayLayout5f20");class Bn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y,_,T){const R=this.length;return this.resize(R+1),this.emplace(R,c,y,_,T)}emplace(c,y,_,T,R){const z=6*c;return this.uint32[3*c+0]=y,this.uint16[z+2]=_,this.uint16[z+3]=T,this.uint16[z+4]=R,c}}Bn.prototype.bytesPerElement=12,xn(Bn,"StructArrayLayout1ul3ui12");class Gn extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,y){const _=this.length;return this.resize(_+1),this.emplace(_,c,y)}emplace(c,y,_){const T=2*c;return this.uint16[T+0]=y,this.uint16[T+1]=_,c}}Gn.prototype.bytesPerElement=4,xn(Gn,"StructArrayLayout2ui4");class gr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const y=this.length;return this.resize(y+1),this.emplace(y,c)}emplace(c,y){return this.uint16[1*c+0]=y,c}}gr.prototype.bytesPerElement=2,xn(gr,"StructArrayLayout1ui2");class Vr extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y){const _=this.length;return this.resize(_+1),this.emplace(_,c,y)}emplace(c,y,_){const T=2*c;return this.float32[T+0]=y,this.float32[T+1]=_,c}}Vr.prototype.bytesPerElement=8,xn(Vr,"StructArrayLayout2f8");class Pi extends Bt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,y,_,T,R,z,W){const et=this.length;return this.resize(et+1),this.emplace(et,c,y,_,T,R,z,W)}emplace(c,y,_,T,R,z,W,et){const st=8*c,ht=4*c;return this.int16[st+0]=y,this.int16[st+1]=_,this.int16[st+2]=T,this.int16[st+3]=R,this.int16[st+4]=z,this.int16[st+5]=W,this.float32[ht+3]=et,c}}Pi.prototype.bytesPerElement=16,xn(Pi,"StructArrayLayout6i1f16");class Di extends Ut{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Di.prototype.size=12;class lo extends je{get(c){return new Di(this,c)}}xn(lo,"FillExtrusionExtArray");class Wo extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Wo.prototype.size=40;class _s extends un{get(c){return new Wo(this,c)}}xn(_s,"CollisionBoxArray");class Zs extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(c){this._structArray.uint8[this._pos1+49]=c}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(c){this._structArray.uint8[this._pos1+50]=c}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(c){this._structArray.uint32[this._pos4+13]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(c){this._structArray.uint8[this._pos1+58]=c}}Zs.prototype.size=60;class ws extends Fn{get(c){return new Zs(this,c)}}xn(ws,"PlacedSymbolArray");class Gr extends Ut{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(c){this._structArray.uint32[this._pos4+15]=c}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Gr.prototype.size=76;class Yr extends Mn{get(c){return new Gr(this,c)}}xn(Yr,"SymbolInstanceArray");class br extends An{getoffsetX(c){return this.float32[1*c+0]}}xn(br,"GlyphOffsetArray");class Qr extends se{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}xn(Qr,"SymbolLineVertexArray");class co extends Ut{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}co.prototype.size=12;class jr extends Bn{get(c){return new co(this,c)}}xn(jr,"FeatureIndexArray");class Eo extends Ut{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Eo.prototype.size=4;class Nc extends Gn{get(c){return new Eo(this,c)}}xn(Nc,"FillExtrusionCentroidArray");class uo extends Ut{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}get a_scale(){return this._structArray.float32[this._pos4+3]}}uo.prototype.size=16;class Da extends Pi{get(c){return new uo(this,c)}}xn(Da,"CircleGlobeExtArray");const N0=ae([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),sp=ae([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var vl=Ei(function(g){g.exports=function(c,y){var _,T,R,z,W,et,st,ht;for(T=c.length-(_=3&c.length),R=y,W=3432918353,et=461845907,ht=0;ht<T;)st=255&c.charCodeAt(ht)|(255&c.charCodeAt(++ht))<<8|(255&c.charCodeAt(++ht))<<16|(255&c.charCodeAt(++ht))<<24,++ht,R=27492+(65535&(z=5*(65535&(R=(R^=st=(65535&(st=(st=(65535&st)*W+(((st>>>16)*W&65535)<<16)&4294967295)<<15|st>>>17))*et+(((st>>>16)*et&65535)<<16)&4294967295)<<13|R>>>19))+((5*(R>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(st=0,_){case 3:st^=(255&c.charCodeAt(ht+2))<<16;case 2:st^=(255&c.charCodeAt(ht+1))<<8;case 1:R^=st=(65535&(st=(st=(65535&(st^=255&c.charCodeAt(ht)))*W+(((st>>>16)*W&65535)<<16)&4294967295)<<15|st>>>17))*et+(((st>>>16)*et&65535)<<16)&4294967295}return R^=c.length,R=2246822507*(65535&(R^=R>>>16))+((2246822507*(R>>>16)&65535)<<16)&4294967295,R=3266489909*(65535&(R^=R>>>13))+((3266489909*(R>>>16)&65535)<<16)&4294967295,(R^=R>>>16)>>>0}}),$b=Ei(function(g){g.exports=function(c,y){for(var _,T=c.length,R=y^T,z=0;T>=4;)_=1540483477*(65535&(_=255&c.charCodeAt(z)|(255&c.charCodeAt(++z))<<8|(255&c.charCodeAt(++z))<<16|(255&c.charCodeAt(++z))<<24))+((1540483477*(_>>>16)&65535)<<16),R=1540483477*(65535&R)+((1540483477*(R>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:R^=(255&c.charCodeAt(z+2))<<16;case 2:R^=(255&c.charCodeAt(z+1))<<8;case 1:R=1540483477*(65535&(R^=255&c.charCodeAt(z)))+((1540483477*(R>>>16)&65535)<<16)}return R=1540483477*(65535&(R^=R>>>13))+((1540483477*(R>>>16)&65535)<<16),(R^=R>>>15)>>>0}}),Js=vl,ap=$b;Js.murmur3=vl,Js.murmur2=ap;class O0{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,y,_,T){this.ids.push(WM(c)),this.positions.push(y,_,T)}getPositions(c){const y=WM(c);let _=0,T=this.ids.length-1;for(;_<T;){const z=_+T>>1;this.ids[z]>=y?T=z:_=z+1}const R=[];for(;this.ids[_]===y;)R.push({index:this.positions[3*_],start:this.positions[3*_+1],end:this.positions[3*_+2]}),_++;return R}static serialize(c,y){const _=new Float64Array(c.ids),T=new Uint32Array(c.positions);return Qb(_,T,0,_.length-1),y&&y.push(_.buffer,T.buffer),{ids:_,positions:T}}static deserialize(c){const y=new O0;return y.ids=c.ids,y.positions=c.positions,y.indexed=!0,y}}function WM(g){const c=+g;return!isNaN(c)&&Number.MIN_SAFE_INTEGER<=c&&c<=Number.MAX_SAFE_INTEGER?c:Js(String(g))}function Qb(g,c,y,_){for(;y<_;){const T=g[y+_>>1];let R=y-1,z=_+1;for(;;){do R++;while(g[R]<T);do z--;while(g[z]>T);if(R>=z)break;z0(g,R,z),z0(c,3*R,3*z),z0(c,3*R+1,3*z+1),z0(c,3*R+2,3*z+2)}z-y<_-z?(Qb(g,c,y,z),y=z+1):(Qb(g,c,z+1,_),_=z)}}function z0(g,c,y){const _=g[c];g[c]=g[y],g[y]=_}xn(O0,"FeaturePositionMap");class Ra{constructor(c,y){this.gl=c.gl,this.location=y}}class U0 extends Ra{constructor(c,y){super(c,y),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class qM extends Ra{constructor(c,y){super(c,y),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class XM extends Ra{constructor(c,y){super(c,y),this.current=ar.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const AO=new Float32Array(16),SO=new Float32Array(9),EO=new Float32Array(4);function tv(g){return[Nt(255*g.r,255*g.g),Nt(255*g.b,255*g.a)]}class lp{constructor(c,y,_){this.value=c,this.uniformNames=y.map(T=>`u_${T}`),this.type=_}setUniform(c,y,_){c.set(_.constantOr(this.value))}getBinding(c,y,_){return this.type==="color"?new XM(c,y):new U0(c,y)}}class Lh{constructor(c,y){this.uniformNames=y.map(_=>`u_${_}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,y){this.pixelRatioFrom=y.pixelRatio||1,this.pixelRatioTo=c.pixelRatio||1,this.patternFrom=y.tl.concat(y.br),this.patternTo=c.tl.concat(c.br)}setUniform(c,y,_,T){const R=T==="u_pattern_to"||T==="u_dash_to"?this.patternTo:T==="u_pattern_from"||T==="u_dash_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;R&&c.set(R)}getBinding(c,y,_){return _==="u_pattern_from"||_==="u_pattern_to"||_==="u_dash_from"||_==="u_dash_to"?new qM(c,y):new U0(c,y)}}class ka{constructor(c,y,_,T){this.expression=c,this.type=_,this.maxValue=0,this.paintVertexAttributes=y.map(R=>({name:`a_${R}`,type:"Float32",components:_==="color"?2:1,offset:0})),this.paintVertexArray=new T}populatePaintArray(c,y,_,T,R,z){const W=this.paintVertexArray.length,et=this.expression.evaluate(new Dr(0),y,{},R,T,z);this.paintVertexArray.resize(c),this._setPaintValue(W,c,et)}updatePaintArray(c,y,_,T,R){const z=this.expression.evaluate({zoom:0},_,T,void 0,R);this._setPaintValue(c,y,z)}_setPaintValue(c,y,_){if(this.type==="color"){const T=tv(_);for(let R=c;R<y;R++)this.paintVertexArray.emplace(R,T[0],T[1])}else{for(let T=c;T<y;T++)this.paintVertexArray.emplace(T,_);this.maxValue=Math.max(this.maxValue,Math.abs(_))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ms{constructor(c,y,_,T,R,z){this.expression=c,this.uniformNames=y.map(W=>`u_${W}_t`),this.type=_,this.useIntegerZoom=T,this.zoom=R,this.maxValue=0,this.paintVertexAttributes=y.map(W=>({name:`a_${W}`,type:"Float32",components:_==="color"?4:2,offset:0})),this.paintVertexArray=new z}populatePaintArray(c,y,_,T,R,z){const W=this.expression.evaluate(new Dr(this.zoom),y,{},R,T,z),et=this.expression.evaluate(new Dr(this.zoom+1),y,{},R,T,z),st=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(st,c,W,et)}updatePaintArray(c,y,_,T,R){const z=this.expression.evaluate({zoom:this.zoom},_,T,void 0,R),W=this.expression.evaluate({zoom:this.zoom+1},_,T,void 0,R);this._setPaintValue(c,y,z,W)}_setPaintValue(c,y,_,T){if(this.type==="color"){const R=tv(_),z=tv(T);for(let W=c;W<y;W++)this.paintVertexArray.emplace(W,R[0],R[1],z[0],z[1])}else{for(let R=c;R<y;R++)this.paintVertexArray.emplace(R,_,T);this.maxValue=Math.max(this.maxValue,Math.abs(_),Math.abs(T))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,y){const _=this.useIntegerZoom?Math.floor(y.zoom):y.zoom,T=V(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);c.set(T)}getBinding(c,y,_){return new U0(c,y)}}class xl{constructor(c,y,_,T,R,z,W){this.expression=c,this.type=_,this.useIntegerZoom=T,this.zoom=R,this.layerId=W,this.paintVertexAttributes=(_==="array"?sp:N0).members;for(let et=0;et<y.length;++et);this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(c,y,_){const T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(T,c,y.patterns&&y.patterns[this.layerId],_)}updatePaintArray(c,y,_,T,R,z){this._setPaintValues(c,y,_.patterns&&_.patterns[this.layerId],z)}_setPaintValues(c,y,_,T){if(!T||!_)return;const{min:R,mid:z,max:W}=_,et=T[R],st=T[z],ht=T[W];if(et&&st&&ht)for(let pt=c;pt<y;pt++)this._setPaintValue(this.zoomInPaintVertexArray,pt,st,et),this._setPaintValue(this.zoomOutPaintVertexArray,pt,st,ht)}_setPaintValue(c,y,_,T){c.emplace(y,_.tl[0],_.tl[1],_.br[0],_.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],_.pixelRatio,T.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class _l{constructor(c,y,_=()=>!0){this.binders={},this._buffers=[];const T=[];for(const R in c.paint._values){if(!_(R))continue;const z=c.paint.get(R);if(!(z instanceof X&&hl(z.property.specification)))continue;const W=CO(R,c.type),et=z.value,st=z.property.specification.type,ht=z.property.useIntegerZoom,pt=z.property.specification["property-type"],bt=pt==="cross-faded"||pt==="cross-faded-data-driven",Et=String(R)==="line-dasharray"&&c.layout.get("line-cap").value.kind!=="constant";if(et.kind!=="constant"||Et)if(et.kind==="source"||Et||bt){const kt=YM(R,st,"source");this.binders[R]=bt?new xl(et,W,st,ht,y,kt,c.id):new ka(et,W,st,kt),T.push(`/a_${R}`)}else{const kt=YM(R,st,"composite");this.binders[R]=new Ms(et,W,st,ht,y,kt),T.push(`/z_${R}`)}else this.binders[R]=bt?new Lh(et.value,W):new lp(et.value,W,st),T.push(`/u_${R}`)}this.cacheKey=T.sort().join("")}getMaxValue(c){const y=this.binders[c];return y instanceof ka||y instanceof Ms?y.maxValue:0}populatePaintArrays(c,y,_,T,R,z){for(const W in this.binders){const et=this.binders[W];(et instanceof ka||et instanceof Ms||et instanceof xl)&&et.populatePaintArray(c,y,_,T,R,z)}}setConstantPatternPositions(c,y){for(const _ in this.binders){const T=this.binders[_];T instanceof Lh&&T.setConstantPatternPositions(c,y)}}updatePaintArrays(c,y,_,T,R,z){let W=!1;for(const et in c){const st=y.getPositions(et);for(const ht of st){const pt=_.feature(ht.index);for(const bt in this.binders){const Et=this.binders[bt];if((Et instanceof ka||Et instanceof Ms||Et instanceof xl)&&Et.expression.isStateDependent===!0){const kt=T.paint.get(bt);Et.expression=kt.value,Et.updatePaintArray(ht.start,ht.end,pt,c[et],R,z),W=!0}}}}return W}defines(){const c=[];for(const y in this.binders){const _=this.binders[y];(_ instanceof lp||_ instanceof Lh)&&c.push(..._.uniformNames.map(T=>`#define HAS_UNIFORM_${T}`))}return c}getBinderAttributes(){const c=[];for(const y in this.binders){const _=this.binders[y];if(_ instanceof ka||_ instanceof Ms||_ instanceof xl)for(let T=0;T<_.paintVertexAttributes.length;T++)c.push(_.paintVertexAttributes[T].name)}return c}getBinderUniforms(){const c=[];for(const y in this.binders){const _=this.binders[y];if(_ instanceof lp||_ instanceof Lh||_ instanceof Ms)for(const T of _.uniformNames)c.push(T)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,y){const _=[];for(const T in this.binders){const R=this.binders[T];if(R instanceof lp||R instanceof Lh||R instanceof Ms){for(const z of R.uniformNames)if(y[z]){const W=R.getBinding(c,y[z],z);_.push({name:z,property:T,binding:W})}}}return _}setUniforms(c,y,_,T){for(const{name:R,property:z,binding:W}of y)this.binders[z].setUniform(W,T,_.get(z),R)}updatePaintBuffers(c){this._buffers=[];for(const y in this.binders){const _=this.binders[y];if(c&&_ instanceof xl){const T=c.fromScale===2?_.zoomInPaintVertexBuffer:_.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(_ instanceof ka||_ instanceof Ms)&&_.paintVertexBuffer&&this._buffers.push(_.paintVertexBuffer)}}upload(c){for(const y in this.binders){const _=this.binders[y];(_ instanceof ka||_ instanceof Ms||_ instanceof xl)&&_.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const y=this.binders[c];(y instanceof ka||y instanceof Ms||y instanceof xl)&&y.destroy()}}}class Oc{constructor(c,y,_=()=>!0){this.programConfigurations={};for(const T of c)this.programConfigurations[T.id]=new _l(T,y,_);this.needsUpload=!1,this._featureMap=new O0,this._bufferOffset=0}populatePaintArrays(c,y,_,T,R,z,W){for(const et in this.programConfigurations)this.programConfigurations[et].populatePaintArrays(c,y,T,R,z,W);y.id!==void 0&&this._featureMap.add(y.id,_,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,y,_,T,R){for(const z of _)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(c,this._featureMap,y,z,T,R)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const y in this.programConfigurations)this.programConfigurations[y].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}const TO={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function CO(g,c){return TO[g]||[g.replace(`${c}-`,"").replace(/-/g,"_")]}const PO={"line-pattern":{source:Ae,composite:Ae},"fill-pattern":{source:Ae,composite:Ae},"fill-extrusion-pattern":{source:Ae,composite:Ae},"line-dasharray":{source:Re,composite:Re}},DO={color:{source:Vr,composite:de},number:{source:An,composite:Vr}};function YM(g,c,y){const _=PO[g];return _&&_[y]||DO[c][y]}xn(lp,"ConstantBinder"),xn(Lh,"CrossFadedConstantBinder"),xn(ka,"SourceExpressionBinder"),xn(xl,"CrossFadedCompositeBinder"),xn(Ms,"CompositeExpressionBinder"),xn(_l,"ProgramConfiguration",{omit:["_buffers"]}),xn(Oc,"ProgramConfigurationSet");const V0="-transition";class As extends ee{constructor(c,y){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,c.type!=="custom"&&(this.metadata=(c=c).metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&c.type!=="sky"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),y.layout&&(this._unevaluatedLayout=new F(y.layout)),y.paint)){this._transitionablePaint=new P(y.paint);for(const _ in c.paint)this.setPaintProperty(_,c.paint[_],{validate:!1});for(const _ in c.layout)this.setLayoutProperty(_,c.layout[_],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new $(y.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,y,_={}){y!=null&&this._validate(Kb,`layers.${this.id}.layout.${c}`,c,y,_)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,y):this.visibility=y)}getPaintProperty(c){return B(c,V0)?this._transitionablePaint.getTransition(c.slice(0,-V0.length)):this._transitionablePaint.getValue(c)}setPaintProperty(c,y,_={}){if(y!=null&&this._validate(Yb,`layers.${this.id}.paint.${c}`,c,y,_))return!1;if(B(c,V0))return this._transitionablePaint.setTransition(c.slice(0,-V0.length),y||void 0),!1;{const T=this._transitionablePaint._values[c],R=T.property.specification["property-type"]==="cross-faded-data-driven",z=T.value.isDataDriven(),W=T.value;this._transitionablePaint.setValue(c,y),this._handleSpecialPaintPropertyUpdate(c);const et=this._transitionablePaint._values[c].value;return et.isDataDriven()||z||R||this._handleOverridablePaintPropertyUpdate(c,W,et)}}_handleSpecialPaintPropertyUpdate(c){}getProgramIds(){return null}getProgramConfiguration(c){return null}_handleOverridablePaintPropertyUpdate(c,y,_){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,y){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,y)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,y)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),q(c,(y,_)=>!(y===void 0||_==="layout"&&!Object.keys(y).length||_==="paint"&&!Object.keys(y).length))}_validate(c,y,_,T,R={}){return(!R||R.validate!==!1)&&x0(this,c.call(Pc,{key:y,layerType:this.type,objectKey:_,value:T,styleSpec:Yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const y=this.paint.get(c);if(y instanceof X&&hl(y.property.specification)&&(y.value.kind==="source"||y.value.kind==="composite")&&y.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=qs(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const RO=ae([{name:"a_pos",components:2,type:"Int16"}],4),kO=ae([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"},{name:"a_scale",components:1,type:"Float32"}]);class Kr{constructor(c=[]){this.segments=c}prepareSegment(c,y,_,T){let R=this.segments[this.segments.length-1];return c>Kr.MAX_VERTEX_ARRAY_LENGTH&&lt(`Max vertices per segment is ${Kr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!R||R.vertexLength+c>Kr.MAX_VERTEX_ARRAY_LENGTH||R.sortKey!==T)&&(R={vertexOffset:y.length,primitiveOffset:_.length,vertexLength:0,primitiveLength:0},T!==void 0&&(R.sortKey=T),this.segments.push(R)),R}get(){return this.segments}destroy(){for(const c of this.segments)for(const y in c.vaos)c.vaos[y].destroy()}static simpleSegment(c,y,_,T){return new Kr([{vertexOffset:c,primitiveOffset:y,vertexLength:_,primitiveLength:T,vaos:{},sortKey:0}])}}Kr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xn(Kr,"SegmentVector");var tr=8192;class wl{constructor(c,y){c&&(y?this.setSouthWest(c).setNorthEast(y):c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1]))}setNorthEast(c){return this._ne=c instanceof Ar?new Ar(c.lng,c.lat):Ar.convert(c),this}setSouthWest(c){return this._sw=c instanceof Ar?new Ar(c.lng,c.lat):Ar.convert(c),this}extend(c){const y=this._sw,_=this._ne;let T,R;if(c instanceof Ar)T=c,R=c;else{if(!(c instanceof wl))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(wl.convert(c)):this.extend(Ar.convert(c)):this;if(T=c._sw,R=c._ne,!T||!R)return this}return y||_?(y.lng=Math.min(T.lng,y.lng),y.lat=Math.min(T.lat,y.lat),_.lng=Math.max(R.lng,_.lng),_.lat=Math.max(R.lat,_.lat)):(this._sw=new Ar(T.lng,T.lat),this._ne=new Ar(R.lng,R.lat)),this}getCenter(){return new Ar((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ar(this.getWest(),this.getNorth())}getSouthEast(){return new Ar(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(c){const{lng:y,lat:_}=Ar.convert(c);let T=this._sw.lng<=y&&y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=y&&y>=this._ne.lng),this._sw.lat<=_&&_<=this._ne.lat&&T}static convert(c){return!c||c instanceof wl?c:new wl(c)}}const ev=63710088e-1;class Ar{constructor(c,y){if(isNaN(c)||isNaN(y))throw new Error(`Invalid LngLat object: (${c}, ${y})`);if(this.lng=+c,this.lat=+y,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ar(j(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const y=Math.PI/180,_=this.lat*y,T=c.lat*y,R=Math.sin(_)*Math.sin(T)+Math.cos(_)*Math.cos(T)*Math.cos((c.lng-this.lng)*y);return ev*Math.acos(Math.min(R,1))}toBounds(c=0){const y=360*c/40075017,_=y/Math.cos(Math.PI/180*this.lat);return new wl(new Ar(this.lng-_,this.lat-y),new Ar(this.lng+_,this.lat+y))}static convert(c){if(c instanceof Ar)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new Ar(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new Ar(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const KM=2*Math.PI*ev;function nv(g){return KM*Math.cos(g*Math.PI/180)}function cp(g){return(180+g)/360}function Bh(g){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+g*Math.PI/360)))/360}function Fh(g,c){return g/nv(c)}function ns(g){return 360*g-180}function Ri(g){return 360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90}function ZM(g,c){return g*nv(Ri(c))}const $s=85.051129;class j0{constructor(c,y,_=0){this.x=+c,this.y=+y,this.z=+_}static fromLngLat(c,y=0){const _=Ar.convert(c);return new j0(cp(_.lng),Bh(_.lat),Fh(y,_.lat))}toLngLat(){return new Ar(ns(this.x),Ri(this.y))}toAltitude(){return ZM(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/KM*(c=Ri(this.y),1/Math.cos(c*Math.PI/180));var c}}function rv(g,c,y,_,T,R,z,W,et){const st=(c+_)/2,ht=(y+T)/2,pt=new f(st,ht);W(pt),function(bt,Et,kt,Ft,Vt,$t){const ue=kt-Vt,ge=Ft-$t;return Math.abs((Ft-Et)*ue-(kt-bt)*ge)/Math.hypot(ue,ge)}(pt.x,pt.y,R.x,R.y,z.x,z.y)>=et?(rv(g,c,y,st,ht,R,pt,W,et),rv(g,st,ht,_,T,pt,z,W,et)):g.push(z)}function IO(g,c,y){let _=g[0],T=_.x,R=_.y;c(_);const z=[_];for(let W=1;W<g.length;W++){const et=g[W],{x:st,y:ht}=et;c(et),rv(z,T,R,st,ht,_,et,c,y),T=st,R=ht,_=et}return z}const iv=Math.pow(2,14)-1,JM=-iv-1;function LO(g,c){const y=Math.round(g.x*c),_=Math.round(g.y*c);return g.x=V(y,JM,iv),g.y=V(_,JM,iv),(y<g.x||y>g.x+1||_<g.y||_>g.y+1)&&lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),g}function Ia(g,c,y){const _=g.loadGeometry(),T=g.extent,R=tr/T;if(c&&y&&y.projection.isReprojectedInTileSpace){const z=1<<c.z,{scale:W,x:et,y:st,projection:ht}=y,pt=bt=>{const Et=ns((c.x+bt.x/T)/z),kt=Ri((c.y+bt.y/T)/z),Ft=ht.project(Et,kt);bt.x=(Ft.x*W-et)*T,bt.y=(Ft.y*W-st)*T};for(let bt=0;bt<_.length;bt++)if(g.type!==1)_[bt]=IO(_[bt],pt,1);else{const Et=[];for(const kt of _[bt])kt.x<0||kt.x>=T||kt.y<0||kt.y>=T||(pt(kt),Et.push(kt));_[bt]=Et}}for(const z of _)for(const W of z)LO(W,R);return _}function zc(g,c){return{type:g.type,id:g.id,properties:g.properties,geometry:c?Ia(g):[]}}function G0(g,c,y,_,T){g.emplaceBack(2*c+(_+1)/2,2*y+(T+1)/2)}function H0(g,c,y,_){g.emplaceBack(c.x,c.y,c.z,y[0]*16384,y[1]*16384,y[2]*16384,_)}class ov{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(y=>y.id),this.index=c.index,this.hasPattern=!1,this.projection=c.projection,this.layoutVertexArray=new ie,this.indexArray=new _n,this.segments=new Kr,this.programConfigurations=new Oc(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id)}populate(c,y,_,T){const R=this.layers[0],z=[];let W=null;R.type==="circle"&&(W=R.layout.get("circle-sort-key"));for(const{feature:st,id:ht,index:pt,sourceLayerIndex:bt}of c){const Et=this.layers[0]._featureFilter.needGeometry,kt=zc(st,Et);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),kt,_))continue;const Ft=W?W.evaluate(kt,{},_):void 0,Vt={id:ht,properties:st.properties,type:st.type,sourceLayerIndex:bt,index:pt,geometry:Et?kt.geometry:Ia(st,_,T),patterns:{},sortKey:Ft};z.push(Vt)}W&&z.sort((st,ht)=>st.sortKey-ht.sortKey);let et=null;T.projection.name==="globe"&&(this.globeExtVertexArray=new Da,et=T.projection);for(const st of z){const{geometry:ht,index:pt,sourceLayerIndex:bt}=st,Et=c[pt].feature;this.addFeature(st,ht,pt,y.availableImages,_,et),y.featureIndex.insert(Et,ht,pt,bt,this.index)}}update(c,y,_,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,y,this.stateDependentLayers,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,RO.members),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=c.createVertexBuffer(this.globeExtVertexArray,kO.members))),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(c,y,_,T,R,z){for(const W of y)for(const et of W){const st=et.x,ht=et.y;if(st<0||st>=tr||ht<0||ht>=tr)continue;if(z){const Et=z.projectTilePoint(st,ht,R),kt=z.upVector(R,st,ht),Ft=Ri((ht/tr+R.y)/(1<<R.z)),Vt=z.pixelsPerMeter(Ft,1)/Fh(1,Ft),$t=this.globeExtVertexArray;H0($t,Et,kt,Vt),H0($t,Et,kt,Vt),H0($t,Et,kt,Vt),H0($t,Et,kt,Vt)}const pt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),bt=pt.vertexLength;G0(this.layoutVertexArray,st,ht,-1,-1),G0(this.layoutVertexArray,st,ht,1,-1),G0(this.layoutVertexArray,st,ht,1,1),G0(this.layoutVertexArray,st,ht,-1,1),this.indexArray.emplaceBack(bt,bt+1,bt+2),this.indexArray.emplaceBack(bt,bt+3,bt+2),pt.vertexLength+=4,pt.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{},T,R)}}function $M(g,c){for(let y=0;y<g.length;y++)if(Nh(c,g[y]))return!0;for(let y=0;y<c.length;y++)if(Nh(g,c[y]))return!0;return!!sv(g,c)}function BO(g,c,y){return!!Nh(g,c)||!!av(c,g,y)}function QM(g,c){if(g.length===1)return e3(c,g[0]);for(let y=0;y<c.length;y++){const _=c[y];for(let T=0;T<_.length;T++)if(Nh(g,_[T]))return!0}for(let y=0;y<g.length;y++)if(e3(c,g[y]))return!0;for(let y=0;y<c.length;y++)if(sv(g,c[y]))return!0;return!1}function FO(g,c,y){if(g.length>1){if(sv(g,c))return!0;for(let _=0;_<c.length;_++)if(av(c[_],g,y))return!0}for(let _=0;_<g.length;_++)if(av(g[_],c,y))return!0;return!1}function sv(g,c){if(g.length===0||c.length===0)return!1;for(let y=0;y<g.length-1;y++){const _=g[y],T=g[y+1];for(let R=0;R<c.length-1;R++)if(NO(_,T,c[R],c[R+1]))return!0}return!1}function NO(g,c,y,_){return ut(g,y,_)!==ut(c,y,_)&&ut(g,c,y)!==ut(g,c,_)}function av(g,c,y){const _=y*y;if(c.length===1)return g.distSqr(c[0])<_;for(let T=1;T<c.length;T++)if(t3(g,c[T-1],c[T])<_)return!0;return!1}function t3(g,c,y){const _=c.distSqr(y);if(_===0)return g.distSqr(c);const T=((g.x-c.x)*(y.x-c.x)+(g.y-c.y)*(y.y-c.y))/_;return g.distSqr(T<0?c:T>1?y:y.sub(c)._mult(T)._add(c))}function e3(g,c){let y,_,T,R=!1;for(let z=0;z<g.length;z++){y=g[z];for(let W=0,et=y.length-1;W<y.length;et=W++)_=y[W],T=y[et],_.y>c.y!=T.y>c.y&&c.x<(T.x-_.x)*(c.y-_.y)/(T.y-_.y)+_.x&&(R=!R)}return R}function Nh(g,c){let y=!1;for(let _=0,T=g.length-1;_<g.length;T=_++){const R=g[_],z=g[T];R.y>c.y!=z.y>c.y&&c.x<(z.x-R.x)*(c.y-R.y)/(z.y-R.y)+R.x&&(y=!y)}return y}function n3(g,c,y,_,T){for(const z of g)if(c<=z.x&&y<=z.y&&_>=z.x&&T>=z.y)return!0;const R=[new f(c,y),new f(c,T),new f(_,T),new f(_,y)];if(g.length>2){for(const z of R)if(Nh(g,z))return!0}for(let z=0;z<g.length-1;z++)if(OO(g[z],g[z+1],R))return!0;return!1}function OO(g,c,y){const _=y[0],T=y[2];if(g.x<_.x&&c.x<_.x||g.x>T.x&&c.x>T.x||g.y<_.y&&c.y<_.y||g.y>T.y&&c.y>T.y)return!1;const R=ut(g,c,y[0]);return R!==ut(g,c,y[1])||R!==ut(g,c,y[2])||R!==ut(g,c,y[3])}function Oh(g,c,y){const _=c.paint.get(g).value;return _.kind==="constant"?_.value:y.programConfigurations.get(c.id).getMaxValue(g)}function W0(g){return Math.sqrt(g[0]*g[0]+g[1]*g[1])}function r3(g,c,y,_,T){if(!c[0]&&!c[1])return g;const R=f.convert(c)._mult(T);y==="viewport"&&R._rotate(-_);const z=[];for(let W=0;W<g.length;W++)z.push(g[W].sub(R));return z}function i3(g,c,y,_){const T=f.convert(g)._mult(_);return c==="viewport"&&T._rotate(-y),T}xn(ov,"CircleBucket",{omit:["layers"]});const zO=new Pt({"circle-sort-key":new ct(Yt.layout_circle["circle-sort-key"])});var UO={paint:new Pt({"circle-radius":new ct(Yt.paint_circle["circle-radius"]),"circle-color":new ct(Yt.paint_circle["circle-color"]),"circle-blur":new ct(Yt.paint_circle["circle-blur"]),"circle-opacity":new ct(Yt.paint_circle["circle-opacity"]),"circle-translate":new ot(Yt.paint_circle["circle-translate"]),"circle-translate-anchor":new ot(Yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ot(Yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ot(Yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(Yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(Yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(Yt.paint_circle["circle-stroke-opacity"])}),layout:zO},lv=1e-6,To=typeof Float32Array!="undefined"?Float32Array:Array;function o3(){var g=new To(9);return To!=Float32Array&&(g[1]=0,g[2]=0,g[3]=0,g[5]=0,g[6]=0,g[7]=0),g[0]=1,g[4]=1,g[8]=1,g}function Qs(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}function cv(g,c,y){var _=c[0],T=c[1],R=c[2],z=c[3],W=c[4],et=c[5],st=c[6],ht=c[7],pt=c[8],bt=c[9],Et=c[10],kt=c[11],Ft=c[12],Vt=c[13],$t=c[14],ue=c[15],ge=y[0],xe=y[1],_e=y[2],we=y[3];return g[0]=ge*_+xe*W+_e*pt+we*Ft,g[1]=ge*T+xe*et+_e*bt+we*Vt,g[2]=ge*R+xe*st+_e*Et+we*$t,g[3]=ge*z+xe*ht+_e*kt+we*ue,g[4]=(ge=y[4])*_+(xe=y[5])*W+(_e=y[6])*pt+(we=y[7])*Ft,g[5]=ge*T+xe*et+_e*bt+we*Vt,g[6]=ge*R+xe*st+_e*Et+we*$t,g[7]=ge*z+xe*ht+_e*kt+we*ue,g[8]=(ge=y[8])*_+(xe=y[9])*W+(_e=y[10])*pt+(we=y[11])*Ft,g[9]=ge*T+xe*et+_e*bt+we*Vt,g[10]=ge*R+xe*st+_e*Et+we*$t,g[11]=ge*z+xe*ht+_e*kt+we*ue,g[12]=(ge=y[12])*_+(xe=y[13])*W+(_e=y[14])*pt+(we=y[15])*Ft,g[13]=ge*T+xe*et+_e*bt+we*Vt,g[14]=ge*R+xe*st+_e*Et+we*$t,g[15]=ge*z+xe*ht+_e*kt+we*ue,g}function Uc(g,c,y){var _,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft=y[0],Vt=y[1],$t=y[2];return c===g?(g[12]=c[0]*Ft+c[4]*Vt+c[8]*$t+c[12],g[13]=c[1]*Ft+c[5]*Vt+c[9]*$t+c[13],g[14]=c[2]*Ft+c[6]*Vt+c[10]*$t+c[14],g[15]=c[3]*Ft+c[7]*Vt+c[11]*$t+c[15]):(T=c[1],R=c[2],z=c[3],W=c[4],et=c[5],st=c[6],ht=c[7],pt=c[8],bt=c[9],Et=c[10],kt=c[11],g[0]=_=c[0],g[1]=T,g[2]=R,g[3]=z,g[4]=W,g[5]=et,g[6]=st,g[7]=ht,g[8]=pt,g[9]=bt,g[10]=Et,g[11]=kt,g[12]=_*Ft+W*Vt+pt*$t+c[12],g[13]=T*Ft+et*Vt+bt*$t+c[13],g[14]=R*Ft+st*Vt+Et*$t+c[14],g[15]=z*Ft+ht*Vt+kt*$t+c[15]),g}function Ml(g,c,y){var _=y[0],T=y[1],R=y[2];return g[0]=c[0]*_,g[1]=c[1]*_,g[2]=c[2]*_,g[3]=c[3]*_,g[4]=c[4]*T,g[5]=c[5]*T,g[6]=c[6]*T,g[7]=c[7]*T,g[8]=c[8]*R,g[9]=c[9]*R,g[10]=c[10]*R,g[11]=c[11]*R,g[12]=c[12],g[13]=c[13],g[14]=c[14],g[15]=c[15],g}function uv(g,c,y){var _=Math.sin(y),T=Math.cos(y),R=c[4],z=c[5],W=c[6],et=c[7],st=c[8],ht=c[9],pt=c[10],bt=c[11];return c!==g&&(g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g[12]=c[12],g[13]=c[13],g[14]=c[14],g[15]=c[15]),g[4]=R*T+st*_,g[5]=z*T+ht*_,g[6]=W*T+pt*_,g[7]=et*T+bt*_,g[8]=st*T-R*_,g[9]=ht*T-z*_,g[10]=pt*T-W*_,g[11]=bt*T-et*_,g}function hv(g,c,y){var _=Math.sin(y),T=Math.cos(y),R=c[0],z=c[1],W=c[2],et=c[3],st=c[8],ht=c[9],pt=c[10],bt=c[11];return c!==g&&(g[4]=c[4],g[5]=c[5],g[6]=c[6],g[7]=c[7],g[12]=c[12],g[13]=c[13],g[14]=c[14],g[15]=c[15]),g[0]=R*T-st*_,g[1]=z*T-ht*_,g[2]=W*T-pt*_,g[3]=et*T-bt*_,g[8]=R*_+st*T,g[9]=z*_+ht*T,g[10]=W*_+pt*T,g[11]=et*_+bt*T,g}Math.hypot||(Math.hypot=function(){for(var g=0,c=arguments.length;c--;)g+=arguments[c]*arguments[c];return Math.sqrt(g)});var VO=cv;function dv(){var g=new To(3);return To!=Float32Array&&(g[0]=0,g[1]=0,g[2]=0),g}function s3(g){var c=new To(3);return c[0]=g[0],c[1]=g[1],c[2]=g[2],c}function a3(g){return Math.hypot(g[0],g[1],g[2])}function up(g,c,y){var _=new To(3);return _[0]=g,_[1]=c,_[2]=y,_}function l3(g,c,y){return g[0]=c[0]+y[0],g[1]=c[1]+y[1],g[2]=c[2]+y[2],g}function c3(g,c,y){return g[0]=c[0]-y[0],g[1]=c[1]-y[1],g[2]=c[2]-y[2],g}function u3(g,c,y){return g[0]=c[0]*y[0],g[1]=c[1]*y[1],g[2]=c[2]*y[2],g}function fv(g,c,y){return g[0]=Math.min(c[0],y[0]),g[1]=Math.min(c[1],y[1]),g[2]=Math.min(c[2],y[2]),g}function pv(g,c,y){return g[0]=Math.max(c[0],y[0]),g[1]=Math.max(c[1],y[1]),g[2]=Math.max(c[2],y[2]),g}function hp(g,c,y){return g[0]=c[0]*y,g[1]=c[1]*y,g[2]=c[2]*y,g}function mv(g,c,y,_){return g[0]=c[0]+y[0]*_,g[1]=c[1]+y[1]*_,g[2]=c[2]+y[2]*_,g}function dp(g,c){var y=c[0],_=c[1],T=c[2],R=y*y+_*_+T*T;return R>0&&(R=1/Math.sqrt(R)),g[0]=c[0]*R,g[1]=c[1]*R,g[2]=c[2]*R,g}function fp(g,c){return g[0]*c[0]+g[1]*c[1]+g[2]*c[2]}function h3(g,c,y){var _=c[0],T=c[1],R=c[2],z=y[0],W=y[1],et=y[2];return g[0]=T*et-R*W,g[1]=R*z-_*et,g[2]=_*W-T*z,g}function Vc(g,c,y){var _=c[0],T=c[1],R=c[2],z=y[3]*_+y[7]*T+y[11]*R+y[15];return g[0]=(y[0]*_+y[4]*T+y[8]*R+y[12])/(z=z||1),g[1]=(y[1]*_+y[5]*T+y[9]*R+y[13])/z,g[2]=(y[2]*_+y[6]*T+y[10]*R+y[14])/z,g}function d3(g,c,y){var _=y[0],T=y[1],R=y[2],z=c[0],W=c[1],et=c[2],st=T*et-R*W,ht=R*z-_*et,pt=_*W-T*z,bt=T*pt-R*ht,Et=R*st-_*pt,kt=_*ht-T*st,Ft=2*y[3];return ht*=Ft,pt*=Ft,Et*=2,kt*=2,g[0]=z+(st*=Ft)+(bt*=2),g[1]=W+ht+Et,g[2]=et+pt+kt,g}var pp,zh=c3,jO=u3,GO=a3;function Uh(g,c,y){var _=c[0],T=c[1],R=c[2],z=c[3];return g[0]=y[0]*_+y[4]*T+y[8]*R+y[12]*z,g[1]=y[1]*_+y[5]*T+y[9]*R+y[13]*z,g[2]=y[2]*_+y[6]*T+y[10]*R+y[14]*z,g[3]=y[3]*_+y[7]*T+y[11]*R+y[15]*z,g}function f3(){var g=new To(4);return To!=Float32Array&&(g[0]=0,g[1]=0,g[2]=0),g[3]=1,g}function p3(g){return g[0]=0,g[1]=0,g[2]=0,g[3]=1,g}function m3(g,c,y){y*=.5;var _=c[0],T=c[1],R=c[2],z=c[3],W=Math.sin(y),et=Math.cos(y);return g[0]=_*et+z*W,g[1]=T*et+R*W,g[2]=R*et-T*W,g[3]=z*et-_*W,g}dv(),pp=new To(4),To!=Float32Array&&(pp[0]=0,pp[1]=0,pp[2]=0,pp[3]=0),dv(),up(1,0,0),up(0,1,0),f3(),f3(),o3();class gv{constructor(c,y){this.points=c,this.planes=y}static fromInvProjectionMatrix(c,y,_,T){const R=Math.pow(2,_),z=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(et=>{const st=Uh([],et,c),ht=1/st[3]/y*R;return function(pt,bt,Et){return pt[0]=bt[0]*Et[0],pt[1]=bt[1]*Et[1],pt[2]=bt[2]*Et[2],pt[3]=bt[3]*Et[3],pt}(st,st,[ht,ht,T?1/st[3]:ht,ht])}),W=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(et=>{const st=dp([],h3([],zh([],z[et[0]],z[et[1]]),zh([],z[et[2]],z[et[1]]))),ht=-fp(st,z[et[1]]);return st.concat(ht)});return new gv(z,W)}}class qo{constructor(c,y){this.min=c,this.max=y,this.center=hp([],l3([],this.min,this.max),.5)}quadrant(c){const y=[c%2==0,c<2],_=s3(this.min),T=s3(this.max);for(let R=0;R<y.length;R++)_[R]=y[R]?this.min[R]:this.center[R],T[R]=y[R]?this.center[R]:this.max[R];return T[2]=this.max[2],new qo(_,T)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}distanceZ(c){return Math.max(Math.min(this.max[2],c[2]),this.min[2])-c[2]}getCorners(){const c=this.min,y=this.max;return[[c[0],c[1],c[2]],[y[0],c[1],c[2]],[y[0],y[1],c[2]],[c[0],y[1],c[2]],[c[0],c[1],y[2]],[y[0],c[1],y[2]],[y[0],y[1],y[2]],[c[0],y[1],y[2]]]}intersects(c){const y=this.getCorners();let _=!0;for(let T=0;T<c.planes.length;T++){const R=c.planes[T];let z=0;for(let W=0;W<y.length;W++)z+=fp(R,y[W])+R[3]>=0;if(z===0)return 0;z!==y.length&&(_=!1)}if(_)return 2;for(let T=0;T<3;T++){let R=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(let W=0;W<c.points.length;W++){const et=c.points[W][T]-this.min[T];R=Math.min(R,et),z=Math.max(z,et)}if(z<0||R>this.max[T]-this.min[T])return 0}return 1}}function g3(g,c,y,_,T,R,z,W,et){if(R&&g.queryGeometry.isAboveHorizon)return!1;R&&(et*=g.pixelToTileUnitsFactor);for(const st of c)for(const ht of st){const pt=ht.add(W),bt=T&&y.elevation?y.elevation.exaggeration()*T.getElevationAt(pt.x,pt.y,!0):0,Et=R?pt:HO(pt,bt,_),kt=R?g.tilespaceRays.map(Vt=>qO(Vt,bt)):g.queryGeometry.screenGeometry,Ft=Uh([],[ht.x,ht.y,bt,1],_);if(!z&&R?et*=Ft[3]/y.cameraToCenterDistance:z&&!R&&(et*=y.cameraToCenterDistance/Ft[3]),BO(kt,Et,et))return!0}return!1}function HO(g,c,y){const _=Uh([],[g.x,g.y,c,1],y);return new f(_[0]/_[3],_[1]/_[3])}const y3=up(0,0,0),WO=up(0,0,1);function qO(g,c){const y=dv();return y3[2]=c,g.intersectsPlane(y3,WO,y),new f(y[0],y[1])}class b3 extends ov{}function v3(g,{width:c,height:y},_,T){if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==c*y*_)throw new RangeError("mismatched image size")}else T=new Uint8Array(c*y*_);return g.width=c,g.height=y,g.data=T,g}function x3(g,c,y){const{width:_,height:T}=c;_===g.width&&T===g.height||(yv(g,c,{x:0,y:0},{x:0,y:0},{width:Math.min(g.width,_),height:Math.min(g.height,T)},y),g.width=_,g.height=T,g.data=c.data)}function yv(g,c,y,_,T,R){if(T.width===0||T.height===0)return c;if(T.width>g.width||T.height>g.height||y.x>g.width-T.width||y.y>g.height-T.height)throw new RangeError("out of range source coordinates for image copy");if(T.width>c.width||T.height>c.height||_.x>c.width-T.width||_.y>c.height-T.height)throw new RangeError("out of range destination coordinates for image copy");const z=g.data,W=c.data;for(let et=0;et<T.height;et++){const st=((y.y+et)*g.width+y.x)*R,ht=((_.y+et)*c.width+_.x)*R;for(let pt=0;pt<T.width*R;pt++)W[ht+pt]=z[st+pt]}return c}xn(b3,"HeatmapBucket",{omit:["layers"]});class La{constructor(c,y){v3(this,c,1,y)}resize(c){x3(this,new La(c),1)}clone(){return new La({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,y,_,T,R){yv(c,y,_,T,R,1)}}class Co{constructor(c,y){v3(this,c,4,y)}resize(c){x3(this,new Co(c),4)}replace(c,y){y?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new Co({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,y,_,T,R){yv(c,y,_,T,R,4)}}xn(La,"AlphaImage"),xn(Co,"RGBAImage");var XO={paint:new Pt({"heatmap-radius":new ct(Yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(Yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ot(Yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mt(Yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ot(Yt.paint_heatmap["heatmap-opacity"])})};function bv(g){const c={},y=g.resolution||256,_=g.clips?g.clips.length:1,T=g.image||new Co({width:y,height:_}),R=(z,W,et)=>{c[g.evaluationKey]=et;const st=g.expression.evaluate(c);T.data[z+W+0]=Math.floor(255*st.r/st.a),T.data[z+W+1]=Math.floor(255*st.g/st.a),T.data[z+W+2]=Math.floor(255*st.b/st.a),T.data[z+W+3]=Math.floor(255*st.a)};if(g.clips)for(let z=0,W=0;z<_;++z,W+=4*y)for(let et=0,st=0;et<y;et++,st+=4){const ht=et/(y-1),{start:pt,end:bt}=g.clips[z];R(W,st,pt*(1-ht)+bt*ht)}else for(let z=0,W=0;z<y;z++,W+=4)R(0,W,z/(y-1));return T}var YO={paint:new Pt({"hillshade-illumination-direction":new ot(Yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ot(Yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ot(Yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ot(Yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ot(Yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ot(Yt.paint_hillshade["hillshade-accent-color"])})};const KO=ae([{name:"a_pos",components:2,type:"Int16"}],4),{members:ZO}=KO;var q0=X0,JO=X0;function X0(g,c,y){y=y||2;var _,T,R,z,W,et,st,ht=c&&c.length,pt=ht?c[0]*y:g.length,bt=_3(g,0,pt,y,!0),Et=[];if(!bt||bt.next===bt.prev)return Et;if(ht&&(bt=function(Ft,Vt,$t,ue){var ge,xe,_e,we=[];for(ge=0,xe=Vt.length;ge<xe;ge++)(_e=_3(Ft,Vt[ge]*ue,ge<xe-1?Vt[ge+1]*ue:Ft.length,ue,!1))===_e.next&&(_e.steiner=!0),we.push(oz(_e));for(we.sort(nz),ge=0;ge<we.length;ge++)$t=Al($t=rz(we[ge],$t),$t.next);return $t}(g,c,bt,y)),g.length>80*y){_=R=g[0],T=z=g[1];for(var kt=y;kt<pt;kt+=y)(W=g[kt])<_&&(_=W),(et=g[kt+1])<T&&(T=et),W>R&&(R=W),et>z&&(z=et);st=(st=Math.max(R-_,z-T))!==0?1/st:0}return mp(bt,Et,y,_,T,st),Et}function _3(g,c,y,_,T){var R,z;if(T===_v(g,c,y,_)>0)for(R=c;R<y;R+=_)z=A3(R,g[R],g[R+1],z);else for(R=y-_;R>=c;R-=_)z=A3(R,g[R],g[R+1],z);return z&&Y0(z,z.next)&&(yp(z),z=z.next),z}function Al(g,c){if(!g)return g;c||(c=g);var y,_=g;do if(y=!1,_.steiner||!Y0(_,_.next)&&ti(_.prev,_,_.next)!==0)_=_.next;else{if(yp(_),(_=c=_.prev)===_.next)break;y=!0}while(y||_!==c);return c}function mp(g,c,y,_,T,R,z){if(g){!z&&R&&function(ht,pt,bt,Et){var kt=ht;do kt.z===null&&(kt.z=vv(kt.x,kt.y,pt,bt,Et)),kt.prevZ=kt.prev,kt.nextZ=kt.next,kt=kt.next;while(kt!==ht);kt.prevZ.nextZ=null,kt.prevZ=null,function(Ft){var Vt,$t,ue,ge,xe,_e,we,Be,Oe=1;do{for($t=Ft,Ft=null,xe=null,_e=0;$t;){for(_e++,ue=$t,we=0,Vt=0;Vt<Oe&&(we++,ue=ue.nextZ);Vt++);for(Be=Oe;we>0||Be>0&&ue;)we!==0&&(Be===0||!ue||$t.z<=ue.z)?(ge=$t,$t=$t.nextZ,we--):(ge=ue,ue=ue.nextZ,Be--),xe?xe.nextZ=ge:Ft=ge,ge.prevZ=xe,xe=ge;$t=ue}xe.nextZ=null,Oe*=2}while(_e>1)}(kt)}(g,_,T,R);for(var W,et,st=g;g.prev!==g.next;)if(W=g.prev,et=g.next,R?QO(g,_,T,R):$O(g))c.push(W.i/y),c.push(g.i/y),c.push(et.i/y),yp(g),g=et.next,st=et.next;else if((g=et)===st){z?z===1?mp(g=tz(Al(g),c,y),c,y,_,T,R,2):z===2&&ez(g,c,y,_,T,R):mp(Al(g),c,y,_,T,R,1);break}}}function $O(g){var c=g.prev,y=g,_=g.next;if(ti(c,y,_)>=0)return!1;for(var T=g.next.next;T!==g.prev;){if(Vh(c.x,c.y,y.x,y.y,_.x,_.y,T.x,T.y)&&ti(T.prev,T,T.next)>=0)return!1;T=T.next}return!0}function QO(g,c,y,_){var T=g.prev,R=g,z=g.next;if(ti(T,R,z)>=0)return!1;for(var W=T.x>R.x?T.x>z.x?T.x:z.x:R.x>z.x?R.x:z.x,et=T.y>R.y?T.y>z.y?T.y:z.y:R.y>z.y?R.y:z.y,st=vv(T.x<R.x?T.x<z.x?T.x:z.x:R.x<z.x?R.x:z.x,T.y<R.y?T.y<z.y?T.y:z.y:R.y<z.y?R.y:z.y,c,y,_),ht=vv(W,et,c,y,_),pt=g.prevZ,bt=g.nextZ;pt&&pt.z>=st&&bt&&bt.z<=ht;){if(pt!==g.prev&&pt!==g.next&&Vh(T.x,T.y,R.x,R.y,z.x,z.y,pt.x,pt.y)&&ti(pt.prev,pt,pt.next)>=0||(pt=pt.prevZ,bt!==g.prev&&bt!==g.next&&Vh(T.x,T.y,R.x,R.y,z.x,z.y,bt.x,bt.y)&&ti(bt.prev,bt,bt.next)>=0))return!1;bt=bt.nextZ}for(;pt&&pt.z>=st;){if(pt!==g.prev&&pt!==g.next&&Vh(T.x,T.y,R.x,R.y,z.x,z.y,pt.x,pt.y)&&ti(pt.prev,pt,pt.next)>=0)return!1;pt=pt.prevZ}for(;bt&&bt.z<=ht;){if(bt!==g.prev&&bt!==g.next&&Vh(T.x,T.y,R.x,R.y,z.x,z.y,bt.x,bt.y)&&ti(bt.prev,bt,bt.next)>=0)return!1;bt=bt.nextZ}return!0}function tz(g,c,y){var _=g;do{var T=_.prev,R=_.next.next;!Y0(T,R)&&w3(T,_,_.next,R)&&gp(T,R)&&gp(R,T)&&(c.push(T.i/y),c.push(_.i/y),c.push(R.i/y),yp(_),yp(_.next),_=g=R),_=_.next}while(_!==g);return Al(_)}function ez(g,c,y,_,T,R){var z=g;do{for(var W=z.next.next;W!==z.prev;){if(z.i!==W.i&&sz(z,W)){var et=M3(z,W);return z=Al(z,z.next),et=Al(et,et.next),mp(z,c,y,_,T,R),void mp(et,c,y,_,T,R)}W=W.next}z=z.next}while(z!==g)}function nz(g,c){return g.x-c.x}function rz(g,c){var y=function(R,z){var W,et=z,st=R.x,ht=R.y,pt=-1/0;do{if(ht<=et.y&&ht>=et.next.y&&et.next.y!==et.y){var bt=et.x+(ht-et.y)*(et.next.x-et.x)/(et.next.y-et.y);if(bt<=st&&bt>pt){if(pt=bt,bt===st){if(ht===et.y)return et;if(ht===et.next.y)return et.next}W=et.x<et.next.x?et:et.next}}et=et.next}while(et!==z);if(!W)return null;if(st===pt)return W;var Et,kt=W,Ft=W.x,Vt=W.y,$t=1/0;et=W;do st>=et.x&&et.x>=Ft&&st!==et.x&&Vh(ht<Vt?st:pt,ht,Ft,Vt,ht<Vt?pt:st,ht,et.x,et.y)&&(Et=Math.abs(ht-et.y)/(st-et.x),gp(et,R)&&(Et<$t||Et===$t&&(et.x>W.x||et.x===W.x&&iz(W,et)))&&(W=et,$t=Et)),et=et.next;while(et!==kt);return W}(g,c);if(!y)return c;var _=M3(y,g),T=Al(y,y.next);return Al(_,_.next),c===y?T:c}function iz(g,c){return ti(g.prev,g,c.prev)<0&&ti(c.next,g,g.next)<0}function vv(g,c,y,_,T){return(g=1431655765&((g=858993459&((g=252645135&((g=16711935&((g=32767*(g-y)*T)|g<<8))|g<<4))|g<<2))|g<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=32767*(c-_)*T)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function oz(g){var c=g,y=g;do(c.x<y.x||c.x===y.x&&c.y<y.y)&&(y=c),c=c.next;while(c!==g);return y}function Vh(g,c,y,_,T,R,z,W){return(T-z)*(c-W)-(g-z)*(R-W)>=0&&(g-z)*(_-W)-(y-z)*(c-W)>=0&&(y-z)*(R-W)-(T-z)*(_-W)>=0}function sz(g,c){return g.next.i!==c.i&&g.prev.i!==c.i&&!function(y,_){var T=y;do{if(T.i!==y.i&&T.next.i!==y.i&&T.i!==_.i&&T.next.i!==_.i&&w3(T,T.next,y,_))return!0;T=T.next}while(T!==y);return!1}(g,c)&&(gp(g,c)&&gp(c,g)&&function(y,_){var T=y,R=!1,z=(y.x+_.x)/2,W=(y.y+_.y)/2;do T.y>W!=T.next.y>W&&T.next.y!==T.y&&z<(T.next.x-T.x)*(W-T.y)/(T.next.y-T.y)+T.x&&(R=!R),T=T.next;while(T!==y);return R}(g,c)&&(ti(g.prev,g,c.prev)||ti(g,c.prev,c))||Y0(g,c)&&ti(g.prev,g,g.next)>0&&ti(c.prev,c,c.next)>0)}function ti(g,c,y){return(c.y-g.y)*(y.x-c.x)-(c.x-g.x)*(y.y-c.y)}function Y0(g,c){return g.x===c.x&&g.y===c.y}function w3(g,c,y,_){var T=Z0(ti(g,c,y)),R=Z0(ti(g,c,_)),z=Z0(ti(y,_,g)),W=Z0(ti(y,_,c));return T!==R&&z!==W||!(T!==0||!K0(g,y,c))||!(R!==0||!K0(g,_,c))||!(z!==0||!K0(y,g,_))||!(W!==0||!K0(y,c,_))}function K0(g,c,y){return c.x<=Math.max(g.x,y.x)&&c.x>=Math.min(g.x,y.x)&&c.y<=Math.max(g.y,y.y)&&c.y>=Math.min(g.y,y.y)}function Z0(g){return g>0?1:g<0?-1:0}function gp(g,c){return ti(g.prev,g,g.next)<0?ti(g,c,g.next)>=0&&ti(g,g.prev,c)>=0:ti(g,c,g.prev)<0||ti(g,g.next,c)<0}function M3(g,c){var y=new xv(g.i,g.x,g.y),_=new xv(c.i,c.x,c.y),T=g.next,R=c.prev;return g.next=c,c.prev=g,y.next=T,T.prev=y,_.next=y,y.prev=_,R.next=_,_.prev=R,_}function A3(g,c,y,_){var T=new xv(g,c,y);return _?(T.next=_.next,T.prev=_,_.next.prev=T,_.next=T):(T.prev=T,T.next=T),T}function yp(g){g.next.prev=g.prev,g.prev.next=g.next,g.prevZ&&(g.prevZ.nextZ=g.nextZ),g.nextZ&&(g.nextZ.prevZ=g.prevZ)}function xv(g,c,y){this.i=g,this.x=c,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _v(g,c,y,_){for(var T=0,R=c,z=y-_;R<y;R+=_)T+=(g[z]-g[R])*(g[R+1]+g[z+1]),z=R;return T}function az(g,c,y,_,T){S3(g,c,y||0,_||g.length-1,T||lz)}function S3(g,c,y,_,T){for(;_>y;){if(_-y>600){var R=_-y+1,z=c-y+1,W=Math.log(R),et=.5*Math.exp(2*W/3),st=.5*Math.sqrt(W*et*(R-et)/R)*(z-R/2<0?-1:1);S3(g,c,Math.max(y,Math.floor(c-z*et/R+st)),Math.min(_,Math.floor(c+(R-z)*et/R+st)),T)}var ht=g[c],pt=y,bt=_;for(bp(g,y,c),T(g[_],ht)>0&&bp(g,y,_);pt<bt;){for(bp(g,pt,bt),pt++,bt--;T(g[pt],ht)<0;)pt++;for(;T(g[bt],ht)>0;)bt--}T(g[y],ht)===0?bp(g,y,bt):bp(g,++bt,_),bt<=c&&(y=bt+1),c<=bt&&(_=bt-1)}}function bp(g,c,y){var _=g[c];g[c]=g[y],g[y]=_}function lz(g,c){return g<c?-1:g>c?1:0}function wv(g,c){const y=g.length;if(y<=1)return[g];const _=[];let T,R;for(let z=0;z<y;z++){const W=vt(g[z]);W!==0&&(g[z].area=Math.abs(W),R===void 0&&(R=W<0),R===W<0?(T&&_.push(T),T=[g[z]]):T.push(g[z]))}if(T&&_.push(T),c>1)for(let z=0;z<_.length;z++)_[z].length<=c||(az(_[z],c,1,_[z].length-1,cz),_[z]=_[z].slice(0,c));return _}function cz(g,c){return c.area-g.area}function Mv(g,c,y){const _=y.patternDependencies;let T=!1;for(const R of c){const z=R.paint.get(`${g}-pattern`);z.isConstant()||(T=!0);const W=z.constantOr(null);W&&(T=!0,_[W.to]=!0,_[W.from]=!0)}return T}function Av(g,c,y,_,T){const R=T.patternDependencies;for(const z of c){const W=z.paint.get(`${g}-pattern`).value;if(W.kind!=="constant"){let et=W.evaluate({zoom:_-1},y,{},T.availableImages),st=W.evaluate({zoom:_},y,{},T.availableImages),ht=W.evaluate({zoom:_+1},y,{},T.availableImages);et=et&&et.name?et.name:et,st=st&&st.name?st.name:st,ht=ht&&ht.name?ht.name:ht,R[et]=!0,R[st]=!0,R[ht]=!0,y.patterns[z.id]={min:et,mid:st,max:ht}}}return y}X0.deviation=function(g,c,y,_){var T=c&&c.length,R=Math.abs(_v(g,0,T?c[0]*y:g.length,y));if(T)for(var z=0,W=c.length;z<W;z++)R-=Math.abs(_v(g,c[z]*y,z<W-1?c[z+1]*y:g.length,y));var et=0;for(z=0;z<_.length;z+=3){var st=_[z]*y,ht=_[z+1]*y,pt=_[z+2]*y;et+=Math.abs((g[st]-g[pt])*(g[ht+1]-g[st+1])-(g[st]-g[ht])*(g[pt+1]-g[st+1]))}return R===0&&et===0?0:Math.abs((et-R)/R)},X0.flatten=function(g){for(var c=g[0][0].length,y={vertices:[],holes:[],dimensions:c},_=0,T=0;T<g.length;T++){for(var R=0;R<g[T].length;R++)for(var z=0;z<c;z++)y.vertices.push(g[T][R][z]);T>0&&y.holes.push(_+=g[T-1].length)}return y},q0.default=JO;class J0{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(y=>y.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ie,this.indexArray=new _n,this.indexArray2=new Gn,this.programConfigurations=new Oc(c.layers,c.zoom),this.segments=new Kr,this.segments2=new Kr,this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.projection=c.projection}populate(c,y,_,T){this.hasPattern=Mv("fill",this.layers,y);const R=this.layers[0].layout.get("fill-sort-key"),z=[];for(const{feature:W,id:et,index:st,sourceLayerIndex:ht}of c){const pt=this.layers[0]._featureFilter.needGeometry,bt=zc(W,pt);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),bt,_))continue;const Et=R?R.evaluate(bt,{},_,y.availableImages):void 0,kt={id:et,properties:W.properties,type:W.type,sourceLayerIndex:ht,index:st,geometry:pt?bt.geometry:Ia(W,_,T),patterns:{},sortKey:Et};z.push(kt)}R&&z.sort((W,et)=>W.sortKey-et.sortKey);for(const W of z){const{geometry:et,index:st,sourceLayerIndex:ht}=W;if(this.hasPattern){const pt=Av("fill",this.layers,W,this.zoom,y);this.patternFeatures.push(pt)}else this.addFeature(W,et,st,_,{},y.availableImages);y.featureIndex.insert(c[st].feature,et,st,ht,this.index)}}update(c,y,_,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,y,this.stateDependentLayers,_,T)}addFeatures(c,y,_,T,R){for(const z of this.patternFeatures)this.addFeature(z,z.geometry,z.index,y,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,ZO),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,y,_,T,R,z=[]){for(const W of wv(y,500)){let et=0;for(const kt of W)et+=kt.length;const st=this.segments.prepareSegment(et,this.layoutVertexArray,this.indexArray),ht=st.vertexLength,pt=[],bt=[];for(const kt of W){if(kt.length===0)continue;kt!==W[0]&&bt.push(pt.length/2);const Ft=this.segments2.prepareSegment(kt.length,this.layoutVertexArray,this.indexArray2),Vt=Ft.vertexLength;this.layoutVertexArray.emplaceBack(kt[0].x,kt[0].y),this.indexArray2.emplaceBack(Vt+kt.length-1,Vt),pt.push(kt[0].x),pt.push(kt[0].y);for(let $t=1;$t<kt.length;$t++)this.layoutVertexArray.emplaceBack(kt[$t].x,kt[$t].y),this.indexArray2.emplaceBack(Vt+$t-1,Vt+$t),pt.push(kt[$t].x),pt.push(kt[$t].y);Ft.vertexLength+=kt.length,Ft.primitiveLength+=kt.length}const Et=q0(pt,bt);for(let kt=0;kt<Et.length;kt+=3)this.indexArray.emplaceBack(ht+Et[kt],ht+Et[kt+1],ht+Et[kt+2]);st.vertexLength+=et,st.primitiveLength+=Et.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,R,z,T)}}xn(J0,"FillBucket",{omit:["layers","patternFeatures"]});const uz=new Pt({"fill-sort-key":new ct(Yt.layout_fill["fill-sort-key"])});var hz={paint:new Pt({"fill-antialias":new ot(Yt.paint_fill["fill-antialias"]),"fill-opacity":new ct(Yt.paint_fill["fill-opacity"]),"fill-color":new ct(Yt.paint_fill["fill-color"]),"fill-outline-color":new ct(Yt.paint_fill["fill-outline-color"]),"fill-translate":new ot(Yt.paint_fill["fill-translate"]),"fill-translate-anchor":new ot(Yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new yt(Yt.paint_fill["fill-pattern"])}),layout:uz};const dz=ae([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fz=ae([{name:"a_centroid_pos",components:2,type:"Uint16"}]),pz=ae([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:mz}=dz;var E3=jh;function jh(g,c,y,_,T){this.properties={},this.extent=y,this.type=0,this._pbf=g,this._geometry=-1,this._keys=_,this._values=T,g.readFields(gz,this,c)}function gz(g,c,y){g==1?c.id=y.readVarint():g==2?function(_,T){for(var R=_.readVarint()+_.pos;_.pos<R;){var z=T._keys[_.readVarint()],W=T._values[_.readVarint()];T.properties[z]=W}}(y,c):g==3?c.type=y.readVarint():g==4&&(c._geometry=y.pos)}function yz(g){for(var c,y,_=0,T=0,R=g.length,z=R-1;T<R;z=T++)_+=((y=g[z]).x-(c=g[T]).x)*(c.y+y.y);return _}jh.types=["Unknown","Point","LineString","Polygon"],jh.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var c,y=g.readVarint()+g.pos,_=1,T=0,R=0,z=0,W=[];g.pos<y;){if(T<=0){var et=g.readVarint();_=7&et,T=et>>3}if(T--,_===1||_===2)R+=g.readSVarint(),z+=g.readSVarint(),_===1&&(c&&W.push(c),c=[]),c.push(new f(R,z));else{if(_!==7)throw new Error("unknown command "+_);c&&c.push(c[0].clone())}}return c&&W.push(c),W},jh.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var c=g.readVarint()+g.pos,y=1,_=0,T=0,R=0,z=1/0,W=-1/0,et=1/0,st=-1/0;g.pos<c;){if(_<=0){var ht=g.readVarint();y=7&ht,_=ht>>3}if(_--,y===1||y===2)(T+=g.readSVarint())<z&&(z=T),T>W&&(W=T),(R+=g.readSVarint())<et&&(et=R),R>st&&(st=R);else if(y!==7)throw new Error("unknown command "+y)}return[z,et,W,st]},jh.prototype.toGeoJSON=function(g,c,y){var _,T,R=this.extent*Math.pow(2,y),z=this.extent*g,W=this.extent*c,et=this.loadGeometry(),st=jh.types[this.type];function ht(Et){for(var kt=0;kt<Et.length;kt++){var Ft=Et[kt];Et[kt]=[360*(Ft.x+z)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ft.y+W)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var pt=[];for(_=0;_<et.length;_++)pt[_]=et[_][0];ht(et=pt);break;case 2:for(_=0;_<et.length;_++)ht(et[_]);break;case 3:for(et=function(Et){var kt=Et.length;if(kt<=1)return[Et];for(var Ft,Vt,$t=[],ue=0;ue<kt;ue++){var ge=yz(Et[ue]);ge!==0&&(Vt===void 0&&(Vt=ge<0),Vt===ge<0?(Ft&&$t.push(Ft),Ft=[Et[ue]]):Ft.push(Et[ue]))}return Ft&&$t.push(Ft),$t}(et),_=0;_<et.length;_++)for(T=0;T<et[_].length;T++)ht(et[_][T])}et.length===1?et=et[0]:st="Multi"+st;var bt={type:"Feature",geometry:{type:st,coordinates:et},properties:this.properties};return"id"in this&&(bt.id=this.id),bt};var T3=C3;function C3(g,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=g,this._keys=[],this._values=[],this._features=[],g.readFields(bz,this,c),this.length=this._features.length}function bz(g,c,y){g===15?c.version=y.readVarint():g===1?c.name=y.readString():g===5?c.extent=y.readVarint():g===2?c._features.push(y.pos):g===3?c._keys.push(y.readString()):g===4&&c._values.push(function(_){for(var T=null,R=_.readVarint()+_.pos;_.pos<R;){var z=_.readVarint()>>3;T=z===1?_.readString():z===2?_.readFloat():z===3?_.readDouble():z===4?_.readVarint64():z===5?_.readVarint():z===6?_.readSVarint():z===7?_.readBoolean():null}return T}(y))}function vz(g,c,y){if(g===3){var _=new T3(y,y.readVarint()+y.pos);_.length&&(c[_.name]=_)}}C3.prototype.feature=function(g){if(g<0||g>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[g];var c=this._pbf.readVarint()+this._pbf.pos;return new E3(this._pbf,c,this.extent,this._keys,this._values)};var jc={VectorTile:function(g,c){this.layers=g.readFields(vz,{},c)},VectorTileFeature:E3,VectorTileLayer:T3};function $0(g,c,y,_){const T=[],R=_===0?(z,W,et,st,ht,pt)=>{z.push(new f(pt,et+(pt-W)/(st-W)*(ht-et)))}:(z,W,et,st,ht,pt)=>{z.push(new f(W+(pt-et)/(ht-et)*(st-W),pt))};for(const z of g){const W=[];for(const et of z){if(et.length<=2)continue;const st=[];for(let bt=0;bt<et.length-1;bt++){const Et=et[bt].x,kt=et[bt].y,Ft=et[bt+1].x,Vt=et[bt+1].y,$t=_===0?Et:kt,ue=_===0?Ft:Vt;$t<c?ue>c&&R(st,Et,kt,Ft,Vt,c):$t>y?ue<y&&R(st,Et,kt,Ft,Vt,y):st.push(et[bt]),ue<c&&$t>=c&&R(st,Et,kt,Ft,Vt,c),ue>y&&$t<=y&&R(st,Et,kt,Ft,Vt,y)}let ht=et[et.length-1];const pt=_===0?ht.x:ht.y;pt>=c&&pt<=y&&st.push(ht),st.length&&(ht=st[st.length-1],st[0].x===ht.x&&st[0].y===ht.y||st.push(st[0]),W.push(st))}W.length&&T.push(W)}return T}const xz=jc.VectorTileFeature.types,_z=Math.pow(2,13);function vp(g,c,y,_,T,R,z,W){g.emplaceBack((c<<1)+z,(y<<1)+R,(Math.floor(_*_z)<<1)+T,Math.round(W))}function xp(g,c,y){g.emplaceBack(c.x,c.y,c.z,y[0]*16384,y[1]*16384,y[2]*16384)}class P3{constructor(){this.acc=new f(0,0),this.polyCount=[]}startRing(c){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new f(c.x,c.y),this.max=new f(c.x,c.y))}append(c,y){this.currentPolyCount.edges++,this.acc._add(c);const _=this.min,T=this.max;c.x<_.x?_.x=c.x:c.x>T.x&&(T.x=c.x),c.y<_.y?_.y=c.y:c.y>T.y&&(T.y=c.y),((c.x===0||c.x===tr)&&c.x===y.x)!=((c.y===0||c.y===tr)&&c.y===y.y)&&this.processBorderOverlap(c,y),y.x<0!=c.x<0&&this.addBorderIntersection(0,Nn(y.y,c.y,(0-y.x)/(c.x-y.x))),y.x>tr!=c.x>tr&&this.addBorderIntersection(1,Nn(y.y,c.y,(tr-y.x)/(c.x-y.x))),y.y<0!=c.y<0&&this.addBorderIntersection(2,Nn(y.x,c.x,(0-y.y)/(c.y-y.y))),y.y>tr!=c.y>tr&&this.addBorderIntersection(3,Nn(y.x,c.x,(tr-y.y)/(c.y-y.y)))}addBorderIntersection(c,y){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const _=this.borders[c];y<_[0]&&(_[0]=y),y>_[1]&&(_[1]=y)}processBorderOverlap(c,y){if(c.x===y.x){if(c.y===y.y)return;const _=c.x===0?0:1;this.addBorderIntersection(_,y.y),this.addBorderIntersection(_,c.y)}else{const _=c.y===0?2:3;this.addBorderIntersection(_,y.x),this.addBorderIntersection(_,c.x)}}centroid(){const c=this.polyCount.reduce((y,_)=>y+_.edges,0);return c!==0?this.acc.div(c)._round():new f(0,0)}span(){return new f(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((c,y)=>c+ +(y[0]!==Number.MAX_VALUE),0)}}class _p{constructor(c){this.zoom=c.zoom,this.canonical=c.canonical,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(y=>y.id),this.index=c.index,this.hasPattern=!1,this.projection=c.projection,this.layoutVertexArray=new ce,this.centroidVertexArray=new Nc,this.indexArray=new _n,this.programConfigurations=new Oc(c.layers,c.zoom),this.segments=new Kr,this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.enableTerrain=c.enableTerrain}populate(c,y,_,T){this.features=[],this.hasPattern=Mv("fill-extrusion",this.layers,y),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(R){const z=Math.exp(Math.PI*(1-R.y/(1<<R.z)*2));return 80150034*z/(z*z+1)/tr/(1<<R.z)}(_);for(const{feature:R,id:z,index:W,sourceLayerIndex:et}of c){const st=this.layers[0]._featureFilter.needGeometry,ht=zc(R,st);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),ht,_))continue;const pt={id:z,sourceLayerIndex:et,index:W,geometry:st?ht.geometry:Ia(R,_,T),properties:R.properties,type:R.type,patterns:{}},bt=this.layoutVertexArray.length;this.hasPattern?this.features.push(Av("fill-extrusion",this.layers,pt,this.zoom,y)):this.addFeature(pt,pt.geometry,W,_,{},y.availableImages,T),y.featureIndex.insert(R,pt.geometry,W,et,this.index,bt)}this.sortBorders()}addFeatures(c,y,_,T,R){for(const z of this.features){const{geometry:W}=z;this.addFeature(z,W,z.index,y,_,T,R)}this.sortBorders()}update(c,y,_,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,y,this.stateDependentLayers,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,mz),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=c.createVertexBuffer(this.layoutVertexExtArray,pz.members,!0))),this.programConfigurations.upload(c),this.uploaded=!0}uploadCentroid(c){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,fz.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,y,_,T,R,z,W){const et=[new f(0,0),new f(tr,tr)],st=W.projection,ht=st.name==="globe",pt=this.enableTerrain&&!ht?new P3:null;ht&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new lo);const bt=wv(y,500);for(let Ft=bt.length-1;Ft>=0;Ft--){const Vt=bt[Ft];(Vt.length===0||(Et=Vt[0]).every($t=>$t.x<=0)||Et.every($t=>$t.x>=tr)||Et.every($t=>$t.y<=0)||Et.every($t=>$t.y>=tr))&&bt.splice(Ft,1)}var Et;let kt;if(ht){const Vt=1<<T.z,$t=ns(T.x/Vt),ue=ns((T.x+1)/Vt),ge=Ri(T.y/Vt),xe=Ri((T.y+1)/Vt);kt=function(_e,we,Be,Oe,Je=0,tn){const De=[];if(!_e.length||!Be||!Oe)return De;const qe=(Zn,or)=>{for(const Cn of Zn)De.push({polygon:Cn,bounds:or})},nn=Math.ceil(Math.log2(Be)),fn=Math.ceil(Math.log2(Oe)),sn=nn-fn,dn=[];for(let Zn=0;Zn<Math.abs(sn);Zn++)dn.push(sn>0?0:1);for(let Zn=0;Zn<Math.min(nn,fn);Zn++)dn.push(0),dn.push(1);let Kn=_e;if(Kn=$0(Kn,we[0].y-Je,we[1].y+Je,1),Kn=$0(Kn,we[0].x-Je,we[1].x+Je,0),!Kn.length)return De;const lr=[];for(dn.length?lr.push({polygons:Kn,bounds:we,depth:0}):qe(Kn,we);lr.length;){const Zn=lr.pop(),or=Zn.depth,Cn=dn[or],bn=Zn.bounds[0],hr=Zn.bounds[1],vr=Cn===0?bn.x:bn.y,oi=Cn===0?hr.x:hr.y,Rr=tn?tn(Cn,vr,oi):.5*(vr+oi),si=$0(Zn.polygons,vr-Je,Rr+Je,Cn),xr=$0(Zn.polygons,Rr-Je,oi+Je,Cn);if(si.length){const fr=[bn,new f(Cn===0?Rr:hr.x,Cn===1?Rr:hr.y)];dn.length>or+1?lr.push({polygons:si,bounds:fr,depth:or+1}):qe(si,fr)}if(xr.length){const fr=[new f(Cn===0?Rr:bn.x,Cn===1?Rr:bn.y),hr];dn.length>or+1?lr.push({polygons:xr,bounds:fr,depth:or+1}):qe(xr,fr)}}return De}(bt,et,Math.ceil((ue-$t)/11.25),Math.ceil((ge-xe)/11.25),1,(_e,we,Be)=>{if(_e===0)return .5*(we+Be);{const Oe=Ri((T.y+we/tr)/Vt);return(Bh(.5*(Ri((T.y+Be/tr)/Vt)+Oe))*Vt-T.y)*tr}})}else{kt=[];for(const Ft of bt)kt.push({polygon:Ft,bounds:et})}for(const Ft of kt){const Vt=Ft.polygon;let $t=0,ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let Be=0;Be<Vt.length;Be++){const Oe=Vt[Be];if(Oe.length===0)continue;$t+=Oe.length;let Je=0;pt&&pt.startRing(Oe[0]);for(let tn=0;tn<Oe.length;tn++){const De=Oe[tn];if(tn>=1){const qe=Oe[tn-1];if(!wz(De,qe,Ft.bounds)){pt&&pt.append(De,qe),ue.vertexLength+4>Kr.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const nn=De.sub(qe)._perp(),fn=nn.x/(Math.abs(nn.x)+Math.abs(nn.y)),sn=nn.y>0?1:0,dn=qe.dist(De);Je+dn>32768&&(Je=0),vp(this.layoutVertexArray,De.x,De.y,fn,sn,0,0,Je),vp(this.layoutVertexArray,De.x,De.y,fn,sn,0,1,Je),Je+=dn,vp(this.layoutVertexArray,qe.x,qe.y,fn,sn,0,0,Je),vp(this.layoutVertexArray,qe.x,qe.y,fn,sn,0,1,Je);const Kn=ue.vertexLength;if(this.indexArray.emplaceBack(Kn,Kn+2,Kn+1),this.indexArray.emplaceBack(Kn+1,Kn+2,Kn+3),ue.vertexLength+=4,ue.primitiveLength+=2,ht){const lr=this.layoutVertexExtArray,Zn=st.projectTilePoint(De.x,De.y,T),or=st.projectTilePoint(qe.x,qe.y,T),Cn=st.upVector(T,De.x,De.y),bn=st.upVector(T,qe.x,qe.y);xp(lr,Zn,Cn),xp(lr,Zn,Cn),xp(lr,or,bn),xp(lr,or,bn)}}}}}if(ue.vertexLength+$t>Kr.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment($t,this.layoutVertexArray,this.indexArray)),xz[c.type]!=="Polygon")continue;const ge=[],xe=[],_e=ue.vertexLength;for(let Be=0;Be<Vt.length;Be++){const Oe=Vt[Be];if(Oe.length!==0){Oe!==Vt[0]&&xe.push(ge.length/2);for(let Je=0;Je<Oe.length;Je++){const tn=Oe[Je];vp(this.layoutVertexArray,tn.x,tn.y,0,0,1,1,0),ge.push(tn.x),ge.push(tn.y),pt&&pt.currentPolyCount.top++,ht&&xp(this.layoutVertexExtArray,st.projectTilePoint(tn.x,tn.y,T),st.upVector(T,tn.x,tn.y))}}}const we=q0(ge,xe);for(let Be=0;Be<we.length;Be+=3)this.indexArray.emplaceBack(_e+we[Be],_e+we[Be+2],_e+we[Be+1]);ue.primitiveLength+=we.length/3,ue.vertexLength+=$t}if(pt&&pt.polyCount.length>0){if(pt.borders){pt.vertexArrayOffset=this.centroidVertexArray.length;const Ft=pt.borders,Vt=this.featuresOnBorder.push(pt)-1;for(let $t=0;$t<4;$t++)Ft[$t][0]!==Number.MAX_VALUE&&this.borders[$t].push(Vt)}this.encodeCentroid(pt.borders?void 0:pt.centroid(),pt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,R,z,T)}sortBorders(){for(let c=0;c<4;c++)this.borders[c].sort((y,_)=>this.featuresOnBorder[y].borders[c][0]-this.featuresOnBorder[_].borders[c][0])}encodeCentroid(c,y,_=!0){let T,R;if(c)if(c.y!==0){const W=y.span()._mult(this.tileToMeter);T=(Math.max(c.x,1)<<3)+Math.min(7,Math.round(W.x/10)),R=(Math.max(c.y,1)<<3)+Math.min(7,Math.round(W.y/10))}else T=Math.ceil(7*(c.x+450)),R=0;else T=0,R=+_;let z=_?this.centroidVertexArray.length:y.vertexArrayOffset;for(const W of y.polyCount){_&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*W.edges+W.top);for(let et=0;et<2*W.edges;et++)this.centroidVertexArray.emplace(z++,0,R),this.centroidVertexArray.emplace(z++,T,R);for(let et=0;et<W.top;et++)this.centroidVertexArray.emplace(z++,T,R)}}}function wz(g,c,y){return g.x===c.x&&(g.x<y[0].x||g.x>y[1].x)||g.y===c.y&&(g.y<y[0].y||g.y>y[1].y)}xn(_p,"FillExtrusionBucket",{omit:["layers","features"]}),xn(P3,"PartMetadata");var Mz={paint:new Pt({"fill-extrusion-opacity":new ot(Yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(Yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ot(Yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ot(Yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yt(Yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(Yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(Yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ot(Yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function wp(g,c){return g.x*c.x+g.y*c.y}function D3(g,c){if(g.length===1){let y=0;const _=c[y++];let T;for(;!T||_.equals(T);)if(T=c[y++],!T)return 1/0;for(;y<c.length;y++){const R=c[y],z=g[0],W=T.sub(_),et=R.sub(_),st=z.sub(_),ht=wp(W,W),pt=wp(W,et),bt=wp(et,et),Et=wp(st,W),kt=wp(st,et),Ft=ht*bt-pt*pt,Vt=(bt*Et-pt*kt)/Ft,$t=(ht*kt-pt*Et)/Ft,ue=_.z*(1-Vt-$t)+T.z*Vt+R.z*$t;if(isFinite(ue))return ue}return 1/0}{let y=1/0;for(const _ of c)y=Math.min(y,_.z);return y}}function R3(g){const c=new f(g[0],g[1]);return c.z=g[2],c}function Az(g,c,y,_,T,R,z,W){const et=z*T.getElevationAt(g,c,!0,!0),st=R[0]!==0,ht=st?R[1]===0?z*(R[0]/7-450):z*function(pt,bt,Et){const kt=Math.floor(bt[0]/8),Ft=Math.floor(bt[1]/8),Vt=10*(bt[0]-8*kt),$t=10*(bt[1]-8*Ft),ue=pt.getElevationAt(kt,Ft,!0,!0),ge=pt.getMeterToDEM(Et),xe=Math.floor(.5*(Vt*ge-1)),_e=Math.floor(.5*($t*ge-1)),we=pt.tileCoordToPixel(kt,Ft),Be=2*xe+1,Oe=2*_e+1,Je=function(sn,dn,Kn,lr,Zn){return[sn.getElevationAtPixel(dn,Kn,!0),sn.getElevationAtPixel(dn+Zn,Kn,!0),sn.getElevationAtPixel(dn,Kn+Zn,!0),sn.getElevationAtPixel(dn+lr,Kn+Zn,!0)]}(pt,we.x-xe,we.y-_e,Be,Oe),tn=Math.abs(Je[0]-Je[1]),De=Math.abs(Je[2]-Je[3]),qe=Math.abs(Je[0]-Je[2])+Math.abs(Je[1]-Je[3]),nn=Math.min(.25,.5*ge*(tn+De)/Be),fn=Math.min(.25,.5*ge*qe/Oe);return ue+Math.max(nn*Vt,fn*$t)}(T,R,W):et;return{base:et+(y===0)?-1:y,top:st?Math.max(ht+_,et+y+2):et+_}}const Sz=ae([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Ez}=Sz,Tz=ae([{name:"a_packed",components:3,type:"Float32"}]),{members:Cz}=Tz,Pz=jc.VectorTileFeature.types,Dz=Math.cos(Math.PI/180*37.5);class Q0{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(y=>y.id),this.index=c.index,this.projection=c.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(y=>{this.gradients[y.id]={}}),this.layoutVertexArray=new ne,this.layoutVertexArray2=new cn,this.indexArray=new _n,this.programConfigurations=new Oc(c.layers,c.zoom),this.segments=new Kr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id)}populate(c,y,_,T){this.hasPattern=Mv("line",this.layers,y);const R=this.layers[0].layout.get("line-sort-key"),z=[];for(const{feature:ht,id:pt,index:bt,sourceLayerIndex:Et}of c){const kt=this.layers[0]._featureFilter.needGeometry,Ft=zc(ht,kt);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),Ft,_))continue;const Vt=R?R.evaluate(Ft,{},_):void 0,$t={id:pt,properties:ht.properties,type:ht.type,sourceLayerIndex:Et,index:bt,geometry:kt?Ft.geometry:Ia(ht,_,T),patterns:{},sortKey:Vt};z.push($t)}R&&z.sort((ht,pt)=>ht.sortKey-pt.sortKey);const{lineAtlas:W,featureIndex:et}=y,st=this.addConstantDashes(W);for(const ht of z){const{geometry:pt,index:bt,sourceLayerIndex:Et}=ht;if(st&&this.addFeatureDashes(ht,W),this.hasPattern){const kt=Av("line",this.layers,ht,this.zoom,y);this.patternFeatures.push(kt)}else this.addFeature(ht,pt,bt,_,W.positions,y.availableImages);et.insert(c[bt].feature,pt,bt,Et,this.index)}}addConstantDashes(c){let y=!1;for(const _ of this.layers){const T=_.paint.get("line-dasharray").value,R=_.layout.get("line-cap").value;if(T.kind!=="constant"||R.kind!=="constant")y=!0;else{const z=R.value,W=T.value;if(!W)continue;c.addDash(W.from,z),c.addDash(W.to,z),W.other&&c.addDash(W.other,z)}}return y}addFeatureDashes(c,y){const _=this.zoom;for(const T of this.layers){const R=T.paint.get("line-dasharray").value,z=T.layout.get("line-cap").value;if(R.kind==="constant"&&z.kind==="constant")continue;let W,et,st,ht,pt,bt;if(R.kind==="constant"){const Vt=R.value;if(!Vt)continue;W=Vt.other||Vt.to,et=Vt.to,st=Vt.from}else W=R.evaluate({zoom:_-1},c),et=R.evaluate({zoom:_},c),st=R.evaluate({zoom:_+1},c);z.kind==="constant"?ht=pt=bt=z.value:(ht=z.evaluate({zoom:_-1},c),pt=z.evaluate({zoom:_},c),bt=z.evaluate({zoom:_+1},c)),y.addDash(W,ht),y.addDash(et,pt),y.addDash(st,bt);const Et=y.getKey(W,ht),kt=y.getKey(et,pt),Ft=y.getKey(st,bt);c.patterns[T.id]={min:Et,mid:kt,max:Ft}}}update(c,y,_,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,y,this.stateDependentLayers,_,T)}addFeatures(c,y,_,T,R){for(const z of this.patternFeatures)this.addFeature(z,z.geometry,z.index,y,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,Cz)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Ez),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,y,_,T,R,z){const W=this.layers[0].layout,et=W.get("line-join").evaluate(c,{}),st=W.get("line-cap").evaluate(c,{}),ht=W.get("line-miter-limit"),pt=W.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const bt of y)this.addLine(bt,c,et,st,ht,pt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,R,z,T)}addLine(c,y,_,T,R,z){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let $t=0;$t<c.length-1;$t++)this.totalDistance+=c[$t].dist(c[$t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const W=Pz[y.type]==="Polygon";let et=c.length;for(;et>=2&&c[et-1].equals(c[et-2]);)et--;let st=0;for(;st<et-1&&c[st].equals(c[st+1]);)st++;if(et<(W?3:2))return;_==="bevel"&&(R=1.05);const ht=this.overscaling<=16?122880/(512*this.overscaling):0,pt=this.segments.prepareSegment(10*et,this.layoutVertexArray,this.indexArray);let bt,Et,kt,Ft,Vt;this.e1=this.e2=-1,W&&(bt=c[et-2],Vt=c[st].sub(bt)._unit()._perp());for(let $t=st;$t<et;$t++){if(kt=$t===et-1?W?c[st+1]:void 0:c[$t+1],kt&&c[$t].equals(kt))continue;Vt&&(Ft=Vt),bt&&(Et=bt),bt=c[$t],Vt=kt?kt.sub(bt)._unit()._perp():Ft,Ft=Ft||Vt;let ue=Ft.add(Vt);ue.x===0&&ue.y===0||ue._unit();const ge=Ft.x*Vt.x+Ft.y*Vt.y,xe=ue.x*Vt.x+ue.y*Vt.y,_e=xe!==0?1/xe:1/0,we=2*Math.sqrt(2-2*xe),Be=xe<Dz&&Et&&kt,Oe=Ft.x*Vt.y-Ft.y*Vt.x>0;if(Be&&$t>st){const De=bt.dist(Et);if(De>2*ht){const qe=bt.sub(bt.sub(Et)._mult(ht/De)._round());this.updateDistance(Et,qe),this.addCurrentVertex(qe,Ft,0,0,pt),Et=qe}}const Je=Et&&kt;let tn=Je?_:W?"butt":T;if(Je&&tn==="round"&&(_e<z?tn="miter":_e<=2&&(tn="fakeround")),tn==="miter"&&_e>R&&(tn="bevel"),tn==="bevel"&&(_e>2&&(tn="flipbevel"),_e<R&&(tn="miter")),Et&&this.updateDistance(Et,bt),tn==="miter")ue._mult(_e),this.addCurrentVertex(bt,ue,0,0,pt);else if(tn==="flipbevel"){if(_e>100)ue=Vt.mult(-1);else{const De=_e*Ft.add(Vt).mag()/Ft.sub(Vt).mag();ue._perp()._mult(De*(Oe?-1:1))}this.addCurrentVertex(bt,ue,0,0,pt),this.addCurrentVertex(bt,ue.mult(-1),0,0,pt)}else if(tn==="bevel"||tn==="fakeround"){const De=-Math.sqrt(_e*_e-1),qe=Oe?De:0,nn=Oe?0:De;if(Et&&this.addCurrentVertex(bt,Ft,qe,nn,pt),tn==="fakeround"){const fn=Math.round(180*we/Math.PI/20);for(let sn=1;sn<fn;sn++){let dn=sn/fn;if(dn!==.5){const lr=dn-.5;dn+=dn*lr*(dn-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*lr*lr+(.848013+ge*(.215638*ge-1.06021)))}const Kn=Vt.sub(Ft)._mult(dn)._add(Ft)._unit()._mult(Oe?-1:1);this.addHalfVertex(bt,Kn.x,Kn.y,!1,Oe,0,pt)}}kt&&this.addCurrentVertex(bt,Vt,-qe,-nn,pt)}else if(tn==="butt")this.addCurrentVertex(bt,ue,0,0,pt);else if(tn==="square"){const De=Et?1:-1;Et||this.addCurrentVertex(bt,ue,De,De,pt),this.addCurrentVertex(bt,ue,0,0,pt),Et&&this.addCurrentVertex(bt,ue,De,De,pt)}else tn==="round"&&(Et&&(this.addCurrentVertex(bt,Ft,0,0,pt),this.addCurrentVertex(bt,Ft,1,1,pt,!0)),kt&&(this.addCurrentVertex(bt,Vt,-1,-1,pt,!0),this.addCurrentVertex(bt,Vt,0,0,pt)));if(Be&&$t<et-1){const De=bt.dist(kt);if(De>2*ht){const qe=bt.add(kt.sub(bt)._mult(ht/De)._round());this.updateDistance(bt,qe),this.addCurrentVertex(qe,Vt,0,0,pt),bt=qe}}}}addCurrentVertex(c,y,_,T,R,z=!1){const W=y.y*T-y.x,et=-y.y-y.x*T;this.addHalfVertex(c,y.x+y.y*_,y.y-y.x*_,z,!1,_,R),this.addHalfVertex(c,W,et,z,!0,-T,R)}addHalfVertex({x:c,y},_,T,R,z,W,et){this.layoutVertexArray.emplaceBack((c<<1)+(R?1:0),(y<<1)+(z?1:0),Math.round(63*_)+128,Math.round(63*T)+128,1+(W===0?0:W<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const st=et.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,st),et.primitiveLength++),z?this.e2=st:this.e1=st}updateScaledDistance(){if(this.lineClips){const c=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=c*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(c,y){this.distance+=c.dist(y),this.updateScaledDistance()}}xn(Q0,"LineBucket",{omit:["layers","patternFeatures"]});const Rz=new Pt({"line-cap":new ct(Yt.layout_line["line-cap"]),"line-join":new ct(Yt.layout_line["line-join"]),"line-miter-limit":new ot(Yt.layout_line["line-miter-limit"]),"line-round-limit":new ot(Yt.layout_line["line-round-limit"]),"line-sort-key":new ct(Yt.layout_line["line-sort-key"])});var k3={paint:new Pt({"line-opacity":new ct(Yt.paint_line["line-opacity"]),"line-color":new ct(Yt.paint_line["line-color"]),"line-translate":new ot(Yt.paint_line["line-translate"]),"line-translate-anchor":new ot(Yt.paint_line["line-translate-anchor"]),"line-width":new ct(Yt.paint_line["line-width"]),"line-gap-width":new ct(Yt.paint_line["line-gap-width"]),"line-offset":new ct(Yt.paint_line["line-offset"]),"line-blur":new ct(Yt.paint_line["line-blur"]),"line-dasharray":new yt(Yt.paint_line["line-dasharray"]),"line-pattern":new yt(Yt.paint_line["line-pattern"]),"line-gradient":new Mt(Yt.paint_line["line-gradient"])}),layout:Rz};const I3=new class extends ct{possiblyEvaluate(g,c){return c=new Dr(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(g,c)}evaluate(g,c,y,_){return c=rt({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(g,c,y,_)}}(k3.paint.properties["line-width"].specification);function L3(g,c){return c>0?c+2*g:g}I3.useIntegerZoom=!0;const kz=ae([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),Iz=ae([{name:"a_projected_pos",components:3,type:"Float32"}],4);ae([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Lz=ae([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Bz=ae([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ae([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const B3=ae([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Fz=ae([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ae([{name:"triangle",components:3,type:"Uint16"}]),ae([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ae([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ae([{type:"Float32",name:"offsetX"}]),ae([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ki=24;const ta=128;function Sv(g,c){const{expression:y}=c;if(y.kind==="constant")return{kind:"constant",layoutSize:y.evaluate(new Dr(g+1))};if(y.kind==="source")return{kind:"source"};{const{zoomStops:_,interpolationType:T}=y;let R=0;for(;R<_.length&&_[R]<=g;)R++;R=Math.max(0,R-1);let z=R;for(;z<_.length&&_[z]<g+1;)z++;z=Math.min(_.length-1,z);const W=_[R],et=_[z];return y.kind==="composite"?{kind:"composite",minZoom:W,maxZoom:et,interpolationType:T}:{kind:"camera",minZoom:W,maxZoom:et,minSize:y.evaluate(new Dr(W)),maxSize:y.evaluate(new Dr(et)),interpolationType:T}}}function t1(g,{uSize:c,uSizeT:y},{lowerSize:_,upperSize:T}){return g.kind==="source"?_/ta:g.kind==="composite"?Nn(_/ta,T/ta,y):c}function Gh(g,c){let y=0,_=0;if(g.kind==="constant")_=g.layoutSize;else if(g.kind!=="source"){const{interpolationType:T,minZoom:R,maxZoom:z}=g,W=T?V(oo.interpolationFactor(T,c,R,z),0,1):0;g.kind==="camera"?_=Nn(g.minSize,g.maxSize,W):y=W}return{uSizeT:y,uSize:_}}var Nz=Object.freeze({__proto__:null,getSizeData:Sv,evaluateSizeForFeature:t1,evaluateSizeForZoom:Gh,SIZE_PACK_FACTOR:ta});function Oz(g,c,y){return g.sections.forEach(_=>{_.text=function(T,R,z){const W=R.layout.get("text-transform").evaluate(z,{});return W==="uppercase"?T=T.toLocaleUpperCase():W==="lowercase"&&(T=T.toLocaleLowerCase()),So.applyArabicShaping&&(T=So.applyArabicShaping(T)),T}(_.text,c,y)}),g}const Mp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function zz(g){return g==="︶"||g==="﹈"||g==="︸"||g==="﹄"||g==="﹂"||g==="︾"||g==="︼"||g==="︺"||g==="︘"||g==="﹀"||g==="︐"||g==="︓"||g==="︔"||g==="｀"||g==="￣"||g==="︑"||g==="︒"}function Uz(g){return g==="︵"||g==="﹇"||g==="︷"||g==="﹃"||g==="﹁"||g==="︽"||g==="︻"||g==="︹"||g==="︗"||g==="︿"}var F3=function(g,c,y,_,T){var R,z,W=8*T-_-1,et=(1<<W)-1,st=et>>1,ht=-7,pt=y?T-1:0,bt=y?-1:1,Et=g[c+pt];for(pt+=bt,R=Et&(1<<-ht)-1,Et>>=-ht,ht+=W;ht>0;R=256*R+g[c+pt],pt+=bt,ht-=8);for(z=R&(1<<-ht)-1,R>>=-ht,ht+=_;ht>0;z=256*z+g[c+pt],pt+=bt,ht-=8);if(R===0)R=1-st;else{if(R===et)return z?NaN:1/0*(Et?-1:1);z+=Math.pow(2,_),R-=st}return(Et?-1:1)*z*Math.pow(2,R-_)},N3=function(g,c,y,_,T,R){var z,W,et,st=8*R-T-1,ht=(1<<st)-1,pt=ht>>1,bt=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,Et=_?0:R-1,kt=_?1:-1,Ft=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(W=isNaN(c)?1:0,z=ht):(z=Math.floor(Math.log(c)/Math.LN2),c*(et=Math.pow(2,-z))<1&&(z--,et*=2),(c+=z+pt>=1?bt/et:bt*Math.pow(2,1-pt))*et>=2&&(z++,et/=2),z+pt>=ht?(W=0,z=ht):z+pt>=1?(W=(c*et-1)*Math.pow(2,T),z+=pt):(W=c*Math.pow(2,pt-1)*Math.pow(2,T),z=0));T>=8;g[y+Et]=255&W,Et+=kt,W/=256,T-=8);for(z=z<<T|W,st+=T;st>0;g[y+Et]=255&z,Et+=kt,z/=256,st-=8);g[y+Et-kt]|=128*Ft},Ap=Pr;function Pr(g){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(g)?g:new Uint8Array(g||0),this.pos=0,this.type=0,this.length=this.buf.length}Pr.Varint=0,Pr.Fixed64=1,Pr.Bytes=2,Pr.Fixed32=5;var Ev=4294967296,O3=1/Ev,z3=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Ba(g){return g.type===Pr.Bytes?g.readVarint()+g.pos:g.pos+1}function Hh(g,c,y){return y?4294967296*c+(g>>>0):4294967296*(c>>>0)+(g>>>0)}function U3(g,c,y){var _=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));y.realloc(_);for(var T=y.pos-1;T>=g;T--)y.buf[T+_]=y.buf[T]}function Vz(g,c){for(var y=0;y<g.length;y++)c.writeVarint(g[y])}function jz(g,c){for(var y=0;y<g.length;y++)c.writeSVarint(g[y])}function Gz(g,c){for(var y=0;y<g.length;y++)c.writeFloat(g[y])}function Hz(g,c){for(var y=0;y<g.length;y++)c.writeDouble(g[y])}function Wz(g,c){for(var y=0;y<g.length;y++)c.writeBoolean(g[y])}function qz(g,c){for(var y=0;y<g.length;y++)c.writeFixed32(g[y])}function Xz(g,c){for(var y=0;y<g.length;y++)c.writeSFixed32(g[y])}function Yz(g,c){for(var y=0;y<g.length;y++)c.writeFixed64(g[y])}function Kz(g,c){for(var y=0;y<g.length;y++)c.writeSFixed64(g[y])}function e1(g,c){return(g[c]|g[c+1]<<8|g[c+2]<<16)+16777216*g[c+3]}function Wh(g,c,y){g[y]=c,g[y+1]=c>>>8,g[y+2]=c>>>16,g[y+3]=c>>>24}function V3(g,c){return(g[c]|g[c+1]<<8|g[c+2]<<16)+(g[c+3]<<24)}function Zz(g,c,y){c.glyphs=[],g===1&&y.readMessage(Jz,c)}function Jz(g,c,y){if(g===3){const{id:_,bitmap:T,width:R,height:z,left:W,top:et,advance:st}=y.readMessage($z,{});c.glyphs.push({id:_,bitmap:new La({width:R+6,height:z+6},T),metrics:{width:R,height:z,left:W,top:et,advance:st}})}else g===4?c.ascender=y.readSVarint():g===5&&(c.descender=y.readSVarint())}function $z(g,c,y){g===1?c.id=y.readVarint():g===2?c.bitmap=y.readBytes():g===3?c.width=y.readVarint():g===4?c.height=y.readVarint():g===5?c.left=y.readSVarint():g===6?c.top=y.readSVarint():g===7&&(c.advance=y.readVarint())}function Tv(g){let c=0,y=0;for(const z of g)c+=z.w*z.h,y=Math.max(y,z.w);g.sort((z,W)=>W.h-z.h);const _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),y),h:1/0}];let T=0,R=0;for(const z of g)for(let W=_.length-1;W>=0;W--){const et=_[W];if(!(z.w>et.w||z.h>et.h)){if(z.x=et.x,z.y=et.y,R=Math.max(R,z.y+z.h),T=Math.max(T,z.x+z.w),z.w===et.w&&z.h===et.h){const st=_.pop();W<_.length&&(_[W]=st)}else z.h===et.h?(et.x+=z.w,et.w-=z.w):z.w===et.w?(et.y+=z.h,et.h-=z.h):(_.push({x:et.x+z.w,y:et.y,w:et.w-z.w,h:z.h}),et.y+=z.h,et.h-=z.h);break}}return{w:T,h:R,fill:c/(T*R)||0}}Pr.prototype={destroy:function(){this.buf=null},readFields:function(g,c,y){for(y=y||this.length;this.pos<y;){var _=this.readVarint(),T=_>>3,R=this.pos;this.type=7&_,g(T,c,this),this.pos===R&&this.skip(_)}return c},readMessage:function(g,c){return this.readFields(g,c,this.readVarint()+this.pos)},readFixed32:function(){var g=e1(this.buf,this.pos);return this.pos+=4,g},readSFixed32:function(){var g=V3(this.buf,this.pos);return this.pos+=4,g},readFixed64:function(){var g=e1(this.buf,this.pos)+e1(this.buf,this.pos+4)*Ev;return this.pos+=8,g},readSFixed64:function(){var g=e1(this.buf,this.pos)+V3(this.buf,this.pos+4)*Ev;return this.pos+=8,g},readFloat:function(){var g=F3(this.buf,this.pos,!0,23,4);return this.pos+=4,g},readDouble:function(){var g=F3(this.buf,this.pos,!0,52,8);return this.pos+=8,g},readVarint:function(g){var c,y,_=this.buf;return c=127&(y=_[this.pos++]),y<128?c:(c|=(127&(y=_[this.pos++]))<<7,y<128?c:(c|=(127&(y=_[this.pos++]))<<14,y<128?c:(c|=(127&(y=_[this.pos++]))<<21,y<128?c:function(T,R,z){var W,et,st=z.buf;if(W=(112&(et=st[z.pos++]))>>4,et<128||(W|=(127&(et=st[z.pos++]))<<3,et<128)||(W|=(127&(et=st[z.pos++]))<<10,et<128)||(W|=(127&(et=st[z.pos++]))<<17,et<128)||(W|=(127&(et=st[z.pos++]))<<24,et<128)||(W|=(1&(et=st[z.pos++]))<<31,et<128))return Hh(T,W,R);throw new Error("Expected varint not more than 10 bytes")}(c|=(15&(y=_[this.pos]))<<28,g,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var g=this.readVarint();return g%2==1?(g+1)/-2:g/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var g=this.readVarint()+this.pos,c=this.pos;return this.pos=g,g-c>=12&&z3?function(y,_,T){return z3.decode(y.subarray(_,T))}(this.buf,c,g):function(y,_,T){for(var R="",z=_;z<T;){var W,et,st,ht=y[z],pt=null,bt=ht>239?4:ht>223?3:ht>191?2:1;if(z+bt>T)break;bt===1?ht<128&&(pt=ht):bt===2?(192&(W=y[z+1]))==128&&(pt=(31&ht)<<6|63&W)<=127&&(pt=null):bt===3?(et=y[z+2],(192&(W=y[z+1]))==128&&(192&et)==128&&((pt=(15&ht)<<12|(63&W)<<6|63&et)<=2047||pt>=55296&&pt<=57343)&&(pt=null)):bt===4&&(et=y[z+2],st=y[z+3],(192&(W=y[z+1]))==128&&(192&et)==128&&(192&st)==128&&((pt=(15&ht)<<18|(63&W)<<12|(63&et)<<6|63&st)<=65535||pt>=1114112)&&(pt=null)),pt===null?(pt=65533,bt=1):pt>65535&&(pt-=65536,R+=String.fromCharCode(pt>>>10&1023|55296),pt=56320|1023&pt),R+=String.fromCharCode(pt),z+=bt}return R}(this.buf,c,g)},readBytes:function(){var g=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,g);return this.pos=g,c},readPackedVarint:function(g,c){if(this.type!==Pr.Bytes)return g.push(this.readVarint(c));var y=Ba(this);for(g=g||[];this.pos<y;)g.push(this.readVarint(c));return g},readPackedSVarint:function(g){if(this.type!==Pr.Bytes)return g.push(this.readSVarint());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readSVarint());return g},readPackedBoolean:function(g){if(this.type!==Pr.Bytes)return g.push(this.readBoolean());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readBoolean());return g},readPackedFloat:function(g){if(this.type!==Pr.Bytes)return g.push(this.readFloat());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readFloat());return g},readPackedDouble:function(g){if(this.type!==Pr.Bytes)return g.push(this.readDouble());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readDouble());return g},readPackedFixed32:function(g){if(this.type!==Pr.Bytes)return g.push(this.readFixed32());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readFixed32());return g},readPackedSFixed32:function(g){if(this.type!==Pr.Bytes)return g.push(this.readSFixed32());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readSFixed32());return g},readPackedFixed64:function(g){if(this.type!==Pr.Bytes)return g.push(this.readFixed64());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readFixed64());return g},readPackedSFixed64:function(g){if(this.type!==Pr.Bytes)return g.push(this.readSFixed64());var c=Ba(this);for(g=g||[];this.pos<c;)g.push(this.readSFixed64());return g},skip:function(g){var c=7&g;if(c===Pr.Varint)for(;this.buf[this.pos++]>127;);else if(c===Pr.Bytes)this.pos=this.readVarint()+this.pos;else if(c===Pr.Fixed32)this.pos+=4;else{if(c!==Pr.Fixed64)throw new Error("Unimplemented type: "+c);this.pos+=8}},writeTag:function(g,c){this.writeVarint(g<<3|c)},realloc:function(g){for(var c=this.length||16;c<this.pos+g;)c*=2;if(c!==this.length){var y=new Uint8Array(c);y.set(this.buf),this.buf=y,this.length=c}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(g){this.realloc(4),Wh(this.buf,g,this.pos),this.pos+=4},writeSFixed32:function(g){this.realloc(4),Wh(this.buf,g,this.pos),this.pos+=4},writeFixed64:function(g){this.realloc(8),Wh(this.buf,-1&g,this.pos),Wh(this.buf,Math.floor(g*O3),this.pos+4),this.pos+=8},writeSFixed64:function(g){this.realloc(8),Wh(this.buf,-1&g,this.pos),Wh(this.buf,Math.floor(g*O3),this.pos+4),this.pos+=8},writeVarint:function(g){(g=+g||0)>268435455||g<0?function(c,y){var _,T;if(c>=0?(_=c%4294967296|0,T=c/4294967296|0):(T=~(-c/4294967296),4294967295^(_=~(-c%4294967296))?_=_+1|0:(_=0,T=T+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");y.realloc(10),function(R,z,W){W.buf[W.pos++]=127&R|128,R>>>=7,W.buf[W.pos++]=127&R|128,R>>>=7,W.buf[W.pos++]=127&R|128,R>>>=7,W.buf[W.pos++]=127&R|128,W.buf[W.pos]=127&(R>>>=7)}(_,0,y),function(R,z){var W=(7&R)<<4;z.buf[z.pos++]|=W|((R>>>=3)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R)))))}(T,y)}(g,this):(this.realloc(4),this.buf[this.pos++]=127&g|(g>127?128:0),g<=127||(this.buf[this.pos++]=127&(g>>>=7)|(g>127?128:0),g<=127||(this.buf[this.pos++]=127&(g>>>=7)|(g>127?128:0),g<=127||(this.buf[this.pos++]=g>>>7&127))))},writeSVarint:function(g){this.writeVarint(g<0?2*-g-1:2*g)},writeBoolean:function(g){this.writeVarint(!!g)},writeString:function(g){g=String(g),this.realloc(4*g.length),this.pos++;var c=this.pos;this.pos=function(_,T,R){for(var z,W,et=0;et<T.length;et++){if((z=T.charCodeAt(et))>55295&&z<57344){if(!W){z>56319||et+1===T.length?(_[R++]=239,_[R++]=191,_[R++]=189):W=z;continue}if(z<56320){_[R++]=239,_[R++]=191,_[R++]=189,W=z;continue}z=W-55296<<10|z-56320|65536,W=null}else W&&(_[R++]=239,_[R++]=191,_[R++]=189,W=null);z<128?_[R++]=z:(z<2048?_[R++]=z>>6|192:(z<65536?_[R++]=z>>12|224:(_[R++]=z>>18|240,_[R++]=z>>12&63|128),_[R++]=z>>6&63|128),_[R++]=63&z|128)}return R}(this.buf,g,this.pos);var y=this.pos-c;y>=128&&U3(c,y,this),this.pos=c-1,this.writeVarint(y),this.pos+=y},writeFloat:function(g){this.realloc(4),N3(this.buf,g,this.pos,!0,23,4),this.pos+=4},writeDouble:function(g){this.realloc(8),N3(this.buf,g,this.pos,!0,52,8),this.pos+=8},writeBytes:function(g){var c=g.length;this.writeVarint(c),this.realloc(c);for(var y=0;y<c;y++)this.buf[this.pos++]=g[y]},writeRawMessage:function(g,c){this.pos++;var y=this.pos;g(c,this);var _=this.pos-y;_>=128&&U3(y,_,this),this.pos=y-1,this.writeVarint(_),this.pos+=_},writeMessage:function(g,c,y){this.writeTag(g,Pr.Bytes),this.writeRawMessage(c,y)},writePackedVarint:function(g,c){c.length&&this.writeMessage(g,Vz,c)},writePackedSVarint:function(g,c){c.length&&this.writeMessage(g,jz,c)},writePackedBoolean:function(g,c){c.length&&this.writeMessage(g,Wz,c)},writePackedFloat:function(g,c){c.length&&this.writeMessage(g,Gz,c)},writePackedDouble:function(g,c){c.length&&this.writeMessage(g,Hz,c)},writePackedFixed32:function(g,c){c.length&&this.writeMessage(g,qz,c)},writePackedSFixed32:function(g,c){c.length&&this.writeMessage(g,Xz,c)},writePackedFixed64:function(g,c){c.length&&this.writeMessage(g,Yz,c)},writePackedSFixed64:function(g,c){c.length&&this.writeMessage(g,Kz,c)},writeBytesField:function(g,c){this.writeTag(g,Pr.Bytes),this.writeBytes(c)},writeFixed32Field:function(g,c){this.writeTag(g,Pr.Fixed32),this.writeFixed32(c)},writeSFixed32Field:function(g,c){this.writeTag(g,Pr.Fixed32),this.writeSFixed32(c)},writeFixed64Field:function(g,c){this.writeTag(g,Pr.Fixed64),this.writeFixed64(c)},writeSFixed64Field:function(g,c){this.writeTag(g,Pr.Fixed64),this.writeSFixed64(c)},writeVarintField:function(g,c){this.writeTag(g,Pr.Varint),this.writeVarint(c)},writeSVarintField:function(g,c){this.writeTag(g,Pr.Varint),this.writeSVarint(c)},writeStringField:function(g,c){this.writeTag(g,Pr.Bytes),this.writeString(c)},writeFloatField:function(g,c){this.writeTag(g,Pr.Fixed32),this.writeFloat(c)},writeDoubleField:function(g,c){this.writeTag(g,Pr.Fixed64),this.writeDouble(c)},writeBooleanField:function(g,c){this.writeVarintField(g,!!c)}};class Cv{constructor(c,{pixelRatio:y,version:_,stretchX:T,stretchY:R,content:z}){this.paddedRect=c,this.pixelRatio=y,this.stretchX=T,this.stretchY=R,this.content=z,this.version=_}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class j3{constructor(c,y){const _={},T={};this.haveRenderCallbacks=[];const R=[];this.addImages(c,_,R),this.addImages(y,T,R);const{w:z,h:W}=Tv(R),et=new Co({width:z||1,height:W||1});for(const st in c){const ht=c[st],pt=_[st].paddedRect;Co.copy(ht.data,et,{x:0,y:0},{x:pt.x+1,y:pt.y+1},ht.data)}for(const st in y){const ht=y[st],pt=T[st].paddedRect,bt=pt.x+1,Et=pt.y+1,kt=ht.data.width,Ft=ht.data.height;Co.copy(ht.data,et,{x:0,y:0},{x:bt,y:Et},ht.data),Co.copy(ht.data,et,{x:0,y:Ft-1},{x:bt,y:Et-1},{width:kt,height:1}),Co.copy(ht.data,et,{x:0,y:0},{x:bt,y:Et+Ft},{width:kt,height:1}),Co.copy(ht.data,et,{x:kt-1,y:0},{x:bt-1,y:Et},{width:1,height:Ft}),Co.copy(ht.data,et,{x:0,y:0},{x:bt+kt,y:Et},{width:1,height:Ft})}this.image=et,this.iconPositions=_,this.patternPositions=T}addImages(c,y,_){for(const T in c){const R=c[T],z={x:0,y:0,w:R.data.width+2,h:R.data.height+2};_.push(z),y[T]=new Cv(z,R),R.hasRenderCallback&&this.haveRenderCallbacks.push(T)}}patchUpdatedImages(c,y){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(_=>c.hasImage(_)),c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const _ in c.updatedImages)this.patchUpdatedImage(this.iconPositions[_],c.getImage(_),y),this.patchUpdatedImage(this.patternPositions[_],c.getImage(_),y)}patchUpdatedImage(c,y,_){if(!c||!y||c.version===y.version)return;c.version=y.version;const[T,R]=c.tl;_.update(y.data,void 0,{x:T,y:R})}}xn(Cv,"ImagePosition"),xn(j3,"ImageAtlas");const Xo={horizontal:1,vertical:2,horizontalOnly:3};class Sp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,y){const _=new Sp;return _.scale=c||1,_.fontStack=y,_}static forImage(c){const y=new Sp;return y.imageName=c,y}}class qh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,y){const _=new qh;for(let T=0;T<c.sections.length;T++){const R=c.sections[T];R.image?_.addImageSection(R):_.addTextSection(R,y)}return _}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSections(){return this.sections}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(c){this.text=function(y,_){let T="";for(let R=0;R<y.length;R++){const z=y.charCodeAt(R+1)||null,W=y.charCodeAt(R-1)||null;T+=!_&&(z&&Rh(z)&&!Mp[y[R+1]]||W&&Rh(W)&&!Mp[y[R-1]])||!Mp[y[R]]?y[R]:Mp[y[R]]}return T}(this.text,c)}trim(){let c=0;for(let _=0;_<this.text.length&&n1[this.text.charCodeAt(_)];_++)c++;let y=this.text.length;for(let _=this.text.length-1;_>=0&&_>=c&&n1[this.text.charCodeAt(_)];_--)y--;this.text=this.text.substring(c,y),this.sectionIndex=this.sectionIndex.slice(c,y)}substring(c,y){const _=new qh;return _.text=this.text.substring(c,y),_.sectionIndex=this.sectionIndex.slice(c,y),_.sections=this.sections,_}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,y)=>Math.max(c,this.sections[y].scale),0)}addTextSection(c,y){this.text+=c.text,this.sections.push(Sp.forText(c.scale,c.fontStack||y));const _=this.sections.length-1;for(let T=0;T<c.text.length;++T)this.sectionIndex.push(_)}addImageSection(c){const y=c.image?c.image.name:"";if(y.length===0)return void lt("Can't add FormattedSection with an empty image.");const _=this.getNextImageSectionCharCode();_?(this.text+=String.fromCharCode(_),this.sections.push(Sp.forImage(y)),this.sectionIndex.push(this.sections.length-1)):lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pv(g,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft){const Vt=qh.fromFeature(g,T);let $t;pt===Xo.vertical&&Vt.verticalizePunctuation(bt);const{processBidirectionalText:ue,processStyledBidirectionalText:ge}=So;if(ue&&Vt.sections.length===1){$t=[];const we=ue(Vt.toString(),Dv(Vt,st,R,c,_,Et,kt));for(const Be of we){const Oe=new qh;Oe.text=Be,Oe.sections=Vt.sections;for(let Je=0;Je<Be.length;Je++)Oe.sectionIndex.push(0);$t.push(Oe)}}else if(ge){$t=[];const we=ge(Vt.text,Vt.sectionIndex,Dv(Vt,st,R,c,_,Et,kt));for(const Be of we){const Oe=new qh;Oe.text=Be[0],Oe.sectionIndex=Be[1],Oe.sections=Vt.sections,$t.push(Oe)}}else $t=function(we,Be){const Oe=[],Je=we.text;let tn=0;for(const De of Be)Oe.push(we.substring(tn,De)),tn=De;return tn<Je.length&&Oe.push(we.substring(tn,Je.length)),Oe}(Vt,Dv(Vt,st,R,c,_,Et,kt));const xe=[],_e={positionedLines:xe,text:Vt.toString(),top:ht[1],bottom:ht[1],left:ht[0],right:ht[0],writingMode:pt,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(we,Be,Oe,Je,tn,De,qe,nn,fn,sn,dn,Kn){let lr=0,Zn=0,or=0;const Cn=nn==="right"?1:nn==="left"?0:.5;let bn=!1;for(const xr of tn){const fr=xr.getSections();for(const Sr of fr){if(Sr.imageName)continue;const Hr=Be[Sr.fontStack];if(Hr&&(bn=Hr.ascender!==void 0&&Hr.descender!==void 0,!bn))break}if(!bn)break}let hr=0;for(const xr of tn){xr.trim();const fr=xr.getMaxScale(),Sr=(fr-1)*ki,Hr={positionedGlyphs:[],lineOffset:0};we.positionedLines[hr]=Hr;const Zr=Hr.positionedGlyphs;let ai=0;if(!xr.length()){Zn+=De,++hr;continue}let bi=0,Ro=0;for(let Er=0;Er<xr.length();Er++){const Ki=xr.getSection(Er),ko=xr.getSectionIndex(Er),_i=xr.getCharCode(Er);let vi=Ki.scale,Fr=null,kr=null,fo=null,Zi=ki,ei=0;const Ji=!(fn===Xo.horizontal||!dn&&!Dh(_i)||dn&&(n1[_i]||(vr=_i,w0(vr)||Sh(vr)||Rc(vr)||tp(vr)||Ch(vr))));if(Ki.imageName){const Ui=Je[Ki.imageName];if(!Ui)continue;fo=Ki.imageName,we.iconsInText=we.iconsInText||!0,kr=Ui.paddedRect;const xi=Ui.displaySize;vi=vi*ki/Kn,Fr={width:xi[0],height:xi[1],left:1,top:-3,advance:Ji?xi[1]:xi[0],localGlyph:!1},ei=bn?-Fr.height*vi:fr*ki-17-xi[1]*vi,Zi=Fr.advance;const is=(Ji?xi[0]:xi[1])*vi-ki*fr;is>0&&is>ai&&(ai=is)}else{const Ui=Oe[Ki.fontStack];if(!Ui)continue;Ui[_i]&&(kr=Ui[_i]);const xi=Be[Ki.fontStack];if(!xi)continue;const is=xi.glyphs[_i];if(!is)continue;if(Fr=is.metrics,Zi=_i!==8203?ki:0,bn){const Rl=xi.ascender!==void 0?Math.abs(xi.ascender):0,Bp=xi.descender!==void 0?Math.abs(xi.descender):0,Fp=(Rl+Bp)*vi;bi<Fp&&(bi=Fp,Ro=(Rl-Bp)/2*vi),ei=-Rl*vi}else ei=(fr-vi)*ki-17}Ji?(we.verticalizable=!0,Zr.push({glyph:_i,imageName:fo,x:lr,y:Zn+ei,vertical:Ji,scale:vi,localGlyph:Fr.localGlyph,fontStack:Ki.fontStack,sectionIndex:ko,metrics:Fr,rect:kr}),lr+=Zi*vi+sn):(Zr.push({glyph:_i,imageName:fo,x:lr,y:Zn+ei,vertical:Ji,scale:vi,localGlyph:Fr.localGlyph,fontStack:Ki.fontStack,sectionIndex:ko,metrics:Fr,rect:kr}),lr+=Fr.advance*vi+sn)}Zr.length!==0&&(or=Math.max(lr-sn,or),bn?X3(Zr,Cn,ai,Ro,De*fr/2):X3(Zr,Cn,ai,0,De/2)),lr=0;const ho=De*fr+ai;Hr.lineOffset=Math.max(ai,Sr),Zn+=ho,++hr}var vr;const oi=Zn,{horizontalAlign:Rr,verticalAlign:si}=Rv(qe);(function(xr,fr,Sr,Hr,Zr,ai){const bi=(fr-Sr)*Zr,Ro=-ai*Hr;for(const ho of xr)for(const Er of ho.positionedGlyphs)Er.x+=bi,Er.y+=Ro})(we.positionedLines,Cn,Rr,si,or,oi),we.top+=-si*oi,we.bottom=we.top+oi,we.left+=-Rr*or,we.right=we.left+or,we.hasBaseline=bn}(_e,c,y,_,$t,z,W,et,pt,st,bt,Ft),!function(we){for(const Be of we)if(Be.positionedGlyphs.length!==0)return!1;return!0}(xe)&&_e}const n1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Qz={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function G3(g,c,y,_,T,R){if(c.imageName){const z=_[c.imageName];return z?z.displaySize[0]*c.scale*ki/R+T:0}{const z=y[c.fontStack],W=z&&z.glyphs[g];return W?W.metrics.advance*c.scale+T:0}}function H3(g,c,y,_){const T=Math.pow(g-c,2);return _?g<c?T/2:2*T:T+Math.abs(y)*y}function tU(g,c,y){let _=0;return g===10&&(_-=1e4),y&&(_+=150),g!==40&&g!==65288||(_+=50),c!==41&&c!==65289||(_+=50),_}function W3(g,c,y,_,T,R){let z=null,W=H3(c,y,T,R);for(const et of _){const st=H3(c-et.x,y,T,R)+et.badness;st<=W&&(z=et,W=st)}return{index:g,x:c,priorBreak:z,badness:W}}function q3(g){return g?q3(g.priorBreak).concat(g.index):[]}function Dv(g,c,y,_,T,R,z){if(R!=="point")return[];if(!g)return[];const W=[],et=function(bt,Et,kt,Ft,Vt,$t){let ue=0;for(let ge=0;ge<bt.length();ge++){const xe=bt.getSection(ge);ue+=G3(bt.getCharCode(ge),xe,Ft,Vt,Et,$t)}return ue/Math.max(1,Math.ceil(ue/kt))}(g,c,y,_,T,z),st=g.text.indexOf("​")>=0;let ht=0;for(let bt=0;bt<g.length();bt++){const Et=g.getSection(bt),kt=g.getCharCode(bt);if(n1[kt]||(ht+=G3(kt,Et,_,T,c,z)),bt<g.length()-1){const Ft=!((pt=kt)<11904||!(S0(pt)||A0(pt)||gl(pt)||Ic(pt)||C0(pt)||Zf(pt)||E0(pt)||Eh(pt)||P0(pt)||Qf(pt)||T0(pt)||ep(pt)||kc(pt)||Jf(pt)||M0(pt)||$f(pt)||Th(pt)||I0(pt)||R0(pt)||D0(pt)));(Qz[kt]||Ft||Et.imageName)&&W.push(W3(bt+1,ht,et,W,tU(kt,g.getCharCode(bt+1),Ft&&st),!1))}}var pt;return q3(W3(g.length(),ht,et,W,0,!0))}function Rv(g){let c=.5,y=.5;switch(g){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(g){case"bottom":case"bottom-right":case"bottom-left":y=1;break;case"top":case"top-right":case"top-left":y=0}return{horizontalAlign:c,verticalAlign:y}}function X3(g,c,y,_,T){if(!(c||y||_||T))return;const R=g.length-1,z=g[R],W=(z.x+z.metrics.advance*z.scale)*c;for(let et=0;et<=R;et++)g[et].x-=W,g[et].y+=y+_+T}function eU(g,c,y){const{horizontalAlign:_,verticalAlign:T}=Rv(y),R=c[0]-g.displaySize[0]*_,z=c[1]-g.displaySize[1]*T;return{image:g,top:z,bottom:z+g.displaySize[1],left:R,right:R+g.displaySize[0]}}function Y3(g,c,y,_,T,R){const z=g.image;let W;if(z.content){const Vt=z.content,$t=z.pixelRatio||1;W=[Vt[0]/$t,Vt[1]/$t,z.displaySize[0]-Vt[2]/$t,z.displaySize[1]-Vt[3]/$t]}const et=c.left*R,st=c.right*R;let ht,pt,bt,Et;y==="width"||y==="both"?(Et=T[0]+et-_[3],pt=T[0]+st+_[1]):(Et=T[0]+(et+st-z.displaySize[0])/2,pt=Et+z.displaySize[0]);const kt=c.top*R,Ft=c.bottom*R;return y==="height"||y==="both"?(ht=T[1]+kt-_[0],bt=T[1]+Ft+_[2]):(ht=T[1]+(kt+Ft-z.displaySize[1])/2,bt=ht+z.displaySize[1]),{image:z,top:ht,right:pt,bottom:bt,left:Et,collisionPadding:W}}class Fa extends f{constructor(c,y,_,T,R){super(c,y),this.angle=T,this.z=_,R!==void 0&&(this.segment=R)}clone(){return new Fa(this.x,this.y,this.z,this.angle,this.segment)}}function K3(g,c,y,_,T){if(c.segment===void 0)return!0;let R=c,z=c.segment+1,W=0;for(;W>-y/2;){if(z--,z<0)return!1;W-=g[z].dist(R),R=g[z]}W+=g[z].dist(g[z+1]),z++;const et=[];let st=0;for(;W<y/2;){const ht=g[z],pt=g[z+1];if(!pt)return!1;let bt=g[z-1].angleTo(ht)-ht.angleTo(pt);for(bt=Math.abs((bt+3*Math.PI)%(2*Math.PI)-Math.PI),et.push({distance:W,angleDelta:bt}),st+=bt;W-et[0].distance>_;)st-=et.shift().angleDelta;if(st>T)return!1;z++,W+=ht.dist(pt)}return!0}function Z3(g){let c=0;for(let y=0;y<g.length-1;y++)c+=g[y].dist(g[y+1]);return c}function J3(g,c,y){return g?.6*c*y:0}function $3(g,c){return Math.max(g?g.right-g.left:0,c?c.right-c.left:0)}function nU(g,c,y,_,T,R){const z=J3(y,T,R),W=$3(y,_)*R;let et=0;const st=Z3(g)/2;for(let ht=0;ht<g.length-1;ht++){const pt=g[ht],bt=g[ht+1],Et=pt.dist(bt);if(et+Et>st){const kt=(st-et)/Et,Ft=Nn(pt.x,bt.x,kt),Vt=Nn(pt.y,bt.y,kt),$t=new Fa(Ft,Vt,0,bt.angleTo(pt),ht);return!z||K3(g,$t,W,z,c)?$t:void 0}et+=Et}}function rU(g,c,y,_,T,R,z,W,et){const st=J3(_,R,z),ht=$3(_,T),pt=ht*z,bt=g[0].x===0||g[0].x===et||g[0].y===0||g[0].y===et;return c-pt<c/4&&(c=pt+c/4),Q3(g,bt?c/2*W%c:(ht/2+2*R)*z*W%c,c,st,y,pt,bt,!1,et)}function Q3(g,c,y,_,T,R,z,W,et){const st=R/2,ht=Z3(g);let pt=0,bt=c-y,Et=[];for(let kt=0;kt<g.length-1;kt++){const Ft=g[kt],Vt=g[kt+1],$t=Ft.dist(Vt),ue=Vt.angleTo(Ft);for(;bt+y<pt+$t;){bt+=y;const ge=(bt-pt)/$t,xe=Nn(Ft.x,Vt.x,ge),_e=Nn(Ft.y,Vt.y,ge);if(xe>=0&&xe<et&&_e>=0&&_e<et&&bt-st>=0&&bt+st<=ht){const we=new Fa(xe,_e,0,ue,kt);we._round(),_&&!K3(g,we,R,_,T)||Et.push(we)}}pt+=$t}return W||Et.length||z||(Et=Q3(g,pt/2,y,_,T,R,z,!0,et)),Et}function tA(g,c,y,_,T){const R=[];for(let z=0;z<g.length;z++){const W=g[z];let et;for(let st=0;st<W.length-1;st++){let ht=W[st],pt=W[st+1];ht.x<c&&pt.x<c||(ht.x<c?ht=new f(c,ht.y+(c-ht.x)/(pt.x-ht.x)*(pt.y-ht.y))._round():pt.x<c&&(pt=new f(c,ht.y+(c-ht.x)/(pt.x-ht.x)*(pt.y-ht.y))._round()),ht.y<y&&pt.y<y||(ht.y<y?ht=new f(ht.x+(y-ht.y)/(pt.y-ht.y)*(pt.x-ht.x),y)._round():pt.y<y&&(pt=new f(ht.x+(y-ht.y)/(pt.y-ht.y)*(pt.x-ht.x),y)._round()),ht.x>=_&&pt.x>=_||(ht.x>=_?ht=new f(_,ht.y+(_-ht.x)/(pt.x-ht.x)*(pt.y-ht.y))._round():pt.x>=_&&(pt=new f(_,ht.y+(_-ht.x)/(pt.x-ht.x)*(pt.y-ht.y))._round()),ht.y>=T&&pt.y>=T||(ht.y>=T?ht=new f(ht.x+(T-ht.y)/(pt.y-ht.y)*(pt.x-ht.x),T)._round():pt.y>=T&&(pt=new f(ht.x+(T-ht.y)/(pt.y-ht.y)*(pt.x-ht.x),T)._round()),et&&ht.equals(et[et.length-1])||(et=[ht],R.push(et)),et.push(pt)))))}}return R}xn(Fa,"Anchor");const Ep=1e20;function eA(g,c,y,_,T,R,z,W,et){for(let st=c;st<c+_;st++)nA(g,y*R+st,R,T,z,W,et);for(let st=y;st<y+T;st++)nA(g,st*R+c,1,_,z,W,et)}function nA(g,c,y,_,T,R,z){R[0]=0,z[0]=-Ep,z[1]=Ep,T[0]=g[c];for(let W=1,et=0,st=0;W<_;W++){T[W]=g[c+W*y];const ht=W*W;do{const pt=R[et];st=(T[W]-T[pt]+ht-pt*pt)/(W-pt)/2}while(st<=z[et]&&--et>-1);et++,R[et]=W,z[et]=st,z[et+1]=Ep}for(let W=0,et=0;W<_;W++){for(;z[et+1]<W;)et++;const st=R[et],ht=W-st;g[c+W*y]=T[st]+ht*ht}}const kv={none:0,ideographs:1,all:2};class Xh{constructor(c,y,_){this.requestManager=c,this.localGlyphMode=y,this.localFontFamily=_,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(c){this.url=c}getGlyphs(c,y){const _=[];for(const T in c)for(const R of c[T])_.push({stack:T,id:R});Z(_,({stack:T,id:R},z)=>{let W=this.entries[T];W||(W=this.entries[T]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let et=W.glyphs[R];if(et!==void 0)return void z(null,{stack:T,id:R,glyph:et});if(et=this._tinySDF(W,T,R),et)return W.glyphs[R]=et,void z(null,{stack:T,id:R,glyph:et});const st=Math.floor(R/256);if(256*st>65535)return void z(new Error("glyphs > 65535 not supported"));if(W.ranges[st])return void z(null,{stack:T,id:R,glyph:et});let ht=W.requests[st];ht||(ht=W.requests[st]=[],Xh.loadGlyphRange(T,st,this.url,this.requestManager,(pt,bt)=>{if(bt){W.ascender=bt.ascender,W.descender=bt.descender;for(const Et in bt.glyphs)this._doesCharSupportLocalGlyph(+Et)||(W.glyphs[+Et]=bt.glyphs[+Et]);W.ranges[st]=!0}for(const Et of ht)Et(pt,bt);delete W.requests[st]})),ht.push((pt,bt)=>{pt?z(pt):bt&&z(null,{stack:T,id:R,glyph:bt.glyphs[R]||null})})},(T,R)=>{if(T)y(T);else if(R){const z={};for(const{stack:W,id:et,glyph:st}of R)z[W]===void 0&&(z[W]={}),z[W].glyphs===void 0&&(z[W].glyphs={}),z[W].glyphs[et]=st&&{id:st.id,bitmap:st.bitmap.clone(),metrics:st.metrics},z[W].ascender=this.entries[W].ascender,z[W].descender=this.entries[W].descender;y(null,z)}})}_doesCharSupportLocalGlyph(c){return this.localGlyphMode!==kv.none&&(this.localGlyphMode===kv.all?!!this.localFontFamily:!!this.localFontFamily&&(Qf(c)||k0(c)||kc(c)||Th(c)||Eh(c)))}_tinySDF(c,y,_){const T=this.localFontFamily;if(!T||!this._doesCharSupportLocalGlyph(_))return;let R=c.tinySDF;if(!R){let Ft="400";/bold/i.test(y)?Ft="900":/medium/i.test(y)?Ft="500":/light/i.test(y)&&(Ft="200"),R=c.tinySDF=new Xh.TinySDF({fontFamily:T,fontWeight:Ft,fontSize:48,buffer:6,radius:16}),R.fontWeight=Ft}if(this.localGlyphs[R.fontWeight][_])return this.localGlyphs[R.fontWeight][_];const z=String.fromCharCode(_),{data:W,width:et,height:st,glyphWidth:ht,glyphHeight:pt,glyphLeft:bt,glyphTop:Et,glyphAdvance:kt}=R.draw(z);return this.localGlyphs[R.fontWeight][_]={id:_,bitmap:new La({width:et,height:st},W),metrics:{width:ht/2,height:pt/2,left:bt/2,top:Et/2-27,advance:kt/2,localGlyph:!0}}}}function rA(g,c,y,_){const T=[],R=g.image,z=R.pixelRatio,W=R.paddedRect.w-2,et=R.paddedRect.h-2,st=g.right-g.left,ht=g.bottom-g.top,pt=R.stretchX||[[0,W]],bt=R.stretchY||[[0,et]],Et=(De,qe)=>De+qe[1]-qe[0],kt=pt.reduce(Et,0),Ft=bt.reduce(Et,0),Vt=W-kt,$t=et-Ft;let ue=0,ge=kt,xe=0,_e=Ft,we=0,Be=Vt,Oe=0,Je=$t;if(R.content&&_){const De=R.content;ue=r1(pt,0,De[0]),xe=r1(bt,0,De[1]),ge=r1(pt,De[0],De[2]),_e=r1(bt,De[1],De[3]),we=De[0]-ue,Oe=De[1]-xe,Be=De[2]-De[0]-ge,Je=De[3]-De[1]-_e}const tn=(De,qe,nn,fn)=>{const sn=i1(De.stretch-ue,ge,st,g.left),dn=o1(De.fixed-we,Be,De.stretch,kt),Kn=i1(qe.stretch-xe,_e,ht,g.top),lr=o1(qe.fixed-Oe,Je,qe.stretch,Ft),Zn=i1(nn.stretch-ue,ge,st,g.left),or=o1(nn.fixed-we,Be,nn.stretch,kt),Cn=i1(fn.stretch-xe,_e,ht,g.top),bn=o1(fn.fixed-Oe,Je,fn.stretch,Ft),hr=new f(sn,Kn),vr=new f(Zn,Kn),oi=new f(Zn,Cn),Rr=new f(sn,Cn),si=new f(dn/z,lr/z),xr=new f(or/z,bn/z),fr=c*Math.PI/180;if(fr){const Zr=Math.sin(fr),ai=Math.cos(fr),bi=[ai,-Zr,Zr,ai];hr._matMult(bi),vr._matMult(bi),Rr._matMult(bi),oi._matMult(bi)}const Sr=De.stretch+De.fixed,Hr=qe.stretch+qe.fixed;return{tl:hr,tr:vr,bl:Rr,br:oi,tex:{x:R.paddedRect.x+1+Sr,y:R.paddedRect.y+1+Hr,w:nn.stretch+nn.fixed-Sr,h:fn.stretch+fn.fixed-Hr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:si,pixelOffsetBR:xr,minFontScaleX:Be/z/st,minFontScaleY:Je/z/ht,isSDF:y}};if(_&&(R.stretchX||R.stretchY)){const De=iA(pt,Vt,kt),qe=iA(bt,$t,Ft);for(let nn=0;nn<De.length-1;nn++){const fn=De[nn],sn=De[nn+1];for(let dn=0;dn<qe.length-1;dn++)T.push(tn(fn,qe[dn],sn,qe[dn+1]))}}else T.push(tn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:W+1},{fixed:0,stretch:et+1}));return T}function r1(g,c,y){let _=0;for(const T of g)_+=Math.max(c,Math.min(y,T[1]))-Math.max(c,Math.min(y,T[0]));return _}function iA(g,c,y){const _=[{fixed:-1,stretch:0}];for(const[T,R]of g){const z=_[_.length-1];_.push({fixed:T-z.stretch,stretch:z.stretch}),_.push({fixed:T-z.stretch,stretch:z.stretch+(R-T)})}return _.push({fixed:c+1,stretch:y}),_}function i1(g,c,y,_){return g/c*y+_}function o1(g,c,y,_){return g-c*y/_}function iU(g,c,y,_){const T=c+g.positionedLines[_].lineOffset;return _===0?y+T/2:y+(T+(c+g.positionedLines[_-1].lineOffset))/2}Xh.loadGlyphRange=function(g,c,y,_,T){const R=256*c,z=R+255,W=_.transformRequest(_.normalizeGlyphsURL(y).replace("{fontstack}",g).replace("{range}",`${R}-${z}`),Wt.Glyphs);Xt(W,(et,st)=>{if(et)T(et);else if(st){const ht={},pt=function(bt){return new Ap(bt).readFields(Zz,{})}(st);for(const bt of pt.glyphs)ht[bt.id]=bt;T(null,{glyphs:ht,ascender:pt.ascender,descender:pt.descender})}})},Xh.TinySDF=class{constructor({fontSize:g=24,buffer:c=3,radius:y=8,cutoff:_=.25,fontFamily:T="sans-serif",fontWeight:R="normal",fontStyle:z="normal"}){this.buffer=c,this.cutoff=_,this.radius=y;const W=this.size=g+4*c,et=this._createCanvas(W),st=this.ctx=et.getContext("2d",{willReadFrequently:!0});st.font=`${z} ${R} ${g}px ${T}`,st.textBaseline="alphabetic",st.textAlign="left",st.fillStyle="black",this.gridOuter=new Float64Array(W*W),this.gridInner=new Float64Array(W*W),this.f=new Float64Array(W),this.z=new Float64Array(W+1),this.v=new Uint16Array(W)}_createCanvas(g){const c=document.createElement("canvas");return c.width=c.height=g,c}draw(g){const{width:c,actualBoundingBoxAscent:y,actualBoundingBoxDescent:_,actualBoundingBoxLeft:T,actualBoundingBoxRight:R}=this.ctx.measureText(g),z=Math.floor(y),W=Math.min(this.size-this.buffer,Math.ceil(R-T)),et=Math.min(this.size-this.buffer,Math.ceil(y)+Math.ceil(_)),st=W+2*this.buffer,ht=et+2*this.buffer,pt=st*ht,bt=new Uint8ClampedArray(pt),Et={data:bt,width:st,height:ht,glyphWidth:W,glyphHeight:et,glyphTop:z,glyphLeft:0,glyphAdvance:c};if(W===0||et===0)return Et;const{ctx:kt,buffer:Ft,gridInner:Vt,gridOuter:$t}=this;kt.clearRect(Ft,Ft,W,et),kt.fillText(g,Ft,Ft+z+1);const ue=kt.getImageData(Ft,Ft,W,et);$t.fill(Ep,0,pt),Vt.fill(0,0,pt);for(let ge=0;ge<et;ge++)for(let xe=0;xe<W;xe++){const _e=ue.data[4*(ge*W+xe)+3]/255;if(_e===0)continue;const we=(ge+Ft)*st+xe+Ft;if(_e===1)$t[we]=0,Vt[we]=Ep;else{const Be=.5-_e;$t[we]=Be>0?Be*Be:0,Vt[we]=Be<0?Be*Be:0}}eA($t,0,0,st,ht,st,this.f,this.v,this.z),eA(Vt,Ft,Ft,W,et,st,this.f,this.v,this.z);for(let ge=0;ge<pt;ge++){const xe=Math.sqrt($t[ge])-Math.sqrt(Vt[ge]);bt[ge]=Math.round(255-255*(xe/this.radius+this.cutoff))}return Et}};class oU{constructor(c=[],y=sU){if(this.data=c,this.length=this.data.length,this.compare=y,this.length>0)for(let _=(this.length>>1)-1;_>=0;_--)this._down(_)}push(c){this.data.push(c),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const c=this.data[0],y=this.data.pop();return this.length--,this.length>0&&(this.data[0]=y,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:y,compare:_}=this,T=y[c];for(;c>0;){const R=c-1>>1,z=y[R];if(_(T,z)>=0)break;y[c]=z,c=R}y[c]=T}_down(c){const{data:y,compare:_}=this,T=this.length>>1,R=y[c];for(;c<T;){let z=1+(c<<1),W=y[z];const et=z+1;if(et<this.length&&_(y[et],W)<0&&(z=et,W=y[et]),_(W,R)>=0)break;y[c]=W,c=z}y[c]=R}}function sU(g,c){return g<c?-1:g>c?1:0}function aU(g,c=1,y=!1){let _=1/0,T=1/0,R=-1/0,z=-1/0;const W=g[0];for(let Et=0;Et<W.length;Et++){const kt=W[Et];(!Et||kt.x<_)&&(_=kt.x),(!Et||kt.y<T)&&(T=kt.y),(!Et||kt.x>R)&&(R=kt.x),(!Et||kt.y>z)&&(z=kt.y)}const et=Math.min(R-_,z-T);let st=et/2;const ht=new oU([],lU);if(et===0)return new f(_,T);for(let Et=_;Et<R;Et+=et)for(let kt=T;kt<z;kt+=et)ht.push(new Yh(Et+st,kt+st,st,g));let pt=function(Et){let kt=0,Ft=0,Vt=0;const $t=Et[0];for(let ue=0,ge=$t.length,xe=ge-1;ue<ge;xe=ue++){const _e=$t[ue],we=$t[xe],Be=_e.x*we.y-we.x*_e.y;Ft+=(_e.x+we.x)*Be,Vt+=(_e.y+we.y)*Be,kt+=3*Be}return new Yh(Ft/kt,Vt/kt,0,Et)}(g),bt=ht.length;for(;ht.length;){const Et=ht.pop();(Et.d>pt.d||!pt.d)&&(pt=Et,y&&console.log("found best %d after %d probes",Math.round(1e4*Et.d)/1e4,bt)),Et.max-pt.d<=c||(st=Et.h/2,ht.push(new Yh(Et.p.x-st,Et.p.y-st,st,g)),ht.push(new Yh(Et.p.x+st,Et.p.y-st,st,g)),ht.push(new Yh(Et.p.x-st,Et.p.y+st,st,g)),ht.push(new Yh(Et.p.x+st,Et.p.y+st,st,g)),bt+=4)}return y&&(console.log(`num probes: ${bt}`),console.log(`best distance: ${pt.d}`)),pt.p}function lU(g,c){return c.max-g.max}function Yh(g,c,y,_){this.p=new f(g,c),this.h=y,this.d=function(T,R){let z=!1,W=1/0;for(let et=0;et<R.length;et++){const st=R[et];for(let ht=0,pt=st.length,bt=pt-1;ht<pt;bt=ht++){const Et=st[ht],kt=st[bt];Et.y>T.y!=kt.y>T.y&&T.x<(kt.x-Et.x)*(T.y-Et.y)/(kt.y-Et.y)+Et.x&&(z=!z),W=Math.min(W,t3(T,Et,kt))}}return(z?1:-1)*Math.sqrt(W)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}const Iv=Number.POSITIVE_INFINITY,cU=Math.sqrt(2);function oA(g,c){return c[1]!==Iv?function(y,_,T){let R=0,z=0;switch(_=Math.abs(_),T=Math.abs(T),y){case"top-right":case"top-left":case"top":z=T-7;break;case"bottom-right":case"bottom-left":case"bottom":z=7-T}switch(y){case"top-right":case"bottom-right":case"right":R=-_;break;case"top-left":case"bottom-left":case"left":R=_}return[R,z]}(g,c[0],c[1]):function(y,_){let T=0,R=0;_<0&&(_=0);const z=_/cU;switch(y){case"top-right":case"top-left":R=z-7;break;case"bottom-right":case"bottom-left":R=7-z;break;case"bottom":R=7-_;break;case"top":R=_-7}switch(y){case"top-right":case"bottom-right":T=-z;break;case"top-left":case"bottom-left":T=z;break;case"left":T=_;break;case"right":T=-_}return[T,R]}(g,c[0])}function uU(g,c,y,_,T,R,z,W,et,st){g.createArrays(),g.tilePixelRatio=tr/(512*g.overscaling),g.compareText={},g.iconsNeedLinear=!1;const ht=g.layers[0].layout,pt=g.layers[0]._unevaluatedLayout._values,bt={};if(g.textSizeData.kind==="composite"){const{minZoom:Ft,maxZoom:Vt}=g.textSizeData;bt.compositeTextSizes=[pt["text-size"].possiblyEvaluate(new Dr(Ft),W),pt["text-size"].possiblyEvaluate(new Dr(Vt),W)]}if(g.iconSizeData.kind==="composite"){const{minZoom:Ft,maxZoom:Vt}=g.iconSizeData;bt.compositeIconSizes=[pt["icon-size"].possiblyEvaluate(new Dr(Ft),W),pt["icon-size"].possiblyEvaluate(new Dr(Vt),W)]}bt.layoutTextSize=pt["text-size"].possiblyEvaluate(new Dr(et+1),W),bt.layoutIconSize=pt["icon-size"].possiblyEvaluate(new Dr(et+1),W),bt.textMaxSize=pt["text-size"].possiblyEvaluate(new Dr(18),W);const Et=ht.get("text-rotation-alignment")==="map"&&ht.get("symbol-placement")!=="point",kt=ht.get("text-size");for(const Ft of g.features){const Vt=ht.get("text-font").evaluate(Ft,{},W).join(","),$t=kt.evaluate(Ft,{},W),ue=bt.layoutTextSize.evaluate(Ft,{},W),ge=(bt.layoutIconSize.evaluate(Ft,{},W),{horizontal:{},vertical:void 0}),xe=Ft.text;let _e,we=[0,0];if(xe){const Je=xe.toString(),tn=ht.get("text-letter-spacing").evaluate(Ft,{},W)*ki,De=ht.get("text-line-height").evaluate(Ft,{},W)*ki,qe=B0(Je)?tn:0,nn=ht.get("text-anchor").evaluate(Ft,{},W),fn=ht.get("text-variable-anchor");if(!fn){const or=ht.get("text-radial-offset").evaluate(Ft,{},W);we=or?oA(nn,[or*ki,Iv]):ht.get("text-offset").evaluate(Ft,{},W).map(Cn=>Cn*ki)}let sn=Et?"center":ht.get("text-justify").evaluate(Ft,{},W);const dn=ht.get("symbol-placement"),Kn=dn==="point",lr=dn==="point"?ht.get("text-max-width").evaluate(Ft,{},W)*ki:0,Zn=or=>{g.allowVerticalPlacement&&Ph(Je)&&(ge.vertical=Pv(xe,c,y,T,Vt,lr,De,nn,or,qe,we,Xo.vertical,!0,dn,ue,$t))};if(!Et&&fn){const or=sn==="auto"?fn.map(bn=>Lv(bn)):[sn];let Cn=!1;for(let bn=0;bn<or.length;bn++){const hr=or[bn];if(!ge.horizontal[hr])if(Cn)ge.horizontal[hr]=ge.horizontal[0];else{const vr=Pv(xe,c,y,T,Vt,lr,De,"center",hr,qe,we,Xo.horizontal,!1,dn,ue,$t);vr&&(ge.horizontal[hr]=vr,Cn=vr.positionedLines.length===1)}}Zn("left")}else{if(sn==="auto"&&(sn=Lv(nn)),Kn||ht.get("text-writing-mode").indexOf("horizontal")>=0||!Ph(Je)){const or=Pv(xe,c,y,T,Vt,lr,De,nn,sn,qe,we,Xo.horizontal,!1,dn,ue,$t);or&&(ge.horizontal[sn]=or)}Zn(dn==="point"?"left":sn)}}let Be=!1;if(Ft.icon&&Ft.icon.name){const Je=_[Ft.icon.name];Je&&(_e=eU(T[Ft.icon.name],ht.get("icon-offset").evaluate(Ft,{},W),ht.get("icon-anchor").evaluate(Ft,{},W)),Be=Je.sdf,g.sdfIcons===void 0?g.sdfIcons=Je.sdf:g.sdfIcons!==Je.sdf&&lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Je.pixelRatio!==g.pixelRatio||ht.get("icon-rotate").constantOr(1)!==0)&&(g.iconsNeedLinear=!0))}const Oe=aA(ge.horizontal)||ge.vertical;g.iconsInText||(g.iconsInText=!!Oe&&Oe.iconsInText),(Oe||_e)&&hU(g,Ft,ge,_e,_,bt,ue,0,we,Be,z,W,st)}R&&g.generateCollisionDebugBuffers(et,g.collisionBoxArray)}function Lv(g){switch(g){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function hU(g,c,y,_,T,R,z,W,et,st,ht,pt,bt){let Et=R.textMaxSize.evaluate(c,{},pt);Et===void 0&&(Et=z);const kt=g.layers[0].layout,Ft=kt.get("icon-offset").evaluate(c,{},pt),Vt=aA(y.horizontal)||y.vertical,$t=z/24,ue=g.tilePixelRatio*Et/24,ge=(De=g.overscaling,g.zoom>18&&De>2&&(De>>=1),Math.max(tr/(512*De),1)*kt.get("symbol-spacing")),xe=kt.get("text-padding")*g.tilePixelRatio,_e=kt.get("icon-padding")*g.tilePixelRatio,we=x(kt.get("text-max-angle")),Be=kt.get("text-rotation-alignment")==="map"&&kt.get("symbol-placement")!=="point",Oe=kt.get("icon-rotation-alignment")==="map"&&kt.get("symbol-placement")!=="point",Je=kt.get("symbol-placement"),tn=ge/2;var De;const qe=kt.get("icon-text-fit");let nn;_&&qe!=="none"&&(g.allowVerticalPlacement&&y.vertical&&(nn=Y3(_,y.vertical,qe,kt.get("icon-text-fit-padding"),Ft,$t)),Vt&&(_=Y3(_,Vt,qe,kt.get("icon-text-fit-padding"),Ft,$t)));const fn=(sn,dn,Kn)=>{if(dn.x<0||dn.x>=tr||dn.y<0||dn.y>=tr)return;const{x:lr,y:Zn,z:or}=bt.projectTilePoint(dn.x,dn.y,Kn),Cn=new Fa(lr,Zn,or,0,void 0);(function(bn,hr,vr,oi,Rr,si,xr,fr,Sr,Hr,Zr,ai,bi,Ro,ho,Er,Ki,ko,_i,vi,Fr,kr,fo,Zi,ei){const Ji=bn.addToLineVertexArray(hr,oi);let Ui,xi,is,Rl,Bp,Fp,GA,HA=0,WA=0,qA=0,XA=0,Jv=-1,$v=-1;const ia={};let YA=Js(""),Qv=0,tx=0;if(Sr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Qv,tx]=Sr.layout.get("text-offset").evaluate(Fr,{},ei).map(Io=>Io*ki):(Qv=Sr.layout.get("text-radial-offset").evaluate(Fr,{},ei)*ki,tx=Iv),bn.allowVerticalPlacement&&Rr.vertical){const Io=Rr.vertical;if(ho)Fp=Bv(Io),fr&&(GA=Bv(fr));else{const Lo=Sr.layout.get("text-rotate").evaluate(Fr,{},ei)+90;is=s1(Hr,vr,hr,Zr,ai,bi,Io,Ro,Lo,Er),fr&&(Rl=s1(Hr,vr,hr,Zr,ai,bi,fr,ko,Lo))}}if(si){const Io=Sr.layout.get("icon-rotate").evaluate(Fr,{},ei),Lo=Sr.layout.get("icon-text-fit")!=="none",Np=rA(si,Io,fo,Lo),nx=fr?rA(fr,Io,fo,Lo):void 0;xi=s1(Hr,vr,hr,Zr,ai,bi,si,ko,Io),HA=4*Np.length;const KA=bn.iconSizeData;let Wc=null;KA.kind==="source"?(Wc=[ta*Sr.layout.get("icon-size").evaluate(Fr,{},ei)],Wc[0]>Sl&&lt(`${bn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):KA.kind==="composite"&&(Wc=[ta*kr.compositeIconSizes[0].evaluate(Fr,{},ei),ta*kr.compositeIconSizes[1].evaluate(Fr,{},ei)],(Wc[0]>Sl||Wc[1]>Sl)&&lt(`${bn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),bn.addSymbols(bn.icon,Np,Wc,vi,_i,Fr,!1,vr,hr,Ji.lineStartIndex,Ji.lineLength,-1,Zi,ei),Jv=bn.icon.placedSymbolArray.length-1,nx&&(WA=4*nx.length,bn.addSymbols(bn.icon,nx,Wc,vi,_i,Fr,Xo.vertical,vr,hr,Ji.lineStartIndex,Ji.lineLength,-1,Zi,ei),$v=bn.icon.placedSymbolArray.length-1)}for(const Io in Rr.horizontal){const Lo=Rr.horizontal[Io];Ui||(YA=Js(Lo.text),ho?Bp=Bv(Lo):Ui=s1(Hr,vr,hr,Zr,ai,bi,Lo,Ro,Sr.layout.get("text-rotate").evaluate(Fr,{},ei),Er));const Np=Lo.positionedLines.length===1;if(qA+=sA(bn,vr,hr,Lo,xr,Sr,ho,Fr,Er,Ji,Rr.vertical?Xo.horizontal:Xo.horizontalOnly,Np?Object.keys(Rr.horizontal):[Io],ia,Jv,kr,Zi,ei),Np)break}Rr.vertical&&(XA+=sA(bn,vr,hr,Rr.vertical,xr,Sr,ho,Fr,Er,Ji,Xo.vertical,["vertical"],ia,$v,kr,Zi,ei));let kl=-1;const ex=(Io,Lo)=>Io?Math.max(Io,Lo):Lo;kl=ex(Bp,kl),kl=ex(Fp,kl),kl=ex(GA,kl);const WU=kl>-1?1:0;bn.glyphOffsetArray.length>=El.MAX_GLYPHS&&lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fr.sortKey!==void 0&&bn.addToSortKeyRanges(bn.symbolInstances.length,Fr.sortKey),bn.symbolInstances.emplaceBack(vr.x,vr.y,vr.z,hr.x,hr.y,ia.right>=0?ia.right:-1,ia.center>=0?ia.center:-1,ia.left>=0?ia.left:-1,ia.vertical>=0?ia.vertical:-1,Jv,$v,YA,Ui!==void 0?Ui:bn.collisionBoxArray.length,Ui!==void 0?Ui+1:bn.collisionBoxArray.length,is!==void 0?is:bn.collisionBoxArray.length,is!==void 0?is+1:bn.collisionBoxArray.length,xi!==void 0?xi:bn.collisionBoxArray.length,xi!==void 0?xi+1:bn.collisionBoxArray.length,Rl||bn.collisionBoxArray.length,Rl?Rl+1:bn.collisionBoxArray.length,Zr,qA,XA,HA,WA,WU,0,Qv,tx,kl)})(g,dn,Cn,sn,y,_,T,nn,g.layers[0],g.collisionBoxArray,c.index,c.sourceLayerIndex,g.index,xe,Be,et,0,_e,Oe,Ft,c,R,st,ht,pt)};if(Je==="line")for(const sn of tA(c.geometry,0,0,tr,tr)){const dn=rU(sn,ge,we,y.vertical||Vt,_,24,ue,g.overscaling,tr);for(const Kn of dn){const lr=Vt;lr&&dU(g,lr.text,tn,Kn)||fn(sn,Kn,pt)}}else if(Je==="line-center"){for(const sn of c.geometry)if(sn.length>1){const dn=nU(sn,we,y.vertical||Vt,_,24,ue);dn&&fn(sn,dn,pt)}}else if(c.type==="Polygon")for(const sn of wv(c.geometry,0)){const dn=aU(sn,16);fn(sn[0],new Fa(dn.x,dn.y,0,0,void 0),pt)}else if(c.type==="LineString")for(const sn of c.geometry)fn(sn,new Fa(sn[0].x,sn[0].y,0,0,void 0),pt);else if(c.type==="Point")for(const sn of c.geometry)for(const dn of sn)fn([dn],new Fa(dn.x,dn.y,0,0,void 0),pt)}const Sl=32640;function sA(g,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft,Vt){const $t=function(xe,_e,we,Be,Oe,Je,tn,De){const qe=[];if(_e.positionedLines.length===0)return qe;const nn=Be.layout.get("text-rotate").evaluate(Je,{})*Math.PI/180,fn=function(Zn){const or=Zn[0],Cn=Zn[1],bn=or*Cn;return bn>0?[or,-Cn]:bn<0?[-or,Cn]:or===0?[Cn,or]:[Cn,-or]}(we);let sn=Math.abs(_e.top-_e.bottom);for(const Zn of _e.positionedLines)sn-=Zn.lineOffset;const dn=_e.positionedLines.length,Kn=sn/dn;let lr=_e.top-we[1];for(let Zn=0;Zn<dn;++Zn){const or=_e.positionedLines[Zn];lr=iU(_e,Kn,lr,Zn);for(const Cn of or.positionedGlyphs){if(!Cn.rect)continue;const bn=Cn.rect||{};let hr=4,vr=!0,oi=1,Rr=0;if(Cn.imageName){const kr=tn[Cn.imageName];if(!kr)continue;if(kr.sdf){lt("SDF images are not supported in formatted text and will be ignored.");continue}vr=!1,oi=kr.pixelRatio,hr=1/oi}const si=(Oe||De)&&Cn.vertical,xr=Cn.metrics.advance*Cn.scale/2,fr=Cn.metrics,Sr=Cn.rect;if(Sr===null)continue;De&&_e.verticalizable&&(Rr=Cn.imageName?xr-Cn.metrics.width*Cn.scale/2:0);const Hr=Oe?[Cn.x+xr,Cn.y]:[0,0];let Zr=[0,0],ai=[0,0],bi=!1;Oe||(si?(ai=[Cn.x+xr+fn[0],Cn.y+fn[1]-Rr],bi=!0):Zr=[Cn.x+xr+we[0],Cn.y+we[1]-Rr]);const Ro=Sr.w*Cn.scale/(oi*(Cn.localGlyph?2:1)),ho=Sr.h*Cn.scale/(oi*(Cn.localGlyph?2:1));let Er,Ki,ko,_i;if(si){const kr=Cn.y-lr,fo=new f(-xr,xr-kr),Zi=-Math.PI/2,ei=new f(...ai);Er=new f(-xr+Zr[0],Zr[1]),Er._rotateAround(Zi,fo)._add(ei),Er.x+=-kr+xr,Er.y-=(fr.left-hr)*Cn.scale;const Ji=Cn.imageName?fr.advance*Cn.scale:ki*Cn.scale,Ui=String.fromCharCode(Cn.glyph);zz(Ui)?Er.x+=(1-hr)*Cn.scale:Uz(Ui)?Er.x+=Ji-fr.height*Cn.scale+(-hr-1)*Cn.scale:Er.x+=Cn.imageName||fr.width+2*hr===Sr.w&&fr.height+2*hr===Sr.h?(Ji-ho)/2:(Ji-(fr.height+2*hr)*Cn.scale)/2,Ki=new f(Er.x,Er.y-Ro),ko=new f(Er.x+ho,Er.y),_i=new f(Er.x+ho,Er.y-Ro)}else{const kr=(fr.left-hr)*Cn.scale-xr+Zr[0],fo=(-fr.top-hr)*Cn.scale+Zr[1],Zi=kr+Ro,ei=fo+ho;Er=new f(kr,fo),Ki=new f(Zi,fo),ko=new f(kr,ei),_i=new f(Zi,ei)}if(nn){let kr;kr=Oe?new f(0,0):bi?new f(fn[0],fn[1]):new f(we[0],we[1]),Er._rotateAround(nn,kr),Ki._rotateAround(nn,kr),ko._rotateAround(nn,kr),_i._rotateAround(nn,kr)}const vi=new f(0,0),Fr=new f(0,0);qe.push({tl:Er,tr:Ki,bl:ko,br:_i,tex:bn,writingMode:_e.writingMode,glyphOffset:Hr,sectionIndex:Cn.sectionIndex,isSDF:vr,pixelOffsetTL:vi,pixelOffsetBR:Fr,minFontScaleX:0,minFontScaleY:0})}}return qe}(0,_,et,R,z,W,T,g.allowVerticalPlacement),ue=g.textSizeData;let ge=null;ue.kind==="source"?(ge=[ta*R.layout.get("text-size").evaluate(W,{},Vt)],ge[0]>Sl&&lt(`${g.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ue.kind==="composite"&&(ge=[ta*kt.compositeTextSizes[0].evaluate(W,{},Vt),ta*kt.compositeTextSizes[1].evaluate(W,{},Vt)],(ge[0]>Sl||ge[1]>Sl)&&lt(`${g.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),g.addSymbols(g.text,$t,ge,et,z,W,ht,c,y,st.lineStartIndex,st.lineLength,Et,Ft,Vt);for(const xe of pt)bt[xe]=g.text.placedSymbolArray.length-1;return 4*$t.length}function aA(g){for(const c in g)return g[c];return null}function s1(g,c,y,_,T,R,z,W,et,st){let ht=z.top,pt=z.bottom,bt=z.left,Et=z.right;const kt=z.collisionPadding;if(kt&&(bt-=kt[0],ht-=kt[1],Et+=kt[2],pt+=kt[3]),et){const Ft=new f(bt,ht),Vt=new f(Et,ht),$t=new f(bt,pt),ue=new f(Et,pt),ge=x(et);let xe=new f(0,0);st&&(xe=new f(st[0],st[1])),Ft._rotateAround(ge,xe),Vt._rotateAround(ge,xe),$t._rotateAround(ge,xe),ue._rotateAround(ge,xe),bt=Math.min(Ft.x,Vt.x,$t.x,ue.x),Et=Math.max(Ft.x,Vt.x,$t.x,ue.x),ht=Math.min(Ft.y,Vt.y,$t.y,ue.y),pt=Math.max(Ft.y,Vt.y,$t.y,ue.y)}return g.emplaceBack(c.x,c.y,c.z,y.x,y.y,bt,ht,Et,pt,W,_,T,R),g.length-1}function Bv(g){g.collisionPadding&&(g.top-=g.collisionPadding[1],g.bottom+=g.collisionPadding[3]);const c=g.bottom-g.top;return c>0?Math.max(10,c):null}function dU(g,c,y,_){const T=g.compareText;if(c in T){const R=T[c];for(let z=R.length-1;z>=0;z--)if(_.dist(R[z])<y)return!0}else T[c]=[];return T[c].push(_),!1}const fU=jc.VectorTileFeature.types,pU=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function a1(g,c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt,Ft){const Vt=ht?Math.min(Sl,Math.round(ht[0])):0,$t=ht?Math.min(Sl,Math.round(ht[1])):0;g.emplaceBack(c,y,Math.round(32*z),Math.round(32*W),et,st,(Vt<<1)+(pt?1:0),$t,16*bt,16*Et,256*kt,256*Ft,_,T,R,0)}function Fv(g,c,y){g.emplaceBack(c.x,c.y,y),g.emplaceBack(c.x,c.y,y),g.emplaceBack(c.x,c.y,y),g.emplaceBack(c.x,c.y,y)}function mU(g){for(const c of g.sections)if(Jb(c.text))return!0;return!1}class Nv{constructor(c){this.layoutVertexArray=new Ne,this.indexArray=new _n,this.programConfigurations=c,this.segments=new Kr,this.dynamicLayoutVertexArray=new cn,this.opacityVertexArray=new Se,this.placedSymbolArray=new ws}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,y,_,T){this.isEmpty()||(_&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,kz.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,y),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,Iz.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,pU,!0),this.opacityVertexBuffer.itemSize=1),(_||T)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xn(Nv,"SymbolBuffers");class Ov{constructor(c,y,_){this.layoutVertexArray=new c,this.layoutAttributes=y,this.indexArray=new _,this.segments=new Kr,this.collisionVertexArray=new He,this.collisionVertexArrayExt=new cn}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,Lz.members,!0),this.collisionVertexBufferExt=c.createVertexBuffer(this.collisionVertexArrayExt,Bz.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}xn(Ov,"CollisionBuffers");class El{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(z=>z.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Qs([]),this.placementViewportMatrix=Qs([]);const y=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sv(this.zoom,y["text-size"]),this.iconSizeData=Sv(this.zoom,y["icon-size"]);const _=this.layers[0].layout,T=_.get("symbol-sort-key"),R=_.get("symbol-z-order");this.canOverlap=_.get("text-allow-overlap")||_.get("icon-allow-overlap")||_.get("text-ignore-placement")||_.get("icon-ignore-placement"),this.sortFeaturesByKey=R!=="viewport-y"&&T.constantOr(1)!==void 0,this.sortFeaturesByY=(R==="viewport-y"||R==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=_.get("text-writing-mode").map(z=>Xo[z]),this.stateDependentLayerIds=this.layers.filter(z=>z.isStateDependent()).map(z=>z.id),this.sourceID=c.sourceID,this.projection=c.projection}createArrays(){this.text=new Nv(new Oc(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new Nv(new Oc(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new br,this.lineVertexArray=new Qr,this.symbolInstances=new Yr}calculateGlyphDependencies(c,y,_,T,R){for(let z=0;z<c.length;z++)if(y[c.charCodeAt(z)]=!0,T&&R){const W=Mp[c.charAt(z)];W&&(y[W.charCodeAt(0)]=!0)}}populate(c,y,_,T){const R=this.layers[0],z=R.layout,W=z.get("text-font"),et=z.get("text-field"),st=z.get("icon-image"),ht=(et.value.kind!=="constant"||et.value.value instanceof $n&&!et.value.value.isEmpty()||et.value.value.toString().length>0)&&(W.value.kind!=="constant"||W.value.value.length>0),pt=st.value.kind!=="constant"||!!st.value.value||Object.keys(st.parameters).length>0,bt=z.get("symbol-sort-key");if(this.features=[],!ht&&!pt)return;const Et=y.iconDependencies,kt=y.glyphDependencies,Ft=y.availableImages,Vt=new Dr(this.zoom);for(const{feature:$t,id:ue,index:ge,sourceLayerIndex:xe}of c){const _e=R._featureFilter.needGeometry,we=zc($t,_e);if(!R._featureFilter.filter(Vt,we,_))continue;let Be,Oe;if(_e||(we.geometry=Ia($t,_,T)),ht){const tn=R.getValueAndResolveTokens("text-field",we,_,Ft),De=$n.factory(tn);mU(De)&&(this.hasRTLText=!0),(!this.hasRTLText||Ih()==="unavailable"||this.hasRTLText&&So.isParsed())&&(Be=Oz(De,R,we))}if(pt){const tn=R.getValueAndResolveTokens("icon-image",we,_,Ft);Oe=tn instanceof rr?tn:rr.fromString(tn)}if(!Be&&!Oe)continue;const Je=this.sortFeaturesByKey?bt.evaluate(we,{},_):void 0;if(this.features.push({id:ue,text:Be,icon:Oe,index:ge,sourceLayerIndex:xe,geometry:we.geometry,properties:$t.properties,type:fU[$t.type],sortKey:Je}),Oe&&(Et[Oe.name]=!0),Be){const tn=W.evaluate(we,{},_).join(","),De=z.get("text-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Xo.vertical)>=0;for(const qe of Be.sections)if(qe.image)Et[qe.image.name]=!0;else{const nn=Ph(Be.toString()),fn=qe.fontStack||tn,sn=kt[fn]=kt[fn]||{};this.calculateGlyphDependencies(qe.text,sn,De,this.allowVerticalPlacement,nn)}}}z.get("symbol-placement")==="line"&&(this.features=function($t){const ue={},ge={},xe=[];let _e=0;function we(tn){xe.push($t[tn]),_e++}function Be(tn,De,qe){const nn=ge[tn];return delete ge[tn],ge[De]=nn,xe[nn].geometry[0].pop(),xe[nn].geometry[0]=xe[nn].geometry[0].concat(qe[0]),nn}function Oe(tn,De,qe){const nn=ue[De];return delete ue[De],ue[tn]=nn,xe[nn].geometry[0].shift(),xe[nn].geometry[0]=qe[0].concat(xe[nn].geometry[0]),nn}function Je(tn,De,qe){const nn=qe?De[0][De[0].length-1]:De[0][0];return`${tn}:${nn.x}:${nn.y}`}for(let tn=0;tn<$t.length;tn++){const De=$t[tn],qe=De.geometry,nn=De.text?De.text.toString():null;if(!nn){we(tn);continue}const fn=Je(nn,qe),sn=Je(nn,qe,!0);if(fn in ge&&sn in ue&&ge[fn]!==ue[sn]){const dn=Oe(fn,sn,qe),Kn=Be(fn,sn,xe[dn].geometry);delete ue[fn],delete ge[sn],ge[Je(nn,xe[Kn].geometry,!0)]=Kn,xe[dn].geometry=null}else fn in ge?Be(fn,sn,qe):sn in ue?Oe(fn,sn,qe):(we(tn),ue[fn]=_e-1,ge[sn]=_e-1)}return xe.filter(tn=>tn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort(($t,ue)=>$t.sortKey-ue.sortKey)}update(c,y,_,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,y,this.layers,_,T),this.icon.programConfigurations.updatePaintArrays(c,y,this.layers,_,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,y){const _=this.lineVertexArray.length,T=c.segment;if(T!==void 0){let R=c.dist(y[T+1]),z=c.dist(y[T]);const W={};for(let et=T+1;et<y.length;et++)W[et]={x:y[et].x,y:y[et].y,tileUnitDistanceFromAnchor:R},et<y.length-1&&(R+=y[et+1].dist(y[et]));for(let et=T||0;et>=0;et--)W[et]={x:y[et].x,y:y[et].y,tileUnitDistanceFromAnchor:z},et>0&&(z+=y[et-1].dist(y[et]));for(let et=0;et<y.length;et++){const st=W[et];this.lineVertexArray.emplaceBack(st.x,st.y,st.tileUnitDistanceFromAnchor)}}return{lineStartIndex:_,lineLength:this.lineVertexArray.length-_}}addSymbols(c,y,_,T,R,z,W,et,st,ht,pt,bt,Et,kt){const Ft=c.indexArray,Vt=c.layoutVertexArray,$t=c.segments.prepareSegment(4*y.length,Vt,Ft,this.canOverlap?z.sortKey:void 0),ue=this.glyphOffsetArray.length,ge=$t.vertexLength,xe=this.allowVerticalPlacement&&W===Xo.vertical?Math.PI/2:0,_e=z.text&&z.text.sections;for(let we=0;we<y.length;we++){const{tl:Be,tr:Oe,bl:Je,br:tn,tex:De,pixelOffsetTL:qe,pixelOffsetBR:nn,minFontScaleX:fn,minFontScaleY:sn,glyphOffset:dn,isSDF:Kn,sectionIndex:lr}=y[we],Zn=$t.vertexLength,or=dn[1];a1(Vt,et.x,et.y,et.z,st.x,st.y,Be.x,or+Be.y,De.x,De.y,_,Kn,qe.x,qe.y,fn,sn),a1(Vt,et.x,et.y,et.z,st.x,st.y,Oe.x,or+Oe.y,De.x+De.w,De.y,_,Kn,nn.x,qe.y,fn,sn),a1(Vt,et.x,et.y,et.z,st.x,st.y,Je.x,or+Je.y,De.x,De.y+De.h,_,Kn,qe.x,nn.y,fn,sn),a1(Vt,et.x,et.y,et.z,st.x,st.y,tn.x,or+tn.y,De.x+De.w,De.y+De.h,_,Kn,nn.x,nn.y,fn,sn),Fv(c.dynamicLayoutVertexArray,et,xe),Ft.emplaceBack(Zn,Zn+1,Zn+2),Ft.emplaceBack(Zn+1,Zn+2,Zn+3),$t.vertexLength+=4,$t.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(dn[0]),we!==y.length-1&&lr===y[we+1].sectionIndex||c.programConfigurations.populatePaintArrays(Vt.length,z,z.index,{},Et,kt,_e&&_e[lr])}c.placedSymbolArray.emplaceBack(et.x,et.y,et.z,st.x,st.y,ue,this.glyphOffsetArray.length-ue,ge,ht,pt,st.segment,_?_[0]:0,_?_[1]:0,T[0],T[1],W,0,!1,0,bt,0)}_commitLayoutVertex(c,y,_,T,R,z,W){c.emplaceBack(y,_,T,R,z,Math.round(W.x),Math.round(W.y))}_addCollisionDebugVertices(c,y,_,T,R,z,W){const et=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),st=et.vertexLength,ht=W.tileAnchorX,pt=W.tileAnchorY;for(let Et=0;Et<4;Et++)_.collisionVertexArray.emplaceBack(0,0,0,0);_.collisionVertexArrayExt.emplaceBack(y,-c.padding,-c.padding),_.collisionVertexArrayExt.emplaceBack(y,c.padding,-c.padding),_.collisionVertexArrayExt.emplaceBack(y,c.padding,c.padding),_.collisionVertexArrayExt.emplaceBack(y,-c.padding,c.padding),this._commitLayoutVertex(_.layoutVertexArray,T,R,z,ht,pt,new f(c.x1,c.y1)),this._commitLayoutVertex(_.layoutVertexArray,T,R,z,ht,pt,new f(c.x2,c.y1)),this._commitLayoutVertex(_.layoutVertexArray,T,R,z,ht,pt,new f(c.x2,c.y2)),this._commitLayoutVertex(_.layoutVertexArray,T,R,z,ht,pt,new f(c.x1,c.y2)),et.vertexLength+=4;const bt=_.indexArray;bt.emplaceBack(st,st+1),bt.emplaceBack(st+1,st+2),bt.emplaceBack(st+2,st+3),bt.emplaceBack(st+3,st),et.primitiveLength+=4}_addTextDebugCollisionBoxes(c,y,_,T,R,z){for(let W=T;W<R;W++){const et=_.get(W),st=this.getSymbolInstanceTextSize(c,z,y,W);this._addCollisionDebugVertices(et,st,this.textCollisionBox,et.projectedAnchorX,et.projectedAnchorY,et.projectedAnchorZ,z)}}_addIconDebugCollisionBoxes(c,y,_,T,R,z){for(let W=T;W<R;W++){const et=_.get(W),st=this.getSymbolInstanceIconSize(c,y,W);this._addCollisionDebugVertices(et,st,this.iconCollisionBox,et.projectedAnchorX,et.projectedAnchorY,et.projectedAnchorZ,z)}}generateCollisionDebugBuffers(c,y){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ov(rn,B3.members,Gn),this.iconCollisionBox=new Ov(rn,B3.members,Gn);const _=Gh(this.iconSizeData,c),T=Gh(this.textSizeData,c);for(let R=0;R<this.symbolInstances.length;R++){const z=this.symbolInstances.get(R);this._addTextDebugCollisionBoxes(T,c,y,z.textBoxStartIndex,z.textBoxEndIndex,z),this._addTextDebugCollisionBoxes(T,c,y,z.verticalTextBoxStartIndex,z.verticalTextBoxEndIndex,z),this._addIconDebugCollisionBoxes(_,c,y,z.iconBoxStartIndex,z.iconBoxEndIndex,z),this._addIconDebugCollisionBoxes(_,c,y,z.verticalIconBoxStartIndex,z.verticalIconBoxEndIndex,z)}}getSymbolInstanceTextSize(c,y,_,T){const R=this.text.placedSymbolArray.get(y.rightJustifiedTextSymbolIndex>=0?y.rightJustifiedTextSymbolIndex:y.centerJustifiedTextSymbolIndex>=0?y.centerJustifiedTextSymbolIndex:y.leftJustifiedTextSymbolIndex>=0?y.leftJustifiedTextSymbolIndex:y.verticalPlacedTextSymbolIndex>=0?y.verticalPlacedTextSymbolIndex:T),z=t1(this.textSizeData,c,R)/ki;return this.tilePixelRatio*z}getSymbolInstanceIconSize(c,y,_){const T=this.icon.placedSymbolArray.get(_),R=t1(this.iconSizeData,c,T);return this.tilePixelRatio*R}_commitDebugCollisionVertexUpdate(c,y,_){c.emplaceBack(y,-_,-_),c.emplaceBack(y,_,-_),c.emplaceBack(y,_,_),c.emplaceBack(y,-_,_)}_updateTextDebugCollisionBoxes(c,y,_,T,R,z){for(let W=T;W<R;W++){const et=_.get(W),st=this.getSymbolInstanceTextSize(c,z,y,W);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,st,et.padding)}}_updateIconDebugCollisionBoxes(c,y,_,T,R){for(let z=T;z<R;z++){const W=_.get(z),et=this.getSymbolInstanceIconSize(c,y,z);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,et,W.padding)}}updateCollisionDebugBuffers(c,y){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=Gh(this.iconSizeData,c),T=Gh(this.textSizeData,c);for(let R=0;R<this.symbolInstances.length;R++){const z=this.symbolInstances.get(R);this._updateTextDebugCollisionBoxes(T,c,y,z.textBoxStartIndex,z.textBoxEndIndex,z),this._updateTextDebugCollisionBoxes(T,c,y,z.verticalTextBoxStartIndex,z.verticalTextBoxEndIndex,z),this._updateIconDebugCollisionBoxes(_,c,y,z.iconBoxStartIndex,z.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(_,c,y,z.verticalIconBoxStartIndex,z.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(c,y,_,T,R,z,W,et,st){const ht={};for(let pt=y;pt<_;pt++){const bt=c.get(pt);ht.textBox={x1:bt.x1,y1:bt.y1,x2:bt.x2,y2:bt.y2,padding:bt.padding,projectedAnchorX:bt.projectedAnchorX,projectedAnchorY:bt.projectedAnchorY,projectedAnchorZ:bt.projectedAnchorZ,tileAnchorX:bt.tileAnchorX,tileAnchorY:bt.tileAnchorY},ht.textFeatureIndex=bt.featureIndex;break}for(let pt=T;pt<R;pt++){const bt=c.get(pt);ht.verticalTextBox={x1:bt.x1,y1:bt.y1,x2:bt.x2,y2:bt.y2,padding:bt.padding,projectedAnchorX:bt.projectedAnchorX,projectedAnchorY:bt.projectedAnchorY,projectedAnchorZ:bt.projectedAnchorZ,tileAnchorX:bt.tileAnchorX,tileAnchorY:bt.tileAnchorY},ht.verticalTextFeatureIndex=bt.featureIndex;break}for(let pt=z;pt<W;pt++){const bt=c.get(pt);ht.iconBox={x1:bt.x1,y1:bt.y1,x2:bt.x2,y2:bt.y2,padding:bt.padding,projectedAnchorX:bt.projectedAnchorX,projectedAnchorY:bt.projectedAnchorY,projectedAnchorZ:bt.projectedAnchorZ,tileAnchorX:bt.tileAnchorX,tileAnchorY:bt.tileAnchorY},ht.iconFeatureIndex=bt.featureIndex;break}for(let pt=et;pt<st;pt++){const bt=c.get(pt);ht.verticalIconBox={x1:bt.x1,y1:bt.y1,x2:bt.x2,y2:bt.y2,padding:bt.padding,projectedAnchorX:bt.projectedAnchorX,projectedAnchorY:bt.projectedAnchorY,projectedAnchorZ:bt.projectedAnchorZ,tileAnchorX:bt.tileAnchorX,tileAnchorY:bt.tileAnchorY},ht.verticalIconFeatureIndex=bt.featureIndex;break}return ht}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let y=0;y<this.symbolInstances.length;y++){const _=this.symbolInstances.get(y);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,_.textBoxStartIndex,_.textBoxEndIndex,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_.iconBoxStartIndex,_.iconBoxEndIndex,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,y){const _=c.placedSymbolArray.get(y),T=_.vertexStartIndex+4*_.numGlyphs;for(let R=_.vertexStartIndex;R<T;R+=4)c.indexArray.emplaceBack(R,R+1,R+2),c.indexArray.emplaceBack(R+1,R+2,R+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const y=Math.sin(c),_=Math.cos(c),T=[],R=[],z=[];for(let W=0;W<this.symbolInstances.length;++W){z.push(W);const et=this.symbolInstances.get(W);T.push(0|Math.round(y*et.tileAnchorX+_*et.tileAnchorY)),R.push(et.featureIndex)}return z.sort((W,et)=>T[W]-T[et]||R[et]-R[W]),z}addToSortKeyRanges(c,y){const _=this.sortKeyRanges[this.sortKeyRanges.length-1];_&&_.sortKey===y?_.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:y,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const y of this.symbolInstanceIndexes){const _=this.symbolInstances.get(y);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach((T,R,z)=>{T>=0&&z.indexOf(T)===R&&this.addIndicesForPlacedSymbol(this.text,T)}),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}xn(El,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),El.MAX_GLYPHS=65535,El.addDynamicAttributes=Fv;const gU=new Pt({"symbol-placement":new ot(Yt.layout_symbol["symbol-placement"]),"symbol-spacing":new ot(Yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ot(Yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(Yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ot(Yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ot(Yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ot(Yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ot(Yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ot(Yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(Yt.layout_symbol["icon-size"]),"icon-text-fit":new ot(Yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ot(Yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(Yt.layout_symbol["icon-image"]),"icon-rotate":new ct(Yt.layout_symbol["icon-rotate"]),"icon-padding":new ot(Yt.layout_symbol["icon-padding"]),"icon-keep-upright":new ot(Yt.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(Yt.layout_symbol["icon-offset"]),"icon-anchor":new ct(Yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ot(Yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ot(Yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ot(Yt.layout_symbol["text-rotation-alignment"]),"text-field":new ct(Yt.layout_symbol["text-field"]),"text-font":new ct(Yt.layout_symbol["text-font"]),"text-size":new ct(Yt.layout_symbol["text-size"]),"text-max-width":new ct(Yt.layout_symbol["text-max-width"]),"text-line-height":new ct(Yt.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(Yt.layout_symbol["text-letter-spacing"]),"text-justify":new ct(Yt.layout_symbol["text-justify"]),"text-radial-offset":new ct(Yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ot(Yt.layout_symbol["text-variable-anchor"]),"text-anchor":new ct(Yt.layout_symbol["text-anchor"]),"text-max-angle":new ot(Yt.layout_symbol["text-max-angle"]),"text-writing-mode":new ot(Yt.layout_symbol["text-writing-mode"]),"text-rotate":new ct(Yt.layout_symbol["text-rotate"]),"text-padding":new ot(Yt.layout_symbol["text-padding"]),"text-keep-upright":new ot(Yt.layout_symbol["text-keep-upright"]),"text-transform":new ct(Yt.layout_symbol["text-transform"]),"text-offset":new ct(Yt.layout_symbol["text-offset"]),"text-allow-overlap":new ot(Yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ot(Yt.layout_symbol["text-ignore-placement"]),"text-optional":new ot(Yt.layout_symbol["text-optional"])});var zv={paint:new Pt({"icon-opacity":new ct(Yt.paint_symbol["icon-opacity"]),"icon-color":new ct(Yt.paint_symbol["icon-color"]),"icon-halo-color":new ct(Yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(Yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(Yt.paint_symbol["icon-halo-blur"]),"icon-translate":new ot(Yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ot(Yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(Yt.paint_symbol["text-opacity"]),"text-color":new ct(Yt.paint_symbol["text-color"],{runtimeType:Ie,getOverride:g=>g.textColor,hasOverride:g=>!!g.textColor}),"text-halo-color":new ct(Yt.paint_symbol["text-halo-color"]),"text-halo-width":new ct(Yt.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(Yt.paint_symbol["text-halo-blur"]),"text-translate":new ot(Yt.paint_symbol["text-translate"]),"text-translate-anchor":new ot(Yt.paint_symbol["text-translate-anchor"])}),layout:gU};class lA{constructor(c){this.type=c.property.overrides?c.property.overrides.runtimeType:ye,this.defaultValue=c}evaluate(c){if(c.formattedSection){const y=this.defaultValue.property.overrides;if(y&&y.hasOverride(c.formattedSection))return y.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xn(lA,"FormatSectionOverride",{omit:["defaultValue"]});class l1 extends As{constructor(c){super(c,zv)}recalculate(c,y){super.recalculate(c,y),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const _=this.layout.get("text-writing-mode");if(_){const T=[];for(const R of _)T.indexOf(R)<0&&T.push(R);this.layout._values["text-writing-mode"]=T}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(c,y,_,T){const R=this.layout.get(c).evaluate(y,{},_,T),z=this._unevaluatedLayout._values[c];return z.isDataDriven()||dl(z.value)||!R?R:function(W,et){return et.replace(/{([^{}]+)}/g,(st,ht)=>ht in W?String(W[ht]):"")}(y.properties,R)}createBucket(c){return new El(c)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const c of zv.paint.overridableProperties){if(!l1.hasPaintOverride(this.layout,c))continue;const y=this.paint.get(c),_=new lA(y),T=new vh(_,y.property.specification);let R=null;R=y.value.kind==="constant"||y.value.kind==="source"?new Uf("source",T):new Vf("composite",T,y.value.zoomStops,y.value._interpolationType),this.paint._values[c]=new X(y.property,R,y.parameters)}}_handleOverridablePaintPropertyUpdate(c,y,_){return!(!this.layout||y.isDataDriven()||_.isDataDriven())&&l1.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,y){const _=c.get("text-field"),T=zv.paint.properties[y];let R=!1;const z=W=>{for(const et of W)if(T.overrides&&T.overrides.hasOverride(et))return void(R=!0)};if(_.value.kind==="constant"&&_.value.value instanceof $n)z(_.value.value.sections);else if(_.value.kind==="source"){const W=st=>{R||(st instanceof di&&Lr(st.value)===Wn?z(st.value.sections):st instanceof ro?z(st.sections):st.eachChild(W))},et=_.value;et._styleExpression&&W(et._styleExpression.expression)}return R}getProgramConfiguration(c){return new _l(this,c)}}var yU={paint:new Pt({"background-color":new ot(Yt.paint_background["background-color"]),"background-pattern":new xt(Yt.paint_background["background-pattern"]),"background-opacity":new ot(Yt.paint_background["background-opacity"])})},bU={paint:new Pt({"raster-opacity":new ot(Yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ot(Yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ot(Yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ot(Yt.paint_raster["raster-brightness-max"]),"raster-saturation":new ot(Yt.paint_raster["raster-saturation"]),"raster-contrast":new ot(Yt.paint_raster["raster-contrast"]),"raster-resampling":new ot(Yt.paint_raster["raster-resampling"]),"raster-fade-duration":new ot(Yt.paint_raster["raster-fade-duration"])})};class vU extends As{constructor(c){super(c,{}),this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(c){this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)}onRemove(c){this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)}}var xU={paint:new Pt({"sky-type":new ot(Yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ot(Yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ot(Yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ot(Yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ot(Yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mt(Yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ot(Yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ot(Yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ot(Yt.paint_sky["sky-opacity"])})};function Uv(g,c,y){const _=[0,0,1],T=p3([]);return function(R,z,W){W*=.5;var et=z[0],st=z[1],ht=z[2],pt=z[3],bt=Math.sin(W),Et=Math.cos(W);R[0]=et*Et-ht*bt,R[1]=st*Et+pt*bt,R[2]=ht*Et+et*bt,R[3]=pt*Et-st*bt}(T,T,y?-x(g)+Math.PI:x(g)),m3(T,T,-x(c)),d3(_,_,T),dp(_,_)}const _U={circle:class extends As{constructor(g){super(g,UO)}createBucket(g){return new ov(g)}queryRadius(g){const c=g;return Oh("circle-radius",this,c)+Oh("circle-stroke-width",this,c)+W0(this.paint.get("circle-translate"))}queryIntersectsFeature(g,c,y,_,T,R,z,W){const et=i3(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),R.angle,g.pixelToTileUnitsFactor),st=this.paint.get("circle-radius").evaluate(c,y)+this.paint.get("circle-stroke-width").evaluate(c,y);return g3(g,_,R,z,W,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",et,st)}getProgramIds(){return["circle"]}getProgramConfiguration(g){return new _l(this,g)}},heatmap:class extends As{createBucket(g){return new b3(g)}constructor(g){super(g,XO),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(g){g==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=bv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(g){return Oh("heatmap-radius",this,g)}queryIntersectsFeature(g,c,y,_,T,R,z,W){const et=this.paint.get("heatmap-radius").evaluate(c,y);return g3(g,_,R,z,W,!0,!0,new f(0,0),et)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(g){return new _l(this,g)}},hillshade:class extends As{constructor(g){super(g,YO)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends As{constructor(g){super(g,hz)}getProgramIds(){const g=this.paint.get("fill-pattern"),c=g&&g.constantOr(1),y=[c?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&y.push(c&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),y}getProgramConfiguration(g){return new _l(this,g)}recalculate(g,c){super.recalculate(g,c);const y=this.paint._values["fill-outline-color"];y.value.kind==="constant"&&y.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(g){return new J0(g)}queryRadius(){return W0(this.paint.get("fill-translate"))}queryIntersectsFeature(g,c,y,_,T,R){return!g.queryGeometry.isAboveHorizon&&QM(r3(g.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),R.angle,g.pixelToTileUnitsFactor),_)}isTileClipped(){return!0}},"fill-extrusion":class extends As{constructor(g){super(g,Mz)}createBucket(g){return new _p(g)}queryRadius(){return W0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(g){return new _l(this,g)}queryIntersectsFeature(g,c,y,_,T,R,z,W,et){const st=i3(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),R.angle,g.pixelToTileUnitsFactor),ht=this.paint.get("fill-extrusion-height").evaluate(c,y),pt=this.paint.get("fill-extrusion-base").evaluate(c,y),bt=[0,0],Et=W&&R.elevation,kt=R.elevation?R.elevation.exaggeration():1,Ft=g.tile.getBucket(this);if(Et&&Ft instanceof _p){const ue=Ft.centroidVertexArray,ge=et+1;if(ge<ue.length){const xe=ue.get(ge);bt[0]=xe.a_centroid_pos0,bt[1]=xe.a_centroid_pos1}}if(bt[0]===0&&bt[1]===1)return!1;const Vt=function(ue,ge,xe,_e,we,Be,Oe,Je,tn){return Be?function(De,qe,nn,fn,sn,dn,Kn,lr,Zn){const or=[],Cn=[],bn=[0,0,0,1];for(const hr of De){const vr=[],oi=[];for(const Rr of hr){const si=Rr.x+fn.x,xr=Rr.y+fn.y,fr=Az(si,xr,qe,nn,dn,Kn,lr,Zn);bn[0]=si,bn[1]=xr,bn[2]=fr.base,bn[3]=1,Uh(bn,bn,sn),bn[3]=Math.max(bn[3],1e-5);const Sr=R3([bn[0]/bn[3],bn[1]/bn[3],bn[2]/bn[3]]);bn[0]=si,bn[1]=xr,bn[2]=fr.top,bn[3]=1,Uh(bn,bn,sn),bn[3]=Math.max(bn[3],1e-5);const Hr=R3([bn[0]/bn[3],bn[1]/bn[3],bn[2]/bn[3]]);vr.push(Sr),oi.push(Hr)}or.push(vr),Cn.push(oi)}return[or,Cn]}(ue,ge,xe,_e,we,Be,Oe,Je,tn):function(De,qe,nn,fn,sn){const dn=[],Kn=[],lr=sn[8]*qe,Zn=sn[9]*qe,or=sn[10]*qe,Cn=sn[11]*qe,bn=sn[8]*nn,hr=sn[9]*nn,vr=sn[10]*nn,oi=sn[11]*nn;for(const Rr of De){const si=[],xr=[];for(const fr of Rr){const Sr=fr.x+fn.x,Hr=fr.y+fn.y,Zr=sn[0]*Sr+sn[4]*Hr+sn[12],ai=sn[1]*Sr+sn[5]*Hr+sn[13],bi=sn[2]*Sr+sn[6]*Hr+sn[14],Ro=sn[3]*Sr+sn[7]*Hr+sn[15],ho=Zr+lr,Er=ai+Zn,Ki=bi+or,ko=Math.max(Ro+Cn,1e-5),_i=Zr+bn,vi=ai+hr,Fr=bi+vr,kr=Math.max(Ro+oi,1e-5),fo=new f(ho/ko,Er/ko);fo.z=Ki/ko,si.push(fo);const Zi=new f(_i/kr,vi/kr);Zi.z=Fr/kr,xr.push(Zi)}dn.push(si),Kn.push(xr)}return[dn,Kn]}(ue,ge,xe,_e,we)}(_,pt,ht,st,z,Et?W:null,bt,kt,R.center.lat),$t=g.queryGeometry;return function(ue,ge,xe){let _e=1/0;QM(xe,ge)&&(_e=D3(xe,ge[0]));for(let we=0;we<ge.length;we++){const Be=ge[we],Oe=ue[we];for(let Je=0;Je<Be.length-1;Je++){const tn=Be[Je],De=[tn,Be[Je+1],Oe[Je+1],Oe[Je],tn];$M(xe,De)&&(_e=Math.min(_e,D3(xe,De)))}}return _e!==1/0&&_e}(Vt[0],Vt[1],$t.isPointQuery()?$t.screenBounds:$t.screenGeometry)}},line:class extends As{constructor(g){super(g,k3),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(g){if(g==="line-gradient"){const c=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=c._styleExpression&&c._styleExpression.expression instanceof gc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(g,c){super.recalculate(g,c),this.paint._values["line-floorwidth"]=I3.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)}createBucket(g){return new Q0(g)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(g){return new _l(this,g)}queryRadius(g){const c=g,y=L3(Oh("line-width",this,c),Oh("line-gap-width",this,c)),_=Oh("line-offset",this,c);return y/2+Math.abs(_)+W0(this.paint.get("line-translate"))}queryIntersectsFeature(g,c,y,_,T,R){if(g.queryGeometry.isAboveHorizon)return!1;const z=r3(g.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),R.angle,g.pixelToTileUnitsFactor),W=g.pixelToTileUnitsFactor/2*L3(this.paint.get("line-width").evaluate(c,y),this.paint.get("line-gap-width").evaluate(c,y)),et=this.paint.get("line-offset").evaluate(c,y);return et&&(_=function(st,ht){const pt=[],bt=new f(0,0);for(let Et=0;Et<st.length;Et++){const kt=st[Et],Ft=[];for(let Vt=0;Vt<kt.length;Vt++){const $t=kt[Vt-1],ue=kt[Vt],ge=kt[Vt+1],xe=Vt===0?bt:ue.sub($t)._unit()._perp(),_e=Vt===kt.length-1?bt:ge.sub(ue)._unit()._perp(),we=xe._add(_e)._unit();we._mult(1/(we.x*_e.x+we.y*_e.y)),Ft.push(we._mult(ht)._add(ue))}pt.push(Ft)}return pt}(_,et*g.pixelToTileUnitsFactor)),function(st,ht,pt){for(let bt=0;bt<ht.length;bt++){const Et=ht[bt];if(st.length>=3){for(let kt=0;kt<Et.length;kt++)if(Nh(st,Et[kt]))return!0}if(FO(st,Et,pt))return!0}return!1}(z,_,W)}isTileClipped(){return!0}},symbol:l1,background:class extends As{constructor(g){super(g,yU)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends As{constructor(g){super(g,bU)}getProgramIds(){return["raster"]}},sky:class extends As{constructor(g){super(g,xU),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(g){g==="sky-gradient"?this._updateColorRamp():g!=="sky-atmosphere-sun"&&g!=="sky-atmosphere-halo-color"&&g!=="sky-atmosphere-color"&&g!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=bv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(g){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const c=g.style.light.properties.get("position");return this._lightPosition.azimuthal!==c.azimuthal||this._lightPosition.polar!==c.polar}return!1}getCenter(g,c){if(this.paint.get("sky-type")==="atmosphere"){const _=this.paint.get("sky-atmosphere-sun"),T=!_,R=g.style.light,z=R.properties.get("position");return T&&R.properties.get("anchor")==="viewport"&&lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),T?Uv(z.azimuthal,90-z.polar,c):Uv(_[0],90-_[1],c)}const y=this.paint.get("sky-gradient-center");return Uv(y[0],90-y[1],c)}is3D(){return!1}isSky(){return!0}markSkyboxValid(g){this._skyboxInvalidated=!1,this._lightPosition=g.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const g=this.paint.get("sky-type");return g==="atmosphere"?["skyboxCapture","skybox"]:g==="gradient"?["skyboxGradient"]:null}}};class Tp{constructor(c,y,_,T){this.context=c,this.format=_,this.texture=c.gl.createTexture(),this.update(y,T)}update(c,y,_){const{width:T,height:R}=c,{context:z}=this,{gl:W}=z,{HTMLImageElement:et,HTMLCanvasElement:st,HTMLVideoElement:ht,ImageData:pt,ImageBitmap:bt}=p;if(W.bindTexture(W.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===W.RGBA&&(!y||y.premultiply!==!1)),_||this.size&&this.size[0]===T&&this.size[1]===R){const{x:Et,y:kt}=_||{x:0,y:0};c instanceof et||c instanceof st||c instanceof ht||c instanceof pt||bt&&c instanceof bt?W.texSubImage2D(W.TEXTURE_2D,0,Et,kt,W.RGBA,W.UNSIGNED_BYTE,c):W.texSubImage2D(W.TEXTURE_2D,0,Et,kt,T,R,W.RGBA,W.UNSIGNED_BYTE,c.data)}else this.size=[T,R],c instanceof et||c instanceof st||c instanceof ht||c instanceof pt||bt&&c instanceof bt?W.texImage2D(W.TEXTURE_2D,0,this.format,this.format,W.UNSIGNED_BYTE,c):W.texImage2D(W.TEXTURE_2D,0,this.format,T,R,0,this.format,W.UNSIGNED_BYTE,c.data);this.useMipmap=!!(y&&y.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&W.generateMipmap(W.TEXTURE_2D)}bind(c,y){const{context:_}=this,{gl:T}=_;T.bindTexture(T.TEXTURE_2D,this.texture),c!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,c),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,this.useMipmap?c===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_NEAREST:c),this.filter=c),y!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,y),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,y),this.wrap=y)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class Vv{constructor(c,y){this.width=c,this.height=y,this.nextRow=0,this.image=new La({width:c,height:y}),this.positions={},this.uploaded=!1}getDash(c,y){const _=this.getKey(c,y);return this.positions[_]}trim(){const c=this.width,y=this.height=I(this.nextRow);this.image.resize({width:c,height:y})}getKey(c,y){return c.join(",")+y}getDashRanges(c,y,_){const T=[];let R=c.length%2==1?-c[c.length-1]*_:0,z=c[0]*_,W=!0;T.push({left:R,right:z,isDash:W,zeroLength:c[0]===0});let et=c[0];for(let st=1;st<c.length;st++){W=!W;const ht=c[st];R=et*_,et+=ht,z=et*_,T.push({left:R,right:z,isDash:W,zeroLength:ht===0})}return T}addRoundDash(c,y,_){const T=y/2;for(let R=-_;R<=_;R++){const z=this.width*(this.nextRow+_+R);let W=0,et=c[W];for(let st=0;st<this.width;st++){st/et.right>1&&(et=c[++W]);const ht=Math.abs(st-et.left),pt=Math.abs(st-et.right),bt=Math.min(ht,pt);let Et;const kt=R/_*(T+1);if(et.isDash){const Ft=T-Math.abs(kt);Et=Math.sqrt(bt*bt+Ft*Ft)}else Et=T-Math.sqrt(bt*bt+kt*kt);this.image.data[z+st]=Math.max(0,Math.min(255,Et+128))}}}addRegularDash(c,y){for(let et=c.length-1;et>=0;--et){const st=c[et],ht=c[et+1];st.zeroLength?c.splice(et,1):ht&&ht.isDash===st.isDash&&(ht.left=st.left,c.splice(et,1))}const _=c[0],T=c[c.length-1];_.isDash===T.isDash&&(_.left=T.left-this.width,T.right=_.right+this.width);const R=this.width*this.nextRow;let z=0,W=c[z];for(let et=0;et<this.width;et++){et/W.right>1&&(W=c[++z]);const st=Math.abs(et-W.left),ht=Math.abs(et-W.right),pt=Math.min(st,ht);this.image.data[R+et]=Math.max(0,Math.min(255,(W.isDash?pt:-pt)+y+128))}}addDash(c,y){const _=this.getKey(c,y);if(this.positions[_])return this.positions[_];const T=y==="round",R=T?7:0,z=2*R+1;if(this.nextRow+z>this.height)return lt("LineAtlas out of space"),null;c.length===0&&c.push(1);let W=0;for(let ht=0;ht<c.length;ht++)c[ht]<0&&(lt("Negative value is found in line dasharray, replacing values with 0"),c[ht]=0),W+=c[ht];if(W!==0){const ht=this.width/W,pt=this.getDashRanges(c,this.width,ht);T?this.addRoundDash(pt,ht,R):this.addRegularDash(pt,y==="square"?.5*ht:0)}const et=this.nextRow+R;this.nextRow+=z;const st={tl:[et,R],br:[W,0]};return this.positions[_]=st,st}}xn(Vv,"LineAtlas");class wU{constructor(c){this._callback=c,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}const MU=p.performance;function cA(g){const c=g?g.url.toString():void 0;return MU.getEntriesByName(c)}class AU{constructor(){this.tasks={},this.taskQueue=[],L(["process"],this),this.invoker=new wU(this.process),this.nextId=0}add(c,y){const _=this.nextId++,T=function({type:R,isSymbolTile:z,zoom:W}){return W=W||0,R==="message"?0:R!=="maybePrepare"||z?R!=="parseTile"||z?R==="parseTile"&&z?300-W:R==="maybePrepare"&&z?400-W:500:200-W:100-W}(y);if(T===0){Q();try{c()}finally{}return{cancel:()=>{}}}return this.tasks[_]={fn:c,metadata:y,priority:T,id:_},this.taskQueue.push(_),this.invoker.trigger(),{cancel:()=>{delete this.tasks[_]}}}process(){Q();try{if(this.taskQueue=this.taskQueue.filter(_=>!!this.tasks[_]),!this.taskQueue.length)return;const c=this.pick();if(c===null)return;const y=this.tasks[c];if(delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),!y)return;y.fn()}finally{}}pick(){let c=null,y=1/0;for(let T=0;T<this.taskQueue.length;T++){const R=this.tasks[this.taskQueue[T]];R.priority<y&&(y=R.priority,c=T)}if(c===null)return null;const _=this.taskQueue[c];return this.taskQueue.splice(c,1),_}remove(){this.invoker.remove()}}const SU=ae([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),EU=ae([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:uA}=SU,hA=ae([{name:"a_pos_3",components:3,type:"Int16"}]);var Cp=ae([{name:"a_pos",type:"Int16",components:2}]);const Kh=tr/Math.PI/2,Po=-Kh,Do=Kh,TU=[new qo([Po,Po,Po],[Do,Do,Do]),new qo([Po,Po,Po],[0,0,Do]),new qo([0,Po,Po],[Do,0,Do]),new qo([Po,0,Po],[0,Do,Do]),new qo([0,0,Po],[Do,Do,Do])];class CU{constructor(c,y,_){this.a=zh([],c,_),this.b=zh([],y,_),this.center=_;const T=dp([],this.a),R=dp([],this.b);this.angle=Math.acos(fp(T,R))}}function jv(g,c){if(g.angle===0)return null;let y;return y=g.a[c]===0?1/g.angle*.5*Math.PI:1/g.angle*Math.atan(g.b[c]/g.a[c]/Math.sin(g.angle)-1/Math.tan(g.angle)),y<0||y>1?null:function(_,T,R,z){const W=Math.sin(R);return _*(Math.sin((1-z)*R)/W)+T*(Math.sin(z*R)/W)}(g.a[c],g.b[c],g.angle,V(y,0,1))+g.center[c]}function Pp(g){if(g.z<=1)return TU[g.z+2*g.y+g.x];const[c,y]=Gv(g),_=[Na(c[0],c[1]),Na(c[0],y[1]),Na(y[0],c[1]),Na(y[0],y[1])],T=[Do,Do,Do],R=[Po,Po,Po];for(const z of _)T[0]=Math.min(T[0],z[0]),T[1]=Math.min(T[1],z[1]),T[2]=Math.min(T[2],z[2]),R[0]=Math.max(R[0],z[0]),R[1]=Math.max(R[1],z[1]),R[2]=Math.max(R[2],z[2]);return new qo(T,R)}function PU(g,c,y){const _=c/g.worldSize,T=(qe,nn)=>{hp(qe,qe,_),hp(nn,nn,_)},R=Number.MAX_VALUE,z=[-R,-R,-R],W=[R,R,R],et=gA(g);if(y.z<=1){const qe=Pp(y).getCorners();for(let nn=0;nn<qe.length;nn++)Vc(qe[nn],qe[nn],et),fv(W,W,qe[nn]),pv(z,z,qe[nn]);return T(W,z),new qo(W,z)}const[st,ht]=Gv(y),pt=new wl;pt.setSouthWest([st[1],ht[0]]),pt.setNorthEast([ht[1],st[0]]);const bt=[Na(pt.getSouth(),pt.getWest()),Na(pt.getSouth(),pt.getEast()),Na(pt.getNorth(),pt.getEast()),Na(pt.getNorth(),pt.getWest())];for(let qe=0;qe<bt.length;qe++)Vc(bt[qe],bt[qe],et),fv(W,W,bt[qe]),pv(z,z,bt[qe]);if(pt.contains(g.center))return z[2]=0,T(W,z),new qo(W,z);const Et=[et[12],et[13],et[14]],kt=g.center.lng,Ft=V(g.center.lat,-85.051129,$s),Vt=[cp(kt),Bh(Ft)],$t=pt.getCenter().lng,ue=V(pt.getCenter().lat,-85.051129,$s),ge=[cp($t),Bh(ue)];let xe=new Array(3),_e=0;const we=Vt[0]-ge[0],Be=Vt[1]-ge[1];if(Math.abs(we)>Math.abs(Be))_e=we>=0?1:3,xe=Et;else{_e=Be>=0?0:2;const qe=[et[4],et[5],et[6]];let nn;nn=Be>=0?-Math.sin(x(pt.getSouth()))*Kh:-Math.sin(x(pt.getNorth()))*Kh,xe=mv(xe,Et,qe,nn)}const Oe=bt[_e],Je=bt[(_e+1)%4],tn=new CU(Oe,Je,xe),De=[jv(tn,0)||Oe[0],jv(tn,1)||Oe[1],jv(tn,2)||Oe[2]];return W[2]=Math.min(Oe[2],Je[2]),fv(W,W,De),pv(z,z,De),T(W,z),new qo(W,z)}function Gv(g){const c=1<<g.z,y=g.x/c,_=(g.x+1)/c,T=(g.y+1)/c;return[[Ri(g.y/c),ns(y)],[Ri(T),ns(_)]]}function dA(g,c,y,_=Kh){return y=x(y),[g*Math.sin(y)*_,-c*_,g*Math.cos(y)*_]}function Na(g,c,y){return dA(Math.cos(x(g)),Math.sin(x(g)),c,y)}function fA(g,c,y){const _=Math.pow(2,y.z),T=(g/tr+y.x)/_;return Na(Ri((c/tr+y.y)/_),ns(T))}function Hv(g){return 16383/Math.max(...zh([],g.max,g.min))}function pA(g){const c=Qs(new Float64Array(16)),y=Hv(g);var _,T;return Ml(c,c,[y,y,y]),Uc(c,c,((_=[])[0]=-(T=g.min)[0],_[1]=-T[1],_[2]=-T[2],_)),c}function mA(g,c,y,_,T){const R=function(et){const st=tr/(2*Math.PI);return et/(2*Math.PI)/st}(y),z=[g,c,-y/(2*Math.PI)],W=Qs(new Float64Array(16));return Uc(W,W,z),Ml(W,W,[R,R,R]),uv(W,W,x(-T)),hv(W,W,x(-_)),W}function gA(g){const{x:c,y}=g.point,{lng:_,lat:T}=g._center;return mA(c,y,g.worldSize,_,T)}const yA=x(85),DU=Math.cos(yA),RU=Math.sin(yA);function bA(g,c,y){var _=2*Math.PI*6378137/256/Math.pow(2,y);return[g*_-2*Math.PI*6378137/2,c*_-2*Math.PI*6378137/2]}class c1{constructor(c,y,_){this.z=c,this.x=y,this.y=_,this.key=Dp(0,c,c,y,_)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,y){const _=function(R,z,W){var et=bA(256*R,256*(z=Math.pow(2,W)-z-1),W),st=bA(256*(R+1),256*(z+1),W);return et[0]+","+et[1]+","+st[0]+","+st[1]}(this.x,this.y,this.z),T=function(R,z,W){let et,st="";for(let ht=R;ht>0;ht--)et=1<<ht-1,st+=(z&et?1:0)+(W&et?2:0);return st}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(y==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",_)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vA{constructor(c,y){this.wrap=c,this.canonical=y,this.key=Dp(c,y.z,y.z,y.x,y.y)}}class Yi{constructor(c,y,_,T,R){this.overscaledZ=c,this.wrap=y,this.canonical=new c1(_,+T,+R),this.key=y===0&&c===_?this.canonical.key:Dp(y,c,_,T,R)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){const y=this.canonical.z-c;return c>this.canonical.z?new Yi(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Yi(c,this.wrap,c,this.canonical.x>>y,this.canonical.y>>y)}calculateScaledKey(c,y=!0){if(this.overscaledZ===c&&y)return this.key;if(c>this.canonical.z)return Dp(this.wrap*+y,c,this.canonical.z,this.canonical.x,this.canonical.y);{const _=this.canonical.z-c;return Dp(this.wrap*+y,c,c,this.canonical.x>>_,this.canonical.y>>_)}}isChildOf(c){if(c.wrap!==this.wrap)return!1;const y=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>y&&c.canonical.y===this.canonical.y>>y}children(c){if(this.overscaledZ>=c)return[new Yi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const y=this.canonical.z+1,_=2*this.canonical.x,T=2*this.canonical.y;return[new Yi(y,this.wrap,y,_,T),new Yi(y,this.wrap,y,_+1,T),new Yi(y,this.wrap,y,_,T+1),new Yi(y,this.wrap,y,_+1,T+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new Yi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new Yi(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vA(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Dp(g,c,y,_,T){const R=1<<Math.min(y,22);let z=R*(T%R)+_%R;return g&&y<22&&(z+=R*R*((g<0?-2*g-1:2*g)%(1<<2*(22-y)))),16*(32*z+y)+(c-y)}function Gc(g,c){if(!c.isReprojectedInTileSpace)return{scale:1<<g.z,x:g.x,y:g.y,x2:g.x+1,y2:g.y+1,projection:c};const y=Math.pow(2,-g.z),_=g.x*y,T=(g.x+1)*y,R=g.y*y,z=(g.y+1)*y,W=ns(_),et=ns(T),st=Ri(R),ht=Ri(z),pt=c.project(W,st),bt=c.project(et,st),Et=c.project(et,ht),kt=c.project(W,ht);let Ft=Math.min(pt.x,bt.x,Et.x,kt.x),Vt=Math.min(pt.y,bt.y,Et.y,kt.y),$t=Math.max(pt.x,bt.x,Et.x,kt.x),ue=Math.max(pt.y,bt.y,Et.y,kt.y);const ge=y/16;function xe(we,Be,Oe,Je,tn,De){const qe=(Oe+tn)/2,nn=(Je+De)/2,fn=c.project(ns(qe),Ri(nn)),sn=Math.max(0,Ft-fn.x,Vt-fn.y,fn.x-$t,fn.y-ue);Ft=Math.min(Ft,fn.x),$t=Math.max($t,fn.x),Vt=Math.min(Vt,fn.y),ue=Math.max(ue,fn.y),sn>ge&&(xe(we,fn,Oe,Je,qe,nn),xe(fn,Be,qe,nn,tn,De))}xe(pt,bt,_,R,T,R),xe(bt,Et,T,R,T,z),xe(Et,kt,T,z,_,z),xe(kt,pt,_,z,_,R),Ft-=ge,Vt-=ge,$t+=ge,ue+=ge;const _e=1/Math.max($t-Ft,ue-Vt);return{scale:_e,x:Ft*_e,y:Vt*_e,x2:$t*_e,y2:ue*_e,projection:c}}xn(c1,"CanonicalTileID"),xn(Yi,"OverscaledTileID",{omit:["projMatrix"]});class xA{constructor(c){this._stringToNumber={},this._numberToString=[];for(let y=0;y<c.length;y++){const _=c[y];this._stringToNumber[_]=y,this._numberToString[y]=_}}encode(c){return this._stringToNumber[c]}decode(c){return this._numberToString[c]}}const kU=["tile","layer","source","sourceLayer","state"];class _A{constructor(c,y,_,T,R){this.type="Feature",this._vectorTileFeature=c,this._z=y,this._x=_,this._y=T,this.properties=c.properties,this.id=R}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(c.id=this.id);for(const y of kU)this[y]!==void 0&&(c[y]=this[y]);return c}}const rs=32,ea=33,Tl=new Uint16Array(8184);for(let g=0;g<2046;g++){let c=g+2,y=0,_=0,T=0,R=0,z=0,W=0;for(1&c?T=R=z=rs:y=_=W=rs;(c>>=1)>1;){const st=y+T>>1,ht=_+R>>1;1&c?(T=y,R=_,y=z,_=W):(y=T,_=R,T=z,R=W),z=st,W=ht}const et=4*g;Tl[et+0]=y,Tl[et+1]=_,Tl[et+2]=T,Tl[et+3]=R}const na=new Uint16Array(2178),Cl=new Uint8Array(1089),u1=new Uint16Array(1089);function wA(g){return g===0?-.03125:g===32?.03125:0}var MA=ae([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const AA={type:2,extent:tr,loadGeometry:()=>[[new f(0,0),new f(8193,0),new f(8193,8193),new f(0,8193),new f(0,0)]]};class Wv{constructor(c,y,_,T,R){this.tileID=c,this.uid=U(),this.uses=0,this.tileSize=y,this.tileZoom=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=R,this.expiredRequestCount=0,this.state="loading",T&&T.transform&&(this.projection=T.transform.projection)}registerFadeDuration(c){const y=c+this.timeAdded;y<Gt.now()||this.fadeEndTime&&y<this.fadeEndTime||(this.fadeEndTime=y)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Gc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(c,y,_){if(this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(T,R){const z={};if(!R)return z;for(const W of T){const et=W.layerIds.map(st=>R.getLayer(st)).filter(Boolean);if(et.length!==0){W.layers=et,W.stateDependentLayerIds&&(W.stateDependentLayers=W.stateDependentLayerIds.map(st=>et.filter(ht=>ht.id===st)[0]));for(const st of et)z[st.id]=W}}return z}(c.buckets,y.style),this.hasSymbolBuckets=!1;for(const T in this.buckets){const R=this.buckets[T];if(R instanceof El){if(this.hasSymbolBuckets=!0,!_)break;R.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const T in this.buckets){const R=this.buckets[T];if(R instanceof El&&R.hasRTLText){this.hasRTLText=!0,So.isLoading()||So.isLoaded()||Ih()!=="deferred"||yl();break}}this.queryPadding=0;for(const T in this.buckets){const R=this.buckets[T];this.queryPadding=Math.max(this.queryPadding,y.style.getLayer(T).queryRadius(R))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage),c.lineAtlas&&(this.lineAtlas=c.lineAtlas)}else this.collisionBoxArray=new _s}unloadVectorData(){if(this.hasData()){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(c){return this.buckets[c.id]}upload(c){for(const _ in this.buckets){const T=this.buckets[_];T.uploadPending()&&T.upload(c)}const y=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Tp(c,this.imageAtlas.image,y.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Tp(c,this.glyphAtlasImage,y.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Tp(c,this.lineAtlas.image,y.ALPHA),this.lineAtlas.uploaded=!0)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,y,_,T,R,z,W,et){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:T,pixelPosMatrix:W,transform:z,params:R,tileTransform:this.tileTransform},c,y,_):{}}querySourceFeatures(c,y){const _=this.latestFeatureIndex;if(!_||!_.rawTileData)return;const T=_.loadVTLayers(),R=y?y.sourceLayer:"",z=T._geojsonTileLayer||T[R];if(!z)return;const W=qs(y&&y.filter),{z:et,x:st,y:ht}=this.tileID.canonical,pt={z:et,x:st,y:ht};for(let bt=0;bt<z.length;bt++){const Et=z.feature(bt);if(W.needGeometry){const Vt=zc(Et,!0);if(!W.filter(new Dr(this.tileID.overscaledZ),Vt,this.tileID.canonical))continue}else if(!W.filter(new Dr(this.tileID.overscaledZ),Et))continue;const kt=_.getId(Et,R),Ft=new _A(Et,et,st,ht,kt);Ft.tile=pt,c.push(Ft)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const y=this.expirationTime;if(c.cacheControl){const _=gt(c.cacheControl);_["max-age"]&&(this.expirationTime=Date.now()+1e3*_["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const _=Date.now();let T=!1;if(this.expirationTime>_)T=!1;else if(y)if(this.expirationTime<y)T=!0;else{const R=this.expirationTime-y;R?this.expirationTime=_+Math.max(R,3e4):T=!0}else T=!0;T?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,y){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0||!y)return;const _=this.latestFeatureIndex.loadVTLayers(),T=y.style.listImages();for(const R in this.buckets){if(!y.style.hasLayer(R))continue;const z=this.buckets[R],W=z.layers[0].sourceLayer||"_geojsonTileLayer",et=_[W],st=c[W];if(!et||!st||Object.keys(st).length===0)continue;if(z.update(st,et,T,this.imageAtlas&&this.imageAtlas.patternPositions||{}),z instanceof Q0||z instanceof J0){const pt=y.style._getSourceCache(z.layers[0].source);y._terrain&&y._terrain.enabled&&pt&&z.programConfigurations.needsUpload&&y._terrain._clearRenderCacheForTile(pt.id,this.tileID)}const ht=y&&y.style&&y.style.getLayer(R);ht&&(this.queryPadding=Math.max(this.queryPadding,ht.queryRadius(z)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Gt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=Gt.now()+c}setTexture(c,y){const _=y.context,T=_.gl;this.texture=y.getTileTexture(c.width),this.texture?this.texture.update(c,{useMipmap:!0}):(this.texture=new Tp(_,c,T.RGBA,{useMipmap:!0}),this.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE),_.extTextureFilterAnisotropic&&T.texParameterf(T.TEXTURE_2D,_.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_.extTextureFilterAnisotropicMax))}setDependencies(c,y){const _={};for(const T of y)_[T]=!0;this.dependencies[c]=_}hasDependency(c,y){for(const _ of c){const T=this.dependencies[_];if(T){for(const R of y)if(T[R])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(c,y){if(!y||y.name==="mercator"||this._tileDebugBuffer)return;const _=Ia(AA,this.tileID.canonical,this.tileTransform)[0],T=new ie,R=new gr;for(let z=0;z<_.length;z++){const{x:W,y:et}=_[z];T.emplaceBack(W,et),R.emplaceBack(z)}R.emplaceBack(0),this._tileDebugIndexBuffer=c.createIndexBuffer(R),this._tileDebugBuffer=c.createVertexBuffer(T,Cp.members),this._tileDebugSegments=Kr.simpleSegment(0,0,T.length,R.length)}_makeTileBoundsBuffers(c,y){if(this._tileBoundsBuffer||!y||y.name==="mercator")return;const _=Ia(AA,this.tileID.canonical,this.tileTransform)[0];let T,R;if(this.isRaster){const z=function(W,et){const st=Gc(W,et),ht=Math.pow(2,W.z);for(let Vt=0;Vt<ea;Vt++)for(let $t=0;$t<ea;$t++){const ue=ns((W.x+($t+wA($t))/rs)/ht),ge=Ri((W.y+(Vt+wA(Vt))/rs)/ht),xe=et.project(ue,ge),_e=Vt*ea+$t;na[2*_e+0]=Math.round((xe.x*st.scale-st.x)*tr),na[2*_e+1]=Math.round((xe.y*st.scale-st.y)*tr)}Cl.fill(0),u1.fill(0);for(let Vt=2045;Vt>=0;Vt--){const $t=4*Vt,ue=Tl[$t+0],ge=Tl[$t+1],xe=Tl[$t+2],_e=Tl[$t+3],we=ue+xe>>1,Be=ge+_e>>1,Oe=we+Be-ge,Je=Be+ue-we,tn=ge*ea+ue,De=_e*ea+xe,qe=Be*ea+we,nn=Math.hypot((na[2*tn+0]+na[2*De+0])/2-na[2*qe+0],(na[2*tn+1]+na[2*De+1])/2-na[2*qe+1])>=16;if(Cl[qe]=Cl[qe]||(nn?1:0),Vt<1022){const fn=(ge+Je>>1)*ea+(ue+Oe>>1),sn=(_e+Je>>1)*ea+(xe+Oe>>1);Cl[qe]=Cl[qe]||Cl[fn]||Cl[sn]}}const pt=new ce,bt=new _n;let Et=0;function kt(Vt,$t){const ue=$t*ea+Vt;return u1[ue]===0&&(pt.emplaceBack(na[2*ue+0],na[2*ue+1],Vt*tr/rs,$t*tr/rs),u1[ue]=++Et),u1[ue]-1}function Ft(Vt,$t,ue,ge,xe,_e){const we=Vt+ue>>1,Be=$t+ge>>1;if(Math.abs(Vt-xe)+Math.abs($t-_e)>1&&Cl[Be*ea+we])Ft(xe,_e,Vt,$t,we,Be),Ft(ue,ge,xe,_e,we,Be);else{const Oe=kt(Vt,$t),Je=kt(ue,ge),tn=kt(xe,_e);bt.emplaceBack(Oe,Je,tn)}}return Ft(0,0,rs,rs,rs,0),Ft(rs,rs,0,0,0,rs),{vertices:pt,indices:bt}}(this.tileID.canonical,y);T=z.vertices,R=z.indices}else{T=new ce,R=new _n;for(const{x:W,y:et}of _)T.emplaceBack(W,et,0,0);const z=q0(T.int16,void 0,4);for(let W=0;W<z.length;W+=3)R.emplaceBack(z[W],z[W+1],z[W+2])}this._tileBoundsBuffer=c.createVertexBuffer(T,MA.members),this._tileBoundsIndexBuffer=c.createIndexBuffer(R),this._tileBoundsSegments=Kr.simpleSegment(0,0,T.length,R.length)}_makeGlobeTileDebugBuffers(c,y){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!y||y.name!=="globe")return;const _=this.tileID.canonical,T=pA(Pp(_));this._makeGlobeTileDebugBorderBuffer(c,_,T),this._makeGlobeTileDebugTextBuffer(c,_,T)}_makeGlobeTileDebugBorderBuffer(c,y,_){const T=new ie,R=new gr,z=new se,W=(st,ht,pt,bt,Et)=>{const kt=(pt-st)/(Et-1),Ft=(bt-ht)/(Et-1),Vt=T.length;for(let $t=0;$t<Et;$t++){const ue=st+$t*kt,ge=ht+$t*Ft;T.emplaceBack(ue,ge);const xe=fA(ue,ge,y),_e=Vc(xe,xe,_);z.emplaceBack(_e[0],_e[1],_e[2]),R.emplaceBack(Vt+$t)}},et=tr;W(0,0,et,0,16),W(et,0,et,et,16),W(et,et,0,et,16),W(0,et,0,0,16),this._tileDebugIndexBuffer=c.createIndexBuffer(R),this._tileDebugBuffer=c.createVertexBuffer(T,Cp.members),this._globeTileDebugBorderBuffer=c.createVertexBuffer(z,hA.members),this._tileDebugSegments=Kr.simpleSegment(0,0,T.length,R.length)}_makeGlobeTileDebugTextBuffer(c,y,_){const T=new ie,R=new _n,z=new se,W=25;R.reserve(32),T.reserve(W),z.reserve(W);const et=(st,ht)=>W*st+ht;for(let st=0;st<W;st++){const ht=2048*st;for(let pt=0;pt<W;pt++){const bt=2048*pt;T.emplaceBack(bt,ht);const Et=fA(bt,ht,y),kt=Vc(Et,Et,_);z.emplaceBack(kt[0],kt[1],kt[2])}}for(let st=0;st<4;st++)for(let ht=0;ht<4;ht++){const pt=et(st,ht),bt=et(st,ht+1),Et=et(st+1,ht),kt=et(st+1,ht+1);R.emplaceBack(pt,bt,Et),R.emplaceBack(Et,bt,kt)}this._tileDebugTextIndexBuffer=c.createIndexBuffer(R),this._tileDebugTextBuffer=c.createVertexBuffer(T,Cp.members),this._globeTileDebugTextBuffer=c.createVertexBuffer(z,hA.members),this._tileDebugTextSegments=Kr.simpleSegment(0,0,W,32)}}class IU{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,y,_){const T=String(y);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][T]=this.stateChanges[c][T]||{},rt(this.stateChanges[c][T],_),this.deletedStates[c]===null){this.deletedStates[c]={};for(const R in this.state[c])R!==T&&(this.deletedStates[c][R]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][T]===null){this.deletedStates[c][T]={};for(const R in this.state[c][T])_[R]||(this.deletedStates[c][T][R]=null)}else for(const R in _)this.deletedStates[c]&&this.deletedStates[c][T]&&this.deletedStates[c][T][R]===null&&delete this.deletedStates[c][T][R]}removeFeatureState(c,y,_){if(this.deletedStates[c]===null)return;const T=String(y);if(this.deletedStates[c]=this.deletedStates[c]||{},_&&y!==void 0)this.deletedStates[c][T]!==null&&(this.deletedStates[c][T]=this.deletedStates[c][T]||{},this.deletedStates[c][T][_]=null);else if(y!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][T])for(_ in this.deletedStates[c][T]={},this.stateChanges[c][T])this.deletedStates[c][T][_]=null;else this.deletedStates[c][T]=null;else this.deletedStates[c]=null}getState(c,y){const _=String(y),T=rt({},(this.state[c]||{})[_],(this.stateChanges[c]||{})[_]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const R=this.deletedStates[c][y];if(R===null)return{};for(const z in R)delete T[z]}return T}initializeTileState(c,y){c.setFeatureState(this.state,y)}coalesceChanges(c,y){const _={};for(const T in this.stateChanges){this.state[T]=this.state[T]||{};const R={};for(const z in this.stateChanges[T])this.state[T][z]||(this.state[T][z]={}),rt(this.state[T][z],this.stateChanges[T][z]),R[z]=this.state[T][z];_[T]=R}for(const T in this.deletedStates){this.state[T]=this.state[T]||{};const R={};if(this.deletedStates[T]===null)for(const z in this.state[T])R[z]={},this.state[T][z]={};else for(const z in this.deletedStates[T]){if(this.deletedStates[T][z]===null)this.state[T][z]={};else for(const W of Object.keys(this.deletedStates[T][z]))delete this.state[T][z][W];R[z]=this.state[T][z]}_[T]=_[T]||{},rt(_[T],R)}if(this.stateChanges={},this.deletedStates={},Object.keys(_).length!==0)for(const T in c)c[T].setFeatureState(_,y)}}class SA{constructor(c){this.size=c,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(c,y){const _=this.toIdx(c,y);return{min:this.minimums[_],max:this.maximums[_]}}isLeaf(c,y){return this.leaves[this.toIdx(c,y)]}toIdx(c,y){return y*this.size+c}}function EA(g,c,y,_){let T=0,R=Number.MAX_VALUE;for(let z=0;z<3;z++)if(Math.abs(_[z])<1e-15){if(y[z]<g[z]||y[z]>c[z])return null}else{const W=1/_[z];let et=(g[z]-y[z])*W,st=(c[z]-y[z])*W;if(et>st){const ht=et;et=st,st=ht}if(et>T&&(T=et),st<R&&(R=st),T>R)return null}return T}function TA(g,c,y,_,T,R,z,W,et,st,ht){const pt=_-g,bt=T-c,Et=R-y,kt=z-g,Ft=W-c,Vt=et-y,$t=ht[1]*Vt-ht[2]*Ft,ue=ht[2]*kt-ht[0]*Vt,ge=ht[0]*Ft-ht[1]*kt,xe=pt*$t+bt*ue+Et*ge;if(Math.abs(xe)<1e-15)return null;const _e=1/xe,we=st[0]-g,Be=st[1]-c,Oe=st[2]-y,Je=(we*$t+Be*ue+Oe*ge)*_e;if(Je<0||Je>1)return null;const tn=Be*Et-Oe*bt,De=Oe*pt-we*Et,qe=we*bt-Be*pt,nn=(ht[0]*tn+ht[1]*De+ht[2]*qe)*_e;return nn<0||Je+nn>1?null:(kt*tn+Ft*De+Vt*qe)*_e}function CA(g,c,y){return(g-c)/(y-c)}function PA(g,c,y,_,T,R,z,W,et){const st=1<<y,ht=R-_,pt=z-T,bt=(g+1)/st*ht+_,Et=(c+0)/st*pt+T,kt=(c+1)/st*pt+T;W[0]=(g+0)/st*ht+_,W[1]=Et,et[0]=bt,et[1]=kt}class DA{constructor(c){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=c,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const y=function(R){const z=Math.ceil(Math.log2(R.dim/8)),W=[];let et=Math.ceil(Math.pow(2,z));const st=1/et,ht=(Et,kt,Ft,Vt,$t)=>{const ue=Vt?1:0,ge=(Et+1)*Ft-ue,xe=kt*Ft,_e=(kt+1)*Ft-ue;$t[0]=Et*Ft,$t[1]=xe,$t[2]=ge,$t[3]=_e};let pt=new SA(et);const bt=[];for(let Et=0;Et<et*et;Et++){ht(Et%et,Math.floor(Et/et),st,!1,bt);const kt=Pl(bt[0],bt[1],R),Ft=Pl(bt[2],bt[1],R),Vt=Pl(bt[2],bt[3],R),$t=Pl(bt[0],bt[3],R);pt.minimums.push(Math.min(kt,Ft,Vt,$t)),pt.maximums.push(Math.max(kt,Ft,Vt,$t)),pt.leaves.push(1)}for(W.push(pt),et/=2;et>=1;et/=2){const Et=W[W.length-1];pt=new SA(et);for(let kt=0;kt<et*et;kt++){ht(kt%et,Math.floor(kt/et),2,!0,bt);const Ft=Et.getElevation(bt[0],bt[1]),Vt=Et.getElevation(bt[2],bt[1]),$t=Et.getElevation(bt[2],bt[3]),ue=Et.getElevation(bt[0],bt[3]),ge=Et.isLeaf(bt[0],bt[1]),xe=Et.isLeaf(bt[2],bt[1]),_e=Et.isLeaf(bt[2],bt[3]),we=Et.isLeaf(bt[0],bt[3]),Be=Math.min(Ft.min,Vt.min,$t.min,ue.min),Oe=Math.max(Ft.max,Vt.max,$t.max,ue.max),Je=ge&&xe&&_e&&we;pt.maximums.push(Oe),pt.minimums.push(Be),pt.leaves.push(Oe-Be<=5&&Je?1:0)}W.push(pt)}return W}(this.dem),_=y.length-1,T=y[_];this._addNode(T.minimums[0],T.maximums[0],T.leaves[0]),this._construct(y,0,0,_,0)}raycastRoot(c,y,_,T,R,z,W=1){return EA([c,y,-100],[_,T,this.maximums[0]*W],R,z)}raycast(c,y,_,T,R,z,W=1){if(!this.nodeCount)return null;const et=this.raycastRoot(c,y,_,T,R,z,W);if(et==null)return null;const st=[],ht=[],pt=[],bt=[],Et=[{idx:0,t:et,nodex:0,nodey:0,depth:0}];for(;Et.length>0;){const{idx:kt,t:Ft,nodex:Vt,nodey:$t,depth:ue}=Et.pop();if(this.leaves[kt]){PA(Vt,$t,ue,c,y,_,T,pt,bt);const xe=1<<ue,_e=(Vt+0)/xe,we=(Vt+1)/xe,Be=($t+0)/xe,Oe=($t+1)/xe,Je=Pl(_e,Be,this.dem)*W,tn=Pl(we,Be,this.dem)*W,De=Pl(we,Oe,this.dem)*W,qe=Pl(_e,Oe,this.dem)*W,nn=TA(pt[0],pt[1],Je,bt[0],pt[1],tn,bt[0],bt[1],De,R,z),fn=TA(bt[0],bt[1],De,pt[0],bt[1],qe,pt[0],pt[1],Je,R,z),sn=Math.min(nn!==null?nn:Number.MAX_VALUE,fn!==null?fn:Number.MAX_VALUE);if(sn!==Number.MAX_VALUE)return sn;{const dn=mv([],R,z,Ft);if(RA(Je,tn,qe,De,CA(dn[0],pt[0],bt[0]),CA(dn[1],pt[1],bt[1]))>=dn[2])return Ft}continue}let ge=0;for(let xe=0;xe<this._siblingOffset.length;xe++){PA((Vt<<1)+this._siblingOffset[xe][0],($t<<1)+this._siblingOffset[xe][1],ue+1,c,y,_,T,pt,bt),pt[2]=-100,bt[2]=this.maximums[this.childOffsets[kt]+xe]*W;const _e=EA(pt,bt,R,z);if(_e!=null){const we=_e;st[xe]=we;let Be=!1;for(let Oe=0;Oe<ge&&!Be;Oe++)we>=st[ht[Oe]]&&(ht.splice(Oe,0,xe),Be=!0);Be||(ht[ge]=xe),ge++}}for(let xe=0;xe<ge;xe++){const _e=ht[xe];Et.push({idx:this.childOffsets[kt]+_e,t:st[_e],nodex:(Vt<<1)+this._siblingOffset[_e][0],nodey:($t<<1)+this._siblingOffset[_e][1],depth:ue+1})}}return null}_addNode(c,y,_){return this.minimums.push(c),this.maximums.push(y),this.leaves.push(_),this.childOffsets.push(0),this.nodeCount++}_construct(c,y,_,T,R){if(c[T].isLeaf(y,_)===1)return;this.childOffsets[R]||(this.childOffsets[R]=this.nodeCount);const z=T-1,W=c[z];let et=0,st=0;for(let ht=0;ht<this._siblingOffset.length;ht++){const pt=2*y+this._siblingOffset[ht][0],bt=2*_+this._siblingOffset[ht][1],Et=W.getElevation(pt,bt),kt=W.isLeaf(pt,bt),Ft=this._addNode(Et.min,Et.max,kt);kt&&(et|=1<<ht),st||(st=Ft)}for(let ht=0;ht<this._siblingOffset.length;ht++)et&1<<ht||this._construct(c,2*y+this._siblingOffset[ht][0],2*_+this._siblingOffset[ht][1],z,st+ht)}}function RA(g,c,y,_,T,R){return Nn(Nn(g,y,R),Nn(c,_,R),T)}function Pl(g,c,y){const _=y.dim,T=V(g*_-.5,0,_-1),R=V(c*_-.5,0,_-1),z=Math.floor(T),W=Math.floor(R),et=Math.min(z+1,_-1),st=Math.min(W+1,_-1);return RA(y.get(z,W),y.get(et,W),y.get(z,st),y.get(et,st),T-z,R-W)}const kA={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class h1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(c,y,_,T=!1,R=!1){if(this.uid=c,y.height!==y.width)throw new RangeError("DEM tiles must be square");if(_&&_!=="mapbox"&&_!=="terrarium")return lt(`"${_}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=y.height;const z=this.dim=y.height-2,W=new Uint32Array(y.data.buffer);if(this.pixels=new Uint8Array(y.data.buffer),this.encoding=_||"mapbox",this.borderReady=T,!T){for(let et=0;et<z;et++)W[this._idx(-1,et)]=W[this._idx(0,et)],W[this._idx(z,et)]=W[this._idx(z-1,et)],W[this._idx(et,-1)]=W[this._idx(et,0)],W[this._idx(et,z)]=W[this._idx(et,z-1)];W[this._idx(-1,-1)]=W[this._idx(0,0)],W[this._idx(z,-1)]=W[this._idx(z-1,0)],W[this._idx(-1,z)]=W[this._idx(0,z-1)],W[this._idx(z,z)]=W[this._idx(z-1,z-1)],R&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new DA(this)}get(c,y,_=!1){_&&(c=V(c,-1,this.dim),y=V(y,-1,this.dim));const T=4*this._idx(c,y);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[T],this.pixels[T+1],this.pixels[T+2])}static getUnpackVector(c){return kA[c]}get unpackVector(){return kA[this.encoding]}_idx(c,y){if(c<-1||c>=this.dim+1||y<-1||y>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(y+1)*this.stride+(c+1)}_unpackMapbox(c,y,_){return(256*c*256+256*y+_)/10-1e4}_unpackTerrarium(c,y,_){return 256*c+y+_/256-32768}static pack(c,y){const _=[0,0,0,0],T=h1.getUnpackVector(y);let R=Math.floor((c+T[3])/T[2]);return _[2]=R%256,R=Math.floor(R/256),_[1]=R%256,R=Math.floor(R/256),_[0]=R,_}getPixels(){return new Co({width:this.stride,height:this.stride},this.pixels)}backfillBorder(c,y,_){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let T=y*this.dim,R=y*this.dim+this.dim,z=_*this.dim,W=_*this.dim+this.dim;switch(y){case-1:T=R-1;break;case 1:R=T+1}switch(_){case-1:z=W-1;break;case 1:W=z+1}const et=-y*this.dim,st=-_*this.dim;for(let ht=z;ht<W;ht++)for(let pt=T;pt<R;pt++){const bt=4*this._idx(pt,ht),Et=4*this._idx(pt+et,ht+st);this.pixels[bt+0]=c.pixels[Et+0],this.pixels[bt+1]=c.pixels[Et+1],this.pixels[bt+2]=c.pixels[Et+2],this.pixels[bt+3]=c.pixels[Et+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}xn(h1,"DEMData"),xn(DA,"DemMinMaxQuadTree",{omit:["dem"]});class LU{constructor(c,y){this.max=c,this.onRemove=y,this.reset()}reset(){for(const c in this.data)for(const y of this.data[c])y.timeout&&clearTimeout(y.timeout),this.onRemove(y.value);return this.data={},this.order=[],this}add(c,y,_){const T=c.wrapped().key;this.data[T]===void 0&&(this.data[T]=[]);const R={value:y,timeout:void 0};if(_!==void 0&&(R.timeout=setTimeout(()=>{this.remove(c,R)},_)),this.data[T].push(R),this.order.push(T),this.order.length>this.max){const z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const y=this.data[c].shift();return y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),y.value}getByKey(c){const y=this.data[c];return y?y[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,y){if(!this.has(c))return this;const _=c.wrapped().key,T=y===void 0?0:this.data[_].indexOf(y),R=this.data[_][T];return this.data[_].splice(T,1),R.timeout&&clearTimeout(R.timeout),this.data[_].length===0&&delete this.data[_],this.onRemove(R.value),this.order.splice(this.order.indexOf(_),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}filter(c){const y=[];for(const _ in this.data)for(const T of this.data[_])c(T.value)||y.push(T);for(const _ of y)this.remove(_.value.tileID,_)}}class Zh{constructor(c,y,_){this.func=c,this.mask=y,this.range=_}}Zh.ReadOnly=!1,Zh.ReadWrite=!0,Zh.disabled=new Zh(519,Zh.ReadOnly,[0,1]);const qv=7680;class Xv{constructor(c,y,_,T,R,z){this.test=c,this.ref=y,this.mask=_,this.fail=T,this.depthFail=R,this.pass=z}}Xv.disabled=new Xv({func:519,mask:0},0,0,qv,qv,qv);class ra{constructor(c,y,_){this.blendFunction=c,this.blendColor=y,this.mask=_}}ra.Replace=[1,0],ra.disabled=new ra(ra.Replace,ar.transparent,[!1,!1,!1,!1]),ra.unblended=new ra(ra.Replace,ar.transparent,[!0,!0,!0,!0]),ra.alphaBlended=new ra([1,771],ar.transparent,[!0,!0,!0,!0]);const Yv=1029,Kv=2305;class Ss{constructor(c,y,_){this.enable=c,this.mode=y,this.frontFace=_}}Ss.disabled=new Ss(!1,Yv,Kv),Ss.backCCW=new Ss(!0,Yv,Kv),Ss.backCW=new Ss(!0,Yv,2304),Ss.frontCW=new Ss(!0,1028,2304),Ss.frontCCW=new Ss(!0,1028,Kv);class Hc extends ee{constructor(c,y,_){super(),this.id=c,this._onlySymbols=_,y.on("data",T=>{T.dataType==="source"&&T.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&T.dataType==="source"&&T.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),y.on("error",()=>{this._sourceErrored=!0}),this._source=y,this._tiles={},this._cache=new LU(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new IU,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(c){this.map=c,this._minTileCacheSize=this._minTileCacheSize===void 0&&c?c._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&c?c._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const y=this._tiles[c];if(y.state!=="loaded"&&y.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(c,y){return c.isSymbolTile=this._onlySymbols,this._source.loadTile(c,y)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){if(this._source.abortTile)return this._source.abortTile(c,()=>{})}serialize(){return this._source.serialize()}prepare(c){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const y in this._tiles){const _=this._tiles[y];this._source.prepareTile(_)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,_.tileID),_.upload(c),_.prepare(this.map.style.imageManager)}else for(const y in this._tiles){const _=this._tiles[y];_.upload(c),_.prepare(this.map.style.imageManager)}}getIds(){return tt(this._tiles).map(c=>c.tileID).sort(IA).map(c=>c.key)}getRenderableIds(c){const y=[];for(const _ in this._tiles)this._isIdRenderable(+_,c)&&y.push(this._tiles[_]);return c?y.sort((_,T)=>{const R=_.tileID,z=T.tileID,W=new f(R.canonical.x,R.canonical.y)._rotate(this.transform.angle),et=new f(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return R.overscaledZ-z.overscaledZ||et.y-W.y||et.x-W.x}).map(_=>_.tileID.key):y.map(_=>_.tileID).sort(IA).map(_=>_.key)}hasRenderableParent(c){const y=this.findLoadedParent(c,0);return!!y&&this._isIdRenderable(y.tileID.key)}_isIdRenderable(c,y){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(y||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(+c,"reloading")}}_reloadTile(c,y){const _=this._tiles[c];_&&(_.state!=="loading"&&(_.state=y),this._loadTile(_,this._tileLoaded.bind(this,_,c,y)))}_tileLoaded(c,y,_,T){if(T)if(c.state="errored",T.status!==404)this._source.fire(new Lt(T,{tile:c}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const R=this.map.painter.terrain;this.update(this.transform,R.getScaledDemTileSize(),!0),R.resetTileLookupCache(this.id)}else this.update(this.transform);else c.timeAdded=Gt.now(),_==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(y,c),this._source.type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),this._source.fire(new Tt("data",{dataType:"source",tile:c,coord:c.tileID,sourceCacheId:this.id}))}_backfillDEM(c){const y=this.getRenderableIds();for(let T=0;T<y.length;T++){const R=y[T];if(c.neighboringTiles&&c.neighboringTiles[R]){const z=this.getTileByID(R);_(c,z),_(z,c)}}function _(T,R){if(!T.dem||T.dem.borderReady)return;T.needsHillshadePrepare=!0,T.needsDEMTextureUpload=!0;let z=R.tileID.canonical.x-T.tileID.canonical.x;const W=R.tileID.canonical.y-T.tileID.canonical.y,et=Math.pow(2,T.tileID.canonical.z),st=R.tileID.key;z===0&&W===0||Math.abs(W)>1||(Math.abs(z)>1&&(Math.abs(z+et)===1?z+=et:Math.abs(z-et)===1&&(z-=et)),R.dem&&T.dem&&(T.dem.backfillBorder(R.dem,z,W),T.neighboringTiles&&T.neighboringTiles[st]&&(T.neighboringTiles[st].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,y,_,T){for(const R in this._tiles){let z=this._tiles[R];if(T[R]||!z.hasData()||z.tileID.overscaledZ<=y||z.tileID.overscaledZ>_)continue;let W=z.tileID;for(;z&&z.tileID.overscaledZ>y+1;){const st=z.tileID.scaledTo(z.tileID.overscaledZ-1);z=this._tiles[st.key],z&&z.hasData()&&(W=st)}let et=W;for(;et.overscaledZ>y;)if(et=et.scaledTo(et.overscaledZ-1),c[et.key]){T[W.key]=W;break}}}findLoadedParent(c,y){if(c.key in this._loadedParentTiles){const _=this._loadedParentTiles[c.key];return _&&_.tileID.overscaledZ>=y?_:null}for(let _=c.overscaledZ-1;_>=y;_--){const T=c.scaledTo(_),R=this._getLoadedTile(T);if(R)return R}}_getLoadedTile(c){const y=this._tiles[c.key];return y&&y.hasData()?y:this._cache.getByKey(this._source.reparseOverscaled?c.wrapped().key:c.canonical.key)}updateCacheSize(c,y){y=y||this._source.tileSize;const _=Math.ceil(c.width/y)+1,T=Math.ceil(c.height/y)+1,R=Math.floor(_*T*5),z=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,R):R,W=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,z):z;this._cache.setMaxSize(W)}handleWrapJump(c){const y=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,y){const _={};for(const T in this._tiles){const R=this._tiles[T];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+y),_[R.tileID.key]=R}this._tiles=_;for(const T in this._timers)clearTimeout(this._timers[T]),delete this._timers[T];for(const T in this._tiles)this._setTileReloadTimer(+T,this._tiles[T])}}update(c,y,_){if(this.transform=c,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!_)return;let T;this.updateCacheSize(c,y),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?T=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new Yi(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y)):(T=c.coveringTiles({tileSize:y||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!_,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(T=T.filter(W=>this._source.hasTile(W)))):T=[];const R=this._updateRetainedTiles(T);if(LA(this._source.type)&&T.length!==0){const W={},et={},st=Object.keys(R);for(const pt of st){const bt=R[pt],Et=this._tiles[pt];if(!Et||Et.fadeEndTime&&Et.fadeEndTime<=Gt.now())continue;const kt=this.findLoadedParent(bt,Math.max(bt.overscaledZ-Hc.maxOverzooming,this._source.minzoom));kt&&(this._addTile(kt.tileID),W[kt.tileID.key]=kt.tileID),et[pt]=bt}const ht=T[T.length-1].overscaledZ;for(const pt in this._tiles){const bt=this._tiles[pt];if(R[pt]||!bt.hasData())continue;let Et=bt.tileID;for(;Et.overscaledZ>ht;){Et=Et.scaledTo(Et.overscaledZ-1);const kt=this._tiles[Et.key];if(kt&&kt.hasData()&&et[Et.key]){R[pt]=bt.tileID;break}}}for(const pt in W)R[pt]||(this._coveredTiles[pt]=!0,R[pt]=W[pt])}for(const W in R)this._tiles[W].clearFadeHold();const z=function(W,et){const st=[];for(const ht in W)ht in et||st.push(ht);return st}(this._tiles,R);for(const W of z){const et=this._tiles[W];et.hasSymbolBuckets&&!et.holdingForFade()?et.setHoldDuration(this.map._fadeDuration):et.hasSymbolBuckets&&!et.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(+c)}_updateRetainedTiles(c){const y={};if(c.length===0)return y;const _={},T=c.reduce((st,ht)=>Math.min(st,ht.overscaledZ),1/0),R=c[0].overscaledZ,z=Math.max(R-Hc.maxOverzooming,this._source.minzoom),W=Math.max(R+Hc.maxUnderzooming,this._source.minzoom),et={};for(const st of c){const ht=this._addTile(st);y[st.key]=st,ht.hasData()||T<this._source.maxzoom&&(et[st.key]=st)}this._retainLoadedChildren(et,T,W,y);for(const st of c){let ht=this._tiles[st.key];if(ht.hasData())continue;if(st.canonical.z>=this._source.maxzoom){const bt=st.children(this._source.maxzoom)[0],Et=this.getTile(bt);if(Et&&Et.hasData()){y[bt.key]=bt;continue}}else{const bt=st.children(this._source.maxzoom);if(y[bt[0].key]&&y[bt[1].key]&&y[bt[2].key]&&y[bt[3].key])continue}let pt=ht.wasRequested();for(let bt=st.overscaledZ-1;bt>=z;--bt){const Et=st.scaledTo(bt);if(_[Et.key]||(_[Et.key]=!0,ht=this.getTile(Et),!ht&&pt&&(ht=this._addTile(Et)),ht&&(y[Et.key]=Et,pt=ht.wasRequested(),ht.hasData())))break}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const y=[];let _,T=this._tiles[c].tileID;for(;T.overscaledZ>0;){if(T.key in this._loadedParentTiles){_=this._loadedParentTiles[T.key];break}y.push(T.key);const R=T.scaledTo(T.overscaledZ-1);if(_=this._getLoadedTile(R),_)break;T=R}for(const R of y)this._loadedParentTiles[R]=_}}_addTile(c){let y=this._tiles[c.key];if(y)return this._source.prepareTile&&this._source.prepareTile(y),y;y=this._cache.getAndRemove(c),y&&(this._setTileReloadTimer(c.key,y),y.tileID=c,this._state.initializeTileState(y,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,y)));const _=!!y;if(!_){const T=this.map?this.map.painter:null;y=new Wv(c,this._source.tileSize*c.overscaleFactor(),this.transform.tileZoom,T,this._isRaster),this._source.prepareTile&&this._source.prepareTile(y)||this._loadTile(y,this._tileLoaded.bind(this,y,c.key,y.state))}return y?(y.uses++,this._tiles[c.key]=y,_||this._source.fire(new Tt("dataloading",{tile:y,coord:y.tileID,dataType:"source"})),y):null}_setTileReloadTimer(c,y){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const _=y.getExpiryTimeout();_&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},_))}_removeTile(c){const y=this._tiles[c];y&&(y.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),y.uses>0||(y.hasData()&&y.state!=="reloading"?this._cache.add(y.tileID,y,y.getExpiryTimeout()):(y.aborted=!0,this._abortTile(y),this._unloadTile(y))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(+c);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(c,y,_){const T=[],R=this.transform;if(!R)return T;for(const z in this._tiles){const W=this._tiles[z];if(_&&W.clearQueryDebugViz(),W.holdingForFade())continue;const et=c.containsTile(W,R,y);et&&T.push(et)}return T}getVisibleCoordinates(c){const y=this.getRenderableIds(c).map(_=>this._tiles[_].tileID);for(const _ of y)_.projMatrix=this.transform.calculateProjMatrix(_.toUnwrapped());return y}hasTransition(){if(this._source.hasTransition())return!0;if(LA(this._source.type))for(const c in this._tiles){const y=this._tiles[c];if(y.fadeEndTime!==void 0&&y.fadeEndTime>=Gt.now())return!0}return!1}setFeatureState(c,y,_){this._state.updateState(c=c||"_geojsonTileLayer",y,_)}removeFeatureState(c,y,_){this._state.removeFeatureState(c=c||"_geojsonTileLayer",y,_)}getFeatureState(c,y){return this._state.getState(c=c||"_geojsonTileLayer",y)}setDependencies(c,y,_){const T=this._tiles[c];T&&T.setDependencies(y,_)}reloadTilesForDependencies(c,y){for(const _ in this._tiles)this._tiles[_].hasDependency(c,y)&&this._reloadTile(+_,"reloading");this._cache.filter(_=>!_.hasDependency(c,y))}_preloadTiles(c,y){const _=new Map,T=Array.isArray(c)?c:[c],R=this.map.painter.terrain,z=this.usedForTerrain&&R?R.getScaledDemTileSize():this._source.tileSize;for(const W of T){const et=W.coveringTiles({tileSize:z,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const st of et)_.set(st.key,st);this.usedForTerrain&&W.updateElevation(!1)}Z(Array.from(_.values()),(W,et)=>{const st=new Wv(W,this._source.tileSize*W.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(st,ht=>{this._source.type==="raster-dem"&&st.dem&&this._backfillDEM(st),et(ht,st)})},y)}}function IA(g,c){const y=Math.abs(2*g.wrap)-+(g.wrap<0),_=Math.abs(2*c.wrap)-+(c.wrap<0);return g.overscaledZ-c.overscaledZ||_-y||c.canonical.y-g.canonical.y||c.canonical.x-g.canonical.x}function LA(g){return g==="raster"||g==="image"||g==="video"}Hc.maxOverzooming=10,Hc.maxUnderzooming=3;class d1{constructor(c,y,_){this._demTile=c,this._dem=this._demTile.dem,this._scale=y,this._offset=_}static create(c,y,_){const T=_||c.findDEMTileFor(y);if(!T||!T.dem)return;const R=T.dem,z=T.tileID,W=1<<y.canonical.z-z.canonical.z;return new d1(T,T.tileSize/tr/W,[(y.canonical.x/W-z.canonical.x)*R.dim,(y.canonical.y/W-z.canonical.y)*R.dim])}tileCoordToPixel(c,y){const _=y*this._scale+this._offset[1],T=Math.floor(c*this._scale+this._offset[0]),R=Math.floor(_);return new f(T,R)}getElevationAt(c,y,_,T){const R=c*this._scale+this._offset[0],z=y*this._scale+this._offset[1],W=Math.floor(R),et=Math.floor(z),st=this._dem;return T=!!T,_?Nn(Nn(st.get(W,et,T),st.get(W,et+1,T),z-et),Nn(st.get(W+1,et,T),st.get(W+1,et+1,T),z-et),R-W):st.get(W,et,T)}getElevationAtPixel(c,y,_){return this._dem.get(c,y,!!_)}getMeterToDEM(c){return(1<<this._demTile.tileID.canonical.z)*Fh(1,c)*this._dem.stride}}class BA{constructor(c,y){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Ks(tr,16,0),this.featureIndexArray=new jr,this.promoteId=y}insert(c,y,_,T,R,z=0){const W=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(_,T,R,z);const et=this.grid;for(let st=0;st<y.length;st++){const ht=y[st],pt=[1/0,1/0,-1/0,-1/0];for(let bt=0;bt<ht.length;bt++){const Et=ht[bt];pt[0]=Math.min(pt[0],Et.x),pt[1]=Math.min(pt[1],Et.y),pt[2]=Math.max(pt[2],Et.x),pt[3]=Math.max(pt[3],Et.y)}pt[0]<tr&&pt[1]<tr&&pt[2]>=0&&pt[3]>=0&&et.insert(W,pt[0],pt[1],pt[2],pt[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new jc.VectorTile(new Ap(this.rawTileData)).layers,this.sourceLayerCoder=new xA(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const c in this.vtLayers)this.vtFeatures[c]=[]}return this.vtLayers}query(c,y,_,T){this.loadVTLayers();const R=c.params||{},z=qs(R.filter),W=c.tileResult,et=c.transform,st=W.bufferedTilespaceBounds,ht=this.grid.query(st.min.x,st.min.y,st.max.x,st.max.y,(kt,Ft,Vt,$t)=>n3(W.bufferedTilespaceGeometry,kt,Ft,Vt,$t));ht.sort(BU);let pt=null;et.elevation&&ht.length>0&&(pt=d1.create(et.elevation,this.tileID));const bt={};let Et;for(let kt=0;kt<ht.length;kt++){const Ft=ht[kt];if(Ft===Et)continue;Et=Ft;const Vt=this.featureIndexArray.get(Ft);let $t=null;this.loadMatchingFeature(bt,Vt,z,R.layers,R.availableImages,y,_,T,(ue,ge,xe,_e=0)=>($t||($t=Ia(ue,this.tileID.canonical,c.tileTransform)),ge.queryIntersectsFeature(W,ue,xe,$t,this.z,c.transform,c.pixelPosMatrix,pt,_e)))}return bt}loadMatchingFeature(c,y,_,T,R,z,W,et,st){const{featureIndex:ht,bucketIndex:pt,sourceLayerIndex:bt,layoutVertexArrayOffset:Et}=y,kt=this.bucketLayerIDs[pt];if(T&&!function(ue,ge){for(let xe=0;xe<ue.length;xe++)if(ge.indexOf(ue[xe])>=0)return!0;return!1}(T,kt))return;const Ft=this.sourceLayerCoder.decode(bt),Vt=this.vtLayers[Ft].feature(ht);if(_.needGeometry){const ue=zc(Vt,!0);if(!_.filter(new Dr(this.tileID.overscaledZ),ue,this.tileID.canonical))return}else if(!_.filter(new Dr(this.tileID.overscaledZ),Vt))return;const $t=this.getId(Vt,Ft);for(let ue=0;ue<kt.length;ue++){const ge=kt[ue];if(T&&T.indexOf(ge)<0)continue;const xe=z[ge];if(!xe)continue;let _e={};$t!==void 0&&et&&(_e=et.getState(xe.sourceLayer||"_geojsonTileLayer",$t));const we=rt({},W[ge]);we.paint=FA(we.paint,xe.paint,Vt,_e,R),we.layout=FA(we.layout,xe.layout,Vt,_e,R);const Be=!st||st(Vt,xe,_e,Et);if(!Be)continue;const Oe=new _A(Vt,this.z,this.x,this.y,$t);Oe.layer=we;let Je=c[ge];Je===void 0&&(Je=c[ge]=[]),Je.push({featureIndex:ht,feature:Oe,intersectionZ:Be})}}lookupSymbolFeatures(c,y,_,T,R,z,W,et){const st={};this.loadVTLayers();const ht=qs(R);for(const pt of c)this.loadMatchingFeature(st,{bucketIndex:_,sourceLayerIndex:T,featureIndex:pt,layoutVertexArrayOffset:0},ht,z,W,et,y);return st}loadFeature(c){const{featureIndex:y,sourceLayerIndex:_}=c;this.loadVTLayers();const T=this.sourceLayerCoder.decode(_),R=this.vtFeatures[T];if(R[y])return R[y];const z=this.vtLayers[T].feature(y);return R[y]=z,z}hasLayer(c){for(const y of this.bucketLayerIDs)for(const _ of y)if(c===_)return!0;return!1}getId(c,y){let _=c.id;return this.promoteId&&(_=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[y]],typeof _=="boolean"&&(_=Number(_))),_}}function FA(g,c,y,_,T){return O(g,(R,z)=>{const W=c instanceof $?c.get(z):null;return W&&W.evaluate?W.evaluate(y,_,T):W})}function BU(g,c){return c-g}xn(BA,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class NA{constructor(c){const y={},_=[];for(const W in c){const et=c[W],st=y[W]={};for(const ht in et.glyphs){const pt=et.glyphs[+ht];if(!pt||pt.bitmap.width===0||pt.bitmap.height===0)continue;const bt=pt.metrics.localGlyph?2:1,Et={x:0,y:0,w:pt.bitmap.width+2*bt,h:pt.bitmap.height+2*bt};_.push(Et),st[ht]=Et}}const{w:T,h:R}=Tv(_),z=new La({width:T||1,height:R||1});for(const W in c){const et=c[W];for(const st in et.glyphs){const ht=et.glyphs[+st];if(!ht||ht.bitmap.width===0||ht.bitmap.height===0)continue;const pt=y[W][st],bt=ht.metrics.localGlyph?2:1;La.copy(ht.bitmap,z,{x:0,y:0},{x:pt.x+bt,y:pt.y+bt},ht.bitmap)}}this.image=z,this.positions=y}}xn(NA,"GlyphAtlas");class FU{constructor(c){this.tileID=new Yi(c.tileID.overscaledZ,c.tileID.wrap,c.tileID.canonical.z,c.tileID.canonical.x,c.tileID.canonical.y),this.tileZoom=c.tileZoom,this.uid=c.uid,this.zoom=c.zoom,this.canonical=c.tileID.canonical,this.pixelRatio=c.pixelRatio,this.tileSize=c.tileSize,this.source=c.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=c.showCollisionBoxes,this.collectResourceTiming=!!c.collectResourceTiming,this.returnDependencies=!!c.returnDependencies,this.promoteId=c.promoteId,this.enableTerrain=!!c.enableTerrain,this.isSymbolTile=c.isSymbolTile,this.tileTransform=Gc(c.tileID.canonical,c.projection),this.projection=c.projection}parse(c,y,_,T,R){this.status="parsing",this.data=c,this.collisionBoxArray=new _s;const z=new xA(Object.keys(c.layers).sort()),W=new BA(this.tileID,this.promoteId);W.bucketLayerIDs=[];const et={},st=new Vv(256,256),ht={featureIndex:W,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:st,availableImages:_},pt=y.familiesBySource[this.source];for(const _e in pt){const we=c.layers[_e];if(!we)continue;let Be=!1,Oe=!1;for(const De of pt[_e])De[0].type==="symbol"?Be=!0:Oe=!0;if(this.isSymbolTile===!0&&!Be||this.isSymbolTile===!1&&!Oe)continue;we.version===1&&lt(`Vector tile source "${this.source}" layer "${_e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Je=z.encode(_e),tn=[];for(let De=0;De<we.length;De++){const qe=we.feature(De),nn=W.getId(qe,_e);tn.push({feature:qe,id:nn,index:De,sourceLayerIndex:Je})}for(const De of pt[_e]){const qe=De[0];this.isSymbolTile!==void 0&&qe.type==="symbol"!==this.isSymbolTile||qe.minzoom&&this.zoom<Math.floor(qe.minzoom)||qe.maxzoom&&this.zoom>=qe.maxzoom||qe.visibility!=="none"&&(Zv(De,this.zoom,_),(et[qe.id]=qe.createBucket({index:W.bucketLayerIDs.length,layers:De,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Je,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.name,availableImages:_})).populate(tn,ht,this.tileID.canonical,this.tileTransform),W.bucketLayerIDs.push(De.map(nn=>nn.id)))}}let bt,Et,kt,Ft;st.trim();const Vt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},$t=O(ht.glyphDependencies,_e=>Object.keys(_e).map(Number));Object.keys($t).length?T.send("getGlyphs",{uid:this.uid,stacks:$t},(_e,we)=>{bt||(bt=_e,Et=we,xe.call(this))},void 0,!1,Vt):Et={};const ue=Object.keys(ht.iconDependencies);ue.length?T.send("getImages",{icons:ue,source:this.source,tileID:this.tileID,type:"icons"},(_e,we)=>{bt||(bt=_e,kt=we,xe.call(this))},void 0,!1,Vt):kt={};const ge=Object.keys(ht.patternDependencies);function xe(){if(bt)return R(bt);if(Et&&kt&&Ft){const _e=new NA(Et),we=new j3(kt,Ft);for(const Be in et){const Oe=et[Be];Oe instanceof El?(Zv(Oe.layers,this.zoom,_),uU(Oe,Et,_e.positions,kt,we.iconPositions,this.showCollisionBoxes,_,this.tileID.canonical,this.tileZoom,this.projection)):Oe.hasPattern&&(Oe instanceof Q0||Oe instanceof J0||Oe instanceof _p)&&(Zv(Oe.layers,this.zoom,_),Oe.addFeatures(ht,this.tileID.canonical,we.patternPositions,_,this.tileTransform))}this.status="done",R(null,{buckets:tt(et).filter(Be=>!Be.isEmpty()),featureIndex:W,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_e.image,lineAtlas:st,imageAtlas:we,glyphMap:this.returnDependencies?Et:null,iconMap:this.returnDependencies?kt:null,glyphPositions:this.returnDependencies?_e.positions:null})}}ge.length?T.send("getImages",{icons:ge,source:this.source,tileID:this.tileID,type:"patterns"},(_e,we)=>{bt||(bt=_e,Ft=we,xe.call(this))},void 0,!1,Vt):Ft={},xe.call(this)}}function Zv(g,c,y){const _=new Dr(c);for(const T of g)T.recalculate(_,y)}class OA{constructor(c){this.entries={},this.scheduler=c}request(c,y,_,T){const R=this.entries[c]=this.entries[c]||{callbacks:[]};if(R.result){const[z,W]=R.result;return this.scheduler?this.scheduler.add(()=>{T(z,W)},y):T(z,W),()=>{}}return R.callbacks.push(T),R.cancel||(R.cancel=_((z,W)=>{R.result=[z,W];for(const et of R.callbacks)this.scheduler?this.scheduler.add(()=>{et(z,W)},y):et(z,W);setTimeout(()=>delete this.entries[c],3e3)})),()=>{R.result||(R.callbacks=R.callbacks.filter(z=>z!==T),R.callbacks.length||(R.cancel(),delete this.entries[c]))}}}function zA(g,c,y){const _=JSON.stringify(g.request);return g.data&&(this.deduped.entries[_]={result:[null,g.data]}),this.deduped.request(_,{type:"parseTile",isSymbolTile:g.isSymbolTile,zoom:g.tileZoom},T=>{const R=Xt(g.request,(z,W,et,st)=>{z?T(z):W&&T(null,{vectorTile:y?void 0:new jc.VectorTile(new Ap(W)),rawData:W,cacheControl:et,expires:st})});return()=>{R.cancel(),T()}},c)}const NU=Qs(new Float32Array(16));class Dl{constructor(c){this.name=c.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(c,y){return{x:0,y:0,z:0}}unproject(c,y){return new Ar(0,0)}projectTilePoint(c,y,_){return{x:c,y,z:0}}locationPoint(c,y){return c._coordinatePoint(c.locationCoordinate(y),!1)}pixelsPerMeter(c,y){return Fh(1,c)*y}farthestPixelDistance(c){return function(y,_){const T=y.fovAboveCenter,R=y.elevation?y.elevation.getMinElevationBelowMSL()*_:0,z=(y._camera.position[2]*y.worldSize-R)/Math.cos(y._pitch),W=Math.sin(T)*z/Math.sin(Math.max(Math.PI/2-y._pitch-T,.01)),et=Math.sin(y._pitch)*W+z;return Math.min(1.01*et,z*(1/y._horizonShift))}(c,c.pixelsPerMeter)}pointCoordinate(c,y,_,T){const R=c.horizonLineFromTop(!1),z=new f(y,Math.max(R,_));return c.rayIntersectionCoordinate(c.pointRayIntersection(z,T))}createInversionMatrix(c,y){return NU}createTileMatrix(c,y,_){let T,R,z;const W=_.canonical,et=Qs(new Float64Array(16));if(this.isReprojectedInTileSpace){const st=Gc(W,this);T=1,R=st.x+_.wrap*st.scale,z=st.y,Ml(et,et,[T/st.scale,T/st.scale,c.pixelsPerMeter/y])}else T=y/c.zoomScale(W.z),R=(W.x+Math.pow(2,W.z)*_.wrap)*T,z=W.y*T;return Uc(et,et,[R,z,0]),Ml(et,et,[T/tr,T/tr,1]),et}upVector(c,y,_){return[0,0,1]}upVectorScale(c,y,_){return{metersToTile:1,metersToLabelSpace:1}}}class OU extends Dl{constructor(c){super(c),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(c,y){return{x:cp(c),y:Bh(y),z:0}}unproject(c,y){const _=ns(c),T=Ri(y);return new Ar(_,T)}}class zU extends Dl{constructor(c){super(c),this.range=[4,7],this.center=c.center||[-96,37.5];const[y,_]=this.parallels=c.parallels||[29.5,45.5],T=Math.sin(x(y));this.n=(T+Math.sin(x(_)))/2,this.c=1+T*(2*this.n-T),this.r0=Math.sqrt(this.c)/this.n}project(c,y){const{n:_,c:T,r0:R}=this,z=x(c-this.center[0]),W=x(y),et=Math.sqrt(T-2*_*Math.sin(W))/_;return{x:et*Math.sin(z*_),y:et*Math.cos(z*_)-R,z:0}}unproject(c,y){const{n:_,c:T,r0:R}=this,z=R+y;let W=Math.atan2(c,Math.abs(z))*Math.sign(z);z*_<0&&(W-=Math.PI*Math.sign(c)*Math.sign(z));const et=x(this.center[0])*_;W=j(W,-Math.PI-et,Math.PI-et);const st=w(W/_)+this.center[0],ht=Math.asin(V((T-(c*c+z*z)*_*_)/(2*_),-1,1)),pt=V(w(ht),-85.051129,$s);return new Ar(st,pt)}}const Rp=1.340264,kp=-.081106,Ip=893e-6,Lp=.003796,f1=Math.sqrt(3)/2;class UU extends Dl{project(c,y){y=y/180*Math.PI,c=c/180*Math.PI;const _=Math.asin(f1*Math.sin(y)),T=_*_,R=T*T*T;return{x:.5*(c*Math.cos(_)/(f1*(Rp+3*kp*T+R*(7*Ip+9*Lp*T)))/Math.PI+.5),y:1-.5*(_*(Rp+kp*T+R*(Ip+Lp*T))/Math.PI+1),z:0}}unproject(c,y){c=(2*c-.5)*Math.PI;let _=y=(2*(1-y)-1)*Math.PI,T=_*_,R=T*T*T;for(let ht,pt,bt,Et=0;Et<12&&(pt=_*(Rp+kp*T+R*(Ip+Lp*T))-y,bt=Rp+3*kp*T+R*(7*Ip+9*Lp*T),ht=pt/bt,_=V(_-ht,-Math.PI/3,Math.PI/3),T=_*_,R=T*T*T,!(Math.abs(ht)<1e-12));++Et);const z=f1*c*(Rp+3*kp*T+R*(7*Ip+9*Lp*T))/Math.cos(_),W=Math.asin(Math.sin(_)/f1),et=V(180*z/Math.PI,-180,180),st=V(180*W/Math.PI,-85.051129,$s);return new Ar(et,st)}}class VU extends Dl{constructor(c){super(c),this.wrap=!0,this.supportsWorldCopies=!0}project(c,y){return{x:.5+c/360,y:.5-y/360,z:0}}unproject(c,y){const _=360*(c-.5),T=V(360*(.5-y),-85.051129,$s);return new Ar(_,T)}}const Jh=Math.PI/2;function p1(g){return Math.tan((Jh+g)/2)}class jU extends Dl{constructor(c){super(c),this.center=c.center||[0,30];const[y,_]=this.parallels=c.parallels||[30,30],T=x(y),R=x(_),z=Math.cos(T);this.n=T===R?Math.sin(T):Math.log(z/Math.cos(R))/Math.log(p1(R)/p1(T)),this.f=z*Math.pow(p1(T),this.n)/this.n}project(c,y){y=x(y),c=x(c-this.center[0]);const _=1e-6,{n:T,f:R}=this;R>0?y<-Jh+_&&(y=-Jh+_):y>Jh-_&&(y=Jh-_);const z=R/Math.pow(p1(y),T),W=z*Math.sin(T*c),et=R-z*Math.cos(T*c);return{x:.5*(W/Math.PI+.5),y:1-.5*(et/Math.PI+.5),z:0}}unproject(c,y){c=(2*c-.5)*Math.PI,y=(2*(1-y)-.5)*Math.PI;const{n:_,f:T}=this,R=T-y,z=Math.sign(R),W=Math.sign(_)*Math.sqrt(c*c+R*R);let et=Math.atan2(c,Math.abs(R))*z;R*_<0&&(et-=Math.PI*Math.sign(c)*z);const st=V(w(et/_)+this.center[0],-180,180),ht=V(w(2*Math.atan(Math.pow(T/W,1/_))-Jh),-85.051129,$s);return new Ar(st,ht)}}const UA=x($s);class GU extends Dl{project(c,y){const _=(y=x(y))*y,T=_*_;return{x:.5*((c=x(c))*(.8707-.131979*_+T*(T*(.003971*_-.001529*T)-.013791))/Math.PI+.5),y:1-.5*(y*(1.007226+_*(.015085+T*(.028874*_-.044475-.005916*T)))/Math.PI+1),z:0}}unproject(c,y){c=(2*c-.5)*Math.PI;let _=y=(2*(1-y)-1)*Math.PI,T=25,R=0,z=_*_;do{z=_*_;const st=z*z;R=(_*(1.007226+z*(.015085+st*(.028874*z-.044475-.005916*st)))-y)/(1.007226+z*(.045255+st*(.259866*z-.311325-.005916*11*st))),_=V(_-R,-UA,UA)}while(Math.abs(R)>1e-6&&--T>0);z=_*_;const W=V(w(c/(.8707+z*(z*(z*z*z*(.003971-.001529*z)-.013791)-.131979))),-180,180),et=w(_);return new Ar(W,et)}}const VA=x($s);class HU extends Dl{project(c,y){y=x(y),c=x(c);const _=Math.cos(y),T=2/Math.PI,R=Math.acos(_*Math.cos(c/2)),z=Math.sin(R)/R,W=.5*(c*T+2*_*Math.sin(c/2)/z)||0,et=.5*(y+Math.sin(y)/z)||0;return{x:.5*(W/Math.PI+.5),y:1-.5*(et/Math.PI+1),z:0}}unproject(c,y){let _=c=(2*c-.5)*Math.PI,T=y=(2*(1-y)-1)*Math.PI,R=25;const z=1e-6;let W=0,et=0;do{const st=Math.cos(T),ht=Math.sin(T),pt=2*ht*st,bt=ht*ht,Et=st*st,kt=Math.cos(_/2),Ft=Math.sin(_/2),Vt=2*kt*Ft,$t=Ft*Ft,ue=1-Et*kt*kt,ge=ue?1/ue:0,xe=ue?Math.acos(st*kt)*Math.sqrt(1/ue):0,_e=.5*(2*xe*st*Ft+2*_/Math.PI)-c,we=.5*(xe*ht+T)-y,Be=.5*ge*(Et*$t+xe*st*kt*bt)+1/Math.PI,Oe=ge*(Vt*pt/4-xe*ht*Ft),Je=.125*ge*(pt*Ft-xe*ht*Et*Vt),tn=.5*ge*(bt*kt+xe*$t*st)+.5,De=Oe*Je-tn*Be;W=(we*Oe-_e*tn)/De,et=(_e*Je-we*Be)/De,_=V(_-W,-Math.PI,Math.PI),T=V(T-et,-VA,VA)}while((Math.abs(W)>z||Math.abs(et)>z)&&--R>0);return new Ar(w(_),w(T))}}class jA extends Dl{constructor(c){super(c),this.center=c.center||[0,0],this.parallels=c.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(x(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(c,y){const{scale:_,cosPhi:T}=this;return{x:x(c)*T*_+.5,y:-Math.sin(x(y))/T*_+.5,z:0}}unproject(c,y){const{scale:_,cosPhi:T}=this,R=-(y-.5)/_,z=V(w((c-.5)/_)/T,-180,180),W=Math.asin(V(R*T,-1,1)),et=V(w(W),-85.051129,$s);return new Ar(z,et)}}r.ARRAY_TYPE=To,r.AUTH_ERR_MSG=Pe,r.Aabb=qo,r.Actor=class{constructor(g,c,y){this.target=g,this.parent=c,this.mapId=y,this.callbacks={},this.cancelCallbacks={},L(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Q()?g:p,this.scheduler=new AU}send(g,c,y,_,T=!1,R){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);y&&(y.metadata=R,this.callbacks[z]=y);const W=_t(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:g,hasCallback:!!y,targetMapId:_,mustQueue:T,sourceMapId:this.mapId,data:Dc(c,W)},W),{cancel:()=>{y&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:_,sourceMapId:this.mapId})}}}receive(g){const c=g.data,y=c.id;if(y&&(!c.targetMapId||this.mapId===c.targetMapId))if(c.type==="<cancel>"){const _=this.cancelCallbacks[y];delete this.cancelCallbacks[y],_&&_.cancel()}else if(c.mustQueue||Q()){const _=this.callbacks[y];this.cancelCallbacks[y]=this.scheduler.add(()=>this.processTask(y,c),_&&_.metadata||{type:"message"})}else this.processTask(y,c)}processTask(g,c){if(c.type==="<response>"){const y=this.callbacks[g];delete this.callbacks[g],y&&(c.error?y(ml(c.error)):y(null,ml(c.data)))}else{const y=_t(this.globalScope)?void 0:[],_=c.hasCallback?(R,z)=>{delete this.cancelCallbacks[g],this.target.postMessage({id:g,type:"<response>",sourceMapId:this.mapId,error:R?Dc(R):null,data:Dc(z,y)},y)}:R=>{},T=ml(c.data);if(this.parent[c.type])this.parent[c.type](c.sourceMapId,T,_);else if(this.parent.getWorkerSource){const R=c.type.split(".");this.parent.getWorkerSource(c.sourceMapId,R[0],T.source)[R[1]](T,_)}else _(new Error(`Could not find function ${c.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.CanonicalTileID=c1,r.Color=ar,r.ColorMode=ra,r.CullFaceMode=Ss,r.DEMData=h1,r.DataConstantProperty=ot,r.DedupedRequest=OA,r.DepthMode=Zh,r.EXTENT=tr,r.Elevation=class{isDataAvailableAtPoint(g){const c=this._source();if(!c||g.y<0||g.y>1)return!1;const y=c.getSource().maxzoom,_=1<<y,T=Math.floor(g.x),R=Math.floor((g.x-T)*_),z=Math.floor(g.y*_),W=this.findDEMTileFor(new Yi(y,T,y,R,z));return!(!W||!W.dem)}getAtPointOrZero(g,c=0){return this.getAtPoint(g,c)||0}getAtPoint(g,c,y=!0){c==null&&(c=null);const _=this._source();if(!_||g.y<0||g.y>1)return c;const T=_.getSource().maxzoom,R=1<<T,z=Math.floor(g.x),W=g.x-z,et=new Yi(T,z,T,Math.floor(W*R),Math.floor(g.y*R)),st=this.findDEMTileFor(et);if(!st||!st.dem)return c;const ht=st.dem,pt=1<<st.tileID.canonical.z,bt=(W*pt-st.tileID.canonical.x)*ht.dim,Et=(g.y*pt-st.tileID.canonical.y)*ht.dim,kt=Math.floor(bt),Ft=Math.floor(Et);return(y?this.exaggeration():1)*Nn(Nn(ht.get(kt,Ft),ht.get(kt,Ft+1),Et-Ft),Nn(ht.get(kt+1,Ft),ht.get(kt+1,Ft+1),Et-Ft),bt-kt)}getAtTileOffset(g,c,y){const _=1<<g.canonical.z;return this.getAtPointOrZero(new j0(g.wrap+(g.canonical.x+c/tr)/_,(g.canonical.y+y/tr)/_))}getAtTileOffsetFunc(g,c,y,_){return T=>{const R=this.getAtTileOffset(g,T.x,T.y),z=_.upVector(g.canonical,T.x,T.y);return hp(z,z,R*_.upVectorScale(g.canonical,c,y).metersToTile),z}}getForTilePoints(g,c,y,_){const T=d1.create(this,g,_);return!!T&&(c.forEach(R=>{R[2]=this.exaggeration()*T.getElevationAt(R[0],R[1],y)}),!0)}getMinMaxForTile(g){const c=this.findDEMTileFor(g);if(!c||!c.dem)return null;const y=c.dem.tree,_=c.tileID,T=1<<g.canonical.z-_.canonical.z;let R=g.canonical.x/T-_.canonical.x,z=g.canonical.y/T-_.canonical.y,W=0;for(let et=0;et<g.canonical.z-_.canonical.z&&!y.leaves[W];et++){R*=2,z*=2;const st=2*Math.floor(z)+Math.floor(R);W=y.childOffsets[W]+st,R%=1,z%=1}return{min:this.exaggeration()*y.minimums[W],max:this.exaggeration()*y.maximums[W]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(g,c,y){throw new Error("Pure virtual method called.")}pointCoordinate(g){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(g){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},r.ErrorEvent=Lt,r.EvaluationParameters=Dr,r.Event=Tt,r.Evented=ee,r.FillExtrusionBucket=_p,r.Frustum=gv,r.GLOBE_RADIUS=Kh,r.GlobeSharedBuffers=class{constructor(g){this._createGrid(g),this._createPoles(g),this._createAtmosphere(g)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const g of this._poleSegments)g.destroy();this._gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this._wireframeIndexBuffer&&(this._wireframeIndexBuffer.destroy(),this._wireframeSegments.destroy())}_createGrid(g){const c=new ie,y=new _n,_=65;for(let T=0;T<_;T++)for(let R=0;R<_;R++)c.emplaceBack(R,T);for(let T=0;T<64;T++)for(let R=0;R<64;R++){const z=T*_+R;y.emplaceBack(z+1,z,z+_),y.emplaceBack(z+_,z+_+1,z+1)}this._gridBuffer=g.createVertexBuffer(c,Cp.members),this._gridIndexBuffer=g.createIndexBuffer(y,!0),this._gridSegments=Kr.simpleSegment(0,0,4225,8192)}_createPoles(g){const c=new _n;for(let T=0;T<=64;T++)c.emplaceBack(0,T+1,T+2);this._poleIndexBuffer=g.createIndexBuffer(c,!0);const y=new Vn,_=new Vn;this._poleSegments=[];for(let T=0,R=0;T<5;T++){const z=1<<T,W=512*z/Math.PI/2,et=360/z;y.emplaceBack(0,-W,0,0,0,.5,0),_.emplaceBack(0,-W,0,0,0,.5,1);for(let st=0;st<=64;st++){const ht=st/64,pt=Nn(0,et,ht),[bt,Et,kt]=dA(DU,RU,pt,W);y.emplaceBack(bt,Et,kt,0,0,ht,0),_.emplaceBack(bt,Et,kt,0,0,ht,1)}this._poleSegments.push(Kr.simpleSegment(R,0,66,64)),R+=66}this._poleNorthVertexBuffer=g.createVertexBuffer(y,uA,!1),this._poleSouthVertexBuffer=g.createVertexBuffer(_,uA,!1)}_createAtmosphere(g){const c=new ir;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const y=new _n;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.atmosphereVertexBuffer=g.createVertexBuffer(c,EU.members),this.atmosphereIndexBuffer=g.createIndexBuffer(y),this.atmosphereSegments=Kr.simpleSegment(0,0,4,2)}getGridBuffers(){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments]}getPoleBuffers(g){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[g]]}getWirefameBuffers(g){if(!this._wireframeSegments){const c=new Gn,y=64,_=y+1;for(let T=0;T<y;T++)for(let R=0;R<y;R++){const z=T*_+R;c.emplaceBack(z,z+1),c.emplaceBack(z,z+_),c.emplaceBack(z,z+_+1)}this._wireframeIndexBuffer=g.createIndexBuffer(c),this._wireframeSegments=Kr.simpleSegment(0,0,y*y,c.length)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments]}},r.GlyphManager=Xh,r.ImagePosition=Cv,r.LineAtlas=Vv,r.LngLat=Ar,r.LngLatBounds=wl,r.LocalGlyphMode=kv,r.MAX_MERCATOR_LATITUDE=$s,r.MercatorCoordinate=j0,r.ONE_EM=ki,r.OverscaledTileID=Yi,r.Properties=Pt,r.RGBAImage=Co,r.Ray=class{constructor(g,c){this.pos=g,this.dir=c}intersectsPlane(g,c,y){const _=fp(c,this.dir);if(Math.abs(_)<1e-6)return!1;const T=((g[0]-this.pos[0])*c[0]+(g[1]-this.pos[1])*c[1]+(g[2]-this.pos[2])*c[2])/_;return y[0]=this.pos[0]+this.dir[0]*T,y[1]=this.pos[1]+this.dir[1]*T,y[2]=this.pos[2]+this.dir[2]*T,!0}closestPointOnSphere(g,c,y){if(function(bt,Et){var kt=bt[0],Ft=bt[1],Vt=bt[2],$t=Et[0],ue=Et[1],ge=Et[2];return Math.abs(kt-$t)<=lv*Math.max(1,Math.abs(kt),Math.abs($t))&&Math.abs(Ft-ue)<=lv*Math.max(1,Math.abs(Ft),Math.abs(ue))&&Math.abs(Vt-ge)<=lv*Math.max(1,Math.abs(Vt),Math.abs(ge))}(this.pos,g)||c===0)return y[0]=y[1]=y[2]=0,!1;const[_,T,R]=this.dir,z=this.pos[0]-g[0],W=this.pos[1]-g[1],et=this.pos[2]-g[2],st=_*_+T*T+R*R,ht=2*(z*_+W*T+et*R),pt=ht*ht-4*st*(z*z+W*W+et*et-c*c);if(pt<0){const bt=Math.max(-ht/2,0),Et=z+_*bt,kt=W+T*bt,Ft=et+R*bt,Vt=Math.hypot(Et,kt,Ft);return y[0]=Et*c/Vt,y[1]=kt*c/Vt,y[2]=Ft*c/Vt,!1}{const bt=(-ht-Math.sqrt(pt))/(2*st);if(bt<0){const Et=Math.hypot(z,W,et);return y[0]=z*c/Et,y[1]=W*c/Et,y[2]=et*c/Et,!1}return y[0]=z+_*bt,y[1]=W+T*bt,y[2]=et+R*bt,!0}}},r.RequestManager=class{constructor(g,c,y){this._transformRequestFn=g,this._customAccessToken=c,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const g=function(){let c="";for(let y=0;y<10;y++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Me,c].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=g.token,this._skuTokenExpiresAt=g.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(g,c){return this._transformRequestFn&&this._transformRequestFn(g,c)||{url:g}}normalizeStyleURL(g,c){if(!ze(g))return g;const y=Ye(g);return y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||c)}normalizeGlyphsURL(g,c){if(!ze(g))return g;const y=Ye(g);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||c)}normalizeSourceURL(g,c){if(!ze(g))return g;const y=Ye(g);return y.path=`/v4/${y.authority}.json`,y.params.push("secure"),this._makeAPIURL(y,this._customAccessToken||c)}normalizeSpriteURL(g,c,y,_){const T=Ye(g);return ze(g)?(T.path=`/styles/v1${T.path}/sprite${c}${y}`,this._makeAPIURL(T,this._customAccessToken||_)):(T.path+=`${c}${y}`,le(T))}normalizeTileURL(g,c,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),g&&!ze(g))return g;const _=Ye(g);_.path=_.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||y&&_.authority!=="raster"&&y===512?"@2x":""}${At.supported?".webp":"$1"}`),_.authority==="raster"?_.path=`/${mt.RASTER_URL_PREFIX}${_.path}`:(_.path=_.path.replace(/^.+\/v4\//,"/"),_.path=`/${mt.TILE_URL_VERSION}${_.path}`);const T=this._customAccessToken||function(R){for(const z of R){const W=z.match(/^access_token=(.*)$/);if(W)return W[1]}return null}(_.params)||mt.ACCESS_TOKEN;return mt.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&_.params.push(`sku=${this._skuToken}`),this._makeAPIURL(_,T)}canonicalizeTileURL(g,c){const y=Ye(g);if(!y.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!y.path.match(/\.[\w]+$/))return g;let _="mapbox://";y.path.match(/^\/raster\/v1\//)?_+=`raster/${y.path.replace(`/${mt.RASTER_URL_PREFIX}/`,"")}`:_+=`tiles/${y.path.replace(`/${mt.TILE_URL_VERSION}/`,"")}`;let T=y.params;return c&&(T=T.filter(R=>!R.match(/^access_token=/))),T.length&&(_+=`?${T.join("&")}`),_}canonicalizeTileset(g,c){const y=!!c&&ze(c),_=[];for(const T of g.tiles||[])Ce(T)?_.push(this.canonicalizeTileURL(T,y)):_.push(T);return _}_makeAPIURL(g,c){const y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",_=Ye(mt.API_URL);if(g.protocol=_.protocol,g.authority=_.authority,g.protocol==="http"){const T=g.params.indexOf("secure");T>=0&&g.params.splice(T,1)}if(_.path!=="/"&&(g.path=`${_.path}${g.path}`),!mt.REQUIRE_ACCESS_TOKEN)return le(g);if(c=c||mt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(c[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return g.params=g.params.filter(T=>T.indexOf("access_token")===-1),g.params.push(`access_token=${c||""}`),le(g)}},r.ResourceType=Wt,r.SegmentVector=Kr,r.SourceCache=Hc,r.StencilMode=Xv,r.StructArrayLayout1ui2=gr,r.StructArrayLayout2f1f2i16=En,r.StructArrayLayout2i4=ie,r.StructArrayLayout2ui4=Gn,r.StructArrayLayout3f12=cn,r.StructArrayLayout3ui6=_n,r.StructArrayLayout4i8=ce,r.Texture=Tp,r.Tile=Wv,r.Transitionable=P,r.Uniform1f=U0,r.Uniform1i=class extends Ra{constructor(g,c){super(g,c),this.current=0}set(g){this.current!==g&&(this.current=g,this.gl.uniform1i(this.location,g))}},r.Uniform2f=class extends Ra{constructor(g,c){super(g,c),this.current=[0,0]}set(g){g[0]===this.current[0]&&g[1]===this.current[1]||(this.current=g,this.gl.uniform2f(this.location,g[0],g[1]))}},r.Uniform3f=class extends Ra{constructor(g,c){super(g,c),this.current=[0,0,0]}set(g){g[0]===this.current[0]&&g[1]===this.current[1]&&g[2]===this.current[2]||(this.current=g,this.gl.uniform3f(this.location,g[0],g[1],g[2]))}},r.Uniform4f=qM,r.UniformColor=XM,r.UniformMatrix2f=class extends Ra{constructor(g,c){super(g,c),this.current=EO}set(g){for(let c=0;c<4;c++)if(g[c]!==this.current[c]){this.current=g,this.gl.uniformMatrix2fv(this.location,!1,g);break}}},r.UniformMatrix3f=class extends Ra{constructor(g,c){super(g,c),this.current=SO}set(g){for(let c=0;c<9;c++)if(g[c]!==this.current[c]){this.current=g,this.gl.uniformMatrix3fv(this.location,!1,g);break}}},r.UniformMatrix4f=class extends Ra{constructor(g,c){super(g,c),this.current=AO}set(g){if(g[12]!==this.current[12]||g[0]!==this.current[0])return this.current=g,void this.gl.uniformMatrix4fv(this.location,!1,g);for(let c=1;c<16;c++)if(g[c]!==this.current[c]){this.current=g,this.gl.uniformMatrix4fv(this.location,!1,g);break}}},r.UnwrappedTileID=vA,r.ValidationError=yn,r.VectorTileWorkerSource=class extends ee{constructor(g,c,y,_,T){super(),this.actor=g,this.layerIndex=c,this.availableImages=y,this.loadVectorData=T||zA,this.loading={},this.loaded={},this.deduped=new OA(g.scheduler),this.isSpriteLoaded=_,this.scheduler=g.scheduler}loadTile(g,c){const y=g.uid,_=g&&g.request,T=_&&_.collectResourceTiming,R=this.loading[y]=new FU(g);R.abort=this.loadVectorData(g,(z,W)=>{const et=!this.loading[y];if(delete this.loading[y],et||z||!W)return R.status="done",et||(this.loaded[y]=R),c(z);const st=W.rawData,ht={};W.expires&&(ht.expires=W.expires),W.cacheControl&&(ht.cacheControl=W.cacheControl),R.vectorTile=W.vectorTile||new jc.VectorTile(new Ap(st));const pt=()=>{R.parse(R.vectorTile,this.layerIndex,this.availableImages,this.actor,(bt,Et)=>{if(bt||!Et)return c(bt);const kt={};if(T){const Ft=cA(_);Ft.length>0&&(kt.resourceTiming=JSON.parse(JSON.stringify(Ft)))}c(null,rt({rawTileData:st.slice(0)},Et,ht,kt))})};this.isSpriteLoaded?pt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(pt,{type:"parseTile",isSymbolTile:g.isSymbolTile,zoom:g.tileZoom}):pt()}),this.loaded=this.loaded||{},this.loaded[y]=R})}reloadTile(g,c){const y=this.loaded,_=g.uid,T=this;if(y&&y[_]){const R=y[_];R.showCollisionBoxes=g.showCollisionBoxes,R.enableTerrain=!!g.enableTerrain,R.projection=g.projection,R.tileTransform=Gc(g.tileID.canonical,g.projection);const z=(W,et)=>{const st=R.reloadCallback;st&&(delete R.reloadCallback,R.parse(R.vectorTile,T.layerIndex,this.availableImages,T.actor,st)),c(W,et)};R.status==="parsing"?R.reloadCallback=z:R.status==="done"&&(R.vectorTile?R.parse(R.vectorTile,this.layerIndex,this.availableImages,this.actor,z):z())}}abortTile(g,c){const y=g.uid,_=this.loading[y];_&&(_.abort&&_.abort(),delete this.loading[y]),c()}removeTile(g,c){const y=this.loaded,_=g.uid;y&&y[_]&&delete y[_],c()}},r.WritingMode=Xo,r.ZoomHistory=Kf,r.add=l3,r.addDynamicAttributes=Fv,r.adjoint=function(g,c){var y=c[0],_=c[1],T=c[2],R=c[3],z=c[4],W=c[5],et=c[6],st=c[7],ht=c[8];return g[0]=z*ht-W*st,g[1]=T*st-_*ht,g[2]=_*W-T*z,g[3]=W*et-R*ht,g[4]=y*ht-T*et,g[5]=T*R-y*W,g[6]=R*st-z*et,g[7]=_*et-y*st,g[8]=y*z-_*R,g},r.asyncAll=Z,r.bezier=D,r.bindAll=L,r.boundsAttributes=MA,r.bufferConvexPolygon=function(g,c){const y=[];for(let _=0;_<g.length;_++){const T=j(_-1,-1,g.length-1),R=j(_+1,-1,g.length-1),z=g[_],W=g[R],et=g[T].sub(z).unit(),st=W.sub(z).unit(),ht=st.angleWithSep(et.x,et.y),pt=et.add(st).unit().mult(-1*c/Math.sin(ht/2));y.push(z.add(pt))}return y},r.cacheEntryPossiblyAdded=function(g){Qn++,Qn>cr&&(g.getActor().send("enforceCacheSizeLimit",Pn),Qn=0)},r.calculateGlobeLabelMatrix=function(g,c){const{lng:y,lat:_}=g._center,T=mA(0,0,g.worldSize/g._projectionScaler,y,_);return cv(T,T,function(R){const z=Qs(new Float64Array(16)),W=1/Hv(R);return Uc(z,z,R.min),Ml(z,z,[W,W,W]),z}(Pp(c)))},r.calculateGlobeMatrix=gA,r.calculateGlobeMercatorMatrix=function(g){const c=g.worldSize,y=g.point,_=Fh(1,g.center.lat)*c,T=g.pixelsPerMeter,R=c/(_/g.pixelsPerMeter),z=Qs(new Float64Array(16));return Uc(z,z,[y.x,y.y,0]),Ml(z,z,[R,R,T]),Float32Array.from(z)},r.circumferenceAtLatitude=nv,r.clamp=V,r.clearTileCache=function(g){const c=p.caches.delete(Sn);g&&c.catch(g).then(()=>g())},r.clipLine=tA,r.clone=function(g){var c=new To(16);return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c[4]=g[4],c[5]=g[5],c[6]=g[6],c[7]=g[7],c[8]=g[8],c[9]=g[9],c[10]=g[10],c[11]=g[11],c[12]=g[12],c[13]=g[13],c[14]=g[14],c[15]=g[15],c},r.clone$1=it,r.collisionCircleLayout=Fz,r.config=mt,r.conjugate=function(g,c){return g[0]=-c[0],g[1]=-c[1],g[2]=-c[2],g[3]=c[3],g},r.create=function(){var g=new To(16);return To!=Float32Array&&(g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[11]=0,g[12]=0,g[13]=0,g[14]=0),g[0]=1,g[5]=1,g[10]=1,g[15]=1,g},r.create$1=o3,r.createExpression=wc,r.createLayout=ae,r.createStyleLayer=function(g){return g.type==="custom"?new vU(g):new _U[g.type](g)},r.cross=h3,r.degToRad=x,r.div=function(g,c,y){return g[0]=c[0]/y[0],g[1]=c[1]/y[1],g[2]=c[2]/y[2],g},r.dot=fp,r.earthRadius=ev,r.ease=N,r.easeCubicInOut=E,r.emitValidationErrors=x0,r.endsWith=B,r.enforceCacheSizeLimit=function(g){Yn(),On&&On.then(c=>{c.keys().then(y=>{for(let _=0;_<y.length-g;_++)c.delete(y[_])})})},r.evaluateSizeForFeature=t1,r.evaluateSizeForZoom=Gh,r.evaluateVariableOffset=oA,r.evented=op,r.exactEquals=function(g,c){return g[0]===c[0]&&g[1]===c[1]&&g[2]===c[2]&&g[3]===c[3]},r.exactEquals$1=function(g,c){return g[0]===c[0]&&g[1]===c[1]&&g[2]===c[2]},r.exported=Gt,r.exported$1=At,r.extend=rt,r.extend$1=Ve,r.filterObject=q,r.fromMat4=function(g,c){return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[4],g[4]=c[5],g[5]=c[6],g[6]=c[8],g[7]=c[9],g[8]=c[10],g},r.fromQuat=function(g,c){var y=c[0],_=c[1],T=c[2],R=c[3],z=y+y,W=_+_,et=T+T,st=y*z,ht=_*z,pt=_*W,bt=T*z,Et=T*W,kt=T*et,Ft=R*z,Vt=R*W,$t=R*et;return g[0]=1-pt-kt,g[1]=ht+$t,g[2]=bt-Vt,g[3]=0,g[4]=ht-$t,g[5]=1-st-kt,g[6]=Et+Ft,g[7]=0,g[8]=bt+Vt,g[9]=Et-Ft,g[10]=1-st-pt,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g},r.fromRotation=function(g,c){var y=Math.sin(c),_=Math.cos(c);return g[0]=_,g[1]=y,g[2]=0,g[3]=-y,g[4]=_,g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},r.fromScaling=function(g,c){return g[0]=c[0],g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=c[1],g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=c[2],g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g},r.furthestTileCorner=function(g){const c=Math.round((g+45+360)%360/90)%4;return M[c]},r.getAABBPointSquareDist=function(g,c,y){let _=0;for(let T=0;T<2;++T){const R=y?y[T]:0;g[T]>R&&(_+=(g[T]-R)*(g[T]-R)),c[T]<R&&(_+=(R-c[T])*(R-c[T]))}return _},r.getAnchorAlignment=Rv,r.getAnchorJustification=Lv,r.getBounds=function(g){let c=1/0,y=1/0,_=-1/0,T=-1/0;for(const R of g)c=Math.min(c,R.x),y=Math.min(y,R.y),_=Math.max(_,R.x),T=Math.max(T,R.y);return{min:new f(c,y),max:new f(_,T)}},r.getColumn=function(g,c){return[g[4*c],g[4*c+1],g[4*c+2],g[4*c+3]]},r.getGridMatrix=function(g,c){const[y,_]=c,T=.015625;return[0,(_[1]-y[1])*T,1<<g.z,(_[0]-y[0])*T,0,g.y,y[0],y[1],T]},r.getImage=Xe,r.getJSON=function(g,c){return jt(rt(g,{type:"json"}),c)},r.getMapSessionAPI=Hn,r.getPerformanceMeasurement=cA,r.getProjection=function(g){const c=g.parallels,y=!!c&&Math.abs(c[0]+c[1])<.01;switch(g.name){case"mercator":return new OU(g);case"equirectangular":return new VU(g);case"naturalEarth":return new GU(g);case"equalEarth":return new UU(g);case"winkelTripel":return new HU(g);case"albers":return y?new jA(g):new zU(g);case"lambertConformalConic":return y?new jA(g):new jU(g)}throw new Error(`Invalid projection name: ${g.name}`)},r.getRTLTextPluginStatus=Ih,r.getReferrer=Rt,r.getTilePoint=function(g,{x:c,y},_=0){return new f(((c-_)*g.scale-g.x)*tr,(y*g.scale-g.y)*tr)},r.getTileVec3=function(g,c,y=0){return up(((c.x-y)*g.scale-g.x)*tr,(c.y*g.scale-g.y)*tr,ZM(c.z,c.y))},r.getVideo=function(g,c){const y=p.document.createElement("video");y.muted=!0,y.onloadstart=function(){c(null,y)};for(let _=0;_<g.length;_++){const T=p.document.createElement("source");Kt(g[_])||(y.crossOrigin="Anonymous"),T.src=g[_],y.appendChild(T)}return{cancel:()=>{}}},r.globeECEFOrigin=function(g,c){const y=[0,0,0];return Vc(y,y,pA(Pp(c.canonical))),Vc(y,y,g),y},r.globePixelsToTileUnits=function(g,c){return tr/(512*Math.pow(2,g))*Hv(Pp(c))},r.globePoleMatrixForTile=function(g,c,y){const _=Qs(new Float64Array(16)),T=1<<g,R=360*(c/T-.5),z=y.point,W=y.worldSize/(y.tileSize*T);return Uc(_,_,[z.x,z.y,-y.worldSize/Math.PI/2]),Ml(_,_,[W,W,W]),uv(_,_,x(-y._center.lat)),hv(_,_,x(-y._center.lng+R)),Float32Array.from(_)},r.globeTileLatLngCorners=Gv,r.globeToMercatorTransition=function(g){return K(5,6,g)},r.identity=Qs,r.identity$1=p3,r.invert=function(g,c){var y=c[0],_=c[1],T=c[2],R=c[3],z=c[4],W=c[5],et=c[6],st=c[7],ht=c[8],pt=c[9],bt=c[10],Et=c[11],kt=c[12],Ft=c[13],Vt=c[14],$t=c[15],ue=y*W-_*z,ge=y*et-T*z,xe=y*st-R*z,_e=_*et-T*W,we=_*st-R*W,Be=T*st-R*et,Oe=ht*Ft-pt*kt,Je=ht*Vt-bt*kt,tn=ht*$t-Et*kt,De=pt*Vt-bt*Ft,qe=pt*$t-Et*Ft,nn=bt*$t-Et*Vt,fn=ue*nn-ge*qe+xe*De+_e*tn-we*Je+Be*Oe;return fn?(g[0]=(W*nn-et*qe+st*De)*(fn=1/fn),g[1]=(T*qe-_*nn-R*De)*fn,g[2]=(Ft*Be-Vt*we+$t*_e)*fn,g[3]=(bt*we-pt*Be-Et*_e)*fn,g[4]=(et*tn-z*nn-st*Je)*fn,g[5]=(y*nn-T*tn+R*Je)*fn,g[6]=(Vt*xe-kt*Be-$t*ge)*fn,g[7]=(ht*Be-bt*xe+Et*ge)*fn,g[8]=(z*qe-W*tn+st*Oe)*fn,g[9]=(_*tn-y*qe-R*Oe)*fn,g[10]=(kt*we-Ft*xe+$t*ue)*fn,g[11]=(pt*xe-ht*we-Et*ue)*fn,g[12]=(W*Je-z*De-et*Oe)*fn,g[13]=(y*De-_*Je+T*Oe)*fn,g[14]=(Ft*ge-kt*_e-Vt*ue)*fn,g[15]=(ht*_e-pt*ge+bt*ue)*fn,g):null},r.isMapAuthenticated=function(g){return Tn.has(g)},r.isMapboxURL=ze,r.isSafariWithAntialiasingBug=function(g){const c=g.navigator?g.navigator.userAgent:null;return!!_t(g)&&c&&(c.match("Version/15.4")||c.match("Version/15.5")||c.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.latFromMercatorY=Ri,r.len=GO,r.length=a3,r.length$1=function(g){return Math.hypot(g[0],g[1],g[2],g[3])},r.loadVectorTile=zA,r.makeRequest=jt,r.mercatorXfromLng=cp,r.mercatorYfromLat=Bh,r.mercatorZfromAltitude=Fh,r.mul=VO,r.mul$1=jO,r.multiply=function(g,c,y){var _=c[0],T=c[1],R=c[2],z=c[3],W=c[4],et=c[5],st=c[6],ht=c[7],pt=c[8],bt=y[0],Et=y[1],kt=y[2],Ft=y[3],Vt=y[4],$t=y[5],ue=y[6],ge=y[7],xe=y[8];return g[0]=bt*_+Et*z+kt*st,g[1]=bt*T+Et*W+kt*ht,g[2]=bt*R+Et*et+kt*pt,g[3]=Ft*_+Vt*z+$t*st,g[4]=Ft*T+Vt*W+$t*ht,g[5]=Ft*R+Vt*et+$t*pt,g[6]=ue*_+ge*z+xe*st,g[7]=ue*T+ge*W+xe*ht,g[8]=ue*R+ge*et+xe*pt,g},r.multiply$1=cv,r.multiply$2=u3,r.nextPowerOfTwo=I,r.normalize=dp,r.normalize$1=function(g,c){var y=c[0],_=c[1],T=c[2],R=c[3],z=y*y+_*_+T*T+R*R;return z>0&&(z=1/Math.sqrt(z)),g[0]=y*z,g[1]=_*z,g[2]=T*z,g[3]=R*z,g},r.number=Nn,r.ortho=function(g,c,y,_,T,R,z){var W=1/(c-y),et=1/(_-T),st=1/(R-z);return g[0]=-2*W,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*et,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*st,g[11]=0,g[12]=(c+y)*W,g[13]=(T+_)*et,g[14]=(z+R)*st,g[15]=1,g},r.pbf=Ap,r.perspective=function(g,c,y,_,T){var R,z=1/Math.tan(c/2);return g[0]=z/y,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=z,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[11]=-1,g[12]=0,g[13]=0,g[15]=0,T!=null&&T!==1/0?(g[10]=(T+_)*(R=1/(_-T)),g[14]=2*T*_*R):(g[10]=-1,g[14]=-2*_),g},r.pick=function(g,c){const y={};for(let _=0;_<c.length;_++){const T=c[_];T in g&&(y[T]=g[T])}return y},r.plugin=So,r.pointGeometry=f,r.polygonIntersectsBox=n3,r.polygonIntersectsPolygon=$M,r.polygonizeBounds=function(g,c,y=0,_=!0){const T=new f(y,y),R=g.sub(T),z=c.add(T),W=[R,new f(z.x,R.y),z,new f(R.x,z.y)];return _&&W.push(R),W},r.posAttributes=Cp,r.postMapLoadEvent=hn,r.postTurnstileEvent=ke,r.potpack=Tv,r.prevPowerOfTwo=function(g){return g<=1?1:Math.pow(2,Math.floor(Math.log(g)/Math.LN2))},r.radToDeg=w,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.registerForPluginStateChange=function(g){return g({pluginStatus:Xi,pluginURL:ao}),op.on("pluginStateChange",g),g},r.removeAuthState=function(g){Tn.delete(g)},r.renderColorRamp=bv,r.rotateX=uv,r.rotateX$1=m3,r.rotateY=hv,r.rotateZ=function(g,c,y){var _=Math.sin(y),T=Math.cos(y),R=c[0],z=c[1],W=c[2],et=c[3],st=c[4],ht=c[5],pt=c[6],bt=c[7];return c!==g&&(g[8]=c[8],g[9]=c[9],g[10]=c[10],g[11]=c[11],g[12]=c[12],g[13]=c[13],g[14]=c[14],g[15]=c[15]),g[0]=R*T+st*_,g[1]=z*T+ht*_,g[2]=W*T+pt*_,g[3]=et*T+bt*_,g[4]=st*T-R*_,g[5]=ht*T-z*_,g[6]=pt*T-W*_,g[7]=bt*T-et*_,g},r.rotateZ$1=function(g,c,y){y*=.5;var _=c[0],T=c[1],R=c[2],z=c[3],W=Math.sin(y),et=Math.cos(y);return g[0]=_*et+T*W,g[1]=T*et-_*W,g[2]=R*et+z*W,g[3]=z*et-R*W,g},r.scale=Ml,r.scale$1=function(g,c,y){return g[0]=c[0]*y,g[1]=c[1]*y,g[2]=c[2]*y,g[3]=c[3]*y,g},r.scale$2=hp,r.scaleAndAdd=mv,r.setCacheLimits=function(g,c){Pn=g,cr=c},r.setColumn=function(g,c,y){g[4*c+0]=y[0],g[4*c+1]=y[1],g[4*c+2]=y[2],g[4*c+3]=y[3]},r.setRTLTextPlugin=function(g,c,y=!1){if(Xi===np||Xi===Lc||Xi===rp)throw new Error("setRTLTextPlugin cannot be called multiple times.");ao=Gt.resolveURL(g),Xi=np,ip=c,Pa(),y||yl()},r.smoothstep=K,r.spec=Yt,r.storeAuthState=function(g,c){c?Tn.add(g):Tn.delete(g)},r.sub=zh,r.subtract=c3,r.symbolSize=Nz,r.tileAABB=function(g,c,y,_,T,R,z,W,et){if(et.name==="globe")return PU(g,c,new c1(y,_,T));const st=Gc({z:y,x:_,y:T},et);return new qo([(R+st.x/st.scale)*c,c*(st.y/st.scale),z],[(R+st.x2/st.scale)*c,c*(st.y2/st.scale),W])},r.tileTransform=Gc,r.transformMat3=function(g,c,y){var _=c[0],T=c[1],R=c[2];return g[0]=_*y[0]+T*y[3]+R*y[6],g[1]=_*y[1]+T*y[4]+R*y[7],g[2]=_*y[2]+T*y[5]+R*y[8],g},r.transformMat4=Vc,r.transformMat4$1=Uh,r.transformQuat=d3,r.translate=Uc,r.transpose=function(g,c){if(g===c){var y=c[1],_=c[2],T=c[5];g[1]=c[3],g[2]=c[6],g[3]=y,g[5]=c[7],g[6]=_,g[7]=T}else g[0]=c[0],g[1]=c[3],g[2]=c[6],g[3]=c[1],g[4]=c[4],g[5]=c[7],g[6]=c[2],g[7]=c[5],g[8]=c[8];return g},r.triggerPluginCompletionEvent=Bc,r.uniqueId=U,r.validateCustomStyleLayer=function(g){const c=[],y=g.id;return y===void 0&&c.push({message:`layers.${y}: missing required property "id"`}),g.render===void 0&&c.push({message:`layers.${y}: missing required method "render"`}),g.renderingMode&&g.renderingMode!=="2d"&&g.renderingMode!=="3d"&&c.push({message:`layers.${y}: property "renderingMode" must be either "2d" or "3d"`}),c},r.validateFilter=g=>xs(Ys(g)),r.validateFog=g=>xs(v0(g)),r.validateLayer=g=>xs(p0(g)),r.validateLight=g=>xs(y0(g)),r.validateSource=g=>xs(g0(g)),r.validateStyle=Pc,r.validateTerrain=g=>xs(b0(g)),r.values=tt,r.vectorTile=jc,r.version=u,r.warnOnce=lt,r.window=p,r.wrap=j}),a(["./shared"],function(r){function u(Wt){if(typeof Wt=="number"||typeof Wt=="boolean"||typeof Wt=="string"||Wt==null)return JSON.stringify(Wt);if(Array.isArray(Wt)){let Rt="[";for(const jt of Wt)Rt+=`${u(jt)},`;return`${Rt}]`}let St="{";for(const Rt of Object.keys(Wt).sort())St+=`${Rt}:${u(Wt[Rt])},`;return`${St}}`}function l(Wt){let St="";for(const Rt of r.refProperties)St+=`/${u(Wt[Rt])}`;return St}class h{constructor(St){this.keyCache={},St&&this.replace(St)}replace(St){this._layerConfigs={},this._layers={},this.update(St,[])}update(St,Rt){for(const Xt of St)this._layerConfigs[Xt.id]=Xt,(this._layers[Xt.id]=r.createStyleLayer(Xt)).compileFilter(),this.keyCache[Xt.id]&&delete this.keyCache[Xt.id];for(const Xt of Rt)delete this.keyCache[Xt],delete this._layerConfigs[Xt],delete this._layers[Xt];this.familiesBySource={};const jt=function(Xt,It){const zt={};for(let Qt=0;Qt<Xt.length;Qt++){const me=It&&It[Xt[Qt].id]||l(Xt[Qt]);It&&(It[Xt[Qt].id]=me);let ve=zt[me];ve||(ve=zt[me]=[]),ve.push(Xt[Qt])}const Kt=[];for(const Qt in zt)Kt.push(zt[Qt]);return Kt}(r.values(this._layerConfigs),this.keyCache);for(const Xt of jt){const It=Xt.map(Xe=>this._layers[Xe.id]),zt=It[0];if(zt.visibility==="none")continue;const Kt=zt.source||"";let Qt=this.familiesBySource[Kt];Qt||(Qt=this.familiesBySource[Kt]={});const me=zt.sourceLayer||"_geojsonTileLayer";let ve=Qt[me];ve||(ve=Qt[me]=[]),ve.push(It)}}}class f{loadTile(St,Rt){const{uid:jt,encoding:Xt,rawImageData:It,padding:zt,buildQuadTree:Kt}=St,Qt=r.window.ImageBitmap&&It instanceof r.window.ImageBitmap?this.getImageData(It,zt):It;Rt(null,new r.DEMData(jt,Qt,Xt,zt<1,Kt))}getImageData(St,Rt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(St.width,St.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=St.width,this.offscreenCanvas.height=St.height,this.offscreenCanvasContext.drawImage(St,0,0,St.width,St.height);const jt=this.offscreenCanvasContext.getImageData(-Rt,-Rt,St.width+2*Rt,St.height+2*Rt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),jt}}var d=function Wt(St,Rt){var jt,Xt=St&&St.type;if(Xt==="FeatureCollection")for(jt=0;jt<St.features.length;jt++)Wt(St.features[jt],Rt);else if(Xt==="GeometryCollection")for(jt=0;jt<St.geometries.length;jt++)Wt(St.geometries[jt],Rt);else if(Xt==="Feature")Wt(St.geometry,Rt);else if(Xt==="Polygon")p(St.coordinates,Rt);else if(Xt==="MultiPolygon")for(jt=0;jt<St.coordinates.length;jt++)p(St.coordinates[jt],Rt);return St};function p(Wt,St){if(Wt.length!==0){b(Wt[0],St);for(var Rt=1;Rt<Wt.length;Rt++)b(Wt[Rt],!St)}}function b(Wt,St){for(var Rt=0,jt=0,Xt=0,It=Wt.length,zt=It-1;Xt<It;zt=Xt++){var Kt=(Wt[Xt][0]-Wt[zt][0])*(Wt[zt][1]+Wt[Xt][1]),Qt=Rt+Kt;jt+=Math.abs(Rt)>=Math.abs(Kt)?Rt-Qt+Kt:Kt-Qt+Rt,Rt=Qt}Rt+jt>=0!=!!St&&Wt.reverse()}const v=r.vectorTile.VectorTileFeature.prototype.toGeoJSON;class x{constructor(St){this._feature=St,this.extent=r.EXTENT,this.type=St.type,this.properties=St.tags,"id"in St&&!isNaN(St.id)&&(this.id=parseInt(St.id,10))}loadGeometry(){if(this._feature.type===1){const St=[];for(const Rt of this._feature.geometry)St.push([new r.pointGeometry(Rt[0],Rt[1])]);return St}{const St=[];for(const Rt of this._feature.geometry){const jt=[];for(const Xt of Rt)jt.push(new r.pointGeometry(Xt[0],Xt[1]));St.push(jt)}return St}}toGeoJSON(St,Rt,jt){return v.call(this,St,Rt,jt)}}class w{constructor(St){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=St.length,this._features=St}feature(St){return new x(this._features[St])}}var M=r.vectorTile.VectorTileFeature,E=D;function D(Wt,St){this.options=St||{},this.features=Wt,this.length=Wt.length}function N(Wt,St){this.id=typeof Wt.id=="number"?Wt.id:void 0,this.type=Wt.type,this.rawGeometry=Wt.type===1?[Wt.geometry]:Wt.geometry,this.properties=Wt.tags,this.extent=St||4096}D.prototype.feature=function(Wt){return new N(this.features[Wt],this.options.extent)},N.prototype.loadGeometry=function(){var Wt=this.rawGeometry;this.geometry=[];for(var St=0;St<Wt.length;St++){for(var Rt=Wt[St],jt=[],Xt=0;Xt<Rt.length;Xt++)jt.push(new r.pointGeometry(Rt[Xt][0],Rt[Xt][1]));this.geometry.push(jt)}return this.geometry},N.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Wt=this.geometry,St=1/0,Rt=-1/0,jt=1/0,Xt=-1/0,It=0;It<Wt.length;It++)for(var zt=Wt[It],Kt=0;Kt<zt.length;Kt++){var Qt=zt[Kt];St=Math.min(St,Qt.x),Rt=Math.max(Rt,Qt.x),jt=Math.min(jt,Qt.y),Xt=Math.max(Xt,Qt.y)}return[St,jt,Rt,Xt]},N.prototype.toGeoJSON=M.prototype.toGeoJSON;var V=j,K=E;function j(Wt){var St=new r.pbf;return function(Rt,jt){for(var Xt in Rt.layers)jt.writeMessage(3,Z,Rt.layers[Xt])}(Wt,St),St.finish()}function Z(Wt,St){var Rt;St.writeVarintField(15,Wt.version||1),St.writeStringField(1,Wt.name||""),St.writeVarintField(5,Wt.extent||4096);var jt={keys:[],values:[],keycache:{},valuecache:{}};for(Rt=0;Rt<Wt.length;Rt++)jt.feature=Wt.feature(Rt),St.writeMessage(2,tt,jt);var Xt=jt.keys;for(Rt=0;Rt<Xt.length;Rt++)St.writeStringField(3,Xt[Rt]);var It=jt.values;for(Rt=0;Rt<It.length;Rt++)St.writeMessage(4,I,It[Rt])}function tt(Wt,St){var Rt=Wt.feature;Rt.id!==void 0&&St.writeVarintField(1,Rt.id),St.writeMessage(2,rt,Wt),St.writeVarintField(3,Rt.type),St.writeMessage(4,G,Rt)}function rt(Wt,St){var Rt=Wt.feature,jt=Wt.keys,Xt=Wt.values,It=Wt.keycache,zt=Wt.valuecache;for(var Kt in Rt.properties){var Qt=Rt.properties[Kt],me=It[Kt];if(Qt!==null){me===void 0&&(jt.push(Kt),It[Kt]=me=jt.length-1),St.writeVarint(me);var ve=typeof Qt;ve!=="string"&&ve!=="boolean"&&ve!=="number"&&(Qt=JSON.stringify(Qt));var Xe=ve+":"+Qt,Ee=zt[Xe];Ee===void 0&&(Xt.push(Qt),zt[Xe]=Ee=Xt.length-1),St.writeVarint(Ee)}}}function J(Wt,St){return(St<<3)+(7&Wt)}function U(Wt){return Wt<<1^Wt>>31}function G(Wt,St){for(var Rt=Wt.loadGeometry(),jt=Wt.type,Xt=0,It=0,zt=Rt.length,Kt=0;Kt<zt;Kt++){var Qt=Rt[Kt],me=1;jt===1&&(me=Qt.length),St.writeVarint(J(1,me));for(var ve=jt===3?Qt.length-1:Qt.length,Xe=0;Xe<ve;Xe++){Xe===1&&jt!==1&&St.writeVarint(J(2,ve-1));var Ee=Qt[Xe].x-Xt,$e=Qt[Xe].y-It;St.writeVarint(U(Ee)),St.writeVarint(U($e)),Xt+=Ee,It+=$e}jt===3&&St.writeVarint(J(7,1))}}function I(Wt,St){var Rt=typeof Wt;Rt==="string"?St.writeStringField(1,Wt):Rt==="boolean"?St.writeBooleanField(7,Wt):Rt==="number"&&(Wt%1!=0?St.writeDoubleField(3,Wt):Wt<0?St.writeSVarintField(6,Wt):St.writeVarintField(5,Wt))}function C(Wt,St,Rt,jt,Xt,It){if(Xt-jt<=Rt)return;const zt=jt+Xt>>1;L(Wt,St,zt,jt,Xt,It%2),C(Wt,St,Rt,jt,zt-1,It+1),C(Wt,St,Rt,zt+1,Xt,It+1)}function L(Wt,St,Rt,jt,Xt,It){for(;Xt>jt;){if(Xt-jt>600){const me=Xt-jt+1,ve=Rt-jt+1,Xe=Math.log(me),Ee=.5*Math.exp(2*Xe/3),$e=.5*Math.sqrt(Xe*Ee*(me-Ee)/me)*(ve-me/2<0?-1:1);L(Wt,St,Rt,Math.max(jt,Math.floor(Rt-ve*Ee/me+$e)),Math.min(Xt,Math.floor(Rt+(me-ve)*Ee/me+$e)),It)}const zt=St[2*Rt+It];let Kt=jt,Qt=Xt;for(B(Wt,St,jt,Rt),St[2*Xt+It]>zt&&B(Wt,St,jt,Xt);Kt<Qt;){for(B(Wt,St,Kt,Qt),Kt++,Qt--;St[2*Kt+It]<zt;)Kt++;for(;St[2*Qt+It]>zt;)Qt--}St[2*jt+It]===zt?B(Wt,St,jt,Qt):(Qt++,B(Wt,St,Qt,Xt)),Qt<=Rt&&(jt=Qt+1),Rt<=Qt&&(Xt=Qt-1)}}function B(Wt,St,Rt,jt){O(Wt,Rt,jt),O(St,2*Rt,2*jt),O(St,2*Rt+1,2*jt+1)}function O(Wt,St,Rt){const jt=Wt[St];Wt[St]=Wt[Rt],Wt[Rt]=jt}function q(Wt,St,Rt,jt){const Xt=Wt-Rt,It=St-jt;return Xt*Xt+It*It}V.fromVectorTileJs=j,V.fromGeojsonVt=function(Wt,St){St=St||{};var Rt={};for(var jt in Wt)Rt[jt]=new E(Wt[jt].features,St),Rt[jt].name=jt,Rt[jt].version=St.version,Rt[jt].extent=St.extent;return j({layers:Rt})},V.GeoJSONWrapper=K;const it=Wt=>Wt[0],nt=Wt=>Wt[1];class lt{constructor(St,Rt=it,jt=nt,Xt=64,It=Float64Array){this.nodeSize=Xt,this.points=St;const zt=St.length<65536?Uint16Array:Uint32Array,Kt=this.ids=new zt(St.length),Qt=this.coords=new It(2*St.length);for(let me=0;me<St.length;me++)Kt[me]=me,Qt[2*me]=Rt(St[me]),Qt[2*me+1]=jt(St[me]);C(Kt,Qt,Xt,0,Kt.length-1,0)}range(St,Rt,jt,Xt){return function(It,zt,Kt,Qt,me,ve,Xe){const Ee=[0,It.length-1,0],$e=[];let Tt,Lt;for(;Ee.length;){const ee=Ee.pop(),Yt=Ee.pop(),Ve=Ee.pop();if(Yt-Ve<=Xe){for(let gn=Ve;gn<=Yt;gn++)Tt=zt[2*gn],Lt=zt[2*gn+1],Tt>=Kt&&Tt<=me&&Lt>=Qt&&Lt<=ve&&$e.push(It[gn]);continue}const Ue=Math.floor((Ve+Yt)/2);Tt=zt[2*Ue],Lt=zt[2*Ue+1],Tt>=Kt&&Tt<=me&&Lt>=Qt&&Lt<=ve&&$e.push(It[Ue]);const en=(ee+1)%2;(ee===0?Kt<=Tt:Qt<=Lt)&&(Ee.push(Ve),Ee.push(Ue-1),Ee.push(en)),(ee===0?me>=Tt:ve>=Lt)&&(Ee.push(Ue+1),Ee.push(Yt),Ee.push(en))}return $e}(this.ids,this.coords,St,Rt,jt,Xt,this.nodeSize)}within(St,Rt,jt){return function(Xt,It,zt,Kt,Qt,me){const ve=[0,Xt.length-1,0],Xe=[],Ee=Qt*Qt;for(;ve.length;){const $e=ve.pop(),Tt=ve.pop(),Lt=ve.pop();if(Tt-Lt<=me){for(let en=Lt;en<=Tt;en++)q(It[2*en],It[2*en+1],zt,Kt)<=Ee&&Xe.push(Xt[en]);continue}const ee=Math.floor((Lt+Tt)/2),Yt=It[2*ee],Ve=It[2*ee+1];q(Yt,Ve,zt,Kt)<=Ee&&Xe.push(Xt[ee]);const Ue=($e+1)%2;($e===0?zt-Qt<=Yt:Kt-Qt<=Ve)&&(ve.push(Lt),ve.push(ee-1),ve.push(Ue)),($e===0?zt+Qt>=Yt:Kt+Qt>=Ve)&&(ve.push(ee+1),ve.push(Tt),ve.push(Ue))}return Xe}(this.ids,this.coords,St,Rt,jt,this.nodeSize)}}const ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Wt=>Wt},vt=Math.fround||(Q=new Float32Array(1),Wt=>(Q[0]=+Wt,Q[0]));var Q;class gt{constructor(St){this.options=Gt(Object.create(ut),St),this.trees=new Array(this.options.maxZoom+1)}load(St){const{log:Rt,minZoom:jt,maxZoom:Xt,nodeSize:It}=this.options;Rt&&console.time("total time");const zt=`prepare ${St.length} points`;Rt&&console.time(zt),this.points=St;let Kt=[];for(let Qt=0;Qt<St.length;Qt++)St[Qt].geometry&&Kt.push(H(St[Qt],Qt));this.trees[Xt+1]=new lt(Kt,te,mt,It,Float32Array),Rt&&console.timeEnd(zt);for(let Qt=Xt;Qt>=jt;Qt--){const me=+Date.now();Kt=this._cluster(Kt,Qt),this.trees[Qt]=new lt(Kt,te,mt,It,Float32Array),Rt&&console.log("z%d: %d clusters in %dms",Qt,Kt.length,+Date.now()-me)}return Rt&&console.timeEnd("total time"),this}getClusters(St,Rt){let jt=((St[0]+180)%360+360)%360-180;const Xt=Math.max(-90,Math.min(90,St[1]));let It=St[2]===180?180:((St[2]+180)%360+360)%360-180;const zt=Math.max(-90,Math.min(90,St[3]));if(St[2]-St[0]>=360)jt=-180,It=180;else if(jt>It){const ve=this.getClusters([jt,Xt,180,zt],Rt),Xe=this.getClusters([-180,Xt,It,zt],Rt);return ve.concat(Xe)}const Kt=this.trees[this._limitZoom(Rt)],Qt=Kt.range(wt(jt),_t(zt),wt(It),_t(Xt)),me=[];for(const ve of Qt){const Xe=Kt.points[ve];me.push(Xe.numPoints?at(Xe):this.points[Xe.index])}return me}getChildren(St){const Rt=this._getOriginId(St),jt=this._getOriginZoom(St),Xt="No cluster with the specified id.",It=this.trees[jt];if(!It)throw new Error(Xt);const zt=It.points[Rt];if(!zt)throw new Error(Xt);const Kt=this.options.radius/(this.options.extent*Math.pow(2,jt-1)),Qt=It.within(zt.x,zt.y,Kt),me=[];for(const ve of Qt){const Xe=It.points[ve];Xe.parentId===St&&me.push(Xe.numPoints?at(Xe):this.points[Xe.index])}if(me.length===0)throw new Error(Xt);return me}getLeaves(St,Rt,jt){const Xt=[];return this._appendLeaves(Xt,St,Rt=Rt||10,jt=jt||0,0),Xt}getTile(St,Rt,jt){const Xt=this.trees[this._limitZoom(St)],It=Math.pow(2,St),{extent:zt,radius:Kt}=this.options,Qt=Kt/zt,me=(jt-Qt)/It,ve=(jt+1+Qt)/It,Xe={features:[]};return this._addTileFeatures(Xt.range((Rt-Qt)/It,me,(Rt+1+Qt)/It,ve),Xt.points,Rt,jt,It,Xe),Rt===0&&this._addTileFeatures(Xt.range(1-Qt/It,me,1,ve),Xt.points,It,jt,It,Xe),Rt===It-1&&this._addTileFeatures(Xt.range(0,me,Qt/It,ve),Xt.points,-1,jt,It,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(St){let Rt=this._getOriginZoom(St)-1;for(;Rt<=this.options.maxZoom;){const jt=this.getChildren(St);if(Rt++,jt.length!==1)break;St=jt[0].properties.cluster_id}return Rt}_appendLeaves(St,Rt,jt,Xt,It){const zt=this.getChildren(Rt);for(const Kt of zt){const Qt=Kt.properties;if(Qt&&Qt.cluster?It+Qt.point_count<=Xt?It+=Qt.point_count:It=this._appendLeaves(St,Qt.cluster_id,jt,Xt,It):It<Xt?It++:St.push(Kt),St.length===jt)break}return It}_addTileFeatures(St,Rt,jt,Xt,It,zt){for(const Kt of St){const Qt=Rt[Kt],me=Qt.numPoints;let ve,Xe,Ee;if(me)ve=ft(Qt),Xe=Qt.x,Ee=Qt.y;else{const Lt=this.points[Qt.index];ve=Lt.properties,Xe=wt(Lt.geometry.coordinates[0]),Ee=_t(Lt.geometry.coordinates[1])}const $e={type:1,geometry:[[Math.round(this.options.extent*(Xe*It-jt)),Math.round(this.options.extent*(Ee*It-Xt))]],tags:ve};let Tt;me?Tt=Qt.id:this.options.generateId?Tt=Qt.index:this.points[Qt.index].id&&(Tt=this.points[Qt.index].id),Tt!==void 0&&($e.id=Tt),zt.features.push($e)}}_limitZoom(St){return Math.max(this.options.minZoom,Math.min(+St,this.options.maxZoom+1))}_cluster(St,Rt){const jt=[],{radius:Xt,extent:It,reduce:zt,minPoints:Kt}=this.options,Qt=Xt/(It*Math.pow(2,Rt));for(let me=0;me<St.length;me++){const ve=St[me];if(ve.zoom<=Rt)continue;ve.zoom=Rt;const Xe=this.trees[Rt+1],Ee=Xe.within(ve.x,ve.y,Qt),$e=ve.numPoints||1;let Tt=$e;for(const Lt of Ee){const ee=Xe.points[Lt];ee.zoom>Rt&&(Tt+=ee.numPoints||1)}if(Tt>$e&&Tt>=Kt){let Lt=ve.x*$e,ee=ve.y*$e,Yt=zt&&$e>1?this._map(ve,!0):null;const Ve=(me<<5)+(Rt+1)+this.points.length;for(const Ue of Ee){const en=Xe.points[Ue];if(en.zoom<=Rt)continue;en.zoom=Rt;const gn=en.numPoints||1;Lt+=en.x*gn,ee+=en.y*gn,en.parentId=Ve,zt&&(Yt||(Yt=this._map(ve,!0)),zt(Yt,this._map(en)))}ve.parentId=Ve,jt.push(Y(Lt/Tt,ee/Tt,Ve,Tt,Yt))}else if(jt.push(ve),Tt>1)for(const Lt of Ee){const ee=Xe.points[Lt];ee.zoom<=Rt||(ee.zoom=Rt,jt.push(ee))}}return jt}_getOriginId(St){return St-this.points.length>>5}_getOriginZoom(St){return(St-this.points.length)%32}_map(St,Rt){if(St.numPoints)return Rt?Gt({},St.properties):St.properties;const jt=this.points[St.index].properties,Xt=this.options.map(jt);return Rt&&Xt===jt?Gt({},Xt):Xt}}function Y(Wt,St,Rt,jt,Xt){return{x:vt(Wt),y:vt(St),zoom:1/0,id:Rt,parentId:-1,numPoints:jt,properties:Xt}}function H(Wt,St){const[Rt,jt]=Wt.geometry.coordinates;return{x:vt(wt(Rt)),y:vt(_t(jt)),zoom:1/0,index:St,parentId:-1}}function at(Wt){return{type:"Feature",id:Wt.id,properties:ft(Wt),geometry:{type:"Point",coordinates:[(St=Wt.x,360*(St-.5)),Dt(Wt.y)]}};var St}function ft(Wt){const St=Wt.numPoints,Rt=St>=1e4?`${Math.round(St/1e3)}k`:St>=1e3?Math.round(St/100)/10+"k":St;return Gt(Gt({},Wt.properties),{cluster:!0,cluster_id:Wt.id,point_count:St,point_count_abbreviated:Rt})}function wt(Wt){return Wt/360+.5}function _t(Wt){const St=Math.sin(Wt*Math.PI/180),Rt=.5-.25*Math.log((1+St)/(1-St))/Math.PI;return Rt<0?0:Rt>1?1:Rt}function Dt(Wt){const St=(180-360*Wt)*Math.PI/180;return 360*Math.atan(Math.exp(St))/Math.PI-90}function Gt(Wt,St){for(const Rt in St)Wt[Rt]=St[Rt];return Wt}function te(Wt){return Wt.x}function mt(Wt){return Wt.y}function At(Wt,St,Rt,jt){for(var Xt,It=jt,zt=Rt-St>>1,Kt=Rt-St,Qt=Wt[St],me=Wt[St+1],ve=Wt[Rt],Xe=Wt[Rt+1],Ee=St+3;Ee<Rt;Ee+=3){var $e=Ot(Wt[Ee],Wt[Ee+1],Qt,me,ve,Xe);if($e>It)Xt=Ee,It=$e;else if($e===It){var Tt=Math.abs(Ee-zt);Tt<Kt&&(Xt=Ee,Kt=Tt)}}It>jt&&(Xt-St>3&&At(Wt,St,Xt,jt),Wt[Xt+2]=It,Rt-Xt>3&&At(Wt,Xt,Rt,jt))}function Ot(Wt,St,Rt,jt,Xt,It){var zt=Xt-Rt,Kt=It-jt;if(zt!==0||Kt!==0){var Qt=((Wt-Rt)*zt+(St-jt)*Kt)/(zt*zt+Kt*Kt);Qt>1?(Rt=Xt,jt=It):Qt>0&&(Rt+=zt*Qt,jt+=Kt*Qt)}return(zt=Wt-Rt)*zt+(Kt=St-jt)*Kt}function Zt(Wt,St,Rt,jt){var Xt={id:Wt===void 0?null:Wt,type:St,geometry:Rt,tags:jt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(It){var zt=It.geometry,Kt=It.type;if(Kt==="Point"||Kt==="MultiPoint"||Kt==="LineString")he(It,zt);else if(Kt==="Polygon"||Kt==="MultiLineString")for(var Qt=0;Qt<zt.length;Qt++)he(It,zt[Qt]);else if(Kt==="MultiPolygon")for(Qt=0;Qt<zt.length;Qt++)for(var me=0;me<zt[Qt].length;me++)he(It,zt[Qt][me])}(Xt),Xt}function he(Wt,St){for(var Rt=0;Rt<St.length;Rt+=3)Wt.minX=Math.min(Wt.minX,St[Rt]),Wt.minY=Math.min(Wt.minY,St[Rt+1]),Wt.maxX=Math.max(Wt.maxX,St[Rt]),Wt.maxY=Math.max(Wt.maxY,St[Rt+1])}function fe(Wt,St,Rt,jt){if(St.geometry){var Xt=St.geometry.coordinates,It=St.geometry.type,zt=Math.pow(Rt.tolerance/((1<<Rt.maxZoom)*Rt.extent),2),Kt=[],Qt=St.id;if(Rt.promoteId?Qt=St.properties[Rt.promoteId]:Rt.generateId&&(Qt=jt||0),It==="Point")be(Xt,Kt);else if(It==="MultiPoint")for(var me=0;me<Xt.length;me++)be(Xt[me],Kt);else if(It==="LineString")Me(Xt,Kt,zt,!1);else if(It==="MultiLineString"){if(Rt.lineMetrics){for(me=0;me<Xt.length;me++)Me(Xt[me],Kt=[],zt,!1),Wt.push(Zt(Qt,"LineString",Kt,St.properties));return}Pe(Xt,Kt,zt,!1)}else if(It==="Polygon")Pe(Xt,Kt,zt,!0);else{if(It!=="MultiPolygon"){if(It==="GeometryCollection"){for(me=0;me<St.geometry.geometries.length;me++)fe(Wt,{id:Qt,geometry:St.geometry.geometries[me],properties:St.properties},Rt,jt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<Xt.length;me++){var ve=[];Pe(Xt[me],ve,zt,!0),Kt.push(ve)}}Wt.push(Zt(Qt,It,Kt,St.properties))}}function be(Wt,St){St.push(ze(Wt[0])),St.push(Ce(Wt[1])),St.push(0)}function Me(Wt,St,Rt,jt){for(var Xt,It,zt=0,Kt=0;Kt<Wt.length;Kt++){var Qt=ze(Wt[Kt][0]),me=Ce(Wt[Kt][1]);St.push(Qt),St.push(me),St.push(0),Kt>0&&(zt+=jt?(Xt*me-Qt*It)/2:Math.sqrt(Math.pow(Qt-Xt,2)+Math.pow(me-It,2))),Xt=Qt,It=me}var ve=St.length-3;St[2]=1,At(St,0,ve,Rt),St[ve+2]=1,St.size=Math.abs(zt),St.start=0,St.end=St.size}function Pe(Wt,St,Rt,jt){for(var Xt=0;Xt<Wt.length;Xt++){var It=[];Me(Wt[Xt],It,Rt,jt),St.push(It)}}function ze(Wt){return Wt/360+.5}function Ce(Wt){var St=Math.sin(Wt*Math.PI/180),Rt=.5-.25*Math.log((1+St)/(1-St))/Math.PI;return Rt<0?0:Rt>1?1:Rt}function Le(Wt,St,Rt,jt,Xt,It,zt,Kt){if(jt/=St,It>=(Rt/=St)&&zt<jt)return Wt;if(zt<Rt||It>=jt)return null;for(var Qt=[],me=0;me<Wt.length;me++){var ve=Wt[me],Xe=ve.geometry,Ee=ve.type,$e=Xt===0?ve.minX:ve.minY,Tt=Xt===0?ve.maxX:ve.maxY;if($e>=Rt&&Tt<jt)Qt.push(ve);else if(!(Tt<Rt||$e>=jt)){var Lt=[];if(Ee==="Point"||Ee==="MultiPoint")Ye(Xe,Lt,Rt,jt,Xt);else if(Ee==="LineString")le(Xe,Lt,Rt,jt,Xt,!1,Kt.lineMetrics);else if(Ee==="MultiLineString")Ke(Xe,Lt,Rt,jt,Xt,!1);else if(Ee==="Polygon")Ke(Xe,Lt,Rt,jt,Xt,!0);else if(Ee==="MultiPolygon")for(var ee=0;ee<Xe.length;ee++){var Yt=[];Ke(Xe[ee],Yt,Rt,jt,Xt,!0),Yt.length&&Lt.push(Yt)}if(Lt.length){if(Kt.lineMetrics&&Ee==="LineString"){for(ee=0;ee<Lt.length;ee++)Qt.push(Zt(ve.id,Ee,Lt[ee],ve.tags));continue}Ee!=="LineString"&&Ee!=="MultiLineString"||(Lt.length===1?(Ee="LineString",Lt=Lt[0]):Ee="MultiLineString"),Ee!=="Point"&&Ee!=="MultiPoint"||(Ee=Lt.length===3?"Point":"MultiPoint"),Qt.push(Zt(ve.id,Ee,Lt,ve.tags))}}}return Qt.length?Qt:null}function Ye(Wt,St,Rt,jt,Xt){for(var It=0;It<Wt.length;It+=3){var zt=Wt[It+Xt];zt>=Rt&&zt<=jt&&(St.push(Wt[It]),St.push(Wt[It+1]),St.push(Wt[It+2]))}}function le(Wt,St,Rt,jt,Xt,It,zt){for(var Kt,Qt,me=Fe(Wt),ve=Xt===0?ke:Qe,Xe=Wt.start,Ee=0;Ee<Wt.length-3;Ee+=3){var $e=Wt[Ee],Tt=Wt[Ee+1],Lt=Wt[Ee+2],ee=Wt[Ee+3],Yt=Wt[Ee+4],Ve=Xt===0?$e:Tt,Ue=Xt===0?ee:Yt,en=!1;zt&&(Kt=Math.sqrt(Math.pow($e-ee,2)+Math.pow(Tt-Yt,2))),Ve<Rt?Ue>Rt&&(Qt=ve(me,$e,Tt,ee,Yt,Rt),zt&&(me.start=Xe+Kt*Qt)):Ve>jt?Ue<jt&&(Qt=ve(me,$e,Tt,ee,Yt,jt),zt&&(me.start=Xe+Kt*Qt)):Ze(me,$e,Tt,Lt),Ue<Rt&&Ve>=Rt&&(Qt=ve(me,$e,Tt,ee,Yt,Rt),en=!0),Ue>jt&&Ve<=jt&&(Qt=ve(me,$e,Tt,ee,Yt,jt),en=!0),!It&&en&&(zt&&(me.end=Xe+Kt*Qt),St.push(me),me=Fe(Wt)),zt&&(Xe+=Kt)}var gn=Wt.length-3;$e=Wt[gn],Tt=Wt[gn+1],Lt=Wt[gn+2],(Ve=Xt===0?$e:Tt)>=Rt&&Ve<=jt&&Ze(me,$e,Tt,Lt),gn=me.length-3,It&&gn>=3&&(me[gn]!==me[0]||me[gn+1]!==me[1])&&Ze(me,me[0],me[1],me[2]),me.length&&St.push(me)}function Fe(Wt){var St=[];return St.size=Wt.size,St.start=Wt.start,St.end=Wt.end,St}function Ke(Wt,St,Rt,jt,Xt,It){for(var zt=0;zt<Wt.length;zt++)le(Wt[zt],St,Rt,jt,Xt,It,!1)}function Ze(Wt,St,Rt,jt){Wt.push(St),Wt.push(Rt),Wt.push(jt)}function ke(Wt,St,Rt,jt,Xt,It){var zt=(It-St)/(jt-St);return Wt.push(It),Wt.push(Rt+(Xt-Rt)*zt),Wt.push(1),zt}function Qe(Wt,St,Rt,jt,Xt,It){var zt=(It-Rt)/(Xt-Rt);return Wt.push(St+(jt-St)*zt),Wt.push(It),Wt.push(1),zt}function hn(Wt,St){for(var Rt=[],jt=0;jt<Wt.length;jt++){var Xt,It=Wt[jt],zt=It.type;if(zt==="Point"||zt==="MultiPoint"||zt==="LineString")Xt=ln(It.geometry,St);else if(zt==="MultiLineString"||zt==="Polygon"){Xt=[];for(var Kt=0;Kt<It.geometry.length;Kt++)Xt.push(ln(It.geometry[Kt],St))}else if(zt==="MultiPolygon")for(Xt=[],Kt=0;Kt<It.geometry.length;Kt++){for(var Qt=[],me=0;me<It.geometry[Kt].length;me++)Qt.push(ln(It.geometry[Kt][me],St));Xt.push(Qt)}Rt.push(Zt(It.id,zt,Xt,It.tags))}return Rt}function ln(Wt,St){var Rt=[];Rt.size=Wt.size,Wt.start!==void 0&&(Rt.start=Wt.start,Rt.end=Wt.end);for(var jt=0;jt<Wt.length;jt+=3)Rt.push(Wt[jt]+St,Wt[jt+1],Wt[jt+2]);return Rt}function Hn(Wt,St){if(Wt.transformed)return Wt;var Rt,jt,Xt,It=1<<Wt.z,zt=Wt.x,Kt=Wt.y;for(Rt=0;Rt<Wt.features.length;Rt++){var Qt=Wt.features[Rt],me=Qt.geometry,ve=Qt.type;if(Qt.geometry=[],ve===1)for(jt=0;jt<me.length;jt+=2)Qt.geometry.push(Tn(me[jt],me[jt+1],St,It,zt,Kt));else for(jt=0;jt<me.length;jt++){var Xe=[];for(Xt=0;Xt<me[jt].length;Xt+=2)Xe.push(Tn(me[jt][Xt],me[jt][Xt+1],St,It,zt,Kt));Qt.geometry.push(Xe)}}return Wt.transformed=!0,Wt}function Tn(Wt,St,Rt,jt,Xt,It){return[Math.round(Rt*(Wt*jt-Xt)),Math.round(Rt*(St*jt-It))]}function Sn(Wt,St,Rt,jt,Xt){for(var It=St===Xt.maxZoom?0:Xt.tolerance/((1<<St)*Xt.extent),zt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Rt,y:jt,z:St,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Kt=0;Kt<Wt.length;Kt++){zt.numFeatures++,On(zt,Wt[Kt],It,Xt);var Qt=Wt[Kt].minX,me=Wt[Kt].minY,ve=Wt[Kt].maxX,Xe=Wt[Kt].maxY;Qt<zt.minX&&(zt.minX=Qt),me<zt.minY&&(zt.minY=me),ve>zt.maxX&&(zt.maxX=ve),Xe>zt.maxY&&(zt.maxY=Xe)}return zt}function On(Wt,St,Rt,jt){var Xt=St.geometry,It=St.type,zt=[];if(It==="Point"||It==="MultiPoint")for(var Kt=0;Kt<Xt.length;Kt+=3)zt.push(Xt[Kt]),zt.push(Xt[Kt+1]),Wt.numPoints++,Wt.numSimplified++;else if(It==="LineString")qn(zt,Xt,Wt,Rt,!1,!1);else if(It==="MultiLineString"||It==="Polygon")for(Kt=0;Kt<Xt.length;Kt++)qn(zt,Xt[Kt],Wt,Rt,It==="Polygon",Kt===0);else if(It==="MultiPolygon")for(var Qt=0;Qt<Xt.length;Qt++){var me=Xt[Qt];for(Kt=0;Kt<me.length;Kt++)qn(zt,me[Kt],Wt,Rt,!0,Kt===0)}if(zt.length){var ve=St.tags||null;if(It==="LineString"&&jt.lineMetrics){for(var Xe in ve={},St.tags)ve[Xe]=St.tags[Xe];ve.mapbox_clip_start=Xt.start/Xt.size,ve.mapbox_clip_end=Xt.end/Xt.size}var Ee={geometry:zt,type:It==="Polygon"||It==="MultiPolygon"?3:It==="LineString"||It==="MultiLineString"?2:1,tags:ve};St.id!==null&&(Ee.id=St.id),Wt.features.push(Ee)}}function qn(Wt,St,Rt,jt,Xt,It){var zt=jt*jt;if(jt>0&&St.size<(Xt?zt:jt))Rt.numPoints+=St.length/3;else{for(var Kt=[],Qt=0;Qt<St.length;Qt+=3)(jt===0||St[Qt+2]>zt)&&(Rt.numSimplified++,Kt.push(St[Qt]),Kt.push(St[Qt+1])),Rt.numPoints++;Xt&&function(me,ve){for(var Xe=0,Ee=0,$e=me.length,Tt=$e-2;Ee<$e;Tt=Ee,Ee+=2)Xe+=(me[Ee]-me[Tt])*(me[Ee+1]+me[Tt+1]);if(Xe>0===ve)for(Ee=0,$e=me.length;Ee<$e/2;Ee+=2){var Lt=me[Ee],ee=me[Ee+1];me[Ee]=me[$e-2-Ee],me[Ee+1]=me[$e-1-Ee],me[$e-2-Ee]=Lt,me[$e-1-Ee]=ee}}(Kt,It),Wt.push(Kt)}}function Pn(Wt,St){var Rt=(St=this.options=function(Xt,It){for(var zt in It)Xt[zt]=It[zt];return Xt}(Object.create(this.options),St)).debug;if(Rt&&console.time("preprocess data"),St.maxZoom<0||St.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(St.promoteId&&St.generateId)throw new Error("promoteId and generateId cannot be used together.");var jt=function(Xt,It){var zt=[];if(Xt.type==="FeatureCollection")for(var Kt=0;Kt<Xt.features.length;Kt++)fe(zt,Xt.features[Kt],It,Kt);else fe(zt,Xt.type==="Feature"?Xt:{geometry:Xt},It);return zt}(Wt,St);this.tiles={},this.tileCoords=[],Rt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",St.indexMaxZoom,St.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(jt=function(Xt,It){var zt=It.buffer/It.extent,Kt=Xt,Qt=Le(Xt,1,-1-zt,zt,0,-1,2,It),me=Le(Xt,1,1-zt,2+zt,0,-1,2,It);return(Qt||me)&&(Kt=Le(Xt,1,-zt,1+zt,0,-1,2,It)||[],Qt&&(Kt=hn(Qt,1).concat(Kt)),me&&(Kt=Kt.concat(hn(me,-1)))),Kt}(jt,St)).length&&this.splitTile(jt,0,0,0),Rt&&(jt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function cr(Wt,St,Rt){return 32*((1<<Wt)*Rt+St)+Wt}function Yn(Wt,St){const Rt=Wt.tileID.canonical;if(!this._geoJSONIndex)return St(null,null);const jt=this._geoJSONIndex.getTile(Rt.z,Rt.x,Rt.y);if(!jt)return St(null,null);const Xt=new w(jt.features);let It=V(Xt);It.byteOffset===0&&It.byteLength===It.buffer.byteLength||(It=new Uint8Array(It)),St(null,{vectorTile:Xt,rawData:It.buffer})}Pn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Pn.prototype.splitTile=function(Wt,St,Rt,jt,Xt,It,zt){for(var Kt=[Wt,St,Rt,jt],Qt=this.options,me=Qt.debug;Kt.length;){jt=Kt.pop(),Rt=Kt.pop(),St=Kt.pop(),Wt=Kt.pop();var ve=1<<St,Xe=cr(St,Rt,jt),Ee=this.tiles[Xe];if(!Ee&&(me>1&&console.time("creation"),Ee=this.tiles[Xe]=Sn(Wt,St,Rt,jt,Qt),this.tileCoords.push({z:St,x:Rt,y:jt}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",St,Rt,jt,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));var $e="z"+St;this.stats[$e]=(this.stats[$e]||0)+1,this.total++}if(Ee.source=Wt,Xt){if(St===Qt.maxZoom||St===Xt)continue;var Tt=1<<Xt-St;if(Rt!==Math.floor(It/Tt)||jt!==Math.floor(zt/Tt))continue}else if(St===Qt.indexMaxZoom||Ee.numPoints<=Qt.indexMaxPoints)continue;if(Ee.source=null,Wt.length!==0){me>1&&console.time("clipping");var Lt,ee,Yt,Ve,Ue,en,gn=.5*Qt.buffer/Qt.extent,qt=.5-gn,ye=.5+gn,pe=1+gn;Lt=ee=Yt=Ve=null,Ue=Le(Wt,ve,Rt-gn,Rt+ye,0,Ee.minX,Ee.maxX,Qt),en=Le(Wt,ve,Rt+qt,Rt+pe,0,Ee.minX,Ee.maxX,Qt),Wt=null,Ue&&(Lt=Le(Ue,ve,jt-gn,jt+ye,1,Ee.minY,Ee.maxY,Qt),ee=Le(Ue,ve,jt+qt,jt+pe,1,Ee.minY,Ee.maxY,Qt),Ue=null),en&&(Yt=Le(en,ve,jt-gn,jt+ye,1,Ee.minY,Ee.maxY,Qt),Ve=Le(en,ve,jt+qt,jt+pe,1,Ee.minY,Ee.maxY,Qt),en=null),me>1&&console.timeEnd("clipping"),Kt.push(Lt||[],St+1,2*Rt,2*jt),Kt.push(ee||[],St+1,2*Rt,2*jt+1),Kt.push(Yt||[],St+1,2*Rt+1,2*jt),Kt.push(Ve||[],St+1,2*Rt+1,2*jt+1)}}},Pn.prototype.getTile=function(Wt,St,Rt){var jt=this.options,Xt=jt.extent,It=jt.debug;if(Wt<0||Wt>24)return null;var zt=1<<Wt,Kt=cr(Wt,St=(St%zt+zt)%zt,Rt);if(this.tiles[Kt])return Hn(this.tiles[Kt],Xt);It>1&&console.log("drilling down to z%d-%d-%d",Wt,St,Rt);for(var Qt,me=Wt,ve=St,Xe=Rt;!Qt&&me>0;)me--,ve=Math.floor(ve/2),Xe=Math.floor(Xe/2),Qt=this.tiles[cr(me,ve,Xe)];return Qt&&Qt.source?(It>1&&console.log("found parent tile z%d-%d-%d",me,ve,Xe),It>1&&console.time("drilling down"),this.splitTile(Qt.source,me,ve,Xe,Wt,St,Rt),It>1&&console.timeEnd("drilling down"),this.tiles[Kt]?Hn(this.tiles[Kt],Xt):null):null};class zn extends r.VectorTileWorkerSource{constructor(St,Rt,jt,Xt,It){super(St,Rt,jt,Xt,Yn),It&&(this.loadGeoJSON=It)}loadData(St,Rt){const jt=St&&St.request,Xt=jt&&jt.collectResourceTiming;this.loadGeoJSON(St,(It,zt)=>{if(It||!zt)return Rt(It);if(typeof zt!="object")return Rt(new Error(`Input data given to '${St.source}' is not a valid GeoJSON object.`));{d(zt,!0);try{if(St.filter){const Qt=r.createExpression(St.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Qt.result==="error")throw new Error(Qt.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));zt={type:"FeatureCollection",features:zt.features.filter(ve=>Qt.value.evaluate({zoom:0},ve))}}this._geoJSONIndex=St.cluster?new gt(function({superclusterOptions:Qt,clusterProperties:me}){if(!me||!Qt)return Qt;const ve={},Xe={},Ee={accumulated:null,zoom:0},$e={properties:null},Tt=Object.keys(me);for(const Lt of Tt){const[ee,Yt]=me[Lt],Ve=r.createExpression(Yt),Ue=r.createExpression(typeof ee=="string"?[ee,["accumulated"],["get",Lt]]:ee);ve[Lt]=Ve.value,Xe[Lt]=Ue.value}return Qt.map=Lt=>{$e.properties=Lt;const ee={};for(const Yt of Tt)ee[Yt]=ve[Yt].evaluate(Ee,$e);return ee},Qt.reduce=(Lt,ee)=>{$e.properties=ee;for(const Yt of Tt)Ee.accumulated=Lt[Yt],Lt[Yt]=Xe[Yt].evaluate(Ee,$e)},Qt}(St)).load(zt.features):function(Qt,me){return new Pn(Qt,me)}(zt,St.geojsonVtOptions)}catch(Qt){return Rt(Qt)}this.loaded={};const Kt={};if(Xt){const Qt=r.getPerformanceMeasurement(jt);Qt&&(Kt.resourceTiming={},Kt.resourceTiming[St.source]=JSON.parse(JSON.stringify(Qt)))}Rt(null,Kt)}})}reloadTile(St,Rt){const jt=this.loaded;return jt&&jt[St.uid]?super.reloadTile(St,Rt):this.loadTile(St,Rt)}loadGeoJSON(St,Rt){if(St.request)r.getJSON(St.request,Rt);else{if(typeof St.data!="string")return Rt(new Error(`Input data given to '${St.source}' is not a valid GeoJSON object.`));try{return Rt(null,JSON.parse(St.data))}catch(jt){return Rt(new Error(`Input data given to '${St.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(St,Rt){try{Rt(null,this._geoJSONIndex.getClusterExpansionZoom(St.clusterId))}catch(jt){Rt(jt)}}getClusterChildren(St,Rt){try{Rt(null,this._geoJSONIndex.getChildren(St.clusterId))}catch(jt){Rt(jt)}}getClusterLeaves(St,Rt){try{Rt(null,this._geoJSONIndex.getLeaves(St.clusterId,St.limit,St.offset))}catch(jt){Rt(jt)}}}class Qn{constructor(St){this.self=St,this.actor=new r.Actor(St,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.getProjection({name:"mercator"}),this.workerSourceTypes={vector:r.VectorTileWorkerSource,geojson:zn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Rt,jt)=>{if(this.workerSourceTypes[Rt])throw new Error(`Worker source with name "${Rt}" already registered.`);this.workerSourceTypes[Rt]=jt},this.self.registerRTLTextPlugin=Rt=>{if(r.plugin.isParsed())throw new Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=Rt.applyArabicShaping,r.plugin.processBidirectionalText=Rt.processBidirectionalText,r.plugin.processStyledBidirectionalText=Rt.processStyledBidirectionalText}}clearCaches(St,Rt,jt){delete this.layerIndexes[St],delete this.availableImages[St],delete this.workerSources[St],delete this.demWorkerSources[St],jt()}checkIfReady(St,Rt,jt){jt()}setReferrer(St,Rt){this.referrer=Rt}spriteLoaded(St,Rt){this.isSpriteLoaded[St]=Rt;for(const jt in this.workerSources[St]){const Xt=this.workerSources[St][jt];for(const It in Xt)Xt[It]instanceof r.VectorTileWorkerSource&&(Xt[It].isSpriteLoaded=Rt,Xt[It].fire(new r.Event("isSpriteLoaded")))}}setImages(St,Rt,jt){this.availableImages[St]=Rt;for(const Xt in this.workerSources[St]){const It=this.workerSources[St][Xt];for(const zt in It)It[zt].availableImages=Rt}jt()}enableTerrain(St,Rt,jt){this.terrain=Rt,jt()}setProjection(St,Rt){this.projections[St]=r.getProjection(Rt)}setLayers(St,Rt,jt){this.getLayerIndex(St).replace(Rt),jt()}updateLayers(St,Rt,jt){this.getLayerIndex(St).update(Rt.layers,Rt.removedIds),jt()}loadTile(St,Rt,jt){const Xt=this.enableTerrain?r.extend({enableTerrain:this.terrain},Rt):Rt;Xt.projection=this.projections[St]||this.defaultProjection,this.getWorkerSource(St,Rt.type,Rt.source).loadTile(Xt,jt)}loadDEMTile(St,Rt,jt){const Xt=this.enableTerrain?r.extend({buildQuadTree:this.terrain},Rt):Rt;this.getDEMWorkerSource(St,Rt.source).loadTile(Xt,jt)}reloadTile(St,Rt,jt){const Xt=this.enableTerrain?r.extend({enableTerrain:this.terrain},Rt):Rt;Xt.projection=this.projections[St]||this.defaultProjection,this.getWorkerSource(St,Rt.type,Rt.source).reloadTile(Xt,jt)}abortTile(St,Rt,jt){this.getWorkerSource(St,Rt.type,Rt.source).abortTile(Rt,jt)}removeTile(St,Rt,jt){this.getWorkerSource(St,Rt.type,Rt.source).removeTile(Rt,jt)}removeSource(St,Rt,jt){if(!this.workerSources[St]||!this.workerSources[St][Rt.type]||!this.workerSources[St][Rt.type][Rt.source])return;const Xt=this.workerSources[St][Rt.type][Rt.source];delete this.workerSources[St][Rt.type][Rt.source],Xt.removeSource!==void 0?Xt.removeSource(Rt,jt):jt()}loadWorkerSource(St,Rt,jt){try{this.self.importScripts(Rt.url),jt()}catch(Xt){jt(Xt.toString())}}syncRTLPluginState(St,Rt,jt){try{r.plugin.setState(Rt);const Xt=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&Xt!=null){this.self.importScripts(Xt);const It=r.plugin.isParsed();jt(It?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Xt}`),It)}}catch(Xt){jt(Xt.toString())}}getAvailableImages(St){let Rt=this.availableImages[St];return Rt||(Rt=[]),Rt}getLayerIndex(St){let Rt=this.layerIndexes[St];return Rt||(Rt=this.layerIndexes[St]=new h),Rt}getWorkerSource(St,Rt,jt){return this.workerSources[St]||(this.workerSources[St]={}),this.workerSources[St][Rt]||(this.workerSources[St][Rt]={}),this.workerSources[St][Rt][jt]||(this.workerSources[St][Rt][jt]=new this.workerSourceTypes[Rt]({send:(Xt,It,zt,Kt,Qt,me)=>{this.actor.send(Xt,It,zt,St,Qt,me)},scheduler:this.actor.scheduler},this.getLayerIndex(St),this.getAvailableImages(St),this.isSpriteLoaded[St])),this.workerSources[St][Rt][jt]}getDEMWorkerSource(St,Rt){return this.demWorkerSources[St]||(this.demWorkerSources[St]={}),this.demWorkerSources[St][Rt]||(this.demWorkerSources[St][Rt]=new f),this.demWorkerSources[St][Rt]}enforceCacheSizeLimit(St,Rt){r.enforceCacheSizeLimit(Rt)}getWorkerPerformanceMetrics(St,Rt,jt){jt(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Qn(self)),Qn}),a(["./shared"],function(r){var u=l;function l(P){return!function(m){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var F,X,$=new Blob([""],{type:"text/javascript"}),ot=URL.createObjectURL($);try{X=new Worker(ot),F=!0}catch(ct){F=!1}return X&&X.terminate(),URL.revokeObjectURL(ot),F}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var F=document.createElement("canvas");F.width=F.height=1;var X=F.getContext("2d");if(!X)return!1;var $=X.getImageData(0,0,1,1);return $&&$.width===F.width}()?(h[S=m&&m.failIfMajorPerformanceCaveat]===void 0&&(h[S]=function(F){var X,$=function(ot){var ct=document.createElement("canvas"),yt=Object.create(l.webGLContextAttributes);return yt.failIfMajorPerformanceCaveat=ot,ct.getContext("webgl",yt)||ct.getContext("experimental-webgl",yt)}(F);if(!$)return!1;try{X=$.createShader($.VERTEX_SHADER)}catch(ot){return!1}return!(!X||$.isContextLost())&&($.shaderSource(X,"void main() {}"),$.compileShader(X),$.getShaderParameter(X,$.COMPILE_STATUS)===!0)}(S)),h[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var S}(P)}var h={};function f(P,m){if(Array.isArray(P)){if(!Array.isArray(m)||P.length!==m.length)return!1;for(let S=0;S<P.length;S++)if(!f(P[S],m[S]))return!1;return!0}if(typeof P=="object"&&P!==null&&m!==null){if(typeof m!="object"||Object.keys(P).length!==Object.keys(m).length)return!1;for(const S in P)if(!f(P[S],m[S]))return!1;return!0}return P===m}function d(P,m,S){const F=r.window.document.createElement(P);return m!==void 0&&(F.className=m),S&&S.appendChild(F),F}function p(P,m,S){const F=r.window.document.createElementNS("http://www.w3.org/2000/svg",P);for(const X of Object.keys(m))F.setAttributeNS(null,X,m[X]);return S&&S.appendChild(F),F}l.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const b=r.window.document&&r.window.document.documentElement.style,v=b&&b.userSelect!==void 0?"userSelect":"WebkitUserSelect";let x;function w(){b&&v&&(x=b[v],b[v]="none")}function M(){b&&v&&(b[v]=x)}function E(P){P.preventDefault(),P.stopPropagation(),r.window.removeEventListener("click",E,!0)}function D(){r.window.addEventListener("click",E,!0),r.window.setTimeout(()=>{r.window.removeEventListener("click",E,!0)},0)}function N(P,m){const S=P.getBoundingClientRect();return j(P,S,m)}function V(P,m){const S=P.getBoundingClientRect(),F=[];for(let X=0;X<m.length;X++)F.push(j(P,S,m[X]));return F}function K(P){return r.window.InstallTrigger!==void 0&&P.button===2&&P.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:P.button}function j(P,m,S){const F=P.offsetWidth===m.width?1:P.offsetWidth/m.width;return new r.pointGeometry((S.clientX-m.left)*F,(S.clientY-m.top)*F)}function Z(P,m){var S=m[0],F=m[1],X=m[2],$=m[3],ot=S*$-X*F;return ot?(P[0]=$*(ot=1/ot),P[1]=-F*ot,P[2]=-X*ot,P[3]=S*ot,P):null}function tt(P){const{userImage:m}=P;return!!(m&&m.render&&m.render())&&(P.data.replace(new Uint8Array(m.data.buffer)),!0)}class rt extends r.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(m){if(this.loaded!==m&&(this.loaded=m,m)){for(const{ids:S,callback:F}of this.requestors)this._notify(S,F);this.requestors=[]}}hasImage(m){return!!this.getImage(m)}getImage(m){return this.images[m]}addImage(m,S){this._validate(m,S)&&(this.images[m]=S)}_validate(m,S){let F=!0;return this._validateStretch(S.stretchX,S.data&&S.data.width)||(this.fire(new r.ErrorEvent(new Error(`Image "${m}" has invalid "stretchX" value`))),F=!1),this._validateStretch(S.stretchY,S.data&&S.data.height)||(this.fire(new r.ErrorEvent(new Error(`Image "${m}" has invalid "stretchY" value`))),F=!1),this._validateContent(S.content,S)||(this.fire(new r.ErrorEvent(new Error(`Image "${m}" has invalid "content" value`))),F=!1),F}_validateStretch(m,S){if(!m)return!0;let F=0;for(const X of m){if(X[0]<F||X[1]<X[0]||S<X[1])return!1;F=X[1]}return!0}_validateContent(m,S){return!(m&&(m.length!==4||m[0]<0||S.data.width<m[0]||m[1]<0||S.data.height<m[1]||m[2]<0||S.data.width<m[2]||m[3]<0||S.data.height<m[3]||m[2]<m[0]||m[3]<m[1]))}updateImage(m,S){S.version=this.images[m].version+1,this.images[m]=S,this.updatedImages[m]=!0}removeImage(m){const S=this.images[m];delete this.images[m],delete this.patterns[m],S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(m,S){let F=!0;if(!this.isLoaded())for(const X of m)this.images[X]||(F=!1);this.isLoaded()||F?this._notify(m,S):this.requestors.push({ids:m,callback:S})}_notify(m,S){const F={};for(const X of m){this.images[X]||this.fire(new r.Event("styleimagemissing",{id:X}));const $=this.images[X];$?F[X]={data:$.data.clone(),pixelRatio:$.pixelRatio,sdf:$.sdf,version:$.version,stretchX:$.stretchX,stretchY:$.stretchY,content:$.content,hasRenderCallback:!!($.userImage&&$.userImage.render)}:r.warnOnce(`Image "${X}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}S(null,F)}getPixelSize(){const{width:m,height:S}=this.atlasImage;return{width:m,height:S}}getPattern(m){const S=this.patterns[m],F=this.getImage(m);if(!F)return null;if(S&&S.position.version===F.version)return S.position;if(S)S.position.version=F.version;else{const X={w:F.data.width+2,h:F.data.height+2,x:0,y:0},$=new r.ImagePosition(X,F);this.patterns[m]={bin:X,position:$}}return this._updatePatternAtlas(),this.patterns[m].position}bind(m){const S=m.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(m,this.atlasImage,S.RGBA),this.atlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE)}_updatePatternAtlas(){const m=[];for(const $ in this.patterns)m.push(this.patterns[$].bin);const{w:S,h:F}=r.potpack(m),X=this.atlasImage;X.resize({width:S||1,height:F||1});for(const $ in this.patterns){const{bin:ot}=this.patterns[$],ct=ot.x+1,yt=ot.y+1,xt=this.images[$].data,Mt=xt.width,Pt=xt.height;r.RGBAImage.copy(xt,X,{x:0,y:0},{x:ct,y:yt},{width:Mt,height:Pt}),r.RGBAImage.copy(xt,X,{x:0,y:Pt-1},{x:ct,y:yt-1},{width:Mt,height:1}),r.RGBAImage.copy(xt,X,{x:0,y:0},{x:ct,y:yt+Pt},{width:Mt,height:1}),r.RGBAImage.copy(xt,X,{x:Mt-1,y:0},{x:ct-1,y:yt},{width:1,height:Pt}),r.RGBAImage.copy(xt,X,{x:0,y:0},{x:ct+Mt,y:yt},{width:1,height:Pt})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(m){for(const S of m){if(this.callbackDispatchedThisFrame[S])continue;this.callbackDispatchedThisFrame[S]=!0;const F=this.images[S];tt(F)&&this.updateImage(S,F)}}}const J=new r.Properties({anchor:new r.DataConstantProperty(r.spec.light.anchor),position:new class{constructor(){this.specification=r.spec.light.position}possiblyEvaluate(P,m){return function([S,F,X]){const $=r.degToRad(F+90),ot=r.degToRad(X);return{x:S*Math.cos($)*Math.sin(ot),y:S*Math.sin($)*Math.sin(ot),z:S*Math.cos(ot),azimuthal:F,polar:X}}(P.expression.evaluate(m))}interpolate(P,m,S){return{x:r.number(P.x,m.x,S),y:r.number(P.y,m.y,S),z:r.number(P.z,m.z,S),azimuthal:r.number(P.azimuthal,m.azimuthal,S),polar:r.number(P.polar,m.polar,S)}}},color:new r.DataConstantProperty(r.spec.light.color),intensity:new r.DataConstantProperty(r.spec.light.intensity)}),U="-transition";class G extends r.Evented{constructor(m){super(),this._transitionable=new r.Transitionable(J),this.setLight(m),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(m,S={}){if(!this._validate(r.validateLight,m,S))for(const F in m){const X=m[F];r.endsWith(F,U)?this._transitionable.setTransition(F.slice(0,-U.length),X):this._transitionable.setValue(F,X)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,S,F){return(!F||F.validate!==!1)&&r.emitValidationErrors(this,m.call(r.validateStyle,r.extend({value:S,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}const I=new r.Properties({source:new r.DataConstantProperty(r.spec.terrain.source),exaggeration:new r.DataConstantProperty(r.spec.terrain.exaggeration)}),C="-transition";class L extends r.Evented{constructor(m,S){super(),this._transitionable=new r.Transitionable(I),this.set(m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=S}get(){return this._transitionable.serialize()}set(m){for(const S in m){const F=m[S];r.endsWith(S,C)?this._transitionable.setTransition(S.slice(0,-C.length),F):this._transitionable.setValue(S,F)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}}function B(P,m,S,F){const X=r.smoothstep(45,65,S),[$,ot]=O(P,F),ct=r.length(m);let yt=1-Math.min(1,Math.exp((ct-$)/(ot-$)*-6));return yt*=yt*yt,yt=Math.min(1,1.00747*yt),yt*X*P.alpha}function O(P,m){const S=.5/Math.tan(.5*m);return[P.range[0]+S,P.range[1]+S]}const q=new r.Properties({range:new r.DataConstantProperty(r.spec.fog.range),color:new r.DataConstantProperty(r.spec.fog.color),"horizon-blend":new r.DataConstantProperty(r.spec.fog["horizon-blend"])}),it="-transition";class nt extends r.Evented{constructor(m,S){super(),this._transitionable=new r.Transitionable(q),this.set(m),this._transitioning=this._transitionable.untransitioned(),this._transform=S}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(m,S={}){if(!this._validate(r.validateFog,m,S))for(const F in m){const X=m[F];r.endsWith(F,it)?this._transitionable.setTransition(F.slice(0,-it.length),X):this._transitionable.setValue(F,X)}}getOpacity(m){if(!this._transform.projection.supportsFog)return 0;const S=this.properties&&this.properties.get("color")||1;return r.smoothstep(45,65,m)*S.a}getOpacityAtLatLng(m,S){return this._transform.projection.supportsFog?function(F,X,$){const ot=r.MercatorCoordinate.fromLngLat(X),ct=$.elevation?$.elevation.getAtPointOrZero(ot):0,yt=[ot.x,ot.y,ct];return r.transformMat4(yt,yt,$.mercatorFogMatrix),B(F,yt,$.pitch,$._fov)}(this.state,m,S):0}getFovAdjustedRange(m){return this._transform.projection.supportsFog?O(this.state,m):[0,1]}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,S,F){return(!F||F.validate!==!1)&&r.emitValidationErrors(this,m.call(r.validateStyle,r.extend({value:S,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}class lt{constructor(m,S){this.workerPool=m,this.actors=[],this.currentActor=0,this.id=r.uniqueId();const F=this.workerPool.acquire(this.id);for(let X=0;X<F.length;X++){const $=new lt.Actor(F[X],S,this.id);$.name=`Worker ${X}`,this.actors.push($)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(m,S,F){r.asyncAll(this.actors,(X,$)=>{X.send(m,S,$)},F=F||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(m=>{m.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ut(P,m,S){return m*(r.EXTENT/(P.tileSize*Math.pow(2,S-P.tileID.overscaledZ)))}lt.Actor=r.Actor;class vt{constructor(m,S,F,X){this.screenBounds=m,this.cameraPoint=S,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=F,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map($=>X.pointCoordinate3D($)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(m,S){let F,X;if(m instanceof r.pointGeometry||typeof m[0]=="number"){const $=r.pointGeometry.convert(m);F=[r.pointGeometry.convert(m)],X=S.isPointAboveHorizon($)}else{const $=r.pointGeometry.convert(m[0]),ot=r.pointGeometry.convert(m[1]);F=[$,ot],X=r.polygonizeBounds($,ot).every(ct=>S.isPointAboveHorizon(ct))}return new vt(F,S.getCameraPoint(),X,S)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(m){return r.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],m)}bufferedCameraGeometry(m){const S=this.screenBounds[0],F=this.screenBounds.length===1?this.screenBounds[0].add(new r.pointGeometry(1,1)):this.screenBounds[1],X=r.polygonizeBounds(S,F,0,!1);return this.cameraPoint.y>F.y&&(this.cameraPoint.x>S.x&&this.cameraPoint.x<F.x?X.splice(3,0,this.cameraPoint):this.cameraPoint.x>=F.x?X[2]=this.cameraPoint:this.cameraPoint.x<=S.x&&(X[3]=this.cameraPoint)),r.bufferConvexPolygon(X,m)}containsTile(m,S,F){const X=m.queryPadding+1,$=m.tileID.wrap,ot=F?this._bufferedCameraMercator(X,S).map(Ut=>r.getTilePoint(m.tileTransform,Ut,$)):this._bufferedScreenMercator(X,S).map(Ut=>r.getTilePoint(m.tileTransform,Ut,$)),ct=this.screenGeometryMercator.map(Ut=>r.getTileVec3(m.tileTransform,Ut,$)),yt=ct.map(Ut=>new r.pointGeometry(Ut[0],Ut[1])),xt=S.getFreeCameraOptions().position||new r.MercatorCoordinate(0,0,0),Mt=r.getTileVec3(m.tileTransform,xt,$),Pt=ct.map(Ut=>{const Bt=r.sub(Ut,Ut,Mt);return r.normalize(Bt,Bt),new r.Ray(Mt,Bt)}),Nt=ut(m,1,S.zoom);if(r.polygonIntersectsBox(ot,0,0,r.EXTENT,r.EXTENT))return{queryGeometry:this,tilespaceGeometry:yt,tilespaceRays:Pt,bufferedTilespaceGeometry:ot,bufferedTilespaceBounds:(Ht=r.getBounds(ot),Ht.min.x=r.clamp(Ht.min.x,0,r.EXTENT),Ht.min.y=r.clamp(Ht.min.y,0,r.EXTENT),Ht.max.x=r.clamp(Ht.max.x,0,r.EXTENT),Ht.max.y=r.clamp(Ht.max.y,0,r.EXTENT),Ht),tile:m,tileID:m.tileID,pixelToTileUnitsFactor:Nt};var Ht}_bufferedScreenMercator(m,S){const F=Q(m);if(this._screenRaycastCache[F])return this._screenRaycastCache[F];{const X=this.bufferedScreenGeometry(m).map($=>S.pointCoordinate3D($));return this._screenRaycastCache[F]=X,X}}_bufferedCameraMercator(m,S){const F=Q(m);if(this._cameraRaycastCache[F])return this._cameraRaycastCache[F];{const X=this.bufferedCameraGeometry(m).map($=>S.pointCoordinate3D($));return this._cameraRaycastCache[F]=X,X}}}function Q(P){return 100*P|0}function gt(P,m,S){const F=function(X,$){if(X)return S(X);if($){const ot=r.pick(r.extend($,P),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);$.vector_layers&&(ot.vectorLayers=$.vector_layers,ot.vectorLayerIds=ot.vectorLayers.map(ct=>ct.id)),ot.tiles=m.canonicalizeTileset(ot,P.url),S(null,ot)}};return P.url?r.getJSON(m.transformRequest(m.normalizeSourceURL(P.url),r.ResourceType.Source),F):r.exported.frame(()=>F(null,P))}class Y{constructor(m,S,F){this.bounds=r.LngLatBounds.convert(this.validateBounds(m)),this.minzoom=S||0,this.maxzoom=F||24}validateBounds(m){return Array.isArray(m)&&m.length===4?[Math.max(-180,m[0]),Math.max(-90,m[1]),Math.min(180,m[2]),Math.min(90,m[3])]:[-180,-90,180,90]}contains(m){const S=Math.pow(2,m.z),F=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*S),X=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*S),$=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*S),ot=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*S);return m.x>=F&&m.x<$&&m.y>=X&&m.y<ot}}class H{constructor(m,S,F){this.context=m;const X=m.gl;this.buffer=X.createBuffer(),this.dynamicDraw=!!F,this.context.unbindVAO(),m.bindElementBuffer.set(this.buffer),X.bufferData(X.ELEMENT_ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?X.DYNAMIC_DRAW:X.STATIC_DRAW),this.dynamicDraw||S.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(m){const S=this.context.gl;this.context.unbindVAO(),this.bind(),S.bufferSubData(S.ELEMENT_ARRAY_BUFFER,0,m.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const at={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ft{constructor(m,S,F,X){this.length=S.length,this.attributes=F,this.itemSize=S.bytesPerElement,this.dynamicDraw=X,this.context=m;const $=m.gl;this.buffer=$.createBuffer(),m.bindVertexBuffer.set(this.buffer),$.bufferData($.ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?$.DYNAMIC_DRAW:$.STATIC_DRAW),this.dynamicDraw||S.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(m){const S=this.context.gl;this.bind(),S.bufferSubData(S.ARRAY_BUFFER,0,m.arrayBuffer)}enableAttributes(m,S){for(let F=0;F<this.attributes.length;F++){const X=S.attributes[this.attributes[F].name];X!==void 0&&m.enableVertexAttribArray(X)}}setVertexAttribPointers(m,S,F){for(let X=0;X<this.attributes.length;X++){const $=this.attributes[X],ot=S.attributes[$.name];ot!==void 0&&m.vertexAttribPointer(ot,$.components,m[at[$.type]],!1,this.itemSize,$.offset+this.itemSize*(F||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class wt{constructor(m){this.gl=m.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(m){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class _t extends wt{getDefault(){return r.Color.transparent}set(m){const S=this.current;(m.r!==S.r||m.g!==S.g||m.b!==S.b||m.a!==S.a||this.dirty)&&(this.gl.clearColor(m.r,m.g,m.b,m.a),this.current=m,this.dirty=!1)}}class Dt extends wt{getDefault(){return 1}set(m){(m!==this.current||this.dirty)&&(this.gl.clearDepth(m),this.current=m,this.dirty=!1)}}class Gt extends wt{getDefault(){return 0}set(m){(m!==this.current||this.dirty)&&(this.gl.clearStencil(m),this.current=m,this.dirty=!1)}}class te extends wt{getDefault(){return[!0,!0,!0,!0]}set(m){const S=this.current;(m[0]!==S[0]||m[1]!==S[1]||m[2]!==S[2]||m[3]!==S[3]||this.dirty)&&(this.gl.colorMask(m[0],m[1],m[2],m[3]),this.current=m,this.dirty=!1)}}class mt extends wt{getDefault(){return!0}set(m){(m!==this.current||this.dirty)&&(this.gl.depthMask(m),this.current=m,this.dirty=!1)}}class At extends wt{getDefault(){return 255}set(m){(m!==this.current||this.dirty)&&(this.gl.stencilMask(m),this.current=m,this.dirty=!1)}}class Ot extends wt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(m){const S=this.current;(m.func!==S.func||m.ref!==S.ref||m.mask!==S.mask||this.dirty)&&(this.gl.stencilFunc(m.func,m.ref,m.mask),this.current=m,this.dirty=!1)}}class Zt extends wt{getDefault(){const m=this.gl;return[m.KEEP,m.KEEP,m.KEEP]}set(m){const S=this.current;(m[0]!==S[0]||m[1]!==S[1]||m[2]!==S[2]||this.dirty)&&(this.gl.stencilOp(m[0],m[1],m[2]),this.current=m,this.dirty=!1)}}class he extends wt{getDefault(){return!1}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;m?S.enable(S.STENCIL_TEST):S.disable(S.STENCIL_TEST),this.current=m,this.dirty=!1}}class fe extends wt{getDefault(){return[0,1]}set(m){const S=this.current;(m[0]!==S[0]||m[1]!==S[1]||this.dirty)&&(this.gl.depthRange(m[0],m[1]),this.current=m,this.dirty=!1)}}class be extends wt{getDefault(){return!1}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;m?S.enable(S.DEPTH_TEST):S.disable(S.DEPTH_TEST),this.current=m,this.dirty=!1}}class Me extends wt{getDefault(){return this.gl.LESS}set(m){(m!==this.current||this.dirty)&&(this.gl.depthFunc(m),this.current=m,this.dirty=!1)}}class Pe extends wt{getDefault(){return!1}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;m?S.enable(S.BLEND):S.disable(S.BLEND),this.current=m,this.dirty=!1}}class ze extends wt{getDefault(){const m=this.gl;return[m.ONE,m.ZERO]}set(m){const S=this.current;(m[0]!==S[0]||m[1]!==S[1]||this.dirty)&&(this.gl.blendFunc(m[0],m[1]),this.current=m,this.dirty=!1)}}class Ce extends wt{getDefault(){return r.Color.transparent}set(m){const S=this.current;(m.r!==S.r||m.g!==S.g||m.b!==S.b||m.a!==S.a||this.dirty)&&(this.gl.blendColor(m.r,m.g,m.b,m.a),this.current=m,this.dirty=!1)}}class Le extends wt{getDefault(){return this.gl.FUNC_ADD}set(m){(m!==this.current||this.dirty)&&(this.gl.blendEquation(m),this.current=m,this.dirty=!1)}}class Ye extends wt{getDefault(){return!1}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;m?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE),this.current=m,this.dirty=!1}}class le extends wt{getDefault(){return this.gl.BACK}set(m){(m!==this.current||this.dirty)&&(this.gl.cullFace(m),this.current=m,this.dirty=!1)}}class Fe extends wt{getDefault(){return this.gl.CCW}set(m){(m!==this.current||this.dirty)&&(this.gl.frontFace(m),this.current=m,this.dirty=!1)}}class Ke extends wt{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}}class Ze extends wt{getDefault(){return this.gl.TEXTURE0}set(m){(m!==this.current||this.dirty)&&(this.gl.activeTexture(m),this.current=m,this.dirty=!1)}}class ke extends wt{getDefault(){const m=this.gl;return[0,0,m.drawingBufferWidth,m.drawingBufferHeight]}set(m){const S=this.current;(m[0]!==S[0]||m[1]!==S[1]||m[2]!==S[2]||m[3]!==S[3]||this.dirty)&&(this.gl.viewport(m[0],m[1],m[2],m[3]),this.current=m,this.dirty=!1)}}class Qe extends wt{getDefault(){return null}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.bindFramebuffer(S.FRAMEBUFFER,m),this.current=m,this.dirty=!1}}class hn extends wt{getDefault(){return null}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.bindRenderbuffer(S.RENDERBUFFER,m),this.current=m,this.dirty=!1}}class ln extends wt{getDefault(){return null}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.bindTexture(S.TEXTURE_2D,m),this.current=m,this.dirty=!1}}class Hn extends wt{getDefault(){return null}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.bindBuffer(S.ARRAY_BUFFER,m),this.current=m,this.dirty=!1}}class Tn extends wt{getDefault(){return null}set(m){const S=this.gl;S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,m),this.current=m,this.dirty=!1}}class Sn extends wt{constructor(m){super(m),this.vao=m.extVertexArrayObject}getDefault(){return null}set(m){this.vao&&(m!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(m),this.current=m,this.dirty=!1)}}class On extends wt{getDefault(){return 4}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.pixelStorei(S.UNPACK_ALIGNMENT,m),this.current=m,this.dirty=!1}}class qn extends wt{getDefault(){return!1}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.pixelStorei(S.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),this.current=m,this.dirty=!1}}class Pn extends wt{getDefault(){return!1}set(m){if(m===this.current&&!this.dirty)return;const S=this.gl;S.pixelStorei(S.UNPACK_FLIP_Y_WEBGL,m),this.current=m,this.dirty=!1}}class cr extends wt{constructor(m,S){super(m),this.context=m,this.parent=S}getDefault(){return null}}class Yn extends cr{setDirty(){this.dirty=!0}set(m){if(m===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const S=this.gl;S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_2D,m,0),this.current=m,this.dirty=!1}}class zn extends cr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(m){if(m===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const S=this.gl;S.framebufferRenderbuffer(S.FRAMEBUFFER,this.attachment(),S.RENDERBUFFER,m),this.current=m,this.dirty=!1}}class Qn extends zn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Wt{constructor(m,S,F,X){this.context=m,this.width=S,this.height=F;const $=this.framebuffer=m.gl.createFramebuffer();this.colorAttachment=new Yn(m,$),X&&(this.depthAttachment=new zn(m,$))}destroy(){const m=this.context.gl,S=this.colorAttachment.get();if(S&&m.deleteTexture(S),this.depthAttachment){const F=this.depthAttachment.get();F&&m.deleteRenderbuffer(F)}m.deleteFramebuffer(this.framebuffer)}}class St{constructor(m){this.gl=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new _t(this),this.clearDepth=new Dt(this),this.clearStencil=new Gt(this),this.colorMask=new te(this),this.depthMask=new mt(this),this.stencilMask=new At(this),this.stencilFunc=new Ot(this),this.stencilOp=new Zt(this),this.stencilTest=new he(this),this.depthRange=new fe(this),this.depthTest=new be(this),this.depthFunc=new Me(this),this.blend=new Pe(this),this.blendFunc=new ze(this),this.blendColor=new Ce(this),this.blendEquation=new Le(this),this.cullFace=new Ye(this),this.cullFaceSide=new le(this),this.frontFace=new Fe(this),this.program=new Ke(this),this.activeTexture=new Ze(this),this.viewport=new ke(this),this.bindFramebuffer=new Qe(this),this.bindRenderbuffer=new hn(this),this.bindTexture=new ln(this),this.bindVertexBuffer=new Hn(this),this.bindElementBuffer=new Tn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Sn(this),this.pixelStoreUnpack=new On(this),this.pixelStoreUnpackPremultiplyAlpha=new qn(this),this.pixelStoreUnpackFlipY=new Pn(this),this.extTextureFilterAnisotropic=m.getExtension("EXT_texture_filter_anisotropic")||m.getExtension("MOZ_EXT_texture_filter_anisotropic")||m.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=m.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=m.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(m.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=m.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=m.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=m.getParameter(m.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(m,S){return new H(this,m,S)}createVertexBuffer(m,S,F){return new ft(this,m,S,F)}createRenderbuffer(m,S,F){const X=this.gl,$=X.createRenderbuffer();return this.bindRenderbuffer.set($),X.renderbufferStorage(X.RENDERBUFFER,m,S,F),this.bindRenderbuffer.set(null),$}createFramebuffer(m,S,F){return new Wt(this,m,S,F)}clear({color:m,depth:S,stencil:F}){const X=this.gl;let $=0;m&&($|=X.COLOR_BUFFER_BIT,this.clearColor.set(m),this.colorMask.set([!0,!0,!0,!0])),S!==void 0&&($|=X.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(S),this.depthMask.set(!0)),F!==void 0&&($|=X.STENCIL_BUFFER_BIT,this.clearStencil.set(F),this.stencilMask.set(255)),X.clear($)}setCullFace(m){m.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(m.mode),this.frontFace.set(m.frontFace))}setDepthMode(m){m.func!==this.gl.ALWAYS||m.mask?(this.depthTest.set(!0),this.depthFunc.set(m.func),this.depthMask.set(m.mask),this.depthRange.set(m.range)):this.depthTest.set(!1)}setStencilMode(m){m.test.func!==this.gl.ALWAYS||m.mask?(this.stencilTest.set(!0),this.stencilMask.set(m.mask),this.stencilOp.set([m.fail,m.depthFail,m.pass]),this.stencilFunc.set({func:m.test.func,ref:m.ref,mask:m.test.mask})):this.stencilTest.set(!1)}setColorMode(m){f(m.blendFunction,r.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(m.blendFunction),this.blendColor.set(m.blendColor)),this.colorMask.set(m.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Rt extends r.Evented{constructor(m,S,F,X){super(),this.id=m,this.dispatcher=F,this.setEventedParent(X),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},S),r.extend(this,r.pick(S,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,(m,S)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new r.ErrorEvent(m)):S&&(r.extend(this,S),S.bounds&&(this.tileBounds=new Y(S.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(S.tiles),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(m){this.map=m,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return r.extend({},this._options)}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,S){const F=r.exported.devicePixelRatio>=2,X=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),F,this.tileSize);m.request=r.getImage(this.map._requestManager.transformRequest(X,r.ResourceType.Tile),($,ot,ct,yt)=>(delete m.request,m.aborted?(m.state="unloaded",S(null)):$?(m.state="errored",S($)):ot?(this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:ct,expires:yt}),m.setTexture(ot,this.map.painter),m.state="loaded",r.cacheEntryPossiblyAdded(this.dispatcher),void S(null)):S(null)))}static loadTileData(m,S,F){m.setTexture(S,F)}static unloadTileData(m,S){m.texture&&S.saveTileTexture(m.texture)}abortTile(m,S){m.request&&(m.request.cancel(),delete m.request),S()}unloadTile(m,S){m.texture&&this.map.painter.saveTileTexture(m.texture),S()}hasTransition(){return!1}}let jt;function Xt(P,m,S,F,X,$,ot,ct){const yt=[P,S,X,m,F,$,1,1,1],xt=[ot,ct,1],Mt=r.adjoint([],yt),[Pt,Nt,Ht]=r.transformMat3(xt,xt,r.transpose(Mt,Mt));return r.multiply(yt,[Pt,0,0,0,Nt,0,0,0,Ht],yt)}class It extends r.Evented{constructor(m,S,F,X){super(),this.id=m,this.dispatcher=F,this.coordinates=S.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(X),this.options=S}load(m){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),(S,F)=>{if(this._loaded=!0,S)this.fire(new r.ErrorEvent(S));else if(F){const{HTMLImageElement:X}=r.window;this.image=F instanceof X?r.exported.getImageData(F):F,this.width=this.image.width,this.height=this.image.height,m&&(this.coordinates=m),this._finishLoading()}})}loaded(){return this._loaded}updateImage(m){return this.image&&m.url?(this.options.url=m.url,this.load(m.coordinates),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(m){this.map=m,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(m){this.coordinates=m,this._boundsArray=void 0;const S=m.map(r.MercatorCoordinate.fromLngLat);return this.tileID=function(F){let X=1/0,$=1/0,ot=-1/0,ct=-1/0;for(const Pt of F)X=Math.min(X,Pt.x),$=Math.min($,Pt.y),ot=Math.max(ot,Pt.x),ct=Math.max(ct,Pt.y);const yt=Math.max(ot-X,ct-$),xt=Math.max(0,Math.floor(-Math.log(yt)/Math.LN2)),Mt=Math.pow(2,xt);return new r.CanonicalTileID(xt,Math.floor((X+ot)/2*Mt),Math.floor(($+ct)/2*Mt))}(S),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(m){for(const yt in this.tiles){const xt=this.tiles[yt];xt.state!=="loaded"&&(xt.state="loaded",xt.texture=this.texture)}if(this._boundsArray)return;const S=r.tileTransform(this.tileID,this.map.transform.projection),[F,X,$,ot]=this.coordinates.map(yt=>{const xt=S.projection.project(yt[0],yt[1]);return r.getTilePoint(S,xt)._round()});this.perspectiveTransform=function(yt,xt,Mt,Pt,Nt,Ht,Ut,Bt,ae,Jt){const ie=Xt(0,0,yt,0,0,xt,yt,xt),se=Xt(Mt,Pt,Nt,Ht,Ut,Bt,ae,Jt);return r.multiply(se,r.adjoint(ie,ie),se),[se[6]/se[8]*yt/r.EXTENT,se[7]/se[8]*xt/r.EXTENT]}(this.width,this.height,F.x,F.y,X.x,X.y,ot.x,ot.y,$.x,$.y);const ct=this._boundsArray=new r.StructArrayLayout4i8;ct.emplaceBack(F.x,F.y,0,0),ct.emplaceBack(X.x,X.y,r.EXTENT,0),ct.emplaceBack(ot.x,ot.y,0,r.EXTENT),ct.emplaceBack($.x,$.y,r.EXTENT,r.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=m.createVertexBuffer(ct,r.boundsAttributes.members),this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const m=this.map.painter.context,S=m.gl;this.texture?this.texture.update(this.image):(this.texture=new r.Texture(m,this.image,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE)),this._prepareData(m)}loadTile(m,S){this.tileID&&this.tileID.equals(m.tileID.canonical)?(this.tiles[String(m.tileID.wrap)]=m,m.buckets={},S(null)):(m.state="errored",S(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const zt={vector:class extends r.Evented{constructor(P,m,S,F){if(super(),this.id=P,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(m,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(F),this._tileWorkers={},this._deduped=new r.DedupedRequest}load(){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,(P,m)=>{this._tileJSONRequest=null,this._loaded=!0,P?this.fire(new r.ErrorEvent(P)):m&&(r.extend(this,m),m.bounds&&(this.tileBounds=new Y(m.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(m.tiles,this.map._requestManager._customAccessToken),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(P){return!this.tileBounds||this.tileBounds.contains(P.canonical)}onAdd(P){this.map=P,this.load()}setSourceProperty(P){this._tileJSONRequest&&this._tileJSONRequest.cancel(),P();const m=this.map.style._getSourceCaches(this.id);for(const S of m)S.clearTiles();this.load()}setTiles(P){return this.setSourceProperty(()=>{this._options.tiles=P}),this}setUrl(P){return this.setSourceProperty(()=>{this.url=P,this._options.url=P}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return r.extend({},this._options)}loadTile(P,m){const S=this.map._requestManager.normalizeTileURL(P.tileID.canonical.url(this.tiles,this.scheme)),F={request:this.map._requestManager.transformRequest(S,r.ResourceType.Tile),data:void 0,uid:P.uid,tileID:P.tileID,tileZoom:P.tileZoom,zoom:P.tileID.overscaledZ,tileSize:this.tileSize*P.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:P.isSymbolTile};if(F.request.collectResourceTiming=this._collectResourceTiming,P.actor&&P.state!=="expired")P.state==="loading"?P.reloadCallback=m:P.request=P.actor.send("reloadTile",F,X.bind(this));else if(P.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)P.request=P.actor.send("loadTile",F,X.bind(this),void 0,!0);else{const $=r.loadVectorTile.call({deduped:this._deduped},F,(ot,ct)=>{ot||!ct?X.call(this,ot):(F.data={cacheControl:ct.cacheControl,expires:ct.expires,rawData:ct.rawData.slice(0)},P.actor&&P.actor.send("loadTile",F,X.bind(this),void 0,!0))},!0);P.request={cancel:$}}function X($,ot){return delete P.request,P.aborted?m(null):$&&$.status!==404?m($):(ot&&ot.resourceTiming&&(P.resourceTiming=ot.resourceTiming),this.map._refreshExpiredTiles&&ot&&P.setExpiryData(ot),P.loadVectorData(ot,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(P.reloadCallback&&(this.loadTile(P,P.reloadCallback),P.reloadCallback=null)))}}abortTile(P){P.request&&(P.request.cancel(),delete P.request),P.actor&&P.actor.send("abortTile",{uid:P.uid,type:this.type,source:this.id})}unloadTile(P){P.unloadVectorData(),P.actor&&P.actor.send("removeTile",{uid:P.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Rt,"raster-dem":class extends Rt{constructor(P,m,S,F){super(P,m,S,F),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}loadTile(P,m){const S=this.map._requestManager.normalizeTileURL(P.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function F(X,$){X&&(P.state="errored",m(X)),$&&(P.dem=$,P.dem.onDeserialize(),P.needsHillshadePrepare=!0,P.needsDEMTextureUpload=!0,P.state="loaded",m(null))}P.request=r.getImage(this.map._requestManager.transformRequest(S,r.ResourceType.Tile),function(X,$,ot,ct){if(delete P.request,P.aborted)P.state="unloaded",m(null);else if(X)P.state="errored",m(X);else if($){this.map._refreshExpiredTiles&&P.setExpiryData({cacheControl:ot,expires:ct});const yt=r.window.ImageBitmap&&$ instanceof r.window.ImageBitmap&&(jt==null&&(jt=r.window.OffscreenCanvas&&new r.window.OffscreenCanvas(1,1).getContext("2d")&&typeof r.window.createImageBitmap=="function"),jt),xt=1-($.width-r.prevPowerOfTwo($.width))/2;xt<1||P.neighboringTiles||(P.neighboringTiles=this._getNeighboringTiles(P.tileID));const Mt=yt?$:r.exported.getImageData($,xt),Pt={uid:P.uid,coord:P.tileID,source:this.id,rawImageData:Mt,encoding:this.encoding,padding:xt};P.actor&&P.state!=="expired"||(P.actor=this.dispatcher.getActor(),P.actor.send("loadDEMTile",Pt,F.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(P){const m=P.canonical,S=Math.pow(2,m.z),F=(m.x-1+S)%S,X=m.x===0?P.wrap-1:P.wrap,$=(m.x+1+S)%S,ot=m.x+1===S?P.wrap+1:P.wrap,ct={};return ct[new r.OverscaledTileID(P.overscaledZ,X,m.z,F,m.y).key]={backfilled:!1},ct[new r.OverscaledTileID(P.overscaledZ,ot,m.z,$,m.y).key]={backfilled:!1},m.y>0&&(ct[new r.OverscaledTileID(P.overscaledZ,X,m.z,F,m.y-1).key]={backfilled:!1},ct[new r.OverscaledTileID(P.overscaledZ,P.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},ct[new r.OverscaledTileID(P.overscaledZ,ot,m.z,$,m.y-1).key]={backfilled:!1}),m.y+1<S&&(ct[new r.OverscaledTileID(P.overscaledZ,X,m.z,F,m.y+1).key]={backfilled:!1},ct[new r.OverscaledTileID(P.overscaledZ,P.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},ct[new r.OverscaledTileID(P.overscaledZ,ot,m.z,$,m.y+1).key]={backfilled:!1}),ct}unloadTile(P){P.demTexture&&this.map.painter.saveTileTexture(P.demTexture),P.fbo&&(P.fbo.destroy(),delete P.fbo),P.dem&&delete P.dem,delete P.neighboringTiles,P.state="unloaded"}},geojson:class extends r.Evented{constructor(P,m,S,F){super(),this.id=P,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=S.getActor(),this.setEventedParent(F),this._data=m.data,this._options=r.extend({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;const X=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*X,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*X,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?m.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:r.EXTENT,radius:(m.clusterRadius!==void 0?m.clusterRadius:50)*X,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}onAdd(P){this.map=P,this.setData(this._data)}setData(P){return this._data=P,this._updateWorkerData(),this}getClusterExpansionZoom(P,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:P,source:this.id},m),this}getClusterChildren(P,m){return this.actor.send("geojson.getClusterChildren",{clusterId:P,source:this.id},m),this}getClusterLeaves(P,m,S,F){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:P,limit:m,offset:S},F),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.Event("dataloading",{dataType:"source"})),this._loaded=!1;const P=r.extend({},this.workerOptions),m=this._data;typeof m=="string"?(P.request=this.map._requestManager.transformRequest(r.exported.resolveURL(m),r.ResourceType.Source),P.request.collectResourceTiming=this._collectResourceTiming):P.data=JSON.stringify(m),this._pendingLoad=this.actor.send(`${this.type}.loadData`,P,(S,F)=>{if(this._loaded=!0,this._pendingLoad=null,S)this.fire(new r.ErrorEvent(S));else{const X={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&F&&F.resourceTiming&&F.resourceTiming[this.id]&&(X.resourceTiming=F.resourceTiming[this.id]),this.fire(new r.Event("data",X)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(P,m){const S=P.actor?"reloadTile":"loadTile";P.actor=this.actor,P.request=this.actor.send(S,{type:this.type,uid:P.uid,tileID:P.tileID,tileZoom:P.tileZoom,zoom:P.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(F,X)=>(delete P.request,P.unloadVectorData(),P.aborted?m(null):F?m(F):(P.loadVectorData(X,this.map.painter,S==="reloadTile"),m(null))),void 0,S==="loadTile")}abortTile(P){P.request&&(P.request.cancel(),delete P.request),P.aborted=!0}unloadTile(P){P.unloadVectorData(),this.actor.send("removeTile",{uid:P.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends It{constructor(P,m,S,F){super(P,m,S,F),this.roundZoom=!0,this.type="video",this.options=m}load(){this._loaded=!1;const P=this.options;this.urls=[];for(const m of P.urls)this.urls.push(this.map._requestManager.transformRequest(m,r.ResourceType.Source).url);r.getVideo(this.urls,(m,S)=>{this._loaded=!0,m?this.fire(new r.ErrorEvent(m)):S&&(this.video=S,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(P){if(this.video){const m=this.video.seekable;P<m.start(0)||P>m.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=P}}getVideo(){return this.video}onAdd(P){this.map||(this.map=P,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const P=this.map.painter.context,m=P.gl;this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(P,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(P)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:It,canvas:class extends It{constructor(P,m,S,F){super(P,m,S,F),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(X=>!Array.isArray(X)||X.length!==2||X.some($=>typeof $!="number"))||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${P}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${P}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${P}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${P}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${P}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(P){this.map=P,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let P=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,P=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,P=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const m=this.map.painter.context;this.texture?(P||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(m,this.canvas,m.gl.RGBA,{premultiply:!0}),this._prepareData(m)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const P of[this.canvas.width,this.canvas.height])if(isNaN(P)||P<=0)return!0;return!1}},custom:class extends r.Evented{constructor(P,m,S,F){super(),this.id=P,this.type="custom",this._dataType="raster",this._dispatcher=S,this._implementation=m,this.setEventedParent(F),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Y(this._implementation.bounds,this.minzoom,this.maxzoom)),m.update=this._update.bind(this),m.coveringTiles=this._coveringTiles.bind(this),r.extend(this,r.pick(m,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(P){this._map=P,this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(P),this.load()}onRemove(P){this._implementation.onRemove&&this._implementation.onRemove(P)}hasTile(P){if(this._implementation.hasTile){const{x:m,y:S,z:F}=P.canonical;return this._implementation.hasTile({x:m,y:S,z:F})}return!this.tileBounds||this.tileBounds.contains(P.canonical)}loadTile(P,m){const{x:S,y:F,z:X}=P.tileID.canonical,$=new r.window.AbortController,ot=this._implementation.loadTile({x:S,y:F,z:X},{signal:$.signal});if(!ot)return this.loadTileData(P,{width:this.tileSize,height:this.tileSize,data:null}),P.state="loaded",m(null);ot.cancel=()=>$.abort(),P.request=ot.then(function(ct){return delete P.request,P.aborted?(P.state="unloaded",m(null)):ct?function(yt){return yt instanceof r.window.ImageData||yt instanceof r.window.ImageBitmap||yt instanceof r.window.HTMLCanvasElement}(ct)?(this.loadTileData(P,ct),P.state="loaded",void m(null)):(P.state="errored",m(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(P,{width:this.tileSize,height:this.tileSize,data:null}),P.state="loaded",m(null))}.bind(this)).catch(ct=>{ct.code!==20&&(P.state="errored",m(ct))})}loadTileData(P,m){Rt.loadTileData(P,m,this._map.painter)}unloadTileData(P){Rt.unloadTileData(P,this._map.painter)}prepareTile(P){if(!this._implementation.prepareTile)return null;const{x:m,y:S,z:F}=P.tileID.canonical,X=this._implementation.prepareTile({x:m,y:S,z:F});return X?(this.loadTileData(P,X),P.state="loaded",X):null}unloadTile(P,m){if(this.unloadTileData(P),this._implementation.unloadTile){const{x:S,y:F,z:X}=P.tileID.canonical;this._implementation.unloadTile({x:S,y:F,z:X})}m()}abortTile(P,m){P.request&&P.request.cancel&&(P.request.cancel(),delete P.request),m()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(P=>({x:P.canonical.x,y:P.canonical.y,z:P.canonical.z}))}_update(){this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Kt=function(P,m,S,F){const X=new zt[m.type](P,m,S,F);if(X.id!==P)throw new Error(`Expected Source id to be ${P} instead of ${X.id}`);return r.bindAll(["load","abort","unload","serialize","prepare"],X),X};function Qt(P,m){const S=r.identity([]);return r.scale(S,S,[.5*P.width,.5*-P.height,1]),r.translate(S,S,[1,-1,0]),r.multiply$1(S,S,P.calculateProjMatrix(m.toUnwrapped())),Float32Array.from(S)}function me(P,m,S,F,X,$,ot,ct=!1){const yt=P.tilesIn(F,ot,ct);yt.sort(Xe);const xt=[];for(const Pt of yt)xt.push({wrappedTileID:Pt.tile.tileID.wrapped().key,queryResults:Pt.tile.queryRenderedFeatures(m,S,P._state,Pt,X,$,Qt(P.transform,Pt.tile.tileID),ct)});const Mt=function(Pt){const Nt={},Ht={};for(const Ut of Pt){const Bt=Ut.queryResults,ae=Ut.wrappedTileID,Jt=Ht[ae]=Ht[ae]||{};for(const ie in Bt){const se=Bt[ie],ce=Jt[ie]=Jt[ie]||{},ne=Nt[ie]=Nt[ie]||[];for(const de of se)ce[de.featureIndex]||(ce[de.featureIndex]=!0,ne.push(de))}}return Nt}(xt);for(const Pt in Mt)Mt[Pt].forEach(Nt=>{const Ht=Nt.feature,Ut=Ht.layer;Ut&&Ut.type!=="background"&&Ut.type!=="sky"&&(Ht.source=Ut.source,Ut["source-layer"]&&(Ht.sourceLayer=Ut["source-layer"]),Ht.state=Ht.id!==void 0?P.getFeatureState(Ut["source-layer"],Ht.id):{})});return Mt}function ve(P,m){const S=P.getRenderableIds().map($=>P.getTileByID($)),F=[],X={};for(let $=0;$<S.length;$++){const ot=S[$],ct=ot.tileID.canonical.key;X[ct]||(X[ct]=!0,ot.querySourceFeatures(F,m))}return F}function Xe(P,m){const S=P.tileID,F=m.tileID;return S.overscaledZ-F.overscaledZ||S.canonical.y-F.canonical.y||S.wrap-F.wrap||S.canonical.x-F.canonical.x}function Ee(){return bl.workerClass!=null?new bl.workerClass:new r.window.Worker(bl.workerUrl)}const $e="mapboxgl_preloaded_worker_pool";class Tt{constructor(){this.active={}}acquire(m){if(!this.workers)for(this.workers=[];this.workers.length<Tt.workerCount;)this.workers.push(new Ee);return this.active[m]=!0,this.workers.slice()}release(m){delete this.active[m],this.numActive()===0&&(this.workers.forEach(S=>{S.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$e]}numActive(){return Object.keys(this.active).length}}let Lt;function ee(){return Lt||(Lt=new Tt),Lt}function Yt(P,m){const S={};for(const F in P)F!=="ref"&&(S[F]=P[F]);return r.refProperties.forEach(F=>{F in m&&(S[F]=m[F])}),S}function Ve(P){P=P.slice();const m=Object.create(null);for(let S=0;S<P.length;S++)m[P[S].id]=P[S];for(let S=0;S<P.length;S++)"ref"in P[S]&&(P[S]=Yt(P[S],m[P[S].ref]));return P}Tt.workerCount=2;const Ue={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function en(P,m,S){S.push({command:Ue.addSource,args:[P,m[P]]})}function gn(P,m,S){m.push({command:Ue.removeSource,args:[P]}),S[P]=!0}function qt(P,m,S,F){gn(P,S,F),en(P,m,S)}function ye(P,m,S){let F;for(F in P[S])if(P[S].hasOwnProperty(F)&&F!=="data"&&!f(P[S][F],m[S][F]))return!1;for(F in m[S])if(m[S].hasOwnProperty(F)&&F!=="data"&&!f(P[S][F],m[S][F]))return!1;return!0}function pe(P,m,S,F,X,$){let ot;for(ot in m=m||{},P=P||{})P.hasOwnProperty(ot)&&(f(P[ot],m[ot])||S.push({command:$,args:[F,ot,m[ot],X]}));for(ot in m)m.hasOwnProperty(ot)&&!P.hasOwnProperty(ot)&&(f(P[ot],m[ot])||S.push({command:$,args:[F,ot,m[ot],X]}))}function Te(P){return P.id}function We(P,m){return P[m.id]=m,P}class Ie{constructor(m,S){this.reset(m,S)}reset(m,S){this.points=m||[],this._distances=[0];for(let F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(S||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(m){if(this.points.length===1)return this.points[0];m=r.clamp(m,0,1);let S=1,F=this._distances[S];const X=m*this.paddedLength+this.padding;for(;F<X&&S<this._distances.length;)F=this._distances[++S];const $=S-1,ot=this._distances[$],ct=F-ot,yt=ct>0?(X-ot)/ct:0;return this.points[$].mult(1-yt).add(this.points[S].mult(yt))}}class Ge{constructor(m,S,F){const X=this.boxCells=[],$=this.circleCells=[];this.xCellCount=Math.ceil(m/F),this.yCellCount=Math.ceil(S/F);for(let ot=0;ot<this.xCellCount*this.yCellCount;ot++)X.push([]),$.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=m,this.height=S,this.xScale=this.xCellCount/m,this.yScale=this.yCellCount/S,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(m,S,F,X,$){this._forEachCell(S,F,X,$,this._insertBoxCell,this.boxUid++),this.boxKeys.push(m),this.bboxes.push(S),this.bboxes.push(F),this.bboxes.push(X),this.bboxes.push($)}insertCircle(m,S,F,X){this._forEachCell(S-X,F-X,S+X,F+X,this._insertCircleCell,this.circleUid++),this.circleKeys.push(m),this.circles.push(S),this.circles.push(F),this.circles.push(X)}_insertBoxCell(m,S,F,X,$,ot){this.boxCells[$].push(ot)}_insertCircleCell(m,S,F,X,$,ot){this.circleCells[$].push(ot)}_query(m,S,F,X,$,ot){if(F<0||m>this.width||X<0||S>this.height)return!$&&[];const ct=[];if(m<=0&&S<=0&&this.width<=F&&this.height<=X){if($)return!0;for(let yt=0;yt<this.boxKeys.length;yt++)ct.push({key:this.boxKeys[yt],x1:this.bboxes[4*yt],y1:this.bboxes[4*yt+1],x2:this.bboxes[4*yt+2],y2:this.bboxes[4*yt+3]});for(let yt=0;yt<this.circleKeys.length;yt++){const xt=this.circles[3*yt],Mt=this.circles[3*yt+1],Pt=this.circles[3*yt+2];ct.push({key:this.circleKeys[yt],x1:xt-Pt,y1:Mt-Pt,x2:xt+Pt,y2:Mt+Pt})}return ot?ct.filter(ot):ct}return this._forEachCell(m,S,F,X,this._queryCell,ct,{hitTest:$,seenUids:{box:{},circle:{}}},ot),$?ct.length>0:ct}_queryCircle(m,S,F,X,$){const ot=m-F,ct=m+F,yt=S-F,xt=S+F;if(ct<0||ot>this.width||xt<0||yt>this.height)return!X&&[];const Mt=[];return this._forEachCell(ot,yt,ct,xt,this._queryCellCircle,Mt,{hitTest:X,circle:{x:m,y:S,radius:F},seenUids:{box:{},circle:{}}},$),X?Mt.length>0:Mt}query(m,S,F,X,$){return this._query(m,S,F,X,!1,$)}hitTest(m,S,F,X,$){return this._query(m,S,F,X,!0,$)}hitTestCircle(m,S,F,X){return this._queryCircle(m,S,F,!0,X)}_queryCell(m,S,F,X,$,ot,ct,yt){const xt=ct.seenUids,Mt=this.boxCells[$];if(Mt!==null){const Nt=this.bboxes;for(const Ht of Mt)if(!xt.box[Ht]){xt.box[Ht]=!0;const Ut=4*Ht;if(m<=Nt[Ut+2]&&S<=Nt[Ut+3]&&F>=Nt[Ut+0]&&X>=Nt[Ut+1]&&(!yt||yt(this.boxKeys[Ht]))){if(ct.hitTest)return ot.push(!0),!0;ot.push({key:this.boxKeys[Ht],x1:Nt[Ut],y1:Nt[Ut+1],x2:Nt[Ut+2],y2:Nt[Ut+3]})}}}const Pt=this.circleCells[$];if(Pt!==null){const Nt=this.circles;for(const Ht of Pt)if(!xt.circle[Ht]){xt.circle[Ht]=!0;const Ut=3*Ht;if(this._circleAndRectCollide(Nt[Ut],Nt[Ut+1],Nt[Ut+2],m,S,F,X)&&(!yt||yt(this.circleKeys[Ht]))){if(ct.hitTest)return ot.push(!0),!0;{const Bt=Nt[Ut],ae=Nt[Ut+1],Jt=Nt[Ut+2];ot.push({key:this.circleKeys[Ht],x1:Bt-Jt,y1:ae-Jt,x2:Bt+Jt,y2:ae+Jt})}}}}}_queryCellCircle(m,S,F,X,$,ot,ct,yt){const xt=ct.circle,Mt=ct.seenUids,Pt=this.boxCells[$];if(Pt!==null){const Ht=this.bboxes;for(const Ut of Pt)if(!Mt.box[Ut]){Mt.box[Ut]=!0;const Bt=4*Ut;if(this._circleAndRectCollide(xt.x,xt.y,xt.radius,Ht[Bt+0],Ht[Bt+1],Ht[Bt+2],Ht[Bt+3])&&(!yt||yt(this.boxKeys[Ut])))return ot.push(!0),!0}}const Nt=this.circleCells[$];if(Nt!==null){const Ht=this.circles;for(const Ut of Nt)if(!Mt.circle[Ut]){Mt.circle[Ut]=!0;const Bt=3*Ut;if(this._circlesCollide(Ht[Bt],Ht[Bt+1],Ht[Bt+2],xt.x,xt.y,xt.radius)&&(!yt||yt(this.circleKeys[Ut])))return ot.push(!0),!0}}}_forEachCell(m,S,F,X,$,ot,ct,yt){const xt=this._convertToXCellCoord(m),Mt=this._convertToYCellCoord(S),Pt=this._convertToXCellCoord(F),Nt=this._convertToYCellCoord(X);for(let Ht=xt;Ht<=Pt;Ht++)for(let Ut=Mt;Ut<=Nt;Ut++)if($.call(this,m,S,F,X,this.xCellCount*Ut+Ht,ot,ct,yt))return}_convertToXCellCoord(m){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(m*this.xScale)))}_convertToYCellCoord(m){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(m*this.yScale)))}_circlesCollide(m,S,F,X,$,ot){const ct=X-m,yt=$-S,xt=F+ot;return xt*xt>ct*ct+yt*yt}_circleAndRectCollide(m,S,F,X,$,ot,ct){const yt=(ot-X)/2,xt=Math.abs(m-(X+yt));if(xt>yt+F)return!1;const Mt=(ct-$)/2,Pt=Math.abs(S-($+Mt));if(Pt>Mt+F)return!1;if(xt<=yt||Pt<=Mt)return!0;const Nt=xt-yt,Ht=Pt-Mt;return Nt*Nt+Ht*Ht<=F*F}}const mn=Math.tan(85*Math.PI/180);function In(P,m,S,F,X,$){const ot=r.create();if(S){if(X.projection.name==="globe")r.multiply$1(ot,ot,r.calculateGlobeLabelMatrix(X,m));else{const ct=Z([],$);ot[0]=ct[0],ot[1]=ct[1],ot[4]=ct[2],ot[5]=ct[3]}F||r.rotateZ(ot,ot,X.angle)}else r.multiply$1(ot,X.labelPlaneMatrix,P);return ot}function Wn(P,m,S,F,X,$){if(S){if(X.projection.name==="globe"){const ot=In(P,m,S,F,X,$);return r.invert(ot,ot),r.multiply$1(ot,P,ot),ot}{const ot=r.clone(P),ct=r.identity([]);return ct[0]=$[0],ct[1]=$[1],ct[4]=$[2],ct[5]=$[3],r.multiply$1(ot,ot,ct),F||r.rotateZ(ot,ot,-X.angle),ot}}return X.glCoordMatrix}function vn(P,m,S=0){const F=[P.x,P.y,S,1];S?r.transformMat4$1(F,F,m):rr(F,F,m);const X=F[3];return{point:new r.pointGeometry(F[0]/X,F[1]/X),signedDistanceFromCamera:X}}function jn(P,m){const S=[P[0],P[1],P[2],1];r.transformMat4$1(S,S,m);const F=S[3];return{point:new r.pointGeometry(S[0]/F,S[1]/F),signedDistanceFromCamera:F}}function Xn(P,m){return Math.min(.5+P/m*.5,1.5)}function ur(P,m){const S=P[0]/P[3],F=P[1]/P[3];return S>=-m[0]&&S<=m[0]&&F>=-m[1]&&F<=m[1]}function wr(P,m,S,F,X,$,ot,ct,yt,xt){const Mt=S.transform,Pt=F?P.textSizeData:P.iconSizeData,Nt=r.evaluateSizeForZoom(Pt,S.transform.zoom),Ht=[256/S.width*2+1,256/S.height*2+1],Ut=F?P.text.dynamicLayoutVertexArray:P.icon.dynamicLayoutVertexArray;Ut.clear();const Bt=P.lineVertexArray,ae=F?P.text.placedSymbolArray:P.icon.placedSymbolArray,Jt=S.transform.width/S.transform.height;let ie=!1;for(let se=0;se<ae.length;se++){const ce=ae.get(se);if(ce.writingMode!==r.WritingMode.vertical||ie||se!==0&&ae.get(se-1).writingMode===r.WritingMode.horizontal||(ie=!0),(ce.hidden||ce.writingMode===r.WritingMode.vertical)&&!ie){$n(ce.numGlyphs,Ut);continue}ie=!1;const ne=new r.pointGeometry(ce.tileAnchorX,ce.tileAnchorY),de=yt?yt(ne):[0,0,0],Ae=Mt.projection.projectTilePoint(ne.x,ne.y,xt.canonical),Re=[Ae.x+de[0],Ae.y+de[1],Ae.z+de[2]],je=[...Re,1];if(r.transformMat4$1(je,je,m),!ur(je,Ht)){$n(ce.numGlyphs,Ut);continue}const Ne=Xn(S.transform.cameraToCenterDistance,je[3]),cn=r.evaluateSizeForFeature(Pt,Nt,ce),Se=ot?cn/Ne:cn*Ne,un=vn(new r.pointGeometry(Re[0],Re[1]),X,Re[2]);if(un.signedDistanceFromCamera<=0){$n(ce.numGlyphs,Ut);continue}let rn={};const En=ot?null:yt,He=Ei(ce,Se,!1,ct,m,X,$,P.glyphOffsetArray,Bt,Ut,un.point,ne,rn,Jt,En,Mt.projection,xt);ie=He.useVertical,En&&He.needsFlipping&&(rn={}),(He.notEnoughRoom||ie||He.needsFlipping&&Ei(ce,Se,!0,ct,m,X,$,P.glyphOffsetArray,Bt,Ut,un.point,ne,rn,Jt,En,Mt.projection,xt).notEnoughRoom)&&$n(ce.numGlyphs,Ut)}F?P.text.dynamicLayoutVertexBuffer.updateData(Ut):P.icon.dynamicLayoutVertexBuffer.updateData(Ut)}function Ur(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut){const Bt=ct.glyphStartIndex+ct.numGlyphs,ae=ct.lineStartIndex,Jt=ct.lineStartIndex+ct.lineLength,ie=m.getoffsetX(ct.glyphStartIndex),se=m.getoffsetX(Bt-1),ce=no(P*ie,S,F,X,$,ot,ct.segment,ae,Jt,yt,xt,Mt,Pt,Nt,!0,Ht,Ut);if(!ce)return null;const ne=no(P*se,S,F,X,$,ot,ct.segment,ae,Jt,yt,xt,Mt,Pt,Nt,!0,Ht,Ut);return ne?{first:ce,last:ne}:null}function qr(P,m,S,F){return P.writingMode===r.WritingMode.horizontal&&Math.abs(S.y-m.y)>Math.abs(S.x-m.x)*F?{useVertical:!0}:P.writingMode===r.WritingMode.vertical?m.y<S.y?{needsFlipping:!0}:null:P.flipState!==0&&function(X,$,ot){const ct=($.x-X.x)*ot;return ct===0||Math.abs(($.y-X.y)/ct)>mn}(m,S,F)?P.flipState===1?{needsFlipping:!0}:null:m.x>S.x?{needsFlipping:!0}:null}function Ei(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut,Bt,ae){const Jt=m/24,ie=P.lineOffsetX*Jt,se=P.lineOffsetY*Jt;let ce;if(P.numGlyphs>1){const ne=P.glyphStartIndex+P.numGlyphs,de=P.lineStartIndex,Ae=P.lineStartIndex+P.lineLength,Re=Ur(Jt,ct,ie,se,S,Mt,Pt,P,yt,$,Nt,Ut,!1,Bt,ae);if(!Re)return{notEnoughRoom:!0};const je=vn(Re.first.point,ot).point,Ne=vn(Re.last.point,ot).point;if(F&&!S){const cn=qr(P,je,Ne,Ht);if(P.flipState=cn&&cn.needsFlipping?1:2,cn)return cn}ce=[Re.first];for(let cn=P.glyphStartIndex+1;cn<ne-1;cn++)ce.push(no(Jt*ct.getoffsetX(cn),ie,se,S,Mt,Pt,P.segment,de,Ae,yt,$,Nt,Ut,!1,!1,Bt,ae));ce.push(Re.last)}else{if(F&&!S){const de=vn(Pt,X).point,Ae=P.lineStartIndex+P.segment+1,Re=new r.pointGeometry(yt.getx(Ae),yt.gety(Ae)),je=vn(Re,X),Ne=qr(P,de,je.signedDistanceFromCamera>0?je.point:ar(Pt,Re,de,1,X,void 0,Bt,ae.canonical),Ht);if(P.flipState=Ne&&Ne.needsFlipping?1:2,Ne)return Ne}const ne=no(Jt*ct.getoffsetX(P.glyphStartIndex),ie,se,S,Mt,Pt,P.segment,P.lineStartIndex,P.lineStartIndex+P.lineLength,yt,$,Nt,Ut,!1,!1,Bt,ae);if(!ne)return{notEnoughRoom:!0};ce=[ne]}for(const ne of ce)r.addDynamicAttributes(xt,ne.point,ne.angle);return{}}function Wi(P,m,S,F,X){const $=F.projectTilePoint(P.x,P.y,m);if(!X)return vn($,S,$.z);const ot=X(P);return vn(new r.pointGeometry($.x+ot[0],$.y+ot[1]),S,$.z+ot[2])}function ar(P,m,S,F,X,$,ot,ct){const yt=Wi(P.add(P.sub(m)._unit()),ct,X,ot,$).point,xt=S.sub(yt);return S.add(xt._mult(F/xt.mag()))}function no(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut,Bt,ae){const Jt=F?P-m:P+m;let ie=Jt>0?1:-1,se=0;F&&(ie*=-1,se=Math.PI),ie<0&&(se+=Math.PI);let ce=ie>0?ct+ot:ct+ot+1,ne=X,de=X,Ae=0,Re=0;const je=Math.abs(Jt),Ne=[],cn=[];let Se=$;const un=()=>{const Mn=ce-ie;return Ae===0?$:new r.pointGeometry(xt.getx(Mn),xt.gety(Mn))},rn=()=>ar(un(),Se,de,je-Ae+1,Mt,Nt,Bt,ae.canonical);for(;Ae+Re<=je;){if(ce+=ie,ce<ct||ce>=yt)return null;if(de=ne,Ne.push(ne),Ht&&cn.push(Se||un()),ne=Pt[ce],ne===void 0){Se=new r.pointGeometry(xt.getx(ce),xt.gety(ce));const Mn=Wi(Se,ae.canonical,Mt,Bt,Nt);ne=Mn.signedDistanceFromCamera>0?Pt[ce]=Mn.point:rn()}else Se=null;Ae+=Re,Re=de.dist(ne)}Ut&&Nt&&(Se=Se||new r.pointGeometry(xt.getx(ce),xt.gety(ce)),Pt[ce]=ne=Pt[ce]===void 0?ne:rn(),Re=de.dist(ne));const En=(je-Ae)/Re,He=ne.sub(de),_n=He.mult(En)._add(de);S&&_n._add(He._unit()._perp()._mult(S*ie));const Fn=se+Math.atan2(ne.y-de.y,ne.x-de.x);return Ne.push(_n),Ht&&(Se=Se||new r.pointGeometry(xt.getx(ce),xt.gety(ce)),cn.push(function(Mn,An,Vn){const ir=1-Vn;return new r.pointGeometry(Mn.x*ir+An.x*Vn,Mn.y*ir+An.y*Vn)}(cn.length>0?cn[cn.length-1]:Se,Se,En))),{point:_n,angle:Fn,path:Ne,tilePath:cn}}const ts=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $n(P,m){for(let S=0;S<P;S++){const F=m.length;m.resize(F+4),m.float32.set(ts,3*F)}}function rr(P,m,S){const F=m[0],X=m[1];return P[0]=S[0]*F+S[4]*X+S[12],P[1]=S[1]*F+S[5]*X+S[13],P[3]=S[3]*F+S[7]*X+S[15],P}const ii=100;class Mo{constructor(m,S,F=new Ge(m.width+200,m.height+200,25),X=new Ge(m.width+200,m.height+200,25)){this.transform=m,this.grid=F,this.ignoredGrid=X,this.pitchfactor=Math.cos(m._pitch)*m.cameraToCenterDistance,this.screenRightBoundary=m.width+ii,this.screenBottomBoundary=m.height+ii,this.gridRightBoundary=m.width+200,this.gridBottomBoundary=m.height+200,this.fogState=S}placeCollisionBox(m,S,F,X,$,ot,ct){let yt=S.projectedAnchorX,xt=S.projectedAnchorY,Mt=S.projectedAnchorZ;const Pt=S.elevation,Nt=S.tileID;if(Pt&&Nt){const ce=this.transform.projection.upVector(Nt.canonical,S.tileAnchorX,S.tileAnchorY),ne=this.transform.projection.upVectorScale(Nt.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;yt+=ce[0]*Pt*ne,xt+=ce[1]*Pt*ne,Mt+=ce[2]*Pt*ne}const Ht=this.projectAndGetPerspectiveRatio(ot,[yt,xt,Mt],S.tileID,this.transform.projection.name==="globe"||!!Pt||this.transform.pitch>0),Ut=$*Ht.perspectiveRatio,Bt=(S.x1*m+F.x-S.padding)*Ut+Ht.point.x,ae=(S.y1*m+F.y-S.padding)*Ut+Ht.point.y,Jt=(S.x2*m+F.x+S.padding)*Ut+Ht.point.x,ie=(S.y2*m+F.y+S.padding)*Ut+Ht.point.y,se=Ht.perspectiveRatio<=.55||Ht.occluded;return!this.isInsideGrid(Bt,ae,Jt,ie)||!X&&this.grid.hitTest(Bt,ae,Jt,ie,ct)||se?{box:[],offscreen:!1,occluded:Ht.occluded}:{box:[Bt,ae,Jt,ie],offscreen:this.isOffscreen(Bt,ae,Jt,ie),occluded:!1}}placeCollisionCircles(m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut){const Bt=[],ae=this.transform.elevation,Jt=ae?ae.getAtTileOffsetFunc(Ut,this.transform.center.lat,this.transform.worldSize,this.transform.projection):rn=>[0,0,0],ie=new r.pointGeometry(S.tileAnchorX,S.tileAnchorY),se=this.transform.projection.projectTilePoint(S.tileAnchorX,S.tileAnchorY,Ut.canonical),ce=Jt(ie),ne=[se.x+ce[0],se.y+ce[1],se.z+ce[2]],de=this.projectAndGetPerspectiveRatio(ot,[ne[0],ne[1],ne[2]],Ut,this.transform.projection.name==="globe"||!!ae||this.transform.pitch>0),{perspectiveRatio:Ae}=de,Re=(Mt?$/Ae:$*Ae)/r.ONE_EM,je=vn(new r.pointGeometry(ne[0],ne[1]),ct,ne[2]).point,Ne=de.signedDistanceFromCamera>0?Ur(Re,X,S.lineOffsetX*Re,S.lineOffsetY*Re,!1,je,ie,S,F,ct,{},ae&&!Mt?Jt:null,Mt&&!!ae,this.transform.projection,Ut):null;let cn=!1,Se=!1,un=!0;if(Ne&&!de.occluded){const rn=.5*Nt*Ae+Ht,En=new r.pointGeometry(-100,-100),He=new r.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),_n=new Ie,Fn=Ne.first,Mn=Ne.last;let An=[];for(let Bn=Fn.path.length-1;Bn>=1;Bn--)An.push(Fn.path[Bn]);for(let Bn=1;Bn<Mn.path.length;Bn++)An.push(Mn.path[Bn]);const Vn=2.5*rn;if(yt){const Bn=An.map(ae?(Gn,gr)=>{const Vr=Jt(gr<Fn.path.length-1?Fn.tilePath[Fn.path.length-1-gr]:Mn.tilePath[gr-Fn.path.length+2]);return vn(Gn,yt,Vr[2])}:Gn=>vn(Gn,yt));An=Bn.some(Gn=>Gn.signedDistanceFromCamera<=0)?[]:Bn.map(Gn=>Gn.point)}let ir=[];if(An.length>0){const Bn=An[0].clone(),Gn=An[0].clone();for(let gr=1;gr<An.length;gr++)Bn.x=Math.min(Bn.x,An[gr].x),Bn.y=Math.min(Bn.y,An[gr].y),Gn.x=Math.max(Gn.x,An[gr].x),Gn.y=Math.max(Gn.y,An[gr].y);ir=Bn.x>=En.x&&Gn.x<=He.x&&Bn.y>=En.y&&Gn.y<=He.y?[An]:Gn.x<En.x||Bn.x>He.x||Gn.y<En.y||Bn.y>He.y?[]:r.clipLine([An],En.x,En.y,He.x,He.y)}for(const Bn of ir){_n.reset(Bn,.25*rn);let Gn=0;Gn=_n.length<=.5*rn?1:Math.ceil(_n.paddedLength/Vn)+1;for(let gr=0;gr<Gn;gr++){const Vr=gr/Math.max(Gn-1,1),Pi=_n.lerp(Vr),Di=Pi.x+ii,lo=Pi.y+ii;Bt.push(Di,lo,rn,0);const Wo=Di-rn,_s=lo-rn,Zs=Di+rn,ws=lo+rn;if(un=un&&this.isOffscreen(Wo,_s,Zs,ws),Se=Se||this.isInsideGrid(Wo,_s,Zs,ws),!m&&this.grid.hitTestCircle(Di,lo,rn,Pt)&&(cn=!0,!xt))return{circles:[],offscreen:!1,collisionDetected:cn,occluded:!1}}}}return{circles:!xt&&cn||!Se?[]:Bt,offscreen:un,collisionDetected:cn,occluded:de.occluded}}queryRenderedSymbols(m){if(m.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const S=[];let F=1/0,X=1/0,$=-1/0,ot=-1/0;for(const Mt of m){const Pt=new r.pointGeometry(Mt.x+ii,Mt.y+ii);F=Math.min(F,Pt.x),X=Math.min(X,Pt.y),$=Math.max($,Pt.x),ot=Math.max(ot,Pt.y),S.push(Pt)}const ct=this.grid.query(F,X,$,ot).concat(this.ignoredGrid.query(F,X,$,ot)),yt={},xt={};for(const Mt of ct){const Pt=Mt.key;if(yt[Pt.bucketInstanceId]===void 0&&(yt[Pt.bucketInstanceId]={}),yt[Pt.bucketInstanceId][Pt.featureIndex])continue;const Nt=[new r.pointGeometry(Mt.x1,Mt.y1),new r.pointGeometry(Mt.x2,Mt.y1),new r.pointGeometry(Mt.x2,Mt.y2),new r.pointGeometry(Mt.x1,Mt.y2)];r.polygonIntersectsPolygon(S,Nt)&&(yt[Pt.bucketInstanceId][Pt.featureIndex]=!0,xt[Pt.bucketInstanceId]===void 0&&(xt[Pt.bucketInstanceId]=[]),xt[Pt.bucketInstanceId].push(Pt.featureIndex))}return xt}insertCollisionBox(m,S,F,X,$){(S?this.ignoredGrid:this.grid).insert({bucketInstanceId:F,featureIndex:X,collisionGroupID:$},m[0],m[1],m[2],m[3])}insertCollisionCircles(m,S,F,X,$){const ot=S?this.ignoredGrid:this.grid,ct={bucketInstanceId:F,featureIndex:X,collisionGroupID:$};for(let yt=0;yt<m.length;yt+=4)ot.insertCircle(ct,m[yt],m[yt+1],m[yt+2])}projectAndGetPerspectiveRatio(m,S,F,X){const $=[S[0],S[1],S[2],1];let ot=!1;return S[2]||this.transform.pitch>0?(r.transformMat4$1($,$,m),this.fogState&&F&&(ot=function(ct,yt,xt,Mt,Pt,Nt){const Ht=Nt.calculateFogTileMatrix(Pt),Ut=[yt,xt,Mt];return r.transformMat4(Ut,Ut,Ht),B(ct,Ut,Nt.pitch,Nt._fov)}(this.fogState,S[0],S[1],S[2],F.toUnwrapped(),this.transform)>.9)):rr($,$,m),{point:new r.pointGeometry(($[0]/$[3]+1)/2*this.transform.width+ii,(-$[1]/$[3]+1)/2*this.transform.height+ii),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/$[3]*.5,1.5),signedDistanceFromCamera:$[3],occluded:X&&$[2]>$[3]||ot}}isOffscreen(m,S,F,X){return F<ii||m>=this.screenRightBoundary||X<ii||S>this.screenBottomBoundary}isInsideGrid(m,S,F,X){return F>=0&&m<this.gridRightBoundary&&X>=0&&S<this.gridBottomBoundary}getViewportMatrix(){const m=r.identity([]);return r.translate(m,m,[-100,-100,0]),m}}class Lr{constructor(m,S,F,X){this.opacity=m?Math.max(0,Math.min(1,m.opacity+(m.placed?S:-S))):X&&F?1:0,this.placed=F}isHidden(){return this.opacity===0&&!this.placed}}class Xr{constructor(m,S,F,X,$,ot=!1){this.text=new Lr(m?m.text:null,S,F,$),this.icon=new Lr(m?m.icon:null,S,X,$),this.clipped=ot}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class di{constructor(m,S,F,X=!1){this.text=m,this.icon=S,this.skipFade=F,this.clipped=X}}class Br{constructor(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]}}class ys{constructor(m,S,F,X,$){this.bucketInstanceId=m,this.featureIndex=S,this.sourceLayerIndex=F,this.bucketIndex=X,this.tileID=$}}class Ti{constructor(m){this.crossSourceCollisions=m,this.maxGroupID=0,this.collisionGroups={}}get(m){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[m]){const S=++this.maxGroupID;this.collisionGroups[m]={ID:S,predicate:F=>F.collisionGroupID===S}}return this.collisionGroups[m]}}function ro(P,m,S,F,X){const{horizontalAlign:$,verticalAlign:ot}=r.getAnchorAlignment(P),ct=-($-.5)*m,yt=-(ot-.5)*S,xt=r.evaluateVariableOffset(P,F);return new r.pointGeometry(ct+xt[0]*X,yt+xt[1]*X)}function zi(P,m,S,F,X){const $=new r.pointGeometry(P,m);return S&&$._rotate(F?X:-X),$}class ih{constructor(m,S,F,X,$){this.transform=m.clone(),this.collisionIndex=new Mo(this.transform,$),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=S,this.retainedQueryData={},this.collisionGroups=new Ti(F),this.collisionCircleArrays={},this.prevPlacement=X,X&&(X.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(m,S,F,X){const $=F.getBucket(S),ot=F.latestFeatureIndex;if(!$||!ot||S.id!==$.layerIds[0])return;const ct=$.layers[0].layout,yt=F.collisionBoxArray,xt=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),Mt=F.tileSize/r.EXTENT,Pt=F.tileID.toUnwrapped(),Nt=this.transform.calculateProjMatrix(Pt),Ht=ct.get("text-pitch-alignment")==="map",Ut=ct.get("text-rotation-alignment")==="map";S.compileFilter();const Bt=S.dynamicFilter(),ae=S.dynamicFilterNeedsFeature(),Jt=this.transform.calculatePixelsToTileUnitsMatrix(F),ie=In(Nt,F.tileID.canonical,Ht,Ut,this.transform,Jt);let se=null;if(Ht){const de=Wn(Nt,F.tileID.canonical,Ht,Ut,this.transform,Jt);se=r.multiply$1([],this.transform.labelPlaneMatrix,de)}let ce=null;Bt&&F.latestFeatureIndex&&(ce={unwrappedTileID:Pt,dynamicFilter:Bt,dynamicFilterNeedsFeature:ae,featureIndex:F.latestFeatureIndex}),this.retainedQueryData[$.bucketInstanceId]=new ys($.bucketInstanceId,ot,$.sourceLayerIndex,$.index,F.tileID);const ne={bucket:$,layout:ct,posMatrix:Nt,textLabelPlaneMatrix:ie,labelToScreenMatrix:se,clippingData:ce,scale:xt,textPixelRatio:Mt,holdingForFade:F.holdingForFade(),collisionBoxArray:yt,partiallyEvaluatedTextSize:r.evaluateSizeForZoom($.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.evaluateSizeForZoom($.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get($.sourceID)};if(X)for(const de of $.sortKeyRanges){const{sortKey:Ae,symbolInstanceStart:Re,symbolInstanceEnd:je}=de;m.push({sortKey:Ae,symbolInstanceStart:Re,symbolInstanceEnd:je,parameters:ne})}else m.push({symbolInstanceStart:0,symbolInstanceEnd:$.symbolInstances.length,parameters:ne})}attemptAnchorPlacement(m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut,Bt,ae,Jt,ie){const se=[Nt.textOffset0,Nt.textOffset1],ce=ro(m,F,X,se,$),ne=this.collisionIndex.placeCollisionBox($,S,zi(ce.x,ce.y,ot,ct,this.transform.angle),Pt,yt,xt,Mt.predicate);if((!ae||this.collisionIndex.placeCollisionBox(Ut.getSymbolInstanceIconSize(ie,this.transform.zoom,Ht),ae,zi(ce.x,ce.y,ot,ct,this.transform.angle),Pt,yt,xt,Mt.predicate).box.length!==0)&&ne.box.length>0){let de;return this.prevPlacement&&this.prevPlacement.variableOffsets[Nt.crossTileID]&&this.prevPlacement.placements[Nt.crossTileID]&&this.prevPlacement.placements[Nt.crossTileID].text&&(de=this.prevPlacement.variableOffsets[Nt.crossTileID].anchor),this.variableOffsets[Nt.crossTileID]={textOffset:se,width:F,height:X,anchor:m,textScale:$,prevAnchor:de},this.markUsedJustification(Ut,m,Nt,Bt),Ut.allowVerticalPlacement&&(this.markUsedOrientation(Ut,Bt,Nt),this.placedOrientations[Nt.crossTileID]=Bt),{shift:ce,placedGlyphBoxes:ne}}}placeLayerBucketPart(m,S,F,X){const{bucket:$,layout:ot,posMatrix:ct,textLabelPlaneMatrix:yt,labelToScreenMatrix:xt,clippingData:Mt,textPixelRatio:Pt,holdingForFade:Nt,collisionBoxArray:Ht,partiallyEvaluatedTextSize:Ut,partiallyEvaluatedIconSize:Bt,collisionGroup:ae}=m.parameters,Jt=ot.get("text-optional"),ie=ot.get("icon-optional"),se=ot.get("text-allow-overlap"),ce=ot.get("icon-allow-overlap"),ne=ot.get("text-rotation-alignment")==="map",de=ot.get("text-pitch-alignment")==="map",Ae=ot.get("icon-text-fit")!=="none",Re=ot.get("symbol-z-order")==="viewport-y";let je=se&&(ce||!$.hasIconData()||ie),Ne=ce&&(se||!$.hasTextData()||Jt);!$.collisionArrays&&Ht&&$.deserializeCollisionBoxes(Ht),F&&X&&$.updateCollisionDebugBuffers(this.transform.zoom,Ht);const cn=(Se,un,rn)=>{if(Mt){const Gr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Yr=null;if(Mt.dynamicFilterNeedsFeature){const br=this.retainedQueryData[$.bucketInstanceId];Yr=Mt.featureIndex.loadFeature({featureIndex:Se.featureIndex,bucketIndex:br.bucketIndex,sourceLayerIndex:br.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Mt.dynamicFilter)(Gr,Yr,this.retainedQueryData[$.bucketInstanceId].tileID.canonical,new r.pointGeometry(Se.tileAnchorX,Se.tileAnchorY),this.transform.calculateDistanceTileData(Mt.unwrappedTileID)))return this.placements[Se.crossTileID]=new di(!1,!1,!1,!0),void(S[Se.crossTileID]=!0)}if(S[Se.crossTileID])return;if(Nt)return void(this.placements[Se.crossTileID]=new di(!1,!1,!1));let En=!1,He=!1,_n=!0,Fn=!1,Mn=!1,An=null,Vn={box:null,offscreen:null,occluded:null},ir={box:null,offscreen:null,occluded:null},Bn=null,Gn=null,gr=null,Vr=0,Pi=0,Di=0;rn.textFeatureIndex?Vr=rn.textFeatureIndex:Se.useRuntimeCollisionCircles&&(Vr=Se.featureIndex),rn.verticalTextFeatureIndex&&(Pi=rn.verticalTextFeatureIndex);const lo=Gr=>{Gr.tileID=this.retainedQueryData[$.bucketInstanceId].tileID,(this.transform.elevation||Gr.elevation)&&(Gr.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[$.bucketInstanceId].tileID,Gr.tileAnchorX,Gr.tileAnchorY):0)},Wo=rn.textBox;if(Wo){lo(Wo);const Gr=br=>{let Qr=r.WritingMode.horizontal;if($.allowVerticalPlacement&&!br&&this.prevPlacement){const co=this.prevPlacement.placedOrientations[Se.crossTileID];co&&(this.placedOrientations[Se.crossTileID]=co,Qr=co,this.markUsedOrientation($,Qr,Se))}return Qr},Yr=(br,Qr)=>{if($.allowVerticalPlacement&&Se.numVerticalGlyphVertices>0&&rn.verticalTextBox){for(const co of $.writingModes)if(co===r.WritingMode.vertical?(Vn=Qr(),ir=Vn):Vn=br(),Vn&&Vn.box&&Vn.box.length)break}else Vn=br()};if(ot.get("text-variable-anchor")){let br=ot.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Se.crossTileID]){const jr=this.prevPlacement.variableOffsets[Se.crossTileID];br.indexOf(jr.anchor)>0&&(br=br.filter(Eo=>Eo!==jr.anchor),br.unshift(jr.anchor))}const Qr=(jr,Eo,Nc)=>{const uo=$.getSymbolInstanceTextSize(Ut,Se,this.transform.zoom,un),Da=(jr.x2-jr.x1)*uo+2*jr.padding,N0=(jr.y2-jr.y1)*uo+2*jr.padding,sp=Ae&&!ce?Eo:null;sp&&lo(sp);let vl={box:[],offscreen:!1,occluded:!1};const $b=se?2*br.length:br.length;for(let Js=0;Js<$b;++Js){const ap=this.attemptAnchorPlacement(br[Js%br.length],jr,Da,N0,uo,ne,de,Pt,ct,ae,Js>=br.length,Se,un,$,Nc,sp,Ut,Bt);if(ap&&(vl=ap.placedGlyphBoxes,vl&&vl.box&&vl.box.length)){En=!0,An=ap.shift;break}}return vl};Yr(()=>Qr(Wo,rn.iconBox,r.WritingMode.horizontal),()=>{const jr=rn.verticalTextBox;return jr&&lo(jr),$.allowVerticalPlacement&&!(Vn&&Vn.box&&Vn.box.length)&&Se.numVerticalGlyphVertices>0&&jr?Qr(jr,rn.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Vn&&(En=Vn.box,_n=Vn.offscreen,Fn=Vn.occluded);const co=Gr(Vn&&Vn.box);if(!En&&this.prevPlacement){const jr=this.prevPlacement.variableOffsets[Se.crossTileID];jr&&(this.variableOffsets[Se.crossTileID]=jr,this.markUsedJustification($,jr.anchor,Se,co))}}else{const br=(Qr,co)=>{const jr=$.getSymbolInstanceTextSize(Ut,Se,this.transform.zoom,un),Eo=this.collisionIndex.placeCollisionBox(jr,Qr,new r.pointGeometry(0,0),se,Pt,ct,ae.predicate);return Eo&&Eo.box&&Eo.box.length&&(this.markUsedOrientation($,co,Se),this.placedOrientations[Se.crossTileID]=co),Eo};Yr(()=>br(Wo,r.WritingMode.horizontal),()=>{const Qr=rn.verticalTextBox;return $.allowVerticalPlacement&&Se.numVerticalGlyphVertices>0&&Qr?(lo(Qr),br(Qr,r.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Gr(Vn&&Vn.box&&Vn.box.length)}}if(Bn=Vn,En=Bn&&Bn.box&&Bn.box.length>0,_n=Bn&&Bn.offscreen,Fn=Bn&&Bn.occluded,Se.useRuntimeCollisionCircles){const Gr=$.text.placedSymbolArray.get(Se.centerJustifiedTextSymbolIndex>=0?Se.centerJustifiedTextSymbolIndex:Se.verticalPlacedTextSymbolIndex),Yr=r.evaluateSizeForFeature($.textSizeData,Ut,Gr),br=ot.get("text-padding");Gn=this.collisionIndex.placeCollisionCircles(se,Gr,$.lineVertexArray,$.glyphOffsetArray,Yr,ct,yt,xt,F,de,ae.predicate,Se.collisionCircleDiameter*Yr/r.ONE_EM,br,this.retainedQueryData[$.bucketInstanceId].tileID),En=se||Gn.circles.length>0&&!Gn.collisionDetected,_n=_n&&Gn.offscreen,Fn=Gn.occluded}if(rn.iconFeatureIndex&&(Di=rn.iconFeatureIndex),rn.iconBox){const Gr=Yr=>{lo(Yr);const br=Ae&&An?zi(An.x,An.y,ne,de,this.transform.angle):new r.pointGeometry(0,0),Qr=$.getSymbolInstanceIconSize(Bt,this.transform.zoom,un);return this.collisionIndex.placeCollisionBox(Qr,Yr,br,ce,Pt,ct,ae.predicate)};ir&&ir.box&&ir.box.length&&rn.verticalIconBox?(gr=Gr(rn.verticalIconBox),He=gr.box.length>0):(gr=Gr(rn.iconBox),He=gr.box.length>0),_n=_n&&gr.offscreen,Mn=gr.occluded}const _s=Jt||Se.numHorizontalGlyphVertices===0&&Se.numVerticalGlyphVertices===0,Zs=ie||Se.numIconVertices===0;if(_s||Zs?Zs?_s||(He=He&&En):En=He&&En:He=En=He&&En,En&&Bn&&Bn.box&&this.collisionIndex.insertCollisionBox(Bn.box,ot.get("text-ignore-placement"),$.bucketInstanceId,ir&&ir.box&&Pi?Pi:Vr,ae.ID),He&&gr&&this.collisionIndex.insertCollisionBox(gr.box,ot.get("icon-ignore-placement"),$.bucketInstanceId,Di,ae.ID),Gn&&(En&&this.collisionIndex.insertCollisionCircles(Gn.circles,ot.get("text-ignore-placement"),$.bucketInstanceId,Vr,ae.ID),F)){const Gr=$.bucketInstanceId;let Yr=this.collisionCircleArrays[Gr];Yr===void 0&&(Yr=this.collisionCircleArrays[Gr]=new Br);for(let br=0;br<Gn.circles.length;br+=4)Yr.circles.push(Gn.circles[br+0]),Yr.circles.push(Gn.circles[br+1]),Yr.circles.push(Gn.circles[br+2]),Yr.circles.push(Gn.collisionDetected?1:0)}const ws=this.transform.projection.name!=="globe";je=je&&(ws||!Fn),Ne=Ne&&(ws||!Mn),this.placements[Se.crossTileID]=new di(En||je,He||Ne,_n||$.justReloaded),S[Se.crossTileID]=!0};if(Re){const Se=$.getSortedSymbolIndexes(this.transform.angle);for(let un=Se.length-1;un>=0;--un){const rn=Se[un];cn($.symbolInstances.get(rn),rn,$.collisionArrays[rn])}}else for(let Se=m.symbolInstanceStart;Se<m.symbolInstanceEnd;Se++)cn($.symbolInstances.get(Se),Se,$.collisionArrays[Se]);if(F&&$.bucketInstanceId in this.collisionCircleArrays){const Se=this.collisionCircleArrays[$.bucketInstanceId];r.invert(Se.invProjMatrix,ct),Se.viewportMatrix=this.collisionIndex.getViewportMatrix()}$.justReloaded=!1}markUsedJustification(m,S,F,X){let $;$=X===r.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[r.getAnchorJustification(S)];const ot=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];for(const ct of ot)ct>=0&&(m.text.placedSymbolArray.get(ct).crossTileID=$>=0&&ct!==$?0:F.crossTileID)}markUsedOrientation(m,S,F){const X=S===r.WritingMode.horizontal||S===r.WritingMode.horizontalOnly?S:0,$=S===r.WritingMode.vertical?S:0,ot=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];for(const ct of ot)m.text.placedSymbolArray.get(ct).placedOrientation=X;F.verticalPlacedTextSymbolIndex&&(m.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=$)}commit(m){this.commitTime=m,this.zoomAtLastRecencyCheck=this.transform.zoom;const S=this.prevPlacement;let F=!1;this.prevZoomAdjustment=S?S.zoomAdjustment(this.transform.zoom):0;const X=S?S.symbolFadeChange(m):1,$=S?S.opacities:{},ot=S?S.variableOffsets:{},ct=S?S.placedOrientations:{};for(const yt in this.placements){const xt=this.placements[yt],Mt=$[yt];Mt?(this.opacities[yt]=new Xr(Mt,X,xt.text,xt.icon,null,xt.clipped),F=F||xt.text!==Mt.text.placed||xt.icon!==Mt.icon.placed):(this.opacities[yt]=new Xr(null,X,xt.text,xt.icon,xt.skipFade,xt.clipped),F=F||xt.text||xt.icon)}for(const yt in $){const xt=$[yt];if(!this.opacities[yt]){const Mt=new Xr(xt,X,!1,!1);Mt.isHidden()||(this.opacities[yt]=Mt,F=F||xt.text.placed||xt.icon.placed)}}for(const yt in ot)this.variableOffsets[yt]||!this.opacities[yt]||this.opacities[yt].isHidden()||(this.variableOffsets[yt]=ot[yt]);for(const yt in ct)this.placedOrientations[yt]||!this.opacities[yt]||this.opacities[yt].isHidden()||(this.placedOrientations[yt]=ct[yt]);F?this.lastPlacementChangeTime=m:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=S?S.lastPlacementChangeTime:m)}updateLayerOpacities(m,S){const F={};for(const X of S){const $=X.getBucket(m);$&&X.latestFeatureIndex&&m.id===$.layerIds[0]&&this.updateBucketOpacities($,F,X.collisionBoxArray)}}updateBucketOpacities(m,S,F){m.hasTextData()&&m.text.opacityVertexArray.clear(),m.hasIconData()&&m.icon.opacityVertexArray.clear(),m.hasIconCollisionBoxData()&&m.iconCollisionBox.collisionVertexArray.clear(),m.hasTextCollisionBoxData()&&m.textCollisionBox.collisionVertexArray.clear();const X=m.layers[0].layout,$=!!m.layers[0].dynamicFilter(),ot=new Xr(null,0,!1,!1,!0),ct=X.get("text-allow-overlap"),yt=X.get("icon-allow-overlap"),xt=X.get("text-variable-anchor"),Mt=X.get("text-rotation-alignment")==="map",Pt=X.get("text-pitch-alignment")==="map",Nt=X.get("icon-text-fit")!=="none",Ht=new Xr(null,0,ct&&(yt||!m.hasIconData()||X.get("icon-optional")),yt&&(ct||!m.hasTextData()||X.get("text-optional")),!0);!m.collisionArrays&&F&&(m.hasIconCollisionBoxData()||m.hasTextCollisionBoxData())&&m.deserializeCollisionBoxes(F);const Ut=(ae,Jt,ie)=>{for(let se=0;se<Jt/4;se++)ae.opacityVertexArray.emplaceBack(ie)};let Bt=0;for(let ae=0;ae<m.symbolInstances.length;ae++){const Jt=m.symbolInstances.get(ae),{numHorizontalGlyphVertices:ie,numVerticalGlyphVertices:se,crossTileID:ce}=Jt;let ne=this.opacities[ce];S[ce]?ne=ot:ne||(ne=Ht,this.opacities[ce]=ne),S[ce]=!0;const de=ie>0||se>0,Ae=Jt.numIconVertices>0,Re=this.placedOrientations[Jt.crossTileID],je=Re===r.WritingMode.vertical,Ne=Re===r.WritingMode.horizontal||Re===r.WritingMode.horizontalOnly;if(!de&&!Ae||ne.isHidden()||Bt++,de){const cn=qg(ne.text);Ut(m.text,ie,je?sh:cn),Ut(m.text,se,Ne?sh:cn);const Se=ne.text.isHidden();[Jt.rightJustifiedTextSymbolIndex,Jt.centerJustifiedTextSymbolIndex,Jt.leftJustifiedTextSymbolIndex].forEach(En=>{En>=0&&(m.text.placedSymbolArray.get(En).hidden=Se||je?1:0)}),Jt.verticalPlacedTextSymbolIndex>=0&&(m.text.placedSymbolArray.get(Jt.verticalPlacedTextSymbolIndex).hidden=Se||Ne?1:0);const un=this.variableOffsets[Jt.crossTileID];un&&this.markUsedJustification(m,un.anchor,Jt,Re);const rn=this.placedOrientations[Jt.crossTileID];rn&&(this.markUsedJustification(m,"left",Jt,rn),this.markUsedOrientation(m,rn,Jt))}if(Ae){const cn=qg(ne.icon);Jt.placedIconSymbolIndex>=0&&(Ut(m.icon,Jt.numIconVertices,je?sh:cn),m.icon.placedSymbolArray.get(Jt.placedIconSymbolIndex).hidden=ne.icon.isHidden()),Jt.verticalPlacedIconSymbolIndex>=0&&(Ut(m.icon,Jt.numVerticalIconVertices,Ne?sh:cn),m.icon.placedSymbolArray.get(Jt.verticalPlacedIconSymbolIndex).hidden=ne.icon.isHidden())}if(m.hasIconCollisionBoxData()||m.hasTextCollisionBoxData()){const cn=m.collisionArrays[ae];if(cn){let Se=new r.pointGeometry(0,0),un=!0;if(cn.textBox||cn.verticalTextBox){if(xt){const En=this.variableOffsets[ce];En?(Se=ro(En.anchor,En.width,En.height,En.textOffset,En.textScale),Mt&&Se._rotate(Pt?this.transform.angle:-this.transform.angle)):un=!1}$&&(un=!ne.clipped),cn.textBox&&Ci(m.textCollisionBox.collisionVertexArray,ne.text.placed,!un||je,Se.x,Se.y),cn.verticalTextBox&&Ci(m.textCollisionBox.collisionVertexArray,ne.text.placed,!un||Ne,Se.x,Se.y)}const rn=un&&!!(!Ne&&cn.verticalIconBox);cn.iconBox&&Ci(m.iconCollisionBox.collisionVertexArray,ne.icon.placed,rn,Nt?Se.x:0,Nt?Se.y:0),cn.verticalIconBox&&Ci(m.iconCollisionBox.collisionVertexArray,ne.icon.placed,!rn,Nt?Se.x:0,Nt?Se.y:0)}}}if(m.fullyClipped=Bt===0,m.sortFeatures(this.transform.angle),this.retainedQueryData[m.bucketInstanceId]&&(this.retainedQueryData[m.bucketInstanceId].featureSortOrder=m.featureSortOrder),m.hasTextData()&&m.text.opacityVertexBuffer&&m.text.opacityVertexBuffer.updateData(m.text.opacityVertexArray),m.hasIconData()&&m.icon.opacityVertexBuffer&&m.icon.opacityVertexBuffer.updateData(m.icon.opacityVertexArray),m.hasIconCollisionBoxData()&&m.iconCollisionBox.collisionVertexBuffer&&m.iconCollisionBox.collisionVertexBuffer.updateData(m.iconCollisionBox.collisionVertexArray),m.hasTextCollisionBoxData()&&m.textCollisionBox.collisionVertexBuffer&&m.textCollisionBox.collisionVertexBuffer.updateData(m.textCollisionBox.collisionVertexArray),m.bucketInstanceId in this.collisionCircleArrays){const ae=this.collisionCircleArrays[m.bucketInstanceId];m.placementInvProjMatrix=ae.invProjMatrix,m.placementViewportMatrix=ae.viewportMatrix,m.collisionCircleArray=ae.circles,delete this.collisionCircleArrays[m.bucketInstanceId]}}symbolFadeChange(m){return this.fadeDuration===0?1:(m-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(m){return Math.max(0,(this.transform.zoom-m)/1.5)}hasTransitions(m){return this.stale||m-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(m,S){const F=this.zoomAtLastRecencyCheck===S?1-this.zoomAdjustment(S):1;return this.zoomAtLastRecencyCheck=S,this.commitTime+this.fadeDuration*F>m}setStale(){this.stale=!0}}function Ci(P,m,S,F,X){P.emplaceBack(m?1:0,S?1:0,F||0,X||0),P.emplaceBack(m?1:0,S?1:0,F||0,X||0),P.emplaceBack(m?1:0,S?1:0,F||0,X||0),P.emplaceBack(m?1:0,S?1:0,F||0,X||0)}const hc=Math.pow(2,25),wa=Math.pow(2,24),yi=Math.pow(2,17),Ma=Math.pow(2,16),io=Math.pow(2,9),Vs=Math.pow(2,8),oh=Math.pow(2,1);function qg(P){if(P.opacity===0&&!P.placed)return 0;if(P.opacity===1&&P.placed)return 4294967295;const m=P.placed?1:0,S=Math.floor(127*P.opacity);return S*hc+m*wa+S*yi+m*Ma+S*io+m*Vs+S*oh+m}const sh=0;class Sf{constructor(m){this._sortAcrossTiles=m.layout.get("symbol-z-order")!=="viewport-y"&&m.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(m,S,F,X,$){const ot=this._bucketParts;for(;this._currentTileIndex<m.length;)if(S.getBucketParts(ot,X,m[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,$())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,ot.sort((ct,yt)=>ct.sortKey-yt.sortKey));this._currentPartIndex<ot.length;){const ct=ot[this._currentPartIndex];if(S.placeLayerBucketPart(ct,this._seenCrossTileIDs,F,ct.symbolInstanceStart===0),this._currentPartIndex++,$())return!0}return!1}}class Nb{constructor(m,S,F,X,$,ot,ct,yt){this.placement=new ih(m,$,ot,ct,yt),this._currentPlacementIndex=S.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=X,this._done=!1}isDone(){return this._done}continuePlacement(m,S,F){const X=r.exported.now(),$=()=>{const ot=r.exported.now()-X;return!this._forceFullPlacement&&ot>2};for(;this._currentPlacementIndex>=0;){const ot=S[m[this._currentPlacementIndex]],ct=this.placement.collisionIndex.transform.zoom;if(ot.type==="symbol"&&(!ot.minzoom||ot.minzoom<=ct)&&(!ot.maxzoom||ot.maxzoom>ct)){if(this._inProgressLayer||(this._inProgressLayer=new Sf(ot)),this._inProgressLayer.continuePlacement(F[ot.source],this.placement,this._showCollisionBoxes,ot,$))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(m){return this.placement.commit(m),this.placement}}const Xg=512/r.EXTENT/2;class Ob{constructor(m,S,F){this.tileID=m,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(let X=0;X<S.length;X++){const $=S.get(X),ot=$.key;this.indexedSymbolInstances[ot]||(this.indexedSymbolInstances[ot]=[]),this.indexedSymbolInstances[ot].push({crossTileID:$.crossTileID,coord:this.getScaledCoordinates($,m)})}}getScaledCoordinates(m,S){const F=Xg/Math.pow(2,S.canonical.z-this.tileID.canonical.z);return{x:Math.floor((S.canonical.x*r.EXTENT+m.tileAnchorX)*F),y:Math.floor((S.canonical.y*r.EXTENT+m.tileAnchorY)*F)}}findMatches(m,S,F){const X=this.tileID.canonical.z<S.canonical.z?1:Math.pow(2,this.tileID.canonical.z-S.canonical.z);for(let $=0;$<m.length;$++){const ot=m.get($);if(ot.crossTileID)continue;const ct=this.indexedSymbolInstances[ot.key];if(!ct)continue;const yt=this.getScaledCoordinates(ot,S);for(const xt of ct)if(Math.abs(xt.coord.x-yt.x)<=X&&Math.abs(xt.coord.y-yt.y)<=X&&!F[xt.crossTileID]){F[xt.crossTileID]=!0,ot.crossTileID=xt.crossTileID;break}}}}class Yg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class zb{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(m){const S=Math.round((m-this.lng)/360);if(S!==0)for(const F in this.indexes){const X=this.indexes[F],$={};for(const ot in X){const ct=X[ot];ct.tileID=ct.tileID.unwrapTo(ct.tileID.wrap+S),$[ct.tileID.key]=ct}this.indexes[F]=$}this.lng=m}addBucket(m,S,F){if(this.indexes[m.overscaledZ]&&this.indexes[m.overscaledZ][m.key]){if(this.indexes[m.overscaledZ][m.key].bucketInstanceId===S.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(m.overscaledZ,this.indexes[m.overscaledZ][m.key])}for(let $=0;$<S.symbolInstances.length;$++)S.symbolInstances.get($).crossTileID=0;this.usedCrossTileIDs[m.overscaledZ]||(this.usedCrossTileIDs[m.overscaledZ]={});const X=this.usedCrossTileIDs[m.overscaledZ];for(const $ in this.indexes){const ot=this.indexes[$];if(Number($)>m.overscaledZ)for(const ct in ot){const yt=ot[ct];yt.tileID.isChildOf(m)&&yt.findMatches(S.symbolInstances,m,X)}else{const ct=ot[m.scaledTo(Number($)).key];ct&&ct.findMatches(S.symbolInstances,m,X)}}for(let $=0;$<S.symbolInstances.length;$++){const ot=S.symbolInstances.get($);ot.crossTileID||(ot.crossTileID=F.generate(),X[ot.crossTileID]=!0)}return this.indexes[m.overscaledZ]===void 0&&(this.indexes[m.overscaledZ]={}),this.indexes[m.overscaledZ][m.key]=new Ob(m,S.symbolInstances,S.bucketInstanceId),!0}removeBucketCrossTileIDs(m,S){for(const F in S.indexedSymbolInstances)for(const X of S.indexedSymbolInstances[F])delete this.usedCrossTileIDs[m][X.crossTileID]}removeStaleBuckets(m){let S=!1;for(const F in this.indexes){const X=this.indexes[F];for(const $ in X)m[X[$].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,X[$]),delete X[$],S=!0)}return S}}class ah{constructor(){this.layerIndexes={},this.crossTileIDs=new Yg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(m,S,F,X){let $=this.layerIndexes[m.id];$===void 0&&($=this.layerIndexes[m.id]=new zb);let ot=!1;const ct={};X.name!=="globe"&&$.handleWrapJump(F);for(const yt of S){const xt=yt.getBucket(m);xt&&m.id===xt.layerIds[0]&&(xt.bucketInstanceId||(xt.bucketInstanceId=++this.maxBucketInstanceId),$.addBucket(yt.tileID,xt,this.crossTileIDs)&&(ot=!0),ct[xt.bucketInstanceId]=!0)}return $.removeStaleBuckets(ct)&&(ot=!0),ot}pruneUnusedLayers(m){const S={};m.forEach(F=>{S[F]=!0});for(const F in this.layerIndexes)S[F]||delete this.layerIndexes[F]}}const dc=(P,m)=>r.emitValidationErrors(P,m&&m.filter(S=>S.identifier!=="source.canvas")),Kg=r.pick(Ue,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Zg=r.pick(Ue,["setCenter","setZoom","setBearing","setPitch"]),Jg={version:8,layers:[],sources:{}},Aa={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class qi extends r.Evented{constructor(m,S={}){super(),this.map=m,this.dispatcher=new lt(ee(),this),this.imageManager=new rt,this.imageManager.setEventedParent(this),this.glyphManager=new r.GlyphManager(m._requestManager,S.localFontFamily?r.LocalGlyphMode.all:S.localIdeographFontFamily?r.LocalGlyphMode.ideographs:r.LocalGlyphMode.none,S.localFontFamily||S.localIdeographFontFamily),this.lineAtlas=new r.LineAtlas(256,512),this.crossTileSymbolIndex=new ah,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new r.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());const F=this;this._rtlTextPluginCallback=qi.registerForPluginStateChange(X=>{F.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:X.pluginStatus,pluginURL:X.pluginURL},($,ot)=>{if(r.triggerPluginCompletionEvent($),ot&&ot.every(ct=>ct))for(const ct in F._sourceCaches){const yt=F._sourceCaches[ct],xt=yt.getSource().type;xt!=="vector"&&xt!=="geojson"||yt.reload()}})}),this.on("data",X=>{if(X.dataType!=="source"||X.sourceDataType!=="metadata")return;const $=this.getSource(X.sourceId);if($&&$.vectorLayerIds)for(const ot in this._layers){const ct=this._layers[ot];ct.source===$.id&&this._validateLayer(ct)}})}loadURL(m,S={}){this.fire(new r.Event("dataloading",{dataType:"style"}));const F=typeof S.validate=="boolean"?S.validate:!r.isMapboxURL(m);m=this.map._requestManager.normalizeStyleURL(m,S.accessToken);const X=this.map._requestManager.transformRequest(m,r.ResourceType.Style);this._request=r.getJSON(X,($,ot)=>{this._request=null,$?this.fire(new r.ErrorEvent($)):ot&&this._load(ot,F)})}loadJSON(m,S={}){this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.exported.frame(()=>{this._request=null,this._load(m,S.validate!==!1)})}loadEmpty(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(Jg,!1)}_updateLayerCount(m,S){const F=S?1:-1;m.is3D()&&(this._num3DLayers+=F),m.type==="circle"&&(this._numCircleLayers+=F),m.type==="symbol"&&(this._numSymbolLayers+=F)}_load(m,S){if(S&&dc(this,r.validateStyle(m)))return;this._loaded=!0,this.stylesheet=m,this._updateMapProjection();for(const X in m.sources)this.addSource(X,m.sources[X],{validate:!1});this._changed=!1,m.sprite?this._loadSprite(m.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(m.glyphs);const F=Ve(this.stylesheet.layers);this._order=F.map(X=>X.id),this._layers={},this._serializedLayers={};for(let X of F)X=r.createStyleLayer(X),X.setEventedParent(this,{layer:{id:X.id}}),this._layers[X.id]=X,this._serializedLayers[X.id]=X.serialize(),this._updateLayerCount(X,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new G(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(m){m?this.stylesheet.projection=m:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(m){this._spriteRequest=function(S,F,X){let $,ot,ct;const yt=r.exported.devicePixelRatio>1?"@2x":"";let xt=r.getJSON(F.transformRequest(F.normalizeSpriteURL(S,yt,".json"),r.ResourceType.SpriteJSON),(Nt,Ht)=>{xt=null,ct||(ct=Nt,$=Ht,Pt())}),Mt=r.getImage(F.transformRequest(F.normalizeSpriteURL(S,yt,".png"),r.ResourceType.SpriteImage),(Nt,Ht)=>{Mt=null,ct||(ct=Nt,ot=Ht,Pt())});function Pt(){if(ct)X(ct);else if($&&ot){const Nt=r.exported.getImageData(ot),Ht={};for(const Ut in $){const{width:Bt,height:ae,x:Jt,y:ie,sdf:se,pixelRatio:ce,stretchX:ne,stretchY:de,content:Ae}=$[Ut],Re=new r.RGBAImage({width:Bt,height:ae});r.RGBAImage.copy(Nt,Re,{x:Jt,y:ie},{x:0,y:0},{width:Bt,height:ae}),Ht[Ut]={data:Re,pixelRatio:ce,sdf:se,stretchX:ne,stretchY:de,content:Ae}}X(null,Ht)}}return{cancel(){xt&&(xt.cancel(),xt=null),Mt&&(Mt.cancel(),Mt=null)}}}(m,this.map._requestManager,(S,F)=>{if(this._spriteRequest=null,S)this.fire(new r.ErrorEvent(S));else if(F)for(const X in F)this.imageManager.addImage(X,F[X]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new r.Event("data",{dataType:"style"}))})}_validateLayer(m){const S=this.getSource(m.source);if(!S)return;const F=m.sourceLayer;F&&(S.type==="geojson"||S.vectorLayerIds&&S.vectorLayerIds.indexOf(F)===-1)&&this.fire(new r.ErrorEvent(new Error(`Source layer "${F}" does not exist on source "${S.id}" as specified by style layer "${m.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const m in this._sourceCaches)if(!this._sourceCaches[m].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(m){const S=[];for(const F of m){const X=this._layers[F];X.type!=="custom"&&S.push(X.serialize())}return S}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const m in this._sourceCaches)if(this._sourceCaches[m].hasTransition())return!0;for(const m in this._layers)if(this._layers[m].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(m){return!!this.terrain&&Aa[m.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(m){if(!this._loaded)return;const S=this._changed;if(this._changed){const X=Object.keys(this._updatedLayers),$=Object.keys(this._removedLayers);(X.length||$.length)&&this._updateWorkerLayers(X,$);for(const ot in this._updatedSources){const ct=this._updatedSources[ot];ct==="reload"?this._reloadSource(ot):ct==="clear"&&this._clearSource(ot)}this._updateTilesForChangedImages();for(const ot in this._updatedPaintProps)this._layers[ot].updateTransitions(m);this.light.updateTransitions(m),this.fog&&this.fog.updateTransitions(m),this._resetUpdates()}const F={};for(const X in this._sourceCaches){const $=this._sourceCaches[X];F[X]=$.used,$.used=!1}for(const X of this._order){const $=this._layers[X];if($.recalculate(m,this._availableImages),!$.isHidden(m.zoom)){const ct=this._getLayerSourceCache($);ct&&(ct.used=!0)}const ot=this.map.painter;if(ot){const ct=$.getProgramIds();if(!ct)continue;const yt=$.getProgramConfiguration(m.zoom);for(const xt of ct)ot.useProgram(xt,yt)}}for(const X in F){const $=this._sourceCaches[X];F[X]!==$.used&&$.getSource().fire(new r.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:$.getSource().id}))}this.light.recalculate(m),this.terrain&&this.terrain.recalculate(m),this.fog&&this.fog.recalculate(m),this.z=m.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),S&&this.fire(new r.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const m=Object.keys(this._changedImages);if(m.length){for(const S in this._sourceCaches)this._sourceCaches[S].reloadTilesForDependencies(["icons","patterns"],m);this._changedImages={}}}_updateWorkerLayers(m,S){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(m),removedIds:S})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(m){if(this._checkLoaded(),dc(this,r.validateStyle(m)))return!1;(m=r.clone$1(m)).layers=Ve(m.layers);const S=function(X,$){if(!X)return[{command:Ue.setStyle,args:[$]}];let ot=[];try{if(!f(X.version,$.version))return[{command:Ue.setStyle,args:[$]}];f(X.center,$.center)||ot.push({command:Ue.setCenter,args:[$.center]}),f(X.zoom,$.zoom)||ot.push({command:Ue.setZoom,args:[$.zoom]}),f(X.bearing,$.bearing)||ot.push({command:Ue.setBearing,args:[$.bearing]}),f(X.pitch,$.pitch)||ot.push({command:Ue.setPitch,args:[$.pitch]}),f(X.sprite,$.sprite)||ot.push({command:Ue.setSprite,args:[$.sprite]}),f(X.glyphs,$.glyphs)||ot.push({command:Ue.setGlyphs,args:[$.glyphs]}),f(X.transition,$.transition)||ot.push({command:Ue.setTransition,args:[$.transition]}),f(X.light,$.light)||ot.push({command:Ue.setLight,args:[$.light]}),f(X.fog,$.fog)||ot.push({command:Ue.setFog,args:[$.fog]}),f(X.projection,$.projection)||ot.push({command:Ue.setProjection,args:[$.projection]});const ct={},yt=[];(function(Pt,Nt,Ht,Ut){let Bt;for(Bt in Nt=Nt||{},Pt=Pt||{})Pt.hasOwnProperty(Bt)&&(Nt.hasOwnProperty(Bt)||gn(Bt,Ht,Ut));for(Bt in Nt)Nt.hasOwnProperty(Bt)&&(Pt.hasOwnProperty(Bt)?f(Pt[Bt],Nt[Bt])||(Pt[Bt].type==="geojson"&&Nt[Bt].type==="geojson"&&ye(Pt,Nt,Bt)?Ht.push({command:Ue.setGeoJSONSourceData,args:[Bt,Nt[Bt].data]}):qt(Bt,Nt,Ht,Ut)):en(Bt,Nt,Ht))})(X.sources,$.sources,yt,ct);const xt=[];X.layers&&X.layers.forEach(Pt=>{Pt.source&&ct[Pt.source]?ot.push({command:Ue.removeLayer,args:[Pt.id]}):xt.push(Pt)});let Mt=X.terrain;Mt&&ct[Mt.source]&&(ot.push({command:Ue.setTerrain,args:[void 0]}),Mt=void 0),ot=ot.concat(yt),f(Mt,$.terrain)||ot.push({command:Ue.setTerrain,args:[$.terrain]}),function(Pt,Nt,Ht){Nt=Nt||[];const Ut=(Pt=Pt||[]).map(Te),Bt=Nt.map(Te),ae=Pt.reduce(We,{}),Jt=Nt.reduce(We,{}),ie=Ut.slice(),se=Object.create(null);let ce,ne,de,Ae,Re,je,Ne;for(ce=0,ne=0;ce<Ut.length;ce++)de=Ut[ce],Jt.hasOwnProperty(de)?ne++:(Ht.push({command:Ue.removeLayer,args:[de]}),ie.splice(ie.indexOf(de,ne),1));for(ce=0,ne=0;ce<Bt.length;ce++)de=Bt[Bt.length-1-ce],ie[ie.length-1-ce]!==de&&(ae.hasOwnProperty(de)?(Ht.push({command:Ue.removeLayer,args:[de]}),ie.splice(ie.lastIndexOf(de,ie.length-ne),1)):ne++,je=ie[ie.length-ce],Ht.push({command:Ue.addLayer,args:[Jt[de],je]}),ie.splice(ie.length-ce,0,de),se[de]=!0);for(ce=0;ce<Bt.length;ce++)if(de=Bt[ce],Ae=ae[de],Re=Jt[de],!se[de]&&!f(Ae,Re))if(f(Ae.source,Re.source)&&f(Ae["source-layer"],Re["source-layer"])&&f(Ae.type,Re.type)){for(Ne in pe(Ae.layout,Re.layout,Ht,de,null,Ue.setLayoutProperty),pe(Ae.paint,Re.paint,Ht,de,null,Ue.setPaintProperty),f(Ae.filter,Re.filter)||Ht.push({command:Ue.setFilter,args:[de,Re.filter]}),f(Ae.minzoom,Re.minzoom)&&f(Ae.maxzoom,Re.maxzoom)||Ht.push({command:Ue.setLayerZoomRange,args:[de,Re.minzoom,Re.maxzoom]}),Ae)Ae.hasOwnProperty(Ne)&&Ne!=="layout"&&Ne!=="paint"&&Ne!=="filter"&&Ne!=="metadata"&&Ne!=="minzoom"&&Ne!=="maxzoom"&&(Ne.indexOf("paint.")===0?pe(Ae[Ne],Re[Ne],Ht,de,Ne.slice(6),Ue.setPaintProperty):f(Ae[Ne],Re[Ne])||Ht.push({command:Ue.setLayerProperty,args:[de,Ne,Re[Ne]]}));for(Ne in Re)Re.hasOwnProperty(Ne)&&!Ae.hasOwnProperty(Ne)&&Ne!=="layout"&&Ne!=="paint"&&Ne!=="filter"&&Ne!=="metadata"&&Ne!=="minzoom"&&Ne!=="maxzoom"&&(Ne.indexOf("paint.")===0?pe(Ae[Ne],Re[Ne],Ht,de,Ne.slice(6),Ue.setPaintProperty):f(Ae[Ne],Re[Ne])||Ht.push({command:Ue.setLayerProperty,args:[de,Ne,Re[Ne]]}))}else Ht.push({command:Ue.removeLayer,args:[de]}),je=ie[ie.lastIndexOf(de)+1],Ht.push({command:Ue.addLayer,args:[Re,je]})}(xt,$.layers,ot)}catch(ct){console.warn("Unable to compute style diff:",ct),ot=[{command:Ue.setStyle,args:[$]}]}return ot}(this.serialize(),m).filter(X=>!(X.command in Zg));if(S.length===0)return!1;const F=S.filter(X=>!(X.command in Kg));if(F.length>0)throw new Error(`Unimplemented: ${F.map(X=>X.command).join(", ")}.`);return S.forEach(X=>{X.command!=="setTransition"&&this[X.command].apply(this,X.args)}),this.stylesheet=m,this._updateMapProjection(),!0}addImage(m,S){return this.getImage(m)?this.fire(new r.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(m,S),this._afterImageUpdated(m),this)}updateImage(m,S){this.imageManager.updateImage(m,S)}getImage(m){return this.imageManager.getImage(m)}removeImage(m){return this.getImage(m)?(this.imageManager.removeImage(m),this._afterImageUpdated(m),this):this.fire(new r.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(m){this._availableImages=this.imageManager.listImages(),this._changedImages[m]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(m,S,F={}){if(this._checkLoaded(),this.getSource(m)!==void 0)throw new Error("There is already a source with this ID");if(!S.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(S).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(S.type)>=0&&this._validate(r.validateSource,`sources.${m}`,S,null,F))return;this.map&&this.map._collectResourceTiming&&(S.collectResourceTiming=!0);const X=Kt(m,S,this.dispatcher,this);X.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(m),source:X.serialize(),sourceId:m}));const $=ot=>{const ct=(ot?"symbol:":"other:")+m,yt=this._sourceCaches[ct]=new r.SourceCache(ct,X,ot);(ot?this._symbolSourceCaches:this._otherSourceCaches)[m]=yt,yt.style=this,yt.onAdd(this.map)};$(!1),S.type!=="vector"&&S.type!=="geojson"||$(!0),X.onAdd&&X.onAdd(this.map),this._changed=!0}removeSource(m){this._checkLoaded();const S=this.getSource(m);if(!S)throw new Error("There is no source with this ID");for(const X in this._layers)if(this._layers[X].source===m)return this.fire(new r.ErrorEvent(new Error(`Source "${m}" cannot be removed while layer "${X}" is using it.`)));if(this.terrain&&this.terrain.get().source===m)return this.fire(new r.ErrorEvent(new Error(`Source "${m}" cannot be removed while terrain is using it.`)));const F=this._getSourceCaches(m);for(const X of F)delete this._sourceCaches[X.id],delete this._updatedSources[X.id],X.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:X.getSource().id})),X.setEventedParent(null),X.clearTiles();return delete this._otherSourceCaches[m],delete this._symbolSourceCaches[m],S.setEventedParent(null),S.onRemove&&S.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(m,S){this._checkLoaded(),this.getSource(m).setData(S),this._changed=!0}getSource(m){const S=this._getSourceCache(m);return S&&S.getSource()}addLayer(m,S,F={}){this._checkLoaded();const X=m.id;if(this.getLayer(X))return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${X}" already exists on this map`)));let $;if(m.type==="custom"){if(dc(this,r.validateCustomStyleLayer(m)))return;$=r.createStyleLayer(m)}else{if(typeof m.source=="object"&&(this.addSource(X,m.source),m=r.clone$1(m),m=r.extend(m,{source:X})),this._validate(r.validateLayer,`layers.${X}`,m,{arrayIndex:-1},F))return;$=r.createStyleLayer(m),this._validateLayer($),$.setEventedParent(this,{layer:{id:X}}),this._serializedLayers[$.id]=$.serialize(),this._updateLayerCount($,!0)}const ot=S?this._order.indexOf(S):this._order.length;if(S&&ot===-1)return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${S}" does not exist on this map.`)));this._order.splice(ot,0,X),this._layerOrderChanged=!0,this._layers[X]=$;const ct=this._getLayerSourceCache($);if(this._removedLayers[X]&&$.source&&ct&&$.type!=="custom"){const yt=this._removedLayers[X];delete this._removedLayers[X],yt.type!==$.type?this._updatedSources[$.source]="clear":(this._updatedSources[$.source]="reload",ct.pause())}this._updateLayer($),$.onAdd&&$.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(m,S){if(this._checkLoaded(),this._changed=!0,!this._layers[m])return void this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style and cannot be moved.`)));if(m===S)return;const F=this._order.indexOf(m);this._order.splice(F,1);const X=S?this._order.indexOf(S):this._order.length;S&&X===-1?this.fire(new r.ErrorEvent(new Error(`Layer with id "${S}" does not exist on this map.`))):(this._order.splice(X,0,m),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(m){this._checkLoaded();const S=this._layers[m];if(!S)return void this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style and cannot be removed.`)));S.setEventedParent(null),this._updateLayerCount(S,!1);const F=this._order.indexOf(m);this._order.splice(F,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[m]=S,delete this._layers[m],delete this._serializedLayers[m],delete this._updatedLayers[m],delete this._updatedPaintProps[m],S.onRemove&&S.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(m){return this._layers[m]}hasLayer(m){return m in this._layers}hasLayerType(m){for(const S in this._layers)if(this._layers[S].type===m)return!0;return!1}setLayerZoomRange(m,S,F){this._checkLoaded();const X=this.getLayer(m);X?X.minzoom===S&&X.maxzoom===F||(S!=null&&(X.minzoom=S),F!=null&&(X.maxzoom=F),this._updateLayer(X)):this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(m,S,F={}){this._checkLoaded();const X=this.getLayer(m);if(X){if(!f(X.filter,S))return S==null?(X.filter=void 0,void this._updateLayer(X)):void(this._validate(r.validateFilter,`layers.${X.id}.filter`,S,{layerType:X.type},F)||(X.filter=r.clone$1(S),this._updateLayer(X)))}else this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style and cannot be filtered.`)))}getFilter(m){const S=this.getLayer(m);return S&&r.clone$1(S.filter)}setLayoutProperty(m,S,F,X={}){this._checkLoaded();const $=this.getLayer(m);$?f($.getLayoutProperty(S),F)||($.setLayoutProperty(S,F,X),this._updateLayer($)):this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(m,S){const F=this.getLayer(m);if(F)return F.getLayoutProperty(S);this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style.`)))}setPaintProperty(m,S,F,X={}){this._checkLoaded();const $=this.getLayer(m);$?f($.getPaintProperty(S),F)||($.setPaintProperty(S,F,X)&&this._updateLayer($),this._changed=!0,this._updatedPaintProps[m]=!0):this.fire(new r.ErrorEvent(new Error(`The layer '${m}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(m,S){const F=this.getLayer(m);return F&&F.getPaintProperty(S)}setFeatureState(m,S){this._checkLoaded();const F=m.source,X=m.sourceLayer,$=this.getSource(F);if(!$)return void this.fire(new r.ErrorEvent(new Error(`The source '${F}' does not exist in the map's style.`)));const ot=$.type;if(ot==="geojson"&&X)return void this.fire(new r.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(ot==="vector"&&!X)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));m.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided.")));const ct=this._getSourceCaches(F);for(const yt of ct)yt.setFeatureState(X,m.id,S)}removeFeatureState(m,S){this._checkLoaded();const F=m.source,X=this.getSource(F);if(!X)return void this.fire(new r.ErrorEvent(new Error(`The source '${F}' does not exist in the map's style.`)));const $=X.type,ot=$==="vector"?m.sourceLayer:void 0;if($==="vector"&&!ot)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(S&&typeof m.id!="string"&&typeof m.id!="number")return void this.fire(new r.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const ct=this._getSourceCaches(F);for(const yt of ct)yt.removeFeatureState(ot,m.id,S)}getFeatureState(m){this._checkLoaded();const S=m.source,F=m.sourceLayer,X=this.getSource(S);if(X){if(X.type!=="vector"||F)return m.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(S)[0].getFeatureState(F,m.id);this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)))}getTransition(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const m={};for(const S in this._sourceCaches){const F=this._sourceCaches[S].getSource();m[F.id]||(m[F.id]=F.serialize())}return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:m,layers:this._serializeLayers(this._order)},S=>S!==void 0)}_updateLayer(m){this._updatedLayers[m.id]=!0;const S=this._getLayerSourceCache(m);m.source&&!this._updatedSources[m.source]&&S&&S.getSource().type!=="raster"&&(this._updatedSources[m.source]="reload",S.pause()),this._changed=!0,m.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(m){const S=ot=>this._layers[ot].type==="fill-extrusion",F={},X=[];for(let ot=this._order.length-1;ot>=0;ot--){const ct=this._order[ot];if(S(ct)){F[ct]=ot;for(const yt of m){const xt=yt[ct];if(xt)for(const Mt of xt)X.push(Mt)}}}X.sort((ot,ct)=>ct.intersectionZ-ot.intersectionZ);const $=[];for(let ot=this._order.length-1;ot>=0;ot--){const ct=this._order[ot];if(S(ct))for(let yt=X.length-1;yt>=0;yt--){const xt=X[yt].feature;if(F[xt.layer.id]<ot)break;$.push(xt),X.pop()}else for(const yt of m){const xt=yt[ct];if(xt)for(const Mt of xt)$.push(Mt.feature)}}return $}queryRenderedFeatures(m,S,F){S&&S.filter&&this._validate(r.validateFilter,"queryRenderedFeatures.filter",S.filter,null,S);const X={};if(S&&S.layers){if(!Array.isArray(S.layers))return this.fire(new r.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const yt of S.layers){const xt=this._layers[yt];if(!xt)return this.fire(new r.ErrorEvent(new Error(`The layer '${yt}' does not exist in the map's style and cannot be queried for features.`))),[];X[xt.source]=!0}}const $=[];S.availableImages=this._availableImages;const ot=S&&S.layers?S.layers.some(yt=>{const xt=this.getLayer(yt);return xt&&xt.is3D()}):this.has3DLayers(),ct=vt.createFromScreenPoints(m,F);for(const yt in this._sourceCaches){const xt=this._sourceCaches[yt].getSource().id;S.layers&&!X[xt]||$.push(me(this._sourceCaches[yt],this._layers,this._serializedLayers,ct,S,F,ot,!!this.map._showQueryGeometry))}return this.placement&&$.push(function(yt,xt,Mt,Pt,Nt,Ht,Ut){const Bt={},ae=Ht.queryRenderedSymbols(Pt),Jt=[];for(const ie of Object.keys(ae).map(Number))Jt.push(Ut[ie]);Jt.sort(Xe);for(const ie of Jt){const se=ie.featureIndex.lookupSymbolFeatures(ae[ie.bucketInstanceId],xt,ie.bucketIndex,ie.sourceLayerIndex,Nt.filter,Nt.layers,Nt.availableImages,yt);for(const ce in se){const ne=Bt[ce]=Bt[ce]||[],de=se[ce];de.sort((Ae,Re)=>{const je=ie.featureSortOrder;if(je){const Ne=je.indexOf(Ae.featureIndex);return je.indexOf(Re.featureIndex)-Ne}return Re.featureIndex-Ae.featureIndex});for(const Ae of de)ne.push(Ae)}}for(const ie in Bt)Bt[ie].forEach(se=>{const ce=se.feature,ne=Mt(yt[ie]).getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=ne});return Bt}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),ct.screenGeometry,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($)}querySourceFeatures(m,S){S&&S.filter&&this._validate(r.validateFilter,"querySourceFeatures.filter",S.filter,null,S);const F=this._getSourceCaches(m);let X=[];for(const $ of F)X=X.concat(ve($,S));return X}addSourceType(m,S,F){return qi.getSourceType(m)?F(new Error(`A source type called "${m}" already exists.`)):(qi.setSourceType(m,S),S.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:m,url:S.workerSourceURL},F):F(null,null))}getLight(){return this.light.getLight()}setLight(m,S={}){this._checkLoaded();const F=this.light.getLight();let X=!1;for(const ot in m)if(!f(m[ot],F[ot])){X=!0;break}if(!X)return;const $={now:r.exported.now(),transition:r.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(m,S),this.light.updateTransitions($)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(m,S=1){if(this._checkLoaded(),!m)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(S===1){if(typeof m.source=="object"){const F="terrain-dem-src";this.addSource(F,m.source),m=r.clone$1(m),m=r.extend(m,{source:F})}if(this._validate(r.validateTerrain,"terrain",m))return}if(!this.terrain||this.terrain&&S!==this.terrain.drapeRenderMode)this._createTerrain(m,S);else{const F=this.terrain,X=F.get();for(const $ in m)if(!f(m[$],X[$])){F.set(m),this.stylesheet.terrain=m;const ot={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};F.updateTransitions(ot);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(m){const S=this.fog=new nt(m,this.map.transform);this.stylesheet.fog=m;const F={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};S.updateTransitions(F)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const m of this.map._markers)m._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(m){if(this._checkLoaded(),!m)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const S=this.fog,F=S.get();for(const X in m)if(!f(m[X],F[X])){S.set(m),this.stylesheet.fog=m;const $={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};S.updateTransitions($);break}}else this._createFog(m);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const m=this._order.filter(F=>this.isLayerDraped(this._layers[F])),S=this._order.filter(F=>!this.isLayerDraped(this._layers[F]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...m),this._drapedFirstOrder.push(...S)}_createTerrain(m,S){const F=this.terrain=new L(m,S);this.stylesheet.terrain=m,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const X={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};F.updateTransitions(X)}_force3DLayerUpdate(){for(const m in this._layers){const S=this._layers[m];S.type==="fill-extrusion"&&this._updateLayer(S)}}_forceSymbolLayerUpdate(){for(const m in this._layers){const S=this._layers[m];S.type==="symbol"&&this._updateLayer(S)}}_validate(m,S,F,X,$={}){return(!$||$.validate!==!1)&&dc(this,m.call(r.validateStyle,r.extend({key:S,style:this.serialize(),value:F,styleSpec:r.spec},X)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const m in this._layers)this._layers[m].setEventedParent(null);for(const m in this._sourceCaches)this._sourceCaches[m].clearTiles(),this._sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(m){const S=this._getSourceCaches(m);for(const F of S)F.clearTiles()}_reloadSource(m){const S=this._getSourceCaches(m);for(const F of S)F.resume(),F.reload()}_updateSources(m){for(const S in this._sourceCaches)this._sourceCaches[S].update(m)}_generateCollisionBoxes(){for(const m in this._sourceCaches){const S=this._sourceCaches[m];S.resume(),S.reload()}}_updatePlacement(m,S,F,X,$=!1){let ot=!1,ct=!1;const yt={};for(const xt of this._order){const Mt=this._layers[xt];if(Mt.type!=="symbol")continue;if(!yt[Mt.source]){const Nt=this._getLayerSourceCache(Mt);if(!Nt)continue;yt[Mt.source]=Nt.getRenderableIds(!0).map(Ht=>Nt.getTileByID(Ht)).sort((Ht,Ut)=>Ut.tileID.overscaledZ-Ht.tileID.overscaledZ||(Ht.tileID.isLessThan(Ut.tileID)?-1:1))}const Pt=this.crossTileSymbolIndex.addLayer(Mt,yt[Mt.source],m.center.lng,m.projection);ot=ot||Pt}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),$=$||this._layerOrderChanged||F===0,this._layerOrderChanged&&this.fire(new r.Event("neworder")),($||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.exported.now(),m.zoom))&&(this.pauseablePlacement=new Nb(m,this._order,$,S,F,X,this.placement,this.fog&&m.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,yt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.exported.now()),ct=!0),ot&&this.pauseablePlacement.placement.setStale()),ct||ot)for(const xt of this._order){const Mt=this._layers[xt];Mt.type==="symbol"&&this.placement.updateLayerOpacities(Mt,yt[Mt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.exported.now())}_releaseSymbolFadeTiles(){for(const m in this._sourceCaches)this._sourceCaches[m].releaseSymbolFadeTiles()}getImages(m,S,F){this.imageManager.getImages(S.icons,F),this._updateTilesForChangedImages();const X=$=>{$&&$.setDependencies(S.tileID.key,S.type,S.icons)};X(this._otherSourceCaches[S.source]),X(this._symbolSourceCaches[S.source])}getGlyphs(m,S,F){this.glyphManager.getGlyphs(S.stacks,F)}getResource(m,S,F){return r.makeRequest(S,F)}_getSourceCache(m){return this._otherSourceCaches[m]}_getLayerSourceCache(m){return m.type==="symbol"?this._symbolSourceCaches[m.source]:this._otherSourceCaches[m.source]}_getSourceCaches(m){const S=[];return this._otherSourceCaches[m]&&S.push(this._otherSourceCaches[m]),this._symbolSourceCaches[m]&&S.push(this._symbolSourceCaches[m]),S}_isSourceCacheLoaded(m){const S=this._getSourceCaches(m);return S.length===0?(this.fire(new r.ErrorEvent(new Error(`There is no source with ID '${m}'`))),!1):S.every(F=>F.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}qi.getSourceType=function(P){return zt[P]},qi.setSourceType=function(P,m){zt[P]=m},qi.registerForPluginStateChange=r.registerForPluginStateChange;var fc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,pc="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Sa={},js={};Sa=Nn("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),js=Nn(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const lh=Nn(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),mc=fc;var gc={background:Nn(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Nn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Nn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Nn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Nn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Nn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Nn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Nn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Nn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Nn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Nn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Nn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Nn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Nn(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Nn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Nn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Nn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Nn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Nn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Nn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Nn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Nn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Nn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Nn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Nn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Nn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,pc),skyboxGradient:Nn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,pc),skyboxCapture:Nn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Nn(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:Nn(`uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;varying highp vec3 v_ray_dir;void main() {highp vec3 dir=normalize(v_ray_dir);highp vec3 closest_point=abs(dot(u_globe_pos,dir))*dir;float norm_dist_from_center=length(closest_point-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 1.0)
discard;float t=clamp(1.0-sqrt(norm_dist_from_center-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;varying highp vec3 v_ray_dir;void main() {v_ray_dir=mix(mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);gl_Position=vec4(a_pos,1.0);}")};function Nn(P,m,S){const F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,X=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,$=m.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),ot=P.match(X),ct=m.match(X),yt=fc.match(X);let xt=ct?ct.concat(ot):ot;S||(Sa.staticUniforms&&(xt=Sa.staticUniforms.concat(xt)),js.staticUniforms&&(xt=js.staticUniforms.concat(xt))),xt&&(xt=xt.concat(yt));const Mt={};return{fragmentSource:P=P.replace(F,(Pt,Nt,Ht,Ut,Bt)=>(Mt[Bt]=!0,Nt==="define"?`
#ifndef HAS_UNIFORM_u_${Bt}
varying ${Ht} ${Ut} ${Bt};
#else
uniform ${Ht} ${Ut} u_${Bt};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Bt}
    ${Ht} ${Ut} ${Bt} = u_${Bt};
#endif
`)),vertexSource:m=m.replace(F,(Pt,Nt,Ht,Ut,Bt)=>{const ae=Ut==="float"?"vec2":"vec4",Jt=Bt.match(/color/)?"color":ae;return Mt[Bt]?Nt==="define"?`
#ifndef HAS_UNIFORM_u_${Bt}
uniform lowp float u_${Bt}_t;
attribute ${Ht} ${ae} a_${Bt};
varying ${Ht} ${Ut} ${Bt};
#else
uniform ${Ht} ${Ut} u_${Bt};
#endif
`:Jt==="vec4"?`
#ifndef HAS_UNIFORM_u_${Bt}
    ${Bt} = a_${Bt};
#else
    ${Ht} ${Ut} ${Bt} = u_${Bt};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Bt}
    ${Bt} = unpack_mix_${Jt}(a_${Bt}, u_${Bt}_t);
#else
    ${Ht} ${Ut} ${Bt} = u_${Bt};
#endif
`:Nt==="define"?`
#ifndef HAS_UNIFORM_u_${Bt}
uniform lowp float u_${Bt}_t;
attribute ${Ht} ${ae} a_${Bt};
#else
uniform ${Ht} ${Ut} u_${Bt};
#endif
`:Jt==="vec4"?`
#ifndef HAS_UNIFORM_u_${Bt}
    ${Ht} ${Ut} ${Bt} = a_${Bt};
#else
    ${Ht} ${Ut} ${Bt} = u_${Bt};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Bt}
    ${Ht} ${Ut} ${Bt} = unpack_mix_${Jt}(a_${Bt}, u_${Bt}_t);
#else
    ${Ht} ${Ut} ${Bt} = u_${Bt};
#endif
`}),staticAttributes:$,staticUniforms:xt}}class ch{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(m,S,F,X,$,ot,ct,yt){this.context=m;let xt=this.boundPaintVertexBuffers.length!==X.length;for(let Mt=0;!xt&&Mt<X.length;Mt++)this.boundPaintVertexBuffers[Mt]!==X[Mt]&&(xt=!0);m.extVertexArrayObject&&this.vao&&this.boundProgram===S&&this.boundLayoutVertexBuffer===F&&!xt&&this.boundIndexBuffer===$&&this.boundVertexOffset===ot&&this.boundDynamicVertexBuffer===ct&&this.boundDynamicVertexBuffer2===yt?(m.bindVertexArrayOES.set(this.vao),ct&&ct.bind(),$&&$.dynamicDraw&&$.bind(),yt&&yt.bind()):this.freshBind(S,F,X,$,ot,ct,yt)}freshBind(m,S,F,X,$,ot,ct){let yt;const xt=m.numAttributes,Mt=this.context,Pt=Mt.gl;if(Mt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Mt.extVertexArrayObject.createVertexArrayOES(),Mt.bindVertexArrayOES.set(this.vao),yt=0,this.boundProgram=m,this.boundLayoutVertexBuffer=S,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=X,this.boundVertexOffset=$,this.boundDynamicVertexBuffer=ot,this.boundDynamicVertexBuffer2=ct;else{yt=Mt.currentNumAttributes||0;for(let Nt=xt;Nt<yt;Nt++)Pt.disableVertexAttribArray(Nt)}S.enableAttributes(Pt,m);for(const Nt of F)Nt.enableAttributes(Pt,m);ot&&ot.enableAttributes(Pt,m),ct&&ct.enableAttributes(Pt,m),S.bind(),S.setVertexAttribPointers(Pt,m,$);for(const Nt of F)Nt.bind(),Nt.setVertexAttribPointers(Pt,m,$);ot&&(ot.bind(),ot.setVertexAttribPointers(Pt,m,$)),X&&X.bind(),ct&&(ct.bind(),ct.setVertexAttribPointers(Pt,m,$)),Mt.currentNumAttributes=xt}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function $g(P,m){const S=Math.pow(2,m.canonical.z),F=m.canonical.y;return[new r.MercatorCoordinate(0,F/S).toLngLat().lat,new r.MercatorCoordinate(0,(F+1)/S).toLngLat().lat]}function Qg(P,m,S,F,X,$,ot){const ct=P.context,yt=ct.gl,xt=S.fbo;if(!xt)return;P.prepareDrawTile();const Mt=P.useProgram("hillshade");ct.activeTexture.set(yt.TEXTURE0),yt.bindTexture(yt.TEXTURE_2D,xt.colorAttachment.get());const Pt=((Bt,ae,Jt,ie)=>{const se=Jt.paint.get("hillshade-shadow-color"),ce=Jt.paint.get("hillshade-highlight-color"),ne=Jt.paint.get("hillshade-accent-color");let de=Jt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Jt.paint.get("hillshade-illumination-anchor")==="viewport"&&(de-=Bt.transform.angle);const Ae=!Bt.options.moving;return{u_matrix:ie||Bt.transform.calculateProjMatrix(ae.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:$g(0,ae.tileID),u_light:[Jt.paint.get("hillshade-exaggeration"),de],u_shadow:se,u_highlight:ce,u_accent:ne}})(P,S,F,P.terrain?m.projMatrix:null);P.prepareDrawProgram(ct,Mt,m.toUnwrapped());const{tileBoundsBuffer:Nt,tileBoundsIndexBuffer:Ht,tileBoundsSegments:Ut}=P.getTileBoundsBuffers(S);Mt.draw(ct,yt.TRIANGLES,X,$,ot,r.CullFaceMode.disabled,Pt,F.id,Nt,Ht,Ut)}function Ef(P,m,S){if(!m.needsDEMTextureUpload)return;const F=P.context,X=F.gl;F.pixelStoreUnpackPremultiplyAlpha.set(!1),m.demTexture=m.demTexture||P.getTileTexture(S.stride);const $=S.getPixels();m.demTexture?m.demTexture.update($,{premultiply:!1}):m.demTexture=new r.Texture(F,$,X.RGBA,{premultiply:!1}),m.needsDEMTextureUpload=!1}function Tf(P,m,S,F,X,$){const ot=P.context,ct=ot.gl;if(!m.dem)return;const yt=m.dem;if(ot.activeTexture.set(ct.TEXTURE1),Ef(P,m,yt),!m.demTexture)return;m.demTexture.bind(ct.NEAREST,ct.CLAMP_TO_EDGE);const xt=yt.dim;ot.activeTexture.set(ct.TEXTURE0);let Mt=m.fbo;if(!Mt){const Ut=new r.Texture(ot,{width:xt,height:xt,data:null},ct.RGBA);Ut.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),Mt=m.fbo=ot.createFramebuffer(xt,xt,!0),Mt.colorAttachment.set(Ut.texture)}ot.bindFramebuffer.set(Mt.framebuffer),ot.viewport.set([0,0,xt,xt]);const{tileBoundsBuffer:Pt,tileBoundsIndexBuffer:Nt,tileBoundsSegments:Ht}=P.getMercatorTileBoundsBuffers();P.useProgram("hillshadePrepare").draw(ot,ct.TRIANGLES,F,X,$,r.CullFaceMode.disabled,((Ut,Bt)=>{const ae=Bt.stride,Jt=r.create();return r.ortho(Jt,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(Jt,Jt,[0,-r.EXTENT,0]),{u_matrix:Jt,u_image:1,u_dimension:[ae,ae],u_zoom:Ut.overscaledZ,u_unpack:Bt.unpackVector}})(m.tileID,yt),S.id,Pt,Nt,Ht),m.needsHillshadePrepare=!1}const Cf=(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_image0:new r.Uniform1i(P,m.u_image0),u_skirt_height:new r.Uniform1f(P,m.u_skirt_height)}),t0=(P,m)=>({u_matrix:P,u_image0:0,u_skirt_height:m}),e0=(P,m,S,F,X,$)=>({u_proj_matrix:Float32Array.from(P),u_globe_matrix:m,u_merc_matrix:S,u_zoom_transition:F,u_merc_center:X,u_image0:0,u_grid_matrix:$?Float32Array.from($):new Float32Array(9)});function uh(P,m){return P!=null&&m!=null&&!(!P.hasData()||!m.hasData())&&P.demTexture!=null&&m.demTexture!=null&&P.tileID.key!==m.tileID.key}const Gs=new class{constructor(){this.operations={}}newMorphing(P,m,S,F,X){if(P in this.operations){const $=this.operations[P];$.to.tileID.key!==S.tileID.key&&($.queued=S)}else this.operations[P]={startTime:F,phase:0,duration:X,from:m,to:S,queued:null}}getMorphValuesForProxy(P){if(!(P in this.operations))return null;const m=this.operations[P];return{from:m.from,to:m.to,phase:m.phase}}update(P){for(const m in this.operations){const S=this.operations[m];for(S.phase=(P-S.startTime)/S.duration;S.phase>=1||!this._validOp(S);)if(!this._nextOp(S,P)){delete this.operations[m];break}}}_nextOp(P,m){return!!P.queued&&(P.from=P.to,P.to=P.queued,P.queued=null,P.phase=0,P.startTime=m,!0)}_validOp(P){return P.from.hasData()&&P.to.hasData()}},cl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Pf(P,m){const S=1<<P.z;return!m&&(P.x===0||P.x===S-1)||P.y===0||P.y===S-1}const hh=P=>({u_matrix:P});function Df(P,m,S,F,X){if(X>0){const $=r.exported.now(),ot=($-P.timeAdded)/X,ct=m?($-m.timeAdded)/X:-1,yt=S.getSource(),xt=F.coveringZoomLevel({tileSize:yt.tileSize,roundZoom:yt.roundZoom}),Mt=!m||Math.abs(m.tileID.overscaledZ-xt)>Math.abs(P.tileID.overscaledZ-xt),Pt=Mt&&P.refreshedUponExpiration?1:r.clamp(Mt?ot:1-ct,0,1);return P.refreshedUponExpiration&&ot>=1&&(P.refreshedUponExpiration=!1),m?{opacity:1,mix:1-Pt}:{opacity:Pt,mix:0}}return{opacity:1,mix:0}}const Ub=2*r.mercatorZfromAltitude(1,0)*r.GLOBE_RADIUS*Math.PI;class yc extends r.SourceCache{constructor(m){const S={type:"raster-dem",maxzoom:m.transform.maxZoom},F=new lt(ee(),null),X=Kt("mock-dem",S,F,m.style);super("mock-dem",X,!1),X.setEventedParent(this),this._sourceLoaded=!0}_loadTile(m,S){m.state="loaded",S(null)}}class bc extends r.SourceCache{constructor(m){const S=Kt("proxy",{type:"geojson",maxzoom:m.transform.maxZoom},new lt(ee(),null),m.style);super("proxy",S,!1),S.setEventedParent(this),this.map=this.getSource().map=m,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(m,S,F){if(m.freezeTileCoverage)return;this.transform=m;const X=m.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(($,ot)=>{if($[ot.key]="",!this._tiles[ot.key]){const ct=new r.Tile(ot,this._source.tileSize*ot.overscaleFactor(),m.tileZoom);ct.state="loaded",this._tiles[ot.key]=ct}return $},{});for(const $ in this._tiles)$ in X||(this.freeFBO($),this._tiles[$].unloadVectorData(),delete this._tiles[$])}freeFBO(m){const S=this.proxyCachedFBO[m];if(S!==void 0){const F=Object.values(S);this.renderCachePool.push(...F),delete this.proxyCachedFBO[m]}}deallocRenderCache(){this.renderCache.forEach(m=>m.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Rf extends r.OverscaledTileID{constructor(m,S,F){super(m.overscaledZ,m.wrap,m.canonical.z,m.canonical.x,m.canonical.y),this.proxyTileKey=S,this.projMatrix=F}}class oo extends r.Elevation{constructor(m,S){super(),this.painter=m,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[F,X,$]=function(yt){const xt=new r.StructArrayLayout4i8,Mt=new r.StructArrayLayout3ui6,Pt=131;xt.reserve(17161),Mt.reserve(33800);const Nt=r.EXTENT/128,Ht=r.EXTENT+Nt/2,Ut=Ht+Nt;for(let ae=-Nt;ae<Ut;ae+=Nt)for(let Jt=-Nt;Jt<Ut;Jt+=Nt){const ie=Jt<0||Jt>Ht||ae<0||ae>Ht?24575:0,se=r.clamp(Math.round(Jt),0,r.EXTENT),ce=r.clamp(Math.round(ae),0,r.EXTENT);xt.emplaceBack(se+ie,ce,se,ce)}const Bt=(ae,Jt)=>{const ie=Jt*Pt+ae;Mt.emplaceBack(ie+1,ie,ie+Pt),Mt.emplaceBack(ie+Pt,ie+Pt+1,ie+1)};for(let ae=1;ae<129;ae++)for(let Jt=1;Jt<129;Jt++)Bt(Jt,ae);return[0,129].forEach(ae=>{for(let Jt=0;Jt<130;Jt++)Bt(Jt,ae),Bt(ae,Jt)}),[xt,Mt,32768]}(),ot=m.context;this.gridBuffer=ot.createVertexBuffer(F,r.boundsAttributes.members),this.gridIndexBuffer=ot.createIndexBuffer(X),this.gridSegments=r.SegmentVector.simpleSegment(0,0,F.length,X.length),this.gridNoSkirtSegments=r.SegmentVector.simpleSegment(0,0,F.length,$),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new bc(S.map),this.orthoMatrix=r.create(),r.ortho(this.orthoMatrix,0,r.EXTENT,0,r.EXTENT,0,1);const ct=ot.gl;this._overlapStencilMode=new r.StencilMode({func:ct.GEQUAL,mask:255},0,255,ct.KEEP,ct.KEEP,ct.REPLACE),this._previousZoom=m.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=S,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new yc(S.map)}set style(m){m.on("data",this._onStyleDataEvent.bind(this)),m.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=m,this._checkRenderCacheEfficiency()}update(m,S,F){if(m&&m.terrain){this._style!==m&&(this.style=m),this.enabled=!0;const X=m.terrain.properties;this.sourceCache=m.terrain.drapeRenderMode===0?this._mockSourceCache:m._getSourceCache(X.get("source")),this._exaggeration=X.get("exaggeration");const $=()=>{this.sourceCache.used&&r.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ot=this.getScaledDemTileSize();this.sourceCache.update(S,ot,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,$(),this._initializing=!0),$(),S.updateElevation(!F),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(S),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(m){this._findCoveringTileCache[m]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const m=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||m.efficiency!==100&&r.warnOnce(`Terrain render cache efficiency is not optimal (${m.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${m.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(m){m.coord&&m.dataType==="source"?this._clearRenderCacheForTile(m.sourceCacheId,m.coord):m.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const m in this._style._sourceCaches)this._style._sourceCaches[m].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(m=>m.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const m=2*this.proxySourceCache.getSource().tileSize;return[m,m]}set useVertexMorphing(m){this._useVertexMorphing=m}updateTileBinding(m){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const S=this.proxySourceCache,F=this.painter.transform;this._initializing&&(this._initializing=F._centerAltitude===0&&this.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(F.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const X=this.proxyCoords=S.getIds().map(yt=>{const xt=S.getTileByID(yt).tileID;return xt.projMatrix=F.calculateProjMatrix(xt.toUnwrapped()),xt});(function(yt,xt){const Mt=xt.transform.pointCoordinate(xt.transform.getCameraPoint()),Pt=new r.pointGeometry(Mt.x,Mt.y);yt.sort((Nt,Ht)=>{if(Ht.overscaledZ-Nt.overscaledZ)return Ht.overscaledZ-Nt.overscaledZ;const Ut=new r.pointGeometry(Nt.canonical.x+(1<<Nt.canonical.z)*Nt.wrap,Nt.canonical.y),Bt=new r.pointGeometry(Ht.canonical.x+(1<<Ht.canonical.z)*Ht.wrap,Ht.canonical.y),ae=Pt.mult(1<<Nt.canonical.z);return ae.x-=.5,ae.y-=.5,ae.distSqr(Ut)-ae.distSqr(Bt)})})(X,this.painter),this._previousZoom=F.zoom;const $=this.proxyToSource||{};this.proxyToSource={},X.forEach(yt=>{this.proxyToSource[yt.key]={}}),this.terrainTileForTile={};const ot=this._style._sourceCaches;for(const yt in ot){const xt=ot[yt];if(!xt.used||(xt!==this.sourceCache&&this.resetTileLookupCache(xt.id),this._setupProxiedCoordsForOrtho(xt,m[yt],$),xt.usedForTerrain))continue;const Mt=m[yt];xt.getSource().reparseOverscaled&&this._assignTerrainTiles(Mt)}this.proxiedCoords[S.id]=X.map(yt=>new Rf(yt,yt.key,this.orthoMatrix)),this._assignTerrainTiles(X),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache($),this.renderingToTexture=!1,this._updateTimestamp=r.exported.now();const ct={};this._visibleDemTiles=[];for(const yt of this.proxyCoords){const xt=this.terrainTileForTile[yt.key];if(!xt)continue;const Mt=xt.tileID.key;Mt in ct||(this._visibleDemTiles.push(xt),ct[Mt]=Mt)}}_assignTerrainTiles(m){this._initializing||m.forEach(S=>{if(this.terrainTileForTile[S.key])return;const F=this._findTileCoveringTileID(S,this.sourceCache);F&&(this.terrainTileForTile[S.key]=F)})}_prepareDEMTextures(){const m=this.painter.context,S=m.gl;for(const F in this.terrainTileForTile){const X=this.terrainTileForTile[F],$=X.dem;!$||X.demTexture&&!X.needsDEMTextureUpload||(m.activeTexture.set(S.TEXTURE1),Ef(this.painter,X,$))}}_prepareDemTileUniforms(m,S,F,X){if(!S||S.demTexture==null)return!1;const $=m.tileID.canonical,ot=Math.pow(2,S.tileID.canonical.z-$.z),ct=X||"";return F[`u_dem_tl${ct}`]=[$.x*ot%1,$.y*ot%1],F[`u_dem_scale${ct}`]=ot,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const m=this.painter.context,S=m.gl;if(!this._emptyDepthBufferTexture){const F=new r.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.Texture(m,F,S.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let m=0;const S=this._visibleDemTiles.reduce((F,X)=>{if(!X.dem)return F;const $=X.dem.tree.minimums[0];return $>0&&m++,F+$},0);return m?S/m:0}_updateEmptyDEMTexture(){const m=this.painter.context,S=m.gl;m.activeTexture.set(S.TEXTURE2);const F=this._getLoadedAreaMinimum(),X=new r.RGBAImage({width:1,height:1},new Uint8Array(r.DEMData.pack(F,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let $=this._emptyDEMTexture;return $?$.update(X,{premultiply:!1}):$=this._emptyDEMTexture=new r.Texture(m,X,S.RGBA,{premultiply:!1}),$}setupElevationDraw(m,S,F){const X=this.painter.context,$=X.gl,ot=(ct=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:r.DEMData.getUnpackVector(ct),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var ct;ot.u_dem_size=this.sourceCache.getSource().tileSize,ot.u_exaggeration=this.exaggeration();const yt=this.painter.transform,xt=yt.projection,Mt=m.tileID.canonical;ot.u_tile_tl_up=xt.upVector(Mt,0,0),ot.u_tile_tr_up=xt.upVector(Mt,r.EXTENT,0),ot.u_tile_br_up=xt.upVector(Mt,r.EXTENT,r.EXTENT),ot.u_tile_bl_up=xt.upVector(Mt,0,r.EXTENT),ot.u_tile_up_scale=F&&F.useDenormalizedUpVectorScale?Ub:xt.upVectorScale(Mt,yt.center.lat,yt.worldSize).metersToTile;let Pt=null,Nt=null,Ht=1;if(F&&F.morphing&&this._useVertexMorphing){const Ut=F.morphing.srcDemTile,Bt=F.morphing.dstDemTile;Ht=F.morphing.phase,Ut&&Bt&&(this._prepareDemTileUniforms(m,Ut,ot,"_prev")&&(Nt=Ut),this._prepareDemTileUniforms(m,Bt,ot)&&(Pt=Bt))}if(Nt&&Pt?(X.activeTexture.set($.TEXTURE2),Pt.demTexture.bind($.NEAREST,$.CLAMP_TO_EDGE,$.NEAREST),X.activeTexture.set($.TEXTURE4),Nt.demTexture.bind($.NEAREST,$.CLAMP_TO_EDGE,$.NEAREST),ot.u_dem_lerp=Ht):(Pt=this.terrainTileForTile[m.tileID.key],X.activeTexture.set($.TEXTURE2),(this._prepareDemTileUniforms(m,Pt,ot)?Pt.demTexture:this.emptyDEMTexture).bind($.NEAREST,$.CLAMP_TO_EDGE)),X.activeTexture.set($.TEXTURE3),F&&F.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind($.NEAREST,$.CLAMP_TO_EDGE),this._depthFBO&&(ot.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind($.NEAREST,$.CLAMP_TO_EDGE),ot.u_depth_size_inv=[1,1]),F&&F.useMeterToDem&&Pt){const Ut=(1<<Pt.tileID.canonical.z)*r.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;ot.u_meter_to_dem=Ut}F&&F.labelPlaneMatrixInv&&(ot.u_label_plane_matrix_inv=F.labelPlaneMatrixInv),S.setTerrainUniformValues(X,ot)}renderToBackBuffer(m){const S=this.painter,F=this.painter.context;m.length!==0&&(F.bindFramebuffer.set(null),F.viewport.set([0,0,S.width,S.height]),this.renderingToTexture=!1,function(X,$,ot,ct,yt){if(X.transform.projection.name==="globe")(function(xt,Mt,Pt,Nt,Ht){const Ut=xt.context,Bt=Ut.gl;let ae,Jt;const ie=xt.options.showTerrainWireframe?2:0,se=(Ne,cn)=>{if(Jt===Ne)return;const Se=[cl[Ne],"PROJECTION_GLOBE_VIEW"];cn&&Se.push(cl[ie]),ae=xt.useProgram("globeRaster",null,Se),Jt=Ne},ce=xt.colorModeForRenderPass(),ne=new r.DepthMode(Bt.LEQUAL,r.DepthMode.ReadWrite,xt.depthRangeFor3D);Gs.update(Ht);const de=xt.transform,Ae=r.calculateGlobeMercatorMatrix(de),Re=[r.mercatorXfromLng(de.center.lng),r.mercatorYfromLat(de.center.lat)],je=xt.globeSharedBuffers;if((ie?[!1,!0]:[!1]).forEach(Ne=>{Jt=-1;const cn=Ne?Bt.LINES:Bt.TRIANGLES;for(const Se of Nt){const un=Pt.getTile(Se),rn=r.StencilMode.disabled,En=Mt.prevTerrainTileForTile[Se.key],He=Mt.terrainTileForTile[Se.key];uh(En,He)&&Gs.newMorphing(Se.key,En,He,Ht,250),Ut.activeTexture.set(Bt.TEXTURE0),un.texture.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE);const _n=Gs.getMorphValuesForProxy(Se.key),Fn=_n?1:0,Mn={useDenormalizedUpVectorScale:!0};_n&&r.extend$1(Mn,{morphing:{srcDemTile:_n.from,dstDemTile:_n.to,phase:r.easeCubicInOut(_n.phase)}});const An=Float32Array.from(de.globeMatrix),Vn=r.globeTileLatLngCorners(Se.canonical),ir=r.getGridMatrix(Se.canonical,Vn),Bn=e0(de.projMatrix,An,Ae,r.globeToMercatorTransition(de.zoom),Re,ir);if(se(Fn,Ne),Mt.setupElevationDraw(un,ae,Mn),xt.prepareDrawProgram(Ut,ae,Se.toUnwrapped()),je){const[Gn,gr,Vr]=Ne?je.getWirefameBuffers(xt.context):je.getGridBuffers();ae.draw(Ut,cn,ne,rn,ce,r.CullFaceMode.backCCW,Bn,"globe_raster",Gn,gr,Vr)}}}),je){ae=xt.useProgram("globeRaster",null,["GLOBE_POLES","PROJECTION_GLOBE_VIEW"]);for(const Ne of Nt){const{x:cn,y:Se,z:un}=Ne.canonical,rn=Se===0,En=Se===(1<<un)-1,[He,_n,Fn,Mn]=je.getPoleBuffers(un);if(Mn&&(rn||En)){const An=Pt.getTile(Ne);Ut.activeTexture.set(Bt.TEXTURE0),An.texture.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE);let Vn=r.globePoleMatrixForTile(un,cn,de);const ir=(Bn,Gn)=>Bn.draw(Ut,Bt.TRIANGLES,ne,r.StencilMode.disabled,ce,r.CullFaceMode.disabled,e0(de.projMatrix,Vn,Vn,0,Re),"globe_pole_raster",Gn,Fn,Mn);Mt.setupElevationDraw(An,ae,{}),xt.prepareDrawProgram(Ut,ae,Ne.toUnwrapped()),rn&&ir(ae,He),En&&(Vn=r.scale(r.create(),Vn,[1,-1,1]),ir(ae,_n))}}}})(X,$,ot,ct,yt);else{const xt=X.context,Mt=xt.gl;let Pt,Nt;const Ht=X.options.showTerrainWireframe?2:0,Ut=(se,ce)=>{if(Nt===se)return;const ne=[cl[se]];ce&&ne.push(cl[Ht]),Pt=X.useProgram("terrainRaster",null,ne),Nt=se},Bt=X.colorModeForRenderPass(),ae=new r.DepthMode(Mt.LEQUAL,r.DepthMode.ReadWrite,X.depthRangeFor3D);Gs.update(yt);const Jt=X.transform,ie=6*Math.pow(1.5,22-Jt.zoom)*$.exaggeration();(Ht?[!1,!0]:[!1]).forEach(se=>{Nt=-1;const ce=se?Mt.LINES:Mt.TRIANGLES,[ne,de]=se?$.getWirefameBuffer():[$.gridIndexBuffer,$.gridSegments];for(const Ae of ct){const Re=ot.getTile(Ae),je=r.StencilMode.disabled,Ne=$.prevTerrainTileForTile[Ae.key],cn=$.terrainTileForTile[Ae.key];uh(Ne,cn)&&Gs.newMorphing(Ae.key,Ne,cn,yt,250),xt.activeTexture.set(Mt.TEXTURE0),Re.texture.bind(Mt.LINEAR,Mt.CLAMP_TO_EDGE,Mt.LINEAR_MIPMAP_NEAREST);const Se=Gs.getMorphValuesForProxy(Ae.key),un=Se?1:0;let rn;Se&&(rn={morphing:{srcDemTile:Se.from,dstDemTile:Se.to,phase:r.easeCubicInOut(Se.phase)}});const En=t0(Ae.projMatrix,Pf(Ae.canonical,Jt.renderWorldCopies)?ie/10:ie);Ut(un,se),$.setupElevationDraw(Re,Pt,rn),X.prepareDrawProgram(xt,Pt,Ae.toUnwrapped()),Pt.draw(xt,ce,ae,je,Bt,r.CullFaceMode.backCCW,En,"terrain_raster",$.gridBuffer,ne,de)}})}}(S,this,this.proxySourceCache,m,this._updateTimestamp),this.renderingToTexture=!0,m.splice(0,m.length))}renderBatch(m){if(this._drapedRenderBatches.length===0)return m+1;this.renderingToTexture=!0;const S=this.painter,F=this.painter.context,X=this.proxySourceCache,$=this.proxiedCoords[X.id],ot=this._drapedRenderBatches.shift(),ct=[],yt=S.style.order;let xt=0;for(const Mt of $){const Pt=X.getTileByID(Mt.proxyTileKey),Nt=X.proxyCachedFBO[Mt.key]?X.proxyCachedFBO[Mt.key][m]:void 0,Ht=Nt!==void 0?X.renderCache[Nt]:this.pool[xt++],Ut=Nt!==void 0;if(Pt.texture=Ht.tex,Ut&&!Ht.dirty){ct.push(Pt.tileID);continue}let Bt;F.bindFramebuffer.set(Ht.fb.framebuffer),this.renderedToTile=!1,Ht.dirty&&(F.clear({color:r.Color.transparent,stencil:0}),Ht.dirty=!1);for(let ae=ot.start;ae<=ot.end;++ae){const Jt=S.style._layers[yt[ae]];if(Jt.isHidden(S.transform.zoom))continue;const ie=S.style._getLayerSourceCache(Jt),se=ie?this.proxyToSource[Mt.key][ie.id]:[Mt];if(!se)continue;const ce=se;F.viewport.set([0,0,Ht.fb.width,Ht.fb.height]),Bt!==(ie?ie.id:null)&&(this._setupStencil(Ht,se,Jt,ie),Bt=ie?ie.id:null),S.renderLayer(S,ie,Jt,ce)}this.renderedToTile?(Ht.dirty=!0,ct.push(Pt.tileID)):Ut||--xt,xt===5&&(xt=0,this.renderToBackBuffer(ct))}return this.renderToBackBuffer(ct),this.renderingToTexture=!1,F.bindFramebuffer.set(null),F.viewport.set([0,0,S.width,S.height]),ot.end+1}postRender(){}renderCacheEfficiency(m){const S=m.order.length;if(S===0)return{efficiency:100};let F,X=0,$=0,ot=!1;for(let ct=0;ct<S;++ct){const yt=m._layers[m.order[ct]];this._style.isLayerDraped(yt)?(ot&&++X,++$):ot||(ot=!0,F=yt.id)}return $===0?{efficiency:100}:{efficiency:100*(1-X/$),firstUndrapedLayer:F}}getMinElevationBelowMSL(){let m=0;return this._visibleDemTiles.filter(S=>S.dem).forEach(S=>{m=Math.min(m,S.dem.tree.minimums[0])}),m===0?m:(m-30)*this._exaggeration}raycast(m,S,F){if(!this._visibleDemTiles)return null;const X=this._visibleDemTiles.filter($=>$.dem).map($=>{const ot=$.tileID,ct=Math.pow(2,ot.overscaledZ),{x:yt,y:xt}=ot.canonical,Mt=yt/ct,Pt=(yt+1)/ct,Nt=xt/ct,Ht=(xt+1)/ct;return{minx:Mt,miny:Nt,maxx:Pt,maxy:Ht,t:$.dem.tree.raycastRoot(Mt,Nt,Pt,Ht,m,S,F),tile:$}});X.sort(($,ot)=>($.t!==null?$.t:Number.MAX_VALUE)-(ot.t!==null?ot.t:Number.MAX_VALUE));for(const $ of X){if($.t==null)return null;const ot=$.tile.dem.tree.raycast($.minx,$.miny,$.maxx,$.maxy,m,S,F);if(ot!=null)return ot}return null}_createFBO(){const m=this.painter.context,S=m.gl,F=this.drapeBufferSize;m.activeTexture.set(S.TEXTURE0);const X=new r.Texture(m,{width:F[0],height:F[1],data:null},S.RGBA);X.bind(S.LINEAR,S.CLAMP_TO_EDGE);const $=m.createFramebuffer(F[0],F[1],!1);return $.colorAttachment.set(X.texture),$.depthAttachment=new Qn(m,$.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=m.createRenderbuffer(m.gl.DEPTH_STENCIL,F[0],F[1]),this._stencilRef=0,$.depthAttachment.set(this._sharedDepthStencil),m.clear({stencil:0})):$.depthAttachment.set(this._sharedDepthStencil),m.extTextureFilterAnisotropic&&!m.extTextureFilterAnisotropicForceOff&&S.texParameterf(S.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax),{fb:$,tex:X,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m].hasTransition())return!0;return this._style.order.some(m=>{const S=this._style._layers[m],F=S.isHidden(this.painter.transform.zoom),X=S.getCrossfadeParameters(),$=!!X&&X.t!==1,ot=S.hasTransition();return S.type!=="custom"&&!F&&($||ot)})}_clearRasterFadeFromRenderCache(){let m=!1;for(const S in this._style._sourceCaches)if(this._style._sourceCaches[S]._source instanceof Rt){m=!0;break}if(m)for(let S=0;S<this._style.order.length;++S){const F=this._style._layers[this._style.order[S]],X=F.isHidden(this.painter.transform.zoom),$=this._style._getLayerSourceCache(F);if(F.type!=="raster"||X||!$)continue;const ot=F.paint.get("raster-fade-duration");for(const ct of this.proxyCoords){const yt=this.proxyToSource[ct.key][$.id];if(yt)for(const xt of yt){const Mt=Df($.getTile(xt),$.findLoadedParent(xt,0),$,this.painter.transform,ot);(Mt.opacity!==1||Mt.mix!==0)&&this._clearRenderCacheForTile($.id,xt)}}}}_setupDrapedRenderBatches(){const m=this._style.order,S=m.length;if(S===0)return;const F=[];let X,$=0,ot=this._style._layers[m[$]];for(;!this._style.isLayerDraped(ot)&&ot.isHidden(this.painter.transform.zoom)&&++$<S;)ot=this._style._layers[m[$]];for(;$<S;++$){const ct=this._style._layers[m[$]];ct.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(ct)?X===void 0&&(X=$):X!==void 0&&(F.push({start:X,end:$-1}),X=void 0))}X!==void 0&&F.push({start:X,end:$-1}),this._drapedRenderBatches=F}_setupRenderCache(m){const S=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,S.renderCache.length>S.renderCachePool.length){const ot=Object.values(S.proxyCachedFBO);S.proxyCachedFBO={};for(let ct=0;ct<ot.length;++ct){const yt=Object.values(ot[ct]);S.renderCachePool.push(...yt)}}return}this._clearRasterFadeFromRenderCache();const F=this.proxyCoords,X=this._tilesDirty;for(let ot=F.length-1;ot>=0;ot--){const ct=F[ot];if(S.getTileByID(ct.key),S.proxyCachedFBO[ct.key]!==void 0){const yt=m[ct.key],xt=this.proxyToSource[ct.key];let Mt=0;for(const Pt in xt){const Nt=xt[Pt],Ht=yt[Pt];if(!Ht||Ht.length!==Nt.length||Nt.some((Ut,Bt)=>Ut!==Ht[Bt]||X[Pt]&&X[Pt].hasOwnProperty(Ut.key))){Mt=-1;break}++Mt}for(const Pt in S.proxyCachedFBO[ct.key])S.renderCache[S.proxyCachedFBO[ct.key][Pt]].dirty=Mt<0||Mt!==Object.values(yt).length}}const $=[...this._drapedRenderBatches];$.sort((ot,ct)=>ct.end-ct.start-(ot.end-ot.start));for(const ot of $)for(const ct of F){if(S.proxyCachedFBO[ct.key])continue;let yt=S.renderCachePool.pop();yt===void 0&&S.renderCache.length<50&&(yt=S.renderCache.length,S.renderCache.push(this._createFBO())),yt!==void 0&&(S.proxyCachedFBO[ct.key]={},S.proxyCachedFBO[ct.key][ot.start]=yt,S.renderCache[yt].dirty=!0)}this._tilesDirty={}}_setupStencil(m,S,F,X){if(!X||!this._sourceTilesOverlap[X.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const $=this.painter.context,ot=$.gl;if(S.length<=1)return void(this._overlapStencilType=!1);let ct;if(F.isTileClipped())ct=S.length,this._overlapStencilMode.test={func:ot.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(S[0].overscaledZ>S[S.length-1].overscaledZ))return void(this._overlapStencilType=!1);ct=1,this._overlapStencilMode.test={func:ot.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+ct>255&&($.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=ct,this._overlapStencilMode.ref=this._stencilRef,F.isTileClipped()&&this._renderTileClippingMasks(S,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(m){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs.get(m.key)||0),this._overlapStencilMode):r.StencilMode.disabled}_renderTileClippingMasks(m,S){const F=this.painter,X=this.painter.context,$=X.gl;F._tileClippingMaskIDs.clear(),X.setColorMode(r.ColorMode.disabled),X.setDepthMode(r.DepthMode.disabled);const ot=F.useProgram("clippingMask");for(const ct of m){const yt=--S;F._tileClippingMaskIDs.set(ct.key,yt),ot.draw(X,$.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:$.ALWAYS,mask:0},yt,255,$.KEEP,$.KEEP,$.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,hh(ct.projMatrix),"$clipping",F.tileExtentBuffer,F.quadTriangleIndexBuffer,F.tileExtentSegments)}}pointCoordinate(m){const S=this.painter.transform;if(m.x<0||m.x>S.width||m.y<0||m.y>S.height)return null;const F=[m.x,m.y,1,1];r.transformMat4$1(F,F,S.pixelMatrixInverse),r.scale$1(F,F,1/F[3]),F[0]/=S.worldSize,F[1]/=S.worldSize;const X=S._camera.position,$=r.mercatorZfromAltitude(1,S.center.lat),ot=[X[0],X[1],X[2]/$,0],ct=r.subtract([],F.slice(0,3),ot);r.normalize(ct,ct);const yt=this.raycast(ot,ct,this._exaggeration);return yt!==null&&yt?(r.scaleAndAdd(ot,ot,ct,yt),ot[3]=ot[2],ot[2]*=$,ot):null}drawDepth(){const m=this.painter,S=m.context,F=this.proxySourceCache,X=Math.ceil(m.width),$=Math.ceil(m.height);if(!this._depthFBO||this._depthFBO.width===X&&this._depthFBO.height===$||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const ot=S.gl,ct=S.createFramebuffer(X,$,!0);S.activeTexture.set(ot.TEXTURE0);const yt=new r.Texture(S,{width:X,height:$,data:null},ot.RGBA);yt.bind(ot.NEAREST,ot.CLAMP_TO_EDGE),ct.colorAttachment.set(yt.texture);const xt=S.createRenderbuffer(S.gl.DEPTH_COMPONENT16,X,$);ct.depthAttachment.set(xt),this._depthFBO=ct,this._depthTexture=yt}S.bindFramebuffer.set(this._depthFBO.framebuffer),S.viewport.set([0,0,X,$]),function(ot,ct,yt,xt){if(ot.transform.projection.name==="globe")return;const Mt=ot.context,Pt=Mt.gl;Mt.clear({depth:1});const Nt=ot.useProgram("terrainDepth"),Ht=new r.DepthMode(Pt.LESS,r.DepthMode.ReadWrite,ot.depthRangeFor3D);for(const Ut of xt){const Bt=yt.getTile(Ut),ae=t0(Ut.projMatrix,0);ct.setupElevationDraw(Bt,Nt),Nt.draw(Mt,Pt.TRIANGLES,Ht,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.backCCW,ae,"terrain_depth",ct.gridBuffer,ct.gridIndexBuffer,ct.gridNoSkirtSegments)}}(m,this,F,this.proxyCoords)}_setupProxiedCoordsForOrtho(m,S,F){if(m.getSource()instanceof It)return this._setupProxiedCoordsForImageSource(m,S,F);this._findCoveringTileCache[m.id]=this._findCoveringTileCache[m.id]||{};const X=this.proxiedCoords[m.id]=[],$=this.proxyCoords;for(let ct=0;ct<$.length;ct++){const yt=$[ct],xt=this._findTileCoveringTileID(yt,m);if(xt){const Mt=this._createProxiedId(yt,xt,F[yt.key]&&F[yt.key][m.id]);X.push(Mt),this.proxyToSource[yt.key][m.id]=[Mt]}}let ot=!1;for(let ct=0;ct<S.length;ct++){const yt=m.getTile(S[ct]);if(!yt||!yt.hasData())continue;const xt=this._findTileCoveringTileID(yt.tileID,this.proxySourceCache);if(xt&&xt.tileID.canonical.z!==yt.tileID.canonical.z){const Mt=this.proxyToSource[xt.tileID.key][m.id],Pt=this._createProxiedId(xt.tileID,yt,F[xt.tileID.key]&&F[xt.tileID.key][m.id]);Mt?Mt.splice(Mt.length-1,0,Pt):this.proxyToSource[xt.tileID.key][m.id]=[Pt],X.push(Pt),ot=!0}}this._sourceTilesOverlap[m.id]=ot}_setupProxiedCoordsForImageSource(m,S,F){if(!m.getSource().loaded())return;const X=this.proxiedCoords[m.id]=[],$=this.proxyCoords,ot=m.getSource(),ct=new r.pointGeometry(ot.tileID.x,ot.tileID.y)._div(1<<ot.tileID.z),yt=ot.coordinates.map(r.MercatorCoordinate.fromLngLat).reduce((Mt,Pt)=>(Mt.min.x=Math.min(Mt.min.x,Pt.x-ct.x),Mt.min.y=Math.min(Mt.min.y,Pt.y-ct.y),Mt.max.x=Math.max(Mt.max.x,Pt.x-ct.x),Mt.max.y=Math.max(Mt.max.y,Pt.y-ct.y),Mt),{min:new r.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),xt=(Mt,Pt)=>{const Nt=Mt.wrap+Mt.canonical.x/(1<<Mt.canonical.z),Ht=Mt.canonical.y/(1<<Mt.canonical.z),Ut=r.EXTENT/(1<<Mt.canonical.z),Bt=Pt.wrap+Pt.canonical.x/(1<<Pt.canonical.z),ae=Pt.canonical.y/(1<<Pt.canonical.z);return Nt+Ut<Bt+yt.min.x||Nt>Bt+yt.max.x||Ht+Ut<ae+yt.min.y||Ht>ae+yt.max.y};for(let Mt=0;Mt<$.length;Mt++){const Pt=$[Mt];for(let Nt=0;Nt<S.length;Nt++){const Ht=m.getTile(S[Nt]);if(!Ht||!Ht.hasData()||xt(Pt,Ht.tileID))continue;const Ut=this._createProxiedId(Pt,Ht,F[Pt.key]&&F[Pt.key][m.id]),Bt=this.proxyToSource[Pt.key][m.id];Bt?Bt.push(Ut):this.proxyToSource[Pt.key][m.id]=[Ut],X.push(Ut)}}}_createProxiedId(m,S,F){let X=this.orthoMatrix;if(F){const $=F.find(ot=>ot.key===S.tileID.key);if($)return $}if(S.tileID.key!==m.key){const $=m.canonical.z-S.tileID.canonical.z;let ot,ct,yt;X=r.create();const xt=S.tileID.wrap-m.wrap<<m.overscaledZ;$>0?(ot=r.EXTENT>>$,ct=ot*((S.tileID.canonical.x<<$)-m.canonical.x+xt),yt=ot*((S.tileID.canonical.y<<$)-m.canonical.y)):(ot=r.EXTENT<<-$,ct=r.EXTENT*(S.tileID.canonical.x-(m.canonical.x+xt<<-$)),yt=r.EXTENT*(S.tileID.canonical.y-(m.canonical.y<<-$))),r.ortho(X,0,ot,0,ot,0,1),r.translate(X,X,[ct,yt,0])}return new Rf(S.tileID,m.key,X)}_findTileCoveringTileID(m,S){let F=S.getTile(m);if(F&&F.hasData())return F;const X=this._findCoveringTileCache[S.id],$=X[m.key];if(F=$?S.getTileByID($):null,F&&F.hasData()||$===null)return F;let ot=F?F.tileID:m,ct=ot.overscaledZ;const yt=S.getSource().minzoom,xt=[];if(!$){const Pt=S.getSource().maxzoom;if(m.canonical.z>=Pt){const Nt=m.canonical.z-Pt;S.getSource().reparseOverscaled?(ct=Math.max(m.canonical.z+2,S.transform.tileZoom),ot=new r.OverscaledTileID(ct,m.wrap,Pt,m.canonical.x>>Nt,m.canonical.y>>Nt)):Nt!==0&&(ct=Pt,ot=new r.OverscaledTileID(ct,m.wrap,Pt,m.canonical.x>>Nt,m.canonical.y>>Nt))}ot.key!==m.key&&(xt.push(ot.key),F=S.getTile(ot))}const Mt=Pt=>{xt.forEach(Nt=>{X[Nt]=Pt}),xt.length=0};for(ct-=1;ct>=yt&&(!F||!F.hasData());ct--){F&&Mt(F.tileID.key);const Pt=ot.calculateScaledKey(ct);if(F=S.getTileByID(Pt),F&&F.hasData())break;const Nt=X[Pt];if(Nt===null)break;Nt===void 0?xt.push(Pt):F=S.getTileByID(Nt)}return Mt(F?F.tileID.key:null),F&&F.hasData()?F:null}findDEMTileFor(m){return this.enabled?this._findTileCoveringTileID(m,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(m,S){let F=this._tilesDirty[m];F||(F=this._tilesDirty[m]={}),F[S.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const m=function(S){let F=0;const X=new r.StructArrayLayout2ui4,$=131;for(let ot=1;ot<129;ot++){for(let ct=1;ct<129;ct++)F=ot*$+ct,X.emplaceBack(F,F+1),X.emplaceBack(F,F+$),X.emplaceBack(F+1,F+$),ot===128&&X.emplaceBack(F+$,F+$+1);X.emplaceBack(F+1,F+1+$)}return X}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(m),this.wireframeSegments=r.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,m.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function dh(P){const m=[];for(let S=0;S<P.length;S++){if(P[S]===null)continue;const F=P[S].split(" ");m.push(F.pop())}return m}class vc{static cacheKey(m,S,F){let X=`${m}${F?F.cacheKey:""}`;for(const $ of S)X+=`/${$}`;return X}constructor(m,S,F,X,$,ot){const ct=m.gl;this.program=ct.createProgram();const yt=dh(F.staticAttributes),xt=X?X.getBinderAttributes():[],Mt=yt.concat(xt),Pt=F.staticUniforms?dh(F.staticUniforms):[],Nt=X?X.getBinderUniforms():[],Ht=Pt.concat(Nt),Ut=[];for(const ne of Ht)Ut.indexOf(ne)<0&&Ut.push(ne);let Bt=X?X.defines():[];Bt=Bt.concat(ot.map(ne=>`#define ${ne}`));const ae=Bt.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,mc,lh.fragmentSource,js.fragmentSource,F.fragmentSource).join(`
`),Jt=Bt.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,mc,lh.vertexSource,js.vertexSource,Sa.vertexSource,F.vertexSource).join(`
`),ie=ct.createShader(ct.FRAGMENT_SHADER);if(ct.isContextLost())return void(this.failedToCreate=!0);ct.shaderSource(ie,ae),ct.compileShader(ie),ct.attachShader(this.program,ie);const se=ct.createShader(ct.VERTEX_SHADER);if(ct.isContextLost())return void(this.failedToCreate=!0);ct.shaderSource(se,Jt),ct.compileShader(se),ct.attachShader(this.program,se),this.attributes={};const ce={};this.numAttributes=Mt.length;for(let ne=0;ne<this.numAttributes;ne++)Mt[ne]&&(ct.bindAttribLocation(this.program,ne,Mt[ne]),this.attributes[Mt[ne]]=ne);ct.linkProgram(this.program),ct.deleteShader(se),ct.deleteShader(ie);for(let ne=0;ne<Ut.length;ne++){const de=Ut[ne];if(de&&!ce[de]){const Ae=ct.getUniformLocation(this.program,de);Ae&&(ce[de]=Ae)}}this.fixedUniforms=$(m,ce),this.binderUniforms=X?X.getUniforms(m,ce):[],ot.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((ne,de)=>({u_dem:new r.Uniform1i(ne,de.u_dem),u_dem_prev:new r.Uniform1i(ne,de.u_dem_prev),u_dem_unpack:new r.Uniform4f(ne,de.u_dem_unpack),u_dem_tl:new r.Uniform2f(ne,de.u_dem_tl),u_dem_scale:new r.Uniform1f(ne,de.u_dem_scale),u_dem_tl_prev:new r.Uniform2f(ne,de.u_dem_tl_prev),u_dem_scale_prev:new r.Uniform1f(ne,de.u_dem_scale_prev),u_dem_size:new r.Uniform1f(ne,de.u_dem_size),u_dem_lerp:new r.Uniform1f(ne,de.u_dem_lerp),u_exaggeration:new r.Uniform1f(ne,de.u_exaggeration),u_depth:new r.Uniform1i(ne,de.u_depth),u_depth_size_inv:new r.Uniform2f(ne,de.u_depth_size_inv),u_meter_to_dem:new r.Uniform1f(ne,de.u_meter_to_dem),u_label_plane_matrix_inv:new r.UniformMatrix4f(ne,de.u_label_plane_matrix_inv),u_tile_tl_up:new r.Uniform3f(ne,de.u_tile_tl_up),u_tile_tr_up:new r.Uniform3f(ne,de.u_tile_tr_up),u_tile_br_up:new r.Uniform3f(ne,de.u_tile_br_up),u_tile_bl_up:new r.Uniform3f(ne,de.u_tile_bl_up),u_tile_up_scale:new r.Uniform1f(ne,de.u_tile_up_scale)}))(m,ce)),ot.indexOf("FOG")!==-1&&(this.fogUniforms=((ne,de)=>({u_fog_matrix:new r.UniformMatrix4f(ne,de.u_fog_matrix),u_fog_range:new r.Uniform2f(ne,de.u_fog_range),u_fog_color:new r.Uniform4f(ne,de.u_fog_color),u_fog_horizon_blend:new r.Uniform1f(ne,de.u_fog_horizon_blend),u_fog_temporal_offset:new r.Uniform1f(ne,de.u_fog_temporal_offset)}))(m,ce))}setTerrainUniformValues(m,S){if(!this.terrainUniforms)return;const F=this.terrainUniforms;if(!this.failedToCreate){m.program.set(this.program);for(const X in S)F[X].set(S[X])}}setFogUniformValues(m,S){if(!this.fogUniforms)return;const F=this.fogUniforms;if(!this.failedToCreate){m.program.set(this.program);for(const X in S)F[X].location&&F[X].set(S[X])}}draw(m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut,Bt,ae){const Jt=m.gl;if(this.failedToCreate)return;m.program.set(this.program),m.setDepthMode(F),m.setStencilMode(X),m.setColorMode($),m.setCullFace(ot);for(const se of Object.keys(this.fixedUniforms))this.fixedUniforms[se].set(ct[se]);Ut&&Ut.setUniforms(m,this.binderUniforms,Nt,{zoom:Ht});const ie={[Jt.LINES]:2,[Jt.TRIANGLES]:3,[Jt.LINE_STRIP]:1}[S];for(const se of Pt.get()){const ce=se.vaos||(se.vaos={});(ce[yt]||(ce[yt]=new ch)).bind(m,this,xt,Ut?Ut.getPaintVertexBuffers():[],Mt,se.vertexOffset,Bt,ae),Jt.drawElements(S,se.primitiveLength*ie,Jt.UNSIGNED_SHORT,se.primitiveOffset*ie*2)}}}function xc(P,m,S){const F=1/ut(S,1,m.transform.tileZoom),X=Math.pow(2,S.tileID.overscaledZ),$=S.tileSize*Math.pow(2,m.transform.tileZoom)/X,ot=$*(S.tileID.canonical.x+S.tileID.wrap*X),ct=$*S.tileID.canonical.y;return{u_image:0,u_texsize:S.imageAtlasTexture.size,u_scale:[F,P.fromScale,P.toScale],u_fade:P.t,u_pixel_coord_upper:[ot>>16,ct>>16],u_pixel_coord_lower:[65535&ot,65535&ct]}}const kf=r.create(),fh=(P,m,S,F,X,$,ot,ct,yt)=>{const xt=m.style.light,Mt=xt.properties.get("position"),Pt=[Mt.x,Mt.y,Mt.z],Nt=r.create$1();xt.properties.get("anchor")==="viewport"&&(r.fromRotation(Nt,-m.transform.angle),r.transformMat3(Pt,Pt,Nt));const Ht=xt.properties.get("color"),Ut=m.transform,Bt={u_matrix:P,u_lightpos:Pt,u_lightintensity:xt.properties.get("intensity"),u_lightcolor:[Ht.r,Ht.g,Ht.b],u_vertical_gradient:+S,u_opacity:F,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:kf,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return Ut.projection.name==="globe"&&(Bt.u_tile_id=[X.canonical.x,X.canonical.y,1<<X.canonical.z],Bt.u_zoom_transition=ot,Bt.u_inv_rot_matrix=yt,Bt.u_merc_center=ct,Bt.u_up_dir=Ut.projection.upVector(new r.CanonicalTileID(0,0,0),ct[0]*r.EXTENT,ct[1]*r.EXTENT),Bt.u_height_lift=$),Bt},ph=(P,m,S,F,X,$,ot,ct,yt,xt,Mt)=>{const Pt=fh(P,m,S,F,X,ct,yt,xt,Mt),Nt={u_height_factor:-Math.pow(2,X.overscaledZ)/ot.tileSize/8};return r.extend(Pt,xc($,m,ot),Nt)},mh=P=>({u_matrix:P}),gh=(P,m,S,F)=>r.extend(mh(P),xc(S,m,F)),yh=(P,m)=>({u_matrix:P,u_world:m}),n0=(P,m,S,F,X)=>r.extend(gh(P,m,S,F),{u_world:X}),r0=r.create(),ul=(P,m,S,F,X,$)=>{const ot=P.transform,ct=ot.projection.name==="globe";let yt;if($.paint.get("circle-pitch-alignment")==="map")if(ct){const Mt=r.globePixelsToTileUnits(ot.zoom,m.canonical);yt=Float32Array.from([Mt,0,0,Mt])}else yt=ot.calculatePixelsToTileUnitsMatrix(S);else yt=new Float32Array([ot.pixelsToGLUnits[0],0,0,ot.pixelsToGLUnits[1]]);const xt={u_camera_to_center_distance:ot.cameraToCenterDistance,u_matrix:P.translatePosMatrix(m.projMatrix,S,$.paint.get("circle-translate"),$.paint.get("circle-translate-anchor")),u_device_pixel_ratio:r.exported.devicePixelRatio,u_extrude_scale:yt,u_inv_rot_matrix:r0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return ct&&(xt.u_inv_rot_matrix=F,xt.u_merc_center=X,xt.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],xt.u_zoom_transition=r.globeToMercatorTransition(ot.zoom),xt.u_up_dir=ot.projection.upVector(m.canonical,X[0],X[1])),xt},Vb=P=>{const m=[];return P.paint.get("circle-pitch-alignment")==="map"&&m.push("PITCH_WITH_MAP"),P.paint.get("circle-pitch-scale")==="map"&&m.push("SCALE_WITH_MAP"),m},jb=(P,m,S)=>{const F=r.EXTENT/S.tileSize;return{u_matrix:P,u_camera_to_center_distance:m.cameraToCenterDistance,u_extrude_scale:[m.pixelsToGLUnits[0]/F,m.pixelsToGLUnits[1]/F]}},i0=(P,m,S=1)=>({u_matrix:P,u_color:m,u_overlay:0,u_overlay_scale:S}),Gb=r.create(),Hb=(P,m,S,F,X,$,ot)=>{const ct=P.transform,yt=ct.projection.name==="globe",xt=yt?r.globePixelsToTileUnits(ct.zoom,m.canonical):ut(S,1,$),Mt={u_matrix:m.projMatrix,u_extrude_scale:xt,u_intensity:ot,u_inv_rot_matrix:Gb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return yt&&(Mt.u_inv_rot_matrix=F,Mt.u_merc_center=X,Mt.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],Mt.u_zoom_transition=r.globeToMercatorTransition(ct.zoom),Mt.u_up_dir=ct.projection.upVector(m.canonical,X[0],X[1])),Mt},Wb=(P,m,S,F,X,$,ot)=>{const ct=P.transform,yt=ct.calculatePixelsToTileUnitsMatrix(m),xt={u_matrix:Ea(P,m,S,X),u_pixels_to_tile_units:yt,u_device_pixel_ratio:ot,u_units_to_pixels:[1/ct.pixelsToGLUnits[0],1/ct.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:$,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(Lf(S)){const Mt=bh(m,P.transform);xt.u_texsize=m.lineAtlasTexture.size,xt.u_scale=[Mt,F.fromScale,F.toScale],xt.u_mix=F.t}return xt},If=(P,m,S,F,X,$)=>{const ot=P.transform,ct=bh(m,ot);return{u_matrix:Ea(P,m,S,X),u_texsize:m.imageAtlasTexture.size,u_pixels_to_tile_units:ot.calculatePixelsToTileUnitsMatrix(m),u_device_pixel_ratio:$,u_image:0,u_scale:[ct,F.fromScale,F.toScale],u_fade:F.t,u_units_to_pixels:[1/ot.pixelsToGLUnits[0],1/ot.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function bh(P,m){return 1/ut(P,1,m.tileZoom)}function Ea(P,m,S,F){return P.translatePosMatrix(F||m.tileID.projMatrix,m,S.paint.get("line-translate"),S.paint.get("line-translate-anchor"))}function Lf(P){const m=P.paint.get("line-dasharray").value;return m.value||m.kind!=="constant"}const o0=(P,m,S,F,X,$)=>{return{u_matrix:P,u_tl_parent:m,u_scale_parent:S,u_fade_t:F.mix,u_opacity:F.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:(ct=X.paint.get("raster-saturation"),ct>0?1-1/(1.001-ct):-ct),u_contrast_factor:(ot=X.paint.get("raster-contrast"),ot>0?1/(1-ot):1+ot),u_spin_weights:Bf(X.paint.get("raster-hue-rotate")),u_perspective_transform:$};var ot,ct};function Bf(P){P*=Math.PI/180;const m=Math.sin(P),S=Math.cos(P);return[(2*S+1)/3,(-Math.sqrt(3)*m-S+1)/3,(Math.sqrt(3)*m-S+1)/3]}const Hs=r.create(),Ff=(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht)=>{const Ut=X.transform,Bt={u_is_size_zoom_constant:+(P==="constant"||P==="source"),u_is_size_feature_constant:+(P==="constant"||P==="camera"),u_size_t:m?m.uSizeT:0,u_size:m?m.uSize:0,u_camera_to_center_distance:Ut.cameraToCenterDistance,u_rotate_symbol:+S,u_aspect_ratio:Ut.width/Ut.height,u_fade_change:X.options.fadeDuration?X.symbolFadeChange:1,u_matrix:$,u_label_plane_matrix:ot,u_coord_matrix:ct,u_is_text:+yt,u_pitch_with_map:+F,u_texsize:xt,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Hs,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Hs};return Ut.projection.name==="globe"&&(Bt.u_tile_id=[Mt.canonical.x,Mt.canonical.y,1<<Mt.canonical.z],Bt.u_zoom_transition=Pt,Bt.u_inv_rot_matrix=Ht,Bt.u_merc_center=Nt,Bt.u_camera_forward=Ut._camera.forward(),Bt.u_ecef_origin=r.globeECEFOrigin(Ut.globeMatrix,Mt.toUnwrapped()),Bt.u_tile_matrix=Float32Array.from(Ut.globeMatrix)),Bt},Ta=(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht,Ut)=>{const{cameraToCenterDistance:Bt,_pitch:ae}=X.transform;return r.extend(Ff(P,m,S,F,X,$,ot,ct,yt,xt,Pt,Nt,Ht,Ut),{u_gamma_scale:F?Bt*Math.cos(X.terrain?0:ae):1,u_device_pixel_ratio:r.exported.devicePixelRatio,u_is_halo:+Mt})},hl=(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt,Nt,Ht)=>r.extend(Ta(P,m,S,F,X,$,ot,ct,!0,yt,!0,Mt,Pt,Nt,Ht),{u_texsize_icon:xt,u_texture_icon:1}),s0=(P,m,S)=>({u_matrix:P,u_opacity:m,u_color:S}),Nf=(P,m,S,F,X,$)=>r.extend(function(ot,ct,yt,xt){const Mt=yt.imageManager.getPattern(ot.from.toString()),Pt=yt.imageManager.getPattern(ot.to.toString()),{width:Nt,height:Ht}=yt.imageManager.getPixelSize(),Ut=Math.pow(2,xt.tileID.overscaledZ),Bt=xt.tileSize*Math.pow(2,yt.transform.tileZoom)/Ut,ae=Bt*(xt.tileID.canonical.x+xt.tileID.wrap*Ut),Jt=Bt*xt.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Mt.tl,u_pattern_br_a:Mt.br,u_pattern_tl_b:Pt.tl,u_pattern_br_b:Pt.br,u_texsize:[Nt,Ht],u_mix:ct.t,u_pattern_size_a:Mt.displaySize,u_pattern_size_b:Pt.displaySize,u_scale_a:ct.fromScale,u_scale_b:ct.toScale,u_tile_units_to_pixels:1/ut(xt,1,yt.transform.tileZoom),u_pixel_coord_upper:[ae>>16,Jt>>16],u_pixel_coord_lower:[65535&ae,65535&Jt]}}(F,$,S,X),{u_matrix:P,u_opacity:m}),Mr={fillExtrusion:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_lightpos:new r.Uniform3f(P,m.u_lightpos),u_lightintensity:new r.Uniform1f(P,m.u_lightintensity),u_lightcolor:new r.Uniform3f(P,m.u_lightcolor),u_vertical_gradient:new r.Uniform1f(P,m.u_vertical_gradient),u_opacity:new r.Uniform1f(P,m.u_opacity),u_tile_id:new r.Uniform3f(P,m.u_tile_id),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(P,m.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_up_dir:new r.Uniform3f(P,m.u_up_dir),u_height_lift:new r.Uniform1f(P,m.u_height_lift)}),fillExtrusionPattern:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_lightpos:new r.Uniform3f(P,m.u_lightpos),u_lightintensity:new r.Uniform1f(P,m.u_lightintensity),u_lightcolor:new r.Uniform3f(P,m.u_lightcolor),u_vertical_gradient:new r.Uniform1f(P,m.u_vertical_gradient),u_height_factor:new r.Uniform1f(P,m.u_height_factor),u_tile_id:new r.Uniform3f(P,m.u_tile_id),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(P,m.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_up_dir:new r.Uniform3f(P,m.u_up_dir),u_height_lift:new r.Uniform1f(P,m.u_height_lift),u_image:new r.Uniform1i(P,m.u_image),u_texsize:new r.Uniform2f(P,m.u_texsize),u_pixel_coord_upper:new r.Uniform2f(P,m.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(P,m.u_pixel_coord_lower),u_scale:new r.Uniform3f(P,m.u_scale),u_fade:new r.Uniform1f(P,m.u_fade),u_opacity:new r.Uniform1f(P,m.u_opacity)}),fill:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix)}),fillPattern:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_image:new r.Uniform1i(P,m.u_image),u_texsize:new r.Uniform2f(P,m.u_texsize),u_pixel_coord_upper:new r.Uniform2f(P,m.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(P,m.u_pixel_coord_lower),u_scale:new r.Uniform3f(P,m.u_scale),u_fade:new r.Uniform1f(P,m.u_fade)}),fillOutline:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_world:new r.Uniform2f(P,m.u_world)}),fillOutlinePattern:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_world:new r.Uniform2f(P,m.u_world),u_image:new r.Uniform1i(P,m.u_image),u_texsize:new r.Uniform2f(P,m.u_texsize),u_pixel_coord_upper:new r.Uniform2f(P,m.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(P,m.u_pixel_coord_lower),u_scale:new r.Uniform3f(P,m.u_scale),u_fade:new r.Uniform1f(P,m.u_fade)}),circle:(P,m)=>({u_camera_to_center_distance:new r.Uniform1f(P,m.u_camera_to_center_distance),u_extrude_scale:new r.UniformMatrix2f(P,m.u_extrude_scale),u_device_pixel_ratio:new r.Uniform1f(P,m.u_device_pixel_ratio),u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_inv_rot_matrix:new r.UniformMatrix4f(P,m.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_tile_id:new r.Uniform3f(P,m.u_tile_id),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_up_dir:new r.Uniform3f(P,m.u_up_dir)}),collisionBox:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_camera_to_center_distance:new r.Uniform1f(P,m.u_camera_to_center_distance),u_extrude_scale:new r.Uniform2f(P,m.u_extrude_scale)}),collisionCircle:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_inv_matrix:new r.UniformMatrix4f(P,m.u_inv_matrix),u_camera_to_center_distance:new r.Uniform1f(P,m.u_camera_to_center_distance),u_viewport_size:new r.Uniform2f(P,m.u_viewport_size)}),debug:(P,m)=>({u_color:new r.UniformColor(P,m.u_color),u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_overlay:new r.Uniform1i(P,m.u_overlay),u_overlay_scale:new r.Uniform1f(P,m.u_overlay_scale)}),clippingMask:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix)}),heatmap:(P,m)=>({u_extrude_scale:new r.Uniform1f(P,m.u_extrude_scale),u_intensity:new r.Uniform1f(P,m.u_intensity),u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_inv_rot_matrix:new r.UniformMatrix4f(P,m.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_tile_id:new r.Uniform3f(P,m.u_tile_id),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_up_dir:new r.Uniform3f(P,m.u_up_dir)}),heatmapTexture:(P,m)=>({u_image:new r.Uniform1i(P,m.u_image),u_color_ramp:new r.Uniform1i(P,m.u_color_ramp),u_opacity:new r.Uniform1f(P,m.u_opacity)}),hillshade:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_image:new r.Uniform1i(P,m.u_image),u_latrange:new r.Uniform2f(P,m.u_latrange),u_light:new r.Uniform2f(P,m.u_light),u_shadow:new r.UniformColor(P,m.u_shadow),u_highlight:new r.UniformColor(P,m.u_highlight),u_accent:new r.UniformColor(P,m.u_accent)}),hillshadePrepare:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_image:new r.Uniform1i(P,m.u_image),u_dimension:new r.Uniform2f(P,m.u_dimension),u_zoom:new r.Uniform1f(P,m.u_zoom),u_unpack:new r.Uniform4f(P,m.u_unpack)}),line:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_pixels_to_tile_units:new r.UniformMatrix2f(P,m.u_pixels_to_tile_units),u_device_pixel_ratio:new r.Uniform1f(P,m.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(P,m.u_units_to_pixels),u_dash_image:new r.Uniform1i(P,m.u_dash_image),u_gradient_image:new r.Uniform1i(P,m.u_gradient_image),u_image_height:new r.Uniform1f(P,m.u_image_height),u_texsize:new r.Uniform2f(P,m.u_texsize),u_scale:new r.Uniform3f(P,m.u_scale),u_mix:new r.Uniform1f(P,m.u_mix),u_alpha_discard_threshold:new r.Uniform1f(P,m.u_alpha_discard_threshold)}),linePattern:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_texsize:new r.Uniform2f(P,m.u_texsize),u_pixels_to_tile_units:new r.UniformMatrix2f(P,m.u_pixels_to_tile_units),u_device_pixel_ratio:new r.Uniform1f(P,m.u_device_pixel_ratio),u_image:new r.Uniform1i(P,m.u_image),u_units_to_pixels:new r.Uniform2f(P,m.u_units_to_pixels),u_scale:new r.Uniform3f(P,m.u_scale),u_fade:new r.Uniform1f(P,m.u_fade),u_alpha_discard_threshold:new r.Uniform1f(P,m.u_alpha_discard_threshold)}),raster:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_tl_parent:new r.Uniform2f(P,m.u_tl_parent),u_scale_parent:new r.Uniform1f(P,m.u_scale_parent),u_fade_t:new r.Uniform1f(P,m.u_fade_t),u_opacity:new r.Uniform1f(P,m.u_opacity),u_image0:new r.Uniform1i(P,m.u_image0),u_image1:new r.Uniform1i(P,m.u_image1),u_brightness_low:new r.Uniform1f(P,m.u_brightness_low),u_brightness_high:new r.Uniform1f(P,m.u_brightness_high),u_saturation_factor:new r.Uniform1f(P,m.u_saturation_factor),u_contrast_factor:new r.Uniform1f(P,m.u_contrast_factor),u_spin_weights:new r.Uniform3f(P,m.u_spin_weights),u_perspective_transform:new r.Uniform2f(P,m.u_perspective_transform)}),symbolIcon:(P,m)=>({u_is_size_zoom_constant:new r.Uniform1i(P,m.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(P,m.u_is_size_feature_constant),u_size_t:new r.Uniform1f(P,m.u_size_t),u_size:new r.Uniform1f(P,m.u_size),u_camera_to_center_distance:new r.Uniform1f(P,m.u_camera_to_center_distance),u_rotate_symbol:new r.Uniform1i(P,m.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(P,m.u_aspect_ratio),u_fade_change:new r.Uniform1f(P,m.u_fade_change),u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(P,m.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(P,m.u_coord_matrix),u_is_text:new r.Uniform1i(P,m.u_is_text),u_pitch_with_map:new r.Uniform1i(P,m.u_pitch_with_map),u_texsize:new r.Uniform2f(P,m.u_texsize),u_tile_id:new r.Uniform3f(P,m.u_tile_id),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(P,m.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_camera_forward:new r.Uniform3f(P,m.u_camera_forward),u_tile_matrix:new r.UniformMatrix4f(P,m.u_tile_matrix),u_ecef_origin:new r.Uniform3f(P,m.u_ecef_origin),u_texture:new r.Uniform1i(P,m.u_texture)}),symbolSDF:(P,m)=>({u_is_size_zoom_constant:new r.Uniform1i(P,m.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(P,m.u_is_size_feature_constant),u_size_t:new r.Uniform1f(P,m.u_size_t),u_size:new r.Uniform1f(P,m.u_size),u_camera_to_center_distance:new r.Uniform1f(P,m.u_camera_to_center_distance),u_rotate_symbol:new r.Uniform1i(P,m.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(P,m.u_aspect_ratio),u_fade_change:new r.Uniform1f(P,m.u_fade_change),u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(P,m.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(P,m.u_coord_matrix),u_is_text:new r.Uniform1i(P,m.u_is_text),u_pitch_with_map:new r.Uniform1i(P,m.u_pitch_with_map),u_texsize:new r.Uniform2f(P,m.u_texsize),u_texture:new r.Uniform1i(P,m.u_texture),u_gamma_scale:new r.Uniform1f(P,m.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(P,m.u_device_pixel_ratio),u_tile_id:new r.Uniform3f(P,m.u_tile_id),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(P,m.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_camera_forward:new r.Uniform3f(P,m.u_camera_forward),u_tile_matrix:new r.UniformMatrix4f(P,m.u_tile_matrix),u_ecef_origin:new r.Uniform3f(P,m.u_ecef_origin),u_is_halo:new r.Uniform1i(P,m.u_is_halo)}),symbolTextAndIcon:(P,m)=>({u_is_size_zoom_constant:new r.Uniform1i(P,m.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(P,m.u_is_size_feature_constant),u_size_t:new r.Uniform1f(P,m.u_size_t),u_size:new r.Uniform1f(P,m.u_size),u_camera_to_center_distance:new r.Uniform1f(P,m.u_camera_to_center_distance),u_rotate_symbol:new r.Uniform1i(P,m.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(P,m.u_aspect_ratio),u_fade_change:new r.Uniform1f(P,m.u_fade_change),u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(P,m.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(P,m.u_coord_matrix),u_is_text:new r.Uniform1i(P,m.u_is_text),u_pitch_with_map:new r.Uniform1i(P,m.u_pitch_with_map),u_texsize:new r.Uniform2f(P,m.u_texsize),u_texsize_icon:new r.Uniform2f(P,m.u_texsize_icon),u_texture:new r.Uniform1i(P,m.u_texture),u_texture_icon:new r.Uniform1i(P,m.u_texture_icon),u_gamma_scale:new r.Uniform1f(P,m.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(P,m.u_device_pixel_ratio),u_is_halo:new r.Uniform1i(P,m.u_is_halo)}),background:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_opacity:new r.Uniform1f(P,m.u_opacity),u_color:new r.UniformColor(P,m.u_color)}),backgroundPattern:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_opacity:new r.Uniform1f(P,m.u_opacity),u_image:new r.Uniform1i(P,m.u_image),u_pattern_tl_a:new r.Uniform2f(P,m.u_pattern_tl_a),u_pattern_br_a:new r.Uniform2f(P,m.u_pattern_br_a),u_pattern_tl_b:new r.Uniform2f(P,m.u_pattern_tl_b),u_pattern_br_b:new r.Uniform2f(P,m.u_pattern_br_b),u_texsize:new r.Uniform2f(P,m.u_texsize),u_mix:new r.Uniform1f(P,m.u_mix),u_pattern_size_a:new r.Uniform2f(P,m.u_pattern_size_a),u_pattern_size_b:new r.Uniform2f(P,m.u_pattern_size_b),u_scale_a:new r.Uniform1f(P,m.u_scale_a),u_scale_b:new r.Uniform1f(P,m.u_scale_b),u_pixel_coord_upper:new r.Uniform2f(P,m.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(P,m.u_pixel_coord_lower),u_tile_units_to_pixels:new r.Uniform1f(P,m.u_tile_units_to_pixels)}),terrainRaster:Cf,terrainDepth:Cf,skybox:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_sun_direction:new r.Uniform3f(P,m.u_sun_direction),u_cubemap:new r.Uniform1i(P,m.u_cubemap),u_opacity:new r.Uniform1f(P,m.u_opacity),u_temporal_offset:new r.Uniform1f(P,m.u_temporal_offset)}),skyboxGradient:(P,m)=>({u_matrix:new r.UniformMatrix4f(P,m.u_matrix),u_color_ramp:new r.Uniform1i(P,m.u_color_ramp),u_center_direction:new r.Uniform3f(P,m.u_center_direction),u_radius:new r.Uniform1f(P,m.u_radius),u_opacity:new r.Uniform1f(P,m.u_opacity),u_temporal_offset:new r.Uniform1f(P,m.u_temporal_offset)}),skyboxCapture:(P,m)=>({u_matrix_3f:new r.UniformMatrix3f(P,m.u_matrix_3f),u_sun_direction:new r.Uniform3f(P,m.u_sun_direction),u_sun_intensity:new r.Uniform1f(P,m.u_sun_intensity),u_color_tint_r:new r.Uniform4f(P,m.u_color_tint_r),u_color_tint_m:new r.Uniform4f(P,m.u_color_tint_m),u_luminance:new r.Uniform1f(P,m.u_luminance)}),globeRaster:(P,m)=>({u_proj_matrix:new r.UniformMatrix4f(P,m.u_proj_matrix),u_globe_matrix:new r.UniformMatrix4f(P,m.u_globe_matrix),u_merc_matrix:new r.UniformMatrix4f(P,m.u_merc_matrix),u_zoom_transition:new r.Uniform1f(P,m.u_zoom_transition),u_merc_center:new r.Uniform2f(P,m.u_merc_center),u_image0:new r.Uniform1i(P,m.u_image0),u_grid_matrix:new r.UniformMatrix3f(P,m.u_grid_matrix)}),globeAtmosphere:(P,m)=>({u_frustum_tl:new r.Uniform3f(P,m.u_frustum_tl),u_frustum_tr:new r.Uniform3f(P,m.u_frustum_tr),u_frustum_br:new r.Uniform3f(P,m.u_frustum_br),u_frustum_bl:new r.Uniform3f(P,m.u_frustum_bl),u_globe_pos:new r.Uniform3f(P,m.u_globe_pos),u_globe_radius:new r.Uniform1f(P,m.u_globe_radius),u_opacity:new r.Uniform1f(P,m.u_opacity),u_fadeout_range:new r.Uniform1f(P,m.u_fadeout_range),u_start_color:new r.Uniform3f(P,m.u_start_color),u_end_color:new r.Uniform3f(P,m.u_end_color)})};let Ca;function a0(P,m,S,F,X,$,ot){const ct=P.context,yt=ct.gl,xt=P.useProgram("collisionBox"),Mt=[];let Pt=0,Nt=0;for(let se=0;se<F.length;se++){const ce=F[se],ne=m.getTile(ce),de=ne.getBucket(S);if(!de)continue;let Ae=ce.projMatrix;X[0]===0&&X[1]===0||(Ae=P.translatePosMatrix(ce.projMatrix,ne,X,$));const Re=ot?de.textCollisionBox:de.iconCollisionBox,je=de.collisionCircleArray;if(je.length>0){const Ne=r.create(),cn=Ae;r.mul(Ne,de.placementInvProjMatrix,P.transform.glCoordMatrix),r.mul(Ne,Ne,de.placementViewportMatrix),Mt.push({circleArray:je,circleOffset:Nt,transform:cn,invTransform:Ne}),Pt+=je.length/4,Nt=Pt}Re&&(P.terrain&&P.terrain.setupElevationDraw(ne,xt),xt.draw(ct,yt.LINES,r.DepthMode.disabled,r.StencilMode.disabled,P.colorModeForRenderPass(),r.CullFaceMode.disabled,jb(Ae,P.transform,ne),S.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,null,P.transform.zoom,null,Re.collisionVertexBuffer,Re.collisionVertexBufferExt))}if(!ot||!Mt.length)return;const Ht=P.useProgram("collisionCircle"),Ut=new r.StructArrayLayout2f1f2i16;Ut.resize(4*Pt),Ut._trim();let Bt=0;for(const se of Mt)for(let ce=0;ce<se.circleArray.length/4;ce++){const ne=4*ce,de=se.circleArray[ne+0],Ae=se.circleArray[ne+1],Re=se.circleArray[ne+2],je=se.circleArray[ne+3];Ut.emplace(Bt++,de,Ae,Re,je,0),Ut.emplace(Bt++,de,Ae,Re,je,1),Ut.emplace(Bt++,de,Ae,Re,je,2),Ut.emplace(Bt++,de,Ae,Re,je,3)}(!Ca||Ca.length<2*Pt)&&(Ca=function(se){const ce=2*se,ne=new r.StructArrayLayout3ui6;ne.resize(ce),ne._trim();for(let de=0;de<ce;de++){const Ae=6*de;ne.uint16[Ae+0]=4*de+0,ne.uint16[Ae+1]=4*de+1,ne.uint16[Ae+2]=4*de+2,ne.uint16[Ae+3]=4*de+2,ne.uint16[Ae+4]=4*de+3,ne.uint16[Ae+5]=4*de+0}return ne}(Pt));const ae=ct.createIndexBuffer(Ca,!0),Jt=ct.createVertexBuffer(Ut,r.collisionCircleLayout.members,!0);for(const se of Mt){const ce={u_matrix:se.transform,u_inv_matrix:se.invTransform,u_camera_to_center_distance:(ie=P.transform).cameraToCenterDistance,u_viewport_size:[ie.width,ie.height]};Ht.draw(ct,yt.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,P.colorModeForRenderPass(),r.CullFaceMode.disabled,ce,S.id,Jt,ae,r.SegmentVector.simpleSegment(0,2*se.circleOffset,se.circleArray.length,se.circleArray.length/2),null,P.transform.zoom,null,null,null)}var ie;Jt.destroy(),ae.destroy()}const Of=r.create();function _c(P,m,S,F,X,$){const{horizontalAlign:ot,verticalAlign:ct}=r.getAnchorAlignment(P),yt=-(ot-.5)*m,xt=-(ct-.5)*S,Mt=r.evaluateVariableOffset(P,F);return new r.pointGeometry((yt/X+Mt[0])*$,(xt/X+Mt[1])*$)}function qb(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt){const Nt=P.text.placedSymbolArray,Ht=P.text.dynamicLayoutVertexArray,Ut=P.icon.dynamicLayoutVertexArray,Bt={},ae=ct.projMatrix,Jt=$.elevation,ie=Pt.upVectorScale(ct.canonical,$.center.lat,$.worldSize);Ht.clear();for(let se=0;se<Nt.length;se++){const ce=Nt.get(se),ne=P.allowVerticalPlacement&&!ce.placedOrientation,de=ce.hidden||!ce.crossTileID||ne?null:F[ce.crossTileID];if(de){const Ae=new r.pointGeometry(ce.tileAnchorX,ce.tileAnchorY),Re=Pt.upVector(ct.canonical,Ae.x,Ae.y),je=Jt?Jt.getAtTileOffset(ct,Ae.x,Ae.y):0,Ne=jn([ce.projectedAnchorX+je*Re[0]*ie.metersToTile,ce.projectedAnchorY+je*Re[1]*ie.metersToTile,ce.projectedAnchorZ+je*Re[2]*ie.metersToTile],S?ae:ot),cn=Xn($.cameraToCenterDistance,Ne.signedDistanceFromCamera);let Se=X.evaluateSizeForFeature(P.textSizeData,xt,ce)*cn/r.ONE_EM;S&&(Se*=P.tilePixelRatio/yt);const{width:un,height:rn,anchor:En,textOffset:He,textScale:_n}=de,Fn=_c(En,un,rn,He,_n,Se),Mn=S?vn(Ae.add(Fn),ot,je*ie.metersToLabelSpace).point:Ne.point.add(m?Fn.rotate(-$.angle):Fn),An=P.allowVerticalPlacement&&ce.placedOrientation===r.WritingMode.vertical?Math.PI/2:0;for(let Vn=0;Vn<ce.numGlyphs;Vn++)r.addDynamicAttributes(Ht,Mn,An);Mt&&ce.associatedIconIndex>=0&&(Bt[ce.associatedIconIndex]={shiftedAnchor:Mn,angle:An})}else $n(ce.numGlyphs,Ht)}if(Mt){Ut.clear();const se=P.icon.placedSymbolArray;for(let ce=0;ce<se.length;ce++){const ne=se.get(ce);if(ne.hidden)$n(ne.numGlyphs,Ut);else{const de=Bt[ce];if(de)for(let Ae=0;Ae<ne.numGlyphs;Ae++)r.addDynamicAttributes(Ut,de.shiftedAnchor,de.angle);else $n(ne.numGlyphs,Ut)}}P.icon.dynamicLayoutVertexBuffer.updateData(Ut)}P.text.dynamicLayoutVertexBuffer.updateData(Ht)}function Xb(P,m,S){return S.iconsInText&&m?"symbolTextAndIcon":P?"symbolSDF":"symbolIcon"}function zf(P,m,S,F,X,$,ot,ct,yt,xt,Mt,Pt){const Nt=P.context,Ht=Nt.gl,Ut=P.transform,Bt=ct==="map",ae=yt==="map",Jt=Bt&&S.layout.get("symbol-placement")!=="point",ie=Bt&&!ae&&!Jt,se=S.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ce=!1;const ne=P.depthModeForSublayer(0,r.DepthMode.ReadOnly),de=[r.mercatorXfromLng(Ut.center.lng),r.mercatorYfromLat(Ut.center.lat)],Ae=S.layout.get("text-variable-anchor"),Re=Ut.projection.name==="globe",je=Re?r.globeToMercatorTransition(Ut.zoom):0,Ne=[],cn=[];P.terrain&&ae&&cn.push("PITCH_WITH_MAP_TERRAIN"),Re&&cn.push("PROJECTION_GLOBE_VIEW");for(const Se of F){const un=m.getTile(Se),rn=un.getBucket(S);if(!rn||rn.projection!==Ut.projection.name)continue;const En=X?rn.text:rn.icon;if(!En||rn.fullyClipped||!En.segments.get().length)continue;const He=En.programConfigurations.get(S.id),_n=X||rn.sdfIcons,Fn=X?rn.textSizeData:rn.iconSizeData,Mn=ae||Ut.pitch!==0,An=r.evaluateSizeForZoom(Fn,Ut.zoom);let Vn,ir,Bn,Gn,gr=[0,0],Vr=null;if(X){if(ir=un.glyphAtlasTexture,Bn=Ht.LINEAR,Vn=un.glyphAtlasTexture.size,rn.iconsInText){gr=un.imageAtlasTexture.size,Vr=un.imageAtlasTexture;const uo=Fn.kind==="composite"||Fn.kind==="camera";Gn=Mn||P.options.rotating||P.options.zooming||uo?Ht.LINEAR:Ht.NEAREST}}else{const uo=S.layout.get("icon-size").constantOr(0)!==1||rn.iconsNeedLinear;ir=un.imageAtlasTexture,Bn=_n||P.options.rotating||P.options.zooming||uo||Mn?Ht.LINEAR:Ht.NEAREST,Vn=un.imageAtlasTexture.size}const Pi=P.transform.calculatePixelsToTileUnitsMatrix(un),Di=In(Se.projMatrix,un.tileID.canonical,ae,Bt,P.transform,Pi),lo=P.terrain&&ae&&Jt?r.invert(r.create(),Di):Of,Wo=Wn(Se.projMatrix,un.tileID.canonical,ae,Bt,P.transform,Pi),_s=Ae&&rn.hasTextData(),Zs=S.layout.get("icon-text-fit")!=="none"&&_s&&rn.hasIconData();if(Jt){const uo=Ut.elevation,Da=uo?uo.getAtTileOffsetFunc(Se,Ut.center.lat,Ut.worldSize,Ut.projection):N0=>[0,0,0];wr(rn,Se.projMatrix,P,X,Di,Wo,ae,xt,Da,Se)}const ws=Jt||X&&Ae||Zs,Gr=P.translatePosMatrix(Se.projMatrix,un,$,ot),Yr=ws?Of:Di,br=P.translatePosMatrix(Wo,un,$,ot,!0),Qr=Ut.projection.createInversionMatrix(Ut,Se.canonical),co=ws?cn.concat(["PROJECTED_POS_ON_VIEWPORT"]):cn,jr=_n&&S.paint.get(X?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Eo;Eo=_n?rn.iconsInText?hl(Fn.kind,An,ie,ae,P,Gr,Yr,br,Vn,gr,Se,je,de,Qr):Ta(Fn.kind,An,ie,ae,P,Gr,Yr,br,X,Vn,!0,Se,je,de,Qr):Ff(Fn.kind,An,ie,ae,P,Gr,Yr,br,X,Vn,Se,je,de,Qr);const Nc={program:P.useProgram(Xb(_n,X,rn),He,co),buffers:En,uniformValues:Eo,atlasTexture:ir,atlasTextureIcon:Vr,atlasInterpolation:Bn,atlasInterpolationIcon:Gn,isSDF:_n,hasHalo:jr,tile:un,labelPlaneMatrixInv:lo};if(se&&rn.canOverlap){ce=!0;const uo=En.segments.get();for(const Da of uo)Ne.push({segments:new r.SegmentVector([Da]),sortKey:Da.sortKey,state:Nc})}else Ne.push({segments:En.segments,sortKey:0,state:Nc})}ce&&Ne.sort((Se,un)=>Se.sortKey-un.sortKey);for(const Se of Ne){const un=Se.state;if(P.terrain&&P.terrain.setupElevationDraw(un.tile,un.program,{useDepthForOcclusion:!Re,labelPlaneMatrixInv:un.labelPlaneMatrixInv}),Nt.activeTexture.set(Ht.TEXTURE0),un.atlasTexture.bind(un.atlasInterpolation,Ht.CLAMP_TO_EDGE),un.atlasTextureIcon&&(Nt.activeTexture.set(Ht.TEXTURE1),un.atlasTextureIcon&&un.atlasTextureIcon.bind(un.atlasInterpolationIcon,Ht.CLAMP_TO_EDGE)),un.isSDF){const rn=un.uniformValues;un.hasHalo&&(rn.u_is_halo=1,l0(un.buffers,Se.segments,S,P,un.program,ne,Mt,Pt,rn)),rn.u_is_halo=0}l0(un.buffers,Se.segments,S,P,un.program,ne,Mt,Pt,un.uniformValues)}}function l0(P,m,S,F,X,$,ot,ct,yt){const xt=F.context;X.draw(xt,xt.gl.TRIANGLES,$,ot,ct,r.CullFaceMode.disabled,yt,S.id,P.layoutVertexBuffer,P.indexBuffer,m,S.paint,F.transform.zoom,P.programConfigurations.get(S.id),P.dynamicLayoutVertexBuffer,P.opacityVertexBuffer)}function vh(P,m,S,F,X,$,ot){const ct=P.context.gl,yt=S.paint.get("fill-pattern"),xt=yt&&yt.constantOr(1),Mt=S.getCrossfadeParameters();let Pt,Nt,Ht,Ut,Bt;ot?(Nt=xt&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Pt=ct.LINES):(Nt=xt?"fillPattern":"fill",Pt=ct.TRIANGLES);for(const ae of F){const Jt=m.getTile(ae);if(xt&&!Jt.patternsLoaded())continue;const ie=Jt.getBucket(S);if(!ie)continue;P.prepareDrawTile();const se=ie.programConfigurations.get(S.id),ce=P.useProgram(Nt,se);xt&&(P.context.activeTexture.set(ct.TEXTURE0),Jt.imageAtlasTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),se.updatePaintBuffers(Mt));const ne=yt.constantOr(null);if(ne&&Jt.imageAtlas){const Ae=Jt.imageAtlas,Re=Ae.patternPositions[ne.to.toString()],je=Ae.patternPositions[ne.from.toString()];Re&&je&&se.setConstantPatternPositions(Re,je)}const de=P.translatePosMatrix(ae.projMatrix,Jt,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));if(ot){Ut=ie.indexBuffer2,Bt=ie.segments2;const Ae=P.terrain&&P.terrain.renderingToTexture?P.terrain.drapeBufferSize:[ct.drawingBufferWidth,ct.drawingBufferHeight];Ht=Nt==="fillOutlinePattern"&&xt?n0(de,P,Mt,Jt,Ae):yh(de,Ae)}else Ut=ie.indexBuffer,Bt=ie.segments,Ht=xt?gh(de,P,Mt,Jt):mh(de);P.prepareDrawProgram(P.context,ce,ae.toUnwrapped()),ce.draw(P.context,Pt,X,P.stencilModeForClipping(ae),$,r.CullFaceMode.disabled,Ht,S.id,ie.layoutVertexBuffer,Ut,Bt,S.paint,P.transform.zoom,se)}}function dl(P,m,S,F,X,$,ot){const ct=P.context,yt=ct.gl,xt=P.transform,Mt=S.paint.get("fill-extrusion-pattern"),Pt=Mt.constantOr(1),Nt=S.getCrossfadeParameters(),Ht=S.paint.get("fill-extrusion-opacity"),Ut=function(se){if(se.projection.name!=="globe")return 0;const ce=Math.PI/32,ne=Math.tan(ce),de=r.earthRadius;return de*Math.sqrt(1+2*ne*ne)-de}(xt),Bt=xt.projection.name==="globe",ae=Bt?r.globeToMercatorTransition(xt.zoom):0,Jt=[r.mercatorXfromLng(xt.center.lng),r.mercatorYfromLat(xt.center.lat)],ie=[];Bt&&ie.push("PROJECTION_GLOBE_VIEW");for(const se of F){const ce=m.getTile(se),ne=ce.getBucket(S);if(!ne||ne.projection!==xt.projection.name)continue;const de=ne.programConfigurations.get(S.id),Ae=P.useProgram(Pt?"fillExtrusionPattern":"fillExtrusion",de,ie);if(P.terrain){const un=P.terrain;if(P.style.terrainSetForDrapingOnly())un.setupElevationDraw(ce,Ae,{useMeterToDem:!0});else{if(!ne.enableTerrain)continue;if(un.setupElevationDraw(ce,Ae,{useMeterToDem:!0}),wc(ct,m,se,ne,S,un),!ne.centroidVertexBuffer){const rn=Ae.attributes.a_centroid_pos;rn!==void 0&&yt.vertexAttrib2f(rn,0,0)}}}Pt&&(P.context.activeTexture.set(yt.TEXTURE0),ce.imageAtlasTexture.bind(yt.LINEAR,yt.CLAMP_TO_EDGE),de.updatePaintBuffers(Nt));const Re=Mt.constantOr(null);if(Re&&ce.imageAtlas){const un=ce.imageAtlas,rn=un.patternPositions[Re.to.toString()],En=un.patternPositions[Re.from.toString()];rn&&En&&de.setConstantPatternPositions(rn,En)}const je=P.translatePosMatrix(se.projMatrix,ce,S.paint.get("fill-extrusion-translate"),S.paint.get("fill-extrusion-translate-anchor")),Ne=xt.projection.createInversionMatrix(xt,se.canonical),cn=S.paint.get("fill-extrusion-vertical-gradient"),Se=Pt?ph(je,P,cn,Ht,se,Nt,ce,Ut,ae,Jt,Ne):fh(je,P,cn,Ht,se,Ut,ae,Jt,Ne);P.prepareDrawProgram(ct,Ae,se.toUnwrapped()),Ae.draw(ct,ct.gl.TRIANGLES,X,$,ot,r.CullFaceMode.backCCW,Se,S.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,S.paint,P.transform.zoom,de,P.terrain?ne.centroidVertexBuffer:null,Bt?ne.layoutVertexExtBuffer:null)}}function wc(P,m,S,F,X,$){const ot=[Jt=>{let ie=Jt.canonical.x-1,se=Jt.wrap;return ie<0&&(ie=(1<<Jt.canonical.z)-1,se--),new r.OverscaledTileID(Jt.overscaledZ,se,Jt.canonical.z,ie,Jt.canonical.y)},Jt=>{let ie=Jt.canonical.x+1,se=Jt.wrap;return ie===1<<Jt.canonical.z&&(ie=0,se++),new r.OverscaledTileID(Jt.overscaledZ,se,Jt.canonical.z,ie,Jt.canonical.y)},Jt=>new r.OverscaledTileID(Jt.overscaledZ,Jt.wrap,Jt.canonical.z,Jt.canonical.x,(Jt.canonical.y===0?1<<Jt.canonical.z:Jt.canonical.y)-1),Jt=>new r.OverscaledTileID(Jt.overscaledZ,Jt.wrap,Jt.canonical.z,Jt.canonical.x,Jt.canonical.y===(1<<Jt.canonical.z)-1?0:Jt.canonical.y+1)],ct=Jt=>{const ie=m.getSource().minzoom,se=ne=>{const de=m.getTileByID(ne);if(de&&de.hasData())return de.getBucket(X)},ce=[0,-1,1];for(const ne of ce){if(Jt.overscaledZ+ne<ie)continue;const de=se(Jt.calculateScaledKey(Jt.overscaledZ+ne));if(de)return de}},yt=[0,0,0],xt=(Jt,ie)=>(yt[0]=Math.min(Jt.min.y,ie.min.y),yt[1]=Math.max(Jt.max.y,ie.max.y),yt[2]=r.EXTENT-ie.min.x>Jt.max.x?ie.min.x-r.EXTENT:Jt.max.x,yt),Mt=(Jt,ie)=>(yt[0]=Math.min(Jt.min.x,ie.min.x),yt[1]=Math.max(Jt.max.x,ie.max.x),yt[2]=r.EXTENT-ie.min.y>Jt.max.y?ie.min.y-r.EXTENT:Jt.max.y,yt),Pt=[(Jt,ie)=>xt(Jt,ie),(Jt,ie)=>xt(ie,Jt),(Jt,ie)=>Mt(Jt,ie),(Jt,ie)=>Mt(ie,Jt)],Nt=new r.pointGeometry(0,0);let Ht,Ut,Bt;const ae=(Jt,ie,se,ce,ne)=>{const de=[[ce?se:Jt,ce?Jt:se,0],[ce?se:ie,ce?ie:se,0]],Ae=ne<0?r.EXTENT+ne:ne,Re=[ce?Ae:(Jt+ie)/2,ce?(Jt+ie)/2:Ae,0];return se===0&&ne<0||se!==0&&ne>0?$.getForTilePoints(Bt,[Re],!0,Ut):de.push(Re),$.getForTilePoints(S,de,!0,Ht),Math.max(de[0][2],de[1][2],Re[2])/$.exaggeration()};for(let Jt=0;Jt<4;Jt++){const ie=(Jt<2?1:5)-Jt,se=F.borders[Jt];if(se.length===0)continue;const ce=Bt=ot[Jt](S),ne=ct(ce);if(!(ne&&ne instanceof r.FillExtrusionBucket&&ne.enableTerrain)||F.borderDoneWithNeighborZ[Jt]===ne.canonical.z&&ne.borderDoneWithNeighborZ[ie]===F.canonical.z||(Ut=$.findDEMTileFor(ce),!Ut||!Ut.dem))continue;if(!Ht){const je=$.findDEMTileFor(S);if(!je||!je.dem)return;Ht=je}const de=ne.borders[ie];let Ae=0;const Re=ne.borderDoneWithNeighborZ[ie]!==F.canonical.z;if(F.canonical.z===ne.canonical.z){for(let je=0;je<se.length;je++){const Ne=F.featuresOnBorder[se[je]],cn=Ne.borders[Jt];let Se;for(;Ae<de.length&&(Se=ne.featuresOnBorder[de[Ae]],!(Se.borders[ie][1]>cn[0]+3));)Re&&ne.encodeCentroid(void 0,Se,!1),Ae++;if(Se&&Ae<de.length){const un=Ae;let rn=0;for(;!(Se.borders[ie][0]>cn[1]-3)&&(rn++,++Ae!==de.length);)Se=ne.featuresOnBorder[de[Ae]];if(Se=ne.featuresOnBorder[de[un]],Ne.intersectsCount()>1||Se.intersectsCount()>1||rn!==1){rn!==1&&(Ae=un),F.encodeCentroid(void 0,Ne,!1),Re&&ne.encodeCentroid(void 0,Se,!1);continue}const En=Pt[Jt](Ne,Se),He=Jt%2?r.EXTENT-1:0;Nt.x=ae(En[0],Math.min(r.EXTENT-1,En[1]),He,Jt<2,En[2]),Nt.y=0,F.encodeCentroid(Nt,Ne,!1),Re&&ne.encodeCentroid(Nt,Se,!1)}else F.encodeCentroid(void 0,Ne,!1)}F.borderDoneWithNeighborZ[Jt]=ne.canonical.z,F.needsCentroidUpdate=!0,Re&&(ne.borderDoneWithNeighborZ[ie]=F.canonical.z,ne.needsCentroidUpdate=!0)}else{for(const je of se)F.encodeCentroid(void 0,F.featuresOnBorder[je],!1);if(Re){for(const je of de)ne.encodeCentroid(void 0,ne.featuresOnBorder[je],!1);ne.borderDoneWithNeighborZ[ie]=F.canonical.z,ne.needsCentroidUpdate=!0}F.borderDoneWithNeighborZ[Jt]=ne.canonical.z,F.needsCentroidUpdate=!0}}(F.needsCentroidUpdate||!F.centroidVertexBuffer&&F.centroidVertexArray.length!==0)&&F.uploadCentroid(P)}const Uf=new r.Color(1,0,0,1),Vf=new r.Color(0,1,0,1),c0=new r.Color(0,0,1,1),xh=new r.Color(1,0,1,1),_h=new r.Color(0,1,1,1);function yn(P,m,S,F){Mc(P,0,m+S/2,P.transform.width,S,F)}function Ao(P,m,S,F){Mc(P,m-S/2,0,S,P.transform.height,F)}function Mc(P,m,S,F,X,$){const ot=P.context,ct=ot.gl;ct.enable(ct.SCISSOR_TEST),ct.scissor(m*r.exported.devicePixelRatio,S*r.exported.devicePixelRatio,F*r.exported.devicePixelRatio,X*r.exported.devicePixelRatio),ot.clear({color:$}),ct.disable(ct.SCISSOR_TEST)}function u0(P,m,S){const F=P.context,X=F.gl,$=P.transform.projection.name==="globe",ot=S.projMatrix,ct=P.useProgram("debug",null,$?["PROJECTION_GLOBE_VIEW"]:null),yt=m.getTileByID(S.key);P.terrain&&P.terrain.setupElevationDraw(yt,ct);const xt=r.DepthMode.disabled,Mt=r.StencilMode.disabled,Pt=P.colorModeForRenderPass(),Nt="$debug";F.activeTexture.set(X.TEXTURE0),P.emptyTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),$?yt._makeGlobeTileDebugBuffers(P.context,P.transform.projection):yt._makeDebugTileBoundsBuffers(P.context,P.transform.projection);const Ht=yt._tileDebugBuffer||P.debugBuffer,Ut=yt._tileDebugIndexBuffer||P.debugIndexBuffer,Bt=yt._tileDebugSegments||P.debugSegments;ct.draw(F,X.LINE_STRIP,xt,Mt,Pt,r.CullFaceMode.disabled,i0(ot,r.Color.red),Nt,Ht,Ut,Bt,null,null,null,yt._globeTileDebugBorderBuffer);const ae=yt.latestRawTileData,Jt=Math.floor((ae&&ae.byteLength||0)/1024),ie=m.getTile(S).tileSize,se=512/Math.min(ie,512)*(S.overscaledZ/P.transform.zoom)*.5;let ce=S.canonical.toString();S.overscaledZ!==S.canonical.z&&(ce+=` => ${S.overscaledZ}`),function(Re,je){Re.initDebugOverlayCanvas();const Ne=Re.debugOverlayCanvas,cn=Re.context.gl,Se=Re.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,Ne.width,Ne.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(je,5,5),Se.strokeText(je,5,5),Re.debugOverlayTexture.update(Ne),Re.debugOverlayTexture.bind(cn.LINEAR,cn.CLAMP_TO_EDGE)}(P,`${ce} ${Jt}kb`);const ne=yt._tileDebugTextBuffer||P.debugBuffer,de=yt._tileDebugTextIndexBuffer||P.quadTriangleIndexBuffer,Ae=yt._tileDebugTextSegments||P.debugSegments;ct.draw(F,X.TRIANGLES,xt,Mt,r.ColorMode.alphaBlended,r.CullFaceMode.disabled,i0(ot,r.Color.transparent,se),Nt,ne,de,Ae,null,null,null,yt._globeTileDebugTextBuffer)}const h0=r.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:fl}=h0;function bs(P,m,S,F){P.emplaceBack(m,S,F)}class Ac{constructor(m){this.vertexArray=new r.StructArrayLayout3f12,this.indices=new r.StructArrayLayout3ui6,bs(this.vertexArray,-1,-1,1),bs(this.vertexArray,1,-1,1),bs(this.vertexArray,-1,1,1),bs(this.vertexArray,1,1,1),bs(this.vertexArray,-1,-1,-1),bs(this.vertexArray,1,-1,-1),bs(this.vertexArray,-1,1,-1),bs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=m.createVertexBuffer(this.vertexArray,fl),this.indexBuffer=m.createIndexBuffer(this.indices),this.segment=r.SegmentVector.simpleSegment(0,0,36,12)}}function Ws(P,m,S,F,X,$){const ot=P.gl,ct=m.paint.get("sky-atmosphere-color"),yt=m.paint.get("sky-atmosphere-halo-color"),xt=m.paint.get("sky-atmosphere-sun-intensity"),Mt=((Pt,Nt,Ht,Ut,Bt)=>({u_matrix_3f:Pt,u_sun_direction:Nt,u_sun_intensity:Ht,u_color_tint_r:[Ut.r,Ut.g,Ut.b,Ut.a],u_color_tint_m:[Bt.r,Bt.g,Bt.b,Bt.a],u_luminance:5e-5}))(r.fromMat4(r.create$1(),F),X,xt,ct,yt);ot.framebufferTexture2D(ot.FRAMEBUFFER,ot.COLOR_ATTACHMENT0,ot.TEXTURE_CUBE_MAP_POSITIVE_X+$,m.skyboxTexture,0),S.draw(P,ot.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.frontCW,Mt,"skyboxCapture",m.skyboxGeometry.vertexBuffer,m.skyboxGeometry.indexBuffer,m.skyboxGeometry.segment)}function qs(P,m){return r.transformMat4(P,P,m)}const jf={symbol:function(P,m,S,F,X){if(P.renderPass!=="translucent")return;const $=r.StencilMode.disabled,ot=P.colorModeForRenderPass();S.layout.get("text-variable-anchor")&&function(ct,yt,xt,Mt,Pt,Nt,Ht){const Ut=yt.transform,Bt=Pt==="map",ae=Nt==="map";for(const Jt of ct){const ie=Mt.getTile(Jt),se=ie.getBucket(xt);if(!se||se.projection!==Ut.projection.name||!se.text||!se.text.segments.get().length)continue;const ce=r.evaluateSizeForZoom(se.textSizeData,Ut.zoom),ne=yt.transform.calculatePixelsToTileUnitsMatrix(ie),de=In(Jt.projMatrix,ie.tileID.canonical,ae,Bt,yt.transform,ne),Ae=xt.layout.get("icon-text-fit")!=="none"&&se.hasIconData();if(ce){const Re=Math.pow(2,Ut.zoom-ie.tileID.overscaledZ);qb(se,Bt,ae,Ht,r.symbolSize,Ut,de,Jt,Re,ce,Ae,Ut.projection)}}}(F,P,S,m,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),X),S.paint.get("icon-opacity").constantOr(1)!==0&&zf(P,m,S,F,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),$,ot),S.paint.get("text-opacity").constantOr(1)!==0&&zf(P,m,S,F,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),$,ot),m.map.showCollisionBoxes&&(a0(P,m,S,F,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),!0),a0(P,m,S,F,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),!1))},circle:function(P,m,S,F){if(P.renderPass!=="translucent")return;const X=S.paint.get("circle-opacity"),$=S.paint.get("circle-stroke-width"),ot=S.paint.get("circle-stroke-opacity"),ct=S.layout.get("circle-sort-key").constantOr(1)!==void 0;if(X.constantOr(1)===0&&($.constantOr(1)===0||ot.constantOr(1)===0))return;const yt=P.context,xt=yt.gl,Mt=P.transform,Pt=P.depthModeForSublayer(0,r.DepthMode.ReadOnly),Nt=r.StencilMode.disabled,Ht=P.colorModeForRenderPass(),Ut=Mt.projection.name==="globe",Bt=[r.mercatorXfromLng(Mt.center.lng),r.mercatorYfromLat(Mt.center.lat)],ae=[];for(let ie=0;ie<F.length;ie++){const se=F[ie],ce=m.getTile(se),ne=ce.getBucket(S);if(!ne)continue;const de=ne.programConfigurations.get(S.id),Ae=Vb(S);Ut&&Ae.push("PROJECTION_GLOBE_VIEW");const Re=P.useProgram("circle",de,Ae),je=ne.layoutVertexBuffer,Ne=ne.globeExtVertexBuffer,cn=ne.indexBuffer,Se=Mt.projection.createInversionMatrix(Mt,se.canonical),un={programConfiguration:de,program:Re,layoutVertexBuffer:je,globeExtVertexBuffer:Ne,indexBuffer:cn,uniformValues:ul(P,se,ce,Se,Bt,S),tile:ce};if(ct){const rn=ne.segments.get();for(const En of rn)ae.push({segments:new r.SegmentVector([En]),sortKey:En.sortKey,state:un})}else ae.push({segments:ne.segments,sortKey:0,state:un})}ct&&ae.sort((ie,se)=>ie.sortKey-se.sortKey);const Jt={useDepthForOcclusion:!Ut};for(const ie of ae){const{programConfiguration:se,program:ce,layoutVertexBuffer:ne,globeExtVertexBuffer:de,indexBuffer:Ae,uniformValues:Re,tile:je}=ie.state,Ne=ie.segments;P.terrain&&P.terrain.setupElevationDraw(je,ce,Jt),P.prepareDrawProgram(yt,ce,je.tileID.toUnwrapped()),ce.draw(yt,xt.TRIANGLES,Pt,Nt,Ht,r.CullFaceMode.disabled,Re,S.id,ne,Ae,Ne,S.paint,Mt.zoom,se,Ut?de:null)}},heatmap:function(P,m,S,F){if(S.paint.get("heatmap-opacity")!==0)if(P.renderPass==="offscreen"){const X=P.context,$=X.gl,ot=r.StencilMode.disabled,ct=new r.ColorMode([$.ONE,$.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(Nt,Ht,Ut){const Bt=Nt.gl;Nt.activeTexture.set(Bt.TEXTURE1),Nt.viewport.set([0,0,Ht.width/4,Ht.height/4]);let ae=Ut.heatmapFbo;if(ae)Bt.bindTexture(Bt.TEXTURE_2D,ae.colorAttachment.get()),Nt.bindFramebuffer.set(ae.framebuffer);else{const Jt=Bt.createTexture();Bt.bindTexture(Bt.TEXTURE_2D,Jt),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_S,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_T,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MAG_FILTER,Bt.LINEAR),ae=Ut.heatmapFbo=Nt.createFramebuffer(Ht.width/4,Ht.height/4,!1),function(ie,se,ce,ne){const de=ie.gl;de.texImage2D(de.TEXTURE_2D,0,de.RGBA,se.width/4,se.height/4,0,de.RGBA,ie.extRenderToTextureHalfFloat?ie.extTextureHalfFloat.HALF_FLOAT_OES:de.UNSIGNED_BYTE,null),ne.colorAttachment.set(ce)}(Nt,Ht,Jt,ae)}})(X,P,S),X.clear({color:r.Color.transparent});const yt=P.transform,xt=yt.projection.name==="globe",Mt=xt?["PROJECTION_GLOBE_VIEW"]:null,Pt=[r.mercatorXfromLng(yt.center.lng),r.mercatorYfromLat(yt.center.lat)];for(let Nt=0;Nt<F.length;Nt++){const Ht=F[Nt];if(m.hasRenderableParent(Ht))continue;const Ut=m.getTile(Ht),Bt=Ut.getBucket(S);if(!Bt)continue;const ae=Bt.programConfigurations.get(S.id),Jt=P.useProgram("heatmap",ae,Mt),{zoom:ie}=P.transform;P.terrain&&P.terrain.setupElevationDraw(Ut,Jt),P.prepareDrawProgram(X,Jt,Ht.toUnwrapped());const se=yt.projection.createInversionMatrix(yt,Ht.canonical);Jt.draw(X,$.TRIANGLES,r.DepthMode.disabled,ot,ct,r.CullFaceMode.disabled,Hb(P,Ht,Ut,se,Pt,ie,S.paint.get("heatmap-intensity")),S.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,S.paint,P.transform.zoom,ae,xt?Bt.globeExtVertexBuffer:null)}X.viewport.set([0,0,P.width,P.height])}else P.renderPass==="translucent"&&(P.context.setColorMode(P.colorModeForRenderPass()),function(X,$){const ot=X.context,ct=ot.gl,yt=$.heatmapFbo;if(!yt)return;ot.activeTexture.set(ct.TEXTURE0),ct.bindTexture(ct.TEXTURE_2D,yt.colorAttachment.get()),ot.activeTexture.set(ct.TEXTURE1);let xt=$.colorRampTexture;xt||(xt=$.colorRampTexture=new r.Texture(ot,$.colorRamp,ct.RGBA)),xt.bind(ct.LINEAR,ct.CLAMP_TO_EDGE),X.useProgram("heatmapTexture").draw(ot,ct.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,X.colorModeForRenderPass(),r.CullFaceMode.disabled,((Mt,Pt,Nt,Ht)=>({u_image:0,u_color_ramp:1,u_opacity:Pt.paint.get("heatmap-opacity")}))(0,$),$.id,X.viewportBuffer,X.quadTriangleIndexBuffer,X.viewportSegments,$.paint,X.transform.zoom)}(P,S))},line:function(P,m,S,F){if(P.renderPass!=="translucent")return;const X=S.paint.get("line-opacity"),$=S.paint.get("line-width");if(X.constantOr(1)===0||$.constantOr(1)===0)return;const ot=P.depthModeForSublayer(0,r.DepthMode.ReadOnly),ct=P.colorModeForRenderPass(),yt=P.terrain&&P.terrain.renderingToTexture?1:r.exported.devicePixelRatio,xt=S.paint.get("line-dasharray"),Mt=xt.constantOr(1),Pt=S.layout.get("line-cap"),Nt=S.paint.get("line-pattern"),Ht=Nt.constantOr(1),Ut=S.paint.get("line-gradient"),Bt=S.getCrossfadeParameters(),ae=Ht?"linePattern":"line",Jt=P.context,ie=Jt.gl,se=(ne=>{const de=[];Lf(ne)&&de.push("RENDER_LINE_DASH"),ne.paint.get("line-gradient")&&de.push("RENDER_LINE_GRADIENT");const Ae=ne.paint.get("line-pattern").constantOr(1),Re=ne.paint.get("line-opacity").constantOr(1)!==1;return!Ae&&Re&&de.push("RENDER_LINE_ALPHA_DISCARD"),de})(S);let ce=se.includes("RENDER_LINE_ALPHA_DISCARD");P.terrain&&P.terrain.clipOrMaskOverlapStencilType()&&(ce=!1);for(const ne of F){const de=m.getTile(ne);if(Ht&&!de.patternsLoaded())continue;const Ae=de.getBucket(S);if(!Ae)continue;P.prepareDrawTile();const Re=Ae.programConfigurations.get(S.id),je=P.useProgram(ae,Re,se),Ne=Nt.constantOr(null);if(Ne&&de.imageAtlas){const He=de.imageAtlas,_n=He.patternPositions[Ne.to.toString()],Fn=He.patternPositions[Ne.from.toString()];_n&&Fn&&Re.setConstantPatternPositions(_n,Fn)}const cn=xt.constantOr(null),Se=Pt.constantOr(null);if(!Ht&&cn&&Se&&de.lineAtlas){const He=de.lineAtlas,_n=He.getDash(cn.to,Se),Fn=He.getDash(cn.from,Se);_n&&Fn&&Re.setConstantPatternPositions(_n,Fn)}const un=P.terrain?ne.projMatrix:null,rn=Ht?If(P,de,S,Bt,un,yt):Wb(P,de,S,Bt,un,Ae.lineClipsArray.length,yt);if(Ut){const He=Ae.gradients[S.id];let _n=He.texture;if(S.gradientVersion!==He.version){let Fn=256;if(S.stepInterpolant){const Mn=m.getSource().maxzoom,An=ne.canonical.z===Mn?Math.ceil(1<<P.transform.maxZoom-ne.canonical.z):1;Fn=r.clamp(r.nextPowerOfTwo(Ae.maxLineLength/r.EXTENT*1024*An),256,Jt.maxTextureSize)}He.gradient=r.renderColorRamp({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Fn,image:He.gradient||void 0,clips:Ae.lineClipsArray}),He.texture?He.texture.update(He.gradient):He.texture=new r.Texture(Jt,He.gradient,ie.RGBA),He.version=S.gradientVersion,_n=He.texture}Jt.activeTexture.set(ie.TEXTURE1),_n.bind(S.stepInterpolant?ie.NEAREST:ie.LINEAR,ie.CLAMP_TO_EDGE)}Mt&&(Jt.activeTexture.set(ie.TEXTURE0),de.lineAtlasTexture.bind(ie.LINEAR,ie.REPEAT),Re.updatePaintBuffers(Bt)),Ht&&(Jt.activeTexture.set(ie.TEXTURE0),de.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),Re.updatePaintBuffers(Bt)),P.prepareDrawProgram(Jt,je,ne.toUnwrapped());const En=He=>{je.draw(Jt,ie.TRIANGLES,ot,He,ct,r.CullFaceMode.disabled,rn,S.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,S.paint,P.transform.zoom,Re,Ae.layoutVertexBuffer2)};if(ce){const He=P.stencilModeForClipping(ne).ref;He===0&&P.terrain&&Jt.clear({stencil:0});const _n={func:ie.EQUAL,mask:255};rn.u_alpha_discard_threshold=.8,En(new r.StencilMode(_n,He,255,ie.KEEP,ie.KEEP,ie.INVERT)),rn.u_alpha_discard_threshold=0,En(new r.StencilMode(_n,He,255,ie.KEEP,ie.KEEP,ie.KEEP))}else En(P.stencilModeForClipping(ne))}ce&&(P.resetStencilClippingMasks(),P.terrain&&Jt.clear({stencil:0}))},fill:function(P,m,S,F){const X=S.paint.get("fill-color"),$=S.paint.get("fill-opacity");if($.constantOr(1)===0)return;const ot=P.colorModeForRenderPass(),ct=S.paint.get("fill-pattern"),yt=P.opaquePassEnabledForLayer()&&!ct.constantOr(1)&&X.constantOr(r.Color.transparent).a===1&&$.constantOr(0)===1?"opaque":"translucent";if(P.renderPass===yt){const xt=P.depthModeForSublayer(1,P.renderPass==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly);vh(P,m,S,F,xt,ot,!1)}if(P.renderPass==="translucent"&&S.paint.get("fill-antialias")){const xt=P.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,r.DepthMode.ReadOnly);vh(P,m,S,F,xt,ot,!0)}},"fill-extrusion":function(P,m,S,F){const X=S.paint.get("fill-extrusion-opacity");if(X!==0&&P.renderPass==="translucent"){const $=new r.DepthMode(P.context.gl.LEQUAL,r.DepthMode.ReadWrite,P.depthRangeFor3D);if(X!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))dl(P,m,S,F,$,r.StencilMode.disabled,r.ColorMode.disabled),dl(P,m,S,F,$,P.stencilModeFor3D(),P.colorModeForRenderPass()),P.resetStencilClippingMasks();else{const ot=P.colorModeForRenderPass();dl(P,m,S,F,$,r.StencilMode.disabled,ot)}}},hillshade:function(P,m,S,F){if(P.renderPass!=="offscreen"&&P.renderPass!=="translucent")return;const X=P.context,$=P.depthModeForSublayer(0,r.DepthMode.ReadOnly),ot=P.colorModeForRenderPass(),ct=P.terrain&&P.terrain.renderingToTexture,[yt,xt]=P.renderPass!=="translucent"||ct?[{},F]:P.stencilConfigForOverlap(F);for(const Mt of xt){const Pt=m.getTile(Mt);if(Pt.needsHillshadePrepare&&P.renderPass==="offscreen")Tf(P,Pt,S,$,r.StencilMode.disabled,ot);else if(P.renderPass==="translucent"){const Nt=ct&&P.terrain?P.terrain.stencilModeForRTTOverlap(Mt):yt[Mt.overscaledZ];Qg(P,Mt,Pt,S,$,Nt,ot)}}X.viewport.set([0,0,P.width,P.height]),P.resetStencilClippingMasks()},raster:function(P,m,S,F,X,$){if(P.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!F.length)return;const ot=P.context,ct=ot.gl,yt=m.getSource(),xt=P.useProgram("raster"),Mt=P.colorModeForRenderPass(),Pt=P.terrain&&P.terrain.renderingToTexture,[Nt,Ht]=yt instanceof It||Pt?[{},F]:P.stencilConfigForOverlap(F),Ut=Ht[Ht.length-1].overscaledZ,Bt=!P.options.moving;for(const ae of Ht){const Jt=Pt?r.DepthMode.disabled:P.depthModeForSublayer(ae.overscaledZ-Ut,S.paint.get("raster-opacity")===1?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly,ct.LESS),ie=ae.toUnwrapped(),se=m.getTile(ae);if(Pt&&(!se||!se.hasData()))continue;const ce=Pt?ae.projMatrix:P.transform.calculateProjMatrix(ie,Bt),ne=P.terrain&&Pt?P.terrain.stencilModeForRTTOverlap(ae):Nt[ae.overscaledZ],de=$?0:S.paint.get("raster-fade-duration");se.registerFadeDuration(de);const Ae=m.findLoadedParent(ae,0),Re=Df(se,Ae,m,P.transform,de);let je,Ne;P.terrain&&P.terrain.prepareDrawTile();const cn=S.paint.get("raster-resampling")==="nearest"?ct.NEAREST:ct.LINEAR;ot.activeTexture.set(ct.TEXTURE0),se.texture.bind(cn,ct.CLAMP_TO_EDGE),ot.activeTexture.set(ct.TEXTURE1),Ae?(Ae.texture.bind(cn,ct.CLAMP_TO_EDGE),je=Math.pow(2,Ae.tileID.overscaledZ-se.tileID.overscaledZ),Ne=[se.tileID.canonical.x*je%1,se.tileID.canonical.y*je%1]):se.texture.bind(cn,ct.CLAMP_TO_EDGE);const Se=o0(ce,Ne||[0,0],je||1,Re,S,yt instanceof It?yt.perspectiveTransform:[0,0]);if(P.prepareDrawProgram(ot,xt,ie),yt instanceof It)yt.boundsBuffer&&yt.boundsSegments&&xt.draw(ot,ct.TRIANGLES,Jt,r.StencilMode.disabled,Mt,r.CullFaceMode.disabled,Se,S.id,yt.boundsBuffer,P.quadTriangleIndexBuffer,yt.boundsSegments);else{const{tileBoundsBuffer:un,tileBoundsIndexBuffer:rn,tileBoundsSegments:En}=P.getTileBoundsBuffers(se);xt.draw(ot,ct.TRIANGLES,Jt,ne,Mt,r.CullFaceMode.disabled,Se,S.id,un,rn,En)}}P.resetStencilClippingMasks()},background:function(P,m,S,F){const X=S.paint.get("background-color"),$=S.paint.get("background-opacity");if($===0)return;const ot=P.context,ct=ot.gl,yt=P.transform,xt=yt.tileSize,Mt=S.paint.get("background-pattern");if(P.isPatternMissing(Mt))return;const Pt=!Mt&&X.a===1&&$===1&&P.opaquePassEnabledForLayer()?"opaque":"translucent";if(P.renderPass!==Pt)return;const Nt=r.StencilMode.disabled,Ht=P.depthModeForSublayer(0,Pt==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly),Ut=P.colorModeForRenderPass(),Bt=P.useProgram(Mt?"backgroundPattern":"background");let ae,Jt=F;Jt||(ae=P.getBackgroundTiles(),Jt=Object.values(ae).map(se=>se.tileID)),Mt&&(ot.activeTexture.set(ct.TEXTURE0),P.imageManager.bind(P.context));const ie=S.getCrossfadeParameters();for(const se of Jt){const ce=se.toUnwrapped(),ne=F?se.projMatrix:P.transform.calculateProjMatrix(ce);P.prepareDrawTile();const de=m?m.getTile(se):ae?ae[se.key]:new r.Tile(se,xt,yt.zoom,P),Ae=Mt?Nf(ne,$,P,Mt,{tileID:se,tileSize:xt},ie):s0(ne,$,X);P.prepareDrawProgram(ot,Bt,ce);const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:je,tileBoundsSegments:Ne}=P.getTileBoundsBuffers(de);Bt.draw(ot,ct.TRIANGLES,Ht,Nt,Ut,r.CullFaceMode.disabled,Ae,S.id,Re,je,Ne)}},sky:function(P,m,S){const F=P.transform,X=F.projection.name==="mercator"||F.projection.name==="globe"?1:r.smoothstep(7,8,F.zoom),$=S.paint.get("sky-opacity")*X;if($===0)return;const ot=P.context,ct=S.paint.get("sky-type"),yt=new r.DepthMode(ot.gl.LEQUAL,r.DepthMode.ReadOnly,[0,1]),xt=P.frameCounter/1e3%1;ct==="atmosphere"?P.renderPass==="offscreen"?S.needsSkyboxCapture(P)&&(function(Mt,Pt,Nt,Ht){const Ut=Mt.context,Bt=Ut.gl;let ae=Pt.skyboxFbo;if(!ae){ae=Pt.skyboxFbo=Ut.createFramebuffer(32,32,!1),Pt.skyboxGeometry=new Ac(Ut),Pt.skyboxTexture=Ut.gl.createTexture(),Bt.bindTexture(Bt.TEXTURE_CUBE_MAP,Pt.skyboxTexture),Bt.texParameteri(Bt.TEXTURE_CUBE_MAP,Bt.TEXTURE_WRAP_S,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_CUBE_MAP,Bt.TEXTURE_WRAP_T,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_CUBE_MAP,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR),Bt.texParameteri(Bt.TEXTURE_CUBE_MAP,Bt.TEXTURE_MAG_FILTER,Bt.LINEAR);for(let ce=0;ce<6;++ce)Bt.texImage2D(Bt.TEXTURE_CUBE_MAP_POSITIVE_X+ce,0,Bt.RGBA,32,32,0,Bt.RGBA,Bt.UNSIGNED_BYTE,null)}Ut.bindFramebuffer.set(ae.framebuffer),Ut.viewport.set([0,0,32,32]);const Jt=Pt.getCenter(Mt,!0),ie=Mt.useProgram("skyboxCapture"),se=new Float64Array(16);r.identity(se),r.rotateY(se,se,.5*-Math.PI),Ws(Ut,Pt,ie,se,Jt,0),r.identity(se),r.rotateY(se,se,.5*Math.PI),Ws(Ut,Pt,ie,se,Jt,1),r.identity(se),r.rotateX(se,se,.5*-Math.PI),Ws(Ut,Pt,ie,se,Jt,2),r.identity(se),r.rotateX(se,se,.5*Math.PI),Ws(Ut,Pt,ie,se,Jt,3),r.identity(se),Ws(Ut,Pt,ie,se,Jt,4),r.identity(se),r.rotateY(se,se,Math.PI),Ws(Ut,Pt,ie,se,Jt,5),Ut.viewport.set([0,0,Mt.width,Mt.height])}(P,S),S.markSkyboxValid(P)):P.renderPass==="sky"&&function(Mt,Pt,Nt,Ht,Ut){const Bt=Mt.context,ae=Bt.gl,Jt=Mt.transform,ie=Mt.useProgram("skybox");Bt.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_CUBE_MAP,Pt.skyboxTexture);const se=((ce,ne,de,Ae,Re)=>({u_matrix:ce,u_sun_direction:ne,u_cubemap:0,u_opacity:Ae,u_temporal_offset:Re}))(Jt.skyboxMatrix,Pt.getCenter(Mt,!1),0,Ht,Ut);Mt.prepareDrawProgram(Bt,ie),ie.draw(Bt,ae.TRIANGLES,Nt,r.StencilMode.disabled,Mt.colorModeForRenderPass(),r.CullFaceMode.backCW,se,"skybox",Pt.skyboxGeometry.vertexBuffer,Pt.skyboxGeometry.indexBuffer,Pt.skyboxGeometry.segment)}(P,S,yt,$,xt):ct==="gradient"&&P.renderPass==="sky"&&function(Mt,Pt,Nt,Ht,Ut){const Bt=Mt.context,ae=Bt.gl,Jt=Mt.transform,ie=Mt.useProgram("skyboxGradient");Pt.skyboxGeometry||(Pt.skyboxGeometry=new Ac(Bt)),Bt.activeTexture.set(ae.TEXTURE0);let se=Pt.colorRampTexture;se||(se=Pt.colorRampTexture=new r.Texture(Bt,Pt.colorRamp,ae.RGBA)),se.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const ce=((ne,de,Ae,Re,je)=>({u_matrix:ne,u_color_ramp:0,u_center_direction:de,u_radius:r.degToRad(Ae),u_opacity:Re,u_temporal_offset:je}))(Jt.skyboxMatrix,Pt.getCenter(Mt,!1),Pt.paint.get("sky-gradient-radius"),Ht,Ut);Mt.prepareDrawProgram(Bt,ie),ie.draw(Bt,ae.TRIANGLES,Nt,r.StencilMode.disabled,Mt.colorModeForRenderPass(),r.CullFaceMode.backCW,ce,"skyboxGradient",Pt.skyboxGeometry.vertexBuffer,Pt.skyboxGeometry.indexBuffer,Pt.skyboxGeometry.segment)}(P,S,yt,$,xt)},debug:function(P,m,S){for(let F=0;F<S.length;F++)u0(P,m,S[F])},custom:function(P,m,S){const F=P.context,X=S.implementation;if(P.transform.projection.unsupportedLayers&&P.transform.projection.unsupportedLayers.includes("custom"))r.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(P.renderPass==="offscreen"){const $=X.prerender;$&&(P.setCustomLayerDefaults(),F.setColorMode(P.colorModeForRenderPass()),$.call(X,F.gl,P.transform.customLayerMatrix()),F.setDirty(),P.setBaseState())}else if(P.renderPass==="translucent"){P.setCustomLayerDefaults(),F.setColorMode(P.colorModeForRenderPass()),F.setStencilMode(r.StencilMode.disabled);const $=X.renderingMode==="3d"?new r.DepthMode(P.context.gl.LEQUAL,r.DepthMode.ReadWrite,P.depthRangeFor3D):P.depthModeForSublayer(0,r.DepthMode.ReadOnly);F.setDepthMode($),X.render(F.gl,P.transform.customLayerMatrix()),F.setDirty(),P.setBaseState(),F.bindFramebuffer.set(null)}}};class d0{constructor(m,S){this.context=new St(m),this.transform=S,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=r.SourceCache.maxUnderzooming+r.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ah,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this._tileClippingMaskIDs=new Map,this._skippedStencilTileIDs=new Set}updateTerrain(m,S){const F=!!m&&!!m.terrain&&this.transform.projection.supportsTerrain;if(!(F||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new oo(this,m));const X=this._terrain;this.transform.elevation=F?X:null,X.update(m,this.transform,S)}_updateFog(m){const S=m.fog;if(!S||S.getOpacity(this.transform.pitch)<1||S.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[F,X]=S.getFovAdjustedRange(this.transform._fov);if(F>X)return void(this.transform.fogCullDistSq=null);const $=F+.78*(X-F);this.transform.fogCullDistSq=$*$}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(m,S){if(this.width=m*r.exported.devicePixelRatio,this.height=S*r.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const F of this.style.order)this.style._layers[F].resize()}setup(){const m=this.context,S=new r.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(r.EXTENT,0),S.emplaceBack(0,r.EXTENT),S.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=m.createVertexBuffer(S,r.posAttributes.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);const F=new r.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(r.EXTENT,0),F.emplaceBack(0,r.EXTENT),F.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=m.createVertexBuffer(F,r.posAttributes.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);const X=new r.StructArrayLayout2i4;X.emplaceBack(-1,-1),X.emplaceBack(1,-1),X.emplaceBack(-1,1),X.emplaceBack(1,1),this.viewportBuffer=m.createVertexBuffer(X,r.posAttributes.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);const $=new r.StructArrayLayout4i8;$.emplaceBack(0,0,0,0),$.emplaceBack(r.EXTENT,0,r.EXTENT,0),$.emplaceBack(0,r.EXTENT,0,r.EXTENT),$.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.mercatorBoundsBuffer=m.createVertexBuffer($,r.boundsAttributes.members),this.mercatorBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);const ot=new r.StructArrayLayout3ui6;ot.emplaceBack(0,1,2),ot.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=m.createIndexBuffer(ot);const ct=new r.StructArrayLayout1ui2;for(const xt of[0,1,3,2,0])ct.emplaceBack(xt);this.debugIndexBuffer=m.createIndexBuffer(ct),this.emptyTexture=new r.Texture(m,new r.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),m.gl.RGBA),this.identityMat=r.create();const yt=this.context.gl;this.stencilClearMode=new r.StencilMode({func:yt.ALWAYS,mask:0},0,255,yt.ZERO,yt.ZERO,yt.ZERO),this.loadTimeStamps.push(r.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(m){return m._makeTileBoundsBuffers(this.context,this.transform.projection),m._tileBoundsBuffer?{tileBoundsBuffer:m._tileBoundsBuffer,tileBoundsIndexBuffer:m._tileBoundsIndexBuffer,tileBoundsSegments:m._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const m=this.context,S=m.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear(),this.useProgram("clippingMask").draw(m,S.TRIANGLES,r.DepthMode.disabled,this.stencilClearMode,r.ColorMode.disabled,r.CullFaceMode.disabled,hh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear())}_renderTileClippingMasks(m,S,F){if(!S||this.currentStencilSource===S.id||!m.isTileClipped()||!F||F.length===0)return;const X=[];let $=!1;if(this._tileClippingMaskIDs&&!this.terrain){for(const Mt of F)if(this._tileClippingMaskIDs.has(Mt.key)||($=!0),this._skippedStencilTileIDs.has(Mt.key)){if(!S.getTile(Mt).getBucket(m))continue;this._skippedStencilTileIDs.delete(Mt.key),X.push(Mt)}if(!$&&X.length===0)return}const ot=this.context,ct=ot.gl;ot.setColorMode(r.ColorMode.disabled),ot.setDepthMode(r.DepthMode.disabled);const yt=this.useProgram("clippingMask"),xt=Mt=>{const Pt=S.getTile(Mt),{tileBoundsBuffer:Nt,tileBoundsIndexBuffer:Ht,tileBoundsSegments:Ut}=this.getTileBoundsBuffers(Pt);yt.draw(ot,ct.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:ct.GREATER,mask:255},this._tileClippingMaskIDs.get(Mt.key)||0,255,ct.KEEP,ct.KEEP,ct.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,hh(Mt.projMatrix),"$clipping",Nt,Ht,Ut)};if(!$&&X.length>0)for(const Mt of X)xt(Mt);else{(this._tileClippingMaskIDs.size===0||this.nextStencilID+F.length>256)&&this.clearStencil(),this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear();for(const Mt of F)this._tileClippingMaskIDs.set(Mt.key,this.nextStencilID++),S.getTile(Mt).getBucket(m)?xt(Mt):this._skippedStencilTileIDs.add(Mt.key)}this._skippedStencilTileIDs.size===0&&(this.currentStencilSource=S.id)}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const m=this.nextStencilID++,S=this.context.gl;return new r.StencilMode({func:S.NOTEQUAL,mask:255},m,255,S.KEEP,S.KEEP,S.REPLACE)}stencilModeForClipping(m){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(m);const S=this.context.gl;return new r.StencilMode({func:S.EQUAL,mask:255},this._tileClippingMaskIDs.get(m.key)||0,0,S.KEEP,S.KEEP,S.REPLACE)}stencilConfigForOverlap(m){const S=this.context.gl,F=m.sort((ot,ct)=>ct.overscaledZ-ot.overscaledZ),X=F[F.length-1].overscaledZ,$=F[0].overscaledZ-X+1;if($>1){this.currentStencilSource=void 0,this.nextStencilID+$>256&&this.clearStencil();const ot={};for(let ct=0;ct<$;ct++)ot[ct+X]=new r.StencilMode({func:S.GEQUAL,mask:255},ct+this.nextStencilID,255,S.KEEP,S.KEEP,S.REPLACE);return this.nextStencilID+=$,[ot,F]}return[{[X]:r.StencilMode.disabled},F]}colorModeForRenderPass(){const m=this.context.gl;return this._showOverdrawInspector?new r.ColorMode([m.CONSTANT_COLOR,m.ONE],new r.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.ColorMode.unblended:r.ColorMode.alphaBlended}depthModeForSublayer(m,S,F){if(!this.opaquePassEnabledForLayer())return r.DepthMode.disabled;const X=1-((1+this.currentLayer)*this.numSublayers+m)*this.depthEpsilon;return new r.DepthMode(F||this.context.gl.LEQUAL,S,[X,X])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(m,S){this.style=m,this.options=S,this.lineAtlas=m.lineAtlas,this.imageManager=m.imageManager,this.glyphManager=m.glyphManager,this.symbolFadeChange=m.placement.symbolFadeChange(r.exported.now()),this.imageManager.beginFrame();const F=this.style.order,X=this.style._sourceCaches;for(const xt in X){const Mt=X[xt];Mt.used&&Mt.prepare(this.context)}const $={},ot={},ct={};for(const xt in X){const Mt=X[xt];$[xt]=Mt.getVisibleCoordinates(),ot[xt]=$[xt].slice().reverse(),ct[xt]=Mt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let xt=0;xt<F.length;xt++)if(this.style._layers[F[xt]].is3D()){this.opaquePassCutoff=xt;break}if(this.terrain&&(this.terrain.updateTileBinding(ct),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.GlobeSharedBuffers(this.context)),!r.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const xt of F){const Mt=this.style._layers[xt],Pt=m._getLayerSourceCache(Mt);if(!Mt.hasOffscreenPass()||Mt.isHidden(this.transform.zoom))continue;const Nt=Pt?ot[Pt.id]:void 0;(Mt.type==="custom"||Mt.isSky()||Nt&&Nt.length)&&this.renderLayer(this,Pt,Mt,Nt)}this.depthRangeFor3D=[0,1-(m.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let yt=r.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(yt=this.style.fog.properties.get("color")),this.context.clear({color:S.showOverdrawInspector?r.Color.black:yt,depth:1}),this.clearStencil(),this._showOverdrawInspector=S.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const xt=this.style._layers[F[this.currentLayer]],Mt=m._getLayerSourceCache(xt);if(xt.isSky())continue;const Pt=Mt?ot[Mt.id]:void 0;this._renderTileClippingMasks(xt,Mt,Pt),this.renderLayer(this,Mt,xt,Pt)}if(this.renderPass="sky",(r.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const xt=this.style._layers[F[this.currentLayer]],Mt=m._getLayerSourceCache(xt);xt.isSky()&&this.renderLayer(this,Mt,xt,Mt?ot[Mt.id]:void 0)}for(this.transform.projection.name==="globe"&&function(xt){const Mt=xt.context,Pt=Mt.gl,Nt=xt.transform,Ht=new r.DepthMode(Pt.LEQUAL,r.DepthMode.ReadOnly,[0,1]),Ut=xt.useProgram("globeAtmosphere"),Bt=Nt.centerOffset,ae=Nt._camera.getCameraToClipPerspective(Nt._fov,Nt.width/Nt.height,Nt._nearZ,Nt._farZ);ae[8]=2*-Bt.x/Nt.width,ae[9]=2*Bt.y/Nt.height;const Jt=r.invert([],ae),ie=r.mul([],Jt,Nt.projMatrix),se={u_frustum_tl:qs([-1,1,1],Jt),u_frustum_tr:qs([1,1,1],Jt),u_frustum_br:qs([1,-1,1],Jt),u_frustum_bl:qs([-1,-1,1],Jt),u_globe_pos:qs([Nt.globeMatrix[12],Nt.globeMatrix[13],Nt.globeMatrix[14]],ie),u_globe_radius:Nt.worldSize/2/Math.PI-1,u_opacity:1-r.globeToMercatorTransition(Nt.zoom),u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};xt.prepareDrawProgram(Mt,Ut);const ce=xt.globeSharedBuffers;ce&&Ut.draw(Mt,Pt.TRIANGLES,Ht,r.StencilMode.disabled,r.ColorMode.alphaBlended,r.CullFaceMode.backCW,se,"skybox",ce.atmosphereVertexBuffer,ce.atmosphereIndexBuffer,ce.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<F.length;){const xt=this.style._layers[F[this.currentLayer]],Mt=m._getLayerSourceCache(xt);if(xt.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(xt)){if(xt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Pt=Mt?(xt.type==="symbol"?ct:ot)[Mt.id]:void 0;this._renderTileClippingMasks(xt,Mt,Mt?$[Mt.id]:void 0),this.renderLayer(this,Mt,xt,Pt),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let xt=null;r.values(this.style._layers).forEach(Mt=>{const Pt=m._getLayerSourceCache(Mt);Pt&&!Mt.isHidden(this.transform.zoom)&&(!xt||xt.getSource().maxzoom<Pt.getSource().maxzoom)&&(xt=Pt)}),xt&&this.options.showTileBoundaries&&jf.debug(this,xt,xt.getVisibleCoordinates())}this.options.showPadding&&function(xt){const Mt=xt.transform.padding;yn(xt,xt.transform.height-(Mt.top||0),3,Uf),yn(xt,Mt.bottom||0,3,Vf),Ao(xt,Mt.left||0,3,c0),Ao(xt,xt.transform.width-(Mt.right||0),3,xh);const Pt=xt.transform.centerPoint;(function(Nt,Ht,Ut,Bt){Mc(Nt,Ht-1,Ut-10,2,20,Bt),Mc(Nt,Ht-10,Ut-1,20,2,Bt)})(xt,Pt.x,xt.transform.height-Pt.y,_h)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(r.window.performance.now()),this.saveCanvasCopy())}renderLayer(m,S,F,X){F.isHidden(this.transform.zoom)||(F.type==="background"||F.type==="sky"||F.type==="custom"||X&&X.length)&&(this.id=F.id,this.gpuTimingStart(F),m.transform.projection.unsupportedLayers&&m.transform.projection.unsupportedLayers.includes(F.type)||jf[F.type](m,S,F,X,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(m){if(!this.options.gpuTiming)return;const S=this.context.extTimerQuery;let F=this.gpuTimers[m.id];F||(F=this.gpuTimers[m.id]={calls:0,cpuTime:0,query:S.createQueryEXT()}),F.calls++,S.beginQueryEXT(S.TIME_ELAPSED_EXT,F.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;m.endQueryEXT(m.TIME_ELAPSED_EXT)}collectGpuTimers(){const m=this.gpuTimers;return this.gpuTimers={},m}queryGpuTimers(m){const S={};for(const F in m){const X=m[F],$=this.context.extTimerQuery,ot=$.getQueryObjectEXT(X.query,$.QUERY_RESULT_EXT)/1e6;$.deleteQueryEXT(X.query),S[F]=ot}return S}translatePosMatrix(m,S,F,X,$){if(!F[0]&&!F[1])return m;const ot=$?X==="map"?this.transform.angle:0:X==="viewport"?-this.transform.angle:0;if(ot){const xt=Math.sin(ot),Mt=Math.cos(ot);F=[F[0]*Mt-F[1]*xt,F[0]*xt+F[1]*Mt]}const ct=[$?F[0]:ut(S,F[0],this.transform.zoom),$?F[1]:ut(S,F[1],this.transform.zoom),0],yt=new Float32Array(16);return r.translate(yt,m,ct),yt}saveTileTexture(m){const S=this._tileTextures[m.size[0]];S?S.push(m):this._tileTextures[m.size[0]]=[m]}getTileTexture(m){const S=this._tileTextures[m];return S&&S.length>0?S.pop():null}isPatternMissing(m){if(!m)return!1;if(!m.from||!m.to)return!0;const S=this.imageManager.getPattern(m.from.toString()),F=this.imageManager.getPattern(m.to.toString());return!S||!F}currentGlobalDefines(){const m=this.terrain&&this.terrain.renderingToTexture,S=this.style&&this.style.fog,F=[];return this.terrain&&!this.terrain.renderingToTexture&&F.push("TERRAIN"),S&&!m&&S.getOpacity(this.transform.pitch)!==0&&F.push("FOG"),m&&F.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&F.push("OVERDRAW_INSPECTOR"),F}useProgram(m,S,F){this.cache=this.cache||{};const X=F||[],$=this.currentGlobalDefines().concat(X),ot=vc.cacheKey(m,$,S);return this.cache[ot]||(this.cache[ot]=new vc(this.context,m,gc[m],S,Mr[m],$)),this.cache[ot]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const m=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(m.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(m,S,F){if(this.terrain&&this.terrain.renderingToTexture)return;const X=this.style.fog;if(X){const $=X.getOpacity(this.transform.pitch);$!==0&&S.setFogUniformValues(m,((ot,ct,yt,xt)=>{const Mt=ct.properties.get("color"),Pt=ot.frameCounter/1e3%1,Nt=[Mt.r/Mt.a,Mt.g/Mt.a,Mt.b/Mt.a,xt];return{u_fog_matrix:yt?ot.transform.calculateFogTileMatrix(yt):ot.identityMat,u_fog_range:ct.getFovAdjustedRange(ot.transform._fov),u_fog_color:Nt,u_fog_horizon_blend:ct.properties.get("horizon-blend"),u_fog_temporal_offset:Pt}})(this,X,F,$))}}setTileLoadedFlag(m){this.tileLoaded=m}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const m=this.context.gl,S=m.createTexture();return m.bindTexture(m.TEXTURE_2D,S),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,0,0,m.drawingBufferWidth,m.drawingBufferHeight,0),S}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const m=this.style&&this.style.fog;return!!m&&m.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const m=this._backgroundTiles,S=this._backgroundTiles={},F=this.transform.coveringTiles({tileSize:512});for(const X of F)S[X.key]=m[X.key]||new r.Tile(X,512,this.transform.tileZoom,this);return S}clearBackgroundTiles(){this._backgroundTiles={}}}class Xs{constructor(m=0,S=0,F=0,X=0){if(isNaN(m)||m<0||isNaN(S)||S<0||isNaN(F)||F<0||isNaN(X)||X<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=m,this.bottom=S,this.left=F,this.right=X}interpolate(m,S,F){return S.top!=null&&m.top!=null&&(this.top=r.number(m.top,S.top,F)),S.bottom!=null&&m.bottom!=null&&(this.bottom=r.number(m.bottom,S.bottom,F)),S.left!=null&&m.left!=null&&(this.left=r.number(m.left,S.left,F)),S.right!=null&&m.right!=null&&(this.right=r.number(m.right,S.right,F)),this}getCenter(m,S){const F=r.clamp((this.left+m-this.right)/2,0,m),X=r.clamp((this.top+S-this.bottom)/2,0,S);return new r.pointGeometry(F,X)}equals(m){return this.top===m.top&&this.bottom===m.bottom&&this.left===m.left&&this.right===m.right}clone(){return new Xs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function f0(P,m){const S=r.getColumn(P,3);r.fromQuat(P,m),r.setColumn(P,3,S)}function Gf(P,m){const S=r.identity$1([]);return r.rotateZ$1(S,S,-m),r.rotateX$1(S,S,-P),S}function wh(P,m){const S=[P[0],P[1],0],F=[m[0],m[1],0];if(r.length(S)>=1e-15){const ot=r.normalize([],S);r.scale$2(F,ot,r.dot(F,ot)),m[0]=F[0],m[1]=F[1]}const X=r.cross([],m,P);if(r.len(X)<1e-15)return null;const $=Math.atan2(-X[1],X[0]);return Gf(Math.atan2(Math.sqrt(P[0]*P[0]+P[1]*P[1]),-P[2]),$)}class Sc{constructor(m,S){this.position=m,this.orientation=S}get position(){return this._position}set position(m){if(m){const S=m instanceof r.MercatorCoordinate?m:new r.MercatorCoordinate(m[0],m[1],m[2]);this._renderWorldCopies&&(S.x=r.wrap(S.x,0,1)),this._position=S}else this._position=null}lookAtPoint(m,S){if(this.orientation=null,!this.position)return;const F=this._elevation?this._elevation.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(m)):0,X=this.position,$=r.MercatorCoordinate.fromLngLat(m,F),ot=[$.x-X.x,$.y-X.y,$.z-X.z];S||(S=[0,0,1]),S[2]=Math.abs(S[2]),this.orientation=wh(ot,S)}setPitchBearing(m,S){this.orientation=Gf(r.degToRad(m),r.degToRad(-S))}}class Ec{constructor(m,S){this._transform=r.identity([]),this.orientation=S,this.position=m}get mercatorPosition(){const m=this.position;return new r.MercatorCoordinate(m[0],m[1],m[2])}get position(){const m=r.getColumn(this._transform,3);return[m[0],m[1],m[2]]}set position(m){var S;m&&r.setColumn(this._transform,3,[(S=m)[0],S[1],S[2],1])}get orientation(){return this._orientation}set orientation(m){this._orientation=m||r.identity$1([]),m&&f0(this._transform,this._orientation)}getPitchBearing(){const m=this.forward(),S=this.right();return{bearing:Math.atan2(-S[1],S[0]),pitch:Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2])}}setPitchBearing(m,S){this._orientation=Gf(m,S),f0(this._transform,this._orientation)}forward(){const m=r.getColumn(this._transform,2);return[-m[0],-m[1],-m[2]]}up(){const m=r.getColumn(this._transform,1);return[-m[0],-m[1],-m[2]]}right(){const m=r.getColumn(this._transform,0);return[m[0],m[1],m[2]]}getCameraToWorld(m,S){const F=new Float64Array(16);return r.invert(F,this.getWorldToCamera(m,S)),F}getWorldToCameraPosition(m,S,F){const X=this.position;r.scale$2(X,X,-m);const $=new Float64Array(16);return r.fromScaling($,[F,F,F]),r.translate($,$,X),$[10]*=S,$}getWorldToCamera(m,S){const F=new Float64Array(16),X=new Float64Array(4),$=this.position;return r.conjugate(X,this._orientation),r.scale$2($,$,-m),r.fromQuat(F,X),r.translate(F,F,$),F[1]*=-1,F[5]*=-1,F[9]*=-1,F[13]*=-1,F[8]*=S,F[9]*=S,F[10]*=S,F[11]*=S,F}getCameraToClipPerspective(m,S,F,X){const $=new Float64Array(16);return r.perspective($,m,S,F,X),$}getDistanceToElevation(m){const S=m===0?0:r.mercatorZfromAltitude(m,this.position[1]),F=this.forward();return(S-this.position[2])/F[2]}clone(){return new Ec([...this.position],[...this.orientation])}}function Hf(P,m){const S=Tc(P),F=function($,ot,ct,yt,xt){const Mt=new r.LngLat(ct.lng-180*Ys,ct.lat),Pt=new r.LngLat(ct.lng+180*Ys,ct.lat),Nt=$.project(Mt.lng,Mt.lat),Ht=$.project(Pt.lng,Pt.lat),Ut=-Math.atan2(Ht.y-Nt.y,Ht.x-Nt.x),Bt=r.MercatorCoordinate.fromLngLat(ct);Bt.y=r.clamp(Bt.y,-.999975,.999975);const ae=Bt.toLngLat(),Jt=$.project(ae.lng,ae.lat),ie=r.MercatorCoordinate.fromLngLat(ae);ie.x+=Ys;const se=ie.toLngLat(),ce=$.project(se.lng,se.lat),ne=Xf(ce.x-Jt.x,ce.y-Jt.y,Ut),de=r.MercatorCoordinate.fromLngLat(ae);de.y+=Ys;const Ae=de.toLngLat(),Re=$.project(Ae.lng,Ae.lat),je=Xf(Re.x-Jt.x,Re.y-Jt.y,Ut),Ne=Math.abs(ne.x)/Math.abs(je.y),cn=r.identity([]);r.rotateZ(cn,cn,-Ut*(1-(xt?0:yt)));const Se=r.identity([]);return r.scale(Se,Se,[1,1-(1-Ne)*yt,1]),Se[4]=-je.x/je.y*yt,r.rotateZ(Se,Se,Ut),r.multiply$1(Se,cn,Se),Se}(P.projection,0,P.center,S,m),X=Wf(P);return r.scale(F,F,[X,X,1]),F}function Wf(P){const m=P.projection,S=Tc(P),F=qf(m,P.center),X=qf(m,r.LngLat.convert(m.center));return Math.pow(2,F*S+(1-S)*X)}function Tc(P){const m=P.projection.range;if(!m)return 0;const S=Math.max(P.width,P.height),F=Math.log(S/1024)/Math.LN2;return r.smoothstep(m[0]+F,m[1]+F,P.zoom)}const Ys=1/4e4;function qf(P,m){const S=r.clamp(m.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),F=new r.LngLat(m.lng-180*Ys,S),X=new r.LngLat(m.lng+180*Ys,S),$=P.project(F.lng,S),ot=P.project(X.lng,S),ct=r.MercatorCoordinate.fromLngLat(F),yt=r.MercatorCoordinate.fromLngLat(X),xt=ot.x-$.x,Mt=ot.y-$.y,Pt=yt.x-ct.x,Nt=yt.y-ct.y,Ht=Math.sqrt((Pt*Pt+Nt*Nt)/(xt*xt+Mt*Mt));return Math.log(Ht)/Math.LN2}function Xf(P,m,S){const F=Math.cos(S),X=Math.sin(S);return{x:P*F-m*X,y:P*X+m*F}}class Mh{constructor(m,S,F,X,$,ot,ct){this.tileSize=512,this._renderWorldCopies=$===void 0||$,this._minZoom=m||0,this._maxZoom=S||22,this._minPitch=F==null?0:F,this._maxPitch=X==null?60:X,this.setProjection(ot),this.setMaxBounds(ct),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Xs,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ec,this._centerAltitude=0,this._centerAltitudeValidForExaggeration=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const m=new Mh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return m._elevation=this._elevation,m._centerAltitude=this._centerAltitude,m._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,m.tileSize=this.tileSize,m.width=this.width,m.height=this.height,m.cameraElevationReference=this.cameraElevationReference,m._center=this._center,m._setZoom(this.zoom),m._seaLevelZoom=this._seaLevelZoom,m.angle=this.angle,m._fov=this._fov,m._pitch=this._pitch,m._nearZ=this._nearZ,m._farZ=this._farZ,m._averageElevation=this._averageElevation,m._unmodified=this._unmodified,m._edgeInsets=this._edgeInsets.clone(),m._camera=this._camera.clone(),m._calcMatrices(),m.freezeTileCoverage=this.freezeTileCoverage,m}get elevation(){return this._elevation}set elevation(m){this._elevation!==m&&(this._elevation=m,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(m){const S=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||S)&&this._updateCameraOnTerrain(),(m||S)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return r.pick(this.projection,["name","center","parallels"])}setProjection(m){m==null&&(m={name:"mercator"}),this.projectionOptions=m;const S=this.projection?this.getProjection():void 0;this.projection=r.getProjection(m);const F=this.getProjection();return f(S,F)?null:(this._calcMatrices(),F)}get minZoom(){return this._minZoom}set minZoom(m){this._minZoom!==m&&(this._minZoom=m,this.zoom=Math.max(this.zoom,m))}get maxZoom(){return this._maxZoom}set maxZoom(m){this._maxZoom!==m&&(this._maxZoom=m,this.zoom=Math.min(this.zoom,m))}get minPitch(){return this._minPitch}set minPitch(m){this._minPitch!==m&&(this._minPitch=m,this.pitch=Math.max(this.pitch,m))}get maxPitch(){return this._maxPitch}set maxPitch(m){this._maxPitch!==m&&(this._maxPitch=m,this.pitch=Math.min(this.pitch,m))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(m){m===void 0?m=!0:m===null&&(m=!1),this._renderWorldCopies=m}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const m=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(m))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.pointGeometry(this.width,this.height)}get bearing(){return r.wrap(this.rotation,-180,180)}set bearing(m){this.rotation=m}get rotation(){return-this.angle/Math.PI*180}set rotation(m){const S=-m*Math.PI/180;var F;this.angle!==S&&(this._unmodified=!1,this.angle=S,this._calcMatrices(),this.rotationMatrix=(F=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(F[1]=0,F[2]=0),F[0]=1,F[3]=1,F),function(X,$,ot){var ct=$[0],yt=$[1],xt=$[2],Mt=$[3],Pt=Math.sin(ot),Nt=Math.cos(ot);X[0]=ct*Nt+xt*Pt,X[1]=yt*Nt+Mt*Pt,X[2]=ct*-Pt+xt*Nt,X[3]=yt*-Pt+Mt*Nt}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(m){const S=r.clamp(m,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==S&&(this._unmodified=!1,this._pitch=S,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(m){m=Math.max(.01,Math.min(60,m)),this._fov!==m&&(this._unmodified=!1,this._fov=m/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(m){this._averageElevation=m,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(m){const S=Math.min(Math.max(m,this.minZoom),this.maxZoom);this._zoom!==S&&(this._unmodified=!1,this._setZoom(S),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(m){this._zoom=m,this.scale=this.zoomScale(m),this.tileZoom=Math.floor(m),this.zoomFraction=m-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=0);const m=this._elevation;this._centerAltitude=m.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=m.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const m=this._elevation,S=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],F=this.horizonLineFromTop();let X=0,$=0;for(let ot=0;ot<S.length;ot++){const ct=new r.pointGeometry(S[ot][0]*this.width,F+S[ot][1]*(this.height-F)),yt=m.pointCoordinate(ct);if(!yt)continue;const xt=1/Math.hypot(yt[0]-this._camera.position[0],yt[1]-this._camera.position[1]);X+=yt[3]*xt,$+=xt}return $===0?NaN:X/$}get center(){return this._center}set center(m){m.lat===this._center.lat&&m.lng===this._center.lng||(this._unmodified=!1,this._center=m,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const m=this._seaLevelZoom,S=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),F=this.pixelsPerMeter/this.worldSize*S,X=this._mercatorZfromZoom(m),$=this._mercatorZfromZoom(this._maxZoom),ot=Math.max(X-F,$);this._setZoom(this._zoomFromMercatorZ(ot))}get padding(){return this._edgeInsets.toJSON()}set padding(m){this._edgeInsets.equals(m)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,m,1),this._calcMatrices())}computeZoomRelativeTo(m){const S=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,m.toAltitude()));let F;F=m.z<this._camera.position[2]?[S.x,S.y,S.z]:[m.x,m.y,m.z];const X=r.length(r.sub([],this._camera.position,F));return r.clamp(this._zoomFromMercatorZ(X),this._minZoom,this._maxZoom)}setFreeCameraOptions(m){if(!this.height||!m.position&&!m.orientation)return;this._updateCameraState();let S=!1;if(m.orientation&&!r.exactEquals(m.orientation,this._camera.orientation)&&(S=this._setCameraOrientation(m.orientation)),m.position){const F=[m.position.x,m.position.y,m.position.z];r.exactEquals$1(F,this._camera.position)||(this._setCameraPosition(F),S=!0)}S&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const m=this._camera.position,S=new Sc;return S.position=new r.MercatorCoordinate(m[0],m[1],m[2]),S.orientation=this._camera.orientation,S._elevation=this.elevation,S._renderWorldCopies=this.renderWorldCopies,S}_setCameraOrientation(m){if(!r.length$1(m))return!1;r.normalize$1(m,m);const S=r.transformQuat([],[0,0,-1],m),F=r.transformQuat([],[0,-1,0],m);if(F[2]<0)return!1;const X=wh(S,F);return!!X&&(this._camera.orientation=X,!0)}_setCameraPosition(m){const S=this.zoomScale(this.minZoom)*this.tileSize,F=this.zoomScale(this.maxZoom)*this.tileSize,X=this.cameraToCenterDistance;m[2]=r.clamp(m[2],X/F,X/S),this._camera.position=m}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(m){return this._edgeInsets.equals(m)}interpolatePadding(m,S,F){this._unmodified=!1,this._edgeInsets.interpolate(m,S,F),this._constrain(),this._calcMatrices()}coveringZoomLevel(m){const S=(m.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/m.tileSize));return Math.max(0,S)}getVisibleUnwrappedCoordinates(m){const S=[new r.UnwrappedTileID(0,m)];if(this.renderWorldCopies){const F=this.pointCoordinate(new r.pointGeometry(0,0)),X=this.pointCoordinate(new r.pointGeometry(this.width,0)),$=this.pointCoordinate(new r.pointGeometry(this.width,this.height)),ot=this.pointCoordinate(new r.pointGeometry(0,this.height)),ct=Math.floor(Math.min(F.x,X.x,$.x,ot.x)),yt=Math.floor(Math.max(F.x,X.x,$.x,ot.x)),xt=1;for(let Mt=ct-xt;Mt<=yt+xt;Mt++)Mt!==0&&S.push(new r.UnwrappedTileID(Mt,m))}return S}coveringTiles(m){let S=this.coveringZoomLevel(m);const F=S,X=this.elevation&&!m.isTerrainDEM,$=this.projection.name==="mercator";if(m.minzoom!==void 0&&S<m.minzoom)return[];m.maxzoom!==void 0&&S>m.maxzoom&&(S=m.maxzoom);const ot=this.locationCoordinate(this.center),ct=this.center.lat,yt=1<<S,xt=[yt*ot.x,yt*ot.y,0],Mt=this.projection.name==="globe",Pt=!Mt,Nt=r.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,S,Pt),Ht=Mt?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ut=yt*r.mercatorZfromAltitude(1,this.center.lat),Bt=this._camera.position[2]/r.mercatorZfromAltitude(1,this.center.lat),ae=[yt*Ht.x,yt*Ht.y,Bt*(Pt?1:Ut)],Jt=this.cameraToCenterDistance/m.tileSize*(m.roundZoom?1:.502),ie=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?S:0,se=m.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ce=m.isTerrainDEM?-se:this._elevation?this._elevation.getMinElevationBelowMSL():0,ne=this.projection.isReprojectedInTileSpace?Wf(this):1,de=He=>{const Fn=new r.MercatorCoordinate(He.x+25e-6,He.y,He.z),Mn=new r.MercatorCoordinate(He.x,He.y+25e-6,He.z),An=He.toLngLat(),Vn=Fn.toLngLat(),ir=Mn.toLngLat(),Bn=this.locationCoordinate(An),Gn=this.locationCoordinate(Vn),gr=this.locationCoordinate(ir),Vr=Math.hypot(Gn.x-Bn.x,Gn.y-Bn.y),Pi=Math.hypot(gr.x-Bn.x,gr.y-Bn.y);return Math.sqrt(Vr*Pi)*ne/25e-6},Ae=He=>{const _n=se,Fn=ce;return{aabb:r.tileAABB(this,yt,0,0,0,He,Fn,_n,this.projection),zoom:0,x:0,y:0,minZ:Fn,maxZ:_n,wrap:He,fullyVisible:!1}},Re=[];let je=[];const Ne=S,cn=m.reparseOverscaled?F:S,Se=He=>He*He,un=Se((Bt-this._centerAltitude)*Ut),rn=He=>{if(!this._elevation||!He.tileID||!$)return;const _n=this._elevation.getMinMaxForTile(He.tileID),Fn=He.aabb;_n?(Fn.min[2]=_n.min,Fn.max[2]=_n.max,Fn.center[2]=(Fn.min[2]+Fn.max[2])/2):(He.shouldSplit=En(He),He.shouldSplit||(Fn.min[2]=Fn.max[2]=Fn.center[2]=this._centerAltitude))},En=He=>{if(He.zoom<ie)return!0;if(He.zoom===Ne)return!1;if(He.shouldSplit!=null)return He.shouldSplit;const _n=He.aabb.distanceX(ae),Fn=He.aabb.distanceY(ae);let Mn=un,An=1;if(Mt){Mn=Se(He.aabb.distanceZ(ae));const ir=Math.pow(2,He.zoom),Bn=r.latFromMercatorY((He.y+1)/ir),Gn=r.latFromMercatorY(He.y/ir),gr=Math.min(Math.max(ct,Bn),Gn),Vr=r.circumferenceAtLatitude(gr)/r.circumferenceAtLatitude(ct);An=Math.min(Vr,1)}else if(X&&(Mn=Se(He.aabb.distanceZ(ae)*Ut)),this.projection.isReprojectedInTileSpace&&F<=5){const ir=Math.pow(2,He.zoom),Bn=de(new r.MercatorCoordinate((He.x+.5)/ir,(He.y+.5)/ir));An=Bn>.85?1:Bn}const Vn=_n*_n+Fn*Fn+Mn;return Vn<Se((1<<Ne-He.zoom)*Jt*An*((ir,Bn)=>{if(Bn*Se(.707)<ir)return 1;const Gn=Math.sqrt(Bn/ir);return Gn/(1.4144271570014144+(Math.pow(1.1,Gn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Mn,un),Vn))};if(this.renderWorldCopies)for(let He=1;He<=3;He++)Re.push(Ae(-He)),Re.push(Ae(He));for(Re.push(Ae(0));Re.length>0;){const He=Re.pop(),_n=He.x,Fn=He.y;let Mn=He.fullyVisible;if(!Mn){const An=He.aabb.intersects(Nt);if(An===0)continue;Mn=An===2}if(He.zoom!==Ne&&En(He))for(let An=0;An<4;An++){const Vn=(_n<<1)+An%2,ir=(Fn<<1)+(An>>1),Bn={aabb:$?He.aabb.quadrant(An):r.tileAABB(this,yt,He.zoom+1,Vn,ir,He.wrap,He.minZ,He.maxZ,this.projection),zoom:He.zoom+1,x:Vn,y:ir,wrap:He.wrap,fullyVisible:Mn,tileID:void 0,shouldSplit:void 0,minZ:He.minZ,maxZ:He.maxZ};X&&!Mt&&(Bn.tileID=new r.OverscaledTileID(He.zoom+1===Ne?cn:He.zoom+1,He.wrap,He.zoom+1,Vn,ir),rn(Bn)),Re.push(Bn)}else{const An=He.zoom===Ne?cn:He.zoom;if(m.minzoom&&m.minzoom>An)continue;const Vn=xt[0]-(.5+_n+(He.wrap<<He.zoom))*(1<<S-He.zoom),ir=xt[1]-.5-Fn,Bn=He.tileID?He.tileID:new r.OverscaledTileID(An,He.wrap,He.zoom,_n,Fn);je.push({tileID:Bn,distanceSq:Vn*Vn+ir*ir})}}if(this.fogCullDistSq){const He=this.fogCullDistSq,_n=this.horizonLineFromTop();je=je.filter(Fn=>{const Mn=[0,0,0,1],An=[r.EXTENT,r.EXTENT,0,1],Vn=this.calculateFogTileMatrix(Fn.tileID.toUnwrapped());r.transformMat4$1(Mn,Mn,Vn),r.transformMat4$1(An,An,Vn);const ir=r.getAABBPointSquareDist(Mn,An);if(ir===0)return!0;let Bn=!1;const Gn=this._elevation;if(Gn&&ir>He&&_n!==0){const gr=this.calculateProjMatrix(Fn.tileID.toUnwrapped());let Vr;m.isTerrainDEM||(Vr=Gn.getMinMaxForTile(Fn.tileID)),Vr||(Vr={min:ce,max:se});const Pi=r.furthestTileCorner(this.rotation),Di=[Pi[0]*r.EXTENT,Pi[1]*r.EXTENT,Vr.max];r.transformMat4(Di,Di,gr),Bn=(1-Di[1])*this.height*.5<_n}return ir<He||Bn})}return je.sort((He,_n)=>He.distanceSq-_n.distanceSq).map(He=>He.tileID)}resize(m,S){this.width=m,this.height=S,this.pixelsToGLUnits=[2/m,-2/S],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(m){return Math.pow(2,m)}scaleZoom(m){return Math.log(m)/Math.LN2}project(m){const S=r.clamp(m.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),F=this.projection.project(m.lng,S);return new r.pointGeometry(F.x*this.worldSize,F.y*this.worldSize)}unproject(m){return this.projection.unproject(m.x/this.worldSize,m.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(m,S){let F,X;const $=this.centerPoint;if(this.projection.name==="globe"){const ct=this.worldSize;F=(S.x-$.x)/ct,X=(S.y-$.y)/ct}else{const ct=this.pointCoordinate(S),yt=this.pointCoordinate($);F=ct.x-yt.x,X=ct.y-yt.y}const ot=this.locationCoordinate(m);this.setLocation(new r.MercatorCoordinate(ot.x-F,ot.y-X))}setLocation(m){this.center=this.coordinateLocation(m),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(m){return this.projection.locationPoint(this,m)}locationPoint3D(m){return this._coordinatePoint(this.locationCoordinate(m),!0)}pointLocation(m){return this.coordinateLocation(this.pointCoordinate(m))}pointLocation3D(m){return this.coordinateLocation(this.pointCoordinate3D(m))}locationCoordinate(m,S){const F=S?r.mercatorZfromAltitude(S,m.lat):void 0,X=this.projection.project(m.lng,m.lat);return new r.MercatorCoordinate(X.x,X.y,F)}coordinateLocation(m){return this.projection.unproject(m.x,m.y)}pointRayIntersection(m,S){const F=S!=null?S:this._centerAltitude,X=[m.x,m.y,0,1],$=[m.x,m.y,1,1];r.transformMat4$1(X,X,this.pixelMatrixInverse),r.transformMat4$1($,$,this.pixelMatrixInverse);const ot=$[3];r.scale$1(X,X,1/X[3]),r.scale$1($,$,1/ot);const ct=X[2],yt=$[2];return{p0:X,p1:$,t:ct===yt?0:(F-ct)/(yt-ct)}}screenPointToMercatorRay(m){const S=[m.x,m.y,0,1],F=[m.x,m.y,1,1];return r.transformMat4$1(S,S,this.pixelMatrixInverse),r.transformMat4$1(F,F,this.pixelMatrixInverse),r.scale$1(S,S,1/S[3]),r.scale$1(F,F,1/F[3]),S[2]=r.mercatorZfromAltitude(S[2],this._center.lat)*this.worldSize,F[2]=r.mercatorZfromAltitude(F[2],this._center.lat)*this.worldSize,r.scale$1(S,S,1/this.worldSize),r.scale$1(F,F,1/this.worldSize),new r.Ray([S[0],S[1],S[2]],r.normalize([],r.sub([],F,S)))}rayIntersectionCoordinate(m){const{p0:S,p1:F,t:X}=m,$=r.mercatorZfromAltitude(S[2],this._center.lat),ot=r.mercatorZfromAltitude(F[2],this._center.lat);return new r.MercatorCoordinate(r.number(S[0],F[0],X)/this.worldSize,r.number(S[1],F[1],X)/this.worldSize,r.number($,ot,X))}pointCoordinate(m,S=this._centerAltitude){return this.projection.pointCoordinate(this,m.x,m.y,S)}pointCoordinate3D(m){if(!this.elevation)return this.pointCoordinate(m);const S=this.elevation;let F=this.elevation.pointCoordinate(m);if(F)return new r.MercatorCoordinate(F[0],F[1],F[2]);let X=0,$=this.horizonLineFromTop();if(m.y>$)return this.pointCoordinate(m);const ot=.02*$,ct=m.clone();for(let yt=0;yt<10&&$-X>ot;yt++){ct.y=r.number(X,$,.66);const xt=S.pointCoordinate(ct);xt?($=ct.y,F=xt):X=ct.y}return F?new r.MercatorCoordinate(F[0],F[1],F[2]):this.pointCoordinate(m)}isPointAboveHorizon(m){if(this.elevation)return!this.elevation.pointCoordinate(m);{const S=this.horizonLineFromTop();return m.y<S}}_coordinatePoint(m,S){const F=S&&this.elevation?this.elevation.getAtPointOrZero(m,this._centerAltitude):this._centerAltitude,X=[m.x*this.worldSize,m.y*this.worldSize,F+m.toAltitude(),1];return r.transformMat4$1(X,X,this.pixelMatrix),X[3]>0?new r.pointGeometry(X[0]/X[3],X[1]/X[3]):new r.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(m,S){const F=new r.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),X=new r.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),$=new r.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),ot=new r.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let ct=this.pointCoordinate(F,m),yt=this.pointCoordinate(X,m);const xt=this.pointCoordinate($,S),Mt=this.pointCoordinate(ot,S),Pt=(Nt,Ht)=>(Ht.y-Nt.y)/(Ht.x-Nt.x);return ct.y>1&&yt.y>=0?ct=new r.MercatorCoordinate((1-Mt.y)/Pt(Mt,ct)+Mt.x,1):ct.y<0&&yt.y<=1&&(ct=new r.MercatorCoordinate(-Mt.y/Pt(Mt,ct)+Mt.x,0)),yt.y>1&&ct.y>=0?yt=new r.MercatorCoordinate((1-xt.y)/Pt(xt,yt)+xt.x,1):yt.y<0&&ct.y<=1&&(yt=new r.MercatorCoordinate(-xt.y/Pt(xt,yt)+xt.x,0)),new r.LngLatBounds().extend(this.coordinateLocation(ct)).extend(this.coordinateLocation(yt)).extend(this.coordinateLocation(Mt)).extend(this.coordinateLocation(xt))}_getBounds3D(){const m=this.elevation;if(!m.visibleDemTiles.length)return this._getBounds(0,0);const S=m.visibleDemTiles.reduce((F,X)=>{if(X.dem){const $=X.dem.tree;F.min=Math.min(F.min,$.minimums[0]),F.max=Math.max(F.max,$.maximums[0])}return F},{min:Number.MAX_VALUE,max:0});return this._getBounds(S.min*m.exaggeration(),S.max*m.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(m=!0){const S=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,F=this.height/2-S*(1-this._horizonShift);return m?Math.max(0,F):F}getMaxBounds(){return this.maxBounds}setMaxBounds(m){this.maxBounds=m,this.minLat=-r.MAX_MERCATOR_LATITUDE,this.maxLat=r.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,m&&(this.minLat=m.getSouth(),this.maxLat=m.getNorth(),this.minLng=m.getWest(),this.maxLng=m.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=r.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=r.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=r.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(m,S){return this.projection.createTileMatrix(this,S,m)}calculateDistanceTileData(m){const S=m.key,F=this._distanceTileDataCache;if(F[S])return F[S];const X=m.canonical,$=1/this.height,ot=this.cameraWorldSize/this.zoomScale(X.z),ct=(X.x+Math.pow(2,X.z)*m.wrap)*ot,yt=X.y*ot,xt=this.point,Mt=this.angle,Pt=Math.sin(-Mt),Nt=-Math.cos(-Mt);return F[S]={bearing:[Pt,Nt],center:[(xt.x-ct)*$,(xt.y-yt)*$],scale:ot/r.EXTENT*$},F[S]}calculateFogTileMatrix(m){const S=m.key,F=this._fogTileMatrixCache;if(F[S])return F[S];const X=this.calculatePosMatrix(m,this.cameraWorldSize);return r.multiply$1(X,this.worldToFogMatrix,X),F[S]=new Float32Array(X),F[S]}calculateProjMatrix(m,S=!1){const F=m.key,X=S?this._alignedProjMatrixCache:this._projMatrixCache;if(X[F])return X[F];const $=this.calculatePosMatrix(m,this.worldSize);return r.multiply$1($,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:S?this.alignedProjMatrix:this.projMatrix,$),X[F]=new Float32Array($),X[F]}calculatePixelsToTileUnitsMatrix(m){const S=m.tileID.key,F=this._pixelsToTileUnitsCache;if(F[S])return F[S];const X=function($,ot){const{scale:ct}=$.tileTransform,yt=ct*r.EXTENT/($.tileSize*Math.pow(2,ot.zoom-$.tileID.overscaledZ+$.tileID.canonical.z));return xt=new Float32Array(4),Nt=(Mt=ot.inverseAdjustmentMatrix)[1],Ht=Mt[2],Ut=Mt[3],ae=(Pt=[yt,yt])[1],xt[0]=Mt[0]*(Bt=Pt[0]),xt[1]=Nt*Bt,xt[2]=Ht*ae,xt[3]=Ut*ae,xt;var xt,Mt,Pt,Nt,Ht,Ut,Bt,ae}(m,this);return F[S]=X,F[S]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const m=this._elevation;this._updateCameraState();const S=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,F=this._computeCameraPosition(S),X=this._camera.forward(),$=r.mercatorZfromAltitude(1,this._center.lat);F[2]/=$,X[2]/=$,r.normalize(X,X);const ot=m.raycast(F,X,m.exaggeration());if(ot){const ct=r.scaleAndAdd([],F,X,ot),yt=new r.MercatorCoordinate(ct[0],ct[1],r.mercatorZfromAltitude(ct[2],r.latFromMercatorY(ct[1]))),xt=(yt.z+r.length([yt.x-F[0],yt.y-F[1],yt.z-F[2]*$]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(xt),this._centerAltitude=yt.toAltitude(),this._center=this.coordinateLocation(yt),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const m=this._elevation;this._updateCameraState();const S=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,F=this._computeCameraPosition(S),X=m.getAtPointOrZero(new r.MercatorCoordinate(...F)),$=this._minimumHeightOverTerrain()*Math.cos(r.degToRad(this._maxPitch)),ot=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*X;if(ot<$){const ct=this.locationCoordinate(this._center,this._centerAltitude),yt=[ct.x-F[0],ct.y-F[1],ct.z-F[2]],xt=r.length(yt);yt[2]-=($-ot)/this._projectionScaler;const Mt=r.length(yt);if(Mt===0)return;r.scale$2(yt,yt,xt/Mt*this._projectionScaler),this._camera.position=[ct.x-yt[0],ct.y-yt[1],ct.z*this._projectionScaler-yt[2]],this._camera.orientation=wh(yt,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const Pt=this.center;return Pt.lat=r.clamp(Pt.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(Pt.lng=r.clamp(Pt.lng,this.minLng,this.maxLng)),this.center=Pt,void(this._constraining=!1)}const m=this._unmodified,{x:S,y:F}=this.point;let X=0,$=S,ot=F;const ct=this.width/2,yt=this.height/2,xt=this.worldMinY*this.scale,Mt=this.worldMaxY*this.scale;if(F-yt<xt&&(ot=xt+yt),F+yt>Mt&&(ot=Mt-yt),Mt-xt<this.height&&(X=Math.max(X,this.height/(Mt-xt)),ot=(Mt+xt)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Pt=this.worldMinX*this.scale,Nt=this.worldMaxX*this.scale,Ht=this.worldSize/2-(Pt+Nt)/2;$=(S+Ht+this.worldSize)%this.worldSize-Ht,$-ct<Pt&&($=Pt+ct),$+ct>Nt&&($=Nt-ct),Nt-Pt<this.width&&(X=Math.max(X,this.width/(Nt-Pt)),$=(Nt+Pt)/2)}$===S&&ot===F||(this.center=this.unproject(new r.pointGeometry($,ot))),X&&(this.zoom+=this.scaleZoom(X)),this._constrainCameraAltitude(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let m=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(m=Math.max(m,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),m}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const m=this._fov/2,S=this.centerOffset,F=this.pixelsPerMeter;this._projectionScaler=F/(r.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(m)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const X=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?F:1),$=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);$[8]=2*-S.x/this.width,$[9]=2*S.y/this.height;let ot=r.mul([],$,X);if(this.projection.isReprojectedInTileSpace){const ce=this.locationCoordinate(this.center),ne=r.identity([]);r.translate(ne,ne,[ce.x*this.worldSize,ce.y*this.worldSize,0]),r.multiply$1(ne,ne,Hf(this)),r.translate(ne,ne,[-ce.x*this.worldSize,-ce.y*this.worldSize,0]),r.multiply$1(ot,ot,ne),this.inverseAdjustmentMatrix=function(de){const Ae=Hf(de,!0);return Z([],[Ae[0],Ae[1],Ae[4],Ae[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=r.scale([],ot,[this.worldSize,this.worldSize,this.worldSize/F,1]),this.projMatrix=ot,this.invProjMatrix=r.invert(new Float64Array(16),this.projMatrix);const ct=new Float32Array(16);r.identity(ct),r.scale(ct,ct,[1,-1,1]),r.rotateX(ct,ct,this._pitch),r.rotateZ(ct,ct,this.angle);const yt=r.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),xt=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;yt[8]=2*-S.x/this.width,yt[9]=2*(S.y+xt)/this.height,this.skyboxMatrix=r.multiply$1(ct,yt,ct);const Mt=this.point,Pt=Mt.x,Nt=Mt.y,Ht=this.width%2/2,Ut=this.height%2/2,Bt=Math.cos(this.angle),ae=Math.sin(this.angle),Jt=Pt-Math.round(Pt)+Bt*Ht+ae*Ut,ie=Nt-Math.round(Nt)+Bt*Ut+ae*Ht,se=new Float64Array(ot);if(r.translate(se,se,[Jt>.5?Jt-1:Jt,ie>.5?ie-1:ie,0]),this.alignedProjMatrix=se,ot=r.create(),r.scale(ot,ot,[this.width/2,-this.height/2,1]),r.translate(ot,ot,[1,-1,0]),this.labelPlaneMatrix=ot,ot=r.create(),r.scale(ot,ot,[1,-1,1]),r.translate(ot,ot,[-1,-1,0]),r.scale(ot,ot,[2/this.width,2/this.height,1]),this.glCoordMatrix=ot,this.pixelMatrix=r.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},ot=r.invert(new Float64Array(16),this.pixelMatrix),!ot)throw new Error("failed to invert matrix");this.pixelMatrixInverse=ot,this.globeMatrix=this.projection.name==="globe"?r.calculateGlobeMatrix(this):ot,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const m=this.cameraWorldSize,S=this.cameraPixelsPerMeter,F=this._camera.position,X=1/this.height,$=[m,m,S];r.scale$2($,$,X),r.scale$2(F,F,-1),r.multiply$2(F,F,$);const ot=r.create();r.translate(ot,ot,F),r.scale(ot,ot,$),this.mercatorFogMatrix=ot,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(m,S,X)}_computeCameraPosition(m){const S=(m=m||this.pixelsPerMeter)/this.pixelsPerMeter,F=this._camera.forward(),X=this.point,$=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*S-m/this.worldSize*this._centerAltitude;return[X.x/this.worldSize-F[0]*$,X.y/this.worldSize-F[1]*$,m/this.worldSize*this._centerAltitude-F[2]*$]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(m){const S=this._maxCameraBoundsDistance()*Math.cos(this._pitch),F=m[2];let X=1;F>0&&(X=Math.min((S-this._camera.position[2])/F,1)),this._camera.position=r.scaleAndAdd([],this._camera.position,m,X),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const m=this._camera.position,S=this._camera.forward(),{pitch:F,bearing:X}=this._camera.getPitchBearing(),$=r.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,ot=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.degToRad(this._maxPitch)),ct=Math.max((m[2]-$)/Math.cos(F),ot),yt=this._zoomFromMercatorZ(ct);r.scaleAndAdd(m,m,S,ct),this._pitch=r.clamp(F,r.degToRad(this.minPitch),r.degToRad(this.maxPitch)),this.angle=r.wrap(X,-Math.PI,Math.PI),this._setZoom(r.clamp(yt,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.MercatorCoordinate(m[0],m[1],m[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(m){return Math.pow(2,m)*this.tileSize}_mercatorZfromZoom(m){return this.cameraToCenterDistance/this._worldSizeFromZoom(m)}_minimumHeightOverTerrain(){const m=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(m)}_zoomFromMercatorZ(m){return this.scaleZoom(this.cameraToCenterDistance/(m*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(m,S){const F=Math.min(m.x,S.x),X=Math.max(m.x,S.x),$=Math.min(m.y,S.y),ot=Math.max(m.y,S.y);if($<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const ct=[new r.pointGeometry(F,$),new r.pointGeometry(X,ot),new r.pointGeometry(F,ot),new r.pointGeometry(X,$)],yt=this.renderWorldCopies?-3:0,xt=this.renderWorldCopies?4:1;for(const Mt of ct){const Pt=this.pointRayIntersection(Mt);if(Pt.t<0)return!0;const Nt=this.rayIntersectionCoordinate(Pt);if(Nt.x<yt||Nt.y<0||Nt.x>xt||Nt.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.pointGeometry(0,0),new r.pointGeometry(this.width,this.height))}zoomDeltaToMovement(m,S){const F=r.length(r.sub([],this._camera.position,m)),X=this._zoomFromMercatorZ(F)+S;return F-this._mercatorZfromZoom(X)}getCameraPoint(){const m=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.pointGeometry(0,m))}}function Yf(P,m){let S=!1,F=null;const X=()=>{F=null,S&&(P(),F=setTimeout(X,m),S=!1)};return()=>(S=!0,F||X(),F)}class p0{constructor(m){this._hashName=m&&encodeURIComponent(m),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Yf(this._updateHashUnthrottled.bind(this),300)}addTo(m){return this._map=m,r.window.addEventListener("hashchange",this._onHashChange,!1),m.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),r.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(m){const S=this._map;if(!S)return"";const F=S.getCenter(),X=Math.round(100*S.getZoom())/100,$=Math.ceil((X*Math.LN2+Math.log(512/360/.5))/Math.LN10),ot=Math.pow(10,$),ct=Math.round(F.lng*ot)/ot,yt=Math.round(F.lat*ot)/ot,xt=S.getBearing(),Mt=S.getPitch();let Pt="";if(Pt+=m?`/${ct}/${yt}/${X}`:`${X}/${yt}/${ct}`,(xt||Mt)&&(Pt+="/"+Math.round(10*xt)/10),Mt&&(Pt+=`/${Math.round(Mt)}`),this._hashName){const Nt=this._hashName;let Ht=!1;const Ut=r.window.location.hash.slice(1).split("&").map(Bt=>{const ae=Bt.split("=")[0];return ae===Nt?(Ht=!0,`${ae}=${Pt}`):Bt}).filter(Bt=>Bt);return Ht||Ut.push(`${Nt}=${Pt}`),`#${Ut.join("&")}`}return`#${Pt}`}_getCurrentHash(){const m=r.window.location.hash.replace("#","");if(this._hashName){let S;return m.split("&").map(F=>F.split("=")).forEach(F=>{F[0]===this._hashName&&(S=F)}),(S&&S[1]||"").split("/")}return m.split("/")}_onHashChange(){const m=this._map;if(!m)return!1;const S=this._getCurrentHash();if(S.length>=3&&!S.some(F=>isNaN(F))){const F=m.dragRotate.isEnabled()&&m.touchZoomRotate.isEnabled()?+(S[3]||0):m.getBearing();return m.jumpTo({center:[+S[2],+S[1]],zoom:+S[0],bearing:F,pitch:+(S[4]||0)}),!0}return!1}_updateHashUnthrottled(){const m=r.window.location.href.replace(/(#.+)?$/,this.getHashString());r.window.history.replaceState(r.window.history.state,null,m)}}const vs={linearity:.3,easing:r.bezier(0,0,.3,1)},m0=r.extend({deceleration:2500,maxSpeed:1400},vs),g0=r.extend({deceleration:20,maxSpeed:1400},vs),y0=r.extend({deceleration:1e3,maxSpeed:360},vs),b0=r.extend({deceleration:1e3,maxSpeed:90},vs);class v0{constructor(m){this._map=m,this.clear()}clear(){this._inertiaBuffer=[]}record(m){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.exported.now(),settings:m})}_drainInertiaBuffer(){const m=this._inertiaBuffer,S=r.exported.now();for(;m.length>0&&S-m[0].time>160;)m.shift()}_onMoveEnd(m){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const S={zoom:0,bearing:0,pitch:0,pan:new r.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:$}of this._inertiaBuffer)S.zoom+=$.zoomDelta||0,S.bearing+=$.bearingDelta||0,S.pitch+=$.pitchDelta||0,$.panDelta&&S.pan._add($.panDelta),$.around&&(S.around=$.around),$.pinchAround&&(S.pinchAround=$.pinchAround);const F=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,X={};if(S.pan.mag()){const $=fi(S.pan.mag(),F,r.extend({},m0,m||{}));X.offset=S.pan.mult($.amount/S.pan.mag()),X.center=this._map.transform.center,Cc(X,$)}if(S.zoom){const $=fi(S.zoom,F,g0);X.zoom=this._map.transform.zoom+$.amount,Cc(X,$)}if(S.bearing){const $=fi(S.bearing,F,y0);X.bearing=this._map.transform.bearing+r.clamp($.amount,-179,179),Cc(X,$)}if(S.pitch){const $=fi(S.pitch,F,b0);X.pitch=this._map.transform.pitch+$.amount,Cc(X,$)}if(X.zoom||X.bearing){const $=S.pinchAround===void 0?S.around:S.pinchAround;X.around=$?this._map.unproject($):this._map.getCenter()}return this.clear(),X.noMoveStart=!0,X}}function Cc(P,m){(!P.duration||P.duration<m.duration)&&(P.duration=m.duration,P.easing=m.easing)}function fi(P,m,S){const{maxSpeed:F,linearity:X,deceleration:$}=S,ot=r.clamp(P*X/(m/1e3),-F,F),ct=Math.abs(ot)/($*X);return{easing:S.easing,duration:1e3*ct,amount:ot*(ct/2)}}class so extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(m,S,F,X={}){const $=N(S.getCanvasContainer(),F),ot=S.unproject($);super(m,r.extend({point:$,lngLat:ot,originalEvent:F},X)),this._defaultPrevented=!1,this.target=S}}class Pc extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(m,S,F){const X=m==="touchend"?F.changedTouches:F.touches,$=V(S.getCanvasContainer(),X),ot=$.map(yt=>S.unproject(yt)),ct=$.reduce((yt,xt,Mt,Pt)=>yt.add(xt.div(Pt.length)),new r.pointGeometry(0,0));super(m,{points:$,point:ct,lngLats:ot,lngLat:S.unproject(ct),originalEvent:F}),this._defaultPrevented=!1}}class Yb extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(m,S,F){super(m,{originalEvent:F}),this._defaultPrevented=!1}}class Kb{constructor(m,S){this._map=m,this._clickTolerance=S.clickTolerance}reset(){this._mousedownPos=void 0}wheel(m){return this._firePreventable(new Yb(m.type,this._map,m))}mousedown(m,S){return this._mousedownPos=S,this._firePreventable(new so(m.type,this._map,m))}mouseup(m){this._map.fire(new so(m.type,this._map,m))}preclick(m){const S=r.extend({},m);S.type="preclick",this._map.fire(new so(S.type,this._map,S))}click(m,S){this._mousedownPos&&this._mousedownPos.dist(S)>=this._clickTolerance||(this.preclick(m),this._map.fire(new so(m.type,this._map,m)))}dblclick(m){return this._firePreventable(new so(m.type,this._map,m))}mouseover(m){this._map.fire(new so(m.type,this._map,m))}mouseout(m){this._map.fire(new so(m.type,this._map,m))}touchstart(m){return this._firePreventable(new Pc(m.type,this._map,m))}touchmove(m){this._map.fire(new Pc(m.type,this._map,m))}touchend(m){this._map.fire(new Pc(m.type,this._map,m))}touchcancel(m){this._map.fire(new Pc(m.type,this._map,m))}_firePreventable(m){if(this._map.fire(m),m.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xs{constructor(m){this._map=m}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(m){this._map.fire(new so(m.type,this._map,m))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new so("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(m){this._delayContextMenu?this._contextMenuEvent=m:this._map.fire(new so(m.type,this._map,m)),this._map.listens("contextmenu")&&m.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class x0{constructor(m,S){this._map=m,this._el=m.getCanvasContainer(),this._container=m.getContainer(),this._clickTolerance=S.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(m,S){this.isEnabled()&&m.shiftKey&&m.button===0&&(w(),this._startPos=this._lastPos=S,this._active=!0)}mousemoveWindow(m,S){if(!this._active)return;const F=S;if(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)return;const X=this._startPos;this._lastPos=F,this._box||(this._box=d("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",m));const $=Math.min(X.x,F.x),ot=Math.max(X.x,F.x),ct=Math.min(X.y,F.y),yt=Math.max(X.y,F.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${$}px,${ct}px)`,this._box.style.width=ot-$+"px",this._box.style.height=yt-ct+"px")})}mouseupWindow(m,S){if(!this._active||m.button!==0)return;const F=this._startPos,X=S;if(this.reset(),D(),F.x!==X.x||F.y!==X.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:m})),{cameraAnimation:$=>$.fitScreenCoordinates(F,X,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",m)}keydown(m){this._active&&m.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",m))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),M(),delete this._startPos,delete this._lastPos}_fireEvent(m,S){return this._map.fire(new r.Event(m,{originalEvent:S}))}}function Ks(P,m){const S={};for(let F=0;F<P.length;F++)S[P[F].identifier]=m[F];return S}class es{constructor(m){this.reset(),this.numTouches=m.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(m,S,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=m.timeStamp),F.length===this.numTouches&&(this.centroid=function(X){const $=new r.pointGeometry(0,0);for(const ot of X)$._add(ot);return $.div(X.length)}(S),this.touches=Ks(F,S)))}touchmove(m,S,F){if(this.aborted||!this.centroid)return;const X=Ks(F,S);for(const $ in this.touches){const ot=this.touches[$],ct=X[$];(!ct||ct.dist(ot)>30)&&(this.aborted=!0)}}touchend(m,S,F){if((!this.centroid||m.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){const X=!this.aborted&&this.centroid;if(this.reset(),X)return X}}}class pl{constructor(m){this.singleTap=new es(m),this.numTaps=m.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(m,S,F){this.singleTap.touchstart(m,S,F)}touchmove(m,S,F){this.singleTap.touchmove(m,S,F)}touchend(m,S,F){const X=this.singleTap.touchend(m,S,F);if(X){const $=m.timeStamp-this.lastTime<500,ot=!this.lastTap||this.lastTap.dist(X)<30;if($&&ot||this.reset(),this.count++,this.lastTime=m.timeStamp,this.lastTap=X,this.count===this.numTaps)return this.reset(),X}}}class xn{constructor(){this._zoomIn=new pl({numTouches:1,numTaps:2}),this._zoomOut=new pl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(m,S,F){this._zoomIn.touchstart(m,S,F),this._zoomOut.touchstart(m,S,F)}touchmove(m,S,F){this._zoomIn.touchmove(m,S,F),this._zoomOut.touchmove(m,S,F)}touchend(m,S,F){const X=this._zoomIn.touchend(m,S,F),$=this._zoomOut.touchend(m,S,F);return X?(this._active=!0,m.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:ot=>ot.easeTo({duration:300,zoom:ot.getZoom()+1,around:ot.unproject(X)},{originalEvent:m})}):$?(this._active=!0,m.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:ot=>ot.easeTo({duration:300,zoom:ot.getZoom()-1,around:ot.unproject($)},{originalEvent:m})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _0={0:1,2:2};class Ah{constructor(m){this.reset(),this._clickTolerance=m.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(m,S){return!1}_move(m,S){return{}}mousedown(m,S){if(this._lastPoint)return;const F=K(m);this._correctButton(m,F)&&(this._lastPoint=S,this._eventButton=F)}mousemoveWindow(m,S){const F=this._lastPoint;if(F){if(m.preventDefault(),this._eventButton!=null&&function(X,$){const ot=_0[$];return X.buttons===void 0||(X.buttons&ot)!==ot}(m,this._eventButton))this.reset();else if(this._moved||!(S.dist(F)<this._clickTolerance))return this._moved=!0,this._lastPoint=S,this._move(F,S)}}mouseupWindow(m){this._lastPoint&&K(m)===this._eventButton&&(this._moved&&D(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dc extends Ah{mousedown(m,S){super.mousedown(m,S),this._lastPoint&&(this._active=!0)}_correctButton(m,S){return S===0&&!m.ctrlKey}_move(m,S){return{around:S,panDelta:S.sub(m)}}}class ml extends Ah{_correctButton(m,S){return S===0&&m.ctrlKey||S===2}_move(m,S){const F=.8*(S.x-m.x);if(F)return this._active=!0,{bearingDelta:F}}contextmenu(m){m.preventDefault()}}class Kf extends Ah{_correctButton(m,S){return S===0&&m.ctrlKey||S===2}_move(m,S){const F=-.5*(S.y-m.y);if(F)return this._active=!0,{pitchDelta:F}}contextmenu(m){m.preventDefault()}}class w0{constructor(m,S){this._map=m,this._el=m.getCanvasContainer(),this._minTouches=1,this._clickTolerance=S.clickTolerance||1,this.reset(),r.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.pointGeometry(0,0)}touchstart(m,S,F){return this._calculateTransform(m,S,F)}touchmove(m,S,F){if(this._active&&!(F.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(F.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return m.preventDefault(),this._calculateTransform(m,S,F)}}touchend(m,S,F){this._calculateTransform(m,S,F),this._active&&F.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(m,S,F){F.length>0&&(this._active=!0);const X=Ks(F,S),$=new r.pointGeometry(0,0),ot=new r.pointGeometry(0,0);let ct=0;for(const xt in X){const Mt=X[xt],Pt=this._touches[xt];Pt&&($._add(Mt),ot._add(Mt.sub(Pt)),ct++,X[xt]=Mt)}if(this._touches=X,ct<this._minTouches||!ot.mag())return;const yt=ot.div(ct);return this._sum._add(yt),this._sum.mag()<this._clickTolerance?void 0:{around:$.div(ct),panDelta:yt}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=d("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Sh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(m){}_move(m,S,F){return{}}touchstart(m,S,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([S[0],S[1]]))}touchmove(m,S,F){const X=this._firstTwoTouches;if(!X)return;m.preventDefault();const[$,ot]=X,ct=Rc(F,S,$),yt=Rc(F,S,ot);if(!ct||!yt)return;const xt=this._aroundCenter?null:ct.add(yt).div(2);return this._move([ct,yt],xt,m)}touchend(m,S,F){if(!this._firstTwoTouches)return;const[X,$]=this._firstTwoTouches,ot=Rc(F,S,X),ct=Rc(F,S,$);ot&&ct||(this._active&&D(),this.reset())}touchcancel(){this.reset()}enable(m){this._enabled=!0,this._aroundCenter=!!m&&m.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Rc(P,m,S){for(let F=0;F<P.length;F++)if(P[F].identifier===S)return m[F]}function Zf(P,m){return Math.log(P/m)/Math.LN2}class M0 extends Sh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(m){this._startDistance=this._distance=m[0].dist(m[1])}_move(m,S){const F=this._distance;if(this._distance=m[0].dist(m[1]),this._active||!(Math.abs(Zf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zf(this._distance,F),pinchAround:S}}}function Jf(P,m){return 180*P.angleWith(m)/Math.PI}class Eh extends Sh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(m){this._startVector=this._vector=m[0].sub(m[1]),this._minDiameter=m[0].dist(m[1])}_move(m,S){const F=this._vector;if(this._vector=m[0].sub(m[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Jf(this._vector,F),pinchAround:S}}_isBelowThreshold(m){this._minDiameter=Math.min(this._minDiameter,m.mag());const S=25/(Math.PI*this._minDiameter)*360,F=Jf(m,this._startVector);return Math.abs(F)<S}}function kc(P){return Math.abs(P.y)>Math.abs(P.x)}class Th extends Sh{constructor(m){super(),this._map=m}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(m){this._lastPoints=m,kc(m[0].sub(m[1]))&&(this._valid=!1)}_move(m,S,F){const X=this._lastPoints;if(!X)return;const $=m[0].sub(X[0]),ot=m[1].sub(X[1]);return this._map._cooperativeGestures&&F.touches.length<3||(this._valid=this.gestureBeginsVertically($,ot,F.timeStamp),!this._valid)?void 0:(this._lastPoints=m,this._active=!0,{pitchDelta:($.y+ot.y)/2*-.5})}gestureBeginsVertically(m,S,F){if(this._valid!==void 0)return this._valid;const X=m.mag()>=2,$=S.mag()>=2;if(!X&&!$)return;if(!X||!$)return this._firstMove==null&&(this._firstMove=F),F-this._firstMove<100&&void 0;const ot=m.y>0==S.y>0;return kc(m)&&kc(S)&&ot}}const A0={panStep:100,bearingStep:15,pitchStep:10};class S0{constructor(){const m=A0;this._panStep=m.panStep,this._bearingStep=m.bearingStep,this._pitchStep=m.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(m){if(m.altKey||m.ctrlKey||m.metaKey)return;let S=0,F=0,X=0,$=0,ot=0;switch(m.keyCode){case 61:case 107:case 171:case 187:S=1;break;case 189:case 109:case 173:S=-1;break;case 37:m.shiftKey?F=-1:(m.preventDefault(),$=-1);break;case 39:m.shiftKey?F=1:(m.preventDefault(),$=1);break;case 38:m.shiftKey?X=1:(m.preventDefault(),ot=-1);break;case 40:m.shiftKey?X=-1:(m.preventDefault(),ot=1);break;default:return}return this._rotationDisabled&&(F=0,X=0),{cameraAnimation:ct=>{const yt=ct.getZoom();ct.easeTo({duration:300,easeId:"keyboardHandler",easing:E0,zoom:S?Math.round(yt)+S*(m.shiftKey?2:1):yt,bearing:ct.getBearing()+F*this._bearingStep,pitch:ct.getPitch()+X*this._pitchStep,offset:[-$*this._panStep,-ot*this._panStep],center:ct.getCenter()},{originalEvent:m})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function E0(P){return P*(2-P)}const $f=4.000244140625;class T0{constructor(m,S){this._map=m,this._el=m.getCanvasContainer(),this._handler=S,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,r.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(m){this._defaultZoomRate=m}setWheelZoomRate(m){this._wheelZoomRate=m}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(m){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!m&&m.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(m){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(m.ctrlKey||m.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let S=m.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*m.deltaY:m.deltaY;const F=r.exported.now(),X=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,S!==0&&S%$f==0?this._type="wheel":S!==0&&Math.abs(S)<4?this._type="trackpad":X>400?(this._type=null,this._lastValue=S,this._timeout=setTimeout(this._onTimeout,40,m)):this._type||(this._type=Math.abs(X*S)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,S+=this._lastValue)),m.shiftKey&&S&&(S/=4),this._type&&(this._lastWheelEvent=m,this._delta-=S,this._active||this._start(m)),m.preventDefault()}_onTimeout(m){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(m)}_start(m){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const S=N(this._el,m);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:S,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const m=this._map.transform,S=()=>m._terrainEnabled()&&this._aroundCoord?m.computeZoomRelativeTo(this._aroundCoord):m.zoom;if(this._delta!==0){const yt=this._type==="wheel"&&Math.abs(this._delta)>$f?this._wheelZoomRate:this._defaultZoomRate;let xt=2/(1+Math.exp(-Math.abs(this._delta*yt)));this._delta<0&&xt!==0&&(xt=1/xt);const Mt=S(),Pt=Math.pow(2,Mt),Nt=typeof this._targetZoom=="number"?m.zoomScale(this._targetZoom):Pt;this._targetZoom=Math.min(m.maxZoom,Math.max(m.minZoom,m.scaleZoom(Nt*xt))),this._type==="wheel"&&(this._startZoom=S(),this._easing=this._smoothOutEasing(200)),this._delta=0}const F=typeof this._targetZoom=="number"?this._targetZoom:S(),X=this._startZoom,$=this._easing;let ot,ct=!1;if(this._type==="wheel"&&X&&$){const yt=Math.min((r.exported.now()-this._lastWheelEventTime)/200,1),xt=$(yt);ot=r.number(X,F,xt),yt<1?this._frameId||(this._frameId=!0):ct=!0}else ot=F,ct=!0;return this._active=!0,ct&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ct,zoomDelta:ot-S(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(m){let S=r.ease;if(this._prevEase){const F=this._prevEase,X=(r.exported.now()-F.start)/F.duration,$=F.easing(X+.01)-F.easing(X),ot=.27/Math.sqrt($*$+1e-4)*.01,ct=Math.sqrt(.0729-ot*ot);S=r.bezier(ot,ct,.25,1)}return this._prevEase={start:r.exported.now(),duration:m,easing:S},S}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=d("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(r.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!r.window.document.fullscreenElement||!!r.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class C0{constructor(m,S){this._clickZoom=m,this._tapZoom=S}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class P0{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(m,S){return m.preventDefault(),{cameraAnimation:F=>{F.easeTo({duration:300,zoom:F.getZoom()+(m.shiftKey?-1:1),around:F.unproject(S)},{originalEvent:m})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qf{constructor(){this._tap=new pl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(m,S,F){this._swipePoint||(this._tapTime&&m.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=S[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(m,S,F))}touchmove(m,S,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;const X=S[0],$=X.y-this._swipePoint.y;return this._swipePoint=X,m.preventDefault(),this._active=!0,{zoomDelta:$/128}}}else this._tap.touchmove(m,S,F)}touchend(m,S,F){this._tapTime?this._swipePoint&&F.length===0&&this.reset():this._tap.touchend(m,S,F)&&(this._tapTime=m.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class D0{constructor(m,S,F){this._el=m,this._mousePan=S,this._touchPan=F}enable(m){this._inertiaOptions=m||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class R0{constructor(m,S,F){this._pitchWithRotate=m.pitchWithRotate,this._mouseRotate=S,this._mousePitch=F}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class k0{constructor(m,S,F,X){this._el=m,this._touchZoom=S,this._touchRotate=F,this._tapDragZoom=X,this._rotationDisabled=!1,this._enabled=!0}enable(m){this._touchZoom.enable(m),this._rotationDisabled||this._touchRotate.enable(m),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ic=P=>P.zoom||P.drag||P.pitch||P.rotate;class tp extends r.Event{}class I0{constructor(){this.constants=[1,1,.01],this.radius=0}setup(m,S){const F=r.sub([],S,m);this.radius=r.length(F[2]<0?r.div([],F,this.constants):[F[0],F[1],0])}projectRay(m){r.div(m,m,this.constants),r.normalize(m,m),r.mul$1(m,m,this.constants);const S=r.scale$2([],m,this.radius);if(S[2]>0){const F=r.scale$2([],[0,0,1],r.dot(S,[0,0,1])),X=r.scale$2([],r.normalize([],[S[0],S[1],0]),this.radius),$=r.add([],S,r.scale$2([],r.sub([],r.add([],X,F),S),2));S[0]=$[0],S[1]=$[1]}return S}}function gl(P){return P.panDelta&&P.panDelta.mag()||P.zoomDelta||P.bearingDelta||P.pitchDelta}class L0{constructor(m,S){this._map=m,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new v0(m),this._bearingSnap=S.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new I0,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(S),r.bindAll(["handleEvent","handleWindowEvent"],this);const F=this._el;this._listeners=[[F,"touchstart",{passive:!0}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[r.window,"blur",void 0]];for(const[X,$,ot]of this._listeners)X.addEventListener($,X===r.window.document?this.handleWindowEvent:this.handleEvent,ot)}destroy(){for(const[m,S,F]of this._listeners)m.removeEventListener(S,m===r.window.document?this.handleWindowEvent:this.handleEvent,F)}_addDefaultHandlers(m){const S=this._map,F=S.getCanvasContainer();this._add("mapEvent",new Kb(S,m));const X=S.boxZoom=new x0(S,m);this._add("boxZoom",X);const $=new xn,ot=new P0;S.doubleClickZoom=new C0(ot,$),this._add("tapZoom",$),this._add("clickZoom",ot);const ct=new Qf;this._add("tapDragZoom",ct);const yt=S.touchPitch=new Th(S);this._add("touchPitch",yt);const xt=new ml(m),Mt=new Kf(m);S.dragRotate=new R0(m,xt,Mt),this._add("mouseRotate",xt,["mousePitch"]),this._add("mousePitch",Mt,["mouseRotate"]);const Pt=new Dc(m),Nt=new w0(S,m);S.dragPan=new D0(F,Pt,Nt),this._add("mousePan",Pt),this._add("touchPan",Nt,["touchZoom","touchRotate"]);const Ht=new Eh,Ut=new M0;S.touchZoomRotate=new k0(F,Ut,Ht,ct),this._add("touchRotate",Ht,["touchPan","touchZoom"]),this._add("touchZoom",Ut,["touchPan","touchRotate"]),this._add("blockableMapEvent",new xs(S));const Bt=S.scrollZoom=new T0(S,this);this._add("scrollZoom",Bt,["mousePan"]);const ae=S.keyboard=new S0;this._add("keyboard",ae);for(const Jt of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])m.interactive&&m[Jt]&&S[Jt].enable(m[Jt])}_add(m,S,F){this._handlers.push({handlerName:m,handler:S,allowed:F}),this._handlersById[m]=S}stop(m){if(!this._updatingCamera){for(const{handler:S}of this._handlers)S.reset();this._inertia.clear(),this._fireEvents({},{},m),this._changes=[]}}isActive(){for(const{handler:m}of this._handlers)if(m.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ic(this._eventsInProgress)||this.isZooming()}_blockedByActive(m,S,F){for(const X in m)if(X!==F&&(!S||S.indexOf(X)<0))return!0;return!1}handleWindowEvent(m){this.handleEvent(m,`${m.type}Window`)}_getMapTouches(m){const S=[];for(const F of m)this._el.contains(F.target)&&S.push(F);return S}handleEvent(m,S){this._updatingCamera=!0;const F=m.type==="renderFrame",X=F?void 0:m,$={needsRenderFrame:!1},ot={},ct={},yt=m.touches?this._getMapTouches(m.touches):void 0,xt=yt?V(this._el,yt):F?void 0:N(this._el,m);for(const{handlerName:Nt,handler:Ht,allowed:Ut}of this._handlers){if(!Ht.isEnabled())continue;let Bt;this._blockedByActive(ct,Ut,Nt)?Ht.reset():Ht[S||m.type]&&(Bt=Ht[S||m.type](m,xt,yt),this.mergeHandlerResult($,ot,Bt,Nt,X),Bt&&Bt.needsRenderFrame&&this._triggerRenderFrame()),(Bt||Ht.isActive())&&(ct[Nt]=Ht)}const Mt={};for(const Nt in this._previousActiveHandlers)ct[Nt]||(Mt[Nt]=X);this._previousActiveHandlers=ct,(Object.keys(Mt).length||gl($))&&(this._changes.push([$,ot,Mt]),this._triggerRenderFrame()),(Object.keys(ct).length||gl($))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Pt}=$;Pt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Pt(this._map))}mergeHandlerResult(m,S,F,X,$){if(!F)return;r.extend(m,F);const ot={handlerName:X,originalEvent:F.originalEvent||$};F.zoomDelta!==void 0&&(S.zoom=ot),F.panDelta!==void 0&&(S.drag=ot),F.pitchDelta!==void 0&&(S.pitch=ot),F.bearingDelta!==void 0&&(S.rotate=ot)}_applyChanges(){const m={},S={},F={};for(const[X,$,ot]of this._changes)X.panDelta&&(m.panDelta=(m.panDelta||new r.pointGeometry(0,0))._add(X.panDelta)),X.zoomDelta&&(m.zoomDelta=(m.zoomDelta||0)+X.zoomDelta),X.bearingDelta&&(m.bearingDelta=(m.bearingDelta||0)+X.bearingDelta),X.pitchDelta&&(m.pitchDelta=(m.pitchDelta||0)+X.pitchDelta),X.around!==void 0&&(m.around=X.around),X.aroundCoord!==void 0&&(m.aroundCoord=X.aroundCoord),X.pinchAround!==void 0&&(m.pinchAround=X.pinchAround),X.noInertia&&(m.noInertia=X.noInertia),r.extend(S,$),r.extend(F,ot);this._updateMapTransform(m,S,F),this._changes=[]}_updateMapTransform(m,S,F){const X=this._map,$=X.transform,ot=ie=>[ie.x,ie.y,ie.z];if((ie=>{const se=this._eventsInProgress.drag;return se&&!this._handlersById[se.handlerName].isActive()})()&&!gl(m)){const ie=$.zoom;$.cameraElevationReference="sea",$.recenterOnTerrain(),$.cameraElevationReference="ground",ie!==$.zoom&&this._map._update(!0)}if(!gl(m))return void this._fireEvents(S,F,!0);let{panDelta:ct,zoomDelta:yt,bearingDelta:xt,pitchDelta:Mt,around:Pt,aroundCoord:Nt,pinchAround:Ht}=m;Ht!==void 0&&(Pt=Ht),(ie=>S.drag&&!this._eventsInProgress.drag)()&&Pt&&(this._dragOrigin=ot($.pointCoordinate3D(Pt)),this._trackingEllipsoid.setup($._camera.position,this._dragOrigin)),$.cameraElevationReference="sea",X._stop(!0),Pt=Pt||X.transform.centerPoint,xt&&($.bearing+=xt),Mt&&($.pitch+=Mt),$._updateCameraState();const Ut=[0,0,0];if(ct){const ie=$.pointCoordinate(Pt);if($.projection.name==="globe"){const se=r.latFromMercatorY(ie.y),ce=$.center.lat,ne=Math.min(r.mercatorZfromAltitude(1,se)/r.mercatorZfromAltitude(1,ce),2);ct=ct.rotate(-$.angle),Ut[0]=-ct.x/$.worldSize*ne,Ut[1]=-ct.y/$.worldSize*ne}else{const se=$.pointCoordinate(Pt.sub(ct));ie&&se&&(Ut[0]=se.x-ie.x,Ut[1]=se.y-ie.y)}}const Bt=$.zoom,ae=[0,0,0];if(yt){const ie=ot(Nt||$.pointCoordinate3D(Pt)),se={dir:r.normalize([],r.sub([],ie,$._camera.position))};if(se.dir[2]<0){const ce=$.zoomDeltaToMovement(ie,yt);r.scale$2(ae,se.dir,ce)}}const Jt=r.add(Ut,Ut,ae);$._translateCameraConstrained(Jt),yt&&Math.abs($.zoom-Bt)>1e-4&&$.recenterOnTerrain(),$.cameraElevationReference="ground",this._map._update(),m.noInertia||this._inertia.record(m),this._fireEvents(S,F,!0)}_fireEvents(m,S,F){const X=Ic(this._eventsInProgress),$=Ic(m),ot={};for(const Mt in m){const{originalEvent:Pt}=m[Mt];this._eventsInProgress[Mt]||(ot[`${Mt}start`]=Pt),this._eventsInProgress[Mt]=m[Mt]}!X&&$&&this._fireEvent("movestart",$.originalEvent);for(const Mt in ot)this._fireEvent(Mt,ot[Mt]);$&&this._fireEvent("move",$.originalEvent);for(const Mt in m){const{originalEvent:Pt}=m[Mt];this._fireEvent(Mt,Pt)}const ct={};let yt;for(const Mt in this._eventsInProgress){const{handlerName:Pt,originalEvent:Nt}=this._eventsInProgress[Mt];this._handlersById[Pt].isActive()||(delete this._eventsInProgress[Mt],yt=S[Pt]||Nt,ct[`${Mt}end`]=yt)}for(const Mt in ct)this._fireEvent(Mt,ct[Mt]);const xt=Ic(this._eventsInProgress);if(F&&(X||$)&&!xt){this._updatingCamera=!0;const Mt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Pt=Nt=>Nt!==0&&-this._bearingSnap<Nt&&Nt<this._bearingSnap;Mt?(Pt(Mt.bearing||this._map.getBearing())&&(Mt.bearing=0),this._map.easeTo(Mt,{originalEvent:yt})):(this._map.fire(new r.Event("moveend",{originalEvent:yt})),Pt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(m,S){this._map.fire(new r.Event(m,S?{originalEvent:S}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(m=>{this._frameId=void 0,this.handleEvent(new tp("renderFrame",{timeStamp:m})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ch="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ep extends r.Evented{constructor(m,S){super(),this._moving=!1,this._zooming=!1,this.transform=m,this._bearingSnap=S.bearingSnap,r.bindAll(["_renderFrameCallback"],this)}getCenter(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(m,S){return this.jumpTo({center:m},S)}panBy(m,S,F){return m=r.pointGeometry.convert(m).mult(-1),this.panTo(this.transform.center,r.extend({offset:m},S),F)}panTo(m,S,F){return this.easeTo(r.extend({center:m},S),F)}getZoom(){return this.transform.zoom}setZoom(m,S){return this.jumpTo({zoom:m},S),this}zoomTo(m,S,F){return this.easeTo(r.extend({zoom:m},S),F)}zoomIn(m,S){return this.zoomTo(this.getZoom()+1,m,S),this}zoomOut(m,S){return this.zoomTo(this.getZoom()-1,m,S),this}getBearing(){return this.transform.bearing}setBearing(m,S){return this.jumpTo({bearing:m},S),this}getPadding(){return this.transform.padding}setPadding(m,S){return this.jumpTo({padding:m},S),this}rotateTo(m,S,F){return this.easeTo(r.extend({bearing:m},S),F)}resetNorth(m,S){return this.rotateTo(0,r.extend({duration:1e3},m),S),this}resetNorthPitch(m,S){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},m),S),this}snapToNorth(m,S){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(m,S):this}getPitch(){return this.transform.pitch}setPitch(m,S){return this.jumpTo({pitch:m},S),this}cameraForBounds(m,S){m=r.LngLatBounds.convert(m);const F=S&&S.bearing||0;return this._cameraForBoxAndBearing(m.getNorthWest(),m.getSouthEast(),F,S)}_extendCameraOptions(m){const S={top:0,bottom:0,right:0,left:0};if(typeof(m=r.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const F=m.padding;m.padding={top:F,bottom:F,right:F,left:F}}return m.padding=r.extend(S,m.padding),m}_cameraForBoxAndBearing(m,S,F,X){const $=this._extendCameraOptions(X),ot=this.transform,ct=ot.padding,yt=ot.project(r.LngLat.convert(m)),xt=ot.project(r.LngLat.convert(S)),Mt=new r.pointGeometry(yt.x,xt.y),Pt=new r.pointGeometry(xt.x,yt.y),Nt=-r.degToRad(F),Ht=yt.rotate(Nt),Ut=xt.rotate(Nt),Bt=Mt.rotate(Nt),ae=Pt.rotate(Nt),Jt=new r.pointGeometry(Math.max(Ht.x,Ut.x,Bt.x,ae.x),Math.max(Ht.y,Ut.y,Bt.y,ae.y)),ie=new r.pointGeometry(Math.min(Ht.x,Ut.x,Bt.x,ae.x),Math.min(Ht.y,Ut.y,Bt.y,ae.y)),se=Jt.sub(ie),ce=(ot.width-((ct.left||0)+(ct.right||0)+$.padding.left+$.padding.right))/se.x,ne=(ot.height-((ct.top||0)+(ct.bottom||0)+$.padding.top+$.padding.bottom))/se.y;if(ne<0||ce<0)return void r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const de=Math.min(ot.scaleZoom(ot.scale*Math.min(ce,ne)),$.maxZoom),Ae=typeof $.offset.x=="number"&&typeof $.offset.y=="number"?new r.pointGeometry($.offset.x,$.offset.y):r.pointGeometry.convert($.offset),Re=new r.pointGeometry(($.padding.left-$.padding.right)/2,($.padding.top-$.padding.bottom)/2).rotate(F*Math.PI/180),je=Ae.add(Re).mult(ot.scale/ot.zoomScale(de));return{center:ot.unproject(yt.add(xt).div(2).sub(je)),zoom:de,bearing:F}}_cameraForBox(m,S,F,X,$){const ot=this._extendCameraOptions($);F=F||0,X=X||0,m=r.LngLat.convert(m),S=r.LngLat.convert(S);const ct=this.transform.clone();ct.padding=ot.padding;const yt=this.getFreeCameraOptions(),xt=new r.LngLat(.5*(m.lng+S.lng),.5*(m.lat+S.lat)),Mt=.5*(F+X);if(ct._camera.position[2]<r.mercatorZfromAltitude(Mt,xt.lat))return void r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");yt.lookAtPoint(xt),ct.setFreeCameraOptions(yt);const Pt=r.MercatorCoordinate.fromLngLat(m),Nt=r.MercatorCoordinate.fromLngLat(S),Ht=ct.pointRayIntersection(ct.centerPoint,Mt),Ut=[(Bt=ct.rayIntersectionCoordinate(Ht)).x,Bt.y,Bt.z];var Bt;const ae=ct.screenPointToMercatorRay(ct.centerPoint),Jt=ct.projection.name!=="globe";let ie,se=0;do{const ce=Math.floor(ct.zoom),ne=1<<ce,de=Math.min(ne*Pt.x,ne*Nt.x),Ae=Math.min(ne*Pt.y,ne*Nt.y),Re=Math.max(ne*Pt.x,ne*Nt.x),je=Math.max(ne*Pt.y,ne*Nt.y),Ne=new r.Aabb([de,Ae,F],[Re,je,X]),cn=r.Frustum.fromInvProjectionMatrix(ct.invProjMatrix,ct.worldSize,ce,Jt);if(Ne.intersects(cn)!==2){ie&&(ct._camera.position=r.scaleAndAdd([],ct._camera.position,ae.dir,-ie),ct._updateStateFromCamera());break}const Se=r.sub([],ct._camera.position,Ut);ie=.5*r.length(Se),ct._camera.position=r.scaleAndAdd([],ct._camera.position,ae.dir,ie);try{ct._updateStateFromCamera()}catch(un){return void r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++se<10);return{center:ct.center,zoom:ct.zoom,bearing:ct.bearing,pitch:ct.pitch}}fitBounds(m,S,F){return this._fitInternal(this.cameraForBounds(m,S),S,F)}_raycastElevationBox(m,S){const F=this.transform.elevation;if(!F)return;const X=new r.pointGeometry(m.x,S.y),$=new r.pointGeometry(S.x,m.y),ot=F.pointCoordinate(m);if(!ot)return;const ct=F.pointCoordinate(S);if(!ct)return;const yt=F.pointCoordinate(X);if(!yt)return;const xt=F.pointCoordinate($);if(!xt)return;const Mt=new r.MercatorCoordinate(ot[0],ot[1]).toLngLat(),Pt=new r.MercatorCoordinate(ct[0],ct[1]).toLngLat(),Nt=new r.MercatorCoordinate(yt[0],yt[1]).toLngLat(),Ht=new r.MercatorCoordinate(xt[0],xt[1]).toLngLat(),Ut=Math.min(Mt.lng,Math.min(Pt.lng,Math.min(Nt.lng,Ht.lng))),Bt=Math.min(Mt.lat,Math.min(Pt.lat,Math.min(Nt.lat,Ht.lat))),ae=Math.max(Mt.lng,Math.max(Pt.lng,Math.max(Nt.lng,Ht.lng))),Jt=Math.max(Mt.lat,Math.max(Pt.lat,Math.max(Nt.lat,Ht.lat))),ie=Math.min(ot[3],Math.min(ct[3],Math.min(yt[3],xt[3]))),se=Math.max(ot[3],Math.max(ct[3],Math.max(yt[3],xt[3])));return{minLngLat:new r.LngLat(Ut,Bt),maxLngLat:new r.LngLat(ae,Jt),minAltitude:ie,maxAltitude:se}}fitScreenCoordinates(m,S,F,X,$){let ot,ct,yt,xt;const Mt=r.pointGeometry.convert(m),Pt=r.pointGeometry.convert(S),Nt=this._raycastElevationBox(Mt,Pt);if(Nt)ot=Nt.minLngLat,ct=Nt.maxLngLat,yt=Nt.minAltitude,xt=Nt.maxAltitude;else{if(this.transform.anyCornerOffEdge(Mt,Pt))return this;ot=this.transform.pointLocation(Mt),ct=this.transform.pointLocation(Pt)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(r.pointGeometry.convert(m)),this.transform.pointLocation(r.pointGeometry.convert(S)),F,X):this._cameraForBox(ot,ct,yt,xt,X),X,$)}_fitInternal(m,S,F){return m?(delete(S=r.extend(m,S)).padding,S.linear?this.easeTo(S,F):this.flyTo(S,F)):this}jumpTo(m,S){this.stop();const F=m.preloadOnly?this.transform.clone():this.transform;let X=!1,$=!1,ot=!1;return"zoom"in m&&F.zoom!==+m.zoom&&(X=!0,F.zoom=+m.zoom),m.center!==void 0&&(F.center=r.LngLat.convert(m.center)),"bearing"in m&&F.bearing!==+m.bearing&&($=!0,F.bearing=+m.bearing),"pitch"in m&&F.pitch!==+m.pitch&&(ot=!0,F.pitch=+m.pitch),m.padding==null||F.isPaddingEqual(m.padding)||(F.padding=m.padding),m.preloadOnly?(this._preloadTiles(F),this):(this.fire(new r.Event("movestart",S)).fire(new r.Event("move",S)),X&&this.fire(new r.Event("zoomstart",S)).fire(new r.Event("zoom",S)).fire(new r.Event("zoomend",S)),$&&this.fire(new r.Event("rotatestart",S)).fire(new r.Event("rotate",S)).fire(new r.Event("rotateend",S)),ot&&this.fire(new r.Event("pitchstart",S)).fire(new r.Event("pitch",S)).fire(new r.Event("pitchend",S)),this.fire(new r.Event("moveend",S)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.warnOnce(Ch),this.transform.getFreeCameraOptions()}setFreeCameraOptions(m,S){const F=this.transform;if(!F.projection.supportsFreeCamera)return r.warnOnce(Ch),this;this.stop();const X=F.zoom,$=F.pitch,ot=F.bearing;F.setFreeCameraOptions(m);const ct=X!==F.zoom,yt=$!==F.pitch,xt=ot!==F.bearing;return this.fire(new r.Event("movestart",S)).fire(new r.Event("move",S)),ct&&this.fire(new r.Event("zoomstart",S)).fire(new r.Event("zoom",S)).fire(new r.Event("zoomend",S)),xt&&this.fire(new r.Event("rotatestart",S)).fire(new r.Event("rotate",S)).fire(new r.Event("rotateend",S)),yt&&this.fire(new r.Event("pitchstart",S)).fire(new r.Event("pitch",S)).fire(new r.Event("pitchend",S)),this.fire(new r.Event("moveend",S)),this}easeTo(m,S){this._stop(!1,m.easeId),((m=r.extend({offset:[0,0],duration:500,easing:r.ease},m)).animate===!1||!m.essential&&r.exported.prefersReducedMotion)&&(m.duration=0);const F=this.transform,X=this.getZoom(),$=this.getBearing(),ot=this.getPitch(),ct=this.getPadding(),yt="zoom"in m?+m.zoom:X,xt="bearing"in m?this._normalizeBearing(m.bearing,$):$,Mt="pitch"in m?+m.pitch:ot,Pt="padding"in m?m.padding:F.padding,Nt=r.pointGeometry.convert(m.offset);let Ht,Ut,Bt;if(F.projection.name==="globe"){const je=r.MercatorCoordinate.fromLngLat(F.center),Ne=Nt.rotate(-F.angle);je.x+=Ne.x/F.worldSize,je.y+=Ne.y/F.worldSize;const cn=je.toLngLat(),Se=r.LngLat.convert(m.center||cn);this._normalizeCenter(Se),Ht=F.centerPoint.add(Ne),Ut=new r.pointGeometry(je.x,je.y).mult(F.worldSize),Bt=new r.pointGeometry(r.mercatorXfromLng(Se.lng),r.mercatorYfromLat(Se.lat)).mult(F.worldSize).sub(Ut)}else{Ht=F.centerPoint.add(Nt);const je=F.pointLocation(Ht),Ne=r.LngLat.convert(m.center||je);this._normalizeCenter(Ne),Ut=F.project(je),Bt=F.project(Ne).sub(Ut)}const ae=F.zoomScale(yt-X);let Jt,ie;m.around&&(Jt=r.LngLat.convert(m.around),ie=F.locationPoint(Jt));const se=this._zooming||yt!==X,ce=this._rotating||$!==xt,ne=this._pitching||Mt!==ot,de=!F.isPaddingEqual(Pt),Ae=je=>Ne=>{if(se&&(je.zoom=r.number(X,yt,Ne)),ce&&(je.bearing=r.number($,xt,Ne)),ne&&(je.pitch=r.number(ot,Mt,Ne)),de&&(je.interpolatePadding(ct,Pt,Ne),Ht=je.centerPoint.add(Nt)),Jt)je.setLocationAtPoint(Jt,ie);else{const cn=je.zoomScale(je.zoom-X),Se=yt>X?Math.min(2,ae):Math.max(.5,ae),un=Math.pow(Se,1-Ne),rn=je.unproject(Ut.add(Bt.mult(Ne*un)).mult(cn));je.setLocationAtPoint(je.renderWorldCopies?rn.wrap():rn,Ht)}return m.preloadOnly||this._fireMoveEvents(S),je};if(m.preloadOnly){const je=this._emulate(Ae,m.duration,F);return this._preloadTiles(je),this}const Re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=se,this._rotating=ce,this._pitching=ne,this._padding=de,this._easeId=m.easeId,this._prepareEase(S,m.noMoveStart,Re),this._ease(Ae(F),je=>{F.recenterOnTerrain(),this._afterEase(S,je)},m),this}_prepareEase(m,S,F={}){this._moving=!0,this.transform.cameraElevationReference="sea",S||F.moving||this.fire(new r.Event("movestart",m)),this._zooming&&!F.zooming&&this.fire(new r.Event("zoomstart",m)),this._rotating&&!F.rotating&&this.fire(new r.Event("rotatestart",m)),this._pitching&&!F.pitching&&this.fire(new r.Event("pitchstart",m))}_fireMoveEvents(m){this.fire(new r.Event("move",m)),this._zooming&&this.fire(new r.Event("zoom",m)),this._rotating&&this.fire(new r.Event("rotate",m)),this._pitching&&this.fire(new r.Event("pitch",m))}_afterEase(m,S){if(this._easeId&&S&&this._easeId===S)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const F=this._zooming,X=this._rotating,$=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,F&&this.fire(new r.Event("zoomend",m)),X&&this.fire(new r.Event("rotateend",m)),$&&this.fire(new r.Event("pitchend",m)),this.fire(new r.Event("moveend",m))}flyTo(m,S){if(!m.essential&&r.exported.prefersReducedMotion){const Mn=r.pick(m,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Mn,S)}this.stop(),m=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},m);const F=this.transform,X=this.getZoom(),$=this.getBearing(),ot=this.getPitch(),ct=this.getPadding(),yt="zoom"in m?r.clamp(+m.zoom,F.minZoom,F.maxZoom):X,xt="bearing"in m?this._normalizeBearing(m.bearing,$):$,Mt="pitch"in m?+m.pitch:ot,Pt="padding"in m?m.padding:F.padding,Nt=F.zoomScale(yt-X),Ht=r.pointGeometry.convert(m.offset);let Ut=F.centerPoint.add(Ht);const Bt=F.pointLocation(Ut),ae=r.LngLat.convert(m.center||Bt);this._normalizeCenter(ae);const Jt=F.project(Bt),ie=F.project(ae).sub(Jt);let se=m.curve;const ce=Math.max(F.width,F.height),ne=ce/Nt,de=ie.mag();if("minZoom"in m){const Mn=r.clamp(Math.min(m.minZoom,X,yt),F.minZoom,F.maxZoom),An=ce/F.zoomScale(Mn-X);se=Math.sqrt(An/de*2)}const Ae=se*se;function Re(Mn){const An=(ne*ne-ce*ce+(Mn?-1:1)*Ae*Ae*de*de)/(2*(Mn?ne:ce)*Ae*de);return Math.log(Math.sqrt(An*An+1)-An)}function je(Mn){return(Math.exp(Mn)-Math.exp(-Mn))/2}function Ne(Mn){return(Math.exp(Mn)+Math.exp(-Mn))/2}const cn=Re(0);let Se=function(Mn){return Ne(cn)/Ne(cn+se*Mn)},un=function(Mn){return ce*((Ne(cn)*(je(An=cn+se*Mn)/Ne(An))-je(cn))/Ae)/de;var An},rn=(Re(1)-cn)/se;if(Math.abs(de)<1e-6||!isFinite(rn)){if(Math.abs(ce-ne)<1e-6)return this.easeTo(m,S);const Mn=ne<ce?-1:1;rn=Math.abs(Math.log(ne/ce))/se,un=function(){return 0},Se=function(An){return Math.exp(Mn*se*An)}}m.duration="duration"in m?+m.duration:1e3*rn/("screenSpeed"in m?+m.screenSpeed/se:+m.speed),m.maxDuration&&m.duration>m.maxDuration&&(m.duration=0);const En=$!==xt,He=Mt!==ot,_n=!F.isPaddingEqual(Pt),Fn=Mn=>An=>{const Vn=An*rn,ir=1/Se(Vn);Mn.zoom=An===1?yt:X+Mn.scaleZoom(ir),En&&(Mn.bearing=r.number($,xt,An)),He&&(Mn.pitch=r.number(ot,Mt,An)),_n&&(Mn.interpolatePadding(ct,Pt,An),Ut=Mn.centerPoint.add(Ht));const Bn=An===1?ae:Mn.unproject(Jt.add(ie.mult(un(Vn))).mult(ir));return Mn.setLocationAtPoint(Mn.renderWorldCopies?Bn.wrap():Bn,Ut),Mn._updateCameraOnTerrain(),m.preloadOnly||this._fireMoveEvents(S),Mn};if(m.preloadOnly){const Mn=this._emulate(Fn,m.duration,F);return this._preloadTiles(Mn),this}return this._zooming=!0,this._rotating=En,this._pitching=He,this._padding=_n,this._prepareEase(S,!1),this._ease(Fn(F),()=>this._afterEase(S),m),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(m,S){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const F=this._onEaseEnd;this._onEaseEnd=void 0,F.call(this,S)}if(!m){const F=this.handlers;F&&F.stop(!1)}return this}_ease(m,S,F){F.animate===!1||F.duration===0?(m(1),S()):(this._easeStart=r.exported.now(),this._easeOptions=F,this._onEaseFrame=m,this._onEaseEnd=S,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const m=Math.min((r.exported.now()-this._easeStart)/this._easeOptions.duration,1),S=this._onEaseFrame;S&&S(this._easeOptions.easing(m)),m<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(m,S){m=r.wrap(m,-180,180);const F=Math.abs(m-S);return Math.abs(m-360-S)<F&&(m-=360),Math.abs(m+360-S)<F&&(m+=360),m}_normalizeCenter(m){const S=this.transform;if(!S.renderWorldCopies||S.maxBounds)return;const F=m.lng-S.center.lng;m.lng+=F>180?-360:F<-180?360:0}_emulate(m,S,F){const X=Math.ceil(15*S/1e3),$=[],ot=m(F.clone());for(let ct=0;ct<=X;ct++){const yt=ot(ct/X);$.push(yt.clone())}return $}}class Ph{constructor(m={}){this.options=m,r.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(m){const S=this.options&&this.options.compact;return this._map=m,this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=d("button","mapboxgl-ctrl-attrib-button",this._container),d("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=d("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),S&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),S===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(m,S){const F=this._map._getUIString(`AttributionControl.${S}`);m.setAttribute("aria-label",F),m.removeAttribute("title"),m.firstElementChild&&m.firstElementChild.setAttribute("title",F)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let m=this._editLink;m||(m=this._editLink=this._container.querySelector(".mapbox-improve-map"));const S=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(m){const F=S.reduce((X,$,ot)=>($.value&&(X+=`${$.key}=${$.value}${ot<S.length-1?"&":""}`),X),"?");m.href=`${r.config.FEEDBACK_URL}/${F}${this._map._hash?this._map._hash.getHashString(!0):""}`,m.rel="noopener nofollow",this._setElementTitle(m,"MapFeedback")}}_updateData(m){!m||m.sourceDataType!=="metadata"&&m.sourceDataType!=="visibility"&&m.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let m=[];if(this._map.style.stylesheet){const X=this._map.style.stylesheet;this.styleOwner=X.owner,this.styleId=X.id}const S=this._map.style._sourceCaches;for(const X in S){const $=S[X];if($.used){const ot=$.getSource();ot.attribution&&m.indexOf(ot.attribution)<0&&m.push(ot.attribution)}}m.sort((X,$)=>X.length-$.length),m=m.filter((X,$)=>{for(let ot=$+1;ot<m.length;ot++)if(m[ot].indexOf(X)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?m=[...this.options.customAttribution,...m]:m.unshift(this.options.customAttribution));const F=m.join(" | ");F!==this._attribHTML&&(this._attribHTML=F,m.length?(this._innerContainer.innerHTML=F,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class B0{constructor(){r.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(m){this._map=m,this._container=d("div","mapboxgl-ctrl");const S=d("a","mapboxgl-ctrl-logo");return S.target="_blank",S.rel="noopener nofollow",S.href="https://www.mapbox.com/",S.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),S.setAttribute("rel","noopener nofollow"),this._container.appendChild(S),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(m){m&&m.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const m=this._map.style._sourceCaches;if(Object.entries(m).length===0)return!0;for(const S in m){const F=m[S].getSource();if(F.hasOwnProperty("mapbox_logo")&&!F.mapbox_logo)return!1}return!0}_updateCompact(){const m=this._container.children;if(m.length){const S=m[0];this._map.getCanvasContainer().offsetWidth<250?S.classList.add("mapboxgl-compact"):S.classList.remove("mapboxgl-compact")}}}class F0{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(m){const S=++this._id;return this._queue.push({callback:m,id:S,cancelled:!1}),S}remove(m){const S=this._currentlyRunning,F=S?this._queue.concat(S):this._queue;for(const X of F)if(X.id===m)return void(X.cancelled=!0)}run(m=0){const S=this._currentlyRunning=this._queue;this._queue=[];for(const F of S)if(!F.cancelled&&(F.callback(m),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Dh(P,m,S){if(P=new r.LngLat(P.lng,P.lat),m){const F=new r.LngLat(P.lng-360,P.lat),X=new r.LngLat(P.lng+360,P.lat),$=360*Math.ceil(Math.abs(P.lng-S.center.lng)/360),ot=S.locationPoint(P).distSqr(m),ct=m.x<0||m.y<0||m.x>S.width||m.y>S.height;S.locationPoint(F).distSqr(m)<ot&&(ct||Math.abs(F.lng-S.center.lng)<$)?P=F:S.locationPoint(X).distSqr(m)<ot&&(ct||Math.abs(X.lng-S.center.lng)<$)&&(P=X)}for(;Math.abs(P.lng-S.center.lng)>180;){const F=S.locationPoint(P);if(F.x>=0&&F.y>=0&&F.x<=S.width&&F.y<=S.height)break;P.lng>S.center.lng?P.lng-=360:P.lng+=360}return P}const Rh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class kh extends r.Evented{constructor(m,S){if(super(),(m instanceof r.window.HTMLElement||S)&&(m=r.extend({element:m},S)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=m&&m.anchor||"center",this._color=m&&m.color||"#3FB1CE",this._scale=m&&m.scale||1,this._draggable=m&&m.draggable||!1,this._clickTolerance=m&&m.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=m&&m.rotation||0,this._rotationAlignment=m&&m.rotationAlignment||"auto",this._pitchAlignment=m&&m.pitchAlignment&&m.pitchAlignment!=="auto"?m.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),m&&m.element)this._element=m.element,this._offset=r.pointGeometry.convert(m&&m.offset||[0,0]);else{this._defaultMarker=!0,this._element=d("div");const X=41,$=27,ot=p("svg",{display:"block",height:X*this._scale+"px",width:$*this._scale+"px",viewBox:`0 0 ${$} ${X}`},this._element),ct=p("radialGradient",{id:"shadowGradient"},p("defs",{},ot));p("stop",{offset:"10%","stop-opacity":.4},ct),p("stop",{offset:"100%","stop-opacity":.05},ct),p("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},ot),p("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},ot),p("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},ot),p("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},ot),this._offset=r.pointGeometry.convert(m&&m.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",X=>{X.preventDefault()}),this._element.addEventListener("mousedown",X=>{X.preventDefault()});const F=this._element.classList;for(const X in Rh)F.remove(`mapboxgl-marker-anchor-${X}`);F.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(m){return m===this._map||(this.remove(),this._map=m,m.getCanvasContainer().appendChild(this._element),m.on("move",this._updateMoving),m.on("moveend",this._update),m.on("remove",this._clearFadeTimer),m._addMarker(this),this.setDraggable(this._draggable),this._update(),m.on("click",this._onMapClick)),this}remove(){const m=this._map;return m&&(m.off("click",this._onMapClick),m.off("move",this._updateMoving),m.off("moveend",this._update),m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler),m.off("mouseup",this._onUp),m.off("touchend",this._onUp),m.off("mousemove",this._onMove),m.off("touchmove",this._onMove),m.off("remove",this._clearFadeTimer),m._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=r.LngLat.convert(m),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(m){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),m){if(!("offset"in m.options)){const X=Math.sqrt(Math.pow(13.5,2)/2);m.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[X,-1*(38.1-13.5+X)],"bottom-right":[-X,-1*(38.1-13.5+X)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=m,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(m){const S=m.code,F=m.charCode||m.keyCode;S!=="Space"&&S!=="Enter"&&F!==32&&F!==13||this.togglePopup()}_onMapClick(m){const S=m.originalEvent.target,F=this._element;this._popup&&(S===F||F.contains(S))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const m=this._popup;return m?(m.isOpen()?(m.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(m.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const m=this._map;if(!m)return;const S=this._pos;if(!S||S.x<0||S.x>m.transform.width||S.y<0||S.y>m.transform.height)return void this._clearFadeTimer();const F=m.unproject(S);let X=!1;if(m.transform._terrainEnabled()&&m.getTerrain()){const ot=m.getFreeCameraOptions();if(ot.position){const ct=ot.position.toLngLat();X=ct.distanceTo(F)<.9*ct.distanceTo(this._lngLat)}}const $=(1-m._queryFogOpacity(F))*(X?.2:1);this._element.style.opacity=`${$}`,this._popup&&this._popup._setOpacity(`${$}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const m=this._pos;if(!m)return;const S=this._offset.mult(this._scale),F=this._calculatePitch(),X=this._calculateRotation();this._element.style.transform=`
            translate(${m.x}px, ${m.y}px) ${Rh[this._anchor]}
            rotateX(${F}deg) rotateZ(${X}deg)
            translate(${S.x}px, ${S.y}px)
        `}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._map&&this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._map&&this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(m){r.window.cancelAnimationFrame(this._updateFrameId);const S=this._map;S&&(S.transform.renderWorldCopies&&(this._lngLat=Dh(this._lngLat,this._pos,S.transform)),this._pos=S.project(this._lngLat),m===!0?this._updateFrameId=r.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),S._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!S.getTerrain()&&!S.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(m){return this._offset=r.pointGeometry.convert(m),this._update(),this}_onMove(m){const S=this._map;if(S){if(!this._isDragging){const F=this._clickTolerance||S._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=F}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=S.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const m=this._map;m&&(m.off("mousemove",this._onMove),m.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.Event("dragend")),this._state="inactive"}_addDragHandler(m){const S=this._map;S&&this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos),this._pointerdownPos=m.point,this._state="pending",S.on("mousemove",this._onMove),S.on("touchmove",this._onMove),S.once("mouseup",this._onUp),S.once("touchend",this._onUp))}setDraggable(m){this._draggable=!!m;const S=this._map;return S&&(m?(S.on("mousedown",this._addDragHandler),S.on("touchstart",this._addDragHandler)):(S.off("mousedown",this._addDragHandler),S.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(m){return this._rotation=m||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(m){return this._rotationAlignment=m||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(m){return this._pitchAlignment=m&&m!=="auto"?m:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Zb{constructor(m){this.jumpTo(m)}getValue(m){if(m<=this._startTime)return this._start;if(m>=this._endTime)return this._end;const S=r.easeCubicInOut((m-this._startTime)/(this._endTime-this._startTime));return this._start*(1-S)+this._end*S}isEasing(m){return m>=this._startTime&&m<=this._endTime}jumpTo(m){this._startTime=-1/0,this._endTime=-1/0,this._start=m,this._end=m}easeTo(m,S,F){this._start=this.getValue(S),this._end=m,this._startTime=S,this._endTime=S+F}}const Jb={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},np={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Lc(P){P.parentNode&&P.parentNode.removeChild(P)}const rp={showCompass:!0,showZoom:!0,visualizePitch:!1};class ip{constructor(m,S,F=!1){this._clickTolerance=10,this.element=S,this.mouseRotate=new ml({clickTolerance:m.dragRotate._mouseRotate._clickTolerance}),this.map=m,F&&(this.mousePitch=new Kf({clickTolerance:m.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),S.addEventListener("mousedown",this.mousedown),S.addEventListener("touchstart",this.touchstart,{passive:!1}),S.addEventListener("touchmove",this.touchmove),S.addEventListener("touchend",this.touchend),S.addEventListener("touchcancel",this.reset)}down(m,S){this.mouseRotate.mousedown(m,S),this.mousePitch&&this.mousePitch.mousedown(m,S),w()}move(m,S){const F=this.map,X=this.mouseRotate.mousemoveWindow(m,S),$=X&&X.bearingDelta;if($&&F.setBearing(F.getBearing()+$),this.mousePitch){const ot=this.mousePitch.mousemoveWindow(m,S),ct=ot&&ot.pitchDelta;ct&&F.setPitch(F.getPitch()+ct)}}off(){const m=this.element;m.removeEventListener("mousedown",this.mousedown),m.removeEventListener("touchstart",this.touchstart,{passive:!1}),m.removeEventListener("touchmove",this.touchmove),m.removeEventListener("touchend",this.touchend),m.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){M(),r.window.removeEventListener("mousemove",this.mousemove),r.window.removeEventListener("mouseup",this.mouseup)}mousedown(m){this.down(r.extend({},m,{ctrlKey:!0,preventDefault:()=>m.preventDefault()}),N(this.element,m)),r.window.addEventListener("mousemove",this.mousemove),r.window.addEventListener("mouseup",this.mouseup)}mousemove(m){this.move(m,N(this.element,m))}mouseup(m){this.mouseRotate.mouseupWindow(m),this.mousePitch&&this.mousePitch.mouseupWindow(m),this.offTemp()}touchstart(m){m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V(this.element,m.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>m.preventDefault()},this._startPos))}touchmove(m){m.targetTouches.length!==1?this.reset():(this._lastPos=V(this.element,m.targetTouches)[0],this.move({preventDefault:()=>m.preventDefault()},this._lastPos))}touchend(m){m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Xi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let ao,Bc=0,Pa=!1;const op={maxWidth:100,unit:"metric"};function Ih(P,m,S){const F=S&&S.maxWidth||100,X=P._containerHeight/2,$=P._containerWidth/2-F/2,ot=P.unproject([$,X]),ct=P.unproject([$+F,X]),yt=ot.distanceTo(ct);if(S&&S.unit==="imperial"){const xt=3.2808*yt;xt>5280?yl(m,F,xt/5280,P._getUIString("ScaleControl.Miles"),P):yl(m,F,xt,P._getUIString("ScaleControl.Feet"),P)}else S&&S.unit==="nautical"?yl(m,F,yt/1852,P._getUIString("ScaleControl.NauticalMiles"),P):yt>=1e3?yl(m,F,yt/1e3,P._getUIString("ScaleControl.Kilometers"),P):yl(m,F,yt,P._getUIString("ScaleControl.Meters"),P)}function yl(P,m,S,F,X){const $=function(ct){const yt=Math.pow(10,`${Math.floor(ct)}`.length-1);let xt=ct/yt;return xt=xt>=10?10:xt>=5?5:xt>=3?3:xt>=2?2:xt>=1?1:function(Mt){const Pt=Math.pow(10,Math.ceil(-Math.log(Mt)/Math.LN10));return Math.round(Mt*Pt)/Pt}(xt),yt*xt}(S),ot=$/S;X._requestDomTask(()=>{P.style.width=m*ot+"px",P.innerHTML=`${$}&nbsp;${F}`})}const So={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Dr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Fc(P=new r.pointGeometry(0,0),m="bottom"){if(typeof P=="number"){const S=Math.round(Math.sqrt(.5*Math.pow(P,2)));switch(m){case"top":return new r.pointGeometry(0,P);case"top-left":return new r.pointGeometry(S,S);case"top-right":return new r.pointGeometry(-S,S);case"bottom":return new r.pointGeometry(0,-P);case"bottom-left":return new r.pointGeometry(S,-S);case"bottom-right":return new r.pointGeometry(-S,-S);case"left":return new r.pointGeometry(P,0);case"right":return new r.pointGeometry(-P,0)}return new r.pointGeometry(0,0)}return P instanceof r.pointGeometry||Array.isArray(P)?r.pointGeometry.convert(P):r.pointGeometry.convert(P[m]||[0,0])}const bl={version:r.version,supported:u,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:class extends ep{constructor(P){if((P=r.extend({},np,P)).minZoom!=null&&P.maxZoom!=null&&P.minZoom>P.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(P.minPitch!=null&&P.maxPitch!=null&&P.minPitch>P.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(P.minPitch!=null&&P.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(P.maxPitch!=null&&P.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(P.antialias&&r.isSafariWithAntialiasingBug(r.window)&&(P.antialias=!1,r.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Mh(P.minZoom,P.maxZoom,P.minPitch,P.maxPitch,P.renderWorldCopies),P),this._interactive=P.interactive,this._minTileCacheSize=P.minTileCacheSize,this._maxTileCacheSize=P.maxTileCacheSize,this._failIfMajorPerformanceCaveat=P.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=P.preserveDrawingBuffer,this._antialias=P.antialias,this._trackResize=P.trackResize,this._bearingSnap=P.bearingSnap,this._refreshExpiredTiles=P.refreshExpiredTiles,this._fadeDuration=P.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=P.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=P.collectResourceTiming,this._optimizeForTerrain=P.optimizeForTerrain,this._renderTaskQueue=new F0,this._domRenderTaskQueue=new F0,this._controls=[],this._markers=[],this._mapId=r.uniqueId(),this._locale=r.extend({},Jb,P.locale),this._clickTolerance=P.clickTolerance,this._cooperativeGestures=P.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Zb(0),this._explicitProjection=null,this._requestManager=new r.RequestManager(P.transformRequest,P.accessToken,P.testMode),this._silenceAuthErrors=!!P.testMode,typeof P.container=="string"){if(this._container=r.window.document.getElementById(P.container),!this._container)throw new Error(`Container '${P.container}' not found.`)}else{if(!(P.container instanceof r.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=P.container}if(this._container.childNodes.length>0&&r.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),P.maxBounds&&this.setMaxBounds(P.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),r.window!==void 0&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1),r.window.addEventListener("orientationchange",this._onWindowResize,!1),r.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new L0(this,P),this._localFontFamily=P.localFontFamily,this._localIdeographFontFamily=P.localIdeographFontFamily,P.style&&this.setStyle(P.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),P.projection&&this.setProjection(P.projection),this._hash=P.hash&&new p0(typeof P.hash=="string"&&P.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:P.center,zoom:P.zoom,bearing:P.bearing,pitch:P.pitch}),P.bounds&&(this.resize(),this.fitBounds(P.bounds,r.extend({},P.fitBoundsOptions,{duration:0})))),this.resize(),P.attributionControl&&this.addControl(new Ph({customAttribution:P.customAttribution})),this._logoControl=new B0,this.addControl(this._logoControl,P.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",m=>{this._update(m.dataType==="style"),this.fire(new r.Event(`${m.dataType}data`,m))}),this.on("dataloading",m=>{this.fire(new r.Event(`${m.dataType}dataloading`,m))})}_getMapId(){return this._mapId}addControl(P,m){if(m===void 0&&(m=P.getDefaultPosition?P.getDefaultPosition():"top-right"),!P||!P.onAdd)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const S=P.onAdd(this);this._controls.push(P);const F=this._controlPositions[m];return m.indexOf("bottom")!==-1?F.insertBefore(S,F.firstChild):F.appendChild(S),this}removeControl(P){if(!P||!P.onRemove)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const m=this._controls.indexOf(P);return m>-1&&this._controls.splice(m,1),P.onRemove(this),this}hasControl(P){return this._controls.indexOf(P)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(P){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const m=!this._moving;return m&&this.fire(new r.Event("movestart",P)).fire(new r.Event("move",P)),this.fire(new r.Event("resize",P)),m&&this.fire(new r.Event("moveend",P)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(P){return this.transform.setMaxBounds(r.LngLatBounds.convert(P)),this._update()}setMinZoom(P){if((P=P==null?-2:P)>=-2&&P<=this.transform.maxZoom)return this.transform.minZoom=P,this._update(),this.getZoom()<P?this.setZoom(P):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(P){if((P=P==null?22:P)>=this.transform.minZoom)return this.transform.maxZoom=P,this._update(),this.getZoom()>P?this.setZoom(P):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(P){if((P=P==null?0:P)<0)throw new Error("minPitch must be greater than or equal to 0");if(P>=0&&P<=this.transform.maxPitch)return this.transform.minPitch=P,this._update(),this.getPitch()<P?this.setPitch(P):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(P){if((P=P==null?85:P)>85)throw new Error("maxPitch must be less than or equal to 85");if(P>=this.transform.minPitch)return this.transform.maxPitch=P,this._update(),this.getPitch()>P?this.setPitch(P):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(P){return this.transform.renderWorldCopies=P,this._update()}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}setProjection(P){return this._lazyInitEmptyStyle(),P?typeof P=="string"&&(P={name:P}):P=null,this._updateProjection(P)}_updateProjection(P){P===null&&(this._explicitProjection=null);const m=P||this.getProjection(),S=this.transform.setProjection(m);if(P&&(this._explicitProjection=this.transform.getProjection()),S){this.painter.clearBackgroundTiles();for(const F in this.style._sourceCaches)this.style._sourceCaches[F].clearTiles();this.style.applyProjectionUpdate(),this._update(!0)}return this}project(P){return this.transform.locationPoint3D(r.LngLat.convert(P))}unproject(P){return this.transform.pointLocation3D(r.pointGeometry.convert(P))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(P,m,S){if(P==="mouseenter"||P==="mouseover"){let F=!1;const X=ot=>{const ct=m.filter(xt=>this.getLayer(xt)),yt=ct.length?this.queryRenderedFeatures(ot.point,{layers:ct}):[];yt.length?F||(F=!0,S.call(this,new so(P,this,ot.originalEvent,{features:yt}))):F=!1},$=()=>{F=!1};return{layers:new Set(m),listener:S,delegates:{mousemove:X,mouseout:$}}}if(P==="mouseleave"||P==="mouseout"){let F=!1;const X=ot=>{const ct=m.filter(yt=>this.getLayer(yt));(ct.length?this.queryRenderedFeatures(ot.point,{layers:ct}):[]).length?F=!0:F&&(F=!1,S.call(this,new so(P,this,ot.originalEvent)))},$=ot=>{F&&(F=!1,S.call(this,new so(P,this,ot.originalEvent)))};return{layers:new Set(m),listener:S,delegates:{mousemove:X,mouseout:$}}}{const F=X=>{const $=m.filter(ct=>this.getLayer(ct)),ot=$.length?this.queryRenderedFeatures(X.point,{layers:$}):[];ot.length&&(X.features=ot,S.call(this,X),delete X.features)};return{layers:new Set(m),listener:S,delegates:{[P]:F}}}}on(P,m,S){if(S===void 0)return super.on(P,m);Array.isArray(m)||(m=[m]);const F=this._createDelegatedListener(P,m,S);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[P]=this._delegatedListeners[P]||[],this._delegatedListeners[P].push(F);for(const X in F.delegates)this.on(X,F.delegates[X]);return this}once(P,m,S){if(S===void 0)return super.once(P,m);Array.isArray(m)||(m=[m]);const F=this._createDelegatedListener(P,m,S);for(const X in F.delegates)this.once(X,F.delegates[X]);return this}off(P,m,S){if(S===void 0)return super.off(P,m);m=new Set(Array.isArray(m)?m:[m]);const F=($,ot)=>{if($.size!==ot.size)return!1;for(const ct of $)if(!ot.has(ct))return!1;return!0},X=this._delegatedListeners?this._delegatedListeners[P]:void 0;return X&&($=>{for(let ot=0;ot<$.length;ot++){const ct=$[ot];if(ct.listener===S&&F(ct.layers,m)){for(const yt in ct.delegates)this.off(yt,ct.delegates[yt]);return $.splice(ot,1),this}}})(X),this}queryRenderedFeatures(P,m){return this.style?(m!==void 0||P===void 0||P instanceof r.pointGeometry||Array.isArray(P)||(m=P,P=void 0),this.style.queryRenderedFeatures(P=P||[[0,0],[this.transform.width,this.transform.height]],m=m||{},this.transform)):[]}querySourceFeatures(P,m){return this.style.querySourceFeatures(P,m)}queryTerrainElevation(P,m){const S=this.transform.elevation;return S?(m=r.extend({},{exaggerated:!0},m),S.getAtPoint(r.MercatorCoordinate.fromLngLat(P),null,m.exaggerated)):null}setStyle(P,m){return(m=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},m)).diff!==!1&&m.localIdeographFontFamily===this._localIdeographFontFamily&&m.localFontFamily===this._localFontFamily&&this.style&&P?(this._diffStyle(P,m),this):(this._localIdeographFontFamily=m.localIdeographFontFamily,this._localFontFamily=m.localFontFamily,this._updateStyle(P,m))}_getUIString(P){const m=this._locale[P];if(m==null)throw new Error(`Missing UI string '${P}'`);return m}_updateStyle(P,m){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),P&&(this.style=new qi(this,m||{}),this.style.setEventedParent(this,{style:this.style}),typeof P=="string"?this.style.loadURL(P):this.style.loadJSON(P)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new qi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(P,m){if(typeof P=="string"){const S=this._requestManager.normalizeStyleURL(P),F=this._requestManager.transformRequest(S,r.ResourceType.Style);r.getJSON(F,(X,$)=>{X?this.fire(new r.ErrorEvent(X)):$&&this._updateDiff($,m)})}else typeof P=="object"&&this._updateDiff(P,m)}_updateDiff(P,m){try{this.style.setState(P)&&this._update(!0)}catch(S){r.warnOnce(`Unable to perform style diff: ${S.message||S.error||S}.  Rebuilding the style from scratch.`),this._updateStyle(P,m)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.warnOnce("There is no style added to the map."),!1)}addSource(P,m){return this._lazyInitEmptyStyle(),this.style.addSource(P,m),this._update(!0)}isSourceLoaded(P){return!!this.style&&this.style._isSourceCacheLoaded(P)}areTilesLoaded(){const P=this.style&&this.style._sourceCaches;for(const m in P){const S=P[m]._tiles;for(const F in S){const X=S[F];if(X.state!=="loaded"&&X.state!=="errored")return!1}}return!0}addSourceType(P,m,S){this._lazyInitEmptyStyle(),this.style.addSourceType(P,m,S)}removeSource(P){return this.style.removeSource(P),this._updateTerrain(),this._update(!0)}getSource(P){return this.style.getSource(P)}addImage(P,m,{pixelRatio:S=1,sdf:F=!1,stretchX:X,stretchY:$,content:ot}={}){if(this._lazyInitEmptyStyle(),m instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&m instanceof r.window.ImageBitmap){const{width:ct,height:yt,data:xt}=r.exported.getImageData(m);this.style.addImage(P,{data:new r.RGBAImage({width:ct,height:yt},xt),pixelRatio:S,stretchX:X,stretchY:$,content:ot,sdf:F,version:0})}else if(m.width===void 0||m.height===void 0)this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:ct,height:yt}=m,xt=m;this.style.addImage(P,{data:new r.RGBAImage({width:ct,height:yt},new Uint8Array(xt.data)),pixelRatio:S,stretchX:X,stretchY:$,content:ot,sdf:F,version:0,userImage:xt}),xt.onAdd&&xt.onAdd(this,P)}}updateImage(P,m){const S=this.style.getImage(P);if(!S)return void this.fire(new r.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const F=m instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&m instanceof r.window.ImageBitmap?r.exported.getImageData(m):m,{width:X,height:$}=F;X!==void 0&&$!==void 0?X===S.data.width&&$===S.data.height?(S.data.replace(F.data,!(m instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&m instanceof r.window.ImageBitmap)),this.style.updateImage(P,S)):this.fire(new r.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(P){return P?!!this.style.getImage(P):(this.fire(new r.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(P){this.style.removeImage(P)}loadImage(P,m){r.getImage(this._requestManager.transformRequest(P,r.ResourceType.Image),(S,F)=>{m(S,F instanceof r.window.HTMLImageElement?r.exported.getImageData(F):F)})}listImages(){return this.style.listImages()}addLayer(P,m){return this._lazyInitEmptyStyle(),this.style.addLayer(P,m),this._update(!0)}moveLayer(P,m){return this.style.moveLayer(P,m),this._update(!0)}removeLayer(P){return this.style.removeLayer(P),this._update(!0)}getLayer(P){return this.style.getLayer(P)}setLayerZoomRange(P,m,S){return this.style.setLayerZoomRange(P,m,S),this._update(!0)}setFilter(P,m,S={}){return this.style.setFilter(P,m,S),this._update(!0)}getFilter(P){return this.style.getFilter(P)}setPaintProperty(P,m,S,F={}){return this.style.setPaintProperty(P,m,S,F),this._update(!0)}getPaintProperty(P,m){return this.style.getPaintProperty(P,m)}setLayoutProperty(P,m,S,F={}){return this.style.setLayoutProperty(P,m,S,F),this._update(!0)}getLayoutProperty(P,m){return this.style.getLayoutProperty(P,m)}setLight(P,m={}){return this._lazyInitEmptyStyle(),this.style.setLight(P,m),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(P){return this._lazyInitEmptyStyle(),!P&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(P),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(P){return this._lazyInitEmptyStyle(),this.style.setFog(P),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(P){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.LngLat.convert(P),this.transform):0}setFeatureState(P,m){return this.style.setFeatureState(P,m),this._update()}removeFeatureState(P,m){return this.style.removeFeatureState(P,m),this._update()}getFeatureState(P){return this.style.getFeatureState(P)}_updateContainerDimensions(){if(!this._container)return;const P=this._container.getBoundingClientRect().width||400,m=this._container.getBoundingClientRect().height||300;let S,F,X,$=this._container;for(;$&&(!F||!X);){const ot=r.window.getComputedStyle($).transform;ot&&ot!=="none"&&(S=ot.match(/matrix.*\((.+)\)/)[1].split(", "),S[0]&&S[0]!=="0"&&S[0]!=="1"&&(F=S[0]),S[3]&&S[3]!=="0"&&S[3]!=="1"&&(X=S[3])),$=$.parentElement}this._containerWidth=F?Math.abs(P/F):P,this._containerHeight=X?Math.abs(m/X):m}_detectMissingCSS(){r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const P=this._container;P.classList.add("mapboxgl-map"),(this._missingCSSCanary=d("div","mapboxgl-canary",P)).style.visibility="hidden",this._detectMissingCSS();const m=this._canvasContainer=d("div","mapboxgl-canvas-container",P);this._interactive&&m.classList.add("mapboxgl-interactive"),this._canvas=d("canvas","mapboxgl-canvas",m),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const S=this._controlContainer=d("div","mapboxgl-control-container",P),F=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(X=>{F[X]=d("div",`mapboxgl-ctrl-${X}`,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(P,m){const S=r.exported.devicePixelRatio||1;this._canvas.width=S*Math.ceil(P),this._canvas.height=S*Math.ceil(m),this._canvas.style.width=`${P}px`,this._canvas.style.height=`${m}px`}_addMarker(P){this._markers.push(P)}_removeMarker(P){const m=this._markers.indexOf(P);m!==-1&&this._markers.splice(m,1)}_setupPainter(){const P=r.extend({},u.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),m=this._canvas.getContext("webgl",P)||this._canvas.getContext("experimental-webgl",P);m?(r.storeAuthState(m,!0),this.painter=new d0(m,this.transform),this.on("data",S=>{S.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.exported$1.testSupport(m)):this.fire(new r.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(P){P.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:P}))}_contextRestored(P){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:P}))}_onMapScroll(P){if(P.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(P){return this.style?(this._styleDirty=this._styleDirty||P,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(P){return this._update(),this._renderTaskQueue.add(P)}_cancelRenderFrame(P){this._renderTaskQueue.remove(P)}_requestDomTask(P){!this.loaded()||this.loaded()&&!this.isMoving()?P():this._domRenderTaskQueue.add(P)}_render(P){let m;const S=this.painter.context.extTimerQuery,F=r.exported.now();if(this.listens("gpu-timing-frame")&&(m=S.createQueryEXT(),S.beginQueryEXT(S.TIME_ELAPSED_EXT,m)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(P),this._domRenderTaskQueue.run(P),this._removed)return;let X=!1;const $=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const yt=this.transform.zoom,xt=this.transform.pitch,Mt=r.exported.now();this.style.zoomHistory.update(yt,Mt);const Pt=new r.EvaluationParameters(yt,{now:Mt,fadeDuration:$,pitch:xt,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Nt=Pt.crossFadingFactor();Nt===1&&Nt===this._crossFadingFactor||(X=!0,this._crossFadingFactor=Nt),this.style.update(Pt)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let ot=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),ot=this._updateAverageElevation(F),this.style._updateSources(this.transform),this._forceMarkerUpdate()):ot=this._updateAverageElevation(F),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,$,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:$,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&(this.style.hasTransitions()||X)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const yt=r.exported.now()-F;S.endQueryEXT(S.TIME_ELAPSED_EXT,m),setTimeout(()=>{const xt=S.getQueryObjectEXT(m,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(m),this.fire(new r.Event("gpu-timing-frame",{cpuTime:yt,gpuTime:xt}))},50)}if(this.listens("gpu-timing-layer")){const yt=this.painter.collectGpuTimers();setTimeout(()=>{const xt=this.painter.queryGpuTimers(yt);this.fire(new r.Event("gpu-timing-layer",{layerTimes:xt}))},50)}const ct=this._sourcesDirty||this._styleDirty||this._placementDirty||ot;if(ct||this._repaint)this.triggerRepaint();else{const yt=!this.isMoving()&&this.loaded();if(yt&&(ot=this._updateAverageElevation(F,!0)),ot)this.triggerRepaint();else if(this._triggerFrame(!1),yt&&(this.fire(new r.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const xt=this._calculateSpeedIndex();this.fire(new r.Event("speedindexcompleted",{speedIndex:xt})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||ct||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const P of this._markers)P._update()}_updateAverageElevation(P,m=!1){const S=F=>(this.transform.averageElevation=F,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&S(0);if((m||P-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(P)){const F=this.transform.averageElevation;let X=this.transform.sampleAverageElevation(),$=!1;this.transform.elevation&&($=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(X)?X=0:this._averageElevationLastSampledAt=P;const ot=Math.abs(F-X);if(ot>1){if(this._isInitialLoad||$)return this._averageElevation.jumpTo(X),S(X);this._averageElevation.easeTo(X,P,300)}else if(ot>1e-4)return this._averageElevation.jumpTo(X),S(X)}return!!this._averageElevation.isEasing(P)&&S(this._averageElevation.getValue(P))}_authenticate(){r.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,P=>{if(P&&(P.message===r.AUTH_ERR_MSG||P.status===401)){const m=this.painter.context.gl;r.storeAuthState(m,!1),this._logoControl instanceof B0&&this._logoControl._updateLogo(),m&&m.clear(m.DEPTH_BUFFER_BIT|m.COLOR_BUFFER_BIT|m.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),r.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const P=this.painter.canvasCopy(),m=this.painter.getCanvasCopiesAndTimestamps();m.timeStamps.push(performance.now());const S=this.painter.context.gl,F=S.createFramebuffer();function X($){S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_2D,$,0);const ot=new Uint8Array(S.drawingBufferWidth*S.drawingBufferHeight*4);return S.readPixels(0,0,S.drawingBufferWidth,S.drawingBufferHeight,S.RGBA,S.UNSIGNED_BYTE,ot),ot}return S.bindFramebuffer(S.FRAMEBUFFER,F),this._canvasPixelComparison(X(P),m.canvasCopies.map(X),m.timeStamps)}_canvasPixelComparison(P,m,S){let F=S[1]-S[0];const X=P.length/4;for(let $=0;$<m.length;$++){const ot=m[$];let ct=0;for(let yt=0;yt<ot.length;yt+=4)ot[yt]===P[yt]&&ot[yt+1]===P[yt+1]&&ot[yt+2]===P[yt+2]&&ot[yt+3]===P[yt+3]&&(ct+=1);F+=(S[$+2]-S[$+1])*(1-ct/X)}return F}remove(){this._hash&&this._hash.remove();for(const m of this._controls)m.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),r.window!==void 0&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("orientationchange",this._onWindowResize,!1),r.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1));const P=this.painter.context.gl.getExtension("WEBGL_lose_context");P&&P.loseContext(),Lc(this._canvasContainer),Lc(this._controlContainer),Lc(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),r.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new r.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(P){this._renderNextFrame=this._renderNextFrame||P,this.style&&!this._frame&&(this._frame=r.exported.frame(m=>{const S=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,S&&this._render(m)}))}_preloadTiles(P){const m=this.style?Object.values(this.style._sourceCaches):[];return r.asyncAll(m,(S,F)=>S._preloadTiles(P,F),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(P){this._trackResize&&this.resize({originalEvent:P})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(P){this._showTileBoundaries!==P&&(this._showTileBoundaries=P,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(P){this._showTerrainWireframe!==P&&(this._showTerrainWireframe=P,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(P){this._speedIndexTiming!==P&&(this._speedIndexTiming=P,this._update())}get showPadding(){return!!this._showPadding}set showPadding(P){this._showPadding!==P&&(this._showPadding=P,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(P){this._showCollisionBoxes!==P&&(this._showCollisionBoxes=P,P?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(P){this._showOverdrawInspector!==P&&(this._showOverdrawInspector=P,this._update())}get repaint(){return!!this._repaint}set repaint(P){this._repaint!==P&&(this._repaint=P,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(P){this._vertices=P,this._update()}_setCacheLimits(P,m){r.setCacheLimits(P,m)}get version(){return r.version}},NavigationControl:class{constructor(P){this.options=r.extend({},rp,P),this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",m=>m.preventDefault()),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",m=>{this._map&&this._map.zoomIn({},{originalEvent:m})}),d("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",m=>{this._map&&this._map.zoomOut({},{originalEvent:m})}),d("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",m=>{const S=this._map;S&&(this.options.visualizePitch?S.resetNorthPitch({},{originalEvent:m}):S.resetNorth({},{originalEvent:m}))}),this._compassIcon=d("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const P=this._map;if(!P)return;const m=P.getZoom(),S=m===P.getMaxZoom(),F=m===P.getMinZoom();this._zoomInButton.disabled=S,this._zoomOutButton.disabled=F,this._zoomInButton.setAttribute("aria-disabled",S.toString()),this._zoomOutButton.setAttribute("aria-disabled",F.toString())}_rotateCompassArrow(){const P=this._map;if(!P)return;const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(P.transform.pitch*(Math.PI/180)),.5)}) rotateX(${P.transform.pitch}deg) rotateZ(${P.transform.angle*(180/Math.PI)}deg)`:`rotate(${P.transform.angle*(180/Math.PI)}deg)`;P._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=m)})}onAdd(P){return this._map=P,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),P.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&P.on("pitch",this._rotateCompassArrow),P.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ip(P,this._compass,this.options.visualizePitch)),this._container}onRemove(){const P=this._map;P&&(this._container.remove(),this.options.showZoom&&P.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&P.off("pitch",this._rotateCompassArrow),P.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(P,m){const S=d("button",P,this._container);return S.type="button",S.addEventListener("click",m),S}_setButtonTitle(P,m){if(!this._map)return;const S=this._map._getUIString(`NavigationControl.${m}`);P.setAttribute("aria-label",S),P.firstElementChild&&P.firstElementChild.setAttribute("title",S)}},GeolocateControl:class extends r.Evented{constructor(P){super(),this.options=r.extend({},Xi,P),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Yf(this._updateMarkerRotation,20)}onAdd(P){var m;return this._map=P,this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,ao!==void 0?m(ao):r.window.navigator.permissions!==void 0?r.window.navigator.permissions.query({name:"geolocation"}).then(S=>{ao=S.state!=="denied",m(ao)}):(ao=!!r.window.navigator.geolocation,m(ao)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,Bc=0,Pa=!1}_isOutOfMapMaxBounds(P){const m=this._map.getMaxBounds(),S=P.coords;return!!m&&(S.longitude<m.getWest()||S.longitude>m.getEast()||S.latitude<m.getSouth()||S.latitude>m.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(P){if(this._map){if(this._isOutOfMapMaxBounds(P))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",P)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=P,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(P),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(P),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",P)),this._finish()}}_updateCamera(P){const m=new r.LngLat(P.coords.longitude,P.coords.latitude),S=P.coords.accuracy,F=this._map.getBearing(),X=r.extend({bearing:F},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(S),X,{geolocateSource:!0})}_updateMarker(P){if(P){const m=new r.LngLat(P.coords.longitude,P.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=P.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const P=this._map._containerHeight/2,m=this._map.unproject([0,P]),S=this._map.unproject([100,P]),F=m.distanceTo(S)/100,X=Math.ceil(2*this._accuracy/F);this._circleElement.style.width=`${X}px`,this._circleElement.style.height=`${X}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(P){if(this._map){if(this.options.trackUserLocation)if(P.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",m),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(P.code===3&&Pa)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",P)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(P){if(this._container.addEventListener("contextmenu",m=>m.preventDefault()),this._geolocateButton=d("button","mapboxgl-ctrl-geolocate",this._container),d("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",P===!1){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",m),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",m),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=d("div","mapboxgl-user-location"),this._dotElement.appendChild(d("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(d("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new kh({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=d("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new kh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",m=>{m.geolocateSource||this._watchState!=="ACTIVE_LOCK"||m.originalEvent&&m.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.Event("trackuserlocationend")))})}_onDeviceOrientation(P){this._userLocationDotMarker&&(P.webkitCompassHeading?this._heading=P.webkitCompassHeading:P.absolute===!0&&(this._heading=-1*P.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Bc--,Pa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let P;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Bc++,Bc>1?(P={maximumAge:6e5,timeout:0},Pa=!0):(P=this.options.positionOptions,Pa=!1),this._geolocationWatchID=r.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,P),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else r.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const P=()=>{r.window.addEventListener("ondeviceorientationabsolute"in r.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};r.window.DeviceMotionEvent!==void 0&&typeof r.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(m=>{m==="granted"&&P()}).catch(console.error):P()}_clearWatch(){r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ph,ScaleControl:class{constructor(P){this.options=r.extend({},op,P),r.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Ih(this._map,this._container,this.options)}onAdd(P){return this._map=P,this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-scale",P.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(P){this.options.unit=P,Ih(this._map,this._container,this.options)}},FullscreenControl:class{constructor(P){this._fullscreen=!1,P&&P.container&&(P.container instanceof r.window.HTMLElement?this._container=P.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in r.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(P){return this._map=P,this._container||(this._container=this._map.getContainer()),this._controlContainer=d("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!r.window.document.fullscreenEnabled&&!r.window.document.webkitFullscreenEnabled)}_setupUI(){const P=this._fullscreenButton=d("button","mapboxgl-ctrl-fullscreen",this._controlContainer);d("span","mapboxgl-ctrl-icon",P).setAttribute("aria-hidden","true"),P.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const P=this._getTitle();this._fullscreenButton.setAttribute("aria-label",P),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",P)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(r.window.document.fullscreenElement||r.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.Evented{constructor(P){super(),this.options=r.extend(Object.create(So),P),r.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(P&&P.className?P.className.trim().split(/\s+/):[])}addTo(P){return this._map&&this.remove(),this._map=P,this.options.closeOnClick&&P.on("preclick",this._onClose),this.options.closeOnMove&&P.on("move",this._onClose),P.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(P.on("mousemove",this._onMouseEvent),P.on("mouseup",this._onMouseEvent),P._canvasContainer.classList.add("mapboxgl-track-pointer")):P.on("move",this._update),this.fire(new r.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const P=this._map;return P&&(P.off("move",this._update),P.off("move",this._onClose),P.off("preclick",this._onClose),P.off("click",this._onClose),P.off("remove",this.remove),P.off("mousemove",this._onMouseEvent),P.off("mouseup",this._onMouseEvent),P.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new r.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(P){this._lngLat=r.LngLat.convert(P),this._pos=null,this._trackPointer=!1,this._update();const m=this._map;return m&&(m.on("move",this._update),m.off("mousemove",this._onMouseEvent),m._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const P=this._map;return P&&(P.off("move",this._update),P.on("mousemove",this._onMouseEvent),P.on("drag",this._onMouseEvent),P._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(P){return this.setDOMContent(r.window.document.createTextNode(P))}setHTML(P){const m=r.window.document.createDocumentFragment(),S=r.window.document.createElement("body");let F;for(S.innerHTML=P;F=S.firstChild,F;)m.appendChild(F);return this.setDOMContent(m)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(P){return this.options.maxWidth=P,this._update(),this}setDOMContent(P){let m=this._content;if(m)for(;m.hasChildNodes();)m.firstChild&&m.removeChild(m.firstChild);else m=this._content=d("div","mapboxgl-popup-content",this._container||void 0);if(m.appendChild(P),this.options.closeButton){const S=this._closeButton=d("button","mapboxgl-popup-close-button",m);S.type="button",S.setAttribute("aria-label","Close popup"),S.setAttribute("aria-hidden","true"),S.innerHTML="&#215;",S.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(P){return this._classList.add(P),this._updateClassList(),this}removeClassName(P){return this._classList.delete(P),this._updateClassList(),this}setOffset(P){return this.options.offset=P,this._update(),this}toggleClassName(P){let m;return this._classList.delete(P)?m=!1:(this._classList.add(P),m=!0),this._updateClassList(),m}_onMouseEvent(P){this._update(P.point)}_getAnchor(P){if(this.options.anchor)return this.options.anchor;const m=this._map,S=this._container,F=this._pos;if(!m||!S||!F)return"bottom";const X=S.offsetWidth,$=S.offsetHeight,ot=F.x<X/2,ct=F.x>m.transform.width-X/2;if(F.y+P<$)return ot?"top-left":ct?"top-right":"top";if(F.y>m.transform.height-$){if(ot)return"bottom-left";if(ct)return"bottom-right"}return ot?"left":ct?"right":"bottom"}_updateClassList(){const P=this._container;if(!P)return;const m=[...this._classList];m.push("mapboxgl-popup"),this._anchor&&m.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&m.push("mapboxgl-popup-track-pointer"),P.className=m.join(" ")}_update(P){const m=this._map,S=this._content;if(!m||!this._lngLat&&!this._trackPointer||!S)return;let F=this._container;if(F||(F=this._container=d("div","mapboxgl-popup",m.getContainer()),this._tip=d("div","mapboxgl-popup-tip",F),F.appendChild(S)),this.options.maxWidth&&F.style.maxWidth!==this.options.maxWidth&&(F.style.maxWidth=this.options.maxWidth),m.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Dh(this._lngLat,this._pos,m.transform)),!this._trackPointer||P){const X=this._pos=this._trackPointer&&P?P:m.project(this._lngLat),$=Fc(this.options.offset),ot=this._anchor=this._getAnchor($.y),ct=Fc(this.options.offset,ot),yt=X.add(ct).round();m._requestDomTask(()=>{this._container&&ot&&(this._container.style.transform=`${Rh[ot]} translate(${yt.x}px,${yt.y}px)`)})}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const P=this._container.querySelector(Dr);P&&P.focus()}_onClose(){this.remove()}_setOpacity(P){this._content&&(this._content.style.opacity=P),this._tip&&(this._tip.style.opacity=P)}},Marker:kh,Style:qi,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.pointGeometry,MercatorCoordinate:r.MercatorCoordinate,FreeCameraOptions:Sc,Evented:r.Evented,config:r.config,prewarm:function(){ee().acquire($e)},clearPrewarmedResources:function(){const P=Lt;P&&(P.isPreloaded()&&P.numActive()===1?(P.release($e),Lt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(P){r.config.ACCESS_TOKEN=P},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(P){r.config.API_URL=P},get workerCount(){return Tt.workerCount},set workerCount(P){Tt.workerCount=P},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(P){r.config.MAX_PARALLEL_IMAGE_REQUESTS=P},clearStorage(P){r.clearTileCache(P)},workerUrl:"",workerClass:null,setNow:r.exported.setNow,restoreNow:r.exported.restoreNow};return bl});var o=s;return o})})(IM);var OF=IM.exports;const zF=Ww(OF),nh={tdtsl(){return{layers:[["tdtsl","TianDiTu.Normal.Map"],["tdtslzj","TianDiTu.Normal.Annotion"]],key:"fb258b4c0bbf60ff7a0205b519ad9a96"}},tdtyx(){return{layers:[["tdtyx","TianDiTu.Satellite.Map"],["tdtyxzj","TianDiTu.Satellite.Annotion"]],key:"fb258b4c0bbf60ff7a0205b519ad9a96"}},tdtdx(){return{layers:[["tdtdx","TianDiTu.Terrain.Map"],["tdtdxzj","TianDiTu.Terrain.Annotion"]],key:"fb258b4c0bbf60ff7a0205b519ad9a96"}},gdsl(){return{layers:[["gdsl","GaoDe.Normal.Map"]]}},gdslwzj(){return{layers:[["gdslwzj","GaoDe.Normal_NoTag.Map"]]}},gdyx(){return{layers:[["gdyx","GaoDe.Satellite.Map"],["gdyxzj","GaoDe.Satellite.Annotion"]]}},bdsl(){return{layers:[["bdsl","Baidu.Normal.Map"]]}},bdyx(){return{layers:[["bdyx","Baidu.Satellite.Map"],["bdyxzj","Baidu.Satellite.Annotion"]]}},osm(){return{layers:[["osm","OSM.Normal.Map"]]}},geoq(){return{layers:[["geoq","Geoq.Normal.Map"]]}},geoqPurplishBlue(){return{layers:[["geoqPurplishBlue","Geoq.Normal.PurplishBlue"]]}},geoqGray(){return{layers:[["geoqGray","Geoq.Normal.Gray"]]}},geoqWarm(){return{layers:[["geoqWarm","Geoq.Normal.Warm"]]}},geoqCold(){return{layers:[["geoqCold","Geoq.Normal.Cold"]]}}};function UF(t){const n="./gis/radar.tiff";console.log(n);let e=(114.06825863001939-104.18084906665138)*.005,i=(32.396413467808586-22.54283198132819)*.005,s=114.07867152431874,a=22.563727343812303;t.addSource("radar",{type:"image",url:n,coordinates:[[s-e*.5,a+i*.5],[s+e*.5,a+i*.5],[s+e*.5,a-i*.5],[s-e*.5,a-i*.5]]}),t.addLayer({id:"radar-layer",type:"raster",source:"radar",paint:{"raster-fade-duration":0}})}function VF(t){var n="http://192.168.5.19:8080/geoserver/gwc/service/wmts?layer=mytest%3Amxcadtest2&style=&tilematrixset=EPSG:900913&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image/png&TileMatrix=EPSG:900913:{z}&TileCol={x}&TileRow={y}";t.addSource("wmts-source",{type:"raster",tiles:[n],tileSize:256}),t.addLayer({id:"wmts-layer",type:"raster",source:"wmts-source",paint:{"raster-opacity":.95}})}function jF(){return{TianDiTu:{Normal:{Map:"http://t{s}.tianditu.com/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"http://t{s}.tianditu.com/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk={key}",minzoom:0,maxzoom:18},Satellite:{Map:"http://t{s}.tianditu.com/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"http://t{s}.tianditu.com/DataServer?T=cia_w&X={x}&Y={y}&L={z}&tk={key}",minzoom:0,maxzoom:18},Terrain:{Map:"http://t{s}.tianditu.com/DataServer?T=ter_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"http://t{s}.tianditu.com/DataServer?T=cta_w&X={x}&Y={y}&L={z}&tk={key}",minzoom:0,maxzoom:14},Subdomains:["0","1","2","3","4","5","6","7"],key:""},GaoDe:{Normal:{Map:"http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",minzoom:0,maxzoom:18},Normal_NoTag:{Map:"https://wprd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&scl=1&ltype=11&x={x}&y={y}&z={z}",minzoom:3,maxzoom:18},Satellite:{Map:"http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",Annotion:"http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",minzoom:3,maxzoom:18},Subdomains:["1","2","3","4"]},Baidu:{Normal:{Map:"http://online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles=pl&scaler=1&p=1"},Satellite:{Map:"http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",Annotion:"http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=020"},Subdomains:"0123456789",tileType:"bd09"},Geoq:{Normal:{Map:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",PurplishBlue:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",Gray:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",Warm:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",minzoom:3,maxzoom:16},Subdomains:[]},OSM:{Normal:{Map:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",minzoom:0,maxzoom:18},Subdomains:["a","b","c"]}}}function GF(){return["https://0pn.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}","https://0pn.cn/maps/vt?lyrs=s,m&gl=CN&x={x}&y={y}&z={z}"]}let Mf,gs;function HF(t){Mf.on("click",function(n){return re(this,null,function*(){let{lng:e,lat:i}=n.lngLat;if(t){let o=A.mx_gcj02_To_gps84(e,i);e=o.lng,i=o.lat}console.log("经纬度坐标:",JSON.stringify([e,i]));let s=zF.MercatorCoordinate.fromLngLat([e,i],0);console.log("墨卡托坐标:",JSON.stringify(gs.map_lnglat_to_meters(e,i)));let a=gs.mercatorCoord2CAD(s.x,s.y);console.log("CAD坐标:",JSON.stringify(a))})})}let Af=!1,Hg=!0;Hg=!1,Hg&&(Af=!1);function WF(){let t=new A.MxCADPluginMapDefaultData;t.cadOrigin=[116275.977014,19273.279085],t.mapOrigin=[114.06825863001939,22.54283198132819],t.meterInCADUnits=1,t.openFile="./demo/road.dwg.mxweb";let n=Ct.MxFun.getQueryString("maptype");if(!Hg)if(n=="google"){let e=A.mx_gps84_To_gcj02(t.mapOrigin[0],t.mapOrigin[1]);t.mapOrigin=[e.lng,e.lat],Af=!0,t.viewColor={red:0,green:0,blue:0}}else{let e=nh.gdslwzj();n=="gdslwzj"?e=nh.gdslwzj():n=="gdyx"?e=nh.gdyx():n=="tdtsl"?e=nh.tdtsl():n=="bdsl"?e=nh.bdsl():n=="geoq"&&(e=nh.geoq()),t.rasterTileLayerList=e.layers,e.key&&(t.rasterTileKey=e.key),t.providers=jF()}return t}function qF(t){gs=t,Mf=t.getMapbox(),Af&&A.MxMapAddGoogleCnLayer(Mf,["Image","Lable"],GF()),HF(Af),Hg?VF(Mf):UF(Mf)}function XF(){return re(this,null,function*(){let t=new A.MxCADUiPrPoint;t.setMessage(`
指定下载范围第一点:`);let n=yield t.go();if(!n)return;t.setMessage(`
指定下载范围第二点:`),t.setUserDraw((l,h)=>{h.setColor(16711680);let f=new A.McDbPolyline;f.addVertexAt(n),f.addVertexAt(new A.McGePoint3d(n.x,l.y)),f.addVertexAt(l),f.addVertexAt(new A.McGePoint3d(l.x,n.y)),f.constantWidth=Ct.MxFun.screenCoordLong2Doc(2),f.isClosed=!0,h.drawMcDbEntity(f);let d=[];d.push(n.toVector3()),d.push(new THREE.Vector3(n.x,l.y)),d.push(l.toVector3()),d.push(new THREE.Vector3(l.x,n.y)),h.setColor(12868),h.drawSolid(d,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(Ct.DynamicInputType.kXYCoordInput);let e=yield t.go();if(!e)return;let i=gs.cadTolnglat(n.toVector3()),s=gs.cadTolnglat(e.toVector3()),a=gs.map_lnglat_to_meters(i[0],i[1]),o=gs.map_lnglat_to_meters(s[0],s[1]);if(Af&&!(gs.outOfChina(i[0],i[1])&&gs.outOfChina(s[0],s[1]))){let l=A.mx_gcj02_To_gps84(i[0],i[1]),h=A.mx_gcj02_To_gps84(s[0],s[1]);a=gs.map_lnglat_to_meters(l.lng,l.lat),o=gs.map_lnglat_to_meters(h.lng,h.lat)}let r={url:"https://0pn.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}",polygon:[a[0],a[1],o[0],o[1]],zoom:18,auto_close:!1,no_repeated_download:!0,download_dir:"",thread_count:32};Ct.MxFun.acutPrintf(`
 使用教程:https://help.mxdraw.com/?pid=111`),Ct.MxFun.acutPrintf(`
 复制下面的范围,到下载器下载地图,下载范围:`);let u=`
`+JSON.stringify([a[0],a[1],o[0],o[1]]);Ct.MxFun.acutPrintf(u),Ct.MxFun.acutPrintf(`
`),os({method:"post",url:"http://localhost:1337/users/mxgis/download",data:r}).then(l=>{console.log(l.data),alert(JSON.stringify(l.data))}).catch(l=>{console.log("网络错误")})})}window._iconfont_svg_string_4337873='<svg><symbol id="icon-zidian" viewBox="0 0 1024 1024"><path d="M893.080181 585.210149h-86.234525v-37.615932h79.557697a57.552376 57.552376 0 0 0 1.786757-115.104753l-20.500683-0.658279 2.445035-20.312603a153.473004 153.473004 0 0 0 1.034439-17.679488A148.300813 148.300813 0 0 0 723.056167 245.72636a151.310088 151.310088 0 0 0-39.966928 5.64239l-20.782803 5.64239-3.009274-21.347042A225.695594 225.695594 0 0 0 209.222531 266.415123v18.807966l-16.739089 1.880797a130.715365 130.715365 0 0 0 14.952333 260.490331v37.615932a168.331297 168.331297 0 0 1-35.547056-332.806961 263.311526 263.311526 0 0 1 521.074702-41.753685 181.120714 181.120714 0 0 1 29.998706-2.539075 185.916746 185.916746 0 0 1 185.822706 185.728666v3.573513a95.168309 95.168309 0 0 1-15.704652 187.515423z" fill="#282D33" ></path><path d="M399.371069 341.646988H329.875634a74.573586 74.573586 0 0 0-74.291466 73.257028v478.944858-18.807966 14.576174a74.573586 74.573586 0 0 1 74.573586-74.479546h431.454744V341.646988H399.371069z" fill="#FFFFFF" ></path><path d="M255.584168 908.519088h-18.807966V414.715936A94.039831 94.039831 0 0 1 329.875634 322.839021h69.495435v37.615933H329.875634a56.423898 56.423898 0 0 0-55.4835 54.825221v399.481201a93.381552 93.381552 0 0 1 55.76562-18.807966h412.646778V360.454954H506.012238v-37.615933h274.408226v511.106481H329.875634a55.85966 55.85966 0 0 0-55.4835 52.568265v7.523187h-0.940398a18.807966 18.807966 0 0 1-17.867568 14.482134z" fill="#282D33" ></path><path d="M369.654483 392.804655H710.736949v371.363292H369.654483z" fill="#F8C44F" ></path><path d="M761.612498 815.137536H329.875634a74.573586 74.573586 0 1 0 0 149.053132h431.736864z" fill="#FFFFFF" ></path><path d="M780.420464 982.998634H329.875634a93.381552 93.381552 0 1 1 0-186.669064h450.54483zM329.875634 833.945502a55.76562 55.76562 0 1 0 0 111.437199h412.928898V833.945502z" fill="#282D33" ></path><path d="M475.073133 1024l-54.072903-34.230498-54.072902 34.230498v-127.89417h108.145805v127.89417z" fill="#34CA9D" ></path><path d="M324.327284 893.942914z" fill="#FFFFFF" ></path><path d="M324.327284 875.134948h437.285214v37.615932h-437.285214z" fill="#282D33" ></path><path d="M324.327284 810.529584z" fill="#FFFFFF" ></path><path d="M305.519318 349.076134h37.615933v461.45345h-37.615933zM520.494371 257.857498L453.067813 190.524979l-67.332519 67.332519-26.613272-26.613272L453.067813 137.392475l94.039831 93.851751-26.613273 26.613272z" fill="#282D33" ></path><path d="M436.422763 189.302462h37.615932v248.829392h-37.615932zM559.803021 694.390393l-94.039831-93.851751 26.613272-26.613272 67.426559 67.332519 67.426558-67.332519 26.519233 26.613272-93.945791 93.851751z" fill="#282D33" ></path><path d="M538.832138 393.556974h37.615933v248.829393h-37.615933z" fill="#282D33" ></path></symbol></svg>',function(t){var e=(e=document.getElementsByTagName("script"))[e.length-1],n=e.getAttribute("data-injectcss"),e=e.getAttribute("data-disable-injectsvg");if(!e){var i,s,a,o,r,u=function(f,d){d.parentNode.insertBefore(f,d)};if(n&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(f){console&&console.log(f)}}i=function(){var f,d=document.createElement("div");d.innerHTML=t._iconfont_svg_string_4337873,(d=d.getElementsByTagName("svg")[0])&&(d.setAttribute("aria-hidden","true"),d.style.position="absolute",d.style.width=0,d.style.height=0,d.style.overflow="hidden",d=d,(f=document.body).firstChild?u(d,f.firstChild):f.appendChild(d))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(i,0):(s=function(){document.removeEventListener("DOMContentLoaded",s,!1),i()},document.addEventListener("DOMContentLoaded",s,!1)):document.attachEvent&&(a=i,o=t.document,r=!1,h(),o.onreadystatechange=function(){o.readyState=="complete"&&(o.onreadystatechange=null,l())})}function l(){r||(r=!0,a())}function h(){try{o.documentElement.doScroll("left")}catch(f){return void setTimeout(h,50)}l()}}(window),window._iconfont_svg_string_4604696='<svg><symbol id="icon-guding1" viewBox="0 0 1024 1024"><path d="M251.15000029 471.5l214.425 150.1875 183.74999942 128.62500029a243.7875 243.7875 0 0 0 7.01250029-235.42500058l-10.31249971-20.1375 160.61249971-229.3875-153.60000029-107.55-160.61249971 229.3875-22.42500029-2.77499971a243.7875 243.7875 0 0 0-218.84999942 87.11250029z m192.9375 180.9l-204.37500058 291.825a18.74999971 18.74999971 0 1 1-30.67499971-21.4875L413.37500029 630.87499971l-261.1125-182.84999942a18.74999971 18.74999971 0 1 1 21.4875-30.7125l46.61249942 32.625a281.28750029 281.28750029 0 0 1 254.32500058-102.75000029l147.63749942-210.89999971-46.04999942-32.25000058a18.74999971 18.74999971 0 0 1 21.4875-30.74999942l307.19999971 215.1a18.74999971 18.74999971 0 1 1-21.52500029 30.74999942l-46.08749971-32.2875-147.63750029 210.86250029a281.28750029 281.28750029 0 0 1-9.59999942 274.12499971l46.575 32.625a18.74999971 18.74999971 0 1 1-21.4875 30.75000029l-261.1125-182.85000029z" fill="#89cbfa" ></path></symbol><symbol id="icon-guding" viewBox="0 0 1024 1024"><path d="M381.298 418.828h-157.703l-37.575 38.272 155.61 158.377-278.212 345.128 356.040-265.838 154.71 157.41 38.813-39.51 2.407-157.972 238.838-313.29 71.685 73.013 34.695-35.28-310.185-315.743-34.672 35.257 77.287 79.402-311.737 240.773z"  ></path></symbol><symbol id="icon-dengpao1" viewBox="0 0 1024 1024"><path d="M344.73 841.5c0 8.28 6.77 15.31 15.31 15.31h32.75v1.26c0 40.65 51.69 73.52 115.43 73.52s115.18-32.87 115.18-73.52v-1.26h28.48c8.53 0 15.31-7.03 15.31-15.31v-59.95H344.96c-0.23 33.17-0.23 59.95-0.23 59.95zM512.1 98.23c-187.2 0-338.76 140.02-338.76 312.67 0 89.83 40.9 170.89 106.65 227.85 14.1 12.12 26.16 26.24 35.98 41.69h137.08l-31.49-352.21 4.6-0.02v-0.1h149.83v0.11l2.61 0.01-31.49 352.21h149.23c6.92-8.25 14.58-15.91 23.54-22.37 79.8-57.21 130.99-146.55 130.99-247.17C850.86 238.25 699.3 98.23 512.1 98.23zM343.93 759.53h323.25v-1.34c0-17.26 3.88-33.93 10.87-49.21H330.27c6.72 16.12 11.77 32.96 13.66 50.55z" fill="#F7B52C" ></path><path d="M546.38 357.44h-92.6l28.87 323h34.85z" fill="#F7B52C" ></path></symbol><symbol id="icon-duigou" viewBox="0 0 1024 1024"><path d="M387.072 611.328L236.6464 460.8 128 569.3952l259.072 259.1232 515.1232-515.072L793.6 204.8z" fill="#07A35A" ></path></symbol><symbol id="icon-jiantou_xiangyou" viewBox="0 0 1024 1024"><path d="M729.6 448H128v85.333333h601.6L597.333333 665.6l59.733334 59.733333 234.666666-234.666666L661.333333 256l-59.733333 59.733333 128 132.266667z" fill="#444444" ></path></symbol><symbol id="icon-jiantou_xiangzuo" viewBox="0 0 1024 1024"><path d="M290.133333 448H896v85.333333H290.133333l132.266667 132.266667L362.666667 725.333333 128 490.666667 362.666667 256l59.733333 59.733333-132.266667 132.266667z" fill="#444444" ></path></symbol><symbol id="icon-shezhi" viewBox="0 0 1024 1024"><path d="M519.9 647.4c-44.8 7.4-90.4-6.9-122.5-38.3-32.1-31.4-46.6-76.2-39-120 9.4-56.8 56.2-102.7 114.2-112.1 44.9-7.6 90.7 6.7 122.9 38.2 32.2 31.6 46.7 76.5 38.9 120.4-9.7 56.9-56.5 102.6-114.5 111.8M848.4 559l66-40.4c10.5-6.4 15.6-18.6 12.9-30.4L895 349.3c-2.7-11.8-12.8-20.6-25.1-21.9l-77.5-8.4c-7.7-0.8-14.7-4.6-19.5-10.5l-13-16c-4.8-5.9-7-13.5-6.1-21l8.9-75.7c1.4-12-5.1-23.6-16.2-28.9l-131-61.8c-11.1-5.2-24.4-3-33.2 5.5l-55 54c-5.4 5.3-12.8 8.4-20.6 8.4H486c-7.7 0-15.1-3-20.6-8.4l-55-54c-8.7-8.6-22-10.8-33.2-5.5l-130.9 61.8c-11.1 5.3-17.6 16.8-16.2 28.9l8.9 75.8c0.9 7.5-1.3 15-6.1 21L220 308.4c-4.8 5.9-11.8 9.7-19.5 10.5l-77.5 8.5c-12.3 1.3-22.3 10.1-25.1 21.9L65.5 488.1c-2.7 11.8 2.4 24 12.9 30.4l66 40.5c6.5 4 11.2 10.4 12.9 17.8l4.6 19.9c1.7 7.4 0.4 15.1-3.7 21.5l-41.6 64.5c-6.6 10.2-5.8 23.4 1.9 32.9l90.7 111.3c7.7 9.5 20.7 13.1 32.3 9.1l73.5-25.3c7.3-2.5 15.3-2.1 22.2 1.2l18.7 8.8c7 3.3 12.3 9.1 14.8 16.3l25.6 72c4.1 11.4 15.1 19.1 27.4 19.1H569c12.4 0 23.4-7.7 27.4-19.1l25.6-72c2.5-7.1 7.9-13 14.8-16.3l18.7-8.8c6.9-3.3 14.9-3.7 22.2-1.2l73.5 25.3c11.7 4 24.6 0.4 32.3-9.1l90.7-111.3c7.7-9.5 8.4-22.7 1.9-32.9l-41.6-64.5c-4.1-6.4-5.5-14.1-3.8-21.5l4.6-19.8c1.9-7.5 6.5-13.9 13.1-17.9" fill="" ></path></symbol><symbol id="icon-dengpao" viewBox="0 0 1024 1024"><path d="M661.333333 916.394667a21.333333 21.333333 0 0 1 21.333334 21.333333v42.666667a21.333333 21.333333 0 0 1-21.333334 21.333333h-298.666666a21.333333 21.333333 0 0 1-21.333334-21.333333v-42.666667a21.333333 21.333333 0 0 1 21.333334-21.333333h298.666666z m-149.333333-896a384 384 0 0 1 170.709333 728.064L682.666667 831.061333a42.666667 42.666667 0 0 1-42.666667 42.666667H384a42.666667 42.666667 0 0 1-42.666667-42.666667v-82.602666A384 384 0 0 1 512 20.394667z m0 85.333333a298.666667 298.666667 0 0 0-85.333333 584.96v97.706667h170.666666l0.042667-97.706667A298.666667 298.666667 0 0 0 512 105.728z" fill="#000000" opacity=".65" ></path></symbol></svg>',function(t){var e=(e=document.getElementsByTagName("script"))[e.length-1],n=e.getAttribute("data-injectcss"),e=e.getAttribute("data-disable-injectsvg");if(!e){var i,s,a,o,r,u=function(f,d){d.parentNode.insertBefore(f,d)};if(n&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(f){console&&console.log(f)}}i=function(){var f,d=document.createElement("div");d.innerHTML=t._iconfont_svg_string_4604696,(d=d.getElementsByTagName("svg")[0])&&(d.setAttribute("aria-hidden","true"),d.style.position="absolute",d.style.width=0,d.style.height=0,d.style.overflow="hidden",d=d,(f=document.body).firstChild?u(d,f.firstChild):f.appendChild(d))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(i,0):(s=function(){document.removeEventListener("DOMContentLoaded",s,!1),i()},document.addEventListener("DOMContentLoaded",s,!1)):document.attachEvent&&(a=i,o=t.document,r=!1,h(),o.onreadystatechange=function(){o.readyState=="complete"&&(o.onreadystatechange=null,l())})}function l(){r||(r=!0,a())}function h(){try{o.documentElement.doScroll("left")}catch(f){return void setTimeout(h,50)}l()}}(window),window._iconfont_svg_string_4666894='<svg><symbol id="icon-a-1" viewBox="0 0 1024 1024"><path d="M429.12 896L256 628.16l23.04-20.16 173.12 267.84z" fill="#ffffff" ></path><path d="M456 893.76l-28.16-12.8L803.84 192l28.16 12.8z" fill="#ffffff" ></path><path d="M256 608h336v32H256z" fill="#ffffff" ></path></symbol><symbol id="icon-a-2" viewBox="0 0 1024 1024"><path d="M429.12 896L256 628.16l23.04-20.16 173.12 267.84z" fill="#000000" ></path><path d="M456 893.76l-28.16-12.8L803.84 192l28.16 12.8z" fill="#000000" ></path><path d="M256 608h336v32H256z" fill="#000000" ></path></symbol></svg>',(t=>{var n=(e=(e=document.getElementsByTagName("script"))[e.length-1]).getAttribute("data-injectcss"),e=e.getAttribute("data-disable-injectsvg");if(!e){var i,s,a,o,r,u=function(f,d){d.parentNode.insertBefore(f,d)};if(n&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(f){console&&console.log(f)}}i=function(){var f,d=document.createElement("div");d.innerHTML=t._iconfont_svg_string_4666894,(d=d.getElementsByTagName("svg")[0])&&(d.setAttribute("aria-hidden","true"),d.style.position="absolute",d.style.width=0,d.style.height=0,d.style.overflow="hidden",d=d,(f=document.body).firstChild?u(d,f.firstChild):f.appendChild(d))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(i,0):(s=function(){document.removeEventListener("DOMContentLoaded",s,!1),i()},document.addEventListener("DOMContentLoaded",s,!1)):document.attachEvent&&(a=i,o=t.document,r=!1,h(),o.onreadystatechange=function(){o.readyState=="complete"&&(o.onreadystatechange=null,l())})}function l(){r||(r=!0,a())}function h(){try{o.documentElement.doScroll("left")}catch(f){return void setTimeout(h,50)}l()}})(window);var YF=function(){function t(nt){Tr.call(this,nt),this.dracoLoader=null,this.ddsLoader=null}t.prototype=Object.assign(Object.create(Tr.prototype),{constructor:t,load:function(nt,lt,ut,vt){var Q=this,gt;this.resourcePath!==""?gt=this.resourcePath:this.path!==""?gt=this.path:gt=ec.extractUrlBase(nt),Q.manager.itemStart(nt);var Y=function(at){vt?vt(at):console.error(at),Q.manager.itemError(nt),Q.manager.itemEnd(nt)},H=new Jo(Q.manager);H.setPath(this.path),H.setResponseType("arraybuffer"),Q.crossOrigin==="use-credentials"&&H.setWithCredentials(!0),H.load(nt,function(at){try{Q.parse(at,gt,function(ft){lt(ft),Q.manager.itemEnd(nt)},Y)}catch(ft){Y(ft)}},ut,Y)},setDRACOLoader:function(nt){return this.dracoLoader=nt,this},setDDSLoader:function(nt){return this.ddsLoader=nt,this},parse:function(nt,lt,ut,vt){var Q,gt={};if(typeof nt=="string")Q=nt;else{var Y=ec.decodeText(new Uint8Array(nt,0,4));if(Y===o){try{gt[e.KHR_BINARY_GLTF]=new l(nt)}catch(Dt){vt&&vt(Dt);return}Q=gt[e.KHR_BINARY_GLTF].content}else Q=ec.decodeText(new Uint8Array(nt))}var H=JSON.parse(Q);if(H.asset===void 0||H.asset.version[0]<2){vt&&vt(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}if(H.extensionsUsed)for(var at=0;at<H.extensionsUsed.length;++at){var ft=H.extensionsUsed[at],wt=H.extensionsRequired||[];switch(ft){case e.KHR_LIGHTS_PUNCTUAL:gt[ft]=new s(H);break;case e.KHR_MATERIALS_UNLIT:gt[ft]=new a;break;case e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:gt[ft]=new p;break;case e.KHR_DRACO_MESH_COMPRESSION:gt[ft]=new h(H,this.dracoLoader);break;case e.MSFT_TEXTURE_DDS:gt[ft]=new i(this.ddsLoader);break;case e.KHR_TEXTURE_TRANSFORM:gt[ft]=new f;break;case e.KHR_MESH_QUANTIZATION:gt[ft]=new b;break;default:wt.indexOf(ft)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ft+'".')}}var _t=new B(H,gt,{path:lt||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});_t.parse(ut,vt)}});function n(){var nt={};return{get:function(lt){return nt[lt]},add:function(lt,ut){nt[lt]=ut},remove:function(lt){delete nt[lt]},removeAll:function(){nt={}}}}var e={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function i(nt){if(!nt)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=e.MSFT_TEXTURE_DDS,this.ddsLoader=nt}function s(nt){this.name=e.KHR_LIGHTS_PUNCTUAL;var lt=nt.extensions&&nt.extensions[e.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=lt.lights||[]}s.prototype.loadLight=function(nt){var lt=this.lightDefs[nt],ut,vt=new Dn(16777215);lt.color!==void 0&&vt.fromArray(lt.color);var Q=lt.range!==void 0?lt.range:0;switch(lt.type){case"directional":ut=new sg(vt),ut.target.position.set(0,0,-1),ut.add(ut.target);break;case"point":ut=new og(vt),ut.distance=Q;break;case"spot":ut=new ig(vt),ut.distance=Q,lt.spot=lt.spot||{},lt.spot.innerConeAngle=lt.spot.innerConeAngle!==void 0?lt.spot.innerConeAngle:0,lt.spot.outerConeAngle=lt.spot.outerConeAngle!==void 0?lt.spot.outerConeAngle:Math.PI/4,ut.angle=lt.spot.outerConeAngle,ut.penumbra=1-lt.spot.innerConeAngle/lt.spot.outerConeAngle,ut.target.position.set(0,0,-1),ut.add(ut.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+lt.type+'".')}return ut.position.set(0,0,0),ut.decay=2,lt.intensity!==void 0&&(ut.intensity=lt.intensity),ut.name=lt.name||"light_"+nt,Promise.resolve(ut)};function a(){this.name=e.KHR_MATERIALS_UNLIT}a.prototype.getMaterialType=function(){return Fi},a.prototype.extendParams=function(nt,lt,ut){var vt=[];nt.color=new Dn(1,1,1),nt.opacity=1;var Q=lt.pbrMetallicRoughness;if(Q){if(Array.isArray(Q.baseColorFactor)){var gt=Q.baseColorFactor;nt.color.fromArray(gt),nt.opacity=gt[3]}Q.baseColorTexture!==void 0&&vt.push(ut.assignTexture(nt,"map",Q.baseColorTexture))}return Promise.all(vt)};var o="glTF",r=12,u={JSON:1313821514,BIN:5130562};function l(nt){this.name=e.KHR_BINARY_GLTF,this.content=null,this.body=null;var lt=new DataView(nt,0,r);if(this.header={magic:ec.decodeText(new Uint8Array(nt.slice(0,4))),version:lt.getUint32(4,!0),length:lt.getUint32(8,!0)},this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var ut=new DataView(nt,r),vt=0;vt<ut.byteLength;){var Q=ut.getUint32(vt,!0);vt+=4;var gt=ut.getUint32(vt,!0);if(vt+=4,gt===u.JSON){var Y=new Uint8Array(nt,r+vt,Q);this.content=ec.decodeText(Y)}else if(gt===u.BIN){var H=r+vt;this.body=nt.slice(H,H+Q)}vt+=Q}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function h(nt,lt){if(!lt)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=e.KHR_DRACO_MESH_COMPRESSION,this.json=nt,this.dracoLoader=lt,this.dracoLoader.preload()}h.prototype.decodePrimitive=function(nt,lt){var ut=this.json,vt=this.dracoLoader,Q=nt.extensions[this.name].bufferView,gt=nt.extensions[this.name].attributes,Y={},H={},at={};for(var ft in gt){var wt=N[ft]||ft.toLowerCase();Y[wt]=gt[ft]}for(ft in nt.attributes){var wt=N[ft]||ft.toLowerCase();if(gt[ft]!==void 0){var _t=ut.accessors[nt.attributes[ft]],Dt=w[_t.componentType];at[wt]=Dt,H[wt]=_t.normalized===!0}}return lt.getDependency("bufferView",Q).then(function(Gt){return new Promise(function(te){vt.decodeDracoFile(Gt,function(mt){for(var At in mt.attributes){var Ot=mt.attributes[At],Zt=H[At];Zt!==void 0&&(Ot.normalized=Zt)}te(mt)},Y,at)})})};function f(){this.name=e.KHR_TEXTURE_TRANSFORM}f.prototype.extendTexture=function(nt,lt){return nt=nt.clone(),lt.offset!==void 0&&nt.offset.fromArray(lt.offset),lt.rotation!==void 0&&(nt.rotation=lt.rotation),lt.scale!==void 0&&nt.repeat.fromArray(lt.scale),lt.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),nt.needsUpdate=!0,nt};function d(nt){yo.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var lt=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),ut=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),vt=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),Q=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),gt=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join(`
`),Y={specular:{value:new Dn().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Y,this.onBeforeCompile=function(H){for(var at in Y)H.uniforms[at]=Y[at];H.fragmentShader=H.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),H.fragmentShader=H.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),H.fragmentShader=H.fragmentShader.replace("#include <roughnessmap_pars_fragment>",lt),H.fragmentShader=H.fragmentShader.replace("#include <metalnessmap_pars_fragment>",ut),H.fragmentShader=H.fragmentShader.replace("#include <roughnessmap_fragment>",vt),H.fragmentShader=H.fragmentShader.replace("#include <metalnessmap_fragment>",Q),H.fragmentShader=H.fragmentShader.replace("#include <lights_physical_fragment>",gt)},Object.defineProperties(this,{specular:{get:function(){return Y.specular.value},set:function(H){Y.specular.value=H}},specularMap:{get:function(){return Y.specularMap.value},set:function(H){Y.specularMap.value=H}},glossiness:{get:function(){return Y.glossiness.value},set:function(H){Y.glossiness.value=H}},glossinessMap:{get:function(){return Y.glossinessMap.value},set:function(H){Y.glossinessMap.value=H,H?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(nt)}d.prototype=Object.create(yo.prototype),d.prototype.constructor=d,d.prototype.copy=function(nt){return yo.prototype.copy.call(this,nt),this.specularMap=nt.specularMap,this.specular.copy(nt.specular),this.glossinessMap=nt.glossinessMap,this.glossiness=nt.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function p(){return{name:e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return d},extendParams:function(nt,lt,ut){var vt=lt.extensions[this.name];nt.color=new Dn(1,1,1),nt.opacity=1;var Q=[];if(Array.isArray(vt.diffuseFactor)){var gt=vt.diffuseFactor;nt.color.fromArray(gt),nt.opacity=gt[3]}if(vt.diffuseTexture!==void 0&&Q.push(ut.assignTexture(nt,"map",vt.diffuseTexture)),nt.emissive=new Dn(0,0,0),nt.glossiness=vt.glossinessFactor!==void 0?vt.glossinessFactor:1,nt.specular=new Dn(1,1,1),Array.isArray(vt.specularFactor)&&nt.specular.fromArray(vt.specularFactor),vt.specularGlossinessTexture!==void 0){var Y=vt.specularGlossinessTexture;Q.push(ut.assignTexture(nt,"glossinessMap",Y)),Q.push(ut.assignTexture(nt,"specularMap",Y))}return Promise.all(Q)},createMaterial:function(nt){var lt=new d(nt);return lt.fog=!0,lt.color=nt.color,lt.map=nt.map===void 0?null:nt.map,lt.lightMap=null,lt.lightMapIntensity=1,lt.aoMap=nt.aoMap===void 0?null:nt.aoMap,lt.aoMapIntensity=1,lt.emissive=nt.emissive,lt.emissiveIntensity=1,lt.emissiveMap=nt.emissiveMap===void 0?null:nt.emissiveMap,lt.bumpMap=nt.bumpMap===void 0?null:nt.bumpMap,lt.bumpScale=1,lt.normalMap=nt.normalMap===void 0?null:nt.normalMap,lt.normalMapType=zl,nt.normalScale&&(lt.normalScale=nt.normalScale),lt.displacementMap=null,lt.displacementScale=1,lt.displacementBias=0,lt.specularMap=nt.specularMap===void 0?null:nt.specularMap,lt.specular=nt.specular,lt.glossinessMap=nt.glossinessMap===void 0?null:nt.glossinessMap,lt.glossiness=nt.glossiness,lt.alphaMap=null,lt.envMap=nt.envMap===void 0?null:nt.envMap,lt.envMapIntensity=1,lt.refractionRatio=.98,lt}}}function b(){this.name=e.KHR_MESH_QUANTIZATION}function v(nt,lt,ut,vt){bo.call(this,nt,lt,ut,vt)}v.prototype=Object.create(bo.prototype),v.prototype.constructor=v,v.prototype.copySampleValue_=function(nt){for(var lt=this.resultBuffer,ut=this.sampleValues,vt=this.valueSize,Q=nt*vt*3+vt,gt=0;gt!==vt;gt++)lt[gt]=ut[Q+gt];return lt},v.prototype.beforeStart_=v.prototype.copySampleValue_,v.prototype.afterEnd_=v.prototype.copySampleValue_,v.prototype.interpolate_=function(nt,lt,ut,vt){for(var Q=this.resultBuffer,gt=this.sampleValues,Y=this.valueSize,H=Y*2,at=Y*3,ft=vt-lt,wt=(ut-lt)/ft,_t=wt*wt,Dt=_t*wt,Gt=nt*at,te=Gt-at,mt=-2*Dt+3*_t,At=Dt-_t,Ot=1-mt,Zt=At-_t+wt,he=0;he!==Y;he++){var fe=gt[te+he+Y],be=gt[te+he+H]*ft,Me=gt[Gt+he+Y],Pe=gt[Gt+he]*ft;Q[he]=Ot*fe+Zt*be+mt*Me+At*Pe}return Q};var x={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},w={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M={9728:li,9729:pi,9984:Jp,9985:Y1,9986:$p,9987:Qc},E={33071:Qi,33648:ad,10497:Ol},D={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},V={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},K={CUBICSPLINE:void 0,LINEAR:eu,STEP:ud},j={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},Z={"image/png":as,"image/jpeg":oa};function tt(nt,lt){return typeof nt!="string"||nt===""?"":(/^https?:\/\//i.test(lt)&&/^\//.test(nt)&&(lt=lt.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(nt)||/^data:.*,.*$/i.test(nt)||/^blob:.*$/i.test(nt)?nt:lt+nt)}function rt(nt){return nt.DefaultMaterial===void 0&&(nt.DefaultMaterial=new yo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Zc})),nt.DefaultMaterial}function J(nt,lt,ut){for(var vt in ut.extensions)nt[vt]===void 0&&(lt.userData.gltfExtensions=lt.userData.gltfExtensions||{},lt.userData.gltfExtensions[vt]=ut.extensions[vt])}function U(nt,lt){lt.extras!==void 0&&(typeof lt.extras=="object"?Object.assign(nt.userData,lt.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+lt.extras))}function G(nt,lt,ut){for(var vt=!1,Q=!1,gt=0,Y=lt.length;gt<Y;gt++){var H=lt[gt];if(H.POSITION!==void 0&&(vt=!0),H.NORMAL!==void 0&&(Q=!0),vt&&Q)break}if(!vt&&!Q)return Promise.resolve(nt);for(var at=[],ft=[],gt=0,Y=lt.length;gt<Y;gt++){var H=lt[gt];if(vt){var wt=H.POSITION!==void 0?ut.getDependency("accessor",H.POSITION):nt.attributes.position;at.push(wt)}if(Q){var wt=H.NORMAL!==void 0?ut.getDependency("accessor",H.NORMAL):nt.attributes.normal;ft.push(wt)}}return Promise.all([Promise.all(at),Promise.all(ft)]).then(function(_t){var Dt=_t[0],Gt=_t[1];return vt&&(nt.morphAttributes.position=Dt),Q&&(nt.morphAttributes.normal=Gt),nt.morphTargetsRelative=!0,nt})}function I(nt,lt){if(nt.updateMorphTargets(),lt.weights!==void 0)for(var ut=0,vt=lt.weights.length;ut<vt;ut++)nt.morphTargetInfluences[ut]=lt.weights[ut];if(lt.extras&&Array.isArray(lt.extras.targetNames)){var Q=lt.extras.targetNames;if(nt.morphTargetInfluences.length===Q.length){nt.morphTargetDictionary={};for(var ut=0,vt=Q.length;ut<vt;ut++)nt.morphTargetDictionary[Q[ut]]=ut}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function C(nt){var lt=nt.extensions&&nt.extensions[e.KHR_DRACO_MESH_COMPRESSION],ut;return lt?ut="draco:"+lt.bufferView+":"+lt.indices+":"+L(lt.attributes):ut=nt.indices+":"+L(nt.attributes)+":"+nt.mode,ut}function L(nt){for(var lt="",ut=Object.keys(nt).sort(),vt=0,Q=ut.length;vt<Q;vt++)lt+=ut[vt]+":"+nt[ut[vt]]+";";return lt}function B(nt,lt,ut){this.json=nt||{},this.extensions=lt||{},this.options=ut||{},this.cache=new n,this.primitiveCache={},this.textureLoader=new Zd(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Jo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}B.prototype.parse=function(nt,lt){var ut=this,vt=this.json,Q=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(gt){var Y={scene:gt[0][vt.scene||0],scenes:gt[0],animations:gt[1],cameras:gt[2],asset:vt.asset,parser:ut,userData:{}};J(Q,Y,vt),U(Y,vt),nt(Y)}).catch(lt)},B.prototype.markDefs=function(){for(var nt=this.json.nodes||[],lt=this.json.skins||[],ut=this.json.meshes||[],vt={},Q={},gt=0,Y=lt.length;gt<Y;gt++)for(var H=lt[gt].joints,at=0,ft=H.length;at<ft;at++)nt[H[at]].isBone=!0;for(var wt=0,_t=nt.length;wt<_t;wt++){var Dt=nt[wt];Dt.mesh!==void 0&&(vt[Dt.mesh]===void 0&&(vt[Dt.mesh]=Q[Dt.mesh]=0),vt[Dt.mesh]++,Dt.skin!==void 0&&(ut[Dt.mesh].isSkinnedMesh=!0))}this.json.meshReferences=vt,this.json.meshUses=Q},B.prototype.getDependency=function(nt,lt){var ut=nt+":"+lt,vt=this.cache.get(ut);if(!vt){switch(nt){case"scene":vt=this.loadScene(lt);break;case"node":vt=this.loadNode(lt);break;case"mesh":vt=this.loadMesh(lt);break;case"accessor":vt=this.loadAccessor(lt);break;case"bufferView":vt=this.loadBufferView(lt);break;case"buffer":vt=this.loadBuffer(lt);break;case"material":vt=this.loadMaterial(lt);break;case"texture":vt=this.loadTexture(lt);break;case"skin":vt=this.loadSkin(lt);break;case"animation":vt=this.loadAnimation(lt);break;case"camera":vt=this.loadCamera(lt);break;case"light":vt=this.extensions[e.KHR_LIGHTS_PUNCTUAL].loadLight(lt);break;default:throw new Error("Unknown type: "+nt)}this.cache.add(ut,vt)}return vt},B.prototype.getDependencies=function(nt){var lt=this.cache.get(nt);if(!lt){var ut=this,vt=this.json[nt+(nt==="mesh"?"es":"s")]||[];lt=Promise.all(vt.map(function(Q,gt){return ut.getDependency(nt,gt)})),this.cache.add(nt,lt)}return lt},B.prototype.loadBuffer=function(nt){var lt=this.json.buffers[nt],ut=this.fileLoader;if(lt.type&&lt.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+lt.type+" buffer type is not supported.");if(lt.uri===void 0&&nt===0)return Promise.resolve(this.extensions[e.KHR_BINARY_GLTF].body);var vt=this.options;return new Promise(function(Q,gt){ut.load(tt(lt.uri,vt.path),Q,void 0,function(){gt(new Error('THREE.GLTFLoader: Failed to load buffer "'+lt.uri+'".'))})})},B.prototype.loadBufferView=function(nt){var lt=this.json.bufferViews[nt];return this.getDependency("buffer",lt.buffer).then(function(ut){var vt=lt.byteLength||0,Q=lt.byteOffset||0;return ut.slice(Q,Q+vt)})},B.prototype.loadAccessor=function(nt){var lt=this,ut=this.json,vt=this.json.accessors[nt];if(vt.bufferView===void 0&&vt.sparse===void 0)return Promise.resolve(null);var Q=[];return vt.bufferView!==void 0?Q.push(this.getDependency("bufferView",vt.bufferView)):Q.push(null),vt.sparse!==void 0&&(Q.push(this.getDependency("bufferView",vt.sparse.indices.bufferView)),Q.push(this.getDependency("bufferView",vt.sparse.values.bufferView))),Promise.all(Q).then(function(gt){var Y=gt[0],H=D[vt.type],at=w[vt.componentType],ft=at.BYTES_PER_ELEMENT,wt=ft*H,_t=vt.byteOffset||0,Dt=vt.bufferView!==void 0?ut.bufferViews[vt.bufferView].byteStride:void 0,Gt=vt.normalized===!0,te,mt;if(Dt&&Dt!==wt){var At=Math.floor(_t/Dt),Ot="InterleavedBuffer:"+vt.bufferView+":"+vt.componentType+":"+At+":"+vt.count,Zt=lt.cache.get(Ot);Zt||(te=new at(Y,At*Dt,vt.count*Dt/ft),Zt=new ga(te,Dt/ft),lt.cache.add(Ot,Zt)),mt=new Td(Zt,H,_t%Dt/ft,Gt)}else Y===null?te=new at(vt.count*H):te=new at(Y,_t,vt.count*H),mt=new nr(te,H,Gt);if(vt.sparse!==void 0){var he=D.SCALAR,fe=w[vt.sparse.indices.componentType],be=vt.sparse.indices.byteOffset||0,Me=vt.sparse.values.byteOffset||0,Pe=new fe(gt[1],be,vt.sparse.count*he),ze=new at(gt[2],Me,vt.sparse.count*H);Y!==null&&(mt=new nr(mt.array.slice(),mt.itemSize,mt.normalized));for(var Ce=0,Le=Pe.length;Ce<Le;Ce++){var Ye=Pe[Ce];if(mt.setX(Ye,ze[Ce*H]),H>=2&&mt.setY(Ye,ze[Ce*H+1]),H>=3&&mt.setZ(Ye,ze[Ce*H+2]),H>=4&&mt.setW(Ye,ze[Ce*H+3]),H>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return mt})},B.prototype.loadTexture=function(nt){var lt=this,ut=this.json,vt=this.options,Q=this.textureLoader,gt=window.URL||window.webkitURL,Y=ut.textures[nt],H=Y.extensions||{},at;H[e.MSFT_TEXTURE_DDS]?at=ut.images[H[e.MSFT_TEXTURE_DDS].source]:at=ut.images[Y.source];var ft=at.uri,wt=!1;return at.bufferView!==void 0&&(ft=lt.getDependency("bufferView",at.bufferView).then(function(_t){wt=!0;var Dt=new Blob([_t],{type:at.mimeType});return ft=gt.createObjectURL(Dt),ft})),Promise.resolve(ft).then(function(_t){var Dt=vt.manager.getHandler(_t);return Dt||(Dt=H[e.MSFT_TEXTURE_DDS]?lt.extensions[e.MSFT_TEXTURE_DDS].ddsLoader:Q),new Promise(function(Gt,te){Dt.load(tt(_t,vt.path),Gt,void 0,te)})}).then(function(_t){wt===!0&&gt.revokeObjectURL(ft),_t.flipY=!1,Y.name!==void 0&&(_t.name=Y.name),at.mimeType in Z&&(_t.format=Z[at.mimeType]);var Dt=ut.samplers||{},Gt=Dt[Y.sampler]||{};return _t.magFilter=M[Gt.magFilter]||pi,_t.minFilter=M[Gt.minFilter]||Qc,_t.wrapS=E[Gt.wrapS]||Ol,_t.wrapT=E[Gt.wrapT]||Ol,_t})},B.prototype.assignTexture=function(nt,lt,ut){var vt=this;return this.getDependency("texture",ut.index).then(function(Q){if(!Q.isCompressedTexture)switch(lt){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":Q.format=oa;break}if(ut.texCoord!==void 0&&ut.texCoord!=0&&!(lt==="aoMap"&&ut.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+ut.texCoord+" for texture "+lt+" not yet supported."),vt.extensions[e.KHR_TEXTURE_TRANSFORM]){var gt=ut.extensions!==void 0?ut.extensions[e.KHR_TEXTURE_TRANSFORM]:void 0;gt&&(Q=vt.extensions[e.KHR_TEXTURE_TRANSFORM].extendTexture(Q,gt))}nt[lt]=Q})},B.prototype.assignFinalMaterial=function(nt){var lt=nt.geometry,ut=nt.material;this.extensions;var vt=lt.attributes.tangent!==void 0,Q=lt.attributes.color!==void 0,gt=lt.attributes.normal===void 0,Y=nt.isSkinnedMesh===!0,H=Object.keys(lt.morphAttributes).length>0,at=H&&lt.morphAttributes.normal!==void 0;if(nt.isPoints){var ft="PointsMaterial:"+ut.uuid,wt=this.cache.get(ft);wt||(wt=new Xa,er.prototype.copy.call(wt,ut),wt.color.copy(ut.color),wt.map=ut.map,wt.sizeAttenuation=!1,this.cache.add(ft,wt)),ut=wt}else if(nt.isLine){var ft="LineBasicMaterial:"+ut.uuid,_t=this.cache.get(ft);_t||(_t=new ni,er.prototype.copy.call(_t,ut),_t.color.copy(ut.color),this.cache.add(ft,_t)),ut=_t}if(vt||Q||gt||Y||H){var ft="ClonedMaterial:"+ut.uuid+":";ut.isGLTFSpecularGlossinessMaterial&&(ft+="specular-glossiness:"),Y&&(ft+="skinning:"),vt&&(ft+="vertex-tangents:"),Q&&(ft+="vertex-colors:"),gt&&(ft+="flat-shading:"),H&&(ft+="morph-targets:"),at&&(ft+="morph-normals:");var Dt=this.cache.get(ft);Dt||(Dt=ut.clone(),Y&&(Dt.skinning=!0),vt&&(Dt.vertexTangents=!0),Q&&(Dt.vertexColors=Jc),gt&&(Dt.flatShading=!0),H&&(Dt.morphTargets=!0),at&&(Dt.morphNormals=!0),this.cache.add(ft,Dt)),ut=Dt}ut.aoMap&&lt.attributes.uv2===void 0&&lt.attributes.uv!==void 0&&lt.setAttribute("uv2",new nr(lt.attributes.uv.array,2)),ut.normalScale&&!vt&&(ut.normalScale.y=-ut.normalScale.y),nt.material=ut},B.prototype.loadMaterial=function(nt){var lt=this,ut=this.json,vt=this.extensions,Q=ut.materials[nt],gt,Y={},H=Q.extensions||{},at=[];if(H[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var ft=vt[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];gt=ft.getMaterialType(),at.push(ft.extendParams(Y,Q,lt))}else if(H[e.KHR_MATERIALS_UNLIT]){var wt=vt[e.KHR_MATERIALS_UNLIT];gt=wt.getMaterialType(),at.push(wt.extendParams(Y,Q,lt))}else{gt=yo;var _t=Q.pbrMetallicRoughness||{};if(Y.color=new Dn(1,1,1),Y.opacity=1,Array.isArray(_t.baseColorFactor)){var Dt=_t.baseColorFactor;Y.color.fromArray(Dt),Y.opacity=Dt[3]}_t.baseColorTexture!==void 0&&at.push(lt.assignTexture(Y,"map",_t.baseColorTexture)),Y.metalness=_t.metallicFactor!==void 0?_t.metallicFactor:1,Y.roughness=_t.roughnessFactor!==void 0?_t.roughnessFactor:1,_t.metallicRoughnessTexture!==void 0&&(at.push(lt.assignTexture(Y,"metalnessMap",_t.metallicRoughnessTexture)),at.push(lt.assignTexture(Y,"roughnessMap",_t.metallicRoughnessTexture)))}Q.doubleSided===!0&&(Y.side=id);var Gt=Q.alphaMode||j.OPAQUE;return Gt===j.BLEND?Y.transparent=!0:(Y.transparent=!1,Gt===j.MASK&&(Y.alphaTest=Q.alphaCutoff!==void 0?Q.alphaCutoff:.5)),Q.normalTexture!==void 0&&gt!==Fi&&(at.push(lt.assignTexture(Y,"normalMap",Q.normalTexture)),Y.normalScale=new on(1,1),Q.normalTexture.scale!==void 0&&Y.normalScale.set(Q.normalTexture.scale,Q.normalTexture.scale)),Q.occlusionTexture!==void 0&&gt!==Fi&&(at.push(lt.assignTexture(Y,"aoMap",Q.occlusionTexture)),Q.occlusionTexture.strength!==void 0&&(Y.aoMapIntensity=Q.occlusionTexture.strength)),Q.emissiveFactor!==void 0&&gt!==Fi&&(Y.emissive=new Dn().fromArray(Q.emissiveFactor)),Q.emissiveTexture!==void 0&&gt!==Fi&&at.push(lt.assignTexture(Y,"emissiveMap",Q.emissiveTexture)),Promise.all(at).then(function(){var te;return gt===d?te=vt[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Y):te=new gt(Y),Q.name!==void 0&&(te.name=Q.name),te.map&&(te.map.encoding=hd),te.emissiveMap&&(te.emissiveMap.encoding=hd),U(te,Q),Q.extensions&&J(vt,te,Q),te})};function O(nt,lt,ut){var vt=lt.attributes,Q=new cs;if(vt.POSITION!==void 0){var gt=ut.json.accessors[vt.POSITION],Y=gt.min,H=gt.max;if(Y!==void 0&&H!==void 0)Q.set(new oe(Y[0],Y[1],Y[2]),new oe(H[0],H[1],H[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var at=lt.targets;if(at!==void 0)for(var ft=new oe,wt=0,_t=at.length;wt<_t;wt++){var Dt=at[wt];if(Dt.POSITION!==void 0){var gt=ut.json.accessors[Dt.POSITION],Y=gt.min,H=gt.max;Y!==void 0&&H!==void 0?(ft.setX(Math.max(Math.abs(Y[0]),Math.abs(H[0]))),ft.setY(Math.max(Math.abs(Y[1]),Math.abs(H[1]))),ft.setZ(Math.max(Math.abs(Y[2]),Math.abs(H[2]))),Q.expandByVector(ft)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}nt.boundingBox=Q;var Gt=new ua;Q.getCenter(Gt.center),Gt.radius=Q.min.distanceTo(Q.max)/2,nt.boundingSphere=Gt}function q(nt,lt,ut){var vt=lt.attributes,Q=[];function gt(ft,wt){return ut.getDependency("accessor",ft).then(function(_t){nt.setAttribute(wt,_t)})}for(var Y in vt){var H=N[Y]||Y.toLowerCase();H in nt.attributes||Q.push(gt(vt[Y],H))}if(lt.indices!==void 0&&!nt.index){var at=ut.getDependency("accessor",lt.indices).then(function(ft){nt.setIndex(ft)});Q.push(at)}return U(nt,lt),O(nt,lt,ut),Promise.all(Q).then(function(){return lt.targets!==void 0?G(nt,lt.targets,ut):nt})}function it(nt,lt){var ut=nt.getIndex();if(ut===null){var vt=[],Q=nt.getAttribute("position");if(Q!==void 0){for(var gt=0;gt<Q.count;gt++)vt.push(gt);nt.setIndex(vt),ut=nt.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),nt}var Y=ut.count-2,H=[];if(lt===B_)for(var gt=1;gt<=Y;gt++)H.push(ut.getX(0)),H.push(ut.getX(gt)),H.push(ut.getX(gt+1));else for(var gt=0;gt<Y;gt++)gt%2===0?(H.push(ut.getX(gt)),H.push(ut.getX(gt+1)),H.push(ut.getX(gt+2))):(H.push(ut.getX(gt+2)),H.push(ut.getX(gt+1)),H.push(ut.getX(gt)));H.length/3!==Y&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var at=nt.clone();return at.setIndex(H),at}return B.prototype.loadGeometries=function(nt){var lt=this,ut=this.extensions,vt=this.primitiveCache;function Q(Dt){return ut[e.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Dt,lt).then(function(Gt){return q(Gt,Dt,lt)})}for(var gt=[],Y=0,H=nt.length;Y<H;Y++){var at=nt[Y],ft=C(at),wt=vt[ft];if(wt)gt.push(wt.promise);else{var _t;at.extensions&&at.extensions[e.KHR_DRACO_MESH_COMPRESSION]?_t=Q(at):_t=q(new Un,at,lt),vt[ft]={primitive:at,promise:_t},gt.push(_t)}}return Promise.all(gt)},B.prototype.loadMesh=function(nt){for(var lt=this,ut=this.json,vt=ut.meshes[nt],Q=vt.primitives,gt=[],Y=0,H=Q.length;Y<H;Y++){var at=Q[Y].material===void 0?rt(this.cache):this.getDependency("material",Q[Y].material);gt.push(at)}return gt.push(lt.loadGeometries(Q)),Promise.all(gt).then(function(ft){for(var wt=ft.slice(0,ft.length-1),_t=ft[ft.length-1],Dt=[],Gt=0,te=_t.length;Gt<te;Gt++){var mt=_t[Gt],At=Q[Gt],Ot,Zt=wt[Gt];if(At.mode===x.TRIANGLES||At.mode===x.TRIANGLE_STRIP||At.mode===x.TRIANGLE_FAN||At.mode===void 0)Ot=vt.isSkinnedMesh===!0?new Rd(mt,Zt):new $r(mt,Zt),Ot.isSkinnedMesh===!0&&!Ot.geometry.attributes.skinWeight.normalized&&Ot.normalizeSkinWeights(),At.mode===x.TRIANGLE_STRIP?Ot.geometry=it(Ot.geometry,DC):At.mode===x.TRIANGLE_FAN&&(Ot.geometry=it(Ot.geometry,B_));else if(At.mode===x.LINES)Ot=new ci(mt,Zt);else if(At.mode===x.LINE_STRIP)Ot=new Uo(mt,Zt);else if(At.mode===x.LINE_LOOP)Ot=new km(mt,Zt);else if(At.mode===x.POINTS)Ot=new Bm(mt,Zt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+At.mode);Object.keys(Ot.geometry.morphAttributes).length>0&&I(Ot,vt),Ot.name=vt.name||"mesh_"+nt,_t.length>1&&(Ot.name+="_"+Gt),U(Ot,vt),lt.assignFinalMaterial(Ot),Dt.push(Ot)}if(Dt.length===1)return Dt[0];for(var he=new Kl,Gt=0,te=Dt.length;Gt<te;Gt++)he.add(Dt[Gt]);return he})},B.prototype.loadCamera=function(nt){var lt,ut=this.json.cameras[nt],vt=ut[ut.type];if(!vt){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ut.type==="perspective"?lt=new gi(pr.radToDeg(vt.yfov),vt.aspectRatio||1,vt.znear||1,vt.zfar||2e6):ut.type==="orthographic"&&(lt=new Ku(vt.xmag/-2,vt.xmag/2,vt.ymag/2,vt.ymag/-2,vt.znear,vt.zfar)),ut.name!==void 0&&(lt.name=ut.name),U(lt,ut),Promise.resolve(lt)},B.prototype.loadSkin=function(nt){var lt=this.json.skins[nt],ut={joints:lt.joints};return lt.inverseBindMatrices===void 0?Promise.resolve(ut):this.getDependency("accessor",lt.inverseBindMatrices).then(function(vt){return ut.inverseBindMatrices=vt,ut})},B.prototype.loadAnimation=function(nt){for(var lt=this.json,ut=lt.animations[nt],vt=[],Q=[],gt=[],Y=[],H=[],at=0,ft=ut.channels.length;at<ft;at++){var wt=ut.channels[at],_t=ut.samplers[wt.sampler],Dt=wt.target,Gt=Dt.node!==void 0?Dt.node:Dt.id,te=ut.parameters!==void 0?ut.parameters[_t.input]:_t.input,mt=ut.parameters!==void 0?ut.parameters[_t.output]:_t.output;vt.push(this.getDependency("node",Gt)),Q.push(this.getDependency("accessor",te)),gt.push(this.getDependency("accessor",mt)),Y.push(_t),H.push(Dt)}return Promise.all([Promise.all(vt),Promise.all(Q),Promise.all(gt),Promise.all(Y),Promise.all(H)]).then(function(At){for(var Ot=At[0],Zt=At[1],he=At[2],fe=At[3],be=At[4],Me=[],Pe=0,ze=Ot.length;Pe<ze;Pe++){var Ce=Ot[Pe],Le=Zt[Pe],Ye=he[Pe],le=fe[Pe],Fe=be[Pe];if(Ce!==void 0){Ce.updateMatrix(),Ce.matrixAutoUpdate=!0;var Ke;switch(V[Fe.path]){case V.weights:Ke=qu;break;case V.rotation:Ke=Yd;break;case V.position:case V.scale:default:Ke=Xu;break}var Ze=Ce.name?Ce.name:Ce.uuid,ke=le.interpolation!==void 0?K[le.interpolation]:eu,Qe=[];V[Fe.path]===V.weights?Ce.traverse(function(Pn){Pn.isMesh===!0&&Pn.morphTargetInfluences&&Qe.push(Pn.name?Pn.name:Pn.uuid)}):Qe.push(Ze);var hn=Ye.array;if(Ye.normalized){var ln;if(hn.constructor===Int8Array)ln=1/127;else if(hn.constructor===Uint8Array)ln=1/255;else if(hn.constructor==Int16Array)ln=1/32767;else if(hn.constructor===Uint16Array)ln=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var Hn=new Float32Array(hn.length),Tn=0,Sn=hn.length;Tn<Sn;Tn++)Hn[Tn]=hn[Tn]*ln;hn=Hn}for(var Tn=0,Sn=Qe.length;Tn<Sn;Tn++){var On=new Ke(Qe[Tn]+"."+V[Fe.path],Le.array,hn,ke);le.interpolation==="CUBICSPLINE"&&(On.createInterpolant=function(zn){return new v(this.times,this.values,this.getValueSize()/3,zn)},On.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Me.push(On)}}}var qn=ut.name!==void 0?ut.name:"animation_"+nt;return new Zo(qn,void 0,Me)})},B.prototype.loadNode=function(nt){var lt=this.json,ut=this.extensions,vt=this,Q=lt.meshReferences,gt=lt.meshUses,Y=lt.nodes[nt];return function(){var H=[];return Y.mesh!==void 0&&H.push(vt.getDependency("mesh",Y.mesh).then(function(at){var ft;if(Q[Y.mesh]>1){var wt=gt[Y.mesh]++;ft=at.clone(),ft.name+="_instance_"+wt}else ft=at;return Y.weights!==void 0&&ft.traverse(function(_t){if(_t.isMesh)for(var Dt=0,Gt=Y.weights.length;Dt<Gt;Dt++)_t.morphTargetInfluences[Dt]=Y.weights[Dt]}),ft})),Y.camera!==void 0&&H.push(vt.getDependency("camera",Y.camera)),Y.extensions&&Y.extensions[e.KHR_LIGHTS_PUNCTUAL]&&Y.extensions[e.KHR_LIGHTS_PUNCTUAL].light!==void 0&&H.push(vt.getDependency("light",Y.extensions[e.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(H)}().then(function(H){var at;if(Y.isBone===!0?at=new ky:H.length>1?at=new Kl:H.length===1?at=H[0]:at=new Rn,at!==H[0])for(var ft=0,wt=H.length;ft<wt;ft++)at.add(H[ft]);if(Y.name!==void 0&&(at.userData.name=Y.name,at.name=Hi.sanitizeNodeName(Y.name)),U(at,Y),Y.extensions&&J(ut,at,Y),Y.matrix!==void 0){var _t=new mr;_t.fromArray(Y.matrix),at.applyMatrix4(_t)}else Y.translation!==void 0&&at.position.fromArray(Y.translation),Y.rotation!==void 0&&at.quaternion.fromArray(Y.rotation),Y.scale!==void 0&&at.scale.fromArray(Y.scale);return at})},B.prototype.loadScene=function(){function nt(lt,ut,vt,Q){var gt=vt.nodes[lt];return Q.getDependency("node",lt).then(function(Y){if(gt.skin===void 0)return Y;var H;return Q.getDependency("skin",gt.skin).then(function(at){H=at;for(var ft=[],wt=0,_t=H.joints.length;wt<_t;wt++)ft.push(Q.getDependency("node",H.joints[wt]));return Promise.all(ft)}).then(function(at){return Y.traverse(function(ft){if(ft.isMesh){for(var wt=[],_t=[],Dt=0,Gt=at.length;Dt<Gt;Dt++){var te=at[Dt];if(te){wt.push(te);var mt=new mr;H.inverseBindMatrices!==void 0&&mt.fromArray(H.inverseBindMatrices.array,Dt*16),_t.push(mt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',H.joints[Dt])}ft.bind(new Tm(wt,_t),ft.matrixWorld)}}),Y})}).then(function(Y){ut.add(Y);var H=[];if(gt.children)for(var at=gt.children,ft=0,wt=at.length;ft<wt;ft++){var _t=at[ft];H.push(nt(_t,Y,vt,Q))}return Promise.all(H)})}return function(ut){var vt=this.json,Q=this.extensions,gt=this.json.scenes[ut],Y=this,H=new la;gt.name!==void 0&&(H.name=gt.name),U(H,gt),gt.extensions&&J(Q,H,gt);for(var at=gt.nodes||[],ft=[],wt=0,_t=at.length;wt<_t;wt++)ft.push(nt(at[wt],H,vt,Y));return Promise.all(ft).then(function(){return H})}}(),t}();function KF(t){new YF().load("./gis/34M_17.gltf",e=>{e.scene.position.set(116577.28779765591,19632.646909285337,0),e.scene.rotateX(Math.PI/2),e.scene.scale.set(2,2,2),t.addObject(e.scene)})}const ZF=`import { MxCpp, McGePoint3d, McDbLine, McCmColor } from "mxcad";

//画直线
function drawLine() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 绘制直线
  let line_1 = new McDbLine()
  let pt1 = new McGePoint3d(1000, 200, 0)
  let pt2 = new McGePoint3d(-1000, -200, 0)
  line_1.startPoint = pt1
  line_1.endPoint = pt2
  line_1.trueColor = new McCmColor(0, 255, 0)
  mxcad.drawEntity(line_1)

  let line_2 = new McDbLine(1000, 500, 0, -1000, -500, 0)
  line_2.trueColor = new McCmColor(255, 0, 0)
  line_2.linetypeScale = 0.4
  mxcad.drawEntity(line_2)

  mxcad.drawLine(1000, 800, -1000, -800)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画直线方法
drawLine();
`,JF=`import {MxCpp, McDbCircle , McCmColor, McGePoint3d} from "mxcad"

//画圆
function drawCircle() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  //绘制圆
  const circle_1 = new McDbCircle(-100, 300, 0, 20)
  circle_1.trueColor = new McCmColor(255, 0, 0)
  mxcad.drawEntity(circle_1)

  const circle_2 = new McDbCircle()
  circle_2.center = new McGePoint3d(-100, 300, 0)
  circle_2.radius = 10
  circle_2.trueColor = new McCmColor(0, 255, 0)
  mxcad.drawEntity(circle_2)

  mxcad.drawCircle(-100, 300, 30)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画圆方法
drawCircle();
`,$F=`import { MxCpp, McDbPoint, McCmColor } from "mxcad"

//画点
function drawPoint() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 循环画点
  const point = new McDbPoint()
  const color = new McCmColor(0, 255, 0)
  point.trueColor = color
  for (let i = 0; i < 100; i++) {
    point.setPosition(i, 200 + i)
    mxcad.drawEntity(point)
  }
  for (let i = 0; i < 100; i++) {
    mxcad.drawPoint(i, 150 + i)
  }

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画点的函数
drawPoint();`,QF=`import { MxCpp, McGePoint3d } from "mxcad";

//画图片
function drawImg() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  //图片插入点
  const pt = new McGePoint3d(0, 0, 0)
  //图片地址
  let imagUrl = "https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg";
  mxcad.loadImage(imagUrl, (image) => {
    if (!image) {
      console.log("loadImage failed");
      return;
    }
    let width = mxcad.mxdraw.viewCoordLong2Cad(100);
    let height = (image.height / image.width) * width;
    mxcad.drawImage((pt as any).x, (pt as any).y, width, height, 0, imagUrl,true,image.width,image.height);
    mxcad.updateDisplay();
  });
};

// 调用绘图片方法
drawImg();`,tN=`import { MxCpp, McDbArc, McGePoint3d, McCmColor} from "mxcad";

//画圆弧
function drawArc() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  const arc = new McDbArc()
  arc.center = new McGePoint3d(-100, -100),
    arc.radius = 20
  arc.startAngle = Math.PI / 2
  arc.endAngle = Math.PI * 3 / 2
  arc.trueColor = new McCmColor(255, 233, 0)
  mxcad.drawEntity(arc)

  const arc_1 = new McDbArc()
  const pt1 = new McGePoint3d(-60, -80)
  const pt2 = new McGePoint3d(-80, -100)
  const pt3 = new McGePoint3d(-60, -120)
  arc_1.trueColor = new McCmColor(0, 255, 0)
  arc_1.computeArc(pt1.x, pt1.y, pt2.x, pt2.y, pt3.x, pt3.y)
  mxcad.drawEntity(arc_1)

  mxcad.drawArc(-120, -100, 20, 100, 250);

  mxcad.drawColor = new McCmColor(255, 0, 0)
  mxcad.drawArc2(-80, -80, -100, -100, -80, -120)

  mxcad.drawColor = new McCmColor(0, 0, 255)
  mxcad.drawArc3(-40, -80, -40, -120, 1)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用绘圆方法
drawArc()`,eN=`import { MxCpp, McDbPolyline, McGePoint3d } from "mxcad"

//画多段线
function drawPolyline() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();
 
  // 画多段线
  const polyline = new McDbPolyline()
  polyline.isClosed = true // 设置闭合
  polyline.constantWidth = 5 // 设置线宽
  // 添加多段线顶点
  polyline.addVertexAt(new McGePoint3d(800, 300, 0))
  polyline.addVertexAt(new McGePoint3d(900, 300, 0))
  polyline.addVertexAt(new McGePoint3d(900, 400, 0))
  mxcad.drawEntity(polyline)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
}

// 调用画多段线的方法
drawPolyline()`,nN=`import {McDbEllipse, McGeVector3d, MxCpp, McGePoint3d, McCmColor } from "mxcad";
 
//画椭圆弧
function drawEllipse() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  //绘制椭圆
  const ellipse = new McDbEllipse();
  ellipse.center = new McGePoint3d(-200, -200);
  ellipse.majorAxis = new McGeVector3d(0, 300, 0);
  ellipse.radiusRatio = 0.5;
  ellipse.trueColor = new McCmColor(255, 233, 0);
  mxcad.drawEntity(ellipse);

  const ellipse_arc = new McDbEllipse();
  ellipse_arc.center = new McGePoint3d(-380, -200);
  ellipse_arc.majorAxis = new McGeVector3d(0, 150, 0);
  ellipse_arc.minorAxis = new McGeVector3d(280, 0, 0);
  ellipse_arc.startAngle = Math.PI / 2;
  ellipse_arc.endAngle = Math.PI * 3 / 2;
  ellipse_arc.trueColor = new McCmColor(0, 255, 255);
  mxcad.drawEntity(ellipse_arc);

  mxcad.drawEllipse(0, -200, 200, 0, 1.5);

  mxcad.drawColor = new McCmColor(0, 255, 0);
  mxcad.drawEllipseArc(200, -200, 200, 0, 1.5, 100, 650);

  mxcad.zoomAll();
  mxcad.zoomScale(0.8);
};

// 调用画椭圆的方法
drawEllipse();`,rN=`import { MxCpp, McGePoint3d, McDbText, McCmColor } from "mxcad";

function drawText() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 绘制文字
  let text = new McDbText()
  text.textString = 'Hello World'
  text.position = new McGePoint3d(1000, 200, 0)
  text.height = 50
  text.trueColor = new McCmColor(0, 255, 0)
  mxcad.drawEntity(text)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画文字的方法
drawText();`,iN=`import { MxCpp } from "mxcad";\r
\r
function drawMtext() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
\r
    mxcad.addLayer("MtextLayer");\r
\r
    //设置当前图层为"MtextLayer"\r
\r
    mxcad.drawLayer = "MtextLayer"; \r
\r
    mxcad.drawTextStyle = "";\r
\r
    mxcad.drawMText(0, -100, "控件:\\\\P多行文字测试", 50, 400, 0, 1);\r
\r
    mxcad.zoomAll();\r
    mxcad.updateDisplay();\r
};\r
\r
// 调用画多行文字的方法\r
drawMtext();`,oN=`
import { McDbAlignedDimension,McDb, McDbRotatedDimension, MxCpp, McGePoint3d, McCmColor } from "mxcad";
//画标注
function drawDimension() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 画标注
  const mDimension = new McDbAlignedDimension()
  mDimension.xLine1Point = new McGePoint3d(-1800, 800)
  mDimension.xLine2Point = new McGePoint3d(1800, 800)
  mDimension.dimLinePoint = new McGePoint3d(800, 500)
  mDimension.textAttachment = McDb.AttachmentPoint.kTopLeft
  mDimension.trueColor = new McCmColor(200, 255, 0)
  mDimension.oblique = 0
  mxcad.drawEntity(mDimension)

  const rDimension = new McDbRotatedDimension()
  rDimension.xLine1Point = new McGePoint3d(-1800, -800)
  rDimension.xLine2Point = new McGePoint3d(1800, -800)
  rDimension.dimLinePoint = new McGePoint3d(-800, -500)
  rDimension.textAttachment = McDb.AttachmentPoint.kTopLeft
  rDimension.textRotation = 0.0
  rDimension.trueColor = new McCmColor(200, 255, 0)
  rDimension.oblique = 0
  rDimension.rotation = 0
  rDimension.dimensionText = "标注文本"
  mxcad.drawEntity(rDimension)

  mxcad.zoomCenter(0, 0)
};

// 调用画标注方法
drawDimension();`,sN=`import { MxCpp } from "mxcad";\r
\r
// 画路径\r
function drawPath() {\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    // 创建新画布\r
    mxcad.newFile();\r
    //用路径 绘制矩形框\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(0, 300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(100, 300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(100, 400);\r
    //路径的一下个点\r
    mxcad.pathLineTo(0, 400);\r
    //把路径设置成闭合\r
    mxcad.pathMakeClosed();\r
    //生成一个矩形框的多义线\r
    mxcad.drawPathToPolyline();\r
\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(170, 320)\r
    mxcad.pathLineTo(200, 320)\r
    mxcad.pathLineTo(200, 340)\r
    mxcad.pathLineTo(170, 340)\r
    // 把上面定义的路径定义填充排除区域.\r
    mxcad.pathMakeExclude(true)\r
    mxcad.pathMoveTo(150, 300)\r
    mxcad.pathLineTo(250, 300)\r
    mxcad.pathLineTo(250, 400)\r
    mxcad.pathLineTo(150, 400)\r
    mxcad.pathMakeClosed();\r
    // 将路径生成一个填充 这里的参数是图案缩放比例\r
    mxcad.drawPathToHatch(1);\r
\r
    mxcad.zoomAll();\r
    mxcad.zoomScale(0.8)\r
};\r
\r
// 调用画路径的函数\r
drawPath();`,aN=`import { MxCpp, McCmColor } from "mxcad";\r
\r
// 画填充\r
function drawHatch() {\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    // 创建新画布\r
    mxcad.newFile();\r
    // 绘制一个实心填充\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(150, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(250, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(250, 3400);\r
    //路径的一下个点\r
    mxcad.pathLineTo(150, 3300);\r
    //把路径拟合成一个样线\r
    mxcad.drawColor = new McCmColor(255, 0, 0);\r
    mxcad.drawPathToHatch(1);\r
\r
    // 绘制一个图形填充\r
    mxcad.addPatternDefinition("MyHatchPattern1", "((45, 0,0, 0,0.125))");\r
    mxcad.drawPatternDefinition = "MyHatchPattern1";\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(250, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(350, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(350, 3400);\r
    //路径的一下个点\r
    mxcad.pathLineTo(250, 3300);\r
    mxcad.drawColor = new McCmColor(255, 255, 0);\r
    //把路径变成一个填充,80,是填充图案的缩放比例.\r
    mxcad.drawPathToHatch(100);\r
    mxcad.zoomAll()\r
    mxcad.zoomScale(0.8)\r
};\r
\r
// 调用画填充的方法\r
drawHatch();`,lN=`import { MxCpp, McDbBlockTableRecord, McDbLine, McDbCircle, McCmColor, McDbBlockReference, McGePoint3d } from "mxcad";\r
\r
// 画图块\r
function drawBlock() {\r
  const mxcad = MxCpp.getCurrentMxCAD();\r
  // 创建新画布\r
  mxcad.newFile();\r
\r
  // 先从数据库中得到图块表\r
  let blkTable = mxcad.getDatabase().getBlockTable();\r
  // 将一个新的图块记录添加到图块表中\r
  let blkRecId = blkTable.add(new McDbBlockTableRecord());\r
\r
  // 根据ObjectId再次得到刚刚添加的图块记录\r
  let blkTableRecord = blkRecId.getMcDbBlockTableRecord()\r
\r
  // 添加两条线段再图块记录中 这里每条线段的具体属性比如开始点和结束点自行赋值\r
  const line = new McDbLine(50, 50, 0, -50, -50, 0)\r
  line.trueColor = new McCmColor(0, 255, 0)\r
  const line1 = new McDbLine(-50, 50, 0, 50, -50, 0)\r
  const circle = new McDbCircle(0, 0, 0, 50)\r
  circle.trueColor = new McCmColor(255, 255, 0)\r
  blkTableRecord.appendAcDbEntity(line);\r
  blkTableRecord.appendAcDbEntity(line1);\r
  blkTableRecord.appendAcDbEntity(circle);\r
\r
  // 设置图块的基点 一般是包围盒内的点， 可以任意指定\r
  blkTableRecord.origin = new McGePoint3d(0, 0, 0);\r
\r
  // 实例化块参照 这里需要设置我们刚刚添加图块记录得到的ObjectId\r
  let blkRef = new McDbBlockReference();\r
  blkRef.blockTableRecordId = blkRecId;\r
  // 最后设置位置 渲染图块\r
  blkRef.position = new McGePoint3d(0, 0, 0);\r
\r
  mxcad.drawEntity(blkRef);\r
\r
  mxcad.zoomAll()\r
  mxcad.zoomScale(0.8)\r
};\r
\r
// 调用画图块方法\r
drawBlock();`,cN=`import {\r
    MxCpp, McDbLine, McGePoint3d, McDbCustomEntity, IMcDbDwgFiler, MxCADWorldDraw, McGePoint3dArray,\r
    McGeVector3d, McDbText, McDb, MxCADResbuf, MxCADSelectionSet, McObjectId, McDbCircle,\r
    McDbEntity,\r
    McDbMText,\r
    MxCADUtility\r
} from "mxcad"\r
\r
// 线文本自定义实体\r
// 新创建 McDbLineText 类，继承McDbCustomEntity\r
class McDbTestLineText extends McDbCustomEntity {\r
    //设置McDbLineText类中的两个直线端点 pt1、pt2\r
    //以及显示线段长度的文字_text和文字大小_textsize\r
    private pt1: McGePoint3d = new McGePoint3d();\r
    private pt2: McGePoint3d = new McGePoint3d();\r
    private _text: string = "";\r
    private _textsize: number = 10;\r
    /** 包围盒最大点 包围盒最小点 */\r
    private minPt: McGePoint3d = new McGePoint3d();\r
    private maxPt: McGePoint3d = new McGePoint3d();\r
    //构造函数\r
    constructor(imp?: any) {\r
        super(imp);\r
    }\r
    //创建函数\r
    public create(imp: any) {\r
        return new McDbTestLineText(imp)\r
    }\r
    //获取类型\r
    public getTypeName(): string {\r
        return "McDbTestLineText";\r
    }\r
    //设置或获取文本值\r
    public set text(val: string) {\r
        this._text = val;\r
    }\r
    public get text(): string {\r
        return this._text;\r
    }\r
    //设置或获取文本大小\r
    public set textsize(val: number) {\r
        this._textsize = val;\r
    }\r
    public get textsize(): number {\r
        return this._textsize;\r
    }\r
    //读取自定义实体数据pt1、pt2、_text、_textsize\r
    public dwgInFields(filter: IMcDbDwgFiler): boolean {\r
        this.pt1 = filter.readPoint("pt1").val;\r
        this.pt2 = filter.readPoint("pt2").val;\r
        this._text = filter.readString("text").val;\r
        this._textsize = filter.readDouble("textsize").val;\r
        this.minPt = filter.readPoint("minPt").val;\r
        this.maxPt = filter.readPoint("maxPt").val;\r
        return true;\r
    }\r
    //写入自定义实体数据pt1、pt2、_text、_textsize\r
    public dwgOutFields(filter: IMcDbDwgFiler): boolean {\r
        filter.writePoint("pt1", this.pt1);\r
        filter.writePoint("pt2", this.pt2);\r
        filter.writeString("text", this._text);\r
        filter.writeDouble("textsize", this._textsize);\r
        filter.writePoint("minPt", this.minPt);\r
        filter.writePoint("maxPt", this.maxPt);\r
        return true;\r
    }\r
    //自定义同步函数，当其他对象与该对象相连时同步数据\r
    private fineLink(pt: McGePoint3d): any {\r
        let ret: any = {};\r
        let myId = this.getObjectID();\r
        let dSearch = this._textsize * 0.5;;\r
        let filter = new MxCADResbuf();\r
        filter.AddString("CUSTOMENTITY", 5020);\r
        let ss = new MxCADSelectionSet();\r
        ss.crossingSelect(pt.x - dSearch, pt.y - dSearch, pt.x + dSearch, pt.y + dSearch, filter);\r
        ss.forEach((id) => {\r
            if (id == myId)\r
                return;\r
            let ent = id.getMcDbEntity();\r
            if (!ent) return;\r
            if (ent instanceof McDbTestLineText) {\r
                let line = (ent as McDbTestLineText);\r
                let linkPoint = line.getPoint1();\r
                let link_pos = 0;\r
                // 得到直线与图块连接的端点坐标.\r
                let dist = line.getPoint1().distanceTo(pt);\r
                if (dist > line.getPoint2().distanceTo(pt)) {\r
                    dist = line.getPoint2().distanceTo(pt);\r
                    linkPoint = line.getPoint2();\r
                    link_pos = 1;\r
                }\r
                if (dist < dSearch) {\r
                    ret[id.id] = { link_point: linkPoint, link_pos: link_pos };\r
                }\r
            }\r
        });\r
        return ret;\r
    }\r
    //处理夹点编辑效果\r
    public moveGripPointsAt(iIndex: number, dXOffset: number, dYOffset: number, dZOffset: number) {\r
        this.assertWrite();\r
        let pt: McGePoint3d = this.pt1.clone();\r
        let new_pt: McGePoint3d = pt;\r
        if (iIndex == 0) {\r
            this.pt1.x += dXOffset;\r
            this.pt1.y += dYOffset;\r
            this.pt1.z += dZOffset;\r
            new_pt = this.pt1;\r
        }\r
        else if (iIndex == 1) {\r
            pt = this.pt2.clone();\r
            this.pt2.x += dXOffset;\r
            this.pt2.y += dYOffset;\r
            this.pt2.z += dZOffset;\r
            new_pt = this.pt2;\r
        }\r
        if (this.getObjectID().isValid()) {\r
            // 同步，与连接的其它对象。\r
            let linkobj = this.fineLink(pt)\r
            Object.keys(linkobj).forEach((id_val: any) => {\r
                let idFind = new McObjectId(id_val);\r
                let lineFind = (idFind.getMcDbEntity() as McDbTestLineText);\r
                if (linkobj[id_val].link_pos == 0) {\r
                    lineFind.setPoint1(new_pt);\r
                }\r
                else {\r
                    lineFind.setPoint2(new_pt);\r
                }\r
            });\r
        }\r
    };\r
    //设置对象编辑点位\r
    public getGripPoints(): McGePoint3dArray {\r
        let ret = new McGePoint3dArray()\r
        ret.append(this.pt1);\r
        ret.append(this.pt2);\r
        return ret;\r
    };\r
    //动态绘制\r
    public worldDraw(draw: MxCADWorldDraw): void {\r
        const allEntityArr: McDbEntity[] = [];\r
\r
        let circle_r = this._textsize * 0.4;\r
        let vec2 = this.pt2.sub(this.pt1);\r
        vec2.normalize().mult(circle_r);\r
        let tmpline = new McDbLine(this.pt1.clone().addvec(vec2),\r
            this.pt2.clone().subvec(vec2));\r
        draw.drawEntity(tmpline);\r
        allEntityArr.push(tmpline)\r
        let vec = this.pt2.sub(this.pt1).mult(0.5);\r
        let midpt = this.pt1.clone().addvec(vec);\r
        if (vec.dotProduct(McGeVector3d.kXAxis) < 0) {\r
            vec.negate();\r
        }\r
        let ange = vec.angleTo2(McGeVector3d.kXAxis, McGeVector3d.kNegateZAxis);\r
        let str = this._text;\r
        if (str.length == 0) {\r
            str = this.pt1.distanceTo(this.pt2).toFixed(2);\r
        }\r
        vec.perpVector();\r
        if (vec.dotProduct(McGeVector3d.kYAxis) < 0) {\r
            vec.negate();\r
        }\r
        vec.normalize().mult(this._textsize * 0.2);\r
        let text = new McDbText();\r
        text.textString = str;\r
        text.position = midpt.clone().addvec(vec);\r
        text.alignmentPoint = midpt.clone().addvec(vec);\r
        text.rotation = ange;\r
        text.verticalMode = McDb.TextVertMode.kTextBottom;\r
        text.horizontalMode = McDb.TextHorzMode.kTextCenter;\r
        text.height = this._textsize;\r
        draw.drawEntity(text)\r
        allEntityArr.push(text)\r
        let circle1 = new McDbCircle();\r
        circle1.center = this.pt1;\r
        circle1.radius = circle_r;\r
        draw.drawEntity(circle1);\r
        allEntityArr.push(circle1)\r
\r
        let circle2 = new McDbCircle();\r
        circle2.center = this.pt2;\r
        circle2.radius = circle_r;\r
        draw.drawEntity(circle2);\r
        allEntityArr.push(circle2)\r
\r
        this.getBox(allEntityArr);\r
    }\r
    private getBox(entityArr: McDbEntity[]) {\r
        const mxcad = MxCpp.getCurrentMxCAD();\r
        let _minPt, _maxPt = null;\r
        let result;\r
        entityArr.forEach(entity => {\r
            if (entity instanceof McDbText) {\r
                const ent = new McDbMText()\r
                ent.contents = entity.textString;\r
                ent.textHeight = entity.height;\r
                ent.location = entity.position;\r
                switch (entity.horizontalMode) {\r
                    case McDb.TextHorzMode.kTextLeft:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                    case McDb.TextHorzMode.kTextCenter:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    case McDb.TextHorzMode.kTextRight:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomRight;\r
                        break;\r
                    case McDb.TextHorzMode.kTextMid:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    default:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                }\r
                // 将ent的文字样式设置为当前文字样式\r
                const textStyleId = mxcad.getDatabase().getCurrentlyTextStyleId();\r
                ent.textStyleId = textStyleId;\r
                ent.reCompute();\r
                result = MxCADUtility.getTextEntityBox(ent, false);\r
            } else if (entity instanceof McDbMText) {\r
                entity.reCompute();\r
                result = MxCADUtility.getTextEntityBox(entity, false);\r
            } else {\r
                result = entity.getBoundingBox();\r
            }\r
            const { minPt, maxPt, ret } = result;\r
            if (!_minPt) _minPt = minPt.clone();\r
            if (!_maxPt) _maxPt = maxPt.clone();\r
            if (minPt.x < _minPt.x) _minPt.x = minPt.x;\r
            if (minPt.y < _minPt.y) _minPt.y = minPt.y;\r
            if (maxPt.x > _maxPt.x) _maxPt.x = maxPt.x;\r
            if (maxPt.y > _maxPt.y) _maxPt.y = maxPt.y;\r
        });\r
        if (_minPt && _maxPt) {\r
            this.maxPt = _maxPt;\r
            this.minPt = _minPt\r
        }\r
    }\r
    // 设置pt1\r
    public setPoint1(pt1: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt1 = pt1.clone();\r
    }\r
    // 设置pt2\r
    public setPoint2(pt2: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt2 = pt2.clone();\r
    }\r
    // 获取pt1\r
    public getPoint1() {\r
        return this.pt1;\r
    }\r
    //获取pt2\r
    public getPoint2() {\r
        return this.pt2;\r
    }\r
    // 获取包围盒\r
    public getBoundingBox(): { minPt: McGePoint3d; maxPt: McGePoint3d; ret: boolean; } {\r
        return { minPt: this.minPt, maxPt: this.maxPt, ret: true }\r
    }\r
}\r
\r
// 绘线文本自定义实体\r
async function MxTest_LineText() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
\r
    let pt1 = new McGePoint3d(100, 100, 0);\r
    let pt2 = new McGePoint3d(200, 150, 0);\r
    let pt3 = new McGePoint3d(400, 50, 0);\r
    let pt4 = new McGePoint3d(600, 60, 0);\r
    let pt5 = new McGePoint3d(200, 300, 0);\r
\r
    let textsize = 5;\r
\r
    let myline1 = new McDbTestLineText();\r
    myline1.setPoint1(pt1);\r
    myline1.setPoint2(pt2);\r
    myline1.textsize = textsize;\r
    myline1.text = "xxxx";\r
    mxcad.drawEntity(myline1);\r
\r
\r
    let myline2 = new McDbTestLineText();\r
    myline2.setPoint1(pt2);\r
    myline2.setPoint2(pt3);\r
    myline2.textsize = textsize;\r
    mxcad.drawEntity(myline2);\r
\r
    let myline3 = new McDbTestLineText();\r
    myline3.setPoint1(pt3);\r
    myline3.setPoint2(pt4);\r
    myline3.textsize = textsize;\r
    mxcad.drawEntity(myline3);\r
\r
\r
    let myline4 = new McDbTestLineText();\r
    myline4.setPoint1(pt2);\r
    myline4.setPoint2(pt5);\r
    myline4.textsize = textsize;\r
    mxcad.drawEntity(myline4);\r
\r
\r
    //把所有的实体都放到当前显示视区\r
    mxcad.zoomW(new McGePoint3d(-300, -300, 0), new McGePoint3d(650, 500, 0));\r
    //更新视区显示\r
    mxcad.updateDisplay();\r
}\r
\r
// 自定义实体注册\r
new McDbTestLineText().rxInit();\r
// 调用绘线文本自定义实体方法\r
MxTest_LineText();\r
\r
`,uN=`import { McCmColor, MxCpp} from "mxcad"\r
\r
// 绘制多种线型直线\r
function Mx_Test_DrawLine() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
    //把线型改成实线\r
    mxcad.drawLinetype = "";\r
    //设置线宽 4\r
    mxcad.drawLineWidth = 0;\r
  \r
  \r
    //创建一个图层,名为"LineLayer"\r
    mxcad.addLayer("LineLayer");\r
    //设置当前图层为"LineLayer"\r
    mxcad.drawLayer = "LineLayer";\r
    // 直接绘制一个实线\r
    // 参数一直线的开始点x坐标，参数二直线的开始点y坐标，参数三直线的结束点x坐标，参数四直线的结束点y坐标\r
    mxcad.drawLine(0, 0, 100, 0);\r
    // 绘制一个实斜线\r
    mxcad.drawLine(200, 0, 300, 100);\r
  \r
  \r
    //----------------------------------------------------------------------------------------------------------\r
    //绘制一个虚线\r
    //定义虚线数据据,"MyLineType"是线型名，"6,-8"是虚线的一个单位定义，6是实线长，-8是空格长。\r
    mxcad.addLinetype("MyLineType", "6,-10");\r
    //设计当前线型为"MyLineType"\r
    mxcad.drawLinetype = "MyLineType";\r
    // 绘制一个虚线\r
    mxcad.drawLine(0, 30, 100, 30);\r
    // 绘制一个斜虚线\r
    mxcad.drawLine(200, 30, 300, 130);\r
  \r
    //---------------------------------------------------------------------------------------------------------\r
    // 修改绘线的颜色为 16711680(蓝色),  16711680转成16进制是0xFF 00 00,其中，FF是蓝色，00是绿色，第个二00是红色。\r
    mxcad.drawColor = new McCmColor(0, 0, 255);\r
    // 绘制一个蓝色的虚线\r
  \r
    mxcad.drawLine(0, 60, 100, 60);\r
    // 绘制一个蓝色的斜虚线\r
    mxcad.drawLine(200, 60, 300, 160);\r
    //---------------------------------------------------------------------------------------------------------\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
    //把线型改成实线\r
    mxcad.drawLinetype = "";\r
    //设置线宽 4\r
    mxcad.drawLineWidth = 4;\r
    //绘制一个带宽度的直线。\r
    mxcad.drawLine(0, 90, 100, 90);\r
    // 绘制一个带宽度的斜线\r
    mxcad.drawLine(200, 90, 300, 190);\r
  \r
    //---------------------------------------------------------------------------------------------------------\r
    //绘制一个点划线虚线\r
    mxcad.addLinetype("MyLineType2", "10,-2,3,-2");\r
    //把线型改点划线\r
    mxcad.drawLinetype = "MyLineType2";\r
    // 修改绘线的颜色为 255(红色),  255转成16进制是0x00 00 FF,其中，00是蓝色，第个二00是绿色，FF是红色。\r
    mxcad.drawColor = new McCmColor(255, 0, 0);\r
    //绘制一个带宽度的红色点划线。\r
    mxcad.drawLine(0, 120, 100, 120);\r
    // 绘制一个带宽度红色点划斜线\r
    mxcad.drawLine(200, 120, 300, 220);\r
    //---------------------------------------------------------------------------------------------------------\r
    //增加一个带有形的线型\r
    mxcad.addTextStyle("MyLineTypeTextStyle", "txt.shx", "hztxt.shx", 1);\r
    mxcad.addLinetypeEx("MyLineType3", "(12.7,(\\"T=MxDraw\\",\\"S=2.54\\",\\"L=-5.08\\",\\"R=0.0\\",\\"X=-2.54\\",\\"Y=-1.27\\"),-10.08)", "MyLineTypeTextStyle");\r
    mxcad.drawLinetype = "MyLineType3";\r
    mxcad.drawLineWidth = 0;\r
    //绘制一个带宽度的红色点划线。\r
    mxcad.drawLine(350, 120, 600, 120);\r
    //---------------------------------------------------------------------------------------------------------\r
    //增加一个带有形的线型\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
    mxcad.drawLineWidth = 4;\r
    //绘制一个带宽度的红色点划线。\r
    mxcad.drawLine(350, 220, 600, 220);\r
  \r
    //把所有的实体都放到当前显示视区\r
    mxcad.zoomAll();\r
    //更新视区显示\r
    mxcad.updateDisplay();\r
  }\r
\r
  // 调用绘制多种线型直线的方法\r
  Mx_Test_DrawLine()`,hN=`import { MxCpp, McCmColor } from "mxcad";\r
\r
function Mx_Test_TrueText() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
    MxCpp.App.loadFonts([], [], ["syadobe", "simsun"], () => {\r
\r
        // 添加一个黑体文字样式\r
        mxcad.AddTureTypeTextStyle("ht_style", "syadobe");\r
\r
        // 添加一个宋体文字样式\r
        mxcad.AddTureTypeTextStyle("st_style", "simsun");\r
\r
        // 设置当前样式为黑体\r
        mxcad.drawTextStyle = "ht_style";\r
\r
        mxcad.drawColor = new McCmColor(200, 255, 50);\r
        mxcad.drawText(0, 3500, "绘图控件TrueType文字测试1", 100, 0, 0, 1);\r
\r
        // 设置当前样式为黑体\r
        mxcad.drawTextStyle = "st_style";\r
        mxcad.drawColor = new McCmColor(200, 100, 0);\r
        mxcad.drawText(0, 3200, "绘图控件TrueType文字测试2", 100, 0, 0, 1);\r
\r
        mxcad.zoomAll();\r
        mxcad.regen();\r
        mxcad.updateDisplay();\r
    });\r
};\r
\r
// 调用画多种文字样式的文字的方法\r
Mx_Test_TrueText()`,dN=`import { MxCADUiPrPoint, McDbPolyline, McDbArc, MxCpp } from "mxcad";

//画圆弧
async function Mx_drawArc() {
    // 根据起点，中点，端点三个点确定一段圆弧 
    // 获取起点
    let getFristPoint = new MxCADUiPrPoint();
    getFristPoint.setMessage('指定起点');
    let fristPoint = await getFristPoint.go();
    if (!fristPoint) return

    // 获取第二个点
    let getSecondPoint = new MxCADUiPrPoint();
    getSecondPoint.setMessage('指定圆弧的第二个点');
    //动态绘制取点对象
    getSecondPoint.setUserDraw((pt, pw) => {
        let pl = new McDbPolyline();
        pl.addVertexAt(fristPoint)
        pl.addVertexAt(pt);
        pw.drawMcDbEntity(pl)
    })
    let secondPoint = await getSecondPoint.go();
    if (!secondPoint) return;

    // 获取端点
    let getThirdPoint = new MxCADUiPrPoint();
    getThirdPoint.setMessage('指定圆弧的端点');
    //动态绘制圆弧
    getThirdPoint.setUserDraw((pt, pw) => {
        let arc = new McDbArc();
        arc.computeArc(fristPoint.x, fristPoint.y, secondPoint.x, secondPoint.y, pt.x, pt.y);//三点画圆弧
        pw.drawMcDbEntity(arc)
    });
    let thirdPoint = await getThirdPoint.go();
    if (!thirdPoint) return

    // 画圆弧
    let arc = new McDbArc();
    arc.computeArc(fristPoint.x, fristPoint.y, secondPoint.x, secondPoint.y, thirdPoint.x, thirdPoint.y);//三点画圆弧

    const mxcad = MxCpp.getCurrentMxCAD();
    mxcad.drawEntity(arc);
};

// 调用画圆弧的方法
Mx_drawArc();

`,fN=`import {MxCADUiPrPoint, McDbLine, MxCpp} from "mxcad";\r
\r
//画线\r
async function Mx_drawLine() {\r
    // 获取线段起点\r
    let getFristPoint = new MxCADUiPrPoint();\r
    getFristPoint.setMessage("请点击确定起始点");\r
    let fristPoint: any = await getFristPoint.go();\r
    if (!fristPoint) return\r
\r
    // 获取线段终点\r
    let getSecondPoint = new MxCADUiPrPoint();\r
    getSecondPoint.setMessage("请点击确定终点");\r
    getSecondPoint.setUserDraw((pt, pw) => {\r
        let line = new McDbLine(fristPoint.x, fristPoint.y, fristPoint.z, pt.x, pt.y, pt.z);\r
        pw.drawMcDbEntity(line)\r
    })\r
    let secondPoint: any = await getSecondPoint.go();\r
    if (!secondPoint) return\r
\r
    // 绘制线段\r
    let line = new McDbLine(fristPoint.x, fristPoint.y, fristPoint.z, secondPoint.x, secondPoint.y, secondPoint.z);\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    mxcad.drawEntity(line)\r
};\r
\r
// 调用画线的方法\r
\r
Mx_drawLine();`,pN=`import { McDbText, MxCADUiPrDist, MxCADUiPrPoint, MxCADUiPrString, MxCpp } from "mxcad";\r
\r
async function Mx_drawText() {\r
    // 创建文字对象\r
    const text = new McDbText();\r
\r
    // 设置文字内容\r
    const getStr = new MxCADUiPrString()\r
    getStr.setMessage("请输入文字内容")\r
    const str = await getStr.go()\r
    if (!str) return\r
    text.textString = str;\r
\r
    // 设置文字高度\r
    const getDist = new MxCADUiPrDist()\r
    getDist.setMessage("请输入文字高度")\r
    const height = await getDist.go()\r
    if (!height) return\r
    text.height = getDist.value();\r
\r
    // 设置文字高度\r
    const getPoint = new MxCADUiPrPoint()\r
    getPoint.setMessage("请点击确定文字位置")\r
    getPoint.setUserDraw((pt, pw) => {\r
        text.position = pt;\r
        text.alignmentPoint = pt;\r
        pw.drawMcDbEntity(text)\r
    })\r
    const position = await getPoint.go()\r
    if (!position) return\r
    text.position = position;\r
    text.alignmentPoint = position\r
\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    mxcad.drawEntity(text);\r
};\r
\r
// 调用绘制文字的方法\r
Mx_drawText();`,mN=`import {McDbCircle, MxCADUiPrDist, MxCADUiPrPoint, MxCpp} from "mxcad";\r
\r
// 画圆\r
async function Mx_drawCircle(){\r
    // 创建圆\r
    const circle = new McDbCircle();\r
\r
    // 获取圆心\r
    const getCenter = new MxCADUiPrPoint();\r
    getCenter.setMessage('请确定圆心位置\\n');\r
    const center = await getCenter.go();\r
    if (!center) return;\r
    circle.center = center;\r
\r
    // 获取圆半径\r
    const getRadius = new MxCADUiPrDist();\r
    getRadius.setBasePt(center);\r
    getRadius.setMessage('请输入圆半径');\r
    // 动态绘制圆\r
    getRadius.setUserDraw((pt, pw) => {\r
        const r = pt.distanceTo(center);\r
        circle.radius = r;\r
        pw.drawMcDbEntity(circle)\r
    })\r
    const radiusVal = await getRadius.go();\r
    if (!radiusVal) return;\r
    circle.radius = getRadius.value();\r
\r
    // 绘制圆\r
    const mxobj = MxCpp.getCurrentMxCAD();\r
    mxobj.drawEntity(circle);\r
};\r
\r
// 调用画圆的方法\r
Mx_drawCircle();`,gN=`import {MxCADUiPrPoint, MxCpp} from "mxcad";\r
\r
//画图片\r
async function Mx_drawImg() {\r
    // 设置图片插入点\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定插入点:");\r
    let pt = await getPoint.go();\r
    if (!pt) return;\r
   \r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    // 设置图片地址\r
    let imagUrl = "https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg";\r
    mxcad.loadImage(imagUrl,(image)=>{\r
        if(!image ){ \r
        console.log("loadImage failed");\r
        return;\r
        }\r
        // 设置图片宽高\r
        let width = mxcad.mxdraw.viewCoordLong2Cad(100);\r
        let height  = (image.height /  image.width) * width;\r
        mxcad.drawImage((pt as any).x,(pt as any).y,width,height,0,imagUrl,true,image.width,image.height);\r
        mxcad.updateDisplay();\r
    });\r
};\r
\r
// 调用画图片的方法\r
Mx_drawImg();`,yN=`import { MxCpp, MxCADUiPrPoint, McDbPolyline, MxCADUiPrDist, McGeVector3d, McGePoint3d, McDbArc, MxCADUtility, McDbLine, McDb} from "mxcad";\r
\r
// 画多段线\r
async function Mx_drawPolyline() {\r
    // 获取画布实例\r
    const mxcad = MxCpp.App.getCurrentMxCAD();\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定起点:");\r
    let firstPoint = await getPoint.go();\r
    if (!firstPoint) return;\r
    let pointArr: any[] = [];\r
    let drawObjIds: any[] = [];\r
    let isArc: boolean = false;\r
    let dStartWidth: number = 0;\r
    let dEndWidth: number = 0;\r
    pointArr.push({ pt: firstPoint, dBulge: 0, dStartWidth, dEndWidth })\r
    let isAutoClose: boolean = false;\r
    let isReverse: boolean = false;//圆弧方向是否取反\r
    let arcDirection: any = null //指定圆弧切向\r
    while (true) {\r
        if (!isArc) {\r
            //绘直线\r
            const getNextPoint = new MxCADUiPrPoint;\r
            getNextPoint.setMessage("\\n指定下一个点");\r
            // 提示消息\r
            if (pointArr.length < 2) {\r
                getNextPoint.setKeyWords('[圆弧(A)/宽度(W)]')\r
            } else {\r
                getNextPoint.setKeyWords('[放弃(U)/圆弧(A)/宽度(W)/闭合(C)]')\r
            }\r
            let lastPoint = pointArr[pointArr.length - 1];//鼠标点击的最后一个点\r
            // 等待鼠标点击期间会执行setUserDraw动态绘制函数中的回调函数\r
            getNextPoint.setUserDraw((pt, pw) => {\r
                // pt 就是鼠标所在图纸位置的坐标\r
                // pw 是提供了一些动态绘制方法的对象\r
                let pl = new McDbPolyline();\r
                pl.addVertexAt(lastPoint.pt, lastPoint.dBulge, lastPoint.dStartWidth, lastPoint.dEndWidth)\r
                pl.addVertexAt(pt, 0, dStartWidth, dEndWidth);\r
                pw.drawMcDbEntity(pl);\r
            })\r
            let nextPoint = await getNextPoint.go();\r
            if (nextPoint !== null) {\r
                // 获取到了鼠标点击点\r
                pointArr.push({ pt: nextPoint, dBulge: 0, dStartWidth, dEndWidth });\r
                let pl = new McDbPolyline();\r
                pl.addVertexAt(lastPoint.pt, lastPoint.dBulge, lastPoint.dStartWidth, lastPoint.dEndWidth);\r
                pl.addVertexAt(nextPoint, 0, dStartWidth, dEndWidth);\r
                drawObjIds.push(mxcad.drawEntity(pl))\r
            } else if (getNextPoint.getStatus() === Mx.MrxDbgUiPrBaseReturn.kKeyWord) {\r
                // 用户输入关键字\r
                let keyWord = getNextPoint.keyWordPicked()\r
                if (keyWord === 'A') {\r
                    // 绘制圆弧\r
                    isArc = true;\r
                } else if (keyWord === 'W') {\r
                    // 设置宽度\r
                    /**\r
                     * 输入空格宽度不变\r
                     */\r
                    let getWidth = new MxCADUiPrDist();\r
                    getWidth.setMessage('指定起点宽度:');\r
                    // 获取线宽\r
                    let dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dStartWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dStartWidth = dStartWidth;\r
                    }\r
                    getWidth.setMessage('指定端点宽度');\r
                    dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dEndWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dEndWidth = dEndWidth;\r
                    }\r
                } else if (keyWord === 'U') {\r
                    // 回退操作\r
                    if (pointArr.length > 1 && drawObjIds.length > 1) {\r
                        pointArr.pop();\r
                        drawObjIds[drawObjIds.length - 1].erase();\r
                        drawObjIds.pop();\r
                    }\r
                } else if (keyWord === 'C') {\r
                    isAutoClose = true;\r
                    break;\r
                }\r
            } else {\r
                break;\r
            }\r
        } else {\r
            // 绘制圆弧\r
            let getNextPoint = new MxCADUiPrPoint();\r
            getNextPoint.setMessage('指定圆弧的端点(按住 ctrl 键取相反方向)\\n');\r
            getNextPoint.setKeyWords('[第二个点(S)/角度(A)/圆心(CE)/放弃(U)/直线(L)/宽度(W)/闭合(CL)]');\r
            // 计算圆弧的切向量.\r
            let vecArcTangent = new McGeVector3d();\r
            // 开端的圆弧切向量取水平方向./获取圆弧切向\r
            if (pointArr.length < 2) {\r
                // 开端的圆弧切向量取水平方向.\r
                vecArcTangent.copy(McGeVector3d.kYAxis);\r
            } else {\r
                let length = pointArr.length;\r
                let p1 = pointArr[length - 2].pt;\r
                let dBulge = pointArr[length - 2].dBulge;\r
                let p2 = pointArr[length - 1].pt;\r
                if (dBulge === 0) {\r
                    // 前一段是个直线.\r
                    vecArcTangent = new McGePoint3d(p2.x, p2.y, 0.0).sub(new McGePoint3d(p1.x, p1.y, 0.0));\r
                }\r
                else {\r
                    // 前一段为曲线，求圆弧的切向量\r
                    let tmpPl = new McDbPolyline;\r
                    tmpPl.addVertexAt(p1, dBulge);\r
                    tmpPl.addVertexAt(p2);\r
                    let tmpVec = tmpPl.getFirstDeriv(new McGePoint3d(p2.x, p2.y, 0.0));//曲线上任意一点的切向量\r
                    if (tmpVec.ret) {\r
                        vecArcTangent = tmpVec.val;\r
                    }\r
                    else {\r
                        vecArcTangent.copy(McGeVector3d.kXAxis);\r
                    }\r
                }\r
            }\r
            let lastPoint = pointArr[pointArr.length - 1];\r
            //监听ctrl键是否被按下\r
            document.addEventListener('keydown', function (event) {\r
                if (event.ctrlKey && event.keyCode === 17) {\r
                    isReverse = true;\r
                }\r
            });\r
            // ctrl键松开\r
            document.addEventListener('keyup', function () {\r
                isReverse = false;\r
            });\r
            getNextPoint.setUserDraw((pt, pw) => {\r
                let pl = new McDbPolyline();\r
                let d = CMxDrawPolylineDragArcDraw_CalcArcBulge(lastPoint.pt, pt, arcDirection ? arcDirection : vecArcTangent);\r
                if (isReverse) d = -d;\r
                pl.addVertexAt(lastPoint.pt, d, lastPoint.dStartWidth, lastPoint.dEndWidth);\r
                pl.addVertexAt(pt, 0, dStartWidth, dEndWidth);\r
                pw.drawMcDbEntity(pl);\r
            })\r
            let nextPoint = await getNextPoint.go();\r
            if (nextPoint != null) {\r
                let dBulge = CMxDrawPolylineDragArcDraw_CalcArcBulge(lastPoint.pt, nextPoint, arcDirection ? arcDirection : vecArcTangent);\r
                if (isReverse) dBulge = -dBulge;\r
                lastPoint.dBulge = dBulge;\r
                pointArr.push({ pt: nextPoint, dBulge: 0, dStartWidth, dEndWidth });\r
                let pl = new McDbPolyline();\r
                pl.addVertexAt(lastPoint.pt, dBulge, lastPoint.dStartWidth, lastPoint.dEndWidth);\r
                pl.addVertexAt(nextPoint, 0, dStartWidth, dEndWidth);\r
                drawObjIds.push(mxcad.drawEntity(pl));\r
            } else if (getNextPoint.getStatus() === Mx.MrxDbgUiPrBaseReturn.kKeyWord) {\r
                // 获取用户输入关键字\r
                let keyWord = getNextPoint.keyWordPicked();\r
                if (keyWord === 'L') {\r
                    // 变直线\r
                    isArc = false;\r
                } else if (keyWord === 'U') {\r
                    // 回退\r
                    if (pointArr.length > 1 && drawObjIds.length > 1) {\r
                        pointArr.pop();\r
                        drawObjIds[drawObjIds.length - 1].erase();\r
                        drawObjIds.pop();\r
                    }\r
                } else if (keyWord === 'S') {\r
                    // 用户指定圆弧的第二个点\r
                    let getPoint2 = new MxCADUiPrPoint();//用户输入的指定点\r
                    getPoint2.setMessage("指定圆弧的第二个点");\r
                    let pt2: any = await getPoint2.go();\r
                    if (pt2 === null) return\r
                    let getPoint3 = new MxCADUiPrPoint();\r
                    getPoint3.setMessage("指定圆弧的端点");\r
                    let lastPoint = pointArr[pointArr.length - 1]\r
                    getPoint3.setUserDraw((pt, pw) => {\r
                        let arc = new McDbArc();\r
                        arc.computeArc(lastPoint.pt.x, lastPoint.pt.y, pt2.x, pt2.y, pt.x, pt.y);//三点绘制圆弧\r
                        pw.drawMcDbEntity(arc);\r
                    });\r
                    let pt3 = await getPoint3.go();\r
                    if (!pt3) break;\r
                    let retB = MxCADUtility.calcBulge(lastPoint.pt, pt2, pt3);//开始点,中点，结束点 三点计算当前弧线的凸度\r
                    if (!retB.ret) break;\r
                    pointArr[pointArr.length - 1] = retB.val;\r
                    pointArr.push({ pt: pt3, dBulge: 0, dStartWidth, dEndWidth });//最后一个点\r
                    let pl = new McDbPolyline();\r
                    pl.addVertexAt(lastPoint.pt, retB.val, dStartWidth, dEndWidth);\r
                    pl.addVertexAt(pt3);\r
                    drawObjIds.push(mxcad.drawEntity(pl));\r
                } else if (keyWord === 'W') {\r
                    // 设置宽度\r
                    let getWidth = new MxCADUiPrDist();\r
                    getWidth.setMessage('指定起点宽度:');\r
                    // 获取线宽\r
                    let dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dStartWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dStartWidth = dStartWidth;\r
                    }\r
                    getWidth.setMessage('指定端点宽度');\r
                    dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dEndWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dEndWidth = dEndWidth;\r
                    }\r
                } else if (keyWord === 'D') {\r
                    // 指定圆弧切向\r
                    let getDirection = new MxCADUiPrPoint();\r
                    getDirection.setMessage('指定圆弧起点的切向:');\r
                    let dirVal = await getDirection.go();\r
                    if (dirVal === null) break;\r
                    arcDirection = new McGeVector3d(dirVal.x, dirVal.y, dirVal.z)\r
                } else if (keyWord === 'CE') {\r
                    // 确定圆心\r
                    let getCenter = new MxCADUiPrPoint();\r
                    getCenter.setMessage('指定圆弧的圆心:');\r
                    let arcCenter: any = await getCenter.go();\r
                    if (!arcCenter) return;\r
                    // 起始角度：起点与圆心的连线与X轴正方向的夹角\r
                    // 结束角度：结束点与圆心的连线与X轴正方向的夹角\r
                    let getNextPoint = new MxCADUiPrPoint();\r
                    let lastPoint = pointArr[pointArr.length - 1];\r
                    let r: number = 0;//圆弧凸度\r
                    let arc = new McDbArc();//圆弧\r
                    // 开端的圆弧切向量取水平方向./获取圆弧切向\r
                    getNextPoint.setUserDraw(async (pt, pw) => {\r
                        // 起始角度\r
                        arc.startAngle = lastPoint.pt.sub(arcCenter).angleTo1(new McGeVector3d(arcCenter.x, 0, 0))//始终不变\r
                        arc.endAngle = pt.sub(arcCenter).angleTo1(new McGeVector3d(arcCenter.x, 0, 0))\r
                        arc.center = arcCenter;\r
                        arc.radius = arcCenter.distanceTo(lastPoint.pt);\r
                        if (pt.y < arcCenter.y) arc.endAngle = -arc.endAngle;\r
                        // // 获取圆弧上的第三个点\r
                        let lineX = new McDbPolyline();\r
                        lineX.addVertexAt(new McGePoint3d(arcCenter.x, 0, 0));\r
                        lineX.addVertexAt(new McGePoint3d(0, 0, 0));\r
                        let pointsX = arc.IntersectWith(lineX, 3);//X轴交点\r
                        // 获取凸度\r
                        let rLine = new McDbPolyline();\r
                        rLine.addVertexAt(arcCenter);\r
                        rLine.addVertexAt(pt);\r
                        let currentPoint = arc.IntersectWith(rLine, 2);//当前线段与圆弧的交点\r
                        let cp: any = null;\r
                        if (currentPoint.length() === 1) {\r
                            cp = currentPoint.at(0);\r
                        } else {\r
                            if (pt.distanceTo(currentPoint.at(0)) <= pt.distanceTo(currentPoint.at(1))) {\r
                                cp = currentPoint.at(0);\r
                            } else {\r
                                cp = currentPoint.at(1);\r
                            }\r
                        }\r
                        let retB = MxCADUtility.calcBulge(lastPoint.pt, pointsX.at(0), cp);\r
                        if (retB.ret) {\r
                            r = retB.val;\r
                            let pl = new McDbPolyline()\r
                            pl.addVertexAt(lastPoint.pt, r);\r
                            pl.addVertexAt(cp);\r
                            pw.drawMcDbEntity(pl)\r
                        }\r
                    })\r
                    let nextPoint = await getNextPoint.go();\r
                    if (!nextPoint) break;\r
                    // 获取凸度\r
                    let rLine = new McDbPolyline();\r
                    rLine.addVertexAt(arcCenter);\r
                    rLine.addVertexAt(nextPoint);\r
                    let currentPoint = arc.IntersectWith(rLine, 2);\r
                    let cp: any = null;\r
                    if (currentPoint.length() === 1) {\r
                        cp = currentPoint.at(0);\r
                    } else {\r
                        if (nextPoint.distanceTo(currentPoint.at(0)) <= nextPoint.distanceTo(currentPoint.at(1))) {\r
                            cp = currentPoint.at(0);\r
                        } else {\r
                            cp = currentPoint.at(1);\r
                        }\r
                    }\r
                    let pl = new McDbPolyline()\r
                    pl.addVertexAt(lastPoint.pt, r, dStartWidth, dEndWidth);\r
                    pl.addVertexAt(cp);\r
                    pointArr[pointArr.length - 1].dBulge = r;\r
                    pointArr.push({ pt: cp, dBulge: 0, dStartWidth, dEndWidth })\r
                    drawObjIds.push(mxcad.drawEntity(pl));\r
\r
                } else if (keyWord === 'CL') {\r
                    // 闭合\r
                    isAutoClose = true;\r
                    break;\r
                }\r
            } else {\r
                break;\r
            }\r
\r
        }\r
    }\r
    // 删除监听事件\r
    document.removeEventListener('keydown', () => isReverse = false)\r
    document.removeEventListener('keyup', () => isReverse = false)\r
    // 最终绘制\r
    /**\r
     * 先删除所有临时对象再重新绘制多边形\r
     */\r
    for (let i = 0; i < drawObjIds.length; i++) {\r
        drawObjIds[i].erase();\r
    }\r
    if (pointArr.length > 1) {\r
        let pl = new McDbPolyline();\r
        pointArr.forEach(item => {\r
            pl.addVertexAt(item.pt, item.dBulge, item.dStartWidth, item.dEndWidth)\r
        })\r
        pl.isClosed = isAutoClose;\r
        mxcad.drawEntity(pl);\r
    }\r
}\r
\r
// 计算圆弧凸度\r
function CMxDrawPolylineDragArcDraw_CalcArcBulge(firstPoint, nextPoint, vecArcTangent): number {\r
    if (firstPoint.isEqualTo(nextPoint))\r
        return 0.0;\r
    let midPt = firstPoint.c().addvec(nextPoint.c().sub(firstPoint).mult(0.5));\r
\r
    let vecMid = nextPoint.c().sub(firstPoint);\r
    vecMid.rotateBy(Math.PI / 2.0, McGeVector3d.kZAxis);\r
\r
    let tmpMidLine = new McDbLine(midPt, midPt.c().addvec(vecMid));\r
\r
    let vecVertical = vecArcTangent.c();\r
    vecVertical.rotateBy(Math.PI / 2.0, McGeVector3d.kZAxis);\r
\r
    let tmpVerticalLine = new McDbLine(firstPoint, firstPoint.c().addvec(vecVertical));\r
\r
    let aryPoint = tmpMidLine.IntersectWith(tmpVerticalLine, McDb.Intersect.kExtendBoth);\r
    if (aryPoint.isEmpty())\r
        return 0.0;\r
\r
    let arcCenPoint = aryPoint.at(0);\r
\r
    let dR = arcCenPoint.distanceTo(firstPoint);\r
\r
    vecMid.normalize();\r
    vecMid.mult(dR);\r
\r
    let arcMidPt1 = arcCenPoint.c().addvec(vecMid);\r
    let arcMidPt2 = arcCenPoint.c().subvec(vecMid);\r
    let vecArcDir1 = arcMidPt1.c().sub(firstPoint);\r
    let vecArcDir2 = arcMidPt2.c().sub(firstPoint);\r
    let arcMidPt = arcMidPt1;\r
    if (vecArcDir1.angleTo1(vecArcTangent) > vecArcDir2.angleTo1(vecArcTangent)) {\r
        arcMidPt = arcMidPt2;\r
    }\r
    return MxCADUtility.calcBulge(firstPoint, arcMidPt, nextPoint).val;\r
}\r
\r
// 调用画多段线的方法\r
Mx_drawPolyline();`,bN=`import { McDbEllipse,MxCADUiPrPoint, McDbLine, McGePoint3d, MxCADUiPrDist, MxCpp } from "mxcad";\r
\r
// 绘制椭圆\r
async function drawMxDbEllipse() {\r
 \r
    // 创建椭圆对象\r
    const ellipse = new McDbEllipse();\r
    \r
    // 指定椭圆的轴端点\r
    const getPt1 = new MxCADUiPrPoint();\r
    getPt1.setMessage("\\n指定椭圆的轴端点:");\r
    const pt1 = await getPt1.go();\r
    if (!pt1) return;\r
\r
    // 指定椭圆轴的另一个端点\r
    const getPt2 = new MxCADUiPrPoint();\r
    getPt2.setMessage("\\n指定椭圆轴的另一个端点:");\r
    getPt2.setUserDraw((pt, pw) => {\r
        const line = new McDbLine(pt, pt1);\r
        pw.drawMcDbEntity(line);\r
    })\r
    const pt2 = await getPt2.go();\r
    if (!pt2) return;\r
\r
    // 获取椭圆中心点\r
    const center = new McGePoint3d((pt1.x + pt2.x) / 2, (pt1.y + pt2.y) / 2);\r
    ellipse.center = center;\r
    ellipse.majorAxis = pt1.sub(pt2);\r
    const xRadius = pt1.distanceTo(pt2) / 2\r
\r
    // 指定另一条半轴长度\r
    const getDist = new MxCADUiPrDist();\r
    getDist.setMessage("指定另一条半轴长度")\r
    getDist.setBasePt(center)\r
    getDist.setUserDraw((pt, pw) => {\r
        const yRadius = center.distanceTo(pt) / 2\r
        // 设置椭圆的副轴长度与主轴长度的比值\r
        ellipse.radiusRatio = yRadius / xRadius\r
        pw.drawMcDbEntity(ellipse)\r
    })\r
    let length = await getDist.go()\r
    if (!length) return\r
    if (getDist.getDetailedResult() === Mx.DetailedResult.kCoordIn) {\r
        const yRadius = length / 2\r
        ellipse.radiusRatio = yRadius / xRadius\r
    }\r
    MxCpp.getCurrentMxCAD().drawEntity(ellipse)\r
};\r
\r
// 调用绘制椭圆的方法\r
drawMxDbEllipse();`,vN=`import { MxCADUiPrPoint, MxCADUtility, MxCpp } from "mxcad";\r
\r
// 选点填充\r
async function MxTest_DrawHatchFormPoint() {\r
    // 指定填充区域内部一点\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定填充区域内部一点:");\r
    getPoint.disableAllTrace(true);\r
    getPoint.setDisableOsnap(true);\r
    let pt = await getPoint.go();\r
    if (!pt) return;\r
    \r
    // 绘制填充\r
    let hatch = MxCADUtility.builderHatchFromPoint(pt);\r
    if (!hatch) {\r
        Mx.MxFun.acutPrintf("没有找到闭合区域\\n")\r
        return;\r
    }\r
\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    mxcad.drawEntity(hatch);\r
};\r
\r
// 调用选点填充的方法\r
MxTest_DrawHatchFormPoint();`,xN=`import { McDbBlockReference, MxCADUiPrPoint, MxCpp } from "mxcad";\r
\r
function getHostUrl(): string {\r
    let host = window.location.hostname;\r
    if (host.substring(0, 4) != "http") {\r
        host = document.location.protocol + "//" + host;\r
    }\r
    return host;\r
}\r
\r
// 插入图块\r
async function MxTest_InsertBlock() {\r
    let baseUrl = "http://localhost:3000/mxcad/"\r
    if (baseUrl.substring(0, 16) == "http://localhost") {\r
      baseUrl = getHostUrl() + baseUrl.substring(16);\r
    }\r
    // 设置图块路径\r
    let blkFilePath = baseUrl + "tree.mxweb";\r
\r
    // 插入图块文件\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
    let blkrecId = await mxcad.insertBlock(blkFilePath, "tree");\r
    if (!blkrecId.isValid()) {\r
        // 插入图块\r
        return;\r
    }\r
\r
    // 设置图块大小\r
    let blkRef = new McDbBlockReference();\r
    blkRef.blockTableRecordId = blkrecId;\r
    let box = blkRef.getBoundingBox();\r
    if (box.ret) {\r
        let dLen = box.maxPt.distanceTo(box.minPt);\r
        if (dLen > 0.00001) {\r
            blkRef.setScale(mxcad.getMxDrawObject().screenCoordLong2Doc(100) / dLen);\r
        }\r
    }\r
\r
    // 指定插入基点\r
    let getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\指定插入基点");\r
\r
    // 动态绘制图块\r
    getPoint.setUserDraw((v, worldDraw) => {\r
        blkRef.position = v;\r
        worldDraw.drawMcDbEntity(blkRef);\r
    });\r
\r
    let pt = await getPoint.go();\r
    if (!pt) return;\r
    blkRef.position = pt;\r
    // 绘制图块\r
    let newBlkRefId = mxcad.drawEntity(blkRef);\r
    if (!newBlkRefId.isValid) {\r
        console.log("insert error");\r
        return;\r
    }\r
};\r
\r
// 调用插入图块方法\r
MxTest_InsertBlock();`,_N=`import { IMcDbDwgFiler, McDb, McDbCustomEntity, McDbEntity, McDbMText, McDbPolyline, McDbText, McGePoint3d, McGePoint3dArray, MxCADUiPrPoint, MxCADUtility, MxCADWorldDraw, MxCpp } from "mxcad";\r
\r
// 新创建 McDbTestLineCustomEntity 类继承 McDbCustomEntity\r
class McDbTestRectangle extends McDbCustomEntity {\r
    // 定义McDbTestLineCustomEntity内部的点对象 \r
    // 矩形角点pt1、pt2\r
    private pt1: McGePoint3d = new McGePoint3d();\r
    private pt2: McGePoint3d = new McGePoint3d();\r
    /** 包围盒最大点 包围盒最小点 */\r
    private minPt: McGePoint3d = new McGePoint3d();\r
    private maxPt: McGePoint3d = new McGePoint3d();\r
    // 构造函数\r
    constructor(imp?: any) {\r
        super(imp);\r
    }\r
    // 创建函数\r
    public create(imp: any) {\r
        return new McDbTestRectangle(imp)\r
    }\r
    // 获取类名\r
    public getTypeName(): string {\r
        return "McDbTestRectangle";\r
    }\r
    // 读取自定义实体数据pt1、pt2\r
    public dwgInFields(filter: IMcDbDwgFiler): boolean {\r
        this.pt1 = filter.readPoint("pt1").val;\r
        this.pt2 = filter.readPoint("pt2").val;\r
        this.minPt = filter.readPoint("minPt").val;\r
        this.maxPt = filter.readPoint("maxPt").val;\r
        return true;\r
    }\r
    // 写入自定义实体数据pt1、pt2\r
    public dwgOutFields(filter: IMcDbDwgFiler): boolean {\r
        filter.writePoint("pt1", this.pt1);\r
        filter.writePoint("pt2", this.pt2);\r
        filter.writePoint("minPt", this.minPt);\r
        filter.writePoint("maxPt", this.maxPt);\r
        return true;\r
    }\r
\r
    // 移动自定义对象的夹点\r
    public moveGripPointsAt(iIndex: number, dXOffset: number, dYOffset: number, dZOffset: number) {\r
        this.assertWrite();\r
        if (iIndex == 0) {\r
            this.pt1.x += dXOffset;\r
            this.pt1.y += dYOffset;\r
            this.pt1.z += dZOffset;\r
        }\r
        else if (iIndex == 1) {\r
            this.pt2.x += dXOffset;\r
            this.pt2.y += dYOffset;\r
            this.pt2.z += dZOffset;\r
        }\r
    };\r
    // 获取自定义对象的夹点\r
    public getGripPoints(): McGePoint3dArray {\r
        let ret = new McGePoint3dArray()\r
        ret.append(this.pt1);\r
        ret.append(this.pt2);\r
        return ret;\r
    };\r
    // 绘制实体\r
    public worldDraw(draw: MxCADWorldDraw): void {\r
        const allEntityArr: McDbEntity[] = [];\r
\r
        const pl = new McDbPolyline();\r
        pl.isClosed = true;\r
        pl.addVertexAt(this.pt1);\r
        pl.addVertexAt(new McGePoint3d(this.pt2.x, this.pt1.y));\r
        pl.addVertexAt(this.pt2);\r
        pl.addVertexAt(new McGePoint3d(this.pt1.x, this.pt2.y));\r
        draw.drawEntity(pl);\r
        allEntityArr.push(pl)\r
\r
        this.getBox(allEntityArr);\r
    }\r
    private getBox(entityArr: McDbEntity[]) {\r
        const mxcad = MxCpp.getCurrentMxCAD();\r
        let _minPt, _maxPt = null;\r
        let result;\r
        entityArr.forEach(entity => {\r
            if (entity instanceof McDbText) {\r
                const ent = new McDbMText()\r
                ent.contents = entity.textString;\r
                ent.textHeight = entity.height;\r
                ent.location = entity.position;\r
                switch (entity.horizontalMode) {\r
                    case McDb.TextHorzMode.kTextLeft:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                    case McDb.TextHorzMode.kTextCenter:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    case McDb.TextHorzMode.kTextRight:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomRight;\r
                        break;\r
                    case McDb.TextHorzMode.kTextMid:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    default:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                }\r
                // 将ent的文字样式设置为当前文字样式\r
                const textStyleId = mxcad.getDatabase().getCurrentlyTextStyleId();\r
                ent.textStyleId = textStyleId;\r
                ent.reCompute();\r
                result = MxCADUtility.getTextEntityBox(ent, false);\r
            } else if (entity instanceof McDbMText) {\r
                entity.reCompute();\r
                result = MxCADUtility.getTextEntityBox(entity, false);\r
            } else {\r
                result = entity.getBoundingBox();\r
            }\r
            const { minPt, maxPt, ret } = result;\r
            if (!_minPt) _minPt = minPt.clone();\r
            if (!_maxPt) _maxPt = maxPt.clone();\r
            if (minPt.x < _minPt.x) _minPt.x = minPt.x;\r
            if (minPt.y < _minPt.y) _minPt.y = minPt.y;\r
            if (maxPt.x > _maxPt.x) _maxPt.x = maxPt.x;\r
            if (maxPt.y > _maxPt.y) _maxPt.y = maxPt.y;\r
        });\r
        if (_minPt && _maxPt) {\r
            this.maxPt = _maxPt;\r
            this.minPt = _minPt\r
        }\r
    }\r
    // 设置pt1\r
    public setPoint1(pt1: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt1 = pt1.clone();\r
    }\r
    // 设置pt2\r
    public setPoint2(pt2: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt2 = pt2.clone();\r
    }\r
    // 获取pt1\r
    public getPoint1() {\r
        return this.pt1;\r
    }\r
    // 获取pt2\r
    public getPoint2() {\r
        return this.pt2;\r
    }\r
    // 获取包围盒\r
    public getBoundingBox(): { minPt: McGePoint3d; maxPt: McGePoint3d; ret: boolean; } {\r
        return { minPt: this.minPt, maxPt: this.maxPt, ret: true }\r
    }\r
}\r
\r
\r
async function MxTest_DrawCustomEntity() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定第一个角点:");\r
    let pt1 = await getPoint.go();\r
    if (!pt1) return;\r
    const myRect = new McDbTestRectangle();\r
    myRect.setPoint1(pt1);\r
\r
    getPoint.setMessage("\\n指定第二个角点:");\r
    getPoint.setUserDraw((pt, pw) => {\r
        myRect.setPoint2(pt);\r
        pw.drawMcDbEntity(myRect);\r
    })\r
    let pt2 = await getPoint.go();\r
    if (!pt2) return;\r
\r
    myRect.setPoint2(pt2);\r
    mxcad.drawEntity(myRect);\r
}\r
\r
// 注册自定义实体\r
new McDbTestRectangle().rxInit();\r
// 调用方法绘制自定义实体\r
MxTest_DrawCustomEntity();\r
`,wN=`import { McDbAlignedDimension, McDbArc, McDbBlockReference, McDbCircle, McDbDimension, McDbHatch, McDbLine, McDbMText, McDbPolyline, McDbRasterImage, McDbRotatedDimension, McDbText, MxCADSelectionSet } from "mxcad";\r
\r
\r
// 点对象转字符串\r
function McGePoint3dToString(pt): string {\r
    return "x=" + pt.x + ",y=" + pt.y + ",z=" + pt.z;\r
}\r
\r
// 实体对象转json对象\r
function McDbEntityToJsonObject(ent): object {\r
    let obj: any = {}\r
    obj.ObjectName = ent.objectName;// 对象名\r
    obj.id = ent.getObjectID().id;// 对象id\r
    obj.handle = ent.getHandle(); // 对象句柄\r
    obj.layer = ent.layer; // 对象所在图层\r
    obj.color = ent.trueColor.getColorString(); // 对象颜色说明字符串\r
    obj.colorVal = ent.trueColor.getColorValue(ent.layerId); // 对象颜色字符串\r
    obj.linetype = ent.linetype; // 对象线型\r
    obj.textStyle = ent.textStyle; // 对象文字样式\r
    obj.dxf0 = ent.dxf0;// 得到对象的DXF组码的类型名\r
\r
    if (ent instanceof McDbText) {\r
        // 文字对象\r
        let txt = ent as McDbText;\r
        obj.position = McGePoint3dToString(txt.position);\r
        obj.textString = txt.textString;\r
    }\r
    else if (ent instanceof McDbMText) {\r
        // 多行文字对象\r
        let mtxt = ent as McDbMText;\r
        obj.contents = mtxt.contents;\r
        obj.location = McGePoint3dToString(mtxt.location);\r
    }\r
    else if (ent instanceof McDbLine) {\r
        // 直线对象\r
        let line = ent as McDbLine;\r
        obj.startPoint = McGePoint3dToString(line.startPoint);\r
        obj.endPoint = McGePoint3dToString(line.endPoint);\r
    }\r
    else if (ent instanceof McDbCircle) {\r
        // 圆对象\r
        let circle = ent as McDbCircle;\r
        obj.center = McGePoint3dToString(circle.center);\r
        obj.radius = circle.radius;\r
    }\r
    else if (ent instanceof McDbArc) {\r
        // 圆弧对象\r
        let arc = ent as McDbArc;\r
        obj.center = McGePoint3dToString(arc.center);\r
        obj.startAngle = arc.startAngle;\r
        obj.endAngle = arc.endAngle;\r
    }\r
    else if (ent instanceof McDbPolyline) {\r
        // 多段线对象\r
        let polyline = ent as McDbPolyline;\r
        let num = polyline.numVerts();\r
        obj.num = num;\r
        for (let i = 0; i < num; i++) {\r
            let pt = polyline.getPointAt(i);\r
            let bulge = polyline.getBulgeAt(i);\r
            obj["pt" + i] = McGePoint3dToString(pt.val);\r
            obj["bulge" + i] = bulge;\r
        }\r
    }\r
    else if (ent instanceof McDbBlockReference) {\r
        // 块引用对象\r
        let blkRef = ent as McDbBlockReference;\r
        obj.position = McGePoint3dToString(blkRef.position);\r
        obj.blockTransform = blkRef.blockTransform;\r
        obj.blockName = blkRef.blockName;\r
    }\r
    else if (ent instanceof McDbAlignedDimension) {\r
        // 对齐标注对象\r
        let alignedDim = ent as McDbAlignedDimension;\r
        obj.xLine1Point = McGePoint3dToString(alignedDim.xLine1Point);\r
        obj.xLine2Point = McGePoint3dToString(alignedDim.xLine2Point);\r
        let txts = alignedDim.GetAllText();\r
        txts.forEach((val, index) => {\r
            obj["txt:" + index] = val;\r
        });\r
    }\r
    else if (ent instanceof McDbRotatedDimension) {\r
        // 旋转标注对象\r
        let rotatedDim = ent as McDbRotatedDimension;\r
        obj.xLine1Point = McGePoint3dToString(rotatedDim.xLine1Point);\r
        obj.xLine2Point = McGePoint3dToString(rotatedDim.xLine2Point);\r
        let txts = rotatedDim.GetAllText();\r
        txts.forEach((val, index) => {\r
            obj["txt:" + index] = val;\r
        });\r
    }\r
    else if (ent instanceof McDbDimension) {\r
        // 标注对象\r
        let dim = ent as McDbDimension;\r
        let txts = dim.GetAllText();\r
        txts.forEach((val, index) => {\r
            obj["txt:" + index] = val;\r
        });\r
    }\r
    else if (ent instanceof McDbHatch) {\r
        // 填充对象\r
        let hatch = ent as McDbHatch;\r
        obj.patternType = hatch.patternType();\r
        obj.patternName = hatch.patternName();\r
        obj.patternAngle = hatch.patternAngle;\r
        obj.patternScale = hatch.patternScale;\r
        obj.patternSpace = hatch.patternSpace;\r
        obj.patternDouble = hatch.patternDouble;\r
        obj.hatchStyle = hatch.hatchStyle();\r
        obj.isSolid = hatch.isSolid();\r
        obj.numLoops = hatch.numLoops;\r
        for (let i = 0; i < obj.numLoops; i++) {\r
            let loop: any = hatch.getLoopAt(i);\r
            loop.vertices.forEach((val: any, inidex: number) => {\r
                loop["pt:" + inidex] = {};\r
                loop["pt:" + inidex].x = val.x;\r
                loop["pt:" + inidex].y = val.y;\r
                loop["pt:" + inidex].z = val.z;\r
            })\r
            obj["loop:" + i] = loop;\r
        };\r
        obj.numPatternDefinitions = hatch.numPatternDefinitions;\r
        for (let i = 0; i < obj.numPatternDefinitions; i++) {\r
            obj["patternDefinitions:" + i] = hatch.getPatternDefinitionAt(i);\r
        };\r
    }\r
    else if (ent instanceof McDbRasterImage) {\r
        // 位图对象\r
        let image = ent as McDbRasterImage;\r
        let orientation = image.getOrientation();\r
        obj.orientation = {};\r
        obj.orientation.origin = orientation.origin.toVector3();\r
        obj.orientation.uCorner = orientation.uCorner.toVector3();\r
        obj.orientation.vOnPlane = orientation.vOnPlane.toVector3();\r
\r
        let clipBoundary = image.clipBoundary();\r
        obj.clipBoundary = {};\r
        clipBoundary.forEach((pt, index) => {\r
            obj.clipBoundary["pt" + index] = pt.toVector3();\r
        });\r
\r
        obj.clipBoundaryType = image.clipBoundaryType();\r
\r
        let imageDef = image.imageDefId().getMcDbRasterImageDef();\r
        if (imageDef) {\r
            obj.filePath = imageDef.sourceFileName;\r
        }\r
    }\r
\r
    return obj;\r
}\r
// 得到图纸所有对象\r
async function TestGetAllEntity() {\r
\r
    let ss = new MxCADSelectionSet();\r
    ss.allSelect();\r
    ss.forEach((id) => {\r
        let ent: any = id.getMcDbEntity();\r
        if (!ent) return;\r
        ent = McDbEntityToJsonObject(ent);\r
        console.log(JSON.stringify(ent));\r
    })\r
};\r
\r
// 调用得到图纸所有对象的方法\r
TestGetAllEntity()`,MN=`import { McDbLayerTableRecord, MxCpp } from "mxcad";\r
\r
// 添加图层\r
function MxTest_AddLayer() {\r
    // 获取当前mxcad对象\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
\r
    // 获取数据库图层表\r
    let layerTable = mxcad.getDatabase().getLayerTable();\r
    // 判断图层表中是否存在xxx11图层\r
    if (!layerTable.has("xxx11")) {\r
        // 不存在则创建xxx11图层\r
        let newLayer = new McDbLayerTableRecord();\r
        newLayer.name = "xxx11";\r
        layerTable.add(newLayer);\r
    }\r
\r
    if (layerTable.has("xxx11")) {\r
        // 存在则打印日志\r
        console.log("add layer ok");\r
    }\r
};\r
\r
// 调用添加图层的方法\r
MxTest_AddLayer(); `,AN=`import { MxCpp } from "mxcad";\r
\r
function MxTest_GetAllBlock() {\r
    // 获取当前mxcad对象\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
    // 获取数据库块表\r
    let blockTable = mxcad.getDatabase().getBlockTable();\r
    // 获取所有块表记录的id数组\r
    let aryId = blockTable.getAllRecordId();\r
    // 遍历所有块表记录\r
    aryId.forEach((id) => {\r
        let blkRec = id.getMcDbBlockTableRecord();\r
        if (blkRec === null) return;\r
        console.log(blkRec);\r
        console.log("blkRec.name:" + blkRec.name);\r
        console.log("blkRec.origin:" + blkRec.origin);\r
    });\r
};\r
\r
// 调用获取所有图块的方法\r
MxTest_GetAllBlock();\r
`,SN=`import { MxCpp } from "mxcad";\r
import { MxFun } from "mxdraw";\r
\r
// 获取所有图层\r
function MxTest_GetAllLayer() {\r
  // 获取当前mxcad对象\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
    // 获取图层表\r
    let layerTable = mxcad.getDatabase().getLayerTable();\r
    // 获取所有记录id\r
    let aryId = layerTable.getAllRecordId();\r
    let ret = [];\r
    // 遍历图层id\r
    aryId.forEach((id) => {\r
      let layerRec = id.getMcDbLayerTableRecord();\r
      if (layerRec === null) return;\r
  \r
      console.log(layerRec);\r
      console.log("layerRec.color:" + layerRec.color.getColorString());\r
      console.log("layerRec.name:" + layerRec.name);\r
      let layer: any = {};\r
      layer.name = layerRec.name;\r
  \r
      layer.color = layerRec.color.getColorString();\r
      ret.push(layer);\r
    });\r
    \r
    MxFun.postMessageToParentFrame(ret);\r
    return ret;\r
  };\r
\r
  // 调用获取所有图层的方法\r
  MxTest_GetAllLayer();`,EN=`import { MxCpp } from "mxcad"\r
\r
// 获取所有线型样式\r
function MxTest_GetAllLinetype() {\r
    // 获取当前mxcad对象\r
    let mxobj = MxCpp.getCurrentMxCAD();\r
    // 获取数据库线型样式表\r
    let linetypeTable = mxobj.getDatabase().getLinetypeTable();\r
    // 获取所有线型记录的ID数组\r
    let aryId = linetypeTable.getAllRecordId();\r
    // 遍历线型记录\r
    aryId.forEach((id) => {\r
        let linetypeRec = id.getMcDbLinetypeTableRecord();\r
        if (linetypeRec === null) return;\r
        console.log(linetypeRec);\r
    });\r
};\r
\r
// 调用获取所有线型样式\r
MxTest_GetAllLinetype()`,TN=`import { MxCpp } from "mxcad";\r
\r
// 获取所有文字样式\r
function MxTest_GetAllTextStyle() {\r
    // 获取当前mxcad对象\r
    let mxobj = MxCpp.getCurrentMxCAD();\r
    // 获取文字样式表\r
    let textSyleTable = mxobj.getDatabase().getTextStyleTable();\r
    // 获取文字样式表记录id数组\r
    let aryId = textSyleTable.getAllRecordId();\r
    // 遍历文字样式表记录\r
    aryId.forEach((id) => {\r
        let textSyleRec = id.getMcDbTextStyleTableRecord();\r
        if (textSyleRec === null) return;\r
        let out: any = {};\r
        out.name = textSyleRec.name;\r
        out.font = textSyleRec.font();\r
        out.fileName = textSyleRec.fileName;\r
        out.bigFontFileName = textSyleRec.bigFontFileName;\r
        out.textSize = textSyleRec.textSize;\r
        out.xScale = textSyleRec.xScale;\r
        console.log(out);\r
    });\r
};\r
\r
// 调用获取所有文字样式的方法\r
MxTest_GetAllTextStyle();\r
`,CN=`import { MxCADUiPrEntity } from "mxcad";\r
\r
// 读取扩展数据。\r
async function MxTest_ReadxData() {\r
    // 选择对象\r
    let selEntity = new MxCADUiPrEntity();\r
    selEntity.setMessage("选择对象");\r
    let id = await selEntity.go();\r
    if (!id.isValid()) return;\r
    \r
    // 获取对象\r
    let ent = id.getMcDbEntity();\r
    if (ent === null) return; \r
\r
    // 得到对象的扩展数据\r
    let data = ent.getxData();\r
    //data.PrintData();\r
    data.forEach((val, type, dxf) => {\r
        console.log(JSON.stringify({ val: val, type: type, dxf: dxf }));\r
    })\r
\r
    //let data = ent.getxDataString("DataName");\r
    //MxFun.acutPrintf(data.val + "\\n");\r
};\r
\r
// 调用读取扩展数据的方法\r
MxTest_ReadxData()`,PN=`import { MxCADUiPrEntity } from "mxcad";\r
\r
// 写扩展数据\r
async function MxTest_WritexData() {\r
    // 选择对象\r
    let selEntity = new MxCADUiPrEntity();\r
    selEntity.setMessage("选择对象");\r
    let id = await selEntity.go();\r
    if (!id.isValid()) return;\r
     \r
    // 获取对象\r
    let ent = id.getMcDbEntity();\r
    if (ent === null) return;\r
    // 写扩展数据\r
    ent.setxDataString("DataName", "xxxxx");\r
    //ent.setxData(new MxCADResbuf([{type:MxCADResbufDataType.kExDataName,val:"DataName"},{type:MxCADResbufDataType.kString,val:"yyyyy"}]));\r
};\r
\r
// 调用写扩展数据的方法\r
 MxTest_WritexData();\r
\r
`,DN=`import { MxCpp, McDbDictionary, McDbXrecord } from "mxcad";\r
\r
// 字典数据遍历\r
function MxTest_DictionaryData(dict) {\r
    let aryName = dict.getAllObjectName();\r
    aryName.forEach((name) => {\r
        console.log(name);\r
        let id = dict.getAt(name);\r
        let obj = id.getMcDbObject();\r
        if (obj instanceof McDbDictionary) {\r
            let dict = obj as McDbDictionary;\r
            console.log(dict);\r
            MxTest_DictionaryData(dict);\r
        }\r
        else if (obj instanceof McDbXrecord) {\r
            let xrec = obj as McDbXrecord;\r
            let data = xrec.getData()\r
            data.PrintData();\r
        }\r
    })\r
}\r
\r
// 得到命名字典\r
async function MxTest_GetNamedObjectsDictionary() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    let dict = mxcad.getDatabase().getNamedObjectsDictionary();\r
    let aryName = dict.getAllObjectName();\r
    aryName.forEach((name) => {\r
        console.log(name);\r
        let id = dict.getAt(name);\r
        let obj = id.getMcDbObject();\r
        if (obj instanceof McDbDictionary) {\r
            let dict = obj as McDbDictionary;\r
            console.log(dict);\r
            MxTest_DictionaryData(dict);\r
        }\r
    })\r
}\r
\r
// 调用得到命名字典方法\r
MxTest_GetNamedObjectsDictionary()`,LM=[{type:"参数绘图",name:"画直线",code:`${ZF}`},{type:"参数绘图",name:"画圆",code:JF},{type:"参数绘图",name:"画点",code:$F},{type:"参数绘图",name:"画圆弧",code:tN},{type:"参数绘图",name:"画图片",code:QF},{type:"参数绘图",name:"画多段线",code:eN},{type:"参数绘图",name:"画椭圆",code:nN},{type:"参数绘图",name:"画文字",code:rN},{type:"参数绘图",name:"画多行文字",code:iN},{type:"参数绘图",name:"画尺寸标注",code:oN},{type:"参数绘图",name:"画路径",code:sN},{type:"参数绘图",name:"画填充",code:aN},{type:"参数绘图",name:"画图块",code:lN},{type:"参数绘图",name:"画文本自定义实体",code:cN},{type:"参数绘图",name:"画多种线型的直线",code:uN},{type:"参数绘图",name:"画多种文字样式的文字",code:hN},{type:"交互绘图",name:"取点画圆弧",code:dN},{type:"交互绘图",name:"取点画直线",code:fN},{type:"交互绘图",name:"取点画文字",code:pN},{type:"交互绘图",name:"取点画圆",code:mN},{type:"交互绘图",name:"取点画图片",code:gN},{type:"交互绘图",name:"取点画多段线",code:yN},{type:"交互绘图",name:"取点画椭圆",code:bN},{type:"交互绘图",name:"选点填充",code:vN},{type:"交互绘图",name:"插入图块",code:xN},{type:"交互绘图",name:"绘制矩形",code:_N},{type:"图纸数据库",name:"得到图纸所有对象",code:wN},{type:"图纸数据库",name:"添加图层",code:MN},{type:"图纸数据库",name:"得到图纸所有图块",code:AN},{type:"图纸数据库",name:"得到图纸所有图层",code:SN},{type:"图纸数据库",name:"得到图纸所有线型样式",code:EN},{type:"图纸数据库",name:"得到图纸所有文字样式",code:TN},{type:"图纸数据库",name:"读扩展数据",code:CN},{type:"图纸数据库",name:"写入扩展数据",code:PN},{type:"图纸数据库",name:"得到命名字典",code:DN}];function RN(t,n,e){const s=t.distanceTo(n)/2,a=s*e,o=(s*s+a*a)/(2*a),r=(t.x+n.x)/2,u=(t.y+n.y)/2;return new A.McGePoint3d(r,u).addvec(n.clone().sub(t).perpVector().normalize().mult(o-a))}function kN(t,n,e){const i=Math.PI*2/360;let s=Math.atan2(n.y-t.y,n.x-t.x)*180/Math.PI*i,a=Math.atan2(e.y-t.y,e.x-t.x)*180/Math.PI*i;return{startAngle:s,endAngle:a}}Ct.MxFun.addCommand("list",()=>re(this,null,function*(){const t=yield A.MxCADUtility.userSelect("选择对象"),n=new A.MxCADUiPrPoint;Ct.MxFun.acutPrintf("找到"+t.length+`个
`);const e=t.pop();if(!e)return;const i=e.getMcDbEntity();if(!e.isValid()||!i)Ct.MxFun.acutPrintf(`对象无效
`);else if((yield NM(i))===!1)return;for(;t.length;){if(n.setMessage("按 ENTER 键继续"),n.setDisableDynInput(!0),yield n.go(),n.getDetailedResult()===Ct.DetailedResult.kCodeAbort||n.getDetailedResult()===Ct.DetailedResult.kEcsIn||n.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;const s=t.pop();if(!s)break;const a=s.getMcDbEntity();if(!s.isValid()||!a){Ct.MxFun.acutPrintf(`对象无效
`);continue}if((yield NM(a))===!1)return}}));const IN={McDbPoint:"点",McDbLine:"直线",McDbPolyline:"多段线",McDbArc:"圆弧",McDbCircle:"圆",McDbEllipse:"椭圆",McDbHatch:"填充",McDbText:"单行文本",McDbMText:"多行文本",McDbRasterImage:"光栅图片",McDbBlockReference:"块参照"},BM={Top:"上",Middle:"中",Bottom:"下",Base:"基",Left:"左",Center:"中",Right:"右",Align:"对齐",Fit:"适应",Mid:"中"},FM=t=>t.replace(/k(\w+)/g,function(n,e){return e.replace(/([A-Z])/g,"-$1").split("-").reduce((o,r)=>BM[r]?o+BM[r]:"")});function NM(t){return re(this,null,function*(){const n=t.layer,s=A.MxCpp.getCurrentDatabase().currentSpace.name==="*Model_Space"?"模型空间":"图纸空间",a=t.getHandle();console.log(t.objectName);let o=IN[t.objectName]||t.objectName;if(t instanceof A.McDbDimension&&(o="标注"),Ct.MxFun.acutPrintf(`
                  ${o}        图层: "${n}"`),Ct.MxFun.acutPrintf(`
                           空间: "${s}"`),Ct.MxFun.acutPrintf(`
                    句柄 = ${a}`),t instanceof A.McDbPoint&&Ct.MxFun.acutPrintf(`
                 于 点， X= ${t.position.x.toFixed(4)}  Y= ${t.position.y.toFixed(4)}  Z= ${t.position.z.toFixed(4)}`),t instanceof A.McDbLine){Ct.MxFun.acutPrintf(`
                 自 点， X= ${t.startPoint.x.toFixed(4)}  Y= ${t.startPoint.y.toFixed(4)}  Z= ${t.startPoint.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                 到 点， X= ${t.startPoint.x.toFixed(4)}  Y= ${t.startPoint.y.toFixed(4)}  Z= ${t.startPoint.z.toFixed(4)}`);let r=t.endPoint.x-t.startPoint.x,u=t.endPoint.y-t.startPoint.y,l=t.endPoint.z-t.startPoint.z,h=THREE.MathUtils.radToDeg(Math.atan2(u,r));Ct.MxFun.acutPrintf(`
          长度 = ${t.getLength().val.toFixed(4)}，在 XY 平面中的角度 = ${Math.floor(h)}`),Ct.MxFun.acutPrintf(`
                  增量 X =  ${r.toFixed(4)}，增量 Y =   ${u.toFixed(4)}，增量 Z =   ${l.toFixed(4)}`)}if(t instanceof A.McDbPolyline){Ct.MxFun.acutPrintf(`
            ${t.isClosed?"闭合":"打开"}`),Ct.MxFun.acutPrintf(`
        固定宽度    ${t.constantWidth.toFixed(4)}`),Ct.MxFun.acutPrintf(`
            面积   ${t.getArea().val.toFixed(4)}`),Ct.MxFun.acutPrintf(`
         周长   ${t.getLength().val.toFixed(4)}`);const r=t.numVerts(),u=new A.MxCADUiPrPoint,l=[],h=[];let f=!1;for(let b=0;b<r;b++){const v=t.getWidthsAt(b),x=t.getBulgeAt(b);(v.val1!==0||v.val2!==0)&&(f=!0),l.push(v),h.push(x)}let d=0;const p=3;for(let b=0;b<r;b++){if(d>p)for(;;){u.setMessage("按 ENTER 键继续"),u.disableAllTrace(),u.clearLastInputPoint(),u.setDynamicInputType(Ct.DynamicInputType.kNoInput);const w=yield u.go();if(u.getDetailedResult()===Ct.DetailedResult.kCodeAbort||u.getDetailedResult()===Ct.DetailedResult.kEcsIn)return;if(u.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return!1;if(u.getDetailedResult()===Ct.DetailedResult.kNullEnterIn||u.getDetailedResult()===Ct.DetailedResult.kNullSpaceIn||w){d=0;break}}const v=t.getPointAt(b).val,x=h[b];if(Ct.MxFun.acutPrintf(`
          于端点  X=  ${v.x.toFixed(1)}  Y=  ${v.y.toFixed(1)}  Z=  ${v.z.toFixed(1)}`),f&&(Ct.MxFun.acutPrintf(`
    起点宽度  ${l[b].val1.toFixed(4)}`),Ct.MxFun.acutPrintf(`
      端点宽度  ${l[b].val2.toFixed(4)}`)),Math.abs(x)>0){Ct.MxFun.acutPrintf(`
             凸度       ${x.toFixed(1)}`);const w=t.getPointAt(b+1).val,M=RN(v,w,x);Ct.MxFun.acutPrintf(`
            圆心  X=  ${M.x.toFixed(1)}  Y=  ${M.y.toFixed(1)}  Z=  ${M.z.toFixed(1)}`),Ct.MxFun.acutPrintf(`
            半径    ${M.distanceTo(v).toFixed(1)}`);const{startAngle:E,endAngle:D}=kN(M,v,w);Ct.MxFun.acutPrintf(`
       起点角度       ${THREE.MathUtils.radToDeg(E).toFixed(0)}`),Ct.MxFun.acutPrintf(`
       端点角度       ${THREE.MathUtils.radToDeg(D).toFixed(0)}`),b===r-1&&Ct.MxFun.acutPrintf(`
          于端点  X=  ${w.x.toFixed(1)}  Y=  ${w.y.toFixed(1)}  Z=  ${w.z.toFixed(1)}`)}d++}}if(t instanceof A.McDbArc&&(Ct.MxFun.acutPrintf(`
                圆心 点， X= ${t.center.x.toFixed(4)}  Y= ${t.center.y.toFixed(4)}  Z= ${t.center.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                半径  ${t.radius.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                起点 角度    ${THREE.MathUtils.radToDeg(t.startAngle).toFixed(0)}`),Ct.MxFun.acutPrintf(`
                端点 角度    ${THREE.MathUtils.radToDeg(t.endAngle).toFixed(0)}`),Ct.MxFun.acutPrintf(`
            长度 ${t.getLength().val.toFixed(4)}`)),t instanceof A.McDbCircle&&(Ct.MxFun.acutPrintf(`
                圆心 点， X= ${t.center.x.toFixed(4)}  Y= ${t.center.y.toFixed(4)}  Z= ${t.center.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                半径  ${t.radius.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                周长 ${t.getLength().val.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                面积 ${(Math.PI*t.radius*t.radius).toFixed(4)}`)),t instanceof A.McDbEllipse){const r=t.majorAxis.length(),u=t.minorAxis.length(),l=t.startAngle===0&&t.endAngle===2*Math.PI;if(l){const p=(b,v)=>{const x=Math.pow(b-v,2)/Math.pow(b+v,v);return Math.PI*(b+v)*(1+3*x/(10+Math.sqrt(4-3*x)))};Ct.MxFun.acutPrintf(`
                               面积: ${(Math.PI*r*u).toFixed(4)}`),Ct.MxFun.acutPrintf(`
                               圆周: ${p(r,u).toFixed(4)}`)}else{const p=(b,v,x,w,M)=>{const E=function(V){return Math.sqrt(b*b*Math.sin(V)*Math.sin(V)+v*v*Math.cos(V)*Math.cos(V))};let D=0;const N=(w-x)/M;for(let V=0;V<=M;V++){const K=x+V*N;V===0||V===M?D+=E(K):V%2===0?D+=2*E(K):D+=4*E(K)}return D*=N/3,Math.abs(D)};Ct.MxFun.acutPrintf(`
                               长度: ${p(r,u,t.startAngle,t.endAngle,30).toFixed(4)}`)}Ct.MxFun.acutPrintf(`
                              中心点: X = ${t.center.x.toFixed(4)} , Y = ${t.center.y.toFixed(4)}   , Z = ${t.center.z.toFixed(4)}`);const h=r>u,f=h?t.majorAxis:t.minorAxis,d=h?t.minorAxis:t.majorAxis;if(Ct.MxFun.acutPrintf(`
                               长轴: X = ${f.x.toFixed(4)}  , Y = ${f.y.toFixed(4)}  , Z = ${f.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                               短轴: X = ${d.x.toFixed(4)}  , Y = ${d.y.toFixed(4)}  , Z = ${d.z.toFixed(4)}`),!l){const p=(x,w,M,E,D)=>{const N=x.x,V=x.y,K=w.x,j=w.y,Z=M.x,tt=M.y,rt=Math.atan2(j,K),J=Math.sqrt(K*K+j*j),U=Math.sqrt(Z*Z+tt*tt),G=N+J*Math.cos(E)*Math.cos(rt)-U*Math.sin(E)*Math.sin(rt),I=V+J*Math.cos(E)*Math.sin(rt)+U*Math.sin(E)*Math.cos(rt),C=N+J*Math.cos(D)*Math.cos(rt)-U*Math.sin(D)*Math.sin(rt),L=V+J*Math.cos(D)*Math.sin(rt)+U*Math.sin(D)*Math.cos(rt);return{startPoint:new A.McGePoint3d(G,I),endPoint:new A.McGePoint3d(C,L)}},{startPoint:b,endPoint:v}=p(t.center,t.majorAxis,t.minorAxis,t.startAngle,t.endAngle);Ct.MxFun.acutPrintf(`
                               起点: X = ${b.x.toFixed(4)} , Y = ${b.y.toFixed(4)}  , Z = ${b.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                               端点: X = ${v.x.toFixed(4)} , Y = ${v.y.toFixed(4)}  , Z = ${v.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                             起点角度: ${THREE.MathUtils.radToDeg(t.startAngle).toFixed(0)}`),Ct.MxFun.acutPrintf(`
                             端点角度: ${THREE.MathUtils.radToDeg(t.endAngle).toFixed(0)}`)}Ct.MxFun.acutPrintf(`
                             半径比例: ${t.radiusRatio.toFixed(4)}`)}if(t instanceof A.McDbHatch){const r=t.patternName();Ct.MxFun.acutPrintf(`
                 填充图案 ${r}`),Ct.MxFun.acutPrintf(`
                 图案填充比例    ${t.patternScale.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                 图案填充角度      ${THREE.MathUtils.radToDeg(t.patternAngle).toFixed(0)}`);const u=new A.McDbPolyline,l=[];u.isClosed=!0;for(let f=0;f<t.numLoops;f++){const{vertices:d,bulges:p}=t.getLoopAt(f);d.forEach((b,v)=>{const x=p[v];u.addVertexAt(b,Number(x.toFixed(14)))}),l.push(u),A.MxCpp.getCurrentMxCAD().drawEntity(u)}const h=l.reduce((f,d)=>f+d.getArea().val,0);Ct.MxFun.acutPrintf(`
                 面积      ${h.toFixed(4)}`)}if(t instanceof A.McDbText&&(Ct.MxFun.acutPrintf(`
              样式 = "${t.textStyle}"`),Ct.MxFun.acutPrintf(`
                起点 点， X=  ${t.position.x.toFixed(4)}  Y= ${t.position.y.toFixed(4)}  Z=   ${t.position.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                高度    ${t.height.toFixed(4)}`),Ct.MxFun.acutPrintf(`
                文字 ${t.textString}`),Ct.MxFun.acutPrintf(`
                旋转 角度    ${t.rotation.toFixed(0)}`),Ct.MxFun.acutPrintf(`
                宽度 比例因子    ${t.widthFactor.toFixed(4)}`)),t instanceof A.McDbMText&&(Ct.MxFun.acutPrintf(`
              样式 = "${t.textStyle}"`),Ct.MxFun.acutPrintf(`
位置:         X=  ${t.location.x.toFixed(4)}  Y=   ${t.location.y.toFixed(4)}  Z=   ${t.location.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
宽度:           ${t.width.toFixed(4)}`),Ct.MxFun.acutPrintf(`
法向:         X=   ${t.normal.x.toFixed(4)}  Y=   ${t.normal.y.toFixed(4)}  Z=   ${t.normal.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
旋转:                 ${t.rotation.toFixed(0)}`),Ct.MxFun.acutPrintf(`
文字高度:        ${t.textHeight.toFixed(4)}`),Ct.MxFun.acutPrintf(`
附着:        ${FM(A.McDb.AttachmentPoint[t.attachment])}`),Ct.MxFun.acutPrintf(`
内容:        ${t.contents}`)),t instanceof A.McDbRasterImage){const r=t.imageDefId().getMcDbRasterImageDef(),u=f=>f.split("/").pop().split("\\").pop();Ct.MxFun.acutPrintf(`
图像:                   ${u(r.sourceFileName)}`);const l=f=>{const d=f.clipBoundaryType();if(d===A.McDb.ClipBoundaryType.kInvalid)return"无效";if(d===A.McDb.ClipBoundaryType.kPoly)return"多边形";if(d===A.McDb.ClipBoundaryType.kRect)return"矩形"};Ct.MxFun.acutPrintf(`
剪裁边界类型:      ${l(t)}`);const h=t.clipBoundary();Ct.MxFun.acutPrintf(`
边界点数目: ${h.length()}`),t.clipBoundary().forEach(f=>{Ct.MxFun.acutPrintf(`
       位于点，X=   ${f.x.toFixed(4)}, Y=   ${f.y.toFixed(4)}, Z=   ${f.z.toFixed(4)}`)})}if(t instanceof A.McDbBlockReference&&(Ct.MxFun.acutPrintf(`
块名:               "${t.blockName}"`),Ct.MxFun.acutPrintf(`
插入点:             X= ${t.position.x.toFixed(4)}, Y=   ${t.position.y.toFixed(4)}, Z=   ${t.position.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
X 比例因子:         ${t.scaleFactors.x.toFixed(4)}`),Ct.MxFun.acutPrintf(`
Y 比例因子:         ${t.scaleFactors.y.toFixed(4)}`),Ct.MxFun.acutPrintf(`
  旋转角度:         ${t.rotation.toFixed(0)}`),Ct.MxFun.acutPrintf(`
Z 比例因子:         ${t.scaleFactors.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
Z 比例因子:         ${t.scaleFactors.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
  缩放比例:         ${t.getScale().toFixed(4)}`)),t instanceof A.McDbDimension){Ct.MxFun.acutPrintf(`
文字位置:           X= ${t.textPosition.x.toFixed(4)} Y= ${t.textPosition.y.toFixed(4)} Z= ${t.textPosition.z.toFixed(4)}`),Ct.MxFun.acutPrintf(`
是否使用的默认文字位置:           ${t.isUsingDefaultTextPosition()}`),Ct.MxFun.acutPrintf(`
高度:          ${t.elevation.toFixed(4)}`),Ct.MxFun.acutPrintf(`
文本内容:       ${t.dimensionText}`),Ct.MxFun.acutPrintf(`
文本旋转角度:   ${THREE.MathUtils.radToDeg(t.textRotation).toFixed(0)}`);const r=t.dimensionStyle.getMcDbDimStyleTableRecord();Ct.MxFun.acutPrintf(`
标注样式:       ${r.name}`),Ct.MxFun.acutPrintf(`
文字附着:      ${FM(A.McDb.AttachmentPoint[t.textAttachment])}`),Ct.MxFun.acutPrintf(`
水平旋转角度:   ${THREE.MathUtils.radToDeg(t.horizontalRotation).toFixed(0)}`),Ct.MxFun.acutPrintf(`
水平旋转角度:   ${THREE.MathUtils.radToDeg(t.horizontalRotation).toFixed(0)}`)}Ct.MxFun.acutPrintf(`
命令`)})}Ct.MxFun.addCommand("group",()=>re(this,null,function*(){let t,n="",e="",i;const s=A.MxCpp.getCurrentDatabase(),a=s.GetGroupDictionary();for(;;){const o=yield A.MxCADUtility.userSelect("选择对象",null,(r,u)=>{u.setKeyWords("[名称(N)/说明(D)]"),t=u});if(t.getDetailedResult()===Ct.DetailedResult.kEcsIn||t.getDetailedResult()===Ct.DetailedResult.kCodeAbort||t.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;if(o&&(i=o),t.isKeyWordPicked("N")){for(;;){const r=new A.MxCADUiPrString;r.setMessage("输入编组名"),r.setKeyWords("[查询(A)]");const u=yield r.go();if(r.getDetailedResult()===Ct.DetailedResult.kCodeAbort||r.getDetailedResult()===Ct.DetailedResult.kEcsIn||r.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;if(r.isKeyWordPicked("A")){r.setMessage("请输入要列出的编码组名<*>"),r.setKeyWords("");const f=yield r.go();if(console.log(f),r.getDetailedResult()===Ct.DetailedResult.kCodeAbort||r.getDetailedResult()===Ct.DetailedResult.kEcsIn||r.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;if(f&&f!=="*"){const p=a.getAt(f).getMcDbObject();Ct.MxFun.acutPrintf(`
定义的编组:`),p&&Ct.MxFun.acutPrintf(`
 ${p.name}`)}else if(f==="*"||r.getDetailedResult()===Ct.DetailedResult.kNullEnterIn||r.getDetailedResult()===Ct.DetailedResult.kNullSpaceIn){const d=a.getAllObject();Ct.MxFun.acutPrintf(`
定义的编组:`),d.forEach(p=>{const b=p.getMcDbObject();b&&Ct.MxFun.acutPrintf(`
 ${b.name}`)})}continue}if(!u)return;const l=a.getAt(n);if(l.getMcDbObject()&&l.isValid()){Ct.MxFun.acutPrintf(`编组 ${n} 已经存在`);continue}n=u;break}continue}if(t.isKeyWordPicked("D")){const r=new A.MxCADUiPrString;r.setMessage("输入编组说明");const u=yield r.go();if(!u)return;e=u;continue}if(t.getDetailedResult()===Ct.DetailedResult.kNullEnterIn||t.getDetailedResult()===Ct.DetailedResult.kNullSpaceIn){if(i.some(u=>s.getEntitiesInTheGroup(u).length!==0)){const u=new A.MxCADUiPrKeyWord;u.setMessage("包含相同对象的组已经存在。仍要创建新的组？<N>"),u.setKeyWords("[是(Y)/否(N)]");const l=yield u.go();if((l==null?void 0:l.toLocaleUpperCase())==="N"||!l)return}if(s.CreateGroup(i,n)){const l=a.getAt(n).getMcDbObject();l.description=e}}break}})),Ct.MxFun.addCommand("ungroup",()=>re(this,null,function*(){let t;const e=A.MxCpp.getCurrentDatabase().GetGroupDictionary();for(;;){const i=new A.MxCADUiPrEntity;i.setMessage("选择对象"),i.setKeyWords("[名称(N)]");const s=yield i.go();if(i.getDetailedResult()===Ct.DetailedResult.kEcsIn||i.getDetailedResult()===Ct.DetailedResult.kCodeAbort||i.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;if(i.isKeyWordPicked("N")){for(;;){const a=new A.MxCADUiPrString;a.setMessage("输入编组名"),a.setKeyWords("[查询(A)]");const o=yield a.go();if(a.getDetailedResult()===Ct.DetailedResult.kCodeAbort||a.getDetailedResult()===Ct.DetailedResult.kEcsIn||a.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;if(a.isKeyWordPicked("A")){a.setMessage("请输入要列出的编码组名<*>"),a.setKeyWords("");const l=yield a.go();if(a.getDetailedResult()===Ct.DetailedResult.kCodeAbort||a.getDetailedResult()===Ct.DetailedResult.kEcsIn||a.getDetailedResult()===Ct.DetailedResult.kNewCommadIn)return;if(l&&l!=="*"){const f=e.getAt(l).getMcDbObject();Ct.MxFun.acutPrintf(`
定义的编组:`),f&&Ct.MxFun.acutPrintf(`
 ${f.name}`)}else if(l==="*"||a.getDetailedResult()===Ct.DetailedResult.kNullEnterIn||a.getDetailedResult()===Ct.DetailedResult.kNullSpaceIn){const h=e.getAllObject();Ct.MxFun.acutPrintf(`
定义的编组:`),h.forEach(f=>{const d=f.getMcDbObject();d&&Ct.MxFun.acutPrintf(`
 ${d.name}`)})}continue}if(!o)return;const r=e.getAt(t);if(r.getMcDbObject()&&r.isValid()){Ct.MxFun.acutPrintf(`编组 ${t} 已经存在`);continue}t=o;break}continue}if(s){const a=s.getMcDbEntity();if(a){const o=a.getHandle(),r=e.getAllObjectName(),u=r.length();for(let l=0;l<u;l++){const h=r.at(l),d=e.getAt(h).getMcDbObject();if(!d)continue;d.getAllEntityId().some(b=>{const v=b.getMcDbEntity();return(v==null?void 0:v.getHandle())===o?(t=h,!0):!1})}}}if(t){const o=e.getAt(t).getMcDbObject();if(o)o.clear(),e.remove(t),Ct.MxFun.acutPrintf(`
组 ${t} 已分解`);else{Ct.MxFun.acutPrintf(`
对象不是组成员`);continue}}else{Ct.MxFun.acutPrintf(`
对象不是组成员`);continue}break}}));const LN=`///////////////////////////////////////////////////////////////////////////////
//版权所有（C）2002-2022，成都梦想凯德科技有限公司。
//本软件代码及其文档和相关资料归成都梦想凯德科技有限公司,应用包含本软件的程序必须包括以下版权声明
//此应用程序应与成都梦想凯德科技有限公司达成协议，使用本软件、其文档或相关材料
//https://www.mxdraw.com/
///////////////////////////////////////////////////////////////////////////////

import { McDbEntity, McDbLine, McDbPoint, McDbPolyline, MxCADUiPrPoint, MxCADUtility, MxCpp, McGePoint3d, McDbArc, McDbCircle, McDbEllipse, McGeVector3d, McDbHatch, McDbText, McDbMText, McDb, McDbRasterImageDef, McDbRasterImage, McDbBlockReference, McDbDimension } from "mxcad";
import { DetailedResult, DynamicInputType, MxDbRegularPolygonShape, MxFun } from "mxdraw";
function calculateCenter(start: McGePoint3d, end: McGePoint3d, bulge: number) {
  const dist = start.distanceTo(end)
  const dx = dist / 2
  const dy = dx * bulge
  const r = (dx * dx + dy * dy) / (2 * dy)
  const midX = (start.x + end.x) / 2
  const midY = (start.y + end.y) / 2

  return new McGePoint3d(midX, midY).addvec(end.clone().sub(start).perpVector().normalize().mult(r - dy))
}
function calculateLineAngle(center: McGePoint3d, start: McGePoint3d, end: McGePoint3d) {
  const deg = (Math.PI * 2) / 360
  // 计算直线的角度
  let startAngle = ((Math.atan2(start.y - center.y, start.x - center.x) * 180) / Math.PI) * deg
  let endAngle = ((Math.atan2(end.y - center.y, end.x - center.x) * 180) / Math.PI) * deg

  return {
    startAngle,
    endAngle
  }
}
MxFun.addCommand("list", async () => {
  // 选择对象获取信息
  const objIds = await MxCADUtility.userSelect("选择对象")
  const getPoint = new MxCADUiPrPoint()
  MxFun.acutPrintf("找到" + objIds.length + "个\\n")
  const objId = objIds.pop()
  if (!objId) return
  const ent = objId.getMcDbEntity()
  if (!objId.isValid() || !ent) {
    MxFun.acutPrintf("对象无效\\n")
  } else {
    if (await printInfo(ent) === false) return
  }
  while (objIds.length) {
    getPoint.setMessage("按 ENTER 键继续")
    getPoint.setDisableDynInput(true)
    await getPoint.go()
    // 程序中止、按下Esc键、新的命令运行时退出
    if (getPoint.getDetailedResult() === DetailedResult.kCodeAbort) return
    if (getPoint.getDetailedResult() === DetailedResult.kEcsIn) return
    if (getPoint.getDetailedResult() === DetailedResult.kNewCommadIn) return
    const objId = objIds.pop()
    if (!objId) break;
    const ent = objId.getMcDbEntity()
    if (!objId.isValid() || !ent) {
      MxFun.acutPrintf("对象无效\\n")
      continue
    }
    if (await printInfo(ent) === false) return
  }
})
// 记录对象的名称
const entNames = {
  "McDbPoint": "点",
  "McDbLine": "直线",
  "McDbPolyline": "多段线",
  "McDbArc": "圆弧",
  "McDbCircle": "圆",
  "McDbEllipse": "椭圆",
  "McDbHatch": "填充",
  "McDbText": "单行文本",
  "McDbMText": "多行文本",
  "McDbRasterImage": "光栅图片",
  "McDbBlockReference": "块参照",
}
// 附着名称字典
const map = {
  Top: "上",
  Middle: "中",
  Bottom: "下",
  Base: "基",
  Left: "左",
  Center: "中",
  Right: "右",
  Align: "对齐",
  Fit: "适应",
  Mid: "中"
};

// 获取文字的附着名称
const getAttachmentName = (str: string) => {
  return str.replace(/k(\\w+)/g, function (_, p1) {
    let key = p1.replace(/([A-Z])/g, "-$1") as string
    const arr = key.split("-")
    const name = arr.reduce((name, key) => {
      if (map[key]) {
        return name + map[key];
      } else {
        return "";
      }
    })
    return name
  });
}
// 打印信息
async function printInfo(ent: McDbEntity) {
  // 得到所有对象的基本信息
  const layer = ent.layer
  const layoutBlockName = MxCpp.getCurrentDatabase().currentSpace.name
  const isMainModel = layoutBlockName === "*Model_Space"
  const modeName = isMainModel ? "模型空间" : "图纸空间"
  const handle = ent.getHandle()
  console.log(ent.objectName)

  let entName = entNames[ent.objectName] || ent.objectName
  if(ent instanceof McDbDimension) {
    entName = "标注"
  }
  MxFun.acutPrintf(\`\\n                  \${entName}        图层: "\${layer}"\`)
  MxFun.acutPrintf(\`\\n                           空间: "\${modeName}"\`)

  MxFun.acutPrintf(\`\\n                    句柄 = \${handle}\`)
  // 点对象的信息
  if (ent instanceof McDbPoint) {
    MxFun.acutPrintf(\`\\n                 于 点， X= \${ent.position.x.toFixed(4)}  Y= \${ent.position.y.toFixed(4)}  Z= \${ent.position.z.toFixed(4)}\`)
  }
  // 直线对象的信息
  if (ent instanceof McDbLine) {
    MxFun.acutPrintf(\`\\n                 自 点， X= \${ent.startPoint.x.toFixed(4)}  Y= \${ent.startPoint.y.toFixed(4)}  Z= \${ent.startPoint.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                 到 点， X= \${ent.startPoint.x.toFixed(4)}  Y= \${ent.startPoint.y.toFixed(4)}  Z= \${ent.startPoint.z.toFixed(4)}\`)
    let deltaX = ent.endPoint.x - ent.startPoint.x;
    let deltaY = ent.endPoint.y - ent.startPoint.y;
    let deltaZ = ent.endPoint.z - ent.startPoint.z;

    // 使用atan2计算角度，结果是弧度，转换为度
    let angleInDegrees = THREE.MathUtils.radToDeg(Math.atan2(deltaY, deltaX));

    MxFun.acutPrintf(\`\\n          长度 = \${ent.getLength().val.toFixed(4)}，在 XY 平面中的角度 = \${Math.floor(angleInDegrees)}\`)
    MxFun.acutPrintf(\`\\n                  增量 X =  \${deltaX.toFixed(4)}，增量 Y =   \${deltaY.toFixed(4)}，增量 Z =   \${deltaZ.toFixed(4)}\`)
  }

  // 多段线对象的信息
  if (ent instanceof McDbPolyline) {
    MxFun.acutPrintf(\`\\n            \${ent.isClosed ? "闭合" : "打开"}\`)
    MxFun.acutPrintf(\`\\n        固定宽度    \${ent.constantWidth.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n            面积   \${ent.getArea().val.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n         周长   \${ent.getLength().val.toFixed(4)}\`)

    // 输出多段线的每个点的信息
    const num = ent.numVerts()
    // 通过取点对象控制输出量 只有在按下空格或者回车才会继续打印剩余信息
    const getPoint = new MxCADUiPrPoint()

    // 记录点包含的其他信息如线宽、凸度值等
    const widthInfos: {
      val1: number;
      val2: number;
      ret: boolean;
    }[] = []
    const bulges: number[] = []
    // 记录是否打印线宽
    let isPrintWidth = false

    for (let index = 0; index < num; index++) {
      const width = ent.getWidthsAt(index)
      const bulge = ent.getBulgeAt(index)
      if (width.val1 !== 0 || width.val2 !== 0) {
        isPrintWidth = true
      }
      widthInfos.push(width)
      bulges.push(bulge)
    }
    // 控制输出打印量
    let accumulated = 0
    const maxIndex = 3

    for (let index = 0; index < num; index++) {
      if (accumulated > maxIndex) {
        while (true) {
          getPoint.setMessage("按 ENTER 键继续")
          getPoint.disableAllTrace()
          getPoint.clearLastInputPoint()
          // 设置不需要动态的输入框
          getPoint.setDynamicInputType(DynamicInputType.kNoInput)
          const pt = await getPoint.go()
          if (getPoint.getDetailedResult() === DetailedResult.kCodeAbort) return
          if (getPoint.getDetailedResult() === DetailedResult.kEcsIn) return
          if (getPoint.getDetailedResult() === DetailedResult.kNewCommadIn) return false
          // 只有回车和空格或者鼠标左键点击才能继续往下走打印的流程， 否则始终循环等待用户输入
          if (getPoint.getDetailedResult() === DetailedResult.kNullEnterIn || getPoint.getDetailedResult() === DetailedResult.kNullSpaceIn || pt) {
            accumulated = 0
            break;
          }
        }
      }
      const point = ent.getPointAt(index).val
      const bulge = bulges[index]

      MxFun.acutPrintf(\`\\n          于端点  X=  \${point.x.toFixed(1)}  Y=  \${point.y.toFixed(1)}  Z=  \${point.z.toFixed(1)}\`)
      if (isPrintWidth) {
        MxFun.acutPrintf(\`\\n    起点宽度  \${widthInfos[index].val1.toFixed(4)}\`)
        MxFun.acutPrintf(\`\\n      端点宽度  \${widthInfos[index].val2.toFixed(4)}\`)
      }
      // 凸度不为0时 且
      if (Math.abs(bulge) > 0) {
        MxFun.acutPrintf(\`\\n             凸度       \${bulge.toFixed(1)}\`)
        const nextPoint = ent.getPointAt(index + 1).val
        const center = calculateCenter(point, nextPoint, bulge)
        MxFun.acutPrintf(\`\\n            圆心  X=  \${center.x.toFixed(1)}  Y=  \${center.y.toFixed(1)}  Z=  \${center.z.toFixed(1)}\`)
        MxFun.acutPrintf(\`\\n            半径    \${center.distanceTo(point).toFixed(1)}\`)
        const { startAngle, endAngle } = calculateLineAngle(center, point, nextPoint)
        MxFun.acutPrintf(\`\\n       起点角度       \${THREE.MathUtils.radToDeg(startAngle).toFixed(0)}\`)
        MxFun.acutPrintf(\`\\n       端点角度       \${THREE.MathUtils.radToDeg(endAngle).toFixed(0)}\`)
        // 最后一次循环加上最后一个端点信息
        if (index === num - 1) {
          MxFun.acutPrintf(\`\\n          于端点  X=  \${nextPoint.x.toFixed(1)}  Y=  \${nextPoint.y.toFixed(1)}  Z=  \${nextPoint.z.toFixed(1)}\`)
        }
      }
      accumulated++
    }
  }
  // 圆弧的信息
  if (ent instanceof McDbArc) {
    MxFun.acutPrintf(\`\\n                圆心 点， X= \${ent.center.x.toFixed(4)}  Y= \${ent.center.y.toFixed(4)}  Z= \${ent.center.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                半径  \${ent.radius.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                起点 角度    \${THREE.MathUtils.radToDeg(ent.startAngle).toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n                端点 角度    \${THREE.MathUtils.radToDeg(ent.endAngle).toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n            长度 \${ent.getLength().val.toFixed(4)}\`)
  }
  // 圆的信息
  if (ent instanceof McDbCircle) {
    MxFun.acutPrintf(\`\\n                圆心 点， X= \${ent.center.x.toFixed(4)}  Y= \${ent.center.y.toFixed(4)}  Z= \${ent.center.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                半径  \${ent.radius.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                周长 \${ent.getLength().val.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                面积 \${(Math.PI * ent.radius * ent.radius).toFixed(4)}\`)
  }

  // 椭圆的信息
  if (ent instanceof McDbEllipse) {
    // 得到椭圆的半轴长度
    const radius1 = ent.majorAxis.length()
    const radius2 = ent.minorAxis.length()
    // 是否是椭圆 为false表示是椭圆弧
    const isEllipse = ent.startAngle === 0 && ent.endAngle === 2 * Math.PI
    if (isEllipse) {
      const calculateEllipseCircumference = (radius1: number, radius2: number) => {
        const h = Math.pow((radius1 - radius2), 2) / Math.pow((radius1 + radius2), radius2);
        const circumference = Math.PI * (radius1 + radius2) * (1 + (3 * h) / (10 + Math.sqrt(4 - 3 * h)));
        return circumference;
      }
      MxFun.acutPrintf(\`\\n                               面积: \${(Math.PI * radius1 * radius2).toFixed(4)}\`)
      MxFun.acutPrintf(\`\\n                               圆周: \${calculateEllipseCircumference(radius1, radius2).toFixed(4)}\`)
    }
    else {
      // 计算椭圆弧的长度
      const arcLengthOfEllipse = (a: number, b: number, theta1: number, theta2: number, numSteps: number) => {
        // a: 长半轴
        // b: 短半轴
        // 定义被积函数
        const integrand = function (theta: number) {
          return Math.sqrt(a * a * Math.sin(theta) * Math.sin(theta) + b * b * Math.cos(theta) * Math.cos(theta));
        };

        // 使用复合辛普森法则进行数值积分
        let integral = 0;
        const stepSize = (theta2 - theta1) / numSteps;
        for (let i = 0; i <= numSteps; i++) {
          const theta = theta1 + i * stepSize;
          if (i === 0 || i === numSteps) {
            integral += integrand(theta);
          } else if (i % 2 === 0) {
            integral += 2 * integrand(theta);
          } else {
            integral += 4 * integrand(theta);
          }
        }

        integral *= stepSize / 3;
        return Math.abs(integral);
      }

      MxFun.acutPrintf(\`\\n                               长度: \${arcLengthOfEllipse(radius1, radius2, ent.startAngle, ent.endAngle, 30).toFixed(4)}\`)
    }
    MxFun.acutPrintf(\`\\n                              中心点: X = \${ent.center.x.toFixed(4)} , Y = \${ent.center.y.toFixed(4)}   , Z = \${ent.center.z.toFixed(4)}\`)
    // 判断哪个是半轴长度较长的轴
    const isMaxAxis = radius1 > radius2
    const maxAxis = isMaxAxis ? ent.majorAxis : ent.minorAxis
    const minAxis = isMaxAxis ? ent.minorAxis : ent.majorAxis
    MxFun.acutPrintf(\`\\n                               长轴: X = \${maxAxis.x.toFixed(4)}  , Y = \${maxAxis.y.toFixed(4)}  , Z = \${maxAxis.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                               短轴: X = \${minAxis.x.toFixed(4)}  , Y = \${minAxis.y.toFixed(4)}  , Z = \${minAxis.z.toFixed(4)}\`)
    // 椭圆弧的其他信息
    if (!isEllipse) {
      // 计算椭圆弧的起点和端点
      const calculateEllipseEndpoints = (center: McGePoint3d, v1: McGeVector3d, v2: McGeVector3d, theta1: number, theta2: number) => {
        // 椭圆中心坐标
        const cx = center.x;
        const cy = center.y;

        // 主轴向量
        const vx1 = v1.x;
        const vy1 = v1.y;

        //  副轴向量
        const vx2 = v2.x;
        const vy2 = v2.y;

        // 计算椭圆的起始点和结束点
        const alpha = Math.atan2(vy1, vx1)

        const a = Math.sqrt(vx1 * vx1 + vy1 * vy1);  // 长轴半径
        const b = Math.sqrt(vx2 * vx2 + vy2 * vy2);  // 短轴半径
        // 根据角度计算起始点和结束点
        const startEndpointX = cx + a * Math.cos(theta1) * Math.cos(alpha) - b * Math.sin(theta1) * Math.sin(alpha);
        const startEndpointY = cy + a * Math.cos(theta1) * Math.sin(alpha) + b * Math.sin(theta1) * Math.cos(alpha);
        const endEndpointX = cx + a * Math.cos(theta2) * Math.cos(alpha) - b * Math.sin(theta2) * Math.sin(alpha);
        const endEndpointY = cy + a * Math.cos(theta2) * Math.sin(alpha) + b * Math.sin(theta2) * Math.cos(alpha);

        return {
          startPoint: new McGePoint3d(startEndpointX, startEndpointY),
          endPoint: new McGePoint3d(endEndpointX, endEndpointY)
        };
      }

      const { startPoint, endPoint } = calculateEllipseEndpoints(ent.center, ent.majorAxis, ent.minorAxis, ent.startAngle, ent.endAngle)
      MxFun.acutPrintf(\`\\n                               起点: X = \${startPoint.x.toFixed(4)} , Y = \${startPoint.y.toFixed(4)}  , Z = \${startPoint.z.toFixed(4)}\`)
      MxFun.acutPrintf(\`\\n                               端点: X = \${endPoint.x.toFixed(4)} , Y = \${endPoint.y.toFixed(4)}  , Z = \${endPoint.z.toFixed(4)}\`)
      MxFun.acutPrintf(\`\\n                             起点角度: \${THREE.MathUtils.radToDeg(ent.startAngle).toFixed(0)}\`)
      MxFun.acutPrintf(\`\\n                             端点角度: \${THREE.MathUtils.radToDeg(ent.endAngle).toFixed(0)}\`)
    }
    MxFun.acutPrintf(\`\\n                             半径比例: \${ent.radiusRatio.toFixed(4)}\`)
  }

  // 填充对象信息
  if(ent instanceof McDbHatch) {
    const patternName =  ent.patternName()
    MxFun.acutPrintf(\`\\n                 填充图案 \${patternName}\`)
    MxFun.acutPrintf(\`\\n                 图案填充比例    \${ent.patternScale.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                 图案填充角度      \${THREE.MathUtils.radToDeg(ent.patternAngle).toFixed(0)}\`)
    const pl = new McDbPolyline()
    const pls: McDbPolyline[] = []
    pl.isClosed = true
    for (let index = 0; index < ent.numLoops; index++) {
      const { vertices, bulges } = ent.getLoopAt(index)
      vertices.forEach((pt, index)=> {
        const bulge = bulges[index]
        pl.addVertexAt(pt, Number(bulge.toFixed(14)))
      })
      pls.push(pl)
      MxCpp.getCurrentMxCAD().drawEntity(pl)
    }
    const totalArea = pls.reduce((totalArea, pl)=> totalArea + pl.getArea().val, 0)
    MxFun.acutPrintf(\`\\n                 面积      \${totalArea.toFixed(4)}\`)
  }

  // 单行文字信息
  if(ent instanceof McDbText) {
    MxFun.acutPrintf(\`\\n              样式 = "\${ent.textStyle}"\`)
    MxFun.acutPrintf(\`\\n                起点 点， X=  \${ent.position.x.toFixed(4)}  Y= \${ent.position.y.toFixed(4)}  Z=   \${ent.position.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                高度    \${ent.height.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                文字 \${ent.textString}\`)
    MxFun.acutPrintf(\`\\n                旋转 角度    \${ent.rotation.toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n                宽度 比例因子    \${ent.widthFactor.toFixed(4)}\`)
  }
  // 多行文字信息
  if(ent instanceof McDbMText) {
    MxFun.acutPrintf(\`\\n              样式 = "\${ent.textStyle}"\`)
    MxFun.acutPrintf(\`\\n位置:         X=  \${ent.location.x.toFixed(4)}  Y=   \${ent.location.y.toFixed(4)}  Z=   \${ent.location.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n宽度:           \${ent.width.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n法向:         X=   \${ent.normal.x.toFixed(4)}  Y=   \${ent.normal.y.toFixed(4)}  Z=   \${ent.normal.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n旋转:                 \${ent.rotation.toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n文字高度:        \${ent.textHeight.toFixed(4)}\`)

    MxFun.acutPrintf(\`\\n附着:        \${getAttachmentName(McDb.AttachmentPoint[ent.attachment])}\`)
    MxFun.acutPrintf(\`\\n内容:        \${ent.contents}\`)
  }
  // 光栅图片信息
  if(ent instanceof McDbRasterImage) {
    const imgDef = ent.imageDefId().getMcDbRasterImageDef()
    const getFileNameFromPath = (path: string)=> {
      return path.split('/').pop().split('\\\\').pop();
    }
    MxFun.acutPrintf(\`\\n图像:                   \${getFileNameFromPath(imgDef.sourceFileName)}\`)

    const getClipBoundaryType = (ent: McDbRasterImage)=> {
      const type = ent.clipBoundaryType()
      if(type === McDb.ClipBoundaryType.kInvalid) return "无效"
      if(type === McDb.ClipBoundaryType.kPoly) return "多边形"
      if(type === McDb.ClipBoundaryType.kRect) return "矩形"
    }
    MxFun.acutPrintf(\`\\n剪裁边界类型:      \${getClipBoundaryType(ent)}\`)
    const clipBoundary =  ent.clipBoundary()
    MxFun.acutPrintf(\`\\n边界点数目: \${clipBoundary.length()}\`)
    ent.clipBoundary().forEach((pt)=> {
      MxFun.acutPrintf(\`\\n       位于点，X=   \${pt.x.toFixed(4)}, Y=   \${pt.y.toFixed(4)}, Z=   \${pt.z.toFixed(4)}\`)
    })
  }

  // 图块信息
  if(ent instanceof McDbBlockReference) {
    MxFun.acutPrintf(\`\\n块名:               "\${ent.blockName}"\`)
    MxFun.acutPrintf(\`\\n插入点:             X= \${ent.position.x.toFixed(4)}, Y=   \${ent.position.y.toFixed(4)}, Z=   \${ent.position.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\nX 比例因子:         \${ent.scaleFactors.x.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\nY 比例因子:         \${ent.scaleFactors.y.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n  旋转角度:         \${ent.rotation.toFixed(0)}\`)
    MxFun.acutPrintf(\`\\nZ 比例因子:         \${ent.scaleFactors.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\nZ 比例因子:         \${ent.scaleFactors.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n  缩放比例:         \${ent.getScale().toFixed(4)}\`)
  }

  // 标注信息
  if(ent instanceof McDbDimension) {
    MxFun.acutPrintf(\`\\n文字位置:           X= \${ent.textPosition.x.toFixed(4)} Y= \${ent.textPosition.y.toFixed(4)} Z= \${ent.textPosition.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n是否使用的默认文字位置:           \${ent.isUsingDefaultTextPosition()}\`)
    MxFun.acutPrintf(\`\\n高度:          \${ent.elevation.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n文本内容:       \${ent.dimensionText}\`)
    MxFun.acutPrintf(\`\\n文本旋转角度:   \${THREE.MathUtils.radToDeg(ent.textRotation).toFixed(0)}\`)
    const dimStyle = ent.dimensionStyle.getMcDbDimStyleTableRecord()
    MxFun.acutPrintf(\`\\n标注样式:       \${dimStyle.name}\`)
    MxFun.acutPrintf(\`\\n文字附着:      \${getAttachmentName(McDb.AttachmentPoint[ent.textAttachment])}\`)
    MxFun.acutPrintf(\`\\n水平旋转角度:   \${THREE.MathUtils.radToDeg(ent.horizontalRotation).toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n水平旋转角度:   \${THREE.MathUtils.radToDeg(ent.horizontalRotation).toFixed(0)}\`)
  }
  MxFun.acutPrintf("\\n命令")
}

`;function BN(t){return t.replace(/[\u00A0\u1680\u2000-\u200D\u202F\u205F\u3000]/g," ")}const OM=t=>{const n=/\/\/{24}[\s\S]*\/\/{24}/g;let e=t.replace(n,"");return e=BN(e),e};(t=>{t.forEach(n=>{n.code=OM(n.code)}),t.push({type:"命令实现",name:"list 命令",code:OM(LN)})})(LM);let _o;class FN extends A.MxCADPluginBase{constructor(){super(),_o&&_o.isMxCADAppLib()||(this.map_default_data=WF()),this.sampleCode=LM}}const{showModal:NN,hideModal:uc,showTools:ON}=Up();function zN(){return re(this,null,function*(){NN({title:"My Test Draw",text:"测试Modal",oncancel:()=>{uc()},onsubmit:()=>{uc()},ongetallentity:()=>{uc(),Ct.MxFun.sendStringToExecute("TestGetAllEntity")},ondrawline:()=>{uc(),Ct.MxFun.sendStringToExecute("Mx_Circle")},docommand:t=>{uc(),Ct.MxFun.sendStringToExecute(t)}})})}function UN(){return re(this,null,function*(){ON({title:"My Extension Tools",text:"扩展工具",oncancel:()=>{uc()},docommand:t=>{uc(),Ct.MxFun.sendStringToExecute(t)}})})}const zM=document.createElement("div");document.body.appendChild(zM),k.createApp(H4).mount(zM),q4(),MxPluginContext.on("databaseLayerUpdate",()=>{console.log("数据库图层数据更新")}),Ct.MxFun.setloadImageFuction((t,n,e)=>t.slice(-4)=="tiff"||t.slice(-3)=="tif"?(new A.MxTIFFLoader().load(t,n,e),1):0),Ct.MxFun.onInitSync(()=>new Promise(t=>{t(!0)})),Ct.MxFun.on("mxcadApplicationStart",t=>{_o=t,_o.init(new FN)}),Ct.MxFun.on("mxcadApplicationInitMap",()=>{qF(_o.mxmap)}),Ct.MxFun.on("mxcadApplicationStartCreatingMxCADObject",t=>{let n=t.mxdraw;n.setViewMovementMethod(!0),n.on("openFileComplete",()=>{console.log("MxTip:openFileComplete ")}),n.addControlsEvent("mousedown",e=>{let i=e.offsetX,s=e.offsetY,a=n.viewCoord2Cad(i,s,0);return console.log("mousedown:",a),0})}),Ct.MxFun.on("mxcadApplicationCreatedMxCADObject",t=>{if(_o.isMxCADAppLib())return;let n=_o.getServerConfig();A.MxCpp.App.addNetworkLoadingFont(n.font||["txt.shx","simplex.shx","gdt.shx","aaa.shx","ltypeshp.shx","complex.shx"]),A.MxCpp.App.addNetworkLoadingBigFont(n.bigFont||["hztxt.shx","gbcbig.shx"]),n.trueTypeFont?A.MxCpp.App.addNetworkLoadingTrueTypeFont(n.trueTypeFont[0],n.trueTypeFont[1],n.trueTypeFont[2]):A.MxCpp.App.addNetworkLoadingTrueTypeFont(["syadobe"],["思原黑体"],["syadobe.otf"]);let e=t.mxcad;e.setAttribute({DisplayPrecision:35}),e.on("selectChange",a=>{if(console.log("selectChange"),a.length==0)return;let o=a[0],r=o.getMxDbEntity();if(r!==null){console.log(r.getTypeName()),r instanceof Ct.MxDbRectBoxLeadComment&&console.log(r.text);return}let u=o.getMcDbEntity();u!==null&&(console.log(u.objectName),u instanceof A.McDbText?console.log(u.textString):u instanceof A.McDbBlockReference&&u.getAllAttribute().forEach(f=>{let d=f.getMcDbEntity();console.log(d.textString),console.log(d.tag)}))}),A.MxCpp.PropertiesWindow.onEvent_getProperties(a=>{let o=a.getMcDbEntity();if(!o)return[];let r=o.getxDataDouble("DN"),u=o.getxDataDouble("LEN"),l=[];return r.ret&&l.push({sVarName:"DN",iVarType:A.MxPropertiesWindowCustomValueType.kDouble,val:r.val,isOnlyRead:!1}),u.ret&&l.push({sVarName:"LEN",iVarType:A.MxPropertiesWindowCustomValueType.kDouble,val:u.val,isOnlyRead:!1}),l}),A.MxCpp.PropertiesWindow.onEvent_setProperties((a,o)=>{let r=a.getMcDbEntity();r&&(o.sVarName=="DN"?r.setxDataDouble("DN",o.val):o.sVarName=="LEN"&&r.setxDataDouble("LEN",o.val))});let i,s;A.MxCpp.getCurrentMxCAD().on("selectChange",a=>{var r;if(a.length===0)return;const o=(r=a[0])==null?void 0:r.getMcDbEntity();if(o&&o instanceof A.McDbCustomEntity&&(i==null?void 0:i.getHandle())===o.getHandle()){const u=o.getTypeName();ps.value=o.clone(),u==="McDbTestRoughness"?(fs.value="RoughnessDialog",Ho.showDialog(!0,{title:dt("表面粗糙度")}).then(f=>re(this,[f],function*({data:l,isCanceled:h}){var d;if(!h){const p=l.roughnessData,b=o.clone();b.rougMarkType=p.selectSymbolNum,b.textLeftStr=p.textLeftStr,b.rougCornerType=p.rougCornerType==="无"?"":p.rougCornerType,b.isRoungSameRequire=p.isRoungSameRequire,b.isShowMostSymbols=p.isShowMostSymbols;const v=(d=p.textUpStr)==null?void 0:d.filter(x=>x!="");b.textUpStr=JSON.parse(JSON.stringify(v)).reverse(),b.textDownStr=p.textDownStr.filter(x=>x!=""),b.isAddRougLongLine=p.isAddLongLine,o.erase(),e.drawEntity(b),e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()}}))):u==="McDbTestWeldingSymbol"?(fs.value="WeldingSymbolDialog",Ho.showDialog(!0,{title:dt("焊接符号")}).then(f=>re(this,[f],function*({data:l,isCanceled:h}){if(!h){const d=l.formData,p=o;if(d.specialSymbol.length&&p.setSpecialSymbol(d.specialSymbol),d.rightDim1||d.rightDim2){const b=[_r.top,_r.down],v=[];b.forEach(x=>{const w=d.rightDim1.filter(D=>D.position===x)[0],M=d.rightDim2.filter(D=>D.position===x)[0],E=w.content&&M.content?"×":"";v.push({position:x,content:w.content+E+M.content})}),p.setRightDim(v)}p.setSuppleSymbol(d.suppleSymbol),p.setLeftDim(d.leftDim),p.setTopDim(d.topDim),p.setAuxiliarySymbol(d.auxiliarySymbol),p.setBaseSymbok(d.basicSymbol),p.setIntWeldSeam(d.intWeldSeam),p.dottedLinePos=d.dottedLinePos,p.weldingSymbolInfo=d.weldingSymbolInfo.replace(/\n/g,"\\P"),o.erase(),e.drawEntity(p),e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()}}))):u==="MxDbGeometricTolerances"&&(fs.value="GemoetricToleranceDialog",Ho.showDialog(!0,{title:dt("形位公差")}).then(f=>re(this,[f],function*({data:l,isCanceled:h}){if(!h){const d=l.formData,p=o;p.dimToleranceContents=(d==null?void 0:d.dimToleranceContents)||[],p.isShowFullWeekSymbol=(d==null?void 0:d.isShowFull)||!1,p.dimNotesDown=(d==null?void 0:d.downDim)||"",p.dimNotesUp=(d==null?void 0:d.topDim)||"",o.erase(),e.drawEntity(p),e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()}})))}i=o,s&&clearTimeout(s),s=setTimeout(()=>{i=null},300)})});function ll(){return _o}function wo(t){return"x="+t.x+",y="+t.y+",z="+t.z}function VN(){window.open("https://demo.mxdraw3d.com:3562/MxCADCode.7z")}function jN(){window.open("https://demo.mxdraw3d.com:3562/MxDrawCloudServer1.0TryVersion.7z")}function rh(t){var n=window.location.href;return n.indexOf("?")!=-1&&(n=n.replace(/(\?|#)[^'"]*/,"")),`${n}?map=true&maptype=${t}`}function GN(){window.open(rh("gdslwzj"))}function HN(){window.open(rh("google"))}function WN(){window.open(rh("gdyx"))}function qN(){window.open(rh("tdtsl"))}function XN(){window.open(rh("bdsl"))}function YN(){window.open(rh("geoq"))}function KN(){A.MxCpp.getCurrentMxCAD().setViewBackgroundColor(255,255,255),Ct.MxFun.callEvent("updateBackgroundColor",new A.McCmColor(255,255,255))}function UM(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择要需要开启自定义属性的对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity();A.MxCpp.PropertiesWindow.setEntitySupportCustom(n),e.setxDataDouble("DN",100),e.setxDataDouble("LEN",2e3)})}function ZN(){A.MxCpp.getCurrentMxCAD().openWebFile("http://localhost:1337/mxcad/file/a9cbed3d3a351b79f24484e87bd78338.DWG.mxweb")}function JN(){return re(this,null,function*(){})}function $N(){return re(this,null,function*(){let t=new A.MxCADUiPrEntity;t.setMessage(dt("选择要隐藏的对象"));let n=yield t.go();if(!n.isValid())return;let e=n.getMcDbEntity(),i=A.MxCpp.getCurrentMxCAD(),o=i.getDatabase().getLayerTable().get(e.layer).getMcDbLayerTableRecord();o!==null&&(o.isOff=!0,i.updateLayerDisplayStatus(),i.updateDisplay())})}function QN(){return window.location.origin+window.location.pathname}let Wg;function tO(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定插入点:"));let n=yield t.go();if(!n)return;let e=A.MxCpp.getCurrentMxCAD(),i=QN()+"mxcad.jpg";e.loadImage(i,s=>{if(!s){console.log("loadImage failed");return}let a=e.mxdraw.viewCoordLong2Cad(100),o=s.height/s.width*a,r=0;Wg=e.drawImage(n.x,n.y,a,o,r,i,!0,s.width,s.height);let u=Wg.getMcDbEntity(),l=A.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder();u&&(u.drawOrder=l.maxDrawOrder+1),e.updateDisplay()})})}function eO(){if(!Wg)return;let t=A.MxCpp.getCurrentMxCAD(),n="https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg";t.loadImage(n,e=>{if(!e){console.log("loadImage failed");return}let i=t.addImageDefine(n,"winter-7593872_960_720.jpg",!0),s=Wg.getMcDbEntity();s&&s.setImageDefId(i),t.updateDisplay()})}function nO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=new A.MxCADUiPrPoint,e=yield n.go();if(e==null)return;n.setBasePt(e);let i=yield n.go();if(i==null)return;let s=t.drawLine(e.x,e.y,i.x,i.y);t.addCurrentSelect(s)})}let VM=0;function rO(){return re(this,null,function*(){VM+=Math.PI*.5,A.MxCpp.getCurrentMxCAD().zoomAngle(VM)})}function iO(){A.MxCpp.getCurrentMxCAD().zoomCenter(900,900)}function oO(){let t=A.MxCpp.getCurrentMxCAD();t.newFile();let n=new A.McDbPolyline;n.setType(A.McDb.PolylineType.k3dPolyline),n.addVertexAt(new A.McGePoint3d(100,100,100)),n.addVertexAt(new A.McGePoint3d(200,100,500)),n.addVertexAt(new A.McGePoint3d(300,400,200)),t.drawEntity(n),t.zoomAll(),t.updateDisplay()}function sO(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定一点:"));let n=yield t.go();if(!n)return;const e=new A.MxCADUiPrAngle;e.setMessage(dt("指定夹角")),e.setKeyWords(""),e.setBasePt(n);const i=yield e.go();console.log(i)})}function aO(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定一点:")),t.setOffsetInputPostion(!0);let n=yield t.go();if(!n)return;t.setBasePt(n),t.setUseBasePt(!0),t.setMessage(dt(" 指定二点:"));let e=yield t.go();e&&A.MxCpp.getCurrentMxCAD().drawLine(n.x,n.y,e.x,e.y)})}function lO(){return re(this,null,function*(){let t=new A.MxCADSelectionSet;if(!(yield t.userSelect("选择要做成组的对象:"))||t.count()==0)return;A.MxCpp.getCurrentMxCAD().getDatabase().CreateGroup(t.getIds())})}function cO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=new A.MxCADUiPrPoint;n.setMessage(dt(" 指定第一点:"));let e=yield n.go();if(!e)return;n.setMessage(dt(" 指定第二点:")),n.setBasePt(e);let i=yield n.go();if(!i)return;let s=i.sub(e);s.rotateBy(Math.PI*.5).normalize().mult(Ct.MxFun.screenCoordLong2Doc(10));let a=e.clone().addvec(s),o=e.clone().subvec(s),r=i.clone().addvec(s),u=i.clone().subvec(s),l=new A.McGeBound([a,o,r,u]),h=l.minPoint,f=l.maxPoint,d=new A.MxCADSelectionSet;d.crossingSelect(h.x,h.y,f.x,f.y,new A.MxCADResbuf([A.DxfCode.kEntityType,"LINE,ARC,CIRCLE,LWPOLYLINE"]));let p=Ct.MxFun.screenCoordLong2Doc(5),b=new A.McDbLine(e,i);d.forEach(v=>{let w=v.getMcDbEntity().IntersectWith(b,A.McDb.Intersect.kOnBothOperands);if(w.length()!=0){let M=w.at(0);t.drawCircle(M.x,M.y,p)}})})}Ct.MxFun.on("mxcadApplicationCreatedMxCADObject",t=>{if(xO(),_o.isMxCADAppLib())return;t.mxcad.on("selectChange",e=>{if(e.length==0)return;let i=e[0],s=i.getMxDbEntity();if(s!==null){console.log(s.getTypeName()),s instanceof Ct.MxDbRectBoxLeadComment&&console.log(s.text);return}let a=i.getMcDbEntity();a!==null&&(console.log(a.objectName),a instanceof A.McDbText?console.log(a.textString):a instanceof A.McDbBlockReference&&a.getAllAttribute().forEach(u=>{let l=u.getMcDbEntity();console.log(l.textString),console.log(l.tag)}))}),A.MxCpp.PropertiesWindow.onEvent_getProperties(e=>{let i=e.getMcDbEntity();if(!i)return[];let s=i.getxDataDouble("DN"),a=i.getxDataDouble("LEN"),o=[];return s.ret&&o.push({sVarName:"DN",iVarType:A.MxPropertiesWindowCustomValueType.kDouble,val:s.val,isOnlyRead:!1}),a.ret&&o.push({sVarName:"LEN",iVarType:A.MxPropertiesWindowCustomValueType.kDouble,val:a.val,isOnlyRead:!1}),console.log(o),o}),A.MxCpp.PropertiesWindow.onEvent_setProperties((e,i)=>{let s=e.getMcDbEntity();s&&(i.sVarName=="DN"?s.setxDataDouble("DN",i.val):i.sVarName=="LEN"&&s.setxDataDouble("LEN",i.val),console.log(i))})});function jM(t){return{center:t.getCenter(),zoom:t.getZoom(),pitch:t.getPitch(),bearing:t.getBearing()}}function GM(t,n){t.fitBounds(n,{padding:40,maxZoom:15,duration:0})}function HM(t,n){n&&t.flyTo({center:n.center,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,duration:0})}function uO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=t.mxdraw.isMapBox(),e=yield A.MxCADUtility.getCorner("选择截图范围",void 0,void 0,!1,!0);if(!e)return;let i=Math.abs(e.pt1.x-e.pt2.x),s=Math.abs(e.pt1.y-e.pt2.y);if(i<1||s<1)return;let a=200,o=a*s/i,r;if(n){const{mxmap:u}=_o;r=jM(u.getMapbox()),GM(u.getMapbox(),[u.cadTolnglat(e.pt1.toVector3()),u.cadTolnglat(e.pt2.toVector3())])}t.mxdraw.createCanvasImageData(u=>{if(n){const{mxmap:h}=_o;HM(h.getMapbox(),r)}let l=window.open();l!=null&&l.document.write('<img src="'+u+'"/>')},{width:a,height:o,range_pt1:e.pt1.toVector3(),range_pt2:e.pt2.toVector3()})})}function hO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=t.mxdraw.isMapBox(),e=yield A.MxCADUtility.getCorner("选择截图范围",void 0,void 0,!1,!0);if(!e)return;let i=Math.abs(e.pt1.x-e.pt2.x),s=Math.abs(e.pt1.y-e.pt2.y);if(i<1||s<1)return;let a=1e3,o=a*s/i,r=t.getViewBackgroundColor();t.setViewBackgroundColor(16777215),t.setAttribute({ShowCoordinate:!1});let u=new A.MxModifyColor,l=new A.McCmColor;l.setColorIndex(A.ColorIndexType.kWhite),u.Do(A.MxCpp.getCurrentDatabase(),l);let h;if(n){const{mxmap:f}=_o;h=jM(f.getMapbox()),GM(f.getMapbox(),[f.cadTolnglat(e.pt1.toVector3()),f.cadTolnglat(e.pt2.toVector3())])}t.mxdraw.createCanvasImageData(f=>{if(n){const{mxmap:p}=_o;HM(p.getMapbox(),h)}t.setViewBackgroundColor(r),t.setAttribute({ShowCoordinate:!0}),u.DoRestore();let d=window.open();d!=null&&new A.MxCanvas2Image(d.document).saveAsImage(t.mxdraw.getCanvas(),void 0,void 0,"bmp")},{type:"image/bmp",width:a,height:o,range_pt1:e.pt1.toVector3(),range_pt2:e.pt2.toVector3()})})}function dO(){return re(this,null,function*(){for(;;){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定一点:")),t.setOffsetInputPostion(!0),t.clearLastInputPoint();let n=yield t.go();if(!n)return;let e=Ct.MxFun.getCurrentDraw();e.getTempMarkDraw().drawCircleMark(n.toVector3(),e.viewCoordLong2Cad(50),16711680),e.updateDisplay()}})}function fO(){return re(this,null,function*(){const t=new A.MxCADUiPrPoint;t.setMessage(dt(" 指定第一点:"));let n=yield t.go();if(!n)return;let e=yield A.MxCADUtility.getCorner(" 指定第二点:",n);if(!e)return;let i=e.pt2,s=new A.McGePoint3dArray;s.append(n),s.append(new A.McGePoint3d(n.x,i.y,0)),s.append(new A.McGePoint3d(i.x,i.y,0)),s.append(new A.McGePoint3d(i.x,n.y,0));let a=new A.McDbWipeout;a.setVertices(s),a=A.MxCpp.getCurrentMxCAD().drawEntity(a).getMcDbObject();let u=A.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder().maxDrawOrder+1;a.drawOrder=u})}function pO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=t.getDatabase();n.setCurrentlyTrueColor(new A.McCmColor(255,100,0)),n.setCurrentlyLineWeight(A.McDb.LineWeight.kLnWt030),t.showLineWeight(!0)})}function mO(){return re(this,null,function*(){let t=yield A.MxCADUtility.selectEnt("选择PL线",new A.MxCADResbuf([A.DxfCode.kEntityType,"LWPOLYLINE"]));if(t.length==0)return;let n=t[0],e=n.getMcDbEntity();if(e&&e instanceof A.McDbPolyline){let i=e,s=i.getBoundingBox();if(!s.ret)return;let a=i.getSamplePoints(.1).GetPoints();if(a.length()<3)return;let o=[],r=new A.MxCADSelectionSet;r.crossingSelect(s.minPt.x,s.minPt.y,s.maxPt.x,s.maxPt.y),r.forEach(u=>{if(u.id==n.id)return;let l=u.getMcDbEntity();if(l){let h=l.getBoundingBox();if(!h.ret)return;let f=h.minPt.clone().addvec(h.maxPt.sub(h.minPt).mult(.5));A.MxCADUtility.pointInPolygon(a,f.x,f.y)&&o.push(u)}}),console.log(o)}})}function gO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=yield A.MxCADUtility.selectEnt("xxxx");if(n.length==0)return;let i=n[0].getMcDbEntity();if(i){let s=i.explode();if(s.GetCount()==0)return;let a=s.GetCount();for(let o=0;o<a;o++){let r=s.AtObject(o).val;r instanceof A.McDbEntity&&t.drawEntity(r)}i.erase()}})}function yO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD();const n=new A.MxCADUiPrPoint;n.setMessage(dt(" 指定一点:"));let e=yield n.go();if(!e)return;n.setBasePt(e),n.setUseBasePt(!0),n.setMessage(dt(" 指定二点:"));let i=yield n.go();if(!i)return;let s=new A.McDbPolyline;s.addVertexAt(e),s.addVertexAt(i),s.constantWidth=t.mxdraw.viewCoordLong2Cad(10),s.trueColor=new A.McCmColor(255,255,255,160),t.drawEntity(s),t.updateDisplay()})}function bO(){return re(this,null,function*(){let t=yield A.MxCADUtility.selectEnt(dt("选择图案填充对象"));if(t.length==0)return;let e=t[0].getMcDbEntity();e&&e instanceof A.McDbHatch&&e.scalePattern(2)})}function vO(){return re(this,null,function*(){let t=A.MxCpp.getCurrentMxCAD(),n=t.mxdraw.viewCoordLong2Cad(10),e=t.database,i=t.getSysVarDouble("LTSCALE");n=n/i;let s=e.getLinetypeTable(),a="MyTest1",o=s.get(a);if(o.isNull()){let f=new A.McDbLinetypeTableRecord;f.numDashes=2,f.setDashLengthAt(0,n),f.setDashLengthAt(1,-n),f.name=a,o=s.add(f)}const r=new A.MxCADUiPrPoint;r.setMessage(dt(" 指定一点:"));let u=yield r.go();if(!u)return;r.setBasePt(u),r.setUseBasePt(!0),r.setMessage(dt(" 指定二点:"));let l=yield r.go();if(!l)return;let h=new A.McDbLine;h.startPoint=u,h.endPoint=l,h.linetypeId=o,t.drawEntity(h)})}function xO(){Ct.MxFun.addCommand("My_PluginTest",zN),Ct.MxFun.addCommand("My_Extool",UN),Ct.MxFun.addCommand("Mx_Open_DemoCode",VN),Ct.MxFun.addCommand("Mx_Open_DevInstall",jN),Ct.MxFun.addCommand("Mx_Open_Map_gdslwzj",GN),Ct.MxFun.addCommand("Mx_Open_Map_gdyx",WN),Ct.MxFun.addCommand("Mx_Open_Map_tdtsl",qN),Ct.MxFun.addCommand("Mx_Open_Map_bdsl",XN),Ct.MxFun.addCommand("Mx_Open_Map_geoq",YN),Ct.MxFun.addCommand("Mx_Open_Map_googlecn",HN),Ct.MxFun.addCommand("Mx_ViewBackgroundColor",KN),Ct.MxFun.addCommand("Mx_TestExProp",UM),Ct.MxFun.addCommand("Mx_Test_OpenFile",ZN),Ct.MxFun.addCommand("Mx_Test_GetFile",JN),Ct.MxFun.addCommand("Mx_TestExProp",UM),Ct.MxFun.addCommand("Mx_SelectEntitHideLayer",$N),Ct.MxFun.addCommand("MxTest_TestAddCurrentSelect",nO),Ct.MxFun.addCommand("MxTest_TestSetViewAngle",rO),Ct.MxFun.addCommand("MxText_ZoomCenter",iO),Ct.MxFun.addCommand("MxTest_Map_Download",XF),Ct.MxFun.addCommand("Mx_Test_DrawImage",tO),Ct.MxFun.addCommand("Mx_Test_ModifyImage",eO),Ct.MxFun.addCommand("Mx_Test_Draw3DPolyline",oO),Ct.MxFun.addCommand("MxTemp_Test",sO),Ct.MxFun.addCommand("Mx_Test_IntersectWith",cO),Ct.MxFun.addCommand("Mx_Test_OffsetIn_DrawLine",aO),Ct.MxFun.addCommand("Mx_Test_CreateGroup",lO),Ct.MxFun.addCommand("Mx_ScreenToJpg",uO),Ct.MxFun.addCommand("Mx_ScreenToBmp",hO),Ct.MxFun.addCommand("Mx_Test_DrawMarkCircle",dO),Ct.MxFun.addCommand("Mx_Test_Wipeout",fO),Ct.MxFun.addCommand("Mx_Test_SetCurrentlyDraw",pO),Ct.MxFun.addCommand("Mx_Test_FindPolygonEntitys",mO),Ct.MxFun.addCommand("Mx_Test_DrawTransparencyLine",yO),Ct.MxFun.addCommand("MxTest_Explode",gO),Ct.MxFun.addCommand("MxTest_LineRecord",vO),Ct.MxFun.addCommand("MxTest_ModifyPatternScale",bO),eT(),bT(),W8(),X8(),SR(),FR(),zR(),WR(),XR(),Mk(),Dk(),jR(),Nk(),sL(),IL(),YL(),cB(),MF(),SI(),NF(),_o.mxmap&&KF(Ct.MxFun.getCurrentDraw())}const _O=Object.freeze(Object.defineProperty({__proto__:null,default:{718:"Specify the first point of the output range:",719:"Specify the second point of the output range:",720:"Specify the first point:",721:"Specify the second point:",722:"Cloud wireframe starting point:",723:"End point of cloud wireframe:",724:"Drawing review annotation points:",725:"Click to start drawing cloud lines:",726:"Click to end drawing cloud lines again:",727:"Specify one point:",728:"Specify two points:",729:"Select object",730:"Specify the next point:",731:"\\Specify insertion base point",732:"Specify table insertion point:",733:"Specify insertion point:",734:"Specify insertion base point",735:"Select annotation object",736:"Please select the target text",737:"Specify a point inside the filling area:",738:"No closed area found",739:"Surface roughness",740:"Welding symbol",741:"Positional tolerance",742:"Select the object that needs to enable custom properties",743:"Select the object to hide",744:"Specify insertion point:",745:"Specify one point:",746:"Specify the angle",747:"Specify two points:",748:"Select pattern fill object",749:"Specify the first point:",750:"Specify the second point:",751:"Specify the second angle point:",752:"Specify the last point:",753:"Specify coordinate point:",754:"Specify annotation points:",755:"Please provide your approval comments",756:"Specify the starting point of the cloud wireframe",757:"Specify the termination point of the cloud wireframe",758:"Designated review icon annotation points",759:"Specify the first corner point:",760:"Specify the second corner point:",761:"Specify serial number location:",762:"Rotations Symbols",763:"Tag type",764:"Please select the circle to be marked:",765:"Please set positioning points, lines, arcs, or circles",766:"Drag to determine the annotation position",767:"Please specify or enter an angle",768:"weld symbol",769:"Please pick a positioning point, line, or arc",770:"Please specify the second point",771:"Please set the positioning point",772:"Please set the angle",773:"Please set positioning points, lines, or arcs",774:"Please set the lead turning point",775:"Drag to determine the positioning point",776:"Please specify the first point:",777:"Please specify the second point:",778:"Please select the target block object",779:"Please enter a new block name",780:"Select the block that needs to modify the base point",781:"Set base point",782:"Select the block that requires color modification",783:"Enter color index (0~256)",784:"Please select the source block",785:"Select the target block to brush:",786:"Select connection method",787:"Manually connect each line one by one",788:"Automatic batch connection",789:"Please select the block for the connection",790:"Set centerline length",791:"Select the target block to rotate:",792:"Set rotation angle",793:"Please set the zoom ratio",794:"Please set the selection range:",795:"Please select the target block",796:"Please set the statistical scope",797:"Specify table insertion point:",798:"Select target curve",799:"Specify the length annotation point",800:"Select Target Object",801:"Please select the target slope object",802:"Please set the height of the annotation text",803:"Specify slope annotation point",804:"Please select the target coordinate point",805:"Please specify the annotation location",806:"Specify start point",807:"Specify the endpoint",808:"Specify annotation direction",809:"Please set the text content",810:"Please select the first point of the area",811:"Please select the next point",812:"Please select the location for area annotation",813:"Please select corner 1 of the rectangle",814:"Please select corner 2 of the rectangle",815:"Please set the location for area annotation",816:"Please select a measurement point",817:"Please select a straight line",818:"Please set the position of the dimension line",819:"Please select an arc",820:"Please specify the position of the dimension line",821:"Please select a circular object",822:"Please specify the text location",823:"Please select the endpoint or arc of the line",824:"Please specify the position of the text",825:"Please select a continuous measurement label",826:"Please select the second straight line",827:"Please set the position for angle annotation",828:"Please enter the number of star shaped vertices:",829:"Specify the star center point:",830:"Please set the inner radius of the star shape:",831:"Specify the outer radius of the star shape:",832:"Please enter the width of the concave convex line<5>",833:"Please enter the height of the concave convex line as<10>",834:"Please click to confirm the starting point",835:"Please click to confirm the endpoint",836:"Please enter zigzag width<5>",837:"Please enter zigzag line height<10>",838:"Please enter rectangle width<5>",839:"Please enter rectangle height<10>",840:"Please click to confirm the center of the rectangle",841:"Please enter pipe diameter<10>",842:"Please enter the length of the outlet pipe<5>",843:"Please click to confirm the starting point",844:"Specify the starting point of the pipeline section",845:"Specify the endpoint of the sectional pipeline",846:"Select the direction of the pipeline arc",847:"the left",848:"the right side",849:"MODE",850:"straight bead",851:"Arc weld seam",852:"Please enter weld radius<5>",853:"Specify the second point of the arc",854:"Specify end point of arc",855:"Please enter width<25>",856:"Please enter height<15>",857:"Please enter staircase level<10>",858:"Please confirm the center position of the circle",859:"Please enter the radius of the circle",860:"Please enter insulation cotton width<5>",861:"Please enter insulation cotton height<10>",862:"Please click on the next point",863:"Please select the first line",864:"Please select the second line",865:"Please select the endpoint",866:"Please select the target rectangle",867:"Set the center point of the compass",868:"Set the radius of the compass",869:"Select prompt box pointing",870:"Specify the first point of the message box:",871:"Specify the second point of the message box:",872:"Set the message box to point to:",873:"Please set the reference character text",874:"Please set the text height",875:"Please set the benchmark position",876:"Please set positioning points, arcs, or lines",877:"Please set the symbol position",878:"Please set the center of the circle",879:"Please set the center of the gear circle",880:"Please set the gear radius",881:"Please set the centerline length to 10>",882:"Please select the first circle",883:"Please select the second circle",884:"Please set the top left corner point of the rectangle",885:"Please set the bottom right corner point of the rectangle",886:"Please set the fillet radius",887:"Please select the starting point of the polygon",888:"Please select polygon vertices",889:"Select object:",890:"Specify base point",891:"Specify the second point",892:"array",893:"exit",894:"give up",895:"Enter the number of items to be arranged in the array",896:"Select arc object",897:"Choose to copy rotated objects:",898:"Please specify the target point",899:"Please specify the rotation angle",900:"Select the object to be converted into a polygon",901:"Set the number of polygon edges",902:"Input Options",903:"Internally connected to a circle",904:"Externally cut to a circle",905:"Select the object whose color you want to modify",906:"Enter color index",907:"hide",908:"Hide Unselected",909:"show all",910:"Select the target object",911:"Specify to delete the first point of the box:",912:"Specify to delete the second point of the box:",913:"Select the entity that needs to be precisely deleted",914:"Please select an angle to copy the object",915:"Please enter the angle for copying quantity",916:"Please enter the base point for copying the angle",917:"Please enter the copying angle",918:"Please select vertex object",919:"Please select the copied object",920:"Please confirm the replication base point",921:"Please select the reference curve",922:"Select interrupt object",923:"Specify offset object",924:"Please enter the offset distance",925:"Specify the scaling object (select lines, polylines, arcs)",926:"Stretching to",927:"Select the object to modify the line type scale",928:"Please enter the line type ratio",929:"Please enter the array spacing",930:"Please select an arc",931:"Select sorting objects",932:"Specify the arrangement base point",933:"Select target polyline:",934:"Please enter rounded corner radius<5>",935:"Select fill object",936:"Please enter the fill ratio",937:"Please select the original fill shape",938:"Please click to fill any point inside the graphic",939:"Please select a line object",940:"Select equal division mode",941:"measure",942:"Divide",943:"Offset equal division",944:"Copy equally",945:"Please select offset equal division objects",946:"Please select to copy equally divided objects",947:"Please select the line segments that need to be divided equally",948:"Please set equal distances",949:"Please set the number of equal parts",950:"Please set the offset distance",951:"Please specify the offset point",952:"Please specify the replication base point",953:"Please specify the number of equal parts to be copied",954:"Please specify the endpoints for copying and dividing equally",955:"Please select the entity that requires rectangular scaling:",956:"Please specify corner 1 of the rectangle",957:"Please specify corner 2 of the rectangle",958:"Please choose to zoom in on the center point",959:"Please select the zoom in range",960:"Please set the magnification factor",961:"Please choose to enlarge the insertion point",962:"Please select a curve that needs to be broken",963:"Please select a break point on the curve",964:"Please enter the number of arrays",965:"Do you want to enable rotation",966:"correct",967:"deny",968:"Please select the graphics that require an array:",969:"Please select the center point of the array",970:"Please select a closed polygon!",971:"Please select the first point",972:"Please select the second point",973:"Please select the first closed polygon",974:"Please select the second closed polygon",975:"Please select two closed polygons",976:"Two polygons do not have overlapping edges!",977:"Please select the target polygon",978:"Please select the edges of the polygon to add vertices to",979:"Please set the position of the added vertices",980:"Please select the vertices of the polygon that need to be deleted",981:"Please select the edges of the polygon that need to be stretched",982:"Please specify the stretching position",983:"Please set the orientation of the frame to<N>",984:"horizontal",985:"longitudinal",986:"Please set the frame size to<4>",987:"Please set the position of the frame",988:"Specify cutting corner 1",989:"Specify cutting corner point 2",990:"Please set the starting point of the road",991:"Please set the next point",992:"Please select the target alignment line object (choose a line)",993:"Please select the target text object",994:"Select Text Object",995:"Please set the font height",996:"Please set the word width",997:"Please select the source text",998:"Please select the first text",999:"Please select the second text",1e3:"Please select the text that needs to be aligned",1001:"Please choose the alignment method",1002:"the left side",1003:"centre",1004:"the right side",1005:"Please select the alignment base point",1006:"Please select the text that needs to be reversed",1007:"Please select the text that needs to be filled with spaces",1008:"Please select a text object",1009:"Please enter underline width",1010:"Please set the underline distance",1011:"Please set an underline to extend the distance",1012:"Please select the operation option",1013:"capital letters",1014:"lowercase",1015:"sentence case ",1016:"Please select a numerical object",1017:"Please select a text insertion point",1018:"Select the scope to search for:",1019:"Please select the search mode",1020:"equal to",1021:"contain",1022:"The prefix is",1023:"The suffix is",1024:"Please enter keywords",1025:"Select the scope of operation:",1026:"Select operation mode",1027:"add",1028:"delete",1029:"Select operation location",1030:"prefix",1031:"suffix",1032:"Please enter the content",1033:"Please select text",1034:"Please select an arc",1035:"Please choose a text style",1036:"Please set the text extraction range",1037:"Download and open the demo code",1038:"Download development kit",1039:"Call the command to draw circular lines",1040:"Interactive drawing of straight lines",1041:"Add Layer",1042:"Get all layers",1043:"Get all text styles",1044:"Obtain all image blocks",1045:"Get all line types",1046:"Write extended data",1047:"Read extended data",1048:"Test inserting a block",1049:"Draw a straight line",1050:"arc ",1051:"circle",1052:"Draw PL line",1053:"Draw Fill",1054:"emoji",1055:"Draw an ellipse",1056:"Draw elliptical arcs",1057:"Draw multiline text",1058:"TABLE",1059:"Draw QR code",1060:"Insert stamp",1061:"Get all objects",1062:"Interactive selection of objects",1063:"Save MXWeb to the server",1064:"Obtain system variables",1065:"new sheet",1066:"White background color",1067:"Text search and positioning",1068:"Select entity to make blocks",1069:"Draw single line text",1070:"Select point filling",1071:"Set extended attributes",1072:"Draw alignment annotations",1073:"Drawing line annotation",1074:"angular",1075:"Modify object line type",1076:"Select hidden object layer",1077:"Add to current selection",1078:"Visual rotation",1079:"Write extension records",1080:"Get a Naming Dictionary",1081:"Add Text Style",1082:"Draw custom entities",1083:"Modify object color",1084:"The modified object is not visible",1085:"Modify object layer",1086:"Modify the display order of objects",1087:"Output PDF within the specified range",1088:"Draw an image",1089:"Read object extension dictionary",1090:"Draw 3D Polyline",1091:"Custom entity for line drawing text",1092:"Calculate intersection point",1093:"Modify Text Style",1094:"Offset input line drawing",1095:"Create Group",1096:"Screenshot JPG",1097:"Obtain the same text as the drawing",1098:"Specify the output range as dwg",1099:"Test drawing marker circle",1100:"Test Wipeout",1101:"create cutouts",1102:"Tolerance marking",1103:"Change all object colors",1104:"Cutting MXWeb",1105:"Set the current color line weight",1106:"Search for objects within a polygonal region",1107:"Smash objects",1108:"Draw semi transparent lines",1109:"Add line type",1110:"Modify the proportion of the pattern",1111:"Test Text Editing",1112:"Draw barcode",1113:"Screenshot BMP",1114:"Modify Tools",1115:"text tool",1116:"Drawing tools",1117:"Block Tool",1118:"Instrument",1119:"Annotation tool",1120:"Other tools",1121:"Multiple replication",1122:"Arc to Circle",1123:"Copy Rotation",1124:"Circular to Multilateral",1125:"Change color",1126:"Arc angle cutting",1127:"Temporary Hide",1128:"Box deletion",1129:"Angle copying",1130:"Vertex Copy",1131:"Intersection point interruption",1132:"double offset",1133:"Change the size of the circle",1134:"Linetype Scale",1135:"Telescoping",1136:"By arc array",1137:"PL rounded corner",1138:"PL line reverse",1139:"Obtain all linear objects",1140:"equal division",1141:"Rectangular scaling",1142:"interrupt",1143:"Cutting polygons",1144:"Merging Polygons",1145:"Add polygon vertices",1146:"Delete polygon vertices",1147:"Unilateral stretching of polygons",1148:"star shape",1149:"Concave convex line",1150:"jagged lines",1151:"Center rectangle",1152:"rounded rectangle",1153:"Circular centerline",1154:"pipe",1155:"Pipe cutting symbol",1156:"perpendicular bisector",1157:"staircase",1158:"solid circle",1159:"Thermal insulation cotton",1160:"Centerline",1161:"Opening a hole",1162:"message box",1163:"Reference symbol (1)",1164:"weld line",1165:"concentric circles",1166:"gear",1167:"Block centerline",1168:"Circular tangent line",1169:"Reference symbol (2)",1170:"Insert frame",1171:"Draw roads",1172:"Draw any polygon",1173:"Align by line",1174:"Change the font height",1175:"Change the width of the characters",1176:"Brush content",1177:"Change content",1178:"justified",1179:"Align up and down",1180:"Text reversal",1181:"Text framing",1182:"underline",1183:"Title line",1184:"case",1185:"Sum of numbers",1186:"Select specific characters",1187:"affix",1188:"Connecting Text",1189:"Delete space",1190:"Vertical Text",1191:"Align by arc",1192:"Modify global text style",1193:"Extract Text",1194:"Text number",1195:"Change the block name",1196:"Brush block",1197:"Block Connection",1198:"Change the base point of the block",1199:"Change the color of the block",1200:"Multi block rotation",1201:"Multi block scaling",1202:"Brush block angle",1203:"Select by block",1204:"Select all by block",1205:"Statistics of individual blocks",1206:"Count multiple blocks",1207:"Modify block layer",1208:"length",1209:"Statistical area",1210:"Intelligent elevation",1211:"area",1212:"Rectangular area",1213:"distance from point to line",1214:"arc length",1215:"Measuring Circle",1216:"CONTINUE",1217:"View segment length",1218:"Area including arc",1219:"Drawing review annotation",1220:"Rectangular annotation",1221:"Roughness annotation",1222:"Coordinate annotation",1223:"Slope marking",1224:"alignment",1225:"enlarge",1226:"Number annotation",1227:"Rotate annotation",1228:"Circular hole marking",1229:"Directional symbol",1230:"Radiographic annotation",1231:"Rectangular annotation hovering color change",1232:"Crop drawing extension",1233:"Arrow line",1234:"Selected Text",1235:"Clipboard",1236:"cancel",1237:"sure",1238:"Tolerance code",1239:"Tolerance 1",1240:"Tolerance 2",1241:"annotations",1242:"top",1243:"bottom",1244:"reference",1245:"Full week symbol",1246:"Current line",1247:"Add Row",1248:"delete row",1249:"zero clearing",1250:"Straightness",1251:"Flatness",1252:"roundness",1253:"Cylindricity",1254:"Line Profile",1255:"Profile of a Surface",1256:"parallelism",1257:"verticality",1258:"tilt",1259:"Positional accuracy",1260:"Coaxiality",1261:"Symmetry",1262:"runout",1263:"total runout",1264:"clean up",1265:"Please enter the text content and number:",1266:"Text content:",1267:"(Enter 0-20 words)",1268:"Starting number:",1269:"(Number automatically increases by 1)",1270:"Number location:",1271:"Number before",1272:"Number after",1273:"change direction",1274:"Left text content:",1275:"Text content on the right:",1276:"Bottom text content:",1277:"Basic symbols",1278:"Same requirements",1279:"Most symbols",1280:"Add a horizontal line to the long side",1281:"auxiliary symbol",1282:"Supplementary symbols",1283:"Symbol position",1284:"Special symbols",1285:"Left size",1286:"Up size",1287:"Right size",1288:"Staggered weld",1289:"spacing",1290:"extended text ",1291:"Dashed line position",1292:"Welding instructions",1293:"Clear rows",1294:"flange weld",1295:"Type I weld seam",1296:"V-shaped weld seam",1297:"Unilateral V-shaped weld seam",1298:"Single sided steep side V-shaped groove welding",1299:"Tilted weld seam",1300:"Removable pad",1301:"Durable pad",1302:"V-type weld with rounded edge",1303:"U-shaped weld with rounded edge",1304:"Single sided V-shaped weld with a stop edge",1305:"Single sided U-shaped weld with a stop edge",1306:"Edge weld",1307:"Welding joint",1308:"sealing bead",1309:"fillet weld",1310:"Plug weld or groove weld",1311:"spotweld",1312:"Folding interface",1313:"Tilt interface",1314:"Spot weld seam (offset center)",1315:"Weld seam",1316:"Weld seam (off center)",1317:"Steep side V-shaped groove welding",1318:"The first type of planar symbol",1319:"The second concave symbol",1320:"The second type of convex symbol",1321:"The second type of planar symbol",1322:"The first convex symbol",1323:"The third type of planar symbol",1324:"The first concave symbol",1325:"Flatten the weld seam",1326:"Smooth transition at the toe",1327:"With pad symbol",1328:"Three sided weld symbol",1329:"Surrounding welding symbols",1330:"On site symbols",1331:"tail symbol",1332:"Interleaved intermittent welding symbol",1333:"Horn shaped weld seam",1334:"Unilateral horn shaped weld seam",1335:"Weld seam",1336:"Lock edge weld seam",1337:"Locking edge groove",1338:"upper",1339:"below",1340:"not have",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"Select the weld symbol to be placed on the geometric shape",1346:"Welding angle width:",1347:"Unilateral V-shaped butt weld (front view)",1348:"Corner weld seam (front view)",1349:"Unilateral V-shaped butt weld (side view)",1350:"Corner weld seam (side view)",1985:"Extract Table",1996:"Please input the table to extract accuracy",1997:"Select the first corner of the extraction range",1998:"Select the second corner of the extraction range",1999:"No valid table recognized!",2e3:"Please test in the local environment!",2001:"Online editing of tables",2019:"Enter the number text",2020:"Please select a single line of text",2021:"Please select a multi line text",2022:"Please set the text insertion point",2023:"Please select single line text",2024:"Multiple single to multiple conversion",2025:"Single to multiple conversion",2026:"Convert multiple orders",2027:"Convert multiple single orders"}},Symbol.toStringTag,{value:"Module"})),wO=Object.freeze(Object.defineProperty({__proto__:null,default:{718:"출력 범위의 첫 번째 점을 지정합니다.",719:"출력 범위의 두 번째 점을 지정합니다.",720:"첫 번째 점을 지정합니다.",721:"두 번째 점 지정:",722:"클라우드 와이어프레임 시작점:",723:"클라우드 와이어프레임 끝점:",724:"심사 아이콘 참고 사항:",725:"클릭하여 구름선을 그리기 시작:",726:"다시 클릭하여 클라우드 그리기를 끝냅니다.",727:"점 지정:",728:"두 점 지정:",729:"객체 선택",730:"다음 점을 지정합니다.",731:"\\ 삽입 기준점 지정",732:"테이블 삽입점을 지정하려면 다음과 같이 하십시오.",733:"삽입점을 지정하려면 다음과 같이 하십시오.",734:"삽입 기준점 지정",735:"치수 객체 선택",736:"대상 텍스트 선택",737:"채우기 영역 내부의 점을 지정합니다.",738:"닫힌 영역을 찾을 수 없음",739:"표면 거친도",740:"용접 기호",741:"비트 공차",742:"사용자 정의 속성을 설정할 객체 선택",743:"숨길 객체 선택",744:"삽입점을 지정하려면 다음과 같이 하십시오.",745:"점 지정:",746:"각도 지정",747:"두 점 지정:",748:"해치 객체 선택",749:"첫 번째 점을 지정합니다.",750:"두 번째 점 지정:",751:"두 번째 각도를 지정합니다.",752:"마지막 점을 지정합니다.",753:"좌표점을 지정합니다.",754:"치수 점을 지정하려면 다음과 같이 하십시오.",755:"승인 의견을 입력하십시오.",756:"클라우드 와이어프레임 시작점 지정",757:"클라우드 와이어프레임 끝점 지정",758:"심사 아이콘 주석 지정",759:"첫 번째 구석을 지정합니다.",760:"두 번째 구석 지정:",761:"일련번호 위치를 지정하려면 다음과 같이 하십시오.",762:"회전 기호",763:"태그 유형",764:"태그가 필요한 원을 선택하십시오.",765:"위치 점 또는 선 또는 호 또는 원을 설정하십시오.",766:"드래그하여 치수 위치 결정",767:"각도를 지정하거나 입력하십시오.",768:"용접 기호",769:"위치 점, 선 또는 호를 선택하십시오.",770:"두 번째 점을 지정하십시오.",771:"위치 점을 설정하십시오.",772:"각도를 설정하십시오.",773:"위치 점이나 선 또는 호를 설정하십시오.",774:"지시선 전환점을 설정하십시오.",775:"드래그하여 위치 점 결정",776:"첫 번째 점을 지정하십시오.",777:"두 번째 점을 지정하십시오.",778:"대상 블록 객체를 선택하십시오.",779:"새 블록 이름을 입력하십시오.",780:"기준점을 수정할 블록 선택",781:"기준점 설정",782:"색상을 수정할 블록 선택",783:"색상 색인 입력 (0~256)",784:"소스 블록을 선택하십시오.",785:"브러시할 대상 블록 선택:",786:"연결 방법 선택",787:"수동으로 하나씩 연결",788:"자동 대량 연결",789:"연결된 블록을 선택하십시오.",790:"중심선 길이 설정",791:"회전할 대상 블록을 선택합니다.",792:"회전 각도 설정",793:"배율을 설정하십시오.",794:"선택 범위를 설정하십시오.",795:"대상 블록을 선택하십시오.",796:"통계 범위를 설정하십시오.",797:"테이블 삽입점을 지정하려면 다음과 같이 하십시오.",798:"대상 커브 선택",799:"길이 치수 점 지정",800:"대상 객체 선택",801:"대상 기울기 객체를 선택하십시오.",802:"치수 문자 높이를 설정하십시오.",803:"기울기 치수 점 지정",804:"대상 좌표점을 선택하십시오.",805:"치수 위치를 지정하십시오.",806:"시작점 지정",807:"끝점 지정",808:"치수 방향 지정",809:"텍스트 내용을 설정하십시오.",810:"영역의 첫 번째 점을 선택하십시오.",811:"다음 점을 선택하십시오.",812:"영역 치수의 위치를 선택하십시오.",813:"사각형의 구석 1을 선택하십시오.",814:"사각형의 구석 2 를 선택하십시오.",815:"영역 치수의 위치를 설정하십시오.",816:"측정 점을 선택하십시오.",817:"선을 선택하십시오.",818:"치수 선의 위치를 설정하십시오.",819:"호선을 선택하십시오.",820:"치수 선 위치를 지정하십시오.",821:"원 객체를 선택하십시오.",822:"문자 위치를 지정하십시오.",823:"선의 끝점이나 호를 선택하십시오.",824:"문자의 위치를 지정하십시오.",825:"연속 측정을 위한 치수를 선택하십시오.",826:"두 번째 선을 선택하십시오.",827:"각도 치수의 위치를 설정하십시오.",828:"별 꼭대기 점 수를 입력하십시오.",829:"별의 중심점을 지정하려면:",830:"별의 내부 반지름을 설정하십시오.",831:"별의 외부 반지름을 지정합니다.",832:"범프 선 너비를 입력하십시오<5>",833:"범프 선 높이를 입력하십시오<10>",834:"시작점을 확인하려면 클릭하십시오.",835:"클릭하여 결승점을 확정하세요",836:"앤티앨리어싱 너비를 입력하십시오<5>",837:"앤티앨리어싱 높이 입력<10>",838:"직사각형 너비 입력<5>",839:"직사각형 높이 입력<10>",840:"클릭하여 사각형 중심 확인",841:"파이프 지름을 입력하십시오<10>",842:"파이프 배출구 길이를 입력하십시오<5>",843:"클릭하여 시작점 확인",844:"횡단면 파이프라인 시작점 지정하기",845:"횡단면 파이프라인 끝점 지정하기",846:"횡단면 파이프라인 호 방향 선택",847:"왼쪽",848:"오른쪽",849:"선택 모드",850:"선 용접",851:"아크 용접",852:"용접 반지름을 입력하십시오<5>",853:"호의 두 번째 점 지정하기",854:"호의 끝점 지정하기",855:"폭을 입력하십시오<25>",856:"높이를 입력하십시오<15>",857:"계단 레벨을 입력하십시오<10>",858:"중심 위치를 확인하십시오.",859:"원 반지름을 입력하십시오.",860:"보온면 너비 입력<5>",861:"보온면 높이 입력<10>",862:"다음 점 눌러주세요.",863:"첫 번째 선을 선택하십시오.",864:"두 번째 선을 선택하십시오.",865:"끝점을 선택하십시오.",866:"대상 사각형을 선택하십시오.",867:"나침반 중심점 설정",868:"나침반 반지름 설정",869:"프롬프트 상자 가리키기 선택",870:"메시지 상자의 첫 번째 점을 지정합니다.",871:"메시지 상자의 두 번째 점을 지정합니다.",872:"메시지 상자 방향을 설정하려면 다음과 같이 하십시오.",873:"데이텀 문자 설정하기",874:"문자 높이를 설정하십시오.",875:"데이텀 문자 위치를 설정하십시오.",876:"위치 점이나 호 또는 선을 설정하십시오.",877:"기호 위치를 설정하십시오.",878:"중심점을 설정하십시오.",879:"기어 중심을 설정하십시오.",880:"기어 반지름을 설정하십시오.",881:"중심선 길이 10 설정 >",882:"첫 번째 원을 선택하십시오.",883:"두 번째 원을 선택하십시오.",884:"직사각형의 왼쪽 위 구석을 설정하십시오.",885:"직사각형의 오른쪽 아래 구석을 설정하십시오.",886:"필렛 반지름을 설정하십시오.",887:"다각형 시작점을 선택하십시오.",888:"다각형 교점을 선택하십시오.",889:"객체 선택:",890:"기준점 지정",891:"두 번째 점 지정",892:"어레이",893:"종료",894:"포기",895:"패턴화할 항목 수 입력",896:"호 객체 선택",897:"회전된 객체 복사를 선택합니다.",898:"대상 점을 지정하십시오.",899:"회전 각도를 지정하십시오.",900:"다각형으로 변환할 객체 선택",901:"다각형 모서리 수 설정",902:"입력 옵션",903:"내접 원",904:"원에 외부 탄젠트",905:"색상을 수정할 객체 선택",906:"색상 색인 입력",907:"숨기기",908:"선택 안 함 숨기기",909:"모두 표시",910:"대상의 객체 선택",911:"상자의 첫 번째 점을 삭제하도록 지정합니다.",912:"상자 두 번째 점을 삭제하도록 지정합니다.",913:"정확하게 삭제할 엔티티 선택",914:"각도를 선택하여 객체를 복사합니다.",915:"각도 복사 수량을 입력하십시오.",916:"각도 복사의 기준점을 입력하십시오.",917:"복사 각도를 입력하십시오.",918:"정점 객체를 선택하십시오.",919:"객체 복사를 선택하십시오.",920:"복제 기준점을 확인하십시오.",921:"참조 커브 선택",922:"끊기 객체 선택",923:"오프셋 객체 지정",924:"오프셋 거리를 입력하십시오.",925:"신축 객체 지정 (선, 폴리선, 호 선택)",926:"다음으로 확장",927:"선종류 축척을 수정할 객체 선택",928:"선종류 축척을 입력하십시오.",929:"패턴 간격을 입력하십시오.",930:"호를 선택하십시오.",931:"정렬 객체 선택",932:"정렬 기준점 지정",933:"대상 폴리선을 선택합니다.",934:"필렛 반지름을 입력하십시오<5>",935:"채우기 객체 선택",936:"채우기 축척을 입력하십시오.",937:"원래 채우기 도면을 선택하십시오.",938:"도면 내부의 아무 곳이나 채우려면 클릭하십시오.",939:"선 객체 선택",940:"등분 모드 선택",941:"정거 등분",942:"정수 등분",943:"오프셋 등분",944:"등분 복사",945:"동등한 객체 간격띄우기를 선택하십시오.",946:"등분 객체 복사를 선택하십시오.",947:"등분할 세그먼트를 선택하십시오.",948:"등분 거리를 설정하십시오.",949:"등분 수량을 설정하십시오",950:"오프셋 거리를 설정하십시오.",951:"오프셋 점을 지정하십시오.",952:"복사 기준점을 지정하십시오.",953:"복사 등분 수량을 지정하십시오.",954:"복사 등분 끝점을 지정하십시오.",955:"사각형 배율이 필요한 엔티티를 선택하십시오.",956:"사각형의 구석 1 을 지정하십시오.",957:"사각형 구석 2를 지정하십시오.",958:"중심점 확대 선택",959:"확대 범위를 선택하십시오.",960:"확대 배수를 설정하십시오.",961:"삽입점 확대 를 선택하십시오.",962:"끊을 커브를 선택하십시오.",963:"커브에서 브레이크 점을 선택하십시오.",964:"패턴 수를 입력하십시오.",965:"회전 켜기",966:"예",967:"아니오",968:"배열이 필요한 도면을 선택하십시오.",969:"스토리지 중심점을 선택하십시오.",970:"닫힌 다각형을 선택하십시오!",971:"첫 번째 점을 선택하십시오.",972:"두 번째 점을 선택하십시오.",973:"첫 번째 닫힌 다각형을 선택하십시오.",974:"두 번째 닫힌 다각형을 선택하십시오.",975:"닫힌 다각형 두 개를 선택하십시오.",976:"두 다각형은 겹치는 모서리가 없습니다!",977:"대상 다각형을 선택하십시오.",978:"정점을 추가할 다각형 모서리를 선택하십시오.",979:"추가할 정점 위치를 설정하십시오.",980:"다각형에서 삭제할 정점을 선택하십시오.",981:"다각형으로 밀어낼 모서리를 선택하십시오.",982:"밀어내기 위치를 지정하십시오.",983:"그림 상자 방향을 설정하십시오<N>",984:"가로",985:"세로",986:"액자 크기를 설정하십시오<4>",987:"프레임 위치를 설정하십시오.",988:"트림 각도 점 1 지정",989:"트림된 구석 2 지정",990:"도로 시작점을 설치하세요",991:"다음 점을 설정하십시오.",992:"대상 정렬선 객체 (선 선택) 를 선택하십시오.",993:"대상 문자 객체를 선택하십시오.",994:"문자 객체 선택",995:"높이를 설정하십시오.",996:"글자 폭을 설정하십시오.",997:"원본 텍스트를 선택하십시오.",998:"첫 번째 텍스트를 선택하십시오.",999:"두 번째 텍스트를 선택하십시오.",1e3:"정렬할 문자를 선택하십시오.",1001:"정렬을 선택하십시오.",1002:"왼쪽",1003:"가운데",1004:"오른쪽",1005:"기준점 정렬을 선택하십시오.",1006:"반전할 텍스트를 선택하십시오.",1007:"공백을 제거할 텍스트를 선택하십시오.",1008:"문자 객체를 선택하십시오.",1009:"밑줄 너비를 입력하십시오.",1010:"밑줄 거리를 설정하십시오.",1011:"밑줄 연장 거리를 설정하십시오.",1012:"작업 옵션을 선택하십시오.",1013:"대문자",1014:"소문자",1015:"문장의 첫머리와 대문자.",1016:"디지털 객체를 선택하십시오.",1017:"텍스트 삽입점을 선택하십시오.",1018:"찾을 범위를 선택합니다.",1019:"찾기 모드를 선택하십시오.",1020:"같음",1021:"포함",1022:"접두사는",1023:"접미어는",1024:"키워드를 입력하십시오.",1025:"작업할 범위를 선택합니다.",1026:"작업 방법 선택",1027:"추가",1028:"삭제",1029:"작업 위치 선택",1030:"접두사",1031:"접미어",1032:"내용을 입력하십시오.",1033:"텍스트 선택",1034:"호를 선택하십시오.",1035:"문자 스타일을 선택하십시오.",1036:"텍스트 추출 범위를 설정하십시오.",1037:"오픈 데모 코드 다운로드",1038:"개발 패키지 다운로드",1039:"원선 그리기 명령 호출",1040:"서로 직선을 그리다",1041:"도면층 추가",1042:"모든 도면층 가져오기",1043:"모든 문자 스타일 가져오기",1044:"모든 그림 블록 가져오기",1045:"모든 선 모양 가져오기",1046:"확장 데이터 쓰기",1047:"확장 데이터 읽기",1048:"그림 블록 삽입 테스트",1049:"선을 그리다",1050:"호 그리기",1051:"원을 그리다",1052:"PL 선 그리기",1053:"채우기 그리기",1054:"드로잉 문자",1055:"타원 그리기",1056:"타원형 호를 그리다",1057:"여러 줄 문자 그리기",1058:"테이블 그리기",1059:"QR코드 그리기",1060:"도장 삽입",1061:"모든 객체 가져오기",1062:"상호 객체 선택",1063:"서버에 mxweb 저장",1064:"시스템 변수 가져오기",1065:"새 시트",1066:"흰색 배경색",1067:"텍스트 찾기 위치",1068:"블록으로 솔리드 선택",1069:"단일행 문자 그리기",1070:"선택 채우기",1071:"확장 속성 설정",1072:"정렬 치수 그리기",1073:"회선 치수",1074:"각도 치수",1075:"객체 선종류 수정",1076:"숨겨진 객체 레이어 선택",1077:"현재 선택에 추가",1078:"뷰포트 회전",1079:"확장 레코드 쓰기",1080:"명명 사전 얻기",1081:"문자 스타일 추가",1082:"사용자 솔리드 그리기",1083:"객체 색상 수정",1084:"수정 개체가 보이지 않음",1085:"객체 레이어 수정",1086:"객체 표시 순서 수정",1087:"범위 지정 출력 pdf",1088:"이미지 그리기",1089:"객체 확장 사전 읽기",1090:"3DPolyline 그리기",1091:"선 그리기 텍스트 사용자화 솔리드",1092:"계산 교차점",1093:"문자 스타일 수정",1094:"오프셋 입력 선",1095:"그룹 만들기",1096:"스크린샷 jpg",1097:"시트 동일 문자 가져오기",1098:"범위 출력 dwg 지정",1099:"표식 원 그리기 테스트",1100:"Wipeout 테스트",1101:"잘라낸 블록 생성하기",1102:"공차 치수",1103:"모든 객체 색상 변경",1104:"자르기 mxweb",1105:"현재 색상 선 무게 설정",1106:"다각형 영역 내의 객체 찾기",1107:"객체 깨기",1108:"반투명 선 그리기",1109:"선 유형 추가",1110:"패턴 축척 수정하기",1111:"텍스트 편집 테스트",1112:"바코드 그리기",1113:"스크린샷 bmp",1114:"수정 도구",1115:"문자 도구",1116:"드로잉 도구",1117:"블록 도구",1118:"측정 도구",1119:"치수 도구",1120:"기타 도구",1121:"다중 복제",1122:"호전원",1123:"복사 회전",1124:"원형 다각형",1125:"색상 수정",1126:"호 탄젠트",1127:"임시 숨기기",1128:"상자 삭제",1129:"각도 복사",1130:"정점 복사",1131:"교점이 끊어지다",1132:"양방향 오프셋",1133:"원 크기 변경",1134:"선종류 축척",1135:"신축",1136:"호별 패턴",1137:"pl 필렛",1138:"pl선 대칭 이동",1139:"모든 선 객체 가져오기",1140:"등분",1141:"직사각형 크기 조절",1142:"끊다",1143:"다각형 가공하기",1144:"다각형 결합",1145:"다각형 교점 추가",1146:"다각형 교점 삭제",1147:"다각형 단일 밀어내기",1148:"별 모양",1149:"범프 선",1150:"톱니 선",1151:"중심 사각형",1152:"필렛 사각형",1153:"원 중심선",1154:"파이프",1155:"단면부",1156:"중수선",1157:"계단",1158:"채워진 원",1159:"보온면",1160:"중심선",1161:"구멍을 내다",1162:"메시지 상자",1163:"데이텀 문자 (1)",1164:"용접선",1165:"동심원",1166:"기어",1167:"블록 중심선",1168:"원형 공접선",1169:"데이텀 문자 (2)",1170:"그림 상자 삽입",1171:"도로를 그리다",1172:"다각형 그리기",1173:"선으로 정렬",1174:"고자질",1175:"글자의 폭을 바꾸다",1176:"내용 스밍",1177:"내용을 바꾸다",1178:"좌우 정렬",1179:"위아래 정렬",1180:"문자 반전",1181:"텍스트 상자",1182:"밑줄",1183:"도명선",1184:"대소문자",1185:"숫자 구화",1186:"특정 단어 선택",1187:"접미어",1188:"연결 문자",1189:"공백 제거",1190:"문자 세로 방향",1191:"호별 정렬",1192:"전역 문자 스타일 수정",1193:"텍스트 추출",1194:"문자 번호",1195:"블록 이름 변경",1196:"브러시",1197:"블록 연결",1198:"블록 기준점을 변경하다.",1199:"블록 색상 변경",1200:"다중 블록 회전",1201:"다중 블록 크기 조절",1202:"브러시 각도",1203:"블록별 선택",1204:"블록별로 모두 선택",1205:"통계 단일 블록",1206:"다중 블록 통계",1207:"블록 도면층 수정",1208:"길이",1209:"통계 면적",1210:"지능형 높이",1211:"면적",1212:"직사각형 영역",1213:"점에서 선까지의 거리",1214:"호 길이",1215:"원 측정",1216:"연속 측정",1217:"세그먼트 길이 보기",1218:"영역 포함 호",1219:"심도 치수",1220:"직사각형 치수",1221:"조잡도 치수",1222:"좌표 치수",1223:"슬로프",1224:"정렬",1225:"부분 확대",1226:"일련번호 마크업",1227:"치수 회전",1228:"둥근 구멍 표식",1229:"방향 기호",1230:"방사선 치수",1231:"직사각형 치수 고정 변색",1232:"용지 확장 트림",1233:"화살표 선",1234:"선택한 텍스트",1235:"클립보드로 복사",1236:"취소",1237:"확인",1238:"공차 코드",1239:"공차 1",1240:"공차 2",1241:"부주",1242:"꼭대기",1243:"밑단",1244:"기준",1245:"전주기호",1246:"현재 행",1247:"행 추가",1248:"행 삭제",1249:"제로",1250:"직선도",1251:"평면도",1252:"원도",1253:"원통도",1254:"선 프로파일",1255:"면 프로파일",1256:"평행도",1257:"수직도",1258:"경사도",1259:"위치도",1260:"동축도",1261:"대칭도",1262:"둥글게 뛰다",1263:"올댄스",1264:"지우기",1265:"텍스트 내용 및 번호를 입력하십시오.",1266:"텍스트 내용:",1267:"(0-20자 입력)",1268:"시작 번호:",1269:"(번호 자동 증가 1)",1270:"번호 지정 위치:",1271:"번호 이전",1272:"번호 뒤에",1273:"방향 변경",1274:"왼쪽 텍스트 내용:",1275:"오른쪽 텍스트 내용:",1276:"아래 텍스트 내용:",1277:"기본 기호",1278:"동일 요구 사항",1279:"다수 기호",1280:"긴 모서리 가로줄",1281:"보조 기호",1282:"보충 기호",1283:"기호 위치",1284:"특수 기호",1285:"왼쪽 치수",1286:"위 치수",1287:"오른쪽 치수",1288:"교차 용접",1289:"간격",1290:"텍스트 확장",1291:"점선 위치",1292:"용접 설명",1293:"행 지우기",1294:"볼륨 모서리 용접",1295:"유형 I 용접",1296:"V 용접",1297:"단일 V 용접",1298:"한면 급경사 V 그루브 스택",1299:"용접 기울이기",1300:"분리식 패드",1301:"영구 패드",1302:"리턴 모서리 V 용접",1303:"리턴 모서리 U 용접",1304:"리턴 모서리 단일 V 용접",1305:"리턴 모서리 단일 U 용접",1306:"끝 용접",1307:"스택 용접 커넥터",1308:"커버 용접",1309:"필렛 용접",1310:"플러그 또는 슬롯 용접",1311:"점 용접",1312:"인터페이스 축소",1313:"기울기 커넥터",1314:"점 용접 (가운데 오프셋)",1315:"용접",1316:"용접 (중심 이탈)",1317:"가파른 V 그루브 스택",1318:"첫 번째 평면 기호",1319:"두 번째 오목 기호",1320:"두 번째 볼록 기호",1321:"두 번째 평면 기호",1322:"첫 번째 볼록 기호",1323:"세 번째 평면 기호",1324:"첫 번째 오목 기호",1325:"용접 깎기",1326:"발가락 부드럽게 변환",1327:"개스킷 기호 포함",1328:"3면 용접 기호",1329:"주변 용접 문자",1330:"필드 기호",1331:"꼬리 기호",1332:"인터레이스 띄엄필렛 용접 기호",1333:"플레어 용접",1334:"단일 플레어 용접",1335:"더미 용접",1336:"자물쇠 모서리 용접",1337:"모서리 그루브 잠금",1338:"위",1339:"하",1340:"없음",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"형상에 배치할 용접 기호 선택",1346:"용접 각도 너비:",1347:"단일 V 버트 용접(전면)",1348:"필렛 용접 (전면)",1349:"단일 V 버트 용접 (측면 뷰)",1350:"필렛 용접 (측면 뷰)",1985:"테이블 추출",1996:"테이블 추출 정밀도를 입력하십시오.",1997:"추출 범위의 첫 번째 구석 선택",1998:"추출 범위의 두 번째 구석 선택",1999:"유효한 양식이 인식되지 않았습니다!",2e3:"로컬 환경에서 테스트하십시오!",2001:"온라인으로 테이블 편집",2019:"번호 문자 입력",2020:"한 줄 텍스트를 선택하십시오.",2021:"여러 줄 텍스트를 선택하십시오.",2022:"문자 삽입점을 설정하십시오.",2023:"단일행 텍스트 선택",2024:"많이 돌리다",2025:"단일 회전 다중",2026:"다중 회전 다중 시트",2027:"다중 회전 단일"}},Symbol.toStringTag,{value:"Module"})),MO=Object.freeze(Object.defineProperty({__proto__:null,default:{718:"指定輸出範圍第一點：",719:"指定輸出範圍第二點：",720:"指定第一點：",721:"指定第二點：",722:"雲線框起始點：",723:"雲線框結束點：",724:"審圖標注點：",725:"點擊開啟繪製雲線：",726:"再次點擊結束繪製雲線：",727:"指定一點：",728:"指定二點：",729:"選擇對象",730:"指定下一個點：",731:"\\指定插入基點",732:"指定表格插入點：",733:"指定插入點：",734:"指定插入基點",735:"選擇標注對象",736:"請選擇目標文字",737:"指定填充區域內部一點：",738:"沒有找到閉合區域",739:"表面粗糙度",740:"焊接符號",741:"形位公差",742:"選擇要需要開啟自訂屬性的對象",743:"選擇要隱藏的對象",744:"指定插入點：",745:"指定一點：",746:"指定夾角",747:"指定二點：",748:"選擇圖案填充對象",749:"指定第一點：",750:"指定第二點：",751:"指定第二個角度點：",752:"指定最後一個點：",753:"指定座標點：",754:"指定標注點：",755:"請輸入審批意見",756:"指定雲線框起始點",757:"指定雲線框終止點",758:"指定審圖標注點",759:"指定第一個角點：",760:"指定第二個角點：",761:"指定序號位置：",762:"旋轉符號",763:"標記類型",764:"請選擇需要標記的圓：",765:"請設定定位點或直線或圓弧或圓",766:"拖動確定標注位置",767:"請指定或輸入角度",768:"焊縫符號",769:"請拾取定位點、直線或圓弧",770:"請指定第二點",771:"請設定定位點",772:"請設定角度",773:"請設定定位點或直線或圓弧",774:"請設定引線轉捩點",775:"拖動確定定位點",776:"請指定第一點：",777:"請指定第二點：",778:"請選擇目標塊對象",779:"請輸入新塊名",780:"選擇需要修改基點的塊",781:"設定基點",782:"選擇需要修改顏色的塊",783:"輸入顏色索引(0~256)",784:"請選擇源塊",785:"選擇要刷的目標塊：",786:"選擇連接管道",787:"手動逐個連線",788:"自動批量連線",789:"請選擇連線的塊",790:"設定中心線長度",791:"選擇要旋轉的目標塊：",792:"設定旋轉角度",793:"請設定縮放比例",794:"請設定選擇範圍：",795:"請選擇目標塊",796:"請設定統計範圍",797:"指定表格插入點：",798:"選擇目標曲線",799:"指定長度標注點",800:"選擇目標對象",801:"請選擇目標斜率對象",802:"請設定標注文字高度",803:"指定斜率標注點",804:"請選擇目標座標點",805:"請指定標注位置",806:"指定起點",807:"指定終點",808:"指定標注方向",809:"請設定文字內容",810:"請選擇面積的第一個點",811:"請選擇下一個點",812:"請選擇面積標注的位置",813:"請選擇矩形的角點1",814:"請選擇矩形的角點2",815:"請設定面積標注的位置",816:"請選擇一個量測點",817:"請選擇一條直線",818:"請設定尺寸線的位置",819:"請選擇一條弧線",820:"請指定尺寸線位置",821:"請選擇一個圓對象",822:"請指定文字位置",823:"請選擇直線的端點或弧線",824:"請指定文字的位置",825:"請選擇一個連續量測的標注",826:"請選擇第二條直線",827:"請設定角度標注的位置",828:"請輸入星形頂點數：",829:"指定星形中心點：",830:"請設定星形的內半徑：",831:"指定星形的外半徑：",832:"請輸入凹凸線寬度<5>",833:"請輸入凹凸線高度<10>",834:"請點擊確定起始點",835:"請點擊確定終點",836:"請輸入鋸齒線寬度<5>",837:"請輸入鋸齒線高度<10>",838:"請輸入矩形寬度<5>",839:"請輸入矩形高度<10>",840:"請點擊確定矩形中心",841:"請輸入管徑<10>",842:"請輸入長出管口長度<5>",843:"請點擊確定起點",844:"指定剖管線起點",845:"指定剖管線終點",846:"選擇剖管線圓弧方向",847:"左邊",848:"右邊",849:"選擇模式",850:"直線焊縫",851:"弧線焊縫",852:"請輸入焊縫半徑<5>",853:"指定圓弧的第二個點",854:"指定圓弧的端點",855:"請輸入寬度<25>",856:"請輸入高度<15>",857:"請輸入樓梯級數<10>",858:"請確定圓心位置",859:"請輸入圓半徑",860:"請輸入保溫棉寬度<5>",861:"請輸入保溫棉高度<10>",862:"請點擊下一個點",863:"請選擇第一條線",864:"請選擇第二條線",865:"請選擇終點",866:"請選擇目標矩形",867:"設定指北針中心點",868:"設定指北針半徑",869:"選擇提示框指向",870:"指定訊息方塊第一點：",871:"指定訊息方塊第二點：",872:"設定訊息方塊指向：",873:"請設定基準符文字",874:"請設定文字高度",875:"請設定基準符位置",876:"請設定定位點或圓弧或直線",877:"請設定符號位置",878:"請設定圓心",879:"請設定齒輪圓心",880:"請設定齒輪半徑",881:"請設定中心線長度10>",882:"請選擇第一個圓",883:"請選擇第二個圓",884:"請設定矩形左上角點",885:"請設定矩形右下角點",886:"請設定圓角半徑",887:"請選擇多邊形起點",888:"請選擇多邊形頂點",889:"選擇對象：",890:"指定基點",891:"指定第二個點",892:"陣列",893:"退出",894:"放弃",895:"輸入要進行陣列的項目數",896:"選擇圓弧對象",897:"選擇複製旋轉對象：",898:"請指定目標點",899:"請指定旋轉角度",900:"選擇要轉成多邊形的對象",901:"設定多邊形邊數",902:"輸入選項",903:"內接於圓",904:"外切於圓",905:"選擇要修改顏色的對象",906:"輸入顏色索引",907:"隱藏",908:"隱藏未選",909:"全部顯示",910:"選擇目標的對象",911:"指定删除方框第一點：",912:"指定删除方框第二點：",913:"選擇需要精確删除的實體",914:"請選擇角度複製對象",915:"請輸入角度複製數量",916:"請輸入角度複製的基點",917:"請輸入複製角度",918:"請選擇頂點對象",919:"請選擇複製對象",920:"請確定複製基點",921:"請選擇參攷曲線",922:"選擇打斷對象",923:"指定偏移對象",924:"請輸入偏移距離",925:"指定伸縮對象(選擇直線、多段線、圓弧)",926:"伸縮至",927:"選擇要修改線型比例的對象",928:"請輸入線型比例",929:"請輸入陣列間距",930:"請選擇圓弧",931:"選擇排列對象",932:"指定排列基點",933:"選擇目標多段線：",934:"請輸入圓角半徑<5>",935:"選擇填充對象",936:"請輸入填充比例",937:"請選擇原填充圖形",938:"請點擊填充圖形內部任意一點",939:"請選擇線對象",940:"選擇等分模式",941:"定距等分",942:"定數等分",943:"偏移等分",944:"複製等分",945:"請選擇偏移等分對象",946:"請選擇複製等分對象",947:"請選擇需要等分的線段",948:"請設定等分距離",949:"請設定等分的數量",950:"請設定偏移距離",951:"請指定偏移點",952:"請指定複製基點",953:"請指定複製等分數量",954:"請指定複製等分端點",955:"請選擇需要矩形縮放的實體：",956:"請指定矩形的角點1",957:"請指定矩形角點2",958:"請選擇放大中心點",959:"請選擇放大範圍",960:"請設定放大倍數",961:"請選擇放大插入點",962:"請選擇一條需要打斷的曲線",963:"請在曲線上選取打斷點",964:"請輸入陣列數量",965:"是否開啟旋轉",966:"是",967:"否",968:"請選擇需要陣列的圖形：",969:"請選擇陣列中心點",970:"請選擇閉合多邊形！",971:"請選擇第一個點",972:"請選擇第二個點",973:"請選擇第一個閉合多邊形",974:"請選擇第二個閉合多邊形",975:"請選擇兩個閉合多邊形",976:"兩個多邊形沒有重合邊！",977:"請選擇目標多邊形",978:"請選擇多邊形需要添加頂點的邊",979:"請設定添加的頂點位置",980:"請選擇多邊形需要删除的頂點",981:"請選擇多邊形需要拉伸的邊",982:"請指定拉伸位置",983:"請設定圖框方向<N>",984:"橫向",985:"縱向",986:"請設定圖框尺寸<4>",987:"請設定圖框位置",988:"指定裁剪角點1",989:"指定裁剪角點2",990:"請設定道路起點",991:"請設定下一點",992:"請選擇目標對齊線對象(選擇直線)",993:"請選擇目標文字對象",994:"選擇文字對象",995:"請設定字高",996:"請設定字寬",997:"請選擇源文字",998:"請選擇第一個文字",999:"請選擇第二個文字",1e3:"請選擇需要對齊的文字",1001:"請選擇對齊管道",1002:"左",1003:"中",1004:"右",1005:"請選擇對齊基點",1006:"請選擇需要反轉的文字",1007:"請選擇需要去空格的文字",1008:"請選擇文字對象",1009:"請輸入底線寬度",1010:"請設定底線距離",1011:"請設定底線延長距離",1012:"請選擇操作選項",1013:"大寫",1014:"小寫",1015:"句首大寫",1016:"請選擇數位對象",1017:"請選擇文字插入點",1018:"選擇要查找的範圍：",1019:"請選擇查找模式",1020:"等於",1021:"包含",1022:"首碼為",1023:"尾碼為",1024:"請輸入關鍵字",1025:"選擇要操作的範圍：",1026:"選擇操作管道",1027:"添加",1028:"删除",1029:"選擇操作位置",1030:"首碼",1031:"尾碼",1032:"請輸入內容",1033:"請選擇文字",1034:"請選擇圓弧",1035:"請選擇文字樣式",1036:"請設定文字選取範圍",1037:"下載開Demo程式碼",1038:"下載開發包",1039:"調用畫圓線命令",1040:"互動畫直線",1041:"添加圖層",1042:"得到所有圖層",1043:"得到所有文字樣式",1044:"得到所有圖塊",1045:"得到所有線型",1046:"寫擴展數據",1047:"讀擴展數據",1048:"測試插入一個圖塊",1049:"繪直線",1050:"繪圓弧",1051:"繪圓",1052:"繪PL線",1053:"繪填充",1054:"繪文字",1055:"繪橢圓",1056:"繪橢圓弧",1057:"繪製多行文字",1058:"繪製表格",1059:"繪製二維碼",1060:"插入圖章",1061:"得到所有對象",1062:"互動選擇對象",1063:"保存mxweb到服務器",1064:"得到系統變數",1065:"新建圖紙",1066:"白色背景色",1067:"文字查找定位",1068:"選擇實體做塊",1069:"繪製單行文字",1070:"選點填充",1071:"設定擴展内容",1072:"繪製對齊標注",1073:"繪性線標注",1074:"角度標注",1075:"修改對象線型",1076:"選擇隱藏對象層",1077:"添加到當前選擇",1078:"視區旋轉",1079:"寫擴展記錄",1080:"得到命名字典",1081:"添加文字樣式",1082:"繪自定義實體",1083:"修改對象顏色",1084:"修改對象不可見",1085:"修改對象層",1086:"修改對象顯示順序",1087:"指定範圍輸出pdf",1088:"繪製image",1089:"讀取對象擴展字典",1090:"繪製3DPolyline",1091:"繪線文字自定義實體",1092:"計算交點",1093:"修改文字樣式",1094:"偏移輸入畫線",1095:"創建組",1096:"螢幕截圖jpg",1097:"獲取圖紙相同文字",1098:"指定範圍輸出dwg",1099:"測試繪製標記圓",1100:"測試Wipeout",1101:"創建剪切塊",1102:"公差標注",1103:"改所有對象顏色",1104:"切剪mxweb",1105:"設定當前顏色線重",1106:"查找多邊形區域內對象",1107:"打碎對象",1108:"繪半透明線",1109:"添加線型",1110:"修改圖案比例",1111:"測試文字編輯",1112:"繪製條碼",1113:"螢幕截圖bmp",1114:"修改工具",1115:"文字工具",1116:"繪圖工具",1117:"塊工具",1118:"量測工具",1119:"標注工具",1120:"其他工具",1121:"多重複製",1122:"弧轉圓",1123:"複製旋轉",1124:"圓轉多邊",1125:"修改顏色",1126:"圓弧切角",1127:"臨時隱藏",1128:"方框删除",1129:"角度複製",1130:"頂點複製",1131:"交點打斷",1132:"雙向偏移",1133:"改圓大小",1134:"線型比例",1135:"伸縮",1136:"按弧陣列",1137:"pl圓角",1138:"pl線反向",1139:"得到所有直線對象",1140:"等分",1141:"矩形縮放",1142:"打斷",1143:"切割多邊形",1144:"合併多邊形",1145:"添加多邊形頂點",1146:"删除多邊形頂點",1147:"多邊形單邊拉伸",1148:"星形",1149:"凹凸線",1150:"鋸齒線",1151:"中心矩形",1152:"圓角矩形",1153:"圓中心線",1154:"筦道",1155:"剖管符",1156:"中垂線",1157:"樓梯",1158:"實心圓",1159:"保溫棉",1160:"中心線",1161:"開洞",1162:"訊息方塊",1163:"基準符(1)",1164:"焊縫線",1165:"同心圓",1166:"齒輪",1167:"塊中心線",1168:"圓公切線",1169:"基準符(2)",1170:"插入圖框",1171:"繪製道路",1172:"繪任意多邊形",1173:"按線對齊",1174:"改字高",1175:"改字寬",1176:"刷內容",1177:"換內容",1178:"左右對齊",1179:"上下對齊",1180:"文字反轉",1181:"文字加框",1182:"底線",1183:"圖名線",1184:"大小寫",1185:"數位求和",1186:"選特定字",1187:"前尾碼",1188:"連接文字",1189:"去空格",1190:"文字豎向",1191:"按弧對齊",1192:"修改全域文字樣式",1193:"選取文字",1194:"文字編號",1195:"改塊名",1196:"刷塊",1197:"塊連線",1198:"改塊基點",1199:"改塊顏色",1200:"多塊旋轉",1201:"多塊縮放",1202:"刷塊角度",1203:"按塊選擇",1204:"按塊全選",1205:"統計單塊",1206:"統計多塊",1207:"修改塊圖層",1208:"長度",1209:"統計面積",1210:"智慧標高",1211:"面積",1212:"矩形面積",1213:"點到直線的距離",1214:"弧長",1215:"量測圓",1216:"連續量測",1217:"查看分段長度",1218:"面積含弧線",1219:"審圖標注",1220:"矩形標注",1221:"粗糙度標注",1222:"座標標注",1223:"標斜率",1224:"對齊",1225:"局部放大",1226:"序號標注",1227:"旋轉標注",1228:"圓孔標記",1229:"向視符號",1230:"射線標注",1231:"矩形標注懸停變色",1232:"裁剪圖紙擴展",1233:"箭頭直線",1234:"選擇的文字",1235:"複製到剪貼板",1236:"取消",1237:"確定",1238:"公差代號",1239:"公差1",1240:"公差2",1241:"附注",1242:"頂端",1243:"底端",1244:"基準",1245:"全周符號",1246:"當前行",1247:"新增行",1248:"删除行",1249:"清零",1250:"直線度",1251:"平面度",1252:"圓度",1253:"圓柱度",1254:"線輪廓度",1255:"面輪廓度",1256:"平行度",1257:"垂直度",1258:"傾斜度",1259:"位置度",1260:"同軸度",1261:"對稱度",1262:"圓跳動",1263:"全跳動",1264:"清除",1265:"請輸入文字內容和編號：",1266:"文字內容：",1267:"(輸入0-20個字)",1268:"起始編號：",1269:"(編號自動遞增1)",1270:"編號位置：",1271:"編號在前",1272:"編號在後",1273:"改變方向",1274:"左邊文字內容：",1275:"右邊文字內容：",1276:"底部文字內容：",1277:"基本符號",1278:"相同要求",1279:"多數符號",1280:"長邊加橫線",1281:"輔助符號",1282:"補充符號",1283:"符號位置",1284:"特殊符號",1285:"左尺寸",1286:"上尺寸",1287:"右尺寸",1288:"交錯焊縫",1289:"間距",1290:"擴充文字",1291:"虛線位置",1292:"焊接說明",1293:"清除行",1294:"卷邊焊縫",1295:"I型焊縫",1296:"V型焊縫",1297:"單邊V型焊縫",1298:"單邊陡側V型坡口堆焊",1299:"傾斜焊縫",1300:"可移除襯墊",1301:"持久襯墊",1302:"帶頓邊V型焊縫",1303:"帶頓邊U型焊縫",1304:"帶頓邊單邊V型焊縫",1305:"帶頓邊單邊U型焊縫",1306:"端接焊縫",1307:"堆焊接頭",1308:"封底焊縫",1309:"角焊縫",1310:"塞焊縫或槽焊縫",1311:"點焊縫",1312:"折疊介面",1313:"傾斜介面",1314:"點焊縫(偏移中心)",1315:"縫焊縫",1316:"縫焊縫(偏離中心)",1317:"陡側V型坡口堆焊",1318:"第一種平面符號",1319:"第二種凹面符號",1320:"第二種凸面符號",1321:"第二種平面符號",1322:"第一種凸面符號",1323:"第三種平面符號",1324:"第一種凹面符號",1325:"削平焊縫",1326:"趾部平滑過渡",1327:"帶墊板符號",1328:"三面焊縫符號",1329:"周圍焊接符",1330:"現場符號",1331:"尾部符號",1332:"交錯斷續焊接符號",1333:"喇叭形焊縫",1334:"單邊喇叭形焊縫",1335:"堆焊縫",1336:"鎖邊焊縫",1337:"鎖邊坡口",1338:"上",1339:"下",1340:"無",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"選擇要在幾何圖形上放置的焊縫符號",1346:"焊角寬度：",1347:"單邊V型對接焊縫(前視圖)",1348:"角焊縫(前視圖)",1349:"單邊V型對接焊縫(側視圖)",1350:"角焊縫(側視圖)",1985:"選取表格",1996:"請輸入表格選取精度",1997:"選擇選取範圍第一個角點",1998:"選擇選取範圍第二個角點",1999:"未識別到有效表格！",2e3:"請在本地環境測試！",2001:"線上編輯表格",2019:"輸入編號文字",2020:"請選擇一個單行文字",2021:"請選擇一個多行文字",2022:"請設定文字插入點",2023:"請選擇單行文字",2024:"多單轉一多",2025:"單轉多",2026:"多轉多個單",2027:"多轉單個單"}},Symbol.toStringTag,{value:"Module"}))})(Mx,MxCAD,MXCADAPP_EXTERNALLIBRARIES.Vue,MXCADAPP_EXTERNALLIBRARIES.vuetifyComponents,MXCADAPP_EXTERNALLIBRARIES.axios);
//# sourceMappingURL=test.js.map
