var $B=Object.defineProperty;var o2=Object.getOwnPropertySymbols;var ez=Object.prototype.hasOwnProperty,tz=Object.prototype.propertyIsEnumerable;var n_=Math.pow,a2=(Ke,R,V)=>R in Ke?$B(Ke,R,{enumerable:!0,configurable:!0,writable:!0,value:V}):Ke[R]=V,rf=(Ke,R)=>{for(var V in R||(R={}))ez.call(R,V)&&a2(Ke,V,R[V]);if(o2)for(var V of o2(R))tz.call(R,V)&&a2(Ke,V,R[V]);return Ke};var Pn=(Ke,R,V)=>new Promise((tn,of)=>{var af=ko=>{try{Ah(V.next(ko))}catch(Mh){of(Mh)}},Ay=ko=>{try{Ah(V.throw(ko))}catch(Mh){of(Mh)}},Ah=ko=>ko.done?tn(ko.value):Promise.resolve(ko.value).then(af,Ay);Ah((V=V.apply(Ke,R)).next())});(function(Ke,R,V,tn,of){"use strict";var af=document.createElement("style");af.textContent=`.fcc[data-v-4c78b384]{display:flex;align-items:center;justify-content:center}.row[data-v-fff1a9fd]{display:flex;justify-content:space-between;align-items:center}.row .item[data-v-fff1a9fd]{padding:5px;width:45px;height:45px}.row .item[data-v-fff1a9fd]:hover,.row .backColor[data-v-fff1a9fd]{background-color:#fff3}.inLine[data-v-41b1580f]{max-height:20px;overflow:hidden}.fcb[data-v-41b1580f]{display:flex;align-items:center;justify-content:space-between}.fcb .symbolBox[data-v-41b1580f]{display:flex;position:relative;width:40%;height:120px;border:1px solid #ccc;padding:5px}.fcb .symbolBox .symbol[data-v-41b1580f]{position:absolute;padding:2px;top:-10px;left:10px;background-color:rgb(var(--v-theme-dialog-card-text))}.fcb .symbolBox .symbolImg[data-v-41b1580f]{margin-top:12px;margin-right:5px;padding:5px;height:35px}.fcb .symbolBox .symbolImg[data-v-41b1580f]:hover,.fcb .symbolBox .backColor[data-v-41b1580f]{background-color:rgba(var(--v-theme-on-prominent),.2)}.formBox[data-v-41b1580f]{height:250px;width:100%;border:1px solid #ccc;position:relative}.formBox .iconFont[data-v-41b1580f]{position:absolute;width:32%;left:73px;top:50px}.formBox .iconFont .icon[data-v-41b1580f]{width:100%}.formBox .topData[data-v-41b1580f]{position:absolute;right:5px;top:7px;width:40%}.formBox .line[data-v-41b1580f]{position:absolute;left:180px;top:82px;width:50%;height:4px;background-color:rgb(var(--v-theme-on-prominent))}.formBox .bottomData[data-v-41b1580f]{position:absolute;width:25%;top:90px;right:36px}.formBox .cornerData[data-v-41b1580f]{position:absolute;bottom:65px;right:235px}.formBox .cornerData .cornerIcon[data-v-41b1580f]{height:25px;min-width:25px;padding:0}.formBox .cornerData .btnList[data-v-41b1580f]{position:absolute;display:flex;width:120px;height:60px;flex-wrap:wrap;justify-content:space-around;top:30px}.formBox .leftDate[data-v-41b1580f]{position:absolute;width:24%;bottom:75px;left:5px}.imgBox[data-v-a986481d]{width:100px;height:50px;background-color:#000;display:flex;justify-content:center;align-items:center;margin-bottom:10px}.radio[data-v-a986481d]{width:100%;display:flex;justify-content:space-between;align-items:center}.fbc[data-v-ef8817ed]{display:flex;justify-content:space-between;align-items:center}.btnBox[data-v-ef8817ed]{border:1px solid rgba(var(--v-border-color),var(--v-border-opacity));position:relative;padding:10px 0;margin-top:20px;align-items:center;justify-content:center}.btnBox .tiltle[data-v-ef8817ed]{display:block;position:absolute;top:-10px;left:5px}.row[data-v-ef8817ed]{display:flex}.item[data-v-ef8817ed]{height:35px;width:35px;padding:5px}.item img[data-v-ef8817ed]{height:25px;width:25px}.itemHover[data-v-ef8817ed]:hover,.checked[data-v-ef8817ed]{background-color:#89cbfa99}.btn[data-v-ef8817ed]{position:absolute;bottom:16px;right:204px;background-color:rgb(var(--v-theme-undertint-bg))!important;min-width:76px}.fbc[data-v-7ac3c527]{display:flex;justify-content:space-between;align-items:center}.btnBox[data-v-7ac3c527]{border:1px solid rgba(var(--v-border-color),var(--v-border-opacity));position:relative;padding:10px 0;margin-top:20px}.btnBox .tiltle[data-v-7ac3c527]{display:block;position:absolute;top:-10px;left:5px}.row[data-v-7ac3c527]{display:flex}.item[data-v-7ac3c527]{height:35px;width:35px;padding:5px}.item img[data-v-7ac3c527]{height:25px;width:25px}.itemHover[data-v-7ac3c527]:hover,.checked[data-v-7ac3c527]{background-color:#89cbfa99}.btn[data-v-7ac3c527]{position:absolute;bottom:16px;right:204px;background-color:rgb(var(--v-theme-undertint-bg))!important;min-width:76px}.checkBtn[data-v-7ac3c527]{background-color:#89cbfa66}.contents[data-v-7d640c71]{padding:5px}.contents .tips[data-v-7d640c71]{opacity:.6}
`,document.head.appendChild(af);const Ay={init(){Ke.MxFun.setPostMessageToParentFrameFunction(function(e){top.postMessage(e,"*")}),window.addEventListener("message",function(e){e.data.type==="sendStringToExecute"&&Ke.MxFun.sendStringToExecute(e.data.cmd,e.data)},!1)}};function Ah(){Ay.init()}const ko={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Mh(e){if(/^\d+,\s*\d+,\s*\d+$/.test(e))return e.split(",").map(Number);if(/^0x[0-9a-fA-F]{6}$/.test(e)){const t=parseInt(e,16);return[t>>16&255,t>>8&255,t&255]}else if(/^#[0-9a-fA-F]{6}$/.test(e)){const t=parseInt(e.slice(1),16);return[t>>16&255,t>>8&255,t&255]}else if(ko[e.toLowerCase()]){const t=e.toLowerCase();if(ko[t])return ko[t]}else{const t=new R.McCmColor;return t.setColorIndex(256),[t.red,t.green,t.blue]}}const c2=e=>{const t=R.MxCpp.getCurrentDatabase().layerTable;if(t.has(e))return;const i=new R.McDbLayerTableRecord;i.color=new R.McCmColor(0,0,0),i.isFrozen=!1,i.isLocked=!1,i.isOff=!1,i.lineWeight=R.McDb.LineWeight.kLnWtByLayer,i.name=e,t.add(i)},hs=[{name:"color",description:"颜色",type:"str",required:!0},{name:"layer",description:"图层",type:"str",required:!0},{name:"lineweight",description:"线重",type:"float",required:!0}],ds=(e,t)=>{t.layer&&c2(t.layer);const i=l=>{t.color?l.trueColor=new R.McCmColor(...Mh(t.color)):l.trueColor=new R.McCmColor(R.MxCpp.getCurrentDatabase().getCurrentlyDrawColor()),t.layer?l.layer=t.layer:l.layer=R.MxCpp.getCurrentDatabase().getCurrentlyLayerName(),t.lineweight&&(l.lineweight=t.lineweight)};Array.isArray(e)?e.forEach(i):e&&i(e)},u2=e=>{const t=e.split(",").map(c=>Number(c)),i=[];let l=0;for(;l<t.length;){const c=t[l];l++;const h=t[l];if(l++,typeof c=="undefined"||typeof h=="undefined")return i;const f=new R.McGePoint3d(c,h);i.push(f)}return i},pr=e=>{if(typeof e=="object"&&"x"in e&&"y"in e)return new R.McGePoint3d(e.x,e.y);if(Array.isArray(e))return new R.McGePoint3d(e[0],e[1]);if(typeof e=="string"){const[t,i]=e.split(",").map(l=>Number(l));if(typeof t=="number"&&typeof i=="number")return new R.McGePoint3d(t,i)}};class h2{call(t){if(console.log(t),t&&t.pt1&&t.pt2){let i=R.MxCpp.getCurrentMxCAD();t.pt1&&(t.pt1=pr(t.pt1)),t.pt2&&(t.pt2=pr(t.pt2));const l=i.drawLine(t.pt1.x,t.pt1.y,t.pt2.x,t.pt2.y);ds(l.getMcDbEntity(),t),i.updateDisplay()}}regist_data(){return{filename:"drawline.json",name:"draw_line",description:"根据直线的开始点和结束点绘制一个直线段",params:[{name:"pt1",description:"直线开始点",type:"tuple[float, float]",required:!0},{name:"pt2",description:"直线结束点",type:"tuple[float, float]",required:!0},...hs]}}}function d2(){Mo.regist(h2)}class p2{call(t){if(console.log(t),t&&t.cen&&t.radius){t.cen&&(t.center=pr(t.cen));let i=R.MxCpp.getCurrentMxCAD();const l=i.drawCircle(t.center.x,t.center.y,t.radius);ds(l.getMcDbEntity(),t),i.updateDisplay()}}regist_data(){return{filename:"drawcircle.json",name:"draw_circle",description:"根据圆心和半径绘制一个圆",params:[{name:"center",description:"圆的中心点",type:"tuple[float, float]",required:!0},{name:"radius",description:"圆的半径",type:"float",required:!0},...hs]}}}const f2=()=>{Mo.regist(p2)};function Wr(e,t,i,l,c){const h=e.x,f=e.y,r=t.x,v=t.y,_=i.x,w=i.y,b=l.x,E=l.y,P=(h-r)*(w-E)-(f-v)*(_-b);if(P===0)return null;const I=((h-_)*(w-E)-(f-w)*(_-b))/P,F=-((h-r)*(f-w)-(f-v)*(h-_))/P,B=h+I*(r-h),O=f+I*(v-f),W=new R.McGePoint3d(B,O,0);return c||I>0&&I<1&&F>0&&F<1?W:null}function gc(e,t){const i=t.x,l=t.y;let c=!1;for(let h=0,f=e.length-1;h<e.length;f=h++){const r=e[h].x,v=e[h].y,_=e[f].x,w=e[f].y;v>l!=w>l&&i<(_-r)*(l-v)/(w-v)+r&&(c=!c)}return c}function Sh(e,t,i,l){const c=e-i,h=t-l;let f=0;return c==0?f=Math.PI/2:f=Math.atan(Math.abs(h/c)),c<0&&h>=0?f=Math.PI-f:c<0&&h<0?f=Math.PI+f:c>=0&&h<0&&(f=Math.PI*2-f),f}function Th(e,t,i,l){const c=new R.McDbArc;return c.center=e,c.radius=t,c.startAngle=i,c.endAngle=l,c}class m2{call(t){return Pn(this,null,function*(){console.log(t);let{center:i,radius:l,startAngle:c,endAngle:h,is3PDraw:f,point1:r,point2:v,point3:_}=t,w=R.MxCpp.getCurrentMxCAD();w.newFile(),w.zoomAll();const b=new R.MxCADUiPrPoint,E=new R.MxCADUiPrDist;if(f){if(r&&(r=pr(r)),v&&(v=pr(v)),_&&(_=pr(_)),b.setKeyWords(""),!r&&(b.setMessage("指定圆弧起点"),b.setUserDraw((I,F)=>{if(!v||!_)return;const B=new R.McDbArc;B.computeArc(I.x,I.y,v.x,v.y,_.x,_.y),F.drawMcDbEntity(B)}),r=yield b.go(),!r)||!v&&(b.setMessage("指定圆弧第二个点"),b.setUserDraw((I,F)=>{if(!r||!_)return;const B=new R.McDbArc;B.computeArc(r.x,r.y,I.x,I.y,_.x,_.y),F.drawMcDbEntity(B)}),v=yield b.go(),!v)||!_&&(b.setMessage("指定圆弧的端点"),b.setUserDraw((I,F)=>{if(!r||!v)return;const B=new R.McDbArc;B.computeArc(r.x,r.y,v.x,v.y,I.x,I.y),F.drawMcDbEntity(B)}),_=yield b.go(),!_))return;const P=new R.McDbArc;console.log(r.x,r.y,v.x,v.y,_.x,_.y),P.computeArc(r.x,r.y,v.x,v.y,_.x,_.y),ds(P,t),w.drawEntity(P),w.updateDisplay()}else{if(i&&(i=pr(i)),c&&(c=c*(Math.PI/180)),h&&(h=h*(Math.PI/180)),!i){b.setMessage("指定圆弧圆心"),b.setKeyWords(""),b.setUserDraw((F,B)=>{l&&B.drawMcDbEntity(Th(F,l,c||0,h||Math.PI*2))});const I=yield b.go();if(!I)return;i=I}if(!l&&(E.setBasePt(i),E.setMessage(R._ML_String("MxAiDrawCircleArc_Radius","指定圆弧半径")),E.setKeyWords(""),E.setUserDraw((I,F)=>{if(!i)return;const B=I.distanceTo(i);F.drawMcDbEntity(Th(i,B,c||0,h||Math.PI*2))}),l=yield E.go(),!l))return;if(!c){if(!i)return;E.setBasePt(i),E.setMessage(R._ML_String("MxAiDrawCircleArc_StartAngle","指定圆弧开始角")),E.setKeyWords(""),E.setUserDraw((F,B)=>{i&&l&&(c=Sh(i.x,i.y,F.x,F.y)-Math.PI,B.drawMcDbEntity(Th(i,l,c||0,h||Math.PI*2)))});const I=yield E.go();if(!I)return;E.getDetailedResult()===Ke.DetailedResult.kCoordIn&&(c=I*(Math.PI/180))}if(!h){if(!i)return;E.setBasePt(i),E.setMessage(R._ML_String("MxAiDrawCircleArc_EndAngle","指定圆弧结束角")),E.setKeyWords(""),E.setUserDraw((F,B)=>{i&&l&&(h=Sh(i.x,i.y,F.x,F.y)-Math.PI,B.drawMcDbEntity(Th(i,l,c||0,h||Math.PI*2)))});const I=yield E.go();if(!I)return;E.getDetailedResult()===Ke.DetailedResult.kCoordIn&&(h=I*(Math.PI/180))}const P=Th(i,l,c,h);ds(P,t),w.drawEntity(P),w.updateDisplay()}})}regist_data(){return{filename:"drawcirclearc.json",name:"draw_circle_arc",description:"绘制圆弧",params:[{name:"center",description:"圆弧圆心",type:"tuple[float, float]",required:!0},{name:"radius",description:"圆弧半径",type:"float",required:!0},{name:"startAngle",description:"圆弧开始角",type:"float",required:!0},{name:"endAngle",description:"圆弧结束角",type:"float",required:!0},{name:"is3PDraw",description:"是否三点绘制",type:"boolean",required:!0},{name:"point1",description:"三点绘制圆弧的第一个点(起点)",type:"tuple[float, float]",required:!0},{name:"point2",description:"三点绘制圆弧的第二个点",type:"tuple[float, float]",required:!0},{name:"point3",description:"三点绘制圆弧的第三个点(终点)",type:"tuple[float, float]",required:!0},...hs]}}}const g2=()=>{Mo.regist(m2)};function i_(e=new R.McGePoint3d,t=new R.McGePoint3d,i=3){const l=t.x,c=t.y,h=e.x,f=e.y,r=Math.max(3,i),_=Math.sqrt(n_(l-h,2)+n_(c-f,2))/Math.cos(Math.PI/r),w=Math.atan2(c-f,l-h)-Math.PI/r,b=[];for(let E=0;E<r;E++){const P=w+E*2*Math.PI/r,I=h+_*Math.cos(P),F=f+_*Math.sin(P);b.push(new R.McGePoint3d(I,F))}return b}function r_(e=new R.McGePoint3d,t=new R.McGePoint3d,i=3){const l=[];i=Math.max(3,i),l.push(t);const c=Math.PI*2/i;for(let h=1;h<i;h++){const f=Math.cos(c*h),r=Math.sin(c*h),v=e.clone(),_=t.clone(),w=_.x-v.x,b=_.y-v.y,E=w*f-b*r+v.x,P=w*r+b*f+v.y,I=new R.McGePoint3d(E,P);l.push(I)}return l}function y2(e,t,i){let l=t.x-e.x,c=t.y-e.y,h=Math.sqrt(l*l+c*c),f=Math.atan2(c,l),r=2*Math.PI/Math.max(3,i),v=[e,t];for(let _=0;_<i;_++){let w=e.x+h*Math.cos(f+_*r),b=e.y+h*Math.sin(f+_*r);e=new R.McGePoint3d(w,b),v.push(e)}return v}class x2{call(t){return Pn(this,null,function*(){R.MxCpp.getCurrentMxCAD().newFile(),console.log(t);let{isDrawToCenter:i,sideNum:l,startPoint:c,endPoint:h,radius:f,centerPoint:r,isTangentToTheCircle:v}=t;if(!l){const _=new R.MxCADUiPrInt;_.setMessage("输入边的数目<5>"),_.setKeyWords(""),_.clearLastInputPoint(),l=(yield _.go())||5}if(i){if(r)r=pr(r);else{const E=new R.MxCADUiPrPoint;if(E.setMessage(`
指定正多变形的中心点`),E.setKeyWords(""),E.clearLastInputPoint(),r=yield E.go(),!r)return}let _=R.McGeVector3d.kXAxis,w;if(!f){const E=new R.MxCADUiPrDist;E.setMessage(R._ML_String("MxAiDrawPolygon_radius","指定圆的半径")),E.setKeyWords(""),E.setBasePt(r),E.setUserDraw((I,F)=>{if(v){const B=I.distanceTo(r);_=I.sub(r);const O=r.clone().addvec(I.sub(r).normalize().mult(B)),W=i_(r,O,l),Z=new R.McDbPolyline;W.forEach(ie=>{Z.addVertexAt(ie)}),Z.isClosed=!0,F.drawMcDbEntity(Z)}else{w=I;const B=new R.McDbPolyline;r_(r,I,l).forEach(O=>{B.addVertexAt(O)}),B.isClosed=!0,F.drawMcDbEntity(B)}});const P=yield E.go();if(!P)return;f=P}const b=new R.McDbPolyline;if(b.isClosed=!0,v){const E=r.clone().addvec(_.normalize().mult(f));i_(r,E,l).forEach(I=>{b.addVertexAt(I)})}else{if(!w){const E=R.McGeVector3d.kXAxis.clone().rotateBy(Math.PI/l).mult(f);w=r.clone().addvec(E)}r_(r,w,l).forEach(E=>{b.addVertexAt(E)})}R.MxCpp.getCurrentMxCAD().drawEntity(b)}else{const _=b=>{const E=new R.McDbPolyline;return y2(c,b,l||5).forEach(I=>{E.addVertexAt(I)}),E.isClosed=!0,E};if(c)c=pr(c);else{const b=new R.MxCADUiPrPoint;if(b.clearLastInputPoint(),b.setMessage(`
指定边的第一个端点`),b.setKeyWords(""),c=yield b.go(),!c)return;b.setUserDraw((E,P)=>{P.drawMcDbEntity(_(E))})}if(h)h=pr(h);else{const b=new R.MxCADUiPrPoint;b.setBasePt(c),b.setMessage(`
指定边的第二个端点`),h=yield b.go()}if(!h)return;const w=_(h);R.MxCpp.getCurrentMxCAD().drawEntity(w)}})}regist_data(){return{filename:"DrawPolygon.json",name:"draw_polygon",description:"绘制正多边形",params:[{name:"isDrawToCenter",description:"是否用圆绘制多边形",type:"boolean",required:!0},{name:"sideNum",description:"边数",type:"int",required:!0},{name:"startPoint",description:"边绘制提供开始点",type:"tuple[float, float]",required:!0},{name:"endPoint",description:"边绘制提供结束点",type:"tuple[float, float]",required:!0},{name:"radius",description:"圆的半径",type:"number",required:!0},{name:"centerPoint",description:"圆心",type:"tuple[float, float]",required:!0},{name:"isTangentToTheCircle",description:"外切于圆",type:"boolean",required:!0}]}}}const v2=()=>{Mo.regist(x2)},o_=(e,t,i)=>{const l=Math.cos(i),c=Math.sin(i),h=t.x-e.x,f=t.y-e.y,r=h*l-f*c+e.x,v=h*c+f*l+e.y,_=t.z;return new R.McGePoint3d(r,v,_)},My=(e,t,i=0)=>{const l=new R.McGePoint3d((e.x+t.x)/2,(e.y+t.y)/2,(e.z+t.z)/2),c=new R.McGePoint3d(e.x,t.y,e.z),h=new R.McGePoint3d(t.x,e.y,t.z),f=o_(l,c,i),r=o_(l,h,i);return[e,f,t,r]},a_=(e,t)=>[t.x>=e.x&&t.y>=e.y,t.x<e.x&&t.y>=e.y,t.x<e.x&&t.y<e.y,t.x>=e.x&&t.y<e.y];function s_(e,t,i){if(t===0&&i===0)return e;const[l,c,h,f]=e,r=l.distanceTo(f),v=l.distanceTo(c),[_,w,b,E]=a_(l,h),P=w||b?-t:t,I=b||E?-i:i;if(r-Math.abs(P)*2<=0||v-Math.abs(I)*2<=0)return e;const F=new R.McGePoint3d(l.x+P,l.y,l.z),B=new R.McGePoint3d(l.x,l.y+I,l.z),O=new R.McGePoint3d(c.x,c.y-I,c.z),W=new R.McGePoint3d(c.x+P,c.y,c.z),Z=new R.McGePoint3d(h.x-P,h.y,h.z),ie=new R.McGePoint3d(h.x,c.y-I,h.z),$=new R.McGePoint3d(f.x,f.y+I,f.z),oe=new R.McGePoint3d(f.x-P,f.y,f.z);return[F,B,O,W,Z,ie,$,oe]}function _2(e,t,i){if(e.isEqualTo(t))return 0;let l=e.c().addvec(t.c().sub(e).mult(.5)),c=t.c().sub(e);c.rotateBy(Math.PI/2,R.McGeVector3d.kZAxis);let h=new R.McDbLine(l,l.c().addvec(c)),f=i.c();f.rotateBy(Math.PI/2,R.McGeVector3d.kZAxis);let r=new R.McDbLine(e,e.c().addvec(f)),v=h.IntersectWith(r,R.McDb.Intersect.kExtendBoth);if(v.isEmpty())return 0;let _=v.at(0),w=_.distanceTo(e);c.normalize(),c.mult(w);let b=_.c().addvec(c),E=_.c().subvec(c),P=b.c().sub(e),I=E.c().sub(e),F=b;return P.angleTo1(i)>I.angleTo1(i)&&(F=E),R.MxCADUtility.calcBulge(e,F,t).val}class b2{call(t){return Pn(this,null,function*(){console.log(t),R.MxCpp.getCurrentMxCAD().newFile();let{pt1:i,pt2:l,chamfer1Length:c,chamfer2Length:h,filletRadius:f,lineWidth:r,area:v,rectLength:_,rectWidth:w,rotationAngle:b}=t;const E=(F,B)=>{const[O,W,Z,ie]=My(F,B,b),$=new R.McDbPolyline;return $.addVertexAt(O,0,r,r),$.addVertexAt(W,0,r,r),$.addVertexAt(Z,0,r,r),$.addVertexAt(ie,0,r,r),$.isClosed=!0,r&&($.constantWidth=r),$},P=(F,B)=>{let O;if(f){const W=s_(My(F,B,b),f,f),[Z,ie,$,oe]=a_(F,B);if(W.length===8){O||(O=new R.McDbPolyline);const be=(Re,Ie,He)=>{let Ue=new R.McGeVector3d(He);const ot=_2(Re,Ie,Ue);O.addVertexAt(Re,ot,r,r),O.addVertexAt(Ie,0,r,r)},fe=new R.McGeVector3d(-1,0),Le=new R.McGeVector3d(0,1),Xe=new R.McGeVector3d(1,0),Ne=new R.McGeVector3d(0,-1);oe&&(Le.y=-1,Xe.x=1,Ne.y=1),ie&&(fe.x=1,Le.y=1,Xe.x=-1,Ne.y=-1),$&&(fe.x=1,Le.y=-1,Xe.x=-1,Ne.y=1),be(W[0],W[1],fe),be(W[2],W[3],Le),be(W[4],W[5],Xe),be(W[6],W[7],Ne),O.isClosed=!0}}else(c||h)&&(O||(O=new R.McDbPolyline),s_(My(F,B,b),c||h,h||c).forEach(Z=>{O.addVertexAt(Z)}),O.isClosed=!0);return O||(O=E(F,B)),r&&(O.constantWidth=r),O};if(i)i=pr(i);else{const F=new R.MxCADUiPrPoint;if(F.setMessage("指定第一个角点"),F.setKeyWords(""),i=yield F.go(),!i)return}if(v&&(_&&(w=v/_),w&&(_=v/w)),_&&w&&(l=new R.McGePoint3d(i.x+w,i.y+_,0)),l)l=pr(l);else{const F=new R.MxCADUiPrPoint;if(F.setMessage("指定第二个角点"),F.setKeyWords(""),F.setUserDraw((B,O)=>{O.drawMcDbEntity(P(i,B))}),l=yield F.go(),!l)return}const I=P(i,l);ds(I,t),R.MxCpp.getCurrentMxCAD().drawEntity(I)})}regist_data(){return{filename:"drawRect.json",name:"draw_rect",description:"根据一些信息绘制矩形",params:[{name:"pt1",description:"一个对角点",type:"tuple[float, float]",required:!0},{name:"pt2",description:"另一个对角点",type:"tuple[float, float]",required:!0},{name:"lineWidth",description:"矩形线的宽",type:"float",required:!0},{name:"filletRadius",description:"圆角半径",type:"float",required:!0},{name:"chamfer1Length",description:"第一个倒角距离",type:"float",required:!0},{name:"chamfer2Length",description:"第二个倒角距离",type:"float",required:!0},{name:"rectLength",description:"长度",type:"float",required:!0},{name:"rectWidth",description:"矩形宽度",type:"float",required:!0},{name:"area",description:"面积",type:"float",required:!0},{name:"rotationAngle",description:"旋转角度",type:"float",required:!0},...hs]}}}function w2(){Mo.regist(b2)}const na=(e,t,i,l,c)=>{const h=new R.McDbEllipse,f=new R.McGePoint3d((e.x+t.x)/2,(t.y+t.y)/2),r=e.sub(t),v=r,_=e.distanceTo(t)/2,b=i/2/_;return h.center=f,h.majorAxis=r,h.minorAxis=v,h.radiusRatio=b,h.startAngle=l,h.endAngle=c,h};class A2{call(t){return Pn(this,null,function*(){let{endPoint1:i,endPoint2:l,halfAxisLength:c}=t;const h=R.MxCpp.getCurrentMxCAD();h.newFile();const f=new R.MxCADUiPrPoint,r=new R.MxCADUiPrDist;if(i&&(i=pr(i)),l&&(l=pr(l)),!i&&(f.setMessage("指定椭圆的轴端点1"),f.setKeyWords(""),f.setUserDraw((_,w)=>{l&&c&&w.drawMcDbEntity(na(_,l,c,0,Math.PI*2))}),i=yield f.go(),!i)||!l&&(f.setMessage("指定椭圆的轴端点2"),f.setKeyWords(""),f.setUserDraw((_,w)=>{i&&c&&w.drawMcDbEntity(na(i,_,c,0,Math.PI*2))}),l=yield f.go(),!l))return;if(!c){r.setMessage("指定半轴长度"),r.setKeyWords("");const _=new R.McGePoint3d((i.x+l.x)/2,(l.y+l.y)/2);if(r.setBasePt(_),r.setUserDraw((w,b)=>{i&&b.drawMcDbEntity(na(i,l,_.distanceTo(w),0,Math.PI*2))}),c=yield r.go(),!c)return}const v=na(i,l,c,0,Math.PI*2);ds(v,t),h.drawEntity(v)})}regist_data(){return{filename:"drawellipse.json",name:"draw_ellipse",description:"绘制椭圆",params:[{name:"endPoint1",description:"椭圆端点1",type:"tuple[float, float]",required:!0},{name:"endPoint2",description:"椭圆端点2",type:"tuple[float, float]",required:!0},{name:"halfAxisLength",description:"半轴长度",type:"float",required:!0},...hs]}}}class M2{call(t){return Pn(this,null,function*(){let{endPoint1:i,endPoint2:l,halfAxisLength:c,startAngle:h,endAngle:f}=t;const r=R.MxCpp.getCurrentMxCAD();r.newFile();const v=new R.MxCADUiPrPoint,_=new R.MxCADUiPrDist;if(i&&(i=pr(i)),l&&(l=pr(l)),h&&(h=h*(Math.PI/180)),f&&(f=f*(Math.PI/180)),!i&&(v.setMessage("指定椭圆的轴端点1"),v.setKeyWords(""),v.setUserDraw((P,I)=>{l&&c&&I.drawMcDbEntity(na(P,l,c,0,Math.PI*2))}),i=yield v.go(),!i)||!l&&(v.setMessage("指定椭圆的轴端点2"),v.setKeyWords(""),v.setUserDraw((P,I)=>{i&&c&&I.drawMcDbEntity(na(i,P,c,0,Math.PI*2))}),l=yield v.go(),!l))return;const w=new R.McGePoint3d((i.x+l.x)/2,(l.y+l.y)/2);if(!c&&(_.setMessage("指定半轴长度"),_.setKeyWords(""),_.setBasePt(w),_.setUserDraw((P,I)=>{i&&I.drawMcDbEntity(na(i,l,w.distanceTo(P),0,Math.PI*2))}),c=yield _.go(),!c))return;const b=Sh(w.x,w.y,i.x,i.y);if(!h){_.setMessage(R._ML_String("EllipticalArc_startAngle","指定起点角度")),_.setKeyWords(""),_.setUserDraw((I,F)=>{h=Sh(w.x,w.y,I.x,I.y)-b-Math.PI,F.drawMcDbEntity(na(i,l,c,h,Math.PI*2))});const P=yield _.go();if(!P)return;_.getDetailedResult()==Ke.DetailedResult.kCoordIn&&(h=P*(180/Math.PI))}if(!f){_.setLastInputPoint(w),_.setMessage(R._ML_String("EllipticalArc_endAngle","指定端点角度")),_.setKeyWords(""),_.setUserDraw((I,F)=>{f=Sh(w.x,w.y,I.x,I.y)-b-Math.PI,F.drawMcDbEntity(na(i,l,c,h,f))});const P=yield _.go();if(!P)return;_.getDetailedResult()===Ke.DetailedResult.kCoordIn&&(f=P*(180/Math.PI))}const E=na(i,l,c,h,f);ds(E,t),r.drawEntity(E)})}regist_data(){return{filename:"drawellipseArc.json",name:"draw_ellipse_arc",description:"绘制椭圆弧",params:[{name:"endPoint1",description:"椭圆弧端点1",type:"tuple[float, float]",required:!0},{name:"endPoint2",description:"椭圆弧端点2",type:"tuple[float, float]",required:!0},{name:"halfAxisLength",description:"半轴长度",type:"float",required:!0},{name:"startAngle",description:"开始角度",type:"float",required:!0},{name:"endAngle",description:"结束角度",type:"float",required:!0},...hs]}}}const S2=()=>{Mo.regist(A2),Mo.regist(M2)},l_=class ta{constructor(t,i,l=50){this.width=50,this.isDraw=!1,this.update(t,i,l)}update(t,i,l=this.width){let c=t.clone().sub(i).normalize();c=new R.McGeVector3d(-c.y,c.x,0).mult(l/2);const h=c.clone().negate();this.outsidePoints=[t.clone().addvec(c),i.clone().addvec(c)],this.insidePoints=[t.clone().addvec(h),i.clone().addvec(h)],this.width=l,this.startPoint=t.clone(),this.endPoint=i.clone(),this.outsideLine?(this.outsideLine.startPoint=this.outsidePoints[0],this.outsideLine.endPoint=this.outsidePoints[1]):this.outsideLine=new R.McDbLine(this.outsidePoints[0],this.outsidePoints[1]),this.insideLine?(this.insideLine.startPoint=this.insidePoints[0],this.insideLine.endPoint=this.insidePoints[1]):this.insideLine=new R.McDbLine(this.insidePoints[0],this.insidePoints[1]),this.startClosedLine?(this.startClosedLine.startPoint=this.outsidePoints[0],this.startClosedLine.endPoint=this.insidePoints[0]):this.startClosedLine=new R.McDbLine(this.outsidePoints[0],this.insidePoints[0]),this.endClosedLine?(this.endClosedLine.startPoint=this.outsidePoints[1],this.endClosedLine.endPoint=this.insidePoints[1]):this.endClosedLine=new R.McDbLine(this.outsidePoints[1],this.insidePoints[1])}clone(){const t=new ta(this.startPoint,this.endPoint,this.width);return t.insideLine=this.insideLine.clone(),t.outsideLine=this.outsideLine.clone(),t}hiddenStartClosedLine(){this.startClosedLine.visible=!1}hiddenEndClosedLine(){this.endClosedLine.visible=!1}getClosedStartLineToDiffWallInsideLineIntersectionPoint(t,i=!1){return this.startClosedLine.visible?Wr(t.insideLine.startPoint,t.insideLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,i):null}getClosedStartLineToDiffWallOutsideLineIntersectionPoint(t,i=!1){return this.startClosedLine.visible?Wr(t.outsideLine.startPoint,t.outsideLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,i):null}getClosedEndLineToDiffWallInsideLineIntersectionPoint(t,i=!1){return this.endClosedLine.visible?Wr(t.insideLine.startPoint,t.insideLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,i):null}getClosedEndLineToDiffWallOutsideLineIntersectionPoint(t,i=!1){return this.endClosedLine.visible?Wr(t.outsideLine.startPoint,t.outsideLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,i):null}getInsideToDiffInsideIntersectionPoint(t,i=!1){return Wr(t.insideLine.startPoint,t.insideLine.endPoint,this.insideLine.startPoint,this.insideLine.endPoint,i)}getOutsideToDiffOutsideIntersectionPoint(t,i=!1){return Wr(t.outsideLine.startPoint,t.outsideLine.endPoint,this.outsideLine.startPoint,this.outsideLine.endPoint,i)}getInsideToDiffOutsideIntersectionPoint(t,i=!1){return Wr(t.outsideLine.startPoint,t.outsideLine.endPoint,this.insideLine.startPoint,this.insideLine.endPoint,i)}getOutsideToDiffInsideIntersectionPoint(t,i=!1){return Wr(t.insideLine.startPoint,t.insideLine.endPoint,this.outsideLine.startPoint,this.outsideLine.endPoint,i)}getClosedStartLineToDiffLineClosedStartLineIntersectionPoint(t,i=!1){return this.startClosedLine.visible?Wr(t.startClosedLine.startPoint,t.startClosedLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,i):null}getClosedStartLineToDiffLineClosedEndLineIntersectionPoint(t,i=!1){return this.startClosedLine.visible?Wr(t.endClosedLine.startPoint,t.endClosedLine.endPoint,this.startClosedLine.startPoint,this.startClosedLine.endPoint,i):null}getClosedEndLineToDiffLineClosedStartLineIntersectionPoint(t,i=!1){return this.endClosedLine.visible?Wr(t.startClosedLine.startPoint,t.startClosedLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,i):null}getClosedEndLineToDiffLineClosedEndLineIntersectionPoint(t,i=!1){return this.endClosedLine.visible?Wr(t.endClosedLine.startPoint,t.endClosedLine.endPoint,this.endClosedLine.startPoint,this.endClosedLine.endPoint,i):null}isCorner(t){const i=t.startPoint.sub(t.endPoint).normalize(),l=i.clone().mult(t.width),c=i.clone().mult(-t.width),h=t.insideLine.startPoint.clone().addvec(l),f=t.insideLine.startPoint.clone().addvec(c),r=t.outsideLine.startPoint.clone().addvec(c),v=t.outsideLine.startPoint.clone().addvec(l),_=t.insideLine.endPoint.clone().addvec(l),w=t.insideLine.endPoint.clone().addvec(c),b=t.outsideLine.endPoint.clone().addvec(c),E=t.outsideLine.endPoint.clone().addvec(l),P=gc([h,f,r,v],this.startPoint),I=gc([h,f,r,v],this.endPoint),F=gc([_,w,b,E],this.startPoint),B=gc([_,w,b,E],this.endPoint);return[{start:P,end:I},{start:F,end:B}]}handlingCorners(t){const[i,l]=this.isCorner(t);if(l.start){this.outsideLine.startPoint=t.outsideLine.endPoint=this.getOutsideToDiffOutsideIntersectionPoint(t,!0),this.insideLine.startPoint=t.insideLine.endPoint=this.getInsideToDiffInsideIntersectionPoint(t,!0),this.hiddenStartClosedLine(),t.hiddenEndClosedLine();return}else if(l.end){this.outsideLine.endPoint=t.insideLine.endPoint=this.getOutsideToDiffInsideIntersectionPoint(t,!0),this.insideLine.endPoint=t.outsideLine.endPoint=this.getInsideToDiffOutsideIntersectionPoint(t,!0),this.hiddenEndClosedLine(),t.hiddenEndClosedLine();return}else if(i.start){this.insideLine.startPoint=t.outsideLine.startPoint=this.getInsideToDiffOutsideIntersectionPoint(t,!0),this.outsideLine.startPoint=t.insideLine.startPoint=this.getOutsideToDiffInsideIntersectionPoint(t,!0),this.hiddenStartClosedLine(),t.hiddenStartClosedLine();return}else if(i.end){this.outsideLine.endPoint=t.outsideLine.startPoint=this.getOutsideToDiffOutsideIntersectionPoint(t,!0),this.insideLine.endPoint=t.insideLine.startPoint=this.getInsideToDiffInsideIntersectionPoint(t,!0),this.hiddenEndClosedLine(),t.hiddenStartClosedLine();return}}processingIntersection(){const t=[];ta.lines.forEach(i=>{const l=this.getInsideToDiffInsideIntersectionPoint(i),c=this.getInsideToDiffOutsideIntersectionPoint(i),h=this.getOutsideToDiffOutsideIntersectionPoint(i),f=this.getOutsideToDiffInsideIntersectionPoint(i);(l||c||h||f)&&t.push({diffLine:i,intersectionPoints:[l,c,h,f]})}),t.forEach(({diffLine:i,intersectionPoints:l})=>{const[c,h]=this.isCorner(i);c.end||c.start||h.start||h.start;const[f,r,v,_]=l,w=[i.insideLine.startPoint,i.insideLine.endPoint,i.outsideLine.endPoint,i.outsideLine.startPoint];if(gc(w,this.startPoint),gc(w,this.endPoint),f&&r&&v&&_){const b=Wr(this.startPoint,this.endPoint,i.startPoint,i.endPoint),E=new ta(this.startPoint,b,this.width),P=new ta(b,this.endPoint,this.width),I=new ta(i.startPoint,b,i.width),F=new ta(b,i.endPoint,i.width);E.insideLine.startPoint=this.insideLine.startPoint,E.outsideLine.startPoint=this.outsideLine.startPoint,P.insideLine.endPoint=this.insideLine.endPoint,P.outsideLine.endPoint=this.outsideLine.endPoint,i.remove(),this.remove(),E.draw(),P.draw(),I.draw(),F.draw()}else if(v&&r||f&&_){const b=Wr(this.startPoint,this.endPoint,i.startPoint,i.endPoint,!0),E=new ta(i.startPoint,b,i.width);E.hiddenEndClosedLine();const P=new ta(b,i.endPoint,i.width);P.hiddenStartClosedLine(),i.remove(),E.draw(),P.draw()}else{if(t.length===1)return this.handlingCorners(i);h.start?(console.log("endCorner.start"),v&&(i.outsideLine.endPoint=this.outsideLine.startPoint=v),f&&(i.insideLine.endPoint=this.insideLine.startPoint=f),this.hiddenStartClosedLine(),i.hiddenEndClosedLine()):h.end?(console.log("endCorner.end"),_&&(i.insideLine.endPoint=this.outsideLine.endPoint=_),r&&(i.outsideLine.endPoint=this.insideLine.endPoint=r),this.hiddenEndClosedLine(),i.hiddenEndClosedLine()):c.start?(console.log("startCorner.start"),r&&(i.outsideLine.startPoint=this.insideLine.startPoint=r),_&&(i.insideLine.startPoint=this.outsideLine.startPoint=_),i.hiddenStartClosedLine(),this.hiddenStartClosedLine()):c.end&&(console.log("startCorner.end"),v&&(i.outsideLine.startPoint=this.outsideLine.endPoint=v),f&&(i.insideLine.startPoint=this.insideLine.endPoint=f),i.hiddenStartClosedLine(),this.hiddenEndClosedLine())}})}draw(t=!0){if(this.isDraw)return;const i=R.MxCpp.getCurrentMxCAD();if(this.outsideLine&&this.outsideLine.erase(),this.insideLine&&this.insideLine.erase(),!i)return;this.outsideLine.trueColor=new R.McCmColor(255,0,0),this.outsideId=i.drawEntity(this.outsideLine),this.insideLine.trueColor=new R.McCmColor(0,255,255),this.insideId=i.drawEntity(this.insideLine);const l=this.outsideId.getMcDbEntity();l&&(this.outsideLine=l);const c=this.insideId.getMcDbEntity();c&&(this.insideLine=c),this.startClosedId=i.drawEntity(this.startClosedLine),this.endClosedId=i.drawEntity(this.endClosedLine);const h=this.startClosedId.getMcDbEntity();h&&(this.startClosedLine=h);const f=this.endClosedId.getMcDbEntity();f&&(this.endClosedLine=f),i.updateDisplay(),ta.lines.add(this),this.isDraw=!0,t&&this.processingIntersection()}remove(){this.endClosedId&&this.endClosedId.erase(),this.startClosedId&&this.startClosedId.erase(),this.insideId&&this.insideId.erase(),this.outsideId&&this.outsideId.erase(),ta.lines.delete(this)}};l_.lines=new Set;let T2=l_;class E2{call(t){if(t&&t.points){let i=R.MxCpp.getCurrentMxCAD();const l=u2(t.points);if(l.length<2)return;l.forEach((c,h)=>{const f=l[h+1];if(!f)return;new T2(c,f,t.width).draw()}),i.updateDisplay()}}regist_data(){return{filename:"drawWall.json",name:"drawWall",description:"根据坐标点合集绘制墙",params:[{name:"points",description:"绘制墙的坐标点",type:"str",required:!0},{name:"width",description:"绘制墙的宽度",type:"float",required:!1},...hs]}}}class P2{call(t){return Pn(this,null,function*(){let i=R.MxCpp.App.getCurrentMxCAD();if(t.name){const c=i.getDatabase().getBlockTable().get(t.name);if(!c||!c.isValid())return;let h=new R.McDbBlockReference;h.blockTableRecordId=c;let f=h.getBoundingBox(),r=0;if(f.ret){let v=f.maxPt.distanceTo(f.minPt);v>1e-5&&(r=i.getMxDrawObject().screenCoordLong2Doc(100)/v,h.setScale(r))}h.position=new R.McGePoint3d(t.pos[0],t.pos[1]),i.drawEntity(h),i.updateDisplay()}})}regist_data(){return{filename:"insertBock.json",name:"insertBock",description:"放置插入某个物品",params:[{name:"name",description:"要放置插入的物品名称",type:"str",required:!0},{name:"pos",description:"要放置插入物品的位置",type:"tuple[float, float]",required:!0}]}}}function C2(){Mo.regist(E2),Mo.regist(P2)}class R2{call(t){return Pn(this,null,function*(){let i=R.MxCpp.getCurrentMxCAD();console.log(t),i.newFile();let l;const c=typeof t.isMText=="undefined"?!1:t.isMText,h=()=>{const r=new R.McDbMText;return r.textHeight=t.textSize||100,r.location=t.textPos||new R.McGePoint3d,r.contents=t.textString||"",r},f=()=>{const r=new R.McDbText;return r.height=t.textSize||100,r.textString=t.textString||"",r.position=t.textPos||new R.McGePoint3d,r};if(!t.textString){const r=new R.MxCADUiPrString;r.setMessage("请输入文字");const v=yield r.go();if(!v)return;t.textString=v}if(t.textPos)t.textPos=pr(t.textPos);else{const r=new R.MxCADUiPrPoint;r.clearLastInputPoint(),r.setMessage("请指定文字位置");const v=yield r.go();if(r.setUserDraw((_,w)=>{if(t.textPos=_,c){const b=h();w.drawMcDbEntity(b)}else{const b=f();w.drawMcDbEntity(b)}}),!v)return;t.textPos=v}if(!t.textSize){const r=new R.MxCADUiPrPoint;r.clearLastInputPoint(),r.setMessage("通过线段长度确定文字高度");const v=yield r.go();if(v){r.setUserDraw((w,b)=>{if(t.textSize=v.distanceTo(w),c){const E=h();b.drawMcDbEntity(E)}else{const E=f();b.drawMcDbEntity(E)}});const _=yield r.go();_&&(t.textSize=_.distanceTo(v))}}if(c){const r=h();l=i.drawEntity(r)}else{const r=f();l=i.drawEntity(r)}ds(l.getMcDbEntity(),t),i.updateDisplay()})}regist_data(){return{filename:"drawText.json",name:"draw_text",description:"绘制或者插入文字或者多行文字(文本)",params:[{name:"isMText",description:"绘制的文字是否为多行文字",type:"boolean",required:!0},{name:"textString",description:"绘制的文字的内容",type:"str",required:!0},{name:"textPos",description:"绘制的文字的位置",type:"tuple[float, float]",required:!0},{name:"textSize",description:"绘制的文字的高度",type:"float",required:!0},...hs]}}}function D2(){Mo.regist(R2)}class I2{call(t){if(console.log(t),t.isWithdraw){typeof t.withdrawNum!="number"&&(t.withdrawNum=1);for(let i=0;i<t.withdrawNum;i++)Ke.MxFun.sendStringToExecute("Mx_Undo")}if(t.isRestore){typeof t.restoreNum!="number"&&(t.restoreNum=1);for(let i=0;i<t.restoreNum;i++)Ke.MxFun.sendStringToExecute("Mx_Redo")}}regist_data(){return{filename:"call_withdraw_restore.json",name:"call_withdraw_restore",description:"撤回撤销和恢复",params:[{name:"isWithdraw",description:"是否要撤回或撤销",type:"boolean",required:!0},{name:"isRestore",description:"是否要恢复",type:"boolean",required:!0},{name:"withdrawNum",description:"撤回撤销(上)几步",type:"int",required:!1},{name:"restoreNum",description:"恢复(前)几步",type:"int",required:!1}]}}}function L2(){Mo.regist(I2)}class F2{constructor(){this.aryRegData=[]}regist(t){let i=new t,l=i.regist_data();R.MxCpp.Ai.addFunction(l.name,i.call),this.aryRegData.push(l)}regist_server(t){this.aryRegData.forEach(i=>{i.operation_code=t,R.MxCpp.Ai.registTool(i)}),R.MxCpp.Ai.reloadTools({operation_code:t})}}let Mo=new F2;function k2(){return Pn(this,null,function*(){let e=new R.MxCADUiPrString;e.setMessage(`
 human:`);let t=yield e.go();t&&R.MxCpp.Ai.chat_tool(t)})}function B2(){return Pn(this,null,function*(){let e=new R.MxCADUiPrString;e.setMessage(`
 输入 server_operate_code:`);let t=yield e.go();t&&Mo.regist_server(t)})}function z2(){Ke.MxFun.addCommand("Mx_Ai",k2),Ke.MxFun.addCommand("Mx_AiRegistServer",B2),d2(),f2(),g2(),v2(),S2(),C2(),D2(),L2(),w2()}function U2(e,t){let i=40,l=new R.MxCADResbuf;l.AddString("电杆层",0),l.AddString("INSERT",5020);let c=new R.MxCADSelectionSet;c.crossingSelect(e.x-i,e.y-i,e.x+i,e.y+i,l);let h=[];if(c.forEach(f=>{let r=f.getMcDbEntity();if(r){let v=r;t[v.getObjectID().id]&&h.push({dist:v.position.distanceTo(e),blk:t[v.getObjectID().id]})}}),h.length!=0)return h.sort((f,r)=>f.dist-r.dist),h[0].dist<i?h[0].blk:!1}function N2(e,t,i){let l=t[e],c=l.ref,h=40,f=new R.MxCADResbuf;f.AddString("0",0),f.AddString("LINE",5020);let r=new R.MxCADSelectionSet;r.crossingSelect(c.position.x-h,c.position.y-h,c.position.x+h,c.position.y+h,f),r.forEach(v=>{let _=v.getMcDbEntity();if(_){let w=_,b=w.endPoint,E=w.startPoint.distanceTo(c.position);if(E>w.endPoint.distanceTo(c.position)&&(E=w.endPoint.distanceTo(c.position),b=w.startPoint),E<h&&!w[w.getObjectID().id]){let P=U2(b,t);P&&(i[w.getObjectID().id]={tag1:l.tag,tag2:P.tag,handle:w.getHandle()})}}})}function V2(){return Pn(this,null,function*(){let e=new R.MxCADSelectionSet,t=new R.MxCADResbuf;t.AddString("电杆层",0),t.AddString("INSERT",5020),e.allSelect(t);let i={};e.forEach(c=>{let h=c.getMcDbEntity();if(h){let f=h,r=f.getAllAttribute(),v={};r.forEach(_=>{let w=_.getMcDbEntity();w.tag=="杆号"&&(v.tag=w.textString)}),v.tag&&(v.handle=f.getHandle(),i[c.id]={ref:f,tag:v.tag},console.log(v))}});let l={};Object.keys(i).forEach(c=>{N2(c,i,l)}),Object.keys(l).forEach(c=>{console.log(l[c])})})}function O2(){Ke.MxFun.addCommand("MxTest_UserGetData",V2)}function G2(){O2()}const j2="modulepreload",H2=function(e){return"/"+e},c_={},Sy=function(t,i,l){return t()};var u_=Object.defineProperty,W2=(e,t,i)=>t in e?u_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,It=(e,t)=>u_(e,"name",{value:t,configurable:!0}),So=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),Li=(e,t,i)=>W2(e,typeof t!="symbol"?t+"":t,i),sf,h_=(sf=class{constructor(e){this._listeners=new Map,this._lastMessage={},this.options=Object.assign({ignoreError:!1},e)}get listeners(){return this._listeners}on(){let e=arguments[0],t=arguments[1],i=arguments[2],{objectify:l=!0,count:c=-1}=Object.assign({},i);this._listeners.has(e)||this._listeners.set(e,new Map);let h=++sf.listenerSeqId,f=this._listeners.get(e);return f==null||f.set(h,[t,c]),this._emitRetainEvent(e,h,f),l?{off:It(()=>{f==null||f.delete(h),(f==null?void 0:f.size)==0&&this._listeners.delete(e)},"off")}:h}onAny(e,t){return this.on("*",e,t)}_emitRetainEvent(e,t,i){e in this._lastMessage&&this._executeListener(t,i,this._lastMessage[e])}once(e,t,i){return this.on(e,t,Object.assign({},i,{count:1}))}_forEachListeners(e){let t=!1;for(let[i,l]of this._listeners.entries()){if(t)break;for(let[c,[h,f]]of l.entries()){if(t)break;t=e({event:i,listenerId:c,listener:h,count:f,eventListeners:l})===!1}}}_forEachEventListeners(e,t){let i=!1,l=[[e,this._listeners.get(e)]];for(let[c,h]of l)if(h)for(let[f,[r,v]]of h){if(i)break;i=t({event:c,listenerId:f,listener:r,count:v,eventListeners:h})===!1}}off(){if(arguments.length==1){if(typeof arguments[0]=="number")this._forEachListeners(({listenerId:e,eventListeners:t,event:i})=>{var l;if(e==arguments[0])return t.delete(e),((l=this._listeners.get(i))==null?void 0:l.size)==0&&this._listeners.delete(i),!1});else if(typeof arguments[0]=="function"){let e=arguments[0];this._forEachListeners(({listenerId:t,listener:i,eventListeners:l,event:c})=>{var h;i==e&&(l.delete(t),((h=this._listeners.get(c))==null?void 0:h.size)==0&&this._listeners.delete(c))})}}else arguments.length==2&&typeof arguments[0]=="string"&&typeof arguments[1]=="function"&&this._forEachEventListeners(arguments[0],({event:e,listenerId:t,listener:i,eventListeners:l})=>{var c;e==arguments[0]&&i==arguments[1]&&(l.delete(t),((c=this._listeners.get(e))==null?void 0:c.size)==0&&this._listeners.delete(e))})}waitFor(e,t=0){return new Promise((i,l)=>{let c,h=!1,f;t>0&&(c=setTimeout(()=>{h=!0,this.off(f),l(new Error("Timeout"))},t)),f=this.once(e,r=>{h||(clearTimeout(c),i(r))})})}offAll(e){e?this._listeners.delete(e):this._listeners.clear()}_executeListener(e,t,i){if(!t)return;let l=t.get(e);if(l)try{return l[0](i)}catch(c){if(!this.options.ignoreError)throw c}finally{l[1]>-1&&(l[1]=l[1]-1,l[1]==0&&t.delete(e))}}_executeListeners(e,t,i){let l=[];return this._forEachEventListeners(e,({event:c,listenerId:h,eventListeners:f})=>{l.push(this._executeListener(h,f,t)),typeof i=="function"&&i(h),f.size==0&&this._listeners.delete(c)}),l}emit(e,t,i){return i&&(this._lastMessage[e]=t),this._executeListeners(e,t)}emitAsync(e,t,i){return Pn(this,null,function*(){return yield Promise.allSettled(this.emit(e,t,i))})}},It(sf,"l"),sf);h_.listenerSeqId=0;var d_=h_;(e=>typeof So<"u"?So:typeof Proxy<"u"?new Proxy(e,{get:It((t,i)=>(typeof So<"u"?So:t)[i],"get")}):e)(function(e){if(typeof So<"u")return So.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});function p_(){return Date.now().toString()+parseInt(String(Math.random()*1e3))}It(p_,"getId");function lf(e,t=!1){if(typeof e=="number")return!0;if(typeof e!="string"||t)return!1;try{if(e.includes(".")){let i=parseFloat(e);return e.endsWith(".")?!isNaN(i)&&String(i).length===e.length-1:!isNaN(i)&&String(i).length===e.length}else{let i=parseInt(e);return!isNaN(i)&&String(i).length===e.length}}catch(i){return!1}}It(lf,"r");function cf(e){return lf(e)}It(cf,"isMessageId");function f_(e){return e&&typeof e=="object"&&e.__VoerkaI18nScope__}It(f_,"isI18nScope");function m_(e){return Pn(this,null,function*(){let t=yield e.call(this);return t&&"__esModule"in t||Symbol.toStringTag in t?t.default:t})}It(m_,"loadAsyncModule");function g_(e){return e&&typeof e.get=="function"&&typeof e.set=="function"&&typeof e.remove=="function"}It(g_,"isStorage");function y_(e){return Pn(this,null,function*(){return(yield Promise.allSettled(e)).map(t=>t.status==="fulfilled"?t.value:t.reason)})}It(y_,"execAsyncs");function Ty(){try{return typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"}catch(e){return!1}}It(Ty,"isBrowser");var Ey=class wy extends d_{constructor(t){if(super(),Li(this,"__VoerkaI18nManager__",!0),Li(this,"_scopes",[]),Li(this,"_appScope"),wy.instance)return wy.instance;if(!t)throw new Error("create VoerkaI18nManager failed, appScope is required");this._registerAppScope(t),this._registerScopes(),this._loadPlugins(),wy.instance=this,globalThis.VoerkaI18n=this}get debug(){return this.scope.debug}get logger(){return this.scope.logger}get scopes(){return this._scopes}get activeLanguage(){return this._appScope.activeLanguage}get defaultLanguage(){return this._appScope.defaultLanguage}get loader(){return this._appScope.loader}get storage(){return this.scope.storage}get languages(){return this.scope.languages}get scope(){return this._appScope}_registerScopes(){let t=globalThis.__VoerkaI18nScopes__;t&&Array.isArray(t)&&t.forEach(i=>this.register(i)),delete globalThis.__VoerkaI18nScopes__}getScope(t){return this._scopes.find(i=>i.id===t)}_loadPlugins(){let t=globalThis.__VoerkaI18nPlugins__;t&&Array.isArray(t)&&t.forEach(i=>i(this)),delete globalThis.__VoerkaI18nPlugins__}registerPlugin(t){typeof t=="function"&&t(this)}_registerAppScope(t){this._scopes.push(t),this._appScope=t,this.logger.debug("VoerkaI18nScope<"+t.id+"> is registered as appScope"),this.emitAsync("init",()=>this._appScope.activeLanguage,!0)}register(t){if(!f_(t))throw new Error("register scope failed, invalid scope");this._scopes.push(t),t.bind(this),this.logger.debug(`VoerkaI18nScope<${t.id}> is registered`)}change(t){return Pn(this,null,function*(){yield this._refreshScopes(t);let i=this._appScope.activeLanguage;return this.scope.saveLanguage(),this.emit("change",i,!0),this.logger.info("language changed to: "+i),i})}_refreshScopes(t){return Pn(this,null,function*(){let i=this._scopes.map(l=>l.refresh(t));yield y_(i)})}refresh(){return Pn(this,null,function*(){return yield this._refreshScopes(this.activeLanguage)})}ready(t,i){return this.waitFor("ready",i).then(l=>{t&&t.call(this,l)})}clearPatchedMessages(){this._scopes.forEach(t=>t.clearPatchedMessages())}hasLanguage(t){return this.languages.findIndex(i=>i.name==t)!=-1}clearLanguage(){this.scope.clearLanguage()}saveLanguage(){this.scope.saveLanguage()}restoreLanguage(){this.scope.restoreLanguage()}};It(Ey,"VoerkaI18nManager"),Li(Ey,"instance");var x_=Ey,q2={get(e){if(globalThis.localStorage)return globalThis.localStorage.getItem(e)},set(e,t){globalThis.localStorage&&globalThis.localStorage.setItem(e,t)},remove(e){globalThis.localStorage&&globalThis.localStorage.removeItem(e)}},Y2=[{name:"zh",title:"中文",default:!0,active:!0},{name:"en",title:"英文"}],v_=It((e,t,i=[])=>{let l=Object.getOwnPropertyDescriptors(t);for(let c of i)delete l[c];Object.defineProperties(e,l)},"copyProps"),yc=It((e,t=[e])=>{let i=Object.getPrototypeOf(e);return i===null?t:yc(i,[...t,i])},"protoChain"),X2=It((...e)=>{if(e.length===0)return;let t,i=e.map(l=>yc(l));for(;i.every(l=>l.length>0);){let l=i.map(h=>h.pop()),c=l[0];if(l.every(h=>h===c))t=c;else break}return t},"nearestCommonProto"),__=It((e,t,i=[])=>{var l;let c=(l=X2(...e))!==null&&l!==void 0?l:Object.prototype,h=Object.create(c),f=yc(c);for(let r of e){let v=yc(r);for(let _=v.length-1;_>=0;_--){let w=v[_];f.indexOf(w)===-1&&(v_(h,w,["constructor",...i]),f.push(w))}}return h.constructor=t,h},"hardMixProtos"),Py=It(e=>e.filter((t,i)=>e.indexOf(t)==i),"unique"),uf=It((e,t)=>{let i=t.map(h=>yc(h)),l=0,c=!0;for(;c;){c=!1;for(let h=t.length-1;h>=0;h--){let f=i[h][l];if(f!=null&&(c=!0,Object.getOwnPropertyDescriptor(f,e)!=null))return i[h][0]}l++}},"getIngredientWithProp"),K2=It((e,t=Object.prototype)=>new Proxy({},{getPrototypeOf(){return t},setPrototypeOf(){throw Error("Cannot set prototype of Proxies created by ts-mixer")},getOwnPropertyDescriptor(i,l){return Object.getOwnPropertyDescriptor(uf(l,e)||{},l)},defineProperty(){throw new Error("Cannot define new properties on Proxies created by ts-mixer")},has(i,l){return uf(l,e)!==void 0||t[l]!==void 0},get(i,l){return(uf(l,e)||t)[l]},set(i,l,c){let h=uf(l,e);if(h===void 0)throw new Error("Cannot set new properties on Proxies created by ts-mixer");return h[l]=c,!0},deleteProperty(){throw new Error("Cannot delete properties on Proxies created by ts-mixer")},ownKeys(){return e.map(Object.getOwnPropertyNames).reduce((i,l)=>l.concat(i.filter(c=>l.indexOf(c)<0)))}}),"proxyMix");It((e,t)=>K2([...e,{constructor:t}]),"softMixProtos");var b_=new WeakMap,Z2=It(e=>b_.get(e),"getMixinsForClass"),J2=It((e,t)=>b_.set(e,t),"registerMixins"),w_=It((e,t)=>{var i,l;let c=Py([...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(t)]),h={};for(let f of c)h[f]=Py([...(i=e==null?void 0:e[f])!==null&&i!==void 0?i:[],...(l=t==null?void 0:t[f])!==null&&l!==void 0?l:[]]);return h},"mergeObjectsOfDecorators"),A_=It((e,t)=>{var i,l,c,h;return{property:w_((i=e==null?void 0:e.property)!==null&&i!==void 0?i:{},(l=t==null?void 0:t.property)!==null&&l!==void 0?l:{}),method:w_((c=e==null?void 0:e.method)!==null&&c!==void 0?c:{},(h=t==null?void 0:t.method)!==null&&h!==void 0?h:{})}},"mergePropertyAndMethodDecorators"),M_=It((e,t)=>{var i,l,c,h,f,r;return{class:Py([...(i=e==null?void 0:e.class)!==null&&i!==void 0?i:[],...(l=t==null?void 0:t.class)!==null&&l!==void 0?l:[]]),static:A_((c=e==null?void 0:e.static)!==null&&c!==void 0?c:{},(h=t==null?void 0:t.static)!==null&&h!==void 0?h:{}),instance:A_((f=e==null?void 0:e.instance)!==null&&f!==void 0?f:{},(r=t==null?void 0:t.instance)!==null&&r!==void 0?r:{})}},"mergeDecorators"),Cy=new Map,Q2=It((...e)=>{var t;let i=new Set,l=new Set([...e]);for(;l.size>0;)for(let c of l){let h=yc(c.prototype).map(v=>v.constructor),f=(t=Z2(c))!==null&&t!==void 0?t:[],r=[...h,...f].filter(v=>!i.has(v));for(let v of r)l.add(v);i.add(c),l.delete(c)}return[...i]},"findAllConstituentClasses"),$2=It((...e)=>{let t=Q2(...e).map(i=>Cy.get(i)).filter(i=>!!i);return t.length==0?{}:t.length==1?t[0]:t.reduce((i,l)=>M_(i,l))},"deepDecoratorSearch");It((...e)=>{let t=e.map(i=>eS(i));return t.length===0?{}:t.length===1?t[0]:t.reduce((i,l)=>M_(i,l))},"directDecoratorSearch");var eS=It(e=>{let t=Cy.get(e);return t||(t={},Cy.set(e,t)),t},"getDecoratorsForClass");function S_(...e){var t,i,l;let c=e.map(r=>r.prototype);function h(...r){for(let v of e)v_(this,new v(...r))}It(h,"MixedClass"),h.prototype=__(c,h),Object.setPrototypeOf(h,__(e,null,["prototype"]));let f=h;{let r=$2(...e);for(let v of(t=r==null?void 0:r.class)!==null&&t!==void 0?t:[]){let _=v(f);_&&(f=_)}T_((i=r==null?void 0:r.static)!==null&&i!==void 0?i:{},f),T_((l=r==null?void 0:r.instance)!==null&&l!==void 0?l:{},f.prototype)}return J2(f,e),f}It(S_,"Mixin");var T_=It((e,t)=>{let i=e.property,l=e.method;if(i)for(let c in i)for(let h of i[c])h(t,c);if(l)for(let c in l)for(let h of l[c])h(t,c,Object.getOwnPropertyDescriptor(t,c))},"applyPropAndMethodDecorators"),E_=class{constructor(){Li(this,"_eventEmitter")}_getEventEmitter(){return this.attached?this.manager:(this._eventEmitter||(this._eventEmitter=new d_),this._eventEmitter)}on(t,i){return this._getEventEmitter().on(t,i)}once(t,i){return this._getEventEmitter().once(t,i)}off(t,i){return this._getEventEmitter().off(t,i)}waitFor(t,i){return this._getEventEmitter().waitFor(t,i)}emit(t,i,l){return Pn(this,null,function*(){return yield this._getEventEmitter().emitAsync(t,i,l)})}};It(E_,"EventEmitterMixin");var tS=E_;function ia(e){return e&&typeof e=="function"}It(ia,"t");function cl(e){if(typeof e!="object"||e===null)return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var i=t;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return t===i}It(cl,"o");var Ry,nS=(Ry=class extends Error{},It(Ry,"m"),Ry),iS=0;function P_(e,t={timeout:0}){let i=!1,l=!1,c=!1,h,f,r=0,v,_=++iS,w=It(function(){clearTimeout(r),i=!1,l=!1,c=!1,v=new Promise((E,P)=>{h=E,f=P})},"g");w();function b(E=0,P){return Pn(this,null,function*(){if(typeof e=="function"&&e()){i=!0;return}return(i||l)&&w(),E>0&&(r=setTimeout(()=>{i=!0;try{P instanceof Error?f(P):h(P)}catch(I){}},E)),c=!0,v})}return It(b,"o"),b.id=_,b.resolve=E=>{if(clearTimeout(r),!!c&&!(i||l)){if(typeof e=="function"&&e())if(e())h(E);else return;else h(E);i=!0}},b.reject=E=>{clearTimeout(r),c&&(i||l||(f(typeof E=="string"?new Error(E):E instanceof Error?E:new Error),l=!0))},b.destroy=()=>{clearTimeout(r),c&&f(new nS),i=!1,c=!1,l=!1,v=null},b.reset=w,b.isResolved=()=>i,b.isRejected=()=>l,b.isPending=()=>c,b}It(P_,"p");var C_=class{constructor(){Li(this,"_patching")}_getPatchKey(t){return`voerkai18n_${this.id}_${t}_patched_messages`}clearPatchedMessages(t){if(this.storage){let i=t?[t]:this.languages.map(l=>l.name);for(let l of i)this.storage.remove(this._getPatchKey(l))}}_patch(t){return Pn(this,null,function*(){var i;this._patching=P_(),t||(t=this.activeLanguage),this._restorePatchedMessages(this.activeMessages,t);try{if(ia(this.loader)){let l=yield this._loadMessagesFromLoader(t);cl(l)&&(Object.assign(this._activeMessages,l),this._setPatchedMessages(l,t),this.emit("patched",{language:t,scope:this.id}))}}catch(l){this.logger.warn(`从远程加载语言补丁包<${t}>时出错: ${l.stack}(scope=${this.id})`)}finally{(i=this._patching)==null||i.resolve(),this._patching=void 0}})}_restorePatchedMessages(t,i){let l=this._getPatchedMessages(i);cl(l)&&(Object.assign(t,l),this.emit("restore",{language:i,scope:this.id}),this.logger.debug(`成功恢复补丁语言包<${i}>(scope=${this.id})`))}_setPatchedMessages(t,i){if(!(!this.attached&&!this.storage))try{this.storage&&this.storage.set(this._getPatchKey(i),JSON.stringify(t))}catch(l){this.logger.error(`保存语言包补丁(${i})时出错: ${l.stack}(scope=${this.id})`)}}_getPatchedMessages(t){try{return this.storage&&this.options.cachePatch?this.storage.get(this._getPatchKey(t)):{}}catch(i){return this.logger.error(`读取语言包补丁(${t})时出错:${i.stack}(scope=${this.id})`),{}}}};It(C_,"PatchMessageMixin");var rS=C_,oS=It((e,t,i)=>new Promise((l,c)=>{var h=It(v=>{try{r(i.next(v))}catch(_){c(_)}},"f"),f=It(v=>{try{r(i.throw(v))}catch(_){c(_)}},"d"),r=It(v=>v.done?l(v.value):Promise.resolve(v.value).then(h,f),"u");r((i=i.apply(e,t)).next())}),"j"),Dy,aS=(Dy=class extends Error{},It(Dy,"b"),Dy),sS=0;function R_(e,t={timeout:0}){let i=!1,l=!1,c=!1,h,f,r=0,v,_=++sS,w=It(function(){clearTimeout(r),i=!1,l=!1,c=!1,v=new Promise((E,P)=>{h=E,f=P})},"m");w();function b(){return oS(this,arguments,function*(E=t.timeout,P){if(typeof e=="function"&&e()){i=!0;return}return(i||l)&&w(),E>0&&(r=setTimeout(()=>{i=!0;try{P instanceof Error?f(P):h(P)}catch(I){}},E)),c=!0,v})}return It(b,"c"),b.id=_,b.resolve=E=>{if(clearTimeout(r),!!c&&!(i||l)){if(typeof e=="function"&&e())if(e())h(E);else return;else h(E);i=!0}},b.reject=E=>{clearTimeout(r),c&&(i||l||(f(typeof E=="string"?new Error(E):E instanceof Error?E:new Error),l=!0))},b.destroy=()=>{clearTimeout(r),c&&f(new aS),i=!1,c=!1,l=!1,v=null},b.reset=w,b.isResolved=()=>i,b.isRejected=()=>l,b.isPending=()=>c,b}It(R_,"R");var D_=class extends Error{};It(D_,"VoerkaI18nError");var Eh=D_,lS=class extends Eh{};It(lS,"VoerkaI18nInvalidLanguageError");var cS=class extends Eh{};It(cS,"VoerkaI18nOnlyOneAppScopeError");var uS=class extends Eh{};It(uS,"VoerkaI18nChangeLanguageError");var I_=class extends Eh{};It(I_,"VoerkaI18nLoadLanguageError");var L_=I_,F_=class{constructor(){Li(this,"_refreshSignal")}refresh(t,i){return Pn(this,null,function*(){this._refreshSignal||(this._refreshSignal=R_()),t||(t=this.activeLanguage);let l=t,c,{patch:h,fallback:f}=Object.assign({fallback:!1,patch:!0},i);try{c=yield this._loadLanguageMessages(t),this._activeMessages=c,c&&!c.$remote&&h&&(yield this._patch(t))}catch(r){if(r&&r instanceof Eh){let v=this.getFallbackLanguage(t);v&&v!==t&&(l=yield this.refresh(v,{patch:h,fallback:!0}))}}finally{f||(this._activeLanguage=l,(typeof this.messages[l]=="function"||!(l in this.messages))&&(this.messages[l]=this._activeMessages),this._activeParagraphs=this.paragraphs[l],this._refreshSignal.resolve(),this._refreshSignal=void 0,yield this.emit("scope/change",l,!0))}return this._setLanguageAttr(),l})}_loadLanguageMessages(t){return Pn(this,null,function*(){this.logger.debug(`准备加载语言包:${t}`);let i=this.messages[t],l;if(cl(i))l=i;else if(ia(i))try{l=yield m_.call(this,i)}catch(c){this.logger.error(`加载异步语言包<${t}>失败:${c.message}`),l=void 0}if(!l&&ia(this.loader))try{let c=yield this._loadMessagesFromLoader(t);cl(c)?l=Object.assign({$remote:!0},this.messages[this.defaultLanguage],c):this.logger.error(`错误的语言包<${t}>数据:${c}`)}catch(c){throw new L_(c.message)}if(!cl(l))throw new L_(t);return l})}_loadMessagesFromLoader(t){return Pn(this,null,function*(){if(ia(this.loader))return yield this.loader.call(this,t,this)})}ready(){let t=typeof arguments[0]=="function"?arguments[0]:void 0,i=typeof arguments[0]=="number"?arguments[0]:arguments[1];if(typeof t=="function")this.manager.ready(t,i);else return new Promise(l=>{this.manager.ready(l,i)})}changing(t){return Pn(this,null,function*(){var i,l;!this._refreshSignal&&!this._patching||(yield Promise.all([(i=this._refreshSignal)==null?void 0:i.call(this,t),(l=this._patching)==null?void 0:l.call(this,t)]))})}};It(F_,"ChangeLanguageMixin");var hS=F_,dS={warn:console.warn,error:console.error,info:console.info,debug:console.debug};function k_(e){let t,i=[],l=It((c,...h)=>{let f=h.join(" ");if(t){if(!t.debug)return;t.emit("log",{level:c,message:f})}else if(t=globalThis.VoerkaI18n,t&&t instanceof x_)if(t.debug){i.push([c,f]);let r=It((v,_)=>{e?e(v,_):dS[v](_)},"log");t.on("log",({level:v,message:_})=>r(v,_)),i.forEach(([v,_])=>r(v,_))}else i.splice(0,i.length);else i.push([c,f])},"logOutput");return{warn:It((...c)=>l("warn",...c),"warn"),error:It((...c)=>l("error",...c),"error"),info:It((...c)=>l("info",...c),"info"),debug:It((...c)=>l("debug",...c),"debug")}}It(k_,"createLogger");var pS=class extends Error{constructor(t){super(`Formatters of language<${t}> is not loaded,try to call load()`)}};It(pS,"FormattersNotLoadedError");var B_=class{constructor(t){Li(this,"_formatters",[]),Li(this,"_scope"),this._scope=t,this._formatters=t==null?void 0:t.options.formatters,this._registerFormatters()}get scope(){return this._scope}get formatters(){return this._formatters}_registerFormatters(){this._formatters&&this._formatters.forEach(t=>{Array.isArray(t)?this.register.apply(this,t):this.register.apply(this,[t])})}_addFormatter(t){try{if(this.scope.interpolator.addFilter(t),t){let i=this.scope.manager.scope;i.id!==this.scope.id&&i.interpolator.addFilter(t)}}catch(i){this.scope.logger.error(`fail while register formatter<${t.name}>：${i.stack}`)}}register(t,i,l){let c=this.scope,h=t.next;t.next=function(f,r,v){let _=v.getConfig;return v.getConfig=()=>Object.assign({},l,i==null?void 0:i[c.activeLanguage],_(t.name)),h.call(this,f,r,v)},this._addFormatter(t)}};It(B_,"VoerkaI18nFormatterManager");var fS=B_;function z_(e){return e&&typeof e=="object"&&e.__VoerkaI18nManager__}It(z_,"isI18nManger");var U_=class{getLanguage(t){let i=this.languages.findIndex(l=>l.name==t);if(i!==-1)return this.languages[i]}getFallbackLanguage(t){let i=this.getLanguage(t);return i&&i.fallback||this.options.fallback||this._defaultLanguage}hasLanguage(t){return this.languages.findIndex(i=>i.name==t)!=-1}};It(U_,"LanguageMixin");var mS=U_,N_=class{_getPluraMessage(t,i){try{return Array.isArray(t)?t.length>i?t[i]:t[t.length-1]:t}catch(l){return Array.isArray(t)?t[0]:t}}_getPluraValue(t){let i=null,l=[];if(cl(t)){let c=t;for(let[h,f]of Object.entries(c)){if(ia(f))try{c[h]=f()}catch(v){c[h]=f}let r=typeof c[h]=="number";(i==null&&r||h.startsWith("$")&&r)&&(i=c[h])}l=[c]}else Array.isArray(t)?l=t.map(c=>{try{c=ia(c)?c():c,lf(c)&&!i&&(i=parseInt(c))}catch(h){return String(c)}return c}):t!==void 0&&(i=lf(t)?parseInt(t):0,l=[t]);return[i,l]}_getTranslateComponent(){if(!this._translateComponent){let t=this.options.component||this.appScope.options.component;typeof t=="function"?this._translateComponent=t.call(this,this):(this._translateComponent=()=>{},this.logger.warn("No translate component builder configured"))}return this._translateComponent}_getTranslateTransformer(){if(!this._translateTransformer){let t=this.options.transform||this.appScope.options.transform;typeof t=="function"&&(this._translateTransformer=t.call(this,this))}return this._translateTransformer}_getActiveMessages(t){return typeof this.messages[t]=="function"?(this.logger.warn(`When the t function specifies the language <${t}> , only synchronized language packs can be used`),this.activeMessages):this.messages[t]}translate(t,i,l){if(typeof t!="string")return this.logger.debug(`failed to translate message:${t},it is not a string`),"";let c=(l==null?void 0:l.language)||this.activeLanguage,h=this._getActiveMessages(c);t=t.replace(/\n/g,"\\n");let f=t;if(typeof t!="string")return t;let r=i===void 0?[]:ia(i)?i():i;try{if(cf(t))f=h[t]||t;else{let w=this.idMap[t];f=h[w]||h[t]||t}let[v,_]=this._getPluraValue(r);Array.isArray(f)&&f.length>0&&(v!==null?f=this._getPluraMessage(f,v):f=f[0]),r.length,f=this.interpolator.replace(f,..._),this._translateTransformer&&(l!=null&&l.transform)&&(f=this._translateTransformer(f,_,l))}catch(v){this.logger.error(`翻译失败：${v.stack}`)}return f}};It(N_,"TranslateMixin");var gS=N_,V_=class{_getStorage(){let t=this.storage;return g_(t)?t:void 0}_getStorageKey(){return this.options.storageKey.replace("{scope}",this.id)}restoreLanguage(){let t=this._getStorage();if(t){let i=this._getStorageKey(),l=t.get(i);if(!l||!this.hasLanguage(l))return;this._activeLanguage=l,this.logger.debug(`从存储<${i}>中恢复保存的语言：${l}`)}}saveLanguage(){let t=this._getStorage();if(t){if(!this._activeLanguage)return;let i=this._getStorageKey();t.set(i,this.activeLanguage),this.logger.debug(`当前语言已保存到存储${i}=${this.activeLanguage}`)}}clearLanguage(){let t=this._getStorage();t&&t.remove(this._getStorageKey())}};It(V_,"RestoreMixin");var yS=V_,xS=Object.defineProperty,O_=Object.getOwnPropertySymbols,vS=Object.prototype.hasOwnProperty,_S=Object.prototype.propertyIsEnumerable,G_=It((e,t,i)=>t in e?xS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,"R"),j_=It((e,t)=>{for(var i in t||(t={}))vS.call(t,i)&&G_(e,i,t[i]);if(O_)for(var i of O_(t))_S.call(t,i)&&G_(e,i,t[i]);return e},"b"),xc=(e=>typeof So<"u"?So:typeof Proxy<"u"?new Proxy(e,{get:It((t,i)=>(typeof So<"u"?So:t)[i],"get")}):e)(function(e){if(typeof So<"u")return So.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),ul={Abort:Symbol("Abort"),Throw:Symbol("Throw"),Ignore:Symbol("Ignore")},Iy,vc=(Iy=class extends Error{constructor(e){super(),this.value=e}},It(Iy,"a"),Iy),Ly,hl=(Ly=class extends vc{},It(Ly,"p"),Ly),Fy,hf=(Fy=class extends vc{},It(Fy,"x"),Fy),ky,By=(ky=class extends vc{},It(ky,"g"),ky),bS={name:"error",priority:"before",args:["operate","value"],default:{operate:"ignore"},next(e,t,i){let l=t.operate.toLowerCase(),c=t.value;return i.onError=(h,f,r,v)=>{if(!(h instanceof Error)||h instanceof vc)throw h;if(l=="throw")throw c?new Error(c):h;if(l=="abort")throw new hl(c);if(l=="ignore")throw new hf(c);return f},e}},wS={name:"empty",priority:"before",args:["operate","value"],default:{operate:"abort",value:""},next(e,t,i){let l=t.operate.toLowerCase(),c=t.value;return i.onEmpty=()=>{if(l=="throw")throw new By;if(l=="abort")throw new hl(c);if(l=="ignore")throw new hf;return l},e}};function Ph(e,...t){if(t.length===0)return e;let i=t.map((l,c)=>{let h=Object.entries(l||{});return h.some(([f,r])=>r===void 0)?h.reduce((f,[r,v])=>(v!==void 0&&(f[r]=v),f),{}):l});return Object.assign(e,...i)}It(Ph,"F"),(e=>typeof xc<"u"?xc:typeof Proxy<"u"?new Proxy(e,{get:It((t,i)=>(typeof xc<"u"?xc:t)[i],"get")}):e)(function(e){if(typeof xc<"u")return xc.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});function zy(e){if(typeof e!="object"||e===null)return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var i=t;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return t===i}It(zy,"y");function H_(e){return e&&typeof e=="function"}It(H_,"v");function Uy(e,t,i){if(typeof t=="string"){let l=0,c;for(;(c=e.indexOf(t,l))>-1;){let h=typeof i=="function"?i(t):i,f=e.length;e=e.substring(0,c)+h+e.substring(c+t.length),l=c+h.length+e.length-f}}else{let l;if(!t.global||!t.multiline)throw new Error("The search parameter must be enabled '/gm' option");for(;(l=t.exec(e))!==null;){l.index===t.lastIndex&&t.lastIndex++;let c=e.length,h=l[0].length,f=typeof i=="function"?i(l[0],...l):i;e=e.substring(0,l.index)+f+e.substring(l.index+h),t.lastIndex+=e.length-c}}return e}It(Uy,"w"),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return Uy(this,e,t)});function Ch(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}It(Ch,"m");function W_(e,t=!1){if(typeof e=="number")return!0;if(typeof e!="string"||t)return!1;try{if(e.includes(".")){let i=parseFloat(e);return e.endsWith(".")?!isNaN(i)&&String(i).length===e.length-1:!isNaN(i)&&String(i).length===e.length}else{let i=parseInt(e);return!isNaN(i)&&String(i).length===e.length}}catch(i){return!1}}It(W_,"C");var AS=/\n/gm,MS=/(["'])(.*?)(\1)/gm,SS=/([\s\[\,\{])(\w+)(\s*\:)/gm;function q_(e,t){try{return JSON.parse(e,(l,c)=>t?t(l,c):c)}catch(l){}let i=e.replace(AS,(l,c,h)=>{let f=h.slice(0,c).trim(),r=h.slice(c+1).trim();return!/,$/.test(f)&&!/[\[\{\}]$/.test(f)&&!/^\}/.test(r)?`,
`:`
`});return i=i.replaceAll(MS,(l,c,h)=>`"${encodeURI(h)}"`),i=i.replaceAll(SS,(l,c,h,f)=>`${c}"${h}"${f}`),i=i.replaceAll("，",",").replaceAll("“",'"').replaceAll("”",'"'),JSON.parse(i,(l,c)=>(typeof c=="string"&&(c=decodeURI(c)),c))}It(q_,"V");function Y_(e,t="{",i="}"){let l=0,c=0;for(;l<e.length;){let h=e.slice(l,l+t.length),f=e.slice(l,l+i.length);if(h==t){c++,e=e.substring(0,l+t.length)+`${c}%`+e.substring(l+t.length),l+=t.length+String(c).length+1;continue}if(f==i){c>0&&(e=e.substring(0,l)+`%${c}`+e.substring(l)),l+=i.length+String(c).length+1,c--;continue}l++}return e}It(Y_,"J");function X_(e,...t){return t.length==0&&(t.push(["{","}"]),t.push(["[","]"])),t.forEach(i=>{e.includes(i[0])&&e.includes(i[1])&&(e=Y_(e,...i))}),e}It(X_,"H");function K_(e,t,i){return[[t,new RegExp(Ch(t)+"\\d+%")],[i,new RegExp("%\\d+"+Ch(i))]].forEach(([l,c])=>{let h;for(;(h=c.exec(e))!==null;)h.index===c.lastIndex&&c.lastIndex++,e=e.replace(c,l)}),e}It(K_,"G");function df(e,...t){return t.length==0&&(t.push(["{","}"]),t.push(["[","]"])),t.forEach(([i,l])=>{e.includes(i)&&e.includes(l)&&(e=K_(e,i,l))}),e}It(df,"E");function Z_(e){return e?e.trim().substring(1).trim().split("|").map(t=>t.trim()).map(t=>{if(t=="")return null;let i=t.indexOf("("),l=t.lastIndexOf(")");if(i!==-1&&l!==-1){let c=t.substring(i+1,l).trim(),h=Q_(c);return[t.substring(0,i),h]}else return[t,[]]}).filter(t=>Array.isArray(t)):[]}It(Z_,"M");function J_(...e){e.length==0&&(e.push(["{","}"]),e.push(["[","]"]));let t=e.map(([i,l])=>`(${Ch(i)}1%.*?%1${Ch(l)})`);return TS.replace("__TAG_REGEXP__",t.length>0?t.join("|")+"|":"")}It(J_,"z");var TS=String.raw`((([\'\"])(.*?)\3))|__TAG_REGEXP__([\d]+\.?[\d]?)|((true|false|null)(?=[,\b\s]))|([\w\.]+)|((?<=,)\s*(?=,))(?<=\s*[,\)]?\s*)`;function Q_(e){let t=[],i;e=X_(e);try{let l=new RegExp(J_(),"g");for(;(i=l.exec(e))!==null;){i.index===l.lastIndex&&l.lastIndex++;let c=i[0];if(c.trim()=="")c=void 0;else if(c.startsWith("'")&&c.endsWith("'")||c.startsWith('"')&&c.endsWith('"'))c=c.substring(1,c.length-1),c=df(c);else if(c.startsWith("{")&&c.endsWith("}")||c.startsWith("[")&&c.endsWith("]"))try{c=df(c),c=q_(c)}catch(h){}else["true","false","null"].includes(c)?c=JSON.parse(c):W_(c)?c=parseFloat(c):c=df(String(c));t.push(c)}}catch(l){}return t}It(Q_,"U");var ES=new RegExp("(?<!\\\\)\\{([\\S]+\\s)?\\s*(\\w+)?((\\s*\\|\\s*\\w*(\\(.*?\\)){0,1}\\s*)*)\\s*(\\s[\\S]+)?\\}","gm");function Ny(e,t,i={}){let l=e,c,h=Object.assign({replaceAll:!0},i),f=ES;for(f.lastIndex=0;(c=f.exec(l))!==null;){c.index===f.lastIndex&&f.lastIndex++;let r=c[2]||"",v=(c[1]||"").trim(),_=(c[6]||"").trim(),w=l.length,b=Z_(c[3]||"");if(H_(t)){let E=t(r,v,_,b,c[0]);h.replaceAll?l=Uy(l,c[0],E):l=l.replace(c[0],E),f.lastIndex+=l.length-w}}return l}It(Ny,"O");function Vy(e,t){let i=t.value;if(e.length>0){let l=i1.call(this,e,t);for(let c of l)try{i=c.call(this,i)}catch(h){if(h instanceof By)throw h;if(h instanceof vc){if(h.value!=null&&(i=h.value),h instanceof hl)break}else throw h}}return this.options.isEmpty(i)||(i=`${t.prefix}${i}${t.suffix}`),i}It(Vy,"I");function $_(e,t,i,l){if(!this.options.isEmpty(e))return e;let c=l.onEmpty||i.onEmpty||this.options.onEmpty;if(typeof c!="function")return e;let h=c.call(this,e,t,l);throw h instanceof Error?h:h==ul.Abort?new hl:h==ul.Ignore?new hf:h==ul.Throw?new By:new hl(h)}It($_,"K");function e1(e,t,i,l,c){let h=c.onError||l.onError||this.options.onError;if(typeof h!="function")return t;let f=h.call(this,e,t,i,c);throw f instanceof Error?f:f==ul.Abort?new hl:f==ul.Ignore?new hf:f==ul.Throw?e:new hl(f)}It(e1,"Q");function t1(e,t,i){var l;let c=Object.assign({},typeof e.default=="function"?e.default():e.default);return t.length==1&&zy(t[0])?Ph(c,t[0]):e.args&&((l=e.args)==null?void 0:l.length)>0&&e.args.forEach((h,f)=>{t[f]!==void 0&&(c[h]=t[f])}),h=>{let f;try{i.args=t,f=e.next.call(this,h,c,i),f=$_.call(this,f,c,e,i)}catch(r){if(r.filter=e.name,r instanceof vc)throw r;return this.log(`当执行过滤器器<${i.match}:${e.name}>时出错:${r.stack}`),e1.call(this,r,h,c,e,i)}return String(f)}}It(t1,"Y");function n1(e){let t=[],i=e.map(([l,c])=>[this.getFilter.call(this,l),c]).filter(([l])=>l!=null);return i=i.reduce((l,[c,h])=>(c&&(c.priority=="before"?l.unshift([c,h]):c.priority=="after"?t.push([c,h]):l.push([c,h])),l),[]),i.concat(t)}It(n1,"Z");function i1(e,t){let i=n1.call(this,e),l=[];for(let[c,h]of i)l.push(t1.call(this,c,h,t));return l}It(i1,"ee");var Oy,PS=(Oy=class{constructor(e){this.options=Ph({log:console.log,filters:{},missing:"default",filterContext:{}},e),this.addDefaultHandlers(),this.addBuildinFilters(),this.normalizeFilters()}get filters(){return this.options.filters}addDefaultHandlers(){this.options.onError=()=>ul.Ignore,this.options.onEmpty=()=>"",this.options.isEmpty=e=>e===null||e===""}addFilter(e){if(!e.name)throw new Error("Filter name cannot be empty");if(typeof e.next!="function")throw new Error("The filter must provide a next function");return e=Ph({priority:"normal"},e),this.filters[e.name]=e}removeFilter(e){delete this.filters[e]}getFilter(e){var t;if(e in this.options.filters)return this.options.filters[e];{let i=(t=this.options.getFilter)==null?void 0:t.call(this,e);return typeof i=="function"?{name:e,next:i}:e in String.prototype?{name:e,next:It((l,c,h)=>l[e](...h.args),"next")}:i}}addBuildinFilters(){this.addFilter(bS),this.addFilter(wS)}normalizeFilters(){Object.entries(this.options.filters).forEach(([e,t])=>{let i=Ph({name:e,priority:"normal",args:null,next:It(l=>l,"next")},typeof t=="function"?{filter:t}:t);this.options.filters[e]=i})}getMissingValue(e,t){let i=this.options.missing;if(i=="default")return"";if(i=="ignore")return t;if(typeof i=="function")return i.call(this,e)}replace(e,...t){if(t.length===0)return e;if(t.length===1&&typeof t[0]=="function"&&(t[0]=t[0].call(this)),t.length===1&&zy(t[0])){let i=t[0];return Ny.call(this,e,(l,c,h,f,r)=>{let v=l in i?i[l]:this.getMissingValue(l,r);return typeof v=="function"&&(v=v.call(this)),Vy.call(this,f,j_({name:l,value:v,prefix:c,suffix:h,template:e,match:r,args:[]},this.options.filterContext))})}else{let i=t.length===1&&Array.isArray(t[0])?[...t[0]]:t,l=0;return Ny.call(this,e,(c,h,f,r,v)=>{let _=i.length>l?i[l++]:this.getMissingValue(l,v);return typeof _=="function"&&(_=_.call(this)),Vy.call(this,r,j_({name:c,value:_,prefix:h,suffix:f,template:e,match:v,args:[]},this.options.filterContext))},{replaceAll:!1})}}log(e,...t){this.options.debug&&this.options.log(e,...t)}},It(Oy,"$"),Oy);function r1(e,t,i){let{defaultValue:l,delimiter:c,matched:h}=Object.assign({delimiter:"."},i);if(!e||typeof t!="string")return l;if(!t)return e;let f=t.split(c),r=e,v,_;try{for(let w of f)if(r instanceof Map||r instanceof WeakMap){if(!r.has(w))return l;v=r,_=w,r=r.get(w)}else if(r instanceof Set){let b=parseInt(w,10);if(b>=r.size)return l;v=r,_=b,r=[...r][b]}else if(r&&typeof r=="object"&&w in r)v=r,_=Array.isArray(r)?parseInt(w):w,r=r[w];else return l}catch(w){return l}return typeof h=="function"&&h({value:r,parent:v,indexOrKey:_}),r}It(r1,"u");var o1=class{constructor(){Li(this,"_flexVars")}_initInterpolators(){this._flexVars=new PS({filterContext:{getConfig:It(t=>{let i=this.activeMessages.$config||{};return t?r1(i,t):i},"getConfig"),scope:this}})}};It(o1,"InterpolatorMixin");var CS=o1;function a1(e,...t){if(t.length===0)return e;let i=t.map((l,c)=>{let h=Object.entries(l||{});return h.some(([f,r])=>r===void 0)?h.reduce((f,[r,v])=>(v!==void 0&&(f[r]=v),f),{}):l});return Object.assign(e,...i)}It(a1,"u");var Gy=class s2 extends S_(tS,rS,hS,mS,gS,CS,yS){constructor(t){super(),Li(this,"__VoerkaI18nScope__",!0),Li(this,"_options"),Li(this,"_manager"),Li(this,"_formatterManager",null),Li(this,"_logger"),Li(this,"_defaultLanguage","zh-CN"),Li(this,"_activeLanguage","zh-CN"),Li(this,"_activeMessages",{}),Li(this,"_patchedMessages",{}),Li(this,"_translateComponent"),Li(this,"_translateTransformer"),Li(this,"_activeParagraphs",{}),Li(this,"$id",++s2.idSeq),this._options=a1({id:p_(),library:!1,debug:!1,injectLangAttr:!0,languages:[],messages:{},paragraphs:{},idMap:{},formatters:[],attached:!0,storageKey:"language",cachePatch:!0},t),this._init()}get id(){return this._options.id}get options(){return this._options}get attached(){return this._options.attached}get debug(){return this._options.debug}get library(){return this._options.library}get formatters(){return this._formatterManager}get defaultLanguage(){return this._defaultLanguage}get defaultMessages(){return this.messages[this.defaultLanguage]}get messages(){return this._options.messages}get paragraphs(){return this._options.paragraphs}get idMap(){return this._options.idMap}get languages(){return this._options.languages}get manager(){return this._manager}get appScope(){return this._manager.scope}get interpolator(){return this._flexVars}get logger(){return this._logger}get t(){return this.translate.bind(this)}get Translate(){return this._getTranslateComponent()}get activeMessages(){return this._activeMessages}get activeParagraphs(){return this._activeParagraphs}get activeLanguage(){return this._activeLanguage}get storage(){return this.getScopeOption("storage")}get loader(){return this.getScopeOption("loader")}get $t(){return(t,i,l)=>(this._getTranslateTransformer(),l||(l={}),l.transform=!0,this.translate(t,i,l))}getScopeOption(t){let i=this._options;return this.attached?i[t]||(this.library?this._manager[t]:void 0):i[t]}_initOptions(){if(!Array.isArray(this.languages))this.logger.warn("[VoerkaI18n] invalid language settings, will use default language settings."),this._options.languages=Object.assign([],Y2);else if(this.languages.length==0)throw new Error("[VoerkaI18n] must provide valid language settings.");let t,i;this.languages.forEach(c=>{c.default&&(i=c.name),c.active&&(t=c.name)});let l=this._options.messages;if(i in l||(i=Object.keys(l)[0]),t in l||(t=i),!(i in l))throw new Error("[VoerkaI18n] invalid language configuration, must provide valid default and active languages.");if(this._activeLanguage=t,this._defaultLanguage=i,!this._options.library&&!this._options.storage&&(this._options.storage=q2),ia(this.messages[this._defaultLanguage]))throw new Error("[VoerkaI18n] default language pack must be static content, can't use async load way.");this._activeMessages=this.messages[this._activeLanguage],this._activeParagraphs=this.paragraphs[this._activeLanguage]}_init(){this._logger=k_(this._options.log),this._initOptions(),this.library||this.restoreLanguage(),this._initInterpolators(),this.registerToManager(),this._formatterManager=new fS(this)}bind(t){this._manager=t,this._manager.once("init",this._initRefresh.bind(this))}_initRefresh(t){if(this.library)this.refresh(t&&t());else{let i=[];(this._defaultLanguage!==this._activeLanguage||ia(this.activeMessages))&&i.push(this.refresh(void 0,{patch:!1})),i.push(this._patch()),Promise.all(i).then(()=>{this.emit("ready",this.activeLanguage,!0),this._setLanguageAttr()})}}registerToManager(){if(!this.attached)return;let t=!this.options.library;t&&(globalThis.VoerkaI18n&&globalThis.VoerkaI18n.scope&&Ty()&&console.warn("Only can have one i18nScope with library=false"),this._manager=new x_(this));let i=globalThis.VoerkaI18n;i&&z_(i)?t?this._initRefresh():i.register(this):(globalThis.__VoerkaI18nScopes__||(globalThis.__VoerkaI18nScopes__=[]),globalThis.__VoerkaI18nScopes__.push(this))}change(t){return Pn(this,null,function*(){let i=this.activeLanguage;return this.attached?i=yield this._manager.change(t):i=yield this.refresh(t),i})}_setLanguageAttr(){if(!(this.library||!Ty()))try{let t=this._options.injectLangAttr;if(!t)return;let i=t===!0?document.body:document.body.querySelector(t);i&&i.setAttribute("lang",this.activeLanguage)}catch(t){}}getRawMessage(t){if(cf(t)){if(t in this.defaultMessages)return this.defaultMessages[t]}else return t}getMessageId(t){if(cf(t))return t;if(t in this.idMap)return this.idMap[t]}};It(Gy,"VoerkaI18nScope"),Li(Gy,"idSeq",0);var RS=Gy;function DS(e,t,i){return l=>{let c=e.next;return e.next=function(h,f,r){let v=r.getConfig;return r.getConfig=()=>Object.assign({},i,t==null?void 0:t[l.activeLanguage],v(e.name)),c.call(this,h,f,r)},e}}It(DS,"createFormatter");function IS(e){let t=globalThis.VoerkaI18n;t?t.registerPlugin(e):(globalThis.__VoerkaI18nPlugins__||(globalThis.__VoerkaI18nPlugins__=[]),globalThis.__VoerkaI18nPlugins__.push(e))}It(IS,"definePlugin");const LS={get(e){if(globalThis.localStorage)return globalThis.localStorage.getItem(e)},set(e,t){globalThis.localStorage&&globalThis.localStorage.setItem(e,t)},remove(e){globalThis.localStorage&&globalThis.localStorage.removeItem(e)}};var FS=Object.defineProperty,fr=(e,t)=>FS(e,"name",{value:t,configurable:!0}),_c=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,i)=>(typeof require!="undefined"?require:t)[i]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});function s1(e,t=!1){if(typeof e=="number")return!0;if(typeof e!="string"||t)return!1;try{if(e.includes(".")){let i=parseFloat(e);return e.endsWith(".")?!isNaN(i)&&String(i).length===e.length-1:!isNaN(i)&&String(i).length===e.length}else{let i=parseInt(e);return!isNaN(i)&&String(i).length===e.length}}catch(i){return!1}}fr(s1,"r"),(e=>typeof _c<"u"?_c:typeof Proxy<"u"?new Proxy(e,{get:fr((t,i)=>(typeof _c<"u"?_c:t)[i],"get")}):e)(function(e){if(typeof _c<"u")return _c.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});function l1(e,t=3){let i=new RegExp(String.raw`(?!^)(?=(\d{${t}})+$)`,"g"),l=e.replace(i,",");return l.startsWith(",")&&(l=l.substring(1)),l.endsWith(",")&&(l=l.substring(0,l.length-2)),l}fr(l1,"addSplitChars");function jy(e,t){let{symbol:i="",division:l=3,prefix:c="",precision:h=-1,suffix:f="",unit:r=0,radix:v=3,units:_=[],format:w="{symbol}{value}{unit}"}=t,[b,E]=String(e).split(".");r>0&&v>0&&(b.length<v*r&&(b=Array.from({length:v*r-b.length+1}).fill(0).join("")+b),E=b.substring(Number(b),b.length-v*r)+E,b=b.substring(0,b.length-v*r),b==""&&(b="0"));let P=[];P.push(l1(b,l)),E&&s1(h)&&h!=0&&(h==0||(h==-1?P.push(`.${E}`):h>0&&(h<0?E=String(parseFloat(`0.${E}`)):E=String(parseFloat(`0.${E}`).toFixed(h)).split(".")[1],P.push(`.${E}`))));const I=_[r]||"";return w.replace("{value}",P.join("")).replace("{symbol}",i).replace("{prefix}",c).replace("{suffix}",f).replace("{unit}",I)}fr(jy,"toCurrency");var kS=[{name:"currency",args:["format","unit","precision","prefix","suffix","division","symbol","radix"],next(e,t,i){const l=i.getConfig(),c=Object.assign({},l,t);return c.format in c&&(c.format=c[c.format]),c.unit=parseInt(String(c.unit))||0,c.unit>c.units.length-1&&(c.unit=c.units.length-1),c.unit<0&&(c.unit=0),c.unit>0&&c.precision==2&&(c.precision=-1),jy(e,c)}},{"en-US":{units:[""," thousands"," millions"," billions"," trillions"],radix:3,symbol:"$",prefix:"USD",suffix:"",division:3,precision:2},"zh-CN":{units:["","万","亿","万亿","万万亿"],radix:4,symbol:"￥",prefix:"RMB",suffix:"元",division:4,precision:2}},{default:"{symbol}{value}{unit}",long:"{prefix} {symbol}{value}{unit}{suffix}",short:"{symbol}{value}{unit}",custom:"{prefix} {symbol}{value}{unit}{suffix}",format:"default"}],BS=[{name:"number",args:["precision","division"],next(e,t,i){const l=i.getConfig();return jy(e,Object.assign({},l,t))}},{"en-US":{division:3},"zh-CN":{division:4}}];function ps(e){return e instanceof Date?e:new Date(e)}fr(ps,"toDate");var zS=[{name:"timeSlots",args:["upper"],default:{upper:!0},next(e,t,i){const l=i.getConfig(),c=ps(e).getHours(),h=!!t.upper;let f=l.slots.findIndex(r=>c<r);return f===-1&&(f=l.upperCases.length-1),h?l.upperCases[f]:l.lowerCases[f]}},{"en-US":{slots:[12],lowerCases:["am","pm"],upperCases:["AM","PM"]},"zh-CN":{slots:[5,8,11,13,18],lowerCases:["凌晨","早上","上午","中午","下午","晚上"],upperCases:["凌晨","早上","上午","中午","下午","晚上"]}}];function Hy(e,...t){if(t.length===0)return e;let i=t.map((l,c)=>{let h=Object.entries(l||{});return h.some(([f,r])=>r===void 0)?h.reduce((f,[r,v])=>(v!==void 0&&(f[r]=v),f),{}):l});return Object.assign(e,...i)}fr(Hy,"u");var pf={en:{month:{long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]},weekday:{long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"]}},cn:{month:{long:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],short:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},weekday:{long:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],short:["周日","周一","周二","周三","周四","周五","周六"]}}},c1={en:{slots:[12],names:["AM","PM"]},cn:{slots:[6,9,11,13,18],names:["凌晨","早上","上午","中午","下午","晚上"]}},US="YYYY-MM-DD HH:mm:ss";function Wy(e){e<0&&e>23&&(e=0);let t=[0,...c1[this.language].slots,24].findIndex(i=>i>e)-1;return c1[this.language].names[t]}fr(Wy,"h");function qy(e,t,i){let l=Hy({language:"cn"},i),c=e instanceof Date?e:new Date(e||Date.now()),h=c.getHours(),f=String(h).padStart(2,"0"),r=h>12?h-12:h,v=String(r).padStart(2,"0"),_=String(c.getMinutes()),w=String(c.getSeconds()),b=String(c.getMilliseconds()),E=String(c.getFullYear()),P=c.getMonth(),I=c.getDay(),F=String(c.getDate()),B=[["HH",f],["H",h],["hh",v],["h",r],["mm",_.padStart(2,"0")],["m",_],["ss",w.padStart(2,"0")],["s",w],["SSS",b.padStart(3,"0")],["A",h>12?"PM":"AM"],["a",h>12?"pm":"am"],["t",Wy.call(l,h)],["T",Wy.call(l,h)],["YYYY",E],["yyyy",E],["YY",E.substring(2)],["MMM",pf[l.language].month.short[P]],["MM",String(P+1).padStart(2,"0")],["M",P+1],["DD",F.padStart(2,"0")],["D",F],["d",I],["dd",pf[l.language].weekday.short[I]],["ddd",pf[l.language].weekday.short[I]],["dddd",pf[l.language].weekday.long[I]]],O=t||US;return B.forEach(([W,Z])=>O=O.replaceAll(W,Z)),O}fr(qy,"H");function u1(e,t,i){if(typeof t=="string"){let l=0,c;for(;(c=e.indexOf(t,l))>-1;){let h=typeof i=="function"?i(t):i,f=e.length;e=e.substring(0,c)+h+e.substring(c+t.length),l=c+h.length+e.length-f}}else{let l;if(!t.global||!t.multiline)throw new Error("The search parameter must be enabled '/gm' option");for(;(l=t.exec(e))!==null;){l.index===t.lastIndex&&t.lastIndex++;let c=e.length,h=l[0].length,f=typeof i=="function"?i(l[0],...l):i;e=e.substring(0,l.index)+f+e.substring(l.index+h),t.lastIndex+=e.length-c}}return e}fr(u1,"s"),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return u1(this,e,t)});var h1={local:fr(e=>e.toLocaleString(),"local"),iso:fr(e=>e.toISOString(),"iso"),utc:fr(e=>e.toUTCString(),"utc"),gmt:fr(e=>e.toGMTString(),"gmt")},NS=[{global:!0,name:"date",args:["format"],next(e,t,i){const l=i.getConfig(),c=ps(e);let h=t.format||l.format;if(h in h1)return h1[h](c);if(h in l&&(h=l[h],typeof h=="function"))return h(c);if(typeof h=="string")return qy(c,h)}},{"en-US":{long:"YYYY/MM/DD HH:mm:ss",short:"YYYY/MM/DD"},"zh-CN":{long:"YYYY年M月D日 HH点mm分ss秒",short:"YYYY年M月D日"}},{format:"local"}],d1={local:fr(e=>e.toLocaleTimeString(),"local"),timestamp:fr(e=>e.getTime(),"timestamp")},VS=[{name:"time",args:["format"],next(e,t,i){const l=i.getConfig(),c=ps(e);let h=t.format||l.format;if(h in d1)return d1[h](c);if(h in l&&(h=l[h],typeof h=="function"))return h(c);if(typeof h=="string")return qy(c,h)}},{"en-US":{long:"HH:mm:ss"},"zh-CN":{long:"HH点mm分ss秒"}},{format:"local",short:"HH:mm:ss"}],OS=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],GS=["周日","周一","周二","周三","周四","周五","周六"],jS=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],HS=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],WS=[{name:"weekday",args:["format"],next(e,t,i){const l=i.getConfig(),c=ps(e).getDay(),h=t.format||"long";if(typeof h=="string"&&h in l){const f=l[h];return typeof f=="function"?f(c):f[c]}return c}},{"en-US":{long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tues","Wed","Thur","Fri","Sat"]},"zh-CN":{long:OS,short:GS}},{format:"long"}],qS=[{name:"month",args:["format"],next(e,t,i){const l=i.getConfig(),c=ps(e).getMonth()+1,h=t.format||l.format;if(typeof h=="string"&&h in l){const f=l[h];return typeof f=="function"?f(c):f[c-1]}return c}},{"en-US":{long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"]},"zh-CN":{long:jS,short:HS}},{format:"long"}],YS=[{name:"quarter",args:["format"],next(e,t,i){const l=i.getConfig(),c=ps(e).getMonth()+1,h=Math.floor(c%3==0?c/3:c/3+1)-1,f=t.format||l.format;if(typeof f=="string"&&f in l){const r=l[f];return typeof r=="function"?r(h):r[h]}return h}},{"en-US":{long:["First Quarter","Second Quarter","Third Quarter","Fourth Quarter"]},"zh-CN":{long:["一季度","二季度","三季度","四季度"]}},{format:"short",short:["Q1","Q2","Q3","Q4"]}],Rh=[1e3,6e4,36e5,864e5,6048e5,2592e6,31536e6,Number.MAX_SAFE_INTEGER];function p1(e,t,i){let{units:l,now:c,before:h,after:f}=Hy({units:["秒","分钟","小时","天","周","个月","年"],now:"刚刚",before:"{value}{unit}前",after:"{value}{unit}后"},i),r=typeof e=="number"?new Date(e).getTime():e.getTime(),v=(t instanceof Date?t:typeof t=="number"?new Date(t):new Date).getTime(),_=r-v,w=Rh.findIndex(b=>Math.abs(_)<b)-1;if(w<0&&(w=0),w>Rh.length-1&&(w=Rh.length-1),_<1e3&&_>-1e3)return c;if(_<=-1e3){let b=parseInt(String(Math.abs(_)/Rh[w]));return h.replace("{value}",b).replace("{unit}",l[w])}else{let b=parseInt(String(Math.abs(_)/Rh[w]));return f.replace("{value}",b).replace("{unit}",l[w])}}fr(p1,"b");var XS=[{name:"relativeTime",args:["base"],default:fr(()=>({base:new Date}),"default"),next(e,t,i){const l=i.getConfig(),c=t.base||new Date;return p1(ps(e),c,l)}},{"en-US":{units:["seconds","minutes","hours","days","weeks","months","years"],now:"Just now",before:"{value} {unit} ago",after:"after {value} {unit}"},"zh-CN":{units:["秒","分钟","小时","天","周","个月","年"],now:"刚刚",before:"{value}{unit}前",after:"{value}{unit}后"}}],KS=[kS,BS,zS,NS,VS,WS,qS,YS,XS];const ZS=(e,t)=>Pn(this,null,function*(){return yield(yield fetch(MxPluginContext.getLoaderLanguageUrl(e,t))).json()}),JS={"zh-CN":{},"en-US":{},"ko-KR":{}},QS={" 指定输出范围第一点:":718," 指定输出范围第二点:":719," 指定第一点:":720," 指定第二点:":721," 云线框起始点:":722," 云线框结束点:":723," 审图标注点:":724," 点击开启绘制云线:":725," 再次点击结束绘制云线:":726,"指定一点:":727,"指定二点:":728,选择对象:729," 指定下一个点:":730,"\\指定插入基点":731," 指定表格插入点:":732,"指定插入点:":733,指定插入基点:734,选择标注对象:735,请选择目标文字:736," 指定填充区域内部一点:":737,"没有找到闭合区域 ":738,表面粗糙度:739,焊接符号:740,形位公差:741,选择要需要开启自定义属性的对象:742,选择要隐藏的对象:743," 指定插入点:":744," 指定一点:":745,指定夹角:746," 指定二点:":747,选择图案填充对象:748,"指定第一点:":749,"指定第二点:":750,"指定第二个角度点:":751,"指定最后一个点:":752,"指定坐标点:":753,"指定标注点:":754,请输入审批意见:755,指定云线框起始点:756,指定云线框终止点:757,指定审图标注点:758,"指定第一个角点:":759,"指定第二个角点:":760,"指定序号位置:":761,旋转符号:762,标记类型:763,"请选择需要标记的圆:":764,请设置定位点或直线或圆弧或圆:765,拖动确定标注位置:766,请指定或输入角度:767,焊缝符号:768,"请拾取定位点、直线或圆弧":769,请指定第二点:770,请设置定位点:771,请设置角度:772,请设置定位点或直线或圆弧:773,请设置引线转折点:774,拖动确定定位点:775,"请指定第一点:":776,"请指定第二点:":777,请选择目标块对象:778,请输入新块名:779,选择需要修改基点的块:780,设置基点:781,选择需要修改颜色的块:782,"输入颜色索引(0~256)":783,请选择源块:784,"选择要刷的目标块:":785,选择连接方式:786,手动逐个连线:787,自动批量连线:788,请选择连线的块:789,设置中心线长度:790,"选择要旋转的目标块:":791,设置旋转角度:792,请设置缩放比例:793,"请设置选择范围:":794,请选择目标块:795,请设置统计范围:796,"指定表格插入点:":797,选择目标曲线:798,指定长度标注点:799,选择目标对象:800,请选择目标斜率对象:801,请设置标注文字高度:802,指定斜率标注点:803,请选择目标坐标点:804,请指定标注位置:805,指定起点:806,指定终点:807,指定标注方向:808,请设置文字内容:809,请选择面积的第一个点:810,请选择下一个点:811,请选择面积标注的位置:812,请选择矩形的角点1:813,请选择矩形的角点2:814,请设置面积标注的位置:815,请选择一个测量点:816,请选择一条直线:817,请设置尺寸线的位置:818,请选择一条弧线:819,请指定尺寸线位置:820,请选择一个圆对象:821,请指定文字位置:822,请选择直线的端点或弧线:823,请指定文字的位置:824,请选择一个连续测量的标注:825,请选择第二条直线:826,请设置角度标注的位置:827," 请输入星形顶点数：":828," 指定星形中心点:":829,"请设置星形的内半径:":830," 指定星形的外半径:":831," 请输入凹凸线宽度<5>":832," 请输入凹凸线高度<10>":833,请点击确定起始点:834,请点击确定终点:835," 请输入锯齿线宽度<5>":836," 请输入锯齿线高度<10>":837," 请输入矩形宽度<5>":838," 请输入矩形高度<10>":839,请点击确定矩形中心:840," 请输入管径<10>":841," 请输入长出管口长度<5>":842,请点击确定起点:843,指定剖管线起点:844,指定剖管线终点:845,选择剖管线圆弧方向:846,左边:847,右边:848,选择模式:849,直线焊缝:850,弧线焊缝:851," 请输入焊缝半径<5>":852,指定圆弧的第二个点:853,指定圆弧的端点:854,"请输入宽度<25>":855,"请输入高度<15>":856,"请输入楼梯级数<10>":857,"请确定圆心位置 ":858,请输入圆半径:859," 请输入保温棉宽度<5>":860," 请输入保温棉高度<10>":861,请点击下一个点:862,请选择第一条线:863,请选择第二条线:864,请选择终点:865,请选择目标矩形:866,设置指北针中心点:867,设置指北针半径:868,选择提示框指向:869," 指定消息框第一点:":870," 指定消息框第二点:":871," 设置消息框指向:":872,请设置基准符文字:873,请设置文字高度:874,请设置基准符位置:875,请设置定位点或圆弧或直线:876,请设置符号位置:877,请设置圆心:878,请设置齿轮圆心:879,请设置齿轮半径:880," 请设置中心线长度10>":881,请选择第一个圆:882,请选择第二个圆:883,请设置矩形左上角点:884,请设置矩形右下角点:885,请设置圆角半径:886,请选择多边形起点:887,请选择多边形顶点:888,请输入表格提取精度:1996,选择提取范围第一个角点:1997,选择提取范围第二个角点:1998,"未识别到有效表格!":1999,"请在本地环境测试！":2e3,"选择对象:":889,指定基点:890,"指定第二个点 ":891,阵列:892,退出:893,放弃:894,"输入要进行阵列的项目数 ":895,选择圆弧对象:896,"选择复制旋转对象:":897,"请指定目标点 ":898,请指定旋转角度:899,选择要转成多边形的对象:900,设置多边形边数:901," 输入选项":902,内接于圆:903,外切于圆:904,选择要修改颜色的对象:905,输入颜色索引:906,隐藏:907,隐藏未选:908,全部显示:909,选择目标的对象:910," 指定删除方框第一点:":911," 指定删除方框第二点:":912," 选择需要精确删除的实体":913," 请选择角度复制对象":914," 请输入角度复制数量":915," 请输入角度复制的基点":916," 请输入复制角度":917,请选择顶点对象:918,请选择复制对象:919,请确定复制基点:920,请选择参考曲线:921,选择打断对象:922,指定偏移对象:923,请输入偏移距离:924,"指定伸缩对象(选择直线、多段线、圆弧)":925,伸缩至:926,选择要修改线型比例的对象:927,请输入线型比例:928,请输入阵列间距:929,请选择圆弧:930,选择排列对象:931,指定排列基点:932,"选择目标多段线:":933,"请输入圆角半径<5>":934,选择填充对象:935,请输入填充比例:936,请选择原填充图形:937,请点击填充图形内部任意一点:938,请选择线对象:939,选择等分模式:940,定距等分:941,定数等分:942,偏移等分:943,复制等分:944,请选择偏移等分对象:945,请选择复制等分对象:946,请选择需要等分的线段:947,请设置等分距离:948,请设置等分的数量:949,请设置偏移距离:950,请指定偏移点:951,请指定复制基点:952,请指定复制等分数量:953,请指定复制等分端点:954,"请选择需要矩形缩放的实体:":955,请指定矩形的角点1:956,请指定矩形角点2:957,请选择放大中心点:958,请选择放大范围:959,请设置放大倍数:960,请选择放大插入点:961,请选择一条需要打断的曲线:962,请在曲线上选取打断点:963,请输入阵列数量:964,是否开启旋转:965,是:966,否:967,"请选择需要阵列的图形:":968,请选择阵列中心点:969,"请选择闭合多边形！":970,请选择第一个点:971,请选择第二个点:972,请选择第一个闭合多边形:973,请选择第二个闭合多边形:974,请选择两个闭合多边形:975,"两个多边形没有重合边！":976,请选择目标多边形:977,请选择多边形需要添加顶点的边:978,请设置添加的顶点位置:979,请选择多边形需要删除的顶点:980,请选择多边形需要拉伸的边:981,请指定拉伸位置:982,"请设置图框方向<N>":983,横向:984,纵向:985,"请设置图框尺寸<4>":986,请设置图框位置:987,指定裁剪角点1:988,指定裁剪角点2:989,请设置道路起点:990,请设置下一点:991,"请选择目标对齐线对象(选择直线)":992,请选择目标文字对象:993,选择文字对象:994,请设置字高:995,请设置字宽:996,请选择源文字:997,请选择第一个文字:998,请选择第二个文字:999,请选择需要对齐的文字:1e3,请选择对齐方式:1001,左:1002,中:1003,右:1004,请选择对齐基点:1005,请选择需要反转的文字:1006,请选择需要去空格的文字:1007,请选择文字对象:1008,"请输入下划线宽度 ":1009,"请设置下划线距离 ":1010,"请设置下划线延长距离 ":1011,"请选择操作选项 ":1012,大写:1013,小写:1014,句首大写:1015,请选择数字对象:1016,"请选择文字插入点 ":1017,"选择要查找的范围:":1018,"请选择查找模式 ":1019,等于:1020,包含:1021,前缀为:1022,后缀为:1023,"请输入关键字 ":1024,"选择要操作的范围:":1025,选择操作方式:1026,添加:1027,删除:1028,选择操作位置:1029,前缀:1030,后缀:1031,请输入内容:1032,"请选择文本 ":1033,"请选择圆弧 ":1034,请选择文字样式:1035,请设置文字提取范围:1036,输入编号文字:2019,请选择一个单行文本:2020,请选择一个多行文本:2021,请设置文字插入点:2022,请选择单行文本:2023,下载开Demo代码:1037,下载开发包:1038,调用画圆线命令:1039,交互画直线:1040,添加图层:1041,得到所有图层:1042,得到所有文字样式:1043,得到所有图块:1044,得到所有线型:1045,写扩展数据:1046,读扩展数据:1047,测试插入一个图块:1048,绘直线:1049,绘圆弧:1050,绘圆:1051,绘PL线:1052,绘填充:1053,绘文字:1054,绘椭圆:1055,绘椭圆弧:1056,绘制多行文字:1057,绘制表格:1058,绘制二维码:1059,插入图章:1060,得到所有对象:1061,交互选择对象:1062,保存mxweb到服务器:1063,得到系统变量:1064,新建图纸:1065,白色背景色:1066,文字查找定位:1067,选择实体做块:1068,绘制单行文字:1069,选点填充:1070,设置扩展属性:1071,绘制对齐标注:1072,绘性线标注:1073,角度标注:1074,修改对象线型:1075,选择隐藏对象层:1076,添加到当前选择:1077,视区旋转:1078,写扩展记录:1079,得到命名字典:1080,添加文字样式:1081,绘自定义实体:1082,修改对象颜色:1083,修改对象不可见:1084,修改对象层:1085,修改对象显示顺序:1086,指定范围输出pdf:1087,绘制image:1088,读取对象扩展字典:1089,绘制3DPolyline:1090,绘线文本自定义实体:1091,计算交点:1092,修改文字样式:1093,偏移输入画线:1094,创建组:1095,屏幕截图jpg:1096,获取图纸相同文字:1097,指定范围输出dwg:1098,测试绘制标记圆:1099,测试Wipeout:1100,创建剪切块:1101,公差标注:1102,改所有对象颜色:1103,切剪mxweb:1104,设置当前颜色线重:1105,查找多边形区域内对象:1106,打碎对象:1107,绘半透明线:1108,添加线型:1109,修改图案比例:1110,测试文字编辑:1111,绘制条形码:1112,屏幕截图bmp:1113,修改工具:1114,文字工具:1115,绘图工具:1116,块工具:1117,测量工具:1118,标注工具:1119,其他工具:1120,多重复制:1121,弧转圆:1122,复制旋转:1123,圆转多边:1124,修改颜色:1125,圆弧切角:1126,临时隐藏:1127,方框删除:1128,角度复制:1129,顶点复制:1130,交点打断:1131,双向偏移:1132,改圆大小:1133,线型比例:1134,伸缩:1135,按弧阵列:1136,pl圆角:1137,pl线反向:1138,得到所有直线对象:1139,等分:1140,矩形缩放:1141,打断:1142,切割多边形:1143,合并多边形:1144,添加多边形顶点:1145,删除多边形顶点:1146,多边形单边拉伸:1147,星形:1148,凹凸线:1149,锯齿线:1150,中心矩形:1151,圆角矩形:1152,圆中心线:1153,管道:1154,剖管符:1155,中垂线:1156,楼梯:1157,实心圆:1158,保温棉:1159,中心线:1160,开洞:1161,消息框:1162,"基准符（1）":1163,焊缝线:1164,同心圆:1165,齿轮:1166,块中心线:1167,圆公切线:1168,"基准符（2）":1169,插入图框:1170,绘制道路:1171,绘任意多边形:1172,按线对齐:1173,改字高:1174,改字宽:1175,刷内容:1176,换内容:1177,左右对齐:1178,上下对齐:1179,文字反转:1180,文字加框:1181,下划线:1182,图名线:1183,大小写:1184,数字求和:1185,选特定字:1186,前后缀:1187,连接文字:1188,去空格:1189,文字竖向:1190,按弧对齐:1191,修改全局文字样式:1192,提取文字:1193,文字编号:1194,多单转一多:2024,单转多:2025,多转多个单:2026,多转单个单:2027,改块名:1195,刷块:1196,块连线:1197,改块基点:1198,改块颜色:1199,多块旋转:1200,多块缩放:1201,刷块角度:1202,按块选择:1203,按块全选:1204,统计单块:1205,统计多块:1206,修改块图层:1207,长度:1208,统计面积:1209,智能标高:1210,面积:1211,矩形面积:1212,点到直线的距离:1213,弧长:1214,测量圆:1215,连续测量:1216,查看分段长度:1217,面积含弧线:1218,审图标注:1219,矩形标注:1220,粗糙度标注:1221,坐标标注:1222,标斜率:1223,对齐:1224,局部放大:1225,序号标注:1226,旋转标注:1227,圆孔标记:1228,向视符号:1229,射线标注:1230,矩形标注悬停变色:1231,裁剪图纸扩展:1232,箭头直线:1233,提取表格:1985,在线编辑表格:2001,选择的文字:1234,复制到剪贴板:1235,取消:1236,确定:1237,公差代号:1238,公差1:1239,公差2:1240,附注:1241,顶端:1242,底端:1243,基准:1244,全周符号:1245,当前行:1246,增加行:1247,删除行:1248,清零:1249,直线度:1250,平面度:1251,圆度:1252,圆柱度:1253,线轮廓度:1254,面轮廓度:1255,平行度:1256,垂直度:1257,倾斜度:1258,位置度:1259,同轴度:1260,对称度:1261,圆跳动:1262,全跳动:1263,清除:1264,"请输入文本内容和编号：":1265,"文本内容：":1266,"(输入0-20个字)":1267,"起始编号：":1268,"(编号自动递增1)":1269,"编号位置：":1270,编号在前:1271,编号在后:1272,改变方向:1273,"左边文字内容：":1274,"右边文字内容：":1275,"底部文字内容：":1276,基本符号:1277,相同要求:1278,多数符号:1279,长边加横线:1280,辅助符号:1281,补充符号:1282,符号位置:1283,特殊符号:1284,左尺寸:1285,上尺寸:1286,右尺寸:1287,交错焊缝:1288,间距:1289,扩充文字:1290,虚线位置:1291,焊接说明:1292,清除行:1293,卷边焊缝:1294,I型焊缝:1295,V型焊缝:1296,单边V型焊缝:1297,单边陡侧V型坡口堆焊:1298,倾斜焊缝:1299,可移除衬垫:1300,持久衬垫:1301,带顿边V型焊缝:1302,带顿边U型焊缝:1303,带顿边单边V型焊缝:1304,带顿边单边U型焊缝:1305,端接焊缝:1306,堆焊接头:1307,封底焊缝:1308,角焊缝:1309,塞焊缝或槽焊缝:1310,点焊缝:1311,折叠接口:1312,倾斜接口:1313,"点焊缝（偏移中心）":1314,缝焊缝:1315,"缝焊缝（偏离中心）":1316,陡侧V型坡口堆焊:1317,第一种平面符号:1318,第二种凹面符号:1319,第二种凸面符号:1320,第二种平面符号:1321,第一种凸面符号:1322,第三种平面符号:1323,第一种凹面符号:1324,削平焊缝:1325,趾部平滑过渡:1326,带垫板符号:1327,三面焊缝符号:1328,周围焊接符:1329,现场符号:1330,尾部符号:1331,交错断续焊接符号:1332,喇叭形焊缝:1333,单边喇叭形焊缝:1334,堆焊缝:1335,锁边焊缝:1336,锁边坡口:1337,上:1338,下:1339,无:1340,basicSymbol:1341,auxiliarySymbol:1342,suppleSymbol:1343,specialSymbol:1344,选择要在几何图形上放置的焊缝符号:1345,"焊角宽度：":1346,"单边V型对接焊缝（前视图）":1347,"角焊缝（前视图）":1348,"单边V型对接焊缝（侧视图）":1349,"角焊缝（侧视图）":1350},$S=void 0,eT=void 0,tT={languages:[{name:"zh-CN",title:"中文",active:!0,default:!0},{name:"en-US",title:"英语"},{name:"ko-KR",title:"韩语"},{name:"zh-TW",title:"繁体中文"}],library:!0,debug:!1},nT={"zh-CN":{718:" 指定输出范围第一点:",719:" 指定输出范围第二点:",720:" 指定第一点:",721:" 指定第二点:",722:" 云线框起始点:",723:" 云线框结束点:",724:" 审图标注点:",725:" 点击开启绘制云线:",726:" 再次点击结束绘制云线:",727:"指定一点:",728:"指定二点:",729:"选择对象",730:" 指定下一个点:",731:"\\指定插入基点",732:" 指定表格插入点:",733:"指定插入点:",734:"指定插入基点",735:"选择标注对象",736:"请选择目标文字",737:" 指定填充区域内部一点:",738:"没有找到闭合区域 ",739:"表面粗糙度",740:"焊接符号",741:"形位公差",742:"选择要需要开启自定义属性的对象",743:"选择要隐藏的对象",744:" 指定插入点:",745:" 指定一点:",746:"指定夹角",747:" 指定二点:",748:"选择图案填充对象",749:"指定第一点:",750:"指定第二点:",751:"指定第二个角度点:",752:"指定最后一个点:",753:"指定坐标点:",754:"指定标注点:",755:"请输入审批意见",756:"指定云线框起始点",757:"指定云线框终止点",758:"指定审图标注点",759:"指定第一个角点:",760:"指定第二个角点:",761:"指定序号位置:",762:"旋转符号",763:"标记类型",764:"请选择需要标记的圆:",765:"请设置定位点或直线或圆弧或圆",766:"拖动确定标注位置",767:"请指定或输入角度",768:"焊缝符号",769:"请拾取定位点、直线或圆弧",770:"请指定第二点",771:"请设置定位点",772:"请设置角度",773:"请设置定位点或直线或圆弧",774:"请设置引线转折点",775:"拖动确定定位点",776:"请指定第一点:",777:"请指定第二点:",778:"请选择目标块对象",779:"请输入新块名",780:"选择需要修改基点的块",781:"设置基点",782:"选择需要修改颜色的块",783:"输入颜色索引(0~256)",784:"请选择源块",785:"选择要刷的目标块:",786:"选择连接方式",787:"手动逐个连线",788:"自动批量连线",789:"请选择连线的块",790:"设置中心线长度",791:"选择要旋转的目标块:",792:"设置旋转角度",793:"请设置缩放比例",794:"请设置选择范围:",795:"请选择目标块",796:"请设置统计范围",797:"指定表格插入点:",798:"选择目标曲线",799:"指定长度标注点",800:"选择目标对象",801:"请选择目标斜率对象",802:"请设置标注文字高度",803:"指定斜率标注点",804:"请选择目标坐标点",805:"请指定标注位置",806:"指定起点",807:"指定终点",808:"指定标注方向",809:"请设置文字内容",810:"请选择面积的第一个点",811:"请选择下一个点",812:"请选择面积标注的位置",813:"请选择矩形的角点1",814:"请选择矩形的角点2",815:"请设置面积标注的位置",816:"请选择一个测量点",817:"请选择一条直线",818:"请设置尺寸线的位置",819:"请选择一条弧线",820:"请指定尺寸线位置",821:"请选择一个圆对象",822:"请指定文字位置",823:"请选择直线的端点或弧线",824:"请指定文字的位置",825:"请选择一个连续测量的标注",826:"请选择第二条直线",827:"请设置角度标注的位置",828:" 请输入星形顶点数：",829:" 指定星形中心点:",830:"请设置星形的内半径:",831:" 指定星形的外半径:",832:" 请输入凹凸线宽度<5>",833:" 请输入凹凸线高度<10>",834:"请点击确定起始点",835:"请点击确定终点",836:" 请输入锯齿线宽度<5>",837:" 请输入锯齿线高度<10>",838:" 请输入矩形宽度<5>",839:" 请输入矩形高度<10>",840:"请点击确定矩形中心",841:" 请输入管径<10>",842:" 请输入长出管口长度<5>",843:"请点击确定起点",844:"指定剖管线起点",845:"指定剖管线终点",846:"选择剖管线圆弧方向",847:"左边",848:"右边",849:"选择模式",850:"直线焊缝",851:"弧线焊缝",852:" 请输入焊缝半径<5>",853:"指定圆弧的第二个点",854:"指定圆弧的端点",855:"请输入宽度<25>",856:"请输入高度<15>",857:"请输入楼梯级数<10>",858:"请确定圆心位置 ",859:"请输入圆半径",860:" 请输入保温棉宽度<5>",861:" 请输入保温棉高度<10>",862:"请点击下一个点",863:"请选择第一条线",864:"请选择第二条线",865:"请选择终点",866:"请选择目标矩形",867:"设置指北针中心点",868:"设置指北针半径",869:"选择提示框指向",870:" 指定消息框第一点:",871:" 指定消息框第二点:",872:" 设置消息框指向:",873:"请设置基准符文字",874:"请设置文字高度",875:"请设置基准符位置",876:"请设置定位点或圆弧或直线",877:"请设置符号位置",878:"请设置圆心",879:"请设置齿轮圆心",880:"请设置齿轮半径",881:" 请设置中心线长度10>",882:"请选择第一个圆",883:"请选择第二个圆",884:"请设置矩形左上角点",885:"请设置矩形右下角点",886:"请设置圆角半径",887:"请选择多边形起点",888:"请选择多边形顶点",889:"选择对象:",890:"指定基点",891:"指定第二个点 ",892:"阵列",893:"退出",894:"放弃",895:"输入要进行阵列的项目数 ",896:"选择圆弧对象",897:"选择复制旋转对象:",898:"请指定目标点 ",899:"请指定旋转角度",900:"选择要转成多边形的对象",901:"设置多边形边数",902:" 输入选项",903:"内接于圆",904:"外切于圆",905:"选择要修改颜色的对象",906:"输入颜色索引",907:"隐藏",908:"隐藏未选",909:"全部显示",910:"选择目标的对象",911:" 指定删除方框第一点:",912:" 指定删除方框第二点:",913:" 选择需要精确删除的实体",914:" 请选择角度复制对象",915:" 请输入角度复制数量",916:" 请输入角度复制的基点",917:" 请输入复制角度",918:"请选择顶点对象",919:"请选择复制对象",920:"请确定复制基点",921:"请选择参考曲线",922:"选择打断对象",923:"指定偏移对象",924:"请输入偏移距离",925:"指定伸缩对象(选择直线、多段线、圆弧)",926:"伸缩至",927:"选择要修改线型比例的对象",928:"请输入线型比例",929:"请输入阵列间距",930:"请选择圆弧",931:"选择排列对象",932:"指定排列基点",933:"选择目标多段线:",934:"请输入圆角半径<5>",935:"选择填充对象",936:"请输入填充比例",937:"请选择原填充图形",938:"请点击填充图形内部任意一点",939:"请选择线对象",940:"选择等分模式",941:"定距等分",942:"定数等分",943:"偏移等分",944:"复制等分",945:"请选择偏移等分对象",946:"请选择复制等分对象",947:"请选择需要等分的线段",948:"请设置等分距离",949:"请设置等分的数量",950:"请设置偏移距离",951:"请指定偏移点",952:"请指定复制基点",953:"请指定复制等分数量",954:"请指定复制等分端点",955:"请选择需要矩形缩放的实体:",956:"请指定矩形的角点1",957:"请指定矩形角点2",958:"请选择放大中心点",959:"请选择放大范围",960:"请设置放大倍数",961:"请选择放大插入点",962:"请选择一条需要打断的曲线",963:"请在曲线上选取打断点",964:"请输入阵列数量",965:"是否开启旋转",966:"是",967:"否",968:"请选择需要阵列的图形:",969:"请选择阵列中心点",970:"请选择闭合多边形！",971:"请选择第一个点",972:"请选择第二个点",973:"请选择第一个闭合多边形",974:"请选择第二个闭合多边形",975:"请选择两个闭合多边形",976:"两个多边形没有重合边！",977:"请选择目标多边形",978:"请选择多边形需要添加顶点的边",979:"请设置添加的顶点位置",980:"请选择多边形需要删除的顶点",981:"请选择多边形需要拉伸的边",982:"请指定拉伸位置",983:"请设置图框方向<N>",984:"横向",985:"纵向",986:"请设置图框尺寸<4>",987:"请设置图框位置",988:"指定裁剪角点1",989:"指定裁剪角点2",990:"请设置道路起点",991:"请设置下一点",992:"请选择目标对齐线对象(选择直线)",993:"请选择目标文字对象",994:"选择文字对象",995:"请设置字高",996:"请设置字宽",997:"请选择源文字",998:"请选择第一个文字",999:"请选择第二个文字",1e3:"请选择需要对齐的文字",1001:"请选择对齐方式",1002:"左",1003:"中",1004:"右",1005:"请选择对齐基点",1006:"请选择需要反转的文字",1007:"请选择需要去空格的文字",1008:"请选择文字对象",1009:"请输入下划线宽度 ",1010:"请设置下划线距离 ",1011:"请设置下划线延长距离 ",1012:"请选择操作选项 ",1013:"大写",1014:"小写",1015:"句首大写",1016:"请选择数字对象",1017:"请选择文字插入点 ",1018:"选择要查找的范围:",1019:"请选择查找模式 ",1020:"等于",1021:"包含",1022:"前缀为",1023:"后缀为",1024:"请输入关键字 ",1025:"选择要操作的范围:",1026:"选择操作方式",1027:"添加",1028:"删除",1029:"选择操作位置",1030:"前缀",1031:"后缀",1032:"请输入内容",1033:"请选择文本 ",1034:"请选择圆弧 ",1035:"请选择文字样式",1036:"请设置文字提取范围",1037:"下载开Demo代码",1038:"下载开发包",1039:"调用画圆线命令",1040:"交互画直线",1041:"添加图层",1042:"得到所有图层",1043:"得到所有文字样式",1044:"得到所有图块",1045:"得到所有线型",1046:"写扩展数据",1047:"读扩展数据",1048:"测试插入一个图块",1049:"绘直线",1050:"绘圆弧",1051:"绘圆",1052:"绘PL线",1053:"绘填充",1054:"绘文字",1055:"绘椭圆",1056:"绘椭圆弧",1057:"绘制多行文字",1058:"绘制表格",1059:"绘制二维码",1060:"插入图章",1061:"得到所有对象",1062:"交互选择对象",1063:"保存mxweb到服务器",1064:"得到系统变量",1065:"新建图纸",1066:"白色背景色",1067:"文字查找定位",1068:"选择实体做块",1069:"绘制单行文字",1070:"选点填充",1071:"设置扩展属性",1072:"绘制对齐标注",1073:"绘性线标注",1074:"角度标注",1075:"修改对象线型",1076:"选择隐藏对象层",1077:"添加到当前选择",1078:"视区旋转",1079:"写扩展记录",1080:"得到命名字典",1081:"添加文字样式",1082:"绘自定义实体",1083:"修改对象颜色",1084:"修改对象不可见",1085:"修改对象层",1086:"修改对象显示顺序",1087:"指定范围输出pdf",1088:"绘制image",1089:"读取对象扩展字典",1090:"绘制3DPolyline",1091:"绘线文本自定义实体",1092:"计算交点",1093:"修改文字样式",1094:"偏移输入画线",1095:"创建组",1096:"屏幕截图jpg",1097:"获取图纸相同文字",1098:"指定范围输出dwg",1099:"测试绘制标记圆",1100:"测试Wipeout",1101:"创建剪切块",1102:"公差标注",1103:"改所有对象颜色",1104:"切剪mxweb",1105:"设置当前颜色线重",1106:"查找多边形区域内对象",1107:"打碎对象",1108:"绘半透明线",1109:"添加线型",1110:"修改图案比例",1111:"测试文字编辑",1112:"绘制条形码",1113:"屏幕截图bmp",1114:"修改工具",1115:"文字工具",1116:"绘图工具",1117:"块工具",1118:"测量工具",1119:"标注工具",1120:"其他工具",1121:"多重复制",1122:"弧转圆",1123:"复制旋转",1124:"圆转多边",1125:"修改颜色",1126:"圆弧切角",1127:"临时隐藏",1128:"方框删除",1129:"角度复制",1130:"顶点复制",1131:"交点打断",1132:"双向偏移",1133:"改圆大小",1134:"线型比例",1135:"伸缩",1136:"按弧阵列",1137:"pl圆角",1138:"pl线反向",1139:"得到所有直线对象",1140:"等分",1141:"矩形缩放",1142:"打断",1143:"切割多边形",1144:"合并多边形",1145:"添加多边形顶点",1146:"删除多边形顶点",1147:"多边形单边拉伸",1148:"星形",1149:"凹凸线",1150:"锯齿线",1151:"中心矩形",1152:"圆角矩形",1153:"圆中心线",1154:"管道",1155:"剖管符",1156:"中垂线",1157:"楼梯",1158:"实心圆",1159:"保温棉",1160:"中心线",1161:"开洞",1162:"消息框",1163:"基准符（1）",1164:"焊缝线",1165:"同心圆",1166:"齿轮",1167:"块中心线",1168:"圆公切线",1169:"基准符（2）",1170:"插入图框",1171:"绘制道路",1172:"绘任意多边形",1173:"按线对齐",1174:"改字高",1175:"改字宽",1176:"刷内容",1177:"换内容",1178:"左右对齐",1179:"上下对齐",1180:"文字反转",1181:"文字加框",1182:"下划线",1183:"图名线",1184:"大小写",1185:"数字求和",1186:"选特定字",1187:"前后缀",1188:"连接文字",1189:"去空格",1190:"文字竖向",1191:"按弧对齐",1192:"修改全局文字样式",1193:"提取文字",1194:"文字编号",1195:"改块名",1196:"刷块",1197:"块连线",1198:"改块基点",1199:"改块颜色",1200:"多块旋转",1201:"多块缩放",1202:"刷块角度",1203:"按块选择",1204:"按块全选",1205:"统计单块",1206:"统计多块",1207:"修改块图层",1208:"长度",1209:"统计面积",1210:"智能标高",1211:"面积",1212:"矩形面积",1213:"点到直线的距离",1214:"弧长",1215:"测量圆",1216:"连续测量",1217:"查看分段长度",1218:"面积含弧线",1219:"审图标注",1220:"矩形标注",1221:"粗糙度标注",1222:"坐标标注",1223:"标斜率",1224:"对齐",1225:"局部放大",1226:"序号标注",1227:"旋转标注",1228:"圆孔标记",1229:"向视符号",1230:"射线标注",1231:"矩形标注悬停变色",1232:"裁剪图纸扩展",1233:"箭头直线",1234:"选择的文字",1235:"复制到剪贴板",1236:"取消",1237:"确定",1238:"公差代号",1239:"公差1",1240:"公差2",1241:"附注",1242:"顶端",1243:"底端",1244:"基准",1245:"全周符号",1246:"当前行",1247:"增加行",1248:"删除行",1249:"清零",1250:"直线度",1251:"平面度",1252:"圆度",1253:"圆柱度",1254:"线轮廓度",1255:"面轮廓度",1256:"平行度",1257:"垂直度",1258:"倾斜度",1259:"位置度",1260:"同轴度",1261:"对称度",1262:"圆跳动",1263:"全跳动",1264:"清除",1265:"请输入文本内容和编号：",1266:"文本内容：",1267:"(输入0-20个字)",1268:"起始编号：",1269:"(编号自动递增1)",1270:"编号位置：",1271:"编号在前",1272:"编号在后",1273:"改变方向",1274:"左边文字内容：",1275:"右边文字内容：",1276:"底部文字内容：",1277:"基本符号",1278:"相同要求",1279:"多数符号",1280:"长边加横线",1281:"辅助符号",1282:"补充符号",1283:"符号位置",1284:"特殊符号",1285:"左尺寸",1286:"上尺寸",1287:"右尺寸",1288:"交错焊缝",1289:"间距",1290:"扩充文字",1291:"虚线位置",1292:"焊接说明",1293:"清除行",1294:"卷边焊缝",1295:"I型焊缝",1296:"V型焊缝",1297:"单边V型焊缝",1298:"单边陡侧V型坡口堆焊",1299:"倾斜焊缝",1300:"可移除衬垫",1301:"持久衬垫",1302:"带顿边V型焊缝",1303:"带顿边U型焊缝",1304:"带顿边单边V型焊缝",1305:"带顿边单边U型焊缝",1306:"端接焊缝",1307:"堆焊接头",1308:"封底焊缝",1309:"角焊缝",1310:"塞焊缝或槽焊缝",1311:"点焊缝",1312:"折叠接口",1313:"倾斜接口",1314:"点焊缝（偏移中心）",1315:"缝焊缝",1316:"缝焊缝（偏离中心）",1317:"陡侧V型坡口堆焊",1318:"第一种平面符号",1319:"第二种凹面符号",1320:"第二种凸面符号",1321:"第二种平面符号",1322:"第一种凸面符号",1323:"第三种平面符号",1324:"第一种凹面符号",1325:"削平焊缝",1326:"趾部平滑过渡",1327:"带垫板符号",1328:"三面焊缝符号",1329:"周围焊接符",1330:"现场符号",1331:"尾部符号",1332:"交错断续焊接符号",1333:"喇叭形焊缝",1334:"单边喇叭形焊缝",1335:"堆焊缝",1336:"锁边焊缝",1337:"锁边坡口",1338:"上",1339:"下",1340:"无",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"选择要在几何图形上放置的焊缝符号",1346:"焊角宽度：",1347:"单边V型对接焊缝（前视图）",1348:"角焊缝（前视图）",1349:"单边V型对接焊缝（侧视图）",1350:"角焊缝（侧视图）",1985:"提取表格",1996:"请输入表格提取精度",1997:"选择提取范围第一个角点",1998:"选择提取范围第二个角点",1999:"未识别到有效表格!",2e3:"请在本地环境测试！",2001:"在线编辑表格",2019:"输入编号文字",2020:"请选择一个单行文本",2021:"请选择一个多行文本",2022:"请设置文字插入点",2023:"请选择单行文本",2024:"多单转一多",2025:"单转多",2026:"多转多个单",2027:"多转单个单"},"en-US":()=>Sy(()=>Promise.resolve().then(()=>PF),void 0),"ko-KR":()=>Sy(()=>Promise.resolve().then(()=>CF),void 0),"zh-TW":()=>Sy(()=>Promise.resolve().then(()=>RF),void 0)},Dh=new RS(rf({id:"mxcad-plugin__1_0_0",idMap:QS,formatters:KS,storage:LS,messages:nT,paragraphs:JS,component:$S,loader:ZS,transform:eT},tT)),iT=Dh.t;Dh.$t,Dh.Translate;const f1=V.ref();Dh.on("change",e=>{f1.value=e});const at=(e,...t)=>(f1.value,Dh.t(e,...t)),ra=V.ref("");V.reactive([]);const fs=V.ref(300),rT=V.reactive(["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAJdJREFUSEvdlsESwBAMRMX/f7N2HJhOJVmh0ZYr9nlUiojoCAsbbQdMKYUYY91DV8M7LFP3AXJ2boYSbA+gZudiuBSIYI8a9sD+C+y1awzzxNF2rZdaRlPaLKvNwdbx7wMtq7baqV8pCkP90jmKvycUiPrNQG1rR2Hw4kvBbkDOcgYGDcs5FMgs7LtAy91EpdH11cbBlwNPJSqCVTTcHlQAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAALNJREFUSEvdlksOgCAMBS33PzOaLjCkPvoBIYpLhE6m0AIR0Xks/Gg7YM75SCndOZxqKGFM3QeI7KYZtmB7ADW7KYZLgRbsVUMP7L9Ar93DEC3kMfnVvZH/dQPl4lagejwCg3tYAliBvPNkdmDzLmmUqasXe+age715W3gNo4+F7wC102fZa9bqBYxKogTT9rcbiCxH7NytrbcEQqdUlgCncNTObRhtX0N7GK0za/7UZyKCX603kVXE3zhDAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAJdJREFUSEvd1kEOgCAMBEDK/99cDQeMEcqyYlHxiu24KIKIyBYmXrIcqKohxnjMoWvCK5bUdcBaOreEFrYG2ErnknAqiLBHE/Zg/wV70xUJmcLzBsPUFb82pjih7P3vg8xTs+maXylqhsatQ4S5PaGGaJwGW1N7F4ML32rsBtZSjmAwYX4PGRnFvgsyaxOdqV1PbTV8OrgD32GFVQtEr98AAAAASUVORK5CYII="]),Yy=()=>{const e=R.MxCpp.getCurrentMxCAD(),{pt1:t,pt3:i}=e.getViewCADCoord(),l=i.sub(t).normalize(),c=i.clone().addvec(l.clone().mult(1e3)),h=i.clone().addvec(l.clone().mult(2e3)),f=c.clone().addvec(h.sub(c).mult(.5));let r=new R.McDbWipeout;r.setVertices(new R.McGePoint3dArray([c,new R.McGePoint3d(c.x,h.y),h,new R.McGePoint3d(h.x,c.y)])),r=e.drawEntity(r).getMcDbObject();let _=R.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder().maxDrawOrder+1;return r.drawOrder=_,{wipeout:r,midPt:f}},Bo=V.ref(),To=MxPluginContext.useDialogIsShow();var ci=(e=>(e.Straightness="u",e.Flatness="c",e.Roundness="e",e.Cylindricity="g",e.LineContourdegree="k",e.SurfaceContourDegree="d",e.Parallelism="f",e.Perpendicularity="b",e.TiltDegree="a",e.PositionalDegree="j",e.Coaxiality="r",e.SymmetryDegree="i",e.CircleJumping="h",e.FullBeat="t",e.None="",e))(ci||{});class Ih extends R.McDbCustomEntity{constructor(t){super(t),this.startPoint=new R.McGePoint3d,this.turningPoint=new R.McGePoint3d,this.dimPoint=new R.McGePoint3d,this.endPoint=new R.McGePoint3d,this.size=4,this.isShowFull=!1,this.toleranceContents=[],this.notesUp="",this.notesDown="",this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new Ih(t)}getTypeName(){return"MxDbGeometricTolerances"}set dimSize(t){this.size=t}get dimSize(){return this.size}set isShowFullWeekSymbol(t){this.isShowFull=t}get isShowFullWeekSymbol(){return this.isShowFull}set dimToleranceContents(t){this.toleranceContents=t}get dimToleranceContents(){return this.toleranceContents}set dimNotesUp(t){this.notesUp=t}get dimNotesUp(){return this.notesUp}set dimNotesDown(t){this.notesDown=t}get dimNotesDown(){return this.notesDown}dwgInFields(t){return this.startPoint=t.readPoint("startPoint").val,this.turningPoint=t.readPoint("turningPoint").val,this.dimPoint=t.readPoint("dimPoint").val,this.endPoint=t.readPoint("endPoint").val,this.size=t.readDouble("size").val,this.isShowFull=!!t.readLong("isShowFull").val,this.notesUp=t.readString("notesUp").val,this.notesDown=t.readString("notesDown").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,this.toleranceContents=JSON.parse(t.readString("toleranceContents").val),!0}dwgOutFields(t){return t.writePoint("startPoint",this.startPoint),t.writePoint("turningPoint",this.turningPoint),t.writePoint("dimPoint",this.dimPoint),t.writePoint("endPoint",this.endPoint),t.writeDouble("size",this.size),t.writeLong("isShowFull",this.isShowFull?1:0),t.writeString("notesUp",this.notesUp),t.writeString("notesDown",this.notesDown),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),t.writeString("toleranceContents",JSON.stringify(this.toleranceContents)),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),t===0?(this.startPoint.x+=i,this.startPoint.y+=l,this.startPoint.z+=c):t===1?(this.turningPoint.x+=i,this.turningPoint.y+=l,this.turningPoint.z+=c):t===2?(this.dimPoint.x+=i,this.dimPoint.y+=l,this.dimPoint.z+=c,this.endPoint.x+=i,this.endPoint.y+=l,this.endPoint.z+=c):t===3&&(this.endPoint.x+=i,this.endPoint.y+=l,this.endPoint.z+=c)}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.startPoint),t.append(this.turningPoint),t.append(this.dimPoint),t.append(this.endPoint),t}drawArrow(){const t=this.startPoint,i=this.turningPoint,l=this.size,c=i.sub(t).normalize().mult(l),h=t.clone().addvec(c),f=c.clone().rotateBy(Math.PI/2).normalize().mult(l/8),r=h.clone().addvec(f),v=h.clone().subvec(f),_=new R.McDbHatch;_.appendLoop(new R.McGePoint3dArray([t,r,v]));const w=[this.startPoint,this.turningPoint,this.dimPoint,this.endPoint],b=new R.McDbPolyline;return w.forEach(E=>b.addVertexAt(E)),[_,b]}worldDraw(t){const i=R.MxCpp.getCurrentMxCAD();["cxgdtshp","cxgdt"].forEach(f=>{i.getDatabase().getTextStyleTable().has(f)||R.MxCpp.App.loadFonts([`${f}.shx`],[],[`${f}.shx`],()=>{i.addTextStyle(f,`${f}.shx`,`${f}.shx`)})});const{MText:c,allEntityArr:h}=this.getAllEnitty();c.forEach(f=>{f.worldDraw(t)}),h.forEach(f=>{t.drawEntity(f)})}getAllEnitty(){const t=[],i=this.drawArrow();t.push(...i);const l=["k","d"];if(this.toleranceContents.length===1&&l.includes(this.toleranceContents[0].toleranceCode)&&this.isShowFull){const F=new R.McDbCircle(this.dimPoint.x,this.dimPoint.y,0,this.size*.4375);t.push(F)}const c=this.size*(7/4),h=R.McGeVector3d.kYAxis.clone().mult(c*(this.toleranceContents.length/2)),f=this.endPoint.clone().addvec(h),r=this.endPoint.clone().addvec(h.clone().negate());t.push(...this.drawCode(f.clone(),r.clone(),c));const v=R.McGeVector3d.kXAxis.clone().mult(c),{MText:_,entityArr:w,max_x:b}=this.drawToleranceContents(f.clone().addvec(v),r.clone().addvec(v),c);t.push(...w);const{MText:E,entityArr:P}=this.drawBenchmark(new R.McGePoint3d(b,f.y),new R.McGePoint3d(b,r.y),c);return t.push(...P),_.push(...E),[this.notesUp,this.notesDown].forEach((F,B)=>{const O=new R.McDbMText;O.contents=F,O.textHeight=this.size*(3/4),O.location=B==0?f.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size)):r.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate()),t.push(O)}),{allEntityArr:t,MText:_}}drawCode(t,i,l){const c=[],h=new R.McDbPolyline;h.isClosed=!0;const f=R.McGeVector3d.kXAxis.clone().mult(l);[i,t,t.clone().addvec(f),i.clone().addvec(f)].forEach(E=>h.addVertexAt(E)),c.push(h);const v=E=>{const P=[];let I=0;for(;I<E.length;){let F=I+1;for(;F<E.length&&E[F]===E[I];)F++;P.push({value:E[I],count:F-I}),I=F}return P},_=this.toleranceContents.map(E=>E.toleranceCode),w=v(_),b=R.McGeVector3d.kXAxis.clone().mult(l);return w.forEach(E=>{const P=new R.McDbMText;P.textHeight=this.size*(3/4),P.contents=E.value,P.attachment=R.McDb.AttachmentPoint.kBottomMid;const I=i.sub(t).normalize().mult(l*E.count),F=t.clone().addvec(I.clone().mult(1/2)).addvec(b.clone().mult(1/2));P.location=F,P.textStyle="cxgdt",t.addvec(I),c.push(P),P.reCompute();const{maxPt:B,minPt:O}=R.MxCADUtility.getTextEntityBox(P,!1);O.distanceTo(B)>P.textHeight*3&&B.addvec(R.McGeVector3d.kXAxis.clone().negate().mult(P.textHeight*(7/4)));const W=O.clone().addvec(B.sub(O).mult(1/2));P.move(W,F);const Z=new R.McDbLine(t,t.clone().addvec(b));c.push(Z)}),c}drawToleranceContents(t,i,l){const c=[],h=[],f=R.MxCpp.getCurrentMxCAD();let r=t.x;const v=R.McGeVector3d.kXAxis.clone().mult(this.size/4),_=R.McGeVector3d.kYAxis.clone().mult(l).negate();return this.toleranceContents.forEach((w,b)=>{const E=t.clone(),P=i.clone();if(w.tolerance.length){E.addvec(v).addvec(_.clone().mult(b));const I=R.McGeVector3d.kYAxis.clone().mult(l/2-this.size*(3/8)).negate();w.tolerance.forEach((F,B)=>{if(B===4||B===3&&(F==="{"||F==="@")){const O=new R.MxCADMText;O.data=[{type:"paragraph",children:[{text:F,font:"cxgdtshp.shx"}]}],O.position=E.clone().addvec(I),O.textBaseHeight=this.size*(3/4),h.push(O);const W=R.McGeVector3d.kXAxis.clone().mult(this.size),Z=O.position.clone().addvec(W);E.x=P.x=Z.x}else{const O=new R.McDbMText;O.contents=F,O.location=E.clone().addvec(I),O.textHeight=this.size*(3/4),B==2||B==4?O.textStyle="cxgdtshp":B==3&&F!=="{"?O.textStyle="cxgdt":O.textStyleId=f.getDatabase().getCurrentlyTextStyleId(),O.reCompute();const{maxPt:W,minPt:Z}=R.MxCADUtility.getTextEntityBox(O,!1);E.x=P.x=W.x,c.push(O)}})}E.x>r&&(r=E.x)}),r>t.x&&(this.toleranceContents.forEach((w,b)=>{const E=new R.McDbPolyline,P=new R.McGePoint3d(r,t.y),I=new R.McGePoint3d(r,i.y);if([t,P.clone().addvec(v),I.clone().addvec(v)].forEach(B=>E.addVertexAt(B)),c.push(E),t.addvec(_),b===this.toleranceContents.length-1){const B=new R.McDbLine(I.clone().addvec(v),i);c.push(B)}}),r=new R.McGePoint3d(r,t.y).addvec(v).x),{entityArr:c,MText:h,max_x:r}}drawBenchmark(t,i,l){const c=R.MxCpp.getCurrentMxCAD(),h=R.McGeVector3d.kYAxis.clone().mult(l/2-this.size*(3/8)).negate(),f=R.McGeVector3d.kYAxis.clone().mult(l).negate(),r=R.McGeVector3d.kXAxis.clone().mult(this.size/4);let v=t.x;const _=[],w=[],b=(B,O)=>{const W=[];let Z=O.clone();return O.addvec(r),B.length===2&&B.filter(ie=>ie.length!=0).length===2&&B.splice(1,0,["-"]),B.forEach((ie,$)=>{ie.length&&ie.forEach((oe,be)=>{if(be===1&&oe==="{"){const fe=new R.MxCADMText;fe.data=[{type:"paragraph",children:[{text:oe,font:"cxgdtshp.shx"}]}],fe.position=O.clone().addvec(h),fe.textBaseHeight=this.size*(3/4),w.push(fe);const Le=R.McGeVector3d.kXAxis.clone().mult(this.size),Xe=fe.position.clone().addvec(Le);O.x=Z.x=Xe.x}else{const fe=new R.McDbMText;fe.contents=oe,fe.location=O.clone().addvec(h),fe.textHeight=this.size*(3/4),be==1?fe.textStyle="CXGDT":fe.textStyleId=c.getDatabase().getCurrentlyTextStyleId(),fe.reCompute();const{maxPt:Le,minPt:Xe}=R.MxCADUtility.getTextEntityBox(fe,!1);v<Le.x&&(v=Le.x),Z.x=Le.x,W.push(fe),O.x=Le.x}})}),v<Z.x&&(v=Z.x),W},E=[],P=[],I=["b1","b2","b3"];let F=t.x;if(I.forEach((B,O)=>{O!=0&&_.length&&(F=Math.max(..._),P.push(F)),_.length=0,this.toleranceContents.forEach((W,Z)=>{var ie;if((ie=W.Benchmark[B])!=null&&ie.length&&W.Benchmark[B].filter($=>$.length).length>0){const $=new R.McGePoint3d(F,t.clone().addvec(f.clone().mult(Z)).y);E.push(...b(W.Benchmark[B],$));const oe=new R.McGePoint3d(v,t.y);oe.addvec(r),v=oe.x,_.push(v)}})}),E.length>0){P.forEach(W=>{const Z=new R.McDbLine(new R.McGePoint3d(W,t.y),new R.McGePoint3d(W,i.y));E.push(Z)});const B=new R.McDbLine(new R.McGePoint3d(v,t.y),new R.McGePoint3d(v,i.y)),O=new R.McDbLine(i,new R.McGePoint3d(v,i.y));E.push(B,O),this.toleranceContents.forEach((W,Z)=>{Z!=0&&t.addvec(f.clone());const ie=new R.McDbLine(t,new R.McGePoint3d(v,t.y));E.push(ie)})}return{entityArr:E,MText:w}}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbMText){const w=i.getDatabase().getCurrentlyTextStyleId();f.textStyleId=w,f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setStartPoint(t){this.startPoint=this.turningPoint=this.endPoint=this.dimPoint=t.clone()}getStartPoint(){return this.startPoint}setTurningPoint(t){this.turningPoint=this.endPoint=this.dimPoint=t.clone()}getTurningPoint(){return this.turningPoint}setEndPoint(t){this.endPoint=t.clone()}getEndPoint(){return this.endPoint}getDimPoint(){return this.dimPoint}setDimPoint(t){this.dimPoint=this.endPoint=t.clone()}getBoundingBox(){const{allEntityArr:t}=this.getAllEnitty();return this.getBox(t),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function oT(){return Pn(this,null,function*(){ra.value="GemoetricToleranceDialog",To.showDialog(!0,{title:at("形位公差")}).then(i=>Pn(this,[i],function*({data:e,isCanceled:t}){if(!t){const l=e.formData,c=new Ih;c.dimToleranceContents=(l==null?void 0:l.dimToleranceContents)||[],c.isShowFullWeekSymbol=(l==null?void 0:l.isShowFull)||!1,c.dimNotesDown=(l==null?void 0:l.downDim)||"",c.dimNotesUp=(l==null?void 0:l.topDim)||"";const h=new R.MxCADUiPrPoint;h.setMessage("请设置定位点或直线或圆弧或圆");const f=yield h.go();if(!f)return;c.setStartPoint(f);const r=new R.MxCADUiPrPoint;r.setMessage("请设置转折点"),r.setUserDraw((E,P)=>{const I=c.clone();I.setTurningPoint(E),P.drawMcDbEntity(I)});const v=yield r.go();if(!v)return;c.setTurningPoint(v);const _=new R.MxCADUiPrPoint;_.setMessage("拖动确定标注位置"),_.setUserDraw((E,P)=>{const I=c.clone();I.setDimPoint(E),P.drawMcDbEntity(I)});const w=yield _.go();if(w){c.setDimPoint(w);const E=new R.MxCADUiPrPoint;E.setMessage("拖动确定标注位置"),E.setUserDraw((I,F)=>{const B=c.clone();B.setEndPoint(I),F.drawMcDbEntity(B)});const P=yield E.go();P&&c.setEndPoint(P)}R.MxCpp.getCurrentMxCAD().drawEntity(c)}}))})}function aT(){new Ih().rxInit(),Ke.MxFun.addCommand("Mx_Test_DrawGT",oT)}const sT={class:"fcc"},lT={style:{"margin-bottom":"10px"},class:"fcc"},cT=V.defineComponent({__name:"RotateDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=V.reactive({direct:Lh.right,lText:"",bText:"",rText:""}),l=V.ref();let c=null;V.onMounted(()=>{fs.value=300,h()});const h=()=>Pn(this,null,function*(){let _;c?_=c.getMcDbEntity():_=new yf,_.visible=!0,_.RotateDirect=i.direct,_.leftTextStr=i.lText,_.bottomTextStr=i.bText,_.rightTextStr=i.rText;const w=R.MxCpp.getCurrentMxCAD(),{pt1:b,pt3:E}=w.getViewCADCoord(),P=E.sub(b).normalize(),I=E.clone().addvec(P.clone().mult(1e3)),F=E.clone().addvec(P.clone().mult(2e3)),B=I.clone().addvec(F.sub(I).mult(.5));_.setRotatePos(B);let O=new R.McDbWipeout;O.setVertices(new R.McGePoint3dArray([I,new R.McGePoint3d(I.x,F.y),F,new R.McGePoint3d(F.x,I.y)])),O=w.drawEntity(O).getMcDbObject();let W=R.MxCpp.getCurrentDatabase().currentSpace.getMinMaxDrawOrder(),Z=W.maxDrawOrder+1;O.drawOrder=Z,c||(c=w.drawEntity(_),_=c.getMcDbEntity(),t("receiveParameters",{dimHandle:_.getHandle()})),_.drawOrder=W.maxDrawOrder+2;const ie=_.getBoundingBox(),$=ie.minPt.sub(ie.maxPt).normalize().mult(5),oe=ie.minPt.clone().addvec($),be=ie.maxPt.clone().addvec($.clone().negate()),fe=yield Af({type:"image/bmp",width:200,height:80,range_pt1:oe.toVector3(),range_pt2:be.toVector3()});l.value.src=fe,O.erase(),_.visible=!1,w.mxdraw.updateCanvasSize()}),f=()=>{i.direct=i.direct===Lh.right?Lh.left:Lh.right,h()},r=v(()=>{h()},300);function v(_,w){let b=null;return function(...E){b&&clearTimeout(b),b=setTimeout(()=>{_.apply(this,E)},w)}}return(_,w)=>(V.openBlock(),V.createElementBlock("div",null,[V.createElementVNode("div",sT,[V.createElementVNode("img",{ref_key:"img",ref:l,style:{margin:"10px 0px",width:"90%"}},null,512)]),V.createElementVNode("div",lT,[V.createVNode(V.unref(tn.VBtn),{onClick:f},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(V.unref(at)("改变方向")),1)]),_:1})]),V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.lText,"onUpdate:modelValue":w[0]||(w[0]=b=>i.lText=b),onInput:V.unref(r)},{prepend:V.withCtx(()=>[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("左边文字内容：")),1)]),_:1},8,["modelValue","onInput"]),V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.rText,"onUpdate:modelValue":w[1]||(w[1]=b=>i.rText=b),onInput:V.unref(r)},{prepend:V.withCtx(()=>[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("右边文字内容：")),1)]),_:1},8,["modelValue","onInput"]),V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.bText,"onUpdate:modelValue":w[2]||(w[2]=b=>i.bText=b),onInput:V.unref(r)},{prepend:V.withCtx(()=>[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("底部文字内容：")),1)]),_:1},8,["modelValue","onInput"])]))}}),pz="",ms=(e,t)=>{const i=e.__vccOpts||e;for(const[l,c]of t)i[l]=c;return i},uT=ms(cT,[["__scopeId","data-v-4c78b384"],["__file","RotateDialog.vue"]]),hT={style:{"padding-top":"10px"}},dT=["onClick"],pT=["src"],fT=V.defineComponent({__name:"RoundMarkDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=V.reactive([["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAP1JREFUWEftl9EKxCAMBI3//816pGAJou7Gk9I74ksfWnWcqElFRGp6SZOAmUTiiJlSa8oiXwc7YGYK/8NMKeVeYL9bJOet/eM20yCymbAaMEvhhaJhRhBt4hlMe89CUTAKYk30MUAw+j0D9FswyIqumjHD2IFmXgPDgHjMIDtLMwFjj6pmYG8TR5/aZXeb7Y+EiS0hUNgDZruEQGp1YCZMzDhHLr3HYK6Vg0SJYFD/O7szvyposEdhmh19jkqJGcyqBhptYrhn+k6jCXoYL4QrTKNV2Bo46a1qbuFVIba63d1mhmDxEzdxjE4Tm3iPhImdDH0XMNuJEqk9+f4D+0DNahN82WgAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAQZJREFUWEftl20PgyAMhC3//zfTpURMJeAd+BJn8MuMbuXZtVyLiIguL7lkwjQycYkyUXUJIqeTPWFaEn5DGY1x9we9P4QQhuqnW5kSIq8qDiCuoL1QNEwLogaTn/VCUTAIxBb3ypQ5MihGpf+CYVRByth7Rh2ozGtgWBBGGUadQ2UmjN+K1oE373D3yFJ1sGv7bn+YJmYHpFogRwgUb8IMjxBIWjZNTBxoekwQpmaYOBCGMSsEw4Ak42SOKijYozBZHfusjQItmFvmmZ0pVqa4EqYXYjNZJk21rZgXTO/MfZ1bM4NULSZVM6gVoJpBvz+tTNnP5omSlXzke5fUzMjCtxXwJ2F+HwPOahopb8wAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPtJREFUWEftl+EOwyAIhIvv/8yy0MSVNMqdrmtcZ381qeLHAUJFRHSb5JEF04jEJcpk1S2JfBzsBdOS8BnK5JwPBy1f9LghUkpD+dOtTIHwB54TuLaGoaNhogNa1dQLRcGY0Uh6VNpof1Htt2AYr5Ay5jljByrDGLkFhgHZvSbbAbIXKoM2l8T7Dxjz8l1q7h1dWjrYtX23D8Ok/soHNEK0ABT2BTM8QrChQmFCITJAeOlNBWPEDFCkDKMKpcx0MAxQTZmvzDM++1sh8zC9EF3zTK0Uz1D+H/m2GbgGxjZK1FJgaSMDPSMEsvU8GOQx+/0SZdjD0LoF01LoBeJUzmrUUEc9AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAP5JREFUWEftl8EOhCAMRC3//810UxMiS6AzVWJcFy8ehPI6bWkVEdHtIY8smEEkpiiTVbckcjnYC2Yk4TuUyTkfDlq+6HFDpJRO5U9YmQJRH9gmcG8NQ0fDeAeMqikKRcGYUU96VNpof1Htt2AYr5Ay5jljByrDGLkFhgHZvSbbAbLnKoM2l8T7DxjzMvpIYI823b3u9lPCpHVrAJ6I0yoWzOkRgqkoNkxeiAxwyqV3GwxzlTMwSBVKmcfBFCB790YJpAyjCq1Mnf29gWkEw0KE5pleKdYzcPvHFIW4DPOlFtm1UZuBpY0MREYIZOt9MMhj9vsUZdjD0LoFM1LoA8NFzWpEnyLbAAAAAElFTkSuQmCC"],["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPNJREFUWEftl9EOxCAIBIv//816sYmGGGFXzwfvQp+atLXjgIgiIuW55JKAMSJxxEwu5UkiXwc7YCyF/2Em59wnOGaLpLSVP8tmGkRSPywKTFOsQtEwM4j2YwumPWehKJgKok2MMUAw9X0G6LdgkJU6a8YMYweauQaGAVkxg+y4ZgJGL9W6A/f6oO63SurkozLs7nq3d8PErhKUC40JhT1gtlsINlSo3KMQvaFGDflVMGxR88wwVigz18EwQDMzXg80S2KYM2zvomFWIXqRRQlsLcMxsfUZ2WvEvEq+bGY2WBziLMVXmTm1ox/JmYA5ZcAa5wMuAbFqpB3bfgAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPdJREFUWEftl9EOgyAMAC3//82w1IwFG6AH44Et+KJRlPOKbRURSdcmmxyYRiSWmIkpXUHk62AfmJbC/zCTYny8YJkfQghT62fYjIXIs0oBEN+go1AYpgVRg8nnRqEQjAeik5dmbIwUilj6LRhixTOj14kd18w2MBSEmCF2umYOTPkpagX+5I7ieCqlVm5KprqX1b4bJvIF6HyrwnlgplsIEioapl7JuNOD15BvBUOSFTHjWUFmtoPJQLqvtQKeGWIFm3kkxUoXR7o/kjTdBdx6SO7i7jcyg6gJ++xpGFtCzk9cLWxb/d6SxUnGLFkzZCIy5sC0LL0AMqaxakmqNb4AAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAASVJREFUWEftltEOwjAIRaX//82tYRkbmS0XLJpqthcf1O709FIgImqPRR66YQYnkWKmtvYoRNOHfcOMFP6HmVrruUHOSztvCE4PlRLOUNiMQBT1smuA2w4aBXLD9CBk6xpGQLQWL5QLhkG0iat/BMO/9wClwvSsCHgKDLLCLxMzFozHDjSTCYOATBgPiJghVdq9muZjQut9HEZn5Ssw16yMwhqG4TBGHzmi9kbn1t0+7Zg8I0TYjLaC/ty7gS2raL3fMbOVLWgF+tKbsbLdQWggXwrGYwfNwJ4NucwsByNA/NkbJUZmrBmo2zJQZl5ml32Ksya9KMQxZkRhjrvFmIGtQcyqOFhNntaAAuxZwx1gtNgNgwzNfp+SmVmI6WrKAtDrLGXmCfqx7mrfNgvzAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAASBJREFUWEftl+sOgyAMhS3v/8ywVO3WEWpPhaAm8sfEVfh6eqEjIirLTRa9MEYkhiiTS1kSUXewXxhLwucrU3Je/voB50v5vUkpncqfsDIMwovUgXUC590mCgXDCIR2WYCsaopCQTAtEK2OV9oMhajUBSNA02AsVSRcHCoPhm0RdQ6V8UBQZYbAiDceVCGCrgNPnUNl6o8tqEtgdFnXYLrvWB0vrAwnY2TRbs/qnFn6tg+FyfQYHCHCyugDvY/FFiltpKKeowzizWoDhAlR2b0OkE2mwSDqeDCIQ2s3R/6qeJtNhRF1+NkaBabOM3W511DTJ7264ckUt82gF83ArS7s5Qx6TUAJ7G32wngK9f4+JEy9EN95Gml6ow7z9rmVMh/YSO1q8b/D3AAAAABJRU5ErkJggg=="],["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAQRJREFUWEftllkOwyAMRDH3PzNUjoJCUcwMS+kG32Cex6uISHQfcmTDGJGYokyI0XmR4WBvGEvC31AmhHA5qPkSrw7hve/Kn2ZlEkT+YZnAd3cYOhqm9oFVTa1QFIwarUmPShu9T6p9FwzjFVJGPWfsQGUYI0tgGJDDa3IcIHtVZdDjlHj/AaNethw578fOqZ1P++4wxXwcOOeEGAEo7E0wJUBSUFVh9pkpMBbEUhgEoTAaHqaakCqHLbSQI6ClMEpcA2JgGFUoZWowqYJQmKbCWEAI5iX7TN4EU8jyvrJ80yuBnvr0u3bgu1GBcoYdL7C0GUMbhlFp5M6UMI0A5G83jKXkA1FY7WrummwAAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAARlJREFUWEftl8ESwyAIRMX//2btkCmNkxF3tUzapsklhyg+FgQiIlLTlzxywziRCFGm1JqyyNvBvmE8Ca+hTClld1Dzpe4VIue8lD/TyhhEe+AxgXtrGDoaZnSAd5tmoSgYNTqSHl1ttN9U+y0YxiukjHrO2IHKMEZOgWFANq/JdoDsDZVBmy3x/gNGvZx95LmnLnTuttuHhKm2rSGlJE47QGEPgVE1TZ2jqi3Yx2Fe1TVnWGtC68wxXL3c80Koa0+FGYFQMEwptzozUgaBhMOoQQ8oDMbU0XdvlGgrcA+GAaGVaRORmfQMiIWYmmd6t2I0A+sf1CzIkjJdMLJrozYDrzYyMDNCIFvXg0Ees99DlGEPQ+tuGE+hB/YM7mqvcQMKAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAS5JREFUWEftltEOgyAMRS3//82w1KyzI9DbSmfMoq8qHA6XUiKitt3koQdmshMpZmprWyFa3uwHZqbwP8zUWo8Fcl7aUSE4PVRKOENhMwJR1GR9gNsbNArkhhlByNI1jIBoLV4oFwyDaBO9fwTD33uAUmFGVgQ8BQZZ4cnEjAXjsQPNZMIgIBPGAyJmSB3t0ZnmbULj/RxGZ+USmD4rs7CGYTiMkUdvTztxc+vb/vQ2eW3ohYXNWD/Pji4b8fQzKTCoflwCgyCkbng6PWRlHws15Ahorx+OtjMFhonRnYNgPCAuMxaM1JNLYWZACMbqgYZXBspM/9Ooi+vNRCE+bUYURix91emuB7YaMau6w9PkuRpQZjxjuAOMBntgkKHV9ymZWYVYOk1Zk/fj3MrMC5xn8Wqmr+N5AAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAT1JREFUWEftl+0KwyAMRRvf/5l1pCwsDcZ7raXboP4ZFD+OJyY6EZG2/UiTByaJxCVmamtbEVkO9gOTKfx/M63W7VAP9Ly0z5dSyqnzM21GQbSJWzAe4PruMwtFwxiE37IBZdk0C0XB9EC8HZTaCsVYWoIxoNtgMisWLg0VgtG+jJ2hGQTCmrkExnaDoJoIdR0gO0MzcXAG9RUYn9YRzNedrOJNm9HDONPE9VdDs83f9lNhyhZiLU2b8QuiwdZXbXpDvSrNZNQlZkYwh3oEKjGswIwdK3qoBMQLNob9VhiUcRCGiTVjBoHs1pi/KihU/m5CN/wo9SkYs6O/vacAgmGs0GZiukeoeGv3XoNMMaTNxMnsFbd/D29grcOsjUNNYs4M2hXznkFznApTb9IHhlG90uf0AV5ZNBv7wGRmXh7B8Wq6WAC6AAAAAElFTkSuQmCC"],["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPFJREFUWEftl+EKhTAIhefe/5ndZcFiDM2jjaiL/Sko7dvRHYuIqJWXHJQwSiW2KMOtlUp0u9gJo0n4H8o0ZrVHqNZQ/7iVuYJYCbxQMIwHIgoFwdwBGWCISt+C2aEKqo6pzGtgdoIg6lwqkzCzL/QJfEo6XYcsVQhqy3Sfp/1lmZi5VMDa0U8IK1/ChD8hLGl7YqRMSB7T9JAkj8EcKzca2YKx4s/di/yqWMkehRnq9LO01TWYvggtRmpis2fWIOkFK4wXwlUmaRXjhce97qqTWyNGuUUZESx/4hTrtHYTOmTdDYwmjjyXMOFBGZE7GvMDi6qyam6O39AAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAANlJREFUWEftl9EOgzAIRaX//83FsKwLNkVuO5cwxSdjjT09tIBERLwFuShhjEhcYqYyb4Xo62AnjKXwHma41sMCdX4opSztn2kzPUSblRRAfYPOQsEwFsQIpj2bhYJgPBCZXJvpYyRQiKX/gkGseGZkHLHjmgkDg4IgZhA7p2YSRh9FqcCf3KHuvZTKi1VbV/sM01LVDrWBZQUo0Fk5QI71Kz14DXkoGNTO8wpl2/leuEZmftLP6KMYotPrc0OIHniUsPInzkrjocx4FR0ddzMw+qEr3ksYy+IOAd2yaqrSqYMAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAPRJREFUWEftlusOgzAIhaXv/8xlYUknMZZzsM3iXP1lItKPw60iIrrd5JEF08nEFGWq6lZEhpO9YHoSPkOZWuseoNWL7hOilHKpftLKNAh/4LGAz2wYOhomOqDXTVkoCsacRtKj1kb/N9V+C4aJCiljkTN+oDKMk6/AMCDvqMl1gPyFyqCfW+H9B4xF+Wk1984MLcZGD9vdb/swTepHPnMSYSPBqlgwl68QM1MVpcgA4dC7FYwRzwBCqlDK3A5mFIhRhVbGV38mZSxE6j5z1ooRVBZiGMYDsosSDWjY2shB5gqBfD0PBkXMfp+iDHsYslswPYVeEmqyaphsodgAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAANhJREFUWEftl9EOgCAIRcP//2ZptNmY07hYD1T01Jbp8aCgRES8BXkoYSaReMRMZd4K0e1gJ8xM4TfM1FrPCfarhUpZWj9uMw2iqAFZgWkKLxQMM4JoA89g2ncUCoIREG2ij4EFI+0RoHfBWFZk1ogZxI5pJgwMAuIxY9m5NJMweqtKBfY+5PiHu+quq32Gaalqh1rAMgME6H9Jr8XWsoOY+V6h1HbkfXSUsMwgVo5S4b3EhTjp9bkhxBl4lLDyEjdL46HMeKv8Um16ahC0H/fWRjteaRcKZgc3GrBqJCUxzAAAAABJRU5ErkJggg=="]]),l=V.ref(""),c=[[1,1,Math.PI/2],[2,1,Math.PI/2],[3,1,Math.PI/2],[4,1,Math.PI/2],[1,2,Math.PI/2],[2,2,Math.PI/2],[1,1,Math.PI/4],[2,1,Math.PI/4],[3,1,Math.PI/4],[4,1,Math.PI/4],[1,2,Math.PI/4],[2,2,Math.PI/4],[1,1,Math.PI],[2,1,Math.PI],[3,1,Math.PI],[4,1,Math.PI]],h=(f,r)=>{const v=c[f*4+r];l.value=`${f}${r}`,t("receiveParameters",{param:v})};return V.onMounted(()=>{fs.value=250}),(f,r)=>(V.openBlock(),V.createElementBlock("div",hT,[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(i,(v,_)=>(V.openBlock(),V.createElementBlock("div",{class:"row",key:_},[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(v,(w,b)=>(V.openBlock(),V.createElementBlock("div",{class:V.normalizeClass(l.value===`${_}${b}`?"item backColor":"item"),key:b,onClick:E=>h(_,b)},[V.createElementVNode("img",{src:w,style:{margin:"0",height:"35px",width:"35px"}},null,8,pT)],10,dT))),128))]))),128))]))}}),fz="",mT=ms(fT,[["__scopeId","data-v-fff1a9fd"],["__file","RoundMarkDialog.vue"]]),Xy=e=>(V.pushScopeId("data-v-41b1580f"),e=e(),V.popScopeId(),e),gT={class:"fcb"},yT={class:"symbolBox"},xT={class:"symbol"},vT=["onClick"],_T=["src"],bT={class:"formBox"},wT={class:"iconFont"},AT={key:0,class:"icon","aria-hidden":"true"},MT=[Xy(()=>V.createElementVNode("use",{"xlink:href":"#icon-a-1"},null,-1))],ST={key:1,class:"icon","aria-hidden":"true"},TT=[Xy(()=>V.createElementVNode("use",{"xlink:href":"#icon-a-2"},null,-1))],ET={class:"topData"},PT={class:"fcb inLine"},CT={style:{width:"80%"}},RT=Xy(()=>V.createElementVNode("div",{class:"line"},null,-1)),DT={class:"bottomData"},IT={class:"cornerData"},LT={key:0,class:"btnList"},FT={class:"leftDate"},kT=V.defineComponent({__name:"RoughnessDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=V.reactive({textLeftStr:"",rougCornerType:"无",isRoungSameRequire:!1,isShowMostSymbols:!1,textUpStr:[""],textDownStr:[""],isAddLongLine:!1,selectSymbolNum:0}),l=V.ref();let c="";const h=V.ref(!1),f=["=","⊥","X","M","C","R","P","无"];let r=new Fa,v=new R.McDbWipeout,_=new R.McGePoint3d;const w=V.reactive(["其余","全部","下料切边"]);V.onMounted(()=>{c=MxPluginContext.useTheme().isDark.value?"dark":"light",fs.value=450,Bo.value?r=Bo.value.clone():r=new Fa,E();const{wipeout:I,midPt:F}=Yy();v=I,_=F.clone()}),V.onBeforeUnmount(()=>{v.erase(),Bo.value=null});let b=null;V.watch(()=>i,(I,F)=>{I&&(i.isRoungSameRequire&&(i.isAddLongLine=!0),b&&clearTimeout(b),b=setTimeout(()=>{P()},300))},{deep:!0});const E=()=>{i.textLeftStr=r.textLeftStr,i.rougCornerType=r.rougCornerType?r.rougCornerType:"无",i.isRoungSameRequire=r.isRoungSameRequire,i.isShowMostSymbols=r.isShowMostSymbols,i.textUpStr=r.textUpStr,i.textDownStr=r.textDownStr,i.isAddLongLine=r.isAddRougLongLine,i.selectSymbolNum=r.rougMarkType},P=()=>Pn(this,null,function*(){var fe,Le;const I=R.MxCpp.getCurrentMxCAD(),F=new Fa;F.setPos(_),F.rougMarkType=i.selectSymbolNum,F.textLeftStr=i.textLeftStr,F.rougCornerType=i.rougCornerType==="无"?"":i.rougCornerType,F.isRoungSameRequire=i.isRoungSameRequire,F.isShowMostSymbols=i.isShowMostSymbols;const B=(fe=i==null?void 0:i.textUpStr)==null?void 0:fe.filter(Xe=>Xe!="");F.textUpStr=(Le=JSON.parse(JSON.stringify(B)))==null?void 0:Le.reverse(),F.textDownStr=i.textDownStr.filter(Xe=>Xe!=""),F.isAddRougLongLine=i.isAddLongLine;const O=I.drawEntity(F),{minPt:W,maxPt:Z}=F.getBoundingBox(),ie=Z.sub(W).normalize().mult(2);W.addvec(ie.clone().negate()),Z.addvec(ie);let $=(Z.x-W.x)*5,oe=150/230*$;const be=yield Af({type:"image/bmp",width:$,height:oe,range_pt1:W.toVector3(),range_pt2:Z.toVector3()});l.value.src=be,I.mxdraw.updateCanvasSize(),O.erase(),t("receiveParameters",{roughnessData:i})});return(I,F)=>(V.openBlock(),V.createElementBlock("div",null,[V.createElementVNode("div",gT,[V.createElementVNode("img",{ref_key:"img",ref:l,style:{margin:"10px 0px",width:"55%"}},null,512),V.createElementVNode("div",yT,[V.createElementVNode("span",xT,V.toDisplayString(V.unref(at)("基本符号")),1),(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(V.unref(rT),(B,O)=>(V.openBlock(),V.createElementBlock("div",{class:V.normalizeClass(i.selectSymbolNum===O?"symbolImg backColor":"symbolImg"),key:O,onClick:()=>i.selectSymbolNum=O},[V.createElementVNode("img",{src:B,style:{width:"25px",height:"25px"}},null,8,_T)],10,vT))),128))])]),V.createElementVNode("div",bT,[V.createElementVNode("div",wT,[V.unref(c)==="dark"?(V.openBlock(),V.createElementBlock("svg",AT,MT)):V.unref(c)==="light"?(V.openBlock(),V.createElementBlock("svg",ST,TT)):V.createCommentVNode("",!0)]),V.createElementVNode("div",ET,[V.createElementVNode("div",PT,[V.createVNode(V.unref(tn.VCheckbox),{label:`${V.unref(at)("相同要求")}`,modelValue:i.isRoungSameRequire,"onUpdate:modelValue":F[0]||(F[0]=B=>i.isRoungSameRequire=B)},null,8,["label","modelValue"]),V.createVNode(V.unref(tn.VCheckbox),{label:`${V.unref(at)("多数符号")}`,modelValue:i.isShowMostSymbols,"onUpdate:modelValue":F[1]||(F[1]=B=>i.isShowMostSymbols=B)},null,8,["label","modelValue"])]),V.createElementVNode("div",CT,[V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.textUpStr[0],"onUpdate:modelValue":F[2]||(F[2]=B=>i.textUpStr[0]=B)},null,8,["modelValue"]),V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",disabled:i.textUpStr.filter(B=>B!="").length==0,modelValue:i.textUpStr[1],"onUpdate:modelValue":F[3]||(F[3]=B=>i.textUpStr[1]=B)},null,8,["disabled","modelValue"])])]),RT,V.createElementVNode("div",DT,[V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.textDownStr[0],"onUpdate:modelValue":F[4]||(F[4]=B=>i.textDownStr[0]=B)},null,8,["modelValue"]),V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.textDownStr[1],"onUpdate:modelValue":F[5]||(F[5]=B=>i.textDownStr[1]=B),disabled:i.textDownStr.filter(B=>B!="").length<1},null,8,["modelValue","disabled"]),V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.textDownStr[2],"onUpdate:modelValue":F[6]||(F[6]=B=>i.textDownStr[2]=B),disabled:i.textDownStr.filter(B=>B!="").length<2},null,8,["modelValue","disabled"])]),V.createElementVNode("div",IT,[V.createVNode(V.unref(tn.VBtn),{class:"cornerIcon",onClick:F[7]||(F[7]=()=>h.value=!h.value)},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(i.rougCornerType),1)]),_:1}),h.value?(V.openBlock(),V.createElementBlock("div",LT,[(V.openBlock(),V.createElementBlock(V.Fragment,null,V.renderList(f,(B,O)=>V.createVNode(V.unref(tn.VBtn),{class:"cornerIcon",key:O,onClick:W=>i.rougCornerType=B},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(B),1)]),_:2},1032,["onClick"])),64))])):V.createCommentVNode("",!0)]),V.createElementVNode("div",FT,[V.createVNode(V.unref(tn.VCheckbox),{label:`${V.unref(at)("长边加横线")}`,modelValue:i.isAddLongLine,"onUpdate:modelValue":F[8]||(F[8]=B=>i.isAddLongLine=B),disabled:i.isRoungSameRequire},null,8,["label","modelValue","disabled"]),V.createVNode(V.unref(tn.VCombobox),{class:"mt-1 mr-2","return-object":"",items:w,modelValue:i.textLeftStr,"onUpdate:modelValue":F[9]||(F[9]=B=>i.textLeftStr=B)},null,8,["items","modelValue"])])])]))}}),yz="",BT=ms(kT,[["__scopeId","data-v-41b1580f"],["__file","RoughnessDialog.vue"]]),zT={style:{margin:"10px 0px"}},UT={class:"imgBox"},NT=["src"],VT={style:{width:"200px"}},OT={style:{display:"flex"}},GT={style:{width:"25%"}},jT=V.defineComponent({__name:"WeldSymbolDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=V.reactive({symbolType:0,width:10});V.watch(()=>i,(c,h)=>{c&&t("receiveParameters",rf({},i))},{deep:!0});const l=[{value:0,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAABNCAYAAADuHgybAAAAAXNSR0IArs4c6QAABdZJREFUeF7tnWGPEzAMQ7f//6MPDYQQHLCmTWI39+5zm9bPrjcOIZ6Px+PjwQ8EIAABCLQReFK8baw5CAIQgMB3AhQvQYAABCDQTIDibQbOcRCAAAQoXjIAAQhAoJkAxdsMnOMgAAEIULxkAAIQgEAzAYq3GTjHQQACEKB4yUCIwMfH4/F8pYYfCEBgm4CseCc/4MnaXkmbrA9t210i3Xibb7Li5QFLc3p8+G1BjwhGW4SWz9qbfJMWL+XrE9qdm9wU9Kg+tEWJeay/xTd58VK+HoHdvcUtQd/Rh7Ydavo9N/hmUbyUrz6sJze4Iei7+tC2S067z903m+KlfLVBPTndPeQn2sjlKT3dfudcWhUvIdeF9PRk55Cj7f8E8O40IfH9FG+c2dEOQn6ET7YZ32Tojw929M6uePnWe5wz6QDHkGcBQVsWyd45jr5ZFi/l2xvMzNMcQ46+NQKTvXPTRvGuZTJ9lVsQMgWiLZNm36zJvrl9mbMtXjdQ2fGfHPLJ2shl9kvom+eUS4q3z/dPJzkFIRsD2rKJ9syb7JvTh6Z18TqBqoj95JBP1kYuK15Dz0yXXFK8PX7/8xSXIFRgQFsF1fqZk31z+dC0L14XUFVxnxzyydrIZdWLqJ/rkEuKt97ntyc4BOHtJTcXoG0TnHgbvtUacEXx8u2iNgSV03nAlXRrZ+NdHV+Kt47t8mQCvozKbiHe2VmydCG1bxTvkk21i9QhqFXHfxVUzbdq/uRcqrVRvFWpDc5VByF43dBytIVw2Sye7Jv615fXFK8aVPVrmBxytFWnp24+3tWwpXhruIanEvAwMpsNeGdjRegiSt8o3pBVdYuVIahT9WvyZH1o60hQ/hlK3yjefD+3JipDsHXh4KbJ+tAWDIPJcqVvFC8haCGgDHm1QLRVE66Zr/SN4q3xdGuqMghbFw5sQlsAltFSfKsxg+Kt4bo1lZBvYZNvwje5BdsXUHlH8W5blr9RFYJ8JZ8noq2Dcv4Zk3170VLpu6p4f4J6PD7yE2Yx8To7AtTQFoBltnS2d8+XvOafq4iqPp26PJmsD21dKco9Z7JvfONdzAohWARluGyyd2gzDNzilVTe8Y130aCOZaoQoO2MAL6d8VPtVvpG8apc/+NcZQg6EEzWh7aOBOWfofSN4s33c2uiMgRbFw5umqwPbcEwmCxX+kbxEoIWAsqQVwtEWzXhmvlK3yjeGk/DU5UhCF82uGGyNuXfjAdt2Fo+2TulNop3K475m5QhyFfz+0S0VROum493NWyvKd7JAeBbU024O6ZOzuVkbeo3R/F2vM43ZxBwAxM2rzDZO7RthmJhG8W7AKl6CQGvJlw3H+/q2FZOVvtG8Va6uzhbHYLFa24tQ9sWNotNeFdnwxXFOzkA6t811UXrx+TJ3qGtOj018x18o3hrvF2e6hCC5csGF07WxodKMAxGyx1yaV+8DpAqMzNZH9oqk1M3e7JvLh+YFG9dft9OnhzwydpcHu/bgG0umOydizbr4nWBtJnft9sm60PbW/stF0z2zekDk+IVxX9ywCdrc3q8FdGd7J2TNtvidYJEwGMEJnuHtlgWnFY7eUfxCpLhFIBs+ZO18W03Oy1989xyaVm8bpAy4zFZG8WUmZTeWZNz6ajNrngdIWU+gcn60JaZlL5Zk31z/TJA8fblm3/F1cg68yiKKZNm7yxX76yK1xVSRlTQlkFRMwPvNNxPT3X2zaZ4nSFNDsCpNtc/ymXoQlsWxf457n1iUbzukE5iM1kbxXSSDO3eybm8QZu8eG+AtPtEJmujdHdTod83OZe3aJMW7y2Qdp7KZG2U7k4iPPZMzuVN2mTFexOk6JOZrI3SjabBZ/3kXN6mTVK8t0HyeTr6m0z2Dm36fH2VG0iK96vARScEIACBvxGgeMkFBCAAgWYCFG8zcI6DAAQgQPGSAQhAAALNBCjeZuAcBwEIQIDiJQMQgAAEmglQvM3AOQ4CEIAAxUsGIAABCDQT+AY4fBYu1nCUKgAAAABJRU5ErkJggg==",name:at("单边V型对接焊缝（前视图）"),style:"height:45%;width:100%"},{value:1,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV4AAABGCAYAAACE2fxYAAAAAXNSR0IArs4c6QAABWpJREFUeF7tnNuS2zgQQ+X//2in5ClXJXkYs6m+QPDxM9kkDiBY42zt4ziO58EHAhCAAATaCDwo3jbWHAQBCEDgRYDiJQgQgAAEmglQvM3AOQ4CEIAAxUsGIAABCDQToHibgXMcBCAAgdHifT6P43HewPCDtvuZenr2+ocPw0ySR608jhbviYJAaAVi9Tb4tkpKZx2e6XgxXryUr04YojfhQY4Sm1+PZ/MevP6qUvnveAmERiCit8C3KLH59Xg274FM8fLmOx+G3RvwIO+Sm9uHZ3Pspd543xgIxGwgdk939c1VFy86u0nP2Sf1xkv55pg6MYWCmqB+/Ux8u85wZ4Jk8Tp/GxP0nZjO78G3eQ+iN1D2jOKNupmwXjkQV+Wh7SrB/v141s9ctnid33rR1h/0jBMpqAyK/TMUfZMuXgqqP6QZJyoGPUMXecyi2DtHMY8Ub28G/jlNMRBZOFy1ueriSyUr+Wtz5IvXORA8xGshVVuFb2qOfL6PmmcU72fPSleoBSJTrKs2V13OLzlq2m5RvGrQKKc1AhTUGie1Va6+KemieAVSrxSIbByu2lx1Ob/kKGm7TfEqQaOc1glQUOusVFbiWb0TFG8946UTXMPuqsv5RcBZm0oeKd6lWqxfpBKICqWu2lx1ORevijaKt6JpNmbyEG9AG96CZ8MGbB6v4Nutilfl22rT71+3KYShQpezZ87ayGPV0/Azl+Kt5Rua7hp2V13OxeusTSGPFG+oGmsXKwSiSqGrNlddzsWroI3irWqajbk8xBvQhrfg2bABm8dP+0bxbhpXsW06DBWa3jNdtbnqUngrdM4jxVvpbnA2D3EQmMhyV99cdSl8qdyueBWgVT3vBL2KbO1cV99cdSl0CMVb+0yGphP0EC6Zxa6+ueqieDcfHddAuOpSCPpm1Ja24dsSJqlF057xxisUh+kwVKJAWyXdutmuvk3ronjrMhuePB2G8IUDG9AWgCWyFM/qjKB469iGJxP0MDKJDa6+uepS+OnrdsVLGCS6JnwJfAsjG9+AZ3UWULx1bMOTCXoY2fgGPBu3YOsC075RvFu21WyaDkONqp+prtpcdTl7pqCN4q1sm+BsHuIgMIHleCZgwsYVpn2jeDdMq9oyHQZ0xQm4eqbwVhh3Y22HgmcU75pX5asUwlAlEm1VZOvm4lkd23PyrYqXMNSGoWq6q2+uupzfdlW0UbxVbROcy0McBCawHM8ETNi4goJvFO+GcRVbFMKArhgBV89U3gpjbqytVvGM4l3zq3SVShgqRKKtgmrtTDyr5Xur33gJQ30YKk5w9c1Vl/PbrpK227zxugbdVZdSyPlCiRFwzaSSrlsUrxKwWIQ/r0bbZ0ZqK/BMzZG1+yj5RvGueVaySikI2QLRlk20Z56rb2q65ItXDVhm/NGWSbNnFp71cM4+Rc03ijfb4cA8tTAErv7rUldd/G6dlZDeOYp5lC5eRWBZkUFbFsm+OXjWxzrzJEXfZItXEVZWGNCWRbJ3jqtvrrqU/0KheHufXdv/L61yyDMsppwyKPbOUPZMsniVgV2Njqs2V118oVxN/Nx+5UzKFa8yrKsRQttVgv378ayfecaJ6r5JFa86rCuBQNsVenN7XX1z1XWXv1BkipcgzJXLlZPx7Qq9mb14NsP971MlipcgzAdh5wb4tkNtdg+ezfJ/nz5evARBIwjRW+BblNj8ejyb90CieAmCThAiN3H17dR1fh7n64jZx9Wzu/ym+3+cRt94n++km4UcORCAQB+Bxw2/KUeLt88aToIABCCgQ4Di1fGCm0AAAl9CgOL9EqORCQEI6BCgeHW84CYQgMCXEKB4v8RoZEIAAjoE/gALvAEuttoMygAAAABJRU5ErkJggg==",name:at("角焊缝（前视图）"),style:"height:45%;width:100%"},{value:2,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAABICAYAAAC6L9h5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFjSURBVHhe7drRioMwFEXROP//z7aB7odhrHNaTXJvcjaIj+oiRAJ3K6Xsz8ud9PO6u2f7frxejCRkJCEjCRlJyEhCRhIykpCRhIwkZCQhIwkZSchIr94dbmvLI1WcM6DaskgKDi2H9AkOLYP0DQ5Nj3QFh6ZFugOHpkO6E4emQWqBQ+mRWuJQWqQeOJQOqScOpUEagUPhkUbiUFikCDgUDikSDoVBiohDw5Ei49AwpAw41B0pEw51Q8qIQ82RMuPQn5nJ7B90tW2rJL/rNliaBf8IqdueVB9+9AIZ6v53y4jVHYkyYQ1DogxYw5EoMlYYJIqIFQ6JImGFRaIIWOGRaCRWGiQagZUOiXpipUWiHljpkagl1jRI1AJrOiS6E2taJLoDa3okuoK1DBJ9g7UcEn2CtSwSKVjLI9EZlJGEjCRkJCEjCRlJyEhCRhIykpCRhIwkZCShemBZe7RNyCvp30p5AJPejoCkZsQmAAAAAElFTkSuQmCC",name:at("单边V型对接焊缝（侧视图）"),style:"height:90%;width:50%"},{value:3,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAACVCAYAAAAUoxXNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALmSURBVHhe7d3djtowFIVR6Pu/Mx3a6c8MAbIhiY/ttaQj31qWPsm+8vl0Ol0+hk+Xy+V0Pl+PBW79+FyBFQQDAcFAQDAQEAwEBAMBwUBAMBAQDAQEAwHBQEAwEBAMBAQDAcFAQDAQEAwEBAMBwUBAMBAQDAQEAwHBQEAwEBAMBAQDAcFAQDAQEAwEBAMBwUBAMBAQDAQEAwHBLLh+2wdLBHOHaFgimAdEw3eCeUI0/E8wK4iGPwSzkmi4EkxANAgmJJq5CeYFopmXYF4kmjkJ5g2imY9g3iSauQhmA6KZh2A2Ipo5CGZDohmfYDYmmrEJZgeiGZdgdiKaMQlmR6IZj2B2JpqxCOYAohmHYA4imjEI5kCi6Z9gDiaavgmmAdH0SzCNiKZPgmlINP0RTGOi6YtgChBNPwRThGj6IJhCRFOfYIoRTW2CKUg0dQmmKNHUJJjCRFOPYIoTTS2C6YBo6hBMJ0RTg2A6Ipr2BNMZ0bQlmA6Jph3BdEo0bQimY6I5nmA6J5pjCWYAojmOYAYhmmMIZiCi2Z9gBiOafQlmQKLZj2AGJZp9CGZgotmeYAYnmm0JZgKi2Y5gJiGabQhmIqJ5n2AmI5r3CGZConmdYCYlmtcIZmKiyQlmcqLJCAbRBATDL6JZRzD8JZrnBMMXonlMMNwQzX2CYZFolgmGu0RzSzA8JJqvBMNTovlHMKwimt8Ew2qiEQyh2aMRDLGZoxEML5k1GsHwshmjEQxvmS0awfC2maIRDJuYJRrBsJkZohEMmxo9GsGwuZGjEQy7GDUawbCbEaMRDLsaLRrBsLuRohEMhxglGsFwmBGiEQyH6j0awXC4nqMRDE30Go1gaKbHaARDU71FIxia6ykawVBCL9EIhjJ6iEYwlFI9GsFQTuVoBENJVaMRDGVVjEYwlFYtmvPH3Oyo+sMLWlkMBljmSgYBwUBAMBAQDAQEAwHBQEAwEBAMBAQDAcFAQDAQEAysdjr9BLIwNQWJI4hAAAAAAElFTkSuQmCC",name:at("角焊缝（侧视图）"),style:"height:90%;width:60%"}];return V.onMounted(()=>{fs.value=350,t("receiveParameters",{formData:i})}),(c,h)=>(V.openBlock(),V.createElementBlock("div",null,[V.createElementVNode("p",zT,V.toDisplayString(V.unref(at)("选择要在几何图形上放置的焊缝符号"))+"： ",1),V.createVNode(V.unref(tn.VRadioGroup),{modelValue:i.symbolType,"onUpdate:modelValue":h[0]||(h[0]=f=>i.symbolType=f)},{default:V.withCtx(()=>[(V.openBlock(),V.createElementBlock(V.Fragment,null,V.renderList(l,(f,r)=>V.createElementVNode("div",{key:r,class:"radio"},[V.createElementVNode("div",UT,[V.createElementVNode("img",{src:f.image,class:"img",style:V.normalizeStyle(f.style)},null,12,NT)]),V.createElementVNode("div",VT,[V.createVNode(V.unref(tn.VRadio),{label:f.name,value:f.value},null,8,["label","value"])])])),64))]),_:1},8,["modelValue"]),V.createElementVNode("div",OT,[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("焊角宽度：")),1),V.createElementVNode("div",GT,[V.createVNode(V.unref(tn.VTextField),{type:"number",modelValue:i.width,"onUpdate:modelValue":h[1]||(h[1]=f=>i.width=f)},null,8,["modelValue"])])])]))}}),xz="",HT=ms(jT,[["__scopeId","data-v-a986481d"],["__file","WeldSymbolDialog.vue"]]),m1=e=>(V.pushScopeId("data-v-ef8817ed"),e=e(),V.popScopeId(),e),WT={class:"fbc",style:{"margin-top":"10px"}},qT={style:{width:"60%",height:"140px"}},YT=m1(()=>V.createElementVNode("div",{style:{width:"35%",height:"140px"}},[V.createElementVNode("img",{style:{width:"100%",height:"100%"},src:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAArYAAAGzCAYAAADaJlTCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AACWLSURBVHhe7dbbroXYkQXR/v+fdhuXsThrR3Jdt4QIaTx0MmGfKkt2/9+/+5ckSZL0AniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUlSRdvouaQq8ChJSmyNno1WRpu3oWgn6TE8SpKSKqPNSGW0uWONno1G0U7SY3iUJCVF0W4UinZXlNFmJIp2kh7DoyQpqSjajkDRbutO9J2Rymgj6TE8SpISo2g3Qq/ot0eiaCfpETxKkhKLou0IPaLfHYminaRH8ChJSiyKtiO0jn5zNIp2kh7BoyQpsSjajlAr+lb5W7OgaCfpETxKkhKjaDfK2ejdLYp2M6BoJ+kRPEqSEqNoNwpFuyMU7WZA0U7SI3iUJCVG0W4UinZHKNrNgKKdpEfwKElKjKLdKBTtjlC0mwFFO0mP4FGSlBhFu1Eo2h2haDcDinaSHsGjJCkxinajULQ7QtFuBhTtJD2CR0lSYhTtRqFod6SMNrOgzu7WaC/pDzxKkhKjaDcKRbs9FO1mUSv6tqT/waMkKTGKdqNQtNu6Er3fWq/otyX9Dx4lSYlRtBuldfSbd80W/Y2S/gePkqTEKNqRbfS8htbRbx7JEP3dkv7AoyQpMerMJqp896nW0W/umSX62yRdgkdJUmK1o994onb0G1e0LvqN8u+Q9BgeJUmJ1Y5+44mz0bstPIm+RyjaSXoEj5KkxGpG33/iSvR+K2W0WZTRhlC0k/QIHiVJiT2JvlcTFd2XyvdHo2hXomgn6RE8SpIS24v2PVF7z5a2748WRdstinaSHsGjJCkxinYjlO09W9tuZkDRbouinaRH8ChJSoyiXW/Umc1SuRspirYrinaSHsGjJCkxina9UWd3S7QdhaLdiqKdpEfwKElKjKJdbxTtFlG0HSGKtguKdpIewaMkKTGKdr1RtFtE0XYUinYLinaSHsGjJCkxinY9UbTbiqLtCBTtFhTtJD2CR0lSYhTteqJoV4qi7QhltFlQtJP0CB4lSYlRtOuJoh2Jom1vZbRZULST9AgeJUmJUbTrhaJdJIq2vZXRZkHRTtIjeJQkJUbRrheKdnuiaNvbGj1bUbST9AgeJUmJUbTrhaLdkSjazoainaRH8ChJSoyiXQ8U7c6Kou1MKNpJegSPkqTEKNq1FkXbs6JoOxOKdpIewaMkKTGKdi1F0faqKNrOgqKdpEfwKElKjKJdSxTt7oqibQ9lR8+Xyo2kx/AoSUqMol0rUbR9Ioq2rVFXnkuqAo+SpMTKaHPHGj1bRdG2hrvRt57YK3pefkPSY3iUJCVWRpvSnc5+o9zV9CT63l13ou9IegSPkqQERnf2b9nuWngSfe+JK9H7kh7BoyRpgIwd/d3lP2Mrd6NvPXU2elfSI3iUJHWUtaO/vfznbO1q9I1azkTvSXoEj5KkjrJ15u/e/vP1tEbPetuL9pIew6MkqaPe0d9wRxRtvyqKtpIew6MkqbMz0XsjUbT7Oop2kh7DoyRJp2yj5/pHGW0kPYZHSZJUmf8PrdQcHiVJkqRs8ChJ+rdt9FySWtlGz4XwKEk/ttHzNyqjjaS2ymjzNhTt9AOPkiaxjZ73QtHuqm30fLQy2rxNGW1IGW1aKaONrlujZz2V0eaONXo2GkU7/cCjpEmU0aYHinZXULQbiaLdm1C0K5XRphWKdke20fMvKaNNLxTtriijzUgU7fQDj5ImQNGuhyjalq5E749E0e5NKNqVymjTCkW7PRTtvoKiXQ8U7ciV6P2RKNrpDzxKmgBFu16o6P6k8ndHomj3JhTtSmW0aYU6szmq/MaXlNGmF2rv2d22vzkDinb6A4+SJkDRrpde0W+PQtHuLSjakTLatNQq+q23o2jXU4/od0eiaKc/8ChpAhTtemod/eZIFO3egqJdiaJdSy2i3/kCinY9tY5+czSKdvoDj5IGo2jXW8vo90ajaPcGUbQtUbTb2kbPr2oR/c4XULTrqXX0m6NRtNMfeJQ0GEW73q5E768o2o1G0e4NqDMb6uk7dzyJ3i+//yUU7Xq6Gn1jVUabGVC00x94lDQYRbveKNodoWg3GkW77GaI/q4rKNpFymjzFWW0GaGMNmeU0WYGFO30Bx4lDUbRrjeKdkco2o1G0S6zWaK/7QqKdoSi3RdQtBuhjDZHKNrNgKKd/sCjpIEo2o1A0e5IGW1mQNEusxmiv+sqinaEot0XULQboYw2RyjazYCinf7Ao6SBKNqVjqJ3rqJod6SMNjOgaJfVqOhveYqiHaFo9wUU7Up70f6OMtocoWg3A4p2+gOPkgZqFf3WVRTt9lC0mwFFu6yu9OTdpfL92ijalY6id96qZfR7V5XR5ghFuxlQtNMfeJTUwYjo77iCot0einYzoGi32Iv2o1FnnkXPl/aeLW2/UVvL6Pey6x39DVdQtDtC0W4GFO0WUbR9OTxKemjG6O+8qow2RyjazaBm9P1RovaeH71/9Hxtu6upZfR7M5sx+juvoGh3pIw2s6gVffvF8CjpgRmjv/OOMtqQM9F7vfSIfneEqKPNlfev7GppFf3WzGaM/s6rKNqVzkbv9tI6+s0Xw6OkB3pHf0MrZXR7Uvl7T80U/X297XV2R115d7utqUX0O7PrGf1+K62j33xqluhvezE8SnqgZvT9UXpEv7snS/S397bX2R21fffM++W+livR+2et0bMZ1Iq+PVLr6DePZIj+7pfDo6SH9jq7p91IraPf3DNb9DfOJOrsjirfpfdp0wJFu6vORO+NFEXbBUW7kVpHv7lnpujv+zA8SuooirYjtYp+64xR0d+SAXV2E1W+T1vatEDRbqtm9P0MKNqN1iL6nbNGRX+L/sCjpI4o2o12NfpGTTWi75bKaJPFtr1n26Jn5furMtq0MjL6ezKgaDfa1egbNT2NvlmiaKc/8CipkyjajnYler+FqDO7chMpo012e9FueyuV0WaxjZ6vMkR/dwYU7Ua7Er3fStSZXbkhFO30Bx4ldULRbgZXovdHomhHymiT2V60P/Kkmt/qUfn3ZhJF29Go6L5Uvj8aRbsSRTv9gUdJHUTRdjRq79nS9v0ZULQrldEmsyjakpq1/PbVyr/lbSjazYDae7a0fX+0KNpuUbTTH3iU1AFFuyMU7Z6gjp4vbTejRdF2q4w2We11ZlO77d/W8rfL3ylto+fZRdF2TxRtn6D2ni1t358BRbstinb6A4+SGoui7daV6P27qDObpXI3EkW7rTLaZDNj9Hcuzra3337vCEW7zCjala5E799VdvR8rdyNFEXbFUU7/YFHSY1Re8/utP29p6gzm6VyN1IUbVdltMlkluhvq4Gi3eJs9G5WUUfPr7b9zSeos7sl2o5C0W5F0U5/4FFSQ72i376rjDaLKNqOQtFuVUabLEZEf0crLaPfy6hX9Nt3ULRbRNF2hCjaLija6Q88SmqkZ/T7d1C0W0XRdgSKdqsy2mRwtaN3yu+vymjTQuvoN7PpFf32XRTtFlG0HYWi3YKinf7Ao6RGWkW/VQtFu60o2o5A0W5RRpuZHRVtznyn3NCONi20jH4vm1bRb9VE0W4VRdsRKNotKNrpDzxKaqBW9O2WKNptRdF2BIp2izLazOqovd32O2c3V3a1tYp+K5ua0fdboWhXiqLtCNSTnf7Ao6TKorbPt/utMtq0QtGORNG2N4p2izLazGqvo932+ZUdVW5auBK9v6Bolw1VPt/+39t7Ge1aoWhHomjbG/Vkpz/wKKmiKNqSMtq0QtEuEkXb3sposyijzayo1juq3LRA0S5C0S6bKNqWKNq1QtEuQtGutzLaLCja6Q88SqokiraRMtq0QtFuTxRte1ujZ6sy2sxsGz1fULRblB09Xyo3rWyj53so2mUSRVtC0a4FinZ7omjb2xo9W1G00x94lFTBXrSPlNGmBYp2R6JoO6My2mRH0W5RdvR8qdzMiKJdFlG0jVC0a4Gi3ZEo2s6Gop3+wKOkh/ai/Z4y2tQWRdszomg7mzLaZEfRblF29Hyp3MyGol0We9E+QtGuNop2Z0XRdiYU7fQHHiU9sBftj5TRpjaKdldE0XYmZbTJjqLdouzo+VK5aa2MNlsU7TLYi/Z7KNrVFEXbKyjazYSinf7Ao6Sb9qL9GWW0qSmKtldF0XYWZbTJjqLdam3v2TbatUTRbhFF29ntRfsjFO1qomh3VRRtZ0HRTn/gUdINe9H+rDLa1BJF2zv2on0PZVefvwFFuzMo2rUUdXZLu9ntRfszKNrVEkXbO6Jo20PZ0fOlcqMfeJR00V60v6KMNpE7+zLaPRFF29ai9jbbZ29B0a60Rrdt2+c97HVmt91ksBftz6JoF7myj6LtE1G0bY268lwIj5Iu2Iv2V1C0W5yJ3ltF0fapq9E3atgr2mzffwuKdltl0X1p+14vUUeb7fMM9qL9FdTZHUXvLqJoW8OV6P1a9oqel9/QDzxKOmkv2p/Vsiu/R9tankTfu2svel6+/wZltCldid7vIeroWRZ70f6sll35PdrW8CT63l13ou/oDzxKOinqyrZ3Z/+uctfC3ehbT1yJ3s+Mol3pSvR+D1ejb8yMOrsb1dm/rdzV9iT63hNXovf1Bx4lXVB29Hx0Z/627aalu9G3njobvZsZRTtyNnq3lyvR+zMrO7MZ2dm/rdy1cjf61lNno3f1Bx4lXbT3XzizdOXvKrct3Ym+U8OZ6L3MKNpFzkTv9XQmei+L6O+fqbN/13bXw9XoG7Wcid7TH3iUVFGr6LfO2ov2rUXRtrWj6J3MKNrtOYre6W0v2r9Fq+i3ztiL9j1QtOvhKHpHf+BRUmVnovdaiaLtF+1F++zKaHNkL9qPEEXbtzgbvdtCFG2/Koq2+oFHSS9H0e7LomibXRltzqBoNwpFO7VD0e7rKNrpBx4lvdw2eq5/lNHmDcpoc1YZbUbaRs/V3jZ6rn+U0UY/8ChJ+q81eiZJLa3RMyE8SpIkSdngUZIkScoGj5IkSVI2eJQ+60vRP78kSYnhUfqkL0b/Ht7gi9G/h+y+GP17eAPLG/3nOTE8Sp/01ejfRWZfjf5dZPfV6N9FdpY7+s90UniUPumL0b+H7L4a/bvI7qvRv4vM7B3Rf7YTwqP0SV+M/j28wRejfw/ZfTH69/AGljv6z3RSeJQkaRpfif7Z38TyRv95TgqPkiRJUjZ4lCRJkrLBoyRJkpQNHiVJkqRs8ChJkiRlg0dJkiQpGzxKkiRJ2eBRkiRJygaPkiRJUjZ4lCRJkrLBoyRJkpQNHiVJkqRs8Ch9kpmZmf1G/5s5KTxKn2NmZmZx9L+dE8Kj9ClmZmYWR//bOSk8Sp9iZmZmcfS/nZPCo/QZUbSVJElTw6P0CVG0lSRJ08Oj9HpRtJUkSSngUXq1KNpKkqQ08Ci9WhRtJUlSGniUXiuKtpIkKRU8Sq8URVtJkpQOHqXXiaKtJElKCY/Sq0TRVpIkpYVH6VWiaKvvWqNnktTbGj1TCI/Sa0TRVv/YRs/fqIw2ksbYRs/fqIw2QniUXiGKtjOY4W+jaHdHzW/VVkabr9hGzyPb6HlL2+i57pnh32cZbe6q/b1aKNoJ4VFKL4q2MyijTQ8U7a7aRs9Ho2j3dhTtSmW0aYWi3Rlr9OxLymjTC0W7K8poMxJFOyE8SqlF0XYGFO16oGi350z03kgU7d6Ool2Jol0LFO2OlNHmKyja9UDRbs+Z6L2RKNrpBx6l1KJoOwOKdr1QR8/vtP3maBTt3o6iXYmiXQsU7RZXove/gqJdD9SZzdXKb45G0U4/8CilFUXbWVC066VX9NujULR7O4p2JYp2rbSKfusLymjTU4/od0eiaKcfeJRSiqLtTMpo01OP6HdHomj3ZhTtSlG0baVV9FtvR9Gupx7R745E0U4/8CilE0XbmVC0661l9HujUbR7M4p2JYp2LbWIfucLKNr11Dr6zdEo2ukHHqVU9qL9TCja9Xans9+h3WgU7d6Kot1iW/l/r+29Q5X7q1pEv/MFFO16u9PZ79BuNIp2+oFHKZUo2s6Gol1vFO2OULQbjaLdG80Q/V1XHEXvbJXR5iso2vVG0e5IGW1mQNFOP/AopRFF2xlRtOuNot0RinajUbR7oxmiv+sKinaRMtp8AUW7Ecpoc0YZbWZA0U4/8CilEEXbGVG0G4Gi3ZEy2syAot3bzBL9bVdQtIuU0eYLKNqNUEabIxTtZkDRTj/wKE0virazomgXoWh3B0W7PRTtZkDR7k1GR3/TXRTtCEW7L6BoF6Fod0cZbY5QtJsBRTv9wKM0vSjazorae3a27W/cRdFuD0W7GVC0e5M73X13+7stULQje9H+zai9Z2fb/sZdZbQ5QtFuBhTt9AOP0tSiaDubHtHvXkXRbg9FuxlQtFtRtJtVVPTszPvRfa38Rk3U3rMrbX/njXpEv3tVGW2OULSbAUW7FUW7D8CjNK0o2vY0U/T3XVVGmyMU7WZARfe9yu/Oijrz7O7zte2uppbR72UwU/T3XUHR7ghFuxlQ0X2v8rsfgEdpSlG07WHG6O+8o4w2e/aifW8to9+bSdTe87PvXt3V0jL6vVnNGP2dV1G027MX7XtrFf3Wy+FRmk4UbXsZGf09tVBHz6+2/V5to6O/aRZRZzZRV97dbmtqFf3WzEZGf08t1NHzq22/V9vI6O95OTxK04mibS+1o98YoUf0u0cyRH/3LKLObPa68v52W9Pd6FuZ1Y5+Y4Qe0e8eyRD93S+HR2kqUbTt7UxH++3zGfSIfnfPjNHfOauos7uoo/e3t3JbE0W7q85E741ytqN3ts9n0Dr6zT2zRn/rB+FRmkYUbTOgaDdSy+j3joyK/pasqDObvcr36Ru0aYGiXeRp9M0Momg7Usvo946Miv4W/cCjNIUo2mZA0W60J9H3nqoZfX9B0S6zbUfP1/bupIw2rZRF9xZt/45MKNqNdjf6Vg01o+8vKNrpBx6l4aJom0EUbUc7G73bypmiXfktQtHuraLo+fa9UhltFmv0bCtL9LfPLoq2o52N3m3lqL3d9jsRinb6gUdpuCjaZkDRbgZldFsr3x2Nol2Jot0bRdH2SFl0p7bfOfvO6Mq/OROKdqNR0X2pfH80inYlinb6gUdpqCjaZhBF29GovWdL2/dHi6LtFkW7t4mi7Z4atfhmjcq/6w2iaDsatfdsafv+aFG03aJopx94lIaJom0WFO3O2EbPn6KuPJ8BRbstinZvsteVba16/2b5e1tr9OwNKNqdsY2eP0XtPVvavj8DinZbFO30A4/SEFG0zSKKtuRM9N5d1NHzpe1mtCjarijavcVRZza1K//GWn8DfXdPGW0yi6ItORO9dxd19HxpuxktirYrinb6gUepuyjaZkKd2Vyp/N4T1JnNUrkbiaLdiqLdG8wU/X1PULTbOoreyYw6s7lS+b0nys5s1mg7CkW7FUU7/cCj1F0UbbPoFf32XWW0WUTRdhSKdqsy2mQ3ou1vb/+WFlpFv5VRr+i376Bot4ii7QhRtF1QtNMPPEpdRdE2i57R799B0W4VRdsRKNqtymiTVavO/E65aaVl9HvZ9Ix+/w6Kdoso2o5C0W5B0U4/8Ch1E0XbTFpHv/kURbtVFG1HoWi3KKNNRnc6841yc2VXW+voNzNpHf1mDRTtVlG0HYGi3YKinX7gUeoiiraZ1Iq+3RJFu60o2o5A0W5RRpts9trbbL9xdnNlV1ur6LcyqhV9u6Uy2pSiaDsC9WSnH3iUmouibSZR9Ozo3fJ5SxTtSBRte6NotyijTSZ7He22z6/sqHLTwp3OfKPcZBRFz47e2z5vjaIdiaJtb9STnX7gUWouirZZRNGWlNGmFYp2kSja9kTRblFGm0yizuzKzdkdVW5aoGi3h6JdJlG0LVG0a4WiHYmibW/Uk51+4FFqKoq2mUTRlpTRphWKdpEo2va2jZ6vymiTzTZ6vqBot6CuPG9pGz3fQ9EukyjaEop2LUTRNhJF29620fMFRTv9wKPUTBRtM4mibaSMNi1QtDsSRdsZldHmjSjaLagrz2dF0S6LvWhPKNq1QNHuSBRtZ0PRTj/wKDURRdtMomi7p4w2LVC0OyOKtrMpo80bUbRbUFeez4iiXRZ70T5C0a62KNqeEUXbmVC00w88StVF0TaTKNruoWhXG0W7K6JoO5My2rwRRbtF2dHzpXLTWhlttijaZbAX7fdQtKuNot1ZUbSdCUU7/cCjVF0UbbOIou0RinY1RdH2iijazqSMNm9E0W61be/ZWrlpjaLdiqLd7Pai/RGKdjVF0faKKNrOgqKdfuBRqiqKthnsRfszKNrVEkXbO6Jo28u2o+dLtHkjinZnULRriaLdgqLd7Pai/RkU7WqJou0dUbTtZdves7VyI4RHqZoo2mawF+3PomhXSxRt74qibWvU0aZ8/lYU7c6gaNdS1Nkt7Wa2F+3PomhXQxRtn4iibWvUlecK4VGqIoq2GexF+yso2pWiaLuKou1TUbRtaa9os33/zSjabZVF96Xte71EHW22zzPYi/ZXULQrRdF2FUXbJ/aifUtRe8+37yuER+mxvWg/u71of1WLrvwObWt4Gn3zjqNoU37jrSjabVF79xGijp5lsRftr2rRld+hbQ1Pou/ddSf6jn7gUXosirYZRNF2Nbqzf0+5q+1J9L0nrkTvvxFFu60r0fs9XI2+MbMo2q5Gd/bvKXe1PYm+d9fV6Bv6gUfpkSjaZkGd2Yzs7N+23bVyN/rWU2ejd98mirZbV6L3e7kSvT8z6sxmZGf+tu2mpbvRt546G72rH3iUbouibTbbjp6P7uzftd21dif6Tg1novfeJoq25Ez0Xk9novcy2Hb0fHRn/67trrU70XdqOBO9px94lG6Jou0b9Wr7e9vfJ3vRvrWz0bu1HUXvvBFFu8hR9E5vR9E7b9Cj8ve2/zfZi/YtXYner+0oekc/8Chdthft3+hO9J1a9qL9F+1F+zeiaLdnL9qPEEXbt7gTfaeWvWj/RXvRXj/wKF0WRVv1EUXbL4ui7RuV0eYMinajULRTO1G0/TKKdkJ4lC6Joq36KqONvv3vqYw2Z5XRZqRt9FztbaPn+kcZbYTwKJ0WRVtpZtvo+Zut0TNJY2yj50J4lE6Joq0kSVJjeJROiaKtJElSY3iUDkXRVpIkqQM8SruiaCtJktQJHqVQFG0lSZI6wqOEomgrSZLUGR4lFEVbSZKkzvAo/YiirSRJ0gB4lP6Ioq0k6S//+1LqBo/S/0TRVpL2rNGztyqjjaRq8Cj9RxRtJY23jZ6PVEabt6FoJ6kaPEr/EUVbSWNRtBuFot0VZbQZiaKdpGrwKP33v4J/o62k8SjajULR7shR9M5IFO0kVYFHfVwUbSXNg6LdCNTZ3ZXomyNRtJNUBR71YVG0lTSXKNqO0CP63ZEo2kmqAo/6qCjaSpoTRbsRekS/OxJFO0lV4FEfFUVbSXOiaDdC6+g3R6NoJ6kKPOqDomgraU4U7UZ50plvlZsZULSTVAUe9TFRtJU0L4p2I0XRdk8ZbWZA0U5SFXjUh0TRVtLcKNqNVEabM8poMwOKdpKqwKM+Ioq2kuZH0W6kMtocoWg3A4p2kqrAoz4iiraS5kfRbqQy2hyhaDcDinaSqsCjPiCKtpJyoGg3UhltjlC0mwFFO0lV4FEvF0VbSXlQtBupjDZHKNrNgKLdqow2kkJ41ItF0VZSLhTtRqFod4Si3QyovWdR229KCuFRLxVFW0n5ULQbhaLdkSjajtAi+h1JP/Col4qiraR8KNqNQp3ZnK38Vgujor9F0g886oWiaCspJ4p2o/SIfveM2aO/WdIPPOplomgrKS+KdltRtH2qdfSbe2aO/l5Jh/CoF4miraTcqOh+pvL7T7WMfu/IqOhvkVQFHvUSe9FeUm61o9944mn0zSdqd/Y3aCepCjzqJaJoKym/2tFvPHE2ereFJ9H3CEU7SVXgUS8QRVtJ71Az+v4TVHRfKt8fjaJdiaKdpCrwqOSiaCvpPa5G32iFiu5L5fujUbQrUbSTVAUelVgUbSW9C0W7Eai9Z0vb92dA0W6Lop2kKvCoxKJoK+ldKNqNQB09X9puRoui7YqinaQq8Kikomgr6X0o2o1QdmazRttRKNqtKNpJqgKPSiiKtpLeiaJdb9TZ3RJtR4mi7YKinaQq8Khkomgr6b0o2vVG0W4RRdtRKNotKNpJqgKPSiSKtpLejaJdbxTtVlG0HYGi3YKinaQq8KhEomgr6d0o2vVWRptSFG1HKKPNgqKdpCrwqCSiaCvp/Sja9UTRjlC0G4F6spNUBR6VQBRtJX0DRbueKNqRKNr2Rj3ZSaoCj5pcFG0lfQdFu16iaBuJom1v2+j5gqKdpCrwqIlF0VbSt1C064Wi3ZEo2s6Gop2kKvCoiUXRVtK3ULTrIYq2Z1C0mw1FO0lV4FGTiqKtpO+haNcDRbuzomg7E4p2kqrAoyYURVtJ30TRrrUo2l4RRdtZULSTVAUeNZko2kr6Lop2LUXR9o4o2vaybe/ZWrmRVA0eNZEo2kr6Nop2LVG0eyKKtq1RV55LqgqPmkgUbSV9G0W7VqJo+8RetG8pau/59n1JVeFRk4iirSRRtDuLot0iirY1PIm+d9de0fPyG5KqwaMmEEVbSVr06uzvlrvankTfu+tq9A1JVeBRg0XRVtJ7zdzR37j952jpbvStJ65E70uqAo8aKIq2kvLL2tHfXv5ztnI3+lYNZ6L3JFWBRw0URVtJuWXt6G8v/zlbuxp9o6aj6B1JVeBRg0TRVlJ+s0Z/69ZetP+ao+gdSVXgUQNE0VbSe9SMvt9CFG2/Koq2kqrBozqLoq2k99lGz2e0jZ6L/7uddpKqwaM6iqKtJCmXMtpIqgaP6iiKtpIkSQrhUZ1E0VaSJEm78KgOomgrSZKkQ3hUY1G0lSRJ0il4VENRtJUkSdJpeFRDUbSVJEnSaXhUI1G0lSRJ0iV4VANRtJUkSdJleFRlUbSVJEnSLXhURXvRXpIkSbfgURVF0VaSJEm34VGVRNFWkiRJj+BRFUTRVpIkSY/hUQ9F0VaSJElV4FEPRdFWkiRJVeBRD0TRVpIkSdXgUTdF0VaSJElV4VE3RNFWkiRJ1eFRF0XRVpIkSU3gURdF0VaSJElN4FEXRNFWkiRJzeBRJ0XRVpIkSU3hUSdE0VaSJEnN4fHzjv4f1CjaSpIkqQs8fto2er6Ioq0kSZK6wOOnlR09Xyt3kiRJ6gqPn7XX3vPyO5IkSeoOj590N/qWJEmSusPjJ92JviNJkqQh8Pg5d6NvSZIkaQg8fs7d6FuSJEkaAo+f8jT6piRJkrrD42fUir4tSZKkrvD4GTWj70uSJKkbPH5Ci+h3JEmS1AUeP6F29BuSJEnqBo+vVzv6DUmSJHWFx1erHf2GJEmSusPjq9WMvi9JkqQh8PhaNaPvS5IkaRg8vlat6NuSJEkaCo+vVCv6tiRJkobD4+vUir4tSZKkKeDxdWpE35UkSdI08PgqNaLvSpIkaSp4fI0a0XclSZI0HTy+xtPom5IkSZoSHl/hafRNSZIkTQuPr/Ak+p4kSZKmhsf0nkTfkyRJ0vTwmNqT6HuSJElKAY+p3Y2+JUmSpDTwmNbd6FuSJElKBY9p3Ym+I0mSpHTwmNKd6DuSJElKCY/p3Im+I0mSpLTwmM7V6BuSJElKDY+pXI2+IUmSpPTwmMqV6H1JkiS9Ah7TuBK9L0mSpNfAYwpXovclSZL0KnhM4Wz0riRJkl4Hj9M7E70nSZKk18Lj9I6idyRJkvRqeJzaUfSOJEmSXg+P0zqK3pEkSdIn4HFae9FekiRJn4HHKe1Fe0mSJH0KHqezF+0lSZL0OXicThRtJUmS9El4nEoUbSVJkvRZeJxGFG0lSZL0aXicQhRtJUmS9Hl4nEIUbSVJkvR5eBwuiraSJEnSv+FxqCjaSpIkSf+Fx2GiaCtJkiRt4HGIKNpKkiRJBTwOEUVbSZIkqYDH7qJoK0mSJAE8dhVFW0mSJCmAx26iaCtJkiTtwGM3UbSVJEmSduCxG4p2kiRJ0gE8drWNnkuSJEkn4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEnZ4FGSJEnKBo+SJElSNniUJEmSssGjJEmSlA0eJUmSpGzwKEmSJGWDR0mSJCkbPEqSJEmJ/N+//h9F8ivAZObHiQAAAABJRU5ErkJggg==",alt:""})],-1)),XT={class:"fbc"},KT={class:"btnBox"},ZT={class:"tiltle"},JT=["onClick"],QT=["src"],$T={class:"btnBox"},eE={class:"tiltle"},tE=["onClick"],nE=["src"],iE={class:"btnBox"},rE={class:"tiltle"},oE=["onClick"],aE=["src"],sE={class:"fbc"},lE={class:"btnBox",style:{width:"45%"}},cE={class:"tiltle"},uE={style:{display:"flex","justify-content":"space-around",width:"100%"}},hE={class:"btnBox",style:{width:"50%"}},dE={class:"tiltle"},pE=["onClick"],fE=["src"],mE={class:"fbc",style:{"margin-bottom":"5px"}},gE={style:{width:"70%",height:"150px"}},yE={class:"fbc",style:{height:"30%"}},xE={class:"btnBox",style:{width:"25%",height:"100%",display:"flex"}},vE={class:"tiltle"},_E={style:{width:"80%"}},bE={class:"btnBox",style:{width:"25%",height:"100%",display:"flex"}},wE={class:"tiltle"},AE={style:{width:"80%"}},ME={class:"btnBox",style:{width:"45%",height:"100%",display:"flex"}},SE={class:"tiltle"},TE={class:"fbc"},EE={style:{width:"40%","margin-left":"10px"}},PE=m1(()=>V.createElementVNode("span",null,"×",-1)),CE={style:{width:"40%","margin-right":"10px"}},RE={class:"fbc",style:{height:"55%","margin-top":"20px"}},DE={class:"btnBox",style:{width:"45%",height:"100%",display:"flex"}},IE={class:"tiltle"},LE={style:{width:"75%",padding:"0px 10px"},class:"fbc"},FE={class:"btnBox",style:{width:"30%",height:"100%",display:"flex"}},kE={class:"tiltle"},BE={style:{width:"80%"}},zE={class:"btnBox",style:{width:"20%",height:"100%",display:"flex"}},UE={class:"tiltle"},NE={class:"btnBox",style:{width:"25%",height:"150px"}},VE={class:"tiltle"},OE=V.defineComponent({__name:"WeldingSymbolDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=V.reactive([{typeName:Ut.RolledEdge,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACLCAYAAABRGWr/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAM2SURBVHhe7c1BjuNGEEXBuf+lx+OFYYCIoqhuqcXKeR+IzVMW9evPficXMSbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMCbCmAhjIoyJMP41/p36Ff9Nvw3FON5xujlznG4GYhxP093KcboZiHE8TXcrx+lmIMbxNN2tHKebgRjH03S3cpxuBmIcT9PdynG6GYhxPE13K8fpZiDG8TTdrRynm4EYx9N0t3KcbgZiHE/T3cpxuhmIcTxNdyvH6WYgxvE03a0cp5uBGMfTdLdynG4GYhzvON2c0XQ3DON4x+nmjKa7YRjHO043ZzTdDcM4mqa7M5ruhmEcTdPdGU13wzCOpunujKa7YRhH03T3iKa7QRhHO043V2i6G4RxLE13V2i6G4RxLE13V2i6G4RxLE13V2m6G4JxJE13z9B0NwTjSJrunqHpbgjGcVbT7bM03Q3AOI6mu6/QdDcA4zia7r5K093mGEfRdPcdmu42xziKprvvWE23G2McYzXdfpemu40xjrCabl9hNd1uinEETXevtJpuN8S4vdV0+2qa7jbEuD1Nd++wmm43w7g1TXfvtJpuN8K4rdV0+05n0/0mGLe0mm5/wmq63QTjdlbT7U9aTbcbYNzKarr9hNV0e3OM2zib7j9lNd3eGOMWzqb7T1tNtzfFeHtn0/0dPJre3AzjrZ1N93fyaHpzI4y39Gh6c1dn0/1NMN7Oo+nN3T2a3nwY4208mt7s5NH05oMYP+7K9G5HV6Z3H8D4MVent7u7Mr37QYw/7ur0dpJnpvdvxvgjnpneT/bM9P5NGN/iq9O3/gbfmb73AoxPe8f0P3+rd0z/8wDjZa+e/iP/e/X0HycYL3vV9O2svXL6/gLjZV+dvpWv+870vQXGy65Ob/M+V6e3JxgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMTn49fsfRY10KYgEzyAAAAAASUVORK5CYII=",name:at("卷边焊缝")},{typeName:Ut.IWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAACECAYAAABVsVOaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAM/SURBVHhe7coxcgIBDARB/v9pTHhB54PwTlUn0r4+vWeAxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4THzTP9f8Uz/L8BjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZjQml3ndIuxmNCaXed0i7GY0Jpd53SLsZj5pn+v+KZ/l+AxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxkeZ3ic4XGGxxke5197vf8A1pjJf8df5dQAAAAASUVORK5CYII=",name:at("I型焊缝")},{typeName:Ut.VWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACGCAYAAADth3khAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAO9SURBVHhe7dBBltQ6EEVB9r9pPjCApn8k7XJZdkp695yYpJ9qUN9+9D3iIB4jhMcI4TFCeIwQHiOExwjhMUJ4jBAeI4THCOExQniMEB4jhMcI4TFCeIwQHiOExwjhMUJ4jBAeI4THCOExQniMEB4jhMcI4TFCeIwQHiOExwjh8SUf0/e43sf0fRAeD1PaxXWUdgPweJjSLq6jtBuAx8OqtI33VWk7AI8vUdrF+5R2g/D4kipt47wqbQfh8WVKuzhPaTcQj6co7eJ1SrvBeDylSts4rkrbwXg8TWkXxyntbsDjaVXaxteqtL0Bj29R2sXXlHY34fEtVdpGrUrbm/D4NqVd1JR2N+LxEkq7+D+l3c14vESVtvFHlbY34/EySrv4Q2n3AB4vU6VttP+/eLyU0i7a/1c8XqpK251VafsQHi+ntNuZ0u5BPA6htNuR0u5hPA5Rpe1OqrR9GI/DKO12orRrgMdhqrTdQZW2DfA4lNJuB0q7JngcqkrblVVp2wSPwyntVqa0a4THWyjtVqS0a4bHW1Rpu5IqbZvh8TZKu5Uo7Rri8TZV2q6gStuGeLyV0m4FSrumeLxVlbYzq9K2KR5vp7SbmdKuMR4fobSbkdKuOR4fUaXtTKq0bY7HxyjtZqK0mwCPj6nSdgZV2k6Ax0cp7WagtJsEj4+q0razKm0nwePjlHadKe0mwmMLSruOlHaT4bGFKm07qdJ2Mjy2obTrRGk3IR7bqNK2gyptJ8RjK0q7DpR2k+KxlSptn1Sl7aR4bEdp9ySl3cR4bElp9wSl3eR4bKlK2ztVaTs5HttS2t1JabcAHtuq0vYOVdougMfWlHZ3UNotgsfWqrQdqUrbRfDYntJuJKXdQnicgtJuBKXdYnicQpW2V6rSdjE8TkNpdyWl3YJ4nEaVtleo0nZBPE5FaXcFpd2ieJxKlbbvqNJ2UTxOR2n3DqXdwnicktLuDKXd4nicUpW2r6jSdnE8Tktp9wql3QZ4nFaVtkdUabsBHqemtDtCabcJHqdWpe2/VGm7CR6np7T7F6XdRnhcgtJOlHab4XEJVdp+VKXtZnhchtLuI6XdhnhcRpW2P1VpuyEel6K0+0lptykel1J1drcxHpejzmw2x+OS1JFv8RuPS3o1/cbmeFzW0fQ2fFzW0fQ2fFzaV+lN/MLj0r5Kb+IXHpdXpW38xuMWPqdN/IXHLXxOm/gLjxHCY4TwGCE8RgiPEcJjhPAYITxGCI8RwmOE8BghPEYIjxHCY4TwGCE8RgiPEZ98+/4famIFigcWF7IAAAAASUVORK5CYII=",name:at("V型焊缝")},{typeName:Ut.SingleVWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIQAAACECAYAAABRRIOnAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAPJSURBVHhe7dLLstMIEERB/v+nYYDwYEy6ryy79Oo+EblplbTSt//6PsYdHkdfPI6+eBx98Tj64nH0xePoi8fRF4+jLx5HXzyOvngcffE4+uJx9MXj6IvH0RePoy8eR188jr54HH3xOPricfTF4+iLx9EXj6MvHkdfPI6+eBx98Tj64nH0xePoi8e4+/R8LHNLz1biMe4xbUbtMW1W4DFKaTeee5a2L+IxSmk37FnarsBjlNJu/KtK+xV4jFLajb9Vab8Sj1FKu/FHlfZv4DFKaTd+q9L+TTxGKe3G5j/DTzxGKe26q9L+Q3iMUtp1VqX9B/EYpbTrqkr7D+MxSmnXUZX2ATxGKe26qdI+hMcopV0nVdoH8RiltOuiSvswHqOUdh1Uab8BHqOUdldXpf1GeIxS2l1ZlfYb4jFKaXdVVdpvjMcopd0VVWm/Ax6jlHZXU6X9TniMUtpdSZX2O+IxSml3FVXa74zHKKXdFVRpfwA8Rintzq5K+4PgMUppd2ZV2h8Ij1FKu7Oq0v5geIxS2p1RlfYHxGOU0u5sqrQ/KB6jlHZnUqX9gfEYpbQ7iyrtD47HKKXdGVRpfwI8Rintjq5K+5PgMUppd2RV2p8Ij1FKu6Oq0v5keIxS2h1RlfYnxGOU0u5oqrQ/KR6jlHZHUqX9ifEYpbQ7iirtT47HKKXdEVRpfwE8Rint9lal/UXwGKW021OV9hfCY5TSbi9V2l8Mj1FKuz1UaX9BPEYp7bZWpf1F8RiltNtSlfYXxmOU0m4rVdpfHI9RSrstVGnfAI9RSru0Ku2b4DFKaZdUpX0jPEYp7VKqtG+GxyilXUKV9g3xGKW0+7Qq7ZviMUpp90lV2jfGY5TS7lOqtG+Oxyil3SdUaT98jFLavatK+/ELj1FKu3dUaT/+x2OU0m6tKu3HX3iMUtqtUaX9+AePUUq7V1VpP4jHKKXdK6q0H0/xGKW0W6pK+1HiMUppt0SV9uNLPEYp7b5Spf1YhMcopV2lSvuxGI9RSrtnqrQfL+ExSmknVdqPl/EYpbR7VKX9WIXHKKXdvSrtx2o8Rintbqq0H2/hMUpp91OV9uNtPEappbtb2o+P4DFKLdncetyOj+IxSn31/Nb9bkTwGKWqZ7fuvzFieIxSz+63Hr8xYniMejV9Y8TwGPVKen9E8Ri1NL074niMWpLeG5vgMeqr9M7YDI9RVdqPTfEY9Sxtx+Z4jHtMm7ELHkdfPI6+eBx98Tj64nH0xePoi8fRF4+jLx5HXzyOvngcffE4+uJx9MXj6IvH0dK37z8A73de+HhGe7kAAAAASUVORK5CYII=",name:at("单边V型焊缝")},{typeName:Ut.SingleSteepVWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAACGCAYAAAAYefKRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANoSURBVHhe7c8xbiRADANB///TPl9qVLpDSWYDlQhM9PXTdxXwWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMVjFY9VPFbxWMXjGP/T/a8I/s/jCL/T5rLfafNBPMYp7a5S2n0Qj3FKu6uUdh/EY5zS7iql3QfxGKe0u0hp92E8xintLlLafRiPcUq7i5R2H8ZjnNLuGqXdAzzGKe2uUdo9wGOc0u4Spd0jPMYp7S5R2j3CY5zS7hKl3SM8xintrlDaPcRjnNLuCqXdQzzGKe2uUNo9xGOc0u4Cpd1jPMYp7S5Q2j3GY5zS7gKl3WM8xinttlPaBfAYp7TbTmkXwGOc0m47pV0Aj3FKu82UdiE8xintNlPahfAYp7TbSmkXxGOc0m4rpV0Qj3FKu62UdkE8xintNlLahfEYp7TbSGkXxmOc0m4jpV0Yj3FKu22UdgPwGKe020ZpNwCPcUq7bZR2A/AYp7TbRGk3BI9xSrtNlHZD8BintNtEaTcEj3FKuy2UdoPwGKe020JpNwiPcUq7DZR2w/AYp7TbQGk3DI9xSrsNlHbD8BintJtOaTcQj3FKu+mUdgPxGKe0m05pNxCPcUq7yZR2Q/EYp7SbTGk3FI9xSrvJlHZD8RintJtKaTcYj3FKu6mUdoPxGKe0m0ppNxiPcUq7iZR2w/EYp7SbSGk3HI9xSrtplHYL8BintJtGabcAj3FKu2mUdgvwGKe0m0RptwSPcUq7SZR2S/AYp7SbRGm3BI9xSrsplHaL8BintJtCabcIj3FKuymUdovwGKe0m0BptwyPcUq7CZR2y/AYp7SbQGm3DI9xSrs0pd1CPMYp7dKUdgvxGKe0S1LaLcVjnNIuSWm3FI9xSrskpd1SPMYp7VKUdovxGKe0S1HaLcZjnNIuRWm3GI9xSrsEpd1yPMYp7RKUdsvxGKe0S1DaLcdjnNLuNaXdATzGKe1eU9odwGOc0u41pd0BPMYp7V5S2h3BY5zS7iWl3RE8xintXlHaHcJjnNLuFaXdITzGXUr/LcBj3KX03wI8xl1LPw7H4whX0m8L8DjG9vTTEjxW8VjFYxWPVTxW8VjFYxWPVTxW8VjFYxWPVTxW8VjFYxWPVTxW8VjFYxWPVTzWn/b1/Q8BUEg5iTSvRAAAAABJRU5ErkJggg==",name:at("单边陡侧V型坡口堆焊")},{typeName:Ut.InclinedWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACKCAYAAABxcgJZAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAL9SURBVHhe7ctZbiMxEATRuf+lPYbhAryEO0tSq8UlEng/Qda/971JBzBKBaNUMEoFo1QwSgWjVDBKBaNUMEoFo1QwSgWjVDBKBaNUMEoFo1QwSgWjVDBKBaNUMEoFo1QwSgWjVDBKBaOepEZvg8Kok9Ho34Aw6kRHo/+DwaiTHI3+DwijHpRGN4PCqAek0c3AMOoOndHd4DDqRml0MwmMauqM7iaCUQ1pdDMhjArS6GZSGPWHNLqZHEaBNLpZAEZ90RndLQKjPqXRzWIwbq8zulsQxq2l0c3CMG4rjW4Wh3E7aXSzCYxbSaObjWDcQmd0txmMy0ujm01hXFZndLcxjEtKoxtxXE4a3egDxmWk0Y2+wbiENLrRLxin1hndCWGcVhrd6BDG6XRGd4owTiWNbtSGcRppdKObYBxeGt3oLhiHlkY3uhvGIXVGd3oIxuGk0Y1OgXEYndGdToNxCGl0o9NhfLk0utFTYHyZNLrRU2F8iTS60dNhvFRndDejr6P3AWG81NHo/4xo9G9AGC/11+jvjI5G/weD8VI/R39mlEY3A8J4uRq9zSiNbgaFUXfqjO4GhlF3SKObCWDUjdLoZhIY1ZRGN5PBqIY0upkQRh3ojO4mhVF/SKObyWHUD53R3QIw6os0ulkIRn1Ko5vFYNxeGt0sCuPW0uhmYRi31BndLQ7jdtLoZhMYt9EZ3W0E4xbS6GZDGJeXRjebwrisNLrZHMYlpdGNOC6lM7rTB4zLSKMbfYNxep3RnX7BOLU0utGfME4rjW50CON00uhGLRinkkY3asM4hc7oTjfBOLw0utFdMA6rM7rT3TAOKY1u9DCMw0mjG50C4zDS6EanwjiENLrR6TC+VGd0p6fA+DJpdKOnwni5zuhOT4fxUml0o8tgvNTR6L8uhfFSNPqnl8B4qZ+jP3oZjFLBKBWMUsEoFYxSwSgVjFLBKBWMUsEoFYxSwSgVjFLBKBWMUsEoFYxSwSgVjFLBKBWMUsEoFYxSwSgVjFLBKL379/YfTIZSIZ+GYOYAAAAASUVORK5CYII=",name:at("倾斜焊缝")},{typeName:Ut.RemovablePadding1,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAYAAABSZ763AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAorSURBVHhe7dLLimNBDkXR/v+f7m4PEhKx/AjLkm8WZ8Oa6J4oXJD/+X//jYh1PEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8ePSemvp7/rD+DxI1L6V9LfdxOPbSn9a+nvvIHHtpT+tfR33sBjW0r/Wvo7b+CxTWkXcUVKuwYe25R2EVektGvgsU1pF3FFSrsGHtuUdhFXpLRr4LFNabftd/p+Jb/T93dsp9/wFyjtGnhsU9ptqmlzFUq7U99Mv+eqlHYNPLYp7TYp7a5AaXfqCul3XY3SroHHNqXdJqXdt91L21NXSr/vKpR2DTy2Ke02Ke2+7V7anrpa+o1XoLRr4LFNabfpXtp+0720PVXT5pNeSe++TWnXwGOb0m7TvbT9pntpe6qmzYRn6c03Ke0aeGxT2m26l7bf8ijtT9W0mXYvbb9FadfAY5vSbtO9tP2WR2l/qqbNBqXdtyjtGnhsU9ptepT23/Ao7U/VtNlwL22/QWnXwGOb0m7To7Tf9iy9OVXTZovS7huUdg08tintNj1K+23P0ptTNW02Ke22Ke0aeGxT2m16lt5sepbenKpps0lpt01p18Bjm9Ju07P0Zssr6d2pmjablHbblHYNPLYp7TY9S2+2vJLenapps01pt0lp18Bjm9Ju0yvp3YZX0rtTNW22Ke02Ke0aeGxT2m16Jb3b8Ep6d6qmzTal3SalXQOPbUq7Ta+kd9NeTW9P1bTZprTbpLRr4LFNabepptut+m7aq+ntqZo225R2m5R2DTy2Ke021XS7Vd9NezW9PVXTZpvSbpPSroHHNqXdppput+q7SerRvaumzTal3SalXQOPbUq7TbVn9w3q0b2rps02pd0mpV0Dj21Ku021e/dbv99NUo/uXTVttintNintGnhsU9ptqt273/r9bop65VtHTZttSrtNSrsGHtuUdptq9+63fr+bol751lHTZtO9tN2ktGvgsU1pt6n26Nut398nqFe+ddS02aS026a0a+CxTWm3qfbo263f3z9NnXx/V02bTUq7bUq7Bh7blHabao++3fr9/dPUyfd31bTZorT7BqVdA49tSrtNtWffb9XNp6iT7++qabNFafcNSrsGHtuUdptqz77fqptPqT37fqtu3lHTZsO9tP0GpV0Dj21Ku021Z99v1c0nqHc276hpM+1e2n6L0q6Bxzal3abau5su9c7mHTVtpjxK+29S2jXw2Ka021R7ZXNLuw71zuYdNW0+7Vl6821KuwYe25R2m2qvbG5p9y7V2Z2qafMJJ+n9tyntGnhsU9ptqr2yuaXdu1Rnd+pq6TdegdKugcc2pd2mmjY3Srt3qM7u1FXSb7sSpV0Dj21Ku001bW6UdqeUdjdKu1PfTL/nqpR2DTy2Ke021bS5UdqdUtrdKO1OfSP9jqtT2jXw2Ka021TT5ofS7oTS7kZpd6qmzavupe1fo7Rr4LFNabepps0Ppd2JmjY/lHanatqcUNr9NUq7Bh7blHabatr8UNq9Smn3Q2l3qqbNiXtp+5co7Rp4bFPabapp85vS7hVKux9Ku1M1bU4p7f4SpV0Dj21Ku001bX5T2r1CafdDaXeqps2pe2n7VyjtGnhsU9ptqmnzm9LuGaXdb0q7UzVt3qG0+yuUdg08tintNtW0qWraPKO0+01pd6qmzbuUdn+B0q6Bxzal3aaaNpXS7hGl3W9Ku1M1bd6ltPsLlHYNPLYp7TbVtKmUdvco7Sql3amaNh1Ku6tT2jXw2Ka021TTplLa3aO0q5R2p2radCjtrk5p18Bjm9JuU00bUdqJ0q5S2p2qadOltLsypV0Dj21Ku001bURpVyntRGl3qqZNl9LuypR2DTy2Ke021bQRpV2ltBOl3amaNp+gtLsqpV0Dj21Ku001be5R2v2mtBOl3amaNp+gtLsqpV0Dj21Ku001be5R2v1W0+Yepd2pmjaforS7IqVdA49tSrtNNW3uUdr9UNrdo7Q7VdPmU5R2V6S0a+CxTWm3qabNIzVtfijt7lHanapp80lKu6tR2jXw2Ka021TT5hGl3Y3S7h6l3amaNp+ktLsapV0Dj21Ku001bR5Rnd0jSrtTNW0+TWl3JUq7Bh7blHabato8ojq7R5R2p2rafJrS7kqUdg08tintNtW0eUa9s3lGaXeqps0Epd1VKO0aeGxT2m2qafOMOvn+KqXdqZo2E5R2V6G0a+CxTWm3qabNM+rk+6uUdqdq2kxR2l2B0q6Bxzal3aaaNq9Qr3w7obQ7VdNmitLuCpR2DTy2Ke021bR5hXp0f4fS7lRNm0lKu29T2jXw2Ka021TT5hXq0f0dSrtTNW0mKe2+TWnXwGOb0m5TTZtXvZrevkJpd6qmzTSl3Tcp7Rp4bFPabapp86pX09tXKO1O1bSZdi9tv0Vp18Bjm9JuU02bV72S3r1KaXeqps0Gpd23KO0aeGxT2m2qaXPiWXrzKqXdqZo2G+6l7Tco7Rp4bFPabappc+JZevMqpd2pmjZblHbfoLRr4LFNabepps2JR2l/Qml3qqbNlntpu01p18Bjm9JuU02bE4/S/oTS7lRNm01Ku21KuwYe25R2m2ranLqXtieUdqdq2my6l7ablHYNPLYp7TbVtDmltDultDtV02ab0m6T0q6Bxzal3aaaNqeUdqeUdqdq2mxT2m1S2jXw2Ka021TT5h01bU7VtHlHTZtvqGmzSWnXwGOb0u5fMfX/m/p3r+hK/1elXQOPbUq7iCtS2jXw2Ka0i7gipV0Dj21Ku4grUto18NimtIu4IqVdA49tSruIK1LaNfDYprSLuCKlXQOPH1HTJuKKato08fgxP+lbxJX9pG8fwGNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbEmP/893/f80bLRIOECQAAAABJRU5ErkJggg==",name:at("可移除衬垫")},{typeName:Ut.RemovablePadding2,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAADHCAYAAAB7oJ2jAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAakSURBVHhe7dPLrhtXEkVB//9PuxvwQH7ElX2OkiWKuRYQk+QuoAbF3/7f70lehsckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3hMMoPHJDN4TDKDxyQzeEwyg8ckM3i8UvUJ6dv+ATweq/qk9I1f4vFY1Selb/wSj8eqPil945d4PFb1Sekbv8TjMaVd8m6Udpd4PKa0S96N0u4Sj8eUdsm7Udpd4vGY0i55N0q7SzweU9pt9TPSe+SflHaXeDymtNvoZ6d3yjdKu0s8HlPabfRO6f22U9pd4vGY0m6jd0zvuZXS7hKPx5R2GyntJpyk5zdS2l3i8ZjSbiOl3aT/kp7bSGl3icdjSruNlHav8r2030Zpd4nHY0q7jZR2r/ZV2m6itLvE4zGl3UZKuyco7TZR2l3i8ZjSbiOl3RO+StstlHaXeDymtNtIafcUpd0WSrtLPB5T2m2ktHvKV2m7gdLuEo/HlHYbKe2epLTbQGl3icdjSruNlHZPUtptoLS7xOMxpd1GSrunKe0+ndLuEo/HlHYbKe2eprT7dEq7SzweU9ptpLR7mtLu0yntLvF4TGm3kdLuaUq7T6e0u8TjMaXdRkq7pyntPp3S7hKPx5R2Gyntnqa0+3RKu0s8HlPabaS0e5rS7tMp7S7xeExpt5HS7mlKu0+ntLvE4zGl3UZKu6cp7T6d0u4Sj8eUdhsp7Z70Vdp+OqXdJR6PKe02Uto9SWm3gdLuEo/HlHYbKe2epLTbQGl3icdjSruNlHZPUdptobS7xOMxpd1GSrunKO22UNpd4vGY0m4jpd0TvkrbLZR2l3g8prTbSGn3al+l7SZKu0s8HlPabaS0e6Xvpf0mSrtLPB5T2m2ktHuFf0vPbKO0u8TjMaXdRkq7Kf81PbuR0u4Sj8eUdhu9Y3rPrZR2l3g8prTb6N3SO26mtLvE4zGl3Ubvkt4t/cF+eT8zvU/+Sml3icdjSruNfkZ6j5jS7hKPx5R2Gynt/quv0jb/Tml3icdjSruNlHYnlHb5d0q7SzweU9ptpLQ78VXa5vuUdpd4PKa020hpd0ppl+9T2l3i8ZjSbiOl3amv0jZfU9pd4vGY0m4jpd0NpV2+prS7xOMxpd1GSrsbX6VtTGl3icdjSruNlHa3lHYxpd0lHo8p7TZS2t36Km3zT0q7SzweU9ptpLT7EUq7/JPS7hKPx5R2GyntfsRXaZu/Utpd4vGY0m4jpd2PUtrlr5R2l3g8prTbSGk3QWmXb5R2l3g8prTbSGk3QWmXb5R2l3g8prTbSGk3RWmXPyjtLvF4TGm3kdJuitIuf1DaXeLxmNJuI6XdJKVd+oP98pR2k5R26Q/2y1PaTVPabae0u8TjMaXdRkq7aUq77ZR2l3g8prTbSGn3Ckq7zZR2l3g8prTbSGn3Ckq7zZR2l3g8prTbSGn3Kkq7rZR2l3g8prTbSGn3Kkq7rZR2l3g8prTbSGn3Skq7jZR2l3g8prTbSGn3Skq7jZR2l3g8prTbSGn3akq7bZR2l3g8prTbSGn3akq7bZR2l3g8prTbSGn3BKXdJkq7SzweU9ptpLR7gtJuE6XdJR6PKe02Uto9RWm3hdLuEo/HlHYbKe2eorTbQml3icdjSruNlHZPUtptoLS7xOMxpd1GSrsnKe02UNpd4vGY0m4jpd3TlHafTml3icdjSruNlHZPU9p9OqXdJR6PKe22+nP6/Wf5c/p9A6XdJR6PKe2Sd6O0u8TjMaVd8m6Udpd4PKa0S96N0u4Sj8eUdsm7Udpd4vGY0i55N0q7SzweU9ol70Zpd4nHY0q75N0o7S7xeOzvaZO8q7+nzSUek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpPM4DHJDB6TzOAxyQwek8zgMckMHpP8sN9+/x86HHd2B1To+QAAAABJRU5ErkJggg==",name:at("可移除衬垫")},{typeName:Ut.DurableLiner,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADMCAYAAAAceR0nAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAgjSURBVHhe7dLBjsNGDETB/P9PJ9HBgEGUbMlc7hoz/YC6UD03/fN//0bEr+MxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbx+CNSWiX93008tqW0UvrHm3hsS2ml9I838diW0krpH2/isU1pF/GNato08dimtIv4RjVtmnhsU9pFfKOaNk08tintIr5RTZsmHtuUdqt7pG/f5pG+7aamTROPbUq7ldW0+RY1bXZS06aJxzal3cqUdt9AabeLmjZNPLYp7VamtPsGSrtd1LRp4rFNabcypd1fO0vbXdS0aeKxTWm3MqXdXztL213UtGnisU1pt7KztP1LZ2m7i5o2TTy2Ke1Wdpa2f+VV2u+ipk0Tj21Ku5Wdpe1feZX2u6hp08Rjm9JuZa/S/i+8Svtd1LRp4rFNabeyV2n/296lN7uoadPEY5vSbmWv0v63vUtvdlHTponHNqXdyt6lN7/pXXqzi5o2TTy2Ke1W9i69+U3v0ptd1LRp4rFNabeyd+nNb7mS3u2ipk0Tj21Ku5VdSe9+w5X0bhc1bZp4bFParexKevcbrqR3u6hp08Rjm9JuZVfSu2lX09td1LRp4rFNabeyK+ndtKvp7S5q2jTx2Ka0W1lNt6P6btrV9HYXNW2aeGxT2q2spttRfTdJvbrvqqZNE49tSruV1XQ7qu8mqVf3XdW0aeKxTWm3strZ/ej53ST16r6rmjZNPLYp7VZWO7sfPb+bVDu7Hz2/201NmyYe25R2K6ud3Y+e301RV77tqKZNE49tSruV1V59O3r+PkFd+bajmjZNPLYp7VZWe/Xt6Pn7BHXl245q2jTx2Ka0W1nt1bej5+8/Td35vpuaNk08tintVla7+/0nqTvfd1PTponHNqXdymrvvh/VzU9Rd77vpqZNE49tSruV1d59P6qbn6A+2eykpk0Tj21Ku5XV3n0/qpufoD7Z7KSmTROPbUq7ldWubI6061CfbHZS06aJxzal3cpqVzZH2n1KdXa7qGnTxGOb0m5ltSubI+0+pTq7XdS0aeKxTWm3spo2B6XdJ1Rnt4uaNk08tintVlbT5qC0+0RNm4PSbhc1bZp4bFParaymzUFpd5fS7qC020VNmyYe25R2K6tp86C0u0Npd1Da7aKmTROPbUq7ldW0eVDa3aG0OyjtdlHTponHNqXdymraPCjtrlLaPSjtdlHTponHNqXdymraPKtpc5XS7kFpt4uaNk08tintVlbT5pnS7gql3YPSbhc1bZp4bFParaymzTOl3TtKu2dKu13UtGnisU1pt7KaNs+Udu8o7Z4p7XZR06aJxzal3cpq2lRKu1eUds+UdruoadPEY5vSbmU1bSql3RmlXaW020VNmyYe25R2K6tpUyntzijtKqXdLmraNPHYprRbWU0bUdqJ0q5S2u2ipk0Tj21Ku5XVtBGlnSjtKqXdLmraNPHYprRbWU0bUdpVSjtR2u2ipk0Tj21Ku5XVtDlT06ZS2onSbhc1bZp4bFParaymzRml3TOlnSjtdlHTponHNqXdymranFHaPSjtzijtdlHTponHNqXdymranFHaPSjtzijtdlHTponHNqXdymravKK0OyjtzijtdlHTponHNqXdymravKI6u1eUdruoadPEY5vSbmU1bV5Rnd0rSrtd1LRp4rFNabeymjbvqE827yjtdlHTponHNqXdymravKPeber3K5R2u6hp08Rjm9JuZTVt3lF3vl+ltNtFTZsmHtuUdiuraXOFuvLtDqXdLmraNPHYprRbWU2bK9SVb3co7XZR06aJxzal3cpq2lyhXt0/obTbRU2bJh7blHYrq2lzVU23o/ruKqXdLmraNPHYprRbWU2bq66mt1co7XZR06aJxzal3cpq2lx1Jb27Smm3i5o2TTy2Ke1WVtPmqivp3VVKu13UtGnisU1pt7KaNne8S2+uUtrtoqZNE49tSruV1bS541Xa36G020VNmyYe25R2K6tpc8ertL9DabeLmjZNPLYp7VZW0+aus7S9Q2m3i5o2TTy2Ke1WVtPmrrO0vUNpt4uaNk08tintVlbT5i6l3V1Ku13UtGnisU1pt7KaNp+oaXNXTZud1LRp4rFNabe6R/r2qef0/VPP6ftOato08dimtIv4RjVtmnhsU9pFfKOaNk08tintIr5RTZsmHtuUdhHfqKZNE49tSruIb1TTponHNqVdxDeqadPEY5vSLuIb1bRp4vFHPKfvEd+qpk0TjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIhZPEbELB4jYhaPETGLx4iYxWNEzOIxImbxGBGzeIyIWTxGxCweI2IWjxExi8eImMVjRMziMSJm8RgRs3iMiFk8RsQsHiNiFo8RMYvHiJjFY0TM4jEiZvEYEbN4jIgx//z7H//k+3DTA6wPAAAAAElFTkSuQmCC",name:at("持久衬垫")},{typeName:Ut.VFlangedEdgeSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAI8AAACZCAYAAAAW7GkVAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAARYSURBVHhe7cvRbh03EERB//9POwmNGIpTI1HS3V2S0weol2Hzx9/9jPgiHiNm8Bgxg8eIGTxGzOAxYgaPETN4jJjBY8QMHiNm8Bgxg8eIGTxGzOAxYgaPETN4jJjB40u9Te/xPW/T+4V4fBmlXXyN0u4iPL5MlbbxOVXaXoTHl1Laxeco7S7E40tVaRtzqrS9EI8vV6VtfExpdzEeL6G0i/cp7W7A4yWqtA2r0vYGPF6mStv4P6XdTXi8lNIu/qtK25vweKkqbeOXKm1vxOPllHbxi9LuZjxerkrb7qq0vRmPt6jStjOl3QN4vI3Sriul3UN4vE2Vtt1UafsQHm9VpW0nSrsH8Xg7pV0XVdo+iMfbVWl7uiptH8bjI5R2p1PaLYDHR1Rpe6oqbRfA42OqtD2R0m4RPD5KaXcapd1CeHxUlbanqNJ2ITw+rkrbEyjtFsPjEpR2u6vSdjE8LqFK211VabsgHpehtNuV0m5RPC6jStvdVGm7KB6XUqXtTpR2C+NxOUq7XSjtFsfjcqq0XV2VtovjcUlV2q5MabcBHpeltFtVlbYb4HFZVdqupkrbTfC4NKXdapR2G+FxaVXarqJK243wuLwqbVegtNsMj1tQ2j1NabchHrdQpe1TqrTdEI/bqNL2CUq7TfG4FaXd3aq03RSPW6nS9i5V2m6Mx+0o7e6itNscj9up0vZqVdpujsctVWl7JaXdAXjcltLuKkq7Q/C4rSptX61K20PwuLUqbV9JaXcQHrentHuVKm0PwuP2qrT9riptD8PjEZR236W0OxCPR6jS9quqtD0Qj8eo0vYrlHaH4vEoSrvPUtodjMejVGk7q0rbg/F4nCptZyjtDsfjkZR2H6nS9nA8HqlK20qVtg3weCylXUVp1wSPx6rS9k9V2jbB49GqtH1LadcIj8dT2v1LadcMj8er+u62GR5bqJrZ/blpisc21Efv//R20xiPbVR99BYDj62o9+7xG4+tfCb9b4zHdmbSv+Z4bOm9tA8fW3ov7cPHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsS2lXQw8tqW0i4HHtpR2MfDYltIuBh7bUtrFwGNbSrsYeGxLaRcDj20p7WLgsbW36T1+4zFiBo8RM3iMmMFjxAweI2bwGDGDx4gZPEbM4DFiBo8RH/jx8y+Pl33WETfr+QAAAABJRU5ErkJggg==",name:at("带顿边V型焊缝")},{typeName:Ut.UFlangedEdgeSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJIAAACfCAYAAAAS5YBQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAATXSURBVHhe7c7bbgM3EETB/P9PJwQTBAlRK3tmL5TsPkC9jJpr/zH6M+ICPEZU8RhRxWNEFY8RVTxGVPEYUcVjRBWPEVU8RlTxGFHFY0QVjxFVPEZU8RhRxWNEFY8RVTxGVPEYUcVjRBWPEVU8tvw3/R77rWnTxGPLmjax15o2TTyWKe1irzVtmngsU9rFXmvaNPFYprSLvda0aeKxTGkXe61p08RjmdIu9lrTponHMqVd7LWmTROPZUq72GtNmyYey5R2sdeaNk08lintYq81bZp4LFPaxV5r2jTxWKa0i73WtGnisUxpF3utadPEY5nSLvZa06aJxzKlXey1pk0Tj2VKu9hrTZsmHsuUdrHXmjZNPJYp7WKvNW2aeCxT2sVea9o08VimtIu91rRp4rFMaRd7rWnTxGOZ0i72WtOmiccypV3staZNE49lSrvYa02bJh7LlHax15o2TTyWKe1irzVtmngsU9rFXmvaNPFYprSLvda0aeKxTGkXe61p08RjmdIu9lrTponHMqVd7LWmTROPZUq72GtNmyYey5R2sdeaNk08lintYq81bZp4LFPaxV5r2jTxWKa0i73WtGnisUxpF3utadPEY8uaNrHXmjZNPLasaRN7rWnTxGPLmjaxj9KuiccWpV3sobRr4rFFaRd7KO2aeGxR2sUeSrsmHluUdrGH0q6JxxalXeyhtGvisUVpF3so7Zp4bFHaxR5r2pzAY5vSLp6ltDuBxzalXTxLaXcCj21Ku3iW0u4EHtuUdvGsNW1O4vEUpV08Q2l3Eo+nKO3iGUq7k3g8RWkXz1DancTjaUq7uJfS7gI8nqa0i3sp7S7A42lHaRv3OErbC/B4CaVd3ENpdxEeL3GUtnGto7S9CI+XUdrFtZR2F+LxMkq7uM5R2l6Ix0sp7eIaSruL8Xipo7SNc47S9mI8Xk5pF+co7W7A4+WO0jZ6jtL2Bjze4ihto+YobW/C422UdvF9R2l7Ix5vc5S28T1HaXsjHm91lLbx2lHa3ozH2x2lbdhR2j6Ax9u9Svv4v6O0fQiPj3iV9vG3V2n/EB4f8yrtf7tXaf8gHh/1Ku1/q1dp/zAeH/cq7X+bV2m/AY9bvEr73+JV2m/C4zav0v4n+yq92YjHrb5Kb36ar9KbzXjc7qv05qf4Kr15Azy+ja/Sm0/1VXrzRnh8K99J7z7Fd9K7N8Pj2/luevuuvpveviEe39Z309t38d309o3x+NYq6f0ulfT+zfH4ETrpO3fppO98CB4/Sjd964wz6XsfhsePdEdPfv/D8fjR3j39zz8Ajz/GO6X/7wfh8cd6Mv39H4zHX+PK9P1fhMcYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHmNQ2sXEYwxKu5h4jEFpFxOPMSjtYuIxBqVdTDzGoLSLiccYlHYx8RiD0i4mHuMf/02/x794jKjiMaKKx4gqHiOqeIyo4jGiiseIKh4jqniMqOIxoorHiII//vwLaaN9R7Ov7yUAAAAASUVORK5CYII=",name:at("带顿边U型焊缝")},{typeName:Ut.SingleVFlangedEdgeSeam,img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJkAAACdCAYAAACnzdqsAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAASxSURBVHhe7dJBctRAEERR7n9pgyEAk/zpmrFLyi4pf8Tb5FRr4fC3H71FHAzHiE44RnTCMaITjhGdcIzohGNEJxwjOuEY0QnHiE44RnTCMaITjhGdcIzohGNEJxwjOuEY0QnHiE44RnTCMaITjhGdcIzohOM23qM9vu7Evy2OdhrdxOdpdNMIRzuNbuJ1j6LbRjjaaXQTr1lF941wtNPoJp63iu6b4Win0U08ZxXdHwBHO41uYq2K3hwERzuNbuKxKnpzIBztNLoJVkVvDoajnUY38b9VdH8SHO00uom/qujNiXC00+gmfqmiNyfD0U6jmxjxD/YORzuNbu5uFd0b4Win0c1dVdEbMxztNLq5oyp6swEc7TS6uZsqerMJHO00urmTVXS/GRztNLq5gyp6syEc7TS6uboqerMpHO00urmyKnqzMRztNLq5qlV0PwCOdhrdXE0VvRkCRzuNbq6kit4MgqOdRjdXUUVvhsHRTqObK1hF90PhaKfRzWRV9GYwHO00upmqit4Mh6OdRjcTVdGbC8DRTqObaVbR/YXgaKfRzRRV9OZicLTT6GaCKnpzQTjaaXSzuyp6c1E42ml0s7NVdH9xONppdLOjKnpzAzjaaXSzmyp6cxM42ml0s5MqenMjONppdLOLVXR/QzjaaXTjVkVvbgpHO41unKrozY3haKfRjUsVvbk5HO00unFYRffxE452Gt2cqYrexB842ml0c5YqehP/wNFOo5szVNGb+A+OdhrdHG0V3cdDONppdHOUKnoTSzjaaXRzhCp6EyUc7TS66VZFb+IpONppdNNpFd3HS3C00+imQxW9iZfhaKfRzVdV0Zv4FBztNLr5iip6E5+Go51GN5+1iu7jy3C00+jmVVX0JlrgaKfRzSuq6E20wdFOo5tnVdGbaIWjnUY3z1hF93EIHO00ulmpojdxGBztNLp5pIrexKFwtNPohlTRmzgcjnYa3ahVdB+nwdFOo5vfquhNnApHO41u3lXRmzgdjnbaMzcavQkLHO206veP6W3Y4WinPdq1j9+IbeBop9Gm6TdiGzjavRp9I7aBo92z0dvYDo52z0TvYks42lXRm9gWjnar6D62hqMdRXcxAo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg42ml0E2PgaKfRTYyBo51GNzEGjnYa3cQYONppdBNj4Gin0U2MgaOdRjcxBo52Gt3EGDjaaXQTY+Bop9FNjIGjnUY3MQaOdhrdxBg4buFj9HuMgWNEJxwjOuEY0QnHiE44RnTCMaITjhFNvr19B8xBuQucEkh1AAAAAElFTkSuQmCC",name:at("带顿边单边V型焊缝")},{typeName:Ut.SingleUFlangedEdgeSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAACmCAYAAADNhf3/AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAShSURBVHhe7c1bbmNHFATB2f+mx4YBA7YQ1LzUaiZVCcTPYTXvt7/7PvNJeJw5gceZE3icOYHHmRN4nDmBx5kTeJw5gceZE3icOYHHmRN4nDmBx5kTeJw5gceZE3icOYHHmRN4nDmBx5kTeJw5gcest2lT89/0ewiPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSrsSpV0Ej0lKuxKlXQSPSUq7EqVdBI9JSruSt2kTwmOS0q7kbdqE8JiktCt5mzYhPCYp7Urepk0Ij0lKuwqlXQiPSUq7CqVdCI9JSrsKpV0Ij0lKu4q3aRPDY5LSrkBpF8NjktKuQGkXw2OS0q5AaRfDY5LSrkBpF8NjktLu2SntgnhMUto9O6VdEI9JSrtn9ihtg3hMUto9M6VdFI9JSrtnprSL4jFJafeslHZhPCYp7Z6V0i6MxySl3TNS2sXxmKS0e0ZKuzgek5R2z+ZR2sbxmKS0eyaP0vYF8JiktHsmSrsXwWOS0u5ZPErbF8FjktLuWSjtXgiPSUq7Z/AobV8Ij0lKu9sepe2L4TFJaXfTo7R9QTwmKe1ueZS2L4rHJKXdDe+l/YviMUlp99neS/sXxmOS0u4zvZf2L47HJKXdZ3kv7b8AHpOUdp/hvbT/InhMUtqd9l7afyE8JintTnov7b8YHpOUdif8KL35gnhMUtp9tB+lN18Uj0lKu4/yo/Tmi+MxSWn3p34mvRsfk5R2v+tn09v5B49JSrtf9bPp7fwPj0lKu5/xK+n9EI9JSrtHfif9zzzEY5LS7l9/kv5vfojHpNPpm/NLeEw6lb41v4XHpI9O35g/wmPSn6T/mw/HY9KvpPdzHI9JSru5hsckpd1cw2OS0m6u4TFJaTfX8JiktJtreExS2s01PCYp7eYaHpOUdnMNj0lKu7mGxySl3VzDY5LSbq7hMUlpN9fwmKS0m2t4TFLazTU8Jint5hoek5R2cw2PSUq7uYbHJKXdXMNjktJuruExSWk31/CYpLSba3hMUtrNNTwmKe3mGh6TlHZzDY9JSru5hsckpd1cw2OS0m6u4TFJaTfX8JiktJtreExS2s01PCYp7eYaHpOUdnMNj0lKu7mGx6y3aTPX8Jj1Nm3mGh5nTuBx5gQeZ07gceYEHmdO4HHmBB5nTuBx5gQeZ07gceYEHmdO4HHmBB5nTuBx5gQeZ07gceYEHmdO4HHmBB5nPti3738BHyoaKTaEOZ4AAAAASUVORK5CYII=",name:at("带顿边单边U型焊缝")},{typeName:Ut.EndWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAACiCAYAAADC8hYbAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAZbSURBVHhe7coxamBBEENB3//S3g2NqFB8RDMPKunWz/9+n2cAj8/zNR6f52s8Ps/XeHyer/H4PF/j8Xm+xuPzfI3H5/kaj8/zNR6f52s8Ps/XeHyer/H4PF/j8Xm+xuPzfI3H5/kaj8/zNR6f52s8Ps/XeJyXadOQadPyN/2P43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8ThNadeQadOgtDuMx2lKu4ZMmwal3WE8TlPaNWTaNCjtDuNxmtKuIdOmQWl3GI/TlHYNmTYNSrvDeJymtGvItGlQ2h3G4zSlXUOmTYPS7jAepyntGjJtGpR2h/E4TWnXkGnToLQ7jMdpSruGTJsGpd1hPE5T2jVk2jQo7Q7jcZrSriHTpkFpdxiP05R2DZk2DUq7w3icprRryLRpUNodxuM0pV1Dpk2D0u4wHqcp7RoybRqUdofxOE1p15Bp06C0O4zHaUq7hkybBqXdYTxOU9o1ZNo0KO0O43Ga0q4h06ZBaXcYj9OUdg2ZNg1Ku8N4nKa0a8i0aVDaHcbjNKVdQ6ZNg9LuMB6nKe0aMm0alHaH8Tjvb/q3ZNq0/E3/43h8nq/x+Dxf4/F5vsbj83yNx+f5Go/P8zUen+drPD7P13h8nq/x+Dxf4/F5vsbj83yNx+f5Go/P8zUen+dDP7//AH3T0OK7CueMAAAAAElFTkSuQmCC",name:at("端接焊缝")},{typeName:Ut.SurfacingJoint,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKYAAACfCAYAAABz/aISAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAHxSURBVHhe7dKxbQNBAANB9d+0rAIWf/cRHQyBSTbm57cv/EMZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlhHWMsJaRljLCGsZYS0jrGWEtYywlvGK2dPqMy9kPDK7WX3nUsYjs5vVdy5lvGL2tPrMCxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYyXjF7Wn3mhYxHZjer71zKeGR2s/rOpYxHZqfVb17IeM2sVl95KSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEdYywlpGWMsIaxlhLSOsZYS1jLCWEYY+3z/ZxhhVTz23HAAAAABJRU5ErkJggg==",name:at("堆焊接头")},{typeName:Ut.BottomSeamWeld,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACpCAYAAACyCQZWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAOhSURBVHhe7dJZiuRIFAXR2v+ma6AoaGhz1xCSwiTZhfNjPBeZED9+72dyQxgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzETR4y+m00w5rdvjf6W/A/G1zGP/t5wfLw7j/6fF8L4SE8c/Z8vgfFRjhx9/xNHjr7/YBhv79PRN6/0yeh7D4TxtvaOvmWyd/Sth8B4O1tH37iLPaPv3BzG29gyen93W0ffuCmMeltG759oy+j9zWDUWjt6+xZrR29vBKPSmtG7t1o7ensDGFXWjN7lrzWjd3IYNZZGb8LWjN5JYfy6NaN3WbY0eiOE8auWRm+yzZrROxGMX7M0epP9lkZvJDBebmn0JsdYGr0RwHippdGbHG82uv8yjJeZje5zrqXRmy/BeInZ6D7XWBq9+QKMp5uN7nO92ej+YhhPNRvd53tmo/sLYTzNbHSf75uN7i+C8RSz0X08ZqP7C2A83Gx0H5/Z6P5kGA81G93HazS6PRnGw8xG9/EbjW5PhPEQs9F97mM0uj0JxkOMRre5n9Ho9gQYPzYa3ea+RqPbg2H8yGh0m3ubje4PhHG30eg2zzAa3R4I4y6j0W2eZTS6PQjGXUaj2zzPaHR7AIybjUa3eS4a3R0A42Y0usuzjUa3H8K4yWh0m+cbjW4/gHG10eg270Gjuw9gXI1Gd3mX0eh2J4yrjEa3eR8a3e2EcRUa3eW9aHS3A8ZFNLrLu9HobgeMi2h0l9DobiOMUzS6S/6g0d1GGKdodJf8Q6O7DTAO0egu+S8a3W2Acai1I0e/sZUwotaOHv3OVsKIWjt69DtbCeNQa0eOfmMrYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOY2GFM7DAmdhgTO4yJHcbEDmNihzGxw5jYYUzsMCZ2GBM7jIkdxsQOY2KHMbHDmNhhTOwwJnYYEzuMiR3GxA5jYocxscOYiP34+Qvm+ETtbiRVRQAAAABJRU5ErkJggg==",name:at("封底焊缝")},{typeName:Ut.FilletWeld,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAWNSURBVHhe7dLRduPWEURR//9PO+MkSsbyVouSWCAaqLPWfmkW+HT/+NWfVYvxWLUFj1Vb8Fi1BY9VW/BYtQWPVVvwWLUFj1Vb8Fi1BY9VW/BYtQWPVVvwWLUFj1Vb8Fi1BY9VW/BYtQWPVVvwWLUFj1Vb8HiYv9K96kE8HuJ92lR9gse4j9K2asBj3JT2VR/gMe6z9E0V8Bj3SPqu6h0e4x5N31b9hse4r6Tvq/6Lx7ivpv+o+oXHOPXR/a33/1H1C49xavrtrd//o+oXHuPUZ7+/9fuubo/HOPXI5q3327otHuPUo7u3tK/b4TFOafeXKe3rVniMU9q9mdK+boPHOKXd76a0r1vgMU5p996U9nV5PMYp7WRK+7o0HuOUdh+Z0r4ui8c4pd1kSvu6JB7jlHafmdK+LofHOKXdI6a0r0vhMU5p96gp7esyeIxT2n3FlPZ1CTzGKe2+akr7Wo/HOKXdd0xpX6vxGKe0+64p7WstHuOUdj8xpX2txGOc0u6nprSvdXiMU9o9w5T2tQqPcUq7Z5nSvtbgMU5p90xT2tcKPMYp7Z5tSvs6PR7jlHYJU9rXqfEYp7RLmdK+TovHOKVd0pT2dUo8xint0qa0r9PhMU5pd4Qp7etUeIxT2h1lSvs6DR7jlHZHmtK+ToHHOKXd0aa0r5fjMU5p9wpT2tdL8RintHuVKe3rZXiMU9q90pT29RI8xintXm1K+zocj3FKuzOY0r4OxWOc0u4sprSvw/AYp7Q7kynt6xA8xintzmZK+4rjMU5pd0ZT2lcUj3FKu7Oa0r5ieIxT2p3ZlPYVwWOc0u7sprSvp+MxTmm3wZT29VQ8xinttpjSvp6Gxzil3SZT2tdT8BintNtmSvv6MR7jlHYbTWlfP8JjnNJuqynt69t4jFPabTalfX0Lj3FKu+2mtK8v4zFOaXcFU9rXl/AYp7S7iint62E8xintrmRK+3oIj3FKu6uZ0r4+xWOc0u6KprSvEY9xSrurmtK+PsRjnNLuyqa0L+IxTml3dVPa1z/wGKe0u4Mp7etveIxT2t3FlPb1PzzGKe3uZEr7+jce45R2dzOlffkYp7S7oyntb47HOKXdXU1pf2M8xint7mxK+5viMU5pd3dT2t8Qj3FKu+oj/gSPcUq7+o8p7W+ExzilXf3flPY3wWOc0q7+bkr7G+AxTmlX/zSl/cXxGKe0K5vS/sJ4jFPa1cemtL8oHuOUdjWb0v6CeIxT2tXnprS/GB7jlHb1mCntL4THOKVdPW5K+4vgMU5pV18zpf0F8BintKuvm9J+OR7jlHb1PVPaL8ZjnNKuvm9K+6V4jFPa1c9Mab8Qj3FKu/q5Ke2X4TFOaVfPMaX9IjzGKe3qeaa0X4LHOKVdPdeU9gvwGKe0q+eb0v7keIxT2lXGlPYnxmOc0q5yprQ/KR7jlHaVNaX9CfEYp7SrvCntT4bHOKVdHWNK+xPhMU5pV8eZ0v4keIxT2tWxprQ/AR7jlHZ1vCntX4zHOKVdvcaU9i/EY5zSrl5nSvsX4TFOaVevNaX9C/AYp7Sr15vS/mA8xint6hymtD8Qj3FKuzqPKe0PwmOc0q7OZUr7A/AYp7Sr85nSPozHOKVdndOU9kE8xint6rymtA/hMU5pV+c2pX0Aj3FKuzq/Ke2fjMc4pV3tMKX9E/EYp7SrPaa0fxIe45R2tcuU9k/AY5zSrvaZ0v6HeIxr903v4Qd4jGv3Tm/im3iMa/dOb+KbeDxEu296D9/E4yHaPdNb+AEeq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqu24LFqCx6rtuCxagseq7bgsWoLHqsW+OPPfwEO3L8pilDAyQAAAABJRU5ErkJggg==",name:at("角焊缝")},{typeName:Ut.GrooveWeldSeam,img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALwAAAC7CAYAAADfTPQTAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAARxSURBVHhe7dIxaiVADAVB3//SXk+w8DGVSZHcDZW8UThfP30nfwjH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMVxTdU0/asBjmuqpulfDXBcUzVN/2qA45qqafpXAxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3yKN0NcFyjdJc8SncDHNco3SWP0t0AxzVKd8mjdDfAcY3SXfIo3Q1wXKN0lzxKdwMc1yjdJY/S3QDHNUp3yaN0N8BxjdJd8ijdDXBco3SXPEp3AxzXKN0lj9LdAMc1SnfJo3Q3wHGN0l3y3+90M8Bx1Wd6Tz59pvchjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+Sgr+9/dULPl8OKWbkAAAAASUVORK5CYII=",name:at("塞焊缝或槽焊缝")},{typeName:Ut.SpotWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOoAAADXCAYAAAAUcM09AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAeDSURBVHhe7dPbjhY3FAXhvP9Lk0AgIj9l98nTXtuukr6breVmBmn++qdvkuLhUVIWPErKgkdJWfAoKQseJWXBo6QseJSUBY+SsuBRUhY8SsqCR0lZ8CgpCx4lZcGjpCx4lJQFj5Ky4FFSFjxKyoJHSVnwKCkLHiVlwaOkLHiUlAWPkrLgUVIWPErKgkdJWfAoKQseFehp9E2VgUdNMiP6ORQHj3pJavSzaio86otUjX4XvQqPGmi16HfUl8OjHhoZff+u0dG/oS+BR93wNPrmm55E39NQeNQFd6NvpXgSfU+P4VEnXI2+UcWd6Du6DY/quBp9o7Kr0Td0GR4FrkTvV3Mleq9L8KjfXIne7+Bs9Fan4FE/nY3e7uhs9FZdeNze2eitzv3/0Ts14XFrZ6J3+tOZ6J3+gMctnYne6dhR9Eb/g8ftHEVvdM2Z6J1+wONWjqI3uu8oeiM+bqMX7TXGUfRmc3hc3lH0RuP1ov3G8Li0o+iNvs5R9GZDeFxWL9rrHUfRm83gcUm9aK/39aL9RvC4nF601zy9aL8JPC6lF+01Xy/abwCPy+hFe+XoRfvF4XEJvWivPL1ovzA8lteL9srVi/aLwmNpvWivfK1ouyg8ltaKtqqjFW0XhMeyWtFW9bSi7WLwWFIr2qquVrRdCB7LaUVb1deKtovAYymtaKs1tKLtIvBYSivaah2taLsAPJbRirZaTyvaFofHElrRVuuiaFccHkugaKe1taJtYXiM14q2Wl8r2haFx2itaKt9ULQrCo/RKNppL61oWxAeY7WirfZD0a4gPMaiaKd9UbQrBo+RKNppbxTtisFjJIp2EkW7QvAYh6Kd9B1Fu0LwGIeinfQLRbsi8BiFop30u1a0LQCPUSjaSZ8o2hWAxxgU7SRC0a4APMagaCe1ULQLh8cYFO2kFop24fAYgaKd1NOKtsHwGIGinXSEol0wPE5H0U46g6JdMDxOR9FOOouiXSg8TkfRTjqLol0oPE5F0U66gqJdKDxORdFOuoqiXSA8TkXRTrqKol0gPE71GW2kOyjaBcLjNBTtpDso2gXC4zQU7aS7KNqFweM0FO2kuyjahcHjNJ/RRnqCol0YPE5B0U56gqJdGDxOQdFOeuoz2oTB4xQU7aSnKNoFweMUFO2kpyjaBcHjFBTtpKco2gXB4xSf0UYagaJdEDy+jqKdNAJFuyB4fB1FO2mUz2gTBI+vo2gnjfIZbYLg8XUU7aRRKNqFwOPrKNpJo1C0C4HH11G0k0ahaBcCj6+jaCeNQtEuBB5fR9FOGoWiXQg8dpnZ+ehv6AY8NpnZtejv6AY8NpnZtejv6AY8dpnZ+ehv6AY8vo6inTQKRbsQeHwdRTtpFIp2IfD4Oop20igU7ULg8XUU7aRRKNqFwOPrKNpJo1C0C4HH11G0k0b5jDZB8Pg6inbSKJ/RJggeX0fRThqBol0QPE7xGW2kESjaBcHjFJ/RRhqBol0QPE5B0U56iqJdEDxOQdFOeoqiXRA8TkHRTnrqM9qEweMUFO2kpz6jTRg8TvMZbaQnKNqFweM0FO2kuyjahcHjNBTtpLso2oXB4zQU7aS7PqNNIDxO9RltpDso2gXC41QU7aSrKNoFwuNUFO2kqyjaBcLjVBTtpCso2oXC43QU7aSzKNqFwuN0FO2ksyjahcLjdBTtpDMo2gXDYwSKdtIRinbB8BiBop10hKJdMDxGaEVbqYWiXTg8xqBoJ7VQtAuHxxgU7SRC0a4APEahaCd9omhXAB6jULSTfteKtgXgMQ5FO+kXinZF4DEORTvpu1a0LQKPkSjaSRTtCsFjJIp22lsr2haCx1gU7bQvinbF4DFWK9pqP61oWwweo1G0015a0bYgPEZrRVvtg6JdUXiM14q2Wl8r2haFxxIo2mltrWhbGB5LaEVbrYuiXXF4LKMVbbWeVrQtDo9ltKKt1tKKtgvAYymtaKs19KL9AvBYTivaqr5WtF0EHktqRVvV1Yq2C8FjWa1oq3pa0XYxeCyrFW1VSyvaLgiPpbWirWroRfsF4bG8VrRVtl60XxQel9CKtsrUi/YLw+MyWtFWWXrRfnF4XEor2ipDL9pvAI/L6UV7zdOL9pvA45J60V7v60X7jeBxWb1or/f0ov1m8Li0XrTX1zqK3mwIj8s7it5ovKPozabwuIWj6I3G6UX7zeFxK0fRG913FL0RH7dzFL3RdUfRG/2Axy2did7p2Jnonf6Dx60dRW/EzkTv9Ac8bu9M9E7/Ohu9FcKjfjoTvdvV2eituvCo35yN3u7iSvReh/AocCV6v6Ir0Xudhkd1XIneV3c1+oYuw6NOuBp9o5Kr0Td0Gx51wZ3oO2nuRt/SY3jUDU+i783wJPqehsGjHhgZfX+EUdG39SXwqEFWjX5XfSk86gtUj34nvQaPekF69DNrGjxqgtnRz6QYeFSQkdH3VQIeJWXBo6QseJSUBY+SsuBRUhY8SsqCR0lZ8CgpCx4lZcGjpCx4lJQFj5Ky4FFSFjxKyoJHSVnwKCkLHiVlwaOkLHiUlAWPkrLgUVIWPErKgkdJWfAoKcZf3/4GIK9JdCFPKLgAAAAASUVORK5CYII=",name:at("点焊缝")},{typeName:Ut.FoldingInterface,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACtCAYAAAApmERAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAATfSURBVHhe7dLhjts6DAXhvv9L9xbForjrjBw7S5GUPAN8fw6ooNn0159+SwvCUeoOR6k7HKXucJS6w1HqDkepOxyl7nCUusNR6g5HqTscpe5wlLrDUeoOR6k7HKXucJS6w1HqDkepOxyl7nCUusNR6g5HqTscpe5wlLrDMZT9LPqbiscwNjf6mz8EjmEsN/oNNoVjGKuJfovN4BjK6qLfYxM4qqmfRJ+3MBy1iLvRZywKRy3qavR2MThqcVeidwvBUZu4Er1bAI7azLvoTXM4akPvojeN4aiNnUX3TeGozZ1F9w3hqAc4i+6bwVEPcRbdN4KjHuQsum8CRz3MKLptAkc90Ci6bQBHPdQoui2Gox5sFN0WwlEPNopuC+GohxtFt0VwlL7+q36P7orgKH39V32NbgvgKP1F0V0BHKW/RtFtMhylfyi6S4aj9M8ouk2Eo/QNRXeJcJS+oeguEY7Si2N0kwhH6QVFd0lwlF5QdJcER+kFRXdJcJTQMbpJgqOEKLpLgKOEKLpLgKOEKLpLgKOEKLpLgKOEKLpLgOMjdI/+zdUoukuA41ZWjr5PJYruEuC4tJ2i71ftGN0kwHE5u0bftRJFdwlwXMbO0fetRtFdAhzb+zT6LF1H0V0CHNu6G32GPkfRXQIcW7oavVUMiu4S4NjOleidYlF0lwDHNq5E7zQHRXcJcGzhXfRGc1F0lwDHcu+iN5qLorskOJY6i+6Vg6K7JDiWOYvulYeiuyQ4lhhFt8p3jG4S4ZhuFN0qH0V3iXBMNYpuVYOiu0Q4phlFt6oxim4T4ZiGojvVoeguGY4pRtGtaoyi22Q4TjeKblWHorsCOE5H0Z1qUXRXAMepRtGt6lB0VwTHqSi6U51RdFsEx2koulMtiu4K4TgNRXeqM4puC+E4BUV3qjOKbovhOAVFd6oxim4bwDEcRXeqMYpum8AxHEV3yncW3TeBYziK7pTrLLpvBMdQFN0p11l03wyOoSi6U56z6L4hHENRdKccZ9F9UziGOkY3mu9d9KYxHMNQdKe53kVvmsMxDEV3muNK9G4BOIah6E6xrkTvFoJjGIruFONq9HYxOIah6E6fuxO9XxSOYY7Rje75NPqsheEY5hjddLBz9H03gGOYY3RTbcfoe24GxzDH6KbSbtF33BSOYY7RTbWVo+/zEDiGOUY3HXSP/s0Ph2OYY3QjfQDHMBTdSTfhGIaiO+kmHMNQdCfdhGMYiu6km3AMQ9GddBOOoY7RjXQTjqEoupNuwDEURXfSDTiGouhOugHHcBTdSRfhGI6iO+kiHMNRdCddhOMUFN1JF+A4BUV30gU4TkPRnfQGjtNQdCe9geNUFN1JJ3CcahTdSgM4TkfRnTSA43Sj6FYCOKYYRbfSAY5pKLqTDnBMM4pupf/BMdUoupW+4JhuFN1Kf+BYYhTd6vFwLHMW3euxcCx1Ft3rkXAsdxbd63FwbOFd9EaPgWMbV6J32h6O7VyJ3mlbOLZ0NXqr7eDY1t3oM7QFHNv7NPosLQnHZVht9JskwXE5Vhf9HglwXJrlRr9BAhy3YnOjv3kCHB/Bfh79XZPgKHWHo9QdjlJ3OErd4Sh1h6PUHY5SdzhK3eEodYej1B2OUnc4St3hKHWHo9QdjlJ3OErd4Sh1h6PUHY5SdzhKjf36/R9vDJRU5LBTnQAAAABJRU5ErkJggg==",name:at("折叠接口")},{typeName:Ut.InclinedInterface,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAK0AAAC3CAYAAABg4t6+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAWfSURBVHhe7cpbjhxXDERB73/TtmAIwngclObR1c2blQeIHzL/+tHfVYfhsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxHuxt+id6nzZfxGM9kNIuidLui3isB5nSNonS7ot4rAdR2iWZ0vaLeKwHmNI2idLuG3isB1DaJZnS9ht4rG+a0jaJ0u6beKxvUtolmdL2m3isb5jSNonS7gF4rG9Q2iWZ0vYBeKwvmtI2idLuQXisL1LaJZnS9kF4rC+Y0jaJ0u6BeKwvUNolmdL2gXisT5rSNonS7sF4rE9S2iWZ0vbBeKxPmNI2idLuAjzWJyjtkkxpewEe64OmtE2itLsIj/VBSrskU9pehMf6gCltkyjtLsRjfYDSLsmUthfisf5gStskSruL8Vh/oLRLMqXtxXis35jSNonS7gl4rN9Q2iWZ0vYJeKzBlLZJlHZPwmMNlHZJprR9Eh4LprRNorR7Ih4LlHZJprR9Ih7rnSltkyjtnozHekdpl2RK2yfjsd6Y0jaJ0u4FeKw3lHZJprR9AR7rpyltkyjtXoTH+klpl2RK2xfhsX6Y0jaJ0u6FeKwflHZJprR9IR5vb0rbJEq7F+Px9pR2Saa0fTEeb21K2yRKuwV4vDWlXZIpbRfg8bamtE2itFuCx9tS2iWZ0nYJHm9pStskSrtFeLwlpV2SKW0X4fF2prRNorRbhsfbUdolmdJ2GR5vZUrbJEq7hXi8FaVdkiltF+LxNqa0TaK0W4rH21DaJZnSdikeb2FK2yRKu8V4vAWlXZIpbRfjMd6UtkmUdsvxGE9pl2RK2+V4jDalbRKl3QF4jKa0SzKl7QF4jDWlbRKl3SF4jKW0SzKl7SF4jDSlbRKl3UF4jKS0SzKl7UF4jDOlbRKl3WF4jKO0SzKl7WF4jDKlbRKl3YF4jKK0SzKl7YF4jDGlbRKl3aF4jKG0SzKl7aF4jDClbRKl3cF4jKC0SzKl7cF4PN6UtkmUdofj8XhKuyRT2h6Ox6NNaZtEaReAx6Mp7ZJMaRuAx2NNaZtEaReCx2Mp7ZJMaRuCxyNNaZtEaReExyMp7ZJMaRuEx+NMaZtEaReGx+Mo7ZJMaRuGx6NMaZtEaReIx6Mo7ZJMaRuIx2NMaZtEaReKx2Mo7ZJMaRuKxyNMaZtEaReMxyMo7ZJMaRuMx/WmtE2itAvH43pKuyRT2objcbUpbZMo7W6Ax9WUdkmmtL0BHtea0jaJ0u4meFxLaZdkStub4HGlKW2TKO1uhMeVlHZJprS9ER7XmdI2idLuZnhcR2mXZErbm+FxlSltkyjtbojHVZR2Saa0vSEe15jSNonS7qZ4XENpl2RK25vicYUpbZMo7W6MxxWUdkmmtL0xHl9uStskSrub4/HllHZJprS9OR5fakrbJEq78vGllHZJprQtH19mStskSrv6F48vo7RLMqVt/YvHl5jSNonSrn7h8SWUdkmmtK1feHy6KW2TKO3qP3h8OqVdkilt6z94fKopbZMo7ep/eHwqpV2SKW3rf3h8miltkyjtinh8GqVdkilti3h8iiltkyjtasTjUyjtkkxpWyMeLzelbRKlXf0Wj5dT2iWZ0rZ+i8dLTWmbRGlXf8TjpZR2Saa0rT/i8TJT2iZR2tWH8HgZpV2SKW3rQ3i8jNIuidKuPozHy7xPmzRKu/owHi/zPm0SvU3/+hQeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHqs247FqMx6rNuOxajMeqzbjsWozHquW+uvvfwAguGJAxsc1MAAAAABJRU5ErkJggg==",name:at("倾斜接口")},{typeName:Ut.SpotWeldSeamOffset,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADaCAYAAAA149drAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAeMSURBVHhe7dNJbiA3EAXRvv+lbTc8oF0dZA3J5BgBvE3isyQt9OOv/pCUAo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwKCkOj5Li8CgpDo+S4vAoKQ6PkuLwqEGi0Tc1DB6VZHT0OykNHtXIzNHvq6bwqI9Wjv4eheBRL+wa/a16BY+60TL6fgutom/rETyqIBJ9r7dI9D1V4VEXX6NvzeRr9C39Bo/6x9voG6v4En1H/8Hj8d5E73fwJnovPh7pbfSNHb2J3h8Mj8d5Gr09xZvo/YHweIyn0dtTPY3eHgaPR3gSvdPfnkTvDoLH7d1Fb8SeRO8OgMdt3UVv9Mxd9GZzeNzSXfRG7zyJ3m0Kj1u5i94o5i56syE8buMueqM2nkTvNoLHLdxFb9TeXfRmE3hcXi3aK9dd9GYDeFxaLdqrn1q0Xxwel1WKthqjFu0XhscllaKtxqpF+0XhcTmlaKs51KL9gvC4lFK01Vxq0X4xeFxGKdpqTrVovxA8LqEUbTW3WrRfBB6nV4q2WkMt2i8Aj1MrRVutpRRtF4DHaZWirdZUiraTw+OUStFWaytF24nhcUqlaKv1laLtpPA4nVK01R5K0XZSeJxKKdpqL6VoOyE8ToWinfZUiraTweM0StFW+6JoNxk8TqEUbbW3UrSdCB6nQNFOZyhF20ngcbhStNU5KNpNAo9DlaKtzlKKthPA41AU7XSmUrQdDI/DlKKtzkXRbjA8DkPRTmcrRduB8DhEKdpKFO0GwuMQFO2knyjaDYTH7krRVvoXRbtB8NgdRTvpVxTtBsFjV6VoK11RtBsAj11RtJMIRbsB8NgVRTuphKJdZ3jshqKdVEPRrjM8dkPRTrpD0a4jPHZB0U56gqJdR3jsgqKd9ARFu47w2AVFO+kpinad4DEdRTvpDYp2neAxHUU76Q2Kdp3gMR1FO+ktinYd4DHdNdpIX1C06wCPqSjaSV9QtOsAj6ko2klfULTrAI+pKNpJX1G0S4bHNBTtpAiKdsnwmIainRRB0S4ZHtNQtJOirtEmGR7TULSToijaJcJjCop2UgsU7RLhMQVFO6kFinaJ8JiCop3UAkW7RHhMQdFOaoGiXSI8pqBoJ7VA0S4RHlNQtJNauUabRHhMQdFOauUabRLhMQVFO6mVa7RJhMcUFO2kVijaJcFjimu0kVqiaJcEjymu0UZqiaJdEjymuEYbqSWKdknw2BxFO6klinZJ8NgcRTupJYp2SfDYHEU7qSWKdknw2BxFO6klinZJ8NgcRTupJYp2SfCY4hptpJYo2iXBY4prtJFaomiXBI8prtFGaomiXRI8pqBoJ7VC0S4JHlNQtJNauUabRHhMQdFOauUabRLhMQVFO6kFinaJ8JiCop3UAkW7RHhMQdFOaoGiXSI8pqBoJ7VA0S4RHlNQtJNaoGiXCI9prtFGaoGiXSI8pqFoJ0VRtEuExzQU7aQIinbJ8JiGop0UQdEuGR5TUbSTvqJolwyPqSjaSV9do00HeExF0U76gqJdB3hMRdFO+oKiXQd4TEfRTnqLol0HeExH0U56g6JdJ3hMR9FOeoOiXSd47OIabaQ3KNp1gscuKNpJT1G06wSPXVC0k56gaNcRHrsoRVvpDkW7jvDYDUU7qYaiXWd47KYUbaUSinad4bErinYSKUXbzvDYFUU7iVC0GwCP3VG0k35VirYD4LE7inbSryjaDYLHISjaST+Vou0geByCop30E0W7gfA4DEU7iaLdQHgchqKdzkbRbjA8DkXRTmcqRdvB8DhUKdrqPBTtJoDH4Sja6SylaDsBPA5XirY6QynaTgKPUyhFW+2Pot1E8DiNUrTVvkrRdiJ4nEYp2mpPpWg7GTxOpRRttZdStJ0QHqdTirbaRynaTgiPU6Jopz2Uou2k8DilUrTV2krRdmJ4nFYp2mpNpWg7OTxOrRRttZZatJ8cHqdWi/ZaQy3aLwCP06tFe82tFu0Xgccl1KK95lSL9gvB4zJq0V5zqUX7xeBxKbVorznUov2C8LicWrTXWLVovyg8LqkW7TVGLdovDI/LqkV79VWL9ovD49LuojfKV4v2G8Dj8u6iN8pxF73ZBB638CR6p3buojcbweNW7qI3inkSvdsMHrdzF73RN3fRm03hcVt30Rs98yR6tzE8bu0ueqO6u+jNAfC4vSfRO/3fk+jdIfB4jKfR25M9id4dBo9HeRO9P8nT6O2B8HikN9H7nb2J3h8Kj0d7E73fxdvoG4fDo/7yNvrGit5E7/UfPOoXX6LvzOpL9B39Bo8Ckeh7o0Si76kIj6poEX03UzT6pm7hUQ9lRz/zXz2in6vH8KgPdoj+Ln2GRzWwSvS7qwk8qrGZot9PKfCoTrKjn6lu8KgJ+c+yHDxKisOjpDg8SorDo6Q4PEqKw6OkODxKisOjpDg8SorDo6Q4PEqKw6OkODxKisOjpDg8SorDo6Q4PEqKw6OkODxKisOjpDg8Sgr58cefJsbWo2zdXpgAAAAASUVORK5CYII=",name:at("点焊缝（偏移中心）")},{typeName:Ut.SeamWeld,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAASkAAAEWCAYAAAA6tWH6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAmsSURBVHhe7dNZDtxGEARR3f/SsmzAsEVFc5lpklXZEcD7SVRTCzA/fvVTkgrDUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUZKqwFGSqsBRkqrAUdr1bfRNaQBHLapa9HfUcnDUIjpFf38tAUcFS4n+bYqEo4KsEv3bFQFHNXZX9GfNcFf0Z6klHNXMrOjbb5oRfVet4Kgmvo2+Wdk30ffUAo4q7tPoW519Gn1LZeGooq5G30j1SfQdlYOjirkSvV/Rlei9ysBRRVyJ3sv/wwA46mVXovf605XovV6Do15yJXqvY1ei93ocjnrYlei9rjsbvdWjcNSDzkTvNMfZ6K0egaMechS90X2Ooje6HY662VH0Rs84E73TbXDUjY6iN3reUfRGt8BRNziK3uhdZ6J3mgpHTXYUvVEdR9EbTYOjJjkTvVM9R9EbTYGjJjiK3qi+o+iNvoKjvnQUvVEfR9EbfQxHfWEvuldPR9EbfQRHfWgvuld/e9G9LsNRHxhFt8qyF93rEhx10Si6Vaa96F6n4agLRtGtsu1F9zoFR500im61hr3oXodw1Amj6FZr2YvutQtHHRhFt1rTXnSvIRy1YxTdam170b0QjhoYRbfS3/aie/0BR4FRdCv93150r9/gOJWZZUe/+4lwnMrM8qPf/iQ4TmVm+dFvfxIcpzKz/Oi3PwmO05lZbvSbnwjH5Y2iW+lTFN0tDsflUXQnfWMU3S4Mx6WNolvpW6PodlE4LmsU3UqzjKLbBeG4LIrupJlG0e2CcFzSKLqVZhtFt4vBcTmj6Fa6yyi6XQiOSxlFt9LdKLpbCI5LGUW30t1G0e0icFzGKLqVnjKKbheA4zIoupOeRtHdAnBcAkV30htG0W04HJdA0Z30ForuwuEYj6I76U2j6DYYjvEoupPeRtFdMByjjaJb6W0U3QXDMRpFd1IVFN2FwjHWKLqVqqDoLhSOsSi6k6qh6C4QjpFG0a1UDUV3gXCMRNGdVBVFd2FwjDOKbqWqKLoLg2Mciu6k6ii6C4JjHIrupOoouguCYxSK7qQORtFtCByjUHQndUHRXQgcY1B0J3VC0V0IHGNQdCd1Q9FdABxjUHQndUPRXQAcY1B0J3VD0V0AHCNQdCd1RNFdABwjUHQndUXRXXM4RqDoTuqKorvmcIywjW6kzii6aw7H9ii6k7rbRjfN4dgeRXdSdxTdNYZjexTdSd1RdNcYju1toxspAUV3jeHYGkV3UoptdNMYjq1RdCeloOiuKRxbo+hOSkHRXVM4tkXRnZSEorumcGyLojspzTa6aQrHtii6k9Jso5umcGyLojspDUV3DeHYFkV3UhqK7hrCsS2K7qQ0FN01hGNbFN1JaSi6awjHtii6k9JQdNcQjm1toxspEUV3DeHY1ja6kRJRdNcQjm1toxspEUV3DeHYEkV3UqptdNMQji1RdCel2kY3DeHYEkV3UqptdNMQji1RdCelouiuGRxbouhOSkXRXTM4TmVm2dHvfiIcpzGz/Oi3PxGO05hZfvTbnwjHacwsP/rtT4TjdGaWGf3eJ8OxJYrupFTb6KYhHFui6E5KtY1uGsKxJYrupFTb6KYhHNvaRjdSIoruGsKxrW10IyWi6K4hHNvaRjdSIoruGsKxLYrupDQU3TWEY1sU3UlpKLprCMe2KLqT0lB01xCObVF0J6Wh6K4hHNui6E5KQ9FdQzi2RdGdlIaiu4ZwbIuiOynNNrppCse2KLqT0myjm6ZwbG0b3UhJKLprCsfWKLqTUlB01xSOrVF0J6Wg6K4pHFuj6E5KQNFdYzi2R9Gd1B1Fd43h2B5Fd1J3FN01hmN7FN1J3VF01xiO7VF0J3VG0V1zOEag6E7qiqK75nCMQNGd1BVFd83hGIGiO6mrbXQTAMcY2+hG6oiiuwA4xqDoTuqGorsAOMag6E7qhqK7ADjGoOhO6mYb3YTAMQpFd1IXFN2FwDEKRXdSFxTdhcAxyii6laqj6C4IjnEoupOqo+guCI5xKLqTKqPoLgyOkSi6k6qi6C4MjpEoupMqGkW3YXCMRdGdVA1Fd4FwjEXRnVTJKLoNhGM0iu6kKii6C4VjNIrupApG0W0oHONRdCe9jaK7YDjGo+hOehtFd8FwjDeKbqW3UHQXDsclUHQnvYWiu3A4LmEU3UpPo+huATgug6I76Umj6HYBOC5jFN1KT6HobhE4LmUU3Up3G0W3i8BxOaPoVrrLKLpdCI7LGUW30l0oulsMjksaRbfSbKPodjE4LmsU3UqzjKLbBeG4NIrupBlG0e2icFzaKLqVvkXR3cJwXN4oupU+NYpuF4ajfqHoTvrEKLpdHI5TmVl29LufCMepzCw/+u1PguNUZpYf/fYnwXEqM8uPfvuT4DidmWVGv/fJcBTYi+6lf+1F9/oNjhrYi+6lvehef8BRO/aie61rL7oXwlEH9qJ7rWcvutcQjjphL7rXOvaie+3CUSftRffKtxfd6xCOumAvuleuvehep+Coi/aie+XZi+51Go76wF50rxx70b0uwVEfOoreqK+j6I0uw1FfOIreqJ+j6I0+gqO+dBS9UQ9nonf6GI6a5Ch6o7qOojf6Go6a6Ch6o1rORO80BY6a7Ez0Tu87it5oKhx1k6Pojd5zFL3RdDjqRmeid3rOUfRGt8FRDziK3uh+R9Eb3QpHPeRM9E5znY3e6nY46mFnonf6ztnorR6Do15wJXqv865E7/UoHPWiK9F7jV2J3usVOKqAK9F7/edK9F6vwlGFXIner+xK9F4l4KiCrkTvV3E1+oZKwVGFfRJ9J8kn0XdUEo5q4Jvoe518E31PpeGoRmZE363k2+ibagNHNTUj+u7TZkXfVjs4KsBT0Z9Nnor+bLWGowKlRv9WRcFR4TpH/x5Fw1GLqR79nbUMHKV/PB39HbQ8HKWPbKMb6SIcJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJakKHCWpChwlqQocJamAHz//AmoSckzD+QH2AAAAAElFTkSuQmCC",name:at("缝焊缝")},{typeName:Ut.SeamWeldOffset,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAARsAAAD/CAYAAADBj3IBAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAhKSURBVHhe7dTLrhvJFQVR//9Pt+WGbaipKBYfh7xk5gpgTTZOlqQB9a9f/QXwBjkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI8C0HAGm5QgwLUeAaTkCTMsRYFqOANNyBJiWI/x1rbqHEzmyqJ+o/h5sKUcW8mnV35Et5MgX+7bq38CScuSLrFT9+1hGjny4V1Z/3jWvqv4svlqOfKhnq2++2kT1Xb5OjnyYR6tv/bRnqu/xNXLkQzxSfeeTPVJ9h4+XIz/snur9N7unes/HypEfcG/1jZXcU73n4+TIG91TvV/dPdV7PkaOvMmt1dvd3Fq95SPkyBvcUr3b3a3VW35UjrzQLdU7/nRWveHH5MiLnFVvuO6W6h1vlyPDbqnecbuz6g1vlSODzqo3POaW6h1vkSNDzqo3PO+sesPL5ciTzqo3zDqr3vBSOfKEs+oNr3OtuudlcuRB16p73uNadc9L5MgDrlX3vNe16p5xOXKna9U9P+eoumVUjtzhWnXPzzuqbhmTIze6Vt3zOY6qW0bkyA2uVfd8nqPqlqflyIlr1T2f66i65Sk5csW16p7Pd1Td8rAcOXCtuud7HFW3PCRHDhxVt3yfo+qWu+VIOKpu+V5H1S13yZELR9Ut36+qO+6SI785qm5Zw1F1y81y5DdH1S3rOKpuuUmO/NdRdct6qrrjJjnyy1F1y5qOqltO5cgvVd2xtqPqlqty3N5Rdcv6jqpbDuW4taPqlj0cVbccynFrVd2xl6PqlpTjto6qW/ZT1R0px21Vdce+qrrjDzluqao79lbVHX/IcUtV3UFVd/xDjtup6g7+o6o7/iHH7VR1B/9T1R3/l+NWqrqD31V1x//luJWq7uBSVXf8LcdtVHUHpao7/pbjNqq6g3JU3dLjFo6qWzhS1R09bqGqO7jmqLrdXI6nJK1d/e6flOMpSetXv/0n5HiVpD2q3/8Tcjwlaf3qt/+EHG8iac3q9z4gx6VVdQf3uqxuNpbj0qq6g3tVdbepHJdV1R08oqq7TeW4rKru4BFV3W0qx2VVdQePqupuQzkuq6o7eFRVdxvKcUlV3cEzqrrbUI5LquoOnlHV3YZyXFJVd/Csqu42k+OSLqsbmFDV3WZyXNJldQMTqrrbTI7LqeoOJlR1t5kcl1PVHUyo6m4zOS6nqjuYclndbCbH5VR1B1Muq5vN5Licqu5gymV1s5kcl1PVHUyp6m4jOS6nqjuYUtXdRnJcTlV3MKWqu43kuJzL6gYmVXW3kRyXc1ndwKSq7jaS43IuqxuYVNXdRnJcSlV3MKmqu43kuJSq7mBSVXcbyXEpVd3BpKruNpLjci6rG5hU1d1GclzOZXUDk6q620iOy7msbmBSVXcbyXE5Vd3BlKruNpLjcqq6gylV3W0kx+VUdQdTqrrbSI7LqeoOplxWN5vJcTlV3cGUy+pmMzkup6o7mHJZ3Wwmx+VUdQcTqrrbTI7LqeoOJlR1t5kcl1PVHUyo6m4zOS7psrqBCVXdbSbHJVV1B8+q6m4zOS6pqjt41mV1s6Ecl1TVHTyjqrsN5bisy+oGnlHV3YZyXFZVd/Coqu42lOOyqrqDR1R1t6kcl1XVHTyiqrtN5bi0qu7gXlXdbSrHpVV1B/eq6m5TOS6tqju4R1V3G8txaVXdwT2quttYjsur6g5uVdXdxnJcXlV3cIuq7jaX4/KOqls4U9Xd5nLcQlV3cKaqu83luIWq7uCaqu7ocRtV3cGRqu7ocRtV3UGp6o6/5XgTSWtWv/cBOZ6StH71239CjldJ2qP6/T8hx1OS1q9++0/I8ZSktavf/ZNy3FJVd+ztqLrlH3Lc0lF1y76quuMPOW6rqjv2dFTd8occt3VU3bKXo+qWlOPWjqpb9lHVHYdy3N5Rdcv6jqpbDuXIL1Xdsbaj6parcuSXo+qWdVV1x6kc+a+j6pb1HFW3nMqR31R1x1qOqltukiO/OapuWcNRdcvNcuTCUXXL96vqjrvkSDiqbvleR9Utd8mRcK265/scVbfcLUcOXKvu+R5H1S0PyZErrlX3fL6j6paH5ciJa9U9n+uouuUpOXKDa9U9n+eouuVpOXKja9U9n+OoumVEjtzhWnXPzzuqbhmTI3e6Vt3zc46qW0blyAOuVfe831F1y7gcedC16p73uFbd8xI58oSz6g2vc62652Vy5Eln1RtmnVVveKkcGXBWvWHGWfWGl8uRQWfVGx53Vr3hLXJk2Fn1hvucVW94qxx5kbPqDefOqje8XY680C3VO/50S/WOH5EjL3Zr9Rb/yXypHHmTW6u3O7q1esuPy5E3uqd6v7p7qvd8jBz5AfdU71dzb/UNPkqO/KB7qvff7p7qPR8rRz7AI9V3vsG91Tf4eDnyQZ6pvvcJHq2+xdfIkQ/1TPW9d3m2+iZfJ0c+3HT1Z9zrFdWfw9fKkS+yWvVvZAk58qW+sfp3sKQcWcSnVn9Xlpcji/qp6u/CdnJkY/dU7+FAjgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5AkzLEWBajgDTcgSYliPAtBwBpuUIMC1HgGk5Agz611//Bmp8EmEmP0iZAAAAAElFTkSuQmCC",name:at("缝焊缝（偏离中心）")},{typeName:Ut.SteepVWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALkAAACyCAYAAAAeam6fAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAVgSURBVHhe7dJLbhhHEERB3f/Ssi0DEigGIYrkdNcnHxCbQq6m59u/fY8YjseISXiMmITHiEl4jJiEx4hJeIyYhMeISXiMmITHiEl4jJiEx4hJeIyYhMeISXiMmITHiEl4jJiEx4hJeIyYhMeISXiMmITHiEl4jJiEx4hJeHzUf+ke8xR5ax4f83vaxAy/p80hPD5CaRf9Ke0O4fERSrvoT2l3CI+PUdpFX0q7g3h8jNIu+lLaHcTjY5R20ZfS7iAeH6W0i36Udofx+CilXfSjtDuMx8cp7aIXpd1hPD5OaRd9KO0u4PFxSrvoQ2l3AY9HKO2iB6XdBTweobSL+pR2l/B4hNIu6lPaXcLjMUq7qE1pdwmPxyjtoi6l3UU8HqO0i7qUdhfxeJTSLupR2l3G41FKu6hHaXcZj0cp7aIepd1lPB6ntIs6lHYF8Hic0i7qUNoVwOMVSruoQWlXAI9XKO3iPqVdETxeobSL+5R2RfB4jdIu7lLaFcHjNUq7uEdpVwiP1yjt4h6lXSE8XqW0izuUdoXweJXSLs5T2hXD41VKuzhPaVcMj9cp7eIcpV1BPF6ntItzlHYF8Xid0i7OUdoVxGMJSrt4ntKuKB5LUNrF85R2RfFYhtIunqW0K4rHMpR28RylXWE8lqG0i+co7QrjsRSlXTxDaVcYj6Uo7eLrKe2K47EUpV18PaVdcTyWo7SLr6W0K47HcpR28XWUdg3wWI7SLr6O0q4BHktS2sXnKe2a4LEkpV18ntKuCR5LUtrF5yntmuCxLKVdfJzSrhEey1Laxccp7RrhsTSlXXyM0q4RHktT2sXfU9o1w2NpSrv4e0q7ZngsT2kXf0dp1wyP5Snt4v2Udg3xWJ7SLt5PadcQjy0o7eJ9lHYN8diC0i7+TGnXFI8tKO3iz5R2TfHYhtIu3qa0a4zHNpR28TalXWM8tqG0i7cp7RrjsRWlXbymtGuOx1aUdvGa0q45HttR2sVLSrvmeGxHaRe/KO0G4LEdpV38orQbgMeWlHbxP6XdADy2pLSLdd+Kx5aUdpGfvDWl3XZKuyF4bEtpt5nSbhAe21Labaa0G4TH1pR2GynthuGxNaXdRkq7YXhsTWm3kdJuGB7bU9ptorQbiMf2lHabKO0G4nEEpd0WSruBeBxBabeB0m4oHkdQ2m2gtBuKxzGUdtMp7YbicQyl3WRKu8F4HENpN5nSbjAeR1HaTaW0G4zHUZR2EynthuNxFKXdREq74XgcR2k3idJuAR7HUdpNorRbgMdxlHaTKO0W4HEkpd0ESrsleBxJaTeB0m4JHsdS2nWntFuCx7GUdp0p7RbhcSylXWdKu0V4HE1p15XSbhEeR1PadaS0W4bH0ZR2HSntluFxPKVdN0q7ZXgcT2nXidJuIR7HU9p1orRbiMcVlHYdKO2W4nEFpV0HSruleFxBadeB0m4pHtdQ2lWmtFuMxzWUdpUp7RbjcRWlXVVKu8V4XEVpV5HSbjkeV1HaVaS0W47HdZR21SjtluNxHaVdJUq78HEdpV0lSrvwcSWlXRVKu/BxJaVdBUq7+IHHlZR2FSjt4gce11La3aS0i594XEtpd5PSLn7icS2l3U1Ku/iJx9WUdjco7eIFHldT2t2gtIsXeFxPaXea0i5e4HE9pd1JSrt4hcfy0pn07RvisbR0Nr1BMzyWls6mN2iGx9LS2fQGzfBYXjqXvn8zPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEJDxGTMJjxCQ8RkzCY8QkPEZMwmPEEN++/wNOQL1V0LJ5GQAAAABJRU5ErkJggg==",name:at("陡侧V型坡口堆焊")},{typeName:Ut.none,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:at("清除"),isChecked:!0}]),l=V.reactive([{typeName:Ut.FirstPlaneSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJ8AAACfCAYAAADnGwvgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAHcSURBVHhe7dGxDQJBAANB+m8aKGCje2Gk01iaZFO/vnvDn2SEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCxmN29+rzBzIes/tXvx/KeMzuX/1+KOMxu3v1+QMZH7E7V18/lBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZYSEjLGSEhYywkBEWMsJCRljICAsZ4cde7w9ec2Vfw1YpGgAAAABJRU5ErkJggg==",name:at("第一种平面符号")},{typeName:Ut.SecondConcaveSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAACZCAYAAAA4qUiHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMSSURBVHhe7c9LcttAFMVQ73/TTiapuBI0xR/IpoRbdSbQa8n++r3v5CIYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8ZNfo4+z/P8HH2+E8ZN/h3d5DlodLcDxtVGo9vMbzS63QHjJjS6y/xodLcTxk1Go9vMazS63QnjZqPRbeYzGt0egHEXGt1lPjS6OwjjLqPRbeYxGt0ehHG30eg29xuNbk+A8ZDR6Db3otHdSTAeMhrd5j6j0e1JMB42Gt3meqPR7YkwnmI0us11RqPbk2E8zWh0G9/S6P5kGE+zNLqPZ2l0L8B4qqXRfc63NLqXYDzd0ug+51ka3YswKpZG9zluaXQvw6hZGt1nv6XR/QUwqpZG99luaXR/EYy6pdF91lsa3V8I4yWWRvd5bWl0fzGMl3k1epP/vRq9uQHGS70avclfr0ZvboLxcmtG7z7ZmtG7G2G8zavRm0/0avRmAhhvtWb07hOsGb2bBMYprBm9e0drRu8mg3Eaa0dv38Ha0dsJYZzO2tHbJ9oyej8pjFPaMnr/BFtG7yeHcWpbR98xk62j73gIjI+wd/RdV9o7+q6Hwfg4R0bfd6ajo+98KIyPZYx+5ydj9DtvAOPjPXX0v7wRjG9n1tHf+sYwvrW7R3/Th8D4UezRb34ojBn4M/osL2FMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPGxIAxMWBMDBgTA8bEgDExYEwMGBMDxsSAMTFgTAwYEwPG5GRf378A7t91CbVjKP8AAAAASUVORK5CYII=",name:at("第二种凹面符号")},{typeName:Ut.SecondConvexeSymbol,img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAACUCAYAAAAQ0fKrAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAL8SURBVHhe7dHBjtswFMXQ/v9PT7ttS9lJLNOywwucDfFkZNpff/aTLABjYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwJjaMiQ1jYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwJjaMiQ1jYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwJjaMiQ1jYsOY2DAmNoyJDWNiw5jYMCY2jIkNY2LDmNgwZuDT0bfyF4xfzR79hi+E8ausNvqNXwDj491l9NsfCuMj3X30Nz0Ixkc5OvrmETNG3705jLd3ZPS9Mx0Zfe+mMN7WJ6PvXOmT0XduBuPtvDN6v7J3Ru9vAuNtvDN6fyfvjN4vDuMtvDp6e2evjt4uDOPSXh29fZJXR28XhHFZr4zePdkro3eLwbikvdGbb/LK6N0iMC5lb/Tmm+2N3iwA4zL2Rm9yy383jJfbG73J//ZGby6C8VJ7ozcZ2xu9uQDGy+yN3mTf3uiNDOMltkb3ed/W6F6EUbc1us/ntkb3EoyqrdF9jtsa3QswarZG95lna3R/MoyKrdF95tsa3Z8Io2I0us15RqPbE2E83Wh0m/ONRrcnwXiq0eg2ntHo9gQYTzMa3cY3Gt1OhvE0NLrLdWh0NxnGU4xGt7nOaHQ7EcbpRqPbXG80up0E43Q0uss6aHQ3CcapRqPbrGM0up0A4zSj0W3WMxrdHoRxGhrdZV00ujsI4xSj0W3WNRrdHoBxChrdZX00ujsA42E0ust90OjuQxin+Hd0k/v4d3RzAMZpTvjBudhJ/6cYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYExvGxIYxsWFMbBgTG8bEhjGxYUxsGBMbxsSGMbFhTGwYE9Gvn98b42oiTSRi9wAAAABJRU5ErkJggg==",name:at("第二种凸面符号")},{typeName:Ut.SecondPlaneSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKYAAACmCAYAAABQiPR3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAO2SURBVHhe7dJbTh1BEARR9r9pjC1kYRwkF5jp7EekdH5C9VlPL3uWJoRRasMotWGU2jBKbRilNoxSG0apDaPUhlFqwyi1YZTaMEptGKU2jFIbRqkNo9SGUWrDKLVhlNowSm0YpTaMUhtGqQ2j1IZRasMotWGU2jBKbRilNoxSG0apDaPUhlFqwyi1YZTaMF7u/ehGegPj5Wh0J73CeLmPRrfSC4yXS6N7HQ/jLdLoXkfDeJs0utexMN4qje51JIy3S6N7HQfjEGl0r6NgHCaN7nUMjEOl0b2OgHG4NLrX9jBWpNG9toaxJo3utS2MVWl0ry1hrEuje20H4xTS6F5bwTiNNLrXNjBOJY3utQWM00mjey0P45TS6F5LwzitNLrXsjBOLY3utSSM00ujey0H4xLS6F5LwbiMNLrXMjAuJY3utQSMy0mje00P45LS6F5Tw7isNLrXtDAuLY3uNSWMy0uje00H4xbS6F5TwbiNNLrXNDBuJY3uNQWM20mje9Vh3FIa3asK47bS6F41GLeWRveqwLi9NLrXcBiPkEb3GgrjMdLoXsNgPEoa3WsIjMdJo3vdDuOR0uhet8J4rDS6120wHi2N7nULjMdLo3tdDqNepNG9LoVRr9LoXpfBqDfS6F6XwKh30uheP4ZRII3u9SMY9YE0ute3YVSQRvf6Foz6RBrd68sw6gFpdK8vwagHpdG9HoZRX5BG93oIRn1RGt3rUxj1DWl0rwijvimN7vUhjPqBNLoXwqgfSqN7/QejLpBG9/oHRl0kje71F0ZdKI3u9QdGXSyN7sVRN0ij+8Nh1E3S6P5gGHWjNLo/FEbdLI3uD4RRA6TR/WEwapA0uj8IRg2URveHwKjB0uj+ABhVkEb3m8OokjS63xhGFaXR/aYwqiyN7jeEURNIo/vNYNQk0uh+Ixg1kTS63wRGTSaN7jeAURNKo/vFYdSk0uh+YRg1sTS6XxRGTS6N7heEUQtIo/vFYNQi0uh+IRi1kDS6XwRGLSaN7heAUQtKo/vJYdSi0uh+Yhi1sDS6nxRGLS6N7ieEURtIo/vJYNQm0uh+Ihi1kTS6nwRGbSaN7ieAURtKo/syjNpUGt0XYdTG0ui+BKM2l0b3BRh1gDS6HwyjDpFG9wNh1EHS6H4QjDpMGt0PgFEHSqP7m2HUoT4a3d4Mow72fnQzAEap+ZS/YZTaMEptGKU2jFIbRqkNo9SGUWrDKLVhlNowSm0YpTaMUhtGqQ2j1IZRasMotWGU2jBKRU/PvwBx2jYpMoLBBAAAAABJRU5ErkJggg==",name:at("第二种平面符号")},{typeName:Ut.FirstConvexeSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAACDCAYAAACqaHhbAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAK3SURBVHhe7c3bjtNAFERR/v+nhwGBBNGy4yTu9qWqpPWyc9r58b2visdYWRgrC2NlYawsjJWFsbIwVhbGysJYWRgrC2NlYawsjJWFsbIwVhbGysJYWRgrC2NlYawsjJWFsbIwVhbGysJYWRgrC2NlYawsjLv6NfU6DcbdvDt9q4Zh3MWe0/drN4y7GDn9X72NcTezpv+uzRiHGzX9Vz3FeLhPp2/WIsZTenf6Vv2H8RJenb5RvzFeyqvTN8IxXtbW6W0wxsvbOr0NxHgrW6Z3QRhvZ8v0LgTjbW2Z3t0c4+09m97cGGOEZ9Obm2KMsjbd3xBjnGfTmxthjLU23d8EY7S16f4GGOOtTfcXx1jf1qb7C2OsP9am+4tirH+sTfcXxFiwNN1eDGPB2nR/IYy1YGm6vRDGWrE03V4EYz2xNN1eAGNtsDTdnhxjbbQ03Z4YY71A092JMdYLlqbbk2KsFy1NtyfEWG/QdHdCjPWGpen2ZBjrTZruToaxPqDp7kQY6wNL0+1JMNaHNN2dBGN9aGm6PQHG2oGmuxNgrB0sTbcHY6ydaLo7GGPtRNPdwRhrR5ruDsRYO9J0dyDG2pmmu4Mw1s403R2EsXam6e4gjDWAprsDMNYAmu4OwFgDaLo7AGMNouluMsYaRNPdZIw1iKa7yRhrEE13kzHWQJruJmKsgTTdTcRYA2m6m4ixBtJ0NxFjDabpbhLGGkzT3SSMNZimu0kYazBNd5Mw1mCa7iZhrME03U3CWINpupuEsQbTdDcJYw2m6W4SxprgcbqZhLEmeJxuJmGsCR6nm0kYa4LH6WYSxprgcbqZhLEm+Tv9NhFjZWGsLIyVhbGyMFYWxsrCWFkYKwtjZWGsLIyVhbGyMFYWxsrCWFkYKwtjZWGsLIyVhbGyMFYWxsrCWFkYKwtjxfjx9ROiaSHTn3voRQAAAABJRU5ErkJggg==",name:at("第一种凸面符号")},{typeName:Ut.none,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:at("清除"),isChecked:!0},{typeName:Ut.ThirdPlaneSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAACdCAYAAAA33qNjAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAOZSURBVHhe7cpRTl1BDARR9r9pgiISEVIND7jja89US+en7KeXPUsNYJSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYZSqYdSB3o7ui2HUYWj0txBGHSSNfhfCqEOk0e9iGHWANPotgFGbS6PfIhi1sTT6LYRRm0qj32IYtaE0+r0BRm0mjX5vglEbSaPfG2HUJtLo92YYtYE0+m0Ao4ZLo98mMGqwNPptBKOGSqPfZjBqoDT6bQijhkmj36YwapA0+m0Mo4ZIo9/mMGqANPodAKOaS6PfITCqsTT6HQSjmkqj32EwqqE0+h0Io5pJo9+hMKqRNPodDKOaSKPf4TCqgTT63QBG3SyNfjeBUTdKo9+NYNRN0uh3Mxh1gzT63RBGFUuj301hVKE0+t0YRhVJo9/NYVSBNPo9AEYtlka/h8CohdLo9yAYtUga/R4GoxZIo98DYdTF0uj3UBh1oTT6PRhGXSSNfg+HURdIo19x1A+l0a9+w6gfSKNf/YVR35RGv/oHRn1DGv3qPxj1RWn0K4RRX5BGv4ow6kFp9KsPYdQD0uhXn8KoT6TRrx6CUR9Io189DKOCNPrVl2AUSKNffRlGvZNGv/oWjHojjX71bRj1Ko1+9SMY9SKNfvVjGI+XRr+6BMajpdGvLoPxWGn0q0thPFIa/epyGI+TRr9aAuNR0uhXy2A8Rhr9aimMR0ijXy2HcXtp9KsSGLeWRr8qg3FbafSrUhi3lEa/KodxO2n0q1tg3Eoa/eo2GLeRRr+6FcYtpNGvbodxvDT6VQsYR0ujX7WBcaw0+lUrGEdKo1+1g3GcNPpVSxhHSaNftYVxjDT6VWsYR0ijX7WHsb00+tUIGFtLo1+NgbGtNPrVKBhbSqNfjYOxnTT61UgYW0mjX42FsY00+tVoGFtIo1+Nh/F2afSrLWC8VRr9ahsYb5NGv9oKxluk0a+2g7FcGv1qSxhLpdGvtoWxTBr9amsYS6TRr7aHcbk0+tURMC6VRr86BsZl0uhXR8G4RBr96jgYL5dGvzoSxkul0a+OhfEyafSro2G8RBr96ngYL0GjP+kFxku8H/1IrzBe5s/oJr2BUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUaqGUSr09PwLe560Hv6Ev1kAAAAASUVORK5CYII=",name:at("第三种平面符号")},{typeName:Ut.FirstConcaveSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAI0AAACNCAYAAACKXvmlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAALXSURBVHhe7c1LktswEARR3//S4094MZYTJZIi0Q0yK+JtUg3xx699STthlBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCcZyv0ddLWAs9Tq6USmMZWh0p1IYy9DoTqUwlqHRnUphLPU6ulEpjKVeRzcqhbHU6+hGpTCWeh3dqBTGUjS6UxmMpWh0pzIYS9HoTmUwlqLRncpgLEWjO5XBWIpGdyqDsRSN7lQGYzka3akExnI0ulMJjOVodKcSGMvR6E4lMLZAoztNh7EFGt1pOowt0OhO02FsgUZ3mg5jGzS601QY26DRnabC2AaN7jQVxlZodKdpMLZCoztNg7EdGt1pCozt0OhOU2Bsh0Z3mgJjSzS60+UwtkSjO10OY1s0utOlMLZFoztdCmNbo9GtLoOxtdHoVpfA2B6N7nQJjO2NRrc6HcYl0OhOp8O4DBrd6VQYlzEa3eo0GJdCozudBuNSRqNbnQLjckajW30M45JGo1t9BOOS0uheh2FcVhrd6xCMSxuNbnUIxuWNRrfaDeMtjEa32gXjbYxGt9oM462MRrfaBOOtvBu9UYTxdt6N3mgI422l0b0QxltLo3v9B+PtpdG9/oHxEd6N3ugPjI/xbvRGHB/n3ejNg2F8pC2jdw+E8bG2jN49DMbH2zJ69xAY9deW0bubw6hv9oze3xBGgT2j9zeCUQNHRv+zOIza4OjovxaDUTt8OvrP5jDqoCtG3ymGUR+aNfr2BBh1oitH35sAoy509ugbF8OoyY6O/msCjGrq++j3STBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSglGKUEo5RglBKMUoJRSjBKCUYpwSgN/Pj6CVeUv88NZ939AAAAAElFTkSuQmCC",name:at("第一种凹面符号")},{typeName:Ut.FlattenWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAC0CAYAAAAw03Z1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAR0SURBVHhe7dFBbttQEARR3//SiRU4hqLUSKRE0b9nqoG3KQ4XBD8+90tqAKOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqOUBqMGux3dLAijhqLR3YIwaiga3S0IowaqRrcLwqiBaHS3KIwaphrdLgqjhqHR3cIwapBqdLswjBqERneLw6ghqtHt4jBqCBrdBcCoAarRbQCMGoBGdyEwqrlqdBsCo5qj0V0QjGqsGt0GwajGaHQXBqOaqka3YTCqKRrdBcKohqrRbSCMaohGd6EwqplqdBsKo5qh0V0wjGqkGt0Gw6hGaHQXDqOaqEa34TCqCRrdNYBRDVSj2wYwqgEa3TWBUeGq0W0TGBWORneNYFSwanTbCEYFo9FdMxgVqhrdNoNRoWh01xBGBapGtw1hVCAa3TWFUWGq0W1TGBWGRneNYVSQanTbGEYFodFdcxgVohrdNodRIWh0NwBGBahGtwNgVAAa3Q2BUYurRrdDYNTiaHQ3CEYtrBrdDoJRC6PR3TAYtahqdDsMxnY6j753IIytdB9980AYW+k8+t6hMLbTdfStQ2FspxrdrohGd4NhbIlGd6upRreDYWypGt2uhEZ3w2Fsi0Z3q6hGt8NhbKsa3a6ARnfi2BqN7n5aNboVx9aq0e1PotGd/sDYHo3ufko1utUfGNurRrc/gUZ3+oZxBBrdna0a3eobxhGq0e2ZaHSnf2Acg0Z3Z6lGt/oHxjGq0e0ZaHSn/2AchUZ371aNbvUfjKNUo9t3otGdEMZxaHT3LtXoVgjjONXo9h1odKcSxpFodHe0anSrEsaRqtHtkWh0p7swjkWju6NUo1vdhXGsanR7BBrd6SGMo9Ho7lXV6FYPYRytGt2+gkZ32gTjeDS6e1Y1utUmGMerRrfPoNGdNsOoTzS626sa3WozjPpUjW73oNGddsGoLzS626oa3WoXjPpSjW63oNGddsOoKzS6e6Qa3Wo3jLpSjW7vodGdnoJRN2h0V6lGt3oKRt2oRreERnd6GkYBGt3dqka3ehpGgWp0e41Gd3oJRhVodPdXNbrVSzCqUI1uL2h0p5dh1B20rXeX0a1ehlF3VNtyd3ujw2DUA7RHzy+7vtGhMOqBaveeX7+vw2HUBrSqX3b7vg6FURvsGb2vQ2HURltH7+pQGLXRltF7OhxG7fBo9I4Oh1E73Bvd6y0waqdqdKu3wKidaHSnt8GoJ9yObvQ2GKU0GKU0GKU0GKU0GKU0GKU0GKU0GKU0GKU0GKU0GE/l1h39r0VhPI1bf/TfFoTxNG790X9bEMZTubVH/2xBGE/n1hz9q0VhlNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglNJglIJ8/PoN/NebMT+KMDUAAAAASUVORK5CYII=",name:at("削平焊缝")},{typeName:Ut.ToeAareaTranSmoothly,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALUAAAC1CAYAAAAZU76pAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAATfSURBVHhe7c5Bjhs5FARR3//SHs+igYYQpErtZBWTjgTeJvQp6def/ZYOg1FqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlFqhlELfI0+UxRGhb2ObhSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRgVRKM7xWBUEI3uFINRQTS6UwxGBdHoTjEYFUSjO8VgVBCN7hSDUUE0ulMMRgXR6E4xGBVEozvFYFQQje4Ug1FBNLpTDEYF0ehOMRijvkaf/QtodPcv+Bp9FoQx5nV0czoa3Z3udXQTgjGGRncno9Hd6V5HNyEYY2h0dzIa3Z3udXQTgjGGRncno9Hd6V5HNyEYY2h0dzIa3Z2MRnchGGNodHcyGt2djEZ3IRhjaHR3MhrdnYxGdyEYY2h0d7LR6PZUNLoLwRhFo7sTzUb3p6LRXQjGKBrdnWg2uj/V6+gmCGMUje5ONBvdn4hGd0EYo2h0d6J3ozenodFdEMY4Gt2d5Mro3WlodBeEMY5Gdye5Onp7ChrdhWGMG41uT/DJ6P0paHQXhnEJGt2dgDbrJxqNbsMwLjEa3TYbbfb59/enoNHdAhiXodFdM9q7z//f95t2o9HtAhiXGY1uG4125e71phmN7hbBuNRodNtktL+9bTMa3S6CcanR6LYJje6+jEa3LUaj24UwLjca3TYYjW6/o9Fdg9HodjGMtxiNbnc2Gt2+Go1udzYb3S+G8Taj0e2ORqPbkdHodkez0f0NMN5mNrrfyWx0PzMa3e5kNrq/CcZbzUb3O5iN7q+Yje6fNhvd3wjj7d6N3jzh3ejNJ2aj+6fMRvc3w/iId6M3d3o3evMT70Zv7vJu9OYBGB9zZfRupSujd3/j3ejNSldG7x6C8XFXRu+SrozepVwZvUu6Onr7IIxb+GT0/ic+Gb1f4ero7U9dHb3dAMatfDr6jplPR9+x2k9G3zPyk9H3bALjdnYZ/bc77TD6X5vBuK2nRv/lSU+M/semMFZYPfrN3dwx+t3NYayTGn13i9Tou8tgPMZodHuq2ej+ABilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilZhilUr9+/we+LQDMYXMVmgAAAABJRU5ErkJggg==",name:at("趾部平滑过渡")}]),c=V.reactive([{typeName:Ut.WithPadSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAACyCAYAAADrlOUvAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAARaSURBVHhe7dGxbUBRCARB99+07QImBT2+dqVJTmT8/PebfAjH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruK4or6Zfr2I47j6bvr3Io7j6rvp34s4jqvvpn8v4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxnNJd3qZ0t4jjOKW7vE3pbhHHcUp3eZvS3SKO45Tu8jalu0Ucxynd5W1Kd4s4jlO6y9uU7hZxHKd0l7cp3S3iOE7pLm9TulvEcZzSXd6mdLeI4zilu7xN6W4Rx3FKd3mb0t0ijuOU7vI2pbtFHMcp3eVtSneLOI5TusvblO4WcRyndJe3Kd0t4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxnNJd3qZ0t4jjOKW7vE3pbhHHcUp3eZvS3SKO45Tu8jalu0Ucxynd5W1Kd4s4jlO6y9uU7hZxHKd0l7cp3S3iOE7pLm9TulvEcZzSXd6mdLeI4zilu7xN6W4Rx3FKd3mb0t0ijuOU7vI2pbtFHMcp3eVtSneLOI5TusvblO4WcRyndJe3Kd0t4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxnNJd3qZ0t4jjOKW7vE3pbhHHcUp3eZvS3SKO45Tu8jalu0Ucxynd5W1Kd4s4jlO6y9uU7hZxHKd0l7cp3S3iOE7pLm9TulvEcZzSXd6mdLeI4zilu7xN6W4Rx3FKd3mb0t0ijuOU7vI2pbtFHMcp3eVtSneLOI5TusvblO4WcRyndJe3Kd0t4jhO6S5vU7pbxHGc0l3epnS3iOM4pbu8TeluEcdxSnd5m9LdIo7jlO7yNqW7RRzHKd3lbUp3iziOU7rL25TuFnEcp3SXtyndLeI4Tukub1O6W8RxXH03/XsRx3H13fTvRRzH1XfTvxdxHFffTf9exHFFfS/9eRnH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JVRyTqzgmV3FMruKYXMUxuYpjchXH5CqOyVUck6s4JldxTK7imFzFMbmKY3IVx+QqjslVHJOrOCZXcUyu4phcxTG5imNyFcfkKo7JQT+/fzC8n2Uj/0mSAAAAAElFTkSuQmCC",name:at("带垫板符号")},{typeName:Ut.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACKCAYAAACaRblaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAJuSURBVHhe7dExaiQBEARB/f/T0tlHGKI0sNOQBeEk7fXXv30nv8SYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkwJsKYCGMijIkw/kn77PSThzDO2jum3zyAcdbeMf3mAYyz9o7pNw9gnLXPT395CONM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpxpustJjDNNdzmJcabpLicxzjTd5STGmaa7nMQ403SXkxhnmu5yEuNM011OYpy1z09/eQjjrL1j+s0DGGftHdNvHsA4a++YfvMAxj9pn51+8hDGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUyEMRHGRBgTYUz+8/X9AzBU0hEUOBzfAAAAAElFTkSuQmCC",name:at("三面焊缝符号"),rotation:0},{typeName:Ut.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHUAAAB2CAYAAAD2kNwSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMnSURBVHhe7dAxbhwwEARB/f/TshMli0pbwOjYQCXLifj1v+/nz+Hx2cbjs43HZxuPzzYen208Ptt4fLbx+Gzj8dnG47ONx2cbj882Hp9tPD7beHy28fhs4/HZxuOzjcdnG4+5T0t/EOIx94npHyI85j4x/UOEx9wnpn+I8Jj7xPQPER5zN22WKe0iPOZu2ixT2kV4zN20Waa0i/CYu2mzTGkX4TF302aZ0i7CY+6mzTKlXYTH3E2bZUq7CI+5mzbLlHYRHnM3bZYp7SI85m7aLFPaRXjM3bRZprSL8Ji7abNMaRfhMXfTZpnSLsJj7qbNMqVdhMfcTZtlSrsIj7mbNsuUdhEeczdtlintIjzmbtosU9pFeMzdtFmmtIvwmLtps0xpF+Exd9NmmdIuwmPups0ypV2Ex9xNm2VKuwiPuZs2y5R2ER5zN22WKe0iPOZu2ixT2kV4zN20Waa0i/CYu2mzTGkX4TF302aZ0i7CY+6mzTKlXYTH3E2bZUq7CI+5mzbLlHYRHnM3bZYp7SI85m7aLFPaRXjM3bRZprSL8Ji7abNMaRfhMXfTZpnSLsJj7qbNMqVdhMfcTZtlSrsIj7mbNsuUdhEeczdtlintIjzmbtosU9pFeMzdtFmmtIvwmLtps0xpF+Exd9NmmdIuwmPups0ypV2Ex9xNm2VKuwiPuZs2y5R2ER5zN22WKe0iPOZu2ixT2kV4zN20Waa0i/CYu2mzTGkX4TF302aZ0i7CY+6mzTKlXYTH3E2bZUq7CI+5mzbLlHYRHnM3bZYp7SI85m7aLFPaRXjM3bRZprSL8Ji7abNMaRfhMXfTZpnSLsJj7qbNMqVdhMfcTZtlSrsIj7mbNsuUdhEeczdtlintIjzmbtosU9pFeMzdtFmmtIvwmLtps0xpF+Exd9NmmdIuwmPups0ypV2Ex9xNm2VKuwiPuZs2y5R2ER5zN22WKe0iPOZu2ixT2kV4zN20WXfTJsLjr/hJb3/FT3oL8fhs4/HZxuOzjcdnG4/PNh6fbTw+23h8tvH4bOPx2cbjs43HZxuPzzYen208Ptt4fLbx+Mz6+v4HDsQyYEjLLcEAAAAASUVORK5CYII=",name:at("三面焊缝符号"),rotation:Math.PI*(3/2)},{typeName:Ut.SurroundingWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIoAAACICAYAAAA4T3NvAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQZSURBVHhe7c7BjqRIEETB+f+fnh2pL9shSwpUGZCAP8kurkiq/vzrb8QOHCMqjhEVx4iKY0TFMaLiGFFxjKg4RlQcIyqOERXHiIpjRMUxouIYUXGMqDhGVBwjKo4RFceIimNExTGi4hhRcYyoOEZUHCMqjq9U082LcXykmen7D8fxEc5Mv/8wHG9rhfS/HoDj7ayY/ueNcbyNb9L3Rr5J37shjss7mr7xraPpGzfCcVlH0vsuR9L7G+C4pL3p7Zn2pHeL47iUPend1fakd4viuIxP6c1qPqU3C+K4hE/pzao+pTeL4Xi5rXR/F1vpfiEcL7WV7u9mK90vguNlttL9XW2l+wVwvMRWur+7rXR/MY6nG6Xbpxml2wtxPNUo3T7VKN1ehONpttL9k43S7QU4nmaUbp9ulG4vwPEUo3T7FqN0ezKO7Ubp9m1G6fZEHNsp3b2V0t2JOLYapdu3GqXbk3BspXT3dqN0ewKObZTu4ofS3Qk4tlG6ix9Kdyfg2ELpLn5TumvGsYXSXfymdNeM43RKd2FKd404Tqd0F6Z014jjdEp3YaN024TjVEp3sU3prgnHqZTuYpvSXROOUyndxTaluyYcp6rpJvZRumvAcRqlu9hH6a4Bx2mU7mIfpbsGHKdRuot9lO4acJympps4pqabBhynqekmjqnppgHHaWq6iWNqumnAcZqabuIYpbvJOE6hdBfHKN1NxnEKpbs4RuluMo5TKN3FMUp3k3GcQukujlG6m4zjFEp3cYzS3WQcp1C6i2OU7ibjOE1NN3FMTTcNOE5T000cU9NNA47T1HQTx9R004DjNEp3sY/SXQOO0yjdxT5Kdw04TqN0F/so3TXgOI3SXeyjdNeA41RKd7FN6a4Jx6mU7mKb0l0TjlMp3cU2pbsmHKcapdsYU7prwnE6pbswpbtGHKdTugtTumvEsYXSXfymdNeMYwulu/hN6a4ZxzZKd/FjlG6bcWyjdBc/lO5OwLHNKN2+3SjdnoBjq1G6fTOlu5NwbKd091ZKdyfi2G6Ubt9mlG5PxPEUo3T7FqN0ezKOpxil27cYpduTcTzNKN0+3SjdXoDjqUbp9qlG6fYiHE83SrdPM0q3F+J4iVG6fYpRur0Yx8uM0u3dbaX7i3G8zKf05m4+pTcL4Hi5rXR/F5/Sm0VwXMJWul/dVrpfDMdlfEpvVvMpvVkQx6XsSe+utie9WxTH5exNb8+2N71dGMdl7U1vu+1Nb2+A4/KOpPezHEnvb4TjLXyTvvfJN+l7N8PxVlZO//emON7WCul/PQDH27si/Y8H4fg4Hel3Hozja+xJ716IY0TFMaLiGFFxjKg4RlQcIyqOERXHiIpjRMUxouIYUXGMqDhGVBwjKo4RFceIimNExTGi4hjxP3/+/gemz7sMOoigvwAAAABJRU5ErkJggg==",name:at("周围焊接符")},{typeName:Ut.OnSiteSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOgAAADjCAYAAACPbli7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAYQSURBVHhe7dPhbhxFFAVh3v+lIQKBAlQSez2zdXtulfT9Oe7YuzOd3771e5KxcEwyA45JZsAxyQw4JpkBxyQz4JhkBhyTzIBjkhlwTDIDjklmwDHJDDgmmQHHJDPgmGQGHJPMgGOSGXBMMgOOSWbAMckMOCaZAcckM+Co+jv6WbIMjqrvo58ni+CoouhcsgCOqh9FZ5OHw1H1q+jfJA+Fo+oj0b9LHghH1Weif588CI6qz0a/I3kIHFWvRL8neQAcVV+Jfl9yMBxVX41+Z3IoHFVXRb87OQyOqiuj358cBEfVHdHfSQ6Ao+qu6G8lw+GoujP6e8lgOKreEf3dZCAcVe+K/nYyDI6qd0efIRkCR5URfY5kABxVZvR5EhGOKjv6TIkER9WE6HMlAhxVk6LPl7wRjqpp0WdM3gRH1dTosyY3w1E1Ofq8yY1wVJ0Qfe7kBjiqTok+e3IxHFUnRZ8/uRCOqhOj75FcAEfVqdF3Sb4IR9Xp0XdKXoSj6gnR90pegKPqSdH3Sz4BR9XTou+YfBCOqidG3zP5ABxVT46+b/ITOKqeHn3n5AdwVG2JvnvyHziqNkXfP/kOjqqN0XNIvsFRtTV6FlkPR9Xm6HlkNRxV1X/U/ANHVf0VPZusg6Oq/h09o6yBo6r+Hz2nrICjqn4cPa88Go6q+nn0zPJYOKrq19FzyyPhqKqPR88vj4Kjqj4XPcM8Bo6qei16ljkejqp6PXqeORqOqvp69FxzJBxVdU30bHMcHFV1XfR8cxQcVXV99JxzBBxVdU/0rDMejqq6N3rmGQtHVd0fPfeMhKOq3hc9/4yCo6reG72DjIGjqt4fvYeMgKOqvOh9RIWjqtzonUSDo6pmRO8mb4ejquZE7ydvhaOq5kXvKW+Bo6pmRu8qt8NRVXOj95Vb4aiq+dF7yy1wVNUZ0bvL5XBU1VnRO8xlcFTVedF7zCVwVNW50fvMl+CoqrOjd5qX4aiq86P3mpfgqKrnRO83n4Kjqp4VveN8GI6qemb0rvNLOKrqudH7zk/hqKrnR+89CEdV7Yjeff4HR1Xtid5//gVHVe2L7kH+hKOqdkZ3ITyqand0JxbDUVVF92IpHFVVf0f3YxkcVVXfR3dkERxVVf+N7skSOKqqfhTdl4fDUVX1s+jOPBiOqqqPRHfngXBUVX00uj8Pg6Oq6rPRPXoIHFVVr0R36QFwVFW9Gt2nw+GoqvpqdK8OhaOq6orobh0IR1XVldEdOwiOqqqro3t2CBxVVXdF9204HFVVd0Z3bjAcVVV3R/duKBxVVe+K7t8wOKqq3hndwUFwVFUZ0V0cAEdVlRXdRxmOqio7upcSHFVVE6K7KcBRVTUlup9vhqOqalp0T98ER1XVxOiuvgGOqqrJ0Z29EY6qqunRvb0JjqqqU6L7ezEcVVUnRXf4Qjiqqk6L7vFFcFRVnRrd5y/CUVV1cnSnvwBHVdXp0b1+EY4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kii6FyyAI4qis4lC+CoouhcsgCOKorOJQvgqKLoXLIAjiqKziUL4Kj7Pvp5sgSOSWbAMckMOCaZAcckM+CYZAYck8yAY5IZcEwyA45JZsAxyQw4JpkBxyQz4JhkBhyTzIBjkhlwTDIDjklmwDHJDDgmmQHHJDPgmGQGHJPMgGOSGXBMMgOOSWbAMckMOCbR/fb7H7ITK2QTDTxwAAAAAElFTkSuQmCC",name:at("现场符号")},{typeName:Ut.none,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:at("清除"),isChecked:!0},{typeName:Ut.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJEAAACNCAYAAAC3zJjDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQNSURBVHhe7dBBah1ADERB3//STpZBFOYPgXaD9KA2ml7N19++z/lPPJ7zgsdzXvB4zgsez3nB4zkveDznBY/nvODxnBc8nvOCx3Ne8HjOCx7PecHjOS94POcFj+e84PGcFzye84LHc17weM4LHs95weM5L3j8Ff+m941m2hTgMW6mzUYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMU9ptM9OmAI9xSrttZtoU4DFOabfNTJsCPMYp7baZaVOAxzil3TYzbQrwGKe022amTQEe45R228y0KcBjnNJum5k2BXiMuz5Lf1eAx7jrs/R3BXiMuz5Lf1eAx7jrs/R3BXj8FdfP6c9K8HjOCx7PecHjOS94POcFj+e84PGcFzye84LHc17weM4LHs95weM5L3g85wWP57zg8ZwXPJ7zgsdzXvB4zgsez3nB4zkveDznBY/nfOjr+w916ZqBJkXEfQAAAABJRU5ErkJggg==",name:at("三面焊缝符号"),rotation:Math.PI/2},{typeName:Ut.ThreeSidedWeldSeamSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABjCAYAAABzLpVfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAHPSURBVHhe7dAxakMBEENB3//STsCFmyn2gwqFSDDNY6t9/e49fwLj9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunD+Nj25l+CGB/ZvtN/Qhgf2b7Tf0IYH9s+029CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthnANNdyGMc6DpLoRxDjTdhTDOgaa7EMY50HQXwjgHmu5CGOdA010I4xxougthfGz7TL8JYXxk+07/CWF8ZPtO/wlhfGT7TL8JYnzsv08/CWOcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcPozTh3H6ME4fxunDOH0Ypw/j9GGcKq/3D2Q2PYJIa+R5AAAAAElFTkSuQmCC",name:at("三面焊缝符号"),rotation:Math.PI},{typeName:Ut.TailSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJsAAACfCAYAAADu8KuaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAOrSURBVHhe7dLRTiNBDAVR/v+nWYRYBKHsTJJ2T4+7rnReSn7028fepUkwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwShUwarLb0U0DGDURje4awKhJotFtAxg1QTa6bwCjimWj+yYwqlA2um8Eo4pko/tmMKpANrpvCKMGy0b3TWHUQNnovjGMGiQb3TeHUQNko/sNYNSLstH9JjDqBdnofiMY9aRsdL8ZjHpCNrrfEEY9KBvdbwqjHpCN7jeGUQdlo/vNYdQB2eheHHVHNrrXJ4xKZKN7fcOoQDa61y8YBbLRvf7AqBvZ6F4Io37IRvcKYdSXbHSvFEZ9yEb3ugvj9rLRvQ7BuLVsdK/DMG4rG93rIRi3lI3u9TCM28lG93oKxq1ko3s9DeM2stG9XoJxC9noXi/D2F42utcQGFvLRvcaBmNb2eheQ2FsKRvdaziM7WSje5XA2Eo2ulcZjG1ko3uVwthCNrpXOYyXl43uNQXGS8tG95oG42Vlo3tNhfGSstG9psN4OdnoXqfAeCnZ6F6nwXgZ2ehep8J4CdnoXqfDuLxsdK8lYFxaNrrXMjAuKxvdaykYl5SN7rUcjEuKRrdaEsZlRaNbLQfj0qLRrZaCcXnR6FbLwHgJ0ehWS8B4GdHoVqfDeCnR6Fanwng50ehWp8F4SdHoVqfAeFnR6FbTYby0aHSrqTBeXjS61TQYW4hGt5oCYxvR6FblMLYSjW5VCmM70ehWZTC2FI1uVQJjW9HoVsNhbC0a3WoojO1Fo1sNg3EL0ehWQ2DcRjS61cswbiUa3eolGLcTjW71NIxbika3egrGbUWjWz0M49ai0a0egnF70ehWh2HUh2h0q0Mw6ks0utVdGPVDNLpVCqNuRKNbhTAKRKNbIYwKRKNb/YFRiWh0q18w6o5odKtvGHVANLrVJ4w6KBrdiqMeEI1uN4dRD4pGtxvDqCdEo9tNYdSTotHthjDqBdHodjMY9aJodLsRjBogGt1uAqMGiUa3G8CogaLRbXMYNVg0um0MowpEo9umMKpINLptCKMKRaPbZjCqWDS6bQSjJohGt01g1CTR6LYBjJqIRncNYNRkt6ObBjDqBI2f7D+MUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWMUgWM0mBv7/8ABNZSZLbQ7LwAAAAASUVORK5CYII=",name:at("尾部符号")},{typeName:Ut.ZSymbol,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAMUAAACwCAYAAAC/16qCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQxSURBVHhe7c85khxJEARB/P/T2CFAYNFaM33UkVlpLqKMSTDx62u/k/wPY7IyxmRljMnKGJOVMSYrY0xWxpisjDFZGWOyMsZkZYzJyhiTlTEmK2NMVsaYrIwxWRljsjLGZGWMycoYk5UxLmeF6e8Q41JWmv7PA8alrDT9nweMy1ll+j0PGDM5TXchxkxO012IMRPTdJdNjJmYprtsYsykNN3lW4yZlKa7fIsxk9J0l28xZkKa7vIjxkxI011+xJjJaLrLUxgzGU13eQpjJrI13eYpjJmIprs8jTET0XSXpzFmEpru8hLGTELTXV7CmAlsTbd5CWMmoOkuL2PMBDTd5WWMGZymu7yFMYPTdJe3MGZgmu7yNsYMTNNd3saYgWm6y9sYMyhNd/kIYwal6S4fYcyANN3lY4wZkKa7fIwxg9mabvMxxgxG0112wZjBaLrLLhgzEE132Q1jBqLpLrthzCC2ptvshjGD0HSXXTFmEJrusivGDEDTXXbHmAFousvuGHMxTXc5BGMupukuh2DMxTTd5RCMuZCmuxyGMRfSdJfDMOYimu5yKMZcRNNdDsWYC2xNtzkUYy6g6S6HY8wFNN3lcIw5maa7nIIxJ9N0l1Mw5kRb021OwZgTabrLaRhzIk13OQ1jTqLpLqdizEk03eVUjDmBprucjjEn0HSX0zHmBJrucjrGHEzTXS7BmINpusslGHMgTXe5DGMOpOkul2HMQbam21yGMQfRdJdLMeYgmu5yKcYcQNNdLseYA2i6y+UYs7Ot6TaXY8zONN1lCIzZmaa7DIExO9J0l2EwZkea7jIMxuxE012GwpidaLrLUBizE013GQpjdqDpLsNhzA403WU4jPmQprsMiTEf0nSXITHmA1vTbYbEmA9ousuwGPMBTXcZFmPepOkuQ2PMmzTdZWiMecPWdJuhMeYNmu4yPMa8QdNdhseYF2m6yxQY8yJNd5kCY16g6S7TYMwLNN1lGox5gaa7TIMxT9J0l6kw5kma7jIVxjxB012mw5gnaLrLdBjzg63pNtNhzA803WVKjPmBprtMiTHf0HSXaTHmG5ruMi3GbNiabjMtxmzQdJepMWaDprtMjTGg6S7TYwxousv0GPMPTXe5Bcb8Q9NdboEx/9B0l1tgzF803eU2GPMXTXe5Dcb8oekut8KYPzTd5VYY82Vrus2tMOaLprvcDmO+aLrL7TAuT9NdbolxeZruckuMS9uabnNLjEvTdJfbYlyaprvcFuOyNN3l1hiXpekut8a4JE13uT3GJWm6y+0xLknTXW6PcTma7rIExuWsMP0dYlzKStP/ecC4lJWm//OAcSkrTf/nAeNyVpj+DjEmK2NMVsaYrIwxWRljsjLGZGWMycoYk5UxJitjTFbGmKyMMVkZY7IyxmRljMnKGJOVMSYrY0xWxpgs6tfv/wDi6qJ+m/lFTwAAAABJRU5ErkJggg==",name:at("交错断续焊接符号")}]),h=V.reactive([{typeName:Ut.BellShapedWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAACGCAYAAAAYefKRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMJSURBVHhe7dFLbiNJEAXBvv+lewaYzaBkWaTEX2XIH2AbV2RxoT//7m8CjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCeMX905v8zr3Tm9vYPzikel7+ZlHpu+dYPziWdO3s/bM6fsnGL94xfQ7+c+zp9+4gXHpFdPv/FbPnn7jTowP+en0rd/gp9O3nojxqb47fWOq70zvX4jxZe6d3k7ynen9GzC+3L3T293dM717M8a3uWd6t6N7pncfwvh2t6Y3O7k1vfkwxo+5Nb25ulvTmwtg/Khb05urOpvuL4TxEs6m+yu5Nb25GMbLOJvur+DW9OaCGC/lbLr/tNV0e2GMl3M23X/Karq9OMZLOpvu32013W6A8bJW0+07rabbTTBe2mq6fYfVdLsRxstbTbevdDbdb4RxC6vp9lVW0+1mGLeh6e4VVtPthhi3sZpun03T3aYYt6Lp7plW0+2mGLeymm6fYTXdboxxO6vp9lGa7jbHuCVNd49YTbebY9ySprtHaLobgHFbmu5+StPdAIzb0nT3E5ruhmDcmqa779J0NwTj1jTdfYemu0EYt6bp7js03Q3CuD1Nd/fSdDcI4/Y03d1D090wjNvTdHcPTXfDMI5wnG7uoeluGMYRNN3douluGMYRNN3dcpxuBmIcQdPdGU13AzGOcZxuzmi6G4hxjON0c0bT3UCMYxynmzOa7gZiHEPT3Yqmu4EYx9B0t6LpbiDGMTTdrRynm6EYx9B0t3KcboZiHEPT3cpxuhmKcQxNdyvH6WYoxjE03a0cp5uhGMfQdLdynG6GYhxD093KcboZinEMTXcrx+lmKMYxNN2tHKeboRjH0HS3cpxuhmIcQ9PdynG6GYpxlP9Pfz9znG6GYhznkX/qI283xpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYMCaMCWPCmDAmjAljwpgwJowJY8KYX+3P338AJHckMzDP7f4AAAAASUVORK5CYII=",name:at("喇叭形焊缝")},{typeName:Ut.SingleBellShapedWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABnCAYAAAAdQVz5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAK5SURBVHhe7dBBjuNADAPA+f+nZ+e4CKptJ6ETtSACdWGoNpCfv/yOsliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGliOGljG/R/9vrOr0e0JllGKdrt4NXrrBMsoRbuqUtHbJ1hGKdpVk46+cYJllKJdBXdE37mIZZSi3Te9Gr0VxDJK0e5bnonub8QyStHu065Gtx/CMkrR7lOuRrcfxjJK0e4TrkR3X8IyStHubmfRzZexjFK0u9NRtC+CZZSi3R3OoptCWEYp2qUdRfuCWEYp2iUdRfuiWEYp2qUcRfvCWEYp2iUcRfviWEYp2iWsou0GWEYp2r1rFW03wTJK0e4dq2i7EZZRinavWkXbzbCMUrR7laLdhlhGKdq9YhVtN8QyStHuWatouymWUYp2z1K02xjLKEW7Z6yi7cZYRinaPUPRbnMsoxTtrlK0a4BllKLdVYp2DbCMUrS7QtGuCZZRinZXKNo1wTJK0e4KRbsmWEYp2p1RtGuEZZSi3RlFu0ZYRinaHVG0a4ZllKLdEUW7ZlhGKdodUbRrhmWUot0RRbtmWEYp2q0o2jXEMkrRbkXRriGWUYp2K4p2DbGMUrRbUbRriGWUot2Kol1DLKMU7VYeo01TLKMU7VYeo01TLKMU7VYeo01TLKMU7UTRrimWUYp2omjXFMsoRTtRtGuKZZSinSjaNcUyStFOFO2aYhmlaCeKdk2xjFK0E0W7plhGKdqJol1TLKMU7UTRrimWUYp2omjXFMsoRTtRtGuKZdRjtDnyGG2aYnmLd/7Yd243xnLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHLUwHJ83c/vPxMESWh6J6w5AAAAAElFTkSuQmCC",name:at("单边喇叭形焊缝")},{typeName:Ut.HeapWeldSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANZSURBVHhe7c5BrtswFMXQ7n/TbScfKALKlk3bsQpe4EyYpyS//u53cgOMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwphYGBMLY2JhTCyMiYUxsTAmFsbEwvgqe6M3q9ka3S8A41ddMfret7hi9L0vg/Fxd45+72l3jn7vBTA+4unRf7jbk6Pf/yKMt/r26D9d7Zuj//MFGG9zdPQd5OjoO65yZPR+5OjoOx6E8RYzo3dnzI7enjU7envGzOjdQzBeamb07gozo3dHzYzeXWFm9O5mGC+zN3pzh73Rm1l7ozd32Bu9uRHGS2yN7p+wNbrfszW6v9ve6M1NMGpbo/snbY3uR7ZG90/aGt3fAKOyNbr/hq3R/afR6PZbRqPbG2BURqPbb9oa3f8YjW6/bTS6vRjG00aj2zcYjW5/0OjuLUaj2wthPGU0un2T0eztm4xGtxfBeNhodPtGox29eavR6PYiGA8bjW7finbk87cbjW4vgPEwGt292Wijzz7fr4BGdxfAeAiN7lZA2+qrGY1uJYyH0OhuBbOjt6ug0Z2EcRqN7lYyM3q3itHoVsA4jUZ3K5kZvVsJje4EjNNodLeardH9amh0J2CcQqO7FW2N7ldDozsB4xQa3a1oa3S/IhrdnYRxCo3uVjQa3a6KRncnYZzyObpZGY3uVkWju5MwTvkc3ayMRnerotHdSRinfI5uVkaju1XR6O4kjLtodLcyGt2t7HN0cxLGXTS6WxmN7lb2Obo5CeMuGt2tjEZ3K/sc3ZyEccq/o8//B/+OPl/d5+jmJIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMLIyJhTGxMCYWxsTCmFgYEwtjYmFMhF+//wCT9z8Vxt/ZFwAAAABJRU5ErkJggg==",name:at("堆焊缝")},{typeName:Ut.SeamSeam,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIsAAACPCAYAAADKiCjpAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANiSURBVHhe7c/RTiRHEEVB//9Pr40lWxhHwbBUQ1bPuVK8nMmWpv74a7+SBzEmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKM471MfarT/u8C42ivp9+neTvdHIJxLE13U2i6OwTjWJruJlhNt4dgHEvT3U9bTbcHYRxL091PWk23h2EcS9PdT1lNtwdiHEvT3U9YTbeHYhxL0913W023B2McS9Pdd1pNt4djHEvT3XdZTbc3wDiWprvvsJpub4JxLE13V1tNtzfCOJamuyutptubYRxL091VVtPtDTGOpenuCqvp9qYYx9J0t9tqur0xxrE03e20mm5vjnEsTXe7rKbbJ8A4lqa7HVbT7ZNgHEvT3VetptsnwjiWpruvWE23T4ZxLE13v2s13T4hxrE03f2O1XT7pBjH0nT3Wavp9okxjqXp7jNW0+2TYxxL092jVtNtHMfSdPeI1XSbvzGOpenuI6vpNv9iHEvT3XtW023+g3EsTXcrq+k2/8M4lqY7WU23IcaxNN29tZpus8Q4lqa711bTbd7FOJamu3+sptt8iHEsTXcvVtNtHsI4lvbo3ct0m4cxjqU9cvOyt3f5NMaxtI9+f9nrm/w2xrG093572evv8yWMY2mr/rK33+dLGMf6zPR9voRxrEenb/NljGM9Mn2XLRjH+mj6JtswjvXedJ+tGMdaTbfZjnEsTXe5BONYmu5yCcaxNN3lEoxjabrLJRjH0nSXSzCOpekul2AcS9NdLsE4lqa7XIJxLE13uQTjWJrucgnGsU6f3nQQxrHuML3rEIxj3WF61yEYx7rD9K5DMI52+vSmQzBmE013h2DMJpruDsGYTTTdHYIxm2i6OwRjNtF0dwjGbKLp7hCM2UTT3SEYs4mmu0MwZhNNd4dgzCaa7g7BmE003R2CMZtoujsEYzbRdHcIxmyi6e4QjNlE090hGLOJprtDMGYTTXeHYBzt9OlNh2Ac6w7Tuw7BONYdpncdgnGsO0zvOgTjaCdP7zkIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmwpgIYyKMiTAmb/zx609Bd0um/KSnwAAAAABJRU5ErkJggg==",name:at("锁边焊缝")},{typeName:Ut.LockTheSlopeOpening,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAABxCAYAAADifkzQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAALeSURBVHhe7c5BjuMwFAPRvv+le2YWAwRCUXESyxQdEnib8k+gn7/7rXgYKwvGyoKxsmCsLBgrC8bKgrGyYKwsGCsLxsqCsbJgrCwYKwvGyoKxsmCsLBgrC8bKgrGyYKwsGA95HH3/Ro+j74tgfIpGd9+ERncLYHxKjW6/gRrdLoDxKTW6vbvZ6H4BjIeo0e1dzUb3i2A8TI1u70iNbhfC+BI1ur0TNbpdDOPL1Oj2DtTo9gIY36JGt8nU6PYiGN+mRreJ1Oj2QhjfNhvdJ1Gj24th/MhsdJ9gNrq/GMaPzUb3O5uN7g0wnkKNbnc1G92bYDyNGt3uZja6N8J4KjW63Yka3ZphPJ0a3e5AjW43gHEJNbp1UqPbTWBcRo1uHdTodiMYl1Kj2yup0e1mMC41G91fQY1uN4RxudnofqXZ6H5DGC8xG92vMBvdbwrjZdTo9myz0f3GMF5KjW7PpEa3m8N4OTW6PYMa3QbAaKFGt59Qo9sQGG3U6PYdanQbBKOVGt2+Qo1uw2C0U6PbI9ToNhBGu9nofkaNbkNh3MJsdE9mo/tQGLcxG90/mo3ug2Hcihrd/jcb3YfDuB01uv1HjW5vAOOW1N69uxGM21I7+v2mMG7t1dF/3AzG7R0d/faGMEbYYfQuA4wRdhi9ywBjDPfoTQYYozhH7zHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAWMI4ujHAGMU5eo8BxijO0XsMMEZxjt5jgDGKc/QeA4yVBWNlwVhZMFYWjJUFY2XBWFkwVhaMlQVjZcFYWTBWFoyVBWNlwVhZMFYWjJUFY2XBWFkwVhaMlQVjxfj5/QNv9lDtDk628AAAAABJRU5ErkJggg==",name:at("锁边坡口")}]),f=V.reactive({symbolPos:ii.top,dottedLinePos:0,leftDim:"",rightDim1:"",rightDim2:"",topDim:"",weldingSymbolInfo:"",description:"",intWeldSeam:""}),r=[{label:at("上"),value:1},{label:at("下"),value:2},{label:at("无"),value:0}],v=()=>{f.intWeldSeam=f.weldingSymbolInfo=f.leftDim=f.topDim=f.rightDim1=f.rightDim2="",P.basicSymbol.forEach(Re=>{ie.includes(Re.typeName)&&Re.position===f.symbolPos&&(Re.info="")}),["rightDim1","rightDim2","leftDim","topDim"].forEach(Re=>{P[Re].forEach(Ie=>{Ie.position===f.symbolPos&&(Ie.content="")})}),P.intWeldSeam.forEach(Re=>{Re.position===f.symbolPos&&(Re.content="")}),fe()};let _=new R.McDbWipeout,w=new R.McGePoint3d,b;V.onMounted(()=>{fs.value=520;const{wipeout:Ne,midPt:Re}=Yy();if(_=Ne,w=Re.clone(),Bo.value){b=Bo.value.clone();const Ie=b.fixedPos.sub(b.weldingPosition).normalize().mult(10);b.weldingPosition=w,b.turningPoint=w.clone().addvec(Ie),I()}else{b=new Fh,b.weldingPosition=w;const Ie=new R.McGeVector3d(10,10,0);b.turningPoint=w.clone().addvec(Ie)}fe()});const E=(Ne,Re)=>{const Ie=[];for(let He=0;He<Ne.length;He+=Re)Ie.push(Ne.slice(He,He+Re));return Ie},P=V.reactive({basicSymbol:[{typeName:Ut.none,position:ii.top},{typeName:Ut.none,position:ii.down}],suppleSymbol:[{typeName:Ut.none}],specialSymbol:[],auxiliarySymbol:[{typeName:Ut.none,position:ii.top},{typeName:Ut.none,position:ii.down}],rightDim1:[{position:ii.top,content:""},{position:ii.down,content:""}],rightDim2:[{position:ii.top,content:""},{position:ii.down,content:""}],leftDim:[{position:ii.top,content:""},{position:ii.down,content:""}],topDim:[{position:ii.top,content:""},{position:ii.down,content:""}],intWeldSeam:[{position:ii.top,content:""},{position:ii.down,content:""}]}),I=()=>{const Ne=Bo.value.clone();P.basicSymbol=Ne.getBaseSymbok(),P.suppleSymbol=Ne.getSuppleSymbol(),P.specialSymbol=Ne.getSpecialSymbol(),P.auxiliarySymbol=Ne.getAuxiliarySymbol(),P.leftDim=Ne.getLeftDim(),P.topDim=Ne.getTopDim(),P.intWeldSeam=Ne.getIntWeldSeam(),Ne.getRightDim().forEach(Ue=>{const ot=Ue.content.split("×");P.rightDim1.forEach(Pt=>{Pt.position===Ue.position&&(Pt.content=ot[0]||"")}),P.rightDim2.forEach(Pt=>{Pt.position===Ue.position&&(Pt.content=ot[1]||"")})}),f.dottedLinePos=Ne.dottedLinePos,f.description=Ne.weldingSymbolInfo.replace(/\\P/g,`
`),P.specialSymbol.length&&(f.symbolPos=P.specialSymbol[0].position),["topDim","rightDim1","leftDim","rightDim2"].forEach(Ue=>{P[Ue].length==0?P[Ue]=[{position:ii.top,content:""},{position:ii.down,content:""}]:P[Ue].forEach(ot=>{ot.position===f.symbolPos&&(f[Ue]=ot.content)})}),[{arr:i,flag:"basic",num:7,name:at("basicSymbol")},{arr:l,flag:"auxi",num:3,name:at("auxiliarySymbol")},{arr:c,flag:"supple",num:3,name:at("suppleSymbol")},{arr:h,flag:"special",num:5,name:at("specialSymbol")}].forEach(Ue=>{if(!P[Ue.name].length)Ue.name==="suppleSymbol"?P[Ue.name]=[{typeName:Ut.none}]:P[Ue.name]=[{typeName:Ut.none,position:ii.top},{typeName:Ut.none,position:ii.down}];else{let ot=P[Ue.name].filter(Pt=>Pt.position===f.symbolPos);Ue.name==="suppleSymbol"&&(ot=P[Ue.name]),ot.length&&ot.forEach(Pt=>{const mt=Pt.typeName,_t=E(Ue.arr,Ue.num);Pt.info&&(f.weldingSymbolInfo=Pt.info),_t.forEach((ft,Vt)=>{ft.forEach((we,pe)=>{we.typeName===mt&&F(Vt,pe,Ue.num,Ue.flag,we,!1)})})})}}),P.intWeldSeam.length?P.intWeldSeam.forEach(Ue=>{Ue.position===f.symbolPos&&(f.intWeldSeam=Ue.content)}):P.intWeldSeam=[{position:ii.top,content:""},{position:ii.down,content:""}],["basicSymbol","auxiliarySymbol","intWeldSeam"].forEach((Ue,ot)=>{if(P[Ue].length!==2){const mt=P[Ue].filter(_t=>_t.position===ii.top).length?ii.down:ii.top;ot===2?P[Ue].push({content:"",position:mt}):P[Ue].push({typeName:Ut.none,position:mt})}})},F=(Ne,Re,Ie,He,Ue,ot=!0)=>{if(Ue.isDisable)return;const Pt=Ne*Ie+Re;let mt=[];if(He==="basic")mt=i,mt.forEach(ft=>ft.isChecked=!1),P.basicSymbol.forEach(ft=>{ft.position===f.symbolPos&&(ft.typeName=Ue.typeName),ie.includes(Ue.typeName)&&ft.position===f.symbolPos&&(ft.info=f.weldingSymbolInfo)}),h.forEach(ft=>ft.isChecked=!1),P.specialSymbol.length=[],[c,l].forEach(ft=>{ft.forEach(Vt=>Vt.isDisable=!1)}),P.specialSymbol.length=0,h.forEach(ft=>ft.isChecked=!1),oe(),mt[Pt].isChecked=!0;else if(He==="auxi")mt=l,mt.forEach(_t=>_t.isChecked=!1),ot&&P.auxiliarySymbol.forEach(_t=>{_t.position===f.symbolPos&&(_t.typeName=Ue.typeName)}),mt[Pt].isChecked=!0;else if(He==="supple"){if(mt=c,mt[Pt].isChecked)Ue.typeName!==Ut.ThreeSidedWeldSeamSymbol&&(mt[Pt].isChecked=!1,P.suppleSymbol=P.suppleSymbol.filter(_t=>_t.typeName!==Ue.typeName));else{if(mt.forEach(_t=>{_t.typeName===Ut.none&&(_t.isChecked=!1)}),Ue.typeName===Ut.ThreeSidedWeldSeamSymbol){const _t=P.suppleSymbol.findIndex(ft=>ft.typeName===Ut.ThreeSidedWeldSeamSymbol);mt.forEach(ft=>{ft.typeName===Ut.ThreeSidedWeldSeamSymbol&&(ft.isChecked=!1)}),_t>0?P.suppleSymbol[_t].rotation=Ue.rotation:P.suppleSymbol.push({typeName:Ue.typeName,rotation:Ue.rotation})}else Ue.typeName===Ut.none?(ot&&(P.suppleSymbol.length=0,P.suppleSymbol.push({typeName:Ut.none})),mt.forEach(ft=>{ft.typeName!==Ut.none&&(ft.isChecked=!1)}),[h,i].forEach(ft=>{ft.forEach(Vt=>{Vt.isDisable&&(Vt.isDisable=!1)})})):Ue.typeName===Ut.WithPadSymbol?(h.forEach(_t=>{_t.isChecked=!1,_t.isDisable=!0}),P.specialSymbol.length=[],ot&&P.suppleSymbol.push({typeName:Ue.typeName})):(P.suppleSymbol=P.suppleSymbol.filter(_t=>_t.typeName!=Ut.none),ot&&P.suppleSymbol.push({typeName:Ue.typeName}));mt[Pt].isChecked=!0}Z()}else if(He==="special"){mt=h,mt.forEach(ft=>ft.isChecked=!1),ot&&(P.specialSymbol.length=0,P.specialSymbol.push({typeName:Ue.typeName,position:f.symbolPos})),l.forEach(ft=>{ft.typeName!==Ut.none?(ft.isDisable=!0,ft.isChecked=!1):ft.isChecked=!0}),P.auxiliarySymbol.length=0,P.auxiliarySymbol.push({typeName:Ut.none,position:ii.top},{typeName:Ut.none,position:ii.down});const _t=[Ut.ThreeSidedWeldSeamSymbol,Ut.WithPadSymbol];c.forEach(ft=>{_t.includes(ft.typeName)&&(ft.isDisable=!0,ft.isChecked=!1)}),P.suppleSymbol=P.suppleSymbol.filter(ft=>!_t.includes(ft.typeName)),P.basicSymbol.forEach(ft=>{ft.typeName=Ut.none}),i.forEach(ft=>{ft.isChecked=!1}),mt[Pt].isChecked=!0}ot&&fe()},B=()=>{const Ne=P.specialSymbol.length>0;P.auxiliarySymbol.forEach(Ie=>{Ie.position===f.symbolPos&&l.forEach(He=>{He.isChecked=!1,Ie.typeName===He.typeName&&(He.isChecked=!0)})}),P.basicSymbol.forEach(Ie=>{Ie.position===f.symbolPos&&(Ne||(f.weldingSymbolInfo=(Ie==null?void 0:Ie.info)||""),Ie.info&&(f.weldingSymbolInfo=Ie.info),i.forEach(He=>{He.isChecked=!1,He.typeName===Ie.typeName&&(He.isChecked=!0)}))}),["topDim","rightDim1","rightDim2","leftDim"].forEach(Ie=>{P[Ie].forEach(He=>{He.position===f.symbolPos&&(f[Ie]=He.content)})}),P.specialSymbol.forEach(Ie=>Ie.position=f.symbolPos),P.intWeldSeam.forEach(Ie=>{Ie.position===f.symbolPos&&(f.intWeldSeam=Ie.content)}),Z(),fe()},O=()=>{P.basicSymbol.forEach(Ne=>{ie.includes(Ne.typeName)&&Ne.position===f.symbolPos&&(Ne.info=f.weldingSymbolInfo)}),fe()},W=Ne=>{let Re="item";return Ne.isChecked&&(Re+=" checked"),Ne.isDisable||(Re+=" itemHover"),Re},Z=()=>{if(!P.suppleSymbol.filter(Re=>Re.typeName===Ut.WithPadSymbol).length)[i,h].forEach(Ie=>{Ie.forEach(He=>{He.isDisable&&(He.isDisable=!1)})});else if(f.symbolPos===ii.top){const Re=[Ut.SeamWeld,Ut.SpotWeldSeam];let Ie=!1;i.forEach(He=>{Re.includes(He.typeName)?(He.isDisable=!0,He.isChecked===!0&&(He.isChecked=!1,Ie=!0)):He.isDisable=!1}),Ie&&i.forEach(He=>{He.typeName===Ut.none&&(He.isChecked=!0)}),P.basicSymbol.forEach(He=>{Re.includes(He.typeName)&&He.position===f.symbolPos&&(He.typeName=Ut.none)})}else f.symbolPos===ii.down&&(i.forEach(Re=>{Re.typeName!=Ut.none?(Re.isDisable=!0,Re.isChecked=!1):(Re.isChecked=!0,Re.isDisable=!1)}),P.basicSymbol.forEach(Re=>{Re.position===f.symbolPos&&(Re.typeName=Ut.none)}));oe()},ie=[Ut.VWeldSeam,Ut.SingleVWeldSeam,Ut.SingleSteepVWeldSeam,Ut.InclinedWeldSeam,Ut.VFlangedEdgeSeam,Ut.SingleVFlangedEdgeSeam,Ut.UFlangedEdgeSeam],$=()=>!P.basicSymbol.filter(Re=>ie.includes(Re.typeName)&&Re.position===f.symbolPos).length,oe=()=>{P.basicSymbol.filter(Re=>ie.includes(Re.typeName)&&Re.position===f.symbolPos).length||(f.weldingSymbolInfo="")},be=V.ref(),fe=Ne=>Pn(this,null,function*(){P.suppleSymbol.filter(We=>We.typeName===Ut.TailSymbol).length||(f.description=""),P.suppleSymbol.filter(We=>We.typeName===Ut.ZSymbol).length?f.dottedLinePos=0:f.intWeldSeam="",P.basicSymbol.filter(We=>We.position===f.symbolPos&&ie.includes(We.typeName)).length||(f.weldingSymbolInfo=""),P.suppleSymbol.filter(We=>We.typeName===Ut.WithPadSymbol).length&&P.basicSymbol.forEach(We=>{We.position===ii.down&&(We.typeName=Ut.none)});const ot=rf({weldingSymbolInfo:f.description,dottedLinePos:f.dottedLinePos},P),Pt=R.MxCpp.getCurrentMxCAD();b.setSpecialSymbol(ot.specialSymbol);const mt=[ii.top,ii.down],_t=[];mt.forEach(We=>{const nt=ot.rightDim1.filter(gt=>gt.position===We)[0],je=ot.rightDim2.filter(gt=>gt.position===We)[0],lt=nt.content&&je.content?"×":"";_t.push({position:We,content:nt.content+lt+je.content})}),b.setRightDim(_t),b.setSuppleSymbol(ot.suppleSymbol),b.setLeftDim(ot.leftDim),b.setTopDim(ot.topDim),b.setAuxiliarySymbol(ot.auxiliarySymbol),b.setBaseSymbok(ot.basicSymbol),b.setIntWeldSeam(ot.intWeldSeam),b.dottedLinePos=ot.dottedLinePos,b.weldingSymbolInfo=ot.weldingSymbolInfo.replace(/\n/g,"\\P");const ft=Pt.drawEntity(b),{minPt:Vt,maxPt:we}=b.getBoundingBox(),pe=we.sub(Vt).normalize().mult(2);Vt.addvec(pe.clone().negate()),we.addvec(pe);let ke=new R.McGeLongArray;ke.copyFormAryId([ft]),R.MxCpp.App.MxCADAssist.MxExplode(ke.imp);let De=(we.x-Vt.x)*5,Se=120/300*De;const tt=yield Af({type:"image/bmp",width:De,height:Se,range_pt1:Vt.toVector3(),range_pt2:we.toVector3()});be.value.src=tt,Pt.mxdraw.updateCanvasSize();let Ge=new R.MxCADSelectionSet;Ge.crossingSelect(Vt.x,Vt.y,we.x,we.y),Ge.forEach(We=>{We.erase()}),t("receiveParameters",{formData:ot})}),Le=()=>{["topDim","rightDim1","leftDim","rightDim2"].forEach(Re=>{P[Re].forEach(Ie=>{Ie.position===f.symbolPos&&(Ie.content=Object.values(f)[Object.keys(f).findIndex(He=>He===Re)])})}),fe()},Xe=()=>{P.intWeldSeam.forEach(Ne=>{Ne.position===f.symbolPos&&(Ne.content=f.intWeldSeam)}),fe()};return V.onBeforeUnmount(()=>{_.erase(),Bo.value=null}),(Ne,Re)=>(V.openBlock(),V.createElementBlock("div",null,[V.createElementVNode("div",WT,[V.createElementVNode("div",qT,[V.createElementVNode("img",{alt:"",ref_key:"img",ref:be,style:{width:"100%",height:"100%"}},null,512)]),YT]),V.createElementVNode("div",XT,[V.createElementVNode("div",KT,[V.createElementVNode("span",ZT,V.toDisplayString(V.unref(at)("基本符号")),1),(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(E(i,7),(Ie,He)=>(V.openBlock(),V.createElementBlock("div",{class:"row",key:He},[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(Ie,(Ue,ot)=>(V.openBlock(),V.createBlock(V.unref(tn.VTooltip),{key:Ue.name,text:Ue.name,disabled:Ue.isDisable},{activator:V.withCtx(({props:Pt})=>[V.createElementVNode("div",{class:V.normalizeClass(W(Ue)),onClick:mt=>F(He,ot,7,"basic",Ue)},[V.createElementVNode("img",V.mergeProps({src:Ue.img,alt:""},Pt,{style:Ue.isDisable?"opacity: 0.3;":""}),null,16,QT)],10,JT)]),_:2},1032,["text","disabled"]))),128))]))),128))]),V.createElementVNode("div",$T,[V.createElementVNode("span",eE,V.toDisplayString(V.unref(at)("辅助符号")),1),(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(E(l,3),(Ie,He)=>(V.openBlock(),V.createElementBlock("div",{class:"row",key:He},[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(Ie,(Ue,ot)=>(V.openBlock(),V.createBlock(V.unref(tn.VTooltip),{key:Ue.name,text:Ue.name,disabled:Ue.isDisable},{activator:V.withCtx(({props:Pt})=>[V.createElementVNode("div",{class:V.normalizeClass(W(Ue)),onClick:mt=>F(He,ot,3,"auxi",Ue)},[V.createElementVNode("img",V.mergeProps({src:Ue.img,alt:""},Pt,{style:Ue.isDisable?"opacity: 0.3;":""}),null,16,nE)],10,tE)]),_:2},1032,["text","disabled"]))),128))]))),128))]),V.createElementVNode("div",iE,[V.createElementVNode("span",rE,V.toDisplayString(V.unref(at)("补充符号")),1),(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(E(c,3),(Ie,He)=>(V.openBlock(),V.createElementBlock("div",{class:"row",key:He},[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(Ie,(Ue,ot)=>(V.openBlock(),V.createBlock(V.unref(tn.VTooltip),{key:Ue.name,text:Ue.name,disabled:Ue.isDisable},{activator:V.withCtx(({props:Pt})=>[V.createElementVNode("div",{class:V.normalizeClass(W(Ue)),onClick:mt=>F(He,ot,3,"supple",Ue)},[V.createElementVNode("img",V.mergeProps({src:Ue.img,alt:""},Pt,{style:Ue.isDisable?"opacity: 0.3;":""}),null,16,aE)],10,oE)]),_:2},1032,["text","disabled"]))),128))]))),128))])]),V.createElementVNode("div",sE,[V.createElementVNode("div",lE,[V.createElementVNode("span",cE,V.toDisplayString(V.unref(at)("符号位置")),1),V.createVNode(V.unref(tn.VRadioGroup),{modelValue:f.symbolPos,"onUpdate:modelValue":Re[0]||(Re[0]=Ie=>f.symbolPos=Ie),onChange:B},{default:V.withCtx(()=>[V.createElementVNode("div",uE,[V.createVNode(V.unref(tn.VRadio),{label:"上",value:V.unref(ii).top},null,8,["value"]),V.createVNode(V.unref(tn.VRadio),{label:"下",value:V.unref(ii).down},null,8,["value"])])]),_:1},8,["modelValue"])]),V.createElementVNode("div",hE,[V.createElementVNode("span",dE,V.toDisplayString(V.unref(at)("特殊符号")),1),(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(E(h,5),(Ie,He)=>(V.openBlock(),V.createElementBlock("div",{class:"row",key:He},[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(Ie,(Ue,ot)=>(V.openBlock(),V.createBlock(V.unref(tn.VTooltip),{key:Ue.name,text:Ue.name,disabled:Ue.isDisable},{activator:V.withCtx(({props:Pt})=>[V.createElementVNode("div",{class:V.normalizeClass(W(Ue)),onClick:mt=>F(He,ot,5,"special",Ue)},[V.createElementVNode("img",V.mergeProps({src:Ue.img,alt:""},Pt,{style:Ue.isDisable?"opacity: 0.3;":""}),null,16,fE)],10,pE)]),_:2},1032,["text","disabled"]))),128))]))),128))])]),V.createElementVNode("div",mE,[V.createElementVNode("div",gE,[V.createElementVNode("div",yE,[V.createElementVNode("div",xE,[V.createElementVNode("span",vE,V.toDisplayString(V.unref(at)("左尺寸")),1),V.createElementVNode("div",_E,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:f.leftDim,"onUpdate:modelValue":Re[1]||(Re[1]=Ie=>f.leftDim=Ie),onBlur:Re[2]||(Re[2]=Ie=>Le())},null,8,["modelValue"])])]),V.createElementVNode("div",bE,[V.createElementVNode("span",wE,V.toDisplayString(V.unref(at)("上尺寸")),1),V.createElementVNode("div",AE,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:f.topDim,"onUpdate:modelValue":Re[3]||(Re[3]=Ie=>f.topDim=Ie),onBlur:Re[4]||(Re[4]=Ie=>Le())},null,8,["modelValue"])])]),V.createElementVNode("div",ME,[V.createElementVNode("span",SE,V.toDisplayString(V.unref(at)("右尺寸")),1),V.createElementVNode("div",TE,[V.createElementVNode("div",EE,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:f.rightDim1,"onUpdate:modelValue":Re[5]||(Re[5]=Ie=>f.rightDim1=Ie),onBlur:Re[6]||(Re[6]=Ie=>Le())},null,8,["modelValue"])]),PE,V.createElementVNode("div",CE,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:f.rightDim2,"onUpdate:modelValue":Re[7]||(Re[7]=Ie=>f.rightDim2=Ie),onBlur:Re[8]||(Re[8]=Ie=>Le())},null,8,["modelValue"])])])])]),V.createElementVNode("div",RE,[V.createElementVNode("div",DE,[V.createElementVNode("span",IE,V.toDisplayString(V.unref(at)("交错焊缝")),1),V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("间距")),1),V.createElementVNode("div",LE,[V.createVNode(V.unref(tn.VTextField),{onBlur:Re[9]||(Re[9]=Ie=>Xe()),type:"text",modelValue:f.intWeldSeam,"onUpdate:modelValue":Re[10]||(Re[10]=Ie=>f.intWeldSeam=Ie),disabled:!P.suppleSymbol.filter(Ie=>Ie.typeName===V.unref(Ut).ZSymbol).length},null,8,["modelValue","disabled"])])]),V.createElementVNode("div",FE,[V.createElementVNode("span",kE,V.toDisplayString(V.unref(at)("扩充文字")),1),V.createElementVNode("div",BE,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:f.weldingSymbolInfo,"onUpdate:modelValue":Re[11]||(Re[11]=Ie=>f.weldingSymbolInfo=Ie),disabled:$(),onBlur:O},null,8,["modelValue","disabled"])])]),V.createElementVNode("div",zE,[V.createElementVNode("span",UE,V.toDisplayString(V.unref(at)("虚线位置")),1),V.createVNode(V.unref(tn.VRadioGroup),{modelValue:f.dottedLinePos,"onUpdate:modelValue":Re[13]||(Re[13]=Ie=>f.dottedLinePos=Ie)},{default:V.withCtx(()=>[(V.openBlock(),V.createElementBlock(V.Fragment,null,V.renderList(r,Ie=>V.createVNode(V.unref(tn.VRadio),{onChange:Re[12]||(Re[12]=He=>fe()),key:Ie.value,label:Ie.label,value:Ie.value,style:{"margin-left":"10px"},disabled:P.suppleSymbol.filter(He=>He.typeName===V.unref(Ut).ZSymbol).length},null,8,["label","value","disabled"])),64))]),_:1},8,["modelValue"])])])]),V.createElementVNode("div",NE,[V.createElementVNode("span",VE,V.toDisplayString(V.unref(at)("焊接说明")),1),V.createVNode(V.unref(tn.VTextarea),{modelValue:f.description,"onUpdate:modelValue":Re[14]||(Re[14]=Ie=>f.description=Ie),rows:"6",class:"mb-3",disabled:!P.suppleSymbol.filter(Ie=>Ie.typeName===V.unref(Ut).TailSymbol).length,onBlur:Re[15]||(Re[15]=Ie=>fe())},null,8,["modelValue","disabled"])])]),V.createVNode(V.unref(tn.VBtn),{onClick:v,class:"btn"},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(V.unref(at)("清除行")),1)]),_:1})]))}}),vz="",GE=ms(OE,[["__scopeId","data-v-ef8817ed"],["__file","WeldingSymbolDialog.vue"]]),jE={class:"fbc",style:{"margin-top":"10px"}},HE={style:{width:"100%",height:"140px"}},WE={class:"fbc"},qE={class:"btnBox"},YE={class:"tiltle"},XE=["onClick"],KE=["src"],ZE={style:{width:"60%"}},JE={class:"btnBox fbc",style:{padding:"10px 5px"}},QE={class:"tiltle"},$E={class:"btnBox fbc",style:{padding:"10px 5px"}},e3={class:"tiltle"},t3={class:"fbc"},n3={style:{width:"75%"}},i3={class:"btnBox"},r3={class:"tiltle"},o3={class:"fbc",style:{margin:"10px",width:"75%"}},a3={style:{width:"85%",padding:"0px 10px"},class:"fbc"},s3={class:"fbc",style:{width:"75%",margin:"0px 10px"}},l3={style:{width:"85%",padding:"0px 10px"},class:"fbc"},c3={class:"fbc"},u3={class:"tiltle"},h3={style:{width:"58%"}},d3={style:{width:"20%"}},p3={class:"btnBox"},f3={class:"tiltle"},m3={style:{display:"flex","align-items":"center",width:"100%","justify-content":"center"}},g3={style:{width:"50%"}},y3={style:{display:"flex",margin:"5px 0px 10px"}},x3={style:{display:"flex","margin-left":"10px"}},v3={style:{display:"flex","justify-content":"center",width:"100%","margin-top":"5px"}},_3=V.defineComponent({__name:"GemoetricToleranceDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=[ci.LineContourdegree,ci.SurfaceContourDegree],l=V.reactive([{typeName:ci.Straightness,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAFCSURBVHhe7dQxCoAwEAXR3P/SKlikmSYSYcT58Jopt9hx7cgnYIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8b4YIwPxvhgjA/G+GCMD8bH/jy6x0YYl7V7dJtNMC5rc3SfDTAua3N0nw0wPtI+8PryOozxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGB+M8cEYH4zxwRgfjPHBGJVxnJpUjwbRh+nHAAAAAElFTkSuQmCC",name:at("直线度")},{typeName:ci.Flatness,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABuCAYAAADGWyb7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAJ+SURBVHhe7dAxDtxQDEPB3P/SSWpjGq/1DQomgWkeVOnP//2tlRgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH+NxX5t+8BDjUV+dfvEA4zFfnv7xAOMxX57+8QDjMV+dfvEQ4zHX6WY7TXcPMR6h6W47TXcPMR6h6W47TXcPMR6h6W6763QzgHGcprvtNN0NYByn6W47TXcDGMdputtO090AxnGa7ra7TjdDGEdputtO090QxlGa7rbTdDeEcZSmu+003Q1hHKXpbrvrdDOIcYymu+003Q1iHKPpbjtNd4MYx2i6207T3SDGMZrutrtON8MYR2i6207T3TDGEZruttN0N4xxhKa77TTdDWMcoeluu+t0cwDjY5ruttN0dwDjY5ruttN0dwDjY5ruttN0dwDjY5rutrtON4cwPqLpbjtNd4cwPqLpbjtNd4cwPqLpbjtNd4cwPqLpbjNNdwcx/kzT3Xaa7g5i/Jmmu+003R3E+DNNd9tpujuI8WfX6WY7TXeHMf5E0912mu4OY/yJprvtNN0dxvgTTXfbabo7jPEn1+lmO013L2C8TdPddpruXsB4m6a77TTdvYDxNk1322m6ewHjbdfpZjtNdy9hvEXT3Xaa7l7CeIumu+003b2E8ZYvT/94CeMtX51+8SLGW746/eJFjLd8dfrFixgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+RgrH2PlY6x8jJWPsfIxVj7GysdY+Rgr2p+//wDqI2fIuIp4ZQAAAABJRU5ErkJggg==",name:at("平面度")},{typeName:ci.Roundness,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHEAAABvCAYAAADboi87AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMRSURBVHhe7c5LDiM3EETBuf+lx14LwW7JLn6SqAfEJlGU+s+//W3xOLYsHFsWji0Lx5aFY8vCsWXh2LJwbFk4tiwcWxaOLQvHloVjy8KxZeHYsnBsWTi2LBxbFo4tC8eWhWPLwjHWr+k3AnGMUZ3+IwDH461I/3sojkfalb7lMByPc0L6rkNwPMav6Tfe/JLeH4DjEb5J7/6Pb9PbjThu9U16V+0tvdmE4zZv6c1Mb+nNBhy3eEtvVnlK94txXO4p3e/wlO4X4rjUU7rfbZRuF+G4zFO6P8Uo3S7AcZlRuj3NKN1OxnGJUbo91SjdTsRxulG6Pdko3U7EcTqluwSjdDsJx6lG6TaF0t0kHKdSuksySrcTcJxG6S6R0t0EHKdRukuldFeM4xRKd8mU7opxnELpLp3SXSGOUyjdpVO6K8SxnNLdDZTuCnEsp3R3i890U4hjOaW7WyjdFeFY7jPd3ETprgjHUkp3N1G6K8KxlNLdTZTuinAspXR3m890U4RjKaW723ymmyIcSynd3eYz3RThWErp7jZKdwU4llK6u43SXQGOpZTubvOZbopwLKV0d5vPdFOEYymlu9t8ppsiHEsp3d1E6a4Ix1JKdzdRuivCsZzS3S2U7opwLKd0dwuluyIcyynd3eIz3RTiWE7p7gZKd4U4TqF0l07prhDHKZTuko3SbSGOU4zSbSqlu2Icp1G6S6V0V4zjNKN0m0bpbgKOUyndJRml2wk4TjVKtymU7ibhOJ3SXYJRup2E43SjdHuyUbqdiOMSo3R7KqW7yTguM0q3pxml28k4LjVKt6cYpdsFOC71lO53ekr3i3Bc7ind7/CU7hfiuMVberPKU7pfjOM2b+nNTG/pzQYct/omvav0TXq3CccjfJve/lffprcbcTzGr+k33vyS3h+A43FOSN91CI7H2pG+4zAcj7ci/e+hOMaoTv8RgGO0X9L7QBxbFo4tC8eWhWPLwrFl4diycGxZOLYsHFsWji0Lx5aFY8vCsWXh2LJwbFk4tiwcWxaOLQvHloVjy8Kxxfjz9x8ogK+OZ4gxTQAAAABJRU5ErkJggg==",name:at("圆度")},{typeName:ci.Cylindricity,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsCAYAAACPZlfNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAANQSURBVHhe7c7BCuM4EATQ+f+fnt0cBoJ57cixJVWgC96lVI395//8bT+FZcvFsuVi2XKxbLlYtlwsWy6WLRfLlotly8Wy5WLZcrFsuVi2XCxbLpYtF8uWi2XLxbLlYtlysWy5WLZcLFsuli0Xy5aL5U95j95TvEfvg1j+DEW7BMdoM4Dlz1C0203RbgDLn1BF290U7Qaw/AmKdrsp2g1iGa+Ktrsp2g1iGU/RbjdFuwtYRlO0262KthewjFVF290U7S5iGUv59P6e9+1MVbS9iGWkGdF3nqBo9wWWkWZG3/tWFW2/wDLOiui731C0+xLLOCuj749StLuBZZTR6FZGorsRinY3sIzyKboZ8Sm6OaNodxPLGGfR/htn0V6qaHsTywhn0f6Os2h/pGj3AJYRqmj7hCravqui7QNYbldF2ydV0fYfRbuHsNyqirYzKNq9VNH2ISy3qqLtLMqd3YNYbqVoN5PyzWYClttU0XY25eztlff7SVhuo2i3gjLyNhnLLRTtVlGq/pXj/SQsl6ui7UrHqHvleDcRy+WqaLvSaHQ7CculzqL9SiPR3UQslzqL9iuNRHcTsVzmU3Sz0qfoZjKWy3yKblY6i/YLsFxiJLpb6SzaL8ByiZHobqUq2i7CcrrR6HalKtouwnKqKtXb8X6VKtouxHIqZeRttSraLsRymipn7+/3KynaLcZyGuWbzWxVtF2M5RRVRnbHzUxVtN2A5RSKdi+KdjMo2m3C8nFVtH2pou2Tqmi7CcvHKdq9q6LtE6pouxHLRynaHZ1F+zvOov1GLB9TRVs5i/ZXfYpuNmP5GEW7M5+imxEj0d1mLB9RRdtPRqPbd1ei+wAsH6FoN2p19A8BWN5WRdurVkTfDcHyNkW7O2ZF3wrC8hZFu6c8HX0jCMtbFO1mqTKyO24Csfyaot1uVbQNw/IrVbTdTdEuEMuvKNrtVkXbQCwvq6Ltbop2oVhepmi3WxVtQ7G8pIq2uynaBWN5iaLdbop24VgOU7RLoGgXjuUlx2iT4BhtfgDLy/5Fb0n+RW8/gmXLxbLlYtlysWy5WLZcLFsuli0Xy5aLZcvFsuVi2XKxbLlYtlwsWy6WLRfLlotly8Wy5WLZcrFsuVi2SH/+/gesHHGw7eaGswAAAABJRU5ErkJggg==",name:at("圆柱度")},{typeName:ci.LineContourdegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAYAAAAdHLWhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAI1SURBVHhe7c5BjqNAFETBvv+le2bZsgKMigKSUqYUm+dftn/+77eiMVYOxsrBWDkYKwdj5WCsHIyVg7FyMFYOxsrBWDkYKwdj5WCsHIyVg7FyMFYOxsrBWDkYKwdj5WCsHIyVg7FyMFYOxsrBWDkYKwdj5WCsHIyvsjfdvwxjrFnTd4dijHL19JtBGCPcPf2HAIyPenr6Tw9ifMTI9D0yMn3PAxhvd3R6O+Lo9PZmjLc5Mr2b5cj07kaMt/g2vbnKkendDRgv9216c4dv05uLMV5qb7p/wt50fyHGy+xN90/am+4vwniJvek+wd50fwHG6fam+yRb0+0FGKfbmm4TbU23kzFOtTXdJtuabidinGZrun0DTXcTMU6j6e4ttqbbSRin2Jpu32Rrup2AcQpNd2+k6W4CxtM03b3V1nR7EuNpmu7eTNPdSYynaLp7O013JzGeouluBZruTmA8RdPdCjTdncA4TNPdKjTdncA4TNPdSjTdDWIcpuluJZruBjEO03S3Ek13gxiHfU43q9F0N4hxiKa7FX1ON4MYh2i6W9HndDOIcYimuxV9TjeDGIdouluRprsBjEM03a1I090AxiGa7lb0Od0MYhz2d/p8ZX+nzwcxVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrws/vP1gI08FUACh8AAAAAElFTkSuQmCC",name:at("线轮廓度")},{typeName:ci.SurfaceContourDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAYAAAAdHLWhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAIvSURBVHhe7dDLauRAFERB//9PewyzMG5C/agqSSmRCbE53LIbff3su6IxVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYLyET6b3F8EYafX0PwIxxjhi+r9BGE931vRbTsZ4moTpd52I8RSfTO9f+XT6GydgPNS709sZ70zvDsZ4mHemdyu9M707COMhXk1v9vRqenMAxt09m+6P8mp6szPGXT2b7s/wbLrfEeNutqbbsz2b7nfCuIut6TbFs+l+B4zLbU23aZ5N94sxLrU13abamm4XY1xqa7pNtjXdLsS4zNZ0ewVb0+0ijMtoursSTXeLMC6h6e5qtqbbBRinbU23V6TpbgHGaZrurmprup3EOE3T3ZVpupvEOEXT3dVpupvEOEXT3R1oupvAOEXT3R1oupvAOEzT3V1oupvAOEzT3Z1ouhvEOEzT3Z1ouhvEOOxxurkbTXeDGIdoursbTXeDGIdourujx+lmEOMQTXd39DjdDGIc0v1O32cQ45Du7/SNBjAO6f5O32gA45Dud/o+gxiHdf+nbzOIsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrB2PlYKwcjJWDsXIwVg7GysFYORgrwtf3P04oQotbv3IGAAAAAElFTkSuQmCC",name:at("面轮廓度")},{typeName:ci.Parallelism,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHUAAAB2CAYAAAD2kNwSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMfSURBVHhe7cpBbiQxDARB///T3j0ag+CFDalVGiYQF7J+/vc7rsPjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbjyMbj1/ib/k/9Tf9FePwKn2nz1GfaLMDj9aq07VLaLcDj9ZR2XVXaLsDj1aq07VLaLcLj1ZR2XVXaLsLjtaq07VLaLcTjtZR2XVXaLsTjlaq07VLaLcbjlZR2XUq7DXi8jtLuCaXdBjxepUrbLqXdJjxeRWnXVaXtJjxeo0rbLqXdRjxeQ2nXVaXtRjxeoUrbLqXdZjxeQWnXVaXtZjzGq9K2S2n3Ah7jKe26lHYv4TGa0u4Jpd1LeIxVpW2X0u5FPMZS2nVVafsiHiNVadultHsZj5GUdl1V2r6MxzhV2nYp7Q7AYxylXVeVtgfgMYrS7gml3SF4jKK061LaHYTHGEq7riptD8JjhCptu5R2h+ExgtKuq0rbw/B4vCptu5R2B+LxeEq7riptD8Tj0aq07VLaHYrHoyntuqq0PRSPx1LaPaG0OxiPx1LadSntDsfjkZR2XVXaHo7H41Rp26W0C8DjcZR2XVXaBuDxKFXadintQvB4FKVdV5W2IXg8RpW2XUq7IDweQ2nXVaVtEB6PoLR7QmkXhscjKO26lHaBeHyd0q6rSttAPL6qStsupV0oHl+ltOuq0jYUj6+p0rZLaReMx9co7bqqtA3G4yuqtO1S2oXj8RVKu64qbcPxuJ3S7gml3QV43KpK2y6l3SV43Epp11Wl7SV43KZK2y6l3UV43EZp11Wl7UV43KJK2y6l3WV43EJp11Wl7WV4XK5K2y6l3YV4XE5p11Wl7YV4XEpp94TS7lI8LlOlbZfS7mI8LqO066rS9mI8LqO061LaXY7HZT7T5gml3eV4XOYzbZ76m/5fgMeRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjceRjccR6+f3HzqUJkJd55AeAAAAAElFTkSuQmCC",name:at("平行度")},{typeName:ci.Perpendicularity,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAB2CAYAAAAdp2cRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAIOSURBVHhe7dAxbhwwEARB/f/TJ4c2VMroYBszQCXNjfj1Z59JYpz7GOc+xrmPce5jnPsY5z7GuY9x7mOc+xjnPsa5j3HuY5z7GOc+xrmPce5jnPsY5z7GuY9x7mPM+Xt6D2JM0XQXw5ii6S6GMUXTXQxjiqa7GMYUTXcxjCma7mIYUzTdxTCmaLqLYUzRdBfDmKLpLoYxRdNdDGOKprsYxhRNdzGMKZruYhhTNN3FMKZouothTNF0F8OYoukuhjFF010MY4qmuxjGFE13MYwpmu5iGFM03cUwpmi6i2FM0XQXw5ii6S6GMUXTXQxjiqa7GMYUTXcxjCma7mIYUzTdxTCmaLqLYUzRdBfDmKLpLoYxRdNdDGOKprsYxhRNdzGMKZruYhhTNN3FMKZouothTNF0F8OYoukuhjFF010MY4qmuxjGFE13MYwpmu5iGFM03cUwpmi6i2FM0XQXw5ii6S6GMUXTXQxjiqa7GMYUTXcxjCma7mIYUzTdxTCmaLqLYUzRdBfDmKLpLobxqe3n9E+PMT6zefqrxxif2X6f/ushxmc2T3/1GONT27/TH/0HjHMf49zHOPcxzn2Mcx/j3Mc49zHOfYxzH+Pcxzj3Mc59jHMf49zHOPcxzn2Mcx/j3Mc49zHOfYxzH+Pcxzj3Mc59jHMf49zHOPcxzn2Mcx/j3Mc49zHOfYxz2tfnG9KSrK0xvl/KAAAAAElFTkSuQmCC",name:at("垂直度")},{typeName:ci.TiltDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAYAAAAdHLWhAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAJFSURBVHhe7dRJbsQwEEPR3P/SSSfInM9KD5ZMqUjgbT5qJRh+uuw5rGEMHxjDB8bwgTF8YAwfGMMHxvCBMXxgDB8YwwfG8IExfGAM4XXUB8IYv/we3QyCMb5Ro9sBMMa7anQ/AMa4qEb3g2CMCzW6HQhje2p0OxjG1tTodgKMbanR7SQYW1Kj24kwtqNGt5NhbEWNbk+AsQ01uj0JxhbU6PZEGLenRrcnw7g1Nbo1gHFb1ejeAMYtVaN7Exi3U43ujWDcSjW6N4NxG9Xo3hDGLVSje1MYl1eN7o1hXFo1ujeHcVnV6H4BGJdUje4XgXE51eh+IRiXUo3uF4NxGdXofkEYl1CN7heFcQlqdLswjPbU6HZxGK2p0e0GMNpSo9tNYLSkRrcbwWhHjW43g9GKGt1uCKMNNbrdFEYLanS7MYynU6PbzWE8lRrdNoDxNNXovgGMp6hG901gnK4a3TeCcapqdN8Mxmmq0X1DGKeoRvdNYRyuGt03hnGoanTfHMZhqtF9cByiGt3HG4yHq0b38QnjoarRffyA8TDV6D7+wHiIanQfCOMh1Og2JIwPU6PbKGF8iBrdxr8w3k2NbuMqGO+iRrdxNYw3U6PbuAnGm6jRbdwM49XU6DbugvEqanQbd8P4LzW6jYdgLGVTP0SMUvY1ep8BMErZ1+h9BsBYyox/cR86j95jIIzhA2P4wBg+MIYPjOEDY/jAGD4whg+M4QNj+MAYPjCGD4zhA2P4wBg+MIYPjOEDY/jAGD4whg+MYeHp+QW0S7wDo2QXJQAAAABJRU5ErkJggg==",name:at("倾斜度")},{typeName:ci.PositionalDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAABsCAYAAACPZlfNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAMaSURBVHhe7dDhSuVQDIXRef+XdkZEkLBOe6rXnGTIB+tP3G3l/vnX22iFx1EXj6MuHkddPI66eBx18Tjq4nHUxeOoi8dRF4+jLh5HXTyOungcdfE46uJx1MXjqIvHURePoy4eR108tvaZ/vYf4LGtmDbN8dhWTJvmeGwrpk1zPLYV06Y5HtuKadMcj23FtGmOx7Zi2jTHY1sxbZrjsa2YNs3x2FZMm+Z4bONpekczPJb2qvTuBngs6bfStwrjsZSs9O2CeCwjO/0PxfBYwk53z9z9XcVniuHxuLv0zLuYNu/u0jNF8HjUVdp/FdPmq6u0L4DHY67SPoppE12l/WE8HnGV9hLTZmWVtgfxeMQqbVdi2qys0vYgHtOt0vZKTJsrq7Q9hMd0Srs7MW3uKO0O4TGV0m5HTJsdSrsDeEyltNsR02aH0u4AHtMo7XbFtNmltEvGYxql3a6YNruUdsl4TKO02xXTZpfSLhmPaWLaPBHT5gmlXSIeUyjtnohp84TSLhGPKZR2T8S0eUJpl4jHH5k+0m/zAjz+yPSRfpsX4PFHpo/027wAjz8yfaTf5gV4TKG0eyKmzRNKu0Q8plDaPRHT5gmlXSIeUyjtnohp84TSLhGPaZR2u2La7FLaJeMxjdJuV0ybXUq7ZDymUdrtimmzS2mXjMdUSrsdMW12KO0O4DGV0m5HTJsdSrsDeEy1Sts7MW3urNL2AB7TrdL2SkybK6u0PYTHI5R2V2LaXFml7SE8HrFK25WYNiurtD2Ix2NWaSsxbWSVtofxeNRV2n8V0+arq7QvgMfjrtL+U0ybT1dpXwSPJdy188zOJqZnCuGxjN1W++++pzAeS8lK3y6Ix5J+K32rMB5Le1V6dwM8tvDd9K5GeGwrpk1zPLYV06Y5HtuKadMcj23FtGmOx7Zi2jTHY1sxbZrjsa2YNs3x2FZMm+Z4bCumTXM8thXTpjke24pp0xyPoy4eR108jrp4HHXxOOricdTF46iLx1EXj6MuHkddPI66eBx18Tjq4nHUxeOoi8dRF4+jLh5HXTyOungcJf15+wsBQMJfZ/0u7gAAAABJRU5ErkJggg==",name:at("位置度")},{typeName:ci.Coaxiality,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAACDCAYAAABY+O+7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAWxSURBVHhe7c7LDuQoEEXB/v+f7pklSkViFy9DiyPFJnVx1Z//+3v9k3i8zsfjdT4er/PxeJ2Px+t8PF7n4/E6H4/X+Xi8zsfjdT4er/PxeJ2Px+t8PP5TsrT9h/B4pBHpu4fi8Rgz0+8dhMftrU7/YXM8buvr9J82xeN2WtJ3pCV9ZzM8buVtetvibXq7ER638Da9HeFtersBHj/3lN7M8ia9+xiPn3pKb1Z4Sm8+xONnamn/hVraf4THT9TS/ku1tP8Aj8vV0n4HtbRfjMelsrTdTS3tF+JxmSxtd1VL+0V4XCJL293V0n4BHqfL0vYUWdouwON0Wdq2+DV9o0WWtpPxOFWWtr8Ylb79iyxtJ+Jxmixt35qVfuutLG0n4XEapd0bK9LvvpGl7SQ8TpGl7ZOWRrz9RZa2E/A4XJa2T96kdzVv0rsnSrsJeBxOaVfzJr37xVN6U5Ol7WA8DpWlbeYpvelRS/sapd1gPA6ltMvU0n6UWtrXKO0G4nEopV0mS9sZsrTNKO0G4nEYpV0mS9uZsrTNKO0G4XEYpZ1kabtClraitBuExyGUdpKl7UpKO1HaDcLjEEo7UdqtlqWtKO0G4HEIpV2Upe0XsrSNlHYD8NhNaSdKuy8p7URp14nHbkq7SGn3tSxtI6VdJx67Ke0ipd0OlHaR0q4Tj12UdpHSbhdZ2kYxbTrx2EVpFyntdqK0i5R2HXjsorQrZWm7E6VdpLTrwGOXmDaR0m5HSruS0q4Dj82UdpHSbkdKuyimTQcemyntSkq7XSntIqVdIx6bKe1KSrudKe1KSrtGPDZT2pWUdjtT2pWUdo14bKa0Kyntdqa0KyntGvHYLKZNFNNmd0q7ktKuEY/NYtqUlHYniGlTUto14rGJ0q6ktDtBTJsopk0jHpso7UpKuxMo7UoxbRrx2ERpV1LanUBpV4pp04jHJkq7ktLuBEq7UkybRjw2UdqVlHYnUNqVYto04rGJ0q6ktDuB0q6ktGvAYxOlXUlpdwKlXUlp14DHJkq7ktLuBEq7UkybRjw2UdqVlHYnUNqVYto04rGJ0q6ktDuB0q4U06YRj02UdiWl3QmUdqWYNo14bBbTpqS0O0FMmyimTSMem8W0iWLa7E5pV1LaNeKxWUybKKbN7pR2JaVdIx6bKe1KSrudKe1KSrtGPDZT2pWUdjtT2pWUdo14bKa0KyntdhbTJlLaNeKxmdIuUtrtSGkXxbTpwGOXmDaR0m5HSruS0q4Dj12UdiWl3Y6UdiWlXQceuyjtIqXdTpR2kdKuA49dlHaR0m4nSrtIadeBxy5KuyhL2x0o7SKlXSceuyntIqXdDpR2kdKuE4/dlHZRlrZfUtqJ0q4Tj92UdqK0+0qWtpHSbgAeh1DaRVnafkFpJ0q7AXgcQmknWdqulKWtKO0G4HGILG0lS9sVsrQVpd0gPA6jtJMsbWfL0jajtBuEx2GUdpksbWeppb1kaTsIj0Mp7TK1tB+plvYZpd1APA6ltKuppf0ItbTPZGk7EI/DKe1qntKbFk/pTY3SbjAeh8vStuYpvXnrTXpXk6XtYDxOobR78ja9lbfp7ROl3QQ8TpGl7ZOV6fffUNpNwuM0Wdq+MTv95htZ2k7C41RKu1+MTr/xC6XdRDxOlaXtr3rTN3+Vpe1EPE6XpW2Pp/SmR5a2k/G4RJa2J8jSdgEel6il/c6ytF2Ex2Vqab+jWtovwuNStbTfSS3tF+JxuVra76CW9ovx+Ila2n/lKb35AI+feUpvVnpKbz7C46ee0pvZ3qR3H+Lxc2/Su9HepHcb4HEbb9PbHm/T203wuJVf0vu3fk3f2AiPW9ol/bcN8bi1r9J/2RiPR1iVfvsAPB5ndPqNw/B4tNb0rYPxeJ2Px+t8PF7n4/E6H4/X+Xi8zsfjdT4er/PxeJ2Px+t8PF7n4/E6H4/X+Xi8jvbn73/ATYsgsquSGAAAAABJRU5ErkJggg==",name:at("同轴度")},{typeName:ci.SymmetryDegree,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABlCAYAAABUfC3PAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAFHSURBVHhe7dAhDsAwEMTA/v/TbVlADaKA+oBXGmKSU653d8bBGBfGuDDGhTEujHFhjAtjXBjjwhgXxrgwxoUxLoxxYYwLY1wY48Ko+XP0/hAYFdboFhlGhTW6RYZRYY1ukWFUGKM7BsAYF8a4MMaFMS6McWGMC2NcGOPCGBfGuDDGhTEujHFhjAtjXBjjwhgXxrgwxoUxLoxxYYwLY1wY48IYF8ZtbY3+5xDGLe07+qcDGLe07+ifDmDc1tbofw5hjAtjXBjjwhgXxrgwxoUxLoxxYYwLY1wY48IYF8a4MMaFMS6McWGMC2NcGOPCGBfGuDDGhTEujHFhVBijOwbAqLBGt8gwKqzRLTKMCmN0xwAY48IYF8a4MMaFMS6McWGMC2NcGOPCGBfGuDDGhTEujHFhjAtjXBjjwhgXxrgwxoUxLozRXPcDtK31g/W1X9AAAAAASUVORK5CYII=",name:at("对称度")},{typeName:ci.CircleJumping,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABnCAYAAAAdQVz5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAKbSURBVHhe7cxLimMxEATAvv+le8YLgzAh+bUNrz5SQmyyUvr5n98jLZZHDiyPHFgeObA8cmB55MDyyIHlkQPLIweWRw4sjxxYHjmwPHJgeeTAcjtjdA/CciuKdgFYbmMWbQOw3MIq2gdg2d676E0Alq1did4FYNnW1ehtAJbt/DX6IwDLVj6J/gnAso1Po78CsGzhm+i/ACzL+zb6MwDL0lZ5d3/m9c8gLMta5d19zOu/QViWtMqVzZjx30Asy1lltVn1CbAsZZV3u1WfAMsyVnm3u3ILxrKEVa5sr9yCsUxvlavb1X18H4hlarNo+6D85R6IZVqzaPuk/OUeiGU6q2j/pHyyCcIylVW0HymfbIKwTGMV7UfKN7sALFNYRftXyje7ACzDraL9q1mubrULwDLcLNqKot2Dol0AluEU7WYU7R4U7QKwTGGM7jOKdk+KdgFYlqZo96RoF4BlWYp2I0W7ACzLUrQbKdoFYFnSLNq+GqN7EJYlKdoVwrKcWbQthGU5inbFsCxH0a4YlqUo2hXEshRFu4JYlqFoVxTLMhTtimJZwizaFsWyBEW7wliWoGhXGMv0FO2KY5meol1xLFNTtGuAZWqKdg2wTGsWbRtgmZaiXRMsU5pF2yZYpqRo1wjLlBTtGmGZjqJdMyzTUbRrhmUqinYNsUxF0a4hlmnMom1DLNNQtGuKZRqKdk2xTEHRrjGWKSjaNcYynKJdcyzDKdo1xzLULNo2xzKUot0GWIZStNsAyzCKdptgGUbRbhMsQyjabYRlCEW7jbC8naLdZljeTtFuMyxvNYu2m2F5K0W7DbG8laLdhlje6jXabIrl7cbovimWRw4sjxxYHjmwPHJgeeTA8siB5ZEDyyMHlkcOLI9wP7//ACh6RmsONhjLAAAAAElFTkSuQmCC",name:at("圆跳动")},{typeName:ci.FullBeat,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAABzCAYAAACrQz3mAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAQ7SURBVHhe7c9BjuQgEAXRvv+le6YWliz0wC6wE7JFSLH5GVhVP//53f4ZOW5zynGbU47bnHLc5pTjNqcctznluM0px21OOW5zynGbU47bnHLc5pTjNqcctznluM0px21OOW5zynGbU47bnHL8E5aomWGJmk45pleoi1ao65RjamuojbSG2k45prWF+ihbqO+UY0qv0JsIr9CbTjmm8w5697Z30LtOOabyLnr7pnfR2045pvEb9P4tv0HvO+WYwm/RN97wW/SNTjkubw/6ztP2oO90ynFpe9G3nnIEfa9Tjks6ir75hKPom51yXM4WV/eD8ptP2OLqflB+c0COS9niTnNw/uYTtri6nym/OyDHZWzRarQf/RO2aDXaj/4BOS5hi6tO+/nNiC2uOu3nN4NynG6Lq652O7/rtcVVV7ud3w3Kcaot7rS12/ldjy3utLXb+d2gHKfZ4k7bup9v39riTtu6n2+Dcpxii7t9636+fWOLu33rfr4NyjHcFt/0reZ8u2uLb/pWc74NyjHUFuo/iqumvF/ZQv1HcdWU9wE5htlC/aG4asp7yxbqP9a46sr7gBxDbKH+UNzp1Mgaas+KO52aTjm+bgv1Z8WdTk1pDbWl4k6nplOOr1pDbalQ97FEzWEL9aVC3ccSNZ1yfM0aaqVQ97FEzWENtVKo+1iiplOOrynUyRpqP5aoORTqpFB3WKKmU46vWaKmplB3WKLmsERNTaHusERNpxxf9UC3lkLdYYmaswe61ayh9rBETaccl1OoO1uiZlSh7myJmk45LqdQd7ZEzahC3dkSNZ1yXEqhrrREzYhCXWmJmk45LqVQJw90G1Wokwe6DchxGWuojVSoC5bjMgp10Qp1wXJcwhpqI62hNliOSyjURSvUTZDjEgp10Qp1E+Q4XaEuWqFukhynK9RFK9RNkuNUhbpohbqJcpyqUBetUDdRjtOsoTZSoW6yHKcp1EUr1E2W4zSFukhrqJ0sxykKddEKdQvIcYpCXbRC3QJyDFeoi1aoW0SO4Qp10Qp1i8gx1BpqIxXqFpJjqEJdtELdQnIMs4baSGuoXUiOYQp10Qp1i8kxTKEuWqFuMTmGKNRFK9QtKMcQhbpohboF5fi6Ql20Qt2icnxdoS5aoW5ROb5qDbWRCnULy/FVhbpohbqF5fiqQl2kNdQuLMfXFOqiFeoWl+NrCnXRCnWLy/EVhbpohboEcnxFoS5aoS6BHB+3htpIhbokcnxcoS5aoS6JHB9XqIu0htokcnxUoS5aoS6RHB9VqItWqEskx8cU6qIV6pLJ8TGFumiFumRyfEShLlqhLqEcHzET+v0J5ThsNvQfEspx2Ezo9yeV4yNmQb89qRwfc3X0mxPLcZtTjtucctzmlOM2pxy3OeW4zSnHbU45bnPKcZtTjtucctzmlOM2pxy3OeW4zSnHbU45btP58/sPTui//PWeJpwAAAAASUVORK5CYII=",name:at("全跳动")},{typeName:ci.None,img:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAADYCAYAAAB4K3ZgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAGdYAABnWARjRyu0AAAb9SURBVHhe7dLRbiM3EAXR/f+f3jhINlCIIkdSz7CbZBVwXjqX9krOr59+S3oEHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFCbbTRf/CoQ0Wjn3kwPOogT0S/50B41CKqRv/WA+FRDzoh+twHwqMa9ln0HR4Ij0ew+6LvV3w8wunRd6Jb4XF7q0afRWXh8Qgzot/7CYp2KgmPx6Bol4WinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4qgaKeS8KgiKNqpJDyqCIp2KgmPKoKinUrCo4poo43KwqMKoGinsvCoAijaqSw8qgCKdioLjyqAop3KwqMKaKONSsOjklG0U2l4VDKKdioNj0pG0U6l4VHJKNqpNDwqGUU7lYZHJWujjcrDoxJRtFN5eFQiinYqD49KRNFO5eFRiSjaqTw8KlEbbbQEPCoJRTstAY9KQtFOS8CjklC00xLwqCQU7bQEPCoJRTstAY9K0kYbLQOPSkDRTsvAoxJQtNvBn+i/bQSPSkDRbkVX0ZsN4FEJKNpVF4l+3sLwqARttKnoiej3LAiPmoyi3Z2qR//mxeBRkxlH39VC8Kgflhv9TRaDx7LsjOhvvyA8lmT1o7/bwfBYjn0XfZeaBo/l7NK7n412r9poo3R4LOmJ6PfMRtHuFUU7pcKjJqJo94qinVLhURO10aZF0U6p8KhJKNq1KNopFR41CUU70kYbpcKjJqFoRyjaKQ0eNUkbbXoo2ikNHjUBRbseinZKg0dNQNGuh6Kd0uBRE1C066FopzR41AQU7Xoo2ikNHjVBG21GKNopDR71MIp2IxTtlAaPehhFuxGKdkqDRz2Mot0IRTulwaMe1Iu2I220USo86kEU7a600Uap8KgHUbS70kYbpcKjHkLR7h1ttFEqPOohFO2uULRTKjzqIRTtrlC0Uyo86gEU7d5B0U6p8KgHULR7B0U7pcKjbkbR7l0U7ZQKj7oZRbt3UbRTKjzqZhTt3kXRTqnwqBtRtPsERTulwqNuRNHuExTtlAqPukkv2n6Cop1S4VE3oWj3KYp2SoVH3YSi3aco2ikVHnUDinbfoGinVHjUDSjafaONNkqHRwX1ou032mijdHhUEEW7b7XRRunwqIBetP1WG22UDo/6Ui/aRrTRRunwqC9RtItqo43S4VFf6EXbqDbaKB0e9aFetL1DG22UDo/6EEW7u7TRRunwqA/0ou1d2mijdHjUByja3amNNkqHR72pF23v1EYbpcOj3tCLtndro43S4VFvoGj3hDbaKB0edaEXbZ/QRhulw6MGetH2KW20UTo8aoCi3ZPaaKN0eFRHL9o+qY02SodHgV60fVobbZQOjwIU7WZoo43S4VGNXrSdoY02O1rss+JRL3rRdpY22uykjTYF4VEvKNrN1EabnVC0KwaP+lcv2s7URpudULQrBo/60Yu2s7XRZicU7YrB4/F60TZDG212QtGuGDwebRTtM1C02wVFu2LweKxRtM9C0W4XFO2KweORRtE+E0W7XfSibSF4PM4o2mejaLeLXrQtBI9HGUX7Cija7aIXbQvB4zFG0b4Kina76EXbQvB4hFG0r6aNNrvoRdtC8Li9UbSvqI02O6FoVwgetzaK9lVRtNtFL9oWgcdtjaJ9ZRTtdtGLtkXgcUujaF8dRbtd9KJtEXjcylX0ZgUU7XbRi7ZF4HEbV9GbVVC020Uv2haBxy1cRW9W00abXfSibRF4XNpV9GZVFO120Iu2ReBxWVfRm5VRtNvBKNoXgMclXUVvVkfRbgejaF8AHpdyFb3ZBUW7HYyifQF4XMZV9GYnFO12MIr2BeBxCVfRmx1RtFvdKNoXgMfyRtF+Z71ou7JRtC8Aj6WNov3uetF2ZaNoXwAeyxpF+1P0ou2qrqI3yfBYzlX05jS9aLuiq+hNMjyWMor2J+tF29VcRW+S4bGMUbTX9f+Ef0fvqruK3iTDYwmjaK9/RKKfN1Mk+nnJ8JhuFO31f6dF30EBeExzFb0ROyH63IXgMcVV9Ebv2TH6nMXgcbpRtFfcqtFnKQqPU42ivZ43K/rdG8HjFFfRG2kheJxiFO2lxeBxCop20qLwOEUbbaSF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiXF4VFSHB4lxeFRUhweJcXhUVIcHiWF/Pr9F7bAHIjtpL7/AAAAAElFTkSuQmCC",name:at("清除"),isChecked:!0}]),c=V.reactive({isShowFull:!1,topDim:"",downDim:""}),h=V.reactive([{toleranceCode:ci.None,tolerance:[],Benchmark:{b1:[[],[]],b2:[[],[]],b3:[[],[]]}}]),f=()=>{h.push({toleranceCode:ci.None,tolerance:[],Benchmark:{b1:[[],[]],b2:[[],[]],b3:[[],[]]}}),w.value+=1},r=()=>{h.splice(w.value-1,1),w.value===1?w.value=1:w.value-=1,B()},v=O=>{let W="item";return h[w.value-1].toleranceCode===O.typeName&&(W+=" checked"),W},_=(O,W)=>{const Z=[];for(let ie=0;ie<O.length;ie+=W)Z.push(O.slice(ie,ie+W));return Z},w=V.ref(1),b=(O,W,Z,ie)=>{const $=O*Z+W;l.forEach(oe=>{oe.isChecked=!1}),l[$].isChecked=!0,h[w.value-1].toleranceCode=l[$].typeName,i.includes(h[w.value-1].toleranceCode)||(c.isShowFull=!1),B()};let E,P;V.onMounted(()=>{fs.value=500;const{wipeout:O,midPt:W}=Yy();E=W.clone(),Bo.value?(P=Bo.value.clone(),c.isShowFull=P.isShowFullWeekSymbol,c.downDim=P.dimNotesDown,c.topDim=P.dimNotesUp,h.length=0,h.push(...P.dimToleranceContents),h.forEach(ie=>{Object.keys(ie.Benchmark).forEach(oe=>{var be,fe;((be=ie.Benchmark[oe])==null?void 0:be.length)===3&&((fe=ie.Benchmark[oe])==null||fe.splice(1,1))})})):P=new Ih,P.setStartPoint(E);const Z=new R.McGeVector3d(10,10,0);P.setTurningPoint(E.clone().addvec(Z)),P.setEndPoint(E.clone().addvec(Z).addvec(R.McGeVector3d.kXAxis.clone().mult(5))),B()});const I=()=>{h[w.value-1]={toleranceCode:ci.None,tolerance:[],Benchmark:{b1:[[],[]],b2:[[],[]],b3:[[],[]]}},c.downDim=c.topDim="",B()},F=V.ref(),B=()=>Pn(this,null,function*(){const O=h.filter(Re=>Re.toleranceCode!==ci.None);P.dimToleranceContents=JSON.parse(JSON.stringify(O)),P.isShowFullWeekSymbol=c.isShowFull,P.dimNotesDown=c.downDim,P.dimNotesUp=c.topDim;const W=R.MxCpp.getCurrentMxCAD(),Z=W.drawEntity(P),{minPt:ie,maxPt:$}=P.getBoundingBox(),oe=$.sub(ie).normalize().mult(2);ie.addvec(oe.clone().negate()),$.addvec(oe);let be=new R.McGeLongArray;be.copyFormAryId([Z]),R.MxCpp.App.MxCADAssist.MxExplode(be.imp);let fe=($.x-ie.x)*10,Le=120/300*fe;const Xe=yield Af({type:"image/bmp",width:fe,height:Le,range_pt1:ie.toVector3(),range_pt2:$.toVector3()});F.value.src=Xe,W.mxdraw.updateCanvasSize();let Ne=new R.MxCADSelectionSet;Ne.crossingSelect(ie.x,ie.y,$.x,$.y),Ne.forEach(Re=>{Re.erase()}),t("receiveParameters",{formData:rf({dimToleranceContents:O},c)})});return(O,W)=>(V.openBlock(),V.createElementBlock("div",null,[V.createElementVNode("div",jE,[V.createElementVNode("div",HE,[V.createElementVNode("img",{alt:"",ref_key:"img",ref:F,style:{width:"100%",height:"100%"}},null,512)])]),V.createElementVNode("div",WE,[V.createElementVNode("div",qE,[V.createElementVNode("span",YE,V.toDisplayString(V.unref(at)("公差代号")),1),(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(_(l,5),(Z,ie)=>(V.openBlock(),V.createElementBlock("div",{class:"row",key:ie},[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(Z,($,oe)=>(V.openBlock(),V.createBlock(V.unref(tn.VTooltip),{key:$.name,text:$.name},{activator:V.withCtx(({props:be})=>[V.createElementVNode("div",{class:V.normalizeClass(v($)),onClick:fe=>b(ie,oe,5)},[V.createElementVNode("img",V.mergeProps({src:$.img,alt:""},be,{style:$.isDisable?"opacity: 0.3;":""}),null,16,KE)],10,XE)]),_:2},1032,["text"]))),128))]))),128))]),V.createElementVNode("div",ZE,[V.createElementVNode("div",JE,[V.createElementVNode("span",QE,V.toDisplayString(V.unref(at)("公差1")),1),V.createVNode(V.unref(tn.VCombobox),{style:{width:"15%"},items:["","S","R","φ","SR","CR","Sφ"],modelValue:h[w.value-1].tolerance[0],"onUpdate:modelValue":W[0]||(W[0]=Z=>h[w.value-1].tolerance[0]=Z),disabled:h[w.value-1].toleranceCode===V.unref(ci).None,onBlur:W[1]||(W[1]=Z=>B())},null,8,["modelValue","disabled"]),V.createVNode(V.unref(tn.VCombobox),{style:{width:"20%","margin-left":"10px"},"return-object":"",modelValue:h[w.value-1].tolerance[1],"onUpdate:modelValue":W[2]||(W[2]=Z=>h[w.value-1].tolerance[1]=Z),disabled:h[w.value-1].toleranceCode===V.unref(ci).None,onBlur:W[3]||(W[3]=Z=>B())},null,8,["modelValue","disabled"]),V.createVNode(V.unref(tn.VSelect),{style:{width:"15%","margin-left":"10px","font-size":"12px"},items:[{text:"",value:""},{text:"(+)",value:"+"},{text:"(-)",value:"-"},{text:"(◁)",value:"<"},{text:"(▷)",value:">"}],"item-title":"text","item-value":"value",modelValue:h[w.value-1].tolerance[2],"onUpdate:modelValue":[W[4]||(W[4]=Z=>h[w.value-1].tolerance[2]=Z),W[5]||(W[5]=Z=>B())],disabled:h[w.value-1].toleranceCode===V.unref(ci).None},null,8,["modelValue","disabled"]),V.createVNode(V.unref(tn.VSelect),{style:{width:"10%","margin-left":"10px"},"item-title":"text","item-value":"value",items:[{text:"",value:""},{text:"Ⓟ",value:"p"},{text:"Ⓜ",value:"m"},{text:"Ⓔ",value:"{"},{text:"Ⓛ",value:"l"},{text:"Ⓕ",value:"@"}],modelValue:h[w.value-1].tolerance[3],"onUpdate:modelValue":[W[6]||(W[6]=Z=>h[w.value-1].tolerance[3]=Z),W[7]||(W[7]=Z=>B())],disabled:h[w.value-1].toleranceCode===V.unref(ci).None},null,8,["modelValue","disabled"]),V.createVNode(V.unref(tn.VBtn),{style:{"margin-left":"10px","font-size":"12px",padding:"0px","min-width":"0px",height:"20px",width:"30px",display:"flex","align-items":"center","justify-content":"center"},class:V.normalizeClass(h[w.value-1].tolerance[4]?"checkBtn":""),disabled:h[w.value-1].toleranceCode===V.unref(ci).None||!["m","l"].includes(h[w.value-1].tolerance[3]),onClick:W[8]||(W[8]=()=>{h[w.value-1].tolerance[4]?h[w.value-1].tolerance[4]="":h[w.value-1].tolerance[4]="}",B()})},{default:V.withCtx(()=>[V.createTextVNode("Ⓡ")]),_:1},8,["class","disabled"])]),V.createElementVNode("div",$E,[V.createElementVNode("span",e3,V.toDisplayString(V.unref(at)("公差2")),1),V.createVNode(V.unref(tn.VCombobox),{style:{width:"10%"},disabled:""}),V.createVNode(V.unref(tn.VCombobox),{style:{width:"15%","margin-left":"10px"},disabled:""}),V.createVNode(V.unref(tn.VSelect),{style:{width:"20%","margin-left":"10px","font-size":"12px"},disabled:""}),V.createVNode(V.unref(tn.VSelect),{style:{width:"10%","margin-left":"10px"},disabled:""}),V.createVNode(V.unref(tn.VBtn),{disabled:"",style:{"margin-left":"10px","font-size":"12px",padding:"0px","min-width":"0px",height:"20px",width:"30px",display:"flex","align-items":"center","justify-content":"center"}},{default:V.withCtx(()=>[V.createTextVNode("Ⓡ")]),_:1})])])]),V.createElementVNode("div",t3,[V.createElementVNode("div",n3,[V.createElementVNode("div",i3,[V.createElementVNode("span",r3,V.toDisplayString(V.unref(at)("附注")),1),V.createElementVNode("div",o3,[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("顶端")),1),V.createElementVNode("div",a3,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:c.topDim,"onUpdate:modelValue":W[9]||(W[9]=Z=>c.topDim=Z),disabled:h[w.value-1].toleranceCode===V.unref(ci).None,onBlur:W[10]||(W[10]=Z=>B())},null,8,["modelValue","disabled"])])]),V.createElementVNode("div",s3,[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("底端")),1),V.createElementVNode("div",l3,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:c.downDim,"onUpdate:modelValue":W[11]||(W[11]=Z=>c.downDim=Z),disabled:h[w.value-1].toleranceCode===V.unref(ci).None,onBlur:W[12]||(W[12]=Z=>B())},null,8,["modelValue","disabled"])])])]),V.createElementVNode("div",c3,[(V.openBlock(!0),V.createElementBlock(V.Fragment,null,V.renderList(Object.keys(h[w.value-1].Benchmark),(Z,ie)=>(V.openBlock(),V.createElementBlock("div",{class:"btnBox",style:{width:"32%",padding:"10px 5px 0px"},key:Z},[V.createElementVNode("span",u3,V.toDisplayString(V.unref(at)("基准"))+V.toDisplayString(ie+1),1),(V.openBlock(),V.createElementBlock(V.Fragment,null,V.renderList(2,$=>V.createElementVNode("div",{class:"fbc",key:$,style:{"margin-bottom":"5px"}},[V.createElementVNode("div",h3,[V.createVNode(V.unref(tn.VTextField),{type:"text",modelValue:h[w.value-1].Benchmark[Z][$-1][0],"onUpdate:modelValue":oe=>h[w.value-1].Benchmark[Z][$-1][0]=oe,disabled:h[w.value-1].toleranceCode===V.unref(ci).None,onBlur:W[13]||(W[13]=oe=>B())},null,8,["modelValue","onUpdate:modelValue","disabled"])]),V.createVNode(V.unref(tn.VSelect),{style:{width:"40%","margin-left":"5px"},"item-title":"text","item-value":"value",items:[{text:"",value:""},{text:"Ⓜ",value:"m"},{text:"Ⓔ",value:"{"},{text:"Ⓛ",value:"l"}],modelValue:h[w.value-1].Benchmark[Z][$-1][1],"onUpdate:modelValue":[oe=>h[w.value-1].Benchmark[Z][$-1][1]=oe,W[14]||(W[14]=oe=>B())],disabled:h[w.value-1].toleranceCode===V.unref(ci).None},null,8,["modelValue","onUpdate:modelValue","disabled"])])),64))]))),128))])]),V.createElementVNode("div",d3,[V.createVNode(V.unref(tn.VCheckbox),{label:`${V.unref(at)("全周符号")}`,modelValue:c.isShowFull,"onUpdate:modelValue":W[15]||(W[15]=Z=>c.isShowFull=Z),disabled:!(h.length==1&&i.includes(h[w.value-1].toleranceCode)),onChange:W[16]||(W[16]=Z=>B())},null,8,["label","modelValue","disabled"]),V.createElementVNode("div",p3,[V.createElementVNode("span",f3,V.toDisplayString(V.unref(at)("当前行")),1),V.createElementVNode("div",m3,[V.createElementVNode("div",g3,[V.createElementVNode("div",y3,[V.createElementVNode("span",null,V.toDisplayString(w.value),1),V.createElementVNode("div",x3,[V.createVNode(V.unref(tn.VBtn),{style:{padding:"0px","min-width":"0px",height:"20px",width:"20px","margin-right":"5px"},disabled:h.length===1,onClick:W[17]||(W[17]=()=>w.value>1?w.value-=1:w.value=1)},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString("<"))]),_:1},8,["disabled"]),V.createVNode(V.unref(tn.VBtn),{style:{padding:"0px","min-width":"0px",height:"20px",width:"20px"},disabled:h.length===1,onClick:W[18]||(W[18]=()=>w.value<h.length?w.value+=1:w.value=h.length)},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(">"))]),_:1},8,["disabled"])])]),V.createVNode(V.unref(tn.VBtn),{style:{"margin-bottom":"10px"},disabled:h.length===3,onClick:f},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(V.unref(at)("增加行")),1)]),_:1},8,["disabled"]),V.createVNode(V.unref(tn.VBtn),{disabled:h.length===1,onClick:r},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(V.unref(at)("删除行")),1)]),_:1},8,["disabled"])])])]),V.createElementVNode("div",v3,[V.createVNode(V.unref(tn.VBtn),{onClick:I},{default:V.withCtx(()=>[V.createTextVNode(V.toDisplayString(V.unref(at)("清零")),1)]),_:1})])])])]))}}),_z="",b3=ms(_3,[["__scopeId","data-v-7ac3c527"],["__file","GemoetricToleranceDialog.vue"]]),w3={class:"contents"},A3={style:{"margin-bottom":"10px"}},M3={class:"tips"},S3={class:"tips"},T3={style:{display:"flex","justify-content":"space-around",width:"100%"}},E3=V.defineComponent({__name:"NumberTextDialog",emits:["receiveParameters"],setup(e,{emit:t}){const i=V.ref(""),l=V.ref(1),c=V.ref("start"),h=()=>{const f={textContent:i.value,textNumber:Number(l.value),numPos:c.value};t("receiveParameters",f)};return V.onMounted(()=>{fs.value=350}),(f,r)=>(V.openBlock(),V.createElementBlock("div",w3,[V.createElementVNode("p",A3,V.toDisplayString(V.unref(at)("请输入文本内容和编号：")),1),V.createVNode(V.unref(tn.VRow),null,{default:V.withCtx(()=>[V.createVNode(V.unref(tn.VCol),{cols:"3"},{default:V.withCtx(()=>[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("文本内容：")),1)]),_:1}),V.createVNode(V.unref(tn.VCol),{cols:"5"},{default:V.withCtx(()=>[V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"text",modelValue:i.value,"onUpdate:modelValue":[r[0]||(r[0]=v=>i.value=v),h]},null,8,["modelValue"])]),_:1}),V.createVNode(V.unref(tn.VCol),{cols:"4"},{default:V.withCtx(()=>[V.createElementVNode("span",M3,V.toDisplayString(V.unref(at)("(输入0-20个字)")),1)]),_:1})]),_:1}),V.createVNode(V.unref(tn.VRow),null,{default:V.withCtx(()=>[V.createVNode(V.unref(tn.VCol),{cols:"3"},{default:V.withCtx(()=>[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("起始编号：")),1)]),_:1}),V.createVNode(V.unref(tn.VCol),{cols:"4"},{default:V.withCtx(()=>[V.createVNode(V.unref(tn.VTextField),{class:"mt-1",type:"number",modelValue:l.value,"onUpdate:modelValue":[r[1]||(r[1]=v=>l.value=v),h]},null,8,["modelValue"])]),_:1}),V.createVNode(V.unref(tn.VCol),{cols:"5"},{default:V.withCtx(()=>[V.createElementVNode("span",S3,V.toDisplayString(V.unref(at)("(编号自动递增1)")),1)]),_:1})]),_:1}),V.createVNode(V.unref(tn.VRow),{justify:"flex-start"},{default:V.withCtx(()=>[V.createVNode(V.unref(tn.VCol),{cols:"3"},{default:V.withCtx(()=>[V.createElementVNode("span",null,V.toDisplayString(V.unref(at)("编号位置：")),1)]),_:1}),V.createVNode(V.unref(tn.VCol),{cols:"6"},{default:V.withCtx(()=>[V.createVNode(V.unref(tn.VRadioGroup),{modelValue:c.value,"onUpdate:modelValue":[r[2]||(r[2]=v=>c.value=v),h]},{default:V.withCtx(()=>[V.createElementVNode("div",T3,[V.createVNode(V.unref(tn.VRadio),{label:V.unref(at)("编号在前"),value:"start"},null,8,["label"]),V.createVNode(V.unref(tn.VRadio),{label:V.unref(at)("编号在后"),value:"end"},null,8,["label"])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}}),bz="",P3=ms(E3,[["__scopeId","data-v-7d640c71"],["__file","NumberTextDialog.vue"]]),C3=ms(V.defineComponent({__name:"dialog",setup(e){const{MxDialog:t}=MxPluginContext.components,i=[{name:at("取消"),fun:()=>{const _=R.MxCpp.getCurrentMxCAD();To.cancel(r),l.value=!1,_.mxdraw.clearMxCurrentSelect(),_.updateDisplay()}},{name:at("确定"),primary:!0,fun:()=>{To.confirm(r),l.value=!1}}],{isShow:l,onReveal:c}=To,h=V.ref("弹框标题");c(_=>{_.title&&(h.value=_.title)});const f={RotateDialog:uT,RoundMarkDialog:mT,RoughnessDialog:BT,WeldSymbolDialog:HT,WeldingSymbolDialog:GE,GemoetricToleranceDialog:b3,NumberTextDialog:P3};let r;const v=_=>{r=_};return(_,w)=>(V.openBlock(),V.createBlock(V.unref(t),{title:h.value,modelValue:V.unref(l),"onUpdate:modelValue":w[0]||(w[0]=b=>V.isRef(l)?l.value=b:null),"max-width":V.unref(fs),footerBtnList:i},{default:V.withCtx(()=>[(V.openBlock(),V.createBlock(V.resolveDynamicComponent(f[V.unref(ra)]),{onReceiveParameters:v},null,32))]),_:1},8,["title","modelValue","max-width"]))}}),[["__file","dialog.vue"]]);function R3(){const e=document.createElement("div");document.body.appendChild(e);const t=V.createVNode(C3),i=MxPluginContext.getApp();t.appContext=i._context,V.render(t,e)}const g1=(e,t)=>{var h;const i=new Fa;i.setPos(new R.McGePoint3d(0,0,0)),i.rouDimHeight=(t!=null&&t.fontSize?t.fontSize:1)*e.textBaseHeight;const l=t.props;i.rougMarkType=l.selectSymbolNum,i.textLeftStr=l.textLeftStr,i.rougCornerType=l.rougCornerType==="无"?"":l.rougCornerType,i.isRoungSameRequire=l.isRoungSameRequire,i.isShowMostSymbols=l.isShowMostSymbols;const c=(h=l==null?void 0:l.textUpStr)==null?void 0:h.filter(f=>f!="");return i.textUpStr=JSON.parse(JSON.stringify(c)).reverse(),i.textDownStr=l.textDownStr.filter(f=>f!=""),i.isAddRougLongLine=l.isAddLongLine,i};class D3 extends R.MxCADBaseCustomText{constructor(){super(),this.type="MxCADTestRoughnessText"}calculate(t,i){const c=g1(t,i).getBoundingBox(),h=c.maxPt.x-c.minPt.x,f=c.maxPt.y-c.minPt.y;return{width:h,height:f}}create(t,i,l,c){const h=g1(t,i),f=h.getPos(),{minPt:r,maxPt:v}=h.getBoundingBox(),_=new R.McGePoint3d(r.x,v.y),w=f.sub(_),b=c.position.clone().addvec(w);return h.setPos(b),t.getMTextImp().entityType=="mtext"&&!t.getMTextImp().isEditState?[h]:[...h.getAllEntity()]}}function I3(){const e=MxPluginContext.registerEditorCustomTextPlugin(new D3,{onDbClick:i=>{t(!0,i)},uiData:{icon:"icon-a-1",tip:"粗糙度",onClick:()=>{t(!1)}}}),t=(i=!1,l)=>{var c,h;if(ra.value="RoughnessDialog",i){const f=new Fa,r=l.props;f.rougMarkType=r.selectSymbolNum,f.textLeftStr=r.textLeftStr,f.rougCornerType=r.rougCornerType==="无"?"":r.rougCornerType,f.isRoungSameRequire=r.isRoungSameRequire,f.isShowMostSymbols=r.isShowMostSymbols,Bo.value=f;const v=(c=r==null?void 0:r.textUpStr)==null?void 0:c.filter(_=>_!="");f.textUpStr=(h=JSON.parse(JSON.stringify(v)))==null?void 0:h.reverse(),f.textDownStr=r.textDownStr.filter(_=>_!=""),f.isAddRougLongLine=r.isAddLongLine}To.showDialog(!0,{title:iT("表面粗糙度")}).then(v=>Pn(this,[v],function*({data:f,isCanceled:r}){r||e(f.roughnessData,i)}))}}function L3(){I3()}class ff extends R.McDbCustomEntity{constructor(t){super(t),this._text="",this._textsize=20,this._radius=15}create(t){return new ff(t)}getTypeName(){return"McDbRectBoxLeadComment"}set text(t){this._text=t}get text(){return this._text}set textsize(t){this._textsize=t}get textsize(){return this._textsize}set radius(t){this._radius=t}get radius(){return this._radius}dwgInFields(t){return this.pt1=t.readPoint("pt1").val,this.pt2=t.readPoint("pt2").val,this.pt3=t.readPoint("pt3").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,this._text=t.readString("text").val,this._textsize=t.readDouble("textsize").val,!0}dwgOutFields(t){return t.writePoint("pt1",this.pt1),t.writePoint("pt2",this.pt2),t.writePoint("pt3",this.pt3),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),t.writeString("text",this._text),t.writeDouble("textsize",this._textsize),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),t===0?(this.pt1.x+=i,this.pt1.y+=l,this.pt1.z+=c):t===1?(this.pt2.x+=i,this.pt2.y+=l,this.pt2.z+=c):t===2&&(this.pt3.x+=i,this.pt3.y+=l,this.pt3.z+=c)}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.pt1),t.append(this.pt2),t.append(this.pt3),t}worldDraw(t){const i=[],l=this._radius;if(this.pt1.x<this.pt2.x){const E=this.pt2.x-this.pt1.x,P=parseInt((E/(l*2)).toString());this.pt2.x=this.pt1.x+l*2*P}else{const E=this.pt1.x-this.pt2.x,P=parseInt((E/(l*2)).toString());this.pt1.x=this.pt2.x+l*2*P}if(this.pt1.y<this.pt2.y){const E=this.pt2.y-this.pt1.y,P=parseInt((E/(l*2)).toString());this.pt2.y=this.pt1.y+l*2*P}else{const E=this.pt1.y-this.pt2.y,P=parseInt((E/(l*2)).toString());this.pt1.y=this.pt2.y+l*2*P}const c=new R.McDbPolyline;c.isClosed=!0,c.addVertexAt(this.pt1),c.addVertexAt(new R.McGePoint3d(this.pt2.x,this.pt1.y)),c.addVertexAt(this.pt2),c.addVertexAt(new R.McGePoint3d(this.pt1.x,this.pt2.y));let f=c.getLength().val/l;const r=[];for(let E=1;E<=f;E++){const P=c.getPointAtDist(l*E).val;r.push(P)}r.forEach((E,P)=>{const I=new R.McDbCircle(E.x,E.y,E.z,l);if(P%2===0){const F=[];I.IntersectWith(c,R.McDb.Intersect.kOnBothOperands).forEach(B=>{F.push(B)}),I.splitCurves(F).forEach(B=>{const O=B.getPointAtDist(B.getLength().val/2).val;(O.x<Math.min(this.pt1.x,this.pt2.x)||O.x>Math.max(this.pt1.x,this.pt2.x))&&(t.drawEntity(B),i.push(B)),(O.y<Math.min(this.pt1.y,this.pt2.y)||O.y>Math.max(this.pt1.y,this.pt2.y))&&(t.drawEntity(B),i.push(B))})}});const v=[];for(let E=0;E<c.numVerts();E++){const P=c.getPointAt(E).val.distanceTo(this.pt3);v.push(P)}const _=v.indexOf(Math.min(...v)),w=c.getPointAt(_).val,b=new R.McDbPolyline;if(b.addVertexAt(w),b.addVertexAt(this.pt3),this._text){const E=new R.McDbText;E.textString=this._text,E.position=E.alignmentPoint=this.pt3,E.height=20,t.drawEntity(E),i.push(E);const{minPt:P,maxPt:I,ret:F}=E.getBoundingBox();if(!F)return;const B=I.x-P.x;b.addVertexAt(new R.McGePoint3d(this.pt3.x+B,this.pt3.y)),t.drawEntity(b),i.push(b)}else t.drawEntity(b),i.push(b);this.getBox(i)}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setPoint1(t){this.assertWrite(),this.pt1=t.clone()}setPoint2(t){this.assertWrite(),this.pt2=t.clone()}setPoint3(t){this.assertWrite(),this.pt3=t.clone()}getPoint1(){return this.pt1}getPoint2(){return this.pt2}getPoint3(){return this.pt3}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function F3(){return Pn(this,null,function*(){const e=new ff,t=new R.MxCADUiPrString;t.setMessage(at("请输入审批意见"));let i=yield t.go();i||(i="审批意见XXXX"),e.text=i;const l=new R.MxCADUiPrPoint;l.setMessage(at("指定云线框起始点"));const c=yield l.go();if(!c)return;const h=new R.MxCADUiPrPoint;h.setMessage(at("指定云线框终止点")),h.setUserDraw((_,w)=>{e.setPoint1(c),e.setPoint2(_),e.setPoint3(_),w.drawMcDbEntity(e)});const f=yield h.go();if(!f)return;e.setPoint2(f);const r=new R.MxCADUiPrPoint;r.setMessage(at("指定审图标注点")),r.setUserDraw((_,w)=>{e.setPoint3(_),w.drawMcDbEntity(e)});const v=yield r.go();v&&(e.setPoint3(v),R.MxCpp.getCurrentMxCAD().drawEntity(e))})}class mf extends R.McDbCustomEntity{constructor(t){super(t),this.pt1=new R.McGePoint3d,this.pt2=new R.McGePoint3d}create(t){return new mf(t)}getTypeName(){return"McDbTestRectangle"}dwgInFields(t){return this.pt1=t.readPoint("pt1").val,this.pt2=t.readPoint("pt2").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("pt1",this.pt1),t.writePoint("pt2",this.pt2),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),t==0?(this.pt1.x+=i,this.pt1.y+=l,this.pt1.z+=c):t==1&&(this.pt2.x+=i,this.pt2.y+=l,this.pt2.z+=c)}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.pt1),t.append(this.pt2),t}worldDraw(t){const i=[],l=new R.McDbPolyline;l.isClosed=!0,l.addVertexAt(this.pt1),l.addVertexAt(new R.McGePoint3d(this.pt2.x,this.pt1.y)),l.addVertexAt(this.pt2),l.addVertexAt(new R.McGePoint3d(this.pt1.x,this.pt2.y)),t.drawEntity(l),i.push(l);let c=R.MxCpp.getCurrentMxCAD();const h=new R.McGePoint3d(this.pt2.x,this.pt1.y);c.addDimStyle("MyDimStyle","41,0.18,141,0.09,40,200","77,1,271,3","",""),c.drawDimStyle="MyDimStyle";const f=c.drawDimAligned(this.pt1.x,this.pt1.y+20,h.x,h.y+20,(this.pt1.x+h.x)/2,this.pt1.y+20);t.drawEntity(f.getMcDbEntity()),i.push(f.getMcDbEntity()),f.erase();const r=c.drawDimAligned(this.pt2.x+20,this.pt2.y,h.x+20,h.y,h.x+20,(this.pt2.y+h.y)/2);t.drawEntity(r.getMcDbEntity()),i.push(r.getMcDbEntity()),r.erase(),this.getBox(i)}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setPoint1(t){this.assertWrite(),this.pt1=t.clone()}setPoint2(t){this.assertWrite(),this.pt2=t.clone()}getPoint1(){return this.pt1}getPoint2(){return this.pt2}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function k3(){return Pn(this,null,function*(){let e=R.MxCpp.getCurrentMxCAD();const t=new R.MxCADUiPrPoint;t.setMessage(at("指定第一个角点:"));let i=yield t.go();if(!i)return;const l=new mf;l.setPoint1(i),t.setMessage(at("指定第二个角点:")),t.setUserDraw((h,f)=>{l.setPoint2(h),f.drawMcDbEntity(l)});let c=yield t.go();c&&(l.setPoint2(c),e.drawEntity(l))})}function B3(){return Pn(this,null,function*(){const e=new R.MxCADUiPrKeyWord;e.setMessage("选择要对齐水平标注或竖直标注："),e.setKeyWords("[水平(H)/竖直(V)]");const t=yield e.go();if(!t)return;const i=new R.MxCADSelectionSet;if(!(yield i.userSelect("选择对齐标注:"))||i.count()==0)return;const l=[];if(i.forEach(_=>{const w=_.getMcDbEntity();if(w.objectName==="McDbRotatedDimension"){const b=w.clone(),E=Math.abs(b.xLine1Point.x-b.xLine2Point.x).toFixed(0),P=Math.abs(b.xLine1Point.y-b.xLine2Point.y).toFixed(0),I=Math.abs(b.dimLinePoint.x-b.xLine1Point.x)+Math.abs(b.dimLinePoint.x-b.xLine2Point.x),F=Math.abs(b.dimLinePoint.y-b.xLine1Point.y)+Math.abs(b.dimLinePoint.y-b.xLine2Point.y);t==="H"&&I.toFixed(0)==E&&l.push(w),t==="V"&&F.toFixed(0)==P&&l.push(w)}}),l.length===0)return;const c=R.MxCpp.getCurrentMxCAD(),h=new R.MxCADUiPrPoint;h.setMessage("设置尺寸线位置");const f=yield h.go();if(!f)return;l.forEach(_=>{_.dimLinePoint=f}),c.updateDisplay();const r=new R.MxCADUiPrPoint;r.setMessage("设置尺寸线界限");const v=yield r.go();v&&(l.forEach(_=>{t==="H"?(_.xLine1Point=new R.McGePoint3d(_.xLine1Point.x,v.y),_.xLine2Point=new R.McGePoint3d(_.xLine2Point.x,v.y)):t==="V"&&(_.xLine1Point=new R.McGePoint3d(v.x,_.xLine1Point.y),_.xLine2Point=new R.McGePoint3d(v.x,_.xLine2Point.y))}),c.updateDisplay())})}class gf extends R.McDbCustomEntity{constructor(t){super(t),this.numPos=new R.McGePoint3d,this.labelPos=new R.McGePoint3d,this.labelSize=Ke.MxFun.screenCoordLong2Doc(5),this.numSize=Ke.MxFun.screenCoordLong2Doc(10),this.index="1",this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new gf(t)}getTypeName(){return"McDbTestIndex"}set symbolIndex(t){this.index=t}get symbolIndex(){return this.index}dwgInFields(t){return this.numPos=t.readPoint("numPos").val,this.labelPos=t.readPoint("labelPos").val,this.index=t.readString("index").val,this.labelSize=t.readDouble("labelSize").val,this.numSize=t.readDouble("numSize").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("labelPos",this.labelPos),t.writePoint("numPos",this.numPos),t.writeString("index",this.index),t.writeDouble("labelSize",this.labelSize),t.writeDouble("numSize",this.numSize),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),t===0?(this.labelPos.x+=i,this.labelPos.y+=l,this.labelPos.z+=c):(this.numPos.x+=i,this.numPos.y+=l,this.numPos.z+=c,this.labelPos.x+=i,this.labelPos.y+=l,this.labelPos.z+=c)}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.labelPos),t.append(this.numPos),t}worldDraw(t){const i=[],l=new R.McDbHatch;l.appendCircleLoop(this.labelPos.x,this.labelPos.y,this.labelSize),t.drawEntity(l),i.push(l);const c=new R.McDbText;c.textString=this.index,c.height=this.numSize*(4/5),c.position=this.numPos.clone().subvec(R.McGeVector3d.kYAxis.clone().mult(this.numSize*(2/5))),c.alignmentPoint=c.position,c.horizontalMode=R.McDb.TextHorzMode.kTextMid,t.drawEntity(c),i.push(c);const h=new R.McDbCircle(this.numPos.x,this.numPos.y,this.numPos.z,this.numSize);t.drawEntity(h),i.push(h);const f=this.labelPos.sub(this.numPos).normalize().mult(this.numSize),r=this.numPos.addvec(f),v=new R.McDbLine(this.labelPos,r);t.drawEntity(v),i.push(v),this.getBox(i)}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setLabelPos(t){this.labelPos=t.clone()}getLabelPos(){return this.labelPos}setNumPos(t){this.numPos=t.clone()}getNumPos(){return this.numPos}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function z3(){return Pn(this,null,function*(){let e=1;for(;;){const t=new R.MxCADUiPrPoint;t.setMessage(at("指定标注点:"));let i=yield t.go();if(!i)break;const l=new gf;l.setLabelPos(i);const c=new R.MxCADUiPrPoint;c.setMessage(at("指定序号位置:")),c.setUserDraw((r,v)=>{const _=l.clone();_.setNumPos(r),v.drawMcDbEntity(_)});let h=yield c.go();if(!h)break;l.setNumPos(h),l.symbolIndex=e.toString(),R.MxCpp.getCurrentMxCAD().drawEntity(l),e+=1}})}var Lh=(e=>(e[e.right=0]="right",e[e.left=1]="left",e))(Lh||{});class yf extends R.McDbCustomEntity{constructor(t){super(t),this.position=new R.McGePoint3d,this.rightText="",this.leftText="",this.bottomText="",this._textHeight=7,this.direct=0,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new yf(t)}getTypeName(){return"McDbTestRotationLabel"}set rightTextStr(t){this.rightText=t}get rightTextStr(){return this.rightText}set leftTextStr(t){this.leftText=t}get leftTextStr(){return this.leftText}set bottomTextStr(t){this.bottomText=t}get bottomTextStr(){return this.bottomText}set textHeight(t){this._textHeight=t}get textHeight(){return this._textHeight}set RotateDirect(t){this.direct=t}get RotateDirect(){return this.direct}dwgInFields(t){return this.position=t.readPoint("position").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,this.rightText=t.readString("rightText").val,this.leftText=t.readString("leftText").val,this.bottomText=t.readString("bottomText").val,this._textHeight=t.readDouble("textHeight").val,this.direct=t.readDouble("direct").val,!0}dwgOutFields(t){return t.writePoint("position",this.position),t.writePoint("maxPt",this.maxPt),t.writePoint("minPt",this.minPt),t.writeString("rightText",this.rightText),t.writeString("leftText",this.leftText),t.writeString("bottomText",this.bottomText),t.writeDouble("textHeight",this._textHeight),t.writeDouble("direct",this.direct),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),this.position.x+=i,this.position.y+=l,this.position.z+=c}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.position),t}getAllEntity(){const t=[],l=this.position.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(7)),c=this.position.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(7)),h=this.position.clone().addvec(R.McGeVector3d.kXAxis.clone().negate().mult(7)),f=this.direct===0?h.clone():l.clone(),r=l.clone().sub(this.position),v=this.direct===0?r.rotateBy(Math.PI/180*140):r.rotateBy(Math.PI/180*40),_=this.position.clone().addvec(v),w=f.sub(_).normalize().perpVector(),b=_.clone().addvec(w.clone().mult(.9)),E=_.clone().addvec(w.clone().negate().mult(.9)),P=new R.McDbHatch;P.appendLoop(new R.McGePoint3dArray([b,E,f])),t.push(P);const I=new R.McDbArc;return this.direct===0?I.computeArc(l.x,l.y,c.x,c.y,_.x,_.y):I.computeArc(_.x,_.y,c.x,c.y,h.x,h.y),t.push(I),t.push(...this.drawText()),t}worldDraw(t){this.getAllEntity().forEach(l=>{t.drawEntity(l)})}drawText(){const l=new R.McDbText;l.height=this._textHeight;const c=[];if(this.rightText){const h=l.clone();h.textString=this.rightText,h.horizontalMode=R.McDb.TextHorzMode.kTextLeft,h.position=h.alignmentPoint=this.position.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(10)),c.push(h)}if(this.leftText){const h=l.clone();h.textString=this.leftText,h.horizontalMode=R.McDb.TextHorzMode.kTextRight,h.position=h.alignmentPoint=this.position.clone().addvec(R.McGeVector3d.kXAxis.clone().negate().mult(10)),c.push(h)}if(this.bottomText){const h=l.clone();h.textString=this.bottomText,h.horizontalMode=R.McDb.TextHorzMode.kTextCenter,h.position=h.alignmentPoint=this.position.clone().addvec(R.McGeVector3d.kYAxis.clone().negate().mult(10));const f=this.position.clone().addvec(R.McGeVector3d.kXAxis.clone().negate().mult(7*2)),r=this.position.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(7*2)),v=new R.McDbLine(f,r);v.move(this.position,this.position.clone().addvec(R.McGeVector3d.kYAxis.clone().negate().mult(2))),c.push(v),c.push(h)}return c}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setRotatePos(t){this.position=t.clone()}getRotatePos(){return this.position}getBoundingBox(){const t=this.getAllEntity();return this.getBox(t),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function U3(){return Pn(this,null,function*(){ra.value="RotateDialog",To.showDialog(!0,{title:at("旋转符号")}).then(i=>Pn(this,[i],function*({data:e,isCanceled:t}){const l=R.MxCpp.getCurrentMxCAD();if(t)e&&e.dimHandle&&l.database.handleToIdIndex(e.dimHandle).erase();else{const c=l.database.handleToIdIndex(e.dimHandle),f=c.getMcDbEntity().clone();c.erase();const r=new R.MxCADUiPrPoint;r.setMessage("请指定旋转标注位置"),r.setUserDraw((_,w)=>{const b=f.clone();b.setRotatePos(_),w.drawMcDbEntity(b)});const v=yield r.go();if(!v)return;f.visible=!0,f.setRotatePos(v),l.drawEntity(f)}}))})}class xf extends R.McDbCustomEntity{constructor(t){super(t),this.center=new R.McGePoint3d,this.radius=0,this.circlePoints=[],this.midPoints=[],this.circleMidPts=[],this.originPt=new R.McGePoint3d,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new xf(t)}getTypeName(){return"McDbTestRoundHoleMark"}dwgInFields(t){return this.center=t.readPoint("center").val,this.originPt=t.readPoint("originPt").val,this.circlePoints=t.readPoints("circlePoints").val,this.circleMidPts=t.readPoints("circleMidPts").val,this.midPoints=t.readPoints("midPoints").val,this.radius=t.readDouble("radius").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("center",this.center),t.writePoint("originPt",this.originPt),t.writePoints("circlePoints",this.circlePoints),t.writePoints("circleMidPts",this.circleMidPts),t.writePoints("midPoints",this.midPoints),t.writeDouble("radius",this.radius),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite();const h=()=>{this.originPt.x+=i,this.originPt.y+=l,this.originPt.z+=c,this.center.x+=i,this.center.y+=l,this.center.z+=c,[...this.circleMidPts,...this.circlePoints,...this.midPoints].forEach(_=>{_.x+=i,_.y+=l,_.z+=c})},f=()=>{this.circlePoints.forEach((v,_)=>{const w=this.center.clone().addvec(v.sub(this.center).mult(.5));this.midPoints[_]=w})},r=()=>{let v=0;for(let _=0;_<this.circlePoints.length;_+=2){const w=new R.McDbArc;w.computeArc(this.circlePoints[_].x,this.circlePoints[_].y,this.circleMidPts[v].x,this.circleMidPts[v].y,this.circlePoints[_+1].x,this.circlePoints[_+1].y);const b=w.getPointAtDist(w.getLength().val/2).val;this.circleMidPts[v]=b.clone(),v+=1}};if(t===0)h();else if(t===1)this.center.clone().distanceTo(this.originPt)<1e-4?h():(this.center.x+=i,this.center.y+=l,this.center.z+=c,f());else if(t<this.circlePoints.length+2){const v=t-2,_=this.circlePoints[v].clone();_.x+=i,_.y+=l,_.z+=c,this.circlePoints[v]=_,r();const w=this.center.clone().addvec(_.sub(this.center).mult(.5));this.midPoints[v]=w}else if(t<this.circlePoints.length+2+this.circleMidPts.length){const v=t-2-this.circlePoints.length,_=this.circleMidPts[v].clone();_.x+=i,_.y+=l,_.z+=c,this.circleMidPts[v]=_,r()}else{const v=t-2-this.circlePoints.length-this.circleMidPts.length;this.center.x+=i,this.center.y+=l,this.center.z+=c,this.midPoints[v].x+=i,this.midPoints[v].y+=l,this.midPoints[v].z+=c,this.circlePoints[v].x+=i,this.circlePoints[v].y+=l,this.circlePoints[v].z+=c,r(),f()}}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.originPt),t.append(this.center),this.circlePoints.forEach(i=>{t.append(i)}),this.circleMidPts.forEach(i=>{t.append(i)}),this.midPoints.forEach(i=>{t.append(i)}),t}worldDraw(t){const i=[];for(let l=0;l<this.circlePoints.length;l+=2){const c=(l+2)/2,h=R.MxCADUtility.calcBulge(this.circlePoints[l],this.circleMidPts[c-1],this.circlePoints[l+1]).val,f=new R.McDbHatch;f.appendLoop(new R.McGePoint3dArray([this.center,this.circlePoints[l],this.circlePoints[l+1]]),[0,h,0]),t.drawEntity(f),i.push(f)}this.getBox(i)}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setRoundData(t,i,l=1,c=1,h=Math.PI/2){this.center=this.originPt=t.clone(),this.radius=i;let f;switch(l){case 1:f=R.McGeVector3d.kXAxis.clone();break;case 2:f=R.McGeVector3d.kYAxis.clone();break;case 3:f=R.McGeVector3d.kXAxis.clone().negate();break;case 4:f=R.McGeVector3d.kYAxis.clone().negate();break;default:f=R.McGeVector3d.kXAxis.clone();break}h>0&&Math.PI/2-h>1e-4&&f.rotateBy(h/2,R.McGeVector3d.kZAxis);const r=this.center.clone().addvec(f.clone().mult(this.radius)),v=this.center.clone().addvec(f.clone().rotateBy(h/2).mult(this.radius)),_=this.center.clone().addvec(f.clone().rotateBy(h).mult(this.radius));this.circlePoints=[r,_],this.circleMidPts=[v];const w=this.center.clone().addvec(r.sub(this.center).mult(.5)),b=this.center.clone().addvec(_.sub(this.center).mult(.5));this.midPoints=[w,b];const E=P=>{const I=[],F=new R.McGeMatrix3d;return F.setToRotation(Math.PI,R.McGeVector3d.kZAxis,this.center),P.forEach(B=>{I.push(B.clone().transformBy(F))}),I};c>1&&(this.circlePoints.push(...E(this.circlePoints)),this.circleMidPts.push(...E(this.circleMidPts)),this.midPoints.push(...E(this.midPoints)))}getRoundData(){return{center:this.center,radius:this.radius}}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function N3(){return Pn(this,null,function*(){ra.value="RoundMarkDialog",To.showDialog(!0,{title:at("标记类型")}).then(i=>Pn(this,[i],function*({data:e,isCanceled:t}){const l=R.MxCpp.getCurrentMxCAD();if(!t){const c=new R.MxCADResbuf([R.DxfCode.kEntityType,"CIRCLE"]),h=new R.MxCADSelectionSet;if(!(yield h.userSelect(at("请选择需要标记的圆:"),c))||h.count()==0)return;h.forEach(f=>{const r=f.getMcDbEntity(),v=new xf;v.setRoundData(r.center,r.radius,...e.param),v.trueColor=new R.McCmColor(0,255,0),l.drawEntity(v)})}}))})}class Fa extends R.McDbCustomEntity{constructor(t){super(t),this.position=new R.McGePoint3d,this.textDownString=["1.6"],this.textUpString=[],this.textLeftString="",this.CornerType="",this.markType=0,this.isSameRequire=!1,this.isAddLongLine=!1,this.isMostSymbols=!1,this.dimSize=5,this.rotation=0,this.dimHeight=10,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new Fa(t)}getTypeName(){return"McDbTestRoughness"}set textDownStr(t){this.textDownString=t}get textDownStr(){return this.textDownString}set textUpStr(t){this.textUpString=t}get textUpStr(){return this.textUpString}set textLeftStr(t){this.textLeftString=t}get textLeftStr(){return this.textLeftString}set rougCornerType(t){this.CornerType=t}get rougCornerType(){return this.CornerType}set rougMarkType(t){this.markType=t}get rougMarkType(){return this.markType}set isRoungSameRequire(t){this.isSameRequire=t,t&&(this.isAddLongLine=!0)}get isRoungSameRequire(){return this.isSameRequire}set isAddRougLongLine(t){this.isAddLongLine=t}get isAddRougLongLine(){return this.isAddLongLine}set isShowMostSymbols(t){this.isMostSymbols=t}get isShowMostSymbols(){return this.isMostSymbols}set rouDimHeight(t){this.dimHeight=t}get rouDimHeight(){return this.dimHeight}dwgInFields(t){this.position=t.readPoint("position").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val;const i=t.readString("textDownStr").val;this.textDownString=i.split(",").filter(c=>c!="");const l=t.readString("textUpStr").val;return this.textUpString=l.split(",").filter(c=>c!=""),this.textLeftString=t.readString("textLeftStr").val,this.CornerType=t.readString("CornerType").val,this.markType=t.readLong("markType").val,this.dimSize=t.readDouble("dimSize").val,this.rotation=t.readDouble("rotation").val,this.dimHeight=t.readDouble("dimHeight").val,this.isSameRequire=t.readLong("isSameRequire").val==1,this.isAddLongLine=t.readLong("isAddLongLine").val==1,this.isMostSymbols=t.readLong("isMostSymbols").val==1,!0}dwgOutFields(t){t.writePoint("position",this.position),t.writePoint("maxPt",this.maxPt),t.writePoint("minPt",this.minPt);const i=this.textDownString.join(","),l=this.textUpString.join(",");return t.writeString("textDownStr",i),t.writeString("textUpStr",l),t.writeString("textLeftStr",this.textLeftString),t.writeString("CornerType",this.CornerType),t.writeLong("markType",this.markType),t.writeDouble("dimSize",this.dimSize),t.writeDouble("rotation",this.rotation),t.writeDouble("dimHeight",this.dimHeight),t.writeLong("isSameRequire",this.isSameRequire?1:0),t.writeLong("isAddLongLine",this.isAddLongLine?1:0),t.writeLong("isMostSymbols",this.isMostSymbols?1:0),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),this.position.x+=i,this.position.y+=l,this.position.z+=c}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.position),t}worldDraw(t){const i=this.getAllEntity();this.getBox(i),i.forEach(l=>{const c=l.clone();this.rotation&&c.rotate(this.position,this.rotation),t.drawEntity(c)})}getAllEntity(){R.MxCpp.getCurrentMxCAD();const t=this.drawShape(this.markType,this.position,this.dimSize,!0),i=t[0],l=i.getPointAt(i.numVerts()-1).val;if(this.textLeftString){const I=new R.McDbText;I.textString=this.textLeftString,I.height=this.dimSize*(9/10),I.alignmentPoint=I.position=this.position.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.dimSize*(1/10))).addvec(R.McGeVector3d.kXAxis.clone().negate().mult(this.dimSize)),I.horizontalMode=R.McDb.TextHorzMode.kTextRight,t.push(I)}if(this.CornerType){const I=new R.McDbText;I.textString=this.CornerType,I.height=this.dimSize*(7/10),I.alignmentPoint=I.position=this.position.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.dimSize*(3/10))).addvec(R.McGeVector3d.kXAxis.clone().mult(this.dimSize*(9/10))),I.horizontalMode=R.McDb.TextHorzMode.kTextLeft,t.push(I)}if(this.isSameRequire){const I=new R.McDbCircle;I.center=l.clone(),I.radius=this.dimSize*(3/10),t.push(I)}let c=l.x;const h=7/10*this.dimSize,f=l.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.dimSize*(1/2))).addvec(R.McGeVector3d.kYAxis.clone().mult(this.dimSize*(1/5)));let r=f.x,v=[];if(this.textUpString.length===1){const I=new R.McDbText;I.textString=this.textUpString[0],I.height=h,I.alignmentPoint=I.position=f,t.push(I);const{maxPt:F}=this.getTextBox(I);F.x>c&&(c=F.x),r=I.position.x}else if(this.textUpString.length===2){const I=new R.McDbText;I.textString=this.textUpString[0],I.height=h;const F=f.clone(),B=new R.McDbText;B.height=h,B.textString=this.textUpString[1];const O=l.sub(this.position).mult(2/3),W=F.clone().addvec(O),Z=l.clone().addvec(O);I.alignmentPoint=I.position=new R.McGePoint3d(W.x,F.y),B.alignmentPoint=B.position=W,r=W.x;const ie=this.getTextBox(I),$=this.getTextBox(B),oe=ie.maxPt.x>$.maxPt.x?ie.maxPt.x:$.maxPt.x;c<oe&&(c=oe+h*.3);const be=new R.McGePoint3d(c,Z.y),fe=new R.McDbLine(Z.x,Z.y,Z.z,be.x,be.y,be.y),Le=new R.McDbLine(l.x,l.y,l.z,Z.x,Z.y,Z.z);v.push(fe),t.push(B),t.push(I),t.push(Le)}if(this.textDownString.length){const I=new R.McGePoint3d(r,l.y);this.textDownString.forEach((F,B)=>{const O=new R.McDbText;O.textString=F,O.height=h;let W=new R.McGeVector3d;W=R.McGeVector3d.kYAxis.clone().negate().mult(h*(B+1+1/6)),O.alignmentPoint=O.position=I.clone().addvec(W),t.push(O);const Z=this.getTextBox(O);c=c<Z.maxPt.x?Z.maxPt.x:c})}if(this.isAddLongLine){const I=l.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.dimSize*2)),F=new R.McDbLine(l.x,l.y,l.z,I.x,I.y,I.y);c<I.x&&(c=I.x,t.push(F))}const _=new R.McGePoint3d(c,l.y),w=new R.McDbLine(l.x,l.y,l.z,_.x,_.y,_.y);t.push(w),v.length&&v.forEach(I=>{I.endPoint.x=c,t.push(I)});const b=I=>{const F=new R.McDbArc;F.computeArc(I[0].x,I[0].y,I[1].x,I[1].y,I[2].x,I[2].y),t.push(F)};if(this.isMostSymbols){const I=this.position.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.dimSize)),F=new R.McGePoint3d(c,I.y),B=this.dimSize*(7/5),O=F.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.dimSize*(7/5))),W=R.McGeVector3d.kXAxis.clone().mult(B),Z=O.clone().addvec(W.clone().rotateBy(40*(Math.PI/180))),ie=O.clone().addvec(W.clone()),$=O.clone().addvec(W.clone().rotateBy(320*(Math.PI/180)));b([Z,ie,$]);const oe=F.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.dimSize*(12/5))),be=oe.clone().addvec(W.clone().rotateBy(140*(Math.PI/180))),fe=oe.clone().addvec(W.clone().negate()),Le=oe.clone().addvec(W.clone().rotateBy(220*(Math.PI/180)));b([be,fe,Le]);const Xe=O.clone().addvec(oe.sub(O).mult(1/3)).addvec(R.McGeVector3d.kYAxis.clone().negate().mult(this.dimSize*(4/5)));this.drawShape(2,Xe,this.dimSize*(4/5),!1).forEach(Ne=>{t.push(Ne)})}this.getBox(t);const E=new R.McGeMatrix3d,P=this.maxPt.y-this.minPt.y;if(this.dimHeight){const I=this.dimHeight/P;E.setToScaling(I,this.position)}else E.setToScaling(1,this.position);return t.forEach(I=>{I.transformBy(E)}),t}getTextBox(t){const i=new R.McDbMText;switch(i.contents=t.textString,i.textHeight=t.height,i.location=t.position,t.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:i.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:i.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:i.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:i.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:i.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const l=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();return i.textStyleId=l,i.reCompute(),R.MxCADUtility.getTextEntityBox(i,!1)}getBox(t){let i,l=null,c;t.forEach(h=>{h instanceof R.McDbText?c=this.getTextBox(h):h instanceof R.McDbMText?(h.reCompute(),c=R.MxCADUtility.getTextEntityBox(h,!1)):c=h.getBoundingBox();const{minPt:f,maxPt:r,ret:v}=c;i||(i=f.clone()),l||(l=r.clone()),f.x<i.x&&(i.x=f.x),f.y<i.y&&(i.y=f.y),r.x>l.x&&(l.x=r.x),r.y>l.y&&(l.y=r.y)}),i&&l&&(this.maxPt=l,this.minPt=i)}drawShape(t,i,l,c){const h=[],f=R.McGeVector3d.kYAxis.clone().mult(l),r=R.McGeVector3d.kXAxis.clone().mult(l*(3/5)),v=i.clone().addvec(f),_=v.clone().addvec(r),w=v.clone().addvec(r.clone().negate());let b=l*(2/5);this.textDownStr.length>2&&c&&(b=l*(1/2));const E=i.clone().addvec(_.sub(i).mult(b));if(t===0){const P=new R.McDbPolyline;P.addVertexAt(_),P.addVertexAt(w),P.addVertexAt(i),P.addVertexAt(E),h.push(P)}else{const P=new R.McDbPolyline;P.addVertexAt(w),P.addVertexAt(i),P.addVertexAt(E),h.push(P)}if(t===1){const P=i.distanceTo(_),I=i.distanceTo(w),F=_.distanceTo(w),B=(P+I+F)/2,O=i.distanceTo(v),W=F*O/2,Z=new R.McDbCircle;Z.radius=W/B,Z.center=v.clone().addvec(R.McGeVector3d.kYAxis.clone().negate().mult(Z.radius)),h.push(Z)}return h}setPos(t){this.position=t.clone()}getPos(){return this.position}setRotation(t){this.rotation=t}getRotation(){return this.rotation}getBoundingBox(){const t=this.getAllEntity();return this.getBox(t),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function V3(){return Pn(this,null,function*(){const e=R.MxCpp.getCurrentMxCAD();let t=0;const i=new Fa;i.rougMarkType=0,i.rougCornerType="";const l=new R.MxCADUiPrPoint;l.setMessage(at("请设置定位点或直线或圆弧或圆")),l.setUserDraw((r,v)=>{i.setPos(r),v.drawMcDbEntity(i)});const c=yield l.go();let h=new R.MxCADResbuf([R.DxfCode.kEntityType,"LINE,ARC,CIRCLE,LWPOLYLINE"]),f=R.MxCADUtility.findEntAtPoint(c.x,c.y,c.z,-1,h);if(f.isValid()){const r=f.getMcDbEntity(),v=new R.MxCADUiPrPoint;if(v.setMessage(at("拖动确定标注位置")),v.setUserDraw((w,b)=>{const P=r.clone().getClosestPointTo(w,!0).val;t=w.sub(P).angleTo2(R.McGeVector3d.kYAxis,R.McGeVector3d.kNegateZAxis),i.setPos(P),i.setRotation(t),b.drawMcDbEntity(i)}),v.setDisableDynInput(!0),v.disableAllTrace(!0),!(yield v.go()))return;e.drawEntity(i)}else{i.setPos(c);const r=new R.MxCADUiPrAngle;if(r.setBasePt(c),r.setMessage(at("请指定或输入角度")),r.setUserDraw((w,b)=>{const E=new R.McDbLine(w,c);b.drawMcDbEntity(E),t=w.sub(c).angleTo2(R.McGeVector3d.kXAxis,R.McGeVector3d.kNegateZAxis),i.setRotation(t),b.drawMcDbEntity(i)}),!(yield r.go()))return;const _=r.value();i.setRotation(_),e.drawEntity(i)}})}class vf extends R.McDbCustomEntity{constructor(t){super(t),this.symbolType=0,this.width=10,this.startPt=new R.McGePoint3d,this.endPt=new R.McGePoint3d,this.midPt=new R.McGePoint3d,this.directPt=new R.McGePoint3d,this.isArc=0,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new vf(t)}get weldWidth(){return this.width}set weldWidth(t){this.width=t}get weldSymbolType(){return this.symbolType}set weldSymbolType(t){this.symbolType=t}set startPoint(t){this.startPt=t.clone()}set endPoint(t){this.endPt=t.clone()}set directPoint(t){this.directPt=t.clone()}set entityHandle(t){this.entHandle=t;const c=R.MxCpp.getCurrentMxCAD().database.handleToIdIndex(this.entHandle).getMcDbCurve();this.startPt=c.getStartPoint().val,this.endPt=c.getEndPoint().val,c instanceof R.McDbArc&&(this.isArc=1,this.midPt=c.getPointAtDist(c.getLength().val/2).val)}getTypeName(){return"McDbTestWeldSymbolBefore"}dwgInFields(t){return this.startPt=t.readPoint("startPt").val,this.endPt=t.readPoint("endPt").val,this.midPt=t.readPoint("midPt").val,this.directPt=t.readPoint("directPt").val,this.symbolType=t.readLong("symbolType").val,this.entHandle=t.readString("entHandle").val,this.isArc=t.readLong("isArc").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("startPt",this.startPt),t.writePoint("endPt",this.endPt),t.writePoint("midPt",this.midPt),t.writePoint("directPt",this.directPt),t.writeLong("symbolType",this.symbolType),t.writeLong("isArc",this.isArc),t.writeString("entHandle",this.entHandle),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),this.startPt.x+=i,this.startPt.y+=l,this.startPt.z+=c,this.endPt.x+=i,this.endPt.y+=l,this.endPt.z+=c,this.isArc&&(this.midPt.x+=i,this.midPt.y+=l,this.midPt.z+=c)}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.startPt),t}worldDraw(t){const i=[],c=.626*this.width;let h;this.isArc?(h=new R.McDbArc,h.computeArc(this.startPt.x,this.startPt.y,this.midPt.x,this.midPt.y,this.endPt.x,this.endPt.y)):h=new R.McDbLine(this.startPt,this.endPt);const f=51.5*Math.PI/180;if(this.symbolType===0||this.symbolType===1){const r=h.getLength().val,v=Math.ceil(r/this.width),_=r/v;for(let w=0;w<=v;w++){const b=h.getPointAtDist(w*_).val,E=h.getFirstDeriv(b).val.normalize().mult(c),P=E.angleTo2(R.McGeVector3d.kXAxis),I=new R.McDbArc;if(I.center=b.clone().subvec(E),I.startAngle=P-f,I.endAngle=P+f,I.radius=c,this.symbolType===1){const F=I.getStartPoint().val,B=I.getEndPoint().val;if(h instanceof R.McDbLine){const O=F.distanceTo(this.directPt),W=B.distanceTo(this.directPt);O<W?I.move(B,b):I.move(F,b)}else if(h instanceof R.McDbArc){const O=h.center.distanceTo(this.directPt),W=F.distanceTo(h.center),Z=B.distanceTo(h.center);O<h.radius?(W<=h.radius&&I.move(B,b),Z<=h.radius&&I.move(F,b)):(W>=h.radius&&I.move(B,b),Z>=h.radius&&I.move(F,b))}}t.drawEntity(I),i.push(I)}}this.getBox(i)}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}class _f extends R.McDbCustomEntity{constructor(t){super(t),this.originPt=new R.McGePoint3d,this.symbolType=0,this.width=10,this.angle=0,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new _f(t)}getTypeName(){return"McDbTestWeldSymbolSide"}get weldSymbolType(){return this.symbolType}set weldSymbolType(t){this.symbolType=t}get weldWidth(){return this.width}set weldWidth(t){this.width=t}get weldAngle(){return this.angle}set weldAngle(t){this.angle=t}dwgInFields(t){return this.originPt=t.readPoint("originPt").val,this.symbolType=t.readLong("symbolType").val,this.angle=t.readDouble("angle").val,this.width=t.readDouble("width").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("originPt",this.originPt),t.writeLong("symbolType",this.symbolType),t.writeDouble("angle",this.angle),t.writeDouble("width",this.width),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),this.originPt.x+=i,this.originPt.y+=l,this.originPt.z+=c}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.originPt),t}worldDraw(t){const i=[];if(this.symbolType===2){const l=this.originPt.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.width/2)),c=this.originPt.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.width/2).negate()),h=this.originPt.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.width)),f=new R.McDbHatch;f.appendLoop(new R.McGePoint3dArray([l,c,h])),this.angle&&f.rotate(this.originPt,this.angle),t.drawEntity(f),i.push(f)}else if(this.symbolType===3){const l=this.originPt.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.width)),c=this.originPt.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.width)),h=new R.McDbHatch;h.appendLoop(new R.McGePoint3dArray([l,c,this.originPt])),this.angle&&h.rotate(this.originPt,this.angle),t.drawEntity(h),i.push(h)}this.getBox(i)}getBox(t){const i=R.MxCpp.getCurrentMxCAD();let l,c=null,h;t.forEach(f=>{if(f instanceof R.McDbText){const w=new R.McDbMText;switch(w.contents=f.textString,w.textHeight=f.height,w.location=f.position,f.horizontalMode){case R.McDb.TextHorzMode.kTextLeft:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break;case R.McDb.TextHorzMode.kTextCenter:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;case R.McDb.TextHorzMode.kTextRight:w.attachment=R.McDb.AttachmentPoint.kBottomRight;break;case R.McDb.TextHorzMode.kTextMid:w.attachment=R.McDb.AttachmentPoint.kBottomCenter;break;default:w.attachment=R.McDb.AttachmentPoint.kBottomLeft;break}const b=i.getDatabase().getCurrentlyTextStyleId();w.textStyleId=b,w.reCompute(),h=R.MxCADUtility.getTextEntityBox(w,!1)}else f instanceof R.McDbMText?(f.reCompute(),h=R.MxCADUtility.getTextEntityBox(f,!1)):h=f.getBoundingBox();const{minPt:r,maxPt:v,ret:_}=h;l||(l=r.clone()),c||(c=v.clone()),r.x<l.x&&(l.x=r.x),r.y<l.y&&(l.y=r.y),v.x>c.x&&(c.x=v.x),v.y>c.y&&(c.y=v.y)}),l&&c&&(this.maxPt=c,this.minPt=l)}setOriginPt(t){this.originPt=t.clone()}getOriginPt(){return this.originPt}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function O3(){return Pn(this,null,function*(){ra.value="WeldSymbolDialog",To.showDialog(!0,{title:at("焊缝符号")}).then(i=>Pn(this,[i],function*({data:e,isCanceled:t}){if(R.MxCpp.getCurrentMxCAD(),!t&&e){const l=e.symbolType;for(;;)if(l==0||l==1){const c=new R.MxCADUiPrPoint;c.setMessage(at("请拾取定位点、直线或圆弧"));const h=yield c.go();if(!h)break;let f=new R.MxCADResbuf([R.DxfCode.kEntityType,"LINE,ARC,CIRCLE"]),r=R.MxCADUtility.findEntAtPoint(h.x,h.y,h.z,-1,f);const v=new vf;if(v.weldSymbolType=l,v.weldWidth=e.width?e.width:10,r.isValid()){const P=r.getMcDbEntity().getHandle();v.entityHandle=P}else{const E=new R.MxCADUiPrPoint;E.setMessage(`${at("请指定第二点")}`),E.setUserDraw((I,F)=>{const B=new R.McDbLine(h,I);F.drawMcDbEntity(B)});const P=yield E.go();if(!P)break;v.startPoint=h,v.endPoint=P}const _=new R.MxCADUiPrPoint;_.setDisableDynInput(!0),_.setMessage("左键确定，右键结束当前命令"),_.setUserDraw((E,P)=>{v.directPoint=E,P.setColor("#00FF00"),P.drawMcDbEntity(v)});const w=yield _.go();if(!w)break;v.directPoint=w,v.trueColor=new R.McCmColor(255,255,0),R.MxCpp.getCurrentMxCAD().drawEntity(v)}else if(l==2||l==3){const c=new _f;c.weldSymbolType=l;const h=new R.MxCADUiPrPoint;h.setMessage(`${at("请设置定位点")}`),h.setUserDraw((w,b)=>{c.setOriginPt(w),b.drawMcDbEntity(c)});const f=yield h.go();if(!f)break;const r=new R.MxCADUiPrAngle;r.setMessage(`${at("请设置角度")}`),r.setBasePt(f),r.setUserDraw((w,b)=>{const P=w.sub(f).angleTo2(R.McGeVector3d.kXAxis);c.weldAngle=P,b.drawMcDbEntity(c)});let v=yield r.go();if(!v&&v!=0)break;const _=r.value();c.weldAngle=_,c.weldWidth=e.width?e.width:10,R.MxCpp.getCurrentMxCAD().drawEntity(c)}else break}}))})}class bf extends R.McDbCustomEntity{constructor(t){super(t),this.startPt=new R.McGePoint3d,this.endPt=new R.McGePoint3d,this.size=4,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new bf(t)}getTypeName(){return"McDbTestDirectionaSymbol"}set startPoint(t){this.startPt=t.clone()}get startPoint(){return this.startPt}set endPoint(t){this.endPt=t.clone()}get endPoint(){return this.endPt}set dimSize(t){this.size=t}get dimSize(){return this.size}dwgInFields(t){return this.startPt=t.readPoint("startPt").val,this.endPt=t.readPoint("endPt").val,this.size=t.readDouble("size").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("startPt",this.startPt),t.writePoint("endPt",this.endPt),t.writeDouble("size",this.size),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),this.startPt.x+=i,this.startPt.y+=l,this.startPt.z+=c,this.endPt.x+=i,this.endPt.y+=l,this.endPt.z+=c}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.startPt),t}worldDraw(t){const i=[],l=this.endPt.sub(this.startPt).normalize(),c=this.startPt.clone().addvec(l.clone().mult(3*this.size)),h=this.startPt.clone().addvec(l.clone().mult(this.size)),f=new R.McDbLine(this.startPt,c);t.drawEntity(f),i.push(f);const r=h.clone().addvec(l.clone().perpVector().mult(this.size*(1/8))),v=h.clone().addvec(l.clone().perpVector().mult(this.size*(1/8)).negate()),_=new R.McDbHatch;_.appendLoop(new R.McGePoint3dArray([r,v,this.startPt])),t.drawEntity(_),i.push(_),this.getBox(i)}getBox(t){let i,l=null;t.forEach(c=>{const{minPt:h,maxPt:f,ret:r}=c.getBoundingBox();i||(i=h.clone()),l||(l=f.clone()),h.x<i.x&&(i.x=h.x),h.y<i.y&&(i.y=h.y),f.x>l.x&&(l.x=f.x),f.y>l.y&&(l.y=f.y)}),i&&l&&(this.maxPt=l,this.minPt=i)}getBoundingBox(){return{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}}function G3(){return Pn(this,null,function*(){const e=R.MxCpp.getCurrentMxCAD(),t=new R.MxCADUiPrPoint;t.setMessage("请确定向视符号的起点位置");const i=yield t.go();if(!i)return;const l=new bf;l.startPoint=i;const c=new R.MxCADUiPrPoint;c.setMessage("请确定向视符号固定长度的终点位置"),c.setUserDraw((f,r)=>{l.endPoint=f,r.drawMcDbEntity(l)});const h=yield c.go();if(h){l.endPoint=h,e.drawEntity(l);for(let f=0;f<2;f++){const r=new R.MxCADMText;r.data=[{type:"paragraph",children:[{text:"A",fontSize:.2}]}];const v=new R.MxCADUiPrPoint;f==0?v.setMessage("请确定文本位置"):f==1&&v.setMessage("请确定向视图标识的位置");const _=yield v.go();r.position=_,e.drawEntity(r)}}})}var ii=(e=>(e[e.top=1]="top",e[e.down=2]="down",e))(ii||{}),Ut=(e=>(e[e.WithPadSymbol=0]="WithPadSymbol",e[e.SurroundingWeldSeamSymbol=1]="SurroundingWeldSeamSymbol",e[e.OnSiteSymbol=2]="OnSiteSymbol",e[e.ThreeSidedWeldSeamSymbol=3]="ThreeSidedWeldSeamSymbol",e[e.TailSymbol=4]="TailSymbol",e[e.ZSymbol=5]="ZSymbol",e[e.RolledEdge=6]="RolledEdge",e[e.IWeldSeam=7]="IWeldSeam",e[e.VWeldSeam=8]="VWeldSeam",e[e.SingleVWeldSeam=9]="SingleVWeldSeam",e[e.SingleSteepVWeldSeam=10]="SingleSteepVWeldSeam",e[e.InclinedWeldSeam=11]="InclinedWeldSeam",e[e.RemovablePadding1=12]="RemovablePadding1",e[e.RemovablePadding2=13]="RemovablePadding2",e[e.DurableLiner=14]="DurableLiner",e[e.VFlangedEdgeSeam=15]="VFlangedEdgeSeam",e[e.UFlangedEdgeSeam=16]="UFlangedEdgeSeam",e[e.SingleVFlangedEdgeSeam=17]="SingleVFlangedEdgeSeam",e[e.SingleUFlangedEdgeSeam=18]="SingleUFlangedEdgeSeam",e[e.EndWeldSeam=19]="EndWeldSeam",e[e.SurfacingJoint=20]="SurfacingJoint",e[e.BottomSeamWeld=21]="BottomSeamWeld",e[e.FilletWeld=22]="FilletWeld",e[e.GrooveWeldSeam=23]="GrooveWeldSeam",e[e.SpotWeldSeam=24]="SpotWeldSeam",e[e.FoldingInterface=25]="FoldingInterface",e[e.InclinedInterface=26]="InclinedInterface",e[e.SpotWeldSeamOffset=27]="SpotWeldSeamOffset",e[e.SeamWeld=28]="SeamWeld",e[e.SeamWeldOffset=29]="SeamWeldOffset",e[e.SteepVWeldSeam=30]="SteepVWeldSeam",e[e.BellShapedWeldSeam=31]="BellShapedWeldSeam",e[e.SingleBellShapedWeldSeam=32]="SingleBellShapedWeldSeam",e[e.HeapWeldSeam=33]="HeapWeldSeam",e[e.SeamSeam=34]="SeamSeam",e[e.LockTheSlopeOpening=35]="LockTheSlopeOpening",e[e.FirstPlaneSymbol=36]="FirstPlaneSymbol",e[e.SecondConcaveSymbol=37]="SecondConcaveSymbol",e[e.SecondConvexeSymbol=38]="SecondConvexeSymbol",e[e.SecondPlaneSymbol=39]="SecondPlaneSymbol",e[e.ThirdPlaneSymbol=40]="ThirdPlaneSymbol",e[e.FirstConvexeSymbol=41]="FirstConvexeSymbol",e[e.FirstConcaveSymbol=42]="FirstConcaveSymbol",e[e.FlattenWeldSeam=43]="FlattenWeldSeam",e[e.ToeAareaTranSmoothly=44]="ToeAareaTranSmoothly",e[e.none=45]="none",e))(Ut||{});class Fh extends R.McDbCustomEntity{constructor(t){super(t),this.size=4,this.baseSymbok=[],this.auxiliarySymbol=[],this.specialSymbol=[],this.suppleSymbol=[],this.leftDim=[],this.topDim=[],this.rightDim=[],this.dottedPos=0,this.height=this.size*(7/8),this.weldingInfo="",this.interlacedWeldSeam=[],this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new Fh(t)}getTypeName(){return"McDbTestWeldingSymbol"}set weldingPosition(t){this.position=this.fixedPoint=this.turningPoint=t.clone()}get weldingPosition(){return this.position}set turningPoint(t){this.turningPt=this.fixedPoint=t.clone()}get turningPoint(){return this.turningPt}set fixedPos(t){this.fixedPoint=t.clone()}get fixedPos(){return this.fixedPoint}set dimSize(t){this.size=t,this.height=this.size*(7/8)}get dimSize(){return this.size}set dottedLinePos(t){this.dottedPos=t}get dottedLinePos(){return this.dottedPos}set weldingSymbolInfo(t){this.weldingInfo=t}get weldingSymbolInfo(){return this.weldingInfo}dwgInFields(t){this.position=t.readPoint("position").val,this.turningPt=t.readPoint("turningPt").val,this.fixedPoint=t.readPoint("fixedPoint").val,this.size=t.readDouble("size").val,this.dottedPos=t.readLong("dottedPos").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val;const i=t.readString("baseSymbok").val;this.baseSymbok=JSON.parse(i);const l=t.readString("AuxiliarySymbol").val;this.auxiliarySymbol=JSON.parse(l);const c=t.readString("specialSymbol").val;this.specialSymbol=JSON.parse(c);const h=t.readString("suppleSymbol").val;this.suppleSymbol=JSON.parse(h);const f=t.readString("leftDim").val;this.leftDim=JSON.parse(f);const r=t.readString("topDim").val;this.topDim=JSON.parse(r);const v=t.readString("rightDim").val;this.rightDim=JSON.parse(v);const _=t.readString("interlacedWeldSeam").val;return this.interlacedWeldSeam=JSON.parse(_),this.weldingInfo=t.readString("weldingInfo").val,!0}dwgOutFields(t){return t.writePoint("turningPt",this.turningPt),t.writePoint("position",this.position),t.writePoint("fixedPoint",this.fixedPoint),t.writeDouble("size",this.size),t.writeLong("dottedPos",this.dottedPos),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),t.writeString("baseSymbok",JSON.stringify(this.baseSymbok)),t.writeString("AuxiliarySymbol",JSON.stringify(this.auxiliarySymbol)),t.writeString("specialSymbol",JSON.stringify(this.specialSymbol)),t.writeString("suppleSymbol",JSON.stringify(this.suppleSymbol)),t.writeString("leftDim",JSON.stringify(this.leftDim)),t.writeString("topDim",JSON.stringify(this.topDim)),t.writeString("rightDim",JSON.stringify(this.rightDim)),t.writeString("interlacedWeldSeam",JSON.stringify(this.interlacedWeldSeam)),t.writeString("weldingInfo",this.weldingInfo),!0}moveGripPointsAt(t,i,l,c){this.assertWrite(),t===0?(this.position.x+=i,this.position.y+=l,this.position.z+=c):t===1?(this.turningPt.x+=i,this.turningPt.y+=l,this.turningPt.z+=c):t===2&&(this.fixedPoint.x+=i,this.fixedPoint.y+=l,this.fixedPoint.z+=c)}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.position),t.append(this.turningPt),t.append(this.fixedPoint),t}worldDraw(t){const i=this.getAllEntity();i.forEach((l,c)=>{c===i.length-1&&t.setupForEntity(l),t.drawEntity(l)})}getAllEntity(){const t=[],i=[];let l=this.fixedPoint.x<this.position.x,c=this.fixedPoint.clone();c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(1/8)));const h=new R.McDbPolyline;h.addVertexAt(this.position),h.addVertexAt(this.turningPt),h.addVertexAt(this.fixedPoint),i.push(h);const f=this.turningPoint.sub(this.position).normalize(),r=this.position.clone().addvec(f.mult(this.size)),v=f.clone().perpVector().mult(this.size*(1/8)),_=r.clone().addvec(v),w=r.clone().addvec(v.clone().negate()),b=new R.McDbHatch;if(b.appendLoop(new R.McGePoint3dArray([_,w,this.position])),i.push(b),this.suppleSymbol.length){const{entityArr:P,noChangeArr:I,v:F}=this.drawSuppleSymbol(l);c.addvec(F),t.push(...P),i.push(...I)}if(this.leftDim.length){const{entityArr:P,v:I}=this.drawLeftDim(c);c.addvec(I),t.push(...P)}if(this.specialSymbol.length){const{entityArr:P}=this.drawSpecialSymbol(c);t.push(...P),c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/2))}if(this.suppleSymbol.length&&this.suppleSymbol.filter(P=>P.typeName===0).length){const P=this.drawWidth(c);t.push(...P)}if(this.baseSymbok.length){const{entityArr:P}=this.drawBasicSymbol(c);t.push(...P)}if(this.auxiliarySymbol.length){const{entityArr:P}=this.drawAuxiliarySymbol(c);t.push(...P)}if(this.topDim.length){const{entityArr:P}=this.drawTopDim(c);t.push(...P)}if(c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(7/4))),this.rightDim.length){const{entityArr:P,v:I}=this.drawRightDim(c);c.addvec(I),t.push(...P)}if(c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(4/8))),this.suppleSymbol.length&&this.suppleSymbol.filter(P=>P.typeName===5).length){(this.baseSymbok.length||this.suppleSymbol.filter($=>$.typeName===0))&&c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/2));const P=R.McGeVector3d.kXAxis.clone().mult(this.size*(1/16)),I=R.McGeVector3d.kYAxis.clone().mult(this.size*(17/16)),F=R.McGeVector3d.kXAxis.clone().mult(this.height).negate(),B=c.clone().addvec(I),O=c.clone().addvec(I.clone().negate()),W=B.clone().addvec(F),Z=O.clone().addvec(F),ie=new R.McDbPolyline;if(ie.addVertexAt(W),ie.addVertexAt(B),ie.addVertexAt(Z),ie.addVertexAt(O),t.push(ie),this.interlacedWeldSeam.length){let $=null;this.interlacedWeldSeam.forEach(oe=>{const be=new R.McDbMText;be.contents=oe.content,be.textHeight=this.height,be.attachment=R.McDb.AttachmentPoint.kTopLeft,oe.position===2?be.location=c.clone().addvec(P):oe.position===1&&(be.location=c.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size)).addvec(P));const fe=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();be.textStyleId=fe,be.reCompute();const{maxPt:Le}=R.MxCADUtility.getTextEntityBox(be,!1);(!$||$<Le.x)&&($=Le.x),t.push(be)}),c.x=$}}if(this.suppleSymbol.length&&this.suppleSymbol.filter(P=>P.typeName===4).length){const P=this.fixedPoint.sub(c).mult(2),I=R.McGeVector3d.kYAxis.clone().mult(this.height),F=l?R.McGeVector3d.kXAxis.clone().negate().mult(this.height):R.McGeVector3d.kXAxis.clone().mult(this.height),B=c.clone().addvec(I).addvec(F),O=c.clone().addvec(I.clone().negate()).addvec(F),W=new R.McDbPolyline;if(W.addVertexAt(B),W.addVertexAt(c),W.addVertexAt(O),l&&W.move(c,c.clone().addvec(P)),i.push(W),this.weldingInfo){const Z=new R.McDbMText;Z.contents=this.weldingInfo;const ie=l?R.McGeVector3d.kXAxis.clone().mult(this.size*(5/4)).negate():R.McGeVector3d.kXAxis.clone().mult(this.size*(5/4));Z.location=c.clone().addvec(ie),Z.attachment=l?R.McDb.AttachmentPoint.kMiddleRight:R.McDb.AttachmentPoint.kMiddleLeft,Z.textHeight=this.height,l&&Z.move(c,c.clone().addvec(P)),i.push(Z)}}const E=new R.McDbLine(c,this.fixedPoint);if(l&&E.move(c,this.fixedPoint),i.push(E),this.dottedPos&&!this.suppleSymbol.filter(P=>P.typeName===5).length){const P=R.McGeVector3d.kYAxis.clone().mult(this.size*.25);this.dottedPos===2&&P.negate();const I=this.fixedPoint.clone().addvec(P),F=E.clone();F.move(this.fixedPoint,I);const B=R.MxCpp.getCurrentMxCAD();let O=this.dimSize/8,W=B.database,Z=B.getSysVarDouble("LTSCALE");O=O/Z;let ie=W.getLinetypeTable(),$="weldingDottedLineType",oe=ie.get($);if(oe.isNull()){let be=new R.McDbLinetypeTableRecord;be.numDashes=2,be.setDashLengthAt(0,O),be.setDashLengthAt(1,-O),be.name=$,oe=ie.add(be)}F.linetypeId=oe,i.push(F)}if(l){let P=this.fixedPoint.clone();this.suppleSymbol.filter(I=>I.typeName===2).length&&(P=this.fixedPoint.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/4)).negate())),t.forEach(I=>{I.move(c,P)})}return t.push(...i),t}drawSuppleSymbol(t){const i=[],l=[];let c=this.fixedPoint.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.125)),h=this.fixedPoint.clone(),f=R.McGeVector3d.kYAxis.clone().mult(this.size*(1/4));if(this.suppleSymbol.filter(v=>v.typeName===1).length){const v=new R.McDbCircle(this.fixedPoint.x,this.fixedPoint.y,0,this.size*.375);l.push(v),c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(3/8))),h=new R.McGePoint3d(c.x,this.fixedPoint.y)}if(this.suppleSymbol.filter(v=>v.typeName===2).length){const v=R.McGeVector3d.kYAxis.clone().mult(this.size*.375),_=this.fixedPoint.clone().addvec(v),w=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(7/8))),b=R.McGeVector3d.kXAxis.clone().mult(this.size*(5/4)),E=_.clone().addvec(b),P=new R.McDbLine(this.fixedPoint,_);let I=new R.McDbHatch;I.appendLoop(new R.McGePoint3dArray([_,w,E]));const{maxPt:F}=I.getBoundingBox();if(h=new R.McGePoint3d(F.x,this.fixedPoint.y),t){I=new R.McDbHatch;const B=_.clone().addvec(b.clone().negate());I.appendLoop(new R.McGePoint3dArray([_,w,B]))}l.push(I),l.push(P),c.addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(7/8)))}if(this.suppleSymbol.filter(v=>v.typeName===3).length){const v=this.suppleSymbol.filter(ie=>ie.typeName===3)[0],_=this.dottedPos===1?c.clone().addvec(f):c.clone(),w=R.McGeVector3d.kYAxis.clone(),b=_.clone().addvec(w.clone().mult(this.size*(1/8))),E=b.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),P=b.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(3/4))),I=E.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(3/4))),F=new R.McDbPolyline;F.addVertexAt(E),F.addVertexAt(b),F.addVertexAt(P),F.addVertexAt(I);const{minPt:B,maxPt:O}=F.getBoundingBox();let W=O.x;const Z=B.clone().addvec(O.sub(B).mult(1/2));if(v.rotation){F.rotate(Z,v.rotation),v.rotation!=Math.PI&&F.move(_,b);const{maxPt:ie}=F.getBoundingBox();W=ie.x}h=new R.McGePoint3d(W,this.fixedPoint.y),i.push(F)}const r=h.sub(this.fixedPoint);return{entityArr:i,noChangeArr:l,v:r}}drawWidth(t){const i=[];let l=R.McGeVector3d.kYAxis.clone().mult(this.size*.25);const c=R.McGeVector3d.kXAxis.clone().mult(this.size/2),h=R.McGeVector3d.kYAxis.clone().mult(this.size*(7/16)).negate(),f=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size));this.dottedLinePos===2&&f.addvec(l.clone().negate());const r=f.clone().addvec(c),v=r.clone().addvec(h),_=f.clone().addvec(c.clone().negate()),w=_.clone().addvec(h),b=[r,v,w,_],E=new R.McDbPolyline;return b.forEach(P=>{E.addVertexAt(P)}),i.push(E),i}drawLeftDim(t){const i=[];let l=null;const c=R.McGeVector3d.kXAxis.clone().mult(this.size*(1/16)),h=R.McGeVector3d.kYAxis.clone().mult(this.size*(1/4));this.leftDim.forEach(r=>{const v=new R.McDbMText;if(v.contents=r.content,v.textHeight=this.height,v.attachment=R.McDb.AttachmentPoint.kTopLeft,r.position===2){const b=this.dottedPos===2&&!this.suppleSymbol.filter(E=>E.typeName===5).length?t.clone().addvec(h.negate()):t.clone();v.location=b.clone().addvec(c)}else if(r.position===1){const b=this.dottedPos===1&&this.suppleSymbol.filter(E=>E.typeName===5).length?t.clone().addvec(h):t.clone();v.location=b.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size)).addvec(c)}const _=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();v.textStyleId=_,v.reCompute();const{maxPt:w}=R.MxCADUtility.getTextEntityBox(v,!1);if((!l||l<w.x)&&(l=w.x),this.dottedLinePos&&r.position===this.dottedLinePos){const b=this.dottedLinePos===1?R.McGeVector3d.kYAxis.clone().mult(this.size/4):R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();v.location=v.location.addvec(b)}i.push(v)});const f=new R.McGePoint3d(l,t.y).sub(t);return{entityArr:i,v:f}}drawTopDim(t){const i=[],l=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*1.75));return this.topDim.forEach(c=>{const h=new R.McDbMText;if(h.contents=c.content,h.textHeight=this.height,h.attachment=R.McDb.AttachmentPoint.kBaseCenter,h.location=l.clone(),h.location=l.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),c.position===2&&(h.mirror(this.fixedPoint,t),h.attachment=R.McDb.AttachmentPoint.kBaseCenter,h.location=h.location.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height))),this.dottedLinePos&&c.position===this.dottedLinePos){const f=this.dottedLinePos===1?R.McGeVector3d.kYAxis.clone().mult(this.size/4):R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();h.location=h.location.addvec(f)}i.push(h)}),{entityArr:i}}drawRightDim(t){const i=[],l=R.McGeVector3d.kXAxis.clone();let c=null;return this.rightDim.forEach(h=>{const f=new R.McDbMText;f.contents=h.content,f.textHeight=this.height,f.attachment=R.McDb.AttachmentPoint.kTopLeft,h.position===1?f.location=t.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height+this.size/8)):h.position===2&&(f.location=t.clone());const r=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();f.textStyleId=r,f.reCompute();const{maxPt:v}=R.MxCADUtility.getTextEntityBox(f,!1);if((!c||c<v.x)&&(c=v.x),this.dottedLinePos&&h.position===this.dottedLinePos){const _=this.dottedLinePos===1?R.McGeVector3d.kYAxis.clone().mult(this.size/4):R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();f.location=f.location.addvec(_)}i.push(f)}),l.mult(Math.abs(c-t.x)),{entityArr:i,v:l}}drawBasicSymbol(t){const i=[],l=[],c=(r,v)=>{let _=[];const{maxPt:w,minPt:b}=v.getBoundingBox(),E=b.clone().addvec(w.sub(b).mult(1/2)),P=new R.McGePoint3d(E.x,t.y),I=new R.McDbMText;I.contents=r.info,I.attachment=R.McDb.AttachmentPoint.kTopCenter,I.textHeight=this.size*.3333333333333333,I.location=P.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*.9166666666666666));const F=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();I.textStyleId=F,I.reCompute();const{minPt:B,maxPt:O}=R.MxCADUtility.getTextEntityBox(I,!1);if(r.position===2){const ie=I.clone();ie.mirror(this.fixedPoint,t),I.attachment=R.McDb.AttachmentPoint.kTopCenter,I.location=ie.location.addvec(R.McGeVector3d.kYAxis.clone().mult(I.textHeight*1.1666666666666667))}i.push(I);const Z=new R.McDbLine(B,new R.McGePoint3d(O.x,B.y)).IntersectWith(v,R.McDb.Intersect.kOnBothOperands);return Z.length()===2?_=[Z.at(0),v.getPointAt(1).val,Z.at(1)]:Z.length()===1&&(_=[v.getPointAt(0).val,v.getPointAt(1).val,Z.at(0)]),_},h=r=>{const v=new R.McDbPolyline;return r.forEach(_=>{v.addVertexAt(_)}),v},f=(r,v)=>{const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.375)),w=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(5/8))),b=w.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/4))),E=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/4))),P=h([_,w,b,E]),{minPt:I,maxPt:F}=P.getBoundingBox(),B=I.clone().addvec(F.sub(I).mult(1/2)),O=new R.McDbMText;O.contents=r,O.attachment=R.McDb.AttachmentPoint.kBaseFit,O.textHeight=this.size*.625,O.location=B,O.reCompute();const W=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();O.textStyleId=W,O.reCompute();const{minPt:Z,maxPt:ie}=R.MxCADUtility.getTextEntityBox(O,!1),$=Z.clone().addvec(ie.sub(Z).mult(.5)),oe=B.sub($);if(O.location=B.clone().addvec(oe).addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/15)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/17)),v.position===2){const be=O.clone();be.mirror(this.fixedPoint,t),O.location=be.location.addvec(R.McGeVector3d.kYAxis.clone().mult(O.textHeight*1.1666666666666667))}i.push(P,O)};return this.baseSymbok.forEach(r=>{if(i.length=0,r.typeName===6){const v=this.size*.75,_=new R.McDbArc;_.center=t.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(v)).addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/8)),_.radius=v,_.startAngle=Math.PI*(3/2),_.endAngle=0;const w=_.center.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(v)),b=w.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(1/8))),E=new R.McDbLine(b,w),P=w.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(1/8))),I=_.clone();I.mirror(P,new R.McGePoint3d(P.x,t.y));const F=E.clone();F.mirror(P,new R.McGePoint3d(P.x,t.y)),i.push(_,I,F,E)}else if(r.typeName===7){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.6875)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),w=new R.McDbLine(v,_),b=w.clone(),E=v.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/8)));b.move(v,E),i.push(w,b)}else if(r.typeName===8){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.5)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(7/8))),w=v.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(1/2))),b=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size));let E=[_,w,b];const P=h(E);if(r.info){const F=c(r,P);F.length&&(E=F)}const I=h(E);i.push(I)}else if(r.typeName===9){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.625)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),w=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.height));let b=[_,v,w];const E=h(b);if(r.info){const I=c(r,E);I.length&&(b=I)}const P=h(b);i.push(P)}else if(r.typeName===10){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.625));v.addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(1/8)));const _=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),w=v.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/2)),b=w.clone().addvec(v.sub(w).mult(1/4)),E=b.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)).addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/16))),P=new R.McDbLine(b,E),F=h([_,v,w]);i.push(F,P)}else if(r.typeName===11){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/2)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height/2)),w=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/8))),b=w.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height/2)),E=new R.McDbLine(_,b),P=new R.McDbLine(v,w);i.push(E,P)}else if(r.typeName===12)f("MR",r);else if(r.typeName===13)f("R",r);else if(r.typeName===14)f("M",r);else if(r.typeName===15){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(3/8))),w=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/16))).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/2)),b=w.clone().addvec(R.McGeVector3d.kXAxis.clone().negate().mult(this.size*(5/8)));let E=[w,_,b];const P=new R.McDbLine(v,_),I=h(E);if(r.info){const B=c(r,I);B.length&&(E=B)}const F=h(E);i.push(F,P)}else if(r.typeName===17){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.6875)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(3/8))),w=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/2)),b=w.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(5/8)));let E=[w,_,b];const P=new R.McDbLine(v,_),I=h(E);if(r.info){const B=c(r,I);B.length&&(E=B)}const F=h(E);i.push(F,P)}else if(r.typeName===16){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(1/4))),w=new R.McDbLine(v,_),b=this.size*(3/8),E=new R.McDbArc;E.center=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(b)),E.radius=b,E.startAngle=Math.PI,E.endAngle=Math.PI*2;const P=E.getStartPoint().val,I=P.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4)),F=E.getEndPoint().val,B=F.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4));let O=[I,v,B];const W=h(O);if(r.info){const Z=c(r,W);Z.length&&(O=Z);const $=new R.McDbLine(O[0],O[2]).IntersectWith(E,R.McDb.Intersect.kOnBothOperands);if($.length()){const oe=new R.McDbArc;oe.computeArc($.at(0).x,$.at(0).y,_.x,_.y,$.at(1).x,$.at(1).y),i.push(oe)}else i.push(E)}else{const Z=new R.McDbLine(P,I),ie=new R.McDbLine(F,B);i.push(Z,ie,E)}i.push(w)}else if(r.typeName===18){const v=this.size*.375,_=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size-v/2)),w=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),b=new R.McDbLine(_,w),E=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(1/4))),P=new R.McDbArc;P.center=E.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(v)),P.radius=v,P.startAngle=Math.PI*(3/2),P.endAngle=Math.PI*2;const I=P.getEndPoint().val,F=I.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4)),B=new R.McDbLine(I,F);i.push(B,P,b)}else if(r.typeName===19){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),w=new R.McDbLine(v,_),b=R.McGeVector3d.kXAxis.clone().mult(this.size*(3/16)),E=w.clone();E.move(v,v.clone().addvec(b));const P=w.clone();P.move(v,v.clone().addvec(b.clone().negate())),i.push(w,E,P)}else if(r.typeName===20){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*.6875)),_=R.McGeVector3d.kXAxis.clone().mult(this.size*(3/8)),w=v.clone().addvec(_),b=v.clone().addvec(_.clone().negate()),E=new R.McDbLine(w,b),P=E.clone();P.mirror(this.fixedPoint,t),i.push(E,P)}else if(r.typeName===21){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(1/4))),w=new R.McDbCircle;w.center=_,w.radius=this.size*(11/16);const b=new R.McDbLine(this.fixedPoint,t),E=w.IntersectWith(b,R.McDb.Intersect.kExtendBoth);if(E.length()===2){const P=new R.McDbArc,I=_.clone().addvec(R.McGeVector3d.kYAxis.clone().negate().mult(w.radius)),F=E.at(0),B=E.at(1);P.computeArc(F.x,F.y,I.x,I.y,B.x,B.y),P.mirror(this.fixedPoint,t);const O=new R.McDbLine(F,B);i.push(P,O)}}else if(r.typeName===22){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=R.McGeVector3d.kXAxis.clone().mult(this.height/2),w=v.clone().addvec(_),b=v.clone().addvec(_.clone().negate()),E=b.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),P=h([w,b,E]);P.isClosed=!0,i.push(P)}else if(r.typeName===23){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=R.McGeVector3d.kXAxis.clone().mult(this.size/2),w=R.McGeVector3d.kYAxis.clone().mult(this.size*(5/8)),b=v.clone().addvec(_),E=b.clone().addvec(w),P=E.clone().addvec(_.negate().mult(2)),I=P.clone().addvec(w.clone().negate()),F=h([b,E,P,I]);i.push(F)}else if(r.typeName===24){const v=new R.McDbCircle;v.center=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),v.radius=this.size*(3/8),i.push(v)}else if(r.typeName===25){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height*(2/3))),w=R.McGeVector3d.kXAxis.clone().mult(this.size*(1/8)),b=_.clone().addvec(w),E=_.clone().addvec(w.clone().negate()),P=new R.McDbLine(b,E),I=R.McGeVector3d.kYAxis.clone().mult(this.height/3),F=P.clone();F.move(b,b.clone().addvec(I)),F.endPoint=F.endPoint.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.height/3).negate());const B=P.clone();B.move(b,b.clone().addvec(I.clone().negate()));const O=new R.McDbArc;O.center=E.clone().addvec(I.clone().negate()),O.radius=this.height/3,O.startAngle=Math.PI/2,O.endAngle=Math.PI*(3/2);const W=new R.McDbArc;W.center=b,W.radius=this.height/3,W.startAngle=Math.PI*(3/2),W.endAngle=Math.PI/2,i.push(P,F,B,O,W)}else if(r.typeName===26){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size-this.height/2)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)).addvec(R.McGeVector3d.kXAxis.clone().mult(this.height/2)),w=new R.McDbLine(v,_),b=w.clone();b.move(v,v.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.height/2))),i.push(w,b)}else if(r.typeName===27){const v=new R.McDbCircle;v.center=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),v.radius=this.height/2,i.push(v)}else if(r.typeName===28){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=new R.McDbCircle;_.center=v,_.radius=this.size*(11/16);const w=R.McGeVector3d.kXAxis.clone().mult(this.height),b=v.clone().addvec(w),E=v.clone().addvec(w.clone().negate()),P=new R.McDbLine(b,E),I=R.McGeVector3d.kYAxis.clone().mult(this.height/2),F=P.clone();F.move(v,v.clone().addvec(I));const B=P.clone();B.move(v,v.clone().addvec(I.clone().negate())),i.push(_,F,B)}else if(r.typeName===29){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=R.McGeVector3d.kYAxis.clone().mult(this.size*(9/16)),w=new R.McDbCircle;w.center=v.clone().addvec(_),w.radius=this.size*(9/16);const b=R.McGeVector3d.kXAxis.clone().mult(this.height),E=v.clone().addvec(b),P=v.clone().addvec(b.clone().negate()),I=new R.McDbLine(E,P),F=w.center.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(3/16))),B=w.center.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate()),O=I.clone();O.move(v,F);const W=I.clone();W.move(v,B),i.push(w,O,W)}else if(r.typeName===30){const v=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),_=v.addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4)),w=R.McGeVector3d.kXAxis.clone().mult(this.size*(5/16)),b=_.clone().addvec(w),E=_.clone().addvec(w.clone().negate()),P=new R.McDbLine(b,E),I=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/8)),F=I.clone().addvec(w).addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),B=new R.McDbLine(I,F),O=B.clone();O.mirror(v,_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size))),i.push(P,B,O)}if(r.position===2&&i.forEach(v=>{v instanceof R.McDbMText||v.mirror(this.fixedPoint,t)}),this.dottedLinePos&&r.position===this.dottedLinePos){const v=this.dottedLinePos===1?R.McGeVector3d.kYAxis.clone().mult(this.size/4):R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();i.forEach(_=>{_.move(t,t.clone().addvec(v))})}l.push(...i)}),{entityArr:l}}drawSpecialSymbol(t){const i=[],l=[];return this.specialSymbol.forEach(c=>{if(i.length=0,c.typeName===31){const h=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*1.25)),f=R.McGeVector3d.kXAxis.clone().mult(this.size/8),r=h.clone().addvec(f),v=r.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/8)),_=new R.McDbLine(r,v),w=new R.McDbArc,b=this.size*(3/4);w.center=v.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(b)),w.radius=b,w.startAngle=Math.PI/2,w.endAngle=Math.PI;const E=h.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size)),P=_.clone();P.mirror(h,E);const I=w.clone();I.mirror(h,E),i.push(_,w,P,I)}else if(c.typeName===32){const h=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.375)),f=h.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),r=new R.McDbLine(h,f),v=h.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/4)),_=v.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/8)),w=new R.McDbLine(v,_),b=new R.McDbArc;b.center=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(3/4))),b.radius=this.size*(3/4),b.startAngle=Math.PI/2,b.endAngle=Math.PI,i.push(r,w,b)}else if(c.typeName===33){const h=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.375)),f=this.size*(9/16),r=new R.McDbArc;r.center=h.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(f)),r.radius=f,r.startAngle=0,r.endAngle=Math.PI;const v=r.clone(),_=h.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(f*2));v.mirror(_,_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size))),i.push(r,v)}else if(c.typeName===34){const h=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*.375)),f=R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate(),r=h.clone().addvec(f),v=R.McGeVector3d.kXAxis.clone().mult(this.height),_=r.clone().addvec(v),w=_.clone().addvec(f.clone().mult(7/4)),b=w.clone().addvec(v.clone().negate()),E=new R.McDbPolyline;[h,r,_,w,b].forEach(W=>E.addVertexAt(W));const I=h.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.height)),F=I.clone().addvec(v),B=new R.McDbPolyline;[I,h,F].forEach(W=>B.addVertexAt(W)),i.push(E,B)}else if(c.typeName===35){const h=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().negate().mult(this.size/4)),f=R.McGeVector3d.kXAxis.clone().mult(this.size*(7/16)),r=h.clone().addvec(f),v=r.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(7/16)).negate()),_=v.clone().addvec(f.clone().negate()),w=new R.McDbPolyline;[h,r,v,_].forEach(W=>w.addVertexAt(W));const E=h.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(5/8))),P=R.McGeVector3d.kXAxis.clone().mult(this.size*(9/16)),I=E.clone().addvec(P),F=E.clone().addvec(P.clone().negate()),B=new R.McDbPolyline;[I,h,F].forEach(W=>B.addVertexAt(W)),i.push(w,B)}if(c.position===2&&i.forEach(h=>{h.mirror(this.fixedPoint,this.fixedPoint.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*10)))}),this.dottedLinePos&&c.position===this.dottedLinePos){const h=this.dottedLinePos===1?R.McGeVector3d.kYAxis.clone().mult(this.size/4):R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();i.forEach(f=>{f.move(t,t.clone().addvec(h))})}l.push(...i)}),{entityArr:l}}drawAuxiliarySymbol(t){const i=[],l=[];return this.auxiliarySymbol.forEach(c=>{i.length=0;const h=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(21/16))),f=R.McGeVector3d.kXAxis.clone().mult(this.size*(5/8)),r=h.clone().addvec(f),v=h.clone().addvec(f.clone().negate());if(c.typeName===36){const _=new R.McDbLine(r,v);i.push(_)}else if(c.typeName===37){const _=h.clone().addvec(R.McGeVector3d.kYAxis.clone().negate().mult(this.size*.375)),w=new R.McDbArc;w.computeArc(r.x,r.y,_.x,_.y,v.x,v.y),i.push(w)}else if(c.typeName===38){const _=h.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*.375)),w=new R.McDbArc;w.computeArc(r.x,r.y,_.x,_.y,v.x,v.y),i.push(w)}else if(c.typeName===39){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4)),w=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size*(11/16))),b=_.clone().addvec(R.McGeVector3d.kXAxis.clone().negate().mult(this.size/4)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(15/16))),E=new R.McDbLine(w,b);i.push(E)}else if(c.typeName===40){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/4)),w=_.clone().addvec(R.McGeVector3d.kXAxis.clone().negate().mult(this.size*(11/16))),b=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size/4)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(15/16))),E=new R.McDbLine(w,b);i.push(E)}else if(c.typeName===41){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*.625)),w=new R.McDbArc;w.center=_,w.startAngle=0,w.endAngle=Math.PI/2,w.radius=this.size*(5/8),i.push(w)}else if(c.typeName===42){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*.625)),w=this.size*(5/8),b=_.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(w)).addvec(R.McGeVector3d.kYAxis.clone().mult(w)),E=new R.McDbArc;E.center=b,E.radius=w,E.startAngle=Math.PI,E.endAngle=Math.PI*(3/2),i.push(E)}else if(c.typeName===43){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)).addvec(R.McGeVector3d.kYAxis.clone().mult(this.size)),w=R.McGeVector3d.kXAxis.clone().mult(this.size*(7/16)),b=_.clone().addvec(w),E=_.clone().addvec(w.clone().negate()),P=new R.McDbLine(b,E),I=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size/8)),F=R.McGeVector3d.kXAxis.clone().mult(this.size*(7/32)),B=I.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(7/16))).addvec(F.clone().negate()),O=B.clone().addvec(F.clone().mult(2)),W=O.sub(I),Z=O.clone().addvec(W),ie=[O,B,I,Z],$=new R.McDbPolyline;ie.forEach(oe=>$.addVertexAt(oe)),i.push($,P)}else if(c.typeName===44){const _=t.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(this.size)),w=_.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(5/4))),b=w.clone().addvec(R.McGeVector3d.kYAxis.clone().mult(this.size*(3/8))),E=new R.McDbLine(w,b),P=this.size*(7/32),I=w.clone().addvec(R.McGeVector3d.kXAxis.clone().mult(P)),F=new R.McDbArc;F.center=I,F.radius=P,F.startAngle=Math.PI,F.endAngle=0;const B=F.clone();B.mirror(_,w),i.push(E,F,B)}if(c.position===2&&i.forEach(_=>{_.mirror(this.fixedPoint,t)}),this.dottedLinePos&&c.position===this.dottedLinePos){const _=this.dottedLinePos===1?R.McGeVector3d.kYAxis.clone().mult(this.size/4):R.McGeVector3d.kYAxis.clone().mult(this.size/4).negate();i.forEach(w=>{w.move(t,t.clone().addvec(_))})}l.push(...i)}),{entityArr:l}}getBox(t){let i,l=null;t.forEach(c=>{if(c instanceof R.McDbMText){const r=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();c.textStyleId=r,c.reCompute()}const{minPt:h,maxPt:f}=c instanceof R.McDbMText?R.MxCADUtility.getTextEntityBox(c,!1):c.getBoundingBox();i||(i=h.clone()),l||(l=f.clone()),h.x<i.x&&(i.x=h.x),h.y<i.y&&(i.y=h.y),f.x>l.x&&(l.x=f.x),f.y>l.y&&(l.y=f.y)}),i&&l&&(this.assertWrite(),this.maxPt=l,this.minPt=i)}getBoundingBox(){const t=this.getAllEntity();return this.getBox(t),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}getBaseSymbok(){return this.baseSymbok}setBaseSymbok(t){const i=t.filter(l=>l.typeName!==45);this.baseSymbok=i}getAuxiliarySymbol(){return this.auxiliarySymbol}setAuxiliarySymbol(t){const i=t.filter(l=>l.typeName!==45);this.auxiliarySymbol=i}getSpecialSymbol(){return this.specialSymbol}setSpecialSymbol(t){const i=t.filter(l=>l.typeName!==45);this.specialSymbol=i}getSuppleSymbol(){return this.suppleSymbol}setSuppleSymbol(t){const i=t.filter(l=>l.typeName!==45);this.suppleSymbol=i}getLeftDim(){return this.leftDim}setLeftDim(t){const i=t.filter(l=>l.content!=="");this.leftDim=i}getTopDim(){return this.topDim}setTopDim(t){const i=t.filter(l=>l.content!=="");this.topDim=i}getRightDim(){return this.rightDim}setRightDim(t){const i=t.filter(l=>l.content!=="");this.rightDim=i}getIntWeldSeam(){return this.interlacedWeldSeam}setIntWeldSeam(t){const i=t.filter(l=>l.content!=="");this.interlacedWeldSeam=i}}function j3(){return Pn(this,null,function*(){ra.value="WeldingSymbolDialog",To.showDialog(!0,{title:at("焊接符号")}).then(i=>Pn(this,[i],function*({data:e,isCanceled:t}){if(!t&&e.formData){const l=e.formData,c=new Fh;if(l.specialSymbol.length&&c.setSpecialSymbol(l.specialSymbol),l.rightDim1||l.rightDim2){const F=[1,2],B=[];F.forEach(O=>{const W=l.rightDim1.filter($=>$.position===O)[0],Z=l.rightDim2.filter($=>$.position===O)[0],ie=W.content&&Z.content?"×":"";B.push({position:O,content:W.content+ie+Z.content})}),c.setRightDim(B)}l.suppleSymbol.length&&c.setSuppleSymbol(l.suppleSymbol),l.leftDim&&c.setLeftDim(l.leftDim),l.topDim&&c.setTopDim(l.topDim),l.auxiliarySymbol.length&&c.setAuxiliarySymbol(l.auxiliarySymbol),l.basicSymbol.length&&c.setBaseSymbok(l.basicSymbol),l.intWeldSeam&&c.setIntWeldSeam(l.intWeldSeam),l.dottedLinePos&&(c.dottedLinePos=l.dottedLinePos),l.weldingSymbolInfo&&(c.weldingSymbolInfo=l.weldingSymbolInfo.replace(/\n/g,"\\P"));let h=!1;const f=new R.MxCADUiPrPoint;f.setMessage(`${at("请设置定位点或直线或圆弧")}`);const r=yield f.go();if(!r)return;c.weldingPosition=r;const v=new R.MxCADResbuf;v.AddMcDbEntityTypes("ARC,CIRCLE");let _=R.MxCADUtility.findEntAtPoint(r.x,r.y,r.z,-1,v);_.isValid()&&(h=!0);const w=new R.MxCADUiPrPoint;w.setMessage(`${at("请设置引线转折点")}`),w.setUserDraw((F,B)=>{if(h){const W=_.getMcDbEntity().getClosestPointTo(F,!0).val;c.weldingPosition=W}c.turningPoint=F,B.drawMcDbEntity(c)});const b=yield w.go();if(!b)return;c.turningPoint=b;const E=new R.MxCADUiPrPoint;E.setMessage(`${at("拖动确定定位点")}`),E.setUserDraw((F,B)=>{const O=c.clone();O.fixedPos=F,B.drawMcDbEntity(O)});const P=yield E.go();P&&(c.fixedPos=P),R.MxCpp.getCurrentMxCAD().drawEntity(c)}}))})}class wf extends R.McDbCustomEntity{constructor(t){super(t),this.startPoint=new R.McGePoint3d,this.endPoint=new R.McGePoint3d,this.anchorPoint=new R.McGePoint3d,this.arrowSize=4,this.minPt=new R.McGePoint3d,this.maxPt=new R.McGePoint3d}create(t){return new wf(t)}getTypeName(){return"McDbTestRayAnnotation"}dwgInFields(t){return this.startPoint=t.readPoint("startPoint").val,this.endPoint=t.readPoint("endPoint").val,this.anchorPoint=t.readPoint("anchorPoint").val,this.arrowSize=t.readDouble("arrowSize").val,this.minPt=t.readPoint("minPt").val,this.maxPt=t.readPoint("maxPt").val,!0}dwgOutFields(t){return t.writePoint("startPoint",this.startPoint),t.writePoint("endPoint",this.endPoint),t.writePoint("anchorPoint",this.anchorPoint),t.writeDouble("arrowSize",this.arrowSize),t.writePoint("minPt",this.minPt),t.writePoint("maxPt",this.maxPt),!0}moveGripPointsAt(t,i,l,c){this.assertWrite();const h=new R.McDbLine(this.startPoint,this.endPoint);if(t===0){const f=this.startPoint.clone();f.x+=i,f.y+=l,f.z+=c,this.startPoint=h.getClosestPointTo(f,!0).val}else if(t===1){const f=this.endPoint.clone();f.x+=i,f.y+=l,f.z+=c,this.endPoint=h.getClosestPointTo(f,!0).val}else t===2&&(this.anchorPoint.x+=i,this.anchorPoint.y+=l,this.anchorPoint.z+=c,this.resetAnchorPoint())}getGripPoints(){let t=new R.McGePoint3dArray;return t.append(this.startPoint),t.append(this.endPoint),t.append(this.anchorPoint),t}sortPointsByXAxis(t){const i=t.map(l=>l.clone());for(let l=0;l<i.length-1;l++)for(let c=0;c<i.length-1-l;c++)if(i[c].x>i[c+1].x){const h=i[c];i[c]=i[c+1],i[c+1]=h}return i}worldDraw(t){this.getAllEntity().forEach(i=>{t.drawEntity(i)})}getAllEntity(){const t=new R.McDbLine(this.startPoint,this.endPoint),i=this.startPoint.sub(this.endPoint).normalize().mult(this.arrowSize),l=this.endPoint.clone().addvec(i),c=i.clone().perpVector().mult(this.arrowSize/8),h=l.clone().addvec(c),f=l.clone().addvec(c.clone().negate()),r=new R.McDbHatch;r.appendLoop(new R.McGePoint3dArray([h,f,this.endPoint]));const v=new R.McDbMText;v.contents=`${t.getLength().val.toFixed(2)}`,v.textHeight=this.arrowSize*(7/8),v.attachment=R.McDb.AttachmentPoint.kBottomCenter,v.location=this.anchorPoint.clone(),v.textStyleId=R.MxCpp.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleId();const _=this.sortPointsByXAxis([this.endPoint,this.startPoint]),w=_[_.length-1].sub(_[0]),b=w.clone().angleTo2(R.McGeVector3d.kXAxis);v.rotate(v.location,b),v.location=v.location.clone().addvec(w.clone().rotateBy(Math.PI/2).normalize().mult(this.arrowSize/8)),v.reCompute();const{maxPt:E,minPt:P}=R.MxCADUtility.getTextEntityBox(v,!1),I=t.getClosestPointTo(E,!0).val,F=t.getClosestPointTo(P,!0).val,B=this.sortPointsByXAxis([I,F,this.startPoint,this.endPoint,this.anchorPoint]),O=new R.McDbLine(B[0],B[B.length-1]);return[r,O,v]}getBox(t){let i,l=null;t.forEach(c=>{c instanceof R.McDbMText&&c.reCompute();const{minPt:h,maxPt:f}=c instanceof R.McDbMText?R.MxCADUtility.getTextEntityBox(c,!1):c.getBoundingBox();i||(i=h.clone()),l||(l=f.clone()),h.x<i.x&&(i.x=h.x),h.y<i.y&&(i.y=h.y),f.x>l.x&&(l.x=f.x),f.y>l.y&&(l.y=f.y)}),i&&l&&(this.assertWrite(),this.maxPt=l,this.minPt=i)}resetAnchorPoint(){const t=new R.McDbLine(this.startPoint,this.endPoint),i=t.getClosestPointTo(this.anchorPoint,!0).val;t.getDistAtPoint(this.anchorPoint).val?this.anchorPoint=t.getPointAtDist(t.getLength().val/2).val:this.anchorPoint=i}getBoundingBox(){return this.getBox(this.getAllEntity()),{minPt:this.minPt,maxPt:this.maxPt,ret:!0}}setStartPoint(t){this.assertWrite(),this.startPoint=this.endPoint=this.anchorPoint=t.clone()}getStartPoint(){return this.startPoint}setEndPoint(t){this.assertWrite(),this.endPoint=this.anchorPoint=t.clone()}getEndPoint(){return this.endPoint}setAnchorPoint(t){this.assertWrite(),this.anchorPoint=t.clone(),this.resetAnchorPoint()}getAnchorPoint(){return this.anchorPoint}setArrowSize(t){this.assertWrite(),this.arrowSize=t}getArrowSize(){return this.arrowSize}}function H3(){return Pn(this,null,function*(){const e=R.MxCpp.getCurrentMxCAD(),t=new wf;t.setArrowSize(5);const i=new R.MxCADUiPrPoint;i.setMessage(at("请指定第一点:"));const l=yield i.go();if(!l)return;t.setStartPoint(l);const c=new R.MxCADUiPrPoint;c.setMessage(at("请指定第二点:")),c.setUserDraw((v,_)=>{t.setEndPoint(v),_.drawMcDbEntity(t)});const h=yield c.go();if(!h)return;t.setEndPoint(h);const f=new R.MxCADUiPrPoint;f.setMessage("请指定定位点:"),f.setUserDraw((v,_)=>{t.setAnchorPoint(v),_.drawMcDbEntity(t)});const r=yield f.go();r&&(t.setAnchorPoint(r),e.drawEntity(t))})}function Af(e){return new Promise((t,i)=>{R.MxCpp.getCurrentMxCAD().setAttribute({ShowCoordinate:!1}),Ke.MxFun.getCurrentDraw().createCanvasImageData(l=>{let c=new R.MxCanvas2Image(document);const h=R.MxCpp.getCurrentMxCAD();let f=c.convertToImage(h.mxdraw.getCanvas(),void 0,void 0,"bmp");t(f.src),h.setAttribute({ShowCoordinate:!0})},e)})}function W3(){new ff().rxInit(),new mf().rxInit(),new gf().rxInit(),new yf().rxInit(),new xf().rxInit(),new Fa().rxInit(),new vf().rxInit(),new _f().rxInit(),new bf().rxInit(),new Fh().rxInit(),new wf().rxInit(),Ke.MxFun.addCommand("Mx_Approval",F3),Ke.MxFun.addCommand("Mx_AnnotatedRectangle",k3),Ke.MxFun.addCommand("Mx_Alignment",B3),Ke.MxFun.addCommand("Mx_indexSymbol",z3),Ke.MxFun.addCommand("Mx_RotationLabel",U3),Ke.MxFun.addCommand("Mx_RoundHoleMark",N3),Ke.MxFun.addCommand("Mx_Roughness",V3),Ke.MxFun.addCommand("Mx_weldSymbol",O3),Ke.MxFun.addCommand("Mx_DirectionaSymbol",G3),Ke.MxFun.addCommand("Mx_WeldingSymbol",j3),Ke.MxFun.addCommand("MxTest_DrawRayAnnotation",H3),R3(),aT(),L3()}var q3=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Y3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var y1={exports:{}};(function(e,t){(function(i,l){e.exports=l()})(q3,function(){var i,l,c;function h(r,v){if(!i)i=v;else if(!l)l=v;else{var _="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+l+")(sharedChunk); self.onerror = null;",w={};i(w),c=v(w),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([_],{type:"text/javascript"})))}}h(["exports"],function(r){var v="2.8.2",_=w;function w(a,n,s,u){this.cx=3*a,this.bx=3*(s-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=u,this.p2x=s,this.p2y=u}w.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},w.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},w.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},w.prototype.solveCurveX=function(a,n){var s,u,p,g,x;for(n===void 0&&(n=1e-6),p=a,x=0;x<8;x++){if(g=this.sampleCurveX(p)-a,Math.abs(g)<n)return p;var A=this.sampleCurveDerivativeX(p);if(Math.abs(A)<1e-6)break;p-=g/A}if((p=a)<(s=0))return s;if(p>(u=1))return u;for(;s<u;){if(g=this.sampleCurveX(p),Math.abs(g-a)<n)return p;a>g?s=p:u=p,p=.5*(u-s)+s}return p},w.prototype.solve=function(a,n){return this.sampleCurveY(this.solveCurveX(a,n))};var b=E;function E(a,n){this.x=a,this.y=n}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,n){return this.clone()._rotateAround(a,n)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var n=a.x-this.x,s=a.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,n){return Math.atan2(this.x*n-this.y*a,this.x*a+this.y*n)},_matMult:function(a){var n=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=n,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var n=Math.cos(a),s=Math.sin(a),u=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=u,this},_rotateAround:function(a,n){var s=Math.cos(a),u=Math.sin(a),p=n.y+u*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-u*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},E.convert=function(a){return a instanceof E?a:Array.isArray(a)?new E(a[0],a[1]):a};var P=typeof self!="undefined"?self:{};const I=Math.PI/180,F=180/Math.PI;function B(a){return a*I}function O(a){return a*F}const W=[[0,0],[1,0],[1,1],[0,1]];function Z(a){if(a<=0)return 0;if(a>=1)return 1;const n=a*a,s=n*a;return 4*(a<.5?s:3*(a-n)+s-.75)}function ie(a,n,s,u){const p=new _(a,n,s,u);return function(g){return p.solve(g)}}const $=ie(.25,.1,.25,1);function oe(a,n,s){return Math.min(s,Math.max(n,a))}function be(a,n,s){return(s=oe((s-a)/(n-a),0,1))*s*(3-2*s)}function fe(a,n,s){const u=s-n,p=((a-n)%u+u)%u+n;return p===n?s:p}function Le(a,n,s){if(!a.length)return s(null,[]);let u=a.length;const p=new Array(a.length);let g=null;a.forEach((x,A)=>{n(x,(T,D)=>{T&&(g=T),p[A]=D,--u==0&&s(g,p)})})}function Xe(a){const n=[];for(const s in a)n.push(a[s]);return n}function Ne(a,...n){for(const s of n)for(const u in s)a[u]=s[u];return a}let Re=1;function Ie(){return Re++}function He(){return function a(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function Ue(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function ot(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Pt(a,n){a.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function mt(a,n){return a.indexOf(n,a.length-n.length)!==-1}function _t(a,n,s){const u={};for(const p in a)u[p]=n.call(s||this,a[p],p,a);return u}function ft(a,n,s){const u={};for(const p in a)n.call(s||this,a[p],p,a)&&(u[p]=a[p]);return u}function Vt(a){return Array.isArray(a)?a.map(Vt):typeof a=="object"&&a?_t(a,Vt):a}const we={};function pe(a){we[a]||(typeof console!="undefined"&&console.warn(a),we[a]=!0)}function ke(a,n,s){return(s.y-a.y)*(n.x-a.x)>(n.y-a.y)*(s.x-a.x)}function De(a){let n=0;for(let s,u,p=0,g=a.length,x=g-1;p<g;x=p++)s=a[p],u=a[x],n+=(u.x-s.x)*(s.y+u.y);return n}function Se(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function tt(a){const n={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,p,g)=>{const x=p||g;return n[u]=!x||x.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let Ge,We,nt,je,lt=null;function gt(a){if(lt==null){const n=a.navigator?a.navigator.userAgent:null;lt=!!a.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return lt}function Lt(a){try{const n=P[a];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch(n){return!1}}const sn={now:()=>nt!==void 0?nt:P.performance.now(),setNow(a){nt=a},restoreNow(){nt=void 0},frame(a){const n=P.requestAnimationFrame(a);return{cancel:()=>P.cancelAnimationFrame(n)}},getImageData(a,n=0){const{width:s,height:u}=a;je||(je=P.document.createElement("canvas"));const p=je.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return(s>je.width||u>je.height)&&(je.width=s,je.height=u),p.clearRect(-n,-n,s+2*n,u+2*n),p.drawImage(a,0,0,s,u),p.getImageData(-n,-n,s+2*n,u+2*n)},resolveURL:a=>(Ge||(Ge=P.document.createElement("a")),Ge.href=a,Ge.href),get devicePixelRatio(){return P.devicePixelRatio},get prefersReducedMotion(){return!!P.matchMedia&&(We==null&&(We=P.matchMedia("(prefers-reduced-motion: reduce)")),We.matches)}};let An;const le={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(An==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{An={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):a}catch(n){An=a}}return An},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ee={supported:!1,testSupport:function(a){!Mn&&wt&&(xn?un(a):Et=a)}};let Et,wt,Mn=!1,xn=!1;function un(a){const n=a.createTexture();a.bindTexture(a.TEXTURE_2D,n);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,wt),a.isContextLost())return;Ee.supported=!0}catch(s){}a.deleteTexture(n),Mn=!0}P.document&&(wt=P.document.createElement("img"),wt.onload=function(){Et&&un(Et),Et=null,xn=!0},wt.onerror=function(){Mn=!0,Et=null},wt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const bn="01",Tn="NO_ACCESS_TOKEN";function hn(a){return a.indexOf("mapbox:")===0}function jt(a){return le.API_URL_REGEX.test(a)}const ln=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xt(a){const n=a.match(ln);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function Ve(a){const n=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${n}`}function Ot(a){if(!a)return null;const n=a.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(P.atob(n[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(s){return null}}class en{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const s=Ot(le.ACCESS_TOKEN);let u="";return u=s&&s.u?P.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(p,g)=>String.fromCharCode(+("0x"+g)))):le.ACCESS_TOKEN||"",n?`mapbox.eventData.${n}:${u}`:`mapbox.eventData:${u}`}fetchEventData(){const n=Lt("localStorage"),s=this.getStorageKey(),u=this.getStorageKey("uuid");if(n)try{const p=P.localStorage.getItem(s);p&&(this.eventData=JSON.parse(p));const g=P.localStorage.getItem(u);g&&(this.anonId=g)}catch(p){pe("Unable to read from LocalStorage")}}saveEventData(){const n=Lt("localStorage"),s=this.getStorageKey(),u=this.getStorageKey("uuid");if(n)try{P.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&P.localStorage.setItem(s,JSON.stringify(this.eventData))}catch(p){pe("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,s,u,p){if(!le.EVENTS_URL)return;const g=Xt(le.EVENTS_URL);g.params.push(`access_token=${p||le.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(n).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:bn,userId:this.anonId},A=s?Ne(x,s):x,T={url:Ve(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=Fe(T,D=>{this.pendingRequest=null,u(D),this.saveEventData(),this.processRequests(p)})}queueRequest(n,s){this.queue.push(n),this.processRequests(s)}}const Ln=new class extends en{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,n){le.EVENTS_URL&&le.ACCESS_TOKEN&&Array.isArray(a)&&a.some(s=>hn(s)||jt(s))&&this.queueRequest(Date.now(),n)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=Ot(le.ACCESS_TOKEN),s=n?n.u:le.ACCESS_TOKEN;let u=s!==this.eventData.tokenU;ot(this.anonId)||(this.anonId=He(),u=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),x=new Date(p),A=(p-this.eventData.lastSuccess)/864e5;u=u||A>=1||A<-1||g.getDate()!==x.getDate()}else u=!0;u?this.postEvent(p,{"enabled.telemetry":!1},g=>{g||(this.eventData.lastSuccess=p,this.eventData.tokenU=s)},a):this.processRequests()}},fn=Ln.postTurnstileEvent.bind(Ln),Gn=new class extends en{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,n,s,u){this.skuToken=n,this.errorCb=u,le.EVENTS_URL&&(s||le.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(Tn)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),ot(this.anonId)||(this.anonId=He()),this.postEvent(s,{skuToken:this.skuToken},u=>{u?this.errorCb(u):n&&(this.success[n]=!0)},a))}},qn=Gn.postMapLoadEvent.bind(Gn),Jn=new class extends en{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,n,s,u){if(!le.API_URL||!le.SESSION_PATH)return;const p=Xt(le.API_URL+le.SESSION_PATH);p.params.push(`sku=${n||""}`),p.params.push(`access_token=${u||le.ACCESS_TOKEN||""}`);const g={url:Ve(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Ze(g,x=>{this.pendingRequest=null,s(x),this.saveEventData(),this.processRequests(u)})}getSessionAPI(a,n,s,u){this.skuToken=n,this.errorCb=u,le.SESSION_PATH&&le.API_URL&&(s||le.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(Tn)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||this.getSession(s,this.skuToken,u=>{u?this.errorCb(u):n&&(this.success[n]=!0)},a)}},Ji=Jn.getSessionAPI.bind(Jn),jn=new Set,ki="mapbox-tiles";let oi,or,Mi=500,Zr=50;function Gi(){P.caches&&!oi&&(oi=P.caches.open(ki))}function Jr(a){const n=a.indexOf("?");return n<0?a:a.slice(0,n)}let Lr=1/0;const de={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(de);class q extends Error{constructor(n,s,u){s===401&&jt(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const J=Se()?()=>self.worker&&self.worker.referrer:()=>(P.location.protocol==="blob:"?P.parent:P).location.href,ce=function(a,n){if(!(/^file:/.test(s=a.url)||/^file:/.test(J())&&!/^\w+:/.test(s))){if(P.fetch&&P.Request&&P.AbortController&&P.Request.prototype.hasOwnProperty("signal"))return function(u,p){const g=new P.AbortController,x=new P.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:J(),signal:g.signal});let A=!1,T=!1;const D=(k=x.url).indexOf("sku=")>0&&jt(k);var k;u.type==="json"&&x.headers.set("Accept","application/json");const z=(H,K,te)=>{if(T)return;if(H&&H.message!=="SecurityError"&&pe(H),K&&te)return N(K);const ae=Date.now();P.fetch(x).then(he=>{if(he.ok){const Pe=D?he.clone():null;return N(he,Pe,ae)}return p(new q(he.statusText,he.status,u.url))}).catch(he=>{he.code!==20&&p(new Error(he.message))})},N=(H,K,te)=>{(u.type==="arrayBuffer"?H.arrayBuffer():u.type==="json"?H.json():H.text()).then(ae=>{T||(K&&te&&function(he,Pe,Be){if(Gi(),!oi)return;const Oe={status:Pe.status,statusText:Pe.statusText,headers:new P.Headers};Pe.headers.forEach((st,ut)=>Oe.headers.set(ut,st));const qe=tt(Pe.headers.get("Cache-Control")||"");if(qe["no-store"])return;qe["max-age"]&&Oe.headers.set("Expires",new Date(Be+1e3*qe["max-age"]).toUTCString());const Ye=Oe.headers.get("Expires");Ye&&(new Date(Ye).getTime()-Be<42e4||function(st,ut){if(or===void 0)try{new Response(new ReadableStream),or=!0}catch(vt){or=!1}or?ut(st.body):st.blob().then(ut)}(Pe,st=>{const ut=new P.Response(st,Oe);Gi(),oi&&oi.then(vt=>vt.put(Jr(he.url),ut)).catch(vt=>pe(vt.message))}))}(x,K,te),A=!0,p(null,ae,H.headers.get("Cache-Control"),H.headers.get("Expires")))}).catch(ae=>{T||p(new Error(ae.message))})};return D?function(H,K){if(Gi(),!oi)return K(null);const te=Jr(H.url);oi.then(ae=>{ae.match(te).then(he=>{const Pe=function(Be){if(!Be)return!1;const Oe=new Date(Be.headers.get("Expires")||0),qe=tt(Be.headers.get("Cache-Control")||"");return Oe>Date.now()&&!qe["no-cache"]}(he);ae.delete(te),Pe&&ae.put(te,he.clone()),K(null,he,Pe)}).catch(K)}).catch(K)}(x,z):z(null,null),{cancel:()=>{T=!0,A||g.abort()}}}(a,n);if(Se()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,n,void 0,!0)}var s;return function(u,p){const g=new P.XMLHttpRequest;g.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const x in u.headers)g.setRequestHeader(x,u.headers[x]);return u.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=u.credentials==="include",g.onerror=()=>{p(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let x=g.response;if(u.type==="json")try{x=JSON.parse(g.response)}catch(A){return p(A)}p(null,x,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else p(new q(g.statusText,g.status,u.url))},g.send(u.body),{cancel:()=>g.abort()}}(a,n)},Ae=function(a,n){return ce(Ne(a,{type:"arrayBuffer"}),n)},Fe=function(a,n){return ce(Ne(a,{method:"POST"}),n)},Ze=function(a,n){return ce(Ne(a,{method:"GET"}),n)};function Je(a){const n=P.document.createElement("a");return n.href=a,n.protocol===P.document.location.protocol&&n.host===P.document.location.host}const ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let et,xt;et=[],xt=0;const Gt=function(a,n){if(Ee.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),xt>=le.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:a,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return et.push(g),g}xt++;let s=!1;const u=()=>{if(!s)for(s=!0,xt--;et.length&&xt<le.MAX_PARALLEL_IMAGE_REQUESTS;){const g=et.shift(),{requestParameters:x,callback:A,cancelled:T}=g;T||(g.cancel=Gt(x,A).cancel)}},p=Ae(a,(g,x,A,T)=>{u(),g?n(g):x&&(P.createImageBitmap?function(D,k){const z=new P.Blob([new Uint8Array(D)],{type:"image/png"});P.createImageBitmap(z).then(N=>{k(null,N)}).catch(N=>{k(new Error(`Could not load image because of ${N.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(D,k)=>n(D,k,A,T)):function(D,k){const z=new P.Image,N=P.URL;z.onload=()=>{k(null,z),N.revokeObjectURL(z.src),z.onload=null,P.requestAnimationFrame(()=>{z.src=ze})},z.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new P.Blob([new Uint8Array(D)],{type:"image/png"});z.src=D.byteLength?N.createObjectURL(H):ze}(x,(D,k)=>n(D,k,A,T)))});return{cancel:()=>{p.cancel(),u()}}};function St(a,n,s){s[a]&&s[a].indexOf(n)!==-1||(s[a]=s[a]||[],s[a].push(n))}function vn(a,n,s){if(s&&s[a]){const u=s[a].indexOf(n);u!==-1&&s[a].splice(u,1)}}class X{constructor(n,s={}){Ne(this,s),this.type=n}}class ee extends X{constructor(n,s={}){super("error",Ne({error:n},s))}}class Te{on(n,s){return this._listeners=this._listeners||{},St(n,s,this._listeners),this}off(n,s){return vn(n,s,this._listeners),vn(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},St(n,s,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,s){typeof n=="string"&&(n=new X(n,s||{}));const u=n.type;if(this.listens(u)){n.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const A of p)A.call(this,n);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const A of g)vn(u,A,this._oneTimeListeners),A.call(this,n);const x=this._eventedParent;x&&(Ne(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof ee&&console.error(n.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var me=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function At(a,...n){for(const s of n)for(const u in s)a[u]=s[u];return a}function yt(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Nt(a){if(Array.isArray(a))return a.map(Nt);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const n={};for(const s in a)n[s]=Nt(a[s]);return n}return yt(a)}class rn extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class Fn{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[u,p]of s)this.bindings[u]=p}concat(n){return new Fn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const kn={kind:"null"},bt={kind:"number"},dn={kind:"string"},Jt={kind:"boolean"},mn={kind:"color"},En={kind:"object"},Rn={kind:"value"},xi={kind:"collator"},Fr={kind:"formatted"},hi={kind:"resolvedImage"};function fi(a,n){return{kind:"array",itemType:a,N:n}}function di(a){if(a.kind==="array"){const n=di(a.itemType);return typeof a.N=="number"?`array<${n}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${n}>`}return a.kind}const Fs=[kn,bt,dn,Jt,mn,Fr,En,fi(Rn),hi];function Ho(a,n){if(n.kind==="error")return null;if(a.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Ho(a.itemType,n.itemType))&&(typeof a.N!="number"||a.N===n.N))return null}else{if(a.kind===n.kind)return null;if(a.kind==="value"){for(const s of Fs)if(!Ho(s,n))return null}}return`Expected ${di(a)} but found ${di(n)} instead.`}function Tu(a,n){return n.some(s=>s.kind===a.kind)}function ks(a,n){return n.some(s=>s==="null"?a===null:s==="array"?Array.isArray(a):s==="object"?a&&!Array.isArray(a)&&typeof a=="object":s===typeof a)}function Eu(a){var n={exports:{}};return a(n,n.exports),n.exports}var Vd=Eu(function(a,n){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(A){return(A=Math.round(A))<0?0:A>255?255:A}function p(A){return u(A[A.length-1]==="%"?parseFloat(A)/100*255:parseInt(A))}function g(A){return(T=A[A.length-1]==="%"?parseFloat(A)/100:parseFloat(A))<0?0:T>1?1:T;var T}function x(A,T,D){return D<0?D+=1:D>1&&(D-=1),6*D<1?A+(T-A)*D*6:2*D<1?T:3*D<2?A+(T-A)*(2/3-D)*6:A}try{n.parseCSSColor=function(A){var T,D=A.replace(/ /g,"").toLowerCase();if(D in s)return s[D].slice();if(D[0]==="#")return D.length===4?(T=parseInt(D.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:D.length===7&&(T=parseInt(D.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var k=D.indexOf("("),z=D.indexOf(")");if(k!==-1&&z+1===D.length){var N=D.substr(0,k),H=D.substr(k+1,z-(k+1)).split(","),K=1;switch(N){case"rgba":if(H.length!==4)return null;K=g(H.pop());case"rgb":return H.length!==3?null:[p(H[0]),p(H[1]),p(H[2]),K];case"hsla":if(H.length!==4)return null;K=g(H.pop());case"hsl":if(H.length!==3)return null;var te=(parseFloat(H[0])%360+360)%360/360,ae=g(H[1]),he=g(H[2]),Pe=he<=.5?he*(ae+1):he+ae-he*ae,Be=2*he-Pe;return[u(255*x(Be,Pe,te+1/3)),u(255*x(Be,Pe,te)),u(255*x(Be,Pe,te-1/3)),K];default:return null}}return null}}catch(A){}});class Qn{constructor(n,s,u,p=1){this.r=n,this.g=s,this.b=u,this.a=p}static parse(n){if(!n)return;if(n instanceof Qn)return n;if(typeof n!="string")return;const s=Vd.parseCSSColor(n);return s?new Qn(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,u,p]=this.toArray();return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(u)},${p})`}toArray(){const{r:n,g:s,b:u,a:p}=this;return p===0?[0,0,0,0]:[255*n/p,255*s/p,255*u/p,p]}}Qn.black=new Qn(0,0,0,1),Qn.white=new Qn(1,1,1,1),Qn.transparent=new Qn(0,0,0,0),Qn.red=new Qn(1,0,0,1),Qn.blue=new Qn(0,0,1,1);class Bs{constructor(n,s,u){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Od{constructor(n,s,u,p,g){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=u,this.fontStack=p,this.textColor=g}}class ji{constructor(n){this.sections=n}static fromString(n){return new ji([new Od(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof ji?n:ji.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.name]);continue}n.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toArray())),n.push(u)}return n}}class kr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new kr({name:n,available:!1}):null}serialize(){return["image",this.name]}}function xo(a,n,s,u){return typeof a=="number"&&a>=0&&a<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,n,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,n,s,u]:[a,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pu(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Qn||a instanceof Bs||a instanceof ji||a instanceof kr)return!0;if(Array.isArray(a)){for(const n of a)if(!Pu(n))return!1;return!0}if(typeof a=="object"){for(const n in a)if(!Pu(a[n]))return!1;return!0}return!1}function Bi(a){if(a===null)return kn;if(typeof a=="string")return dn;if(typeof a=="boolean")return Jt;if(typeof a=="number")return bt;if(a instanceof Qn)return mn;if(a instanceof Bs)return xi;if(a instanceof ji)return Fr;if(a instanceof kr)return hi;if(Array.isArray(a)){const n=a.length;let s;for(const u of a){const p=Bi(u);if(s){if(s===p)continue;s=Rn;break}s=p}return fi(s||Rn,n)}return En}function Wo(a){const n=typeof a;return a===null?"":n==="string"||n==="number"||n==="boolean"?String(a):a instanceof Qn||a instanceof ji||a instanceof kr?a.toString():JSON.stringify(a)}class qo{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Pu(n[1]))return s.error("invalid value");const u=n[1];let p=Bi(u);const g=s.expectedType;return p.kind!=="array"||p.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(p=g),new qo(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qn?["rgba"].concat(this.value.toArray()):this.value instanceof ji?this.value.serialize():this.value}}class ar{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Gd={string:dn,number:bt,boolean:Jt,object:En};class vo{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u,p=1;const g=n[0];if(g==="array"){let A,T;if(n.length>2){const D=n[1];if(typeof D!="string"||!(D in Gd)||D==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);A=Gd[D],p++}else A=Rn;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);T=n[2],p++}u=fi(A,T)}else u=Gd[g];const x=[];for(;p<n.length;p++){const A=s.parse(n[p],p,Rn);if(!A)return null;x.push(A)}return new vo(u,x)}evaluate(n){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(n);if(!Ho(this.type,Bi(u)))return u;if(s===this.args.length-1)throw new ar(`Expected value to be of type ${di(this.type)}, but found ${di(Bi(u))} instead.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const p=n.N;(typeof p=="number"||this.args.length>1)&&s.push(p)}}return s.concat(this.args.map(u=>u.serialize()))}}class zs{constructor(n){this.type=Fr,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const p=[];let g=!1;for(let x=1;x<=n.length-1;++x){const A=n[x];if(g&&typeof A=="object"&&!Array.isArray(A)){g=!1;let T=null;if(A["font-scale"]&&(T=s.parse(A["font-scale"],1,bt),!T))return null;let D=null;if(A["text-font"]&&(D=s.parse(A["text-font"],1,fi(dn)),!D))return null;let k=null;if(A["text-color"]&&(k=s.parse(A["text-color"],1,mn),!k))return null;const z=p[p.length-1];z.scale=T,z.font=D,z.textColor=k}else{const T=s.parse(n[x],1,Rn);if(!T)return null;const D=T.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,p.push({content:T,scale:null,font:null,textColor:null})}}return new zs(p)}evaluate(n){return new ji(this.sections.map(s=>{const u=s.content.evaluate(n);return Bi(u)===hi?new Od("",u,null,null,null):new Od(Wo(u),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),n.push(u)}return n}}class Us{constructor(n){this.type=hi,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const u=s.parse(n[1],1,dn);return u?new Us(u):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),u=kr.fromString(s);return u&&n.availableImages&&(u.available=n.availableImages.indexOf(s)>-1),u}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Fx={"to-boolean":Jt,"to-color":mn,"to-number":bt,"to-string":dn};class _o{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[0];if((u==="to-boolean"||u==="to-string")&&n.length!==2)return s.error("Expected one argument.");const p=Fx[u],g=[];for(let x=1;x<n.length;x++){const A=s.parse(n[x],x,Rn);if(!A)return null;g.push(A)}return new _o(p,g)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,u;for(const p of this.args){if(s=p.evaluate(n),u=null,s instanceof Qn)return s;if(typeof s=="string"){const g=n.parseColor(s);if(g)return g}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:xo(s[0],s[1],s[2],s[3]),!u))return new Qn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new ar(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(n),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new ar(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?ji.fromString(Wo(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?kr.fromString(Wo(this.args[0].evaluate(n))):Wo(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new zs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Us(this.args[0]).serialize();const n=[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const kx=["Unknown","Point","LineString","Polygon"];class Qm{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?kx[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:u,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*s-n[0])+this.featureDistanceData.bearing[1]*(p*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Qn.parse(n)),s}}class Br{constructor(n,s,u,p){this.name=n,this.type=s,this._evaluate=u,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const u=n[0],p=Br.definitions[u];if(!p)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,A=x.filter(([D])=>!Array.isArray(D)||D.length===n.length-1);let T=null;for(const[D,k]of A){T=new ya(s.registry,s.path,null,s.scope);const z=[];let N=!1;for(let H=1;H<n.length;H++){const K=n[H],te=Array.isArray(D)?D[H-1]:D.type,ae=T.parse(K,1+z.length,te);if(!ae){N=!0;break}z.push(ae)}if(!N)if(Array.isArray(D)&&D.length!==z.length)T.error(`Expected ${D.length} arguments, but found ${z.length} instead.`);else{for(let H=0;H<z.length;H++){const K=Array.isArray(D)?D[H]:D.type,te=z[H];T.concat(H+1).checkSubtype(K,te.type)}if(T.errors.length===0)return new Br(u,g,k,z)}}if(A.length===1)s.errors.push(...T.errors);else{const D=(A.length?A:x).map(([z])=>{return N=z,Array.isArray(N)?`(${N.map(di).join(", ")})`:`(${di(N.type)}...)`;var N}).join(" | "),k=[];for(let z=1;z<n.length;z++){const N=s.parse(n[z],1+k.length);if(!N)return null;k.push(di(N.type))}s.error(`Expected arguments of type ${D}, but found (${k.join(", ")}) instead.`)}return null}static register(n,s){Br.definitions=s;for(const u in s)n[u]=Br}}class Cu{constructor(n,s,u){this.type=xi,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const p=s.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Jt);if(!p)return null;const g=s.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Jt);if(!g)return null;let x=null;return u.locale&&(x=s.parse(u.locale,1,dn),!x)?null:new Cu(p,g,x)}evaluate(n){return new Bs(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}const ga=8192;function jd(a,n){a[0]=Math.min(a[0],n[0]),a[1]=Math.min(a[1],n[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])}function Ru(a,n){return!(a[0]<=n[0]||a[2]>=n[2]||a[1]<=n[1]||a[3]>=n[3])}function $m(a,n){const s=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(s*p*ga),Math.round(u*p*ga)]}function Du(a,n,s){const u=a[0]-n[0],p=a[1]-n[1],g=a[0]-s[0],x=a[1]-s[1];return u*x-g*p==0&&u*g<=0&&p*x<=0}function Hd(a,n){let s=!1;for(let x=0,A=n.length;x<A;x++){const T=n[x];for(let D=0,k=T.length;D<k-1;D++){if(Du(a,T[D],T[D+1]))return!1;(p=T[D])[1]>(u=a)[1]!=(g=T[D+1])[1]>u[1]&&u[0]<(g[0]-p[0])*(u[1]-p[1])/(g[1]-p[1])+p[0]&&(s=!s)}}var u,p,g;return s}function Bx(a,n){for(let s=0;s<n.length;s++)if(Hd(a,n[s]))return!0;return!1}function eg(a,n,s,u){const p=u[0]-s[0],g=u[1]-s[1],x=(a[0]-s[0])*g-p*(a[1]-s[1]),A=(n[0]-s[0])*g-p*(n[1]-s[1]);return x>0&&A<0||x<0&&A>0}function zx(a,n,s){for(const D of s)for(let k=0;k<D.length-1;++k)if((A=[(x=D[k+1])[0]-(g=D[k])[0],x[1]-g[1]])[0]*(T=[(p=n)[0]-(u=a)[0],p[1]-u[1]])[1]-A[1]*T[0]!=0&&eg(u,p,g,x)&&eg(g,x,u,p))return!0;var u,p,g,x,A,T;return!1}function tg(a,n){for(let s=0;s<a.length;++s)if(!Hd(a[s],n))return!1;for(let s=0;s<a.length-1;++s)if(zx(a[s],a[s+1],n))return!1;return!0}function Ux(a,n){for(let s=0;s<n.length;s++)if(tg(a,n[s]))return!0;return!1}function Iu(a,n,s){const u=[];for(let p=0;p<a.length;p++){const g=[];for(let x=0;x<a[p].length;x++){const A=$m(a[p][x],s);jd(n,A),g.push(A)}u.push(g)}return u}function Bl(a,n,s){const u=[];for(let p=0;p<a.length;p++){const g=Iu(a[p],n,s);u.push(g)}return u}function ng(a,n,s,u){if(a[0]<s[0]||a[0]>s[2]){const p=.5*u;let g=a[0]-s[0]>p?-u:s[0]-a[0]>p?u:0;g===0&&(g=a[0]-s[2]>p?-u:s[2]-a[0]>p?u:0),a[0]+=g}jd(n,a)}function ig(a,n,s,u){const p=Math.pow(2,u.z)*ga,g=[u.x*ga,u.y*ga],x=[];if(!a)return x;for(const A of a)for(const T of A){const D=[T.x+g[0],T.y+g[1]];ng(D,n,s,p),x.push(D)}return x}function rg(a,n,s,u){const p=Math.pow(2,u.z)*ga,g=[u.x*ga,u.y*ga],x=[];if(!a)return x;for(const T of a){const D=[];for(const k of T){const z=[k.x+g[0],k.y+g[1]];jd(n,z),D.push(z)}x.push(D)}if(n[2]-n[0]<=p/2){(A=n)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const T of x)for(const D of T)ng(D,n,s,p)}var A;return x}class Ja{constructor(n,s){this.type=Jt,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Pu(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){const g=u.features[p].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ja(u,u.features[p].geometry)}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ja(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Ja(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(!x)return!1;if(u.type==="Polygon"){const A=Iu(u.coordinates,g,x),T=ig(s.geometry(),p,g,x);if(!Ru(p,g))return!1;for(const D of T)if(!Hd(D,A))return!1}if(u.type==="MultiPolygon"){const A=Bl(u.coordinates,g,x),T=ig(s.geometry(),p,g,x);if(!Ru(p,g))return!1;for(const D of T)if(!Bx(D,A))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(!x)return!1;if(u.type==="Polygon"){const A=Iu(u.coordinates,g,x),T=rg(s.geometry(),p,g,x);if(!Ru(p,g))return!1;for(const D of T)if(!tg(D,A))return!1}if(u.type==="MultiPolygon"){const A=Bl(u.coordinates,g,x),T=rg(s.geometry(),p,g,x);if(!Ru(p,g))return!1;for(const D of T)if(!Ux(D,A))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Mr(a){if(a instanceof Br&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Ja)return!1;let n=!0;return a.eachChild(s=>{n&&!Mr(s)&&(n=!1)}),n}function zl(a){if(a instanceof Br&&a.name==="feature-state")return!1;let n=!0;return a.eachChild(s=>{n&&!zl(s)&&(n=!1)}),n}function Ul(a,n){if(a instanceof Br&&n.indexOf(a.name)>=0)return!1;let s=!0;return a.eachChild(u=>{s&&!Ul(u,n)&&(s=!1)}),s}class Qa{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=n[1];return s.scope.has(u)?new Qa(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class ya{constructor(n,s=[],u,p=new Fn,g=[]){this.registry=n,this.path=s,this.key=s.map(x=>`[${x}]`).join(""),this.scope=p,this.errors=g,this.expectedType=u}parse(n,s,u,p,g={}){return s?this.concat(s,u,p)._parse(n,g):this._parse(n,g)}_parse(n,s){function u(p,g,x){return x==="assert"?new vo(g,[p]):x==="coerce"?new _o(g,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[p];if(g){let x=g.parse(n,this);if(!x)return null;if(this.expectedType){const A=this.expectedType,T=x.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||T.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(A,T))return null}else x=u(x,A,s.typeAnnotation||"coerce");else x=u(x,A,s.typeAnnotation||"assert")}if(!(x instanceof qo)&&x.type.kind!=="resolvedImage"&&Lu(x)){const A=new Qm;try{x=new qo(x.type,x.evaluate(A))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,u){const p=typeof n=="number"?this.path.concat(n):this.path,g=u?this.scope.concat(u):this.scope;return new ya(this.registry,p,s||null,g,this.errors)}error(n,...s){const u=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new rn(u,n))}checkSubtype(n,s){const u=Ho(n,s);return u&&this.error(u),u}}function Lu(a){if(a instanceof Qa)return Lu(a.boundExpression);if(a instanceof Br&&a.name==="error"||a instanceof Cu||a instanceof Ja)return!1;const n=a instanceof _o||a instanceof vo;let s=!0;return a.eachChild(u=>{s=n?s&&Lu(u):s&&u instanceof qo}),!!s&&Mr(a)&&Ul(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Nl(a,n){const s=a.length-1;let u,p,g=0,x=s,A=0;for(;g<=x;)if(A=Math.floor((g+x)/2),u=a[A],p=a[A+1],u<=n){if(A===s||n<p)return A;g=A+1}else{if(!(u>n))throw new ar("Input is not a number.");x=A-1}return 0}class Vl{constructor(n,s,u){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[p,g]of u)this.labels.push(p),this.outputs.push(g)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(n[1],1,bt);if(!u)return null;const p=[];let g=null;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);for(let x=1;x<n.length;x+=2){const A=x===1?-1/0:n[x],T=n[x+1],D=x,k=x+1;if(typeof A!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(p.length&&p[p.length-1][0]>=A)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const z=s.parse(T,k,g);if(!z)return null;g=g||z.type,p.push([A,z])}return new Vl(g,u,p)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return u[0].evaluate(n);const g=s.length;return p>=s[g-1]?u[g-1].evaluate(n):u[Nl(s,p)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}function yn(a,n,s){return a*(1-s)+n*s}var Fu=Object.freeze({__proto__:null,number:yn,color:function(a,n,s){return new Qn(yn(a.r,n.r,s),yn(a.g,n.g,s),yn(a.b,n.b,s),yn(a.a,n.a,s))},array:function(a,n,s){return a.map((u,p)=>yn(u,n[p],s))}});const og=.95047,ag=1.08883,Wd=4/29,qd=6/29,Yd=3*qd*qd,sg=Math.PI/180,lg=180/Math.PI;function ku(a){return a>.008856451679035631?Math.pow(a,1/3):a/Yd+Wd}function xa(a){return a>qd?a*a*a:Yd*(a-Wd)}function Ns(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Xd(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Bu(a){const n=Xd(a.r),s=Xd(a.g),u=Xd(a.b),p=ku((.4124564*n+.3575761*s+.1804375*u)/og),g=ku((.2126729*n+.7151522*s+.072175*u)/1);return{l:116*g-16,a:500*(p-g),b:200*(g-ku((.0193339*n+.119192*s+.9503041*u)/ag)),alpha:a.a}}function Kd(a){let n=(a.l+16)/116,s=isNaN(a.a)?n:n+a.a/500,u=isNaN(a.b)?n:n-a.b/200;return n=1*xa(n),s=og*xa(s),u=ag*xa(u),new Qn(Ns(3.2404542*s-1.5371385*n-.4985314*u),Ns(-.969266*s+1.8760108*n+.041556*u),Ns(.0556434*s-.2040259*n+1.0572252*u),a.alpha)}function Nx(a,n,s){const u=n-a;return a+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const Ol={forward:Bu,reverse:Kd,interpolate:function(a,n,s){return{l:yn(a.l,n.l,s),a:yn(a.a,n.a,s),b:yn(a.b,n.b,s),alpha:yn(a.alpha,n.alpha,s)}}},Gl={forward:function(a){const{l:n,a:s,b:u}=Bu(a),p=Math.atan2(u,s)*lg;return{h:p<0?p+360:p,c:Math.sqrt(s*s+u*u),l:n,alpha:a.a}},reverse:function(a){const n=a.h*sg,s=a.c;return Kd({l:a.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:a.alpha})},interpolate:function(a,n,s){return{h:Nx(a.h,n.h,s),c:yn(a.c,n.c,s),l:yn(a.l,n.l,s),alpha:yn(a.alpha,n.alpha,s)}}};var Zd=Object.freeze({__proto__:null,lab:Ol,hcl:Gl});class zr{constructor(n,s,u,p,g){this.type=n,this.operator=s,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[x,A]of g)this.labels.push(x),this.outputs.push(A)}static interpolationFactor(n,s,u,p){let g=0;if(n.name==="exponential")g=zu(s,n.base,u,p);else if(n.name==="linear")g=zu(s,1,u,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;g=new _(x[0],x[1],x[2],x[3]).solve(zu(s,1,u,p))}return g}static parse(n,s){let[u,p,g,...x]=n;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const D=p[1];if(typeof D!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:D}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const D=p.slice(1);if(D.length!==4||D.some(k=>typeof k!="number"||k<0||k>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:D}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(g=s.parse(g,2,bt),!g)return null;const A=[];let T=null;u==="interpolate-hcl"||u==="interpolate-lab"?T=mn:s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType);for(let D=0;D<x.length;D+=2){const k=x[D],z=x[D+1],N=D+3,H=D+4;if(typeof k!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(A.length&&A[A.length-1][0]>=k)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);const K=s.parse(z,H,T);if(!K)return null;T=T||K.type,A.push([k,K])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new zr(T,u,p,g,A):s.error(`Type ${di(T)} is not interpolatable.`)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return u[0].evaluate(n);const g=s.length;if(p>=s[g-1])return u[g-1].evaluate(n);const x=Nl(s,p),A=zr.interpolationFactor(this.interpolation,p,s[x],s[x+1]),T=u[x].evaluate(n),D=u[x+1].evaluate(n);return this.operator==="interpolate"?Fu[this.type.kind.toLowerCase()](T,D,A):this.operator==="interpolate-hcl"?Gl.reverse(Gl.interpolate(Gl.forward(T),Gl.forward(D),A)):Ol.reverse(Ol.interpolate(Ol.forward(T),Ol.forward(D),A))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function zu(a,n,s,u){const p=u-s,g=a-s;return p===0?0:n===1?g/p:(Math.pow(n,g)-1)/(Math.pow(n,p)-1)}class jl{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let u=null;const p=s.expectedType;p&&p.kind!=="value"&&(u=p);const g=[];for(const A of n.slice(1)){const T=s.parse(A,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,g.push(T)}const x=p&&g.some(A=>Ho(p,A.type));return new jl(x?Rn:u,g)}evaluate(n){let s,u=null,p=0;for(const g of this.args){if(p++,u=g.evaluate(n),u&&u instanceof kr&&!u.available&&(s||(s=u),u=null,p===this.args.length))return s;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class Hl{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let g=1;g<n.length-1;g+=2){const x=n[g];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,g);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",g);const A=s.parse(n[g+1],g+1);if(!A)return null;u.push([x,A])}const p=s.parse(n[n.length-1],n.length-1,s.expectedType,u);return p?new Hl(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,u]of this.bindings)n.push(s,u.serialize());return n.push(this.result.serialize()),n}}class Jd{constructor(n,s,u){this.type=n,this.index=s,this.input=u}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,bt),p=s.parse(n[2],2,fi(s.expectedType||Rn));return u&&p?new Jd(p.type.itemType,u,p):null}evaluate(n){const s=this.index.evaluate(n),u=this.input.evaluate(n);if(s<0)throw new ar(`Array index out of bounds: ${s} < 0.`);if(s>=u.length)throw new ar(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s!==Math.floor(s))throw new ar(`Array index must be an integer, but found ${s} instead.`);return u[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Uu{constructor(n,s){this.type=Jt,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Rn),p=s.parse(n[2],2,Rn);return u&&p?Tu(u.type,[Jt,dn,bt,kn,Rn])?new Uu(u,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${di(u.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!ks(s,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${di(Bi(s))} instead.`);if(!ks(u,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${di(Bi(u))} instead.`);return u.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Nu{constructor(n,s,u){this.type=bt,this.needle=n,this.haystack=s,this.fromIndex=u}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Rn),p=s.parse(n[2],2,Rn);if(!u||!p)return null;if(!Tu(u.type,[Jt,dn,bt,kn,Rn]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${di(u.type)} instead`);if(n.length===4){const g=s.parse(n[3],3,bt);return g?new Nu(u,p,g):null}return new Nu(u,p)}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!ks(s,["boolean","string","number","null"]))throw new ar(`Expected first argument to be of type boolean, string, number or null, but found ${di(Bi(s))} instead.`);if(!ks(u,["string","array"]))throw new ar(`Expected second argument to be of type array or string, but found ${di(Bi(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(n);return u.indexOf(s,p)}return u.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Vu{constructor(n,s,u,p,g,x){this.inputType=n,this.type=s,this.input=u,this.cases=p,this.outputs=g,this.otherwise=x}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let u,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const g={},x=[];for(let D=2;D<n.length-1;D+=2){let k=n[D];const z=n[D+1];Array.isArray(k)||(k=[k]);const N=s.concat(D);if(k.length===0)return N.error("Expected at least one branch label.");for(const K of k){if(typeof K!="number"&&typeof K!="string")return N.error("Branch labels must be numbers or strings.");if(typeof K=="number"&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof K=="number"&&Math.floor(K)!==K)return N.error("Numeric branch labels must be integer values.");if(u){if(N.checkSubtype(u,Bi(K)))return null}else u=Bi(K);if(g[String(K)]!==void 0)return N.error("Branch labels must be unique.");g[String(K)]=x.length}const H=s.parse(z,D,p);if(!H)return null;p=p||H.type,x.push(H)}const A=s.parse(n[1],1,Rn);if(!A)return null;const T=s.parse(n[n.length-1],n.length-1,p);return T?A.type.kind!=="value"&&s.concat(1).checkSubtype(u,A.type)?null:new Vu(u,p,A,g,x,T):null}evaluate(n){const s=this.input.evaluate(n);return(Bi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],p={};for(const x of s){const A=p[this.cases[x]];A===void 0?(p[this.cases[x]]=u.length,u.push([this.cases[x],[x]])):u[A][1].push(x)}const g=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,A]of u)n.push(A.length===1?g(A[0]):A.map(g)),n.push(this.outputs[x].serialize());return n.push(this.otherwise.serialize()),n}}class Ou{constructor(n,s,u){this.type=n,this.branches=s,this.otherwise=u}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const A=s.parse(n[x],x,Jt);if(!A)return null;const T=s.parse(n[x+1],x+1,u);if(!T)return null;p.push([A,T]),u=u||T.type}const g=s.parse(n[n.length-1],n.length-1,u);return g?new Ou(u,p,g):null}evaluate(n){for(const[s,u]of this.branches)if(s.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,u]of this.branches)n(s),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class Gu{constructor(n,s,u,p){this.type=n,this.input=s,this.beginIndex=u,this.endIndex=p}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Rn),p=s.parse(n[2],2,bt);if(!u||!p)return null;if(!Tu(u.type,[fi(Rn),dn,Rn]))return s.error(`Expected first argument to be of type array or string, but found ${di(u.type)} instead`);if(n.length===4){const g=s.parse(n[3],3,bt);return g?new Gu(u.type,u,p,g):null}return new Gu(u.type,u,p)}evaluate(n){const s=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!ks(s,["string","array"]))throw new ar(`Expected first argument to be of type array or string, but found ${di(Bi(s))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(n);return s.slice(u,p)}return s.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function cg(a,n){return a==="=="||a==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function ug(a,n,s,u){return u.compare(n,s)===0}function Vs(a,n,s){const u=a!=="=="&&a!=="!=";return class l2{constructor(g,x,A){this.type=Jt,this.lhs=g,this.rhs=x,this.collator=A,this.hasUntypedArgument=g.type.kind==="value"||x.type.kind==="value"}static parse(g,x){if(g.length!==3&&g.length!==4)return x.error("Expected two or three arguments.");const A=g[0];let T=x.parse(g[1],1,Rn);if(!T)return null;if(!cg(A,T.type))return x.concat(1).error(`"${A}" comparisons are not supported for type '${di(T.type)}'.`);let D=x.parse(g[2],2,Rn);if(!D)return null;if(!cg(A,D.type))return x.concat(2).error(`"${A}" comparisons are not supported for type '${di(D.type)}'.`);if(T.type.kind!==D.type.kind&&T.type.kind!=="value"&&D.type.kind!=="value")return x.error(`Cannot compare types '${di(T.type)}' and '${di(D.type)}'.`);u&&(T.type.kind==="value"&&D.type.kind!=="value"?T=new vo(D.type,[T]):T.type.kind!=="value"&&D.type.kind==="value"&&(D=new vo(T.type,[D])));let k=null;if(g.length===4){if(T.type.kind!=="string"&&D.type.kind!=="string"&&T.type.kind!=="value"&&D.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(k=x.parse(g[3],3,xi),!k)return null}return new l2(T,D,k)}evaluate(g){const x=this.lhs.evaluate(g),A=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const T=Bi(x),D=Bi(A);if(T.kind!==D.kind||T.kind!=="string"&&T.kind!=="number")throw new ar(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${D.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=Bi(x),D=Bi(A);if(T.kind!=="string"||D.kind!=="string")return n(g,x,A)}return this.collator?s(g,x,A,this.collator.evaluate(g)):n(g,x,A)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[a];return this.eachChild(x=>{g.push(x.serialize())}),g}}}const Vx=Vs("==",function(a,n,s){return n===s},ug),Ox=Vs("!=",function(a,n,s){return n!==s},function(a,n,s,u){return!ug(0,n,s,u)}),hg=Vs("<",function(a,n,s){return n<s},function(a,n,s,u){return u.compare(n,s)<0}),Gx=Vs(">",function(a,n,s){return n>s},function(a,n,s,u){return u.compare(n,s)>0}),jx=Vs("<=",function(a,n,s){return n<=s},function(a,n,s,u){return u.compare(n,s)<=0}),Hx=Vs(">=",function(a,n,s){return n>=s},function(a,n,s,u){return u.compare(n,s)>=0});class Qd{constructor(n,s,u,p,g){this.type=dn,this.number=n,this.locale=s,this.currency=u,this.minFractionDigits=p,this.maxFractionDigits=g}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const u=s.parse(n[1],1,bt);if(!u)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let g=null;if(p.locale&&(g=s.parse(p.locale,1,dn),!g))return null;let x=null;if(p.currency&&(x=s.parse(p.currency,1,dn),!x))return null;let A=null;if(p["min-fraction-digits"]&&(A=s.parse(p["min-fraction-digits"],1,bt),!A))return null;let T=null;return p["max-fraction-digits"]&&(T=s.parse(p["max-fraction-digits"],1,bt),!T)?null:new Qd(u,g,x,A,T)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class ju{constructor(n){this.type=bt,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=s.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${di(u.type)} instead.`):new ju(u):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new ar(`Expected value to be of type string or array, but found ${di(Bi(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}const $a={"==":Vx,"!=":Ox,">":Gx,"<":hg,">=":Hx,"<=":jx,array:vo,at:Jd,boolean:vo,case:Ou,coalesce:jl,collator:Cu,format:zs,image:Us,in:Uu,"index-of":Nu,interpolate:zr,"interpolate-hcl":zr,"interpolate-lab":zr,length:ju,let:Hl,literal:qo,match:Vu,number:vo,"number-format":Qd,object:vo,slice:Gu,step:Vl,string:vo,"to-boolean":_o,"to-color":_o,"to-number":_o,"to-string":_o,var:Qa,within:Ja};function $d(a,[n,s,u,p]){n=n.evaluate(a),s=s.evaluate(a),u=u.evaluate(a);const g=p?p.evaluate(a):1,x=xo(n,s,u,g);if(x)throw new ar(x);return new Qn(n/255*g,s/255*g,u/255*g,g)}function dg(a,n){return a in n}function ep(a,n){const s=n[a];return s===void 0?null:s}function va(a){return{type:a}}function tp(a){return{result:"success",value:a}}function es(a){return{result:"error",value:a}}function Os(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function pg(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function np(a){return!!a.expression&&a.expression.interpolated}function ri(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ts(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function fg(a){return a}function ip(a,n){const s=n.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",p=u||!(u||a.property!==void 0),g=a.type||(np(n)?"exponential":"interval");if(s&&((a=At({},a)).stops&&(a.stops=a.stops.map(D=>[D[0],Qn.parse(D[1])])),a.default=Qn.parse(a.default?a.default:n.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!Zd[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let x,A,T;if(g==="exponential")x=rp;else if(g==="interval")x=qx;else if(g==="categorical"){x=Wx,A=Object.create(null);for(const D of a.stops)A[D[0]]=D[1];T=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);x=mg}if(u){const D={},k=[];for(let H=0;H<a.stops.length;H++){const K=a.stops[H],te=K[0].zoom;D[te]===void 0&&(D[te]={zoom:te,type:a.type,property:a.property,default:a.default,stops:[]},k.push(te)),D[te].stops.push([K[0].value,K[1]])}const z=[];for(const H of k)z.push([D[H].zoom,ip(D[H],n)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:zr.interpolationFactor.bind(void 0,N),zoomStops:z.map(H=>H[0]),evaluate:({zoom:H},K)=>rp({stops:z,base:a.base},n,H).evaluate(H,K)}}if(p){const D=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:zr.interpolationFactor.bind(void 0,D),zoomStops:a.stops.map(k=>k[0]),evaluate:({zoom:k})=>x(a,n,k,A,T)}}return{kind:"source",evaluate(D,k){const z=k&&k.properties?k.properties[a.property]:void 0;return z===void 0?Wl(a.default,n.default):x(a,n,z,A,T)}}}function Wl(a,n,s){return a!==void 0?a:n!==void 0?n:s!==void 0?s:void 0}function Wx(a,n,s,u,p){return Wl(typeof s===p?u[s]:void 0,a.default,n.default)}function qx(a,n,s){if(ri(s)!=="number")return Wl(a.default,n.default);const u=a.stops.length;if(u===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[u-1][0])return a.stops[u-1][1];const p=Nl(a.stops.map(g=>g[0]),s);return a.stops[p][1]}function rp(a,n,s){const u=a.base!==void 0?a.base:1;if(ri(s)!=="number")return Wl(a.default,n.default);const p=a.stops.length;if(p===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[p-1][0])return a.stops[p-1][1];const g=Nl(a.stops.map(k=>k[0]),s),x=function(k,z,N,H){const K=H-N,te=k-N;return K===0?0:z===1?te/K:(Math.pow(z,te)-1)/(Math.pow(z,K)-1)}(s,u,a.stops[g][0],a.stops[g+1][0]),A=a.stops[g][1],T=a.stops[g+1][1];let D=Fu[n.type]||fg;if(a.colorSpace&&a.colorSpace!=="rgb"){const k=Zd[a.colorSpace];D=(z,N)=>k.reverse(k.interpolate(k.forward(z),k.forward(N),x))}return typeof A.evaluate=="function"?{evaluate(...k){const z=A.evaluate.apply(void 0,k),N=T.evaluate.apply(void 0,k);if(z!==void 0&&N!==void 0)return D(z,N,x)}}:D(A,T,x)}function mg(a,n,s){return n.type==="color"?s=Qn.parse(s):n.type==="formatted"?s=ji.fromString(s.toString()):n.type==="resolvedImage"?s=kr.fromString(s.toString()):ri(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Wl(s,a.default,n.default)}Br.register($a,{error:[{kind:"error"},[dn],(a,[n])=>{throw new ar(n.evaluate(a))}],typeof:[dn,[Rn],(a,[n])=>di(Bi(n.evaluate(a)))],"to-rgba":[fi(bt,4),[mn],(a,[n])=>n.evaluate(a).toArray()],rgb:[mn,[bt,bt,bt],$d],rgba:[mn,[bt,bt,bt,bt],$d],has:{type:Jt,overloads:[[[dn],(a,[n])=>dg(n.evaluate(a),a.properties())],[[dn,En],(a,[n,s])=>dg(n.evaluate(a),s.evaluate(a))]]},get:{type:Rn,overloads:[[[dn],(a,[n])=>ep(n.evaluate(a),a.properties())],[[dn,En],(a,[n,s])=>ep(n.evaluate(a),s.evaluate(a))]]},"feature-state":[Rn,[dn],(a,[n])=>ep(n.evaluate(a),a.featureState||{})],properties:[En,[],a=>a.properties()],"geometry-type":[dn,[],a=>a.geometryType()],id:[Rn,[],a=>a.id()],zoom:[bt,[],a=>a.globals.zoom],pitch:[bt,[],a=>a.globals.pitch||0],"distance-from-center":[bt,[],a=>a.distanceFromCenter()],"heatmap-density":[bt,[],a=>a.globals.heatmapDensity||0],"line-progress":[bt,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[bt,[],a=>a.globals.skyRadialProgress||0],accumulated:[Rn,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[bt,va(bt),(a,n)=>{let s=0;for(const u of n)s+=u.evaluate(a);return s}],"*":[bt,va(bt),(a,n)=>{let s=1;for(const u of n)s*=u.evaluate(a);return s}],"-":{type:bt,overloads:[[[bt,bt],(a,[n,s])=>n.evaluate(a)-s.evaluate(a)],[[bt],(a,[n])=>-n.evaluate(a)]]},"/":[bt,[bt,bt],(a,[n,s])=>n.evaluate(a)/s.evaluate(a)],"%":[bt,[bt,bt],(a,[n,s])=>n.evaluate(a)%s.evaluate(a)],ln2:[bt,[],()=>Math.LN2],pi:[bt,[],()=>Math.PI],e:[bt,[],()=>Math.E],"^":[bt,[bt,bt],(a,[n,s])=>Math.pow(n.evaluate(a),s.evaluate(a))],sqrt:[bt,[bt],(a,[n])=>Math.sqrt(n.evaluate(a))],log10:[bt,[bt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN10],ln:[bt,[bt],(a,[n])=>Math.log(n.evaluate(a))],log2:[bt,[bt],(a,[n])=>Math.log(n.evaluate(a))/Math.LN2],sin:[bt,[bt],(a,[n])=>Math.sin(n.evaluate(a))],cos:[bt,[bt],(a,[n])=>Math.cos(n.evaluate(a))],tan:[bt,[bt],(a,[n])=>Math.tan(n.evaluate(a))],asin:[bt,[bt],(a,[n])=>Math.asin(n.evaluate(a))],acos:[bt,[bt],(a,[n])=>Math.acos(n.evaluate(a))],atan:[bt,[bt],(a,[n])=>Math.atan(n.evaluate(a))],min:[bt,va(bt),(a,n)=>Math.min(...n.map(s=>s.evaluate(a)))],max:[bt,va(bt),(a,n)=>Math.max(...n.map(s=>s.evaluate(a)))],abs:[bt,[bt],(a,[n])=>Math.abs(n.evaluate(a))],round:[bt,[bt],(a,[n])=>{const s=n.evaluate(a);return s<0?-Math.round(-s):Math.round(s)}],floor:[bt,[bt],(a,[n])=>Math.floor(n.evaluate(a))],ceil:[bt,[bt],(a,[n])=>Math.ceil(n.evaluate(a))],"filter-==":[Jt,[dn,Rn],(a,[n,s])=>a.properties()[n.value]===s.value],"filter-id-==":[Jt,[Rn],(a,[n])=>a.id()===n.value],"filter-type-==":[Jt,[dn],(a,[n])=>a.geometryType()===n.value],"filter-<":[Jt,[dn,Rn],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u<p}],"filter-id-<":[Jt,[Rn],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s<u}],"filter->":[Jt,[dn,Rn],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u>p}],"filter-id->":[Jt,[Rn],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s>u}],"filter-<=":[Jt,[dn,Rn],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[Jt,[Rn],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s<=u}],"filter->=":[Jt,[dn,Rn],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[Jt,[Rn],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s>=u}],"filter-has":[Jt,[Rn],(a,[n])=>n.value in a.properties()],"filter-has-id":[Jt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Jt,[fi(dn)],(a,[n])=>n.value.indexOf(a.geometryType())>=0],"filter-id-in":[Jt,[fi(Rn)],(a,[n])=>n.value.indexOf(a.id())>=0],"filter-in-small":[Jt,[dn,fi(Rn)],(a,[n,s])=>s.value.indexOf(a.properties()[n.value])>=0],"filter-in-large":[Jt,[dn,fi(Rn)],(a,[n,s])=>function(u,p,g,x){for(;g<=x;){const A=g+x>>1;if(p[A]===u)return!0;p[A]>u?x=A-1:g=A+1}return!1}(a.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Jt,overloads:[[[Jt,Jt],(a,[n,s])=>n.evaluate(a)&&s.evaluate(a)],[va(Jt),(a,n)=>{for(const s of n)if(!s.evaluate(a))return!1;return!0}]]},any:{type:Jt,overloads:[[[Jt,Jt],(a,[n,s])=>n.evaluate(a)||s.evaluate(a)],[va(Jt),(a,n)=>{for(const s of n)if(s.evaluate(a))return!0;return!1}]]},"!":[Jt,[Jt],(a,[n])=>!n.evaluate(a)],"is-supported-script":[Jt,[dn],(a,[n])=>{const s=a.globals&&a.globals.isSupportedScript;return!s||s(n.evaluate(a))}],upcase:[dn,[dn],(a,[n])=>n.evaluate(a).toUpperCase()],downcase:[dn,[dn],(a,[n])=>n.evaluate(a).toLowerCase()],concat:[dn,va(Rn),(a,n)=>n.map(s=>Wo(s.evaluate(a))).join("")],"resolved-locale":[dn,[xi],(a,[n])=>n.evaluate(a).resolvedLocale()]});class Hu{constructor(n,s){this.expression=n,this._warningHistory={},this._evaluator=new Qm,this._defaultValue=s?function(u){return u.type==="color"&&ts(u.default)?new Qn(0,0,0,0):u.type==="color"?Qn.parse(u.default)||null:u.default===void 0?null:u.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,u,p,g,x,A,T){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=A||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,u,p,g,x,A,T){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=A||null,this._evaluator.featureDistanceData=T||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new ar(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console!="undefined"&&console.warn(D.message)),this._defaultValue}}}function Gs(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in $a}function ql(a,n){const s=new ya($a,[],n?function(p){const g={color:mn,string:dn,number:bt,enum:dn,boolean:Jt,formatted:Fr,resolvedImage:hi};return p.type==="array"?fi(g[p.value]||Rn,p.length):g[p.type]}(n):void 0),u=s.parse(a,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?tp(new Hu(u,n)):es(s.errors)}class op{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!zl(s.expression)}evaluateWithoutErrorHandling(n,s,u,p,g,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,p,g,x)}evaluate(n,s,u,p,g,x){return this._styleExpression.evaluate(n,s,u,p,g,x)}}class ap{constructor(n,s,u,p){this.kind=n,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!zl(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,s,u,p,g,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,p,g,x)}evaluate(n,s,u,p,g,x){return this._styleExpression.evaluate(n,s,u,p,g,x)}interpolationFactor(n,s,u){return this.interpolationType?zr.interpolationFactor(this.interpolationType,n,s,u):0}}function gg(a,n){if((a=ql(a,n)).result==="error")return a;const s=a.value.expression,u=Mr(s);if(!u&&!Os(n))return es([new rn("","data expressions not supported")]);const p=Ul(s,["zoom","pitch","distance-from-center"]);if(!p&&!pg(n))return es([new rn("","zoom expressions not supported")]);const g=qu(s);return g||p?g instanceof rn?es([g]):g instanceof zr&&!np(n)?es([new rn("",'"interpolate" expressions cannot be used with this property')]):tp(g?new ap(u?"camera":"composite",a.value,g.labels,g instanceof zr?g.interpolation:void 0):new op(u?"constant":"source",a.value)):es([new rn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wu{constructor(n,s){this._parameters=n,this._specification=s,At(this,ip(this._parameters,this._specification))}static deserialize(n){return new Wu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function qu(a){let n=null;if(a instanceof Hl)n=qu(a.result);else if(a instanceof jl){for(const s of a.args)if(n=qu(s),n)break}else(a instanceof Vl||a instanceof zr)&&a.input instanceof Br&&a.input.name==="zoom"&&(n=a);return n instanceof rn||a.eachChild(s=>{const u=qu(s);u instanceof rn?n=u:!n&&u?n=new rn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&u&&n!==u&&(n=new rn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}class Ht{constructor(n,s,u,p){this.message=(n?`${n}: `:"")+u,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function Qr(a){const n=a.key,s=a.value,u=a.valueSpec||{},p=a.objectElementValidators||{},g=a.style,x=a.styleSpec;let A=[];const T=ri(s);if(T!=="object")return[new Ht(n,s,`object expected, ${T} found`)];for(const D in s){const k=D.split(".")[0],z=u[k]||u["*"];let N;p[k]?N=p[k]:u[k]?N=Qi:p["*"]?N=p["*"]:u["*"]&&(N=Qi),N?A=A.concat(N({key:(n&&`${n}.`)+D,value:s[D],valueSpec:z,style:g,styleSpec:x,object:s,objectKey:D},s)):A.push(new Ht(n,s[D],`unknown property "${D}"`))}for(const D in u)p[D]||u[D].required&&u[D].default===void 0&&s[D]===void 0&&A.push(new Ht(n,s,`missing required property "${D}"`));return A}function Yl(a){const n=a.value,s=a.valueSpec,u=a.style,p=a.styleSpec,g=a.key,x=a.arrayElementValidator||Qi;if(ri(n)!=="array")return[new Ht(g,n,`array expected, ${ri(n)} found`)];if(s.length&&n.length!==s.length)return[new Ht(g,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new Ht(g,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let A={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};p.$version<7&&(A.function=s.function),ri(s.value)==="object"&&(A=s.value);let T=[];for(let D=0;D<n.length;D++)T=T.concat(x({array:n,arrayIndex:D,value:n[D],valueSpec:A,style:u,styleSpec:p,key:`${g}[${D}]`}));return T}function yg(a){const n=a.key,s=a.value,u=a.valueSpec;let p=ri(s);if(p==="number"&&s!=s&&(p="NaN"),p!=="number")return[new Ht(n,s,`number expected, ${p} found`)];if("minimum"in u){let g=u.minimum;if(ri(u.minimum)==="array"&&(g=u.minimum[a.arrayIndex]),s<g)return[new Ht(n,s,`${s} is less than the minimum value ${g}`)]}if("maximum"in u){let g=u.maximum;if(ri(u.maximum)==="array"&&(g=u.maximum[a.arrayIndex]),s>g)return[new Ht(n,s,`${s} is greater than the maximum value ${g}`)]}return[]}function xg(a){const n=a.valueSpec,s=yt(a.value.type);let u,p,g,x={};const A=s!=="categorical"&&a.value.property===void 0,T=!A,D=ri(a.value.stops)==="array"&&ri(a.value.stops[0])==="array"&&ri(a.value.stops[0][0])==="object",k=Qr({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(H){if(s==="identity")return[new Ht(H.key,H.value,'identity function may not have a "stops" property')];let K=[];const te=H.value;return K=K.concat(Yl({key:H.key,value:te,valueSpec:H.valueSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:z})),ri(te)==="array"&&te.length===0&&K.push(new Ht(H.key,te,"array must have at least one stop")),K},default:function(H){return Qi({key:H.key,value:H.value,valueSpec:n,style:H.style,styleSpec:H.styleSpec})}}});return s==="identity"&&A&&k.push(new Ht(a.key,a.value,'missing required property "property"')),s==="identity"||a.value.stops||k.push(new Ht(a.key,a.value,'missing required property "stops"')),s==="exponential"&&a.valueSpec.expression&&!np(a.valueSpec)&&k.push(new Ht(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!Os(a.valueSpec)?k.push(new Ht(a.key,a.value,"property functions not supported")):A&&!pg(a.valueSpec)&&k.push(new Ht(a.key,a.value,"zoom functions not supported"))),s!=="categorical"&&!D||a.value.property!==void 0||k.push(new Ht(a.key,a.value,'"property" property is required')),k;function z(H){let K=[];const te=H.value,ae=H.key;if(ri(te)!=="array")return[new Ht(ae,te,`array expected, ${ri(te)} found`)];if(te.length!==2)return[new Ht(ae,te,`array length 2 expected, length ${te.length} found`)];if(D){if(ri(te[0])!=="object")return[new Ht(ae,te,`object expected, ${ri(te[0])} found`)];if(te[0].zoom===void 0)return[new Ht(ae,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Ht(ae,te,"object stop key must have value")];const he=yt(te[0].zoom);if(typeof he!="number")return[new Ht(ae,te[0].zoom,"stop zoom values must be numbers")];if(g&&g>he)return[new Ht(ae,te[0].zoom,"stop zoom values must appear in ascending order")];he!==g&&(g=he,p=void 0,x={}),K=K.concat(Qr({key:`${ae}[0]`,value:te[0],valueSpec:{zoom:{}},style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:yg,value:N}}))}else K=K.concat(N({key:`${ae}[0]`,value:te[0],valueSpec:{},style:H.style,styleSpec:H.styleSpec},te));return Gs(Nt(te[1]))?K.concat([new Ht(`${ae}[1]`,te[1],"expressions are not allowed in function stops.")]):K.concat(Qi({key:`${ae}[1]`,value:te[1],valueSpec:n,style:H.style,styleSpec:H.styleSpec}))}function N(H,K){const te=ri(H.value),ae=yt(H.value),he=H.value!==null?H.value:K;if(u){if(te!==u)return[new Ht(H.key,he,`${te} stop domain type must match previous stop domain type ${u}`)]}else u=te;if(te!=="number"&&te!=="string"&&te!=="boolean"&&typeof ae!="number"&&typeof ae!="string"&&typeof ae!="boolean")return[new Ht(H.key,he,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&s!=="categorical"){let Pe=`number expected, ${te} found`;return Os(n)&&s===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ht(H.key,he,Pe)]}return s!=="categorical"||te!=="number"||typeof ae=="number"&&isFinite(ae)&&Math.floor(ae)===ae?s!=="categorical"&&te==="number"&&typeof ae=="number"&&typeof p=="number"&&p!==void 0&&ae<p?[new Ht(H.key,he,"stop domain values must appear in ascending order")]:(p=ae,s==="categorical"&&ae in x?[new Ht(H.key,he,"stop domain values must be unique")]:(x[ae]=!0,[])):[new Ht(H.key,he,`integer expected, found ${String(ae)}`)]}}function js(a){const n=(a.expressionContext==="property"?gg:ql)(Nt(a.value),a.valueSpec);if(n.result==="error")return n.value.map(u=>new Ht(`${a.key}${u.key}`,a.value,u.message));const s=n.value.expression||n.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!s.outputDefined())return[new Ht(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!zl(s))return[new Ht(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return Yo(s,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Ul(s,["zoom","feature-state"]))return[new Ht(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Mr(s))return[new Ht(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yo(a,n){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const p of n.valueSpec.expression.parameters)s.delete(p);if(s.size===0)return[];const u=[];return a instanceof Br&&s.has(a.name)?[new Ht(n.key,n.value,`["${a.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(a.eachChild(p=>{u.push(...Yo(p,n))}),u)}function Xl(a){const n=a.key,s=a.value,u=a.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf(yt(s))===-1&&p.push(new Ht(n,s,`expected one of [${u.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(u.values).indexOf(yt(s))===-1&&p.push(new Ht(n,s,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function _a(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const n of a.slice(1))if(!_a(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function ba(a,n="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};_a(a)||(a=Kl(a));const s=a;let u=!0;try{u=function(D){if(!wa(D))return D;let k=Nt(D);return vg(k),k=sp(k),k}(s)}catch(D){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const p=me[`filter_${n}`],g=ql(u,p);let x=null;if(g.result==="error")throw new Error(g.value.map(D=>`${D.key}: ${D.message}`).join(", "));x=(D,k,z)=>g.value.evaluate(D,k,{},z);let A=null,T=null;if(u!==s){const D=ql(s,p);if(D.result==="error")throw new Error(D.value.map(k=>`${k.key}: ${k.message}`).join(", "));A=(k,z,N,H,K)=>D.value.evaluate(k,z,{},N,void 0,void 0,H,K),T=!Mr(D.value.expression)}return x=x,{filter:x,dynamicFilter:A||void 0,needGeometry:Yu(u),needFeature:!!T}}function sp(a){if(!Array.isArray(a))return a;const n=function(s){if(_g.has(s[0])){for(let u=1;u<s.length;u++)if(wa(s[u]))return!0}return s}(a);return n===!0?n:n.map(s=>sp(s))}function vg(a){let n=!1;const s=[];if(a[0]==="case"){for(let u=1;u<a.length-1;u+=2)n=n||wa(a[u]),s.push(a[u+1]);s.push(a[a.length-1])}else if(a[0]==="match"){n=n||wa(a[1]);for(let u=2;u<a.length-1;u+=2)s.push(a[u+1]);s.push(a[a.length-1])}else if(a[0]==="step"){n=n||wa(a[1]);for(let u=1;u<a.length-1;u+=2)s.push(a[u+1])}n&&(a.length=0,a.push("any",...s));for(let u=1;u<a.length;u++)vg(a[u])}function wa(a){if(!Array.isArray(a))return!1;if((n=a[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<a.length;s++)if(wa(a[s]))return!0;return!1}const _g=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function lp(a,n){return a<n?-1:a>n?1:0}function Yu(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let n=1;n<a.length;n++)if(Yu(a[n]))return!0;return!1}function Kl(a){if(!a)return!0;const n=a[0];return a.length<=1?n!=="any":n==="=="?Zl(a[1],a[2],"=="):n==="!="?Jl(Zl(a[1],a[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Zl(a[1],a[2],n):n==="any"?(s=a.slice(1),["any"].concat(s.map(Kl))):n==="all"?["all"].concat(a.slice(1).map(Kl)):n==="none"?["all"].concat(a.slice(1).map(Kl).map(Jl)):n==="in"?cp(a[1],a.slice(2)):n==="!in"?Jl(cp(a[1],a.slice(2))):n==="has"?up(a[1]):n==="!has"?Jl(up(a[1])):n!=="within"||a;var s}function Zl(a,n,s){switch(a){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,a,n]}}function cp(a,n){if(n.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",a,["literal",n.sort(lp)]]:["filter-in-small",a,["literal",n]]}}function up(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Jl(a){return["!",a]}function Aa(a){return _a(Nt(a.value))?js(At({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):hp(a)}function hp(a){const n=a.value,s=a.key;if(ri(n)!=="array")return[new Ht(s,n,`array expected, ${ri(n)} found`)];const u=a.styleSpec;let p,g=[];if(n.length<1)return[new Ht(s,n,"filter array must have at least 1 element")];switch(g=g.concat(Xl({key:`${s}[0]`,value:n[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),yt(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&yt(n[1])==="$type"&&g.push(new Ht(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&g.push(new Ht(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=ri(n[1]),p!=="string"&&g.push(new Ht(`${s}[1]`,n[1],`string expected, ${p} found`)));for(let x=2;x<n.length;x++)p=ri(n[x]),yt(n[1])==="$type"?g=g.concat(Xl({key:`${s}[${x}]`,value:n[x],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&g.push(new Ht(`${s}[${x}]`,n[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)g=g.concat(hp({key:`${s}[${x}]`,value:n[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":p=ri(n[1]),n.length!==2?g.push(new Ht(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&g.push(new Ht(`${s}[1]`,n[1],`string expected, ${p} found`));break;case"within":p=ri(n[1]),n.length!==2?g.push(new Ht(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="object"&&g.push(new Ht(`${s}[1]`,n[1],`object expected, ${p} found`))}return g}function dp(a,n){const s=a.key,u=a.style,p=a.styleSpec,g=a.value,x=a.objectKey,A=p[`${n}_${a.layerType}`];if(!A)return[];const T=x.match(/^(.*)-transition$/);if(n==="paint"&&T&&A[T[1]]&&A[T[1]].transition)return Qi({key:s,value:g,valueSpec:p.transition,style:u,styleSpec:p});const D=a.valueSpec||A[x];if(!D)return[new Ht(s,g,`unknown property "${x}"`)];let k;if(ri(g)==="string"&&Os(D)&&!D.tokens&&(k=/^{([^}]+)}$/.exec(g)))return[new Ht(s,g,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(k[1])} }\`.`)];const z=[];return a.layerType==="symbol"&&(x==="text-field"&&u&&!u.glyphs&&z.push(new Ht(s,g,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&ts(Nt(g))&&yt(g.type)==="identity"&&z.push(new Ht(s,g,'"text-font" does not support identity functions'))),z.concat(Qi({key:a.key,value:g,valueSpec:D,style:u,styleSpec:p,expressionContext:"property",propertyType:n,propertyKey:x}))}function Xu(a){return dp(a,"paint")}function pp(a){return dp(a,"layout")}function bg(a){let n=[];const s=a.value,u=a.key,p=a.style,g=a.styleSpec;s.type||s.ref||n.push(new Ht(u,s,'either "type" or "ref" is required'));let x=yt(s.type);const A=yt(s.ref);if(s.id){const T=yt(s.id);for(let D=0;D<a.arrayIndex;D++){const k=p.layers[D];yt(k.id)===T&&n.push(new Ht(u,s.id,`duplicate layer id "${s.id}", previously used at line ${k.id.__line__}`))}}if("ref"in s){let T;["type","source","source-layer","filter","layout"].forEach(D=>{D in s&&n.push(new Ht(u,s[D],`"${D}" is prohibited for ref layers`))}),p.layers.forEach(D=>{yt(D.id)===A&&(T=D)}),T?T.ref?n.push(new Ht(u,s.ref,"ref cannot reference another ref layer")):x=yt(T.type):typeof A=="string"&&n.push(new Ht(u,s.ref,`ref layer "${A}" not found`))}else if(x!=="background"&&x!=="sky")if(s.source){const T=p.sources&&p.sources[s.source],D=T&&yt(T.type);T?D==="vector"&&x==="raster"?n.push(new Ht(u,s.source,`layer "${s.id}" requires a raster source`)):D==="raster"&&x!=="raster"?n.push(new Ht(u,s.source,`layer "${s.id}" requires a vector source`)):D!=="vector"||s["source-layer"]?D==="raster-dem"&&x!=="hillshade"?n.push(new Ht(u,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]||D==="geojson"&&T.lineMetrics||n.push(new Ht(u,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ht(u,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new Ht(u,s.source,`source "${s.source}" not found`))}else n.push(new Ht(u,s,'missing required property "source"'));return n=n.concat(Qr({key:u,value:s,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Qi({key:`${u}.type`,value:s.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,object:s,objectKey:"type"}),filter:T=>Aa(At({layerType:x},T)),layout:T=>Qr({layer:s,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":D=>pp(At({layerType:x},D))}}),paint:T=>Qr({layer:s,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":D=>Xu(At({layerType:x},D))}})}})),n}function Xo(a){const n=a.value,s=a.key,u=ri(n);return u!=="string"?[new Ht(s,n,`string expected, ${u} found`)]:[]}const wg={promoteId:function({key:a,value:n}){if(ri(n)==="string")return Xo({key:a,value:n});{const s=[];for(const u in n)s.push(...Xo({key:`${a}.${u}`,value:n[u]}));return s}}};function Ag(a){const n=a.value,s=a.key,u=a.styleSpec,p=a.style;if(!n.type)return[new Ht(s,n,'"type" is required')];const g=yt(n.type);let x;switch(g){case"vector":case"raster":case"raster-dem":return x=Qr({key:s,value:n,valueSpec:u[`source_${g.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:wg}),x;case"geojson":if(x=Qr({key:s,value:n,valueSpec:u.source_geojson,style:p,styleSpec:u,objectElementValidators:wg}),n.cluster)for(const A in n.clusterProperties){const[T,D]=n.clusterProperties[A],k=typeof T=="string"?[T,["accumulated"],["get",A]]:T;x.push(...js({key:`${s}.${A}.map`,value:D,expressionContext:"cluster-map"})),x.push(...js({key:`${s}.${A}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return x;case"video":return Qr({key:s,value:n,valueSpec:u.source_video,style:p,styleSpec:u});case"image":return Qr({key:s,value:n,valueSpec:u.source_image,style:p,styleSpec:u});case"canvas":return[new Ht(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xl({key:`${s}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:u})}}function Mg(a){const n=a.value,s=a.styleSpec,u=s.light,p=a.style;let g=[];const x=ri(n);if(n===void 0)return g;if(x!=="object")return g=g.concat([new Ht("light",n,`object expected, ${x} found`)]),g;for(const A in n){const T=A.match(/^(.*)-transition$/);g=g.concat(T&&u[T[1]]&&u[T[1]].transition?Qi({key:A,value:n[A],valueSpec:s.transition,style:p,styleSpec:s}):u[A]?Qi({key:A,value:n[A],valueSpec:u[A],style:p,styleSpec:s}):[new Ht(A,n[A],`unknown property "${A}"`)])}return g}function Sg(a){const n=a.value,s=a.key,u=a.style,p=a.styleSpec,g=p.terrain;let x=[];const A=ri(n);if(n===void 0)return x;if(A!=="object")return x=x.concat([new Ht("terrain",n,`object expected, ${A} found`)]),x;for(const T in n){const D=T.match(/^(.*)-transition$/);x=x.concat(D&&g[D[1]]&&g[D[1]].transition?Qi({key:T,value:n[T],valueSpec:p.transition,style:u,styleSpec:p}):g[T]?Qi({key:T,value:n[T],valueSpec:g[T],style:u,styleSpec:p}):[new Ht(T,n[T],`unknown property "${T}"`)])}if(n.source){const T=u.sources&&u.sources[n.source],D=T&&yt(T.type);T?D!=="raster-dem"&&x.push(new Ht(s,n.source,`terrain cannot be used with a source of type ${String(D)}, it only be used with a "raster-dem" source type`)):x.push(new Ht(s,n.source,`source "${n.source}" not found`))}else x.push(new Ht(s,n,'terrain is missing required property "source"'));return x}function Tg(a){const n=a.value,s=a.style,u=a.styleSpec,p=u.fog;let g=[];const x=ri(n);if(n===void 0)return g;if(x!=="object")return g=g.concat([new Ht("fog",n,`object expected, ${x} found`)]),g;for(const A in n){const T=A.match(/^(.*)-transition$/);g=g.concat(T&&p[T[1]]&&p[T[1]].transition?Qi({key:A,value:n[A],valueSpec:u.transition,style:s,styleSpec:u}):p[A]?Qi({key:A,value:n[A],valueSpec:p[A],style:s,styleSpec:u}):[new Ht(A,n[A],`unknown property "${A}"`)])}return g}const Ql={"*":()=>[],array:Yl,boolean:function(a){const n=a.value,s=a.key,u=ri(n);return u!=="boolean"?[new Ht(s,n,`boolean expected, ${u} found`)]:[]},number:yg,color:function(a){const n=a.key,s=a.value,u=ri(s);return u!=="string"?[new Ht(n,s,`color expected, ${u} found`)]:Vd.parseCSSColor(s)===null?[new Ht(n,s,`color expected, "${s}" found`)]:[]},enum:Xl,filter:Aa,function:xg,layer:bg,object:Qr,source:Ag,light:Mg,terrain:Sg,fog:Tg,string:Xo,formatted:function(a){return Xo(a).length===0?[]:js(a)},resolvedImage:function(a){return Xo(a).length===0?[]:js(a)},projection:function(a){const n=a.value,s=a.styleSpec,u=s.projection,p=a.style;let g=[];const x=ri(n);if(x==="object")for(const A in n)g=g.concat(Qi({key:A,value:n[A],valueSpec:u[A],style:p,styleSpec:s}));else x!=="string"&&(g=g.concat([new Ht("projection",n,`object or string expected, ${x} found`)]));return g}};function Qi(a){const n=a.value,s=a.valueSpec,u=a.styleSpec;return s.expression&&ts(yt(n))?xg(a):s.expression&&Gs(Nt(n))?js(a):s.type&&Ql[s.type]?Ql[s.type](a):Qr(At({},a,{valueSpec:s.type?u[s.type]:s}))}function Ur(a){const n=a.value,s=a.key,u=Xo(a);return u.length||(n.indexOf("{fontstack}")===-1&&u.push(new Ht(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&u.push(new Ht(s,n,'"glyphs" url must include a "{range}" token'))),u}function $l(a,n=me){return Ko(Qi({key:"",value:a,valueSpec:n.$root,styleSpec:n,style:a,objectElementValidators:{glyphs:Ur,"*":()=>[]}}))}const Yx=a=>Ko(Xu(a)),Xx=a=>Ko(pp(a));function Ko(a){return a.slice().sort((n,s)=>n.line&&s.line?n.line-s.line:0)}function Eg(a,n){let s=!1;if(n&&n.length)for(const u of n)a.fire(new ee(new Error(u.message))),s=!0;return s}var Ma=Do;function Do(a,n,s){var u=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var p=new Int32Array(this.arrayBuffer);a=p[0],this.d=(n=p[1])+2*(s=p[2]);for(var g=0;g<this.d*this.d;g++){var x=p[3+g],A=p[3+g+1];u.push(x===A?null:p.subarray(x,A))}var T=p[3+u.length+1];this.keys=p.subarray(p[3+u.length],T),this.bboxes=p.subarray(T),this.insert=this._insertReadonly}else{this.d=n+2*s;for(var D=0;D<this.d*this.d;D++)u.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=a,this.padding=s,this.scale=n/a,this.uid=0;var k=s/n*a;this.min=-k,this.max=a+k}Do.prototype.insert=function(a,n,s,u,p){this._forEachCell(n,s,u,p,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(p)},Do.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Do.prototype._insertCell=function(a,n,s,u,p,g){this.cells[p].push(g)},Do.prototype.query=function(a,n,s,u,p){var g=this.min,x=this.max;if(a<=g&&n<=g&&x<=s&&x<=u&&!p)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(a,n,s,u,this._queryCell,A,{},p),A},Do.prototype._queryCell=function(a,n,s,u,p,g,x,A){var T=this.cells[p];if(T!==null)for(var D=this.keys,k=this.bboxes,z=0;z<T.length;z++){var N=T[z];if(x[N]===void 0){var H=4*N;(A?A(k[H+0],k[H+1],k[H+2],k[H+3]):a<=k[H+2]&&n<=k[H+3]&&s>=k[H+0]&&u>=k[H+1])?(x[N]=!0,g.push(D[N])):x[N]=!1}}},Do.prototype._forEachCell=function(a,n,s,u,p,g,x,A){for(var T=this._convertToCellCoord(a),D=this._convertToCellCoord(n),k=this._convertToCellCoord(s),z=this._convertToCellCoord(u),N=T;N<=k;N++)for(var H=D;H<=z;H++){var K=this.d*H+N;if((!A||A(this._convertFromCellCoord(N),this._convertFromCellCoord(H),this._convertFromCellCoord(N+1),this._convertFromCellCoord(H+1)))&&p.call(this,a,n,s,u,K,g,x,A))return}},Do.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Do.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Do.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,n=3+this.cells.length+1+1,s=0,u=0;u<this.cells.length;u++)s+=this.cells[u].length;var p=new Int32Array(n+s+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var g=n,x=0;x<a.length;x++){var A=a[x];p[3+x]=g,p.set(A,g),g+=A.length}return p[3+a.length]=g,p.set(this.keys,g),p[3+a.length+1]=g+=this.keys.length,p.set(this.bboxes,g),g+=this.bboxes.length,p.buffer};const Hs={};function qt(a,n,s={}){Object.defineProperty(a,"_classRegistryKey",{value:n,writeable:!1}),Hs[n]={klass:a,omit:s.omit||[]}}qt(Object,"Object"),Ma.serialize=function(a,n){const s=a.toArrayBuffer();return n&&n.push(s),{buffer:s}},Ma.deserialize=function(a){return new Ma(a.buffer)},Object.defineProperty(Ma,"name",{value:"Grid"}),qt(Ma,"Grid"),qt(Qn,"Color"),qt(Error,"Error"),qt(q,"AJAXError"),qt(kr,"ResolvedImage"),qt(Wu,"StylePropertyFunction"),qt(Hu,"StyleExpression",{omit:["_evaluator"]}),qt(ap,"ZoomDependentExpression"),qt(op,"ZoomConstantExpression"),qt(Br,"CompoundExpression",{omit:["_evaluate"]});for(const a in $a)Hs[$a[a]._classRegistryKey]||qt($a[a],`Expression${a}`);function Pg(a){return a&&typeof ArrayBuffer!="undefined"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Ku(a){return P.ImageBitmap&&a instanceof P.ImageBitmap}function ec(a,n){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Pg(a)||Ku(a))return n&&n.push(a),a;if(ArrayBuffer.isView(a)){const s=a;return n&&n.push(s.buffer),s}if(a instanceof P.ImageData)return n&&n.push(a.data.buffer),a;if(Array.isArray(a)){const s=[];for(const u of a)s.push(ec(u,n));return s}if(typeof a=="object"){const s=a.constructor,u=s._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const p=s.serialize?s.serialize(a,n):{};if(!s.serialize){for(const g in a)a.hasOwnProperty(g)&&(Hs[u].omit.indexOf(g)>=0||(p[g]=ec(a[g],n)));a instanceof Error&&(p.message=a.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof a)}function Ws(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Pg(a)||Ku(a)||ArrayBuffer.isView(a)||a instanceof P.ImageData)return a;if(Array.isArray(a))return a.map(Ws);if(typeof a=="object"){const n=a.$name||"Object",{klass:s}=Hs[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(a);const u=Object.create(s.prototype);for(const p of Object.keys(a))p!=="$name"&&(u[p]=Ws(a[p]));return u}throw new Error("can't deserialize object of type "+typeof a)}class fp{constructor(){this.first=!0}update(n,s){const u=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=s),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=u,!0))}}const Cg=a=>a>=1536&&a<=1791,Zu=a=>a>=1872&&a<=1919,tc=a=>a>=2208&&a<=2303,mp=a=>a>=11904&&a<=12031,Rg=a=>a>=12032&&a<=12255,gp=a=>a>=12272&&a<=12287,Ju=a=>a>=12288&&a<=12351,nc=a=>a>=12352&&a<=12447,Qu=a=>a>=12448&&a<=12543,Dg=a=>a>=12544&&a<=12591,Ig=a=>a>=12704&&a<=12735,Lg=a=>a>=12736&&a<=12783,yp=a=>a>=12784&&a<=12799,Fg=a=>a>=12800&&a<=13055,kg=a=>a>=13056&&a<=13311,Bg=a=>a>=13312&&a<=19903,xp=a=>a>=19968&&a<=40959,zg=a=>a>=40960&&a<=42127,Ug=a=>a>=42128&&a<=42191,Ng=a=>a>=44032&&a<=55215,ic=a=>a>=63744&&a<=64255,vp=a=>a>=64336&&a<=65023,Vg=a=>a>=65040&&a<=65055,qs=a=>a>=65072&&a<=65103,Og=a=>a>=65104&&a<=65135,$u=a=>a>=65136&&a<=65279,_p=a=>a>=65280&&a<=65519;function eh(a){for(const n of a)if(th(n.charCodeAt(0)))return!0;return!1}function Gg(a){for(const n of a)if(!jg(n.charCodeAt(0)))return!1;return!0}function jg(a){return!(Cg(a)||Zu(a)||tc(a)||vp(a)||$u(a))}function th(a){return!(a!==746&&a!==747&&(a<4352||!(Ig(a)||Dg(a)||qs(a)&&!(a>=65097&&a<=65103)||ic(a)||kg(a)||mp(a)||Lg(a)||!(!Ju(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Bg(a)||xp(a)||Fg(a)||(n=>n>=12592&&n<=12687)(a)||(n=>n>=43360&&n<=43391)(a)||(n=>n>=55216&&n<=55295)(a)||(n=>n>=4352&&n<=4607)(a)||Ng(a)||nc(a)||gp(a)||(n=>n>=12688&&n<=12703)(a)||Rg(a)||yp(a)||Qu(a)&&a!==12540||!(!_p(a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Og(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(n=>n>=5120&&n<=5759)(a)||(n=>n>=6320&&n<=6399)(a)||Vg(a)||(n=>n>=19904&&n<=19967)(a)||zg(a)||Ug(a))))}function nh(a){return!(th(a)||function(n){return!!((s=>s>=128&&s<=255)(n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||(s=>s>=8192&&s<=8303)(n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||(s=>s>=8448&&s<=8527)(n)||(s=>s>=8528&&s<=8591)(n)||(s=>s>=8960&&s<=9215)(n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||(s=>s>=9216&&s<=9279)(n)&&n!==9251||(s=>s>=9280&&s<=9311)(n)||(s=>s>=9312&&s<=9471)(n)||(s=>s>=9632&&s<=9727)(n)||(s=>s>=9728&&s<=9983)(n)&&!(n>=9754&&n<=9759)||(s=>s>=11008&&s<=11263)(n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ju(n)||Qu(n)||(s=>s>=57344&&s<=63743)(n)||qs(n)||Og(n)||_p(n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(a))}function ih(a){return a>=1424&&a<=2303||vp(a)||$u(a)}function Kx(a,n){return!(!n&&ih(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(s=>s>=6016&&s<=6143)(a))}function Zx(a){for(const n of a)if(ih(n.charCodeAt(0)))return!0;return!1}const bp="deferred",rc="loading",wp="loaded";let Ap=null,Sr="unavailable",Nr=null;const oc=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(Sr="error"),Ap&&Ap(a)};function ns(){Mp.fire(new X("pluginStateChange",{pluginStatus:Sr,pluginURL:Nr}))}const Mp=new Te,rh=function(){return Sr},Ys=function(){if(Sr!==bp||!Nr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Sr=rc,ns(),Nr&&Ae({url:Nr},a=>{a?oc(a):(Sr=wp,ns())})},$r={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Sr===wp||$r.applyArabicShaping!=null,isLoading:()=>Sr===rc,setState(a){Sr=a.pluginStatus,Nr=a.pluginURL},isParsed:()=>$r.applyArabicShaping!=null&&$r.processBidirectionalText!=null&&$r.processStyledBidirectionalText!=null,getPluginURL:()=>Nr};class mi{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new fp,this.transition={},this.pitch=0)}isSupportedScript(n){return function(s,u){for(const p of s)if(!Kx(p.charCodeAt(0),u))return!1;return!0}(n,$r.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,s=n-Math.floor(n),u=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*s}}}class ac{constructor(n,s){this.property=n,this.value=s,this.expression=function(u,p){if(ts(u))return new Wu(u,p);if(Gs(u)){const g=gg(u,p);if(g.result==="error")throw new Error(g.value.map(x=>`${x.key}: ${x.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&p.type==="color"&&(g=Qn.parse(u)),{kind:"constant",evaluate:()=>g}}}(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,u){return this.property.possiblyEvaluate(this,n,s,u)}}class Xs{constructor(n){this.property=n,this.value=new ac(n,void 0)}transitioned(n,s){return new o(this.property,this.value,s,Ne({},n.transition,this.transition),n.now)}untransitioned(){return new o(this.property,this.value,null,{},0)}}class m{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Vt(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Xs(this._values[n].property)),this._values[n].value=new ac(this._values[n].property,s===null?void 0:Vt(s))}getTransition(n){return Vt(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Xs(this._values[n].property)),this._values[n].transition=Vt(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u);const p=this.getTransition(s);p!==void 0&&(n[`${s}-transition`]=p)}return n}transitioned(n,s){const u=new d(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(n,s._values[p]);return u}untransitioned(){const n=new d(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class o{constructor(n,s,u,p,g){const x=p.delay||0,A=p.duration||0;g=g||0,this.property=n,this.value=s,this.begin=g+x,this.end=this.begin+A,n.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(n,s,u){const p=n.now||0,g=this.value.possiblyEvaluate(n,s,u),x=this.prior;if(x){if(p>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(p<this.begin)return x.possiblyEvaluate(n,s,u);{const A=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,s,u),g,Z(A))}}return g}}class d{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,u){const p=new S(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(n,s,u);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class y{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return Vt(this._values[n].value)}setValue(n,s){this._values[n]=new ac(this._values[n].property,s===null?void 0:Vt(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u)}return n}possiblyEvaluate(n,s,u){const p=new S(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(n,s,u);return p}}class M{constructor(n,s,u){this.property=n,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,u,p){return this.property.evaluate(this.value,this.parameters,n,s,u,p)}}class S{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class C{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,u){const p=Fu[this.specification.type];return p?p(n,s,u):n}}class L{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,u,p){return new M(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},u,p)}:n.expression,s)}interpolate(n,s,u){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new M(this,{kind:"constant",value:void 0},n.parameters);const p=Fu[this.specification.type];return p?new M(this,{kind:"constant",value:p(n.value.value,s.value.value,u)},n.parameters):n}evaluate(n,s,u,p,g,x){return n.kind==="constant"?n.value:n.evaluate(s,u,p,g,x)}}class U extends L{possiblyEvaluate(n,s,u,p){if(n.value===void 0)return new M(this,{kind:"constant",value:void 0},s);if(n.expression.kind==="constant"){const g=n.expression.evaluate(s,null,{},u,p),x=n.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,A=this._calculate(x,x,x,s);return new M(this,{kind:"constant",value:A},s)}if(n.expression.kind==="camera"){const g=this._calculate(n.expression.evaluate({zoom:s.zoom-1}),n.expression.evaluate({zoom:s.zoom}),n.expression.evaluate({zoom:s.zoom+1}),s);return new M(this,{kind:"constant",value:g},s)}return new M(this,n.expression,s)}evaluate(n,s,u,p,g,x){if(n.kind==="source"){const A=n.evaluate(s,u,p,g,x);return this._calculate(A,A,A,s)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(s.zoom)-1},u,p),n.evaluate({zoom:Math.floor(s.zoom)},u,p),n.evaluate({zoom:Math.floor(s.zoom)+1},u,p),s):n.value}_calculate(n,s,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s,other:u}:{from:u,to:s,other:n}}interpolate(n){return n}}class G{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const g=n.expression.evaluate(s,null,{},u,p);return this._calculate(g,g,g,s)}return this._calculate(n.expression.evaluate(new mi(Math.floor(s.zoom-1),s)),n.expression.evaluate(new mi(Math.floor(s.zoom),s)),n.expression.evaluate(new mi(Math.floor(s.zoom+1),s)),s)}}_calculate(n,s,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:u,to:s}}interpolate(n){return n}}class j{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,p){return!!n.expression.evaluate(s,null,{},u,p)}interpolate(){return!1}}class Y{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in n){const u=n[s];u.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new ac(u,void 0),g=this.defaultTransitionablePropertyValues[s]=new Xs(u);this.defaultTransitioningPropertyValues[s]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate({})}}}function ne(a,n){return 256*(a=oe(Math.floor(a),0,255))+oe(Math.floor(n),0,255)}qt(L,"DataDrivenProperty"),qt(C,"DataConstantProperty"),qt(U,"CrossFadedDataDrivenProperty"),qt(G,"CrossFadedProperty"),qt(j,"ColorRampProperty");const se={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class re{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Q{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function _e(a,n=1){let s=0,u=0;return{members:a.map(p=>{const g=se[p.type].BYTES_PER_ELEMENT,x=s=ue(s,Math.max(n,g)),A=p.components||1;return u=Math.max(u,g),s+=g*A,{name:p.name,type:p.type,components:A,offset:x}}),size:ue(s,Math.max(u,n)),alignment:n}}function ue(a,n){return Math.ceil(a/n)*n}class ye extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const p=2*n;return this.int16[p+0]=s,this.int16[p+1]=u,n}}ye.prototype.bytesPerElement=4,qt(ye,"StructArrayLayout2i4");class ve extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const g=3*n;return this.int16[g+0]=s,this.int16[g+1]=u,this.int16[g+2]=p,n}}ve.prototype.bytesPerElement=6,qt(ve,"StructArrayLayout3i6");class Me extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u,p)}emplace(n,s,u,p,g){const x=4*n;return this.int16[x+0]=s,this.int16[x+1]=u,this.int16[x+2]=p,this.int16[x+3]=g,n}}Me.prototype.bytesPerElement=8,qt(Me,"StructArrayLayout4i8");class ge extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,p,g,x,A)}emplace(n,s,u,p,g,x,A,T){const D=6*n,k=12*n,z=3*n;return this.int16[D+0]=s,this.int16[D+1]=u,this.uint8[k+4]=p,this.uint8[k+5]=g,this.uint8[k+6]=x,this.uint8[k+7]=A,this.float32[z+2]=T,n}}ge.prototype.bytesPerElement=12,qt(ge,"StructArrayLayout2i4ub1f12");class Ce extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u,p)}emplace(n,s,u,p,g){const x=4*n;return this.float32[x+0]=s,this.float32[x+1]=u,this.float32[x+2]=p,this.float32[x+3]=g,n}}Ce.prototype.bytesPerElement=16,qt(Ce,"StructArrayLayout4f16");class Qe extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A,T,D,k){const z=this.length;return this.resize(z+1),this.emplace(z,n,s,u,p,g,x,A,T,D,k)}emplace(n,s,u,p,g,x,A,T,D,k,z){const N=10*n;return this.uint16[N+0]=s,this.uint16[N+1]=u,this.uint16[N+2]=p,this.uint16[N+3]=g,this.uint16[N+4]=x,this.uint16[N+5]=A,this.uint16[N+6]=T,this.uint16[N+7]=D,this.uint16[N+8]=k,this.uint16[N+9]=z,n}}Qe.prototype.bytesPerElement=20,qt(Qe,"StructArrayLayout10ui20");class rt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A,T){const D=this.length;return this.resize(D+1),this.emplace(D,n,s,u,p,g,x,A,T)}emplace(n,s,u,p,g,x,A,T,D){const k=8*n;return this.uint16[k+0]=s,this.uint16[k+1]=u,this.uint16[k+2]=p,this.uint16[k+3]=g,this.uint16[k+4]=x,this.uint16[k+5]=A,this.uint16[k+6]=T,this.uint16[k+7]=D,n}}rt.prototype.bytesPerElement=16,qt(rt,"StructArrayLayout8ui16");class ht extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,u,p,g,x)}emplace(n,s,u,p,g,x,A){const T=6*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=p,this.int16[T+3]=g,this.int16[T+4]=x,this.int16[T+5]=A,n}}ht.prototype.bytesPerElement=12,qt(ht,"StructArrayLayout6i12");class ct extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae){const he=this.length;return this.resize(he+1),this.emplace(he,n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae)}emplace(n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he){const Pe=16*n;return this.int16[Pe+0]=s,this.int16[Pe+1]=u,this.int16[Pe+2]=p,this.int16[Pe+3]=g,this.uint16[Pe+4]=x,this.uint16[Pe+5]=A,this.uint16[Pe+6]=T,this.uint16[Pe+7]=D,this.int16[Pe+8]=k,this.int16[Pe+9]=z,this.int16[Pe+10]=N,this.int16[Pe+11]=H,this.int16[Pe+12]=K,this.int16[Pe+13]=te,this.int16[Pe+14]=ae,this.int16[Pe+15]=he,n}}ct.prototype.bytesPerElement=32,qt(ct,"StructArrayLayout4i4ui4i4i32");class Ft extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const g=3*n;return this.float32[g+0]=s,this.float32[g+1]=u,this.float32[g+2]=p,n}}Ft.prototype.bytesPerElement=12,qt(Ft,"StructArrayLayout3f12");class $e extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}$e.prototype.bytesPerElement=4,qt($e,"StructArrayLayout1ul4");class kt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A,T,D,k,z,N,H){const K=this.length;return this.resize(K+1),this.emplace(K,n,s,u,p,g,x,A,T,D,k,z,N,H)}emplace(n,s,u,p,g,x,A,T,D,k,z,N,H,K){const te=20*n,ae=10*n;return this.int16[te+0]=s,this.int16[te+1]=u,this.int16[te+2]=p,this.int16[te+3]=g,this.int16[te+4]=x,this.float32[ae+3]=A,this.float32[ae+4]=T,this.float32[ae+5]=D,this.float32[ae+6]=k,this.int16[te+14]=z,this.uint32[ae+8]=N,this.uint16[te+18]=H,this.uint16[te+19]=K,n}}kt.prototype.bytesPerElement=40,qt(kt,"StructArrayLayout5i4f1i1ul2ui40");class Ct extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,p,g,x,A)}emplace(n,s,u,p,g,x,A,T){const D=8*n;return this.int16[D+0]=s,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+4]=g,this.int16[D+5]=x,this.int16[D+6]=A,this.int16[D+7]=T,n}}Ct.prototype.bytesPerElement=16,qt(Ct,"StructArrayLayout3i2i2i16");class Qt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,u,p,g)}emplace(n,s,u,p,g,x){const A=4*n,T=8*n;return this.float32[A+0]=s,this.float32[A+1]=u,this.float32[A+2]=p,this.int16[T+6]=g,this.int16[T+7]=x,n}}Qt.prototype.bytesPerElement=16,qt(Qt,"StructArrayLayout2f1f2i16");class dt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u,p)}emplace(n,s,u,p,g){const x=12*n,A=3*n;return this.uint8[x+0]=s,this.uint8[x+1]=u,this.float32[A+1]=p,this.float32[A+2]=g,n}}dt.prototype.bytesPerElement=12,qt(dt,"StructArrayLayout2ub2f12");class Yt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const g=3*n;return this.uint16[g+0]=s,this.uint16[g+1]=u,this.uint16[g+2]=p,n}}Yt.prototype.bytesPerElement=6,qt(Yt,"StructArrayLayout3ui6");class gn extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he,Pe,Be,Oe,qe){const Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he,Pe,Be,Oe,qe)}emplace(n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he,Pe,Be,Oe,qe,Ye){const st=30*n,ut=15*n,vt=60*n;return this.int16[st+0]=s,this.int16[st+1]=u,this.int16[st+2]=p,this.float32[ut+2]=g,this.float32[ut+3]=x,this.uint16[st+8]=A,this.uint16[st+9]=T,this.uint32[ut+5]=D,this.uint32[ut+6]=k,this.uint32[ut+7]=z,this.uint16[st+16]=N,this.uint16[st+17]=H,this.uint16[st+18]=K,this.float32[ut+10]=te,this.float32[ut+11]=ae,this.uint8[vt+48]=he,this.uint8[vt+49]=Pe,this.uint8[vt+50]=Be,this.uint32[ut+13]=Oe,this.int16[st+28]=qe,this.uint8[vt+58]=Ye,n}}gn.prototype.bytesPerElement=60,qt(gn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Kt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he,Pe,Be,Oe,qe,Ye,st,ut,vt,Mt,it,pt,Tt,zt){const Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he,Pe,Be,Oe,qe,Ye,st,ut,vt,Mt,it,pt,Tt,zt)}emplace(n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae,he,Pe,Be,Oe,qe,Ye,st,ut,vt,Mt,it,pt,Tt,zt,Dt){const Bt=38*n,Cn=19*n;return this.int16[Bt+0]=s,this.int16[Bt+1]=u,this.int16[Bt+2]=p,this.float32[Cn+2]=g,this.float32[Cn+3]=x,this.int16[Bt+8]=A,this.int16[Bt+9]=T,this.int16[Bt+10]=D,this.int16[Bt+11]=k,this.int16[Bt+12]=z,this.int16[Bt+13]=N,this.uint16[Bt+14]=H,this.uint16[Bt+15]=K,this.uint16[Bt+16]=te,this.uint16[Bt+17]=ae,this.uint16[Bt+18]=he,this.uint16[Bt+19]=Pe,this.uint16[Bt+20]=Be,this.uint16[Bt+21]=Oe,this.uint16[Bt+22]=qe,this.uint16[Bt+23]=Ye,this.uint16[Bt+24]=st,this.uint16[Bt+25]=ut,this.uint16[Bt+26]=vt,this.uint16[Bt+27]=Mt,this.uint16[Bt+28]=it,this.uint32[Cn+15]=pt,this.float32[Cn+16]=Tt,this.float32[Cn+17]=zt,this.float32[Cn+18]=Dt,n}}Kt.prototype.bytesPerElement=76,qt(Kt,"StructArrayLayout3i2f6i15ui1ul3f76");class Zt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}Zt.prototype.bytesPerElement=4,qt(Zt,"StructArrayLayout1f4");class wn extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,p,g,x,A)}emplace(n,s,u,p,g,x,A,T){const D=7*n;return this.float32[D+0]=s,this.float32[D+1]=u,this.float32[D+2]=p,this.float32[D+3]=g,this.float32[D+4]=x,this.float32[D+5]=A,this.float32[D+6]=T,n}}wn.prototype.bytesPerElement=28,qt(wn,"StructArrayLayout7f28");class Nn extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,u,p,g)}emplace(n,s,u,p,g,x){const A=5*n;return this.float32[A+0]=s,this.float32[A+1]=u,this.float32[A+2]=p,this.float32[A+3]=g,this.float32[A+4]=x,n}}Nn.prototype.bytesPerElement=20,qt(Nn,"StructArrayLayout5f20");class pn extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u,p)}emplace(n,s,u,p,g){const x=6*n;return this.uint32[3*n+0]=s,this.uint16[x+2]=u,this.uint16[x+3]=p,this.uint16[x+4]=g,n}}pn.prototype.bytesPerElement=12,qt(pn,"StructArrayLayout1ul3ui12");class Sn extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const p=2*n;return this.uint16[p+0]=s,this.uint16[p+1]=u,n}}Sn.prototype.bytesPerElement=4,qt(Sn,"StructArrayLayout2ui4");class Zn extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}Zn.prototype.bytesPerElement=2,qt(Zn,"StructArrayLayout1ui2");class Si extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const p=2*n;return this.float32[p+0]=s,this.float32[p+1]=u,n}}Si.prototype.bytesPerElement=8,qt(Si,"StructArrayLayout2f8");class cr extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,g,x,A){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,p,g,x,A)}emplace(n,s,u,p,g,x,A,T){const D=8*n,k=4*n;return this.int16[D+0]=s,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+3]=g,this.int16[D+4]=x,this.int16[D+5]=A,this.float32[k+3]=T,n}}cr.prototype.bytesPerElement=16,qt(cr,"StructArrayLayout6i1f16");class ur extends re{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}ur.prototype.size=12;class Vr extends ht{get(n){return new ur(this,n)}}qt(Vr,"FillExtrusionExtArray");class bo extends re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}bo.prototype.size=40;class Zo extends kt{get(n){return new bo(this,n)}}qt(Zo,"CollisionBoxArray");class Sa extends re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Sa.prototype.size=60;class Jo extends gn{get(n){return new Sa(this,n)}}qt(Jo,"PlacedSymbolArray");class Ei extends re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(n){this._structArray.uint32[this._pos4+15]=n}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ei.prototype.size=76;class Ri extends Kt{get(n){return new Ei(this,n)}}qt(Ri,"SymbolInstanceArray");class ei extends Zt{getoffsetX(n){return this.float32[1*n+0]}}qt(ei,"GlyphOffsetArray");class zi extends ve{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}qt(zi,"SymbolLineVertexArray");class Or extends re{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Or.prototype.size=12;class Ti extends pn{get(n){return new Or(this,n)}}qt(Ti,"FeatureIndexArray");class eo extends re{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}eo.prototype.size=4;class sc extends Sn{get(n){return new eo(this,n)}}qt(sc,"FillExtrusionCentroidArray");class Gr extends re{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}get a_scale(){return this._structArray.float32[this._pos4+3]}}Gr.prototype.size=16;class is extends cr{get(n){return new Gr(this,n)}}qt(is,"CircleGlobeExtArray");const Hg=_e([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Sp=_e([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Ks=Eu(function(a){a.exports=function(n,s){var u,p,g,x,A,T,D,k;for(p=n.length-(u=3&n.length),g=s,A=3432918353,T=461845907,k=0;k<p;)D=255&n.charCodeAt(k)|(255&n.charCodeAt(++k))<<8|(255&n.charCodeAt(++k))<<16|(255&n.charCodeAt(++k))<<24,++k,g=27492+(65535&(x=5*(65535&(g=(g^=D=(65535&(D=(D=(65535&D)*A+(((D>>>16)*A&65535)<<16)&4294967295)<<15|D>>>17))*T+(((D>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(D=0,u){case 3:D^=(255&n.charCodeAt(k+2))<<16;case 2:D^=(255&n.charCodeAt(k+1))<<8;case 1:g^=D=(65535&(D=(D=(65535&(D^=255&n.charCodeAt(k)))*A+(((D>>>16)*A&65535)<<16)&4294967295)<<15|D>>>17))*T+(((D>>>16)*T&65535)<<16)&4294967295}return g^=n.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),Jx=Eu(function(a){a.exports=function(n,s){for(var u,p=n.length,g=s^p,x=0;p>=4;)u=1540483477*(65535&(u=255&n.charCodeAt(x)|(255&n.charCodeAt(++x))<<8|(255&n.charCodeAt(++x))<<16|(255&n.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),p-=4,++x;switch(p){case 3:g^=(255&n.charCodeAt(x+2))<<16;case 2:g^=(255&n.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&n.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),Ta=Ks,Tp=Jx;Ta.murmur3=Ks,Ta.murmur2=Tp;class Wg{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,u,p){this.ids.push(eA(n)),this.positions.push(s,u,p)}getPositions(n){const s=eA(n);let u=0,p=this.ids.length-1;for(;u<p;){const x=u+p>>1;this.ids[x]>=s?p=x:u=x+1}const g=[];for(;this.ids[u]===s;)g.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return g}static serialize(n,s){const u=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Qx(u,p,0,u.length-1),s&&s.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(n){const s=new Wg;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function eA(a){const n=+a;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:Ta(String(a))}function Qx(a,n,s,u){for(;s<u;){const p=a[s+u>>1];let g=s-1,x=u+1;for(;;){do g++;while(a[g]<p);do x--;while(a[x]>p);if(g>=x)break;qg(a,g,x),qg(n,3*g,3*x),qg(n,3*g+1,3*x+1),qg(n,3*g+2,3*x+2)}x-s<u-x?(Qx(a,n,s,x),s=x+1):(Qx(a,n,x+1,u),u=x)}}function qg(a,n,s){const u=a[n];a[n]=a[s],a[s]=u}qt(Wg,"FeaturePositionMap");class rs{constructor(n,s){this.gl=n.gl,this.location=s}}class Yg extends rs{constructor(n,s){super(n,s),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class tA extends rs{constructor(n,s){super(n,s),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class nA extends rs{constructor(n,s){super(n,s),this.current=Qn.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const DF=new Float32Array(16),IF=new Float32Array(9),LF=new Float32Array(4);function $x(a){return[ne(255*a.r,255*a.g),ne(255*a.b,255*a.a)]}class Ep{constructor(n,s,u){this.value=n,this.uniformNames=s.map(p=>`u_${p}`),this.type=u}setUniform(n,s,u){n.set(u.constantOr(this.value))}getBinding(n,s,u){return this.type==="color"?new nA(n,s):new Yg(n,s)}}class oh{constructor(n,s){this.uniformNames=s.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,s){this.pixelRatioFrom=s.pixelRatio||1,this.pixelRatioTo=n.pixelRatio||1,this.patternFrom=s.tl.concat(s.br),this.patternTo=n.tl.concat(n.br)}setUniform(n,s,u,p){const g=p==="u_pattern_to"||p==="u_dash_to"?this.patternTo:p==="u_pattern_from"||p==="u_dash_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&n.set(g)}getBinding(n,s,u){return u==="u_pattern_from"||u==="u_pattern_to"||u==="u_dash_from"||u==="u_dash_to"?new tA(n,s):new Yg(n,s)}}class os{constructor(n,s,u,p){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(g=>({name:`a_${g}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,s,u,p,g,x){const A=this.paintVertexArray.length,T=this.expression.evaluate(new mi(0),s,{},g,p,x);this.paintVertexArray.resize(n),this._setPaintValue(A,n,T)}updatePaintArray(n,s,u,p,g){const x=this.expression.evaluate({zoom:0},u,p,void 0,g);this._setPaintValue(n,s,x)}_setPaintValue(n,s,u){if(this.type==="color"){const p=$x(u);for(let g=n;g<s;g++)this.paintVertexArray.emplace(g,p[0],p[1])}else{for(let p=n;p<s;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Qo{constructor(n,s,u,p,g,x){this.expression=n,this.uniformNames=s.map(A=>`u_${A}_t`),this.type=u,this.useIntegerZoom=p,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=s.map(A=>({name:`a_${A}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,s,u,p,g,x){const A=this.expression.evaluate(new mi(this.zoom),s,{},g,p,x),T=this.expression.evaluate(new mi(this.zoom+1),s,{},g,p,x),D=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(D,n,A,T)}updatePaintArray(n,s,u,p,g){const x=this.expression.evaluate({zoom:this.zoom},u,p,void 0,g),A=this.expression.evaluate({zoom:this.zoom+1},u,p,void 0,g);this._setPaintValue(n,s,x,A)}_setPaintValue(n,s,u,p){if(this.type==="color"){const g=$x(u),x=$x(p);for(let A=n;A<s;A++)this.paintVertexArray.emplace(A,g[0],g[1],x[0],x[1])}else{for(let g=n;g<s;g++)this.paintVertexArray.emplace(g,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s){const u=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,p=oe(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,s,u){return new Yg(n,s)}}class Zs{constructor(n,s,u,p,g,x,A){this.expression=n,this.type=u,this.useIntegerZoom=p,this.zoom=g,this.layerId=A,this.paintVertexAttributes=(u==="array"?Sp:Hg).members;for(let T=0;T<s.length;++T);this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(n,s,u){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(n,s,u,p,g,x){this._setPaintValues(n,s,u.patterns&&u.patterns[this.layerId],x)}_setPaintValues(n,s,u,p){if(!p||!u)return;const{min:g,mid:x,max:A}=u,T=p[g],D=p[x],k=p[A];if(T&&D&&k)for(let z=n;z<s;z++)this._setPaintValue(this.zoomInPaintVertexArray,z,D,T),this._setPaintValue(this.zoomOutPaintVertexArray,z,D,k)}_setPaintValue(n,s,u,p){n.emplace(s,u.tl[0],u.tl[1],u.br[0],u.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],u.pixelRatio,p.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Js{constructor(n,s,u=()=>!0){this.binders={},this._buffers=[];const p=[];for(const g in n.paint._values){if(!u(g))continue;const x=n.paint.get(g);if(!(x instanceof M&&Os(x.property.specification)))continue;const A=kF(g,n.type),T=x.value,D=x.property.specification.type,k=x.property.useIntegerZoom,z=x.property.specification["property-type"],N=z==="cross-faded"||z==="cross-faded-data-driven",H=String(g)==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(T.kind!=="constant"||H)if(T.kind==="source"||H||N){const K=iA(g,D,"source");this.binders[g]=N?new Zs(T,A,D,k,s,K,n.id):new os(T,A,D,K),p.push(`/a_${g}`)}else{const K=iA(g,D,"composite");this.binders[g]=new Qo(T,A,D,k,s,K),p.push(`/z_${g}`)}else this.binders[g]=N?new oh(T.value,A):new Ep(T.value,A,D),p.push(`/u_${g}`)}this.cacheKey=p.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof os||s instanceof Qo?s.maxValue:0}populatePaintArrays(n,s,u,p,g,x){for(const A in this.binders){const T=this.binders[A];(T instanceof os||T instanceof Qo||T instanceof Zs)&&T.populatePaintArray(n,s,u,p,g,x)}}setConstantPatternPositions(n,s){for(const u in this.binders){const p=this.binders[u];p instanceof oh&&p.setConstantPatternPositions(n,s)}}updatePaintArrays(n,s,u,p,g,x){let A=!1;for(const T in n){const D=s.getPositions(T);for(const k of D){const z=u.feature(k.index);for(const N in this.binders){const H=this.binders[N];if((H instanceof os||H instanceof Qo||H instanceof Zs)&&H.expression.isStateDependent===!0){const K=p.paint.get(N);H.expression=K.value,H.updatePaintArray(k.start,k.end,z,n[T],g,x),A=!0}}}}return A}defines(){const n=[];for(const s in this.binders){const u=this.binders[s];(u instanceof Ep||u instanceof oh)&&n.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof os||u instanceof Qo||u instanceof Zs)for(let p=0;p<u.paintVertexAttributes.length;p++)n.push(u.paintVertexAttributes[p].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Ep||u instanceof oh||u instanceof Qo)for(const p of u.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,s){const u=[];for(const p in this.binders){const g=this.binders[p];if(g instanceof Ep||g instanceof oh||g instanceof Qo){for(const x of g.uniformNames)if(s[x]){const A=g.getBinding(n,s[x],x);u.push({name:x,property:p,binding:A})}}}return u}setUniforms(n,s,u,p){for(const{name:g,property:x,binding:A}of s)this.binders[x].setUniform(A,p,u.get(x),g)}updatePaintBuffers(n){this._buffers=[];for(const s in this.binders){const u=this.binders[s];if(n&&u instanceof Zs){const p=n.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(u instanceof os||u instanceof Qo)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(n){for(const s in this.binders){const u=this.binders[s];(u instanceof os||u instanceof Qo||u instanceof Zs)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof os||s instanceof Qo||s instanceof Zs)&&s.destroy()}}}class lc{constructor(n,s,u=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new Js(p,s,u);this.needsUpload=!1,this._featureMap=new Wg,this._bufferOffset=0}populatePaintArrays(n,s,u,p,g,x,A){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(n,s,p,g,x,A);s.id!==void 0&&this._featureMap.add(s.id,u,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,u,p,g){for(const x of u)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(n,this._featureMap,s,x,p,g)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const FF={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function kF(a,n){return FF[a]||[a.replace(`${n}-`,"").replace(/-/g,"_")]}const BF={"line-pattern":{source:Qe,composite:Qe},"fill-pattern":{source:Qe,composite:Qe},"fill-extrusion-pattern":{source:Qe,composite:Qe},"line-dasharray":{source:rt,composite:rt}},zF={color:{source:Si,composite:Ce},number:{source:Zt,composite:Si}};function iA(a,n,s){const u=BF[a];return u&&u[s]||zF[n][s]}qt(Ep,"ConstantBinder"),qt(oh,"CrossFadedConstantBinder"),qt(os,"SourceExpressionBinder"),qt(Zs,"CrossFadedCompositeBinder"),qt(Qo,"CompositeExpressionBinder"),qt(Js,"ProgramConfiguration",{omit:["_buffers"]}),qt(lc,"ProgramConfigurationSet");const Xg="-transition";class $o extends Te{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,n.type!=="custom"&&(this.metadata=(n=n).metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new y(s.layout)),s.paint)){this._transitionablePaint=new m(s.paint);for(const u in n.paint)this.setPaintProperty(u,n.paint[u],{validate:!1});for(const u in n.layout)this.setLayoutProperty(u,n.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new S(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,u={}){s!=null&&this._validate(Xx,`layers.${this.id}.layout.${n}`,n,s,u)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return mt(n,Xg)?this._transitionablePaint.getTransition(n.slice(0,-Xg.length)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,u={}){if(s!=null&&this._validate(Yx,`layers.${this.id}.paint.${n}`,n,s,u))return!1;if(mt(n,Xg))return this._transitionablePaint.setTransition(n.slice(0,-Xg.length),s||void 0),!1;{const p=this._transitionablePaint._values[n],g=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),A=p.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const T=this._transitionablePaint._values[n].value;return T.isDataDriven()||x||g||this._handleOverridablePaintPropertyUpdate(n,A,T)}}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getProgramConfiguration(n){return null}_handleOverridablePaintPropertyUpdate(n,s,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),ft(n,(s,u)=>!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length))}_validate(n,s,u,p,g={}){return(!g||g.validate!==!1)&&Eg(this,n.call($l,{key:s,layerType:this.type,objectKey:u,value:p,styleSpec:me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof M&&Os(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ba(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const UF=_e([{name:"a_pos",components:2,type:"Int16"}],4),NF=_e([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"},{name:"a_scale",components:1,type:"Float32"}]);class Di{constructor(n=[]){this.segments=n}prepareSegment(n,s,u,p){let g=this.segments[this.segments.length-1];return n>Di.MAX_VERTEX_ARRAY_LENGTH&&pe(`Max vertices per segment is ${Di.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!g||g.vertexLength+n>Di.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==p)&&(g={vertexOffset:s.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},p!==void 0&&(g.sortKey=p),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,u,p){return new Di([{vertexOffset:n,primitiveOffset:s,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}Di.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qt(Di,"SegmentVector");var Bn=8192;class Qs{constructor(n,s){n&&(s?this.setSouthWest(n).setNorthEast(s):n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1]))}setNorthEast(n){return this._ne=n instanceof ai?new ai(n.lng,n.lat):ai.convert(n),this}setSouthWest(n){return this._sw=n instanceof ai?new ai(n.lng,n.lat):ai.convert(n),this}extend(n){const s=this._sw,u=this._ne;let p,g;if(n instanceof ai)p=n,g=n;else{if(!(n instanceof Qs))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Qs.convert(n)):this.extend(ai.convert(n)):this;if(p=n._sw,g=n._ne,!p||!g)return this}return s||u?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new ai(p.lng,p.lat),this._ne=new ai(g.lng,g.lat)),this}getCenter(){return new ai((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ai(this.getWest(),this.getNorth())}getSouthEast(){return new ai(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:u}=ai.convert(n);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(n){return!n||n instanceof Qs?n:new Qs(n)}}const ev=63710088e-1;class ai{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ai(fe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,u=this.lat*s,p=n.lat*s,g=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((n.lng-this.lng)*s);return ev*Math.acos(Math.min(g,1))}toBounds(n=0){const s=360*n/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new Qs(new ai(this.lng-u,this.lat-s),new ai(this.lng+u,this.lat+s))}static convert(n){if(n instanceof ai)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new ai(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new ai(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const rA=2*Math.PI*ev;function tv(a){return rA*Math.cos(a*Math.PI/180)}function Pp(a){return(180+a)/360}function ah(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function sh(a,n){return a/tv(n)}function Io(a){return 360*a-180}function hr(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function oA(a,n){return a*tv(hr(n))}const Ea=85.051129;class Kg{constructor(n,s,u=0){this.x=+n,this.y=+s,this.z=+u}static fromLngLat(n,s=0){const u=ai.convert(n);return new Kg(Pp(u.lng),ah(u.lat),sh(s,u.lat))}toLngLat(){return new ai(Io(this.x),hr(this.y))}toAltitude(){return oA(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rA*(n=hr(this.y),1/Math.cos(n*Math.PI/180));var n}}function nv(a,n,s,u,p,g,x,A,T){const D=(n+u)/2,k=(s+p)/2,z=new b(D,k);A(z),function(N,H,K,te,ae,he){const Pe=K-ae,Be=te-he;return Math.abs((te-H)*Pe-(K-N)*Be)/Math.hypot(Pe,Be)}(z.x,z.y,g.x,g.y,x.x,x.y)>=T?(nv(a,n,s,D,k,g,z,A,T),nv(a,D,k,u,p,z,x,A,T)):a.push(x)}function VF(a,n,s){let u=a[0],p=u.x,g=u.y;n(u);const x=[u];for(let A=1;A<a.length;A++){const T=a[A],{x:D,y:k}=T;n(T),nv(x,p,g,D,k,u,T,n,s),p=D,g=k,u=T}return x}const iv=Math.pow(2,14)-1,aA=-iv-1;function OF(a,n){const s=Math.round(a.x*n),u=Math.round(a.y*n);return a.x=oe(s,aA,iv),a.y=oe(u,aA,iv),(s<a.x||s>a.x+1||u<a.y||u>a.y+1)&&pe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function as(a,n,s){const u=a.loadGeometry(),p=a.extent,g=Bn/p;if(n&&s&&s.projection.isReprojectedInTileSpace){const x=1<<n.z,{scale:A,x:T,y:D,projection:k}=s,z=N=>{const H=Io((n.x+N.x/p)/x),K=hr((n.y+N.y/p)/x),te=k.project(H,K);N.x=(te.x*A-T)*p,N.y=(te.y*A-D)*p};for(let N=0;N<u.length;N++)if(a.type!==1)u[N]=VF(u[N],z,1);else{const H=[];for(const K of u[N])K.x<0||K.x>=p||K.y<0||K.y>=p||(z(K),H.push(K));u[N]=H}}for(const x of u)for(const A of x)OF(A,g);return u}function cc(a,n){return{type:a.type,id:a.id,properties:a.properties,geometry:n?as(a):[]}}function Zg(a,n,s,u,p){a.emplaceBack(2*n+(u+1)/2,2*s+(p+1)/2)}function Jg(a,n,s,u){a.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384,u)}class rv{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new ye,this.indexArray=new Yt,this.segments=new Di,this.programConfigurations=new lc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,u,p){const g=this.layers[0],x=[];let A=null;g.type==="circle"&&(A=g.layout.get("circle-sort-key"));for(const{feature:D,id:k,index:z,sourceLayerIndex:N}of n){const H=this.layers[0]._featureFilter.needGeometry,K=cc(D,H);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),K,u))continue;const te=A?A.evaluate(K,{},u):void 0,ae={id:k,properties:D.properties,type:D.type,sourceLayerIndex:N,index:z,geometry:H?K.geometry:as(D,u,p),patterns:{},sortKey:te};x.push(ae)}A&&x.sort((D,k)=>D.sortKey-k.sortKey);let T=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new is,T=p.projection);for(const D of x){const{geometry:k,index:z,sourceLayerIndex:N}=D,H=n[z].feature;this.addFeature(D,k,z,s.availableImages,u,T),s.featureIndex.insert(H,k,z,N,this.index)}}update(n,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,UF.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,NF.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,u,p,g,x){for(const A of s)for(const T of A){const D=T.x,k=T.y;if(D<0||D>=Bn||k<0||k>=Bn)continue;if(x){const H=x.projectTilePoint(D,k,g),K=x.upVector(g,D,k),te=hr((k/Bn+g.y)/(1<<g.z)),ae=x.pixelsPerMeter(te,1)/sh(1,te),he=this.globeExtVertexArray;Jg(he,H,K,ae),Jg(he,H,K,ae),Jg(he,H,K,ae),Jg(he,H,K,ae)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),N=z.vertexLength;Zg(this.layoutVertexArray,D,k,-1,-1),Zg(this.layoutVertexArray,D,k,1,-1),Zg(this.layoutVertexArray,D,k,1,1),Zg(this.layoutVertexArray,D,k,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},p,g)}}function sA(a,n){for(let s=0;s<a.length;s++)if(lh(n,a[s]))return!0;for(let s=0;s<n.length;s++)if(lh(a,n[s]))return!0;return!!ov(a,n)}function GF(a,n,s){return!!lh(a,n)||!!av(n,a,s)}function lA(a,n){if(a.length===1)return uA(n,a[0]);for(let s=0;s<n.length;s++){const u=n[s];for(let p=0;p<u.length;p++)if(lh(a,u[p]))return!0}for(let s=0;s<a.length;s++)if(uA(n,a[s]))return!0;for(let s=0;s<n.length;s++)if(ov(a,n[s]))return!0;return!1}function jF(a,n,s){if(a.length>1){if(ov(a,n))return!0;for(let u=0;u<n.length;u++)if(av(n[u],a,s))return!0}for(let u=0;u<a.length;u++)if(av(a[u],n,s))return!0;return!1}function ov(a,n){if(a.length===0||n.length===0)return!1;for(let s=0;s<a.length-1;s++){const u=a[s],p=a[s+1];for(let g=0;g<n.length-1;g++)if(HF(u,p,n[g],n[g+1]))return!0}return!1}function HF(a,n,s,u){return ke(a,s,u)!==ke(n,s,u)&&ke(a,n,s)!==ke(a,n,u)}function av(a,n,s){const u=s*s;if(n.length===1)return a.distSqr(n[0])<u;for(let p=1;p<n.length;p++)if(cA(a,n[p-1],n[p])<u)return!0;return!1}function cA(a,n,s){const u=n.distSqr(s);if(u===0)return a.distSqr(n);const p=((a.x-n.x)*(s.x-n.x)+(a.y-n.y)*(s.y-n.y))/u;return a.distSqr(p<0?n:p>1?s:s.sub(n)._mult(p)._add(n))}function uA(a,n){let s,u,p,g=!1;for(let x=0;x<a.length;x++){s=a[x];for(let A=0,T=s.length-1;A<s.length;T=A++)u=s[A],p=s[T],u.y>n.y!=p.y>n.y&&n.x<(p.x-u.x)*(n.y-u.y)/(p.y-u.y)+u.x&&(g=!g)}return g}function lh(a,n){let s=!1;for(let u=0,p=a.length-1;u<a.length;p=u++){const g=a[u],x=a[p];g.y>n.y!=x.y>n.y&&n.x<(x.x-g.x)*(n.y-g.y)/(x.y-g.y)+g.x&&(s=!s)}return s}function hA(a,n,s,u,p){for(const x of a)if(n<=x.x&&s<=x.y&&u>=x.x&&p>=x.y)return!0;const g=[new b(n,s),new b(n,p),new b(u,p),new b(u,s)];if(a.length>2){for(const x of g)if(lh(a,x))return!0}for(let x=0;x<a.length-1;x++)if(WF(a[x],a[x+1],g))return!0;return!1}function WF(a,n,s){const u=s[0],p=s[2];if(a.x<u.x&&n.x<u.x||a.x>p.x&&n.x>p.x||a.y<u.y&&n.y<u.y||a.y>p.y&&n.y>p.y)return!1;const g=ke(a,n,s[0]);return g!==ke(a,n,s[1])||g!==ke(a,n,s[2])||g!==ke(a,n,s[3])}function ch(a,n,s){const u=n.paint.get(a).value;return u.kind==="constant"?u.value:s.programConfigurations.get(n.id).getMaxValue(a)}function Qg(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function dA(a,n,s,u,p){if(!n[0]&&!n[1])return a;const g=b.convert(n)._mult(p);s==="viewport"&&g._rotate(-u);const x=[];for(let A=0;A<a.length;A++)x.push(a[A].sub(g));return x}function pA(a,n,s,u){const p=b.convert(a)._mult(u);return n==="viewport"&&p._rotate(-s),p}qt(rv,"CircleBucket",{omit:["layers"]});const qF=new Y({"circle-sort-key":new L(me.layout_circle["circle-sort-key"])});var YF={paint:new Y({"circle-radius":new L(me.paint_circle["circle-radius"]),"circle-color":new L(me.paint_circle["circle-color"]),"circle-blur":new L(me.paint_circle["circle-blur"]),"circle-opacity":new L(me.paint_circle["circle-opacity"]),"circle-translate":new C(me.paint_circle["circle-translate"]),"circle-translate-anchor":new C(me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new C(me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new C(me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new L(me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new L(me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new L(me.paint_circle["circle-stroke-opacity"])}),layout:qF},sv=1e-6,to=typeof Float32Array!="undefined"?Float32Array:Array;function fA(){var a=new to(9);return to!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Pa(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function lv(a,n,s){var u=n[0],p=n[1],g=n[2],x=n[3],A=n[4],T=n[5],D=n[6],k=n[7],z=n[8],N=n[9],H=n[10],K=n[11],te=n[12],ae=n[13],he=n[14],Pe=n[15],Be=s[0],Oe=s[1],qe=s[2],Ye=s[3];return a[0]=Be*u+Oe*A+qe*z+Ye*te,a[1]=Be*p+Oe*T+qe*N+Ye*ae,a[2]=Be*g+Oe*D+qe*H+Ye*he,a[3]=Be*x+Oe*k+qe*K+Ye*Pe,a[4]=(Be=s[4])*u+(Oe=s[5])*A+(qe=s[6])*z+(Ye=s[7])*te,a[5]=Be*p+Oe*T+qe*N+Ye*ae,a[6]=Be*g+Oe*D+qe*H+Ye*he,a[7]=Be*x+Oe*k+qe*K+Ye*Pe,a[8]=(Be=s[8])*u+(Oe=s[9])*A+(qe=s[10])*z+(Ye=s[11])*te,a[9]=Be*p+Oe*T+qe*N+Ye*ae,a[10]=Be*g+Oe*D+qe*H+Ye*he,a[11]=Be*x+Oe*k+qe*K+Ye*Pe,a[12]=(Be=s[12])*u+(Oe=s[13])*A+(qe=s[14])*z+(Ye=s[15])*te,a[13]=Be*p+Oe*T+qe*N+Ye*ae,a[14]=Be*g+Oe*D+qe*H+Ye*he,a[15]=Be*x+Oe*k+qe*K+Ye*Pe,a}function uc(a,n,s){var u,p,g,x,A,T,D,k,z,N,H,K,te=s[0],ae=s[1],he=s[2];return n===a?(a[12]=n[0]*te+n[4]*ae+n[8]*he+n[12],a[13]=n[1]*te+n[5]*ae+n[9]*he+n[13],a[14]=n[2]*te+n[6]*ae+n[10]*he+n[14],a[15]=n[3]*te+n[7]*ae+n[11]*he+n[15]):(p=n[1],g=n[2],x=n[3],A=n[4],T=n[5],D=n[6],k=n[7],z=n[8],N=n[9],H=n[10],K=n[11],a[0]=u=n[0],a[1]=p,a[2]=g,a[3]=x,a[4]=A,a[5]=T,a[6]=D,a[7]=k,a[8]=z,a[9]=N,a[10]=H,a[11]=K,a[12]=u*te+A*ae+z*he+n[12],a[13]=p*te+T*ae+N*he+n[13],a[14]=g*te+D*ae+H*he+n[14],a[15]=x*te+k*ae+K*he+n[15]),a}function $s(a,n,s){var u=s[0],p=s[1],g=s[2];return a[0]=n[0]*u,a[1]=n[1]*u,a[2]=n[2]*u,a[3]=n[3]*u,a[4]=n[4]*p,a[5]=n[5]*p,a[6]=n[6]*p,a[7]=n[7]*p,a[8]=n[8]*g,a[9]=n[9]*g,a[10]=n[10]*g,a[11]=n[11]*g,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}function cv(a,n,s){var u=Math.sin(s),p=Math.cos(s),g=n[4],x=n[5],A=n[6],T=n[7],D=n[8],k=n[9],z=n[10],N=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=g*p+D*u,a[5]=x*p+k*u,a[6]=A*p+z*u,a[7]=T*p+N*u,a[8]=D*p-g*u,a[9]=k*p-x*u,a[10]=z*p-A*u,a[11]=N*p-T*u,a}function uv(a,n,s){var u=Math.sin(s),p=Math.cos(s),g=n[0],x=n[1],A=n[2],T=n[3],D=n[8],k=n[9],z=n[10],N=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=g*p-D*u,a[1]=x*p-k*u,a[2]=A*p-z*u,a[3]=T*p-N*u,a[8]=g*u+D*p,a[9]=x*u+k*p,a[10]=A*u+z*p,a[11]=T*u+N*p,a}Math.hypot||(Math.hypot=function(){for(var a=0,n=arguments.length;n--;)a+=arguments[n]*arguments[n];return Math.sqrt(a)});var XF=lv;function hv(){var a=new to(3);return to!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function mA(a){var n=new to(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}function gA(a){return Math.hypot(a[0],a[1],a[2])}function Cp(a,n,s){var u=new to(3);return u[0]=a,u[1]=n,u[2]=s,u}function yA(a,n,s){return a[0]=n[0]+s[0],a[1]=n[1]+s[1],a[2]=n[2]+s[2],a}function xA(a,n,s){return a[0]=n[0]-s[0],a[1]=n[1]-s[1],a[2]=n[2]-s[2],a}function vA(a,n,s){return a[0]=n[0]*s[0],a[1]=n[1]*s[1],a[2]=n[2]*s[2],a}function dv(a,n,s){return a[0]=Math.min(n[0],s[0]),a[1]=Math.min(n[1],s[1]),a[2]=Math.min(n[2],s[2]),a}function pv(a,n,s){return a[0]=Math.max(n[0],s[0]),a[1]=Math.max(n[1],s[1]),a[2]=Math.max(n[2],s[2]),a}function Rp(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a}function fv(a,n,s,u){return a[0]=n[0]+s[0]*u,a[1]=n[1]+s[1]*u,a[2]=n[2]+s[2]*u,a}function Dp(a,n){var s=n[0],u=n[1],p=n[2],g=s*s+u*u+p*p;return g>0&&(g=1/Math.sqrt(g)),a[0]=n[0]*g,a[1]=n[1]*g,a[2]=n[2]*g,a}function Ip(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}function _A(a,n,s){var u=n[0],p=n[1],g=n[2],x=s[0],A=s[1],T=s[2];return a[0]=p*T-g*A,a[1]=g*x-u*T,a[2]=u*A-p*x,a}function hc(a,n,s){var u=n[0],p=n[1],g=n[2],x=s[3]*u+s[7]*p+s[11]*g+s[15];return a[0]=(s[0]*u+s[4]*p+s[8]*g+s[12])/(x=x||1),a[1]=(s[1]*u+s[5]*p+s[9]*g+s[13])/x,a[2]=(s[2]*u+s[6]*p+s[10]*g+s[14])/x,a}function bA(a,n,s){var u=s[0],p=s[1],g=s[2],x=n[0],A=n[1],T=n[2],D=p*T-g*A,k=g*x-u*T,z=u*A-p*x,N=p*z-g*k,H=g*D-u*z,K=u*k-p*D,te=2*s[3];return k*=te,z*=te,H*=2,K*=2,a[0]=x+(D*=te)+(N*=2),a[1]=A+k+H,a[2]=T+z+K,a}var Lp,uh=xA,KF=vA,ZF=gA;function hh(a,n,s){var u=n[0],p=n[1],g=n[2],x=n[3];return a[0]=s[0]*u+s[4]*p+s[8]*g+s[12]*x,a[1]=s[1]*u+s[5]*p+s[9]*g+s[13]*x,a[2]=s[2]*u+s[6]*p+s[10]*g+s[14]*x,a[3]=s[3]*u+s[7]*p+s[11]*g+s[15]*x,a}function wA(){var a=new to(4);return to!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function AA(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function MA(a,n,s){s*=.5;var u=n[0],p=n[1],g=n[2],x=n[3],A=Math.sin(s),T=Math.cos(s);return a[0]=u*T+x*A,a[1]=p*T+g*A,a[2]=g*T-p*A,a[3]=x*T-u*A,a}hv(),Lp=new to(4),to!=Float32Array&&(Lp[0]=0,Lp[1]=0,Lp[2]=0,Lp[3]=0),hv(),Cp(1,0,0),Cp(0,1,0),wA(),wA(),fA();class mv{constructor(n,s){this.points=n,this.planes=s}static fromInvProjectionMatrix(n,s,u,p){const g=Math.pow(2,u),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const D=hh([],T,n),k=1/D[3]/s*g;return function(z,N,H){return z[0]=N[0]*H[0],z[1]=N[1]*H[1],z[2]=N[2]*H[2],z[3]=N[3]*H[3],z}(D,D,[k,k,p?1/D[3]:k,k])}),A=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const D=Dp([],_A([],uh([],x[T[0]],x[T[1]]),uh([],x[T[2]],x[T[1]]))),k=-Ip(D,x[T[1]]);return D.concat(k)});return new mv(x,A)}}class wo{constructor(n,s){this.min=n,this.max=s,this.center=Rp([],yA([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],u=mA(this.min),p=mA(this.max);for(let g=0;g<s.length;g++)u[g]=s[g]?this.min[g]:this.center[g],p[g]=s[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new wo(u,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){const s=this.getCorners();let u=!0;for(let p=0;p<n.planes.length;p++){const g=n.planes[p];let x=0;for(let A=0;A<s.length;A++)x+=Ip(g,s[A])+g[3]>=0;if(x===0)return 0;x!==s.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let A=0;A<n.points.length;A++){const T=n.points[A][p]-this.min[p];g=Math.min(g,T),x=Math.max(x,T)}if(x<0||g>this.max[p]-this.min[p])return 0}return 1}}function SA(a,n,s,u,p,g,x,A,T){if(g&&a.queryGeometry.isAboveHorizon)return!1;g&&(T*=a.pixelToTileUnitsFactor);for(const D of n)for(const k of D){const z=k.add(A),N=p&&s.elevation?s.elevation.exaggeration()*p.getElevationAt(z.x,z.y,!0):0,H=g?z:JF(z,N,u),K=g?a.tilespaceRays.map(ae=>$F(ae,N)):a.queryGeometry.screenGeometry,te=hh([],[k.x,k.y,N,1],u);if(!x&&g?T*=te[3]/s.cameraToCenterDistance:x&&!g&&(T*=s.cameraToCenterDistance/te[3]),GF(K,H,T))return!0}return!1}function JF(a,n,s){const u=hh([],[a.x,a.y,n,1],s);return new b(u[0]/u[3],u[1]/u[3])}const TA=Cp(0,0,0),QF=Cp(0,0,1);function $F(a,n){const s=hv();return TA[2]=n,a.intersectsPlane(TA,QF,s),new b(s[0],s[1])}class EA extends rv{}function PA(a,{width:n,height:s},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*s*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(n*s*u);return a.width=n,a.height=s,a.data=p,a}function CA(a,n,s){const{width:u,height:p}=n;u===a.width&&p===a.height||(gv(a,n,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,u),height:Math.min(a.height,p)},s),a.width=u,a.height=p,a.data=n.data)}function gv(a,n,s,u,p,g){if(p.width===0||p.height===0)return n;if(p.width>a.width||p.height>a.height||s.x>a.width-p.width||s.y>a.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||u.x>n.width-p.width||u.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,A=n.data;for(let T=0;T<p.height;T++){const D=((s.y+T)*a.width+s.x)*g,k=((u.y+T)*n.width+u.x)*g;for(let z=0;z<p.width*g;z++)A[k+z]=x[D+z]}return n}qt(EA,"HeatmapBucket",{omit:["layers"]});class ss{constructor(n,s){PA(this,n,1,s)}resize(n){CA(this,new ss(n),1)}clone(){return new ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,p,g){gv(n,s,u,p,g,1)}}class no{constructor(n,s){PA(this,n,4,s)}resize(n){CA(this,new no(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new no({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,p,g){gv(n,s,u,p,g,4)}}qt(ss,"AlphaImage"),qt(no,"RGBAImage");var ek={paint:new Y({"heatmap-radius":new L(me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new L(me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new C(me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new j(me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new C(me.paint_heatmap["heatmap-opacity"])})};function yv(a){const n={},s=a.resolution||256,u=a.clips?a.clips.length:1,p=a.image||new no({width:s,height:u}),g=(x,A,T)=>{n[a.evaluationKey]=T;const D=a.expression.evaluate(n);p.data[x+A+0]=Math.floor(255*D.r/D.a),p.data[x+A+1]=Math.floor(255*D.g/D.a),p.data[x+A+2]=Math.floor(255*D.b/D.a),p.data[x+A+3]=Math.floor(255*D.a)};if(a.clips)for(let x=0,A=0;x<u;++x,A+=4*s)for(let T=0,D=0;T<s;T++,D+=4){const k=T/(s-1),{start:z,end:N}=a.clips[x];g(A,D,z*(1-k)+N*k)}else for(let x=0,A=0;x<s;x++,A+=4)g(0,A,x/(s-1));return p}var tk={paint:new Y({"hillshade-illumination-direction":new C(me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new C(me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new C(me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new C(me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new C(me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new C(me.paint_hillshade["hillshade-accent-color"])})};const nk=_e([{name:"a_pos",components:2,type:"Int16"}],4),{members:ik}=nk;var $g=ey,rk=ey;function ey(a,n,s){s=s||2;var u,p,g,x,A,T,D,k=n&&n.length,z=k?n[0]*s:a.length,N=RA(a,0,z,s,!0),H=[];if(!N||N.next===N.prev)return H;if(k&&(N=function(te,ae,he,Pe){var Be,Oe,qe,Ye=[];for(Be=0,Oe=ae.length;Be<Oe;Be++)(qe=RA(te,ae[Be]*Pe,Be<Oe-1?ae[Be+1]*Pe:te.length,Pe,!1))===qe.next&&(qe.steiner=!0),Ye.push(dk(qe));for(Ye.sort(ck),Be=0;Be<Ye.length;Be++)he=el(he=uk(Ye[Be],he),he.next);return he}(a,n,N,s)),a.length>80*s){u=g=a[0],p=x=a[1];for(var K=s;K<z;K+=s)(A=a[K])<u&&(u=A),(T=a[K+1])<p&&(p=T),A>g&&(g=A),T>x&&(x=T);D=(D=Math.max(g-u,x-p))!==0?1/D:0}return Fp(N,H,s,u,p,D),H}function RA(a,n,s,u,p){var g,x;if(p===_v(a,n,s,u)>0)for(g=n;g<s;g+=u)x=LA(g,a[g],a[g+1],x);else for(g=s-u;g>=n;g-=u)x=LA(g,a[g],a[g+1],x);return x&&ty(x,x.next)&&(Bp(x),x=x.next),x}function el(a,n){if(!a)return a;n||(n=a);var s,u=a;do if(s=!1,u.steiner||!ty(u,u.next)&&Ui(u.prev,u,u.next)!==0)u=u.next;else{if(Bp(u),(u=n=u.prev)===u.next)break;s=!0}while(s||u!==n);return n}function Fp(a,n,s,u,p,g,x){if(a){!x&&g&&function(k,z,N,H){var K=k;do K.z===null&&(K.z=xv(K.x,K.y,z,N,H)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==k);K.prevZ.nextZ=null,K.prevZ=null,function(te){var ae,he,Pe,Be,Oe,qe,Ye,st,ut=1;do{for(he=te,te=null,Oe=null,qe=0;he;){for(qe++,Pe=he,Ye=0,ae=0;ae<ut&&(Ye++,Pe=Pe.nextZ);ae++);for(st=ut;Ye>0||st>0&&Pe;)Ye!==0&&(st===0||!Pe||he.z<=Pe.z)?(Be=he,he=he.nextZ,Ye--):(Be=Pe,Pe=Pe.nextZ,st--),Oe?Oe.nextZ=Be:te=Be,Be.prevZ=Oe,Oe=Be;he=Pe}Oe.nextZ=null,ut*=2}while(qe>1)}(K)}(a,u,p,g);for(var A,T,D=a;a.prev!==a.next;)if(A=a.prev,T=a.next,g?ak(a,u,p,g):ok(a))n.push(A.i/s),n.push(a.i/s),n.push(T.i/s),Bp(a),a=T.next,D=T.next;else if((a=T)===D){x?x===1?Fp(a=sk(el(a),n,s),n,s,u,p,g,2):x===2&&lk(a,n,s,u,p,g):Fp(el(a),n,s,u,p,g,1);break}}}function ok(a){var n=a.prev,s=a,u=a.next;if(Ui(n,s,u)>=0)return!1;for(var p=a.next.next;p!==a.prev;){if(dh(n.x,n.y,s.x,s.y,u.x,u.y,p.x,p.y)&&Ui(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function ak(a,n,s,u){var p=a.prev,g=a,x=a.next;if(Ui(p,g,x)>=0)return!1;for(var A=p.x>g.x?p.x>x.x?p.x:x.x:g.x>x.x?g.x:x.x,T=p.y>g.y?p.y>x.y?p.y:x.y:g.y>x.y?g.y:x.y,D=xv(p.x<g.x?p.x<x.x?p.x:x.x:g.x<x.x?g.x:x.x,p.y<g.y?p.y<x.y?p.y:x.y:g.y<x.y?g.y:x.y,n,s,u),k=xv(A,T,n,s,u),z=a.prevZ,N=a.nextZ;z&&z.z>=D&&N&&N.z<=k;){if(z!==a.prev&&z!==a.next&&dh(p.x,p.y,g.x,g.y,x.x,x.y,z.x,z.y)&&Ui(z.prev,z,z.next)>=0||(z=z.prevZ,N!==a.prev&&N!==a.next&&dh(p.x,p.y,g.x,g.y,x.x,x.y,N.x,N.y)&&Ui(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;z&&z.z>=D;){if(z!==a.prev&&z!==a.next&&dh(p.x,p.y,g.x,g.y,x.x,x.y,z.x,z.y)&&Ui(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;N&&N.z<=k;){if(N!==a.prev&&N!==a.next&&dh(p.x,p.y,g.x,g.y,x.x,x.y,N.x,N.y)&&Ui(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function sk(a,n,s){var u=a;do{var p=u.prev,g=u.next.next;!ty(p,g)&&DA(p,u,u.next,g)&&kp(p,g)&&kp(g,p)&&(n.push(p.i/s),n.push(u.i/s),n.push(g.i/s),Bp(u),Bp(u.next),u=a=g),u=u.next}while(u!==a);return el(u)}function lk(a,n,s,u,p,g){var x=a;do{for(var A=x.next.next;A!==x.prev;){if(x.i!==A.i&&pk(x,A)){var T=IA(x,A);return x=el(x,x.next),T=el(T,T.next),Fp(x,n,s,u,p,g),void Fp(T,n,s,u,p,g)}A=A.next}x=x.next}while(x!==a)}function ck(a,n){return a.x-n.x}function uk(a,n){var s=function(g,x){var A,T=x,D=g.x,k=g.y,z=-1/0;do{if(k<=T.y&&k>=T.next.y&&T.next.y!==T.y){var N=T.x+(k-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(N<=D&&N>z){if(z=N,N===D){if(k===T.y)return T;if(k===T.next.y)return T.next}A=T.x<T.next.x?T:T.next}}T=T.next}while(T!==x);if(!A)return null;if(D===z)return A;var H,K=A,te=A.x,ae=A.y,he=1/0;T=A;do D>=T.x&&T.x>=te&&D!==T.x&&dh(k<ae?D:z,k,te,ae,k<ae?z:D,k,T.x,T.y)&&(H=Math.abs(k-T.y)/(D-T.x),kp(T,g)&&(H<he||H===he&&(T.x>A.x||T.x===A.x&&hk(A,T)))&&(A=T,he=H)),T=T.next;while(T!==K);return A}(a,n);if(!s)return n;var u=IA(s,a),p=el(s,s.next);return el(u,u.next),n===s?p:n}function hk(a,n){return Ui(a.prev,a,n.prev)<0&&Ui(n.next,a,a.next)<0}function xv(a,n,s,u,p){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-s)*p)|a<<8))|a<<4))|a<<2))|a<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-u)*p)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function dk(a){var n=a,s=a;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==a);return s}function dh(a,n,s,u,p,g,x,A){return(p-x)*(n-A)-(a-x)*(g-A)>=0&&(a-x)*(u-A)-(s-x)*(n-A)>=0&&(s-x)*(g-A)-(p-x)*(u-A)>=0}function pk(a,n){return a.next.i!==n.i&&a.prev.i!==n.i&&!function(s,u){var p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==u.i&&p.next.i!==u.i&&DA(p,p.next,s,u))return!0;p=p.next}while(p!==s);return!1}(a,n)&&(kp(a,n)&&kp(n,a)&&function(s,u){var p=s,g=!1,x=(s.x+u.x)/2,A=(s.y+u.y)/2;do p.y>A!=p.next.y>A&&p.next.y!==p.y&&x<(p.next.x-p.x)*(A-p.y)/(p.next.y-p.y)+p.x&&(g=!g),p=p.next;while(p!==s);return g}(a,n)&&(Ui(a.prev,a,n.prev)||Ui(a,n.prev,n))||ty(a,n)&&Ui(a.prev,a,a.next)>0&&Ui(n.prev,n,n.next)>0)}function Ui(a,n,s){return(n.y-a.y)*(s.x-n.x)-(n.x-a.x)*(s.y-n.y)}function ty(a,n){return a.x===n.x&&a.y===n.y}function DA(a,n,s,u){var p=iy(Ui(a,n,s)),g=iy(Ui(a,n,u)),x=iy(Ui(s,u,a)),A=iy(Ui(s,u,n));return p!==g&&x!==A||!(p!==0||!ny(a,s,n))||!(g!==0||!ny(a,u,n))||!(x!==0||!ny(s,a,u))||!(A!==0||!ny(s,n,u))}function ny(a,n,s){return n.x<=Math.max(a.x,s.x)&&n.x>=Math.min(a.x,s.x)&&n.y<=Math.max(a.y,s.y)&&n.y>=Math.min(a.y,s.y)}function iy(a){return a>0?1:a<0?-1:0}function kp(a,n){return Ui(a.prev,a,a.next)<0?Ui(a,n,a.next)>=0&&Ui(a,a.prev,n)>=0:Ui(a,n,a.prev)<0||Ui(a,a.next,n)<0}function IA(a,n){var s=new vv(a.i,a.x,a.y),u=new vv(n.i,n.x,n.y),p=a.next,g=n.prev;return a.next=n,n.prev=a,s.next=p,p.prev=s,u.next=s,s.prev=u,g.next=u,u.prev=g,u}function LA(a,n,s,u){var p=new vv(a,n,s);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Bp(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function vv(a,n,s){this.i=a,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _v(a,n,s,u){for(var p=0,g=n,x=s-u;g<s;g+=u)p+=(a[x]-a[g])*(a[g+1]+a[x+1]),x=g;return p}function fk(a,n,s,u,p){FA(a,n,s||0,u||a.length-1,p||mk)}function FA(a,n,s,u,p){for(;u>s;){if(u-s>600){var g=u-s+1,x=n-s+1,A=Math.log(g),T=.5*Math.exp(2*A/3),D=.5*Math.sqrt(A*T*(g-T)/g)*(x-g/2<0?-1:1);FA(a,n,Math.max(s,Math.floor(n-x*T/g+D)),Math.min(u,Math.floor(n+(g-x)*T/g+D)),p)}var k=a[n],z=s,N=u;for(zp(a,s,n),p(a[u],k)>0&&zp(a,s,u);z<N;){for(zp(a,z,N),z++,N--;p(a[z],k)<0;)z++;for(;p(a[N],k)>0;)N--}p(a[s],k)===0?zp(a,s,N):zp(a,++N,u),N<=n&&(s=N+1),n<=N&&(u=N-1)}}function zp(a,n,s){var u=a[n];a[n]=a[s],a[s]=u}function mk(a,n){return a<n?-1:a>n?1:0}function bv(a,n){const s=a.length;if(s<=1)return[a];const u=[];let p,g;for(let x=0;x<s;x++){const A=De(a[x]);A!==0&&(a[x].area=Math.abs(A),g===void 0&&(g=A<0),g===A<0?(p&&u.push(p),p=[a[x]]):p.push(a[x]))}if(p&&u.push(p),n>1)for(let x=0;x<u.length;x++)u[x].length<=n||(fk(u[x],n,1,u[x].length-1,gk),u[x]=u[x].slice(0,n));return u}function gk(a,n){return n.area-a.area}function wv(a,n,s){const u=s.patternDependencies;let p=!1;for(const g of n){const x=g.paint.get(`${a}-pattern`);x.isConstant()||(p=!0);const A=x.constantOr(null);A&&(p=!0,u[A.to]=!0,u[A.from]=!0)}return p}function Av(a,n,s,u,p){const g=p.patternDependencies;for(const x of n){const A=x.paint.get(`${a}-pattern`).value;if(A.kind!=="constant"){let T=A.evaluate({zoom:u-1},s,{},p.availableImages),D=A.evaluate({zoom:u},s,{},p.availableImages),k=A.evaluate({zoom:u+1},s,{},p.availableImages);T=T&&T.name?T.name:T,D=D&&D.name?D.name:D,k=k&&k.name?k.name:k,g[T]=!0,g[D]=!0,g[k]=!0,s.patterns[x.id]={min:T,mid:D,max:k}}}return s}ey.deviation=function(a,n,s,u){var p=n&&n.length,g=Math.abs(_v(a,0,p?n[0]*s:a.length,s));if(p)for(var x=0,A=n.length;x<A;x++)g-=Math.abs(_v(a,n[x]*s,x<A-1?n[x+1]*s:a.length,s));var T=0;for(x=0;x<u.length;x+=3){var D=u[x]*s,k=u[x+1]*s,z=u[x+2]*s;T+=Math.abs((a[D]-a[z])*(a[k+1]-a[D+1])-(a[D]-a[k])*(a[z+1]-a[D+1]))}return g===0&&T===0?0:Math.abs((T-g)/g)},ey.flatten=function(a){for(var n=a[0][0].length,s={vertices:[],holes:[],dimensions:n},u=0,p=0;p<a.length;p++){for(var g=0;g<a[p].length;g++)for(var x=0;x<n;x++)s.vertices.push(a[p][g][x]);p>0&&s.holes.push(u+=a[p-1].length)}return s},$g.default=rk;class ry{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ye,this.indexArray=new Yt,this.indexArray2=new Sn,this.programConfigurations=new lc(n.layers,n.zoom),this.segments=new Di,this.segments2=new Di,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}populate(n,s,u,p){this.hasPattern=wv("fill",this.layers,s);const g=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:A,id:T,index:D,sourceLayerIndex:k}of n){const z=this.layers[0]._featureFilter.needGeometry,N=cc(A,z);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),N,u))continue;const H=g?g.evaluate(N,{},u,s.availableImages):void 0,K={id:T,properties:A.properties,type:A.type,sourceLayerIndex:k,index:D,geometry:z?N.geometry:as(A,u,p),patterns:{},sortKey:H};x.push(K)}g&&x.sort((A,T)=>A.sortKey-T.sortKey);for(const A of x){const{geometry:T,index:D,sourceLayerIndex:k}=A;if(this.hasPattern){const z=Av("fill",this.layers,A,this.zoom,s);this.patternFeatures.push(z)}else this.addFeature(A,T,D,u,{},s.availableImages);s.featureIndex.insert(n[D].feature,T,D,k,this.index)}}update(n,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u,p)}addFeatures(n,s,u,p,g){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ik),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,u,p,g,x=[]){for(const A of bv(s,500)){let T=0;for(const K of A)T+=K.length;const D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),k=D.vertexLength,z=[],N=[];for(const K of A){if(K.length===0)continue;K!==A[0]&&N.push(z.length/2);const te=this.segments2.prepareSegment(K.length,this.layoutVertexArray,this.indexArray2),ae=te.vertexLength;this.layoutVertexArray.emplaceBack(K[0].x,K[0].y),this.indexArray2.emplaceBack(ae+K.length-1,ae),z.push(K[0].x),z.push(K[0].y);for(let he=1;he<K.length;he++)this.layoutVertexArray.emplaceBack(K[he].x,K[he].y),this.indexArray2.emplaceBack(ae+he-1,ae+he),z.push(K[he].x),z.push(K[he].y);te.vertexLength+=K.length,te.primitiveLength+=K.length}const H=$g(z,N);for(let K=0;K<H.length;K+=3)this.indexArray.emplaceBack(k+H[K],k+H[K+1],k+H[K+2]);D.vertexLength+=T,D.primitiveLength+=H.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,g,x,p)}}qt(ry,"FillBucket",{omit:["layers","patternFeatures"]});const yk=new Y({"fill-sort-key":new L(me.layout_fill["fill-sort-key"])});var xk={paint:new Y({"fill-antialias":new C(me.paint_fill["fill-antialias"]),"fill-opacity":new L(me.paint_fill["fill-opacity"]),"fill-color":new L(me.paint_fill["fill-color"]),"fill-outline-color":new L(me.paint_fill["fill-outline-color"]),"fill-translate":new C(me.paint_fill["fill-translate"]),"fill-translate-anchor":new C(me.paint_fill["fill-translate-anchor"]),"fill-pattern":new U(me.paint_fill["fill-pattern"])}),layout:yk};const vk=_e([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),_k=_e([{name:"a_centroid_pos",components:2,type:"Uint16"}]),bk=_e([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:wk}=vk;var kA=ph;function ph(a,n,s,u,p){this.properties={},this.extent=s,this.type=0,this._pbf=a,this._geometry=-1,this._keys=u,this._values=p,a.readFields(Ak,this,n)}function Ak(a,n,s){a==1?n.id=s.readVarint():a==2?function(u,p){for(var g=u.readVarint()+u.pos;u.pos<g;){var x=p._keys[u.readVarint()],A=p._values[u.readVarint()];p.properties[x]=A}}(s,n):a==3?n.type=s.readVarint():a==4&&(n._geometry=s.pos)}function Mk(a){for(var n,s,u=0,p=0,g=a.length,x=g-1;p<g;x=p++)u+=((s=a[x]).x-(n=a[p]).x)*(n.y+s.y);return u}ph.types=["Unknown","Point","LineString","Polygon"],ph.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var n,s=a.readVarint()+a.pos,u=1,p=0,g=0,x=0,A=[];a.pos<s;){if(p<=0){var T=a.readVarint();u=7&T,p=T>>3}if(p--,u===1||u===2)g+=a.readSVarint(),x+=a.readSVarint(),u===1&&(n&&A.push(n),n=[]),n.push(new b(g,x));else{if(u!==7)throw new Error("unknown command "+u);n&&n.push(n[0].clone())}}return n&&A.push(n),A},ph.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var n=a.readVarint()+a.pos,s=1,u=0,p=0,g=0,x=1/0,A=-1/0,T=1/0,D=-1/0;a.pos<n;){if(u<=0){var k=a.readVarint();s=7&k,u=k>>3}if(u--,s===1||s===2)(p+=a.readSVarint())<x&&(x=p),p>A&&(A=p),(g+=a.readSVarint())<T&&(T=g),g>D&&(D=g);else if(s!==7)throw new Error("unknown command "+s)}return[x,T,A,D]},ph.prototype.toGeoJSON=function(a,n,s){var u,p,g=this.extent*Math.pow(2,s),x=this.extent*a,A=this.extent*n,T=this.loadGeometry(),D=ph.types[this.type];function k(H){for(var K=0;K<H.length;K++){var te=H[K];H[K]=[360*(te.x+x)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+A)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(u=0;u<T.length;u++)z[u]=T[u][0];k(T=z);break;case 2:for(u=0;u<T.length;u++)k(T[u]);break;case 3:for(T=function(H){var K=H.length;if(K<=1)return[H];for(var te,ae,he=[],Pe=0;Pe<K;Pe++){var Be=Mk(H[Pe]);Be!==0&&(ae===void 0&&(ae=Be<0),ae===Be<0?(te&&he.push(te),te=[H[Pe]]):te.push(H[Pe]))}return te&&he.push(te),he}(T),u=0;u<T.length;u++)for(p=0;p<T[u].length;p++)k(T[u][p])}T.length===1?T=T[0]:D="Multi"+D;var N={type:"Feature",geometry:{type:D,coordinates:T},properties:this.properties};return"id"in this&&(N.id=this.id),N};var BA=zA;function zA(a,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Sk,this,n),this.length=this._features.length}function Sk(a,n,s){a===15?n.version=s.readVarint():a===1?n.name=s.readString():a===5?n.extent=s.readVarint():a===2?n._features.push(s.pos):a===3?n._keys.push(s.readString()):a===4&&n._values.push(function(u){for(var p=null,g=u.readVarint()+u.pos;u.pos<g;){var x=u.readVarint()>>3;p=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return p}(s))}function Tk(a,n,s){if(a===3){var u=new BA(s,s.readVarint()+s.pos);u.length&&(n[u.name]=u)}}zA.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var n=this._pbf.readVarint()+this._pbf.pos;return new kA(this._pbf,n,this.extent,this._keys,this._values)};var dc={VectorTile:function(a,n){this.layers=a.readFields(Tk,{},n)},VectorTileFeature:kA,VectorTileLayer:BA};function oy(a,n,s,u){const p=[],g=u===0?(x,A,T,D,k,z)=>{x.push(new b(z,T+(z-A)/(D-A)*(k-T)))}:(x,A,T,D,k,z)=>{x.push(new b(A+(z-T)/(k-T)*(D-A),z))};for(const x of a){const A=[];for(const T of x){if(T.length<=2)continue;const D=[];for(let N=0;N<T.length-1;N++){const H=T[N].x,K=T[N].y,te=T[N+1].x,ae=T[N+1].y,he=u===0?H:K,Pe=u===0?te:ae;he<n?Pe>n&&g(D,H,K,te,ae,n):he>s?Pe<s&&g(D,H,K,te,ae,s):D.push(T[N]),Pe<n&&he>=n&&g(D,H,K,te,ae,n),Pe>s&&he<=s&&g(D,H,K,te,ae,s)}let k=T[T.length-1];const z=u===0?k.x:k.y;z>=n&&z<=s&&D.push(k),D.length&&(k=D[D.length-1],D[0].x===k.x&&D[0].y===k.y||D.push(D[0]),A.push(D))}A.length&&p.push(A)}return p}const Ek=dc.VectorTileFeature.types,Pk=Math.pow(2,13);function Up(a,n,s,u,p,g,x,A){a.emplaceBack((n<<1)+x,(s<<1)+g,(Math.floor(u*Pk)<<1)+p,Math.round(A))}function Np(a,n,s){a.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class UA{constructor(){this.acc=new b(0,0),this.polyCount=[]}startRing(n){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new b(n.x,n.y),this.max=new b(n.x,n.y))}append(n,s){this.currentPolyCount.edges++,this.acc._add(n);const u=this.min,p=this.max;n.x<u.x?u.x=n.x:n.x>p.x&&(p.x=n.x),n.y<u.y?u.y=n.y:n.y>p.y&&(p.y=n.y),((n.x===0||n.x===Bn)&&n.x===s.x)!=((n.y===0||n.y===Bn)&&n.y===s.y)&&this.processBorderOverlap(n,s),s.x<0!=n.x<0&&this.addBorderIntersection(0,yn(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>Bn!=n.x>Bn&&this.addBorderIntersection(1,yn(s.y,n.y,(Bn-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,yn(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>Bn!=n.y>Bn&&this.addBorderIntersection(3,yn(s.x,n.x,(Bn-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,n.x)}}centroid(){const n=this.polyCount.reduce((s,u)=>s+u.edges,0);return n!==0?this.acc.div(n)._round():new b(0,0)}span(){return new b(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0)}}class Vp{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new Me,this.centroidVertexArray=new sc,this.indexArray=new Yt,this.programConfigurations=new lc(n.layers,n.zoom),this.segments=new Di,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.enableTerrain=n.enableTerrain}populate(n,s,u,p){this.features=[],this.hasPattern=wv("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const x=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*x/(x*x+1)/Bn/(1<<g.z)}(u);for(const{feature:g,id:x,index:A,sourceLayerIndex:T}of n){const D=this.layers[0]._featureFilter.needGeometry,k=cc(g,D);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),k,u))continue;const z={id:x,sourceLayerIndex:T,index:A,geometry:D?k.geometry:as(g,u,p),properties:g.properties,type:g.type,patterns:{}},N=this.layoutVertexArray.length;this.hasPattern?this.features.push(Av("fill-extrusion",this.layers,z,this.zoom,s)):this.addFeature(z,z.geometry,A,u,{},s.availableImages,p),s.featureIndex.insert(g,z.geometry,A,T,this.index,N)}this.sortBorders()}addFeatures(n,s,u,p,g){for(const x of this.features){const{geometry:A}=x;this.addFeature(x,A,x.index,s,u,p,g)}this.sortBorders()}update(n,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,wk),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,bk.members,!0))),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,_k.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,u,p,g,x,A){const T=[new b(0,0),new b(Bn,Bn)],D=A.projection,k=D.name==="globe",z=this.enableTerrain&&!k?new UA:null;k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Vr);const N=bv(s,500);for(let te=N.length-1;te>=0;te--){const ae=N[te];(ae.length===0||(H=ae[0]).every(he=>he.x<=0)||H.every(he=>he.x>=Bn)||H.every(he=>he.y<=0)||H.every(he=>he.y>=Bn))&&N.splice(te,1)}var H;let K;if(k){const ae=1<<p.z,he=Io(p.x/ae),Pe=Io((p.x+1)/ae),Be=hr(p.y/ae),Oe=hr((p.y+1)/ae);K=function(qe,Ye,st,ut,vt=0,Mt){const it=[];if(!qe.length||!st||!ut)return it;const pt=(Dn,Vn)=>{for(const $t of Dn)it.push({polygon:$t,bounds:Vn})},Tt=Math.ceil(Math.log2(st)),zt=Math.ceil(Math.log2(ut)),Dt=Tt-zt,Bt=[];for(let Dn=0;Dn<Math.abs(Dt);Dn++)Bt.push(Dt>0?0:1);for(let Dn=0;Dn<Math.min(Tt,zt);Dn++)Bt.push(0),Bt.push(1);let Cn=qe;if(Cn=oy(Cn,Ye[0].y-vt,Ye[1].y+vt,1),Cn=oy(Cn,Ye[0].x-vt,Ye[1].x+vt,0),!Cn.length)return it;const Hn=[];for(Bt.length?Hn.push({polygons:Cn,bounds:Ye,depth:0}):pt(Cn,Ye);Hn.length;){const Dn=Hn.pop(),Vn=Dn.depth,$t=Bt[Vn],Wt=Dn.bounds[0],Wn=Dn.bounds[1],ti=$t===0?Wt.x:Wt.y,Hi=$t===0?Wn.x:Wn.y,gi=Mt?Mt($t,ti,Hi):.5*(ti+Hi),Wi=oy(Dn.polygons,ti-vt,gi+vt,$t),ni=oy(Dn.polygons,gi-vt,Hi+vt,$t);if(Wi.length){const Yn=[Wt,new b($t===0?gi:Wn.x,$t===1?gi:Wn.y)];Bt.length>Vn+1?Hn.push({polygons:Wi,bounds:Yn,depth:Vn+1}):pt(Wi,Yn)}if(ni.length){const Yn=[new b($t===0?gi:Wt.x,$t===1?gi:Wt.y),Wn];Bt.length>Vn+1?Hn.push({polygons:ni,bounds:Yn,depth:Vn+1}):pt(ni,Yn)}}return it}(N,T,Math.ceil((Pe-he)/11.25),Math.ceil((Be-Oe)/11.25),1,(qe,Ye,st)=>{if(qe===0)return .5*(Ye+st);{const ut=hr((p.y+Ye/Bn)/ae);return(ah(.5*(hr((p.y+st/Bn)/ae)+ut))*ae-p.y)*Bn}})}else{K=[];for(const te of N)K.push({polygon:te,bounds:T})}for(const te of K){const ae=te.polygon;let he=0,Pe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let st=0;st<ae.length;st++){const ut=ae[st];if(ut.length===0)continue;he+=ut.length;let vt=0;z&&z.startRing(ut[0]);for(let Mt=0;Mt<ut.length;Mt++){const it=ut[Mt];if(Mt>=1){const pt=ut[Mt-1];if(!Ck(it,pt,te.bounds)){z&&z.append(it,pt),Pe.vertexLength+4>Di.MAX_VERTEX_ARRAY_LENGTH&&(Pe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Tt=it.sub(pt)._perp(),zt=Tt.x/(Math.abs(Tt.x)+Math.abs(Tt.y)),Dt=Tt.y>0?1:0,Bt=pt.dist(it);vt+Bt>32768&&(vt=0),Up(this.layoutVertexArray,it.x,it.y,zt,Dt,0,0,vt),Up(this.layoutVertexArray,it.x,it.y,zt,Dt,0,1,vt),vt+=Bt,Up(this.layoutVertexArray,pt.x,pt.y,zt,Dt,0,0,vt),Up(this.layoutVertexArray,pt.x,pt.y,zt,Dt,0,1,vt);const Cn=Pe.vertexLength;if(this.indexArray.emplaceBack(Cn,Cn+2,Cn+1),this.indexArray.emplaceBack(Cn+1,Cn+2,Cn+3),Pe.vertexLength+=4,Pe.primitiveLength+=2,k){const Hn=this.layoutVertexExtArray,Dn=D.projectTilePoint(it.x,it.y,p),Vn=D.projectTilePoint(pt.x,pt.y,p),$t=D.upVector(p,it.x,it.y),Wt=D.upVector(p,pt.x,pt.y);Np(Hn,Dn,$t),Np(Hn,Dn,$t),Np(Hn,Vn,Wt),Np(Hn,Vn,Wt)}}}}}if(Pe.vertexLength+he>Di.MAX_VERTEX_ARRAY_LENGTH&&(Pe=this.segments.prepareSegment(he,this.layoutVertexArray,this.indexArray)),Ek[n.type]!=="Polygon")continue;const Be=[],Oe=[],qe=Pe.vertexLength;for(let st=0;st<ae.length;st++){const ut=ae[st];if(ut.length!==0){ut!==ae[0]&&Oe.push(Be.length/2);for(let vt=0;vt<ut.length;vt++){const Mt=ut[vt];Up(this.layoutVertexArray,Mt.x,Mt.y,0,0,1,1,0),Be.push(Mt.x),Be.push(Mt.y),z&&z.currentPolyCount.top++,k&&Np(this.layoutVertexExtArray,D.projectTilePoint(Mt.x,Mt.y,p),D.upVector(p,Mt.x,Mt.y))}}}const Ye=$g(Be,Oe);for(let st=0;st<Ye.length;st+=3)this.indexArray.emplaceBack(qe+Ye[st],qe+Ye[st+2],qe+Ye[st+1]);Pe.primitiveLength+=Ye.length/3,Pe.vertexLength+=he}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const te=z.borders,ae=this.featuresOnBorder.push(z)-1;for(let he=0;he<4;he++)te[he][0]!==Number.MAX_VALUE&&this.borders[he].push(ae)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,g,x,p)}sortBorders(){for(let n=0;n<4;n++)this.borders[n].sort((s,u)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}encodeCentroid(n,s,u=!0){let p,g;if(n)if(n.y!==0){const A=s.span()._mult(this.tileToMeter);p=(Math.max(n.x,1)<<3)+Math.min(7,Math.round(A.x/10)),g=(Math.max(n.y,1)<<3)+Math.min(7,Math.round(A.y/10))}else p=Math.ceil(7*(n.x+450)),g=0;else p=0,g=+u;let x=u?this.centroidVertexArray.length:s.vertexArrayOffset;for(const A of s.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*A.edges+A.top);for(let T=0;T<2*A.edges;T++)this.centroidVertexArray.emplace(x++,0,g),this.centroidVertexArray.emplace(x++,p,g);for(let T=0;T<A.top;T++)this.centroidVertexArray.emplace(x++,p,g)}}}function Ck(a,n,s){return a.x===n.x&&(a.x<s[0].x||a.x>s[1].x)||a.y===n.y&&(a.y<s[0].y||a.y>s[1].y)}qt(Vp,"FillExtrusionBucket",{omit:["layers","features"]}),qt(UA,"PartMetadata");var Rk={paint:new Y({"fill-extrusion-opacity":new C(me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new L(me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new C(me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new C(me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new U(me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new L(me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new L(me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new C(me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Op(a,n){return a.x*n.x+a.y*n.y}function NA(a,n){if(a.length===1){let s=0;const u=n[s++];let p;for(;!p||u.equals(p);)if(p=n[s++],!p)return 1/0;for(;s<n.length;s++){const g=n[s],x=a[0],A=p.sub(u),T=g.sub(u),D=x.sub(u),k=Op(A,A),z=Op(A,T),N=Op(T,T),H=Op(D,A),K=Op(D,T),te=k*N-z*z,ae=(N*H-z*K)/te,he=(k*K-z*H)/te,Pe=u.z*(1-ae-he)+p.z*ae+g.z*he;if(isFinite(Pe))return Pe}return 1/0}{let s=1/0;for(const u of n)s=Math.min(s,u.z);return s}}function VA(a){const n=new b(a[0],a[1]);return n.z=a[2],n}function Dk(a,n,s,u,p,g,x,A){const T=x*p.getElevationAt(a,n,!0,!0),D=g[0]!==0,k=D?g[1]===0?x*(g[0]/7-450):x*function(z,N,H){const K=Math.floor(N[0]/8),te=Math.floor(N[1]/8),ae=10*(N[0]-8*K),he=10*(N[1]-8*te),Pe=z.getElevationAt(K,te,!0,!0),Be=z.getMeterToDEM(H),Oe=Math.floor(.5*(ae*Be-1)),qe=Math.floor(.5*(he*Be-1)),Ye=z.tileCoordToPixel(K,te),st=2*Oe+1,ut=2*qe+1,vt=function(Dt,Bt,Cn,Hn,Dn){return[Dt.getElevationAtPixel(Bt,Cn,!0),Dt.getElevationAtPixel(Bt+Dn,Cn,!0),Dt.getElevationAtPixel(Bt,Cn+Dn,!0),Dt.getElevationAtPixel(Bt+Hn,Cn+Dn,!0)]}(z,Ye.x-Oe,Ye.y-qe,st,ut),Mt=Math.abs(vt[0]-vt[1]),it=Math.abs(vt[2]-vt[3]),pt=Math.abs(vt[0]-vt[2])+Math.abs(vt[1]-vt[3]),Tt=Math.min(.25,.5*Be*(Mt+it)/st),zt=Math.min(.25,.5*Be*pt/ut);return Pe+Math.max(Tt*ae,zt*he)}(p,g,A):T;return{base:T+(s===0)?-1:s,top:D?Math.max(k+u,T+s+2):T+u}}const Ik=_e([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Lk}=Ik,Fk=_e([{name:"a_packed",components:3,type:"Float32"}]),{members:kk}=Fk,Bk=dc.VectorTileFeature.types,zk=Math.cos(Math.PI/180*37.5);class ay{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new ge,this.layoutVertexArray2=new Ft,this.indexArray=new Yt,this.programConfigurations=new lc(n.layers,n.zoom),this.segments=new Di,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,u,p){this.hasPattern=wv("line",this.layers,s);const g=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:k,id:z,index:N,sourceLayerIndex:H}of n){const K=this.layers[0]._featureFilter.needGeometry,te=cc(k,K);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),te,u))continue;const ae=g?g.evaluate(te,{},u):void 0,he={id:z,properties:k.properties,type:k.type,sourceLayerIndex:H,index:N,geometry:K?te.geometry:as(k,u,p),patterns:{},sortKey:ae};x.push(he)}g&&x.sort((k,z)=>k.sortKey-z.sortKey);const{lineAtlas:A,featureIndex:T}=s,D=this.addConstantDashes(A);for(const k of x){const{geometry:z,index:N,sourceLayerIndex:H}=k;if(D&&this.addFeatureDashes(k,A),this.hasPattern){const K=Av("line",this.layers,k,this.zoom,s);this.patternFeatures.push(K)}else this.addFeature(k,z,N,u,A.positions,s.availableImages);T.insert(n[N].feature,z,N,H,this.index)}}addConstantDashes(n){let s=!1;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if(p.kind!=="constant"||g.kind!=="constant")s=!0;else{const x=g.value,A=p.value;if(!A)continue;n.addDash(A.from,x),n.addDash(A.to,x),A.other&&n.addDash(A.other,x)}}return s}addFeatureDashes(n,s){const u=this.zoom;for(const p of this.layers){const g=p.paint.get("line-dasharray").value,x=p.layout.get("line-cap").value;if(g.kind==="constant"&&x.kind==="constant")continue;let A,T,D,k,z,N;if(g.kind==="constant"){const ae=g.value;if(!ae)continue;A=ae.other||ae.to,T=ae.to,D=ae.from}else A=g.evaluate({zoom:u-1},n),T=g.evaluate({zoom:u},n),D=g.evaluate({zoom:u+1},n);x.kind==="constant"?k=z=N=x.value:(k=x.evaluate({zoom:u-1},n),z=x.evaluate({zoom:u},n),N=x.evaluate({zoom:u+1},n)),s.addDash(A,k),s.addDash(T,z),s.addDash(D,N);const H=s.getKey(A,k),K=s.getKey(T,z),te=s.getKey(D,N);n.patterns[p.id]={min:H,mid:K,max:te}}}update(n,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u,p)}addFeatures(n,s,u,p,g){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,s,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,kk)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Lk),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,u,p,g,x){const A=this.layers[0].layout,T=A.get("line-join").evaluate(n,{}),D=A.get("line-cap").evaluate(n,{}),k=A.get("line-miter-limit"),z=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const N of s)this.addLine(N,n,T,D,k,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,g,x,p)}addLine(n,s,u,p,g,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let he=0;he<n.length-1;he++)this.totalDistance+=n[he].dist(n[he+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=Bk[s.type]==="Polygon";let T=n.length;for(;T>=2&&n[T-1].equals(n[T-2]);)T--;let D=0;for(;D<T-1&&n[D].equals(n[D+1]);)D++;if(T<(A?3:2))return;u==="bevel"&&(g=1.05);const k=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let N,H,K,te,ae;this.e1=this.e2=-1,A&&(N=n[T-2],ae=n[D].sub(N)._unit()._perp());for(let he=D;he<T;he++){if(K=he===T-1?A?n[D+1]:void 0:n[he+1],K&&n[he].equals(K))continue;ae&&(te=ae),N&&(H=N),N=n[he],ae=K?K.sub(N)._unit()._perp():te,te=te||ae;let Pe=te.add(ae);Pe.x===0&&Pe.y===0||Pe._unit();const Be=te.x*ae.x+te.y*ae.y,Oe=Pe.x*ae.x+Pe.y*ae.y,qe=Oe!==0?1/Oe:1/0,Ye=2*Math.sqrt(2-2*Oe),st=Oe<zk&&H&&K,ut=te.x*ae.y-te.y*ae.x>0;if(st&&he>D){const it=N.dist(H);if(it>2*k){const pt=N.sub(N.sub(H)._mult(k/it)._round());this.updateDistance(H,pt),this.addCurrentVertex(pt,te,0,0,z),H=pt}}const vt=H&&K;let Mt=vt?u:A?"butt":p;if(vt&&Mt==="round"&&(qe<x?Mt="miter":qe<=2&&(Mt="fakeround")),Mt==="miter"&&qe>g&&(Mt="bevel"),Mt==="bevel"&&(qe>2&&(Mt="flipbevel"),qe<g&&(Mt="miter")),H&&this.updateDistance(H,N),Mt==="miter")Pe._mult(qe),this.addCurrentVertex(N,Pe,0,0,z);else if(Mt==="flipbevel"){if(qe>100)Pe=ae.mult(-1);else{const it=qe*te.add(ae).mag()/te.sub(ae).mag();Pe._perp()._mult(it*(ut?-1:1))}this.addCurrentVertex(N,Pe,0,0,z),this.addCurrentVertex(N,Pe.mult(-1),0,0,z)}else if(Mt==="bevel"||Mt==="fakeround"){const it=-Math.sqrt(qe*qe-1),pt=ut?it:0,Tt=ut?0:it;if(H&&this.addCurrentVertex(N,te,pt,Tt,z),Mt==="fakeround"){const zt=Math.round(180*Ye/Math.PI/20);for(let Dt=1;Dt<zt;Dt++){let Bt=Dt/zt;if(Bt!==.5){const Hn=Bt-.5;Bt+=Bt*Hn*(Bt-1)*((1.0904+Be*(Be*(3.55645-1.43519*Be)-3.2452))*Hn*Hn+(.848013+Be*(.215638*Be-1.06021)))}const Cn=ae.sub(te)._mult(Bt)._add(te)._unit()._mult(ut?-1:1);this.addHalfVertex(N,Cn.x,Cn.y,!1,ut,0,z)}}K&&this.addCurrentVertex(N,ae,-pt,-Tt,z)}else if(Mt==="butt")this.addCurrentVertex(N,Pe,0,0,z);else if(Mt==="square"){const it=H?1:-1;H||this.addCurrentVertex(N,Pe,it,it,z),this.addCurrentVertex(N,Pe,0,0,z),H&&this.addCurrentVertex(N,Pe,it,it,z)}else Mt==="round"&&(H&&(this.addCurrentVertex(N,te,0,0,z),this.addCurrentVertex(N,te,1,1,z,!0)),K&&(this.addCurrentVertex(N,ae,-1,-1,z,!0),this.addCurrentVertex(N,ae,0,0,z)));if(st&&he<T-1){const it=N.dist(K);if(it>2*k){const pt=N.add(K.sub(N)._mult(k/it)._round());this.updateDistance(N,pt),this.addCurrentVertex(pt,ae,0,0,z),N=pt}}}}addCurrentVertex(n,s,u,p,g,x=!1){const A=s.y*p-s.x,T=-s.y-s.x*p;this.addHalfVertex(n,s.x+s.y*u,s.y-s.x*u,x,!1,u,g),this.addHalfVertex(n,A,T,x,!0,-p,g)}addHalfVertex({x:n,y:s},u,p,g,x,A,T){this.layoutVertexArray.emplaceBack((n<<1)+(g?1:0),(s<<1)+(x?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(A===0?0:A<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),T.primitiveLength++),x?this.e2=D:this.e1=D}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}qt(ay,"LineBucket",{omit:["layers","patternFeatures"]});const Uk=new Y({"line-cap":new L(me.layout_line["line-cap"]),"line-join":new L(me.layout_line["line-join"]),"line-miter-limit":new C(me.layout_line["line-miter-limit"]),"line-round-limit":new C(me.layout_line["line-round-limit"]),"line-sort-key":new L(me.layout_line["line-sort-key"])});var OA={paint:new Y({"line-opacity":new L(me.paint_line["line-opacity"]),"line-color":new L(me.paint_line["line-color"]),"line-translate":new C(me.paint_line["line-translate"]),"line-translate-anchor":new C(me.paint_line["line-translate-anchor"]),"line-width":new L(me.paint_line["line-width"]),"line-gap-width":new L(me.paint_line["line-gap-width"]),"line-offset":new L(me.paint_line["line-offset"]),"line-blur":new L(me.paint_line["line-blur"]),"line-dasharray":new U(me.paint_line["line-dasharray"]),"line-pattern":new U(me.paint_line["line-pattern"]),"line-gradient":new j(me.paint_line["line-gradient"])}),layout:Uk};const GA=new class extends L{possiblyEvaluate(a,n){return n=new mi(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(a,n)}evaluate(a,n,s,u){return n=Ne({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(a,n,s,u)}}(OA.paint.properties["line-width"].specification);function jA(a,n){return n>0?n+2*a:a}GA.useIntegerZoom=!0;const Nk=_e([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),Vk=_e([{name:"a_projected_pos",components:3,type:"Float32"}],4);_e([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ok=_e([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Gk=_e([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);_e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const HA=_e([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jk=_e([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);_e([{name:"triangle",components:3,type:"Uint16"}]),_e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),_e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),_e([{type:"Float32",name:"offsetX"}]),_e([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var dr=24;const Ca=128;function Mv(a,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new mi(a+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=s;let g=0;for(;g<u.length&&u[g]<=a;)g++;g=Math.max(0,g-1);let x=g;for(;x<u.length&&u[x]<a+1;)x++;x=Math.min(u.length-1,x);const A=u[g],T=u[x];return s.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:A,maxZoom:T,minSize:s.evaluate(new mi(A)),maxSize:s.evaluate(new mi(T)),interpolationType:p}}}function sy(a,{uSize:n,uSizeT:s},{lowerSize:u,upperSize:p}){return a.kind==="source"?u/Ca:a.kind==="composite"?yn(u/Ca,p/Ca,s):n}function fh(a,n){let s=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:p,minZoom:g,maxZoom:x}=a,A=p?oe(zr.interpolationFactor(p,n,g,x),0,1):0;a.kind==="camera"?u=yn(a.minSize,a.maxSize,A):s=A}return{uSizeT:s,uSize:u}}var Hk=Object.freeze({__proto__:null,getSizeData:Mv,evaluateSizeForFeature:sy,evaluateSizeForZoom:fh,SIZE_PACK_FACTOR:Ca});function Wk(a,n,s){return a.sections.forEach(u=>{u.text=function(p,g,x){const A=g.layout.get("text-transform").evaluate(x,{});return A==="uppercase"?p=p.toLocaleUpperCase():A==="lowercase"&&(p=p.toLocaleLowerCase()),$r.applyArabicShaping&&(p=$r.applyArabicShaping(p)),p}(u.text,n,s)}),a}const Gp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function qk(a){return a==="︶"||a==="﹈"||a==="︸"||a==="﹄"||a==="﹂"||a==="︾"||a==="︼"||a==="︺"||a==="︘"||a==="﹀"||a==="︐"||a==="︓"||a==="︔"||a==="｀"||a==="￣"||a==="︑"||a==="︒"}function Yk(a){return a==="︵"||a==="﹇"||a==="︷"||a==="﹃"||a==="﹁"||a==="︽"||a==="︻"||a==="︹"||a==="︗"||a==="︿"}var WA=function(a,n,s,u,p){var g,x,A=8*p-u-1,T=(1<<A)-1,D=T>>1,k=-7,z=s?p-1:0,N=s?-1:1,H=a[n+z];for(z+=N,g=H&(1<<-k)-1,H>>=-k,k+=A;k>0;g=256*g+a[n+z],z+=N,k-=8);for(x=g&(1<<-k)-1,g>>=-k,k+=u;k>0;x=256*x+a[n+z],z+=N,k-=8);if(g===0)g=1-D;else{if(g===T)return x?NaN:1/0*(H?-1:1);x+=Math.pow(2,u),g-=D}return(H?-1:1)*x*Math.pow(2,g-u)},qA=function(a,n,s,u,p,g){var x,A,T,D=8*g-p-1,k=(1<<D)-1,z=k>>1,N=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=u?0:g-1,K=u?1:-1,te=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(A=isNaN(n)?1:0,x=k):(x=Math.floor(Math.log(n)/Math.LN2),n*(T=Math.pow(2,-x))<1&&(x--,T*=2),(n+=x+z>=1?N/T:N*Math.pow(2,1-z))*T>=2&&(x++,T/=2),x+z>=k?(A=0,x=k):x+z>=1?(A=(n*T-1)*Math.pow(2,p),x+=z):(A=n*Math.pow(2,z-1)*Math.pow(2,p),x=0));p>=8;a[s+H]=255&A,H+=K,A/=256,p-=8);for(x=x<<p|A,D+=p;D>0;a[s+H]=255&x,H+=K,x/=256,D-=8);a[s+H-K]|=128*te},jp=pi;function pi(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}pi.Varint=0,pi.Fixed64=1,pi.Bytes=2,pi.Fixed32=5;var Sv=4294967296,YA=1/Sv,XA=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function ls(a){return a.type===pi.Bytes?a.readVarint()+a.pos:a.pos+1}function mh(a,n,s){return s?4294967296*n+(a>>>0):4294967296*(n>>>0)+(a>>>0)}function KA(a,n,s){var u=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(u);for(var p=s.pos-1;p>=a;p--)s.buf[p+u]=s.buf[p]}function Xk(a,n){for(var s=0;s<a.length;s++)n.writeVarint(a[s])}function Kk(a,n){for(var s=0;s<a.length;s++)n.writeSVarint(a[s])}function Zk(a,n){for(var s=0;s<a.length;s++)n.writeFloat(a[s])}function Jk(a,n){for(var s=0;s<a.length;s++)n.writeDouble(a[s])}function Qk(a,n){for(var s=0;s<a.length;s++)n.writeBoolean(a[s])}function $k(a,n){for(var s=0;s<a.length;s++)n.writeFixed32(a[s])}function eB(a,n){for(var s=0;s<a.length;s++)n.writeSFixed32(a[s])}function tB(a,n){for(var s=0;s<a.length;s++)n.writeFixed64(a[s])}function nB(a,n){for(var s=0;s<a.length;s++)n.writeSFixed64(a[s])}function ly(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+16777216*a[n+3]}function gh(a,n,s){a[s]=n,a[s+1]=n>>>8,a[s+2]=n>>>16,a[s+3]=n>>>24}function ZA(a,n){return(a[n]|a[n+1]<<8|a[n+2]<<16)+(a[n+3]<<24)}function iB(a,n,s){n.glyphs=[],a===1&&s.readMessage(rB,n)}function rB(a,n,s){if(a===3){const{id:u,bitmap:p,width:g,height:x,left:A,top:T,advance:D}=s.readMessage(oB,{});n.glyphs.push({id:u,bitmap:new ss({width:g+6,height:x+6},p),metrics:{width:g,height:x,left:A,top:T,advance:D}})}else a===4?n.ascender=s.readSVarint():a===5&&(n.descender=s.readSVarint())}function oB(a,n,s){a===1?n.id=s.readVarint():a===2?n.bitmap=s.readBytes():a===3?n.width=s.readVarint():a===4?n.height=s.readVarint():a===5?n.left=s.readSVarint():a===6?n.top=s.readSVarint():a===7&&(n.advance=s.readVarint())}function Tv(a){let n=0,s=0;for(const x of a)n+=x.w*x.h,s=Math.max(s,x.w);a.sort((x,A)=>A.h-x.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let p=0,g=0;for(const x of a)for(let A=u.length-1;A>=0;A--){const T=u[A];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,g=Math.max(g,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===T.w&&x.h===T.h){const D=u.pop();A<u.length&&(u[A]=D)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(u.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:p,h:g,fill:n/(p*g)||0}}pi.prototype={destroy:function(){this.buf=null},readFields:function(a,n,s){for(s=s||this.length;this.pos<s;){var u=this.readVarint(),p=u>>3,g=this.pos;this.type=7&u,a(p,n,this),this.pos===g&&this.skip(u)}return n},readMessage:function(a,n){return this.readFields(a,n,this.readVarint()+this.pos)},readFixed32:function(){var a=ly(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=ZA(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=ly(this.buf,this.pos)+ly(this.buf,this.pos+4)*Sv;return this.pos+=8,a},readSFixed64:function(){var a=ly(this.buf,this.pos)+ZA(this.buf,this.pos+4)*Sv;return this.pos+=8,a},readFloat:function(){var a=WA(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=WA(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var n,s,u=this.buf;return n=127&(s=u[this.pos++]),s<128?n:(n|=(127&(s=u[this.pos++]))<<7,s<128?n:(n|=(127&(s=u[this.pos++]))<<14,s<128?n:(n|=(127&(s=u[this.pos++]))<<21,s<128?n:function(p,g,x){var A,T,D=x.buf;if(A=(112&(T=D[x.pos++]))>>4,T<128||(A|=(127&(T=D[x.pos++]))<<3,T<128)||(A|=(127&(T=D[x.pos++]))<<10,T<128)||(A|=(127&(T=D[x.pos++]))<<17,T<128)||(A|=(127&(T=D[x.pos++]))<<24,T<128)||(A|=(1&(T=D[x.pos++]))<<31,T<128))return mh(p,A,g);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(s=u[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,n=this.pos;return this.pos=a,a-n>=12&&XA?function(s,u,p){return XA.decode(s.subarray(u,p))}(this.buf,n,a):function(s,u,p){for(var g="",x=u;x<p;){var A,T,D,k=s[x],z=null,N=k>239?4:k>223?3:k>191?2:1;if(x+N>p)break;N===1?k<128&&(z=k):N===2?(192&(A=s[x+1]))==128&&(z=(31&k)<<6|63&A)<=127&&(z=null):N===3?(T=s[x+2],(192&(A=s[x+1]))==128&&(192&T)==128&&((z=(15&k)<<12|(63&A)<<6|63&T)<=2047||z>=55296&&z<=57343)&&(z=null)):N===4&&(T=s[x+2],D=s[x+3],(192&(A=s[x+1]))==128&&(192&T)==128&&(192&D)==128&&((z=(15&k)<<18|(63&A)<<12|(63&T)<<6|63&D)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,N=1):z>65535&&(z-=65536,g+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),g+=String.fromCharCode(z),x+=N}return g}(this.buf,n,a)},readBytes:function(){var a=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,a);return this.pos=a,n},readPackedVarint:function(a,n){if(this.type!==pi.Bytes)return a.push(this.readVarint(n));var s=ls(this);for(a=a||[];this.pos<s;)a.push(this.readVarint(n));return a},readPackedSVarint:function(a){if(this.type!==pi.Bytes)return a.push(this.readSVarint());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==pi.Bytes)return a.push(this.readBoolean());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==pi.Bytes)return a.push(this.readFloat());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==pi.Bytes)return a.push(this.readDouble());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==pi.Bytes)return a.push(this.readFixed32());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==pi.Bytes)return a.push(this.readSFixed32());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==pi.Bytes)return a.push(this.readFixed64());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==pi.Bytes)return a.push(this.readSFixed64());var n=ls(this);for(a=a||[];this.pos<n;)a.push(this.readSFixed64());return a},skip:function(a){var n=7&a;if(n===pi.Varint)for(;this.buf[this.pos++]>127;);else if(n===pi.Bytes)this.pos=this.readVarint()+this.pos;else if(n===pi.Fixed32)this.pos+=4;else{if(n!==pi.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(a,n){this.writeVarint(a<<3|n)},realloc:function(a){for(var n=this.length||16;n<this.pos+a;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),gh(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),gh(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),gh(this.buf,-1&a,this.pos),gh(this.buf,Math.floor(a*YA),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),gh(this.buf,-1&a,this.pos),gh(this.buf,Math.floor(a*YA),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(n,s){var u,p;if(n>=0?(u=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(u=~(-n%4294967296))?u=u+1|0:(u=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(g,x,A){A.buf[A.pos++]=127&g|128,g>>>=7,A.buf[A.pos++]=127&g|128,g>>>=7,A.buf[A.pos++]=127&g|128,g>>>=7,A.buf[A.pos++]=127&g|128,A.buf[A.pos]=127&(g>>>=7)}(u,0,s),function(g,x){var A=(7&g)<<4;x.buf[x.pos++]|=A|((g>>>=3)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g)))))}(p,s)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var n=this.pos;this.pos=function(u,p,g){for(var x,A,T=0;T<p.length;T++){if((x=p.charCodeAt(T))>55295&&x<57344){if(!A){x>56319||T+1===p.length?(u[g++]=239,u[g++]=191,u[g++]=189):A=x;continue}if(x<56320){u[g++]=239,u[g++]=191,u[g++]=189,A=x;continue}x=A-55296<<10|x-56320|65536,A=null}else A&&(u[g++]=239,u[g++]=191,u[g++]=189,A=null);x<128?u[g++]=x:(x<2048?u[g++]=x>>6|192:(x<65536?u[g++]=x>>12|224:(u[g++]=x>>18|240,u[g++]=x>>12&63|128),u[g++]=x>>6&63|128),u[g++]=63&x|128)}return g}(this.buf,a,this.pos);var s=this.pos-n;s>=128&&KA(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(a){this.realloc(4),qA(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),qA(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var n=a.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=a[s]},writeRawMessage:function(a,n){this.pos++;var s=this.pos;a(n,this);var u=this.pos-s;u>=128&&KA(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeMessage:function(a,n,s){this.writeTag(a,pi.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(a,n){n.length&&this.writeMessage(a,Xk,n)},writePackedSVarint:function(a,n){n.length&&this.writeMessage(a,Kk,n)},writePackedBoolean:function(a,n){n.length&&this.writeMessage(a,Qk,n)},writePackedFloat:function(a,n){n.length&&this.writeMessage(a,Zk,n)},writePackedDouble:function(a,n){n.length&&this.writeMessage(a,Jk,n)},writePackedFixed32:function(a,n){n.length&&this.writeMessage(a,$k,n)},writePackedSFixed32:function(a,n){n.length&&this.writeMessage(a,eB,n)},writePackedFixed64:function(a,n){n.length&&this.writeMessage(a,tB,n)},writePackedSFixed64:function(a,n){n.length&&this.writeMessage(a,nB,n)},writeBytesField:function(a,n){this.writeTag(a,pi.Bytes),this.writeBytes(n)},writeFixed32Field:function(a,n){this.writeTag(a,pi.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(a,n){this.writeTag(a,pi.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(a,n){this.writeTag(a,pi.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(a,n){this.writeTag(a,pi.Fixed64),this.writeSFixed64(n)},writeVarintField:function(a,n){this.writeTag(a,pi.Varint),this.writeVarint(n)},writeSVarintField:function(a,n){this.writeTag(a,pi.Varint),this.writeSVarint(n)},writeStringField:function(a,n){this.writeTag(a,pi.Bytes),this.writeString(n)},writeFloatField:function(a,n){this.writeTag(a,pi.Fixed32),this.writeFloat(n)},writeDoubleField:function(a,n){this.writeTag(a,pi.Fixed64),this.writeDouble(n)},writeBooleanField:function(a,n){this.writeVarintField(a,!!n)}};class Ev{constructor(n,{pixelRatio:s,version:u,stretchX:p,stretchY:g,content:x}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=p,this.stretchY=g,this.content=x,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class JA{constructor(n,s){const u={},p={};this.haveRenderCallbacks=[];const g=[];this.addImages(n,u,g),this.addImages(s,p,g);const{w:x,h:A}=Tv(g),T=new no({width:x||1,height:A||1});for(const D in n){const k=n[D],z=u[D].paddedRect;no.copy(k.data,T,{x:0,y:0},{x:z.x+1,y:z.y+1},k.data)}for(const D in s){const k=s[D],z=p[D].paddedRect,N=z.x+1,H=z.y+1,K=k.data.width,te=k.data.height;no.copy(k.data,T,{x:0,y:0},{x:N,y:H},k.data),no.copy(k.data,T,{x:0,y:te-1},{x:N,y:H-1},{width:K,height:1}),no.copy(k.data,T,{x:0,y:0},{x:N,y:H+te},{width:K,height:1}),no.copy(k.data,T,{x:K-1,y:0},{x:N-1,y:H},{width:1,height:te}),no.copy(k.data,T,{x:0,y:0},{x:N+K,y:H},{width:1,height:te})}this.image=T,this.iconPositions=u,this.patternPositions=p}addImages(n,s,u){for(const p in n){const g=n[p],x={x:0,y:0,w:g.data.width+2,h:g.data.height+2};u.push(x),s[p]=new Ev(x,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>n.hasImage(u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in n.updatedImages)this.patchUpdatedImage(this.iconPositions[u],n.getImage(u),s),this.patchUpdatedImage(this.patternPositions[u],n.getImage(u),s)}patchUpdatedImage(n,s,u){if(!n||!s||n.version===s.version)return;n.version=s.version;const[p,g]=n.tl;u.update(s.data,void 0,{x:p,y:g})}}qt(Ev,"ImagePosition"),qt(JA,"ImageAtlas");const Ao={horizontal:1,vertical:2,horizontalOnly:3};class Hp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const u=new Hp;return u.scale=n||1,u.fontStack=s,u}static forImage(n){const s=new Hp;return s.imageName=n,s}}class yh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const u=new yh;for(let p=0;p<n.sections.length;p++){const g=n.sections[p];g.image?u.addImageSection(g):u.addTextSection(g,s)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(n){this.text=function(s,u){let p="";for(let g=0;g<s.length;g++){const x=s.charCodeAt(g+1)||null,A=s.charCodeAt(g-1)||null;p+=!u&&(x&&nh(x)&&!Gp[s[g+1]]||A&&nh(A)&&!Gp[s[g-1]])||!Gp[s[g]]?s[g]:Gp[s[g]]}return p}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&cy[this.text.charCodeAt(u)];u++)n++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&cy[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const u=new yh;return u.text=this.text.substring(n,s),u.sectionIndex=this.sectionIndex.slice(n,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Hp.forText(n.scale,n.fontStack||s));const u=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(u)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void pe("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Hp.forImage(s)),this.sectionIndex.push(this.sections.length-1)):pe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pv(a,n,s,u,p,g,x,A,T,D,k,z,N,H,K,te){const ae=yh.fromFeature(a,p);let he;z===Ao.vertical&&ae.verticalizePunctuation(N);const{processBidirectionalText:Pe,processStyledBidirectionalText:Be}=$r;if(Pe&&ae.sections.length===1){he=[];const Ye=Pe(ae.toString(),Cv(ae,D,g,n,u,H,K));for(const st of Ye){const ut=new yh;ut.text=st,ut.sections=ae.sections;for(let vt=0;vt<st.length;vt++)ut.sectionIndex.push(0);he.push(ut)}}else if(Be){he=[];const Ye=Be(ae.text,ae.sectionIndex,Cv(ae,D,g,n,u,H,K));for(const st of Ye){const ut=new yh;ut.text=st[0],ut.sectionIndex=st[1],ut.sections=ae.sections,he.push(ut)}}else he=function(Ye,st){const ut=[],vt=Ye.text;let Mt=0;for(const it of st)ut.push(Ye.substring(Mt,it)),Mt=it;return Mt<vt.length&&ut.push(Ye.substring(Mt,vt.length)),ut}(ae,Cv(ae,D,g,n,u,H,K));const Oe=[],qe={positionedLines:Oe,text:ae.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ye,st,ut,vt,Mt,it,pt,Tt,zt,Dt,Bt,Cn){let Hn=0,Dn=0,Vn=0;const $t=Tt==="right"?1:Tt==="left"?0:.5;let Wt=!1;for(const ni of Mt){const Yn=ni.getSections();for(const si of Yn){if(si.imageName)continue;const Pi=st[si.fontStack];if(Pi&&(Wt=Pi.ascender!==void 0&&Pi.descender!==void 0,!Wt))break}if(!Wt)break}let Wn=0;for(const ni of Mt){ni.trim();const Yn=ni.getMaxScale(),si=(Yn-1)*dr,Pi={positionedGlyphs:[],lineOffset:0};Ye.positionedLines[Wn]=Pi;const Ii=Pi.positionedGlyphs;let qi=0;if(!ni.length()){Dn+=it,++Wn;continue}let nr=0,oo=0;for(let li=0;li<ni.length();li++){const Er=ni.getSection(li),ao=ni.getSectionIndex(li),sr=ni.getCharCode(li);let ir=Er.scale,_i=null,yi=null,Hr=null,Pr=dr,Ni=0;const Cr=!(zt===Ao.horizontal||!Bt&&!th(sr)||Bt&&(cy[sr]||(ti=sr,Cg(ti)||Zu(ti)||tc(ti)||vp(ti)||$u(ti))));if(Er.imageName){const xr=vt[Er.imageName];if(!xr)continue;Hr=Er.imageName,Ye.iconsInText=Ye.iconsInText||!0,yi=xr.paddedRect;const rr=xr.displaySize;ir=ir*dr/Cn,_i={width:rr[0],height:rr[1],left:1,top:-3,advance:Cr?rr[1]:rr[0],localGlyph:!1},Ni=Wt?-_i.height*ir:Yn*dr-17-rr[1]*ir,Pr=_i.advance;const Fo=(Cr?rr[0]:rr[1])*ir-dr*Yn;Fo>0&&Fo>qi&&(qi=Fo)}else{const xr=ut[Er.fontStack];if(!xr)continue;xr[sr]&&(yi=xr[sr]);const rr=st[Er.fontStack];if(!rr)continue;const Fo=rr.glyphs[sr];if(!Fo)continue;if(_i=Fo.metrics,Pr=sr!==8203?dr:0,Wt){const sl=rr.ascender!==void 0?Math.abs(rr.ascender):0,ef=rr.descender!==void 0?Math.abs(rr.descender):0,tf=(sl+ef)*ir;nr<tf&&(nr=tf,oo=(sl-ef)/2*ir),Ni=-sl*ir}else Ni=(Yn-ir)*dr-17}Cr?(Ye.verticalizable=!0,Ii.push({glyph:sr,imageName:Hr,x:Hn,y:Dn+Ni,vertical:Cr,scale:ir,localGlyph:_i.localGlyph,fontStack:Er.fontStack,sectionIndex:ao,metrics:_i,rect:yi}),Hn+=Pr*ir+Dt):(Ii.push({glyph:sr,imageName:Hr,x:Hn,y:Dn+Ni,vertical:Cr,scale:ir,localGlyph:_i.localGlyph,fontStack:Er.fontStack,sectionIndex:ao,metrics:_i,rect:yi}),Hn+=_i.advance*ir+Dt)}Ii.length!==0&&(Vn=Math.max(Hn-Dt,Vn),Wt?nM(Ii,$t,qi,oo,it*Yn/2):nM(Ii,$t,qi,0,it/2)),Hn=0;const jr=it*Yn+qi;Pi.lineOffset=Math.max(qi,si),Dn+=jr,++Wn}var ti;const Hi=Dn,{horizontalAlign:gi,verticalAlign:Wi}=Rv(pt);(function(ni,Yn,si,Pi,Ii,qi){const nr=(Yn-si)*Ii,oo=-qi*Pi;for(const jr of ni)for(const li of jr.positionedGlyphs)li.x+=nr,li.y+=oo})(Ye.positionedLines,$t,gi,Wi,Vn,Hi),Ye.top+=-Wi*Hi,Ye.bottom=Ye.top+Hi,Ye.left+=-gi*Vn,Ye.right=Ye.left+Vn,Ye.hasBaseline=Wt}(qe,n,s,u,he,x,A,T,z,D,N,te),!function(Ye){for(const st of Ye)if(st.positionedGlyphs.length!==0)return!1;return!0}(Oe)&&qe}const cy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},aB={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function QA(a,n,s,u,p,g){if(n.imageName){const x=u[n.imageName];return x?x.displaySize[0]*n.scale*dr/g+p:0}{const x=s[n.fontStack],A=x&&x.glyphs[a];return A?A.metrics.advance*n.scale+p:0}}function $A(a,n,s,u){const p=Math.pow(a-n,2);return u?a<n?p/2:2*p:p+Math.abs(s)*s}function sB(a,n,s){let u=0;return a===10&&(u-=1e4),s&&(u+=150),a!==40&&a!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function eM(a,n,s,u,p,g){let x=null,A=$A(n,s,p,g);for(const T of u){const D=$A(n-T.x,s,p,g)+T.badness;D<=A&&(x=T,A=D)}return{index:a,x:n,priorBreak:x,badness:A}}function tM(a){return a?tM(a.priorBreak).concat(a.index):[]}function Cv(a,n,s,u,p,g,x){if(g!=="point")return[];if(!a)return[];const A=[],T=function(N,H,K,te,ae,he){let Pe=0;for(let Be=0;Be<N.length();Be++){const Oe=N.getSection(Be);Pe+=QA(N.getCharCode(Be),Oe,te,ae,H,he)}return Pe/Math.max(1,Math.ceil(Pe/K))}(a,n,s,u,p,x),D=a.text.indexOf("​")>=0;let k=0;for(let N=0;N<a.length();N++){const H=a.getSection(N),K=a.getCharCode(N);if(cy[K]||(k+=QA(K,H,u,p,n,x)),N<a.length()-1){const te=!((z=K)<11904||!(Ig(z)||Dg(z)||qs(z)||ic(z)||kg(z)||mp(z)||Lg(z)||Ju(z)||Bg(z)||xp(z)||Fg(z)||_p(z)||nc(z)||gp(z)||Rg(z)||yp(z)||Qu(z)||Vg(z)||Ug(z)||zg(z)));(aB[K]||te||H.imageName)&&A.push(eM(N+1,k,T,A,sB(K,a.getCharCode(N+1),te&&D),!1))}}var z;return tM(eM(a.length(),k,T,A,0,!0))}function Rv(a){let n=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function nM(a,n,s,u,p){if(!(n||s||u||p))return;const g=a.length-1,x=a[g],A=(x.x+x.metrics.advance*x.scale)*n;for(let T=0;T<=g;T++)a[T].x-=A,a[T].y+=s+u+p}function lB(a,n,s){const{horizontalAlign:u,verticalAlign:p}=Rv(s),g=n[0]-a.displaySize[0]*u,x=n[1]-a.displaySize[1]*p;return{image:a,top:x,bottom:x+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function iM(a,n,s,u,p,g){const x=a.image;let A;if(x.content){const ae=x.content,he=x.pixelRatio||1;A=[ae[0]/he,ae[1]/he,x.displaySize[0]-ae[2]/he,x.displaySize[1]-ae[3]/he]}const T=n.left*g,D=n.right*g;let k,z,N,H;s==="width"||s==="both"?(H=p[0]+T-u[3],z=p[0]+D+u[1]):(H=p[0]+(T+D-x.displaySize[0])/2,z=H+x.displaySize[0]);const K=n.top*g,te=n.bottom*g;return s==="height"||s==="both"?(k=p[1]+K-u[0],N=p[1]+te+u[2]):(k=p[1]+(K+te-x.displaySize[1])/2,N=k+x.displaySize[1]),{image:x,top:k,right:z,bottom:N,left:H,collisionPadding:A}}class cs extends b{constructor(n,s,u,p,g){super(n,s),this.angle=p,this.z=u,g!==void 0&&(this.segment=g)}clone(){return new cs(this.x,this.y,this.z,this.angle,this.segment)}}function rM(a,n,s,u,p){if(n.segment===void 0)return!0;let g=n,x=n.segment+1,A=0;for(;A>-s/2;){if(x--,x<0)return!1;A-=a[x].dist(g),g=a[x]}A+=a[x].dist(a[x+1]),x++;const T=[];let D=0;for(;A<s/2;){const k=a[x],z=a[x+1];if(!z)return!1;let N=a[x-1].angleTo(k)-k.angleTo(z);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:A,angleDelta:N}),D+=N;A-T[0].distance>u;)D-=T.shift().angleDelta;if(D>p)return!1;x++,A+=k.dist(z)}return!0}function oM(a){let n=0;for(let s=0;s<a.length-1;s++)n+=a[s].dist(a[s+1]);return n}function aM(a,n,s){return a?.6*n*s:0}function sM(a,n){return Math.max(a?a.right-a.left:0,n?n.right-n.left:0)}function cB(a,n,s,u,p,g){const x=aM(s,p,g),A=sM(s,u)*g;let T=0;const D=oM(a)/2;for(let k=0;k<a.length-1;k++){const z=a[k],N=a[k+1],H=z.dist(N);if(T+H>D){const K=(D-T)/H,te=yn(z.x,N.x,K),ae=yn(z.y,N.y,K),he=new cs(te,ae,0,N.angleTo(z),k);return!x||rM(a,he,A,x,n)?he:void 0}T+=H}}function uB(a,n,s,u,p,g,x,A,T){const D=aM(u,g,x),k=sM(u,p),z=k*x,N=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return n-z<n/4&&(n=z+n/4),lM(a,N?n/2*A%n:(k/2+2*g)*x*A%n,n,D,s,z,N,!1,T)}function lM(a,n,s,u,p,g,x,A,T){const D=g/2,k=oM(a);let z=0,N=n-s,H=[];for(let K=0;K<a.length-1;K++){const te=a[K],ae=a[K+1],he=te.dist(ae),Pe=ae.angleTo(te);for(;N+s<z+he;){N+=s;const Be=(N-z)/he,Oe=yn(te.x,ae.x,Be),qe=yn(te.y,ae.y,Be);if(Oe>=0&&Oe<T&&qe>=0&&qe<T&&N-D>=0&&N+D<=k){const Ye=new cs(Oe,qe,0,Pe,K);Ye._round(),u&&!rM(a,Ye,g,u,p)||H.push(Ye)}}z+=he}return A||H.length||x||(H=lM(a,z/2,s,u,p,g,x,!0,T)),H}function cM(a,n,s,u,p){const g=[];for(let x=0;x<a.length;x++){const A=a[x];let T;for(let D=0;D<A.length-1;D++){let k=A[D],z=A[D+1];k.x<n&&z.x<n||(k.x<n?k=new b(n,k.y+(n-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x<n&&(z=new b(n,k.y+(n-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y<s&&z.y<s||(k.y<s?k=new b(k.x+(s-k.y)/(z.y-k.y)*(z.x-k.x),s)._round():z.y<s&&(z=new b(k.x+(s-k.y)/(z.y-k.y)*(z.x-k.x),s)._round()),k.x>=u&&z.x>=u||(k.x>=u?k=new b(u,k.y+(u-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x>=u&&(z=new b(u,k.y+(u-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y>=p&&z.y>=p||(k.y>=p?k=new b(k.x+(p-k.y)/(z.y-k.y)*(z.x-k.x),p)._round():z.y>=p&&(z=new b(k.x+(p-k.y)/(z.y-k.y)*(z.x-k.x),p)._round()),T&&k.equals(T[T.length-1])||(T=[k],g.push(T)),T.push(z)))))}}return g}qt(cs,"Anchor");const Wp=1e20;function uM(a,n,s,u,p,g,x,A,T){for(let D=n;D<n+u;D++)hM(a,s*g+D,g,p,x,A,T);for(let D=s;D<s+p;D++)hM(a,D*g+n,1,u,x,A,T)}function hM(a,n,s,u,p,g,x){g[0]=0,x[0]=-Wp,x[1]=Wp,p[0]=a[n];for(let A=1,T=0,D=0;A<u;A++){p[A]=a[n+A*s];const k=A*A;do{const z=g[T];D=(p[A]-p[z]+k-z*z)/(A-z)/2}while(D<=x[T]&&--T>-1);T++,g[T]=A,x[T]=D,x[T+1]=Wp}for(let A=0,T=0;A<u;A++){for(;x[T+1]<A;)T++;const D=g[T],k=A-D;a[n+A*s]=p[D]+k*k}}const Dv={none:0,ideographs:1,all:2};class xh{constructor(n,s,u){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n){this.url=n}getGlyphs(n,s){const u=[];for(const p in n)for(const g of n[p])u.push({stack:p,id:g});Le(u,({stack:p,id:g},x)=>{let A=this.entries[p];A||(A=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=A.glyphs[g];if(T!==void 0)return void x(null,{stack:p,id:g,glyph:T});if(T=this._tinySDF(A,p,g),T)return A.glyphs[g]=T,void x(null,{stack:p,id:g,glyph:T});const D=Math.floor(g/256);if(256*D>65535)return void x(new Error("glyphs > 65535 not supported"));if(A.ranges[D])return void x(null,{stack:p,id:g,glyph:T});let k=A.requests[D];k||(k=A.requests[D]=[],xh.loadGlyphRange(p,D,this.url,this.requestManager,(z,N)=>{if(N){A.ascender=N.ascender,A.descender=N.descender;for(const H in N.glyphs)this._doesCharSupportLocalGlyph(+H)||(A.glyphs[+H]=N.glyphs[+H]);A.ranges[D]=!0}for(const H of k)H(z,N);delete A.requests[D]})),k.push((z,N)=>{z?x(z):N&&x(null,{stack:p,id:g,glyph:N.glyphs[g]||null})})},(p,g)=>{if(p)s(p);else if(g){const x={};for(const{stack:A,id:T,glyph:D}of g)x[A]===void 0&&(x[A]={}),x[A].glyphs===void 0&&(x[A].glyphs={}),x[A].glyphs[T]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},x[A].ascender=this.entries[A].ascender,x[A].descender=this.entries[A].descender;s(null,x)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==Dv.none&&(this.localGlyphMode===Dv.all?!!this.localFontFamily:!!this.localFontFamily&&(xp(n)||Ng(n)||nc(n)||Qu(n)||Ju(n)))}_tinySDF(n,s,u){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let g=n.tinySDF;if(!g){let te="400";/bold/i.test(s)?te="900":/medium/i.test(s)?te="500":/light/i.test(s)&&(te="200"),g=n.tinySDF=new xh.TinySDF({fontFamily:p,fontWeight:te,fontSize:48,buffer:6,radius:16}),g.fontWeight=te}if(this.localGlyphs[g.fontWeight][u])return this.localGlyphs[g.fontWeight][u];const x=String.fromCharCode(u),{data:A,width:T,height:D,glyphWidth:k,glyphHeight:z,glyphLeft:N,glyphTop:H,glyphAdvance:K}=g.draw(x);return this.localGlyphs[g.fontWeight][u]={id:u,bitmap:new ss({width:T,height:D},A),metrics:{width:k/2,height:z/2,left:N/2,top:H/2-27,advance:K/2,localGlyph:!0}}}}function dM(a,n,s,u){const p=[],g=a.image,x=g.pixelRatio,A=g.paddedRect.w-2,T=g.paddedRect.h-2,D=a.right-a.left,k=a.bottom-a.top,z=g.stretchX||[[0,A]],N=g.stretchY||[[0,T]],H=(it,pt)=>it+pt[1]-pt[0],K=z.reduce(H,0),te=N.reduce(H,0),ae=A-K,he=T-te;let Pe=0,Be=K,Oe=0,qe=te,Ye=0,st=ae,ut=0,vt=he;if(g.content&&u){const it=g.content;Pe=uy(z,0,it[0]),Oe=uy(N,0,it[1]),Be=uy(z,it[0],it[2]),qe=uy(N,it[1],it[3]),Ye=it[0]-Pe,ut=it[1]-Oe,st=it[2]-it[0]-Be,vt=it[3]-it[1]-qe}const Mt=(it,pt,Tt,zt)=>{const Dt=hy(it.stretch-Pe,Be,D,a.left),Bt=dy(it.fixed-Ye,st,it.stretch,K),Cn=hy(pt.stretch-Oe,qe,k,a.top),Hn=dy(pt.fixed-ut,vt,pt.stretch,te),Dn=hy(Tt.stretch-Pe,Be,D,a.left),Vn=dy(Tt.fixed-Ye,st,Tt.stretch,K),$t=hy(zt.stretch-Oe,qe,k,a.top),Wt=dy(zt.fixed-ut,vt,zt.stretch,te),Wn=new b(Dt,Cn),ti=new b(Dn,Cn),Hi=new b(Dn,$t),gi=new b(Dt,$t),Wi=new b(Bt/x,Hn/x),ni=new b(Vn/x,Wt/x),Yn=n*Math.PI/180;if(Yn){const Ii=Math.sin(Yn),qi=Math.cos(Yn),nr=[qi,-Ii,Ii,qi];Wn._matMult(nr),ti._matMult(nr),gi._matMult(nr),Hi._matMult(nr)}const si=it.stretch+it.fixed,Pi=pt.stretch+pt.fixed;return{tl:Wn,tr:ti,bl:gi,br:Hi,tex:{x:g.paddedRect.x+1+si,y:g.paddedRect.y+1+Pi,w:Tt.stretch+Tt.fixed-si,h:zt.stretch+zt.fixed-Pi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wi,pixelOffsetBR:ni,minFontScaleX:st/x/D,minFontScaleY:vt/x/k,isSDF:s}};if(u&&(g.stretchX||g.stretchY)){const it=pM(z,ae,K),pt=pM(N,he,te);for(let Tt=0;Tt<it.length-1;Tt++){const zt=it[Tt],Dt=it[Tt+1];for(let Bt=0;Bt<pt.length-1;Bt++)p.push(Mt(zt,pt[Bt],Dt,pt[Bt+1]))}}else p.push(Mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:T+1}));return p}function uy(a,n,s){let u=0;for(const p of a)u+=Math.max(n,Math.min(s,p[1]))-Math.max(n,Math.min(s,p[0]));return u}function pM(a,n,s){const u=[{fixed:-1,stretch:0}];for(const[p,g]of a){const x=u[u.length-1];u.push({fixed:p-x.stretch,stretch:x.stretch}),u.push({fixed:p-x.stretch,stretch:x.stretch+(g-p)})}return u.push({fixed:n+1,stretch:s}),u}function hy(a,n,s,u){return a/n*s+u}function dy(a,n,s,u){return a-n*s/u}function hB(a,n,s,u){const p=n+a.positionedLines[u].lineOffset;return u===0?s+p/2:s+(p+(n+a.positionedLines[u-1].lineOffset))/2}xh.loadGlyphRange=function(a,n,s,u,p){const g=256*n,x=g+255,A=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",a).replace("{range}",`${g}-${x}`),de.Glyphs);Ae(A,(T,D)=>{if(T)p(T);else if(D){const k={},z=function(N){return new jp(N).readFields(iB,{})}(D);for(const N of z.glyphs)k[N.id]=N;p(null,{glyphs:k,ascender:z.ascender,descender:z.descender})}})},xh.TinySDF=class{constructor({fontSize:a=24,buffer:n=3,radius:s=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:x="normal"}){this.buffer=n,this.cutoff=u,this.radius=s;const A=this.size=a+4*n,T=this._createCanvas(A),D=this.ctx=T.getContext("2d",{willReadFrequently:!0});D.font=`${x} ${g} ${a}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(a){const n=document.createElement("canvas");return n.width=n.height=a,n}draw(a){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(a),x=Math.floor(s),A=Math.min(this.size-this.buffer,Math.ceil(g-p)),T=Math.min(this.size-this.buffer,Math.ceil(s)+Math.ceil(u)),D=A+2*this.buffer,k=T+2*this.buffer,z=D*k,N=new Uint8ClampedArray(z),H={data:N,width:D,height:k,glyphWidth:A,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:n};if(A===0||T===0)return H;const{ctx:K,buffer:te,gridInner:ae,gridOuter:he}=this;K.clearRect(te,te,A,T),K.fillText(a,te,te+x+1);const Pe=K.getImageData(te,te,A,T);he.fill(Wp,0,z),ae.fill(0,0,z);for(let Be=0;Be<T;Be++)for(let Oe=0;Oe<A;Oe++){const qe=Pe.data[4*(Be*A+Oe)+3]/255;if(qe===0)continue;const Ye=(Be+te)*D+Oe+te;if(qe===1)he[Ye]=0,ae[Ye]=Wp;else{const st=.5-qe;he[Ye]=st>0?st*st:0,ae[Ye]=st<0?st*st:0}}uM(he,0,0,D,k,D,this.f,this.v,this.z),uM(ae,te,te,A,T,D,this.f,this.v,this.z);for(let Be=0;Be<z;Be++){const Oe=Math.sqrt(he[Be])-Math.sqrt(ae[Be]);N[Be]=Math.round(255-255*(Oe/this.radius+this.cutoff))}return H}};class dB{constructor(n=[],s=pB){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:u}=this,p=s[n];for(;n>0;){const g=n-1>>1,x=s[g];if(u(p,x)>=0)break;s[n]=x,n=g}s[n]=p}_down(n){const{data:s,compare:u}=this,p=this.length>>1,g=s[n];for(;n<p;){let x=1+(n<<1),A=s[x];const T=x+1;if(T<this.length&&u(s[T],A)<0&&(x=T,A=s[T]),u(A,g)>=0)break;s[n]=A,n=x}s[n]=g}}function pB(a,n){return a<n?-1:a>n?1:0}function fB(a,n=1,s=!1){let u=1/0,p=1/0,g=-1/0,x=-1/0;const A=a[0];for(let H=0;H<A.length;H++){const K=A[H];(!H||K.x<u)&&(u=K.x),(!H||K.y<p)&&(p=K.y),(!H||K.x>g)&&(g=K.x),(!H||K.y>x)&&(x=K.y)}const T=Math.min(g-u,x-p);let D=T/2;const k=new dB([],mB);if(T===0)return new b(u,p);for(let H=u;H<g;H+=T)for(let K=p;K<x;K+=T)k.push(new vh(H+D,K+D,D,a));let z=function(H){let K=0,te=0,ae=0;const he=H[0];for(let Pe=0,Be=he.length,Oe=Be-1;Pe<Be;Oe=Pe++){const qe=he[Pe],Ye=he[Oe],st=qe.x*Ye.y-Ye.x*qe.y;te+=(qe.x+Ye.x)*st,ae+=(qe.y+Ye.y)*st,K+=3*st}return new vh(te/K,ae/K,0,H)}(a),N=k.length;for(;k.length;){const H=k.pop();(H.d>z.d||!z.d)&&(z=H,s&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,N)),H.max-z.d<=n||(D=H.h/2,k.push(new vh(H.p.x-D,H.p.y-D,D,a)),k.push(new vh(H.p.x+D,H.p.y-D,D,a)),k.push(new vh(H.p.x-D,H.p.y+D,D,a)),k.push(new vh(H.p.x+D,H.p.y+D,D,a)),N+=4)}return s&&(console.log(`num probes: ${N}`),console.log(`best distance: ${z.d}`)),z.p}function mB(a,n){return n.max-a.max}function vh(a,n,s,u){this.p=new b(a,n),this.h=s,this.d=function(p,g){let x=!1,A=1/0;for(let T=0;T<g.length;T++){const D=g[T];for(let k=0,z=D.length,N=z-1;k<z;N=k++){const H=D[k],K=D[N];H.y>p.y!=K.y>p.y&&p.x<(K.x-H.x)*(p.y-H.y)/(K.y-H.y)+H.x&&(x=!x),A=Math.min(A,cA(p,H,K))}}return(x?1:-1)*Math.sqrt(A)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}const Iv=Number.POSITIVE_INFINITY,gB=Math.sqrt(2);function fM(a,n){return n[1]!==Iv?function(s,u,p){let g=0,x=0;switch(u=Math.abs(u),p=Math.abs(p),s){case"top-right":case"top-left":case"top":x=p-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-p}switch(s){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,x]}(a,n[0],n[1]):function(s,u){let p=0,g=0;u<0&&(u=0);const x=u/gB;switch(s){case"top-right":case"top-left":g=x-7;break;case"bottom-right":case"bottom-left":g=7-x;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(s){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=u;break;case"right":p=-u}return[p,g]}(a,n[0])}function yB(a,n,s,u,p,g,x,A,T,D){a.createArrays(),a.tilePixelRatio=Bn/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const k=a.layers[0].layout,z=a.layers[0]._unevaluatedLayout._values,N={};if(a.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ae}=a.textSizeData;N.compositeTextSizes=[z["text-size"].possiblyEvaluate(new mi(te),A),z["text-size"].possiblyEvaluate(new mi(ae),A)]}if(a.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ae}=a.iconSizeData;N.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new mi(te),A),z["icon-size"].possiblyEvaluate(new mi(ae),A)]}N.layoutTextSize=z["text-size"].possiblyEvaluate(new mi(T+1),A),N.layoutIconSize=z["icon-size"].possiblyEvaluate(new mi(T+1),A),N.textMaxSize=z["text-size"].possiblyEvaluate(new mi(18),A);const H=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",K=k.get("text-size");for(const te of a.features){const ae=k.get("text-font").evaluate(te,{},A).join(","),he=K.evaluate(te,{},A),Pe=N.layoutTextSize.evaluate(te,{},A),Be=(N.layoutIconSize.evaluate(te,{},A),{horizontal:{},vertical:void 0}),Oe=te.text;let qe,Ye=[0,0];if(Oe){const vt=Oe.toString(),Mt=k.get("text-letter-spacing").evaluate(te,{},A)*dr,it=k.get("text-line-height").evaluate(te,{},A)*dr,pt=Gg(vt)?Mt:0,Tt=k.get("text-anchor").evaluate(te,{},A),zt=k.get("text-variable-anchor");if(!zt){const Vn=k.get("text-radial-offset").evaluate(te,{},A);Ye=Vn?fM(Tt,[Vn*dr,Iv]):k.get("text-offset").evaluate(te,{},A).map($t=>$t*dr)}let Dt=H?"center":k.get("text-justify").evaluate(te,{},A);const Bt=k.get("symbol-placement"),Cn=Bt==="point",Hn=Bt==="point"?k.get("text-max-width").evaluate(te,{},A)*dr:0,Dn=Vn=>{a.allowVerticalPlacement&&eh(vt)&&(Be.vertical=Pv(Oe,n,s,p,ae,Hn,it,Tt,Vn,pt,Ye,Ao.vertical,!0,Bt,Pe,he))};if(!H&&zt){const Vn=Dt==="auto"?zt.map(Wt=>Lv(Wt)):[Dt];let $t=!1;for(let Wt=0;Wt<Vn.length;Wt++){const Wn=Vn[Wt];if(!Be.horizontal[Wn])if($t)Be.horizontal[Wn]=Be.horizontal[0];else{const ti=Pv(Oe,n,s,p,ae,Hn,it,"center",Wn,pt,Ye,Ao.horizontal,!1,Bt,Pe,he);ti&&(Be.horizontal[Wn]=ti,$t=ti.positionedLines.length===1)}}Dn("left")}else{if(Dt==="auto"&&(Dt=Lv(Tt)),Cn||k.get("text-writing-mode").indexOf("horizontal")>=0||!eh(vt)){const Vn=Pv(Oe,n,s,p,ae,Hn,it,Tt,Dt,pt,Ye,Ao.horizontal,!1,Bt,Pe,he);Vn&&(Be.horizontal[Dt]=Vn)}Dn(Bt==="point"?"left":Dt)}}let st=!1;if(te.icon&&te.icon.name){const vt=u[te.icon.name];vt&&(qe=lB(p[te.icon.name],k.get("icon-offset").evaluate(te,{},A),k.get("icon-anchor").evaluate(te,{},A)),st=vt.sdf,a.sdfIcons===void 0?a.sdfIcons=vt.sdf:a.sdfIcons!==vt.sdf&&pe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(vt.pixelRatio!==a.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const ut=gM(Be.horizontal)||Be.vertical;a.iconsInText||(a.iconsInText=!!ut&&ut.iconsInText),(ut||qe)&&xB(a,te,Be,qe,u,N,Pe,0,Ye,st,x,A,D)}g&&a.generateCollisionDebugBuffers(T,a.collisionBoxArray)}function Lv(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xB(a,n,s,u,p,g,x,A,T,D,k,z,N){let H=g.textMaxSize.evaluate(n,{},z);H===void 0&&(H=x);const K=a.layers[0].layout,te=K.get("icon-offset").evaluate(n,{},z),ae=gM(s.horizontal)||s.vertical,he=x/24,Pe=a.tilePixelRatio*H/24,Be=(it=a.overscaling,a.zoom>18&&it>2&&(it>>=1),Math.max(Bn/(512*it),1)*K.get("symbol-spacing")),Oe=K.get("text-padding")*a.tilePixelRatio,qe=K.get("icon-padding")*a.tilePixelRatio,Ye=B(K.get("text-max-angle")),st=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",ut=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",vt=K.get("symbol-placement"),Mt=Be/2;var it;const pt=K.get("icon-text-fit");let Tt;u&&pt!=="none"&&(a.allowVerticalPlacement&&s.vertical&&(Tt=iM(u,s.vertical,pt,K.get("icon-text-fit-padding"),te,he)),ae&&(u=iM(u,ae,pt,K.get("icon-text-fit-padding"),te,he)));const zt=(Dt,Bt,Cn)=>{if(Bt.x<0||Bt.x>=Bn||Bt.y<0||Bt.y>=Bn)return;const{x:Hn,y:Dn,z:Vn}=N.projectTilePoint(Bt.x,Bt.y,Cn),$t=new cs(Hn,Dn,Vn,0,void 0);(function(Wt,Wn,ti,Hi,gi,Wi,ni,Yn,si,Pi,Ii,qi,nr,oo,jr,li,Er,ao,sr,ir,_i,yi,Hr,Pr,Ni){const Cr=Wt.addToLineVertexArray(Wn,Hi);let xr,rr,Fo,sl,ef,tf,QM,$M=0,e2=0,t2=0,n2=0,Zv=-1,Jv=-1;const La={};let i2=Ta(""),Qv=0,$v=0;if(si._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Qv,$v]=si.layout.get("text-offset").evaluate(_i,{},Ni).map(so=>so*dr):(Qv=si.layout.get("text-radial-offset").evaluate(_i,{},Ni)*dr,$v=Iv),Wt.allowVerticalPlacement&&gi.vertical){const so=gi.vertical;if(jr)tf=Fv(so),Yn&&(QM=Fv(Yn));else{const lo=si.layout.get("text-rotate").evaluate(_i,{},Ni)+90;Fo=py(Pi,ti,Wn,Ii,qi,nr,so,oo,lo,li),Yn&&(sl=py(Pi,ti,Wn,Ii,qi,nr,Yn,ao,lo))}}if(Wi){const so=si.layout.get("icon-rotate").evaluate(_i,{},Ni),lo=si.layout.get("icon-text-fit")!=="none",nf=dM(Wi,so,Hr,lo),t_=Yn?dM(Yn,so,Hr,lo):void 0;rr=py(Pi,ti,Wn,Ii,qi,nr,Wi,ao,so),$M=4*nf.length;const r2=Wt.iconSizeData;let mc=null;r2.kind==="source"?(mc=[Ca*si.layout.get("icon-size").evaluate(_i,{},Ni)],mc[0]>tl&&pe(`${Wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):r2.kind==="composite"&&(mc=[Ca*yi.compositeIconSizes[0].evaluate(_i,{},Ni),Ca*yi.compositeIconSizes[1].evaluate(_i,{},Ni)],(mc[0]>tl||mc[1]>tl)&&pe(`${Wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Wt.addSymbols(Wt.icon,nf,mc,ir,sr,_i,!1,ti,Wn,Cr.lineStartIndex,Cr.lineLength,-1,Pr,Ni),Zv=Wt.icon.placedSymbolArray.length-1,t_&&(e2=4*t_.length,Wt.addSymbols(Wt.icon,t_,mc,ir,sr,_i,Ao.vertical,ti,Wn,Cr.lineStartIndex,Cr.lineLength,-1,Pr,Ni),Jv=Wt.icon.placedSymbolArray.length-1)}for(const so in gi.horizontal){const lo=gi.horizontal[so];xr||(i2=Ta(lo.text),jr?ef=Fv(lo):xr=py(Pi,ti,Wn,Ii,qi,nr,lo,oo,si.layout.get("text-rotate").evaluate(_i,{},Ni),li));const nf=lo.positionedLines.length===1;if(t2+=mM(Wt,ti,Wn,lo,ni,si,jr,_i,li,Cr,gi.vertical?Ao.horizontal:Ao.horizontalOnly,nf?Object.keys(gi.horizontal):[so],La,Zv,yi,Pr,Ni),nf)break}gi.vertical&&(n2+=mM(Wt,ti,Wn,gi.vertical,ni,si,jr,_i,li,Cr,Ao.vertical,["vertical"],La,Jv,yi,Pr,Ni));let ll=-1;const e_=(so,lo)=>so?Math.max(so,lo):lo;ll=e_(ef,ll),ll=e_(tf,ll),ll=e_(QM,ll);const QB=ll>-1?1:0;Wt.glyphOffsetArray.length>=nl.MAX_GLYPHS&&pe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),_i.sortKey!==void 0&&Wt.addToSortKeyRanges(Wt.symbolInstances.length,_i.sortKey),Wt.symbolInstances.emplaceBack(ti.x,ti.y,ti.z,Wn.x,Wn.y,La.right>=0?La.right:-1,La.center>=0?La.center:-1,La.left>=0?La.left:-1,La.vertical>=0?La.vertical:-1,Zv,Jv,i2,xr!==void 0?xr:Wt.collisionBoxArray.length,xr!==void 0?xr+1:Wt.collisionBoxArray.length,Fo!==void 0?Fo:Wt.collisionBoxArray.length,Fo!==void 0?Fo+1:Wt.collisionBoxArray.length,rr!==void 0?rr:Wt.collisionBoxArray.length,rr!==void 0?rr+1:Wt.collisionBoxArray.length,sl||Wt.collisionBoxArray.length,sl?sl+1:Wt.collisionBoxArray.length,Ii,t2,n2,$M,e2,QB,0,Qv,$v,ll)})(a,Bt,$t,Dt,s,u,p,Tt,a.layers[0],a.collisionBoxArray,n.index,n.sourceLayerIndex,a.index,Oe,st,T,0,qe,ut,te,n,g,D,k,z)};if(vt==="line")for(const Dt of cM(n.geometry,0,0,Bn,Bn)){const Bt=uB(Dt,Be,Ye,s.vertical||ae,u,24,Pe,a.overscaling,Bn);for(const Cn of Bt){const Hn=ae;Hn&&vB(a,Hn.text,Mt,Cn)||zt(Dt,Cn,z)}}else if(vt==="line-center"){for(const Dt of n.geometry)if(Dt.length>1){const Bt=cB(Dt,Ye,s.vertical||ae,u,24,Pe);Bt&&zt(Dt,Bt,z)}}else if(n.type==="Polygon")for(const Dt of bv(n.geometry,0)){const Bt=fB(Dt,16);zt(Dt[0],new cs(Bt.x,Bt.y,0,0,void 0),z)}else if(n.type==="LineString")for(const Dt of n.geometry)zt(Dt,new cs(Dt[0].x,Dt[0].y,0,0,void 0),z);else if(n.type==="Point")for(const Dt of n.geometry)for(const Bt of Dt)zt([Bt],new cs(Bt.x,Bt.y,0,0,void 0),z)}const tl=32640;function mM(a,n,s,u,p,g,x,A,T,D,k,z,N,H,K,te,ae){const he=function(Oe,qe,Ye,st,ut,vt,Mt,it){const pt=[];if(qe.positionedLines.length===0)return pt;const Tt=st.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,zt=function(Dn){const Vn=Dn[0],$t=Dn[1],Wt=Vn*$t;return Wt>0?[Vn,-$t]:Wt<0?[-Vn,$t]:Vn===0?[$t,Vn]:[$t,-Vn]}(Ye);let Dt=Math.abs(qe.top-qe.bottom);for(const Dn of qe.positionedLines)Dt-=Dn.lineOffset;const Bt=qe.positionedLines.length,Cn=Dt/Bt;let Hn=qe.top-Ye[1];for(let Dn=0;Dn<Bt;++Dn){const Vn=qe.positionedLines[Dn];Hn=hB(qe,Cn,Hn,Dn);for(const $t of Vn.positionedGlyphs){if(!$t.rect)continue;const Wt=$t.rect||{};let Wn=4,ti=!0,Hi=1,gi=0;if($t.imageName){const yi=Mt[$t.imageName];if(!yi)continue;if(yi.sdf){pe("SDF images are not supported in formatted text and will be ignored.");continue}ti=!1,Hi=yi.pixelRatio,Wn=1/Hi}const Wi=(ut||it)&&$t.vertical,ni=$t.metrics.advance*$t.scale/2,Yn=$t.metrics,si=$t.rect;if(si===null)continue;it&&qe.verticalizable&&(gi=$t.imageName?ni-$t.metrics.width*$t.scale/2:0);const Pi=ut?[$t.x+ni,$t.y]:[0,0];let Ii=[0,0],qi=[0,0],nr=!1;ut||(Wi?(qi=[$t.x+ni+zt[0],$t.y+zt[1]-gi],nr=!0):Ii=[$t.x+ni+Ye[0],$t.y+Ye[1]-gi]);const oo=si.w*$t.scale/(Hi*($t.localGlyph?2:1)),jr=si.h*$t.scale/(Hi*($t.localGlyph?2:1));let li,Er,ao,sr;if(Wi){const yi=$t.y-Hn,Hr=new b(-ni,ni-yi),Pr=-Math.PI/2,Ni=new b(...qi);li=new b(-ni+Ii[0],Ii[1]),li._rotateAround(Pr,Hr)._add(Ni),li.x+=-yi+ni,li.y-=(Yn.left-Wn)*$t.scale;const Cr=$t.imageName?Yn.advance*$t.scale:dr*$t.scale,xr=String.fromCharCode($t.glyph);qk(xr)?li.x+=(1-Wn)*$t.scale:Yk(xr)?li.x+=Cr-Yn.height*$t.scale+(-Wn-1)*$t.scale:li.x+=$t.imageName||Yn.width+2*Wn===si.w&&Yn.height+2*Wn===si.h?(Cr-jr)/2:(Cr-(Yn.height+2*Wn)*$t.scale)/2,Er=new b(li.x,li.y-oo),ao=new b(li.x+jr,li.y),sr=new b(li.x+jr,li.y-oo)}else{const yi=(Yn.left-Wn)*$t.scale-ni+Ii[0],Hr=(-Yn.top-Wn)*$t.scale+Ii[1],Pr=yi+oo,Ni=Hr+jr;li=new b(yi,Hr),Er=new b(Pr,Hr),ao=new b(yi,Ni),sr=new b(Pr,Ni)}if(Tt){let yi;yi=ut?new b(0,0):nr?new b(zt[0],zt[1]):new b(Ye[0],Ye[1]),li._rotateAround(Tt,yi),Er._rotateAround(Tt,yi),ao._rotateAround(Tt,yi),sr._rotateAround(Tt,yi)}const ir=new b(0,0),_i=new b(0,0);pt.push({tl:li,tr:Er,bl:ao,br:sr,tex:Wt,writingMode:qe.writingMode,glyphOffset:Pi,sectionIndex:$t.sectionIndex,isSDF:ti,pixelOffsetTL:ir,pixelOffsetBR:_i,minFontScaleX:0,minFontScaleY:0})}}return pt}(0,u,T,g,x,A,p,a.allowVerticalPlacement),Pe=a.textSizeData;let Be=null;Pe.kind==="source"?(Be=[Ca*g.layout.get("text-size").evaluate(A,{},ae)],Be[0]>tl&&pe(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Pe.kind==="composite"&&(Be=[Ca*K.compositeTextSizes[0].evaluate(A,{},ae),Ca*K.compositeTextSizes[1].evaluate(A,{},ae)],(Be[0]>tl||Be[1]>tl)&&pe(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,he,Be,T,x,A,k,n,s,D.lineStartIndex,D.lineLength,H,te,ae);for(const Oe of z)N[Oe]=a.text.placedSymbolArray.length-1;return 4*he.length}function gM(a){for(const n in a)return a[n];return null}function py(a,n,s,u,p,g,x,A,T,D){let k=x.top,z=x.bottom,N=x.left,H=x.right;const K=x.collisionPadding;if(K&&(N-=K[0],k-=K[1],H+=K[2],z+=K[3]),T){const te=new b(N,k),ae=new b(H,k),he=new b(N,z),Pe=new b(H,z),Be=B(T);let Oe=new b(0,0);D&&(Oe=new b(D[0],D[1])),te._rotateAround(Be,Oe),ae._rotateAround(Be,Oe),he._rotateAround(Be,Oe),Pe._rotateAround(Be,Oe),N=Math.min(te.x,ae.x,he.x,Pe.x),H=Math.max(te.x,ae.x,he.x,Pe.x),k=Math.min(te.y,ae.y,he.y,Pe.y),z=Math.max(te.y,ae.y,he.y,Pe.y)}return a.emplaceBack(n.x,n.y,n.z,s.x,s.y,N,k,H,z,A,u,p,g),a.length-1}function Fv(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const n=a.bottom-a.top;return n>0?Math.max(10,n):null}function vB(a,n,s,u){const p=a.compareText;if(n in p){const g=p[n];for(let x=g.length-1;x>=0;x--)if(u.dist(g[x])<s)return!0}else p[n]=[];return p[n].push(u),!1}const _B=dc.VectorTileFeature.types,bB=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fy(a,n,s,u,p,g,x,A,T,D,k,z,N,H,K,te){const ae=k?Math.min(tl,Math.round(k[0])):0,he=k?Math.min(tl,Math.round(k[1])):0;a.emplaceBack(n,s,Math.round(32*x),Math.round(32*A),T,D,(ae<<1)+(z?1:0),he,16*N,16*H,256*K,256*te,u,p,g,0)}function kv(a,n,s){a.emplaceBack(n.x,n.y,s),a.emplaceBack(n.x,n.y,s),a.emplaceBack(n.x,n.y,s),a.emplaceBack(n.x,n.y,s)}function wB(a){for(const n of a.sections)if(Zx(n.text))return!0;return!1}class Bv{constructor(n){this.layoutVertexArray=new ct,this.indexArray=new Yt,this.programConfigurations=n,this.segments=new Di,this.dynamicLayoutVertexArray=new Ft,this.opacityVertexArray=new $e,this.placedSymbolArray=new Jo}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Nk.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Vk.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,bB,!0),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}qt(Bv,"SymbolBuffers");class zv{constructor(n,s,u){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new u,this.segments=new Di,this.collisionVertexArray=new dt,this.collisionVertexArrayExt=new Ft}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Ok.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,Gk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}qt(zv,"CollisionBuffers");class nl{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Pa([]),this.placementViewportMatrix=Pa([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Mv(this.zoom,s["text-size"]),this.iconSizeData=Mv(this.zoom,s["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(x=>Ao[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID,this.projection=n.projection}createArrays(){this.text=new Bv(new lc(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Bv(new lc(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new ei,this.lineVertexArray=new zi,this.symbolInstances=new Ri}calculateGlyphDependencies(n,s,u,p,g){for(let x=0;x<n.length;x++)if(s[n.charCodeAt(x)]=!0,p&&g){const A=Gp[n.charAt(x)];A&&(s[A.charCodeAt(0)]=!0)}}populate(n,s,u,p){const g=this.layers[0],x=g.layout,A=x.get("text-font"),T=x.get("text-field"),D=x.get("icon-image"),k=(T.value.kind!=="constant"||T.value.value instanceof ji&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),z=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,N=x.get("symbol-sort-key");if(this.features=[],!k&&!z)return;const H=s.iconDependencies,K=s.glyphDependencies,te=s.availableImages,ae=new mi(this.zoom);for(const{feature:he,id:Pe,index:Be,sourceLayerIndex:Oe}of n){const qe=g._featureFilter.needGeometry,Ye=cc(he,qe);if(!g._featureFilter.filter(ae,Ye,u))continue;let st,ut;if(qe||(Ye.geometry=as(he,u,p)),k){const Mt=g.getValueAndResolveTokens("text-field",Ye,u,te),it=ji.factory(Mt);wB(it)&&(this.hasRTLText=!0),(!this.hasRTLText||rh()==="unavailable"||this.hasRTLText&&$r.isParsed())&&(st=Wk(it,g,Ye))}if(z){const Mt=g.getValueAndResolveTokens("icon-image",Ye,u,te);ut=Mt instanceof kr?Mt:kr.fromString(Mt)}if(!st&&!ut)continue;const vt=this.sortFeaturesByKey?N.evaluate(Ye,{},u):void 0;if(this.features.push({id:Pe,text:st,icon:ut,index:Be,sourceLayerIndex:Oe,geometry:Ye.geometry,properties:he.properties,type:_B[he.type],sortKey:vt}),ut&&(H[ut.name]=!0),st){const Mt=A.evaluate(Ye,{},u).join(","),it=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ao.vertical)>=0;for(const pt of st.sections)if(pt.image)H[pt.image.name]=!0;else{const Tt=eh(st.toString()),zt=pt.fontStack||Mt,Dt=K[zt]=K[zt]||{};this.calculateGlyphDependencies(pt.text,Dt,it,this.allowVerticalPlacement,Tt)}}}x.get("symbol-placement")==="line"&&(this.features=function(he){const Pe={},Be={},Oe=[];let qe=0;function Ye(Mt){Oe.push(he[Mt]),qe++}function st(Mt,it,pt){const Tt=Be[Mt];return delete Be[Mt],Be[it]=Tt,Oe[Tt].geometry[0].pop(),Oe[Tt].geometry[0]=Oe[Tt].geometry[0].concat(pt[0]),Tt}function ut(Mt,it,pt){const Tt=Pe[it];return delete Pe[it],Pe[Mt]=Tt,Oe[Tt].geometry[0].shift(),Oe[Tt].geometry[0]=pt[0].concat(Oe[Tt].geometry[0]),Tt}function vt(Mt,it,pt){const Tt=pt?it[0][it[0].length-1]:it[0][0];return`${Mt}:${Tt.x}:${Tt.y}`}for(let Mt=0;Mt<he.length;Mt++){const it=he[Mt],pt=it.geometry,Tt=it.text?it.text.toString():null;if(!Tt){Ye(Mt);continue}const zt=vt(Tt,pt),Dt=vt(Tt,pt,!0);if(zt in Be&&Dt in Pe&&Be[zt]!==Pe[Dt]){const Bt=ut(zt,Dt,pt),Cn=st(zt,Dt,Oe[Bt].geometry);delete Pe[zt],delete Be[Dt],Be[vt(Tt,Oe[Cn].geometry,!0)]=Cn,Oe[Bt].geometry=null}else zt in Be?st(zt,Dt,pt):Dt in Pe?ut(zt,Dt,pt):(Ye(Mt),Pe[zt]=qe-1,Be[Dt]=qe-1)}return Oe.filter(Mt=>Mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,Pe)=>he.sortKey-Pe.sortKey)}update(n,s,u,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,u,p),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,u,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const u=this.lineVertexArray.length,p=n.segment;if(p!==void 0){let g=n.dist(s[p+1]),x=n.dist(s[p]);const A={};for(let T=p+1;T<s.length;T++)A[T]={x:s[T].x,y:s[T].y,tileUnitDistanceFromAnchor:g},T<s.length-1&&(g+=s[T+1].dist(s[T]));for(let T=p||0;T>=0;T--)A[T]={x:s[T].x,y:s[T].y,tileUnitDistanceFromAnchor:x},T>0&&(x+=s[T-1].dist(s[T]));for(let T=0;T<s.length;T++){const D=A[T];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,s,u,p,g,x,A,T,D,k,z,N,H,K){const te=n.indexArray,ae=n.layoutVertexArray,he=n.segments.prepareSegment(4*s.length,ae,te,this.canOverlap?x.sortKey:void 0),Pe=this.glyphOffsetArray.length,Be=he.vertexLength,Oe=this.allowVerticalPlacement&&A===Ao.vertical?Math.PI/2:0,qe=x.text&&x.text.sections;for(let Ye=0;Ye<s.length;Ye++){const{tl:st,tr:ut,bl:vt,br:Mt,tex:it,pixelOffsetTL:pt,pixelOffsetBR:Tt,minFontScaleX:zt,minFontScaleY:Dt,glyphOffset:Bt,isSDF:Cn,sectionIndex:Hn}=s[Ye],Dn=he.vertexLength,Vn=Bt[1];fy(ae,T.x,T.y,T.z,D.x,D.y,st.x,Vn+st.y,it.x,it.y,u,Cn,pt.x,pt.y,zt,Dt),fy(ae,T.x,T.y,T.z,D.x,D.y,ut.x,Vn+ut.y,it.x+it.w,it.y,u,Cn,Tt.x,pt.y,zt,Dt),fy(ae,T.x,T.y,T.z,D.x,D.y,vt.x,Vn+vt.y,it.x,it.y+it.h,u,Cn,pt.x,Tt.y,zt,Dt),fy(ae,T.x,T.y,T.z,D.x,D.y,Mt.x,Vn+Mt.y,it.x+it.w,it.y+it.h,u,Cn,Tt.x,Tt.y,zt,Dt),kv(n.dynamicLayoutVertexArray,T,Oe),te.emplaceBack(Dn,Dn+1,Dn+2),te.emplaceBack(Dn+1,Dn+2,Dn+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Bt[0]),Ye!==s.length-1&&Hn===s[Ye+1].sectionIndex||n.programConfigurations.populatePaintArrays(ae.length,x,x.index,{},H,K,qe&&qe[Hn])}n.placedSymbolArray.emplaceBack(T.x,T.y,T.z,D.x,D.y,Pe,this.glyphOffsetArray.length-Pe,Be,k,z,D.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],A,0,!1,0,N,0)}_commitLayoutVertex(n,s,u,p,g,x,A){n.emplaceBack(s,u,p,g,x,Math.round(A.x),Math.round(A.y))}_addCollisionDebugVertices(n,s,u,p,g,x,A){const T=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),D=T.vertexLength,k=A.tileAnchorX,z=A.tileAnchorY;for(let H=0;H<4;H++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(s,-n.padding,-n.padding),u.collisionVertexArrayExt.emplaceBack(s,n.padding,-n.padding),u.collisionVertexArrayExt.emplaceBack(s,n.padding,n.padding),u.collisionVertexArrayExt.emplaceBack(s,-n.padding,n.padding),this._commitLayoutVertex(u.layoutVertexArray,p,g,x,k,z,new b(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,g,x,k,z,new b(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,g,x,k,z,new b(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,g,x,k,z,new b(n.x1,n.y2)),T.vertexLength+=4;const N=u.indexArray;N.emplaceBack(D,D+1),N.emplaceBack(D+1,D+2),N.emplaceBack(D+2,D+3),N.emplaceBack(D+3,D),T.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,u,p,g,x){for(let A=p;A<g;A++){const T=u.get(A),D=this.getSymbolInstanceTextSize(n,x,s,A);this._addCollisionDebugVertices(T,D,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(n,s,u,p,g,x){for(let A=p;A<g;A++){const T=u.get(A),D=this.getSymbolInstanceIconSize(n,s,A);this._addCollisionDebugVertices(T,D,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,x)}}generateCollisionDebugBuffers(n,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zv(Ct,HA.members,Sn),this.iconCollisionBox=new zv(Ct,HA.members,Sn);const u=fh(this.iconSizeData,n),p=fh(this.textSizeData,n);for(let g=0;g<this.symbolInstances.length;g++){const x=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(p,n,s,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(p,n,s,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(u,n,s,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(u,n,s,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(n,s,u,p){const g=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:p),x=sy(this.textSizeData,n,g)/dr;return this.tilePixelRatio*x}getSymbolInstanceIconSize(n,s,u){const p=this.icon.placedSymbolArray.get(u),g=sy(this.iconSizeData,n,p);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(n,s,u){n.emplaceBack(s,-u,-u),n.emplaceBack(s,u,-u),n.emplaceBack(s,u,u),n.emplaceBack(s,-u,u)}_updateTextDebugCollisionBoxes(n,s,u,p,g,x){for(let A=p;A<g;A++){const T=u.get(A),D=this.getSymbolInstanceTextSize(n,x,s,A);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,T.padding)}}_updateIconDebugCollisionBoxes(n,s,u,p,g){for(let x=p;x<g;x++){const A=u.get(x),T=this.getSymbolInstanceIconSize(n,s,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,A.padding)}}updateCollisionDebugBuffers(n,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=fh(this.iconSizeData,n),p=fh(this.textSizeData,n);for(let g=0;g<this.symbolInstances.length;g++){const x=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(p,n,s,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(p,n,s,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(u,n,s,x.iconBoxStartIndex,x.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(u,n,s,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,u,p,g,x,A,T,D){const k={};for(let z=s;z<u;z++){const N=n.get(z);k.textBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,padding:N.padding,projectedAnchorX:N.projectedAnchorX,projectedAnchorY:N.projectedAnchorY,projectedAnchorZ:N.projectedAnchorZ,tileAnchorX:N.tileAnchorX,tileAnchorY:N.tileAnchorY},k.textFeatureIndex=N.featureIndex;break}for(let z=p;z<g;z++){const N=n.get(z);k.verticalTextBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,padding:N.padding,projectedAnchorX:N.projectedAnchorX,projectedAnchorY:N.projectedAnchorY,projectedAnchorZ:N.projectedAnchorZ,tileAnchorX:N.tileAnchorX,tileAnchorY:N.tileAnchorY},k.verticalTextFeatureIndex=N.featureIndex;break}for(let z=x;z<A;z++){const N=n.get(z);k.iconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,padding:N.padding,projectedAnchorX:N.projectedAnchorX,projectedAnchorY:N.projectedAnchorY,projectedAnchorZ:N.projectedAnchorZ,tileAnchorX:N.tileAnchorX,tileAnchorY:N.tileAnchorY},k.iconFeatureIndex=N.featureIndex;break}for(let z=T;z<D;z++){const N=n.get(z);k.verticalIconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,padding:N.padding,projectedAnchorX:N.projectedAnchorX,projectedAnchorY:N.projectedAnchorY,projectedAnchorZ:N.projectedAnchorZ,tileAnchorX:N.tileAnchorX,tileAnchorY:N.tileAnchorY},k.verticalIconFeatureIndex=N.featureIndex;break}return k}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const u=n.placedSymbolArray.get(s),p=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<p;g+=4)n.indexArray.emplaceBack(g,g+1,g+2),n.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),u=Math.cos(n),p=[],g=[],x=[];for(let A=0;A<this.symbolInstances.length;++A){x.push(A);const T=this.symbolInstances.get(A);p.push(0|Math.round(s*T.tileAnchorX+u*T.tileAnchorY)),g.push(T.featureIndex)}return x.sort((A,T)=>p[A]-p[T]||g[T]-g[A]),x}addToSortKeyRanges(n,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((p,g,x)=>{p>=0&&x.indexOf(p)===g&&this.addIndicesForPlacedSymbol(this.text,p)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}qt(nl,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nl.MAX_GLYPHS=65535,nl.addDynamicAttributes=kv;const AB=new Y({"symbol-placement":new C(me.layout_symbol["symbol-placement"]),"symbol-spacing":new C(me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new C(me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new L(me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new C(me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new C(me.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new C(me.layout_symbol["icon-ignore-placement"]),"icon-optional":new C(me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new C(me.layout_symbol["icon-rotation-alignment"]),"icon-size":new L(me.layout_symbol["icon-size"]),"icon-text-fit":new C(me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new C(me.layout_symbol["icon-text-fit-padding"]),"icon-image":new L(me.layout_symbol["icon-image"]),"icon-rotate":new L(me.layout_symbol["icon-rotate"]),"icon-padding":new C(me.layout_symbol["icon-padding"]),"icon-keep-upright":new C(me.layout_symbol["icon-keep-upright"]),"icon-offset":new L(me.layout_symbol["icon-offset"]),"icon-anchor":new L(me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new C(me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new C(me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new C(me.layout_symbol["text-rotation-alignment"]),"text-field":new L(me.layout_symbol["text-field"]),"text-font":new L(me.layout_symbol["text-font"]),"text-size":new L(me.layout_symbol["text-size"]),"text-max-width":new L(me.layout_symbol["text-max-width"]),"text-line-height":new L(me.layout_symbol["text-line-height"]),"text-letter-spacing":new L(me.layout_symbol["text-letter-spacing"]),"text-justify":new L(me.layout_symbol["text-justify"]),"text-radial-offset":new L(me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new C(me.layout_symbol["text-variable-anchor"]),"text-anchor":new L(me.layout_symbol["text-anchor"]),"text-max-angle":new C(me.layout_symbol["text-max-angle"]),"text-writing-mode":new C(me.layout_symbol["text-writing-mode"]),"text-rotate":new L(me.layout_symbol["text-rotate"]),"text-padding":new C(me.layout_symbol["text-padding"]),"text-keep-upright":new C(me.layout_symbol["text-keep-upright"]),"text-transform":new L(me.layout_symbol["text-transform"]),"text-offset":new L(me.layout_symbol["text-offset"]),"text-allow-overlap":new C(me.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new C(me.layout_symbol["text-ignore-placement"]),"text-optional":new C(me.layout_symbol["text-optional"])});var Uv={paint:new Y({"icon-opacity":new L(me.paint_symbol["icon-opacity"]),"icon-color":new L(me.paint_symbol["icon-color"]),"icon-halo-color":new L(me.paint_symbol["icon-halo-color"]),"icon-halo-width":new L(me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new L(me.paint_symbol["icon-halo-blur"]),"icon-translate":new C(me.paint_symbol["icon-translate"]),"icon-translate-anchor":new C(me.paint_symbol["icon-translate-anchor"]),"text-opacity":new L(me.paint_symbol["text-opacity"]),"text-color":new L(me.paint_symbol["text-color"],{runtimeType:mn,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new L(me.paint_symbol["text-halo-color"]),"text-halo-width":new L(me.paint_symbol["text-halo-width"]),"text-halo-blur":new L(me.paint_symbol["text-halo-blur"]),"text-translate":new C(me.paint_symbol["text-translate"]),"text-translate-anchor":new C(me.paint_symbol["text-translate-anchor"])}),layout:AB};class yM{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:kn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}qt(yM,"FormatSectionOverride",{omit:["defaultValue"]});class my extends $o{constructor(n){super(n,Uv)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const g of u)p.indexOf(g)<0&&p.push(g);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(n,s,u,p){const g=this.layout.get(n).evaluate(s,{},u,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||Gs(x.value)||!g?g:function(A,T){return T.replace(/{([^{}]+)}/g,(D,k)=>k in A?String(A[k]):"")}(s.properties,g)}createBucket(n){return new nl(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of Uv.paint.overridableProperties){if(!my.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),u=new yM(s),p=new Hu(u,s.property.specification);let g=null;g=s.value.kind==="constant"||s.value.kind==="source"?new op("source",p):new ap("composite",p,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new M(s.property,g,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&my.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const u=n.get("text-field"),p=Uv.paint.properties[s];let g=!1;const x=A=>{for(const T of A)if(p.overrides&&p.overrides.hasOverride(T))return void(g=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ji)x(u.value.value.sections);else if(u.value.kind==="source"){const A=D=>{g||(D instanceof qo&&Bi(D.value)===Fr?x(D.value.sections):D instanceof zs?x(D.sections):D.eachChild(A))},T=u.value;T._styleExpression&&A(T._styleExpression.expression)}return g}getProgramConfiguration(n){return new Js(this,n)}}var MB={paint:new Y({"background-color":new C(me.paint_background["background-color"]),"background-pattern":new G(me.paint_background["background-pattern"]),"background-opacity":new C(me.paint_background["background-opacity"])})},SB={paint:new Y({"raster-opacity":new C(me.paint_raster["raster-opacity"]),"raster-hue-rotate":new C(me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new C(me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new C(me.paint_raster["raster-brightness-max"]),"raster-saturation":new C(me.paint_raster["raster-saturation"]),"raster-contrast":new C(me.paint_raster["raster-contrast"]),"raster-resampling":new C(me.paint_raster["raster-resampling"]),"raster-fade-duration":new C(me.paint_raster["raster-fade-duration"])})};class TB extends $o{constructor(n){super(n,{}),this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}var EB={paint:new Y({"sky-type":new C(me.paint_sky["sky-type"]),"sky-atmosphere-sun":new C(me.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new C(me.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new C(me.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new C(me.paint_sky["sky-gradient-radius"]),"sky-gradient":new j(me.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new C(me.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new C(me.paint_sky["sky-atmosphere-color"]),"sky-opacity":new C(me.paint_sky["sky-opacity"])})};function Nv(a,n,s){const u=[0,0,1],p=AA([]);return function(g,x,A){A*=.5;var T=x[0],D=x[1],k=x[2],z=x[3],N=Math.sin(A),H=Math.cos(A);g[0]=T*H-k*N,g[1]=D*H+z*N,g[2]=k*H+T*N,g[3]=z*H-D*N}(p,p,s?-B(a)+Math.PI:B(a)),MA(p,p,-B(n)),bA(u,u,p),Dp(u,u)}const PB={circle:class extends $o{constructor(a){super(a,YF)}createBucket(a){return new rv(a)}queryRadius(a){const n=a;return ch("circle-radius",this,n)+ch("circle-stroke-width",this,n)+Qg(this.paint.get("circle-translate"))}queryIntersectsFeature(a,n,s,u,p,g,x,A){const T=pA(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return SA(a,u,g,x,A,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,D)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new Js(this,a)}},heatmap:class extends $o{createBucket(a){return new EA(a)}constructor(a){super(a,ek),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return ch("heatmap-radius",this,a)}queryIntersectsFeature(a,n,s,u,p,g,x,A){const T=this.paint.get("heatmap-radius").evaluate(n,s);return SA(a,u,g,x,A,!0,!0,new b(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new Js(this,a)}},hillshade:class extends $o{constructor(a){super(a,tk)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends $o{constructor(a){super(a,xk)}getProgramIds(){const a=this.paint.get("fill-pattern"),n=a&&a.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(a){return new Js(this,a)}recalculate(a,n){super.recalculate(a,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new ry(a)}queryRadius(){return Qg(this.paint.get("fill-translate"))}queryIntersectsFeature(a,n,s,u,p,g){return!a.queryGeometry.isAboveHorizon&&lA(dA(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends $o{constructor(a){super(a,Rk)}createBucket(a){return new Vp(a)}queryRadius(){return Qg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new Js(this,a)}queryIntersectsFeature(a,n,s,u,p,g,x,A,T){const D=pA(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(n,s),z=this.paint.get("fill-extrusion-base").evaluate(n,s),N=[0,0],H=A&&g.elevation,K=g.elevation?g.elevation.exaggeration():1,te=a.tile.getBucket(this);if(H&&te instanceof Vp){const Pe=te.centroidVertexArray,Be=T+1;if(Be<Pe.length){const Oe=Pe.get(Be);N[0]=Oe.a_centroid_pos0,N[1]=Oe.a_centroid_pos1}}if(N[0]===0&&N[1]===1)return!1;const ae=function(Pe,Be,Oe,qe,Ye,st,ut,vt,Mt){return st?function(it,pt,Tt,zt,Dt,Bt,Cn,Hn,Dn){const Vn=[],$t=[],Wt=[0,0,0,1];for(const Wn of it){const ti=[],Hi=[];for(const gi of Wn){const Wi=gi.x+zt.x,ni=gi.y+zt.y,Yn=Dk(Wi,ni,pt,Tt,Bt,Cn,Hn,Dn);Wt[0]=Wi,Wt[1]=ni,Wt[2]=Yn.base,Wt[3]=1,hh(Wt,Wt,Dt),Wt[3]=Math.max(Wt[3],1e-5);const si=VA([Wt[0]/Wt[3],Wt[1]/Wt[3],Wt[2]/Wt[3]]);Wt[0]=Wi,Wt[1]=ni,Wt[2]=Yn.top,Wt[3]=1,hh(Wt,Wt,Dt),Wt[3]=Math.max(Wt[3],1e-5);const Pi=VA([Wt[0]/Wt[3],Wt[1]/Wt[3],Wt[2]/Wt[3]]);ti.push(si),Hi.push(Pi)}Vn.push(ti),$t.push(Hi)}return[Vn,$t]}(Pe,Be,Oe,qe,Ye,st,ut,vt,Mt):function(it,pt,Tt,zt,Dt){const Bt=[],Cn=[],Hn=Dt[8]*pt,Dn=Dt[9]*pt,Vn=Dt[10]*pt,$t=Dt[11]*pt,Wt=Dt[8]*Tt,Wn=Dt[9]*Tt,ti=Dt[10]*Tt,Hi=Dt[11]*Tt;for(const gi of it){const Wi=[],ni=[];for(const Yn of gi){const si=Yn.x+zt.x,Pi=Yn.y+zt.y,Ii=Dt[0]*si+Dt[4]*Pi+Dt[12],qi=Dt[1]*si+Dt[5]*Pi+Dt[13],nr=Dt[2]*si+Dt[6]*Pi+Dt[14],oo=Dt[3]*si+Dt[7]*Pi+Dt[15],jr=Ii+Hn,li=qi+Dn,Er=nr+Vn,ao=Math.max(oo+$t,1e-5),sr=Ii+Wt,ir=qi+Wn,_i=nr+ti,yi=Math.max(oo+Hi,1e-5),Hr=new b(jr/ao,li/ao);Hr.z=Er/ao,Wi.push(Hr);const Pr=new b(sr/yi,ir/yi);Pr.z=_i/yi,ni.push(Pr)}Bt.push(Wi),Cn.push(ni)}return[Bt,Cn]}(Pe,Be,Oe,qe,Ye)}(u,z,k,D,x,H?A:null,N,K,g.center.lat),he=a.queryGeometry;return function(Pe,Be,Oe){let qe=1/0;lA(Oe,Be)&&(qe=NA(Oe,Be[0]));for(let Ye=0;Ye<Be.length;Ye++){const st=Be[Ye],ut=Pe[Ye];for(let vt=0;vt<st.length-1;vt++){const Mt=st[vt],it=[Mt,st[vt+1],ut[vt+1],ut[vt],Mt];sA(Oe,it)&&(qe=Math.min(qe,NA(Oe,it)))}}return qe!==1/0&&qe}(ae[0],ae[1],he.isPointQuery()?he.screenBounds:he.screenGeometry)}},line:class extends $o{constructor(a){super(a,OA),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Vl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,n){super.recalculate(a,n),this.paint._values["line-floorwidth"]=GA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new ay(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new Js(this,a)}queryRadius(a){const n=a,s=jA(ch("line-width",this,n),ch("line-gap-width",this,n)),u=ch("line-offset",this,n);return s/2+Math.abs(u)+Qg(this.paint.get("line-translate"))}queryIntersectsFeature(a,n,s,u,p,g){if(a.queryGeometry.isAboveHorizon)return!1;const x=dA(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),A=a.pixelToTileUnitsFactor/2*jA(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),T=this.paint.get("line-offset").evaluate(n,s);return T&&(u=function(D,k){const z=[],N=new b(0,0);for(let H=0;H<D.length;H++){const K=D[H],te=[];for(let ae=0;ae<K.length;ae++){const he=K[ae-1],Pe=K[ae],Be=K[ae+1],Oe=ae===0?N:Pe.sub(he)._unit()._perp(),qe=ae===K.length-1?N:Be.sub(Pe)._unit()._perp(),Ye=Oe._add(qe)._unit();Ye._mult(1/(Ye.x*qe.x+Ye.y*qe.y)),te.push(Ye._mult(k)._add(Pe))}z.push(te)}return z}(u,T*a.pixelToTileUnitsFactor)),function(D,k,z){for(let N=0;N<k.length;N++){const H=k[N];if(D.length>=3){for(let K=0;K<H.length;K++)if(lh(D,H[K]))return!0}if(jF(D,H,z))return!0}return!1}(x,u,A)}isTileClipped(){return!0}},symbol:my,background:class extends $o{constructor(a){super(a,MB)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends $o{constructor(a){super(a,SB)}getProgramIds(){return["raster"]}},sky:class extends $o{constructor(a){super(a,EB),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=yv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(a,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),p=!u,g=a.style.light,x=g.properties.get("position");return p&&g.properties.get("anchor")==="viewport"&&pe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?Nv(x.azimuthal,90-x.polar,n):Nv(u[0],90-u[1],n)}const s=this.paint.get("sky-gradient-center");return Nv(s[0],90-s[1],n)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}}};class qp{constructor(n,s,u,p){this.context=n,this.format=u,this.texture=n.gl.createTexture(),this.update(s,p)}update(n,s,u){const{width:p,height:g}=n,{context:x}=this,{gl:A}=x,{HTMLImageElement:T,HTMLCanvasElement:D,HTMLVideoElement:k,ImageData:z,ImageBitmap:N}=P;if(A.bindTexture(A.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!s||s.premultiply!==!1)),u||this.size&&this.size[0]===p&&this.size[1]===g){const{x:H,y:K}=u||{x:0,y:0};n instanceof T||n instanceof D||n instanceof k||n instanceof z||N&&n instanceof N?A.texSubImage2D(A.TEXTURE_2D,0,H,K,A.RGBA,A.UNSIGNED_BYTE,n):A.texSubImage2D(A.TEXTURE_2D,0,H,K,p,g,A.RGBA,A.UNSIGNED_BYTE,n.data)}else this.size=[p,g],n instanceof T||n instanceof D||n instanceof k||n instanceof z||N&&n instanceof N?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,n):A.texImage2D(A.TEXTURE_2D,0,this.format,p,g,0,this.format,A.UNSIGNED_BYTE,n.data);this.useMipmap=!!(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&A.generateMipmap(A.TEXTURE_2D)}bind(n,s){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),n!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,n),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?n===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:n),this.filter=n),s!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class Vv{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new ss({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const u=this.getKey(n,s);return this.positions[u]}trim(){const n=this.width,s=this.height=Ue(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,u){const p=[];let g=n.length%2==1?-n[n.length-1]*u:0,x=n[0]*u,A=!0;p.push({left:g,right:x,isDash:A,zeroLength:n[0]===0});let T=n[0];for(let D=1;D<n.length;D++){A=!A;const k=n[D];g=T*u,T+=k,x=T*u,p.push({left:g,right:x,isDash:A,zeroLength:k===0})}return p}addRoundDash(n,s,u){const p=s/2;for(let g=-u;g<=u;g++){const x=this.width*(this.nextRow+u+g);let A=0,T=n[A];for(let D=0;D<this.width;D++){D/T.right>1&&(T=n[++A]);const k=Math.abs(D-T.left),z=Math.abs(D-T.right),N=Math.min(k,z);let H;const K=g/u*(p+1);if(T.isDash){const te=p-Math.abs(K);H=Math.sqrt(N*N+te*te)}else H=p-Math.sqrt(N*N+K*K);this.image.data[x+D]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n,s){for(let T=n.length-1;T>=0;--T){const D=n[T],k=n[T+1];D.zeroLength?n.splice(T,1):k&&k.isDash===D.isDash&&(k.left=D.left,n.splice(T,1))}const u=n[0],p=n[n.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const g=this.width*this.nextRow;let x=0,A=n[x];for(let T=0;T<this.width;T++){T/A.right>1&&(A=n[++x]);const D=Math.abs(T-A.left),k=Math.abs(T-A.right),z=Math.min(D,k);this.image.data[g+T]=Math.max(0,Math.min(255,(A.isDash?z:-z)+s+128))}}addDash(n,s){const u=this.getKey(n,s);if(this.positions[u])return this.positions[u];const p=s==="round",g=p?7:0,x=2*g+1;if(this.nextRow+x>this.height)return pe("LineAtlas out of space"),null;n.length===0&&n.push(1);let A=0;for(let k=0;k<n.length;k++)n[k]<0&&(pe("Negative value is found in line dasharray, replacing values with 0"),n[k]=0),A+=n[k];if(A!==0){const k=this.width/A,z=this.getDashRanges(n,this.width,k);p?this.addRoundDash(z,k,g):this.addRegularDash(z,s==="square"?.5*k:0)}const T=this.nextRow+g;this.nextRow+=x;const D={tl:[T,g],br:[A,0]};return this.positions[u]=D,D}}qt(Vv,"LineAtlas");class CB{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}const RB=P.performance;function xM(a){const n=a?a.url.toString():void 0;return RB.getEntriesByName(n)}class DB{constructor(){this.tasks={},this.taskQueue=[],Pt(["process"],this),this.invoker=new CB(this.process),this.nextId=0}add(n,s){const u=this.nextId++,p=function({type:g,isSymbolTile:x,zoom:A}){return A=A||0,g==="message"?0:g!=="maybePrepare"||x?g!=="parseTile"||x?g==="parseTile"&&x?300-A:g==="maybePrepare"&&x?400-A:500:200-A:100-A}(s);if(p===0){Se();try{n()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:n,metadata:s,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){Se();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let p=0;p<this.taskQueue.length;p++){const g=this.tasks[this.taskQueue[p]];g.priority<s&&(s=g.priority,n=p)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}const IB=_e([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),LB=_e([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:vM}=IB,_M=_e([{name:"a_pos_3",components:3,type:"Int16"}]);var Yp=_e([{name:"a_pos",type:"Int16",components:2}]);const _h=Bn/Math.PI/2,io=-_h,ro=_h,FB=[new wo([io,io,io],[ro,ro,ro]),new wo([io,io,io],[0,0,ro]),new wo([0,io,io],[ro,0,ro]),new wo([io,0,io],[0,ro,ro]),new wo([0,0,io],[ro,ro,ro])];class kB{constructor(n,s,u){this.a=uh([],n,u),this.b=uh([],s,u),this.center=u;const p=Dp([],this.a),g=Dp([],this.b);this.angle=Math.acos(Ip(p,g))}}function Ov(a,n){if(a.angle===0)return null;let s;return s=a.a[n]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[n]/a.a[n]/Math.sin(a.angle)-1/Math.tan(a.angle)),s<0||s>1?null:function(u,p,g,x){const A=Math.sin(g);return u*(Math.sin((1-x)*g)/A)+p*(Math.sin(x*g)/A)}(a.a[n],a.b[n],a.angle,oe(s,0,1))+a.center[n]}function Xp(a){if(a.z<=1)return FB[a.z+2*a.y+a.x];const[n,s]=Gv(a),u=[us(n[0],n[1]),us(n[0],s[1]),us(s[0],n[1]),us(s[0],s[1])],p=[ro,ro,ro],g=[io,io,io];for(const x of u)p[0]=Math.min(p[0],x[0]),p[1]=Math.min(p[1],x[1]),p[2]=Math.min(p[2],x[2]),g[0]=Math.max(g[0],x[0]),g[1]=Math.max(g[1],x[1]),g[2]=Math.max(g[2],x[2]);return new wo(p,g)}function BB(a,n,s){const u=n/a.worldSize,p=(pt,Tt)=>{Rp(pt,pt,u),Rp(Tt,Tt,u)},g=Number.MAX_VALUE,x=[-g,-g,-g],A=[g,g,g],T=SM(a);if(s.z<=1){const pt=Xp(s).getCorners();for(let Tt=0;Tt<pt.length;Tt++)hc(pt[Tt],pt[Tt],T),dv(A,A,pt[Tt]),pv(x,x,pt[Tt]);return p(A,x),new wo(A,x)}const[D,k]=Gv(s),z=new Qs;z.setSouthWest([D[1],k[0]]),z.setNorthEast([k[1],D[0]]);const N=[us(z.getSouth(),z.getWest()),us(z.getSouth(),z.getEast()),us(z.getNorth(),z.getEast()),us(z.getNorth(),z.getWest())];for(let pt=0;pt<N.length;pt++)hc(N[pt],N[pt],T),dv(A,A,N[pt]),pv(x,x,N[pt]);if(z.contains(a.center))return x[2]=0,p(A,x),new wo(A,x);const H=[T[12],T[13],T[14]],K=a.center.lng,te=oe(a.center.lat,-85.051129,Ea),ae=[Pp(K),ah(te)],he=z.getCenter().lng,Pe=oe(z.getCenter().lat,-85.051129,Ea),Be=[Pp(he),ah(Pe)];let Oe=new Array(3),qe=0;const Ye=ae[0]-Be[0],st=ae[1]-Be[1];if(Math.abs(Ye)>Math.abs(st))qe=Ye>=0?1:3,Oe=H;else{qe=st>=0?0:2;const pt=[T[4],T[5],T[6]];let Tt;Tt=st>=0?-Math.sin(B(z.getSouth()))*_h:-Math.sin(B(z.getNorth()))*_h,Oe=fv(Oe,H,pt,Tt)}const ut=N[qe],vt=N[(qe+1)%4],Mt=new kB(ut,vt,Oe),it=[Ov(Mt,0)||ut[0],Ov(Mt,1)||ut[1],Ov(Mt,2)||ut[2]];return A[2]=Math.min(ut[2],vt[2]),dv(A,A,it),pv(x,x,it),p(A,x),new wo(A,x)}function Gv(a){const n=1<<a.z,s=a.x/n,u=(a.x+1)/n,p=(a.y+1)/n;return[[hr(a.y/n),Io(s)],[hr(p),Io(u)]]}function bM(a,n,s,u=_h){return s=B(s),[a*Math.sin(s)*u,-n*u,a*Math.cos(s)*u]}function us(a,n,s){return bM(Math.cos(B(a)),Math.sin(B(a)),n,s)}function wM(a,n,s){const u=Math.pow(2,s.z),p=(a/Bn+s.x)/u;return us(hr((n/Bn+s.y)/u),Io(p))}function jv(a){return 16383/Math.max(...uh([],a.max,a.min))}function AM(a){const n=Pa(new Float64Array(16)),s=jv(a);var u,p;return $s(n,n,[s,s,s]),uc(n,n,((u=[])[0]=-(p=a.min)[0],u[1]=-p[1],u[2]=-p[2],u)),n}function MM(a,n,s,u,p){const g=function(T){const D=Bn/(2*Math.PI);return T/(2*Math.PI)/D}(s),x=[a,n,-s/(2*Math.PI)],A=Pa(new Float64Array(16));return uc(A,A,x),$s(A,A,[g,g,g]),cv(A,A,B(-p)),uv(A,A,B(-u)),A}function SM(a){const{x:n,y:s}=a.point,{lng:u,lat:p}=a._center;return MM(n,s,a.worldSize,u,p)}const TM=B(85),zB=Math.cos(TM),UB=Math.sin(TM);function EM(a,n,s){var u=2*Math.PI*6378137/256/Math.pow(2,s);return[a*u-2*Math.PI*6378137/2,n*u-2*Math.PI*6378137/2]}class gy{constructor(n,s,u){this.z=n,this.x=s,this.y=u,this.key=Kp(0,n,n,s,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const u=function(g,x,A){var T=EM(256*g,256*(x=Math.pow(2,A)-x-1),A),D=EM(256*(g+1),256*(x+1),A);return T[0]+","+T[1]+","+D[0]+","+D[1]}(this.x,this.y,this.z),p=function(g,x,A){let T,D="";for(let k=g;k>0;k--)T=1<<k-1,D+=(x&T?1:0)+(A&T?2:0);return D}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class PM{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Kp(n,s.z,s.z,s.x,s.y)}}class Tr{constructor(n,s,u,p,g){this.overscaledZ=n,this.wrap=s,this.canonical=new gy(u,+p,+g),this.key=s===0&&n===u?this.canonical.key:Kp(s,n,u,p,g)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new Tr(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Tr(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Kp(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Kp(this.wrap*+s,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Tr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new Tr(s,this.wrap,s,u,p),new Tr(s,this.wrap,s,u+1,p),new Tr(s,this.wrap,s,u,p+1),new Tr(s,this.wrap,s,u+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Tr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Tr(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new PM(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Kp(a,n,s,u,p){const g=1<<Math.min(s,22);let x=g*(p%g)+u%g;return a&&s<22&&(x+=g*g*((a<0?-2*a-1:2*a)%(1<<2*(22-s)))),16*(32*x+s)+(n-s)}function pc(a,n){if(!n.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:n};const s=Math.pow(2,-a.z),u=a.x*s,p=(a.x+1)*s,g=a.y*s,x=(a.y+1)*s,A=Io(u),T=Io(p),D=hr(g),k=hr(x),z=n.project(A,D),N=n.project(T,D),H=n.project(T,k),K=n.project(A,k);let te=Math.min(z.x,N.x,H.x,K.x),ae=Math.min(z.y,N.y,H.y,K.y),he=Math.max(z.x,N.x,H.x,K.x),Pe=Math.max(z.y,N.y,H.y,K.y);const Be=s/16;function Oe(Ye,st,ut,vt,Mt,it){const pt=(ut+Mt)/2,Tt=(vt+it)/2,zt=n.project(Io(pt),hr(Tt)),Dt=Math.max(0,te-zt.x,ae-zt.y,zt.x-he,zt.y-Pe);te=Math.min(te,zt.x),he=Math.max(he,zt.x),ae=Math.min(ae,zt.y),Pe=Math.max(Pe,zt.y),Dt>Be&&(Oe(Ye,zt,ut,vt,pt,Tt),Oe(zt,st,pt,Tt,Mt,it))}Oe(z,N,u,g,p,g),Oe(N,H,p,g,p,x),Oe(H,K,p,x,u,x),Oe(K,z,u,x,u,g),te-=Be,ae-=Be,he+=Be,Pe+=Be;const qe=1/Math.max(he-te,Pe-ae);return{scale:qe,x:te*qe,y:ae*qe,x2:he*qe,y2:Pe*qe,projection:n}}qt(gy,"CanonicalTileID"),qt(Tr,"OverscaledTileID",{omit:["projMatrix"]});class CM{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const u=n[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const NB=["tile","layer","source","sourceLayer","state"];class RM{constructor(n,s,u,p,g){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=u,this._y=p,this.properties=n.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(n.id=this.id);for(const s of NB)this[s]!==void 0&&(n[s]=this[s]);return n}}const Lo=32,Ra=33,il=new Uint16Array(8184);for(let a=0;a<2046;a++){let n=a+2,s=0,u=0,p=0,g=0,x=0,A=0;for(1&n?p=g=x=Lo:s=u=A=Lo;(n>>=1)>1;){const D=s+p>>1,k=u+g>>1;1&n?(p=s,g=u,s=x,u=A):(s=p,u=g,p=x,g=A),x=D,A=k}const T=4*a;il[T+0]=s,il[T+1]=u,il[T+2]=p,il[T+3]=g}const Da=new Uint16Array(2178),rl=new Uint8Array(1089),yy=new Uint16Array(1089);function DM(a){return a===0?-.03125:a===32?.03125:0}var IM=_e([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const LM={type:2,extent:Bn,loadGeometry:()=>[[new b(0,0),new b(8193,0),new b(8193,8193),new b(0,8193),new b(0,0)]]};class Hv{constructor(n,s,u,p,g){this.tileID=n,this.uid=Ie(),this.uses=0,this.tileSize=s,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(n){const s=n+this.timeAdded;s<sn.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=pc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,s,u){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(p,g){const x={};if(!g)return x;for(const A of p){const T=A.layerIds.map(D=>g.getLayer(D)).filter(Boolean);if(T.length!==0){A.layers=T,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(D=>T.filter(k=>k.id===D)[0]));for(const D of T)x[D.id]=A}}return x}(n.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof nl){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof nl&&g.hasRTLText){this.hasRTLText=!0,$r.isLoading()||$r.isLoaded()||rh()!=="deferred"||Ys();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(g))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas)}else this.collisionBoxArray=new Zo}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.id]}upload(n){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(n)}const s=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qp(n,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qp(n,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new qp(n,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,s,u,p,g,x,A,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:A,transform:x,params:g,tileTransform:this.tileTransform},n,s,u):{}}querySourceFeatures(n,s){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),g=s?s.sourceLayer:"",x=p._geojsonTileLayer||p[g];if(!x)return;const A=ba(s&&s.filter),{z:T,x:D,y:k}=this.tileID.canonical,z={z:T,x:D,y:k};for(let N=0;N<x.length;N++){const H=x.feature(N);if(A.needGeometry){const ae=cc(H,!0);if(!A.filter(new mi(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!A.filter(new mi(this.tileID.overscaledZ),H))continue;const K=u.getId(H,g),te=new RM(H,T,D,k,K);te.tile=z,n.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const s=this.expirationTime;if(n.cacheControl){const u=tt(n.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const g=this.expirationTime-s;g?this.expirationTime=u+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0||!s)return;const u=this.latestFeatureIndex.loadVTLayers(),p=s.style.listImages();for(const g in this.buckets){if(!s.style.hasLayer(g))continue;const x=this.buckets[g],A=x.layers[0].sourceLayer||"_geojsonTileLayer",T=u[A],D=n[A];if(!T||!D||Object.keys(D).length===0)continue;if(x.update(D,T,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof ay||x instanceof ry){const z=s.style._getSourceCache(x.layers[0].source);s._terrain&&s._terrain.enabled&&z&&x.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(z.id,this.tileID)}const k=s&&s.style&&s.style.getLayer(g);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<sn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=sn.now()+n}setTexture(n,s){const u=s.context,p=u.gl;this.texture=s.getTileTexture(n.width),this.texture?this.texture.update(n,{useMipmap:!0}):(this.texture=new qp(u,n,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),u.extTextureFilterAnisotropic&&p.texParameterf(p.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax))}setDependencies(n,s){const u={};for(const p of s)u[p]=!0;this.dependencies[n]=u}hasDependency(n,s){for(const u of n){const p=this.dependencies[u];if(p){for(const g of s)if(p[g])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const u=as(LM,this.tileID.canonical,this.tileTransform)[0],p=new ye,g=new Zn;for(let x=0;x<u.length;x++){const{x:A,y:T}=u[x];p.emplaceBack(A,T),g.emplaceBack(x)}g.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(g),this._tileDebugBuffer=n.createVertexBuffer(p,Yp.members),this._tileDebugSegments=Di.simpleSegment(0,0,p.length,g.length)}_makeTileBoundsBuffers(n,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const u=as(LM,this.tileID.canonical,this.tileTransform)[0];let p,g;if(this.isRaster){const x=function(A,T){const D=pc(A,T),k=Math.pow(2,A.z);for(let ae=0;ae<Ra;ae++)for(let he=0;he<Ra;he++){const Pe=Io((A.x+(he+DM(he))/Lo)/k),Be=hr((A.y+(ae+DM(ae))/Lo)/k),Oe=T.project(Pe,Be),qe=ae*Ra+he;Da[2*qe+0]=Math.round((Oe.x*D.scale-D.x)*Bn),Da[2*qe+1]=Math.round((Oe.y*D.scale-D.y)*Bn)}rl.fill(0),yy.fill(0);for(let ae=2045;ae>=0;ae--){const he=4*ae,Pe=il[he+0],Be=il[he+1],Oe=il[he+2],qe=il[he+3],Ye=Pe+Oe>>1,st=Be+qe>>1,ut=Ye+st-Be,vt=st+Pe-Ye,Mt=Be*Ra+Pe,it=qe*Ra+Oe,pt=st*Ra+Ye,Tt=Math.hypot((Da[2*Mt+0]+Da[2*it+0])/2-Da[2*pt+0],(Da[2*Mt+1]+Da[2*it+1])/2-Da[2*pt+1])>=16;if(rl[pt]=rl[pt]||(Tt?1:0),ae<1022){const zt=(Be+vt>>1)*Ra+(Pe+ut>>1),Dt=(qe+vt>>1)*Ra+(Oe+ut>>1);rl[pt]=rl[pt]||rl[zt]||rl[Dt]}}const z=new Me,N=new Yt;let H=0;function K(ae,he){const Pe=he*Ra+ae;return yy[Pe]===0&&(z.emplaceBack(Da[2*Pe+0],Da[2*Pe+1],ae*Bn/Lo,he*Bn/Lo),yy[Pe]=++H),yy[Pe]-1}function te(ae,he,Pe,Be,Oe,qe){const Ye=ae+Pe>>1,st=he+Be>>1;if(Math.abs(ae-Oe)+Math.abs(he-qe)>1&&rl[st*Ra+Ye])te(Oe,qe,ae,he,Ye,st),te(Pe,Be,Oe,qe,Ye,st);else{const ut=K(ae,he),vt=K(Pe,Be),Mt=K(Oe,qe);N.emplaceBack(ut,vt,Mt)}}return te(0,0,Lo,Lo,Lo,0),te(Lo,Lo,0,0,0,Lo),{vertices:z,indices:N}}(this.tileID.canonical,s);p=x.vertices,g=x.indices}else{p=new Me,g=new Yt;for(const{x:A,y:T}of u)p.emplaceBack(A,T,0,0);const x=$g(p.int16,void 0,4);for(let A=0;A<x.length;A+=3)g.emplaceBack(x[A],x[A+1],x[A+2])}this._tileBoundsBuffer=n.createVertexBuffer(p,IM.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(g),this._tileBoundsSegments=Di.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugBuffers(n,s){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!s||s.name!=="globe")return;const u=this.tileID.canonical,p=AM(Xp(u));this._makeGlobeTileDebugBorderBuffer(n,u,p),this._makeGlobeTileDebugTextBuffer(n,u,p)}_makeGlobeTileDebugBorderBuffer(n,s,u){const p=new ye,g=new Zn,x=new ve,A=(D,k,z,N,H)=>{const K=(z-D)/(H-1),te=(N-k)/(H-1),ae=p.length;for(let he=0;he<H;he++){const Pe=D+he*K,Be=k+he*te;p.emplaceBack(Pe,Be);const Oe=wM(Pe,Be,s),qe=hc(Oe,Oe,u);x.emplaceBack(qe[0],qe[1],qe[2]),g.emplaceBack(ae+he)}},T=Bn;A(0,0,T,0,16),A(T,0,T,T,16),A(T,T,0,T,16),A(0,T,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(g),this._tileDebugBuffer=n.createVertexBuffer(p,Yp.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(x,_M.members),this._tileDebugSegments=Di.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugTextBuffer(n,s,u){const p=new ye,g=new Yt,x=new ve,A=25;g.reserve(32),p.reserve(A),x.reserve(A);const T=(D,k)=>A*D+k;for(let D=0;D<A;D++){const k=2048*D;for(let z=0;z<A;z++){const N=2048*z;p.emplaceBack(N,k);const H=wM(N,k,s),K=hc(H,H,u);x.emplaceBack(K[0],K[1],K[2])}}for(let D=0;D<4;D++)for(let k=0;k<4;k++){const z=T(D,k),N=T(D,k+1),H=T(D+1,k),K=T(D+1,k+1);g.emplaceBack(z,N,H),g.emplaceBack(H,N,K)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(g),this._tileDebugTextBuffer=n.createVertexBuffer(p,Yp.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(x,_M.members),this._tileDebugTextSegments=Di.simpleSegment(0,0,A,32)}}class VB{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,s,u){const p=String(s);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][p]=this.stateChanges[n][p]||{},Ne(this.stateChanges[n][p],u),this.deletedStates[n]===null){this.deletedStates[n]={};for(const g in this.state[n])g!==p&&(this.deletedStates[n][g]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][p]===null){this.deletedStates[n][p]={};for(const g in this.state[n][p])u[g]||(this.deletedStates[n][p][g]=null)}else for(const g in u)this.deletedStates[n]&&this.deletedStates[n][p]&&this.deletedStates[n][p][g]===null&&delete this.deletedStates[n][p][g]}removeFeatureState(n,s,u){if(this.deletedStates[n]===null)return;const p=String(s);if(this.deletedStates[n]=this.deletedStates[n]||{},u&&s!==void 0)this.deletedStates[n][p]!==null&&(this.deletedStates[n][p]=this.deletedStates[n][p]||{},this.deletedStates[n][p][u]=null);else if(s!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][p])for(u in this.deletedStates[n][p]={},this.stateChanges[n][p])this.deletedStates[n][p][u]=null;else this.deletedStates[n][p]=null;else this.deletedStates[n]=null}getState(n,s){const u=String(s),p=Ne({},(this.state[n]||{})[u],(this.stateChanges[n]||{})[u]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const g=this.deletedStates[n][s];if(g===null)return{};for(const x in g)delete p[x]}return p}initializeTileState(n,s){n.setFeatureState(this.state,s)}coalesceChanges(n,s){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),Ne(this.state[p][x],this.stateChanges[p][x]),g[x]=this.state[p][x];u[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const x in this.state[p])g[x]={},this.state[p][x]={};else for(const x in this.deletedStates[p]){if(this.deletedStates[p][x]===null)this.state[p][x]={};else for(const A of Object.keys(this.deletedStates[p][x]))delete this.state[p][x][A];g[x]=this.state[p][x]}u[p]=u[p]||{},Ne(u[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in n)n[p].setFeatureState(u,s)}}class FM{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const u=this.toIdx(n,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function kM(a,n,s,u){let p=0,g=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(u[x])<1e-15){if(s[x]<a[x]||s[x]>n[x])return null}else{const A=1/u[x];let T=(a[x]-s[x])*A,D=(n[x]-s[x])*A;if(T>D){const k=T;T=D,D=k}if(T>p&&(p=T),D<g&&(g=D),p>g)return null}return p}function BM(a,n,s,u,p,g,x,A,T,D,k){const z=u-a,N=p-n,H=g-s,K=x-a,te=A-n,ae=T-s,he=k[1]*ae-k[2]*te,Pe=k[2]*K-k[0]*ae,Be=k[0]*te-k[1]*K,Oe=z*he+N*Pe+H*Be;if(Math.abs(Oe)<1e-15)return null;const qe=1/Oe,Ye=D[0]-a,st=D[1]-n,ut=D[2]-s,vt=(Ye*he+st*Pe+ut*Be)*qe;if(vt<0||vt>1)return null;const Mt=st*H-ut*N,it=ut*z-Ye*H,pt=Ye*N-st*z,Tt=(k[0]*Mt+k[1]*it+k[2]*pt)*qe;return Tt<0||vt+Tt>1?null:(K*Mt+te*it+ae*pt)*qe}function zM(a,n,s){return(a-n)/(s-n)}function UM(a,n,s,u,p,g,x,A,T){const D=1<<s,k=g-u,z=x-p,N=(a+1)/D*k+u,H=(n+0)/D*z+p,K=(n+1)/D*z+p;A[0]=(a+0)/D*k+u,A[1]=H,T[0]=N,T[1]=K}class NM{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(g){const x=Math.ceil(Math.log2(g.dim/8)),A=[];let T=Math.ceil(Math.pow(2,x));const D=1/T,k=(H,K,te,ae,he)=>{const Pe=ae?1:0,Be=(H+1)*te-Pe,Oe=K*te,qe=(K+1)*te-Pe;he[0]=H*te,he[1]=Oe,he[2]=Be,he[3]=qe};let z=new FM(T);const N=[];for(let H=0;H<T*T;H++){k(H%T,Math.floor(H/T),D,!1,N);const K=ol(N[0],N[1],g),te=ol(N[2],N[1],g),ae=ol(N[2],N[3],g),he=ol(N[0],N[3],g);z.minimums.push(Math.min(K,te,ae,he)),z.maximums.push(Math.max(K,te,ae,he)),z.leaves.push(1)}for(A.push(z),T/=2;T>=1;T/=2){const H=A[A.length-1];z=new FM(T);for(let K=0;K<T*T;K++){k(K%T,Math.floor(K/T),2,!0,N);const te=H.getElevation(N[0],N[1]),ae=H.getElevation(N[2],N[1]),he=H.getElevation(N[2],N[3]),Pe=H.getElevation(N[0],N[3]),Be=H.isLeaf(N[0],N[1]),Oe=H.isLeaf(N[2],N[1]),qe=H.isLeaf(N[2],N[3]),Ye=H.isLeaf(N[0],N[3]),st=Math.min(te.min,ae.min,he.min,Pe.min),ut=Math.max(te.max,ae.max,he.max,Pe.max),vt=Be&&Oe&&qe&&Ye;z.maximums.push(ut),z.minimums.push(st),z.leaves.push(ut-st<=5&&vt?1:0)}A.push(z)}return A}(this.dem),u=s.length-1,p=s[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(n,s,u,p,g,x,A=1){return kM([n,s,-100],[u,p,this.maximums[0]*A],g,x)}raycast(n,s,u,p,g,x,A=1){if(!this.nodeCount)return null;const T=this.raycastRoot(n,s,u,p,g,x,A);if(T==null)return null;const D=[],k=[],z=[],N=[],H=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;H.length>0;){const{idx:K,t:te,nodex:ae,nodey:he,depth:Pe}=H.pop();if(this.leaves[K]){UM(ae,he,Pe,n,s,u,p,z,N);const Oe=1<<Pe,qe=(ae+0)/Oe,Ye=(ae+1)/Oe,st=(he+0)/Oe,ut=(he+1)/Oe,vt=ol(qe,st,this.dem)*A,Mt=ol(Ye,st,this.dem)*A,it=ol(Ye,ut,this.dem)*A,pt=ol(qe,ut,this.dem)*A,Tt=BM(z[0],z[1],vt,N[0],z[1],Mt,N[0],N[1],it,g,x),zt=BM(N[0],N[1],it,z[0],N[1],pt,z[0],z[1],vt,g,x),Dt=Math.min(Tt!==null?Tt:Number.MAX_VALUE,zt!==null?zt:Number.MAX_VALUE);if(Dt!==Number.MAX_VALUE)return Dt;{const Bt=fv([],g,x,te);if(VM(vt,Mt,pt,it,zM(Bt[0],z[0],N[0]),zM(Bt[1],z[1],N[1]))>=Bt[2])return te}continue}let Be=0;for(let Oe=0;Oe<this._siblingOffset.length;Oe++){UM((ae<<1)+this._siblingOffset[Oe][0],(he<<1)+this._siblingOffset[Oe][1],Pe+1,n,s,u,p,z,N),z[2]=-100,N[2]=this.maximums[this.childOffsets[K]+Oe]*A;const qe=kM(z,N,g,x);if(qe!=null){const Ye=qe;D[Oe]=Ye;let st=!1;for(let ut=0;ut<Be&&!st;ut++)Ye>=D[k[ut]]&&(k.splice(ut,0,Oe),st=!0);st||(k[Be]=Oe),Be++}}for(let Oe=0;Oe<Be;Oe++){const qe=k[Oe];H.push({idx:this.childOffsets[K]+qe,t:D[qe],nodex:(ae<<1)+this._siblingOffset[qe][0],nodey:(he<<1)+this._siblingOffset[qe][1],depth:Pe+1})}}return null}_addNode(n,s,u){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,u,p,g){if(n[p].isLeaf(s,u)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const x=p-1,A=n[x];let T=0,D=0;for(let k=0;k<this._siblingOffset.length;k++){const z=2*s+this._siblingOffset[k][0],N=2*u+this._siblingOffset[k][1],H=A.getElevation(z,N),K=A.isLeaf(z,N),te=this._addNode(H.min,H.max,K);K&&(T|=1<<k),D||(D=te)}for(let k=0;k<this._siblingOffset.length;k++)T&1<<k||this._construct(n,2*s+this._siblingOffset[k][0],2*u+this._siblingOffset[k][1],x,D+k)}}function VM(a,n,s,u,p,g){return yn(yn(a,s,g),yn(n,u,g),p)}function ol(a,n,s){const u=s.dim,p=oe(a*u-.5,0,u-1),g=oe(n*u-.5,0,u-1),x=Math.floor(p),A=Math.floor(g),T=Math.min(x+1,u-1),D=Math.min(A+1,u-1);return VM(s.get(x,A),s.get(T,A),s.get(x,D),s.get(T,D),p-x,g-A)}const OM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class xy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,u,p=!1,g=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return pe(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const x=this.dim=s.height-2,A=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=u||"mapbox",this.borderReady=p,!p){for(let T=0;T<x;T++)A[this._idx(-1,T)]=A[this._idx(0,T)],A[this._idx(x,T)]=A[this._idx(x-1,T)],A[this._idx(T,-1)]=A[this._idx(T,0)],A[this._idx(T,x)]=A[this._idx(T,x-1)];A[this._idx(-1,-1)]=A[this._idx(0,0)],A[this._idx(x,-1)]=A[this._idx(x-1,0)],A[this._idx(-1,x)]=A[this._idx(0,x-1)],A[this._idx(x,x)]=A[this._idx(x-1,x-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new NM(this)}get(n,s,u=!1){u&&(n=oe(n,-1,this.dim),s=oe(s,-1,this.dim));const p=4*this._idx(n,s);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(n){return OM[n]}get unpackVector(){return OM[this.encoding]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}_unpackMapbox(n,s,u){return(256*n*256+256*s+u)/10-1e4}_unpackTerrarium(n,s,u){return 256*n+s+u/256-32768}static pack(n,s){const u=[0,0,0,0],p=xy.getUnpackVector(s);let g=Math.floor((n+p[3])/p[2]);return u[2]=g%256,g=Math.floor(g/256),u[1]=g%256,g=Math.floor(g/256),u[0]=g,u}getPixels(){return new no({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,g=s*this.dim+this.dim,x=u*this.dim,A=u*this.dim+this.dim;switch(s){case-1:p=g-1;break;case 1:g=p+1}switch(u){case-1:x=A-1;break;case 1:A=x+1}const T=-s*this.dim,D=-u*this.dim;for(let k=x;k<A;k++)for(let z=p;z<g;z++){const N=4*this._idx(z,k),H=4*this._idx(z+T,k+D);this.pixels[N+0]=n.pixels[H+0],this.pixels[N+1]=n.pixels[H+1],this.pixels[N+2]=n.pixels[H+2],this.pixels[N+3]=n.pixels[H+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}qt(xy,"DEMData"),qt(NM,"DemMinMaxQuadTree",{omit:["dem"]});class OB{constructor(n,s){this.max=n,this.onRemove=s,this.reset()}reset(){for(const n in this.data)for(const s of this.data[n])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(n,s,u){const p=n.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:s,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(n,g)},u)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value}getByKey(n){const s=this.data[n];return s?s[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,s){if(!this.has(n))return this;const u=n.wrapped().key,p=s===void 0?0:this.data[u].indexOf(s),g=this.data[u][p];return this.data[u].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(n){const s=[];for(const u in this.data)for(const p of this.data[u])n(p.value)||s.push(p);for(const u of s)this.remove(u.value.tileID,u)}}class bh{constructor(n,s,u){this.func=n,this.mask=s,this.range=u}}bh.ReadOnly=!1,bh.ReadWrite=!0,bh.disabled=new bh(519,bh.ReadOnly,[0,1]);const Wv=7680;class qv{constructor(n,s,u,p,g,x){this.test=n,this.ref=s,this.mask=u,this.fail=p,this.depthFail=g,this.pass=x}}qv.disabled=new qv({func:519,mask:0},0,0,Wv,Wv,Wv);class Ia{constructor(n,s,u){this.blendFunction=n,this.blendColor=s,this.mask=u}}Ia.Replace=[1,0],Ia.disabled=new Ia(Ia.Replace,Qn.transparent,[!1,!1,!1,!1]),Ia.unblended=new Ia(Ia.Replace,Qn.transparent,[!0,!0,!0,!0]),Ia.alphaBlended=new Ia([1,771],Qn.transparent,[!0,!0,!0,!0]);const Yv=1029,Xv=2305;class ea{constructor(n,s,u){this.enable=n,this.mode=s,this.frontFace=u}}ea.disabled=new ea(!1,Yv,Xv),ea.backCCW=new ea(!0,Yv,Xv),ea.backCW=new ea(!0,Yv,2304),ea.frontCW=new ea(!0,1028,2304),ea.frontCCW=new ea(!0,1028,Xv);class fc extends Te{constructor(n,s,u){super(),this.id=n,this._onlySymbols=u,s.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new OB(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new VB,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,s){return n.isSymbolTile=this._onlySymbols,this._source.loadTile(n,s)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n,()=>{})}serialize(){return this._source.serialize()}prepare(n){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const s in this._tiles){const u=this._tiles[s];this._source.prepareTile(u)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,u.tileID),u.upload(n),u.prepare(this.map.style.imageManager)}else for(const s in this._tiles){const u=this._tiles[s];u.upload(n),u.prepare(this.map.style.imageManager)}}getIds(){return Xe(this._tiles).map(n=>n.tileID).sort(GM).map(n=>n.key)}getRenderableIds(n){const s=[];for(const u in this._tiles)this._isIdRenderable(+u,n)&&s.push(this._tiles[u]);return n?s.sort((u,p)=>{const g=u.tileID,x=p.tileID,A=new b(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),T=new b(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-x.overscaledZ||T.y-A.y||T.x-A.x}).map(u=>u.tileID.key):s.map(u=>u.tileID).sort(GM).map(u=>u.key)}hasRenderableParent(n){const s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,s){const u=this._tiles[n];u&&(u.state!=="loading"&&(u.state=s),this._loadTile(u,this._tileLoaded.bind(this,u,n,s)))}_tileLoaded(n,s,u,p){if(p)if(n.state="errored",p.status!==404)this._source.fire(new ee(p,{tile:n}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else n.timeAdded=sn.now(),u==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new X("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const g=s[p];if(n.neighboringTiles&&n.neighboringTiles[g]){const x=this.getTileByID(g);u(n,x),u(x,n)}}function u(p,g){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let x=g.tileID.canonical.x-p.tileID.canonical.x;const A=g.tileID.canonical.y-p.tileID.canonical.y,T=Math.pow(2,p.tileID.canonical.z),D=g.tileID.key;x===0&&A===0||Math.abs(A)>1||(Math.abs(x)>1&&(Math.abs(x+T)===1?x+=T:Math.abs(x-T)===1&&(x-=T)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,x,A),p.neighboringTiles&&p.neighboringTiles[D]&&(p.neighboringTiles[D].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,s,u,p){for(const g in this._tiles){let x=this._tiles[g];if(p[g]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>u)continue;let A=x.tileID;for(;x&&x.tileID.overscaledZ>s+1;){const D=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[D.key],x&&x.hasData()&&(A=D)}let T=A;for(;T.overscaledZ>s;)if(T=T.scaledTo(T.overscaledZ-1),n[T.key]){p[A.key]=A;break}}}findLoadedParent(n,s){if(n.key in this._loadedParentTiles){const u=this._loadedParentTiles[n.key];return u&&u.tileID.overscaledZ>=s?u:null}for(let u=n.overscaledZ-1;u>=s;u--){const p=n.scaledTo(u),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(n){const s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,s){s=s||this._source.tileSize;const u=Math.ceil(n.width/s)+1,p=Math.ceil(n.height/s)+1,g=Math.floor(u*p*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,g):g,A=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(A)}handleWrapJump(n){const s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){const u={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+s),u[g.tileID.key]=g}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(n,s,u){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let p;this.updateCacheSize(n,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(A=>new Tr(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y)):(p=n.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(A=>this._source.hasTile(A)))):p=[];const g=this._updateRetainedTiles(p);if(jM(this._source.type)&&p.length!==0){const A={},T={},D=Object.keys(g);for(const z of D){const N=g[z],H=this._tiles[z];if(!H||H.fadeEndTime&&H.fadeEndTime<=sn.now())continue;const K=this.findLoadedParent(N,Math.max(N.overscaledZ-fc.maxOverzooming,this._source.minzoom));K&&(this._addTile(K.tileID),A[K.tileID.key]=K.tileID),T[z]=N}const k=p[p.length-1].overscaledZ;for(const z in this._tiles){const N=this._tiles[z];if(g[z]||!N.hasData())continue;let H=N.tileID;for(;H.overscaledZ>k;){H=H.scaledTo(H.overscaledZ-1);const K=this._tiles[H.key];if(K&&K.hasData()&&T[H.key]){g[z]=N.tileID;break}}}for(const z in A)g[z]||(this._coveredTiles[z]=!0,g[z]=A[z])}for(const A in g)this._tiles[A].clearFadeHold();const x=function(A,T){const D=[];for(const k in A)k in T||D.push(k);return D}(this._tiles,g);for(const A of x){const T=this._tiles[A];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+A)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const s={};if(n.length===0)return s;const u={},p=n.reduce((D,k)=>Math.min(D,k.overscaledZ),1/0),g=n[0].overscaledZ,x=Math.max(g-fc.maxOverzooming,this._source.minzoom),A=Math.max(g+fc.maxUnderzooming,this._source.minzoom),T={};for(const D of n){const k=this._addTile(D);s[D.key]=D,k.hasData()||p<this._source.maxzoom&&(T[D.key]=D)}this._retainLoadedChildren(T,p,A,s);for(const D of n){let k=this._tiles[D.key];if(k.hasData())continue;if(D.canonical.z>=this._source.maxzoom){const N=D.children(this._source.maxzoom)[0],H=this.getTile(N);if(H&&H.hasData()){s[N.key]=N;continue}}else{const N=D.children(this._source.maxzoom);if(s[N[0].key]&&s[N[1].key]&&s[N[2].key]&&s[N[3].key])continue}let z=k.wasRequested();for(let N=D.overscaledZ-1;N>=x;--N){const H=D.scaledTo(N);if(u[H.key]||(u[H.key]=!0,k=this.getTile(H),!k&&z&&(k=this._addTile(H)),k&&(s[H.key]=H,z=k.wasRequested(),k.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const s=[];let u,p=this._tiles[n].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}s.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;p=g}for(const g of s)this._loadedParentTiles[g]=u}}_addTile(n){let s=this._tiles[n.key];if(s)return this._source.prepareTile&&this._source.prepareTile(s),s;s=this._cache.getAndRemove(n),s&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));const u=!!s;if(!u){const p=this.map?this.map.painter:null;s=new Hv(n,this._source.tileSize*n.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._source.prepareTile&&this._source.prepareTile(s)||this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))}return s?(s.uses++,this._tiles[n.key]=s,u||this._source.fire(new X("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(n,s){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const u=s.getExpiryTimeout();u&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},u))}_removeTile(n){const s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,s,u){const p=[],g=this.transform;if(!g)return p;for(const x in this._tiles){const A=this._tiles[x];if(u&&A.clearQueryDebugViz(),A.holdingForFade())continue;const T=n.containsTile(A,g,s);T&&p.push(T)}return p}getVisibleCoordinates(n){const s=this.getRenderableIds(n).map(u=>this._tiles[u].tileID);for(const u of s)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(jM(this._source.type))for(const n in this._tiles){const s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=sn.now())return!0}return!1}setFeatureState(n,s,u){this._state.updateState(n=n||"_geojsonTileLayer",s,u)}removeFeatureState(n,s,u){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,u)}getFeatureState(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)}setDependencies(n,s,u){const p=this._tiles[n];p&&p.setDependencies(s,u)}reloadTilesForDependencies(n,s){for(const u in this._tiles)this._tiles[u].hasDependency(n,s)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(n,s))}_preloadTiles(n,s){const u=new Map,p=Array.isArray(n)?n:[n],g=this.map.painter.terrain,x=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const A of p){const T=A.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of T)u.set(D.key,D);this.usedForTerrain&&A.updateElevation(!1)}Le(Array.from(u.values()),(A,T)=>{const D=new Hv(A,this._source.tileSize*A.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,k=>{this._source.type==="raster-dem"&&D.dem&&this._backfillDEM(D),T(k,D)})},s)}}function GM(a,n){const s=Math.abs(2*a.wrap)-+(a.wrap<0),u=Math.abs(2*n.wrap)-+(n.wrap<0);return a.overscaledZ-n.overscaledZ||u-s||n.canonical.y-a.canonical.y||n.canonical.x-a.canonical.x}function jM(a){return a==="raster"||a==="image"||a==="video"}fc.maxOverzooming=10,fc.maxUnderzooming=3;class vy{constructor(n,s,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(n,s,u){const p=u||n.findDEMTileFor(s);if(!p||!p.dem)return;const g=p.dem,x=p.tileID,A=1<<s.canonical.z-x.canonical.z;return new vy(p,p.tileSize/Bn/A,[(s.canonical.x/A-x.canonical.x)*g.dim,(s.canonical.y/A-x.canonical.y)*g.dim])}tileCoordToPixel(n,s){const u=s*this._scale+this._offset[1],p=Math.floor(n*this._scale+this._offset[0]),g=Math.floor(u);return new b(p,g)}getElevationAt(n,s,u,p){const g=n*this._scale+this._offset[0],x=s*this._scale+this._offset[1],A=Math.floor(g),T=Math.floor(x),D=this._dem;return p=!!p,u?yn(yn(D.get(A,T,p),D.get(A,T+1,p),x-T),yn(D.get(A+1,T,p),D.get(A+1,T+1,p),x-T),g-A):D.get(A,T,p)}getElevationAtPixel(n,s,u){return this._dem.get(n,s,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*sh(1,n)*this._dem.stride}}class HM{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Ma(Bn,16,0),this.featureIndexArray=new Ti,this.promoteId=s}insert(n,s,u,p,g,x=0){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,g,x);const T=this.grid;for(let D=0;D<s.length;D++){const k=s[D],z=[1/0,1/0,-1/0,-1/0];for(let N=0;N<k.length;N++){const H=k[N];z[0]=Math.min(z[0],H.x),z[1]=Math.min(z[1],H.y),z[2]=Math.max(z[2],H.x),z[3]=Math.max(z[3],H.y)}z[0]<Bn&&z[1]<Bn&&z[2]>=0&&z[3]>=0&&T.insert(A,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new dc.VectorTile(new jp(this.rawTileData)).layers,this.sourceLayerCoder=new CM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,u,p){this.loadVTLayers();const g=n.params||{},x=ba(g.filter),A=n.tileResult,T=n.transform,D=A.bufferedTilespaceBounds,k=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(K,te,ae,he)=>hA(A.bufferedTilespaceGeometry,K,te,ae,he));k.sort(GB);let z=null;T.elevation&&k.length>0&&(z=vy.create(T.elevation,this.tileID));const N={};let H;for(let K=0;K<k.length;K++){const te=k[K];if(te===H)continue;H=te;const ae=this.featureIndexArray.get(te);let he=null;this.loadMatchingFeature(N,ae,x,g.layers,g.availableImages,s,u,p,(Pe,Be,Oe,qe=0)=>(he||(he=as(Pe,this.tileID.canonical,n.tileTransform)),Be.queryIntersectsFeature(A,Pe,Oe,he,this.z,n.transform,n.pixelPosMatrix,z,qe)))}return N}loadMatchingFeature(n,s,u,p,g,x,A,T,D){const{featureIndex:k,bucketIndex:z,sourceLayerIndex:N,layoutVertexArrayOffset:H}=s,K=this.bucketLayerIDs[z];if(p&&!function(Pe,Be){for(let Oe=0;Oe<Pe.length;Oe++)if(Be.indexOf(Pe[Oe])>=0)return!0;return!1}(p,K))return;const te=this.sourceLayerCoder.decode(N),ae=this.vtLayers[te].feature(k);if(u.needGeometry){const Pe=cc(ae,!0);if(!u.filter(new mi(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!u.filter(new mi(this.tileID.overscaledZ),ae))return;const he=this.getId(ae,te);for(let Pe=0;Pe<K.length;Pe++){const Be=K[Pe];if(p&&p.indexOf(Be)<0)continue;const Oe=x[Be];if(!Oe)continue;let qe={};he!==void 0&&T&&(qe=T.getState(Oe.sourceLayer||"_geojsonTileLayer",he));const Ye=Ne({},A[Be]);Ye.paint=WM(Ye.paint,Oe.paint,ae,qe,g),Ye.layout=WM(Ye.layout,Oe.layout,ae,qe,g);const st=!D||D(ae,Oe,qe,H);if(!st)continue;const ut=new RM(ae,this.z,this.x,this.y,he);ut.layer=Ye;let vt=n[Be];vt===void 0&&(vt=n[Be]=[]),vt.push({featureIndex:k,feature:ut,intersectionZ:st})}}lookupSymbolFeatures(n,s,u,p,g,x,A,T){const D={};this.loadVTLayers();const k=ba(g);for(const z of n)this.loadMatchingFeature(D,{bucketIndex:u,sourceLayerIndex:p,featureIndex:z,layoutVertexArrayOffset:0},k,x,A,T,s);return D}loadFeature(n){const{featureIndex:s,sourceLayerIndex:u}=n;this.loadVTLayers();const p=this.sourceLayerCoder.decode(u),g=this.vtFeatures[p];if(g[s])return g[s];const x=this.vtLayers[p].feature(s);return g[s]=x,x}hasLayer(n){for(const s of this.bucketLayerIDs)for(const u of s)if(n===u)return!0;return!1}getId(n,s){let u=n.id;return this.promoteId&&(u=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof u=="boolean"&&(u=Number(u))),u}}function WM(a,n,s,u,p){return _t(a,(g,x)=>{const A=n instanceof S?n.get(x):null;return A&&A.evaluate?A.evaluate(s,u,p):A})}function GB(a,n){return n-a}qt(HM,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class qM{constructor(n){const s={},u=[];for(const A in n){const T=n[A],D=s[A]={};for(const k in T.glyphs){const z=T.glyphs[+k];if(!z||z.bitmap.width===0||z.bitmap.height===0)continue;const N=z.metrics.localGlyph?2:1,H={x:0,y:0,w:z.bitmap.width+2*N,h:z.bitmap.height+2*N};u.push(H),D[k]=H}}const{w:p,h:g}=Tv(u),x=new ss({width:p||1,height:g||1});for(const A in n){const T=n[A];for(const D in T.glyphs){const k=T.glyphs[+D];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const z=s[A][D],N=k.metrics.localGlyph?2:1;ss.copy(k.bitmap,x,{x:0,y:0},{x:z.x+N,y:z.y+N},k.bitmap)}}this.image=x,this.positions=s}}qt(qM,"GlyphAtlas");class jB{constructor(n){this.tileID=new Tr(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.tileZoom=n.tileZoom,this.uid=n.uid,this.zoom=n.zoom,this.canonical=n.tileID.canonical,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId,this.enableTerrain=!!n.enableTerrain,this.isSymbolTile=n.isSymbolTile,this.tileTransform=pc(n.tileID.canonical,n.projection),this.projection=n.projection}parse(n,s,u,p,g){this.status="parsing",this.data=n,this.collisionBoxArray=new Zo;const x=new CM(Object.keys(n.layers).sort()),A=new HM(this.tileID,this.promoteId);A.bucketLayerIDs=[];const T={},D=new Vv(256,256),k={featureIndex:A,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:D,availableImages:u},z=s.familiesBySource[this.source];for(const qe in z){const Ye=n.layers[qe];if(!Ye)continue;let st=!1,ut=!1;for(const it of z[qe])it[0].type==="symbol"?st=!0:ut=!0;if(this.isSymbolTile===!0&&!st||this.isSymbolTile===!1&&!ut)continue;Ye.version===1&&pe(`Vector tile source "${this.source}" layer "${qe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vt=x.encode(qe),Mt=[];for(let it=0;it<Ye.length;it++){const pt=Ye.feature(it),Tt=A.getId(pt,qe);Mt.push({feature:pt,id:Tt,index:it,sourceLayerIndex:vt})}for(const it of z[qe]){const pt=it[0];this.isSymbolTile!==void 0&&pt.type==="symbol"!==this.isSymbolTile||pt.minzoom&&this.zoom<Math.floor(pt.minzoom)||pt.maxzoom&&this.zoom>=pt.maxzoom||pt.visibility!=="none"&&(Kv(it,this.zoom,u),(T[pt.id]=pt.createBucket({index:A.bucketLayerIDs.length,layers:it,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.name,availableImages:u})).populate(Mt,k,this.tileID.canonical,this.tileTransform),A.bucketLayerIDs.push(it.map(Tt=>Tt.id)))}}let N,H,K,te;D.trim();const ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},he=_t(k.glyphDependencies,qe=>Object.keys(qe).map(Number));Object.keys(he).length?p.send("getGlyphs",{uid:this.uid,stacks:he},(qe,Ye)=>{N||(N=qe,H=Ye,Oe.call(this))},void 0,!1,ae):H={};const Pe=Object.keys(k.iconDependencies);Pe.length?p.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"icons"},(qe,Ye)=>{N||(N=qe,K=Ye,Oe.call(this))},void 0,!1,ae):K={};const Be=Object.keys(k.patternDependencies);function Oe(){if(N)return g(N);if(H&&K&&te){const qe=new qM(H),Ye=new JA(K,te);for(const st in T){const ut=T[st];ut instanceof nl?(Kv(ut.layers,this.zoom,u),yB(ut,H,qe.positions,K,Ye.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection)):ut.hasPattern&&(ut instanceof ay||ut instanceof ry||ut instanceof Vp)&&(Kv(ut.layers,this.zoom,u),ut.addFeatures(k,this.tileID.canonical,Ye.patternPositions,u,this.tileTransform))}this.status="done",g(null,{buckets:Xe(T).filter(st=>!st.isEmpty()),featureIndex:A,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qe.image,lineAtlas:D,imageAtlas:Ye,glyphMap:this.returnDependencies?H:null,iconMap:this.returnDependencies?K:null,glyphPositions:this.returnDependencies?qe.positions:null})}}Be.length?p.send("getImages",{icons:Be,source:this.source,tileID:this.tileID,type:"patterns"},(qe,Ye)=>{N||(N=qe,te=Ye,Oe.call(this))},void 0,!1,ae):te={},Oe.call(this)}}function Kv(a,n,s){const u=new mi(n);for(const p of a)p.recalculate(u,s)}class YM{constructor(n){this.entries={},this.scheduler=n}request(n,s,u,p){const g=this.entries[n]=this.entries[n]||{callbacks:[]};if(g.result){const[x,A]=g.result;return this.scheduler?this.scheduler.add(()=>{p(x,A)},s):p(x,A),()=>{}}return g.callbacks.push(p),g.cancel||(g.cancel=u((x,A)=>{g.result=[x,A];for(const T of g.callbacks)this.scheduler?this.scheduler.add(()=>{T(x,A)},s):T(x,A);setTimeout(()=>delete this.entries[n],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(x=>x!==p),g.callbacks.length||(g.cancel(),delete this.entries[n]))}}}function XM(a,n,s){const u=JSON.stringify(a.request);return a.data&&(this.deduped.entries[u]={result:[null,a.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},p=>{const g=Ae(a.request,(x,A,T,D)=>{x?p(x):A&&p(null,{vectorTile:s?void 0:new dc.VectorTile(new jp(A)),rawData:A,cacheControl:T,expires:D})});return()=>{g.cancel(),p()}},n)}const HB=Pa(new Float32Array(16));class al{constructor(n){this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new ai(0,0)}projectTilePoint(n,s,u){return{x:n,y:s,z:0}}locationPoint(n,s){return n._coordinatePoint(n.locationCoordinate(s),!1)}pixelsPerMeter(n,s){return sh(1,n)*s}farthestPixelDistance(n){return function(s,u){const p=s.fovAboveCenter,g=s.elevation?s.elevation.getMinElevationBelowMSL()*u:0,x=(s._camera.position[2]*s.worldSize-g)/Math.cos(s._pitch),A=Math.sin(p)*x/Math.sin(Math.max(Math.PI/2-s._pitch-p,.01)),T=Math.sin(s._pitch)*A+x;return Math.min(1.01*T,x*(1/s._horizonShift))}(n,n.pixelsPerMeter)}pointCoordinate(n,s,u,p){const g=n.horizonLineFromTop(!1),x=new b(s,Math.max(g,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(x,p))}createInversionMatrix(n,s){return HB}createTileMatrix(n,s,u){let p,g,x;const A=u.canonical,T=Pa(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=pc(A,this);p=1,g=D.x+u.wrap*D.scale,x=D.y,$s(T,T,[p/D.scale,p/D.scale,n.pixelsPerMeter/s])}else p=s/n.zoomScale(A.z),g=(A.x+Math.pow(2,A.z)*u.wrap)*p,x=A.y*p;return uc(T,T,[g,x,0]),$s(T,T,[p/Bn,p/Bn,1]),T}upVector(n,s,u){return[0,0,1]}upVectorScale(n,s,u){return{metersToTile:1,metersToLabelSpace:1}}}class WB extends al{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:Pp(n),y:ah(s),z:0}}unproject(n,s){const u=Io(n),p=hr(s);return new ai(u,p)}}class qB extends al{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,u]=this.parallels=n.parallels||[29.5,45.5],p=Math.sin(B(s));this.n=(p+Math.sin(B(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:u,c:p,r0:g}=this,x=B(n-this.center[0]),A=B(s),T=Math.sqrt(p-2*u*Math.sin(A))/u;return{x:T*Math.sin(x*u),y:T*Math.cos(x*u)-g,z:0}}unproject(n,s){const{n:u,c:p,r0:g}=this,x=g+s;let A=Math.atan2(n,Math.abs(x))*Math.sign(x);x*u<0&&(A-=Math.PI*Math.sign(n)*Math.sign(x));const T=B(this.center[0])*u;A=fe(A,-Math.PI-T,Math.PI-T);const D=O(A/u)+this.center[0],k=Math.asin(oe((p-(n*n+x*x)*u*u)/(2*u),-1,1)),z=oe(O(k),-85.051129,Ea);return new ai(D,z)}}const Zp=1.340264,Jp=-.081106,Qp=893e-6,$p=.003796,_y=Math.sqrt(3)/2;class YB extends al{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(_y*Math.sin(s)),p=u*u,g=p*p*p;return{x:.5*(n*Math.cos(u)/(_y*(Zp+3*Jp*p+g*(7*Qp+9*$p*p)))/Math.PI+.5),y:1-.5*(u*(Zp+Jp*p+g*(Qp+$p*p))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,p=u*u,g=p*p*p;for(let k,z,N,H=0;H<12&&(z=u*(Zp+Jp*p+g*(Qp+$p*p))-s,N=Zp+3*Jp*p+g*(7*Qp+9*$p*p),k=z/N,u=oe(u-k,-Math.PI/3,Math.PI/3),p=u*u,g=p*p*p,!(Math.abs(k)<1e-12));++H);const x=_y*n*(Zp+3*Jp*p+g*(7*Qp+9*$p*p))/Math.cos(u),A=Math.asin(Math.sin(u)/_y),T=oe(180*x/Math.PI,-180,180),D=oe(180*A/Math.PI,-85.051129,Ea);return new ai(T,D)}}class XB extends al{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const u=360*(n-.5),p=oe(360*(.5-s),-85.051129,Ea);return new ai(u,p)}}const wh=Math.PI/2;function by(a){return Math.tan((wh+a)/2)}class KB extends al{constructor(n){super(n),this.center=n.center||[0,30];const[s,u]=this.parallels=n.parallels||[30,30],p=B(s),g=B(u),x=Math.cos(p);this.n=p===g?Math.sin(p):Math.log(x/Math.cos(g))/Math.log(by(g)/by(p)),this.f=x*Math.pow(by(p),this.n)/this.n}project(n,s){s=B(s),n=B(n-this.center[0]);const u=1e-6,{n:p,f:g}=this;g>0?s<-wh+u&&(s=-wh+u):s>wh-u&&(s=wh-u);const x=g/Math.pow(by(s),p),A=x*Math.sin(p*n),T=g-x*Math.cos(p*n);return{x:.5*(A/Math.PI+.5),y:1-.5*(T/Math.PI+.5),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,s=(2*(1-s)-.5)*Math.PI;const{n:u,f:p}=this,g=p-s,x=Math.sign(g),A=Math.sign(u)*Math.sqrt(n*n+g*g);let T=Math.atan2(n,Math.abs(g))*x;g*u<0&&(T-=Math.PI*Math.sign(n)*x);const D=oe(O(T/u)+this.center[0],-180,180),k=oe(O(2*Math.atan(Math.pow(p/A,1/u))-wh),-85.051129,Ea);return new ai(D,k)}}const KM=B(Ea);class ZB extends al{project(n,s){const u=(s=B(s))*s,p=u*u;return{x:.5*((n=B(n))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,p=25,g=0,x=u*u;do{x=u*u;const D=x*x;g=(u*(1.007226+x*(.015085+D*(.028874*x-.044475-.005916*D)))-s)/(1.007226+x*(.045255+D*(.259866*x-.311325-.005916*11*D))),u=oe(u-g,-KM,KM)}while(Math.abs(g)>1e-6&&--p>0);x=u*u;const A=oe(O(n/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),T=O(u);return new ai(A,T)}}const ZM=B(Ea);class JB extends al{project(n,s){s=B(s),n=B(n);const u=Math.cos(s),p=2/Math.PI,g=Math.acos(u*Math.cos(n/2)),x=Math.sin(g)/g,A=.5*(n*p+2*u*Math.sin(n/2)/x)||0,T=.5*(s+Math.sin(s)/x)||0;return{x:.5*(A/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(n,s){let u=n=(2*n-.5)*Math.PI,p=s=(2*(1-s)-1)*Math.PI,g=25;const x=1e-6;let A=0,T=0;do{const D=Math.cos(p),k=Math.sin(p),z=2*k*D,N=k*k,H=D*D,K=Math.cos(u/2),te=Math.sin(u/2),ae=2*K*te,he=te*te,Pe=1-H*K*K,Be=Pe?1/Pe:0,Oe=Pe?Math.acos(D*K)*Math.sqrt(1/Pe):0,qe=.5*(2*Oe*D*te+2*u/Math.PI)-n,Ye=.5*(Oe*k+p)-s,st=.5*Be*(H*he+Oe*D*K*N)+1/Math.PI,ut=Be*(ae*z/4-Oe*k*te),vt=.125*Be*(z*te-Oe*k*H*ae),Mt=.5*Be*(N*K+Oe*he*D)+.5,it=ut*vt-Mt*st;A=(Ye*ut-qe*Mt)/it,T=(qe*vt-Ye*st)/it,u=oe(u-A,-Math.PI,Math.PI),p=oe(p-T,-ZM,ZM)}while((Math.abs(A)>x||Math.abs(T)>x)&&--g>0);return new ai(O(u),O(p))}}class JM extends al{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(B(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:u,cosPhi:p}=this;return{x:B(n)*p*u+.5,y:-Math.sin(B(s))/p*u+.5,z:0}}unproject(n,s){const{scale:u,cosPhi:p}=this,g=-(s-.5)/u,x=oe(O((n-.5)/u)/p,-180,180),A=Math.asin(oe(g*p,-1,1)),T=oe(O(A),-85.051129,Ea);return new ai(x,T)}}r.ARRAY_TYPE=to,r.AUTH_ERR_MSG=Tn,r.Aabb=wo,r.Actor=class{constructor(a,n,s){this.target=a,this.parent=n,this.mapId=s,this.callbacks={},this.cancelCallbacks={},Pt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Se()?a:P,this.scheduler=new DB}send(a,n,s,u,p=!1,g){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=g,this.callbacks[x]=s);const A=gt(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:a,hasCallback:!!s,targetMapId:u,mustQueue:p,sourceMapId:this.mapId,data:ec(n,A)},A),{cancel:()=>{s&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(a){const n=a.data,s=n.id;if(s&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const u=this.cancelCallbacks[s];delete this.cancelCallbacks[s],u&&u.cancel()}else if(n.mustQueue||Se()){const u=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,n),u&&u.metadata||{type:"message"})}else this.processTask(s,n)}processTask(a,n){if(n.type==="<response>"){const s=this.callbacks[a];delete this.callbacks[a],s&&(n.error?s(Ws(n.error)):s(null,Ws(n.data)))}else{const s=gt(this.globalScope)?void 0:[],u=n.hasCallback?(g,x)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:g?ec(g):null,data:ec(x,s)},s)}:g=>{},p=Ws(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,p,u);else if(this.parent.getWorkerSource){const g=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,g[0],p.source)[g[1]](p,u)}else u(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.CanonicalTileID=gy,r.Color=Qn,r.ColorMode=Ia,r.CullFaceMode=ea,r.DEMData=xy,r.DataConstantProperty=C,r.DedupedRequest=YM,r.DepthMode=bh,r.EXTENT=Bn,r.Elevation=class{isDataAvailableAtPoint(a){const n=this._source();if(!n||a.y<0||a.y>1)return!1;const s=n.getSource().maxzoom,u=1<<s,p=Math.floor(a.x),g=Math.floor((a.x-p)*u),x=Math.floor(a.y*u),A=this.findDEMTileFor(new Tr(s,p,s,g,x));return!(!A||!A.dem)}getAtPointOrZero(a,n=0){return this.getAtPoint(a,n)||0}getAtPoint(a,n,s=!0){n==null&&(n=null);const u=this._source();if(!u||a.y<0||a.y>1)return n;const p=u.getSource().maxzoom,g=1<<p,x=Math.floor(a.x),A=a.x-x,T=new Tr(p,x,p,Math.floor(A*g),Math.floor(a.y*g)),D=this.findDEMTileFor(T);if(!D||!D.dem)return n;const k=D.dem,z=1<<D.tileID.canonical.z,N=(A*z-D.tileID.canonical.x)*k.dim,H=(a.y*z-D.tileID.canonical.y)*k.dim,K=Math.floor(N),te=Math.floor(H);return(s?this.exaggeration():1)*yn(yn(k.get(K,te),k.get(K,te+1),H-te),yn(k.get(K+1,te),k.get(K+1,te+1),H-te),N-K)}getAtTileOffset(a,n,s){const u=1<<a.canonical.z;return this.getAtPointOrZero(new Kg(a.wrap+(a.canonical.x+n/Bn)/u,(a.canonical.y+s/Bn)/u))}getAtTileOffsetFunc(a,n,s,u){return p=>{const g=this.getAtTileOffset(a,p.x,p.y),x=u.upVector(a.canonical,p.x,p.y);return Rp(x,x,g*u.upVectorScale(a.canonical,n,s).metersToTile),x}}getForTilePoints(a,n,s,u){const p=vy.create(this,a,u);return!!p&&(n.forEach(g=>{g[2]=this.exaggeration()*p.getElevationAt(g[0],g[1],s)}),!0)}getMinMaxForTile(a){const n=this.findDEMTileFor(a);if(!n||!n.dem)return null;const s=n.dem.tree,u=n.tileID,p=1<<a.canonical.z-u.canonical.z;let g=a.canonical.x/p-u.canonical.x,x=a.canonical.y/p-u.canonical.y,A=0;for(let T=0;T<a.canonical.z-u.canonical.z&&!s.leaves[A];T++){g*=2,x*=2;const D=2*Math.floor(x)+Math.floor(g);A=s.childOffsets[A]+D,g%=1,x%=1}return{min:this.exaggeration()*s.minimums[A],max:this.exaggeration()*s.maximums[A]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},r.ErrorEvent=ee,r.EvaluationParameters=mi,r.Event=X,r.Evented=Te,r.FillExtrusionBucket=Vp,r.Frustum=mv,r.GLOBE_RADIUS=_h,r.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a),this._createAtmosphere(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();this._gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this._wireframeIndexBuffer&&(this._wireframeIndexBuffer.destroy(),this._wireframeSegments.destroy())}_createGrid(a){const n=new ye,s=new Yt,u=65;for(let p=0;p<u;p++)for(let g=0;g<u;g++)n.emplaceBack(g,p);for(let p=0;p<64;p++)for(let g=0;g<64;g++){const x=p*u+g;s.emplaceBack(x+1,x,x+u),s.emplaceBack(x+u,x+u+1,x+1)}this._gridBuffer=a.createVertexBuffer(n,Yp.members),this._gridIndexBuffer=a.createIndexBuffer(s,!0),this._gridSegments=Di.simpleSegment(0,0,4225,8192)}_createPoles(a){const n=new Yt;for(let p=0;p<=64;p++)n.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=a.createIndexBuffer(n,!0);const s=new wn,u=new wn;this._poleSegments=[];for(let p=0,g=0;p<5;p++){const x=1<<p,A=512*x/Math.PI/2,T=360/x;s.emplaceBack(0,-A,0,0,0,.5,0),u.emplaceBack(0,-A,0,0,0,.5,1);for(let D=0;D<=64;D++){const k=D/64,z=yn(0,T,k),[N,H,K]=bM(zB,UB,z,A);s.emplaceBack(N,H,K,0,0,k,0),u.emplaceBack(N,H,K,0,0,k,1)}this._poleSegments.push(Di.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(s,vM,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(u,vM,!1)}_createAtmosphere(a){const n=new Nn;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const s=new Yt;s.emplaceBack(0,1,2),s.emplaceBack(2,3,0),this.atmosphereVertexBuffer=a.createVertexBuffer(n,LB.members),this.atmosphereIndexBuffer=a.createIndexBuffer(s),this.atmosphereSegments=Di.simpleSegment(0,0,4,2)}getGridBuffers(){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a){if(!this._wireframeSegments){const n=new Sn,s=64,u=s+1;for(let p=0;p<s;p++)for(let g=0;g<s;g++){const x=p*u+g;n.emplaceBack(x,x+1),n.emplaceBack(x,x+u),n.emplaceBack(x,x+u+1)}this._wireframeIndexBuffer=a.createIndexBuffer(n),this._wireframeSegments=Di.simpleSegment(0,0,s*s,n.length)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments]}},r.GlyphManager=xh,r.ImagePosition=Ev,r.LineAtlas=Vv,r.LngLat=ai,r.LngLatBounds=Qs,r.LocalGlyphMode=Dv,r.MAX_MERCATOR_LATITUDE=Ea,r.MercatorCoordinate=Kg,r.ONE_EM=dr,r.OverscaledTileID=Tr,r.Properties=Y,r.RGBAImage=no,r.Ray=class{constructor(a,n){this.pos=a,this.dir=n}intersectsPlane(a,n,s){const u=Ip(n,this.dir);if(Math.abs(u)<1e-6)return!1;const p=((a[0]-this.pos[0])*n[0]+(a[1]-this.pos[1])*n[1]+(a[2]-this.pos[2])*n[2])/u;return s[0]=this.pos[0]+this.dir[0]*p,s[1]=this.pos[1]+this.dir[1]*p,s[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(a,n,s){if(function(N,H){var K=N[0],te=N[1],ae=N[2],he=H[0],Pe=H[1],Be=H[2];return Math.abs(K-he)<=sv*Math.max(1,Math.abs(K),Math.abs(he))&&Math.abs(te-Pe)<=sv*Math.max(1,Math.abs(te),Math.abs(Pe))&&Math.abs(ae-Be)<=sv*Math.max(1,Math.abs(ae),Math.abs(Be))}(this.pos,a)||n===0)return s[0]=s[1]=s[2]=0,!1;const[u,p,g]=this.dir,x=this.pos[0]-a[0],A=this.pos[1]-a[1],T=this.pos[2]-a[2],D=u*u+p*p+g*g,k=2*(x*u+A*p+T*g),z=k*k-4*D*(x*x+A*A+T*T-n*n);if(z<0){const N=Math.max(-k/2,0),H=x+u*N,K=A+p*N,te=T+g*N,ae=Math.hypot(H,K,te);return s[0]=H*n/ae,s[1]=K*n/ae,s[2]=te*n/ae,!1}{const N=(-k-Math.sqrt(z))/(2*D);if(N<0){const H=Math.hypot(x,A,T);return s[0]=x*n/H,s[1]=A*n/H,s[2]=T*n/H,!1}return s[0]=x+u*N,s[1]=A+p*N,s[2]=T+g*N,!0}}},r.RequestManager=class{constructor(a,n,s){this._transformRequestFn=a,this._customAccessToken=n,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const a=function(){let n="";for(let s=0;s<10;s++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",bn,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,n){return this._transformRequestFn&&this._transformRequestFn(a,n)||{url:a}}normalizeStyleURL(a,n){if(!hn(a))return a;const s=Xt(a);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeGlyphsURL(a,n){if(!hn(a))return a;const s=Xt(a);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeSourceURL(a,n){if(!hn(a))return a;const s=Xt(a);return s.path=`/v4/${s.authority}.json`,s.params.push("secure"),this._makeAPIURL(s,this._customAccessToken||n)}normalizeSpriteURL(a,n,s,u){const p=Xt(a);return hn(a)?(p.path=`/styles/v1${p.path}/sprite${n}${s}`,this._makeAPIURL(p,this._customAccessToken||u)):(p.path+=`${n}${s}`,Ve(p))}normalizeTileURL(a,n,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!hn(a))return a;const u=Xt(a);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||s&&u.authority!=="raster"&&s===512?"@2x":""}${Ee.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${le.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${le.TILE_URL_VERSION}${u.path}`);const p=this._customAccessToken||function(g){for(const x of g){const A=x.match(/^access_token=(.*)$/);if(A)return A[1]}return null}(u.params)||le.ACCESS_TOKEN;return le.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,p)}canonicalizeTileURL(a,n){const s=Xt(a);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return a;let u="mapbox://";s.path.match(/^\/raster\/v1\//)?u+=`raster/${s.path.replace(`/${le.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${s.path.replace(`/${le.TILE_URL_VERSION}/`,"")}`;let p=s.params;return n&&(p=p.filter(g=>!g.match(/^access_token=/))),p.length&&(u+=`?${p.join("&")}`),u}canonicalizeTileset(a,n){const s=!!n&&hn(n),u=[];for(const p of a.tiles||[])jt(p)?u.push(this.canonicalizeTileURL(p,s)):u.push(p);return u}_makeAPIURL(a,n){const s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=Xt(le.API_URL);if(a.protocol=u.protocol,a.authority=u.authority,a.protocol==="http"){const p=a.params.indexOf("secure");p>=0&&a.params.splice(p,1)}if(u.path!=="/"&&(a.path=`${u.path}${a.path}`),!le.REQUIRE_ACCESS_TOKEN)return Ve(a);if(n=n||le.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return a.params=a.params.filter(p=>p.indexOf("access_token")===-1),a.params.push(`access_token=${n||""}`),Ve(a)}},r.ResourceType=de,r.SegmentVector=Di,r.SourceCache=fc,r.StencilMode=qv,r.StructArrayLayout1ui2=Zn,r.StructArrayLayout2f1f2i16=Qt,r.StructArrayLayout2i4=ye,r.StructArrayLayout2ui4=Sn,r.StructArrayLayout3f12=Ft,r.StructArrayLayout3ui6=Yt,r.StructArrayLayout4i8=Me,r.Texture=qp,r.Tile=Hv,r.Transitionable=m,r.Uniform1f=Yg,r.Uniform1i=class extends rs{constructor(a,n){super(a,n),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},r.Uniform2f=class extends rs{constructor(a,n){super(a,n),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},r.Uniform3f=class extends rs{constructor(a,n){super(a,n),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},r.Uniform4f=tA,r.UniformColor=nA,r.UniformMatrix2f=class extends rs{constructor(a,n){super(a,n),this.current=LF}set(a){for(let n=0;n<4;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}},r.UniformMatrix3f=class extends rs{constructor(a,n){super(a,n),this.current=IF}set(a){for(let n=0;n<9;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},r.UniformMatrix4f=class extends rs{constructor(a,n){super(a,n),this.current=DF}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let n=1;n<16;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},r.UnwrappedTileID=PM,r.ValidationError=Ht,r.VectorTileWorkerSource=class extends Te{constructor(a,n,s,u,p){super(),this.actor=a,this.layerIndex=n,this.availableImages=s,this.loadVectorData=p||XM,this.loading={},this.loaded={},this.deduped=new YM(a.scheduler),this.isSpriteLoaded=u,this.scheduler=a.scheduler}loadTile(a,n){const s=a.uid,u=a&&a.request,p=u&&u.collectResourceTiming,g=this.loading[s]=new jB(a);g.abort=this.loadVectorData(a,(x,A)=>{const T=!this.loading[s];if(delete this.loading[s],T||x||!A)return g.status="done",T||(this.loaded[s]=g),n(x);const D=A.rawData,k={};A.expires&&(k.expires=A.expires),A.cacheControl&&(k.cacheControl=A.cacheControl),g.vectorTile=A.vectorTile||new dc.VectorTile(new jp(D));const z=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(N,H)=>{if(N||!H)return n(N);const K={};if(p){const te=xM(u);te.length>0&&(K.resourceTiming=JSON.parse(JSON.stringify(te)))}n(null,Ne({rawTileData:D.slice(0)},H,k,K))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[s]=g})}reloadTile(a,n){const s=this.loaded,u=a.uid,p=this;if(s&&s[u]){const g=s[u];g.showCollisionBoxes=a.showCollisionBoxes,g.enableTerrain=!!a.enableTerrain,g.projection=a.projection,g.tileTransform=pc(a.tileID.canonical,a.projection);const x=(A,T)=>{const D=g.reloadCallback;D&&(delete g.reloadCallback,g.parse(g.vectorTile,p.layerIndex,this.availableImages,p.actor,D)),n(A,T)};g.status==="parsing"?g.reloadCallback=x:g.status==="done"&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(a,n){const s=a.uid,u=this.loading[s];u&&(u.abort&&u.abort(),delete this.loading[s]),n()}removeTile(a,n){const s=this.loaded,u=a.uid;s&&s[u]&&delete s[u],n()}},r.WritingMode=Ao,r.ZoomHistory=fp,r.add=yA,r.addDynamicAttributes=kv,r.adjoint=function(a,n){var s=n[0],u=n[1],p=n[2],g=n[3],x=n[4],A=n[5],T=n[6],D=n[7],k=n[8];return a[0]=x*k-A*D,a[1]=p*D-u*k,a[2]=u*A-p*x,a[3]=A*T-g*k,a[4]=s*k-p*T,a[5]=p*g-s*A,a[6]=g*D-x*T,a[7]=u*T-s*D,a[8]=s*x-u*g,a},r.asyncAll=Le,r.bezier=ie,r.bindAll=Pt,r.boundsAttributes=IM,r.bufferConvexPolygon=function(a,n){const s=[];for(let u=0;u<a.length;u++){const p=fe(u-1,-1,a.length-1),g=fe(u+1,-1,a.length-1),x=a[u],A=a[g],T=a[p].sub(x).unit(),D=A.sub(x).unit(),k=D.angleWithSep(T.x,T.y),z=T.add(D).unit().mult(-1*n/Math.sin(k/2));s.push(x.add(z))}return s},r.cacheEntryPossiblyAdded=function(a){Lr++,Lr>Zr&&(a.getActor().send("enforceCacheSizeLimit",Mi),Lr=0)},r.calculateGlobeLabelMatrix=function(a,n){const{lng:s,lat:u}=a._center,p=MM(0,0,a.worldSize/a._projectionScaler,s,u);return lv(p,p,function(g){const x=Pa(new Float64Array(16)),A=1/jv(g);return uc(x,x,g.min),$s(x,x,[A,A,A]),x}(Xp(n)))},r.calculateGlobeMatrix=SM,r.calculateGlobeMercatorMatrix=function(a){const n=a.worldSize,s=a.point,u=sh(1,a.center.lat)*n,p=a.pixelsPerMeter,g=n/(u/a.pixelsPerMeter),x=Pa(new Float64Array(16));return uc(x,x,[s.x,s.y,0]),$s(x,x,[g,g,p]),Float32Array.from(x)},r.circumferenceAtLatitude=tv,r.clamp=oe,r.clearTileCache=function(a){const n=P.caches.delete(ki);a&&n.catch(a).then(()=>a())},r.clipLine=cM,r.clone=function(a){var n=new to(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},r.clone$1=Vt,r.collisionCircleLayout=jk,r.config=le,r.conjugate=function(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=n[3],a},r.create=function(){var a=new to(16);return to!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},r.create$1=fA,r.createExpression=ql,r.createLayout=_e,r.createStyleLayer=function(a){return a.type==="custom"?new TB(a):new PB[a.type](a)},r.cross=_A,r.degToRad=B,r.div=function(a,n,s){return a[0]=n[0]/s[0],a[1]=n[1]/s[1],a[2]=n[2]/s[2],a},r.dot=Ip,r.earthRadius=ev,r.ease=$,r.easeCubicInOut=Z,r.emitValidationErrors=Eg,r.endsWith=mt,r.enforceCacheSizeLimit=function(a){Gi(),oi&&oi.then(n=>{n.keys().then(s=>{for(let u=0;u<s.length-a;u++)n.delete(s[u])})})},r.evaluateSizeForFeature=sy,r.evaluateSizeForZoom=fh,r.evaluateVariableOffset=fM,r.evented=Mp,r.exactEquals=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]},r.exactEquals$1=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]},r.exported=sn,r.exported$1=Ee,r.extend=Ne,r.extend$1=At,r.filterObject=ft,r.fromMat4=function(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[4],a[4]=n[5],a[5]=n[6],a[6]=n[8],a[7]=n[9],a[8]=n[10],a},r.fromQuat=function(a,n){var s=n[0],u=n[1],p=n[2],g=n[3],x=s+s,A=u+u,T=p+p,D=s*x,k=u*x,z=u*A,N=p*x,H=p*A,K=p*T,te=g*x,ae=g*A,he=g*T;return a[0]=1-z-K,a[1]=k+he,a[2]=N-ae,a[3]=0,a[4]=k-he,a[5]=1-D-K,a[6]=H+te,a[7]=0,a[8]=N+ae,a[9]=H-te,a[10]=1-D-z,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},r.fromRotation=function(a,n){var s=Math.sin(n),u=Math.cos(n);return a[0]=u,a[1]=s,a[2]=0,a[3]=-s,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},r.fromScaling=function(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},r.furthestTileCorner=function(a){const n=Math.round((a+45+360)%360/90)%4;return W[n]},r.getAABBPointSquareDist=function(a,n,s){let u=0;for(let p=0;p<2;++p){const g=s?s[p]:0;a[p]>g&&(u+=(a[p]-g)*(a[p]-g)),n[p]<g&&(u+=(g-n[p])*(g-n[p]))}return u},r.getAnchorAlignment=Rv,r.getAnchorJustification=Lv,r.getBounds=function(a){let n=1/0,s=1/0,u=-1/0,p=-1/0;for(const g of a)n=Math.min(n,g.x),s=Math.min(s,g.y),u=Math.max(u,g.x),p=Math.max(p,g.y);return{min:new b(n,s),max:new b(u,p)}},r.getColumn=function(a,n){return[a[4*n],a[4*n+1],a[4*n+2],a[4*n+3]]},r.getGridMatrix=function(a,n){const[s,u]=n,p=.015625;return[0,(u[1]-s[1])*p,1<<a.z,(u[0]-s[0])*p,0,a.y,s[0],s[1],p]},r.getImage=Gt,r.getJSON=function(a,n){return ce(Ne(a,{type:"json"}),n)},r.getMapSessionAPI=Ji,r.getPerformanceMeasurement=xM,r.getProjection=function(a){const n=a.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(a.name){case"mercator":return new WB(a);case"equirectangular":return new XB(a);case"naturalEarth":return new ZB(a);case"equalEarth":return new YB(a);case"winkelTripel":return new JB(a);case"albers":return s?new JM(a):new qB(a);case"lambertConformalConic":return s?new JM(a):new KB(a)}throw new Error(`Invalid projection name: ${a.name}`)},r.getRTLTextPluginStatus=rh,r.getReferrer=J,r.getTilePoint=function(a,{x:n,y:s},u=0){return new b(((n-u)*a.scale-a.x)*Bn,(s*a.scale-a.y)*Bn)},r.getTileVec3=function(a,n,s=0){return Cp(((n.x-s)*a.scale-a.x)*Bn,(n.y*a.scale-a.y)*Bn,oA(n.z,n.y))},r.getVideo=function(a,n){const s=P.document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let u=0;u<a.length;u++){const p=P.document.createElement("source");Je(a[u])||(s.crossOrigin="Anonymous"),p.src=a[u],s.appendChild(p)}return{cancel:()=>{}}},r.globeECEFOrigin=function(a,n){const s=[0,0,0];return hc(s,s,AM(Xp(n.canonical))),hc(s,s,a),s},r.globePixelsToTileUnits=function(a,n){return Bn/(512*Math.pow(2,a))*jv(Xp(n))},r.globePoleMatrixForTile=function(a,n,s){const u=Pa(new Float64Array(16)),p=1<<a,g=360*(n/p-.5),x=s.point,A=s.worldSize/(s.tileSize*p);return uc(u,u,[x.x,x.y,-s.worldSize/Math.PI/2]),$s(u,u,[A,A,A]),cv(u,u,B(-s._center.lat)),uv(u,u,B(-s._center.lng+g)),Float32Array.from(u)},r.globeTileLatLngCorners=Gv,r.globeToMercatorTransition=function(a){return be(5,6,a)},r.identity=Pa,r.identity$1=AA,r.invert=function(a,n){var s=n[0],u=n[1],p=n[2],g=n[3],x=n[4],A=n[5],T=n[6],D=n[7],k=n[8],z=n[9],N=n[10],H=n[11],K=n[12],te=n[13],ae=n[14],he=n[15],Pe=s*A-u*x,Be=s*T-p*x,Oe=s*D-g*x,qe=u*T-p*A,Ye=u*D-g*A,st=p*D-g*T,ut=k*te-z*K,vt=k*ae-N*K,Mt=k*he-H*K,it=z*ae-N*te,pt=z*he-H*te,Tt=N*he-H*ae,zt=Pe*Tt-Be*pt+Oe*it+qe*Mt-Ye*vt+st*ut;return zt?(a[0]=(A*Tt-T*pt+D*it)*(zt=1/zt),a[1]=(p*pt-u*Tt-g*it)*zt,a[2]=(te*st-ae*Ye+he*qe)*zt,a[3]=(N*Ye-z*st-H*qe)*zt,a[4]=(T*Mt-x*Tt-D*vt)*zt,a[5]=(s*Tt-p*Mt+g*vt)*zt,a[6]=(ae*Oe-K*st-he*Be)*zt,a[7]=(k*st-N*Oe+H*Be)*zt,a[8]=(x*pt-A*Mt+D*ut)*zt,a[9]=(u*Mt-s*pt-g*ut)*zt,a[10]=(K*Ye-te*Oe+he*Pe)*zt,a[11]=(z*Oe-k*Ye-H*Pe)*zt,a[12]=(A*vt-x*it-T*ut)*zt,a[13]=(s*it-u*vt+p*ut)*zt,a[14]=(te*Be-K*qe-ae*Pe)*zt,a[15]=(k*qe-z*Be+N*Pe)*zt,a):null},r.isMapAuthenticated=function(a){return jn.has(a)},r.isMapboxURL=hn,r.isSafariWithAntialiasingBug=function(a){const n=a.navigator?a.navigator.userAgent:null;return!!gt(a)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.latFromMercatorY=hr,r.len=ZF,r.length=gA,r.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},r.loadVectorTile=XM,r.makeRequest=ce,r.mercatorXfromLng=Pp,r.mercatorYfromLat=ah,r.mercatorZfromAltitude=sh,r.mul=XF,r.mul$1=KF,r.multiply=function(a,n,s){var u=n[0],p=n[1],g=n[2],x=n[3],A=n[4],T=n[5],D=n[6],k=n[7],z=n[8],N=s[0],H=s[1],K=s[2],te=s[3],ae=s[4],he=s[5],Pe=s[6],Be=s[7],Oe=s[8];return a[0]=N*u+H*x+K*D,a[1]=N*p+H*A+K*k,a[2]=N*g+H*T+K*z,a[3]=te*u+ae*x+he*D,a[4]=te*p+ae*A+he*k,a[5]=te*g+ae*T+he*z,a[6]=Pe*u+Be*x+Oe*D,a[7]=Pe*p+Be*A+Oe*k,a[8]=Pe*g+Be*T+Oe*z,a},r.multiply$1=lv,r.multiply$2=vA,r.nextPowerOfTwo=Ue,r.normalize=Dp,r.normalize$1=function(a,n){var s=n[0],u=n[1],p=n[2],g=n[3],x=s*s+u*u+p*p+g*g;return x>0&&(x=1/Math.sqrt(x)),a[0]=s*x,a[1]=u*x,a[2]=p*x,a[3]=g*x,a},r.number=yn,r.ortho=function(a,n,s,u,p,g,x){var A=1/(n-s),T=1/(u-p),D=1/(g-x);return a[0]=-2*A,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*D,a[11]=0,a[12]=(n+s)*A,a[13]=(p+u)*T,a[14]=(x+g)*D,a[15]=1,a},r.pbf=jp,r.perspective=function(a,n,s,u,p){var g,x=1/Math.tan(n/2);return a[0]=x/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,p!=null&&p!==1/0?(a[10]=(p+u)*(g=1/(u-p)),a[14]=2*p*u*g):(a[10]=-1,a[14]=-2*u),a},r.pick=function(a,n){const s={};for(let u=0;u<n.length;u++){const p=n[u];p in a&&(s[p]=a[p])}return s},r.plugin=$r,r.pointGeometry=b,r.polygonIntersectsBox=hA,r.polygonIntersectsPolygon=sA,r.polygonizeBounds=function(a,n,s=0,u=!0){const p=new b(s,s),g=a.sub(p),x=n.add(p),A=[g,new b(x.x,g.y),x,new b(g.x,x.y)];return u&&A.push(g),A},r.posAttributes=Yp,r.postMapLoadEvent=qn,r.postTurnstileEvent=fn,r.potpack=Tv,r.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},r.radToDeg=O,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.registerForPluginStateChange=function(a){return a({pluginStatus:Sr,pluginURL:Nr}),Mp.on("pluginStateChange",a),a},r.removeAuthState=function(a){jn.delete(a)},r.renderColorRamp=yv,r.rotateX=cv,r.rotateX$1=MA,r.rotateY=uv,r.rotateZ=function(a,n,s){var u=Math.sin(s),p=Math.cos(s),g=n[0],x=n[1],A=n[2],T=n[3],D=n[4],k=n[5],z=n[6],N=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=g*p+D*u,a[1]=x*p+k*u,a[2]=A*p+z*u,a[3]=T*p+N*u,a[4]=D*p-g*u,a[5]=k*p-x*u,a[6]=z*p-A*u,a[7]=N*p-T*u,a},r.rotateZ$1=function(a,n,s){s*=.5;var u=n[0],p=n[1],g=n[2],x=n[3],A=Math.sin(s),T=Math.cos(s);return a[0]=u*T+p*A,a[1]=p*T-u*A,a[2]=g*T+x*A,a[3]=x*T-g*A,a},r.scale=$s,r.scale$1=function(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a[3]=n[3]*s,a},r.scale$2=Rp,r.scaleAndAdd=fv,r.setCacheLimits=function(a,n){Mi=a,Zr=n},r.setColumn=function(a,n,s){a[4*n+0]=s[0],a[4*n+1]=s[1],a[4*n+2]=s[2],a[4*n+3]=s[3]},r.setRTLTextPlugin=function(a,n,s=!1){if(Sr===bp||Sr===rc||Sr===wp)throw new Error("setRTLTextPlugin cannot be called multiple times.");Nr=sn.resolveURL(a),Sr=bp,Ap=n,ns(),s||Ys()},r.smoothstep=be,r.spec=me,r.storeAuthState=function(a,n){n?jn.add(a):jn.delete(a)},r.sub=uh,r.subtract=xA,r.symbolSize=Hk,r.tileAABB=function(a,n,s,u,p,g,x,A,T){if(T.name==="globe")return BB(a,n,new gy(s,u,p));const D=pc({z:s,x:u,y:p},T);return new wo([(g+D.x/D.scale)*n,n*(D.y/D.scale),x],[(g+D.x2/D.scale)*n,n*(D.y2/D.scale),A])},r.tileTransform=pc,r.transformMat3=function(a,n,s){var u=n[0],p=n[1],g=n[2];return a[0]=u*s[0]+p*s[3]+g*s[6],a[1]=u*s[1]+p*s[4]+g*s[7],a[2]=u*s[2]+p*s[5]+g*s[8],a},r.transformMat4=hc,r.transformMat4$1=hh,r.transformQuat=bA,r.translate=uc,r.transpose=function(a,n){if(a===n){var s=n[1],u=n[2],p=n[5];a[1]=n[3],a[2]=n[6],a[3]=s,a[5]=n[7],a[6]=u,a[7]=p}else a[0]=n[0],a[1]=n[3],a[2]=n[6],a[3]=n[1],a[4]=n[4],a[5]=n[7],a[6]=n[2],a[7]=n[5],a[8]=n[8];return a},r.triggerPluginCompletionEvent=oc,r.uniqueId=Ie,r.validateCustomStyleLayer=function(a){const n=[],s=a.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),a.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},r.validateFilter=a=>Ko(Aa(a)),r.validateFog=a=>Ko(Tg(a)),r.validateLayer=a=>Ko(bg(a)),r.validateLight=a=>Ko(Mg(a)),r.validateSource=a=>Ko(Ag(a)),r.validateStyle=$l,r.validateTerrain=a=>Ko(Sg(a)),r.values=Xe,r.vectorTile=dc,r.version=v,r.warnOnce=pe,r.window=P,r.wrap=fe}),h(["./shared"],function(r){function v(de){if(typeof de=="number"||typeof de=="boolean"||typeof de=="string"||de==null)return JSON.stringify(de);if(Array.isArray(de)){let J="[";for(const ce of de)J+=`${v(ce)},`;return`${J}]`}let q="{";for(const J of Object.keys(de).sort())q+=`${J}:${v(de[J])},`;return`${q}}`}function _(de){let q="";for(const J of r.refProperties)q+=`/${v(de[J])}`;return q}class w{constructor(q){this.keyCache={},q&&this.replace(q)}replace(q){this._layerConfigs={},this._layers={},this.update(q,[])}update(q,J){for(const Ae of q)this._layerConfigs[Ae.id]=Ae,(this._layers[Ae.id]=r.createStyleLayer(Ae)).compileFilter(),this.keyCache[Ae.id]&&delete this.keyCache[Ae.id];for(const Ae of J)delete this.keyCache[Ae],delete this._layerConfigs[Ae],delete this._layers[Ae];this.familiesBySource={};const ce=function(Ae,Fe){const Ze={};for(let ze=0;ze<Ae.length;ze++){const et=Fe&&Fe[Ae[ze].id]||_(Ae[ze]);Fe&&(Fe[Ae[ze].id]=et);let xt=Ze[et];xt||(xt=Ze[et]=[]),xt.push(Ae[ze])}const Je=[];for(const ze in Ze)Je.push(Ze[ze]);return Je}(r.values(this._layerConfigs),this.keyCache);for(const Ae of ce){const Fe=Ae.map(Gt=>this._layers[Gt.id]),Ze=Fe[0];if(Ze.visibility==="none")continue;const Je=Ze.source||"";let ze=this.familiesBySource[Je];ze||(ze=this.familiesBySource[Je]={});const et=Ze.sourceLayer||"_geojsonTileLayer";let xt=ze[et];xt||(xt=ze[et]=[]),xt.push(Fe)}}}class b{loadTile(q,J){const{uid:ce,encoding:Ae,rawImageData:Fe,padding:Ze,buildQuadTree:Je}=q,ze=r.window.ImageBitmap&&Fe instanceof r.window.ImageBitmap?this.getImageData(Fe,Ze):Fe;J(null,new r.DEMData(ce,ze,Ae,Ze<1,Je))}getImageData(q,J){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(q.width,q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=q.width,this.offscreenCanvas.height=q.height,this.offscreenCanvasContext.drawImage(q,0,0,q.width,q.height);const ce=this.offscreenCanvasContext.getImageData(-J,-J,q.width+2*J,q.height+2*J);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ce}}var E=function de(q,J){var ce,Ae=q&&q.type;if(Ae==="FeatureCollection")for(ce=0;ce<q.features.length;ce++)de(q.features[ce],J);else if(Ae==="GeometryCollection")for(ce=0;ce<q.geometries.length;ce++)de(q.geometries[ce],J);else if(Ae==="Feature")de(q.geometry,J);else if(Ae==="Polygon")P(q.coordinates,J);else if(Ae==="MultiPolygon")for(ce=0;ce<q.coordinates.length;ce++)P(q.coordinates[ce],J);return q};function P(de,q){if(de.length!==0){I(de[0],q);for(var J=1;J<de.length;J++)I(de[J],!q)}}function I(de,q){for(var J=0,ce=0,Ae=0,Fe=de.length,Ze=Fe-1;Ae<Fe;Ze=Ae++){var Je=(de[Ae][0]-de[Ze][0])*(de[Ze][1]+de[Ae][1]),ze=J+Je;ce+=Math.abs(J)>=Math.abs(Je)?J-ze+Je:Je-ze+J,J=ze}J+ce>=0!=!!q&&de.reverse()}const F=r.vectorTile.VectorTileFeature.prototype.toGeoJSON;class B{constructor(q){this._feature=q,this.extent=r.EXTENT,this.type=q.type,this.properties=q.tags,"id"in q&&!isNaN(q.id)&&(this.id=parseInt(q.id,10))}loadGeometry(){if(this._feature.type===1){const q=[];for(const J of this._feature.geometry)q.push([new r.pointGeometry(J[0],J[1])]);return q}{const q=[];for(const J of this._feature.geometry){const ce=[];for(const Ae of J)ce.push(new r.pointGeometry(Ae[0],Ae[1]));q.push(ce)}return q}}toGeoJSON(q,J,ce){return F.call(this,q,J,ce)}}class O{constructor(q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=q.length,this._features=q}feature(q){return new B(this._features[q])}}var W=r.vectorTile.VectorTileFeature,Z=ie;function ie(de,q){this.options=q||{},this.features=de,this.length=de.length}function $(de,q){this.id=typeof de.id=="number"?de.id:void 0,this.type=de.type,this.rawGeometry=de.type===1?[de.geometry]:de.geometry,this.properties=de.tags,this.extent=q||4096}ie.prototype.feature=function(de){return new $(this.features[de],this.options.extent)},$.prototype.loadGeometry=function(){var de=this.rawGeometry;this.geometry=[];for(var q=0;q<de.length;q++){for(var J=de[q],ce=[],Ae=0;Ae<J.length;Ae++)ce.push(new r.pointGeometry(J[Ae][0],J[Ae][1]));this.geometry.push(ce)}return this.geometry},$.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var de=this.geometry,q=1/0,J=-1/0,ce=1/0,Ae=-1/0,Fe=0;Fe<de.length;Fe++)for(var Ze=de[Fe],Je=0;Je<Ze.length;Je++){var ze=Ze[Je];q=Math.min(q,ze.x),J=Math.max(J,ze.x),ce=Math.min(ce,ze.y),Ae=Math.max(Ae,ze.y)}return[q,ce,J,Ae]},$.prototype.toGeoJSON=W.prototype.toGeoJSON;var oe=fe,be=Z;function fe(de){var q=new r.pbf;return function(J,ce){for(var Ae in J.layers)ce.writeMessage(3,Le,J.layers[Ae])}(de,q),q.finish()}function Le(de,q){var J;q.writeVarintField(15,de.version||1),q.writeStringField(1,de.name||""),q.writeVarintField(5,de.extent||4096);var ce={keys:[],values:[],keycache:{},valuecache:{}};for(J=0;J<de.length;J++)ce.feature=de.feature(J),q.writeMessage(2,Xe,ce);var Ae=ce.keys;for(J=0;J<Ae.length;J++)q.writeStringField(3,Ae[J]);var Fe=ce.values;for(J=0;J<Fe.length;J++)q.writeMessage(4,Ue,Fe[J])}function Xe(de,q){var J=de.feature;J.id!==void 0&&q.writeVarintField(1,J.id),q.writeMessage(2,Ne,de),q.writeVarintField(3,J.type),q.writeMessage(4,He,J)}function Ne(de,q){var J=de.feature,ce=de.keys,Ae=de.values,Fe=de.keycache,Ze=de.valuecache;for(var Je in J.properties){var ze=J.properties[Je],et=Fe[Je];if(ze!==null){et===void 0&&(ce.push(Je),Fe[Je]=et=ce.length-1),q.writeVarint(et);var xt=typeof ze;xt!=="string"&&xt!=="boolean"&&xt!=="number"&&(ze=JSON.stringify(ze));var Gt=xt+":"+ze,St=Ze[Gt];St===void 0&&(Ae.push(ze),Ze[Gt]=St=Ae.length-1),q.writeVarint(St)}}}function Re(de,q){return(q<<3)+(7&de)}function Ie(de){return de<<1^de>>31}function He(de,q){for(var J=de.loadGeometry(),ce=de.type,Ae=0,Fe=0,Ze=J.length,Je=0;Je<Ze;Je++){var ze=J[Je],et=1;ce===1&&(et=ze.length),q.writeVarint(Re(1,et));for(var xt=ce===3?ze.length-1:ze.length,Gt=0;Gt<xt;Gt++){Gt===1&&ce!==1&&q.writeVarint(Re(2,xt-1));var St=ze[Gt].x-Ae,vn=ze[Gt].y-Fe;q.writeVarint(Ie(St)),q.writeVarint(Ie(vn)),Ae+=St,Fe+=vn}ce===3&&q.writeVarint(Re(7,1))}}function Ue(de,q){var J=typeof de;J==="string"?q.writeStringField(1,de):J==="boolean"?q.writeBooleanField(7,de):J==="number"&&(de%1!=0?q.writeDoubleField(3,de):de<0?q.writeSVarintField(6,de):q.writeVarintField(5,de))}function ot(de,q,J,ce,Ae,Fe){if(Ae-ce<=J)return;const Ze=ce+Ae>>1;Pt(de,q,Ze,ce,Ae,Fe%2),ot(de,q,J,ce,Ze-1,Fe+1),ot(de,q,J,Ze+1,Ae,Fe+1)}function Pt(de,q,J,ce,Ae,Fe){for(;Ae>ce;){if(Ae-ce>600){const et=Ae-ce+1,xt=J-ce+1,Gt=Math.log(et),St=.5*Math.exp(2*Gt/3),vn=.5*Math.sqrt(Gt*St*(et-St)/et)*(xt-et/2<0?-1:1);Pt(de,q,J,Math.max(ce,Math.floor(J-xt*St/et+vn)),Math.min(Ae,Math.floor(J+(et-xt)*St/et+vn)),Fe)}const Ze=q[2*J+Fe];let Je=ce,ze=Ae;for(mt(de,q,ce,J),q[2*Ae+Fe]>Ze&&mt(de,q,ce,Ae);Je<ze;){for(mt(de,q,Je,ze),Je++,ze--;q[2*Je+Fe]<Ze;)Je++;for(;q[2*ze+Fe]>Ze;)ze--}q[2*ce+Fe]===Ze?mt(de,q,ce,ze):(ze++,mt(de,q,ze,Ae)),ze<=J&&(ce=ze+1),J<=ze&&(Ae=ze-1)}}function mt(de,q,J,ce){_t(de,J,ce),_t(q,2*J,2*ce),_t(q,2*J+1,2*ce+1)}function _t(de,q,J){const ce=de[q];de[q]=de[J],de[J]=ce}function ft(de,q,J,ce){const Ae=de-J,Fe=q-ce;return Ae*Ae+Fe*Fe}oe.fromVectorTileJs=fe,oe.fromGeojsonVt=function(de,q){q=q||{};var J={};for(var ce in de)J[ce]=new Z(de[ce].features,q),J[ce].name=ce,J[ce].version=q.version,J[ce].extent=q.extent;return fe({layers:J})},oe.GeoJSONWrapper=be;const Vt=de=>de[0],we=de=>de[1];class pe{constructor(q,J=Vt,ce=we,Ae=64,Fe=Float64Array){this.nodeSize=Ae,this.points=q;const Ze=q.length<65536?Uint16Array:Uint32Array,Je=this.ids=new Ze(q.length),ze=this.coords=new Fe(2*q.length);for(let et=0;et<q.length;et++)Je[et]=et,ze[2*et]=J(q[et]),ze[2*et+1]=ce(q[et]);ot(Je,ze,Ae,0,Je.length-1,0)}range(q,J,ce,Ae){return function(Fe,Ze,Je,ze,et,xt,Gt){const St=[0,Fe.length-1,0],vn=[];let X,ee;for(;St.length;){const Te=St.pop(),me=St.pop(),At=St.pop();if(me-At<=Gt){for(let rn=At;rn<=me;rn++)X=Ze[2*rn],ee=Ze[2*rn+1],X>=Je&&X<=et&&ee>=ze&&ee<=xt&&vn.push(Fe[rn]);continue}const yt=Math.floor((At+me)/2);X=Ze[2*yt],ee=Ze[2*yt+1],X>=Je&&X<=et&&ee>=ze&&ee<=xt&&vn.push(Fe[yt]);const Nt=(Te+1)%2;(Te===0?Je<=X:ze<=ee)&&(St.push(At),St.push(yt-1),St.push(Nt)),(Te===0?et>=X:xt>=ee)&&(St.push(yt+1),St.push(me),St.push(Nt))}return vn}(this.ids,this.coords,q,J,ce,Ae,this.nodeSize)}within(q,J,ce){return function(Ae,Fe,Ze,Je,ze,et){const xt=[0,Ae.length-1,0],Gt=[],St=ze*ze;for(;xt.length;){const vn=xt.pop(),X=xt.pop(),ee=xt.pop();if(X-ee<=et){for(let Nt=ee;Nt<=X;Nt++)ft(Fe[2*Nt],Fe[2*Nt+1],Ze,Je)<=St&&Gt.push(Ae[Nt]);continue}const Te=Math.floor((ee+X)/2),me=Fe[2*Te],At=Fe[2*Te+1];ft(me,At,Ze,Je)<=St&&Gt.push(Ae[Te]);const yt=(vn+1)%2;(vn===0?Ze-ze<=me:Je-ze<=At)&&(xt.push(ee),xt.push(Te-1),xt.push(yt)),(vn===0?Ze+ze>=me:Je+ze>=At)&&(xt.push(Te+1),xt.push(X),xt.push(yt))}return Gt}(this.ids,this.coords,q,J,ce,this.nodeSize)}}const ke={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:de=>de},De=Math.fround||(Se=new Float32Array(1),de=>(Se[0]=+de,Se[0]));var Se;class tt{constructor(q){this.options=sn(Object.create(ke),q),this.trees=new Array(this.options.maxZoom+1)}load(q){const{log:J,minZoom:ce,maxZoom:Ae,nodeSize:Fe}=this.options;J&&console.time("total time");const Ze=`prepare ${q.length} points`;J&&console.time(Ze),this.points=q;let Je=[];for(let ze=0;ze<q.length;ze++)q[ze].geometry&&Je.push(We(q[ze],ze));this.trees[Ae+1]=new pe(Je,An,le,Fe,Float32Array),J&&console.timeEnd(Ze);for(let ze=Ae;ze>=ce;ze--){const et=+Date.now();Je=this._cluster(Je,ze),this.trees[ze]=new pe(Je,An,le,Fe,Float32Array),J&&console.log("z%d: %d clusters in %dms",ze,Je.length,+Date.now()-et)}return J&&console.timeEnd("total time"),this}getClusters(q,J){let ce=((q[0]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,q[1]));let Fe=q[2]===180?180:((q[2]+180)%360+360)%360-180;const Ze=Math.max(-90,Math.min(90,q[3]));if(q[2]-q[0]>=360)ce=-180,Fe=180;else if(ce>Fe){const xt=this.getClusters([ce,Ae,180,Ze],J),Gt=this.getClusters([-180,Ae,Fe,Ze],J);return xt.concat(Gt)}const Je=this.trees[this._limitZoom(J)],ze=Je.range(lt(ce),gt(Ze),lt(Fe),gt(Ae)),et=[];for(const xt of ze){const Gt=Je.points[xt];et.push(Gt.numPoints?nt(Gt):this.points[Gt.index])}return et}getChildren(q){const J=this._getOriginId(q),ce=this._getOriginZoom(q),Ae="No cluster with the specified id.",Fe=this.trees[ce];if(!Fe)throw new Error(Ae);const Ze=Fe.points[J];if(!Ze)throw new Error(Ae);const Je=this.options.radius/(this.options.extent*Math.pow(2,ce-1)),ze=Fe.within(Ze.x,Ze.y,Je),et=[];for(const xt of ze){const Gt=Fe.points[xt];Gt.parentId===q&&et.push(Gt.numPoints?nt(Gt):this.points[Gt.index])}if(et.length===0)throw new Error(Ae);return et}getLeaves(q,J,ce){const Ae=[];return this._appendLeaves(Ae,q,J=J||10,ce=ce||0,0),Ae}getTile(q,J,ce){const Ae=this.trees[this._limitZoom(q)],Fe=Math.pow(2,q),{extent:Ze,radius:Je}=this.options,ze=Je/Ze,et=(ce-ze)/Fe,xt=(ce+1+ze)/Fe,Gt={features:[]};return this._addTileFeatures(Ae.range((J-ze)/Fe,et,(J+1+ze)/Fe,xt),Ae.points,J,ce,Fe,Gt),J===0&&this._addTileFeatures(Ae.range(1-ze/Fe,et,1,xt),Ae.points,Fe,ce,Fe,Gt),J===Fe-1&&this._addTileFeatures(Ae.range(0,et,ze/Fe,xt),Ae.points,-1,ce,Fe,Gt),Gt.features.length?Gt:null}getClusterExpansionZoom(q){let J=this._getOriginZoom(q)-1;for(;J<=this.options.maxZoom;){const ce=this.getChildren(q);if(J++,ce.length!==1)break;q=ce[0].properties.cluster_id}return J}_appendLeaves(q,J,ce,Ae,Fe){const Ze=this.getChildren(J);for(const Je of Ze){const ze=Je.properties;if(ze&&ze.cluster?Fe+ze.point_count<=Ae?Fe+=ze.point_count:Fe=this._appendLeaves(q,ze.cluster_id,ce,Ae,Fe):Fe<Ae?Fe++:q.push(Je),q.length===ce)break}return Fe}_addTileFeatures(q,J,ce,Ae,Fe,Ze){for(const Je of q){const ze=J[Je],et=ze.numPoints;let xt,Gt,St;if(et)xt=je(ze),Gt=ze.x,St=ze.y;else{const ee=this.points[ze.index];xt=ee.properties,Gt=lt(ee.geometry.coordinates[0]),St=gt(ee.geometry.coordinates[1])}const vn={type:1,geometry:[[Math.round(this.options.extent*(Gt*Fe-ce)),Math.round(this.options.extent*(St*Fe-Ae))]],tags:xt};let X;et?X=ze.id:this.options.generateId?X=ze.index:this.points[ze.index].id&&(X=this.points[ze.index].id),X!==void 0&&(vn.id=X),Ze.features.push(vn)}}_limitZoom(q){return Math.max(this.options.minZoom,Math.min(+q,this.options.maxZoom+1))}_cluster(q,J){const ce=[],{radius:Ae,extent:Fe,reduce:Ze,minPoints:Je}=this.options,ze=Ae/(Fe*Math.pow(2,J));for(let et=0;et<q.length;et++){const xt=q[et];if(xt.zoom<=J)continue;xt.zoom=J;const Gt=this.trees[J+1],St=Gt.within(xt.x,xt.y,ze),vn=xt.numPoints||1;let X=vn;for(const ee of St){const Te=Gt.points[ee];Te.zoom>J&&(X+=Te.numPoints||1)}if(X>vn&&X>=Je){let ee=xt.x*vn,Te=xt.y*vn,me=Ze&&vn>1?this._map(xt,!0):null;const At=(et<<5)+(J+1)+this.points.length;for(const yt of St){const Nt=Gt.points[yt];if(Nt.zoom<=J)continue;Nt.zoom=J;const rn=Nt.numPoints||1;ee+=Nt.x*rn,Te+=Nt.y*rn,Nt.parentId=At,Ze&&(me||(me=this._map(xt,!0)),Ze(me,this._map(Nt)))}xt.parentId=At,ce.push(Ge(ee/X,Te/X,At,X,me))}else if(ce.push(xt),X>1)for(const ee of St){const Te=Gt.points[ee];Te.zoom<=J||(Te.zoom=J,ce.push(Te))}}return ce}_getOriginId(q){return q-this.points.length>>5}_getOriginZoom(q){return(q-this.points.length)%32}_map(q,J){if(q.numPoints)return J?sn({},q.properties):q.properties;const ce=this.points[q.index].properties,Ae=this.options.map(ce);return J&&Ae===ce?sn({},Ae):Ae}}function Ge(de,q,J,ce,Ae){return{x:De(de),y:De(q),zoom:1/0,id:J,parentId:-1,numPoints:ce,properties:Ae}}function We(de,q){const[J,ce]=de.geometry.coordinates;return{x:De(lt(J)),y:De(gt(ce)),zoom:1/0,index:q,parentId:-1}}function nt(de){return{type:"Feature",id:de.id,properties:je(de),geometry:{type:"Point",coordinates:[(q=de.x,360*(q-.5)),Lt(de.y)]}};var q}function je(de){const q=de.numPoints,J=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q;return sn(sn({},de.properties),{cluster:!0,cluster_id:de.id,point_count:q,point_count_abbreviated:J})}function lt(de){return de/360+.5}function gt(de){const q=Math.sin(de*Math.PI/180),J=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return J<0?0:J>1?1:J}function Lt(de){const q=(180-360*de)*Math.PI/180;return 360*Math.atan(Math.exp(q))/Math.PI-90}function sn(de,q){for(const J in q)de[J]=q[J];return de}function An(de){return de.x}function le(de){return de.y}function Ee(de,q,J,ce){for(var Ae,Fe=ce,Ze=J-q>>1,Je=J-q,ze=de[q],et=de[q+1],xt=de[J],Gt=de[J+1],St=q+3;St<J;St+=3){var vn=Et(de[St],de[St+1],ze,et,xt,Gt);if(vn>Fe)Ae=St,Fe=vn;else if(vn===Fe){var X=Math.abs(St-Ze);X<Je&&(Ae=St,Je=X)}}Fe>ce&&(Ae-q>3&&Ee(de,q,Ae,ce),de[Ae+2]=Fe,J-Ae>3&&Ee(de,Ae,J,ce))}function Et(de,q,J,ce,Ae,Fe){var Ze=Ae-J,Je=Fe-ce;if(Ze!==0||Je!==0){var ze=((de-J)*Ze+(q-ce)*Je)/(Ze*Ze+Je*Je);ze>1?(J=Ae,ce=Fe):ze>0&&(J+=Ze*ze,ce+=Je*ze)}return(Ze=de-J)*Ze+(Je=q-ce)*Je}function wt(de,q,J,ce){var Ae={id:de===void 0?null:de,type:q,geometry:J,tags:ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Fe){var Ze=Fe.geometry,Je=Fe.type;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")Mn(Fe,Ze);else if(Je==="Polygon"||Je==="MultiLineString")for(var ze=0;ze<Ze.length;ze++)Mn(Fe,Ze[ze]);else if(Je==="MultiPolygon")for(ze=0;ze<Ze.length;ze++)for(var et=0;et<Ze[ze].length;et++)Mn(Fe,Ze[ze][et])}(Ae),Ae}function Mn(de,q){for(var J=0;J<q.length;J+=3)de.minX=Math.min(de.minX,q[J]),de.minY=Math.min(de.minY,q[J+1]),de.maxX=Math.max(de.maxX,q[J]),de.maxY=Math.max(de.maxY,q[J+1])}function xn(de,q,J,ce){if(q.geometry){var Ae=q.geometry.coordinates,Fe=q.geometry.type,Ze=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2),Je=[],ze=q.id;if(J.promoteId?ze=q.properties[J.promoteId]:J.generateId&&(ze=ce||0),Fe==="Point")un(Ae,Je);else if(Fe==="MultiPoint")for(var et=0;et<Ae.length;et++)un(Ae[et],Je);else if(Fe==="LineString")bn(Ae,Je,Ze,!1);else if(Fe==="MultiLineString"){if(J.lineMetrics){for(et=0;et<Ae.length;et++)bn(Ae[et],Je=[],Ze,!1),de.push(wt(ze,"LineString",Je,q.properties));return}Tn(Ae,Je,Ze,!1)}else if(Fe==="Polygon")Tn(Ae,Je,Ze,!0);else{if(Fe!=="MultiPolygon"){if(Fe==="GeometryCollection"){for(et=0;et<q.geometry.geometries.length;et++)xn(de,{id:ze,geometry:q.geometry.geometries[et],properties:q.properties},J,ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(et=0;et<Ae.length;et++){var xt=[];Tn(Ae[et],xt,Ze,!0),Je.push(xt)}}de.push(wt(ze,Fe,Je,q.properties))}}function un(de,q){q.push(hn(de[0])),q.push(jt(de[1])),q.push(0)}function bn(de,q,J,ce){for(var Ae,Fe,Ze=0,Je=0;Je<de.length;Je++){var ze=hn(de[Je][0]),et=jt(de[Je][1]);q.push(ze),q.push(et),q.push(0),Je>0&&(Ze+=ce?(Ae*et-ze*Fe)/2:Math.sqrt(Math.pow(ze-Ae,2)+Math.pow(et-Fe,2))),Ae=ze,Fe=et}var xt=q.length-3;q[2]=1,Ee(q,0,xt,J),q[xt+2]=1,q.size=Math.abs(Ze),q.start=0,q.end=q.size}function Tn(de,q,J,ce){for(var Ae=0;Ae<de.length;Ae++){var Fe=[];bn(de[Ae],Fe,J,ce),q.push(Fe)}}function hn(de){return de/360+.5}function jt(de){var q=Math.sin(de*Math.PI/180),J=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return J<0?0:J>1?1:J}function ln(de,q,J,ce,Ae,Fe,Ze,Je){if(ce/=q,Fe>=(J/=q)&&Ze<ce)return de;if(Ze<J||Fe>=ce)return null;for(var ze=[],et=0;et<de.length;et++){var xt=de[et],Gt=xt.geometry,St=xt.type,vn=Ae===0?xt.minX:xt.minY,X=Ae===0?xt.maxX:xt.maxY;if(vn>=J&&X<ce)ze.push(xt);else if(!(X<J||vn>=ce)){var ee=[];if(St==="Point"||St==="MultiPoint")Xt(Gt,ee,J,ce,Ae);else if(St==="LineString")Ve(Gt,ee,J,ce,Ae,!1,Je.lineMetrics);else if(St==="MultiLineString")en(Gt,ee,J,ce,Ae,!1);else if(St==="Polygon")en(Gt,ee,J,ce,Ae,!0);else if(St==="MultiPolygon")for(var Te=0;Te<Gt.length;Te++){var me=[];en(Gt[Te],me,J,ce,Ae,!0),me.length&&ee.push(me)}if(ee.length){if(Je.lineMetrics&&St==="LineString"){for(Te=0;Te<ee.length;Te++)ze.push(wt(xt.id,St,ee[Te],xt.tags));continue}St!=="LineString"&&St!=="MultiLineString"||(ee.length===1?(St="LineString",ee=ee[0]):St="MultiLineString"),St!=="Point"&&St!=="MultiPoint"||(St=ee.length===3?"Point":"MultiPoint"),ze.push(wt(xt.id,St,ee,xt.tags))}}}return ze.length?ze:null}function Xt(de,q,J,ce,Ae){for(var Fe=0;Fe<de.length;Fe+=3){var Ze=de[Fe+Ae];Ze>=J&&Ze<=ce&&(q.push(de[Fe]),q.push(de[Fe+1]),q.push(de[Fe+2]))}}function Ve(de,q,J,ce,Ae,Fe,Ze){for(var Je,ze,et=Ot(de),xt=Ae===0?fn:Gn,Gt=de.start,St=0;St<de.length-3;St+=3){var vn=de[St],X=de[St+1],ee=de[St+2],Te=de[St+3],me=de[St+4],At=Ae===0?vn:X,yt=Ae===0?Te:me,Nt=!1;Ze&&(Je=Math.sqrt(Math.pow(vn-Te,2)+Math.pow(X-me,2))),At<J?yt>J&&(ze=xt(et,vn,X,Te,me,J),Ze&&(et.start=Gt+Je*ze)):At>ce?yt<ce&&(ze=xt(et,vn,X,Te,me,ce),Ze&&(et.start=Gt+Je*ze)):Ln(et,vn,X,ee),yt<J&&At>=J&&(ze=xt(et,vn,X,Te,me,J),Nt=!0),yt>ce&&At<=ce&&(ze=xt(et,vn,X,Te,me,ce),Nt=!0),!Fe&&Nt&&(Ze&&(et.end=Gt+Je*ze),q.push(et),et=Ot(de)),Ze&&(Gt+=Je)}var rn=de.length-3;vn=de[rn],X=de[rn+1],ee=de[rn+2],(At=Ae===0?vn:X)>=J&&At<=ce&&Ln(et,vn,X,ee),rn=et.length-3,Fe&&rn>=3&&(et[rn]!==et[0]||et[rn+1]!==et[1])&&Ln(et,et[0],et[1],et[2]),et.length&&q.push(et)}function Ot(de){var q=[];return q.size=de.size,q.start=de.start,q.end=de.end,q}function en(de,q,J,ce,Ae,Fe){for(var Ze=0;Ze<de.length;Ze++)Ve(de[Ze],q,J,ce,Ae,Fe,!1)}function Ln(de,q,J,ce){de.push(q),de.push(J),de.push(ce)}function fn(de,q,J,ce,Ae,Fe){var Ze=(Fe-q)/(ce-q);return de.push(Fe),de.push(J+(Ae-J)*Ze),de.push(1),Ze}function Gn(de,q,J,ce,Ae,Fe){var Ze=(Fe-J)/(Ae-J);return de.push(q+(ce-q)*Ze),de.push(Fe),de.push(1),Ze}function qn(de,q){for(var J=[],ce=0;ce<de.length;ce++){var Ae,Fe=de[ce],Ze=Fe.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")Ae=Jn(Fe.geometry,q);else if(Ze==="MultiLineString"||Ze==="Polygon"){Ae=[];for(var Je=0;Je<Fe.geometry.length;Je++)Ae.push(Jn(Fe.geometry[Je],q))}else if(Ze==="MultiPolygon")for(Ae=[],Je=0;Je<Fe.geometry.length;Je++){for(var ze=[],et=0;et<Fe.geometry[Je].length;et++)ze.push(Jn(Fe.geometry[Je][et],q));Ae.push(ze)}J.push(wt(Fe.id,Ze,Ae,Fe.tags))}return J}function Jn(de,q){var J=[];J.size=de.size,de.start!==void 0&&(J.start=de.start,J.end=de.end);for(var ce=0;ce<de.length;ce+=3)J.push(de[ce]+q,de[ce+1],de[ce+2]);return J}function Ji(de,q){if(de.transformed)return de;var J,ce,Ae,Fe=1<<de.z,Ze=de.x,Je=de.y;for(J=0;J<de.features.length;J++){var ze=de.features[J],et=ze.geometry,xt=ze.type;if(ze.geometry=[],xt===1)for(ce=0;ce<et.length;ce+=2)ze.geometry.push(jn(et[ce],et[ce+1],q,Fe,Ze,Je));else for(ce=0;ce<et.length;ce++){var Gt=[];for(Ae=0;Ae<et[ce].length;Ae+=2)Gt.push(jn(et[ce][Ae],et[ce][Ae+1],q,Fe,Ze,Je));ze.geometry.push(Gt)}}return de.transformed=!0,de}function jn(de,q,J,ce,Ae,Fe){return[Math.round(J*(de*ce-Ae)),Math.round(J*(q*ce-Fe))]}function ki(de,q,J,ce,Ae){for(var Fe=q===Ae.maxZoom?0:Ae.tolerance/((1<<q)*Ae.extent),Ze={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:J,y:ce,z:q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Je=0;Je<de.length;Je++){Ze.numFeatures++,oi(Ze,de[Je],Fe,Ae);var ze=de[Je].minX,et=de[Je].minY,xt=de[Je].maxX,Gt=de[Je].maxY;ze<Ze.minX&&(Ze.minX=ze),et<Ze.minY&&(Ze.minY=et),xt>Ze.maxX&&(Ze.maxX=xt),Gt>Ze.maxY&&(Ze.maxY=Gt)}return Ze}function oi(de,q,J,ce){var Ae=q.geometry,Fe=q.type,Ze=[];if(Fe==="Point"||Fe==="MultiPoint")for(var Je=0;Je<Ae.length;Je+=3)Ze.push(Ae[Je]),Ze.push(Ae[Je+1]),de.numPoints++,de.numSimplified++;else if(Fe==="LineString")or(Ze,Ae,de,J,!1,!1);else if(Fe==="MultiLineString"||Fe==="Polygon")for(Je=0;Je<Ae.length;Je++)or(Ze,Ae[Je],de,J,Fe==="Polygon",Je===0);else if(Fe==="MultiPolygon")for(var ze=0;ze<Ae.length;ze++){var et=Ae[ze];for(Je=0;Je<et.length;Je++)or(Ze,et[Je],de,J,!0,Je===0)}if(Ze.length){var xt=q.tags||null;if(Fe==="LineString"&&ce.lineMetrics){for(var Gt in xt={},q.tags)xt[Gt]=q.tags[Gt];xt.mapbox_clip_start=Ae.start/Ae.size,xt.mapbox_clip_end=Ae.end/Ae.size}var St={geometry:Ze,type:Fe==="Polygon"||Fe==="MultiPolygon"?3:Fe==="LineString"||Fe==="MultiLineString"?2:1,tags:xt};q.id!==null&&(St.id=q.id),de.features.push(St)}}function or(de,q,J,ce,Ae,Fe){var Ze=ce*ce;if(ce>0&&q.size<(Ae?Ze:ce))J.numPoints+=q.length/3;else{for(var Je=[],ze=0;ze<q.length;ze+=3)(ce===0||q[ze+2]>Ze)&&(J.numSimplified++,Je.push(q[ze]),Je.push(q[ze+1])),J.numPoints++;Ae&&function(et,xt){for(var Gt=0,St=0,vn=et.length,X=vn-2;St<vn;X=St,St+=2)Gt+=(et[St]-et[X])*(et[St+1]+et[X+1]);if(Gt>0===xt)for(St=0,vn=et.length;St<vn/2;St+=2){var ee=et[St],Te=et[St+1];et[St]=et[vn-2-St],et[St+1]=et[vn-1-St],et[vn-2-St]=ee,et[vn-1-St]=Te}}(Je,Fe),de.push(Je)}}function Mi(de,q){var J=(q=this.options=function(Ae,Fe){for(var Ze in Fe)Ae[Ze]=Fe[Ze];return Ae}(Object.create(this.options),q)).debug;if(J&&console.time("preprocess data"),q.maxZoom<0||q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(q.promoteId&&q.generateId)throw new Error("promoteId and generateId cannot be used together.");var ce=function(Ae,Fe){var Ze=[];if(Ae.type==="FeatureCollection")for(var Je=0;Je<Ae.features.length;Je++)xn(Ze,Ae.features[Je],Fe,Je);else xn(Ze,Ae.type==="Feature"?Ae:{geometry:Ae},Fe);return Ze}(de,q);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",q.indexMaxZoom,q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ce=function(Ae,Fe){var Ze=Fe.buffer/Fe.extent,Je=Ae,ze=ln(Ae,1,-1-Ze,Ze,0,-1,2,Fe),et=ln(Ae,1,1-Ze,2+Ze,0,-1,2,Fe);return(ze||et)&&(Je=ln(Ae,1,-Ze,1+Ze,0,-1,2,Fe)||[],ze&&(Je=qn(ze,1).concat(Je)),et&&(Je=Je.concat(qn(et,-1)))),Je}(ce,q)).length&&this.splitTile(ce,0,0,0),J&&(ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Zr(de,q,J){return 32*((1<<de)*J+q)+de}function Gi(de,q){const J=de.tileID.canonical;if(!this._geoJSONIndex)return q(null,null);const ce=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!ce)return q(null,null);const Ae=new O(ce.features);let Fe=oe(Ae);Fe.byteOffset===0&&Fe.byteLength===Fe.buffer.byteLength||(Fe=new Uint8Array(Fe)),q(null,{vectorTile:Ae,rawData:Fe.buffer})}Mi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Mi.prototype.splitTile=function(de,q,J,ce,Ae,Fe,Ze){for(var Je=[de,q,J,ce],ze=this.options,et=ze.debug;Je.length;){ce=Je.pop(),J=Je.pop(),q=Je.pop(),de=Je.pop();var xt=1<<q,Gt=Zr(q,J,ce),St=this.tiles[Gt];if(!St&&(et>1&&console.time("creation"),St=this.tiles[Gt]=ki(de,q,J,ce,ze),this.tileCoords.push({z:q,x:J,y:ce}),et)){et>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",q,J,ce,St.numFeatures,St.numPoints,St.numSimplified),console.timeEnd("creation"));var vn="z"+q;this.stats[vn]=(this.stats[vn]||0)+1,this.total++}if(St.source=de,Ae){if(q===ze.maxZoom||q===Ae)continue;var X=1<<Ae-q;if(J!==Math.floor(Fe/X)||ce!==Math.floor(Ze/X))continue}else if(q===ze.indexMaxZoom||St.numPoints<=ze.indexMaxPoints)continue;if(St.source=null,de.length!==0){et>1&&console.time("clipping");var ee,Te,me,At,yt,Nt,rn=.5*ze.buffer/ze.extent,Fn=.5-rn,kn=.5+rn,bt=1+rn;ee=Te=me=At=null,yt=ln(de,xt,J-rn,J+kn,0,St.minX,St.maxX,ze),Nt=ln(de,xt,J+Fn,J+bt,0,St.minX,St.maxX,ze),de=null,yt&&(ee=ln(yt,xt,ce-rn,ce+kn,1,St.minY,St.maxY,ze),Te=ln(yt,xt,ce+Fn,ce+bt,1,St.minY,St.maxY,ze),yt=null),Nt&&(me=ln(Nt,xt,ce-rn,ce+kn,1,St.minY,St.maxY,ze),At=ln(Nt,xt,ce+Fn,ce+bt,1,St.minY,St.maxY,ze),Nt=null),et>1&&console.timeEnd("clipping"),Je.push(ee||[],q+1,2*J,2*ce),Je.push(Te||[],q+1,2*J,2*ce+1),Je.push(me||[],q+1,2*J+1,2*ce),Je.push(At||[],q+1,2*J+1,2*ce+1)}}},Mi.prototype.getTile=function(de,q,J){var ce=this.options,Ae=ce.extent,Fe=ce.debug;if(de<0||de>24)return null;var Ze=1<<de,Je=Zr(de,q=(q%Ze+Ze)%Ze,J);if(this.tiles[Je])return Ji(this.tiles[Je],Ae);Fe>1&&console.log("drilling down to z%d-%d-%d",de,q,J);for(var ze,et=de,xt=q,Gt=J;!ze&&et>0;)et--,xt=Math.floor(xt/2),Gt=Math.floor(Gt/2),ze=this.tiles[Zr(et,xt,Gt)];return ze&&ze.source?(Fe>1&&console.log("found parent tile z%d-%d-%d",et,xt,Gt),Fe>1&&console.time("drilling down"),this.splitTile(ze.source,et,xt,Gt,de,q,J),Fe>1&&console.timeEnd("drilling down"),this.tiles[Je]?Ji(this.tiles[Je],Ae):null):null};class Jr extends r.VectorTileWorkerSource{constructor(q,J,ce,Ae,Fe){super(q,J,ce,Ae,Gi),Fe&&(this.loadGeoJSON=Fe)}loadData(q,J){const ce=q&&q.request,Ae=ce&&ce.collectResourceTiming;this.loadGeoJSON(q,(Fe,Ze)=>{if(Fe||!Ze)return J(Fe);if(typeof Ze!="object")return J(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`));{E(Ze,!0);try{if(q.filter){const ze=r.createExpression(q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map(xt=>`${xt.key}: ${xt.message}`).join(", "));Ze={type:"FeatureCollection",features:Ze.features.filter(xt=>ze.value.evaluate({zoom:0},xt))}}this._geoJSONIndex=q.cluster?new tt(function({superclusterOptions:ze,clusterProperties:et}){if(!et||!ze)return ze;const xt={},Gt={},St={accumulated:null,zoom:0},vn={properties:null},X=Object.keys(et);for(const ee of X){const[Te,me]=et[ee],At=r.createExpression(me),yt=r.createExpression(typeof Te=="string"?[Te,["accumulated"],["get",ee]]:Te);xt[ee]=At.value,Gt[ee]=yt.value}return ze.map=ee=>{vn.properties=ee;const Te={};for(const me of X)Te[me]=xt[me].evaluate(St,vn);return Te},ze.reduce=(ee,Te)=>{vn.properties=Te;for(const me of X)St.accumulated=ee[me],ee[me]=Gt[me].evaluate(St,vn)},ze}(q)).load(Ze.features):function(ze,et){return new Mi(ze,et)}(Ze,q.geojsonVtOptions)}catch(ze){return J(ze)}this.loaded={};const Je={};if(Ae){const ze=r.getPerformanceMeasurement(ce);ze&&(Je.resourceTiming={},Je.resourceTiming[q.source]=JSON.parse(JSON.stringify(ze)))}J(null,Je)}})}reloadTile(q,J){const ce=this.loaded;return ce&&ce[q.uid]?super.reloadTile(q,J):this.loadTile(q,J)}loadGeoJSON(q,J){if(q.request)r.getJSON(q.request,J);else{if(typeof q.data!="string")return J(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`));try{return J(null,JSON.parse(q.data))}catch(ce){return J(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(q,J){try{J(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(ce){J(ce)}}getClusterChildren(q,J){try{J(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(ce){J(ce)}}getClusterLeaves(q,J){try{J(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(ce){J(ce)}}}class Lr{constructor(q){this.self=q,this.actor=new r.Actor(q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.getProjection({name:"mercator"}),this.workerSourceTypes={vector:r.VectorTileWorkerSource,geojson:Jr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(J,ce)=>{if(this.workerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.workerSourceTypes[J]=ce},this.self.registerRTLTextPlugin=J=>{if(r.plugin.isParsed())throw new Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=J.applyArabicShaping,r.plugin.processBidirectionalText=J.processBidirectionalText,r.plugin.processStyledBidirectionalText=J.processStyledBidirectionalText}}clearCaches(q,J,ce){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q],ce()}checkIfReady(q,J,ce){ce()}setReferrer(q,J){this.referrer=J}spriteLoaded(q,J){this.isSpriteLoaded[q]=J;for(const ce in this.workerSources[q]){const Ae=this.workerSources[q][ce];for(const Fe in Ae)Ae[Fe]instanceof r.VectorTileWorkerSource&&(Ae[Fe].isSpriteLoaded=J,Ae[Fe].fire(new r.Event("isSpriteLoaded")))}}setImages(q,J,ce){this.availableImages[q]=J;for(const Ae in this.workerSources[q]){const Fe=this.workerSources[q][Ae];for(const Ze in Fe)Fe[Ze].availableImages=J}ce()}enableTerrain(q,J,ce){this.terrain=J,ce()}setProjection(q,J){this.projections[q]=r.getProjection(J)}setLayers(q,J,ce){this.getLayerIndex(q).replace(J),ce()}updateLayers(q,J,ce){this.getLayerIndex(q).update(J.layers,J.removedIds),ce()}loadTile(q,J,ce){const Ae=this.enableTerrain?r.extend({enableTerrain:this.terrain},J):J;Ae.projection=this.projections[q]||this.defaultProjection,this.getWorkerSource(q,J.type,J.source).loadTile(Ae,ce)}loadDEMTile(q,J,ce){const Ae=this.enableTerrain?r.extend({buildQuadTree:this.terrain},J):J;this.getDEMWorkerSource(q,J.source).loadTile(Ae,ce)}reloadTile(q,J,ce){const Ae=this.enableTerrain?r.extend({enableTerrain:this.terrain},J):J;Ae.projection=this.projections[q]||this.defaultProjection,this.getWorkerSource(q,J.type,J.source).reloadTile(Ae,ce)}abortTile(q,J,ce){this.getWorkerSource(q,J.type,J.source).abortTile(J,ce)}removeTile(q,J,ce){this.getWorkerSource(q,J.type,J.source).removeTile(J,ce)}removeSource(q,J,ce){if(!this.workerSources[q]||!this.workerSources[q][J.type]||!this.workerSources[q][J.type][J.source])return;const Ae=this.workerSources[q][J.type][J.source];delete this.workerSources[q][J.type][J.source],Ae.removeSource!==void 0?Ae.removeSource(J,ce):ce()}loadWorkerSource(q,J,ce){try{this.self.importScripts(J.url),ce()}catch(Ae){ce(Ae.toString())}}syncRTLPluginState(q,J,ce){try{r.plugin.setState(J);const Ae=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&Ae!=null){this.self.importScripts(Ae);const Fe=r.plugin.isParsed();ce(Fe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ae}`),Fe)}}catch(Ae){ce(Ae.toString())}}getAvailableImages(q){let J=this.availableImages[q];return J||(J=[]),J}getLayerIndex(q){let J=this.layerIndexes[q];return J||(J=this.layerIndexes[q]=new w),J}getWorkerSource(q,J,ce){return this.workerSources[q]||(this.workerSources[q]={}),this.workerSources[q][J]||(this.workerSources[q][J]={}),this.workerSources[q][J][ce]||(this.workerSources[q][J][ce]=new this.workerSourceTypes[J]({send:(Ae,Fe,Ze,Je,ze,et)=>{this.actor.send(Ae,Fe,Ze,q,ze,et)},scheduler:this.actor.scheduler},this.getLayerIndex(q),this.getAvailableImages(q),this.isSpriteLoaded[q])),this.workerSources[q][J][ce]}getDEMWorkerSource(q,J){return this.demWorkerSources[q]||(this.demWorkerSources[q]={}),this.demWorkerSources[q][J]||(this.demWorkerSources[q][J]=new b),this.demWorkerSources[q][J]}enforceCacheSizeLimit(q,J){r.enforceCacheSizeLimit(J)}getWorkerPerformanceMetrics(q,J,ce){ce(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Lr(self)),Lr}),h(["./shared"],function(r){var v=_;function _(m){return!function(o){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,M,S=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(S);try{M=new Worker(C),y=!0}catch(L){y=!1}return M&&M.terminate(),URL.revokeObjectURL(C),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var M=y.getContext("2d");if(!M)return!1;var S=M.getImageData(0,0,1,1);return S&&S.width===y.width}()?(w[d=o&&o.failIfMajorPerformanceCaveat]===void 0&&(w[d]=function(y){var M,S=function(C){var L=document.createElement("canvas"),U=Object.create(_.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=C,L.getContext("webgl",U)||L.getContext("experimental-webgl",U)}(y);if(!S)return!1;try{M=S.createShader(S.VERTEX_SHADER)}catch(C){return!1}return!(!M||S.isContextLost())&&(S.shaderSource(M,"void main() {}"),S.compileShader(M),S.getShaderParameter(M,S.COMPILE_STATUS)===!0)}(d)),w[d]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var d}(m)}var w={};function b(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let d=0;d<m.length;d++)if(!b(m[d],o[d]))return!1;return!0}if(typeof m=="object"&&m!==null&&o!==null){if(typeof o!="object"||Object.keys(m).length!==Object.keys(o).length)return!1;for(const d in m)if(!b(m[d],o[d]))return!1;return!0}return m===o}function E(m,o,d){const y=r.window.document.createElement(m);return o!==void 0&&(y.className=o),d&&d.appendChild(y),y}function P(m,o,d){const y=r.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const M of Object.keys(o))y.setAttributeNS(null,M,o[M]);return d&&d.appendChild(y),y}_.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const I=r.window.document&&r.window.document.documentElement.style,F=I&&I.userSelect!==void 0?"userSelect":"WebkitUserSelect";let B;function O(){I&&F&&(B=I[F],I[F]="none")}function W(){I&&F&&(I[F]=B)}function Z(m){m.preventDefault(),m.stopPropagation(),r.window.removeEventListener("click",Z,!0)}function ie(){r.window.addEventListener("click",Z,!0),r.window.setTimeout(()=>{r.window.removeEventListener("click",Z,!0)},0)}function $(m,o){const d=m.getBoundingClientRect();return fe(m,d,o)}function oe(m,o){const d=m.getBoundingClientRect(),y=[];for(let M=0;M<o.length;M++)y.push(fe(m,d,o[M]));return y}function be(m){return r.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function fe(m,o,d){const y=m.offsetWidth===o.width?1:m.offsetWidth/o.width;return new r.pointGeometry((d.clientX-o.left)*y,(d.clientY-o.top)*y)}function Le(m,o){var d=o[0],y=o[1],M=o[2],S=o[3],C=d*S-M*y;return C?(m[0]=S*(C=1/C),m[1]=-y*C,m[2]=-M*C,m[3]=d*C,m):null}function Xe(m){const{userImage:o}=m;return!!(o&&o.render&&o.render())&&(m.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ne extends r.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:y}of this.requestors)this._notify(d,y);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,d){this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let y=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new r.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new r.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new r.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),y=!1),y}_validateStretch(o,d){if(!o)return!0;let y=0;for(const M of o){if(M[0]<y||M[1]<M[0]||d<M[1])return!1;y=M[1]}return!0}_validateContent(o,d){return!(o&&(o.length!==4||o[0]<0||d.data.width<o[0]||o[1]<0||d.data.height<o[1]||o[2]<0||d.data.width<o[2]||o[3]<0||d.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,d){d.version=this.images[o].version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let y=!0;if(!this.isLoaded())for(const M of o)this.images[M]||(y=!1);this.isLoaded()||y?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const y={};for(const M of o){this.images[M]||this.fire(new r.Event("styleimagemissing",{id:M}));const S=this.images[M];S?y[M]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:r.warnOnce(`Image "${M}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,y)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],y=this.getImage(o);if(!y)return null;if(d&&d.position.version===y.version)return d.position;if(d)d.position.version=y.version;else{const M={w:y.data.width+2,h:y.data.height+2,x:0,y:0},S=new r.ImagePosition(M,y);this.patterns[o]={bin:M,position:S}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const S in this.patterns)o.push(this.patterns[S].bin);const{w:d,h:y}=r.potpack(o),M=this.atlasImage;M.resize({width:d||1,height:y||1});for(const S in this.patterns){const{bin:C}=this.patterns[S],L=C.x+1,U=C.y+1,G=this.images[S].data,j=G.width,Y=G.height;r.RGBAImage.copy(G,M,{x:0,y:0},{x:L,y:U},{width:j,height:Y}),r.RGBAImage.copy(G,M,{x:0,y:Y-1},{x:L,y:U-1},{width:j,height:1}),r.RGBAImage.copy(G,M,{x:0,y:0},{x:L,y:U+Y},{width:j,height:1}),r.RGBAImage.copy(G,M,{x:j-1,y:0},{x:L-1,y:U},{width:1,height:Y}),r.RGBAImage.copy(G,M,{x:0,y:0},{x:L+j,y:U},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const y=this.images[d];Xe(y)&&this.updateImage(d,y)}}}const Re=new r.Properties({anchor:new r.DataConstantProperty(r.spec.light.anchor),position:new class{constructor(){this.specification=r.spec.light.position}possiblyEvaluate(m,o){return function([d,y,M]){const S=r.degToRad(y+90),C=r.degToRad(M);return{x:d*Math.cos(S)*Math.sin(C),y:d*Math.sin(S)*Math.sin(C),z:d*Math.cos(C),azimuthal:y,polar:M}}(m.expression.evaluate(o))}interpolate(m,o,d){return{x:r.number(m.x,o.x,d),y:r.number(m.y,o.y,d),z:r.number(m.z,o.z,d),azimuthal:r.number(m.azimuthal,o.azimuthal,d),polar:r.number(m.polar,o.polar,d)}}},color:new r.DataConstantProperty(r.spec.light.color),intensity:new r.DataConstantProperty(r.spec.light.intensity)}),Ie="-transition";class He extends r.Evented{constructor(o){super(),this._transitionable=new r.Transitionable(Re),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(r.validateLight,o,d))for(const y in o){const M=o[y];r.endsWith(y,Ie)?this._transitionable.setTransition(y.slice(0,-Ie.length),M):this._transitionable.setValue(y,M)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,y){return(!y||y.validate!==!1)&&r.emitValidationErrors(this,o.call(r.validateStyle,r.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}const Ue=new r.Properties({source:new r.DataConstantProperty(r.spec.terrain.source),exaggeration:new r.DataConstantProperty(r.spec.terrain.exaggeration)}),ot="-transition";class Pt extends r.Evented{constructor(o,d){super(),this._transitionable=new r.Transitionable(Ue),this.set(o),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(o){for(const d in o){const y=o[d];r.endsWith(d,ot)?this._transitionable.setTransition(d.slice(0,-ot.length),y):this._transitionable.setValue(d,y)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}}function mt(m,o,d,y){const M=r.smoothstep(45,65,d),[S,C]=_t(m,y),L=r.length(o);let U=1-Math.min(1,Math.exp((L-S)/(C-S)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*M*m.alpha}function _t(m,o){const d=.5/Math.tan(.5*o);return[m.range[0]+d,m.range[1]+d]}const ft=new r.Properties({range:new r.DataConstantProperty(r.spec.fog.range),color:new r.DataConstantProperty(r.spec.fog.color),"horizon-blend":new r.DataConstantProperty(r.spec.fog["horizon-blend"])}),Vt="-transition";class we extends r.Evented{constructor(o,d){super(),this._transitionable=new r.Transitionable(ft),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=d}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,d={}){if(!this._validate(r.validateFog,o,d))for(const y in o){const M=o[y];r.endsWith(y,Vt)?this._transitionable.setTransition(y.slice(0,-Vt.length),M):this._transitionable.setValue(y,M)}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return r.smoothstep(45,65,o)*d.a}getOpacityAtLatLng(o,d){return this._transform.projection.supportsFog?function(y,M,S){const C=r.MercatorCoordinate.fromLngLat(M),L=S.elevation?S.elevation.getAtPointOrZero(C):0,U=[C.x,C.y,L];return r.transformMat4(U,U,S.mercatorFogMatrix),mt(y,U,S.pitch,S._fov)}(this.state,o,d):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?_t(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,y){return(!y||y.validate!==!1)&&r.emitValidationErrors(this,o.call(r.validateStyle,r.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}class pe{constructor(o,d){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=r.uniqueId();const y=this.workerPool.acquire(this.id);for(let M=0;M<y.length;M++){const S=new pe.Actor(y[M],d,this.id);S.name=`Worker ${M}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,d,y){r.asyncAll(this.actors,(M,S)=>{M.send(o,d,S)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ke(m,o,d){return o*(r.EXTENT/(m.tileSize*Math.pow(2,d-m.tileID.overscaledZ)))}pe.Actor=r.Actor;class De{constructor(o,d,y,M){this.screenBounds=o,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(S=>M.pointCoordinate3D(S)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(o,d){let y,M;if(o instanceof r.pointGeometry||typeof o[0]=="number"){const S=r.pointGeometry.convert(o);y=[r.pointGeometry.convert(o)],M=d.isPointAboveHorizon(S)}else{const S=r.pointGeometry.convert(o[0]),C=r.pointGeometry.convert(o[1]);y=[S,C],M=r.polygonizeBounds(S,C).every(L=>d.isPointAboveHorizon(L))}return new De(y,d.getCameraPoint(),M,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return r.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new r.pointGeometry(1,1)):this.screenBounds[1],M=r.polygonizeBounds(d,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<y.x?M.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?M[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(M[3]=this.cameraPoint)),r.bufferConvexPolygon(M,o)}containsTile(o,d,y){const M=o.queryPadding+1,S=o.tileID.wrap,C=y?this._bufferedCameraMercator(M,d).map(re=>r.getTilePoint(o.tileTransform,re,S)):this._bufferedScreenMercator(M,d).map(re=>r.getTilePoint(o.tileTransform,re,S)),L=this.screenGeometryMercator.map(re=>r.getTileVec3(o.tileTransform,re,S)),U=L.map(re=>new r.pointGeometry(re[0],re[1])),G=d.getFreeCameraOptions().position||new r.MercatorCoordinate(0,0,0),j=r.getTileVec3(o.tileTransform,G,S),Y=L.map(re=>{const Q=r.sub(re,re,j);return r.normalize(Q,Q),new r.Ray(j,Q)}),ne=ke(o,1,d.zoom);if(r.polygonIntersectsBox(C,0,0,r.EXTENT,r.EXTENT))return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:Y,bufferedTilespaceGeometry:C,bufferedTilespaceBounds:(se=r.getBounds(C),se.min.x=r.clamp(se.min.x,0,r.EXTENT),se.min.y=r.clamp(se.min.y,0,r.EXTENT),se.max.x=r.clamp(se.max.x,0,r.EXTENT),se.max.y=r.clamp(se.max.y,0,r.EXTENT),se),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ne};var se}_bufferedScreenMercator(o,d){const y=Se(o);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{const M=this.bufferedScreenGeometry(o).map(S=>d.pointCoordinate3D(S));return this._screenRaycastCache[y]=M,M}}_bufferedCameraMercator(o,d){const y=Se(o);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{const M=this.bufferedCameraGeometry(o).map(S=>d.pointCoordinate3D(S));return this._cameraRaycastCache[y]=M,M}}}function Se(m){return 100*m|0}function tt(m,o,d){const y=function(M,S){if(M)return d(M);if(S){const C=r.pick(r.extend(S,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);S.vector_layers&&(C.vectorLayers=S.vector_layers,C.vectorLayerIds=C.vectorLayers.map(L=>L.id)),C.tiles=o.canonicalizeTileset(C,m.url),d(null,C)}};return m.url?r.getJSON(o.transformRequest(o.normalizeSourceURL(m.url),r.ResourceType.Source),y):r.exported.frame(()=>y(null,m))}class Ge{constructor(o,d,y){this.bounds=r.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),y=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*d),M=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*d),S=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*d),C=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*d);return o.x>=y&&o.x<S&&o.y>=M&&o.y<C}}class We{constructor(o,d,y){this.context=o;const M=o.gl;this.buffer=M.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const nt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class je{constructor(o,d,y,M){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=M,this.context=o;const S=o.gl;this.buffer=S.createBuffer(),o.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let y=0;y<this.attributes.length;y++){const M=d.attributes[this.attributes[y].name];M!==void 0&&o.enableVertexAttribArray(M)}}setVertexAttribPointers(o,d,y){for(let M=0;M<this.attributes.length;M++){const S=this.attributes[M],C=d.attributes[S.name];C!==void 0&&o.vertexAttribPointer(C,S.components,o[nt[S.type]],!1,this.itemSize,S.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class lt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class gt extends lt{getDefault(){return r.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Lt extends lt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class sn extends lt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class An extends lt{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class le extends lt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Ee extends lt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Et extends lt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class wt extends lt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Mn extends lt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class xn extends lt{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class un extends lt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class bn extends lt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Tn extends lt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class hn extends lt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class jt extends lt{getDefault(){return r.Color.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ln extends lt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Xt extends lt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Ve extends lt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Ot extends lt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class en extends lt{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Ln extends lt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class fn extends lt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Gn extends lt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class qn extends lt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Jn extends lt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Ji extends lt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class jn extends lt{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ki extends lt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class oi extends lt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class or extends lt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Mi extends lt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Zr extends lt{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Gi extends Zr{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Jr extends Zr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Lr extends Jr{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class de{constructor(o,d,y,M){this.context=o,this.width=d,this.height=y;const S=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Gi(o,S),M&&(this.depthAttachment=new Jr(o,S))}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const y=this.depthAttachment.get();y&&o.deleteRenderbuffer(y)}o.deleteFramebuffer(this.framebuffer)}}class q{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new gt(this),this.clearDepth=new Lt(this),this.clearStencil=new sn(this),this.colorMask=new An(this),this.depthMask=new le(this),this.stencilMask=new Ee(this),this.stencilFunc=new Et(this),this.stencilOp=new wt(this),this.stencilTest=new Mn(this),this.depthRange=new xn(this),this.depthTest=new un(this),this.depthFunc=new bn(this),this.blend=new Tn(this),this.blendFunc=new hn(this),this.blendColor=new jt(this),this.blendEquation=new ln(this),this.cullFace=new Xt(this),this.cullFaceSide=new Ve(this),this.frontFace=new Ot(this),this.program=new en(this),this.activeTexture=new Ln(this),this.viewport=new fn(this),this.bindFramebuffer=new Gn(this),this.bindRenderbuffer=new qn(this),this.bindTexture=new Jn(this),this.bindVertexBuffer=new Ji(this),this.bindElementBuffer=new jn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ki(this),this.pixelStoreUnpack=new oi(this),this.pixelStoreUnpackPremultiplyAlpha=new or(this),this.pixelStoreUnpackFlipY=new Mi(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new We(this,o,d)}createVertexBuffer(o,d,y){return new je(this,o,d,y)}createRenderbuffer(o,d,y){const M=this.gl,S=M.createRenderbuffer();return this.bindRenderbuffer.set(S),M.renderbufferStorage(M.RENDERBUFFER,o,d,y),this.bindRenderbuffer.set(null),S}createFramebuffer(o,d,y){return new de(this,o,d,y)}clear({color:o,depth:d,stencil:y}){const M=this.gl;let S=0;o&&(S|=M.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(S|=M.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),y!==void 0&&(S|=M.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),M.clear(S)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){b(o.blendFunction,r.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class J extends r.Evented{constructor(o,d,y,M){super(),this.id=o,this.dispatcher=y,this.setEventedParent(M),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},d),r.extend(this,r.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,(o,d)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new r.ErrorEvent(o)):d&&(r.extend(this,d),d.bounds&&(this.tileBounds=new Ge(d.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(d.tiles),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return r.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const y=r.exported.devicePixelRatio>=2,M=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);o.request=r.getImage(this.map._requestManager.transformRequest(M,r.ResourceType.Tile),(S,C,L,U)=>(delete o.request,o.aborted?(o.state="unloaded",d(null)):S?(o.state="errored",d(S)):C?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:L,expires:U}),o.setTexture(C,this.map.painter),o.state="loaded",r.cacheEntryPossiblyAdded(this.dispatcher),void d(null)):d(null)))}static loadTileData(o,d,y){o.setTexture(d,y)}static unloadTileData(o,d){o.texture&&d.saveTileTexture(o.texture)}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}}let ce;function Ae(m,o,d,y,M,S,C,L){const U=[m,d,M,o,y,S,1,1,1],G=[C,L,1],j=r.adjoint([],U),[Y,ne,se]=r.transformMat3(G,G,r.transpose(j,j));return r.multiply(U,[Y,0,0,0,ne,0,0,0,se],U)}class Fe extends r.Evented{constructor(o,d,y,M){super(),this.id=o,this.dispatcher=y,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(M),this.options=d}load(o){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),(d,y)=>{if(this._loaded=!0,d)this.fire(new r.ErrorEvent(d));else if(y){const{HTMLImageElement:M}=r.window;this.image=y instanceof M?r.exported.getImageData(y):y,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const d=o.map(r.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let M=1/0,S=1/0,C=-1/0,L=-1/0;for(const Y of y)M=Math.min(M,Y.x),S=Math.min(S,Y.y),C=Math.max(C,Y.x),L=Math.max(L,Y.y);const U=Math.max(C-M,L-S),G=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),j=Math.pow(2,G);return new r.CanonicalTileID(G,Math.floor((M+C)/2*j),Math.floor((S+L)/2*j))}(d),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const U in this.tiles){const G=this.tiles[U];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const d=r.tileTransform(this.tileID,this.map.transform.projection),[y,M,S,C]=this.coordinates.map(U=>{const G=d.projection.project(U[0],U[1]);return r.getTilePoint(d,G)._round()});this.perspectiveTransform=function(U,G,j,Y,ne,se,re,Q,_e,ue){const ye=Ae(0,0,U,0,0,G,U,G),ve=Ae(j,Y,ne,se,re,Q,_e,ue);return r.multiply(ve,r.adjoint(ye,ye),ve),[ve[6]/ve[8]*U/r.EXTENT,ve[7]/ve[8]*G/r.EXTENT]}(this.width,this.height,y.x,y.y,M.x,M.y,C.x,C.y,S.x,S.y);const L=this._boundsArray=new r.StructArrayLayout4i8;L.emplaceBack(y.x,y.y,0,0),L.emplaceBack(M.x,M.y,r.EXTENT,0),L.emplaceBack(C.x,C.y,0,r.EXTENT),L.emplaceBack(S.x,S.y,r.EXTENT,r.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(L,r.boundsAttributes.members),this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,d=o.gl;this.texture?this.texture.update(this.image):(this.texture=new r.Texture(o,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._prepareData(o)}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ze={vector:class extends r.Evented{constructor(m,o,d,y){if(super(),this.id=m,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(o,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new r.DedupedRequest}load(){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=tt(this._options,this.map._requestManager,(m,o)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new r.ErrorEvent(m)):o&&(r.extend(this,o),o.bounds&&(this.tileBounds=new Ge(o.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(o.tiles,this.map._requestManager._customAccessToken),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}onAdd(m){this.map=m,this.load()}setSourceProperty(m){this._tileJSONRequest&&this._tileJSONRequest.cancel(),m();const o=this.map.style._getSourceCaches(this.id);for(const d of o)d.clearTiles();this.load()}setTiles(m){return this.setSourceProperty(()=>{this._options.tiles=m}),this}setUrl(m){return this.setSourceProperty(()=>{this.url=m,this._options.url=m}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return r.extend({},this._options)}loadTile(m,o){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(d,r.ResourceType.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:m.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,m.actor&&m.state!=="expired")m.state==="loading"?m.reloadCallback=o:m.request=m.actor.send("reloadTile",y,M.bind(this));else if(m.actor=this._tileWorkers[d]=this._tileWorkers[d]||this.dispatcher.getActor(),this.dispatcher.ready)m.request=m.actor.send("loadTile",y,M.bind(this),void 0,!0);else{const S=r.loadVectorTile.call({deduped:this._deduped},y,(C,L)=>{C||!L?M.call(this,C):(y.data={cacheControl:L.cacheControl,expires:L.expires,rawData:L.rawData.slice(0)},m.actor&&m.actor.send("loadTile",y,M.bind(this),void 0,!0))},!0);m.request={cancel:S}}function M(S,C){return delete m.request,m.aborted?o(null):S&&S.status!==404?o(S):(C&&C.resourceTiming&&(m.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&m.setExpiryData(C),m.loadVectorData(C,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(m.reloadCallback&&(this.loadTile(m,m.reloadCallback),m.reloadCallback=null)))}}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.actor&&m.actor.send("abortTile",{uid:m.uid,type:this.type,source:this.id})}unloadTile(m){m.unloadVectorData(),m.actor&&m.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:J,"raster-dem":class extends J{constructor(m,o,d,y){super(m,o,d,y),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(m,o){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(M,S){M&&(m.state="errored",o(M)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",o(null))}m.request=r.getImage(this.map._requestManager.transformRequest(d,r.ResourceType.Tile),function(M,S,C,L){if(delete m.request,m.aborted)m.state="unloaded",o(null);else if(M)m.state="errored",o(M);else if(S){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:C,expires:L});const U=r.window.ImageBitmap&&S instanceof r.window.ImageBitmap&&(ce==null&&(ce=r.window.OffscreenCanvas&&new r.window.OffscreenCanvas(1,1).getContext("2d")&&typeof r.window.createImageBitmap=="function"),ce),G=1-(S.width-r.prevPowerOfTwo(S.width))/2;G<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const j=U?S:r.exported.getImageData(S,G),Y={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:j,encoding:this.encoding,padding:G};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",Y,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const o=m.canonical,d=Math.pow(2,o.z),y=(o.x-1+d)%d,M=o.x===0?m.wrap-1:m.wrap,S=(o.x+1+d)%d,C=o.x+1===d?m.wrap+1:m.wrap,L={};return L[new r.OverscaledTileID(m.overscaledZ,M,o.z,y,o.y).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,C,o.z,S,o.y).key]={backfilled:!1},o.y>0&&(L[new r.OverscaledTileID(m.overscaledZ,M,o.z,y,o.y-1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,C,o.z,S,o.y-1).key]={backfilled:!1}),o.y+1<d&&(L[new r.OverscaledTileID(m.overscaledZ,M,o.z,y,o.y+1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},L[new r.OverscaledTileID(m.overscaledZ,C,o.z,S,o.y+1).key]={backfilled:!1}),L}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends r.Evented{constructor(m,o,d,y){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(y),this._data=o.data,this._options=r.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const M=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*M,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*M,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:r.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*M,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},o),this}getClusterChildren(m,o){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},o),this}getClusterLeaves(m,o,d,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:o,offset:d},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=r.extend({},this.workerOptions),o=this._data;typeof o=="string"?(m.request=this.map._requestManager.transformRequest(r.exported.resolveURL(o),r.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(d,y)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new r.ErrorEvent(d));else{const M={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(M.resourceTiming=y.resourceTiming[this.id]),this.fire(new r.Event("data",M)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,o){const d=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(d,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,M)=>(delete m.request,m.unloadVectorData(),m.aborted?o(null):y?o(y):(m.loadVectorData(M,this.map.painter,d==="reloadTile"),o(null))),void 0,d==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Fe{constructor(m,o,d,y){super(m,o,d,y),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const o of m.urls)this.urls.push(this.map._requestManager.transformRequest(o,r.ResourceType.Source).url);r.getVideo(this.urls,(o,d)=>{this._loaded=!0,o?this.fire(new r.ErrorEvent(o)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const o=this.video.seekable;m<o.start(0)||m>o.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,o=m.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(m,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Fe,canvas:class extends Fe{constructor(m,o,d,y){super(m,o,d,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(M=>!Array.isArray(M)||M.length!==2||M.some(S=>typeof S!="number"))||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends r.Evented{constructor(m,o,d,y){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=o,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ge(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.coveringTiles=this._coveringTiles.bind(this),r.extend(this,r.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:o,y:d,z:y}=m.canonical;return this._implementation.hasTile({x:o,y:d,z:y})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,o){const{x:d,y,z:M}=m.tileID.canonical,S=new r.window.AbortController,C=this._implementation.loadTile({x:d,y,z:M},{signal:S.signal});if(!C)return this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",o(null);C.cancel=()=>S.abort(),m.request=C.then(function(L){return delete m.request,m.aborted?(m.state="unloaded",o(null)):L?function(U){return U instanceof r.window.ImageData||U instanceof r.window.ImageBitmap||U instanceof r.window.HTMLCanvasElement}(L)?(this.loadTileData(m,L),m.state="loaded",void o(null)):(m.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",o(null))}.bind(this)).catch(L=>{L.code!==20&&(m.state="errored",o(L))})}loadTileData(m,o){J.loadTileData(m,o,this._map.painter)}unloadTileData(m){J.unloadTileData(m,this._map.painter)}prepareTile(m){if(!this._implementation.prepareTile)return null;const{x:o,y:d,z:y}=m.tileID.canonical,M=this._implementation.prepareTile({x:o,y:d,z:y});return M?(this.loadTileData(m,M),m.state="loaded",M):null}unloadTile(m,o){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:d,y,z:M}=m.tileID.canonical;this._implementation.unloadTile({x:d,y,z:M})}o()}abortTile(m,o){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_update(){this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Je=function(m,o,d,y){const M=new Ze[o.type](m,o,d,y);if(M.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${M.id}`);return r.bindAll(["load","abort","unload","serialize","prepare"],M),M};function ze(m,o){const d=r.identity([]);return r.scale(d,d,[.5*m.width,.5*-m.height,1]),r.translate(d,d,[1,-1,0]),r.multiply$1(d,d,m.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(d)}function et(m,o,d,y,M,S,C,L=!1){const U=m.tilesIn(y,C,L);U.sort(Gt);const G=[];for(const Y of U)G.push({wrappedTileID:Y.tile.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(o,d,m._state,Y,M,S,ze(m.transform,Y.tile.tileID),L)});const j=function(Y){const ne={},se={};for(const re of Y){const Q=re.queryResults,_e=re.wrappedTileID,ue=se[_e]=se[_e]||{};for(const ye in Q){const ve=Q[ye],Me=ue[ye]=ue[ye]||{},ge=ne[ye]=ne[ye]||[];for(const Ce of ve)Me[Ce.featureIndex]||(Me[Ce.featureIndex]=!0,ge.push(Ce))}}return ne}(G);for(const Y in j)j[Y].forEach(ne=>{const se=ne.feature,re=se.layer;re&&re.type!=="background"&&re.type!=="sky"&&(se.source=re.source,re["source-layer"]&&(se.sourceLayer=re["source-layer"]),se.state=se.id!==void 0?m.getFeatureState(re["source-layer"],se.id):{})});return j}function xt(m,o){const d=m.getRenderableIds().map(S=>m.getTileByID(S)),y=[],M={};for(let S=0;S<d.length;S++){const C=d[S],L=C.tileID.canonical.key;M[L]||(M[L]=!0,C.querySourceFeatures(y,o))}return y}function Gt(m,o){const d=m.tileID,y=o.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}function St(){return Xs.workerClass!=null?new Xs.workerClass:new r.window.Worker(Xs.workerUrl)}const vn="mapboxgl_preloaded_worker_pool";class X{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<X.workerCount;)this.workers.push(new St);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[vn]}numActive(){return Object.keys(this.active).length}}let ee;function Te(){return ee||(ee=new X),ee}function me(m,o){const d={};for(const y in m)y!=="ref"&&(d[y]=m[y]);return r.refProperties.forEach(y=>{y in o&&(d[y]=o[y])}),d}function At(m){m=m.slice();const o=Object.create(null);for(let d=0;d<m.length;d++)o[m[d].id]=m[d];for(let d=0;d<m.length;d++)"ref"in m[d]&&(m[d]=me(m[d],o[m[d].ref]));return m}X.workerCount=2;const yt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Nt(m,o,d){d.push({command:yt.addSource,args:[m,o[m]]})}function rn(m,o,d){o.push({command:yt.removeSource,args:[m]}),d[m]=!0}function Fn(m,o,d,y){rn(m,d,y),Nt(m,o,d)}function kn(m,o,d){let y;for(y in m[d])if(m[d].hasOwnProperty(y)&&y!=="data"&&!b(m[d][y],o[d][y]))return!1;for(y in o[d])if(o[d].hasOwnProperty(y)&&y!=="data"&&!b(m[d][y],o[d][y]))return!1;return!0}function bt(m,o,d,y,M,S){let C;for(C in o=o||{},m=m||{})m.hasOwnProperty(C)&&(b(m[C],o[C])||d.push({command:S,args:[y,C,o[C],M]}));for(C in o)o.hasOwnProperty(C)&&!m.hasOwnProperty(C)&&(b(m[C],o[C])||d.push({command:S,args:[y,C,o[C],M]}))}function dn(m){return m.id}function Jt(m,o){return m[o.id]=o,m}class mn{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=r.clamp(o,0,1);let d=1,y=this._distances[d];const M=o*this.paddedLength+this.padding;for(;y<M&&d<this._distances.length;)y=this._distances[++d];const S=d-1,C=this._distances[S],L=y-C,U=L>0?(M-C)/L:0;return this.points[S].mult(1-U).add(this.points[d].mult(U))}}class En{constructor(o,d,y){const M=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(o/y),this.yCellCount=Math.ceil(d/y);for(let C=0;C<this.xCellCount*this.yCellCount;C++)M.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,y,M,S){this._forEachCell(d,y,M,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(M),this.bboxes.push(S)}insertCircle(o,d,y,M){this._forEachCell(d-M,y-M,d+M,y+M,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(y),this.circles.push(M)}_insertBoxCell(o,d,y,M,S,C){this.boxCells[S].push(C)}_insertCircleCell(o,d,y,M,S,C){this.circleCells[S].push(C)}_query(o,d,y,M,S,C){if(y<0||o>this.width||M<0||d>this.height)return!S&&[];const L=[];if(o<=0&&d<=0&&this.width<=y&&this.height<=M){if(S)return!0;for(let U=0;U<this.boxKeys.length;U++)L.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const G=this.circles[3*U],j=this.circles[3*U+1],Y=this.circles[3*U+2];L.push({key:this.circleKeys[U],x1:G-Y,y1:j-Y,x2:G+Y,y2:j+Y})}return C?L.filter(C):L}return this._forEachCell(o,d,y,M,this._queryCell,L,{hitTest:S,seenUids:{box:{},circle:{}}},C),S?L.length>0:L}_queryCircle(o,d,y,M,S){const C=o-y,L=o+y,U=d-y,G=d+y;if(L<0||C>this.width||G<0||U>this.height)return!M&&[];const j=[];return this._forEachCell(C,U,L,G,this._queryCellCircle,j,{hitTest:M,circle:{x:o,y:d,radius:y},seenUids:{box:{},circle:{}}},S),M?j.length>0:j}query(o,d,y,M,S){return this._query(o,d,y,M,!1,S)}hitTest(o,d,y,M,S){return this._query(o,d,y,M,!0,S)}hitTestCircle(o,d,y,M){return this._queryCircle(o,d,y,!0,M)}_queryCell(o,d,y,M,S,C,L,U){const G=L.seenUids,j=this.boxCells[S];if(j!==null){const ne=this.bboxes;for(const se of j)if(!G.box[se]){G.box[se]=!0;const re=4*se;if(o<=ne[re+2]&&d<=ne[re+3]&&y>=ne[re+0]&&M>=ne[re+1]&&(!U||U(this.boxKeys[se]))){if(L.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[se],x1:ne[re],y1:ne[re+1],x2:ne[re+2],y2:ne[re+3]})}}}const Y=this.circleCells[S];if(Y!==null){const ne=this.circles;for(const se of Y)if(!G.circle[se]){G.circle[se]=!0;const re=3*se;if(this._circleAndRectCollide(ne[re],ne[re+1],ne[re+2],o,d,y,M)&&(!U||U(this.circleKeys[se]))){if(L.hitTest)return C.push(!0),!0;{const Q=ne[re],_e=ne[re+1],ue=ne[re+2];C.push({key:this.circleKeys[se],x1:Q-ue,y1:_e-ue,x2:Q+ue,y2:_e+ue})}}}}}_queryCellCircle(o,d,y,M,S,C,L,U){const G=L.circle,j=L.seenUids,Y=this.boxCells[S];if(Y!==null){const se=this.bboxes;for(const re of Y)if(!j.box[re]){j.box[re]=!0;const Q=4*re;if(this._circleAndRectCollide(G.x,G.y,G.radius,se[Q+0],se[Q+1],se[Q+2],se[Q+3])&&(!U||U(this.boxKeys[re])))return C.push(!0),!0}}const ne=this.circleCells[S];if(ne!==null){const se=this.circles;for(const re of ne)if(!j.circle[re]){j.circle[re]=!0;const Q=3*re;if(this._circlesCollide(se[Q],se[Q+1],se[Q+2],G.x,G.y,G.radius)&&(!U||U(this.circleKeys[re])))return C.push(!0),!0}}}_forEachCell(o,d,y,M,S,C,L,U){const G=this._convertToXCellCoord(o),j=this._convertToYCellCoord(d),Y=this._convertToXCellCoord(y),ne=this._convertToYCellCoord(M);for(let se=G;se<=Y;se++)for(let re=j;re<=ne;re++)if(S.call(this,o,d,y,M,this.xCellCount*re+se,C,L,U))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,y,M,S,C){const L=M-o,U=S-d,G=y+C;return G*G>L*L+U*U}_circleAndRectCollide(o,d,y,M,S,C,L){const U=(C-M)/2,G=Math.abs(o-(M+U));if(G>U+y)return!1;const j=(L-S)/2,Y=Math.abs(d-(S+j));if(Y>j+y)return!1;if(G<=U||Y<=j)return!0;const ne=G-U,se=Y-j;return ne*ne+se*se<=y*y}}const Rn=Math.tan(85*Math.PI/180);function xi(m,o,d,y,M,S){const C=r.create();if(d){if(M.projection.name==="globe")r.multiply$1(C,C,r.calculateGlobeLabelMatrix(M,o));else{const L=Le([],S);C[0]=L[0],C[1]=L[1],C[4]=L[2],C[5]=L[3]}y||r.rotateZ(C,C,M.angle)}else r.multiply$1(C,M.labelPlaneMatrix,m);return C}function Fr(m,o,d,y,M,S){if(d){if(M.projection.name==="globe"){const C=xi(m,o,d,y,M,S);return r.invert(C,C),r.multiply$1(C,m,C),C}{const C=r.clone(m),L=r.identity([]);return L[0]=S[0],L[1]=S[1],L[4]=S[2],L[5]=S[3],r.multiply$1(C,C,L),y||r.rotateZ(C,C,-M.angle),C}}return M.glCoordMatrix}function hi(m,o,d=0){const y=[m.x,m.y,d,1];d?r.transformMat4$1(y,y,o):kr(y,y,o);const M=y[3];return{point:new r.pointGeometry(y[0]/M,y[1]/M),signedDistanceFromCamera:M}}function fi(m,o){const d=[m[0],m[1],m[2],1];r.transformMat4$1(d,d,o);const y=d[3];return{point:new r.pointGeometry(d[0]/y,d[1]/y),signedDistanceFromCamera:y}}function di(m,o){return Math.min(.5+m/o*.5,1.5)}function Fs(m,o){const d=m[0]/m[3],y=m[1]/m[3];return d>=-o[0]&&d<=o[0]&&y>=-o[1]&&y<=o[1]}function Ho(m,o,d,y,M,S,C,L,U,G){const j=d.transform,Y=y?m.textSizeData:m.iconSizeData,ne=r.evaluateSizeForZoom(Y,d.transform.zoom),se=[256/d.width*2+1,256/d.height*2+1],re=y?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;re.clear();const Q=m.lineVertexArray,_e=y?m.text.placedSymbolArray:m.icon.placedSymbolArray,ue=d.transform.width/d.transform.height;let ye=!1;for(let ve=0;ve<_e.length;ve++){const Me=_e.get(ve);if(Me.writingMode!==r.WritingMode.vertical||ye||ve!==0&&_e.get(ve-1).writingMode===r.WritingMode.horizontal||(ye=!0),(Me.hidden||Me.writingMode===r.WritingMode.vertical)&&!ye){ji(Me.numGlyphs,re);continue}ye=!1;const ge=new r.pointGeometry(Me.tileAnchorX,Me.tileAnchorY),Ce=U?U(ge):[0,0,0],Qe=j.projection.projectTilePoint(ge.x,ge.y,G.canonical),rt=[Qe.x+Ce[0],Qe.y+Ce[1],Qe.z+Ce[2]],ht=[...rt,1];if(r.transformMat4$1(ht,ht,o),!Fs(ht,se)){ji(Me.numGlyphs,re);continue}const ct=di(d.transform.cameraToCenterDistance,ht[3]),Ft=r.evaluateSizeForFeature(Y,ne,Me),$e=C?Ft/ct:Ft*ct,kt=hi(new r.pointGeometry(rt[0],rt[1]),M,rt[2]);if(kt.signedDistanceFromCamera<=0){ji(Me.numGlyphs,re);continue}let Ct={};const Qt=C?null:U,dt=Eu(Me,$e,!1,L,o,M,S,m.glyphOffsetArray,Q,re,kt.point,ge,Ct,ue,Qt,j.projection,G);ye=dt.useVertical,Qt&&dt.needsFlipping&&(Ct={}),(dt.notEnoughRoom||ye||dt.needsFlipping&&Eu(Me,$e,!0,L,o,M,S,m.glyphOffsetArray,Q,re,kt.point,ge,Ct,ue,Qt,j.projection,G).notEnoughRoom)&&ji(Me.numGlyphs,re)}y?m.text.dynamicLayoutVertexBuffer.updateData(re):m.icon.dynamicLayoutVertexBuffer.updateData(re)}function Tu(m,o,d,y,M,S,C,L,U,G,j,Y,ne,se,re){const Q=L.glyphStartIndex+L.numGlyphs,_e=L.lineStartIndex,ue=L.lineStartIndex+L.lineLength,ye=o.getoffsetX(L.glyphStartIndex),ve=o.getoffsetX(Q-1),Me=Bs(m*ye,d,y,M,S,C,L.segment,_e,ue,U,G,j,Y,ne,!0,se,re);if(!Me)return null;const ge=Bs(m*ve,d,y,M,S,C,L.segment,_e,ue,U,G,j,Y,ne,!0,se,re);return ge?{first:Me,last:ge}:null}function ks(m,o,d,y){return m.writingMode===r.WritingMode.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*y?{useVertical:!0}:m.writingMode===r.WritingMode.vertical?o.y<d.y?{needsFlipping:!0}:null:m.flipState!==0&&function(M,S,C){const L=(S.x-M.x)*C;return L===0||Math.abs((S.y-M.y)/L)>Rn}(o,d,y)?m.flipState===1?{needsFlipping:!0}:null:o.x>d.x?{needsFlipping:!0}:null}function Eu(m,o,d,y,M,S,C,L,U,G,j,Y,ne,se,re,Q,_e){const ue=o/24,ye=m.lineOffsetX*ue,ve=m.lineOffsetY*ue;let Me;if(m.numGlyphs>1){const ge=m.glyphStartIndex+m.numGlyphs,Ce=m.lineStartIndex,Qe=m.lineStartIndex+m.lineLength,rt=Tu(ue,L,ye,ve,d,j,Y,m,U,S,ne,re,!1,Q,_e);if(!rt)return{notEnoughRoom:!0};const ht=hi(rt.first.point,C).point,ct=hi(rt.last.point,C).point;if(y&&!d){const Ft=ks(m,ht,ct,se);if(m.flipState=Ft&&Ft.needsFlipping?1:2,Ft)return Ft}Me=[rt.first];for(let Ft=m.glyphStartIndex+1;Ft<ge-1;Ft++)Me.push(Bs(ue*L.getoffsetX(Ft),ye,ve,d,j,Y,m.segment,Ce,Qe,U,S,ne,re,!1,!1,Q,_e));Me.push(rt.last)}else{if(y&&!d){const Ce=hi(Y,M).point,Qe=m.lineStartIndex+m.segment+1,rt=new r.pointGeometry(U.getx(Qe),U.gety(Qe)),ht=hi(rt,M),ct=ks(m,Ce,ht.signedDistanceFromCamera>0?ht.point:Qn(Y,rt,Ce,1,M,void 0,Q,_e.canonical),se);if(m.flipState=ct&&ct.needsFlipping?1:2,ct)return ct}const ge=Bs(ue*L.getoffsetX(m.glyphStartIndex),ye,ve,d,j,Y,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,U,S,ne,re,!1,!1,Q,_e);if(!ge)return{notEnoughRoom:!0};Me=[ge]}for(const ge of Me)r.addDynamicAttributes(G,ge.point,ge.angle);return{}}function Vd(m,o,d,y,M){const S=y.projectTilePoint(m.x,m.y,o);if(!M)return hi(S,d,S.z);const C=M(m);return hi(new r.pointGeometry(S.x+C[0],S.y+C[1]),d,S.z+C[2])}function Qn(m,o,d,y,M,S,C,L){const U=Vd(m.add(m.sub(o)._unit()),L,M,C,S).point,G=d.sub(U);return d.add(G._mult(y/G.mag()))}function Bs(m,o,d,y,M,S,C,L,U,G,j,Y,ne,se,re,Q,_e){const ue=y?m-o:m+o;let ye=ue>0?1:-1,ve=0;y&&(ye*=-1,ve=Math.PI),ye<0&&(ve+=Math.PI);let Me=ye>0?L+C:L+C+1,ge=M,Ce=M,Qe=0,rt=0;const ht=Math.abs(ue),ct=[],Ft=[];let $e=S;const kt=()=>{const Kt=Me-ye;return Qe===0?S:new r.pointGeometry(G.getx(Kt),G.gety(Kt))},Ct=()=>Qn(kt(),$e,Ce,ht-Qe+1,j,ne,Q,_e.canonical);for(;Qe+rt<=ht;){if(Me+=ye,Me<L||Me>=U)return null;if(Ce=ge,ct.push(ge),se&&Ft.push($e||kt()),ge=Y[Me],ge===void 0){$e=new r.pointGeometry(G.getx(Me),G.gety(Me));const Kt=Vd($e,_e.canonical,j,Q,ne);ge=Kt.signedDistanceFromCamera>0?Y[Me]=Kt.point:Ct()}else $e=null;Qe+=rt,rt=Ce.dist(ge)}re&&ne&&($e=$e||new r.pointGeometry(G.getx(Me),G.gety(Me)),Y[Me]=ge=Y[Me]===void 0?ge:Ct(),rt=Ce.dist(ge));const Qt=(ht-Qe)/rt,dt=ge.sub(Ce),Yt=dt.mult(Qt)._add(Ce);d&&Yt._add(dt._unit()._perp()._mult(d*ye));const gn=ve+Math.atan2(ge.y-Ce.y,ge.x-Ce.x);return ct.push(Yt),se&&($e=$e||new r.pointGeometry(G.getx(Me),G.gety(Me)),Ft.push(function(Kt,Zt,wn){const Nn=1-wn;return new r.pointGeometry(Kt.x*Nn+Zt.x*wn,Kt.y*Nn+Zt.y*wn)}(Ft.length>0?Ft[Ft.length-1]:$e,$e,Qt))),{point:Yt,angle:gn,path:ct,tilePath:Ft}}const Od=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ji(m,o){for(let d=0;d<m;d++){const y=o.length;o.resize(y+4),o.float32.set(Od,3*y)}}function kr(m,o,d){const y=o[0],M=o[1];return m[0]=d[0]*y+d[4]*M+d[12],m[1]=d[1]*y+d[5]*M+d[13],m[3]=d[3]*y+d[7]*M+d[15],m}const xo=100;class Pu{constructor(o,d,y=new En(o.width+200,o.height+200,25),M=new En(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=M,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+xo,this.screenBottomBoundary=o.height+xo,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=d}placeCollisionBox(o,d,y,M,S,C,L){let U=d.projectedAnchorX,G=d.projectedAnchorY,j=d.projectedAnchorZ;const Y=d.elevation,ne=d.tileID;if(Y&&ne){const Me=this.transform.projection.upVector(ne.canonical,d.tileAnchorX,d.tileAnchorY),ge=this.transform.projection.upVectorScale(ne.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=Me[0]*Y*ge,G+=Me[1]*Y*ge,j+=Me[2]*Y*ge}const se=this.projectAndGetPerspectiveRatio(C,[U,G,j],d.tileID,this.transform.projection.name==="globe"||!!Y||this.transform.pitch>0),re=S*se.perspectiveRatio,Q=(d.x1*o+y.x-d.padding)*re+se.point.x,_e=(d.y1*o+y.y-d.padding)*re+se.point.y,ue=(d.x2*o+y.x+d.padding)*re+se.point.x,ye=(d.y2*o+y.y+d.padding)*re+se.point.y,ve=se.perspectiveRatio<=.55||se.occluded;return!this.isInsideGrid(Q,_e,ue,ye)||!M&&this.grid.hitTest(Q,_e,ue,ye,L)||ve?{box:[],offscreen:!1,occluded:se.occluded}:{box:[Q,_e,ue,ye],offscreen:this.isOffscreen(Q,_e,ue,ye),occluded:!1}}placeCollisionCircles(o,d,y,M,S,C,L,U,G,j,Y,ne,se,re){const Q=[],_e=this.transform.elevation,ue=_e?_e.getAtTileOffsetFunc(re,this.transform.center.lat,this.transform.worldSize,this.transform.projection):Ct=>[0,0,0],ye=new r.pointGeometry(d.tileAnchorX,d.tileAnchorY),ve=this.transform.projection.projectTilePoint(d.tileAnchorX,d.tileAnchorY,re.canonical),Me=ue(ye),ge=[ve.x+Me[0],ve.y+Me[1],ve.z+Me[2]],Ce=this.projectAndGetPerspectiveRatio(C,[ge[0],ge[1],ge[2]],re,this.transform.projection.name==="globe"||!!_e||this.transform.pitch>0),{perspectiveRatio:Qe}=Ce,rt=(j?S/Qe:S*Qe)/r.ONE_EM,ht=hi(new r.pointGeometry(ge[0],ge[1]),L,ge[2]).point,ct=Ce.signedDistanceFromCamera>0?Tu(rt,M,d.lineOffsetX*rt,d.lineOffsetY*rt,!1,ht,ye,d,y,L,{},_e&&!j?ue:null,j&&!!_e,this.transform.projection,re):null;let Ft=!1,$e=!1,kt=!0;if(ct&&!Ce.occluded){const Ct=.5*ne*Qe+se,Qt=new r.pointGeometry(-100,-100),dt=new r.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Yt=new mn,gn=ct.first,Kt=ct.last;let Zt=[];for(let pn=gn.path.length-1;pn>=1;pn--)Zt.push(gn.path[pn]);for(let pn=1;pn<Kt.path.length;pn++)Zt.push(Kt.path[pn]);const wn=2.5*Ct;if(U){const pn=Zt.map(_e?(Sn,Zn)=>{const Si=ue(Zn<gn.path.length-1?gn.tilePath[gn.path.length-1-Zn]:Kt.tilePath[Zn-gn.path.length+2]);return hi(Sn,U,Si[2])}:Sn=>hi(Sn,U));Zt=pn.some(Sn=>Sn.signedDistanceFromCamera<=0)?[]:pn.map(Sn=>Sn.point)}let Nn=[];if(Zt.length>0){const pn=Zt[0].clone(),Sn=Zt[0].clone();for(let Zn=1;Zn<Zt.length;Zn++)pn.x=Math.min(pn.x,Zt[Zn].x),pn.y=Math.min(pn.y,Zt[Zn].y),Sn.x=Math.max(Sn.x,Zt[Zn].x),Sn.y=Math.max(Sn.y,Zt[Zn].y);Nn=pn.x>=Qt.x&&Sn.x<=dt.x&&pn.y>=Qt.y&&Sn.y<=dt.y?[Zt]:Sn.x<Qt.x||pn.x>dt.x||Sn.y<Qt.y||pn.y>dt.y?[]:r.clipLine([Zt],Qt.x,Qt.y,dt.x,dt.y)}for(const pn of Nn){Yt.reset(pn,.25*Ct);let Sn=0;Sn=Yt.length<=.5*Ct?1:Math.ceil(Yt.paddedLength/wn)+1;for(let Zn=0;Zn<Sn;Zn++){const Si=Zn/Math.max(Sn-1,1),cr=Yt.lerp(Si),ur=cr.x+xo,Vr=cr.y+xo;Q.push(ur,Vr,Ct,0);const bo=ur-Ct,Zo=Vr-Ct,Sa=ur+Ct,Jo=Vr+Ct;if(kt=kt&&this.isOffscreen(bo,Zo,Sa,Jo),$e=$e||this.isInsideGrid(bo,Zo,Sa,Jo),!o&&this.grid.hitTestCircle(ur,Vr,Ct,Y)&&(Ft=!0,!G))return{circles:[],offscreen:!1,collisionDetected:Ft,occluded:!1}}}}return{circles:!G&&Ft||!$e?[]:Q,offscreen:kt,collisionDetected:Ft,occluded:Ce.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let y=1/0,M=1/0,S=-1/0,C=-1/0;for(const j of o){const Y=new r.pointGeometry(j.x+xo,j.y+xo);y=Math.min(y,Y.x),M=Math.min(M,Y.y),S=Math.max(S,Y.x),C=Math.max(C,Y.y),d.push(Y)}const L=this.grid.query(y,M,S,C).concat(this.ignoredGrid.query(y,M,S,C)),U={},G={};for(const j of L){const Y=j.key;if(U[Y.bucketInstanceId]===void 0&&(U[Y.bucketInstanceId]={}),U[Y.bucketInstanceId][Y.featureIndex])continue;const ne=[new r.pointGeometry(j.x1,j.y1),new r.pointGeometry(j.x2,j.y1),new r.pointGeometry(j.x2,j.y2),new r.pointGeometry(j.x1,j.y2)];r.polygonIntersectsPolygon(d,ne)&&(U[Y.bucketInstanceId][Y.featureIndex]=!0,G[Y.bucketInstanceId]===void 0&&(G[Y.bucketInstanceId]=[]),G[Y.bucketInstanceId].push(Y.featureIndex))}return G}insertCollisionBox(o,d,y,M,S){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:M,collisionGroupID:S},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,y,M,S){const C=d?this.ignoredGrid:this.grid,L={bucketInstanceId:y,featureIndex:M,collisionGroupID:S};for(let U=0;U<o.length;U+=4)C.insertCircle(L,o[U],o[U+1],o[U+2])}projectAndGetPerspectiveRatio(o,d,y,M){const S=[d[0],d[1],d[2],1];let C=!1;return d[2]||this.transform.pitch>0?(r.transformMat4$1(S,S,o),this.fogState&&y&&(C=function(L,U,G,j,Y,ne){const se=ne.calculateFogTileMatrix(Y),re=[U,G,j];return r.transformMat4(re,re,se),mt(L,re,ne.pitch,ne._fov)}(this.fogState,d[0],d[1],d[2],y.toUnwrapped(),this.transform)>.9)):kr(S,S,o),{point:new r.pointGeometry((S[0]/S[3]+1)/2*this.transform.width+xo,(-S[1]/S[3]+1)/2*this.transform.height+xo),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/S[3]*.5,1.5),signedDistanceFromCamera:S[3],occluded:M&&S[2]>S[3]||C}}isOffscreen(o,d,y,M){return y<xo||o>=this.screenRightBoundary||M<xo||d>this.screenBottomBoundary}isInsideGrid(o,d,y,M){return y>=0&&o<this.gridRightBoundary&&M>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=r.identity([]);return r.translate(o,o,[-100,-100,0]),o}}class Bi{constructor(o,d,y,M){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):M&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Wo{constructor(o,d,y,M,S,C=!1){this.text=new Bi(o?o.text:null,d,y,S),this.icon=new Bi(o?o.icon:null,d,M,S),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qo{constructor(o,d,y,M=!1){this.text=o,this.icon=d,this.skipFade=y,this.clipped=M}}class ar{constructor(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]}}class Gd{constructor(o,d,y,M,S){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=M,this.tileID=S}}class vo{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[o]}}function zs(m,o,d,y,M){const{horizontalAlign:S,verticalAlign:C}=r.getAnchorAlignment(m),L=-(S-.5)*o,U=-(C-.5)*d,G=r.evaluateVariableOffset(m,y);return new r.pointGeometry(L+G[0]*M,U+G[1]*M)}function Us(m,o,d,y,M){const S=new r.pointGeometry(m,o);return d&&S._rotate(y?M:-M),S}class Fx{constructor(o,d,y,M,S){this.transform=o.clone(),this.collisionIndex=new Pu(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new vo(y),this.collisionCircleArrays={},this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,y,M){const S=y.getBucket(d),C=y.latestFeatureIndex;if(!S||!C||d.id!==S.layerIds[0])return;const L=S.layers[0].layout,U=y.collisionBoxArray,G=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),j=y.tileSize/r.EXTENT,Y=y.tileID.toUnwrapped(),ne=this.transform.calculateProjMatrix(Y),se=L.get("text-pitch-alignment")==="map",re=L.get("text-rotation-alignment")==="map";d.compileFilter();const Q=d.dynamicFilter(),_e=d.dynamicFilterNeedsFeature(),ue=this.transform.calculatePixelsToTileUnitsMatrix(y),ye=xi(ne,y.tileID.canonical,se,re,this.transform,ue);let ve=null;if(se){const Ce=Fr(ne,y.tileID.canonical,se,re,this.transform,ue);ve=r.multiply$1([],this.transform.labelPlaneMatrix,Ce)}let Me=null;Q&&y.latestFeatureIndex&&(Me={unwrappedTileID:Y,dynamicFilter:Q,dynamicFilterNeedsFeature:_e,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new Gd(S.bucketInstanceId,C,S.sourceLayerIndex,S.index,y.tileID);const ge={bucket:S,layout:L,posMatrix:ne,textLabelPlaneMatrix:ye,labelToScreenMatrix:ve,clippingData:Me,scale:G,textPixelRatio:j,holdingForFade:y.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.evaluateSizeForZoom(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(M)for(const Ce of S.sortKeyRanges){const{sortKey:Qe,symbolInstanceStart:rt,symbolInstanceEnd:ht}=Ce;o.push({sortKey:Qe,symbolInstanceStart:rt,symbolInstanceEnd:ht,parameters:ge})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:ge})}attemptAnchorPlacement(o,d,y,M,S,C,L,U,G,j,Y,ne,se,re,Q,_e,ue,ye){const ve=[ne.textOffset0,ne.textOffset1],Me=zs(o,y,M,ve,S),ge=this.collisionIndex.placeCollisionBox(S,d,Us(Me.x,Me.y,C,L,this.transform.angle),Y,U,G,j.predicate);if((!_e||this.collisionIndex.placeCollisionBox(re.getSymbolInstanceIconSize(ye,this.transform.zoom,se),_e,Us(Me.x,Me.y,C,L,this.transform.angle),Y,U,G,j.predicate).box.length!==0)&&ge.box.length>0){let Ce;return this.prevPlacement&&this.prevPlacement.variableOffsets[ne.crossTileID]&&this.prevPlacement.placements[ne.crossTileID]&&this.prevPlacement.placements[ne.crossTileID].text&&(Ce=this.prevPlacement.variableOffsets[ne.crossTileID].anchor),this.variableOffsets[ne.crossTileID]={textOffset:ve,width:y,height:M,anchor:o,textScale:S,prevAnchor:Ce},this.markUsedJustification(re,o,ne,Q),re.allowVerticalPlacement&&(this.markUsedOrientation(re,Q,ne),this.placedOrientations[ne.crossTileID]=Q),{shift:Me,placedGlyphBoxes:ge}}}placeLayerBucketPart(o,d,y,M){const{bucket:S,layout:C,posMatrix:L,textLabelPlaneMatrix:U,labelToScreenMatrix:G,clippingData:j,textPixelRatio:Y,holdingForFade:ne,collisionBoxArray:se,partiallyEvaluatedTextSize:re,partiallyEvaluatedIconSize:Q,collisionGroup:_e}=o.parameters,ue=C.get("text-optional"),ye=C.get("icon-optional"),ve=C.get("text-allow-overlap"),Me=C.get("icon-allow-overlap"),ge=C.get("text-rotation-alignment")==="map",Ce=C.get("text-pitch-alignment")==="map",Qe=C.get("icon-text-fit")!=="none",rt=C.get("symbol-z-order")==="viewport-y";let ht=ve&&(Me||!S.hasIconData()||ye),ct=Me&&(ve||!S.hasTextData()||ue);!S.collisionArrays&&se&&S.deserializeCollisionBoxes(se),y&&M&&S.updateCollisionDebugBuffers(this.transform.zoom,se);const Ft=($e,kt,Ct)=>{if(j){const Ei={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ri=null;if(j.dynamicFilterNeedsFeature){const ei=this.retainedQueryData[S.bucketInstanceId];Ri=j.featureIndex.loadFeature({featureIndex:$e.featureIndex,bucketIndex:ei.bucketIndex,sourceLayerIndex:ei.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,j.dynamicFilter)(Ei,Ri,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new r.pointGeometry($e.tileAnchorX,$e.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[$e.crossTileID]=new qo(!1,!1,!1,!0),void(d[$e.crossTileID]=!0)}if(d[$e.crossTileID])return;if(ne)return void(this.placements[$e.crossTileID]=new qo(!1,!1,!1));let Qt=!1,dt=!1,Yt=!0,gn=!1,Kt=!1,Zt=null,wn={box:null,offscreen:null,occluded:null},Nn={box:null,offscreen:null,occluded:null},pn=null,Sn=null,Zn=null,Si=0,cr=0,ur=0;Ct.textFeatureIndex?Si=Ct.textFeatureIndex:$e.useRuntimeCollisionCircles&&(Si=$e.featureIndex),Ct.verticalTextFeatureIndex&&(cr=Ct.verticalTextFeatureIndex);const Vr=Ei=>{Ei.tileID=this.retainedQueryData[S.bucketInstanceId].tileID,(this.transform.elevation||Ei.elevation)&&(Ei.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[S.bucketInstanceId].tileID,Ei.tileAnchorX,Ei.tileAnchorY):0)},bo=Ct.textBox;if(bo){Vr(bo);const Ei=ei=>{let zi=r.WritingMode.horizontal;if(S.allowVerticalPlacement&&!ei&&this.prevPlacement){const Or=this.prevPlacement.placedOrientations[$e.crossTileID];Or&&(this.placedOrientations[$e.crossTileID]=Or,zi=Or,this.markUsedOrientation(S,zi,$e))}return zi},Ri=(ei,zi)=>{if(S.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&Ct.verticalTextBox){for(const Or of S.writingModes)if(Or===r.WritingMode.vertical?(wn=zi(),Nn=wn):wn=ei(),wn&&wn.box&&wn.box.length)break}else wn=ei()};if(C.get("text-variable-anchor")){let ei=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[$e.crossTileID]){const Ti=this.prevPlacement.variableOffsets[$e.crossTileID];ei.indexOf(Ti.anchor)>0&&(ei=ei.filter(eo=>eo!==Ti.anchor),ei.unshift(Ti.anchor))}const zi=(Ti,eo,sc)=>{const Gr=S.getSymbolInstanceTextSize(re,$e,this.transform.zoom,kt),is=(Ti.x2-Ti.x1)*Gr+2*Ti.padding,Hg=(Ti.y2-Ti.y1)*Gr+2*Ti.padding,Sp=Qe&&!Me?eo:null;Sp&&Vr(Sp);let Ks={box:[],offscreen:!1,occluded:!1};const Jx=ve?2*ei.length:ei.length;for(let Ta=0;Ta<Jx;++Ta){const Tp=this.attemptAnchorPlacement(ei[Ta%ei.length],Ti,is,Hg,Gr,ge,Ce,Y,L,_e,Ta>=ei.length,$e,kt,S,sc,Sp,re,Q);if(Tp&&(Ks=Tp.placedGlyphBoxes,Ks&&Ks.box&&Ks.box.length)){Qt=!0,Zt=Tp.shift;break}}return Ks};Ri(()=>zi(bo,Ct.iconBox,r.WritingMode.horizontal),()=>{const Ti=Ct.verticalTextBox;return Ti&&Vr(Ti),S.allowVerticalPlacement&&!(wn&&wn.box&&wn.box.length)&&$e.numVerticalGlyphVertices>0&&Ti?zi(Ti,Ct.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),wn&&(Qt=wn.box,Yt=wn.offscreen,gn=wn.occluded);const Or=Ei(wn&&wn.box);if(!Qt&&this.prevPlacement){const Ti=this.prevPlacement.variableOffsets[$e.crossTileID];Ti&&(this.variableOffsets[$e.crossTileID]=Ti,this.markUsedJustification(S,Ti.anchor,$e,Or))}}else{const ei=(zi,Or)=>{const Ti=S.getSymbolInstanceTextSize(re,$e,this.transform.zoom,kt),eo=this.collisionIndex.placeCollisionBox(Ti,zi,new r.pointGeometry(0,0),ve,Y,L,_e.predicate);return eo&&eo.box&&eo.box.length&&(this.markUsedOrientation(S,Or,$e),this.placedOrientations[$e.crossTileID]=Or),eo};Ri(()=>ei(bo,r.WritingMode.horizontal),()=>{const zi=Ct.verticalTextBox;return S.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&zi?(Vr(zi),ei(zi,r.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Ei(wn&&wn.box&&wn.box.length)}}if(pn=wn,Qt=pn&&pn.box&&pn.box.length>0,Yt=pn&&pn.offscreen,gn=pn&&pn.occluded,$e.useRuntimeCollisionCircles){const Ei=S.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex>=0?$e.centerJustifiedTextSymbolIndex:$e.verticalPlacedTextSymbolIndex),Ri=r.evaluateSizeForFeature(S.textSizeData,re,Ei),ei=C.get("text-padding");Sn=this.collisionIndex.placeCollisionCircles(ve,Ei,S.lineVertexArray,S.glyphOffsetArray,Ri,L,U,G,y,Ce,_e.predicate,$e.collisionCircleDiameter*Ri/r.ONE_EM,ei,this.retainedQueryData[S.bucketInstanceId].tileID),Qt=ve||Sn.circles.length>0&&!Sn.collisionDetected,Yt=Yt&&Sn.offscreen,gn=Sn.occluded}if(Ct.iconFeatureIndex&&(ur=Ct.iconFeatureIndex),Ct.iconBox){const Ei=Ri=>{Vr(Ri);const ei=Qe&&Zt?Us(Zt.x,Zt.y,ge,Ce,this.transform.angle):new r.pointGeometry(0,0),zi=S.getSymbolInstanceIconSize(Q,this.transform.zoom,kt);return this.collisionIndex.placeCollisionBox(zi,Ri,ei,Me,Y,L,_e.predicate)};Nn&&Nn.box&&Nn.box.length&&Ct.verticalIconBox?(Zn=Ei(Ct.verticalIconBox),dt=Zn.box.length>0):(Zn=Ei(Ct.iconBox),dt=Zn.box.length>0),Yt=Yt&&Zn.offscreen,Kt=Zn.occluded}const Zo=ue||$e.numHorizontalGlyphVertices===0&&$e.numVerticalGlyphVertices===0,Sa=ye||$e.numIconVertices===0;if(Zo||Sa?Sa?Zo||(dt=dt&&Qt):Qt=dt&&Qt:dt=Qt=dt&&Qt,Qt&&pn&&pn.box&&this.collisionIndex.insertCollisionBox(pn.box,C.get("text-ignore-placement"),S.bucketInstanceId,Nn&&Nn.box&&cr?cr:Si,_e.ID),dt&&Zn&&this.collisionIndex.insertCollisionBox(Zn.box,C.get("icon-ignore-placement"),S.bucketInstanceId,ur,_e.ID),Sn&&(Qt&&this.collisionIndex.insertCollisionCircles(Sn.circles,C.get("text-ignore-placement"),S.bucketInstanceId,Si,_e.ID),y)){const Ei=S.bucketInstanceId;let Ri=this.collisionCircleArrays[Ei];Ri===void 0&&(Ri=this.collisionCircleArrays[Ei]=new ar);for(let ei=0;ei<Sn.circles.length;ei+=4)Ri.circles.push(Sn.circles[ei+0]),Ri.circles.push(Sn.circles[ei+1]),Ri.circles.push(Sn.circles[ei+2]),Ri.circles.push(Sn.collisionDetected?1:0)}const Jo=this.transform.projection.name!=="globe";ht=ht&&(Jo||!gn),ct=ct&&(Jo||!Kt),this.placements[$e.crossTileID]=new qo(Qt||ht,dt||ct,Yt||S.justReloaded),d[$e.crossTileID]=!0};if(rt){const $e=S.getSortedSymbolIndexes(this.transform.angle);for(let kt=$e.length-1;kt>=0;--kt){const Ct=$e[kt];Ft(S.symbolInstances.get(Ct),Ct,S.collisionArrays[Ct])}}else for(let $e=o.symbolInstanceStart;$e<o.symbolInstanceEnd;$e++)Ft(S.symbolInstances.get($e),$e,S.collisionArrays[$e]);if(y&&S.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[S.bucketInstanceId];r.invert($e.invProjMatrix,L),$e.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(o,d,y,M){let S;S=M===r.WritingMode.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[r.getAnchorJustification(d)];const C=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const L of C)L>=0&&(o.text.placedSymbolArray.get(L).crossTileID=S>=0&&L!==S?0:y.crossTileID)}markUsedOrientation(o,d,y){const M=d===r.WritingMode.horizontal||d===r.WritingMode.horizontalOnly?d:0,S=d===r.WritingMode.vertical?d:0,C=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const L of C)o.text.placedSymbolArray.get(L).placedOrientation=M;y.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const M=d?d.symbolFadeChange(o):1,S=d?d.opacities:{},C=d?d.variableOffsets:{},L=d?d.placedOrientations:{};for(const U in this.placements){const G=this.placements[U],j=S[U];j?(this.opacities[U]=new Wo(j,M,G.text,G.icon,null,G.clipped),y=y||G.text!==j.text.placed||G.icon!==j.icon.placed):(this.opacities[U]=new Wo(null,M,G.text,G.icon,G.skipFade,G.clipped),y=y||G.text||G.icon)}for(const U in S){const G=S[U];if(!this.opacities[U]){const j=new Wo(G,M,!1,!1);j.isHidden()||(this.opacities[U]=j,y=y||G.text.placed||G.icon.placed)}}for(const U in C)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=C[U]);for(const U in L)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=L[U]);y?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const y={};for(const M of d){const S=M.getBucket(o);S&&M.latestFeatureIndex&&o.id===S.layerIds[0]&&this.updateBucketOpacities(S,y,M.collisionBoxArray)}}updateBucketOpacities(o,d,y){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const M=o.layers[0].layout,S=!!o.layers[0].dynamicFilter(),C=new Wo(null,0,!1,!1,!0),L=M.get("text-allow-overlap"),U=M.get("icon-allow-overlap"),G=M.get("text-variable-anchor"),j=M.get("text-rotation-alignment")==="map",Y=M.get("text-pitch-alignment")==="map",ne=M.get("icon-text-fit")!=="none",se=new Wo(null,0,L&&(U||!o.hasIconData()||M.get("icon-optional")),U&&(L||!o.hasTextData()||M.get("text-optional")),!0);!o.collisionArrays&&y&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(y);const re=(_e,ue,ye)=>{for(let ve=0;ve<ue/4;ve++)_e.opacityVertexArray.emplaceBack(ye)};let Q=0;for(let _e=0;_e<o.symbolInstances.length;_e++){const ue=o.symbolInstances.get(_e),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:ve,crossTileID:Me}=ue;let ge=this.opacities[Me];d[Me]?ge=C:ge||(ge=se,this.opacities[Me]=ge),d[Me]=!0;const Ce=ye>0||ve>0,Qe=ue.numIconVertices>0,rt=this.placedOrientations[ue.crossTileID],ht=rt===r.WritingMode.vertical,ct=rt===r.WritingMode.horizontal||rt===r.WritingMode.horizontalOnly;if(!Ce&&!Qe||ge.isHidden()||Q++,Ce){const Ft=$m(ge.text);re(o.text,ye,ht?Du:Ft),re(o.text,ve,ct?Du:Ft);const $e=ge.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach(Qt=>{Qt>=0&&(o.text.placedSymbolArray.get(Qt).hidden=$e||ht?1:0)}),ue.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=$e||ct?1:0);const kt=this.variableOffsets[ue.crossTileID];kt&&this.markUsedJustification(o,kt.anchor,ue,rt);const Ct=this.placedOrientations[ue.crossTileID];Ct&&(this.markUsedJustification(o,"left",ue,Ct),this.markUsedOrientation(o,Ct,ue))}if(Qe){const Ft=$m(ge.icon);ue.placedIconSymbolIndex>=0&&(re(o.icon,ue.numIconVertices,ht?Du:Ft),o.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=ge.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(re(o.icon,ue.numVerticalIconVertices,ct?Du:Ft),o.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Ft=o.collisionArrays[_e];if(Ft){let $e=new r.pointGeometry(0,0),kt=!0;if(Ft.textBox||Ft.verticalTextBox){if(G){const Qt=this.variableOffsets[Me];Qt?($e=zs(Qt.anchor,Qt.width,Qt.height,Qt.textOffset,Qt.textScale),j&&$e._rotate(Y?this.transform.angle:-this.transform.angle)):kt=!1}S&&(kt=!ge.clipped),Ft.textBox&&_o(o.textCollisionBox.collisionVertexArray,ge.text.placed,!kt||ht,$e.x,$e.y),Ft.verticalTextBox&&_o(o.textCollisionBox.collisionVertexArray,ge.text.placed,!kt||ct,$e.x,$e.y)}const Ct=kt&&!!(!ct&&Ft.verticalIconBox);Ft.iconBox&&_o(o.iconCollisionBox.collisionVertexArray,ge.icon.placed,Ct,ne?$e.x:0,ne?$e.y:0),Ft.verticalIconBox&&_o(o.iconCollisionBox.collisionVertexArray,ge.icon.placed,!Ct,ne?$e.x:0,ne?$e.y:0)}}}if(o.fullyClipped=Q===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=_e.invProjMatrix,o.placementViewportMatrix=_e.viewportMatrix,o.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>o}setStale(){this.stale=!0}}function _o(m,o,d,y,M){m.emplaceBack(o?1:0,d?1:0,y||0,M||0),m.emplaceBack(o?1:0,d?1:0,y||0,M||0),m.emplaceBack(o?1:0,d?1:0,y||0,M||0),m.emplaceBack(o?1:0,d?1:0,y||0,M||0)}const kx=Math.pow(2,25),Qm=Math.pow(2,24),Br=Math.pow(2,17),Cu=Math.pow(2,16),ga=Math.pow(2,9),jd=Math.pow(2,8),Ru=Math.pow(2,1);function $m(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const o=m.placed?1:0,d=Math.floor(127*m.opacity);return d*kx+o*Qm+d*Br+o*Cu+d*ga+o*jd+d*Ru+o}const Du=0;class Hd{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,y,M,S){const C=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(C,M,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((L,U)=>L.sortKey-U.sortKey));this._currentPartIndex<C.length;){const L=C[this._currentPartIndex];if(d.placeLayerBucketPart(L,this._seenCrossTileIDs,y,L.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class Bx{constructor(o,d,y,M,S,C,L,U){this.placement=new Fx(o,S,C,L,U),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=M,this._done=!1}isDone(){return this._done}continuePlacement(o,d,y){const M=r.exported.now(),S=()=>{const C=r.exported.now()-M;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){const C=d[o[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=L)&&(!C.maxzoom||C.maxzoom>L)){if(this._inProgressLayer||(this._inProgressLayer=new Hd(C)),this._inProgressLayer.continuePlacement(y[C.source],this.placement,this._showCollisionBoxes,C,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const eg=512/r.EXTENT/2;class zx{constructor(o,d,y){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let M=0;M<d.length;M++){const S=d.get(M),C=S.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,o)})}}getScaledCoordinates(o,d){const y=eg/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*r.EXTENT+o.tileAnchorX)*y),y:Math.floor((d.canonical.y*r.EXTENT+o.tileAnchorY)*y)}}findMatches(o,d,y){const M=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let S=0;S<o.length;S++){const C=o.get(S);if(C.crossTileID)continue;const L=this.indexedSymbolInstances[C.key];if(!L)continue;const U=this.getScaledCoordinates(C,d);for(const G of L)if(Math.abs(G.coord.x-U.x)<=M&&Math.abs(G.coord.y-U.y)<=M&&!y[G.crossTileID]){y[G.crossTileID]=!0,C.crossTileID=G.crossTileID;break}}}}class tg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ux{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const y in this.indexes){const M=this.indexes[y],S={};for(const C in M){const L=M[C];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+d),S[L.tileID.key]=L}this.indexes[y]=S}this.lng=o}addBucket(o,d,y){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let S=0;S<d.symbolInstances.length;S++)d.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const M=this.usedCrossTileIDs[o.overscaledZ];for(const S in this.indexes){const C=this.indexes[S];if(Number(S)>o.overscaledZ)for(const L in C){const U=C[L];U.tileID.isChildOf(o)&&U.findMatches(d.symbolInstances,o,M)}else{const L=C[o.scaledTo(Number(S)).key];L&&L.findMatches(d.symbolInstances,o,M)}}for(let S=0;S<d.symbolInstances.length;S++){const C=d.symbolInstances.get(S);C.crossTileID||(C.crossTileID=y.generate(),M[C.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new zx(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const y in d.indexedSymbolInstances)for(const M of d.indexedSymbolInstances[y])delete this.usedCrossTileIDs[o][M.crossTileID]}removeStaleBuckets(o){let d=!1;for(const y in this.indexes){const M=this.indexes[y];for(const S in M)o[M[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,M[S]),delete M[S],d=!0)}return d}}class Iu{constructor(){this.layerIndexes={},this.crossTileIDs=new tg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,y,M){let S=this.layerIndexes[o.id];S===void 0&&(S=this.layerIndexes[o.id]=new Ux);let C=!1;const L={};M.name!=="globe"&&S.handleWrapJump(y);for(const U of d){const G=U.getBucket(o);G&&o.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(U.tileID,G,this.crossTileIDs)&&(C=!0),L[G.bucketInstanceId]=!0)}return S.removeStaleBuckets(L)&&(C=!0),C}pruneUnusedLayers(o){const d={};o.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const Bl=(m,o)=>r.emitValidationErrors(m,o&&o.filter(d=>d.identifier!=="source.canvas")),ng=r.pick(yt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ig=r.pick(yt,["setCenter","setZoom","setBearing","setPitch"]),rg={version:8,layers:[],sources:{}},Ja={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Mr extends r.Evented{constructor(o,d={}){super(),this.map=o,this.dispatcher=new pe(Te(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new r.GlyphManager(o._requestManager,d.localFontFamily?r.LocalGlyphMode.all:d.localIdeographFontFamily?r.LocalGlyphMode.ideographs:r.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.lineAtlas=new r.LineAtlas(256,512),this.crossTileSymbolIndex=new Iu,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new r.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());const y=this;this._rtlTextPluginCallback=Mr.registerForPluginStateChange(M=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:M.pluginStatus,pluginURL:M.pluginURL},(S,C)=>{if(r.triggerPluginCompletionEvent(S),C&&C.every(L=>L))for(const L in y._sourceCaches){const U=y._sourceCaches[L],G=U.getSource().type;G!=="vector"&&G!=="geojson"||U.reload()}})}),this.on("data",M=>{if(M.dataType!=="source"||M.sourceDataType!=="metadata")return;const S=this.getSource(M.sourceId);if(S&&S.vectorLayerIds)for(const C in this._layers){const L=this._layers[C];L.source===S.id&&this._validateLayer(L)}})}loadURL(o,d={}){this.fire(new r.Event("dataloading",{dataType:"style"}));const y=typeof d.validate=="boolean"?d.validate:!r.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,d.accessToken);const M=this.map._requestManager.transformRequest(o,r.ResourceType.Style);this._request=r.getJSON(M,(S,C)=>{this._request=null,S?this.fire(new r.ErrorEvent(S)):C&&this._load(C,y)})}loadJSON(o,d={}){this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.exported.frame(()=>{this._request=null,this._load(o,d.validate!==!1)})}loadEmpty(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(rg,!1)}_updateLayerCount(o,d){const y=d?1:-1;o.is3D()&&(this._num3DLayers+=y),o.type==="circle"&&(this._numCircleLayers+=y),o.type==="symbol"&&(this._numSymbolLayers+=y)}_load(o,d){if(d&&Bl(this,r.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o,this._updateMapProjection();for(const M in o.sources)this.addSource(M,o.sources[M],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const y=At(this.stylesheet.layers);this._order=y.map(M=>M.id),this._layers={},this._serializedLayers={};for(let M of y)M=r.createStyleLayer(M),M.setEventedParent(this,{layer:{id:M.id}}),this._layers[M.id]=M,this._serializedLayers[M.id]=M.serialize(),this._updateLayerCount(M,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new He(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(o){this._spriteRequest=function(d,y,M){let S,C,L;const U=r.exported.devicePixelRatio>1?"@2x":"";let G=r.getJSON(y.transformRequest(y.normalizeSpriteURL(d,U,".json"),r.ResourceType.SpriteJSON),(ne,se)=>{G=null,L||(L=ne,S=se,Y())}),j=r.getImage(y.transformRequest(y.normalizeSpriteURL(d,U,".png"),r.ResourceType.SpriteImage),(ne,se)=>{j=null,L||(L=ne,C=se,Y())});function Y(){if(L)M(L);else if(S&&C){const ne=r.exported.getImageData(C),se={};for(const re in S){const{width:Q,height:_e,x:ue,y:ye,sdf:ve,pixelRatio:Me,stretchX:ge,stretchY:Ce,content:Qe}=S[re],rt=new r.RGBAImage({width:Q,height:_e});r.RGBAImage.copy(ne,rt,{x:ue,y:ye},{x:0,y:0},{width:Q,height:_e}),se[re]={data:rt,pixelRatio:Me,sdf:ve,stretchX:ge,stretchY:Ce,content:Qe}}M(null,se)}}return{cancel(){G&&(G.cancel(),G=null),j&&(j.cancel(),j=null)}}}(o,this.map._requestManager,(d,y)=>{if(this._spriteRequest=null,d)this.fire(new r.ErrorEvent(d));else if(y)for(const M in y)this.imageManager.addImage(M,y[M]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new r.Event("data",{dataType:"style"}))})}_validateLayer(o){const d=this.getSource(o.source);if(!d)return;const y=o.sourceLayer;y&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(y)===-1)&&this.fire(new r.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${d.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const d=[];for(const y of o){const M=this._layers[y];M.type!=="custom"&&d.push(M.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&Ja[o.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const M=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(M.length||S.length)&&this._updateWorkerLayers(M,S);for(const C in this._updatedSources){const L=this._updatedSources[C];L==="reload"?this._reloadSource(C):L==="clear"&&this._clearSource(C)}this._updateTilesForChangedImages();for(const C in this._updatedPaintProps)this._layers[C].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const y={};for(const M in this._sourceCaches){const S=this._sourceCaches[M];y[M]=S.used,S.used=!1}for(const M of this._order){const S=this._layers[M];if(S.recalculate(o,this._availableImages),!S.isHidden(o.zoom)){const L=this._getLayerSourceCache(S);L&&(L.used=!0)}const C=this.map.painter;if(C){const L=S.getProgramIds();if(!L)continue;const U=S.getProgramConfiguration(o.zoom);for(const G of L)C.useProgram(G,U)}}for(const M in y){const S=this._sourceCaches[M];y[M]!==S.used&&S.getSource().fire(new r.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new r.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Bl(this,r.validateStyle(o)))return!1;(o=r.clone$1(o)).layers=At(o.layers);const d=function(M,S){if(!M)return[{command:yt.setStyle,args:[S]}];let C=[];try{if(!b(M.version,S.version))return[{command:yt.setStyle,args:[S]}];b(M.center,S.center)||C.push({command:yt.setCenter,args:[S.center]}),b(M.zoom,S.zoom)||C.push({command:yt.setZoom,args:[S.zoom]}),b(M.bearing,S.bearing)||C.push({command:yt.setBearing,args:[S.bearing]}),b(M.pitch,S.pitch)||C.push({command:yt.setPitch,args:[S.pitch]}),b(M.sprite,S.sprite)||C.push({command:yt.setSprite,args:[S.sprite]}),b(M.glyphs,S.glyphs)||C.push({command:yt.setGlyphs,args:[S.glyphs]}),b(M.transition,S.transition)||C.push({command:yt.setTransition,args:[S.transition]}),b(M.light,S.light)||C.push({command:yt.setLight,args:[S.light]}),b(M.fog,S.fog)||C.push({command:yt.setFog,args:[S.fog]}),b(M.projection,S.projection)||C.push({command:yt.setProjection,args:[S.projection]});const L={},U=[];(function(Y,ne,se,re){let Q;for(Q in ne=ne||{},Y=Y||{})Y.hasOwnProperty(Q)&&(ne.hasOwnProperty(Q)||rn(Q,se,re));for(Q in ne)ne.hasOwnProperty(Q)&&(Y.hasOwnProperty(Q)?b(Y[Q],ne[Q])||(Y[Q].type==="geojson"&&ne[Q].type==="geojson"&&kn(Y,ne,Q)?se.push({command:yt.setGeoJSONSourceData,args:[Q,ne[Q].data]}):Fn(Q,ne,se,re)):Nt(Q,ne,se))})(M.sources,S.sources,U,L);const G=[];M.layers&&M.layers.forEach(Y=>{Y.source&&L[Y.source]?C.push({command:yt.removeLayer,args:[Y.id]}):G.push(Y)});let j=M.terrain;j&&L[j.source]&&(C.push({command:yt.setTerrain,args:[void 0]}),j=void 0),C=C.concat(U),b(j,S.terrain)||C.push({command:yt.setTerrain,args:[S.terrain]}),function(Y,ne,se){ne=ne||[];const re=(Y=Y||[]).map(dn),Q=ne.map(dn),_e=Y.reduce(Jt,{}),ue=ne.reduce(Jt,{}),ye=re.slice(),ve=Object.create(null);let Me,ge,Ce,Qe,rt,ht,ct;for(Me=0,ge=0;Me<re.length;Me++)Ce=re[Me],ue.hasOwnProperty(Ce)?ge++:(se.push({command:yt.removeLayer,args:[Ce]}),ye.splice(ye.indexOf(Ce,ge),1));for(Me=0,ge=0;Me<Q.length;Me++)Ce=Q[Q.length-1-Me],ye[ye.length-1-Me]!==Ce&&(_e.hasOwnProperty(Ce)?(se.push({command:yt.removeLayer,args:[Ce]}),ye.splice(ye.lastIndexOf(Ce,ye.length-ge),1)):ge++,ht=ye[ye.length-Me],se.push({command:yt.addLayer,args:[ue[Ce],ht]}),ye.splice(ye.length-Me,0,Ce),ve[Ce]=!0);for(Me=0;Me<Q.length;Me++)if(Ce=Q[Me],Qe=_e[Ce],rt=ue[Ce],!ve[Ce]&&!b(Qe,rt))if(b(Qe.source,rt.source)&&b(Qe["source-layer"],rt["source-layer"])&&b(Qe.type,rt.type)){for(ct in bt(Qe.layout,rt.layout,se,Ce,null,yt.setLayoutProperty),bt(Qe.paint,rt.paint,se,Ce,null,yt.setPaintProperty),b(Qe.filter,rt.filter)||se.push({command:yt.setFilter,args:[Ce,rt.filter]}),b(Qe.minzoom,rt.minzoom)&&b(Qe.maxzoom,rt.maxzoom)||se.push({command:yt.setLayerZoomRange,args:[Ce,rt.minzoom,rt.maxzoom]}),Qe)Qe.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&(ct.indexOf("paint.")===0?bt(Qe[ct],rt[ct],se,Ce,ct.slice(6),yt.setPaintProperty):b(Qe[ct],rt[ct])||se.push({command:yt.setLayerProperty,args:[Ce,ct,rt[ct]]}));for(ct in rt)rt.hasOwnProperty(ct)&&!Qe.hasOwnProperty(ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&(ct.indexOf("paint.")===0?bt(Qe[ct],rt[ct],se,Ce,ct.slice(6),yt.setPaintProperty):b(Qe[ct],rt[ct])||se.push({command:yt.setLayerProperty,args:[Ce,ct,rt[ct]]}))}else se.push({command:yt.removeLayer,args:[Ce]}),ht=ye[ye.lastIndexOf(Ce)+1],se.push({command:yt.addLayer,args:[rt,ht]})}(G,S.layers,C)}catch(L){console.warn("Unable to compute style diff:",L),C=[{command:yt.setStyle,args:[S]}]}return C}(this.serialize(),o).filter(M=>!(M.command in ig));if(d.length===0)return!1;const y=d.filter(M=>!(M.command in ng));if(y.length>0)throw new Error(`Unimplemented: ${y.map(M=>M.command).join(", ")}.`);return d.forEach(M=>{M.command!=="setTransition"&&this[M.command].apply(this,M.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,d){return this.getImage(o)?this.fire(new r.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,d),this._afterImageUpdated(o),this)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new r.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,d,y={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(r.validateSource,`sources.${o}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const M=Je(o,d,this.dispatcher,this);M.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:M.serialize(),sourceId:o}));const S=C=>{const L=(C?"symbol:":"other:")+o,U=this._sourceCaches[L]=new r.SourceCache(L,M,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[o]=U,U.style=this,U.onAdd(this.map)};S(!1),d.type!=="vector"&&d.type!=="geojson"||S(!0),M.onAdd&&M.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const d=this.getSource(o);if(!d)throw new Error("There is no source with this ID");for(const M in this._layers)if(this._layers[M].source===o)return this.fire(new r.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${M}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new r.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(o);for(const M of y)delete this._sourceCaches[M.id],delete this._updatedSources[M.id],M.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:M.getSource().id})),M.setEventedParent(null),M.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,d){this._checkLoaded(),this.getSource(o).setData(d),this._changed=!0}getSource(o){const d=this._getSourceCache(o);return d&&d.getSource()}addLayer(o,d,y={}){this._checkLoaded();const M=o.id;if(this.getLayer(M))return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${M}" already exists on this map`)));let S;if(o.type==="custom"){if(Bl(this,r.validateCustomStyleLayer(o)))return;S=r.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(M,o.source),o=r.clone$1(o),o=r.extend(o,{source:M})),this._validate(r.validateLayer,`layers.${M}`,o,{arrayIndex:-1},y))return;S=r.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:M}}),this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}const C=d?this._order.indexOf(d):this._order.length;if(d&&C===-1)return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(C,0,M),this._layerOrderChanged=!0,this._layers[M]=S;const L=this._getLayerSourceCache(S);if(this._removedLayers[M]&&S.source&&L&&S.type!=="custom"){const U=this._removedLayers[M];delete this._removedLayers[M],U.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",L.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const y=this._order.indexOf(o);this._order.splice(y,1);const M=d?this._order.indexOf(d):this._order.length;d&&M===-1?this.fire(new r.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(M,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const y=this._order.indexOf(o);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const d in this._layers)if(this._layers[d].type===o)return!0;return!1}setLayerZoomRange(o,d,y){this._checkLoaded();const M=this.getLayer(o);M?M.minzoom===d&&M.maxzoom===y||(d!=null&&(M.minzoom=d),y!=null&&(M.maxzoom=y),this._updateLayer(M)):this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,d,y={}){this._checkLoaded();const M=this.getLayer(o);if(M){if(!b(M.filter,d))return d==null?(M.filter=void 0,void this._updateLayer(M)):void(this._validate(r.validateFilter,`layers.${M.id}.filter`,d,{layerType:M.type},y)||(M.filter=r.clone$1(d),this._updateLayer(M)))}else this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const d=this.getLayer(o);return d&&r.clone$1(d.filter)}setLayoutProperty(o,d,y,M={}){this._checkLoaded();const S=this.getLayer(o);S?b(S.getLayoutProperty(d),y)||(S.setLayoutProperty(d,y,M),this._updateLayer(S)):this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,d){const y=this.getLayer(o);if(y)return y.getLayoutProperty(d);this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,d,y,M={}){this._checkLoaded();const S=this.getLayer(o);S?b(S.getPaintProperty(d),y)||(S.setPaintProperty(d,y,M)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,d){const y=this.getLayer(o);return y&&y.getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const y=o.source,M=o.sourceLayer,S=this.getSource(y);if(!S)return void this.fire(new r.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const C=S.type;if(C==="geojson"&&M)return void this.fire(new r.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!M)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided.")));const L=this._getSourceCaches(y);for(const U of L)U.setFeatureState(M,o.id,d)}removeFeatureState(o,d){this._checkLoaded();const y=o.source,M=this.getSource(y);if(!M)return void this.fire(new r.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const S=M.type,C=S==="vector"?o.sourceLayer:void 0;if(S==="vector"&&!C)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new r.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const L=this._getSourceCaches(y);for(const U of L)U.removeFeatureState(C,o.id,d)}getFeatureState(o){this._checkLoaded();const d=o.source,y=o.sourceLayer,M=this.getSource(d);if(M){if(M.type!=="vector"||y)return o.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(y,o.id);this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const d in this._sourceCaches){const y=this._sourceCaches[d].getSource();o[y.id]||(o[y.id]=y.serialize())}return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},d=>d!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0;const d=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&d&&d.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",d.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const d=C=>this._layers[C].type==="fill-extrusion",y={},M=[];for(let C=this._order.length-1;C>=0;C--){const L=this._order[C];if(d(L)){y[L]=C;for(const U of o){const G=U[L];if(G)for(const j of G)M.push(j)}}}M.sort((C,L)=>L.intersectionZ-C.intersectionZ);const S=[];for(let C=this._order.length-1;C>=0;C--){const L=this._order[C];if(d(L))for(let U=M.length-1;U>=0;U--){const G=M[U].feature;if(y[G.layer.id]<C)break;S.push(G),M.pop()}else for(const U of o){const G=U[L];if(G)for(const j of G)S.push(j.feature)}}return S}queryRenderedFeatures(o,d,y){d&&d.filter&&this._validate(r.validateFilter,"queryRenderedFeatures.filter",d.filter,null,d);const M={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new r.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of d.layers){const G=this._layers[U];if(!G)return this.fire(new r.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];M[G.source]=!0}}const S=[];d.availableImages=this._availableImages;const C=d&&d.layers?d.layers.some(U=>{const G=this.getLayer(U);return G&&G.is3D()}):this.has3DLayers(),L=De.createFromScreenPoints(o,y);for(const U in this._sourceCaches){const G=this._sourceCaches[U].getSource().id;d.layers&&!M[G]||S.push(et(this._sourceCaches[U],this._layers,this._serializedLayers,L,d,y,C,!!this.map._showQueryGeometry))}return this.placement&&S.push(function(U,G,j,Y,ne,se,re){const Q={},_e=se.queryRenderedSymbols(Y),ue=[];for(const ye of Object.keys(_e).map(Number))ue.push(re[ye]);ue.sort(Gt);for(const ye of ue){const ve=ye.featureIndex.lookupSymbolFeatures(_e[ye.bucketInstanceId],G,ye.bucketIndex,ye.sourceLayerIndex,ne.filter,ne.layers,ne.availableImages,U);for(const Me in ve){const ge=Q[Me]=Q[Me]||[],Ce=ve[Me];Ce.sort((Qe,rt)=>{const ht=ye.featureSortOrder;if(ht){const ct=ht.indexOf(Qe.featureIndex);return ht.indexOf(rt.featureIndex)-ct}return rt.featureIndex-Qe.featureIndex});for(const Qe of Ce)ge.push(Qe)}}for(const ye in Q)Q[ye].forEach(ve=>{const Me=ve.feature,ge=j(U[ye]).getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=ge});return Q}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),L.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(o,d){d&&d.filter&&this._validate(r.validateFilter,"querySourceFeatures.filter",d.filter,null,d);const y=this._getSourceCaches(o);let M=[];for(const S of y)M=M.concat(xt(S,d));return M}addSourceType(o,d,y){return Mr.getSourceType(o)?y(new Error(`A source type called "${o}" already exists.`)):(Mr.setSourceType(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const y=this.light.getLight();let M=!1;for(const C in o)if(!b(o[C],y[C])){M=!0;break}if(!M)return;const S={now:r.exported.now(),transition:r.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,d=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(d===1){if(typeof o.source=="object"){const y="terrain-dem-src";this.addSource(y,o.source),o=r.clone$1(o),o=r.extend(o,{source:y})}if(this._validate(r.validateTerrain,"terrain",o))return}if(!this.terrain||this.terrain&&d!==this.terrain.drapeRenderMode)this._createTerrain(o,d);else{const y=this.terrain,M=y.get();for(const S in o)if(!b(o[S],M[S])){y.set(o),this.stylesheet.terrain=o;const C={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};y.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const d=this.fog=new we(o,this.map.transform);this.stylesheet.fog=o;const y={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};d.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,y=d.get();for(const M in o)if(!b(o[M],y[M])){d.set(o),this.stylesheet.fog=o;const S={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};d.updateTransitions(S);break}}else this._createFog(o);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(y=>this.isLayerDraped(this._layers[y])),d=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...d)}_createTerrain(o,d){const y=this.terrain=new Pt(o,d);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const M={now:r.exported.now(),transition:r.extend({duration:0},this.stylesheet.transition)};y.updateTransitions(M)}_force3DLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="symbol"&&this._updateLayer(d)}}_validate(o,d,y,M,S={}){return(!S||S.validate!==!1)&&Bl(this,o.call(r.validateStyle,r.extend({key:d,style:this.serialize(),value:y,styleSpec:r.spec},M)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const d=this._getSourceCaches(o);for(const y of d)y.clearTiles()}_reloadSource(o){const d=this._getSourceCaches(o);for(const y of d)y.resume(),y.reload()}_updateSources(o){for(const d in this._sourceCaches)this._sourceCaches[d].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const d=this._sourceCaches[o];d.resume(),d.reload()}}_updatePlacement(o,d,y,M,S=!1){let C=!1,L=!1;const U={};for(const G of this._order){const j=this._layers[G];if(j.type!=="symbol")continue;if(!U[j.source]){const ne=this._getLayerSourceCache(j);if(!ne)continue;U[j.source]=ne.getRenderableIds(!0).map(se=>ne.getTileByID(se)).sort((se,re)=>re.tileID.overscaledZ-se.tileID.overscaledZ||(se.tileID.isLessThan(re.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(j,U[j.source],o.center.lng,o.projection);C=C||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),S=S||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new r.Event("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.exported.now(),o.zoom))&&(this.pauseablePlacement=new Bx(o,this._order,S,d,y,M,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.exported.now()),L=!0),C&&this.pauseablePlacement.placement.setStale()),L||C)for(const G of this._order){const j=this._layers[G];j.type==="symbol"&&this.placement.updateLayerOpacities(j,U[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,y){this.imageManager.getImages(d.icons,y),this._updateTilesForChangedImages();const M=S=>{S&&S.setDependencies(d.tileID.key,d.type,d.icons)};M(this._otherSourceCaches[d.source]),M(this._symbolSourceCaches[d.source])}getGlyphs(o,d,y){this.glyphManager.getGlyphs(d.stacks,y)}getResource(o,d,y){return r.makeRequest(d,y)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const d=[];return this._otherSourceCaches[o]&&d.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&d.push(this._symbolSourceCaches[o]),d}_isSourceCacheLoaded(o){const d=this._getSourceCaches(o);return d.length===0?(this.fire(new r.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):d.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Mr.getSourceType=function(m){return Ze[m]},Mr.setSourceType=function(m,o){Ze[m]=o},Mr.registerForPluginStateChange=r.registerForPluginStateChange;var zl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Ul="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Qa={},ya={};Qa=yn("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),ya=yn(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const Lu=yn(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Nl=zl;var Vl={background:yn(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:yn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:yn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:yn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:yn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:yn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:yn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:yn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:yn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:yn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:yn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:yn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:yn(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:yn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:yn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:yn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:yn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:yn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:yn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:yn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:yn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:yn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:yn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:yn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ul),skyboxGradient:yn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ul),skyboxCapture:yn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:yn(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:yn(`uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;varying highp vec3 v_ray_dir;void main() {highp vec3 dir=normalize(v_ray_dir);highp vec3 closest_point=abs(dot(u_globe_pos,dir))*dir;float norm_dist_from_center=length(closest_point-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 1.0)
discard;float t=clamp(1.0-sqrt(norm_dist_from_center-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;varying highp vec3 v_ray_dir;void main() {v_ray_dir=mix(mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);gl_Position=vec4(a_pos,1.0);}")};function yn(m,o,d){const y=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,M=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,S=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),C=m.match(M),L=o.match(M),U=zl.match(M);let G=L?L.concat(C):C;d||(Qa.staticUniforms&&(G=Qa.staticUniforms.concat(G)),ya.staticUniforms&&(G=ya.staticUniforms.concat(G))),G&&(G=G.concat(U));const j={};return{fragmentSource:m=m.replace(y,(Y,ne,se,re,Q)=>(j[Q]=!0,ne==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
varying ${se} ${re} ${Q};
#else
uniform ${se} ${re} u_${Q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Q}
    ${se} ${re} ${Q} = u_${Q};
#endif
`)),vertexSource:o=o.replace(y,(Y,ne,se,re,Q)=>{const _e=re==="float"?"vec2":"vec4",ue=Q.match(/color/)?"color":_e;return j[Q]?ne==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
attribute ${se} ${_e} a_${Q};
varying ${se} ${re} ${Q};
#else
uniform ${se} ${re} u_${Q};
#endif
`:ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${se} ${re} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${ue}(a_${Q}, u_${Q}_t);
#else
    ${se} ${re} ${Q} = u_${Q};
#endif
`:ne==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
attribute ${se} ${_e} a_${Q};
#else
uniform ${se} ${re} u_${Q};
#endif
`:ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${se} ${re} ${Q} = a_${Q};
#else
    ${se} ${re} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${se} ${re} ${Q} = unpack_mix_${ue}(a_${Q}, u_${Q}_t);
#else
    ${se} ${re} ${Q} = u_${Q};
#endif
`}),staticAttributes:S,staticUniforms:G}}class Fu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,y,M,S,C,L,U){this.context=o;let G=this.boundPaintVertexBuffers.length!==M.length;for(let j=0;!G&&j<M.length;j++)this.boundPaintVertexBuffers[j]!==M[j]&&(G=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===d&&this.boundLayoutVertexBuffer===y&&!G&&this.boundIndexBuffer===S&&this.boundVertexOffset===C&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===U?(o.bindVertexArrayOES.set(this.vao),L&&L.bind(),S&&S.dynamicDraw&&S.bind(),U&&U.bind()):this.freshBind(d,y,M,S,C,L,U)}freshBind(o,d,y,M,S,C,L){let U;const G=o.numAttributes,j=this.context,Y=j.gl;if(j.extVertexArrayObject)this.vao&&this.destroy(),this.vao=j.extVertexArrayObject.createVertexArrayOES(),j.bindVertexArrayOES.set(this.vao),U=0,this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=M,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=C,this.boundDynamicVertexBuffer2=L;else{U=j.currentNumAttributes||0;for(let ne=G;ne<U;ne++)Y.disableVertexAttribArray(ne)}d.enableAttributes(Y,o);for(const ne of y)ne.enableAttributes(Y,o);C&&C.enableAttributes(Y,o),L&&L.enableAttributes(Y,o),d.bind(),d.setVertexAttribPointers(Y,o,S);for(const ne of y)ne.bind(),ne.setVertexAttribPointers(Y,o,S);C&&(C.bind(),C.setVertexAttribPointers(Y,o,S)),M&&M.bind(),L&&(L.bind(),L.setVertexAttribPointers(Y,o,S)),j.currentNumAttributes=G}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function og(m,o){const d=Math.pow(2,o.canonical.z),y=o.canonical.y;return[new r.MercatorCoordinate(0,y/d).toLngLat().lat,new r.MercatorCoordinate(0,(y+1)/d).toLngLat().lat]}function ag(m,o,d,y,M,S,C){const L=m.context,U=L.gl,G=d.fbo;if(!G)return;m.prepareDrawTile();const j=m.useProgram("hillshade");L.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,G.colorAttachment.get());const Y=((Q,_e,ue,ye)=>{const ve=ue.paint.get("hillshade-shadow-color"),Me=ue.paint.get("hillshade-highlight-color"),ge=ue.paint.get("hillshade-accent-color");let Ce=ue.paint.get("hillshade-illumination-direction")*(Math.PI/180);ue.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ce-=Q.transform.angle);const Qe=!Q.options.moving;return{u_matrix:ye||Q.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),Qe),u_image:0,u_latrange:og(0,_e.tileID),u_light:[ue.paint.get("hillshade-exaggeration"),Ce],u_shadow:ve,u_highlight:Me,u_accent:ge}})(m,d,y,m.terrain?o.projMatrix:null);m.prepareDrawProgram(L,j,o.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:se,tileBoundsSegments:re}=m.getTileBoundsBuffers(d);j.draw(L,U.TRIANGLES,M,S,C,r.CullFaceMode.disabled,Y,y.id,ne,se,re)}function Wd(m,o,d){if(!o.needsDEMTextureUpload)return;const y=m.context,M=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||m.getTileTexture(d.stride);const S=d.getPixels();o.demTexture?o.demTexture.update(S,{premultiply:!1}):o.demTexture=new r.Texture(y,S,M.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function qd(m,o,d,y,M,S){const C=m.context,L=C.gl;if(!o.dem)return;const U=o.dem;if(C.activeTexture.set(L.TEXTURE1),Wd(m,o,U),!o.demTexture)return;o.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE);const G=U.dim;C.activeTexture.set(L.TEXTURE0);let j=o.fbo;if(!j){const re=new r.Texture(C,{width:G,height:G,data:null},L.RGBA);re.bind(L.LINEAR,L.CLAMP_TO_EDGE),j=o.fbo=C.createFramebuffer(G,G,!0),j.colorAttachment.set(re.texture)}C.bindFramebuffer.set(j.framebuffer),C.viewport.set([0,0,G,G]);const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ne,tileBoundsSegments:se}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(C,L.TRIANGLES,y,M,S,r.CullFaceMode.disabled,((re,Q)=>{const _e=Q.stride,ue=r.create();return r.ortho(ue,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(ue,ue,[0,-r.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[_e,_e],u_zoom:re.overscaledZ,u_unpack:Q.unpackVector}})(o.tileID,U),d.id,Y,ne,se),o.needsHillshadePrepare=!1}const Yd=(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_image0:new r.Uniform1i(m,o.u_image0),u_skirt_height:new r.Uniform1f(m,o.u_skirt_height)}),sg=(m,o)=>({u_matrix:m,u_image0:0,u_skirt_height:o}),lg=(m,o,d,y,M,S)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:o,u_merc_matrix:d,u_zoom_transition:y,u_merc_center:M,u_image0:0,u_grid_matrix:S?Float32Array.from(S):new Float32Array(9)});function ku(m,o){return m!=null&&o!=null&&!(!m.hasData()||!o.hasData())&&m.demTexture!=null&&o.demTexture!=null&&m.tileID.key!==o.tileID.key}const xa=new class{constructor(){this.operations={}}newMorphing(m,o,d,y,M){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==d.tileID.key&&(S.queued=d)}else this.operations[m]={startTime:y,phase:0,duration:M,from:o,to:d,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const o=this.operations[m];return{from:o.from,to:o.to,phase:o.phase}}update(m){for(const o in this.operations){const d=this.operations[o];for(d.phase=(m-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,m)){delete this.operations[o];break}}}_nextOp(m,o){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=o,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Ns={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Xd(m,o){const d=1<<m.z;return!o&&(m.x===0||m.x===d-1)||m.y===0||m.y===d-1}const Bu=m=>({u_matrix:m});function Kd(m,o,d,y,M){if(M>0){const S=r.exported.now(),C=(S-m.timeAdded)/M,L=o?(S-o.timeAdded)/M:-1,U=d.getSource(),G=y.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),j=!o||Math.abs(o.tileID.overscaledZ-G)>Math.abs(m.tileID.overscaledZ-G),Y=j&&m.refreshedUponExpiration?1:r.clamp(j?C:1-L,0,1);return m.refreshedUponExpiration&&C>=1&&(m.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Nx=2*r.mercatorZfromAltitude(1,0)*r.GLOBE_RADIUS*Math.PI;class Ol extends r.SourceCache{constructor(o){const d={type:"raster-dem",maxzoom:o.transform.maxZoom},y=new pe(Te(),null),M=Je("mock-dem",d,y,o.style);super("mock-dem",M,!1),M.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,d){o.state="loaded",d(null)}}class Gl extends r.SourceCache{constructor(o){const d=Je("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new pe(Te(),null),o.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,d,y){if(o.freezeTileCoverage)return;this.transform=o;const M=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,C)=>{if(S[C.key]="",!this._tiles[C.key]){const L=new r.Tile(C,this._source.tileSize*C.overscaleFactor(),o.tileZoom);L.state="loaded",this._tiles[C.key]=L}return S},{});for(const S in this._tiles)S in M||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(o){const d=this.proxyCachedFBO[o];if(d!==void 0){const y=Object.values(d);this.renderCachePool.push(...y),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Zd extends r.OverscaledTileID{constructor(o,d,y){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=d,this.projMatrix=y}}class zr extends r.Elevation{constructor(o,d){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,M,S]=function(U){const G=new r.StructArrayLayout4i8,j=new r.StructArrayLayout3ui6,Y=131;G.reserve(17161),j.reserve(33800);const ne=r.EXTENT/128,se=r.EXTENT+ne/2,re=se+ne;for(let _e=-ne;_e<re;_e+=ne)for(let ue=-ne;ue<re;ue+=ne){const ye=ue<0||ue>se||_e<0||_e>se?24575:0,ve=r.clamp(Math.round(ue),0,r.EXTENT),Me=r.clamp(Math.round(_e),0,r.EXTENT);G.emplaceBack(ve+ye,Me,ve,Me)}const Q=(_e,ue)=>{const ye=ue*Y+_e;j.emplaceBack(ye+1,ye,ye+Y),j.emplaceBack(ye+Y,ye+Y+1,ye+1)};for(let _e=1;_e<129;_e++)for(let ue=1;ue<129;ue++)Q(ue,_e);return[0,129].forEach(_e=>{for(let ue=0;ue<130;ue++)Q(ue,_e),Q(_e,ue)}),[G,j,32768]}(),C=o.context;this.gridBuffer=C.createVertexBuffer(y,r.boundsAttributes.members),this.gridIndexBuffer=C.createIndexBuffer(M),this.gridSegments=r.SegmentVector.simpleSegment(0,0,y.length,M.length),this.gridNoSkirtSegments=r.SegmentVector.simpleSegment(0,0,y.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Gl(d.map),this.orthoMatrix=r.create(),r.ortho(this.orthoMatrix,0,r.EXTENT,0,r.EXTENT,0,1);const L=C.gl;this._overlapStencilMode=new r.StencilMode({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ol(d.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency()}update(o,d,y){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const M=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(M.get("source")),this._exaggeration=M.get("exaggeration");const S=()=>{this.sourceCache.used&&r.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const C=this.getScaledDemTileSize();this.sourceCache.update(d,C,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,S(),this._initializing=!0),S(),d.updateElevation(!y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&r.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const M=this.proxyCoords=d.getIds().map(U=>{const G=d.getTileByID(U).tileID;return G.projMatrix=y.calculateProjMatrix(G.toUnwrapped()),G});(function(U,G){const j=G.transform.pointCoordinate(G.transform.getCameraPoint()),Y=new r.pointGeometry(j.x,j.y);U.sort((ne,se)=>{if(se.overscaledZ-ne.overscaledZ)return se.overscaledZ-ne.overscaledZ;const re=new r.pointGeometry(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),Q=new r.pointGeometry(se.canonical.x+(1<<se.canonical.z)*se.wrap,se.canonical.y),_e=Y.mult(1<<ne.canonical.z);return _e.x-=.5,_e.y-=.5,_e.distSqr(re)-_e.distSqr(Q)})})(M,this.painter),this._previousZoom=y.zoom;const S=this.proxyToSource||{};this.proxyToSource={},M.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const C=this._style._sourceCaches;for(const U in C){const G=C[U];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,o[U],S),G.usedForTerrain))continue;const j=o[U];G.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[d.id]=M.map(U=>new Zd(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(M),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1,this._updateTimestamp=r.exported.now();const L={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const G=this.terrainTileForTile[U.key];if(!G)continue;const j=G.tileID.key;j in L||(this._visibleDemTiles.push(G),L[j]=j)}}_assignTerrainTiles(o){this._initializing||o.forEach(d=>{if(this.terrainTileForTile[d.key])return;const y=this._findTileCoveringTileID(d,this.sourceCache);y&&(this.terrainTileForTile[d.key]=y)})}_prepareDEMTextures(){const o=this.painter.context,d=o.gl;for(const y in this.terrainTileForTile){const M=this.terrainTileForTile[y],S=M.dem;!S||M.demTexture&&!M.needsDEMTextureUpload||(o.activeTexture.set(d.TEXTURE1),Wd(this.painter,M,S))}}_prepareDemTileUniforms(o,d,y,M){if(!d||d.demTexture==null)return!1;const S=o.tileID.canonical,C=Math.pow(2,d.tileID.canonical.z-S.z),L=M||"";return y[`u_dem_tl${L}`]=[S.x*C%1,S.y*C%1],y[`u_dem_scale${L}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,d=o.gl;if(!this._emptyDepthBufferTexture){const y=new r.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.Texture(o,y,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const d=this._visibleDemTiles.reduce((y,M)=>{if(!M.dem)return y;const S=M.dem.tree.minimums[0];return S>0&&o++,y+S},0);return o?d/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,d=o.gl;o.activeTexture.set(d.TEXTURE2);const y=this._getLoadedAreaMinimum(),M=new r.RGBAImage({width:1,height:1},new Uint8Array(r.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(M,{premultiply:!1}):S=this._emptyDEMTexture=new r.Texture(o,M,d.RGBA,{premultiply:!1}),S}setupElevationDraw(o,d,y){const M=this.painter.context,S=M.gl,C=(L=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:r.DEMData.getUnpackVector(L),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var L;C.u_dem_size=this.sourceCache.getSource().tileSize,C.u_exaggeration=this.exaggeration();const U=this.painter.transform,G=U.projection,j=o.tileID.canonical;C.u_tile_tl_up=G.upVector(j,0,0),C.u_tile_tr_up=G.upVector(j,r.EXTENT,0),C.u_tile_br_up=G.upVector(j,r.EXTENT,r.EXTENT),C.u_tile_bl_up=G.upVector(j,0,r.EXTENT),C.u_tile_up_scale=y&&y.useDenormalizedUpVectorScale?Nx:G.upVectorScale(j,U.center.lat,U.worldSize).metersToTile;let Y=null,ne=null,se=1;if(y&&y.morphing&&this._useVertexMorphing){const re=y.morphing.srcDemTile,Q=y.morphing.dstDemTile;se=y.morphing.phase,re&&Q&&(this._prepareDemTileUniforms(o,re,C,"_prev")&&(ne=re),this._prepareDemTileUniforms(o,Q,C)&&(Y=Q))}if(ne&&Y?(M.activeTexture.set(S.TEXTURE2),Y.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),M.activeTexture.set(S.TEXTURE4),ne.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),C.u_dem_lerp=se):(Y=this.terrainTileForTile[o.tileID.key],M.activeTexture.set(S.TEXTURE2),(this._prepareDemTileUniforms(o,Y,C)?Y.demTexture:this.emptyDEMTexture).bind(S.NEAREST,S.CLAMP_TO_EDGE)),M.activeTexture.set(S.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(C.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),C.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&Y){const re=(1<<Y.tileID.canonical.z)*r.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=re}y&&y.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),d.setTerrainUniformValues(M,C)}renderToBackBuffer(o){const d=this.painter,y=this.painter.context;o.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),this.renderingToTexture=!1,function(M,S,C,L,U){if(M.transform.projection.name==="globe")(function(G,j,Y,ne,se){const re=G.context,Q=re.gl;let _e,ue;const ye=G.options.showTerrainWireframe?2:0,ve=(ct,Ft)=>{if(ue===ct)return;const $e=[Ns[ct],"PROJECTION_GLOBE_VIEW"];Ft&&$e.push(Ns[ye]),_e=G.useProgram("globeRaster",null,$e),ue=ct},Me=G.colorModeForRenderPass(),ge=new r.DepthMode(Q.LEQUAL,r.DepthMode.ReadWrite,G.depthRangeFor3D);xa.update(se);const Ce=G.transform,Qe=r.calculateGlobeMercatorMatrix(Ce),rt=[r.mercatorXfromLng(Ce.center.lng),r.mercatorYfromLat(Ce.center.lat)],ht=G.globeSharedBuffers;if((ye?[!1,!0]:[!1]).forEach(ct=>{ue=-1;const Ft=ct?Q.LINES:Q.TRIANGLES;for(const $e of ne){const kt=Y.getTile($e),Ct=r.StencilMode.disabled,Qt=j.prevTerrainTileForTile[$e.key],dt=j.terrainTileForTile[$e.key];ku(Qt,dt)&&xa.newMorphing($e.key,Qt,dt,se,250),re.activeTexture.set(Q.TEXTURE0),kt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Yt=xa.getMorphValuesForProxy($e.key),gn=Yt?1:0,Kt={useDenormalizedUpVectorScale:!0};Yt&&r.extend$1(Kt,{morphing:{srcDemTile:Yt.from,dstDemTile:Yt.to,phase:r.easeCubicInOut(Yt.phase)}});const Zt=Float32Array.from(Ce.globeMatrix),wn=r.globeTileLatLngCorners($e.canonical),Nn=r.getGridMatrix($e.canonical,wn),pn=lg(Ce.projMatrix,Zt,Qe,r.globeToMercatorTransition(Ce.zoom),rt,Nn);if(ve(gn,ct),j.setupElevationDraw(kt,_e,Kt),G.prepareDrawProgram(re,_e,$e.toUnwrapped()),ht){const[Sn,Zn,Si]=ct?ht.getWirefameBuffers(G.context):ht.getGridBuffers();_e.draw(re,Ft,ge,Ct,Me,r.CullFaceMode.backCCW,pn,"globe_raster",Sn,Zn,Si)}}}),ht){_e=G.useProgram("globeRaster",null,["GLOBE_POLES","PROJECTION_GLOBE_VIEW"]);for(const ct of ne){const{x:Ft,y:$e,z:kt}=ct.canonical,Ct=$e===0,Qt=$e===(1<<kt)-1,[dt,Yt,gn,Kt]=ht.getPoleBuffers(kt);if(Kt&&(Ct||Qt)){const Zt=Y.getTile(ct);re.activeTexture.set(Q.TEXTURE0),Zt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let wn=r.globePoleMatrixForTile(kt,Ft,Ce);const Nn=(pn,Sn)=>pn.draw(re,Q.TRIANGLES,ge,r.StencilMode.disabled,Me,r.CullFaceMode.disabled,lg(Ce.projMatrix,wn,wn,0,rt),"globe_pole_raster",Sn,gn,Kt);j.setupElevationDraw(Zt,_e,{}),G.prepareDrawProgram(re,_e,ct.toUnwrapped()),Ct&&Nn(_e,dt),Qt&&(wn=r.scale(r.create(),wn,[1,-1,1]),Nn(_e,Yt))}}}})(M,S,C,L,U);else{const G=M.context,j=G.gl;let Y,ne;const se=M.options.showTerrainWireframe?2:0,re=(ve,Me)=>{if(ne===ve)return;const ge=[Ns[ve]];Me&&ge.push(Ns[se]),Y=M.useProgram("terrainRaster",null,ge),ne=ve},Q=M.colorModeForRenderPass(),_e=new r.DepthMode(j.LEQUAL,r.DepthMode.ReadWrite,M.depthRangeFor3D);xa.update(U);const ue=M.transform,ye=6*Math.pow(1.5,22-ue.zoom)*S.exaggeration();(se?[!1,!0]:[!1]).forEach(ve=>{ne=-1;const Me=ve?j.LINES:j.TRIANGLES,[ge,Ce]=ve?S.getWirefameBuffer():[S.gridIndexBuffer,S.gridSegments];for(const Qe of L){const rt=C.getTile(Qe),ht=r.StencilMode.disabled,ct=S.prevTerrainTileForTile[Qe.key],Ft=S.terrainTileForTile[Qe.key];ku(ct,Ft)&&xa.newMorphing(Qe.key,ct,Ft,U,250),G.activeTexture.set(j.TEXTURE0),rt.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const $e=xa.getMorphValuesForProxy(Qe.key),kt=$e?1:0;let Ct;$e&&(Ct={morphing:{srcDemTile:$e.from,dstDemTile:$e.to,phase:r.easeCubicInOut($e.phase)}});const Qt=sg(Qe.projMatrix,Xd(Qe.canonical,ue.renderWorldCopies)?ye/10:ye);re(kt,ve),S.setupElevationDraw(rt,Y,Ct),M.prepareDrawProgram(G,Y,Qe.toUnwrapped()),Y.draw(G,Me,_e,ht,Q,r.CullFaceMode.backCCW,Qt,"terrain_raster",S.gridBuffer,ge,Ce)}})}}(d,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const d=this.painter,y=this.painter.context,M=this.proxySourceCache,S=this.proxiedCoords[M.id],C=this._drapedRenderBatches.shift(),L=[],U=d.style.order;let G=0;for(const j of S){const Y=M.getTileByID(j.proxyTileKey),ne=M.proxyCachedFBO[j.key]?M.proxyCachedFBO[j.key][o]:void 0,se=ne!==void 0?M.renderCache[ne]:this.pool[G++],re=ne!==void 0;if(Y.texture=se.tex,re&&!se.dirty){L.push(Y.tileID);continue}let Q;y.bindFramebuffer.set(se.fb.framebuffer),this.renderedToTile=!1,se.dirty&&(y.clear({color:r.Color.transparent,stencil:0}),se.dirty=!1);for(let _e=C.start;_e<=C.end;++_e){const ue=d.style._layers[U[_e]];if(ue.isHidden(d.transform.zoom))continue;const ye=d.style._getLayerSourceCache(ue),ve=ye?this.proxyToSource[j.key][ye.id]:[j];if(!ve)continue;const Me=ve;y.viewport.set([0,0,se.fb.width,se.fb.height]),Q!==(ye?ye.id:null)&&(this._setupStencil(se,ve,ue,ye),Q=ye?ye.id:null),d.renderLayer(d,ye,ue,Me)}this.renderedToTile?(se.dirty=!0,L.push(Y.tileID)):re||--G,G===5&&(G=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),C.end+1}postRender(){}renderCacheEfficiency(o){const d=o.order.length;if(d===0)return{efficiency:100};let y,M=0,S=0,C=!1;for(let L=0;L<d;++L){const U=o._layers[o.order[L]];this._style.isLayerDraped(U)?(C&&++M,++S):C||(C=!0,y=U.id)}return S===0?{efficiency:100}:{efficiency:100*(1-M/S),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{o=Math.min(o,d.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,d,y){if(!this._visibleDemTiles)return null;const M=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const C=S.tileID,L=Math.pow(2,C.overscaledZ),{x:U,y:G}=C.canonical,j=U/L,Y=(U+1)/L,ne=G/L,se=(G+1)/L;return{minx:j,miny:ne,maxx:Y,maxy:se,t:S.dem.tree.raycastRoot(j,ne,Y,se,o,d,y),tile:S}});M.sort((S,C)=>(S.t!==null?S.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const S of M){if(S.t==null)return null;const C=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,o,d,y);if(C!=null)return C}return null}_createFBO(){const o=this.painter.context,d=o.gl,y=this.drapeBufferSize;o.activeTexture.set(d.TEXTURE0);const M=new r.Texture(o,{width:y[0],height:y[1],data:null},d.RGBA);M.bind(d.LINEAR,d.CLAMP_TO_EDGE);const S=o.createFramebuffer(y[0],y[1],!1);return S.colorAttachment.set(M.texture),S.depthAttachment=new Lr(o,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:S,tex:M,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const d=this._style._layers[o],y=d.isHidden(this.painter.transform.zoom),M=d.getCrossfadeParameters(),S=!!M&&M.t!==1,C=d.hasTransition();return d.type!=="custom"&&!y&&(S||C)})}_clearRasterFadeFromRenderCache(){let o=!1;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d]._source instanceof J){o=!0;break}if(o)for(let d=0;d<this._style.order.length;++d){const y=this._style._layers[this._style.order[d]],M=y.isHidden(this.painter.transform.zoom),S=this._style._getLayerSourceCache(y);if(y.type!=="raster"||M||!S)continue;const C=y.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const U=this.proxyToSource[L.key][S.id];if(U)for(const G of U){const j=Kd(S.getTile(G),S.findLoadedParent(G,0),S,this.painter.transform,C);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(S.id,G)}}}}_setupDrapedRenderBatches(){const o=this._style.order,d=o.length;if(d===0)return;const y=[];let M,S=0,C=this._style._layers[o[S]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++S<d;)C=this._style._layers[o[S]];for(;S<d;++S){const L=this._style._layers[o[S]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?M===void 0&&(M=S):M!==void 0&&(y.push({start:M,end:S-1}),M=void 0))}M!==void 0&&y.push({start:M,end:S-1}),this._drapedRenderBatches=y}_setupRenderCache(o){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const C=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let L=0;L<C.length;++L){const U=Object.values(C[L]);d.renderCachePool.push(...U)}}return}this._clearRasterFadeFromRenderCache();const y=this.proxyCoords,M=this._tilesDirty;for(let C=y.length-1;C>=0;C--){const L=y[C];if(d.getTileByID(L.key),d.proxyCachedFBO[L.key]!==void 0){const U=o[L.key],G=this.proxyToSource[L.key];let j=0;for(const Y in G){const ne=G[Y],se=U[Y];if(!se||se.length!==ne.length||ne.some((re,Q)=>re!==se[Q]||M[Y]&&M[Y].hasOwnProperty(re.key))){j=-1;break}++j}for(const Y in d.proxyCachedFBO[L.key])d.renderCache[d.proxyCachedFBO[L.key][Y]].dirty=j<0||j!==Object.values(U).length}}const S=[...this._drapedRenderBatches];S.sort((C,L)=>L.end-L.start-(C.end-C.start));for(const C of S)for(const L of y){if(d.proxyCachedFBO[L.key])continue;let U=d.renderCachePool.pop();U===void 0&&d.renderCache.length<50&&(U=d.renderCache.length,d.renderCache.push(this._createFBO())),U!==void 0&&(d.proxyCachedFBO[L.key]={},d.proxyCachedFBO[L.key][C.start]=U,d.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(o,d,y,M){if(!M||!this._sourceTilesOverlap[M.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,C=S.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let L;if(y.isTileClipped())L=d.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs.get(o.key)||0),this._overlapStencilMode):r.StencilMode.disabled}_renderTileClippingMasks(o,d){const y=this.painter,M=this.painter.context,S=M.gl;y._tileClippingMaskIDs.clear(),M.setColorMode(r.ColorMode.disabled),M.setDepthMode(r.DepthMode.disabled);const C=y.useProgram("clippingMask");for(const L of o){const U=--d;y._tileClippingMaskIDs.set(L.key,U),C.draw(M,S.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:S.ALWAYS,mask:0},U,255,S.KEEP,S.KEEP,S.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,Bu(L.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(o){const d=this.painter.transform;if(o.x<0||o.x>d.width||o.y<0||o.y>d.height)return null;const y=[o.x,o.y,1,1];r.transformMat4$1(y,y,d.pixelMatrixInverse),r.scale$1(y,y,1/y[3]),y[0]/=d.worldSize,y[1]/=d.worldSize;const M=d._camera.position,S=r.mercatorZfromAltitude(1,d.center.lat),C=[M[0],M[1],M[2]/S,0],L=r.subtract([],y.slice(0,3),C);r.normalize(L,L);const U=this.raycast(C,L,this._exaggeration);return U!==null&&U?(r.scaleAndAdd(C,C,L,U),C[3]=C[2],C[2]*=S,C):null}drawDepth(){const o=this.painter,d=o.context,y=this.proxySourceCache,M=Math.ceil(o.width),S=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===M&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const C=d.gl,L=d.createFramebuffer(M,S,!0);d.activeTexture.set(C.TEXTURE0);const U=new r.Texture(d,{width:M,height:S,data:null},C.RGBA);U.bind(C.NEAREST,C.CLAMP_TO_EDGE),L.colorAttachment.set(U.texture);const G=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,M,S);L.depthAttachment.set(G),this._depthFBO=L,this._depthTexture=U}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,M,S]),function(C,L,U,G){if(C.transform.projection.name==="globe")return;const j=C.context,Y=j.gl;j.clear({depth:1});const ne=C.useProgram("terrainDepth"),se=new r.DepthMode(Y.LESS,r.DepthMode.ReadWrite,C.depthRangeFor3D);for(const re of G){const Q=U.getTile(re),_e=sg(re.projMatrix,0);L.setupElevationDraw(Q,ne),ne.draw(j,Y.TRIANGLES,se,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.backCCW,_e,"terrain_depth",L.gridBuffer,L.gridIndexBuffer,L.gridNoSkirtSegments)}}(o,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,d,y){if(o.getSource()instanceof Fe)return this._setupProxiedCoordsForImageSource(o,d,y);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const M=this.proxiedCoords[o.id]=[],S=this.proxyCoords;for(let L=0;L<S.length;L++){const U=S[L],G=this._findTileCoveringTileID(U,o);if(G){const j=this._createProxiedId(U,G,y[U.key]&&y[U.key][o.id]);M.push(j),this.proxyToSource[U.key][o.id]=[j]}}let C=!1;for(let L=0;L<d.length;L++){const U=o.getTile(d[L]);if(!U||!U.hasData())continue;const G=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==U.tileID.canonical.z){const j=this.proxyToSource[G.tileID.key][o.id],Y=this._createProxiedId(G.tileID,U,y[G.tileID.key]&&y[G.tileID.key][o.id]);j?j.splice(j.length-1,0,Y):this.proxyToSource[G.tileID.key][o.id]=[Y],M.push(Y),C=!0}}this._sourceTilesOverlap[o.id]=C}_setupProxiedCoordsForImageSource(o,d,y){if(!o.getSource().loaded())return;const M=this.proxiedCoords[o.id]=[],S=this.proxyCoords,C=o.getSource(),L=new r.pointGeometry(C.tileID.x,C.tileID.y)._div(1<<C.tileID.z),U=C.coordinates.map(r.MercatorCoordinate.fromLngLat).reduce((j,Y)=>(j.min.x=Math.min(j.min.x,Y.x-L.x),j.min.y=Math.min(j.min.y,Y.y-L.y),j.max.x=Math.max(j.max.x,Y.x-L.x),j.max.y=Math.max(j.max.y,Y.y-L.y),j),{min:new r.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(j,Y)=>{const ne=j.wrap+j.canonical.x/(1<<j.canonical.z),se=j.canonical.y/(1<<j.canonical.z),re=r.EXTENT/(1<<j.canonical.z),Q=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),_e=Y.canonical.y/(1<<Y.canonical.z);return ne+re<Q+U.min.x||ne>Q+U.max.x||se+re<_e+U.min.y||se>_e+U.max.y};for(let j=0;j<S.length;j++){const Y=S[j];for(let ne=0;ne<d.length;ne++){const se=o.getTile(d[ne]);if(!se||!se.hasData()||G(Y,se.tileID))continue;const re=this._createProxiedId(Y,se,y[Y.key]&&y[Y.key][o.id]),Q=this.proxyToSource[Y.key][o.id];Q?Q.push(re):this.proxyToSource[Y.key][o.id]=[re],M.push(re)}}}_createProxiedId(o,d,y){let M=this.orthoMatrix;if(y){const S=y.find(C=>C.key===d.tileID.key);if(S)return S}if(d.tileID.key!==o.key){const S=o.canonical.z-d.tileID.canonical.z;let C,L,U;M=r.create();const G=d.tileID.wrap-o.wrap<<o.overscaledZ;S>0?(C=r.EXTENT>>S,L=C*((d.tileID.canonical.x<<S)-o.canonical.x+G),U=C*((d.tileID.canonical.y<<S)-o.canonical.y)):(C=r.EXTENT<<-S,L=r.EXTENT*(d.tileID.canonical.x-(o.canonical.x+G<<-S)),U=r.EXTENT*(d.tileID.canonical.y-(o.canonical.y<<-S))),r.ortho(M,0,C,0,C,0,1),r.translate(M,M,[L,U,0])}return new Zd(d.tileID,o.key,M)}_findTileCoveringTileID(o,d){let y=d.getTile(o);if(y&&y.hasData())return y;const M=this._findCoveringTileCache[d.id],S=M[o.key];if(y=S?d.getTileByID(S):null,y&&y.hasData()||S===null)return y;let C=y?y.tileID:o,L=C.overscaledZ;const U=d.getSource().minzoom,G=[];if(!S){const Y=d.getSource().maxzoom;if(o.canonical.z>=Y){const ne=o.canonical.z-Y;d.getSource().reparseOverscaled?(L=Math.max(o.canonical.z+2,d.transform.tileZoom),C=new r.OverscaledTileID(L,o.wrap,Y,o.canonical.x>>ne,o.canonical.y>>ne)):ne!==0&&(L=Y,C=new r.OverscaledTileID(L,o.wrap,Y,o.canonical.x>>ne,o.canonical.y>>ne))}C.key!==o.key&&(G.push(C.key),y=d.getTile(C))}const j=Y=>{G.forEach(ne=>{M[ne]=Y}),G.length=0};for(L-=1;L>=U&&(!y||!y.hasData());L--){y&&j(y.tileID.key);const Y=C.calculateScaledKey(L);if(y=d.getTileByID(Y),y&&y.hasData())break;const ne=M[Y];if(ne===null)break;ne===void 0?G.push(Y):y=d.getTileByID(ne)}return j(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,d){let y=this._tilesDirty[o];y||(y=this._tilesDirty[o]={}),y[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(d){let y=0;const M=new r.StructArrayLayout2ui4,S=131;for(let C=1;C<129;C++){for(let L=1;L<129;L++)y=C*S+L,M.emplaceBack(y,y+1),M.emplaceBack(y,y+S),M.emplaceBack(y+1,y+S),C===128&&M.emplaceBack(y+S,y+S+1);M.emplaceBack(y+1,y+1+S)}return M}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=r.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function zu(m){const o=[];for(let d=0;d<m.length;d++){if(m[d]===null)continue;const y=m[d].split(" ");o.push(y.pop())}return o}class jl{static cacheKey(o,d,y){let M=`${o}${y?y.cacheKey:""}`;for(const S of d)M+=`/${S}`;return M}constructor(o,d,y,M,S,C){const L=o.gl;this.program=L.createProgram();const U=zu(y.staticAttributes),G=M?M.getBinderAttributes():[],j=U.concat(G),Y=y.staticUniforms?zu(y.staticUniforms):[],ne=M?M.getBinderUniforms():[],se=Y.concat(ne),re=[];for(const ge of se)re.indexOf(ge)<0&&re.push(ge);let Q=M?M.defines():[];Q=Q.concat(C.map(ge=>`#define ${ge}`));const _e=Q.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Nl,Lu.fragmentSource,ya.fragmentSource,y.fragmentSource).join(`
`),ue=Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Nl,Lu.vertexSource,ya.vertexSource,Qa.vertexSource,y.vertexSource).join(`
`),ye=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(ye,_e),L.compileShader(ye),L.attachShader(this.program,ye);const ve=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(ve,ue),L.compileShader(ve),L.attachShader(this.program,ve),this.attributes={};const Me={};this.numAttributes=j.length;for(let ge=0;ge<this.numAttributes;ge++)j[ge]&&(L.bindAttribLocation(this.program,ge,j[ge]),this.attributes[j[ge]]=ge);L.linkProgram(this.program),L.deleteShader(ve),L.deleteShader(ye);for(let ge=0;ge<re.length;ge++){const Ce=re[ge];if(Ce&&!Me[Ce]){const Qe=L.getUniformLocation(this.program,Ce);Qe&&(Me[Ce]=Qe)}}this.fixedUniforms=S(o,Me),this.binderUniforms=M?M.getUniforms(o,Me):[],C.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((ge,Ce)=>({u_dem:new r.Uniform1i(ge,Ce.u_dem),u_dem_prev:new r.Uniform1i(ge,Ce.u_dem_prev),u_dem_unpack:new r.Uniform4f(ge,Ce.u_dem_unpack),u_dem_tl:new r.Uniform2f(ge,Ce.u_dem_tl),u_dem_scale:new r.Uniform1f(ge,Ce.u_dem_scale),u_dem_tl_prev:new r.Uniform2f(ge,Ce.u_dem_tl_prev),u_dem_scale_prev:new r.Uniform1f(ge,Ce.u_dem_scale_prev),u_dem_size:new r.Uniform1f(ge,Ce.u_dem_size),u_dem_lerp:new r.Uniform1f(ge,Ce.u_dem_lerp),u_exaggeration:new r.Uniform1f(ge,Ce.u_exaggeration),u_depth:new r.Uniform1i(ge,Ce.u_depth),u_depth_size_inv:new r.Uniform2f(ge,Ce.u_depth_size_inv),u_meter_to_dem:new r.Uniform1f(ge,Ce.u_meter_to_dem),u_label_plane_matrix_inv:new r.UniformMatrix4f(ge,Ce.u_label_plane_matrix_inv),u_tile_tl_up:new r.Uniform3f(ge,Ce.u_tile_tl_up),u_tile_tr_up:new r.Uniform3f(ge,Ce.u_tile_tr_up),u_tile_br_up:new r.Uniform3f(ge,Ce.u_tile_br_up),u_tile_bl_up:new r.Uniform3f(ge,Ce.u_tile_bl_up),u_tile_up_scale:new r.Uniform1f(ge,Ce.u_tile_up_scale)}))(o,Me)),C.indexOf("FOG")!==-1&&(this.fogUniforms=((ge,Ce)=>({u_fog_matrix:new r.UniformMatrix4f(ge,Ce.u_fog_matrix),u_fog_range:new r.Uniform2f(ge,Ce.u_fog_range),u_fog_color:new r.Uniform4f(ge,Ce.u_fog_color),u_fog_horizon_blend:new r.Uniform1f(ge,Ce.u_fog_horizon_blend),u_fog_temporal_offset:new r.Uniform1f(ge,Ce.u_fog_temporal_offset)}))(o,Me))}setTerrainUniformValues(o,d){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const M in d)y[M].set(d[M])}}setFogUniformValues(o,d){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const M in d)y[M].location&&y[M].set(d[M])}}draw(o,d,y,M,S,C,L,U,G,j,Y,ne,se,re,Q,_e){const ue=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(y),o.setStencilMode(M),o.setColorMode(S),o.setCullFace(C);for(const ve of Object.keys(this.fixedUniforms))this.fixedUniforms[ve].set(L[ve]);re&&re.setUniforms(o,this.binderUniforms,ne,{zoom:se});const ye={[ue.LINES]:2,[ue.TRIANGLES]:3,[ue.LINE_STRIP]:1}[d];for(const ve of Y.get()){const Me=ve.vaos||(ve.vaos={});(Me[U]||(Me[U]=new Fu)).bind(o,this,G,re?re.getPaintVertexBuffers():[],j,ve.vertexOffset,Q,_e),ue.drawElements(d,ve.primitiveLength*ye,ue.UNSIGNED_SHORT,ve.primitiveOffset*ye*2)}}}function Hl(m,o,d){const y=1/ke(d,1,o.transform.tileZoom),M=Math.pow(2,d.tileID.overscaledZ),S=d.tileSize*Math.pow(2,o.transform.tileZoom)/M,C=S*(d.tileID.canonical.x+d.tileID.wrap*M),L=S*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[y,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[C>>16,L>>16],u_pixel_coord_lower:[65535&C,65535&L]}}const Jd=r.create(),Uu=(m,o,d,y,M,S,C,L,U)=>{const G=o.style.light,j=G.properties.get("position"),Y=[j.x,j.y,j.z],ne=r.create$1();G.properties.get("anchor")==="viewport"&&(r.fromRotation(ne,-o.transform.angle),r.transformMat3(Y,Y,ne));const se=G.properties.get("color"),re=o.transform,Q={u_matrix:m,u_lightpos:Y,u_lightintensity:G.properties.get("intensity"),u_lightcolor:[se.r,se.g,se.b],u_vertical_gradient:+d,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jd,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return re.projection.name==="globe"&&(Q.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],Q.u_zoom_transition=C,Q.u_inv_rot_matrix=U,Q.u_merc_center=L,Q.u_up_dir=re.projection.upVector(new r.CanonicalTileID(0,0,0),L[0]*r.EXTENT,L[1]*r.EXTENT),Q.u_height_lift=S),Q},Nu=(m,o,d,y,M,S,C,L,U,G,j)=>{const Y=Uu(m,o,d,y,M,L,U,G,j),ne={u_height_factor:-Math.pow(2,M.overscaledZ)/C.tileSize/8};return r.extend(Y,Hl(S,o,C),ne)},Vu=m=>({u_matrix:m}),Ou=(m,o,d,y)=>r.extend(Vu(m),Hl(d,o,y)),Gu=(m,o)=>({u_matrix:m,u_world:o}),cg=(m,o,d,y,M)=>r.extend(Ou(m,o,d,y),{u_world:M}),ug=r.create(),Vs=(m,o,d,y,M,S)=>{const C=m.transform,L=C.projection.name==="globe";let U;if(S.paint.get("circle-pitch-alignment")==="map")if(L){const j=r.globePixelsToTileUnits(C.zoom,o.canonical);U=Float32Array.from([j,0,0,j])}else U=C.calculatePixelsToTileUnitsMatrix(d);else U=new Float32Array([C.pixelsToGLUnits[0],0,0,C.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:C.cameraToCenterDistance,u_matrix:m.translatePosMatrix(o.projMatrix,d,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:r.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:ug,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return L&&(G.u_inv_rot_matrix=y,G.u_merc_center=M,G.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],G.u_zoom_transition=r.globeToMercatorTransition(C.zoom),G.u_up_dir=C.projection.upVector(o.canonical,M[0],M[1])),G},Vx=m=>{const o=[];return m.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},Ox=(m,o,d)=>{const y=r.EXTENT/d.tileSize;return{u_matrix:m,u_camera_to_center_distance:o.cameraToCenterDistance,u_extrude_scale:[o.pixelsToGLUnits[0]/y,o.pixelsToGLUnits[1]/y]}},hg=(m,o,d=1)=>({u_matrix:m,u_color:o,u_overlay:0,u_overlay_scale:d}),Gx=r.create(),jx=(m,o,d,y,M,S,C)=>{const L=m.transform,U=L.projection.name==="globe",G=U?r.globePixelsToTileUnits(L.zoom,o.canonical):ke(d,1,S),j={u_matrix:o.projMatrix,u_extrude_scale:G,u_intensity:C,u_inv_rot_matrix:Gx,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return U&&(j.u_inv_rot_matrix=y,j.u_merc_center=M,j.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],j.u_zoom_transition=r.globeToMercatorTransition(L.zoom),j.u_up_dir=L.projection.upVector(o.canonical,M[0],M[1])),j},Hx=(m,o,d,y,M,S,C)=>{const L=m.transform,U=L.calculatePixelsToTileUnitsMatrix(o),G={u_matrix:$a(m,o,d,M),u_pixels_to_tile_units:U,u_device_pixel_ratio:C,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if($d(d)){const j=ju(o,m.transform);G.u_texsize=o.lineAtlasTexture.size,G.u_scale=[j,y.fromScale,y.toScale],G.u_mix=y.t}return G},Qd=(m,o,d,y,M,S)=>{const C=m.transform,L=ju(o,C);return{u_matrix:$a(m,o,d,M),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:S,u_image:0,u_scale:[L,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ju(m,o){return 1/ke(m,1,o.tileZoom)}function $a(m,o,d,y){return m.translatePosMatrix(y||o.tileID.projMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}function $d(m){const o=m.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const dg=(m,o,d,y,M,S)=>{return{u_matrix:m,u_tl_parent:o,u_scale_parent:d,u_fade_t:y.mix,u_opacity:y.opacity*M.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:M.paint.get("raster-brightness-min"),u_brightness_high:M.paint.get("raster-brightness-max"),u_saturation_factor:(L=M.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(C=M.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:ep(M.paint.get("raster-hue-rotate")),u_perspective_transform:S};var C,L};function ep(m){m*=Math.PI/180;const o=Math.sin(m),d=Math.cos(m);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const va=r.create(),tp=(m,o,d,y,M,S,C,L,U,G,j,Y,ne,se)=>{const re=M.transform,Q={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_rotate_symbol:+d,u_aspect_ratio:re.width/re.height,u_fade_change:M.options.fadeDuration?M.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:C,u_coord_matrix:L,u_is_text:+U,u_pitch_with_map:+y,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:va,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:va};return re.projection.name==="globe"&&(Q.u_tile_id=[j.canonical.x,j.canonical.y,1<<j.canonical.z],Q.u_zoom_transition=Y,Q.u_inv_rot_matrix=se,Q.u_merc_center=ne,Q.u_camera_forward=re._camera.forward(),Q.u_ecef_origin=r.globeECEFOrigin(re.globeMatrix,j.toUnwrapped()),Q.u_tile_matrix=Float32Array.from(re.globeMatrix)),Q},es=(m,o,d,y,M,S,C,L,U,G,j,Y,ne,se,re)=>{const{cameraToCenterDistance:Q,_pitch:_e}=M.transform;return r.extend(tp(m,o,d,y,M,S,C,L,U,G,Y,ne,se,re),{u_gamma_scale:y?Q*Math.cos(M.terrain?0:_e):1,u_device_pixel_ratio:r.exported.devicePixelRatio,u_is_halo:+j})},Os=(m,o,d,y,M,S,C,L,U,G,j,Y,ne,se)=>r.extend(es(m,o,d,y,M,S,C,L,!0,U,!0,j,Y,ne,se),{u_texsize_icon:G,u_texture_icon:1}),pg=(m,o,d)=>({u_matrix:m,u_opacity:o,u_color:d}),np=(m,o,d,y,M,S)=>r.extend(function(C,L,U,G){const j=U.imageManager.getPattern(C.from.toString()),Y=U.imageManager.getPattern(C.to.toString()),{width:ne,height:se}=U.imageManager.getPixelSize(),re=Math.pow(2,G.tileID.overscaledZ),Q=G.tileSize*Math.pow(2,U.transform.tileZoom)/re,_e=Q*(G.tileID.canonical.x+G.tileID.wrap*re),ue=Q*G.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[ne,se],u_mix:L.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:L.fromScale,u_scale_b:L.toScale,u_tile_units_to_pixels:1/ke(G,1,U.transform.tileZoom),u_pixel_coord_upper:[_e>>16,ue>>16],u_pixel_coord_lower:[65535&_e,65535&ue]}}(y,S,d,M),{u_matrix:m,u_opacity:o}),ri={fillExtrusion:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_lightpos:new r.Uniform3f(m,o.u_lightpos),u_lightintensity:new r.Uniform1f(m,o.u_lightintensity),u_lightcolor:new r.Uniform3f(m,o.u_lightcolor),u_vertical_gradient:new r.Uniform1f(m,o.u_vertical_gradient),u_opacity:new r.Uniform1f(m,o.u_opacity),u_tile_id:new r.Uniform3f(m,o.u_tile_id),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(m,o.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_up_dir:new r.Uniform3f(m,o.u_up_dir),u_height_lift:new r.Uniform1f(m,o.u_height_lift)}),fillExtrusionPattern:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_lightpos:new r.Uniform3f(m,o.u_lightpos),u_lightintensity:new r.Uniform1f(m,o.u_lightintensity),u_lightcolor:new r.Uniform3f(m,o.u_lightcolor),u_vertical_gradient:new r.Uniform1f(m,o.u_vertical_gradient),u_height_factor:new r.Uniform1f(m,o.u_height_factor),u_tile_id:new r.Uniform3f(m,o.u_tile_id),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(m,o.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_up_dir:new r.Uniform3f(m,o.u_up_dir),u_height_lift:new r.Uniform1f(m,o.u_height_lift),u_image:new r.Uniform1i(m,o.u_image),u_texsize:new r.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new r.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new r.Uniform3f(m,o.u_scale),u_fade:new r.Uniform1f(m,o.u_fade),u_opacity:new r.Uniform1f(m,o.u_opacity)}),fill:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix)}),fillPattern:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_image:new r.Uniform1i(m,o.u_image),u_texsize:new r.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new r.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new r.Uniform3f(m,o.u_scale),u_fade:new r.Uniform1f(m,o.u_fade)}),fillOutline:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_world:new r.Uniform2f(m,o.u_world)}),fillOutlinePattern:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_world:new r.Uniform2f(m,o.u_world),u_image:new r.Uniform1i(m,o.u_image),u_texsize:new r.Uniform2f(m,o.u_texsize),u_pixel_coord_upper:new r.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(m,o.u_pixel_coord_lower),u_scale:new r.Uniform3f(m,o.u_scale),u_fade:new r.Uniform1f(m,o.u_fade)}),circle:(m,o)=>({u_camera_to_center_distance:new r.Uniform1f(m,o.u_camera_to_center_distance),u_extrude_scale:new r.UniformMatrix2f(m,o.u_extrude_scale),u_device_pixel_ratio:new r.Uniform1f(m,o.u_device_pixel_ratio),u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_inv_rot_matrix:new r.UniformMatrix4f(m,o.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_tile_id:new r.Uniform3f(m,o.u_tile_id),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_up_dir:new r.Uniform3f(m,o.u_up_dir)}),collisionBox:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_camera_to_center_distance:new r.Uniform1f(m,o.u_camera_to_center_distance),u_extrude_scale:new r.Uniform2f(m,o.u_extrude_scale)}),collisionCircle:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_inv_matrix:new r.UniformMatrix4f(m,o.u_inv_matrix),u_camera_to_center_distance:new r.Uniform1f(m,o.u_camera_to_center_distance),u_viewport_size:new r.Uniform2f(m,o.u_viewport_size)}),debug:(m,o)=>({u_color:new r.UniformColor(m,o.u_color),u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_overlay:new r.Uniform1i(m,o.u_overlay),u_overlay_scale:new r.Uniform1f(m,o.u_overlay_scale)}),clippingMask:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix)}),heatmap:(m,o)=>({u_extrude_scale:new r.Uniform1f(m,o.u_extrude_scale),u_intensity:new r.Uniform1f(m,o.u_intensity),u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_inv_rot_matrix:new r.UniformMatrix4f(m,o.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_tile_id:new r.Uniform3f(m,o.u_tile_id),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_up_dir:new r.Uniform3f(m,o.u_up_dir)}),heatmapTexture:(m,o)=>({u_image:new r.Uniform1i(m,o.u_image),u_color_ramp:new r.Uniform1i(m,o.u_color_ramp),u_opacity:new r.Uniform1f(m,o.u_opacity)}),hillshade:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_image:new r.Uniform1i(m,o.u_image),u_latrange:new r.Uniform2f(m,o.u_latrange),u_light:new r.Uniform2f(m,o.u_light),u_shadow:new r.UniformColor(m,o.u_shadow),u_highlight:new r.UniformColor(m,o.u_highlight),u_accent:new r.UniformColor(m,o.u_accent)}),hillshadePrepare:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_image:new r.Uniform1i(m,o.u_image),u_dimension:new r.Uniform2f(m,o.u_dimension),u_zoom:new r.Uniform1f(m,o.u_zoom),u_unpack:new r.Uniform4f(m,o.u_unpack)}),line:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_pixels_to_tile_units:new r.UniformMatrix2f(m,o.u_pixels_to_tile_units),u_device_pixel_ratio:new r.Uniform1f(m,o.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(m,o.u_units_to_pixels),u_dash_image:new r.Uniform1i(m,o.u_dash_image),u_gradient_image:new r.Uniform1i(m,o.u_gradient_image),u_image_height:new r.Uniform1f(m,o.u_image_height),u_texsize:new r.Uniform2f(m,o.u_texsize),u_scale:new r.Uniform3f(m,o.u_scale),u_mix:new r.Uniform1f(m,o.u_mix),u_alpha_discard_threshold:new r.Uniform1f(m,o.u_alpha_discard_threshold)}),linePattern:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_texsize:new r.Uniform2f(m,o.u_texsize),u_pixels_to_tile_units:new r.UniformMatrix2f(m,o.u_pixels_to_tile_units),u_device_pixel_ratio:new r.Uniform1f(m,o.u_device_pixel_ratio),u_image:new r.Uniform1i(m,o.u_image),u_units_to_pixels:new r.Uniform2f(m,o.u_units_to_pixels),u_scale:new r.Uniform3f(m,o.u_scale),u_fade:new r.Uniform1f(m,o.u_fade),u_alpha_discard_threshold:new r.Uniform1f(m,o.u_alpha_discard_threshold)}),raster:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_tl_parent:new r.Uniform2f(m,o.u_tl_parent),u_scale_parent:new r.Uniform1f(m,o.u_scale_parent),u_fade_t:new r.Uniform1f(m,o.u_fade_t),u_opacity:new r.Uniform1f(m,o.u_opacity),u_image0:new r.Uniform1i(m,o.u_image0),u_image1:new r.Uniform1i(m,o.u_image1),u_brightness_low:new r.Uniform1f(m,o.u_brightness_low),u_brightness_high:new r.Uniform1f(m,o.u_brightness_high),u_saturation_factor:new r.Uniform1f(m,o.u_saturation_factor),u_contrast_factor:new r.Uniform1f(m,o.u_contrast_factor),u_spin_weights:new r.Uniform3f(m,o.u_spin_weights),u_perspective_transform:new r.Uniform2f(m,o.u_perspective_transform)}),symbolIcon:(m,o)=>({u_is_size_zoom_constant:new r.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new r.Uniform1f(m,o.u_size_t),u_size:new r.Uniform1f(m,o.u_size),u_camera_to_center_distance:new r.Uniform1f(m,o.u_camera_to_center_distance),u_rotate_symbol:new r.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new r.Uniform1f(m,o.u_fade_change),u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new r.Uniform1i(m,o.u_is_text),u_pitch_with_map:new r.Uniform1i(m,o.u_pitch_with_map),u_texsize:new r.Uniform2f(m,o.u_texsize),u_tile_id:new r.Uniform3f(m,o.u_tile_id),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(m,o.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_camera_forward:new r.Uniform3f(m,o.u_camera_forward),u_tile_matrix:new r.UniformMatrix4f(m,o.u_tile_matrix),u_ecef_origin:new r.Uniform3f(m,o.u_ecef_origin),u_texture:new r.Uniform1i(m,o.u_texture)}),symbolSDF:(m,o)=>({u_is_size_zoom_constant:new r.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new r.Uniform1f(m,o.u_size_t),u_size:new r.Uniform1f(m,o.u_size),u_camera_to_center_distance:new r.Uniform1f(m,o.u_camera_to_center_distance),u_rotate_symbol:new r.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new r.Uniform1f(m,o.u_fade_change),u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new r.Uniform1i(m,o.u_is_text),u_pitch_with_map:new r.Uniform1i(m,o.u_pitch_with_map),u_texsize:new r.Uniform2f(m,o.u_texsize),u_texture:new r.Uniform1i(m,o.u_texture),u_gamma_scale:new r.Uniform1f(m,o.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(m,o.u_device_pixel_ratio),u_tile_id:new r.Uniform3f(m,o.u_tile_id),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_inv_rot_matrix:new r.UniformMatrix4f(m,o.u_inv_rot_matrix),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_camera_forward:new r.Uniform3f(m,o.u_camera_forward),u_tile_matrix:new r.UniformMatrix4f(m,o.u_tile_matrix),u_ecef_origin:new r.Uniform3f(m,o.u_ecef_origin),u_is_halo:new r.Uniform1i(m,o.u_is_halo)}),symbolTextAndIcon:(m,o)=>({u_is_size_zoom_constant:new r.Uniform1i(m,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(m,o.u_is_size_feature_constant),u_size_t:new r.Uniform1f(m,o.u_size_t),u_size:new r.Uniform1f(m,o.u_size),u_camera_to_center_distance:new r.Uniform1f(m,o.u_camera_to_center_distance),u_rotate_symbol:new r.Uniform1i(m,o.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(m,o.u_aspect_ratio),u_fade_change:new r.Uniform1f(m,o.u_fade_change),u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(m,o.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(m,o.u_coord_matrix),u_is_text:new r.Uniform1i(m,o.u_is_text),u_pitch_with_map:new r.Uniform1i(m,o.u_pitch_with_map),u_texsize:new r.Uniform2f(m,o.u_texsize),u_texsize_icon:new r.Uniform2f(m,o.u_texsize_icon),u_texture:new r.Uniform1i(m,o.u_texture),u_texture_icon:new r.Uniform1i(m,o.u_texture_icon),u_gamma_scale:new r.Uniform1f(m,o.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(m,o.u_device_pixel_ratio),u_is_halo:new r.Uniform1i(m,o.u_is_halo)}),background:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_opacity:new r.Uniform1f(m,o.u_opacity),u_color:new r.UniformColor(m,o.u_color)}),backgroundPattern:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_opacity:new r.Uniform1f(m,o.u_opacity),u_image:new r.Uniform1i(m,o.u_image),u_pattern_tl_a:new r.Uniform2f(m,o.u_pattern_tl_a),u_pattern_br_a:new r.Uniform2f(m,o.u_pattern_br_a),u_pattern_tl_b:new r.Uniform2f(m,o.u_pattern_tl_b),u_pattern_br_b:new r.Uniform2f(m,o.u_pattern_br_b),u_texsize:new r.Uniform2f(m,o.u_texsize),u_mix:new r.Uniform1f(m,o.u_mix),u_pattern_size_a:new r.Uniform2f(m,o.u_pattern_size_a),u_pattern_size_b:new r.Uniform2f(m,o.u_pattern_size_b),u_scale_a:new r.Uniform1f(m,o.u_scale_a),u_scale_b:new r.Uniform1f(m,o.u_scale_b),u_pixel_coord_upper:new r.Uniform2f(m,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(m,o.u_pixel_coord_lower),u_tile_units_to_pixels:new r.Uniform1f(m,o.u_tile_units_to_pixels)}),terrainRaster:Yd,terrainDepth:Yd,skybox:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_sun_direction:new r.Uniform3f(m,o.u_sun_direction),u_cubemap:new r.Uniform1i(m,o.u_cubemap),u_opacity:new r.Uniform1f(m,o.u_opacity),u_temporal_offset:new r.Uniform1f(m,o.u_temporal_offset)}),skyboxGradient:(m,o)=>({u_matrix:new r.UniformMatrix4f(m,o.u_matrix),u_color_ramp:new r.Uniform1i(m,o.u_color_ramp),u_center_direction:new r.Uniform3f(m,o.u_center_direction),u_radius:new r.Uniform1f(m,o.u_radius),u_opacity:new r.Uniform1f(m,o.u_opacity),u_temporal_offset:new r.Uniform1f(m,o.u_temporal_offset)}),skyboxCapture:(m,o)=>({u_matrix_3f:new r.UniformMatrix3f(m,o.u_matrix_3f),u_sun_direction:new r.Uniform3f(m,o.u_sun_direction),u_sun_intensity:new r.Uniform1f(m,o.u_sun_intensity),u_color_tint_r:new r.Uniform4f(m,o.u_color_tint_r),u_color_tint_m:new r.Uniform4f(m,o.u_color_tint_m),u_luminance:new r.Uniform1f(m,o.u_luminance)}),globeRaster:(m,o)=>({u_proj_matrix:new r.UniformMatrix4f(m,o.u_proj_matrix),u_globe_matrix:new r.UniformMatrix4f(m,o.u_globe_matrix),u_merc_matrix:new r.UniformMatrix4f(m,o.u_merc_matrix),u_zoom_transition:new r.Uniform1f(m,o.u_zoom_transition),u_merc_center:new r.Uniform2f(m,o.u_merc_center),u_image0:new r.Uniform1i(m,o.u_image0),u_grid_matrix:new r.UniformMatrix3f(m,o.u_grid_matrix)}),globeAtmosphere:(m,o)=>({u_frustum_tl:new r.Uniform3f(m,o.u_frustum_tl),u_frustum_tr:new r.Uniform3f(m,o.u_frustum_tr),u_frustum_br:new r.Uniform3f(m,o.u_frustum_br),u_frustum_bl:new r.Uniform3f(m,o.u_frustum_bl),u_globe_pos:new r.Uniform3f(m,o.u_globe_pos),u_globe_radius:new r.Uniform1f(m,o.u_globe_radius),u_opacity:new r.Uniform1f(m,o.u_opacity),u_fadeout_range:new r.Uniform1f(m,o.u_fadeout_range),u_start_color:new r.Uniform3f(m,o.u_start_color),u_end_color:new r.Uniform3f(m,o.u_end_color)})};let ts;function fg(m,o,d,y,M,S,C){const L=m.context,U=L.gl,G=m.useProgram("collisionBox"),j=[];let Y=0,ne=0;for(let ve=0;ve<y.length;ve++){const Me=y[ve],ge=o.getTile(Me),Ce=ge.getBucket(d);if(!Ce)continue;let Qe=Me.projMatrix;M[0]===0&&M[1]===0||(Qe=m.translatePosMatrix(Me.projMatrix,ge,M,S));const rt=C?Ce.textCollisionBox:Ce.iconCollisionBox,ht=Ce.collisionCircleArray;if(ht.length>0){const ct=r.create(),Ft=Qe;r.mul(ct,Ce.placementInvProjMatrix,m.transform.glCoordMatrix),r.mul(ct,ct,Ce.placementViewportMatrix),j.push({circleArray:ht,circleOffset:ne,transform:Ft,invTransform:ct}),Y+=ht.length/4,ne=Y}rt&&(m.terrain&&m.terrain.setupElevationDraw(ge,G),G.draw(L,U.LINES,r.DepthMode.disabled,r.StencilMode.disabled,m.colorModeForRenderPass(),r.CullFaceMode.disabled,Ox(Qe,m.transform,ge),d.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,null,m.transform.zoom,null,rt.collisionVertexBuffer,rt.collisionVertexBufferExt))}if(!C||!j.length)return;const se=m.useProgram("collisionCircle"),re=new r.StructArrayLayout2f1f2i16;re.resize(4*Y),re._trim();let Q=0;for(const ve of j)for(let Me=0;Me<ve.circleArray.length/4;Me++){const ge=4*Me,Ce=ve.circleArray[ge+0],Qe=ve.circleArray[ge+1],rt=ve.circleArray[ge+2],ht=ve.circleArray[ge+3];re.emplace(Q++,Ce,Qe,rt,ht,0),re.emplace(Q++,Ce,Qe,rt,ht,1),re.emplace(Q++,Ce,Qe,rt,ht,2),re.emplace(Q++,Ce,Qe,rt,ht,3)}(!ts||ts.length<2*Y)&&(ts=function(ve){const Me=2*ve,ge=new r.StructArrayLayout3ui6;ge.resize(Me),ge._trim();for(let Ce=0;Ce<Me;Ce++){const Qe=6*Ce;ge.uint16[Qe+0]=4*Ce+0,ge.uint16[Qe+1]=4*Ce+1,ge.uint16[Qe+2]=4*Ce+2,ge.uint16[Qe+3]=4*Ce+2,ge.uint16[Qe+4]=4*Ce+3,ge.uint16[Qe+5]=4*Ce+0}return ge}(Y));const _e=L.createIndexBuffer(ts,!0),ue=L.createVertexBuffer(re,r.collisionCircleLayout.members,!0);for(const ve of j){const Me={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(ye=m.transform).cameraToCenterDistance,u_viewport_size:[ye.width,ye.height]};se.draw(L,U.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,m.colorModeForRenderPass(),r.CullFaceMode.disabled,Me,d.id,ue,_e,r.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,m.transform.zoom,null,null,null)}var ye;ue.destroy(),_e.destroy()}const ip=r.create();function Wl(m,o,d,y,M,S){const{horizontalAlign:C,verticalAlign:L}=r.getAnchorAlignment(m),U=-(C-.5)*o,G=-(L-.5)*d,j=r.evaluateVariableOffset(m,y);return new r.pointGeometry((U/M+j[0])*S,(G/M+j[1])*S)}function Wx(m,o,d,y,M,S,C,L,U,G,j,Y){const ne=m.text.placedSymbolArray,se=m.text.dynamicLayoutVertexArray,re=m.icon.dynamicLayoutVertexArray,Q={},_e=L.projMatrix,ue=S.elevation,ye=Y.upVectorScale(L.canonical,S.center.lat,S.worldSize);se.clear();for(let ve=0;ve<ne.length;ve++){const Me=ne.get(ve),ge=m.allowVerticalPlacement&&!Me.placedOrientation,Ce=Me.hidden||!Me.crossTileID||ge?null:y[Me.crossTileID];if(Ce){const Qe=new r.pointGeometry(Me.tileAnchorX,Me.tileAnchorY),rt=Y.upVector(L.canonical,Qe.x,Qe.y),ht=ue?ue.getAtTileOffset(L,Qe.x,Qe.y):0,ct=fi([Me.projectedAnchorX+ht*rt[0]*ye.metersToTile,Me.projectedAnchorY+ht*rt[1]*ye.metersToTile,Me.projectedAnchorZ+ht*rt[2]*ye.metersToTile],d?_e:C),Ft=di(S.cameraToCenterDistance,ct.signedDistanceFromCamera);let $e=M.evaluateSizeForFeature(m.textSizeData,G,Me)*Ft/r.ONE_EM;d&&($e*=m.tilePixelRatio/U);const{width:kt,height:Ct,anchor:Qt,textOffset:dt,textScale:Yt}=Ce,gn=Wl(Qt,kt,Ct,dt,Yt,$e),Kt=d?hi(Qe.add(gn),C,ht*ye.metersToLabelSpace).point:ct.point.add(o?gn.rotate(-S.angle):gn),Zt=m.allowVerticalPlacement&&Me.placedOrientation===r.WritingMode.vertical?Math.PI/2:0;for(let wn=0;wn<Me.numGlyphs;wn++)r.addDynamicAttributes(se,Kt,Zt);j&&Me.associatedIconIndex>=0&&(Q[Me.associatedIconIndex]={shiftedAnchor:Kt,angle:Zt})}else ji(Me.numGlyphs,se)}if(j){re.clear();const ve=m.icon.placedSymbolArray;for(let Me=0;Me<ve.length;Me++){const ge=ve.get(Me);if(ge.hidden)ji(ge.numGlyphs,re);else{const Ce=Q[Me];if(Ce)for(let Qe=0;Qe<ge.numGlyphs;Qe++)r.addDynamicAttributes(re,Ce.shiftedAnchor,Ce.angle);else ji(ge.numGlyphs,re)}}m.icon.dynamicLayoutVertexBuffer.updateData(re)}m.text.dynamicLayoutVertexBuffer.updateData(se)}function qx(m,o,d){return d.iconsInText&&o?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function rp(m,o,d,y,M,S,C,L,U,G,j,Y){const ne=m.context,se=ne.gl,re=m.transform,Q=L==="map",_e=U==="map",ue=Q&&d.layout.get("symbol-placement")!=="point",ye=Q&&!_e&&!ue,ve=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Me=!1;const ge=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),Ce=[r.mercatorXfromLng(re.center.lng),r.mercatorYfromLat(re.center.lat)],Qe=d.layout.get("text-variable-anchor"),rt=re.projection.name==="globe",ht=rt?r.globeToMercatorTransition(re.zoom):0,ct=[],Ft=[];m.terrain&&_e&&Ft.push("PITCH_WITH_MAP_TERRAIN"),rt&&Ft.push("PROJECTION_GLOBE_VIEW");for(const $e of y){const kt=o.getTile($e),Ct=kt.getBucket(d);if(!Ct||Ct.projection!==re.projection.name)continue;const Qt=M?Ct.text:Ct.icon;if(!Qt||Ct.fullyClipped||!Qt.segments.get().length)continue;const dt=Qt.programConfigurations.get(d.id),Yt=M||Ct.sdfIcons,gn=M?Ct.textSizeData:Ct.iconSizeData,Kt=_e||re.pitch!==0,Zt=r.evaluateSizeForZoom(gn,re.zoom);let wn,Nn,pn,Sn,Zn=[0,0],Si=null;if(M){if(Nn=kt.glyphAtlasTexture,pn=se.LINEAR,wn=kt.glyphAtlasTexture.size,Ct.iconsInText){Zn=kt.imageAtlasTexture.size,Si=kt.imageAtlasTexture;const Gr=gn.kind==="composite"||gn.kind==="camera";Sn=Kt||m.options.rotating||m.options.zooming||Gr?se.LINEAR:se.NEAREST}}else{const Gr=d.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;Nn=kt.imageAtlasTexture,pn=Yt||m.options.rotating||m.options.zooming||Gr||Kt?se.LINEAR:se.NEAREST,wn=kt.imageAtlasTexture.size}const cr=m.transform.calculatePixelsToTileUnitsMatrix(kt),ur=xi($e.projMatrix,kt.tileID.canonical,_e,Q,m.transform,cr),Vr=m.terrain&&_e&&ue?r.invert(r.create(),ur):ip,bo=Fr($e.projMatrix,kt.tileID.canonical,_e,Q,m.transform,cr),Zo=Qe&&Ct.hasTextData(),Sa=d.layout.get("icon-text-fit")!=="none"&&Zo&&Ct.hasIconData();if(ue){const Gr=re.elevation,is=Gr?Gr.getAtTileOffsetFunc($e,re.center.lat,re.worldSize,re.projection):Hg=>[0,0,0];Ho(Ct,$e.projMatrix,m,M,ur,bo,_e,G,is,$e)}const Jo=ue||M&&Qe||Sa,Ei=m.translatePosMatrix($e.projMatrix,kt,S,C),Ri=Jo?ip:ur,ei=m.translatePosMatrix(bo,kt,S,C,!0),zi=re.projection.createInversionMatrix(re,$e.canonical),Or=Jo?Ft.concat(["PROJECTED_POS_ON_VIEWPORT"]):Ft,Ti=Yt&&d.paint.get(M?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let eo;eo=Yt?Ct.iconsInText?Os(gn.kind,Zt,ye,_e,m,Ei,Ri,ei,wn,Zn,$e,ht,Ce,zi):es(gn.kind,Zt,ye,_e,m,Ei,Ri,ei,M,wn,!0,$e,ht,Ce,zi):tp(gn.kind,Zt,ye,_e,m,Ei,Ri,ei,M,wn,$e,ht,Ce,zi);const sc={program:m.useProgram(qx(Yt,M,Ct),dt,Or),buffers:Qt,uniformValues:eo,atlasTexture:Nn,atlasTextureIcon:Si,atlasInterpolation:pn,atlasInterpolationIcon:Sn,isSDF:Yt,hasHalo:Ti,tile:kt,labelPlaneMatrixInv:Vr};if(ve&&Ct.canOverlap){Me=!0;const Gr=Qt.segments.get();for(const is of Gr)ct.push({segments:new r.SegmentVector([is]),sortKey:is.sortKey,state:sc})}else ct.push({segments:Qt.segments,sortKey:0,state:sc})}Me&&ct.sort(($e,kt)=>$e.sortKey-kt.sortKey);for(const $e of ct){const kt=$e.state;if(m.terrain&&m.terrain.setupElevationDraw(kt.tile,kt.program,{useDepthForOcclusion:!rt,labelPlaneMatrixInv:kt.labelPlaneMatrixInv}),ne.activeTexture.set(se.TEXTURE0),kt.atlasTexture.bind(kt.atlasInterpolation,se.CLAMP_TO_EDGE),kt.atlasTextureIcon&&(ne.activeTexture.set(se.TEXTURE1),kt.atlasTextureIcon&&kt.atlasTextureIcon.bind(kt.atlasInterpolationIcon,se.CLAMP_TO_EDGE)),kt.isSDF){const Ct=kt.uniformValues;kt.hasHalo&&(Ct.u_is_halo=1,mg(kt.buffers,$e.segments,d,m,kt.program,ge,j,Y,Ct)),Ct.u_is_halo=0}mg(kt.buffers,$e.segments,d,m,kt.program,ge,j,Y,kt.uniformValues)}}function mg(m,o,d,y,M,S,C,L,U){const G=y.context;M.draw(G,G.gl.TRIANGLES,S,C,L,r.CullFaceMode.disabled,U,d.id,m.layoutVertexBuffer,m.indexBuffer,o,d.paint,y.transform.zoom,m.programConfigurations.get(d.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Hu(m,o,d,y,M,S,C){const L=m.context.gl,U=d.paint.get("fill-pattern"),G=U&&U.constantOr(1),j=d.getCrossfadeParameters();let Y,ne,se,re,Q;C?(ne=G&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=L.LINES):(ne=G?"fillPattern":"fill",Y=L.TRIANGLES);for(const _e of y){const ue=o.getTile(_e);if(G&&!ue.patternsLoaded())continue;const ye=ue.getBucket(d);if(!ye)continue;m.prepareDrawTile();const ve=ye.programConfigurations.get(d.id),Me=m.useProgram(ne,ve);G&&(m.context.activeTexture.set(L.TEXTURE0),ue.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),ve.updatePaintBuffers(j));const ge=U.constantOr(null);if(ge&&ue.imageAtlas){const Qe=ue.imageAtlas,rt=Qe.patternPositions[ge.to.toString()],ht=Qe.patternPositions[ge.from.toString()];rt&&ht&&ve.setConstantPatternPositions(rt,ht)}const Ce=m.translatePosMatrix(_e.projMatrix,ue,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(C){re=ye.indexBuffer2,Q=ye.segments2;const Qe=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[L.drawingBufferWidth,L.drawingBufferHeight];se=ne==="fillOutlinePattern"&&G?cg(Ce,m,j,ue,Qe):Gu(Ce,Qe)}else re=ye.indexBuffer,Q=ye.segments,se=G?Ou(Ce,m,j,ue):Vu(Ce);m.prepareDrawProgram(m.context,Me,_e.toUnwrapped()),Me.draw(m.context,Y,M,m.stencilModeForClipping(_e),S,r.CullFaceMode.disabled,se,d.id,ye.layoutVertexBuffer,re,Q,d.paint,m.transform.zoom,ve)}}function Gs(m,o,d,y,M,S,C){const L=m.context,U=L.gl,G=m.transform,j=d.paint.get("fill-extrusion-pattern"),Y=j.constantOr(1),ne=d.getCrossfadeParameters(),se=d.paint.get("fill-extrusion-opacity"),re=function(ve){if(ve.projection.name!=="globe")return 0;const Me=Math.PI/32,ge=Math.tan(Me),Ce=r.earthRadius;return Ce*Math.sqrt(1+2*ge*ge)-Ce}(G),Q=G.projection.name==="globe",_e=Q?r.globeToMercatorTransition(G.zoom):0,ue=[r.mercatorXfromLng(G.center.lng),r.mercatorYfromLat(G.center.lat)],ye=[];Q&&ye.push("PROJECTION_GLOBE_VIEW");for(const ve of y){const Me=o.getTile(ve),ge=Me.getBucket(d);if(!ge||ge.projection!==G.projection.name)continue;const Ce=ge.programConfigurations.get(d.id),Qe=m.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",Ce,ye);if(m.terrain){const kt=m.terrain;if(m.style.terrainSetForDrapingOnly())kt.setupElevationDraw(Me,Qe,{useMeterToDem:!0});else{if(!ge.enableTerrain)continue;if(kt.setupElevationDraw(Me,Qe,{useMeterToDem:!0}),ql(L,o,ve,ge,d,kt),!ge.centroidVertexBuffer){const Ct=Qe.attributes.a_centroid_pos;Ct!==void 0&&U.vertexAttrib2f(Ct,0,0)}}}Y&&(m.context.activeTexture.set(U.TEXTURE0),Me.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Ce.updatePaintBuffers(ne));const rt=j.constantOr(null);if(rt&&Me.imageAtlas){const kt=Me.imageAtlas,Ct=kt.patternPositions[rt.to.toString()],Qt=kt.patternPositions[rt.from.toString()];Ct&&Qt&&Ce.setConstantPatternPositions(Ct,Qt)}const ht=m.translatePosMatrix(ve.projMatrix,Me,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),ct=G.projection.createInversionMatrix(G,ve.canonical),Ft=d.paint.get("fill-extrusion-vertical-gradient"),$e=Y?Nu(ht,m,Ft,se,ve,ne,Me,re,_e,ue,ct):Uu(ht,m,Ft,se,ve,re,_e,ue,ct);m.prepareDrawProgram(L,Qe,ve.toUnwrapped()),Qe.draw(L,L.gl.TRIANGLES,M,S,C,r.CullFaceMode.backCCW,$e,d.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,d.paint,m.transform.zoom,Ce,m.terrain?ge.centroidVertexBuffer:null,Q?ge.layoutVertexExtBuffer:null)}}function ql(m,o,d,y,M,S){const C=[ue=>{let ye=ue.canonical.x-1,ve=ue.wrap;return ye<0&&(ye=(1<<ue.canonical.z)-1,ve--),new r.OverscaledTileID(ue.overscaledZ,ve,ue.canonical.z,ye,ue.canonical.y)},ue=>{let ye=ue.canonical.x+1,ve=ue.wrap;return ye===1<<ue.canonical.z&&(ye=0,ve++),new r.OverscaledTileID(ue.overscaledZ,ve,ue.canonical.z,ye,ue.canonical.y)},ue=>new r.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,(ue.canonical.y===0?1<<ue.canonical.z:ue.canonical.y)-1),ue=>new r.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,ue.canonical.y===(1<<ue.canonical.z)-1?0:ue.canonical.y+1)],L=ue=>{const ye=o.getSource().minzoom,ve=ge=>{const Ce=o.getTileByID(ge);if(Ce&&Ce.hasData())return Ce.getBucket(M)},Me=[0,-1,1];for(const ge of Me){if(ue.overscaledZ+ge<ye)continue;const Ce=ve(ue.calculateScaledKey(ue.overscaledZ+ge));if(Ce)return Ce}},U=[0,0,0],G=(ue,ye)=>(U[0]=Math.min(ue.min.y,ye.min.y),U[1]=Math.max(ue.max.y,ye.max.y),U[2]=r.EXTENT-ye.min.x>ue.max.x?ye.min.x-r.EXTENT:ue.max.x,U),j=(ue,ye)=>(U[0]=Math.min(ue.min.x,ye.min.x),U[1]=Math.max(ue.max.x,ye.max.x),U[2]=r.EXTENT-ye.min.y>ue.max.y?ye.min.y-r.EXTENT:ue.max.y,U),Y=[(ue,ye)=>G(ue,ye),(ue,ye)=>G(ye,ue),(ue,ye)=>j(ue,ye),(ue,ye)=>j(ye,ue)],ne=new r.pointGeometry(0,0);let se,re,Q;const _e=(ue,ye,ve,Me,ge)=>{const Ce=[[Me?ve:ue,Me?ue:ve,0],[Me?ve:ye,Me?ye:ve,0]],Qe=ge<0?r.EXTENT+ge:ge,rt=[Me?Qe:(ue+ye)/2,Me?(ue+ye)/2:Qe,0];return ve===0&&ge<0||ve!==0&&ge>0?S.getForTilePoints(Q,[rt],!0,re):Ce.push(rt),S.getForTilePoints(d,Ce,!0,se),Math.max(Ce[0][2],Ce[1][2],rt[2])/S.exaggeration()};for(let ue=0;ue<4;ue++){const ye=(ue<2?1:5)-ue,ve=y.borders[ue];if(ve.length===0)continue;const Me=Q=C[ue](d),ge=L(Me);if(!(ge&&ge instanceof r.FillExtrusionBucket&&ge.enableTerrain)||y.borderDoneWithNeighborZ[ue]===ge.canonical.z&&ge.borderDoneWithNeighborZ[ye]===y.canonical.z||(re=S.findDEMTileFor(Me),!re||!re.dem))continue;if(!se){const ht=S.findDEMTileFor(d);if(!ht||!ht.dem)return;se=ht}const Ce=ge.borders[ye];let Qe=0;const rt=ge.borderDoneWithNeighborZ[ye]!==y.canonical.z;if(y.canonical.z===ge.canonical.z){for(let ht=0;ht<ve.length;ht++){const ct=y.featuresOnBorder[ve[ht]],Ft=ct.borders[ue];let $e;for(;Qe<Ce.length&&($e=ge.featuresOnBorder[Ce[Qe]],!($e.borders[ye][1]>Ft[0]+3));)rt&&ge.encodeCentroid(void 0,$e,!1),Qe++;if($e&&Qe<Ce.length){const kt=Qe;let Ct=0;for(;!($e.borders[ye][0]>Ft[1]-3)&&(Ct++,++Qe!==Ce.length);)$e=ge.featuresOnBorder[Ce[Qe]];if($e=ge.featuresOnBorder[Ce[kt]],ct.intersectsCount()>1||$e.intersectsCount()>1||Ct!==1){Ct!==1&&(Qe=kt),y.encodeCentroid(void 0,ct,!1),rt&&ge.encodeCentroid(void 0,$e,!1);continue}const Qt=Y[ue](ct,$e),dt=ue%2?r.EXTENT-1:0;ne.x=_e(Qt[0],Math.min(r.EXTENT-1,Qt[1]),dt,ue<2,Qt[2]),ne.y=0,y.encodeCentroid(ne,ct,!1),rt&&ge.encodeCentroid(ne,$e,!1)}else y.encodeCentroid(void 0,ct,!1)}y.borderDoneWithNeighborZ[ue]=ge.canonical.z,y.needsCentroidUpdate=!0,rt&&(ge.borderDoneWithNeighborZ[ye]=y.canonical.z,ge.needsCentroidUpdate=!0)}else{for(const ht of ve)y.encodeCentroid(void 0,y.featuresOnBorder[ht],!1);if(rt){for(const ht of Ce)ge.encodeCentroid(void 0,ge.featuresOnBorder[ht],!1);ge.borderDoneWithNeighborZ[ye]=y.canonical.z,ge.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[ue]=ge.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(m)}const op=new r.Color(1,0,0,1),ap=new r.Color(0,1,0,1),gg=new r.Color(0,0,1,1),Wu=new r.Color(1,0,1,1),qu=new r.Color(0,1,1,1);function Ht(m,o,d,y){Yl(m,0,o+d/2,m.transform.width,d,y)}function Qr(m,o,d,y){Yl(m,o-d/2,0,d,m.transform.height,y)}function Yl(m,o,d,y,M,S){const C=m.context,L=C.gl;L.enable(L.SCISSOR_TEST),L.scissor(o*r.exported.devicePixelRatio,d*r.exported.devicePixelRatio,y*r.exported.devicePixelRatio,M*r.exported.devicePixelRatio),C.clear({color:S}),L.disable(L.SCISSOR_TEST)}function yg(m,o,d){const y=m.context,M=y.gl,S=m.transform.projection.name==="globe",C=d.projMatrix,L=m.useProgram("debug",null,S?["PROJECTION_GLOBE_VIEW"]:null),U=o.getTileByID(d.key);m.terrain&&m.terrain.setupElevationDraw(U,L);const G=r.DepthMode.disabled,j=r.StencilMode.disabled,Y=m.colorModeForRenderPass(),ne="$debug";y.activeTexture.set(M.TEXTURE0),m.emptyTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),S?U._makeGlobeTileDebugBuffers(m.context,m.transform.projection):U._makeDebugTileBoundsBuffers(m.context,m.transform.projection);const se=U._tileDebugBuffer||m.debugBuffer,re=U._tileDebugIndexBuffer||m.debugIndexBuffer,Q=U._tileDebugSegments||m.debugSegments;L.draw(y,M.LINE_STRIP,G,j,Y,r.CullFaceMode.disabled,hg(C,r.Color.red),ne,se,re,Q,null,null,null,U._globeTileDebugBorderBuffer);const _e=U.latestRawTileData,ue=Math.floor((_e&&_e.byteLength||0)/1024),ye=o.getTile(d).tileSize,ve=512/Math.min(ye,512)*(d.overscaledZ/m.transform.zoom)*.5;let Me=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Me+=` => ${d.overscaledZ}`),function(rt,ht){rt.initDebugOverlayCanvas();const ct=rt.debugOverlayCanvas,Ft=rt.context.gl,$e=rt.debugOverlayCanvas.getContext("2d");$e.clearRect(0,0,ct.width,ct.height),$e.shadowColor="white",$e.shadowBlur=2,$e.lineWidth=1.5,$e.strokeStyle="white",$e.textBaseline="top",$e.font="bold 36px Open Sans, sans-serif",$e.fillText(ht,5,5),$e.strokeText(ht,5,5),rt.debugOverlayTexture.update(ct),rt.debugOverlayTexture.bind(Ft.LINEAR,Ft.CLAMP_TO_EDGE)}(m,`${Me} ${ue}kb`);const ge=U._tileDebugTextBuffer||m.debugBuffer,Ce=U._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Qe=U._tileDebugTextSegments||m.debugSegments;L.draw(y,M.TRIANGLES,G,j,r.ColorMode.alphaBlended,r.CullFaceMode.disabled,hg(C,r.Color.transparent,ve),ne,ge,Ce,Qe,null,null,null,U._globeTileDebugTextBuffer)}const xg=r.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:js}=xg;function Yo(m,o,d,y){m.emplaceBack(o,d,y)}class Xl{constructor(o){this.vertexArray=new r.StructArrayLayout3f12,this.indices=new r.StructArrayLayout3ui6,Yo(this.vertexArray,-1,-1,1),Yo(this.vertexArray,1,-1,1),Yo(this.vertexArray,-1,1,1),Yo(this.vertexArray,1,1,1),Yo(this.vertexArray,-1,-1,-1),Yo(this.vertexArray,1,-1,-1),Yo(this.vertexArray,-1,1,-1),Yo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,js),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=r.SegmentVector.simpleSegment(0,0,36,12)}}function _a(m,o,d,y,M,S){const C=m.gl,L=o.paint.get("sky-atmosphere-color"),U=o.paint.get("sky-atmosphere-halo-color"),G=o.paint.get("sky-atmosphere-sun-intensity"),j=((Y,ne,se,re,Q)=>({u_matrix_3f:Y,u_sun_direction:ne,u_sun_intensity:se,u_color_tint_r:[re.r,re.g,re.b,re.a],u_color_tint_m:[Q.r,Q.g,Q.b,Q.a],u_luminance:5e-5}))(r.fromMat4(r.create$1(),y),M,G,L,U);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+S,o.skyboxTexture,0),d.draw(m,C.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.frontCW,j,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}function ba(m,o){return r.transformMat4(m,m,o)}const sp={symbol:function(m,o,d,y,M){if(m.renderPass!=="translucent")return;const S=r.StencilMode.disabled,C=m.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(L,U,G,j,Y,ne,se){const re=U.transform,Q=Y==="map",_e=ne==="map";for(const ue of L){const ye=j.getTile(ue),ve=ye.getBucket(G);if(!ve||ve.projection!==re.projection.name||!ve.text||!ve.text.segments.get().length)continue;const Me=r.evaluateSizeForZoom(ve.textSizeData,re.zoom),ge=U.transform.calculatePixelsToTileUnitsMatrix(ye),Ce=xi(ue.projMatrix,ye.tileID.canonical,_e,Q,U.transform,ge),Qe=G.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(Me){const rt=Math.pow(2,re.zoom-ye.tileID.overscaledZ);Wx(ve,Q,_e,se,r.symbolSize,re,Ce,ue,rt,Me,Qe,re.projection)}}}(y,m,d,o,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),M),d.paint.get("icon-opacity").constantOr(1)!==0&&rp(m,o,d,y,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),S,C),d.paint.get("text-opacity").constantOr(1)!==0&&rp(m,o,d,y,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),S,C),o.map.showCollisionBoxes&&(fg(m,o,d,y,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),fg(m,o,d,y,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(m,o,d,y){if(m.renderPass!=="translucent")return;const M=d.paint.get("circle-opacity"),S=d.paint.get("circle-stroke-width"),C=d.paint.get("circle-stroke-opacity"),L=d.layout.get("circle-sort-key").constantOr(1)!==void 0;if(M.constantOr(1)===0&&(S.constantOr(1)===0||C.constantOr(1)===0))return;const U=m.context,G=U.gl,j=m.transform,Y=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),ne=r.StencilMode.disabled,se=m.colorModeForRenderPass(),re=j.projection.name==="globe",Q=[r.mercatorXfromLng(j.center.lng),r.mercatorYfromLat(j.center.lat)],_e=[];for(let ye=0;ye<y.length;ye++){const ve=y[ye],Me=o.getTile(ve),ge=Me.getBucket(d);if(!ge)continue;const Ce=ge.programConfigurations.get(d.id),Qe=Vx(d);re&&Qe.push("PROJECTION_GLOBE_VIEW");const rt=m.useProgram("circle",Ce,Qe),ht=ge.layoutVertexBuffer,ct=ge.globeExtVertexBuffer,Ft=ge.indexBuffer,$e=j.projection.createInversionMatrix(j,ve.canonical),kt={programConfiguration:Ce,program:rt,layoutVertexBuffer:ht,globeExtVertexBuffer:ct,indexBuffer:Ft,uniformValues:Vs(m,ve,Me,$e,Q,d),tile:Me};if(L){const Ct=ge.segments.get();for(const Qt of Ct)_e.push({segments:new r.SegmentVector([Qt]),sortKey:Qt.sortKey,state:kt})}else _e.push({segments:ge.segments,sortKey:0,state:kt})}L&&_e.sort((ye,ve)=>ye.sortKey-ve.sortKey);const ue={useDepthForOcclusion:!re};for(const ye of _e){const{programConfiguration:ve,program:Me,layoutVertexBuffer:ge,globeExtVertexBuffer:Ce,indexBuffer:Qe,uniformValues:rt,tile:ht}=ye.state,ct=ye.segments;m.terrain&&m.terrain.setupElevationDraw(ht,Me,ue),m.prepareDrawProgram(U,Me,ht.tileID.toUnwrapped()),Me.draw(U,G.TRIANGLES,Y,ne,se,r.CullFaceMode.disabled,rt,d.id,ge,Qe,ct,d.paint,j.zoom,ve,re?Ce:null)}},heatmap:function(m,o,d,y){if(d.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const M=m.context,S=M.gl,C=r.StencilMode.disabled,L=new r.ColorMode([S.ONE,S.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(ne,se,re){const Q=ne.gl;ne.activeTexture.set(Q.TEXTURE1),ne.viewport.set([0,0,se.width/4,se.height/4]);let _e=re.heatmapFbo;if(_e)Q.bindTexture(Q.TEXTURE_2D,_e.colorAttachment.get()),ne.bindFramebuffer.set(_e.framebuffer);else{const ue=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,ue),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),_e=re.heatmapFbo=ne.createFramebuffer(se.width/4,se.height/4,!1),function(ye,ve,Me,ge){const Ce=ye.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,ve.width/4,ve.height/4,0,Ce.RGBA,ye.extRenderToTextureHalfFloat?ye.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),ge.colorAttachment.set(Me)}(ne,se,ue,_e)}})(M,m,d),M.clear({color:r.Color.transparent});const U=m.transform,G=U.projection.name==="globe",j=G?["PROJECTION_GLOBE_VIEW"]:null,Y=[r.mercatorXfromLng(U.center.lng),r.mercatorYfromLat(U.center.lat)];for(let ne=0;ne<y.length;ne++){const se=y[ne];if(o.hasRenderableParent(se))continue;const re=o.getTile(se),Q=re.getBucket(d);if(!Q)continue;const _e=Q.programConfigurations.get(d.id),ue=m.useProgram("heatmap",_e,j),{zoom:ye}=m.transform;m.terrain&&m.terrain.setupElevationDraw(re,ue),m.prepareDrawProgram(M,ue,se.toUnwrapped());const ve=U.projection.createInversionMatrix(U,se.canonical);ue.draw(M,S.TRIANGLES,r.DepthMode.disabled,C,L,r.CullFaceMode.disabled,jx(m,se,re,ve,Y,ye,d.paint.get("heatmap-intensity")),d.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,d.paint,m.transform.zoom,_e,G?Q.globeExtVertexBuffer:null)}M.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(M,S){const C=M.context,L=C.gl,U=S.heatmapFbo;if(!U)return;C.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,U.colorAttachment.get()),C.activeTexture.set(L.TEXTURE1);let G=S.colorRampTexture;G||(G=S.colorRampTexture=new r.Texture(C,S.colorRamp,L.RGBA)),G.bind(L.LINEAR,L.CLAMP_TO_EDGE),M.useProgram("heatmapTexture").draw(C,L.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,M.colorModeForRenderPass(),r.CullFaceMode.disabled,((j,Y,ne,se)=>({u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}))(0,S),S.id,M.viewportBuffer,M.quadTriangleIndexBuffer,M.viewportSegments,S.paint,M.transform.zoom)}(m,d))},line:function(m,o,d,y){if(m.renderPass!=="translucent")return;const M=d.paint.get("line-opacity"),S=d.paint.get("line-width");if(M.constantOr(1)===0||S.constantOr(1)===0)return;const C=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),L=m.colorModeForRenderPass(),U=m.terrain&&m.terrain.renderingToTexture?1:r.exported.devicePixelRatio,G=d.paint.get("line-dasharray"),j=G.constantOr(1),Y=d.layout.get("line-cap"),ne=d.paint.get("line-pattern"),se=ne.constantOr(1),re=d.paint.get("line-gradient"),Q=d.getCrossfadeParameters(),_e=se?"linePattern":"line",ue=m.context,ye=ue.gl,ve=(ge=>{const Ce=[];$d(ge)&&Ce.push("RENDER_LINE_DASH"),ge.paint.get("line-gradient")&&Ce.push("RENDER_LINE_GRADIENT");const Qe=ge.paint.get("line-pattern").constantOr(1),rt=ge.paint.get("line-opacity").constantOr(1)!==1;return!Qe&&rt&&Ce.push("RENDER_LINE_ALPHA_DISCARD"),Ce})(d);let Me=ve.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Me=!1);for(const ge of y){const Ce=o.getTile(ge);if(se&&!Ce.patternsLoaded())continue;const Qe=Ce.getBucket(d);if(!Qe)continue;m.prepareDrawTile();const rt=Qe.programConfigurations.get(d.id),ht=m.useProgram(_e,rt,ve),ct=ne.constantOr(null);if(ct&&Ce.imageAtlas){const dt=Ce.imageAtlas,Yt=dt.patternPositions[ct.to.toString()],gn=dt.patternPositions[ct.from.toString()];Yt&&gn&&rt.setConstantPatternPositions(Yt,gn)}const Ft=G.constantOr(null),$e=Y.constantOr(null);if(!se&&Ft&&$e&&Ce.lineAtlas){const dt=Ce.lineAtlas,Yt=dt.getDash(Ft.to,$e),gn=dt.getDash(Ft.from,$e);Yt&&gn&&rt.setConstantPatternPositions(Yt,gn)}const kt=m.terrain?ge.projMatrix:null,Ct=se?Qd(m,Ce,d,Q,kt,U):Hx(m,Ce,d,Q,kt,Qe.lineClipsArray.length,U);if(re){const dt=Qe.gradients[d.id];let Yt=dt.texture;if(d.gradientVersion!==dt.version){let gn=256;if(d.stepInterpolant){const Kt=o.getSource().maxzoom,Zt=ge.canonical.z===Kt?Math.ceil(1<<m.transform.maxZoom-ge.canonical.z):1;gn=r.clamp(r.nextPowerOfTwo(Qe.maxLineLength/r.EXTENT*1024*Zt),256,ue.maxTextureSize)}dt.gradient=r.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:gn,image:dt.gradient||void 0,clips:Qe.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new r.Texture(ue,dt.gradient,ye.RGBA),dt.version=d.gradientVersion,Yt=dt.texture}ue.activeTexture.set(ye.TEXTURE1),Yt.bind(d.stepInterpolant?ye.NEAREST:ye.LINEAR,ye.CLAMP_TO_EDGE)}j&&(ue.activeTexture.set(ye.TEXTURE0),Ce.lineAtlasTexture.bind(ye.LINEAR,ye.REPEAT),rt.updatePaintBuffers(Q)),se&&(ue.activeTexture.set(ye.TEXTURE0),Ce.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),rt.updatePaintBuffers(Q)),m.prepareDrawProgram(ue,ht,ge.toUnwrapped());const Qt=dt=>{ht.draw(ue,ye.TRIANGLES,C,dt,L,r.CullFaceMode.disabled,Ct,d.id,Qe.layoutVertexBuffer,Qe.indexBuffer,Qe.segments,d.paint,m.transform.zoom,rt,Qe.layoutVertexBuffer2)};if(Me){const dt=m.stencilModeForClipping(ge).ref;dt===0&&m.terrain&&ue.clear({stencil:0});const Yt={func:ye.EQUAL,mask:255};Ct.u_alpha_discard_threshold=.8,Qt(new r.StencilMode(Yt,dt,255,ye.KEEP,ye.KEEP,ye.INVERT)),Ct.u_alpha_discard_threshold=0,Qt(new r.StencilMode(Yt,dt,255,ye.KEEP,ye.KEEP,ye.KEEP))}else Qt(m.stencilModeForClipping(ge))}Me&&(m.resetStencilClippingMasks(),m.terrain&&ue.clear({stencil:0}))},fill:function(m,o,d,y){const M=d.paint.get("fill-color"),S=d.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const C=m.colorModeForRenderPass(),L=d.paint.get("fill-pattern"),U=m.opaquePassEnabledForLayer()&&!L.constantOr(1)&&M.constantOr(r.Color.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===U){const G=m.depthModeForSublayer(1,m.renderPass==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly);Hu(m,o,d,y,G,C,!1)}if(m.renderPass==="translucent"&&d.paint.get("fill-antialias")){const G=m.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,r.DepthMode.ReadOnly);Hu(m,o,d,y,G,C,!0)}},"fill-extrusion":function(m,o,d,y){const M=d.paint.get("fill-extrusion-opacity");if(M!==0&&m.renderPass==="translucent"){const S=new r.DepthMode(m.context.gl.LEQUAL,r.DepthMode.ReadWrite,m.depthRangeFor3D);if(M!==1||d.paint.get("fill-extrusion-pattern").constantOr(1))Gs(m,o,d,y,S,r.StencilMode.disabled,r.ColorMode.disabled),Gs(m,o,d,y,S,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const C=m.colorModeForRenderPass();Gs(m,o,d,y,S,r.StencilMode.disabled,C)}}},hillshade:function(m,o,d,y){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const M=m.context,S=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),C=m.colorModeForRenderPass(),L=m.terrain&&m.terrain.renderingToTexture,[U,G]=m.renderPass!=="translucent"||L?[{},y]:m.stencilConfigForOverlap(y);for(const j of G){const Y=o.getTile(j);if(Y.needsHillshadePrepare&&m.renderPass==="offscreen")qd(m,Y,d,S,r.StencilMode.disabled,C);else if(m.renderPass==="translucent"){const ne=L&&m.terrain?m.terrain.stencilModeForRTTOverlap(j):U[j.overscaledZ];ag(m,j,Y,d,S,ne,C)}}M.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,o,d,y,M,S){if(m.renderPass!=="translucent"||d.paint.get("raster-opacity")===0||!y.length)return;const C=m.context,L=C.gl,U=o.getSource(),G=m.useProgram("raster"),j=m.colorModeForRenderPass(),Y=m.terrain&&m.terrain.renderingToTexture,[ne,se]=U instanceof Fe||Y?[{},y]:m.stencilConfigForOverlap(y),re=se[se.length-1].overscaledZ,Q=!m.options.moving;for(const _e of se){const ue=Y?r.DepthMode.disabled:m.depthModeForSublayer(_e.overscaledZ-re,d.paint.get("raster-opacity")===1?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly,L.LESS),ye=_e.toUnwrapped(),ve=o.getTile(_e);if(Y&&(!ve||!ve.hasData()))continue;const Me=Y?_e.projMatrix:m.transform.calculateProjMatrix(ye,Q),ge=m.terrain&&Y?m.terrain.stencilModeForRTTOverlap(_e):ne[_e.overscaledZ],Ce=S?0:d.paint.get("raster-fade-duration");ve.registerFadeDuration(Ce);const Qe=o.findLoadedParent(_e,0),rt=Kd(ve,Qe,o,m.transform,Ce);let ht,ct;m.terrain&&m.terrain.prepareDrawTile();const Ft=d.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;C.activeTexture.set(L.TEXTURE0),ve.texture.bind(Ft,L.CLAMP_TO_EDGE),C.activeTexture.set(L.TEXTURE1),Qe?(Qe.texture.bind(Ft,L.CLAMP_TO_EDGE),ht=Math.pow(2,Qe.tileID.overscaledZ-ve.tileID.overscaledZ),ct=[ve.tileID.canonical.x*ht%1,ve.tileID.canonical.y*ht%1]):ve.texture.bind(Ft,L.CLAMP_TO_EDGE);const $e=dg(Me,ct||[0,0],ht||1,rt,d,U instanceof Fe?U.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(C,G,ye),U instanceof Fe)U.boundsBuffer&&U.boundsSegments&&G.draw(C,L.TRIANGLES,ue,r.StencilMode.disabled,j,r.CullFaceMode.disabled,$e,d.id,U.boundsBuffer,m.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:kt,tileBoundsIndexBuffer:Ct,tileBoundsSegments:Qt}=m.getTileBoundsBuffers(ve);G.draw(C,L.TRIANGLES,ue,ge,j,r.CullFaceMode.disabled,$e,d.id,kt,Ct,Qt)}}m.resetStencilClippingMasks()},background:function(m,o,d,y){const M=d.paint.get("background-color"),S=d.paint.get("background-opacity");if(S===0)return;const C=m.context,L=C.gl,U=m.transform,G=U.tileSize,j=d.paint.get("background-pattern");if(m.isPatternMissing(j))return;const Y=!j&&M.a===1&&S===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==Y)return;const ne=r.StencilMode.disabled,se=m.depthModeForSublayer(0,Y==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly),re=m.colorModeForRenderPass(),Q=m.useProgram(j?"backgroundPattern":"background");let _e,ue=y;ue||(_e=m.getBackgroundTiles(),ue=Object.values(_e).map(ve=>ve.tileID)),j&&(C.activeTexture.set(L.TEXTURE0),m.imageManager.bind(m.context));const ye=d.getCrossfadeParameters();for(const ve of ue){const Me=ve.toUnwrapped(),ge=y?ve.projMatrix:m.transform.calculateProjMatrix(Me);m.prepareDrawTile();const Ce=o?o.getTile(ve):_e?_e[ve.key]:new r.Tile(ve,G,U.zoom,m),Qe=j?np(ge,S,m,j,{tileID:ve,tileSize:G},ye):pg(ge,S,M);m.prepareDrawProgram(C,Q,Me);const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:ht,tileBoundsSegments:ct}=m.getTileBoundsBuffers(Ce);Q.draw(C,L.TRIANGLES,se,ne,re,r.CullFaceMode.disabled,Qe,d.id,rt,ht,ct)}},sky:function(m,o,d){const y=m.transform,M=y.projection.name==="mercator"||y.projection.name==="globe"?1:r.smoothstep(7,8,y.zoom),S=d.paint.get("sky-opacity")*M;if(S===0)return;const C=m.context,L=d.paint.get("sky-type"),U=new r.DepthMode(C.gl.LEQUAL,r.DepthMode.ReadOnly,[0,1]),G=m.frameCounter/1e3%1;L==="atmosphere"?m.renderPass==="offscreen"?d.needsSkyboxCapture(m)&&(function(j,Y,ne,se){const re=j.context,Q=re.gl;let _e=Y.skyboxFbo;if(!_e){_e=Y.skyboxFbo=re.createFramebuffer(32,32,!1),Y.skyboxGeometry=new Xl(re),Y.skyboxTexture=re.gl.createTexture(),Q.bindTexture(Q.TEXTURE_CUBE_MAP,Y.skyboxTexture),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MAG_FILTER,Q.LINEAR);for(let Me=0;Me<6;++Me)Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Q.RGBA,32,32,0,Q.RGBA,Q.UNSIGNED_BYTE,null)}re.bindFramebuffer.set(_e.framebuffer),re.viewport.set([0,0,32,32]);const ue=Y.getCenter(j,!0),ye=j.useProgram("skyboxCapture"),ve=new Float64Array(16);r.identity(ve),r.rotateY(ve,ve,.5*-Math.PI),_a(re,Y,ye,ve,ue,0),r.identity(ve),r.rotateY(ve,ve,.5*Math.PI),_a(re,Y,ye,ve,ue,1),r.identity(ve),r.rotateX(ve,ve,.5*-Math.PI),_a(re,Y,ye,ve,ue,2),r.identity(ve),r.rotateX(ve,ve,.5*Math.PI),_a(re,Y,ye,ve,ue,3),r.identity(ve),_a(re,Y,ye,ve,ue,4),r.identity(ve),r.rotateY(ve,ve,Math.PI),_a(re,Y,ye,ve,ue,5),re.viewport.set([0,0,j.width,j.height])}(m,d),d.markSkyboxValid(m)):m.renderPass==="sky"&&function(j,Y,ne,se,re){const Q=j.context,_e=Q.gl,ue=j.transform,ye=j.useProgram("skybox");Q.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Y.skyboxTexture);const ve=((Me,ge,Ce,Qe,rt)=>({u_matrix:Me,u_sun_direction:ge,u_cubemap:0,u_opacity:Qe,u_temporal_offset:rt}))(ue.skyboxMatrix,Y.getCenter(j,!1),0,se,re);j.prepareDrawProgram(Q,ye),ye.draw(Q,_e.TRIANGLES,ne,r.StencilMode.disabled,j.colorModeForRenderPass(),r.CullFaceMode.backCW,ve,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(m,d,U,S,G):L==="gradient"&&m.renderPass==="sky"&&function(j,Y,ne,se,re){const Q=j.context,_e=Q.gl,ue=j.transform,ye=j.useProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new Xl(Q)),Q.activeTexture.set(_e.TEXTURE0);let ve=Y.colorRampTexture;ve||(ve=Y.colorRampTexture=new r.Texture(Q,Y.colorRamp,_e.RGBA)),ve.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Me=((ge,Ce,Qe,rt,ht)=>({u_matrix:ge,u_color_ramp:0,u_center_direction:Ce,u_radius:r.degToRad(Qe),u_opacity:rt,u_temporal_offset:ht}))(ue.skyboxMatrix,Y.getCenter(j,!1),Y.paint.get("sky-gradient-radius"),se,re);j.prepareDrawProgram(Q,ye),ye.draw(Q,_e.TRIANGLES,ne,r.StencilMode.disabled,j.colorModeForRenderPass(),r.CullFaceMode.backCW,Me,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(m,d,U,S,G)},debug:function(m,o,d){for(let y=0;y<d.length;y++)yg(m,o,d[y])},custom:function(m,o,d){const y=m.context,M=d.implementation;if(m.transform.projection.unsupportedLayers&&m.transform.projection.unsupportedLayers.includes("custom"))r.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(m.renderPass==="offscreen"){const S=M.prerender;S&&(m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),S.call(M,y.gl,m.transform.customLayerMatrix()),y.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),y.setStencilMode(r.StencilMode.disabled);const S=M.renderingMode==="3d"?new r.DepthMode(m.context.gl.LEQUAL,r.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,r.DepthMode.ReadOnly);y.setDepthMode(S),M.render(y.gl,m.transform.customLayerMatrix()),y.setDirty(),m.setBaseState(),y.bindFramebuffer.set(null)}}};class vg{constructor(o,d){this.context=new q(o),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=r.SourceCache.maxUnderzooming+r.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Iu,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this._tileClippingMaskIDs=new Map,this._skippedStencilTileIDs=new Set}updateTerrain(o,d){const y=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new zr(this,o));const M=this._terrain;this.transform.elevation=y?M:null,M.update(o,this.transform,d)}_updateFog(o){const d=o.fog;if(!d||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,M]=d.getFovAdjustedRange(this.transform._fov);if(y>M)return void(this.transform.fogCullDistSq=null);const S=y+.78*(M-y);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,d){if(this.width=o*r.exported.devicePixelRatio,this.height=d*r.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const o=this.context,d=new r.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(r.EXTENT,0),d.emplaceBack(0,r.EXTENT),d.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(d,r.posAttributes.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);const y=new r.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(r.EXTENT,0),y.emplaceBack(0,r.EXTENT),y.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=o.createVertexBuffer(y,r.posAttributes.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);const M=new r.StructArrayLayout2i4;M.emplaceBack(-1,-1),M.emplaceBack(1,-1),M.emplaceBack(-1,1),M.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(M,r.posAttributes.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);const S=new r.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(r.EXTENT,0,r.EXTENT,0),S.emplaceBack(0,r.EXTENT,0,r.EXTENT),S.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(S,r.boundsAttributes.members),this.mercatorBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);const C=new r.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const L=new r.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])L.emplaceBack(G);this.debugIndexBuffer=o.createIndexBuffer(L),this.emptyTexture=new r.Texture(o,new r.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=r.create();const U=this.context.gl;this.stencilClearMode=new r.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(r.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear(),this.useProgram("clippingMask").draw(o,d.TRIANGLES,r.DepthMode.disabled,this.stencilClearMode,r.ColorMode.disabled,r.CullFaceMode.disabled,Bu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear())}_renderTileClippingMasks(o,d,y){if(!d||this.currentStencilSource===d.id||!o.isTileClipped()||!y||y.length===0)return;const M=[];let S=!1;if(this._tileClippingMaskIDs&&!this.terrain){for(const j of y)if(this._tileClippingMaskIDs.has(j.key)||(S=!0),this._skippedStencilTileIDs.has(j.key)){if(!d.getTile(j).getBucket(o))continue;this._skippedStencilTileIDs.delete(j.key),M.push(j)}if(!S&&M.length===0)return}const C=this.context,L=C.gl;C.setColorMode(r.ColorMode.disabled),C.setDepthMode(r.DepthMode.disabled);const U=this.useProgram("clippingMask"),G=j=>{const Y=d.getTile(j),{tileBoundsBuffer:ne,tileBoundsIndexBuffer:se,tileBoundsSegments:re}=this.getTileBoundsBuffers(Y);U.draw(C,L.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:L.GREATER,mask:255},this._tileClippingMaskIDs.get(j.key)||0,255,L.KEEP,L.KEEP,L.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,Bu(j.projMatrix),"$clipping",ne,se,re)};if(!S&&M.length>0)for(const j of M)G(j);else{(this._tileClippingMaskIDs.size===0||this.nextStencilID+y.length>256)&&this.clearStencil(),this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear();for(const j of y)this._tileClippingMaskIDs.set(j.key,this.nextStencilID++),d.getTile(j).getBucket(o)?G(j):this._skippedStencilTileIDs.add(j.key)}this._skippedStencilTileIDs.size===0&&(this.currentStencilSource=d.id)}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new r.StencilMode({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const d=this.context.gl;return new r.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs.get(o.key)||0,0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,y=o.sort((C,L)=>L.overscaledZ-C.overscaledZ),M=y[y.length-1].overscaledZ,S=y[0].overscaledZ-M+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const C={};for(let L=0;L<S;L++)C[L+M]=new r.StencilMode({func:d.GEQUAL,mask:255},L+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=S,[C,y]}return[{[M]:r.StencilMode.disabled},y]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new r.ColorMode([o.CONSTANT_COLOR,o.ONE],new r.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.ColorMode.unblended:r.ColorMode.alphaBlended}depthModeForSublayer(o,d,y){if(!this.opaquePassEnabledForLayer())return r.DepthMode.disabled;const M=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new r.DepthMode(y||this.context.gl.LEQUAL,d,[M,M])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(r.exported.now()),this.imageManager.beginFrame();const y=this.style.order,M=this.style._sourceCaches;for(const G in M){const j=M[G];j.used&&j.prepare(this.context)}const S={},C={},L={};for(const G in M){const j=M[G];S[G]=j.getVisibleCoordinates(),C[G]=S[G].slice().reverse(),L[G]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<y.length;G++)if(this.style._layers[y[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(L),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.GlobeSharedBuffers(this.context)),!r.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of y){const j=this.style._layers[G],Y=o._getLayerSourceCache(j);if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;const ne=Y?C[Y.id]:void 0;(j.type==="custom"||j.isSky()||ne&&ne.length)&&this.renderLayer(this,Y,j,ne)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let U=r.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(U=this.style.fog.properties.get("color")),this.context.clear({color:d.showOverdrawInspector?r.Color.black:U,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[y[this.currentLayer]],j=o._getLayerSourceCache(G);if(G.isSky())continue;const Y=j?C[j.id]:void 0;this._renderTileClippingMasks(G,j,Y),this.renderLayer(this,j,G,Y)}if(this.renderPass="sky",(r.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const G=this.style._layers[y[this.currentLayer]],j=o._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,j,G,j?C[j.id]:void 0)}for(this.transform.projection.name==="globe"&&function(G){const j=G.context,Y=j.gl,ne=G.transform,se=new r.DepthMode(Y.LEQUAL,r.DepthMode.ReadOnly,[0,1]),re=G.useProgram("globeAtmosphere"),Q=ne.centerOffset,_e=ne._camera.getCameraToClipPerspective(ne._fov,ne.width/ne.height,ne._nearZ,ne._farZ);_e[8]=2*-Q.x/ne.width,_e[9]=2*Q.y/ne.height;const ue=r.invert([],_e),ye=r.mul([],ue,ne.projMatrix),ve={u_frustum_tl:ba([-1,1,1],ue),u_frustum_tr:ba([1,1,1],ue),u_frustum_br:ba([1,-1,1],ue),u_frustum_bl:ba([-1,-1,1],ue),u_globe_pos:ba([ne.globeMatrix[12],ne.globeMatrix[13],ne.globeMatrix[14]],ye),u_globe_radius:ne.worldSize/2/Math.PI-1,u_opacity:1-r.globeToMercatorTransition(ne.zoom),u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};G.prepareDrawProgram(j,re);const Me=G.globeSharedBuffers;Me&&re.draw(j,Y.TRIANGLES,se,r.StencilMode.disabled,r.ColorMode.alphaBlended,r.CullFaceMode.backCW,ve,"skybox",Me.atmosphereVertexBuffer,Me.atmosphereIndexBuffer,Me.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const G=this.style._layers[y[this.currentLayer]],j=o._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Y=j?(G.type==="symbol"?L:C)[j.id]:void 0;this._renderTileClippingMasks(G,j,j?S[j.id]:void 0),this.renderLayer(this,j,G,Y),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let G=null;r.values(this.style._layers).forEach(j=>{const Y=o._getLayerSourceCache(j);Y&&!j.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<Y.getSource().maxzoom)&&(G=Y)}),G&&this.options.showTileBoundaries&&sp.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const j=G.transform.padding;Ht(G,G.transform.height-(j.top||0),3,op),Ht(G,j.bottom||0,3,ap),Qr(G,j.left||0,3,gg),Qr(G,G.transform.width-(j.right||0),3,Wu);const Y=G.transform.centerPoint;(function(ne,se,re,Q){Yl(ne,se-1,re-10,2,20,Q),Yl(ne,se-10,re-1,20,2,Q)})(G,Y.x,G.transform.height-Y.y,qu)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(r.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,d,y,M){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||M&&M.length)&&(this.id=y.id,this.gpuTimingStart(y),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(y.type)||sp[y.type](o,d,y,M,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let y=this.gpuTimers[o.id];y||(y=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),y.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,y.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const d={};for(const y in o){const M=o[y],S=this.context.extTimerQuery,C=S.getQueryObjectEXT(M.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(M.query),d[y]=C}return d}translatePosMatrix(o,d,y,M,S){if(!y[0]&&!y[1])return o;const C=S?M==="map"?this.transform.angle:0:M==="viewport"?-this.transform.angle:0;if(C){const G=Math.sin(C),j=Math.cos(C);y=[y[0]*j-y[1]*G,y[0]*G+y[1]*j]}const L=[S?y[0]:ke(d,y[0],this.transform.zoom),S?y[1]:ke(d,y[1],this.transform.zoom),0],U=new Float32Array(16);return r.translate(U,o,L),U}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),y=this.imageManager.getPattern(o.to.toString());return!d||!y}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,d=this.style&&this.style.fog,y=[];return this.terrain&&!this.terrain.renderingToTexture&&y.push("TERRAIN"),d&&!o&&d.getOpacity(this.transform.pitch)!==0&&y.push("FOG"),o&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(o,d,y){this.cache=this.cache||{};const M=y||[],S=this.currentGlobalDefines().concat(M),C=jl.cacheKey(o,S,d);return this.cache[C]||(this.cache[C]=new jl(this.context,o,Vl[o],d,ri[o],S)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,d,y){if(this.terrain&&this.terrain.renderingToTexture)return;const M=this.style.fog;if(M){const S=M.getOpacity(this.transform.pitch);S!==0&&d.setFogUniformValues(o,((C,L,U,G)=>{const j=L.properties.get("color"),Y=C.frameCounter/1e3%1,ne=[j.r/j.a,j.g/j.a,j.b/j.a,G];return{u_fog_matrix:U?C.transform.calculateFogTileMatrix(U):C.identityMat,u_fog_range:L.getFovAdjustedRange(C.transform._fov),u_fog_color:ne,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_temporal_offset:Y}})(this,M,y,S))}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const o=this.context.gl,d=o.createTexture();return o.bindTexture(o.TEXTURE_2D,d),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,d=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const M of y)d[M.key]=o[M.key]||new r.Tile(M,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}}class wa{constructor(o=0,d=0,y=0,M=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(M)||M<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=y,this.right=M}interpolate(o,d,y){return d.top!=null&&o.top!=null&&(this.top=r.number(o.top,d.top,y)),d.bottom!=null&&o.bottom!=null&&(this.bottom=r.number(o.bottom,d.bottom,y)),d.left!=null&&o.left!=null&&(this.left=r.number(o.left,d.left,y)),d.right!=null&&o.right!=null&&(this.right=r.number(o.right,d.right,y)),this}getCenter(o,d){const y=r.clamp((this.left+o-this.right)/2,0,o),M=r.clamp((this.top+d-this.bottom)/2,0,d);return new r.pointGeometry(y,M)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new wa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function _g(m,o){const d=r.getColumn(m,3);r.fromQuat(m,o),r.setColumn(m,3,d)}function lp(m,o){const d=r.identity$1([]);return r.rotateZ$1(d,d,-o),r.rotateX$1(d,d,-m),d}function Yu(m,o){const d=[m[0],m[1],0],y=[o[0],o[1],0];if(r.length(d)>=1e-15){const C=r.normalize([],d);r.scale$2(y,C,r.dot(y,C)),o[0]=y[0],o[1]=y[1]}const M=r.cross([],o,m);if(r.len(M)<1e-15)return null;const S=Math.atan2(-M[1],M[0]);return lp(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}class Kl{constructor(o,d){this.position=o,this.orientation=d}get position(){return this._position}set position(o){if(o){const d=o instanceof r.MercatorCoordinate?o:new r.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(d.x=r.wrap(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(o,d){if(this.orientation=null,!this.position)return;const y=this._elevation?this._elevation.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(o)):0,M=this.position,S=r.MercatorCoordinate.fromLngLat(o,y),C=[S.x-M.x,S.y-M.y,S.z-M.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Yu(C,d)}setPitchBearing(o,d){this.orientation=lp(r.degToRad(o),r.degToRad(-d))}}class Zl{constructor(o,d){this._transform=r.identity([]),this.orientation=d,this.position=o}get mercatorPosition(){const o=this.position;return new r.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=r.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var d;o&&r.setColumn(this._transform,3,[(d=o)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||r.identity$1([]),o&&_g(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,d){this._orientation=lp(o,d),_g(this._transform,this._orientation)}forward(){const o=r.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=r.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=r.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,d){const y=new Float64Array(16);return r.invert(y,this.getWorldToCamera(o,d)),y}getWorldToCameraPosition(o,d,y){const M=this.position;r.scale$2(M,M,-o);const S=new Float64Array(16);return r.fromScaling(S,[y,y,y]),r.translate(S,S,M),S[10]*=d,S}getWorldToCamera(o,d){const y=new Float64Array(16),M=new Float64Array(4),S=this.position;return r.conjugate(M,this._orientation),r.scale$2(S,S,-o),r.fromQuat(y,M),r.translate(y,y,S),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=d,y[9]*=d,y[10]*=d,y[11]*=d,y}getCameraToClipPerspective(o,d,y,M){const S=new Float64Array(16);return r.perspective(S,o,d,y,M),S}getDistanceToElevation(o){const d=o===0?0:r.mercatorZfromAltitude(o,this.position[1]),y=this.forward();return(d-this.position[2])/y[2]}clone(){return new Zl([...this.position],[...this.orientation])}}function cp(m,o){const d=Jl(m),y=function(S,C,L,U,G){const j=new r.LngLat(L.lng-180*Aa,L.lat),Y=new r.LngLat(L.lng+180*Aa,L.lat),ne=S.project(j.lng,j.lat),se=S.project(Y.lng,Y.lat),re=-Math.atan2(se.y-ne.y,se.x-ne.x),Q=r.MercatorCoordinate.fromLngLat(L);Q.y=r.clamp(Q.y,-.999975,.999975);const _e=Q.toLngLat(),ue=S.project(_e.lng,_e.lat),ye=r.MercatorCoordinate.fromLngLat(_e);ye.x+=Aa;const ve=ye.toLngLat(),Me=S.project(ve.lng,ve.lat),ge=dp(Me.x-ue.x,Me.y-ue.y,re),Ce=r.MercatorCoordinate.fromLngLat(_e);Ce.y+=Aa;const Qe=Ce.toLngLat(),rt=S.project(Qe.lng,Qe.lat),ht=dp(rt.x-ue.x,rt.y-ue.y,re),ct=Math.abs(ge.x)/Math.abs(ht.y),Ft=r.identity([]);r.rotateZ(Ft,Ft,-re*(1-(G?0:U)));const $e=r.identity([]);return r.scale($e,$e,[1,1-(1-ct)*U,1]),$e[4]=-ht.x/ht.y*U,r.rotateZ($e,$e,re),r.multiply$1($e,Ft,$e),$e}(m.projection,0,m.center,d,o),M=up(m);return r.scale(y,y,[M,M,1]),y}function up(m){const o=m.projection,d=Jl(m),y=hp(o,m.center),M=hp(o,r.LngLat.convert(o.center));return Math.pow(2,y*d+(1-d)*M)}function Jl(m){const o=m.projection.range;if(!o)return 0;const d=Math.max(m.width,m.height),y=Math.log(d/1024)/Math.LN2;return r.smoothstep(o[0]+y,o[1]+y,m.zoom)}const Aa=1/4e4;function hp(m,o){const d=r.clamp(o.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),y=new r.LngLat(o.lng-180*Aa,d),M=new r.LngLat(o.lng+180*Aa,d),S=m.project(y.lng,d),C=m.project(M.lng,d),L=r.MercatorCoordinate.fromLngLat(y),U=r.MercatorCoordinate.fromLngLat(M),G=C.x-S.x,j=C.y-S.y,Y=U.x-L.x,ne=U.y-L.y,se=Math.sqrt((Y*Y+ne*ne)/(G*G+j*j));return Math.log(se)/Math.LN2}function dp(m,o,d){const y=Math.cos(d),M=Math.sin(d);return{x:m*y-o*M,y:m*M+o*y}}class Xu{constructor(o,d,y,M,S,C,L){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=y==null?0:y,this._maxPitch=M==null?60:M,this.setProjection(C),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new wa,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Zl,this._centerAltitude=0,this._centerAltitudeValidForExaggeration=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const o=new Xu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o){const d=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||d)&&this._updateCameraOnTerrain(),(o||d)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return r.pick(this.projection,["name","center","parallels"])}setProjection(o){o==null&&(o={name:"mercator"}),this.projectionOptions=o;const d=this.projection?this.getProjection():void 0;this.projection=r.getProjection(o);const y=this.getProjection();return b(d,y)?null:(this._calcMatrices(),y)}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.pointGeometry(this.width,this.height)}get bearing(){return r.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const d=-o*Math.PI/180;var y;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(y=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(M,S,C){var L=S[0],U=S[1],G=S[2],j=S[3],Y=Math.sin(C),ne=Math.cos(C);M[0]=L*ne+G*Y,M[1]=U*ne+j*Y,M[2]=L*-Y+G*ne,M[3]=U*-Y+j*ne}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=r.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let M=0,S=0;for(let C=0;C<d.length;C++){const L=new r.pointGeometry(d[C][0]*this.width,y+d[C][1]*(this.height-y)),U=o.pointCoordinate(L);if(!U)continue;const G=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);M+=U[3]*G,S+=G}return S===0?NaN:M/S}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*d,M=this._mercatorZfromZoom(o),S=this._mercatorZfromZoom(this._maxZoom),C=Math.max(M-y,S);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let y;y=o.z<this._camera.position[2]?[d.x,d.y,d.z]:[o.x,o.y,o.z];const M=r.length(r.sub([],this._camera.position,y));return r.clamp(this._zoomFromMercatorZ(M),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let d=!1;if(o.orientation&&!r.exactEquals(o.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(o.orientation)),o.position){const y=[o.position.x,o.position.y,o.position.z];r.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,d=new Kl;return d.position=new r.MercatorCoordinate(o[0],o[1],o[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(o){if(!r.length$1(o))return!1;r.normalize$1(o,o);const d=r.transformQuat([],[0,0,-1],o),y=r.transformQuat([],[0,-1,0],o);if(y[2]<0)return!1;const M=Yu(d,y);return!!M&&(this._camera.orientation=M,!0)}_setCameraPosition(o){const d=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,M=this.cameraToCenterDistance;o[2]=r.clamp(o[2],M/y,M/d),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,y){this._unmodified=!1,this._edgeInsets.interpolate(o,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new r.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const y=this.pointCoordinate(new r.pointGeometry(0,0)),M=this.pointCoordinate(new r.pointGeometry(this.width,0)),S=this.pointCoordinate(new r.pointGeometry(this.width,this.height)),C=this.pointCoordinate(new r.pointGeometry(0,this.height)),L=Math.floor(Math.min(y.x,M.x,S.x,C.x)),U=Math.floor(Math.max(y.x,M.x,S.x,C.x)),G=1;for(let j=L-G;j<=U+G;j++)j!==0&&d.push(new r.UnwrappedTileID(j,o))}return d}coveringTiles(o){let d=this.coveringZoomLevel(o);const y=d,M=this.elevation&&!o.isTerrainDEM,S=this.projection.name==="mercator";if(o.minzoom!==void 0&&d<o.minzoom)return[];o.maxzoom!==void 0&&d>o.maxzoom&&(d=o.maxzoom);const C=this.locationCoordinate(this.center),L=this.center.lat,U=1<<d,G=[U*C.x,U*C.y,0],j=this.projection.name==="globe",Y=!j,ne=r.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,Y),se=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),re=U*r.mercatorZfromAltitude(1,this.center.lat),Q=this._camera.position[2]/r.mercatorZfromAltitude(1,this.center.lat),_e=[U*se.x,U*se.y,Q*(Y?1:re)],ue=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),ye=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?d:0,ve=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Me=o.isTerrainDEM?-ve:this._elevation?this._elevation.getMinElevationBelowMSL():0,ge=this.projection.isReprojectedInTileSpace?up(this):1,Ce=dt=>{const gn=new r.MercatorCoordinate(dt.x+25e-6,dt.y,dt.z),Kt=new r.MercatorCoordinate(dt.x,dt.y+25e-6,dt.z),Zt=dt.toLngLat(),wn=gn.toLngLat(),Nn=Kt.toLngLat(),pn=this.locationCoordinate(Zt),Sn=this.locationCoordinate(wn),Zn=this.locationCoordinate(Nn),Si=Math.hypot(Sn.x-pn.x,Sn.y-pn.y),cr=Math.hypot(Zn.x-pn.x,Zn.y-pn.y);return Math.sqrt(Si*cr)*ge/25e-6},Qe=dt=>{const Yt=ve,gn=Me;return{aabb:r.tileAABB(this,U,0,0,0,dt,gn,Yt,this.projection),zoom:0,x:0,y:0,minZ:gn,maxZ:Yt,wrap:dt,fullyVisible:!1}},rt=[];let ht=[];const ct=d,Ft=o.reparseOverscaled?y:d,$e=dt=>dt*dt,kt=$e((Q-this._centerAltitude)*re),Ct=dt=>{if(!this._elevation||!dt.tileID||!S)return;const Yt=this._elevation.getMinMaxForTile(dt.tileID),gn=dt.aabb;Yt?(gn.min[2]=Yt.min,gn.max[2]=Yt.max,gn.center[2]=(gn.min[2]+gn.max[2])/2):(dt.shouldSplit=Qt(dt),dt.shouldSplit||(gn.min[2]=gn.max[2]=gn.center[2]=this._centerAltitude))},Qt=dt=>{if(dt.zoom<ye)return!0;if(dt.zoom===ct)return!1;if(dt.shouldSplit!=null)return dt.shouldSplit;const Yt=dt.aabb.distanceX(_e),gn=dt.aabb.distanceY(_e);let Kt=kt,Zt=1;if(j){Kt=$e(dt.aabb.distanceZ(_e));const Nn=Math.pow(2,dt.zoom),pn=r.latFromMercatorY((dt.y+1)/Nn),Sn=r.latFromMercatorY(dt.y/Nn),Zn=Math.min(Math.max(L,pn),Sn),Si=r.circumferenceAtLatitude(Zn)/r.circumferenceAtLatitude(L);Zt=Math.min(Si,1)}else if(M&&(Kt=$e(dt.aabb.distanceZ(_e)*re)),this.projection.isReprojectedInTileSpace&&y<=5){const Nn=Math.pow(2,dt.zoom),pn=Ce(new r.MercatorCoordinate((dt.x+.5)/Nn,(dt.y+.5)/Nn));Zt=pn>.85?1:pn}const wn=Yt*Yt+gn*gn+Kt;return wn<$e((1<<ct-dt.zoom)*ue*Zt*((Nn,pn)=>{if(pn*$e(.707)<Nn)return 1;const Sn=Math.sqrt(pn/Nn);return Sn/(1.4144271570014144+(Math.pow(1.1,Sn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Kt,kt),wn))};if(this.renderWorldCopies)for(let dt=1;dt<=3;dt++)rt.push(Qe(-dt)),rt.push(Qe(dt));for(rt.push(Qe(0));rt.length>0;){const dt=rt.pop(),Yt=dt.x,gn=dt.y;let Kt=dt.fullyVisible;if(!Kt){const Zt=dt.aabb.intersects(ne);if(Zt===0)continue;Kt=Zt===2}if(dt.zoom!==ct&&Qt(dt))for(let Zt=0;Zt<4;Zt++){const wn=(Yt<<1)+Zt%2,Nn=(gn<<1)+(Zt>>1),pn={aabb:S?dt.aabb.quadrant(Zt):r.tileAABB(this,U,dt.zoom+1,wn,Nn,dt.wrap,dt.minZ,dt.maxZ,this.projection),zoom:dt.zoom+1,x:wn,y:Nn,wrap:dt.wrap,fullyVisible:Kt,tileID:void 0,shouldSplit:void 0,minZ:dt.minZ,maxZ:dt.maxZ};M&&!j&&(pn.tileID=new r.OverscaledTileID(dt.zoom+1===ct?Ft:dt.zoom+1,dt.wrap,dt.zoom+1,wn,Nn),Ct(pn)),rt.push(pn)}else{const Zt=dt.zoom===ct?Ft:dt.zoom;if(o.minzoom&&o.minzoom>Zt)continue;const wn=G[0]-(.5+Yt+(dt.wrap<<dt.zoom))*(1<<d-dt.zoom),Nn=G[1]-.5-gn,pn=dt.tileID?dt.tileID:new r.OverscaledTileID(Zt,dt.wrap,dt.zoom,Yt,gn);ht.push({tileID:pn,distanceSq:wn*wn+Nn*Nn})}}if(this.fogCullDistSq){const dt=this.fogCullDistSq,Yt=this.horizonLineFromTop();ht=ht.filter(gn=>{const Kt=[0,0,0,1],Zt=[r.EXTENT,r.EXTENT,0,1],wn=this.calculateFogTileMatrix(gn.tileID.toUnwrapped());r.transformMat4$1(Kt,Kt,wn),r.transformMat4$1(Zt,Zt,wn);const Nn=r.getAABBPointSquareDist(Kt,Zt);if(Nn===0)return!0;let pn=!1;const Sn=this._elevation;if(Sn&&Nn>dt&&Yt!==0){const Zn=this.calculateProjMatrix(gn.tileID.toUnwrapped());let Si;o.isTerrainDEM||(Si=Sn.getMinMaxForTile(gn.tileID)),Si||(Si={min:Me,max:ve});const cr=r.furthestTileCorner(this.rotation),ur=[cr[0]*r.EXTENT,cr[1]*r.EXTENT,Si.max];r.transformMat4(ur,ur,Zn),pn=(1-ur[1])*this.height*.5<Yt}return Nn<dt||pn})}return ht.sort((dt,Yt)=>dt.distanceSq-Yt.distanceSq).map(dt=>dt.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=r.clamp(o.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),y=this.projection.project(o.lng,d);return new r.pointGeometry(y.x*this.worldSize,y.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(o,d){let y,M;const S=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;y=(d.x-S.x)/L,M=(d.y-S.y)/L}else{const L=this.pointCoordinate(d),U=this.pointCoordinate(S);y=L.x-U.x,M=L.y-U.y}const C=this.locationCoordinate(o);this.setLocation(new r.MercatorCoordinate(C.x-y,C.y-M))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this._coordinatePoint(this.locationCoordinate(o),!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,d){const y=d?r.mercatorZfromAltitude(d,o.lat):void 0,M=this.projection.project(o.lng,o.lat);return new r.MercatorCoordinate(M.x,M.y,y)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,d){const y=d!=null?d:this._centerAltitude,M=[o.x,o.y,0,1],S=[o.x,o.y,1,1];r.transformMat4$1(M,M,this.pixelMatrixInverse),r.transformMat4$1(S,S,this.pixelMatrixInverse);const C=S[3];r.scale$1(M,M,1/M[3]),r.scale$1(S,S,1/C);const L=M[2],U=S[2];return{p0:M,p1:S,t:L===U?0:(y-L)/(U-L)}}screenPointToMercatorRay(o){const d=[o.x,o.y,0,1],y=[o.x,o.y,1,1];return r.transformMat4$1(d,d,this.pixelMatrixInverse),r.transformMat4$1(y,y,this.pixelMatrixInverse),r.scale$1(d,d,1/d[3]),r.scale$1(y,y,1/y[3]),d[2]=r.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,y[2]=r.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,r.scale$1(d,d,1/this.worldSize),r.scale$1(y,y,1/this.worldSize),new r.Ray([d[0],d[1],d[2]],r.normalize([],r.sub([],y,d)))}rayIntersectionCoordinate(o){const{p0:d,p1:y,t:M}=o,S=r.mercatorZfromAltitude(d[2],this._center.lat),C=r.mercatorZfromAltitude(y[2],this._center.lat);return new r.MercatorCoordinate(r.number(d[0],y[0],M)/this.worldSize,r.number(d[1],y[1],M)/this.worldSize,r.number(S,C,M))}pointCoordinate(o,d=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,d)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);const d=this.elevation;let y=this.elevation.pointCoordinate(o);if(y)return new r.MercatorCoordinate(y[0],y[1],y[2]);let M=0,S=this.horizonLineFromTop();if(o.y>S)return this.pointCoordinate(o);const C=.02*S,L=o.clone();for(let U=0;U<10&&S-M>C;U++){L.y=r.number(M,S,.66);const G=d.pointCoordinate(L);G?(S=L.y,y=G):M=L.y}return y?new r.MercatorCoordinate(y[0],y[1],y[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){if(this.elevation)return!this.elevation.pointCoordinate(o);{const d=this.horizonLineFromTop();return o.y<d}}_coordinatePoint(o,d){const y=d&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,M=[o.x*this.worldSize,o.y*this.worldSize,y+o.toAltitude(),1];return r.transformMat4$1(M,M,this.pixelMatrix),M[3]>0?new r.pointGeometry(M[0]/M[3],M[1]/M[3]):new r.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(o,d){const y=new r.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),M=new r.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),S=new r.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),C=new r.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let L=this.pointCoordinate(y,o),U=this.pointCoordinate(M,o);const G=this.pointCoordinate(S,d),j=this.pointCoordinate(C,d),Y=(ne,se)=>(se.y-ne.y)/(se.x-ne.x);return L.y>1&&U.y>=0?L=new r.MercatorCoordinate((1-j.y)/Y(j,L)+j.x,1):L.y<0&&U.y<=1&&(L=new r.MercatorCoordinate(-j.y/Y(j,L)+j.x,0)),U.y>1&&L.y>=0?U=new r.MercatorCoordinate((1-G.y)/Y(G,U)+G.x,1):U.y<0&&L.y<=1&&(U=new r.MercatorCoordinate(-G.y/Y(G,U)+G.x,0)),new r.LngLatBounds().extend(this.coordinateLocation(L)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(j)).extend(this.coordinateLocation(G))}_getBounds3D(){const o=this.elevation;if(!o.visibleDemTiles.length)return this._getBounds(0,0);const d=o.visibleDemTiles.reduce((y,M)=>{if(M.dem){const S=M.dem.tree;y.min=Math.min(y.min,S.minimums[0]),y.max=Math.max(y.max,S.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBounds(d.min*o.exaggeration(),d.max*o.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(o=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-d*(1-this._horizonShift);return o?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-r.MAX_MERCATOR_LATITUDE,this.maxLat=r.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=r.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=r.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=r.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,d){return this.projection.createTileMatrix(this,d,o)}calculateDistanceTileData(o){const d=o.key,y=this._distanceTileDataCache;if(y[d])return y[d];const M=o.canonical,S=1/this.height,C=this.cameraWorldSize/this.zoomScale(M.z),L=(M.x+Math.pow(2,M.z)*o.wrap)*C,U=M.y*C,G=this.point,j=this.angle,Y=Math.sin(-j),ne=-Math.cos(-j);return y[d]={bearing:[Y,ne],center:[(G.x-L)*S,(G.y-U)*S],scale:C/r.EXTENT*S},y[d]}calculateFogTileMatrix(o){const d=o.key,y=this._fogTileMatrixCache;if(y[d])return y[d];const M=this.calculatePosMatrix(o,this.cameraWorldSize);return r.multiply$1(M,this.worldToFogMatrix,M),y[d]=new Float32Array(M),y[d]}calculateProjMatrix(o,d=!1){const y=o.key,M=d?this._alignedProjMatrixCache:this._projMatrixCache;if(M[y])return M[y];const S=this.calculatePosMatrix(o,this.worldSize);return r.multiply$1(S,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.alignedProjMatrix:this.projMatrix,S),M[y]=new Float32Array(S),M[y]}calculatePixelsToTileUnitsMatrix(o){const d=o.tileID.key,y=this._pixelsToTileUnitsCache;if(y[d])return y[d];const M=function(S,C){const{scale:L}=S.tileTransform,U=L*r.EXTENT/(S.tileSize*Math.pow(2,C.zoom-S.tileID.overscaledZ+S.tileID.canonical.z));return G=new Float32Array(4),ne=(j=C.inverseAdjustmentMatrix)[1],se=j[2],re=j[3],_e=(Y=[U,U])[1],G[0]=j[0]*(Q=Y[0]),G[1]=ne*Q,G[2]=se*_e,G[3]=re*_e,G;var G,j,Y,ne,se,re,Q,_e}(o,this);return y[d]=M,y[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const d=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(d),M=this._camera.forward(),S=r.mercatorZfromAltitude(1,this._center.lat);y[2]/=S,M[2]/=S,r.normalize(M,M);const C=o.raycast(y,M,o.exaggeration());if(C){const L=r.scaleAndAdd([],y,M,C),U=new r.MercatorCoordinate(L[0],L[1],r.mercatorZfromAltitude(L[2],r.latFromMercatorY(L[1]))),G=(U.z+r.length([U.x-y[0],U.y-y[1],U.z-y[2]*S]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const d=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(d),M=o.getAtPointOrZero(new r.MercatorCoordinate(...y)),S=this._minimumHeightOverTerrain()*Math.cos(r.degToRad(this._maxPitch)),C=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*M;if(C<S){const L=this.locationCoordinate(this._center,this._centerAltitude),U=[L.x-y[0],L.y-y[1],L.z-y[2]],G=r.length(U);U[2]-=(S-C)/this._projectionScaler;const j=r.length(U);if(j===0)return;r.scale$2(U,U,G/j*this._projectionScaler),this._camera.position=[L.x-U[0],L.y-U[1],L.z*this._projectionScaler-U[2]],this._camera.orientation=Yu(U,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const Y=this.center;return Y.lat=r.clamp(Y.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(Y.lng=r.clamp(Y.lng,this.minLng,this.maxLng)),this.center=Y,void(this._constraining=!1)}const o=this._unmodified,{x:d,y}=this.point;let M=0,S=d,C=y;const L=this.width/2,U=this.height/2,G=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(y-U<G&&(C=G+U),y+U>j&&(C=j-U),j-G<this.height&&(M=Math.max(M,this.height/(j-G)),C=(j+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Y=this.worldMinX*this.scale,ne=this.worldMaxX*this.scale,se=this.worldSize/2-(Y+ne)/2;S=(d+se+this.worldSize)%this.worldSize-se,S-L<Y&&(S=Y+L),S+L>ne&&(S=ne-L),ne-Y<this.width&&(M=Math.max(M,this.width/(ne-Y)),S=(ne+Y)/2)}S===d&&C===y||(this.center=this.unproject(new r.pointGeometry(S,C))),M&&(this.zoom+=this.scaleZoom(M)),this._constrainCameraAltitude(),this._unmodified=o,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this._fov/2,d=this.centerOffset,y=this.pixelsPerMeter;this._projectionScaler=y/(r.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(o)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const M=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?y:1),S=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);S[8]=2*-d.x/this.width,S[9]=2*d.y/this.height;let C=r.mul([],S,M);if(this.projection.isReprojectedInTileSpace){const Me=this.locationCoordinate(this.center),ge=r.identity([]);r.translate(ge,ge,[Me.x*this.worldSize,Me.y*this.worldSize,0]),r.multiply$1(ge,ge,cp(this)),r.translate(ge,ge,[-Me.x*this.worldSize,-Me.y*this.worldSize,0]),r.multiply$1(C,C,ge),this.inverseAdjustmentMatrix=function(Ce){const Qe=cp(Ce,!0);return Le([],[Qe[0],Qe[1],Qe[4],Qe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=r.scale([],C,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=C,this.invProjMatrix=r.invert(new Float64Array(16),this.projMatrix);const L=new Float32Array(16);r.identity(L),r.scale(L,L,[1,-1,1]),r.rotateX(L,L,this._pitch),r.rotateZ(L,L,this.angle);const U=r.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),G=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;U[8]=2*-d.x/this.width,U[9]=2*(d.y+G)/this.height,this.skyboxMatrix=r.multiply$1(L,U,L);const j=this.point,Y=j.x,ne=j.y,se=this.width%2/2,re=this.height%2/2,Q=Math.cos(this.angle),_e=Math.sin(this.angle),ue=Y-Math.round(Y)+Q*se+_e*re,ye=ne-Math.round(ne)+Q*re+_e*se,ve=new Float64Array(C);if(r.translate(ve,ve,[ue>.5?ue-1:ue,ye>.5?ye-1:ye,0]),this.alignedProjMatrix=ve,C=r.create(),r.scale(C,C,[this.width/2,-this.height/2,1]),r.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=r.create(),r.scale(C,C,[1,-1,1]),r.translate(C,C,[-1,-1,0]),r.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.pixelMatrix=r.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},C=r.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this.globeMatrix=this.projection.name==="globe"?r.calculateGlobeMatrix(this):C,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSize,d=this.cameraPixelsPerMeter,y=this._camera.position,M=1/this.height,S=[o,o,d];r.scale$2(S,S,M),r.scale$2(y,y,-1),r.multiply$2(y,y,S);const C=r.create();r.translate(C,C,y),r.scale(C,C,S),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,d,M)}_computeCameraPosition(o){const d=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),M=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-o/this.worldSize*this._centerAltitude;return[M.x/this.worldSize-y[0]*S,M.y/this.worldSize-y[1]*S,o/this.worldSize*this._centerAltitude-y[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=o[2];let M=1;y>0&&(M=Math.min((d-this._camera.position[2])/y,1)),this._camera.position=r.scaleAndAdd([],this._camera.position,o,M),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const o=this._camera.position,d=this._camera.forward(),{pitch:y,bearing:M}=this._camera.getPitchBearing(),S=r.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.degToRad(this._maxPitch)),L=Math.max((o[2]-S)/Math.cos(y),C),U=this._zoomFromMercatorZ(L);r.scaleAndAdd(o,o,d,L),this._pitch=r.clamp(y,r.degToRad(this.minPitch),r.degToRad(this.maxPitch)),this.angle=r.wrap(M,-Math.PI,Math.PI),this._setZoom(r.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(o,d){const y=Math.min(o.x,d.x),M=Math.max(o.x,d.x),S=Math.min(o.y,d.y),C=Math.max(o.y,d.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new r.pointGeometry(y,S),new r.pointGeometry(M,C),new r.pointGeometry(y,C),new r.pointGeometry(M,S)],U=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const j of L){const Y=this.pointRayIntersection(j);if(Y.t<0)return!0;const ne=this.rayIntersectionCoordinate(Y);if(ne.x<U||ne.y<0||ne.x>G||ne.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.pointGeometry(0,0),new r.pointGeometry(this.width,this.height))}zoomDeltaToMovement(o,d){const y=r.length(r.sub([],this._camera.position,o)),M=this._zoomFromMercatorZ(y)+d;return y-this._mercatorZfromZoom(M)}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.pointGeometry(0,o))}}function pp(m,o){let d=!1,y=null;const M=()=>{y=null,d&&(m(),y=setTimeout(M,o),d=!1)};return()=>(d=!0,y||M(),y)}class bg{constructor(o){this._hashName=o&&encodeURIComponent(o),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=pp(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,r.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),r.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(o){const d=this._map;if(!d)return"";const y=d.getCenter(),M=Math.round(100*d.getZoom())/100,S=Math.ceil((M*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,S),L=Math.round(y.lng*C)/C,U=Math.round(y.lat*C)/C,G=d.getBearing(),j=d.getPitch();let Y="";if(Y+=o?`/${L}/${U}/${M}`:`${M}/${U}/${L}`,(G||j)&&(Y+="/"+Math.round(10*G)/10),j&&(Y+=`/${Math.round(j)}`),this._hashName){const ne=this._hashName;let se=!1;const re=r.window.location.hash.slice(1).split("&").map(Q=>{const _e=Q.split("=")[0];return _e===ne?(se=!0,`${_e}=${Y}`):Q}).filter(Q=>Q);return se||re.push(`${ne}=${Y}`),`#${re.join("&")}`}return`#${Y}`}_getCurrentHash(){const o=r.window.location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(d=y)}),(d&&d[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(d[3]||0):o.getBearing();return o.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=r.window.location.href.replace(/(#.+)?$/,this.getHashString());r.window.history.replaceState(r.window.history.state,null,o)}}const Xo={linearity:.3,easing:r.bezier(0,0,.3,1)},wg=r.extend({deceleration:2500,maxSpeed:1400},Xo),Ag=r.extend({deceleration:20,maxSpeed:1400},Xo),Mg=r.extend({deceleration:1e3,maxSpeed:360},Xo),Sg=r.extend({deceleration:1e3,maxSpeed:90},Xo);class Tg{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=r.exported.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new r.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)d.zoom+=S.zoomDelta||0,d.bearing+=S.bearingDelta||0,d.pitch+=S.pitchDelta||0,S.panDelta&&d.pan._add(S.panDelta),S.around&&(d.around=S.around),S.pinchAround&&(d.pinchAround=S.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,M={};if(d.pan.mag()){const S=Qi(d.pan.mag(),y,r.extend({},wg,o||{}));M.offset=d.pan.mult(S.amount/d.pan.mag()),M.center=this._map.transform.center,Ql(M,S)}if(d.zoom){const S=Qi(d.zoom,y,Ag);M.zoom=this._map.transform.zoom+S.amount,Ql(M,S)}if(d.bearing){const S=Qi(d.bearing,y,Mg);M.bearing=this._map.transform.bearing+r.clamp(S.amount,-179,179),Ql(M,S)}if(d.pitch){const S=Qi(d.pitch,y,Sg);M.pitch=this._map.transform.pitch+S.amount,Ql(M,S)}if(M.zoom||M.bearing){const S=d.pinchAround===void 0?d.around:d.pinchAround;M.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),M.noMoveStart=!0,M}}function Ql(m,o){(!m.duration||m.duration<o.duration)&&(m.duration=o.duration,m.easing=o.easing)}function Qi(m,o,d){const{maxSpeed:y,linearity:M,deceleration:S}=d,C=r.clamp(m*M/(o/1e3),-y,y),L=Math.abs(C)/(S*M);return{easing:d.easing,duration:1e3*L,amount:C*(L/2)}}class Ur extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y,M={}){const S=$(d.getCanvasContainer(),y),C=d.unproject(S);super(o,r.extend({point:S,lngLat:C,originalEvent:y},M)),this._defaultPrevented=!1,this.target=d}}class $l extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y){const M=o==="touchend"?y.changedTouches:y.touches,S=oe(d.getCanvasContainer(),M),C=S.map(U=>d.unproject(U)),L=S.reduce((U,G,j,Y)=>U.add(G.div(Y.length)),new r.pointGeometry(0,0));super(o,{points:S,point:L,lngLats:C,lngLat:d.unproject(L),originalEvent:y}),this._defaultPrevented=!1}}class Yx extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y){super(o,{originalEvent:y}),this._defaultPrevented=!1}}class Xx{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Yx(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new Ur(o.type,this._map,o))}mouseup(o){this._map.fire(new Ur(o.type,this._map,o))}preclick(o){const d=r.extend({},o);d.type="preclick",this._map.fire(new Ur(d.type,this._map,d))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Ur(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Ur(o.type,this._map,o))}mouseover(o){this._map.fire(new Ur(o.type,this._map,o))}mouseout(o){this._map.fire(new Ur(o.type,this._map,o))}touchstart(o){return this._firePreventable(new $l(o.type,this._map,o))}touchmove(o){this._map.fire(new $l(o.type,this._map,o))}touchend(o){this._map.fire(new $l(o.type,this._map,o))}touchcancel(o){this._map.fire(new $l(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ko{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Ur(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ur("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Ur(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Eg{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(O(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const y=d;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const M=this._startPos;this._lastPos=y,this._box||(this._box=E("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const S=Math.min(M.x,y.x),C=Math.max(M.x,y.x),L=Math.min(M.y,y.y),U=Math.max(M.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${L}px)`,this._box.style.width=C-S+"px",this._box.style.height=U-L+"px")})}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const y=this._startPos,M=d;if(this.reset(),ie(),y.x!==M.x||y.y!==M.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:S=>S.fitScreenCoordinates(y,M,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),W(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new r.Event(o,{originalEvent:d}))}}function Ma(m,o){const d={};for(let y=0;y<m.length;y++)d[m[y].identifier]=o[y];return d}class Do{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),y.length===this.numTouches&&(this.centroid=function(M){const S=new r.pointGeometry(0,0);for(const C of M)S._add(C);return S.div(M.length)}(d),this.touches=Ma(y,d)))}touchmove(o,d,y){if(this.aborted||!this.centroid)return;const M=Ma(y,d);for(const S in this.touches){const C=this.touches[S],L=M[S];(!L||L.dist(C)>30)&&(this.aborted=!0)}}touchend(o,d,y){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const M=!this.aborted&&this.centroid;if(this.reset(),M)return M}}}class Hs{constructor(o){this.singleTap=new Do(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,d,y){this.singleTap.touchstart(o,d,y)}touchmove(o,d,y){this.singleTap.touchmove(o,d,y)}touchend(o,d,y){const M=this.singleTap.touchend(o,d,y);if(M){const S=o.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(M)<30;if(S&&C||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=M,this.count===this.numTaps)return this.reset(),M}}}class qt{constructor(){this._zoomIn=new Hs({numTouches:1,numTaps:2}),this._zoomOut=new Hs({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,y){this._zoomIn.touchstart(o,d,y),this._zoomOut.touchstart(o,d,y)}touchmove(o,d,y){this._zoomIn.touchmove(o,d,y),this._zoomOut.touchmove(o,d,y)}touchend(o,d,y){const M=this._zoomIn.touchend(o,d,y),S=this._zoomOut.touchend(o,d,y);return M?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(M)},{originalEvent:o})}):S?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(S)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Pg={0:1,2:2};class Ku{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,d){return!1}_move(o,d){return{}}mousedown(o,d){if(this._lastPoint)return;const y=be(o);this._correctButton(o,y)&&(this._lastPoint=d,this._eventButton=y)}mousemoveWindow(o,d){const y=this._lastPoint;if(y){if(o.preventDefault(),this._eventButton!=null&&function(M,S){const C=Pg[S];return M.buttons===void 0||(M.buttons&C)!==C}(o,this._eventButton))this.reset();else if(this._moved||!(d.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(y,d)}}mouseupWindow(o){this._lastPoint&&be(o)===this._eventButton&&(this._moved&&ie(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ec extends Ku{mousedown(o,d){super.mousedown(o,d),this._lastPoint&&(this._active=!0)}_correctButton(o,d){return d===0&&!o.ctrlKey}_move(o,d){return{around:d,panDelta:d.sub(o)}}}class Ws extends Ku{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const y=.8*(d.x-o.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(o){o.preventDefault()}}class fp extends Ku{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const y=-.5*(d.y-o.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(o){o.preventDefault()}}class Cg{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),r.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.pointGeometry(0,0)}touchstart(o,d,y){return this._calculateTransform(o,d,y)}touchmove(o,d,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.preventDefault(),this._calculateTransform(o,d,y)}}touchend(o,d,y){this._calculateTransform(o,d,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,y){y.length>0&&(this._active=!0);const M=Ma(y,d),S=new r.pointGeometry(0,0),C=new r.pointGeometry(0,0);let L=0;for(const G in M){const j=M[G],Y=this._touches[G];Y&&(S._add(j),C._add(j.sub(Y)),L++,M[G]=j)}if(this._touches=M,L<this._minTouches||!C.mag())return;const U=C.div(L);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(L),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Zu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,d,y){return{}}touchstart(o,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,y){const M=this._firstTwoTouches;if(!M)return;o.preventDefault();const[S,C]=M,L=tc(y,d,S),U=tc(y,d,C);if(!L||!U)return;const G=this._aroundCenter?null:L.add(U).div(2);return this._move([L,U],G,o)}touchend(o,d,y){if(!this._firstTwoTouches)return;const[M,S]=this._firstTwoTouches,C=tc(y,d,M),L=tc(y,d,S);C&&L||(this._active&&ie(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function tc(m,o,d){for(let y=0;y<m.length;y++)if(m[y].identifier===d)return o[y]}function mp(m,o){return Math.log(m/o)/Math.LN2}class Rg extends Zu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(mp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mp(this._distance,y),pinchAround:d}}}function gp(m,o){return 180*m.angleWith(o)/Math.PI}class Ju extends Zu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const y=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:gp(this._vector,y),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,y=gp(o,this._startVector);return Math.abs(y)<d}}function nc(m){return Math.abs(m.y)>Math.abs(m.x)}class Qu extends Zu{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,nc(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,y){const M=this._lastPoints;if(!M)return;const S=o[0].sub(M[0]),C=o[1].sub(M[1]);return this._map._cooperativeGestures&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(S,C,y.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(S.y+C.y)/2*-.5})}gestureBeginsVertically(o,d,y){if(this._valid!==void 0)return this._valid;const M=o.mag()>=2,S=d.mag()>=2;if(!M&&!S)return;if(!M||!S)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const C=o.y>0==d.y>0;return nc(o)&&nc(d)&&C}}const Dg={panStep:100,bearingStep:15,pitchStep:10};class Ig{constructor(){const o=Dg;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,y=0,M=0,S=0,C=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?y=-1:(o.preventDefault(),S=-1);break;case 39:o.shiftKey?y=1:(o.preventDefault(),S=1);break;case 38:o.shiftKey?M=1:(o.preventDefault(),C=-1);break;case 40:o.shiftKey?M=-1:(o.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(y=0,M=0),{cameraAnimation:L=>{const U=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:Lg,zoom:d?Math.round(U)+d*(o.shiftKey?2:1):U,bearing:L.getBearing()+y*this._bearingStep,pitch:L.getPitch()+M*this._pitchStep,offset:[-S*this._panStep,-C*this._panStep],center:L.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Lg(m){return m*(2-m)}const yp=4.000244140625;class Fg{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,r.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=o.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const y=r.exported.now(),M=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,d!==0&&d%yp==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":M>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(M*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=$(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform,d=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>yp?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&G!==0&&(G=1/G);const j=d(),Y=Math.pow(2,j),ne=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):Y;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(ne*G))),this._type==="wheel"&&(this._startZoom=d(),this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:d(),M=this._startZoom,S=this._easing;let C,L=!1;if(this._type==="wheel"&&M&&S){const U=Math.min((r.exported.now()-this._lastWheelEventTime)/200,1),G=S(U);C=r.number(M,y,G),U<1?this._frameId||(this._frameId=!0):L=!0}else C=y,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:C-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=r.ease;if(this._prevEase){const y=this._prevEase,M=(r.exported.now()-y.start)/y.duration,S=y.easing(M+.01)-y.easing(M),C=.27/Math.sqrt(S*S+1e-4)*.01,L=Math.sqrt(.0729-C*C);d=r.bezier(C,L,.25,1)}return this._prevEase={start:r.exported.now(),duration:o,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(r.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!r.window.document.fullscreenElement||!!r.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class kg{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bg{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,d){return o.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(o.shiftKey?-1:1),around:y.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xp{constructor(){this._tap=new Hs({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,d,y){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=d[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(o,d,y))}touchmove(o,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const M=d[0],S=M.y-this._swipePoint.y;return this._swipePoint=M,o.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(o,d,y)}touchend(o,d,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(o,d,y)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zg{constructor(o,d,y){this._el=o,this._mousePan=d,this._touchPan=y}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ug{constructor(o,d,y){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ng{constructor(o,d,y,M){this._el=o,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=M,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ic=m=>m.zoom||m.drag||m.pitch||m.rotate;class vp extends r.Event{}class Vg{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,d){const y=r.sub([],d,o);this.radius=r.length(y[2]<0?r.div([],y,this.constants):[y[0],y[1],0])}projectRay(o){r.div(o,o,this.constants),r.normalize(o,o),r.mul$1(o,o,this.constants);const d=r.scale$2([],o,this.radius);if(d[2]>0){const y=r.scale$2([],[0,0,1],r.dot(d,[0,0,1])),M=r.scale$2([],r.normalize([],[d[0],d[1],0]),this.radius),S=r.add([],d,r.scale$2([],r.sub([],r.add([],M,y),d),2));d[0]=S[0],d[1]=S[1]}return d}}function qs(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Og{constructor(o,d){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tg(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Vg,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),r.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[r.window,"blur",void 0]];for(const[M,S,C]of this._listeners)M.addEventListener(S,M===r.window.document?this.handleWindowEvent:this.handleEvent,C)}destroy(){for(const[o,d,y]of this._listeners)o.removeEventListener(d,o===r.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(o){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new Xx(d,o));const M=d.boxZoom=new Eg(d,o);this._add("boxZoom",M);const S=new qt,C=new Bg;d.doubleClickZoom=new kg(C,S),this._add("tapZoom",S),this._add("clickZoom",C);const L=new xp;this._add("tapDragZoom",L);const U=d.touchPitch=new Qu(d);this._add("touchPitch",U);const G=new Ws(o),j=new fp(o);d.dragRotate=new Ug(o,G,j),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const Y=new ec(o),ne=new Cg(d,o);d.dragPan=new zg(y,Y,ne),this._add("mousePan",Y),this._add("touchPan",ne,["touchZoom","touchRotate"]);const se=new Ju,re=new Rg;d.touchZoomRotate=new Ng(y,re,se,L),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ko(d));const Q=d.scrollZoom=new Fg(d,this);this._add("scrollZoom",Q,["mousePan"]);const _e=d.keyboard=new Ig;this._add("keyboard",_e);for(const ue of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ue]&&d[ue].enable(o[ue])}_add(o,d,y){this._handlers.push({handlerName:o,handler:d,allowed:y}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ic(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,y){for(const M in o)if(M!==y&&(!d||d.indexOf(M)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const d=[];for(const y of o)this._el.contains(y.target)&&d.push(y);return d}handleEvent(o,d){this._updatingCamera=!0;const y=o.type==="renderFrame",M=y?void 0:o,S={needsRenderFrame:!1},C={},L={},U=o.touches?this._getMapTouches(o.touches):void 0,G=U?oe(this._el,U):y?void 0:$(this._el,o);for(const{handlerName:ne,handler:se,allowed:re}of this._handlers){if(!se.isEnabled())continue;let Q;this._blockedByActive(L,re,ne)?se.reset():se[d||o.type]&&(Q=se[d||o.type](o,G,U),this.mergeHandlerResult(S,C,Q,ne,M),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||se.isActive())&&(L[ne]=se)}const j={};for(const ne in this._previousActiveHandlers)L[ne]||(j[ne]=M);this._previousActiveHandlers=L,(Object.keys(j).length||qs(S))&&(this._changes.push([S,C,j]),this._triggerRenderFrame()),(Object.keys(L).length||qs(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=S;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))}mergeHandlerResult(o,d,y,M,S){if(!y)return;r.extend(o,y);const C={handlerName:M,originalEvent:y.originalEvent||S};y.zoomDelta!==void 0&&(d.zoom=C),y.panDelta!==void 0&&(d.drag=C),y.pitchDelta!==void 0&&(d.pitch=C),y.bearingDelta!==void 0&&(d.rotate=C)}_applyChanges(){const o={},d={},y={};for(const[M,S,C]of this._changes)M.panDelta&&(o.panDelta=(o.panDelta||new r.pointGeometry(0,0))._add(M.panDelta)),M.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+M.zoomDelta),M.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+M.bearingDelta),M.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+M.pitchDelta),M.around!==void 0&&(o.around=M.around),M.aroundCoord!==void 0&&(o.aroundCoord=M.aroundCoord),M.pinchAround!==void 0&&(o.pinchAround=M.pinchAround),M.noInertia&&(o.noInertia=M.noInertia),r.extend(d,S),r.extend(y,C);this._updateMapTransform(o,d,y),this._changes=[]}_updateMapTransform(o,d,y){const M=this._map,S=M.transform,C=ye=>[ye.x,ye.y,ye.z];if((ye=>{const ve=this._eventsInProgress.drag;return ve&&!this._handlersById[ve.handlerName].isActive()})()&&!qs(o)){const ye=S.zoom;S.cameraElevationReference="sea",S.recenterOnTerrain(),S.cameraElevationReference="ground",ye!==S.zoom&&this._map._update(!0)}if(!qs(o))return void this._fireEvents(d,y,!0);let{panDelta:L,zoomDelta:U,bearingDelta:G,pitchDelta:j,around:Y,aroundCoord:ne,pinchAround:se}=o;se!==void 0&&(Y=se),(ye=>d.drag&&!this._eventsInProgress.drag)()&&Y&&(this._dragOrigin=C(S.pointCoordinate3D(Y)),this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",M._stop(!0),Y=Y||M.transform.centerPoint,G&&(S.bearing+=G),j&&(S.pitch+=j),S._updateCameraState();const re=[0,0,0];if(L){const ye=S.pointCoordinate(Y);if(S.projection.name==="globe"){const ve=r.latFromMercatorY(ye.y),Me=S.center.lat,ge=Math.min(r.mercatorZfromAltitude(1,ve)/r.mercatorZfromAltitude(1,Me),2);L=L.rotate(-S.angle),re[0]=-L.x/S.worldSize*ge,re[1]=-L.y/S.worldSize*ge}else{const ve=S.pointCoordinate(Y.sub(L));ye&&ve&&(re[0]=ve.x-ye.x,re[1]=ve.y-ye.y)}}const Q=S.zoom,_e=[0,0,0];if(U){const ye=C(ne||S.pointCoordinate3D(Y)),ve={dir:r.normalize([],r.sub([],ye,S._camera.position))};if(ve.dir[2]<0){const Me=S.zoomDeltaToMovement(ye,U);r.scale$2(_e,ve.dir,Me)}}const ue=r.add(re,re,_e);S._translateCameraConstrained(ue),U&&Math.abs(S.zoom-Q)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,y,!0)}_fireEvents(o,d,y){const M=ic(this._eventsInProgress),S=ic(o),C={};for(const j in o){const{originalEvent:Y}=o[j];this._eventsInProgress[j]||(C[`${j}start`]=Y),this._eventsInProgress[j]=o[j]}!M&&S&&this._fireEvent("movestart",S.originalEvent);for(const j in C)this._fireEvent(j,C[j]);S&&this._fireEvent("move",S.originalEvent);for(const j in o){const{originalEvent:Y}=o[j];this._fireEvent(j,Y)}const L={};let U;for(const j in this._eventsInProgress){const{handlerName:Y,originalEvent:ne}=this._eventsInProgress[j];this._handlersById[Y].isActive()||(delete this._eventsInProgress[j],U=d[Y]||ne,L[`${j}end`]=U)}for(const j in L)this._fireEvent(j,L[j]);const G=ic(this._eventsInProgress);if(y&&(M||S)&&!G){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=ne=>ne!==0&&-this._bearingSnap<ne&&ne<this._bearingSnap;j?(Y(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:U})):(this._map.fire(new r.Event("moveend",{originalEvent:U})),Y(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new r.Event(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new vp("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const $u="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class _p extends r.Evented{constructor(o,d){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,r.bindAll(["_renderFrameCallback"],this)}getCenter(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,y){return o=r.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,r.extend({offset:o},d),y)}panTo(o,d,y){return this.easeTo(r.extend({center:o},d),y)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,y){return this.easeTo(r.extend({zoom:o},d),y)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,y){return this.easeTo(r.extend({bearing:o},d),y)}resetNorth(o,d){return this.rotateTo(0,r.extend({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=r.LngLatBounds.convert(o);const y=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),y,d)}_extendCameraOptions(o){const d={top:0,bottom:0,right:0,left:0};if(typeof(o=r.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const y=o.padding;o.padding={top:y,bottom:y,right:y,left:y}}return o.padding=r.extend(d,o.padding),o}_cameraForBoxAndBearing(o,d,y,M){const S=this._extendCameraOptions(M),C=this.transform,L=C.padding,U=C.project(r.LngLat.convert(o)),G=C.project(r.LngLat.convert(d)),j=new r.pointGeometry(U.x,G.y),Y=new r.pointGeometry(G.x,U.y),ne=-r.degToRad(y),se=U.rotate(ne),re=G.rotate(ne),Q=j.rotate(ne),_e=Y.rotate(ne),ue=new r.pointGeometry(Math.max(se.x,re.x,Q.x,_e.x),Math.max(se.y,re.y,Q.y,_e.y)),ye=new r.pointGeometry(Math.min(se.x,re.x,Q.x,_e.x),Math.min(se.y,re.y,Q.y,_e.y)),ve=ue.sub(ye),Me=(C.width-((L.left||0)+(L.right||0)+S.padding.left+S.padding.right))/ve.x,ge=(C.height-((L.top||0)+(L.bottom||0)+S.padding.top+S.padding.bottom))/ve.y;if(ge<0||Me<0)return void r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ce=Math.min(C.scaleZoom(C.scale*Math.min(Me,ge)),S.maxZoom),Qe=typeof S.offset.x=="number"&&typeof S.offset.y=="number"?new r.pointGeometry(S.offset.x,S.offset.y):r.pointGeometry.convert(S.offset),rt=new r.pointGeometry((S.padding.left-S.padding.right)/2,(S.padding.top-S.padding.bottom)/2).rotate(y*Math.PI/180),ht=Qe.add(rt).mult(C.scale/C.zoomScale(Ce));return{center:C.unproject(U.add(G).div(2).sub(ht)),zoom:Ce,bearing:y}}_cameraForBox(o,d,y,M,S){const C=this._extendCameraOptions(S);y=y||0,M=M||0,o=r.LngLat.convert(o),d=r.LngLat.convert(d);const L=this.transform.clone();L.padding=C.padding;const U=this.getFreeCameraOptions(),G=new r.LngLat(.5*(o.lng+d.lng),.5*(o.lat+d.lat)),j=.5*(y+M);if(L._camera.position[2]<r.mercatorZfromAltitude(j,G.lat))return void r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");U.lookAtPoint(G),L.setFreeCameraOptions(U);const Y=r.MercatorCoordinate.fromLngLat(o),ne=r.MercatorCoordinate.fromLngLat(d),se=L.pointRayIntersection(L.centerPoint,j),re=[(Q=L.rayIntersectionCoordinate(se)).x,Q.y,Q.z];var Q;const _e=L.screenPointToMercatorRay(L.centerPoint),ue=L.projection.name!=="globe";let ye,ve=0;do{const Me=Math.floor(L.zoom),ge=1<<Me,Ce=Math.min(ge*Y.x,ge*ne.x),Qe=Math.min(ge*Y.y,ge*ne.y),rt=Math.max(ge*Y.x,ge*ne.x),ht=Math.max(ge*Y.y,ge*ne.y),ct=new r.Aabb([Ce,Qe,y],[rt,ht,M]),Ft=r.Frustum.fromInvProjectionMatrix(L.invProjMatrix,L.worldSize,Me,ue);if(ct.intersects(Ft)!==2){ye&&(L._camera.position=r.scaleAndAdd([],L._camera.position,_e.dir,-ye),L._updateStateFromCamera());break}const $e=r.sub([],L._camera.position,re);ye=.5*r.length($e),L._camera.position=r.scaleAndAdd([],L._camera.position,_e.dir,ye);try{L._updateStateFromCamera()}catch(kt){return void r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++ve<10);return{center:L.center,zoom:L.zoom,bearing:L.bearing,pitch:L.pitch}}fitBounds(o,d,y){return this._fitInternal(this.cameraForBounds(o,d),d,y)}_raycastElevationBox(o,d){const y=this.transform.elevation;if(!y)return;const M=new r.pointGeometry(o.x,d.y),S=new r.pointGeometry(d.x,o.y),C=y.pointCoordinate(o);if(!C)return;const L=y.pointCoordinate(d);if(!L)return;const U=y.pointCoordinate(M);if(!U)return;const G=y.pointCoordinate(S);if(!G)return;const j=new r.MercatorCoordinate(C[0],C[1]).toLngLat(),Y=new r.MercatorCoordinate(L[0],L[1]).toLngLat(),ne=new r.MercatorCoordinate(U[0],U[1]).toLngLat(),se=new r.MercatorCoordinate(G[0],G[1]).toLngLat(),re=Math.min(j.lng,Math.min(Y.lng,Math.min(ne.lng,se.lng))),Q=Math.min(j.lat,Math.min(Y.lat,Math.min(ne.lat,se.lat))),_e=Math.max(j.lng,Math.max(Y.lng,Math.max(ne.lng,se.lng))),ue=Math.max(j.lat,Math.max(Y.lat,Math.max(ne.lat,se.lat))),ye=Math.min(C[3],Math.min(L[3],Math.min(U[3],G[3]))),ve=Math.max(C[3],Math.max(L[3],Math.max(U[3],G[3])));return{minLngLat:new r.LngLat(re,Q),maxLngLat:new r.LngLat(_e,ue),minAltitude:ye,maxAltitude:ve}}fitScreenCoordinates(o,d,y,M,S){let C,L,U,G;const j=r.pointGeometry.convert(o),Y=r.pointGeometry.convert(d),ne=this._raycastElevationBox(j,Y);if(ne)C=ne.minLngLat,L=ne.maxLngLat,U=ne.minAltitude,G=ne.maxAltitude;else{if(this.transform.anyCornerOffEdge(j,Y))return this;C=this.transform.pointLocation(j),L=this.transform.pointLocation(Y)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(r.pointGeometry.convert(o)),this.transform.pointLocation(r.pointGeometry.convert(d)),y,M):this._cameraForBox(C,L,U,G,M),M,S)}_fitInternal(o,d,y){return o?(delete(d=r.extend(o,d)).padding,d.linear?this.easeTo(d,y):this.flyTo(d,y)):this}jumpTo(o,d){this.stop();const y=o.preloadOnly?this.transform.clone():this.transform;let M=!1,S=!1,C=!1;return"zoom"in o&&y.zoom!==+o.zoom&&(M=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=r.LngLat.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(S=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(C=!0,y.pitch=+o.pitch),o.padding==null||y.isPaddingEqual(o.padding)||(y.padding=o.padding),o.preloadOnly?(this._preloadTiles(y),this):(this.fire(new r.Event("movestart",d)).fire(new r.Event("move",d)),M&&this.fire(new r.Event("zoomstart",d)).fire(new r.Event("zoom",d)).fire(new r.Event("zoomend",d)),S&&this.fire(new r.Event("rotatestart",d)).fire(new r.Event("rotate",d)).fire(new r.Event("rotateend",d)),C&&this.fire(new r.Event("pitchstart",d)).fire(new r.Event("pitch",d)).fire(new r.Event("pitchend",d)),this.fire(new r.Event("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.warnOnce($u),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,d){const y=this.transform;if(!y.projection.supportsFreeCamera)return r.warnOnce($u),this;this.stop();const M=y.zoom,S=y.pitch,C=y.bearing;y.setFreeCameraOptions(o);const L=M!==y.zoom,U=S!==y.pitch,G=C!==y.bearing;return this.fire(new r.Event("movestart",d)).fire(new r.Event("move",d)),L&&this.fire(new r.Event("zoomstart",d)).fire(new r.Event("zoom",d)).fire(new r.Event("zoomend",d)),G&&this.fire(new r.Event("rotatestart",d)).fire(new r.Event("rotate",d)).fire(new r.Event("rotateend",d)),U&&this.fire(new r.Event("pitchstart",d)).fire(new r.Event("pitch",d)).fire(new r.Event("pitchend",d)),this.fire(new r.Event("moveend",d)),this}easeTo(o,d){this._stop(!1,o.easeId),((o=r.extend({offset:[0,0],duration:500,easing:r.ease},o)).animate===!1||!o.essential&&r.exported.prefersReducedMotion)&&(o.duration=0);const y=this.transform,M=this.getZoom(),S=this.getBearing(),C=this.getPitch(),L=this.getPadding(),U="zoom"in o?+o.zoom:M,G="bearing"in o?this._normalizeBearing(o.bearing,S):S,j="pitch"in o?+o.pitch:C,Y="padding"in o?o.padding:y.padding,ne=r.pointGeometry.convert(o.offset);let se,re,Q;if(y.projection.name==="globe"){const ht=r.MercatorCoordinate.fromLngLat(y.center),ct=ne.rotate(-y.angle);ht.x+=ct.x/y.worldSize,ht.y+=ct.y/y.worldSize;const Ft=ht.toLngLat(),$e=r.LngLat.convert(o.center||Ft);this._normalizeCenter($e),se=y.centerPoint.add(ct),re=new r.pointGeometry(ht.x,ht.y).mult(y.worldSize),Q=new r.pointGeometry(r.mercatorXfromLng($e.lng),r.mercatorYfromLat($e.lat)).mult(y.worldSize).sub(re)}else{se=y.centerPoint.add(ne);const ht=y.pointLocation(se),ct=r.LngLat.convert(o.center||ht);this._normalizeCenter(ct),re=y.project(ht),Q=y.project(ct).sub(re)}const _e=y.zoomScale(U-M);let ue,ye;o.around&&(ue=r.LngLat.convert(o.around),ye=y.locationPoint(ue));const ve=this._zooming||U!==M,Me=this._rotating||S!==G,ge=this._pitching||j!==C,Ce=!y.isPaddingEqual(Y),Qe=ht=>ct=>{if(ve&&(ht.zoom=r.number(M,U,ct)),Me&&(ht.bearing=r.number(S,G,ct)),ge&&(ht.pitch=r.number(C,j,ct)),Ce&&(ht.interpolatePadding(L,Y,ct),se=ht.centerPoint.add(ne)),ue)ht.setLocationAtPoint(ue,ye);else{const Ft=ht.zoomScale(ht.zoom-M),$e=U>M?Math.min(2,_e):Math.max(.5,_e),kt=Math.pow($e,1-ct),Ct=ht.unproject(re.add(Q.mult(ct*kt)).mult(Ft));ht.setLocationAtPoint(ht.renderWorldCopies?Ct.wrap():Ct,se)}return o.preloadOnly||this._fireMoveEvents(d),ht};if(o.preloadOnly){const ht=this._emulate(Qe,o.duration,y);return this._preloadTiles(ht),this}const rt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ve,this._rotating=Me,this._pitching=ge,this._padding=Ce,this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,rt),this._ease(Qe(y),ht=>{y.recenterOnTerrain(),this._afterEase(d,ht)},o),this}_prepareEase(o,d,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||y.moving||this.fire(new r.Event("movestart",o)),this._zooming&&!y.zooming&&this.fire(new r.Event("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new r.Event("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new r.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new r.Event("move",o)),this._zooming&&this.fire(new r.Event("zoom",o)),this._rotating&&this.fire(new r.Event("rotate",o)),this._pitching&&this.fire(new r.Event("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,M=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new r.Event("zoomend",o)),M&&this.fire(new r.Event("rotateend",o)),S&&this.fire(new r.Event("pitchend",o)),this.fire(new r.Event("moveend",o))}flyTo(o,d){if(!o.essential&&r.exported.prefersReducedMotion){const Kt=r.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Kt,d)}this.stop(),o=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},o);const y=this.transform,M=this.getZoom(),S=this.getBearing(),C=this.getPitch(),L=this.getPadding(),U="zoom"in o?r.clamp(+o.zoom,y.minZoom,y.maxZoom):M,G="bearing"in o?this._normalizeBearing(o.bearing,S):S,j="pitch"in o?+o.pitch:C,Y="padding"in o?o.padding:y.padding,ne=y.zoomScale(U-M),se=r.pointGeometry.convert(o.offset);let re=y.centerPoint.add(se);const Q=y.pointLocation(re),_e=r.LngLat.convert(o.center||Q);this._normalizeCenter(_e);const ue=y.project(Q),ye=y.project(_e).sub(ue);let ve=o.curve;const Me=Math.max(y.width,y.height),ge=Me/ne,Ce=ye.mag();if("minZoom"in o){const Kt=r.clamp(Math.min(o.minZoom,M,U),y.minZoom,y.maxZoom),Zt=Me/y.zoomScale(Kt-M);ve=Math.sqrt(Zt/Ce*2)}const Qe=ve*ve;function rt(Kt){const Zt=(ge*ge-Me*Me+(Kt?-1:1)*Qe*Qe*Ce*Ce)/(2*(Kt?ge:Me)*Qe*Ce);return Math.log(Math.sqrt(Zt*Zt+1)-Zt)}function ht(Kt){return(Math.exp(Kt)-Math.exp(-Kt))/2}function ct(Kt){return(Math.exp(Kt)+Math.exp(-Kt))/2}const Ft=rt(0);let $e=function(Kt){return ct(Ft)/ct(Ft+ve*Kt)},kt=function(Kt){return Me*((ct(Ft)*(ht(Zt=Ft+ve*Kt)/ct(Zt))-ht(Ft))/Qe)/Ce;var Zt},Ct=(rt(1)-Ft)/ve;if(Math.abs(Ce)<1e-6||!isFinite(Ct)){if(Math.abs(Me-ge)<1e-6)return this.easeTo(o,d);const Kt=ge<Me?-1:1;Ct=Math.abs(Math.log(ge/Me))/ve,kt=function(){return 0},$e=function(Zt){return Math.exp(Kt*ve*Zt)}}o.duration="duration"in o?+o.duration:1e3*Ct/("screenSpeed"in o?+o.screenSpeed/ve:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Qt=S!==G,dt=j!==C,Yt=!y.isPaddingEqual(Y),gn=Kt=>Zt=>{const wn=Zt*Ct,Nn=1/$e(wn);Kt.zoom=Zt===1?U:M+Kt.scaleZoom(Nn),Qt&&(Kt.bearing=r.number(S,G,Zt)),dt&&(Kt.pitch=r.number(C,j,Zt)),Yt&&(Kt.interpolatePadding(L,Y,Zt),re=Kt.centerPoint.add(se));const pn=Zt===1?_e:Kt.unproject(ue.add(ye.mult(kt(wn))).mult(Nn));return Kt.setLocationAtPoint(Kt.renderWorldCopies?pn.wrap():pn,re),Kt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(d),Kt};if(o.preloadOnly){const Kt=this._emulate(gn,o.duration,y);return this._preloadTiles(Kt),this}return this._zooming=!0,this._rotating=Qt,this._pitching=dt,this._padding=Yt,this._prepareEase(d,!1),this._ease(gn(y),()=>this._afterEase(d),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,d)}if(!o){const y=this.handlers;y&&y.stop(!1)}return this}_ease(o,d,y){y.animate===!1||y.duration===0?(o(1),d()):(this._easeStart=r.exported.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((r.exported.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,d){o=r.wrap(o,-180,180);const y=Math.abs(o-d);return Math.abs(o-360-d)<y&&(o-=360),Math.abs(o+360-d)<y&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.maxBounds)return;const y=o.lng-d.center.lng;o.lng+=y>180?-360:y<-180?360:0}_emulate(o,d,y){const M=Math.ceil(15*d/1e3),S=[],C=o(y.clone());for(let L=0;L<=M;L++){const U=C(L/M);S.push(U.clone())}return S}}class eh{constructor(o={}){this.options=o,r.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const d=this.options&&this.options.compact;return this._map=o,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E("button","mapboxgl-ctrl-attrib-button",this._container),E("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const y=this._map._getUIString(`AttributionControl.${d}`);o.setAttribute("aria-label",y),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(o){const y=d.reduce((M,S,C)=>(S.value&&(M+=`${S.key}=${S.value}${C<d.length-1?"&":""}`),M),"?");o.href=`${r.config.FEEDBACK_URL}/${y}${this._map._hash?this._map._hash.getHashString(!0):""}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const M=this._map.style.stylesheet;this.styleOwner=M.owner,this.styleId=M.id}const d=this._map.style._sourceCaches;for(const M in d){const S=d[M];if(S.used){const C=S.getSource();C.attribution&&o.indexOf(C.attribution)<0&&o.push(C.attribution)}}o.sort((M,S)=>M.length-S.length),o=o.filter((M,S)=>{for(let C=S+1;C<o.length;C++)if(o[C].indexOf(M)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const y=o.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,o.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Gg{constructor(){r.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=E("div","mapboxgl-ctrl");const d=E("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const d in o){const y=o[d].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class jg{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const M of y)if(M.id===o)return void(M.cancelled=!0)}run(o=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function th(m,o,d){if(m=new r.LngLat(m.lng,m.lat),o){const y=new r.LngLat(m.lng-360,m.lat),M=new r.LngLat(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-d.center.lng)/360),C=d.locationPoint(m).distSqr(o),L=o.x<0||o.y<0||o.x>d.width||o.y>d.height;d.locationPoint(y).distSqr(o)<C&&(L||Math.abs(y.lng-d.center.lng)<S)?m=y:d.locationPoint(M).distSqr(o)<C&&(L||Math.abs(M.lng-d.center.lng)<S)&&(m=M)}for(;Math.abs(m.lng-d.center.lng)>180;){const y=d.locationPoint(m);if(y.x>=0&&y.y>=0&&y.x<=d.width&&y.y<=d.height)break;m.lng>d.center.lng?m.lng-=360:m.lng+=360}return m}const nh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ih extends r.Evented{constructor(o,d){if(super(),(o instanceof r.window.HTMLElement||d)&&(o=r.extend({element:o},d)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),o&&o.element)this._element=o.element,this._offset=r.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=E("div");const M=41,S=27,C=P("svg",{display:"block",height:M*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${M}`},this._element),L=P("radialGradient",{id:"shadowGradient"},P("defs",{},C));P("stop",{offset:"10%","stop-opacity":.4},L),P("stop",{offset:"100%","stop-opacity":.05},L),P("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),P("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),P("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),P("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=r.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",M=>{M.preventDefault()}),this._element.addEventListener("mousedown",M=>{M.preventDefault()});const y=this._element.classList;for(const M in nh)y.remove(`mapboxgl-marker-anchor-${M}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=r.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const M=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[M,-1*(38.1-13.5+M)],"bottom-right":[-M,-1*(38.1-13.5+M)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const d=o.code,y=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(o){const d=o.originalEvent.target,y=this._element;this._popup&&(d===y||y.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const o=this._map;if(!o)return;const d=this._pos;if(!d||d.x<0||d.x>o.transform.width||d.y<0||d.y>o.transform.height)return void this._clearFadeTimer();const y=o.unproject(d);let M=!1;if(o.transform._terrainEnabled()&&o.getTerrain()){const C=o.getFreeCameraOptions();if(C.position){const L=C.position.toLngLat();M=L.distanceTo(y)<.9*L.distanceTo(this._lngLat)}}const S=(1-o._queryFogOpacity(y))*(M?.2:1);this._element.style.opacity=`${S}`,this._popup&&this._popup._setOpacity(`${S}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o)return;const d=this._offset.mult(this._scale),y=this._calculatePitch(),M=this._calculateRotation();this._element.style.transform=`
            translate(${o.x}px, ${o.y}px) ${nh[this._anchor]}
            rotateX(${y}deg) rotateZ(${M}deg)
            translate(${d.x}px, ${d.y}px)
        `}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._map&&this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._map&&this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(o){r.window.cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=th(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),o===!0?this._updateFrameId=r.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!d.getTerrain()&&!d.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=r.pointGeometry.convert(o),this._update(),this}_onMove(o){const d=this._map;if(d){if(!this._isDragging){const y=this._clickTolerance||d._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.Event("dragend")),this._state="inactive"}_addDragHandler(o){const d=this._map;d&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos),this._pointerdownPos=o.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const d=this._map;return d&&(o?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Kx{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const d=r.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,d,y){this._start=this.getValue(d),this._end=o,this._startTime=d,this._endTime=d+y}}const Zx={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},bp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function rc(m){m.parentNode&&m.parentNode.removeChild(m)}const wp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ap{constructor(o,d,y=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Ws({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,y&&(this.mousePitch=new fp({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(o,d){this.mouseRotate.mousedown(o,d),this.mousePitch&&this.mousePitch.mousedown(o,d),O()}move(o,d){const y=this.map,M=this.mouseRotate.mousemoveWindow(o,d),S=M&&M.bearingDelta;if(S&&y.setBearing(y.getBearing()+S),this.mousePitch){const C=this.mousePitch.mousemoveWindow(o,d),L=C&&C.pitchDelta;L&&y.setPitch(y.getPitch()+L)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){W(),r.window.removeEventListener("mousemove",this.mousemove),r.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(r.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),$(this.element,o)),r.window.addEventListener("mousemove",this.mousemove),r.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,$(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=oe(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Sr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Nr,oc=0,ns=!1;const Mp={maxWidth:100,unit:"metric"};function rh(m,o,d){const y=d&&d.maxWidth||100,M=m._containerHeight/2,S=m._containerWidth/2-y/2,C=m.unproject([S,M]),L=m.unproject([S+y,M]),U=C.distanceTo(L);if(d&&d.unit==="imperial"){const G=3.2808*U;G>5280?Ys(o,y,G/5280,m._getUIString("ScaleControl.Miles"),m):Ys(o,y,G,m._getUIString("ScaleControl.Feet"),m)}else d&&d.unit==="nautical"?Ys(o,y,U/1852,m._getUIString("ScaleControl.NauticalMiles"),m):U>=1e3?Ys(o,y,U/1e3,m._getUIString("ScaleControl.Kilometers"),m):Ys(o,y,U,m._getUIString("ScaleControl.Meters"),m)}function Ys(m,o,d,y,M){const S=function(L){const U=Math.pow(10,`${Math.floor(L)}`.length-1);let G=L/U;return G=G>=10?10:G>=5?5:G>=3?3:G>=2?2:G>=1?1:function(j){const Y=Math.pow(10,Math.ceil(-Math.log(j)/Math.LN10));return Math.round(j*Y)/Y}(G),U*G}(d),C=S/d;M._requestDomTask(()=>{m.style.width=o*C+"px",m.innerHTML=`${S}&nbsp;${y}`})}const $r={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ac(m=new r.pointGeometry(0,0),o="bottom"){if(typeof m=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(o){case"top":return new r.pointGeometry(0,m);case"top-left":return new r.pointGeometry(d,d);case"top-right":return new r.pointGeometry(-d,d);case"bottom":return new r.pointGeometry(0,-m);case"bottom-left":return new r.pointGeometry(d,-d);case"bottom-right":return new r.pointGeometry(-d,-d);case"left":return new r.pointGeometry(m,0);case"right":return new r.pointGeometry(-m,0)}return new r.pointGeometry(0,0)}return m instanceof r.pointGeometry||Array.isArray(m)?r.pointGeometry.convert(m):r.pointGeometry.convert(m[o]||[0,0])}const Xs={version:r.version,supported:v,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:class extends _p{constructor(m){if((m=r.extend({},bp,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&r.isSafariWithAntialiasingBug(r.window)&&(m.antialias=!1,r.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Xu(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._renderTaskQueue=new jg,this._domRenderTaskQueue=new jg,this._controls=[],this._markers=[],this._mapId=r.uniqueId(),this._locale=r.extend({},Zx,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Kx(0),this._explicitProjection=null,this._requestManager=new r.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=r.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof r.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&r.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),r.window!==void 0&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1),r.window.addEventListener("orientationchange",this._onWindowResize,!1),r.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Og(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new bg(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,r.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new eh({customAttribution:m.customAttribution})),this._logoControl=new Gg,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new r.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new r.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(m,o){if(o===void 0&&(o=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=m.onAdd(this);this._controls.push(m);const y=this._controlPositions[o];return o.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(m);return o>-1&&this._controls.splice(o,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new r.Event("movestart",m)).fire(new r.Event("move",m)),this.fire(new r.Event("resize",m)),o&&this.fire(new r.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(r.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m==null?85:m)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._updateProjection(m)}_updateProjection(m){m===null&&(this._explicitProjection=null);const o=m||this.getProjection(),d=this.transform.setProjection(o);if(m&&(this._explicitProjection=this.transform.getProjection()),d){this.painter.clearBackgroundTiles();for(const y in this.style._sourceCaches)this.style._sourceCaches[y].clearTiles();this.style.applyProjectionUpdate(),this._update(!0)}return this}project(m){return this.transform.locationPoint3D(r.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(r.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(m,o,d){if(m==="mouseenter"||m==="mouseover"){let y=!1;const M=C=>{const L=o.filter(G=>this.getLayer(G)),U=L.length?this.queryRenderedFeatures(C.point,{layers:L}):[];U.length?y||(y=!0,d.call(this,new Ur(m,this,C.originalEvent,{features:U}))):y=!1},S=()=>{y=!1};return{layers:new Set(o),listener:d,delegates:{mousemove:M,mouseout:S}}}if(m==="mouseleave"||m==="mouseout"){let y=!1;const M=C=>{const L=o.filter(U=>this.getLayer(U));(L.length?this.queryRenderedFeatures(C.point,{layers:L}):[]).length?y=!0:y&&(y=!1,d.call(this,new Ur(m,this,C.originalEvent)))},S=C=>{y&&(y=!1,d.call(this,new Ur(m,this,C.originalEvent)))};return{layers:new Set(o),listener:d,delegates:{mousemove:M,mouseout:S}}}{const y=M=>{const S=o.filter(L=>this.getLayer(L)),C=S.length?this.queryRenderedFeatures(M.point,{layers:S}):[];C.length&&(M.features=C,d.call(this,M),delete M.features)};return{layers:new Set(o),listener:d,delegates:{[m]:y}}}}on(m,o,d){if(d===void 0)return super.on(m,o);Array.isArray(o)||(o=[o]);const y=this._createDelegatedListener(m,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(y);for(const M in y.delegates)this.on(M,y.delegates[M]);return this}once(m,o,d){if(d===void 0)return super.once(m,o);Array.isArray(o)||(o=[o]);const y=this._createDelegatedListener(m,o,d);for(const M in y.delegates)this.once(M,y.delegates[M]);return this}off(m,o,d){if(d===void 0)return super.off(m,o);o=new Set(Array.isArray(o)?o:[o]);const y=(S,C)=>{if(S.size!==C.size)return!1;for(const L of S)if(!C.has(L))return!1;return!0},M=this._delegatedListeners?this._delegatedListeners[m]:void 0;return M&&(S=>{for(let C=0;C<S.length;C++){const L=S[C];if(L.listener===d&&y(L.layers,o)){for(const U in L.delegates)this.off(U,L.delegates[U]);return S.splice(C,1),this}}})(M),this}queryRenderedFeatures(m,o){return this.style?(o!==void 0||m===void 0||m instanceof r.pointGeometry||Array.isArray(m)||(o=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(m,o){return this.style.querySourceFeatures(m,o)}queryTerrainElevation(m,o){const d=this.transform.elevation;return d?(o=r.extend({},{exaggerated:!0},o),d.getAtPoint(r.MercatorCoordinate.fromLngLat(m),null,o.exaggerated)):null}setStyle(m,o){return(o=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(m,o))}_getUIString(m){const o=this._locale[m];if(o==null)throw new Error(`Missing UI string '${m}'`);return o}_updateStyle(m,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new Mr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,o){if(typeof m=="string"){const d=this._requestManager.normalizeStyleURL(m),y=this._requestManager.transformRequest(d,r.ResourceType.Style);r.getJSON(y,(M,S)=>{M?this.fire(new r.ErrorEvent(M)):S&&this._updateDiff(S,o)})}else typeof m=="object"&&this._updateDiff(m,o)}_updateDiff(m,o){try{this.style.setState(m)&&this._update(!0)}catch(d){r.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(m,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.warnOnce("There is no style added to the map."),!1)}addSource(m,o){return this._lazyInitEmptyStyle(),this.style.addSource(m,o),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const o in m){const d=m[o]._tiles;for(const y in d){const M=d[y];if(M.state!=="loaded"&&M.state!=="errored")return!1}}return!0}addSourceType(m,o,d){this._lazyInitEmptyStyle(),this.style.addSourceType(m,o,d)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,o,{pixelRatio:d=1,sdf:y=!1,stretchX:M,stretchY:S,content:C}={}){if(this._lazyInitEmptyStyle(),o instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&o instanceof r.window.ImageBitmap){const{width:L,height:U,data:G}=r.exported.getImageData(o);this.style.addImage(m,{data:new r.RGBAImage({width:L,height:U},G),pixelRatio:d,stretchX:M,stretchY:S,content:C,sdf:y,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:L,height:U}=o,G=o;this.style.addImage(m,{data:new r.RGBAImage({width:L,height:U},new Uint8Array(G.data)),pixelRatio:d,stretchX:M,stretchY:S,content:C,sdf:y,version:0,userImage:G}),G.onAdd&&G.onAdd(this,m)}}updateImage(m,o){const d=this.style.getImage(m);if(!d)return void this.fire(new r.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=o instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&o instanceof r.window.ImageBitmap?r.exported.getImageData(o):o,{width:M,height:S}=y;M!==void 0&&S!==void 0?M===d.data.width&&S===d.data.height?(d.data.replace(y.data,!(o instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&o instanceof r.window.ImageBitmap)),this.style.updateImage(m,d)):this.fire(new r.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new r.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,o){r.getImage(this._requestManager.transformRequest(m,r.ResourceType.Image),(d,y)=>{o(d,y instanceof r.window.HTMLImageElement?r.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(m,o){return this._lazyInitEmptyStyle(),this.style.addLayer(m,o),this._update(!0)}moveLayer(m,o){return this.style.moveLayer(m,o),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,o,d){return this.style.setLayerZoomRange(m,o,d),this._update(!0)}setFilter(m,o,d={}){return this.style.setFilter(m,o,d),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,o,d,y={}){return this.style.setPaintProperty(m,o,d,y),this._update(!0)}getPaintProperty(m,o){return this.style.getPaintProperty(m,o)}setLayoutProperty(m,o,d,y={}){return this.style.setLayoutProperty(m,o,d,y),this._update(!0)}getLayoutProperty(m,o){return this.style.getLayoutProperty(m,o)}setLight(m,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.LngLat.convert(m),this.transform):0}setFeatureState(m,o){return this.style.setFeatureState(m,o),this._update()}removeFeatureState(m,o){return this.style.removeFeatureState(m,o),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let d,y,M,S=this._container;for(;S&&(!y||!M);){const C=r.window.getComputedStyle(S).transform;C&&C!=="none"&&(d=C.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(y=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(M=d[3])),S=S.parentElement}this._containerWidth=y?Math.abs(m/y):m,this._containerHeight=M?Math.abs(o/M):o}_detectMissingCSS(){r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=E("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=E("div","mapboxgl-canvas-container",m);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=E("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=E("div","mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{y[M]=E("div",`mapboxgl-ctrl-${M}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,o){const d=r.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(m),this._canvas.height=d*Math.ceil(o),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${o}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const o=this._markers.indexOf(m);o!==-1&&this._markers.splice(o,1)}_setupPainter(){const m=r.extend({},v.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);o?(r.storeAuthState(o,!0),this.painter=new vg(o,this.transform),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.exported$1.testSupport(o)):this.fire(new r.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let o;const d=this.painter.context.extTimerQuery,y=r.exported.now();if(this.listens("gpu-timing-frame")&&(o=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;let M=!1;const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,G=this.transform.pitch,j=r.exported.now();this.style.zoomHistory.update(U,j);const Y=new r.EvaluationParameters(U,{now:j,fadeDuration:S,pitch:G,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ne=Y.crossFadingFactor();ne===1&&ne===this._crossFadingFactor||(M=!0,this._crossFadingFactor=ne),this.style.update(Y)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerUpdate()):C=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const U=r.exported.now()-y;d.endQueryEXT(d.TIME_ELAPSED_EXT,o),setTimeout(()=>{const G=d.getQueryObjectEXT(o,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(o),this.fire(new r.Event("gpu-timing-frame",{cpuTime:U,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(U);this.fire(new r.Event("gpu-timing-layer",{layerTimes:G}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(L||this._repaint)this.triggerRepaint();else{const U=!this.isMoving()&&this.loaded();if(U&&(C=this._updateAverageElevation(y,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new r.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new r.Event("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const m of this._markers)m._update()}_updateAverageElevation(m,o=!1){const d=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);if((o||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const y=this.transform.averageElevation;let M=this.transform.sampleAverageElevation(),S=!1;this.transform.elevation&&(S=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(M)?M=0:this._averageElevationLastSampledAt=m;const C=Math.abs(y-M);if(C>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(M),d(M);this._averageElevation.easeTo(M,m,300)}else if(C>1e-4)return this._averageElevation.jumpTo(M),d(M)}return!!this._averageElevation.isEasing(m)&&d(this._averageElevation.getValue(m))}_authenticate(){r.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===r.AUTH_ERR_MSG||m.status===401)){const o=this.painter.context.gl;r.storeAuthState(o,!1),this._logoControl instanceof Gg&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),r.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const d=this.painter.context.gl,y=d.createFramebuffer();function M(S){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,S,0);const C=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,C),C}return d.bindFramebuffer(d.FRAMEBUFFER,y),this._canvasPixelComparison(M(m),o.canvasCopies.map(M),o.timeStamps)}_canvasPixelComparison(m,o,d){let y=d[1]-d[0];const M=m.length/4;for(let S=0;S<o.length;S++){const C=o[S];let L=0;for(let U=0;U<C.length;U+=4)C[U]===m[U]&&C[U+1]===m[U+1]&&C[U+2]===m[U+2]&&C[U+3]===m[U+3]&&(L+=1);y+=(d[S+2]-d[S+1])*(1-L/M)}return y}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),r.window!==void 0&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("orientationchange",this._onWindowResize,!1),r.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),rc(this._canvasContainer),rc(this._controlContainer),rc(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),r.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new r.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=r.exported.frame(o=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(o)}))}_preloadTiles(m){const o=this.style?Object.values(this.style._sourceCaches):[];return r.asyncAll(o,(d,y)=>d._preloadTiles(m,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}_setCacheLimits(m,o){r.setCacheLimits(m,o)}get version(){return r.version}},NavigationControl:class{constructor(m){this.options=r.extend({},wp,m),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),E("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),E("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:o}):d.resetNorth({},{originalEvent:o}))}),this._compassIcon=E("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const o=m.getZoom(),d=o===m.getMaxZoom(),y=o===m.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ap(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,o){const d=E("button",m,this._container);return d.type="button",d.addEventListener("click",o),d}_setButtonTitle(m,o){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${o}`);m.setAttribute("aria-label",d),m.firstElementChild&&m.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends r.Evented{constructor(m){super(),this.options=r.extend({},Sr,m),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=pp(this._updateMarkerRotation,20)}onAdd(m){var o;return this._map=m,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,Nr!==void 0?o(Nr):r.window.navigator.permissions!==void 0?r.window.navigator.permissions.query({name:"geolocation"}).then(d=>{Nr=d.state!=="denied",o(Nr)}):(Nr=!!r.window.navigator.geolocation,o(Nr)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,oc=0,ns=!1}_isOutOfMapMaxBounds(m){const o=this._map.getMaxBounds(),d=m.coords;return!!o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",m)),this._finish()}}_updateCamera(m){const o=new r.LngLat(m.coords.longitude,m.coords.latitude),d=m.coords.accuracy,y=this._map.getBearing(),M=r.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(d),M,{geolocateSource:!0})}_updateMarker(m){if(m){const o=new r.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map._containerHeight/2,o=this._map.unproject([0,m]),d=this._map.unproject([100,m]),y=o.distanceTo(d)/100,M=Math.ceil(2*this._accuracy/y);this._circleElement.style.width=`${M}px`,this._circleElement.style.height=`${M}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&ns)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=E("button","mapboxgl-ctrl-geolocate",this._container),E("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E("div","mapboxgl-user-location"),this._dotElement.appendChild(E("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(E("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ih({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=E("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ih({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.Event("trackuserlocationend")))})}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":oc--,ns=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),oc++,oc>1?(m={maximumAge:6e5,timeout:0},ns=!0):(m=this.options.positionOptions,ns=!1),this._geolocationWatchID=r.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else r.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{r.window.addEventListener("ondeviceorientationabsolute"in r.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};r.window.DeviceMotionEvent!==void 0&&typeof r.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&m()}).catch(console.error):m()}_clearWatch(){r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:eh,ScaleControl:class{constructor(m){this.options=r.extend({},Mp,m),r.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){rh(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,rh(this._map,this._container,this.options)}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof r.window.HTMLElement?this._container=m.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in r.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!r.window.document.fullscreenEnabled&&!r.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=E("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(r.window.document.fullscreenElement||r.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.Evented{constructor(m){super(),this.options=r.extend(Object.create($r),m),r.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new r.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new r.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=r.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(r.window.document.createTextNode(m))}setHTML(m){const o=r.window.document.createDocumentFragment(),d=r.window.document.createElement("body");let y;for(d.innerHTML=m;y=d.firstChild,y;)o.appendChild(y);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=E("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(m),this.options.closeButton){const d=this._closeButton=E("button","mapboxgl-popup-close-button",o);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let o;return this._classList.delete(m)?o=!1:(this._classList.add(m),o=!0),this._updateClassList(),o}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const o=this._map,d=this._container,y=this._pos;if(!o||!d||!y)return"bottom";const M=d.offsetWidth,S=d.offsetHeight,C=y.x<M/2,L=y.x>o.transform.width-M/2;if(y.y+m<S)return C?"top-left":L?"top-right":"top";if(y.y>o.transform.height-S){if(C)return"bottom-left";if(L)return"bottom-right"}return C?"left":L?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),m.className=o.join(" ")}_update(m){const o=this._map,d=this._content;if(!o||!this._lngLat&&!this._trackPointer||!d)return;let y=this._container;if(y||(y=this._container=E("div","mapboxgl-popup",o.getContainer()),this._tip=E("div","mapboxgl-popup-tip",y),y.appendChild(d)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=th(this._lngLat,this._pos,o.transform)),!this._trackPointer||m){const M=this._pos=this._trackPointer&&m?m:o.project(this._lngLat),S=ac(this.options.offset),C=this._anchor=this._getAnchor(S.y),L=ac(this.options.offset,C),U=M.add(L).round();o._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${nh[C]} translate(${U.x}px,${U.y}px)`)})}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(mi);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._content&&(this._content.style.opacity=m),this._tip&&(this._tip.style.opacity=m)}},Marker:ih,Style:Mr,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.pointGeometry,MercatorCoordinate:r.MercatorCoordinate,FreeCameraOptions:Kl,Evented:r.Evented,config:r.config,prewarm:function(){Te().acquire(vn)},clearPrewarmedResources:function(){const m=ee;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(vn),ee=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(m){r.config.ACCESS_TOKEN=m},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(m){r.config.API_URL=m},get workerCount(){return X.workerCount},set workerCount(m){X.workerCount=m},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){r.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){r.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:r.exported.setNow,restoreNow:r.exported.restoreNow};return Xs});var f=c;return f})})(y1);var X3=y1.exports;const K3=Y3(X3),bc={tdtsl(){return{layers:[["tdtsl","TianDiTu.Normal.Map"],["tdtslzj","TianDiTu.Normal.Annotion"]],key:"fb258b4c0bbf60ff7a0205b519ad9a96"}},tdtyx(){return{layers:[["tdtyx","TianDiTu.Satellite.Map"],["tdtyxzj","TianDiTu.Satellite.Annotion"]],key:"fb258b4c0bbf60ff7a0205b519ad9a96"}},tdtdx(){return{layers:[["tdtdx","TianDiTu.Terrain.Map"],["tdtdxzj","TianDiTu.Terrain.Annotion"]],key:"fb258b4c0bbf60ff7a0205b519ad9a96"}},gdsl(){return{layers:[["gdsl","GaoDe.Normal.Map"]]}},gdslwzj(){return{layers:[["gdslwzj","GaoDe.Normal_NoTag.Map"]]}},gdyx(){return{layers:[["gdyx","GaoDe.Satellite.Map"],["gdyxzj","GaoDe.Satellite.Annotion"]]}},bdsl(){return{layers:[["bdsl","Baidu.Normal.Map"]]}},bdyx(){return{layers:[["bdyx","Baidu.Satellite.Map"],["bdyxzj","Baidu.Satellite.Annotion"]]}},osm(){return{layers:[["osm","OSM.Normal.Map"]]}},geoq(){return{layers:[["geoq","Geoq.Normal.Map"]]}},geoqPurplishBlue(){return{layers:[["geoqPurplishBlue","Geoq.Normal.PurplishBlue"]]}},geoqGray(){return{layers:[["geoqGray","Geoq.Normal.Gray"]]}},geoqWarm(){return{layers:[["geoqWarm","Geoq.Normal.Warm"]]}},geoqCold(){return{layers:[["geoqCold","Geoq.Normal.Cold"]]}}};function Z3(e){const t="./gis/radar.tiff";console.log(t);let i=(114.06825863001939-104.18084906665138)*.005,l=(32.396413467808586-22.54283198132819)*.005,c=114.07867152431874,h=22.563727343812303;e.addSource("radar",{type:"image",url:t,coordinates:[[c-i*.5,h+l*.5],[c+i*.5,h+l*.5],[c+i*.5,h-l*.5],[c-i*.5,h-l*.5]]}),e.addLayer({id:"radar-layer",type:"raster",source:"radar",paint:{"raster-fade-duration":0}})}function J3(e){var t="http://192.168.5.19:8080/geoserver/gwc/service/wmts?layer=mytest%3Amxcadtest2&style=&tilematrixset=EPSG:900913&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image/png&TileMatrix=EPSG:900913:{z}&TileCol={x}&TileRow={y}";e.addSource("wmts-source",{type:"raster",tiles:[t],tileSize:256}),e.addLayer({id:"wmts-layer",type:"raster",source:"wmts-source",paint:{"raster-opacity":.95}})}function Q3(){return{TianDiTu:{Normal:{Map:"http://t{s}.tianditu.com/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"http://t{s}.tianditu.com/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk={key}",minzoom:0,maxzoom:18},Satellite:{Map:"http://t{s}.tianditu.com/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"http://t{s}.tianditu.com/DataServer?T=cia_w&X={x}&Y={y}&L={z}&tk={key}",minzoom:0,maxzoom:18},Terrain:{Map:"http://t{s}.tianditu.com/DataServer?T=ter_w&X={x}&Y={y}&L={z}&tk={key}",Annotion:"http://t{s}.tianditu.com/DataServer?T=cta_w&X={x}&Y={y}&L={z}&tk={key}",minzoom:0,maxzoom:14},Subdomains:["0","1","2","3","4","5","6","7"],key:""},GaoDe:{Normal:{Map:"http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",minzoom:0,maxzoom:18},Normal_NoTag:{Map:"https://wprd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&scl=1&ltype=11&x={x}&y={y}&z={z}",minzoom:3,maxzoom:18},Satellite:{Map:"http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",Annotion:"http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",minzoom:3,maxzoom:18},Subdomains:["1","2","3","4"]},Baidu:{Normal:{Map:"http://online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles=pl&scaler=1&p=1"},Satellite:{Map:"http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",Annotion:"http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=020"},Subdomains:"0123456789",tileType:"bd09"},Geoq:{Normal:{Map:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",PurplishBlue:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",Gray:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",Warm:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",minzoom:3,maxzoom:16},Subdomains:[]},OSM:{Normal:{Map:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",minzoom:0,maxzoom:18},Subdomains:["a","b","c"]}}}function $3(){return["https://0pn.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}","https://0pn.cn/maps/vt?lyrs=s,m&gl=CN&x={x}&y={y}&z={z}"]}let kh,zo;function eP(e){kh.on("click",function(t){return Pn(this,null,function*(){let{lng:i,lat:l}=t.lngLat;if(e){let f=R.mx_gcj02_To_gps84(i,l);i=f.lng,l=f.lat}console.log("经纬度坐标:",JSON.stringify([i,l]));let c=K3.MercatorCoordinate.fromLngLat([i,l],0);console.log("墨卡托坐标:",JSON.stringify(zo.map_lnglat_to_meters(i,l)));let h=zo.mercatorCoord2CAD(c.x,c.y);console.log("CAD坐标:",JSON.stringify(h))})})}let Bh=!1,Mf=!0;Mf=!1,Mf&&(Bh=!1);function tP(){let e=new R.MxCADPluginMapDefaultData;e.cadOrigin=[116275.977014,19273.279085],e.mapOrigin=[114.06825863001939,22.54283198132819],e.meterInCADUnits=1,e.openFile="./demo/road.dwg.mxweb";let t=Ke.MxFun.getQueryString("maptype");if(!Mf)if(t=="google"){let i=R.mx_gps84_To_gcj02(e.mapOrigin[0],e.mapOrigin[1]);e.mapOrigin=[i.lng,i.lat],Bh=!0,e.viewColor={red:0,green:0,blue:0}}else{let i=bc.gdslwzj();t=="gdslwzj"?i=bc.gdslwzj():t=="gdyx"?i=bc.gdyx():t=="tdtsl"?i=bc.tdtsl():t=="bdsl"?i=bc.bdsl():t=="geoq"&&(i=bc.geoq()),e.rasterTileLayerList=i.layers,i.key&&(e.rasterTileKey=i.key),e.providers=Q3()}return e}function nP(e){zo=e,kh=e.getMapbox(),Bh&&R.MxMapAddGoogleCnLayer(kh,["Image","Lable"],$3()),eP(Bh),Mf?J3(kh):Z3(kh)}function iP(){return Pn(this,null,function*(){let e=new R.MxCADUiPrPoint;e.setMessage(`
指定下载范围第一点:`);let t=yield e.go();if(!t)return;e.setMessage(`
指定下载范围第二点:`),e.setUserDraw((_,w)=>{w.setColor(16711680);let b=new R.McDbPolyline;b.addVertexAt(t),b.addVertexAt(new R.McGePoint3d(t.x,_.y)),b.addVertexAt(_),b.addVertexAt(new R.McGePoint3d(_.x,t.y)),b.constantWidth=Ke.MxFun.screenCoordLong2Doc(2),b.isClosed=!0,w.drawMcDbEntity(b);let E=[];E.push(t.toVector3()),E.push(new THREE.Vector3(t.x,_.y)),E.push(_.toVector3()),E.push(new THREE.Vector3(_.x,t.y)),w.setColor(12868),w.drawSolid(E,.5)}),e.setDisableOsnap(!0),e.setDisableOrthoTrace(!0),e.setDynamicInputType(Ke.DynamicInputType.kXYCoordInput);let i=yield e.go();if(!i)return;let l=zo.cadTolnglat(t.toVector3()),c=zo.cadTolnglat(i.toVector3()),h=zo.map_lnglat_to_meters(l[0],l[1]),f=zo.map_lnglat_to_meters(c[0],c[1]);if(Bh&&!(zo.outOfChina(l[0],l[1])&&zo.outOfChina(c[0],c[1]))){let _=R.mx_gcj02_To_gps84(l[0],l[1]),w=R.mx_gcj02_To_gps84(c[0],c[1]);h=zo.map_lnglat_to_meters(_.lng,_.lat),f=zo.map_lnglat_to_meters(w.lng,w.lat)}let r={url:"https://0pn.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}",polygon:[h[0],h[1],f[0],f[1]],zoom:18,auto_close:!1,no_repeated_download:!0,download_dir:"",thread_count:32};Ke.MxFun.acutPrintf(`
 使用教程:https://help.mxdraw.com/?pid=111`),Ke.MxFun.acutPrintf(`
 复制下面的范围,到下载器下载地图,下载范围:`);let v=`
`+JSON.stringify([h[0],h[1],f[0],f[1]]);Ke.MxFun.acutPrintf(v),Ke.MxFun.acutPrintf(`
`),of({method:"post",url:"http://localhost:1337/users/mxgis/download",data:r}).then(_=>{console.log(_.data),alert(JSON.stringify(_.data))}).catch(_=>{console.log("网络错误")})})}window._iconfont_svg_string_4337873='<svg><symbol id="icon-zidian" viewBox="0 0 1024 1024"><path d="M893.080181 585.210149h-86.234525v-37.615932h79.557697a57.552376 57.552376 0 0 0 1.786757-115.104753l-20.500683-0.658279 2.445035-20.312603a153.473004 153.473004 0 0 0 1.034439-17.679488A148.300813 148.300813 0 0 0 723.056167 245.72636a151.310088 151.310088 0 0 0-39.966928 5.64239l-20.782803 5.64239-3.009274-21.347042A225.695594 225.695594 0 0 0 209.222531 266.415123v18.807966l-16.739089 1.880797a130.715365 130.715365 0 0 0 14.952333 260.490331v37.615932a168.331297 168.331297 0 0 1-35.547056-332.806961 263.311526 263.311526 0 0 1 521.074702-41.753685 181.120714 181.120714 0 0 1 29.998706-2.539075 185.916746 185.916746 0 0 1 185.822706 185.728666v3.573513a95.168309 95.168309 0 0 1-15.704652 187.515423z" fill="#282D33" ></path><path d="M399.371069 341.646988H329.875634a74.573586 74.573586 0 0 0-74.291466 73.257028v478.944858-18.807966 14.576174a74.573586 74.573586 0 0 1 74.573586-74.479546h431.454744V341.646988H399.371069z" fill="#FFFFFF" ></path><path d="M255.584168 908.519088h-18.807966V414.715936A94.039831 94.039831 0 0 1 329.875634 322.839021h69.495435v37.615933H329.875634a56.423898 56.423898 0 0 0-55.4835 54.825221v399.481201a93.381552 93.381552 0 0 1 55.76562-18.807966h412.646778V360.454954H506.012238v-37.615933h274.408226v511.106481H329.875634a55.85966 55.85966 0 0 0-55.4835 52.568265v7.523187h-0.940398a18.807966 18.807966 0 0 1-17.867568 14.482134z" fill="#282D33" ></path><path d="M369.654483 392.804655H710.736949v371.363292H369.654483z" fill="#F8C44F" ></path><path d="M761.612498 815.137536H329.875634a74.573586 74.573586 0 1 0 0 149.053132h431.736864z" fill="#FFFFFF" ></path><path d="M780.420464 982.998634H329.875634a93.381552 93.381552 0 1 1 0-186.669064h450.54483zM329.875634 833.945502a55.76562 55.76562 0 1 0 0 111.437199h412.928898V833.945502z" fill="#282D33" ></path><path d="M475.073133 1024l-54.072903-34.230498-54.072902 34.230498v-127.89417h108.145805v127.89417z" fill="#34CA9D" ></path><path d="M324.327284 893.942914z" fill="#FFFFFF" ></path><path d="M324.327284 875.134948h437.285214v37.615932h-437.285214z" fill="#282D33" ></path><path d="M324.327284 810.529584z" fill="#FFFFFF" ></path><path d="M305.519318 349.076134h37.615933v461.45345h-37.615933zM520.494371 257.857498L453.067813 190.524979l-67.332519 67.332519-26.613272-26.613272L453.067813 137.392475l94.039831 93.851751-26.613273 26.613272z" fill="#282D33" ></path><path d="M436.422763 189.302462h37.615932v248.829392h-37.615932zM559.803021 694.390393l-94.039831-93.851751 26.613272-26.613272 67.426559 67.332519 67.426558-67.332519 26.519233 26.613272-93.945791 93.851751z" fill="#282D33" ></path><path d="M538.832138 393.556974h37.615933v248.829393h-37.615933z" fill="#282D33" ></path></symbol></svg>',function(e){var i=(i=document.getElementsByTagName("script"))[i.length-1],t=i.getAttribute("data-injectcss"),i=i.getAttribute("data-disable-injectsvg");if(!i){var l,c,h,f,r,v=function(b,E){E.parentNode.insertBefore(b,E)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(b){console&&console.log(b)}}l=function(){var b,E=document.createElement("div");E.innerHTML=e._iconfont_svg_string_4337873,(E=E.getElementsByTagName("svg")[0])&&(E.setAttribute("aria-hidden","true"),E.style.position="absolute",E.style.width=0,E.style.height=0,E.style.overflow="hidden",E=E,(b=document.body).firstChild?v(E,b.firstChild):b.appendChild(E))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(l,0):(c=function(){document.removeEventListener("DOMContentLoaded",c,!1),l()},document.addEventListener("DOMContentLoaded",c,!1)):document.attachEvent&&(h=l,f=e.document,r=!1,w(),f.onreadystatechange=function(){f.readyState=="complete"&&(f.onreadystatechange=null,_())})}function _(){r||(r=!0,h())}function w(){try{f.documentElement.doScroll("left")}catch(b){return void setTimeout(w,50)}_()}}(window),window._iconfont_svg_string_4604696='<svg><symbol id="icon-guding1" viewBox="0 0 1024 1024"><path d="M251.15000029 471.5l214.425 150.1875 183.74999942 128.62500029a243.7875 243.7875 0 0 0 7.01250029-235.42500058l-10.31249971-20.1375 160.61249971-229.3875-153.60000029-107.55-160.61249971 229.3875-22.42500029-2.77499971a243.7875 243.7875 0 0 0-218.84999942 87.11250029z m192.9375 180.9l-204.37500058 291.825a18.74999971 18.74999971 0 1 1-30.67499971-21.4875L413.37500029 630.87499971l-261.1125-182.84999942a18.74999971 18.74999971 0 1 1 21.4875-30.7125l46.61249942 32.625a281.28750029 281.28750029 0 0 1 254.32500058-102.75000029l147.63749942-210.89999971-46.04999942-32.25000058a18.74999971 18.74999971 0 0 1 21.4875-30.74999942l307.19999971 215.1a18.74999971 18.74999971 0 1 1-21.52500029 30.74999942l-46.08749971-32.2875-147.63750029 210.86250029a281.28750029 281.28750029 0 0 1-9.59999942 274.12499971l46.575 32.625a18.74999971 18.74999971 0 1 1-21.4875 30.75000029l-261.1125-182.85000029z" fill="#89cbfa" ></path></symbol><symbol id="icon-guding" viewBox="0 0 1024 1024"><path d="M381.298 418.828h-157.703l-37.575 38.272 155.61 158.377-278.212 345.128 356.040-265.838 154.71 157.41 38.813-39.51 2.407-157.972 238.838-313.29 71.685 73.013 34.695-35.28-310.185-315.743-34.672 35.257 77.287 79.402-311.737 240.773z"  ></path></symbol><symbol id="icon-dengpao1" viewBox="0 0 1024 1024"><path d="M344.73 841.5c0 8.28 6.77 15.31 15.31 15.31h32.75v1.26c0 40.65 51.69 73.52 115.43 73.52s115.18-32.87 115.18-73.52v-1.26h28.48c8.53 0 15.31-7.03 15.31-15.31v-59.95H344.96c-0.23 33.17-0.23 59.95-0.23 59.95zM512.1 98.23c-187.2 0-338.76 140.02-338.76 312.67 0 89.83 40.9 170.89 106.65 227.85 14.1 12.12 26.16 26.24 35.98 41.69h137.08l-31.49-352.21 4.6-0.02v-0.1h149.83v0.11l2.61 0.01-31.49 352.21h149.23c6.92-8.25 14.58-15.91 23.54-22.37 79.8-57.21 130.99-146.55 130.99-247.17C850.86 238.25 699.3 98.23 512.1 98.23zM343.93 759.53h323.25v-1.34c0-17.26 3.88-33.93 10.87-49.21H330.27c6.72 16.12 11.77 32.96 13.66 50.55z" fill="#F7B52C" ></path><path d="M546.38 357.44h-92.6l28.87 323h34.85z" fill="#F7B52C" ></path></symbol><symbol id="icon-duigou" viewBox="0 0 1024 1024"><path d="M387.072 611.328L236.6464 460.8 128 569.3952l259.072 259.1232 515.1232-515.072L793.6 204.8z" fill="#07A35A" ></path></symbol><symbol id="icon-jiantou_xiangyou" viewBox="0 0 1024 1024"><path d="M729.6 448H128v85.333333h601.6L597.333333 665.6l59.733334 59.733333 234.666666-234.666666L661.333333 256l-59.733333 59.733333 128 132.266667z" fill="#444444" ></path></symbol><symbol id="icon-jiantou_xiangzuo" viewBox="0 0 1024 1024"><path d="M290.133333 448H896v85.333333H290.133333l132.266667 132.266667L362.666667 725.333333 128 490.666667 362.666667 256l59.733333 59.733333-132.266667 132.266667z" fill="#444444" ></path></symbol><symbol id="icon-shezhi" viewBox="0 0 1024 1024"><path d="M519.9 647.4c-44.8 7.4-90.4-6.9-122.5-38.3-32.1-31.4-46.6-76.2-39-120 9.4-56.8 56.2-102.7 114.2-112.1 44.9-7.6 90.7 6.7 122.9 38.2 32.2 31.6 46.7 76.5 38.9 120.4-9.7 56.9-56.5 102.6-114.5 111.8M848.4 559l66-40.4c10.5-6.4 15.6-18.6 12.9-30.4L895 349.3c-2.7-11.8-12.8-20.6-25.1-21.9l-77.5-8.4c-7.7-0.8-14.7-4.6-19.5-10.5l-13-16c-4.8-5.9-7-13.5-6.1-21l8.9-75.7c1.4-12-5.1-23.6-16.2-28.9l-131-61.8c-11.1-5.2-24.4-3-33.2 5.5l-55 54c-5.4 5.3-12.8 8.4-20.6 8.4H486c-7.7 0-15.1-3-20.6-8.4l-55-54c-8.7-8.6-22-10.8-33.2-5.5l-130.9 61.8c-11.1 5.3-17.6 16.8-16.2 28.9l8.9 75.8c0.9 7.5-1.3 15-6.1 21L220 308.4c-4.8 5.9-11.8 9.7-19.5 10.5l-77.5 8.5c-12.3 1.3-22.3 10.1-25.1 21.9L65.5 488.1c-2.7 11.8 2.4 24 12.9 30.4l66 40.5c6.5 4 11.2 10.4 12.9 17.8l4.6 19.9c1.7 7.4 0.4 15.1-3.7 21.5l-41.6 64.5c-6.6 10.2-5.8 23.4 1.9 32.9l90.7 111.3c7.7 9.5 20.7 13.1 32.3 9.1l73.5-25.3c7.3-2.5 15.3-2.1 22.2 1.2l18.7 8.8c7 3.3 12.3 9.1 14.8 16.3l25.6 72c4.1 11.4 15.1 19.1 27.4 19.1H569c12.4 0 23.4-7.7 27.4-19.1l25.6-72c2.5-7.1 7.9-13 14.8-16.3l18.7-8.8c6.9-3.3 14.9-3.7 22.2-1.2l73.5 25.3c11.7 4 24.6 0.4 32.3-9.1l90.7-111.3c7.7-9.5 8.4-22.7 1.9-32.9l-41.6-64.5c-4.1-6.4-5.5-14.1-3.8-21.5l4.6-19.8c1.9-7.5 6.5-13.9 13.1-17.9" fill="" ></path></symbol><symbol id="icon-dengpao" viewBox="0 0 1024 1024"><path d="M661.333333 916.394667a21.333333 21.333333 0 0 1 21.333334 21.333333v42.666667a21.333333 21.333333 0 0 1-21.333334 21.333333h-298.666666a21.333333 21.333333 0 0 1-21.333334-21.333333v-42.666667a21.333333 21.333333 0 0 1 21.333334-21.333333h298.666666z m-149.333333-896a384 384 0 0 1 170.709333 728.064L682.666667 831.061333a42.666667 42.666667 0 0 1-42.666667 42.666667H384a42.666667 42.666667 0 0 1-42.666667-42.666667v-82.602666A384 384 0 0 1 512 20.394667z m0 85.333333a298.666667 298.666667 0 0 0-85.333333 584.96v97.706667h170.666666l0.042667-97.706667A298.666667 298.666667 0 0 0 512 105.728z" fill="#000000" opacity=".65" ></path></symbol></svg>',function(e){var i=(i=document.getElementsByTagName("script"))[i.length-1],t=i.getAttribute("data-injectcss"),i=i.getAttribute("data-disable-injectsvg");if(!i){var l,c,h,f,r,v=function(b,E){E.parentNode.insertBefore(b,E)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(b){console&&console.log(b)}}l=function(){var b,E=document.createElement("div");E.innerHTML=e._iconfont_svg_string_4604696,(E=E.getElementsByTagName("svg")[0])&&(E.setAttribute("aria-hidden","true"),E.style.position="absolute",E.style.width=0,E.style.height=0,E.style.overflow="hidden",E=E,(b=document.body).firstChild?v(E,b.firstChild):b.appendChild(E))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(l,0):(c=function(){document.removeEventListener("DOMContentLoaded",c,!1),l()},document.addEventListener("DOMContentLoaded",c,!1)):document.attachEvent&&(h=l,f=e.document,r=!1,w(),f.onreadystatechange=function(){f.readyState=="complete"&&(f.onreadystatechange=null,_())})}function _(){r||(r=!0,h())}function w(){try{f.documentElement.doScroll("left")}catch(b){return void setTimeout(w,50)}_()}}(window),window._iconfont_svg_string_4666894='<svg><symbol id="icon-a-1" viewBox="0 0 1024 1024"><path d="M429.12 896L256 628.16l23.04-20.16 173.12 267.84z" fill="#ffffff" ></path><path d="M456 893.76l-28.16-12.8L803.84 192l28.16 12.8z" fill="#ffffff" ></path><path d="M256 608h336v32H256z" fill="#ffffff" ></path></symbol><symbol id="icon-a-2" viewBox="0 0 1024 1024"><path d="M429.12 896L256 628.16l23.04-20.16 173.12 267.84z" fill="#000000" ></path><path d="M456 893.76l-28.16-12.8L803.84 192l28.16 12.8z" fill="#000000" ></path><path d="M256 608h336v32H256z" fill="#000000" ></path></symbol></svg>',(e=>{var t=(i=(i=document.getElementsByTagName("script"))[i.length-1]).getAttribute("data-injectcss"),i=i.getAttribute("data-disable-injectsvg");if(!i){var l,c,h,f,r,v=function(b,E){E.parentNode.insertBefore(b,E)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(b){console&&console.log(b)}}l=function(){var b,E=document.createElement("div");E.innerHTML=e._iconfont_svg_string_4666894,(E=E.getElementsByTagName("svg")[0])&&(E.setAttribute("aria-hidden","true"),E.style.position="absolute",E.style.width=0,E.style.height=0,E.style.overflow="hidden",E=E,(b=document.body).firstChild?v(E,b.firstChild):b.appendChild(E))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(l,0):(c=function(){document.removeEventListener("DOMContentLoaded",c,!1),l()},document.addEventListener("DOMContentLoaded",c,!1)):document.attachEvent&&(h=l,f=e.document,r=!1,w(),f.onreadystatechange=function(){f.readyState=="complete"&&(f.onreadystatechange=null,_())})}function _(){r||(r=!0,h())}function w(){try{f.documentElement.doScroll("left")}catch(b){return void setTimeout(w,50)}_()}})(window),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var l=arguments[i];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(t[c]=l[c])}return t});var rP="113",oP=0,x1=1,aP=2,v1=1,sP=2,zh=3,wc=0,lr=1,Uh=2,_1=1,b1=0,lP=1,Ac=2,gs=0,Nh=1,w1=2,A1=3,M1=4,cP=5,Mc=100,uP=101,hP=102,S1=103,T1=104,dP=200,pP=201,fP=202,mP=203,E1=204,P1=205,gP=206,yP=207,xP=208,vP=209,_P=210,bP=0,wP=1,AP=2,Ky=3,MP=4,SP=5,TP=6,EP=7,Sf=0,PP=1,CP=2,Tf=0,Zy=1,RP=2,DP=3,IP=4,LP=5,Jy=300,Qy=301,$y=302,C1=303,e0=304,R1=305,Vh=306,t0=307,dl=1e3,Rr=1001,Oh=1002,Yi=1003,Ef=1004,Pf=1005,$i=1006,n0=1007,Sc=1008,Cf=1009,FP=1010,kP=1011,Rf=1012,BP=1013,D1=1014,Gh=1015,i0=1016,zP=1017,UP=1018,NP=1019,Df=1020,VP=1021,ka=1022,Uo=1023,OP=1024,GP=1025,jP=Uo,Tc=1026,jh=1027,HP=1028,WP=1029,qP=1030,YP=1031,XP=1032,KP=1033,I1=33776,L1=33777,F1=33778,k1=33779,B1=35840,z1=35841,U1=35842,N1=35843,ZP=36196,JP=37808,QP=37809,$P=37810,eC=37811,tC=37812,nC=37813,iC=37814,rC=37815,oC=37816,aC=37817,sC=37818,lC=37819,cC=37820,uC=37821,hC=2200,dC=2201,pC=2202,Hh=2300,Ec=2301,r0=2302,Pc=2400,Cc=2401,If=2402,fC=0,mC=1,V1=2,co=3e3,Wh=3001,O1=3007,o0=3002,gC=3003,G1=3004,j1=3005,H1=3006,yC=3200,xC=3201,pl=0,vC=1,a0=7680,_C=519,Lf=35044,qh=35048;function Ba(){}Object.assign(Ba.prototype,{addEventListener:function(e,t){this._listeners===void 0&&(this._listeners={});var i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)},hasEventListener:function(e,t){if(this._listeners===void 0)return!1;var i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1},removeEventListener:function(e,t){if(this._listeners!==void 0){var i=this._listeners,l=i[e];if(l!==void 0){var c=l.indexOf(t);c!==-1&&l.splice(c,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var t=this._listeners,i=t[e.type];if(i!==void 0){e.target=this;for(var l=i.slice(0),c=0,h=l.length;c<h;c++)l[c].call(this,e)}}}});for(var mr=[],Yh=0;Yh<256;Yh++)mr[Yh]=(Yh<16?"0":"")+Yh.toString(16);var Xn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,l=Math.random()*4294967295|0,c=mr[e&255]+mr[e>>8&255]+mr[e>>16&255]+mr[e>>24&255]+"-"+mr[t&255]+mr[t>>8&255]+"-"+mr[t>>16&15|64]+mr[t>>24&255]+"-"+mr[i&63|128]+mr[i>>8&255]+"-"+mr[i>>16&255]+mr[i>>24&255]+mr[l&255]+mr[l>>8&255]+mr[l>>16&255]+mr[l>>24&255];return c.toUpperCase()},clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,l,c){return l+(e-t)*(c-l)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Xn.DEG2RAD},radToDeg:function(e){return e*Xn.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,i,l,c){var h=Math.cos,f=Math.sin,r=h(i/2),v=f(i/2),_=h((t+l)/2),w=f((t+l)/2),b=h((t-l)/2),E=f((t-l)/2),P=h((l-t)/2),I=f((l-t)/2);c==="XYX"?e.set(r*w,v*b,v*E,r*_):c==="YZY"?e.set(v*E,r*w,v*b,r*_):c==="ZXZ"?e.set(v*b,v*E,r*w,r*_):c==="XZX"?e.set(r*w,v*I,v*P,r*_):c==="YXY"?e.set(v*P,r*w,v*I,r*_):c==="ZYZ"?e.set(v*I,v*P,r*w,r*_):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Rt(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(Rt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Rt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,i=this.y,l=e.elements;return this.x=l[0]*t+l[3]*i+l[6],this.y=l[1]*t+l[4]*i+l[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),l=Math.sin(t),c=this.x-e.x,h=this.y-e.y;return this.x=c*i-h*l+e.x,this.y=c*l+h*i+e.y,this}});function vr(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(vr.prototype,{isMatrix3:!0,set:function(e,t,i,l,c,h,f,r,v){var _=this.elements;return _[0]=e,_[1]=l,_[2]=f,_[3]=t,_[4]=c,_[5]=r,_[6]=i,_[7]=h,_[8]=v,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,l=t.elements,c=this.elements,h=i[0],f=i[3],r=i[6],v=i[1],_=i[4],w=i[7],b=i[2],E=i[5],P=i[8],I=l[0],F=l[3],B=l[6],O=l[1],W=l[4],Z=l[7],ie=l[2],$=l[5],oe=l[8];return c[0]=h*I+f*O+r*ie,c[3]=h*F+f*W+r*$,c[6]=h*B+f*Z+r*oe,c[1]=v*I+_*O+w*ie,c[4]=v*F+_*W+w*$,c[7]=v*B+_*Z+w*oe,c[2]=b*I+E*O+P*ie,c[5]=b*F+E*W+P*$,c[8]=b*B+E*Z+P*oe,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],l=e[2],c=e[3],h=e[4],f=e[5],r=e[6],v=e[7],_=e[8];return t*h*_-t*f*v-i*c*_+i*f*r+l*c*v-l*h*r},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=e.elements,l=this.elements,c=i[0],h=i[1],f=i[2],r=i[3],v=i[4],_=i[5],w=i[6],b=i[7],E=i[8],P=E*v-_*b,I=_*w-E*r,F=b*r-v*w,B=c*P+h*I+f*F;if(B===0){var O="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(O);return console.warn(O),this.identity()}var W=1/B;return l[0]=P*W,l[1]=(f*b-E*h)*W,l[2]=(_*h-f*v)*W,l[3]=I*W,l[4]=(E*c-f*w)*W,l[5]=(f*r-_*c)*W,l[6]=F*W,l[7]=(h*w-b*c)*W,l[8]=(v*c-h*r)*W,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,i,l,c,h,f){var r=Math.cos(c),v=Math.sin(c);this.set(i*r,i*v,-i*(r*h+v*f)+h+e,-l*v,l*r,-l*(-v*h+r*f)+f+t,0,0,1)},scale:function(e,t){var i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=this.elements,c=l[0],h=l[3],f=l[6],r=l[1],v=l[4],_=l[7];return l[0]=t*c+i*r,l[3]=t*h+i*v,l[6]=t*f+i*_,l[1]=-i*c+t*r,l[4]=-i*h+t*v,l[7]=-i*f+t*_,this},translate:function(e,t){var i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this},equals:function(e){for(var t=this.elements,i=e.elements,l=0;l<9;l++)if(t[l]!==i[l])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var i=0;i<9;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}});var Rc,fl={getDataURL:function(e){var t;if(typeof HTMLCanvasElement=="undefined")return e.src;if(e instanceof HTMLCanvasElement)t=e;else{Rc===void 0&&(Rc=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Rc.width=e.width,Rc.height=e.height;var i=Rc.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Rc}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},bC=0;function bi(e,t,i,l,c,h,f,r,v,_){Object.defineProperty(this,"id",{value:bC++}),this.uuid=Xn.generateUUID(),this.name="",this.image=e!==void 0?e:bi.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=t!==void 0?t:bi.DEFAULT_MAPPING,this.wrapS=i!==void 0?i:Rr,this.wrapT=l!==void 0?l:Rr,this.magFilter=c!==void 0?c:$i,this.minFilter=h!==void 0?h:Sc,this.anisotropy=v!==void 0?v:1,this.format=f!==void 0?f:Uo,this.internalFormat=null,this.type=r!==void 0?r:Cf,this.offset=new Rt(0,0),this.repeat=new Rt(1,1),this.center=new Rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new vr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=_!==void 0?_:co,this.version=0,this.onUpdate=null}bi.DEFAULT_IMAGE=void 0,bi.DEFAULT_MAPPING=Jy,bi.prototype=Object.assign(Object.create(Ba.prototype),{constructor:bi,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var l=this.image;if(l.uuid===void 0&&(l.uuid=Xn.generateUUID()),!t&&e.images[l.uuid]===void 0){var c;if(Array.isArray(l)){c=[];for(var h=0,f=l.length;h<f;h++)c.push(fl.getDataURL(l[h]))}else c=fl.getDataURL(l);e.images[l.uuid]={uuid:l.uuid,url:c}}i.image=l.uuid}return t||(e.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==Jy)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case dl:e.x=e.x-Math.floor(e.x);break;case Rr:e.x=e.x<0?0:1;break;case Oh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case dl:e.y=e.y-Math.floor(e.y);break;case Rr:e.y=e.y<0?0:1;break;case Oh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(bi.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function wi(e,t,i,l){this.x=e||0,this.y=t||0,this.z=i||0,this.w=l!==void 0?l:1}Object.defineProperties(wi.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(wi.prototype,{isVector4:!0,set:function(e,t,i,l){return this.x=e,this.y=t,this.z=i,this.w=l,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,l=this.z,c=this.w,h=e.elements;return this.x=h[0]*t+h[4]*i+h[8]*l+h[12]*c,this.y=h[1]*t+h[5]*i+h[9]*l+h[13]*c,this.z=h[2]*t+h[6]*i+h[10]*l+h[14]*c,this.w=h[3]*t+h[7]*i+h[11]*l+h[15]*c,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,l,c,h=.01,f=.1,r=e.elements,v=r[0],_=r[4],w=r[8],b=r[1],E=r[5],P=r[9],I=r[2],F=r[6],B=r[10];if(Math.abs(_-b)<h&&Math.abs(w-I)<h&&Math.abs(P-F)<h){if(Math.abs(_+b)<f&&Math.abs(w+I)<f&&Math.abs(P+F)<f&&Math.abs(v+E+B-3)<f)return this.set(1,0,0,0),this;t=Math.PI;var O=(v+1)/2,W=(E+1)/2,Z=(B+1)/2,ie=(_+b)/4,$=(w+I)/4,oe=(P+F)/4;return O>W&&O>Z?O<h?(i=0,l=.707106781,c=.707106781):(i=Math.sqrt(O),l=ie/i,c=$/i):W>Z?W<h?(i=.707106781,l=0,c=.707106781):(l=Math.sqrt(W),i=ie/l,c=oe/l):Z<h?(i=.707106781,l=.707106781,c=0):(c=Math.sqrt(Z),i=$/c,l=oe/c),this.set(i,l,c,t),this}var be=Math.sqrt((F-P)*(F-P)+(w-I)*(w-I)+(b-_)*(b-_));return Math.abs(be)<.001&&(be=1),this.x=(F-P)/be,this.y=(w-I)/be,this.z=(b-_)/be,this.w=Math.acos((v+E+B-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}});function Dr(e,t,i){this.width=e,this.height=t,this.scissor=new wi(0,0,e,t),this.scissorTest=!1,this.viewport=new wi(0,0,e,t),i=i||{},this.texture=new bi(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:$i,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!0,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null}Dr.prototype=Object.assign(Object.create(Ba.prototype),{constructor:Dr,isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function W1(e,t,i){Dr.call(this,e,t,i),this.samples=4}W1.prototype=Object.assign(Object.create(Dr.prototype),{constructor:W1,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.samples=e.samples,this}});function qr(e,t,i,l){this._x=e||0,this._y=t||0,this._z=i||0,this._w=l!==void 0?l:1}Object.assign(qr,{slerp:function(e,t,i,l){return i.copy(e).slerp(t,l)},slerpFlat:function(e,t,i,l,c,h,f){var r=i[l+0],v=i[l+1],_=i[l+2],w=i[l+3],b=c[h+0],E=c[h+1],P=c[h+2],I=c[h+3];if(w!==I||r!==b||v!==E||_!==P){var F=1-f,B=r*b+v*E+_*P+w*I,O=B>=0?1:-1,W=1-B*B;if(W>Number.EPSILON){var Z=Math.sqrt(W),ie=Math.atan2(Z,B*O);F=Math.sin(F*ie)/Z,f=Math.sin(f*ie)/Z}var $=f*O;if(r=r*F+b*$,v=v*F+E*$,_=_*F+P*$,w=w*F+I*$,F===1-f){var oe=1/Math.sqrt(r*r+v*v+_*_+w*w);r*=oe,v*=oe,_*=oe,w*=oe}}e[t]=r,e[t+1]=v,e[t+2]=_,e[t+3]=w}}),Object.defineProperties(qr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(qr.prototype,{isQuaternion:!0,set:function(e,t,i,l){return this._x=e,this._y=t,this._z=i,this._w=l,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,l=e._y,c=e._z,h=e.order,f=Math.cos,r=Math.sin,v=f(i/2),_=f(l/2),w=f(c/2),b=r(i/2),E=r(l/2),P=r(c/2);return h==="XYZ"?(this._x=b*_*w+v*E*P,this._y=v*E*w-b*_*P,this._z=v*_*P+b*E*w,this._w=v*_*w-b*E*P):h==="YXZ"?(this._x=b*_*w+v*E*P,this._y=v*E*w-b*_*P,this._z=v*_*P-b*E*w,this._w=v*_*w+b*E*P):h==="ZXY"?(this._x=b*_*w-v*E*P,this._y=v*E*w+b*_*P,this._z=v*_*P+b*E*w,this._w=v*_*w-b*E*P):h==="ZYX"?(this._x=b*_*w-v*E*P,this._y=v*E*w+b*_*P,this._z=v*_*P-b*E*w,this._w=v*_*w+b*E*P):h==="YZX"?(this._x=b*_*w+v*E*P,this._y=v*E*w+b*_*P,this._z=v*_*P-b*E*w,this._w=v*_*w-b*E*P):h==="XZY"&&(this._x=b*_*w-v*E*P,this._y=v*E*w-b*_*P,this._z=v*_*P+b*E*w,this._w=v*_*w+b*E*P),t!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,l=Math.sin(i);return this._x=e.x*l,this._y=e.y*l,this._z=e.z*l,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t=e.elements,i=t[0],l=t[4],c=t[8],h=t[1],f=t[5],r=t[9],v=t[2],_=t[6],w=t[10],b=i+f+w,E;return b>0?(E=.5/Math.sqrt(b+1),this._w=.25/E,this._x=(_-r)*E,this._y=(c-v)*E,this._z=(h-l)*E):i>f&&i>w?(E=2*Math.sqrt(1+i-f-w),this._w=(_-r)/E,this._x=.25*E,this._y=(l+h)/E,this._z=(c+v)/E):f>w?(E=2*Math.sqrt(1+f-i-w),this._w=(c-v)/E,this._x=(l+h)/E,this._y=.25*E,this._z=(r+_)/E):(E=2*Math.sqrt(1+w-i-f),this._w=(h-l)/E,this._x=(c+v)/E,this._y=(r+_)/E,this._z=.25*E),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var i=1e-6,l=e.dot(t)+1;return l<i?(l=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=l):(this._x=0,this._y=-e.z,this._z=e.y,this._w=l)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=l),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Xn.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var i=this.angleTo(e);if(i===0)return this;var l=Math.min(1,t/i);return this.slerp(e,l),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,l=e._y,c=e._z,h=e._w,f=t._x,r=t._y,v=t._z,_=t._w;return this._x=i*_+h*f+l*v-c*r,this._y=l*_+h*r+c*f-i*v,this._z=c*_+h*v+i*r-l*f,this._w=h*_-i*f-l*r-c*v,this._onChangeCallback(),this},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var i=this._x,l=this._y,c=this._z,h=this._w,f=h*e._w+i*e._x+l*e._y+c*e._z;if(f<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,f=-f):this.copy(e),f>=1)return this._w=h,this._x=i,this._y=l,this._z=c,this;var r=1-f*f;if(r<=Number.EPSILON){var v=1-t;return this._w=v*h+t*this._w,this._x=v*i+t*this._x,this._y=v*l+t*this._y,this._z=v*c+t*this._z,this.normalize(),this._onChangeCallback(),this}var _=Math.sqrt(r),w=Math.atan2(_,f),b=Math.sin((1-t)*w)/_,E=Math.sin(t*w)/_;return this._w=h*b+this._w*E,this._x=i*b+this._x*E,this._y=l*b+this._y*E,this._z=c*b+this._z*E,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return t===void 0&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var s0=new xe,q1=new qr;function xe(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}Object.assign(xe.prototype,{isVector3:!0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(q1.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(q1.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,i=this.y,l=this.z,c=e.elements;return this.x=c[0]*t+c[3]*i+c[6]*l,this.y=c[1]*t+c[4]*i+c[7]*l,this.z=c[2]*t+c[5]*i+c[8]*l,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,i=this.y,l=this.z,c=e.elements,h=1/(c[3]*t+c[7]*i+c[11]*l+c[15]);return this.x=(c[0]*t+c[4]*i+c[8]*l+c[12])*h,this.y=(c[1]*t+c[5]*i+c[9]*l+c[13])*h,this.z=(c[2]*t+c[6]*i+c[10]*l+c[14])*h,this},applyQuaternion:function(e){var t=this.x,i=this.y,l=this.z,c=e.x,h=e.y,f=e.z,r=e.w,v=r*t+h*l-f*i,_=r*i+f*t-c*l,w=r*l+c*i-h*t,b=-c*t-h*i-f*l;return this.x=v*r+b*-c+_*-f-w*-h,this.y=_*r+b*-h+w*-c-v*-f,this.z=w*r+b*-f+v*-h-_*-c,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,i=this.y,l=this.z,c=e.elements;return this.x=c[0]*t+c[4]*i+c[8]*l,this.y=c[1]*t+c[5]*i+c[9]*l,this.z=c[2]*t+c[6]*i+c[10]*l,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var i=e.x,l=e.y,c=e.z,h=t.x,f=t.y,r=t.z;return this.x=l*r-c*f,this.y=c*h-i*r,this.z=i*f-l*h,this},projectOnVector:function(e){var t=e.lengthSq();if(t===0)return this.set(0,0,0);var i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)},projectOnPlane:function(e){return s0.copy(this).projectOnVector(e),this.sub(s0)},reflect:function(e){return this.sub(s0.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;var i=this.dot(e)/t;return Math.acos(Xn.clamp(i,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,l=this.z-e.z;return t*t+i*i+l*l},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,i){var l=Math.sin(t)*e;return this.x=l*Math.sin(i),this.y=Math.cos(t)*e,this.z=l*Math.cos(i),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),l=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=l,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,t*4)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,t*3)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var Dc=new xe,No=new Kn,wC=new xe(0,0,0),AC=new xe(1,1,1),ys=new xe,Ff=new xe,uo=new xe;function Kn(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Kn.prototype,{isMatrix4:!0,set:function(e,t,i,l,c,h,f,r,v,_,w,b,E,P,I,F){var B=this.elements;return B[0]=e,B[4]=t,B[8]=i,B[12]=l,B[1]=c,B[5]=h,B[9]=f,B[13]=r,B[2]=v,B[6]=_,B[10]=w,B[14]=b,B[3]=E,B[7]=P,B[11]=I,B[15]=F,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Kn().fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,i=e.elements,l=1/Dc.setFromMatrixColumn(e,0).length(),c=1/Dc.setFromMatrixColumn(e,1).length(),h=1/Dc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*l,t[1]=i[1]*l,t[2]=i[2]*l,t[3]=0,t[4]=i[4]*c,t[5]=i[5]*c,t[6]=i[6]*c,t[7]=0,t[8]=i[8]*h,t[9]=i[9]*h,t[10]=i[10]*h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,l=e.y,c=e.z,h=Math.cos(i),f=Math.sin(i),r=Math.cos(l),v=Math.sin(l),_=Math.cos(c),w=Math.sin(c);if(e.order==="XYZ"){var b=h*_,E=h*w,P=f*_,I=f*w;t[0]=r*_,t[4]=-r*w,t[8]=v,t[1]=E+P*v,t[5]=b-I*v,t[9]=-f*r,t[2]=I-b*v,t[6]=P+E*v,t[10]=h*r}else if(e.order==="YXZ"){var F=r*_,B=r*w,O=v*_,W=v*w;t[0]=F+W*f,t[4]=O*f-B,t[8]=h*v,t[1]=h*w,t[5]=h*_,t[9]=-f,t[2]=B*f-O,t[6]=W+F*f,t[10]=h*r}else if(e.order==="ZXY"){var F=r*_,B=r*w,O=v*_,W=v*w;t[0]=F-W*f,t[4]=-h*w,t[8]=O+B*f,t[1]=B+O*f,t[5]=h*_,t[9]=W-F*f,t[2]=-h*v,t[6]=f,t[10]=h*r}else if(e.order==="ZYX"){var b=h*_,E=h*w,P=f*_,I=f*w;t[0]=r*_,t[4]=P*v-E,t[8]=b*v+I,t[1]=r*w,t[5]=I*v+b,t[9]=E*v-P,t[2]=-v,t[6]=f*r,t[10]=h*r}else if(e.order==="YZX"){var Z=h*r,ie=h*v,$=f*r,oe=f*v;t[0]=r*_,t[4]=oe-Z*w,t[8]=$*w+ie,t[1]=w,t[5]=h*_,t[9]=-f*_,t[2]=-v*_,t[6]=ie*w+$,t[10]=Z-oe*w}else if(e.order==="XZY"){var Z=h*r,ie=h*v,$=f*r,oe=f*v;t[0]=r*_,t[4]=-w,t[8]=v*_,t[1]=Z*w+oe,t[5]=h*_,t[9]=ie*w-$,t[2]=$*w-ie,t[6]=f*_,t[10]=oe*w+Z}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(wC,e,AC)},lookAt:function(e,t,i){var l=this.elements;return uo.subVectors(e,t),uo.lengthSq()===0&&(uo.z=1),uo.normalize(),ys.crossVectors(i,uo),ys.lengthSq()===0&&(Math.abs(i.z)===1?uo.x+=1e-4:uo.z+=1e-4,uo.normalize(),ys.crossVectors(i,uo)),ys.normalize(),Ff.crossVectors(uo,ys),l[0]=ys.x,l[4]=Ff.x,l[8]=uo.x,l[1]=ys.y,l[5]=Ff.y,l[9]=uo.y,l[2]=ys.z,l[6]=Ff.z,l[10]=uo.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,l=t.elements,c=this.elements,h=i[0],f=i[4],r=i[8],v=i[12],_=i[1],w=i[5],b=i[9],E=i[13],P=i[2],I=i[6],F=i[10],B=i[14],O=i[3],W=i[7],Z=i[11],ie=i[15],$=l[0],oe=l[4],be=l[8],fe=l[12],Le=l[1],Xe=l[5],Ne=l[9],Re=l[13],Ie=l[2],He=l[6],Ue=l[10],ot=l[14],Pt=l[3],mt=l[7],_t=l[11],ft=l[15];return c[0]=h*$+f*Le+r*Ie+v*Pt,c[4]=h*oe+f*Xe+r*He+v*mt,c[8]=h*be+f*Ne+r*Ue+v*_t,c[12]=h*fe+f*Re+r*ot+v*ft,c[1]=_*$+w*Le+b*Ie+E*Pt,c[5]=_*oe+w*Xe+b*He+E*mt,c[9]=_*be+w*Ne+b*Ue+E*_t,c[13]=_*fe+w*Re+b*ot+E*ft,c[2]=P*$+I*Le+F*Ie+B*Pt,c[6]=P*oe+I*Xe+F*He+B*mt,c[10]=P*be+I*Ne+F*Ue+B*_t,c[14]=P*fe+I*Re+F*ot+B*ft,c[3]=O*$+W*Le+Z*Ie+ie*Pt,c[7]=O*oe+W*Xe+Z*He+ie*mt,c[11]=O*be+W*Ne+Z*Ue+ie*_t,c[15]=O*fe+W*Re+Z*ot+ie*ft,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[4],l=e[8],c=e[12],h=e[1],f=e[5],r=e[9],v=e[13],_=e[2],w=e[6],b=e[10],E=e[14],P=e[3],I=e[7],F=e[11],B=e[15];return P*(+c*r*w-l*v*w-c*f*b+i*v*b+l*f*E-i*r*E)+I*(+t*r*E-t*v*b+c*h*b-l*h*E+l*v*_-c*r*_)+F*(+t*v*w-t*f*E-c*h*w+i*h*E+c*f*_-i*v*_)+B*(-l*f*_-t*r*w+t*f*b+l*h*w-i*h*b+i*r*_)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,i){var l=this.elements;return e.isVector3?(l[12]=e.x,l[13]=e.y,l[14]=e.z):(l[12]=e,l[13]=t,l[14]=i),this},getInverse:function(e,t){var i=this.elements,l=e.elements,c=l[0],h=l[1],f=l[2],r=l[3],v=l[4],_=l[5],w=l[6],b=l[7],E=l[8],P=l[9],I=l[10],F=l[11],B=l[12],O=l[13],W=l[14],Z=l[15],ie=P*W*b-O*I*b+O*w*F-_*W*F-P*w*Z+_*I*Z,$=B*I*b-E*W*b-B*w*F+v*W*F+E*w*Z-v*I*Z,oe=E*O*b-B*P*b+B*_*F-v*O*F-E*_*Z+v*P*Z,be=B*P*w-E*O*w-B*_*I+v*O*I+E*_*W-v*P*W,fe=c*ie+h*$+f*oe+r*be;if(fe===0){var Le="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(Le);return console.warn(Le),this.identity()}var Xe=1/fe;return i[0]=ie*Xe,i[1]=(O*I*r-P*W*r-O*f*F+h*W*F+P*f*Z-h*I*Z)*Xe,i[2]=(_*W*r-O*w*r+O*f*b-h*W*b-_*f*Z+h*w*Z)*Xe,i[3]=(P*w*r-_*I*r-P*f*b+h*I*b+_*f*F-h*w*F)*Xe,i[4]=$*Xe,i[5]=(E*W*r-B*I*r+B*f*F-c*W*F-E*f*Z+c*I*Z)*Xe,i[6]=(B*w*r-v*W*r-B*f*b+c*W*b+v*f*Z-c*w*Z)*Xe,i[7]=(v*I*r-E*w*r+E*f*b-c*I*b-v*f*F+c*w*F)*Xe,i[8]=oe*Xe,i[9]=(B*P*r-E*O*r-B*h*F+c*O*F+E*h*Z-c*P*Z)*Xe,i[10]=(v*O*r-B*_*r+B*h*b-c*O*b-v*h*Z+c*_*Z)*Xe,i[11]=(E*_*r-v*P*r-E*h*b+c*P*b+v*h*F-c*_*F)*Xe,i[12]=be*Xe,i[13]=(E*O*f-B*P*f+B*h*I-c*O*I-E*h*W+c*P*W)*Xe,i[14]=(B*_*f-v*O*f-B*h*w+c*O*w+v*h*W-c*_*W)*Xe,i[15]=(v*P*f-E*_*f+E*h*w-c*P*w-v*h*I+c*_*I)*Xe,this},scale:function(e){var t=this.elements,i=e.x,l=e.y,c=e.z;return t[0]*=i,t[4]*=l,t[8]*=c,t[1]*=i,t[5]*=l,t[9]*=c,t[2]*=i,t[6]*=l,t[10]*=c,t[3]*=i,t[7]*=l,t[11]*=c,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],l=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,l))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),l=Math.sin(t),c=1-i,h=e.x,f=e.y,r=e.z,v=c*h,_=c*f;return this.set(v*h+i,v*f-l*r,v*r+l*f,0,v*f+l*r,_*f+i,_*r-l*h,0,v*r-l*f,_*r+l*h,c*r*r+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){var l=this.elements,c=t._x,h=t._y,f=t._z,r=t._w,v=c+c,_=h+h,w=f+f,b=c*v,E=c*_,P=c*w,I=h*_,F=h*w,B=f*w,O=r*v,W=r*_,Z=r*w,ie=i.x,$=i.y,oe=i.z;return l[0]=(1-(I+B))*ie,l[1]=(E+Z)*ie,l[2]=(P-W)*ie,l[3]=0,l[4]=(E-Z)*$,l[5]=(1-(b+B))*$,l[6]=(F+O)*$,l[7]=0,l[8]=(P+W)*oe,l[9]=(F-O)*oe,l[10]=(1-(b+I))*oe,l[11]=0,l[12]=e.x,l[13]=e.y,l[14]=e.z,l[15]=1,this},decompose:function(e,t,i){var l=this.elements,c=Dc.set(l[0],l[1],l[2]).length(),h=Dc.set(l[4],l[5],l[6]).length(),f=Dc.set(l[8],l[9],l[10]).length(),r=this.determinant();r<0&&(c=-c),e.x=l[12],e.y=l[13],e.z=l[14],No.copy(this);var v=1/c,_=1/h,w=1/f;return No.elements[0]*=v,No.elements[1]*=v,No.elements[2]*=v,No.elements[4]*=_,No.elements[5]*=_,No.elements[6]*=_,No.elements[8]*=w,No.elements[9]*=w,No.elements[10]*=w,t.setFromRotationMatrix(No),i.x=c,i.y=h,i.z=f,this},makePerspective:function(e,t,i,l,c,h){h===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var f=this.elements,r=2*c/(t-e),v=2*c/(i-l),_=(t+e)/(t-e),w=(i+l)/(i-l),b=-(h+c)/(h-c),E=-2*h*c/(h-c);return f[0]=r,f[4]=0,f[8]=_,f[12]=0,f[1]=0,f[5]=v,f[9]=w,f[13]=0,f[2]=0,f[6]=0,f[10]=b,f[14]=E,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this},makeOrthographic:function(e,t,i,l,c,h){var f=this.elements,r=1/(t-e),v=1/(i-l),_=1/(h-c),w=(t+e)*r,b=(i+l)*v,E=(h+c)*_;return f[0]=2*r,f[4]=0,f[8]=0,f[12]=-w,f[1]=0,f[5]=2*v,f[9]=0,f[13]=-b,f[2]=0,f[6]=0,f[10]=-2*_,f[14]=-E,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,l=0;l<16;l++)if(t[l]!==i[l])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var i=0;i<16;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}});var Y1=new Kn,X1=new qr;function Ic(e,t,i,l){this._x=e||0,this._y=t||0,this._z=i||0,this._order=l||Ic.DefaultOrder}Ic.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ic.DefaultOrder="XYZ",Object.defineProperties(Ic.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(Ic.prototype,{isEuler:!0,set:function(e,t,i,l){return this._x=e,this._y=t,this._z=i,this._order=l||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var l=Xn.clamp,c=e.elements,h=c[0],f=c[4],r=c[8],v=c[1],_=c[5],w=c[9],b=c[2],E=c[6],P=c[10];return t=t||this._order,t==="XYZ"?(this._y=Math.asin(l(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(-w,P),this._z=Math.atan2(-f,h)):(this._x=Math.atan2(E,_),this._z=0)):t==="YXZ"?(this._x=Math.asin(-l(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(r,P),this._z=Math.atan2(v,_)):(this._y=Math.atan2(-b,h),this._z=0)):t==="ZXY"?(this._x=Math.asin(l(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-b,P),this._z=Math.atan2(-f,_)):(this._y=0,this._z=Math.atan2(v,h))):t==="ZYX"?(this._y=Math.asin(-l(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(E,P),this._z=Math.atan2(v,h)):(this._x=0,this._z=Math.atan2(-f,_))):t==="YZX"?(this._z=Math.asin(l(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(-w,_),this._y=Math.atan2(-b,h)):(this._x=0,this._y=Math.atan2(r,P))):t==="XZY"?(this._z=Math.asin(-l(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(E,_),this._y=Math.atan2(r,h)):(this._x=Math.atan2(-w,P),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,i!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,i){return Y1.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Y1,t,i)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return X1.setFromEuler(this),this.setFromQuaternion(X1,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new xe(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});function K1(){this.mask=1}Object.assign(K1.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!==0}});var MC=0,Z1=new xe,Lc=new qr,za=new Kn,kf=new xe,Xh=new xe,SC=new xe,TC=new qr,J1=new xe(1,0,0),Q1=new xe(0,1,0),$1=new xe(0,0,1),EC={type:"added"},PC={type:"removed"};function on(){Object.defineProperty(this,"id",{value:MC++}),this.uuid=Xn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=on.DefaultUp.clone();var e=new xe,t=new Ic,i=new qr,l=new xe(1,1,1);function c(){i.setFromEuler(t,!1)}function h(){t.setFromQuaternion(i,void 0,!1)}t._onChange(c),i._onChange(h),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new Kn},normalMatrix:{value:new vr}}),this.matrix=new Kn,this.matrixWorld=new Kn,this.matrixAutoUpdate=on.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new K1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}on.DefaultUp=new xe(0,1,0),on.DefaultMatrixAutoUpdate=!0,on.prototype=Object.assign(Object.create(Ba.prototype),{constructor:on,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return Lc.setFromAxisAngle(e,t),this.quaternion.multiply(Lc),this},rotateOnWorldAxis:function(e,t){return Lc.setFromAxisAngle(e,t),this.quaternion.premultiply(Lc),this},rotateX:function(e){return this.rotateOnAxis(J1,e)},rotateY:function(e){return this.rotateOnAxis(Q1,e)},rotateZ:function(e){return this.rotateOnAxis($1,e)},translateOnAxis:function(e,t){return Z1.copy(e).applyQuaternion(this.quaternion),this.position.add(Z1.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(J1,e)},translateY:function(e){return this.translateOnAxis(Q1,e)},translateZ:function(e){return this.translateOnAxis($1,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(za.getInverse(this.matrixWorld))},lookAt:function(e,t,i){e.isVector3?kf.copy(e):kf.set(e,t,i);var l=this.parent;this.updateWorldMatrix(!0,!1),Xh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?za.lookAt(Xh,kf,this.up):za.lookAt(kf,Xh,this.up),this.quaternion.setFromRotationMatrix(za),l&&(za.extractRotation(l.matrixWorld),Lc.setFromRotationMatrix(za),this.quaternion.premultiply(Lc.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(EC)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(PC)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),za.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),za.multiply(e.parent.matrixWorld)),e.applyMatrix4(za),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,l=this.children.length;i<l;i++){var c=this.children[i],h=c.getObjectByProperty(e,t);if(h!==void 0)return h}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new xe),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new qr),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Xh,e,SC),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new xe),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Xh,TC,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new xe),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,l=t.length;i<l;i++)t[i].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=this.children,i=0,l=t.length;i<l;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,l=t.length;i<l;i++)t[i].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0)for(var l=this.children,c=0,h=l.length;c<h;c++)l[c].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var l={};l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),this.castShadow===!0&&(l.castShadow=!0),this.receiveShadow===!0&&(l.receiveShadow=!0),this.visible===!1&&(l.visible=!1),this.frustumCulled===!1&&(l.frustumCulled=!1),this.renderOrder!==0&&(l.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON());function c(B,O){return B[O.uuid]===void 0&&(B[O.uuid]=O.toJSON(e)),O.uuid}if(this.isMesh||this.isLine||this.isPoints){l.geometry=c(e.geometries,this.geometry);var h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){var f=h.shapes;if(Array.isArray(f))for(var r=0,v=f.length;r<v;r++){var _=f[r];c(e.shapes,_)}else c(e.shapes,f)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var w=[],r=0,v=this.material.length;r<v;r++)w.push(c(e.materials,this.material[r]));l.material=w}else l.material=c(e.materials,this.material);if(this.children.length>0){l.children=[];for(var r=0;r<this.children.length;r++)l.children.push(this.children[r].toJSON(e).object)}if(t){var b=F(e.geometries),E=F(e.materials),P=F(e.textures),I=F(e.images),f=F(e.shapes);b.length>0&&(i.geometries=b),E.length>0&&(i.materials=E),P.length>0&&(i.textures=P),I.length>0&&(i.images=I),f.length>0&&(i.shapes=f)}return i.object=l,i;function F(B){var O=[];for(var W in B){var Z=B[W];delete Z.metadata,O.push(Z)}return O}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(t===void 0&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(var i=0;i<e.children.length;i++){var l=e.children[i];this.add(l.clone())}return this}});function Ua(){on.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ua.prototype=Object.assign(Object.create(on.prototype),{constructor:Ua,isScene:!0,copy:function(e,t){return on.prototype.copy.call(this,e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=on.prototype.toJSON.call(this,e);return this.background!==null&&(t.object.background=this.background.toJSON(e)),this.environment!==null&&(t.object.environment=this.environment.toJSON(e)),this.fog!==null&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Na=[new xe,new xe,new xe,new xe,new xe,new xe,new xe,new xe],Kh=new xe,Bf=new Vo,Fc=new xe,kc=new xe,Bc=new xe,xs=new xe,vs=new xe,ml=new xe,Zh=new xe,zf=new xe,Uf=new xe,gl=new xe;function Vo(e,t){this.min=e!==void 0?e:new xe(1/0,1/0,1/0),this.max=t!==void 0?t:new xe(-1/0,-1/0,-1/0)}Object.assign(Vo.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,l=1/0,c=-1/0,h=-1/0,f=-1/0,r=0,v=e.length;r<v;r+=3){var _=e[r],w=e[r+1],b=e[r+2];_<t&&(t=_),w<i&&(i=w),b<l&&(l=b),_>c&&(c=_),w>h&&(h=w),b>f&&(f=b)}return this.min.set(t,i,l),this.max.set(c,h,f),this},setFromBufferAttribute:function(e){for(var t=1/0,i=1/0,l=1/0,c=-1/0,h=-1/0,f=-1/0,r=0,v=e.count;r<v;r++){var _=e.getX(r),w=e.getY(r),b=e.getZ(r);_<t&&(t=_),w<i&&(i=w),b<l&&(l=b),_>c&&(c=_),w>h&&(h=w),b>f&&(f=b)}return this.min.set(t,i,l),this.max.set(c,h,f),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var i=Kh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new xe),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new xe),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),Bf.copy(t.boundingBox),Bf.applyMatrix4(e.matrixWorld),this.expandByPoint(Bf.min),this.expandByPoint(Bf.max));for(var i=e.children,l=0,c=i.length;l<c;l++)this.expandByObject(i[l]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new xe),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Kh),Kh.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Zh),zf.subVectors(this.max,Zh),Fc.subVectors(e.a,Zh),kc.subVectors(e.b,Zh),Bc.subVectors(e.c,Zh),xs.subVectors(kc,Fc),vs.subVectors(Bc,kc),ml.subVectors(Fc,Bc);var t=[0,-xs.z,xs.y,0,-vs.z,vs.y,0,-ml.z,ml.y,xs.z,0,-xs.x,vs.z,0,-vs.x,ml.z,0,-ml.x,-xs.y,xs.x,0,-vs.y,vs.x,0,-ml.y,ml.x,0];return!l0(t,Fc,kc,Bc,zf)||(t=[1,0,0,0,1,0,0,0,1],!l0(t,Fc,kc,Bc,zf))?!1:(Uf.crossVectors(xs,vs),t=[Uf.x,Uf.y,Uf.z],l0(t,Fc,kc,Bc,zf))},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new xe),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){var t=Kh.copy(e).clamp(this.min,this.max);return t.sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=this.getSize(Kh).length()*.5,e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(Na[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Na[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Na[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Na[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Na[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Na[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Na[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Na[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Na),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function l0(e,t,i,l,c){var h,f;for(h=0,f=e.length-3;h<=f;h+=3){gl.fromArray(e,h);var r=c.x*Math.abs(gl.x)+c.y*Math.abs(gl.y)+c.z*Math.abs(gl.z),v=t.dot(gl),_=i.dot(gl),w=l.dot(gl);if(Math.max(-Math.max(v,_,w),Math.min(v,_,w))>r)return!1}return!0}var CC=new Vo;function Va(e,t){this.center=e!==void 0?e:new xe,this.radius=t!==void 0?t:0}Object.assign(Va.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var i=this.center;t!==void 0?i.copy(t):CC.setFromPoints(e).getCenter(i);for(var l=0,c=0,h=e.length;c<h;c++)l=Math.max(l,i.distanceToSquared(e[c]));return this.radius=Math.sqrt(l),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e);return t===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new xe),t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Vo),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var Oa=new xe,c0=new xe,Nf=new xe,_s=new xe,u0=new xe,Vf=new xe,h0=new xe;function zc(e,t){this.origin=e!==void 0?e:new xe,this.direction=t!==void 0?t:new xe(0,0,-1)}Object.assign(zc.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return t===void 0&&(console.warn("THREE.Ray: .at() target is now required"),t=new xe),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Oa)),this},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new xe),t.subVectors(e,this.origin);var i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=Oa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Oa.copy(this.direction).multiplyScalar(t).add(this.origin),Oa.distanceToSquared(e))},distanceSqToSegment:function(e,t,i,l){c0.copy(e).add(t).multiplyScalar(.5),Nf.copy(t).sub(e).normalize(),_s.copy(this.origin).sub(c0);var c=e.distanceTo(t)*.5,h=-this.direction.dot(Nf),f=_s.dot(this.direction),r=-_s.dot(Nf),v=_s.lengthSq(),_=Math.abs(1-h*h),w,b,E,P;if(_>0)if(w=h*r-f,b=h*f-r,P=c*_,w>=0)if(b>=-P)if(b<=P){var I=1/_;w*=I,b*=I,E=w*(w+h*b+2*f)+b*(h*w+b+2*r)+v}else b=c,w=Math.max(0,-(h*b+f)),E=-w*w+b*(b+2*r)+v;else b=-c,w=Math.max(0,-(h*b+f)),E=-w*w+b*(b+2*r)+v;else b<=-P?(w=Math.max(0,-(-h*c+f)),b=w>0?-c:Math.min(Math.max(-c,-r),c),E=-w*w+b*(b+2*r)+v):b<=P?(w=0,b=Math.min(Math.max(-c,-r),c),E=b*(b+2*r)+v):(w=Math.max(0,-(h*c+f)),b=w>0?c:Math.min(Math.max(-c,-r),c),E=-w*w+b*(b+2*r)+v);else b=h>0?-c:c,w=Math.max(0,-(h*b+f)),E=-w*w+b*(b+2*r)+v;return i&&i.copy(this.direction).multiplyScalar(w).add(this.origin),l&&l.copy(Nf).multiplyScalar(b).add(c0),E},intersectSphere:function(e,t){Oa.subVectors(e.center,this.origin);var i=Oa.dot(this.direction),l=Oa.dot(Oa)-i*i,c=e.radius*e.radius;if(l>c)return null;var h=Math.sqrt(c-l),f=i-h,r=i+h;return f<0&&r<0?null:f<0?this.at(r,t):this.at(f,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return i===null?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(t===0)return!0;var i=e.normal.dot(this.direction);return i*t<0},intersectBox:function(e,t){var i,l,c,h,f,r,v=1/this.direction.x,_=1/this.direction.y,w=1/this.direction.z,b=this.origin;return v>=0?(i=(e.min.x-b.x)*v,l=(e.max.x-b.x)*v):(i=(e.max.x-b.x)*v,l=(e.min.x-b.x)*v),_>=0?(c=(e.min.y-b.y)*_,h=(e.max.y-b.y)*_):(c=(e.max.y-b.y)*_,h=(e.min.y-b.y)*_),i>h||c>l||((c>i||i!==i)&&(i=c),(h<l||l!==l)&&(l=h),w>=0?(f=(e.min.z-b.z)*w,r=(e.max.z-b.z)*w):(f=(e.max.z-b.z)*w,r=(e.min.z-b.z)*w),i>r||f>l)||((f>i||i!==i)&&(i=f),(r<l||l!==l)&&(l=r),l<0)?null:this.at(i>=0?i:l,t)},intersectsBox:function(e){return this.intersectBox(e,Oa)!==null},intersectTriangle:function(e,t,i,l,c){u0.subVectors(t,e),Vf.subVectors(i,e),h0.crossVectors(u0,Vf);var h=this.direction.dot(h0),f;if(h>0){if(l)return null;f=1}else if(h<0)f=-1,h=-h;else return null;_s.subVectors(this.origin,e);var r=f*this.direction.dot(Vf.crossVectors(_s,Vf));if(r<0)return null;var v=f*this.direction.dot(u0.cross(_s));if(v<0||r+v>h)return null;var _=-f*_s.dot(h0);return _<0?null:this.at(_/h,c)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var d0=new xe,RC=new xe,DC=new vr;function oa(e,t){this.normal=e!==void 0?e:new xe(1,0,0),this.constant=t!==void 0?t:0}Object.assign(oa.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,l){return this.normal.set(e,t,i),this.constant=l,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,i){var l=d0.subVectors(i,t).cross(RC.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(l,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return t===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new xe),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){t===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new xe);var i=e.delta(d0),l=this.normal.dot(i);if(l===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):void 0;var c=-(e.start.dot(this.normal)+this.constant)/l;if(!(c<0||c>1))return t.copy(i).multiplyScalar(c).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new xe),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var i=t||DC.getNormalMatrix(e),l=this.coplanarPoint(d0).applyMatrix4(e),c=this.normal.applyMatrix3(i).normalize();return this.constant=-l.dot(c),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var Oo=new xe,Ga=new xe,p0=new xe,ja=new xe,Uc=new xe,Nc=new xe,eb=new xe,f0=new xe,m0=new xe,g0=new xe;function gr(e,t,i){this.a=e!==void 0?e:new xe,this.b=t!==void 0?t:new xe,this.c=i!==void 0?i:new xe}Object.assign(gr,{getNormal:function(e,t,i,l){l===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),l=new xe),l.subVectors(i,t),Oo.subVectors(e,t),l.cross(Oo);var c=l.lengthSq();return c>0?l.multiplyScalar(1/Math.sqrt(c)):l.set(0,0,0)},getBarycoord:function(e,t,i,l,c){Oo.subVectors(l,t),Ga.subVectors(i,t),p0.subVectors(e,t);var h=Oo.dot(Oo),f=Oo.dot(Ga),r=Oo.dot(p0),v=Ga.dot(Ga),_=Ga.dot(p0),w=h*v-f*f;if(c===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),c=new xe),w===0)return c.set(-2,-1,-1);var b=1/w,E=(v*r-f*_)*b,P=(h*_-f*r)*b;return c.set(1-E-P,P,E)},containsPoint:function(e,t,i,l){return gr.getBarycoord(e,t,i,l,ja),ja.x>=0&&ja.y>=0&&ja.x+ja.y<=1},getUV:function(e,t,i,l,c,h,f,r){return this.getBarycoord(e,t,i,l,ja),r.set(0,0),r.addScaledVector(c,ja.x),r.addScaledVector(h,ja.y),r.addScaledVector(f,ja.z),r},isFrontFacing:function(e,t,i,l){return Oo.subVectors(i,t),Ga.subVectors(e,t),Oo.cross(Ga).dot(l)<0}}),Object.assign(gr.prototype,{set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,l){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[l]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return Oo.subVectors(this.c,this.b),Ga.subVectors(this.a,this.b),Oo.cross(Ga).length()*.5},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new xe),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return gr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new oa),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return gr.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,i,l,c){return gr.getUV(e,this.a,this.b,this.c,t,i,l,c)},containsPoint:function(e){return gr.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return gr.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new xe);var i=this.a,l=this.b,c=this.c,h,f;Uc.subVectors(l,i),Nc.subVectors(c,i),f0.subVectors(e,i);var r=Uc.dot(f0),v=Nc.dot(f0);if(r<=0&&v<=0)return t.copy(i);m0.subVectors(e,l);var _=Uc.dot(m0),w=Nc.dot(m0);if(_>=0&&w<=_)return t.copy(l);var b=r*w-_*v;if(b<=0&&r>=0&&_<=0)return h=r/(r-_),t.copy(i).addScaledVector(Uc,h);g0.subVectors(e,c);var E=Uc.dot(g0),P=Nc.dot(g0);if(P>=0&&E<=P)return t.copy(c);var I=E*v-r*P;if(I<=0&&v>=0&&P<=0)return f=v/(v-P),t.copy(i).addScaledVector(Nc,f);var F=_*P-E*w;if(F<=0&&w-_>=0&&E-P>=0)return eb.subVectors(c,l),f=(w-_)/(w-_+(E-P)),t.copy(l).addScaledVector(eb,f);var B=1/(F+I+b);return h=I*B,f=b*B,t.copy(i).addScaledVector(Uc,h).addScaledVector(Nc,f)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var tb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Go={h:0,s:0,l:0},Of={h:0,s:0,l:0};function nn(e,t,i){return t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}function y0(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}function x0(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function v0(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}Object.assign(nn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(e,t,i){if(e=Xn.euclideanModulo(e,1),t=Xn.clamp(t,0,1),i=Xn.clamp(i,0,1),t===0)this.r=this.g=this.b=i;else{var l=i<=.5?i*(1+t):i+t-i*t,c=2*i-l;this.r=y0(c,l,e+1/3),this.g=y0(c,l,e),this.b=y0(c,l,e-1/3)}return this},setStyle:function(e){function t(b){b!==void 0&&parseFloat(b)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var l,c=i[1],h=i[2];switch(c){case"rgb":case"rgba":if(l=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,t(l[5]),this;if(l=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,t(l[5]),this;break;case"hsl":case"hsla":if(l=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(h)){var f=parseFloat(l[1])/360,r=parseInt(l[2],10)/100,v=parseInt(l[3],10)/100;return t(l[5]),this.setHSL(f,r,v)}break}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var _=i[1],w=_.length;if(w===3)return this.r=parseInt(_.charAt(0)+_.charAt(0),16)/255,this.g=parseInt(_.charAt(1)+_.charAt(1),16)/255,this.b=parseInt(_.charAt(2)+_.charAt(2),16)/255,this;if(w===6)return this.r=parseInt(_.charAt(0)+_.charAt(1),16)/255,this.g=parseInt(_.charAt(2)+_.charAt(3),16)/255,this.b=parseInt(_.charAt(4)+_.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=tb[e];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return t===void 0&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){t===void 0&&(t=2);var i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=x0(e.r),this.g=x0(e.g),this.b=x0(e.b),this},copyLinearToSRGB:function(e){return this.r=v0(e.r),this.g=v0(e.g),this.b=v0(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t=this.r,i=this.g,l=this.b,c=Math.max(t,i,l),h=Math.min(t,i,l),f,r,v=(h+c)/2;if(h===c)f=0,r=0;else{var _=c-h;switch(r=v<=.5?_/(c+h):_/(2-c-h),c){case t:f=(i-l)/_+(i<l?6:0);break;case i:f=(l-t)/_+2;break;case l:f=(t-i)/_+4;break}f/=6}return e.h=f,e.s=r,e.l=v,e},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(e,t,i){return this.getHSL(Go),Go.h+=e,Go.s+=t,Go.l+=i,this.setHSL(Go.h,Go.s,Go.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Go),e.getHSL(Of);var i=Xn.lerp(Go.h,Of.h,t),l=Xn.lerp(Go.s,Of.s,t),c=Xn.lerp(Go.l,Of.l,t);return this.setHSL(i,l,c),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return t===void 0&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),nn.NAMES=tb;function Gf(e,t,i,l,c,h){this.a=e,this.b=t,this.c=i,this.normal=l&&l.isVector3?l:new xe,this.vertexNormals=Array.isArray(l)?l:[],this.color=c&&c.isColor?c:new nn,this.vertexColors=Array.isArray(c)?c:[],this.materialIndex=h!==void 0?h:0}Object.assign(Gf.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var IC=0;function zn(){Object.defineProperty(this,"id",{value:IC++}),this.uuid=Xn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Nh,this.side=wc,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=b1,this.opacity=1,this.transparent=!1,this.blendSrc=E1,this.blendDst=P1,this.blendEquation=Mc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ky,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=_C,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=a0,this.stencilZFail=a0,this.stencilZPass=a0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}zn.prototype=Object.assign(Object.create(Ba.prototype),{constructor:zn,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var t in e){var i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===_1;continue}var l=this[t];if(l===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}l&&l.isColor?l.set(i):l&&l.isVector3&&i&&i.isVector3?l.copy(i):this[t]=i}},toJSON:function(e){var t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,this.combine!==void 0&&(i.combine=this.combine),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(i.size=this.size),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Nh&&(i.blending=this.blending),this.flatShading===!0&&(i.flatShading=this.flatShading),this.side!==wc&&(i.side=this.side),this.vertexColors!==b1&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(i.morphTargets=!0),this.morphNormals===!0&&(i.morphNormals=!0),this.skinning===!0&&(i.skinning=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData);function l(f){var r=[];for(var v in f){var _=f[v];delete _.metadata,r.push(_)}return r}if(t){var c=l(e.textures),h=l(e.images);c.length>0&&(i.textures=c),h.length>0&&(i.images=h)}return i},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,i=null;if(t!==null){var l=t.length;i=new Array(l);for(var c=0;c!==l;++c)i[c]=t[c].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(zn.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function _r(e){zn.call(this),this.type="MeshBasicMaterial",this.color=new nn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Sf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}_r.prototype=Object.create(zn.prototype),_r.prototype.constructor=_r,_r.prototype.isMeshBasicMaterial=!0,_r.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var vi=new xe;function Un(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i===!0,this.usage=Lf,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(Un.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Un.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var l=0,c=this.itemSize;l<c;l++)this.array[e+l]=t.array[i+l];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,l=0,c=e.length;l<c;l++){var h=e[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",l),h=new nn),t[i++]=h.r,t[i++]=h.g,t[i++]=h.b}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,l=0,c=e.length;l<c;l++){var h=e[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",l),h=new Rt),t[i++]=h.x,t[i++]=h.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,l=0,c=e.length;l<c;l++){var h=e[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",l),h=new xe),t[i++]=h.x,t[i++]=h.y,t[i++]=h.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,l=0,c=e.length;l<c;l++){var h=e[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",l),h=new wi),t[i++]=h.x,t[i++]=h.y,t[i++]=h.z,t[i++]=h.w}return this},applyMatrix3:function(e){for(var t=0,i=this.count;t<i;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.applyMatrix3(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this},applyMatrix4:function(e){for(var t=0,i=this.count;t<i;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.applyMatrix4(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this},applyNormalMatrix:function(e){for(var t=0,i=this.count;t<i;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.applyNormalMatrix(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this},transformDirection:function(e){for(var t=0,i=this.count;t<i;t++)vi.x=this.getX(t),vi.y=this.getY(t),vi.z=this.getZ(t),vi.transformDirection(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,l){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=l,this},setXYZW:function(e,t,i,l,c){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=l,this.array[e+3]=c,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function _0(e,t,i){Un.call(this,new Int8Array(e),t,i)}_0.prototype=Object.create(Un.prototype),_0.prototype.constructor=_0;function b0(e,t,i){Un.call(this,new Uint8Array(e),t,i)}b0.prototype=Object.create(Un.prototype),b0.prototype.constructor=b0;function w0(e,t,i){Un.call(this,new Uint8ClampedArray(e),t,i)}w0.prototype=Object.create(Un.prototype),w0.prototype.constructor=w0;function A0(e,t,i){Un.call(this,new Int16Array(e),t,i)}A0.prototype=Object.create(Un.prototype),A0.prototype.constructor=A0;function Jh(e,t,i){Un.call(this,new Uint16Array(e),t,i)}Jh.prototype=Object.create(Un.prototype),Jh.prototype.constructor=Jh;function M0(e,t,i){Un.call(this,new Int32Array(e),t,i)}M0.prototype=Object.create(Un.prototype),M0.prototype.constructor=M0;function Qh(e,t,i){Un.call(this,new Uint32Array(e),t,i)}Qh.prototype=Object.create(Un.prototype),Qh.prototype.constructor=Qh;function cn(e,t,i){Un.call(this,new Float32Array(e),t,i)}cn.prototype=Object.create(Un.prototype),cn.prototype.constructor=cn;function S0(e,t,i){Un.call(this,new Float64Array(e),t,i)}S0.prototype=Object.create(Un.prototype),S0.prototype.constructor=S0;function nb(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(nb.prototype,{computeGroups:function(e){for(var t,i=[],l=void 0,c=e.faces,h=0;h<c.length;h++){var f=c[h];f.materialIndex!==l&&(l=f.materialIndex,t!==void 0&&(t.count=h*3-t.start,i.push(t)),t={start:h*3,materialIndex:l})}t!==void 0&&(t.count=h*3-t.start,i.push(t)),this.groups=i},fromGeometry:function(e){var t=e.faces,i=e.vertices,l=e.faceVertexUvs,c=l[0]&&l[0].length>0,h=l[1]&&l[1].length>0,f=e.morphTargets,r=f.length,v;if(r>0){v=[];for(var _=0;_<r;_++)v[_]={name:f[_].name,data:[]};this.morphTargets.position=v}var w=e.morphNormals,b=w.length,E;if(b>0){E=[];for(var _=0;_<b;_++)E[_]={name:w[_].name,data:[]};this.morphTargets.normal=E}var P=e.skinIndices,I=e.skinWeights,F=P.length===i.length,B=I.length===i.length;i.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var _=0;_<t.length;_++){var O=t[_];this.vertices.push(i[O.a],i[O.b],i[O.c]);var W=O.vertexNormals;if(W.length===3)this.normals.push(W[0],W[1],W[2]);else{var Z=O.normal;this.normals.push(Z,Z,Z)}var ie=O.vertexColors;if(ie.length===3)this.colors.push(ie[0],ie[1],ie[2]);else{var $=O.color;this.colors.push($,$,$)}if(c===!0){var oe=l[0][_];oe!==void 0?this.uvs.push(oe[0],oe[1],oe[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",_),this.uvs.push(new Rt,new Rt,new Rt))}if(h===!0){var oe=l[1][_];oe!==void 0?this.uvs2.push(oe[0],oe[1],oe[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",_),this.uvs2.push(new Rt,new Rt,new Rt))}for(var be=0;be<r;be++){var fe=f[be].vertices;v[be].data.push(fe[O.a],fe[O.b],fe[O.c])}for(var be=0;be<b;be++){var Le=w[be].vertexNormals[_];E[be].data.push(Le.a,Le.b,Le.c)}F&&this.skinIndices.push(P[O.a],P[O.b],P[O.c]),B&&this.skinWeights.push(I[O.a],I[O.b],I[O.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});function ib(e){if(e.length===0)return-1/0;for(var t=e[0],i=1,l=e.length;i<l;++i)e[i]>t&&(t=e[i]);return t}var LC=1,aa=new Kn,T0=new on,Vc=new xe,ho=new Vo,$h=new Vo,er=new xe;function _n(){Object.defineProperty(this,"id",{value:LC+=2}),this.uuid=Xn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}_n.prototype=Object.assign(Object.create(Ba.prototype),{constructor:_n,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(ib(e)>65535?Qh:Jh)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:i!==void 0?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);var i=this.attributes.normal;if(i!==void 0){var l=new vr().getNormalMatrix(e);i.applyNormalMatrix(l),i.needsUpdate=!0}var c=this.attributes.tangent;return c!==void 0&&(c.transformDirection(e),c.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return aa.makeRotationX(e),this.applyMatrix4(aa),this},rotateY:function(e){return aa.makeRotationY(e),this.applyMatrix4(aa),this},rotateZ:function(e){return aa.makeRotationZ(e),this.applyMatrix4(aa),this},translate:function(e,t,i){return aa.makeTranslation(e,t,i),this.applyMatrix4(aa),this},scale:function(e,t,i){return aa.makeScale(e,t,i),this.applyMatrix4(aa),this},lookAt:function(e){return T0.lookAt(e),T0.updateMatrix(),this.applyMatrix4(T0.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vc).negate(),this.translate(Vc.x,Vc.y,Vc.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var i=new cn(t.vertices.length*3,3),l=new cn(t.colors.length*3,3);if(this.setAttribute("position",i.copyVector3sArray(t.vertices)),this.setAttribute("color",l.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var c=new cn(t.lineDistances.length,1);this.setAttribute("lineDistance",c.copyArray(t.lineDistances))}t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],i=0,l=e.length;i<l;i++){var c=e[i];t.push(c.x,c.y,c.z||0)}return this.setAttribute("position",new cn(t,3)),this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var i=t.__directGeometry;if(t.elementsNeedUpdate===!0&&(i=void 0,t.elementsNeedUpdate=!1),i===void 0)return this.fromGeometry(t);i.verticesNeedUpdate=t.verticesNeedUpdate,i.normalsNeedUpdate=t.normalsNeedUpdate,i.colorsNeedUpdate=t.colorsNeedUpdate,i.uvsNeedUpdate=t.uvsNeedUpdate,i.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=i}var l;return t.verticesNeedUpdate===!0&&(l=this.attributes.position,l!==void 0&&(l.copyVector3sArray(t.vertices),l.needsUpdate=!0),t.verticesNeedUpdate=!1),t.normalsNeedUpdate===!0&&(l=this.attributes.normal,l!==void 0&&(l.copyVector3sArray(t.normals),l.needsUpdate=!0),t.normalsNeedUpdate=!1),t.colorsNeedUpdate===!0&&(l=this.attributes.color,l!==void 0&&(l.copyColorsArray(t.colors),l.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(l=this.attributes.uv,l!==void 0&&(l.copyVector2sArray(t.uvs),l.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(l=this.attributes.lineDistance,l!==void 0&&(l.copyArray(t.lineDistances),l.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new nb().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(e.vertices.length*3);if(this.setAttribute("position",new Un(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var i=new Float32Array(e.normals.length*3);this.setAttribute("normal",new Un(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var l=new Float32Array(e.colors.length*3);this.setAttribute("color",new Un(l,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var c=new Float32Array(e.uvs.length*2);this.setAttribute("uv",new Un(c,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var h=new Float32Array(e.uvs2.length*2);this.setAttribute("uv2",new Un(h,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var f in e.morphTargets){for(var r=[],v=e.morphTargets[f],_=0,w=v.length;_<w;_++){var b=v[_],E=new cn(b.data.length*3,3);E.name=b.name,r.push(E.copyVector3sArray(b.data))}this.morphAttributes[f]=r}if(e.skinIndices.length>0){var P=new cn(e.skinIndices.length*4,4);this.setAttribute("skinIndex",P.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var I=new cn(e.skinWeights.length*4,4);this.setAttribute("skinWeight",I.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Vo);var e=this.attributes.position,t=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(var i=0,l=t.length;i<l;i++){var c=t[i];ho.setFromBufferAttribute(c),this.morphTargetsRelative?(er.addVectors(this.boundingBox.min,ho.min),this.boundingBox.expandByPoint(er),er.addVectors(this.boundingBox.max,ho.max),this.boundingBox.expandByPoint(er)):(this.boundingBox.expandByPoint(ho.min),this.boundingBox.expandByPoint(ho.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Va);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var i=this.boundingSphere.center;if(ho.setFromBufferAttribute(e),t)for(var l=0,c=t.length;l<c;l++){var h=t[l];$h.setFromBufferAttribute(h),this.morphTargetsRelative?(er.addVectors(ho.min,$h.min),ho.expandByPoint(er),er.addVectors(ho.max,$h.max),ho.expandByPoint(er)):(ho.expandByPoint($h.min),ho.expandByPoint($h.max))}ho.getCenter(i);for(var f=0,l=0,c=e.count;l<c;l++)er.fromBufferAttribute(e,l),f=Math.max(f,i.distanceToSquared(er));if(t)for(var l=0,c=t.length;l<c;l++)for(var h=t[l],r=this.morphTargetsRelative,v=0,_=h.count;v<_;v++)er.fromBufferAttribute(h,v),r&&(Vc.fromBufferAttribute(e,v),er.add(Vc)),f=Math.max(f,i.distanceToSquared(er));this.boundingSphere.radius=Math.sqrt(f),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var i=t.position.array;if(t.normal===void 0)this.setAttribute("normal",new Un(new Float32Array(i.length),3));else for(var l=t.normal.array,c=0,h=l.length;c<h;c++)l[c]=0;var f=t.normal.array,r,v,_,w=new xe,b=new xe,E=new xe,P=new xe,I=new xe;if(e)for(var F=e.array,c=0,h=e.count;c<h;c+=3)r=F[c+0]*3,v=F[c+1]*3,_=F[c+2]*3,w.fromArray(i,r),b.fromArray(i,v),E.fromArray(i,_),P.subVectors(E,b),I.subVectors(w,b),P.cross(I),f[r]+=P.x,f[r+1]+=P.y,f[r+2]+=P.z,f[v]+=P.x,f[v+1]+=P.y,f[v+2]+=P.z,f[_]+=P.x,f[_+1]+=P.y,f[_+2]+=P.z;else for(var c=0,h=i.length;c<h;c+=9)w.fromArray(i,c),b.fromArray(i,c+3),E.fromArray(i,c+6),P.subVectors(E,b),I.subVectors(w,b),P.cross(I),f[c]=P.x,f[c+1]=P.y,f[c+2]=P.z,f[c+3]=P.x,f[c+4]=P.y,f[c+5]=P.z,f[c+6]=P.x,f[c+7]=P.y,f[c+8]=P.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var l in i)if(e.attributes[l]!==void 0)for(var c=i[l],h=c.array,f=e.attributes[l],r=f.array,v=f.itemSize*t,_=Math.min(r.length,h.length-v),w=0,b=v;w<_;w++,b++)h[b]=r[w];return this},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,i=e.count;t<i;t++)er.x=e.getX(t),er.y=e.getY(t),er.z=e.getZ(t),er.normalize(),e.setXYZ(t,er.x,er.y,er.z)},toNonIndexed:function(){function e(F,B){for(var O=F.array,W=F.itemSize,Z=new O.constructor(B.length*W),ie=0,$=0,oe=0,be=B.length;oe<be;oe++){ie=B[oe]*W;for(var fe=0;fe<W;fe++)Z[$++]=O[ie++]}return new Un(Z,W)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new _n,i=this.index.array,l=this.attributes;for(var c in l){var h=l[c],f=e(h,i);t.setAttribute(c,f)}var r=this.morphAttributes;for(c in r){for(var v=[],_=r[c],w=0,b=_.length;w<b;w++){var h=_[w],f=e(h,i);v.push(f)}t.morphAttributes[c]=v}t.morphTargetsRelative=this.morphTargetsRelative;for(var E=this.groups,w=0,P=E.length;w<P;w++){var I=E[w];t.addGroup(I.start,I.count,I.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){var t=this.parameters;for(var i in t)t[i]!==void 0&&(e[i]=t[i]);return e}e.data={attributes:{}};var l=this.index;l!==null&&(e.data.index={type:l.array.constructor.name,array:Array.prototype.slice.call(l.array)});var c=this.attributes;for(var i in c){var h=c[i],f=h.toJSON();h.name!==""&&(f.name=h.name),e.data.attributes[i]=f}var r={},v=!1;for(var i in this.morphAttributes){for(var _=this.morphAttributes[i],w=[],b=0,E=_.length;b<E;b++){var h=_[b],f=h.toJSON();h.name!==""&&(f.name=h.name),w.push(f)}w.length>0&&(r[i]=w,v=!0)}v&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);var P=this.groups;P.length>0&&(e.data.groups=JSON.parse(JSON.stringify(P)));var I=this.boundingSphere;return I!==null&&(e.data.boundingSphere={center:I.center.toArray(),radius:I.radius}),e},clone:function(){return new _n().copy(this)},copy:function(e){var t,i,l;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var c=e.index;c!==null&&this.setIndex(c.clone());var h=e.attributes;for(t in h){var f=h[t];this.setAttribute(t,f.clone())}var r=e.morphAttributes;for(t in r){var v=[],_=r[t];for(i=0,l=_.length;i<l;i++)v.push(_[i].clone());this.morphAttributes[t]=v}this.morphTargetsRelative=e.morphTargetsRelative;var w=e.groups;for(i=0,l=w.length;i<l;i++){var b=w[i];this.addGroup(b.start,b.count,b.materialIndex)}var E=e.boundingBox;E!==null&&(this.boundingBox=E.clone());var P=e.boundingSphere;return P!==null&&(this.boundingSphere=P.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var rb=new Kn,yl=new zc,E0=new Va,xl=new xe,vl=new xe,_l=new xe,P0=new xe,C0=new xe,R0=new xe,jf=new xe,Hf=new xe,Wf=new xe,Oc=new Rt,Gc=new Rt,jc=new Rt,ed=new xe,qf=new xe;function Fi(e,t){on.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new _n,this.material=t!==void 0?t:new _r,this.updateMorphTargets()}Fi.prototype=Object.assign(Object.create(on.prototype),{constructor:Fi,isMesh:!0,copy:function(e){return on.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry,t,i,l;if(e.isBufferGeometry){var c=e.morphAttributes,h=Object.keys(c);if(h.length>0){var f=c[h[0]];if(f!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,i=f.length;t<i;t++)l=f[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=t}}else{var r=e.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var i=this.geometry,l=this.material,c=this.matrixWorld;if(l!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),E0.copy(i.boundingSphere),E0.applyMatrix4(c),e.ray.intersectsSphere(E0)!==!1&&(rb.getInverse(c),yl.copy(e.ray).applyMatrix4(rb),!(i.boundingBox!==null&&yl.intersectsBox(i.boundingBox)===!1)))){var h;if(i.isBufferGeometry){var f,r,v,_=i.index,w=i.attributes.position,b=i.morphAttributes.position,E=i.morphTargetsRelative,P=i.attributes.uv,I=i.attributes.uv2,F=i.groups,B=i.drawRange,O,W,Z,ie,$,oe,be,fe;if(_!==null)if(Array.isArray(l))for(O=0,Z=F.length;O<Z;O++)for($=F[O],oe=l[$.materialIndex],be=Math.max($.start,B.start),fe=Math.min($.start+$.count,B.start+B.count),W=be,ie=fe;W<ie;W+=3)f=_.getX(W),r=_.getX(W+1),v=_.getX(W+2),h=Yf(this,oe,e,yl,w,b,E,P,I,f,r,v),h&&(h.faceIndex=Math.floor(W/3),h.face.materialIndex=$.materialIndex,t.push(h));else for(be=Math.max(0,B.start),fe=Math.min(_.count,B.start+B.count),O=be,Z=fe;O<Z;O+=3)f=_.getX(O),r=_.getX(O+1),v=_.getX(O+2),h=Yf(this,l,e,yl,w,b,E,P,I,f,r,v),h&&(h.faceIndex=Math.floor(O/3),t.push(h));else if(w!==void 0)if(Array.isArray(l))for(O=0,Z=F.length;O<Z;O++)for($=F[O],oe=l[$.materialIndex],be=Math.max($.start,B.start),fe=Math.min($.start+$.count,B.start+B.count),W=be,ie=fe;W<ie;W+=3)f=W,r=W+1,v=W+2,h=Yf(this,oe,e,yl,w,b,E,P,I,f,r,v),h&&(h.faceIndex=Math.floor(W/3),h.face.materialIndex=$.materialIndex,t.push(h));else for(be=Math.max(0,B.start),fe=Math.min(w.count,B.start+B.count),O=be,Z=fe;O<Z;O+=3)f=O,r=O+1,v=O+2,h=Yf(this,l,e,yl,w,b,E,P,I,f,r,v),h&&(h.faceIndex=Math.floor(O/3),t.push(h))}else if(i.isGeometry){var Le,Xe,Ne,Re=Array.isArray(l),Ie=i.vertices,He=i.faces,Ue,ot=i.faceVertexUvs[0];ot.length>0&&(Ue=ot);for(var Pt=0,mt=He.length;Pt<mt;Pt++){var _t=He[Pt],ft=Re?l[_t.materialIndex]:l;if(ft!==void 0&&(Le=Ie[_t.a],Xe=Ie[_t.b],Ne=Ie[_t.c],h=ob(this,ft,e,yl,Le,Xe,Ne,ed),h)){if(Ue&&Ue[Pt]){var Vt=Ue[Pt];Oc.copy(Vt[0]),Gc.copy(Vt[1]),jc.copy(Vt[2]),h.uv=gr.getUV(ed,Le,Xe,Ne,Oc,Gc,jc,new Rt)}h.face=_t,h.faceIndex=Pt,t.push(h)}}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function ob(e,t,i,l,c,h,f,r){var v;if(t.side===lr?v=l.intersectTriangle(f,h,c,!0,r):v=l.intersectTriangle(c,h,f,t.side!==Uh,r),v===null)return null;qf.copy(r),qf.applyMatrix4(e.matrixWorld);var _=i.ray.origin.distanceTo(qf);return _<i.near||_>i.far?null:{distance:_,point:qf.clone(),object:e}}function Yf(e,t,i,l,c,h,f,r,v,_,w,b){xl.fromBufferAttribute(c,_),vl.fromBufferAttribute(c,w),_l.fromBufferAttribute(c,b);var E=e.morphTargetInfluences;if(t.morphTargets&&h&&E){jf.set(0,0,0),Hf.set(0,0,0),Wf.set(0,0,0);for(var P=0,I=h.length;P<I;P++){var F=E[P],B=h[P];F!==0&&(P0.fromBufferAttribute(B,_),C0.fromBufferAttribute(B,w),R0.fromBufferAttribute(B,b),f?(jf.addScaledVector(P0,F),Hf.addScaledVector(C0,F),Wf.addScaledVector(R0,F)):(jf.addScaledVector(P0.sub(xl),F),Hf.addScaledVector(C0.sub(vl),F),Wf.addScaledVector(R0.sub(_l),F)))}xl.add(jf),vl.add(Hf),_l.add(Wf)}var O=ob(e,t,i,l,xl,vl,_l,ed);if(O){r&&(Oc.fromBufferAttribute(r,_),Gc.fromBufferAttribute(r,w),jc.fromBufferAttribute(r,b),O.uv=gr.getUV(ed,xl,vl,_l,Oc,Gc,jc,new Rt)),v&&(Oc.fromBufferAttribute(v,_),Gc.fromBufferAttribute(v,w),jc.fromBufferAttribute(v,b),O.uv2=gr.getUV(ed,xl,vl,_l,Oc,Gc,jc,new Rt));var W=new Gf(_,w,b);gr.getNormal(xl,vl,_l,W.normal),O.face=W}return O}var FC=0,sa=new Kn,D0=new on,Xf=new xe;function On(){Object.defineProperty(this,"id",{value:FC+=2}),this.uuid=Xn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}On.prototype=Object.assign(Object.create(Ba.prototype),{constructor:On,isGeometry:!0,applyMatrix4:function(e){for(var t=new vr().getNormalMatrix(e),i=0,l=this.vertices.length;i<l;i++){var c=this.vertices[i];c.applyMatrix4(e)}for(var i=0,l=this.faces.length;i<l;i++){var h=this.faces[i];h.normal.applyMatrix3(t).normalize();for(var f=0,r=h.vertexNormals.length;f<r;f++)h.vertexNormals[f].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return sa.makeRotationX(e),this.applyMatrix4(sa),this},rotateY:function(e){return sa.makeRotationY(e),this.applyMatrix4(sa),this},rotateZ:function(e){return sa.makeRotationZ(e),this.applyMatrix4(sa),this},translate:function(e,t,i){return sa.makeTranslation(e,t,i),this.applyMatrix4(sa),this},scale:function(e,t,i){return sa.makeScale(e,t,i),this.applyMatrix4(sa),this},lookAt:function(e){return D0.lookAt(e),D0.updateMatrix(),this.applyMatrix4(D0.matrix),this},fromBufferGeometry:function(e){var t=this,i=e.index!==null?e.index.array:void 0,l=e.attributes;if(l.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var c=l.position.array,h=l.normal!==void 0?l.normal.array:void 0,f=l.color!==void 0?l.color.array:void 0,r=l.uv!==void 0?l.uv.array:void 0,v=l.uv2!==void 0?l.uv2.array:void 0;v!==void 0&&(this.faceVertexUvs[1]=[]);for(var _=0;_<c.length;_+=3)t.vertices.push(new xe().fromArray(c,_)),f!==void 0&&t.colors.push(new nn().fromArray(f,_));function w(O,W,Z,ie){var $=f===void 0?[]:[t.colors[O].clone(),t.colors[W].clone(),t.colors[Z].clone()],oe=h===void 0?[]:[new xe().fromArray(h,O*3),new xe().fromArray(h,W*3),new xe().fromArray(h,Z*3)],be=new Gf(O,W,Z,oe,$,ie);t.faces.push(be),r!==void 0&&t.faceVertexUvs[0].push([new Rt().fromArray(r,O*2),new Rt().fromArray(r,W*2),new Rt().fromArray(r,Z*2)]),v!==void 0&&t.faceVertexUvs[1].push([new Rt().fromArray(v,O*2),new Rt().fromArray(v,W*2),new Rt().fromArray(v,Z*2)])}var b=e.groups;if(b.length>0)for(var _=0;_<b.length;_++)for(var E=b[_],P=E.start,I=E.count,F=P,B=P+I;F<B;F+=3)i!==void 0?w(i[F],i[F+1],i[F+2],E.materialIndex):w(F,F+1,F+2,E.materialIndex);else if(i!==void 0)for(var _=0;_<i.length;_+=3)w(i[_],i[_+1],i[_+2]);else for(var _=0;_<c.length/3;_+=3)w(_,_+1,_+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xf).negate(),this.translate(Xf.x,Xf.y,Xf.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=t===0?1:1/t,l=new Kn;return l.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(l),this},computeFaceNormals:function(){for(var e=new xe,t=new xe,i=0,l=this.faces.length;i<l;i++){var c=this.faces[i],h=this.vertices[c.a],f=this.vertices[c.b],r=this.vertices[c.c];e.subVectors(r,f),t.subVectors(h,f),e.cross(t),e.normalize(),c.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var t,i,l,c,h,f;for(f=new Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)f[t]=new xe;if(e){var r,v,_,w=new xe,b=new xe;for(l=0,c=this.faces.length;l<c;l++)h=this.faces[l],r=this.vertices[h.a],v=this.vertices[h.b],_=this.vertices[h.c],w.subVectors(_,v),b.subVectors(r,v),w.cross(b),f[h.a].add(w),f[h.b].add(w),f[h.c].add(w)}else for(this.computeFaceNormals(),l=0,c=this.faces.length;l<c;l++)h=this.faces[l],f[h.a].add(h.normal),f[h.b].add(h.normal),f[h.c].add(h.normal);for(t=0,i=this.vertices.length;t<i;t++)f[t].normalize();for(l=0,c=this.faces.length;l<c;l++){h=this.faces[l];var E=h.vertexNormals;E.length===3?(E[0].copy(f[h.a]),E[1].copy(f[h.b]),E[2].copy(f[h.c])):(E[0]=f[h.a].clone(),E[1]=f[h.b].clone(),E[2]=f[h.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,i;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){i=this.faces[e];var l=i.vertexNormals;l.length===3?(l[0].copy(i.normal),l[1].copy(i.normal),l[2].copy(i.normal)):(l[0]=i.normal.clone(),l[1]=i.normal.clone(),l[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,l,c;for(i=0,l=this.faces.length;i<l;i++)for(c=this.faces[i],c.__originalFaceNormal?c.__originalFaceNormal.copy(c.normal):c.__originalFaceNormal=c.normal.clone(),c.__originalVertexNormals||(c.__originalVertexNormals=[]),e=0,t=c.vertexNormals.length;e<t;e++)c.__originalVertexNormals[e]?c.__originalVertexNormals[e].copy(c.vertexNormals[e]):c.__originalVertexNormals[e]=c.vertexNormals[e].clone();var h=new On;for(h.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var f=this.morphNormals[e].faceNormals,r=this.morphNormals[e].vertexNormals,_,w;for(i=0,l=this.faces.length;i<l;i++)_=new xe,w={a:new xe,b:new xe,c:new xe},f.push(_),r.push(w)}var v=this.morphNormals[e];h.vertices=this.morphTargets[e].vertices,h.computeFaceNormals(),h.computeVertexNormals();var _,w;for(i=0,l=this.faces.length;i<l;i++)c=this.faces[i],_=v.faceNormals[i],w=v.vertexNormals[i],_.copy(c.normal),w.a.copy(c.vertexNormals[0]),w.b.copy(c.vertexNormals[1]),w.c.copy(c.vertexNormals[2])}for(i=0,l=this.faces.length;i<l;i++)c=this.faces[i],c.normal=c.__originalFaceNormal,c.vertexNormals=c.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Vo),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Va),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var l,c=this.vertices.length,h=this.vertices,f=e.vertices,r=this.faces,v=e.faces,_=this.colors,w=e.colors;i===void 0&&(i=0),t!==void 0&&(l=new vr().getNormalMatrix(t));for(var b=0,E=f.length;b<E;b++){var P=f[b],I=P.clone();t!==void 0&&I.applyMatrix4(t),h.push(I)}for(var b=0,E=w.length;b<E;b++)_.push(w[b].clone());for(b=0,E=v.length;b<E;b++){var F=v[b],B,O,W,Z=F.vertexNormals,ie=F.vertexColors;B=new Gf(F.a+c,F.b+c,F.c+c),B.normal.copy(F.normal),l!==void 0&&B.normal.applyMatrix3(l).normalize();for(var $=0,oe=Z.length;$<oe;$++)O=Z[$].clone(),l!==void 0&&O.applyMatrix3(l).normalize(),B.vertexNormals.push(O);B.color.copy(F.color);for(var $=0,oe=ie.length;$<oe;$++)W=ie[$],B.vertexColors.push(W.clone());B.materialIndex=F.materialIndex+i,r.push(B)}for(var b=0,E=e.faceVertexUvs.length;b<E;b++){var be=e.faceVertexUvs[b];this.faceVertexUvs[b]===void 0&&(this.faceVertexUvs[b]=[]);for(var $=0,oe=be.length;$<oe;$++){for(var fe=be[$],Le=[],Xe=0,Ne=fe.length;Xe<Ne;Xe++)Le.push(fe[Xe].clone());this.faceVertexUvs[b].push(Le)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){var e={},t=[],i=[],l,c,h=4,f=Math.pow(10,h),r,v,_,w,b,E;for(r=0,v=this.vertices.length;r<v;r++)l=this.vertices[r],c=Math.round(l.x*f)+"_"+Math.round(l.y*f)+"_"+Math.round(l.z*f),e[c]===void 0?(e[c]=r,t.push(this.vertices[r]),i[r]=t.length-1):i[r]=i[e[c]];var P=[];for(r=0,v=this.faces.length;r<v;r++){_=this.faces[r],_.a=i[_.a],_.b=i[_.b],_.c=i[_.c],w=[_.a,_.b,_.c];for(var I=0;I<3;I++)if(w[I]===w[(I+1)%3]){P.push(r);break}}for(r=P.length-1;r>=0;r--){var F=P[r];for(this.faces.splice(F,1),b=0,E=this.faceVertexUvs.length;b<E;b++)this.faceVertexUvs[b].splice(F,1)}var B=this.vertices.length-t.length;return this.vertices=t,B},setFromPoints:function(e){this.vertices=[];for(var t=0,i=e.length;t<i;t++){var l=e[t];this.vertices.push(new xe(l.x,l.y,l.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;function l(_,w){return _.materialIndex-w.materialIndex}e.sort(l);var c=this.faceVertexUvs[0],h=this.faceVertexUvs[1],f,r;c&&c.length===t&&(f=[]),h&&h.length===t&&(r=[]);for(var i=0;i<t;i++){var v=e[i]._id;f&&f.push(c[v]),r&&r.push(h[v])}f&&(this.faceVertexUvs[0]=f),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var t=this.parameters;for(var i in t)t[i]!==void 0&&(e[i]=t[i]);return e}for(var l=[],c=0;c<this.vertices.length;c++){var h=this.vertices[c];l.push(h.x,h.y,h.z)}for(var f=[],r=[],v={},_=[],w={},b=[],E={},c=0;c<this.faces.length;c++){var P=this.faces[c],I=!0,F=!1,B=this.faceVertexUvs[0][c]!==void 0,O=P.normal.length()>0,W=P.vertexNormals.length>0,Z=P.color.r!==1||P.color.g!==1||P.color.b!==1,ie=P.vertexColors.length>0,$=0;if($=Le($,0,0),$=Le($,1,I),$=Le($,2,F),$=Le($,3,B),$=Le($,4,O),$=Le($,5,W),$=Le($,6,Z),$=Le($,7,ie),f.push($),f.push(P.a,P.b,P.c),f.push(P.materialIndex),B){var oe=this.faceVertexUvs[0][c];f.push(Re(oe[0]),Re(oe[1]),Re(oe[2]))}if(O&&f.push(Xe(P.normal)),W){var be=P.vertexNormals;f.push(Xe(be[0]),Xe(be[1]),Xe(be[2]))}if(Z&&f.push(Ne(P.color)),ie){var fe=P.vertexColors;f.push(Ne(fe[0]),Ne(fe[1]),Ne(fe[2]))}}function Le(Ie,He,Ue){return Ue?Ie|1<<He:Ie&~(1<<He)}function Xe(Ie){var He=Ie.x.toString()+Ie.y.toString()+Ie.z.toString();return v[He]!==void 0||(v[He]=r.length/3,r.push(Ie.x,Ie.y,Ie.z)),v[He]}function Ne(Ie){var He=Ie.r.toString()+Ie.g.toString()+Ie.b.toString();return w[He]!==void 0||(w[He]=_.length,_.push(Ie.getHex())),w[He]}function Re(Ie){var He=Ie.x.toString()+Ie.y.toString();return E[He]!==void 0||(E[He]=b.length/2,b.push(Ie.x,Ie.y)),E[He]}return e.data={},e.data.vertices=l,e.data.normals=r,_.length>0&&(e.data.colors=_),b.length>0&&(e.data.uvs=[b]),e.data.faces=f,e},clone:function(){return new On().copy(this)},copy:function(e){var t,i,l,c,h,f;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.vertices;for(t=0,i=r.length;t<i;t++)this.vertices.push(r[t].clone());var v=e.colors;for(t=0,i=v.length;t<i;t++)this.colors.push(v[t].clone());var _=e.faces;for(t=0,i=_.length;t<i;t++)this.faces.push(_[t].clone());for(t=0,i=e.faceVertexUvs.length;t<i;t++){var w=e.faceVertexUvs[t];for(this.faceVertexUvs[t]===void 0&&(this.faceVertexUvs[t]=[]),l=0,c=w.length;l<c;l++){var b=w[l],E=[];for(h=0,f=b.length;h<f;h++){var P=b[h];E.push(P.clone())}this.faceVertexUvs[t].push(E)}}var I=e.morphTargets;for(t=0,i=I.length;t<i;t++){var F={};if(F.name=I[t].name,I[t].vertices!==void 0)for(F.vertices=[],l=0,c=I[t].vertices.length;l<c;l++)F.vertices.push(I[t].vertices[l].clone());if(I[t].normals!==void 0)for(F.normals=[],l=0,c=I[t].normals.length;l<c;l++)F.normals.push(I[t].normals[l].clone());this.morphTargets.push(F)}var B=e.morphNormals;for(t=0,i=B.length;t<i;t++){var O={};if(B[t].vertexNormals!==void 0)for(O.vertexNormals=[],l=0,c=B[t].vertexNormals.length;l<c;l++){var W=B[t].vertexNormals[l],Z={};Z.a=W.a.clone(),Z.b=W.b.clone(),Z.c=W.c.clone(),O.vertexNormals.push(Z)}if(B[t].faceNormals!==void 0)for(O.faceNormals=[],l=0,c=B[t].faceNormals.length;l<c;l++)O.faceNormals.push(B[t].faceNormals[l].clone());this.morphNormals.push(O)}var ie=e.skinWeights;for(t=0,i=ie.length;t<i;t++)this.skinWeights.push(ie[t].clone());var $=e.skinIndices;for(t=0,i=$.length;t<i;t++)this.skinIndices.push($[t].clone());var oe=e.lineDistances;for(t=0,i=oe.length;t<i;t++)this.lineDistances.push(oe[t]);var be=e.boundingBox;be!==null&&(this.boundingBox=be.clone());var fe=e.boundingSphere;return fe!==null&&(this.boundingSphere=fe.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class kC extends On{constructor(t,i,l,c,h,f){super(),this.type="BoxGeometry",this.parameters={width:t,height:i,depth:l,widthSegments:c,heightSegments:h,depthSegments:f},this.fromBufferGeometry(new Kf(t,i,l,c,h,f)),this.mergeVertices()}}class Kf extends _n{constructor(t,i,l,c,h,f){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:i,depth:l,widthSegments:c,heightSegments:h,depthSegments:f};var r=this;t=t||1,i=i||1,l=l||1,c=Math.floor(c)||1,h=Math.floor(h)||1,f=Math.floor(f)||1;var v=[],_=[],w=[],b=[],E=0,P=0;I("z","y","x",-1,-1,l,i,t,f,h,0),I("z","y","x",1,-1,l,i,-t,f,h,1),I("x","z","y",1,1,t,l,i,c,f,2),I("x","z","y",1,-1,t,l,-i,c,f,3),I("x","y","z",1,-1,t,i,l,c,h,4),I("x","y","z",-1,-1,t,i,-l,c,h,5),this.setIndex(v),this.setAttribute("position",new cn(_,3)),this.setAttribute("normal",new cn(w,3)),this.setAttribute("uv",new cn(b,2));function I(F,B,O,W,Z,ie,$,oe,be,fe,Le){var Xe=ie/be,Ne=$/fe,Re=ie/2,Ie=$/2,He=oe/2,Ue=be+1,ot=fe+1,Pt=0,mt=0,_t,ft,Vt=new xe;for(ft=0;ft<ot;ft++){var we=ft*Ne-Ie;for(_t=0;_t<Ue;_t++){var pe=_t*Xe-Re;Vt[F]=pe*W,Vt[B]=we*Z,Vt[O]=He,_.push(Vt.x,Vt.y,Vt.z),Vt[F]=0,Vt[B]=0,Vt[O]=oe>0?1:-1,w.push(Vt.x,Vt.y,Vt.z),b.push(_t/be),b.push(1-ft/fe),Pt+=1}}for(ft=0;ft<fe;ft++)for(_t=0;_t<be;_t++){var ke=E+_t+Ue*ft,De=E+_t+Ue*(ft+1),Se=E+(_t+1)+Ue*(ft+1),tt=E+(_t+1)+Ue*ft;v.push(ke,De,tt),v.push(De,Se,tt),mt+=6}r.addGroup(P,mt,Le),P+=mt,E+=Pt}}}function Hc(e){var t={};for(var i in e){t[i]={};for(var l in e[i]){var c=e[i][l];c&&(c.isColor||c.isMatrix3||c.isMatrix4||c.isVector2||c.isVector3||c.isVector4||c.isTexture)?t[i][l]=c.clone():Array.isArray(c)?t[i][l]=c.slice():t[i][l]=c}}return t}function br(e){for(var t={},i=0;i<e.length;i++){var l=Hc(e[i]);for(var c in l)t[c]=l[c]}return t}var BC={clone:Hc,merge:br},zC=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,UC=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Yr(e){zn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=zC,this.fragmentShader=UC,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}Yr.prototype=Object.create(zn.prototype),Yr.prototype.constructor=Yr,Yr.prototype.isShaderMaterial=!0,Yr.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hc(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Yr.prototype.toJSON=function(e){var t=zn.prototype.toJSON.call(this,e);t.uniforms={};for(var i in this.uniforms){var l=this.uniforms[i],c=l.value;c&&c.isTexture?t.uniforms[i]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?t.uniforms[i]={type:"c",value:c.getHex()}:c&&c.isVector2?t.uniforms[i]={type:"v2",value:c.toArray()}:c&&c.isVector3?t.uniforms[i]={type:"v3",value:c.toArray()}:c&&c.isVector4?t.uniforms[i]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?t.uniforms[i]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?t.uniforms[i]={type:"m4",value:c.toArray()}:t.uniforms[i]={value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var h={};for(var f in this.extensions)this.extensions[f]===!0&&(h[f]=!0);return Object.keys(h).length>0&&(t.extensions=h),t};function Ha(){on.call(this),this.type="Camera",this.matrixWorldInverse=new Kn,this.projectionMatrix=new Kn,this.projectionMatrixInverse=new Kn}Ha.prototype=Object.assign(Object.create(on.prototype),{constructor:Ha,isCamera:!0,copy:function(e,t){return on.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new xe),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){on.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){on.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function tr(e,t,i,l){Ha.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=i!==void 0?i:.1,this.far=l!==void 0?l:2e3,this.focus=10,this.aspect=t!==void 0?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}tr.prototype=Object.assign(Object.create(Ha.prototype),{constructor:tr,isPerspectiveCamera:!0,copy:function(e,t){return Ha.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=Xn.RAD2DEG*2*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(Xn.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return Xn.RAD2DEG*2*Math.atan(Math.tan(Xn.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,l,c,h){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=l,this.view.width=c,this.view.height=h,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(Xn.DEG2RAD*.5*this.fov)/this.zoom,i=2*t,l=this.aspect*i,c=-.5*l,h=this.view;if(this.view!==null&&this.view.enabled){var f=h.fullWidth,r=h.fullHeight;c+=h.offsetX*l/f,t-=h.offsetY*i/r,l*=h.width/f,i*=h.height/r}var v=this.filmOffset;v!==0&&(c+=e*v/this.getFilmWidth()),this.projectionMatrix.makePerspective(c,c+l,t,t-i,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=on.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Wc=90,qc=1;function td(e,t,i,l){on.call(this),this.type="CubeCamera";var c=new tr(Wc,qc,e,t);c.up.set(0,-1,0),c.lookAt(new xe(1,0,0)),this.add(c);var h=new tr(Wc,qc,e,t);h.up.set(0,-1,0),h.lookAt(new xe(-1,0,0)),this.add(h);var f=new tr(Wc,qc,e,t);f.up.set(0,0,1),f.lookAt(new xe(0,1,0)),this.add(f);var r=new tr(Wc,qc,e,t);r.up.set(0,0,-1),r.lookAt(new xe(0,-1,0)),this.add(r);var v=new tr(Wc,qc,e,t);v.up.set(0,-1,0),v.lookAt(new xe(0,0,1)),this.add(v);var _=new tr(Wc,qc,e,t);_.up.set(0,-1,0),_.lookAt(new xe(0,0,-1)),this.add(_),l=l||{format:ka,magFilter:$i,minFilter:$i},this.renderTarget=new Yc(i,l),this.renderTarget.texture.name="CubeCamera",this.update=function(w,b){this.parent===null&&this.updateMatrixWorld();var E=w.getRenderTarget(),P=this.renderTarget,I=P.texture.generateMipmaps;P.texture.generateMipmaps=!1,w.setRenderTarget(P,0),w.render(b,c),w.setRenderTarget(P,1),w.render(b,h),w.setRenderTarget(P,2),w.render(b,f),w.setRenderTarget(P,3),w.render(b,r),w.setRenderTarget(P,4),w.render(b,v),P.texture.generateMipmaps=I,w.setRenderTarget(P,5),w.render(b,_),w.setRenderTarget(E)},this.clear=function(w,b,E,P){for(var I=w.getRenderTarget(),F=this.renderTarget,B=0;B<6;B++)w.setRenderTarget(F,B),w.clear(b,E,P);w.setRenderTarget(I)}}td.prototype=Object.create(on.prototype),td.prototype.constructor=td;function Yc(e,t,i){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=i),Dr.call(this,e,e,t)}Yc.prototype=Object.create(Dr.prototype),Yc.prototype.constructor=Yc,Yc.prototype.isWebGLCubeRenderTarget=!0,Yc.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var i=new Ua,l={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","	vWorldDirection = transformDirection( position, modelMatrix );","	#include <begin_vertex>","	#include <project_vertex>","}"].join(`
`),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","	vec3 direction = normalize( vWorldDirection );","	vec2 sampleUV;","	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","	gl_FragColor = texture2D( tEquirect, sampleUV );","}"].join(`
`)},c=new Yr({type:"CubemapFromEquirect",uniforms:Hc(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,side:lr,blending:gs});c.uniforms.tEquirect.value=t;var h=new Fi(new Kf(5,5,5),c);i.add(h);var f=new td(1,10,1);return f.renderTarget=this,f.renderTarget.texture.name="CubeCameraTexture",f.update(e,i),h.geometry.dispose(),h.material.dispose(),this};function Xc(e,t,i,l,c,h,f,r,v,_,w,b){bi.call(this,null,h,f,r,v,_,l,c,w,b),this.image={data:e||null,width:t||1,height:i||1},this.magFilter=v!==void 0?v:Yi,this.minFilter=_!==void 0?_:Yi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Xc.prototype=Object.create(bi.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isDataTexture=!0;var Kc=new Va,Zf=new xe;function nd(e,t,i,l,c,h){this.planes=[e!==void 0?e:new oa,t!==void 0?t:new oa,i!==void 0?i:new oa,l!==void 0?l:new oa,c!==void 0?c:new oa,h!==void 0?h:new oa]}Object.assign(nd.prototype,{set:function(e,t,i,l,c,h){var f=this.planes;return f[0].copy(e),f[1].copy(t),f[2].copy(i),f[3].copy(l),f[4].copy(c),f[5].copy(h),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,i=0;i<6;i++)t[i].copy(e.planes[i]);return this},setFromProjectionMatrix:function(e){var t=this.planes,i=e.elements,l=i[0],c=i[1],h=i[2],f=i[3],r=i[4],v=i[5],_=i[6],w=i[7],b=i[8],E=i[9],P=i[10],I=i[11],F=i[12],B=i[13],O=i[14],W=i[15];return t[0].setComponents(f-l,w-r,I-b,W-F).normalize(),t[1].setComponents(f+l,w+r,I+b,W+F).normalize(),t[2].setComponents(f+c,w+v,I+E,W+B).normalize(),t[3].setComponents(f-c,w-v,I-E,W-B).normalize(),t[4].setComponents(f-h,w-_,I-P,W-O).normalize(),t[5].setComponents(f+h,w+_,I+P,W+O).normalize(),this},intersectsObject:function(e){var t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Kc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Kc)},intersectsSprite:function(e){return Kc.center.set(0,0,0),Kc.radius=.7071067811865476,Kc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Kc)},intersectsSphere:function(e){for(var t=this.planes,i=e.center,l=-e.radius,c=0;c<6;c++){var h=t[c].distanceToPoint(i);if(h<l)return!1}return!0},intersectsBox:function(e){for(var t=this.planes,i=0;i<6;i++){var l=t[i];if(Zf.x=l.normal.x>0?e.max.x:e.min.x,Zf.y=l.normal.y>0?e.max.y:e.min.y,Zf.z=l.normal.z>0?e.max.z:e.min.z,l.distanceToPoint(Zf)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}});var an={common:{diffuse:{value:new nn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new vr},uv2Transform:{value:new vr},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new nn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new vr}},sprite:{diffuse:{value:new nn(15658734)},opacity:{value:1},center:{value:new Rt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new vr}}};function ab(){var e=null,t=!1,i=null;function l(c,h){t!==!1&&(i(c,h),e.requestAnimationFrame(l))}return{start:function(){t!==!0&&i!==null&&(e.requestAnimationFrame(l),t=!0)},stop:function(){t=!1},setAnimationLoop:function(c){i=c},setContext:function(c){e=c}}}function NC(e,t){var i=t.isWebGL2,l=new WeakMap;function c(_,w){var b=_.array,E=_.usage,P=e.createBuffer();e.bindBuffer(w,P),e.bufferData(w,b,E),_.onUploadCallback();var I=5126;return b instanceof Float32Array?I=5126:b instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):b instanceof Uint16Array?I=5123:b instanceof Int16Array?I=5122:b instanceof Uint32Array?I=5125:b instanceof Int32Array?I=5124:b instanceof Int8Array?I=5120:b instanceof Uint8Array&&(I=5121),{buffer:P,type:I,bytesPerElement:b.BYTES_PER_ELEMENT,version:_.version}}function h(_,w,b){var E=w.array,P=w.updateRange;e.bindBuffer(b,_),P.count===-1?e.bufferSubData(b,0,E):(i?e.bufferSubData(b,P.offset*E.BYTES_PER_ELEMENT,E,P.offset,P.count):e.bufferSubData(b,P.offset*E.BYTES_PER_ELEMENT,E.subarray(P.offset,P.offset+P.count)),P.count=-1)}function f(_){return _.isInterleavedBufferAttribute&&(_=_.data),l.get(_)}function r(_){_.isInterleavedBufferAttribute&&(_=_.data);var w=l.get(_);w&&(e.deleteBuffer(w.buffer),l.delete(_))}function v(_,w){_.isInterleavedBufferAttribute&&(_=_.data);var b=l.get(_);b===void 0?l.set(_,c(_,w)):b.version<_.version&&(h(b.buffer,_,w),b.version=_.version)}return{get:f,remove:r,update:v}}function Jf(e,t,i,l){On.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:l},this.fromBufferGeometry(new Zc(e,t,i,l)),this.mergeVertices()}Jf.prototype=Object.create(On.prototype),Jf.prototype.constructor=Jf;function Zc(e,t,i,l){_n.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:l},e=e||1,t=t||1;var c=e/2,h=t/2,f=Math.floor(i)||1,r=Math.floor(l)||1,v=f+1,_=r+1,w=e/f,b=t/r,E,P,I=[],F=[],B=[],O=[];for(P=0;P<_;P++){var W=P*b-h;for(E=0;E<v;E++){var Z=E*w-c;F.push(Z,-W,0),B.push(0,0,1),O.push(E/f),O.push(1-P/r)}}for(P=0;P<r;P++)for(E=0;E<f;E++){var ie=E+v*P,$=E+v*(P+1),oe=E+1+v*(P+1),be=E+1+v*P;I.push(ie,$,be),I.push($,oe,be)}this.setIndex(I),this.setAttribute("position",new cn(F,3)),this.setAttribute("normal",new cn(B,3)),this.setAttribute("uv",new cn(O,2))}Zc.prototype=Object.create(_n.prototype),Zc.prototype.constructor=Zc;var VC=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,OC=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,GC=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,jC=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,HC=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,WC="vec3 transformed = vec3( position );",qC=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,YC=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,XC=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,KC=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif`,ZC=`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,JC=`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	varying vec3 vViewPosition;
#endif`,QC=`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	vViewPosition = - mvPosition.xyz;
#endif`,$C=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,eR=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,tR=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,nR=`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,iR=`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}`,rR=`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);
    } else if (face == 1.0) {
      uv = vec2(direction.x, -direction.z) / abs(direction.y);
    } else if (face == 2.0) {
      uv = direction.xy / abs(direction.z);
    } else if (face == 3.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);
    } else if (face == 4.0) {
      uv = direction.xz / abs(direction.y);
    } else {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);
    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,oR=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	transformedNormal = mat3( instanceMatrix ) * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,aR=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,sR=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,lR=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,cR=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,uR="gl_FragColor = linearToOutputTexel( gl_FragColor );",hR=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,dR=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,pR=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,fR=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,mR=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,gR=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,yR=`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,xR=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,vR=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_R=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,bR=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,wR=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,AR=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,MR=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif`,SR=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,TR=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,ER=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,PR=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,CR=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,RR=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,DR=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = saturate( clearcoat );	material.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,IR=`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,LR=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,FR=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,kR=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,BR=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,zR=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,UR=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,NR=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,VR=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,OR=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,GR=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,jR=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,HR=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,WR=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,qR=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,YR=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,XR=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,KR=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,ZR=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,JR=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,QR=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,$R=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,eD=`#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,tD=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,nD=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,iD=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,rD=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,oD=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,aD=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,sD=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,lD=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,cD=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,uD=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif`,hD=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}`,dD=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,pD=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,fD=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,mD=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,gD=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,yD=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,xD=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,vD=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,_D=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,bD=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,wD=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,AD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,MD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,SD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,TD=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,ED=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,PD=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,CD=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,RD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,DD=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}`,ID=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}`,LD=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,FD=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,kD=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,BD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,zD=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,UD=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ND=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,VD=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,OD=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GD=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jD=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,HD=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,WD=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qD=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YD=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XD=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KD=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZD=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JD=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,QD=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,$D=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,eI=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,tI=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,nI=`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iI=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,rI=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$n={alphamap_fragment:VC,alphamap_pars_fragment:OC,alphatest_fragment:GC,aomap_fragment:jC,aomap_pars_fragment:HC,begin_vertex:WC,beginnormal_vertex:qC,bsdfs:YC,bumpmap_pars_fragment:XC,clipping_planes_fragment:KC,clipping_planes_pars_fragment:ZC,clipping_planes_pars_vertex:JC,clipping_planes_vertex:QC,color_fragment:$C,color_pars_fragment:eR,color_pars_vertex:tR,color_vertex:nR,common:iR,cube_uv_reflection_fragment:rR,defaultnormal_vertex:oR,displacementmap_pars_vertex:aR,displacementmap_vertex:sR,emissivemap_fragment:lR,emissivemap_pars_fragment:cR,encodings_fragment:uR,encodings_pars_fragment:hR,envmap_fragment:dR,envmap_common_pars_fragment:pR,envmap_pars_fragment:fR,envmap_pars_vertex:mR,envmap_physical_pars_fragment:TR,envmap_vertex:gR,fog_vertex:yR,fog_pars_vertex:xR,fog_fragment:vR,fog_pars_fragment:_R,gradientmap_pars_fragment:bR,lightmap_fragment:wR,lightmap_pars_fragment:AR,lights_lambert_vertex:MR,lights_pars_begin:SR,lights_toon_fragment:ER,lights_toon_pars_fragment:PR,lights_phong_fragment:CR,lights_phong_pars_fragment:RR,lights_physical_fragment:DR,lights_physical_pars_fragment:IR,lights_fragment_begin:LR,lights_fragment_maps:FR,lights_fragment_end:kR,logdepthbuf_fragment:BR,logdepthbuf_pars_fragment:zR,logdepthbuf_pars_vertex:UR,logdepthbuf_vertex:NR,map_fragment:VR,map_pars_fragment:OR,map_particle_fragment:GR,map_particle_pars_fragment:jR,metalnessmap_fragment:HR,metalnessmap_pars_fragment:WR,morphnormal_vertex:qR,morphtarget_pars_vertex:YR,morphtarget_vertex:XR,normal_fragment_begin:KR,normal_fragment_maps:ZR,normalmap_pars_fragment:JR,clearcoat_normal_fragment_begin:QR,clearcoat_normal_fragment_maps:$R,clearcoat_normalmap_pars_fragment:eD,packing:tD,premultiplied_alpha_fragment:nD,project_vertex:iD,dithering_fragment:rD,dithering_pars_fragment:oD,roughnessmap_fragment:aD,roughnessmap_pars_fragment:sD,shadowmap_pars_fragment:lD,shadowmap_pars_vertex:cD,shadowmap_vertex:uD,shadowmask_pars_fragment:hD,skinbase_vertex:dD,skinning_pars_vertex:pD,skinning_vertex:fD,skinnormal_vertex:mD,specularmap_fragment:gD,specularmap_pars_fragment:yD,tonemapping_fragment:xD,tonemapping_pars_fragment:vD,uv_pars_fragment:_D,uv_pars_vertex:bD,uv_vertex:wD,uv2_pars_fragment:AD,uv2_pars_vertex:MD,uv2_vertex:SD,worldpos_vertex:TD,background_frag:ED,background_vert:PD,cube_frag:CD,cube_vert:RD,depth_frag:DD,depth_vert:ID,distanceRGBA_frag:LD,distanceRGBA_vert:FD,equirect_frag:kD,equirect_vert:BD,linedashed_frag:zD,linedashed_vert:UD,meshbasic_frag:ND,meshbasic_vert:VD,meshlambert_frag:OD,meshlambert_vert:GD,meshmatcap_frag:jD,meshmatcap_vert:HD,meshtoon_frag:WD,meshtoon_vert:qD,meshphong_frag:YD,meshphong_vert:XD,meshphysical_frag:KD,meshphysical_vert:ZD,normal_frag:JD,normal_vert:QD,points_frag:$D,points_vert:eI,shadow_frag:tI,shadow_vert:nI,sprite_frag:iI,sprite_vert:rI},Wa={basic:{uniforms:br([an.common,an.specularmap,an.envmap,an.aomap,an.lightmap,an.fog]),vertexShader:$n.meshbasic_vert,fragmentShader:$n.meshbasic_frag},lambert:{uniforms:br([an.common,an.specularmap,an.envmap,an.aomap,an.lightmap,an.emissivemap,an.fog,an.lights,{emissive:{value:new nn(0)}}]),vertexShader:$n.meshlambert_vert,fragmentShader:$n.meshlambert_frag},phong:{uniforms:br([an.common,an.specularmap,an.envmap,an.aomap,an.lightmap,an.emissivemap,an.bumpmap,an.normalmap,an.displacementmap,an.fog,an.lights,{emissive:{value:new nn(0)},specular:{value:new nn(1118481)},shininess:{value:30}}]),vertexShader:$n.meshphong_vert,fragmentShader:$n.meshphong_frag},standard:{uniforms:br([an.common,an.envmap,an.aomap,an.lightmap,an.emissivemap,an.bumpmap,an.normalmap,an.displacementmap,an.roughnessmap,an.metalnessmap,an.fog,an.lights,{emissive:{value:new nn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag},toon:{uniforms:br([an.common,an.specularmap,an.aomap,an.lightmap,an.emissivemap,an.bumpmap,an.normalmap,an.displacementmap,an.gradientmap,an.fog,an.lights,{emissive:{value:new nn(0)},specular:{value:new nn(1118481)},shininess:{value:30}}]),vertexShader:$n.meshtoon_vert,fragmentShader:$n.meshtoon_frag},matcap:{uniforms:br([an.common,an.bumpmap,an.normalmap,an.displacementmap,an.fog,{matcap:{value:null}}]),vertexShader:$n.meshmatcap_vert,fragmentShader:$n.meshmatcap_frag},points:{uniforms:br([an.points,an.fog]),vertexShader:$n.points_vert,fragmentShader:$n.points_frag},dashed:{uniforms:br([an.common,an.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$n.linedashed_vert,fragmentShader:$n.linedashed_frag},depth:{uniforms:br([an.common,an.displacementmap]),vertexShader:$n.depth_vert,fragmentShader:$n.depth_frag},normal:{uniforms:br([an.common,an.bumpmap,an.normalmap,an.displacementmap,{opacity:{value:1}}]),vertexShader:$n.normal_vert,fragmentShader:$n.normal_frag},sprite:{uniforms:br([an.sprite,an.fog]),vertexShader:$n.sprite_vert,fragmentShader:$n.sprite_frag},background:{uniforms:{uvTransform:{value:new vr},t2D:{value:null}},vertexShader:$n.background_vert,fragmentShader:$n.background_frag},cube:{uniforms:br([an.envmap,{opacity:{value:1}}]),vertexShader:$n.cube_vert,fragmentShader:$n.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$n.equirect_vert,fragmentShader:$n.equirect_frag},distanceRGBA:{uniforms:br([an.common,an.displacementmap,{referencePosition:{value:new xe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$n.distanceRGBA_vert,fragmentShader:$n.distanceRGBA_frag},shadow:{uniforms:br([an.lights,an.fog,{color:{value:new nn(0)},opacity:{value:1}}]),vertexShader:$n.shadow_vert,fragmentShader:$n.shadow_frag}};Wa.physical={uniforms:br([Wa.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new nn(0)},clearcoatNormalScale:{value:new Rt(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag};function oI(e,t,i,l){var c=new nn(0),h=0,f,r,v=null,_=0,w=null;function b(P,I,F,B){var O=I.background,W=e.xr,Z=W.getSession&&W.getSession();if(Z&&Z.environmentBlendMode==="additive"&&(O=null),O===null?E(c,h):O&&O.isColor&&(E(O,1),B=!0),(e.autoClear||B)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),O&&(O.isCubeTexture||O.isWebGLCubeRenderTarget||O.mapping===Vh)){r===void 0&&(r=new Fi(new Kf(1,1,1),new Yr({type:"BackgroundCubeMaterial",uniforms:Hc(Wa.cube.uniforms),vertexShader:Wa.cube.vertexShader,fragmentShader:Wa.cube.fragmentShader,side:lr,depthTest:!1,depthWrite:!1,fog:!1})),r.geometry.deleteAttribute("normal"),r.geometry.deleteAttribute("uv"),r.onBeforeRender=function($,oe,be){this.matrixWorld.copyPosition(be.matrixWorld)},Object.defineProperty(r.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(r));var ie=O.isWebGLCubeRenderTarget?O.texture:O;r.material.uniforms.envMap.value=ie,r.material.uniforms.flipEnvMap.value=ie.isCubeTexture?-1:1,(v!==O||_!==ie.version||w!==e.toneMapping)&&(r.material.needsUpdate=!0,v=O,_=ie.version,w=e.toneMapping),P.unshift(r,r.geometry,r.material,0,0,null)}else O&&O.isTexture&&(f===void 0&&(f=new Fi(new Zc(2,2),new Yr({type:"BackgroundMaterial",uniforms:Hc(Wa.background.uniforms),vertexShader:Wa.background.vertexShader,fragmentShader:Wa.background.fragmentShader,side:wc,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(f)),f.material.uniforms.t2D.value=O,O.matrixAutoUpdate===!0&&O.updateMatrix(),f.material.uniforms.uvTransform.value.copy(O.matrix),(v!==O||_!==O.version||w!==e.toneMapping)&&(f.material.needsUpdate=!0,v=O,_=O.version,w=e.toneMapping),P.unshift(f,f.geometry,f.material,0,0,null))}function E(P,I){t.buffers.color.setClear(P.r,P.g,P.b,I,l)}return{getClearColor:function(){return c},setClearColor:function(P,I){c.set(P),h=I!==void 0?I:1,E(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(P){h=P,E(c,h)},render:b}}function aI(e,t,i,l){var c=l.isWebGL2,h;function f(_){h=_}function r(_,w){e.drawArrays(h,_,w),i.update(w,h)}function v(_,w,b,E){if(E!==0){var P,I;if(c)P=e,I="drawArraysInstanced";else if(P=t.get("ANGLE_instanced_arrays"),I="drawArraysInstancedANGLE",P===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}P[I](h,w,b,E),i.update(b,h,E)}}this.setMode=f,this.render=r,this.renderInstances=v}function sI(e,t,i){var l;function c(){if(l!==void 0)return l;var oe=t.get("EXT_texture_filter_anisotropic");return oe!==null?l=e.getParameter(oe.MAX_TEXTURE_MAX_ANISOTROPY_EXT):l=0,l}function h(oe){if(oe==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";oe="mediump"}return oe==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var f=typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&e instanceof WebGL2ComputeRenderingContext,r=i.precision!==void 0?i.precision:"highp",v=h(r);v!==r&&(console.warn("THREE.WebGLRenderer:",r,"not supported, using",v,"instead."),r=v);var _=i.logarithmicDepthBuffer===!0,w=e.getParameter(34930),b=e.getParameter(35660),E=e.getParameter(3379),P=e.getParameter(34076),I=e.getParameter(34921),F=e.getParameter(36347),B=e.getParameter(36348),O=e.getParameter(36349),W=b>0,Z=f||!!t.get("OES_texture_float"),ie=W&&Z,$=f?e.getParameter(36183):0;return{isWebGL2:f,getMaxAnisotropy:c,getMaxPrecision:h,precision:r,logarithmicDepthBuffer:_,maxTextures:w,maxVertexTextures:b,maxTextureSize:E,maxCubemapSize:P,maxAttributes:I,maxVertexUniforms:F,maxVaryings:B,maxFragmentUniforms:O,vertexTextures:W,floatFragmentTextures:Z,floatVertexTextures:ie,maxSamples:$}}function lI(){var e=this,t=null,i=0,l=!1,c=!1,h=new oa,f=new vr,r={value:null,needsUpdate:!1};this.uniform=r,this.numPlanes=0,this.numIntersection=0,this.init=function(w,b,E){var P=w.length!==0||b||i!==0||l;return l=b,t=_(w,E,0),i=w.length,P},this.beginShadows=function(){c=!0,_(null)},this.endShadows=function(){c=!1,v()},this.setState=function(w,b,E,P,I,F){if(!l||w===null||w.length===0||c&&!E)c?_(null):v();else{var B=c?0:i,O=B*4,W=I.clippingState||null;r.value=W,W=_(w,P,O,F);for(var Z=0;Z!==O;++Z)W[Z]=t[Z];I.clippingState=W,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=B}};function v(){r.value!==t&&(r.value=t,r.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function _(w,b,E,P){var I=w!==null?w.length:0,F=null;if(I!==0){if(F=r.value,P!==!0||F===null){var B=E+I*4,O=b.matrixWorldInverse;f.getNormalMatrix(O),(F===null||F.length<B)&&(F=new Float32Array(B));for(var W=0,Z=E;W!==I;++W,Z+=4)h.copy(w[W]).applyMatrix4(O,f),h.normal.toArray(F,Z),F[Z+3]=h.constant}r.value=F,r.needsUpdate=!0}return e.numPlanes=I,F}}function cI(e){var t={};return{get:function(i){if(t[i]!==void 0)return t[i];var l;switch(i){case"WEBGL_depth_texture":l=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":l=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":l=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":l=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:l=e.getExtension(i)}return l===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=l,l}}}function uI(e,t,i){var l=new WeakMap,c=new WeakMap;function h(w){var b=w.target,E=l.get(b);E.index!==null&&t.remove(E.index);for(var P in E.attributes)t.remove(E.attributes[P]);b.removeEventListener("dispose",h),l.delete(b);var I=c.get(E);I&&(t.remove(I),c.delete(E)),i.memory.geometries--}function f(w,b){var E=l.get(b);return E||(b.addEventListener("dispose",h),b.isBufferGeometry?E=b:b.isGeometry&&(b._bufferGeometry===void 0&&(b._bufferGeometry=new _n().setFromObject(w)),E=b._bufferGeometry),l.set(b,E),i.memory.geometries++,E)}function r(w){var b=w.index,E=w.attributes;b!==null&&t.update(b,34963);for(var P in E)t.update(E[P],34962);var I=w.morphAttributes;for(var P in I)for(var F=I[P],B=0,O=F.length;B<O;B++)t.update(F[B],34962)}function v(w){var b=[],E=w.index,P=w.attributes.position,I=0;if(E!==null){var F=E.array;I=E.version;for(var B=0,O=F.length;B<O;B+=3){var W=F[B+0],Z=F[B+1],ie=F[B+2];b.push(W,Z,Z,ie,ie,W)}}else{var F=P.array;I=P.version;for(var B=0,O=F.length/3-1;B<O;B+=3){var W=B+0,Z=B+1,ie=B+2;b.push(W,Z,Z,ie,ie,W)}}var $=new(ib(b)>65535?Qh:Jh)(b,1);$.version=I,t.update($,34963);var oe=c.get(w);oe&&t.remove(oe),c.set(w,$)}function _(w){var b=c.get(w);if(b){var E=w.index;E!==null&&b.version<E.version&&v(w)}else v(w);return c.get(w)}return{get:f,update:r,getWireframeAttribute:_}}function hI(e,t,i,l){var c=l.isWebGL2,h;function f(E){h=E}var r,v;function _(E){r=E.type,v=E.bytesPerElement}function w(E,P){e.drawElements(h,P,r,E*v),i.update(P,h)}function b(E,P,I,F){if(F!==0){var B,O;if(c)B=e,O="drawElementsInstanced";else if(B=t.get("ANGLE_instanced_arrays"),O="drawElementsInstancedANGLE",B===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}B[O](h,I,r,P*v,F),i.update(I,h,F)}}this.setMode=f,this.setIndex=_,this.render=w,this.renderInstances=b}function dI(e){var t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function l(h,f,r){switch(r=r||1,i.calls++,f){case 4:i.triangles+=r*(h/3);break;case 1:i.lines+=r*(h/2);break;case 3:i.lines+=r*(h-1);break;case 2:i.lines+=r*h;break;case 0:i.points+=r*h;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",f);break}}function c(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:c,update:l}}function pI(e,t){return Math.abs(t[1])-Math.abs(e[1])}function fI(e){var t={},i=new Float32Array(8);function l(c,h,f,r){var v=c.morphTargetInfluences,_=v===void 0?0:v.length,w=t[h.id];if(w===void 0){w=[];for(var b=0;b<_;b++)w[b]=[b,0];t[h.id]=w}for(var E=f.morphTargets&&h.morphAttributes.position,P=f.morphNormals&&h.morphAttributes.normal,b=0;b<_;b++){var I=w[b];I[1]!==0&&(E&&h.deleteAttribute("morphTarget"+b),P&&h.deleteAttribute("morphNormal"+b))}for(var b=0;b<_;b++){var I=w[b];I[0]=b,I[1]=v[b]}w.sort(pI);for(var F=0,b=0;b<8;b++){var I=w[b];if(I){var B=I[0],O=I[1];if(O){E&&h.setAttribute("morphTarget"+b,E[B]),P&&h.setAttribute("morphNormal"+b,P[B]),i[b]=O,F+=O;continue}}i[b]=0}var W=h.morphTargetsRelative?1:1-F;r.getUniforms().setValue(e,"morphTargetBaseInfluence",W),r.getUniforms().setValue(e,"morphTargetInfluences",i)}return{update:l}}function mI(e,t,i,l){var c={};function h(r){var v=l.render.frame,_=r.geometry,w=t.get(r,_);return c[w.id]!==v&&(_.isGeometry&&w.updateFromObject(r),t.update(w),c[w.id]=v),r.isInstancedMesh&&i.update(r.instanceMatrix,34962),w}function f(){c={}}return{update:h,dispose:f}}function bs(e,t,i,l,c,h,f,r,v,_){e=e!==void 0?e:[],t=t!==void 0?t:Qy,f=f!==void 0?f:ka,bi.call(this,e,t,i,l,c,h,f,r,v,_),this.flipY=!1}bs.prototype=Object.create(bi.prototype),bs.prototype.constructor=bs,bs.prototype.isCubeTexture=!0,Object.defineProperty(bs.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function id(e,t,i,l){bi.call(this,null),this.image={data:e||null,width:t||1,height:i||1,depth:l||1},this.magFilter=Yi,this.minFilter=Yi,this.wrapR=Rr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}id.prototype=Object.create(bi.prototype),id.prototype.constructor=id,id.prototype.isDataTexture2DArray=!0;function rd(e,t,i,l){bi.call(this,null),this.image={data:e||null,width:t||1,height:i||1,depth:l||1},this.magFilter=Yi,this.minFilter=Yi,this.wrapR=Rr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}rd.prototype=Object.create(bi.prototype),rd.prototype.constructor=rd,rd.prototype.isDataTexture3D=!0;var sb=new bi,gI=new id,yI=new rd,lb=new bs,cb=[],ub=[],hb=new Float32Array(16),db=new Float32Array(9),pb=new Float32Array(4);function Jc(e,t,i){var l=e[0];if(l<=0||l>0)return e;var c=t*i,h=cb[c];if(h===void 0&&(h=new Float32Array(c),cb[c]=h),t!==0){l.toArray(h,0);for(var f=1,r=0;f!==t;++f)r+=i,e[f].toArray(h,r)}return h}function Eo(e,t){if(e.length!==t.length)return!1;for(var i=0,l=e.length;i<l;i++)if(e[i]!==t[i])return!1;return!0}function po(e,t){for(var i=0,l=t.length;i<l;i++)e[i]=t[i]}function fb(e,t){var i=ub[t];i===void 0&&(i=new Int32Array(t),ub[t]=i);for(var l=0;l!==t;++l)i[l]=e.allocateTextureUnit();return i}function xI(e,t){var i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function vI(e,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Eo(i,t))return;e.uniform2fv(this.addr,t),po(i,t)}}function _I(e,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Eo(i,t))return;e.uniform3fv(this.addr,t),po(i,t)}}function bI(e,t){var i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Eo(i,t))return;e.uniform4fv(this.addr,t),po(i,t)}}function wI(e,t){var i=this.cache,l=t.elements;if(l===void 0){if(Eo(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),po(i,t)}else{if(Eo(i,l))return;pb.set(l),e.uniformMatrix2fv(this.addr,!1,pb),po(i,l)}}function AI(e,t){var i=this.cache,l=t.elements;if(l===void 0){if(Eo(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),po(i,t)}else{if(Eo(i,l))return;db.set(l),e.uniformMatrix3fv(this.addr,!1,db),po(i,l)}}function MI(e,t){var i=this.cache,l=t.elements;if(l===void 0){if(Eo(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),po(i,t)}else{if(Eo(i,l))return;hb.set(l),e.uniformMatrix4fv(this.addr,!1,hb),po(i,l)}}function SI(e,t,i){var l=this.cache,c=i.allocateTextureUnit();l[0]!==c&&(e.uniform1i(this.addr,c),l[0]=c),i.safeSetTexture2D(t||sb,c)}function TI(e,t,i){var l=this.cache,c=i.allocateTextureUnit();l[0]!==c&&(e.uniform1i(this.addr,c),l[0]=c),i.setTexture2DArray(t||gI,c)}function EI(e,t,i){var l=this.cache,c=i.allocateTextureUnit();l[0]!==c&&(e.uniform1i(this.addr,c),l[0]=c),i.setTexture3D(t||yI,c)}function PI(e,t,i){var l=this.cache,c=i.allocateTextureUnit();l[0]!==c&&(e.uniform1i(this.addr,c),l[0]=c),i.safeSetTextureCube(t||lb,c)}function CI(e,t){var i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function RI(e,t){var i=this.cache;Eo(i,t)||(e.uniform2iv(this.addr,t),po(i,t))}function DI(e,t){var i=this.cache;Eo(i,t)||(e.uniform3iv(this.addr,t),po(i,t))}function II(e,t){var i=this.cache;Eo(i,t)||(e.uniform4iv(this.addr,t),po(i,t))}function LI(e,t){var i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function FI(e){switch(e){case 5126:return xI;case 35664:return vI;case 35665:return _I;case 35666:return bI;case 35674:return wI;case 35675:return AI;case 35676:return MI;case 5124:case 35670:return CI;case 35667:case 35671:return RI;case 35668:case 35672:return DI;case 35669:case 35673:return II;case 5125:return LI;case 35678:case 36198:case 36298:case 36306:case 35682:return SI;case 35679:case 36299:case 36307:return EI;case 35680:case 36300:case 36308:case 36293:return PI;case 36289:case 36303:case 36311:case 36292:return TI}}function kI(e,t){e.uniform1fv(this.addr,t)}function BI(e,t){e.uniform1iv(this.addr,t)}function zI(e,t){e.uniform2iv(this.addr,t)}function UI(e,t){e.uniform3iv(this.addr,t)}function NI(e,t){e.uniform4iv(this.addr,t)}function VI(e,t){var i=Jc(t,this.size,2);e.uniform2fv(this.addr,i)}function OI(e,t){var i=Jc(t,this.size,3);e.uniform3fv(this.addr,i)}function GI(e,t){var i=Jc(t,this.size,4);e.uniform4fv(this.addr,i)}function jI(e,t){var i=Jc(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function HI(e,t){var i=Jc(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function WI(e,t){var i=Jc(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function qI(e,t,i){var l=t.length,c=fb(i,l);e.uniform1iv(this.addr,c);for(var h=0;h!==l;++h)i.safeSetTexture2D(t[h]||sb,c[h])}function YI(e,t,i){var l=t.length,c=fb(i,l);e.uniform1iv(this.addr,c);for(var h=0;h!==l;++h)i.safeSetTextureCube(t[h]||lb,c[h])}function XI(e){switch(e){case 5126:return kI;case 35664:return VI;case 35665:return OI;case 35666:return GI;case 35674:return jI;case 35675:return HI;case 35676:return WI;case 5124:case 35670:return BI;case 35667:case 35671:return zI;case 35668:case 35672:return UI;case 35669:case 35673:return NI;case 35678:case 36198:case 36298:case 36306:case 35682:return qI;case 35680:case 36300:case 36308:case 36293:return YI}}function KI(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=FI(t.type)}function mb(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=XI(t.type)}mb.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),po(t,e)};function gb(e){this.id=e,this.seq=[],this.map={}}gb.prototype.setValue=function(e,t,i){for(var l=this.seq,c=0,h=l.length;c!==h;++c){var f=l[c];f.setValue(e,t[f.id],i)}};var I0=/([\w\d_]+)(\])?(\[|\.)?/g;function yb(e,t){e.seq.push(t),e.map[t.id]=t}function ZI(e,t,i){var l=e.name,c=l.length;for(I0.lastIndex=0;;){var h=I0.exec(l),f=I0.lastIndex,r=h[1],v=h[2]==="]",_=h[3];if(v&&(r=r|0),_===void 0||_==="["&&f+2===c){yb(i,_===void 0?new KI(r,e,t):new mb(r,e,t));break}else{var w=i.map,b=w[r];b===void 0&&(b=new gb(r),yb(i,b)),i=b}}}function ws(e,t){this.seq=[],this.map={};for(var i=e.getProgramParameter(t,35718),l=0;l<i;++l){var c=e.getActiveUniform(t,l),h=e.getUniformLocation(t,c.name);ZI(c,h,this)}}ws.prototype.setValue=function(e,t,i,l){var c=this.map[t];c!==void 0&&c.setValue(e,i,l)},ws.prototype.setOptional=function(e,t,i){var l=t[i];l!==void 0&&this.setValue(e,i,l)},ws.upload=function(e,t,i,l){for(var c=0,h=t.length;c!==h;++c){var f=t[c],r=i[f.id];r.needsUpdate!==!1&&f.setValue(e,r.value,l)}},ws.seqWithValue=function(e,t){for(var i=[],l=0,c=e.length;l!==c;++l){var h=e[l];h.id in t&&i.push(h)}return i};function xb(e,t,i){var l=e.createShader(t);return e.shaderSource(l,i),e.compileShader(l),l}var JI=0;function QI(e){for(var t=e.split(`
`),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function vb(e){switch(e){case co:return["Linear","( value )"];case Wh:return["sRGB","( value )"];case o0:return["RGBE","( value )"];case G1:return["RGBM","( value, 7.0 )"];case j1:return["RGBM","( value, 16.0 )"];case H1:return["RGBD","( value, 256.0 )"];case O1:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case gC:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function _b(e,t,i){var l=e.getShaderParameter(t,35713),c=e.getShaderInfoLog(t).trim();if(l&&c==="")return"";var h=e.getShaderSource(t);return"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+c+QI(h)}function od(e,t){var i=vb(t);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function $I(e,t){var i=vb(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function eL(e,t){var i;switch(t){case Zy:i="Linear";break;case RP:i="Reinhard";break;case DP:i="Uncharted2";break;case IP:i="OptimizedCineon";break;case LP:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function tL(e){var t=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return t.filter(ad).join(`
`)}function nL(e){var t=[];for(var i in e){var l=e[i];l!==!1&&t.push("#define "+i+" "+l)}return t.join(`
`)}function iL(e,t){for(var i={},l=e.getProgramParameter(t,35721),c=0;c<l;c++){var h=e.getActiveAttrib(t,c),f=h.name;i[f]=e.getAttribLocation(t,f)}return i}function ad(e){return e!==""}function bb(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function wb(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var rL=/^[ \t]*#include +<([\w\d./]+)>/gm;function L0(e){return e.replace(rL,oL)}function oL(e,t){var i=$n[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return L0(i)}var aL=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Ab(e){return e.replace(aL,sL)}function sL(e,t,i,l){for(var c="",h=parseInt(t);h<parseInt(i);h++)c+=l.replace(/\[ i \]/g,"[ "+h+" ]").replace(/UNROLLED_LOOP_INDEX/g,h);return c}function Mb(e){var t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function lL(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===v1?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===sP?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===zh&&(t="SHADOWMAP_TYPE_VSM"),t}function cL(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Qy:case $y:t="ENVMAP_TYPE_CUBE";break;case Vh:case t0:t="ENVMAP_TYPE_CUBE_UV";break;case C1:case e0:t="ENVMAP_TYPE_EQUIREC";break;case R1:t="ENVMAP_TYPE_SPHERE";break}return t}function uL(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case $y:case e0:t="ENVMAP_MODE_REFRACTION";break}return t}function hL(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Sf:t="ENVMAP_BLENDING_MULTIPLY";break;case PP:t="ENVMAP_BLENDING_MIX";break;case CP:t="ENVMAP_BLENDING_ADD";break}return t}function dL(e,t,i){var l=e.getContext(),c=i.defines,h=i.vertexShader,f=i.fragmentShader,r=lL(i),v=cL(i),_=uL(i),w=hL(i),b=e.gammaFactor>0?e.gammaFactor:1,E=i.isWebGL2?"":tL(i),P=nL(c),I=l.createProgram(),F,B,O=i.numMultiviewViews;if(i.isRawShaderMaterial?(F=[P].filter(ad).join(`
`),F.length>0&&(F+=`
`),B=[E,P].filter(ad).join(`
`),B.length>0&&(B+=`
`)):(F=[Mb(i),"#define SHADER_NAME "+i.shaderName,P,i.instancing?"#define USE_INSTANCING":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+_:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+r:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ad).join(`
`),B=[E,Mb(i),"#define SHADER_NAME "+i.shaderName,P,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+v:"",i.envMap?"#define "+_:"",i.envMap?"#define "+w:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+r:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Tf?"#define TONE_MAPPING":"",i.toneMapping!==Tf?$n.tonemapping_pars_fragment:"",i.toneMapping!==Tf?eL("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.matcapEncoding||i.envMapEncoding||i.emissiveMapEncoding||i.lightMapEncoding?$n.encodings_pars_fragment:"",i.mapEncoding?od("mapTexelToLinear",i.mapEncoding):"",i.matcapEncoding?od("matcapTexelToLinear",i.matcapEncoding):"",i.envMapEncoding?od("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?od("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMapEncoding?od("lightMapTexelToLinear",i.lightMapEncoding):"",i.outputEncoding?$I("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(ad).join(`
`)),h=L0(h),h=bb(h,i),h=wb(h,i),f=L0(f),f=bb(f,i),f=wb(f,i),h=Ab(h),f=Ab(f),i.isWebGL2&&!i.isRawShaderMaterial){var W=!1,Z=/^\s*#version\s+300\s+es\s*\n/;i.isShaderMaterial&&h.match(Z)!==null&&f.match(Z)!==null&&(W=!0,h=h.replace(Z,""),f=f.replace(Z,"")),F=[`#version 300 es
`,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+F,B=[`#version 300 es
`,"#define varying in",W?"":"out highp vec4 pc_fragColor;",W?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+B,O>0&&(F=F.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","layout(num_views = "+O+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),F=F.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+O+"];","uniform mat4 projectionMatrices["+O+"];","uniform mat4 viewMatrices["+O+"];","uniform mat3 normalMatrices["+O+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),B=B.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),B=B.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+O+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`)))}var ie=F+h,$=B+f,oe=xb(l,35633,ie),be=xb(l,35632,$);if(l.attachShader(I,oe),l.attachShader(I,be),i.index0AttributeName!==void 0?l.bindAttribLocation(I,0,i.index0AttributeName):i.morphTargets===!0&&l.bindAttribLocation(I,0,"position"),l.linkProgram(I),e.debug.checkShaderErrors){var fe=l.getProgramInfoLog(I).trim(),Le=l.getShaderInfoLog(oe).trim(),Xe=l.getShaderInfoLog(be).trim(),Ne=!0,Re=!0;if(l.getProgramParameter(I,35714)===!1){Ne=!1;var Ie=_b(l,oe,"vertex"),He=_b(l,be,"fragment");console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(I,35715),"gl.getProgramInfoLog",fe,Ie,He)}else fe!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",fe):(Le===""||Xe==="")&&(Re=!1);Re&&(this.diagnostics={runnable:Ne,programLog:fe,vertexShader:{log:Le,prefix:F},fragmentShader:{log:Xe,prefix:B}})}l.deleteShader(oe),l.deleteShader(be);var Ue;this.getUniforms=function(){return Ue===void 0&&(Ue=new ws(l,I)),Ue};var ot;return this.getAttributes=function(){return ot===void 0&&(ot=iL(l,I)),ot},this.destroy=function(){l.deleteProgram(I),this.program=void 0},this.name=i.shaderName,this.id=JI++,this.cacheKey=t,this.usedTimes=1,this.program=I,this.vertexShader=oe,this.fragmentShader=be,this.numMultiviewViews=O,this}function pL(e,t,i){var l=[],c=i.isWebGL2,h=i.logarithmicDepthBuffer,f=i.floatVertexTextures,r=i.precision,v=i.maxVertexUniforms,_=i.vertexTextures,w={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},b=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function E(F,B){var O;if(B){var W=Wa[B];O={name:F.type,uniforms:BC.clone(W.uniforms),vertexShader:W.vertexShader,fragmentShader:W.fragmentShader}}else O={name:F.type,uniforms:F.uniforms,vertexShader:F.vertexShader,fragmentShader:F.fragmentShader};return O}function P(F){var B=F.skeleton,O=B.bones;if(f)return 1024;var W=v,Z=Math.floor((W-20)/4),ie=Math.min(Z,O.length);return ie<O.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+O.length+" bones. This GPU supports "+ie+"."),0):ie}function I(F){var B;return F?F.isTexture?B=F.encoding:F.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),B=F.texture.encoding):B=co,B}this.getParameters=function(F,B,O,W,Z,ie,$){var oe=W.fog,be=F.isMeshStandardMaterial?W.environment:null,fe=F.envMap||be,Le=w[F.type],Xe=$.isSkinnedMesh?P($):0;F.precision!==null&&(r=i.getMaxPrecision(F.precision),r!==F.precision&&console.warn("THREE.WebGLProgram.getParameters:",F.precision,"not supported, using",r,"instead."));var Ne=E(F,Le);F.onBeforeCompile(Ne,e);var Re=e.getRenderTarget(),Ie=Re&&Re.isWebGLMultiviewRenderTarget?Re.numViews:0,He={isWebGL2:c,shaderID:Le,shaderName:Ne.name,uniforms:Ne.uniforms,vertexShader:Ne.vertexShader,fragmentShader:Ne.fragmentShader,defines:F.defines,isRawShaderMaterial:F.isRawShaderMaterial,isShaderMaterial:F.isShaderMaterial,precision:r,instancing:$.isInstancedMesh===!0,supportsVertexTextures:_,numMultiviewViews:Ie,outputEncoding:Re!==null?I(Re.texture):e.outputEncoding,map:!!F.map,mapEncoding:I(F.map),matcap:!!F.matcap,matcapEncoding:I(F.matcap),envMap:!!fe,envMapMode:fe&&fe.mapping,envMapEncoding:I(fe),envMapCubeUV:!!fe&&(fe.mapping===Vh||fe.mapping===t0),lightMap:!!F.lightMap,lightMapEncoding:I(F.lightMap),aoMap:!!F.aoMap,emissiveMap:!!F.emissiveMap,emissiveMapEncoding:I(F.emissiveMap),bumpMap:!!F.bumpMap,normalMap:!!F.normalMap,objectSpaceNormalMap:F.normalMapType===vC,tangentSpaceNormalMap:F.normalMapType===pl,clearcoatNormalMap:!!F.clearcoatNormalMap,displacementMap:!!F.displacementMap,roughnessMap:!!F.roughnessMap,metalnessMap:!!F.metalnessMap,specularMap:!!F.specularMap,alphaMap:!!F.alphaMap,gradientMap:!!F.gradientMap,sheen:!!F.sheen,combine:F.combine,vertexTangents:F.normalMap&&F.vertexTangents,vertexColors:F.vertexColors,vertexUvs:!!F.map||!!F.bumpMap||!!F.normalMap||!!F.specularMap||!!F.alphaMap||!!F.emissiveMap||!!F.roughnessMap||!!F.metalnessMap||!!F.clearcoatNormalMap||!!F.displacementMap,uvsVertexOnly:!(F.map||F.bumpMap||F.normalMap||F.specularMap||F.alphaMap||F.emissiveMap||F.roughnessMap||F.metalnessMap||F.clearcoatNormalMap)&&!!F.displacementMap,fog:!!oe,useFog:F.fog,fogExp2:oe&&oe.isFogExp2,flatShading:F.flatShading,sizeAttenuation:F.sizeAttenuation,logarithmicDepthBuffer:h,skinning:F.skinning&&Xe>0,maxBones:Xe,useVertexTexture:f,morphTargets:F.morphTargets,morphNormals:F.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numClippingPlanes:Z,numClipIntersection:ie,dithering:F.dithering,shadowMapEnabled:e.shadowMap.enabled&&O.length>0,shadowMapType:e.shadowMap.type,toneMapping:F.toneMapped?e.toneMapping:Tf,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:F.premultipliedAlpha,alphaTest:F.alphaTest,doubleSided:F.side===Uh,flipSided:F.side===lr,depthPacking:F.depthPacking!==void 0?F.depthPacking:!1,index0AttributeName:F.index0AttributeName,extensionDerivatives:F.extensions&&F.extensions.derivatives,extensionFragDepth:F.extensions&&F.extensions.frawbuffers,extensionDrawbuffers:F.extensions&&F.extensions.drawbuffers,extensionShaderTextureLOD:F.extensions&&F.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||t.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:c||t.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:c||t.get("EXT_shader_texture_lod")!==null,onBeforeCompile:F.onBeforeCompile};return He},this.getProgramCacheKey=function(F){var B=[];if(F.shaderID?B.push(F.shaderID):(B.push(F.fragmentShader),B.push(F.vertexShader)),F.defines!==void 0)for(var O in F.defines)B.push(O),B.push(F.defines[O]);if(F.isRawShaderMaterial===void 0){for(var W=0;W<b.length;W++)B.push(F[b[W]]);B.push(e.outputEncoding),B.push(e.gammaFactor)}return B.push(F.onBeforeCompile.toString()),B.join()},this.acquireProgram=function(F,B){for(var O,W=0,Z=l.length;W<Z;W++){var ie=l[W];if(ie.cacheKey===B){O=ie,++O.usedTimes;break}}return O===void 0&&(O=new dL(e,B,F),l.push(O)),O},this.releaseProgram=function(F){if(--F.usedTimes===0){var B=l.indexOf(F);l[B]=l[l.length-1],l.pop(),F.destroy()}},this.programs=l}function fL(){var e=new WeakMap;function t(h){var f=e.get(h);return f===void 0&&(f={},e.set(h,f)),f}function i(h){e.delete(h)}function l(h,f,r){e.get(h)[f]=r}function c(){e=new WeakMap}return{get:t,remove:i,update:l,dispose:c}}function mL(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function gL(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Sb(){var e=[],t=0,i=[],l=[],c={id:-1};function h(){t=0,i.length=0,l.length=0}function f(w,b,E,P,I,F){var B=e[t];return B===void 0?(B={id:w.id,object:w,geometry:b,material:E,program:E.program||c,groupOrder:P,renderOrder:w.renderOrder,z:I,group:F},e[t]=B):(B.id=w.id,B.object=w,B.geometry=b,B.material=E,B.program=E.program||c,B.groupOrder=P,B.renderOrder=w.renderOrder,B.z=I,B.group=F),t++,B}function r(w,b,E,P,I,F){var B=f(w,b,E,P,I,F);(E.transparent===!0?l:i).push(B)}function v(w,b,E,P,I,F){var B=f(w,b,E,P,I,F);(E.transparent===!0?l:i).unshift(B)}function _(w,b){i.length>1&&i.sort(w||mL),l.length>1&&l.sort(b||gL)}return{opaque:i,transparent:l,init:h,push:r,unshift:v,sort:_}}function yL(){var e=new WeakMap;function t(c){var h=c.target;h.removeEventListener("dispose",t),e.delete(h)}function i(c,h){var f=e.get(c),r;return f===void 0?(r=new Sb,e.set(c,new WeakMap),e.get(c).set(h,r),c.addEventListener("dispose",t)):(r=f.get(h),r===void 0&&(r=new Sb,f.set(h,r))),r}function l(){e=new WeakMap}return{get:i,dispose:l}}function xL(){var e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new xe,color:new nn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"SpotLight":i={position:new xe,direction:new xe,color:new nn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"PointLight":i={position:new xe,color:new nn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Rt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":i={direction:new xe,skyColor:new nn,groundColor:new nn};break;case"RectAreaLight":i={color:new nn,position:new xe,halfWidth:new xe,halfHeight:new xe};break}return e[t.id]=i,i}}}var vL=0;function _L(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function bL(){for(var e=new xL,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},i=0;i<9;i++)t.probe.push(new xe);var l=new xe,c=new Kn,h=new Kn;function f(r,v,_){for(var w=0,b=0,E=0,P=0;P<9;P++)t.probe[P].set(0,0,0);var I=0,F=0,B=0,O=0,W=0,Z=0,ie=0,$=0,oe=_.matrixWorldInverse;r.sort(_L);for(var P=0,be=r.length;P<be;P++){var fe=r[P],Le=fe.color,Xe=fe.intensity,Ne=fe.distance,Re=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)w+=Le.r*Xe,b+=Le.g*Xe,E+=Le.b*Xe;else if(fe.isLightProbe)for(var Ie=0;Ie<9;Ie++)t.probe[Ie].addScaledVector(fe.sh.coefficients[Ie],Xe);else if(fe.isDirectionalLight){var He=e.get(fe);if(He.color.copy(fe.color).multiplyScalar(fe.intensity),He.direction.setFromMatrixPosition(fe.matrixWorld),l.setFromMatrixPosition(fe.target.matrixWorld),He.direction.sub(l),He.direction.transformDirection(oe),He.shadow=fe.castShadow,fe.castShadow){var Ue=fe.shadow;He.shadowBias=Ue.bias,He.shadowRadius=Ue.radius,He.shadowMapSize=Ue.mapSize,t.directionalShadowMap[I]=Re,t.directionalShadowMatrix[I]=fe.shadow.matrix,Z++}t.directional[I]=He,I++}else if(fe.isSpotLight){var He=e.get(fe);if(He.position.setFromMatrixPosition(fe.matrixWorld),He.position.applyMatrix4(oe),He.color.copy(Le).multiplyScalar(Xe),He.distance=Ne,He.direction.setFromMatrixPosition(fe.matrixWorld),l.setFromMatrixPosition(fe.target.matrixWorld),He.direction.sub(l),He.direction.transformDirection(oe),He.coneCos=Math.cos(fe.angle),He.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),He.decay=fe.decay,He.shadow=fe.castShadow,fe.castShadow){var Ue=fe.shadow;He.shadowBias=Ue.bias,He.shadowRadius=Ue.radius,He.shadowMapSize=Ue.mapSize,t.spotShadowMap[B]=Re,t.spotShadowMatrix[B]=fe.shadow.matrix,$++}t.spot[B]=He,B++}else if(fe.isRectAreaLight){var He=e.get(fe);He.color.copy(Le).multiplyScalar(Xe),He.position.setFromMatrixPosition(fe.matrixWorld),He.position.applyMatrix4(oe),h.identity(),c.copy(fe.matrixWorld),c.premultiply(oe),h.extractRotation(c),He.halfWidth.set(fe.width*.5,0,0),He.halfHeight.set(0,fe.height*.5,0),He.halfWidth.applyMatrix4(h),He.halfHeight.applyMatrix4(h),t.rectArea[O]=He,O++}else if(fe.isPointLight){var He=e.get(fe);if(He.position.setFromMatrixPosition(fe.matrixWorld),He.position.applyMatrix4(oe),He.color.copy(fe.color).multiplyScalar(fe.intensity),He.distance=fe.distance,He.decay=fe.decay,He.shadow=fe.castShadow,fe.castShadow){var Ue=fe.shadow;He.shadowBias=Ue.bias,He.shadowRadius=Ue.radius,He.shadowMapSize=Ue.mapSize,He.shadowCameraNear=Ue.camera.near,He.shadowCameraFar=Ue.camera.far,t.pointShadowMap[F]=Re,t.pointShadowMatrix[F]=fe.shadow.matrix,ie++}t.point[F]=He,F++}else if(fe.isHemisphereLight){var He=e.get(fe);He.direction.setFromMatrixPosition(fe.matrixWorld),He.direction.transformDirection(oe),He.direction.normalize(),He.skyColor.copy(fe.color).multiplyScalar(Xe),He.groundColor.copy(fe.groundColor).multiplyScalar(Xe),t.hemi[W]=He,W++}}t.ambient[0]=w,t.ambient[1]=b,t.ambient[2]=E;var ot=t.hash;(ot.directionalLength!==I||ot.pointLength!==F||ot.spotLength!==B||ot.rectAreaLength!==O||ot.hemiLength!==W||ot.numDirectionalShadows!==Z||ot.numPointShadows!==ie||ot.numSpotShadows!==$)&&(t.directional.length=I,t.spot.length=B,t.rectArea.length=O,t.point.length=F,t.hemi.length=W,t.directionalShadowMap.length=Z,t.pointShadowMap.length=ie,t.spotShadowMap.length=$,t.directionalShadowMatrix.length=Z,t.pointShadowMatrix.length=ie,t.spotShadowMatrix.length=$,ot.directionalLength=I,ot.pointLength=F,ot.spotLength=B,ot.rectAreaLength=O,ot.hemiLength=W,ot.numDirectionalShadows=Z,ot.numPointShadows=ie,ot.numSpotShadows=$,t.version=vL++)}return{setup:f,state:t}}function Tb(){var e=new bL,t=[],i=[];function l(){t.length=0,i.length=0}function c(v){t.push(v)}function h(v){i.push(v)}function f(v){e.setup(t,i,v)}var r={lightsArray:t,shadowsArray:i,lights:e};return{init:l,state:r,setupLights:f,pushLight:c,pushShadow:h}}function wL(){var e=new WeakMap;function t(c){var h=c.target;h.removeEventListener("dispose",t),e.delete(h)}function i(c,h){var f;return e.has(c)===!1?(f=new Tb,e.set(c,new WeakMap),e.get(c).set(h,f),c.addEventListener("dispose",t)):e.get(c).has(h)===!1?(f=new Tb,e.get(c).set(h,f)):f=e.get(c).get(h),f}function l(){e=new WeakMap}return{get:i,dispose:l}}function bl(e){zn.call(this),this.type="MeshDepthMaterial",this.depthPacking=yC,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}bl.prototype=Object.create(zn.prototype),bl.prototype.constructor=bl,bl.prototype.isMeshDepthMaterial=!0,bl.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function wl(e){zn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new xe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}wl.prototype=Object.create(zn.prototype),wl.prototype.constructor=wl,wl.prototype.isMeshDistanceMaterial=!0,wl.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var AL=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,ML=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function Eb(e,t,i){var l=new nd,c=new Rt,h=new Rt,f=new wi,r=[],v=[],_={},w={0:lr,1:wc,2:Uh},b=new Yr({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rt},radius:{value:4}},vertexShader:ML,fragmentShader:AL}),E=b.clone();E.defines.HORIZONAL_PASS=1;var P=new _n;P.setAttribute("position",new Un(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var I=new Fi(P,b),F=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=v1,this.render=function($,oe,be){if(F.enabled!==!1&&!(F.autoUpdate===!1&&F.needsUpdate===!1)&&$.length!==0){var fe=e.getRenderTarget(),Le=e.getActiveCubeFace(),Xe=e.getActiveMipmapLevel(),Ne=e.state;Ne.setBlending(gs),Ne.buffers.color.setClear(1,1,1,1),Ne.buffers.depth.setTest(!0),Ne.setScissorTest(!1);for(var Re=0,Ie=$.length;Re<Ie;Re++){var He=$[Re],Ue=He.shadow;if(Ue===void 0){console.warn("THREE.WebGLShadowMap:",He,"has no shadow.");continue}c.copy(Ue.mapSize);var ot=Ue.getFrameExtents();if(c.multiply(ot),h.copy(Ue.mapSize),(c.x>i||c.y>i)&&(console.warn("THREE.WebGLShadowMap:",He,"has shadow exceeding max texture size, reducing"),c.x>i&&(h.x=Math.floor(i/ot.x),c.x=h.x*ot.x,Ue.mapSize.x=h.x),c.y>i&&(h.y=Math.floor(i/ot.y),c.y=h.y*ot.y,Ue.mapSize.y=h.y)),Ue.map===null&&!Ue.isPointLightShadow&&this.type===zh){var Pt={minFilter:$i,magFilter:$i,format:Uo};Ue.map=new Dr(c.x,c.y,Pt),Ue.map.texture.name=He.name+".shadowMap",Ue.mapPass=new Dr(c.x,c.y,Pt),Ue.camera.updateProjectionMatrix()}if(Ue.map===null){var Pt={minFilter:Yi,magFilter:Yi,format:Uo};Ue.map=new Dr(c.x,c.y,Pt),Ue.map.texture.name=He.name+".shadowMap",Ue.camera.updateProjectionMatrix()}e.setRenderTarget(Ue.map),e.clear();for(var mt=Ue.getViewportCount(),_t=0;_t<mt;_t++){var ft=Ue.getViewport(_t);f.set(h.x*ft.x,h.y*ft.y,h.x*ft.z,h.y*ft.w),Ne.viewport(f),Ue.updateMatrices(He,_t),l=Ue.getFrustum(),ie(oe,be,Ue.camera,He,this.type)}!Ue.isPointLightShadow&&this.type===zh&&B(Ue,be)}F.needsUpdate=!1,e.setRenderTarget(fe,Le,Xe)}};function B($,oe){var be=t.update(I);b.uniforms.shadow_pass.value=$.map.texture,b.uniforms.resolution.value=$.mapSize,b.uniforms.radius.value=$.radius,e.setRenderTarget($.mapPass),e.clear(),e.renderBufferDirect(oe,null,be,b,I,null),E.uniforms.shadow_pass.value=$.mapPass.texture,E.uniforms.resolution.value=$.mapSize,E.uniforms.radius.value=$.radius,e.setRenderTarget($.map),e.clear(),e.renderBufferDirect(oe,null,be,E,I,null)}function O($,oe,be){var fe=$<<0|oe<<1|be<<2,Le=r[fe];return Le===void 0&&(Le=new bl({depthPacking:xC,morphTargets:$,skinning:oe}),r[fe]=Le),Le}function W($,oe,be){var fe=$<<0|oe<<1|be<<2,Le=v[fe];return Le===void 0&&(Le=new wl({morphTargets:$,skinning:oe}),v[fe]=Le),Le}function Z($,oe,be,fe,Le,Xe){var Ne=$.geometry,Re=null,Ie=O,He=$.customDepthMaterial;if(be.isPointLight===!0&&(Ie=W,He=$.customDistanceMaterial),He===void 0){var Ue=!1;oe.morphTargets===!0&&(Ne.isBufferGeometry===!0?Ue=Ne.morphAttributes&&Ne.morphAttributes.position&&Ne.morphAttributes.position.length>0:Ne.isGeometry===!0&&(Ue=Ne.morphTargets&&Ne.morphTargets.length>0));var ot=!1;$.isSkinnedMesh===!0&&(oe.skinning===!0?ot=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",$));var Pt=$.isInstancedMesh===!0;Re=Ie(Ue,ot,Pt)}else Re=He;if(e.localClippingEnabled&&oe.clipShadows===!0&&oe.clippingPlanes.length!==0){var mt=Re.uuid,_t=oe.uuid,ft=_[mt];ft===void 0&&(ft={},_[mt]=ft);var Vt=ft[_t];Vt===void 0&&(Vt=Re.clone(),ft[_t]=Vt),Re=Vt}return Re.visible=oe.visible,Re.wireframe=oe.wireframe,Xe===zh?Re.side=oe.shadowSide!==null?oe.shadowSide:oe.side:Re.side=oe.shadowSide!==null?oe.shadowSide:w[oe.side],Re.clipShadows=oe.clipShadows,Re.clippingPlanes=oe.clippingPlanes,Re.clipIntersection=oe.clipIntersection,Re.wireframeLinewidth=oe.wireframeLinewidth,Re.linewidth=oe.linewidth,be.isPointLight===!0&&Re.isMeshDistanceMaterial===!0&&(Re.referencePosition.setFromMatrixPosition(be.matrixWorld),Re.nearDistance=fe,Re.farDistance=Le),Re}function ie($,oe,be,fe,Le){if($.visible!==!1){var Xe=$.layers.test(oe.layers);if(Xe&&($.isMesh||$.isLine||$.isPoints)&&($.castShadow||$.receiveShadow&&Le===zh)&&(!$.frustumCulled||l.intersectsObject($))){$.modelViewMatrix.multiplyMatrices(be.matrixWorldInverse,$.matrixWorld);var Ne=t.update($),Re=$.material;if(Array.isArray(Re))for(var Ie=Ne.groups,He=0,Ue=Ie.length;He<Ue;He++){var ot=Ie[He],Pt=Re[ot.materialIndex];if(Pt&&Pt.visible){var mt=Z($,Pt,fe,be.near,be.far,Le);e.renderBufferDirect(be,null,Ne,mt,$,ot)}}else if(Re.visible){var mt=Z($,Re,fe,be.near,be.far,Le);e.renderBufferDirect(be,null,Ne,mt,$,null)}}for(var _t=$.children,ft=0,Vt=_t.length;ft<Vt;ft++)ie(_t[ft],oe,be,fe,Le)}}}function SL(e,t,i){var l=i.isWebGL2;function c(){var Ve=!1,Ot=new wi,en=null,Ln=new wi(0,0,0,0);return{setMask:function(fn){en!==fn&&!Ve&&(e.colorMask(fn,fn,fn,fn),en=fn)},setLocked:function(fn){Ve=fn},setClear:function(fn,Gn,qn,Jn,Ji){Ji===!0&&(fn*=Jn,Gn*=Jn,qn*=Jn),Ot.set(fn,Gn,qn,Jn),Ln.equals(Ot)===!1&&(e.clearColor(fn,Gn,qn,Jn),Ln.copy(Ot))},reset:function(){Ve=!1,en=null,Ln.set(-1,0,0,0)}}}function h(){var Ve=!1,Ot=null,en=null,Ln=null;return{setTest:function(fn){fn?Ge(2929):We(2929)},setMask:function(fn){Ot!==fn&&!Ve&&(e.depthMask(fn),Ot=fn)},setFunc:function(fn){if(en!==fn){if(fn)switch(fn){case bP:e.depthFunc(512);break;case wP:e.depthFunc(519);break;case AP:e.depthFunc(513);break;case Ky:e.depthFunc(515);break;case MP:e.depthFunc(514);break;case SP:e.depthFunc(518);break;case TP:e.depthFunc(516);break;case EP:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);en=fn}},setLocked:function(fn){Ve=fn},setClear:function(fn){Ln!==fn&&(e.clearDepth(fn),Ln=fn)},reset:function(){Ve=!1,Ot=null,en=null,Ln=null}}}function f(){var Ve=!1,Ot=null,en=null,Ln=null,fn=null,Gn=null,qn=null,Jn=null,Ji=null;return{setTest:function(jn){Ve||(jn?Ge(2960):We(2960))},setMask:function(jn){Ot!==jn&&!Ve&&(e.stencilMask(jn),Ot=jn)},setFunc:function(jn,ki,oi){(en!==jn||Ln!==ki||fn!==oi)&&(e.stencilFunc(jn,ki,oi),en=jn,Ln=ki,fn=oi)},setOp:function(jn,ki,oi){(Gn!==jn||qn!==ki||Jn!==oi)&&(e.stencilOp(jn,ki,oi),Gn=jn,qn=ki,Jn=oi)},setLocked:function(jn){Ve=jn},setClear:function(jn){Ji!==jn&&(e.clearStencil(jn),Ji=jn)},reset:function(){Ve=!1,Ot=null,en=null,Ln=null,fn=null,Gn=null,qn=null,Jn=null,Ji=null}}}var r=new c,v=new h,_=new f,w=e.getParameter(34921),b=new Uint8Array(w),E=new Uint8Array(w),P=new Uint8Array(w),I={},F=null,B=null,O=null,W=null,Z=null,ie=null,$=null,oe=null,be=null,fe=!1,Le=null,Xe=null,Ne=null,Re=null,Ie=null,He=e.getParameter(35661),Ue=!1,ot=0,Pt=e.getParameter(7938);Pt.indexOf("WebGL")!==-1?(ot=parseFloat(/^WebGL\ ([0-9])/.exec(Pt)[1]),Ue=ot>=1):Pt.indexOf("OpenGL ES")!==-1&&(ot=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Pt)[1]),Ue=ot>=2);var mt=null,_t={},ft=new wi,Vt=new wi;function we(Ve,Ot,en){var Ln=new Uint8Array(4),fn=e.createTexture();e.bindTexture(Ve,fn),e.texParameteri(Ve,10241,9728),e.texParameteri(Ve,10240,9728);for(var Gn=0;Gn<en;Gn++)e.texImage2D(Ot+Gn,0,6408,1,1,0,6408,5121,Ln);return fn}var pe={};pe[3553]=we(3553,3553,1),pe[34067]=we(34067,34069,6),r.setClear(0,0,0,1),v.setClear(1),_.setClear(0),Ge(2929),v.setFunc(Ky),An(!1),le(x1),Ge(2884),Lt(gs);function ke(){for(var Ve=0,Ot=b.length;Ve<Ot;Ve++)b[Ve]=0}function De(Ve){Se(Ve,0)}function Se(Ve,Ot){if(b[Ve]=1,E[Ve]===0&&(e.enableVertexAttribArray(Ve),E[Ve]=1),P[Ve]!==Ot){var en=l?e:t.get("ANGLE_instanced_arrays");en[l?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ve,Ot),P[Ve]=Ot}}function tt(){for(var Ve=0,Ot=E.length;Ve!==Ot;++Ve)E[Ve]!==b[Ve]&&(e.disableVertexAttribArray(Ve),E[Ve]=0)}function Ge(Ve){I[Ve]!==!0&&(e.enable(Ve),I[Ve]=!0)}function We(Ve){I[Ve]!==!1&&(e.disable(Ve),I[Ve]=!1)}function nt(Ve){return F!==Ve?(e.useProgram(Ve),F=Ve,!0):!1}var je={[Mc]:32774,[uP]:32778,[hP]:32779};if(l)je[S1]=32775,je[T1]=32776;else{var lt=t.get("EXT_blend_minmax");lt!==null&&(je[S1]=lt.MIN_EXT,je[T1]=lt.MAX_EXT)}var gt={[dP]:0,[pP]:1,[fP]:768,[E1]:770,[_P]:776,[xP]:774,[gP]:772,[mP]:769,[P1]:771,[vP]:775,[yP]:773};function Lt(Ve,Ot,en,Ln,fn,Gn,qn,Jn){if(Ve===gs){B&&(We(3042),B=!1);return}if(B||(Ge(3042),B=!0),Ve!==cP){if(Ve!==O||Jn!==fe){if((W!==Mc||$!==Mc)&&(e.blendEquation(32774),W=Mc,$=Mc),Jn)switch(Ve){case Nh:e.blendFuncSeparate(1,771,1,771);break;case w1:e.blendFunc(1,1);break;case A1:e.blendFuncSeparate(0,0,769,771);break;case M1:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}else switch(Ve){case Nh:e.blendFuncSeparate(770,771,1,771);break;case w1:e.blendFunc(770,1);break;case A1:e.blendFunc(0,769);break;case M1:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}Z=null,ie=null,oe=null,be=null,O=Ve,fe=Jn}return}fn=fn||Ot,Gn=Gn||en,qn=qn||Ln,(Ot!==W||fn!==$)&&(e.blendEquationSeparate(je[Ot],je[fn]),W=Ot,$=fn),(en!==Z||Ln!==ie||Gn!==oe||qn!==be)&&(e.blendFuncSeparate(gt[en],gt[Ln],gt[Gn],gt[qn]),Z=en,ie=Ln,oe=Gn,be=qn),O=Ve,fe=null}function sn(Ve,Ot){Ve.side===Uh?We(2884):Ge(2884);var en=Ve.side===lr;Ot&&(en=!en),An(en),Ve.blending===Nh&&Ve.transparent===!1?Lt(gs):Lt(Ve.blending,Ve.blendEquation,Ve.blendSrc,Ve.blendDst,Ve.blendEquationAlpha,Ve.blendSrcAlpha,Ve.blendDstAlpha,Ve.premultipliedAlpha),v.setFunc(Ve.depthFunc),v.setTest(Ve.depthTest),v.setMask(Ve.depthWrite),r.setMask(Ve.colorWrite);var Ln=Ve.stencilWrite;_.setTest(Ln),Ln&&(_.setMask(Ve.stencilWriteMask),_.setFunc(Ve.stencilFunc,Ve.stencilRef,Ve.stencilFuncMask),_.setOp(Ve.stencilFail,Ve.stencilZFail,Ve.stencilZPass)),Et(Ve.polygonOffset,Ve.polygonOffsetFactor,Ve.polygonOffsetUnits)}function An(Ve){Le!==Ve&&(Ve?e.frontFace(2304):e.frontFace(2305),Le=Ve)}function le(Ve){Ve!==oP?(Ge(2884),Ve!==Xe&&(Ve===x1?e.cullFace(1029):Ve===aP?e.cullFace(1028):e.cullFace(1032))):We(2884),Xe=Ve}function Ee(Ve){Ve!==Ne&&(Ue&&e.lineWidth(Ve),Ne=Ve)}function Et(Ve,Ot,en){Ve?(Ge(32823),(Re!==Ot||Ie!==en)&&(e.polygonOffset(Ot,en),Re=Ot,Ie=en)):We(32823)}function wt(Ve){Ve?Ge(3089):We(3089)}function Mn(Ve){Ve===void 0&&(Ve=33984+He-1),mt!==Ve&&(e.activeTexture(Ve),mt=Ve)}function xn(Ve,Ot){mt===null&&Mn();var en=_t[mt];en===void 0&&(en={type:void 0,texture:void 0},_t[mt]=en),(en.type!==Ve||en.texture!==Ot)&&(e.bindTexture(Ve,Ot||pe[Ve]),en.type=Ve,en.texture=Ot)}function un(){var Ve=_t[mt];Ve!==void 0&&Ve.type!==void 0&&(e.bindTexture(Ve.type,null),Ve.type=void 0,Ve.texture=void 0)}function bn(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Tn(){try{e.texImage2D.apply(e,arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function hn(){try{e.texImage3D.apply(e,arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function jt(Ve){ft.equals(Ve)===!1&&(e.scissor(Ve.x,Ve.y,Ve.z,Ve.w),ft.copy(Ve))}function ln(Ve){Vt.equals(Ve)===!1&&(e.viewport(Ve.x,Ve.y,Ve.z,Ve.w),Vt.copy(Ve))}function Xt(){for(var Ve=0;Ve<E.length;Ve++)E[Ve]===1&&(e.disableVertexAttribArray(Ve),E[Ve]=0);I={},mt=null,_t={},F=null,O=null,Le=null,Xe=null,r.reset(),v.reset(),_.reset()}return{buffers:{color:r,depth:v,stencil:_},initAttributes:ke,enableAttribute:De,enableAttributeAndDivisor:Se,disableUnusedAttributes:tt,enable:Ge,disable:We,useProgram:nt,setBlending:Lt,setMaterial:sn,setFlipSided:An,setCullFace:le,setLineWidth:Ee,setPolygonOffset:Et,setScissorTest:wt,activeTexture:Mn,bindTexture:xn,unbindTexture:un,compressedTexImage2D:bn,texImage2D:Tn,texImage3D:hn,scissor:jt,viewport:ln,reset:Xt}}function TL(e,t,i,l,c,h,f){var r=c.isWebGL2,v=c.maxTextures,_=c.maxCubemapSize,w=c.maxTextureSize,b=c.maxSamples,E=new WeakMap,P,I=!1;try{I=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(le){}function F(le,Ee){return I?new OffscreenCanvas(le,Ee):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function B(le,Ee,Et,wt){var Mn=1;if((le.width>wt||le.height>wt)&&(Mn=wt/Math.max(le.width,le.height)),Mn<1||Ee===!0)if(typeof HTMLImageElement!="undefined"&&le instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&le instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&le instanceof ImageBitmap){var xn=Ee?Xn.floorPowerOfTwo:Math.floor,un=xn(Mn*le.width),bn=xn(Mn*le.height);P===void 0&&(P=F(un,bn));var Tn=Et?F(un,bn):P;Tn.width=un,Tn.height=bn;var hn=Tn.getContext("2d");return hn.drawImage(le,0,0,un,bn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+le.width+"x"+le.height+") to ("+un+"x"+bn+")."),Tn}else return"data"in le&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+le.width+"x"+le.height+")."),le;return le}function O(le){return Xn.isPowerOfTwo(le.width)&&Xn.isPowerOfTwo(le.height)}function W(le){return r?!1:le.wrapS!==Rr||le.wrapT!==Rr||le.minFilter!==Yi&&le.minFilter!==$i}function Z(le,Ee){return le.generateMipmaps&&Ee&&le.minFilter!==Yi&&le.minFilter!==$i}function ie(le,Ee,Et,wt){e.generateMipmap(le);var Mn=l.get(Ee);Mn.__maxMipLevel=Math.log(Math.max(Et,wt))*Math.LOG2E}function $(le,Ee,Et){if(r===!1)return Ee;if(le!==null){if(e[le]!==void 0)return e[le];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+le+"'")}var wt=Ee;return Ee===6403&&(Et===5126&&(wt=33326),Et===5131&&(wt=33325),Et===5121&&(wt=33321)),Ee===6407&&(Et===5126&&(wt=34837),Et===5131&&(wt=34843),Et===5121&&(wt=32849)),Ee===6408&&(Et===5126&&(wt=34836),Et===5131&&(wt=34842),Et===5121&&(wt=32856)),wt===33325||wt===33326||wt===34842||wt===34836?t.get("EXT_color_buffer_float"):(wt===34843||wt===34837)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),wt}function oe(le){return le===Yi||le===Ef||le===Pf?9728:9729}function be(le){var Ee=le.target;Ee.removeEventListener("dispose",be),Le(Ee),Ee.isVideoTexture&&E.delete(Ee),f.memory.textures--}function fe(le){var Ee=le.target;Ee.removeEventListener("dispose",fe),Xe(Ee),f.memory.textures--}function Le(le){var Ee=l.get(le);Ee.__webglInit!==void 0&&(e.deleteTexture(Ee.__webglTexture),l.remove(le))}function Xe(le){var Ee=l.get(le),Et=l.get(le.texture);if(le){if(Et.__webglTexture!==void 0&&e.deleteTexture(Et.__webglTexture),le.depthTexture&&le.depthTexture.dispose(),le.isWebGLCubeRenderTarget)for(var wt=0;wt<6;wt++)e.deleteFramebuffer(Ee.__webglFramebuffer[wt]),Ee.__webglDepthbuffer&&e.deleteRenderbuffer(Ee.__webglDepthbuffer[wt]);else e.deleteFramebuffer(Ee.__webglFramebuffer),Ee.__webglDepthbuffer&&e.deleteRenderbuffer(Ee.__webglDepthbuffer);if(le.isWebGLMultiviewRenderTarget){e.deleteTexture(Ee.__webglColorTexture),e.deleteTexture(Ee.__webglDepthStencilTexture),f.memory.textures-=2;for(var wt=0,Mn=Ee.__webglViewFramebuffers.length;wt<Mn;wt++)e.deleteFramebuffer(Ee.__webglViewFramebuffers[wt])}l.remove(le.texture),l.remove(le)}}var Ne=0;function Re(){Ne=0}function Ie(){var le=Ne;return le>=v&&console.warn("THREE.WebGLTextures: Trying to use "+le+" texture units while this GPU supports only "+v),Ne+=1,le}function He(le,Ee){var Et=l.get(le);if(le.isVideoTexture&&lt(le),le.version>0&&Et.__version!==le.version){var wt=le.image;if(wt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(wt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{pe(Et,le,Ee);return}}i.activeTexture(33984+Ee),i.bindTexture(3553,Et.__webglTexture)}function Ue(le,Ee){var Et=l.get(le);if(le.version>0&&Et.__version!==le.version){pe(Et,le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(35866,Et.__webglTexture)}function ot(le,Ee){var Et=l.get(le);if(le.version>0&&Et.__version!==le.version){pe(Et,le,Ee);return}i.activeTexture(33984+Ee),i.bindTexture(32879,Et.__webglTexture)}function Pt(le,Ee){if(le.image.length===6){var Et=l.get(le);if(le.version>0&&Et.__version!==le.version){we(Et,le),i.activeTexture(33984+Ee),i.bindTexture(34067,Et.__webglTexture),e.pixelStorei(37440,le.flipY);for(var wt=le&&(le.isCompressedTexture||le.image[0].isCompressedTexture),Mn=le.image[0]&&le.image[0].isDataTexture,xn=[],un=0;un<6;un++)!wt&&!Mn?xn[un]=B(le.image[un],!1,!0,_):xn[un]=Mn?le.image[un].image:le.image[un];var bn=xn[0],Tn=O(bn)||r,hn=h.convert(le.format),jt=h.convert(le.type),ln=$(le.internalFormat,hn,jt);Vt(34067,le,Tn);var Xt;if(wt){for(var un=0;un<6;un++){Xt=xn[un].mipmaps;for(var Ve=0;Ve<Xt.length;Ve++){var Ot=Xt[Ve];le.format!==Uo&&le.format!==ka?hn!==null?i.compressedTexImage2D(34069+un,Ve,ln,Ot.width,Ot.height,0,Ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+un,Ve,ln,Ot.width,Ot.height,0,hn,jt,Ot.data)}}Et.__maxMipLevel=Xt.length-1}else{Xt=le.mipmaps;for(var un=0;un<6;un++)if(Mn){i.texImage2D(34069+un,0,ln,xn[un].width,xn[un].height,0,hn,jt,xn[un].data);for(var Ve=0;Ve<Xt.length;Ve++){var Ot=Xt[Ve],en=Ot.image[un].image;i.texImage2D(34069+un,Ve+1,ln,en.width,en.height,0,hn,jt,en.data)}}else{i.texImage2D(34069+un,0,ln,hn,jt,xn[un]);for(var Ve=0;Ve<Xt.length;Ve++){var Ot=Xt[Ve];i.texImage2D(34069+un,Ve+1,ln,hn,jt,Ot.image[un])}}Et.__maxMipLevel=Xt.length}Z(le,Tn)&&ie(34067,le,bn.width,bn.height),Et.__version=le.version,le.onUpdate&&le.onUpdate(le)}else i.activeTexture(33984+Ee),i.bindTexture(34067,Et.__webglTexture)}}function mt(le,Ee){i.activeTexture(33984+Ee),i.bindTexture(34067,l.get(le).__webglTexture)}var _t={[dl]:10497,[Rr]:33071,[Oh]:33648},ft={[Yi]:9728,[Ef]:9984,[Pf]:9986,[$i]:9729,[n0]:9985,[Sc]:9987};function Vt(le,Ee,Et){Et?(e.texParameteri(le,10242,_t[Ee.wrapS]),e.texParameteri(le,10243,_t[Ee.wrapT]),(le===32879||le===35866)&&e.texParameteri(le,32882,_t[Ee.wrapR]),e.texParameteri(le,10240,ft[Ee.magFilter]),e.texParameteri(le,10241,ft[Ee.minFilter])):(e.texParameteri(le,10242,33071),e.texParameteri(le,10243,33071),(le===32879||le===35866)&&e.texParameteri(le,32882,33071),(Ee.wrapS!==Rr||Ee.wrapT!==Rr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(le,10240,oe(Ee.magFilter)),e.texParameteri(le,10241,oe(Ee.minFilter)),Ee.minFilter!==Yi&&Ee.minFilter!==$i&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var wt=t.get("EXT_texture_filter_anisotropic");if(wt){if(Ee.type===Gh&&t.get("OES_texture_float_linear")===null||Ee.type===i0&&(r||t.get("OES_texture_half_float_linear"))===null)return;(Ee.anisotropy>1||l.get(Ee).__currentAnisotropy)&&(e.texParameterf(le,wt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ee.anisotropy,c.getMaxAnisotropy())),l.get(Ee).__currentAnisotropy=Ee.anisotropy)}}function we(le,Ee){le.__webglInit===void 0&&(le.__webglInit=!0,Ee.addEventListener("dispose",be),le.__webglTexture=e.createTexture(),f.memory.textures++)}function pe(le,Ee,Et){var wt=3553;Ee.isDataTexture2DArray&&(wt=35866),Ee.isDataTexture3D&&(wt=32879),we(le,Ee),i.activeTexture(33984+Et),i.bindTexture(wt,le.__webglTexture),e.pixelStorei(37440,Ee.flipY),e.pixelStorei(37441,Ee.premultiplyAlpha),e.pixelStorei(3317,Ee.unpackAlignment);var Mn=W(Ee)&&O(Ee.image)===!1,xn=B(Ee.image,Mn,!1,w),un=O(xn)||r,bn=h.convert(Ee.format),Tn=h.convert(Ee.type),hn=$(Ee.internalFormat,bn,Tn);Vt(wt,Ee,un);var jt,ln=Ee.mipmaps;if(Ee.isDepthTexture){if(hn=6402,Ee.type===Gh){if(r===!1)throw new Error("Float Depth Texture only supported in WebGL2.0");hn=36012}else r&&(hn=33189);Ee.format===Tc&&hn===6402&&Ee.type!==Rf&&Ee.type!==D1&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ee.type=Rf,Tn=h.convert(Ee.type)),Ee.format===jh&&(hn=34041,Ee.type!==Df&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ee.type=Df,Tn=h.convert(Ee.type))),i.texImage2D(3553,0,hn,xn.width,xn.height,0,bn,Tn,null)}else if(Ee.isDataTexture)if(ln.length>0&&un){for(var Xt=0,Ve=ln.length;Xt<Ve;Xt++)jt=ln[Xt],i.texImage2D(3553,Xt,hn,jt.width,jt.height,0,bn,Tn,jt.data);Ee.generateMipmaps=!1,le.__maxMipLevel=ln.length-1}else i.texImage2D(3553,0,hn,xn.width,xn.height,0,bn,Tn,xn.data),le.__maxMipLevel=0;else if(Ee.isCompressedTexture){for(var Xt=0,Ve=ln.length;Xt<Ve;Xt++)jt=ln[Xt],Ee.format!==Uo&&Ee.format!==ka?bn!==null?i.compressedTexImage2D(3553,Xt,hn,jt.width,jt.height,0,jt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,Xt,hn,jt.width,jt.height,0,bn,Tn,jt.data);le.__maxMipLevel=ln.length-1}else if(Ee.isDataTexture2DArray)i.texImage3D(35866,0,hn,xn.width,xn.height,xn.depth,0,bn,Tn,xn.data),le.__maxMipLevel=0;else if(Ee.isDataTexture3D)i.texImage3D(32879,0,hn,xn.width,xn.height,xn.depth,0,bn,Tn,xn.data),le.__maxMipLevel=0;else if(ln.length>0&&un){for(var Xt=0,Ve=ln.length;Xt<Ve;Xt++)jt=ln[Xt],i.texImage2D(3553,Xt,hn,bn,Tn,jt);Ee.generateMipmaps=!1,le.__maxMipLevel=ln.length-1}else i.texImage2D(3553,0,hn,bn,Tn,xn),le.__maxMipLevel=0;Z(Ee,un)&&ie(wt,Ee,xn.width,xn.height),le.__version=Ee.version,Ee.onUpdate&&Ee.onUpdate(Ee)}function ke(le,Ee,Et,wt){var Mn=h.convert(Ee.texture.format),xn=h.convert(Ee.texture.type),un=$(Ee.texture.internalFormat,Mn,xn);i.texImage2D(wt,0,un,Ee.width,Ee.height,0,Mn,xn,null),e.bindFramebuffer(36160,le),e.framebufferTexture2D(36160,Et,wt,l.get(Ee.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function De(le,Ee,Et){if(e.bindRenderbuffer(36161,le),Ee.depthBuffer&&!Ee.stencilBuffer){if(Et){var wt=je(Ee);e.renderbufferStorageMultisample(36161,wt,33189,Ee.width,Ee.height)}else e.renderbufferStorage(36161,33189,Ee.width,Ee.height);e.framebufferRenderbuffer(36160,36096,36161,le)}else if(Ee.depthBuffer&&Ee.stencilBuffer){if(Et){var wt=je(Ee);e.renderbufferStorageMultisample(36161,wt,35056,Ee.width,Ee.height)}else e.renderbufferStorage(36161,34041,Ee.width,Ee.height);e.framebufferRenderbuffer(36160,33306,36161,le)}else{var Mn=h.convert(Ee.texture.format),xn=h.convert(Ee.texture.type),un=$(Ee.texture.internalFormat,Mn,xn);if(Et){var wt=je(Ee);e.renderbufferStorageMultisample(36161,wt,un,Ee.width,Ee.height)}else e.renderbufferStorage(36161,un,Ee.width,Ee.height)}e.bindRenderbuffer(36161,null)}function Se(le,Ee){var Et=Ee&&Ee.isWebGLCubeRenderTarget;if(Et)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,le),!(Ee.depthTexture&&Ee.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!l.get(Ee.depthTexture).__webglTexture||Ee.depthTexture.image.width!==Ee.width||Ee.depthTexture.image.height!==Ee.height)&&(Ee.depthTexture.image.width=Ee.width,Ee.depthTexture.image.height=Ee.height,Ee.depthTexture.needsUpdate=!0),He(Ee.depthTexture,0);var wt=l.get(Ee.depthTexture).__webglTexture;if(Ee.depthTexture.format===Tc)e.framebufferTexture2D(36160,36096,3553,wt,0);else if(Ee.depthTexture.format===jh)e.framebufferTexture2D(36160,33306,3553,wt,0);else throw new Error("Unknown depthTexture format")}function tt(le){var Ee=l.get(le),Et=le.isWebGLCubeRenderTarget===!0;if(le.depthTexture){if(Et)throw new Error("target.depthTexture not supported in Cube render targets");Se(Ee.__webglFramebuffer,le)}else if(Et){Ee.__webglDepthbuffer=[];for(var wt=0;wt<6;wt++)e.bindFramebuffer(36160,Ee.__webglFramebuffer[wt]),Ee.__webglDepthbuffer[wt]=e.createRenderbuffer(),De(Ee.__webglDepthbuffer[wt],le)}else e.bindFramebuffer(36160,Ee.__webglFramebuffer),Ee.__webglDepthbuffer=e.createRenderbuffer(),De(Ee.__webglDepthbuffer,le);e.bindFramebuffer(36160,null)}function Ge(le){var Ee=l.get(le),Et=l.get(le.texture);le.addEventListener("dispose",fe),Et.__webglTexture=e.createTexture(),f.memory.textures++;var wt=le.isWebGLCubeRenderTarget===!0,Mn=le.isWebGLMultisampleRenderTarget===!0,xn=le.isWebGLMultiviewRenderTarget===!0,un=O(le)||r;if(wt){Ee.__webglFramebuffer=[];for(var bn=0;bn<6;bn++)Ee.__webglFramebuffer[bn]=e.createFramebuffer()}else if(Ee.__webglFramebuffer=e.createFramebuffer(),Mn)if(r){Ee.__webglMultisampledFramebuffer=e.createFramebuffer(),Ee.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,Ee.__webglColorRenderbuffer);var Tn=h.convert(le.texture.format),hn=h.convert(le.texture.type),jt=$(le.texture.internalFormat,Tn,hn),ln=je(le);e.renderbufferStorageMultisample(36161,ln,jt,le.width,le.height),e.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,Ee.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),le.depthBuffer&&(Ee.__webglDepthRenderbuffer=e.createRenderbuffer(),De(Ee.__webglDepthRenderbuffer,le,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(xn){var Xt=le.width,Ve=le.height,Ot=le.numViews;e.bindFramebuffer(36160,Ee.__webglFramebuffer);var en=t.get("OVR_multiview2");f.memory.textures+=2;var Ln=e.createTexture();e.bindTexture(35866,Ln),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,32856,Xt,Ve,Ot,0,6408,5121,null),en.framebufferTextureMultiviewOVR(36160,36064,Ln,0,0,Ot);var fn=e.createTexture();e.bindTexture(35866,fn),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,35056,Xt,Ve,Ot,0,34041,34042,null),en.framebufferTextureMultiviewOVR(36160,33306,fn,0,0,Ot);for(var Gn=new Array(Ot),bn=0;bn<Ot;++bn)Gn[bn]=e.createFramebuffer(),e.bindFramebuffer(36160,Gn[bn]),e.framebufferTextureLayer(36160,36064,Ln,0,bn);Ee.__webglColorTexture=Ln,Ee.__webglDepthStencilTexture=fn,Ee.__webglViewFramebuffers=Gn,e.bindFramebuffer(36160,null),e.bindTexture(35866,null)}if(wt){i.bindTexture(34067,Et.__webglTexture),Vt(34067,le.texture,un);for(var bn=0;bn<6;bn++)ke(Ee.__webglFramebuffer[bn],le,36064,34069+bn);Z(le.texture,un)&&ie(34067,le.texture,le.width,le.height),i.bindTexture(34067,null)}else xn||(i.bindTexture(3553,Et.__webglTexture),Vt(3553,le.texture,un),ke(Ee.__webglFramebuffer,le,36064,3553),Z(le.texture,un)&&ie(3553,le.texture,le.width,le.height),i.bindTexture(3553,null));le.depthBuffer&&tt(le)}function We(le){var Ee=le.texture,Et=O(le)||r;if(Z(Ee,Et)){var wt=le.isWebGLCubeRenderTarget?34067:3553,Mn=l.get(Ee).__webglTexture;i.bindTexture(wt,Mn),ie(wt,Ee,le.width,le.height),i.bindTexture(wt,null)}}function nt(le){if(le.isWebGLMultisampleRenderTarget)if(r){var Ee=l.get(le);e.bindFramebuffer(36008,Ee.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Ee.__webglFramebuffer);var Et=le.width,wt=le.height,Mn=16384;le.depthBuffer&&(Mn|=256),le.stencilBuffer&&(Mn|=1024),e.blitFramebuffer(0,0,Et,wt,0,0,Et,wt,Mn,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function je(le){return r&&le.isWebGLMultisampleRenderTarget?Math.min(b,le.samples):0}function lt(le){var Ee=f.render.frame;E.get(le)!==Ee&&(E.set(le,Ee),le.update())}var gt=!1,Lt=!1;function sn(le,Ee){le&&le.isWebGLRenderTarget&&(gt===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),gt=!0),le=le.texture),He(le,Ee)}function An(le,Ee){le&&le.isWebGLCubeRenderTarget&&(Lt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Lt=!0),le=le.texture),le&&le.isCubeTexture||Array.isArray(le.image)&&le.image.length===6?Pt(le,Ee):mt(le,Ee)}this.allocateTextureUnit=Ie,this.resetTextureUnits=Re,this.setTexture2D=He,this.setTexture2DArray=Ue,this.setTexture3D=ot,this.setTextureCube=Pt,this.setTextureCubeDynamic=mt,this.setupRenderTarget=Ge,this.updateRenderTargetMipmap=We,this.updateMultisampleRenderTarget=nt,this.safeSetTexture2D=sn,this.safeSetTextureCube=An}function EL(e,t,i){var l=i.isWebGL2;function c(h){var f;if(h===Cf)return 5121;if(h===zP)return 32819;if(h===UP)return 32820;if(h===NP)return 33635;if(h===FP)return 5120;if(h===kP)return 5122;if(h===Rf)return 5123;if(h===BP)return 5124;if(h===D1)return 5125;if(h===Gh)return 5126;if(h===i0)return l?5131:(f=t.get("OES_texture_half_float"),f!==null?f.HALF_FLOAT_OES:null);if(h===VP)return 6406;if(h===ka)return 6407;if(h===Uo)return 6408;if(h===OP)return 6409;if(h===GP)return 6410;if(h===Tc)return 6402;if(h===jh)return 34041;if(h===HP)return 6403;if(h===WP)return 36244;if(h===qP)return 33319;if(h===YP)return 33320;if(h===XP)return 36248;if(h===KP)return 36249;if(h===I1||h===L1||h===F1||h===k1)if(f=t.get("WEBGL_compressed_texture_s3tc"),f!==null){if(h===I1)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(h===L1)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(h===F1)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(h===k1)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(h===B1||h===z1||h===U1||h===N1)if(f=t.get("WEBGL_compressed_texture_pvrtc"),f!==null){if(h===B1)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(h===z1)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(h===U1)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(h===N1)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(h===ZP)return f=t.get("WEBGL_compressed_texture_etc1"),f!==null?f.COMPRESSED_RGB_ETC1_WEBGL:null;if(h===JP||h===QP||h===$P||h===eC||h===tC||h===nC||h===iC||h===rC||h===oC||h===aC||h===sC||h===lC||h===cC||h===uC)return f=t.get("WEBGL_compressed_texture_astc"),f!==null?h:null;if(h===Df)return l?34042:(f=t.get("WEBGL_depth_texture"),f!==null?f.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:c}}function F0(e,t,i,l){Dr.call(this,e,t,l),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=i}F0.prototype=Object.assign(Object.create(Dr.prototype),{constructor:F0,isWebGLMultiviewRenderTarget:!0,copy:function(e){return Dr.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}});function PL(e,t){var i=2,l=e.extensions,c=e.properties,h,f,r,v,_,w,b,E=0;function P(){if(b===void 0){var be=l.get("OVR_multiview2");if(b=be!==null&&t.getContextAttributes().antialias===!1,b){E=t.getParameter(be.MAX_VIEWS_OVR),h=new F0(0,0,i),w=new Rt,v=[],r=[],_=[];for(var fe=0;fe<E;fe++)v[fe]=new Kn,r[fe]=new vr}}return b}function I(be){return be.isArrayCamera?be.cameras:(_[0]=be,_)}function F(be,fe){for(var Le=I(be),Xe=0;Xe<Le.length;Xe++)v[Xe].copy(Le[Xe].projectionMatrix);fe.setValue(t,"projectionMatrices",v)}function B(be,fe){for(var Le=I(be),Xe=0;Xe<Le.length;Xe++)v[Xe].copy(Le[Xe].matrixWorldInverse);fe.setValue(t,"viewMatrices",v)}function O(be,fe,Le){for(var Xe=I(fe),Ne=0;Ne<Xe.length;Ne++)v[Ne].multiplyMatrices(Xe[Ne].matrixWorldInverse,be.matrixWorld),r[Ne].getNormalMatrix(v[Ne]);Le.setValue(t,"modelViewMatrices",v),Le.setValue(t,"normalMatrices",r)}function W(be){if(be.isArrayCamera===void 0)return!0;var fe=be.cameras;if(fe.length>E)return!1;for(var Le=1,Xe=fe.length;Le<Xe;Le++)if(fe[0].viewport.z!==fe[Le].viewport.z||fe[0].viewport.w!==fe[Le].viewport.w)return!1;return!0}function Z(be){if(f?w.set(f.width,f.height):e.getDrawingBufferSize(w),be.isArrayCamera){var fe=be.cameras[0].viewport;h.setSize(fe.z,fe.w),h.setNumViews(be.cameras.length)}else h.setSize(w.x,w.y),h.setNumViews(i)}function ie(be){W(be)!==!1&&(f=e.getRenderTarget(),Z(be),e.setRenderTarget(h))}function $(be){h===e.getRenderTarget()&&(e.setRenderTarget(f),oe(be))}function oe(be){var fe=h,Le=fe.numViews,Xe=c.get(fe).__webglViewFramebuffers,Ne=fe.width,Re=fe.height;if(be.isArrayCamera)for(var Ie=0;Ie<Le;Ie++){var He=be.cameras[Ie].viewport,Ue=He.x,ot=He.y,Pt=Ue+He.z,mt=ot+He.w;t.bindFramebuffer(36008,Xe[Ie]),t.blitFramebuffer(0,0,Ne,Re,Ue,ot,Pt,mt,16384,9728)}else t.bindFramebuffer(36008,Xe[0]),t.blitFramebuffer(0,0,Ne,Re,0,0,w.x,w.y,16384,9728)}this.isAvailable=P,this.attachCamera=ie,this.detachCamera=$,this.updateCameraProjectionMatricesUniform=F,this.updateCameraViewMatricesUniform=B,this.updateObjectMatricesUniforms=O}function k0(e){tr.call(this),this.cameras=e||[]}k0.prototype=Object.assign(Object.create(tr.prototype),{constructor:k0,isArrayCamera:!0});function Al(){on.call(this),this.type="Group"}Al.prototype=Object.assign(Object.create(on.prototype),{constructor:Al,isGroup:!0});function Pb(e,t){var i=this,l=null,c=null,h="local-floor",f=null,r=[],v=new Map,_=new tr;_.layers.enable(1),_.viewport=new wi;var w=new tr;w.layers.enable(2),w.viewport=new wi;var b=new k0([_,w]);b.layers.enable(1),b.layers.enable(2);var E=null,P=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(Le){var Xe=r[Le];return Xe===void 0&&(Xe={},r[Le]=Xe),Xe.targetRay===void 0&&(Xe.targetRay=new Al,Xe.targetRay.matrixAutoUpdate=!1,Xe.targetRay.visible=!1),Xe.targetRay},this.getControllerGrip=function(Le){var Xe=r[Le];return Xe===void 0&&(Xe={},r[Le]=Xe),Xe.grip===void 0&&(Xe.grip=new Al,Xe.grip.matrixAutoUpdate=!1,Xe.grip.visible=!1),Xe.grip};function I(Le){var Xe=v.get(Le.inputSource);Xe&&(Xe.targetRay&&Xe.targetRay.dispatchEvent({type:Le.type}),Xe.grip&&Xe.grip.dispatchEvent({type:Le.type}))}function F(){v.forEach(function(Le,Xe){Le.targetRay&&(Le.targetRay.dispatchEvent({type:"disconnected",data:Xe}),Le.targetRay.visible=!1),Le.grip&&(Le.grip.dispatchEvent({type:"disconnected",data:Xe}),Le.grip.visible=!1)}),v.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),fe.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function B(Le){c=Le,fe.setContext(l),fe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(Le){h=Le},this.getReferenceSpace=function(){return c},this.getSession=function(){return l},this.setSession=function(Le){if(l=Le,l!==null){l.addEventListener("select",I),l.addEventListener("selectstart",I),l.addEventListener("selectend",I),l.addEventListener("squeeze",I),l.addEventListener("squeezestart",I),l.addEventListener("squeezeend",I),l.addEventListener("end",F);var Xe=t.getContextAttributes(),Ne={antialias:Xe.antialias,alpha:Xe.alpha,depth:Xe.depth,stencil:Xe.stencil},Re=new XRWebGLLayer(l,t,Ne);l.updateRenderState({baseLayer:Re}),l.requestReferenceSpace(h).then(B),l.addEventListener("inputsourceschange",O)}};function O(Le){for(var Xe=l.inputSources,Ne=0;Ne<r.length;Ne++)v.set(Xe[Ne],r[Ne]);for(var Ne=0;Ne<Le.removed.length;Ne++){var Re=Le.removed[Ne],Ie=v.get(Re);Ie&&(Ie.targetRay&&Ie.targetRay.dispatchEvent({type:"disconnected",data:Re}),Ie.grip&&Ie.grip.dispatchEvent({type:"disconnected",data:Re}),v.delete(Re))}for(var Ne=0;Ne<Le.added.length;Ne++){var Re=Le.added[Ne],Ie=v.get(Re);Ie&&(Ie.targetRay&&Ie.targetRay.dispatchEvent({type:"connected",data:Re}),Ie.grip&&Ie.grip.dispatchEvent({type:"connected",data:Re}))}}var W=new xe,Z=new xe;function ie(Le,Xe,Ne){W.setFromMatrixPosition(Xe.matrixWorld),Z.setFromMatrixPosition(Ne.matrixWorld);var Re=W.distanceTo(Z),Ie=Xe.projectionMatrix.elements,He=Ne.projectionMatrix.elements,Ue=Ie[14]/(Ie[10]-1),ot=Ie[14]/(Ie[10]+1),Pt=(Ie[9]+1)/Ie[5],mt=(Ie[9]-1)/Ie[5],_t=(Ie[8]-1)/Ie[0],ft=(He[8]+1)/He[0],Vt=Ue*_t,we=Ue*ft,pe=Re/(-_t+ft),ke=pe*-_t;Xe.matrixWorld.decompose(Le.position,Le.quaternion,Le.scale),Le.translateX(ke),Le.translateZ(pe),Le.matrixWorld.compose(Le.position,Le.quaternion,Le.scale),Le.matrixWorldInverse.getInverse(Le.matrixWorld);var De=Ue+pe,Se=ot+pe,tt=Vt-ke,Ge=we+(Re-ke),We=Pt*ot/Se*De,nt=mt*ot/Se*De;Le.projectionMatrix.makePerspective(tt,Ge,We,nt,De,Se)}function $(Le,Xe){Xe===null?Le.matrixWorld.copy(Le.matrix):Le.matrixWorld.multiplyMatrices(Xe.matrixWorld,Le.matrix),Le.matrixWorldInverse.getInverse(Le.matrixWorld)}this.getCamera=function(Le){b.near=w.near=_.near=Le.near,b.far=w.far=_.far=Le.far,(E!==b.near||P!==b.far)&&(l.updateRenderState({depthNear:b.near,depthFar:b.far}),E=b.near,P=b.far);var Xe=Le.parent,Ne=b.cameras;$(b,Xe);for(var Re=0;Re<Ne.length;Re++)$(Ne[Re],Xe);Le.matrixWorld.copy(b.matrixWorld);for(var Ie=Le.children,Re=0,He=Ie.length;Re<He;Re++)Ie[Re].updateMatrixWorld(!0);return ie(b,_,w),b};var oe=null;function be(Le,Xe){if(f=Xe.getViewerPose(c),f!==null){var Ne=f.views,Re=l.renderState.baseLayer;e.setFramebuffer(Re.framebuffer);for(var Ie=0;Ie<Ne.length;Ie++){var He=Ne[Ie],Ue=Re.getViewport(He),ot=b.cameras[Ie];ot.matrix.fromArray(He.transform.matrix),ot.projectionMatrix.fromArray(He.projectionMatrix),ot.viewport.set(Ue.x,Ue.y,Ue.width,Ue.height),Ie===0&&b.matrix.copy(ot.matrix)}}for(var Pt=l.inputSources,Ie=0;Ie<r.length;Ie++){var mt=r[Ie],_t=Pt[Ie],ft=null,Vt=null;_t&&(mt.targetRay&&(ft=Xe.getPose(_t.targetRaySpace,c),ft!==null&&(mt.targetRay.matrix.fromArray(ft.transform.matrix),mt.targetRay.matrix.decompose(mt.targetRay.position,mt.targetRay.rotation,mt.targetRay.scale))),mt.grip&&_t.gripSpace&&(Vt=Xe.getPose(_t.gripSpace,c),Vt!==null&&(mt.grip.matrix.fromArray(Vt.transform.matrix),mt.grip.matrix.decompose(mt.grip.position,mt.grip.rotation,mt.grip.scale)))),mt.targetRay&&(mt.targetRay.visible=ft!==null),mt.grip&&(mt.grip.visible=Vt!==null)}oe&&oe(Le,Xe)}var fe=new ab;fe.setAnimationLoop(be),this.setAnimationLoop=function(Le){oe=Le},this.dispose=function(){}}Object.assign(Pb.prototype,Ba.prototype);function Cb(e){e=e||{};var t=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=e.context!==void 0?e.context:null,l=e.alpha!==void 0?e.alpha:!1,c=e.depth!==void 0?e.depth:!0,h=e.stencil!==void 0?e.stencil:!0,f=e.antialias!==void 0?e.antialias:!1,r=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,v=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,_=e.powerPreference!==void 0?e.powerPreference:"default",w=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,b=null,E=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=co,this.physicallyCorrectLights=!1,this.toneMapping=Zy,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var P=this,I=!1,F=null,B=0,O=0,W=null,Z=null,ie=-1,$={geometry:null,program:null,wireframe:!1},oe=null,be=null,fe=new wi,Le=new wi,Xe=null,Ne=t.width,Re=t.height,Ie=1,He=null,Ue=null,ot=new wi(0,0,Ne,Re),Pt=new wi(0,0,Ne,Re),mt=!1,_t=new nd,ft=new lI,Vt=!1,we=!1,pe=new Kn,ke=new xe;function De(){return W===null?Ie:1}var Se;try{var tt={alpha:l,depth:c,stencil:h,antialias:f,premultipliedAlpha:r,preserveDrawingBuffer:v,powerPreference:_,failIfMajorPerformanceCaveat:w,xrCompatible:!0};if(t.addEventListener("webglcontextlost",Xt,!1),t.addEventListener("webglcontextrestored",Ve,!1),Se=i||t.getContext("webgl",tt)||t.getContext("experimental-webgl",tt),Se===null)throw t.getContext("webgl")!==null?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");Se.getShaderPrecisionFormat===void 0&&(Se.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}var Ge,We,nt,je,lt,gt,Lt,sn,An,le,Ee,Et,wt,Mn,xn,un,bn;function Tn(){Ge=new cI(Se),We=new sI(Se,Ge,e),We.isWebGL2===!1&&(Ge.get("WEBGL_depth_texture"),Ge.get("OES_texture_float"),Ge.get("OES_texture_half_float"),Ge.get("OES_texture_half_float_linear"),Ge.get("OES_standard_derivatives"),Ge.get("OES_element_index_uint"),Ge.get("ANGLE_instanced_arrays")),Ge.get("OES_texture_float_linear"),bn=new EL(Se,Ge,We),nt=new SL(Se,Ge,We),nt.scissor(Le.copy(Pt).multiplyScalar(Ie).floor()),nt.viewport(fe.copy(ot).multiplyScalar(Ie).floor()),je=new dI,lt=new fL,gt=new TL(Se,Ge,nt,lt,We,bn,je),Lt=new NC(Se,We),sn=new uI(Se,Lt,je),An=new mI(Se,sn,Lt,je),Mn=new fI(Se),le=new pL(P,Ge,We),Ee=new yL,Et=new wL,wt=new oI(P,nt,An,r),xn=new aI(Se,Ge,je,We),un=new hI(Se,Ge,je,We),je.programs=le.programs,P.capabilities=We,P.extensions=Ge,P.properties=lt,P.renderLists=Ee,P.state=nt,P.info=je}Tn();var hn=new Pb(P,Se);this.xr=hn;var jt=new PL(P,Se),ln=new Eb(P,An,We.maxTextureSize);this.shadowMap=ln,this.getContext=function(){return Se},this.getContextAttributes=function(){return Se.getContextAttributes()},this.forceContextLoss=function(){var X=Ge.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){var X=Ge.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return Ie},this.setPixelRatio=function(X){X!==void 0&&(Ie=X,this.setSize(Ne,Re,!1))},this.getSize=function(X){return X===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),X=new Rt),X.set(Ne,Re)},this.setSize=function(X,ee,Te){if(hn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ne=X,Re=ee,t.width=Math.floor(X*Ie),t.height=Math.floor(ee*Ie),Te!==!1&&(t.style.width=X+"px",t.style.height=ee+"px"),this.setViewport(0,0,X,ee)},this.getDrawingBufferSize=function(X){return X===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),X=new Rt),X.set(Ne*Ie,Re*Ie).floor()},this.setDrawingBufferSize=function(X,ee,Te){Ne=X,Re=ee,Ie=Te,t.width=Math.floor(X*Te),t.height=Math.floor(ee*Te),this.setViewport(0,0,X,ee)},this.getCurrentViewport=function(X){return X===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),X=new wi),X.copy(fe)},this.getViewport=function(X){return X.copy(ot)},this.setViewport=function(X,ee,Te,me){X.isVector4?ot.set(X.x,X.y,X.z,X.w):ot.set(X,ee,Te,me),nt.viewport(fe.copy(ot).multiplyScalar(Ie).floor())},this.getScissor=function(X){return X.copy(Pt)},this.setScissor=function(X,ee,Te,me){X.isVector4?Pt.set(X.x,X.y,X.z,X.w):Pt.set(X,ee,Te,me),nt.scissor(Le.copy(Pt).multiplyScalar(Ie).floor())},this.getScissorTest=function(){return mt},this.setScissorTest=function(X){nt.setScissorTest(mt=X)},this.setOpaqueSort=function(X){He=X},this.setTransparentSort=function(X){Ue=X},this.getClearColor=function(){return wt.getClearColor()},this.setClearColor=function(){wt.setClearColor.apply(wt,arguments)},this.getClearAlpha=function(){return wt.getClearAlpha()},this.setClearAlpha=function(){wt.setClearAlpha.apply(wt,arguments)},this.clear=function(X,ee,Te){var me=0;(X===void 0||X)&&(me|=16384),(ee===void 0||ee)&&(me|=256),(Te===void 0||Te)&&(me|=1024),Se.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Xt,!1),t.removeEventListener("webglcontextrestored",Ve,!1),Ee.dispose(),Et.dispose(),lt.dispose(),An.dispose(),hn.dispose(),jn.stop()};function Xt(X){X.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function Ve(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1,Tn()}function Ot(X){var ee=X.target;ee.removeEventListener("dispose",Ot),en(ee)}function en(X){Ln(X),lt.remove(X)}function Ln(X){var ee=lt.get(X).program;X.program=void 0,ee!==void 0&&le.releaseProgram(ee)}function fn(X,ee){X.render(function(Te){P.renderBufferImmediate(Te,ee)})}this.renderBufferImmediate=function(X,ee){nt.initAttributes();var Te=lt.get(X);X.hasPositions&&!Te.position&&(Te.position=Se.createBuffer()),X.hasNormals&&!Te.normal&&(Te.normal=Se.createBuffer()),X.hasUvs&&!Te.uv&&(Te.uv=Se.createBuffer()),X.hasColors&&!Te.color&&(Te.color=Se.createBuffer());var me=ee.getAttributes();X.hasPositions&&(Se.bindBuffer(34962,Te.position),Se.bufferData(34962,X.positionArray,35048),nt.enableAttribute(me.position),Se.vertexAttribPointer(me.position,3,5126,!1,0,0)),X.hasNormals&&(Se.bindBuffer(34962,Te.normal),Se.bufferData(34962,X.normalArray,35048),nt.enableAttribute(me.normal),Se.vertexAttribPointer(me.normal,3,5126,!1,0,0)),X.hasUvs&&(Se.bindBuffer(34962,Te.uv),Se.bufferData(34962,X.uvArray,35048),nt.enableAttribute(me.uv),Se.vertexAttribPointer(me.uv,2,5126,!1,0,0)),X.hasColors&&(Se.bindBuffer(34962,Te.color),Se.bufferData(34962,X.colorArray,35048),nt.enableAttribute(me.color),Se.vertexAttribPointer(me.color,3,5126,!1,0,0)),nt.disableUnusedAttributes(),Se.drawArrays(4,0,X.count),X.count=0};var Gn=new Ua;this.renderBufferDirect=function(X,ee,Te,me,At,yt){ee===null&&(ee=Gn);var Nt=At.isMesh&&At.matrixWorld.determinant()<0,rn=Zr(X,ee,me,At);nt.setMaterial(me,Nt);var Fn=!1;($.geometry!==Te.id||$.program!==rn.id||$.wireframe!==(me.wireframe===!0))&&($.geometry=Te.id,$.program=rn.id,$.wireframe=me.wireframe===!0,Fn=!0),(me.morphTargets||me.morphNormals)&&(Mn.update(At,Te,me,rn),Fn=!0);var kn=Te.index,bt=Te.attributes.position;if(kn===null){if(bt===void 0||bt.count===0)return}else if(kn.count===0)return;var dn=1;me.wireframe===!0&&(kn=sn.getWireframeAttribute(Te),dn=2);var Jt,mn=xn;kn!==null&&(Jt=Lt.get(kn),mn=un,mn.setIndex(Jt)),Fn&&(qn(At,Te,me,rn),kn!==null&&Se.bindBuffer(34963,Jt.buffer));var En=kn!==null?kn.count:bt.count,Rn=Te.drawRange.start*dn,xi=Te.drawRange.count*dn,Fr=yt!==null?yt.start*dn:0,hi=yt!==null?yt.count*dn:1/0,fi=Math.max(Rn,Fr),di=Math.min(En,Rn+xi,Fr+hi)-1,Fs=Math.max(0,di-fi+1);if(Fs!==0){if(At.isMesh)me.wireframe===!0?(nt.setLineWidth(me.wireframeLinewidth*De()),mn.setMode(1)):mn.setMode(4);else if(At.isLine){var Ho=me.linewidth;Ho===void 0&&(Ho=1),nt.setLineWidth(Ho*De()),At.isLineSegments?mn.setMode(1):At.isLineLoop?mn.setMode(2):mn.setMode(3)}else At.isPoints?mn.setMode(0):At.isSprite&&mn.setMode(4);At.isInstancedMesh?mn.renderInstances(Te,fi,Fs,At.count):Te.isInstancedBufferGeometry?mn.renderInstances(Te,fi,Fs,Te.maxInstancedCount):mn.render(fi,Fs)}};function qn(X,ee,Te,me){if(!(We.isWebGL2===!1&&(X.isInstancedMesh||ee.isInstancedBufferGeometry)&&Ge.get("ANGLE_instanced_arrays")===null)){nt.initAttributes();var At=ee.attributes,yt=me.getAttributes(),Nt=Te.defaultAttributeValues;for(var rn in yt){var Fn=yt[rn];if(Fn>=0){var kn=At[rn];if(kn!==void 0){var bt=kn.normalized,dn=kn.itemSize,Jt=Lt.get(kn);if(Jt===void 0)continue;var mn=Jt.buffer,En=Jt.type,Rn=Jt.bytesPerElement;if(kn.isInterleavedBufferAttribute){var xi=kn.data,Fr=xi.stride,hi=kn.offset;xi&&xi.isInstancedInterleavedBuffer?(nt.enableAttributeAndDivisor(Fn,xi.meshPerAttribute),ee.maxInstancedCount===void 0&&(ee.maxInstancedCount=xi.meshPerAttribute*xi.count)):nt.enableAttribute(Fn),Se.bindBuffer(34962,mn),Se.vertexAttribPointer(Fn,dn,En,bt,Fr*Rn,hi*Rn)}else kn.isInstancedBufferAttribute?(nt.enableAttributeAndDivisor(Fn,kn.meshPerAttribute),ee.maxInstancedCount===void 0&&(ee.maxInstancedCount=kn.meshPerAttribute*kn.count)):nt.enableAttribute(Fn),Se.bindBuffer(34962,mn),Se.vertexAttribPointer(Fn,dn,En,bt,0,0)}else if(rn==="instanceMatrix"){var Jt=Lt.get(X.instanceMatrix);if(Jt===void 0)continue;var mn=Jt.buffer,En=Jt.type;nt.enableAttributeAndDivisor(Fn+0,1),nt.enableAttributeAndDivisor(Fn+1,1),nt.enableAttributeAndDivisor(Fn+2,1),nt.enableAttributeAndDivisor(Fn+3,1),Se.bindBuffer(34962,mn),Se.vertexAttribPointer(Fn+0,4,En,!1,64,0),Se.vertexAttribPointer(Fn+1,4,En,!1,64,16),Se.vertexAttribPointer(Fn+2,4,En,!1,64,32),Se.vertexAttribPointer(Fn+3,4,En,!1,64,48)}else if(Nt!==void 0){var fi=Nt[rn];if(fi!==void 0)switch(fi.length){case 2:Se.vertexAttrib2fv(Fn,fi);break;case 3:Se.vertexAttrib3fv(Fn,fi);break;case 4:Se.vertexAttrib4fv(Fn,fi);break;default:Se.vertexAttrib1fv(Fn,fi)}}}}nt.disableUnusedAttributes()}}this.compile=function(X,ee){E=Et.get(X,ee),E.init(),X.traverse(function(me){me.isLight&&(E.pushLight(me),me.castShadow&&E.pushShadow(me))}),E.setupLights(ee);var Te={};X.traverse(function(me){if(me.material)if(Array.isArray(me.material))for(var At=0;At<me.material.length;At++)me.material[At].uuid in Te||(Mi(me.material[At],X,me),Te[me.material[At].uuid]=!0);else me.material.uuid in Te||(Mi(me.material,X,me),Te[me.material.uuid]=!0)})};var Jn=null;function Ji(X){hn.isPresenting||Jn&&Jn(X)}var jn=new ab;jn.setAnimationLoop(Ji),typeof window!="undefined"&&jn.setContext(window),this.setAnimationLoop=function(X){Jn=X,hn.setAnimationLoop(X),jn.start()},this.render=function(X,ee){var Te,me;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Te=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),me=arguments[3]),!(ee&&ee.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!I){$.geometry=null,$.program=null,$.wireframe=!1,ie=-1,oe=null,X.autoUpdate===!0&&X.updateMatrixWorld(),ee.parent===null&&ee.updateMatrixWorld(),hn.enabled&&hn.isPresenting&&(ee=hn.getCamera(ee)),E=Et.get(X,ee),E.init(),X.onBeforeRender(P,X,ee,Te||W),pe.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),_t.setFromProjectionMatrix(pe),we=this.localClippingEnabled,Vt=ft.init(this.clippingPlanes,we,ee),b=Ee.get(X,ee),b.init(),ki(X,ee,0,P.sortObjects),P.sortObjects===!0&&b.sort(He,Ue),Vt&&ft.beginShadows();var At=E.state.shadowsArray;ln.render(At,X,ee),E.setupLights(ee),Vt&&ft.endShadows(),this.info.autoReset&&this.info.reset(),Te!==void 0&&this.setRenderTarget(Te),hn.enabled&&jt.isAvailable()&&jt.attachCamera(ee),wt.render(b,X,ee,me);var yt=b.opaque,Nt=b.transparent;if(X.overrideMaterial){var rn=X.overrideMaterial;yt.length&&oi(yt,X,ee,rn),Nt.length&&oi(Nt,X,ee,rn)}else yt.length&&oi(yt,X,ee),Nt.length&&oi(Nt,X,ee);X.onAfterRender(P,X,ee),W!==null&&(gt.updateRenderTargetMipmap(W),gt.updateMultisampleRenderTarget(W)),nt.buffers.depth.setTest(!0),nt.buffers.depth.setMask(!0),nt.buffers.color.setMask(!0),nt.setPolygonOffset(!1),hn.enabled&&jt.isAvailable()&&jt.detachCamera(ee),b=null,E=null}};function ki(X,ee,Te,me){if(X.visible!==!1){var At=X.layers.test(ee.layers);if(At){if(X.isGroup)Te=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(ee);else if(X.isLight)E.pushLight(X),X.castShadow&&E.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||_t.intersectsSprite(X)){me&&ke.setFromMatrixPosition(X.matrixWorld).applyMatrix4(pe);var yt=An.update(X),Nt=X.material;Nt.visible&&b.push(X,yt,Nt,Te,ke.z,null)}}else if(X.isImmediateRenderObject)me&&ke.setFromMatrixPosition(X.matrixWorld).applyMatrix4(pe),b.push(X,null,X.material,Te,ke.z,null);else if((X.isMesh||X.isLine||X.isPoints)&&(X.isSkinnedMesh&&X.skeleton.frame!==je.render.frame&&(X.skeleton.update(),X.skeleton.frame=je.render.frame),!X.frustumCulled||_t.intersectsObject(X))){me&&ke.setFromMatrixPosition(X.matrixWorld).applyMatrix4(pe);var yt=An.update(X),Nt=X.material;if(Array.isArray(Nt))for(var rn=yt.groups,Fn=0,kn=rn.length;Fn<kn;Fn++){var bt=rn[Fn],dn=Nt[bt.materialIndex];dn&&dn.visible&&b.push(X,yt,dn,Te,ke.z,bt)}else Nt.visible&&b.push(X,yt,Nt,Te,ke.z,null)}}for(var Jt=X.children,Fn=0,kn=Jt.length;Fn<kn;Fn++)ki(Jt[Fn],ee,Te,me)}}function oi(X,ee,Te,me){for(var At=0,yt=X.length;At<yt;At++){var Nt=X[At],rn=Nt.object,Fn=Nt.geometry,kn=me===void 0?Nt.material:me,bt=Nt.group;if(Te.isArrayCamera)if(be=Te,hn.enabled&&jt.isAvailable())or(rn,ee,Te,Fn,kn,bt);else for(var dn=Te.cameras,Jt=0,mn=dn.length;Jt<mn;Jt++){var En=dn[Jt];rn.layers.test(En.layers)&&(nt.viewport(fe.copy(En.viewport)),E.setupLights(En),or(rn,ee,En,Fn,kn,bt))}else be=null,or(rn,ee,Te,Fn,kn,bt)}}function or(X,ee,Te,me,At,yt){if(X.onBeforeRender(P,ee,Te,me,At,yt),E=Et.get(ee,be||Te),X.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),X.isImmediateRenderObject){var Nt=Zr(Te,ee,At,X);nt.setMaterial(At),$.geometry=null,$.program=null,$.wireframe=!1,fn(X,Nt)}else P.renderBufferDirect(Te,ee,me,At,X,yt);X.onAfterRender(P,ee,Te,me,At,yt),E=Et.get(ee,be||Te)}function Mi(X,ee,Te){var me=lt.get(X),At=E.state.lights,yt=E.state.shadowsArray,Nt=At.state.version,rn=le.getParameters(X,At.state,yt,ee,ft.numPlanes,ft.numIntersection,Te),Fn=le.getProgramCacheKey(rn),kn=me.program,bt=!0;if(kn===void 0)X.addEventListener("dispose",Ot);else if(kn.cacheKey!==Fn)Ln(X);else if(me.lightsStateVersion!==Nt)me.lightsStateVersion=Nt,bt=!1;else{if(rn.shaderID!==void 0)return;bt=!1}bt&&(kn=le.acquireProgram(rn,Fn),me.program=kn,me.uniforms=rn.uniforms,me.environment=X.isMeshStandardMaterial?ee.environment:null,me.outputEncoding=P.outputEncoding,X.program=kn);var dn=kn.getAttributes();if(X.morphTargets){X.numSupportedMorphTargets=0;for(var Jt=0;Jt<P.maxMorphTargets;Jt++)dn["morphTarget"+Jt]>=0&&X.numSupportedMorphTargets++}if(X.morphNormals){X.numSupportedMorphNormals=0;for(var Jt=0;Jt<P.maxMorphNormals;Jt++)dn["morphNormal"+Jt]>=0&&X.numSupportedMorphNormals++}var mn=me.uniforms;(!X.isShaderMaterial&&!X.isRawShaderMaterial||X.clipping===!0)&&(me.numClippingPlanes=ft.numPlanes,me.numIntersection=ft.numIntersection,mn.clippingPlanes=ft.uniform),me.fog=ee.fog,me.needsLights=vn(X),me.lightsStateVersion=Nt,me.needsLights&&(mn.ambientLightColor.value=At.state.ambient,mn.lightProbe.value=At.state.probe,mn.directionalLights.value=At.state.directional,mn.spotLights.value=At.state.spot,mn.rectAreaLights.value=At.state.rectArea,mn.pointLights.value=At.state.point,mn.hemisphereLights.value=At.state.hemi,mn.directionalShadowMap.value=At.state.directionalShadowMap,mn.directionalShadowMatrix.value=At.state.directionalShadowMatrix,mn.spotShadowMap.value=At.state.spotShadowMap,mn.spotShadowMatrix.value=At.state.spotShadowMatrix,mn.pointShadowMap.value=At.state.pointShadowMap,mn.pointShadowMatrix.value=At.state.pointShadowMatrix);var En=me.program.getUniforms(),Rn=ws.seqWithValue(En.seq,mn);me.uniformsList=Rn}function Zr(X,ee,Te,me){gt.resetTextureUnits();var At=ee.fog,yt=Te.isMeshStandardMaterial?ee.environment:null,Nt=lt.get(Te),rn=E.state.lights;if(Vt&&(we||X!==oe)){var Fn=X===oe&&Te.id===ie;ft.setState(Te.clippingPlanes,Te.clipIntersection,Te.clipShadows,X,Nt,Fn)}Te.version===Nt.__version?(Nt.program===void 0||Te.fog&&Nt.fog!==At||Nt.environment!==yt||Nt.needsLights&&Nt.lightsStateVersion!==rn.state.version||Nt.numClippingPlanes!==void 0&&(Nt.numClippingPlanes!==ft.numPlanes||Nt.numIntersection!==ft.numIntersection)||Nt.outputEncoding!==P.outputEncoding)&&Mi(Te,ee,me):(Mi(Te,ee,me),Nt.__version=Te.version);var kn=!1,bt=!1,dn=!1,Jt=Nt.program,mn=Jt.getUniforms(),En=Nt.uniforms;if(nt.useProgram(Jt.program)&&(kn=!0,bt=!0,dn=!0),Te.id!==ie&&(ie=Te.id,bt=!0),kn||oe!==X){if(Jt.numMultiviewViews>0?jt.updateCameraProjectionMatricesUniform(X,mn):mn.setValue(Se,"projectionMatrix",X.projectionMatrix),We.logarithmicDepthBuffer&&mn.setValue(Se,"logDepthBufFC",2/(Math.log(X.far+1)/Math.LN2)),oe!==X&&(oe=X,bt=!0,dn=!0),Te.isShaderMaterial||Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshStandardMaterial||Te.envMap){var Rn=mn.map.cameraPosition;Rn!==void 0&&Rn.setValue(Se,ke.setFromMatrixPosition(X.matrixWorld))}(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial)&&mn.setValue(Se,"isOrthographic",X.isOrthographicCamera===!0),(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial||Te.skinning)&&(Jt.numMultiviewViews>0?jt.updateCameraViewMatricesUniform(X,mn):mn.setValue(Se,"viewMatrix",X.matrixWorldInverse))}if(Te.skinning){mn.setOptional(Se,me,"bindMatrix"),mn.setOptional(Se,me,"bindMatrixInverse");var xi=me.skeleton;if(xi){var Fr=xi.bones;if(We.floatVertexTextures){if(xi.boneTexture===void 0){var hi=Math.sqrt(Fr.length*4);hi=Xn.ceilPowerOfTwo(hi),hi=Math.max(hi,4);var fi=new Float32Array(hi*hi*4);fi.set(xi.boneMatrices);var di=new Xc(fi,hi,hi,Uo,Gh);xi.boneMatrices=fi,xi.boneTexture=di,xi.boneTextureSize=hi}mn.setValue(Se,"boneTexture",xi.boneTexture,gt),mn.setValue(Se,"boneTextureSize",xi.boneTextureSize)}else mn.setOptional(Se,xi,"boneMatrices")}}return(bt||Nt.receiveShadow!==me.receiveShadow)&&(Nt.receiveShadow=me.receiveShadow,mn.setValue(Se,"receiveShadow",me.receiveShadow)),bt&&(mn.setValue(Se,"toneMappingExposure",P.toneMappingExposure),mn.setValue(Se,"toneMappingWhitePoint",P.toneMappingWhitePoint),Nt.needsLights&&St(En,dn),At&&Te.fog&&J(En,At),Te.isMeshBasicMaterial?Gi(En,Te):Te.isMeshLambertMaterial?(Gi(En,Te),ce(En,Te)):Te.isMeshToonMaterial?(Gi(En,Te),Fe(En,Te)):Te.isMeshPhongMaterial?(Gi(En,Te),Ae(En,Te)):Te.isMeshStandardMaterial?(Gi(En,Te,yt),Te.isMeshPhysicalMaterial?Je(En,Te,yt):Ze(En,Te,yt)):Te.isMeshMatcapMaterial?(Gi(En,Te),ze(En,Te)):Te.isMeshDepthMaterial?(Gi(En,Te),et(En,Te)):Te.isMeshDistanceMaterial?(Gi(En,Te),xt(En,Te)):Te.isMeshNormalMaterial?(Gi(En,Te),Gt(En,Te)):Te.isLineBasicMaterial?(Jr(En,Te),Te.isLineDashedMaterial&&Lr(En,Te)):Te.isPointsMaterial?de(En,Te):Te.isSpriteMaterial?q(En,Te):Te.isShadowMaterial&&(En.color.value.copy(Te.color),En.opacity.value=Te.opacity),En.ltc_1!==void 0&&(En.ltc_1.value=an.LTC_1),En.ltc_2!==void 0&&(En.ltc_2.value=an.LTC_2),ws.upload(Se,Nt.uniformsList,En,gt),Te.isShaderMaterial&&(Te.uniformsNeedUpdate=!1)),Te.isShaderMaterial&&Te.uniformsNeedUpdate===!0&&(ws.upload(Se,Nt.uniformsList,En,gt),Te.uniformsNeedUpdate=!1),Te.isSpriteMaterial&&mn.setValue(Se,"center",me.center),Jt.numMultiviewViews>0?jt.updateObjectMatricesUniforms(me,X,mn):(mn.setValue(Se,"modelViewMatrix",me.modelViewMatrix),mn.setValue(Se,"normalMatrix",me.normalMatrix)),mn.setValue(Se,"modelMatrix",me.matrixWorld),Jt}function Gi(X,ee,Te){X.opacity.value=ee.opacity,ee.color&&X.diffuse.value.copy(ee.color),ee.emissive&&X.emissive.value.copy(ee.emissive).multiplyScalar(ee.emissiveIntensity),ee.map&&(X.map.value=ee.map),ee.alphaMap&&(X.alphaMap.value=ee.alphaMap),ee.specularMap&&(X.specularMap.value=ee.specularMap);var me=ee.envMap||Te;me&&(X.envMap.value=me,X.flipEnvMap.value=me.isCubeTexture?-1:1,X.reflectivity.value=ee.reflectivity,X.refractionRatio.value=ee.refractionRatio,X.maxMipLevel.value=lt.get(me).__maxMipLevel),ee.lightMap&&(X.lightMap.value=ee.lightMap,X.lightMapIntensity.value=ee.lightMapIntensity),ee.aoMap&&(X.aoMap.value=ee.aoMap,X.aoMapIntensity.value=ee.aoMapIntensity);var At;ee.map?At=ee.map:ee.specularMap?At=ee.specularMap:ee.displacementMap?At=ee.displacementMap:ee.normalMap?At=ee.normalMap:ee.bumpMap?At=ee.bumpMap:ee.roughnessMap?At=ee.roughnessMap:ee.metalnessMap?At=ee.metalnessMap:ee.alphaMap?At=ee.alphaMap:ee.emissiveMap&&(At=ee.emissiveMap),At!==void 0&&(At.isWebGLRenderTarget&&(At=At.texture),At.matrixAutoUpdate===!0&&At.updateMatrix(),X.uvTransform.value.copy(At.matrix));var yt;ee.aoMap?yt=ee.aoMap:ee.lightMap&&(yt=ee.lightMap),yt!==void 0&&(yt.isWebGLRenderTarget&&(yt=yt.texture),yt.matrixAutoUpdate===!0&&yt.updateMatrix(),X.uv2Transform.value.copy(yt.matrix))}function Jr(X,ee){X.diffuse.value.copy(ee.color),X.opacity.value=ee.opacity}function Lr(X,ee){X.dashSize.value=ee.dashSize,X.totalSize.value=ee.dashSize+ee.gapSize,X.scale.value=ee.scale}function de(X,ee){X.diffuse.value.copy(ee.color),X.opacity.value=ee.opacity,X.size.value=ee.size*Ie,X.scale.value=Re*.5,ee.map&&(X.map.value=ee.map),ee.alphaMap&&(X.alphaMap.value=ee.alphaMap);var Te;ee.map?Te=ee.map:ee.alphaMap&&(Te=ee.alphaMap),Te!==void 0&&(Te.matrixAutoUpdate===!0&&Te.updateMatrix(),X.uvTransform.value.copy(Te.matrix))}function q(X,ee){X.diffuse.value.copy(ee.color),X.opacity.value=ee.opacity,X.rotation.value=ee.rotation,ee.map&&(X.map.value=ee.map),ee.alphaMap&&(X.alphaMap.value=ee.alphaMap);var Te;ee.map?Te=ee.map:ee.alphaMap&&(Te=ee.alphaMap),Te!==void 0&&(Te.matrixAutoUpdate===!0&&Te.updateMatrix(),X.uvTransform.value.copy(Te.matrix))}function J(X,ee){X.fogColor.value.copy(ee.color),ee.isFog?(X.fogNear.value=ee.near,X.fogFar.value=ee.far):ee.isFogExp2&&(X.fogDensity.value=ee.density)}function ce(X,ee){ee.emissiveMap&&(X.emissiveMap.value=ee.emissiveMap)}function Ae(X,ee){X.specular.value.copy(ee.specular),X.shininess.value=Math.max(ee.shininess,1e-4),ee.emissiveMap&&(X.emissiveMap.value=ee.emissiveMap),ee.bumpMap&&(X.bumpMap.value=ee.bumpMap,X.bumpScale.value=ee.bumpScale,ee.side===lr&&(X.bumpScale.value*=-1)),ee.normalMap&&(X.normalMap.value=ee.normalMap,X.normalScale.value.copy(ee.normalScale),ee.side===lr&&X.normalScale.value.negate()),ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias)}function Fe(X,ee){X.specular.value.copy(ee.specular),X.shininess.value=Math.max(ee.shininess,1e-4),ee.gradientMap&&(X.gradientMap.value=ee.gradientMap),ee.emissiveMap&&(X.emissiveMap.value=ee.emissiveMap),ee.bumpMap&&(X.bumpMap.value=ee.bumpMap,X.bumpScale.value=ee.bumpScale,ee.side===lr&&(X.bumpScale.value*=-1)),ee.normalMap&&(X.normalMap.value=ee.normalMap,X.normalScale.value.copy(ee.normalScale),ee.side===lr&&X.normalScale.value.negate()),ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias)}function Ze(X,ee,Te){X.roughness.value=ee.roughness,X.metalness.value=ee.metalness,ee.roughnessMap&&(X.roughnessMap.value=ee.roughnessMap),ee.metalnessMap&&(X.metalnessMap.value=ee.metalnessMap),ee.emissiveMap&&(X.emissiveMap.value=ee.emissiveMap),ee.bumpMap&&(X.bumpMap.value=ee.bumpMap,X.bumpScale.value=ee.bumpScale,ee.side===lr&&(X.bumpScale.value*=-1)),ee.normalMap&&(X.normalMap.value=ee.normalMap,X.normalScale.value.copy(ee.normalScale),ee.side===lr&&X.normalScale.value.negate()),ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias),(ee.envMap||Te)&&(X.envMapIntensity.value=ee.envMapIntensity)}function Je(X,ee,Te){Ze(X,ee,Te),X.reflectivity.value=ee.reflectivity,X.clearcoat.value=ee.clearcoat,X.clearcoatRoughness.value=ee.clearcoatRoughness,ee.sheen&&X.sheen.value.copy(ee.sheen),ee.clearcoatNormalMap&&(X.clearcoatNormalScale.value.copy(ee.clearcoatNormalScale),X.clearcoatNormalMap.value=ee.clearcoatNormalMap,ee.side===lr&&X.clearcoatNormalScale.value.negate()),X.transparency.value=ee.transparency}function ze(X,ee){ee.matcap&&(X.matcap.value=ee.matcap),ee.bumpMap&&(X.bumpMap.value=ee.bumpMap,X.bumpScale.value=ee.bumpScale,ee.side===lr&&(X.bumpScale.value*=-1)),ee.normalMap&&(X.normalMap.value=ee.normalMap,X.normalScale.value.copy(ee.normalScale),ee.side===lr&&X.normalScale.value.negate()),ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias)}function et(X,ee){ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias)}function xt(X,ee){ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias),X.referencePosition.value.copy(ee.referencePosition),X.nearDistance.value=ee.nearDistance,X.farDistance.value=ee.farDistance}function Gt(X,ee){ee.bumpMap&&(X.bumpMap.value=ee.bumpMap,X.bumpScale.value=ee.bumpScale,ee.side===lr&&(X.bumpScale.value*=-1)),ee.normalMap&&(X.normalMap.value=ee.normalMap,X.normalScale.value.copy(ee.normalScale),ee.side===lr&&X.normalScale.value.negate()),ee.displacementMap&&(X.displacementMap.value=ee.displacementMap,X.displacementScale.value=ee.displacementScale,X.displacementBias.value=ee.displacementBias)}function St(X,ee){X.ambientLightColor.needsUpdate=ee,X.lightProbe.needsUpdate=ee,X.directionalLights.needsUpdate=ee,X.pointLights.needsUpdate=ee,X.spotLights.needsUpdate=ee,X.rectAreaLights.needsUpdate=ee,X.hemisphereLights.needsUpdate=ee}function vn(X){return X.isMeshLambertMaterial||X.isMeshToonMaterial||X.isMeshPhongMaterial||X.isMeshStandardMaterial||X.isShadowMaterial||X.isShaderMaterial&&X.lights===!0}this.setFramebuffer=function(X){F!==X&&W===null&&Se.bindFramebuffer(36160,X),F=X},this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return W},this.setRenderTarget=function(X,ee,Te){W=X,B=ee,O=Te,X&&lt.get(X).__webglFramebuffer===void 0&&gt.setupRenderTarget(X);var me=F,At=!1;if(X){var yt=lt.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(me=yt[ee||0],At=!0):X.isWebGLMultisampleRenderTarget?me=lt.get(X).__webglMultisampledFramebuffer:me=yt,fe.copy(X.viewport),Le.copy(X.scissor),Xe=X.scissorTest}else fe.copy(ot).multiplyScalar(Ie).floor(),Le.copy(Pt).multiplyScalar(Ie).floor(),Xe=mt;if(Z!==me&&(Se.bindFramebuffer(36160,me),Z=me),nt.viewport(fe),nt.scissor(Le),nt.setScissorTest(Xe),At){var Nt=lt.get(X.texture);Se.framebufferTexture2D(36160,36064,34069+(ee||0),Nt.__webglTexture,Te||0)}},this.readRenderTargetPixels=function(X,ee,Te,me,At,yt,Nt){if(!(X&&X.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var rn=lt.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&Nt!==void 0&&(rn=rn[Nt]),rn){var Fn=!1;rn!==Z&&(Se.bindFramebuffer(36160,rn),Fn=!0);try{var kn=X.texture,bt=kn.format,dn=kn.type;if(bt!==Uo&&bn.convert(bt)!==Se.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(dn!==Cf&&bn.convert(dn)!==Se.getParameter(35738)&&!(dn===Gh&&(We.isWebGL2||Ge.get("OES_texture_float")||Ge.get("WEBGL_color_buffer_float")))&&!(dn===i0&&(We.isWebGL2?Ge.get("EXT_color_buffer_float"):Ge.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Se.checkFramebufferStatus(36160)===36053?ee>=0&&ee<=X.width-me&&Te>=0&&Te<=X.height-At&&Se.readPixels(ee,Te,me,At,bn.convert(bt),bn.convert(dn),yt):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Fn&&Se.bindFramebuffer(36160,Z)}}},this.copyFramebufferToTexture=function(X,ee,Te){Te===void 0&&(Te=0);var me=Math.pow(2,-Te),At=Math.floor(ee.image.width*me),yt=Math.floor(ee.image.height*me),Nt=bn.convert(ee.format);gt.setTexture2D(ee,0),Se.copyTexImage2D(3553,Te,Nt,X.x,X.y,At,yt,0),nt.unbindTexture()},this.copyTextureToTexture=function(X,ee,Te,me){var At=ee.image.width,yt=ee.image.height,Nt=bn.convert(Te.format),rn=bn.convert(Te.type);gt.setTexture2D(Te,0),ee.isDataTexture?Se.texSubImage2D(3553,me||0,X.x,X.y,At,yt,Nt,rn,ee.image.data):Se.texSubImage2D(3553,me||0,X.x,X.y,Nt,rn,ee.image),nt.unbindTexture()},this.initTexture=function(X){gt.setTexture2D(X,0),nt.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function B0(e,t){this.name="",this.color=new nn(e),this.density=t!==void 0?t:25e-5}Object.assign(B0.prototype,{isFogExp2:!0,clone:function(){return new B0(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});function z0(e,t,i){this.name="",this.color=new nn(e),this.near=t!==void 0?t:1,this.far=i!==void 0?i:1e3}Object.assign(z0.prototype,{isFog:!0,clone:function(){return new z0(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}});function qa(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Lf,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(qa.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(qa.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var l=0,c=this.stride;l<c;l++)this.array[e+l]=t.array[i+l];return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var Ml=new xe;function sd(e,t,i,l){this.data=e,this.itemSize=t,this.offset=i,this.normalized=l===!0}Object.defineProperties(sd.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(sd.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,i=this.data.count;t<i;t++)Ml.x=this.getX(t),Ml.y=this.getY(t),Ml.z=this.getZ(t),Ml.applyMatrix4(e),this.setXYZ(t,Ml.x,Ml.y,Ml.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,l){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=l,this},setXYZW:function(e,t,i,l,c){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=l,this.data.array[e+3]=c,this}});function Sl(e){zn.call(this),this.type="SpriteMaterial",this.color=new nn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Sl.prototype=Object.create(zn.prototype),Sl.prototype.constructor=Sl,Sl.prototype.isSpriteMaterial=!0,Sl.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Qc,ld=new xe,$c=new xe,eu=new xe,tu=new Rt,cd=new Rt,Rb=new Kn,Qf=new xe,ud=new xe,$f=new xe,Db=new Rt,U0=new Rt,Ib=new Rt;function N0(e){if(on.call(this),this.type="Sprite",Qc===void 0){Qc=new _n;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new qa(t,5);Qc.setIndex([0,1,2,0,2,3]),Qc.setAttribute("position",new sd(i,3,0,!1)),Qc.setAttribute("uv",new sd(i,2,3,!1))}this.geometry=Qc,this.material=e!==void 0?e:new Sl,this.center=new Rt(.5,.5)}N0.prototype=Object.assign(Object.create(on.prototype),{constructor:N0,isSprite:!0,raycast:function(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$c.setFromMatrixScale(this.matrixWorld),Rb.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),eu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&$c.multiplyScalar(-eu.z);var i=this.material.rotation,l,c;i!==0&&(c=Math.cos(i),l=Math.sin(i));var h=this.center;em(Qf.set(-.5,-.5,0),eu,h,$c,l,c),em(ud.set(.5,-.5,0),eu,h,$c,l,c),em($f.set(.5,.5,0),eu,h,$c,l,c),Db.set(0,0),U0.set(1,0),Ib.set(1,1);var f=e.ray.intersectTriangle(Qf,ud,$f,!1,ld);if(!(f===null&&(em(ud.set(-.5,.5,0),eu,h,$c,l,c),U0.set(0,1),f=e.ray.intersectTriangle(Qf,$f,ud,!1,ld),f===null))){var r=e.ray.origin.distanceTo(ld);r<e.near||r>e.far||t.push({distance:r,point:ld.clone(),uv:gr.getUV(ld,Qf,ud,$f,Db,U0,Ib,new Rt),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return on.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});function em(e,t,i,l,c,h){tu.subVectors(e,i).addScalar(.5).multiply(l),c!==void 0?(cd.x=h*tu.x-c*tu.y,cd.y=c*tu.x+h*tu.y):cd.copy(tu),e.copy(t),e.x+=cd.x,e.y+=cd.y,e.applyMatrix4(Rb)}var tm=new xe,Lb=new xe;function nm(){on.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}nm.prototype=Object.assign(Object.create(on.prototype),{constructor:nm,isLOD:!0,copy:function(e){on.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,l=t.length;i<l;i++){var c=t[i];this.addLevel(c.object.clone(),c.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){t===void 0&&(t=0),t=Math.abs(t);for(var i=this.levels,l=0;l<i.length&&!(t<i[l].distance);l++);return i.splice(l,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){for(var i=1,l=t.length;i<l&&!(e<t[i].distance);i++);return t[i-1].object}return null},raycast:function(e,t){var i=this.levels;if(i.length>0){tm.setFromMatrixPosition(this.matrixWorld);var l=e.ray.origin.distanceTo(tm);this.getObjectForDistance(l).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){tm.setFromMatrixPosition(e.matrixWorld),Lb.setFromMatrixPosition(this.matrixWorld);var i=tm.distanceTo(Lb);t[0].object.visible=!0;for(var l=1,c=t.length;l<c&&i>=t[l].distance;l++)t[l-1].object.visible=!1,t[l].object.visible=!0;for(;l<c;l++)t[l].object.visible=!1}},toJSON:function(e){var t=on.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];for(var i=this.levels,l=0,c=i.length;l<c;l++){var h=i[l];t.object.levels.push({object:h.object.uuid,distance:h.distance})}return t}});function hd(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Fi.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Kn,this.bindMatrixInverse=new Kn}hd.prototype=Object.assign(Object.create(Fi.prototype),{constructor:hd,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new wi,t=this.geometry.attributes.skinWeight,i=0,l=t.count;i<l;i++){e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.w=t.getW(i);var c=1/e.manhattanLength();c!==1/0?e.multiplyScalar(c):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Fi.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Fb=new Kn,CL=new Kn;function im(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,t===void 0)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,l=this.bones.length;i<l;i++)this.boneInverses.push(new Kn)}}Object.assign(im.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var i=new Kn;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},pose:function(){var e,t,i;for(t=0,i=this.bones.length;t<i;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)e=this.bones[t],e&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,i=this.boneMatrices,l=this.boneTexture,c=0,h=e.length;c<h;c++){var f=e[c]?e[c].matrixWorld:CL;Fb.multiplyMatrices(f,t[c]),Fb.toArray(i,c*16)}l!==void 0&&(l.needsUpdate=!0)},clone:function(){return new im(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,i=this.bones.length;t<i;t++){var l=this.bones[t];if(l.name===e)return l}}});function V0(){on.call(this),this.type="Bone"}V0.prototype=Object.assign(Object.create(on.prototype),{constructor:V0,isBone:!0});var kb=new Kn,Bb=new Kn,nu=[],dd=new Fi;function O0(e,t,i){Fi.call(this,e,t),this.instanceMatrix=new Un(new Float32Array(i*16),16),this.count=i,this.frustumCulled=!1}O0.prototype=Object.assign(Object.create(Fi.prototype),{constructor:O0,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,e*16)},raycast:function(e,t){var i=this.matrixWorld,l=this.count;if(dd.geometry=this.geometry,dd.material=this.material,dd.material!==void 0)for(var c=0;c<l;c++)this.getMatrixAt(c,kb),Bb.multiplyMatrices(i,kb),dd.matrixWorld=Bb,dd.raycast(e,nu),nu.length>0&&(nu[0].instanceId=c,nu[0].object=this,t.push(nu[0]),nu.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){}});function Vi(e){zn.call(this),this.type="LineBasicMaterial",this.color=new nn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}Vi.prototype=Object.create(zn.prototype),Vi.prototype.constructor=Vi,Vi.prototype.isLineBasicMaterial=!0,Vi.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var zb=new xe,Ub=new xe,Nb=new Kn,rm=new zc,om=new Va;function fo(e,t,i){i===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),on.call(this),this.type="Line",this.geometry=e!==void 0?e:new _n,this.material=t!==void 0?t:new Vi}fo.prototype=Object.assign(Object.create(on.prototype),{constructor:fo,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,i=[0],l=1,c=t.count;l<c;l++)zb.fromBufferAttribute(t,l-1),Ub.fromBufferAttribute(t,l),i[l]=i[l-1],i[l]+=zb.distanceTo(Ub);e.setAttribute("lineDistance",new cn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var h=e.vertices,i=e.lineDistances;i[0]=0;for(var l=1,c=h.length;l<c;l++)i[l]=i[l-1],i[l]+=h[l-1].distanceTo(h[l])}return this},raycast:function(e,t){var i=e.linePrecision,l=this.geometry,c=this.matrixWorld;if(l.boundingSphere===null&&l.computeBoundingSphere(),om.copy(l.boundingSphere),om.applyMatrix4(c),om.radius+=i,e.ray.intersectsSphere(om)!==!1){Nb.getInverse(c),rm.copy(e.ray).applyMatrix4(Nb);var h=i/((this.scale.x+this.scale.y+this.scale.z)/3),f=h*h,r=new xe,v=new xe,_=new xe,w=new xe,b=this&&this.isLineSegments?2:1;if(l.isBufferGeometry){var E=l.index,P=l.attributes,I=P.position.array;if(E!==null)for(var F=E.array,B=0,O=F.length-1;B<O;B+=b){var W=F[B],Z=F[B+1];r.fromArray(I,W*3),v.fromArray(I,Z*3);var ie=rm.distanceSqToSegment(r,v,w,_);if(!(ie>f)){w.applyMatrix4(this.matrixWorld);var $=e.ray.origin.distanceTo(w);$<e.near||$>e.far||t.push({distance:$,point:_.clone().applyMatrix4(this.matrixWorld),index:B,face:null,faceIndex:null,object:this})}}else for(var B=0,O=I.length/3-1;B<O;B+=b){r.fromArray(I,3*B),v.fromArray(I,3*B+3);var ie=rm.distanceSqToSegment(r,v,w,_);if(!(ie>f)){w.applyMatrix4(this.matrixWorld);var $=e.ray.origin.distanceTo(w);$<e.near||$>e.far||t.push({distance:$,point:_.clone().applyMatrix4(this.matrixWorld),index:B,face:null,faceIndex:null,object:this})}}}else if(l.isGeometry)for(var oe=l.vertices,be=oe.length,B=0;B<be-1;B+=b){var ie=rm.distanceSqToSegment(oe[B],oe[B+1],w,_);if(!(ie>f)){w.applyMatrix4(this.matrixWorld);var $=e.ray.origin.distanceTo(w);$<e.near||$>e.far||t.push({distance:$,point:_.clone().applyMatrix4(this.matrixWorld),index:B,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var am=new xe,sm=new xe;function Xi(e,t){fo.call(this,e,t),this.type="LineSegments"}Xi.prototype=Object.assign(Object.create(fo.prototype),{constructor:Xi,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,i=[],l=0,c=t.count;l<c;l+=2)am.fromBufferAttribute(t,l),sm.fromBufferAttribute(t,l+1),i[l]=l===0?0:i[l-1],i[l+1]=i[l]+am.distanceTo(sm);e.setAttribute("lineDistance",new cn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var h=e.vertices,i=e.lineDistances,l=0,c=h.length;l<c;l+=2)am.copy(h[l]),sm.copy(h[l+1]),i[l]=l===0?0:i[l-1],i[l+1]=i[l]+am.distanceTo(sm);return this}});function lm(e,t){fo.call(this,e,t),this.type="LineLoop"}lm.prototype=Object.assign(Object.create(fo.prototype),{constructor:lm,isLineLoop:!0});function As(e){zn.call(this),this.type="PointsMaterial",this.color=new nn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}As.prototype=Object.create(zn.prototype),As.prototype.constructor=As,As.prototype.isPointsMaterial=!0,As.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var Vb=new Kn,G0=new zc,cm=new Va,um=new xe;function hm(e,t){on.call(this),this.type="Points",this.geometry=e!==void 0?e:new _n,this.material=t!==void 0?t:new As,this.updateMorphTargets()}hm.prototype=Object.assign(Object.create(on.prototype),{constructor:hm,isPoints:!0,raycast:function(e,t){var i=this.geometry,l=this.matrixWorld,c=e.params.Points.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),cm.copy(i.boundingSphere),cm.applyMatrix4(l),cm.radius+=c,e.ray.intersectsSphere(cm)!==!1){Vb.getInverse(l),G0.copy(e.ray).applyMatrix4(Vb);var h=c/((this.scale.x+this.scale.y+this.scale.z)/3),f=h*h;if(i.isBufferGeometry){var r=i.index,v=i.attributes,_=v.position.array;if(r!==null)for(var w=r.array,b=0,E=w.length;b<E;b++){var P=w[b];um.fromArray(_,P*3),j0(um,P,f,l,e,t,this)}else for(var b=0,I=_.length/3;b<I;b++)um.fromArray(_,b*3),j0(um,b,f,l,e,t,this)}else for(var F=i.vertices,b=0,I=F.length;b<I;b++)j0(F[b],b,f,l,e,t,this)}},updateMorphTargets:function(){var e=this.geometry,t,i,l;if(e.isBufferGeometry){var c=e.morphAttributes,h=Object.keys(c);if(h.length>0){var f=c[h[0]];if(f!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,i=f.length;t<i;t++)l=f[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=t}}else{var r=e.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function j0(e,t,i,l,c,h,f){var r=G0.distanceSqToPoint(e);if(r<i){var v=new xe;G0.closestPointToPoint(e,v),v.applyMatrix4(l);var _=c.ray.origin.distanceTo(v);if(_<c.near||_>c.far)return;h.push({distance:_,distanceToRay:Math.sqrt(r),point:v,index:t,face:null,object:f})}}function Ob(e,t,i,l,c,h,f,r,v){bi.call(this,e,t,i,l,c,h,f,r,v),this.format=f!==void 0?f:ka,this.minFilter=h!==void 0?h:$i,this.magFilter=c!==void 0?c:$i,this.generateMipmaps=!1}Ob.prototype=Object.assign(Object.create(bi.prototype),{constructor:Ob,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function pd(e,t,i,l,c,h,f,r,v,_,w,b){bi.call(this,null,h,f,r,v,_,l,c,w,b),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}pd.prototype=Object.create(bi.prototype),pd.prototype.constructor=pd,pd.prototype.isCompressedTexture=!0;function dm(e,t,i,l,c,h,f,r,v){bi.call(this,e,t,i,l,c,h,f,r,v),this.needsUpdate=!0}dm.prototype=Object.create(bi.prototype),dm.prototype.constructor=dm,dm.prototype.isCanvasTexture=!0;function pm(e,t,i,l,c,h,f,r,v,_){if(_=_!==void 0?_:Tc,_!==Tc&&_!==jh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&_===Tc&&(i=Rf),i===void 0&&_===jh&&(i=Df),bi.call(this,null,l,c,h,f,r,_,i,v),this.image={width:e,height:t},this.magFilter=f!==void 0?f:Yi,this.minFilter=r!==void 0?r:Yi,this.flipY=!1,this.generateMipmaps=!1}pm.prototype=Object.create(bi.prototype),pm.prototype.constructor=pm,pm.prototype.isDepthTexture=!0;function fm(e){_n.call(this),this.type="WireframeGeometry";var t=[],i,l,c,h,f,r=[0,0],v={},_,w,b,E,P=["a","b","c"],I;if(e&&e.isGeometry){var F=e.faces;for(i=0,c=F.length;i<c;i++){var B=F[i];for(l=0;l<3;l++)w=B[P[l]],b=B[P[(l+1)%3]],r[0]=Math.min(w,b),r[1]=Math.max(w,b),E=r[0]+","+r[1],v[E]===void 0&&(v[E]={index1:r[0],index2:r[1]})}for(E in v)_=v[E],I=e.vertices[_.index1],t.push(I.x,I.y,I.z),I=e.vertices[_.index2],t.push(I.x,I.y,I.z)}else if(e&&e.isBufferGeometry){var O,W,Z,ie,$,oe,be,fe;if(I=new xe,e.index!==null){for(O=e.attributes.position,W=e.index,Z=e.groups,Z.length===0&&(Z=[{start:0,count:W.count,materialIndex:0}]),h=0,f=Z.length;h<f;++h)for(ie=Z[h],$=ie.start,oe=ie.count,i=$,c=$+oe;i<c;i+=3)for(l=0;l<3;l++)w=W.getX(i+l),b=W.getX(i+(l+1)%3),r[0]=Math.min(w,b),r[1]=Math.max(w,b),E=r[0]+","+r[1],v[E]===void 0&&(v[E]={index1:r[0],index2:r[1]});for(E in v)_=v[E],I.fromBufferAttribute(O,_.index1),t.push(I.x,I.y,I.z),I.fromBufferAttribute(O,_.index2),t.push(I.x,I.y,I.z)}else for(O=e.attributes.position,i=0,c=O.count/3;i<c;i++)for(l=0;l<3;l++)be=3*i+l,I.fromBufferAttribute(O,be),t.push(I.x,I.y,I.z),fe=3*i+(l+1)%3,I.fromBufferAttribute(O,fe),t.push(I.x,I.y,I.z)}this.setAttribute("position",new cn(t,3))}fm.prototype=Object.create(_n.prototype),fm.prototype.constructor=fm;function mm(e,t,i){On.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i},this.fromBufferGeometry(new fd(e,t,i)),this.mergeVertices()}mm.prototype=Object.create(On.prototype),mm.prototype.constructor=mm;function fd(e,t,i){_n.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:i};var l=[],c=[],h=[],f=[],r=1e-5,v=new xe,_=new xe,w=new xe,b=new xe,E=new xe,P,I;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var F=t+1;for(P=0;P<=i;P++){var B=P/i;for(I=0;I<=t;I++){var O=I/t;e(O,B,_),c.push(_.x,_.y,_.z),O-r>=0?(e(O-r,B,w),b.subVectors(_,w)):(e(O+r,B,w),b.subVectors(w,_)),B-r>=0?(e(O,B-r,w),E.subVectors(_,w)):(e(O,B+r,w),E.subVectors(w,_)),v.crossVectors(b,E).normalize(),h.push(v.x,v.y,v.z),f.push(O,B)}}for(P=0;P<i;P++)for(I=0;I<t;I++){var W=P*F+I,Z=P*F+I+1,ie=(P+1)*F+I+1,$=(P+1)*F+I;l.push(W,Z,$),l.push(Z,ie,$)}this.setIndex(l),this.setAttribute("position",new cn(c,3)),this.setAttribute("normal",new cn(h,3)),this.setAttribute("uv",new cn(f,2))}fd.prototype=Object.create(_n.prototype),fd.prototype.constructor=fd;function gm(e,t,i,l){On.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:l},this.fromBufferGeometry(new mo(e,t,i,l)),this.mergeVertices()}gm.prototype=Object.create(On.prototype),gm.prototype.constructor=gm;function mo(e,t,i,l){_n.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:l},i=i||1,l=l||0;var c=[],h=[];f(l),v(i),_(),this.setAttribute("position",new cn(c,3)),this.setAttribute("normal",new cn(c.slice(),3)),this.setAttribute("uv",new cn(h,2)),l===0?this.computeVertexNormals():this.normalizeNormals();function f(O){for(var W=new xe,Z=new xe,ie=new xe,$=0;$<t.length;$+=3)E(t[$+0],W),E(t[$+1],Z),E(t[$+2],ie),r(W,Z,ie,O)}function r(O,W,Z,ie){var $=Math.pow(2,ie),oe=[],be,fe;for(be=0;be<=$;be++){oe[be]=[];var Le=O.clone().lerp(Z,be/$),Xe=W.clone().lerp(Z,be/$),Ne=$-be;for(fe=0;fe<=Ne;fe++)fe===0&&be===$?oe[be][fe]=Le:oe[be][fe]=Le.clone().lerp(Xe,fe/Ne)}for(be=0;be<$;be++)for(fe=0;fe<2*($-be)-1;fe++){var Re=Math.floor(fe/2);fe%2===0?(b(oe[be][Re+1]),b(oe[be+1][Re]),b(oe[be][Re])):(b(oe[be][Re+1]),b(oe[be+1][Re+1]),b(oe[be+1][Re]))}}function v(O){for(var W=new xe,Z=0;Z<c.length;Z+=3)W.x=c[Z+0],W.y=c[Z+1],W.z=c[Z+2],W.normalize().multiplyScalar(O),c[Z+0]=W.x,c[Z+1]=W.y,c[Z+2]=W.z}function _(){for(var O=new xe,W=0;W<c.length;W+=3){O.x=c[W+0],O.y=c[W+1],O.z=c[W+2];var Z=F(O)/2/Math.PI+.5,ie=B(O)/Math.PI+.5;h.push(Z,1-ie)}P(),w()}function w(){for(var O=0;O<h.length;O+=6){var W=h[O+0],Z=h[O+2],ie=h[O+4],$=Math.max(W,Z,ie),oe=Math.min(W,Z,ie);$>.9&&oe<.1&&(W<.2&&(h[O+0]+=1),Z<.2&&(h[O+2]+=1),ie<.2&&(h[O+4]+=1))}}function b(O){c.push(O.x,O.y,O.z)}function E(O,W){var Z=O*3;W.x=e[Z+0],W.y=e[Z+1],W.z=e[Z+2]}function P(){for(var O=new xe,W=new xe,Z=new xe,ie=new xe,$=new Rt,oe=new Rt,be=new Rt,fe=0,Le=0;fe<c.length;fe+=9,Le+=6){O.set(c[fe+0],c[fe+1],c[fe+2]),W.set(c[fe+3],c[fe+4],c[fe+5]),Z.set(c[fe+6],c[fe+7],c[fe+8]),$.set(h[Le+0],h[Le+1]),oe.set(h[Le+2],h[Le+3]),be.set(h[Le+4],h[Le+5]),ie.copy(O).add(W).add(Z).divideScalar(3);var Xe=F(ie);I($,Le+0,O,Xe),I(oe,Le+2,W,Xe),I(be,Le+4,Z,Xe)}}function I(O,W,Z,ie){ie<0&&O.x===1&&(h[W]=O.x-1),Z.x===0&&Z.z===0&&(h[W]=ie/2/Math.PI+.5)}function F(O){return Math.atan2(O.z,-O.x)}function B(O){return Math.atan2(-O.y,Math.sqrt(O.x*O.x+O.z*O.z))}}mo.prototype=Object.create(_n.prototype),mo.prototype.constructor=mo;function ym(e,t){On.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new md(e,t)),this.mergeVertices()}ym.prototype=Object.create(On.prototype),ym.prototype.constructor=ym;function md(e,t){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],l=[2,1,0,0,3,2,1,3,0,2,3,1];mo.call(this,i,l,e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}md.prototype=Object.create(mo.prototype),md.prototype.constructor=md;function xm(e,t){On.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new iu(e,t)),this.mergeVertices()}xm.prototype=Object.create(On.prototype),xm.prototype.constructor=xm;function iu(e,t){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],l=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];mo.call(this,i,l,e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}iu.prototype=Object.create(mo.prototype),iu.prototype.constructor=iu;function vm(e,t){On.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new gd(e,t)),this.mergeVertices()}vm.prototype=Object.create(On.prototype),vm.prototype.constructor=vm;function gd(e,t){var i=(1+Math.sqrt(5))/2,l=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];mo.call(this,l,c,e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}gd.prototype=Object.create(mo.prototype),gd.prototype.constructor=gd;function _m(e,t){On.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new yd(e,t)),this.mergeVertices()}_m.prototype=Object.create(On.prototype),_m.prototype.constructor=_m;function yd(e,t){var i=(1+Math.sqrt(5))/2,l=1/i,c=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-l,-i,0,-l,i,0,l,-i,0,l,i,-l,-i,0,-l,i,0,l,-i,0,l,i,0,-i,0,-l,i,0,-l,-i,0,l,i,0,l],h=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];mo.call(this,c,h,e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}yd.prototype=Object.create(mo.prototype),yd.prototype.constructor=yd;function bm(e,t,i,l,c,h){On.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:l,closed:c},h!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var f=new ru(e,t,i,l,c);this.tangents=f.tangents,this.normals=f.normals,this.binormals=f.binormals,this.fromBufferGeometry(f),this.mergeVertices()}bm.prototype=Object.create(On.prototype),bm.prototype.constructor=bm;function ru(e,t,i,l,c){_n.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:l,closed:c},t=t||64,i=i||1,l=l||8,c=c||!1;var h=e.computeFrenetFrames(t,c);this.tangents=h.tangents,this.normals=h.normals,this.binormals=h.binormals;var f=new xe,r=new xe,v=new Rt,_=new xe,w,b,E=[],P=[],I=[],F=[];B(),this.setIndex(F),this.setAttribute("position",new cn(E,3)),this.setAttribute("normal",new cn(P,3)),this.setAttribute("uv",new cn(I,2));function B(){for(w=0;w<t;w++)O(w);O(c===!1?t:0),Z(),W()}function O(ie){_=e.getPointAt(ie/t,_);var $=h.normals[ie],oe=h.binormals[ie];for(b=0;b<=l;b++){var be=b/l*Math.PI*2,fe=Math.sin(be),Le=-Math.cos(be);r.x=Le*$.x+fe*oe.x,r.y=Le*$.y+fe*oe.y,r.z=Le*$.z+fe*oe.z,r.normalize(),P.push(r.x,r.y,r.z),f.x=_.x+i*r.x,f.y=_.y+i*r.y,f.z=_.z+i*r.z,E.push(f.x,f.y,f.z)}}function W(){for(b=1;b<=t;b++)for(w=1;w<=l;w++){var ie=(l+1)*(b-1)+(w-1),$=(l+1)*b+(w-1),oe=(l+1)*b+w,be=(l+1)*(b-1)+w;F.push(ie,$,be),F.push($,oe,be)}}function Z(){for(w=0;w<=t;w++)for(b=0;b<=l;b++)v.x=w/t,v.y=b/l,I.push(v.x,v.y)}}ru.prototype=Object.create(_n.prototype),ru.prototype.constructor=ru,ru.prototype.toJSON=function(){var e=_n.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e};function wm(e,t,i,l,c,h,f){On.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:l,p:c,q:h},f!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new xd(e,t,i,l,c,h)),this.mergeVertices()}wm.prototype=Object.create(On.prototype),wm.prototype.constructor=wm;function xd(e,t,i,l,c,h){_n.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:l,p:c,q:h},e=e||1,t=t||.4,i=Math.floor(i)||64,l=Math.floor(l)||8,c=c||2,h=h||3;var f=[],r=[],v=[],_=[],w,b,E=new xe,P=new xe,I=new xe,F=new xe,B=new xe,O=new xe,W=new xe;for(w=0;w<=i;++w){var Z=w/i*c*Math.PI*2;for(Ne(Z,c,h,e,I),Ne(Z+.01,c,h,e,F),O.subVectors(F,I),W.addVectors(F,I),B.crossVectors(O,W),W.crossVectors(B,O),B.normalize(),W.normalize(),b=0;b<=l;++b){var ie=b/l*Math.PI*2,$=-t*Math.cos(ie),oe=t*Math.sin(ie);E.x=I.x+($*W.x+oe*B.x),E.y=I.y+($*W.y+oe*B.y),E.z=I.z+($*W.z+oe*B.z),r.push(E.x,E.y,E.z),P.subVectors(E,I).normalize(),v.push(P.x,P.y,P.z),_.push(w/i),_.push(b/l)}}for(b=1;b<=i;b++)for(w=1;w<=l;w++){var be=(l+1)*(b-1)+(w-1),fe=(l+1)*b+(w-1),Le=(l+1)*b+w,Xe=(l+1)*(b-1)+w;f.push(be,fe,Xe),f.push(fe,Le,Xe)}this.setIndex(f),this.setAttribute("position",new cn(r,3)),this.setAttribute("normal",new cn(v,3)),this.setAttribute("uv",new cn(_,2));function Ne(Re,Ie,He,Ue,ot){var Pt=Math.cos(Re),mt=Math.sin(Re),_t=He/Ie*Re,ft=Math.cos(_t);ot.x=Ue*(2+ft)*.5*Pt,ot.y=Ue*(2+ft)*mt*.5,ot.z=Ue*Math.sin(_t)*.5}}xd.prototype=Object.create(_n.prototype),xd.prototype.constructor=xd;function Am(e,t,i,l,c){On.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:l,arc:c},this.fromBufferGeometry(new vd(e,t,i,l,c)),this.mergeVertices()}Am.prototype=Object.create(On.prototype),Am.prototype.constructor=Am;function vd(e,t,i,l,c){_n.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:l,arc:c},e=e||1,t=t||.4,i=Math.floor(i)||8,l=Math.floor(l)||6,c=c||Math.PI*2;var h=[],f=[],r=[],v=[],_=new xe,w=new xe,b=new xe,E,P;for(E=0;E<=i;E++)for(P=0;P<=l;P++){var I=P/l*c,F=E/i*Math.PI*2;w.x=(e+t*Math.cos(F))*Math.cos(I),w.y=(e+t*Math.cos(F))*Math.sin(I),w.z=t*Math.sin(F),f.push(w.x,w.y,w.z),_.x=e*Math.cos(I),_.y=e*Math.sin(I),b.subVectors(w,_).normalize(),r.push(b.x,b.y,b.z),v.push(P/l),v.push(E/i)}for(E=1;E<=i;E++)for(P=1;P<=l;P++){var B=(l+1)*E+P-1,O=(l+1)*(E-1)+P-1,W=(l+1)*(E-1)+P,Z=(l+1)*E+P;h.push(B,O,Z),h.push(O,W,Z)}this.setIndex(h),this.setAttribute("position",new cn(f,3)),this.setAttribute("normal",new cn(r,3)),this.setAttribute("uv",new cn(v,2))}vd.prototype=Object.create(_n.prototype),vd.prototype.constructor=vd;var RL={triangulate:function(e,t,i){i=i||2;var l=t&&t.length,c=l?t[0]*i:e.length,h=Gb(e,0,c,i,!0),f=[];if(!h||h.next===h.prev)return f;var r,v,_,w,b,E,P;if(l&&(h=kL(e,t,h,i)),e.length>80*i){r=_=e[0],v=w=e[1];for(var I=i;I<c;I+=i)b=e[I],E=e[I+1],b<r&&(r=b),E<v&&(v=E),b>_&&(_=b),E>w&&(w=E);P=Math.max(_-r,w-v),P=P!==0?1/P:0}return bd(h,f,i,r,v,P),f}};function Gb(e,t,i,l,c){var h,f;if(c===WL(e,t,i,l)>0)for(h=t;h<i;h+=l)f=Wb(h,e[h],e[h+1],f);else for(h=i-l;h>=t;h-=l)f=Wb(h,e[h],e[h+1],f);return f&&Tl(f,f.next)&&(Ad(f),f=f.next),f}function _d(e,t){if(!e)return e;t||(t=e);var i=e,l;do if(l=!1,!i.steiner&&(Tl(i,i.next)||yr(i.prev,i,i.next)===0)){if(Ad(i),i=t=i.prev,i===i.next)break;l=!0}else i=i.next;while(l||i!==t);return t}function bd(e,t,i,l,c,h,f){if(e){!f&&h&&NL(e,l,c,h);for(var r=e,v,_;e.prev!==e.next;){if(v=e.prev,_=e.next,h?IL(e,l,c,h):DL(e)){t.push(v.i/i),t.push(e.i/i),t.push(_.i/i),Ad(e),e=_.next,r=_.next;continue}if(e=_,e===r){f?f===1?(e=LL(e,t,i),bd(e,t,i,l,c,h,2)):f===2&&FL(e,t,i,l,c,h):bd(_d(e),t,i,l,c,h,1);break}}}}function DL(e){var t=e.prev,i=e,l=e.next;if(yr(t,i,l)>=0)return!1;for(var c=e.next.next;c!==e.prev;){if(ou(t.x,t.y,i.x,i.y,l.x,l.y,c.x,c.y)&&yr(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function IL(e,t,i,l){var c=e.prev,h=e,f=e.next;if(yr(c,h,f)>=0)return!1;for(var r=c.x<h.x?c.x<f.x?c.x:f.x:h.x<f.x?h.x:f.x,v=c.y<h.y?c.y<f.y?c.y:f.y:h.y<f.y?h.y:f.y,_=c.x>h.x?c.x>f.x?c.x:f.x:h.x>f.x?h.x:f.x,w=c.y>h.y?c.y>f.y?c.y:f.y:h.y>f.y?h.y:f.y,b=H0(r,v,t,i,l),E=H0(_,w,t,i,l),P=e.prevZ,I=e.nextZ;P&&P.z>=b&&I&&I.z<=E;){if(P!==e.prev&&P!==e.next&&ou(c.x,c.y,h.x,h.y,f.x,f.y,P.x,P.y)&&yr(P.prev,P,P.next)>=0||(P=P.prevZ,I!==e.prev&&I!==e.next&&ou(c.x,c.y,h.x,h.y,f.x,f.y,I.x,I.y)&&yr(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;P&&P.z>=b;){if(P!==e.prev&&P!==e.next&&ou(c.x,c.y,h.x,h.y,f.x,f.y,P.x,P.y)&&yr(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;I&&I.z<=E;){if(I!==e.prev&&I!==e.next&&ou(c.x,c.y,h.x,h.y,f.x,f.y,I.x,I.y)&&yr(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function LL(e,t,i){var l=e;do{var c=l.prev,h=l.next.next;!Tl(c,h)&&jb(c,l,l.next,h)&&wd(c,h)&&wd(h,c)&&(t.push(c.i/i),t.push(l.i/i),t.push(h.i/i),Ad(l),Ad(l.next),l=e=h),l=l.next}while(l!==e);return l}function FL(e,t,i,l,c,h){var f=e;do{for(var r=f.next.next;r!==f.prev;){if(f.i!==r.i&&GL(f,r)){var v=Hb(f,r);f=_d(f,f.next),v=_d(v,v.next),bd(f,t,i,l,c,h),bd(v,t,i,l,c,h);return}r=r.next}f=f.next}while(f!==e)}function kL(e,t,i,l){var c=[],h,f,r,v,_;for(h=0,f=t.length;h<f;h++)r=t[h]*l,v=h<f-1?t[h+1]*l:e.length,_=Gb(e,r,v,l,!1),_===_.next&&(_.steiner=!0),c.push(OL(_));for(c.sort(BL),h=0;h<c.length;h++)zL(c[h],i),i=_d(i,i.next);return i}function BL(e,t){return e.x-t.x}function zL(e,t){if(t=UL(e,t),t){var i=Hb(t,e);_d(i,i.next)}}function UL(e,t){var i=t,l=e.x,c=e.y,h=-1/0,f;do{if(c<=i.y&&c>=i.next.y&&i.next.y!==i.y){var r=i.x+(c-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(r<=l&&r>h){if(h=r,r===l){if(c===i.y)return i;if(c===i.next.y)return i.next}f=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!f)return null;if(l===h)return f.prev;var v=f,_=f.x,w=f.y,b=1/0,E;for(i=f.next;i!==v;)l>=i.x&&i.x>=_&&l!==i.x&&ou(c<w?l:h,c,_,w,c<w?h:l,c,i.x,i.y)&&(E=Math.abs(c-i.y)/(l-i.x),(E<b||E===b&&i.x>f.x)&&wd(i,e)&&(f=i,b=E)),i=i.next;return f}function NL(e,t,i,l){var c=e;do c.z===null&&(c.z=H0(c.x,c.y,t,i,l)),c.prevZ=c.prev,c.nextZ=c.next,c=c.next;while(c!==e);c.prevZ.nextZ=null,c.prevZ=null,VL(c)}function VL(e){var t,i,l,c,h,f,r,v,_=1;do{for(i=e,e=null,h=null,f=0;i;){for(f++,l=i,r=0,t=0;t<_&&(r++,l=l.nextZ,!!l);t++);for(v=_;r>0||v>0&&l;)r!==0&&(v===0||!l||i.z<=l.z)?(c=i,i=i.nextZ,r--):(c=l,l=l.nextZ,v--),h?h.nextZ=c:e=c,c.prevZ=h,h=c;i=l}h.nextZ=null,_*=2}while(f>1);return e}function H0(e,t,i,l,c){return e=32767*(e-i)*c,t=32767*(t-l)*c,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function OL(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function ou(e,t,i,l,c,h,f,r){return(c-f)*(t-r)-(e-f)*(h-r)>=0&&(e-f)*(l-r)-(i-f)*(t-r)>=0&&(i-f)*(h-r)-(c-f)*(l-r)>=0}function GL(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!jL(e,t)&&wd(e,t)&&wd(t,e)&&HL(e,t)}function yr(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Tl(e,t){return e.x===t.x&&e.y===t.y}function jb(e,t,i,l){return Tl(e,i)&&Tl(t,l)||Tl(e,l)&&Tl(i,t)?!0:yr(e,t,i)>0!=yr(e,t,l)>0&&yr(i,l,e)>0!=yr(i,l,t)>0}function jL(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&jb(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function wd(e,t){return yr(e.prev,e,e.next)<0?yr(e,t,e.next)>=0&&yr(e,e.prev,t)>=0:yr(e,t,e.prev)<0||yr(e,e.next,t)<0}function HL(e,t){var i=e,l=!1,c=(e.x+t.x)/2,h=(e.y+t.y)/2;do i.y>h!=i.next.y>h&&i.next.y!==i.y&&c<(i.next.x-i.x)*(h-i.y)/(i.next.y-i.y)+i.x&&(l=!l),i=i.next;while(i!==e);return l}function Hb(e,t){var i=new W0(e.i,e.x,e.y),l=new W0(t.i,t.x,t.y),c=e.next,h=t.prev;return e.next=t,t.prev=e,i.next=c,c.prev=i,l.next=i,i.prev=l,h.next=l,l.prev=h,l}function Wb(e,t,i,l){var c=new W0(e,t,i);return l?(c.next=l.next,c.prev=l,l.next.prev=c,l.next=c):(c.prev=c,c.next=c),c}function Ad(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function W0(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function WL(e,t,i,l){for(var c=0,h=t,f=i-l;h<i;h+=l)c+=(e[f]-e[h])*(e[h+1]+e[f+1]),f=h;return c}var Ms={area:function(e){for(var t=e.length,i=0,l=t-1,c=0;c<t;l=c++)i+=e[l].x*e[c].y-e[c].x*e[l].y;return i*.5},isClockWise:function(e){return Ms.area(e)<0},triangulateShape:function(e,t){var i=[],l=[],c=[];qb(e),Yb(i,e);var h=e.length;t.forEach(qb);for(var f=0;f<t.length;f++)l.push(h),h+=t[f].length,Yb(i,t[f]);for(var r=RL.triangulate(i,l),f=0;f<r.length;f+=3)c.push(r.slice(f,f+3));return c}};function qb(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Yb(e,t){for(var i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}function au(e,t){On.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Ya(e,t)),this.mergeVertices()}au.prototype=Object.create(On.prototype),au.prototype.constructor=au,au.prototype.toJSON=function(){var e=On.prototype.toJSON.call(this),t=this.parameters.shapes,i=this.parameters.options;return Xb(t,i,e)};function Ya(e,t){_n.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var i=this,l=[],c=[],h=0,f=e.length;h<f;h++){var r=e[h];v(r)}this.setAttribute("position",new cn(l,3)),this.setAttribute("uv",new cn(c,2)),this.computeVertexNormals();function v(_){var w=[],b=t.curveSegments!==void 0?t.curveSegments:12,E=t.steps!==void 0?t.steps:1,P=t.depth!==void 0?t.depth:100,I=t.bevelEnabled!==void 0?t.bevelEnabled:!0,F=t.bevelThickness!==void 0?t.bevelThickness:6,B=t.bevelSize!==void 0?t.bevelSize:F-2,O=t.bevelOffset!==void 0?t.bevelOffset:0,W=t.bevelSegments!==void 0?t.bevelSegments:3,Z=t.extrudePath,ie=t.UVGenerator!==void 0?t.UVGenerator:qL;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),P=t.amount);var $,oe=!1,be,fe,Le,Xe;Z&&($=Z.getSpacedPoints(E),oe=!0,I=!1,be=Z.computeFrenetFrames(E,!1),fe=new xe,Le=new xe,Xe=new xe),I||(W=0,F=0,B=0,O=0);var Ne,Re,Ie,He=_.extractPoints(b),Ue=He.shape,ot=He.holes,Pt=!Ms.isClockWise(Ue);if(Pt)for(Ue=Ue.reverse(),Re=0,Ie=ot.length;Re<Ie;Re++)Ne=ot[Re],Ms.isClockWise(Ne)&&(ot[Re]=Ne.reverse());var mt=Ms.triangulateShape(Ue,ot),_t=Ue;for(Re=0,Ie=ot.length;Re<Ie;Re++)Ne=ot[Re],Ue=Ue.concat(Ne);function ft(jt,ln,Xt){return ln||console.error("THREE.ExtrudeGeometry: vec does not exist"),ln.clone().multiplyScalar(Xt).add(jt)}var Vt,we,pe,ke,De,Se=Ue.length,tt,Ge=mt.length;function We(jt,ln,Xt){var Ve,Ot,en,Ln=jt.x-ln.x,fn=jt.y-ln.y,Gn=Xt.x-jt.x,qn=Xt.y-jt.y,Jn=Ln*Ln+fn*fn,Ji=Ln*qn-fn*Gn;if(Math.abs(Ji)>Number.EPSILON){var jn=Math.sqrt(Jn),ki=Math.sqrt(Gn*Gn+qn*qn),oi=ln.x-fn/jn,or=ln.y+Ln/jn,Mi=Xt.x-qn/ki,Zr=Xt.y+Gn/ki,Gi=((Mi-oi)*qn-(Zr-or)*Gn)/(Ln*qn-fn*Gn);Ve=oi+Ln*Gi-jt.x,Ot=or+fn*Gi-jt.y;var Jr=Ve*Ve+Ot*Ot;if(Jr<=2)return new Rt(Ve,Ot);en=Math.sqrt(Jr/2)}else{var Lr=!1;Ln>Number.EPSILON?Gn>Number.EPSILON&&(Lr=!0):Ln<-Number.EPSILON?Gn<-Number.EPSILON&&(Lr=!0):Math.sign(fn)===Math.sign(qn)&&(Lr=!0),Lr?(Ve=-fn,Ot=Ln,en=Math.sqrt(Jn)):(Ve=Ln,Ot=fn,en=Math.sqrt(Jn/2))}return new Rt(Ve/en,Ot/en)}for(var nt=[],je=0,lt=_t.length,gt=lt-1,Lt=je+1;je<lt;je++,gt++,Lt++)gt===lt&&(gt=0),Lt===lt&&(Lt=0),nt[je]=We(_t[je],_t[gt],_t[Lt]);var sn=[],An,le=nt.concat();for(Re=0,Ie=ot.length;Re<Ie;Re++){for(Ne=ot[Re],An=[],je=0,lt=Ne.length,gt=lt-1,Lt=je+1;je<lt;je++,gt++,Lt++)gt===lt&&(gt=0),Lt===lt&&(Lt=0),An[je]=We(Ne[je],Ne[gt],Ne[Lt]);sn.push(An),le=le.concat(An)}for(Vt=0;Vt<W;Vt++){for(pe=Vt/W,ke=F*Math.cos(pe*Math.PI/2),we=B*Math.sin(pe*Math.PI/2)+O,je=0,lt=_t.length;je<lt;je++)De=ft(_t[je],nt[je],we),xn(De.x,De.y,-ke);for(Re=0,Ie=ot.length;Re<Ie;Re++)for(Ne=ot[Re],An=sn[Re],je=0,lt=Ne.length;je<lt;je++)De=ft(Ne[je],An[je],we),xn(De.x,De.y,-ke)}for(we=B+O,je=0;je<Se;je++)De=I?ft(Ue[je],le[je],we):Ue[je],oe?(Le.copy(be.normals[0]).multiplyScalar(De.x),fe.copy(be.binormals[0]).multiplyScalar(De.y),Xe.copy($[0]).add(Le).add(fe),xn(Xe.x,Xe.y,Xe.z)):xn(De.x,De.y,0);var Ee;for(Ee=1;Ee<=E;Ee++)for(je=0;je<Se;je++)De=I?ft(Ue[je],le[je],we):Ue[je],oe?(Le.copy(be.normals[Ee]).multiplyScalar(De.x),fe.copy(be.binormals[Ee]).multiplyScalar(De.y),Xe.copy($[Ee]).add(Le).add(fe),xn(Xe.x,Xe.y,Xe.z)):xn(De.x,De.y,P/E*Ee);for(Vt=W-1;Vt>=0;Vt--){for(pe=Vt/W,ke=F*Math.cos(pe*Math.PI/2),we=B*Math.sin(pe*Math.PI/2)+O,je=0,lt=_t.length;je<lt;je++)De=ft(_t[je],nt[je],we),xn(De.x,De.y,P+ke);for(Re=0,Ie=ot.length;Re<Ie;Re++)for(Ne=ot[Re],An=sn[Re],je=0,lt=Ne.length;je<lt;je++)De=ft(Ne[je],An[je],we),oe?xn(De.x,De.y+$[E-1].y,$[E-1].x+ke):xn(De.x,De.y,P+ke)}Et(),wt();function Et(){var jt=l.length/3;if(I){var ln=0,Xt=Se*ln;for(je=0;je<Ge;je++)tt=mt[je],un(tt[2]+Xt,tt[1]+Xt,tt[0]+Xt);for(ln=E+W*2,Xt=Se*ln,je=0;je<Ge;je++)tt=mt[je],un(tt[0]+Xt,tt[1]+Xt,tt[2]+Xt)}else{for(je=0;je<Ge;je++)tt=mt[je],un(tt[2],tt[1],tt[0]);for(je=0;je<Ge;je++)tt=mt[je],un(tt[0]+Se*E,tt[1]+Se*E,tt[2]+Se*E)}i.addGroup(jt,l.length/3-jt,0)}function wt(){var jt=l.length/3,ln=0;for(Mn(_t,ln),ln+=_t.length,Re=0,Ie=ot.length;Re<Ie;Re++)Ne=ot[Re],Mn(Ne,ln),ln+=Ne.length;i.addGroup(jt,l.length/3-jt,1)}function Mn(jt,ln){var Xt,Ve;for(je=jt.length;--je>=0;){Xt=je,Ve=je-1,Ve<0&&(Ve=jt.length-1);var Ot=0,en=E+W*2;for(Ot=0;Ot<en;Ot++){var Ln=Se*Ot,fn=Se*(Ot+1),Gn=ln+Xt+Ln,qn=ln+Ve+Ln,Jn=ln+Ve+fn,Ji=ln+Xt+fn;bn(Gn,qn,Jn,Ji)}}}function xn(jt,ln,Xt){w.push(jt),w.push(ln),w.push(Xt)}function un(jt,ln,Xt){Tn(jt),Tn(ln),Tn(Xt);var Ve=l.length/3,Ot=ie.generateTopUV(i,l,Ve-3,Ve-2,Ve-1);hn(Ot[0]),hn(Ot[1]),hn(Ot[2])}function bn(jt,ln,Xt,Ve){Tn(jt),Tn(ln),Tn(Ve),Tn(ln),Tn(Xt),Tn(Ve);var Ot=l.length/3,en=ie.generateSideWallUV(i,l,Ot-6,Ot-3,Ot-2,Ot-1);hn(en[0]),hn(en[1]),hn(en[3]),hn(en[1]),hn(en[2]),hn(en[3])}function Tn(jt){l.push(w[jt*3+0]),l.push(w[jt*3+1]),l.push(w[jt*3+2])}function hn(jt){c.push(jt.x),c.push(jt.y)}}}Ya.prototype=Object.create(_n.prototype),Ya.prototype.constructor=Ya,Ya.prototype.toJSON=function(){var e=_n.prototype.toJSON.call(this),t=this.parameters.shapes,i=this.parameters.options;return Xb(t,i,e)};var qL={generateTopUV:function(e,t,i,l,c){var h=t[i*3],f=t[i*3+1],r=t[l*3],v=t[l*3+1],_=t[c*3],w=t[c*3+1];return[new Rt(h,f),new Rt(r,v),new Rt(_,w)]},generateSideWallUV:function(e,t,i,l,c,h){var f=t[i*3],r=t[i*3+1],v=t[i*3+2],_=t[l*3],w=t[l*3+1],b=t[l*3+2],E=t[c*3],P=t[c*3+1],I=t[c*3+2],F=t[h*3],B=t[h*3+1],O=t[h*3+2];return Math.abs(r-w)<.01?[new Rt(f,1-v),new Rt(_,1-b),new Rt(E,1-I),new Rt(F,1-O)]:[new Rt(r,1-v),new Rt(w,1-b),new Rt(P,1-I),new Rt(B,1-O)]}};function Xb(e,t,i){if(i.shapes=[],Array.isArray(e))for(var l=0,c=e.length;l<c;l++){var h=e[l];i.shapes.push(h.uuid)}else i.shapes.push(e.uuid);return t.extrudePath!==void 0&&(i.options.extrudePath=t.extrudePath.toJSON()),i}function Mm(e,t){On.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Md(e,t)),this.mergeVertices()}Mm.prototype=Object.create(On.prototype),Mm.prototype.constructor=Mm;function Md(e,t){t=t||{};var i=t.font;if(!(i&&i.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new On;var l=i.generateShapes(e,t.size);t.depth=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),Ya.call(this,l,t),this.type="TextBufferGeometry"}Md.prototype=Object.create(Ya.prototype),Md.prototype.constructor=Md;function Sm(e,t,i,l,c,h,f){On.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:l,phiLength:c,thetaStart:h,thetaLength:f},this.fromBufferGeometry(new su(e,t,i,l,c,h,f)),this.mergeVertices()}Sm.prototype=Object.create(On.prototype),Sm.prototype.constructor=Sm;function su(e,t,i,l,c,h,f){_n.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:l,phiLength:c,thetaStart:h,thetaLength:f},e=e||1,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),l=l!==void 0?l:0,c=c!==void 0?c:Math.PI*2,h=h!==void 0?h:0,f=f!==void 0?f:Math.PI;var r=Math.min(h+f,Math.PI),v,_,w=0,b=[],E=new xe,P=new xe,I=[],F=[],B=[],O=[];for(_=0;_<=i;_++){var W=[],Z=_/i,ie=0;for(_==0&&h==0?ie=.5/t:_==i&&r==Math.PI&&(ie=-.5/t),v=0;v<=t;v++){var $=v/t;E.x=-e*Math.cos(l+$*c)*Math.sin(h+Z*f),E.y=e*Math.cos(h+Z*f),E.z=e*Math.sin(l+$*c)*Math.sin(h+Z*f),F.push(E.x,E.y,E.z),P.copy(E).normalize(),B.push(P.x,P.y,P.z),O.push($+ie,1-Z),W.push(w++)}b.push(W)}for(_=0;_<i;_++)for(v=0;v<t;v++){var oe=b[_][v+1],be=b[_][v],fe=b[_+1][v],Le=b[_+1][v+1];(_!==0||h>0)&&I.push(oe,be,Le),(_!==i-1||r<Math.PI)&&I.push(be,fe,Le)}this.setIndex(I),this.setAttribute("position",new cn(F,3)),this.setAttribute("normal",new cn(B,3)),this.setAttribute("uv",new cn(O,2))}su.prototype=Object.create(_n.prototype),su.prototype.constructor=su;function Tm(e,t,i,l,c,h){On.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:l,thetaStart:c,thetaLength:h},this.fromBufferGeometry(new Sd(e,t,i,l,c,h)),this.mergeVertices()}Tm.prototype=Object.create(On.prototype),Tm.prototype.constructor=Tm;function Sd(e,t,i,l,c,h){_n.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:l,thetaStart:c,thetaLength:h},e=e||.5,t=t||1,c=c!==void 0?c:0,h=h!==void 0?h:Math.PI*2,i=i!==void 0?Math.max(3,i):8,l=l!==void 0?Math.max(1,l):1;var f=[],r=[],v=[],_=[],w,b=e,E=(t-e)/l,P=new xe,I=new Rt,F,B;for(F=0;F<=l;F++){for(B=0;B<=i;B++)w=c+B/i*h,P.x=b*Math.cos(w),P.y=b*Math.sin(w),r.push(P.x,P.y,P.z),v.push(0,0,1),I.x=(P.x/t+1)/2,I.y=(P.y/t+1)/2,_.push(I.x,I.y);b+=E}for(F=0;F<l;F++){var O=F*(i+1);for(B=0;B<i;B++){w=B+O;var W=w,Z=w+i+1,ie=w+i+2,$=w+1;f.push(W,Z,$),f.push(Z,ie,$)}}this.setIndex(f),this.setAttribute("position",new cn(r,3)),this.setAttribute("normal",new cn(v,3)),this.setAttribute("uv",new cn(_,2))}Sd.prototype=Object.create(_n.prototype),Sd.prototype.constructor=Sd;function Em(e,t,i,l){On.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:l},this.fromBufferGeometry(new Td(e,t,i,l)),this.mergeVertices()}Em.prototype=Object.create(On.prototype),Em.prototype.constructor=Em;function Td(e,t,i,l){_n.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:l},t=Math.floor(t)||12,i=i||0,l=l||Math.PI*2,l=Xn.clamp(l,0,Math.PI*2);var c=[],h=[],f=[],r,v=1/t,_=new xe,w=new Rt,b,E;for(b=0;b<=t;b++){var P=i+b*v*l,I=Math.sin(P),F=Math.cos(P);for(E=0;E<=e.length-1;E++)_.x=e[E].x*I,_.y=e[E].y,_.z=e[E].x*F,h.push(_.x,_.y,_.z),w.x=b/t,w.y=E/(e.length-1),f.push(w.x,w.y)}for(b=0;b<t;b++)for(E=0;E<e.length-1;E++){r=E+b*e.length;var B=r,O=r+e.length,W=r+e.length+1,Z=r+1;c.push(B,O,Z),c.push(O,W,Z)}if(this.setIndex(c),this.setAttribute("position",new cn(h,3)),this.setAttribute("uv",new cn(f,2)),this.computeVertexNormals(),l===Math.PI*2){var ie=this.attributes.normal.array,$=new xe,oe=new xe,be=new xe;for(r=t*e.length*3,b=0,E=0;b<e.length;b++,E+=3)$.x=ie[E+0],$.y=ie[E+1],$.z=ie[E+2],oe.x=ie[r+E+0],oe.y=ie[r+E+1],oe.z=ie[r+E+2],be.addVectors($,oe).normalize(),ie[E+0]=ie[r+E+0]=be.x,ie[E+1]=ie[r+E+1]=be.y,ie[E+2]=ie[r+E+2]=be.z}}Td.prototype=Object.create(_n.prototype),Td.prototype.constructor=Td;function lu(e,t){On.call(this),this.type="ShapeGeometry",typeof t=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new cu(e,t)),this.mergeVertices()}lu.prototype=Object.create(On.prototype),lu.prototype.constructor=lu,lu.prototype.toJSON=function(){var e=On.prototype.toJSON.call(this),t=this.parameters.shapes;return Kb(t,e)};function cu(e,t){_n.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var i=[],l=[],c=[],h=[],f=0,r=0;if(Array.isArray(e)===!1)_(e);else for(var v=0;v<e.length;v++)_(e[v]),this.addGroup(f,r,v),f+=r,r=0;this.setIndex(i),this.setAttribute("position",new cn(l,3)),this.setAttribute("normal",new cn(c,3)),this.setAttribute("uv",new cn(h,2));function _(w){var b,E,P,I=l.length/3,F=w.extractPoints(t),B=F.shape,O=F.holes;for(Ms.isClockWise(B)===!1&&(B=B.reverse()),b=0,E=O.length;b<E;b++)P=O[b],Ms.isClockWise(P)===!0&&(O[b]=P.reverse());var W=Ms.triangulateShape(B,O);for(b=0,E=O.length;b<E;b++)P=O[b],B=B.concat(P);for(b=0,E=B.length;b<E;b++){var Z=B[b];l.push(Z.x,Z.y,0),c.push(0,0,1),h.push(Z.x,Z.y)}for(b=0,E=W.length;b<E;b++){var ie=W[b],$=ie[0]+I,oe=ie[1]+I,be=ie[2]+I;i.push($,oe,be),r+=3}}}cu.prototype=Object.create(_n.prototype),cu.prototype.constructor=cu,cu.prototype.toJSON=function(){var e=_n.prototype.toJSON.call(this),t=this.parameters.shapes;return Kb(t,e)};function Kb(e,t){if(t.shapes=[],Array.isArray(e))for(var i=0,l=e.length;i<l;i++){var c=e[i];t.shapes.push(c.uuid)}else t.shapes.push(e.uuid);return t}function Pm(e,t){_n.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=t!==void 0?t:1;var i=[],l=Math.cos(Xn.DEG2RAD*t),c=[0,0],h={},f,r,v,_=["a","b","c"],w;e.isBufferGeometry?(w=new On,w.fromBufferGeometry(e)):w=e.clone(),w.mergeVertices(),w.computeFaceNormals();for(var b=w.vertices,E=w.faces,P=0,I=E.length;P<I;P++)for(var F=E[P],B=0;B<3;B++)f=F[_[B]],r=F[_[(B+1)%3]],c[0]=Math.min(f,r),c[1]=Math.max(f,r),v=c[0]+","+c[1],h[v]===void 0?h[v]={index1:c[0],index2:c[1],face1:P,face2:void 0}:h[v].face2=P;for(v in h){var O=h[v];if(O.face2===void 0||E[O.face1].normal.dot(E[O.face2].normal)<=l){var W=b[O.index1];i.push(W.x,W.y,W.z),W=b[O.index2],i.push(W.x,W.y,W.z)}}this.setAttribute("position",new cn(i,3))}Pm.prototype=Object.create(_n.prototype),Pm.prototype.constructor=Pm;function uu(e,t,i,l,c,h,f,r){On.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:l,heightSegments:c,openEnded:h,thetaStart:f,thetaLength:r},this.fromBufferGeometry(new Ss(e,t,i,l,c,h,f,r)),this.mergeVertices()}uu.prototype=Object.create(On.prototype),uu.prototype.constructor=uu;function Ss(e,t,i,l,c,h,f,r){_n.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:l,heightSegments:c,openEnded:h,thetaStart:f,thetaLength:r};var v=this;e=e!==void 0?e:1,t=t!==void 0?t:1,i=i||1,l=Math.floor(l)||8,c=Math.floor(c)||1,h=h!==void 0?h:!1,f=f!==void 0?f:0,r=r!==void 0?r:Math.PI*2;var _=[],w=[],b=[],E=[],P=0,I=[],F=i/2,B=0;O(),h===!1&&(e>0&&W(!0),t>0&&W(!1)),this.setIndex(_),this.setAttribute("position",new cn(w,3)),this.setAttribute("normal",new cn(b,3)),this.setAttribute("uv",new cn(E,2));function O(){var Z,ie,$=new xe,oe=new xe,be=0,fe=(t-e)/i;for(ie=0;ie<=c;ie++){var Le=[],Xe=ie/c,Ne=Xe*(t-e)+e;for(Z=0;Z<=l;Z++){var Re=Z/l,Ie=Re*r+f,He=Math.sin(Ie),Ue=Math.cos(Ie);oe.x=Ne*He,oe.y=-Xe*i+F,oe.z=Ne*Ue,w.push(oe.x,oe.y,oe.z),$.set(He,fe,Ue).normalize(),b.push($.x,$.y,$.z),E.push(Re,1-Xe),Le.push(P++)}I.push(Le)}for(Z=0;Z<l;Z++)for(ie=0;ie<c;ie++){var ot=I[ie][Z],Pt=I[ie+1][Z],mt=I[ie+1][Z+1],_t=I[ie][Z+1];_.push(ot,Pt,_t),_.push(Pt,mt,_t),be+=6}v.addGroup(B,be,0),B+=be}function W(Z){var ie,$,oe,be=new Rt,fe=new xe,Le=0,Xe=Z===!0?e:t,Ne=Z===!0?1:-1;for($=P,ie=1;ie<=l;ie++)w.push(0,F*Ne,0),b.push(0,Ne,0),E.push(.5,.5),P++;for(oe=P,ie=0;ie<=l;ie++){var Re=ie/l,Ie=Re*r+f,He=Math.cos(Ie),Ue=Math.sin(Ie);fe.x=Xe*Ue,fe.y=F*Ne,fe.z=Xe*He,w.push(fe.x,fe.y,fe.z),b.push(0,Ne,0),be.x=He*.5+.5,be.y=Ue*.5*Ne+.5,E.push(be.x,be.y),P++}for(ie=0;ie<l;ie++){var ot=$+ie,Pt=oe+ie;Z===!0?_.push(Pt,Pt+1,ot):_.push(Pt+1,Pt,ot),Le+=3}v.addGroup(B,Le,Z===!0?1:2),B+=Le}}Ss.prototype=Object.create(_n.prototype),Ss.prototype.constructor=Ss;function Cm(e,t,i,l,c,h,f){uu.call(this,0,e,t,i,l,c,h,f),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:l,openEnded:c,thetaStart:h,thetaLength:f}}Cm.prototype=Object.create(uu.prototype),Cm.prototype.constructor=Cm;function Rm(e,t,i,l,c,h,f){Ss.call(this,0,e,t,i,l,c,h,f),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:l,openEnded:c,thetaStart:h,thetaLength:f}}Rm.prototype=Object.create(Ss.prototype),Rm.prototype.constructor=Rm;function Dm(e,t,i,l){On.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:l},this.fromBufferGeometry(new Ed(e,t,i,l)),this.mergeVertices()}Dm.prototype=Object.create(On.prototype),Dm.prototype.constructor=Dm;function Ed(e,t,i,l){_n.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:l},e=e||1,t=t!==void 0?Math.max(3,t):8,i=i!==void 0?i:0,l=l!==void 0?l:Math.PI*2;var c=[],h=[],f=[],r=[],v,_,w=new xe,b=new Rt;for(h.push(0,0,0),f.push(0,0,1),r.push(.5,.5),_=0,v=3;_<=t;_++,v+=3){var E=i+_/t*l;w.x=e*Math.cos(E),w.y=e*Math.sin(E),h.push(w.x,w.y,w.z),f.push(0,0,1),b.x=(h[v]/e+1)/2,b.y=(h[v+1]/e+1)/2,r.push(b.x,b.y)}for(v=1;v<=t;v++)c.push(v,v+1,0);this.setIndex(c),this.setAttribute("position",new cn(h,3)),this.setAttribute("normal",new cn(f,3)),this.setAttribute("uv",new cn(r,2))}Ed.prototype=Object.create(_n.prototype),Ed.prototype.constructor=Ed;var Ir=Object.freeze({__proto__:null,WireframeGeometry:fm,ParametricGeometry:mm,ParametricBufferGeometry:fd,TetrahedronGeometry:ym,TetrahedronBufferGeometry:md,OctahedronGeometry:xm,OctahedronBufferGeometry:iu,IcosahedronGeometry:vm,IcosahedronBufferGeometry:gd,DodecahedronGeometry:_m,DodecahedronBufferGeometry:yd,PolyhedronGeometry:gm,PolyhedronBufferGeometry:mo,TubeGeometry:bm,TubeBufferGeometry:ru,TorusKnotGeometry:wm,TorusKnotBufferGeometry:xd,TorusGeometry:Am,TorusBufferGeometry:vd,TextGeometry:Mm,TextBufferGeometry:Md,SphereGeometry:Sm,SphereBufferGeometry:su,RingGeometry:Tm,RingBufferGeometry:Sd,PlaneGeometry:Jf,PlaneBufferGeometry:Zc,LatheGeometry:Em,LatheBufferGeometry:Td,ShapeGeometry:lu,ShapeBufferGeometry:cu,ExtrudeGeometry:au,ExtrudeBufferGeometry:Ya,EdgesGeometry:Pm,ConeGeometry:Cm,ConeBufferGeometry:Rm,CylinderGeometry:uu,CylinderBufferGeometry:Ss,CircleGeometry:Dm,CircleBufferGeometry:Ed,BoxGeometry:kC,BoxBufferGeometry:Kf});function hu(e){zn.call(this),this.type="ShadowMaterial",this.color=new nn(0),this.transparent=!0,this.setValues(e)}hu.prototype=Object.create(zn.prototype),hu.prototype.constructor=hu,hu.prototype.isShadowMaterial=!0,hu.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this};function Ts(e){Yr.call(this,e),this.type="RawShaderMaterial"}Ts.prototype=Object.create(Yr.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isRawShaderMaterial=!0;function Xr(e){zn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pl,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Xr.prototype=Object.create(zn.prototype),Xr.prototype.constructor=Xr,Xr.prototype.isMeshStandardMaterial=!0,Xr.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function du(e){Xr.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new Rt(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}du.prototype=Object.create(Xr.prototype),du.prototype.constructor=du,du.prototype.isMeshPhysicalMaterial=!0,du.prototype.copy=function(e){return Xr.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,e.sheen?this.sheen=(this.sheen||new nn).copy(e.sheen):this.sheen=null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this};function El(e){zn.call(this),this.type="MeshPhongMaterial",this.color=new nn(16777215),this.specular=new nn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pl,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Sf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}El.prototype=Object.create(zn.prototype),El.prototype.constructor=El,El.prototype.isMeshPhongMaterial=!0,El.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function pu(e){zn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nn(16777215),this.specular=new nn(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pl,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}pu.prototype=Object.create(zn.prototype),pu.prototype.constructor=pu,pu.prototype.isMeshToonMaterial=!0,pu.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function fu(e){zn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pl,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}fu.prototype=Object.create(zn.prototype),fu.prototype.constructor=fu,fu.prototype.isMeshNormalMaterial=!0,fu.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function mu(e){zn.call(this),this.type="MeshLambertMaterial",this.color=new nn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Sf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}mu.prototype=Object.create(zn.prototype),mu.prototype.constructor=mu,mu.prototype.isMeshLambertMaterial=!0,mu.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function gu(e){zn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=pl,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}gu.prototype=Object.create(zn.prototype),gu.prototype.constructor=gu,gu.prototype.isMeshMatcapMaterial=!0,gu.prototype.copy=function(e){return zn.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function yu(e){Vi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}yu.prototype=Object.create(Vi.prototype),yu.prototype.constructor=yu,yu.prototype.isLineDashedMaterial=!0,yu.prototype.copy=function(e){return Vi.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var YL=Object.freeze({__proto__:null,ShadowMaterial:hu,SpriteMaterial:Sl,RawShaderMaterial:Ts,ShaderMaterial:Yr,PointsMaterial:As,MeshPhysicalMaterial:du,MeshStandardMaterial:Xr,MeshPhongMaterial:El,MeshToonMaterial:pu,MeshNormalMaterial:fu,MeshLambertMaterial:mu,MeshDepthMaterial:bl,MeshDistanceMaterial:wl,MeshBasicMaterial:_r,MeshMatcapMaterial:gu,LineDashedMaterial:yu,LineBasicMaterial:Vi,Material:zn}),Ki={arraySlice:function(e,t,i){return Ki.isTypedArray(e)?new e.constructor(e.subarray(t,i!==void 0?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(h,f){return e[h]-e[f]}for(var i=e.length,l=new Array(i),c=0;c!==i;++c)l[c]=c;return l.sort(t),l},sortedArray:function(e,t,i){for(var l=e.length,c=new e.constructor(l),h=0,f=0;f!==l;++h)for(var r=i[h]*t,v=0;v!==t;++v)c[f++]=e[r+v];return c},flattenJSON:function(e,t,i,l){for(var c=1,h=e[0];h!==void 0&&h[l]===void 0;)h=e[c++];if(h!==void 0){var f=h[l];if(f!==void 0)if(Array.isArray(f))do f=h[l],f!==void 0&&(t.push(h.time),i.push.apply(i,f)),h=e[c++];while(h!==void 0);else if(f.toArray!==void 0)do f=h[l],f!==void 0&&(t.push(h.time),f.toArray(i,i.length)),h=e[c++];while(h!==void 0);else do f=h[l],f!==void 0&&(t.push(h.time),i.push(f)),h=e[c++];while(h!==void 0)}},subclip:function(e,t,i,l,c){c=c||30;var h=e.clone();h.name=t;for(var f=[],r=0;r<h.tracks.length;++r){for(var v=h.tracks[r],_=v.getValueSize(),w=[],b=[],E=0;E<v.times.length;++E){var P=v.times[E]*c;if(!(P<i||P>=l)){w.push(v.times[E]);for(var I=0;I<_;++I)b.push(v.values[E*_+I])}}w.length!==0&&(v.times=Ki.convertArray(w,v.times.constructor),v.values=Ki.convertArray(b,v.values.constructor),f.push(v))}h.tracks=f;for(var F=1/0,r=0;r<h.tracks.length;++r)F>h.tracks[r].times[0]&&(F=h.tracks[r].times[0]);for(var r=0;r<h.tracks.length;++r)h.tracks[r].shift(-1*F);return h.resetDuration(),h}};function Kr(e,t,i,l){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=l!==void 0?l:new t.constructor(i),this.sampleValues=t,this.valueSize=i}Object.assign(Kr.prototype,{evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,l=t[i],c=t[i-1];e:{t:{var h;n:{i:if(!(e<l)){for(var f=i+2;;){if(l===void 0){if(e<c)break i;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,c)}if(i===f)break;if(c=l,l=t[++i],e<l)break t}h=t.length;break n}if(!(e>=c)){var r=t[1];e<r&&(i=2,c=r);for(var f=i-2;;){if(c===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,l);if(i===f)break;if(l=c,c=t[--i-1],e>=c)break t}h=i,i=0;break n}break e}for(;i<h;){var v=i+h>>>1;e<t[v]?h=v:i=v+1}if(l=t[i],c=t[i-1],c===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,l);if(l===void 0)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,c,e)}this._cachedIndex=i,this.intervalChanged_(i,c,l)}return this.interpolate_(i,c,e,l)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,l=this.valueSize,c=e*l,h=0;h!==l;++h)t[h]=i[c+h];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Kr.prototype,{beforeStart_:Kr.prototype.copySampleValue_,afterEnd_:Kr.prototype.copySampleValue_});function q0(e,t,i,l){Kr.call(this,e,t,i,l),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}q0.prototype=Object.assign(Object.create(Kr.prototype),{constructor:q0,DefaultSettings_:{endingStart:Pc,endingEnd:Pc},intervalChanged_:function(e,t,i){var l=this.parameterPositions,c=e-2,h=e+1,f=l[c],r=l[h];if(f===void 0)switch(this.getSettings_().endingStart){case Cc:c=e,f=2*t-i;break;case If:c=l.length-2,f=t+l[c]-l[c+1];break;default:c=e,f=i}if(r===void 0)switch(this.getSettings_().endingEnd){case Cc:h=e,r=2*i-t;break;case If:h=1,r=i+l[1]-l[0];break;default:h=e-1,r=t}var v=(i-t)*.5,_=this.valueSize;this._weightPrev=v/(t-f),this._weightNext=v/(r-i),this._offsetPrev=c*_,this._offsetNext=h*_},interpolate_:function(e,t,i,l){for(var c=this.resultBuffer,h=this.sampleValues,f=this.valueSize,r=e*f,v=r-f,_=this._offsetPrev,w=this._offsetNext,b=this._weightPrev,E=this._weightNext,P=(i-t)/(l-t),I=P*P,F=I*P,B=-b*F+2*b*I-b*P,O=(1+b)*F+(-1.5-2*b)*I+(-.5+b)*P+1,W=(-1-E)*F+(1.5+E)*I+.5*P,Z=E*F-E*I,ie=0;ie!==f;++ie)c[ie]=B*h[_+ie]+O*h[v+ie]+W*h[r+ie]+Z*h[w+ie];return c}});function Im(e,t,i,l){Kr.call(this,e,t,i,l)}Im.prototype=Object.assign(Object.create(Kr.prototype),{constructor:Im,interpolate_:function(e,t,i,l){for(var c=this.resultBuffer,h=this.sampleValues,f=this.valueSize,r=e*f,v=r-f,_=(i-t)/(l-t),w=1-_,b=0;b!==f;++b)c[b]=h[v+b]*w+h[r+b]*_;return c}});function Y0(e,t,i,l){Kr.call(this,e,t,i,l)}Y0.prototype=Object.assign(Object.create(Kr.prototype),{constructor:Y0,interpolate_:function(e){return this.copySampleValue_(e-1)}});function wr(e,t,i,l){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ki.convertArray(t,this.TimeBufferType),this.values=Ki.convertArray(i,this.ValueBufferType),this.setInterpolation(l||this.DefaultInterpolation)}Object.assign(wr,{toJSON:function(e){var t=e.constructor,i;if(t.toJSON!==void 0)i=t.toJSON(e);else{i={name:e.name,times:Ki.convertArray(e.times,Array),values:Ki.convertArray(e.values,Array)};var l=e.getInterpolation();l!==e.DefaultInterpolation&&(i.interpolation=l)}return i.type=e.ValueTypeName,i}}),Object.assign(wr.prototype,{constructor:wr,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Ec,InterpolantFactoryMethodDiscrete:function(e){return new Y0(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Im(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new q0(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Hh:t=this.InterpolantFactoryMethodDiscrete;break;case Ec:t=this.InterpolantFactoryMethodLinear;break;case r0:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Hh;case this.InterpolantFactoryMethodLinear:return Ec;case this.InterpolantFactoryMethodSmooth:return r0}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var t=this.times,i=0,l=t.length;i!==l;++i)t[i]+=e;return this},scale:function(e){if(e!==1)for(var t=this.times,i=0,l=t.length;i!==l;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,l=i.length,c=0,h=l-1;c!==l&&i[c]<e;)++c;for(;h!==-1&&i[h]>t;)--h;if(++h,c!==0||h!==l){c>=h&&(h=Math.max(h,1),c=h-1);var f=this.getValueSize();this.times=Ki.arraySlice(i,c,h),this.values=Ki.arraySlice(this.values,c*f,h*f)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var i=this.times,l=this.values,c=i.length;c===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var h=null,f=0;f!==c;f++){var r=i[f];if(typeof r=="number"&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,r),e=!1;break}if(h!==null&&h>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,r,h),e=!1;break}h=r}if(l!==void 0&&Ki.isTypedArray(l))for(var f=0,v=l.length;f!==v;++f){var _=l[f];if(isNaN(_)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,_),e=!1;break}}return e},optimize:function(){for(var e=Ki.arraySlice(this.times),t=Ki.arraySlice(this.values),i=this.getValueSize(),l=this.getInterpolation()===r0,c=1,h=e.length-1,f=1;f<h;++f){var r=!1,v=e[f],_=e[f+1];if(v!==_&&(f!==1||v!==v[0]))if(l)r=!0;else for(var w=f*i,b=w-i,E=w+i,P=0;P!==i;++P){var I=t[w+P];if(I!==t[b+P]||I!==t[E+P]){r=!0;break}}if(r){if(f!==c){e[c]=e[f];for(var F=f*i,B=c*i,P=0;P!==i;++P)t[B+P]=t[F+P]}++c}}if(h>0){e[c]=e[h];for(var F=h*i,B=c*i,P=0;P!==i;++P)t[B+P]=t[F+P];++c}return c!==e.length?(this.times=Ki.arraySlice(e,0,c),this.values=Ki.arraySlice(t,0,c*i)):(this.times=e,this.values=t),this},clone:function(){var e=Ki.arraySlice(this.times,0),t=Ki.arraySlice(this.values,0),i=this.constructor,l=new i(this.name,e,t);return l.createInterpolant=this.createInterpolant,l}});function X0(e,t,i){wr.call(this,e,t,i)}X0.prototype=Object.assign(Object.create(wr.prototype),{constructor:X0,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Hh,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function K0(e,t,i,l){wr.call(this,e,t,i,l)}K0.prototype=Object.assign(Object.create(wr.prototype),{constructor:K0,ValueTypeName:"color"});function xu(e,t,i,l){wr.call(this,e,t,i,l)}xu.prototype=Object.assign(Object.create(wr.prototype),{constructor:xu,ValueTypeName:"number"});function Z0(e,t,i,l){Kr.call(this,e,t,i,l)}Z0.prototype=Object.assign(Object.create(Kr.prototype),{constructor:Z0,interpolate_:function(e,t,i,l){for(var c=this.resultBuffer,h=this.sampleValues,f=this.valueSize,r=e*f,v=(i-t)/(l-t),_=r+f;r!==_;r+=4)qr.slerpFlat(c,0,h,r-f,h,r,v);return c}});function Pd(e,t,i,l){wr.call(this,e,t,i,l)}Pd.prototype=Object.assign(Object.create(wr.prototype),{constructor:Pd,ValueTypeName:"quaternion",DefaultInterpolation:Ec,InterpolantFactoryMethodLinear:function(e){return new Z0(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function J0(e,t,i,l){wr.call(this,e,t,i,l)}J0.prototype=Object.assign(Object.create(wr.prototype),{constructor:J0,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Hh,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function vu(e,t,i,l){wr.call(this,e,t,i,l)}vu.prototype=Object.assign(Object.create(wr.prototype),{constructor:vu,ValueTypeName:"vector"});function Po(e,t,i){this.name=e,this.tracks=i,this.duration=t!==void 0?t:-1,this.uuid=Xn.generateUUID(),this.duration<0&&this.resetDuration()}function XL(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xu;case"vector":case"vector2":case"vector3":case"vector4":return vu;case"color":return K0;case"quaternion":return Pd;case"bool":case"boolean":return X0;case"string":return J0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function KL(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=XL(e.type);if(e.times===void 0){var i=[],l=[];Ki.flattenJSON(e.keys,i,l,"value"),e.times=i,e.values=l}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Po,{parse:function(e){for(var t=[],i=e.tracks,l=1/(e.fps||1),c=0,h=i.length;c!==h;++c)t.push(KL(i[c]).scale(l));return new Po(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,l={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},c=0,h=i.length;c!==h;++c)t.push(wr.toJSON(i[c]));return l},CreateFromMorphTargetSequence:function(e,t,i,l){for(var c=t.length,h=[],f=0;f<c;f++){var r=[],v=[];r.push((f+c-1)%c,f,(f+1)%c),v.push(0,1,0);var _=Ki.getKeyframeOrder(r);r=Ki.sortedArray(r,1,_),v=Ki.sortedArray(v,1,_),!l&&r[0]===0&&(r.push(c),v.push(v[0])),h.push(new xu(".morphTargetInfluences["+t[f].name+"]",r,v).scale(1/i))}return new Po(e,-1,h)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var l=e;i=l.geometry&&l.geometry.animations||l.animations}for(var c=0;c<i.length;c++)if(i[c].name===t)return i[c];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var l={},c=/^([\w-]*?)([\d]+)$/,h=0,f=e.length;h<f;h++){var r=e[h],v=r.name.match(c);if(v&&v.length>1){var _=v[1],w=l[_];w||(l[_]=w=[]),w.push(r)}}var b=[];for(var _ in l)b.push(Po.CreateFromMorphTargetSequence(_,l[_],t,i));return b},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(Z,ie,$,oe,be){if($.length!==0){var fe=[],Le=[];Ki.flattenJSON($,fe,Le,oe),fe.length!==0&&be.push(new Z(ie,fe,Le))}},l=[],c=e.name||"default",h=e.length||-1,f=e.fps||30,r=e.hierarchy||[],v=0;v<r.length;v++){var _=r[v].keys;if(!(!_||_.length===0))if(_[0].morphTargets){for(var w={},b=0;b<_.length;b++)if(_[b].morphTargets)for(var E=0;E<_[b].morphTargets.length;E++)w[_[b].morphTargets[E]]=-1;for(var P in w){for(var I=[],F=[],E=0;E!==_[b].morphTargets.length;++E){var B=_[b];I.push(B.time),F.push(B.morphTarget===P?1:0)}l.push(new xu(".morphTargetInfluence["+P+"]",I,F))}h=w.length*(f||1)}else{var O=".bones["+t[v].name+"]";i(vu,O+".position",_,"pos",l),i(Pd,O+".quaternion",_,"rot",l),i(vu,O+".scale",_,"scl",l)}}if(l.length===0)return null;var W=new Po(c,h,l);return W}}),Object.assign(Po.prototype,{resetDuration:function(){for(var e=this.tracks,t=0,i=0,l=e.length;i!==l;++i){var c=this.tracks[i];t=Math.max(t,c.times[c.times.length-1])}return this.duration=t,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Po(this.name,this.duration,e)}});var _u={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Zb(e,t,i){var l=this,c=!1,h=0,f=0,r=void 0,v=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(_){f++,c===!1&&l.onStart!==void 0&&l.onStart(_,h,f),c=!0},this.itemEnd=function(_){h++,l.onProgress!==void 0&&l.onProgress(_,h,f),h===f&&(c=!1,l.onLoad!==void 0&&l.onLoad())},this.itemError=function(_){l.onError!==void 0&&l.onError(_)},this.resolveURL=function(_){return r?r(_):_},this.setURLModifier=function(_){return r=_,this},this.addHandler=function(_,w){return v.push(_,w),this},this.removeHandler=function(_){var w=v.indexOf(_);return w!==-1&&v.splice(w,2),this},this.getHandler=function(_){for(var w=0,b=v.length;w<b;w+=2){var E=v[w],P=v[w+1];if(E.global&&(E.lastIndex=0),E.test(_))return P}return null}}var ZL=new Zb;function ui(e){this.manager=e!==void 0?e:ZL,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(ui.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var jo={};function Co(e){ui.call(this,e)}Co.prototype=Object.assign(Object.create(ui.prototype),{constructor:Co,load:function(e,t,i,l){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var c=this,h=_u.get(e);if(h!==void 0)return c.manager.itemStart(e),setTimeout(function(){t&&t(h),c.manager.itemEnd(e)},0),h;if(jo[e]!==void 0){jo[e].push({onLoad:t,onProgress:i,onError:l});return}var f=/^data:(.*?)(;base64)?,(.*)$/,r=e.match(f);if(r){var v=r[1],_=!!r[2],w=r[3];w=decodeURIComponent(w),_&&(w=atob(w));try{var b,E=(this.responseType||"").toLowerCase();switch(E){case"arraybuffer":case"blob":for(var P=new Uint8Array(w.length),I=0;I<w.length;I++)P[I]=w.charCodeAt(I);E==="blob"?b=new Blob([P.buffer],{type:v}):b=P.buffer;break;case"document":var F=new DOMParser;b=F.parseFromString(w,v);break;case"json":b=JSON.parse(w);break;default:b=w;break}setTimeout(function(){t&&t(b),c.manager.itemEnd(e)},0)}catch(W){setTimeout(function(){l&&l(W),c.manager.itemError(e),c.manager.itemEnd(e)},0)}}else{jo[e]=[],jo[e].push({onLoad:t,onProgress:i,onError:l});var B=new XMLHttpRequest;B.open("GET",e,!0),B.addEventListener("load",function(W){var Z=this.response,ie=jo[e];if(delete jo[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),_u.add(e,Z);for(var $=0,oe=ie.length;$<oe;$++){var be=ie[$];be.onLoad&&be.onLoad(Z)}c.manager.itemEnd(e)}else{for(var $=0,oe=ie.length;$<oe;$++){var be=ie[$];be.onError&&be.onError(W)}c.manager.itemError(e),c.manager.itemEnd(e)}},!1),B.addEventListener("progress",function(W){for(var Z=jo[e],ie=0,$=Z.length;ie<$;ie++){var oe=Z[ie];oe.onProgress&&oe.onProgress(W)}},!1),B.addEventListener("error",function(W){var Z=jo[e];delete jo[e];for(var ie=0,$=Z.length;ie<$;ie++){var oe=Z[ie];oe.onError&&oe.onError(W)}c.manager.itemError(e),c.manager.itemEnd(e)},!1),B.addEventListener("abort",function(W){var Z=jo[e];delete jo[e];for(var ie=0,$=Z.length;ie<$;ie++){var oe=Z[ie];oe.onError&&oe.onError(W)}c.manager.itemError(e),c.manager.itemEnd(e)},!1),this.responseType!==void 0&&(B.responseType=this.responseType),this.withCredentials!==void 0&&(B.withCredentials=this.withCredentials),B.overrideMimeType&&B.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var O in this.requestHeader)B.setRequestHeader(O,this.requestHeader[O]);B.send(null)}return c.manager.itemStart(e),B},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});function Jb(e){ui.call(this,e)}Jb.prototype=Object.assign(Object.create(ui.prototype),{constructor:Jb,load:function(e,t,i,l){var c=this,h=new Co(c.manager);h.setPath(c.path),h.load(e,function(f){t(c.parse(JSON.parse(f)))},i,l)},parse:function(e){for(var t=[],i=0;i<e.length;i++){var l=Po.parse(e[i]);t.push(l)}return t}});function Qb(e){ui.call(this,e)}Qb.prototype=Object.assign(Object.create(ui.prototype),{constructor:Qb,load:function(e,t,i,l){var c=this,h=[],f=new pd;f.image=h;var r=new Co(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer");function v(E){r.load(e[E],function(P){var I=c.parse(P,!0);h[E]={width:I.width,height:I.height,format:I.format,mipmaps:I.mipmaps},_+=1,_===6&&(I.mipmapCount===1&&(f.minFilter=$i),f.format=I.format,f.needsUpdate=!0,t&&t(f))},i,l)}if(Array.isArray(e))for(var _=0,w=0,b=e.length;w<b;++w)v(w);else r.load(e,function(E){var P=c.parse(E,!0);if(P.isCubemap)for(var I=P.mipmaps.length/P.mipmapCount,F=0;F<I;F++){h[F]={mipmaps:[]};for(var B=0;B<P.mipmapCount;B++)h[F].mipmaps.push(P.mipmaps[F*P.mipmapCount+B]),h[F].format=P.format,h[F].width=P.width,h[F].height=P.height}else f.image.width=P.width,f.image.height=P.height,f.mipmaps=P.mipmaps;P.mipmapCount===1&&(f.minFilter=$i),f.format=P.format,f.needsUpdate=!0,t&&t(f)},i,l);return f}});function $b(e){ui.call(this,e)}$b.prototype=Object.assign(Object.create(ui.prototype),{constructor:$b,load:function(e,t,i,l){var c=this,h=new Xc,f=new Co(this.manager);return f.setResponseType("arraybuffer"),f.setPath(this.path),f.load(e,function(r){var v=c.parse(r);v&&(v.image!==void 0?h.image=v.image:v.data!==void 0&&(h.image.width=v.width,h.image.height=v.height,h.image.data=v.data),h.wrapS=v.wrapS!==void 0?v.wrapS:Rr,h.wrapT=v.wrapT!==void 0?v.wrapT:Rr,h.magFilter=v.magFilter!==void 0?v.magFilter:$i,h.minFilter=v.minFilter!==void 0?v.minFilter:$i,h.anisotropy=v.anisotropy!==void 0?v.anisotropy:1,v.format!==void 0&&(h.format=v.format),v.type!==void 0&&(h.type=v.type),v.mipmaps!==void 0&&(h.mipmaps=v.mipmaps,h.minFilter=Sc),v.mipmapCount===1&&(h.minFilter=$i),h.needsUpdate=!0,t&&t(h,v))},i,l),h}});function Cd(e){ui.call(this,e)}Cd.prototype=Object.assign(Object.create(ui.prototype),{constructor:Cd,load:function(e,t,i,l){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var c=this,h=_u.get(e);if(h!==void 0)return c.manager.itemStart(e),setTimeout(function(){t&&t(h),c.manager.itemEnd(e)},0),h;var f=document.createElementNS("http://www.w3.org/1999/xhtml","img");function r(){f.removeEventListener("load",r,!1),f.removeEventListener("error",v,!1),_u.add(e,this),t&&t(this),c.manager.itemEnd(e)}function v(_){f.removeEventListener("load",r,!1),f.removeEventListener("error",v,!1),l&&l(_),c.manager.itemError(e),c.manager.itemEnd(e)}return f.addEventListener("load",r,!1),f.addEventListener("error",v,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),c.manager.itemStart(e),f.src=e,f}});function Q0(e){ui.call(this,e)}Q0.prototype=Object.assign(Object.create(ui.prototype),{constructor:Q0,load:function(e,t,i,l){var c=new bs,h=new Cd(this.manager);h.setCrossOrigin(this.crossOrigin),h.setPath(this.path);var f=0;function r(_){h.load(e[_],function(w){c.images[_]=w,f++,f===6&&(c.needsUpdate=!0,t&&t(c))},void 0,l)}for(var v=0;v<e.length;++v)r(v);return c}});function Lm(e){ui.call(this,e)}Lm.prototype=Object.assign(Object.create(ui.prototype),{constructor:Lm,load:function(e,t,i,l){var c=new bi,h=new Cd(this.manager);return h.setCrossOrigin(this.crossOrigin),h.setPath(this.path),h.load(e,function(f){c.image=f;var r=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;c.format=r?ka:Uo,c.needsUpdate=!0,t!==void 0&&t(c)},i,l),c}});function In(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(In.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var i=this.getUtoTmapping(e);return this.getPoint(i,t)},getPoints:function(e){e===void 0&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return t},getSpacedPoints:function(e){e===void 0&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],i,l=this.getPoint(0),c,h=0;for(t.push(0),c=1;c<=e;c++)i=this.getPoint(c/e),h+=i.distanceTo(l),t.push(h),l=i;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i=this.getLengths(),l=0,c=i.length,h;t?h=t:h=e*i[c-1];for(var f=0,r=c-1,v;f<=r;)if(l=Math.floor(f+(r-f)/2),v=i[l]-h,v<0)f=l+1;else if(v>0)r=l-1;else{r=l;break}if(l=r,i[l]===h)return l/(c-1);var _=i[l],w=i[l+1],b=w-_,E=(h-_)/b,P=(l+E)/(c-1);return P},getTangent:function(e){var t=1e-4,i=e-t,l=e+t;i<0&&(i=0),l>1&&(l=1);var c=this.getPoint(i),h=this.getPoint(l),f=h.clone().sub(c);return f.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var i=new xe,l=[],c=[],h=[],f=new xe,r=new Kn,v,_,w;for(v=0;v<=e;v++)_=v/e,l[v]=this.getTangentAt(_),l[v].normalize();c[0]=new xe,h[0]=new xe;var b=Number.MAX_VALUE,E=Math.abs(l[0].x),P=Math.abs(l[0].y),I=Math.abs(l[0].z);for(E<=b&&(b=E,i.set(1,0,0)),P<=b&&(b=P,i.set(0,1,0)),I<=b&&i.set(0,0,1),f.crossVectors(l[0],i).normalize(),c[0].crossVectors(l[0],f),h[0].crossVectors(l[0],c[0]),v=1;v<=e;v++)c[v]=c[v-1].clone(),h[v]=h[v-1].clone(),f.crossVectors(l[v-1],l[v]),f.length()>Number.EPSILON&&(f.normalize(),w=Math.acos(Xn.clamp(l[v-1].dot(l[v]),-1,1)),c[v].applyMatrix4(r.makeRotationAxis(f,w))),h[v].crossVectors(l[v],c[v]);if(t===!0)for(w=Math.acos(Xn.clamp(c[0].dot(c[e]),-1,1)),w/=e,l[0].dot(f.crossVectors(c[0],c[e]))>0&&(w=-w),v=1;v<=e;v++)c[v].applyMatrix4(r.makeRotationAxis(l[v],w*v)),h[v].crossVectors(l[v],c[v]);return{tangents:l,normals:c,binormals:h}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function Ro(e,t,i,l,c,h,f,r){In.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=i||1,this.yRadius=l||1,this.aStartAngle=c||0,this.aEndAngle=h||2*Math.PI,this.aClockwise=f||!1,this.aRotation=r||0}Ro.prototype=Object.create(In.prototype),Ro.prototype.constructor=Ro,Ro.prototype.isEllipseCurve=!0,Ro.prototype.getPoint=function(e,t){for(var i=t||new Rt,l=Math.PI*2,c=this.aEndAngle-this.aStartAngle,h=Math.abs(c)<Number.EPSILON;c<0;)c+=l;for(;c>l;)c-=l;c<Number.EPSILON&&(h?c=0:c=l),this.aClockwise===!0&&!h&&(c===l?c=-l:c=c-l);var f=this.aStartAngle+e*c,r=this.aX+this.xRadius*Math.cos(f),v=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){var _=Math.cos(this.aRotation),w=Math.sin(this.aRotation),b=r-this.aX,E=v-this.aY;r=b*_-E*w+this.aX,v=b*w+E*_+this.aY}return i.set(r,v)},Ro.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ro.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Ro.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function Rd(e,t,i,l,c,h){Ro.call(this,e,t,i,i,l,c,h),this.type="ArcCurve"}Rd.prototype=Object.create(Ro.prototype),Rd.prototype.constructor=Rd,Rd.prototype.isArcCurve=!0;function $0(){var e=0,t=0,i=0,l=0;function c(h,f,r,v){e=h,t=r,i=-3*h+3*f-2*r-v,l=2*h-2*f+r+v}return{initCatmullRom:function(h,f,r,v,_){c(f,r,_*(r-h),_*(v-f))},initNonuniformCatmullRom:function(h,f,r,v,_,w,b){var E=(f-h)/_-(r-h)/(_+w)+(r-f)/w,P=(r-f)/w-(v-f)/(w+b)+(v-r)/b;E*=w,P*=w,c(f,r,E,P)},calc:function(h){var f=h*h,r=f*h;return e+t*h+i*f+l*r}}}var Fm=new xe,ex=new $0,tx=new $0,nx=new $0;function go(e,t,i,l){In.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=i||"centripetal",this.tension=l||.5}go.prototype=Object.create(In.prototype),go.prototype.constructor=go,go.prototype.isCatmullRomCurve3=!0,go.prototype.getPoint=function(e,t){var i=t||new xe,l=this.points,c=l.length,h=(c-(this.closed?0:1))*e,f=Math.floor(h),r=h-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/c)+1)*c:r===0&&f===c-1&&(f=c-2,r=1);var v,_,w,b;if(this.closed||f>0?v=l[(f-1)%c]:(Fm.subVectors(l[0],l[1]).add(l[0]),v=Fm),_=l[f%c],w=l[(f+1)%c],this.closed||f+2<c?b=l[(f+2)%c]:(Fm.subVectors(l[c-1],l[c-2]).add(l[c-1]),b=Fm),this.curveType==="centripetal"||this.curveType==="chordal"){var E=this.curveType==="chordal"?.5:.25,P=Math.pow(v.distanceToSquared(_),E),I=Math.pow(_.distanceToSquared(w),E),F=Math.pow(w.distanceToSquared(b),E);I<1e-4&&(I=1),P<1e-4&&(P=I),F<1e-4&&(F=I),ex.initNonuniformCatmullRom(v.x,_.x,w.x,b.x,P,I,F),tx.initNonuniformCatmullRom(v.y,_.y,w.y,b.y,P,I,F),nx.initNonuniformCatmullRom(v.z,_.z,w.z,b.z,P,I,F)}else this.curveType==="catmullrom"&&(ex.initCatmullRom(v.x,_.x,w.x,b.x,this.tension),tx.initCatmullRom(v.y,_.y,w.y,b.y,this.tension),nx.initCatmullRom(v.z,_.z,w.z,b.z,this.tension));return i.set(ex.calc(r),tx.calc(r),nx.calc(r)),i},go.prototype.copy=function(e){In.prototype.copy.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var l=e.points[t];this.points.push(l.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},go.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);e.points=[];for(var t=0,i=this.points.length;t<i;t++){var l=this.points[t];e.points.push(l.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},go.prototype.fromJSON=function(e){In.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var l=e.points[t];this.points.push(new xe().fromArray(l))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function ew(e,t,i,l,c){var h=(l-t)*.5,f=(c-i)*.5,r=e*e,v=e*r;return(2*i-2*l+h+f)*v+(-3*i+3*l-2*h-f)*r+h*e+i}function JL(e,t){var i=1-e;return i*i*t}function QL(e,t){return 2*(1-e)*e*t}function $L(e,t){return e*e*t}function Dd(e,t,i,l){return JL(e,t)+QL(e,i)+$L(e,l)}function e4(e,t){var i=1-e;return i*i*i*t}function t4(e,t){var i=1-e;return 3*i*i*e*t}function n4(e,t){return 3*(1-e)*e*e*t}function i4(e,t){return e*e*e*t}function Id(e,t,i,l,c){return e4(e,t)+t4(e,i)+n4(e,l)+i4(e,c)}function la(e,t,i,l){In.call(this),this.type="CubicBezierCurve",this.v0=e||new Rt,this.v1=t||new Rt,this.v2=i||new Rt,this.v3=l||new Rt}la.prototype=Object.create(In.prototype),la.prototype.constructor=la,la.prototype.isCubicBezierCurve=!0,la.prototype.getPoint=function(e,t){var i=t||new Rt,l=this.v0,c=this.v1,h=this.v2,f=this.v3;return i.set(Id(e,l.x,c.x,h.x,f.x),Id(e,l.y,c.y,h.y,f.y)),i},la.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},la.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},la.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Xa(e,t,i,l){In.call(this),this.type="CubicBezierCurve3",this.v0=e||new xe,this.v1=t||new xe,this.v2=i||new xe,this.v3=l||new xe}Xa.prototype=Object.create(In.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isCubicBezierCurve3=!0,Xa.prototype.getPoint=function(e,t){var i=t||new xe,l=this.v0,c=this.v1,h=this.v2,f=this.v3;return i.set(Id(e,l.x,c.x,h.x,f.x),Id(e,l.y,c.y,h.y,f.y),Id(e,l.z,c.z,h.z,f.z)),i},Xa.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Xa.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Xa.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function yo(e,t){In.call(this),this.type="LineCurve",this.v1=e||new Rt,this.v2=t||new Rt}yo.prototype=Object.create(In.prototype),yo.prototype.constructor=yo,yo.prototype.isLineCurve=!0,yo.prototype.getPoint=function(e,t){var i=t||new Rt;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},yo.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},yo.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()},yo.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},yo.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},yo.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function ca(e,t){In.call(this),this.type="LineCurve3",this.v1=e||new xe,this.v2=t||new xe}ca.prototype=Object.create(In.prototype),ca.prototype.constructor=ca,ca.prototype.isLineCurve3=!0,ca.prototype.getPoint=function(e,t){var i=t||new xe;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},ca.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},ca.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ca.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ca.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function ua(e,t,i){In.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Rt,this.v1=t||new Rt,this.v2=i||new Rt}ua.prototype=Object.create(In.prototype),ua.prototype.constructor=ua,ua.prototype.isQuadraticBezierCurve=!0,ua.prototype.getPoint=function(e,t){var i=t||new Rt,l=this.v0,c=this.v1,h=this.v2;return i.set(Dd(e,l.x,c.x,h.x),Dd(e,l.y,c.y,h.y)),i},ua.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ua.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ua.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function Ka(e,t,i){In.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new xe,this.v1=t||new xe,this.v2=i||new xe}Ka.prototype=Object.create(In.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isQuadraticBezierCurve3=!0,Ka.prototype.getPoint=function(e,t){var i=t||new xe,l=this.v0,c=this.v1,h=this.v2;return i.set(Dd(e,l.x,c.x,h.x),Dd(e,l.y,c.y,h.y),Dd(e,l.z,c.z,h.z)),i},Ka.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ka.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ka.prototype.fromJSON=function(e){return In.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function ha(e){In.call(this),this.type="SplineCurve",this.points=e||[]}ha.prototype=Object.create(In.prototype),ha.prototype.constructor=ha,ha.prototype.isSplineCurve=!0,ha.prototype.getPoint=function(e,t){var i=t||new Rt,l=this.points,c=(l.length-1)*e,h=Math.floor(c),f=c-h,r=l[h===0?h:h-1],v=l[h],_=l[h>l.length-2?l.length-1:h+1],w=l[h>l.length-3?l.length-1:h+2];return i.set(ew(f,r.x,v.x,_.x,w.x),ew(f,r.y,v.y,_.y,w.y)),i},ha.prototype.copy=function(e){In.prototype.copy.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var l=e.points[t];this.points.push(l.clone())}return this},ha.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);e.points=[];for(var t=0,i=this.points.length;t<i;t++){var l=this.points[t];e.points.push(l.toArray())}return e},ha.prototype.fromJSON=function(e){In.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var l=e.points[t];this.points.push(new Rt().fromArray(l))}return this};var ix=Object.freeze({__proto__:null,ArcCurve:Rd,CatmullRomCurve3:go,CubicBezierCurve:la,CubicBezierCurve3:Xa,EllipseCurve:Ro,LineCurve:yo,LineCurve3:ca,QuadraticBezierCurve:ua,QuadraticBezierCurve3:Ka,SplineCurve:ha});function Es(){In.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Es.prototype=Object.assign(Object.create(In.prototype),{constructor:Es,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new yo(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),l=0;l<i.length;){if(i[l]>=t){var c=i[l]-t,h=this.curves[l],f=h.getLength(),r=f===0?0:1-c/f;return h.getPointAt(r)}l++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,l=this.curves.length;i<l;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t=[],i,l=0,c=this.curves;l<c.length;l++)for(var h=c[l],f=h&&h.isEllipseCurve?e*2:h&&(h.isLineCurve||h.isLineCurve3)?1:h&&h.isSplineCurve?e*h.points.length:e,r=h.getPoints(f),v=0;v<r.length;v++){var _=r[v];i&&i.equals(_)||(t.push(_),i=_)}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){In.prototype.copy.call(this,e),this.curves=[];for(var t=0,i=e.curves.length;t<i;t++){var l=e.curves[t];this.curves.push(l.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=In.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,i=this.curves.length;t<i;t++){var l=this.curves[t];e.curves.push(l.toJSON())}return e},fromJSON:function(e){In.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,i=e.curves.length;t<i;t++){var l=e.curves[t];this.curves.push(new ix[l.type]().fromJSON(l))}return this}});function da(e){Es.call(this),this.type="Path",this.currentPoint=new Rt,e&&this.setFromPoints(e)}da.prototype=Object.assign(Object.create(Es.prototype),{constructor:da,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var i=new yo(this.currentPoint.clone(),new Rt(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,i,l){var c=new ua(this.currentPoint.clone(),new Rt(e,t),new Rt(i,l));return this.curves.push(c),this.currentPoint.set(i,l),this},bezierCurveTo:function(e,t,i,l,c,h){var f=new la(this.currentPoint.clone(),new Rt(e,t),new Rt(i,l),new Rt(c,h));return this.curves.push(f),this.currentPoint.set(c,h),this},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e),i=new ha(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,i,l,c,h){var f=this.currentPoint.x,r=this.currentPoint.y;return this.absarc(e+f,t+r,i,l,c,h),this},absarc:function(e,t,i,l,c,h){return this.absellipse(e,t,i,i,l,c,h),this},ellipse:function(e,t,i,l,c,h,f,r){var v=this.currentPoint.x,_=this.currentPoint.y;return this.absellipse(e+v,t+_,i,l,c,h,f,r),this},absellipse:function(e,t,i,l,c,h,f,r){var v=new Ro(e,t,i,l,c,h,f,r);if(this.curves.length>0){var _=v.getPoint(0);_.equals(this.currentPoint)||this.lineTo(_.x,_.y)}this.curves.push(v);var w=v.getPoint(1);return this.currentPoint.copy(w),this},copy:function(e){return Es.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Es.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Es.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}});function Pl(e){da.call(this,e),this.uuid=Xn.generateUUID(),this.type="Shape",this.holes=[]}Pl.prototype=Object.assign(Object.create(da.prototype),{constructor:Pl,getPointsHoles:function(e){for(var t=[],i=0,l=this.holes.length;i<l;i++)t[i]=this.holes[i].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){da.prototype.copy.call(this,e),this.holes=[];for(var t=0,i=e.holes.length;t<i;t++){var l=e.holes[t];this.holes.push(l.clone())}return this},toJSON:function(){var e=da.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,i=this.holes.length;t<i;t++){var l=this.holes[t];e.holes.push(l.toJSON())}return e},fromJSON:function(e){da.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,i=e.holes.length;t<i;t++){var l=e.holes[t];this.holes.push(new da().fromJSON(l))}return this}});function Ci(e,t){on.call(this),this.type="Light",this.color=new nn(e),this.intensity=t!==void 0?t:1,this.receiveShadow=void 0}Ci.prototype=Object.assign(Object.create(on.prototype),{constructor:Ci,isLight:!0,copy:function(e){return on.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=on.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}});function rx(e,t,i){Ci.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(on.DefaultUp),this.updateMatrix(),this.groundColor=new nn(t)}rx.prototype=Object.assign(Object.create(Ci.prototype),{constructor:rx,isHemisphereLight:!0,copy:function(e){return Ci.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function Za(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Rt(512,512),this.map=null,this.mapPass=null,this.matrix=new Kn,this._frustum=new nd,this._frameExtents=new Rt(1,1),this._viewportCount=1,this._viewports=[new wi(0,0,1,1)]}Object.assign(Za.prototype,{_projScreenMatrix:new Kn,_lightPositionWorld:new xe,_lookTarget:new xe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,i=this.matrix,l=this._projScreenMatrix,c=this._lookTarget,h=this._lightPositionWorld;h.setFromMatrixPosition(e.matrixWorld),t.position.copy(h),c.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(c),t.updateMatrixWorld(),l.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function ox(){Za.call(this,new tr(50,1,.5,500))}ox.prototype=Object.assign(Object.create(Za.prototype),{constructor:ox,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,i=Xn.RAD2DEG*2*e.angle,l=this.mapSize.width/this.mapSize.height,c=e.distance||t.far;(i!==t.fov||l!==t.aspect||c!==t.far)&&(t.fov=i,t.aspect=l,t.far=c,t.updateProjectionMatrix()),Za.prototype.updateMatrices.call(this,e)}});function km(e,t,i,l,c,h){Ci.call(this,e,t),this.type="SpotLight",this.position.copy(on.DefaultUp),this.updateMatrix(),this.target=new on,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(f){this.intensity=f/Math.PI}}),this.distance=i!==void 0?i:0,this.angle=l!==void 0?l:Math.PI/3,this.penumbra=c!==void 0?c:0,this.decay=h!==void 0?h:1,this.shadow=new ox}km.prototype=Object.assign(Object.create(Ci.prototype),{constructor:km,isSpotLight:!0,copy:function(e){return Ci.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function ax(){Za.call(this,new tr(90,1,.5,500)),this._frameExtents=new Rt(4,2),this._viewportCount=6,this._viewports=[new wi(2,1,1,1),new wi(0,1,1,1),new wi(3,1,1,1),new wi(1,1,1,1),new wi(3,0,1,1),new wi(1,0,1,1)],this._cubeDirections=[new xe(1,0,0),new xe(-1,0,0),new xe(0,0,1),new xe(0,0,-1),new xe(0,1,0),new xe(0,-1,0)],this._cubeUps=[new xe(0,1,0),new xe(0,1,0),new xe(0,1,0),new xe(0,1,0),new xe(0,0,1),new xe(0,0,-1)]}ax.prototype=Object.assign(Object.create(Za.prototype),{constructor:ax,isPointLightShadow:!0,updateMatrices:function(e,t){t===void 0&&(t=0);var i=this.camera,l=this.matrix,c=this._lightPositionWorld,h=this._lookTarget,f=this._projScreenMatrix;c.setFromMatrixPosition(e.matrixWorld),i.position.copy(c),h.copy(i.position),h.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(h),i.updateMatrixWorld(),l.makeTranslation(-c.x,-c.y,-c.z),f.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(f)}});function Bm(e,t,i,l){Ci.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(c){this.intensity=c/(4*Math.PI)}}),this.distance=i!==void 0?i:0,this.decay=l!==void 0?l:1,this.shadow=new ax}Bm.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Bm,isPointLight:!0,copy:function(e){return Ci.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function bu(e,t,i,l,c,h){Ha.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=t!==void 0?t:1,this.top=i!==void 0?i:1,this.bottom=l!==void 0?l:-1,this.near=c!==void 0?c:.1,this.far=h!==void 0?h:2e3,this.updateProjectionMatrix()}bu.prototype=Object.assign(Object.create(Ha.prototype),{constructor:bu,isOrthographicCamera:!0,copy:function(e,t){return Ha.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,l,c,h){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=l,this.view.width=c,this.view.height=h,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,l=(this.top+this.bottom)/2,c=i-e,h=i+e,f=l+t,r=l-t;if(this.view!==null&&this.view.enabled){var v=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;c+=v*this.view.offsetX,h=c+v*this.view.width,f-=_*this.view.offsetY,r=f-_*this.view.height}this.projectionMatrix.makeOrthographic(c,h,f,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=on.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}});function sx(){Za.call(this,new bu(-5,5,5,-5,.5,500))}sx.prototype=Object.assign(Object.create(Za.prototype),{constructor:sx,isDirectionalLightShadow:!0,updateMatrices:function(e){Za.prototype.updateMatrices.call(this,e)}});function zm(e,t){Ci.call(this,e,t),this.type="DirectionalLight",this.position.copy(on.DefaultUp),this.updateMatrix(),this.target=new on,this.shadow=new sx}zm.prototype=Object.assign(Object.create(Ci.prototype),{constructor:zm,isDirectionalLight:!0,copy:function(e){return Ci.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function lx(e,t){Ci.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}lx.prototype=Object.assign(Object.create(Ci.prototype),{constructor:lx,isAmbientLight:!0});function cx(e,t,i,l){Ci.call(this,e,t),this.type="RectAreaLight",this.width=i!==void 0?i:10,this.height=l!==void 0?l:10}cx.prototype=Object.assign(Object.create(Ci.prototype),{constructor:cx,isRectAreaLight:!0,copy:function(e){return Ci.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Ci.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});function ux(e){ui.call(this,e),this.textures={}}ux.prototype=Object.assign(Object.create(ui.prototype),{constructor:ux,load:function(e,t,i,l){var c=this,h=new Co(c.manager);h.setPath(c.path),h.load(e,function(f){t(c.parse(JSON.parse(f)))},i,l)},parse:function(e){var t=this.textures;function i(v){return t[v]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",v),t[v]}var l=new YL[e.type];if(e.uuid!==void 0&&(l.uuid=e.uuid),e.name!==void 0&&(l.name=e.name),e.color!==void 0&&l.color.setHex(e.color),e.roughness!==void 0&&(l.roughness=e.roughness),e.metalness!==void 0&&(l.metalness=e.metalness),e.sheen!==void 0&&(l.sheen=new nn().setHex(e.sheen)),e.emissive!==void 0&&l.emissive.setHex(e.emissive),e.specular!==void 0&&l.specular.setHex(e.specular),e.shininess!==void 0&&(l.shininess=e.shininess),e.clearcoat!==void 0&&(l.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(l.clearcoatRoughness=e.clearcoatRoughness),e.vertexColors!==void 0&&(l.vertexColors=e.vertexColors),e.fog!==void 0&&(l.fog=e.fog),e.flatShading!==void 0&&(l.flatShading=e.flatShading),e.blending!==void 0&&(l.blending=e.blending),e.combine!==void 0&&(l.combine=e.combine),e.side!==void 0&&(l.side=e.side),e.opacity!==void 0&&(l.opacity=e.opacity),e.transparent!==void 0&&(l.transparent=e.transparent),e.alphaTest!==void 0&&(l.alphaTest=e.alphaTest),e.depthTest!==void 0&&(l.depthTest=e.depthTest),e.depthWrite!==void 0&&(l.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(l.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(l.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(l.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(l.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(l.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(l.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(l.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(l.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(l.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(l.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(l.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(l.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(l.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(l.rotation=e.rotation),e.linewidth!==1&&(l.linewidth=e.linewidth),e.dashSize!==void 0&&(l.dashSize=e.dashSize),e.gapSize!==void 0&&(l.gapSize=e.gapSize),e.scale!==void 0&&(l.scale=e.scale),e.polygonOffset!==void 0&&(l.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(l.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(l.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(l.skinning=e.skinning),e.morphTargets!==void 0&&(l.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(l.morphNormals=e.morphNormals),e.dithering!==void 0&&(l.dithering=e.dithering),e.visible!==void 0&&(l.visible=e.visible),e.toneMapped!==void 0&&(l.toneMapped=e.toneMapped),e.userData!==void 0&&(l.userData=e.userData),e.uniforms!==void 0)for(var c in e.uniforms){var h=e.uniforms[c];switch(l.uniforms[c]={},h.type){case"t":l.uniforms[c].value=i(h.value);break;case"c":l.uniforms[c].value=new nn().setHex(h.value);break;case"v2":l.uniforms[c].value=new Rt().fromArray(h.value);break;case"v3":l.uniforms[c].value=new xe().fromArray(h.value);break;case"v4":l.uniforms[c].value=new wi().fromArray(h.value);break;case"m3":l.uniforms[c].value=new vr().fromArray(h.value);case"m4":l.uniforms[c].value=new Kn().fromArray(h.value);break;default:l.uniforms[c].value=h.value}}if(e.defines!==void 0&&(l.defines=e.defines),e.vertexShader!==void 0&&(l.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(l.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var f in e.extensions)l.extensions[f]=e.extensions[f];if(e.shading!==void 0&&(l.flatShading=e.shading===1),e.size!==void 0&&(l.size=e.size),e.sizeAttenuation!==void 0&&(l.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(l.map=i(e.map)),e.matcap!==void 0&&(l.matcap=i(e.matcap)),e.alphaMap!==void 0&&(l.alphaMap=i(e.alphaMap),l.transparent=!0),e.bumpMap!==void 0&&(l.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(l.bumpScale=e.bumpScale),e.normalMap!==void 0&&(l.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(l.normalMapType=e.normalMapType),e.normalScale!==void 0){var r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),l.normalScale=new Rt().fromArray(r)}return e.displacementMap!==void 0&&(l.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(l.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(l.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(l.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(l.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(l.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(l.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(l.specularMap=i(e.specularMap)),e.envMap!==void 0&&(l.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(l.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(l.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(l.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(l.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(l.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(l.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(l.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(l.gradientMap=i(e.gradientMap)),e.clearcoatNormalMap!==void 0&&(l.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(l.clearcoatNormalScale=new Rt().fromArray(e.clearcoatNormalScale)),l},setTextures:function(e){return this.textures=e,this}});var Cl={decodeText:function(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);for(var t="",i=0,l=e.length;i<l;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(c){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}};function hx(){_n.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}hx.prototype=Object.assign(Object.create(_n.prototype),{constructor:hx,isInstancedBufferGeometry:!0,copy:function(e){return _n.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=_n.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}});function dx(e,t,i,l){typeof i=="number"&&(l=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Un.call(this,e,t,i),this.meshPerAttribute=l||1}dx.prototype=Object.assign(Object.create(Un.prototype),{constructor:dx,isInstancedBufferAttribute:!0,copy:function(e){return Un.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Un.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});function px(e){ui.call(this,e)}px.prototype=Object.assign(Object.create(ui.prototype),{constructor:px,load:function(e,t,i,l){var c=this,h=new Co(c.manager);h.setPath(c.path),h.load(e,function(f){t(c.parse(JSON.parse(f)))},i,l)},parse:function(e){var t=e.isInstancedBufferGeometry?new hx:new _n,i=e.data.index;if(i!==void 0){var l=new fx[i.type](i.array);t.setIndex(new Un(l,1))}var c=e.data.attributes;for(var h in c){var f=c[h],l=new fx[f.type](f.array),r=f.isInstancedBufferAttribute?dx:Un,v=new r(l,f.itemSize,f.normalized);f.name!==void 0&&(v.name=f.name),t.setAttribute(h,v)}var _=e.data.morphAttributes;if(_)for(var h in _){for(var w=_[h],b=[],E=0,P=w.length;E<P;E++){var f=w[E],l=new fx[f.type](f.array),v=new Un(l,f.itemSize,f.normalized);f.name!==void 0&&(v.name=f.name),b.push(v)}t.morphAttributes[h]=b}var I=e.data.morphTargetsRelative;I&&(t.morphTargetsRelative=!0);var F=e.data.groups||e.data.drawcalls||e.data.offsets;if(F!==void 0)for(var E=0,B=F.length;E!==B;++E){var O=F[E];t.addGroup(O.start,O.count,O.materialIndex)}var W=e.data.boundingSphere;if(W!==void 0){var Z=new xe;W.center!==void 0&&Z.fromArray(W.center),t.boundingSphere=new Va(Z,W.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var fx={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function mx(e){ui.call(this,e)}mx.prototype=Object.assign(Object.create(ui.prototype),{constructor:mx,load:function(e,t,i,l){var c=this,h=this.path===""?Cl.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||h;var f=new Co(c.manager);f.setPath(this.path),f.load(e,function(r){var v=null;try{v=JSON.parse(r)}catch(w){l!==void 0&&l(w),console.error("THREE:ObjectLoader: Can't parse "+e+".",w.message);return}var _=v.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}c.parse(v,t)},i,l)},parse:function(e,t){var i=this.parseShape(e.shapes),l=this.parseGeometries(e.geometries,i),c=this.parseImages(e.images,function(){t!==void 0&&t(r)}),h=this.parseTextures(e.textures,c),f=this.parseMaterials(e.materials,h),r=this.parseObject(e.object,l,f);return e.animations&&(r.animations=this.parseAnimations(e.animations)),(e.images===void 0||e.images.length===0)&&t!==void 0&&t(r),r},parseShape:function(e){var t={};if(e!==void 0)for(var i=0,l=e.length;i<l;i++){var c=new Pl().fromJSON(e[i]);t[c.uuid]=c}return t},parseGeometries:function(e,t){var i={};if(e!==void 0)for(var l=new px,c=0,h=e.length;c<h;c++){var f,r=e[c];switch(r.type){case"PlaneGeometry":case"PlaneBufferGeometry":f=new Ir[r.type](r.width,r.height,r.widthSegments,r.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":f=new Ir[r.type](r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":f=new Ir[r.type](r.radius,r.segments,r.thetaStart,r.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":f=new Ir[r.type](r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":f=new Ir[r.type](r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":f=new Ir[r.type](r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":f=new Ir[r.type](r.radius,r.detail);break;case"RingGeometry":case"RingBufferGeometry":f=new Ir[r.type](r.innerRadius,r.outerRadius,r.thetaSegments,r.phiSegments,r.thetaStart,r.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":f=new Ir[r.type](r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":f=new Ir[r.type](r.radius,r.tube,r.tubularSegments,r.radialSegments,r.p,r.q);break;case"TubeGeometry":case"TubeBufferGeometry":f=new Ir[r.type](new ix[r.path.type]().fromJSON(r.path),r.tubularSegments,r.radius,r.radialSegments,r.closed);break;case"LatheGeometry":case"LatheBufferGeometry":f=new Ir[r.type](r.points,r.segments,r.phiStart,r.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":f=new Ir[r.type](r.vertices,r.indices,r.radius,r.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var b=[],v=0,_=r.shapes.length;v<_;v++){var w=t[r.shapes[v]];b.push(w)}f=new Ir[r.type](b,r.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(var b=[],v=0,_=r.shapes.length;v<_;v++){var w=t[r.shapes[v]];b.push(w)}var E=r.options.extrudePath;E!==void 0&&(r.options.extrudePath=new ix[E.type]().fromJSON(E)),f=new Ir[r.type](b,r.options);break;case"BufferGeometry":case"InstancedBufferGeometry":f=l.parse(r);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var P=new THREE.LegacyJSONLoader;f=P.parse(r,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+r.type+'"');continue}f.uuid=r.uuid,r.name!==void 0&&(f.name=r.name),f.isBufferGeometry===!0&&r.userData!==void 0&&(f.userData=r.userData),i[r.uuid]=f}return i},parseMaterials:function(e,t){var i={},l={};if(e!==void 0){var c=new ux;c.setTextures(t);for(var h=0,f=e.length;h<f;h++){var r=e[h];if(r.type==="MultiMaterial"){for(var v=[],_=0;_<r.materials.length;_++){var w=r.materials[_];i[w.uuid]===void 0&&(i[w.uuid]=c.parse(w)),v.push(i[w.uuid])}l[r.uuid]=v}else i[r.uuid]===void 0&&(i[r.uuid]=c.parse(r)),l[r.uuid]=i[r.uuid]}}return l},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var l=e[i],c=Po.parse(l);l.uuid!==void 0&&(c.uuid=l.uuid),t.push(c)}return t},parseImages:function(e,t){var i=this,l={};function c(F){return i.manager.itemStart(F),f.load(F,function(){i.manager.itemEnd(F)},void 0,function(){i.manager.itemError(F),i.manager.itemEnd(F)})}if(e!==void 0&&e.length>0){var h=new Zb(t),f=new Cd(h);f.setCrossOrigin(this.crossOrigin);for(var r=0,v=e.length;r<v;r++){var _=e[r],w=_.url;if(Array.isArray(w)){l[_.uuid]=[];for(var b=0,E=w.length;b<E;b++){var P=w[b],I=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(P)?P:i.resourcePath+P;l[_.uuid].push(c(I))}}else{var I=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(_.url)?_.url:i.resourcePath+_.url;l[_.uuid]=c(I)}}}return l},parseTextures:function(e,t){function i(v,_){return typeof v=="number"?v:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",v),_[v])}var l={};if(e!==void 0)for(var c=0,h=e.length;c<h;c++){var f=e[c];f.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',f.uuid),t[f.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",f.image);var r;Array.isArray(t[f.image])?r=new bs(t[f.image]):r=new bi(t[f.image]),r.needsUpdate=!0,r.uuid=f.uuid,f.name!==void 0&&(r.name=f.name),f.mapping!==void 0&&(r.mapping=i(f.mapping,r4)),f.offset!==void 0&&r.offset.fromArray(f.offset),f.repeat!==void 0&&r.repeat.fromArray(f.repeat),f.center!==void 0&&r.center.fromArray(f.center),f.rotation!==void 0&&(r.rotation=f.rotation),f.wrap!==void 0&&(r.wrapS=i(f.wrap[0],tw),r.wrapT=i(f.wrap[1],tw)),f.format!==void 0&&(r.format=f.format),f.type!==void 0&&(r.type=f.type),f.encoding!==void 0&&(r.encoding=f.encoding),f.minFilter!==void 0&&(r.minFilter=i(f.minFilter,nw)),f.magFilter!==void 0&&(r.magFilter=i(f.magFilter,nw)),f.anisotropy!==void 0&&(r.anisotropy=f.anisotropy),f.flipY!==void 0&&(r.flipY=f.flipY),f.premultiplyAlpha!==void 0&&(r.premultiplyAlpha=f.premultiplyAlpha),f.unpackAlignment!==void 0&&(r.unpackAlignment=f.unpackAlignment),l[f.uuid]=r}return l},parseObject:function(e,t,i){var l;function c(B){return t[B]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",B),t[B]}function h(B){if(B!==void 0){if(Array.isArray(B)){for(var O=[],W=0,Z=B.length;W<Z;W++){var ie=B[W];i[ie]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ie),O.push(i[ie])}return O}return i[B]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",B),i[B]}}switch(e.type){case"Scene":l=new Ua,e.background!==void 0&&Number.isInteger(e.background)&&(l.background=new nn(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new z0(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new B0(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":l=new tr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new bu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new lx(e.color,e.intensity);break;case"DirectionalLight":l=new zm(e.color,e.intensity);break;case"PointLight":l=new Bm(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new cx(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new km(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":l=new rx(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var f=c(e.geometry),r=h(e.material);f.bones&&f.bones.length>0?l=new hd(f,r):l=new Fi(f,r);break;case"InstancedMesh":var f=c(e.geometry),r=h(e.material),v=e.count,_=e.instanceMatrix;l=new O0(f,r,v),l.instanceMatrix=new Un(new Float32Array(_.array),16);break;case"LOD":l=new nm;break;case"Line":l=new fo(c(e.geometry),h(e.material),e.mode);break;case"LineLoop":l=new lm(c(e.geometry),h(e.material));break;case"LineSegments":l=new Xi(c(e.geometry),h(e.material));break;case"PointCloud":case"Points":l=new hm(c(e.geometry),h(e.material));break;case"Sprite":l=new N0(h(e.material));break;case"Group":l=new Al;break;default:l=new on}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0)for(var w=e.children,b=0;b<w.length;b++)l.add(this.parseObject(w[b],t,i));if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);for(var E=e.levels,P=0;P<E.length;P++){var I=E[P],F=l.getObjectByProperty("uuid",I.object);F!==void 0&&l.addLevel(F,I.distance)}}return l}});var r4={UVMapping:Jy,CubeReflectionMapping:Qy,CubeRefractionMapping:$y,EquirectangularReflectionMapping:C1,EquirectangularRefractionMapping:e0,SphericalReflectionMapping:R1,CubeUVReflectionMapping:Vh,CubeUVRefractionMapping:t0},tw={RepeatWrapping:dl,ClampToEdgeWrapping:Rr,MirroredRepeatWrapping:Oh},nw={NearestFilter:Yi,NearestMipmapNearestFilter:Ef,NearestMipmapLinearFilter:Pf,LinearFilter:$i,LinearMipmapNearestFilter:n0,LinearMipmapLinearFilter:Sc};function iw(e){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ui.call(this,e),this.options=void 0}iw.prototype=Object.assign(Object.create(ui.prototype),{constructor:iw,setOptions:function(t){return this.options=t,this},load:function(e,t,i,l){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var c=this,h=_u.get(e);if(h!==void 0)return c.manager.itemStart(e),setTimeout(function(){t&&t(h),c.manager.itemEnd(e)},0),h;fetch(e).then(function(f){return f.blob()}).then(function(f){return c.options===void 0?createImageBitmap(f):createImageBitmap(f,c.options)}).then(function(f){_u.add(e,f),t&&t(f),c.manager.itemEnd(e)}).catch(function(f){l&&l(f),c.manager.itemError(e),c.manager.itemEnd(e)}),c.manager.itemStart(e)}});function rw(){this.type="ShapePath",this.color=new nn,this.subPaths=[],this.currentPath=null}Object.assign(rw.prototype,{moveTo:function(e,t){return this.currentPath=new da,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,i,l){return this.currentPath.quadraticCurveTo(e,t,i,l),this},bezierCurveTo:function(e,t,i,l,c,h){return this.currentPath.bezierCurveTo(e,t,i,l,c,h),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function i(Ue){for(var ot=[],Pt=0,mt=Ue.length;Pt<mt;Pt++){var _t=Ue[Pt],ft=new Pl;ft.curves=_t.curves,ot.push(ft)}return ot}function l(Ue,ot){for(var Pt=ot.length,mt=!1,_t=Pt-1,ft=0;ft<Pt;_t=ft++){var Vt=ot[_t],we=ot[ft],pe=we.x-Vt.x,ke=we.y-Vt.y;if(Math.abs(ke)>Number.EPSILON){if(ke<0&&(Vt=ot[ft],pe=-pe,we=ot[_t],ke=-ke),Ue.y<Vt.y||Ue.y>we.y)continue;if(Ue.y===Vt.y){if(Ue.x===Vt.x)return!0}else{var De=ke*(Ue.x-Vt.x)-pe*(Ue.y-Vt.y);if(De===0)return!0;if(De<0)continue;mt=!mt}}else{if(Ue.y!==Vt.y)continue;if(we.x<=Ue.x&&Ue.x<=Vt.x||Vt.x<=Ue.x&&Ue.x<=we.x)return!0}}return mt}var c=Ms.isClockWise,h=this.subPaths;if(h.length===0)return[];if(t===!0)return i(h);var f,r,v,_=[];if(h.length===1)return r=h[0],v=new Pl,v.curves=r.curves,_.push(v),_;var w=!c(h[0].getPoints());w=e?!w:w;var b=[],E=[],P=[],I=0,F;E[I]=void 0,P[I]=[];for(var B=0,O=h.length;B<O;B++)r=h[B],F=r.getPoints(),f=c(F),f=e?!f:f,f?(!w&&E[I]&&I++,E[I]={s:new Pl,p:F},E[I].s.curves=r.curves,w&&I++,P[I]=[]):P[I].push({h:r,p:F[0]});if(!E[0])return i(h);if(E.length>1){for(var W=!1,Z=[],ie=0,$=E.length;ie<$;ie++)b[ie]=[];for(var ie=0,$=E.length;ie<$;ie++)for(var oe=P[ie],be=0;be<oe.length;be++){for(var fe=oe[be],Le=!0,Xe=0;Xe<E.length;Xe++)l(fe.p,E[Xe].p)&&(ie!==Xe&&Z.push({froms:ie,tos:Xe,hole:be}),Le?(Le=!1,b[Xe].push(fe)):W=!0);Le&&b[ie].push(fe)}Z.length>0&&(W||(P=b))}for(var Ne,B=0,Re=E.length;B<Re;B++){v=E[B].s,_.push(v),Ne=P[B];for(var Ie=0,He=Ne.length;Ie<He;Ie++)v.holes.push(Ne[Ie].h)}return _}});function ow(e){this.type="Font",this.data=e}Object.assign(ow.prototype,{isFont:!0,generateShapes:function(e,t){t===void 0&&(t=100);for(var i=[],l=o4(e,t,this.data),c=0,h=l.length;c<h;c++)Array.prototype.push.apply(i,l[c].toShapes());return i}});function o4(e,t,i){for(var l=Array.from?Array.from(e):String(e).split(""),c=t/i.resolution,h=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*c,f=[],r=0,v=0,_=0;_<l.length;_++){var w=l[_];if(w===`
`)r=0,v-=h;else{var b=a4(w,c,r,v,i);r+=b.offsetX,f.push(b.path)}}return f}function a4(e,t,i,l,c){var h=c.glyphs[e]||c.glyphs["?"];if(!h){console.error('THREE.Font: character "'+e+'" does not exists in font family '+c.familyName+".");return}var f=new rw,r,v,_,w,b,E,P,I;if(h.o)for(var F=h._cachedOutline||(h._cachedOutline=h.o.split(" ")),B=0,O=F.length;B<O;){var W=F[B++];switch(W){case"m":r=F[B++]*t+i,v=F[B++]*t+l,f.moveTo(r,v);break;case"l":r=F[B++]*t+i,v=F[B++]*t+l,f.lineTo(r,v);break;case"q":_=F[B++]*t+i,w=F[B++]*t+l,b=F[B++]*t+i,E=F[B++]*t+l,f.quadraticCurveTo(b,E,_,w);break;case"b":_=F[B++]*t+i,w=F[B++]*t+l,b=F[B++]*t+i,E=F[B++]*t+l,P=F[B++]*t+i,I=F[B++]*t+l,f.bezierCurveTo(b,E,P,I,_,w);break}}return{offsetX:h.ha*t,path:f}}function aw(e){ui.call(this,e)}aw.prototype=Object.assign(Object.create(ui.prototype),{constructor:aw,load:function(e,t,i,l){var c=this,h=new Co(this.manager);h.setPath(this.path),h.load(e,function(f){var r;try{r=JSON.parse(f)}catch(_){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(f.substring(65,f.length-2))}var v=c.parse(r);t&&t(v)},i,l)},parse:function(e){return new ow(e)}});var Um,sw={getContext:function(){return Um===void 0&&(Um=new(window.AudioContext||window.webkitAudioContext)),Um},setContext:function(e){Um=e}};function gx(e){ui.call(this,e)}gx.prototype=Object.assign(Object.create(ui.prototype),{constructor:gx,load:function(e,t,i,l){var c=new Co(this.manager);c.setResponseType("arraybuffer"),c.setPath(this.path),c.load(e,function(h){var f=h.slice(0),r=sw.getContext();r.decodeAudioData(f,function(v){t(v)})},i,l)}});function yx(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new xe)}Object.assign(yx.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var i=e.x,l=e.y,c=e.z,h=this.coefficients;return t.copy(h[0]).multiplyScalar(.282095),t.addScale(h[1],.488603*l),t.addScale(h[2],.488603*c),t.addScale(h[3],.488603*i),t.addScale(h[4],1.092548*(i*l)),t.addScale(h[5],1.092548*(l*c)),t.addScale(h[6],.315392*(3*c*c-1)),t.addScale(h[7],1.092548*(i*c)),t.addScale(h[8],.546274*(i*i-l*l)),t},getIrradianceAt:function(e,t){var i=e.x,l=e.y,c=e.z,h=this.coefficients;return t.copy(h[0]).multiplyScalar(.886227),t.addScale(h[1],2*.511664*l),t.addScale(h[2],2*.511664*c),t.addScale(h[3],2*.511664*i),t.addScale(h[4],2*.429043*i*l),t.addScale(h[5],2*.429043*l*c),t.addScale(h[6],.743125*c*c-.247708),t.addScale(h[7],2*.429043*i*c),t.addScale(h[8],.429043*(i*i-l*l)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,t){t===void 0&&(t=0);for(var i=this.coefficients,l=0;l<9;l++)i[l].fromArray(e,t+l*3);return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);for(var i=this.coefficients,l=0;l<9;l++)i[l].toArray(e,t+l*3);return e}}),Object.assign(yx,{getBasisAt:function(e,t){var i=e.x,l=e.y,c=e.z;t[0]=.282095,t[1]=.488603*l,t[2]=.488603*c,t[3]=.488603*i,t[4]=1.092548*i*l,t[5]=1.092548*l*c,t[6]=.315392*(3*c*c-1),t[7]=1.092548*i*c,t[8]=.546274*(i*i-l*l)}});function pa(e,t){Ci.call(this,void 0,t),this.sh=e!==void 0?e:new yx}pa.prototype=Object.assign(Object.create(Ci.prototype),{constructor:pa,isLightProbe:!0,copy:function(e){return Ci.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){var t=Ci.prototype.toJSON.call(this,e);return t}});function lw(e,t,i){pa.call(this,void 0,i);var l=new nn().set(e),c=new nn().set(t),h=new xe(l.r,l.g,l.b),f=new xe(c.r,c.g,c.b),r=Math.sqrt(Math.PI),v=r*Math.sqrt(.75);this.sh.coefficients[0].copy(h).add(f).multiplyScalar(r),this.sh.coefficients[1].copy(h).sub(f).multiplyScalar(v)}lw.prototype=Object.assign(Object.create(pa.prototype),{constructor:lw,isHemisphereLightProbe:!0,copy:function(e){return pa.prototype.copy.call(this,e),this},toJSON:function(e){var t=pa.prototype.toJSON.call(this,e);return t}});function cw(e,t){pa.call(this,void 0,t);var i=new nn().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}cw.prototype=Object.assign(Object.create(pa.prototype),{constructor:cw,isAmbientLightProbe:!0,copy:function(e){return pa.prototype.copy.call(this,e),this},toJSON:function(e){var t=pa.prototype.toJSON.call(this,e);return t}});var uw=new Kn,hw=new Kn;function s4(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new tr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new tr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(s4.prototype,{update:function(e){var t=this._cache,i=t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep;if(i){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var l=e.projectionMatrix.clone(),c=t.eyeSep/2,h=c*t.near/t.focus,f=t.near*Math.tan(Xn.DEG2RAD*t.fov*.5)/t.zoom,r,v;hw.elements[12]=-c,uw.elements[12]=c,r=-f*t.aspect+h,v=f*t.aspect+h,l.elements[0]=2*t.near/(v-r),l.elements[8]=(v+r)/(v-r),this.cameraL.projectionMatrix.copy(l),r=-f*t.aspect-h,v=f*t.aspect-h,l.elements[0]=2*t.near/(v-r),l.elements[8]=(v+r)/(v-r),this.cameraR.projectionMatrix.copy(l)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hw),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(uw)}});function dw(e){this.autoStart=e!==void 0?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(dw.prototype,{start:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=(typeof performance=="undefined"?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var Rl=new xe,pw=new qr,l4=new xe,Dl=new xe;function fw(){on.call(this),this.type="AudioListener",this.context=sw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dw}fw.prototype=Object.assign(Object.create(on.prototype),{constructor:fw,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){on.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Rl,pw,l4),Dl.set(0,0,-1).applyQuaternion(pw),t.positionX){var l=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Rl.x,l),t.positionY.linearRampToValueAtTime(Rl.y,l),t.positionZ.linearRampToValueAtTime(Rl.z,l),t.forwardX.linearRampToValueAtTime(Dl.x,l),t.forwardY.linearRampToValueAtTime(Dl.y,l),t.forwardZ.linearRampToValueAtTime(Dl.z,l),t.upX.linearRampToValueAtTime(i.x,l),t.upY.linearRampToValueAtTime(i.y,l),t.upZ.linearRampToValueAtTime(i.z,l)}else t.setPosition(Rl.x,Rl.y,Rl.z),t.setOrientation(Dl.x,Dl.y,Dl.z,i.x,i.y,i.z)}});function Ld(e){on.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Ld.prototype=Object.assign(Object.create(on.prototype),{constructor:Ld,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(e===void 0&&(e=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var Il=new xe,mw=new qr,c4=new xe,Ll=new xe;function gw(e){Ld.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}gw.prototype=Object.assign(Object.create(Ld.prototype),{constructor:gw,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(e){if(on.prototype.updateMatrixWorld.call(this,e),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(Il,mw,c4),Ll.set(0,0,1).applyQuaternion(mw);var t=this.panner;if(t.positionX){var i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Il.x,i),t.positionY.linearRampToValueAtTime(Il.y,i),t.positionZ.linearRampToValueAtTime(Il.z,i),t.orientationX.linearRampToValueAtTime(Ll.x,i),t.orientationY.linearRampToValueAtTime(Ll.y,i),t.orientationZ.linearRampToValueAtTime(Ll.z,i)}else t.setPosition(Il.x,Il.y,Il.z),t.setOrientation(Ll.x,Ll.y,Ll.z)}}});function yw(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t!==void 0?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}Object.assign(yw.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}});function xw(e,t,i){this.binding=e,this.valueSize=i;var l=Float64Array,c;switch(t){case"quaternion":c=this._slerp;break;case"string":case"bool":l=Array,c=this._select;break;default:c=this._lerp}this.buffer=new l(i*4),this._mixBufferRegion=c,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(xw.prototype,{accumulate:function(e,t){var i=this.buffer,l=this.valueSize,c=e*l+l,h=this.cumulativeWeight;if(h===0){for(var f=0;f!==l;++f)i[c+f]=i[f];h=t}else{h+=t;var r=t/h;this._mixBufferRegion(i,c,0,r,l)}this.cumulativeWeight=h},apply:function(e){var t=this.valueSize,i=this.buffer,l=e*t+t,c=this.cumulativeWeight,h=this.binding;if(this.cumulativeWeight=0,c<1){var f=t*3;this._mixBufferRegion(i,l,f,1-c,t)}for(var r=t,v=t+t;r!==v;++r)if(i[r]!==i[r+t]){h.setValue(i,l);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,l=i*3;e.getValue(t,l);for(var c=i,h=l;c!==h;++c)t[c]=t[l+c%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,l,c){if(l>=.5)for(var h=0;h!==c;++h)e[t+h]=e[i+h]},_slerp:function(e,t,i,l){qr.slerpFlat(e,t,e,t,e,i,l)},_lerp:function(e,t,i,l,c){for(var h=1-l,f=0;f!==c;++f){var r=t+f;e[r]=e[r]*h+e[i+f]*l}}});var xx="\\[\\]\\.:\\/",u4=new RegExp("["+xx+"]","g"),vx="[^"+xx+"]",h4="[^"+xx.replace("\\.","")+"]",d4=/((?:WC+[\/:])*)/.source.replace("WC",vx),p4=/(WCOD+)?/.source.replace("WCOD",h4),f4=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vx),m4=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vx),g4=new RegExp("^"+d4+p4+f4+m4+"$"),y4=["material","materials","bones"];function vw(e,t,i){var l=i||Ar.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,l)}Object.assign(vw.prototype,{getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,l=this._bindings[i];l!==void 0&&l.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,l=this._targetGroup.nCachedObjects_,c=i.length;l!==c;++l)i[l].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}});function Ar(e,t,i){this.path=t,this.parsedPath=i||Ar.parseTrackName(t),this.node=Ar.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(Ar,{Composite:vw,create:function(e,t,i){return e&&e.isAnimationObjectGroup?new Ar.Composite(e,t,i):new Ar(e,t,i)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(u4,"")},parseTrackName:function(e){var t=g4.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},l=i.nodeName&&i.nodeName.lastIndexOf(".");if(l!==void 0&&l!==-1){var c=i.nodeName.substring(l+1);y4.indexOf(c)!==-1&&(i.nodeName=i.nodeName.substring(0,l),i.objectName=c)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i},findNode:function(e,t){if(!t||t===""||t==="root"||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){var i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){var l=function(h){for(var f=0;f<h.length;f++){var r=h[f];if(r.name===t||r.uuid===t)return r;var v=l(r.children);if(v)return v}return null},c=l(e.children);if(c)return c}return null}}),Object.assign(Ar.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,i){t[i]=this.node[this.propertyName]},function(t,i){for(var l=this.resolvedProperty,c=0,h=l.length;c!==h;++c)t[i++]=l[c]},function(t,i){t[i]=this.resolvedProperty[this.propertyIndex]},function(t,i){this.resolvedProperty.toArray(t,i)}],SetterByBindingTypeAndVersioning:[[function(t,i){this.targetObject[this.propertyName]=t[i]},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){for(var l=this.resolvedProperty,c=0,h=l.length;c!==h;++c)l[c]=t[i++]},function(t,i){for(var l=this.resolvedProperty,c=0,h=l.length;c!==h;++c)l[c]=t[i++];this.targetObject.needsUpdate=!0},function(t,i){for(var l=this.resolvedProperty,c=0,h=l.length;c!==h;++c)l[c]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty[this.propertyIndex]=t[i]},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,i){this.resolvedProperty.fromArray(t,i)},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0},function(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,i){this.bind(),this.getValue(t,i)},setValue:function(t,i){this.bind(),this.setValue(t,i)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,l=t.propertyName,c=t.propertyIndex;if(e||(e=Ar.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){var h=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var f=0;f<e.length;f++)if(e[f].name===h){h=f;break}break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}var r=e[l];if(r===void 0){var v=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+v+"."+l+" but it wasn't found.",e);return}var _=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?_=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(_=this.Versioning.MatrixWorldNeedsUpdate);var w=this.BindingType.Direct;if(c!==void 0){if(l==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var f=0;f<this.node.geometry.morphAttributes.position.length;f++)if(e.geometry.morphAttributes.position[f].name===c){c=f;break}}else{if(!e.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var f=0;f<this.node.geometry.morphTargets.length;f++)if(e.geometry.morphTargets[f].name===c){c=f;break}}}w=this.BindingType.ArrayElement,this.resolvedProperty=r,this.propertyIndex=c}else r.fromArray!==void 0&&r.toArray!==void 0?(w=this.BindingType.HasFromToArray,this.resolvedProperty=r):Array.isArray(r)?(w=this.BindingType.EntireArray,this.resolvedProperty=r):this.propertyName=l;this.getValue=this.GetterByBindingType[w],this.setValue=this.SetterByBindingTypeAndVersioning[w][_]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Ar.prototype,{_getValue_unbound:Ar.prototype.getValue,_setValue_unbound:Ar.prototype.setValue});function x4(){this.uuid=Xn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,i=arguments.length;t!==i;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var l=this;this.stats={objects:{get total(){return l._objects.length},get inUse(){return this.total-l.nCachedObjects_}},get bindingsPerObject(){return l._bindings.length}}}Object.assign(x4.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,l=this._indicesByUUID,c=this._paths,h=this._parsedPaths,f=this._bindings,r=f.length,v=void 0,_=0,w=arguments.length;_!==w;++_){var b=arguments[_],E=b.uuid,P=l[E];if(P===void 0){P=t++,l[E]=P,e.push(b);for(var I=0,F=r;I!==F;++I)f[I].push(new Ar(b,c[I],h[I]))}else if(P<i){v=e[P];var B=--i,O=e[B];l[O.uuid]=P,e[P]=O,l[E]=B,e[B]=b;for(var I=0,F=r;I!==F;++I){var W=f[I],Z=W[B],ie=W[P];W[P]=Z,ie===void 0&&(ie=new Ar(b,c[I],h[I])),W[B]=ie}}else e[P]!==v&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,i=this._indicesByUUID,l=this._bindings,c=l.length,h=0,f=arguments.length;h!==f;++h){var r=arguments[h],v=r.uuid,_=i[v];if(_!==void 0&&_>=t){var w=t++,b=e[w];i[b.uuid]=_,e[_]=b,i[v]=w,e[w]=r;for(var E=0,P=c;E!==P;++E){var I=l[E],F=I[w],B=I[_];I[_]=F,I[w]=B}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,l=this._indicesByUUID,c=this._bindings,h=c.length,f=0,r=arguments.length;f!==r;++f){var v=arguments[f],_=v.uuid,w=l[_];if(w!==void 0)if(delete l[_],w<i){var b=--i,E=e[b],P=--t,I=e[P];l[E.uuid]=w,e[w]=E,l[I.uuid]=b,e[b]=I,e.pop();for(var F=0,B=h;F!==B;++F){var O=c[F],W=O[b],Z=O[P];O[w]=W,O[b]=Z,O.pop()}}else{var P=--t,I=e[P];l[I.uuid]=w,e[w]=I,e.pop();for(var F=0,B=h;F!==B;++F){var O=c[F];O[w]=O[P],O.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,l=i[e],c=this._bindings;if(l!==void 0)return c[l];var h=this._paths,f=this._parsedPaths,r=this._objects,v=r.length,_=this.nCachedObjects_,w=new Array(v);l=c.length,i[e]=l,h.push(e),f.push(t),c.push(w);for(var b=_,E=r.length;b!==E;++b){var P=r[b];w[b]=new Ar(P,e,t)}return w},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){var l=this._paths,c=this._parsedPaths,h=this._bindings,f=h.length-1,r=h[f],v=e[f];t[v]=i,h[i]=r,h.pop(),c[i]=c[f],c.pop(),l[i]=l[f],l.pop()}}});function _w(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var l=t.tracks,c=l.length,h=new Array(c),f={endingStart:Pc,endingEnd:Pc},r=0;r!==c;++r){var v=l[r].createInterpolant(null);h[r]=v,v.settings=f}this._interpolantSettings=f,this._interpolants=h,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=dC,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(_w.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){var l=this._clip.duration,c=e._clip.duration,h=c/l,f=l/c;e.warp(1,h,t),this.warp(f,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var l=this._mixer,c=l.time,h=this._timeScaleInterpolant,f=this.timeScale;h===null&&(h=l._lendControlInterpolant(),this._timeScaleInterpolant=h);var r=h.parameterPositions,v=h.sampleValues;return r[0]=c,r[1]=c+i,v[0]=e/f,v[1]=t/f,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,l){if(!this.enabled){this._updateWeight(e);return}var c=this._startTime;if(c!==null){var h=(e-c)*i;if(h<0||i===0)return;this._startTime=null,t=i*h}t*=this._updateTimeScale(e);var f=this._updateTime(t),r=this._updateWeight(e);if(r>0)for(var v=this._interpolants,_=this._propertyBindings,w=0,b=v.length;w!==b;++w)v[w].evaluate(f),_[w].accumulate(l,r)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(i!==null){var l=i.evaluate(e)[0];t*=l,e>i.parameterPositions[1]&&(this.stopFading(),l===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(i!==null){var l=i.evaluate(e)[0];t*=l,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,i=this._clip.duration,l=this.loop,c=this._loopCount,h=l===pC;if(e===0)return c===-1?t:h&&(c&1)===1?i-t:t;if(l===hC){c===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=i)t=i;else if(t<0)t=0;else{this.time=t;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(c===-1&&(e>=0?(c=0,this._setEndings(!0,this.repetitions===0,h)):this._setEndings(this.repetitions===0,!0,h)),t>=i||t<0){var f=Math.floor(t/i);t-=i*f,c+=Math.abs(f);var r=this.repetitions-c;if(r<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?i:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(r===1){var v=e<0;this._setEndings(v,!v,h)}else this._setEndings(!1,!1,h);this._loopCount=c,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=t;if(h&&(c&1)===1)return i-t}return t},_setEndings:function(e,t,i){var l=this._interpolantSettings;i?(l.endingStart=Cc,l.endingEnd=Cc):(e?l.endingStart=this.zeroSlopeAtStart?Cc:Pc:l.endingStart=If,t?l.endingEnd=this.zeroSlopeAtEnd?Cc:Pc:l.endingEnd=If)},_scheduleFading:function(e,t,i){var l=this._mixer,c=l.time,h=this._weightInterpolant;h===null&&(h=l._lendControlInterpolant(),this._weightInterpolant=h);var f=h.parameterPositions,r=h.sampleValues;return f[0]=c,r[0]=t,f[1]=c+e,r[1]=i,this}});function bw(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}bw.prototype=Object.assign(Object.create(Ba.prototype),{constructor:bw,_bindAction:function(e,t){var i=e._localRoot||this._root,l=e._clip.tracks,c=l.length,h=e._propertyBindings,f=e._interpolants,r=i.uuid,v=this._bindingsByRootAndName,_=v[r];_===void 0&&(_={},v[r]=_);for(var w=0;w!==c;++w){var b=l[w],E=b.name,P=_[E];if(P!==void 0)h[w]=P;else{if(P=h[w],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,r,E));continue}var I=t&&t._propertyBindings[w].binding.parsedPath;P=new xw(Ar.create(i,E,I),b.ValueTypeName,b.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,r,E),h[w]=P}f[w].resultBuffer=P.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,l=this._actionsByClip[i];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,i,t)}for(var c=e._propertyBindings,h=0,f=c.length;h!==f;++h){var r=c[h];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,i=0,l=t.length;i!==l;++i){var c=t[i];--c.useCount===0&&(c.restoreOriginalState(),this._takeBackBinding(c))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return t!==null&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var l=this._actions,c=this._actionsByClip,h=c[t];if(h===void 0)h={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,c[t]=h;else{var f=h.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=l.length,l.push(e),h.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],l=e._cacheIndex;i._cacheIndex=l,t[l]=i,t.pop(),e._cacheIndex=null;var c=e._clip.uuid,h=this._actionsByClip,f=h[c],r=f.knownActions,v=r[r.length-1],_=e._byClipCacheIndex;v._byClipCacheIndex=_,r[_]=v,r.pop(),e._byClipCacheIndex=null;var w=f.actionByRoot,b=(e._localRoot||this._root).uuid;delete w[b],r.length===0&&delete h[c],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,i=0,l=t.length;i!==l;++i){var c=t[i];--c.referenceCount===0&&this._removeInactiveBinding(c)}},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,l=this._nActiveActions++,c=t[l];e._cacheIndex=l,t[l]=e,c._cacheIndex=i,t[i]=c},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,l=--this._nActiveActions,c=t[l];e._cacheIndex=l,t[l]=e,c._cacheIndex=i,t[i]=c},_addInactiveBinding:function(e,t,i){var l=this._bindingsByRootAndName,c=l[t],h=this._bindings;c===void 0&&(c={},l[t]=c),c[i]=e,e._cacheIndex=h.length,h.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,l=i.rootNode.uuid,c=i.path,h=this._bindingsByRootAndName,f=h[l],r=t[t.length-1],v=e._cacheIndex;r._cacheIndex=v,t[v]=r,t.pop(),delete f[c],Object.keys(f).length===0&&delete h[l]},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,l=this._nActiveBindings++,c=t[l];e._cacheIndex=l,t[l]=e,c._cacheIndex=i,t[i]=c},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,l=--this._nActiveBindings,c=t[l];e._cacheIndex=l,t[l]=e,c._cacheIndex=i,t[i]=c},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return i===void 0&&(i=new Im(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=t,e[t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,l=--this._nActiveControlInterpolants,c=t[l];e.__cacheIndex=l,t[l]=e,c.__cacheIndex=i,t[i]=c},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var i=t||this._root,l=i.uuid,c=typeof e=="string"?Po.findByName(i,e):e,h=c!==null?c.uuid:e,f=this._actionsByClip[h],r=null;if(f!==void 0){var v=f.actionByRoot[l];if(v!==void 0)return v;r=f.knownActions[0],c===null&&(c=r._clip)}if(c===null)return null;var _=new _w(this,c,t);return this._bindAction(_,r),this._addInactiveAction(_,h,l),_},existingAction:function(e,t){var i=t||this._root,l=i.uuid,c=typeof e=="string"?Po.findByName(i,e):e,h=c?c.uuid:e,f=this._actionsByClip[h];return f!==void 0&&f.actionByRoot[l]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,l=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var c=0;c!==t;++c)e[c].reset();for(var c=0;c!==l;++c)i[c].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,l=this.time+=e,c=Math.sign(e),h=this._accuIndex^=1,f=0;f!==i;++f){var r=t[f];r._update(l,e,c,h)}for(var v=this._bindings,_=this._nActiveBindings,f=0;f!==_;++f)v[f].apply(h);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,l=this._actionsByClip,c=l[i];if(c!==void 0){for(var h=c.knownActions,f=0,r=h.length;f!==r;++f){var v=h[f];this._deactivateAction(v);var _=v._cacheIndex,w=t[t.length-1];v._cacheIndex=null,v._byClipCacheIndex=null,w._cacheIndex=_,t[_]=w,t.pop(),this._removeInactiveBindingsForAction(v)}delete l[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var l in i){var c=i[l].actionByRoot,h=c[t];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}var f=this._bindingsByRootAndName,r=f[t];if(r!==void 0)for(var v in r){var _=r[v];_.restoreOriginalState(),this._removeInactiveBinding(_)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}});function _x(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}_x.prototype.clone=function(){return new _x(this.value.clone===void 0?this.value:this.value.clone())};function ww(e,t,i){qa.call(this,e,t),this.meshPerAttribute=i||1}ww.prototype=Object.assign(Object.create(qa.prototype),{constructor:ww,isInstancedInterleavedBuffer:!0,copy:function(e){return qa.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}});function v4(e,t,i,l){this.ray=new zc(e,t),this.near=i||0,this.far=l||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Aw(e,t){return e.distance-t.distance}function bx(e,t,i,l){if(e.visible!==!1&&(e.raycast(t,i),l===!0))for(var c=e.children,h=0,f=c.length;h<f;h++)bx(c[h],t,i,!0)}Object.assign(v4.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,i){var l=i||[];return bx(e,this,l,t),l.sort(Aw),l},intersectObjects:function(e,t,i){var l=i||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),l;for(var c=0,h=e.length;c<h;c++)bx(e[c],this,l,t);return l.sort(Aw),l}});function _4(e,t,i){return this.radius=e!==void 0?e:1,this.phi=t!==void 0?t:0,this.theta=i!==void 0?i:0,this}Object.assign(_4.prototype,{set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Xn.clamp(t/this.radius,-1,1))),this}});function b4(e,t,i){return this.radius=e!==void 0?e:1,this.theta=t!==void 0?t:0,this.y=i!==void 0?i:0,this}Object.assign(b4.prototype,{set:function(e,t,i){return this.radius=e,this.theta=t,this.y=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}});var Mw=new Rt;function Sw(e,t){this.min=e!==void 0?e:new Rt(1/0,1/0),this.max=t!==void 0?t:new Rt(-1/0,-1/0)}Object.assign(Sw.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var i=Mw.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Rt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Rt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Rt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Rt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){var t=Mw.copy(e).clamp(this.min,this.max);return t.sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Tw=new xe,Nm=new xe;function Ew(e,t){this.start=e!==void 0?e:new xe,this.end=t!==void 0?t:new xe}Object.assign(Ew.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new xe),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new xe),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return t===void 0&&(console.warn("THREE.Line3: .at() target is now required"),t=new xe),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){Tw.subVectors(e,this.start),Nm.subVectors(this.end,this.start);var i=Nm.dot(Nm),l=Nm.dot(Tw),c=l/i;return t&&(c=Xn.clamp(c,0,1)),c},closestPointToPoint:function(e,t,i){var l=this.closestPointToPointParameter(e,t);return i===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new xe),this.delta(i).multiplyScalar(l).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});function Vm(e){on.call(this),this.material=e,this.render=function(){}}Vm.prototype=Object.create(on.prototype),Vm.prototype.constructor=Vm,Vm.prototype.isImmediateRenderObject=!0;var Pw=new xe;function Fd(e,t){on.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var i=new _n,l=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],c=0,h=1,f=32;c<f;c++,h++){var r=c/f*Math.PI*2,v=h/f*Math.PI*2;l.push(Math.cos(r),Math.sin(r),1,Math.cos(v),Math.sin(v),1)}i.setAttribute("position",new cn(l,3));var _=new Vi({fog:!1});this.cone=new Xi(i,_),this.add(this.cone),this.update()}Fd.prototype=Object.create(on.prototype),Fd.prototype.constructor=Fd,Fd.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Fd.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Pw.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Pw),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Ps=new xe,Om=new Kn,wx=new Kn;function Cw(e){var t=[];e&&e.isBone&&t.push(e);for(var i=0;i<e.children.length;i++)t.push.apply(t,Cw(e.children[i]));return t}function kd(e){for(var t=Cw(e),i=new _n,l=[],c=[],h=new nn(0,0,1),f=new nn(0,1,0),r=0;r<t.length;r++){var v=t[r];v.parent&&v.parent.isBone&&(l.push(0,0,0),l.push(0,0,0),c.push(h.r,h.g,h.b),c.push(f.r,f.g,f.b))}i.setAttribute("position",new cn(l,3)),i.setAttribute("color",new cn(c,3));var _=new Vi({vertexColors:Ac,depthTest:!1,depthWrite:!1,transparent:!0});Xi.call(this,i,_),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}kd.prototype=Object.create(Xi.prototype),kd.prototype.constructor=kd,kd.prototype.updateMatrixWorld=function(e){var t=this.bones,i=this.geometry,l=i.getAttribute("position");wx.getInverse(this.root.matrixWorld);for(var c=0,h=0;c<t.length;c++){var f=t[c];f.parent&&f.parent.isBone&&(Om.multiplyMatrices(wx,f.matrixWorld),Ps.setFromMatrixPosition(Om),l.setXYZ(h,Ps.x,Ps.y,Ps.z),Om.multiplyMatrices(wx,f.parent.matrixWorld),Ps.setFromMatrixPosition(Om),l.setXYZ(h+1,Ps.x,Ps.y,Ps.z),h+=2)}i.getAttribute("position").needsUpdate=!0,on.prototype.updateMatrixWorld.call(this,e)};function Bd(e,t,i){this.light=e,this.light.updateMatrixWorld(),this.color=i;var l=new su(t,4,2),c=new _r({wireframe:!0,fog:!1});Fi.call(this,l,c),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Bd.prototype=Object.create(Fi.prototype),Bd.prototype.constructor=Bd,Bd.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Bd.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var w4=new xe,Rw=new nn,Dw=new nn;function zd(e,t,i){on.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var l=new iu(t);l.rotateY(Math.PI*.5),this.material=new _r({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=Ac);var c=l.getAttribute("position"),h=new Float32Array(c.count*3);l.setAttribute("color",new Un(h,3)),this.add(new Fi(l,this.material)),this.update()}zd.prototype=Object.create(on.prototype),zd.prototype.constructor=zd,zd.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},zd.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Rw.copy(this.light.color),Dw.copy(this.light.groundColor);for(var i=0,l=t.count;i<l;i++){var c=i<l/2?Rw:Dw;t.setXYZ(i,c.r,c.g,c.b)}t.needsUpdate=!0}e.lookAt(w4.setFromMatrixPosition(this.light.matrixWorld).negate())};function Ax(e,t,i,l){e=e||10,t=t||10,i=new nn(i!==void 0?i:4473924),l=new nn(l!==void 0?l:8947848);for(var c=t/2,h=e/t,f=e/2,r=[],v=[],_=0,w=0,b=-f;_<=t;_++,b+=h){r.push(-f,0,b,f,0,b),r.push(b,0,-f,b,0,f);var E=_===c?i:l;E.toArray(v,w),w+=3,E.toArray(v,w),w+=3,E.toArray(v,w),w+=3,E.toArray(v,w),w+=3}var P=new _n;P.setAttribute("position",new cn(r,3)),P.setAttribute("color",new cn(v,3));var I=new Vi({vertexColors:Ac});Xi.call(this,P,I)}Ax.prototype=Object.assign(Object.create(Xi.prototype),{constructor:Ax,copy:function(e){return Xi.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}});function Sx(e,t,i,l,c,h){e=e||10,t=t||16,i=i||8,l=l||64,c=new nn(c!==void 0?c:4473924),h=new nn(h!==void 0?h:8947848);var f=[],r=[],v,_,w,b,E,P,I;for(b=0;b<=t;b++)w=b/t*(Math.PI*2),v=Math.sin(w)*e,_=Math.cos(w)*e,f.push(0,0,0),f.push(v,0,_),I=b&1?c:h,r.push(I.r,I.g,I.b),r.push(I.r,I.g,I.b);for(b=0;b<=i;b++)for(I=b&1?c:h,P=e-e/i*b,E=0;E<l;E++)w=E/l*(Math.PI*2),v=Math.sin(w)*P,_=Math.cos(w)*P,f.push(v,0,_),r.push(I.r,I.g,I.b),w=(E+1)/l*(Math.PI*2),v=Math.sin(w)*P,_=Math.cos(w)*P,f.push(v,0,_),r.push(I.r,I.g,I.b);var F=new _n;F.setAttribute("position",new cn(f,3)),F.setAttribute("color",new cn(r,3));var B=new Vi({vertexColors:Ac});Xi.call(this,F,B)}Sx.prototype=Object.create(Xi.prototype),Sx.prototype.constructor=Sx;var Iw=new xe,Gm=new xe,Lw=new xe;function Ud(e,t,i){on.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,t===void 0&&(t=1);var l=new _n;l.setAttribute("position",new cn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var c=new Vi({fog:!1});this.lightPlane=new fo(l,c),this.add(this.lightPlane),l=new _n,l.setAttribute("position",new cn([0,0,0,0,0,1],3)),this.targetLine=new fo(l,c),this.add(this.targetLine),this.update()}Ud.prototype=Object.create(on.prototype),Ud.prototype.constructor=Ud,Ud.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ud.prototype.update=function(){Iw.setFromMatrixPosition(this.light.matrixWorld),Gm.setFromMatrixPosition(this.light.target.matrixWorld),Lw.subVectors(Gm,Iw),this.lightPlane.lookAt(Gm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Gm),this.targetLine.scale.z=Lw.length()};var jm=new xe,Oi=new Ha;function Hm(e){var t=new _n,i=new Vi({color:16777215,vertexColors:lP}),l=[],c=[],h={},f=new nn(16755200),r=new nn(16711680),v=new nn(43775),_=new nn(16777215),w=new nn(3355443);b("n1","n2",f),b("n2","n4",f),b("n4","n3",f),b("n3","n1",f),b("f1","f2",f),b("f2","f4",f),b("f4","f3",f),b("f3","f1",f),b("n1","f1",f),b("n2","f2",f),b("n3","f3",f),b("n4","f4",f),b("p","n1",r),b("p","n2",r),b("p","n3",r),b("p","n4",r),b("u1","u2",v),b("u2","u3",v),b("u3","u1",v),b("c","t",_),b("p","c",w),b("cn1","cn2",w),b("cn3","cn4",w),b("cf1","cf2",w),b("cf3","cf4",w);function b(P,I,F){E(P,F),E(I,F)}function E(P,I){l.push(0,0,0),c.push(I.r,I.g,I.b),h[P]===void 0&&(h[P]=[]),h[P].push(l.length/3-1)}t.setAttribute("position",new cn(l,3)),t.setAttribute("color",new cn(c,3)),Xi.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=h,this.update()}Hm.prototype=Object.create(Xi.prototype),Hm.prototype.constructor=Hm,Hm.prototype.update=function(){var e=this.geometry,t=this.pointMap,i=1,l=1;Oi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Zi("c",t,e,Oi,0,0,-1),Zi("t",t,e,Oi,0,0,1),Zi("n1",t,e,Oi,-i,-l,-1),Zi("n2",t,e,Oi,i,-l,-1),Zi("n3",t,e,Oi,-i,l,-1),Zi("n4",t,e,Oi,i,l,-1),Zi("f1",t,e,Oi,-i,-l,1),Zi("f2",t,e,Oi,i,-l,1),Zi("f3",t,e,Oi,-i,l,1),Zi("f4",t,e,Oi,i,l,1),Zi("u1",t,e,Oi,i*.7,l*1.1,-1),Zi("u2",t,e,Oi,-i*.7,l*1.1,-1),Zi("u3",t,e,Oi,0,l*2,-1),Zi("cf1",t,e,Oi,-i,0,1),Zi("cf2",t,e,Oi,i,0,1),Zi("cf3",t,e,Oi,0,-l,1),Zi("cf4",t,e,Oi,0,l,1),Zi("cn1",t,e,Oi,-i,0,-1),Zi("cn2",t,e,Oi,i,0,-1),Zi("cn3",t,e,Oi,0,-l,-1),Zi("cn4",t,e,Oi,0,l,-1),e.getAttribute("position").needsUpdate=!0};function Zi(e,t,i,l,c,h,f){jm.set(c,h,f).unproject(l);var r=t[e];if(r!==void 0)for(var v=i.getAttribute("position"),_=0,w=r.length;_<w;_++)v.setXYZ(r[_],jm.x,jm.y,jm.z)}var Wm=new Vo;function Fl(e,t){this.object=e,t===void 0&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=new Float32Array(8*3),c=new _n;c.setIndex(new Un(i,1)),c.setAttribute("position",new Un(l,3)),Xi.call(this,c,new Vi({color:t})),this.matrixAutoUpdate=!1,this.update()}Fl.prototype=Object.create(Xi.prototype),Fl.prototype.constructor=Fl,Fl.prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Wm.setFromObject(this.object),!Wm.isEmpty()){var t=Wm.min,i=Wm.max,l=this.geometry.attributes.position,c=l.array;c[0]=i.x,c[1]=i.y,c[2]=i.z,c[3]=t.x,c[4]=i.y,c[5]=i.z,c[6]=t.x,c[7]=t.y,c[8]=i.z,c[9]=i.x,c[10]=t.y,c[11]=i.z,c[12]=i.x,c[13]=i.y,c[14]=t.z,c[15]=t.x,c[16]=i.y,c[17]=t.z,c[18]=t.x,c[19]=t.y,c[20]=t.z,c[21]=i.x,c[22]=t.y,c[23]=t.z,l.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Fl.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Fl.prototype.copy=function(e){return Xi.prototype.copy.call(this,e),this.object=e.object,this},Fl.prototype.clone=function(){return new this.constructor().copy(this)};function qm(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],c=new _n;c.setIndex(new Un(i,1)),c.setAttribute("position",new cn(l,3)),Xi.call(this,c,new Vi({color:t})),this.geometry.computeBoundingSphere()}qm.prototype=Object.create(Xi.prototype),qm.prototype.constructor=qm,qm.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),on.prototype.updateMatrixWorld.call(this,e))};function Ym(e,t,i){this.type="PlaneHelper",this.plane=e,this.size=t===void 0?1:t;var l=i!==void 0?i:16776960,c=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],h=new _n;h.setAttribute("position",new cn(c,3)),h.computeBoundingSphere(),fo.call(this,h,new Vi({color:l}));var f=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],r=new _n;r.setAttribute("position",new cn(f,3)),r.computeBoundingSphere(),this.add(new Fi(r,new _r({color:l,opacity:.2,transparent:!0,depthWrite:!1})))}Ym.prototype=Object.create(fo.prototype),Ym.prototype.constructor=Ym,Ym.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?lr:wc,this.lookAt(this.plane.normal),on.prototype.updateMatrixWorld.call(this,e)};var Fw=new xe,Xm,Tx;function Cs(e,t,i,l,c,h){on.call(this),e===void 0&&(e=new xe(0,0,1)),t===void 0&&(t=new xe(0,0,0)),i===void 0&&(i=1),l===void 0&&(l=16776960),c===void 0&&(c=.2*i),h===void 0&&(h=.2*c),Xm===void 0&&(Xm=new _n,Xm.setAttribute("position",new cn([0,0,0,0,1,0],3)),Tx=new Ss(0,.5,1,5,1),Tx.translate(0,-.5,0)),this.position.copy(t),this.line=new fo(Xm,new Vi({color:l})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Fi(Tx,new _r({color:l})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,c,h)}Cs.prototype=Object.create(on.prototype),Cs.prototype.constructor=Cs,Cs.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Fw.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Fw,t)}},Cs.prototype.setLength=function(e,t,i){t===void 0&&(t=.2*e),i===void 0&&(i=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},Cs.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},Cs.prototype.copy=function(e){return on.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Cs.prototype.clone=function(){return new this.constructor().copy(this)};function Ex(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],l=new _n;l.setAttribute("position",new cn(t,3)),l.setAttribute("color",new cn(i,3));var c=new Vi({vertexColors:Ac});Xi.call(this,l,c)}Ex.prototype=Object.create(Xi.prototype),Ex.prototype.constructor=Ex;var wu=4,Rs=8,fa=Math.pow(2,Rs),kw=[.125,.215,.35,.446,.526,.582],Bw=Rs-wu+1+kw.length,Au=20,ma={[co]:0,[Wh]:1,[o0]:2,[G1]:3,[j1]:4,[H1]:5,[O1]:6},Px=new bu,Km=T4(Au),Ds=null,Is=null,{_lodPlanes:Nd,_sizeLods:zw,_sigmas:Zm}=A4(),Jm=null,Ai=null,Cx=null,kl=(1+Math.sqrt(5))/2,Mu=1/kl,Uw=[new xe(1,1,1),new xe(-1,1,1),new xe(1,1,-1),new xe(-1,1,-1),new xe(0,kl,Mu),new xe(0,kl,-Mu),new xe(Mu,0,kl),new xe(-Mu,0,kl),new xe(kl,Mu,0),new xe(-kl,Mu,0)];function Nw(e){Ai=e,Rx(Km)}Nw.prototype={constructor:Nw,fromScene:function(e,t=0,i=.1,l=100){Cx=Ai.getRenderTarget();var c=Vw();return M4(e,i,l,c),t>0&&Hw(c,0,0,t),jw(c),Ow(c),c},fromEquirectangular:function(e){return e.magFilter=Yi,e.minFilter=Yi,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){Cx=Ai.getRenderTarget();var t=Vw(e);return S4(e,t),jw(t),Ow(t),t},compileCubemapShader:function(){Is==null&&(Is=Yw(),Rx(Is))},compileEquirectangularShader:function(){Ds==null&&(Ds=qw(),Rx(Ds))},dispose:function(){Km.dispose(),Is!=null&&Is.dispose(),Ds!=null&&Ds.dispose();for(var e=0;e<Nd.length;e++)Nd[e].dispose()}};function A4(){for(var e=[],t=[],i=[],l=Rs,c=0;c<Bw;c++){var h=Math.pow(2,l);t.push(h);var f=1/h;c>Rs-wu?f=kw[c-Rs+wu-1]:c==0&&(f=0),i.push(f);for(var r=1/(h-1),v=-r/2,_=1+r/2,w=[v,v,_,v,_,_,v,v,_,_,v,_],b=6,E=6,P=3,I=2,F=1,B=new Float32Array(P*E*b),O=new Float32Array(I*E*b),W=new Float32Array(F*E*b),Z=0;Z<b;Z++){var ie=Z%3*2/3-1,$=Z>2?0:-1,oe=[ie,$,0,ie+2/3,$,0,ie+2/3,$+1,0,ie,$,0,ie+2/3,$+1,0,ie,$+1,0];B.set(oe,P*E*Z),O.set(w,I*E*Z);var be=[Z,Z,Z,Z,Z,Z];W.set(be,F*E*Z)}var fe=new _n;fe.setAttribute("position",new Un(B,P)),fe.setAttribute("uv",new Un(O,I)),fe.setAttribute("faceIndex",new Un(W,F)),e.push(fe),l>wu&&l--}return{_lodPlanes:e,_sizeLods:t,_sigmas:i}}function Vw(e){var t={magFilter:Yi,minFilter:Yi,generateMipmaps:!1,type:e?e.type:Cf,format:e?e.format:jP,encoding:e?e.encoding:o0,depthBuffer:!1,stencilBuffer:!1},i=Gw(t);return i.depthBuffer=!e,Jm=Gw(t),i}function Ow(e){Jm.dispose(),Ai.setRenderTarget(Cx),e.scissorTest=!1,e.setSize(e.width,e.height)}function M4(e,t,i,l){var c=90,h=1,f=new tr(c,h,t,i),r=[1,1,1,1,-1,1],v=[1,1,-1,-1,-1,1],_=Ai.outputEncoding,w=Ai.toneMapping,b=Ai.toneMappingExposure,E=Ai.getClearColor(),P=Ai.getClearAlpha();Ai.toneMapping=Zy,Ai.toneMappingExposure=1,Ai.outputEncoding=co,e.scale.z*=-1;var I=e.background;if(I&&I.isColor){I.convertSRGBToLinear();var F=Math.max(I.r,I.g,I.b),B=Math.min(Math.max(Math.ceil(Math.log2(F)),-128),127);I=I.multiplyScalar(Math.pow(2,-B));var O=(B+128)/255;Ai.setClearColor(I,O),e.background=null}for(var W=0;W<6;W++){var Z=W%3;Z==0?(f.up.set(0,r[W],0),f.lookAt(v[W],0,0)):Z==1?(f.up.set(0,0,r[W]),f.lookAt(0,v[W],0)):(f.up.set(0,r[W],0),f.lookAt(0,0,v[W])),Dx(l,Z*fa,W>2?fa:0,fa,fa),Ai.setRenderTarget(l),Ai.render(e,f)}Ai.toneMapping=w,Ai.toneMappingExposure=b,Ai.outputEncoding=_,Ai.setClearColor(E,P),e.scale.z*=-1}function S4(e,t){var i=new Ua;e.isCubeTexture?Is==null&&(Is=Yw()):Ds==null&&(Ds=qw());var l=e.isCubeTexture?Is:Ds;i.add(new Fi(Nd[0],l));var c=l.uniforms;c.envMap.value=e,e.isCubeTexture||c.texelSize.value.set(1/e.image.width,1/e.image.height),c.inputEncoding.value=ma[e.encoding],c.outputEncoding.value=ma[e.encoding],Dx(t,0,0,3*fa,2*fa),Ai.setRenderTarget(t),Ai.render(i,Px)}function Rx(e){var t=new Ua;t.add(new Fi(Nd[0],e)),Ai.compile(t,Px)}function Gw(e){var t=new Dr(3*fa,3*fa,e);return t.texture.mapping=Vh,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Dx(e,t,i,l,c){e.viewport.set(t,i,l,c),e.scissor.set(t,i,l,c)}function jw(e){var t=Ai.autoClear;Ai.autoClear=!1;for(var i=1;i<Bw;i++){var l=Math.sqrt(Zm[i]*Zm[i]-Zm[i-1]*Zm[i-1]),c=Uw[(i-1)%Uw.length];Hw(e,i-1,i,l,c)}Ai.autoClear=t}function Hw(e,t,i,l,c){Ww(e,Jm,t,i,l,"latitudinal",c),Ww(Jm,e,i,i,l,"longitudinal",c)}function Ww(e,t,i,l,c,h,f){h!=="latitudinal"&&h!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var r=3,v=new Ua;v.add(new Fi(Nd[l],Km));var _=Km.uniforms,w=zw[i]-1,b=isFinite(c)?Math.PI/(2*w):2*Math.PI/(2*Au-1),E=c/b,P=isFinite(c)?1+Math.floor(r*E):Au;P>Au&&console.warn(`sigmaRadians, ${c}, is too large and will clip, as it requested ${P} samples when the maximum is set to ${Au}`);for(var I=[],F=0,B=0;B<Au;++B){var Z=B/E,O=Math.exp(-Z*Z/2);I.push(O),B==0?F+=O:B<P&&(F+=2*O)}for(var B=0;B<I.length;B++)I[B]=I[B]/F;_.envMap.value=e.texture,_.samples.value=P,_.weights.value=I,_.latitudinal.value=h==="latitudinal",f&&(_.poleAxis.value=f),_.dTheta.value=b,_.mipInt.value=Rs-i,_.inputEncoding.value=ma[e.texture.encoding],_.outputEncoding.value=ma[e.texture.encoding];var W=zw[l],Z=3*Math.max(0,fa-2*W),ie=(l===0?0:2*fa)+2*W*(l>Rs-wu?l-Rs+wu:0);Dx(t,Z,ie,3*W,2*W),Ai.setRenderTarget(t),Ai.render(v,Px)}function T4(e){var t=new Float32Array(e),i=new xe(0,1,0),l=new Ts({defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i},inputEncoding:{value:ma[co]},outputEncoding:{value:ma[co]}},vertexShader:Ix(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

${Lx()}

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

void main() {
	gl_FragColor = vec4(0.0);
	for (int i = 0; i < n; i++) {
		if (i >= samples)
			break;
		for (int dir = -1; dir < 2; dir += 2) {
			if (i == 0 && dir == 1)
				continue;
			vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
			if (all(equal(axis, vec3(0.0))))
				axis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);
			axis = normalize(axis);
			float theta = dTheta * float(dir * i);
			float cosTheta = cos(theta);
			// Rodrigues' axis-angle rotation
			vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross(axis, vOutputDirection) * sin(theta)
					+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
			gl_FragColor.rgb +=
					weights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);
		}
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:gs,depthTest:!1,depthWrite:!1});return l.type="SphericalGaussianBlur",l}function qw(){var e=new Rt(1,1),t=new Ts({uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:ma[co]},outputEncoding:{value:ma[co]}},vertexShader:Ix(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

${Lx()}

#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv;
	uv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;
	uv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:gs,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function Yw(){var e=new Ts({uniforms:{envMap:{value:null},inputEncoding:{value:ma[co]},outputEncoding:{value:ma[co]}},vertexShader:Ix(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

${Lx()}

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:gs,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function Ix(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function Lx(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}In.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(In.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Es.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new On,i=0,l=e.length;i<l;i++){var c=e[i];t.vertices.push(new xe(c.x,c.y,c.z||0))}return t}}),Object.assign(da.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Object.create(go.prototype),Object.create(go.prototype);function Xw(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),go.call(this,e),this.type="catmullrom"}Xw.prototype=Object.create(go.prototype),Object.assign(Xw.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Ax.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},kd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(ui.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Cl.extractUrlBase(e)}}),ui.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(mx.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Sw.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Vo.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),nd.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Ew.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Xn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Xn.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Xn.ceilPowerOfTwo(e)}}),Object.assign(vr.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Kn.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new xe().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,i,l,c,h){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,l,i,c,h)}}),oa.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},qr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(zc.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(gr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(gr,{barycoordFromPoint:function(e,t,i,l,c){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),gr.getBarycoord(e,t,i,l,c)},normal:function(e,t,i,l){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),gr.getNormal(e,t,i,l)}}),Object.assign(Pl.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new au(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new lu(this,e)}}),Object.assign(Rt.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(wi.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(On.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(on.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(on.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Fi.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Fi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),fC},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(nm.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(im.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),hd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(In.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),tr.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Ci.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Un.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===qh},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(qh)}}}),Object.assign(Un.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?qh:Lf),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(_n.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Un(arguments[1],arguments[2]))):e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t)},addDrawCall:function(e,t,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(_n.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(qa.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===qh},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(qa.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?qh:Lf),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ya.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(_x.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(zn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new nn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===_1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(El.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Yr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Cb.prototype,{clearTarget:function(e,t,i,l){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,i,l)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Cb.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?Wh:co}}}),Object.defineProperties(Eb.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Dr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Ld.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this,i=new gx;return i.load(e,function(l){t.setBuffer(l)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),yw.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},td.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},fl.crossOrigin=void 0,fl.loadTexture=function(e,t,i,l){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var c=new Lm;c.setCrossOrigin(this.crossOrigin);var h=c.load(e,i,void 0,l);return t&&(h.mapping=t),h},fl.loadTextureCube=function(e,t,i,l){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var c=new Q0;c.setCrossOrigin(this.crossOrigin);var h=c.load(e,i,void 0,l);return t&&(h.mapping=t),h},fl.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},fl.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:rP}}));var E4=function(){function e(we){ui.call(this,we),this.dracoLoader=null,this.ddsLoader=null}e.prototype=Object.assign(Object.create(ui.prototype),{constructor:e,load:function(we,pe,ke,De){var Se=this,tt;this.resourcePath!==""?tt=this.resourcePath:this.path!==""?tt=this.path:tt=Cl.extractUrlBase(we),Se.manager.itemStart(we);var Ge=function(nt){De?De(nt):console.error(nt),Se.manager.itemError(we),Se.manager.itemEnd(we)},We=new Co(Se.manager);We.setPath(this.path),We.setResponseType("arraybuffer"),Se.crossOrigin==="use-credentials"&&We.setWithCredentials(!0),We.load(we,function(nt){try{Se.parse(nt,tt,function(je){pe(je),Se.manager.itemEnd(we)},Ge)}catch(je){Ge(je)}},ke,Ge)},setDRACOLoader:function(we){return this.dracoLoader=we,this},setDDSLoader:function(we){return this.ddsLoader=we,this},parse:function(we,pe,ke,De){var Se,tt={};if(typeof we=="string")Se=we;else{var Ge=Cl.decodeText(new Uint8Array(we,0,4));if(Ge===f){try{tt[i.KHR_BINARY_GLTF]=new _(we)}catch(Lt){De&&De(Lt);return}Se=tt[i.KHR_BINARY_GLTF].content}else Se=Cl.decodeText(new Uint8Array(we))}var We=JSON.parse(Se);if(We.asset===void 0||We.asset.version[0]<2){De&&De(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}if(We.extensionsUsed)for(var nt=0;nt<We.extensionsUsed.length;++nt){var je=We.extensionsUsed[nt],lt=We.extensionsRequired||[];switch(je){case i.KHR_LIGHTS_PUNCTUAL:tt[je]=new c(We);break;case i.KHR_MATERIALS_UNLIT:tt[je]=new h;break;case i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:tt[je]=new P;break;case i.KHR_DRACO_MESH_COMPRESSION:tt[je]=new w(We,this.dracoLoader);break;case i.MSFT_TEXTURE_DDS:tt[je]=new l(this.ddsLoader);break;case i.KHR_TEXTURE_TRANSFORM:tt[je]=new b;break;case i.KHR_MESH_QUANTIZATION:tt[je]=new I;break;default:lt.indexOf(je)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+je+'".')}}var gt=new mt(We,tt,{path:pe||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});gt.parse(ke,De)}});function t(){var we={};return{get:function(pe){return we[pe]},add:function(pe,ke){we[pe]=ke},remove:function(pe){delete we[pe]},removeAll:function(){we={}}}}var i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function l(we){if(!we)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=i.MSFT_TEXTURE_DDS,this.ddsLoader=we}function c(we){this.name=i.KHR_LIGHTS_PUNCTUAL;var pe=we.extensions&&we.extensions[i.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=pe.lights||[]}c.prototype.loadLight=function(we){var pe=this.lightDefs[we],ke,De=new nn(16777215);pe.color!==void 0&&De.fromArray(pe.color);var Se=pe.range!==void 0?pe.range:0;switch(pe.type){case"directional":ke=new zm(De),ke.target.position.set(0,0,-1),ke.add(ke.target);break;case"point":ke=new Bm(De),ke.distance=Se;break;case"spot":ke=new km(De),ke.distance=Se,pe.spot=pe.spot||{},pe.spot.innerConeAngle=pe.spot.innerConeAngle!==void 0?pe.spot.innerConeAngle:0,pe.spot.outerConeAngle=pe.spot.outerConeAngle!==void 0?pe.spot.outerConeAngle:Math.PI/4,ke.angle=pe.spot.outerConeAngle,ke.penumbra=1-pe.spot.innerConeAngle/pe.spot.outerConeAngle,ke.target.position.set(0,0,-1),ke.add(ke.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+pe.type+'".')}return ke.position.set(0,0,0),ke.decay=2,pe.intensity!==void 0&&(ke.intensity=pe.intensity),ke.name=pe.name||"light_"+we,Promise.resolve(ke)};function h(){this.name=i.KHR_MATERIALS_UNLIT}h.prototype.getMaterialType=function(){return _r},h.prototype.extendParams=function(we,pe,ke){var De=[];we.color=new nn(1,1,1),we.opacity=1;var Se=pe.pbrMetallicRoughness;if(Se){if(Array.isArray(Se.baseColorFactor)){var tt=Se.baseColorFactor;we.color.fromArray(tt),we.opacity=tt[3]}Se.baseColorTexture!==void 0&&De.push(ke.assignTexture(we,"map",Se.baseColorTexture))}return Promise.all(De)};var f="glTF",r=12,v={JSON:1313821514,BIN:5130562};function _(we){this.name=i.KHR_BINARY_GLTF,this.content=null,this.body=null;var pe=new DataView(we,0,r);if(this.header={magic:Cl.decodeText(new Uint8Array(we.slice(0,4))),version:pe.getUint32(4,!0),length:pe.getUint32(8,!0)},this.header.magic!==f)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var ke=new DataView(we,r),De=0;De<ke.byteLength;){var Se=ke.getUint32(De,!0);De+=4;var tt=ke.getUint32(De,!0);if(De+=4,tt===v.JSON){var Ge=new Uint8Array(we,r+De,Se);this.content=Cl.decodeText(Ge)}else if(tt===v.BIN){var We=r+De;this.body=we.slice(We,We+Se)}De+=Se}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function w(we,pe){if(!pe)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=i.KHR_DRACO_MESH_COMPRESSION,this.json=we,this.dracoLoader=pe,this.dracoLoader.preload()}w.prototype.decodePrimitive=function(we,pe){var ke=this.json,De=this.dracoLoader,Se=we.extensions[this.name].bufferView,tt=we.extensions[this.name].attributes,Ge={},We={},nt={};for(var je in tt){var lt=$[je]||je.toLowerCase();Ge[lt]=tt[je]}for(je in we.attributes){var lt=$[je]||je.toLowerCase();if(tt[je]!==void 0){var gt=ke.accessors[we.attributes[je]],Lt=O[gt.componentType];nt[lt]=Lt,We[lt]=gt.normalized===!0}}return pe.getDependency("bufferView",Se).then(function(sn){return new Promise(function(An){De.decodeDracoFile(sn,function(le){for(var Ee in le.attributes){var Et=le.attributes[Ee],wt=We[Ee];wt!==void 0&&(Et.normalized=wt)}An(le)},Ge,nt)})})};function b(){this.name=i.KHR_TEXTURE_TRANSFORM}b.prototype.extendTexture=function(we,pe){return we=we.clone(),pe.offset!==void 0&&we.offset.fromArray(pe.offset),pe.rotation!==void 0&&(we.rotation=pe.rotation),pe.scale!==void 0&&we.repeat.fromArray(pe.scale),pe.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),we.needsUpdate=!0,we};function E(we){Xr.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var pe=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),ke=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),De=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),Se=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),tt=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join(`
`),Ge={specular:{value:new nn().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Ge,this.onBeforeCompile=function(We){for(var nt in Ge)We.uniforms[nt]=Ge[nt];We.fragmentShader=We.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),We.fragmentShader=We.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),We.fragmentShader=We.fragmentShader.replace("#include <roughnessmap_pars_fragment>",pe),We.fragmentShader=We.fragmentShader.replace("#include <metalnessmap_pars_fragment>",ke),We.fragmentShader=We.fragmentShader.replace("#include <roughnessmap_fragment>",De),We.fragmentShader=We.fragmentShader.replace("#include <metalnessmap_fragment>",Se),We.fragmentShader=We.fragmentShader.replace("#include <lights_physical_fragment>",tt)},Object.defineProperties(this,{specular:{get:function(){return Ge.specular.value},set:function(We){Ge.specular.value=We}},specularMap:{get:function(){return Ge.specularMap.value},set:function(We){Ge.specularMap.value=We}},glossiness:{get:function(){return Ge.glossiness.value},set:function(We){Ge.glossiness.value=We}},glossinessMap:{get:function(){return Ge.glossinessMap.value},set:function(We){Ge.glossinessMap.value=We,We?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(we)}E.prototype=Object.create(Xr.prototype),E.prototype.constructor=E,E.prototype.copy=function(we){return Xr.prototype.copy.call(this,we),this.specularMap=we.specularMap,this.specular.copy(we.specular),this.glossinessMap=we.glossinessMap,this.glossiness=we.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function P(){return{name:i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return E},extendParams:function(we,pe,ke){var De=pe.extensions[this.name];we.color=new nn(1,1,1),we.opacity=1;var Se=[];if(Array.isArray(De.diffuseFactor)){var tt=De.diffuseFactor;we.color.fromArray(tt),we.opacity=tt[3]}if(De.diffuseTexture!==void 0&&Se.push(ke.assignTexture(we,"map",De.diffuseTexture)),we.emissive=new nn(0,0,0),we.glossiness=De.glossinessFactor!==void 0?De.glossinessFactor:1,we.specular=new nn(1,1,1),Array.isArray(De.specularFactor)&&we.specular.fromArray(De.specularFactor),De.specularGlossinessTexture!==void 0){var Ge=De.specularGlossinessTexture;Se.push(ke.assignTexture(we,"glossinessMap",Ge)),Se.push(ke.assignTexture(we,"specularMap",Ge))}return Promise.all(Se)},createMaterial:function(we){var pe=new E(we);return pe.fog=!0,pe.color=we.color,pe.map=we.map===void 0?null:we.map,pe.lightMap=null,pe.lightMapIntensity=1,pe.aoMap=we.aoMap===void 0?null:we.aoMap,pe.aoMapIntensity=1,pe.emissive=we.emissive,pe.emissiveIntensity=1,pe.emissiveMap=we.emissiveMap===void 0?null:we.emissiveMap,pe.bumpMap=we.bumpMap===void 0?null:we.bumpMap,pe.bumpScale=1,pe.normalMap=we.normalMap===void 0?null:we.normalMap,pe.normalMapType=pl,we.normalScale&&(pe.normalScale=we.normalScale),pe.displacementMap=null,pe.displacementScale=1,pe.displacementBias=0,pe.specularMap=we.specularMap===void 0?null:we.specularMap,pe.specular=we.specular,pe.glossinessMap=we.glossinessMap===void 0?null:we.glossinessMap,pe.glossiness=we.glossiness,pe.alphaMap=null,pe.envMap=we.envMap===void 0?null:we.envMap,pe.envMapIntensity=1,pe.refractionRatio=.98,pe}}}function I(){this.name=i.KHR_MESH_QUANTIZATION}function F(we,pe,ke,De){Kr.call(this,we,pe,ke,De)}F.prototype=Object.create(Kr.prototype),F.prototype.constructor=F,F.prototype.copySampleValue_=function(we){for(var pe=this.resultBuffer,ke=this.sampleValues,De=this.valueSize,Se=we*De*3+De,tt=0;tt!==De;tt++)pe[tt]=ke[Se+tt];return pe},F.prototype.beforeStart_=F.prototype.copySampleValue_,F.prototype.afterEnd_=F.prototype.copySampleValue_,F.prototype.interpolate_=function(we,pe,ke,De){for(var Se=this.resultBuffer,tt=this.sampleValues,Ge=this.valueSize,We=Ge*2,nt=Ge*3,je=De-pe,lt=(ke-pe)/je,gt=lt*lt,Lt=gt*lt,sn=we*nt,An=sn-nt,le=-2*Lt+3*gt,Ee=Lt-gt,Et=1-le,wt=Ee-gt+lt,Mn=0;Mn!==Ge;Mn++){var xn=tt[An+Mn+Ge],un=tt[An+Mn+We]*je,bn=tt[sn+Mn+Ge],Tn=tt[sn+Mn]*je;Se[Mn]=Et*xn+wt*un+le*bn+Ee*Tn}return Se};var B={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},O={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},W={9728:Yi,9729:$i,9984:Ef,9985:n0,9986:Pf,9987:Sc},Z={33071:Rr,33648:Oh,10497:dl},ie={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},oe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},be={CUBICSPLINE:void 0,LINEAR:Ec,STEP:Hh},fe={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},Le={"image/png":Uo,"image/jpeg":ka};function Xe(we,pe){return typeof we!="string"||we===""?"":(/^https?:\/\//i.test(pe)&&/^\//.test(we)&&(pe=pe.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(we)||/^data:.*,.*$/i.test(we)||/^blob:.*$/i.test(we)?we:pe+we)}function Ne(we){return we.DefaultMaterial===void 0&&(we.DefaultMaterial=new Xr({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:wc})),we.DefaultMaterial}function Re(we,pe,ke){for(var De in ke.extensions)we[De]===void 0&&(pe.userData.gltfExtensions=pe.userData.gltfExtensions||{},pe.userData.gltfExtensions[De]=ke.extensions[De])}function Ie(we,pe){pe.extras!==void 0&&(typeof pe.extras=="object"?Object.assign(we.userData,pe.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+pe.extras))}function He(we,pe,ke){for(var De=!1,Se=!1,tt=0,Ge=pe.length;tt<Ge;tt++){var We=pe[tt];if(We.POSITION!==void 0&&(De=!0),We.NORMAL!==void 0&&(Se=!0),De&&Se)break}if(!De&&!Se)return Promise.resolve(we);for(var nt=[],je=[],tt=0,Ge=pe.length;tt<Ge;tt++){var We=pe[tt];if(De){var lt=We.POSITION!==void 0?ke.getDependency("accessor",We.POSITION):we.attributes.position;nt.push(lt)}if(Se){var lt=We.NORMAL!==void 0?ke.getDependency("accessor",We.NORMAL):we.attributes.normal;je.push(lt)}}return Promise.all([Promise.all(nt),Promise.all(je)]).then(function(gt){var Lt=gt[0],sn=gt[1];return De&&(we.morphAttributes.position=Lt),Se&&(we.morphAttributes.normal=sn),we.morphTargetsRelative=!0,we})}function Ue(we,pe){if(we.updateMorphTargets(),pe.weights!==void 0)for(var ke=0,De=pe.weights.length;ke<De;ke++)we.morphTargetInfluences[ke]=pe.weights[ke];if(pe.extras&&Array.isArray(pe.extras.targetNames)){var Se=pe.extras.targetNames;if(we.morphTargetInfluences.length===Se.length){we.morphTargetDictionary={};for(var ke=0,De=Se.length;ke<De;ke++)we.morphTargetDictionary[Se[ke]]=ke}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ot(we){var pe=we.extensions&&we.extensions[i.KHR_DRACO_MESH_COMPRESSION],ke;return pe?ke="draco:"+pe.bufferView+":"+pe.indices+":"+Pt(pe.attributes):ke=we.indices+":"+Pt(we.attributes)+":"+we.mode,ke}function Pt(we){for(var pe="",ke=Object.keys(we).sort(),De=0,Se=ke.length;De<Se;De++)pe+=ke[De]+":"+we[ke[De]]+";";return pe}function mt(we,pe,ke){this.json=we||{},this.extensions=pe||{},this.options=ke||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new Lm(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Co(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}mt.prototype.parse=function(we,pe){var ke=this,De=this.json,Se=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(tt){var Ge={scene:tt[0][De.scene||0],scenes:tt[0],animations:tt[1],cameras:tt[2],asset:De.asset,parser:ke,userData:{}};Re(Se,Ge,De),Ie(Ge,De),we(Ge)}).catch(pe)},mt.prototype.markDefs=function(){for(var we=this.json.nodes||[],pe=this.json.skins||[],ke=this.json.meshes||[],De={},Se={},tt=0,Ge=pe.length;tt<Ge;tt++)for(var We=pe[tt].joints,nt=0,je=We.length;nt<je;nt++)we[We[nt]].isBone=!0;for(var lt=0,gt=we.length;lt<gt;lt++){var Lt=we[lt];Lt.mesh!==void 0&&(De[Lt.mesh]===void 0&&(De[Lt.mesh]=Se[Lt.mesh]=0),De[Lt.mesh]++,Lt.skin!==void 0&&(ke[Lt.mesh].isSkinnedMesh=!0))}this.json.meshReferences=De,this.json.meshUses=Se},mt.prototype.getDependency=function(we,pe){var ke=we+":"+pe,De=this.cache.get(ke);if(!De){switch(we){case"scene":De=this.loadScene(pe);break;case"node":De=this.loadNode(pe);break;case"mesh":De=this.loadMesh(pe);break;case"accessor":De=this.loadAccessor(pe);break;case"bufferView":De=this.loadBufferView(pe);break;case"buffer":De=this.loadBuffer(pe);break;case"material":De=this.loadMaterial(pe);break;case"texture":De=this.loadTexture(pe);break;case"skin":De=this.loadSkin(pe);break;case"animation":De=this.loadAnimation(pe);break;case"camera":De=this.loadCamera(pe);break;case"light":De=this.extensions[i.KHR_LIGHTS_PUNCTUAL].loadLight(pe);break;default:throw new Error("Unknown type: "+we)}this.cache.add(ke,De)}return De},mt.prototype.getDependencies=function(we){var pe=this.cache.get(we);if(!pe){var ke=this,De=this.json[we+(we==="mesh"?"es":"s")]||[];pe=Promise.all(De.map(function(Se,tt){return ke.getDependency(we,tt)})),this.cache.add(we,pe)}return pe},mt.prototype.loadBuffer=function(we){var pe=this.json.buffers[we],ke=this.fileLoader;if(pe.type&&pe.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+pe.type+" buffer type is not supported.");if(pe.uri===void 0&&we===0)return Promise.resolve(this.extensions[i.KHR_BINARY_GLTF].body);var De=this.options;return new Promise(function(Se,tt){ke.load(Xe(pe.uri,De.path),Se,void 0,function(){tt(new Error('THREE.GLTFLoader: Failed to load buffer "'+pe.uri+'".'))})})},mt.prototype.loadBufferView=function(we){var pe=this.json.bufferViews[we];return this.getDependency("buffer",pe.buffer).then(function(ke){var De=pe.byteLength||0,Se=pe.byteOffset||0;return ke.slice(Se,Se+De)})},mt.prototype.loadAccessor=function(we){var pe=this,ke=this.json,De=this.json.accessors[we];if(De.bufferView===void 0&&De.sparse===void 0)return Promise.resolve(null);var Se=[];return De.bufferView!==void 0?Se.push(this.getDependency("bufferView",De.bufferView)):Se.push(null),De.sparse!==void 0&&(Se.push(this.getDependency("bufferView",De.sparse.indices.bufferView)),Se.push(this.getDependency("bufferView",De.sparse.values.bufferView))),Promise.all(Se).then(function(tt){var Ge=tt[0],We=ie[De.type],nt=O[De.componentType],je=nt.BYTES_PER_ELEMENT,lt=je*We,gt=De.byteOffset||0,Lt=De.bufferView!==void 0?ke.bufferViews[De.bufferView].byteStride:void 0,sn=De.normalized===!0,An,le;if(Lt&&Lt!==lt){var Ee=Math.floor(gt/Lt),Et="InterleavedBuffer:"+De.bufferView+":"+De.componentType+":"+Ee+":"+De.count,wt=pe.cache.get(Et);wt||(An=new nt(Ge,Ee*Lt,De.count*Lt/je),wt=new qa(An,Lt/je),pe.cache.add(Et,wt)),le=new sd(wt,We,gt%Lt/je,sn)}else Ge===null?An=new nt(De.count*We):An=new nt(Ge,gt,De.count*We),le=new Un(An,We,sn);if(De.sparse!==void 0){var Mn=ie.SCALAR,xn=O[De.sparse.indices.componentType],un=De.sparse.indices.byteOffset||0,bn=De.sparse.values.byteOffset||0,Tn=new xn(tt[1],un,De.sparse.count*Mn),hn=new nt(tt[2],bn,De.sparse.count*We);Ge!==null&&(le=new Un(le.array.slice(),le.itemSize,le.normalized));for(var jt=0,ln=Tn.length;jt<ln;jt++){var Xt=Tn[jt];if(le.setX(Xt,hn[jt*We]),We>=2&&le.setY(Xt,hn[jt*We+1]),We>=3&&le.setZ(Xt,hn[jt*We+2]),We>=4&&le.setW(Xt,hn[jt*We+3]),We>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return le})},mt.prototype.loadTexture=function(we){var pe=this,ke=this.json,De=this.options,Se=this.textureLoader,tt=window.URL||window.webkitURL,Ge=ke.textures[we],We=Ge.extensions||{},nt;We[i.MSFT_TEXTURE_DDS]?nt=ke.images[We[i.MSFT_TEXTURE_DDS].source]:nt=ke.images[Ge.source];var je=nt.uri,lt=!1;return nt.bufferView!==void 0&&(je=pe.getDependency("bufferView",nt.bufferView).then(function(gt){lt=!0;var Lt=new Blob([gt],{type:nt.mimeType});return je=tt.createObjectURL(Lt),je})),Promise.resolve(je).then(function(gt){var Lt=De.manager.getHandler(gt);return Lt||(Lt=We[i.MSFT_TEXTURE_DDS]?pe.extensions[i.MSFT_TEXTURE_DDS].ddsLoader:Se),new Promise(function(sn,An){Lt.load(Xe(gt,De.path),sn,void 0,An)})}).then(function(gt){lt===!0&&tt.revokeObjectURL(je),gt.flipY=!1,Ge.name!==void 0&&(gt.name=Ge.name),nt.mimeType in Le&&(gt.format=Le[nt.mimeType]);var Lt=ke.samplers||{},sn=Lt[Ge.sampler]||{};return gt.magFilter=W[sn.magFilter]||$i,gt.minFilter=W[sn.minFilter]||Sc,gt.wrapS=Z[sn.wrapS]||dl,gt.wrapT=Z[sn.wrapT]||dl,gt})},mt.prototype.assignTexture=function(we,pe,ke){var De=this;return this.getDependency("texture",ke.index).then(function(Se){if(!Se.isCompressedTexture)switch(pe){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":Se.format=ka;break}if(ke.texCoord!==void 0&&ke.texCoord!=0&&!(pe==="aoMap"&&ke.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+ke.texCoord+" for texture "+pe+" not yet supported."),De.extensions[i.KHR_TEXTURE_TRANSFORM]){var tt=ke.extensions!==void 0?ke.extensions[i.KHR_TEXTURE_TRANSFORM]:void 0;tt&&(Se=De.extensions[i.KHR_TEXTURE_TRANSFORM].extendTexture(Se,tt))}we[pe]=Se})},mt.prototype.assignFinalMaterial=function(we){var pe=we.geometry,ke=we.material;this.extensions;var De=pe.attributes.tangent!==void 0,Se=pe.attributes.color!==void 0,tt=pe.attributes.normal===void 0,Ge=we.isSkinnedMesh===!0,We=Object.keys(pe.morphAttributes).length>0,nt=We&&pe.morphAttributes.normal!==void 0;if(we.isPoints){var je="PointsMaterial:"+ke.uuid,lt=this.cache.get(je);lt||(lt=new As,zn.prototype.copy.call(lt,ke),lt.color.copy(ke.color),lt.map=ke.map,lt.sizeAttenuation=!1,this.cache.add(je,lt)),ke=lt}else if(we.isLine){var je="LineBasicMaterial:"+ke.uuid,gt=this.cache.get(je);gt||(gt=new Vi,zn.prototype.copy.call(gt,ke),gt.color.copy(ke.color),this.cache.add(je,gt)),ke=gt}if(De||Se||tt||Ge||We){var je="ClonedMaterial:"+ke.uuid+":";ke.isGLTFSpecularGlossinessMaterial&&(je+="specular-glossiness:"),Ge&&(je+="skinning:"),De&&(je+="vertex-tangents:"),Se&&(je+="vertex-colors:"),tt&&(je+="flat-shading:"),We&&(je+="morph-targets:"),nt&&(je+="morph-normals:");var Lt=this.cache.get(je);Lt||(Lt=ke.clone(),Ge&&(Lt.skinning=!0),De&&(Lt.vertexTangents=!0),Se&&(Lt.vertexColors=Ac),tt&&(Lt.flatShading=!0),We&&(Lt.morphTargets=!0),nt&&(Lt.morphNormals=!0),this.cache.add(je,Lt)),ke=Lt}ke.aoMap&&pe.attributes.uv2===void 0&&pe.attributes.uv!==void 0&&pe.setAttribute("uv2",new Un(pe.attributes.uv.array,2)),ke.normalScale&&!De&&(ke.normalScale.y=-ke.normalScale.y),we.material=ke},mt.prototype.loadMaterial=function(we){var pe=this,ke=this.json,De=this.extensions,Se=ke.materials[we],tt,Ge={},We=Se.extensions||{},nt=[];if(We[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var je=De[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];tt=je.getMaterialType(),nt.push(je.extendParams(Ge,Se,pe))}else if(We[i.KHR_MATERIALS_UNLIT]){var lt=De[i.KHR_MATERIALS_UNLIT];tt=lt.getMaterialType(),nt.push(lt.extendParams(Ge,Se,pe))}else{tt=Xr;var gt=Se.pbrMetallicRoughness||{};if(Ge.color=new nn(1,1,1),Ge.opacity=1,Array.isArray(gt.baseColorFactor)){var Lt=gt.baseColorFactor;Ge.color.fromArray(Lt),Ge.opacity=Lt[3]}gt.baseColorTexture!==void 0&&nt.push(pe.assignTexture(Ge,"map",gt.baseColorTexture)),Ge.metalness=gt.metallicFactor!==void 0?gt.metallicFactor:1,Ge.roughness=gt.roughnessFactor!==void 0?gt.roughnessFactor:1,gt.metallicRoughnessTexture!==void 0&&(nt.push(pe.assignTexture(Ge,"metalnessMap",gt.metallicRoughnessTexture)),nt.push(pe.assignTexture(Ge,"roughnessMap",gt.metallicRoughnessTexture)))}Se.doubleSided===!0&&(Ge.side=Uh);var sn=Se.alphaMode||fe.OPAQUE;return sn===fe.BLEND?Ge.transparent=!0:(Ge.transparent=!1,sn===fe.MASK&&(Ge.alphaTest=Se.alphaCutoff!==void 0?Se.alphaCutoff:.5)),Se.normalTexture!==void 0&&tt!==_r&&(nt.push(pe.assignTexture(Ge,"normalMap",Se.normalTexture)),Ge.normalScale=new Rt(1,1),Se.normalTexture.scale!==void 0&&Ge.normalScale.set(Se.normalTexture.scale,Se.normalTexture.scale)),Se.occlusionTexture!==void 0&&tt!==_r&&(nt.push(pe.assignTexture(Ge,"aoMap",Se.occlusionTexture)),Se.occlusionTexture.strength!==void 0&&(Ge.aoMapIntensity=Se.occlusionTexture.strength)),Se.emissiveFactor!==void 0&&tt!==_r&&(Ge.emissive=new nn().fromArray(Se.emissiveFactor)),Se.emissiveTexture!==void 0&&tt!==_r&&nt.push(pe.assignTexture(Ge,"emissiveMap",Se.emissiveTexture)),Promise.all(nt).then(function(){var An;return tt===E?An=De[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Ge):An=new tt(Ge),Se.name!==void 0&&(An.name=Se.name),An.map&&(An.map.encoding=Wh),An.emissiveMap&&(An.emissiveMap.encoding=Wh),Ie(An,Se),Se.extensions&&Re(De,An,Se),An})};function _t(we,pe,ke){var De=pe.attributes,Se=new Vo;if(De.POSITION!==void 0){var tt=ke.json.accessors[De.POSITION],Ge=tt.min,We=tt.max;if(Ge!==void 0&&We!==void 0)Se.set(new xe(Ge[0],Ge[1],Ge[2]),new xe(We[0],We[1],We[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var nt=pe.targets;if(nt!==void 0)for(var je=new xe,lt=0,gt=nt.length;lt<gt;lt++){var Lt=nt[lt];if(Lt.POSITION!==void 0){var tt=ke.json.accessors[Lt.POSITION],Ge=tt.min,We=tt.max;Ge!==void 0&&We!==void 0?(je.setX(Math.max(Math.abs(Ge[0]),Math.abs(We[0]))),je.setY(Math.max(Math.abs(Ge[1]),Math.abs(We[1]))),je.setZ(Math.max(Math.abs(Ge[2]),Math.abs(We[2]))),Se.expandByVector(je)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}we.boundingBox=Se;var sn=new Va;Se.getCenter(sn.center),sn.radius=Se.min.distanceTo(Se.max)/2,we.boundingSphere=sn}function ft(we,pe,ke){var De=pe.attributes,Se=[];function tt(je,lt){return ke.getDependency("accessor",je).then(function(gt){we.setAttribute(lt,gt)})}for(var Ge in De){var We=$[Ge]||Ge.toLowerCase();We in we.attributes||Se.push(tt(De[Ge],We))}if(pe.indices!==void 0&&!we.index){var nt=ke.getDependency("accessor",pe.indices).then(function(je){we.setIndex(je)});Se.push(nt)}return Ie(we,pe),_t(we,pe,ke),Promise.all(Se).then(function(){return pe.targets!==void 0?He(we,pe.targets,ke):we})}function Vt(we,pe){var ke=we.getIndex();if(ke===null){var De=[],Se=we.getAttribute("position");if(Se!==void 0){for(var tt=0;tt<Se.count;tt++)De.push(tt);we.setIndex(De),ke=we.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),we}var Ge=ke.count-2,We=[];if(pe===V1)for(var tt=1;tt<=Ge;tt++)We.push(ke.getX(0)),We.push(ke.getX(tt)),We.push(ke.getX(tt+1));else for(var tt=0;tt<Ge;tt++)tt%2===0?(We.push(ke.getX(tt)),We.push(ke.getX(tt+1)),We.push(ke.getX(tt+2))):(We.push(ke.getX(tt+2)),We.push(ke.getX(tt+1)),We.push(ke.getX(tt)));We.length/3!==Ge&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var nt=we.clone();return nt.setIndex(We),nt}return mt.prototype.loadGeometries=function(we){var pe=this,ke=this.extensions,De=this.primitiveCache;function Se(Lt){return ke[i.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Lt,pe).then(function(sn){return ft(sn,Lt,pe)})}for(var tt=[],Ge=0,We=we.length;Ge<We;Ge++){var nt=we[Ge],je=ot(nt),lt=De[je];if(lt)tt.push(lt.promise);else{var gt;nt.extensions&&nt.extensions[i.KHR_DRACO_MESH_COMPRESSION]?gt=Se(nt):gt=ft(new _n,nt,pe),De[je]={primitive:nt,promise:gt},tt.push(gt)}}return Promise.all(tt)},mt.prototype.loadMesh=function(we){for(var pe=this,ke=this.json,De=ke.meshes[we],Se=De.primitives,tt=[],Ge=0,We=Se.length;Ge<We;Ge++){var nt=Se[Ge].material===void 0?Ne(this.cache):this.getDependency("material",Se[Ge].material);tt.push(nt)}return tt.push(pe.loadGeometries(Se)),Promise.all(tt).then(function(je){for(var lt=je.slice(0,je.length-1),gt=je[je.length-1],Lt=[],sn=0,An=gt.length;sn<An;sn++){var le=gt[sn],Ee=Se[sn],Et,wt=lt[sn];if(Ee.mode===B.TRIANGLES||Ee.mode===B.TRIANGLE_STRIP||Ee.mode===B.TRIANGLE_FAN||Ee.mode===void 0)Et=De.isSkinnedMesh===!0?new hd(le,wt):new Fi(le,wt),Et.isSkinnedMesh===!0&&!Et.geometry.attributes.skinWeight.normalized&&Et.normalizeSkinWeights(),Ee.mode===B.TRIANGLE_STRIP?Et.geometry=Vt(Et.geometry,mC):Ee.mode===B.TRIANGLE_FAN&&(Et.geometry=Vt(Et.geometry,V1));else if(Ee.mode===B.LINES)Et=new Xi(le,wt);else if(Ee.mode===B.LINE_STRIP)Et=new fo(le,wt);else if(Ee.mode===B.LINE_LOOP)Et=new lm(le,wt);else if(Ee.mode===B.POINTS)Et=new hm(le,wt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Ee.mode);Object.keys(Et.geometry.morphAttributes).length>0&&Ue(Et,De),Et.name=De.name||"mesh_"+we,gt.length>1&&(Et.name+="_"+sn),Ie(Et,De),pe.assignFinalMaterial(Et),Lt.push(Et)}if(Lt.length===1)return Lt[0];for(var Mn=new Al,sn=0,An=Lt.length;sn<An;sn++)Mn.add(Lt[sn]);return Mn})},mt.prototype.loadCamera=function(we){var pe,ke=this.json.cameras[we],De=ke[ke.type];if(!De){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ke.type==="perspective"?pe=new tr(Xn.radToDeg(De.yfov),De.aspectRatio||1,De.znear||1,De.zfar||2e6):ke.type==="orthographic"&&(pe=new bu(De.xmag/-2,De.xmag/2,De.ymag/2,De.ymag/-2,De.znear,De.zfar)),ke.name!==void 0&&(pe.name=ke.name),Ie(pe,ke),Promise.resolve(pe)},mt.prototype.loadSkin=function(we){var pe=this.json.skins[we],ke={joints:pe.joints};return pe.inverseBindMatrices===void 0?Promise.resolve(ke):this.getDependency("accessor",pe.inverseBindMatrices).then(function(De){return ke.inverseBindMatrices=De,ke})},mt.prototype.loadAnimation=function(we){for(var pe=this.json,ke=pe.animations[we],De=[],Se=[],tt=[],Ge=[],We=[],nt=0,je=ke.channels.length;nt<je;nt++){var lt=ke.channels[nt],gt=ke.samplers[lt.sampler],Lt=lt.target,sn=Lt.node!==void 0?Lt.node:Lt.id,An=ke.parameters!==void 0?ke.parameters[gt.input]:gt.input,le=ke.parameters!==void 0?ke.parameters[gt.output]:gt.output;De.push(this.getDependency("node",sn)),Se.push(this.getDependency("accessor",An)),tt.push(this.getDependency("accessor",le)),Ge.push(gt),We.push(Lt)}return Promise.all([Promise.all(De),Promise.all(Se),Promise.all(tt),Promise.all(Ge),Promise.all(We)]).then(function(Ee){for(var Et=Ee[0],wt=Ee[1],Mn=Ee[2],xn=Ee[3],un=Ee[4],bn=[],Tn=0,hn=Et.length;Tn<hn;Tn++){var jt=Et[Tn],ln=wt[Tn],Xt=Mn[Tn],Ve=xn[Tn],Ot=un[Tn];if(jt!==void 0){jt.updateMatrix(),jt.matrixAutoUpdate=!0;var en;switch(oe[Ot.path]){case oe.weights:en=xu;break;case oe.rotation:en=Pd;break;case oe.position:case oe.scale:default:en=vu;break}var Ln=jt.name?jt.name:jt.uuid,fn=Ve.interpolation!==void 0?be[Ve.interpolation]:Ec,Gn=[];oe[Ot.path]===oe.weights?jt.traverse(function(Mi){Mi.isMesh===!0&&Mi.morphTargetInfluences&&Gn.push(Mi.name?Mi.name:Mi.uuid)}):Gn.push(Ln);var qn=Xt.array;if(Xt.normalized){var Jn;if(qn.constructor===Int8Array)Jn=1/127;else if(qn.constructor===Uint8Array)Jn=1/255;else if(qn.constructor==Int16Array)Jn=1/32767;else if(qn.constructor===Uint16Array)Jn=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var Ji=new Float32Array(qn.length),jn=0,ki=qn.length;jn<ki;jn++)Ji[jn]=qn[jn]*Jn;qn=Ji}for(var jn=0,ki=Gn.length;jn<ki;jn++){var oi=new en(Gn[jn]+"."+oe[Ot.path],ln.array,qn,fn);Ve.interpolation==="CUBICSPLINE"&&(oi.createInterpolant=function(Jr){return new F(this.times,this.values,this.getValueSize()/3,Jr)},oi.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),bn.push(oi)}}}var or=ke.name!==void 0?ke.name:"animation_"+we;return new Po(or,void 0,bn)})},mt.prototype.loadNode=function(we){var pe=this.json,ke=this.extensions,De=this,Se=pe.meshReferences,tt=pe.meshUses,Ge=pe.nodes[we];return function(){var We=[];return Ge.mesh!==void 0&&We.push(De.getDependency("mesh",Ge.mesh).then(function(nt){var je;if(Se[Ge.mesh]>1){var lt=tt[Ge.mesh]++;je=nt.clone(),je.name+="_instance_"+lt}else je=nt;return Ge.weights!==void 0&&je.traverse(function(gt){if(gt.isMesh)for(var Lt=0,sn=Ge.weights.length;Lt<sn;Lt++)gt.morphTargetInfluences[Lt]=Ge.weights[Lt]}),je})),Ge.camera!==void 0&&We.push(De.getDependency("camera",Ge.camera)),Ge.extensions&&Ge.extensions[i.KHR_LIGHTS_PUNCTUAL]&&Ge.extensions[i.KHR_LIGHTS_PUNCTUAL].light!==void 0&&We.push(De.getDependency("light",Ge.extensions[i.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(We)}().then(function(We){var nt;if(Ge.isBone===!0?nt=new V0:We.length>1?nt=new Al:We.length===1?nt=We[0]:nt=new on,nt!==We[0])for(var je=0,lt=We.length;je<lt;je++)nt.add(We[je]);if(Ge.name!==void 0&&(nt.userData.name=Ge.name,nt.name=Ar.sanitizeNodeName(Ge.name)),Ie(nt,Ge),Ge.extensions&&Re(ke,nt,Ge),Ge.matrix!==void 0){var gt=new Kn;gt.fromArray(Ge.matrix),nt.applyMatrix4(gt)}else Ge.translation!==void 0&&nt.position.fromArray(Ge.translation),Ge.rotation!==void 0&&nt.quaternion.fromArray(Ge.rotation),Ge.scale!==void 0&&nt.scale.fromArray(Ge.scale);return nt})},mt.prototype.loadScene=function(){function we(pe,ke,De,Se){var tt=De.nodes[pe];return Se.getDependency("node",pe).then(function(Ge){if(tt.skin===void 0)return Ge;var We;return Se.getDependency("skin",tt.skin).then(function(nt){We=nt;for(var je=[],lt=0,gt=We.joints.length;lt<gt;lt++)je.push(Se.getDependency("node",We.joints[lt]));return Promise.all(je)}).then(function(nt){return Ge.traverse(function(je){if(je.isMesh){for(var lt=[],gt=[],Lt=0,sn=nt.length;Lt<sn;Lt++){var An=nt[Lt];if(An){lt.push(An);var le=new Kn;We.inverseBindMatrices!==void 0&&le.fromArray(We.inverseBindMatrices.array,Lt*16),gt.push(le)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',We.joints[Lt])}je.bind(new im(lt,gt),je.matrixWorld)}}),Ge})}).then(function(Ge){ke.add(Ge);var We=[];if(tt.children)for(var nt=tt.children,je=0,lt=nt.length;je<lt;je++){var gt=nt[je];We.push(we(gt,Ge,De,Se))}return Promise.all(We)})}return function(ke){var De=this.json,Se=this.extensions,tt=this.json.scenes[ke],Ge=this,We=new Ua;tt.name!==void 0&&(We.name=tt.name),Ie(We,tt),tt.extensions&&Re(Se,We,tt);for(var nt=tt.nodes||[],je=[],lt=0,gt=nt.length;lt<gt;lt++)je.push(we(nt[lt],We,De,Ge));return Promise.all(je).then(function(){return We})}}(),e}();function P4(e){new E4().load("./gis/34M_17.gltf",i=>{i.scene.position.set(116577.28779765591,19632.646909285337,0),i.scene.rotateX(Math.PI/2),i.scene.scale.set(2,2,2),e.addObject(i.scene)})}const C4=`import { MxCpp, McGePoint3d, McDbLine, McCmColor } from "mxcad";

//画直线
function drawLine() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 绘制直线
  let line_1 = new McDbLine()
  let pt1 = new McGePoint3d(1000, 200, 0)
  let pt2 = new McGePoint3d(-1000, -200, 0)
  line_1.startPoint = pt1
  line_1.endPoint = pt2
  line_1.trueColor = new McCmColor(0, 255, 0)
  mxcad.drawEntity(line_1)

  let line_2 = new McDbLine(1000, 500, 0, -1000, -500, 0)
  line_2.trueColor = new McCmColor(255, 0, 0)
  line_2.linetypeScale = 0.4
  mxcad.drawEntity(line_2)

  mxcad.drawLine(1000, 800, -1000, -800)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画直线方法
drawLine();
`,R4=`import {MxCpp, McDbCircle , McCmColor, McGePoint3d} from "mxcad"

//画圆
function drawCircle() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  //绘制圆
  const circle_1 = new McDbCircle(-100, 300, 0, 20)
  circle_1.trueColor = new McCmColor(255, 0, 0)
  mxcad.drawEntity(circle_1)

  const circle_2 = new McDbCircle()
  circle_2.center = new McGePoint3d(-100, 300, 0)
  circle_2.radius = 10
  circle_2.trueColor = new McCmColor(0, 255, 0)
  mxcad.drawEntity(circle_2)

  mxcad.drawCircle(-100, 300, 30)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画圆方法
drawCircle();
`,D4=`import { MxCpp, McDbPoint, McCmColor } from "mxcad"

//画点
function drawPoint() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 循环画点
  const point = new McDbPoint()
  const color = new McCmColor(0, 255, 0)
  point.trueColor = color
  for (let i = 0; i < 100; i++) {
    point.setPosition(i, 200 + i)
    mxcad.drawEntity(point)
  }
  for (let i = 0; i < 100; i++) {
    mxcad.drawPoint(i, 150 + i)
  }

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画点的函数
drawPoint();`,I4=`import { MxCpp, McGePoint3d } from "mxcad";

//画图片
function drawImg() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  //图片插入点
  const pt = new McGePoint3d(0, 0, 0)
  //图片地址
  let imagUrl = "https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg";
  mxcad.loadImage(imagUrl, (image) => {
    if (!image) {
      console.log("loadImage failed");
      return;
    }
    let width = mxcad.mxdraw.viewCoordLong2Cad(100);
    let height = (image.height / image.width) * width;
    mxcad.drawImage((pt as any).x, (pt as any).y, width, height, 0, imagUrl,true,image.width,image.height);
    mxcad.updateDisplay();
  });
};

// 调用绘图片方法
drawImg();`,L4=`import { MxCpp, McDbArc, McGePoint3d, McCmColor} from "mxcad";

//画圆弧
function drawArc() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  const arc = new McDbArc()
  arc.center = new McGePoint3d(-100, -100),
    arc.radius = 20
  arc.startAngle = Math.PI / 2
  arc.endAngle = Math.PI * 3 / 2
  arc.trueColor = new McCmColor(255, 233, 0)
  mxcad.drawEntity(arc)

  const arc_1 = new McDbArc()
  const pt1 = new McGePoint3d(-60, -80)
  const pt2 = new McGePoint3d(-80, -100)
  const pt3 = new McGePoint3d(-60, -120)
  arc_1.trueColor = new McCmColor(0, 255, 0)
  arc_1.computeArc(pt1.x, pt1.y, pt2.x, pt2.y, pt3.x, pt3.y)
  mxcad.drawEntity(arc_1)

  mxcad.drawArc(-120, -100, 20, 100, 250);

  mxcad.drawColor = new McCmColor(255, 0, 0)
  mxcad.drawArc2(-80, -80, -100, -100, -80, -120)

  mxcad.drawColor = new McCmColor(0, 0, 255)
  mxcad.drawArc3(-40, -80, -40, -120, 1)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用绘圆方法
drawArc()`,F4=`import { MxCpp, McDbPolyline, McGePoint3d } from "mxcad"

//画多段线
function drawPolyline() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();
 
  // 画多段线
  const polyline = new McDbPolyline()
  polyline.isClosed = true // 设置闭合
  polyline.constantWidth = 5 // 设置线宽
  // 添加多段线顶点
  polyline.addVertexAt(new McGePoint3d(800, 300, 0))
  polyline.addVertexAt(new McGePoint3d(900, 300, 0))
  polyline.addVertexAt(new McGePoint3d(900, 400, 0))
  mxcad.drawEntity(polyline)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
}

// 调用画多段线的方法
drawPolyline()`,k4=`import {McDbEllipse, McGeVector3d, MxCpp, McGePoint3d, McCmColor } from "mxcad";
 
//画椭圆弧
function drawEllipse() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  //绘制椭圆
  const ellipse = new McDbEllipse();
  ellipse.center = new McGePoint3d(-200, -200);
  ellipse.majorAxis = new McGeVector3d(0, 300, 0);
  ellipse.radiusRatio = 0.5;
  ellipse.trueColor = new McCmColor(255, 233, 0);
  mxcad.drawEntity(ellipse);

  const ellipse_arc = new McDbEllipse();
  ellipse_arc.center = new McGePoint3d(-380, -200);
  ellipse_arc.majorAxis = new McGeVector3d(0, 150, 0);
  ellipse_arc.minorAxis = new McGeVector3d(280, 0, 0);
  ellipse_arc.startAngle = Math.PI / 2;
  ellipse_arc.endAngle = Math.PI * 3 / 2;
  ellipse_arc.trueColor = new McCmColor(0, 255, 255);
  mxcad.drawEntity(ellipse_arc);

  mxcad.drawEllipse(0, -200, 200, 0, 1.5);

  mxcad.drawColor = new McCmColor(0, 255, 0);
  mxcad.drawEllipseArc(200, -200, 200, 0, 1.5, 100, 650);

  mxcad.zoomAll();
  mxcad.zoomScale(0.8);
};

// 调用画椭圆的方法
drawEllipse();`,B4=`import { MxCpp, McGePoint3d, McDbText, McCmColor } from "mxcad";

function drawText() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 绘制文字
  let text = new McDbText()
  text.textString = 'Hello World'
  text.position = new McGePoint3d(1000, 200, 0)
  text.height = 50
  text.trueColor = new McCmColor(0, 255, 0)
  mxcad.drawEntity(text)

  mxcad.zoomAll()
  mxcad.zoomScale(0.8)
};

// 调用画文字的方法
drawText();`,z4=`import { MxCpp } from "mxcad";\r
\r
function drawMtext() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
\r
    mxcad.addLayer("MtextLayer");\r
\r
    //设置当前图层为"MtextLayer"\r
\r
    mxcad.drawLayer = "MtextLayer"; \r
\r
    mxcad.drawTextStyle = "";\r
\r
    mxcad.drawMText(0, -100, "控件:\\\\P多行文字测试", 50, 400, 0, 1);\r
\r
    mxcad.zoomAll();\r
    mxcad.updateDisplay();\r
};\r
\r
// 调用画多行文字的方法\r
drawMtext();`,U4=`
import { McDbAlignedDimension,McDb, McDbRotatedDimension, MxCpp, McGePoint3d, McCmColor } from "mxcad";
//画标注
function drawDimension() {
  const mxcad = MxCpp.getCurrentMxCAD();
  // 创建新画布
  mxcad.newFile();

  // 画标注
  const mDimension = new McDbAlignedDimension()
  mDimension.xLine1Point = new McGePoint3d(-1800, 800)
  mDimension.xLine2Point = new McGePoint3d(1800, 800)
  mDimension.dimLinePoint = new McGePoint3d(800, 500)
  mDimension.textAttachment = McDb.AttachmentPoint.kTopLeft
  mDimension.trueColor = new McCmColor(200, 255, 0)
  mDimension.oblique = 0
  mxcad.drawEntity(mDimension)

  const rDimension = new McDbRotatedDimension()
  rDimension.xLine1Point = new McGePoint3d(-1800, -800)
  rDimension.xLine2Point = new McGePoint3d(1800, -800)
  rDimension.dimLinePoint = new McGePoint3d(-800, -500)
  rDimension.textAttachment = McDb.AttachmentPoint.kTopLeft
  rDimension.textRotation = 0.0
  rDimension.trueColor = new McCmColor(200, 255, 0)
  rDimension.oblique = 0
  rDimension.rotation = 0
  rDimension.dimensionText = "标注文本"
  mxcad.drawEntity(rDimension)

  mxcad.zoomCenter(0, 0)
};

// 调用画标注方法
drawDimension();`,N4=`import { MxCpp } from "mxcad";\r
\r
// 画路径\r
function drawPath() {\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    // 创建新画布\r
    mxcad.newFile();\r
    //用路径 绘制矩形框\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(0, 300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(100, 300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(100, 400);\r
    //路径的一下个点\r
    mxcad.pathLineTo(0, 400);\r
    //把路径设置成闭合\r
    mxcad.pathMakeClosed();\r
    //生成一个矩形框的多义线\r
    mxcad.drawPathToPolyline();\r
\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(170, 320)\r
    mxcad.pathLineTo(200, 320)\r
    mxcad.pathLineTo(200, 340)\r
    mxcad.pathLineTo(170, 340)\r
    // 把上面定义的路径定义填充排除区域.\r
    mxcad.pathMakeExclude(true)\r
    mxcad.pathMoveTo(150, 300)\r
    mxcad.pathLineTo(250, 300)\r
    mxcad.pathLineTo(250, 400)\r
    mxcad.pathLineTo(150, 400)\r
    mxcad.pathMakeClosed();\r
    // 将路径生成一个填充 这里的参数是图案缩放比例\r
    mxcad.drawPathToHatch(1);\r
\r
    mxcad.zoomAll();\r
    mxcad.zoomScale(0.8)\r
};\r
\r
// 调用画路径的函数\r
drawPath();`,V4=`import { MxCpp, McCmColor } from "mxcad";\r
\r
// 画填充\r
function drawHatch() {\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    // 创建新画布\r
    mxcad.newFile();\r
    // 绘制一个实心填充\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(150, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(250, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(250, 3400);\r
    //路径的一下个点\r
    mxcad.pathLineTo(150, 3300);\r
    //把路径拟合成一个样线\r
    mxcad.drawColor = new McCmColor(255, 0, 0);\r
    mxcad.drawPathToHatch(1);\r
\r
    // 绘制一个图形填充\r
    mxcad.addPatternDefinition("MyHatchPattern1", "((45, 0,0, 0,0.125))");\r
    mxcad.drawPatternDefinition = "MyHatchPattern1";\r
    //定义一个路径的开始点\r
    mxcad.pathMoveTo(250, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(350, 3300);\r
    //路径的一下个点\r
    mxcad.pathLineTo(350, 3400);\r
    //路径的一下个点\r
    mxcad.pathLineTo(250, 3300);\r
    mxcad.drawColor = new McCmColor(255, 255, 0);\r
    //把路径变成一个填充,80,是填充图案的缩放比例.\r
    mxcad.drawPathToHatch(100);\r
    mxcad.zoomAll()\r
    mxcad.zoomScale(0.8)\r
};\r
\r
// 调用画填充的方法\r
drawHatch();`,O4=`import { MxCpp, McDbBlockTableRecord, McDbLine, McDbCircle, McCmColor, McDbBlockReference, McGePoint3d } from "mxcad";\r
\r
// 画图块\r
function drawBlock() {\r
  const mxcad = MxCpp.getCurrentMxCAD();\r
  // 创建新画布\r
  mxcad.newFile();\r
\r
  // 先从数据库中得到图块表\r
  let blkTable = mxcad.getDatabase().getBlockTable();\r
  // 将一个新的图块记录添加到图块表中\r
  let blkRecId = blkTable.add(new McDbBlockTableRecord());\r
\r
  // 根据ObjectId再次得到刚刚添加的图块记录\r
  let blkTableRecord = blkRecId.getMcDbBlockTableRecord()\r
\r
  // 添加两条线段再图块记录中 这里每条线段的具体属性比如开始点和结束点自行赋值\r
  const line = new McDbLine(50, 50, 0, -50, -50, 0)\r
  line.trueColor = new McCmColor(0, 255, 0)\r
  const line1 = new McDbLine(-50, 50, 0, 50, -50, 0)\r
  const circle = new McDbCircle(0, 0, 0, 50)\r
  circle.trueColor = new McCmColor(255, 255, 0)\r
  blkTableRecord.appendAcDbEntity(line);\r
  blkTableRecord.appendAcDbEntity(line1);\r
  blkTableRecord.appendAcDbEntity(circle);\r
\r
  // 设置图块的基点 一般是包围盒内的点， 可以任意指定\r
  blkTableRecord.origin = new McGePoint3d(0, 0, 0);\r
\r
  // 实例化块参照 这里需要设置我们刚刚添加图块记录得到的ObjectId\r
  let blkRef = new McDbBlockReference();\r
  blkRef.blockTableRecordId = blkRecId;\r
  // 最后设置位置 渲染图块\r
  blkRef.position = new McGePoint3d(0, 0, 0);\r
\r
  mxcad.drawEntity(blkRef);\r
\r
  mxcad.zoomAll()\r
  mxcad.zoomScale(0.8)\r
};\r
\r
// 调用画图块方法\r
drawBlock();`,G4=`import {\r
    MxCpp, McDbLine, McGePoint3d, McDbCustomEntity, IMcDbDwgFiler, MxCADWorldDraw, McGePoint3dArray,\r
    McGeVector3d, McDbText, McDb, MxCADResbuf, MxCADSelectionSet, McObjectId, McDbCircle,\r
    McDbEntity,\r
    McDbMText,\r
    MxCADUtility\r
} from "mxcad"\r
\r
// 线文本自定义实体\r
// 新创建 McDbLineText 类，继承McDbCustomEntity\r
class McDbTestLineText extends McDbCustomEntity {\r
    //设置McDbLineText类中的两个直线端点 pt1、pt2\r
    //以及显示线段长度的文字_text和文字大小_textsize\r
    private pt1: McGePoint3d = new McGePoint3d();\r
    private pt2: McGePoint3d = new McGePoint3d();\r
    private _text: string = "";\r
    private _textsize: number = 10;\r
    /** 包围盒最大点 包围盒最小点 */\r
    private minPt: McGePoint3d = new McGePoint3d();\r
    private maxPt: McGePoint3d = new McGePoint3d();\r
    //构造函数\r
    constructor(imp?: any) {\r
        super(imp);\r
    }\r
    //创建函数\r
    public create(imp: any) {\r
        return new McDbTestLineText(imp)\r
    }\r
    //获取类型\r
    public getTypeName(): string {\r
        return "McDbTestLineText";\r
    }\r
    //设置或获取文本值\r
    public set text(val: string) {\r
        this._text = val;\r
    }\r
    public get text(): string {\r
        return this._text;\r
    }\r
    //设置或获取文本大小\r
    public set textsize(val: number) {\r
        this._textsize = val;\r
    }\r
    public get textsize(): number {\r
        return this._textsize;\r
    }\r
    //读取自定义实体数据pt1、pt2、_text、_textsize\r
    public dwgInFields(filter: IMcDbDwgFiler): boolean {\r
        this.pt1 = filter.readPoint("pt1").val;\r
        this.pt2 = filter.readPoint("pt2").val;\r
        this._text = filter.readString("text").val;\r
        this._textsize = filter.readDouble("textsize").val;\r
        this.minPt = filter.readPoint("minPt").val;\r
        this.maxPt = filter.readPoint("maxPt").val;\r
        return true;\r
    }\r
    //写入自定义实体数据pt1、pt2、_text、_textsize\r
    public dwgOutFields(filter: IMcDbDwgFiler): boolean {\r
        filter.writePoint("pt1", this.pt1);\r
        filter.writePoint("pt2", this.pt2);\r
        filter.writeString("text", this._text);\r
        filter.writeDouble("textsize", this._textsize);\r
        filter.writePoint("minPt", this.minPt);\r
        filter.writePoint("maxPt", this.maxPt);\r
        return true;\r
    }\r
    //自定义同步函数，当其他对象与该对象相连时同步数据\r
    private fineLink(pt: McGePoint3d): any {\r
        let ret: any = {};\r
        let myId = this.getObjectID();\r
        let dSearch = this._textsize * 0.5;;\r
        let filter = new MxCADResbuf();\r
        filter.AddString("CUSTOMENTITY", 5020);\r
        let ss = new MxCADSelectionSet();\r
        ss.crossingSelect(pt.x - dSearch, pt.y - dSearch, pt.x + dSearch, pt.y + dSearch, filter);\r
        ss.forEach((id) => {\r
            if (id == myId)\r
                return;\r
            let ent = id.getMcDbEntity();\r
            if (!ent) return;\r
            if (ent instanceof McDbTestLineText) {\r
                let line = (ent as McDbTestLineText);\r
                let linkPoint = line.getPoint1();\r
                let link_pos = 0;\r
                // 得到直线与图块连接的端点坐标.\r
                let dist = line.getPoint1().distanceTo(pt);\r
                if (dist > line.getPoint2().distanceTo(pt)) {\r
                    dist = line.getPoint2().distanceTo(pt);\r
                    linkPoint = line.getPoint2();\r
                    link_pos = 1;\r
                }\r
                if (dist < dSearch) {\r
                    ret[id.id] = { link_point: linkPoint, link_pos: link_pos };\r
                }\r
            }\r
        });\r
        return ret;\r
    }\r
    //处理夹点编辑效果\r
    public moveGripPointsAt(iIndex: number, dXOffset: number, dYOffset: number, dZOffset: number) {\r
        this.assertWrite();\r
        let pt: McGePoint3d = this.pt1.clone();\r
        let new_pt: McGePoint3d = pt;\r
        if (iIndex == 0) {\r
            this.pt1.x += dXOffset;\r
            this.pt1.y += dYOffset;\r
            this.pt1.z += dZOffset;\r
            new_pt = this.pt1;\r
        }\r
        else if (iIndex == 1) {\r
            pt = this.pt2.clone();\r
            this.pt2.x += dXOffset;\r
            this.pt2.y += dYOffset;\r
            this.pt2.z += dZOffset;\r
            new_pt = this.pt2;\r
        }\r
        if (this.getObjectID().isValid()) {\r
            // 同步，与连接的其它对象。\r
            let linkobj = this.fineLink(pt)\r
            Object.keys(linkobj).forEach((id_val: any) => {\r
                let idFind = new McObjectId(id_val);\r
                let lineFind = (idFind.getMcDbEntity() as McDbTestLineText);\r
                if (linkobj[id_val].link_pos == 0) {\r
                    lineFind.setPoint1(new_pt);\r
                }\r
                else {\r
                    lineFind.setPoint2(new_pt);\r
                }\r
            });\r
        }\r
    };\r
    //设置对象编辑点位\r
    public getGripPoints(): McGePoint3dArray {\r
        let ret = new McGePoint3dArray()\r
        ret.append(this.pt1);\r
        ret.append(this.pt2);\r
        return ret;\r
    };\r
    //动态绘制\r
    public worldDraw(draw: MxCADWorldDraw): void {\r
        const allEntityArr: McDbEntity[] = [];\r
\r
        let circle_r = this._textsize * 0.4;\r
        let vec2 = this.pt2.sub(this.pt1);\r
        vec2.normalize().mult(circle_r);\r
        let tmpline = new McDbLine(this.pt1.clone().addvec(vec2),\r
            this.pt2.clone().subvec(vec2));\r
        draw.drawEntity(tmpline);\r
        allEntityArr.push(tmpline)\r
        let vec = this.pt2.sub(this.pt1).mult(0.5);\r
        let midpt = this.pt1.clone().addvec(vec);\r
        if (vec.dotProduct(McGeVector3d.kXAxis) < 0) {\r
            vec.negate();\r
        }\r
        let ange = vec.angleTo2(McGeVector3d.kXAxis, McGeVector3d.kNegateZAxis);\r
        let str = this._text;\r
        if (str.length == 0) {\r
            str = this.pt1.distanceTo(this.pt2).toFixed(2);\r
        }\r
        vec.perpVector();\r
        if (vec.dotProduct(McGeVector3d.kYAxis) < 0) {\r
            vec.negate();\r
        }\r
        vec.normalize().mult(this._textsize * 0.2);\r
        let text = new McDbText();\r
        text.textString = str;\r
        text.position = midpt.clone().addvec(vec);\r
        text.alignmentPoint = midpt.clone().addvec(vec);\r
        text.rotation = ange;\r
        text.verticalMode = McDb.TextVertMode.kTextBottom;\r
        text.horizontalMode = McDb.TextHorzMode.kTextCenter;\r
        text.height = this._textsize;\r
        draw.drawEntity(text)\r
        allEntityArr.push(text)\r
        let circle1 = new McDbCircle();\r
        circle1.center = this.pt1;\r
        circle1.radius = circle_r;\r
        draw.drawEntity(circle1);\r
        allEntityArr.push(circle1)\r
\r
        let circle2 = new McDbCircle();\r
        circle2.center = this.pt2;\r
        circle2.radius = circle_r;\r
        draw.drawEntity(circle2);\r
        allEntityArr.push(circle2)\r
\r
        this.getBox(allEntityArr);\r
    }\r
    private getBox(entityArr: McDbEntity[]) {\r
        const mxcad = MxCpp.getCurrentMxCAD();\r
        let _minPt, _maxPt = null;\r
        let result;\r
        entityArr.forEach(entity => {\r
            if (entity instanceof McDbText) {\r
                const ent = new McDbMText()\r
                ent.contents = entity.textString;\r
                ent.textHeight = entity.height;\r
                ent.location = entity.position;\r
                switch (entity.horizontalMode) {\r
                    case McDb.TextHorzMode.kTextLeft:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                    case McDb.TextHorzMode.kTextCenter:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    case McDb.TextHorzMode.kTextRight:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomRight;\r
                        break;\r
                    case McDb.TextHorzMode.kTextMid:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    default:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                }\r
                // 将ent的文字样式设置为当前文字样式\r
                const textStyleId = mxcad.getDatabase().getCurrentlyTextStyleId();\r
                ent.textStyleId = textStyleId;\r
                ent.reCompute();\r
                result = MxCADUtility.getTextEntityBox(ent, false);\r
            } else if (entity instanceof McDbMText) {\r
                entity.reCompute();\r
                result = MxCADUtility.getTextEntityBox(entity, false);\r
            } else {\r
                result = entity.getBoundingBox();\r
            }\r
            const { minPt, maxPt, ret } = result;\r
            if (!_minPt) _minPt = minPt.clone();\r
            if (!_maxPt) _maxPt = maxPt.clone();\r
            if (minPt.x < _minPt.x) _minPt.x = minPt.x;\r
            if (minPt.y < _minPt.y) _minPt.y = minPt.y;\r
            if (maxPt.x > _maxPt.x) _maxPt.x = maxPt.x;\r
            if (maxPt.y > _maxPt.y) _maxPt.y = maxPt.y;\r
        });\r
        if (_minPt && _maxPt) {\r
            this.maxPt = _maxPt;\r
            this.minPt = _minPt\r
        }\r
    }\r
    // 设置pt1\r
    public setPoint1(pt1: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt1 = pt1.clone();\r
    }\r
    // 设置pt2\r
    public setPoint2(pt2: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt2 = pt2.clone();\r
    }\r
    // 获取pt1\r
    public getPoint1() {\r
        return this.pt1;\r
    }\r
    //获取pt2\r
    public getPoint2() {\r
        return this.pt2;\r
    }\r
    // 获取包围盒\r
    public getBoundingBox(): { minPt: McGePoint3d; maxPt: McGePoint3d; ret: boolean; } {\r
        return { minPt: this.minPt, maxPt: this.maxPt, ret: true }\r
    }\r
}\r
\r
// 绘线文本自定义实体\r
async function MxTest_LineText() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
\r
    let pt1 = new McGePoint3d(100, 100, 0);\r
    let pt2 = new McGePoint3d(200, 150, 0);\r
    let pt3 = new McGePoint3d(400, 50, 0);\r
    let pt4 = new McGePoint3d(600, 60, 0);\r
    let pt5 = new McGePoint3d(200, 300, 0);\r
\r
    let textsize = 5;\r
\r
    let myline1 = new McDbTestLineText();\r
    myline1.setPoint1(pt1);\r
    myline1.setPoint2(pt2);\r
    myline1.textsize = textsize;\r
    myline1.text = "xxxx";\r
    mxcad.drawEntity(myline1);\r
\r
\r
    let myline2 = new McDbTestLineText();\r
    myline2.setPoint1(pt2);\r
    myline2.setPoint2(pt3);\r
    myline2.textsize = textsize;\r
    mxcad.drawEntity(myline2);\r
\r
    let myline3 = new McDbTestLineText();\r
    myline3.setPoint1(pt3);\r
    myline3.setPoint2(pt4);\r
    myline3.textsize = textsize;\r
    mxcad.drawEntity(myline3);\r
\r
\r
    let myline4 = new McDbTestLineText();\r
    myline4.setPoint1(pt2);\r
    myline4.setPoint2(pt5);\r
    myline4.textsize = textsize;\r
    mxcad.drawEntity(myline4);\r
\r
\r
    //把所有的实体都放到当前显示视区\r
    mxcad.zoomW(new McGePoint3d(-300, -300, 0), new McGePoint3d(650, 500, 0));\r
    //更新视区显示\r
    mxcad.updateDisplay();\r
}\r
\r
// 自定义实体注册\r
new McDbTestLineText().rxInit();\r
// 调用绘线文本自定义实体方法\r
MxTest_LineText();\r
\r
`,j4=`import { McCmColor, MxCpp} from "mxcad"\r
\r
// 绘制多种线型直线\r
function Mx_Test_DrawLine() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
    //把线型改成实线\r
    mxcad.drawLinetype = "";\r
    //设置线宽 4\r
    mxcad.drawLineWidth = 0;\r
  \r
  \r
    //创建一个图层,名为"LineLayer"\r
    mxcad.addLayer("LineLayer");\r
    //设置当前图层为"LineLayer"\r
    mxcad.drawLayer = "LineLayer";\r
    // 直接绘制一个实线\r
    // 参数一直线的开始点x坐标，参数二直线的开始点y坐标，参数三直线的结束点x坐标，参数四直线的结束点y坐标\r
    mxcad.drawLine(0, 0, 100, 0);\r
    // 绘制一个实斜线\r
    mxcad.drawLine(200, 0, 300, 100);\r
  \r
  \r
    //----------------------------------------------------------------------------------------------------------\r
    //绘制一个虚线\r
    //定义虚线数据据,"MyLineType"是线型名，"6,-8"是虚线的一个单位定义，6是实线长，-8是空格长。\r
    mxcad.addLinetype("MyLineType", "6,-10");\r
    //设计当前线型为"MyLineType"\r
    mxcad.drawLinetype = "MyLineType";\r
    // 绘制一个虚线\r
    mxcad.drawLine(0, 30, 100, 30);\r
    // 绘制一个斜虚线\r
    mxcad.drawLine(200, 30, 300, 130);\r
  \r
    //---------------------------------------------------------------------------------------------------------\r
    // 修改绘线的颜色为 16711680(蓝色),  16711680转成16进制是0xFF 00 00,其中，FF是蓝色，00是绿色，第个二00是红色。\r
    mxcad.drawColor = new McCmColor(0, 0, 255);\r
    // 绘制一个蓝色的虚线\r
  \r
    mxcad.drawLine(0, 60, 100, 60);\r
    // 绘制一个蓝色的斜虚线\r
    mxcad.drawLine(200, 60, 300, 160);\r
    //---------------------------------------------------------------------------------------------------------\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
    //把线型改成实线\r
    mxcad.drawLinetype = "";\r
    //设置线宽 4\r
    mxcad.drawLineWidth = 4;\r
    //绘制一个带宽度的直线。\r
    mxcad.drawLine(0, 90, 100, 90);\r
    // 绘制一个带宽度的斜线\r
    mxcad.drawLine(200, 90, 300, 190);\r
  \r
    //---------------------------------------------------------------------------------------------------------\r
    //绘制一个点划线虚线\r
    mxcad.addLinetype("MyLineType2", "10,-2,3,-2");\r
    //把线型改点划线\r
    mxcad.drawLinetype = "MyLineType2";\r
    // 修改绘线的颜色为 255(红色),  255转成16进制是0x00 00 FF,其中，00是蓝色，第个二00是绿色，FF是红色。\r
    mxcad.drawColor = new McCmColor(255, 0, 0);\r
    //绘制一个带宽度的红色点划线。\r
    mxcad.drawLine(0, 120, 100, 120);\r
    // 绘制一个带宽度红色点划斜线\r
    mxcad.drawLine(200, 120, 300, 220);\r
    //---------------------------------------------------------------------------------------------------------\r
    //增加一个带有形的线型\r
    mxcad.addTextStyle("MyLineTypeTextStyle", "txt.shx", "hztxt.shx", 1);\r
    mxcad.addLinetypeEx("MyLineType3", "(12.7,(\\"T=MxDraw\\",\\"S=2.54\\",\\"L=-5.08\\",\\"R=0.0\\",\\"X=-2.54\\",\\"Y=-1.27\\"),-10.08)", "MyLineTypeTextStyle");\r
    mxcad.drawLinetype = "MyLineType3";\r
    mxcad.drawLineWidth = 0;\r
    //绘制一个带宽度的红色点划线。\r
    mxcad.drawLine(350, 120, 600, 120);\r
    //---------------------------------------------------------------------------------------------------------\r
    //增加一个带有形的线型\r
    //把颜色改回黑白色\r
    mxcad.drawColorIndex = 0;\r
    mxcad.drawLineWidth = 4;\r
    //绘制一个带宽度的红色点划线。\r
    mxcad.drawLine(350, 220, 600, 220);\r
  \r
    //把所有的实体都放到当前显示视区\r
    mxcad.zoomAll();\r
    //更新视区显示\r
    mxcad.updateDisplay();\r
  }\r
\r
  // 调用绘制多种线型直线的方法\r
  Mx_Test_DrawLine()`,H4=`import { MxCpp, McCmColor } from "mxcad";\r
\r
function Mx_Test_TrueText() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    //清空当前显示内容\r
    mxcad.newFile();\r
    MxCpp.App.loadFonts([], [], ["syadobe", "simsun"], () => {\r
\r
        // 添加一个黑体文字样式\r
        mxcad.AddTureTypeTextStyle("ht_style", "syadobe");\r
\r
        // 添加一个宋体文字样式\r
        mxcad.AddTureTypeTextStyle("st_style", "simsun");\r
\r
        // 设置当前样式为黑体\r
        mxcad.drawTextStyle = "ht_style";\r
\r
        mxcad.drawColor = new McCmColor(200, 255, 50);\r
        mxcad.drawText(0, 3500, "绘图控件TrueType文字测试1", 100, 0, 0, 1);\r
\r
        // 设置当前样式为黑体\r
        mxcad.drawTextStyle = "st_style";\r
        mxcad.drawColor = new McCmColor(200, 100, 0);\r
        mxcad.drawText(0, 3200, "绘图控件TrueType文字测试2", 100, 0, 0, 1);\r
\r
        mxcad.zoomAll();\r
        mxcad.regen();\r
        mxcad.updateDisplay();\r
    });\r
};\r
\r
// 调用画多种文字样式的文字的方法\r
Mx_Test_TrueText()`,W4=`import { MxCADUiPrPoint, McDbPolyline, McDbArc, MxCpp } from "mxcad";

//画圆弧
async function Mx_drawArc() {
    // 根据起点，中点，端点三个点确定一段圆弧 
    // 获取起点
    let getFristPoint = new MxCADUiPrPoint();
    getFristPoint.setMessage('指定起点');
    let fristPoint = await getFristPoint.go();
    if (!fristPoint) return

    // 获取第二个点
    let getSecondPoint = new MxCADUiPrPoint();
    getSecondPoint.setMessage('指定圆弧的第二个点');
    //动态绘制取点对象
    getSecondPoint.setUserDraw((pt, pw) => {
        let pl = new McDbPolyline();
        pl.addVertexAt(fristPoint)
        pl.addVertexAt(pt);
        pw.drawMcDbEntity(pl)
    })
    let secondPoint = await getSecondPoint.go();
    if (!secondPoint) return;

    // 获取端点
    let getThirdPoint = new MxCADUiPrPoint();
    getThirdPoint.setMessage('指定圆弧的端点');
    //动态绘制圆弧
    getThirdPoint.setUserDraw((pt, pw) => {
        let arc = new McDbArc();
        arc.computeArc(fristPoint.x, fristPoint.y, secondPoint.x, secondPoint.y, pt.x, pt.y);//三点画圆弧
        pw.drawMcDbEntity(arc)
    });
    let thirdPoint = await getThirdPoint.go();
    if (!thirdPoint) return

    // 画圆弧
    let arc = new McDbArc();
    arc.computeArc(fristPoint.x, fristPoint.y, secondPoint.x, secondPoint.y, thirdPoint.x, thirdPoint.y);//三点画圆弧

    const mxcad = MxCpp.getCurrentMxCAD();
    mxcad.drawEntity(arc);
};

// 调用画圆弧的方法
Mx_drawArc();

`,q4=`import {MxCADUiPrPoint, McDbLine, MxCpp} from "mxcad";\r
\r
//画线\r
async function Mx_drawLine() {\r
    // 获取线段起点\r
    let getFristPoint = new MxCADUiPrPoint();\r
    getFristPoint.setMessage("请点击确定起始点");\r
    let fristPoint: any = await getFristPoint.go();\r
    if (!fristPoint) return\r
\r
    // 获取线段终点\r
    let getSecondPoint = new MxCADUiPrPoint();\r
    getSecondPoint.setMessage("请点击确定终点");\r
    getSecondPoint.setUserDraw((pt, pw) => {\r
        let line = new McDbLine(fristPoint.x, fristPoint.y, fristPoint.z, pt.x, pt.y, pt.z);\r
        pw.drawMcDbEntity(line)\r
    })\r
    let secondPoint: any = await getSecondPoint.go();\r
    if (!secondPoint) return\r
\r
    // 绘制线段\r
    let line = new McDbLine(fristPoint.x, fristPoint.y, fristPoint.z, secondPoint.x, secondPoint.y, secondPoint.z);\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    mxcad.drawEntity(line)\r
};\r
\r
// 调用画线的方法\r
\r
Mx_drawLine();`,Y4=`import { McDbText, MxCADUiPrDist, MxCADUiPrPoint, MxCADUiPrString, MxCpp } from "mxcad";\r
\r
async function Mx_drawText() {\r
    // 创建文字对象\r
    const text = new McDbText();\r
\r
    // 设置文字内容\r
    const getStr = new MxCADUiPrString()\r
    getStr.setMessage("请输入文字内容")\r
    const str = await getStr.go()\r
    if (!str) return\r
    text.textString = str;\r
\r
    // 设置文字高度\r
    const getDist = new MxCADUiPrDist()\r
    getDist.setMessage("请输入文字高度")\r
    const height = await getDist.go()\r
    if (!height) return\r
    text.height = getDist.value();\r
\r
    // 设置文字高度\r
    const getPoint = new MxCADUiPrPoint()\r
    getPoint.setMessage("请点击确定文字位置")\r
    getPoint.setUserDraw((pt, pw) => {\r
        text.position = pt;\r
        text.alignmentPoint = pt;\r
        pw.drawMcDbEntity(text)\r
    })\r
    const position = await getPoint.go()\r
    if (!position) return\r
    text.position = position;\r
    text.alignmentPoint = position\r
\r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    mxcad.drawEntity(text);\r
};\r
\r
// 调用绘制文字的方法\r
Mx_drawText();`,X4=`import {McDbCircle, MxCADUiPrDist, MxCADUiPrPoint, MxCpp} from "mxcad";\r
\r
// 画圆\r
async function Mx_drawCircle(){\r
    // 创建圆\r
    const circle = new McDbCircle();\r
\r
    // 获取圆心\r
    const getCenter = new MxCADUiPrPoint();\r
    getCenter.setMessage('请确定圆心位置\\n');\r
    const center = await getCenter.go();\r
    if (!center) return;\r
    circle.center = center;\r
\r
    // 获取圆半径\r
    const getRadius = new MxCADUiPrDist();\r
    getRadius.setBasePt(center);\r
    getRadius.setMessage('请输入圆半径');\r
    // 动态绘制圆\r
    getRadius.setUserDraw((pt, pw) => {\r
        const r = pt.distanceTo(center);\r
        circle.radius = r;\r
        pw.drawMcDbEntity(circle)\r
    })\r
    const radiusVal = await getRadius.go();\r
    if (!radiusVal) return;\r
    circle.radius = getRadius.value();\r
\r
    // 绘制圆\r
    const mxobj = MxCpp.getCurrentMxCAD();\r
    mxobj.drawEntity(circle);\r
};\r
\r
// 调用画圆的方法\r
Mx_drawCircle();`,K4=`import {MxCADUiPrPoint, MxCpp} from "mxcad";\r
\r
//画图片\r
async function Mx_drawImg() {\r
    // 设置图片插入点\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定插入点:");\r
    let pt = await getPoint.go();\r
    if (!pt) return;\r
   \r
    const mxcad = MxCpp.getCurrentMxCAD();\r
    // 设置图片地址\r
    let imagUrl = "https://cdn.pixabay.com/photo/2022/11/15/12/23/winter-7593872_960_720.jpg";\r
    mxcad.loadImage(imagUrl,(image)=>{\r
        if(!image ){ \r
        console.log("loadImage failed");\r
        return;\r
        }\r
        // 设置图片宽高\r
        let width = mxcad.mxdraw.viewCoordLong2Cad(100);\r
        let height  = (image.height /  image.width) * width;\r
        mxcad.drawImage((pt as any).x,(pt as any).y,width,height,0,imagUrl,true,image.width,image.height);\r
        mxcad.updateDisplay();\r
    });\r
};\r
\r
// 调用画图片的方法\r
Mx_drawImg();`,Z4=`import { MxCpp, MxCADUiPrPoint, McDbPolyline, MxCADUiPrDist, McGeVector3d, McGePoint3d, McDbArc, MxCADUtility, McDbLine, McDb} from "mxcad";\r
\r
// 画多段线\r
async function Mx_drawPolyline() {\r
    // 获取画布实例\r
    const mxcad = MxCpp.App.getCurrentMxCAD();\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定起点:");\r
    let firstPoint = await getPoint.go();\r
    if (!firstPoint) return;\r
    let pointArr: any[] = [];\r
    let drawObjIds: any[] = [];\r
    let isArc: boolean = false;\r
    let dStartWidth: number = 0;\r
    let dEndWidth: number = 0;\r
    pointArr.push({ pt: firstPoint, dBulge: 0, dStartWidth, dEndWidth })\r
    let isAutoClose: boolean = false;\r
    let isReverse: boolean = false;//圆弧方向是否取反\r
    let arcDirection: any = null //指定圆弧切向\r
    while (true) {\r
        if (!isArc) {\r
            //绘直线\r
            const getNextPoint = new MxCADUiPrPoint;\r
            getNextPoint.setMessage("\\n指定下一个点");\r
            // 提示消息\r
            if (pointArr.length < 2) {\r
                getNextPoint.setKeyWords('[圆弧(A)/宽度(W)]')\r
            } else {\r
                getNextPoint.setKeyWords('[放弃(U)/圆弧(A)/宽度(W)/闭合(C)]')\r
            }\r
            let lastPoint = pointArr[pointArr.length - 1];//鼠标点击的最后一个点\r
            // 等待鼠标点击期间会执行setUserDraw动态绘制函数中的回调函数\r
            getNextPoint.setUserDraw((pt, pw) => {\r
                // pt 就是鼠标所在图纸位置的坐标\r
                // pw 是提供了一些动态绘制方法的对象\r
                let pl = new McDbPolyline();\r
                pl.addVertexAt(lastPoint.pt, lastPoint.dBulge, lastPoint.dStartWidth, lastPoint.dEndWidth)\r
                pl.addVertexAt(pt, 0, dStartWidth, dEndWidth);\r
                pw.drawMcDbEntity(pl);\r
            })\r
            let nextPoint = await getNextPoint.go();\r
            if (nextPoint !== null) {\r
                // 获取到了鼠标点击点\r
                pointArr.push({ pt: nextPoint, dBulge: 0, dStartWidth, dEndWidth });\r
                let pl = new McDbPolyline();\r
                pl.addVertexAt(lastPoint.pt, lastPoint.dBulge, lastPoint.dStartWidth, lastPoint.dEndWidth);\r
                pl.addVertexAt(nextPoint, 0, dStartWidth, dEndWidth);\r
                drawObjIds.push(mxcad.drawEntity(pl))\r
            } else if (getNextPoint.getStatus() === Mx.MrxDbgUiPrBaseReturn.kKeyWord) {\r
                // 用户输入关键字\r
                let keyWord = getNextPoint.keyWordPicked()\r
                if (keyWord === 'A') {\r
                    // 绘制圆弧\r
                    isArc = true;\r
                } else if (keyWord === 'W') {\r
                    // 设置宽度\r
                    /**\r
                     * 输入空格宽度不变\r
                     */\r
                    let getWidth = new MxCADUiPrDist();\r
                    getWidth.setMessage('指定起点宽度:');\r
                    // 获取线宽\r
                    let dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dStartWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dStartWidth = dStartWidth;\r
                    }\r
                    getWidth.setMessage('指定端点宽度');\r
                    dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dEndWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dEndWidth = dEndWidth;\r
                    }\r
                } else if (keyWord === 'U') {\r
                    // 回退操作\r
                    if (pointArr.length > 1 && drawObjIds.length > 1) {\r
                        pointArr.pop();\r
                        drawObjIds[drawObjIds.length - 1].erase();\r
                        drawObjIds.pop();\r
                    }\r
                } else if (keyWord === 'C') {\r
                    isAutoClose = true;\r
                    break;\r
                }\r
            } else {\r
                break;\r
            }\r
        } else {\r
            // 绘制圆弧\r
            let getNextPoint = new MxCADUiPrPoint();\r
            getNextPoint.setMessage('指定圆弧的端点(按住 ctrl 键取相反方向)\\n');\r
            getNextPoint.setKeyWords('[第二个点(S)/角度(A)/圆心(CE)/放弃(U)/直线(L)/宽度(W)/闭合(CL)]');\r
            // 计算圆弧的切向量.\r
            let vecArcTangent = new McGeVector3d();\r
            // 开端的圆弧切向量取水平方向./获取圆弧切向\r
            if (pointArr.length < 2) {\r
                // 开端的圆弧切向量取水平方向.\r
                vecArcTangent.copy(McGeVector3d.kYAxis);\r
            } else {\r
                let length = pointArr.length;\r
                let p1 = pointArr[length - 2].pt;\r
                let dBulge = pointArr[length - 2].dBulge;\r
                let p2 = pointArr[length - 1].pt;\r
                if (dBulge === 0) {\r
                    // 前一段是个直线.\r
                    vecArcTangent = new McGePoint3d(p2.x, p2.y, 0.0).sub(new McGePoint3d(p1.x, p1.y, 0.0));\r
                }\r
                else {\r
                    // 前一段为曲线，求圆弧的切向量\r
                    let tmpPl = new McDbPolyline;\r
                    tmpPl.addVertexAt(p1, dBulge);\r
                    tmpPl.addVertexAt(p2);\r
                    let tmpVec = tmpPl.getFirstDeriv(new McGePoint3d(p2.x, p2.y, 0.0));//曲线上任意一点的切向量\r
                    if (tmpVec.ret) {\r
                        vecArcTangent = tmpVec.val;\r
                    }\r
                    else {\r
                        vecArcTangent.copy(McGeVector3d.kXAxis);\r
                    }\r
                }\r
            }\r
            let lastPoint = pointArr[pointArr.length - 1];\r
            //监听ctrl键是否被按下\r
            document.addEventListener('keydown', function (event) {\r
                if (event.ctrlKey && event.keyCode === 17) {\r
                    isReverse = true;\r
                }\r
            });\r
            // ctrl键松开\r
            document.addEventListener('keyup', function () {\r
                isReverse = false;\r
            });\r
            getNextPoint.setUserDraw((pt, pw) => {\r
                let pl = new McDbPolyline();\r
                let d = CMxDrawPolylineDragArcDraw_CalcArcBulge(lastPoint.pt, pt, arcDirection ? arcDirection : vecArcTangent);\r
                if (isReverse) d = -d;\r
                pl.addVertexAt(lastPoint.pt, d, lastPoint.dStartWidth, lastPoint.dEndWidth);\r
                pl.addVertexAt(pt, 0, dStartWidth, dEndWidth);\r
                pw.drawMcDbEntity(pl);\r
            })\r
            let nextPoint = await getNextPoint.go();\r
            if (nextPoint != null) {\r
                let dBulge = CMxDrawPolylineDragArcDraw_CalcArcBulge(lastPoint.pt, nextPoint, arcDirection ? arcDirection : vecArcTangent);\r
                if (isReverse) dBulge = -dBulge;\r
                lastPoint.dBulge = dBulge;\r
                pointArr.push({ pt: nextPoint, dBulge: 0, dStartWidth, dEndWidth });\r
                let pl = new McDbPolyline();\r
                pl.addVertexAt(lastPoint.pt, dBulge, lastPoint.dStartWidth, lastPoint.dEndWidth);\r
                pl.addVertexAt(nextPoint, 0, dStartWidth, dEndWidth);\r
                drawObjIds.push(mxcad.drawEntity(pl));\r
            } else if (getNextPoint.getStatus() === Mx.MrxDbgUiPrBaseReturn.kKeyWord) {\r
                // 获取用户输入关键字\r
                let keyWord = getNextPoint.keyWordPicked();\r
                if (keyWord === 'L') {\r
                    // 变直线\r
                    isArc = false;\r
                } else if (keyWord === 'U') {\r
                    // 回退\r
                    if (pointArr.length > 1 && drawObjIds.length > 1) {\r
                        pointArr.pop();\r
                        drawObjIds[drawObjIds.length - 1].erase();\r
                        drawObjIds.pop();\r
                    }\r
                } else if (keyWord === 'S') {\r
                    // 用户指定圆弧的第二个点\r
                    let getPoint2 = new MxCADUiPrPoint();//用户输入的指定点\r
                    getPoint2.setMessage("指定圆弧的第二个点");\r
                    let pt2: any = await getPoint2.go();\r
                    if (pt2 === null) return\r
                    let getPoint3 = new MxCADUiPrPoint();\r
                    getPoint3.setMessage("指定圆弧的端点");\r
                    let lastPoint = pointArr[pointArr.length - 1]\r
                    getPoint3.setUserDraw((pt, pw) => {\r
                        let arc = new McDbArc();\r
                        arc.computeArc(lastPoint.pt.x, lastPoint.pt.y, pt2.x, pt2.y, pt.x, pt.y);//三点绘制圆弧\r
                        pw.drawMcDbEntity(arc);\r
                    });\r
                    let pt3 = await getPoint3.go();\r
                    if (!pt3) break;\r
                    let retB = MxCADUtility.calcBulge(lastPoint.pt, pt2, pt3);//开始点,中点，结束点 三点计算当前弧线的凸度\r
                    if (!retB.ret) break;\r
                    pointArr[pointArr.length - 1] = retB.val;\r
                    pointArr.push({ pt: pt3, dBulge: 0, dStartWidth, dEndWidth });//最后一个点\r
                    let pl = new McDbPolyline();\r
                    pl.addVertexAt(lastPoint.pt, retB.val, dStartWidth, dEndWidth);\r
                    pl.addVertexAt(pt3);\r
                    drawObjIds.push(mxcad.drawEntity(pl));\r
                } else if (keyWord === 'W') {\r
                    // 设置宽度\r
                    let getWidth = new MxCADUiPrDist();\r
                    getWidth.setMessage('指定起点宽度:');\r
                    // 获取线宽\r
                    let dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dStartWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dStartWidth = dStartWidth;\r
                    }\r
                    getWidth.setMessage('指定端点宽度');\r
                    dWVal = await getWidth.go();\r
                    if (dWVal !== null && getWidth.getStatus() !== Mx.MrxDbgUiPrBaseReturn.kNone) {\r
                        dEndWidth = getWidth.value();\r
                        pointArr[pointArr.length - 1].dEndWidth = dEndWidth;\r
                    }\r
                } else if (keyWord === 'D') {\r
                    // 指定圆弧切向\r
                    let getDirection = new MxCADUiPrPoint();\r
                    getDirection.setMessage('指定圆弧起点的切向:');\r
                    let dirVal = await getDirection.go();\r
                    if (dirVal === null) break;\r
                    arcDirection = new McGeVector3d(dirVal.x, dirVal.y, dirVal.z)\r
                } else if (keyWord === 'CE') {\r
                    // 确定圆心\r
                    let getCenter = new MxCADUiPrPoint();\r
                    getCenter.setMessage('指定圆弧的圆心:');\r
                    let arcCenter: any = await getCenter.go();\r
                    if (!arcCenter) return;\r
                    // 起始角度：起点与圆心的连线与X轴正方向的夹角\r
                    // 结束角度：结束点与圆心的连线与X轴正方向的夹角\r
                    let getNextPoint = new MxCADUiPrPoint();\r
                    let lastPoint = pointArr[pointArr.length - 1];\r
                    let r: number = 0;//圆弧凸度\r
                    let arc = new McDbArc();//圆弧\r
                    // 开端的圆弧切向量取水平方向./获取圆弧切向\r
                    getNextPoint.setUserDraw(async (pt, pw) => {\r
                        // 起始角度\r
                        arc.startAngle = lastPoint.pt.sub(arcCenter).angleTo1(new McGeVector3d(arcCenter.x, 0, 0))//始终不变\r
                        arc.endAngle = pt.sub(arcCenter).angleTo1(new McGeVector3d(arcCenter.x, 0, 0))\r
                        arc.center = arcCenter;\r
                        arc.radius = arcCenter.distanceTo(lastPoint.pt);\r
                        if (pt.y < arcCenter.y) arc.endAngle = -arc.endAngle;\r
                        // // 获取圆弧上的第三个点\r
                        let lineX = new McDbPolyline();\r
                        lineX.addVertexAt(new McGePoint3d(arcCenter.x, 0, 0));\r
                        lineX.addVertexAt(new McGePoint3d(0, 0, 0));\r
                        let pointsX = arc.IntersectWith(lineX, 3);//X轴交点\r
                        // 获取凸度\r
                        let rLine = new McDbPolyline();\r
                        rLine.addVertexAt(arcCenter);\r
                        rLine.addVertexAt(pt);\r
                        let currentPoint = arc.IntersectWith(rLine, 2);//当前线段与圆弧的交点\r
                        let cp: any = null;\r
                        if (currentPoint.length() === 1) {\r
                            cp = currentPoint.at(0);\r
                        } else {\r
                            if (pt.distanceTo(currentPoint.at(0)) <= pt.distanceTo(currentPoint.at(1))) {\r
                                cp = currentPoint.at(0);\r
                            } else {\r
                                cp = currentPoint.at(1);\r
                            }\r
                        }\r
                        let retB = MxCADUtility.calcBulge(lastPoint.pt, pointsX.at(0), cp);\r
                        if (retB.ret) {\r
                            r = retB.val;\r
                            let pl = new McDbPolyline()\r
                            pl.addVertexAt(lastPoint.pt, r);\r
                            pl.addVertexAt(cp);\r
                            pw.drawMcDbEntity(pl)\r
                        }\r
                    })\r
                    let nextPoint = await getNextPoint.go();\r
                    if (!nextPoint) break;\r
                    // 获取凸度\r
                    let rLine = new McDbPolyline();\r
                    rLine.addVertexAt(arcCenter);\r
                    rLine.addVertexAt(nextPoint);\r
                    let currentPoint = arc.IntersectWith(rLine, 2);\r
                    let cp: any = null;\r
                    if (currentPoint.length() === 1) {\r
                        cp = currentPoint.at(0);\r
                    } else {\r
                        if (nextPoint.distanceTo(currentPoint.at(0)) <= nextPoint.distanceTo(currentPoint.at(1))) {\r
                            cp = currentPoint.at(0);\r
                        } else {\r
                            cp = currentPoint.at(1);\r
                        }\r
                    }\r
                    let pl = new McDbPolyline()\r
                    pl.addVertexAt(lastPoint.pt, r, dStartWidth, dEndWidth);\r
                    pl.addVertexAt(cp);\r
                    pointArr[pointArr.length - 1].dBulge = r;\r
                    pointArr.push({ pt: cp, dBulge: 0, dStartWidth, dEndWidth })\r
                    drawObjIds.push(mxcad.drawEntity(pl));\r
\r
                } else if (keyWord === 'CL') {\r
                    // 闭合\r
                    isAutoClose = true;\r
                    break;\r
                }\r
            } else {\r
                break;\r
            }\r
\r
        }\r
    }\r
    // 删除监听事件\r
    document.removeEventListener('keydown', () => isReverse = false)\r
    document.removeEventListener('keyup', () => isReverse = false)\r
    // 最终绘制\r
    /**\r
     * 先删除所有临时对象再重新绘制多边形\r
     */\r
    for (let i = 0; i < drawObjIds.length; i++) {\r
        drawObjIds[i].erase();\r
    }\r
    if (pointArr.length > 1) {\r
        let pl = new McDbPolyline();\r
        pointArr.forEach(item => {\r
            pl.addVertexAt(item.pt, item.dBulge, item.dStartWidth, item.dEndWidth)\r
        })\r
        pl.isClosed = isAutoClose;\r
        mxcad.drawEntity(pl);\r
    }\r
}\r
\r
// 计算圆弧凸度\r
function CMxDrawPolylineDragArcDraw_CalcArcBulge(firstPoint, nextPoint, vecArcTangent): number {\r
    if (firstPoint.isEqualTo(nextPoint))\r
        return 0.0;\r
    let midPt = firstPoint.c().addvec(nextPoint.c().sub(firstPoint).mult(0.5));\r
\r
    let vecMid = nextPoint.c().sub(firstPoint);\r
    vecMid.rotateBy(Math.PI / 2.0, McGeVector3d.kZAxis);\r
\r
    let tmpMidLine = new McDbLine(midPt, midPt.c().addvec(vecMid));\r
\r
    let vecVertical = vecArcTangent.c();\r
    vecVertical.rotateBy(Math.PI / 2.0, McGeVector3d.kZAxis);\r
\r
    let tmpVerticalLine = new McDbLine(firstPoint, firstPoint.c().addvec(vecVertical));\r
\r
    let aryPoint = tmpMidLine.IntersectWith(tmpVerticalLine, McDb.Intersect.kExtendBoth);\r
    if (aryPoint.isEmpty())\r
        return 0.0;\r
\r
    let arcCenPoint = aryPoint.at(0);\r
\r
    let dR = arcCenPoint.distanceTo(firstPoint);\r
\r
    vecMid.normalize();\r
    vecMid.mult(dR);\r
\r
    let arcMidPt1 = arcCenPoint.c().addvec(vecMid);\r
    let arcMidPt2 = arcCenPoint.c().subvec(vecMid);\r
    let vecArcDir1 = arcMidPt1.c().sub(firstPoint);\r
    let vecArcDir2 = arcMidPt2.c().sub(firstPoint);\r
    let arcMidPt = arcMidPt1;\r
    if (vecArcDir1.angleTo1(vecArcTangent) > vecArcDir2.angleTo1(vecArcTangent)) {\r
        arcMidPt = arcMidPt2;\r
    }\r
    return MxCADUtility.calcBulge(firstPoint, arcMidPt, nextPoint).val;\r
}\r
\r
// 调用画多段线的方法\r
Mx_drawPolyline();`,J4=`import { McDbEllipse,MxCADUiPrPoint, McDbLine, McGePoint3d, MxCADUiPrDist, MxCpp } from "mxcad";\r
\r
// 绘制椭圆\r
async function drawMxDbEllipse() {\r
 \r
    // 创建椭圆对象\r
    const ellipse = new McDbEllipse();\r
    \r
    // 指定椭圆的轴端点\r
    const getPt1 = new MxCADUiPrPoint();\r
    getPt1.setMessage("\\n指定椭圆的轴端点:");\r
    const pt1 = await getPt1.go();\r
    if (!pt1) return;\r
\r
    // 指定椭圆轴的另一个端点\r
    const getPt2 = new MxCADUiPrPoint();\r
    getPt2.setMessage("\\n指定椭圆轴的另一个端点:");\r
    getPt2.setUserDraw((pt, pw) => {\r
        const line = new McDbLine(pt, pt1);\r
        pw.drawMcDbEntity(line);\r
    })\r
    const pt2 = await getPt2.go();\r
    if (!pt2) return;\r
\r
    // 获取椭圆中心点\r
    const center = new McGePoint3d((pt1.x + pt2.x) / 2, (pt1.y + pt2.y) / 2);\r
    ellipse.center = center;\r
    ellipse.majorAxis = pt1.sub(pt2);\r
    const xRadius = pt1.distanceTo(pt2) / 2\r
\r
    // 指定另一条半轴长度\r
    const getDist = new MxCADUiPrDist();\r
    getDist.setMessage("指定另一条半轴长度")\r
    getDist.setBasePt(center)\r
    getDist.setUserDraw((pt, pw) => {\r
        const yRadius = center.distanceTo(pt) / 2\r
        // 设置椭圆的副轴长度与主轴长度的比值\r
        ellipse.radiusRatio = yRadius / xRadius\r
        pw.drawMcDbEntity(ellipse)\r
    })\r
    let length = await getDist.go()\r
    if (!length) return\r
    if (getDist.getDetailedResult() === Mx.DetailedResult.kCoordIn) {\r
        const yRadius = length / 2\r
        ellipse.radiusRatio = yRadius / xRadius\r
    }\r
    MxCpp.getCurrentMxCAD().drawEntity(ellipse)\r
};\r
\r
// 调用绘制椭圆的方法\r
drawMxDbEllipse();`,Q4=`import { MxCADUiPrPoint, MxCADUtility, MxCpp } from "mxcad";\r
\r
// 选点填充\r
async function MxTest_DrawHatchFormPoint() {\r
    // 指定填充区域内部一点\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定填充区域内部一点:");\r
    getPoint.disableAllTrace(true);\r
    getPoint.setDisableOsnap(true);\r
    let pt = await getPoint.go();\r
    if (!pt) return;\r
    \r
    // 绘制填充\r
    let hatch = MxCADUtility.builderHatchFromPoint(pt);\r
    if (!hatch) {\r
        Mx.MxFun.acutPrintf("没有找到闭合区域\\n")\r
        return;\r
    }\r
\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    mxcad.drawEntity(hatch);\r
};\r
\r
// 调用选点填充的方法\r
MxTest_DrawHatchFormPoint();`,$4=`import { McDbBlockReference, MxCADUiPrPoint, MxCpp } from "mxcad";\r
\r
function getHostUrl(): string {\r
    let host = window.location.hostname;\r
    if (host.substring(0, 4) != "http") {\r
        host = document.location.protocol + "//" + host;\r
    }\r
    return host;\r
}\r
\r
// 插入图块\r
async function MxTest_InsertBlock() {\r
    let baseUrl = "http://localhost:3000/mxcad/"\r
    if (baseUrl.substring(0, 16) == "http://localhost") {\r
      baseUrl = getHostUrl() + baseUrl.substring(16);\r
    }\r
    // 设置图块路径\r
    let blkFilePath = baseUrl + "tree.mxweb";\r
\r
    // 插入图块文件\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
    let blkrecId = await mxcad.insertBlock(blkFilePath, "tree");\r
    if (!blkrecId.isValid()) {\r
        // 插入图块\r
        return;\r
    }\r
\r
    // 设置图块大小\r
    let blkRef = new McDbBlockReference();\r
    blkRef.blockTableRecordId = blkrecId;\r
    let box = blkRef.getBoundingBox();\r
    if (box.ret) {\r
        let dLen = box.maxPt.distanceTo(box.minPt);\r
        if (dLen > 0.00001) {\r
            blkRef.setScale(mxcad.getMxDrawObject().screenCoordLong2Doc(100) / dLen);\r
        }\r
    }\r
\r
    // 指定插入基点\r
    let getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\指定插入基点");\r
\r
    // 动态绘制图块\r
    getPoint.setUserDraw((v, worldDraw) => {\r
        blkRef.position = v;\r
        worldDraw.drawMcDbEntity(blkRef);\r
    });\r
\r
    let pt = await getPoint.go();\r
    if (!pt) return;\r
    blkRef.position = pt;\r
    // 绘制图块\r
    let newBlkRefId = mxcad.drawEntity(blkRef);\r
    if (!newBlkRefId.isValid) {\r
        console.log("insert error");\r
        return;\r
    }\r
};\r
\r
// 调用插入图块方法\r
MxTest_InsertBlock();`,eF=`import { IMcDbDwgFiler, McDb, McDbCustomEntity, McDbEntity, McDbMText, McDbPolyline, McDbText, McGePoint3d, McGePoint3dArray, MxCADUiPrPoint, MxCADUtility, MxCADWorldDraw, MxCpp } from "mxcad";\r
\r
// 新创建 McDbTestLineCustomEntity 类继承 McDbCustomEntity\r
class McDbTestRectangle extends McDbCustomEntity {\r
    // 定义McDbTestLineCustomEntity内部的点对象 \r
    // 矩形角点pt1、pt2\r
    private pt1: McGePoint3d = new McGePoint3d();\r
    private pt2: McGePoint3d = new McGePoint3d();\r
    /** 包围盒最大点 包围盒最小点 */\r
    private minPt: McGePoint3d = new McGePoint3d();\r
    private maxPt: McGePoint3d = new McGePoint3d();\r
    // 构造函数\r
    constructor(imp?: any) {\r
        super(imp);\r
    }\r
    // 创建函数\r
    public create(imp: any) {\r
        return new McDbTestRectangle(imp)\r
    }\r
    // 获取类名\r
    public getTypeName(): string {\r
        return "McDbTestRectangle";\r
    }\r
    // 读取自定义实体数据pt1、pt2\r
    public dwgInFields(filter: IMcDbDwgFiler): boolean {\r
        this.pt1 = filter.readPoint("pt1").val;\r
        this.pt2 = filter.readPoint("pt2").val;\r
        this.minPt = filter.readPoint("minPt").val;\r
        this.maxPt = filter.readPoint("maxPt").val;\r
        return true;\r
    }\r
    // 写入自定义实体数据pt1、pt2\r
    public dwgOutFields(filter: IMcDbDwgFiler): boolean {\r
        filter.writePoint("pt1", this.pt1);\r
        filter.writePoint("pt2", this.pt2);\r
        filter.writePoint("minPt", this.minPt);\r
        filter.writePoint("maxPt", this.maxPt);\r
        return true;\r
    }\r
\r
    // 移动自定义对象的夹点\r
    public moveGripPointsAt(iIndex: number, dXOffset: number, dYOffset: number, dZOffset: number) {\r
        this.assertWrite();\r
        if (iIndex == 0) {\r
            this.pt1.x += dXOffset;\r
            this.pt1.y += dYOffset;\r
            this.pt1.z += dZOffset;\r
        }\r
        else if (iIndex == 1) {\r
            this.pt2.x += dXOffset;\r
            this.pt2.y += dYOffset;\r
            this.pt2.z += dZOffset;\r
        }\r
    };\r
    // 获取自定义对象的夹点\r
    public getGripPoints(): McGePoint3dArray {\r
        let ret = new McGePoint3dArray()\r
        ret.append(this.pt1);\r
        ret.append(this.pt2);\r
        return ret;\r
    };\r
    // 绘制实体\r
    public worldDraw(draw: MxCADWorldDraw): void {\r
        const allEntityArr: McDbEntity[] = [];\r
\r
        const pl = new McDbPolyline();\r
        pl.isClosed = true;\r
        pl.addVertexAt(this.pt1);\r
        pl.addVertexAt(new McGePoint3d(this.pt2.x, this.pt1.y));\r
        pl.addVertexAt(this.pt2);\r
        pl.addVertexAt(new McGePoint3d(this.pt1.x, this.pt2.y));\r
        draw.drawEntity(pl);\r
        allEntityArr.push(pl)\r
\r
        this.getBox(allEntityArr);\r
    }\r
    private getBox(entityArr: McDbEntity[]) {\r
        const mxcad = MxCpp.getCurrentMxCAD();\r
        let _minPt, _maxPt = null;\r
        let result;\r
        entityArr.forEach(entity => {\r
            if (entity instanceof McDbText) {\r
                const ent = new McDbMText()\r
                ent.contents = entity.textString;\r
                ent.textHeight = entity.height;\r
                ent.location = entity.position;\r
                switch (entity.horizontalMode) {\r
                    case McDb.TextHorzMode.kTextLeft:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                    case McDb.TextHorzMode.kTextCenter:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    case McDb.TextHorzMode.kTextRight:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomRight;\r
                        break;\r
                    case McDb.TextHorzMode.kTextMid:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomCenter;\r
                        break;\r
                    default:\r
                        ent.attachment = McDb.AttachmentPoint.kBottomLeft;\r
                        break;\r
                }\r
                // 将ent的文字样式设置为当前文字样式\r
                const textStyleId = mxcad.getDatabase().getCurrentlyTextStyleId();\r
                ent.textStyleId = textStyleId;\r
                ent.reCompute();\r
                result = MxCADUtility.getTextEntityBox(ent, false);\r
            } else if (entity instanceof McDbMText) {\r
                entity.reCompute();\r
                result = MxCADUtility.getTextEntityBox(entity, false);\r
            } else {\r
                result = entity.getBoundingBox();\r
            }\r
            const { minPt, maxPt, ret } = result;\r
            if (!_minPt) _minPt = minPt.clone();\r
            if (!_maxPt) _maxPt = maxPt.clone();\r
            if (minPt.x < _minPt.x) _minPt.x = minPt.x;\r
            if (minPt.y < _minPt.y) _minPt.y = minPt.y;\r
            if (maxPt.x > _maxPt.x) _maxPt.x = maxPt.x;\r
            if (maxPt.y > _maxPt.y) _maxPt.y = maxPt.y;\r
        });\r
        if (_minPt && _maxPt) {\r
            this.maxPt = _maxPt;\r
            this.minPt = _minPt\r
        }\r
    }\r
    // 设置pt1\r
    public setPoint1(pt1: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt1 = pt1.clone();\r
    }\r
    // 设置pt2\r
    public setPoint2(pt2: McGePoint3d) {\r
        this.assertWrite();\r
        this.pt2 = pt2.clone();\r
    }\r
    // 获取pt1\r
    public getPoint1() {\r
        return this.pt1;\r
    }\r
    // 获取pt2\r
    public getPoint2() {\r
        return this.pt2;\r
    }\r
    // 获取包围盒\r
    public getBoundingBox(): { minPt: McGePoint3d; maxPt: McGePoint3d; ret: boolean; } {\r
        return { minPt: this.minPt, maxPt: this.maxPt, ret: true }\r
    }\r
}\r
\r
\r
async function MxTest_DrawCustomEntity() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    const getPoint = new MxCADUiPrPoint();\r
    getPoint.setMessage("\\n指定第一个角点:");\r
    let pt1 = await getPoint.go();\r
    if (!pt1) return;\r
    const myRect = new McDbTestRectangle();\r
    myRect.setPoint1(pt1);\r
\r
    getPoint.setMessage("\\n指定第二个角点:");\r
    getPoint.setUserDraw((pt, pw) => {\r
        myRect.setPoint2(pt);\r
        pw.drawMcDbEntity(myRect);\r
    })\r
    let pt2 = await getPoint.go();\r
    if (!pt2) return;\r
\r
    myRect.setPoint2(pt2);\r
    mxcad.drawEntity(myRect);\r
}\r
\r
// 注册自定义实体\r
new McDbTestRectangle().rxInit();\r
// 调用方法绘制自定义实体\r
MxTest_DrawCustomEntity();\r
`,tF=`import { McDbAlignedDimension, McDbArc, McDbBlockReference, McDbCircle, McDbDimension, McDbHatch, McDbLine, McDbMText, McDbPolyline, McDbRasterImage, McDbRotatedDimension, McDbText, MxCADSelectionSet } from "mxcad";\r
\r
\r
// 点对象转字符串\r
function McGePoint3dToString(pt): string {\r
    return "x=" + pt.x + ",y=" + pt.y + ",z=" + pt.z;\r
}\r
\r
// 实体对象转json对象\r
function McDbEntityToJsonObject(ent): object {\r
    let obj: any = {}\r
    obj.ObjectName = ent.objectName;// 对象名\r
    obj.id = ent.getObjectID().id;// 对象id\r
    obj.handle = ent.getHandle(); // 对象句柄\r
    obj.layer = ent.layer; // 对象所在图层\r
    obj.color = ent.trueColor.getColorString(); // 对象颜色说明字符串\r
    obj.colorVal = ent.trueColor.getColorValue(ent.layerId); // 对象颜色字符串\r
    obj.linetype = ent.linetype; // 对象线型\r
    obj.textStyle = ent.textStyle; // 对象文字样式\r
    obj.dxf0 = ent.dxf0;// 得到对象的DXF组码的类型名\r
\r
    if (ent instanceof McDbText) {\r
        // 文字对象\r
        let txt = ent as McDbText;\r
        obj.position = McGePoint3dToString(txt.position);\r
        obj.textString = txt.textString;\r
    }\r
    else if (ent instanceof McDbMText) {\r
        // 多行文字对象\r
        let mtxt = ent as McDbMText;\r
        obj.contents = mtxt.contents;\r
        obj.location = McGePoint3dToString(mtxt.location);\r
    }\r
    else if (ent instanceof McDbLine) {\r
        // 直线对象\r
        let line = ent as McDbLine;\r
        obj.startPoint = McGePoint3dToString(line.startPoint);\r
        obj.endPoint = McGePoint3dToString(line.endPoint);\r
    }\r
    else if (ent instanceof McDbCircle) {\r
        // 圆对象\r
        let circle = ent as McDbCircle;\r
        obj.center = McGePoint3dToString(circle.center);\r
        obj.radius = circle.radius;\r
    }\r
    else if (ent instanceof McDbArc) {\r
        // 圆弧对象\r
        let arc = ent as McDbArc;\r
        obj.center = McGePoint3dToString(arc.center);\r
        obj.startAngle = arc.startAngle;\r
        obj.endAngle = arc.endAngle;\r
    }\r
    else if (ent instanceof McDbPolyline) {\r
        // 多段线对象\r
        let polyline = ent as McDbPolyline;\r
        let num = polyline.numVerts();\r
        obj.num = num;\r
        for (let i = 0; i < num; i++) {\r
            let pt = polyline.getPointAt(i);\r
            let bulge = polyline.getBulgeAt(i);\r
            obj["pt" + i] = McGePoint3dToString(pt.val);\r
            obj["bulge" + i] = bulge;\r
        }\r
    }\r
    else if (ent instanceof McDbBlockReference) {\r
        // 块引用对象\r
        let blkRef = ent as McDbBlockReference;\r
        obj.position = McGePoint3dToString(blkRef.position);\r
        obj.blockTransform = blkRef.blockTransform;\r
        obj.blockName = blkRef.blockName;\r
    }\r
    else if (ent instanceof McDbAlignedDimension) {\r
        // 对齐标注对象\r
        let alignedDim = ent as McDbAlignedDimension;\r
        obj.xLine1Point = McGePoint3dToString(alignedDim.xLine1Point);\r
        obj.xLine2Point = McGePoint3dToString(alignedDim.xLine2Point);\r
        let txts = alignedDim.GetAllText();\r
        txts.forEach((val, index) => {\r
            obj["txt:" + index] = val;\r
        });\r
    }\r
    else if (ent instanceof McDbRotatedDimension) {\r
        // 旋转标注对象\r
        let rotatedDim = ent as McDbRotatedDimension;\r
        obj.xLine1Point = McGePoint3dToString(rotatedDim.xLine1Point);\r
        obj.xLine2Point = McGePoint3dToString(rotatedDim.xLine2Point);\r
        let txts = rotatedDim.GetAllText();\r
        txts.forEach((val, index) => {\r
            obj["txt:" + index] = val;\r
        });\r
    }\r
    else if (ent instanceof McDbDimension) {\r
        // 标注对象\r
        let dim = ent as McDbDimension;\r
        let txts = dim.GetAllText();\r
        txts.forEach((val, index) => {\r
            obj["txt:" + index] = val;\r
        });\r
    }\r
    else if (ent instanceof McDbHatch) {\r
        // 填充对象\r
        let hatch = ent as McDbHatch;\r
        obj.patternType = hatch.patternType();\r
        obj.patternName = hatch.patternName();\r
        obj.patternAngle = hatch.patternAngle;\r
        obj.patternScale = hatch.patternScale;\r
        obj.patternSpace = hatch.patternSpace;\r
        obj.patternDouble = hatch.patternDouble;\r
        obj.hatchStyle = hatch.hatchStyle();\r
        obj.isSolid = hatch.isSolid();\r
        obj.numLoops = hatch.numLoops;\r
        for (let i = 0; i < obj.numLoops; i++) {\r
            let loop: any = hatch.getLoopAt(i);\r
            loop.vertices.forEach((val: any, inidex: number) => {\r
                loop["pt:" + inidex] = {};\r
                loop["pt:" + inidex].x = val.x;\r
                loop["pt:" + inidex].y = val.y;\r
                loop["pt:" + inidex].z = val.z;\r
            })\r
            obj["loop:" + i] = loop;\r
        };\r
        obj.numPatternDefinitions = hatch.numPatternDefinitions;\r
        for (let i = 0; i < obj.numPatternDefinitions; i++) {\r
            obj["patternDefinitions:" + i] = hatch.getPatternDefinitionAt(i);\r
        };\r
    }\r
    else if (ent instanceof McDbRasterImage) {\r
        // 位图对象\r
        let image = ent as McDbRasterImage;\r
        let orientation = image.getOrientation();\r
        obj.orientation = {};\r
        obj.orientation.origin = orientation.origin.toVector3();\r
        obj.orientation.uCorner = orientation.uCorner.toVector3();\r
        obj.orientation.vOnPlane = orientation.vOnPlane.toVector3();\r
\r
        let clipBoundary = image.clipBoundary();\r
        obj.clipBoundary = {};\r
        clipBoundary.forEach((pt, index) => {\r
            obj.clipBoundary["pt" + index] = pt.toVector3();\r
        });\r
\r
        obj.clipBoundaryType = image.clipBoundaryType();\r
\r
        let imageDef = image.imageDefId().getMcDbRasterImageDef();\r
        if (imageDef) {\r
            obj.filePath = imageDef.sourceFileName;\r
        }\r
    }\r
\r
    return obj;\r
}\r
// 得到图纸所有对象\r
async function TestGetAllEntity() {\r
\r
    let ss = new MxCADSelectionSet();\r
    ss.allSelect();\r
    ss.forEach((id) => {\r
        let ent: any = id.getMcDbEntity();\r
        if (!ent) return;\r
        ent = McDbEntityToJsonObject(ent);\r
        console.log(JSON.stringify(ent));\r
    })\r
};\r
\r
// 调用得到图纸所有对象的方法\r
TestGetAllEntity()`,nF=`import { McDbLayerTableRecord, MxCpp } from "mxcad";\r
\r
// 添加图层\r
function MxTest_AddLayer() {\r
    // 获取当前mxcad对象\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
\r
    // 获取数据库图层表\r
    let layerTable = mxcad.getDatabase().getLayerTable();\r
    // 判断图层表中是否存在xxx11图层\r
    if (!layerTable.has("xxx11")) {\r
        // 不存在则创建xxx11图层\r
        let newLayer = new McDbLayerTableRecord();\r
        newLayer.name = "xxx11";\r
        layerTable.add(newLayer);\r
    }\r
\r
    if (layerTable.has("xxx11")) {\r
        // 存在则打印日志\r
        console.log("add layer ok");\r
    }\r
};\r
\r
// 调用添加图层的方法\r
MxTest_AddLayer(); `,iF=`import { MxCpp } from "mxcad";\r
\r
function MxTest_GetAllBlock() {\r
    // 获取当前mxcad对象\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
    // 获取数据库块表\r
    let blockTable = mxcad.getDatabase().getBlockTable();\r
    // 获取所有块表记录的id数组\r
    let aryId = blockTable.getAllRecordId();\r
    // 遍历所有块表记录\r
    aryId.forEach((id) => {\r
        let blkRec = id.getMcDbBlockTableRecord();\r
        if (blkRec === null) return;\r
        console.log(blkRec);\r
        console.log("blkRec.name:" + blkRec.name);\r
        console.log("blkRec.origin:" + blkRec.origin);\r
    });\r
};\r
\r
// 调用获取所有图块的方法\r
MxTest_GetAllBlock();\r
`,rF=`import { MxCpp } from "mxcad";\r
import { MxFun } from "mxdraw";\r
\r
// 获取所有图层\r
function MxTest_GetAllLayer() {\r
  // 获取当前mxcad对象\r
    let mxcad = MxCpp.App.getCurrentMxCAD();\r
    // 获取图层表\r
    let layerTable = mxcad.getDatabase().getLayerTable();\r
    // 获取所有记录id\r
    let aryId = layerTable.getAllRecordId();\r
    let ret = [];\r
    // 遍历图层id\r
    aryId.forEach((id) => {\r
      let layerRec = id.getMcDbLayerTableRecord();\r
      if (layerRec === null) return;\r
  \r
      console.log(layerRec);\r
      console.log("layerRec.color:" + layerRec.color.getColorString());\r
      console.log("layerRec.name:" + layerRec.name);\r
      let layer: any = {};\r
      layer.name = layerRec.name;\r
  \r
      layer.color = layerRec.color.getColorString();\r
      ret.push(layer);\r
    });\r
    \r
    MxFun.postMessageToParentFrame(ret);\r
    return ret;\r
  };\r
\r
  // 调用获取所有图层的方法\r
  MxTest_GetAllLayer();`,oF=`import { MxCpp } from "mxcad"\r
\r
// 获取所有线型样式\r
function MxTest_GetAllLinetype() {\r
    // 获取当前mxcad对象\r
    let mxobj = MxCpp.getCurrentMxCAD();\r
    // 获取数据库线型样式表\r
    let linetypeTable = mxobj.getDatabase().getLinetypeTable();\r
    // 获取所有线型记录的ID数组\r
    let aryId = linetypeTable.getAllRecordId();\r
    // 遍历线型记录\r
    aryId.forEach((id) => {\r
        let linetypeRec = id.getMcDbLinetypeTableRecord();\r
        if (linetypeRec === null) return;\r
        console.log(linetypeRec);\r
    });\r
};\r
\r
// 调用获取所有线型样式\r
MxTest_GetAllLinetype()`,aF=`import { MxCpp } from "mxcad";\r
\r
// 获取所有文字样式\r
function MxTest_GetAllTextStyle() {\r
    // 获取当前mxcad对象\r
    let mxobj = MxCpp.getCurrentMxCAD();\r
    // 获取文字样式表\r
    let textSyleTable = mxobj.getDatabase().getTextStyleTable();\r
    // 获取文字样式表记录id数组\r
    let aryId = textSyleTable.getAllRecordId();\r
    // 遍历文字样式表记录\r
    aryId.forEach((id) => {\r
        let textSyleRec = id.getMcDbTextStyleTableRecord();\r
        if (textSyleRec === null) return;\r
        let out: any = {};\r
        out.name = textSyleRec.name;\r
        out.font = textSyleRec.font();\r
        out.fileName = textSyleRec.fileName;\r
        out.bigFontFileName = textSyleRec.bigFontFileName;\r
        out.textSize = textSyleRec.textSize;\r
        out.xScale = textSyleRec.xScale;\r
        console.log(out);\r
    });\r
};\r
\r
// 调用获取所有文字样式的方法\r
MxTest_GetAllTextStyle();\r
`,sF=`import { MxCADUiPrEntity } from "mxcad";\r
\r
// 读取扩展数据。\r
async function MxTest_ReadxData() {\r
    // 选择对象\r
    let selEntity = new MxCADUiPrEntity();\r
    selEntity.setMessage("选择对象");\r
    let id = await selEntity.go();\r
    if (!id.isValid()) return;\r
    \r
    // 获取对象\r
    let ent = id.getMcDbEntity();\r
    if (ent === null) return; \r
\r
    // 得到对象的扩展数据\r
    let data = ent.getxData();\r
    //data.PrintData();\r
    data.forEach((val, type, dxf) => {\r
        console.log(JSON.stringify({ val: val, type: type, dxf: dxf }));\r
    })\r
\r
    //let data = ent.getxDataString("DataName");\r
    //MxFun.acutPrintf(data.val + "\\n");\r
};\r
\r
// 调用读取扩展数据的方法\r
MxTest_ReadxData()`,lF=`import { MxCADUiPrEntity } from "mxcad";\r
\r
// 写扩展数据\r
async function MxTest_WritexData() {\r
    // 选择对象\r
    let selEntity = new MxCADUiPrEntity();\r
    selEntity.setMessage("选择对象");\r
    let id = await selEntity.go();\r
    if (!id.isValid()) return;\r
     \r
    // 获取对象\r
    let ent = id.getMcDbEntity();\r
    if (ent === null) return;\r
    // 写扩展数据\r
    ent.setxDataString("DataName", "xxxxx");\r
    //ent.setxData(new MxCADResbuf([{type:MxCADResbufDataType.kExDataName,val:"DataName"},{type:MxCADResbufDataType.kString,val:"yyyyy"}]));\r
};\r
\r
// 调用写扩展数据的方法\r
 MxTest_WritexData();\r
\r
`,cF=`import { MxCpp, McDbDictionary, McDbXrecord } from "mxcad";\r
\r
// 字典数据遍历\r
function MxTest_DictionaryData(dict) {\r
    let aryName = dict.getAllObjectName();\r
    aryName.forEach((name) => {\r
        console.log(name);\r
        let id = dict.getAt(name);\r
        let obj = id.getMcDbObject();\r
        if (obj instanceof McDbDictionary) {\r
            let dict = obj as McDbDictionary;\r
            console.log(dict);\r
            MxTest_DictionaryData(dict);\r
        }\r
        else if (obj instanceof McDbXrecord) {\r
            let xrec = obj as McDbXrecord;\r
            let data = xrec.getData()\r
            data.PrintData();\r
        }\r
    })\r
}\r
\r
// 得到命名字典\r
async function MxTest_GetNamedObjectsDictionary() {\r
    let mxcad = MxCpp.getCurrentMxCAD();\r
    let dict = mxcad.getDatabase().getNamedObjectsDictionary();\r
    let aryName = dict.getAllObjectName();\r
    aryName.forEach((name) => {\r
        console.log(name);\r
        let id = dict.getAt(name);\r
        let obj = id.getMcDbObject();\r
        if (obj instanceof McDbDictionary) {\r
            let dict = obj as McDbDictionary;\r
            console.log(dict);\r
            MxTest_DictionaryData(dict);\r
        }\r
    })\r
}\r
\r
// 调用得到命名字典方法\r
MxTest_GetNamedObjectsDictionary()`,Kw=[{type:"参数绘图",name:"画直线",code:`${C4}`},{type:"参数绘图",name:"画圆",code:R4},{type:"参数绘图",name:"画点",code:D4},{type:"参数绘图",name:"画圆弧",code:L4},{type:"参数绘图",name:"画图片",code:I4},{type:"参数绘图",name:"画多段线",code:F4},{type:"参数绘图",name:"画椭圆",code:k4},{type:"参数绘图",name:"画文字",code:B4},{type:"参数绘图",name:"画多行文字",code:z4},{type:"参数绘图",name:"画尺寸标注",code:U4},{type:"参数绘图",name:"画路径",code:N4},{type:"参数绘图",name:"画填充",code:V4},{type:"参数绘图",name:"画图块",code:O4},{type:"参数绘图",name:"画文本自定义实体",code:G4},{type:"参数绘图",name:"画多种线型的直线",code:j4},{type:"参数绘图",name:"画多种文字样式的文字",code:H4},{type:"交互绘图",name:"取点画圆弧",code:W4},{type:"交互绘图",name:"取点画直线",code:q4},{type:"交互绘图",name:"取点画文字",code:Y4},{type:"交互绘图",name:"取点画圆",code:X4},{type:"交互绘图",name:"取点画图片",code:K4},{type:"交互绘图",name:"取点画多段线",code:Z4},{type:"交互绘图",name:"取点画椭圆",code:J4},{type:"交互绘图",name:"选点填充",code:Q4},{type:"交互绘图",name:"插入图块",code:$4},{type:"交互绘图",name:"绘制矩形",code:eF},{type:"图纸数据库",name:"得到图纸所有对象",code:tF},{type:"图纸数据库",name:"添加图层",code:nF},{type:"图纸数据库",name:"得到图纸所有图块",code:iF},{type:"图纸数据库",name:"得到图纸所有图层",code:rF},{type:"图纸数据库",name:"得到图纸所有线型样式",code:oF},{type:"图纸数据库",name:"得到图纸所有文字样式",code:aF},{type:"图纸数据库",name:"读扩展数据",code:sF},{type:"图纸数据库",name:"写入扩展数据",code:lF},{type:"图纸数据库",name:"得到命名字典",code:cF}];function uF(e,t,i){const c=e.distanceTo(t)/2,h=c*i,f=(c*c+h*h)/(2*h),r=(e.x+t.x)/2,v=(e.y+t.y)/2;return new R.McGePoint3d(r,v).addvec(t.clone().sub(e).perpVector().normalize().mult(f-h))}function hF(e,t,i){const l=Math.PI*2/360;let c=Math.atan2(t.y-e.y,t.x-e.x)*180/Math.PI*l,h=Math.atan2(i.y-e.y,i.x-e.x)*180/Math.PI*l;return{startAngle:c,endAngle:h}}Ke.MxFun.addCommand("list",()=>Pn(this,null,function*(){const e=yield R.MxCADUtility.userSelect("选择对象"),t=new R.MxCADUiPrPoint;Ke.MxFun.acutPrintf("找到"+e.length+`个
`);const i=e.pop();if(!i)return;const l=i.getMcDbEntity();if(!i.isValid()||!l)Ke.MxFun.acutPrintf(`对象无效
`);else if((yield Qw(l))===!1)return;for(;e.length;){if(t.setMessage("按 ENTER 键继续"),t.setDisableDynInput(!0),yield t.go(),t.getDetailedResult()===Ke.DetailedResult.kCodeAbort||t.getDetailedResult()===Ke.DetailedResult.kEcsIn||t.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;const c=e.pop();if(!c)break;const h=c.getMcDbEntity();if(!c.isValid()||!h){Ke.MxFun.acutPrintf(`对象无效
`);continue}if((yield Qw(h))===!1)return}}));const dF={McDbPoint:"点",McDbLine:"直线",McDbPolyline:"多段线",McDbArc:"圆弧",McDbCircle:"圆",McDbEllipse:"椭圆",McDbHatch:"填充",McDbText:"单行文本",McDbMText:"多行文本",McDbRasterImage:"光栅图片",McDbBlockReference:"块参照"},Zw={Top:"上",Middle:"中",Bottom:"下",Base:"基",Left:"左",Center:"中",Right:"右",Align:"对齐",Fit:"适应",Mid:"中"},Jw=e=>e.replace(/k(\w+)/g,function(t,i){return i.replace(/([A-Z])/g,"-$1").split("-").reduce((f,r)=>Zw[r]?f+Zw[r]:"")});function Qw(e){return Pn(this,null,function*(){const t=e.layer,c=R.MxCpp.getCurrentDatabase().currentSpace.name==="*Model_Space"?"模型空间":"图纸空间",h=e.getHandle();console.log(e.objectName);let f=dF[e.objectName]||e.objectName;if(e instanceof R.McDbDimension&&(f="标注"),Ke.MxFun.acutPrintf(`
                  ${f}        图层: "${t}"`),Ke.MxFun.acutPrintf(`
                           空间: "${c}"`),Ke.MxFun.acutPrintf(`
                    句柄 = ${h}`),e instanceof R.McDbPoint&&Ke.MxFun.acutPrintf(`
                 于 点， X= ${e.position.x.toFixed(4)}  Y= ${e.position.y.toFixed(4)}  Z= ${e.position.z.toFixed(4)}`),e instanceof R.McDbLine){Ke.MxFun.acutPrintf(`
                 自 点， X= ${e.startPoint.x.toFixed(4)}  Y= ${e.startPoint.y.toFixed(4)}  Z= ${e.startPoint.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                 到 点， X= ${e.startPoint.x.toFixed(4)}  Y= ${e.startPoint.y.toFixed(4)}  Z= ${e.startPoint.z.toFixed(4)}`);let r=e.endPoint.x-e.startPoint.x,v=e.endPoint.y-e.startPoint.y,_=e.endPoint.z-e.startPoint.z,w=THREE.MathUtils.radToDeg(Math.atan2(v,r));Ke.MxFun.acutPrintf(`
          长度 = ${e.getLength().val.toFixed(4)}，在 XY 平面中的角度 = ${Math.floor(w)}`),Ke.MxFun.acutPrintf(`
                  增量 X =  ${r.toFixed(4)}，增量 Y =   ${v.toFixed(4)}，增量 Z =   ${_.toFixed(4)}`)}if(e instanceof R.McDbPolyline){Ke.MxFun.acutPrintf(`
            ${e.isClosed?"闭合":"打开"}`),Ke.MxFun.acutPrintf(`
        固定宽度    ${e.constantWidth.toFixed(4)}`),Ke.MxFun.acutPrintf(`
            面积   ${e.getArea().val.toFixed(4)}`),Ke.MxFun.acutPrintf(`
         周长   ${e.getLength().val.toFixed(4)}`);const r=e.numVerts(),v=new R.MxCADUiPrPoint,_=[],w=[];let b=!1;for(let I=0;I<r;I++){const F=e.getWidthsAt(I),B=e.getBulgeAt(I);(F.val1!==0||F.val2!==0)&&(b=!0),_.push(F),w.push(B)}let E=0;const P=3;for(let I=0;I<r;I++){if(E>P)for(;;){v.setMessage("按 ENTER 键继续"),v.disableAllTrace(),v.clearLastInputPoint(),v.setDynamicInputType(Ke.DynamicInputType.kNoInput);const O=yield v.go();if(v.getDetailedResult()===Ke.DetailedResult.kCodeAbort||v.getDetailedResult()===Ke.DetailedResult.kEcsIn)return;if(v.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return!1;if(v.getDetailedResult()===Ke.DetailedResult.kNullEnterIn||v.getDetailedResult()===Ke.DetailedResult.kNullSpaceIn||O){E=0;break}}const F=e.getPointAt(I).val,B=w[I];if(Ke.MxFun.acutPrintf(`
          于端点  X=  ${F.x.toFixed(1)}  Y=  ${F.y.toFixed(1)}  Z=  ${F.z.toFixed(1)}`),b&&(Ke.MxFun.acutPrintf(`
    起点宽度  ${_[I].val1.toFixed(4)}`),Ke.MxFun.acutPrintf(`
      端点宽度  ${_[I].val2.toFixed(4)}`)),Math.abs(B)>0){Ke.MxFun.acutPrintf(`
             凸度       ${B.toFixed(1)}`);const O=e.getPointAt(I+1).val,W=uF(F,O,B);Ke.MxFun.acutPrintf(`
            圆心  X=  ${W.x.toFixed(1)}  Y=  ${W.y.toFixed(1)}  Z=  ${W.z.toFixed(1)}`),Ke.MxFun.acutPrintf(`
            半径    ${W.distanceTo(F).toFixed(1)}`);const{startAngle:Z,endAngle:ie}=hF(W,F,O);Ke.MxFun.acutPrintf(`
       起点角度       ${THREE.MathUtils.radToDeg(Z).toFixed(0)}`),Ke.MxFun.acutPrintf(`
       端点角度       ${THREE.MathUtils.radToDeg(ie).toFixed(0)}`),I===r-1&&Ke.MxFun.acutPrintf(`
          于端点  X=  ${O.x.toFixed(1)}  Y=  ${O.y.toFixed(1)}  Z=  ${O.z.toFixed(1)}`)}E++}}if(e instanceof R.McDbArc&&(Ke.MxFun.acutPrintf(`
                圆心 点， X= ${e.center.x.toFixed(4)}  Y= ${e.center.y.toFixed(4)}  Z= ${e.center.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                半径  ${e.radius.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                起点 角度    ${THREE.MathUtils.radToDeg(e.startAngle).toFixed(0)}`),Ke.MxFun.acutPrintf(`
                端点 角度    ${THREE.MathUtils.radToDeg(e.endAngle).toFixed(0)}`),Ke.MxFun.acutPrintf(`
            长度 ${e.getLength().val.toFixed(4)}`)),e instanceof R.McDbCircle&&(Ke.MxFun.acutPrintf(`
                圆心 点， X= ${e.center.x.toFixed(4)}  Y= ${e.center.y.toFixed(4)}  Z= ${e.center.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                半径  ${e.radius.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                周长 ${e.getLength().val.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                面积 ${(Math.PI*e.radius*e.radius).toFixed(4)}`)),e instanceof R.McDbEllipse){const r=e.majorAxis.length(),v=e.minorAxis.length(),_=e.startAngle===0&&e.endAngle===2*Math.PI;if(_){const P=(I,F)=>{const B=Math.pow(I-F,2)/Math.pow(I+F,F);return Math.PI*(I+F)*(1+3*B/(10+Math.sqrt(4-3*B)))};Ke.MxFun.acutPrintf(`
                               面积: ${(Math.PI*r*v).toFixed(4)}`),Ke.MxFun.acutPrintf(`
                               圆周: ${P(r,v).toFixed(4)}`)}else{const P=(I,F,B,O,W)=>{const Z=function(oe){return Math.sqrt(I*I*Math.sin(oe)*Math.sin(oe)+F*F*Math.cos(oe)*Math.cos(oe))};let ie=0;const $=(O-B)/W;for(let oe=0;oe<=W;oe++){const be=B+oe*$;oe===0||oe===W?ie+=Z(be):oe%2===0?ie+=2*Z(be):ie+=4*Z(be)}return ie*=$/3,Math.abs(ie)};Ke.MxFun.acutPrintf(`
                               长度: ${P(r,v,e.startAngle,e.endAngle,30).toFixed(4)}`)}Ke.MxFun.acutPrintf(`
                              中心点: X = ${e.center.x.toFixed(4)} , Y = ${e.center.y.toFixed(4)}   , Z = ${e.center.z.toFixed(4)}`);const w=r>v,b=w?e.majorAxis:e.minorAxis,E=w?e.minorAxis:e.majorAxis;if(Ke.MxFun.acutPrintf(`
                               长轴: X = ${b.x.toFixed(4)}  , Y = ${b.y.toFixed(4)}  , Z = ${b.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                               短轴: X = ${E.x.toFixed(4)}  , Y = ${E.y.toFixed(4)}  , Z = ${E.z.toFixed(4)}`),!_){const P=(B,O,W,Z,ie)=>{const $=B.x,oe=B.y,be=O.x,fe=O.y,Le=W.x,Xe=W.y,Ne=Math.atan2(fe,be),Re=Math.sqrt(be*be+fe*fe),Ie=Math.sqrt(Le*Le+Xe*Xe),He=$+Re*Math.cos(Z)*Math.cos(Ne)-Ie*Math.sin(Z)*Math.sin(Ne),Ue=oe+Re*Math.cos(Z)*Math.sin(Ne)+Ie*Math.sin(Z)*Math.cos(Ne),ot=$+Re*Math.cos(ie)*Math.cos(Ne)-Ie*Math.sin(ie)*Math.sin(Ne),Pt=oe+Re*Math.cos(ie)*Math.sin(Ne)+Ie*Math.sin(ie)*Math.cos(Ne);return{startPoint:new R.McGePoint3d(He,Ue),endPoint:new R.McGePoint3d(ot,Pt)}},{startPoint:I,endPoint:F}=P(e.center,e.majorAxis,e.minorAxis,e.startAngle,e.endAngle);Ke.MxFun.acutPrintf(`
                               起点: X = ${I.x.toFixed(4)} , Y = ${I.y.toFixed(4)}  , Z = ${I.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                               端点: X = ${F.x.toFixed(4)} , Y = ${F.y.toFixed(4)}  , Z = ${F.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                             起点角度: ${THREE.MathUtils.radToDeg(e.startAngle).toFixed(0)}`),Ke.MxFun.acutPrintf(`
                             端点角度: ${THREE.MathUtils.radToDeg(e.endAngle).toFixed(0)}`)}Ke.MxFun.acutPrintf(`
                             半径比例: ${e.radiusRatio.toFixed(4)}`)}if(e instanceof R.McDbHatch){const r=e.patternName();Ke.MxFun.acutPrintf(`
                 填充图案 ${r}`),Ke.MxFun.acutPrintf(`
                 图案填充比例    ${e.patternScale.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                 图案填充角度      ${THREE.MathUtils.radToDeg(e.patternAngle).toFixed(0)}`);const v=new R.McDbPolyline,_=[];v.isClosed=!0;for(let b=0;b<e.numLoops;b++){const{vertices:E,bulges:P}=e.getLoopAt(b);E.forEach((I,F)=>{const B=P[F];v.addVertexAt(I,Number(B.toFixed(14)))}),_.push(v),R.MxCpp.getCurrentMxCAD().drawEntity(v)}const w=_.reduce((b,E)=>b+E.getArea().val,0);Ke.MxFun.acutPrintf(`
                 面积      ${w.toFixed(4)}`)}if(e instanceof R.McDbText&&(Ke.MxFun.acutPrintf(`
              样式 = "${e.textStyle}"`),Ke.MxFun.acutPrintf(`
                起点 点， X=  ${e.position.x.toFixed(4)}  Y= ${e.position.y.toFixed(4)}  Z=   ${e.position.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                高度    ${e.height.toFixed(4)}`),Ke.MxFun.acutPrintf(`
                文字 ${e.textString}`),Ke.MxFun.acutPrintf(`
                旋转 角度    ${e.rotation.toFixed(0)}`),Ke.MxFun.acutPrintf(`
                宽度 比例因子    ${e.widthFactor.toFixed(4)}`)),e instanceof R.McDbMText&&(Ke.MxFun.acutPrintf(`
              样式 = "${e.textStyle}"`),Ke.MxFun.acutPrintf(`
位置:         X=  ${e.location.x.toFixed(4)}  Y=   ${e.location.y.toFixed(4)}  Z=   ${e.location.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
宽度:           ${e.width.toFixed(4)}`),Ke.MxFun.acutPrintf(`
法向:         X=   ${e.normal.x.toFixed(4)}  Y=   ${e.normal.y.toFixed(4)}  Z=   ${e.normal.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
旋转:                 ${e.rotation.toFixed(0)}`),Ke.MxFun.acutPrintf(`
文字高度:        ${e.textHeight.toFixed(4)}`),Ke.MxFun.acutPrintf(`
附着:        ${Jw(R.McDb.AttachmentPoint[e.attachment])}`),Ke.MxFun.acutPrintf(`
内容:        ${e.contents}`)),e instanceof R.McDbRasterImage){const r=e.imageDefId().getMcDbRasterImageDef(),v=b=>b.split("/").pop().split("\\").pop();Ke.MxFun.acutPrintf(`
图像:                   ${v(r.sourceFileName)}`);const _=b=>{const E=b.clipBoundaryType();if(E===R.McDb.ClipBoundaryType.kInvalid)return"无效";if(E===R.McDb.ClipBoundaryType.kPoly)return"多边形";if(E===R.McDb.ClipBoundaryType.kRect)return"矩形"};Ke.MxFun.acutPrintf(`
剪裁边界类型:      ${_(e)}`);const w=e.clipBoundary();Ke.MxFun.acutPrintf(`
边界点数目: ${w.length()}`),e.clipBoundary().forEach(b=>{Ke.MxFun.acutPrintf(`
       位于点，X=   ${b.x.toFixed(4)}, Y=   ${b.y.toFixed(4)}, Z=   ${b.z.toFixed(4)}`)})}if(e instanceof R.McDbBlockReference&&(Ke.MxFun.acutPrintf(`
块名:               "${e.blockName}"`),Ke.MxFun.acutPrintf(`
插入点:             X= ${e.position.x.toFixed(4)}, Y=   ${e.position.y.toFixed(4)}, Z=   ${e.position.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
X 比例因子:         ${e.scaleFactors.x.toFixed(4)}`),Ke.MxFun.acutPrintf(`
Y 比例因子:         ${e.scaleFactors.y.toFixed(4)}`),Ke.MxFun.acutPrintf(`
  旋转角度:         ${e.rotation.toFixed(0)}`),Ke.MxFun.acutPrintf(`
Z 比例因子:         ${e.scaleFactors.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
Z 比例因子:         ${e.scaleFactors.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
  缩放比例:         ${e.getScale().toFixed(4)}`)),e instanceof R.McDbDimension){Ke.MxFun.acutPrintf(`
文字位置:           X= ${e.textPosition.x.toFixed(4)} Y= ${e.textPosition.y.toFixed(4)} Z= ${e.textPosition.z.toFixed(4)}`),Ke.MxFun.acutPrintf(`
是否使用的默认文字位置:           ${e.isUsingDefaultTextPosition()}`),Ke.MxFun.acutPrintf(`
高度:          ${e.elevation.toFixed(4)}`),Ke.MxFun.acutPrintf(`
文本内容:       ${e.dimensionText}`),Ke.MxFun.acutPrintf(`
文本旋转角度:   ${THREE.MathUtils.radToDeg(e.textRotation).toFixed(0)}`);const r=e.dimensionStyle.getMcDbDimStyleTableRecord();Ke.MxFun.acutPrintf(`
标注样式:       ${r.name}`),Ke.MxFun.acutPrintf(`
文字附着:      ${Jw(R.McDb.AttachmentPoint[e.textAttachment])}`),Ke.MxFun.acutPrintf(`
水平旋转角度:   ${THREE.MathUtils.radToDeg(e.horizontalRotation).toFixed(0)}`),Ke.MxFun.acutPrintf(`
水平旋转角度:   ${THREE.MathUtils.radToDeg(e.horizontalRotation).toFixed(0)}`)}Ke.MxFun.acutPrintf(`
命令`)})}Ke.MxFun.addCommand("group",()=>Pn(this,null,function*(){let e,t="",i="",l;const c=R.MxCpp.getCurrentDatabase(),h=c.GetGroupDictionary();for(;;){const f=yield R.MxCADUtility.userSelect("选择对象",null,(r,v)=>{v.setKeyWords("[名称(N)/说明(D)]"),e=v});if(e.getDetailedResult()===Ke.DetailedResult.kEcsIn||e.getDetailedResult()===Ke.DetailedResult.kCodeAbort||e.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;if(f&&(l=f),e.isKeyWordPicked("N")){for(;;){const r=new R.MxCADUiPrString;r.setMessage("输入编组名"),r.setKeyWords("[查询(A)]");const v=yield r.go();if(r.getDetailedResult()===Ke.DetailedResult.kCodeAbort||r.getDetailedResult()===Ke.DetailedResult.kEcsIn||r.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;if(r.isKeyWordPicked("A")){r.setMessage("请输入要列出的编码组名<*>"),r.setKeyWords("");const b=yield r.go();if(console.log(b),r.getDetailedResult()===Ke.DetailedResult.kCodeAbort||r.getDetailedResult()===Ke.DetailedResult.kEcsIn||r.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;if(b&&b!=="*"){const P=h.getAt(b).getMcDbObject();Ke.MxFun.acutPrintf(`
定义的编组:`),P&&Ke.MxFun.acutPrintf(`
 ${P.name}`)}else if(b==="*"||r.getDetailedResult()===Ke.DetailedResult.kNullEnterIn||r.getDetailedResult()===Ke.DetailedResult.kNullSpaceIn){const E=h.getAllObject();Ke.MxFun.acutPrintf(`
定义的编组:`),E.forEach(P=>{const I=P.getMcDbObject();I&&Ke.MxFun.acutPrintf(`
 ${I.name}`)})}continue}if(!v)return;const _=h.getAt(t);if(_.getMcDbObject()&&_.isValid()){Ke.MxFun.acutPrintf(`编组 ${t} 已经存在`);continue}t=v;break}continue}if(e.isKeyWordPicked("D")){const r=new R.MxCADUiPrString;r.setMessage("输入编组说明");const v=yield r.go();if(!v)return;i=v;continue}if(e.getDetailedResult()===Ke.DetailedResult.kNullEnterIn||e.getDetailedResult()===Ke.DetailedResult.kNullSpaceIn){if(l.some(v=>c.getEntitiesInTheGroup(v).length!==0)){const v=new R.MxCADUiPrKeyWord;v.setMessage("包含相同对象的组已经存在。仍要创建新的组？<N>"),v.setKeyWords("[是(Y)/否(N)]");const _=yield v.go();if((_==null?void 0:_.toLocaleUpperCase())==="N"||!_)return}if(c.CreateGroup(l,t)){const _=h.getAt(t).getMcDbObject();_.description=i}}break}})),Ke.MxFun.addCommand("ungroup",()=>Pn(this,null,function*(){let e;const i=R.MxCpp.getCurrentDatabase().GetGroupDictionary();for(;;){const l=new R.MxCADUiPrEntity;l.setMessage("选择对象"),l.setKeyWords("[名称(N)]");const c=yield l.go();if(l.getDetailedResult()===Ke.DetailedResult.kEcsIn||l.getDetailedResult()===Ke.DetailedResult.kCodeAbort||l.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;if(l.isKeyWordPicked("N")){for(;;){const h=new R.MxCADUiPrString;h.setMessage("输入编组名"),h.setKeyWords("[查询(A)]");const f=yield h.go();if(h.getDetailedResult()===Ke.DetailedResult.kCodeAbort||h.getDetailedResult()===Ke.DetailedResult.kEcsIn||h.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;if(h.isKeyWordPicked("A")){h.setMessage("请输入要列出的编码组名<*>"),h.setKeyWords("");const _=yield h.go();if(h.getDetailedResult()===Ke.DetailedResult.kCodeAbort||h.getDetailedResult()===Ke.DetailedResult.kEcsIn||h.getDetailedResult()===Ke.DetailedResult.kNewCommadIn)return;if(_&&_!=="*"){const b=i.getAt(_).getMcDbObject();Ke.MxFun.acutPrintf(`
定义的编组:`),b&&Ke.MxFun.acutPrintf(`
 ${b.name}`)}else if(_==="*"||h.getDetailedResult()===Ke.DetailedResult.kNullEnterIn||h.getDetailedResult()===Ke.DetailedResult.kNullSpaceIn){const w=i.getAllObject();Ke.MxFun.acutPrintf(`
定义的编组:`),w.forEach(b=>{const E=b.getMcDbObject();E&&Ke.MxFun.acutPrintf(`
 ${E.name}`)})}continue}if(!f)return;const r=i.getAt(e);if(r.getMcDbObject()&&r.isValid()){Ke.MxFun.acutPrintf(`编组 ${e} 已经存在`);continue}e=f;break}continue}if(c){const h=c.getMcDbEntity();if(h){const f=h.getHandle(),r=i.getAllObjectName(),v=r.length();for(let _=0;_<v;_++){const w=r.at(_),E=i.getAt(w).getMcDbObject();if(!E)continue;E.getAllEntityId().some(I=>{const F=I.getMcDbEntity();return(F==null?void 0:F.getHandle())===f?(e=w,!0):!1})}}}if(e){const f=i.getAt(e).getMcDbObject();if(f)f.clear(),i.remove(e),Ke.MxFun.acutPrintf(`
组 ${e} 已分解`);else{Ke.MxFun.acutPrintf(`
对象不是组成员`);continue}}else{Ke.MxFun.acutPrintf(`
对象不是组成员`);continue}break}}));const pF=`///////////////////////////////////////////////////////////////////////////////
//版权所有（C）2002-2022，成都梦想凯德科技有限公司。
//本软件代码及其文档和相关资料归成都梦想凯德科技有限公司,应用包含本软件的程序必须包括以下版权声明
//此应用程序应与成都梦想凯德科技有限公司达成协议，使用本软件、其文档或相关材料
//https://www.mxdraw.com/
///////////////////////////////////////////////////////////////////////////////

import { McDbEntity, McDbLine, McDbPoint, McDbPolyline, MxCADUiPrPoint, MxCADUtility, MxCpp, McGePoint3d, McDbArc, McDbCircle, McDbEllipse, McGeVector3d, McDbHatch, McDbText, McDbMText, McDb, McDbRasterImageDef, McDbRasterImage, McDbBlockReference, McDbDimension } from "mxcad";
import { DetailedResult, DynamicInputType, MxDbRegularPolygonShape, MxFun } from "mxdraw";
function calculateCenter(start: McGePoint3d, end: McGePoint3d, bulge: number) {
  const dist = start.distanceTo(end)
  const dx = dist / 2
  const dy = dx * bulge
  const r = (dx * dx + dy * dy) / (2 * dy)
  const midX = (start.x + end.x) / 2
  const midY = (start.y + end.y) / 2

  return new McGePoint3d(midX, midY).addvec(end.clone().sub(start).perpVector().normalize().mult(r - dy))
}
function calculateLineAngle(center: McGePoint3d, start: McGePoint3d, end: McGePoint3d) {
  const deg = (Math.PI * 2) / 360
  // 计算直线的角度
  let startAngle = ((Math.atan2(start.y - center.y, start.x - center.x) * 180) / Math.PI) * deg
  let endAngle = ((Math.atan2(end.y - center.y, end.x - center.x) * 180) / Math.PI) * deg

  return {
    startAngle,
    endAngle
  }
}
MxFun.addCommand("list", async () => {
  // 选择对象获取信息
  const objIds = await MxCADUtility.userSelect("选择对象")
  const getPoint = new MxCADUiPrPoint()
  MxFun.acutPrintf("找到" + objIds.length + "个\\n")
  const objId = objIds.pop()
  if (!objId) return
  const ent = objId.getMcDbEntity()
  if (!objId.isValid() || !ent) {
    MxFun.acutPrintf("对象无效\\n")
  } else {
    if (await printInfo(ent) === false) return
  }
  while (objIds.length) {
    getPoint.setMessage("按 ENTER 键继续")
    getPoint.setDisableDynInput(true)
    await getPoint.go()
    // 程序中止、按下Esc键、新的命令运行时退出
    if (getPoint.getDetailedResult() === DetailedResult.kCodeAbort) return
    if (getPoint.getDetailedResult() === DetailedResult.kEcsIn) return
    if (getPoint.getDetailedResult() === DetailedResult.kNewCommadIn) return
    const objId = objIds.pop()
    if (!objId) break;
    const ent = objId.getMcDbEntity()
    if (!objId.isValid() || !ent) {
      MxFun.acutPrintf("对象无效\\n")
      continue
    }
    if (await printInfo(ent) === false) return
  }
})
// 记录对象的名称
const entNames = {
  "McDbPoint": "点",
  "McDbLine": "直线",
  "McDbPolyline": "多段线",
  "McDbArc": "圆弧",
  "McDbCircle": "圆",
  "McDbEllipse": "椭圆",
  "McDbHatch": "填充",
  "McDbText": "单行文本",
  "McDbMText": "多行文本",
  "McDbRasterImage": "光栅图片",
  "McDbBlockReference": "块参照",
}
// 附着名称字典
const map = {
  Top: "上",
  Middle: "中",
  Bottom: "下",
  Base: "基",
  Left: "左",
  Center: "中",
  Right: "右",
  Align: "对齐",
  Fit: "适应",
  Mid: "中"
};

// 获取文字的附着名称
const getAttachmentName = (str: string) => {
  return str.replace(/k(\\w+)/g, function (_, p1) {
    let key = p1.replace(/([A-Z])/g, "-$1") as string
    const arr = key.split("-")
    const name = arr.reduce((name, key) => {
      if (map[key]) {
        return name + map[key];
      } else {
        return "";
      }
    })
    return name
  });
}
// 打印信息
async function printInfo(ent: McDbEntity) {
  // 得到所有对象的基本信息
  const layer = ent.layer
  const layoutBlockName = MxCpp.getCurrentDatabase().currentSpace.name
  const isMainModel = layoutBlockName === "*Model_Space"
  const modeName = isMainModel ? "模型空间" : "图纸空间"
  const handle = ent.getHandle()
  console.log(ent.objectName)

  let entName = entNames[ent.objectName] || ent.objectName
  if(ent instanceof McDbDimension) {
    entName = "标注"
  }
  MxFun.acutPrintf(\`\\n                  \${entName}        图层: "\${layer}"\`)
  MxFun.acutPrintf(\`\\n                           空间: "\${modeName}"\`)

  MxFun.acutPrintf(\`\\n                    句柄 = \${handle}\`)
  // 点对象的信息
  if (ent instanceof McDbPoint) {
    MxFun.acutPrintf(\`\\n                 于 点， X= \${ent.position.x.toFixed(4)}  Y= \${ent.position.y.toFixed(4)}  Z= \${ent.position.z.toFixed(4)}\`)
  }
  // 直线对象的信息
  if (ent instanceof McDbLine) {
    MxFun.acutPrintf(\`\\n                 自 点， X= \${ent.startPoint.x.toFixed(4)}  Y= \${ent.startPoint.y.toFixed(4)}  Z= \${ent.startPoint.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                 到 点， X= \${ent.startPoint.x.toFixed(4)}  Y= \${ent.startPoint.y.toFixed(4)}  Z= \${ent.startPoint.z.toFixed(4)}\`)
    let deltaX = ent.endPoint.x - ent.startPoint.x;
    let deltaY = ent.endPoint.y - ent.startPoint.y;
    let deltaZ = ent.endPoint.z - ent.startPoint.z;

    // 使用atan2计算角度，结果是弧度，转换为度
    let angleInDegrees = THREE.MathUtils.radToDeg(Math.atan2(deltaY, deltaX));

    MxFun.acutPrintf(\`\\n          长度 = \${ent.getLength().val.toFixed(4)}，在 XY 平面中的角度 = \${Math.floor(angleInDegrees)}\`)
    MxFun.acutPrintf(\`\\n                  增量 X =  \${deltaX.toFixed(4)}，增量 Y =   \${deltaY.toFixed(4)}，增量 Z =   \${deltaZ.toFixed(4)}\`)
  }

  // 多段线对象的信息
  if (ent instanceof McDbPolyline) {
    MxFun.acutPrintf(\`\\n            \${ent.isClosed ? "闭合" : "打开"}\`)
    MxFun.acutPrintf(\`\\n        固定宽度    \${ent.constantWidth.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n            面积   \${ent.getArea().val.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n         周长   \${ent.getLength().val.toFixed(4)}\`)

    // 输出多段线的每个点的信息
    const num = ent.numVerts()
    // 通过取点对象控制输出量 只有在按下空格或者回车才会继续打印剩余信息
    const getPoint = new MxCADUiPrPoint()

    // 记录点包含的其他信息如线宽、凸度值等
    const widthInfos: {
      val1: number;
      val2: number;
      ret: boolean;
    }[] = []
    const bulges: number[] = []
    // 记录是否打印线宽
    let isPrintWidth = false

    for (let index = 0; index < num; index++) {
      const width = ent.getWidthsAt(index)
      const bulge = ent.getBulgeAt(index)
      if (width.val1 !== 0 || width.val2 !== 0) {
        isPrintWidth = true
      }
      widthInfos.push(width)
      bulges.push(bulge)
    }
    // 控制输出打印量
    let accumulated = 0
    const maxIndex = 3

    for (let index = 0; index < num; index++) {
      if (accumulated > maxIndex) {
        while (true) {
          getPoint.setMessage("按 ENTER 键继续")
          getPoint.disableAllTrace()
          getPoint.clearLastInputPoint()
          // 设置不需要动态的输入框
          getPoint.setDynamicInputType(DynamicInputType.kNoInput)
          const pt = await getPoint.go()
          if (getPoint.getDetailedResult() === DetailedResult.kCodeAbort) return
          if (getPoint.getDetailedResult() === DetailedResult.kEcsIn) return
          if (getPoint.getDetailedResult() === DetailedResult.kNewCommadIn) return false
          // 只有回车和空格或者鼠标左键点击才能继续往下走打印的流程， 否则始终循环等待用户输入
          if (getPoint.getDetailedResult() === DetailedResult.kNullEnterIn || getPoint.getDetailedResult() === DetailedResult.kNullSpaceIn || pt) {
            accumulated = 0
            break;
          }
        }
      }
      const point = ent.getPointAt(index).val
      const bulge = bulges[index]

      MxFun.acutPrintf(\`\\n          于端点  X=  \${point.x.toFixed(1)}  Y=  \${point.y.toFixed(1)}  Z=  \${point.z.toFixed(1)}\`)
      if (isPrintWidth) {
        MxFun.acutPrintf(\`\\n    起点宽度  \${widthInfos[index].val1.toFixed(4)}\`)
        MxFun.acutPrintf(\`\\n      端点宽度  \${widthInfos[index].val2.toFixed(4)}\`)
      }
      // 凸度不为0时 且
      if (Math.abs(bulge) > 0) {
        MxFun.acutPrintf(\`\\n             凸度       \${bulge.toFixed(1)}\`)
        const nextPoint = ent.getPointAt(index + 1).val
        const center = calculateCenter(point, nextPoint, bulge)
        MxFun.acutPrintf(\`\\n            圆心  X=  \${center.x.toFixed(1)}  Y=  \${center.y.toFixed(1)}  Z=  \${center.z.toFixed(1)}\`)
        MxFun.acutPrintf(\`\\n            半径    \${center.distanceTo(point).toFixed(1)}\`)
        const { startAngle, endAngle } = calculateLineAngle(center, point, nextPoint)
        MxFun.acutPrintf(\`\\n       起点角度       \${THREE.MathUtils.radToDeg(startAngle).toFixed(0)}\`)
        MxFun.acutPrintf(\`\\n       端点角度       \${THREE.MathUtils.radToDeg(endAngle).toFixed(0)}\`)
        // 最后一次循环加上最后一个端点信息
        if (index === num - 1) {
          MxFun.acutPrintf(\`\\n          于端点  X=  \${nextPoint.x.toFixed(1)}  Y=  \${nextPoint.y.toFixed(1)}  Z=  \${nextPoint.z.toFixed(1)}\`)
        }
      }
      accumulated++
    }
  }
  // 圆弧的信息
  if (ent instanceof McDbArc) {
    MxFun.acutPrintf(\`\\n                圆心 点， X= \${ent.center.x.toFixed(4)}  Y= \${ent.center.y.toFixed(4)}  Z= \${ent.center.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                半径  \${ent.radius.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                起点 角度    \${THREE.MathUtils.radToDeg(ent.startAngle).toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n                端点 角度    \${THREE.MathUtils.radToDeg(ent.endAngle).toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n            长度 \${ent.getLength().val.toFixed(4)}\`)
  }
  // 圆的信息
  if (ent instanceof McDbCircle) {
    MxFun.acutPrintf(\`\\n                圆心 点， X= \${ent.center.x.toFixed(4)}  Y= \${ent.center.y.toFixed(4)}  Z= \${ent.center.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                半径  \${ent.radius.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                周长 \${ent.getLength().val.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                面积 \${(Math.PI * ent.radius * ent.radius).toFixed(4)}\`)
  }

  // 椭圆的信息
  if (ent instanceof McDbEllipse) {
    // 得到椭圆的半轴长度
    const radius1 = ent.majorAxis.length()
    const radius2 = ent.minorAxis.length()
    // 是否是椭圆 为false表示是椭圆弧
    const isEllipse = ent.startAngle === 0 && ent.endAngle === 2 * Math.PI
    if (isEllipse) {
      const calculateEllipseCircumference = (radius1: number, radius2: number) => {
        const h = Math.pow((radius1 - radius2), 2) / Math.pow((radius1 + radius2), radius2);
        const circumference = Math.PI * (radius1 + radius2) * (1 + (3 * h) / (10 + Math.sqrt(4 - 3 * h)));
        return circumference;
      }
      MxFun.acutPrintf(\`\\n                               面积: \${(Math.PI * radius1 * radius2).toFixed(4)}\`)
      MxFun.acutPrintf(\`\\n                               圆周: \${calculateEllipseCircumference(radius1, radius2).toFixed(4)}\`)
    }
    else {
      // 计算椭圆弧的长度
      const arcLengthOfEllipse = (a: number, b: number, theta1: number, theta2: number, numSteps: number) => {
        // a: 长半轴
        // b: 短半轴
        // 定义被积函数
        const integrand = function (theta: number) {
          return Math.sqrt(a * a * Math.sin(theta) * Math.sin(theta) + b * b * Math.cos(theta) * Math.cos(theta));
        };

        // 使用复合辛普森法则进行数值积分
        let integral = 0;
        const stepSize = (theta2 - theta1) / numSteps;
        for (let i = 0; i <= numSteps; i++) {
          const theta = theta1 + i * stepSize;
          if (i === 0 || i === numSteps) {
            integral += integrand(theta);
          } else if (i % 2 === 0) {
            integral += 2 * integrand(theta);
          } else {
            integral += 4 * integrand(theta);
          }
        }

        integral *= stepSize / 3;
        return Math.abs(integral);
      }

      MxFun.acutPrintf(\`\\n                               长度: \${arcLengthOfEllipse(radius1, radius2, ent.startAngle, ent.endAngle, 30).toFixed(4)}\`)
    }
    MxFun.acutPrintf(\`\\n                              中心点: X = \${ent.center.x.toFixed(4)} , Y = \${ent.center.y.toFixed(4)}   , Z = \${ent.center.z.toFixed(4)}\`)
    // 判断哪个是半轴长度较长的轴
    const isMaxAxis = radius1 > radius2
    const maxAxis = isMaxAxis ? ent.majorAxis : ent.minorAxis
    const minAxis = isMaxAxis ? ent.minorAxis : ent.majorAxis
    MxFun.acutPrintf(\`\\n                               长轴: X = \${maxAxis.x.toFixed(4)}  , Y = \${maxAxis.y.toFixed(4)}  , Z = \${maxAxis.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                               短轴: X = \${minAxis.x.toFixed(4)}  , Y = \${minAxis.y.toFixed(4)}  , Z = \${minAxis.z.toFixed(4)}\`)
    // 椭圆弧的其他信息
    if (!isEllipse) {
      // 计算椭圆弧的起点和端点
      const calculateEllipseEndpoints = (center: McGePoint3d, v1: McGeVector3d, v2: McGeVector3d, theta1: number, theta2: number) => {
        // 椭圆中心坐标
        const cx = center.x;
        const cy = center.y;

        // 主轴向量
        const vx1 = v1.x;
        const vy1 = v1.y;

        //  副轴向量
        const vx2 = v2.x;
        const vy2 = v2.y;

        // 计算椭圆的起始点和结束点
        const alpha = Math.atan2(vy1, vx1)

        const a = Math.sqrt(vx1 * vx1 + vy1 * vy1);  // 长轴半径
        const b = Math.sqrt(vx2 * vx2 + vy2 * vy2);  // 短轴半径
        // 根据角度计算起始点和结束点
        const startEndpointX = cx + a * Math.cos(theta1) * Math.cos(alpha) - b * Math.sin(theta1) * Math.sin(alpha);
        const startEndpointY = cy + a * Math.cos(theta1) * Math.sin(alpha) + b * Math.sin(theta1) * Math.cos(alpha);
        const endEndpointX = cx + a * Math.cos(theta2) * Math.cos(alpha) - b * Math.sin(theta2) * Math.sin(alpha);
        const endEndpointY = cy + a * Math.cos(theta2) * Math.sin(alpha) + b * Math.sin(theta2) * Math.cos(alpha);

        return {
          startPoint: new McGePoint3d(startEndpointX, startEndpointY),
          endPoint: new McGePoint3d(endEndpointX, endEndpointY)
        };
      }

      const { startPoint, endPoint } = calculateEllipseEndpoints(ent.center, ent.majorAxis, ent.minorAxis, ent.startAngle, ent.endAngle)
      MxFun.acutPrintf(\`\\n                               起点: X = \${startPoint.x.toFixed(4)} , Y = \${startPoint.y.toFixed(4)}  , Z = \${startPoint.z.toFixed(4)}\`)
      MxFun.acutPrintf(\`\\n                               端点: X = \${endPoint.x.toFixed(4)} , Y = \${endPoint.y.toFixed(4)}  , Z = \${endPoint.z.toFixed(4)}\`)
      MxFun.acutPrintf(\`\\n                             起点角度: \${THREE.MathUtils.radToDeg(ent.startAngle).toFixed(0)}\`)
      MxFun.acutPrintf(\`\\n                             端点角度: \${THREE.MathUtils.radToDeg(ent.endAngle).toFixed(0)}\`)
    }
    MxFun.acutPrintf(\`\\n                             半径比例: \${ent.radiusRatio.toFixed(4)}\`)
  }

  // 填充对象信息
  if(ent instanceof McDbHatch) {
    const patternName =  ent.patternName()
    MxFun.acutPrintf(\`\\n                 填充图案 \${patternName}\`)
    MxFun.acutPrintf(\`\\n                 图案填充比例    \${ent.patternScale.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                 图案填充角度      \${THREE.MathUtils.radToDeg(ent.patternAngle).toFixed(0)}\`)
    const pl = new McDbPolyline()
    const pls: McDbPolyline[] = []
    pl.isClosed = true
    for (let index = 0; index < ent.numLoops; index++) {
      const { vertices, bulges } = ent.getLoopAt(index)
      vertices.forEach((pt, index)=> {
        const bulge = bulges[index]
        pl.addVertexAt(pt, Number(bulge.toFixed(14)))
      })
      pls.push(pl)
      MxCpp.getCurrentMxCAD().drawEntity(pl)
    }
    const totalArea = pls.reduce((totalArea, pl)=> totalArea + pl.getArea().val, 0)
    MxFun.acutPrintf(\`\\n                 面积      \${totalArea.toFixed(4)}\`)
  }

  // 单行文字信息
  if(ent instanceof McDbText) {
    MxFun.acutPrintf(\`\\n              样式 = "\${ent.textStyle}"\`)
    MxFun.acutPrintf(\`\\n                起点 点， X=  \${ent.position.x.toFixed(4)}  Y= \${ent.position.y.toFixed(4)}  Z=   \${ent.position.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                高度    \${ent.height.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n                文字 \${ent.textString}\`)
    MxFun.acutPrintf(\`\\n                旋转 角度    \${ent.rotation.toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n                宽度 比例因子    \${ent.widthFactor.toFixed(4)}\`)
  }
  // 多行文字信息
  if(ent instanceof McDbMText) {
    MxFun.acutPrintf(\`\\n              样式 = "\${ent.textStyle}"\`)
    MxFun.acutPrintf(\`\\n位置:         X=  \${ent.location.x.toFixed(4)}  Y=   \${ent.location.y.toFixed(4)}  Z=   \${ent.location.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n宽度:           \${ent.width.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n法向:         X=   \${ent.normal.x.toFixed(4)}  Y=   \${ent.normal.y.toFixed(4)}  Z=   \${ent.normal.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n旋转:                 \${ent.rotation.toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n文字高度:        \${ent.textHeight.toFixed(4)}\`)

    MxFun.acutPrintf(\`\\n附着:        \${getAttachmentName(McDb.AttachmentPoint[ent.attachment])}\`)
    MxFun.acutPrintf(\`\\n内容:        \${ent.contents}\`)
  }
  // 光栅图片信息
  if(ent instanceof McDbRasterImage) {
    const imgDef = ent.imageDefId().getMcDbRasterImageDef()
    const getFileNameFromPath = (path: string)=> {
      return path.split('/').pop().split('\\\\').pop();
    }
    MxFun.acutPrintf(\`\\n图像:                   \${getFileNameFromPath(imgDef.sourceFileName)}\`)

    const getClipBoundaryType = (ent: McDbRasterImage)=> {
      const type = ent.clipBoundaryType()
      if(type === McDb.ClipBoundaryType.kInvalid) return "无效"
      if(type === McDb.ClipBoundaryType.kPoly) return "多边形"
      if(type === McDb.ClipBoundaryType.kRect) return "矩形"
    }
    MxFun.acutPrintf(\`\\n剪裁边界类型:      \${getClipBoundaryType(ent)}\`)
    const clipBoundary =  ent.clipBoundary()
    MxFun.acutPrintf(\`\\n边界点数目: \${clipBoundary.length()}\`)
    ent.clipBoundary().forEach((pt)=> {
      MxFun.acutPrintf(\`\\n       位于点，X=   \${pt.x.toFixed(4)}, Y=   \${pt.y.toFixed(4)}, Z=   \${pt.z.toFixed(4)}\`)
    })
  }

  // 图块信息
  if(ent instanceof McDbBlockReference) {
    MxFun.acutPrintf(\`\\n块名:               "\${ent.blockName}"\`)
    MxFun.acutPrintf(\`\\n插入点:             X= \${ent.position.x.toFixed(4)}, Y=   \${ent.position.y.toFixed(4)}, Z=   \${ent.position.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\nX 比例因子:         \${ent.scaleFactors.x.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\nY 比例因子:         \${ent.scaleFactors.y.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n  旋转角度:         \${ent.rotation.toFixed(0)}\`)
    MxFun.acutPrintf(\`\\nZ 比例因子:         \${ent.scaleFactors.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\nZ 比例因子:         \${ent.scaleFactors.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n  缩放比例:         \${ent.getScale().toFixed(4)}\`)
  }

  // 标注信息
  if(ent instanceof McDbDimension) {
    MxFun.acutPrintf(\`\\n文字位置:           X= \${ent.textPosition.x.toFixed(4)} Y= \${ent.textPosition.y.toFixed(4)} Z= \${ent.textPosition.z.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n是否使用的默认文字位置:           \${ent.isUsingDefaultTextPosition()}\`)
    MxFun.acutPrintf(\`\\n高度:          \${ent.elevation.toFixed(4)}\`)
    MxFun.acutPrintf(\`\\n文本内容:       \${ent.dimensionText}\`)
    MxFun.acutPrintf(\`\\n文本旋转角度:   \${THREE.MathUtils.radToDeg(ent.textRotation).toFixed(0)}\`)
    const dimStyle = ent.dimensionStyle.getMcDbDimStyleTableRecord()
    MxFun.acutPrintf(\`\\n标注样式:       \${dimStyle.name}\`)
    MxFun.acutPrintf(\`\\n文字附着:      \${getAttachmentName(McDb.AttachmentPoint[ent.textAttachment])}\`)
    MxFun.acutPrintf(\`\\n水平旋转角度:   \${THREE.MathUtils.radToDeg(ent.horizontalRotation).toFixed(0)}\`)
    MxFun.acutPrintf(\`\\n水平旋转角度:   \${THREE.MathUtils.radToDeg(ent.horizontalRotation).toFixed(0)}\`)
  }
  MxFun.acutPrintf("\\n命令")
}

`;function fF(e){return e.replace(/[\u00A0\u1680\u2000-\u200D\u202F\u205F\u3000]/g," ")}const $w=e=>{const t=/\/\/{24}[\s\S]*\/\/{24}/g;let i=e.replace(t,"");return i=fF(i),i};(e=>{e.forEach(t=>{t.code=$w(t.code)}),e.push({type:"命令实现",name:"list 命令",code:$w(pF)})})(Kw);let Ls;class mF extends R.MxCADPluginBase{constructor(){super(),Ls&&Ls.isMxCADAppLib()||(this.map_default_data=tP()),this.sampleCode=Kw}}Ah(),MxPluginContext.on("databaseLayerUpdate",()=>{console.log("数据库图层数据更新")}),Ke.MxFun.setloadImageFuction((e,t,i)=>e.slice(-4)=="tiff"||e.slice(-3)=="tif"?(new R.MxTIFFLoader().load(e,t,i),1):0),Ke.MxFun.onInitSync(()=>new Promise(e=>{e(!0)})),Ke.MxFun.on("mxcadApplicationStart",e=>{Ls=e,Ls.init(new mF)}),Ke.MxFun.on("mxcadApplicationInitMap",()=>{nP(Ls.mxmap)}),Ke.MxFun.on("mxcadApplicationStartCreatingMxCADObject",e=>{let t=e.mxdraw;t.setViewMovementMethod(!0),t.on("openFileComplete",()=>{console.log("MxTip:openFileComplete ")}),t.addControlsEvent("mousedown",i=>{let l=i.offsetX,c=i.offsetY,h=t.viewCoord2Cad(l,c,0);return console.log("mousedown:",h),0})});const gF=e=>{let t,i;R.MxCpp.getCurrentMxCAD().on("selectChange",l=>{var h;if(l.length===0)return;const c=(h=l[0])==null?void 0:h.getMcDbEntity();if(c&&c instanceof R.McDbCustomEntity&&(t==null?void 0:t.getHandle())===c.getHandle()){const f=c.getTypeName();Bo.value=c.clone(),f==="McDbTestRoughness"?(ra.value="RoughnessDialog",To.showDialog(!0,{title:at("表面粗糙度")}).then(_=>Pn(this,[_],function*({data:r,isCanceled:v}){var w;if(!v){const b=r.roughnessData,E=c.clone();E.rougMarkType=b.selectSymbolNum,E.textLeftStr=b.textLeftStr,E.rougCornerType=b.rougCornerType==="无"?"":b.rougCornerType,E.isRoungSameRequire=b.isRoungSameRequire,E.isShowMostSymbols=b.isShowMostSymbols;const P=(w=b.textUpStr)==null?void 0:w.filter(I=>I!="");E.textUpStr=JSON.parse(JSON.stringify(P)).reverse(),E.textDownStr=b.textDownStr.filter(I=>I!=""),E.isAddRougLongLine=b.isAddLongLine,c.erase(),e.drawEntity(E),e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()}}))):f==="McDbTestWeldingSymbol"?(ra.value="WeldingSymbolDialog",To.showDialog(!0,{title:at("焊接符号")}).then(_=>Pn(this,[_],function*({data:r,isCanceled:v}){if(!v){const w=r.formData,b=c;if(w.specialSymbol.length&&b.setSpecialSymbol(w.specialSymbol),w.rightDim1||w.rightDim2){const E=[ii.top,ii.down],P=[];E.forEach(I=>{const F=w.rightDim1.filter(W=>W.position===I)[0],B=w.rightDim2.filter(W=>W.position===I)[0],O=F.content&&B.content?"×":"";P.push({position:I,content:F.content+O+B.content})}),b.setRightDim(P)}b.setSuppleSymbol(w.suppleSymbol),b.setLeftDim(w.leftDim),b.setTopDim(w.topDim),b.setAuxiliarySymbol(w.auxiliarySymbol),b.setBaseSymbok(w.basicSymbol),b.setIntWeldSeam(w.intWeldSeam),b.dottedLinePos=w.dottedLinePos,b.weldingSymbolInfo=w.weldingSymbolInfo.replace(/\n/g,"\\P"),c.erase(),e.drawEntity(b),e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()}}))):f==="MxDbGeometricTolerances"&&(ra.value="GemoetricToleranceDialog",To.showDialog(!0,{title:at("形位公差")}).then(_=>Pn(this,[_],function*({data:r,isCanceled:v}){if(!v){const w=r.formData,b=c;b.dimToleranceContents=(w==null?void 0:w.dimToleranceContents)||[],b.isShowFullWeekSymbol=(w==null?void 0:w.isShowFull)||!1,b.dimNotesDown=(w==null?void 0:w.downDim)||"",b.dimNotesUp=(w==null?void 0:w.topDim)||"",c.erase(),e.drawEntity(b),e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()}})))}t=c,i&&clearTimeout(i),i=setTimeout(()=>{t=null},300)})};Ke.MxFun.on("mxcadApplicationCreatedMxCADObject",e=>{if(EF(),gF(e.mxcad),Ls.isMxCADAppLib())return;let t=Ls.getServerConfig();R.MxCpp.App.addNetworkLoadingFont(t.font||["txt.shx","simplex.shx","gdt.shx","aaa.shx","ltypeshp.shx","complex.shx"]),R.MxCpp.App.addNetworkLoadingBigFont(t.bigFont||["hztxt.shx","gbcbig.shx"]),t.trueTypeFont?R.MxCpp.App.addNetworkLoadingTrueTypeFont(t.trueTypeFont[0],t.trueTypeFont[1],t.trueTypeFont[2]):R.MxCpp.App.addNetworkLoadingTrueTypeFont(["syadobe"],["思原黑体"],["syadobe.otf"]);let i=e.mxcad;i.setAttribute({DisplayPrecision:35}),i.on("selectChange",l=>{if(console.log("selectChange"),l.length==0)return;let c=l[0],h=c.getMxDbEntity();if(h!==null){console.log(h.getTypeName()),h instanceof Ke.MxDbRectBoxLeadComment&&console.log(h.text);return}let f=c.getMcDbEntity();f!==null&&(console.log(f.objectName),f instanceof R.McDbText?console.log(f.textString):f instanceof R.McDbBlockReference&&f.getAllAttribute().forEach(_=>{let w=_.getMcDbEntity();console.log(w.textString),console.log(w.tag)}))}),R.MxCpp.PropertiesWindow.onEvent_getProperties(l=>{let c=l.getMcDbEntity();if(!c)return[];let h=c.getxDataDouble("DN"),f=c.getxDataDouble("LEN"),r=[];return h.ret&&r.push({sVarName:"DN",iVarType:R.MxPropertiesWindowCustomValueType.kDouble,val:h.val,isOnlyRead:!1}),f.ret&&r.push({sVarName:"LEN",iVarType:R.MxPropertiesWindowCustomValueType.kDouble,val:f.val,isOnlyRead:!1}),r}),R.MxCpp.PropertiesWindow.onEvent_setProperties((l,c)=>{let h=l.getMcDbEntity();h&&(c.sVarName=="DN"?h.setxDataDouble("DN",c.val):c.sVarName=="LEN"&&h.setxDataDouble("LEN",c.val))})});function yF(){window.open("https://demo.mxdraw3d.com:3562/MxCADCode.7z")}function xF(){window.open("https://demo.mxdraw3d.com:3562/MxDrawCloudServer1.0TryVersion.7z")}function Su(e){var t=window.location.href;return t.indexOf("?")!=-1&&(t=t.replace(/(\?|#)[^'"]*/,"")),`${t}?map=true&maptype=${e}`}function vF(){window.open(Su("gdslwzj"))}function _F(){window.open(Su("google"))}function bF(){window.open(Su("gdyx"))}function wF(){window.open(Su("tdtsl"))}function AF(){window.open(Su("bdsl"))}function MF(){window.open(Su("geoq"))}function SF(){return Pn(this,null,function*(){})}function TF(){return Pn(this,null,function*(){const e=new R.MxCADUiPrPoint;e.setMessage(at(" 指定一点:"));let t=yield e.go();if(!t)return;const i=new R.MxCADUiPrAngle;i.setMessage(at("指定夹角")),i.setKeyWords(""),i.setBasePt(t);const l=yield i.go();console.log(l)})}function EF(){Ke.MxFun.addCommand("Mx_Open_DemoCode",yF),Ke.MxFun.addCommand("Mx_Open_DevInstall",xF),Ke.MxFun.addCommand("Mx_Open_Map_gdslwzj",vF),Ke.MxFun.addCommand("Mx_Open_Map_gdyx",bF),Ke.MxFun.addCommand("Mx_Open_Map_tdtsl",wF),Ke.MxFun.addCommand("Mx_Open_Map_bdsl",AF),Ke.MxFun.addCommand("Mx_Open_Map_geoq",MF),Ke.MxFun.addCommand("Mx_Open_Map_googlecn",_F),Ke.MxFun.addCommand("Mx_Test_GetFile",SF),Ke.MxFun.addCommand("MxTest_Map_Download",iP),Ke.MxFun.addCommand("MxTemp_Test",TF),W3(),z2(),G2(),Ls.mxmap&&P4(Ke.MxFun.getCurrentDraw())}const PF=Object.freeze(Object.defineProperty({__proto__:null,default:{718:"Specify the first point of the output range:",719:"Specify the second point of the output range:",720:"Specify the first point:",721:"Specify the second point:",722:"Cloud wireframe starting point:",723:"End point of cloud wireframe:",724:"Drawing review annotation points:",725:"Click to start drawing cloud lines:",726:"Click to end drawing cloud lines again:",727:"Specify one point:",728:"Specify two points:",729:"Select object",730:"Specify the next point:",731:"\\Specify insertion base point",732:"Specify table insertion point:",733:"Specify insertion point:",734:"Specify insertion base point",735:"Select annotation object",736:"Please select the target text",737:"Specify a point inside the filling area:",738:"No closed area found",739:"Surface roughness",740:"Welding symbol",741:"Positional tolerance",742:"Select the object that needs to enable custom properties",743:"Select the object to hide",744:"Specify insertion point:",745:"Specify one point:",746:"Specify the angle",747:"Specify two points:",748:"Select pattern fill object",749:"Specify the first point:",750:"Specify the second point:",751:"Specify the second angle point:",752:"Specify the last point:",753:"Specify coordinate point:",754:"Specify annotation points:",755:"Please provide your approval comments",756:"Specify the starting point of the cloud wireframe",757:"Specify the termination point of the cloud wireframe",758:"Designated review icon annotation points",759:"Specify the first corner point:",760:"Specify the second corner point:",761:"Specify serial number location:",762:"Rotations Symbols",763:"Tag type",764:"Please select the circle to be marked:",765:"Please set positioning points, lines, arcs, or circles",766:"Drag to determine the annotation position",767:"Please specify or enter an angle",768:"weld symbol",769:"Please pick a positioning point, line, or arc",770:"Please specify the second point",771:"Please set the positioning point",772:"Please set the angle",773:"Please set positioning points, lines, or arcs",774:"Please set the lead turning point",775:"Drag to determine the positioning point",776:"Please specify the first point:",777:"Please specify the second point:",778:"Please select the target block object",779:"Please enter a new block name",780:"Select the block that needs to modify the base point",781:"Set base point",782:"Select the block that requires color modification",783:"Enter color index (0~256)",784:"Please select the source block",785:"Select the target block to brush:",786:"Select connection method",787:"Manually connect each line one by one",788:"Automatic batch connection",789:"Please select the block for the connection",790:"Set centerline length",791:"Select the target block to rotate:",792:"Set rotation angle",793:"Please set the zoom ratio",794:"Please set the selection range:",795:"Please select the target block",796:"Please set the statistical scope",797:"Specify table insertion point:",798:"Select target curve",799:"Specify the length annotation point",800:"Select Target Object",801:"Please select the target slope object",802:"Please set the height of the annotation text",803:"Specify slope annotation point",804:"Please select the target coordinate point",805:"Please specify the annotation location",806:"Specify start point",807:"Specify the endpoint",808:"Specify annotation direction",809:"Please set the text content",810:"Please select the first point of the area",811:"Please select the next point",812:"Please select the location for area annotation",813:"Please select corner 1 of the rectangle",814:"Please select corner 2 of the rectangle",815:"Please set the location for area annotation",816:"Please select a measurement point",817:"Please select a straight line",818:"Please set the position of the dimension line",819:"Please select an arc",820:"Please specify the position of the dimension line",821:"Please select a circular object",822:"Please specify the text location",823:"Please select the endpoint or arc of the line",824:"Please specify the position of the text",825:"Please select a continuous measurement label",826:"Please select the second straight line",827:"Please set the position for angle annotation",828:"Please enter the number of star shaped vertices:",829:"Specify the star center point:",830:"Please set the inner radius of the star shape:",831:"Specify the outer radius of the star shape:",832:"Please enter the width of the concave convex line<5>",833:"Please enter the height of the concave convex line as<10>",834:"Please click to confirm the starting point",835:"Please click to confirm the endpoint",836:"Please enter zigzag width<5>",837:"Please enter zigzag line height<10>",838:"Please enter rectangle width<5>",839:"Please enter rectangle height<10>",840:"Please click to confirm the center of the rectangle",841:"Please enter pipe diameter<10>",842:"Please enter the length of the outlet pipe<5>",843:"Please click to confirm the starting point",844:"Specify the starting point of the pipeline section",845:"Specify the endpoint of the sectional pipeline",846:"Select the direction of the pipeline arc",847:"the left",848:"the right side",849:"MODE",850:"straight bead",851:"Arc weld seam",852:"Please enter weld radius<5>",853:"Specify the second point of the arc",854:"Specify end point of arc",855:"Please enter width<25>",856:"Please enter height<15>",857:"Please enter staircase level<10>",858:"Please confirm the center position of the circle",859:"Please enter the radius of the circle",860:"Please enter insulation cotton width<5>",861:"Please enter insulation cotton height<10>",862:"Please click on the next point",863:"Please select the first line",864:"Please select the second line",865:"Please select the endpoint",866:"Please select the target rectangle",867:"Set the center point of the compass",868:"Set the radius of the compass",869:"Select prompt box pointing",870:"Specify the first point of the message box:",871:"Specify the second point of the message box:",872:"Set the message box to point to:",873:"Please set the reference character text",874:"Please set the text height",875:"Please set the benchmark position",876:"Please set positioning points, arcs, or lines",877:"Please set the symbol position",878:"Please set the center of the circle",879:"Please set the center of the gear circle",880:"Please set the gear radius",881:"Please set the centerline length to 10>",882:"Please select the first circle",883:"Please select the second circle",884:"Please set the top left corner point of the rectangle",885:"Please set the bottom right corner point of the rectangle",886:"Please set the fillet radius",887:"Please select the starting point of the polygon",888:"Please select polygon vertices",889:"Select object:",890:"Specify base point",891:"Specify the second point",892:"array",893:"exit",894:"give up",895:"Enter the number of items to be arranged in the array",896:"Select arc object",897:"Choose to copy rotated objects:",898:"Please specify the target point",899:"Please specify the rotation angle",900:"Select the object to be converted into a polygon",901:"Set the number of polygon edges",902:"Input Options",903:"Internally connected to a circle",904:"Externally cut to a circle",905:"Select the object whose color you want to modify",906:"Enter color index",907:"hide",908:"Hide Unselected",909:"show all",910:"Select the target object",911:"Specify to delete the first point of the box:",912:"Specify to delete the second point of the box:",913:"Select the entity that needs to be precisely deleted",914:"Please select an angle to copy the object",915:"Please enter the angle for copying quantity",916:"Please enter the base point for copying the angle",917:"Please enter the copying angle",918:"Please select vertex object",919:"Please select the copied object",920:"Please confirm the replication base point",921:"Please select the reference curve",922:"Select interrupt object",923:"Specify offset object",924:"Please enter the offset distance",925:"Specify the scaling object (select lines, polylines, arcs)",926:"Stretching to",927:"Select the object to modify the line type scale",928:"Please enter the line type ratio",929:"Please enter the array spacing",930:"Please select an arc",931:"Select sorting objects",932:"Specify the arrangement base point",933:"Select target polyline:",934:"Please enter rounded corner radius<5>",935:"Select fill object",936:"Please enter the fill ratio",937:"Please select the original fill shape",938:"Please click to fill any point inside the graphic",939:"Please select a line object",940:"Select equal division mode",941:"measure",942:"Divide",943:"Offset equal division",944:"Copy equally",945:"Please select offset equal division objects",946:"Please select to copy equally divided objects",947:"Please select the line segments that need to be divided equally",948:"Please set equal distances",949:"Please set the number of equal parts",950:"Please set the offset distance",951:"Please specify the offset point",952:"Please specify the replication base point",953:"Please specify the number of equal parts to be copied",954:"Please specify the endpoints for copying and dividing equally",955:"Please select the entity that requires rectangular scaling:",956:"Please specify corner 1 of the rectangle",957:"Please specify corner 2 of the rectangle",958:"Please choose to zoom in on the center point",959:"Please select the zoom in range",960:"Please set the magnification factor",961:"Please choose to enlarge the insertion point",962:"Please select a curve that needs to be broken",963:"Please select a break point on the curve",964:"Please enter the number of arrays",965:"Do you want to enable rotation",966:"correct",967:"deny",968:"Please select the graphics that require an array:",969:"Please select the center point of the array",970:"Please select a closed polygon!",971:"Please select the first point",972:"Please select the second point",973:"Please select the first closed polygon",974:"Please select the second closed polygon",975:"Please select two closed polygons",976:"Two polygons do not have overlapping edges!",977:"Please select the target polygon",978:"Please select the edges of the polygon to add vertices to",979:"Please set the position of the added vertices",980:"Please select the vertices of the polygon that need to be deleted",981:"Please select the edges of the polygon that need to be stretched",982:"Please specify the stretching position",983:"Please set the orientation of the frame to<N>",984:"horizontal",985:"longitudinal",986:"Please set the frame size to<4>",987:"Please set the position of the frame",988:"Specify cutting corner 1",989:"Specify cutting corner point 2",990:"Please set the starting point of the road",991:"Please set the next point",992:"Please select the target alignment line object (choose a line)",993:"Please select the target text object",994:"Select Text Object",995:"Please set the font height",996:"Please set the word width",997:"Please select the source text",998:"Please select the first text",999:"Please select the second text",1e3:"Please select the text that needs to be aligned",1001:"Please choose the alignment method",1002:"the left side",1003:"centre",1004:"the right side",1005:"Please select the alignment base point",1006:"Please select the text that needs to be reversed",1007:"Please select the text that needs to be filled with spaces",1008:"Please select a text object",1009:"Please enter underline width",1010:"Please set the underline distance",1011:"Please set an underline to extend the distance",1012:"Please select the operation option",1013:"capital letters",1014:"lowercase",1015:"sentence case ",1016:"Please select a numerical object",1017:"Please select a text insertion point",1018:"Select the scope to search for:",1019:"Please select the search mode",1020:"equal to",1021:"contain",1022:"The prefix is",1023:"The suffix is",1024:"Please enter keywords",1025:"Select the scope of operation:",1026:"Select operation mode",1027:"add",1028:"delete",1029:"Select operation location",1030:"prefix",1031:"suffix",1032:"Please enter the content",1033:"Please select text",1034:"Please select an arc",1035:"Please choose a text style",1036:"Please set the text extraction range",1037:"Download and open the demo code",1038:"Download development kit",1039:"Call the command to draw circular lines",1040:"Interactive drawing of straight lines",1041:"Add Layer",1042:"Get all layers",1043:"Get all text styles",1044:"Obtain all image blocks",1045:"Get all line types",1046:"Write extended data",1047:"Read extended data",1048:"Test inserting a block",1049:"Draw a straight line",1050:"arc ",1051:"circle",1052:"Draw PL line",1053:"Draw Fill",1054:"emoji",1055:"Draw an ellipse",1056:"Draw elliptical arcs",1057:"Draw multiline text",1058:"TABLE",1059:"Draw QR code",1060:"Insert stamp",1061:"Get all objects",1062:"Interactive selection of objects",1063:"Save MXWeb to the server",1064:"Obtain system variables",1065:"new sheet",1066:"White background color",1067:"Text search and positioning",1068:"Select entity to make blocks",1069:"Draw single line text",1070:"Select point filling",1071:"Set extended attributes",1072:"Draw alignment annotations",1073:"Drawing line annotation",1074:"angular",1075:"Modify object line type",1076:"Select hidden object layer",1077:"Add to current selection",1078:"Visual rotation",1079:"Write extension records",1080:"Get a Naming Dictionary",1081:"Add Text Style",1082:"Draw custom entities",1083:"Modify object color",1084:"The modified object is not visible",1085:"Modify object layer",1086:"Modify the display order of objects",1087:"Output PDF within the specified range",1088:"Draw an image",1089:"Read object extension dictionary",1090:"Draw 3D Polyline",1091:"Custom entity for line drawing text",1092:"Calculate intersection point",1093:"Modify Text Style",1094:"Offset input line drawing",1095:"Create Group",1096:"Screenshot JPG",1097:"Obtain the same text as the drawing",1098:"Specify the output range as dwg",1099:"Test drawing marker circle",1100:"Test Wipeout",1101:"create cutouts",1102:"Tolerance marking",1103:"Change all object colors",1104:"Cutting MXWeb",1105:"Set the current color line weight",1106:"Search for objects within a polygonal region",1107:"Smash objects",1108:"Draw semi transparent lines",1109:"Add line type",1110:"Modify the proportion of the pattern",1111:"Test Text Editing",1112:"Draw barcode",1113:"Screenshot BMP",1114:"Modify Tools",1115:"text tool",1116:"Drawing tools",1117:"Block Tool",1118:"Instrument",1119:"Annotation tool",1120:"Other tools",1121:"Multiple replication",1122:"Arc to Circle",1123:"Copy Rotation",1124:"Circular to Multilateral",1125:"Change color",1126:"Arc angle cutting",1127:"Temporary Hide",1128:"Box deletion",1129:"Angle copying",1130:"Vertex Copy",1131:"Intersection point interruption",1132:"double offset",1133:"Change the size of the circle",1134:"Linetype Scale",1135:"Telescoping",1136:"By arc array",1137:"PL rounded corner",1138:"PL line reverse",1139:"Obtain all linear objects",1140:"equal division",1141:"Rectangular scaling",1142:"interrupt",1143:"Cutting polygons",1144:"Merging Polygons",1145:"Add polygon vertices",1146:"Delete polygon vertices",1147:"Unilateral stretching of polygons",1148:"star shape",1149:"Concave convex line",1150:"jagged lines",1151:"Center rectangle",1152:"rounded rectangle",1153:"Circular centerline",1154:"pipe",1155:"Pipe cutting symbol",1156:"perpendicular bisector",1157:"staircase",1158:"solid circle",1159:"Thermal insulation cotton",1160:"Centerline",1161:"Opening a hole",1162:"message box",1163:"Reference symbol (1)",1164:"weld line",1165:"concentric circles",1166:"gear",1167:"Block centerline",1168:"Circular tangent line",1169:"Reference symbol (2)",1170:"Insert frame",1171:"Draw roads",1172:"Draw any polygon",1173:"Align by line",1174:"Change the font height",1175:"Change the width of the characters",1176:"Brush content",1177:"Change content",1178:"justified",1179:"Align up and down",1180:"Text reversal",1181:"Text framing",1182:"underline",1183:"Title line",1184:"case",1185:"Sum of numbers",1186:"Select specific characters",1187:"affix",1188:"Connecting Text",1189:"Delete space",1190:"Vertical Text",1191:"Align by arc",1192:"Modify global text style",1193:"Extract Text",1194:"Text number",1195:"Change the block name",1196:"Brush block",1197:"Block Connection",1198:"Change the base point of the block",1199:"Change the color of the block",1200:"Multi block rotation",1201:"Multi block scaling",1202:"Brush block angle",1203:"Select by block",1204:"Select all by block",1205:"Statistics of individual blocks",1206:"Count multiple blocks",1207:"Modify block layer",1208:"length",1209:"Statistical area",1210:"Intelligent elevation",1211:"area",1212:"Rectangular area",1213:"distance from point to line",1214:"arc length",1215:"Measuring Circle",1216:"CONTINUE",1217:"View segment length",1218:"Area including arc",1219:"Drawing review annotation",1220:"Rectangular annotation",1221:"Roughness annotation",1222:"Coordinate annotation",1223:"Slope marking",1224:"alignment",1225:"enlarge",1226:"Number annotation",1227:"Rotate annotation",1228:"Circular hole marking",1229:"Directional symbol",1230:"Radiographic annotation",1231:"Rectangular annotation hovering color change",1232:"Crop drawing extension",1233:"Arrow line",1234:"Selected Text",1235:"Clipboard",1236:"cancel",1237:"sure",1238:"Tolerance code",1239:"Tolerance 1",1240:"Tolerance 2",1241:"annotations",1242:"top",1243:"bottom",1244:"reference",1245:"Full week symbol",1246:"Current line",1247:"Add Row",1248:"delete row",1249:"zero clearing",1250:"Straightness",1251:"Flatness",1252:"roundness",1253:"Cylindricity",1254:"Line Profile",1255:"Profile of a Surface",1256:"parallelism",1257:"verticality",1258:"tilt",1259:"Positional accuracy",1260:"Coaxiality",1261:"Symmetry",1262:"runout",1263:"total runout",1264:"clean up",1265:"Please enter the text content and number:",1266:"Text content:",1267:"(Enter 0-20 words)",1268:"Starting number:",1269:"(Number automatically increases by 1)",1270:"Number location:",1271:"Number before",1272:"Number after",1273:"change direction",1274:"Left text content:",1275:"Text content on the right:",1276:"Bottom text content:",1277:"Basic symbols",1278:"Same requirements",1279:"Most symbols",1280:"Add a horizontal line to the long side",1281:"auxiliary symbol",1282:"Supplementary symbols",1283:"Symbol position",1284:"Special symbols",1285:"Left size",1286:"Up size",1287:"Right size",1288:"Staggered weld",1289:"spacing",1290:"extended text ",1291:"Dashed line position",1292:"Welding instructions",1293:"Clear rows",1294:"flange weld",1295:"Type I weld seam",1296:"V-shaped weld seam",1297:"Unilateral V-shaped weld seam",1298:"Single sided steep side V-shaped groove welding",1299:"Tilted weld seam",1300:"Removable pad",1301:"Durable pad",1302:"V-type weld with rounded edge",1303:"U-shaped weld with rounded edge",1304:"Single sided V-shaped weld with a stop edge",1305:"Single sided U-shaped weld with a stop edge",1306:"Edge weld",1307:"Welding joint",1308:"sealing bead",1309:"fillet weld",1310:"Plug weld or groove weld",1311:"spotweld",1312:"Folding interface",1313:"Tilt interface",1314:"Spot weld seam (offset center)",1315:"Weld seam",1316:"Weld seam (off center)",1317:"Steep side V-shaped groove welding",1318:"The first type of planar symbol",1319:"The second concave symbol",1320:"The second type of convex symbol",1321:"The second type of planar symbol",1322:"The first convex symbol",1323:"The third type of planar symbol",1324:"The first concave symbol",1325:"Flatten the weld seam",1326:"Smooth transition at the toe",1327:"With pad symbol",1328:"Three sided weld symbol",1329:"Surrounding welding symbols",1330:"On site symbols",1331:"tail symbol",1332:"Interleaved intermittent welding symbol",1333:"Horn shaped weld seam",1334:"Unilateral horn shaped weld seam",1335:"Weld seam",1336:"Lock edge weld seam",1337:"Locking edge groove",1338:"upper",1339:"below",1340:"not have",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"Select the weld symbol to be placed on the geometric shape",1346:"Welding angle width:",1347:"Unilateral V-shaped butt weld (front view)",1348:"Corner weld seam (front view)",1349:"Unilateral V-shaped butt weld (side view)",1350:"Corner weld seam (side view)",1985:"Extract Table",1996:"Please input the table to extract accuracy",1997:"Select the first corner of the extraction range",1998:"Select the second corner of the extraction range",1999:"No valid table recognized!",2e3:"Please test in the local environment!",2001:"Online editing of tables",2019:"Enter the number text",2020:"Please select a single line of text",2021:"Please select a multi line text",2022:"Please set the text insertion point",2023:"Please select single line text",2024:"Multiple single to multiple conversion",2025:"Single to multiple conversion",2026:"Convert multiple orders",2027:"Convert multiple single orders"}},Symbol.toStringTag,{value:"Module"})),CF=Object.freeze(Object.defineProperty({__proto__:null,default:{718:"출력 범위의 첫 번째 점을 지정합니다.",719:"출력 범위의 두 번째 점을 지정합니다.",720:"첫 번째 점을 지정합니다.",721:"두 번째 점 지정:",722:"클라우드 와이어프레임 시작점:",723:"클라우드 와이어프레임 끝점:",724:"심사 아이콘 참고 사항:",725:"클릭하여 구름선을 그리기 시작:",726:"다시 클릭하여 클라우드 그리기를 끝냅니다.",727:"점 지정:",728:"두 점 지정:",729:"객체 선택",730:"다음 점을 지정합니다.",731:"\\ 삽입 기준점 지정",732:"테이블 삽입점을 지정하려면 다음과 같이 하십시오.",733:"삽입점을 지정하려면 다음과 같이 하십시오.",734:"삽입 기준점 지정",735:"치수 객체 선택",736:"대상 텍스트 선택",737:"채우기 영역 내부의 점을 지정합니다.",738:"닫힌 영역을 찾을 수 없음",739:"표면 거친도",740:"용접 기호",741:"비트 공차",742:"사용자 정의 속성을 설정할 객체 선택",743:"숨길 객체 선택",744:"삽입점을 지정하려면 다음과 같이 하십시오.",745:"점 지정:",746:"각도 지정",747:"두 점 지정:",748:"해치 객체 선택",749:"첫 번째 점을 지정합니다.",750:"두 번째 점 지정:",751:"두 번째 각도를 지정합니다.",752:"마지막 점을 지정합니다.",753:"좌표점을 지정합니다.",754:"치수 점을 지정하려면 다음과 같이 하십시오.",755:"승인 의견을 입력하십시오.",756:"클라우드 와이어프레임 시작점 지정",757:"클라우드 와이어프레임 끝점 지정",758:"심사 아이콘 주석 지정",759:"첫 번째 구석을 지정합니다.",760:"두 번째 구석 지정:",761:"일련번호 위치를 지정하려면 다음과 같이 하십시오.",762:"회전 기호",763:"태그 유형",764:"태그가 필요한 원을 선택하십시오.",765:"위치 점 또는 선 또는 호 또는 원을 설정하십시오.",766:"드래그하여 치수 위치 결정",767:"각도를 지정하거나 입력하십시오.",768:"용접 기호",769:"위치 점, 선 또는 호를 선택하십시오.",770:"두 번째 점을 지정하십시오.",771:"위치 점을 설정하십시오.",772:"각도를 설정하십시오.",773:"위치 점이나 선 또는 호를 설정하십시오.",774:"지시선 전환점을 설정하십시오.",775:"드래그하여 위치 점 결정",776:"첫 번째 점을 지정하십시오.",777:"두 번째 점을 지정하십시오.",778:"대상 블록 객체를 선택하십시오.",779:"새 블록 이름을 입력하십시오.",780:"기준점을 수정할 블록 선택",781:"기준점 설정",782:"색상을 수정할 블록 선택",783:"색상 색인 입력 (0~256)",784:"소스 블록을 선택하십시오.",785:"브러시할 대상 블록 선택:",786:"연결 방법 선택",787:"수동으로 하나씩 연결",788:"자동 대량 연결",789:"연결된 블록을 선택하십시오.",790:"중심선 길이 설정",791:"회전할 대상 블록을 선택합니다.",792:"회전 각도 설정",793:"배율을 설정하십시오.",794:"선택 범위를 설정하십시오.",795:"대상 블록을 선택하십시오.",796:"통계 범위를 설정하십시오.",797:"테이블 삽입점을 지정하려면 다음과 같이 하십시오.",798:"대상 커브 선택",799:"길이 치수 점 지정",800:"대상 객체 선택",801:"대상 기울기 객체를 선택하십시오.",802:"치수 문자 높이를 설정하십시오.",803:"기울기 치수 점 지정",804:"대상 좌표점을 선택하십시오.",805:"치수 위치를 지정하십시오.",806:"시작점 지정",807:"끝점 지정",808:"치수 방향 지정",809:"텍스트 내용을 설정하십시오.",810:"영역의 첫 번째 점을 선택하십시오.",811:"다음 점을 선택하십시오.",812:"영역 치수의 위치를 선택하십시오.",813:"사각형의 구석 1을 선택하십시오.",814:"사각형의 구석 2 를 선택하십시오.",815:"영역 치수의 위치를 설정하십시오.",816:"측정 점을 선택하십시오.",817:"선을 선택하십시오.",818:"치수 선의 위치를 설정하십시오.",819:"호선을 선택하십시오.",820:"치수 선 위치를 지정하십시오.",821:"원 객체를 선택하십시오.",822:"문자 위치를 지정하십시오.",823:"선의 끝점이나 호를 선택하십시오.",824:"문자의 위치를 지정하십시오.",825:"연속 측정을 위한 치수를 선택하십시오.",826:"두 번째 선을 선택하십시오.",827:"각도 치수의 위치를 설정하십시오.",828:"별 꼭대기 점 수를 입력하십시오.",829:"별의 중심점을 지정하려면:",830:"별의 내부 반지름을 설정하십시오.",831:"별의 외부 반지름을 지정합니다.",832:"범프 선 너비를 입력하십시오<5>",833:"범프 선 높이를 입력하십시오<10>",834:"시작점을 확인하려면 클릭하십시오.",835:"클릭하여 결승점을 확정하세요",836:"앤티앨리어싱 너비를 입력하십시오<5>",837:"앤티앨리어싱 높이 입력<10>",838:"직사각형 너비 입력<5>",839:"직사각형 높이 입력<10>",840:"클릭하여 사각형 중심 확인",841:"파이프 지름을 입력하십시오<10>",842:"파이프 배출구 길이를 입력하십시오<5>",843:"클릭하여 시작점 확인",844:"횡단면 파이프라인 시작점 지정하기",845:"횡단면 파이프라인 끝점 지정하기",846:"횡단면 파이프라인 호 방향 선택",847:"왼쪽",848:"오른쪽",849:"선택 모드",850:"선 용접",851:"아크 용접",852:"용접 반지름을 입력하십시오<5>",853:"호의 두 번째 점 지정하기",854:"호의 끝점 지정하기",855:"폭을 입력하십시오<25>",856:"높이를 입력하십시오<15>",857:"계단 레벨을 입력하십시오<10>",858:"중심 위치를 확인하십시오.",859:"원 반지름을 입력하십시오.",860:"보온면 너비 입력<5>",861:"보온면 높이 입력<10>",862:"다음 점 눌러주세요.",863:"첫 번째 선을 선택하십시오.",864:"두 번째 선을 선택하십시오.",865:"끝점을 선택하십시오.",866:"대상 사각형을 선택하십시오.",867:"나침반 중심점 설정",868:"나침반 반지름 설정",869:"프롬프트 상자 가리키기 선택",870:"메시지 상자의 첫 번째 점을 지정합니다.",871:"메시지 상자의 두 번째 점을 지정합니다.",872:"메시지 상자 방향을 설정하려면 다음과 같이 하십시오.",873:"데이텀 문자 설정하기",874:"문자 높이를 설정하십시오.",875:"데이텀 문자 위치를 설정하십시오.",876:"위치 점이나 호 또는 선을 설정하십시오.",877:"기호 위치를 설정하십시오.",878:"중심점을 설정하십시오.",879:"기어 중심을 설정하십시오.",880:"기어 반지름을 설정하십시오.",881:"중심선 길이 10 설정 >",882:"첫 번째 원을 선택하십시오.",883:"두 번째 원을 선택하십시오.",884:"직사각형의 왼쪽 위 구석을 설정하십시오.",885:"직사각형의 오른쪽 아래 구석을 설정하십시오.",886:"필렛 반지름을 설정하십시오.",887:"다각형 시작점을 선택하십시오.",888:"다각형 교점을 선택하십시오.",889:"객체 선택:",890:"기준점 지정",891:"두 번째 점 지정",892:"어레이",893:"종료",894:"포기",895:"패턴화할 항목 수 입력",896:"호 객체 선택",897:"회전된 객체 복사를 선택합니다.",898:"대상 점을 지정하십시오.",899:"회전 각도를 지정하십시오.",900:"다각형으로 변환할 객체 선택",901:"다각형 모서리 수 설정",902:"입력 옵션",903:"내접 원",904:"원에 외부 탄젠트",905:"색상을 수정할 객체 선택",906:"색상 색인 입력",907:"숨기기",908:"선택 안 함 숨기기",909:"모두 표시",910:"대상의 객체 선택",911:"상자의 첫 번째 점을 삭제하도록 지정합니다.",912:"상자 두 번째 점을 삭제하도록 지정합니다.",913:"정확하게 삭제할 엔티티 선택",914:"각도를 선택하여 객체를 복사합니다.",915:"각도 복사 수량을 입력하십시오.",916:"각도 복사의 기준점을 입력하십시오.",917:"복사 각도를 입력하십시오.",918:"정점 객체를 선택하십시오.",919:"객체 복사를 선택하십시오.",920:"복제 기준점을 확인하십시오.",921:"참조 커브 선택",922:"끊기 객체 선택",923:"오프셋 객체 지정",924:"오프셋 거리를 입력하십시오.",925:"신축 객체 지정 (선, 폴리선, 호 선택)",926:"다음으로 확장",927:"선종류 축척을 수정할 객체 선택",928:"선종류 축척을 입력하십시오.",929:"패턴 간격을 입력하십시오.",930:"호를 선택하십시오.",931:"정렬 객체 선택",932:"정렬 기준점 지정",933:"대상 폴리선을 선택합니다.",934:"필렛 반지름을 입력하십시오<5>",935:"채우기 객체 선택",936:"채우기 축척을 입력하십시오.",937:"원래 채우기 도면을 선택하십시오.",938:"도면 내부의 아무 곳이나 채우려면 클릭하십시오.",939:"선 객체 선택",940:"등분 모드 선택",941:"정거 등분",942:"정수 등분",943:"오프셋 등분",944:"등분 복사",945:"동등한 객체 간격띄우기를 선택하십시오.",946:"등분 객체 복사를 선택하십시오.",947:"등분할 세그먼트를 선택하십시오.",948:"등분 거리를 설정하십시오.",949:"등분 수량을 설정하십시오",950:"오프셋 거리를 설정하십시오.",951:"오프셋 점을 지정하십시오.",952:"복사 기준점을 지정하십시오.",953:"복사 등분 수량을 지정하십시오.",954:"복사 등분 끝점을 지정하십시오.",955:"사각형 배율이 필요한 엔티티를 선택하십시오.",956:"사각형의 구석 1 을 지정하십시오.",957:"사각형 구석 2를 지정하십시오.",958:"중심점 확대 선택",959:"확대 범위를 선택하십시오.",960:"확대 배수를 설정하십시오.",961:"삽입점 확대 를 선택하십시오.",962:"끊을 커브를 선택하십시오.",963:"커브에서 브레이크 점을 선택하십시오.",964:"패턴 수를 입력하십시오.",965:"회전 켜기",966:"예",967:"아니오",968:"배열이 필요한 도면을 선택하십시오.",969:"스토리지 중심점을 선택하십시오.",970:"닫힌 다각형을 선택하십시오!",971:"첫 번째 점을 선택하십시오.",972:"두 번째 점을 선택하십시오.",973:"첫 번째 닫힌 다각형을 선택하십시오.",974:"두 번째 닫힌 다각형을 선택하십시오.",975:"닫힌 다각형 두 개를 선택하십시오.",976:"두 다각형은 겹치는 모서리가 없습니다!",977:"대상 다각형을 선택하십시오.",978:"정점을 추가할 다각형 모서리를 선택하십시오.",979:"추가할 정점 위치를 설정하십시오.",980:"다각형에서 삭제할 정점을 선택하십시오.",981:"다각형으로 밀어낼 모서리를 선택하십시오.",982:"밀어내기 위치를 지정하십시오.",983:"그림 상자 방향을 설정하십시오<N>",984:"가로",985:"세로",986:"액자 크기를 설정하십시오<4>",987:"프레임 위치를 설정하십시오.",988:"트림 각도 점 1 지정",989:"트림된 구석 2 지정",990:"도로 시작점을 설치하세요",991:"다음 점을 설정하십시오.",992:"대상 정렬선 객체 (선 선택) 를 선택하십시오.",993:"대상 문자 객체를 선택하십시오.",994:"문자 객체 선택",995:"높이를 설정하십시오.",996:"글자 폭을 설정하십시오.",997:"원본 텍스트를 선택하십시오.",998:"첫 번째 텍스트를 선택하십시오.",999:"두 번째 텍스트를 선택하십시오.",1e3:"정렬할 문자를 선택하십시오.",1001:"정렬을 선택하십시오.",1002:"왼쪽",1003:"가운데",1004:"오른쪽",1005:"기준점 정렬을 선택하십시오.",1006:"반전할 텍스트를 선택하십시오.",1007:"공백을 제거할 텍스트를 선택하십시오.",1008:"문자 객체를 선택하십시오.",1009:"밑줄 너비를 입력하십시오.",1010:"밑줄 거리를 설정하십시오.",1011:"밑줄 연장 거리를 설정하십시오.",1012:"작업 옵션을 선택하십시오.",1013:"대문자",1014:"소문자",1015:"문장의 첫머리와 대문자.",1016:"디지털 객체를 선택하십시오.",1017:"텍스트 삽입점을 선택하십시오.",1018:"찾을 범위를 선택합니다.",1019:"찾기 모드를 선택하십시오.",1020:"같음",1021:"포함",1022:"접두사는",1023:"접미어는",1024:"키워드를 입력하십시오.",1025:"작업할 범위를 선택합니다.",1026:"작업 방법 선택",1027:"추가",1028:"삭제",1029:"작업 위치 선택",1030:"접두사",1031:"접미어",1032:"내용을 입력하십시오.",1033:"텍스트 선택",1034:"호를 선택하십시오.",1035:"문자 스타일을 선택하십시오.",1036:"텍스트 추출 범위를 설정하십시오.",1037:"오픈 데모 코드 다운로드",1038:"개발 패키지 다운로드",1039:"원선 그리기 명령 호출",1040:"서로 직선을 그리다",1041:"도면층 추가",1042:"모든 도면층 가져오기",1043:"모든 문자 스타일 가져오기",1044:"모든 그림 블록 가져오기",1045:"모든 선 모양 가져오기",1046:"확장 데이터 쓰기",1047:"확장 데이터 읽기",1048:"그림 블록 삽입 테스트",1049:"선을 그리다",1050:"호 그리기",1051:"원을 그리다",1052:"PL 선 그리기",1053:"채우기 그리기",1054:"드로잉 문자",1055:"타원 그리기",1056:"타원형 호를 그리다",1057:"여러 줄 문자 그리기",1058:"테이블 그리기",1059:"QR코드 그리기",1060:"도장 삽입",1061:"모든 객체 가져오기",1062:"상호 객체 선택",1063:"서버에 mxweb 저장",1064:"시스템 변수 가져오기",1065:"새 시트",1066:"흰색 배경색",1067:"텍스트 찾기 위치",1068:"블록으로 솔리드 선택",1069:"단일행 문자 그리기",1070:"선택 채우기",1071:"확장 속성 설정",1072:"정렬 치수 그리기",1073:"회선 치수",1074:"각도 치수",1075:"객체 선종류 수정",1076:"숨겨진 객체 레이어 선택",1077:"현재 선택에 추가",1078:"뷰포트 회전",1079:"확장 레코드 쓰기",1080:"명명 사전 얻기",1081:"문자 스타일 추가",1082:"사용자 솔리드 그리기",1083:"객체 색상 수정",1084:"수정 개체가 보이지 않음",1085:"객체 레이어 수정",1086:"객체 표시 순서 수정",1087:"범위 지정 출력 pdf",1088:"이미지 그리기",1089:"객체 확장 사전 읽기",1090:"3DPolyline 그리기",1091:"선 그리기 텍스트 사용자화 솔리드",1092:"계산 교차점",1093:"문자 스타일 수정",1094:"오프셋 입력 선",1095:"그룹 만들기",1096:"스크린샷 jpg",1097:"시트 동일 문자 가져오기",1098:"범위 출력 dwg 지정",1099:"표식 원 그리기 테스트",1100:"Wipeout 테스트",1101:"잘라낸 블록 생성하기",1102:"공차 치수",1103:"모든 객체 색상 변경",1104:"자르기 mxweb",1105:"현재 색상 선 무게 설정",1106:"다각형 영역 내의 객체 찾기",1107:"객체 깨기",1108:"반투명 선 그리기",1109:"선 유형 추가",1110:"패턴 축척 수정하기",1111:"텍스트 편집 테스트",1112:"바코드 그리기",1113:"스크린샷 bmp",1114:"수정 도구",1115:"문자 도구",1116:"드로잉 도구",1117:"블록 도구",1118:"측정 도구",1119:"치수 도구",1120:"기타 도구",1121:"다중 복제",1122:"호전원",1123:"복사 회전",1124:"원형 다각형",1125:"색상 수정",1126:"호 탄젠트",1127:"임시 숨기기",1128:"상자 삭제",1129:"각도 복사",1130:"정점 복사",1131:"교점이 끊어지다",1132:"양방향 오프셋",1133:"원 크기 변경",1134:"선종류 축척",1135:"신축",1136:"호별 패턴",1137:"pl 필렛",1138:"pl선 대칭 이동",1139:"모든 선 객체 가져오기",1140:"등분",1141:"직사각형 크기 조절",1142:"끊다",1143:"다각형 가공하기",1144:"다각형 결합",1145:"다각형 교점 추가",1146:"다각형 교점 삭제",1147:"다각형 단일 밀어내기",1148:"별 모양",1149:"범프 선",1150:"톱니 선",1151:"중심 사각형",1152:"필렛 사각형",1153:"원 중심선",1154:"파이프",1155:"단면부",1156:"중수선",1157:"계단",1158:"채워진 원",1159:"보온면",1160:"중심선",1161:"구멍을 내다",1162:"메시지 상자",1163:"데이텀 문자 (1)",1164:"용접선",1165:"동심원",1166:"기어",1167:"블록 중심선",1168:"원형 공접선",1169:"데이텀 문자 (2)",1170:"그림 상자 삽입",1171:"도로를 그리다",1172:"다각형 그리기",1173:"선으로 정렬",1174:"고자질",1175:"글자의 폭을 바꾸다",1176:"내용 스밍",1177:"내용을 바꾸다",1178:"좌우 정렬",1179:"위아래 정렬",1180:"문자 반전",1181:"텍스트 상자",1182:"밑줄",1183:"도명선",1184:"대소문자",1185:"숫자 구화",1186:"특정 단어 선택",1187:"접미어",1188:"연결 문자",1189:"공백 제거",1190:"문자 세로 방향",1191:"호별 정렬",1192:"전역 문자 스타일 수정",1193:"텍스트 추출",1194:"문자 번호",1195:"블록 이름 변경",1196:"브러시",1197:"블록 연결",1198:"블록 기준점을 변경하다.",1199:"블록 색상 변경",1200:"다중 블록 회전",1201:"다중 블록 크기 조절",1202:"브러시 각도",1203:"블록별 선택",1204:"블록별로 모두 선택",1205:"통계 단일 블록",1206:"다중 블록 통계",1207:"블록 도면층 수정",1208:"길이",1209:"통계 면적",1210:"지능형 높이",1211:"면적",1212:"직사각형 영역",1213:"점에서 선까지의 거리",1214:"호 길이",1215:"원 측정",1216:"연속 측정",1217:"세그먼트 길이 보기",1218:"영역 포함 호",1219:"심도 치수",1220:"직사각형 치수",1221:"조잡도 치수",1222:"좌표 치수",1223:"슬로프",1224:"정렬",1225:"부분 확대",1226:"일련번호 마크업",1227:"치수 회전",1228:"둥근 구멍 표식",1229:"방향 기호",1230:"방사선 치수",1231:"직사각형 치수 고정 변색",1232:"용지 확장 트림",1233:"화살표 선",1234:"선택한 텍스트",1235:"클립보드로 복사",1236:"취소",1237:"확인",1238:"공차 코드",1239:"공차 1",1240:"공차 2",1241:"부주",1242:"꼭대기",1243:"밑단",1244:"기준",1245:"전주기호",1246:"현재 행",1247:"행 추가",1248:"행 삭제",1249:"제로",1250:"직선도",1251:"평면도",1252:"원도",1253:"원통도",1254:"선 프로파일",1255:"면 프로파일",1256:"평행도",1257:"수직도",1258:"경사도",1259:"위치도",1260:"동축도",1261:"대칭도",1262:"둥글게 뛰다",1263:"올댄스",1264:"지우기",1265:"텍스트 내용 및 번호를 입력하십시오.",1266:"텍스트 내용:",1267:"(0-20자 입력)",1268:"시작 번호:",1269:"(번호 자동 증가 1)",1270:"번호 지정 위치:",1271:"번호 이전",1272:"번호 뒤에",1273:"방향 변경",1274:"왼쪽 텍스트 내용:",1275:"오른쪽 텍스트 내용:",1276:"아래 텍스트 내용:",1277:"기본 기호",1278:"동일 요구 사항",1279:"다수 기호",1280:"긴 모서리 가로줄",1281:"보조 기호",1282:"보충 기호",1283:"기호 위치",1284:"특수 기호",1285:"왼쪽 치수",1286:"위 치수",1287:"오른쪽 치수",1288:"교차 용접",1289:"간격",1290:"텍스트 확장",1291:"점선 위치",1292:"용접 설명",1293:"행 지우기",1294:"볼륨 모서리 용접",1295:"유형 I 용접",1296:"V 용접",1297:"단일 V 용접",1298:"한면 급경사 V 그루브 스택",1299:"용접 기울이기",1300:"분리식 패드",1301:"영구 패드",1302:"리턴 모서리 V 용접",1303:"리턴 모서리 U 용접",1304:"리턴 모서리 단일 V 용접",1305:"리턴 모서리 단일 U 용접",1306:"끝 용접",1307:"스택 용접 커넥터",1308:"커버 용접",1309:"필렛 용접",1310:"플러그 또는 슬롯 용접",1311:"점 용접",1312:"인터페이스 축소",1313:"기울기 커넥터",1314:"점 용접 (가운데 오프셋)",1315:"용접",1316:"용접 (중심 이탈)",1317:"가파른 V 그루브 스택",1318:"첫 번째 평면 기호",1319:"두 번째 오목 기호",1320:"두 번째 볼록 기호",1321:"두 번째 평면 기호",1322:"첫 번째 볼록 기호",1323:"세 번째 평면 기호",1324:"첫 번째 오목 기호",1325:"용접 깎기",1326:"발가락 부드럽게 변환",1327:"개스킷 기호 포함",1328:"3면 용접 기호",1329:"주변 용접 문자",1330:"필드 기호",1331:"꼬리 기호",1332:"인터레이스 띄엄필렛 용접 기호",1333:"플레어 용접",1334:"단일 플레어 용접",1335:"더미 용접",1336:"자물쇠 모서리 용접",1337:"모서리 그루브 잠금",1338:"위",1339:"하",1340:"없음",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"형상에 배치할 용접 기호 선택",1346:"용접 각도 너비:",1347:"단일 V 버트 용접(전면)",1348:"필렛 용접 (전면)",1349:"단일 V 버트 용접 (측면 뷰)",1350:"필렛 용접 (측면 뷰)",1985:"테이블 추출",1996:"테이블 추출 정밀도를 입력하십시오.",1997:"추출 범위의 첫 번째 구석 선택",1998:"추출 범위의 두 번째 구석 선택",1999:"유효한 양식이 인식되지 않았습니다!",2e3:"로컬 환경에서 테스트하십시오!",2001:"온라인으로 테이블 편집",2019:"번호 문자 입력",2020:"한 줄 텍스트를 선택하십시오.",2021:"여러 줄 텍스트를 선택하십시오.",2022:"문자 삽입점을 설정하십시오.",2023:"단일행 텍스트 선택",2024:"많이 돌리다",2025:"단일 회전 다중",2026:"다중 회전 다중 시트",2027:"다중 회전 단일"}},Symbol.toStringTag,{value:"Module"})),RF=Object.freeze(Object.defineProperty({__proto__:null,default:{718:"指定輸出範圍第一點：",719:"指定輸出範圍第二點：",720:"指定第一點：",721:"指定第二點：",722:"雲線框起始點：",723:"雲線框結束點：",724:"審圖標注點：",725:"點擊開啟繪製雲線：",726:"再次點擊結束繪製雲線：",727:"指定一點：",728:"指定二點：",729:"選擇對象",730:"指定下一個點：",731:"\\指定插入基點",732:"指定表格插入點：",733:"指定插入點：",734:"指定插入基點",735:"選擇標注對象",736:"請選擇目標文字",737:"指定填充區域內部一點：",738:"沒有找到閉合區域",739:"表面粗糙度",740:"焊接符號",741:"形位公差",742:"選擇要需要開啟自訂屬性的對象",743:"選擇要隱藏的對象",744:"指定插入點：",745:"指定一點：",746:"指定夾角",747:"指定二點：",748:"選擇圖案填充對象",749:"指定第一點：",750:"指定第二點：",751:"指定第二個角度點：",752:"指定最後一個點：",753:"指定座標點：",754:"指定標注點：",755:"請輸入審批意見",756:"指定雲線框起始點",757:"指定雲線框終止點",758:"指定審圖標注點",759:"指定第一個角點：",760:"指定第二個角點：",761:"指定序號位置：",762:"旋轉符號",763:"標記類型",764:"請選擇需要標記的圓：",765:"請設定定位點或直線或圓弧或圓",766:"拖動確定標注位置",767:"請指定或輸入角度",768:"焊縫符號",769:"請拾取定位點、直線或圓弧",770:"請指定第二點",771:"請設定定位點",772:"請設定角度",773:"請設定定位點或直線或圓弧",774:"請設定引線轉捩點",775:"拖動確定定位點",776:"請指定第一點：",777:"請指定第二點：",778:"請選擇目標塊對象",779:"請輸入新塊名",780:"選擇需要修改基點的塊",781:"設定基點",782:"選擇需要修改顏色的塊",783:"輸入顏色索引(0~256)",784:"請選擇源塊",785:"選擇要刷的目標塊：",786:"選擇連接管道",787:"手動逐個連線",788:"自動批量連線",789:"請選擇連線的塊",790:"設定中心線長度",791:"選擇要旋轉的目標塊：",792:"設定旋轉角度",793:"請設定縮放比例",794:"請設定選擇範圍：",795:"請選擇目標塊",796:"請設定統計範圍",797:"指定表格插入點：",798:"選擇目標曲線",799:"指定長度標注點",800:"選擇目標對象",801:"請選擇目標斜率對象",802:"請設定標注文字高度",803:"指定斜率標注點",804:"請選擇目標座標點",805:"請指定標注位置",806:"指定起點",807:"指定終點",808:"指定標注方向",809:"請設定文字內容",810:"請選擇面積的第一個點",811:"請選擇下一個點",812:"請選擇面積標注的位置",813:"請選擇矩形的角點1",814:"請選擇矩形的角點2",815:"請設定面積標注的位置",816:"請選擇一個量測點",817:"請選擇一條直線",818:"請設定尺寸線的位置",819:"請選擇一條弧線",820:"請指定尺寸線位置",821:"請選擇一個圓對象",822:"請指定文字位置",823:"請選擇直線的端點或弧線",824:"請指定文字的位置",825:"請選擇一個連續量測的標注",826:"請選擇第二條直線",827:"請設定角度標注的位置",828:"請輸入星形頂點數：",829:"指定星形中心點：",830:"請設定星形的內半徑：",831:"指定星形的外半徑：",832:"請輸入凹凸線寬度<5>",833:"請輸入凹凸線高度<10>",834:"請點擊確定起始點",835:"請點擊確定終點",836:"請輸入鋸齒線寬度<5>",837:"請輸入鋸齒線高度<10>",838:"請輸入矩形寬度<5>",839:"請輸入矩形高度<10>",840:"請點擊確定矩形中心",841:"請輸入管徑<10>",842:"請輸入長出管口長度<5>",843:"請點擊確定起點",844:"指定剖管線起點",845:"指定剖管線終點",846:"選擇剖管線圓弧方向",847:"左邊",848:"右邊",849:"選擇模式",850:"直線焊縫",851:"弧線焊縫",852:"請輸入焊縫半徑<5>",853:"指定圓弧的第二個點",854:"指定圓弧的端點",855:"請輸入寬度<25>",856:"請輸入高度<15>",857:"請輸入樓梯級數<10>",858:"請確定圓心位置",859:"請輸入圓半徑",860:"請輸入保溫棉寬度<5>",861:"請輸入保溫棉高度<10>",862:"請點擊下一個點",863:"請選擇第一條線",864:"請選擇第二條線",865:"請選擇終點",866:"請選擇目標矩形",867:"設定指北針中心點",868:"設定指北針半徑",869:"選擇提示框指向",870:"指定訊息方塊第一點：",871:"指定訊息方塊第二點：",872:"設定訊息方塊指向：",873:"請設定基準符文字",874:"請設定文字高度",875:"請設定基準符位置",876:"請設定定位點或圓弧或直線",877:"請設定符號位置",878:"請設定圓心",879:"請設定齒輪圓心",880:"請設定齒輪半徑",881:"請設定中心線長度10>",882:"請選擇第一個圓",883:"請選擇第二個圓",884:"請設定矩形左上角點",885:"請設定矩形右下角點",886:"請設定圓角半徑",887:"請選擇多邊形起點",888:"請選擇多邊形頂點",889:"選擇對象：",890:"指定基點",891:"指定第二個點",892:"陣列",893:"退出",894:"放弃",895:"輸入要進行陣列的項目數",896:"選擇圓弧對象",897:"選擇複製旋轉對象：",898:"請指定目標點",899:"請指定旋轉角度",900:"選擇要轉成多邊形的對象",901:"設定多邊形邊數",902:"輸入選項",903:"內接於圓",904:"外切於圓",905:"選擇要修改顏色的對象",906:"輸入顏色索引",907:"隱藏",908:"隱藏未選",909:"全部顯示",910:"選擇目標的對象",911:"指定删除方框第一點：",912:"指定删除方框第二點：",913:"選擇需要精確删除的實體",914:"請選擇角度複製對象",915:"請輸入角度複製數量",916:"請輸入角度複製的基點",917:"請輸入複製角度",918:"請選擇頂點對象",919:"請選擇複製對象",920:"請確定複製基點",921:"請選擇參攷曲線",922:"選擇打斷對象",923:"指定偏移對象",924:"請輸入偏移距離",925:"指定伸縮對象(選擇直線、多段線、圓弧)",926:"伸縮至",927:"選擇要修改線型比例的對象",928:"請輸入線型比例",929:"請輸入陣列間距",930:"請選擇圓弧",931:"選擇排列對象",932:"指定排列基點",933:"選擇目標多段線：",934:"請輸入圓角半徑<5>",935:"選擇填充對象",936:"請輸入填充比例",937:"請選擇原填充圖形",938:"請點擊填充圖形內部任意一點",939:"請選擇線對象",940:"選擇等分模式",941:"定距等分",942:"定數等分",943:"偏移等分",944:"複製等分",945:"請選擇偏移等分對象",946:"請選擇複製等分對象",947:"請選擇需要等分的線段",948:"請設定等分距離",949:"請設定等分的數量",950:"請設定偏移距離",951:"請指定偏移點",952:"請指定複製基點",953:"請指定複製等分數量",954:"請指定複製等分端點",955:"請選擇需要矩形縮放的實體：",956:"請指定矩形的角點1",957:"請指定矩形角點2",958:"請選擇放大中心點",959:"請選擇放大範圍",960:"請設定放大倍數",961:"請選擇放大插入點",962:"請選擇一條需要打斷的曲線",963:"請在曲線上選取打斷點",964:"請輸入陣列數量",965:"是否開啟旋轉",966:"是",967:"否",968:"請選擇需要陣列的圖形：",969:"請選擇陣列中心點",970:"請選擇閉合多邊形！",971:"請選擇第一個點",972:"請選擇第二個點",973:"請選擇第一個閉合多邊形",974:"請選擇第二個閉合多邊形",975:"請選擇兩個閉合多邊形",976:"兩個多邊形沒有重合邊！",977:"請選擇目標多邊形",978:"請選擇多邊形需要添加頂點的邊",979:"請設定添加的頂點位置",980:"請選擇多邊形需要删除的頂點",981:"請選擇多邊形需要拉伸的邊",982:"請指定拉伸位置",983:"請設定圖框方向<N>",984:"橫向",985:"縱向",986:"請設定圖框尺寸<4>",987:"請設定圖框位置",988:"指定裁剪角點1",989:"指定裁剪角點2",990:"請設定道路起點",991:"請設定下一點",992:"請選擇目標對齊線對象(選擇直線)",993:"請選擇目標文字對象",994:"選擇文字對象",995:"請設定字高",996:"請設定字寬",997:"請選擇源文字",998:"請選擇第一個文字",999:"請選擇第二個文字",1e3:"請選擇需要對齊的文字",1001:"請選擇對齊管道",1002:"左",1003:"中",1004:"右",1005:"請選擇對齊基點",1006:"請選擇需要反轉的文字",1007:"請選擇需要去空格的文字",1008:"請選擇文字對象",1009:"請輸入底線寬度",1010:"請設定底線距離",1011:"請設定底線延長距離",1012:"請選擇操作選項",1013:"大寫",1014:"小寫",1015:"句首大寫",1016:"請選擇數位對象",1017:"請選擇文字插入點",1018:"選擇要查找的範圍：",1019:"請選擇查找模式",1020:"等於",1021:"包含",1022:"首碼為",1023:"尾碼為",1024:"請輸入關鍵字",1025:"選擇要操作的範圍：",1026:"選擇操作管道",1027:"添加",1028:"删除",1029:"選擇操作位置",1030:"首碼",1031:"尾碼",1032:"請輸入內容",1033:"請選擇文字",1034:"請選擇圓弧",1035:"請選擇文字樣式",1036:"請設定文字選取範圍",1037:"下載開Demo程式碼",1038:"下載開發包",1039:"調用畫圓線命令",1040:"互動畫直線",1041:"添加圖層",1042:"得到所有圖層",1043:"得到所有文字樣式",1044:"得到所有圖塊",1045:"得到所有線型",1046:"寫擴展數據",1047:"讀擴展數據",1048:"測試插入一個圖塊",1049:"繪直線",1050:"繪圓弧",1051:"繪圓",1052:"繪PL線",1053:"繪填充",1054:"繪文字",1055:"繪橢圓",1056:"繪橢圓弧",1057:"繪製多行文字",1058:"繪製表格",1059:"繪製二維碼",1060:"插入圖章",1061:"得到所有對象",1062:"互動選擇對象",1063:"保存mxweb到服務器",1064:"得到系統變數",1065:"新建圖紙",1066:"白色背景色",1067:"文字查找定位",1068:"選擇實體做塊",1069:"繪製單行文字",1070:"選點填充",1071:"設定擴展内容",1072:"繪製對齊標注",1073:"繪性線標注",1074:"角度標注",1075:"修改對象線型",1076:"選擇隱藏對象層",1077:"添加到當前選擇",1078:"視區旋轉",1079:"寫擴展記錄",1080:"得到命名字典",1081:"添加文字樣式",1082:"繪自定義實體",1083:"修改對象顏色",1084:"修改對象不可見",1085:"修改對象層",1086:"修改對象顯示順序",1087:"指定範圍輸出pdf",1088:"繪製image",1089:"讀取對象擴展字典",1090:"繪製3DPolyline",1091:"繪線文字自定義實體",1092:"計算交點",1093:"修改文字樣式",1094:"偏移輸入畫線",1095:"創建組",1096:"螢幕截圖jpg",1097:"獲取圖紙相同文字",1098:"指定範圍輸出dwg",1099:"測試繪製標記圓",1100:"測試Wipeout",1101:"創建剪切塊",1102:"公差標注",1103:"改所有對象顏色",1104:"切剪mxweb",1105:"設定當前顏色線重",1106:"查找多邊形區域內對象",1107:"打碎對象",1108:"繪半透明線",1109:"添加線型",1110:"修改圖案比例",1111:"測試文字編輯",1112:"繪製條碼",1113:"螢幕截圖bmp",1114:"修改工具",1115:"文字工具",1116:"繪圖工具",1117:"塊工具",1118:"量測工具",1119:"標注工具",1120:"其他工具",1121:"多重複製",1122:"弧轉圓",1123:"複製旋轉",1124:"圓轉多邊",1125:"修改顏色",1126:"圓弧切角",1127:"臨時隱藏",1128:"方框删除",1129:"角度複製",1130:"頂點複製",1131:"交點打斷",1132:"雙向偏移",1133:"改圓大小",1134:"線型比例",1135:"伸縮",1136:"按弧陣列",1137:"pl圓角",1138:"pl線反向",1139:"得到所有直線對象",1140:"等分",1141:"矩形縮放",1142:"打斷",1143:"切割多邊形",1144:"合併多邊形",1145:"添加多邊形頂點",1146:"删除多邊形頂點",1147:"多邊形單邊拉伸",1148:"星形",1149:"凹凸線",1150:"鋸齒線",1151:"中心矩形",1152:"圓角矩形",1153:"圓中心線",1154:"筦道",1155:"剖管符",1156:"中垂線",1157:"樓梯",1158:"實心圓",1159:"保溫棉",1160:"中心線",1161:"開洞",1162:"訊息方塊",1163:"基準符(1)",1164:"焊縫線",1165:"同心圓",1166:"齒輪",1167:"塊中心線",1168:"圓公切線",1169:"基準符(2)",1170:"插入圖框",1171:"繪製道路",1172:"繪任意多邊形",1173:"按線對齊",1174:"改字高",1175:"改字寬",1176:"刷內容",1177:"換內容",1178:"左右對齊",1179:"上下對齊",1180:"文字反轉",1181:"文字加框",1182:"底線",1183:"圖名線",1184:"大小寫",1185:"數位求和",1186:"選特定字",1187:"前尾碼",1188:"連接文字",1189:"去空格",1190:"文字豎向",1191:"按弧對齊",1192:"修改全域文字樣式",1193:"選取文字",1194:"文字編號",1195:"改塊名",1196:"刷塊",1197:"塊連線",1198:"改塊基點",1199:"改塊顏色",1200:"多塊旋轉",1201:"多塊縮放",1202:"刷塊角度",1203:"按塊選擇",1204:"按塊全選",1205:"統計單塊",1206:"統計多塊",1207:"修改塊圖層",1208:"長度",1209:"統計面積",1210:"智慧標高",1211:"面積",1212:"矩形面積",1213:"點到直線的距離",1214:"弧長",1215:"量測圓",1216:"連續量測",1217:"查看分段長度",1218:"面積含弧線",1219:"審圖標注",1220:"矩形標注",1221:"粗糙度標注",1222:"座標標注",1223:"標斜率",1224:"對齊",1225:"局部放大",1226:"序號標注",1227:"旋轉標注",1228:"圓孔標記",1229:"向視符號",1230:"射線標注",1231:"矩形標注懸停變色",1232:"裁剪圖紙擴展",1233:"箭頭直線",1234:"選擇的文字",1235:"複製到剪貼板",1236:"取消",1237:"確定",1238:"公差代號",1239:"公差1",1240:"公差2",1241:"附注",1242:"頂端",1243:"底端",1244:"基準",1245:"全周符號",1246:"當前行",1247:"新增行",1248:"删除行",1249:"清零",1250:"直線度",1251:"平面度",1252:"圓度",1253:"圓柱度",1254:"線輪廓度",1255:"面輪廓度",1256:"平行度",1257:"垂直度",1258:"傾斜度",1259:"位置度",1260:"同軸度",1261:"對稱度",1262:"圓跳動",1263:"全跳動",1264:"清除",1265:"請輸入文字內容和編號：",1266:"文字內容：",1267:"(輸入0-20個字)",1268:"起始編號：",1269:"(編號自動遞增1)",1270:"編號位置：",1271:"編號在前",1272:"編號在後",1273:"改變方向",1274:"左邊文字內容：",1275:"右邊文字內容：",1276:"底部文字內容：",1277:"基本符號",1278:"相同要求",1279:"多數符號",1280:"長邊加橫線",1281:"輔助符號",1282:"補充符號",1283:"符號位置",1284:"特殊符號",1285:"左尺寸",1286:"上尺寸",1287:"右尺寸",1288:"交錯焊縫",1289:"間距",1290:"擴充文字",1291:"虛線位置",1292:"焊接說明",1293:"清除行",1294:"卷邊焊縫",1295:"I型焊縫",1296:"V型焊縫",1297:"單邊V型焊縫",1298:"單邊陡側V型坡口堆焊",1299:"傾斜焊縫",1300:"可移除襯墊",1301:"持久襯墊",1302:"帶頓邊V型焊縫",1303:"帶頓邊U型焊縫",1304:"帶頓邊單邊V型焊縫",1305:"帶頓邊單邊U型焊縫",1306:"端接焊縫",1307:"堆焊接頭",1308:"封底焊縫",1309:"角焊縫",1310:"塞焊縫或槽焊縫",1311:"點焊縫",1312:"折疊介面",1313:"傾斜介面",1314:"點焊縫(偏移中心)",1315:"縫焊縫",1316:"縫焊縫(偏離中心)",1317:"陡側V型坡口堆焊",1318:"第一種平面符號",1319:"第二種凹面符號",1320:"第二種凸面符號",1321:"第二種平面符號",1322:"第一種凸面符號",1323:"第三種平面符號",1324:"第一種凹面符號",1325:"削平焊縫",1326:"趾部平滑過渡",1327:"帶墊板符號",1328:"三面焊縫符號",1329:"周圍焊接符",1330:"現場符號",1331:"尾部符號",1332:"交錯斷續焊接符號",1333:"喇叭形焊縫",1334:"單邊喇叭形焊縫",1335:"堆焊縫",1336:"鎖邊焊縫",1337:"鎖邊坡口",1338:"上",1339:"下",1340:"無",1341:"basicSymbol",1342:"auxiliarySymbol",1343:"suppleSymbol",1344:"specialSymbol",1345:"選擇要在幾何圖形上放置的焊縫符號",1346:"焊角寬度：",1347:"單邊V型對接焊縫(前視圖)",1348:"角焊縫(前視圖)",1349:"單邊V型對接焊縫(側視圖)",1350:"角焊縫(側視圖)",1985:"選取表格",1996:"請輸入表格選取精度",1997:"選擇選取範圍第一個角點",1998:"選擇選取範圍第二個角點",1999:"未識別到有效表格！",2e3:"請在本地環境測試！",2001:"線上編輯表格",2019:"輸入編號文字",2020:"請選擇一個單行文字",2021:"請選擇一個多行文字",2022:"請設定文字插入點",2023:"請選擇單行文字",2024:"多單轉一多",2025:"單轉多",2026:"多轉多個單",2027:"多轉單個單"}},Symbol.toStringTag,{value:"Module"}))})(Mx,MxCAD,MXCADAPP_EXTERNALLIBRARIES.Vue,MXCADAPP_EXTERNALLIBRARIES.vuetifyComponents,MXCADAPP_EXTERNALLIBRARIES.axios);
//# sourceMappingURL=test.js.map
