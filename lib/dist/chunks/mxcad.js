var lr = Math.pow;
import { M as Ue, a as no, b as lw, s as cw, l as fw, D as dn, c as md, d as pn, e as Wf, f as Vf, g as hw, h as dw, i as pw, j as vw, k as mw, m as Gt } from "./mxdraw.js";
function gw(e) {
  var t = e.default;
  if (typeof t == "function") {
    var r = function() {
      return t.apply(this, arguments);
    };
    r.prototype = t.prototype;
  } else r = {};
  return Object.defineProperty(r, "__esModule", { value: !0 }), Object.keys(e).forEach(function(n) {
    var i = Object.getOwnPropertyDescriptor(e, n);
    Object.defineProperty(r, n, i.get ? i : {
      enumerable: !0,
      get: function() {
        return e[n];
      }
    });
  }), r;
}
var Ts = {}, Hf = {};
Hf.byteLength = ww;
Hf.toByteArray = Mw;
Hf.fromByteArray = Tw;
var xi = [], Gn = [], yw = typeof Uint8Array != "undefined" ? Uint8Array : Array, ch = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
for (var Ls = 0, bw = ch.length; Ls < bw; ++Ls)
  xi[Ls] = ch[Ls], Gn[ch.charCodeAt(Ls)] = Ls;
Gn[45] = 62;
Gn[95] = 63;
function Fy(e) {
  var t = e.length;
  if (t % 4 > 0)
    throw new Error("Invalid string. Length must be a multiple of 4");
  var r = e.indexOf("=");
  r === -1 && (r = t);
  var n = r === t ? 0 : 4 - r % 4;
  return [r, n];
}
function ww(e) {
  var t = Fy(e), r = t[0], n = t[1];
  return (r + n) * 3 / 4 - n;
}
function xw(e, t, r) {
  return (t + r) * 3 / 4 - r;
}
function Mw(e) {
  var t, r = Fy(e), n = r[0], i = r[1], a = new yw(xw(e, n, i)), s = 0, o = i > 0 ? n - 4 : n, u;
  for (u = 0; u < o; u += 4)
    t = Gn[e.charCodeAt(u)] << 18 | Gn[e.charCodeAt(u + 1)] << 12 | Gn[e.charCodeAt(u + 2)] << 6 | Gn[e.charCodeAt(u + 3)], a[s++] = t >> 16 & 255, a[s++] = t >> 8 & 255, a[s++] = t & 255;
  return i === 2 && (t = Gn[e.charCodeAt(u)] << 2 | Gn[e.charCodeAt(u + 1)] >> 4, a[s++] = t & 255), i === 1 && (t = Gn[e.charCodeAt(u)] << 10 | Gn[e.charCodeAt(u + 1)] << 4 | Gn[e.charCodeAt(u + 2)] >> 2, a[s++] = t >> 8 & 255, a[s++] = t & 255), a;
}
function Ew(e) {
  return xi[e >> 18 & 63] + xi[e >> 12 & 63] + xi[e >> 6 & 63] + xi[e & 63];
}
function Aw(e, t, r) {
  for (var n, i = [], a = t; a < r; a += 3)
    n = (e[a] << 16 & 16711680) + (e[a + 1] << 8 & 65280) + (e[a + 2] & 255), i.push(Ew(n));
  return i.join("");
}
function Tw(e) {
  for (var t, r = e.length, n = r % 3, i = [], a = 16383, s = 0, o = r - n; s < o; s += a)
    i.push(Aw(e, s, s + a > o ? o : s + a));
  return n === 1 ? (t = e[r - 1], i.push(
    xi[t >> 2] + xi[t << 4 & 63] + "=="
  )) : n === 2 && (t = (e[r - 2] << 8) + e[r - 1], i.push(
    xi[t >> 10] + xi[t >> 4 & 63] + xi[t << 2 & 63] + "="
  )), i.join("");
}
var gv = {};
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
gv.read = function(e, t, r, n, i) {
  var a, s, o = i * 8 - n - 1, u = (1 << o) - 1, l = u >> 1, c = -7, f = r ? i - 1 : 0, h = r ? -1 : 1, d = e[t + f];
  for (f += h, a = d & (1 << -c) - 1, d >>= -c, c += o; c > 0; a = a * 256 + e[t + f], f += h, c -= 8)
    ;
  for (s = a & (1 << -c) - 1, a >>= -c, c += n; c > 0; s = s * 256 + e[t + f], f += h, c -= 8)
    ;
  if (a === 0)
    a = 1 - l;
  else {
    if (a === u)
      return s ? NaN : (d ? -1 : 1) * (1 / 0);
    s = s + Math.pow(2, n), a = a - l;
  }
  return (d ? -1 : 1) * s * Math.pow(2, a - n);
};
gv.write = function(e, t, r, n, i, a) {
  var s, o, u, l = a * 8 - i - 1, c = (1 << l) - 1, f = c >> 1, h = i === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0, d = n ? 0 : a - 1, g = n ? 1 : -1, v = t < 0 || t === 0 && 1 / t < 0 ? 1 : 0;
  for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (o = isNaN(t) ? 1 : 0, s = c) : (s = Math.floor(Math.log(t) / Math.LN2), t * (u = Math.pow(2, -s)) < 1 && (s--, u *= 2), s + f >= 1 ? t += h / u : t += h * Math.pow(2, 1 - f), t * u >= 2 && (s++, u /= 2), s + f >= c ? (o = 0, s = c) : s + f >= 1 ? (o = (t * u - 1) * Math.pow(2, i), s = s + f) : (o = t * Math.pow(2, f - 1) * Math.pow(2, i), s = 0)); i >= 8; e[r + d] = o & 255, d += g, o /= 256, i -= 8)
    ;
  for (s = s << i | o, l += i; l > 0; e[r + d] = s & 255, d += g, s /= 256, l -= 8)
    ;
  e[r + d - g] |= v * 128;
};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
(function(e) {
  const t = Hf, r = gv, n = typeof Symbol == "function" && typeof Symbol.for == "function" ? Symbol.for("nodejs.util.inspect.custom") : null;
  e.Buffer = o, e.SlowBuffer = y, e.INSPECT_MAX_BYTES = 50;
  const i = 2147483647;
  e.kMaxLength = i, o.TYPED_ARRAY_SUPPORT = a(), !o.TYPED_ARRAY_SUPPORT && typeof console != "undefined" && typeof console.error == "function" && console.error(
    "This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."
  );
  function a() {
    try {
      const I = new Uint8Array(1), A = { foo: function() {
        return 42;
      } };
      return Object.setPrototypeOf(A, Uint8Array.prototype), Object.setPrototypeOf(I, A), I.foo() === 42;
    } catch (I) {
      return !1;
    }
  }
  Object.defineProperty(o.prototype, "parent", {
    enumerable: !0,
    get: function() {
      if (o.isBuffer(this))
        return this.buffer;
    }
  }), Object.defineProperty(o.prototype, "offset", {
    enumerable: !0,
    get: function() {
      if (o.isBuffer(this))
        return this.byteOffset;
    }
  });
  function s(I) {
    if (I > i)
      throw new RangeError('The value "' + I + '" is invalid for option "size"');
    const A = new Uint8Array(I);
    return Object.setPrototypeOf(A, o.prototype), A;
  }
  function o(I, A, T) {
    if (typeof I == "number") {
      if (typeof A == "string")
        throw new TypeError(
          'The "string" argument must be of type string. Received type number'
        );
      return f(I);
    }
    return u(I, A, T);
  }
  o.poolSize = 8192;
  function u(I, A, T) {
    if (typeof I == "string")
      return h(I, A);
    if (ArrayBuffer.isView(I))
      return g(I);
    if (I == null)
      throw new TypeError(
        "The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof I
      );
    if (Se(I, ArrayBuffer) || I && Se(I.buffer, ArrayBuffer) || typeof SharedArrayBuffer != "undefined" && (Se(I, SharedArrayBuffer) || I && Se(I.buffer, SharedArrayBuffer)))
      return v(I, A, T);
    if (typeof I == "number")
      throw new TypeError(
        'The "value" argument must not be of type number. Received type number'
      );
    const P = I.valueOf && I.valueOf();
    if (P != null && P !== I)
      return o.from(P, A, T);
    const z = m(I);
    if (z) return z;
    if (typeof Symbol != "undefined" && Symbol.toPrimitive != null && typeof I[Symbol.toPrimitive] == "function")
      return o.from(I[Symbol.toPrimitive]("string"), A, T);
    throw new TypeError(
      "The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof I
    );
  }
  o.from = function(I, A, T) {
    return u(I, A, T);
  }, Object.setPrototypeOf(o.prototype, Uint8Array.prototype), Object.setPrototypeOf(o, Uint8Array);
  function l(I) {
    if (typeof I != "number")
      throw new TypeError('"size" argument must be of type number');
    if (I < 0)
      throw new RangeError('The value "' + I + '" is invalid for option "size"');
  }
  function c(I, A, T) {
    return l(I), I <= 0 ? s(I) : A !== void 0 ? typeof T == "string" ? s(I).fill(A, T) : s(I).fill(A) : s(I);
  }
  o.alloc = function(I, A, T) {
    return c(I, A, T);
  };
  function f(I) {
    return l(I), s(I < 0 ? 0 : p(I) | 0);
  }
  o.allocUnsafe = function(I) {
    return f(I);
  }, o.allocUnsafeSlow = function(I) {
    return f(I);
  };
  function h(I, A) {
    if ((typeof A != "string" || A === "") && (A = "utf8"), !o.isEncoding(A))
      throw new TypeError("Unknown encoding: " + A);
    const T = w(I, A) | 0;
    let P = s(T);
    const z = P.write(I, A);
    return z !== T && (P = P.slice(0, z)), P;
  }
  function d(I) {
    const A = I.length < 0 ? 0 : p(I.length) | 0, T = s(A);
    for (let P = 0; P < A; P += 1)
      T[P] = I[P] & 255;
    return T;
  }
  function g(I) {
    if (Se(I, Uint8Array)) {
      const A = new Uint8Array(I);
      return v(A.buffer, A.byteOffset, A.byteLength);
    }
    return d(I);
  }
  function v(I, A, T) {
    if (A < 0 || I.byteLength < A)
      throw new RangeError('"offset" is outside of buffer bounds');
    if (I.byteLength < A + (T || 0))
      throw new RangeError('"length" is outside of buffer bounds');
    let P;
    return A === void 0 && T === void 0 ? P = new Uint8Array(I) : T === void 0 ? P = new Uint8Array(I, A) : P = new Uint8Array(I, A, T), Object.setPrototypeOf(P, o.prototype), P;
  }
  function m(I) {
    if (o.isBuffer(I)) {
      const A = p(I.length) | 0, T = s(A);
      return T.length === 0 || I.copy(T, 0, 0, A), T;
    }
    if (I.length !== void 0)
      return typeof I.length != "number" || fe(I.length) ? s(0) : d(I);
    if (I.type === "Buffer" && Array.isArray(I.data))
      return d(I.data);
  }
  function p(I) {
    if (I >= i)
      throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + i.toString(16) + " bytes");
    return I | 0;
  }
  function y(I) {
    return +I != I && (I = 0), o.alloc(+I);
  }
  o.isBuffer = function(A) {
    return A != null && A._isBuffer === !0 && A !== o.prototype;
  }, o.compare = function(A, T) {
    if (Se(A, Uint8Array) && (A = o.from(A, A.offset, A.byteLength)), Se(T, Uint8Array) && (T = o.from(T, T.offset, T.byteLength)), !o.isBuffer(A) || !o.isBuffer(T))
      throw new TypeError(
        'The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array'
      );
    if (A === T) return 0;
    let P = A.length, z = T.length;
    for (let K = 0, oe = Math.min(P, z); K < oe; ++K)
      if (A[K] !== T[K]) {
        P = A[K], z = T[K];
        break;
      }
    return P < z ? -1 : z < P ? 1 : 0;
  }, o.isEncoding = function(A) {
    switch (String(A).toLowerCase()) {
      case "hex":
      case "utf8":
      case "utf-8":
      case "ascii":
      case "latin1":
      case "binary":
      case "base64":
      case "ucs2":
      case "ucs-2":
      case "utf16le":
      case "utf-16le":
        return !0;
      default:
        return !1;
    }
  }, o.concat = function(A, T) {
    if (!Array.isArray(A))
      throw new TypeError('"list" argument must be an Array of Buffers');
    if (A.length === 0)
      return o.alloc(0);
    let P;
    if (T === void 0)
      for (T = 0, P = 0; P < A.length; ++P)
        T += A[P].length;
    const z = o.allocUnsafe(T);
    let K = 0;
    for (P = 0; P < A.length; ++P) {
      let oe = A[P];
      if (Se(oe, Uint8Array))
        K + oe.length > z.length ? (o.isBuffer(oe) || (oe = o.from(oe)), oe.copy(z, K)) : Uint8Array.prototype.set.call(
          z,
          oe,
          K
        );
      else if (o.isBuffer(oe))
        oe.copy(z, K);
      else
        throw new TypeError('"list" argument must be an Array of Buffers');
      K += oe.length;
    }
    return z;
  };
  function w(I, A) {
    if (o.isBuffer(I))
      return I.length;
    if (ArrayBuffer.isView(I) || Se(I, ArrayBuffer))
      return I.byteLength;
    if (typeof I != "string")
      throw new TypeError(
        'The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type ' + typeof I
      );
    const T = I.length, P = arguments.length > 2 && arguments[2] === !0;
    if (!P && T === 0) return 0;
    let z = !1;
    for (; ; )
      switch (A) {
        case "ascii":
        case "latin1":
        case "binary":
          return T;
        case "utf8":
        case "utf-8":
          return Y(I).length;
        case "ucs2":
        case "ucs-2":
        case "utf16le":
        case "utf-16le":
          return T * 2;
        case "hex":
          return T >>> 1;
        case "base64":
          return ye(I).length;
        default:
          if (z)
            return P ? -1 : Y(I).length;
          A = ("" + A).toLowerCase(), z = !0;
      }
  }
  o.byteLength = w;
  function x(I, A, T) {
    let P = !1;
    if ((A === void 0 || A < 0) && (A = 0), A > this.length || ((T === void 0 || T > this.length) && (T = this.length), T <= 0) || (T >>>= 0, A >>>= 0, T <= A))
      return "";
    for (I || (I = "utf8"); ; )
      switch (I) {
        case "hex":
          return R(this, A, T);
        case "utf8":
        case "utf-8":
          return L(this, A, T);
        case "ascii":
          return H(this, A, T);
        case "latin1":
        case "binary":
          return U(this, A, T);
        case "base64":
          return _(this, A, T);
        case "ucs2":
        case "ucs-2":
        case "utf16le":
        case "utf-16le":
          return B(this, A, T);
        default:
          if (P) throw new TypeError("Unknown encoding: " + I);
          I = (I + "").toLowerCase(), P = !0;
      }
  }
  o.prototype._isBuffer = !0;
  function b(I, A, T) {
    const P = I[A];
    I[A] = I[T], I[T] = P;
  }
  o.prototype.swap16 = function() {
    const A = this.length;
    if (A % 2 !== 0)
      throw new RangeError("Buffer size must be a multiple of 16-bits");
    for (let T = 0; T < A; T += 2)
      b(this, T, T + 1);
    return this;
  }, o.prototype.swap32 = function() {
    const A = this.length;
    if (A % 4 !== 0)
      throw new RangeError("Buffer size must be a multiple of 32-bits");
    for (let T = 0; T < A; T += 4)
      b(this, T, T + 3), b(this, T + 1, T + 2);
    return this;
  }, o.prototype.swap64 = function() {
    const A = this.length;
    if (A % 8 !== 0)
      throw new RangeError("Buffer size must be a multiple of 64-bits");
    for (let T = 0; T < A; T += 8)
      b(this, T, T + 7), b(this, T + 1, T + 6), b(this, T + 2, T + 5), b(this, T + 3, T + 4);
    return this;
  }, o.prototype.toString = function() {
    const A = this.length;
    return A === 0 ? "" : arguments.length === 0 ? L(this, 0, A) : x.apply(this, arguments);
  }, o.prototype.toLocaleString = o.prototype.toString, o.prototype.equals = function(A) {
    if (!o.isBuffer(A)) throw new TypeError("Argument must be a Buffer");
    return this === A ? !0 : o.compare(this, A) === 0;
  }, o.prototype.inspect = function() {
    let A = "";
    const T = e.INSPECT_MAX_BYTES;
    return A = this.toString("hex", 0, T).replace(/(.{2})/g, "$1 ").trim(), this.length > T && (A += " ... "), "<Buffer " + A + ">";
  }, n && (o.prototype[n] = o.prototype.inspect), o.prototype.compare = function(A, T, P, z, K) {
    if (Se(A, Uint8Array) && (A = o.from(A, A.offset, A.byteLength)), !o.isBuffer(A))
      throw new TypeError(
        'The "target" argument must be one of type Buffer or Uint8Array. Received type ' + typeof A
      );
    if (T === void 0 && (T = 0), P === void 0 && (P = A ? A.length : 0), z === void 0 && (z = 0), K === void 0 && (K = this.length), T < 0 || P > A.length || z < 0 || K > this.length)
      throw new RangeError("out of range index");
    if (z >= K && T >= P)
      return 0;
    if (z >= K)
      return -1;
    if (T >= P)
      return 1;
    if (T >>>= 0, P >>>= 0, z >>>= 0, K >>>= 0, this === A) return 0;
    let oe = K - z, ce = P - T;
    const ge = Math.min(oe, ce), Oe = this.slice(z, K), Ge = A.slice(T, P);
    for (let We = 0; We < ge; ++We)
      if (Oe[We] !== Ge[We]) {
        oe = Oe[We], ce = Ge[We];
        break;
      }
    return oe < ce ? -1 : ce < oe ? 1 : 0;
  };
  function M(I, A, T, P, z) {
    if (I.length === 0) return -1;
    if (typeof T == "string" ? (P = T, T = 0) : T > 2147483647 ? T = 2147483647 : T < -2147483648 && (T = -2147483648), T = +T, fe(T) && (T = z ? 0 : I.length - 1), T < 0 && (T = I.length + T), T >= I.length) {
      if (z) return -1;
      T = I.length - 1;
    } else if (T < 0)
      if (z) T = 0;
      else return -1;
    if (typeof A == "string" && (A = o.from(A, P)), o.isBuffer(A))
      return A.length === 0 ? -1 : k(I, A, T, P, z);
    if (typeof A == "number")
      return A = A & 255, typeof Uint8Array.prototype.indexOf == "function" ? z ? Uint8Array.prototype.indexOf.call(I, A, T) : Uint8Array.prototype.lastIndexOf.call(I, A, T) : k(I, [A], T, P, z);
    throw new TypeError("val must be string, number or Buffer");
  }
  function k(I, A, T, P, z) {
    let K = 1, oe = I.length, ce = A.length;
    if (P !== void 0 && (P = String(P).toLowerCase(), P === "ucs2" || P === "ucs-2" || P === "utf16le" || P === "utf-16le")) {
      if (I.length < 2 || A.length < 2)
        return -1;
      K = 2, oe /= 2, ce /= 2, T /= 2;
    }
    function ge(Ge, We) {
      return K === 1 ? Ge[We] : Ge.readUInt16BE(We * K);
    }
    let Oe;
    if (z) {
      let Ge = -1;
      for (Oe = T; Oe < oe; Oe++)
        if (ge(I, Oe) === ge(A, Ge === -1 ? 0 : Oe - Ge)) {
          if (Ge === -1 && (Ge = Oe), Oe - Ge + 1 === ce) return Ge * K;
        } else
          Ge !== -1 && (Oe -= Oe - Ge), Ge = -1;
    } else
      for (T + ce > oe && (T = oe - ce), Oe = T; Oe >= 0; Oe--) {
        let Ge = !0;
        for (let We = 0; We < ce; We++)
          if (ge(I, Oe + We) !== ge(A, We)) {
            Ge = !1;
            break;
          }
        if (Ge) return Oe;
      }
    return -1;
  }
  o.prototype.includes = function(A, T, P) {
    return this.indexOf(A, T, P) !== -1;
  }, o.prototype.indexOf = function(A, T, P) {
    return M(this, A, T, P, !0);
  }, o.prototype.lastIndexOf = function(A, T, P) {
    return M(this, A, T, P, !1);
  };
  function E(I, A, T, P) {
    T = Number(T) || 0;
    const z = I.length - T;
    P ? (P = Number(P), P > z && (P = z)) : P = z;
    const K = A.length;
    P > K / 2 && (P = K / 2);
    let oe;
    for (oe = 0; oe < P; ++oe) {
      const ce = parseInt(A.substr(oe * 2, 2), 16);
      if (fe(ce)) return oe;
      I[T + oe] = ce;
    }
    return oe;
  }
  function S(I, A, T, P) {
    return De(Y(A, I.length - T), I, T, P);
  }
  function F(I, A, T, P) {
    return De(ee(A), I, T, P);
  }
  function O(I, A, T, P) {
    return De(ye(A), I, T, P);
  }
  function D(I, A, T, P) {
    return De(Me(A, I.length - T), I, T, P);
  }
  o.prototype.write = function(A, T, P, z) {
    if (T === void 0)
      z = "utf8", P = this.length, T = 0;
    else if (P === void 0 && typeof T == "string")
      z = T, P = this.length, T = 0;
    else if (isFinite(T))
      T = T >>> 0, isFinite(P) ? (P = P >>> 0, z === void 0 && (z = "utf8")) : (z = P, P = void 0);
    else
      throw new Error(
        "Buffer.write(string, encoding, offset[, length]) is no longer supported"
      );
    const K = this.length - T;
    if ((P === void 0 || P > K) && (P = K), A.length > 0 && (P < 0 || T < 0) || T > this.length)
      throw new RangeError("Attempt to write outside buffer bounds");
    z || (z = "utf8");
    let oe = !1;
    for (; ; )
      switch (z) {
        case "hex":
          return E(this, A, T, P);
        case "utf8":
        case "utf-8":
          return S(this, A, T, P);
        case "ascii":
        case "latin1":
        case "binary":
          return F(this, A, T, P);
        case "base64":
          return O(this, A, T, P);
        case "ucs2":
        case "ucs-2":
        case "utf16le":
        case "utf-16le":
          return D(this, A, T, P);
        default:
          if (oe) throw new TypeError("Unknown encoding: " + z);
          z = ("" + z).toLowerCase(), oe = !0;
      }
  }, o.prototype.toJSON = function() {
    return {
      type: "Buffer",
      data: Array.prototype.slice.call(this._arr || this, 0)
    };
  };
  function _(I, A, T) {
    return A === 0 && T === I.length ? t.fromByteArray(I) : t.fromByteArray(I.slice(A, T));
  }
  function L(I, A, T) {
    T = Math.min(I.length, T);
    const P = [];
    let z = A;
    for (; z < T; ) {
      const K = I[z];
      let oe = null, ce = K > 239 ? 4 : K > 223 ? 3 : K > 191 ? 2 : 1;
      if (z + ce <= T) {
        let ge, Oe, Ge, We;
        switch (ce) {
          case 1:
            K < 128 && (oe = K);
            break;
          case 2:
            ge = I[z + 1], (ge & 192) === 128 && (We = (K & 31) << 6 | ge & 63, We > 127 && (oe = We));
            break;
          case 3:
            ge = I[z + 1], Oe = I[z + 2], (ge & 192) === 128 && (Oe & 192) === 128 && (We = (K & 15) << 12 | (ge & 63) << 6 | Oe & 63, We > 2047 && (We < 55296 || We > 57343) && (oe = We));
            break;
          case 4:
            ge = I[z + 1], Oe = I[z + 2], Ge = I[z + 3], (ge & 192) === 128 && (Oe & 192) === 128 && (Ge & 192) === 128 && (We = (K & 15) << 18 | (ge & 63) << 12 | (Oe & 63) << 6 | Ge & 63, We > 65535 && We < 1114112 && (oe = We));
        }
      }
      oe === null ? (oe = 65533, ce = 1) : oe > 65535 && (oe -= 65536, P.push(oe >>> 10 & 1023 | 55296), oe = 56320 | oe & 1023), P.push(oe), z += ce;
    }
    return V(P);
  }
  const G = 4096;
  function V(I) {
    const A = I.length;
    if (A <= G)
      return String.fromCharCode.apply(String, I);
    let T = "", P = 0;
    for (; P < A; )
      T += String.fromCharCode.apply(
        String,
        I.slice(P, P += G)
      );
    return T;
  }
  function H(I, A, T) {
    let P = "";
    T = Math.min(I.length, T);
    for (let z = A; z < T; ++z)
      P += String.fromCharCode(I[z] & 127);
    return P;
  }
  function U(I, A, T) {
    let P = "";
    T = Math.min(I.length, T);
    for (let z = A; z < T; ++z)
      P += String.fromCharCode(I[z]);
    return P;
  }
  function R(I, A, T) {
    const P = I.length;
    (!A || A < 0) && (A = 0), (!T || T < 0 || T > P) && (T = P);
    let z = "";
    for (let K = A; K < T; ++K)
      z += ke[I[K]];
    return z;
  }
  function B(I, A, T) {
    const P = I.slice(A, T);
    let z = "";
    for (let K = 0; K < P.length - 1; K += 2)
      z += String.fromCharCode(P[K] + P[K + 1] * 256);
    return z;
  }
  o.prototype.slice = function(A, T) {
    const P = this.length;
    A = ~~A, T = T === void 0 ? P : ~~T, A < 0 ? (A += P, A < 0 && (A = 0)) : A > P && (A = P), T < 0 ? (T += P, T < 0 && (T = 0)) : T > P && (T = P), T < A && (T = A);
    const z = this.subarray(A, T);
    return Object.setPrototypeOf(z, o.prototype), z;
  };
  function C(I, A, T) {
    if (I % 1 !== 0 || I < 0) throw new RangeError("offset is not uint");
    if (I + A > T) throw new RangeError("Trying to access beyond buffer length");
  }
  o.prototype.readUintLE = o.prototype.readUIntLE = function(A, T, P) {
    A = A >>> 0, T = T >>> 0, P || C(A, T, this.length);
    let z = this[A], K = 1, oe = 0;
    for (; ++oe < T && (K *= 256); )
      z += this[A + oe] * K;
    return z;
  }, o.prototype.readUintBE = o.prototype.readUIntBE = function(A, T, P) {
    A = A >>> 0, T = T >>> 0, P || C(A, T, this.length);
    let z = this[A + --T], K = 1;
    for (; T > 0 && (K *= 256); )
      z += this[A + --T] * K;
    return z;
  }, o.prototype.readUint8 = o.prototype.readUInt8 = function(A, T) {
    return A = A >>> 0, T || C(A, 1, this.length), this[A];
  }, o.prototype.readUint16LE = o.prototype.readUInt16LE = function(A, T) {
    return A = A >>> 0, T || C(A, 2, this.length), this[A] | this[A + 1] << 8;
  }, o.prototype.readUint16BE = o.prototype.readUInt16BE = function(A, T) {
    return A = A >>> 0, T || C(A, 2, this.length), this[A] << 8 | this[A + 1];
  }, o.prototype.readUint32LE = o.prototype.readUInt32LE = function(A, T) {
    return A = A >>> 0, T || C(A, 4, this.length), (this[A] | this[A + 1] << 8 | this[A + 2] << 16) + this[A + 3] * 16777216;
  }, o.prototype.readUint32BE = o.prototype.readUInt32BE = function(A, T) {
    return A = A >>> 0, T || C(A, 4, this.length), this[A] * 16777216 + (this[A + 1] << 16 | this[A + 2] << 8 | this[A + 3]);
  }, o.prototype.readBigUInt64LE = ne(function(A) {
    A = A >>> 0, me(A, "offset");
    const T = this[A], P = this[A + 7];
    (T === void 0 || P === void 0) && Ae(A, this.length - 8);
    const z = T + this[++A] * lr(2, 8) + this[++A] * lr(2, 16) + this[++A] * lr(2, 24), K = this[++A] + this[++A] * lr(2, 8) + this[++A] * lr(2, 16) + P * lr(2, 24);
    return BigInt(z) + (BigInt(K) << BigInt(32));
  }), o.prototype.readBigUInt64BE = ne(function(A) {
    A = A >>> 0, me(A, "offset");
    const T = this[A], P = this[A + 7];
    (T === void 0 || P === void 0) && Ae(A, this.length - 8);
    const z = T * lr(2, 24) + this[++A] * lr(2, 16) + this[++A] * lr(2, 8) + this[++A], K = this[++A] * lr(2, 24) + this[++A] * lr(2, 16) + this[++A] * lr(2, 8) + P;
    return (BigInt(z) << BigInt(32)) + BigInt(K);
  }), o.prototype.readIntLE = function(A, T, P) {
    A = A >>> 0, T = T >>> 0, P || C(A, T, this.length);
    let z = this[A], K = 1, oe = 0;
    for (; ++oe < T && (K *= 256); )
      z += this[A + oe] * K;
    return K *= 128, z >= K && (z -= Math.pow(2, 8 * T)), z;
  }, o.prototype.readIntBE = function(A, T, P) {
    A = A >>> 0, T = T >>> 0, P || C(A, T, this.length);
    let z = T, K = 1, oe = this[A + --z];
    for (; z > 0 && (K *= 256); )
      oe += this[A + --z] * K;
    return K *= 128, oe >= K && (oe -= Math.pow(2, 8 * T)), oe;
  }, o.prototype.readInt8 = function(A, T) {
    return A = A >>> 0, T || C(A, 1, this.length), this[A] & 128 ? (255 - this[A] + 1) * -1 : this[A];
  }, o.prototype.readInt16LE = function(A, T) {
    A = A >>> 0, T || C(A, 2, this.length);
    const P = this[A] | this[A + 1] << 8;
    return P & 32768 ? P | 4294901760 : P;
  }, o.prototype.readInt16BE = function(A, T) {
    A = A >>> 0, T || C(A, 2, this.length);
    const P = this[A + 1] | this[A] << 8;
    return P & 32768 ? P | 4294901760 : P;
  }, o.prototype.readInt32LE = function(A, T) {
    return A = A >>> 0, T || C(A, 4, this.length), this[A] | this[A + 1] << 8 | this[A + 2] << 16 | this[A + 3] << 24;
  }, o.prototype.readInt32BE = function(A, T) {
    return A = A >>> 0, T || C(A, 4, this.length), this[A] << 24 | this[A + 1] << 16 | this[A + 2] << 8 | this[A + 3];
  }, o.prototype.readBigInt64LE = ne(function(A) {
    A = A >>> 0, me(A, "offset");
    const T = this[A], P = this[A + 7];
    (T === void 0 || P === void 0) && Ae(A, this.length - 8);
    const z = this[A + 4] + this[A + 5] * lr(2, 8) + this[A + 6] * lr(2, 16) + (P << 24);
    return (BigInt(z) << BigInt(32)) + BigInt(T + this[++A] * lr(2, 8) + this[++A] * lr(2, 16) + this[++A] * lr(2, 24));
  }), o.prototype.readBigInt64BE = ne(function(A) {
    A = A >>> 0, me(A, "offset");
    const T = this[A], P = this[A + 7];
    (T === void 0 || P === void 0) && Ae(A, this.length - 8);
    const z = (T << 24) + // Overflow
    this[++A] * lr(2, 16) + this[++A] * lr(2, 8) + this[++A];
    return (BigInt(z) << BigInt(32)) + BigInt(this[++A] * lr(2, 24) + this[++A] * lr(2, 16) + this[++A] * lr(2, 8) + P);
  }), o.prototype.readFloatLE = function(A, T) {
    return A = A >>> 0, T || C(A, 4, this.length), r.read(this, A, !0, 23, 4);
  }, o.prototype.readFloatBE = function(A, T) {
    return A = A >>> 0, T || C(A, 4, this.length), r.read(this, A, !1, 23, 4);
  }, o.prototype.readDoubleLE = function(A, T) {
    return A = A >>> 0, T || C(A, 8, this.length), r.read(this, A, !0, 52, 8);
  }, o.prototype.readDoubleBE = function(A, T) {
    return A = A >>> 0, T || C(A, 8, this.length), r.read(this, A, !1, 52, 8);
  };
  function Z(I, A, T, P, z, K) {
    if (!o.isBuffer(I)) throw new TypeError('"buffer" argument must be a Buffer instance');
    if (A > z || A < K) throw new RangeError('"value" argument is out of bounds');
    if (T + P > I.length) throw new RangeError("Index out of range");
  }
  o.prototype.writeUintLE = o.prototype.writeUIntLE = function(A, T, P, z) {
    if (A = +A, T = T >>> 0, P = P >>> 0, !z) {
      const ce = Math.pow(2, 8 * P) - 1;
      Z(this, A, T, P, ce, 0);
    }
    let K = 1, oe = 0;
    for (this[T] = A & 255; ++oe < P && (K *= 256); )
      this[T + oe] = A / K & 255;
    return T + P;
  }, o.prototype.writeUintBE = o.prototype.writeUIntBE = function(A, T, P, z) {
    if (A = +A, T = T >>> 0, P = P >>> 0, !z) {
      const ce = Math.pow(2, 8 * P) - 1;
      Z(this, A, T, P, ce, 0);
    }
    let K = P - 1, oe = 1;
    for (this[T + K] = A & 255; --K >= 0 && (oe *= 256); )
      this[T + K] = A / oe & 255;
    return T + P;
  }, o.prototype.writeUint8 = o.prototype.writeUInt8 = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 1, 255, 0), this[T] = A & 255, T + 1;
  }, o.prototype.writeUint16LE = o.prototype.writeUInt16LE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 2, 65535, 0), this[T] = A & 255, this[T + 1] = A >>> 8, T + 2;
  }, o.prototype.writeUint16BE = o.prototype.writeUInt16BE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 2, 65535, 0), this[T] = A >>> 8, this[T + 1] = A & 255, T + 2;
  }, o.prototype.writeUint32LE = o.prototype.writeUInt32LE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 4, 4294967295, 0), this[T + 3] = A >>> 24, this[T + 2] = A >>> 16, this[T + 1] = A >>> 8, this[T] = A & 255, T + 4;
  }, o.prototype.writeUint32BE = o.prototype.writeUInt32BE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 4, 4294967295, 0), this[T] = A >>> 24, this[T + 1] = A >>> 16, this[T + 2] = A >>> 8, this[T + 3] = A & 255, T + 4;
  };
  function W(I, A, T, P, z) {
    ve(A, P, z, I, T, 7);
    let K = Number(A & BigInt(4294967295));
    I[T++] = K, K = K >> 8, I[T++] = K, K = K >> 8, I[T++] = K, K = K >> 8, I[T++] = K;
    let oe = Number(A >> BigInt(32) & BigInt(4294967295));
    return I[T++] = oe, oe = oe >> 8, I[T++] = oe, oe = oe >> 8, I[T++] = oe, oe = oe >> 8, I[T++] = oe, T;
  }
  function J(I, A, T, P, z) {
    ve(A, P, z, I, T, 7);
    let K = Number(A & BigInt(4294967295));
    I[T + 7] = K, K = K >> 8, I[T + 6] = K, K = K >> 8, I[T + 5] = K, K = K >> 8, I[T + 4] = K;
    let oe = Number(A >> BigInt(32) & BigInt(4294967295));
    return I[T + 3] = oe, oe = oe >> 8, I[T + 2] = oe, oe = oe >> 8, I[T + 1] = oe, oe = oe >> 8, I[T] = oe, T + 8;
  }
  o.prototype.writeBigUInt64LE = ne(function(A, T = 0) {
    return W(this, A, T, BigInt(0), BigInt("0xffffffffffffffff"));
  }), o.prototype.writeBigUInt64BE = ne(function(A, T = 0) {
    return J(this, A, T, BigInt(0), BigInt("0xffffffffffffffff"));
  }), o.prototype.writeIntLE = function(A, T, P, z) {
    if (A = +A, T = T >>> 0, !z) {
      const ge = Math.pow(2, 8 * P - 1);
      Z(this, A, T, P, ge - 1, -ge);
    }
    let K = 0, oe = 1, ce = 0;
    for (this[T] = A & 255; ++K < P && (oe *= 256); )
      A < 0 && ce === 0 && this[T + K - 1] !== 0 && (ce = 1), this[T + K] = (A / oe >> 0) - ce & 255;
    return T + P;
  }, o.prototype.writeIntBE = function(A, T, P, z) {
    if (A = +A, T = T >>> 0, !z) {
      const ge = Math.pow(2, 8 * P - 1);
      Z(this, A, T, P, ge - 1, -ge);
    }
    let K = P - 1, oe = 1, ce = 0;
    for (this[T + K] = A & 255; --K >= 0 && (oe *= 256); )
      A < 0 && ce === 0 && this[T + K + 1] !== 0 && (ce = 1), this[T + K] = (A / oe >> 0) - ce & 255;
    return T + P;
  }, o.prototype.writeInt8 = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 1, 127, -128), A < 0 && (A = 255 + A + 1), this[T] = A & 255, T + 1;
  }, o.prototype.writeInt16LE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 2, 32767, -32768), this[T] = A & 255, this[T + 1] = A >>> 8, T + 2;
  }, o.prototype.writeInt16BE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 2, 32767, -32768), this[T] = A >>> 8, this[T + 1] = A & 255, T + 2;
  }, o.prototype.writeInt32LE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 4, 2147483647, -2147483648), this[T] = A & 255, this[T + 1] = A >>> 8, this[T + 2] = A >>> 16, this[T + 3] = A >>> 24, T + 4;
  }, o.prototype.writeInt32BE = function(A, T, P) {
    return A = +A, T = T >>> 0, P || Z(this, A, T, 4, 2147483647, -2147483648), A < 0 && (A = 4294967295 + A + 1), this[T] = A >>> 24, this[T + 1] = A >>> 16, this[T + 2] = A >>> 8, this[T + 3] = A & 255, T + 4;
  }, o.prototype.writeBigInt64LE = ne(function(A, T = 0) {
    return W(this, A, T, -BigInt("0x8000000000000000"), BigInt("0x7fffffffffffffff"));
  }), o.prototype.writeBigInt64BE = ne(function(A, T = 0) {
    return J(this, A, T, -BigInt("0x8000000000000000"), BigInt("0x7fffffffffffffff"));
  });
  function Q(I, A, T, P, z, K) {
    if (T + P > I.length) throw new RangeError("Index out of range");
    if (T < 0) throw new RangeError("Index out of range");
  }
  function j(I, A, T, P, z) {
    return A = +A, T = T >>> 0, z || Q(I, A, T, 4), r.write(I, A, T, P, 23, 4), T + 4;
  }
  o.prototype.writeFloatLE = function(A, T, P) {
    return j(this, A, T, !0, P);
  }, o.prototype.writeFloatBE = function(A, T, P) {
    return j(this, A, T, !1, P);
  };
  function q(I, A, T, P, z) {
    return A = +A, T = T >>> 0, z || Q(I, A, T, 8), r.write(I, A, T, P, 52, 8), T + 8;
  }
  o.prototype.writeDoubleLE = function(A, T, P) {
    return q(this, A, T, !0, P);
  }, o.prototype.writeDoubleBE = function(A, T, P) {
    return q(this, A, T, !1, P);
  }, o.prototype.copy = function(A, T, P, z) {
    if (!o.isBuffer(A)) throw new TypeError("argument should be a Buffer");
    if (P || (P = 0), !z && z !== 0 && (z = this.length), T >= A.length && (T = A.length), T || (T = 0), z > 0 && z < P && (z = P), z === P || A.length === 0 || this.length === 0) return 0;
    if (T < 0)
      throw new RangeError("targetStart out of bounds");
    if (P < 0 || P >= this.length) throw new RangeError("Index out of range");
    if (z < 0) throw new RangeError("sourceEnd out of bounds");
    z > this.length && (z = this.length), A.length - T < z - P && (z = A.length - T + P);
    const K = z - P;
    return this === A && typeof Uint8Array.prototype.copyWithin == "function" ? this.copyWithin(T, P, z) : Uint8Array.prototype.set.call(
      A,
      this.subarray(P, z),
      T
    ), K;
  }, o.prototype.fill = function(A, T, P, z) {
    if (typeof A == "string") {
      if (typeof T == "string" ? (z = T, T = 0, P = this.length) : typeof P == "string" && (z = P, P = this.length), z !== void 0 && typeof z != "string")
        throw new TypeError("encoding must be a string");
      if (typeof z == "string" && !o.isEncoding(z))
        throw new TypeError("Unknown encoding: " + z);
      if (A.length === 1) {
        const oe = A.charCodeAt(0);
        (z === "utf8" && oe < 128 || z === "latin1") && (A = oe);
      }
    } else typeof A == "number" ? A = A & 255 : typeof A == "boolean" && (A = Number(A));
    if (T < 0 || this.length < T || this.length < P)
      throw new RangeError("Out of range index");
    if (P <= T)
      return this;
    T = T >>> 0, P = P === void 0 ? this.length : P >>> 0, A || (A = 0);
    let K;
    if (typeof A == "number")
      for (K = T; K < P; ++K)
        this[K] = A;
    else {
      const oe = o.isBuffer(A) ? A : o.from(A, z), ce = oe.length;
      if (ce === 0)
        throw new TypeError('The value "' + A + '" is invalid for argument "value"');
      for (K = 0; K < P - T; ++K)
        this[K + T] = oe[K % ce];
    }
    return this;
  };
  const ae = {};
  function pe(I, A, T) {
    ae[I] = class extends T {
      constructor() {
        super(), Object.defineProperty(this, "message", {
          value: A.apply(this, arguments),
          writable: !0,
          configurable: !0
        }), this.name = `${this.name} [${I}]`, this.stack, delete this.name;
      }
      get code() {
        return I;
      }
      set code(z) {
        Object.defineProperty(this, "code", {
          configurable: !0,
          enumerable: !0,
          value: z,
          writable: !0
        });
      }
      toString() {
        return `${this.name} [${I}]: ${this.message}`;
      }
    };
  }
  pe(
    "ERR_BUFFER_OUT_OF_BOUNDS",
    function(I) {
      return I ? `${I} is outside of buffer bounds` : "Attempt to access memory outside buffer bounds";
    },
    RangeError
  ), pe(
    "ERR_INVALID_ARG_TYPE",
    function(I, A) {
      return `The "${I}" argument must be of type number. Received type ${typeof A}`;
    },
    TypeError
  ), pe(
    "ERR_OUT_OF_RANGE",
    function(I, A, T) {
      let P = `The value of "${I}" is out of range.`, z = T;
      return Number.isInteger(T) && Math.abs(T) > lr(2, 32) ? z = $(String(T)) : typeof T == "bigint" && (z = String(T), (T > lr(BigInt(2), BigInt(32)) || T < -lr(BigInt(2), BigInt(32))) && (z = $(z)), z += "n"), P += ` It must be ${A}. Received ${z}`, P;
    },
    RangeError
  );
  function $(I) {
    let A = "", T = I.length;
    const P = I[0] === "-" ? 1 : 0;
    for (; T >= P + 4; T -= 3)
      A = `_${I.slice(T - 3, T)}${A}`;
    return `${I.slice(0, T)}${A}`;
  }
  function se(I, A, T) {
    me(A, "offset"), (I[A] === void 0 || I[A + T] === void 0) && Ae(A, I.length - (T + 1));
  }
  function ve(I, A, T, P, z, K) {
    if (I > T || I < A) {
      const oe = typeof A == "bigint" ? "n" : "";
      let ce;
      throw A === 0 || A === BigInt(0) ? ce = `>= 0${oe} and < 2${oe} ** ${(K + 1) * 8}${oe}` : ce = `>= -(2${oe} ** ${(K + 1) * 8 - 1}${oe}) and < 2 ** ${(K + 1) * 8 - 1}${oe}`, new ae.ERR_OUT_OF_RANGE("value", ce, I);
    }
    se(P, z, K);
  }
  function me(I, A) {
    if (typeof I != "number")
      throw new ae.ERR_INVALID_ARG_TYPE(A, "number", I);
  }
  function Ae(I, A, T) {
    throw Math.floor(I) !== I ? (me(I, T), new ae.ERR_OUT_OF_RANGE("offset", "an integer", I)) : A < 0 ? new ae.ERR_BUFFER_OUT_OF_BOUNDS() : new ae.ERR_OUT_OF_RANGE(
      "offset",
      `>= 0 and <= ${A}`,
      I
    );
  }
  const Ce = /[^+/0-9A-Za-z-_]/g;
  function Ee(I) {
    if (I = I.split("=")[0], I = I.trim().replace(Ce, ""), I.length < 2) return "";
    for (; I.length % 4 !== 0; )
      I = I + "=";
    return I;
  }
  function Y(I, A) {
    A = A || 1 / 0;
    let T;
    const P = I.length;
    let z = null;
    const K = [];
    for (let oe = 0; oe < P; ++oe) {
      if (T = I.charCodeAt(oe), T > 55295 && T < 57344) {
        if (!z) {
          if (T > 56319) {
            (A -= 3) > -1 && K.push(239, 191, 189);
            continue;
          } else if (oe + 1 === P) {
            (A -= 3) > -1 && K.push(239, 191, 189);
            continue;
          }
          z = T;
          continue;
        }
        if (T < 56320) {
          (A -= 3) > -1 && K.push(239, 191, 189), z = T;
          continue;
        }
        T = (z - 55296 << 10 | T - 56320) + 65536;
      } else z && (A -= 3) > -1 && K.push(239, 191, 189);
      if (z = null, T < 128) {
        if ((A -= 1) < 0) break;
        K.push(T);
      } else if (T < 2048) {
        if ((A -= 2) < 0) break;
        K.push(
          T >> 6 | 192,
          T & 63 | 128
        );
      } else if (T < 65536) {
        if ((A -= 3) < 0) break;
        K.push(
          T >> 12 | 224,
          T >> 6 & 63 | 128,
          T & 63 | 128
        );
      } else if (T < 1114112) {
        if ((A -= 4) < 0) break;
        K.push(
          T >> 18 | 240,
          T >> 12 & 63 | 128,
          T >> 6 & 63 | 128,
          T & 63 | 128
        );
      } else
        throw new Error("Invalid code point");
    }
    return K;
  }
  function ee(I) {
    const A = [];
    for (let T = 0; T < I.length; ++T)
      A.push(I.charCodeAt(T) & 255);
    return A;
  }
  function Me(I, A) {
    let T, P, z;
    const K = [];
    for (let oe = 0; oe < I.length && !((A -= 2) < 0); ++oe)
      T = I.charCodeAt(oe), P = T >> 8, z = T % 256, K.push(z), K.push(P);
    return K;
  }
  function ye(I) {
    return t.toByteArray(Ee(I));
  }
  function De(I, A, T, P) {
    let z;
    for (z = 0; z < P && !(z + T >= A.length || z >= I.length); ++z)
      A[z + T] = I[z];
    return z;
  }
  function Se(I, A) {
    return I instanceof A || I != null && I.constructor != null && I.constructor.name != null && I.constructor.name === A.name;
  }
  function fe(I) {
    return I !== I;
  }
  const ke = function() {
    const I = "0123456789abcdef", A = new Array(256);
    for (let T = 0; T < 16; ++T) {
      const P = T * 16;
      for (let z = 0; z < 16; ++z)
        A[P + z] = I[T] + I[z];
    }
    return A;
  }();
  function ne(I) {
    return typeof BigInt == "undefined" ? Te : I;
  }
  function Te() {
    throw new Error("BigInt not supported");
  }
})(Ts);
function T0(e, t, r, n, i, a, s) {
  try {
    var o = e[a](s), u = o.value;
  } catch (l) {
    r(l);
    return;
  }
  o.done ? t(u) : Promise.resolve(u).then(n, i);
}
function ut(e) {
  return function() {
    var t = this, r = arguments;
    return new Promise(function(n, i) {
      var a = e.apply(t, r);
      function s(u) {
        T0(a, n, i, s, o, "next", u);
      }
      function o(u) {
        T0(a, n, i, s, o, "throw", u);
      }
      s(void 0);
    });
  };
}
var Iy = { exports: {} }, Ry = { exports: {} };
(function(e) {
  function t(r) {
    "@babel/helpers - typeof";
    return e.exports = t = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(n) {
      return typeof n;
    } : function(n) {
      return n && typeof Symbol == "function" && n.constructor === Symbol && n !== Symbol.prototype ? "symbol" : typeof n;
    }, e.exports.__esModule = !0, e.exports.default = e.exports, t(r);
  }
  e.exports = t, e.exports.__esModule = !0, e.exports.default = e.exports;
})(Ry);
(function(e) {
  var t = Ry.exports.default;
  function r() {
    e.exports = r = function() {
      return i;
    }, e.exports.__esModule = !0, e.exports.default = e.exports;
    var n, i = {}, a = Object.prototype, s = a.hasOwnProperty, o = Object.defineProperty || function(R, B, C) {
      R[B] = C.value;
    }, u = typeof Symbol == "function" ? Symbol : {}, l = u.iterator || "@@iterator", c = u.asyncIterator || "@@asyncIterator", f = u.toStringTag || "@@toStringTag";
    function h(R, B, C) {
      return Object.defineProperty(R, B, {
        value: C,
        enumerable: !0,
        configurable: !0,
        writable: !0
      }), R[B];
    }
    try {
      h({}, "");
    } catch (R) {
      h = function(C, Z, W) {
        return C[Z] = W;
      };
    }
    function d(R, B, C, Z) {
      var W = B && B.prototype instanceof x ? B : x, J = Object.create(W.prototype), Q = new H(Z || []);
      return o(J, "_invoke", {
        value: _(R, C, Q)
      }), J;
    }
    function g(R, B, C) {
      try {
        return {
          type: "normal",
          arg: R.call(B, C)
        };
      } catch (Z) {
        return {
          type: "throw",
          arg: Z
        };
      }
    }
    i.wrap = d;
    var v = "suspendedStart", m = "suspendedYield", p = "executing", y = "completed", w = {};
    function x() {
    }
    function b() {
    }
    function M() {
    }
    var k = {};
    h(k, l, function() {
      return this;
    });
    var E = Object.getPrototypeOf, S = E && E(E(U([])));
    S && S !== a && s.call(S, l) && (k = S);
    var F = M.prototype = x.prototype = Object.create(k);
    function O(R) {
      ["next", "throw", "return"].forEach(function(B) {
        h(R, B, function(C) {
          return this._invoke(B, C);
        });
      });
    }
    function D(R, B) {
      function C(W, J, Q, j) {
        var q = g(R[W], R, J);
        if (q.type !== "throw") {
          var ae = q.arg, pe = ae.value;
          return pe && t(pe) == "object" && s.call(pe, "__await") ? B.resolve(pe.__await).then(function($) {
            C("next", $, Q, j);
          }, function($) {
            C("throw", $, Q, j);
          }) : B.resolve(pe).then(function($) {
            ae.value = $, Q(ae);
          }, function($) {
            return C("throw", $, Q, j);
          });
        }
        j(q.arg);
      }
      var Z;
      o(this, "_invoke", {
        value: function(J, Q) {
          function j() {
            return new B(function(q, ae) {
              C(J, Q, q, ae);
            });
          }
          return Z = Z ? Z.then(j, j) : j();
        }
      });
    }
    function _(R, B, C) {
      var Z = v;
      return function(W, J) {
        if (Z === p) throw new Error("Generator is already running");
        if (Z === y) {
          if (W === "throw") throw J;
          return {
            value: n,
            done: !0
          };
        }
        for (C.method = W, C.arg = J; ; ) {
          var Q = C.delegate;
          if (Q) {
            var j = L(Q, C);
            if (j) {
              if (j === w) continue;
              return j;
            }
          }
          if (C.method === "next") C.sent = C._sent = C.arg;
          else if (C.method === "throw") {
            if (Z === v) throw Z = y, C.arg;
            C.dispatchException(C.arg);
          } else C.method === "return" && C.abrupt("return", C.arg);
          Z = p;
          var q = g(R, B, C);
          if (q.type === "normal") {
            if (Z = C.done ? y : m, q.arg === w) continue;
            return {
              value: q.arg,
              done: C.done
            };
          }
          q.type === "throw" && (Z = y, C.method = "throw", C.arg = q.arg);
        }
      };
    }
    function L(R, B) {
      var C = B.method, Z = R.iterator[C];
      if (Z === n) return B.delegate = null, C === "throw" && R.iterator.return && (B.method = "return", B.arg = n, L(R, B), B.method === "throw") || C !== "return" && (B.method = "throw", B.arg = new TypeError("The iterator does not provide a '" + C + "' method")), w;
      var W = g(Z, R.iterator, B.arg);
      if (W.type === "throw") return B.method = "throw", B.arg = W.arg, B.delegate = null, w;
      var J = W.arg;
      return J ? J.done ? (B[R.resultName] = J.value, B.next = R.nextLoc, B.method !== "return" && (B.method = "next", B.arg = n), B.delegate = null, w) : J : (B.method = "throw", B.arg = new TypeError("iterator result is not an object"), B.delegate = null, w);
    }
    function G(R) {
      var B = {
        tryLoc: R[0]
      };
      1 in R && (B.catchLoc = R[1]), 2 in R && (B.finallyLoc = R[2], B.afterLoc = R[3]), this.tryEntries.push(B);
    }
    function V(R) {
      var B = R.completion || {};
      B.type = "normal", delete B.arg, R.completion = B;
    }
    function H(R) {
      this.tryEntries = [{
        tryLoc: "root"
      }], R.forEach(G, this), this.reset(!0);
    }
    function U(R) {
      if (R || R === "") {
        var B = R[l];
        if (B) return B.call(R);
        if (typeof R.next == "function") return R;
        if (!isNaN(R.length)) {
          var C = -1, Z = function W() {
            for (; ++C < R.length; ) if (s.call(R, C)) return W.value = R[C], W.done = !1, W;
            return W.value = n, W.done = !0, W;
          };
          return Z.next = Z;
        }
      }
      throw new TypeError(t(R) + " is not iterable");
    }
    return b.prototype = M, o(F, "constructor", {
      value: M,
      configurable: !0
    }), o(M, "constructor", {
      value: b,
      configurable: !0
    }), b.displayName = h(M, f, "GeneratorFunction"), i.isGeneratorFunction = function(R) {
      var B = typeof R == "function" && R.constructor;
      return !!B && (B === b || (B.displayName || B.name) === "GeneratorFunction");
    }, i.mark = function(R) {
      return Object.setPrototypeOf ? Object.setPrototypeOf(R, M) : (R.__proto__ = M, h(R, f, "GeneratorFunction")), R.prototype = Object.create(F), R;
    }, i.awrap = function(R) {
      return {
        __await: R
      };
    }, O(D.prototype), h(D.prototype, c, function() {
      return this;
    }), i.AsyncIterator = D, i.async = function(R, B, C, Z, W) {
      W === void 0 && (W = Promise);
      var J = new D(d(R, B, C, Z), W);
      return i.isGeneratorFunction(B) ? J : J.next().then(function(Q) {
        return Q.done ? Q.value : J.next();
      });
    }, O(F), h(F, f, "Generator"), h(F, l, function() {
      return this;
    }), h(F, "toString", function() {
      return "[object Generator]";
    }), i.keys = function(R) {
      var B = Object(R), C = [];
      for (var Z in B) C.push(Z);
      return C.reverse(), function W() {
        for (; C.length; ) {
          var J = C.pop();
          if (J in B) return W.value = J, W.done = !1, W;
        }
        return W.done = !0, W;
      };
    }, i.values = U, H.prototype = {
      constructor: H,
      reset: function(B) {
        if (this.prev = 0, this.next = 0, this.sent = this._sent = n, this.done = !1, this.delegate = null, this.method = "next", this.arg = n, this.tryEntries.forEach(V), !B) for (var C in this) C.charAt(0) === "t" && s.call(this, C) && !isNaN(+C.slice(1)) && (this[C] = n);
      },
      stop: function() {
        this.done = !0;
        var B = this.tryEntries[0].completion;
        if (B.type === "throw") throw B.arg;
        return this.rval;
      },
      dispatchException: function(B) {
        if (this.done) throw B;
        var C = this;
        function Z(ae, pe) {
          return Q.type = "throw", Q.arg = B, C.next = ae, pe && (C.method = "next", C.arg = n), !!pe;
        }
        for (var W = this.tryEntries.length - 1; W >= 0; --W) {
          var J = this.tryEntries[W], Q = J.completion;
          if (J.tryLoc === "root") return Z("end");
          if (J.tryLoc <= this.prev) {
            var j = s.call(J, "catchLoc"), q = s.call(J, "finallyLoc");
            if (j && q) {
              if (this.prev < J.catchLoc) return Z(J.catchLoc, !0);
              if (this.prev < J.finallyLoc) return Z(J.finallyLoc);
            } else if (j) {
              if (this.prev < J.catchLoc) return Z(J.catchLoc, !0);
            } else {
              if (!q) throw new Error("try statement without catch or finally");
              if (this.prev < J.finallyLoc) return Z(J.finallyLoc);
            }
          }
        }
      },
      abrupt: function(B, C) {
        for (var Z = this.tryEntries.length - 1; Z >= 0; --Z) {
          var W = this.tryEntries[Z];
          if (W.tryLoc <= this.prev && s.call(W, "finallyLoc") && this.prev < W.finallyLoc) {
            var J = W;
            break;
          }
        }
        J && (B === "break" || B === "continue") && J.tryLoc <= C && C <= J.finallyLoc && (J = null);
        var Q = J ? J.completion : {};
        return Q.type = B, Q.arg = C, J ? (this.method = "next", this.next = J.finallyLoc, w) : this.complete(Q);
      },
      complete: function(B, C) {
        if (B.type === "throw") throw B.arg;
        return B.type === "break" || B.type === "continue" ? this.next = B.arg : B.type === "return" ? (this.rval = this.arg = B.arg, this.method = "return", this.next = "end") : B.type === "normal" && C && (this.next = C), w;
      },
      finish: function(B) {
        for (var C = this.tryEntries.length - 1; C >= 0; --C) {
          var Z = this.tryEntries[C];
          if (Z.finallyLoc === B) return this.complete(Z.completion, Z.afterLoc), V(Z), w;
        }
      },
      catch: function(B) {
        for (var C = this.tryEntries.length - 1; C >= 0; --C) {
          var Z = this.tryEntries[C];
          if (Z.tryLoc === B) {
            var W = Z.completion;
            if (W.type === "throw") {
              var J = W.arg;
              V(Z);
            }
            return J;
          }
        }
        throw new Error("illegal catch attempt");
      },
      delegateYield: function(B, C, Z) {
        return this.delegate = {
          iterator: U(B),
          resultName: C,
          nextLoc: Z
        }, this.method === "next" && (this.arg = n), w;
      }
    }, i;
  }
  e.exports = r, e.exports.__esModule = !0, e.exports.default = e.exports;
})(Iy);
var mc = Iy.exports(), be = mc;
try {
  regeneratorRuntime = mc;
} catch (e) {
  typeof globalThis == "object" ? globalThis.regeneratorRuntime = mc : Function("r", "regeneratorRuntime = r")(mc);
}
function yv(e) {
  return btoa(unescape(encodeURIComponent(e)));
}
function bv(e) {
  return decodeURIComponent(escape(atob(e)));
}
function Oy(e) {
  return Array.from(new TextEncoder().encode(e)).map(function(t) {
    return t.toString(16).padStart(2, "0");
  }).join("");
}
function wv(e) {
  return gd.apply(this, arguments);
}
function gd() {
  return gd = ut(/* @__PURE__ */ be.mark(function e(t) {
    var r, n, i, a, s, o, u, l, c, f, h, d;
    return be.wrap(function(v) {
      for (; ; ) switch (v.prev = v.next) {
        case 0:
          if (r = t.blob, n = t.filename, i = n === void 0 ? "" : n, a = t.types, s = a === void 0 ? [{
            description: "mxweb File",
            accept: {
              "application/octet-stream": [".mxweb"]
            }
          }] : a, r) {
            v.next = 4;
            break;
          }
          return console.error("Invalid blob provided"), v.abrupt("return");
        case 4:
          if (v.prev = 4, typeof window.showSaveFilePicker != "function") {
            v.next = 31;
            break;
          }
          if (u = (o = window.navigator) === null || o === void 0 ? void 0 : o.userActivation, !(u != null && u.isActive || u != null && u.hasBeenActive)) {
            v.next = 30;
            break;
          }
          return v.prev = 8, v.next = 11, window.showSaveFilePicker({
            suggestedName: i,
            types: s
          });
        case 11:
          return l = v.sent, v.next = 14, l.createWritable();
        case 14:
          return c = v.sent, v.next = 17, c.write(r);
        case 17:
          return v.next = 19, c.close();
        case 19:
          return v.abrupt("return", l);
        case 22:
          if (v.prev = 22, v.t0 = v.catch(8), v.t0.name !== "AbortError") {
            v.next = 27;
            break;
          }
          return console.log(""), v.abrupt("return", !1);
        case 27:
          v.t0.name === "AbortError" || v.t0.name === "NotAllowedError" ? console.warn("Save cancelled or not allowed:", v.t0.message) : console.error("showSaveFilePicker failed:", v.t0);
        case 28:
          v.next = 31;
          break;
        case 30:
          console.warn("No user activation, skipping showSaveFilePicker");
        case 31:
          if (!(window.navigator.msSaveOrOpenBlob && typeof window.navigator.msSaveOrOpenBlob == "function")) {
            v.next = 35;
            break;
          }
          return f = r.slice(0, r.size, r.type || "application/octet-stream"), window.navigator.msSaveOrOpenBlob(f, i), v.abrupt("return");
        case 35:
          return h = window.URL.createObjectURL(r), d = document.createElement("a"), d.href = h, d.download = i, d.style.display = "none", document.body.appendChild(d), d.click(), setTimeout(function() {
            window.URL.revokeObjectURL(h);
          }, 100), document.body.removeChild(d), v.abrupt("return");
        case 47:
          v.prev = 47, v.t1 = v.catch(4), console.error("File save failed:", v.t1.name, v.t1.message);
        case 50:
        case "end":
          return v.stop();
      }
    }, e, null, [[4, 47], [8, 22]]);
  })), gd.apply(this, arguments);
}
function xv(e, t) {
  var r = document.createElement("a");
  r.href = window.URL.createObjectURL(e), r.download = t, r.click();
}
function Mv(e, t) {
  fetch(e).then(function(r) {
    return r.blob();
  }).then(function(r) {
    var n = document.createElement("a");
    n.href = window.URL.createObjectURL(r), n.download = t, n.click();
  });
}
var jf = /* @__PURE__ */ function() {
  var e = ut(/* @__PURE__ */ be.mark(function t(r) {
    return be.wrap(function(i) {
      for (; ; ) switch (i.prev = i.next) {
        case 0:
          return i.prev = 0, i.next = 3, fetch(r);
        case 3:
          return i.next = 5, i.sent.json();
        case 5:
          return i.abrupt("return", i.sent);
        case 8:
          i.prev = 8, i.t0 = i.catch(0), console.error("MxTip:error getJsonFromurl:" + r);
        case 11:
        case "end":
          return i.stop();
      }
    }, t, null, [[0, 8]]);
  }));
  return function(r) {
    return e.apply(this, arguments);
  };
}(), Ev = /* @__PURE__ */ function() {
  var e = ut(/* @__PURE__ */ be.mark(function t(r) {
    return be.wrap(function(i) {
      for (; ; ) switch (i.prev = i.next) {
        case 0:
          return i.prev = 0, i.next = 3, fetch(r);
        case 3:
          return i.abrupt("return", i.sent);
        case 6:
          i.prev = 6, i.t0 = i.catch(0), console.error("MxTip:error getFileFromUrl:" + r);
        case 9:
        case "end":
          return i.stop();
      }
    }, t, null, [[0, 6]]);
  }));
  return function(r) {
    return e.apply(this, arguments);
  };
}();
function Ot(e, t) {
  return Ue.getLanguageString(e, t);
}
function Xf(e) {
  return Math.abs(e) < 1e-7;
}
function Av(e, t, r, n, i) {
  try {
    var a = new FormData(), s = new Blob([e], {
      type: "application/octet-stream"
    });
    a.append("file", new File([s], r)), i && a.append("param", i);
    var o = new XMLHttpRequest();
    o.open("POST", t), o.send(a), o.onreadystatechange = function() {
      o.readyState === XMLHttpRequest.DONE && (o.status === 200 ? n(0, o.responseText) : (console.log(o.responseText), n(4, "server error")));
    };
  } catch (u) {
    n(-1, "catch error");
  }
}
function Tv(e, t, r, n) {
  var i = window.indexedDB.open("emscripten_filesystem", 1);
  i.onerror = function() {
    r(1, "open emscripten_filesystem failed");
  }, i.onsuccess = function(a) {
    try {
      if (a.target != null) {
        var s = a.target.result, o = s.transaction("FILES", "readonly"), u = o.objectStore("FILES"), l = u.get(e);
        l.onerror = function() {
          r(3, "get file error");
        }, l.onsuccess = function() {
          var c = l.result;
          if (c) {
            var f = new FormData();
            f.append("file", c), n && f.append("param", n);
            var h = new XMLHttpRequest();
            h.open("POST", t), h.send(f), h.onreadystatechange = function() {
              h.readyState === XMLHttpRequest.DONE && (h.status === 200 ? r(0, h.responseText) : (console.log(h.responseText), r(4, "server error")));
            };
          } else
            r(5, "get file data error");
        };
      } else
        r(2, "event.target == null");
    } catch (c) {
      r(-1, "catch error");
    }
  };
}
function fh() {
  var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 128, t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 10, r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0, n = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : "#ffffff", i = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : document.createElement("canvas"), a = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : "transparent";
  i.width = i.height = e, i.style.background = a;
  var s = i.getContext("2d"), o = e % 2 === 0 ? -0.5 : 0, u = t % 2 === 0 ? -0.5 : 0;
  return s.strokeStyle = n, s.lineWidth = 0, s.imageSmoothingEnabled = !1, r && (s.beginPath(), s.moveTo(i.width / 2 + o, o), s.lineTo(i.width / 2 + o, i.height + o), s.stroke(), s.beginPath(), s.moveTo(o, i.height / 2 + o), s.lineTo(i.width + o, i.height / 2 + o), s.stroke()), s.beginPath(), s.strokeRect(e / 2 - t / 2 + u, e / 2 - t / 2 + u, t, t), s.stroke(), i.toDataURL("image/png");
}
function Sv() {
  var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 128, t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 10, r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "#ffffff";
  return {
    Rect: "url('".concat(fh(e, t, !1, r), "') ").concat(e / 2, " ").concat(e / 2, ", auto"),
    Cross: "url('".concat(fh(e, 0, !0, r), "') ").concat(e / 2, " ").concat(e / 2, " , auto"),
    Normal: "url('".concat(fh(e, t, !0, r), "') ").concat(e / 2, " ").concat(e / 2, ", auto")
  };
}
var mu = {
  b64Encode: yv,
  b64Decode: bv,
  saveAsFileDialog: wv,
  downloadFile: xv,
  downloadFileFromUrl: Mv,
  getJsonFromUrl: jf,
  getFileFromUrl: Ev,
  _ML_String: Ot,
  IsZero: Xf,
  postEmscriptenIndexedDBFile: Tv,
  postMemoryFile: Av,
  createCursor: Sv
};
function Pe(e, t) {
  if (!(e instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
function Er(e) {
  "@babel/helpers - typeof";
  return Er = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Er(e);
}
function Sw(e, t) {
  if (Er(e) != "object" || !e) return e;
  var r = e[Symbol.toPrimitive];
  if (r !== void 0) {
    var n = r.call(e, t);
    if (Er(n) != "object") return n;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return (t === "string" ? String : Number)(e);
}
function Ny(e) {
  var t = Sw(e, "string");
  return Er(t) == "symbol" ? t : String(t);
}
function S0(e, t) {
  for (var r = 0; r < t.length; r++) {
    var n = t[r];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, Ny(n.key), n);
  }
}
function Be(e, t, r) {
  return t && S0(e.prototype, t), r && S0(e, r), Object.defineProperty(e, "prototype", {
    writable: !1
  }), e;
}
function le(e, t, r) {
  return t = Ny(t), t in e ? Object.defineProperty(e, t, {
    value: r,
    enumerable: !0,
    configurable: !0,
    writable: !0
  }) : e[t] = r, e;
}
var Uy = /* @__PURE__ */ function() {
  function e() {
    var t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : void 0;
    Pe(this, e), le(this, "$support", void 0), le(this, "downloadMime", "image/octet-stream"), le(this, "mydocument", document), t && (this.mydocument = t), this.$support = function() {
      var r = t.createElement("canvas"), n = r.getContext("2d");
      return {
        canvas: !!n,
        imageData: !!n.getImageData,
        dataURL: !!r.toDataURL,
        btoa: !!window.btoa
      };
    }();
  }
  return Be(e, [{
    key: "scaleCanvas",
    value: function(r, n, i) {
      var a = r.width, s = r.height;
      n == null && (n = a), i == null && (i = s);
      var o = this.mydocument.createElement("canvas"), u = o.getContext("2d");
      return o.width = n, o.height = i, u.drawImage(r, 0, 0, a, s, 0, 0, n, i), o;
    }
  }, {
    key: "getDataURL",
    value: function(r, n, i, a) {
      return r = this.scaleCanvas(r, i, a), r.toDataURL(n);
    }
  }, {
    key: "saveFile",
    value: function(r) {
      var n = this.mydocument.createElement("a");
      n.href = r, n.download = "save.bmp", n.click();
    }
  }, {
    key: "genImage",
    value: function(r) {
      var n = this.mydocument.createElement("img");
      return n.src = r, n;
    }
  }, {
    key: "fixType",
    value: function(r) {
      r = r.toLowerCase().replace(/jpg/i, "jpeg");
      var n = r.match(/png|jpeg|bmp|gif/)[0];
      return "image/" + n;
    }
  }, {
    key: "encodeData",
    value: function(r) {
      if (!window.btoa)
        throw "btoa undefined";
      var n = "";
      if (typeof r == "string")
        n = r;
      else
        for (var i = 0; i < r.length; i++)
          n += String.fromCharCode(r[i]);
      return btoa(n);
    }
  }, {
    key: "getImageData",
    value: function(r) {
      var n = r.width, i = r.height;
      return r.getContext("2d").getImageData(0, 0, n, i);
    }
  }, {
    key: "makeURI",
    value: function(r, n) {
      return "data:" + n + ";base64," + r;
    }
  }, {
    key: "genBitmapImage",
    value: function(r) {
      var n = r.width, i = r.height, a = n * i * 3, s = a + 54, o = [66, 77, s & 255, s >> 8 & 255, s >> 16 & 255, s >> 24 & 255, 0, 0, 0, 0, 54, 0, 0, 0], u = [40, 0, 0, 0, n & 255, n >> 8 & 255, n >> 16 & 255, n >> 24 & 255, i & 255, i >> 8 & 255, i >> 16 & 255, i >> 24 & 255, 1, 0, 24, 0, 0, 0, 0, 0, a & 255, a >> 8 & 255, a >> 16 & 255, a >> 24 & 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], l = (4 - n * 3 % 4) % 4, c = r.data, f = "", h = n << 2, d = i, g = String.fromCharCode;
      do {
        for (var v = h * (d - 1), m = "", p = 0; p < n; p++) {
          var y = p << 2;
          m += g(c[v + y + 2]) + g(c[v + y + 1]) + g(c[v + y]);
        }
        for (var w = 0; w < l; w++)
          m += "\0";
        f += m;
      } while (--d);
      var x = this.encodeData(o.concat(u)) + this.encodeData(f);
      return x;
    }
  }, {
    key: "saveAsImage",
    value: function(r, n, i, a) {
      if (this.$support.canvas && this.$support.dataURL)
        if (typeof r == "string" && (r = this.mydocument.getElementById(r)), a == null && (a = "png"), a = this.fixType(a), /bmp/.test(a)) {
          var s = this.getImageData(this.scaleCanvas(r, n, i)), o = this.genBitmapImage(s);
          this.saveFile(this.makeURI(o, this.downloadMime));
        } else {
          var u = this.getDataURL(r, a, n, i);
          this.saveFile(u.replace(a, this.downloadMime));
        }
    }
  }, {
    key: "convertToImage",
    value: function(r, n, i, a) {
      if (this.$support.canvas && this.$support.dataURL)
        if (typeof r == "string" && (r = this.mydocument.getElementById(r)), a == null && (a = "png"), a = this.fixType(a), /bmp/.test(a)) {
          var s = this.getImageData(this.scaleCanvas(r, n, i)), o = this.genBitmapImage(s);
          return this.genImage(this.makeURI(o, "image/bmp"));
        } else {
          var u = this.getDataURL(r, a, n, i);
          return this.genImage(u);
        }
    }
  }]), e;
}(), yd = { exports: {} }, gc = Ts, po = gc.Buffer, Wn = {}, Vn;
for (Vn in gc)
  gc.hasOwnProperty(Vn) && (Vn === "SlowBuffer" || Vn === "Buffer" || (Wn[Vn] = gc[Vn]));
var vo = Wn.Buffer = {};
for (Vn in po)
  po.hasOwnProperty(Vn) && (Vn === "allocUnsafe" || Vn === "allocUnsafeSlow" || (vo[Vn] = po[Vn]));
Wn.Buffer.prototype = po.prototype;
(!vo.from || vo.from === Uint8Array.from) && (vo.from = function(e, t, r) {
  if (typeof e == "number")
    throw new TypeError('The "value" argument must not be of type number. Received type ' + typeof e);
  if (e && typeof e.length == "undefined")
    throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof e);
  return po(e, t, r);
});
vo.alloc || (vo.alloc = function(e, t, r) {
  if (typeof e != "number")
    throw new TypeError('The "size" argument must be of type number. Received type ' + typeof e);
  if (e < 0 || e >= 2 * (1 << 30))
    throw new RangeError('The value "' + e + '" is invalid for option "size"');
  var n = po(e);
  return !t || t.length === 0 ? n.fill(0) : typeof r == "string" ? n.fill(t, r) : n.fill(t), n;
});
if (!Wn.kStringMaxLength)
  try {
    Wn.kStringMaxLength = process.binding("buffer").kStringMaxLength;
  } catch (e) {
  }
Wn.constants || (Wn.constants = {
  MAX_LENGTH: Wn.kMaxLength
}, Wn.kStringMaxLength && (Wn.constants.MAX_STRING_LENGTH = Wn.kStringMaxLength));
var Wa = Wn, kv = {}, Gy = "\uFEFF";
kv.PrependBOM = Cv;
function Cv(e, t) {
  this.encoder = e, this.addBOM = !0;
}
Cv.prototype.write = function(e) {
  return this.addBOM && (e = Gy + e, this.addBOM = !1), this.encoder.write(e);
};
Cv.prototype.end = function() {
  return this.encoder.end();
};
kv.StripBOM = Dv;
function Dv(e, t) {
  this.decoder = e, this.pass = !1, this.options = t || {};
}
Dv.prototype.write = function(e) {
  var t = this.decoder.write(e);
  return this.pass || !t || (t[0] === Gy && (t = t.slice(1), typeof this.options.stripBOM == "function" && this.options.stripBOM()), this.pass = !0), t;
};
Dv.prototype.end = function() {
  return this.decoder.end();
};
var hh = {}, dh = {}, Sl = { exports: {} };
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var k0;
function kw() {
  return k0 || (k0 = 1, function(e, t) {
    var r = Ts, n = r.Buffer;
    function i(s, o) {
      for (var u in s)
        o[u] = s[u];
    }
    n.from && n.alloc && n.allocUnsafe && n.allocUnsafeSlow ? e.exports = r : (i(r, t), t.Buffer = a);
    function a(s, o, u) {
      return n(s, o, u);
    }
    a.prototype = Object.create(n.prototype), i(n, a), a.from = function(s, o, u) {
      if (typeof s == "number")
        throw new TypeError("Argument must not be a number");
      return n(s, o, u);
    }, a.alloc = function(s, o, u) {
      if (typeof s != "number")
        throw new TypeError("Argument must be a number");
      var l = n(s);
      return o !== void 0 ? typeof u == "string" ? l.fill(o, u) : l.fill(o) : l.fill(0), l;
    }, a.allocUnsafe = function(s) {
      if (typeof s != "number")
        throw new TypeError("Argument must be a number");
      return n(s);
    }, a.allocUnsafeSlow = function(s) {
      if (typeof s != "number")
        throw new TypeError("Argument must be a number");
      return r.SlowBuffer(s);
    };
  }(Sl, Sl.exports)), Sl.exports;
}
var C0;
function Cw() {
  if (C0) return dh;
  C0 = 1;
  var e = kw().Buffer, t = e.isEncoding || function(p) {
    switch (p = "" + p, p && p.toLowerCase()) {
      case "hex":
      case "utf8":
      case "utf-8":
      case "ascii":
      case "binary":
      case "base64":
      case "ucs2":
      case "ucs-2":
      case "utf16le":
      case "utf-16le":
      case "raw":
        return !0;
      default:
        return !1;
    }
  };
  function r(p) {
    if (!p) return "utf8";
    for (var y; ; )
      switch (p) {
        case "utf8":
        case "utf-8":
          return "utf8";
        case "ucs2":
        case "ucs-2":
        case "utf16le":
        case "utf-16le":
          return "utf16le";
        case "latin1":
        case "binary":
          return "latin1";
        case "base64":
        case "ascii":
        case "hex":
          return p;
        default:
          if (y) return;
          p = ("" + p).toLowerCase(), y = !0;
      }
  }
  function n(p) {
    var y = r(p);
    if (typeof y != "string" && (e.isEncoding === t || !t(p))) throw new Error("Unknown encoding: " + p);
    return y || p;
  }
  dh.StringDecoder = i;
  function i(p) {
    this.encoding = n(p);
    var y;
    switch (this.encoding) {
      case "utf16le":
        this.text = f, this.end = h, y = 4;
        break;
      case "utf8":
        this.fillLast = u, y = 4;
        break;
      case "base64":
        this.text = d, this.end = g, y = 3;
        break;
      default:
        this.write = v, this.end = m;
        return;
    }
    this.lastNeed = 0, this.lastTotal = 0, this.lastChar = e.allocUnsafe(y);
  }
  i.prototype.write = function(p) {
    if (p.length === 0) return "";
    var y, w;
    if (this.lastNeed) {
      if (y = this.fillLast(p), y === void 0) return "";
      w = this.lastNeed, this.lastNeed = 0;
    } else
      w = 0;
    return w < p.length ? y ? y + this.text(p, w) : this.text(p, w) : y || "";
  }, i.prototype.end = c, i.prototype.text = l, i.prototype.fillLast = function(p) {
    if (this.lastNeed <= p.length)
      return p.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed), this.lastChar.toString(this.encoding, 0, this.lastTotal);
    p.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, p.length), this.lastNeed -= p.length;
  };
  function a(p) {
    return p <= 127 ? 0 : p >> 5 === 6 ? 2 : p >> 4 === 14 ? 3 : p >> 3 === 30 ? 4 : p >> 6 === 2 ? -1 : -2;
  }
  function s(p, y, w) {
    var x = y.length - 1;
    if (x < w) return 0;
    var b = a(y[x]);
    return b >= 0 ? (b > 0 && (p.lastNeed = b - 1), b) : --x < w || b === -2 ? 0 : (b = a(y[x]), b >= 0 ? (b > 0 && (p.lastNeed = b - 2), b) : --x < w || b === -2 ? 0 : (b = a(y[x]), b >= 0 ? (b > 0 && (b === 2 ? b = 0 : p.lastNeed = b - 3), b) : 0));
  }
  function o(p, y, w) {
    if ((y[0] & 192) !== 128)
      return p.lastNeed = 0, "";
    if (p.lastNeed > 1 && y.length > 1) {
      if ((y[1] & 192) !== 128)
        return p.lastNeed = 1, "";
      if (p.lastNeed > 2 && y.length > 2 && (y[2] & 192) !== 128)
        return p.lastNeed = 2, "";
    }
  }
  function u(p) {
    var y = this.lastTotal - this.lastNeed, w = o(this, p);
    if (w !== void 0) return w;
    if (this.lastNeed <= p.length)
      return p.copy(this.lastChar, y, 0, this.lastNeed), this.lastChar.toString(this.encoding, 0, this.lastTotal);
    p.copy(this.lastChar, y, 0, p.length), this.lastNeed -= p.length;
  }
  function l(p, y) {
    var w = s(this, p, y);
    if (!this.lastNeed) return p.toString("utf8", y);
    this.lastTotal = w;
    var x = p.length - (w - this.lastNeed);
    return p.copy(this.lastChar, 0, x), p.toString("utf8", y, x);
  }
  function c(p) {
    var y = p && p.length ? this.write(p) : "";
    return this.lastNeed ? y + "" : y;
  }
  function f(p, y) {
    if ((p.length - y) % 2 === 0) {
      var w = p.toString("utf16le", y);
      if (w) {
        var x = w.charCodeAt(w.length - 1);
        if (x >= 55296 && x <= 56319)
          return this.lastNeed = 2, this.lastTotal = 4, this.lastChar[0] = p[p.length - 2], this.lastChar[1] = p[p.length - 1], w.slice(0, -1);
      }
      return w;
    }
    return this.lastNeed = 1, this.lastTotal = 2, this.lastChar[0] = p[p.length - 1], p.toString("utf16le", y, p.length - 1);
  }
  function h(p) {
    var y = p && p.length ? this.write(p) : "";
    if (this.lastNeed) {
      var w = this.lastTotal - this.lastNeed;
      return y + this.lastChar.toString("utf16le", 0, w);
    }
    return y;
  }
  function d(p, y) {
    var w = (p.length - y) % 3;
    return w === 0 ? p.toString("base64", y) : (this.lastNeed = 3 - w, this.lastTotal = 3, w === 1 ? this.lastChar[0] = p[p.length - 1] : (this.lastChar[0] = p[p.length - 2], this.lastChar[1] = p[p.length - 1]), p.toString("base64", y, p.length - w));
  }
  function g(p) {
    var y = p && p.length ? this.write(p) : "";
    return this.lastNeed ? y + this.lastChar.toString("base64", 0, 3 - this.lastNeed) : y;
  }
  function v(p) {
    return p.toString(this.encoding);
  }
  function m(p) {
    return p && p.length ? this.write(p) : "";
  }
  return dh;
}
var ph, D0;
function Dw() {
  if (D0) return ph;
  D0 = 1;
  var e = Wa.Buffer;
  ph = {
    // Encodings
    utf8: { type: "_internal", bomAware: !0 },
    cesu8: { type: "_internal", bomAware: !0 },
    unicode11utf8: "utf8",
    ucs2: { type: "_internal", bomAware: !0 },
    utf16le: "ucs2",
    binary: { type: "_internal" },
    base64: { type: "_internal" },
    hex: { type: "_internal" },
    // Codec.
    _internal: t
  };
  function t(u, l) {
    this.enc = u.encodingName, this.bomAware = u.bomAware, this.enc === "base64" ? this.encoder = a : this.enc === "cesu8" && (this.enc = "utf8", this.encoder = s, e.from("eda0bdedb2a9", "hex").toString() !== "" && (this.decoder = o, this.defaultCharUnicode = l.defaultCharUnicode));
  }
  t.prototype.encoder = i, t.prototype.decoder = n;
  var r = Cw().StringDecoder;
  r.prototype.end || (r.prototype.end = function() {
  });
  function n(u, l) {
    this.decoder = new r(l.enc);
  }
  n.prototype.write = function(u) {
    return e.isBuffer(u) || (u = e.from(u)), this.decoder.write(u);
  }, n.prototype.end = function() {
    return this.decoder.end();
  };
  function i(u, l) {
    this.enc = l.enc;
  }
  i.prototype.write = function(u) {
    return e.from(u, this.enc);
  }, i.prototype.end = function() {
  };
  function a(u, l) {
    this.prevStr = "";
  }
  a.prototype.write = function(u) {
    u = this.prevStr + u;
    var l = u.length - u.length % 4;
    return this.prevStr = u.slice(l), u = u.slice(0, l), e.from(u, "base64");
  }, a.prototype.end = function() {
    return e.from(this.prevStr, "base64");
  };
  function s(u, l) {
  }
  s.prototype.write = function(u) {
    for (var l = e.alloc(u.length * 3), c = 0, f = 0; f < u.length; f++) {
      var h = u.charCodeAt(f);
      h < 128 ? l[c++] = h : h < 2048 ? (l[c++] = 192 + (h >>> 6), l[c++] = 128 + (h & 63)) : (l[c++] = 224 + (h >>> 12), l[c++] = 128 + (h >>> 6 & 63), l[c++] = 128 + (h & 63));
    }
    return l.slice(0, c);
  }, s.prototype.end = function() {
  };
  function o(u, l) {
    this.acc = 0, this.contBytes = 0, this.accBytes = 0, this.defaultCharUnicode = l.defaultCharUnicode;
  }
  return o.prototype.write = function(u) {
    for (var l = this.acc, c = this.contBytes, f = this.accBytes, h = "", d = 0; d < u.length; d++) {
      var g = u[d];
      (g & 192) !== 128 ? (c > 0 && (h += this.defaultCharUnicode, c = 0), g < 128 ? h += String.fromCharCode(g) : g < 224 ? (l = g & 31, c = 1, f = 1) : g < 240 ? (l = g & 15, c = 2, f = 1) : h += this.defaultCharUnicode) : c > 0 ? (l = l << 6 | g & 63, c--, f++, c === 0 && (f === 2 && l < 128 && l > 0 ? h += this.defaultCharUnicode : f === 3 && l < 2048 ? h += this.defaultCharUnicode : h += String.fromCharCode(l))) : h += this.defaultCharUnicode;
    }
    return this.acc = l, this.contBytes = c, this.accBytes = f, h;
  }, o.prototype.end = function() {
    var u = 0;
    return this.contBytes > 0 && (u += this.defaultCharUnicode), u;
  }, ph;
}
var Wi = {}, _0;
function _w() {
  if (_0) return Wi;
  _0 = 1;
  var e = Wa.Buffer;
  Wi._utf32 = t;
  function t(l, c) {
    this.iconv = c, this.bomAware = !0, this.isLE = l.isLE;
  }
  Wi.utf32le = { type: "_utf32", isLE: !0 }, Wi.utf32be = { type: "_utf32", isLE: !1 }, Wi.ucs4le = "utf32le", Wi.ucs4be = "utf32be", t.prototype.encoder = r, t.prototype.decoder = n;
  function r(l, c) {
    this.isLE = c.isLE, this.highSurrogate = 0;
  }
  r.prototype.write = function(l) {
    for (var c = e.from(l, "ucs2"), f = e.alloc(c.length * 2), h = this.isLE ? f.writeUInt32LE : f.writeUInt32BE, d = 0, g = 0; g < c.length; g += 2) {
      var v = c.readUInt16LE(g), m = 55296 <= v && v < 56320, p = 56320 <= v && v < 57344;
      if (this.highSurrogate)
        if (m || !p)
          h.call(f, this.highSurrogate, d), d += 4;
        else {
          var y = (this.highSurrogate - 55296 << 10 | v - 56320) + 65536;
          h.call(f, y, d), d += 4, this.highSurrogate = 0;
          continue;
        }
      m ? this.highSurrogate = v : (h.call(f, v, d), d += 4, this.highSurrogate = 0);
    }
    return d < f.length && (f = f.slice(0, d)), f;
  }, r.prototype.end = function() {
    if (this.highSurrogate) {
      var l = e.alloc(4);
      return this.isLE ? l.writeUInt32LE(this.highSurrogate, 0) : l.writeUInt32BE(this.highSurrogate, 0), this.highSurrogate = 0, l;
    }
  };
  function n(l, c) {
    this.isLE = c.isLE, this.badChar = c.iconv.defaultCharUnicode.charCodeAt(0), this.overflow = [];
  }
  n.prototype.write = function(l) {
    if (l.length === 0)
      return "";
    var c = 0, f = 0, h = e.alloc(l.length + 4), d = 0, g = this.isLE, v = this.overflow, m = this.badChar;
    if (v.length > 0) {
      for (; c < l.length && v.length < 4; c++)
        v.push(l[c]);
      v.length === 4 && (g ? f = v[c] | v[c + 1] << 8 | v[c + 2] << 16 | v[c + 3] << 24 : f = v[c + 3] | v[c + 2] << 8 | v[c + 1] << 16 | v[c] << 24, v.length = 0, d = i(h, d, f, m));
    }
    for (; c < l.length - 3; c += 4)
      g ? f = l[c] | l[c + 1] << 8 | l[c + 2] << 16 | l[c + 3] << 24 : f = l[c + 3] | l[c + 2] << 8 | l[c + 1] << 16 | l[c] << 24, d = i(h, d, f, m);
    for (; c < l.length; c++)
      v.push(l[c]);
    return h.slice(0, d).toString("ucs2");
  };
  function i(l, c, f, h) {
    if ((f < 0 || f > 1114111) && (f = h), f >= 65536) {
      f -= 65536;
      var d = 55296 | f >> 10;
      l[c++] = d & 255, l[c++] = d >> 8;
      var f = 56320 | f & 1023;
    }
    return l[c++] = f & 255, l[c++] = f >> 8, c;
  }
  n.prototype.end = function() {
    this.overflow.length = 0;
  }, Wi.utf32 = a, Wi.ucs4 = "utf32";
  function a(l, c) {
    this.iconv = c;
  }
  a.prototype.encoder = s, a.prototype.decoder = o;
  function s(l, c) {
    l = l || {}, l.addBOM === void 0 && (l.addBOM = !0), this.encoder = c.iconv.getEncoder(l.defaultEncoding || "utf-32le", l);
  }
  s.prototype.write = function(l) {
    return this.encoder.write(l);
  }, s.prototype.end = function() {
    return this.encoder.end();
  };
  function o(l, c) {
    this.decoder = null, this.initialBufs = [], this.initialBufsLen = 0, this.options = l || {}, this.iconv = c.iconv;
  }
  o.prototype.write = function(l) {
    if (!this.decoder) {
      if (this.initialBufs.push(l), this.initialBufsLen += l.length, this.initialBufsLen < 32)
        return "";
      var c = u(this.initialBufs, this.options.defaultEncoding);
      this.decoder = this.iconv.getDecoder(c, this.options);
      for (var f = "", h = 0; h < this.initialBufs.length; h++)
        f += this.decoder.write(this.initialBufs[h]);
      return this.initialBufs.length = this.initialBufsLen = 0, f;
    }
    return this.decoder.write(l);
  }, o.prototype.end = function() {
    if (!this.decoder) {
      var l = u(this.initialBufs, this.options.defaultEncoding);
      this.decoder = this.iconv.getDecoder(l, this.options);
      for (var c = "", f = 0; f < this.initialBufs.length; f++)
        c += this.decoder.write(this.initialBufs[f]);
      var h = this.decoder.end();
      return h && (c += h), this.initialBufs.length = this.initialBufsLen = 0, c;
    }
    return this.decoder.end();
  };
  function u(l, c) {
    var f = [], h = 0, d = 0, g = 0, v = 0, m = 0;
    e:
      for (var p = 0; p < l.length; p++)
        for (var y = l[p], w = 0; w < y.length; w++)
          if (f.push(y[w]), f.length === 4) {
            if (h === 0) {
              if (f[0] === 255 && f[1] === 254 && f[2] === 0 && f[3] === 0)
                return "utf-32le";
              if (f[0] === 0 && f[1] === 0 && f[2] === 254 && f[3] === 255)
                return "utf-32be";
            }
            if ((f[0] !== 0 || f[1] > 16) && g++, (f[3] !== 0 || f[2] > 16) && d++, f[0] === 0 && f[1] === 0 && (f[2] !== 0 || f[3] !== 0) && m++, (f[0] !== 0 || f[1] !== 0) && f[2] === 0 && f[3] === 0 && v++, f.length = 0, h++, h >= 100)
              break e;
          }
    return m - g > v - d ? "utf-32be" : m - g < v - d ? "utf-32le" : c || "utf-32le";
  }
  return Wi;
}
var kl = {}, P0;
function Pw() {
  if (P0) return kl;
  P0 = 1;
  var e = Wa.Buffer;
  kl.utf16be = t;
  function t() {
  }
  t.prototype.encoder = r, t.prototype.decoder = n, t.prototype.bomAware = !0;
  function r() {
  }
  r.prototype.write = function(u) {
    for (var l = e.from(u, "ucs2"), c = 0; c < l.length; c += 2) {
      var f = l[c];
      l[c] = l[c + 1], l[c + 1] = f;
    }
    return l;
  }, r.prototype.end = function() {
  };
  function n() {
    this.overflowByte = -1;
  }
  n.prototype.write = function(u) {
    if (u.length == 0)
      return "";
    var l = e.alloc(u.length + 1), c = 0, f = 0;
    for (this.overflowByte !== -1 && (l[0] = u[0], l[1] = this.overflowByte, c = 1, f = 2); c < u.length - 1; c += 2, f += 2)
      l[f] = u[c + 1], l[f + 1] = u[c];
    return this.overflowByte = c == u.length - 1 ? u[u.length - 1] : -1, l.slice(0, f).toString("ucs2");
  }, n.prototype.end = function() {
    this.overflowByte = -1;
  }, kl.utf16 = i;
  function i(u, l) {
    this.iconv = l;
  }
  i.prototype.encoder = a, i.prototype.decoder = s;
  function a(u, l) {
    u = u || {}, u.addBOM === void 0 && (u.addBOM = !0), this.encoder = l.iconv.getEncoder("utf-16le", u);
  }
  a.prototype.write = function(u) {
    return this.encoder.write(u);
  }, a.prototype.end = function() {
    return this.encoder.end();
  };
  function s(u, l) {
    this.decoder = null, this.initialBufs = [], this.initialBufsLen = 0, this.options = u || {}, this.iconv = l.iconv;
  }
  s.prototype.write = function(u) {
    if (!this.decoder) {
      if (this.initialBufs.push(u), this.initialBufsLen += u.length, this.initialBufsLen < 16)
        return "";
      var l = o(this.initialBufs, this.options.defaultEncoding);
      this.decoder = this.iconv.getDecoder(l, this.options);
      for (var c = "", f = 0; f < this.initialBufs.length; f++)
        c += this.decoder.write(this.initialBufs[f]);
      return this.initialBufs.length = this.initialBufsLen = 0, c;
    }
    return this.decoder.write(u);
  }, s.prototype.end = function() {
    if (!this.decoder) {
      var u = o(this.initialBufs, this.options.defaultEncoding);
      this.decoder = this.iconv.getDecoder(u, this.options);
      for (var l = "", c = 0; c < this.initialBufs.length; c++)
        l += this.decoder.write(this.initialBufs[c]);
      var f = this.decoder.end();
      return f && (l += f), this.initialBufs.length = this.initialBufsLen = 0, l;
    }
    return this.decoder.end();
  };
  function o(u, l) {
    var c = [], f = 0, h = 0, d = 0;
    e:
      for (var g = 0; g < u.length; g++)
        for (var v = u[g], m = 0; m < v.length; m++)
          if (c.push(v[m]), c.length === 2) {
            if (f === 0) {
              if (c[0] === 255 && c[1] === 254) return "utf-16le";
              if (c[0] === 254 && c[1] === 255) return "utf-16be";
            }
            if (c[0] === 0 && c[1] !== 0 && d++, c[0] !== 0 && c[1] === 0 && h++, c.length = 0, f++, f >= 100)
              break e;
          }
    return d > h ? "utf-16be" : d < h ? "utf-16le" : l || "utf-16le";
  }
  return kl;
}
var Zo = {}, B0;
function Bw() {
  if (B0) return Zo;
  B0 = 1;
  var e = Wa.Buffer;
  Zo.utf7 = t, Zo.unicode11utf7 = "utf7";
  function t(v, m) {
    this.iconv = m;
  }
  t.prototype.encoder = n, t.prototype.decoder = i, t.prototype.bomAware = !0;
  var r = /[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;
  function n(v, m) {
    this.iconv = m.iconv;
  }
  n.prototype.write = function(v) {
    return e.from(v.replace(r, function(m) {
      return "+" + (m === "+" ? "" : this.iconv.encode(m, "utf16-be").toString("base64").replace(/=+$/, "")) + "-";
    }.bind(this)));
  }, n.prototype.end = function() {
  };
  function i(v, m) {
    this.iconv = m.iconv, this.inBase64 = !1, this.base64Accum = "";
  }
  for (var a = /[A-Za-z0-9\/+]/, s = [], o = 0; o < 256; o++)
    s[o] = a.test(String.fromCharCode(o));
  var u = 43, l = 45, c = 38;
  i.prototype.write = function(v) {
    for (var m = "", p = 0, y = this.inBase64, w = this.base64Accum, x = 0; x < v.length; x++)
      if (!y)
        v[x] == u && (m += this.iconv.decode(v.slice(p, x), "ascii"), p = x + 1, y = !0);
      else if (!s[v[x]]) {
        if (x == p && v[x] == l)
          m += "+";
        else {
          var b = w + this.iconv.decode(v.slice(p, x), "ascii");
          m += this.iconv.decode(e.from(b, "base64"), "utf16-be");
        }
        v[x] != l && x--, p = x + 1, y = !1, w = "";
      }
    if (!y)
      m += this.iconv.decode(v.slice(p), "ascii");
    else {
      var b = w + this.iconv.decode(v.slice(p), "ascii"), M = b.length - b.length % 8;
      w = b.slice(M), b = b.slice(0, M), m += this.iconv.decode(e.from(b, "base64"), "utf16-be");
    }
    return this.inBase64 = y, this.base64Accum = w, m;
  }, i.prototype.end = function() {
    var v = "";
    return this.inBase64 && this.base64Accum.length > 0 && (v = this.iconv.decode(e.from(this.base64Accum, "base64"), "utf16-be")), this.inBase64 = !1, this.base64Accum = "", v;
  }, Zo.utf7imap = f;
  function f(v, m) {
    this.iconv = m;
  }
  f.prototype.encoder = h, f.prototype.decoder = d, f.prototype.bomAware = !0;
  function h(v, m) {
    this.iconv = m.iconv, this.inBase64 = !1, this.base64Accum = e.alloc(6), this.base64AccumIdx = 0;
  }
  h.prototype.write = function(v) {
    for (var m = this.inBase64, p = this.base64Accum, y = this.base64AccumIdx, w = e.alloc(v.length * 5 + 10), x = 0, b = 0; b < v.length; b++) {
      var M = v.charCodeAt(b);
      32 <= M && M <= 126 ? (m && (y > 0 && (x += w.write(p.slice(0, y).toString("base64").replace(/\//g, ",").replace(/=+$/, ""), x), y = 0), w[x++] = l, m = !1), m || (w[x++] = M, M === c && (w[x++] = l))) : (m || (w[x++] = c, m = !0), m && (p[y++] = M >> 8, p[y++] = M & 255, y == p.length && (x += w.write(p.toString("base64").replace(/\//g, ","), x), y = 0)));
    }
    return this.inBase64 = m, this.base64AccumIdx = y, w.slice(0, x);
  }, h.prototype.end = function() {
    var v = e.alloc(10), m = 0;
    return this.inBase64 && (this.base64AccumIdx > 0 && (m += v.write(this.base64Accum.slice(0, this.base64AccumIdx).toString("base64").replace(/\//g, ",").replace(/=+$/, ""), m), this.base64AccumIdx = 0), v[m++] = l, this.inBase64 = !1), v.slice(0, m);
  };
  function d(v, m) {
    this.iconv = m.iconv, this.inBase64 = !1, this.base64Accum = "";
  }
  var g = s.slice();
  return g[44] = !0, d.prototype.write = function(v) {
    for (var m = "", p = 0, y = this.inBase64, w = this.base64Accum, x = 0; x < v.length; x++)
      if (!y)
        v[x] == c && (m += this.iconv.decode(v.slice(p, x), "ascii"), p = x + 1, y = !0);
      else if (!g[v[x]]) {
        if (x == p && v[x] == l)
          m += "&";
        else {
          var b = w + this.iconv.decode(v.slice(p, x), "ascii").replace(/,/g, "/");
          m += this.iconv.decode(e.from(b, "base64"), "utf16-be");
        }
        v[x] != l && x--, p = x + 1, y = !1, w = "";
      }
    if (!y)
      m += this.iconv.decode(v.slice(p), "ascii");
    else {
      var b = w + this.iconv.decode(v.slice(p), "ascii").replace(/,/g, "/"), M = b.length - b.length % 8;
      w = b.slice(M), b = b.slice(0, M), m += this.iconv.decode(e.from(b, "base64"), "utf16-be");
    }
    return this.inBase64 = y, this.base64Accum = w, m;
  }, d.prototype.end = function() {
    var v = "";
    return this.inBase64 && this.base64Accum.length > 0 && (v = this.iconv.decode(e.from(this.base64Accum, "base64"), "utf16-be")), this.inBase64 = !1, this.base64Accum = "", v;
  }, Zo;
}
var vh = {}, L0;
function Lw() {
  if (L0) return vh;
  L0 = 1;
  var e = Wa.Buffer;
  vh._sbcs = t;
  function t(i, a) {
    if (!i)
      throw new Error("SBCS codec is called without the data.");
    if (!i.chars || i.chars.length !== 128 && i.chars.length !== 256)
      throw new Error("Encoding '" + i.type + "' has incorrect 'chars' (must be of len 128 or 256)");
    if (i.chars.length === 128) {
      for (var s = "", o = 0; o < 128; o++)
        s += String.fromCharCode(o);
      i.chars = s + i.chars;
    }
    this.decodeBuf = e.from(i.chars, "ucs2");
    for (var u = e.alloc(65536, a.defaultCharSingleByte.charCodeAt(0)), o = 0; o < i.chars.length; o++)
      u[i.chars.charCodeAt(o)] = o;
    this.encodeBuf = u;
  }
  t.prototype.encoder = r, t.prototype.decoder = n;
  function r(i, a) {
    this.encodeBuf = a.encodeBuf;
  }
  r.prototype.write = function(i) {
    for (var a = e.alloc(i.length), s = 0; s < i.length; s++)
      a[s] = this.encodeBuf[i.charCodeAt(s)];
    return a;
  }, r.prototype.end = function() {
  };
  function n(i, a) {
    this.decodeBuf = a.decodeBuf;
  }
  return n.prototype.write = function(i) {
    for (var a = this.decodeBuf, s = e.alloc(i.length * 2), o = 0, u = 0, l = 0; l < i.length; l++)
      o = i[l] * 2, u = l * 2, s[u] = a[o], s[u + 1] = a[o + 1];
    return s.toString("ucs2");
  }, n.prototype.end = function() {
  }, vh;
}
var mh, F0;
function Fw() {
  return F0 || (F0 = 1, mh = {
    // Not supported by iconv, not sure why.
    10029: "maccenteuro",
    maccenteuro: {
      type: "_sbcs",
      chars: ""
    },
    808: "cp808",
    ibm808: "cp808",
    cp808: {
      type: "_sbcs",
      chars: ""
    },
    mik: {
      type: "_sbcs",
      chars: ""
    },
    cp720: {
      type: "_sbcs",
      chars: ""
    },
    // Aliases of generated encodings.
    ascii8bit: "ascii",
    usascii: "ascii",
    ansix34: "ascii",
    ansix341968: "ascii",
    ansix341986: "ascii",
    csascii: "ascii",
    cp367: "ascii",
    ibm367: "ascii",
    isoir6: "ascii",
    iso646us: "ascii",
    iso646irv: "ascii",
    us: "ascii",
    latin1: "iso88591",
    latin2: "iso88592",
    latin3: "iso88593",
    latin4: "iso88594",
    latin5: "iso88599",
    latin6: "iso885910",
    latin7: "iso885913",
    latin8: "iso885914",
    latin9: "iso885915",
    latin10: "iso885916",
    csisolatin1: "iso88591",
    csisolatin2: "iso88592",
    csisolatin3: "iso88593",
    csisolatin4: "iso88594",
    csisolatincyrillic: "iso88595",
    csisolatinarabic: "iso88596",
    csisolatingreek: "iso88597",
    csisolatinhebrew: "iso88598",
    csisolatin5: "iso88599",
    csisolatin6: "iso885910",
    l1: "iso88591",
    l2: "iso88592",
    l3: "iso88593",
    l4: "iso88594",
    l5: "iso88599",
    l6: "iso885910",
    l7: "iso885913",
    l8: "iso885914",
    l9: "iso885915",
    l10: "iso885916",
    isoir14: "iso646jp",
    isoir57: "iso646cn",
    isoir100: "iso88591",
    isoir101: "iso88592",
    isoir109: "iso88593",
    isoir110: "iso88594",
    isoir144: "iso88595",
    isoir127: "iso88596",
    isoir126: "iso88597",
    isoir138: "iso88598",
    isoir148: "iso88599",
    isoir157: "iso885910",
    isoir166: "tis620",
    isoir179: "iso885913",
    isoir199: "iso885914",
    isoir203: "iso885915",
    isoir226: "iso885916",
    cp819: "iso88591",
    ibm819: "iso88591",
    cyrillic: "iso88595",
    arabic: "iso88596",
    arabic8: "iso88596",
    ecma114: "iso88596",
    asmo708: "iso88596",
    greek: "iso88597",
    greek8: "iso88597",
    ecma118: "iso88597",
    elot928: "iso88597",
    hebrew: "iso88598",
    hebrew8: "iso88598",
    turkish: "iso88599",
    turkish8: "iso88599",
    thai: "iso885911",
    thai8: "iso885911",
    celtic: "iso885914",
    celtic8: "iso885914",
    isoceltic: "iso885914",
    tis6200: "tis620",
    tis62025291: "tis620",
    tis62025330: "tis620",
    1e4: "macroman",
    10006: "macgreek",
    10007: "maccyrillic",
    10079: "maciceland",
    10081: "macturkish",
    cspc8codepage437: "cp437",
    cspc775baltic: "cp775",
    cspc850multilingual: "cp850",
    cspcp852: "cp852",
    cspc862latinhebrew: "cp862",
    cpgr: "cp869",
    msee: "cp1250",
    mscyrl: "cp1251",
    msansi: "cp1252",
    msgreek: "cp1253",
    msturk: "cp1254",
    mshebr: "cp1255",
    msarab: "cp1256",
    winbaltrim: "cp1257",
    cp20866: "koi8r",
    20866: "koi8r",
    ibm878: "koi8r",
    cskoi8r: "koi8r",
    cp21866: "koi8u",
    21866: "koi8u",
    ibm1168: "koi8u",
    strk10482002: "rk1048",
    tcvn5712: "tcvn",
    tcvn57121: "tcvn",
    gb198880: "iso646cn",
    cn: "iso646cn",
    csiso14jisc6220ro: "iso646jp",
    jisc62201969ro: "iso646jp",
    jp: "iso646jp",
    cshproman8: "hproman8",
    r8: "hproman8",
    roman8: "hproman8",
    xroman8: "hproman8",
    ibm1051: "hproman8",
    mac: "macintosh",
    csmacintosh: "macintosh"
  }), mh;
}
var gh, I0;
function Iw() {
  return I0 || (I0 = 1, gh = {
    437: "cp437",
    737: "cp737",
    775: "cp775",
    850: "cp850",
    852: "cp852",
    855: "cp855",
    856: "cp856",
    857: "cp857",
    858: "cp858",
    860: "cp860",
    861: "cp861",
    862: "cp862",
    863: "cp863",
    864: "cp864",
    865: "cp865",
    866: "cp866",
    869: "cp869",
    874: "windows874",
    922: "cp922",
    1046: "cp1046",
    1124: "cp1124",
    1125: "cp1125",
    1129: "cp1129",
    1133: "cp1133",
    1161: "cp1161",
    1162: "cp1162",
    1163: "cp1163",
    1250: "windows1250",
    1251: "windows1251",
    1252: "windows1252",
    1253: "windows1253",
    1254: "windows1254",
    1255: "windows1255",
    1256: "windows1256",
    1257: "windows1257",
    1258: "windows1258",
    28591: "iso88591",
    28592: "iso88592",
    28593: "iso88593",
    28594: "iso88594",
    28595: "iso88595",
    28596: "iso88596",
    28597: "iso88597",
    28598: "iso88598",
    28599: "iso88599",
    28600: "iso885910",
    28601: "iso885911",
    28603: "iso885913",
    28604: "iso885914",
    28605: "iso885915",
    28606: "iso885916",
    windows874: {
      type: "_sbcs",
      chars: ""
    },
    win874: "windows874",
    cp874: "windows874",
    windows1250: {
      type: "_sbcs",
      chars: ""
    },
    win1250: "windows1250",
    cp1250: "windows1250",
    windows1251: {
      type: "_sbcs",
      chars: ""
    },
    win1251: "windows1251",
    cp1251: "windows1251",
    windows1252: {
      type: "_sbcs",
      chars: ""
    },
    win1252: "windows1252",
    cp1252: "windows1252",
    windows1253: {
      type: "_sbcs",
      chars: ""
    },
    win1253: "windows1253",
    cp1253: "windows1253",
    windows1254: {
      type: "_sbcs",
      chars: ""
    },
    win1254: "windows1254",
    cp1254: "windows1254",
    windows1255: {
      type: "_sbcs",
      chars: ""
    },
    win1255: "windows1255",
    cp1255: "windows1255",
    windows1256: {
      type: "_sbcs",
      chars: ""
    },
    win1256: "windows1256",
    cp1256: "windows1256",
    windows1257: {
      type: "_sbcs",
      chars: ""
    },
    win1257: "windows1257",
    cp1257: "windows1257",
    windows1258: {
      type: "_sbcs",
      chars: ""
    },
    win1258: "windows1258",
    cp1258: "windows1258",
    iso88591: {
      type: "_sbcs",
      chars: ""
    },
    cp28591: "iso88591",
    iso88592: {
      type: "_sbcs",
      chars: ""
    },
    cp28592: "iso88592",
    iso88593: {
      type: "_sbcs",
      chars: ""
    },
    cp28593: "iso88593",
    iso88594: {
      type: "_sbcs",
      chars: ""
    },
    cp28594: "iso88594",
    iso88595: {
      type: "_sbcs",
      chars: ""
    },
    cp28595: "iso88595",
    iso88596: {
      type: "_sbcs",
      chars: ""
    },
    cp28596: "iso88596",
    iso88597: {
      type: "_sbcs",
      chars: ""
    },
    cp28597: "iso88597",
    iso88598: {
      type: "_sbcs",
      chars: ""
    },
    cp28598: "iso88598",
    iso88599: {
      type: "_sbcs",
      chars: ""
    },
    cp28599: "iso88599",
    iso885910: {
      type: "_sbcs",
      chars: ""
    },
    cp28600: "iso885910",
    iso885911: {
      type: "_sbcs",
      chars: ""
    },
    cp28601: "iso885911",
    iso885913: {
      type: "_sbcs",
      chars: ""
    },
    cp28603: "iso885913",
    iso885914: {
      type: "_sbcs",
      chars: ""
    },
    cp28604: "iso885914",
    iso885915: {
      type: "_sbcs",
      chars: ""
    },
    cp28605: "iso885915",
    iso885916: {
      type: "_sbcs",
      chars: ""
    },
    cp28606: "iso885916",
    cp437: {
      type: "_sbcs",
      chars: ""
    },
    ibm437: "cp437",
    csibm437: "cp437",
    cp737: {
      type: "_sbcs",
      chars: ""
    },
    ibm737: "cp737",
    csibm737: "cp737",
    cp775: {
      type: "_sbcs",
      chars: ""
    },
    ibm775: "cp775",
    csibm775: "cp775",
    cp850: {
      type: "_sbcs",
      chars: ""
    },
    ibm850: "cp850",
    csibm850: "cp850",
    cp852: {
      type: "_sbcs",
      chars: ""
    },
    ibm852: "cp852",
    csibm852: "cp852",
    cp855: {
      type: "_sbcs",
      chars: ""
    },
    ibm855: "cp855",
    csibm855: "cp855",
    cp856: {
      type: "_sbcs",
      chars: ""
    },
    ibm856: "cp856",
    csibm856: "cp856",
    cp857: {
      type: "_sbcs",
      chars: ""
    },
    ibm857: "cp857",
    csibm857: "cp857",
    cp858: {
      type: "_sbcs",
      chars: ""
    },
    ibm858: "cp858",
    csibm858: "cp858",
    cp860: {
      type: "_sbcs",
      chars: ""
    },
    ibm860: "cp860",
    csibm860: "cp860",
    cp861: {
      type: "_sbcs",
      chars: ""
    },
    ibm861: "cp861",
    csibm861: "cp861",
    cp862: {
      type: "_sbcs",
      chars: ""
    },
    ibm862: "cp862",
    csibm862: "cp862",
    cp863: {
      type: "_sbcs",
      chars: ""
    },
    ibm863: "cp863",
    csibm863: "cp863",
    cp864: {
      type: "_sbcs",
      chars: `\0\x07\b	
\v\f\r\x1B !"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`
    },
    ibm864: "cp864",
    csibm864: "cp864",
    cp865: {
      type: "_sbcs",
      chars: ""
    },
    ibm865: "cp865",
    csibm865: "cp865",
    cp866: {
      type: "_sbcs",
      chars: ""
    },
    ibm866: "cp866",
    csibm866: "cp866",
    cp869: {
      type: "_sbcs",
      chars: ""
    },
    ibm869: "cp869",
    csibm869: "cp869",
    cp922: {
      type: "_sbcs",
      chars: ""
    },
    ibm922: "cp922",
    csibm922: "cp922",
    cp1046: {
      type: "_sbcs",
      chars: ""
    },
    ibm1046: "cp1046",
    csibm1046: "cp1046",
    cp1124: {
      type: "_sbcs",
      chars: ""
    },
    ibm1124: "cp1124",
    csibm1124: "cp1124",
    cp1125: {
      type: "_sbcs",
      chars: ""
    },
    ibm1125: "cp1125",
    csibm1125: "cp1125",
    cp1129: {
      type: "_sbcs",
      chars: ""
    },
    ibm1129: "cp1129",
    csibm1129: "cp1129",
    cp1133: {
      type: "_sbcs",
      chars: ""
    },
    ibm1133: "cp1133",
    csibm1133: "cp1133",
    cp1161: {
      type: "_sbcs",
      chars: ""
    },
    ibm1161: "cp1161",
    csibm1161: "cp1161",
    cp1162: {
      type: "_sbcs",
      chars: ""
    },
    ibm1162: "cp1162",
    csibm1162: "cp1162",
    cp1163: {
      type: "_sbcs",
      chars: ""
    },
    ibm1163: "cp1163",
    csibm1163: "cp1163",
    maccroatian: {
      type: "_sbcs",
      chars: ""
    },
    maccyrillic: {
      type: "_sbcs",
      chars: ""
    },
    macgreek: {
      type: "_sbcs",
      chars: ""
    },
    maciceland: {
      type: "_sbcs",
      chars: ""
    },
    macroman: {
      type: "_sbcs",
      chars: ""
    },
    macromania: {
      type: "_sbcs",
      chars: ""
    },
    macthai: {
      type: "_sbcs",
      chars: "\uFEFF"
    },
    macturkish: {
      type: "_sbcs",
      chars: ""
    },
    macukraine: {
      type: "_sbcs",
      chars: ""
    },
    koi8r: {
      type: "_sbcs",
      chars: ""
    },
    koi8u: {
      type: "_sbcs",
      chars: ""
    },
    koi8ru: {
      type: "_sbcs",
      chars: ""
    },
    koi8t: {
      type: "_sbcs",
      chars: ""
    },
    armscii8: {
      type: "_sbcs",
      chars: ")(.,-"
    },
    rk1048: {
      type: "_sbcs",
      chars: ""
    },
    tcvn: {
      type: "_sbcs",
      chars: `\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`
    },
    georgianacademy: {
      type: "_sbcs",
      chars: ""
    },
    georgianps: {
      type: "_sbcs",
      chars: ""
    },
    pt154: {
      type: "_sbcs",
      chars: ""
    },
    viscii: {
      type: "_sbcs",
      chars: `\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`
    },
    iso646cn: {
      type: "_sbcs",
      chars: `\0\x07\b	
\v\f\r\x1B !"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}`
    },
    iso646jp: {
      type: "_sbcs",
      chars: `\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_\`abcdefghijklmnopqrstuvwxyz{|}`
    },
    hproman8: {
      type: "_sbcs",
      chars: ""
    },
    macintosh: {
      type: "_sbcs",
      chars: ""
    },
    ascii: {
      type: "_sbcs",
      chars: ""
    },
    tis620: {
      type: "_sbcs",
      chars: ""
    }
  }), gh;
}
var yh = {}, R0;
function Rw() {
  if (R0) return yh;
  R0 = 1;
  var e = Wa.Buffer;
  yh._dbcs = u;
  for (var t = -1, r = -2, n = -10, i = -1e3, a = new Array(256), s = -1, o = 0; o < 256; o++)
    a[o] = t;
  function u(h, d) {
    if (this.encodingName = h.encodingName, !h)
      throw new Error("DBCS codec is called without the data.");
    if (!h.table)
      throw new Error("Encoding '" + this.encodingName + "' has no data.");
    var g = h.table();
    this.decodeTables = [], this.decodeTables[0] = a.slice(0), this.decodeTableSeq = [];
    for (var v = 0; v < g.length; v++)
      this._addDecodeChunk(g[v]);
    if (typeof h.gb18030 == "function") {
      this.gb18030 = h.gb18030();
      var m = this.decodeTables.length;
      this.decodeTables.push(a.slice(0));
      var p = this.decodeTables.length;
      this.decodeTables.push(a.slice(0));
      for (var y = this.decodeTables[0], v = 129; v <= 254; v++)
        for (var w = this.decodeTables[i - y[v]], x = 48; x <= 57; x++) {
          if (w[x] === t)
            w[x] = i - m;
          else if (w[x] > i)
            throw new Error("gb18030 decode tables conflict at byte 2");
          for (var b = this.decodeTables[i - w[x]], M = 129; M <= 254; M++) {
            if (b[M] === t)
              b[M] = i - p;
            else {
              if (b[M] === i - p)
                continue;
              if (b[M] > i)
                throw new Error("gb18030 decode tables conflict at byte 3");
            }
            for (var k = this.decodeTables[i - b[M]], E = 48; E <= 57; E++)
              k[E] === t && (k[E] = r);
          }
        }
    }
    this.defaultCharUnicode = d.defaultCharUnicode, this.encodeTable = [], this.encodeTableSeq = [];
    var S = {};
    if (h.encodeSkipVals)
      for (var v = 0; v < h.encodeSkipVals.length; v++) {
        var F = h.encodeSkipVals[v];
        if (typeof F == "number")
          S[F] = !0;
        else
          for (var x = F.from; x <= F.to; x++)
            S[x] = !0;
      }
    if (this._fillEncodeTable(0, 0, S), h.encodeAdd)
      for (var O in h.encodeAdd)
        Object.prototype.hasOwnProperty.call(h.encodeAdd, O) && this._setEncodeChar(O.charCodeAt(0), h.encodeAdd[O]);
    this.defCharSB = this.encodeTable[0][d.defaultCharSingleByte.charCodeAt(0)], this.defCharSB === t && (this.defCharSB = this.encodeTable[0]["?"]), this.defCharSB === t && (this.defCharSB = 63);
  }
  u.prototype.encoder = l, u.prototype.decoder = c, u.prototype._getDecodeTrieNode = function(h) {
    for (var d = []; h > 0; h >>>= 8)
      d.push(h & 255);
    d.length == 0 && d.push(0);
    for (var g = this.decodeTables[0], v = d.length - 1; v > 0; v--) {
      var m = g[d[v]];
      if (m == t)
        g[d[v]] = i - this.decodeTables.length, this.decodeTables.push(g = a.slice(0));
      else if (m <= i)
        g = this.decodeTables[i - m];
      else
        throw new Error("Overwrite byte in " + this.encodingName + ", addr: " + h.toString(16));
    }
    return g;
  }, u.prototype._addDecodeChunk = function(h) {
    var d = parseInt(h[0], 16), g = this._getDecodeTrieNode(d);
    d = d & 255;
    for (var v = 1; v < h.length; v++) {
      var m = h[v];
      if (typeof m == "string")
        for (var p = 0; p < m.length; ) {
          var y = m.charCodeAt(p++);
          if (55296 <= y && y < 56320) {
            var w = m.charCodeAt(p++);
            if (56320 <= w && w < 57344)
              g[d++] = 65536 + (y - 55296) * 1024 + (w - 56320);
            else
              throw new Error("Incorrect surrogate pair in " + this.encodingName + " at chunk " + h[0]);
          } else if (4080 < y && y <= 4095) {
            for (var x = 4095 - y + 2, b = [], M = 0; M < x; M++)
              b.push(m.charCodeAt(p++));
            g[d++] = n - this.decodeTableSeq.length, this.decodeTableSeq.push(b);
          } else
            g[d++] = y;
        }
      else if (typeof m == "number")
        for (var k = g[d - 1] + 1, p = 0; p < m; p++)
          g[d++] = k++;
      else
        throw new Error("Incorrect type '" + typeof m + "' given in " + this.encodingName + " at chunk " + h[0]);
    }
    if (d > 255)
      throw new Error("Incorrect chunk in " + this.encodingName + " at addr " + h[0] + ": too long" + d);
  }, u.prototype._getEncodeBucket = function(h) {
    var d = h >> 8;
    return this.encodeTable[d] === void 0 && (this.encodeTable[d] = a.slice(0)), this.encodeTable[d];
  }, u.prototype._setEncodeChar = function(h, d) {
    var g = this._getEncodeBucket(h), v = h & 255;
    g[v] <= n ? this.encodeTableSeq[n - g[v]][s] = d : g[v] == t && (g[v] = d);
  }, u.prototype._setEncodeSequence = function(h, d) {
    var g = h[0], v = this._getEncodeBucket(g), m = g & 255, p;
    v[m] <= n ? p = this.encodeTableSeq[n - v[m]] : (p = {}, v[m] !== t && (p[s] = v[m]), v[m] = n - this.encodeTableSeq.length, this.encodeTableSeq.push(p));
    for (var y = 1; y < h.length - 1; y++) {
      var w = p[g];
      typeof w == "object" ? p = w : (p = p[g] = {}, w !== void 0 && (p[s] = w));
    }
    g = h[h.length - 1], p[g] = d;
  }, u.prototype._fillEncodeTable = function(h, d, g) {
    for (var v = this.decodeTables[h], m = !1, p = {}, y = 0; y < 256; y++) {
      var w = v[y], x = d + y;
      if (!g[x])
        if (w >= 0)
          this._setEncodeChar(w, x), m = !0;
        else if (w <= i) {
          var b = i - w;
          if (!p[b]) {
            var M = x << 8 >>> 0;
            this._fillEncodeTable(b, M, g) ? m = !0 : p[b] = !0;
          }
        } else w <= n && (this._setEncodeSequence(this.decodeTableSeq[n - w], x), m = !0);
    }
    return m;
  };
  function l(h, d) {
    this.leadSurrogate = -1, this.seqObj = void 0, this.encodeTable = d.encodeTable, this.encodeTableSeq = d.encodeTableSeq, this.defaultCharSingleByte = d.defCharSB, this.gb18030 = d.gb18030;
  }
  l.prototype.write = function(h) {
    for (var d = e.alloc(h.length * (this.gb18030 ? 4 : 3)), g = this.leadSurrogate, v = this.seqObj, m = -1, p = 0, y = 0; ; ) {
      if (m === -1) {
        if (p == h.length) break;
        var w = h.charCodeAt(p++);
      } else {
        var w = m;
        m = -1;
      }
      if (55296 <= w && w < 57344)
        if (w < 56320)
          if (g === -1) {
            g = w;
            continue;
          } else
            g = w, w = t;
        else
          g !== -1 ? (w = 65536 + (g - 55296) * 1024 + (w - 56320), g = -1) : w = t;
      else g !== -1 && (m = w, w = t, g = -1);
      var x = t;
      if (v !== void 0 && w != t) {
        var b = v[w];
        if (typeof b == "object") {
          v = b;
          continue;
        } else typeof b == "number" ? x = b : b == null && (b = v[s], b !== void 0 && (x = b, m = w));
        v = void 0;
      } else if (w >= 0) {
        var M = this.encodeTable[w >> 8];
        if (M !== void 0 && (x = M[w & 255]), x <= n) {
          v = this.encodeTableSeq[n - x];
          continue;
        }
        if (x == t && this.gb18030) {
          var k = f(this.gb18030.uChars, w);
          if (k != -1) {
            var x = this.gb18030.gbChars[k] + (w - this.gb18030.uChars[k]);
            d[y++] = 129 + Math.floor(x / 12600), x = x % 12600, d[y++] = 48 + Math.floor(x / 1260), x = x % 1260, d[y++] = 129 + Math.floor(x / 10), x = x % 10, d[y++] = 48 + x;
            continue;
          }
        }
      }
      x === t && (x = this.defaultCharSingleByte), x < 256 ? d[y++] = x : x < 65536 ? (d[y++] = x >> 8, d[y++] = x & 255) : x < 16777216 ? (d[y++] = x >> 16, d[y++] = x >> 8 & 255, d[y++] = x & 255) : (d[y++] = x >>> 24, d[y++] = x >>> 16 & 255, d[y++] = x >>> 8 & 255, d[y++] = x & 255);
    }
    return this.seqObj = v, this.leadSurrogate = g, d.slice(0, y);
  }, l.prototype.end = function() {
    if (!(this.leadSurrogate === -1 && this.seqObj === void 0)) {
      var h = e.alloc(10), d = 0;
      if (this.seqObj) {
        var g = this.seqObj[s];
        g !== void 0 && (g < 256 ? h[d++] = g : (h[d++] = g >> 8, h[d++] = g & 255)), this.seqObj = void 0;
      }
      return this.leadSurrogate !== -1 && (h[d++] = this.defaultCharSingleByte, this.leadSurrogate = -1), h.slice(0, d);
    }
  }, l.prototype.findIdx = f;
  function c(h, d) {
    this.nodeIdx = 0, this.prevBytes = [], this.decodeTables = d.decodeTables, this.decodeTableSeq = d.decodeTableSeq, this.defaultCharUnicode = d.defaultCharUnicode, this.gb18030 = d.gb18030;
  }
  c.prototype.write = function(h) {
    for (var d = e.alloc(h.length * 2), g = this.nodeIdx, v = this.prevBytes, m = this.prevBytes.length, p = -this.prevBytes.length, y, w = 0, x = 0; w < h.length; w++) {
      var b = w >= 0 ? h[w] : v[w + m], y = this.decodeTables[g][b];
      if (!(y >= 0)) if (y === t)
        y = this.defaultCharUnicode.charCodeAt(0), w = p;
      else if (y === r) {
        if (w >= 3)
          var M = (h[w - 3] - 129) * 12600 + (h[w - 2] - 48) * 1260 + (h[w - 1] - 129) * 10 + (b - 48);
        else
          var M = (v[w - 3 + m] - 129) * 12600 + ((w - 2 >= 0 ? h[w - 2] : v[w - 2 + m]) - 48) * 1260 + ((w - 1 >= 0 ? h[w - 1] : v[w - 1 + m]) - 129) * 10 + (b - 48);
        var k = f(this.gb18030.gbChars, M);
        y = this.gb18030.uChars[k] + M - this.gb18030.gbChars[k];
      } else if (y <= i) {
        g = i - y;
        continue;
      } else if (y <= n) {
        for (var E = this.decodeTableSeq[n - y], S = 0; S < E.length - 1; S++)
          y = E[S], d[x++] = y & 255, d[x++] = y >> 8;
        y = E[E.length - 1];
      } else
        throw new Error("iconv-lite internal error: invalid decoding table value " + y + " at " + g + "/" + b);
      if (y >= 65536) {
        y -= 65536;
        var F = 55296 | y >> 10;
        d[x++] = F & 255, d[x++] = F >> 8, y = 56320 | y & 1023;
      }
      d[x++] = y & 255, d[x++] = y >> 8, g = 0, p = w + 1;
    }
    return this.nodeIdx = g, this.prevBytes = p >= 0 ? Array.prototype.slice.call(h, p) : v.slice(p + m).concat(Array.prototype.slice.call(h)), d.slice(0, x).toString("ucs2");
  }, c.prototype.end = function() {
    for (var h = ""; this.prevBytes.length > 0; ) {
      h += this.defaultCharUnicode;
      var d = this.prevBytes.slice(1);
      this.prevBytes = [], this.nodeIdx = 0, d.length > 0 && (h += this.write(d));
    }
    return this.prevBytes = [], this.nodeIdx = 0, h;
  };
  function f(h, d) {
    if (h[0] > d)
      return -1;
    for (var g = 0, v = h.length; g < v - 1; ) {
      var m = g + (v - g + 1 >> 1);
      h[m] <= d ? g = m : v = m;
    }
    return g;
  }
  return yh;
}
const Ow = [
  [
    "0",
    "\0",
    128
  ],
  [
    "a1",
    "",
    62
  ],
  [
    "8140",
    "",
    9,
    ""
  ],
  [
    "8180",
    ""
  ],
  [
    "81b8",
    ""
  ],
  [
    "81c8",
    ""
  ],
  [
    "81da",
    ""
  ],
  [
    "81f0",
    ""
  ],
  [
    "81fc",
    ""
  ],
  [
    "824f",
    "",
    9
  ],
  [
    "8260",
    "",
    25
  ],
  [
    "8281",
    "",
    25
  ],
  [
    "829f",
    "",
    82
  ],
  [
    "8340",
    "",
    62
  ],
  [
    "8380",
    "",
    22
  ],
  [
    "839f",
    "",
    16,
    "",
    6
  ],
  [
    "83bf",
    "",
    16,
    "",
    6
  ],
  [
    "8440",
    "",
    5,
    "",
    25
  ],
  [
    "8470",
    "",
    5,
    "",
    7
  ],
  [
    "8480",
    "",
    17
  ],
  [
    "849f",
    ""
  ],
  [
    "8740",
    "",
    19,
    "",
    9
  ],
  [
    "875f",
    ""
  ],
  [
    "877e",
    ""
  ],
  [
    "8780",
    "",
    4,
    ""
  ],
  [
    "889f",
    ""
  ],
  [
    "8940",
    ""
  ],
  [
    "8980",
    ""
  ],
  [
    "8a40",
    ""
  ],
  [
    "8a80",
    ""
  ],
  [
    "8b40",
    ""
  ],
  [
    "8b80",
    ""
  ],
  [
    "8c40",
    ""
  ],
  [
    "8c80",
    ""
  ],
  [
    "8d40",
    ""
  ],
  [
    "8d80",
    ""
  ],
  [
    "8e40",
    ""
  ],
  [
    "8e80",
    ""
  ],
  [
    "8f40",
    ""
  ],
  [
    "8f80",
    ""
  ],
  [
    "9040",
    ""
  ],
  [
    "9080",
    ""
  ],
  [
    "9140",
    ""
  ],
  [
    "9180",
    ""
  ],
  [
    "9240",
    ""
  ],
  [
    "9280",
    ""
  ],
  [
    "9340",
    ""
  ],
  [
    "9380",
    ""
  ],
  [
    "9440",
    ""
  ],
  [
    "9480",
    ""
  ],
  [
    "9540",
    ""
  ],
  [
    "9580",
    ""
  ],
  [
    "9640",
    ""
  ],
  [
    "9680",
    ""
  ],
  [
    "9740",
    ""
  ],
  [
    "9780",
    ""
  ],
  [
    "9840",
    ""
  ],
  [
    "989f",
    ""
  ],
  [
    "9940",
    ""
  ],
  [
    "9980",
    ""
  ],
  [
    "9a40",
    ""
  ],
  [
    "9a80",
    ""
  ],
  [
    "9b40",
    ""
  ],
  [
    "9b80",
    ""
  ],
  [
    "9c40",
    ""
  ],
  [
    "9c80",
    ""
  ],
  [
    "9d40",
    ""
  ],
  [
    "9d80",
    ""
  ],
  [
    "9e40",
    ""
  ],
  [
    "9e80",
    ""
  ],
  [
    "9f40",
    ""
  ],
  [
    "9f80",
    ""
  ],
  [
    "e040",
    ""
  ],
  [
    "e080",
    ""
  ],
  [
    "e140",
    ""
  ],
  [
    "e180",
    ""
  ],
  [
    "e240",
    ""
  ],
  [
    "e280",
    ""
  ],
  [
    "e340",
    ""
  ],
  [
    "e380",
    ""
  ],
  [
    "e440",
    ""
  ],
  [
    "e480",
    ""
  ],
  [
    "e540",
    ""
  ],
  [
    "e580",
    ""
  ],
  [
    "e640",
    ""
  ],
  [
    "e680",
    ""
  ],
  [
    "e740",
    ""
  ],
  [
    "e780",
    ""
  ],
  [
    "e840",
    ""
  ],
  [
    "e880",
    ""
  ],
  [
    "e940",
    ""
  ],
  [
    "e980",
    ""
  ],
  [
    "ea40",
    ""
  ],
  [
    "ea80",
    ""
  ],
  [
    "ed40",
    ""
  ],
  [
    "ed80",
    ""
  ],
  [
    "ee40",
    ""
  ],
  [
    "ee80",
    ""
  ],
  [
    "eeef",
    "",
    9,
    ""
  ],
  [
    "f040",
    "",
    62
  ],
  [
    "f080",
    "",
    124
  ],
  [
    "f140",
    "",
    62
  ],
  [
    "f180",
    "",
    124
  ],
  [
    "f240",
    "",
    62
  ],
  [
    "f280",
    "",
    124
  ],
  [
    "f340",
    "",
    62
  ],
  [
    "f380",
    "",
    124
  ],
  [
    "f440",
    "",
    62
  ],
  [
    "f480",
    "",
    124
  ],
  [
    "f540",
    "",
    62
  ],
  [
    "f580",
    "",
    124
  ],
  [
    "f640",
    "",
    62
  ],
  [
    "f680",
    "",
    124
  ],
  [
    "f740",
    "",
    62
  ],
  [
    "f780",
    "",
    124
  ],
  [
    "f840",
    "",
    62
  ],
  [
    "f880",
    "",
    124
  ],
  [
    "f940",
    ""
  ],
  [
    "fa40",
    "",
    9,
    "",
    9,
    ""
  ],
  [
    "fa80",
    ""
  ],
  [
    "fb40",
    ""
  ],
  [
    "fb80",
    ""
  ],
  [
    "fc40",
    ""
  ]
], Nw = [
  [
    "0",
    "\0",
    127
  ],
  [
    "8ea1",
    "",
    62
  ],
  [
    "a1a1",
    "",
    9,
    ""
  ],
  [
    "a2a1",
    ""
  ],
  [
    "a2ba",
    ""
  ],
  [
    "a2ca",
    ""
  ],
  [
    "a2dc",
    ""
  ],
  [
    "a2f2",
    ""
  ],
  [
    "a2fe",
    ""
  ],
  [
    "a3b0",
    "",
    9
  ],
  [
    "a3c1",
    "",
    25
  ],
  [
    "a3e1",
    "",
    25
  ],
  [
    "a4a1",
    "",
    82
  ],
  [
    "a5a1",
    "",
    85
  ],
  [
    "a6a1",
    "",
    16,
    "",
    6
  ],
  [
    "a6c1",
    "",
    16,
    "",
    6
  ],
  [
    "a7a1",
    "",
    5,
    "",
    25
  ],
  [
    "a7d1",
    "",
    5,
    "",
    25
  ],
  [
    "a8a1",
    ""
  ],
  [
    "ada1",
    "",
    19,
    "",
    9
  ],
  [
    "adc0",
    ""
  ],
  [
    "addf",
    "",
    4,
    ""
  ],
  [
    "b0a1",
    ""
  ],
  [
    "b1a1",
    ""
  ],
  [
    "b2a1",
    ""
  ],
  [
    "b3a1",
    ""
  ],
  [
    "b4a1",
    ""
  ],
  [
    "b5a1",
    ""
  ],
  [
    "b6a1",
    ""
  ],
  [
    "b7a1",
    ""
  ],
  [
    "b8a1",
    ""
  ],
  [
    "b9a1",
    ""
  ],
  [
    "baa1",
    ""
  ],
  [
    "bba1",
    ""
  ],
  [
    "bca1",
    ""
  ],
  [
    "bda1",
    ""
  ],
  [
    "bea1",
    ""
  ],
  [
    "bfa1",
    ""
  ],
  [
    "c0a1",
    ""
  ],
  [
    "c1a1",
    ""
  ],
  [
    "c2a1",
    ""
  ],
  [
    "c3a1",
    ""
  ],
  [
    "c4a1",
    ""
  ],
  [
    "c5a1",
    ""
  ],
  [
    "c6a1",
    ""
  ],
  [
    "c7a1",
    ""
  ],
  [
    "c8a1",
    ""
  ],
  [
    "c9a1",
    ""
  ],
  [
    "caa1",
    ""
  ],
  [
    "cba1",
    ""
  ],
  [
    "cca1",
    ""
  ],
  [
    "cda1",
    ""
  ],
  [
    "cea1",
    ""
  ],
  [
    "cfa1",
    ""
  ],
  [
    "d0a1",
    ""
  ],
  [
    "d1a1",
    ""
  ],
  [
    "d2a1",
    ""
  ],
  [
    "d3a1",
    ""
  ],
  [
    "d4a1",
    ""
  ],
  [
    "d5a1",
    ""
  ],
  [
    "d6a1",
    ""
  ],
  [
    "d7a1",
    ""
  ],
  [
    "d8a1",
    ""
  ],
  [
    "d9a1",
    ""
  ],
  [
    "daa1",
    ""
  ],
  [
    "dba1",
    ""
  ],
  [
    "dca1",
    ""
  ],
  [
    "dda1",
    ""
  ],
  [
    "dea1",
    ""
  ],
  [
    "dfa1",
    ""
  ],
  [
    "e0a1",
    ""
  ],
  [
    "e1a1",
    ""
  ],
  [
    "e2a1",
    ""
  ],
  [
    "e3a1",
    ""
  ],
  [
    "e4a1",
    ""
  ],
  [
    "e5a1",
    ""
  ],
  [
    "e6a1",
    ""
  ],
  [
    "e7a1",
    ""
  ],
  [
    "e8a1",
    ""
  ],
  [
    "e9a1",
    ""
  ],
  [
    "eaa1",
    ""
  ],
  [
    "eba1",
    ""
  ],
  [
    "eca1",
    ""
  ],
  [
    "eda1",
    ""
  ],
  [
    "eea1",
    ""
  ],
  [
    "efa1",
    ""
  ],
  [
    "f0a1",
    ""
  ],
  [
    "f1a1",
    ""
  ],
  [
    "f2a1",
    ""
  ],
  [
    "f3a1",
    ""
  ],
  [
    "f4a1",
    ""
  ],
  [
    "f9a1",
    ""
  ],
  [
    "faa1",
    ""
  ],
  [
    "fba1",
    ""
  ],
  [
    "fca1",
    ""
  ],
  [
    "fcf1",
    "",
    9,
    ""
  ],
  [
    "8fa2af",
    ""
  ],
  [
    "8fa2c2",
    ""
  ],
  [
    "8fa2eb",
    ""
  ],
  [
    "8fa6e1",
    ""
  ],
  [
    "8fa6e7",
    ""
  ],
  [
    "8fa6e9",
    ""
  ],
  [
    "8fa6ec",
    ""
  ],
  [
    "8fa6f1",
    ""
  ],
  [
    "8fa7c2",
    "",
    10,
    ""
  ],
  [
    "8fa7f2",
    "",
    10,
    ""
  ],
  [
    "8fa9a1",
    ""
  ],
  [
    "8fa9a4",
    ""
  ],
  [
    "8fa9a6",
    ""
  ],
  [
    "8fa9a8",
    ""
  ],
  [
    "8fa9ab",
    ""
  ],
  [
    "8fa9af",
    ""
  ],
  [
    "8fa9c1",
    ""
  ],
  [
    "8faaa1",
    ""
  ],
  [
    "8faaba",
    ""
  ],
  [
    "8faba1",
    ""
  ],
  [
    "8fabbd",
    ""
  ],
  [
    "8fabc5",
    ""
  ],
  [
    "8fb0a1",
    ""
  ],
  [
    "8fb1a1",
    ""
  ],
  [
    "8fb2a1",
    "",
    4,
    ""
  ],
  [
    "8fb3a1",
    ""
  ],
  [
    "8fb4a1",
    ""
  ],
  [
    "8fb5a1",
    ""
  ],
  [
    "8fb6a1",
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "8fb7a1",
    "",
    4,
    ""
  ],
  [
    "8fb8a1",
    ""
  ],
  [
    "8fb9a1",
    ""
  ],
  [
    "8fbaa1",
    "",
    4,
    ""
  ],
  [
    "8fbba1",
    ""
  ],
  [
    "8fbca1",
    "",
    4,
    ""
  ],
  [
    "8fbda1",
    "",
    4,
    ""
  ],
  [
    "8fbea1",
    "",
    4,
    ""
  ],
  [
    "8fbfa1",
    ""
  ],
  [
    "8fc0a1",
    ""
  ],
  [
    "8fc1a1",
    ""
  ],
  [
    "8fc2a1",
    ""
  ],
  [
    "8fc3a1",
    "",
    4,
    ""
  ],
  [
    "8fc4a1",
    ""
  ],
  [
    "8fc5a1",
    ""
  ],
  [
    "8fc6a1",
    ""
  ],
  [
    "8fc7a1",
    ""
  ],
  [
    "8fc8a1",
    ""
  ],
  [
    "8fc9a1",
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "8fcaa1",
    ""
  ],
  [
    "8fcba1",
    ""
  ],
  [
    "8fcca1",
    "",
    9,
    ""
  ],
  [
    "8fcda1",
    "",
    5,
    ""
  ],
  [
    "8fcea1",
    "",
    6,
    ""
  ],
  [
    "8fcfa1",
    ""
  ],
  [
    "8fd0a1",
    ""
  ],
  [
    "8fd1a1",
    ""
  ],
  [
    "8fd2a1",
    "",
    5
  ],
  [
    "8fd3a1",
    ""
  ],
  [
    "8fd4a1",
    "",
    4,
    ""
  ],
  [
    "8fd5a1",
    ""
  ],
  [
    "8fd6a1",
    ""
  ],
  [
    "8fd7a1",
    ""
  ],
  [
    "8fd8a1",
    ""
  ],
  [
    "8fd9a1",
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "8fdaa1",
    "",
    4,
    ""
  ],
  [
    "8fdba1",
    "",
    6,
    ""
  ],
  [
    "8fdca1",
    "",
    4,
    ""
  ],
  [
    "8fdda1",
    "",
    4,
    ""
  ],
  [
    "8fdea1",
    "",
    4,
    ""
  ],
  [
    "8fdfa1",
    ""
  ],
  [
    "8fe0a1",
    ""
  ],
  [
    "8fe1a1",
    "",
    4,
    ""
  ],
  [
    "8fe2a1",
    ""
  ],
  [
    "8fe3a1",
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "8fe4a1",
    "",
    4,
    ""
  ],
  [
    "8fe5a1",
    "",
    4,
    ""
  ],
  [
    "8fe6a1",
    ""
  ],
  [
    "8fe7a1",
    ""
  ],
  [
    "8fe8a1",
    "",
    4,
    ""
  ],
  [
    "8fe9a1",
    "",
    4
  ],
  [
    "8feaa1",
    "",
    4,
    ""
  ],
  [
    "8feba1",
    "",
    4,
    ""
  ],
  [
    "8feca1",
    ""
  ],
  [
    "8feda1",
    "",
    4,
    "",
    4,
    ""
  ]
], bh = [
  [
    "0",
    "\0",
    127,
    ""
  ],
  [
    "8140",
    "",
    5,
    "",
    9,
    "",
    6,
    ""
  ],
  [
    "8180",
    "",
    6,
    "",
    4,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "8240",
    "",
    4,
    "",
    8,
    "",
    4,
    "",
    11
  ],
  [
    "8280",
    "",
    10,
    "",
    4,
    "",
    7,
    "",
    5,
    "",
    8,
    "",
    20,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "8340",
    "",
    17,
    "",
    5,
    "",
    10,
    "",
    4,
    "",
    9,
    ""
  ],
  [
    "8380",
    "",
    5,
    "",
    13,
    "",
    28,
    "",
    4,
    "",
    4,
    "",
    5
  ],
  [
    "8440",
    "",
    5,
    "",
    5,
    ""
  ],
  [
    "8480",
    "",
    9,
    "",
    4,
    "",
    6,
    "",
    6,
    "",
    9,
    "",
    5,
    "",
    10,
    "",
    7,
    ""
  ],
  [
    "8540",
    "",
    9,
    ""
  ],
  [
    "8580",
    "",
    4,
    "",
    6,
    "",
    4,
    "",
    4,
    "",
    7,
    ""
  ],
  [
    "8640",
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "8680",
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    6,
    "",
    8,
    "",
    4,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "8740",
    "",
    7,
    "",
    11,
    "",
    4,
    "",
    4
  ],
  [
    "8780",
    "",
    7,
    "",
    6,
    "",
    14,
    "",
    10,
    "",
    6,
    "",
    12,
    "",
    8,
    "",
    5,
    "",
    6
  ],
  [
    "8840",
    "",
    9,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "8880",
    "",
    4,
    "",
    6,
    "",
    8,
    "",
    6,
    "",
    7,
    "",
    4,
    "",
    4,
    "",
    7
  ],
  [
    "8940",
    "",
    5,
    "",
    6,
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    16,
    ""
  ],
  [
    "8980",
    "",
    4,
    "",
    4,
    "",
    7,
    "",
    17,
    "",
    10,
    "",
    13,
    "",
    5,
    "",
    7,
    "",
    4,
    ""
  ],
  [
    "8a40",
    "",
    4,
    "",
    12,
    ""
  ],
  [
    "8a80",
    "",
    5,
    "",
    6,
    "",
    4,
    "",
    11,
    "",
    6,
    "",
    4,
    "",
    4,
    "",
    9,
    "",
    5
  ],
  [
    "8b40",
    "",
    8,
    "",
    17,
    "",
    6,
    "",
    13,
    ""
  ],
  [
    "8b80",
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    22,
    "",
    11,
    "",
    25,
    "",
    7,
    "",
    6
  ],
  [
    "8c40",
    "",
    7,
    ""
  ],
  [
    "8c80",
    "",
    8,
    "",
    4,
    "",
    6,
    "",
    6,
    "",
    6,
    "",
    4,
    "",
    4,
    "",
    4
  ],
  [
    "8d40",
    "",
    5,
    "",
    5,
    "",
    5,
    "",
    6,
    "",
    9,
    "",
    4
  ],
  [
    "8d80",
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    4,
    "",
    7,
    "",
    7,
    "",
    10,
    "",
    10,
    "",
    12,
    "",
    21,
    ""
  ],
  [
    "8e40",
    "",
    21,
    "",
    12,
    "",
    6,
    "",
    12,
    ""
  ],
  [
    "8e80",
    "",
    4,
    "",
    7,
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    6,
    "",
    4,
    "",
    14,
    "",
    4,
    "",
    4,
    "",
    6
  ],
  [
    "8f40",
    "",
    5,
    "",
    11,
    "",
    8,
    ""
  ],
  [
    "8f80",
    "",
    6,
    "",
    14,
    "",
    5,
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "9040",
    "",
    4,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "9080",
    "",
    7,
    "",
    4,
    "",
    4,
    "",
    4,
    "",
    4,
    "",
    18,
    "",
    6
  ],
  [
    "9140",
    "",
    6,
    "",
    6,
    "",
    18,
    "",
    4,
    ""
  ],
  [
    "9180",
    "",
    6,
    "",
    8,
    "",
    9,
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    16,
    "",
    13,
    "",
    8,
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "9240",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9280",
    "",
    5,
    "",
    7,
    "",
    6,
    ""
  ],
  [
    "9340",
    "",
    6,
    "",
    4,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "9380",
    "",
    5,
    "",
    4,
    "",
    6,
    "",
    4,
    "",
    7,
    "",
    9,
    "",
    6,
    "",
    8,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "9440",
    "",
    24,
    "",
    7,
    "",
    7,
    "",
    4,
    "",
    8
  ],
  [
    "9480",
    "",
    4,
    "",
    4,
    "",
    14,
    "",
    7,
    "",
    7,
    ""
  ],
  [
    "9540",
    "",
    4,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "9580",
    "",
    4,
    "",
    4,
    "",
    8,
    "",
    4,
    "",
    4,
    "",
    25,
    "",
    7,
    "",
    5,
    ""
  ],
  [
    "9640",
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "9680",
    "",
    7,
    "",
    9,
    "",
    7,
    "",
    4,
    "",
    6,
    "",
    6,
    "",
    5
  ],
  [
    "9740",
    "",
    7,
    "",
    8,
    "",
    7,
    "",
    9,
    ""
  ],
  [
    "9780",
    "",
    6,
    "",
    5,
    "",
    4,
    "",
    9,
    "",
    4,
    "",
    11,
    "",
    7,
    "",
    16,
    ""
  ],
  [
    "9840",
    "",
    4,
    "",
    5,
    "",
    9,
    ""
  ],
  [
    "9880",
    "",
    7,
    "",
    5,
    "",
    11,
    "",
    9,
    "",
    9,
    "",
    11,
    "",
    5,
    "",
    5,
    "",
    6,
    "",
    4,
    "",
    7,
    "",
    6,
    ""
  ],
  [
    "9940",
    "",
    4,
    "",
    10,
    "",
    6,
    "",
    8,
    "",
    4,
    "",
    7,
    "",
    5
  ],
  [
    "9980",
    "",
    114,
    "",
    6
  ],
  [
    "9a40",
    "",
    11,
    "",
    7,
    "",
    13,
    ""
  ],
  [
    "9a80",
    "",
    4,
    "",
    7,
    "",
    7,
    "",
    6,
    "",
    4,
    "",
    4,
    "",
    7,
    "",
    6,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "9b40",
    "",
    4,
    ""
  ],
  [
    "9b80",
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "9c40",
    "",
    7,
    ""
  ],
  [
    "9c80",
    "",
    7,
    "",
    7,
    "",
    10,
    "",
    14,
    "",
    4,
    "",
    6,
    "",
    5
  ],
  [
    "9d40",
    "",
    7,
    "",
    4,
    "",
    9,
    "",
    6,
    ""
  ],
  [
    "9d80",
    "",
    9,
    "",
    5,
    "",
    6,
    "",
    12,
    "",
    4,
    "",
    10,
    "",
    5,
    "",
    5,
    "",
    6,
    "",
    10,
    ""
  ],
  [
    "9e40",
    "",
    7,
    "",
    32,
    "",
    7,
    "",
    6,
    "",
    6
  ],
  [
    "9e80",
    "",
    9,
    "",
    17,
    "",
    13,
    "",
    11,
    "",
    12,
    "",
    12,
    ""
  ],
  [
    "9f40",
    "",
    6,
    "",
    10,
    "",
    4,
    "",
    10,
    "",
    7,
    ""
  ],
  [
    "9f80",
    "",
    13,
    "",
    12,
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    8,
    "",
    9,
    "",
    4
  ],
  [
    "a040",
    "",
    9,
    "",
    5,
    "",
    9,
    "",
    11,
    "",
    19
  ],
  [
    "a080",
    "",
    9,
    "",
    6,
    "",
    4,
    "",
    11,
    "",
    11,
    "",
    6,
    ""
  ],
  [
    "a1a1",
    "",
    7,
    ""
  ],
  [
    "a2a1",
    "",
    9
  ],
  [
    "a2b1",
    "",
    19,
    "",
    19,
    "",
    9
  ],
  [
    "a2e5",
    "",
    9
  ],
  [
    "a2f1",
    "",
    11
  ],
  [
    "a3a1",
    "",
    88,
    ""
  ],
  [
    "a4a1",
    "",
    82
  ],
  [
    "a5a1",
    "",
    85
  ],
  [
    "a6a1",
    "",
    16,
    "",
    6
  ],
  [
    "a6c1",
    "",
    16,
    "",
    6
  ],
  [
    "a6e0",
    ""
  ],
  [
    "a6ee",
    ""
  ],
  [
    "a6f4",
    ""
  ],
  [
    "a7a1",
    "",
    5,
    "",
    25
  ],
  [
    "a7d1",
    "",
    5,
    "",
    25
  ],
  [
    "a840",
    "",
    35,
    "",
    6
  ],
  [
    "a880",
    "",
    7,
    ""
  ],
  [
    "a8a1",
    ""
  ],
  [
    "a8bd",
    ""
  ],
  [
    "a8c0",
    ""
  ],
  [
    "a8c5",
    "",
    36
  ],
  [
    "a940",
    "",
    8,
    ""
  ],
  [
    "a959",
    ""
  ],
  [
    "a95c",
    ""
  ],
  [
    "a960",
    "",
    9,
    "",
    8
  ],
  [
    "a980",
    "",
    4,
    ""
  ],
  [
    "a996",
    ""
  ],
  [
    "a9a4",
    "",
    75
  ],
  [
    "aa40",
    "",
    5,
    "",
    5,
    "",
    8
  ],
  [
    "aa80",
    "",
    7,
    "",
    10,
    ""
  ],
  [
    "ab40",
    "",
    11,
    "",
    4,
    "",
    5,
    "",
    4
  ],
  [
    "ab80",
    "",
    6,
    "",
    4
  ],
  [
    "ac40",
    "",
    10,
    "",
    8,
    "",
    5,
    "",
    4,
    "",
    11
  ],
  [
    "ac80",
    "",
    6,
    "",
    12,
    "",
    4,
    ""
  ],
  [
    "ad40",
    "",
    10,
    "",
    7,
    "",
    15,
    "",
    12
  ],
  [
    "ad80",
    "",
    9,
    "",
    8,
    "",
    6,
    ""
  ],
  [
    "ae40",
    "",
    6,
    "",
    7,
    "",
    4,
    ""
  ],
  [
    "ae80",
    "",
    7,
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "af40",
    "",
    4,
    ""
  ],
  [
    "af80",
    ""
  ],
  [
    "b040",
    "",
    6,
    "",
    5,
    "",
    4,
    "",
    6,
    "",
    7,
    ""
  ],
  [
    "b080",
    "",
    7,
    "",
    8,
    "",
    9,
    ""
  ],
  [
    "b140",
    "",
    4,
    "",
    7,
    "",
    10,
    ""
  ],
  [
    "b180",
    "",
    4,
    "",
    7,
    "",
    7,
    ""
  ],
  [
    "b240",
    "",
    11,
    "",
    5,
    "",
    11,
    "",
    4
  ],
  [
    "b280",
    "",
    12,
    "",
    8,
    "",
    4,
    ""
  ],
  [
    "b340",
    "",
    5,
    ""
  ],
  [
    "b380",
    "",
    11,
    "",
    7,
    "",
    6,
    ""
  ],
  [
    "b440",
    "",
    7,
    "",
    9
  ],
  [
    "b480",
    "",
    4,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "b540",
    "",
    5,
    "",
    9,
    "",
    4,
    "",
    14,
    "",
    4,
    "",
    8,
    ""
  ],
  [
    "b580",
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "b640",
    "",
    6,
    "",
    11,
    "",
    10,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "b680",
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "b740",
    "",
    14,
    "",
    5,
    "",
    9,
    "",
    4,
    "",
    16
  ],
  [
    "b780",
    "",
    6,
    ""
  ],
  [
    "b840",
    "",
    4,
    "",
    10,
    "",
    10,
    "",
    9,
    "",
    5,
    ""
  ],
  [
    "b880",
    "",
    4,
    ""
  ],
  [
    "b940",
    "",
    5,
    "",
    10,
    "",
    6,
    ""
  ],
  [
    "b980",
    "",
    7,
    ""
  ],
  [
    "ba40",
    "",
    4,
    "",
    4,
    "",
    7,
    "",
    5,
    ""
  ],
  [
    "ba80",
    "",
    4,
    "",
    5,
    "",
    12,
    "",
    5,
    ""
  ],
  [
    "bb40",
    "",
    9,
    "",
    36,
    "",
    5,
    "",
    9
  ],
  [
    "bb80",
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "bc40",
    "",
    6,
    "",
    6,
    "",
    5,
    "",
    7,
    "",
    13,
    "",
    5
  ],
  [
    "bc80",
    "",
    14,
    "",
    6,
    ""
  ],
  [
    "bd40",
    "",
    54,
    "",
    7
  ],
  [
    "bd80",
    "",
    32,
    ""
  ],
  [
    "be40",
    "",
    12,
    "",
    6,
    "",
    42
  ],
  [
    "be80",
    "",
    32,
    ""
  ],
  [
    "bf40",
    "",
    62
  ],
  [
    "bf80",
    "",
    4,
    "",
    4,
    "",
    21,
    ""
  ],
  [
    "c040",
    "",
    35,
    "",
    23,
    ""
  ],
  [
    "c080",
    "",
    6,
    "",
    9,
    ""
  ],
  [
    "c140",
    "",
    4,
    "",
    7,
    "",
    4,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "c180",
    "",
    4,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "c240",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "c280",
    "",
    13,
    "",
    5,
    "",
    11,
    ""
  ],
  [
    "c340",
    "",
    5,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "c380",
    "",
    12,
    "",
    4,
    ""
  ],
  [
    "c440",
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "c480",
    "",
    7,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "c540",
    "",
    14,
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "c580",
    "",
    7,
    "",
    7,
    ""
  ],
  [
    "c640",
    ""
  ],
  [
    "c680",
    "",
    4,
    "",
    9,
    ""
  ],
  [
    "c740",
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    6,
    "",
    6,
    ""
  ],
  [
    "c780",
    ""
  ],
  [
    "c840",
    "",
    4,
    "",
    5,
    "",
    5,
    "",
    7,
    "",
    5,
    "",
    7,
    ""
  ],
  [
    "c880",
    "",
    6,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "c940",
    "",
    4,
    "",
    7,
    "",
    12,
    ""
  ],
  [
    "c980",
    "",
    4,
    "",
    4,
    "",
    10,
    ""
  ],
  [
    "ca40",
    "",
    8,
    "",
    8,
    "",
    9,
    "",
    4,
    "",
    10
  ],
  [
    "ca80",
    "",
    4,
    "",
    8,
    ""
  ],
  [
    "cb40",
    "",
    6,
    "",
    10,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "cb80",
    "",
    5,
    "",
    6,
    "",
    14,
    ""
  ],
  [
    "cc40",
    "",
    4,
    "",
    10,
    "",
    15,
    "",
    13,
    ""
  ],
  [
    "cc80",
    "",
    11,
    "",
    4,
    "",
    7,
    ""
  ],
  [
    "cd40",
    "",
    6,
    "",
    6,
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "cd80",
    ""
  ],
  [
    "ce40",
    "",
    6,
    "",
    5,
    "",
    7,
    ""
  ],
  [
    "ce80",
    "",
    4,
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "cf40",
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    9
  ],
  [
    "cf80",
    "",
    5,
    "",
    7,
    "",
    4,
    ""
  ],
  [
    "d040",
    "",
    13,
    "",
    5,
    "",
    5,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "d080",
    "",
    4,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "d140",
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    5
  ],
  [
    "d180",
    "",
    4,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "d240",
    "",
    8,
    "",
    24,
    "",
    5,
    "",
    19,
    ""
  ],
  [
    "d280",
    "",
    26,
    ""
  ],
  [
    "d340",
    "",
    30,
    "",
    6
  ],
  [
    "d380",
    "",
    4,
    "",
    5,
    "",
    21,
    ""
  ],
  [
    "d440",
    "",
    31,
    "",
    8,
    "",
    21
  ],
  [
    "d480",
    "",
    25,
    "",
    6,
    ""
  ],
  [
    "d540",
    "",
    7,
    "",
    7,
    "",
    46
  ],
  [
    "d580",
    "",
    32,
    ""
  ],
  [
    "d640",
    "",
    34,
    "",
    27
  ],
  [
    "d680",
    "",
    30,
    ""
  ],
  [
    "d740",
    "",
    31,
    "",
    4,
    "",
    25
  ],
  [
    "d780",
    "",
    24,
    ""
  ],
  [
    "d840",
    "",
    8,
    "",
    7,
    "",
    5,
    "",
    6,
    "",
    6,
    "",
    6,
    ""
  ],
  [
    "d880",
    "",
    6,
    "",
    20,
    ""
  ],
  [
    "d940",
    "",
    62
  ],
  [
    "d980",
    "",
    32,
    ""
  ],
  [
    "da40",
    "",
    14,
    "",
    8,
    "",
    4,
    "",
    9,
    ""
  ],
  [
    "da80",
    "",
    12,
    ""
  ],
  [
    "db40",
    "",
    6,
    "",
    7,
    "",
    4,
    ""
  ],
  [
    "db80",
    "",
    4,
    "",
    5,
    "",
    11,
    ""
  ],
  [
    "dc40",
    "",
    4,
    "",
    6,
    "",
    6,
    "",
    11,
    "",
    6,
    "",
    7
  ],
  [
    "dc80",
    "",
    10,
    "",
    21,
    ""
  ],
  [
    "dd40",
    "",
    62
  ],
  [
    "dd80",
    "",
    32,
    ""
  ],
  [
    "de40",
    "",
    32,
    ""
  ],
  [
    "de80",
    "",
    4,
    ""
  ],
  [
    "df40",
    "",
    5,
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "df80",
    "",
    4,
    ""
  ],
  [
    "e040",
    "",
    19,
    ""
  ],
  [
    "e080",
    "",
    10,
    "",
    6,
    "",
    8,
    ""
  ],
  [
    "e140",
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    5,
    ""
  ],
  [
    "e180",
    "",
    10,
    "",
    9,
    "",
    8,
    ""
  ],
  [
    "e240",
    "",
    62
  ],
  [
    "e280",
    "",
    32,
    "",
    5,
    ""
  ],
  [
    "e340",
    "",
    45,
    "",
    16
  ],
  [
    "e380",
    "",
    7,
    "",
    24,
    ""
  ],
  [
    "e440",
    "",
    5,
    "",
    24,
    "",
    31
  ],
  [
    "e480",
    "",
    32,
    ""
  ],
  [
    "e540",
    "",
    51,
    "",
    10
  ],
  [
    "e580",
    "",
    31,
    ""
  ],
  [
    "e640",
    "",
    34,
    "",
    27
  ],
  [
    "e680",
    "",
    29,
    ""
  ],
  [
    "e740",
    "",
    7,
    "",
    54
  ],
  [
    "e780",
    "",
    32,
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "e840",
    "",
    14,
    "",
    43,
    ""
  ],
  [
    "e880",
    "",
    20,
    ""
  ],
  [
    "e940",
    "",
    7,
    "",
    42
  ],
  [
    "e980",
    "",
    32,
    ""
  ],
  [
    "ea40",
    "",
    27,
    "",
    6,
    ""
  ],
  [
    "ea80",
    "",
    4,
    "",
    12,
    ""
  ],
  [
    "eb40",
    "",
    9,
    "",
    7,
    "",
    9,
    "",
    6,
    ""
  ],
  [
    "eb80",
    "",
    4,
    ""
  ],
  [
    "ec40",
    "",
    8,
    "",
    4,
    "",
    18,
    "",
    7
  ],
  [
    "ec80",
    "",
    4,
    "",
    7,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "ed40",
    "",
    6,
    "",
    46
  ],
  [
    "ed80",
    "",
    4,
    "",
    23,
    ""
  ],
  [
    "ee40",
    "",
    62
  ],
  [
    "ee80",
    "",
    32,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "ef40",
    "",
    5,
    "",
    37,
    "",
    4
  ],
  [
    "ef80",
    "",
    30,
    "",
    4,
    "",
    8,
    ""
  ],
  [
    "f040",
    "",
    4,
    "",
    28,
    "",
    26
  ],
  [
    "f080",
    "",
    9,
    "",
    12,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "f140",
    "",
    10,
    "",
    47
  ],
  [
    "f180",
    "",
    32,
    ""
  ],
  [
    "f240",
    "",
    62
  ],
  [
    "f280",
    "",
    32,
    ""
  ],
  [
    "f340",
    "",
    17,
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "f380",
    "",
    8,
    "",
    6,
    ""
  ],
  [
    "f440",
    "",
    5,
    "",
    10,
    "",
    10,
    "",
    7,
    "",
    5
  ],
  [
    "f480",
    "",
    32,
    ""
  ],
  [
    "f540",
    "",
    62
  ],
  [
    "f580",
    "",
    32,
    ""
  ],
  [
    "f640",
    "",
    62
  ],
  [
    "f680",
    "",
    32,
    "",
    5,
    "",
    5,
    "",
    4,
    "",
    7,
    ""
  ],
  [
    "f740",
    "",
    62
  ],
  [
    "f780",
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "f840",
    "",
    62
  ],
  [
    "f880",
    "",
    32
  ],
  [
    "f940",
    "",
    62
  ],
  [
    "f980",
    "",
    32
  ],
  [
    "fa40",
    "",
    62
  ],
  [
    "fa80",
    "",
    32
  ],
  [
    "fb40",
    "",
    27,
    "",
    9,
    ""
  ],
  [
    "fb80",
    "",
    5,
    "",
    8,
    "",
    5,
    ""
  ],
  [
    "fc40",
    "",
    8,
    "",
    4,
    "",
    8,
    "",
    6
  ],
  [
    "fc80",
    "",
    4,
    "",
    5,
    "",
    8,
    ""
  ],
  [
    "fd40",
    "",
    4,
    "",
    4,
    "",
    10,
    "",
    38
  ],
  [
    "fd80",
    "",
    5,
    "",
    11,
    "",
    4,
    ""
  ],
  [
    "fe40",
    ""
  ]
], O0 = [
  [
    "a140",
    "",
    62
  ],
  [
    "a180",
    "",
    32
  ],
  [
    "a240",
    "",
    62
  ],
  [
    "a280",
    "",
    32
  ],
  [
    "a2ab",
    "",
    5
  ],
  [
    "a2e3",
    ""
  ],
  [
    "a2ef",
    ""
  ],
  [
    "a2fd",
    ""
  ],
  [
    "a340",
    "",
    62
  ],
  [
    "a380",
    "",
    31,
    ""
  ],
  [
    "a440",
    "",
    62
  ],
  [
    "a480",
    "",
    32
  ],
  [
    "a4f4",
    "",
    10
  ],
  [
    "a540",
    "",
    62
  ],
  [
    "a580",
    "",
    32
  ],
  [
    "a5f7",
    "",
    7
  ],
  [
    "a640",
    "",
    62
  ],
  [
    "a680",
    "",
    32
  ],
  [
    "a6b9",
    "",
    7
  ],
  [
    "a6d9",
    "",
    6
  ],
  [
    "a6ec",
    ""
  ],
  [
    "a6f3",
    ""
  ],
  [
    "a6f6",
    "",
    8
  ],
  [
    "a740",
    "",
    62
  ],
  [
    "a780",
    "",
    32
  ],
  [
    "a7c2",
    "",
    14
  ],
  [
    "a7f2",
    "",
    12
  ],
  [
    "a896",
    "",
    10
  ],
  [
    "a8bc",
    ""
  ],
  [
    "a8bf",
    ""
  ],
  [
    "a8c1",
    ""
  ],
  [
    "a8ea",
    "",
    20
  ],
  [
    "a958",
    ""
  ],
  [
    "a95b",
    ""
  ],
  [
    "a95d",
    ""
  ],
  [
    "a989",
    "",
    11
  ],
  [
    "a997",
    "",
    12
  ],
  [
    "a9f0",
    "",
    14
  ],
  [
    "aaa1",
    "",
    93
  ],
  [
    "aba1",
    "",
    93
  ],
  [
    "aca1",
    "",
    93
  ],
  [
    "ada1",
    "",
    93
  ],
  [
    "aea1",
    "",
    93
  ],
  [
    "afa1",
    "",
    93
  ],
  [
    "d7fa",
    "",
    4
  ],
  [
    "f8a1",
    "",
    93
  ],
  [
    "f9a1",
    "",
    93
  ],
  [
    "faa1",
    "",
    93
  ],
  [
    "fba1",
    "",
    93
  ],
  [
    "fca1",
    "",
    93
  ],
  [
    "fda1",
    "",
    93
  ],
  [
    "fe50",
    ""
  ],
  [
    "fe80",
    "",
    6,
    "",
    93
  ],
  [
    "8135f437",
    ""
  ]
], Uw = [
  128,
  165,
  169,
  178,
  184,
  216,
  226,
  235,
  238,
  244,
  248,
  251,
  253,
  258,
  276,
  284,
  300,
  325,
  329,
  334,
  364,
  463,
  465,
  467,
  469,
  471,
  473,
  475,
  477,
  506,
  594,
  610,
  712,
  716,
  730,
  930,
  938,
  962,
  970,
  1026,
  1104,
  1106,
  8209,
  8215,
  8218,
  8222,
  8231,
  8241,
  8244,
  8246,
  8252,
  8365,
  8452,
  8454,
  8458,
  8471,
  8482,
  8556,
  8570,
  8596,
  8602,
  8713,
  8720,
  8722,
  8726,
  8731,
  8737,
  8740,
  8742,
  8748,
  8751,
  8760,
  8766,
  8777,
  8781,
  8787,
  8802,
  8808,
  8816,
  8854,
  8858,
  8870,
  8896,
  8979,
  9322,
  9372,
  9548,
  9588,
  9616,
  9622,
  9634,
  9652,
  9662,
  9672,
  9676,
  9680,
  9702,
  9735,
  9738,
  9793,
  9795,
  11906,
  11909,
  11913,
  11917,
  11928,
  11944,
  11947,
  11951,
  11956,
  11960,
  11964,
  11979,
  12284,
  12292,
  12312,
  12319,
  12330,
  12351,
  12436,
  12447,
  12535,
  12543,
  12586,
  12842,
  12850,
  12964,
  13200,
  13215,
  13218,
  13253,
  13263,
  13267,
  13270,
  13384,
  13428,
  13727,
  13839,
  13851,
  14617,
  14703,
  14801,
  14816,
  14964,
  15183,
  15471,
  15585,
  16471,
  16736,
  17208,
  17325,
  17330,
  17374,
  17623,
  17997,
  18018,
  18212,
  18218,
  18301,
  18318,
  18760,
  18811,
  18814,
  18820,
  18823,
  18844,
  18848,
  18872,
  19576,
  19620,
  19738,
  19887,
  40870,
  59244,
  59336,
  59367,
  59413,
  59417,
  59423,
  59431,
  59437,
  59443,
  59452,
  59460,
  59478,
  59493,
  63789,
  63866,
  63894,
  63976,
  63986,
  64016,
  64018,
  64021,
  64025,
  64034,
  64037,
  64042,
  65074,
  65093,
  65107,
  65112,
  65127,
  65132,
  65375,
  65510,
  65536
], Gw = [
  0,
  36,
  38,
  45,
  50,
  81,
  89,
  95,
  96,
  100,
  103,
  104,
  105,
  109,
  126,
  133,
  148,
  172,
  175,
  179,
  208,
  306,
  307,
  308,
  309,
  310,
  311,
  312,
  313,
  341,
  428,
  443,
  544,
  545,
  558,
  741,
  742,
  749,
  750,
  805,
  819,
  820,
  7922,
  7924,
  7925,
  7927,
  7934,
  7943,
  7944,
  7945,
  7950,
  8062,
  8148,
  8149,
  8152,
  8164,
  8174,
  8236,
  8240,
  8262,
  8264,
  8374,
  8380,
  8381,
  8384,
  8388,
  8390,
  8392,
  8393,
  8394,
  8396,
  8401,
  8406,
  8416,
  8419,
  8424,
  8437,
  8439,
  8445,
  8482,
  8485,
  8496,
  8521,
  8603,
  8936,
  8946,
  9046,
  9050,
  9063,
  9066,
  9076,
  9092,
  9100,
  9108,
  9111,
  9113,
  9131,
  9162,
  9164,
  9218,
  9219,
  11329,
  11331,
  11334,
  11336,
  11346,
  11361,
  11363,
  11366,
  11370,
  11372,
  11375,
  11389,
  11682,
  11686,
  11687,
  11692,
  11694,
  11714,
  11716,
  11723,
  11725,
  11730,
  11736,
  11982,
  11989,
  12102,
  12336,
  12348,
  12350,
  12384,
  12393,
  12395,
  12397,
  12510,
  12553,
  12851,
  12962,
  12973,
  13738,
  13823,
  13919,
  13933,
  14080,
  14298,
  14585,
  14698,
  15583,
  15847,
  16318,
  16434,
  16438,
  16481,
  16729,
  17102,
  17122,
  17315,
  17320,
  17402,
  17418,
  17859,
  17909,
  17911,
  17915,
  17916,
  17936,
  17939,
  17961,
  18664,
  18703,
  18814,
  18962,
  19043,
  33469,
  33470,
  33471,
  33484,
  33485,
  33490,
  33497,
  33501,
  33505,
  33513,
  33520,
  33536,
  33550,
  37845,
  37921,
  37948,
  38029,
  38038,
  38064,
  38065,
  38066,
  38069,
  38075,
  38076,
  38078,
  39108,
  39109,
  39113,
  39114,
  39115,
  39116,
  39265,
  39394,
  189e3
], zw = {
  uChars: Uw,
  gbChars: Gw
}, Ww = [
  [
    "0",
    "\0",
    127
  ],
  [
    "8141",
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "8161",
    "",
    9,
    "",
    5,
    ""
  ],
  [
    "8181",
    "",
    18,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    7,
    "",
    7,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "8241",
    "",
    7,
    "",
    5
  ],
  [
    "8261",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "8281",
    "",
    7,
    "",
    7,
    "",
    4,
    "",
    10,
    "",
    5,
    "",
    17,
    "",
    7,
    "",
    6,
    "",
    7,
    "",
    18
  ],
  [
    "8341",
    "",
    5,
    "",
    5,
    "",
    7
  ],
  [
    "8361",
    "",
    18,
    ""
  ],
  [
    "8381",
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    5,
    "",
    46,
    "",
    6,
    "",
    5,
    "",
    8
  ],
  [
    "8441",
    "",
    5,
    "",
    8
  ],
  [
    "8461",
    "",
    18
  ],
  [
    "8481",
    "",
    7,
    "",
    6,
    "",
    5,
    "",
    10,
    "",
    5,
    "",
    18,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    26,
    ""
  ],
  [
    "8541",
    "",
    5,
    "",
    4,
    "",
    6,
    "",
    4
  ],
  [
    "8561",
    "",
    5,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "8581",
    "",
    6,
    "",
    6,
    "",
    9,
    "",
    26,
    "",
    29,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "8641",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "8661",
    "",
    6,
    "",
    10
  ],
  [
    "8681",
    "",
    22,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    22,
    "",
    4,
    ""
  ],
  [
    "8741",
    "",
    9,
    "",
    15
  ],
  [
    "8761",
    "",
    18,
    ""
  ],
  [
    "8781",
    "",
    5,
    "",
    7,
    "",
    7,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    18,
    "",
    6,
    "",
    26,
    "",
    6,
    "",
    4
  ],
  [
    "8841",
    "",
    4,
    "",
    5,
    "",
    6,
    "",
    4
  ],
  [
    "8861",
    "",
    4,
    ""
  ],
  [
    "8881",
    "",
    15,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    54,
    ""
  ],
  [
    "8941",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "8961",
    "",
    10,
    "",
    5,
    ""
  ],
  [
    "8981",
    "",
    21,
    "",
    18,
    "",
    18,
    "",
    6,
    "",
    6,
    "",
    7,
    "",
    15
  ],
  [
    "8a41",
    "",
    10,
    "",
    6,
    ""
  ],
  [
    "8a61",
    "",
    4,
    "",
    18,
    ""
  ],
  [
    "8a81",
    "",
    4,
    "",
    19,
    "",
    5,
    "",
    7,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    4,
    "",
    5,
    "",
    26,
    ""
  ],
  [
    "8b41",
    "",
    5,
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "8b61",
    "",
    6,
    "",
    8
  ],
  [
    "8b81",
    "",
    52,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    18,
    "",
    18
  ],
  [
    "8c41",
    "",
    15,
    "",
    4
  ],
  [
    "8c61",
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    5
  ],
  [
    "8c81",
    "",
    12,
    "",
    26,
    "",
    50,
    "",
    5,
    "",
    16
  ],
  [
    "8d41",
    "",
    16,
    "",
    8
  ],
  [
    "8d61",
    "",
    17,
    ""
  ],
  [
    "8d81",
    "",
    4,
    "",
    33,
    "",
    6,
    "",
    7,
    "",
    6,
    "",
    9,
    "",
    6,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "8e41",
    "",
    6,
    "",
    5,
    "",
    8
  ],
  [
    "8e61",
    "",
    4,
    "",
    19
  ],
  [
    "8e81",
    "",
    13,
    "",
    6,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    11,
    "",
    7,
    "",
    6,
    "",
    5,
    "",
    7
  ],
  [
    "8f41",
    "",
    7,
    "",
    17
  ],
  [
    "8f61",
    "",
    7,
    "",
    6,
    "",
    4
  ],
  [
    "8f81",
    "",
    5,
    "",
    7,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    18,
    "",
    6,
    "",
    26,
    "",
    6,
    "",
    5
  ],
  [
    "9041",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9061",
    "",
    5,
    "",
    15
  ],
  [
    "9081",
    "",
    12,
    "",
    6,
    "",
    5,
    "",
    4,
    "",
    6,
    "",
    4,
    "",
    5,
    "",
    11,
    "",
    33,
    ""
  ],
  [
    "9141",
    "",
    6,
    "",
    5
  ],
  [
    "9161",
    "",
    9,
    "",
    5
  ],
  [
    "9181",
    "",
    20,
    "",
    4,
    "",
    5,
    "",
    14,
    "",
    33,
    "",
    7,
    "",
    5,
    "",
    6
  ],
  [
    "9241",
    "",
    7,
    "",
    4,
    ""
  ],
  [
    "9261",
    "",
    7,
    "",
    7,
    "",
    4
  ],
  [
    "9281",
    "",
    21,
    "",
    18,
    "",
    6,
    "",
    7,
    "",
    6,
    "",
    35,
    ""
  ],
  [
    "9341",
    "",
    4,
    ""
  ],
  [
    "9361",
    "",
    6,
    "",
    8
  ],
  [
    "9381",
    "",
    37,
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    7,
    "",
    22,
    ""
  ],
  [
    "9441",
    "",
    5,
    "",
    5,
    "",
    8
  ],
  [
    "9461",
    "",
    5,
    "",
    6,
    "",
    12
  ],
  [
    "9481",
    "",
    5,
    "",
    6,
    "",
    6,
    "",
    9,
    "",
    22,
    "",
    4,
    "",
    6,
    "",
    10,
    "",
    6,
    "",
    24
  ],
  [
    "9541",
    "",
    11,
    "",
    5,
    ""
  ],
  [
    "9561",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9581",
    "",
    6,
    "",
    35,
    "",
    4,
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    13,
    "",
    14
  ],
  [
    "9641",
    "",
    23,
    ""
  ],
  [
    "9661",
    "",
    6,
    "",
    5,
    "",
    8
  ],
  [
    "9681",
    "",
    10,
    "",
    5,
    "",
    13,
    "",
    33,
    "",
    6,
    "",
    44
  ],
  [
    "9741",
    "",
    16,
    "",
    8
  ],
  [
    "9761",
    "",
    17,
    "",
    7
  ],
  [
    "9781",
    "",
    11,
    "",
    5,
    "",
    6,
    "",
    89,
    ""
  ],
  [
    "9841",
    "",
    16,
    "",
    5,
    ""
  ],
  [
    "9861",
    "",
    6,
    "",
    15
  ],
  [
    "9881",
    "",
    21,
    "",
    6,
    "",
    5,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9941",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9961",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9981",
    "",
    8,
    "",
    5,
    "",
    4,
    "",
    11,
    "",
    5,
    "",
    6,
    "",
    6,
    "",
    6,
    "",
    7,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9a41",
    "",
    16
  ],
  [
    "9a61",
    "",
    6,
    "",
    6,
    ""
  ],
  [
    "9a81",
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    5,
    "",
    33,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "9b41",
    "",
    6,
    "",
    8
  ],
  [
    "9b61",
    "",
    17,
    "",
    7
  ],
  [
    "9b81",
    "",
    25,
    "",
    4,
    "",
    5,
    "",
    50,
    "",
    22,
    ""
  ],
  [
    "9c41",
    "",
    4,
    "",
    5,
    "",
    5
  ],
  [
    "9c61",
    "",
    8,
    "",
    6,
    "",
    9
  ],
  [
    "9c81",
    "",
    8,
    "",
    6,
    "",
    6,
    "",
    9,
    "",
    26,
    "",
    6,
    "",
    5,
    "",
    18,
    "",
    6,
    "",
    12
  ],
  [
    "9d41",
    "",
    13,
    "",
    8
  ],
  [
    "9d61",
    "",
    25
  ],
  [
    "9d81",
    "",
    8,
    "",
    5,
    "",
    9,
    "",
    6,
    "",
    10,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9e41",
    "",
    7,
    "",
    9,
    ""
  ],
  [
    "9e61",
    "",
    4,
    "",
    6,
    ""
  ],
  [
    "9e81",
    "",
    6,
    "",
    6,
    "",
    6,
    "",
    5,
    "",
    10,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "9f41",
    "",
    5,
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "9f61",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "9f81",
    "",
    4,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    4,
    "",
    6,
    "",
    7,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "a041",
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "a061",
    "",
    5,
    "",
    13
  ],
  [
    "a081",
    "",
    4,
    "",
    4,
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    6,
    "",
    5,
    "",
    26,
    "",
    4,
    "",
    5,
    "",
    7,
    ""
  ],
  [
    "a141",
    "",
    18,
    ""
  ],
  [
    "a161",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "a181",
    "",
    14,
    "",
    5,
    "",
    4,
    "",
    9,
    ""
  ],
  [
    "a241",
    "",
    5,
    "",
    18
  ],
  [
    "a261",
    "",
    6,
    "",
    18
  ],
  [
    "a281",
    "",
    7,
    "",
    6,
    "",
    7,
    ""
  ],
  [
    "a341",
    "",
    6,
    "",
    10,
    ""
  ],
  [
    "a361",
    "",
    6,
    "",
    16
  ],
  [
    "a381",
    "",
    16,
    "",
    4,
    "",
    58,
    "",
    32,
    ""
  ],
  [
    "a441",
    "",
    5,
    ""
  ],
  [
    "a461",
    "",
    5,
    "",
    12
  ],
  [
    "a481",
    "",
    28,
    "",
    93
  ],
  [
    "a541",
    "",
    4,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "a561",
    "",
    17,
    "",
    5,
    ""
  ],
  [
    "a581",
    "",
    16,
    "",
    14,
    "",
    9
  ],
  [
    "a5b0",
    "",
    9
  ],
  [
    "a5c1",
    "",
    16,
    "",
    6
  ],
  [
    "a5e1",
    "",
    16,
    "",
    6
  ],
  [
    "a641",
    "",
    19,
    ""
  ],
  [
    "a661",
    "",
    5,
    "",
    5,
    "",
    6
  ],
  [
    "a681",
    "",
    6,
    "",
    18,
    "",
    7
  ],
  [
    "a741",
    "",
    4,
    "",
    6,
    "",
    7
  ],
  [
    "a761",
    "",
    22,
    ""
  ],
  [
    "a781",
    "",
    6,
    "",
    5,
    "",
    7,
    "",
    9,
    "",
    9,
    "",
    4,
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "a841",
    "",
    10,
    "",
    14
  ],
  [
    "a861",
    "",
    18,
    "",
    6
  ],
  [
    "a881",
    "",
    19,
    "",
    11,
    ""
  ],
  [
    "a8a6",
    ""
  ],
  [
    "a8a8",
    ""
  ],
  [
    "a8b1",
    "",
    27,
    "",
    25,
    "",
    14,
    ""
  ],
  [
    "a941",
    "",
    14,
    "",
    10
  ],
  [
    "a961",
    "",
    18
  ],
  [
    "a981",
    "",
    14,
    "",
    6,
    "",
    27,
    "",
    25,
    "",
    14,
    ""
  ],
  [
    "aa41",
    "",
    6,
    "",
    4,
    ""
  ],
  [
    "aa61",
    "",
    4,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "aa81",
    "",
    29,
    "",
    82
  ],
  [
    "ab41",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "ab61",
    "",
    6,
    "",
    5,
    "",
    5
  ],
  [
    "ab81",
    "",
    8,
    "",
    6,
    "",
    12,
    "",
    85
  ],
  [
    "ac41",
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "ac61",
    "",
    11,
    "",
    4
  ],
  [
    "ac81",
    "",
    28,
    "",
    5,
    "",
    25
  ],
  [
    "acd1",
    "",
    5,
    "",
    25
  ],
  [
    "ad41",
    "",
    6,
    "",
    5,
    "",
    7
  ],
  [
    "ad61",
    "",
    6,
    "",
    10,
    ""
  ],
  [
    "ad81",
    "",
    5,
    "",
    18,
    ""
  ],
  [
    "ae41",
    "",
    5,
    "",
    16
  ],
  [
    "ae61",
    "",
    5,
    "",
    6,
    "",
    4
  ],
  [
    "ae81",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "af41",
    "",
    19
  ],
  [
    "af61",
    "",
    13,
    "",
    5,
    ""
  ],
  [
    "af81",
    "",
    5,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "b041",
    "",
    5,
    "",
    5,
    "",
    12
  ],
  [
    "b061",
    "",
    5,
    "",
    19
  ],
  [
    "b081",
    "",
    13,
    "",
    6,
    "",
    5,
    "",
    7,
    "",
    4,
    ""
  ],
  [
    "b141",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "b161",
    "",
    6,
    "",
    5,
    "",
    11
  ],
  [
    "b181",
    "",
    14,
    "",
    6,
    ""
  ],
  [
    "b241",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "b261",
    "",
    18,
    "",
    5,
    ""
  ],
  [
    "b281",
    "",
    5,
    "",
    18,
    "",
    6,
    ""
  ],
  [
    "b341",
    "",
    19,
    ""
  ],
  [
    "b361",
    "",
    5,
    "",
    5,
    "",
    5
  ],
  [
    "b381",
    "",
    5,
    "",
    5,
    "",
    19,
    "",
    4,
    ""
  ],
  [
    "b441",
    "",
    5,
    "",
    6,
    "",
    5
  ],
  [
    "b461",
    "",
    6,
    "",
    10,
    ""
  ],
  [
    "b481",
    "",
    6,
    "",
    18,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "b541",
    "",
    14,
    "",
    5
  ],
  [
    "b561",
    "",
    5,
    "",
    5,
    "",
    4
  ],
  [
    "b581",
    "",
    6,
    "",
    5,
    "",
    11,
    ""
  ],
  [
    "b641",
    "",
    7,
    "",
    17
  ],
  [
    "b661",
    "",
    15,
    ""
  ],
  [
    "b681",
    "",
    5,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "b741",
    "",
    13,
    "",
    6,
    ""
  ],
  [
    "b761",
    "",
    20,
    ""
  ],
  [
    "b781",
    "",
    6,
    "",
    14,
    ""
  ],
  [
    "b841",
    "",
    7,
    "",
    17
  ],
  [
    "b861",
    "",
    8,
    "",
    13
  ],
  [
    "b881",
    "",
    5,
    "",
    24,
    "",
    4,
    ""
  ],
  [
    "b941",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "b961",
    "",
    14,
    "",
    6,
    ""
  ],
  [
    "b981",
    "",
    22,
    "",
    4,
    "",
    4,
    ""
  ],
  [
    "ba41",
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "ba61",
    "",
    5,
    "",
    4,
    "",
    5
  ],
  [
    "ba81",
    "",
    6,
    "",
    9,
    ""
  ],
  [
    "bb41",
    "",
    4,
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "bb61",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "bb81",
    "",
    31,
    ""
  ],
  [
    "bc41",
    "",
    17,
    ""
  ],
  [
    "bc61",
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "bc81",
    "",
    4,
    "",
    6,
    "",
    5,
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "bd41",
    "",
    7,
    "",
    7,
    ""
  ],
  [
    "bd61",
    "",
    5,
    "",
    13
  ],
  [
    "bd81",
    "",
    5,
    "",
    25,
    ""
  ],
  [
    "be41",
    "",
    7,
    "",
    14
  ],
  [
    "be61",
    "",
    7,
    "",
    7,
    ""
  ],
  [
    "be81",
    "",
    4,
    "",
    4,
    "",
    5,
    "",
    8,
    "",
    6,
    ""
  ],
  [
    "bf41",
    "",
    10,
    "",
    14
  ],
  [
    "bf61",
    "",
    18,
    ""
  ],
  [
    "bf81",
    "",
    5,
    "",
    7,
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "c041",
    "",
    5,
    "",
    6,
    "",
    5
  ],
  [
    "c061",
    "",
    25
  ],
  [
    "c081",
    "",
    6,
    "",
    5,
    "",
    7,
    ""
  ],
  [
    "c141",
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "c161",
    "",
    19,
    ""
  ],
  [
    "c181",
    "",
    31,
    ""
  ],
  [
    "c241",
    "",
    4,
    "",
    5,
    ""
  ],
  [
    "c261",
    "",
    4,
    "",
    5,
    "",
    6,
    ""
  ],
  [
    "c281",
    "",
    5,
    "",
    7,
    "",
    9,
    ""
  ],
  [
    "c341",
    "",
    4
  ],
  [
    "c361",
    "",
    4,
    "",
    5,
    "",
    11
  ],
  [
    "c381",
    "",
    5,
    "",
    7,
    "",
    5,
    ""
  ],
  [
    "c441",
    "",
    7,
    "",
    7,
    ""
  ],
  [
    "c461",
    "",
    5,
    "",
    4
  ],
  [
    "c481",
    "",
    5,
    "",
    11,
    ""
  ],
  [
    "c541",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "c561",
    "",
    6,
    "",
    5,
    "",
    4
  ],
  [
    "c581",
    "",
    6,
    "",
    5,
    ""
  ],
  [
    "c641",
    "",
    6,
    "",
    5
  ],
  [
    "c6a1",
    ""
  ],
  [
    "c7a1",
    ""
  ],
  [
    "c8a1",
    ""
  ],
  [
    "caa1",
    ""
  ],
  [
    "cba1",
    ""
  ],
  [
    "cca1",
    ""
  ],
  [
    "cda1",
    ""
  ],
  [
    "cea1",
    ""
  ],
  [
    "cfa1",
    ""
  ],
  [
    "d0a1",
    ""
  ],
  [
    "d1a1",
    "",
    5,
    "",
    4,
    ""
  ],
  [
    "d2a1",
    "",
    4,
    "",
    5,
    "",
    10,
    "",
    7,
    "",
    5,
    ""
  ],
  [
    "d3a1",
    ""
  ],
  [
    "d4a1",
    ""
  ],
  [
    "d5a1",
    ""
  ],
  [
    "d6a1",
    ""
  ],
  [
    "d7a1",
    ""
  ],
  [
    "d8a1",
    ""
  ],
  [
    "d9a1",
    ""
  ],
  [
    "daa1",
    ""
  ],
  [
    "dba1",
    ""
  ],
  [
    "dca1",
    ""
  ],
  [
    "dda1",
    ""
  ],
  [
    "dea1",
    ""
  ],
  [
    "dfa1",
    ""
  ],
  [
    "e0a1",
    ""
  ],
  [
    "e1a1",
    ""
  ],
  [
    "e2a1",
    ""
  ],
  [
    "e3a1",
    ""
  ],
  [
    "e4a1",
    ""
  ],
  [
    "e5a1",
    ""
  ],
  [
    "e6a1",
    ""
  ],
  [
    "e7a1",
    ""
  ],
  [
    "e8a1",
    ""
  ],
  [
    "e9a1",
    ""
  ],
  [
    "eaa1",
    ""
  ],
  [
    "eba1",
    ""
  ],
  [
    "eca1",
    ""
  ],
  [
    "eda1",
    ""
  ],
  [
    "eea1",
    ""
  ],
  [
    "efa1",
    ""
  ],
  [
    "f0a1",
    ""
  ],
  [
    "f1a1",
    ""
  ],
  [
    "f2a1",
    ""
  ],
  [
    "f3a1",
    ""
  ],
  [
    "f4a1",
    ""
  ],
  [
    "f5a1",
    ""
  ],
  [
    "f6a1",
    ""
  ],
  [
    "f7a1",
    ""
  ],
  [
    "f8a1",
    ""
  ],
  [
    "f9a1",
    ""
  ],
  [
    "faa1",
    ""
  ],
  [
    "fba1",
    ""
  ],
  [
    "fca1",
    ""
  ],
  [
    "fda1",
    ""
  ]
], N0 = [
  [
    "0",
    "\0",
    127
  ],
  [
    "a140",
    ""
  ],
  [
    "a1a1",
    "",
    4,
    ""
  ],
  [
    "a240",
    "",
    7,
    ""
  ],
  [
    "a2a1",
    "",
    9,
    "",
    9,
    "",
    8,
    "",
    25,
    "",
    21
  ],
  [
    "a340",
    "",
    16,
    "",
    6,
    "",
    16,
    "",
    6,
    "",
    10
  ],
  [
    "a3a1",
    "",
    25,
    ""
  ],
  [
    "a3e1",
    ""
  ],
  [
    "a440",
    ""
  ],
  [
    "a4a1",
    ""
  ],
  [
    "a540",
    ""
  ],
  [
    "a5a1",
    ""
  ],
  [
    "a640",
    ""
  ],
  [
    "a6a1",
    ""
  ],
  [
    "a740",
    ""
  ],
  [
    "a7a1",
    ""
  ],
  [
    "a840",
    ""
  ],
  [
    "a8a1",
    ""
  ],
  [
    "a940",
    ""
  ],
  [
    "a9a1",
    ""
  ],
  [
    "aa40",
    ""
  ],
  [
    "aaa1",
    ""
  ],
  [
    "ab40",
    ""
  ],
  [
    "aba1",
    ""
  ],
  [
    "ac40",
    ""
  ],
  [
    "aca1",
    ""
  ],
  [
    "ad40",
    ""
  ],
  [
    "ada1",
    ""
  ],
  [
    "ae40",
    ""
  ],
  [
    "aea1",
    ""
  ],
  [
    "af40",
    ""
  ],
  [
    "afa1",
    ""
  ],
  [
    "b040",
    ""
  ],
  [
    "b0a1",
    ""
  ],
  [
    "b140",
    ""
  ],
  [
    "b1a1",
    ""
  ],
  [
    "b240",
    ""
  ],
  [
    "b2a1",
    ""
  ],
  [
    "b340",
    ""
  ],
  [
    "b3a1",
    ""
  ],
  [
    "b440",
    ""
  ],
  [
    "b4a1",
    ""
  ],
  [
    "b540",
    ""
  ],
  [
    "b5a1",
    ""
  ],
  [
    "b640",
    ""
  ],
  [
    "b6a1",
    ""
  ],
  [
    "b740",
    ""
  ],
  [
    "b7a1",
    ""
  ],
  [
    "b840",
    ""
  ],
  [
    "b8a1",
    ""
  ],
  [
    "b940",
    ""
  ],
  [
    "b9a1",
    ""
  ],
  [
    "ba40",
    ""
  ],
  [
    "baa1",
    ""
  ],
  [
    "bb40",
    ""
  ],
  [
    "bba1",
    ""
  ],
  [
    "bc40",
    ""
  ],
  [
    "bca1",
    ""
  ],
  [
    "bd40",
    ""
  ],
  [
    "bda1",
    ""
  ],
  [
    "be40",
    ""
  ],
  [
    "bea1",
    ""
  ],
  [
    "bf40",
    ""
  ],
  [
    "bfa1",
    ""
  ],
  [
    "c040",
    ""
  ],
  [
    "c0a1",
    ""
  ],
  [
    "c140",
    ""
  ],
  [
    "c1a1",
    ""
  ],
  [
    "c240",
    ""
  ],
  [
    "c2a1",
    ""
  ],
  [
    "c340",
    ""
  ],
  [
    "c3a1",
    ""
  ],
  [
    "c440",
    ""
  ],
  [
    "c4a1",
    ""
  ],
  [
    "c540",
    ""
  ],
  [
    "c5a1",
    ""
  ],
  [
    "c640",
    ""
  ],
  [
    "c940",
    ""
  ],
  [
    "c9a1",
    ""
  ],
  [
    "ca40",
    ""
  ],
  [
    "caa1",
    ""
  ],
  [
    "cb40",
    ""
  ],
  [
    "cba1",
    ""
  ],
  [
    "cc40",
    ""
  ],
  [
    "cca1",
    ""
  ],
  [
    "cd40",
    ""
  ],
  [
    "cda1",
    ""
  ],
  [
    "ce40",
    ""
  ],
  [
    "cea1",
    ""
  ],
  [
    "cf40",
    ""
  ],
  [
    "cfa1",
    ""
  ],
  [
    "d040",
    ""
  ],
  [
    "d0a1",
    ""
  ],
  [
    "d140",
    ""
  ],
  [
    "d1a1",
    ""
  ],
  [
    "d240",
    ""
  ],
  [
    "d2a1",
    ""
  ],
  [
    "d340",
    ""
  ],
  [
    "d3a1",
    ""
  ],
  [
    "d440",
    ""
  ],
  [
    "d4a1",
    ""
  ],
  [
    "d540",
    ""
  ],
  [
    "d5a1",
    ""
  ],
  [
    "d640",
    ""
  ],
  [
    "d6a1",
    ""
  ],
  [
    "d740",
    ""
  ],
  [
    "d7a1",
    ""
  ],
  [
    "d840",
    ""
  ],
  [
    "d8a1",
    ""
  ],
  [
    "d940",
    ""
  ],
  [
    "d9a1",
    ""
  ],
  [
    "da40",
    ""
  ],
  [
    "daa1",
    ""
  ],
  [
    "db40",
    ""
  ],
  [
    "dba1",
    ""
  ],
  [
    "dc40",
    ""
  ],
  [
    "dca1",
    ""
  ],
  [
    "dd40",
    ""
  ],
  [
    "dda1",
    ""
  ],
  [
    "de40",
    ""
  ],
  [
    "dea1",
    ""
  ],
  [
    "df40",
    ""
  ],
  [
    "dfa1",
    ""
  ],
  [
    "e040",
    ""
  ],
  [
    "e0a1",
    ""
  ],
  [
    "e140",
    ""
  ],
  [
    "e1a1",
    ""
  ],
  [
    "e240",
    ""
  ],
  [
    "e2a1",
    ""
  ],
  [
    "e340",
    ""
  ],
  [
    "e3a1",
    ""
  ],
  [
    "e440",
    ""
  ],
  [
    "e4a1",
    ""
  ],
  [
    "e540",
    ""
  ],
  [
    "e5a1",
    ""
  ],
  [
    "e640",
    ""
  ],
  [
    "e6a1",
    ""
  ],
  [
    "e740",
    ""
  ],
  [
    "e7a1",
    ""
  ],
  [
    "e840",
    ""
  ],
  [
    "e8a1",
    ""
  ],
  [
    "e940",
    ""
  ],
  [
    "e9a1",
    ""
  ],
  [
    "ea40",
    ""
  ],
  [
    "eaa1",
    ""
  ],
  [
    "eb40",
    ""
  ],
  [
    "eba1",
    ""
  ],
  [
    "ec40",
    ""
  ],
  [
    "eca1",
    ""
  ],
  [
    "ed40",
    ""
  ],
  [
    "eda1",
    ""
  ],
  [
    "ee40",
    ""
  ],
  [
    "eea1",
    ""
  ],
  [
    "ef40",
    ""
  ],
  [
    "efa1",
    ""
  ],
  [
    "f040",
    ""
  ],
  [
    "f0a1",
    ""
  ],
  [
    "f140",
    ""
  ],
  [
    "f1a1",
    ""
  ],
  [
    "f240",
    ""
  ],
  [
    "f2a1",
    ""
  ],
  [
    "f340",
    ""
  ],
  [
    "f3a1",
    ""
  ],
  [
    "f440",
    ""
  ],
  [
    "f4a1",
    ""
  ],
  [
    "f540",
    ""
  ],
  [
    "f5a1",
    ""
  ],
  [
    "f640",
    ""
  ],
  [
    "f6a1",
    ""
  ],
  [
    "f740",
    ""
  ],
  [
    "f7a1",
    ""
  ],
  [
    "f840",
    ""
  ],
  [
    "f8a1",
    ""
  ],
  [
    "f940",
    ""
  ],
  [
    "f9a1",
    ""
  ]
], Vw = [
  [
    "8740",
    ""
  ],
  [
    "8767",
    ""
  ],
  [
    "87a1",
    ""
  ],
  [
    "8840",
    "",
    4,
    ""
  ],
  [
    "88a1",
    ""
  ],
  [
    "8940",
    ""
  ],
  [
    "8943",
    ""
  ],
  [
    "8946",
    ""
  ],
  [
    "894c",
    ""
  ],
  [
    "89a1",
    ""
  ],
  [
    "89ab",
    ""
  ],
  [
    "89b0",
    ""
  ],
  [
    "89b5",
    ""
  ],
  [
    "89c1",
    ""
  ],
  [
    "89c5",
    ""
  ],
  [
    "8a40",
    ""
  ],
  [
    "8a43",
    ""
  ],
  [
    "8a64",
    ""
  ],
  [
    "8a76",
    ""
  ],
  [
    "8aa1",
    ""
  ],
  [
    "8aac",
    ""
  ],
  [
    "8ab2",
    ""
  ],
  [
    "8abb",
    ""
  ],
  [
    "8ac9",
    ""
  ],
  [
    "8ace",
    ""
  ],
  [
    "8adf",
    ""
  ],
  [
    "8af6",
    ""
  ],
  [
    "8b40",
    ""
  ],
  [
    "8b55",
    ""
  ],
  [
    "8ba1",
    ""
  ],
  [
    "8bde",
    ""
  ],
  [
    "8c40",
    ""
  ],
  [
    "8ca1",
    ""
  ],
  [
    "8ca7",
    ""
  ],
  [
    "8cc9",
    ""
  ],
  [
    "8cce",
    ""
  ],
  [
    "8ce6",
    ""
  ],
  [
    "8d40",
    ""
  ],
  [
    "8d42",
    ""
  ],
  [
    "8da1",
    ""
  ],
  [
    "8e40",
    ""
  ],
  [
    "8ea1",
    ""
  ],
  [
    "8f40",
    ""
  ],
  [
    "8fa1",
    ""
  ],
  [
    "9040",
    ""
  ],
  [
    "90a1",
    ""
  ],
  [
    "9140",
    ""
  ],
  [
    "91a1",
    ""
  ],
  [
    "9240",
    ""
  ],
  [
    "92a1",
    ""
  ],
  [
    "9340",
    ""
  ],
  [
    "93a1",
    ""
  ],
  [
    "9440",
    ""
  ],
  [
    "94a1",
    ""
  ],
  [
    "9540",
    ""
  ],
  [
    "95a1",
    ""
  ],
  [
    "9640",
    ""
  ],
  [
    "96a1",
    ""
  ],
  [
    "9740",
    ""
  ],
  [
    "97a1",
    ""
  ],
  [
    "9840",
    ""
  ],
  [
    "98a1",
    ""
  ],
  [
    "9940",
    ""
  ],
  [
    "99a1",
    ""
  ],
  [
    "9a40",
    ""
  ],
  [
    "9aa1",
    ""
  ],
  [
    "9b40",
    ""
  ],
  [
    "9b62",
    ""
  ],
  [
    "9ba1",
    ""
  ],
  [
    "9c40",
    ""
  ],
  [
    "9ca1",
    ""
  ],
  [
    "9d40",
    ""
  ],
  [
    "9da1",
    ""
  ],
  [
    "9e40",
    ""
  ],
  [
    "9ea1",
    ""
  ],
  [
    "9ead",
    ""
  ],
  [
    "9ec5",
    ""
  ],
  [
    "9ef5",
    ""
  ],
  [
    "9f40",
    ""
  ],
  [
    "9f4f",
    ""
  ],
  [
    "9fa1",
    ""
  ],
  [
    "9fae",
    ""
  ],
  [
    "9fb2",
    ""
  ],
  [
    "9fc1",
    ""
  ],
  [
    "9fc9",
    ""
  ],
  [
    "9fdb",
    ""
  ],
  [
    "9fe7",
    ""
  ],
  [
    "9feb",
    ""
  ],
  [
    "9ff0",
    ""
  ],
  [
    "a040",
    ""
  ],
  [
    "a055",
    ""
  ],
  [
    "a058",
    ""
  ],
  [
    "a05b",
    ""
  ],
  [
    "a063",
    ""
  ],
  [
    "a073",
    ""
  ],
  [
    "a0a1",
    ""
  ],
  [
    "a0a6",
    ""
  ],
  [
    "a0ae",
    ""
  ],
  [
    "a0b0",
    ""
  ],
  [
    "a0d4",
    ""
  ],
  [
    "a0e2",
    ""
  ],
  [
    "a3c0",
    "",
    31,
    ""
  ],
  [
    "c6a1",
    "",
    9,
    "",
    9,
    "",
    9,
    "",
    23
  ],
  [
    "c740",
    "",
    58,
    ""
  ],
  [
    "c7a1",
    "",
    81,
    "",
    5,
    "",
    4
  ],
  [
    "c840",
    "",
    26,
    "",
    25,
    ""
  ],
  [
    "c8a1",
    ""
  ],
  [
    "c8cd",
    ""
  ],
  [
    "c8f5",
    ""
  ],
  [
    "f9fe",
    ""
  ],
  [
    "fa40",
    ""
  ],
  [
    "faa1",
    ""
  ],
  [
    "fb40",
    ""
  ],
  [
    "fba1",
    ""
  ],
  [
    "fc40",
    ""
  ],
  [
    "fca1",
    ""
  ],
  [
    "fd40",
    ""
  ],
  [
    "fda1",
    ""
  ],
  [
    "fe40",
    ""
  ],
  [
    "fea1",
    ""
  ]
];
var wh, U0;
function Hw() {
  return U0 || (U0 = 1, wh = {
    // == Japanese/ShiftJIS ====================================================
    // All japanese encodings are based on JIS X set of standards:
    // JIS X 0201 - Single-byte encoding of ASCII +  + Kana chars at 0xA1-0xDF.
    // JIS X 0208 - Main set of 6879 characters, placed in 94x94 plane, to be encoded by 2 bytes. 
    //              Has several variations in 1978, 1983, 1990 and 1997.
    // JIS X 0212 - Supplementary plane of 6067 chars in 94x94 plane. 1990. Effectively dead.
    // JIS X 0213 - Extension and modern replacement of 0208 and 0212. Total chars: 11233.
    //              2 planes, first is superset of 0208, second - revised 0212.
    //              Introduced in 2000, revised 2004. Some characters are in Unicode Plane 2 (0x2xxxx)
    // Byte encodings are:
    //  * Shift_JIS: Compatible with 0201, uses not defined chars in top half as lead bytes for double-byte
    //               encoding of 0208. Lead byte ranges: 0x81-0x9F, 0xE0-0xEF; Trail byte ranges: 0x40-0x7E, 0x80-0x9E, 0x9F-0xFC.
    //               Windows CP932 is a superset of Shift_JIS. Some companies added more chars, notably KDDI.
    //  * EUC-JP:    Up to 3 bytes per character. Used mostly on *nixes.
    //               0x00-0x7F       - lower part of 0201
    //               0x8E, 0xA1-0xDF - upper part of 0201
    //               (0xA1-0xFE)x2   - 0208 plane (94x94).
    //               0x8F, (0xA1-0xFE)x2 - 0212 plane (94x94).
    //  * JIS X 208: 7-bit, direct encoding of 0208. Byte ranges: 0x21-0x7E (94 values). Uncommon.
    //               Used as-is in ISO2022 family.
    //  * ISO2022-JP: Stateful encoding, with escape sequences to switch between ASCII, 
    //                0201-1976 Roman, 0208-1978, 0208-1983.
    //  * ISO2022-JP-1: Adds esc seq for 0212-1990.
    //  * ISO2022-JP-2: Adds esc seq for GB2313-1980, KSX1001-1992, ISO8859-1, ISO8859-7.
    //  * ISO2022-JP-3: Adds esc seq for 0201-1976 Kana set, 0213-2000 Planes 1, 2.
    //  * ISO2022-JP-2004: Adds 0213-2004 Plane 1.
    //
    // After JIS X 0213 appeared, Shift_JIS-2004, EUC-JISX0213 and ISO2022-JP-2004 followed, with just changing the planes.
    //
    // Overall, it seems that it's a mess :( http://www8.plala.or.jp/tkubota1/unicode-symbols-map2.html
    shiftjis: {
      type: "_dbcs",
      table: function() {
        return Ow;
      },
      encodeAdd: { "": 92, "": 126 },
      encodeSkipVals: [{ from: 60736, to: 63808 }]
    },
    csshiftjis: "shiftjis",
    mskanji: "shiftjis",
    sjis: "shiftjis",
    windows31j: "shiftjis",
    ms31j: "shiftjis",
    xsjis: "shiftjis",
    windows932: "shiftjis",
    ms932: "shiftjis",
    932: "shiftjis",
    cp932: "shiftjis",
    eucjp: {
      type: "_dbcs",
      table: function() {
        return Nw;
      },
      encodeAdd: { "": 92, "": 126 }
    },
    // TODO: KDDI extension to Shift_JIS
    // TODO: IBM CCSID 942 = CP932, but F0-F9 custom chars and other char changes.
    // TODO: IBM CCSID 943 = Shift_JIS = CP932 with original Shift_JIS lower 128 chars.
    // == Chinese/GBK ==========================================================
    // http://en.wikipedia.org/wiki/GBK
    // We mostly implement W3C recommendation: https://www.w3.org/TR/encoding/#gbk-encoder
    // Oldest GB2312 (1981, ~7600 chars) is a subset of CP936
    gb2312: "cp936",
    gb231280: "cp936",
    gb23121980: "cp936",
    csgb2312: "cp936",
    csiso58gb231280: "cp936",
    euccn: "cp936",
    // Microsoft's CP936 is a subset and approximation of GBK.
    windows936: "cp936",
    ms936: "cp936",
    936: "cp936",
    cp936: {
      type: "_dbcs",
      table: function() {
        return bh;
      }
    },
    // GBK (~22000 chars) is an extension of CP936 that added user-mapped chars and some other.
    gbk: {
      type: "_dbcs",
      table: function() {
        return bh.concat(O0);
      }
    },
    xgbk: "gbk",
    isoir58: "gbk",
    // GB18030 is an algorithmic extension of GBK.
    // Main source: https://www.w3.org/TR/encoding/#gbk-encoder
    // http://icu-project.org/docs/papers/gb18030.html
    // http://source.icu-project.org/repos/icu/data/trunk/charset/data/xml/gb-18030-2000.xml
    // http://www.khngai.com/chinese/charmap/tblgbk.php?page=0
    gb18030: {
      type: "_dbcs",
      table: function() {
        return bh.concat(O0);
      },
      gb18030: function() {
        return zw;
      },
      encodeSkipVals: [128],
      encodeAdd: { "": 41699 }
    },
    chinese: "gb18030",
    // == Korean ===============================================================
    // EUC-KR, KS_C_5601 and KS X 1001 are exactly the same.
    windows949: "cp949",
    ms949: "cp949",
    949: "cp949",
    cp949: {
      type: "_dbcs",
      table: function() {
        return Ww;
      }
    },
    cseuckr: "cp949",
    csksc56011987: "cp949",
    euckr: "cp949",
    isoir149: "cp949",
    korean: "cp949",
    ksc56011987: "cp949",
    ksc56011989: "cp949",
    ksc5601: "cp949",
    // == Big5/Taiwan/Hong Kong ================================================
    // There are lots of tables for Big5 and cp950. Please see the following links for history:
    // http://moztw.org/docs/big5/  http://www.haible.de/bruno/charsets/conversion-tables/Big5.html
    // Variations, in roughly number of defined chars:
    //  * Windows CP 950: Microsoft variant of Big5. Canonical: http://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/CP950.TXT
    //  * Windows CP 951: Microsoft variant of Big5-HKSCS-2001. Seems to be never public. http://me.abelcheung.org/articles/research/what-is-cp951/
    //  * Big5-2003 (Taiwan standard) almost superset of cp950.
    //  * Unicode-at-on (UAO) / Mozilla 1.8. Falling out of use on the Web. Not supported by other browsers.
    //  * Big5-HKSCS (-2001, -2004, -2008). Hong Kong standard. 
    //    many unicode code points moved from PUA to Supplementary plane (U+2XXXX) over the years.
    //    Plus, it has 4 combining sequences.
    //    Seems that Mozilla refused to support it for 10 yrs. https://bugzilla.mozilla.org/show_bug.cgi?id=162431 https://bugzilla.mozilla.org/show_bug.cgi?id=310299
    //    because big5-hkscs is the only encoding to include astral characters in non-algorithmic way.
    //    Implementations are not consistent within browsers; sometimes labeled as just big5.
    //    MS Internet Explorer switches from big5 to big5-hkscs when a patch applied.
    //    Great discussion & recap of what's going on https://bugzilla.mozilla.org/show_bug.cgi?id=912470#c31
    //    In the encoder, it might make sense to support encoding old PUA mappings to Big5 bytes seq-s.
    //    Official spec: http://www.ogcio.gov.hk/en/business/tech_promotion/ccli/terms/doc/2003cmp_2008.txt
    //                   http://www.ogcio.gov.hk/tc/business/tech_promotion/ccli/terms/doc/hkscs-2008-big5-iso.txt
    // 
    // Current understanding of how to deal with Big5(-HKSCS) is in the Encoding Standard, http://encoding.spec.whatwg.org/#big5-encoder
    // Unicode mapping (http://www.unicode.org/Public/MAPPINGS/OBSOLETE/EASTASIA/OTHER/BIG5.TXT) is said to be wrong.
    windows950: "cp950",
    ms950: "cp950",
    950: "cp950",
    cp950: {
      type: "_dbcs",
      table: function() {
        return N0;
      }
    },
    // Big5 has many variations and is an extension of cp950. We use Encoding Standard's as a consensus.
    big5: "big5hkscs",
    big5hkscs: {
      type: "_dbcs",
      table: function() {
        return N0.concat(Vw);
      },
      encodeSkipVals: [
        // Although Encoding Standard says we should avoid encoding to HKSCS area (See Step 1 of
        // https://encoding.spec.whatwg.org/#index-big5-pointer), we still do it to increase compatibility with ICU.
        // But if a single unicode point can be encoded both as HKSCS and regular Big5, we prefer the latter.
        36457,
        36463,
        36478,
        36523,
        36532,
        36557,
        36560,
        36695,
        36713,
        36718,
        36811,
        36862,
        36973,
        36986,
        37060,
        37084,
        37105,
        37311,
        37551,
        37552,
        37553,
        37554,
        37585,
        37959,
        38090,
        38361,
        38652,
        39285,
        39798,
        39800,
        39803,
        39878,
        39902,
        39916,
        39926,
        40002,
        40019,
        40034,
        40040,
        40043,
        40055,
        40124,
        40125,
        40144,
        40279,
        40282,
        40388,
        40431,
        40443,
        40617,
        40687,
        40701,
        40800,
        40907,
        41079,
        41180,
        41183,
        36812,
        37576,
        38468,
        38637,
        // Step 2 of https://encoding.spec.whatwg.org/#index-big5-pointer: Use last pointer for U+2550, U+255E, U+2561, U+256A, U+5341, or U+5345
        41636,
        41637,
        41639,
        41638,
        41676,
        41678
      ]
    },
    cnbig5: "big5hkscs",
    csbig5: "big5hkscs",
    xxbig5: "big5hkscs"
  }), wh;
}
var G0;
function jw() {
  return G0 || (G0 = 1, function(e) {
    for (var t = [
      Dw(),
      _w(),
      Pw(),
      Bw(),
      Lw(),
      Fw(),
      Iw(),
      Rw(),
      Hw()
    ], r = 0; r < t.length; r++) {
      var n = t[r];
      for (var i in n)
        Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);
    }
  }(hh)), hh;
}
var xh, z0;
function Xw() {
  if (z0) return xh;
  z0 = 1;
  var e = Wa.Buffer;
  return xh = function(t) {
    var r = t.Transform;
    function n(a, s) {
      this.conv = a, s = s || {}, s.decodeStrings = !1, r.call(this, s);
    }
    n.prototype = Object.create(r.prototype, {
      constructor: { value: n }
    }), n.prototype._transform = function(a, s, o) {
      if (typeof a != "string")
        return o(new Error("Iconv encoding stream needs strings as its input."));
      try {
        var u = this.conv.write(a);
        u && u.length && this.push(u), o();
      } catch (l) {
        o(l);
      }
    }, n.prototype._flush = function(a) {
      try {
        var s = this.conv.end();
        s && s.length && this.push(s), a();
      } catch (o) {
        a(o);
      }
    }, n.prototype.collect = function(a) {
      var s = [];
      return this.on("error", a), this.on("data", function(o) {
        s.push(o);
      }), this.on("end", function() {
        a(null, e.concat(s));
      }), this;
    };
    function i(a, s) {
      this.conv = a, s = s || {}, s.encoding = this.encoding = "utf8", r.call(this, s);
    }
    return i.prototype = Object.create(r.prototype, {
      constructor: { value: i }
    }), i.prototype._transform = function(a, s, o) {
      if (!e.isBuffer(a) && !(a instanceof Uint8Array))
        return o(new Error("Iconv decoding stream needs buffers as its input."));
      try {
        var u = this.conv.write(a);
        u && u.length && this.push(u, this.encoding), o();
      } catch (l) {
        o(l);
      }
    }, i.prototype._flush = function(a) {
      try {
        var s = this.conv.end();
        s && s.length && this.push(s, this.encoding), a();
      } catch (o) {
        a(o);
      }
    }, i.prototype.collect = function(a) {
      var s = "";
      return this.on("error", a), this.on("data", function(o) {
        s += o;
      }), this.on("end", function() {
        a(null, s);
      }), this;
    }, {
      IconvLiteEncoderStream: n,
      IconvLiteDecoderStream: i
    };
  }, xh;
}
const qw = {}, $w = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: qw
}, Symbol.toStringTag, { value: "Module" })), Yw = /* @__PURE__ */ gw($w);
(function(e) {
  var t = Wa.Buffer, r = kv, n = e.exports;
  n.encodings = null, n.defaultCharUnicode = "", n.defaultCharSingleByte = "?", n.encode = function(s, o, u) {
    s = "" + (s || "");
    var l = n.getEncoder(o, u), c = l.write(s), f = l.end();
    return f && f.length > 0 ? t.concat([c, f]) : c;
  }, n.decode = function(s, o, u) {
    typeof s == "string" && (n.skipDecodeWarning || (console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"), n.skipDecodeWarning = !0), s = t.from("" + (s || ""), "binary"));
    var l = n.getDecoder(o, u), c = l.write(s), f = l.end();
    return f ? c + f : c;
  }, n.encodingExists = function(s) {
    try {
      return n.getCodec(s), !0;
    } catch (o) {
      return !1;
    }
  }, n.toEncoding = n.encode, n.fromEncoding = n.decode, n._codecDataCache = {}, n.getCodec = function(s) {
    n.encodings || (n.encodings = jw());
    for (var o = n._canonicalizeEncoding(s), u = {}; ; ) {
      var l = n._codecDataCache[o];
      if (l)
        return l;
      var c = n.encodings[o];
      switch (typeof c) {
        case "string":
          o = c;
          break;
        case "object":
          for (var f in c)
            u[f] = c[f];
          u.encodingName || (u.encodingName = o), o = c.type;
          break;
        case "function":
          return u.encodingName || (u.encodingName = o), l = new c(u, n), n._codecDataCache[u.encodingName] = l, l;
        default:
          throw new Error("Encoding not recognized: '" + s + "' (searched as: '" + o + "')");
      }
    }
  }, n._canonicalizeEncoding = function(a) {
    return ("" + a).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g, "");
  }, n.getEncoder = function(s, o) {
    var u = n.getCodec(s), l = new u.encoder(o, u);
    return u.bomAware && o && o.addBOM && (l = new r.PrependBOM(l, o)), l;
  }, n.getDecoder = function(s, o) {
    var u = n.getCodec(s), l = new u.decoder(o, u);
    return u.bomAware && !(o && o.stripBOM === !1) && (l = new r.StripBOM(l, o)), l;
  }, n.enableStreamingAPI = function(s) {
    if (!n.supportsStreams) {
      var o = Xw()(s);
      n.IconvLiteEncoderStream = o.IconvLiteEncoderStream, n.IconvLiteDecoderStream = o.IconvLiteDecoderStream, n.encodeStream = function(l, c) {
        return new n.IconvLiteEncoderStream(n.getEncoder(l, c), c);
      }, n.decodeStream = function(l, c) {
        return new n.IconvLiteDecoderStream(n.getDecoder(l, c), c);
      }, n.supportsStreams = !0;
    }
  };
  var i;
  try {
    i = Yw;
  } catch (a) {
  }
  i && i.Transform ? n.enableStreamingAPI(i) : n.encodeStream = n.decodeStream = function() {
    throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.");
  };
})(yd);
var bd = { exports: {} };
(function(e, t) {
  var r = Ts, n = r.Buffer;
  function i(s, o) {
    for (var u in s)
      o[u] = s[u];
  }
  n.from && n.alloc && n.allocUnsafe && n.allocUnsafeSlow ? e.exports = r : (i(r, t), t.Buffer = a);
  function a(s, o, u) {
    return n(s, o, u);
  }
  i(n, a), a.from = function(s, o, u) {
    if (typeof s == "number")
      throw new TypeError("Argument must not be a number");
    return n(s, o, u);
  }, a.alloc = function(s, o, u) {
    if (typeof s != "number")
      throw new TypeError("Argument must be a number");
    var l = n(s);
    return o !== void 0 ? typeof u == "string" ? l.fill(o, u) : l.fill(o) : l.fill(0), l;
  }, a.allocUnsafe = function(s) {
    if (typeof s != "number")
      throw new TypeError("Argument must be a number");
    return n(s);
  }, a.allocUnsafeSlow = function(s) {
    if (typeof s != "number")
      throw new TypeError("Argument must be a number");
    return r.SlowBuffer(s);
  };
})(bd, bd.exports);
var Kw = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "isUseUtf8", !1);
  }
  return Be(e, [{
    key: "encodeToGb2312Imp",
    value: function(r) {
      var n = yd.exports.encode(r, "gb2312"), i = "";
      return n.forEach(function(a) {
        i += "%" + a.toString(16);
      }), i;
    }
  }, {
    key: "decodeFromGb2312Imp",
    value: function(r) {
      for (var n = [], i = r.length, a = 0; a < i; ) {
        var s = r.charAt(a);
        if (s == "%") {
          a += 1;
          var o = parseInt(r.slice(a, a + 2), 16);
          n.push(o), a += 2;
        } else {
          console.log("decode hexstr error");
          break;
        }
      }
      return yd.exports.decode(bd.exports.Buffer.from(n), "gb2312");
    }
  }, {
    key: "encodeToGb2312",
    value: function(r) {
      return this.isUseUtf8 ? r : this.encodeToGb2312Imp(r);
    }
  }, {
    key: "decodeFromGb2312",
    value: function(r) {
      return this.isUseUtf8 ? r : this.decodeFromGb2312Imp(r);
    }
  }]), e;
}(), xe = new Kw(), zy = window;
zy.McDrawObjectEvent_utf8ToAscii = function(e) {
  return xe.encodeToGb2312Imp(e);
};
zy.McDrawObjectEvent_asciiToUTF8 = function(e) {
  return xe.decodeFromGb2312Imp(e);
};
const Wy = "1.0.329";
var Zw = "SharedArrayBuffer" in window, _v = document.currentScript && /unpkg\.com\/mxcad/.test(document.currentScript.src), Jw = function(t) {
  var r = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : self.location.href;
  return _v ? "https://unpkg.com/mxcad@".concat(Wy, "/dist/wasm/2d-st/").concat(t) : r + t;
}, Qw = function(t) {
  var r = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : self.location.href;
  return _v ? "https://unpkg.com/mxcad@".concat(Wy, "/dist/wasm/2d/").concat(t) : r + t;
}, e2 = function(t) {
  return new Promise(function(r, n) {
    var i = document.createElement("script");
    i.src = t, i.type = "text/javascript", i.crossOrigin = "anonymous", document.body.appendChild(i), i.onload = function() {
      r();
    }, i.onerror = function(a) {
      n(a);
    };
  });
}, t2 = /* @__PURE__ */ function() {
  var e = ut(/* @__PURE__ */ be.mark(function t(r, n, i) {
    var a, s;
    return be.wrap(function(u) {
      for (; ; ) switch (u.prev = u.next) {
        case 0:
          return a = i.locateFile, s = a(r + ".js"), u.prev = 2, u.next = 5, e2(s);
        case 5:
          return u.next = 7, globalThis[n](i);
        case 7:
          return u.abrupt("return", u.sent);
        case 10:
          u.prev = 10, u.t0 = u.catch(2), console.error(`wasm, locateFile:
        createMxCad({
            locateFile: (fileName)=> {
                // fileName
                retrun "`.concat(s, `"
            }
        })
        `)), console.error(u.t0);
        case 14:
        case "end":
          return u.stop();
      }
    }, t, null, [[2, 10]]);
  }));
  return function(r, n, i) {
    return e.apply(this, arguments);
  };
}();
function wd(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = new Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function r2(e) {
  if (Array.isArray(e)) return wd(e);
}
function n2(e) {
  if (typeof Symbol != "undefined" && e[Symbol.iterator] != null || e["@@iterator"] != null) return Array.from(e);
}
function Vy(e, t) {
  if (e) {
    if (typeof e == "string") return wd(e, t);
    var r = Object.prototype.toString.call(e).slice(8, -1);
    if (r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set") return Array.from(e);
    if (r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)) return wd(e, t);
  }
}
function i2() {
  throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function Xt(e) {
  return r2(e) || n2(e) || Vy(e) || i2();
}
function Ac(e, t) {
  return Ac = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(n, i) {
    return n.__proto__ = i, n;
  }, Ac(e, t);
}
function lt(e, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Super expression must either be null or a function");
  e.prototype = Object.create(t && t.prototype, {
    constructor: {
      value: e,
      writable: !0,
      configurable: !0
    }
  }), Object.defineProperty(e, "prototype", {
    writable: !1
  }), t && Ac(e, t);
}
function dt(e) {
  if (e === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return e;
}
function kr(e, t) {
  if (t && (Er(t) === "object" || typeof t == "function"))
    return t;
  if (t !== void 0)
    throw new TypeError("Derived constructors may only return object or undefined");
  return dt(e);
}
function hr(e) {
  return hr = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(r) {
    return r.__proto__ || Object.getPrototypeOf(r);
  }, hr(e);
}
var W0 = new FinalizationRegistry(function(e) {
  ie.App.destroyObject(e);
}), V0 = {}, Xo = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", 0), this.imp = t, this.imp && (this.imp.isNull() && console.log("Mx:error null constructor object "), W0.register(this, t, V0));
  }
  return Be(e, [{
    key: "constructor_MxCADResbuf",
    value: function(r) {
      this.imp = r, this.imp && W0.register(this, r, V0);
    }
  }, {
    key: "getImp",
    value: function() {
      return this.imp;
    }
  }, {
    key: "initTempObject",
    value: function(r) {
      this.imp = r;
    }
  }, {
    key: "objectName",
    get: function() {
      return this.imp.getObjectName();
    }
  }, {
    key: "dxf0",
    get: function() {
      return this.imp.getDxf0();
    }
  }, {
    key: "getJson",
    value: function() {
      var r = this.imp.getJson();
      return xe.decodeFromGb2312(r);
    }
  }, {
    key: "setJson",
    value: function(r) {
      var n = xe.encodeToGb2312(r);
      return this.imp.setJson(n);
    }
  }, {
    key: "isKindOf",
    value: function(r) {
      return this.imp.isKindOf(r);
    }
  }, {
    key: "isNull",
    value: function() {
      return this.imp.isNull();
    }
  }]), e;
}();
function a2(e) {
  var t = Hy();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function Hy() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (Hy = function() {
    return !!e;
  })();
}
var rt = /* @__PURE__ */ function(e) {
  return e[e.kMxCAD = 0] = "kMxCAD", e[e.kMxDraw = 1] = "kMxDraw", e[e.kInvalid = 2] = "kInvalid", e;
}(rt || {}), Fe = /* @__PURE__ */ function() {
  function e() {
    var t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0, r = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 2;
    Pe(this, e), le(this, "id", void 0), le(this, "type", void 0), this.id = t, t ? r == 2 ? this.type = 0 : this.type = r : this.type = 2;
  }
  return Be(e, [{
    key: "isValid",
    value: function() {
      return this.type != 2 && this.id != 0;
    }
  }, {
    key: "isNull",
    value: function() {
      return this.type == 2 || this.id == 0;
    }
  }, {
    key: "isErase",
    value: function() {
      return this.isValid() && this.type == 0 && this.id != 0 ? ie.App.getImp().isObjectEraseSataus(this.id) : !1;
    }
  }, {
    key: "erase",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
      this.isValid() && (this.type == 1 ? Ue.getCurrentDraw().eraseMxEntity(this.id) : this.type == 0 && Bt.eraseObject(this.id, r));
    }
  }, {
    key: "getMcDbObject",
    value: function() {
      return this.isValid() && this.type == 0 ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "isKindOf",
    value: function(r) {
      return this.isValid() && this.type == 0 ? ie.App.objectIdIsKindOf(this.id, r) : !1;
    }
  }, {
    key: "getMcDbEntity",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbEntity") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbCurve",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbCurve") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbBlockTableRecord",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbBlockTableRecord") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbLayerTableRecord",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbLayerTableRecord") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbDimStyleTableRecord",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbDimStyleTableRecord") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbLinetypeTableRecord",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbLinetypeTableRecord") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbTextStyleTableRecord",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbTextStyleTableRecord") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbDimension",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbDimension") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbCustomEntity",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbCustomEntity") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "clone",
    value: function() {
      if (!this.isValid()) return null;
      if (this.type == 0) {
        var r = ie.App.getImp();
        if (r.ObjectIdIsKindOf(this.id, "McDbCustomEntity")) {
          var n = this.getMcDbCustomEntity();
          return n ? n.clone() : null;
        } else {
          var i = r.ObjectIdToMdObject(this.id);
          if (!i) return null;
          var a = i.Clone();
          return ie.App.destroyObject(i), ie.App.createCloneObject(a);
        }
      }
      return null;
    }
  }, {
    key: "getObjectName",
    value: function() {
      if (this.type == 0)
        return ie.App.getImp().ObjectIdToObjectName(this.id);
      if (this.type == 1) {
        var r = Ue.getCurrentDraw().getMxEntity(this.id);
        if (r)
          return r.getTypeName();
      }
      return "";
    }
  }, {
    key: "getMxDbEntity",
    value: function() {
      return this.isValid() && this.type == 1 ? Ue.getCurrentDraw().getMxEntity(this.id) : null;
    }
  }, {
    key: "getMcDbRasterImageDef",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbRasterImageDef") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbDictionary",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbDictionary") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbXrecord",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbXrecord") ? ie.App.objectIdToObject(this.id) : null;
    }
  }, {
    key: "getMcDbGroup",
    value: function() {
      return this.isValid() && this.type == 0 && ie.App.objectIdIsKindOf(this.id, "McDbGroup") ? ie.App.objectIdToObject(this.id) : null;
    }
  }]), e;
}(), Nr = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = a2(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "getObjectID",
    value: function() {
      return new Fe(
        this.imp.GetObjectID(),
        0
        /* kMxCAD */
      );
    }
  }, {
    key: "erase",
    value: function() {
      return this.imp.Erase();
    }
  }, {
    key: "isErased",
    value: function() {
      return this.imp.isErased();
    }
  }, {
    key: "unErase",
    value: function() {
      return this.imp.unErase();
    }
  }, {
    key: "clone",
    value: function() {
      var i = this.imp.Clone();
      return ie.App.createCloneObject(i);
    }
  }, {
    key: "getHandle",
    value: function() {
      return this.imp.GetHandle();
    }
  }, {
    key: "getDatabase",
    value: function() {
      return new Va(this.imp.GetDatabase());
    }
  }, {
    key: "getOwnerID",
    value: function() {
      return this.imp.GetOwnerID();
    }
  }, {
    key: "getExtensionDictionary",
    value: function() {
      return new vs(this.imp.GetExtensionDictionary());
    }
  }, {
    key: "isHaveExtensionDictionary",
    value: function() {
      return this.imp.IsHaveExtensionDictionary();
    }
  }, {
    key: "createExtensionDictionary",
    value: function() {
      return this.imp.createExtensionDictionary();
    }
  }, {
    key: "getDatabaseIndexId",
    value: function() {
      return this.imp.GetDatabaseIndexId();
    }
  }, {
    key: "moveGripPointsAt",
    value: function(i, a, s, o) {
      return this.imp.moveGripPointsAt(i, a, s, o);
    }
  }, {
    key: "getGripPoints",
    value: function() {
      return new Xr(this.imp.getGripPoints());
    }
  }, {
    key: "tempRelationObject",
    value: function() {
      return 0;
    }
  }, {
    key: "freeTempRelationObject",
    value: function() {
    }
  }, {
    key: "assertObjectModification",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !1;
      return this.imp.assertObjectModification(i);
    }
  }]), r;
}(Xo), gu = /* @__PURE__ */ function() {
  function e(t) {
    if (Pe(this, e), le(this, "aryVal", []), t) {
      for (var r = 0, n = t.length(); r < n; r++) {
        var i = t.release(r), a = ie.App.createCloneObject(i);
        a != null && this.aryVal.push(a);
      }
      ie.App.destroyObject(t);
    }
  }
  return Be(e, [{
    key: "forEach",
    value: function(r) {
      for (var n = this.aryVal.length, i = 0; i < n; i++)
        r(this.aryVal[i], i);
    }
  }, {
    key: "length",
    value: function() {
      return this.aryVal.length;
    }
  }, {
    key: "empty",
    value: function() {
      return this.aryVal.length == 0;
    }
  }]), e;
}();
function la(e) {
  var t = jy();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function jy() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (jy = function() {
    return !!e;
  })();
}
var Pv = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e);
  }
  return Be(e, [{
    key: "doc2cad",
    value: function(r) {
      return r;
    }
  }, {
    key: "cad2doc",
    value: function(r) {
      return r;
    }
  }, {
    key: "doc2cad1",
    value: function(r) {
      return new te(r.x, r.y, r.z);
    }
  }, {
    key: "doc2cad2",
    value: function(r, n, i) {
      return new te(r, n, i);
    }
  }, {
    key: "cad2doc1",
    value: function(r) {
      return new THREE.Vector3(r.x, r.y, r.z);
    }
  }, {
    key: "cad2doc2",
    value: function(r, n, i) {
      return new THREE.Vector3(r, n, i);
    }
  }]), e;
}(), qt;
qt = new Pv();
function Ta() {
  var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : null, t;
  return e ? t = e.getImp() : t = new ie.mxcadassemblyimp.McDrawResbuf(), t;
}
var vr = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r(n) {
    var i;
    if (Pe(this, r), n)
      if (n instanceof Array) {
        i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.McDrawResbuf());
        for (var a = n.length, s = !1, o = 0; o < a; o++)
          if (n[o] instanceof Object) {
            s = !0;
            break;
          }
        if (s)
          i.setJson(JSON.stringify(n));
        else {
          for (var u = [], l = 0; l + 1 < a; l += 2)
            typeof n[l] == "number" && u.push({
              type: n[l],
              val: n[l + 1]
            });
          u.length > 0 && i.setJson(JSON.stringify(u));
        }
      } else
        i = t.call(this), i.constructor_MxCADResbuf(n);
    else
      i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.McDrawResbuf());
    return kr(i);
  }
  return Be(r, [{
    key: "Clear",
    value: function() {
      this.imp.Clear();
    }
  }, {
    key: "forEach",
    value: function(i) {
      for (var a = this.GetCount(), s = 0; s < a; s++) {
        var o = this.ItemDataType(s), u = this.ItemDataDxf(s);
        o == 5005 ? i(this.AtString(s, !0).val, o, u, s) : o == 5009 ? i(this.AtPoint(s).val, o, u, s) : o == 5001 ? i(this.AtDouble(s).val, o, u, s) : o == 5003 || o == 5010 ? i(this.AtLong(s).val, 5010, u, s) : u == -8500 ? i(this.AtObject(s).val, -8500, -8500, s) : o == -8e3 || o == -8001 || o == -8002 || o == -8003 || o == -8004 ? i(this.AtObjectId(s).val, -8e3, -8e3, s) : i(void 0, o, u, s);
      }
    }
  }, {
    key: "GetCount",
    value: function() {
      return this.imp.GetCount();
    }
  }, {
    key: "GetPoints",
    value: function() {
      var i = new Xr();
      return this.forEach(function(a, s, o) {
        if (o === 1010) {
          var u = new te(a.x, a.y, a.z);
          i.append(u);
        }
      }), i;
    }
  }, {
    key: "AtDouble",
    value: function(i) {
      return {
        val: this.imp.AtDouble(i),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "AtLong",
    value: function(i) {
      return {
        val: this.imp.Atlong(i),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "AtObject",
    value: function(i) {
      if (i >= this.imp.GetCount())
        return {
          val: void 0,
          ret: !1
        };
      var a = this.imp.AtObject(i), s = ie.App.createCloneObject(a);
      return s === null ? {
        val: void 0,
        ret: !1
      } : {
        val: s,
        ret: !0
      };
    }
  }, {
    key: "AddObject",
    value: function(i) {
      this.imp.AddObject(i.getImp());
    }
  }, {
    key: "AtObjectId",
    value: function(i) {
      return {
        val: new Fe(this.imp.AtObjectId(i), rt.kMxCAD),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "AtString",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
      if (a) {
        var s = xe.decodeFromGb2312(this.imp.AtString(i, !0));
        return {
          val: s,
          ret: ie.getCallResult() == 0
        };
      } else
        return {
          val: this.imp.AtString(i, !0),
          ret: ie.getCallResult() == 0
        };
    }
  }, {
    key: "AtPoint",
    value: function(i) {
      return {
        val: new te(this.imp.AtPoint(i)),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "ItemDataType",
    value: function(i) {
      return this.imp.ItemDataType(i);
    }
  }, {
    key: "ItemDataDxf",
    value: function(i) {
      return this.imp.ItemDataDxf(i);
    }
  }, {
    key: "AddDouble",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : -10;
      return this.imp.AddDouble(i, a);
    }
  }, {
    key: "AddLong",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : -10;
      return this.imp.Addlong(i, a);
    }
  }, {
    key: "AddObjectId",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : -10;
      return this.imp.AddObjectId(i, a);
    }
  }, {
    key: "AddString",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : -10, s = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0;
      return s ? this.imp.AddString(xe.encodeToGb2312(i), a) : this.imp.AddString(i, a);
    }
  }, {
    key: "AddAppName",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
      return a ? this.imp.AddAppName(xe.encodeToGb2312(i)) : this.imp.AddAppName(i);
    }
  }, {
    key: "AddMcDbEntityTypes",
    value: function(i) {
      return this.imp.AddString(i, 5020);
    }
  }, {
    key: "AddPoint",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : -10;
      return this.imp.AddPoint(i.imp, a);
    }
  }, {
    key: "RemoveAll",
    value: function() {
      this.imp.RemoveAll();
    }
  }, {
    key: "Remove",
    value: function(i) {
      this.imp.Remove(i);
    }
  }, {
    key: "PrintData",
    value: function() {
      this.imp.PrintData();
    }
  }]), r;
}(Xo), Bv = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "imp", void 0);
  }
  return Be(e, [{
    key: "eraseObject",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
      return this.init(), this.imp.eraseObject(r, n);
    }
  }, {
    key: "highlightEntity",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
      return this.init(), this.imp.highlightEntity(r, n);
    }
  }, {
    key: "findEntAtPoint",
    value: function(r, n, i) {
      var a = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : -1, s = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : null;
      this.init();
      var o = this.imp.findEntAtPoint(r, n, i, a, Ta(s));
      return new Fe(o, rt.kMxCAD);
    }
  }, {
    key: "selectEnt",
    value: function(r) {
      var n = this, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : null, a = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0, s = arguments.length > 3 ? arguments[3] : void 0, o = arguments.length > 4 ? arguments[4] : void 0;
      return this.init(), new Promise(/* @__PURE__ */ function() {
        var u = ut(/* @__PURE__ */ be.mark(function l(c) {
          var f, h, d, g, v;
          return be.wrap(function(p) {
            for (; ; ) switch (p.prev = p.next) {
              case 0:
                return f = new Wf(), typeof s == "function" && s(f), r && f.setMessage(r), f.setCursorType(Vf.kRect), f.disableAllTrace(), f.setDynamicInputType(pn.kDynTip), p.next = 8, f.go();
              case 8:
                if (h = p.sent, h) {
                  p.next = 12;
                  break;
                }
                return c([]), p.abrupt("return");
              case 12:
                typeof o == "function" && o(new te().setFromVector3(h)), f.clearLastInputPoint(), a ? md.findEntAtPoint(h).then(function(y) {
                  var w = [];
                  y.forEach(function(M) {
                    w.push(new Fe(M, rt.kMxDraw));
                  });
                  var x = qt.doc2cad1(h), b = n.findEntAtPoint(x.x, x.y, x.z, -1, i);
                  b.isValid() && w.push(b), c(w);
                }) : (d = [], g = qt.doc2cad1(h), v = n.findEntAtPoint(g.x, g.y, g.z, -1, i), v.isValid() && d.push(v), c(d));
              case 15:
              case "end":
                return p.stop();
            }
          }, l);
        }));
        return function(l) {
          return u.apply(this, arguments);
        };
      }());
    }
  }, {
    key: "getCurrentSelectPoints",
    value: function() {
      var r = Ue.getCurrentDraw().getSelectPoints();
      return r.isvalid ? {
        point1: new te(r.point1),
        point2: new te(r.point2),
        isvalid: !0
      } : {
        point1: new te(),
        point2: new te(),
        isvalid: !1
      };
    }
  }, {
    key: "getCurrentSelect",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : null, n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0, a = [];
      if (i) {
        var s = Ue.getCurrentDraw().getMxCurrentSelect();
        s.forEach(function(d) {
          a.push(new Fe(d, rt.kMxDraw));
        });
      }
      if (n) {
        var o = Ue.getCurrentDraw().getMxCADCurrentSelect();
        if (o.length <= 0)
          return a;
        if (r) {
          var u = new fa();
          o.forEach(function(d) {
            u.append(d);
          });
          var l = new ie.mxcadassemblyimp.McDrawSelSet(), c = l.getFilterEntity(u.imp, Ta(r));
          ie.App.destroyObject(l), o = [];
          for (var f = c.length(), h = 0; h < f; h++)
            o.push(c.at(h));
        }
        o.forEach(function(d) {
          a.push(new Fe(d, rt.kMxCAD));
        });
      }
      return a;
    }
  }, {
    key: "userSelect",
    value: function() {
      var t = ut(/* @__PURE__ */ be.mark(function n(i) {
        var a, s, o, u, l = arguments;
        return be.wrap(function(f) {
          for (; ; ) switch (f.prev = f.next) {
            case 0:
              if (a = l.length > 1 && l[1] !== void 0 ? l[1] : null, s = l.length > 2 ? l[2] : void 0, o = this.getCurrentSelect(a), o.length != 0) {
                f.next = 9;
                break;
              }
              return u = new An(), f.next = 7, u.userSelect(i, a, function(h) {
                s && s(u, h);
              });
            case 7:
              if (!f.sent) {
                f.next = 9;
                break;
              }
              u.forEach(function(h) {
                o.push(h);
              });
            case 9:
              return f.abrupt("return", new Promise(function(h) {
                h(o);
              }));
            case 10:
            case "end":
              return f.stop();
          }
        }, n, this);
      }));
      function r(n) {
        return t.apply(this, arguments);
      }
      return r;
    }()
  }, {
    key: "init",
    value: function() {
      this.imp || (this.imp = new ie.mxcadassemblyimp.McDrawUtility(), new bt().rxInit(), new Hv().rxInit(), new Xv().rxInit());
    }
  }, {
    key: "getCorner",
    value: function() {
      var t = ut(/* @__PURE__ */ be.mark(function n(i, a, s) {
        var o, u, l, c, f, h, d, g, v = arguments;
        return be.wrap(function(p) {
          for (; ; ) switch (p.prev = p.next) {
            case 0:
              o = v.length > 3 && v[3] !== void 0 ? v[3] : !1, u = v.length > 4 && v[4] !== void 0 ? v[4] : !1, l = v.length > 5 ? v[5] : void 0, c = 0, f = void 0;
            case 5:
              if (a) {
                p.next = 16;
                break;
              }
              return h = new Zt(), i && h.setMessage(i), u && h.disableAllTrace(!0), l && l(h), h.setDynamicInputType(pn.kDynTip), p.next = 14, h.go();
            case 14:
              a = p.sent, c = h.getDetailedResult();
            case 16:
              if (a) {
                p.next = 18;
                break;
              }
              return p.abrupt("break", 26);
            case 18:
              return d = qt.cad2doc1(a), p.next = 21, md.getCorner(d, i, o, function(y) {
                c = y.detailedResult;
              }, u);
            case 21:
              return g = p.sent, g && (f = qt.doc2cad1(g)), p.abrupt("break", 26);
            case 26:
              return s && s(c), p.abrupt("return", new Promise(function(y) {
                c == dn.kEcsIn || c == dn.kNewCommadIn || c == dn.kUnknown ? y(null) : y(a && f ? {
                  pt1: a,
                  pt2: f
                } : null);
              }));
            case 28:
            case "end":
              return p.stop();
          }
        }, n);
      }));
      function r(n, i, a) {
        return t.apply(this, arguments);
      }
      return r;
    }()
  }, {
    key: "getMcDbEntitysBoundingBox",
    value: function(r) {
      var n = void 0, i = void 0;
      if (r.forEach(function(a) {
        var s = a.getMcDbEntity();
        if (s != null) {
          var o = s.getBoundingBox();
          o.ret && (!n || !i ? (n = new THREE.Vector3(o.minPt.x, o.minPt.y, 0), i = new THREE.Vector3(o.maxPt.x, o.maxPt.y, 0)) : (n.x > o.minPt.x && (n.x = o.minPt.x), n.y > o.minPt.y && (n.y = o.minPt.y), i.x < o.maxPt.x && (i.x = o.maxPt.x), i.y < o.maxPt.y && (i.y = o.maxPt.y)));
        }
      }), n && i)
        return {
          minPt: new te(n),
          maxPt: new te(i)
        };
    }
  }, {
    key: "calcBulge",
    value: function(r, n, i) {
      var a = this.imp.calcBulge(r.imp, n.imp, i.imp);
      return {
        val: a,
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "pointInPolygon",
    value: function(r, n, i) {
      return this.imp.pointInPolygon(r.imp, n, i);
    }
  }, {
    key: "builderHatchFromPoint",
    value: function(r) {
      var n = this.imp.builderHatchFromPoint(r.x, r.y);
      return n.isNull() ? (ie.App.destroyObject(n), null) : new Mo(n);
    }
  }, {
    key: "getTextBox",
    value: function(r, n, i, a) {
      if (a.type != rt.kMxCAD) return {
        minPt: new te(),
        maxPt: new te(),
        ret: !1
      };
      var s = this.imp.getTextBox(xe.encodeToGb2312(r), n, i, a.id);
      if (s) {
        var o = {
          minPt: new te(),
          maxPt: new te(),
          ret: !1
        };
        return s.GetCount() != 0 && (o = {
          minPt: new te(s.AtPoint(0)),
          maxPt: new te(s.AtPoint(1)),
          ret: !0
        }), ie.App.destroyObject(s), o;
      } else
        return {
          minPt: new te(),
          maxPt: new te(),
          ret: !1
        };
    }
  }, {
    key: "getTextEntityBox",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, i = this.imp.getTextEntityBox(r.imp, n);
      if (i) {
        var a = {
          minPt: new te(),
          maxPt: new te(),
          ret: !1
        };
        return i.GetCount() != 0 && (a = {
          minPt: new te(i.AtPoint(0)),
          maxPt: new te(i.AtPoint(1)),
          ret: !0
        }), ie.App.destroyObject(i), a;
      } else
        return {
          minPt: new te(),
          maxPt: new te(),
          ret: !1
        };
    }
  }]), e;
}(), Bt = new Bv(), Lv = /* @__PURE__ */ function(e) {
  return e[e.kSelected = 0] = "kSelected", e[e.kNone = 1] = "kNone", e[e.kCanceled = 2] = "kCanceled", e[e.kRejected = 3] = "kRejected", e[e.kKeyword = 4] = "kKeyword", e;
}(Lv || {}), An = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    var n;
    return Pe(this, r), n = t.call(this), le(dt(n), "isWhileSelect", !0), le(dt(n), "isSelectHighlight", !0), le(dt(n), "selectPt1", new te()), le(dt(n), "selectPt2", new te()), n.initTempObject(new ie.mxcadassemblyimp.McDrawSelSet()), n.isWhileSelect = Ue.isPC(), n;
  }
  return Be(r, [{
    key: "getSelectPoint",
    value: function() {
      return {
        pt1: this.selectPt1,
        pt2: this.selectPt2
      };
    }
  }, {
    key: "allSelect",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : null;
      return this.imp.allSelect(Ta(i));
    }
  }, {
    key: "pointSelect",
    value: function(i, a) {
      var s = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : null, o = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : -1;
      return this.imp.pointSelect(i, a, Ta(s), o);
    }
  }, {
    key: "crossingSelect",
    value: function(i, a, s, o) {
      var u = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : null;
      return this.imp.crossingSelect(i, a, s, o, Ta(u));
    }
  }, {
    key: "count",
    value: function() {
      return this.imp.count();
    }
  }, {
    key: "isNull",
    value: function() {
      return this.imp.count() == 0;
    }
  }, {
    key: "item",
    value: function(i) {
      return new Fe(this.imp.item(i), rt.kMxCAD);
    }
  }, {
    key: "forEach",
    value: function(i) {
      for (var a = this.imp.count(), s = 0; s < a; s++)
        i(this.item(s));
    }
  }, {
    key: "getIds",
    value: function() {
      for (var i = [], a = this.imp.count(), s = 0; s < a; s++)
        i.push(this.item(s));
      return i;
    }
  }, {
    key: "userSelect",
    value: function() {
      var n = ut(/* @__PURE__ */ be.mark(function a(s) {
        var o, u, l, c, f, h, d, g, v, m = arguments;
        return be.wrap(function(y) {
          for (; ; ) switch (y.prev = y.next) {
            case 0:
              o = m.length > 1 && m[1] !== void 0 ? m[1] : null, u = m.length > 2 ? m[2] : void 0, this.selectPt1 = new te(), this.selectPt2 = new te(), l = new Wf(), s && l.setMessage(s), l.setCursorType(Vf.kRect), l.setDynamicInputType(pn.kDynTip), l.disableAllTrace(), l.isDisableOsnap(), c = 0, u && u(l), f = Ta(o);
            case 13:
              return l.setDynamicInputType(pn.kDynTip), l.setInputToucheType(no.InputToucheType.kGetBegan), y.next = 18, l.go();
            case 18:
              if (h = y.sent, l.clearLastInputPoint(), c = l.getDetailedResult(), h) {
                y.next = 23;
                break;
              }
              return y.abrupt("break", 45);
            case 23:
              if (d = qt.doc2cad1(h), this.imp.userPointSelect(d.x, d.y, f, this.isSelectHighlight) != 0) {
                y.next = 32;
                break;
              }
              if (this.selectPt1.copy(d), this.selectPt2.copy(d), !this.isWhileSelect) {
                y.next = 31;
                break;
              }
              return y.abrupt("continue", 13);
            case 31:
              return y.abrupt("break", 45);
            case 32:
              return y.next = 34, md.getCorner(h, s, !0, function(w) {
                c = w.detailedResult;
              });
            case 34:
              if (g = y.sent, g) {
                y.next = 37;
                break;
              }
              return y.abrupt("break", 45);
            case 37:
              if (v = qt.doc2cad1(g), this.imp.userSelect(d.x, d.y, v.x, v.y, f, this.isSelectHighlight), this.selectPt1.copy(d), this.selectPt2.copy(v), this.isWhileSelect) {
                y.next = 43;
                break;
              }
              return y.abrupt("break", 45);
            case 43:
              y.next = 13;
              break;
            case 45:
              if (this.isSelectHighlight && this.imp.highlightEntity(!1), !(c == dn.kEcsIn || c == dn.kNewCommadIn || c == dn.kUnknown)) {
                y.next = 50;
                break;
              }
              return y.abrupt("return", new Promise(function(w) {
                w(!1);
              }));
            case 50:
              return y.abrupt("return", new Promise(function(w) {
                w(!0);
              }));
            case 51:
            case "end":
              return y.stop();
          }
        }, a, this);
      }));
      function i(a) {
        return n.apply(this, arguments);
      }
      return i;
    }()
  }]), r;
}(Xo), ca = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", void 0), le(this, "mxobj", void 0), this.imp = t, this.mxobj = Ue.getCurrentDraw();
  }
  return Be(e, [{
    key: "doc2cad1",
    value: function(r) {
      return new te(r.x, r.y, r.z);
    }
  }, {
    key: "doc2cad2",
    value: function(r, n, i) {
      return new te(r, n, i);
    }
  }, {
    key: "cad2doc1",
    value: function(r) {
      return new THREE.Vector3(r.x, r.y, r.z);
    }
  }, {
    key: "cad2doc2",
    value: function(r, n, i) {
      return new THREE.Vector3(r, n, i);
    }
  }, {
    key: "keyWords",
    value: function() {
      return this.imp.keyWords();
    }
  }, {
    key: "setKeyWords",
    value: function(r) {
      this.imp.setKeyWords(r);
    }
  }, {
    key: "clearLastInputPoint",
    value: function() {
      this.imp.clearLastInputPoint();
    }
  }, {
    key: "setLastInputPoint",
    value: function(r) {
      this.imp.setLastInputPoint(this.cad2doc1(r));
    }
  }, {
    key: "message",
    value: function() {
      return this.imp.message();
    }
  }, {
    key: "setMessage",
    value: function(r) {
      this.imp.setMessage(r);
    }
  }, {
    key: "keyWordPicked",
    value: function() {
      return this.imp.keyWordPicked();
    }
  }, {
    key: "isKeyWordPicked",
    value: function(r) {
      return this.imp.isKeyWordPicked(r);
    }
  }, {
    key: "setUserDraw",
    value: function(r) {
      var n = this;
      this.imp.setUserDraw(function(i, a) {
        r(n.doc2cad1(i), a);
      });
    }
  }, {
    key: "getDetailedResult",
    value: function() {
      return this.imp.getDetailedResult();
    }
  }, {
    key: "getStatus",
    value: function() {
      return this.imp.getStatus();
    }
  }, {
    key: "drawReserve",
    value: function(r) {
      this.imp.drawReserve(r);
    }
  }, {
    key: "setInputToucheType",
    value: function(r) {
      this.imp.setInputToucheType(r);
    }
  }, {
    key: "getInputToucheType",
    value: function() {
      return this.imp.getInputToucheType();
    }
  }, {
    key: "setCursorType",
    value: function(r) {
      this.imp.setCursorType(r);
    }
  }, {
    key: "getCursorType",
    value: function() {
      return this.imp.getCursorType();
    }
  }, {
    key: "setDynamicInputType",
    value: function(r) {
      this.imp.setDynamicInputType(r);
    }
  }, {
    key: "getDynamicInputType",
    value: function() {
      return this.imp.getDynamicInputType();
    }
  }, {
    key: "isDisableDynInput",
    value: function() {
      return this.imp.isDisableDynInput();
    }
  }, {
    key: "setDisableDynInput",
    value: function(r) {
      this.imp.setDisableDynInput(r);
    }
  }, {
    key: "setDisableOsnap",
    value: function(r) {
      this.imp.setDisableOsnap(r);
    }
  }, {
    key: "isDisableOsnap",
    value: function() {
      return this.imp.isDisableOsnap();
    }
  }, {
    key: "isOffsetInputPostion",
    value: function() {
      return this.imp.isOffsetInputPostion();
    }
  }, {
    key: "setOffsetInputPostion",
    value: function(r) {
      return this.imp.setOffsetInputPostion(r);
    }
  }, {
    key: "setDisableDynamicTrace",
    value: function(r) {
      this.imp.setDisableDynamicTrace(r);
    }
  }, {
    key: "isDisableDynamicTrace",
    value: function() {
      return this.imp.isDisableDynamicTrace();
    }
  }, {
    key: "setDisablePolarAxisTrace",
    value: function(r) {
      this.imp.setDisablePolarAxisTrace(r);
    }
  }, {
    key: "isDisablePolarAxisTrace",
    value: function() {
      return this.imp.isDisablePolarAxisTrace();
    }
  }, {
    key: "setDisableGridTrace",
    value: function(r) {
      this.imp.setDisableGridTrace(r);
    }
  }, {
    key: "isDisableGridTrace",
    value: function() {
      return this.imp.isDisableGridTrace();
    }
  }, {
    key: "setDisableOrthoTrace",
    value: function(r) {
      this.imp.setDisableOrthoTrace(r);
    }
  }, {
    key: "isDisableOrthoTrace",
    value: function() {
      return this.imp.isDisableOrtho();
    }
  }, {
    key: "disableAllTrace",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
      this.imp.disableAllTrace(r);
    }
  }, {
    key: "userInputControls",
    value: function() {
      return this.imp.userInputControls();
    }
  }, {
    key: "setUserInputControls",
    value: function(r) {
      this.imp.setUserInputControls(r);
    }
  }, {
    key: "abort",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : dn.kCodeAbort;
      this.imp.abort(r);
    }
  }]), e;
}(), Zt = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    return Pe(this, r), t.call(this, new Wf());
  }
  return Be(r, [{
    key: "go",
    value: function() {
      var i = this;
      return new Promise(function(a) {
        i.imp.go(function(s) {
          s != 0 ? a(null) : a(i.doc2cad1(i.imp.value()));
        });
      });
    }
  }, {
    key: "value",
    value: function() {
      return this.doc2cad1(this.imp.value());
    }
  }, {
    key: "getDocValue",
    value: function() {
      return new te(this.imp.value());
    }
  }, {
    key: "basePt",
    value: function() {
      return this.doc2cad1(this.imp.basePt());
    }
  }, {
    key: "setBasePt",
    value: function(i) {
      this.imp.setBasePt(this.cad2doc1(i)), this.imp.setUseBasePt(!0);
    }
  }, {
    key: "setUseBasePt",
    value: function(i) {
      this.imp.setUseBasePt(i);
    }
  }]), r;
}(ca), cr = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    return Pe(this, r), t.call(this, new dw());
  }
  return Be(r, [{
    key: "value",
    value: function() {
      return this.imp.value();
    }
  }, {
    key: "basePt",
    value: function() {
      return this.doc2cad1(this.imp.basePt());
    }
  }, {
    key: "setBasePt",
    value: function(i) {
      this.imp.setBasePt(this.cad2doc1(i)), this.imp.setUseBasePt(!0);
    }
  }, {
    key: "setUseBasePt",
    value: function(i) {
      return this.imp.setUseBasePt(i);
    }
  }, {
    key: "go",
    value: function() {
      return this.imp.go();
    }
  }]), r;
}(ca), Qi = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    return Pe(this, r), t.call(this, new pw());
  }
  return Be(r, [{
    key: "value",
    value: function() {
      return this.imp.value();
    }
  }, {
    key: "basePt",
    value: function() {
      return this.doc2cad1(this.imp.basePt());
    }
  }, {
    key: "setBasePt",
    value: function(i) {
      this.imp.setBasePt(this.cad2doc1(i)), this.imp.setUseBasePt(!0);
    }
  }, {
    key: "setUseBasePt",
    value: function(i) {
      return this.imp.setUseBasePt(i);
    }
  }, {
    key: "go",
    value: function() {
      return this.imp.go();
    }
  }]), r;
}(ca), qf = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    return Pe(this, r), t.call(this, new vw());
  }
  return Be(r, [{
    key: "value",
    value: function() {
      return this.imp.value();
    }
  }, {
    key: "go",
    value: function() {
      return this.imp.go();
    }
  }]), r;
}(ca), ci = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    return Pe(this, r), t.call(this, new hw());
  }
  return Be(r, [{
    key: "go",
    value: function() {
      return this.imp.go();
    }
  }]), r;
}(ca), $f = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    var n;
    return Pe(this, r), n = t.call(this, new mw()), n.setDynamicInputType(pn.kNoInput), n.disableAllTrace(), n;
  }
  return Be(r, [{
    key: "value",
    value: function() {
      return this.imp.value();
    }
  }, {
    key: "go",
    value: function() {
      return this.imp.go();
    }
  }]), r;
}(ca), ki = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = la(r);
  function r() {
    var n;
    return Pe(this, r), n = t.call(this, new Wf()), le(dt(n), "filter", void 0), le(dt(n), "id", new Fe()), n.setCursorType(Vf.kRect), n.setDynamicInputType(pn.kDynTip), n.disableAllTrace(), n;
  }
  return Be(r, [{
    key: "setFilter",
    value: function(i) {
      this.filter = i;
    }
  }, {
    key: "getFilter",
    value: function() {
      return this.filter;
    }
  }, {
    key: "go",
    value: function() {
      var i = this;
      return new Promise(function(a) {
        var s = i;
        i.imp.go(function(o) {
          if (s.clearLastInputPoint(), o != 0)
            a(new Fe());
          else {
            var u = s.imp.value(), l = s.doc2cad1(u);
            s.id = Bt.findEntAtPoint(l.x, l.y, l.z, -1, s.filter), a(s.id);
          }
        });
      });
    }
  }, {
    key: "pickPoint",
    value: function() {
      return this.doc2cad1(this.imp.value());
    }
  }, {
    key: "value",
    value: function() {
      return this.id;
    }
  }, {
    key: "getDocPickPoint",
    value: function() {
      return new te(this.imp.value());
    }
  }]), r;
}(ca);
function Mr(e) {
  var t = Xy();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function Xy() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (Xy = function() {
    return !!e;
  })();
}
var xr = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "explode",
    value: function() {
      var i = this.imp.explode();
      return new vr(i);
    }
  }, {
    key: "trueColor",
    get: function() {
      return new fr(this.imp.TrueColor());
    },
    set: function(i) {
      this.imp.SetTrueColor(i.getImp());
    }
  }, {
    key: "colorIndex",
    get: function() {
      return this.imp.ColorIndex();
    },
    set: function(i) {
      this.imp.SetColorIndex(i);
    }
  }, {
    key: "layer",
    get: function() {
      return xe.decodeFromGb2312(this.imp.Layer());
    },
    set: function(i) {
      this.imp.SetLayer(xe.encodeToGb2312(i));
    }
  }, {
    key: "linetype",
    get: function() {
      return xe.decodeFromGb2312(this.imp.Linetype());
    },
    set: function(i) {
      this.imp.SetLinetype(xe.encodeToGb2312(i));
    }
  }, {
    key: "linetypeScale",
    get: function() {
      return this.imp.LinetypeScale();
    },
    set: function(i) {
      this.imp.SetLinetypeScale(i);
    }
  }, {
    key: "visible",
    get: function() {
      return this.imp.Visible();
    },
    set: function(i) {
      this.imp.SetVisible(i);
    }
  }, {
    key: "lineweight",
    get: function() {
      return this.imp.Lineweight();
    },
    set: function(i) {
      this.imp.SetLineweight(i);
    }
  }, {
    key: "textStyle",
    get: function() {
      return xe.decodeFromGb2312(this.imp.TextStyle());
    },
    set: function(i) {
      this.imp.SetTextStyle(xe.encodeToGb2312(i));
    }
  }, {
    key: "highlight",
    value: function(i) {
      this.imp.Highlight(i);
    }
  }, {
    key: "move",
    value: function(i, a) {
      this.tempRelationObject();
      var s = this.imp.Move(i.imp, a.imp);
      return this.freeTempRelationObject(), s;
    }
  }, {
    key: "rotate",
    value: function(i, a) {
      this.tempRelationObject();
      var s = this.imp.Rotate(i.imp, a);
      return this.freeTempRelationObject(), s;
    }
  }, {
    key: "mirror",
    value: function(i, a) {
      this.tempRelationObject();
      var s = this.imp.Mirror(i.imp, a.imp);
      return this.freeTempRelationObject(), s;
    }
  }, {
    key: "scaleEntity",
    value: function(i, a) {
      this.tempRelationObject();
      var s = this.imp.ScaleEntity(i.imp, a);
      return this.freeTempRelationObject(), s;
    }
  }, {
    key: "transformBy",
    value: function(i) {
      return this.imp.TransformBy(i.imp);
    }
  }, {
    key: "getBoundingBox",
    value: function() {
      var i = this.imp.GetBoundingBox();
      if (i) {
        if (i.GetCount() < 2)
          return ie.App.destroyObject(i), {
            minPt: new te(),
            maxPt: new te(),
            ret: !1
          };
        var a = {
          minPt: new te(i.AtPoint(0)),
          maxPt: new te(i.AtPoint(1)),
          ret: !0
        };
        return ie.App.destroyObject(i), a;
      } else
        return {
          minPt: new te(),
          maxPt: new te(),
          ret: !1
        };
    }
  }, {
    key: "getxData",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "";
      return new vr(this.imp.GetXData(xe.encodeToGb2312(i)));
    }
  }, {
    key: "setxData",
    value: function(i) {
      return this.imp.SetXData(i.getImp());
    }
  }, {
    key: "getxDataString",
    value: function(i) {
      var a = this.imp.GetxDataString(xe.encodeToGb2312(i), 0);
      return {
        val: xe.decodeFromGb2312(a),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "setxDataString",
    value: function(i, a) {
      return this.imp.SetxDataString(xe.encodeToGb2312(i), 0, xe.encodeToGb2312(a));
    }
  }, {
    key: "getxDataDouble",
    value: function(i) {
      return {
        val: this.imp.GetxDataDouble(xe.encodeToGb2312(i), 0),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "setxDataDouble",
    value: function(i, a) {
      return this.imp.SetxDataDouble(xe.encodeToGb2312(i), 0, a);
    }
  }, {
    key: "getxDataLong",
    value: function(i) {
      return {
        val: this.imp.GetxDataLong(xe.encodeToGb2312(i), 0),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "setxDataLong",
    value: function(i, a) {
      return this.imp.SetxDataLong(xe.encodeToGb2312(i), 0, a);
    }
  }, {
    key: "getxDataPoint",
    value: function(i) {
      var a = this.imp.GetxDataPoint(xe.encodeToGb2312(i), 0), s = new te();
      if (ie.getCallResult() == 0) {
        var o = !1;
        return a && (s.x = a.x, s.y = a.y, s.z = a.z, ie.App.getImp().DestroyMdGePoint3d(a), o = !0), {
          val: s,
          ret: o
        };
      } else
        return {
          val: s,
          ret: !1
        };
    }
  }, {
    key: "setxDataPoint",
    value: function(i, a) {
      return this.imp.SetxDataPoint(xe.encodeToGb2312(i), 0, a.imp);
    }
  }, {
    key: "deleteXData",
    value: function(i) {
      return this.imp.DeleteXData(xe.encodeToGb2312(i));
    }
  }, {
    key: "getAllAppName",
    value: function() {
      return new Ha(this.imp.GetAllAppName());
    }
  }, {
    key: "layerId",
    get: function() {
      return new Fe(this.imp.LayerId(), rt.kMxCAD);
    },
    set: function(i) {
      i.type == rt.kMxCAD && this.imp.SetLayerId(i.id);
    }
  }, {
    key: "linetypeId",
    get: function() {
      return new Fe(this.imp.LinetypeId(), rt.kMxCAD);
    },
    set: function(i) {
      i.type == rt.kMxCAD && this.imp.SetLinetypeId(i.id);
    }
  }, {
    key: "textStyleId",
    get: function() {
      return new Fe(this.imp.TextStyleId(), rt.kMxCAD);
    },
    set: function(i) {
      i.type == rt.kMxCAD && this.imp.SetTextStyleId(i.id);
    }
  }, {
    key: "IntersectWith",
    value: function(i, a) {
      return new Xr(this.imp.IntersectWith(i.imp, a));
    }
  }, {
    key: "getArea",
    value: function() {
      var i = this.imp.getArea();
      return {
        val: i,
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "disableDisplay",
    value: function(i) {
      this.imp.disableUpdateDisplay(i);
    }
  }, {
    key: "updateDisplay",
    value: function() {
      this.imp.updateDisplay();
    }
  }, {
    key: "syncData",
    value: function() {
      return !1;
    }
  }, {
    key: "drawOrder",
    get: function() {
      return this.imp.DrawOrder();
    },
    set: function(i) {
      this.imp.SetDrawOrder(i);
    }
  }, {
    key: "normal",
    get: function() {
      return new Ve(this.imp.normal());
    },
    set: function(i) {
      this.imp.setNormal(i.imp);
    }
  }]), r;
}(Nr), Zr = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "getStartParam",
    value: function() {
      var i = this.imp.getStartParam();
      return {
        val: i,
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getEndParam",
    value: function() {
      return {
        val: this.imp.getEndParam(),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getDistAtParam",
    value: function(i) {
      return {
        val: this.imp.getDistAtParam(i),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getParamAtDist",
    value: function(i) {
      return {
        val: this.imp.getParamAtDist(i),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getDistAtPoint",
    value: function(i) {
      return {
        val: this.imp.getDistAtPoint(i.imp),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getPointAtDist",
    value: function(i) {
      return {
        val: new te(this.imp.getPointAtDist(i)),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getStartPoint",
    value: function() {
      return {
        val: new te(this.imp.getStartPoint()),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getEndPoint",
    value: function() {
      return {
        val: new te(this.imp.getEndPoint()),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getPointAtParam",
    value: function(i) {
      return {
        val: new te(this.imp.getPointAtParam(i)),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getParamAtPoint",
    value: function(i) {
      return {
        val: this.imp.getParamAtPoint(i.imp),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getFirstDerivFromParam",
    value: function(i) {
      return {
        val: new Ve(this.imp.getFirstDeriv(i)),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getFirstDeriv",
    value: function(i) {
      return {
        val: new Ve(this.imp.getFirstDerivEx(i.imp)),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "getClosestPointTo",
    value: function(i, a) {
      return {
        val: new te(this.imp.getClosestPointTo(i.imp, a)),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "offsetCurves",
    value: function(i, a) {
      var s = this.imp.offsetCurves(i, a.imp);
      return new gu(s);
    }
  }, {
    key: "splitCurves",
    value: function(i) {
      var a = new vr();
      i.forEach(function(o) {
        a.AddPoint(o);
      });
      var s = this.imp.splitCurves(a.getImp());
      return new gu(s);
    }
  }, {
    key: "splitCurvesFromParam",
    value: function(i) {
      var a = new vr();
      i.forEach(function(o) {
        a.AddDouble(o);
      });
      var s = this.imp.splitCurves(a.getImp());
      return new gu(s);
    }
  }, {
    key: "getSamplePoints",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 1e-4, a = this.imp.getSamplePoints(i);
      return new vr(a);
    }
  }, {
    key: "getLength",
    value: function() {
      var i = this.imp.getLength();
      return {
        val: i,
        ret: ie.getCallResult() == 0
      };
    }
  }]), r;
}(xr), st = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n, i, a, s, o, u) {
    var l;
    return Pe(this, r), n instanceof Object ? n instanceof te ? (l = t.call(this), l.initTempObject(new ie.mxcadassemblyimp.MdDbLine()), i instanceof te && (l.startPoint = n, l.endPoint = i)) : l = t.call(this, n) : (l = t.call(this), l.initTempObject(new ie.mxcadassemblyimp.MdDbLine()), l.startPoint = new te(n, i, a), l.endPoint = new te(s, o, u)), kr(l);
  }
  return Be(r, [{
    key: "startPoint",
    get: function() {
      return new te(this.imp.startPoint());
    },
    set: function(i) {
      this.imp.setStartPoint(i.imp);
    }
  }, {
    key: "endPoint",
    get: function() {
      return new te(this.imp.endPoint());
    },
    set: function(i) {
      this.imp.setEndPoint(i.imp);
    }
  }]), r;
}(Zr), ps = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbText()), i;
  }
  return Be(r, [{
    key: "position",
    get: function() {
      return new te(this.imp.position());
    },
    set: function(i) {
      this.imp.setPosition(i.imp);
    }
  }, {
    key: "alignmentPoint",
    get: function() {
      return new te(this.imp.position());
    },
    set: function(i) {
      this.imp.setAlignmentPoint(i.imp);
    }
  }, {
    key: "oblique",
    get: function() {
      return this.imp.oblique();
    },
    set: function(i) {
      this.imp.setOblique(i);
    }
  }, {
    key: "rotation",
    get: function() {
      return this.imp.rotation();
    },
    set: function(i) {
      this.imp.setRotation(i);
    }
  }, {
    key: "height",
    get: function() {
      return this.imp.height();
    },
    set: function(i) {
      this.imp.setHeight(i);
    }
  }, {
    key: "widthFactor",
    get: function() {
      return this.imp.widthFactor();
    },
    set: function(i) {
      this.imp.setWidthFactor(i);
    }
  }, {
    key: "textString",
    get: function() {
      return xe.decodeFromGb2312(this.imp.textString());
    },
    set: function(i) {
      this.imp.setTextString(xe.encodeToGb2312(i));
    }
  }, {
    key: "horizontalMode",
    get: function() {
      return this.imp.horizontalMode();
    },
    set: function(i) {
      this.imp.setHorizontalMode(i);
    }
  }, {
    key: "verticalMode",
    get: function() {
      return this.imp.verticalMode();
    },
    set: function(i) {
      this.imp.setVerticalMode(i);
    }
  }, {
    key: "adjustAlignment",
    value: function() {
      this.imp.adjustAlignment();
    }
  }]), r;
}(xr), Tc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbAttribute()), i;
  }
  return Be(r, [{
    key: "tag",
    get: function() {
      return xe.decodeFromGb2312(this.imp.tag());
    },
    set: function(i) {
      this.imp.setTag(xe.encodeToGb2312(i));
    }
  }, {
    key: "isInvisible",
    get: function() {
      return this.imp.isInvisible();
    },
    set: function(i) {
      this.imp.setInvisible(i);
    }
  }]), r;
}(ps), Sc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbAttributeDefinition()), i;
  }
  return Be(r, [{
    key: "tag",
    get: function() {
      return xe.decodeFromGb2312(this.imp.tag());
    },
    set: function(i) {
      this.imp.setTag(xe.encodeToGb2312(i));
    }
  }, {
    key: "isInvisible",
    get: function() {
      return this.imp.isInvisible();
    },
    set: function(i) {
      this.imp.setInvisible(i);
    }
  }, {
    key: "prompt",
    get: function() {
      return xe.decodeFromGb2312(this.imp.prompt());
    },
    set: function(i) {
      this.imp.setPrompt(xe.encodeToGb2312(i));
    }
  }, {
    key: "isConstant",
    get: function() {
      return this.imp.isConstant();
    },
    set: function(i) {
      this.imp.setConstant(i);
    }
  }, {
    key: "isVerifiable",
    get: function() {
      return this.imp.isVerifiable();
    },
    set: function(i) {
      this.imp.setVerifiable(i);
    }
  }, {
    key: "isPreset",
    get: function() {
      return this.imp.isPreset();
    },
    set: function(i) {
      this.imp.setPreset(i);
    }
  }]), r;
}(ps), Ia = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbMText()), i;
  }
  return Be(r, [{
    key: "location",
    get: function() {
      return new te(this.imp.location());
    },
    set: function(i) {
      this.imp.setLocation(i.imp);
    }
  }, {
    key: "rotation",
    get: function() {
      return this.imp.rotation();
    },
    set: function(i) {
      this.imp.setRotation(i);
    }
  }, {
    key: "width",
    get: function() {
      return this.imp.width();
    },
    set: function(i) {
      this.imp.setWidth(i);
    }
  }, {
    key: "textHeight",
    get: function() {
      return this.imp.textHeight();
    },
    set: function(i) {
      this.imp.setTextHeight(i);
    }
  }, {
    key: "attachment",
    get: function() {
      return this.imp.attachment();
    },
    set: function(i) {
      this.imp.setAttachment(i);
    }
  }, {
    key: "contents",
    get: function() {
      return xe.decodeFromGb2312(this.imp.contents());
    },
    set: function(i) {
      this.imp.setContents(xe.encodeToGb2312(i));
    }
  }, {
    key: "getTextString",
    value: function() {
      return xe.decodeFromGb2312(this.imp.getTextString());
    }
  }, {
    key: "reCompute",
    value: function() {
      return this.imp.reCompute();
    }
  }]), r;
}(xr), zr = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n, i, a, s) {
    var o;
    return Pe(this, r), n instanceof Object ? o = t.call(this, n) : (o = t.call(this), o.initTempObject(new ie.mxcadassemblyimp.MdDbCircle()), typeof n == "number" && (o.imp.setCenter(new te(n, i, a).imp), o.imp.setRadius(s))), kr(o);
  }
  return Be(r, [{
    key: "setCenter",
    value: function(i, a, s) {
      this.imp.setCenter(new te(i, a, s).imp);
    }
  }, {
    key: "center",
    get: function() {
      return new te(this.imp.center());
    },
    set: function(i) {
      this.imp.setCenter(i.imp);
    }
  }, {
    key: "radius",
    get: function() {
      return this.imp.radius();
    },
    set: function(i) {
      this.imp.setRadius(i);
    }
  }]), r;
}(Zr), ot = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbPolyline()), i;
  }
  return Be(r, [{
    key: "isClosed",
    get: function() {
      return this.imp.isClosed();
    },
    set: function(i) {
      this.imp.setClosed(i);
    }
  }, {
    key: "constantWidth",
    get: function() {
      return this.imp.getConstantWidth();
    },
    set: function(i) {
      this.imp.setConstantWidth(i);
    }
  }, {
    key: "addVertexAt",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0, s = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0, o = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 0, u = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : 0;
      if (i instanceof THREE.Vector3) {
        var l = new ie.mxcadassemblyimp.MdGePoint3d();
        return l.x = i.x, l.y = i.y, l.z = i.z, this.imp.addVertexAt(u, l, a, s, o);
      } else
        return this.imp.addVertexAt(u, i.imp, a, s, o);
    }
  }, {
    key: "removeVertexAt",
    value: function(i) {
      return this.imp.removeVertexAt(i);
    }
  }, {
    key: "numVerts",
    value: function() {
      return this.imp.numVerts();
    }
  }, {
    key: "getPointAt",
    value: function(i) {
      return {
        val: new te(this.imp.getPointAt(i)),
        ret: ie.getCallResult()
      };
    }
  }, {
    key: "getBulgeAt",
    value: function(i) {
      return this.imp.getBulgeAt(i);
    }
  }, {
    key: "getWidthsAt",
    value: function(i) {
      return {
        val1: this.imp.getStartWidthsAt(i),
        val2: this.imp.getEndWidthsAt(i),
        ret: ie.getCallResult() == 0
      };
    }
  }, {
    key: "setPointAt",
    value: function(i, a) {
      return this.imp.setPointAt(i, a.imp);
    }
  }, {
    key: "setBulgeAt",
    value: function(i, a) {
      return this.imp.setBulgeAt(i, a);
    }
  }, {
    key: "pointInPolygon",
    value: function(i, a) {
      return this.imp.pointInPolygon(i, a);
    }
  }, {
    key: "setWidthsAt",
    value: function(i, a, s) {
      return this.imp.setWidthsAt(i, a, s);
    }
  }, {
    key: "getType",
    value: function() {
      return this.imp.getType();
    }
  }, {
    key: "setType",
    value: function(i) {
      return this.imp.setType(i);
    }
  }]), r;
}(Zr), wo = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbBlockReference()), i;
  }
  return Be(r, [{
    key: "blockTableRecordId",
    get: function() {
      return new Fe(this.imp.blockTableRecordId(), rt.kMxCAD);
    },
    set: function(i) {
      this.imp.setBlockTableRecordId(i.id);
    }
  }, {
    key: "position",
    get: function() {
      return new te(this.imp.position());
    },
    set: function(i) {
      this.imp.setPosition(i.imp);
    }
  }, {
    key: "scaleFactors",
    get: function() {
      return new te(this.imp.scaleFactors());
    },
    set: function(i) {
      this.imp.setScaleFactors(i.imp);
    }
  }, {
    key: "setScale",
    value: function(i) {
      this.imp.setScaleFactors(new te(i, i, i).imp);
    }
  }, {
    key: "getScale",
    value: function() {
      return this.imp.scaleFactors().x;
    }
  }, {
    key: "rotation",
    get: function() {
      return this.imp.rotation();
    },
    set: function(i) {
      this.imp.setRotation(i);
    }
  }, {
    key: "blockTransform",
    get: function() {
      return new Jr(this.imp.blockTransform());
    },
    set: function(i) {
      this.imp.setBlockTransform(i.imp);
    }
  }, {
    key: "blockName",
    get: function() {
      return xe.decodeFromGb2312(this.imp.getBlockName());
    }
  }, {
    key: "appendAttribute",
    value: function(i) {
      return new Fe(this.imp.appendAttribute(i.getImp()), rt.kMxCAD);
    }
  }, {
    key: "getAllAttribute",
    value: function() {
      for (var i = [], a = this.imp.getAllAttribute(), s = a.length(), o = 0; o < s; o++)
        i.push(new Fe(a.at(o), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(a), i;
    }
  }, {
    key: "createAttribute",
    value: function() {
      return this.imp.createAttribute();
    }
  }, {
    key: "getSpatialFilterId",
    value: function() {
      return new Fe(this.imp.getSpatialFilterId(), rt.kMxCAD);
    }
  }, {
    key: "createSpatialFilter",
    value: function() {
      return this.imp.createSpatialFilter();
    }
  }, {
    key: "clearSpatialFilterCache",
    value: function() {
      return this.imp.clearSpatialFilterCache();
    }
  }, {
    key: "copyAttribute",
    value: function(i) {
      return this.imp.copyAttribute(i.imp);
    }
  }, {
    key: "eraseAllAttribute",
    value: function() {
      this.imp.eraseAllAttribute();
    }
  }]), r;
}(xr), kc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbSpatialFilter()), i;
  }
  return Be(r, [{
    key: "boundary",
    value: function() {
      return new Xr(this.imp.boundary());
    }
  }, {
    key: "setBoundary",
    value: function(i) {
      return this.imp.setBoundary(i.imp);
    }
  }, {
    key: "isFilterInverted",
    value: function() {
      return this.imp.isFilterInverted();
    }
  }, {
    key: "setFilterInverted",
    value: function(i) {
      return this.imp.setFilterInverted(i);
    }
  }, {
    key: "isEnabled",
    value: function() {
      return this.imp.isEnabled();
    }
  }, {
    key: "setEnable",
    value: function(i) {
      return this.imp.setEnable(i);
    }
  }]), r;
}(Nr), ta = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "textPosition",
    get: function() {
      return new te(this.imp.textPosition());
    },
    set: function(i) {
      this.imp.setTextPosition(i.imp);
    }
  }, {
    key: "isUsingDefaultTextPosition",
    value: function() {
      return this.imp.isUsingDefaultTextPosition();
    }
  }, {
    key: "useSetTextPosition",
    value: function() {
      return this.imp.useSetTextPosition();
    }
  }, {
    key: "useDefaultTextPosition",
    value: function() {
      return this.imp.useDefaultTextPosition();
    }
  }, {
    key: "elevation",
    get: function() {
      return this.imp.elevation();
    },
    set: function(i) {
      this.imp.setElevation(i);
    }
  }, {
    key: "dimensionText",
    get: function() {
      return xe.decodeFromGb2312(this.imp.dimensionText());
    },
    set: function(i) {
      this.imp.setDimensionText(xe.encodeToGb2312(i));
    }
  }, {
    key: "textRotation",
    get: function() {
      return this.imp.textRotation();
    },
    set: function(i) {
      this.imp.setTextRotation(i);
    }
  }, {
    key: "dimensionStyle",
    get: function() {
      return new Fe(this.imp.dimensionStyle(), rt.kMxCAD);
    },
    set: function(i) {
      this.imp.setDimensionStyle(i.id);
    }
  }, {
    key: "textAttachment",
    get: function() {
      return this.imp.textAttachment();
    },
    set: function(i) {
      this.imp.setTextAttachment(i);
    }
  }, {
    key: "needToUpdateDimBlock",
    value: function(i) {
      this.imp.SetUpDimBlock(i);
    }
  }, {
    key: "horizontalRotation",
    get: function() {
      return this.imp.horizontalRotation();
    },
    set: function(i) {
      this.imp.setHorizontalRotation(i);
    }
  }, {
    key: "recomputeDimBlock",
    value: function() {
      this.imp.recomputeDimBlock(!0);
    }
  }, {
    key: "getDimVarInt",
    value: function(i) {
      return this.imp.GetDimVarInt(i);
    }
  }, {
    key: "setDimVarInt",
    value: function(i, a) {
      this.imp.SetDimVarInt(i, a);
    }
  }, {
    key: "getDimVarDouble",
    value: function(i) {
      return this.imp.GetDimVarDouble(i);
    }
  }, {
    key: "setDimVarDouble",
    value: function(i, a) {
      this.imp.SetDimVarDouble(i, a);
    }
  }, {
    key: "getDimVarString",
    value: function(i) {
      return this.imp.GetDimVarString(i);
    }
  }, {
    key: "setDimVarString",
    value: function(i, a) {
      this.imp.SetDimVarString(i, a);
    }
  }, {
    key: "getDimVarObjectId",
    value: function(i) {
      return new Fe(this.imp.GetDimVarObjectId(i), rt.kMxCAD);
    }
  }, {
    key: "setDimVarObjectId",
    value: function(i, a) {
      this.imp.SetDimVarObjectId(i, a.id);
    }
  }, {
    key: "GetAllText",
    value: function() {
      return new Ha(this.imp.GetAllText());
    }
  }]), r;
}(xr), Cc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbAlignedDimension()), i;
  }
  return Be(r, [{
    key: "xLine1Point",
    get: function() {
      return new te(this.imp.xLine1Point());
    },
    set: function(i) {
      this.imp.setXLine1Point(i.imp);
    }
  }, {
    key: "xLine2Point",
    get: function() {
      return new te(this.imp.xLine2Point());
    },
    set: function(i) {
      this.imp.setXLine2Point(i.imp);
    }
  }, {
    key: "dimLinePoint",
    get: function() {
      return new te(this.imp.dimLinePoint());
    },
    set: function(i) {
      this.imp.setDimLinePoint(i.imp);
    }
  }, {
    key: "oblique",
    get: function() {
      return this.imp.oblique();
    },
    set: function(i) {
      this.imp.setOblique(i);
    }
  }]), r;
}(ta), Dc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbRotatedDimension()), i;
  }
  return Be(r, [{
    key: "xLine1Point",
    get: function() {
      return new te(this.imp.xLine1Point());
    },
    set: function(i) {
      this.imp.setXLine1Point(i.imp);
    }
  }, {
    key: "xLine2Point",
    get: function() {
      return new te(this.imp.xLine2Point());
    },
    set: function(i) {
      this.imp.setXLine2Point(i.imp);
    }
  }, {
    key: "dimLinePoint",
    get: function() {
      return new te(this.imp.dimLinePoint());
    },
    set: function(i) {
      this.imp.setDimLinePoint(i.imp);
    }
  }, {
    key: "oblique",
    get: function() {
      return this.imp.oblique();
    },
    set: function(i) {
      this.imp.setOblique(i);
    }
  }, {
    key: "rotation",
    get: function() {
      return this.imp.rotation();
    },
    set: function(i) {
      this.imp.setRotation(i);
    }
  }]), r;
}(ta), _c = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDb2LineAngularDimension()), i;
  }
  return Be(r, [{
    key: "arcPoint",
    get: function() {
      return new te(this.imp.arcPoint());
    },
    set: function(i) {
      this.imp.setArcPoint(i.imp);
    }
  }, {
    key: "xLine1Start",
    get: function() {
      return new te(this.imp.xLine1Start());
    },
    set: function(i) {
      this.imp.setXLine1Start(i.imp);
    }
  }, {
    key: "xLine1End",
    get: function() {
      return new te(this.imp.xLine1End());
    },
    set: function(i) {
      this.imp.setXLine1End(i.imp);
    }
  }, {
    key: "xLine2Start",
    get: function() {
      return new te(this.imp.xLine2Start());
    },
    set: function(i) {
      this.imp.setXLine2Start(i.imp);
    }
  }, {
    key: "xLine2End",
    get: function() {
      return new te(this.imp.xLine2End());
    },
    set: function(i) {
      this.imp.setXLine2End(i.imp);
    }
  }, {
    key: "compute",
    value: function(i, a, s, o, u, l, c, f) {
      return this.imp.compute(i, a, s, o, u, l, c, f);
    }
  }]), r;
}(ta), Di = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbArc()), i;
  }
  return Be(r, [{
    key: "setCenter",
    value: function(i, a, s) {
      this.imp.setCenter(new te(i, a, s).imp);
    }
  }, {
    key: "center",
    get: function() {
      return new te(this.imp.center());
    },
    set: function(i) {
      this.imp.setCenter(i.imp);
    }
  }, {
    key: "radius",
    get: function() {
      return this.imp.radius();
    },
    set: function(i) {
      this.imp.setRadius(i);
    }
  }, {
    key: "startAngle",
    get: function() {
      return this.imp.startAngle();
    },
    set: function(i) {
      this.imp.setStartAngle(i);
    }
  }, {
    key: "endAngle",
    get: function() {
      return this.imp.endAngle();
    },
    set: function(i) {
      this.imp.setEndAngle(i);
    }
  }, {
    key: "computeArc",
    value: function(i, a, s, o, u, l) {
      return this.imp.computeArc(i, a, s, o, u, l);
    }
  }]), r;
}(Zr), xo = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n, i, a, s, o, u, l, c, f) {
    var h;
    return Pe(this, r), n instanceof Object ? h = t.call(this, n) : (h = t.call(this), h.initTempObject(new ie.mxcadassemblyimp.MdDbEllipse()), typeof n == "number" && (l || (l = 1), typeof c != "number" && (c = 0), typeof f != "number" && (f = Math.PI * 2), h.imp.InitData(new te(n, i, a).imp, new Ve(s, o, u).imp, l, c, f))), kr(h);
  }
  return Be(r, [{
    key: "setCenter",
    value: function(i, a, s) {
      this.imp.setCenter(new te(i, a, s).imp);
    }
  }, {
    key: "center",
    get: function() {
      return new te(this.imp.center());
    },
    set: function(i) {
      this.imp.setCenter(i.imp);
    }
  }, {
    key: "setMajorAxis",
    value: function(i, a, s) {
      this.imp.setMajorAxis(new Ve(i, a, s).imp);
    }
  }, {
    key: "majorAxis",
    get: function() {
      return new Ve(this.imp.majorAxis());
    },
    set: function(i) {
      this.imp.setMajorAxis(i.imp);
    }
  }, {
    key: "setMinorAxis",
    value: function(i, a, s) {
      this.imp.setMinorAxis(new Ve(i, a, s).imp);
    }
  }, {
    key: "minorAxis",
    get: function() {
      return new Ve(this.imp.minorAxis());
    },
    set: function(i) {
      this.imp.setMinorAxis(i.imp);
    }
  }, {
    key: "radiusRatio",
    get: function() {
      return this.imp.radiusRatio();
    },
    set: function(i) {
      this.imp.setRadiusRatio(i);
    }
  }, {
    key: "startAngle",
    get: function() {
      return this.imp.startAngle();
    },
    set: function(i) {
      this.imp.setStartAngle(i);
    }
  }, {
    key: "endAngle",
    get: function() {
      return this.imp.endAngle();
    },
    set: function(i) {
      this.imp.setEndAngle(i);
    }
  }]), r;
}(Zr), Tu = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n, i, a) {
    var s;
    return Pe(this, r), n instanceof Object ? n instanceof te ? (s = t.call(this), s.initTempObject(new ie.mxcadassemblyimp.MdDbPoint()), s.imp.setPosition(n.imp)) : s = t.call(this, n) : (s = t.call(this), s.initTempObject(new ie.mxcadassemblyimp.MdDbPoint()), typeof n == "number" && s.imp.setPosition(new te(n, i, a).imp)), kr(s);
  }
  return Be(r, [{
    key: "setPosition",
    value: function(i, a, s) {
      this.imp.setPosition(new te(i, a, s).imp);
    }
  }, {
    key: "position",
    get: function() {
      return new te(this.imp.position());
    },
    set: function(i) {
      this.imp.setPosition(i.imp);
    }
  }]), r;
}(xr), Mo = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), n instanceof Object ? i = t.call(this, n) : (i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.MdDbHatch())), kr(i);
  }
  return Be(r, [{
    key: "numLoops",
    get: function() {
      return this.imp.numLoops();
    }
  }, {
    key: "loopTypeAt",
    value: function(i) {
      return this.imp.loopTypeAt(i);
    }
  }, {
    key: "getLoopAt",
    value: function(i) {
      var a = this.imp.getLoopAt(i);
      if (!a) return {
        ret: !1,
        lootype: 0,
        vertices: [],
        bulges: []
      };
      var s = a.GetCount();
      if (s <= 0)
        return ie.App.destroyObject(a), {
          ret: !1,
          lootype: 0,
          vertices: [],
          bulges: []
        };
      var o = 0;
      o = a.Atlong(0);
      for (var u = [], l = [], c = 1; c + 1 < s; c += 2)
        u.push(new te(a.AtPoint(c))), l.push(a.AtDouble(c + 1));
      return ie.App.destroyObject(a), {
        ret: !0,
        lootype: o,
        vertices: u,
        bulges: l
      };
    }
  }, {
    key: "patternType",
    value: function() {
      return this.imp.patternType();
    }
  }, {
    key: "patternName",
    value: function() {
      return xe.decodeFromGb2312(this.imp.patternName());
    }
  }, {
    key: "setPattern",
    value: function(i, a) {
      this.imp.setPattern(i, xe.encodeToGb2312(a));
    }
  }, {
    key: "patternAngle",
    get: function() {
      return this.imp.patternAngle();
    },
    set: function(i) {
      this.imp.setPatternAngle(i);
    }
  }, {
    key: "patternScale",
    get: function() {
      return this.imp.patternScale();
    },
    set: function(i) {
      this.imp.setPatternScale(i);
    }
  }, {
    key: "patternSpace",
    get: function() {
      return this.imp.patternSpace();
    },
    set: function(i) {
      this.imp.setPatternSpace(i);
    }
  }, {
    key: "patternDouble",
    get: function() {
      return this.imp.patternDouble();
    },
    set: function(i) {
      this.imp.setPatternDouble(i);
    }
  }, {
    key: "numPatternDefinitions",
    get: function() {
      return this.imp.numPatternDefinitions();
    }
  }, {
    key: "getPatternDefinitionAt",
    value: function(i) {
      var a = this.imp.getPatternDefinitionAt(i);
      if (!a) return {
        ret: !1,
        angle: 0,
        baseX: 0,
        baseY: 0,
        offsetX: 0,
        offsetY: 0,
        aryDashes: []
      };
      var s = a.length();
      if (s < 5)
        return ie.App.getImp().DestroyMdGeDoubleArray(a), {
          ret: !1,
          angle: 0,
          baseX: 0,
          baseY: 0,
          offsetX: 0,
          offsetY: 0,
          aryDashes: []
        };
      for (var o = a.at(0), u = a.at(1), l = a.at(2), c = a.at(3), f = a.at(4), h = [], d = 5; d < s; d++)
        h.push(a.at(d));
      return ie.App.getImp().DestroyMdGeDoubleArray(a), {
        ret: !1,
        angle: o,
        baseX: u,
        baseY: l,
        offsetX: c,
        offsetY: f,
        aryDashes: h
      };
    }
  }, {
    key: "addPatternDefinition",
    value: function(i, a, s, o, u, l) {
      var c = new hs();
      return l.forEach(function(f) {
        c.append(f);
      }), this.imp.addPatternDefinition(i, a, s, o, u, c.imp);
    }
  }, {
    key: "clearPatternDefinition",
    value: function() {
      return this.imp.clearPatternDefinition();
    }
  }, {
    key: "hatchStyle",
    value: function() {
      return this.imp.hatchStyle();
    }
  }, {
    key: "setHatchStyle",
    value: function(i) {
      return this.imp.setHatchStyle(i);
    }
  }, {
    key: "appendLoop",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : [], s = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : Ie.HatchLoopType.kPolyline, o = new hs();
      return a.forEach(function(u) {
        o.append(u);
      }), this.imp.appendLoop(s, i.imp, o.imp);
    }
  }, {
    key: "appendCircleLoop",
    value: function(i, a, s) {
      var o = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 0, u = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : Ie.HatchLoopType.kPolyline;
      return this.imp.appendCircleLoop(u, i, a, 0, s, o);
    }
  }, {
    key: "removeLoopAt",
    value: function(i) {
      return this.imp.removeLoopAt(i);
    }
  }, {
    key: "removeAllLoop",
    value: function() {
      return this.imp.removeAllLoop();
    }
  }, {
    key: "setLoopAt",
    value: function(i, a, s) {
      var o = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : Ie.HatchLoopType.kPolyline, u = new hs();
      return s.forEach(function(l) {
        u.append(l);
      }), this.imp.setLoopAt(i, o, a.imp, u.imp);
    }
  }, {
    key: "isSolid",
    value: function() {
      return this.imp.isSolid();
    }
  }, {
    key: "scalePattern",
    value: function(i) {
      return this.imp.scalePattern(i);
    }
  }]), r;
}(xr), Pc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), n instanceof Object ? i = t.call(this, n) : (i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.MdDbProxyEntity())), kr(i);
  }
  return Be(r, [{
    key: "getAllTextContent",
    value: function() {
      return new Ha(this.imp.getAllTextContent());
    }
  }, {
    key: "getAllEntityIds",
    value: function() {
      for (var i = [], a = this.imp.getAllEntityIds(), s = a.length(), o = 0; o < s; o++)
        i.push(new Fe(a.at(o), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(a), i;
    }
  }, {
    key: "getOriginalClassName",
    value: function() {
      return this.imp.getOriginalClassName();
    }
  }]), r;
}(xr), Bc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), n instanceof Object ? i = t.call(this, n) : (i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.MdDbRasterImage())), kr(i);
  }
  return Be(r, [{
    key: "setOrientation",
    value: function(i, a, s) {
      return this.imp.setOrientation(i.imp, a.imp, s.imp);
    }
  }, {
    key: "getOrientation",
    value: function() {
      var i = this.imp.getOrientation();
      if (i.length() < 3)
        return {
          origin: new te(),
          uCorner: Ve.kXAxis.clone(),
          vOnPlane: Ve.kYAxis.clone()
        };
      var a = new te(i.at(0)), s = new Ve(i.at(1)), o = new Ve(i.at(2));
      return {
        origin: a,
        uCorner: s,
        vOnPlane: o
      };
    }
  }, {
    key: "setDwgImageSize",
    value: function(i, a) {
      return this.imp.setImageSize(i, a);
    }
  }, {
    key: "getDwgImageSize",
    value: function() {
      var i = this.imp.getImageSize();
      return [i.x, i.y];
    }
  }, {
    key: "setImageDefId",
    value: function(i) {
      i.type == rt.kMxCAD && this.imp.setImageDefId(i.id);
    }
  }, {
    key: "imageDefId",
    value: function() {
      return new Fe(this.imp.imageDefId(), rt.kMxCAD);
    }
  }, {
    key: "setClipBoundary",
    value: function(i, a) {
      return this.imp.setClipBoundary(i, a.imp);
    }
  }, {
    key: "clipBoundary",
    value: function() {
      return new Xr(this.imp.clipBoundary());
    }
  }, {
    key: "clipBoundaryType",
    value: function() {
      return this.imp.clipBoundaryType();
    }
  }]), r;
}(xr), Lc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), n instanceof Object ? i = t.call(this, n) : (i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.MdDbWipeout())), kr(i);
  }
  return Be(r, [{
    key: "setVertices",
    value: function(i) {
      return this.imp.setVertices(i.imp);
    }
  }, {
    key: "getVertices",
    value: function() {
      return new Xr(this.imp.getVertices());
    }
  }]), r;
}(xr), Fv = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "setShow",
    value: function(i, a) {
      return this.imp.setShow(xe.encodeToGb2312(i), a);
    }
  }, {
    key: "isShow",
    value: function(i) {
      return this.imp.isShow(xe.encodeToGb2312(i));
    }
  }, {
    key: "setShowColor",
    value: function(i, a) {
      return this.imp.setShowColor(xe.encodeToGb2312(i), a);
    }
  }, {
    key: "getBackgroundDatabase",
    value: function(i) {
      var a = this.imp.getBackgroundDatabase(xe.encodeToGb2312(i));
      return a.isNull() ? (ie.App.destroyObject(a), null) : new Va(a);
    }
  }, {
    key: "clearAll",
    value: function() {
      return this.imp.clearAll();
    }
  }, {
    key: "clearDwg",
    value: function(i) {
      return this.imp.clearDwg(xe.encodeToGb2312(i));
    }
  }]), r;
}(xr), Eo = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Mr(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbSpline()), i;
  }
  return Be(r, [{
    key: "getNurbsData",
    value: function() {
      var i = this.imp.GetNurbsDataParam(), a = i.Atlong(0), s = i.Atlong(1) == 1, o = i.Atlong(2) == 1, u = i.Atlong(3) == 1, l = i.AtDouble(4), c = i.AtDouble(5);
      ie.App.destroyObject(i);
      var f = new Xr(this.imp.GetControlPoints(), !0), h = new hs(this.imp.GetKnots(), !0), d = new hs(this.imp.GetWeights(), !0);
      return {
        degree: a,
        rational: s,
        closed: o,
        periodic: u,
        controlPoints: f,
        knots: h,
        weights: d,
        controlPtTol: l,
        knotTol: c
      };
    }
  }, {
    key: "setNurbsData",
    value: function(i) {
      var a = new vr();
      return a.AddLong(i.degree), a.AddLong(i.rational ? 1 : 0), a.AddLong(i.closed ? 1 : 0), a.AddLong(i.periodic ? 1 : 0), a.AddDouble(i.controlPtTol), a.AddDouble(i.knotTol), this.imp.SetNurbsData(a.getImp(), i.controlPoints.imp, i.knots.imp, i.weights.imp), !0;
    }
  }, {
    key: "getFitPoints",
    value: function() {
      var i = this.imp.GetFitDataParam(), a = i.Atlong(0), s = i.AtDouble(1), o = i.Atlong(2) == 1, u = i.AtPoint(3), l = i.AtPoint(4), c = new Ve(u.x, u.y, u.z), f = new Ve(l.x, l.y, l.z);
      ie.App.destroyObject(i);
      var h = new Xr(this.imp.GeFitPoints(), !0);
      return {
        degree: a,
        fitTolerance: s,
        tangentsExist: o,
        startTangent: c,
        endTangent: f,
        fitPoints: h
      };
    }
  }, {
    key: "setFitPoints",
    value: function(i) {
      var a = new vr();
      return a.AddLong(i.degree), a.AddDouble(i.fitTolerance), a.AddLong(i.tangentsExist ? 1 : 0), a.AddPoint(new te(i.startTangent.x, i.startTangent.y, i.startTangent.z)), a.AddPoint(new te(i.endTangent.x, i.endTangent.y, i.endTangent.z)), this.imp.SetFitData(a.getImp(), i.fitPoints.imp), !0;
    }
  }]), r;
}(Zr);
function qy(e) {
  var t = $y();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function $y() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return ($y = function() {
    return !!e;
  })();
}
var Yf = /* @__PURE__ */ function(e) {
  return e[e.kClone = 1] = "kClone", e[e.kDragClone = 2] = "kDragClone", e[e.kCPPClone = 3] = "kCPPClone", e;
}(Yf || {}), Kf = /* @__PURE__ */ function(e) {
  return e[e.kWorldDraw = 1] = "kWorldDraw", e[e.kExplodeDraw = 2] = "kExplodeDraw", e;
}(Kf || {}), Zf = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(
      this,
      "type",
      1
      /* kClone */
    ), this.type = t;
  }
  return Be(e, [{
    key: "getType",
    value: function() {
      return this.type;
    }
  }, {
    key: "writePoints",
    value: function(r, n) {
      var i = this;
      this.writeLong(r + "_n", n.length), n.forEach(function(a, s) {
        i.writePoint(r + "_" + s, a);
      });
    }
  }, {
    key: "readPoints",
    value: function(r) {
      var n = [], i = this.readLong(r + "_n");
      if (i.ret)
        for (var a = 0; a < i.val; a++) {
          var s = this.readPoint(r + "_" + a);
          s.ret && n.push(s.val);
        }
      return {
        val: n,
        ret: !0
      };
    }
  }]), e;
}(), s2 = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = qy(r);
  function r() {
    var n, i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 1;
    return Pe(this, r), n = t.call(this, i), le(dt(n), "data", {}), n;
  }
  return Be(r, [{
    key: "writePoint",
    value: function(i, a) {
      this.data[i] = a.clone();
    }
  }, {
    key: "readPoint",
    value: function(i) {
      return this.data[i] && this.data[i] instanceof te ? {
        val: this.data[i],
        ret: !0
      } : {
        val: new te(0, 0, 0),
        ret: !1
      };
    }
  }, {
    key: "writeLong",
    value: function(i, a) {
      this.data[i] = a;
    }
  }, {
    key: "readLong",
    value: function(i) {
      return this.data[i] && typeof this.data[i] == "number" ? {
        val: this.data[i],
        ret: !0
      } : {
        val: 0,
        ret: !1
      };
    }
  }, {
    key: "writeDouble",
    value: function(i, a) {
      this.data[i] = a;
    }
  }, {
    key: "readDouble",
    value: function(i) {
      return this.data[i] && typeof this.data[i] == "number" ? {
        val: this.data[i],
        ret: !0
      } : {
        val: 0,
        ret: !1
      };
    }
  }, {
    key: "writeString",
    value: function(i, a) {
      this.data[i] = a;
    }
  }, {
    key: "readString",
    value: function(i) {
      return this.data[i] && typeof this.data[i] == "string" ? {
        val: this.data[i],
        ret: !0
      } : {
        val: "",
        ret: !1
      };
    }
  }]), r;
}(Zf), Iv = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", void 0), le(
      this,
      "type",
      1
      /* kWorldDraw */
    ), this.imp = new ie.mxcadassemblyimp.MdGiWorldDraw(t);
  }
  return Be(e, [{
    key: "getDatabase",
    value: function() {
      return new Va(this.imp.getDatabase());
    }
  }, {
    key: "setupForEntity",
    value: function(r) {
      return this.imp.setupForEntity(r.imp);
    }
  }, {
    key: "drawEntity",
    value: function(r) {
      this.imp.drawEntity(r.imp);
    }
  }, {
    key: "drawOsnapEntity",
    value: function(r) {
      this.imp.drawOsnapEntity(r.imp);
    }
  }, {
    key: "trueColor",
    get: function() {
      return new fr(this.imp.trueColor());
    },
    set: function(r) {
      this.imp.setTrueColor(r.getImp());
    }
  }, {
    key: "layerId",
    get: function() {
      return new Fe(this.imp.layerId());
    },
    set: function(r) {
      this.imp.setLayerId(r.id);
    }
  }, {
    key: "lineTypeId",
    get: function() {
      return new Fe(this.imp.lineTypeId());
    },
    set: function(r) {
      this.imp.setLineTypeId(r.id);
    }
  }, {
    key: "lineWeight",
    get: function() {
      return new this.imp.lineWeight();
    },
    set: function(r) {
      this.imp.setLineWeight(r);
    }
  }, {
    key: "lineTypeScale",
    get: function() {
      return new this.imp.lineTypeScale();
    },
    set: function(r) {
      this.imp.setLineTypeScale(r);
    }
  }, {
    key: "getType",
    value: function() {
      return this.type;
    }
  }, {
    key: "initType",
    value: function(r) {
      this.type = r;
    }
  }]), e;
}(), dl = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = qy(r);
  function r(n) {
    var i;
    return Pe(this, r), n instanceof Object ? i = t.call(this, n) : (i = t.call(this), i.initTempObject(new ie.mxcadassemblyimp.MdDbCustomEntity(i.getTypeName()))), kr(i);
  }
  return Be(r, [{
    key: "rxInit",
    value: function() {
      Pr.rxInit(this);
    }
  }, {
    key: "clone",
    value: function() {
      var i = 1, a = this.create(), s = new s2(i);
      return this.dwgOutFields(s), a.dwgInFields(s), a;
    }
  }, {
    key: "syncData",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
      if (i) {
        var a = this.imp.getFilter(!0), s = new H0(a);
        this.dwgOutFields(s), ie.App.getImp().DestroyMdDbCustomEntityDwgFiler(a);
      } else {
        var o = this.imp.getFilter(!1), u = new H0(o);
        this.dwgInFields(u), ie.App.getImp().DestroyMdDbCustomEntityDwgFiler(o);
      }
      return !0;
    }
  }, {
    key: "tempRelationObject",
    value: function() {
      return Pr.tmpRelationObject(this);
    }
  }, {
    key: "freeTempRelationObject",
    value: function() {
      Pr.freeTmpObject(this);
    }
  }, {
    key: "assertWrite",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
      this.imp.assertWrite(i, !0, !0, !0, !1);
    }
  }, {
    key: "moveGripPointsAt",
    value: function(i, a, s, o) {
    }
  }, {
    key: "getGripPoints",
    value: function() {
      return new Xr();
    }
  }, {
    key: "transformBy",
    value: function(i) {
      return !1;
    }
  }, {
    key: "getName",
    value: function() {
      return this.getTypeName();
    }
  }, {
    key: "getBoundingBox",
    value: function() {
      return {
        minPt: new te(),
        maxPt: new te(),
        ret: !1
      };
    }
  }]), r;
}(xr);
function o2(e) {
  var t = Yy();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function Yy() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (Yy = function() {
    return !!e;
  })();
}
var u2 = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "mapType2Create", /* @__PURE__ */ new Map()), le(this, "mapId2DatabaseMap", {}), le(this, "alloc_id", 1), le(this, "alloc_tempid", 1), le(this, "mapTempId2Entity", /* @__PURE__ */ new Map());
  }
  return Be(e, [{
    key: "rxInit",
    value: function(r) {
      var n = r.getTypeName();
      this.mapType2Create.get(n) && console.log("MxCADError:already has this class name " + n), this.mapType2Create.set(n, r);
    }
  }, {
    key: "tmpRelationObject",
    value: function(r) {
      return this.alloc_tempid > 9007199254740900 && (this.alloc_tempid = 1), this.alloc_tempid += 1, r.imp.setCustomEntityTempid(this.alloc_tempid), this.mapTempId2Entity.set(this.alloc_tempid, r), this.alloc_tempid;
    }
  }, {
    key: "freeTmpObject",
    value: function(r) {
      if (typeof r == "number")
        this.mapTempId2Entity.delete(r);
      else {
        var n = r.imp.getCustomEntityTempid();
        r.imp.setCustomEntityTempid(0), this.mapTempId2Entity.delete(n);
      }
    }
  }, {
    key: "getTmpObject",
    value: function(r) {
      return this.mapTempId2Entity.get(r);
    }
  }, {
    key: "allocId",
    value: function() {
      return this.alloc_id > 9007199254740900 && (this.alloc_id = 1), this.alloc_id += 1, this.alloc_id;
    }
  }, {
    key: "isHaveType",
    value: function(r) {
      return this.mapType2Create.has(r);
    }
  }, {
    key: "createMxEntity",
    value: function(r, n) {
      if (r.length == 0)
        return console.log("MxTip:assert(0) typeName is empty "), null;
      var i = this.mapType2Create.get(r);
      if (!i)
        return console.error("mx: error crate,no type name:" + r), null;
      var a = i.create(n);
      return a.getTypeName() != r && console.error("mx: error crate Type:" + r + "," + a.getTypeName()), a;
    }
  }, {
    key: "relationObject",
    value: function(r, n) {
      if (n == 0) return 0;
      var i = this.allocId(), a = this.mapId2DatabaseMap[n];
      return a || (a = /* @__PURE__ */ new Map(), this.mapId2DatabaseMap[n] = a), a.set(i, {
        idIndex: r,
        init: !1,
        customEntity: null
      }), i;
    }
  }, {
    key: "freeObject",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
      if (n != 0) {
        var i = this.mapId2DatabaseMap[n];
        if (!i) return;
        i.delete(r);
        return;
      } else
        for (var a in this.mapId2DatabaseMap) {
          var s = this.mapId2DatabaseMap[a];
          s.delete(r);
        }
    }
  }, {
    key: "freeDatabase",
    value: function(r) {
      this.mapId2DatabaseMap.hasOwnProperty(r) && delete this.mapId2DatabaseMap[r];
    }
  }, {
    key: "getObjectFormId",
    value: function(r) {
      return r.isValid() && r.type == rt.kMxCAD && ie.App.objectIdIsKindOf(r.id, "McDbCustomEntity") ? ie.App.objectIdToObject(r.id) : null;
    }
  }, {
    key: "getObject",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
      if (r == 0) return null;
      var i = void 0;
      if (n != 0) {
        var a = this.mapId2DatabaseMap[n];
        if (!a) return null;
        i = a.get(r);
      } else
        for (var s in this.mapId2DatabaseMap) {
          var o = this.mapId2DatabaseMap[s];
          if (i = o.get(r), i) {
            n = parseInt(s);
            break;
          }
        }
      if (!i) return null;
      if (i.customEntity)
        return i.customEntity;
      if (i.init)
        return null;
      i.init = !0;
      var u = ie.App.getImp().ObjectIdToMdDbCustomEntity(i.idIndex);
      if (!u) return null;
      var l = Pr.createMxEntity(u.getCustomEntityTypeName(), u);
      return l == null ? null : (l.syncData(!1), i.customEntity = l, l);
    }
  }, {
    key: "init",
    value: function() {
      var r = window;
      r.MxCustomEntityManager_freeObject = function(n, i) {
        Pr.freeObject(n, i);
      }, r.MxCustomEntityManager_relationObject = function(n, i) {
        return Pr.relationObject(n, i);
      }, r.MxCustomEntityManager_freeDatabase = function(n) {
        Pr.freeDatabase(n);
      }, r.MxCustomEntityManager_worldDraw = function(n, i, a, s, o, u) {
        var l;
        if (s != 0 ? l = Pr.getTmpObject(s) : l = Pr.getObject(n, i), !!l) {
          var c = new Iv(a);
          o !== 0 && c.imp.connectVecOsnapEntity(o), u !== 0 && (c.initType(Kf.kExplodeDraw), c.imp.connectVecExplodeEntity(u)), l.worldDraw(c);
        }
      }, r.MxCustomEntityManager_getGeomExtents = function(n, i, a, s) {
        var o;
        if (s != 0 ? o = Pr.getTmpObject(s) : o = Pr.getObject(n, i), !!o) {
          var u = o.getBoundingBox();
          if (u.ret) {
            var l = new vr();
            l.getImp().Connect(a, !1), l.AddPoint(u.minPt), l.AddPoint(u.maxPt);
          }
        }
      }, r.MxCustomEntityManager_syncData = function(n, i, a) {
        var s = Pr.getObject(n, i);
        s && s.syncData(a != 0);
      }, r.MxCustomEntityManager_transformBy = function(n, i, a, s) {
        var o = new Jr();
        o.imp.copyFormPointer(a);
        var u;
        s != 0 ? u = Pr.getTmpObject(s) : u = Pr.getObject(n, i), u && u.transformBy(o);
      };
    }
  }]), e;
}(), H0 = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = o2(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, Yf.kCPPClone), le(dt(i), "imp", void 0), n || (n = new ie.mxcadassemblyimp.MdDbCustomEntityDwgFiler()), i.imp = n, i;
  }
  return Be(r, [{
    key: "writePoint",
    value: function(i, a) {
      this.imp.writePoint(i, a.imp.x, a.imp.y, a.imp.z);
    }
  }, {
    key: "readPoint",
    value: function(i) {
      var a = this.imp.readPoint(i), s = {};
      return ie.getCallResult() == 0 ? s = {
        val: new te(a),
        ret: !0
      } : s = {
        val: new te(),
        ret: !1
      }, ie.App.getImp().DestroyMdGePoint3d(a), s;
    }
  }, {
    key: "writeLong",
    value: function(i, a) {
      this.imp.writeLong(i, a);
    }
  }, {
    key: "readLong",
    value: function(i) {
      var a = this.imp.readLong(i), s = {};
      return ie.getCallResult() == 0 ? s = {
        val: a,
        ret: !0
      } : s = {
        val: 0,
        ret: !1
      }, s;
    }
  }, {
    key: "writeDouble",
    value: function(i, a) {
      this.imp.writeDouble(i, a);
    }
  }, {
    key: "readDouble",
    value: function(i) {
      var a = this.imp.readDouble(i), s = {};
      return ie.getCallResult() == 0 ? s = {
        val: a,
        ret: !0
      } : s = {
        val: 0,
        ret: !1
      }, s;
    }
  }, {
    key: "writeString",
    value: function(i, a) {
      this.imp.writeString(i, a);
    }
  }, {
    key: "readString",
    value: function(i) {
      var a = this.imp.readString(i), s = {};
      return ie.getCallResult() == 0 ? s = {
        val: a,
        ret: !0
      } : s = {
        val: "",
        ret: !1
      }, s;
    }
  }]), r;
}(Zf), Pr;
Pr = new u2();
function gn(e) {
  var t = Ky();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function Ky() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (Ky = function() {
    return !!e;
  })();
}
var Rv = /* @__PURE__ */ function(e) {
  return e[e.kEntityType = 5020] = "kEntityType", e[e.kLayer = 8] = "kLayer", e[e.kBlockName = 2] = "kBlockName", e[e.kColor = 62] = "kColor", e[e.kAppName = -3] = "kAppName", e[e.kLong = 1071] = "kLong", e[e.kDouble = 1040] = "kDouble", e[e.kString = 1e3] = "kString", e[e.kPoint = 1010] = "kPoint", e[e.kEntityId = -8e3] = "kEntityId", e[e.kEntity = -8500] = "kEntity", e[e.kExDataName = 1001] = "kExDataName", e;
}(Rv || {}), Ie;
(function(e) {
  (function(t) {
    t[t.kLwPolyline = 0] = "kLwPolyline", t[t.k3dPolyline = 2] = "k3dPolyline";
  })(e.PolylineType || (e.PolylineType = {})), function(t) {
    t[t.kTextLeft = 0] = "kTextLeft", t[t.kTextCenter = 1] = "kTextCenter", t[t.kTextRight = 2] = "kTextRight", t[t.kTextAlign = 3] = "kTextAlign", t[t.kTextMid = 4] = "kTextMid", t[t.kTextFit = 5] = "kTextFit";
  }(e.TextHorzMode || (e.TextHorzMode = {})), function(t) {
    t[t.kOnBothOperands = 0] = "kOnBothOperands", t[t.kExtendThis = 1] = "kExtendThis", t[t.kExtendArg = 2] = "kExtendArg", t[t.kExtendBoth = 3] = "kExtendBoth";
  }(e.Intersect || (e.Intersect = {})), function(t) {
    t[t.kTextBase = 0] = "kTextBase", t[t.kTextBottom = 1] = "kTextBottom", t[t.kTextVertMid = 2] = "kTextVertMid", t[t.kTextTop = 3] = "kTextTop";
  }(e.TextVertMode || (e.TextVertMode = {})), function(t) {
    t[t.kTopLeft = 1] = "kTopLeft", t[t.kTopCenter = 2] = "kTopCenter", t[t.kTopRight = 3] = "kTopRight", t[t.kMiddleLeft = 4] = "kMiddleLeft", t[t.kMiddleCenter = 5] = "kMiddleCenter", t[t.kMiddleRight = 6] = "kMiddleRight", t[t.kBottomLeft = 7] = "kBottomLeft", t[t.kBottomCenter = 8] = "kBottomCenter", t[t.kBottomRight = 9] = "kBottomRight", t[t.kBaseLeft = 10] = "kBaseLeft", t[t.kBaseCenter = 11] = "kBaseCenter", t[t.kBaseRight = 12] = "kBaseRight", t[t.kBaseAlign = 13] = "kBaseAlign", t[t.kBottomAlign = 14] = "kBottomAlign", t[t.kMiddleAlign = 15] = "kMiddleAlign", t[t.kTopAlign = 16] = "kTopAlign", t[t.kBaseFit = 17] = "kBaseFit", t[t.kBottomFit = 18] = "kBottomFit", t[t.kMiddleFit = 19] = "kMiddleFit", t[t.kTopFit = 20] = "kTopFit", t[t.kBaseMid = 21] = "kBaseMid", t[t.kBottomMid = 22] = "kBottomMid", t[t.kMiddleMid = 23] = "kMiddleMid", t[t.kTopMid = 24] = "kTopMid";
  }(e.AttachmentPoint || (e.AttachmentPoint = {})), function(t) {
    t[t.kLnWt000 = 0] = "kLnWt000", t[t.kLnWt005 = 5] = "kLnWt005", t[t.kLnWt009 = 9] = "kLnWt009", t[t.kLnWt013 = 13] = "kLnWt013", t[t.kLnWt015 = 15] = "kLnWt015", t[t.kLnWt018 = 18] = "kLnWt018", t[t.kLnWt020 = 20] = "kLnWt020", t[t.kLnWt025 = 25] = "kLnWt025", t[t.kLnWt030 = 30] = "kLnWt030", t[t.kLnWt035 = 35] = "kLnWt035", t[t.kLnWt040 = 40] = "kLnWt040", t[t.kLnWt050 = 50] = "kLnWt050", t[t.kLnWt053 = 53] = "kLnWt053", t[t.kLnWt060 = 60] = "kLnWt060", t[t.kLnWt070 = 70] = "kLnWt070", t[t.kLnWt080 = 80] = "kLnWt080", t[t.kLnWt090 = 90] = "kLnWt090", t[t.kLnWt100 = 100] = "kLnWt100", t[t.kLnWt106 = 106] = "kLnWt106", t[t.kLnWt120 = 120] = "kLnWt120", t[t.kLnWt140 = 140] = "kLnWt140", t[t.kLnWt158 = 158] = "kLnWt158", t[t.kLnWt200 = 200] = "kLnWt200", t[t.kLnWt211 = 211] = "kLnWt211", t[t.kLnWtByLayer = -1] = "kLnWtByLayer", t[t.kLnWtByBlock = -2] = "kLnWtByBlock", t[t.kLnWtByLwDefault = -3] = "kLnWtByLwDefault";
  }(e.LineWeight || (e.LineWeight = {})), function(t) {
    t[t.kDefault = 0] = "kDefault", t[t.kExternal = 1] = "kExternal", t[t.kPolyline = 2] = "kPolyline", t[t.kDerived = 4] = "kDerived", t[t.kTextbox = 8] = "kTextbox", t[t.kOutermost = 16] = "kOutermost", t[t.kNotClosed = 32] = "kNotClosed", t[t.kSelfIntersecting = 64] = "kSelfIntersecting", t[t.kTextIsland = 128] = "kTextIsland";
  }(e.HatchLoopType || (e.HatchLoopType = {})), function(t) {
    t[t.kLine = 1] = "kLine", t[t.kCirArc = 2] = "kCirArc", t[t.kEllArc = 3] = "kEllArc", t[t.kSpline = 4] = "kSpline";
  }(e.HatchEdgeType || (e.HatchEdgeType = {})), function(t) {
    t[t.kUserDefined = 0] = "kUserDefined", t[t.kPreDefined = 1] = "kPreDefined", t[t.kCustomDefined = 2] = "kCustomDefined";
  }(e.HatchPatternType || (e.HatchPatternType = {})), function(t) {
    t[t.kNormal = 0] = "kNormal", t[t.kOuter = 1] = "kOuter", t[t.kIgnore = 2] = "kIgnore";
  }(e.HatchStyle || (e.HatchStyle = {})), function(t) {
    t[t.kInvalid = 0] = "kInvalid", t[t.kRect = 1] = "kRect", t[t.kPoly = 2] = "kPoly";
  }(e.ClipBoundaryType || (e.ClipBoundaryType = {}));
})(Ie || (Ie = {}));
var fr = /* @__PURE__ */ function() {
  function e(t, r, n, i) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdCmColor(), t instanceof Object ? (this.imp.red = t.red, this.imp.green = t.green, this.imp.blue = t.blue, this.imp.method = t.method, this.imp.n = t.n, this.imp.colorIndex = t.colorIndex) : typeof t == "number" && typeof r == "number" && typeof n == "number" && (this.imp.setRGB(t, r, n), typeof i == "number" && (this.imp.n = i));
  }
  return Be(e, [{
    key: "getImp",
    value: function() {
      return this.imp;
    }
  }, {
    key: "copy",
    value: function(r) {
      return this.imp.red = r.imp.red, this.imp.green = r.imp.green, this.imp.blue = r.imp.blue, this.imp.method = r.imp.method, this.imp.n = r.imp.n, this.imp.colorIndex = r.imp.colorIndex, this;
    }
  }, {
    key: "clone",
    value: function() {
      return new e(this.imp);
    }
  }, {
    key: "setColorIndex",
    value: function(r) {
      this.imp.setColorIndex(r);
    }
  }, {
    key: "setRGB",
    value: function(r, n, i) {
      this.imp.setRGB(r, n, i);
    }
  }, {
    key: "red",
    get: function() {
      return this.imp.red;
    },
    set: function(r) {
      this.imp.red = r;
    }
  }, {
    key: "green",
    get: function() {
      return this.imp.green;
    },
    set: function(r) {
      this.imp.green = r;
    }
  }, {
    key: "blue",
    get: function() {
      return this.imp.blue;
    },
    set: function(r) {
      this.imp.blue = r;
    }
  }, {
    key: "n",
    get: function() {
      return this.imp.n;
    },
    set: function(r) {
      this.imp.n = r;
    }
  }, {
    key: "method",
    get: function() {
      return this.imp.method;
    },
    set: function(r) {
      this.imp.method = r;
    }
  }, {
    key: "colorIndex",
    get: function() {
      return this.imp.colorIndex;
    },
    set: function(r) {
      this.imp.colorIndex = r;
    }
  }, {
    key: "getColorString",
    value: function() {
      return this.imp.getColorString();
    }
  }, {
    key: "getColorValue",
    value: function(r, n) {
      var i = 0;
      (r == null ? void 0 : r.type) == rt.kMxCAD && (i = r.id);
      var a = 0;
      return (n == null ? void 0 : n.type) == rt.kMxCAD && (a = n.id), this.imp.getColorValue(i, a);
    }
  }, {
    key: "getStyle",
    value: function() {
      var r = this.red, n = this.green, i = this.blue, a = this.colorIndex, s = th(r / 255, n / 255, i / 255), o = a === Ti.kWhite;
      if (o) {
        var u = {
          h: 0,
          s: 0,
          l: 0
        };
        s.getHSL(u), u.h = (u.h + 0.5) % 1, s.setHSL(u.h, u.s, u.l);
      }
      return s.getStyle();
    }
  }]), e;
}(), Fc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbLinetypeTableRecord()), i;
  }
  return Be(r, [{
    key: "name",
    get: function() {
      return xe.decodeFromGb2312(this.imp.getName());
    },
    set: function(i) {
      this.imp.setName(xe.encodeToGb2312(i));
    }
  }, {
    key: "numDashes",
    get: function() {
      return this.imp.numDashes();
    },
    set: function(i) {
      this.imp.setNumDashes(i);
    }
  }, {
    key: "dashLengthAt",
    value: function(i) {
      return this.imp.dashLengthAt(i);
    }
  }, {
    key: "setDashLengthAt",
    value: function(i, a) {
      return this.imp.setDashLengthAt(i, a);
    }
  }, {
    key: "comments",
    get: function() {
      return xe.decodeFromGb2312(this.imp.comments());
    },
    set: function(i) {
      this.imp.setComments(xe.encodeToGb2312(i));
    }
  }, {
    key: "shapeStyleAt",
    value: function(i) {
      return this.imp.shapeStyleAt(i);
    }
  }, {
    key: "setShapeStyleAt",
    value: function(i, a) {
      return this.imp.setShapeStyleAt(i, a);
    }
  }, {
    key: "shapeNumberAt",
    value: function(i) {
      return this.imp.shapeNumberAt(i);
    }
  }, {
    key: "setShapeNumberAt",
    value: function(i, a) {
      return this.imp.setShapeNumberAt(i, a);
    }
  }, {
    key: "shapeOffsetAt",
    value: function(i) {
      return new Ve(this.imp.shapeOffsetAt(i));
    }
  }, {
    key: "setShapeOffsetAt",
    value: function(i, a) {
      return this.imp.setShapeOffsetAt(i, a.imp);
    }
  }, {
    key: "shapeScaleAt",
    value: function(i) {
      return this.imp.shapeScaleAt(i);
    }
  }, {
    key: "setShapeScaleAt",
    value: function(i, a) {
      return this.imp.setShapeScaleAt(i, a);
    }
  }, {
    key: "isScaledToFit",
    get: function() {
      return this.imp.isScaledToFit();
    },
    set: function(i) {
      this.imp.setIsScaledToFit(i);
    }
  }, {
    key: "shapeIsUcsOrientedAt",
    value: function(i) {
      return this.imp.shapeIsUcsOrientedAt(i);
    }
  }, {
    key: "setShapeIsUcsOrientedAt",
    value: function(i, a) {
      return this.imp.setShapeScaleAt(i, a);
    }
  }, {
    key: "shapeRotationAt",
    value: function(i) {
      return this.imp.shapeRotationAt(i);
    }
  }, {
    key: "setShapeRotationAt",
    value: function(i, a) {
      return this.imp.setShapeRotationAt(i, a);
    }
  }, {
    key: "textAt",
    value: function(i) {
      return xe.decodeFromGb2312(this.imp.textAt(i));
    }
  }, {
    key: "setTextAt",
    value: function(i, a) {
      return this.imp.setTextAt(i, xe.encodeToGb2312(a));
    }
  }]), r;
}(Nr), Ic = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbDimStyleTableRecord()), i;
  }
  return Be(r, [{
    key: "name",
    get: function() {
      return xe.decodeFromGb2312(this.imp.getName());
    },
    set: function(i) {
      this.imp.setName(xe.encodeToGb2312(i));
    }
  }, {
    key: "getDimVarInt",
    value: function(i) {
      return this.imp.getDimVarInt(i);
    }
  }, {
    key: "setDimVarInt",
    value: function(i, a) {
      return this.imp.setDimVarInt(i, a);
    }
  }, {
    key: "getDimVarDouble",
    value: function(i) {
      return this.imp.getDimVarDouble(i);
    }
  }, {
    key: "setDimVarDouble",
    value: function(i, a) {
      return this.imp.setDimVarDouble(i, a);
    }
  }, {
    key: "getDimVarString",
    value: function(i) {
      return xe.decodeFromGb2312(this.imp.getDimVarString(i));
    }
  }, {
    key: "setDimVarString",
    value: function(i, a) {
      return this.imp.setDimVarString(i, xe.encodeToGb2312(a));
    }
  }, {
    key: "getDimVarObjectId",
    value: function(i) {
      return new Fe(this.imp.getDimVarObjectId(i), rt.kMxCAD);
    }
  }, {
    key: "setDimVarObjectId",
    value: function(i, a) {
      return this.imp.setDimVarObjectId(i, a.id);
    }
  }, {
    key: "getDimblk",
    value: function() {
      return this.imp.getDimblk();
    }
  }, {
    key: "setDimblk",
    value: function(i) {
      return this.imp.setDimblk(i);
    }
  }, {
    key: "getDimblk1",
    value: function() {
      return this.imp.getDimblk1();
    }
  }, {
    key: "setDimblk1",
    value: function(i) {
      return this.imp.setDimblk1(i);
    }
  }, {
    key: "getDimblk2",
    value: function() {
      return this.imp.getDimblk2();
    }
  }, {
    key: "setDimblk2",
    value: function(i) {
      return this.imp.setDimblk2(i);
    }
  }, {
    key: "getDimldrblk",
    value: function() {
      return this.imp.getDimldrblk();
    }
  }, {
    key: "setDimldrblk",
    value: function(i) {
      return this.imp.setDimldrblk(i);
    }
  }]), r;
}(Nr), Rc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbTextStyleTableRecord()), i;
  }
  return Be(r, [{
    key: "name",
    get: function() {
      return xe.decodeFromGb2312(this.imp.getName());
    },
    set: function(i) {
      this.imp.setName(xe.encodeToGb2312(i));
    }
  }, {
    key: "isShapeFile",
    get: function() {
      return this.imp.isShapeFile();
    },
    set: function(i) {
      this.imp.setIsShapeFile(i);
    }
  }, {
    key: "isVertical",
    get: function() {
      return this.imp.isVertical();
    },
    set: function(i) {
      this.imp.setIsVertical(i);
    }
  }, {
    key: "textSize",
    get: function() {
      return this.imp.textSize();
    },
    set: function(i) {
      this.imp.setTextSize(i);
    }
  }, {
    key: "xScale",
    get: function() {
      return this.imp.xScale();
    },
    set: function(i) {
      this.imp.setXScale(i);
    }
  }, {
    key: "obliquingAngle",
    get: function() {
      return this.imp.obliquingAngle();
    },
    set: function(i) {
      this.imp.setObliquingAngle(i);
    }
  }, {
    key: "flagBits",
    get: function() {
      return this.imp.flagBits();
    },
    set: function(i) {
      this.imp.setFlagBits(i);
    }
  }, {
    key: "fileName",
    get: function() {
      return xe.decodeFromGb2312(this.imp.fileName());
    },
    set: function(i) {
      this.imp.setFileName(xe.encodeToGb2312(i));
    }
  }, {
    key: "bigFontFileName",
    get: function() {
      return xe.decodeFromGb2312(this.imp.bigFontFileName());
    },
    set: function(i) {
      this.imp.setBigFontFileName(xe.encodeToGb2312(i));
    }
  }, {
    key: "setFont",
    value: function(i, a, s, o, u) {
      return this.imp.setFont(xe.encodeToGb2312(i), a, s, o, u);
    }
  }, {
    key: "font",
    value: function() {
      var i = this.imp.font();
      if (!i)
        return {
          sTypeface: "",
          bold: !1,
          italic: !1,
          charset: 0,
          pitchAndFamily: 0
        };
      var a = xe.decodeFromGb2312(i.AtString(0, !0)), s = i.Atlong(1) != 0, o = i.Atlong(2) != 0, u = i.Atlong(3), l = i.Atlong(4);
      return {
        sTypeface: a,
        bold: s,
        italic: o,
        charset: u,
        pitchAndFamily: l
      };
    }
  }]), r;
}(Nr), Oc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbLayerTableRecord()), i;
  }
  return Be(r, [{
    key: "name",
    get: function() {
      return xe.decodeFromGb2312(this.imp.getName());
    },
    set: function(i) {
      this.imp.setName(xe.encodeToGb2312(i));
    }
  }, {
    key: "isFrozen",
    get: function() {
      return this.imp.isFrozen();
    },
    set: function(i) {
      this.imp.setIsFrozen(i);
    }
  }, {
    key: "isOff",
    get: function() {
      return this.imp.isOff();
    },
    set: function(i) {
      this.imp.setIsOff(i);
    }
  }, {
    key: "isLocked",
    get: function() {
      return this.imp.isLocked();
    },
    set: function(i) {
      this.imp.setIsLocked(i);
    }
  }, {
    key: "color",
    get: function() {
      return new fr(this.imp.color());
    },
    set: function(i) {
      this.imp.setColor(i.getImp());
    }
  }, {
    key: "linetypeObjectId",
    get: function() {
      return new Fe(this.imp.linetypeObjectId(), rt.kMxCAD);
    },
    set: function(i) {
      this.imp.setLinetypeObjectId(i.id);
    }
  }, {
    key: "lineWeight",
    get: function() {
      return this.imp.lineWeight();
    },
    set: function(i) {
      this.imp.setLineWeight(i);
    }
  }]), r;
}(Nr), Nc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "getAllRecordId",
    value: function() {
      for (var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0, a = [], s = this.imp.getAllRecordId(i), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "add",
    value: function(i) {
      return new Fe(this.imp.add(i.getImp()), rt.kMxCAD);
    }
  }, {
    key: "get",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return new Fe(this.imp.get(s, a));
    }
  }, {
    key: "has",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return this.imp.get(s, a) != 0;
    }
  }]), r;
}(Nr), Uc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "getAllRecordId",
    value: function() {
      for (var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0, a = [], s = this.imp.getAllRecordId(i), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "add",
    value: function(i) {
      return new Fe(this.imp.add(i.getImp()), rt.kMxCAD);
    }
  }, {
    key: "get",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return new Fe(this.imp.get(s, a));
    }
  }, {
    key: "has",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return this.imp.get(s, a) != 0;
    }
  }]), r;
}(Nr), Gc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "getAllRecordId",
    value: function() {
      for (var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0, a = [], s = this.imp.getAllRecordId(i), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "add",
    value: function(i) {
      return new Fe(this.imp.add(i.getImp()), rt.kMxCAD);
    }
  }, {
    key: "get",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return new Fe(this.imp.get(s, a));
    }
  }, {
    key: "has",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return this.imp.get(s, a) != 0;
    }
  }]), r;
}(Nr), zc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "getAllRecordId",
    value: function() {
      for (var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0, a = [], s = this.imp.getAllRecordId(i), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "add",
    value: function(i) {
      return new Fe(this.imp.add(i.getImp()), rt.kMxCAD);
    }
  }, {
    key: "get",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return new Fe(this.imp.get(s, a));
    }
  }, {
    key: "has",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return this.imp.get(s, a) != 0;
    }
  }]), r;
}(Nr), Va = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbDatabase()), i;
  }
  return Be(r, [{
    key: "ucsMatrix",
    get: function() {
      return new Jr(this.imp.getUcsMatrix());
    },
    set: function(i) {
      this.imp.setUcsMatrix(i.imp);
    }
  }, {
    key: "getLayerTable",
    value: function() {
      return new Nc(this.imp.GetLayerTable());
    }
  }, {
    key: "wblock",
    value: function(i, a, s) {
      s || (s = te.kOrigin);
      var o = new fa();
      return a.forEach(function(u) {
        o.append(u.id);
      }), this.imp.wblock(i.getImp(), o.imp, s.imp);
    }
  }, {
    key: "insert",
    value: function(i, a) {
      var s = xe.encodeToGb2312(a);
      return new Fe(this.imp.insert(i.getImp(), s), rt.kMxCAD);
    }
  }, {
    key: "readFile",
    value: function(i) {
      return this.imp.readFile(i);
    }
  }, {
    key: "saveAs",
    value: function(i) {
      return this.imp.saveAs(i);
    }
  }, {
    key: "layerTable",
    get: function() {
      return new Nc(this.imp.GetLayerTable());
    }
  }, {
    key: "getLinetypeTable",
    value: function() {
      return new Uc(this.imp.GetLinetypeTable());
    }
  }, {
    key: "getDimStyleTable",
    value: function() {
      return new Gc(this.imp.GetDimStyleTable());
    }
  }, {
    key: "dimStyleTable",
    get: function() {
      return new Gc(this.imp.GetDimStyleTable());
    }
  }, {
    key: "linetypeTable",
    get: function() {
      return new Uc(this.imp.GetLinetypeTable());
    }
  }, {
    key: "getTextStyleTable",
    value: function() {
      return new zc(this.imp.GetTextStyleTable());
    }
  }, {
    key: "textStyleTable",
    get: function() {
      return new zc(this.imp.GetTextStyleTable());
    }
  }, {
    key: "getBlockTable",
    value: function() {
      return new Wc(this.imp.GetBlockTable());
    }
  }, {
    key: "getNamedObjectsDictionary",
    value: function() {
      return new vs(this.imp.GetNamedObjectsDictionary());
    }
  }, {
    key: "getEntitiesInTheGroup",
    value: function(i) {
      for (var a = [], s = this.imp.getEntitiesInTheGroup(i.id), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "GetGroupDictionary",
    value: function() {
      return new vs(this.imp.GetGroupDictionary());
    }
  }, {
    key: "CreateGroup",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "", s = this.GetGroupDictionary(), o = new Su();
      return o.appendArray(i), o.name = a, s.addObject(a, o), !0;
    }
  }, {
    key: "blockTable",
    get: function() {
      return new Wc(this.imp.GetBlockTable());
    }
  }, {
    key: "currentSpace",
    get: function() {
      return new Ao(this.imp.CurrentSpace());
    }
  }, {
    key: "currentSpaceId",
    get: function() {
      return new Fe(this.imp.CurrentSpaceId(), rt.kMxCAD);
    }
  }, {
    key: "modelSpaceId",
    get: function() {
      return new Fe(this.imp.ModelSpaceId(), rt.kMxCAD);
    }
  }, {
    key: "zeroLayerId",
    get: function() {
      return new Fe(this.imp.ZeroLayerId(), rt.kMxCAD);
    }
  }, {
    key: "isCurrentModelSpace",
    get: function() {
      return this.imp.isCurrentModelSpace();
    }
  }, {
    key: "getCurrentlyLineTypeScale",
    value: function() {
      return this.imp.GetCurrentlyLineTypeScale();
    }
  }, {
    key: "setCurrentlyLineTypeScale",
    value: function(i) {
      return this.imp.SetCurrentlyLineTypeScale(i);
    }
  }, {
    key: "getCurrentlyLineTypeName",
    value: function() {
      var i = this.imp.GetCurrentlyLineTypeName();
      return xe.decodeFromGb2312(i);
    }
  }, {
    key: "setCurrentlyLineTypeName",
    value: function(i) {
      var a = xe.encodeToGb2312(i);
      this.imp.SetCurrentlyLineTypeName(a);
    }
  }, {
    key: "getCurrentlyLayerName",
    value: function() {
      var i = this.imp.GetCurrentlyLayerName();
      return xe.decodeFromGb2312(i);
    }
  }, {
    key: "setCurrentlyLayerName",
    value: function(i) {
      var a = xe.encodeToGb2312(i);
      this.imp.SetCurrentlyLayerName(a);
    }
  }, {
    key: "getCurrentlyTrueColor",
    value: function() {
      return new fr(this.imp.GetCurrentlyTrueColor());
    }
  }, {
    key: "getCurrentlyDrawColor",
    value: function() {
      var i = this.imp.GetCurrentlyDrawColor(), a = new THREE.Color();
      return a.setRGB(i.at(0) / 255, i.at(1) / 255, i.at(2) / 255), a;
    }
  }, {
    key: "setCurrentlyTrueColor",
    value: function(i) {
      return this.imp.SetCurrentlyTrueColor(i.getImp());
    }
  }, {
    key: "getCurrentlyColorIndex",
    value: function() {
      return this.imp.GetCurrentlyColorIndex();
    }
  }, {
    key: "setCurrentlyColorIndex",
    value: function(i) {
      return this.imp.SetCurrentlyColorIndex(i);
    }
  }, {
    key: "getCurrentlyTextStyleName",
    value: function() {
      var i = this.imp.GetCurrentlyTextStyleName();
      return xe.decodeFromGb2312(i);
    }
  }, {
    key: "setCurrentlyTextStyle",
    value: function(i) {
      var a = xe.encodeToGb2312(i);
      this.imp.SetCurrentlyTextStyle(a);
    }
  }, {
    key: "getCurrentlyLineWeight",
    value: function() {
      return this.imp.GetCurrentlyLineWeight();
    }
  }, {
    key: "setCurrentlyLineWeight",
    value: function(i) {
      return this.imp.SetCurrentlyLineWeight(i);
    }
  }, {
    key: "getCurrentlyTextStyleId",
    value: function() {
      return new Fe(this.imp.GetCurrentlyTextStyleId(), rt.kMxCAD);
    }
  }, {
    key: "SetCurrentlyTextStyleId",
    value: function(i) {
      return this.imp.SetCurrentlyTextStyleId(i.id);
    }
  }, {
    key: "getCurrentlyDimStyleId",
    value: function() {
      return new Fe(this.imp.GetCurrentlyDimStyleId(), rt.kMxCAD);
    }
  }, {
    key: "setCurrentlyDimStyleId",
    value: function(i) {
      return this.imp.SetCurrentlyDimStyleId(i.id);
    }
  }, {
    key: "getCurrentlyLayerId",
    value: function() {
      return new Fe(this.imp.GetCurrentlyLayerId(), rt.kMxCAD);
    }
  }, {
    key: "setCurrentlyLayerId",
    value: function(i) {
      return this.imp.SetCurrentlyLayerId(i.id);
    }
  }, {
    key: "getCurrentlyLinetypeId",
    value: function() {
      return new Fe(this.imp.GetCurrentlyLinetypeId(), rt.kMxCAD);
    }
  }, {
    key: "setCurrentlyLinetypeId",
    value: function(i) {
      return this.imp.SetCurrentlyLinetypeId(i.id);
    }
  }, {
    key: "handleToIdIndex",
    value: function(i) {
      var a = this.imp.HandleToIdIndex(i);
      return new Fe(a, rt.kMxCAD);
    }
  }, {
    key: "isModifyed",
    value: function() {
      return this.imp.IsModifyed();
    }
  }, {
    key: "resetModificationStatus",
    value: function() {
      return this.imp.SetModifyed(!1);
    }
  }]), r;
}(Xo), Ao = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbBlockTableRecord()), i;
  }
  return Be(r, [{
    key: "appendAcDbEntity",
    value: function(i) {
      var a = i.syncData(!0), s = new Fe(this.imp.appendAcDbEntity(i.getImp()), rt.kMxCAD);
      return a && Pr.getObjectFormId(s), s;
    }
  }, {
    key: "getAllEntityId",
    value: function() {
      for (var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0, a = [], s = this.imp.getAllEntityId(i), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "getMinMaxDrawOrder",
    value: function() {
      var i = this.imp.getMinMaxDrawOrder();
      return {
        minDrawOrder: i.x,
        maxDrawOrder: i.y
      };
    }
  }, {
    key: "origin",
    get: function() {
      return new te(this.imp.origin());
    },
    set: function(i) {
      this.imp.setOrigin(i.imp);
    }
  }, {
    key: "getBoundingBox",
    value: function() {
      var i = this.imp.getBoundingBox();
      if (i.length() < 2)
        return {
          minPt: new te(),
          maxPt: new te(),
          ret: !1
        };
      var a = {
        minPt: new te(i.at(0)),
        maxPt: new te(i.at(1)),
        ret: !0
      };
      return a;
    }
  }, {
    key: "invalidBoundingBoxBuffer",
    value: function() {
      this.imp.invalidBoundingBoxBuffer();
    }
  }, {
    key: "name",
    get: function() {
      return xe.decodeFromGb2312(this.imp.getName());
    },
    set: function(i) {
      this.imp.setName(xe.encodeToGb2312(i));
    }
  }]), r;
}(Nr), Wc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbBlockTable()), i;
  }
  return Be(r, [{
    key: "getAllRecordId",
    value: function() {
      for (var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0, a = [], s = this.imp.getAllRecordId(i), o = s.length(), u = 0; u < o; u++)
        a.push(new Fe(s.at(u), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(s), a;
    }
  }, {
    key: "add",
    value: function(i) {
      if (typeof i == "string") {
        if (i.length > 0) {
          var a = this.get(i, !1);
          if (a.isValid()) {
            var s = a.getMcDbBlockTableRecord();
            return s && s.isErased() && s.unErase(), a;
          }
        }
        var o = new Ao();
        return o.name = i, new Fe(this.imp.add(o.getImp()), rt.kMxCAD);
      } else
        return new Fe(this.imp.add(i.getImp()), rt.kMxCAD);
    }
  }, {
    key: "get",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, s = xe.encodeToGb2312(i);
      return new Fe(this.imp.get(s, a));
    }
  }, {
    key: "has",
    value: function(i) {
      var a = xe.encodeToGb2312(i);
      return this.imp.get(a, !0) != 0;
    }
  }]), r;
}(Nr), Vc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbRasterImageDef()), i;
  }
  return Be(r, [{
    key: "sourceFileName",
    get: function() {
      return xe.decodeFromGb2312(this.imp.sourceFileName());
    },
    set: function(i) {
      this.imp.setSourceFileName(xe.encodeToGb2312(i));
    }
  }, {
    key: "saveToBase64",
    value: function(i) {
      return this.imp.saveToBase64(i);
    }
  }]), r;
}(Nr), vs = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbDictionary()), i;
  }
  return Be(r, [{
    key: "getAllObject",
    value: function() {
      for (var i = [], a = this.imp.getAllObject(), s = a.length(), o = 0; o < s; o++)
        i.push(new Fe(a.at(o), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(a), i;
    }
  }, {
    key: "getAllObjectName",
    value: function() {
      var i = this.imp.getAllObjectName(), a = new Ha(i);
      return ie.App.getImp().DestroyMdGeStringArray(i), a;
    }
  }, {
    key: "remove",
    value: function(i) {
      var a = xe.encodeToGb2312(i);
      return this.imp.remove(a);
    }
  }, {
    key: "addObject",
    value: function(i, a) {
      var s = xe.encodeToGb2312(i);
      return new Fe(this.imp.addObject(s, a.getImp()), rt.kMxCAD);
    }
  }, {
    key: "getAt",
    value: function(i) {
      var a = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1, s = xe.encodeToGb2312(i);
      return new Fe(this.imp.getAt(s, a), rt.kMxCAD);
    }
  }, {
    key: "setName",
    value: function(i, a) {
      return i = xe.encodeToGb2312(i), a = xe.encodeToGb2312(a), this.imp.setName(i, a);
    }
  }]), r;
}(Nr), Hc = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbXrecord()), i;
  }
  return Be(r, [{
    key: "setData",
    value: function(i) {
      return this.imp.setData(i.getImp());
    }
  }, {
    key: "getData",
    value: function() {
      return new vr(this.imp.getData());
    }
  }]), r;
}(Nr), Su = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = gn(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), n || i.initTempObject(new ie.mxcadassemblyimp.MdDbGroup()), i;
  }
  return Be(r, [{
    key: "description",
    get: function() {
      return xe.decodeFromGb2312(this.imp.description());
    },
    set: function(i) {
      this.imp.setDescription(xe.encodeToGb2312(i));
    }
  }, {
    key: "name",
    get: function() {
      return xe.decodeFromGb2312(this.imp.name());
    },
    set: function(i) {
      this.imp.setName(xe.encodeToGb2312(i));
    }
  }, {
    key: "isSelectable",
    get: function() {
      return this.imp.isSelectable();
    },
    set: function(i) {
      this.imp.setSelectable(i);
    }
  }, {
    key: "clear",
    value: function() {
      return this.imp.clear();
    }
  }, {
    key: "append",
    value: function(i) {
      return this.imp.append(i.id);
    }
  }, {
    key: "appendArray",
    value: function(i) {
      var a = new fa();
      return a.copyFormAryId(i), this.imp.appendArray(a.imp);
    }
  }, {
    key: "has",
    value: function(i) {
      return this.imp.has(i.id);
    }
  }, {
    key: "getAllEntityId",
    value: function() {
      for (var i = [], a = this.imp.getAllEntityId(), s = a.length(), o = 0; o < s; o++)
        i.push(new Fe(a.at(o), rt.kMxCAD));
      return ie.App.getImp().DestroyMdGeLongArray(a), i;
    }
  }, {
    key: "numEntities",
    value: function() {
      return this.imp.numEntities();
    }
  }]), r;
}(Nr);
function Rr(e, t, r, n) {
  var i = e - r, a = t - n, s = 0;
  return i == 0 ? s = Math.PI / 2 : s = Math.atan(Math.abs(a / i)), i < 0 && a >= 0 ? s = Math.PI - s : i < 0 && a < 0 ? s = Math.PI + s : i >= 0 && a < 0 && (s = Math.PI * 2 - s), s;
}
function l2(e, t, r) {
  var n = {
    x: (e.x + t.x) / 2,
    y: (e.y + t.y) / 2
  }, i = Math.sqrt(Math.pow(e.x - n.x, 2) + Math.pow(e.y - n.y, 2)) / Math.sin(r / 2), a = {
    x: t.x - e.x,
    y: t.y - e.y
  }, s = {
    x: a.x / Math.sqrt(Math.pow(a.x, 2) + Math.pow(a.y, 2)),
    y: a.y / Math.sqrt(Math.pow(a.x, 2) + Math.pow(a.y, 2))
  }, o = {
    x: -s.y,
    y: s.x
  }, u = n.x + i * o.x, l = n.y + i * o.y;
  return new te(u, l);
}
function yc() {
  var e = window.location.hostname;
  return e.substring(0, 4) != "http" && (e = document.location.protocol + "//" + e), e;
}
function jc(e, t, r) {
  var n = t.clone(), i = r.clone(), a = e.clone(), s = a.sub(n), o = i.sub(n), u = a.sub(i), l, c = s.crossProduct(o).length() / o.length(), f = s.dotProduct(o);
  return f < 0 ? l = s.length() : f > Math.pow(o.length(), 2) ? l = u.length() : l = c, Math.floor(l);
}
function ku(e, t) {
  for (var r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0, n = e.numVerts(), i = 0; i < e.numVerts(); i++) {
    var a = e.getPointAt(i).val, s = e.getPointAt(i + 1).val, o = e.getBulgeAt(i);
    if (o === 0) {
      if (i + 1 === n && e.isClosed && (s = e.getPointAt(0).val), s && jc(t, a, s) < r)
        return {
          start: a,
          end: s,
          startIndex: i,
          endIndex: i + 1,
          bulge: o
        };
    } else if (s) {
      var u = e.getParamAtPoint(a).val, l = e.getParamAtPoint(s).val, c = e.getParamAtPoint(t).val;
      if (l > c && c > u)
        return {
          start: a,
          end: s,
          startIndex: i,
          endIndex: i + 1,
          bulge: o
        };
    }
  }
  if (e.isClosed) {
    var f = e.getPointAt(0).val, h = e.getPointAt(e.numVerts() - 1).val, d = e.getBulgeAt(e.numVerts() - 1);
    if (jc(t, h, f) < r)
      return {
        start: h,
        end: f,
        startIndex: e.numVerts() - 1,
        endIndex: 0,
        isClosed: !0,
        bulge: d
      };
  }
}
function Zy(e, t) {
  var r = e.r, n = e.g, i = e.b;
  r *= t, n *= t, i *= t, e.r = Math.max(Math.min(r, 1), 0), e.g = Math.max(Math.min(n, 1), 0), e.b = Math.max(Math.min(i, 1), 0);
}
function Mi(e, t, r, n) {
  var i = jc(n, e, r), a = jc(n, t, r);
  return isNaN(a) ? !0 : isNaN(i) ? !1 : a === i ? r.distanceTo(e) > r.distanceTo(t) : i < a;
}
function bc(e, t, r, n, i, a, s) {
  var o = arguments.length > 7 && arguments[7] !== void 0 ? arguments[7] : !0, u = new st(), l = e.endPoint.sub(e.startPoint).normalize().mult(a), c = t.endPoint.sub(t.startPoint).normalize().mult(s);
  if (n) {
    l.negate();
    var f = r.clone().addvec(l);
    o && (e.endPoint = f), u.startPoint = f.clone();
  } else {
    var h = r.clone().addvec(l);
    o && (e.startPoint = h), u.startPoint = h.clone();
  }
  if (i) {
    c.negate();
    var d = r.clone().addvec(c);
    o && (t.endPoint = d), u.endPoint = d.clone();
  } else {
    var g = r.clone().addvec(c);
    o && (t.startPoint = g), u.endPoint = g.clone();
  }
  if (!(a <= 0 && s <= 0))
    return u;
}
function Cl(e, t, r, n, i, a) {
  var s = arguments.length > 6 && arguments[6] !== void 0 ? arguments[6] : !0, o = arguments.length > 7 && arguments[7] !== void 0 ? arguments[7] : !1, u = t.startPoint, l = t.endPoint, c = r.startPoint, f = r.endPoint, h = n.sub(i ? u : l), d = n.sub(a ? c : f), g = Math.tan(h.angleTo1(d) / 2), v = e / g, m = bc(t, r, n, i, a, o ? 0 : v, o ? 0 : v, s);
  if (!m) return {
    segmentLine: m,
    chamferDist: v
  };
  var p = m.startPoint.sub(n).perpVector(), y = m.endPoint.sub(n).perpVector();
  m.endPoint.addvec(y);
  var w = new st(m.startPoint, m.startPoint.clone().addvec(p)).IntersectWith(new st(m.endPoint, m.endPoint.clone().addvec(y)), Ie.Intersect.kExtendBoth);
  if (!w.isEmpty()) {
    var x = w.at(0), b = x.clone().addvec(n.sub(x).normalize().mult(e)), M = new Di(), k = Bt.calcBulge(m.startPoint, b, m.endPoint).val;
    return M.computeArc(m.startPoint.x, m.startPoint.y, b.x, b.y, m.endPoint.x, m.endPoint.y), {
      arc: M,
      bulge: k,
      segmentLine: m,
      chamferDist: v,
      center: x,
      midPoint: b
    };
  }
}
function j0(e, t) {
  return (t.y - e.y) / (t.x - e.x);
}
function Jy(e, t) {
  var r = j0(e.startPoint, e.endPoint), n = j0(t.startPoint, t.endPoint);
  return isNaN(r) && isNaN(n) ? e.startPoint.x === t.startPoint.x : r === n;
}
function c2(e, t, r) {
  var n = e.distanceTo(t), i = n / 2, a = i * r, s = (i * i + a * a) / (2 * a), o = (e.x + t.x) / 2, u = (e.y + t.y) / 2;
  return new te(o, u).addvec(t.clone().sub(e).perpVector().normalize().mult(s - a));
}
var f2 = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "serverUrl", ""), le(this, "mapFun", {});
  }
  return Be(e, [{
    key: "init",
    value: function(r) {
      r.substring(0, 16) == "http://localhost" && (r = yc() + r.substring(16)), this.serverUrl = r;
    }
  }, {
    key: "addFunction",
    value: function(r, n) {
      this.mapFun[r] = n;
    }
  }, {
    key: "registTool",
    value: function(r) {
      if (this.serverUrl.length != 0) {
        var n = new XMLHttpRequest(), i = this.serverUrl + "/add_toolfun";
        n.open("POST", i), n.setRequestHeader("Content-Type", "application/json"), n.send(JSON.stringify(r)), n.onreadystatechange = function() {
          n.readyState === 4 && n.status === 200 && console.log(n.responseText);
        };
      }
    }
  }, {
    key: "reloadTools",
    value: function(r) {
      if (this.serverUrl.length != 0) {
        var n = new XMLHttpRequest(), i = this.serverUrl + "/reload_toolfun";
        n.open("POST", i), n.setRequestHeader("Content-Type", "application/json"), n.send(JSON.stringify(r)), n.onreadystatechange = function() {
          n.readyState === 4 && n.status === 200 && console.log(n.responseText);
        };
      }
    }
  }, {
    key: "chat_tool",
    value: function(r) {
      if (this.serverUrl.length != 0) {
        var n = this, i = {
          text: r
        }, a = new XMLHttpRequest(), s = this.serverUrl + "/post";
        a.open("POST", s), a.setRequestHeader("Content-Type", "application/json"), a.send(JSON.stringify(i)), a.onreadystatechange = function() {
          if (a.readyState === 4 && a.status === 200)
            try {
              var o = JSON.parse(a.responseText), u = o.results;
              u && u.name && n.mapFun[u.name] && n.mapFun[u.name](u.parameters);
            } catch (l) {
              console.log(l);
            }
        };
      }
    }
  }]), e;
}(), h2 = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "mapCppCall", {}), le(this, "currentOptNum", 1);
  }
  return Be(e, [{
    key: "init",
    value: function() {
      var r = window, n = this;
      r.loadFonts_complete = function(i) {
        n.mapCppCall[i] && (n.mapCppCall[i](), delete n.mapCppCall[i]);
      };
    }
  }, {
    key: "loadFonts",
    value: function(r, n, i, a) {
      if (r.length == 0 && n.length == 0 && i.length == 0) {
        a();
        return;
      }
      var s = new Ha();
      r.forEach(function(o) {
        s.append(o);
      }), n.forEach(function(o) {
        s.append("{big}" + o);
      }), i.forEach(function(o) {
        s.append("{font}" + o);
      }), this.currentOptNum++, this.mapCppCall[this.currentOptNum] = a, ie.App.getImp().loadFonts(s.imp, this.currentOptNum);
    }
  }]), e;
}(), X0 = new h2(), Ov = /* @__PURE__ */ function(e) {
  return e[e.EMSCRIPTEN_FETCH_LOAD_TO_MEMORY = 1] = "EMSCRIPTEN_FETCH_LOAD_TO_MEMORY", e[e.EMSCRIPTEN_FETCH_PERSIST_FILE = 4] = "EMSCRIPTEN_FETCH_PERSIST_FILE", e[e.EMSCRIPTEN_FETCH_APPEND = 8] = "EMSCRIPTEN_FETCH_APPEND", e[e.EMSCRIPTEN_FETCH_REPLACE = 16] = "EMSCRIPTEN_FETCH_REPLACE", e;
}(Ov || {}), pl = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", void 0), le(this, "event", {}), le(this, "currentFileName", ""), le(this, "currentOriginalFileName", ""), le(this, "firstTimeOpenFile", !0), le(this, "authorized_service", ""), le(this, "isInitMxObject", !1), this.imp = t;
  }
  return Be(e, [{
    key: "creaeCallId",
    value: function() {
      return Math.round(Math.random() * 1e7);
    }
  }, {
    key: "setAttribute",
    value: function(r) {
      return this.imp.setAttribute(JSON.stringify(r));
    }
  }, {
    key: "getMxDrawObject",
    value: function() {
      return this.imp.mxdrawObject;
    }
  }, {
    key: "mxdraw",
    get: function() {
      return this.imp.mxdrawObject;
    }
  }, {
    key: "getImp",
    value: function() {
      return this.imp;
    }
  }, {
    key: "init",
    value: function(r) {
      this.imp = r;
    }
  }, {
    key: "create",
    value: function(r) {
      eh(r, this);
    }
  }, {
    key: "on",
    value: function(r, n) {
      if (this.event[r])
        if (this.event[r] instanceof Array)
          this.event[r].includes(n) || this.event[r].push(n);
        else {
          var i = this.event[r];
          if (i == n) return;
          this.event[r] = [], this.event[r].push(i), this.event[r].push(n);
        }
      else
        this.event[r] = n;
      this.isInitMxObject && (this.event = this.synchronizeMxDrawEvent(this.event));
    }
  }, {
    key: "off",
    value: function(r, n) {
      if (this.event[r])
        if (!n)
          this.event[r] = [];
        else if (this.event[r] instanceof Array) {
          var i = this.event[r].indexOf(n);
          if (i < 0) return;
          this.event[r].splice(i, 1);
        } else
          this.event[r] === n && (this.event[r] = []);
    }
  }, {
    key: "callEvent",
    value: function(r, n) {
      try {
        var i = this.event[r];
        if (!i) return !1;
        if (i instanceof Array) {
          var a = !1;
          return i.forEach(function(s) {
            a = s(n);
          }), a;
        } else
          return i(n);
      } catch (s) {
        throw console.log(s), s;
      }
    }
  }, {
    key: "synchronizeMxDrawEvent",
    value: function(r) {
      var n = this.getMxDrawObject().getMxObjectImplement(), i = {
        selectChange: !0,
        openFileComplete: !0,
        init: !0,
        init_mxdraw: !0,
        init_mxcad: !0,
        init_before_mxdraw: !0
      }, a = {};
      for (var s in r) {
        var o = r[s];
        if (i[s]) {
          a[s] = o;
          continue;
        }
        o instanceof Array ? o.forEach(function(u) {
          n.addEvent(s, u);
        }) : n.addEvent(s, o);
      }
      return a;
    }
  }, {
    key: "initMxObject",
    value: function(r) {
      var n = this;
      this.isInitMxObject = !0, r.tmp || (r.tmp = new lw(r)), this.imp.mxdrawObject = r.tmp, r.addEvent("selectChange", function(a) {
        var s = [];
        a.forEach(function(u) {
          s.push(new Fe(u, rt.kMxCAD));
        });
        var o = r.getMxAllSelect();
        o.forEach(function(u) {
          s.push(new Fe(u, rt.kMxDraw));
        }), n.callEvent("selectChange", s);
      }), r.addEvent("mxdrawSelectChange", function(a) {
        var s = [];
        a.forEach(function(u) {
          s.push(new Fe(u, rt.kMxDraw));
        });
        var o = r.getMxCADAllSelect();
        o.forEach(function(u) {
          s.push(new Fe(u, rt.kMxCAD));
        }), n.callEvent("selectChange", s);
      });
      var i = this;
      r.addEvent("openFileComplete", function() {
        n.callEvent("openFileComplete", i);
      }), this.event = this.synchronizeMxDrawEvent(this.event);
    }
  }, {
    key: "regen",
    value: function() {
      var r = this, n = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0;
      n <= 0 ? this.imp.regen() : setTimeout(function() {
        r.imp.regen(), r.updateDisplay(!1);
      }, n);
    }
  }, {
    key: "zoomAll",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !1, n = this.database.currentSpace.getBoundingBox();
      if (!n.ret) return !1;
      var i = this.getMxDrawObject();
      return i.zoomW(n.minPt.toVector3(), n.maxPt.toVector3(), void 0, void 0, r), !0;
    }
  }, {
    key: "zoomScale",
    value: function(r) {
      this.getMxDrawObject().zoomScale(r);
    }
  }, {
    key: "addCurrentSelect",
    value: function(r) {
      var n = this, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
      if (r instanceof Array) {
        var a = !1, s = !1;
        r.forEach(function(o) {
          o.type == rt.kMxDraw ? n.getMxDrawObject().addMxCurrentSelect(o.id, !1, i) && (a = !0) : o.type == rt.kMxCAD && n.getMxDrawObject().addMxCADCurrentSelect(o.id, !1, i) && (s = !0);
        }), a && this.getMxDrawObject().fireSelectChange(!1), s && this.getMxDrawObject().fireSelectChange(!0);
      } else
        r.type == rt.kMxDraw ? this.getMxDrawObject().addMxCurrentSelect(r.id, !0, i) : r.type == rt.kMxCAD && this.getMxDrawObject().addMxCADCurrentSelect(r.id, !0, i);
    }
  }, {
    key: "clearMxCurrentSelect",
    value: function() {
      this.getMxDrawObject().clearMxCurrentSelect();
    }
  }, {
    key: "zoomW",
    value: function(r, n) {
      var i = this.getMxDrawObject();
      i.zoomW(r.toVector3(), n.toVector3());
    }
  }, {
    key: "zoomCenter",
    value: function(r, n) {
      var i = this.getMxDrawObject();
      i.zoomCenter(r, n);
    }
  }, {
    key: "zoomAngle",
    value: function(r) {
      var n = this.getMxDrawObject();
      n.setViewAngle(r), this.updateDisplay(!1, 100);
    }
  }, {
    key: "openWebFile",
    value: function(r, n) {
      var i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0, a = arguments.length > 3 ? arguments[3] : void 0, s = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : 0, o = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : !0, u = this.imp.mxdrawObject, l = Math.round(Math.random() * 1e7);
      if (n) {
        var c = window;
        c["mx_exception handling"] = function() {
          c["mx_exception handling"] = void 0, n(-10);
        };
        var f = function y(w, x) {
          l == x && (c["mx_exception handling"] = void 0, u.removeEventFuction("openFileComplete", y), n(w));
        };
        u.addEvent("openFileComplete", f);
      }
      this.currentFileName = r.split("/").pop(), this.currentOriginalFileName = this.currentFileName;
      var h = "";
      a && (h = JSON.stringify(a)), this.firstTimeOpenFile || this.getMxDrawObject().clearAllObject(), this.firstTimeOpenFile = !1;
      var d = ie.App.getImp().getCodeVersion();
      if (d == 3) {
        var g = "";
        if (this.authorized_service.length != 0)
          if (this.authorized_service == "same_current_page_url") {
            var v = window.location.port;
            v == "80" ? g = yc() + "/create_app_param" : g = yc() + ":" + v + "/create_app_param";
          } else
            g = this.authorized_service;
        else
          g = yc() + ":3090/create_app_param";
        var m = this, p = new XMLHttpRequest();
        return p.open("POST", g), p.setRequestHeader("Content-Type", "application/json"), p.onreadystatechange = function() {
          p.status === 200 ? p.readyState === 4 && (!p.responseText || p.responseText.length == 0 ? (m.imp.openWebFile("", i, l, h, s, o), console.log("MxTip:authorized service retrun error!")) : m.imp.openWebFile(p.responseText, i, l, h, s, o)) : (m.imp.openWebFile("", i, l, h, s, o), console.log("MxTip:authorized service net error!"));
        }, p.send(JSON.stringify({
          param: ie.App.getImp().createAppParam(r)
        })), !0;
      } else
        return this.imp.openWebFile(r, i, l, h, s, o);
    }
  }, {
    key: "newFile",
    value: function() {
      this.currentFileName = "", this.currentOriginalFileName = "";
      var r = this.getMxDrawObject();
      return r.clearAllObject(), r.clearMxCurrentSelect(), this.imp.newFile();
    }
  }, {
    key: "insertBlock",
    value: function(r, n) {
      var i = this, a = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0, s = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 0, o = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : !1, u = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : !1, l = this.imp.mxdrawObject, c = Math.round(Math.random() * 1e7);
      return new Promise(function(f) {
        var h = function g(v) {
          (!v || v.length == 0) && f(new Fe());
          var m = JSON.parse(v);
          m.callid == c && (l.removeEventFuction("insertBlockComplete", g), m.result != 0 && console.log("insertBlock result:" + m.result), f(new Fe(m.blkrecid, rt.kMxCAD)));
        };
        l.addEvent("insertBlockComplete", h);
        var d = "";
        i.imp.insertBlock(r, xe.encodeToGb2312(n), a, c, d, s, o, u);
      });
    }
  }, {
    key: "getCurrentFileName",
    value: function() {
      return this.currentFileName;
    }
  }, {
    key: "setCurrentFileName",
    value: function(r) {
      this.currentFileName = r;
    }
  }, {
    key: "getCurrentOriginaFileName",
    value: function() {
      return this.currentOriginalFileName;
    }
  }, {
    key: "setCurrentOriginaFileName",
    value: function(r) {
      this.currentOriginalFileName = r;
    }
  }, {
    key: "saveFileToUrl",
    value: function(r, n, i, a) {
      var s = this.imp.saveFileToMemory();
      if (s.getSize() == 0)
        return n(-1, "save failed"), !1;
      var o = s.getData(), u = s.getSize(), l = ie.mxcadassemblyimp.HEAPU8, c = l.subarray(o, o + u), f = new ArrayBuffer(s.getSize()), h = new Uint8Array(f);
      return h.set(c), s.clear(), mu.postMemoryFile(h, r, i || "temp.mxweb", n, a), !0;
    }
  }, {
    key: "saveFile",
    value: function(r, n) {
      var i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0, a = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : !0, s = arguments.length > 4 ? arguments[4] : void 0;
      r || (r = this.getCurrentFileName(), r.length == 0 && (r = "temp_empty.mxweb")), (r.indexOf(".") == -1 || r.substring(r.length - 6) != ".mxweb") && (r += ".mxweb");
      var o = window;
      o.mx_saveFile_call = function(l) {
        if (n && n(l), !!l) {
          if (i) {
            var c, f = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
            f ? c = new Blob([l.buffer], {
              type: "application/octet-stream"
            }) : c = new Blob([l.buffer], {
              type: "application/octet-binary"
            }), a ? mu.saveAsFileDialog({
              blob: c,
              filename: r,
              types: [{
                description: "mxweb File",
                accept: {
                  "application/octet-stream": [".mxweb"]
                }
              }]
            }) : mu.downloadFile(c, r);
          }
          o.mx_saveFile_call = null;
        }
      };
      var u = "";
      return s && (u = JSON.stringify(s)), this.imp.saveFile(r, u);
    }
  }, {
    key: "getDatabase",
    value: function() {
      return this.imp.McDbDatabase || (this.imp.McDbDatabase = new Va(this.imp.GetDatabase())), this.imp.McDbDatabase;
    }
  }, {
    key: "database",
    get: function() {
      return this.getDatabase();
    }
  }, {
    key: "setBrowse",
    value: function(r) {
      this.imp.setBrowse(r), r && Ue.setIniset({
        ForbiddenDynInput: !0
      });
    }
  }, {
    key: "getSysVarString",
    value: function(r) {
      return this.imp.GetSysVarString(r);
    }
  }, {
    key: "setSysVarString",
    value: function(r, n) {
      return this.imp.SetSysVarString(r, n);
    }
  }, {
    key: "getSysVarDouble",
    value: function(r) {
      return this.imp.GetSysVarDouble(r);
    }
  }, {
    key: "getSysVarPoint",
    value: function(r) {
      return new te(this.imp.GetSysVarPoint(r));
    }
  }, {
    key: "setSysVarPoint",
    value: function(r, n) {
      return this.imp.SetSysVarPoint(r, n.imp, !1);
    }
  }, {
    key: "setSysVarPoint2d",
    value: function(r, n) {
      return this.imp.SetSysVarPoint(r, n.imp, !0);
    }
  }, {
    key: "setSysVarDouble",
    value: function(r, n) {
      return this.imp.SetSysVarDouble(r, n);
    }
  }, {
    key: "getSysVarLong",
    value: function(r) {
      return this.imp.GetSysVarLong(r);
    }
  }, {
    key: "setSysVarLong",
    value: function(r, n) {
      return this.imp.SetSysVarLong(r, n);
    }
  }, {
    key: "drawColor",
    get: function() {
      return new fr(this.imp.GetDrawColor());
    },
    set: function(r) {
      this.imp.SetDrawColor(r.getImp());
    }
  }, {
    key: "drawColorIndex",
    get: function() {
      return this.imp.GetDrawColor().colorIndex;
    },
    set: function(r) {
      var n = new fr();
      n.setColorIndex(r), this.imp.SetDrawColor(n.getImp());
    }
  }, {
    key: "drawLineWeight",
    get: function() {
      return this.imp.GetDrawLineWeight();
    },
    set: function(r) {
      this.imp.SetDrawLineWeight(r);
    }
  }, {
    key: "drawLineTypeScale",
    get: function() {
      return this.imp.GetDrawLineTypeScale();
    },
    set: function(r) {
      this.imp.SetDrawLineTypeScale(r);
    }
  }, {
    key: "drawLinetype",
    get: function() {
      return xe.decodeFromGb2312(this.imp.GetDrawLinetype());
    },
    set: function(r) {
      this.imp.SetDrawLinetype(xe.encodeToGb2312(r));
    }
  }, {
    key: "drawTextStyle",
    get: function() {
      return xe.decodeFromGb2312(this.imp.GetDrawTextStyle());
    },
    set: function(r) {
      this.imp.SetDrawTextStyle(xe.encodeToGb2312(r));
    }
  }, {
    key: "drawLayer",
    get: function() {
      return xe.decodeFromGb2312(this.imp.GetDrawLayer());
    },
    set: function(r) {
      this.imp.SetDrawLayer(xe.encodeToGb2312(r));
    }
  }, {
    key: "addLayer",
    value: function(r) {
      return new Fe(this.imp.AddLayer(xe.encodeToGb2312(r)));
    }
  }, {
    key: "addTextStyle",
    value: function(r, n, i) {
      var a = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 1;
      return new Fe(this.imp.AddTextStyle(xe.encodeToGb2312(r), xe.encodeToGb2312(n), xe.encodeToGb2312(i), a));
    }
  }, {
    key: "AddTureTypeTextStyle",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "", i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 1;
      return new Fe(this.imp.AddTureTypeTextStyle(xe.encodeToGb2312(r), xe.encodeToGb2312(n), i));
    }
  }, {
    key: "addLinetype",
    value: function(r, n) {
      return new Fe(this.imp.AddLinetype(xe.encodeToGb2312(r), xe.encodeToGb2312(n)));
    }
  }, {
    key: "addLinetypeEx",
    value: function(r, n) {
      var i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "";
      return new Fe(this.imp.AddLinetypeEx(xe.encodeToGb2312(r), xe.encodeToGb2312(n), xe.encodeToGb2312(i)));
    }
  }, {
    key: "drawLine",
    value: function(r, n, i, a) {
      return new Fe(this.imp.DrawLine(r, n, 0, i, a, 0));
    }
  }, {
    key: "drawLine3d",
    value: function(r, n, i, a, s, o) {
      return new Fe(this.imp.DrawLine(r, n, i, a, s, o));
    }
  }, {
    key: "addDimStyle",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.AddDimStyle(xe.encodeToGb2312(r), xe.encodeToGb2312(n), xe.encodeToGb2312(i), xe.encodeToGb2312(a), xe.encodeToGb2312(s)));
    }
  }, {
    key: "drawDimStyle",
    get: function() {
      return xe.decodeFromGb2312(this.imp.GetDrawDimStyle());
    },
    set: function(r) {
      this.imp.SetDrawDimStyle(xe.encodeToGb2312(r));
    }
  }, {
    key: "pathMakeExclude",
    value: function(r) {
      this.imp.PathMakeExclude(r);
    }
  }, {
    key: "addPatternDefinition",
    value: function(r, n) {
      this.imp.AddPatternDefinition(xe.encodeToGb2312(r), n);
    }
  }, {
    key: "drawPatternDefinition",
    get: function() {
      return xe.decodeFromGb2312(this.imp.GetPatternDefinition());
    },
    set: function(r) {
      this.imp.SetPatternDefinition(xe.encodeToGb2312(r));
    }
  }, {
    key: "drawLineWidth",
    get: function() {
      return this.imp.GetDrawLineWidth();
    },
    set: function(r) {
      this.imp.SetDrawLineWidth(r);
    }
  }, {
    key: "drawUseDefaultProperties",
    get: function() {
      return this.imp.GetDrawUseDefaultProperties();
    },
    set: function(r) {
      this.imp.SetDrawUseDefaultProperties(r);
    }
  }, {
    key: "drawArc",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawArc(r, n, i, a, s));
    }
  }, {
    key: "drawArc2",
    value: function(r, n, i, a, s, o) {
      return new Fe(this.imp.DrawArc2(r, n, i, a, s, o));
    }
  }, {
    key: "drawArc3",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawArc3(r, n, i, a, s));
    }
  }, {
    key: "drawCircle",
    value: function(r, n, i) {
      return new Fe(this.imp.DrawCircle(r, n, i));
    }
  }, {
    key: "loadImage",
    value: function(r, n) {
      var i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "";
      this.imp.mxdrawObject.getMxObjectImplement().loadMxCADImage(r, n, i);
    }
  }, {
    key: "drawImage",
    value: function(r, n, i, a, s, o) {
      var u = arguments.length > 6 && arguments[6] !== void 0 ? arguments[6] : !1, l = arguments.length > 7 && arguments[7] !== void 0 ? arguments[7] : 1, c = arguments.length > 8 && arguments[8] !== void 0 ? arguments[8] : 1;
      return new Fe(this.imp.DrawImage(r, n, i, a, s, xe.encodeToGb2312(o), u, l, c));
    }
  }, {
    key: "addImageDefine",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "", i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1;
      return new Fe(this.imp.addImageDefine(xe.encodeToGb2312(r), xe.encodeToGb2312(n), i));
    }
  }, {
    key: "showLineWeight",
    value: function(r) {
      var n = this.imp.showLineWeight(r);
      return this.updateDisplay(!1), n;
    }
  }, {
    key: "loadDwgBackground",
    value: function(r, n) {
      var i = this, a = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0, s = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : !0, o = this.creaeCallId(), u = this.imp.mxdrawObject, l = function c(f) {
        f = JSON.parse(f), f.callid == o && (u.removeEventFuction("load_dwg_gackground_result", c), n(f.l_param == 1), f.l_param == 1 && s && i.regen(100));
      };
      u.addEvent("load_dwg_gackground_result", l), this.imp.loadDwgBackground(r, a, o, s);
    }
  }, {
    key: "getBackgroundEntity",
    value: function() {
      return new Fv(this.imp.GetBackgroundEntity());
    }
  }, {
    key: "clearDwgBackground",
    value: function() {
      this.getBackgroundEntity().clearAll();
    }
  }, {
    key: "addSystemVarNameForEvent",
    value: function(r) {
      var n = this;
      r.forEach(function(i) {
        n.imp.addSystemVarNameForEvent(i);
      });
    }
  }, {
    key: "drawEllipse",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawEllipse(r, n, i, a, s));
    }
  }, {
    key: "drawEllipseArc",
    value: function(r, n, i, a, s, o, u) {
      return new Fe(this.imp.DrawEllipseArc(r, n, i, a, s, o, u));
    }
  }, {
    key: "drawPoint",
    value: function(r, n) {
      return new Fe(this.imp.DrawPoint(r, n));
    }
  }, {
    key: "drawSolid",
    value: function(r, n, i, a, s, o, u, l) {
      return new Fe(this.imp.DrawSolid(r, n, i, a, s, o, u, l));
    }
  }, {
    key: "drawMText",
    value: function(r, n, i, a, s, o, u) {
      return new Fe(this.imp.DrawMText(r, n, xe.encodeToGb2312(i), a, s, o, u));
    }
  }, {
    key: "drawText",
    value: function(r, n, i, a, s, o, u) {
      return new Fe(this.imp.DrawText(r, n, xe.encodeToGb2312(i), a, s, o, u));
    }
  }, {
    key: "drawBlockReference",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawBlockReference(r, n, xe.encodeToGb2312(i), a, s));
    }
  }, {
    key: "drawDimAligned",
    value: function(r, n, i, a, s, o) {
      return new Fe(this.imp.DrawDimAligned(r, n, i, a, s, o));
    }
  }, {
    key: "drawDimAngular",
    value: function(r, n, i, a, s, o, u, l) {
      return new Fe(this.imp.DrawDimAngular(r, n, i, a, s, o, u, l));
    }
  }, {
    key: "drawDimDiametric",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawDimDiametric(r, n, i, a, s));
    }
  }, {
    key: "drawDimRotated",
    value: function(r, n, i, a, s, o, u) {
      return new Fe(this.imp.DrawDimRotated(r, n, i, a, s, o, u));
    }
  }, {
    key: "drawDimOrdinate",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawDimOrdinate(r, n, i, a, s));
    }
  }, {
    key: "drawDimRadial",
    value: function(r, n, i, a, s) {
      return new Fe(this.imp.DrawDimRadial(r, n, i, a, s));
    }
  }, {
    key: "pathMoveTo",
    value: function(r, n) {
      this.imp.PathMoveTo(r, n);
    }
  }, {
    key: "pathMoveToEx",
    value: function(r, n, i, a, s) {
      this.imp.PathMoveToEx(r, n, i, a, s);
    }
  }, {
    key: "pathLineTo",
    value: function(r, n) {
      this.imp.PathLineTo(r, n);
    }
  }, {
    key: "pathLineToEx",
    value: function(r, n, i, a, s) {
      this.imp.PathLineToEx(r, n, i, a, s);
    }
  }, {
    key: "pathCircle",
    value: function(r, n, i) {
      var a = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : 0, s = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : 0;
      return this.imp.PathCircle(r, n, i, a, s);
    }
  }, {
    key: "drawPathToPolyline",
    value: function() {
      return new Fe(this.imp.DrawPathToPolyline());
    }
  }, {
    key: "drawPathToSpline",
    value: function() {
      return new Fe(this.imp.DrawPathToSpline());
    }
  }, {
    key: "pathMakeClosed",
    value: function() {
      this.imp.PathMakeClosed();
    }
  }, {
    key: "drawPathToHatch",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 1;
      return new Fe(this.imp.DrawPathToHatch(r));
    }
  }, {
    key: "drawEntity",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1, i = r.syncData(!0), a = new Fe(this.imp.DrawEntity(r.getImp(), n));
      return i && Pr.getObjectFormId(a), a;
    }
  }, {
    key: "drawHatch",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 1;
      return new Fe(this.imp.DrawHatch(r.getImp(), n));
    }
  }, {
    key: "objectIdToObject",
    value: function(r) {
      return ie.App.objectIdToObject(r);
    }
  }, {
    key: "destroyObject",
    value: function(r) {
      r && ie.App.getImp().DestroyObject(r);
    }
  }, {
    key: "getAllLayoutName",
    value: function() {
      return new Ha(this.imp.GetAllLayoutName());
    }
  }, {
    key: "setCurrentLayout",
    value: function(r) {
      return this.imp.SetCurrentLayout(xe.encodeToGb2312(r));
    }
  }, {
    key: "getCurrentLayout",
    value: function() {
      return xe.decodeFromGb2312(this.imp.GetCurrentLayout());
    }
  }, {
    key: "getCurrentLayoutId",
    value: function() {
      return new Fe(this.imp.GetCurrentLayout());
    }
  }, {
    key: "getMxCpp",
    value: function() {
      return ie;
    }
  }, {
    key: "getViewCADCoord",
    value: function() {
      var r = this.getMxDrawObject().getViewDocCoord();
      return {
        pt1: new te(r.pt1),
        pt2: new te(r.pt2),
        pt3: new te(r.pt3),
        pt4: new te(r.pt4)
      };
    }
  }, {
    key: "updateDisplay",
    value: function() {
      var r = this, n = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !1, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
      i <= 0 ? this.imp.mxdrawObject.updateDisplay(n) : setTimeout(function() {
        r.imp.mxdrawObject.updateDisplay(n);
      }, i);
    }
  }, {
    key: "updateLayerDisplayStatus",
    value: function() {
      this.imp.UpdateLayerDisplayStatus();
    }
  }, {
    key: "initRegist",
    value: function(r) {
      this.imp.initRegist(r);
    }
  }, {
    key: "iniAuthorizedService",
    value: function(r) {
      this.imp.initAuthorizedService(r), this.authorized_service = r;
    }
  }, {
    key: "isTryVersion",
    value: function() {
      return this.imp.isTryVersion();
    }
  }, {
    key: "setViewBackgroundColor",
    value: function(r, n, i) {
      var a = this.getMxDrawObject();
      return a && (r && n && i ? a.setViewColor(r << 16 | n << 8 | i) : a.setViewColor(r)), r && n && i ? this.imp.setViewBackgroundColor(r, n, i) : this.imp.setViewBackgroundColor((r & 16711680) >> 16, (r & 65280) >> 8, r & 255);
    }
  }, {
    key: "getViewBackgroundColor",
    value: function() {
      return this.imp.getViewBackgroundColor();
    }
  }, {
    key: "getCurrentDatabaseDrawColor",
    value: function() {
      var r = this.getDatabase().getImp().GetCurrentlyDrawColor(), n = this.getMxDrawObject().isWhiteViewColor(), i = r.at(0), a = r.at(1), s = r.at(2);
      n ? i == 255 && a == 255 && s == 255 && (i = 0, a = 0, s = 0) : i == 0 && a == 0 && s == 0 && (i = 255, a = 255, s = 255);
      var o = new THREE.Color();
      return o.setRGB(i / 255, a / 255, s / 255), o;
    }
  }, {
    key: "undo",
    value: function() {
      this.imp.undo(), this.updateDisplay(!1);
    }
  }, {
    key: "redo",
    value: function() {
      this.imp.redo(), this.updateDisplay();
    }
  }, {
    key: "undoMark",
    value: function() {
      this.imp.undoMark();
    }
  }, {
    key: "undoIndexIncrease",
    value: function() {
      this.imp.undoIndexIncrease();
    }
  }]), e;
}(), Nv = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "imp", void 0), le(this, "MxCADAssist", void 0), le(this, "objectIdToObjectCalls", {}), le(this, "classNameToCreateCalls", {}), le(this, "shxFonts", ["txt.shx"]), le(this, "shxBigFonts", ["hztxt.shx"]), le(this, "trueFonts", {
      syadobe: {
        name: "syadobe",
        zhname: "",
        file: "syadobe.otf"
      }
    }), le(this, "dMcGeBakTol", -1);
  }
  return Be(e, [{
    key: "init",
    value: function(r) {
      this.imp = r, Ve.kZAxis = new Ve(0, 0, 1), Ve.kNegateZAxis = new Ve(0, 0, -1), Ve.kXAxis = new Ve(1, 0, 0), Ve.kYAxis = new Ve(0, 1, 0), Ve.kIdentity = new Ve(0, 0, 0), te.kOrigin = new te(0, 0, 0), Jr.kIdentity = new Jr(), this.MxCADAssist = new ie.mxcadassemblyimp.MxDrawAssist(), this.initCalls(), X0.init();
    }
  }, {
    key: "setImp",
    value: function(r) {
      this.imp = r;
    }
  }, {
    key: "getImp",
    value: function() {
      return this.imp;
    }
  }, {
    key: "getLastCallResult",
    value: function() {
      return this.imp.getLastCallResult();
    }
  }, {
    key: "destroyObject",
    value: function(r) {
      this.imp.DestroyObject(r);
    }
  }, {
    key: "getCurrentMxCAD",
    value: function() {
      var r = this.imp.GetCurrentMxDraw();
      return r.McObject || (r.McObject = new pl(this.imp.GetCurrentMxDraw())), r.McObject;
    }
  }, {
    key: "mcedRGB2Index",
    value: function(r, n, i) {
      var a = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : !0;
      return this.imp.mcedRGB2Index(r, n, i, a);
    }
  }, {
    key: "setDefaultViewBackgroundColor",
    value: function(r, n, i) {
      return this.imp.setDefaultViewBackgroundColor(r, n, i);
    }
  }, {
    key: "objectIdIsKindOf",
    value: function(r, n) {
      return this.imp.ObjectIdIsKindOf(r, n);
    }
  }, {
    key: "initCalls",
    value: function() {
      var r = this;
      this.objectIdToObjectCalls.McDbCurve = function(n) {
        return new Zr(r.imp.ObjectIdToMdDbCurve(n));
      }, this.objectIdToObjectCalls.McDbEntity = function(n) {
        return new xr(r.imp.ObjectIdToMdDbEntity(n));
      }, this.objectIdToObjectCalls.McDbDimension = function(n) {
        return new ta(r.imp.ObjectIdToMdDbDimension(n));
      }, this.classNameToCreateCalls.McDbDimension = function() {
        return new ta();
      }, this.objectIdToObjectCalls.McDbLine = function(n) {
        return new st(r.imp.ObjectIdToMdDbLine(n));
      }, this.classNameToCreateCalls.McDbLine = function() {
        return new st();
      }, this.objectIdToObjectCalls.McDbText = function(n) {
        return new ps(r.imp.ObjectIdToMdDbText(n));
      }, this.classNameToCreateCalls.McDbText = function() {
        return new ps();
      }, this.objectIdToObjectCalls.McDbAttribute = function(n) {
        return new Tc(r.imp.ObjectIdToMdDbAttribute(n));
      }, this.classNameToCreateCalls.McDbAttribute = function() {
        return new Tc();
      }, this.objectIdToObjectCalls.McDbAttributeDefinition = function(n) {
        return new Sc(r.imp.ObjectIdToMdDbAttributeDefinition(n));
      }, this.classNameToCreateCalls.McDbAttributeDefinition = function() {
        return new Sc();
      }, this.objectIdToObjectCalls.McDbPolyline = function(n) {
        return new ot(r.imp.ObjectIdToMdDbPolyline(n));
      }, this.classNameToCreateCalls.McDbPolyline = function() {
        return new ot();
      }, this.objectIdToObjectCalls.McDbCircle = function(n) {
        return new zr(r.imp.ObjectIdToMdDbCircle(n));
      }, this.classNameToCreateCalls.McDbCircle = function() {
        return new zr();
      }, this.objectIdToObjectCalls.McDbArc = function(n) {
        return new Di(r.imp.ObjectIdToMdDbArc(n));
      }, this.classNameToCreateCalls.McDbArc = function() {
        return new Di();
      }, this.objectIdToObjectCalls.McDbBlockReference = function(n) {
        return new wo(r.imp.ObjectIdToMdDbBlockReference(n));
      }, this.classNameToCreateCalls.McDbBlockReference = function() {
        return new wo();
      }, this.objectIdToObjectCalls.McDbSpatialFilter = function(n) {
        return new kc(r.imp.ObjectIdToMdDbSpatialFilter(n));
      }, this.classNameToCreateCalls.McDbSpatialFilter = function() {
        return new kc();
      }, this.objectIdToObjectCalls.McDbAlignedDimension = function(n) {
        return new Cc(r.imp.ObjectIdToMdDbAlignedDimension(n));
      }, this.classNameToCreateCalls.McDbAlignedDimension = function() {
        return new Cc();
      }, this.objectIdToObjectCalls.McDbRotatedDimension = function(n) {
        return new Dc(r.imp.ObjectIdToMdDbRotatedDimension(n));
      }, this.classNameToCreateCalls.McDbRotatedDimension = function() {
        return new Dc();
      }, this.objectIdToObjectCalls.McDb2LineAngularDimension = function(n) {
        return new _c(r.imp.ObjectIdToMdDb2LineAngularDimension(n));
      }, this.classNameToCreateCalls.McDb2LineAngularDimension = function() {
        return new _c();
      }, this.objectIdToObjectCalls.McDbMText = function(n) {
        return new Ia(r.imp.ObjectIdToMdDbMText(n));
      }, this.classNameToCreateCalls.McDbMText = function() {
        return new Ia();
      }, this.objectIdToObjectCalls.McDbEllipse = function(n) {
        return new xo(r.imp.ObjectIdToMdDbEllipse(n));
      }, this.classNameToCreateCalls.McDbEllipse = function() {
        return new xo();
      }, this.objectIdToObjectCalls.McDbPoint = function(n) {
        return new Tu(r.imp.ObjectIdToMdDbPoint(n));
      }, this.classNameToCreateCalls.McDbPoint = function() {
        return new Tu();
      }, this.objectIdToObjectCalls.McDbBlockTableRecord = function(n) {
        return new Ao(r.imp.ObjectIdToMdDbBlockTableRecord(n));
      }, this.classNameToCreateCalls.McDbBlockTableRecord = function() {
        return new Ao();
      }, this.objectIdToObjectCalls.McDbLayerTableRecord = function(n) {
        return new Oc(r.imp.ObjectIdToMdDbLayerTableRecord(n));
      }, this.classNameToCreateCalls.McDbLayerTableRecord = function() {
        return new Oc();
      }, this.objectIdToObjectCalls.McDbLinetypeTableRecord = function(n) {
        return new Fc(r.imp.ObjectIdToMdDbLinetypeTableRecord(n));
      }, this.classNameToCreateCalls.McDbLinetypeTableRecord = function() {
        return new Fc();
      }, this.objectIdToObjectCalls.McDbDimStyleTableRecord = function(n) {
        return new Ic(r.imp.ObjectIdToMdDbDimStyleTableRecord(n));
      }, this.classNameToCreateCalls.McDbDimStyleTableRecord = function() {
        return new Ic();
      }, this.objectIdToObjectCalls.McDbTextStyleTableRecord = function(n) {
        return new Rc(r.imp.ObjectIdToMdDbTextStyleTableRecord(n));
      }, this.classNameToCreateCalls.McDbTextStyleTableRecord = function() {
        return new Rc();
      }, this.objectIdToObjectCalls.McDbHatch = function(n) {
        return new Mo(r.imp.ObjectIdToMdDbHatch(n));
      }, this.classNameToCreateCalls.McDbHatch = function() {
        return new Mo();
      }, this.objectIdToObjectCalls.McDbProxyEntity = function(n) {
        return new Pc(r.imp.ObjectIdToMdDbProxyEntity(n));
      }, this.classNameToCreateCalls.McDbProxyEntity = function() {
        return new Pc();
      }, this.objectIdToObjectCalls.McDbRasterImage = function(n) {
        return new Bc(r.imp.ObjectIdToMdDbRasterImage(n));
      }, this.classNameToCreateCalls.McDbRasterImage = function() {
        return new Bc();
      }, this.objectIdToObjectCalls.McDbRasterImageDef = function(n) {
        return new Vc(r.imp.ObjectIdToMdDbRasterImageDef(n));
      }, this.classNameToCreateCalls.McDbRasterImageDef = function() {
        return new Vc();
      }, this.objectIdToObjectCalls.McDbWipeout = function(n) {
        return new Lc(r.imp.ObjectIdToMdDbWipeout(n));
      }, this.classNameToCreateCalls.McDbWipeout = function() {
        return new Lc();
      }, this.objectIdToObjectCalls.McDbSpline = function(n) {
        return new Eo(r.imp.ObjectIdToMdDbSpline(n));
      }, this.classNameToCreateCalls.McDbSpline = function() {
        return new Eo();
      }, this.objectIdToObjectCalls.McDbDictionary = function(n) {
        return new vs(r.imp.ObjectIdToMdDbDictionary(n));
      }, this.classNameToCreateCalls.McDbDictionary = function() {
        return new vs();
      }, this.objectIdToObjectCalls.McDbXrecord = function(n) {
        return new Hc(r.imp.ObjectIdToMdDbXrecord(n));
      }, this.classNameToCreateCalls.McDbXrecord = function() {
        return new Hc();
      }, this.objectIdToObjectCalls.McDbGroup = function(n) {
        return new Su(r.imp.ObjectIdToMdDbGroup(n));
      }, this.classNameToCreateCalls.McDbGroup = function() {
        return new Su();
      };
    }
  }, {
    key: "objectIdToObject",
    value: function(r) {
      if (!r)
        return null;
      var n = this.imp.ObjectIdToObjectName(r);
      if (this.objectIdToObjectCalls[n])
        return this.objectIdToObjectCalls[n](r);
      if (n == "McDbCustomEntity") {
        var i = this.imp.ObjectIdToMdDbCustomEntity(r);
        if (!i) return null;
        var a = i.getCustomEntityid(), s = i.GetDatabaseIndexId();
        return ie.App.destroyObject(i), a == 0 || s == 0 ? null : Pr.getObject(a, s);
      }
      if (this.imp.ObjectIdIsKindOf(r, "McDbCurve"))
        return this.objectIdToObjectCalls.McDbCurve(r);
      if (this.imp.ObjectIdIsKindOf(r, "McDbDimension"))
        return this.objectIdToObjectCalls.McDbDimension(r);
      if (this.imp.ObjectIdIsKindOf(r, "McDbEntity"))
        return this.objectIdToObjectCalls.McDbEntity(r);
      var o = this.imp.ObjectIdToMdObject(r);
      return new Nr(o);
    }
  }, {
    key: "createCloneObject",
    value: function(r) {
      if (!r) return null;
      var n = r.getObjectName();
      if (n == "McDbCustomEntity") {
        var i = r.getCustomEntityid(), a = r.GetDatabaseIndexId(), s = null;
        return i == 0 || a == 0 ? (s = Pr.createMxEntity(r.getCustomEntityTypeName()), s && (s.getImp().ConnectionTempObject(r), s.syncData(!1))) : s = Pr.getObject(i, a), ie.App.destroyObject(r), s;
      } else {
        var o = null;
        return this.classNameToCreateCalls[n] ? o = this.classNameToCreateCalls[n]() : r.isKindOf("McDbCurve") ? (o = new Zr(), o.initTempObject(new ie.mxcadassemblyimp.MdDbCurve())) : r.isKindOf("McDbEntity") && (o = new xr(), o.initTempObject(new ie.mxcadassemblyimp.MdDbEntity())), o ? (o.getImp().ConnectionTempObject(r), ie.App.destroyObject(r), o) : new Nr(r);
      }
    }
  }, {
    key: "setFontFilePath",
    value: function(r) {
      this.imp.setFontFilePath(r);
    }
  }, {
    key: "setDefaultTrueTypeFontFile",
    value: function(r) {
      this.imp.setDefaultTrueTypeFontFile(r);
    }
  }, {
    key: "setDefaultShxFontFile",
    value: function(r, n) {
      this.imp.setDefaultShxFontFile(r, n);
    }
  }, {
    key: "addNetworkLoadingFont",
    value: function(r) {
      var n = this, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : [], a = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1;
      if (typeof r == "string")
        this.imp.addNetworkLoadingFont(r), a || (this.shxFonts = []), this.shxFonts.push(r);
      else {
        var s;
        a ? (s = this.shxFonts).push.apply(s, Xt(r)) : this.shxFonts = r, r.forEach(function(o) {
          n.imp.addNetworkLoadingFont(o);
        });
      }
      i.forEach(function(o) {
        n.imp.addFontsLoadOnInitialization(o, 0);
      });
    }
  }, {
    key: "IniSet",
    value: function(r) {
      return r.UseUtf8 && (xe.isUseUtf8 = r.UseUtf8), this.imp.IniSet(JSON.stringify(r));
    }
  }, {
    key: "setMcGeTol",
    value: function(r) {
      return this.dMcGeBakTol = this.imp.setMcGeTol(r), this.dMcGeBakTol;
    }
  }, {
    key: "restoreMcGeTol",
    value: function() {
      this.dMcGeBakTol > 0 && (this.imp.setMcGeTol(this.dMcGeBakTol), this.dMcGeBakTol = -1);
    }
  }, {
    key: "addNetworkLoadingBigFont",
    value: function(r) {
      var n = this, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : [], a = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1;
      if (typeof r == "string")
        this.imp.addNetworkLoadingFont(r), a || (this.shxBigFonts = []), this.shxBigFonts.push(r);
      else {
        var s;
        a ? (s = this.shxBigFonts).push.apply(s, Xt(r)) : this.shxBigFonts = r, r.forEach(function(o) {
          n.imp.addNetworkLoadingFont(o);
        });
      }
      i.forEach(function(o) {
        n.imp.addFontsLoadOnInitialization(o, 1);
      });
    }
  }, {
    key: "addNetworkLoadingTrueTypeFont",
    value: function(r, n, i) {
      for (var a = this, s = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : [], o = r.length, u = 0; u < o; u++)
        this.imp.addNetworkLoadingTrueTypeFont(r[u], n[u], i[u]), this.trueFonts[r[u]] = {
          name: r[u],
          zhname: n[u],
          file: i[u]
        };
      s.forEach(function(l) {
        a.imp.addFontsLoadOnInitialization(l, 2);
      });
    }
  }, {
    key: "getShxFonts",
    value: function() {
      return this.shxFonts;
    }
  }, {
    key: "getShxBigFonts",
    value: function() {
      return this.shxBigFonts;
    }
  }, {
    key: "loadFonts",
    value: function(r, n, i, a) {
      var s = this, o = [], u = [], l = [];
      r.forEach(function(c) {
        s.imp.isAlreadyNetworkLoaded(c) || o.push(c);
      }), n.forEach(function(c) {
        s.imp.isAlreadyNetworkLoaded("{big}" + c) || u.push(c);
      }), i.forEach(function(c) {
        s.imp.isAlreadyNetworkLoaded("{font}" + c) || l.push(c);
      }), X0.loadFonts(o, u, l, a);
    }
  }, {
    key: "isAlreadyLoaded",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
      return n == 0 ? this.imp.isAlreadyNetworkLoaded(r) : n == 1 ? this.imp.isAlreadyNetworkLoaded("{big}" + r) : n == 2 ? this.imp.isAlreadyNetworkLoaded("{font}" + r) : !0;
    }
  }, {
    key: "getTrueTypeFonts",
    value: function() {
      var r = this, n = [];
      return Object.keys(this.trueFonts).forEach(function(i) {
        n.push(r.trueFonts[i]);
      }), n;
    }
  }, {
    key: "getVersionString",
    value: function() {
      return this.imp.GetVersionString();
    }
  }, {
    key: "GetVersionDateString",
    value: function() {
      return this.imp.GetVersionDateString();
    }
  }, {
    key: "newMcObjectId",
    value: function(r, n) {
      return new Fe(r, n);
    }
  }]), e;
}(), Jf = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "mxcadassemblyimp", void 0), le(this, "App", new Nv()), le(this, "PropertiesWindow", new Gv()), le(this, "Ai", new f2());
  }
  return Be(e, [{
    key: "getCallResult",
    value: function() {
      return this.App.getLastCallResult();
    }
  }, {
    key: "newMcGePoint3d",
    value: function(r) {
      var n = new te();
      return r && typeof r.x == "number" && typeof r.y == "number" && (n.x = r.x, n.y = r.y, typeof r.z == "number" && (n.z = r.z)), n;
    }
  }, {
    key: "newMcGeVector3d",
    value: function(r) {
      var n = new Ve();
      return r && typeof r.x == "number" && typeof r.y == "number" && (n.x = r.x, n.y = r.y, typeof r.z == "number" && (n.z = r.z)), n;
    }
  }, {
    key: "getCurrentMxCAD",
    value: function() {
      return this.App.getCurrentMxCAD();
    }
  }, {
    key: "getCurrentDatabase",
    value: function() {
      return this.App.getCurrentMxCAD().getDatabase();
    }
  }, {
    key: "decodeFromGb2312",
    value: function(r) {
      return xe.decodeFromGb2312(r);
    }
  }, {
    key: "encodeToGb2312",
    value: function(r) {
      return xe.encodeToGb2312(r);
    }
  }]), e;
}(), Qy = /* @__PURE__ */ Be(function e() {
  Pe(this, e), le(this, "mapOrigin", []), le(this, "cadOrigin", []), le(this, "meterInCADUnits", 1), le(this, "mapbox_accessToken", ""), le(this, "openFile", void 0), le(this, "rasterTileLayerList", []), le(this, "rasterTileKey", void 0), le(this, "providers", void 0), le(this, "viewColor", void 0);
}), e1 = /* @__PURE__ */ Be(function e() {
  Pe(this, e), le(this, "type", ""), le(this, "name", ""), le(this, "code", "");
}), t1 = /* @__PURE__ */ Be(function e() {
  Pe(this, e), le(this, "sRegistData", ""), le(this, "mxcadui", void 0), le(this, "openFile", void 0), le(this, "map_default_data", void 0), le(this, "sampleCode", void 0);
}), Uv = /* @__PURE__ */ function(e) {
  return e[e.kInt = 1] = "kInt", e[e.kDouble = 2] = "kDouble", e[e.kString = 3] = "kString", e;
}(Uv || {}), r1 = /* @__PURE__ */ Be(function e() {
  Pe(this, e), le(this, "sVarName", ""), le(this, "iVarType", 1), le(this, "val", void 0), le(this, "isOnlyRead", !1);
}), Gv = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "getPropertiesCall", null), le(this, "setPropertiesCall", null);
  }
  return Be(e, [{
    key: "onEvent_getProperties",
    value: function(r) {
      this.getPropertiesCall = r;
    }
  }, {
    key: "onEvent_setProperties",
    value: function(r) {
      this.setPropertiesCall = r;
    }
  }, {
    key: "setEntitySupportCustom",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, i = r.getMcDbEntity();
      i && i.getImp().setPropertiesWindowCustom(n);
    }
  }, {
    key: "getEntityProperties",
    value: function(r) {
      var n = r.getMcDbEntity();
      return n ? n.getImp().isPropertiesWindowCustom() ? this.getPropertiesCall == null ? [] : this.getPropertiesCall(r) : [] : [];
    }
  }, {
    key: "setEntityProperties",
    value: function(r, n) {
      var i = r.getMcDbEntity();
      if (i && i.getImp().isPropertiesWindowCustom() && this.setPropertiesCall != null)
        return this.setPropertiesCall(r, n);
    }
  }]), e;
}(), n1 = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "imp", void 0), le(this, "result", []), this.imp = new ie.mxcadassemblyimp.MxCompare();
  }
  return Be(e, [{
    key: "getTypeString",
    value: function(r) {
      var n = "";
      switch (r) {
        case 0:
          n = "no modify";
          break;
        case 1:
          n = "unknown";
          break;
        case 2:
          n = "object modify";
          break;
        case 3:
          n = "object erase";
          break;
        case 4:
          n = "object add";
          break;
        default:
          n = "unknown";
      }
      return n;
    }
  }, {
    key: "do",
    value: function(r) {
      if (this.result = [], this.imp.Do(r.imp)) {
        for (var n = new vr(this.imp.getResult()), i = n.GetCount(), a = 0; a + 2 < i; a += 3) {
          var s = n.AtLong(a);
          if (!s.ret) break;
          var o = n.AtPoint(a + 1);
          if (!o.ret) break;
          var u = n.AtLong(a + 2);
          if (!u.ret) break;
          this.result.push({
            id: new Fe(s.val),
            pos: o.val,
            type: u.val,
            str: this.getTypeString(u.val)
          });
        }
        return !0;
      }
      return !1;
    }
  }, {
    key: "getResult",
    value: function() {
      return this.result;
    }
  }]), e;
}(), i1 = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MxTempModifyColor();
  }
  return Be(e, [{
    key: "Do",
    value: function(r, n) {
      return this.imp.Do(r.imp, n.getImp());
    }
  }, {
    key: "DoRestore",
    value: function() {
      this.imp.DoRestore();
    }
  }]), e;
}(), a1 = /* @__PURE__ */ function() {
  function e() {
    var t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
    Pe(this, e), le(this, "bakIsIntelliSelect", !0), this.bakIsIntelliSelect = Ue.getIniSet().EnableIntelliSelect, Ue.setIniset({
      EnableIntelliSelect: !t
    });
  }
  return Be(e, [{
    key: "restoreSettings",
    value: function() {
      Ue.setIniset({
        EnableIntelliSelect: this.bakIsIntelliSelect
      });
    }
  }]), e;
}(), ie = new Jf();
function zv(e) {
  return xd.apply(this, arguments);
}
function xd() {
  return xd = ut(/* @__PURE__ */ be.mark(function e(t) {
    var r, n, i, a, s, o = arguments;
    return be.wrap(function(l) {
      for (; ; ) switch (l.prev = l.next) {
        case 0:
          return r = o.length > 1 && o[1] !== void 0 ? o[1] : Zw || !_v ? Jw : Qw, n = o.length > 2 ? o[2] : void 0, i = o.length > 3 ? o[3] : void 0, a = o.length > 4 ? o[4] : void 0, s = o.length > 5 ? o[5] : void 0, l.abrupt("return", new Promise(/* @__PURE__ */ function() {
            var c = ut(/* @__PURE__ */ be.mark(function f(h, d) {
              var g, v, m, p;
              return be.wrap(function(w) {
                for (; ; ) switch (w.prev = w.next) {
                  case 0:
                    if (w.prev = 0, ie || (ie = new Jf()), !ie.mxcadassemblyimp) {
                      w.next = 5;
                      break;
                    }
                    return t && t(ie), w.abrupt("return", h(ie));
                  case 5:
                    return g = "mxdrawassembly_min", w.next = 8, t2(g, "mxdrawassembly", {
                      locateFile: r,
                      wasmBinary: n
                    });
                  case 8:
                    v = w.sent, ie.mxcadassemblyimp = v, m = new v.McApp(), i ? m.setFontFilePath(i) : m.setFontFilePath("fonts"), ie.App.setImp(m), s && s.callEvent("init_cpp"), m.Init(), Pr.init(), ie.App.init(m), a ? ie.App.addNetworkLoadingFont(a) : ie.App.addNetworkLoadingFont(["txt.shx", "hztxt.shx"]), p = window, p.__MxCpp__ = ie, t && t(ie), h(ie), w.next = 27;
                    break;
                  case 24:
                    w.prev = 24, w.t0 = w.catch(0), d(w.t0);
                  case 27:
                  case "end":
                    return w.stop();
                }
              }, f, null, [[0, 24]]);
            }));
            return function(f, h) {
              return c.apply(this, arguments);
            };
          }()));
        case 6:
        case "end":
          return l.stop();
      }
    }, e);
  })), xd.apply(this, arguments);
}
function s1() {
  var e = {}, t = navigator.userAgent.toLowerCase(), r;
  if ((r = t.match(/edg\/([\d.]+)/)) ? e.edge = r[1] : (r = t.match(/rv:([\d.]+)\) like gecko/)) || (r = t.match(/msie ([\d.]+)/)) ? e.ie = r[1] : (r = t.match(/firefox\/([\d.]+)/)) ? e.firefox = r[1] : (r = t.match(/chrome\/([\d.]+)/)) ? e.chrome = r[1] : (r = t.match(/opera.([\d.]+)/)) ? e.opera = r[1] : (r = t.match(/version\/([\d.]+).*safari/)) && (e.safari = r[1]), e.ie)
    return {
      ok: !1,
      error: "iechromeedge",
      var: e
    };
  if (e.edge) {
    var n = new RegExp("edg/([0-9]{1,}[.0-9]{0,})");
    if (n.exec(t) != null) {
      var i = parseFloat(RegExp.$1);
      if (i < 107)
        return {
          ok: !1,
          error: "edgeedge",
          var: e
        };
    }
  } else if (e.chrome) {
    var n = new RegExp("chrome/([0-9]{1,}[.0-9]{0,})");
    if (n.exec(t) != null) {
      var a = parseFloat(RegExp.$1);
      if (a < 107)
        return {
          ok: !1,
          error: "chrome",
          var: e
        };
    }
  } else if (e.firefox) {
    var n = new RegExp("firefox/([0-9]{1,}[.0-9]{0,})");
    if (n.exec(t) != null) {
      var s = parseFloat(RegExp.$1);
      if (s < 101)
        return {
          ok: !1,
          error: "firefoxfirefox",
          var: e
        };
    }
  } else if (!e.safari) return e.opera ? {
    ok: !1,
    error: "operachromeedge",
    var: e
  } : {
    ok: !1,
    error: "chromeedge",
    var: e
  };
  return {
    ok: !0,
    error: "",
    var: e
  };
}
var te = /* @__PURE__ */ function() {
  function e(t, r, n) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGePoint3d(), t instanceof Object ? (this.imp.x = t.x, this.imp.y = t.y, this.imp.z = t.z) : (this.imp.x = t || 0, this.imp.y = r || 0, this.imp.z = n || 0);
  }
  return Be(e, [{
    key: "toVector3",
    value: function() {
      return new THREE.Vector3(this.imp.x, this.imp.y, this.imp.z);
    }
  }, {
    key: "setFromVector3",
    value: function(r) {
      return this.imp.x = r.x, this.imp.y = r.y, this.imp.z = r.z, this;
    }
  }, {
    key: "copy",
    value: function(r) {
      return this.imp.x = r.x, this.imp.y = r.y, this.imp.z = r.z, this;
    }
  }, {
    key: "transformBy",
    value: function(r) {
      return this.imp.transformBy(r.imp), this;
    }
  }, {
    key: "addvec",
    value: function(r) {
      return this.imp.addvec(r.imp), this;
    }
  }, {
    key: "av",
    value: function(r) {
      return this.imp.addvec(r.imp), this;
    }
  }, {
    key: "subvec",
    value: function(r) {
      return this.imp.subvec(r.imp), this;
    }
  }, {
    key: "sv",
    value: function(r) {
      return this.imp.subvec(r.imp), this;
    }
  }, {
    key: "sub",
    value: function(r) {
      return new Ve(this.imp.sub(r.imp));
    }
  }, {
    key: "distanceTo",
    value: function(r) {
      return this.imp.distanceTo(r.imp);
    }
  }, {
    key: "isEqualTo",
    value: function(r) {
      return this.imp.isEqualTo(r.imp);
    }
  }, {
    key: "clone",
    value: function() {
      return new e(this.imp);
    }
  }, {
    key: "c",
    value: function() {
      return new e(this.imp);
    }
  }, {
    key: "x",
    get: function() {
      return this.imp.x;
    },
    set: function(r) {
      this.imp.x = r;
    }
  }, {
    key: "y",
    get: function() {
      return this.imp.y;
    },
    set: function(r) {
      this.imp.y = r;
    }
  }, {
    key: "z",
    get: function() {
      return this.imp.z;
    },
    set: function(r) {
      this.imp.z = r;
    }
  }]), e;
}();
le(te, "kOrigin", void 0);
var Ve = /* @__PURE__ */ function() {
  function e(t, r, n) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGeVector3d(), t instanceof Object ? (this.imp.x = t.x, this.imp.y = t.y, this.imp.z = t.z) : (this.imp.x = t || 0, this.imp.y = r || 0, this.imp.z = n || 0);
  }
  return Be(e, [{
    key: "toVector3",
    value: function() {
      return new THREE.Vector3(this.imp.x, this.imp.y, this.imp.z);
    }
  }, {
    key: "copy",
    value: function(r) {
      return this.imp.x = r.imp.x, this.imp.y = r.imp.y, this.imp.z = r.imp.z, this;
    }
  }, {
    key: "clone",
    value: function() {
      return new e(this.imp);
    }
  }, {
    key: "c",
    value: function() {
      return new e(this.imp);
    }
  }, {
    key: "rotateBy",
    value: function(r, n) {
      return n || (n = e.kZAxis), this.imp.rotateBy(r, n.imp), this;
    }
  }, {
    key: "negate",
    value: function() {
      return this.imp.negate(), this;
    }
  }, {
    key: "perpVector",
    value: function() {
      return this.imp.perpVector(), this;
    }
  }, {
    key: "angleTo1",
    value: function(r) {
      return this.imp.angleTo(r.imp);
    }
  }, {
    key: "angleTo2",
    value: function(r, n) {
      return n || (n = e.kNegateZAxis), this.imp.angleTo(r.imp, n.imp);
    }
  }, {
    key: "normalize",
    value: function() {
      return this.imp.normalize(), this;
    }
  }, {
    key: "length",
    value: function() {
      return this.imp.length();
    }
  }, {
    key: "isUnitLength",
    value: function() {
      return this.imp.isUnitLength();
    }
  }, {
    key: "isZeroLength",
    value: function() {
      return this.imp.isZeroLength();
    }
  }, {
    key: "dotProduct",
    value: function(r) {
      return this.imp.dotProduct(r.imp);
    }
  }, {
    key: "crossProduct",
    value: function(r) {
      var n = new e();
      return n.imp = this.imp.crossProduct(r.imp), n;
    }
  }, {
    key: "isEqualTo",
    value: function(r) {
      return this.imp.isEqualTo(r.imp);
    }
  }, {
    key: "mult",
    value: function(r) {
      return this.imp.mult(r), this;
    }
  }, {
    key: "x",
    get: function() {
      return this.imp.x;
    },
    set: function(r) {
      this.imp.x = r;
    }
  }, {
    key: "y",
    get: function() {
      return this.imp.y;
    },
    set: function(r) {
      this.imp.y = r;
    }
  }, {
    key: "z",
    get: function() {
      return this.imp.z;
    },
    set: function(r) {
      this.imp.z = r;
    }
  }]), e;
}();
le(Ve, "kIdentity", void 0);
le(Ve, "kXAxis", void 0);
le(Ve, "kYAxis", void 0);
le(Ve, "kZAxis", void 0);
le(Ve, "kNegateZAxis", void 0);
var Jr = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGeMatrix3d(), t instanceof Object && this.imp.copy(t);
  }
  return Be(e, [{
    key: "copy",
    value: function(r) {
      return this.imp.copy(r.imp), this;
    }
  }, {
    key: "clone",
    value: function() {
      return new e(this.imp);
    }
  }, {
    key: "setToIdentity",
    value: function() {
      return this.imp.setToIdentity(), this;
    }
  }, {
    key: "preMultBy",
    value: function(r) {
      return this.imp.preMultBy(r.imp), this;
    }
  }, {
    key: "postMultBy",
    value: function(r) {
      return this.imp.postMultBy(r.imp), this;
    }
  }, {
    key: "setToProduct",
    value: function(r, n) {
      return this.imp.setToProduct(r.imp, n.imp), this;
    }
  }, {
    key: "invert",
    value: function() {
      return this.imp.invert(), this;
    }
  }, {
    key: "isSingular",
    value: function() {
      return this.imp.isSingular();
    }
  }, {
    key: "transposeIt",
    value: function() {
      return this.imp.transposeIt(), this;
    }
  }, {
    key: "isEqualTo",
    value: function(r) {
      return this.imp.isEqualTo(r.imp);
    }
  }, {
    key: "det",
    value: function() {
      return this.imp.det();
    }
  }, {
    key: "setCoordSystem",
    value: function(r, n, i, a) {
      return this.imp.setCoordSystem(r.imp, n.imp, i.imp, a.imp), this;
    }
  }, {
    key: "setToTranslation",
    value: function(r) {
      return this.imp.setToTranslation(r.imp), this;
    }
  }, {
    key: "setToRotation",
    value: function(r, n, i) {
      return this.imp.setToRotation(r, n.imp, i.imp), this;
    }
  }, {
    key: "setToScaling",
    value: function(r, n) {
      return this.imp.setToScaling(r, n.imp), this;
    }
  }, {
    key: "setMirror",
    value: function(r, n) {
      return this.imp.setMirror(r.imp, n.imp), this;
    }
  }, {
    key: "scale",
    value: function() {
      return this.imp.scale();
    }
  }, {
    key: "angleXYPlane",
    value: function() {
      return this.imp.angleXYPlane();
    }
  }, {
    key: "getData",
    value: function(r, n) {
      return this.imp.getData(r, n);
    }
  }, {
    key: "setData",
    value: function(r, n, i) {
      return this.imp.setData(r, n, i);
    }
  }]), e;
}();
le(Jr, "kIdentity", void 0);
var fa = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGeLongArray(), t instanceof Object && this.imp.copy(t);
  }
  return Be(e, [{
    key: "copy",
    value: function(r) {
      return this.imp.clear(), this.imp.copy(r.imp), this;
    }
  }, {
    key: "copyFormAryId",
    value: function(r) {
      var n = this;
      return this.imp.clear(), r.forEach(function(i) {
        n.imp.append(i.id);
      }), this;
    }
  }, {
    key: "append",
    value: function(r) {
      this.imp.append(r);
    }
  }, {
    key: "length",
    value: function() {
      return this.imp.length();
    }
  }, {
    key: "at",
    value: function(r) {
      return this.imp.at(r);
    }
  }, {
    key: "setAt",
    value: function(r, n) {
      this.imp.setAt(r, n);
    }
  }, {
    key: "clear",
    value: function() {
      this.imp.clear();
    }
  }, {
    key: "forEach",
    value: function(r) {
      for (var n = this.imp.length(), i = 0; i < n; i++)
        r(this.imp.at(i), i);
    }
  }]), e;
}(), Ha = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGeStringArray(), t instanceof Object && this.imp.copy(t);
  }
  return Be(e, [{
    key: "copy",
    value: function(r) {
      return this.imp.copy(r.imp), this;
    }
  }, {
    key: "append",
    value: function(r) {
      this.imp.append(r);
    }
  }, {
    key: "length",
    value: function() {
      return this.imp.length();
    }
  }, {
    key: "at",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
      return n ? xe.decodeFromGb2312(this.imp.at(r)) : this.imp.at(r);
    }
  }, {
    key: "setAt",
    value: function(r, n) {
      var i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0;
      i ? this.imp.setAt(r, xe.encodeToGb2312(n)) : this.imp.setAt(r, n);
    }
  }, {
    key: "forEach",
    value: function(r) {
      for (var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0, i = this.imp.length(), a = 0; a < i; a++)
        r(n ? xe.decodeFromGb2312(this.imp.at(a)) : this.imp.at(a), a);
    }
  }, {
    key: "clear",
    value: function() {
      this.imp.clear();
    }
  }]), e;
}(), Xr = /* @__PURE__ */ function() {
  function e(t, r) {
    var n = this;
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGePoint3dArray(), t instanceof Array ? t.forEach(function(i) {
      n.imp.append(i.imp);
    }) : t instanceof Object && (this.imp.copy(t), r && ie.App.getImp().DestroyMdGePoint3dArray(t));
  }
  return Be(e, [{
    key: "copy",
    value: function(r) {
      var n = this;
      return r instanceof Array ? r.forEach(function(i) {
        n.imp.append(i.imp);
      }) : this.imp.copy(r.imp), this;
    }
  }, {
    key: "append",
    value: function(r) {
      this.imp.append(r.imp);
    }
  }, {
    key: "length",
    value: function() {
      return this.imp.length();
    }
  }, {
    key: "isEmpty",
    value: function() {
      return this.imp.length() == 0;
    }
  }, {
    key: "at",
    value: function(r) {
      return new te(this.imp.at(r));
    }
  }, {
    key: "setAt",
    value: function(r, n) {
      this.imp.setAt(r, n.imp);
    }
  }, {
    key: "clear",
    value: function() {
      this.imp.clear();
    }
  }, {
    key: "forEach",
    value: function(r) {
      for (var n = this.imp.length(), i = 0; i < n; i++)
        r(new te(this.imp.at(i)), i);
    }
  }]), e;
}(), hs = /* @__PURE__ */ function() {
  function e(t, r) {
    Pe(this, e), le(this, "imp", void 0), this.imp = new ie.mxcadassemblyimp.MdGeDoubleArray(), t instanceof Object && (this.imp.copy(t), r && ie.App.getImp().DestroyMdGeDoubleArray(t));
  }
  return Be(e, [{
    key: "copy",
    value: function(r) {
      return this.imp.clear(), this.imp.copy(r.imp), this;
    }
  }, {
    key: "append",
    value: function(r) {
      this.imp.append(r);
    }
  }, {
    key: "length",
    value: function() {
      return this.imp.length();
    }
  }, {
    key: "at",
    value: function(r) {
      return this.imp.at(r);
    }
  }, {
    key: "setAt",
    value: function(r, n) {
      this.imp.setAt(r, n);
    }
  }, {
    key: "clear",
    value: function() {
      this.imp.clear();
    }
  }, {
    key: "forEach",
    value: function(r) {
      for (var n = this.imp.length(), i = 0; i < n; i++)
        r(this.imp.at(i), i);
    }
  }]), e;
}(), o1 = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "minPoint", void 0), le(this, "maxPoint", void 0), le(this, "isValid", void 0), this.minPoint = new te(), this.maxPoint = new te(), this.isValid = !1, t && this.addPoints(t);
  }
  return Be(e, [{
    key: "addPoint",
    value: function(r) {
      this.isValid ? (this.minPoint.x > r.x && (this.minPoint.x = r.x), this.minPoint.y > r.y && (this.minPoint.y = r.y), this.minPoint.z > r.z && (this.minPoint.y = r.z), this.maxPoint.x < r.x && (this.maxPoint.x = r.x), this.maxPoint.y < r.y && (this.maxPoint.y = r.y), this.maxPoint.z < r.z && (this.maxPoint.z = r.z)) : (this.minPoint.x = r.x, this.minPoint.y = r.y, this.minPoint.z = r.z, this.maxPoint.x = r.x, this.maxPoint.y = r.y, this.maxPoint.z = r.z, this.isValid = !0);
    }
  }, {
    key: "addPoints",
    value: function(r) {
      var n = this;
      r.forEach(function(i) {
        n.addPoint(i);
      });
    }
  }]), e;
}(), Wv = /* @__PURE__ */ Be(function e() {
  Pe(this, e);
}), Ei = /* @__PURE__ */ function(e) {
  return e.None = "none", e.Overflow = "overflow", e.Word = "word", e.Forced = "forced", e;
}(Ei || {}), Hn = /* @__PURE__ */ function(e) {
  return e.Left = "l", e.Center = "c", e.Right = "r", e.Justify = "j", e.Distribute = "d", e;
}(Hn || {}), Je = /* @__PURE__ */ function(e) {
  return e.Paragraph = "P", e.Color = "c", e.ColorIndex = "C", e.Font = "f", e.FontAlt = "F", e.FontHeight = "H", e.Overline = "O", e.OverlineEnd = "o", e.Strike = "K", e.StrikeEnd = "k", e.Underline = "L", e.UnderlineEnd = "l", e.TiltAngle = "Q", e.Tracking = "T", e.WidthFactor = "W", e.SuperSubScript = "S", e.LineSpacing = "pxsm", e;
}(Je || {}), bi = /* @__PURE__ */ function(e) {
  return e.Chinese = "chinese", e.Continuous = "continuous", e.Breakable = "breakable", e.Element = "element", e.TextNode = "textNode", e;
}(bi || {});
function Kt(e) {
  return !!(e != null && e.children);
}
function Lr(e) {
  return "text" in e;
}
var q0 = {
  CHINESE: /[\u4e00-\u9fa5]/,
  WHITESPACE: /\s/
}, d2 = new RegExp("".concat(q0.CHINESE.source, "|").concat(q0.WHITESPACE.source));
function $0(e) {
  return d2.test(e);
}
function Jo(e, t, r, n) {
  return {
    node: e,
    nodeIndex: t,
    startOffset: r,
    endOffset: n,
    text: Kt(e) ? "" : e.text.substring(r, n)
  };
}
function Qo(e, t) {
  return {
    type: e,
    fragments: [t],
    text: t.text
  };
}
function p2(e, t) {
  e.fragments.push(t), e.text += t.text;
}
function v2(e) {
  var t = [], r = null;
  return e.forEach(function(n, i) {
    if (Lr(n)) {
      if (n.type && bt.elementTextManager.hasText(n.type)) {
        r = null, t.push(Qo(bi.TextNode, Jo(n, i, 0, n.text.length)));
        return;
      }
      var a = n.text, s = 0;
      if (a.length === 0)
        t.push(Qo(bi.Continuous, Jo(n, i, s, s)));
      else
        for (; s < a.length; ) {
          var o, u = a[s];
          if ($0(u)) {
            r = null, t.push(Qo(bi.Breakable, Jo(n, i, s, s + 1))), s++;
            continue;
          }
          for (var l = s + 1; l < a.length && !$0(a[l]); )
            l++;
          var c = Jo(n, i, s, l);
          ((o = r) === null || o === void 0 ? void 0 : o.type) === bi.Continuous ? p2(r, c) : (r = Qo(bi.Continuous, c), t.push(r)), s = l;
        }
    } else Kt(n) && bt.elementTextManager.has(n.type) && (r = null, t.push(Qo(bi.Element, Jo(n, i, 0, 0))));
  }), t;
}
function Mh() {
  return {
    nodes: [],
    height: 0,
    width: 0,
    breakInfo: {
      isWrapped: !1,
      breakType: Ei.None
    }
  };
}
function Y0(e, t, r) {
  e.nodes.push(t), e.width += t.width, e.height = Math.max(e.height, r);
}
function m2(e) {
  e.breakInfo || (e.breakInfo = {
    isWrapped: !1,
    breakType: Ei.None
  });
}
function Eh(e, t, r) {
  m2(e), e.breakInfo.isWrapped = t, e.breakInfo.breakType = r;
}
var Md = /* @__PURE__ */ new Map(), g2 = function() {
  Md.clear();
}, li = function(t, r, n) {
  var i = Md.get(r);
  if (i)
    return i;
  var a = bt.elementTextManager.get(r.type), s = a == null ? void 0 : a.calculate(t, r, n);
  return s ? (s && Md.set(r, s), s) : {
    width: 0,
    height: 0
  };
}, Ed = /* @__PURE__ */ new WeakMap();
function Xc(e) {
  return "".concat(e.nodeIndex, "_").concat(e.startOffset, "_").concat(e.endOffset);
}
function y2(e) {
  if (e.length <= 1) return !0;
  var t = e[0].node;
  return e.every(function(r) {
    return r.node === t;
  });
}
function b2(e, t, r) {
  var n = t.baseHeight, i = t.getTextWidth;
  if (y2(e.fragments)) {
    var a = i(e.text, e.fragments[0].node, n), s = a / e.fragments.length;
    return e.fragments.forEach(function(u) {
      r.set(Xc(u), s);
    }), a;
  } else {
    var o = 0;
    return e.fragments.forEach(function(u) {
      var l = i(u.text, u.node, n);
      r.set(Xc(u), l), o += l;
    }), o;
  }
}
function w2(e, t) {
  var r = t.baseHeight, n = t.getTextWidth;
  return n(e.text, e.node, r);
}
function x2(e, t, r) {
  var n = Ed.get(t);
  if (n)
    return n.width;
  var i = /* @__PURE__ */ new Map(), a;
  if (t.type === bi.Element) {
    var s = t.fragments[0], o = s.node, u = li(e, o), l = u.width;
    a = l;
  } else t.type === bi.Continuous ? a = b2(t, r, i) : (a = 0, t.fragments.forEach(function(c) {
    var f = w2(c, r);
    i.set(Xc(c), f), a += f;
  }));
  return Ed.set(t, {
    width: a,
    fragmentWidths: i
  }), a;
}
function M2(e, t) {
  var r = Ed.get(e);
  if (!r)
    throw new Error("Sequence width not calculated");
  var n = r.fragmentWidths.get(Xc(t));
  if (n === void 0)
    throw new Error("Fragment width not found");
  return n;
}
function E2(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = A2(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function A2(e, t) {
  if (e) {
    if (typeof e == "string") return K0(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? K0(e, t) : void 0;
  }
}
function K0(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function T2(e, t, r, n) {
  var i = n.maxWidth, a = n.baseHeight, s = n.getTextHeight, o = n.isWidthOffset;
  if (!(t != null && t.length))
    return [];
  var u = v2(t), l = [], c = Mh(), f = 0, h = function(y, w) {
    if (Kt(w.node)) {
      var x = li(e, w.node), b = x.height, M = x.width;
      Y0(c, {
        node: w.node,
        path: [r, w.nodeIndex],
        startOffset: w.startOffset,
        endOffset: w.endOffset,
        width: M,
        index: w.nodeIndex,
        height: b
      }, b);
    } else {
      var k = s(w.node, a);
      Y0(c, {
        node: w.node,
        path: [r, w.nodeIndex],
        startOffset: w.startOffset,
        endOffset: w.endOffset,
        width: M2(y, w),
        index: w.nodeIndex,
        height: k
      }, k);
    }
  }, d = function() {
    if (o) {
      var y = i - f;
      if (y > 0) {
        var w = c.nodes.reduce(function(b, M) {
          return Kt(M.node) || Lr(M.node) && M.node.type && bt.elementTextManager.hasText(M.node.type) ? b + 1 : b + M.endOffset - M.startOffset;
        }, 0), x = 0;
        w === 1 ? x = y / 2 : x = y / (w - 1), c.nodes.forEach(function(b) {
          b.hasCharLevelSpacing = !0, b.extraCharSpacing = x;
        });
      }
    }
  }, g = E2(u), v;
  try {
    var m = function() {
      var y = v.value, w = x2(e, y, n);
      if (f === 0 && w > i)
        return y.fragments.forEach(function(x) {
          h(y, x);
        }), d(), Eh(c, !0, y.type === bi.Continuous || y.isAutoBreak ? Ei.Word : Ei.Forced), l.push(c), c = Mh(), f = 0, 1;
      f + w > i && f > 0 && (d(), Eh(c, !0, Ei.Forced), l.push(c), c = Mh(), f = 0), y.fragments.forEach(function(x) {
        h(y, x);
      }), f += w;
    };
    for (g.s(); !(v = g.n()).done; )
      m();
  } catch (p) {
    g.e(p);
  } finally {
    g.f();
  }
  return c.nodes.length > 0 && (Eh(c, !0, Ei.Forced), d(), c.isEndLine = !0, l.push(c)), l;
}
function S2(e) {
  if (Array.isArray(e)) return e;
}
function k2(e, t) {
  var r = e == null ? null : typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (r != null) {
    var n, i, a, s, o = [], u = !0, l = !1;
    try {
      if (a = (r = r.call(e)).next, t === 0) {
        if (Object(r) !== r) return;
        u = !1;
      } else for (; !(u = (n = a.call(r)).done) && (o.push(n.value), o.length !== t); u = !0) ;
    } catch (c) {
      l = !0, i = c;
    } finally {
      try {
        if (!u && r.return != null && (s = r.return(), Object(s) !== s)) return;
      } finally {
        if (l) throw i;
      }
    }
    return o;
  }
}
function C2() {
  throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function rr(e, t) {
  return S2(e) || k2(e, t) || Vy(e, t) || C2();
}
var u1 = function(t, r) {
  var n = oo(t);
  return n && (r.trueColor = n), n;
}, oo = function(t) {
  var r;
  if (typeof t.color == "number")
    r = new fr(), r.setColorIndex(t.color);
  else if (Array.isArray(t.color)) {
    var n = rr(t.color, 3), i = n[0], a = i === void 0 ? 255 : i, s = n[1], o = s === void 0 ? 255 : s, u = n[2], l = u === void 0 ? 255 : u;
    r = new fr(), r.setRGB(a, o, l);
  }
  return r;
}, D2 = function(t, r) {
  var n = t.bold, i = t.italic, a = t.font, s = t.tiltAngle, o = t.tracking, u = t.widthFactor;
  t.textPosition;
  var l = r, c = "";
  return (a !== void 0 || n === !0 || i === !0) && (c += "\\f".concat(a != null ? a : "", "|").concat(n ? "b1" : "b0", "|").concat(i ? "i1" : "i0", "|c134|p49;")), typeof s == "number" && (c += "\\Q".concat(s, ";")), typeof o == "number" && (c += "\\T".concat(o, ";")), typeof u == "number" && (c += "\\W".concat(u, ";")), "{" + c + l + "}";
}, _2 = function(t, r, n) {
  n || (n = ie.getCurrentMxCAD().getDatabase().getCurrentlyTextStyleName()), r.textStyle = n, r.contents = D2(t, r.contents);
}, Ad = /* @__PURE__ */ new Map(), P2 = function() {
  Ad.clear();
}, Ca = function(t, r) {
  var n = Ad.get(r);
  if (n)
    return n;
  if (r.type && bt.elementTextManager.hasText(r.type)) {
    var i = bt.elementTextManager.getText(r.type), a = i == null ? void 0 : i.calculate(t, r);
    if (a)
      return a && Ad.set(r, a), a;
  }
  return {
    width: 0,
    height: 0
  };
}, Da = function(t, r, n) {
  if (t.type && bt.elementTextManager.hasText(t.type)) {
    var i = Ca(n, t) || {
      width: 0
    }, a = i.height;
    return a;
  }
  return r * ((t == null ? void 0 : t.fontSize) || 1);
};
function B2(e) {
  var t = e >> 16, r = e >> 8 & 255, n = e & 255;
  return [n, r, t];
}
function L2(e) {
  var t = {}, r = e;
  if (r.bold && (t.bold = !0), r.italic && (t.italic = !0), r.underline && (t.underline = !0), r.overline && (t.overline = !0), r.strike && (t.strike = !0), r.font && (t.font = r.font), r.style && (t.style = r.style), r.fontSize && (t.fontSize = r.fontSize), r.color) {
    var n = r.color;
    typeof n == "number" ? t.color = n : Array.isArray(n) && (t.color = Xt(n));
  }
  return r.tiltAngle !== void 0 && (t.tiltAngle = r.tiltAngle), r.tracking !== void 0 && (t.tracking = r.tracking), r.widthFactor !== void 0 && (t.widthFactor = r.widthFactor), r.textPosition !== void 0 && (t.textPosition = r.textPosition), t;
}
function qc(e, t) {
  var r = {
    text: e
  };
  return t.bold && (r.bold = !0), t.italic && (r.italic = !0), t.underline && (r.underline = !0), t.overline && (r.overline = !0), t.strike && (r.strike = !0), t.font && (r.font = t.font), t.fontSize && (r.fontSize = t.fontSize), t.style && (r.style = t.style), t.color !== void 0 && t.color !== null && (r.color = t.color), t.tiltAngle !== void 0 && (r.tiltAngle = t.tiltAngle), t.tracking !== void 0 && (r.tracking = t.tracking), t.widthFactor !== void 0 && (r.widthFactor = t.widthFactor), t.textPosition !== void 0 && (r.textPosition = t.textPosition), r;
}
function fu(e) {
  for (var t = "", r = 0; r < e.length; ) {
    var n = e[r];
    if (n === "\\") {
      if (r + 1 < e.length) {
        var i = e[r + 1];
        if (i === "\\" || i === "{" || i === "}") {
          t += n + i, r += 2;
          continue;
        }
      }
      t += "\\\\";
    } else n === "{" || n === "}" ? t += "\\" + n : t += n;
    r++;
  }
  return t;
}
var l1 = function(t, r) {
  var n = r.baseHeight, i = r.position, a = r.style, s = r.ent, o = new Ia();
  if (o.contents = fu(t.text), o.textHeight = Da(t, n, s), o.location = i, _2(t, o, a), s.trueColor.method === hn.kByColor)
    o.trueColor = s.trueColor;
  else {
    var u = new fr();
    u.setColorIndex(s.colorIndex), o.trueColor = u, o.colorIndex = s.colorIndex;
  }
  return o.layer = s.layer, o.layerId = s.layerId, o.drawOrder = s.drawOrder, o.linetype = s.linetype, o.linetypeScale = s.linetypeScale, o.lineweight = s.lineweight, o;
}, hu = function(t) {
  var r = t.basePosition, n = t.horizontalOffset, i = t.verticalOffset, a = r.clone().addvec(Ve.kXAxis.clone().mult(n)).addvec(Ve.kYAxis.clone().negate().mult(i));
  return a;
};
function Z0(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function J0(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? Z0(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : Z0(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
var Ah = function(t) {
  var r = t.node, n = t.text, i = t.height, a = t.position, s = t.style, o = t.ent, u = l1(J0(J0({}, r), {}, {
    text: n
  }), {
    baseHeight: i,
    position: hu(a),
    style: s,
    ent: o
  });
  return u1(r, u), u;
}, F2 = function(t) {
  var r = Bt.getTextEntityBox(t, !1), n = r.maxPt.clone(), i = new te(r.minPt.x, n.y), a = i.distanceTo(n), s = i.distanceTo(r.maxPt);
  return {
    start: i,
    end: n,
    width: a,
    height: s,
    box: r
  };
}, I2 = function(t, r) {
  var n = l1(t, r);
  return n.reCompute(), F2(n);
};
function c1(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = R2(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function R2(e, t) {
  if (e) {
    if (typeof e == "string") return Q0(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? Q0(e, t) : void 0;
  }
}
function Q0(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function Vv(e) {
  var t = e;
  return bt.elementTextManager.forEachSpecialCharacter(function(r, n) {
    t = t.replace(new RegExp(n, "g"), r);
  }), t;
}
var em = {
  color: function(t) {
    var r = t.color;
    if (r === void 0) return "";
    if (Array.isArray(r)) {
      var n = rr(r, 3), i = n[0], a = n[1], s = n[2], o = i + a * 256 + s * 256 * 256;
      return "\\".concat(Je.Color).concat(o, ";");
    } else {
      if (typeof r == "number")
        return "\\".concat(Je.ColorIndex).concat(r, ";");
      if (typeof r == "string") {
        var u = r.replace(/^#/, ""), l = parseInt(u.substring(0, 2), 16), c = parseInt(u.substring(2, 4), 16), f = parseInt(u.substring(4, 6), 16), h = l + c * 256 + f * 256 * 256;
        return "\\".concat(Je.Color).concat(h, ";");
      }
    }
    return "";
  },
  font: function(t) {
    var r = t, n = r.font || "", i = r.bold ? "|b1" : "|b0", a = r.italic ? "|i1" : "|i0";
    return "\\".concat(Je.Font).concat(n).concat(i).concat(a, "|c134|p49;");
  },
  fontSize: function(t) {
    var r = t.fontSize;
    return r === void 0 ? "" : "\\".concat(Je.FontHeight).concat(r, "x;");
  },
  bold: function(t) {
    return !t.bold || t.font ? "" : "\\".concat(Je.Font, "|b1|i0|c134|p49;");
  },
  italic: function(t) {
    return !t.italic || t.font ? "" : "\\".concat(Je.Font, "|b0|i1|c134|p49;");
  },
  underline: function(t) {
    return t.underline ? "\\".concat(Je.Underline) : "";
  },
  overline: function(t) {
    return t.overline ? "\\".concat(Je.Overline) : "";
  },
  strike: function(t) {
    return t.strike ? "\\".concat(Je.Strike) : "";
  },
  tiltAngle: function(t) {
    var r = t.tiltAngle;
    return r === void 0 ? "" : "\\".concat(Je.TiltAngle).concat(r, ";");
  },
  tracking: function(t) {
    var r = t.tracking;
    return r === void 0 ? "" : "\\".concat(Je.Tracking).concat(r, ";");
  },
  widthFactor: function(t) {
    var r = t.widthFactor;
    return r === void 0 ? "" : "\\".concat(Je.WidthFactor).concat(r, ";");
  }
};
function O2(e) {
  var t = "";
  return e.underline && (t += "\\".concat(Je.Underline)), e.overline && (t += "\\".concat(Je.Overline)), e.strike && (t += "\\".concat(Je.Strike)), t || "";
}
function f1(e) {
  var t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, r = t.isDecorative, n = r === void 0 ? !0 : r, i = "", a = L2(e), s = Object.keys(a).length > 0, o = Vv(e.text);
  if (s) {
    i += "{", (a.font !== void 0 || a.bold === !0 || a.italic === !0) && (i += em.font(e));
    for (var u = 0, l = ["fontSize", "color", "tiltAngle", "tracking", "widthFactor"]; u < l.length; u++) {
      var c = l[u];
      if (a[c] !== void 0) {
        var f = em[c];
        i += f(e);
      }
    }
    if (n) {
      var h = a.underline === !0 || a.overline === !0 || a.strike === !0;
      h && (i += O2(a));
    }
    var d = e.textPosition;
    d === "superscript" ? i += "\\".concat(Je.SuperSubScript).concat(fu(o), "^;") : d === "subscript" ? i += "\\".concat(Je.SuperSubScript, "^").concat(fu(o), ";") : i += fu(o), i += "}";
  } else
    i += fu(o);
  return i;
}
function N2(e) {
  var t = Hn.Left;
  switch (e) {
    case "center":
      t = Hn.Center;
      break;
    case "right":
      t = Hn.Right;
      break;
    case "justify":
      t = Hn.Justify;
      break;
    case "distribute":
      t = Hn.Distribute;
      break;
    case "left":
    default:
      t = Hn.Left;
      break;
  }
  return "\\pxq".concat(t, ";");
}
function U2(e) {
  if (e.type !== "paragraph")
    return "";
  var t = "";
  e.alignment !== void 0 && (t += N2(e.alignment)), e.lineHeightRatio !== void 0 && (t += "\\".concat(Je.LineSpacing).concat(e.lineHeightRatio.toFixed(2), ";"));
  var r = c1(e.children), n;
  try {
    for (r.s(); !(n = r.n()).done; ) {
      var i = n.value;
      t += f1(i);
    }
  } catch (a) {
    r.e(a);
  } finally {
    r.f();
  }
  return t;
}
function G2(e) {
  var t = [], r = c1(e), n;
  try {
    for (r.s(); !(n = r.n()).done; ) {
      var i = n.value, a = i, s = U2(a);
      t.push(s);
    }
  } catch (o) {
    r.e(o);
  } finally {
    r.f();
  }
  return t.join("\\".concat(Je.Paragraph));
}
function tm(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function rm(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? tm(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : tm(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
var Td = /* @__PURE__ */ new Map(), nm = 4;
function z2(e, t, r) {
  var n = e.font, i = n === void 0 ? "" : n, a = e.fontSize, s = a === void 0 ? 0 : a, o = e.bold, u = o === void 0 ? !1 : o, l = e.italic, c = l === void 0 ? !1 : l, f = e.underline, h = f === void 0 ? !1 : f, d = e.strike, g = d === void 0 ? !1 : d, v = e.overline, m = v === void 0 ? !1 : v, p = e.type, y = p === void 0 ? "" : p, w = e.tiltAngle, x = w === void 0 ? 0 : w, b = e.tracking, M = b === void 0 ? 0 : b, k = e.widthFactor, E = k === void 0 ? 0 : k, S = e.textPosition, F = S === void 0 ? "" : S;
  return "".concat(y, "_").concat(F, "_").concat(r, "_").concat(i, "_").concat(s, "_").concat(Number(u), "_").concat(Number(c), "_").concat(Number(h), "_").concat(Number(g), "_").concat(Number(m), "_").concat(x, "_").concat(M, "_").concat(E, "_").concat(t);
}
function Th(e, t, r, n, i, a) {
  var s = Td.get(t);
  if ((!s || s.baseHeight !== n) && (s = {
    charWidths: /* @__PURE__ */ new Map(),
    baseHeight: n
  }, Td.set(t, s)), !s.charWidths.has(e)) {
    var o = e.repeat(nm), u = h1(o, r, n, i, a), l = u / nm;
    s.charWidths.set(e, l);
  }
  return s.charWidths.get(e);
}
function h1(e, t, r, n, i, a) {
  var s = rm(rm({}, t), {}, {
    text: Vv(e)
  }), o = I2(s, {
    position: new te(0, 0, 0),
    baseHeight: r,
    style: n,
    ent: i
  }), u = o.width, l = (t == null ? void 0 : t.tracking) || 1;
  return (t.textPosition === "superscript" || t.textPosition === "subscript") && (l = 0.5), u * l + 0;
}
function W2(e, t, r, n, i, a) {
  if (e.length === 0) return 0;
  var s = z2(t, r, n);
  if (e.length === 1 || Td.has(s))
    return Th(e, s, t, r, n, i);
  for (var o = 0, u = 0, l = /[^\u4e00-\u9fa5]/; u < e.length; )
    if (l.test(e[u])) {
      for (var c = ""; u < e.length && l.test(e[u]); )
        c += e[u], u++;
      o += h1(c, t, r, n, i);
    } else
      o += Th(e[u], s, t, r, n, i), u++;
  return o;
}
function ea(e, t, r, n, i) {
  if (t.type && bt.elementTextManager.hasText(t.type)) {
    var a = Ca(i, t) || {
      width: 0
    }, s = a.width;
    return s;
  }
  var o = W2(e, t, r, n, i);
  return o;
}
function im(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function V2(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? im(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : im(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
function H2(e, t, r, n) {
  var i = t.children;
  if (i.length === 0 || i.length === 1 && Lr(i[0]) && i[0].text === "") {
    var a = 0, s = [n, 0], o = i[0], u = {
      nodes: [{
        node: o || V2({
          text: ""
        }, /* @__PURE__ */ Object.create(null)),
        path: s,
        startOffset: 0,
        endOffset: 0,
        width: a,
        height: r,
        index: 0
      }],
      height: r,
      width: 0,
      breakInfo: {
        isWrapped: !1,
        breakType: Ei.None
      },
      horizontalOffset: 0
    };
    return {
      width: 0,
      height: r,
      lines: [u]
    };
  }
  var l, c = !1;
  if (t.type === "paragraph") {
    var f = t;
    c = f.alignment === "distribute";
  }
  if (e.isWordWrap) {
    var h = e.getMTextImp();
    l = T2(e, i, n, {
      maxWidth: h.maxWidth,
      baseHeight: r,
      getTextWidth: function() {
        for (var x = arguments.length, b = new Array(x), M = 0; M < x; M++)
          b[M] = arguments[M];
        return ea.apply(void 0, b.concat([e.textStyle, e]));
      },
      getTextHeight: function(x, b) {
        var M = Da(x, b, e);
        return M;
      },
      style: e.textStyle,
      isWidthOffset: c
    });
  } else {
    var d = i.reduce(function(w, x) {
      if (Kt(x)) {
        var b = li(e, x), M = b.width;
        return w + M;
      } else
        return w + ea(x.text, x, r, e.textStyle, e);
    }, 0), g = Math.max.apply(Math, Xt(i.map(function(w) {
      if (Kt(w)) {
        var x = li(e, w), b = x.height;
        return b;
      } else
        return Da(w, r, e);
    })));
    l = [{
      nodes: i.map(function(w, x) {
        var b = 0, M = 0;
        if (Kt(w)) {
          var k = li(e, w), E = k.width, S = k.height;
          b = E, M = S;
        } else
          b = ea(w.text, w, r, e.textStyle, e), M = Da(w, r, e);
        return {
          node: w,
          path: [n, x],
          startOffset: 0,
          endOffset: Lr(w) ? w.text.length : 0,
          width: b,
          height: M,
          index: x
        };
      }),
      height: g,
      width: d,
      breakInfo: {
        isWrapped: !1,
        breakType: Ei.None
      }
    }];
  }
  var v = e.lineHeightRatio;
  if (t.type === "paragraph") {
    var m = t;
    m.lineHeightRatio !== void 0 && (v = m.lineHeightRatio);
  }
  var p = l.reduce(function(w, x) {
    return w + x.height + x.height * (v - 1);
  }, 0), y = Math.max.apply(Math, Xt(l.map(function(w) {
    return w.width;
  })));
  return {
    width: y,
    height: p,
    lines: l,
    lineHeightRatio: v
  };
}
function j2(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = X2(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function X2(e, t) {
  if (e) {
    if (typeof e == "string") return am(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? am(e, t) : void 0;
  }
}
function am(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function sm(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function om(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? sm(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : sm(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
var Nn = function(t, r, n, i) {
  var a = new te(r.x, r.y, r.z), s = new te(n.x, n.y, n.z), o = new st(a, s);
  return i && o.transformBy(i), t.drawEntity(o), o;
};
function q2(e, t, r) {
  if (e === 10)
    return 0;
  if (e === 11)
    return t >= r || t === 0, 0;
  switch (e) {
    case Ie.AttachmentPoint.kMiddleCenter:
    case Ie.AttachmentPoint.kTopCenter:
    case Ie.AttachmentPoint.kBottomCenter:
      return (r - t) / 2;
    case Ie.AttachmentPoint.kMiddleRight:
    case Ie.AttachmentPoint.kTopRight:
    case Ie.AttachmentPoint.kBottomRight:
      return r - t;
    default:
      return 0;
  }
}
function $2(e, t, r) {
  return e.map(function(n) {
    return om(om({}, n), {}, {
      horizontalOffset: q2(t, n.width, r)
    });
  });
}
function Y2(e) {
  switch (e) {
    case "center":
      return Ie.AttachmentPoint.kTopCenter;
    case "right":
      return Ie.AttachmentPoint.kTopRight;
    case "justify":
      return 10;
    case "distribute":
      return 11;
    case "left":
    default:
      return Ie.AttachmentPoint.kTopLeft;
  }
}
var K2 = function(t, r, n) {
  var i = n.position, a = n.height, s = n.lines, o = n.width, u = n.transformsMatrix, l = n.node, c = [], f = 0, h = /* @__PURE__ */ new WeakMap(), d = /* @__PURE__ */ new Set(), g = t.lineHeightRatio;
  if (l.type === "paragraph") {
    var v = l;
    v.lineHeightRatio !== void 0 && (g = v.lineHeightRatio);
  }
  var m = function() {
    var M = Array.from(d), k = M[0];
    if (!k) return 0;
    var E = h.get(k);
    if (!E) return 0;
    var S = E.positionInfo, F = E.lineHeight, O = 0, D = 0, _ = Array.from(d).map(function(C) {
      var Z = h.get(C), W = Object.assign({}, C);
      if (Z) {
        W.text = Z.text;
        var J = Da(C, a, t);
        D = Math.max(D, J);
        var Q = Object.assign({}, S);
        if (Q.verticalOffset += F - J, Q.horizontalOffset += O, C.color) {
          var j = oo(C);
          j && (r.trueColor = j);
        } else if (t.trueColor.method === hn.kByColor)
          r.trueColor = t.trueColor;
        else {
          var q = new fr();
          q.setColorIndex(t.colorIndex), r.trueColor = q;
        }
        var ae = hu(Q), pe = ae.clone().addvec(Ve.kXAxis.clone().mult(Z.width)).addvec(Ve.kYAxis.clone().negate().mult(J));
        C.underline && c.push(Nn(r, new te(ae.x, pe.y), pe, x.isEditState ? void 0 : u)), C.strike && c.push(Nn(r, ae.clone().addvec(Ve.kYAxis.clone().mult(-J * 0.5)), pe.clone().subvec(Ve.kYAxis.clone().mult(-J * 0.5)), x.isEditState ? void 0 : u)), C.overline && c.push(Nn(r, ae, new te(pe.x, ae.y, ae.z), x.isEditState ? void 0 : u)), r.trueColor = t.trueColor, O += Z.width;
      }
      return W;
    });
    S.verticalOffset += F - D;
    var L = O, G = Math.max(o, O), V = new Ia(), H = "", U = j2(_), R;
    try {
      for (U.s(); !(R = U.n()).done; ) {
        var B = R.value;
        H += f1(B, {
          isDecorative: !1
        });
      }
    } catch (C) {
      U.e(C);
    } finally {
      U.f();
    }
    return p === 11 && H.length > 1 && G < o && (H = "\\pxqd;".concat(H)), V.contents = H, V.textHeight = a, V.location = hu(S), V.trueColor = t.trueColor, V.textStyle = t.textStyle, d.clear(), h = /* @__PURE__ */ new WeakMap(), x.isEditState || V.transformBy(u), r.drawEntity(V), c.push(V), L;
  }, p = t.textAlignment;
  if (Kt(l) && l.type === "paragraph") {
    var y = l;
    y.alignment && (y.alignment === "justify" ? p = t.textAlignment : p = Y2(y.alignment));
  }
  var w = $2(s, p, o), x = t.getMTextImp();
  return w.forEach(function(b) {
    var M = b.horizontalOffset || 0, k = b.nodes.reduce(function(E, S) {
      return Lr(S.node) && S.node.type && bt.elementTextManager.hasText(S.node.type) || Kt(S.node) ? E + 1 : E + (S.endOffset - S.startOffset);
    }, 0);
    b.nodes.forEach(function(E) {
      var S = {
        basePosition: i,
        horizontalOffset: M,
        verticalOffset: f + b.height
      }, F = k === 1 && E.hasCharLevelSpacing;
      if (F && (S.horizontalOffset += E.extraCharSpacing || 0), Lr(E.node)) {
        var O = E.node.textPosition === "superscript" || E.node.textPosition === "subscript";
        if (E.node.type && bt.elementTextManager.hasText(E.node.type)) {
          var D = m();
          M += D;
          var _ = bt.elementTextManager.getText(E.node.type), L = Ca(t, E.node), G = L || {
            width: 0,
            height: 0
          }, V = G.width, H = G.height;
          S.verticalOffset -= H, F || (S.horizontalOffset = M);
          var U = hu(S), R = (_ == null ? void 0 : _.create(t, E.node, L || {
            width: V,
            height: H
          }, {
            position: U
          })) || [];
          R.forEach(function(Jt) {
            var dr = u1(E.node, Jt);
            x.isEditState || Jt.transformBy(u), dr && (r.trueColor = dr), r.drawEntity(Jt);
          }), c.push.apply(c, Xt(R)), M += V + (E.extraCharSpacing || 0);
        } else if (O) {
          var B = m();
          M += B, F || (S.horizontalOffset = M);
          var C = E.node.text.substring(E.startOffset, E.endOffset), Z = (t.getMTextImp().entityType === "mtext" && !t.getMTextImp().isEditState ? E.hasCharLevelSpacing && b.isEndLine : E.hasCharLevelSpacing) || E.node.tracking, W = {
            basePosition: S.basePosition.clone(),
            horizontalOffset: S.horizontalOffset,
            verticalOffset: S.verticalOffset - b.height
          }, J = Da(E.node, a / 2, t);
          if (E.node.textPosition === "superscript" ? b.height > E.height && (W.verticalOffset -= b.height - E.height) : W.verticalOffset += b.height - J, Z)
            for (var Q = 0; Q < C.length; Q++) {
              var j = C[Q], q = Ah({
                node: E.node,
                text: j,
                height: a / 2,
                position: W,
                style: t.textStyle,
                ent: t
              });
              x.isEditState || q.transformBy(u);
              var ae = E.width / C.length, pe = 0;
              if (E.hasCharLevelSpacing) {
                var $ = b.nodes.indexOf(E) === b.nodes.length - 1, se = Q === C.length - 1;
                $ && se || (pe = E.extraCharSpacing || 0);
              }
              E.node.tracking && (pe += E.node.tracking * (a / 2));
              var ve = ae + pe, me = q.location.clone(), Ae = me.clone().addvec(Ve.kXAxis.clone().mult(ve)).addvec(Ve.kYAxis.clone().negate().mult(J));
              if (E.node.color) {
                var Ce = oo(E.node);
                Ce && (r.trueColor = Ce);
              } else if (t.trueColor.method === hn.kByColor)
                r.trueColor = t.trueColor;
              else {
                var Ee = new fr();
                Ee.setColorIndex(t.colorIndex), r.trueColor = Ee;
              }
              if (E.node.underline) {
                var Y = Nn(r, new te(me.x, Ae.y, me.z), new te(Ae.x, Ae.y, me.z), x.isEditState ? void 0 : u);
                c.push(Y);
              }
              if (E.node.strike) {
                var ee = me.y - J * 0.5, Me = Nn(r, new te(me.x, ee, me.z), new te(Ae.x, ee, me.z), x.isEditState ? void 0 : u);
                c.push(Me);
              }
              if (E.node.overline) {
                var ye = Nn(r, new te(me.x, me.y, me.z), new te(Ae.x, me.y, me.z), x.isEditState ? void 0 : u);
                c.push(ye);
              }
              r.drawEntity(q), c.push(q), r.trueColor = t.trueColor, W.horizontalOffset += ve, M += ve;
            }
          else {
            var De = Ah({
              node: E.node,
              text: C,
              height: a / 2,
              position: W,
              style: t.textStyle,
              ent: t
            });
            if (x.isEditState || De.transformBy(u), E.node.color) {
              var Se = oo(E.node);
              Se && (r.trueColor = Se);
            } else if (t.trueColor.method === hn.kByColor)
              r.trueColor = t.trueColor;
            else {
              var fe = new fr();
              fe.setColorIndex(t.colorIndex), r.trueColor = fe;
            }
            r.drawEntity(De), c.push(De);
            var ke = De.location.clone(), ne = ke.clone().addvec(Ve.kXAxis.clone().mult(E.width)).addvec(Ve.kYAxis.clone().negate().mult(J));
            if (E.node.underline) {
              var Te = Nn(r, new te(ke.x, ne.y, ke.z), new te(ne.x, ne.y, ke.z), x.isEditState ? void 0 : u);
              c.push(Te);
            }
            if (E.node.strike) {
              var I = ke.y - J * 0.5, A = Nn(r, new te(ke.x, I, ke.z), new te(ne.x, I, ke.z), x.isEditState ? void 0 : u);
              c.push(A);
            }
            if (E.node.overline) {
              var T = Nn(r, new te(ke.x, ke.y, ke.z), new te(ne.x, ke.y, ke.z), x.isEditState ? void 0 : u);
              c.push(T);
            }
            r.trueColor = t.trueColor, M += E.width + (E.extraCharSpacing || 0);
          }
        } else if ((t.getMTextImp().entityType === "mtext" && !t.getMTextImp().isEditState ? E.hasCharLevelSpacing && b.isEndLine : E.hasCharLevelSpacing) || E.node.tracking) {
          var P = m();
          M += P, F || (S.horizontalOffset = M);
          var z = E.node.text.substring(E.startOffset, E.endOffset), K = Da(E.node, a, t);
          S.verticalOffset -= K;
          for (var oe = 0; oe < z.length; oe++) {
            var ce = z[oe], ge = Ah({
              node: E.node,
              text: Vv(ce),
              height: a,
              position: S,
              style: t.textStyle,
              ent: t
            });
            x.isEditState || ge.transformBy(u);
            var Oe = ea(ce, E.node, a, t.textStyle, t), Ge = 0;
            if (E.hasCharLevelSpacing)
              if (k === 1)
                Ge = 0;
              else {
                var We = b.nodes.indexOf(E) === b.nodes.length - 1, $e = oe === z.length - 1;
                We && $e || (Ge = E.extraCharSpacing || 0);
              }
            var pt = Oe + Ge;
            S.horizontalOffset += pt;
            var tt = ge.location.clone(), xt = tt.clone().addvec(Ve.kXAxis.clone().mult(pt)).addvec(Ve.kYAxis.clone().negate().mult(K));
            if (E.node.color) {
              var ht = oo(E.node);
              ht && (r.trueColor = ht);
            } else if (t.trueColor.method === hn.kByColor)
              r.trueColor = t.trueColor;
            else {
              var Vt = new fr();
              Vt.setColorIndex(t.colorIndex), r.trueColor = Vt;
            }
            if (E.node.underline) {
              var qe = Nn(r, new te(tt.x, xt.y, tt.z), new te(xt.x, xt.y, tt.z), x.isEditState ? void 0 : u);
              c.push(qe);
            }
            if (E.node.strike) {
              var ze = tt.y - K * 0.5, He = Nn(r, new te(tt.x, ze, tt.z), new te(xt.x, ze, tt.z), x.isEditState ? void 0 : u);
              c.push(He);
            }
            if (E.node.overline) {
              var Ht = Nn(r, new te(tt.x, tt.y, tt.z), new te(xt.x, tt.y, tt.z), x.isEditState ? void 0 : u);
              c.push(Ht);
            }
            r.drawEntity(ge), c.push(ge), r.trueColor = t.trueColor, M += pt;
          }
        } else {
          d.add(E.node);
          var mt = E.node.text.substring(E.startOffset, E.endOffset);
          if (!h.has(E.node))
            S.verticalOffset -= b.height, h.set(E.node, {
              positionInfo: S,
              text: mt,
              width: E.width,
              lineHeight: b.height
            });
          else {
            var vt = h.get(E.node);
            vt && (vt.text += mt, vt.width += E.width);
          }
        }
      } else if (Kt(E.node)) {
        var Ct = m();
        M += Ct, F || (S.horizontalOffset = M);
        var Rt = bt.elementTextManager.get(E.node.type), St = li(t, E.node), zt = St.width, nr = St.height;
        S.verticalOffset -= nr;
        var ir = hu(S), ar = (Rt == null ? void 0 : Rt.render(t, r, E.node, St, {
          position: ir,
          index: E.index,
          alignmentWidth: zt
        })) || {}, gt = ar.entitys, Dt = gt === void 0 ? [] : gt;
        Dt.forEach(function(Jt) {
          x.isEditState || Jt.transformBy(u);
        }), c.push.apply(c, Xt(Dt)), M += zt + (E.extraCharSpacing || 0);
      }
    }), m(), f += b.height + b.height * (g - 1);
  }), {
    entitys: c,
    position: i,
    width: n.width,
    height: f,
    lines: w,
    lineHeightRatio: g
  };
};
function Z2(e) {
  var t = d1();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function d1() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (d1 = function() {
    return !!e;
  })();
}
var J2 = "paragraph", Q2 = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Z2(r);
  function r() {
    var n;
    Pe(this, r);
    for (var i = arguments.length, a = new Array(i), s = 0; s < i; s++)
      a[s] = arguments[s];
    return n = t.call.apply(t, [this].concat(a)), le(dt(n), "type", J2), n;
  }
  return Be(r, [{
    key: "render",
    value: function(i, a, s, o, u) {
      var l = u.position;
      u.index;
      var c = u.alignmentWidth, f = i.textBaseHeight;
      i.isWordWrap;
      var h = i.getMTextImp(), d = h.mat;
      return K2(i, a, {
        position: l,
        height: f,
        lines: o.lines || [],
        width: c,
        contentHeight: o.height,
        transformsMatrix: d,
        node: s
      });
    }
  }, {
    key: "calculate",
    value: function(i, a, s) {
      return H2(i, a, i.textBaseHeight, s);
    }
  }]), r;
}(Wv), ex = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "elementMap", /* @__PURE__ */ new Map()), le(this, "textMap", /* @__PURE__ */ new Map()), le(this, "specialCharacterMap", /* @__PURE__ */ new Map()), this.registerElement(new Q2()), this.registerSpecialCharacter("", "%%C"), this.registerSpecialCharacter("", "%%C"), this.registerSpecialCharacter("", "%%P"), this.registerSpecialCharacter("", "%%D");
  }
  return Be(e, [{
    key: "registerElement",
    value: function(r) {
      this.elementMap.set(r.type, r);
    }
  }, {
    key: "registerTextNode",
    value: function(r) {
      this.textMap.set(r.type, r);
    }
  }, {
    key: "registerSpecialCharacter",
    value: function(r, n) {
      this.specialCharacterMap.set(r, n);
    }
  }, {
    key: "forEachSpecialCharacter",
    value: function(r) {
      this.specialCharacterMap.forEach(r);
    }
  }, {
    key: "getText",
    value: function(r) {
      return this.textMap.get(r);
    }
  }, {
    key: "hasText",
    value: function(r) {
      return this.textMap.has(r);
    }
  }, {
    key: "get",
    value: function(r) {
      return this.elementMap.get(r);
    }
  }, {
    key: "has",
    value: function(r) {
      return this.elementMap.has(r);
    }
  }]), e;
}(), tx = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "events", void 0), this.events = {};
  }
  return Be(e, [{
    key: "on",
    value: function(r, n) {
      var i = this;
      i.events.hasOwnProperty(r) || (i.events[r] = []), i.events[r].push(n);
    }
  }, {
    key: "once",
    value: function(r, n) {
      var i = this, a = function s() {
        n.apply(void 0, arguments), i.off(r, s);
      };
      this.on(r, a);
    }
  }, {
    key: "emit",
    value: function(r) {
      for (var n = arguments.length, i = new Array(n > 1 ? n - 1 : 0), a = 1; a < n; a++)
        i[a - 1] = arguments[a];
      var s = this;
      s.events.hasOwnProperty(r) && s.events[r].map(function(o) {
        return o.apply(void 0, i);
      });
    }
  }, {
    key: "off",
    value: function(r, n) {
      if (this.events[r])
        if (typeof n == "undefined")
          this.events[r] = [];
        else {
          var i = this.events[r].indexOf(n);
          this.events[r].splice(i, 1);
        }
    }
  }]), e;
}();
function rx() {
  var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : this.actualHeight, t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.actualWidth, r = this.getTopLeftPt(), n = r.y - this.maxHeight / 2, i = r.x + this.maxWidth / 2, a = r.y, s = r.x;
  switch (this.textAlignment) {
    case Ie.AttachmentPoint.kMiddleLeft:
    case Ie.AttachmentPoint.kMiddleCenter:
    case Ie.AttachmentPoint.kMiddleRight: {
      a = n + e / 2;
      break;
    }
    case Ie.AttachmentPoint.kBottomLeft:
    case Ie.AttachmentPoint.kBottomCenter:
    case Ie.AttachmentPoint.kBottomRight: {
      var o = r.y - this.maxHeight;
      a = o + e;
      break;
    }
    default:
      a = r.y;
  }
  if (t > this.maxWidth)
    switch (this.textAlignment) {
      case Ie.AttachmentPoint.kTopCenter:
      case Ie.AttachmentPoint.kMiddleCenter:
      case Ie.AttachmentPoint.kBottomCenter: {
        s = i - t / 2;
        break;
      }
      case Ie.AttachmentPoint.kTopRight:
      case Ie.AttachmentPoint.kMiddleRight:
      case Ie.AttachmentPoint.kBottomRight: {
        s = r.x + this.maxWidth - t;
        break;
      }
      default:
        s = r.x;
    }
  else
    switch (this.textAlignment) {
      case Ie.AttachmentPoint.kTopCenter:
      case Ie.AttachmentPoint.kMiddleCenter:
      case Ie.AttachmentPoint.kBottomCenter: {
        s = i - t / 2;
        break;
      }
      case Ie.AttachmentPoint.kTopRight:
      case Ie.AttachmentPoint.kMiddleRight:
      case Ie.AttachmentPoint.kBottomRight: {
        s = r.x + this.maxWidth - t;
        break;
      }
      default:
        s = r.x;
    }
  return new te(s, a, r.z);
}
var p1 = function(t, r, n) {
  for (var i = 0, a = t.getMTextImp(), s = 0; s < n; s++) {
    var o = a.getParagrapInfo(s), u = o.height;
    u && (i += u);
  }
  return r.clone().subvec(Ve.kYAxis.clone().mult(i));
}, $c = function(t, r, n) {
  var i, a, s = 0;
  if (!t.lines || ((i = t.lines) === null || i === void 0 ? void 0 : i.length) === 0) return {
    accumulatedHeight: 0,
    lineHeight: 0
  };
  for (var o = 0; o < r; o++) {
    var u = t.lines[o];
    s += u.height + u.height * ((t.lineHeightRatio || n) - 1);
  }
  var l = ((a = t.lines[r]) === null || a === void 0 ? void 0 : a.height) || 0;
  return {
    accumulatedHeight: s,
    lineHeight: l
  };
}, nx = function(t, r, n) {
  var i = n.accumulatedHeight, a = n.lineHeight, s = t.y - i, o = s - a;
  return {
    start: new te(t.x, s),
    end: new te(t.x + r, s),
    minPt: new te(t.x, s),
    maxPt: new te(t.x + r, o),
    height: a
  };
};
function ix(e, t) {
  var r = this.__PARAGRAPH_INFOS__[e];
  if (!r) return null;
  var n = r.position, i = r.lines;
  if (!i || !n) return null;
  var a = i[t];
  if (!a) return null;
  var s = $c(r, t, this.lineHeightRatio), o = 0, u = a.nodes.some(function(p) {
    return p.extraCharSpacing;
  });
  if (u) {
    var l = a.nodes.reduce(function(p, y) {
      return Kt(y.node) || Lr(y.node) && y.node.type && bt.elementTextManager.hasText(y.node.type) ? p + 1 : p + (y.endOffset - y.startOffset);
    }, 0);
    if (l === 1) {
      var c = a.nodes[0];
      o = c.width, c.extraCharSpacing && (o += c.extraCharSpacing);
    } else if (l === 2)
      for (var f = 0; f < a.nodes.length; f++) {
        var h = a.nodes[f];
        o += h.width, f === 0 && h.extraCharSpacing && (o += h.extraCharSpacing * 2);
      }
    else
      for (var d = 0; d < a.nodes.length; d++) {
        var g = a.nodes[d];
        if (o += g.width, g.extraCharSpacing) {
          var v = d === a.nodes.length - 1, m = 0;
          Lr(g.node) && g.node.type && bt.elementTextManager.hasText(g.node.type) || Kt(g.node) ? (o += g.extraCharSpacing, m = 1) : m = g.endOffset - g.startOffset, v ? o += g.extraCharSpacing * Math.max(0, m - 1) : o += g.extraCharSpacing * m;
        }
      }
  } else
    o = a.nodes.reduce(function(p, y) {
      return p + y.width;
    }, 0);
  return nx(n, o, s);
}
function ax(e) {
  var t = v1();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function v1() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (v1 = function() {
    return !!e;
  })();
}
var sx = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = ax(r);
  function r() {
    var n;
    Pe(this, r);
    for (var i = arguments.length, a = new Array(i), s = 0; s < i; s++)
      a[s] = arguments[s];
    return n = t.call.apply(t, [this].concat(a)), le(dt(n), "position", new te()), le(dt(n), "maxWidth", 0), le(dt(n), "maxHeight", 0), le(dt(n), "textBaseHeight", 20), le(dt(n), "data", void 0), le(dt(n), "isWordWrap", !0), le(dt(n), "textAlignment", Ie.AttachmentPoint.kTopLeft), le(dt(n), "actualHeight", 0), le(dt(n), "actualWidth", 0), le(dt(n), "mat", new Jr()), le(dt(n), "angle", 0), le(dt(n), "lineHeightRatio", 1.66666), le(dt(n), "entityType", "custom"), le(dt(n), "isIntegrityLockedMText", !0), le(dt(n), "isEditState", !1), le(dt(n), "__PARAGRAPH_INFOS__", []), le(dt(n), "getActualRenderStartPosition", rx), le(dt(n), "getLinePosition", ix), le(dt(n), "getTextHeight", Da), le(dt(n), "getColor", oo), n;
  }
  return Be(r, [{
    key: "isCustomTextOrElement",
    get: function() {
      var i = this;
      if (!this.data || this.data.length === 0)
        return !1;
      var a = function s(o) {
        if (Lr(o)) {
          if (o.type && bt.elementTextManager.hasText(o.type)) return !0;
          if (i.isIntegrityLockedMText) return !1;
          if ("textPosition" in o && (o.textPosition === "superscript" || o.textPosition === "subscript") || "tracking" in o && o.tracking !== 1 || "underline" in o && o.underline || "strike" in o && o.strike || "overline" in o && o.overline)
            return !0;
        }
        if (Kt(o)) {
          var u = function(c) {
            return c.type === "paragraph";
          };
          if (u(o)) {
            if (o.alignment === "distribute" || typeof o.lineHeightRatio == "number" && o.lineHeightRatio !== i.lineHeightRatio) return !0;
          } else if (bt.elementTextManager.has(o.type))
            return !0;
          return o.children.some(s);
        }
        return !1;
      };
      return this.data.some(a);
    }
  }, {
    key: "dwgInFields",
    value: function(i) {
      this.position = i.readPoint("position").val, this.maxWidth = i.readDouble("maxWidth").val, this.maxHeight = i.readDouble("maxHeight").val, this.textBaseHeight = i.readDouble("textBaseHeight").val;
      var a = i.readString("data").val;
      this.data = JSON.parse(a), this.textAlignment = i.readDouble("textAlignment").val, this.angle = i.readDouble("angle").val, this.lineHeightRatio = i.readDouble("lineHeightRatio").val || 1;
      for (var s = i.readString("mat").val, o = JSON.parse(s), u = 0; u < o.length; u++)
        for (var l = o[u], c = 0; c < l.length; c++) {
          var f = l[c];
          this.mat.setData(u, c, f);
        }
      return this.isWordWrap = i.readDouble("isWordWrap").val === 1, this.entityType = i.readString("entityType").val || "custom", !0;
    }
  }, {
    key: "dwgOutFields",
    value: function(i) {
      i.writePoint("position", this.position), i.writeDouble("maxWidth", this.maxWidth), i.writeDouble("maxHeight", this.maxHeight), i.writeDouble("textBaseHeight", this.textBaseHeight), i.writeString("data", JSON.stringify(this.data)), i.writeDouble("textAlignment", this.textAlignment), i.writeDouble("angle", this.angle), i.writeDouble("lineHeightRatio", this.lineHeightRatio), i.writeDouble("isWordWrap", this.isWordWrap ? 1 : 0), i.writeString("entityType", this.entityType);
      for (var a = [], s = 0; s < 4; s++) {
        a[s] = [];
        for (var o = 0; o < 4; o++) {
          var u = this.mat.getData(s, o);
          a[s][o] = u;
        }
      }
      return i.writeString("mat", JSON.stringify(a)), !0;
    }
  }, {
    key: "getGripPoints",
    value: function() {
      var i = new Xr();
      if (this.isEditState)
        return i;
      var a = this.position.clone(), s = new te(this.position.x + this.maxWidth, this.position.y, this.position.z), o = new te(this.position.x + this.maxWidth / 2, this.position.y - this.maxHeight, this.position.z), u = a.transformBy(this.mat), l = s.transformBy(this.mat), c = o.transformBy(this.mat);
      return i.append(u), i.append(l), i.append(c), i;
    }
  }, {
    key: "moveGripPointsAt",
    value: function(i, a, s, o) {
      var u = new Jr();
      if (u.copy(this.mat), u.invert(), i === 0) {
        var l = this.position.clone().transformBy(this.mat);
        l.x += a, l.y += s, l.z += o, this.position = l.transformBy(u);
      } else if (i === 1) {
        var c = new te(this.position.x + this.maxWidth, this.position.y, this.position.z), f = c.clone().transformBy(this.mat);
        f.x += a, f.y += s, f.z += o;
        var h = f.transformBy(u);
        this.maxWidth = h.x - this.position.x, this.maxWidth <= 0 && (this.maxWidth = this.textBaseHeight);
      } else if (i === 2) {
        var d = new te(this.position.x + this.maxWidth / 2, this.position.y - this.maxHeight, this.position.z), g = d.clone().transformBy(this.mat);
        g.x += a, g.y += s, g.z += o;
        var v = g.transformBy(u);
        this.maxHeight = this.position.y - v.y, this.maxHeight < 0 && (this.maxHeight = 0);
      }
    }
  }, {
    key: "getParagraphLines",
    value: function(i) {
      var a = this.__PARAGRAPH_INFOS__[i];
      return (a == null ? void 0 : a.lines) || [];
    }
  }, {
    key: "getParagrapInfo",
    value: function(i) {
      var a = this.__PARAGRAPH_INFOS__[i];
      return a;
    }
  }, {
    key: "getLineCount",
    value: function(i) {
      var a, s = this.__PARAGRAPH_INFOS__[i];
      return s ? (a = s.lines) === null || a === void 0 ? void 0 : a.length : 0;
    }
  }, {
    key: "setData",
    value: function(i) {
      this.data = i;
    }
  }, {
    key: "getTopLeftPt",
    value: function() {
      return this.isEditState ? this.position.clone().transformBy(this.mat) : this.position.clone();
    }
  }, {
    key: "getLineHorizontalOffset",
    value: function(i, a) {
      var s, o = this.__PARAGRAPH_INFOS__[i];
      return !o || !((s = o.lines) !== null && s !== void 0 && s[a]) ? 0 : o.lines[a].horizontalOffset || 0;
    }
  }, {
    key: "getTotalContentHeight",
    value: function() {
      return this.__PARAGRAPH_INFOS__.reduce(function(i, a) {
        return i + ((a == null ? void 0 : a.height) || 0);
      }, 0);
    }
  }, {
    key: "setEntityType",
    value: function(i) {
      this.entityType !== i && (this.entityType = i);
    }
  }]), r;
}(tx), Sh;
function um(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function Zi(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? um(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : um(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
function ox(e) {
  var t = e;
  return bt.elementTextManager.forEachSpecialCharacter(function(r, n) {
    var i = r.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
    t = t.replace(new RegExp(i, "g"), n);
  }), t;
}
function us(e, t, r) {
  Sa(e), e.formats = Zi(Zi({}, e.formats), {}, le({}, t, r));
}
function Fs(e, t) {
  return function(r) {
    us(r, e, t);
  };
}
var Dl = (Sh = {}, le(le(le(le(le(le(le(le(le(le(Sh, Je.Paragraph, function(e) {
  Sa(e), e.currentBlock.children.length > 0 && e.blocks.push(e.currentBlock), e.currentBlock = {
    type: "paragraph",
    children: []
  };
}), Je.Color, function(e, t) {
  var r = parseInt(t, 10);
  us(e, "color", B2(r));
}), Je.ColorIndex, function(e, t) {
  var r = 0;
  try {
    r = parseInt(t, 10);
  } catch (n) {
    console.error(":", t);
  }
  us(e, "color", r);
}), Je.Font, lm), Je.FontAlt, lm), Je.FontHeight, function(e, t) {
  var r = t.replace(/x$/i, ""), n = parseFloat(r);
  us(e, "fontSize", n);
}), Je.Overline, Fs("overline", !0)), Je.OverlineEnd, Fs("overline", !1)), Je.Strike, Fs("strike", !0)), Je.StrikeEnd, Fs("strike", !1)), le(le(le(le(le(le(Sh, Je.Underline, Fs("underline", !0)), Je.UnderlineEnd, Fs("underline", !1)), Je.SuperSubScript, function(e, t) {
  Sa(e);
  var r = t;
  if (r.startsWith("^")) {
    var n = r.substring(1);
    if (n.length > 0) {
      var i = Zi(Zi({}, e.formats), {}, {
        textPosition: "subscript"
      });
      e.currentBlock.children.push(qc(n, i));
    }
  } else if (r.endsWith("^") && !r.startsWith("^")) {
    var a = r.substring(0, r.length - 1);
    if (a.length > 0) {
      var s = Zi(Zi({}, e.formats), {}, {
        textPosition: "superscript"
      });
      e.currentBlock.children.push(qc(a, s));
    }
  } else
    e.currentText += r;
}), Je.TiltAngle, function(e, t) {
  var r = parseFloat(t);
  isNaN(r) || us(e, "tiltAngle", r);
}), Je.Tracking, function(e, t) {
  var r = parseFloat(t);
  isNaN(r) || us(e, "tracking", r);
}), Je.WidthFactor, function(e, t) {
  var r = parseFloat(t);
  isNaN(r) || us(e, "widthFactor", r);
}));
function lm(e, t) {
  Sa(e);
  var r = t.split("|"), n = r[0], i = r.find(function(u) {
    return u.startsWith("b");
  }), a = r.find(function(u) {
    return u.startsWith("i");
  }), s = i === "b1", o = a === "i1";
  e.formats = Zi(Zi({}, e.formats), {}, {
    font: n || void 0,
    bold: s,
    italic: o
  });
}
function Sa(e) {
  e.currentText.length > 0 && (e.currentBlock.children.push(qc(e.currentText, e.formats)), e.currentText = "");
}
function cm(e) {
  switch (e) {
    case Je.Paragraph:
      return Je.Paragraph;
    case Je.Color:
      return Je.Color;
    case Je.ColorIndex:
      return Je.ColorIndex;
    case Je.Font:
      return Je.Font;
    case Je.FontAlt:
      return Je.FontAlt;
    case Je.FontHeight:
      return Je.FontHeight;
    case Je.Overline:
      return Je.Overline;
    case Je.OverlineEnd:
      return Je.OverlineEnd;
    case Je.Strike:
      return Je.Strike;
    case Je.StrikeEnd:
      return Je.StrikeEnd;
    case Je.Underline:
      return Je.Underline;
    case Je.UnderlineEnd:
      return Je.UnderlineEnd;
    case Je.TiltAngle:
      return Je.TiltAngle;
    case Je.Tracking:
      return Je.Tracking;
    case Je.WidthFactor:
      return Je.WidthFactor;
    case Je.SuperSubScript:
      return Je.SuperSubScript;
    default:
      return null;
  }
}
function fm(e) {
  var t = ["P", "O", "K", "L", "o", "k", "l"];
  return t.includes(e);
}
function ux(e) {
  switch (e) {
    case Hn.Center:
      return "center";
    case Hn.Right:
      return "right";
    case Hn.Justify:
      return "justify";
    case Hn.Distribute:
      return "distribute";
    case Hn.Left:
    default:
      return "left";
  }
}
function eu(e, t) {
  var r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : "";
  if (t === "p" && r.startsWith("xq") && r.length >= 3) {
    var n = r[2];
    return "clrjd".includes(n) ? (e.currentBlock.alignment = ux(n), !0) : !1;
  }
  if (t === "p" && r.startsWith("xsm") && r.length > 3) {
    var i = r.substring(3), a = parseFloat(i);
    return !isNaN(a) && a > 0 ? (e.currentBlock.lineHeightRatio = a, !0) : !1;
  }
  if (t === Je.SuperSubScript) {
    var s = r.endsWith(";") ? r.slice(0, -1) : r, o = cm(t);
    if (o && Dl[o])
      return Dl[o](e, s), !0;
  }
  var u = cm(t);
  return u && Dl[u] ? (Dl[u](e, r), !0) : !1;
}
function lx(e) {
  e = ox(e);
  for (var t = {
    currentText: "",
    formats: {},
    blocks: [],
    currentBlock: {
      type: "paragraph",
      children: []
    },
    inBlock: !1,
    inCommand: !1,
    commandBuffer: "",
    commandGroups: [],
    formatStack: []
  }, r = 0; r < e.length; ) {
    var n = e[r];
    if (t.inCommand)
      n === ";" || t.commandBuffer.length === 1 && fm(t.commandBuffer) ? (eu(t, t.commandBuffer, ""), t.inCommand = !1, t.commandBuffer = "", r++) : (t.commandBuffer += n, r++);
    else if (n === "\\")
      if (r + 1 < e.length) {
        var i = e[r + 1];
        if (i === "\\")
          t.currentText += "\\", r += 2;
        else if (i === "{" || i === "}")
          t.currentText += i, r += 2;
        else {
          if (Sa(t), i === Je.SuperSubScript) {
            for (var a = r + 2, s = 0, o = -1; a < e.length; ) {
              var u = e[a];
              if (u === "{")
                s++;
              else if (u === "}")
                s--;
              else if (u === ";" && s === 0) {
                o = a;
                break;
              }
              a++;
            }
            if (o !== -1) {
              var l = r + 2, c = e.substring(l, o);
              eu(t, i, c), r = o + 1;
              continue;
            }
          }
          if (fm(i)) {
            eu(t, i, ""), r += 2;
            continue;
          }
          var f = e.indexOf(";", r);
          if (f !== -1) {
            var h = i, d = r + 2, g = d < f ? e.substring(d, f) : "", v = eu(t, h, g);
            v ? r = f + 1 : (t.currentText += "\\" + h, r += 2);
          } else
            t.inCommand = !0, t.commandBuffer = i, r += 2;
        }
      } else
        t.currentText += n, r++;
    else n === "{" ? (t.inBlock = !0, Sa(t), t.formatStack || (t.formatStack = []), t.formatStack.push(Zi({}, t.formats)), r++) : n === "}" ? (t.inBlock = !1, Sa(t), t.formatStack && t.formatStack.length > 0 ? t.formats = t.formatStack.pop() || {} : t.formats = {}, r++) : (t.currentText += n, r++);
  }
  return Sa(t), t.currentBlock.children.length > 0 && t.blocks.push(t.currentBlock), t.blocks.length === 0 && t.blocks.push({
    type: "paragraph",
    children: [qc("", {})]
  }), t.blocks;
}
var m1 = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e);
  }
  return Be(e, null, [{
    key: "fromMText",
    value: function(r) {
      var n = new bt(), i = r.getBoundingBox(), a, s = r.location, o = r.width === 0 ? i.maxPt.x - i.minPt.x : r.width, u = i.maxPt.y - i.minPt.y;
      switch (r.attachment) {
        case Ie.AttachmentPoint.kTopLeft:
          a = s.clone();
          break;
        case Ie.AttachmentPoint.kTopCenter:
          a = new te(s.x - o / 2, s.y, s.z);
          break;
        case Ie.AttachmentPoint.kTopRight:
          a = new te(s.x - o, s.y, s.z);
          break;
        case Ie.AttachmentPoint.kMiddleLeft:
          a = new te(s.x, s.y + u / 2, s.z);
          break;
        case Ie.AttachmentPoint.kMiddleCenter:
          a = new te(s.x - o / 2, s.y + u / 2, s.z);
          break;
        case Ie.AttachmentPoint.kMiddleRight:
          a = new te(s.x - o, s.y + u / 2, s.z);
          break;
        case Ie.AttachmentPoint.kBottomLeft:
          a = new te(s.x, s.y + u, s.z);
          break;
        case Ie.AttachmentPoint.kBottomCenter:
          a = new te(s.x - o / 2, s.y + u, s.z);
          break;
        case Ie.AttachmentPoint.kBottomRight:
          a = new te(s.x - o, s.y + u, s.z);
          break;
        default:
          a = s.clone();
      }
      if (n.position = a, n.maxWidth = o, r.trueColor.method === hn.kByColor)
        n.trueColor = r.trueColor;
      else {
        var l = new fr();
        l.setColorIndex(r.colorIndex), n.trueColor = l, n.colorIndex = r.colorIndex;
      }
      n.maxHeight = u, n.layer = r.layer, n.layerId = r.layerId, n.drawOrder = r.drawOrder, n.linetype = r.linetype, n.normal = r.normal, n.lineweight = r.lineweight, n.linetypeScale = r.linetypeScale, n.textBaseHeight = r.textHeight, n.textAlignment = r.attachment, n.angle = THREE.MathUtils.radToDeg(r.rotation), n.textStyle = r.textStyle, n.textStyleId = r.textStyleId;
      var c = r.contents, f = lx(c);
      return n.data = f, n;
    }
  }, {
    key: "toMText",
    value: function(r, n) {
      var i = r.getMTextImp(), a = [];
      if (i.isCustomTextOrElement)
        return i.__PARAGRAPH_INFOS__.forEach(function(h) {
          h.entitys.forEach(function(d) {
            d && a.push(d.clone());
          });
        }), a;
      var s = Math.max(i.maxWidth, i.actualWidth), o = Math.max(i.maxHeight, i.actualHeight), u, l = i.getActualRenderStartPosition();
      switch (r.textAlignment) {
        case Ie.AttachmentPoint.kTopLeft:
          u = l.clone();
          break;
        case Ie.AttachmentPoint.kTopCenter:
          u = new te(l.x + s / 2, l.y, l.z);
          break;
        case Ie.AttachmentPoint.kTopRight:
          u = new te(l.x + s, l.y, l.z);
          break;
        case Ie.AttachmentPoint.kMiddleLeft:
          u = new te(l.x, l.y - o / 2, l.z);
          break;
        case Ie.AttachmentPoint.kMiddleCenter:
          u = new te(l.x + s / 2, l.y - o / 2, l.z);
          break;
        case Ie.AttachmentPoint.kMiddleRight:
          u = new te(l.x + s, l.y - o / 2, l.z);
          break;
        case Ie.AttachmentPoint.kBottomLeft:
          u = new te(l.x, l.y - o, l.z);
          break;
        case Ie.AttachmentPoint.kBottomCenter:
          u = new te(l.x + s / 2, l.y - o, l.z);
          break;
        case Ie.AttachmentPoint.kBottomRight:
          u = new te(l.x + s, l.y - o, l.z);
          break;
        default:
          u = l.clone();
      }
      var c = function(d, g) {
        if (!n)
          if (n = new Ia(), n.layer = r.layer, n.layerId = r.layerId, n.drawOrder = r.drawOrder, n.linetype = r.linetype, n.linetypeScale = r.linetypeScale, n.lineweight = r.lineweight, r.trueColor.method === hn.kByColor)
            n.trueColor = r.trueColor;
          else {
            var v = new fr();
            v.setColorIndex(r.colorIndex), n.trueColor = v, n.colorIndex = r.colorIndex;
          }
        if (n.textHeight = r.textBaseHeight, n.textStyle = r.textStyle, n.location = g, n.attachment = r.textAlignment, n.contents = d, !r.isWordWrap && n.width < s) {
          n.width = s * 2, n.reCompute();
          var m = n.getBoundingBox(), p = m.minPt, y = m.maxPt;
          s = p.distanceTo(new te(y.x, p.y)) * 1.01;
        }
        return n.width = s, n.rotation = THREE.MathUtils.degToRad(r.angle), n;
      }, f = G2(i.data);
      return a.push(c(f, u)), a;
    }
  }]), e;
}(), g1 = function(t) {
  for (var r = t.getMTextImp(), n = r.data.length, i = 0, a = 0; a < n; a++) {
    var s = r.getParagraphLines(a);
    if (s)
      for (var o = 0; o < s.length; o++) {
        var u = r.getLinePosition(a, o);
        if (u) {
          var l = u.maxPt.x - u.minPt.x;
          i = Math.max(i, l);
        }
      }
  }
  var c = Math.max(r.maxWidth, i);
  return {
    maxWidth: i,
    alignmentWidth: c
  };
}, yu = function(t, r, n, i, a) {
  var s = t.getMTextImp(), o = s.textAlignment;
  if (a !== void 0) {
    var u = s.data[a];
    if (u && u.type === "paragraph") {
      var l = u;
      if (l.alignment && l.alignment !== "justify") {
        if (l.alignment === "distribute")
          return r.x;
        switch (l.alignment) {
          case "center":
            o = Ie.AttachmentPoint.kTopCenter;
            break;
          case "right":
            o = Ie.AttachmentPoint.kTopRight;
            break;
          case "left":
          default:
            o = Ie.AttachmentPoint.kTopLeft;
            break;
        }
      }
    }
  }
  var c = r.x;
  switch (o) {
    case Ie.AttachmentPoint.kTopCenter:
    case Ie.AttachmentPoint.kMiddleCenter:
    case Ie.AttachmentPoint.kBottomCenter:
      c = r.x + (n - i) / 2;
      break;
    case Ie.AttachmentPoint.kTopRight:
    case Ie.AttachmentPoint.kMiddleRight:
    case Ie.AttachmentPoint.kBottomRight:
      c = r.x + n - i;
      break;
  }
  return c;
};
function cx(e) {
  for (var t = this, r = e.x, n = e.y, i = this.getMTextImp(), a = i.getTotalContentHeight(), s = g1(this), o = s.alignmentWidth, u = i.getActualRenderStartPosition(a, o), l = 0; l < i.__PARAGRAPH_INFOS__.length; l++) {
    var c, f, h = i.getParagrapInfo(l);
    if (h) {
      var d = p1(this, u, l), g = (c = h.lines) === null || c === void 0 ? void 0 : c.some(function(w) {
        var x;
        return (x = w.nodes) === null || x === void 0 ? void 0 : x.some(function(b) {
          return Kt(b.node) ? !0 : b.endOffset > b.startOffset;
        });
      });
      if (!((f = h.lines) !== null && f !== void 0 && f.length) || !g) {
        var v = yu(this, d, o, 0, l);
        if (n <= d.y && n >= d.y - h.height && r >= v)
          return {
            path: [l, 0],
            offset: 0
          };
        continue;
      }
      for (var m = function() {
        var x, b = h.lines[y];
        if (!((x = b.nodes) !== null && x !== void 0 && x.length)) return 0;
        var M = $c(h, y, t.lineHeightRatio), k = M.accumulatedHeight, E = d.y - k, S = E - b.height - b.height * ((h.lineHeightRatio || t.lineHeightRatio) - 1);
        if (n <= E && n >= S) {
          for (var F = yu(t, d, o, b.width, l), O = b.nodes.some(function(z) {
            return z.hasCharLevelSpacing;
          }), D = b.nodes.reduce(function(z, K) {
            return Kt(K.node) && bt.elementTextManager.has(K.node.type) || Lr(K.node) && K.node.type && bt.elementTextManager.hasText(K.node.type) ? z + 1 : z + (K.endOffset - K.startOffset);
          }, 0), _ = [], L = F, G = 0; G < b.nodes.length; G++) {
            var V = b.nodes[G], H = 0;
            if (Kt(V.node) && bt.elementTextManager.has(V.node.type)) {
              var U = li(t, V.node), R = U.width;
              H = R;
            } else if (Lr(V.node) && V.node.type && bt.elementTextManager.hasText(V.node.type)) {
              var B = Ca(t, V.node), C = B.width;
              H = C;
            } else
              H = V.width;
            _.push({
              startX: L,
              endX: L + H,
              nodeInfo: V
            }), L += H;
          }
          if (O && D > 1) {
            for (var Z = [], W = 0; W < b.nodes.length; W++) {
              var J = b.nodes[W];
              if (!J.extraCharSpacing) {
                Z.push(0);
                continue;
              }
              var Q = 0;
              Lr(J.node) && J.node.type && bt.elementTextManager.hasText(J.node.type) || Kt(J.node) && bt.elementTextManager.has(J.node.type) ? Q = 1 : Q = J.endOffset - J.startOffset;
              var j = W === b.nodes.length - 1, q = Q;
              j && (q = Math.max(0, Q - 1));
              var ae = J.extraCharSpacing * q;
              Z.push(ae);
            }
            for (var pe = 0; pe < _.length; pe++) {
              for (var $ = 0, se = 0; se < pe; se++)
                $ += Z[se];
              _[pe].startX += $, _[pe].endX += $ + Z[pe];
            }
          } else if (O && D === 1) {
            var ve = b.nodes[0], me = 0;
            if (Kt(ve.node) && bt.elementTextManager.has(ve.node.type)) {
              var Ae = li(t, ve.node), Ce = Ae.width;
              me = Ce;
            } else if (Lr(ve.node) && ve.node.type && bt.elementTextManager.hasText(ve.node.type)) {
              var Ee = Ca(t, ve.node), Y = Ee.width;
              me = Y;
            } else
              me = ve.width;
            if (ve.hasCharLevelSpacing || ve.extraCharSpacing) {
              var ee = (o - me) / 2;
              ee > 0 && (_[0].startX += ee, _[0].endX += ee);
            }
          }
          if (r <= F) {
            if (D === 1 && b.nodes.length > 0) {
              var Me = b.nodes[0], ye = _.find(function(z) {
                return z.nodeInfo === Me;
              });
              if (ye) {
                var De = (ye.startX + ye.endX) / 2;
                return r >= De ? {
                  v: {
                    path: Me.path,
                    offset: Me.endOffset
                  }
                } : {
                  v: {
                    path: Me.path,
                    offset: Me.startOffset
                  }
                };
              } else {
                var Se = Me.width, fe = F + Se / 2;
                return r >= fe ? {
                  v: {
                    path: Me.path,
                    offset: Me.endOffset
                  }
                } : {
                  v: {
                    path: Me.path,
                    offset: Me.startOffset
                  }
                };
              }
            }
            if (b.nodes.length > 0)
              return {
                v: {
                  path: b.nodes[0].path,
                  offset: b.nodes[0].startOffset
                }
              };
          }
          for (var ke = function() {
            var K = b.nodes[Te], oe = K.startOffset, ce = _.find(function(ct) {
              return ct.nodeInfo === K;
            }), ge = ce ? ce.startX : F + (Te > 0 ? b.nodes.slice(0, Te).reduce(function(ct, pr) {
              return ct + pr.width;
            }, 0) : 0), Oe = ce ? ce.endX : ge + K.width;
            if (r >= ge && r <= Oe) {
              if (Kt(K.node)) {
                var Ge = (ge + Oe) / 2;
                if (r < Ge) {
                  if (Te > 0) {
                    var We = b.nodes[Te - 1];
                    return {
                      v: {
                        v: {
                          path: We.path,
                          offset: We.endOffset
                        }
                      }
                    };
                  } else if (y > 0) {
                    var $e = h.lines[y - 1], pt = $e.nodes[$e.nodes.length - 1];
                    return {
                      v: {
                        v: {
                          path: pt.path,
                          offset: pt.endOffset
                        }
                      }
                    };
                  }
                  return {
                    v: {
                      v: {
                        path: K.path,
                        offset: K.startOffset
                      }
                    }
                  };
                } else {
                  if (Te < b.nodes.length - 1) {
                    var tt = b.nodes[Te + 1];
                    return {
                      v: {
                        v: {
                          path: tt.path,
                          offset: tt.startOffset
                        }
                      }
                    };
                  }
                  return {
                    v: {
                      v: {
                        path: K.path,
                        offset: K.endOffset
                      }
                    }
                  };
                }
              }
              var xt = K.node.type && bt.elementTextManager.hasText(K.node.type);
              if (xt) {
                var ht = Oe - ge, Vt = ge + ht / 2;
                return r >= Vt ? {
                  v: {
                    v: {
                      path: K.path,
                      offset: K.endOffset
                    }
                  }
                } : {
                  v: {
                    v: {
                      path: K.path,
                      offset: K.startOffset
                    }
                  }
                };
              }
              if (Lr(K.node)) {
                if (K.endOffset - K.startOffset === 1) {
                  var qe = (ge + Oe) / 2;
                  return r >= qe ? {
                    v: {
                      v: {
                        path: K.path,
                        offset: K.endOffset
                      }
                    }
                  } : {
                    v: {
                      v: {
                        path: K.path,
                        offset: K.startOffset
                      }
                    }
                  };
                }
                for (var ze = Number.MAX_VALUE, He = K.startOffset, Ht = K.endOffset; He <= Ht; ) {
                  var mt = Math.floor((He + Ht) / 2);
                  if (Lr(K.node)) {
                    var vt = K.node.text.substring(K.startOffset, mt), Ct = ge + ea(vt, K.node, i.textBaseHeight, t.textStyle, t), Rt = 0;
                    if (O)
                      if (D === 1) {
                        if (K.extraCharSpacing) {
                          var St = K.node.text.substring(K.startOffset, K.endOffset), zt = ea(St, K.node, i.textBaseHeight, t.textStyle, t), nr = (o - zt) / 2;
                          if (nr > 0) {
                            var ir = vt.length / St.length;
                            Rt = nr * ir;
                          }
                        }
                      } else if (D === 2) {
                        var ar = Te === 0, gt = mt - K.startOffset, Dt = Te === b.nodes.length - 1, Jt = Dt && mt === K.endOffset;
                        if (!Jt) {
                          if (ar)
                            gt > 0 && K.extraCharSpacing && (Rt = K.extraCharSpacing * Math.min(2, gt));
                          else if (K.extraCharSpacing) {
                            var dr = b.nodes[Te - 1];
                            dr.extraCharSpacing && (Rt += dr.extraCharSpacing * 2), Rt += K.extraCharSpacing * gt;
                          }
                        }
                      } else {
                        for (var N = 0; N < Te; N++) {
                          var X = b.nodes[N];
                          if (X.extraCharSpacing) {
                            var ue = 0;
                            Lr(X.node) && X.node.type && bt.elementTextManager.hasText(X.node.type) || Kt(X.node) && bt.elementTextManager.has(X.node.type) ? ue = 1 : ue = X.endOffset - X.startOffset;
                            var we = N === b.nodes.length - 1 && X.endOffset === K.endOffset, Le = we ? Math.max(0, ue - 1) : ue;
                            Rt += X.extraCharSpacing * Le;
                          }
                        }
                        if (K.extraCharSpacing) {
                          var Ke = mt - K.startOffset, Re = Te === b.nodes.length - 1, at = mt === K.endOffset;
                          Re && at ? Ke > 0 && (Rt += K.extraCharSpacing * (Ke - 1)) : Rt += K.extraCharSpacing * Ke;
                        }
                      }
                    var Ne = Ct + Rt;
                    if (mt < K.endOffset) {
                      var Ye = K.node.text.charAt(mt);
                      if (Ye) {
                        var Tt = ea(Ye, K.node, i.textBaseHeight, t.textStyle, t), kt = 0;
                        if (O && K.extraCharSpacing) {
                          var Mt = Te === b.nodes.length - 1 && mt === K.endOffset - 1;
                          Mt || (kt = K.extraCharSpacing);
                        }
                        var je = Tt + kt, Xe = Ne, Lt = Xe + je / 2;
                        if (r >= Lt) {
                          var Ut = Math.abs(Lt - r);
                          Ut < ze && (ze = Ut, oe = mt + 1), He = mt + 1;
                          continue;
                        } else {
                          var gr = Math.abs(Lt - r);
                          gr < ze && (ze = gr, oe = mt), Ht = mt - 1;
                          continue;
                        }
                      }
                    }
                    var yt = Math.abs(Ne - r);
                    yt < ze && (ze = yt, oe = mt), Ne < r ? He = mt + 1 : Ht = mt - 1;
                  } else if (Kt(K.node))
                    break;
                }
              }
              return {
                v: {
                  v: {
                    path: K.path,
                    offset: oe
                  }
                }
              };
            }
          }, ne, Te = 0; Te < b.nodes.length; Te++)
            if (ne = ke(), ne) return ne.v;
          if (r > (_.length > 0 ? _[_.length - 1].endX : F + b.width) && b.nodes.length > 0) {
            var I, A = b.nodes[b.nodes.length - 1];
            if ((I = b.breakInfo) !== null && I !== void 0 && I.isWrapped && h.lines[y + 1]) {
              var T = h.lines[y + 1], P = T.nodes[0];
              if (P)
                return {
                  v: {
                    path: P.path,
                    offset: P.startOffset
                  }
                };
            }
            return {
              v: {
                path: A.path,
                offset: A.endOffset
              }
            };
          }
        }
      }, p, y = 0; y < h.lines.length; y++)
        if (p = m(), p !== 0 && p)
          return p.v;
    }
  }
  return null;
}
function fx(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = hx(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function hx(e, t) {
  if (e) {
    if (typeof e == "string") return hm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? hm(e, t) : void 0;
  }
}
function hm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function dx(e) {
  var t, r, n = this, i = this.getMTextImp(), a = e.path, s = e.offset, o = i.getTotalContentHeight(), u = g1(this), l = u.alignmentWidth, c = i.getActualRenderStartPosition(o, l), f = a[0], h = i.__PARAGRAPH_INFOS__[f];
  if (!h) return null;
  var d = p1(this, c, f), g = (t = h.lines) === null || t === void 0 ? void 0 : t.some(function(Se) {
    var fe;
    return (fe = Se.nodes) === null || fe === void 0 ? void 0 : fe.some(function(ke) {
      return Kt(ke.node) ? !0 : ke.endOffset > ke.startOffset;
    });
  });
  if (!((r = h.lines) !== null && r !== void 0 && r.length) || !g) {
    var v = yu(this, d, l, 0, f);
    return {
      point: new te(v, d.y),
      lineIndex: 0
    };
  }
  for (var m = 0; m < h.lines.length; m++) {
    var p, y = h.lines[m], w = y.nodes.some(function(Se) {
      return Se.hasCharLevelSpacing;
    });
    if ((p = y.nodes) !== null && p !== void 0 && p.length) {
      for (var x = yu(this, d, l, y.width, f), b = $c(h, m, this.lineHeightRatio), M = b.accumulatedHeight, k = x, E = !1, S = y.nodes.reduce(function(Se, fe) {
        return Kt(fe.node) && bt.elementTextManager.has(fe.node.type) || Lr(fe.node) && fe.node.type && bt.elementTextManager.hasText(fe.node.type) ? Se + 1 : Se + (fe.endOffset - fe.startOffset);
      }, 0), F = [], O = x, D = w, _ = 0; _ < y.nodes.length; _++) {
        var L = y.nodes[_], G = 0;
        if (Kt(L.node) && bt.elementTextManager.has(L.node.type)) {
          var V = li(this, L.node), H = V.width;
          G = H;
        } else if (Lr(L.node) && L.node.type && bt.elementTextManager.hasText(L.node.type)) {
          var U = Ca(this, L.node), R = U.width;
          G = R;
        } else
          G = L.width;
        F.push({
          startX: O,
          endX: O + G,
          nodeInfo: L
        }), O += G;
      }
      if (D && S > 1) {
        for (var B = [], C = 0; C < y.nodes.length; C++) {
          var Z = y.nodes[C];
          if (!Z.extraCharSpacing) {
            B.push(0);
            continue;
          }
          var W = 0;
          Lr(Z.node) && Z.node.type && bt.elementTextManager.hasText(Z.node.type) || Kt(Z.node) && bt.elementTextManager.has(Z.node.type) ? W = 1 : W = Z.endOffset - Z.startOffset;
          var J = C === y.nodes.length - 1, Q = W;
          J && (Q = Math.max(0, W - 1));
          var j = Z.extraCharSpacing * Q;
          B.push(j);
        }
        for (var q = 0; q < F.length; q++) {
          for (var ae = 0, pe = 0; pe < q; pe++)
            ae += B[pe];
          F[q].startX += ae, F[q].endX += ae + B[q];
        }
      } else if (D && S === 1) {
        var $ = y.nodes[0], se = 0;
        if (Kt($.node) && bt.elementTextManager.has($.node.type)) {
          var ve = li(this, $.node), me = ve.width;
          se = me;
        } else if (Lr($.node) && $.node.type && bt.elementTextManager.hasText($.node.type)) {
          var Ae = Ca(this, $.node), Ce = Ae.width;
          se = Ce;
        } else
          se = $.width;
        if ($.hasCharLevelSpacing || $.extraCharSpacing) {
          var Ee = (l - se) / 2;
          Ee > 0 && (F[0].startX += Ee, F[0].endX += Ee);
        }
      }
      var Y = fx(y.nodes), ee;
      try {
        var Me = function() {
          var fe = ee.value, ke = fe.path[0] === a[0] && fe.path[1] === a[1];
          if (ke && s >= fe.startOffset && s <= fe.endOffset) {
            var ne;
            if (E = !0, s === fe.endOffset && fe === y.nodes[y.nodes.length - 1] && (ne = y.breakInfo) !== null && ne !== void 0 && ne.isWrapped) {
              var Te = h.lines[m + 1];
              if (Te) {
                var I = $c(h, m + 1, n.lineHeightRatio), A = I.accumulatedHeight, T = d.y - A, P = yu(n, d, l, Te.width, f);
                return {
                  v: {
                    point: new te(P, T),
                    lineIndex: m + 1
                  }
                };
              }
            }
            var z = fe.node.type && bt.elementTextManager.hasText(fe.node.type), K = F.find(function(dr) {
              return dr.nodeInfo === fe;
            });
            if (Kt(fe.node)) {
              var oe;
              if (K)
                oe = s === 0 ? K.startX : K.endX;
              else {
                var ce = li(n, fe.node), ge = ce.width;
                if (oe = k, s === 1 && (oe += ge), w && S === 1) {
                  if (s === 1 && fe.extraCharSpacing) {
                    var Oe = (l - ge) / 2;
                    Oe > 0 && (oe = x + Oe + ge);
                  } else if (s === 0 && fe.extraCharSpacing) {
                    var Ge = (l - ge) / 2;
                    Ge > 0 && (oe = x + Ge);
                  }
                }
              }
              var We = d.y - M;
              return {
                v: {
                  point: new te(oe, We),
                  lineIndex: m
                }
              };
            } else if (z) {
              var $e;
              if (K)
                $e = s === 0 ? K.startX : K.endX;
              else {
                var pt = Ca(n, fe.node), tt = pt.width;
                if ($e = k, s === 1 && ($e += tt), w && S === 1) {
                  if (s === 1 && fe.extraCharSpacing) {
                    var xt = (l - tt) / 2;
                    xt > 0 && ($e = x + xt + tt);
                  } else if (s === 0 && fe.extraCharSpacing) {
                    var ht = (l - tt) / 2;
                    ht > 0 && ($e = x + ht);
                  }
                }
              }
              var Vt = d.y - M;
              return {
                v: {
                  point: new te($e, Vt),
                  lineIndex: m
                }
              };
            } else {
              var qe = fe.node.text.substring(fe.startOffset, s), ze = k + ea(qe, fe.node, i.textBaseHeight, n.textStyle, n);
              if (w)
                if (S === 1) {
                  var He = fe.node.text.substring(fe.startOffset, fe.endOffset), Ht = ea(He, fe.node, i.textBaseHeight, n.textStyle, n), mt = (l - Ht) / 2;
                  if (mt > 0) {
                    var vt = qe.length / He.length;
                    ze = x + mt + vt * Ht;
                  }
                } else {
                  for (var Ct = 0, Rt = 0; Rt < y.nodes.length; Rt++) {
                    var St = y.nodes[Rt];
                    if (St === fe) {
                      if (St.extraCharSpacing) {
                        var zt = s - St.startOffset, nr = Rt === y.nodes.length - 1, ir = s === St.endOffset;
                        nr && ir ? zt > 0 && (Ct += St.extraCharSpacing * (zt - 1)) : Ct += St.extraCharSpacing * zt;
                      }
                      break;
                    }
                    if (St.extraCharSpacing) {
                      var ar = 0;
                      Lr(St.node) && St.node.type && bt.elementTextManager.hasText(St.node.type) || Kt(St.node) && bt.elementTextManager.has(St.node.type) ? ar = 1 : ar = St.endOffset - St.startOffset;
                      var gt = Rt === y.nodes.length - 1, Dt = ar;
                      gt && (Dt = Math.max(0, ar - 1)), Ct += St.extraCharSpacing * Dt;
                    }
                  }
                  ze += Ct;
                }
              var Jt = d.y - M;
              return {
                v: {
                  point: new te(ze, Jt),
                  lineIndex: m
                }
              };
            }
          }
          k += fe.width;
        }, ye;
        for (Y.s(); !(ee = Y.n()).done; )
          if (ye = Me(), ye) return ye.v;
      } catch (Se) {
        Y.e(Se);
      } finally {
        Y.f();
      }
      if (E) {
        var De = d.y - M;
        return {
          point: new te(k, De),
          lineIndex: m
        };
      }
    }
  }
  return {
    point: new te(d.x, d.y),
    lineIndex: 0
  };
}
function px(e) {
  var t = this.getMTextImp();
  this.assertWrite(), t.mat = e;
  var r = this.position.clone(), n = new te(r.x + this.maxWidth, r.y, r.z), i = new Ve(this.maxWidth, 0, 0).normalize(), a = r.clone().transformBy(e), s = n.clone().transformBy(e), o = new Ve(s.x - a.x, s.y - a.y, s.z - a.z).normalize(), u = i.crossProduct(o), l = i.dotProduct(o), c = Math.acos(Math.min(Math.max(l, -1), 1)) * 180 / Math.PI;
  return c = u.z < 0 ? 360 - c : c, t.angle = c, !0;
}
var y1 = /* @__PURE__ */ Be(function e() {
  Pe(this, e);
});
function dm(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function pm(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? dm(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : dm(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
function vx(e) {
  var t = b1();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function b1() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (b1 = function() {
    return !!e;
  })();
}
var bt = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = vx(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), le(dt(i), "impMText", void 0), le(dt(i), "convertCadPointToSlatePoint", cx), le(dt(i), "convertSlatePointToCadPoint", dx), le(dt(i), "transformBy", px), i.impMText || (i.impMText = new sx()), i;
  }
  return Be(r, [{
    key: "getMTextImp",
    value: function() {
      return this.impMText;
    }
  }, {
    key: "data",
    get: function() {
      return this.impMText.data;
    },
    set: function(i) {
      this.assertWrite(), this.impMText.data = i;
    }
  }, {
    key: "textBaseHeight",
    get: function() {
      return this.impMText.textBaseHeight;
    },
    set: function(i) {
      this.assertWrite(), this.impMText.textBaseHeight = i;
    }
  }, {
    key: "angle",
    get: function() {
      return this.impMText.angle;
    },
    set: function(i) {
      this.assertWrite(), this.impMText.angle = i;
      var a = new Jr();
      a.setToRotation(THREE.MathUtils.degToRad(i), Ve.kZAxis, this.position), this.impMText.mat = a;
    }
  }, {
    key: "position",
    get: function() {
      return this.impMText.position;
    },
    set: function(i) {
      this.assertWrite(), this.impMText.position = i;
    }
  }, {
    key: "maxWidth",
    get: function() {
      return this.impMText.maxWidth;
    },
    set: function(i) {
      this.assertWrite(), i <= 0 && (i = this.textBaseHeight), this.impMText.maxWidth = i;
    }
  }, {
    key: "maxHeight",
    get: function() {
      return this.impMText.maxHeight;
    },
    set: function(i) {
      this.assertWrite(), i <= 0 && (i = this.textBaseHeight), this.impMText.maxHeight = i;
    }
  }, {
    key: "isWordWrap",
    get: function() {
      return this.impMText.isWordWrap;
    },
    set: function(i) {
      this.impMText.isWordWrap !== i && (this.impMText.isWordWrap = i, this.updateDisplay());
    }
  }, {
    key: "lineHeightRatio",
    get: function() {
      return this.impMText.lineHeightRatio;
    },
    set: function(i) {
      this.assertWrite();
      var a = Math.max(0.5, Math.min(3, i));
      this.impMText.lineHeightRatio !== a && (this.impMText.lineHeightRatio = a, this.updateDisplay());
    }
  }, {
    key: "textAlignment",
    get: function() {
      return this.impMText.textAlignment;
    },
    set: function(i) {
      this.assertWrite(), this.impMText.textAlignment = i, this.updateDisplay();
    }
  }, {
    key: "create",
    value: function(i) {
      return new r(i);
    }
  }, {
    key: "getTypeName",
    value: function() {
      return "MxCADMText";
    }
  }, {
    key: "getName",
    value: function() {
      return "MxCAD";
    }
  }, {
    key: "dwgInFields",
    value: function(i) {
      return this.impMText.dwgInFields(i), !0;
    }
  }, {
    key: "dwgOutFields",
    value: function(i) {
      return this.impMText.dwgOutFields(i), !0;
    }
  }, {
    key: "moveGripPointsAt",
    value: function(i, a, s, o) {
      return this.assertWrite(), this.impMText.moveGripPointsAt(i, a, s, o);
    }
  }, {
    key: "getGripPoints",
    value: function() {
      return this.impMText.getGripPoints();
    }
  }, {
    key: "worldDraw",
    value: function(i) {
      var a = this;
      g2(), P2();
      var s = this.getMTextImp();
      s.__PARAGRAPH_INFOS__ = [];
      var o = 0, u = 0;
      s.actualWidth = s.maxWidth, s.actualHeight = s.maxHeight;
      var l = s.data.map(function(d, g) {
        if (Kt(d)) {
          var v = r.elementTextManager.get(d.type);
          if (v) {
            var m = v == null ? void 0 : v.calculate(a, d, g);
            return m && (o += m.height, u = Math.max(u, m.width)), m;
          }
        }
      }), c = Math.max(s.maxWidth, u), f = s.getActualRenderStartPosition(o, c), h = 0;
      s.data.forEach(function(d, g) {
        if (Kt(d)) {
          var v = r.elementTextManager.get(d.type);
          if (v) {
            var m = l[g];
            if (m) {
              var p = f.clone().subvec(Ve.kYAxis.clone().mult(h)), y = v.render(a, i, d, m, {
                position: p,
                index: g,
                alignmentWidth: c
              });
              y && (h += m.height, s.__PARAGRAPH_INFOS__[g] = pm(pm({}, m), y));
            }
          }
        }
      }), s.actualWidth = Math.max(s.maxWidth, u), s.actualHeight = Math.max(s.maxHeight, o), s.emit("changed");
    }
  }]), r;
}(dl);
le(bt, "fromMText", m1.fromMText);
le(bt, "toMText", m1.toMText);
le(bt, "elementTextManager", new ex());
function vm(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = mx(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function mx(e, t) {
  if (e) {
    if (typeof e == "string") return mm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? mm(e, t) : void 0;
  }
}
function mm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
var io = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e);
  }
  return Be(e, null, [{
    key: "isSlateData",
    value: function(r) {
      return Array.isArray(r) ? r.some(function(n) {
        return Er(n) === "object" && n !== null && n.type === "paragraph" && Array.isArray(n.children);
      }) : !1;
    }
  }, {
    key: "extractTextFromSlate",
    value: function(r) {
      if (!this.isSlateData(r))
        return r == null ? "" : String(r);
      var n = "", i = vm(r), a;
      try {
        for (i.s(); !(a = i.n()).done; ) {
          var s = a.value;
          if (s.type === "paragraph") {
            if (Array.isArray(s.children)) {
              var o = vm(s.children), u;
              try {
                for (o.s(); !(u = o.n()).done; ) {
                  var l = u.value;
                  typeof l.text == "string" && (n += l.text);
                }
              } catch (c) {
                o.e(c);
              } finally {
                o.f();
              }
            }
            n.length > 0 && (n += `
`);
          }
        }
      } catch (c) {
        i.e(c);
      } finally {
        i.f();
      }
      return n.endsWith(`
`) && (n = n.slice(0, -1)), n;
    }
  }, {
    key: "convertToSlateData",
    value: function(r) {
      if (!r)
        return [{
          type: "paragraph",
          children: [{
            text: ""
          }]
        }];
      var n = r.split(`
`);
      return n.map(function(i) {
        return {
          type: "paragraph",
          children: [{
            text: i
          }]
        };
      });
    }
  }, {
    key: "convertTableDataToPlainText",
    value: function(r) {
      var n = this;
      return !r || !Array.isArray(r) ? [] : r.map(function(i) {
        return Array.isArray(i) ? i.map(function(a) {
          return n.isSlateData(a) ? n.extractTextFromSlate(a) : a;
        }) : [];
      });
    }
  }, {
    key: "ensureSlateFormat",
    value: function(r) {
      var n = this;
      return !r || !Array.isArray(r) ? [] : r.map(function(i) {
        return Array.isArray(i) ? i.map(function(a) {
          return n.isSlateData(a) ? a : a == null ? n.convertToSlateData("") : n.convertToSlateData(String(a));
        }) : [];
      });
    }
  }]), e;
}();
function gx(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = yx(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function yx(e, t) {
  if (e) {
    if (typeof e == "string") return gm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? gm(e, t) : void 0;
  }
}
function gm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
var kh = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e);
  }
  return Be(e, null, [{
    key: "drawTable",
    value: function(r, n, i, a, s, o, u, l, c, f, h, d) {
      return this.drawTableData(r, n, i, a, s, o, u, l, c, f, h, d);
    }
  }, {
    key: "drawTableGrid",
    value: function(r, n, i, a, s, o, u, l, c, f, h, d) {
      var g = this.calculateActualDimensions(i, a, s, u, l, f, h, !0), v = g.rowPositions, m = g.colPositions, p = /* @__PURE__ */ new Map();
      c && c.forEach(function(U) {
        for (var R = U.row; R < U.row + U.rowspan; R++)
          for (var B = U.col; B < U.col + U.colspan; B++)
            B > U.col && B < U.col + U.colspan && p.set("v_".concat(B, "_").concat(R, "_").concat(R + 1), !0), R > U.row && R < U.row + U.rowspan && p.set("h_".concat(R, "_").concat(B, "_").concat(B + 1), !0);
      });
      var y = v.map(function(U) {
        return n.y - U;
      }), w = m.map(function(U) {
        return n.x + U;
      }), x = y[a], b = w[s], M = o.borderLineWeight !== void 0 ? o.borderLineWeight : 0.25, k = o.borderLineType || "Continuous";
      this.drawLine(r, new te(n.x, n.y, n.z), new te(b, n.y, n.z), o.borderColor, d, M, k), this.drawLine(r, new te(b, n.y, n.z), new te(b, x, n.z), o.borderColor, d, M, k), this.drawLine(r, new te(b, x, n.z), new te(n.x, x, n.z), o.borderColor, d, M, k), this.drawLine(r, new te(n.x, x, n.z), new te(n.x, n.y, n.z), o.borderColor, d, M, k);
      for (var E = 1; E < s; E++)
        for (var S = w[E], F = 0; F < a; F++)
          if (!p.get("v_".concat(E, "_").concat(F, "_").concat(F + 1))) {
            var O = y[F], D = y[F + 1];
            this.drawLine(r, new te(S, O, n.z), new te(S, D, n.z), o.borderColor, d, M, k);
          }
      for (var _ = 1; _ < a; _++)
        for (var L = y[_], G = 0; G < s; G++)
          if (!p.get("h_".concat(_, "_").concat(G, "_").concat(G + 1))) {
            var V = w[G], H = w[G + 1];
            this.drawLine(r, new te(V, L, n.z), new te(H, L, n.z), o.borderColor, d, M, k);
          }
    }
  }, {
    key: "createColor",
    value: function(r) {
      var n = new fr();
      if (typeof r != "number" || isNaN(r))
        return console.error(": ".concat(r, ", : ").concat(Er(r), ", ")), n.setRGB(0, 0, 0), n;
      try {
        if (r >= Ti.kByblock && r <= Ti.kBylayer)
          n.setColorIndex(r);
        else {
          var i = r.toString(16).padStart(6, "0"), a = parseInt(i.substr(0, 2), 16), s = parseInt(i.substr(2, 2), 16), o = parseInt(i.substr(4, 2), 16);
          isNaN(a) || isNaN(s) || isNaN(o) || n.setRGB(a, s, o);
        }
      } catch (u) {
      }
      return n;
    }
  }, {
    key: "drawLine",
    value: function(r, n, i, a, s, o, u) {
      var l = new st();
      if (l.startPoint = n, l.endPoint = i, l.trueColor = this.createColor(a), r.trueColor = l.trueColor, o !== void 0 && o > 0 && (l.lineweight = o), u && u !== "Continuous")
        try {
          l.linetype = u;
        } catch (c) {
          console.error(":", c, u);
        }
      s && l.transformBy(s), r.drawEntity(l);
    }
  }, {
    key: "drawTableData",
    value: function(r, n, i, a, s, o, u, l, c, f, h, d) {
      var g = this, v = a.rowCount, m = a.cols, p = /* @__PURE__ */ new Map(), y = this.calculateActualDimensions(i, v, m, o, u, c, f, !0), w = y.rowPositions, x = y.colPositions, b = w.map(function(E) {
        return n.y - E;
      }), M = x.map(function(E) {
        return n.x + E;
      }), k = /* @__PURE__ */ new Map();
      return l && l.forEach(function(E) {
        k.set("".concat(E.row, ",").concat(E.col), E);
      }), a.data.forEach(function(E, S) {
        E.forEach(function(F, O) {
          var D = !1;
          if (l) {
            var _ = gx(l), L;
            try {
              for (_.s(); !(L = _.n()).done; ) {
                var G = L.value;
                if (S >= G.row && S < G.row + G.rowspan && O >= G.col && O < G.col + G.colspan && !(S === G.row && O === G.col)) {
                  D = !0;
                  break;
                }
              }
            } catch (Ee) {
              _.e(Ee);
            } finally {
              _.f();
            }
          }
          if (!D) {
            var V = M[O], H = b[S], U, R, B = k.get("".concat(S, ",").concat(O));
            B ? (U = M[O + B.colspan] - V, R = Math.abs(b[S + B.rowspan] - H)) : (U = M[O + 1] - V, R = Math.abs(b[S + 1] - H));
            var C = F, Z = new Xr();
            Z.append(new te(V, H, n.z)), Z.append(new te(V + U, H, n.z)), Z.append(new te(V + U, H - R, n.z)), Z.append(new te(V, H - R, n.z));
            var W = g.getCellReference(S, O), J = h == null ? void 0 : h[W], Q = s.backgroundColor;
            (J == null ? void 0 : J.backgroundColor) !== void 0 && (J == null ? void 0 : J.backgroundColor) !== null && (Q = J.backgroundColor);
            var j;
            Q != null && (j = new Mo(), j.appendLoop(Z), d && j.transformBy(d), j.trueColor = g.createColor(Q), r.trueColor = j.trueColor, r.drawEntity(j));
            var q = new bt();
            j && (q.drawOrder = j.drawOrder + 10);
            var ae = s.textColor, pe = s.textAlignment || "center", $ = s.textVerticalAlignment || "middle", se = s.textStyle || "Standard";
            if (J && (J.textColor !== void 0 && J.textColor !== null && (ae = J.textColor), J.alignment !== void 0 && (pe = J.alignment), J.verticalAlignment !== void 0 && ($ = J.verticalAlignment), J.textStyle !== void 0 && (se = J.textStyle)), io.isSlateData(C))
              q.data = C;
            else {
              var ve = String(C == null ? "" : C);
              q.data = [{
                type: "paragraph",
                children: [{
                  text: ve
                }]
              }];
            }
            if (q.maxWidth = U, q.maxHeight = R, q.position = new te(V, H, n.z), q.textBaseHeight = s.textHeight, se && se !== "Standard")
              try {
                q.textStyle = se;
              } catch (Ee) {
                console.error(":", Ee, se);
              }
            if (ae != null)
              try {
                q.trueColor = g.createColor(ae);
              } catch (Ee) {
              }
            switch (pe) {
              case "left":
                switch ($) {
                  case "top":
                    q.textAlignment = Ie.AttachmentPoint.kTopLeft;
                    break;
                  case "middle":
                    q.textAlignment = Ie.AttachmentPoint.kMiddleLeft;
                    break;
                  case "bottom":
                    q.textAlignment = Ie.AttachmentPoint.kBottomLeft;
                    break;
                  default:
                    q.textAlignment = Ie.AttachmentPoint.kMiddleLeft;
                }
                break;
              case "center":
                switch ($) {
                  case "top":
                    q.textAlignment = Ie.AttachmentPoint.kTopCenter;
                    break;
                  case "middle":
                    q.textAlignment = Ie.AttachmentPoint.kMiddleCenter;
                    break;
                  case "bottom":
                    q.textAlignment = Ie.AttachmentPoint.kBottomCenter;
                    break;
                  default:
                    q.textAlignment = Ie.AttachmentPoint.kMiddleCenter;
                }
                break;
              case "right":
                switch ($) {
                  case "top":
                    q.textAlignment = Ie.AttachmentPoint.kTopRight;
                    break;
                  case "middle":
                    q.textAlignment = Ie.AttachmentPoint.kMiddleRight;
                    break;
                  case "bottom":
                    q.textAlignment = Ie.AttachmentPoint.kBottomRight;
                    break;
                  default:
                    q.textAlignment = Ie.AttachmentPoint.kMiddleRight;
                }
                break;
              default:
                q.textAlignment = Ie.AttachmentPoint.kMiddleCenter;
            }
            r.trueColor = q.trueColor, d && (q.getMTextImp().mat = d), q.worldDraw(r);
            try {
              var me = q.getMTextImp().actualWidth, Ae = q.getMTextImp().actualHeight, Ce = "".concat(S, ",").concat(O);
              p.set(Ce, {
                width: me,
                height: Ae
              });
            } catch (Ee) {
              console.error(":", Ee);
            }
          }
        });
      }), this.drawTableGrid(r, n, i, v, m, s, o, u, l, c, f, d), p;
    }
  }, {
    key: "getCellReference",
    value: function(r, n) {
      for (var i = "", a = n + 1, s = a; s > 0; ) {
        var o = (s - 1) % 26;
        i = String.fromCharCode(65 + o) + i, s = Math.floor((s - o - 1) / 26);
      }
      return "".concat(i).concat(r + 1);
    }
  }, {
    key: "calculateActualDimensions",
    value: function(r, n, i, a, s, o, u) {
      for (var l = arguments.length > 7 && arguments[7] !== void 0 ? arguments[7] : !0, c = [], f = [], h = [], d = 0, g = function(G) {
        var V = o == null ? void 0 : o.find(function(U) {
          return U.row === G;
        }), H = V ? V.height : a;
        h.push(H), d += H;
      }, v = 0; v < n; v++)
        g(v);
      for (var m = [], p = 0, y = function(G) {
        var V = u == null ? void 0 : u.find(function(U) {
          return U.col === G;
        }), H = V ? V.width : s;
        m.push(H), p += H;
      }, w = 0; w < i; w++)
        y(w);
      var x = l ? r.width : p, b = l ? r.height : d, M = l ? x / p : 1, k = l ? b / d : 1, E = 0;
      c.push(E);
      for (var S = 0; S < n; S++) {
        var F = h[S] * k;
        E += F, c.push(E);
      }
      var O = 0;
      f.push(O);
      for (var D = 0; D < i; D++) {
        var _ = m[D] * M;
        O += _, f.push(O);
      }
      return {
        width: x,
        height: b,
        rowPositions: c,
        colPositions: f
      };
    }
  }]), e;
}();
function _l(e) {
  try {
    var t = JSON.stringify(e), r = encodeURIComponent(t).replace(/%([0-9A-F]{2})/g, function(n, i) {
      return String.fromCharCode(parseInt(i, 16));
    });
    return btoa(r);
  } catch (n) {
    return console.error("Base64:", n), "";
  }
}
function Ch(e) {
  try {
    if (!e) return null;
    var t = atob(e), r = Array.from(t).map(function(i) {
      return "%" + i.charCodeAt(0).toString(16).padStart(2, "0").toUpperCase();
    }).join(""), n = decodeURIComponent(r);
    return JSON.parse(n);
  } catch (i) {
    return console.error("Base64:", i), null;
  }
}
function ym(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function va(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? ym(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : ym(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
var ma = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e);
  }
  return Be(e, null, [{
    key: "setTextStyle",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0;
      return va(va({}, r), {}, {
        textStyle: n
      });
    }
  }, {
    key: "setTextAngle",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0;
      return va(va({}, r), {}, {
        textAngle: n
      });
    }
  }, {
    key: "setBorderLineWeight",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0;
      return va(va({}, r), {}, {
        borderLineWeight: n
      });
    }
  }, {
    key: "setBorderLineType",
    value: function() {
      var r = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0;
      return va(va({}, r), {}, {
        borderLineType: n
      });
    }
  }, {
    key: "getTextStyle",
    value: function(r) {
      return r == null ? void 0 : r.textStyle;
    }
  }, {
    key: "getTextAngle",
    value: function(r) {
      return r == null ? void 0 : r.textAngle;
    }
  }, {
    key: "getBorderLineWeight",
    value: function(r) {
      return r == null ? void 0 : r.borderLineWeight;
    }
  }, {
    key: "getBorderLineType",
    value: function(r) {
      return r == null ? void 0 : r.borderLineType;
    }
  }]), e;
}();
function bm(e, t) {
  var r = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(e);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(e, i).enumerable;
    })), r.push.apply(r, n);
  }
  return r;
}
function br(e) {
  for (var t = 1; t < arguments.length; t++) {
    var r = arguments[t] != null ? arguments[t] : {};
    t % 2 ? bm(Object(r), !0).forEach(function(n) {
      le(e, n, r[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : bm(Object(r)).forEach(function(n) {
      Object.defineProperty(e, n, Object.getOwnPropertyDescriptor(r, n));
    });
  }
  return e;
}
function Qt(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = bx(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function bx(e, t) {
  if (e) {
    if (typeof e == "string") return wm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? wm(e, t) : void 0;
  }
}
function wm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function wx(e) {
  var t = w1();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function w1() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (w1 = function() {
    return !!e;
  })();
}
var xx = "MxTableStyleDictionary", Mx = "STANDARD";
function Ex(e, t) {
  var r = e.getNamedObjectsDictionary(), n = r.getAt(xx);
  if (!n.isNull()) {
    var i = n.getMcDbDictionary();
    if (i) {
      var a = i.getAt(t);
      if (a.isNull())
        return;
      var s = a.getMcDbXrecord();
      if (s) {
        var o = s.getData();
        try {
          return JSON.parse(o.AtString(0).val);
        } catch (u) {
          console.warn("", u);
          return;
        }
      }
    }
  }
}
var Hv = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = wx(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), le(dt(i), "_rowHeight", 20), le(dt(i), "_colWidth", 50), le(dt(i), "_position", new te(0, 0, 0)), le(dt(i), "_styleName", ""), le(dt(i), "_colWidths", []), le(dt(i), "_rowHeights", []), le(dt(i), "_xlsxData", ""), le(dt(i), "_mergeCells", []), le(dt(i), "_selectedCells", []), le(dt(i), "_cellTextDimensions", /* @__PURE__ */ new Map()), le(dt(i), "_cellStyles", {}), le(dt(i), "_mat", new Jr()), i;
  }
  return Be(r, [{
    key: "rowHeight",
    get: function() {
      return this._rowHeight;
    },
    set: function(i) {
      this.assertWrite(), this._rowHeight = i;
    }
  }, {
    key: "colWidth",
    get: function() {
      return this._colWidth;
    },
    set: function(i) {
      this.assertWrite(), this._colWidth = i;
    }
  }, {
    key: "position",
    get: function() {
      return this._position;
    },
    set: function(i) {
      this.assertWrite(), this._position = i;
    }
  }, {
    key: "styleName",
    get: function() {
      return this._styleName;
    },
    set: function(i) {
      this.assertWrite(), this._styleName = i;
    }
  }, {
    key: "xlsxData",
    get: function() {
      return this._xlsxData;
    },
    set: function(i) {
      this._xlsxData = i;
    }
  }, {
    key: "create",
    value: function(i) {
      return new r(i);
    }
  }, {
    key: "getTypeName",
    value: function() {
      return "McDbXlsxTable";
    }
  }, {
    key: "getCellStyles",
    value: function() {
      return this._cellStyles;
    }
  }, {
    key: "getTableData",
    value: function() {
      try {
        var i;
        if (!this._xlsxData)
          return {
            data: [],
            cols: 0,
            rowCount: 0,
            mergeCells: [],
            styles: {},
            rowHeights: [],
            colWidths: []
          };
        var a = Ch(this._xlsxData);
        if (!a || !Array.isArray(a))
          return console.error("XLSX: "), {
            data: [],
            cols: 0,
            rowCount: 0,
            mergeCells: [],
            styles: {},
            rowHeights: [],
            colWidths: []
          };
        var s = this.processMergedCellData(a);
        return {
          data: s,
          cols: ((i = s[0]) === null || i === void 0 ? void 0 : i.length) || 0,
          rowCount: s.length,
          mergeCells: this._mergeCells,
          styles: this._cellStyles,
          rowHeights: this._rowHeights,
          colWidths: this._colWidths
        };
      } catch (o) {
        return console.error("XLSX:", o), {
          data: [],
          cols: 0,
          rowCount: 0,
          mergeCells: [],
          styles: {},
          rowHeights: [],
          colWidths: []
        };
      }
    }
  }, {
    key: "getDefaultStyle",
    value: function() {
      return {
        name: "STANDARD",
        textHeight: 2.5,
        borderColor: 0,
        textColor: 0,
        textAlignment: "center",
        textVerticalAlignment: "middle",
        textStyle: "Standard",
        borderLineWeight: Ie.LineWeight.kLnWtByLayer,
        borderLineType: "Continuous"
      };
    }
  }, {
    key: "processMergedCellData",
    value: function(i) {
      if (!i || i.length === 0) return i;
      var a = JSON.parse(JSON.stringify(i)), s = Qt(this._mergeCells), o;
      try {
        for (s.s(); !(o = s.n()).done; ) {
          var u, l = o.value, c = l.row, f = l.col, h = l.rowspan, d = l.colspan, g = (u = a[c]) === null || u === void 0 ? void 0 : u[f];
          if (g !== void 0) {
            for (var v = 0; v < h; v++)
              for (var m = 0; m < d; m++)
                if (!(v === 0 && m === 0)) {
                  var p = c + v, y = f + m;
                  a[p] && (a[p][y] = g);
                }
          }
        }
      } catch (w) {
        s.e(w);
      } finally {
        s.f();
      }
      return a;
    }
  }, {
    key: "dwgInFields",
    value: function(i) {
      this.position = i.readPoint("position").val, this.styleName = i.readString("styleName").val, this._xlsxData = i.readString("xlsxData").val;
      for (var a = i.readString("mat").val, s = JSON.parse(a), o = 0; o < s.length; o++)
        for (var u = s[o], l = 0; l < u.length; l++) {
          var c = u[l];
          this._mat.setData(o, l, c);
        }
      try {
        this._cellStyles = JSON.parse(i.readString("cellStyles").val) || {};
      } catch (g) {
        console.error(":", g), this._cellStyles = {};
      }
      try {
        var f = i.readString("mergeCells").val;
        this._mergeCells = f ? JSON.parse(f) : [];
      } catch (g) {
        console.error(":", g), this._mergeCells = [];
      }
      try {
        var h = i.readString("colWidths").val;
        this._colWidths = h ? JSON.parse(h) : [];
      } catch (g) {
        console.error(":", g), this._colWidths = [];
      }
      try {
        var d = i.readString("rowHeights").val;
        this._rowHeights = d ? JSON.parse(d) : [];
      } catch (g) {
        console.error(":", g), this._rowHeights = [];
      }
      return !0;
    }
  }, {
    key: "dwgOutFields",
    value: function(i) {
      i.writePoint("position", this.position), i.writeString("styleName", this.styleName), i.writeString("xlsxData", this._xlsxData);
      for (var a = [], s = 0; s < 4; s++) {
        a[s] = [];
        for (var o = 0; o < 4; o++) {
          var u = this._mat.getData(s, o);
          a[s][o] = u;
        }
      }
      i.writeString("mat", JSON.stringify(a));
      try {
        i.writeString("cellStyles", JSON.stringify(this._cellStyles));
      } catch (l) {
        console.error(":", l), i.writeString("cellStyles", "{}");
      }
      return this._mergeCells.length > 0 ? i.writeString("mergeCells", JSON.stringify(this._mergeCells)) : i.writeString("mergeCells", "[]"), this._colWidths.length > 0 ? i.writeString("colWidths", JSON.stringify(this._colWidths)) : i.writeString("colWidths", "[]"), this._rowHeights.length > 0 ? i.writeString("rowHeights", JSON.stringify(this._rowHeights)) : i.writeString("rowHeights", "[]"), !0;
    }
  }, {
    key: "calculateTableDimensions",
    value: function() {
      try {
        var i = this.getTableData();
        if (i.rowCount === 0 || i.cols === 0)
          return {
            width: 0,
            height: 0
          };
        for (var a = 0, s = 0; s < i.cols; s++)
          a += this.getColumnWidth(s);
        for (var o = 0, u = 0; u < i.rowCount; u++)
          o += this.getRowHeight(u);
        return {
          width: a,
          height: o
        };
      } catch (l) {
        return console.error(":", l), {
          width: this.colWidth * 5,
          height: this.rowHeight * 5
        };
      }
    }
  }, {
    key: "getSelectionRange",
    value: function() {
      if (this._selectedCells.length === 0) return null;
      var i = Number.MAX_VALUE, a = Number.MAX_VALUE, s = Number.MIN_VALUE, o = Number.MIN_VALUE, u = /* @__PURE__ */ new Set(), l = Qt(this._selectedCells), c;
      try {
        for (l.s(); !(c = l.n()).done; ) {
          var f = c.value, h = f.row, d = f.col, g = h, v = d, m = h, p = d, y = !1, w = Qt(this._mergeCells), x;
          try {
            for (w.s(); !(x = w.n()).done; ) {
              var b = x.value;
              if (h === b.row && d === b.col) {
                y = !0, m = h + b.rowspan - 1, p = d + b.colspan - 1;
                var M = "".concat(b.row, ",").concat(b.col);
                u.add(M);
                break;
              }
            }
          } catch (_) {
            w.e(_);
          } finally {
            w.f();
          }
          if (!y) {
            var k = Qt(this._mergeCells), E;
            try {
              for (k.s(); !(E = k.n()).done; ) {
                var S = E.value, F = h >= S.row && h < S.row + S.rowspan, O = d >= S.col && d < S.col + S.colspan;
                if (F && O) {
                  var D = "".concat(S.row, ",").concat(S.col);
                  if (u.has(D))
                    break;
                  u.add(D), g = S.row, v = S.col, m = S.row + S.rowspan - 1, p = S.col + S.colspan - 1;
                  break;
                }
              }
            } catch (_) {
              k.e(_);
            } finally {
              k.f();
            }
          }
          i = Math.min(i, g), a = Math.min(a, v), s = Math.max(s, m), o = Math.max(o, p);
        }
      } catch (_) {
        l.e(_);
      } finally {
        l.f();
      }
      return i === Number.MAX_VALUE || a === Number.MAX_VALUE ? null : {
        minRow: i,
        minCol: a,
        maxRow: s,
        maxCol: o
      };
    }
  }, {
    key: "setSelectedCell",
    value: function(i, a) {
      this._selectedCells = [{
        row: i,
        col: a
      }];
    }
  }, {
    key: "addSelectedCell",
    value: function(i, a) {
      var s = this._selectedCells.some(function(o) {
        return o.row === i && o.col === a;
      });
      s || this._selectedCells.push({
        row: i,
        col: a
      });
    }
  }, {
    key: "setSelectedCells",
    value: function(i) {
      this._selectedCells = Xt(i);
    }
  }, {
    key: "clearSelectedCell",
    value: function() {
      this._selectedCells = [];
    }
  }, {
    key: "getSelectedCell",
    value: function() {
      return this._selectedCells.length > 0 ? this._selectedCells[0] : null;
    }
  }, {
    key: "getSelectedCells",
    value: function() {
      return Xt(this._selectedCells);
    }
  }, {
    key: "isCellSelected",
    value: function(i, a) {
      return this._selectedCells.some(function(s) {
        return s.row === i && s.col === a;
      });
    }
  }, {
    key: "getSelectedCellCount",
    value: function() {
      return this._selectedCells.length;
    }
  }, {
    key: "worldDraw",
    value: function(i) {
      if (this.styleName.length != 0) {
        var a = Ex(i.getDatabase(), this.styleName);
        if (!a && this.styleName === Mx && (a = this.getDefaultStyle()), !!a) {
          var s = {
            x: this.position.x,
            y: this.position.y,
            z: this.position.z
          }, o = this.getTableData(), u = this.calculateTableDimensions(), l = kh.drawTable(i, s, u, o, a, this.rowHeight, this.colWidth, this._mergeCells, this._rowHeights, this._colWidths, this._cellStyles);
          l && l.size > 0 && (this._cellTextDimensions = l);
        }
      }
    }
  }, {
    key: "setFromWorkbook",
    value: function(i) {
      this.assertWrite();
      try {
        this._xlsxData = _l(i.data), this._mergeCells = i.mergeCells || [], this._colWidths = i.colWidths || [], this._rowHeights = i.rowHeights || [], this._cellStyles = i.cellStyles || {};
      } catch (a) {
        console.error(":", a);
      }
    }
  }, {
    key: "setFromJson",
    value: function(i) {
      this.assertWrite();
      try {
        var a = io.ensureSlateFormat(i);
        this._xlsxData = _l(a);
      } catch (s) {
        console.error("JSON:", s);
      }
    }
  }, {
    key: "setFromArray",
    value: function(i) {
      this.assertWrite();
      try {
        var a = io.ensureSlateFormat(i);
        this._xlsxData = _l(a);
      } catch (s) {
        console.error(":", s);
      }
    }
  }, {
    key: "setMergeCells",
    value: function(i) {
      this.assertWrite(), this._mergeCells = i;
    }
  }, {
    key: "getMergeCells",
    value: function() {
      return this._mergeCells;
    }
  }, {
    key: "setColumnWidth",
    value: function(i, a) {
      if (this.assertWrite(), !(i < 0 || a <= 0)) {
        var s = this._colWidths.findIndex(function(o) {
          return o.col === i;
        });
        s >= 0 ? this._colWidths[s].width = a : this._colWidths.push({
          col: i,
          width: a
        });
      }
    }
  }, {
    key: "getColumnWidth",
    value: function(i) {
      var a = this._colWidths.find(function(s) {
        return s.col === i;
      });
      return a ? a.width : this.colWidth;
    }
  }, {
    key: "getAllColumnWidths",
    value: function() {
      return Xt(this._colWidths);
    }
  }, {
    key: "resetColumnWidth",
    value: function(i) {
      this.assertWrite(), this._colWidths = this._colWidths.filter(function(a) {
        return a.col !== i;
      });
    }
  }, {
    key: "setRowHeight",
    value: function(i, a) {
      if (this.assertWrite(), !(i < 0 || a <= 0)) {
        var s = this._rowHeights.findIndex(function(o) {
          return o.row === i;
        });
        s >= 0 ? this._rowHeights[s].height = a : this._rowHeights.push({
          row: i,
          height: a
        });
      }
    }
  }, {
    key: "getRowHeight",
    value: function(i) {
      var a = this._rowHeights.find(function(s) {
        return s.row === i;
      });
      return a ? a.height : this.rowHeight;
    }
  }, {
    key: "getAllRowHeights",
    value: function() {
      return Xt(this._rowHeights);
    }
  }, {
    key: "resetRowHeight",
    value: function(i) {
      this.assertWrite(), this._rowHeights = this._rowHeights.filter(function(a) {
        return a.row !== i;
      });
    }
  }, {
    key: "getCellValue",
    value: function(i, a) {
      try {
        var s = Ch(this._xlsxData);
        if (!s || !Array.isArray(s) || i < 0 || a < 0 || i >= s.length)
          return null;
        var o = s[i];
        return !o || a >= o.length ? null : o[a];
      } catch (u) {
        return console.error(":", u), null;
      }
    }
  }, {
    key: "setCellValue",
    value: function(i, a, s) {
      this.assertWrite();
      try {
        var o = Ch(this._xlsxData);
        if (!o || !Array.isArray(o))
          return;
        for (; o.length <= i; )
          o.push([]);
        for (; o[i].length <= a; )
          o[i].push(null);
        var u;
        io.isSlateData(s) ? u = s : u = io.convertToSlateData(String(s)), o[i][a] = u, this._xlsxData = _l(o);
      } catch (l) {
        console.error(":", l);
      }
    }
  }, {
    key: "getCellTextValue",
    value: function(i, a) {
      var s = this.getCellValue(i, a);
      return io.extractTextFromSlate(s);
    }
  }, {
    key: "getCellGeometry",
    value: function(i, a) {
      var s = this;
      try {
        var o = this.getTableData();
        if (i < 0 || a < 0 || i >= o.rowCount || a >= o.cols)
          return null;
        var u = this.calculateTableDimensions(), l = kh.calculateActualDimensions(u, o.rowCount, o.cols, this.rowHeight, this.colWidth, this._rowHeights, this._colWidths, !0), c = l.rowPositions, f = l.colPositions, h = c.map(function(F) {
          return s.position.y - F;
        }), d = f.map(function(F) {
          return s.position.x + F;
        }), g = d[a], v = h[i], m, p, y = !1, w = a + 1, x = i + 1, b = Qt(this._mergeCells), M;
        try {
          for (b.s(); !(M = b.n()).done; ) {
            var k = M.value;
            if (i === k.row && a === k.col) {
              y = !0, w = a + k.colspan, x = i + k.rowspan;
              break;
            }
          }
        } catch (F) {
          b.e(F);
        } finally {
          b.f();
        }
        m = d[y ? w : a + 1], p = h[y ? x : i + 1];
        var E = new te(g, p, this.position.z), S = new te(m, v, this.position.z);
        return {
          min: E,
          max: S
        };
      } catch (F) {
        return console.error(":", F), null;
      }
    }
  }, {
    key: "getCellReference",
    value: function(i, a) {
      try {
        var s = "", o = a;
        do {
          var u = o % 26;
          s = String.fromCharCode(65 + u) + s, o = Math.floor(o / 26) - 1;
        } while (o >= 0);
        var l = (i + 1).toString();
        return s + l;
      } catch (c) {
        return console.error(":", c), "";
      }
    }
  }, {
    key: "getCellFromReference",
    value: function(i) {
      try {
        var a = i.match(/^([A-Z]+)([0-9]+)$/);
        if (!a)
          return null;
        for (var s = a[1], o = a[2], u = 0, l = 0; l < s.length; l++)
          u = u * 26 + (s.charCodeAt(l) - 64);
        u--;
        var c = parseInt(o) - 1;
        return c < 0 || u < 0 ? null : {
          row: c,
          col: u
        };
      } catch (f) {
        return console.error(":", f), null;
      }
    }
  }, {
    key: "setCellBackgroundColor",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = br(br({}, this._cellStyles[o]), {}, {
        backgroundColor: s
      });
    }
  }, {
    key: "getCellBackgroundColor",
    value: function(i, a) {
      var s, o = this.getCellReference(i, a);
      return (s = this._cellStyles[o]) === null || s === void 0 ? void 0 : s.backgroundColor;
    }
  }, {
    key: "setCellBackgroundColorByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellBackgroundColor(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellBackgroundColor",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellBackgroundColorByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellBackgroundColor(o.row, o.col, a);
      });
    }
  }, {
    key: "setCellTextColor",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this._cellStyles[this.getCellReference(i, a)] || {};
      this._cellStyles[this.getCellReference(i, a)] = br(br({}, o), {}, {
        textColor: s
      });
    }
  }, {
    key: "getCellTextColor",
    value: function(i, a) {
      var s, o = this.getCellReference(i, a);
      return (s = this._cellStyles[o]) === null || s === void 0 ? void 0 : s.textColor;
    }
  }, {
    key: "setCellTextColorByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellTextColor(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellTextColor",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellTextColorByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellTextColor(o.row, o.col, a);
      });
    }
  }, {
    key: "setCellAlignment",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = br(br({}, this._cellStyles[o]), {}, {
        alignment: s
      });
    }
  }, {
    key: "getCellAlignment",
    value: function(i, a) {
      var s, o = this.getCellReference(i, a);
      return (s = this._cellStyles[o]) === null || s === void 0 ? void 0 : s.alignment;
    }
  }, {
    key: "setCellAlignmentByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellAlignment(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellAlignment",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellAlignmentByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellAlignment(o.row, o.col, a);
      });
    }
  }, {
    key: "setCellVerticalAlignment",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = br(br({}, this._cellStyles[o]), {}, {
        verticalAlignment: s
      });
    }
  }, {
    key: "getCellVerticalAlignment",
    value: function(i, a) {
      var s, o = this.getCellReference(i, a);
      return (s = this._cellStyles[o]) === null || s === void 0 ? void 0 : s.verticalAlignment;
    }
  }, {
    key: "setCellVerticalAlignmentByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellVerticalAlignment(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellVerticalAlignment",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellVerticalAlignmentByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellVerticalAlignment(o.row, o.col, a);
      });
    }
  }, {
    key: "getCellAtPoint",
    value: function(i) {
      var a = this;
      try {
        var s = this.getTableData();
        if (s.rowCount === 0 || s.cols === 0)
          return null;
        var o = this.calculateTableDimensions();
        if (i.x < this.position.x || i.x > this.position.x + o.width || i.y > this.position.y || i.y < this.position.y - o.height)
          return null;
        for (var u = kh.calculateActualDimensions(o, s.rowCount, s.cols, this.rowHeight, this.colWidth, this._rowHeights, this._colWidths, !0), l = u.rowPositions, c = u.colPositions, f = l.map(function(E) {
          return a.position.y - E;
        }), h = c.map(function(E) {
          return a.position.x + E;
        }), d = -1, g = 0; g < f.length - 1; g++)
          if (i.y <= f[g] && i.y > f[g + 1]) {
            d = g;
            break;
          }
        for (var v = -1, m = 0; m < h.length - 1; m++)
          if (i.x >= h[m] && i.x < h[m + 1]) {
            v = m;
            break;
          }
        if (d === -1 || v === -1)
          return {
            row: d,
            col: v
          };
        var p = Qt(this._mergeCells), y;
        try {
          for (p.s(); !(y = p.n()).done; ) {
            var w = y.value, x = w.row, b = w.col, M = w.rowspan, k = w.colspan;
            if (d >= x && d < x + M && v >= b && v < b + k)
              return {
                row: x,
                col: b
              };
          }
        } catch (E) {
          p.e(E);
        } finally {
          p.f();
        }
        return {
          row: d,
          col: v
        };
      } catch (E) {
        return console.error(":", E), null;
      }
    }
  }, {
    key: "getGripPoints",
    value: function() {
      var i = new Xr(), a = this.getTableData(), s = a.rowCount * a.cols;
      if (this._selectedCells.length > 0 && this._selectedCells.length < s) {
        var o = this.getSelectionRange();
        if (o) {
          var u = o.minRow, l = o.minCol, c = o.maxRow, f = o.maxCol, h = Number.MAX_VALUE, d = Number.MAX_VALUE, g = Number.MIN_VALUE, v = Number.MIN_VALUE, m = this.getCellGeometry(u, l);
          m && (h = m.min.x, v = m.max.y);
          var p = this.getCellGeometry(c, f);
          if (p && (g = p.max.x, d = p.min.y), h !== Number.MAX_VALUE && d !== Number.MAX_VALUE && g !== Number.MIN_VALUE && v !== Number.MIN_VALUE) {
            var y = new te(h, (d + v) / 2, this.position.z), w = new te((h + g) / 2, v, this.position.z), x = new te(g, (d + v) / 2, this.position.z), b = new te((h + g) / 2, d, this.position.z);
            return i.append(y), i.append(w), i.append(x), i.append(b), i;
          }
        }
        var M = Number.MAX_VALUE, k = Number.MAX_VALUE, E = Number.MIN_VALUE, S = Number.MIN_VALUE, F = /* @__PURE__ */ new Set(), O = Qt(this._selectedCells), D;
        try {
          for (O.s(); !(D = O.n()).done; ) {
            var _ = D.value, L = _.row, G = _.col, V = !1, H = Qt(this._mergeCells), U;
            try {
              for (H.s(); !(U = H.n()).done; ) {
                var R = U.value;
                if (L === R.row && G === R.col) {
                  var B = "".concat(R.row, ",").concat(R.col);
                  if (F.has(B)) {
                    V = !0;
                    break;
                  }
                  F.add(B);
                  var C = this.getCellGeometry(R.row, R.col), Z = R.row + R.rowspan - 1, W = R.col + R.colspan - 1, J = this.getCellGeometry(Z, W);
                  C && J && (M = Math.min(M, C.min.x), k = Math.min(k, C.min.y), E = Math.max(E, J.max.x), S = Math.max(S, J.max.y)), V = !0;
                  break;
                }
              }
            } catch (I) {
              H.e(I);
            } finally {
              H.f();
            }
            if (!V) {
              var Q = Qt(this._mergeCells), j;
              try {
                for (Q.s(); !(j = Q.n()).done; ) {
                  var q = j.value, ae = L >= q.row && L < q.row + q.rowspan, pe = G >= q.col && G < q.col + q.colspan;
                  if (ae && pe) {
                    var $ = "".concat(q.row, ",").concat(q.col);
                    if (F.has($)) {
                      V = !0;
                      break;
                    }
                    F.add($);
                    var se = this.getCellGeometry(q.row, q.col), ve = q.row + q.rowspan - 1, me = q.col + q.colspan - 1, Ae = this.getCellGeometry(ve, me);
                    se && Ae && (M = Math.min(M, se.min.x), k = Math.min(k, se.min.y), E = Math.max(E, Ae.max.x), S = Math.max(S, Ae.max.y)), V = !0;
                    break;
                  }
                }
              } catch (I) {
                Q.e(I);
              } finally {
                Q.f();
              }
            }
            if (!V) {
              var Ce = this.getCellGeometry(L, G);
              Ce && (M = Math.min(M, Ce.min.x), k = Math.min(k, Ce.min.y), E = Math.max(E, Ce.max.x), S = Math.max(S, Ce.max.y));
            }
          }
        } catch (I) {
          O.e(I);
        } finally {
          O.f();
        }
        if (M !== Number.MAX_VALUE && k !== Number.MAX_VALUE && E !== Number.MIN_VALUE && S !== Number.MIN_VALUE) {
          var Ee = new te(M, k, this.position.z), Y = new te(E, S, this.position.z), ee = new te(Ee.x, (Ee.y + Y.y) / 2, this.position.z), Me = new te((Ee.x + Y.x) / 2, Y.y, this.position.z), ye = new te(Y.x, (Ee.y + Y.y) / 2, this.position.z), De = new te((Ee.x + Y.x) / 2, Ee.y, this.position.z);
          return i.append(ee), i.append(Me), i.append(ye), i.append(De), i;
        }
      }
      var Se = this.calculateTableDimensions(), fe = this.position.clone(), ke = new te(this.position.x + Se.width, this.position.y, this.position.z), ne = new te(this.position.x, this.position.y - Se.height, this.position.z), Te = new te(this.position.x + Se.width, this.position.y - Se.height, this.position.z);
      return i.append(fe), i.append(ke), i.append(ne), i.append(Te), i;
    }
  }, {
    key: "moveGripPointsAt",
    value: function(i, a, s, o) {
      if (this.assertWrite(), this._selectedCells.length > 0) {
        var u = this.getSelectionRange();
        if (!u) return;
        var l = u.minRow, c = u.minCol, f = u.maxRow, h = u.maxCol, d = 10, g = 10, v = d, m = g, p = [], y = Qt(this._mergeCells), w;
        try {
          for (y.s(); !(w = y.n()).done; ) {
            var x = w.value, b = x.row + x.rowspan - 1, M = x.col + x.colspan - 1;
            b < l || x.row > f || M < c || x.col > h || p.push(x);
          }
        } catch (xn) {
          y.e(xn);
        } finally {
          y.f();
        }
        switch (i) {
          case 0:
            if (a < 0) {
              for (var k = 0, E = c; E <= h; E++)
                k += this.getColumnWidth(E);
              var S = Math.abs(a), F = (k + S) / k;
              this.position.x += a;
              for (var O = c; O <= h; O++) {
                var D = this.getColumnWidth(O), _ = D * F;
                this.setColumnWidth(O, _);
              }
            } else {
              for (var L = 0, G = c; G <= h; G++)
                L += this.getColumnWidth(G);
              var V = (h - c + 1) * v, H = Qt(p), U;
              try {
                for (H.s(); !(U = H.n()).done; ) {
                  var R = U.value;
                  if (R.col <= c && R.col + R.colspan - 1 >= c) {
                    var B = "".concat(R.row, ",").concat(R.col), C = this._cellTextDimensions.get(B);
                    if (C) {
                      var Z = C.width + 10;
                      V = Math.max(V, Z);
                    }
                  }
                }
              } catch (xn) {
                H.e(xn);
              } finally {
                H.f();
              }
              var W = Math.max(0, L - V), J = Math.min(a, W);
              if (J > 0) {
                var Q = (L - J) / L;
                this.position.x += J;
                for (var j = c; j <= h; j++) {
                  var q = this.getColumnWidth(j), ae = Math.max(q * Q, v);
                  this.setColumnWidth(j, ae);
                }
              }
            }
            break;
          case 1:
            if (s > 0) {
              for (var pe = 0, $ = l; $ <= f; $++)
                pe += this.getRowHeight($);
              var se = s, ve = (pe + se) / pe;
              this.position.y += s;
              for (var me = l; me <= f; me++) {
                var Ae = this.getRowHeight(me), Ce = Ae * ve;
                this.setRowHeight(me, Ce);
              }
            } else {
              for (var Ee = 0, Y = l; Y <= f; Y++)
                Ee += this.getRowHeight(Y);
              var ee = (f - l + 1) * m, Me = Qt(p), ye;
              try {
                for (Me.s(); !(ye = Me.n()).done; ) {
                  var De = ye.value;
                  if (De.row <= l && De.row + De.rowspan - 1 >= l) {
                    var Se = "".concat(De.row, ",").concat(De.col), fe = this._cellTextDimensions.get(Se);
                    if (fe) {
                      var ke = fe.height + 10;
                      ee = Math.max(ee, ke);
                    }
                  }
                }
              } catch (xn) {
                Me.e(xn);
              } finally {
                Me.f();
              }
              var ne = Math.max(0, Ee - ee), Te = Math.min(Math.abs(s), ne);
              if (Te > 0) {
                var I = (Ee - Te) / Ee;
                this.position.y -= Te;
                for (var A = l; A <= f; A++) {
                  var T = this.getRowHeight(A), P = Math.max(T * I, m);
                  this.setRowHeight(A, P);
                }
              }
            }
            break;
          case 2:
            if (a > 0) {
              for (var z = 0, K = c; K <= h; K++)
                z += this.getColumnWidth(K);
              for (var oe = a, ce = (z + oe) / z, ge = c; ge <= h; ge++) {
                var Oe = this.getColumnWidth(ge), Ge = Oe * ce;
                this.setColumnWidth(ge, Ge);
              }
            } else {
              for (var We = 0, $e = c; $e <= h; $e++)
                We += this.getColumnWidth($e);
              var pt = (h - c + 1) * v, tt = Qt(p), xt;
              try {
                for (tt.s(); !(xt = tt.n()).done; ) {
                  var ht = xt.value;
                  if (ht.col + ht.colspan - 1 >= h) {
                    var Vt = "".concat(ht.row, ",").concat(ht.col), qe = this._cellTextDimensions.get(Vt);
                    if (qe) {
                      var ze = qe.width + 10;
                      pt = Math.max(pt, ze);
                    }
                  }
                }
              } catch (xn) {
                tt.e(xn);
              } finally {
                tt.f();
              }
              var He = Math.max(0, We - pt), Ht = Math.min(Math.abs(a), He);
              if (Ht > 0)
                for (var mt = (We - Ht) / We, vt = c; vt <= h; vt++) {
                  var Ct = this.getColumnWidth(vt), Rt = Math.max(Ct * mt, v);
                  this.setColumnWidth(vt, Rt);
                }
            }
            break;
          case 3:
            if (s < 0) {
              for (var St = 0, zt = l; zt <= f; zt++)
                St += this.getRowHeight(zt);
              for (var nr = Math.abs(s), ir = (St + nr) / St, ar = l; ar <= f; ar++) {
                var gt = this.getRowHeight(ar), Dt = gt * ir;
                this.setRowHeight(ar, Dt);
              }
            } else {
              for (var Jt = 0, dr = l; dr <= f; dr++)
                Jt += this.getRowHeight(dr);
              var N = (f - l + 1) * m, X = Qt(p), ue;
              try {
                for (X.s(); !(ue = X.n()).done; ) {
                  var we = ue.value;
                  if (we.row + we.rowspan - 1 >= f) {
                    var Le = "".concat(we.row, ",").concat(we.col), Ke = this._cellTextDimensions.get(Le);
                    if (Ke) {
                      var Re = Ke.height + 10;
                      N = Math.max(N, Re);
                    }
                  }
                }
              } catch (xn) {
                X.e(xn);
              } finally {
                X.f();
              }
              var at = Math.max(0, Jt - N), Ne = Math.min(s, at);
              if (Ne > 0)
                for (var Ye = (Jt - Ne) / Jt, Tt = l; Tt <= f; Tt++) {
                  var kt = this.getRowHeight(Tt), Mt = Math.max(kt * Ye, m);
                  this.setRowHeight(Tt, Mt);
                }
            }
            break;
        }
      } else {
        var je = this.getTableData(), Xe = je.rowCount - 1, Lt = je.cols - 1;
        if (Xe < 0 || Lt < 0) {
          i === 0 && (this.position.x += a, this.position.y += s, this.position.z += o);
          return;
        }
        switch (i) {
          case 0:
            this.position.x += a, this.position.y += s, this.position.z += o;
            break;
          case 1:
            {
              for (var Ut = 0, gr = 0; gr <= Lt; gr++)
                Ut += this.getColumnWidth(gr);
              if (Math.abs(a) < Ut * 0.1) {
                var yt = this.getColumnWidth(Lt), ct = Math.max(yt + a, 10);
                this.setColumnWidth(Lt, ct);
              } else
                for (var pr = Math.max(Ut + a, Lt * 10), Gr = pr / Ut, yr = 0; yr <= Lt; yr++) {
                  var Qr = this.getColumnWidth(yr), jt = Math.max(Qr * Gr, 10);
                  this.setColumnWidth(yr, jt);
                }
            }
            break;
          case 2:
            {
              for (var Cr = 0, en = 0; en <= Xe; en++)
                Cr += this.getRowHeight(en);
              if (Math.abs(s) < Cr * 0.1) {
                var Kn = this.getRowHeight(Xe), Gi = Math.max(Kn - s, 10);
                this.setRowHeight(Xe, Gi);
              } else
                for (var di = Math.max(Cr - s, Xe * 10), yn = di / Cr, bn = 0; bn <= Xe; bn++) {
                  var pi = this.getRowHeight(bn), Xa = Math.max(pi * yn, 10);
                  this.setRowHeight(bn, Xa);
                }
            }
            break;
          case 3:
            {
              for (var Zn = 0, Jn = 0; Jn <= Lt; Jn++)
                Zn += this.getColumnWidth(Jn);
              if (Math.abs(a) < Zn * 0.1) {
                var Ss = this.getColumnWidth(Lt), da = Math.max(Ss + a, 10);
                this.setColumnWidth(Lt, da);
              } else
                for (var Qn = Math.max(Zn + a, Lt * 10), on = Qn / Zn, un = 0; un <= Lt; un++) {
                  var ln = this.getColumnWidth(un), vi = Math.max(ln * on, 10);
                  this.setColumnWidth(un, vi);
                }
              for (var Rn = 0, On = 0; On <= Xe; On++)
                Rn += this.getRowHeight(On);
              if (Math.abs(s) < Rn * 0.1) {
                var ks = this.getRowHeight(Xe), ei = Math.max(ks - s, 10);
                this.setRowHeight(Xe, ei);
              } else
                for (var zi = Math.max(Rn - s, Xe * 10), Cs = zi / Rn, wn = 0; wn <= Xe; wn++) {
                  var Ds = this.getRowHeight(wn), pa = Math.max(Ds * Cs, 10);
                  this.setRowHeight(wn, pa);
                }
            }
            break;
        }
      }
    }
  }, {
    key: "transformBy",
    value: function(i) {
      return this.assertWrite(), this._mat = i.clone(), !1;
    }
  }, {
    key: "setCellTextStyle",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = ma.setTextStyle(this._cellStyles[o], s);
    }
  }, {
    key: "getCellTextStyle",
    value: function(i, a) {
      var s = this.getCellReference(i, a);
      return ma.getTextStyle(this._cellStyles[s]);
    }
  }, {
    key: "setCellTextStyleByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellTextStyle(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellTextStyle",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellTextStyleByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellTextStyle(o.row, o.col, a);
      });
    }
  }, {
    key: "setCellTextAngle",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = ma.setTextAngle(this._cellStyles[o], s);
    }
  }, {
    key: "getCellTextAngle",
    value: function(i, a) {
      var s = this.getCellReference(i, a);
      return ma.getTextAngle(this._cellStyles[s]);
    }
  }, {
    key: "setCellTextAngleByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellTextAngle(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellTextAngle",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellTextAngleByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellTextAngle(o.row, o.col, a);
      });
    }
  }, {
    key: "setCellBorderLineWeight",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = ma.setBorderLineWeight(this._cellStyles[o], s);
    }
  }, {
    key: "getCellBorderLineWeight",
    value: function(i, a) {
      var s = this.getCellReference(i, a);
      return ma.getBorderLineWeight(this._cellStyles[s]);
    }
  }, {
    key: "setCellBorderLineWeightByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellBorderLineWeight(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellBorderLineWeight",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellBorderLineWeightByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellBorderLineWeight(o.row, o.col, a);
      });
    }
  }, {
    key: "setCellBorderLineType",
    value: function(i, a, s) {
      this.assertWrite();
      var o = this.getCellReference(i, a);
      this._cellStyles[o] = ma.setBorderLineType(this._cellStyles[o], s);
    }
  }, {
    key: "getCellBorderLineType",
    value: function(i, a) {
      var s = this.getCellReference(i, a);
      return ma.getBorderLineType(this._cellStyles[s]);
    }
  }, {
    key: "setCellBorderLineTypeByRef",
    value: function(i, a) {
      var s = this.getCellFromReference(i);
      return s ? (this.setCellBorderLineType(s.row, s.col, a), !0) : !1;
    }
  }, {
    key: "setBatchCellBorderLineType",
    value: function(i, a) {
      var s = this;
      this.assertWrite(), i.forEach(function(o) {
        typeof o == "string" ? s.setCellBorderLineTypeByRef(o, a) : o && Er(o) === "object" && "row" in o && "col" in o && s.setCellBorderLineType(o.row, o.col, a);
      });
    }
  }, {
    key: "isMergedCellSelected",
    value: function() {
      if (!this) return !1;
      var i = this.getSelectedCells();
      if (i.length === 0) return !1;
      var a = this.getMergeCells();
      if (!a || a.length === 0) return !1;
      var s = Qt(i), o;
      try {
        for (s.s(); !(o = s.n()).done; ) {
          var u = o.value, l = Qt(a), c;
          try {
            for (l.s(); !(c = l.n()).done; ) {
              var f = c.value;
              if (u.row >= f.row && u.row < f.row + f.rowspan && u.col >= f.col && u.col < f.col + f.colspan)
                return !0;
            }
          } catch (h) {
            l.e(h);
          } finally {
            l.f();
          }
        }
      } catch (h) {
        s.e(h);
      } finally {
        s.f();
      }
      return !1;
    }
  }, {
    key: "hasUnmergedCellsSelected",
    value: function() {
      if (!this) return !1;
      var i = this.getSelectedCells();
      if (i.length === 0) return !1;
      var a = this.getMergeCells();
      if (!a || a.length === 0) return !0;
      var s = Qt(i), o;
      try {
        for (s.s(); !(o = s.n()).done; ) {
          var u = o.value, l = !1, c = Qt(a), f;
          try {
            for (c.s(); !(f = c.n()).done; ) {
              var h = f.value;
              if (u.row >= h.row && u.row < h.row + h.rowspan && u.col >= h.col && u.col < h.col + h.colspan) {
                l = !0;
                break;
              }
            }
          } catch (d) {
            c.e(d);
          } finally {
            c.f();
          }
          if (!l) return !0;
        }
      } catch (d) {
        s.e(d);
      } finally {
        s.f();
      }
      return !1;
    }
  }, {
    key: "updateMergeCellsAfterRowInsert",
    value: function(i) {
      if (this) {
        var a = this.getMergeCells(), s = a.map(function(o) {
          return o.row >= i ? br(br({}, o), {}, {
            row: o.row + 1
          }) : o;
        });
        this.setMergeCells(s);
      }
    }
  }, {
    key: "updateSelectedCells",
    value: function(i, a) {
      this.setSelectedCells(i), a && a(i);
    }
  }, {
    key: "insertRow",
    value: function(i, a) {
      if (this)
        try {
          var s = this.xlsxData ? JSON.parse(atob(this.xlsxData)) : [];
          if (!Array.isArray(s)) return;
          var o = this.getSelectionRange();
          if (!o) return;
          var u = i === "above" ? o.minRow : o.maxRow + 1;
          if (s.length === 0)
            s.push([]);
          else {
            var l = 0, c = Qt(s), f;
            try {
              for (c.s(); !(f = c.n()).done; ) {
                var h = f.value;
                l = Math.max(l, h.length);
              }
            } catch (m) {
              c.e(m);
            } finally {
              c.f();
            }
            var d = Array(l).fill(null);
            s.splice(u, 0, d);
          }
          this.xlsxData = btoa(JSON.stringify(s)), this.updateMergeCellsAfterRowInsert(u);
          var g = this.getSelectedCells(), v = g.map(function(m) {
            return i === "above" && m.row >= u ? br(br({}, m), {}, {
              row: m.row + 1
            }) : i === "below" && m.row > u ? br(br({}, m), {}, {
              row: m.row + 1
            }) : m;
          });
          this.updateSelectedCells(v, a);
        } catch (m) {
          console.error(":", m);
        }
    }
  }, {
    key: "updateMergeCellsAfterRowDelete",
    value: function(i, a) {
      if (this) {
        var s = this.getMergeCells(), o = [], u = Qt(s), l;
        try {
          for (u.s(); !(l = u.n()).done; ) {
            var c = l.value;
            c.row >= i && c.row <= a || (c.row > a ? o.push(br(br({}, c), {}, {
              row: c.row - (a - i + 1)
            })) : o.push(c));
          }
        } catch (f) {
          u.e(f);
        } finally {
          u.f();
        }
        this.setMergeCells(o);
      }
    }
  }, {
    key: "deleteRow",
    value: function(i) {
      if (this)
        try {
          var a = this.xlsxData ? JSON.parse(atob(this.xlsxData)) : [];
          if (!Array.isArray(a) || a.length === 0) return;
          var s = this.getSelectionRange();
          if (!s) return;
          if (a.length <= s.maxRow - s.minRow + 1) {
            console.warn("");
            return;
          }
          a.splice(s.minRow, s.maxRow - s.minRow + 1), this.xlsxData = btoa(JSON.stringify(a)), this.updateMergeCellsAfterRowDelete(s.minRow, s.maxRow);
          var o = this.getSelectedCells(), u = [], l = Qt(o), c;
          try {
            for (l.s(); !(c = l.n()).done; ) {
              var f = c.value;
              f.row >= s.minRow && f.row <= s.maxRow || (f.row > s.maxRow ? u.push({
                row: f.row - (s.maxRow - s.minRow + 1),
                col: f.col
              }) : u.push(f));
            }
          } catch (d) {
            l.e(d);
          } finally {
            l.f();
          }
          if (u.length === 0 && a.length > 0) {
            var h = Math.min(s.minRow, a.length - 1);
            a[h] && a[h].length > 0 && u.push({
              row: h,
              col: 0
            });
          }
          this.updateSelectedCells(u, i);
        } catch (d) {
          console.error(":", d);
        }
    }
  }, {
    key: "updateMergeCellsAfterColumnInsert",
    value: function(i) {
      if (this) {
        var a = this.getMergeCells(), s = a.map(function(o) {
          return o.col >= i ? br(br({}, o), {}, {
            col: o.col + 1
          }) : o;
        });
        this.setMergeCells(s);
      }
    }
  }, {
    key: "insertColumn",
    value: function(i, a) {
      if (this)
        try {
          var s = this.xlsxData ? JSON.parse(atob(this.xlsxData)) : [];
          if (!Array.isArray(s)) return;
          var o = this.getSelectionRange();
          if (!o) return;
          for (var u = i === "left" ? o.minCol : o.maxCol + 1, l = 0; l < s.length; l++)
            Array.isArray(s[l]) || (s[l] = []), s[l].splice(u, 0, null);
          this.xlsxData = btoa(JSON.stringify(s)), this.updateMergeCellsAfterColumnInsert(u);
          var c = this.getSelectedCells(), f = c.map(function(h) {
            return i === "left" && h.col >= u ? br(br({}, h), {}, {
              col: h.col + 1
            }) : i === "right" && h.col > u ? br(br({}, h), {}, {
              col: h.col + 1
            }) : h;
          });
          this.updateSelectedCells(f, a);
        } catch (h) {
          console.error(":", h);
        }
    }
  }, {
    key: "updateMergeCellsAfterColumnDelete",
    value: function(i, a) {
      if (this) {
        var s = this.getMergeCells(), o = [], u = Qt(s), l;
        try {
          for (u.s(); !(l = u.n()).done; ) {
            var c = l.value;
            c.col >= i && c.col <= a || (c.col > a ? o.push(br(br({}, c), {}, {
              col: c.col - (a - i + 1)
            })) : o.push(c));
          }
        } catch (f) {
          u.e(f);
        } finally {
          u.f();
        }
        this.setMergeCells(o);
      }
    }
  }, {
    key: "deleteColumn",
    value: function(i) {
      if (this)
        try {
          var a, s = this.xlsxData ? JSON.parse(atob(this.xlsxData)) : [];
          if (!Array.isArray(s) || s.length === 0) return;
          var o = this.getSelectionRange();
          if (!o) return;
          var u = !1, l = Qt(s), c;
          try {
            for (l.s(); !(c = l.n()).done; ) {
              var f = c.value;
              if (Array.isArray(f) && f.length > o.maxCol - o.minCol + 1) {
                u = !0;
                break;
              }
            }
          } catch (w) {
            l.e(w);
          } finally {
            l.f();
          }
          if (!u) {
            console.warn("");
            return;
          }
          for (var h = 0; h < s.length; h++)
            Array.isArray(s[h]) && s[h].splice(o.minCol, o.maxCol - o.minCol + 1);
          this.xlsxData = btoa(JSON.stringify(s)), this.updateMergeCellsAfterColumnDelete(o.minCol, o.maxCol);
          var d = this.getSelectedCells(), g = [], v = Qt(d), m;
          try {
            for (v.s(); !(m = v.n()).done; ) {
              var p = m.value;
              p.col >= o.minCol && p.col <= o.maxCol || (p.col > o.maxCol ? g.push({
                row: p.row,
                col: p.col - (o.maxCol - o.minCol + 1)
              }) : g.push(p));
            }
          } catch (w) {
            v.e(w);
          } finally {
            v.f();
          }
          if (g.length === 0 && s.length > 0 && ((a = s[0]) === null || a === void 0 ? void 0 : a.length) > 0) {
            var y = Math.min(o.minCol, s[0].length - 1);
            y >= 0 && g.push({
              row: 0,
              col: y
            });
          }
          this.updateSelectedCells(g, i);
        } catch (w) {
          console.error(":", w);
        }
    }
  }, {
    key: "mergeCells",
    value: function(i) {
      if (this)
        try {
          var a = this.getSelectedCells();
          if (a.length <= 1) return;
          var s = this.getSelectionRange();
          if (!s) return;
          var o = {
            row: s.minRow,
            col: s.minCol,
            rowspan: s.maxRow - s.minRow + 1,
            colspan: s.maxCol - s.minCol + 1
          }, u = this.getMergeCells(), l = [], c = [], f = Qt(u), h;
          try {
            for (f.s(); !(h = f.n()).done; ) {
              var d = h.value, g = d.row + d.rowspan - 1, v = d.col + d.colspan - 1, m = !(g < s.minRow || d.row > s.maxRow || v < s.minCol || d.col > s.maxCol);
              if (m) {
                var p = this.getCellValue(d.row, d.col);
                p != null && p !== "" && c.push({
                  value: p,
                  row: d.row,
                  col: d.col
                });
              } else
                l.push(d);
            }
          } catch (D) {
            f.e(D);
          } finally {
            f.f();
          }
          var y = /* @__PURE__ */ new Map(), w = Qt(u), x;
          try {
            for (w.s(); !(x = w.n()).done; )
              for (var b = x.value, M = b.row; M < b.row + b.rowspan; M++)
                for (var k = b.col; k < b.col + b.colspan; k++)
                  y.set("".concat(M, ",").concat(k), !0);
          } catch (D) {
            w.e(D);
          } finally {
            w.f();
          }
          for (var E = s.minRow; E <= s.maxRow; E++)
            for (var S = s.minCol; S <= s.maxCol; S++)
              if (!y.has("".concat(E, ",").concat(S))) {
                var F = this.getCellValue(E, S);
                F != null && F !== "" && c.push({
                  value: F,
                  row: E,
                  col: S
                });
              }
          l.push(o), this.setMergeCells(l), c.length > 0 && (c.sort(function(D, _) {
            var L = Math.abs(D.row - s.minRow) + Math.abs(D.col - s.minCol), G = Math.abs(_.row - s.minRow) + Math.abs(_.col - s.minCol);
            return L - G;
          }), this.setCellValue(s.minRow, s.minCol, c[0].value));
          var O = [{
            row: s.minRow,
            col: s.minCol
          }];
          this.updateSelectedCells(O, i);
        } catch (D) {
          console.error(":", D);
        }
    }
  }, {
    key: "unMergeCells",
    value: function(i) {
      if (this)
        try {
          var a = this.getMergeCells();
          if (a.length === 0) return;
          var s = this.getSelectedCells();
          if (s.length === 0) return;
          var o = [], u = a.filter(function(l) {
            var c = Qt(s), f;
            try {
              for (c.s(); !(f = c.n()).done; ) {
                var h = f.value;
                if (h.row >= l.row && h.row < l.row + l.rowspan && h.col >= l.col && h.col < l.col + l.colspan) {
                  for (var d = l.row; d < l.row + l.rowspan; d++)
                    for (var g = l.col; g < l.col + l.colspan; g++)
                      o.push({
                        row: d,
                        col: g
                      });
                  return !1;
                }
              }
            } catch (v) {
              c.e(v);
            } finally {
              c.f();
            }
            return !0;
          });
          this.setMergeCells(u), o.length > 0 && this.updateSelectedCells(o, i);
        } catch (l) {
          console.error(":", l);
        }
    }
  }, {
    key: "setAlignment",
    value: function(i, a) {
      if (this)
        try {
          var s = this.getSelectedCells();
          if (s.length === 0) return;
          var o = Qt(s), u;
          try {
            for (o.s(); !(u = o.n()).done; ) {
              var l = u.value;
              this.setCellAlignment(l.row, l.col, i);
            }
          } catch (c) {
            o.e(c);
          } finally {
            o.f();
          }
          this.updateSelectedCells(s, a);
        } catch (c) {
          console.error(":", c);
        }
    }
  }, {
    key: "setVerticalAlignment",
    value: function(i, a) {
      if (this)
        try {
          var s = this.getSelectedCells();
          if (s.length === 0) return;
          var o = Qt(s), u;
          try {
            for (o.s(); !(u = o.n()).done; ) {
              var l = u.value;
              this.setCellVerticalAlignment(l.row, l.col, i);
            }
          } catch (c) {
            o.e(c);
          } finally {
            o.f();
          }
          this.updateSelectedCells(s, a);
        } catch (c) {
          console.error(":", c);
        }
    }
  }, {
    key: "setSelectCellBackgroundColor",
    value: function(i, a) {
      if (this)
        try {
          var s = this.getSelectedCells();
          if (s.length === 0) return;
          this.setBatchCellBackgroundColor(s, i), this.updateSelectedCells(s, a), this.updateDisplay();
        } catch (o) {
          console.error(":", o);
        }
    }
  }, {
    key: "setSelectCellTextColor",
    value: function(i, a) {
      if (this)
        try {
          var s = this.getSelectedCells();
          if (s.length === 0) return;
          this.setBatchCellTextColor(s, i), this.updateSelectedCells(s, a);
        } catch (o) {
          console.error(":", o);
        }
    }
  }, {
    key: "getSelectCellBackgroundColor",
    value: function() {
      if (!this) return null;
      try {
        var i = this.getSelectedCells();
        return i.length === 0 ? null : this.getCellBackgroundColor(i[0].row, i[0].col);
      } catch (a) {
        return console.error(":", a), null;
      }
    }
  }, {
    key: "getSelectCellTextColor",
    value: function() {
      if (!this) return null;
      try {
        var i = this.getSelectedCells();
        return i.length === 0 ? null : this.getCellTextColor(i[0].row, i[0].col);
      } catch (a) {
        return console.error(":", a), null;
      }
    }
  }]), r;
}(dl);
function Ax(e) {
  var t = x1();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function x1() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (x1 = function() {
    return !!e;
  })();
}
function Sd(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = Tx(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function Tx(e, t) {
  if (e) {
    if (typeof e == "string") return xm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? xm(e, t) : void 0;
  }
}
function xm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
var mi = function(t) {
  var r = new fr();
  try {
    if (t >= Ti.kByblock && t <= Ti.kBylayer)
      r.setColorIndex(t), Ti.kByblock === t ? r.method = hn.kByBlock : Ti.kBylayer === t ? r.method = hn.kByLayer : r.method = hn.kByACI;
    else {
      var n = t.toString(16).padStart(6, "0"), i = parseInt(n.substring(0, 2), 16), a = parseInt(n.substring(2, 4), 16), s = parseInt(n.substring(4, 6), 16);
      r.setRGB(i, a, s), r.method = hn.kByColor;
    }
    return r;
  } catch (o) {
    return console.error(":", o), r.setRGB(255, 255, 255), r.method = hn.kByColor, r;
  }
}, Sx = "McDbMLineStyleDictionary", Dh = "STANDARD";
function kx(e, t) {
  var r = e.getNamedObjectsDictionary(), n = r.getAt(Sx);
  if (!n.isNull()) {
    var i = n.getMcDbDictionary();
    if (i) {
      var a = i.getAt(t);
      if (a.isNull())
        return;
      var s = a.getMcDbXrecord();
      if (s) {
        var o = s.getData();
        try {
          return JSON.parse(o.AtString(0).val);
        } catch (u) {
          console.warn("", u);
          return;
        }
      }
    }
  }
}
var jv = /* @__PURE__ */ function(e) {
  return e[e.No = -1] = "No", e[e.Top = 0] = "Top", e[e.Middle = 1] = "Middle", e[e.Bottom = 2] = "Bottom", e;
}(jv || {});
function Cx(e) {
  if (!e || e.length <= 1)
    return e;
  var t = rr(e[0], 2), r = t[0], n = t[1], i = r.clone(), a = n.clone(), s = {
    x: a.x - i.x,
    y: a.y - i.y,
    z: a.z - i.z
  }, o = s.x * s.x + s.y * s.y + s.z * s.z;
  if (o === 0)
    return [];
  var u = 1e-10;
  function l(H) {
    var U = {
      x: H.x - i.x,
      y: H.y - i.y,
      z: H.z - i.z
    }, R = U.x * s.x + U.y * s.y + U.z * s.z;
    return R / o;
  }
  function c(H) {
    return new te(i.x + s.x * H, i.y + s.y * H, i.z + s.z * H);
  }
  var f = [], h = Sd(e), d;
  try {
    for (h.s(); !(d = h.n()).done; ) {
      var g = rr(d.value, 2), v = g[0], m = g[1], p = l(v), y = l(m), w = Math.min(p, y), x = Math.max(p, y);
      Math.abs(x - w) > u && f.push({
        tStart: w,
        tEnd: x
      });
    }
  } catch (H) {
    h.e(H);
  } finally {
    h.f();
  }
  f.sort(function(H, U) {
    return H.tStart - U.tStart;
  });
  for (var b = [], M = 0, k = f; M < k.length; M++) {
    var E = k[M];
    !b.length || E.tStart > b[b.length - 1].tEnd + u ? b.push({
      tStart: E.tStart,
      tEnd: E.tEnd
    }) : b[b.length - 1].tEnd = Math.max(b[b.length - 1].tEnd, E.tEnd);
  }
  for (var S = [], F = 0, O = b; F < O.length; F++) {
    var D = O[F], _ = D.tStart, L = D.tEnd, G = c(_), V = c(L);
    S.push([G, V]);
  }
  return S;
}
function Dx(e, t) {
  if (!e || e.length === 0) return e;
  var r = rr(t, 2), n = r[0], i = r[1], a = {
    x: i.x - n.x,
    y: i.y - n.y,
    z: i.z - n.z
  }, s = a.x * a.x + a.y * a.y + a.z * a.z;
  if (s === 0)
    return e;
  var o = 1e-10;
  function u(_) {
    var L = _.x - n.x, G = _.y - n.y, V = _.z - n.z, H = L * a.x + G * a.y + V * a.z;
    return H / s;
  }
  function l(_) {
    return new te(n.x + a.x * _, n.y + a.y * _, n.z + a.z * _);
  }
  function c(_, L) {
    var G = [];
    if (_ > L) {
      var V = [L, _];
      _ = V[0], L = V[1];
    }
    return L < 0 - o || _ > 1 + o ? (G.push([_, L]), G) : (_ < 0 - o && G.push([_, 0]), L > 1 + o && G.push([1, L]), G);
  }
  var f = [], h = Sd(e), d;
  try {
    for (h.s(); !(d = h.n()).done; ) {
      var g = rr(d.value, 2), v = g[0], m = g[1], p = u(v), y = u(m), w = Math.min(p, y), x = Math.max(p, y), b = c(w, x);
      if (b.length !== 0) {
        var M = Sd(b), k;
        try {
          for (M.s(); !(k = M.n()).done; ) {
            var E = rr(k.value, 2), S = E[0], F = E[1];
            if (Math.abs(F - S) > o) {
              var O = l(S), D = l(F);
              f.push([O, D]);
            }
          }
        } catch (_) {
          M.e(_);
        } finally {
          M.f();
        }
      }
    }
  } catch (_) {
    h.e(_);
  } finally {
    h.f();
  }
  return f;
}
var Xv = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Ax(r);
  function r(n) {
    var i;
    return Pe(this, r), i = t.call(this, n), le(dt(i), "vertices", []), le(dt(i), "styleName", ""), le(
      dt(i),
      "justification",
      -1
      /* No */
    ), le(dt(i), "scale", 10), le(dt(i), "isClosed", !1), le(dt(i), "currentStyle", null), le(dt(i), "segmentRelations", {}), i;
  }
  return Be(r, [{
    key: "setSegmentRelation",
    value: function(i, a, s) {
      this.assertWrite(), this.segmentRelations[i] || (this.segmentRelations[i] = {});
      var o = s.map(function(c) {
        var f = rr(c, 2), h = f[0], d = f[1];
        return [h.clone(), d.clone()];
      }), u = this.segmentRelations[i][a] || [], l = o.filter(function(c) {
        var f = rr(c, 2), h = f[0], d = f[1];
        return !u.some(function(g) {
          var v = rr(g, 2), m = v[0], p = v[1];
          return h.isEqualTo(m) && d.isEqualTo(p) || h.isEqualTo(p) && d.isEqualTo(m);
        });
      });
      u.length > 0 ? (u.push.apply(u, Xt(l)), this.segmentRelations[i][a] = u) : this.segmentRelations[i][a] = l;
    }
  }, {
    key: "getSegmentRelation",
    value: function(i, a) {
      return !this.segmentRelations || !this.segmentRelations[i] ? null : a !== void 0 ? this.segmentRelations[i][a] || null : this.segmentRelations[i];
    }
  }, {
    key: "getAllSegmentRelations",
    value: function() {
      return this.segmentRelations ? this.segmentRelations : {};
    }
  }, {
    key: "setAllSegmentRelations",
    value: function(i) {
      var a = this;
      this.assertWrite(), this.segmentRelations || (this.segmentRelations = {});
      for (var s in i) {
        var o = Number(s);
        this.segmentRelations[o] || (this.segmentRelations[o] = {});
        var u = function() {
          var f = Number(l), h = i[o][f].map(function(v) {
            var m = rr(v, 2), p = m[0], y = m[1];
            return [p.clone(), y.clone()];
          }), d = a.segmentRelations[o][f] || [], g = h.filter(function(v) {
            var m = rr(v, 2), p = m[0], y = m[1];
            return !d.some(function(w) {
              var x = rr(w, 2), b = x[0], M = x[1];
              return p.isEqualTo(b) && y.isEqualTo(M) || p.isEqualTo(M) && y.isEqualTo(b);
            });
          });
          d.length > 0 ? (d.push.apply(d, Xt(g)), a.segmentRelations[o][f] = d) : a.segmentRelations[o][f] = g;
        };
        for (var l in i[o])
          u();
      }
    }
  }, {
    key: "mergeSegmentRelation",
    value: function(i, a, s, o) {
      this.assertWrite();
      var u = this.getSegmentRelation(i, a);
      if (!(!u || u.length === 0)) {
        var l = s.clone(), c = o.clone(), f = Dx(u, [l, c]);
        this.segmentRelations[i] || (this.segmentRelations[i] = {}), this.segmentRelations[i][a] = f;
      }
    }
  }, {
    key: "clearSegmentRelation",
    value: function(i, a) {
      this.assertWrite(), this.segmentRelations[i] && (a !== void 0 ? this.segmentRelations[i][a] && delete this.segmentRelations[i][a] : delete this.segmentRelations[i]);
    }
  }, {
    key: "elementOffsets",
    get: function() {
      var i, a = this, s = (((i = this.currentStyle) === null || i === void 0 ? void 0 : i.elements) || []).map(function(f) {
        return f.offset * a.scale;
      });
      if (s.length > 0) {
        for (var o = [], u = Xt(s).sort(function(f, h) {
          return h - f;
        }), l = 0, c = u.length - 1; l <= c; ) {
          if (l === c) {
            o.push(u[l]);
            break;
          }
          o.push(u[l++]), o.push(u[c--]);
        }
        return o;
      }
      return s;
    }
  }, {
    key: "create",
    value: function(i) {
      return new r(i);
    }
  }, {
    key: "getTypeName",
    value: function() {
      return "McDbMLine";
    }
  }, {
    key: "dwgInFields",
    value: function(i) {
      this.vertices = i.readPoints("vertices").val, this.styleName = i.readString("styleName").val, this.justification = i.readLong("justification").val, this.scale = i.readDouble("scale").val;
      try {
        var a = i.readLong("isClosed").val;
        this.isClosed = a === 1;
      } catch (s) {
        this.isClosed = !1;
      }
      return !0;
    }
  }, {
    key: "dwgOutFields",
    value: function(i) {
      return i.writePoints("vertices", this.vertices), i.writeString("styleName", this.styleName), i.writeLong("justification", this.justification), i.writeDouble("scale", this.scale), i.writeLong("isClosed", this.isClosed ? 1 : 0), !0;
    }
  }, {
    key: "moveGripPointsAt",
    value: function(i, a, s, o) {
      if (this.assertWrite(), i >= 0 && i < this.vertices.length) {
        var u = this.vertices[i].clone();
        this.vertices[i].x += a, this.vertices[i].y += s, this.vertices[i].z += o, this.handleSegmentRelationsAfterMove(i, u);
      }
    }
  }, {
    key: "handleSegmentRelationsAfterMove",
    value: function(i, a) {
      if (i > 0) {
        var s = i - 1;
        if (this.segmentRelations[s]) {
          var o = this.vertices[s], u = a.sub(o).normalize(), l = this.vertices[i].sub(o).normalize();
          u.isEqualTo(l) || this.clearSegmentRelation(s);
        }
      }
      if (i < this.vertices.length - 1) {
        var c = i;
        if (this.segmentRelations[c]) {
          var f = this.vertices[i + 1], h = f.sub(a).normalize(), d = f.sub(this.vertices[i]).normalize();
          h.isEqualTo(d) || this.clearSegmentRelation(c);
        }
      }
    }
  }, {
    key: "getGripPoints",
    value: function() {
      var i = new Xr();
      return this.vertices.forEach(function(a) {
        i.append(a);
      }), i;
    }
  }, {
    key: "worldDraw",
    value: function(i) {
      var a, s, o = this;
      if (!(this.vertices.length < 2) && this.styleName.length !== 0 && (this.currentStyle = kx(i.getDatabase(), this.styleName), this.styleName === Dh && !this.currentStyle && (this.currentStyle = this.getDefaultStyle()), !!this.currentStyle)) {
        (a = this.currentStyle) === null || a === void 0 || a.elements.sort(function(d, g) {
          return g.offset - d.offset;
        });
        for (var u = [], l = ((s = this.currentStyle) === null || s === void 0 ? void 0 : s.elements) || [], c = 0, f = l.length - 1; c <= f; ) {
          if (c === f && this.currentStyle) {
            u.push(this.currentStyle.elements[c]);
            break;
          }
          u.push(l[c++]), u.push(l[f--]);
        }
        this.currentStyle.elements = u;
        var h = this.elementOffsets.map(function(d) {
          return o.getOffsetPolylinePoints(d);
        });
        this.isClosed || (this.drawCaps(i, h, this.currentStyle.startCaps, !0), this.drawCaps(i, h, this.currentStyle.endCaps, !1)), this.drawMlines(i, h), this.currentStyle.displayJoints && this.drawJoints(i, h), this.currentStyle.fill.enabled && this.drawFill(i, h);
      }
    }
  }, {
    key: "getSegmentByPoint",
    value: function(i) {
      var a, s = this;
      if (this.vertices.length < 2 || !this.currentStyle && (this.styleName === Dh && (this.currentStyle = this.getDefaultStyle()), !this.currentStyle))
        return null;
      this.currentStyle.elements.sort(function(_, L) {
        return L.offset - _.offset;
      });
      for (var o = [], u = ((a = this.currentStyle) === null || a === void 0 ? void 0 : a.elements) || [], l = 0, c = u.length - 1; l <= c; ) {
        if (l === c && this.currentStyle) {
          o.push(this.currentStyle.elements[l]);
          break;
        }
        o.push(u[l++]), o.push(u[c--]);
      }
      this.currentStyle.elements = o;
      for (var f = this.elementOffsets.map(function(_) {
        return s.getOffsetPolylinePoints(_);
      }), h = -1, d = -1, g = null, v = Number.MAX_VALUE, m = 0; m < f.length; m++)
        for (var p = f[m], y = 0; y < p.length - 1; y++) {
          var w = p[y], x = p[y + 1];
          if (!(!w || !x)) {
            var b = new st(w, x), M = b.getClosestPointTo(i, !1);
            if (M && M.ret) {
              var k = M.val, E = k.distanceTo(i);
              if (E < v) {
                var S = k.distanceTo(w), F = k.distanceTo(x), O = w.distanceTo(x);
                Math.abs(S + F - O) < 1e-3 && (v = E, h = y, d = m, g = k.clone());
              }
            }
          }
        }
      if (h >= 0 && d >= 0 && g) {
        var D = f.map(function(_) {
          return h < _.length - 1 ? [_[h], _[h + 1]] : [];
        });
        return {
          segmentIndex: h,
          elementIndex: d,
          clickPoint: g,
          allOffsetLines: D
        };
      }
      return null;
    }
  }, {
    key: "getSegmentByIndex",
    value: function(i) {
      var a, s = this;
      if (this.vertices.length < 2 || i < 0 || i >= this.vertices.length - 1 || !this.currentStyle && (this.styleName === Dh && (this.currentStyle = this.getDefaultStyle()), !this.currentStyle))
        return null;
      this.currentStyle.elements.sort(function(p, y) {
        return y.offset - p.offset;
      });
      for (var o = [], u = ((a = this.currentStyle) === null || a === void 0 ? void 0 : a.elements) || [], l = 0, c = u.length - 1; l <= c; ) {
        if (l === c && this.currentStyle) {
          o.push(this.currentStyle.elements[l]);
          break;
        }
        o.push(u[l++]), o.push(u[c--]);
      }
      this.currentStyle.elements = o;
      var f = this.elementOffsets.map(function(p) {
        return s.getOffsetPolylinePoints(p);
      }), h = 0, d = this.vertices[i], g = this.vertices[i + 1], v = new te((d.x + g.x) / 2, (d.y + g.y) / 2, (d.z + g.z) / 2), m = f.map(function(p) {
        return i < p.length - 1 ? [p[i], p[i + 1]] : [];
      });
      return {
        segmentIndex: i,
        elementIndex: h,
        clickPoint: v,
        allOffsetLines: m
      };
    }
  }, {
    key: "getOffsetPolylinePoints",
    value: function(i) {
      if (this.vertices.length < 2) return [];
      for (var a = this.calculateAlignedOffset(i), s = [], o = 0; o < this.vertices.length - 1; o++)
        this.vertices[o + 1] && s.push(new st(this.vertices[o], this.vertices[o + 1]));
      this.isClosed && this.vertices.length >= 2 && s.push(new st(this.vertices[this.vertices.length - 1], this.vertices[0]));
      for (var u = [], l = 0; l < s.length; l++) {
        var c = s[l], f = c.endPoint.sub(c.startPoint).normalize(), h = f.perpVector().normalize(), d = c.startPoint.clone().addvec(f.mult(c.startPoint.distanceTo(c.endPoint) / 2)), g = d.clone().addvec(h.mult(a)), v = Math.abs(a), m = c.offsetCurves(v, g);
        m.length() > 0 ? u.push(m.aryVal[0]) : u.push(c.clone());
      }
      var p = [];
      if (this.isClosed && u.length >= 3) {
        var y = u.length - 1, w = u[y].IntersectWith(u[0], Ie.Intersect.kExtendBoth), x;
        w.length() > 0 ? x = w.at(0) : x = new te((u[y].endPoint.x + u[0].startPoint.x) / 2, (u[y].endPoint.y + u[0].startPoint.y) / 2, (u[y].endPoint.z + u[0].startPoint.z) / 2), p.push(x);
        for (var b = 0; b < u.length - 1; b++) {
          var M = u[b].IntersectWith(u[b + 1], Ie.Intersect.kExtendBoth);
          M.length() > 0 ? p.push(M.at(0)) : p.push(u[b].endPoint);
        }
        p.push(x);
      } else {
        p.push(u[0].startPoint);
        for (var k = 0; k < u.length; k++) {
          var E = (k + 1) % u.length;
          if (k === u.length - 1 && !this.isClosed) {
            p.push(u[k].endPoint);
            break;
          }
          var S = u[k].IntersectWith(u[E], Ie.Intersect.kExtendBoth);
          if (S.length() > 0 ? p.push(S.at(0)) : p.push(u[k].endPoint), k === u.length - 1 && this.isClosed)
            break;
        }
      }
      return p;
    }
  }, {
    key: "calculateAlignedOffset",
    value: function(i) {
      if (!this.currentStyle || this.currentStyle.elements.length === 0) return i;
      var a = Math.max.apply(Math, Xt(this.elementOffsets)), s = Math.min.apply(Math, Xt(this.elementOffsets)), o = (a + s) / 2;
      switch (this.justification) {
        case -1:
          return i;
        case 0:
          return i - a;
        case 1:
          return i - o;
        case 2:
          return i - s;
        default:
          return i - o;
      }
    }
  }, {
    key: "drawMlines",
    value: function(i, a) {
      var s = this;
      !this.currentStyle || this.vertices.length < 2 || this.currentStyle.elements.forEach(function(o, u) {
        s.drawOffsetLine(i, a[u], o, u);
      });
    }
  }, {
    key: "drawOffsetLine",
    value: function(i, a, s, o) {
      var u = this;
      if (!(!a || a.length < 2)) {
        var l = mi(s.color);
        i.trueColor = l;
        for (var c = !1, f = 0; f < a.length - 1; f++) {
          var h = this.getSegmentRelation(f, o);
          if (h) {
            c = !0;
            break;
          }
        }
        if (!c) {
          var d = new ot();
          a.forEach(function(p) {
            return d.addVertexAt(p);
          }), this.isClosed && (d.isClosed = !0), i.drawEntity(d), i.drawOsnapEntity(d);
          return;
        }
        for (var g = function() {
          var y = a[m], w = a[m + 1], x = u.getSegmentRelation(m, o);
          if (x && x.length > 0) {
            x = Cx(x);
            var b = x.some(function(B) {
              var C = rr(B, 2), Z = C[0], W = C[1];
              return Z.isEqualTo(y) && W.isEqualTo(w) || Z.isEqualTo(w) && W.isEqualTo(y);
            });
            if (b)
              return 0;
            var M = w.sub(y), k = y.distanceTo(w);
            if (k < 1e-6) return 0;
            var E = [[0, 1]], S = 1e-10;
            x.forEach(function(B) {
              var C = rr(B, 2), Z = C[0], W = C[1], J = function(Ae) {
                var Ce = Ae.sub(y), Ee = Ce.dotProduct(M);
                return Ee / (k * k);
              }, Q = J(Z), j = J(W), q = Math.max(0, Math.min(Q, j)), ae = Math.min(1, Math.max(Q, j));
              if (ae - q > S)
                for (var pe = E.length - 1; pe >= 0; pe--) {
                  var $ = rr(E[pe], 2), se = $[0], ve = $[1];
                  q <= se && ae >= ve ? E.splice(pe, 1) : q > se && ae < ve ? E.splice(pe, 1, [se, q], [ae, ve]) : q <= se && ae > se && ae < ve ? E[pe] = [ae, ve] : q > se && q < ve && ae >= ve && (E[pe] = [se, q]);
                }
            });
            for (var F = function(C) {
              return new te(y.x + M.x * C, y.y + M.y * C, y.z + M.z * C);
            }, O = 0, D = E; O < D.length; O++) {
              var _ = rr(D[O], 2), L = _[0], G = _[1];
              if (G - L > S) {
                var V = F(L), H = F(G), U = new st(V, H);
                i.drawEntity(U), i.drawOsnapEntity(U);
              }
            }
          } else {
            var R = new st(y, w);
            i.drawEntity(R), i.drawOsnapEntity(R);
          }
        }, v, m = 0; m < a.length - 1; m++)
          v = g();
      }
    }
  }, {
    key: "drawFill",
    value: function(i, a) {
      if (!(!this.currentStyle || !this.currentStyle.fill.enabled || this.vertices.length < 2) && !(a.length < 2)) {
        var s = this.elementOffsets.indexOf(Math.max.apply(Math, Xt(this.elementOffsets))), o = this.elementOffsets.indexOf(Math.min.apply(Math, Xt(this.elementOffsets))), u = Xt(a[s]), l = Xt(a[o]).reverse(), c = new Xr();
        if (this.isClosed) {
          for (var f = 0; f < u.length - 1; f++)
            c.append(u[f]);
          for (var h = 0; h < l.length - 1; h++)
            c.append(l[h]);
          var d = c.at(0), g = c.at(c.length() - 1);
          d.isEqualTo(g) || c.append(d.clone());
        } else
          u.forEach(function(p) {
            return c.append(p);
          }), l.forEach(function(p) {
            return c.append(p);
          });
        var v = new McDbHatch();
        v.appendLoop(c);
        var m = mi(this.currentStyle.fill.color);
        v.trueColor = m, i.drawEntity(v);
      }
    }
  }, {
    key: "drawCaps",
    value: function(i, a, s, o) {
      var u = this;
      if (this.currentStyle) {
        var l = Math.max.apply(Math, Xt(this.elementOffsets)), c = Math.min.apply(Math, Xt(this.elementOffsets)), f = this.elementOffsets.indexOf(l), h = this.elementOffsets.indexOf(c), d, g;
        if (o) {
          var v;
          d = a[f][0], g = a[h][0], a.forEach(function(R) {
            var B;
            if (typeof ((B = u.currentStyle) === null || B === void 0 ? void 0 : B.startCaps.angle) == "number") {
              var C = R[0], Z = R[1], W = new st(d, g), J = d;
              if (u.justification === -1) {
                var Q = u.elementOffsets.findIndex(function(q) {
                  return Math.abs(q) < 1e-4;
                });
                Q >= 0 && a[Q] ? J = a[Q][0] : J = W.getPointAtParam(0.5).val;
              } else u.justification === 0 ? J = d : u.justification === 2 ? J = g : u.justification === 1 && (J = W.getPointAtParam(0.5).val);
              W.rotate(J, THREE.MathUtils.degToRad(u.currentStyle.startCaps.angle - 90));
              var j = W.IntersectWith(new st(C, Z), Ie.Intersect.kExtendBoth);
              j.length() > 0 && (R[0] = j.at(0));
            }
          }), typeof ((v = this.currentStyle) === null || v === void 0 ? void 0 : v.startCaps.angle) == "number" && (d = a[f][0], g = a[h][0]);
        } else {
          var m, p = a[f].length - 1, y = a[h].length - 1;
          d = a[f][p], g = a[h][y], a.forEach(function(R) {
            var B;
            if (typeof ((B = u.currentStyle) === null || B === void 0 ? void 0 : B.endCaps.angle) == "number") {
              var C = R[R.length - 2], Z = R[R.length - 1], W = new st(d, g), J = d;
              if (u.justification === -1) {
                var Q = u.elementOffsets.findIndex(function(q) {
                  return Math.abs(q) < 1e-4;
                });
                Q >= 0 && a[Q] ? J = a[Q][a[Q].length - 1] : J = W.getPointAtParam(0.5).val;
              } else u.justification === 0 ? J = d : u.justification === 2 ? J = g : u.justification === 1 && (J = W.getPointAtParam(0.5).val);
              W.rotate(J, THREE.MathUtils.degToRad(u.currentStyle.endCaps.angle - 90));
              var j = W.IntersectWith(new st(C, Z), Ie.Intersect.kExtendBoth);
              j.length() > 0 && (R[R.length - 1] = j.at(0));
            }
          }), typeof ((m = this.currentStyle) === null || m === void 0 ? void 0 : m.endCaps.angle) == "number" && (d = a[f][p], g = a[h][y]);
        }
        var w = new te((d.x + g.x) / 2, (d.y + g.y) / 2, 0), x = d.sub(w).normalize().perpVector(), b = w.distanceTo(d);
        if (s.line) {
          var M = mi(this.currentStyle.elements[f].color), k = mi(this.currentStyle.elements[h].color);
          i.trueColor = M;
          var E = new st(d, w);
          i.drawEntity(E);
          var S = new st(g, w);
          i.trueColor = k, i.drawEntity(S);
        }
        if (s.outerArc) {
          var F = mi(this.currentStyle.elements[f].color), O = mi(this.currentStyle.elements[h].color);
          this.drawCapArc(i, d, w.clone().addvec(o ? x.clone().mult(b) : x.clone().negate().mult(b)), g, o ? F : O);
        }
        if (s.innerArc) {
          var D = this.elementOffsets.map(function(R, B) {
            var C;
            return {
              offset: R,
              index: B,
              color: (C = u.currentStyle) === null || C === void 0 ? void 0 : C.elements[B].color
            };
          }), _ = Xt(D).sort(function(R, B) {
            return B.offset - R.offset;
          })[0], L = Xt(D).sort(function(R, B) {
            return R.offset - B.offset;
          })[0], G = [_.index, L.index], V = D.filter(function(R) {
            return !G.includes(R.index);
          });
          if (V.sort(function(R, B) {
            return R.offset - B.offset;
          }), V.length > 0)
            for (var H = Xt(V), U = function() {
              var B = H.reduce(function(se, ve) {
                return ve.offset > se.offset ? ve : se;
              }, H[0]), C = H.reduce(function(se, ve) {
                return ve.offset < se.offset ? ve : se;
              }, H[0]), Z = o ? a[B.index][0] : a[B.index][a[B.index].length - 1], W = o ? a[C.index][0] : a[C.index][a[C.index].length - 1], J = new te((Z.x + W.x) / 2, (Z.y + W.y) / 2, 0), Q = Z.distanceTo(W) / 2, j = W.sub(J).normalize(), q = j.perpVector().normalize(), ae = J.clone().addvec(o ? q.negate().mult(Q) : q.mult(Q)), pe = mi(u.currentStyle.elements[B.index].color), $ = mi(u.currentStyle.elements[C.index].color);
              u.drawCapArc(i, Z, ae, W, o ? pe : $), H = H.filter(function(se) {
                return se.index !== B.index && se.index !== C.index;
              });
            }; H.length > 1; )
              U();
        }
      }
    }
  }, {
    key: "drawCapArc",
    value: function(i, a, s, o, u) {
      var l = new Di();
      l.computeArc(a.x, a.y, s.x, s.y, o.x, o.y), i.trueColor = u, i.drawEntity(l);
    }
  }, {
    key: "getDefaultStyle",
    value: function() {
      return {
        name: "STANDARD",
        description: "",
        elements: [{
          offset: 0.5,
          color: 256,
          lineType: "ByLayer"
        }, {
          offset: 0,
          color: 256,
          lineType: "ByLayer"
        }],
        startCaps: {
          line: !1,
          outerArc: !1,
          innerArc: !1,
          angle: 90
        },
        endCaps: {
          line: !1,
          outerArc: !1,
          innerArc: !1,
          angle: 90
        },
        fill: {
          enabled: !1,
          color: 256
        },
        displayJoints: !1
      };
    }
  }, {
    key: "setStyleName",
    value: function(i) {
      this.assertWrite(), this.styleName = i;
    }
  }, {
    key: "getStyleName",
    value: function() {
      return this.styleName;
    }
  }, {
    key: "setJustification",
    value: function(i) {
      this.assertWrite(), i >= -1 && i <= 2 && (this.justification = i);
    }
  }, {
    key: "getJustification",
    value: function() {
      return this.justification;
    }
  }, {
    key: "setScale",
    value: function(i) {
      this.assertWrite(), i > 0 && (this.scale = i);
    }
  }, {
    key: "getScale",
    value: function() {
      return this.scale;
    }
  }, {
    key: "addVertex",
    value: function(i) {
      this.assertWrite(), this.vertices.push(i.clone());
    }
  }, {
    key: "insertVertexAt",
    value: function(i, a) {
      return this.assertWrite(), i < 0 || i > this.vertices.length ? !1 : (this.vertices.splice(i, 0, a.clone()), !0);
    }
  }, {
    key: "getVertices",
    value: function() {
      return this.vertices;
    }
  }, {
    key: "getVertexCount",
    value: function() {
      return this.vertices.length;
    }
  }, {
    key: "getVertexAt",
    value: function(i) {
      return i >= 0 && i < this.vertices.length ? this.vertices[i].clone() : null;
    }
  }, {
    key: "setVertexAt",
    value: function(i, a) {
      this.assertWrite(), i >= 0 && i < this.vertices.length && (this.vertices[i] = a.clone());
    }
  }, {
    key: "removeVertexAt",
    value: function(i) {
      this.assertWrite(), i >= 0 && i < this.vertices.length && this.vertices.splice(i, 1);
    }
  }, {
    key: "clearVertices",
    value: function() {
      this.assertWrite(), this.vertices = [];
    }
  }, {
    key: "drawJoints",
    value: function(i, a) {
      if (!(!this.currentStyle || this.vertices.length < 3) && !(a.length < 2)) {
        for (var s = 0; s < a.length; s++)
          if (!a[s] || a[s].length < this.vertices.length)
            return;
        var o = this.elementOffsets.indexOf(Math.max.apply(Math, Xt(this.elementOffsets))), u = this.elementOffsets.indexOf(Math.min.apply(Math, Xt(this.elementOffsets)));
        if (a.length === 2 && o === u) {
          for (var l = 0, c = 1, f = 1; f < this.vertices.length - 1; f++) {
            var h = a[l][f], d = a[c][f];
            if (h && d) {
              var g = new st(h, d), v = mi(this.currentStyle.elements[l].color);
              i.trueColor = v, i.drawEntity(g);
            }
          }
          return;
        }
        for (var m = 1; m < this.vertices.length - 1; m++) {
          for (var p = 0, y = 0, w = 0, x = [], b = 0; b < a.length; b++)
            if (b < a.length && m < a[b].length) {
              var M = a[b][m];
              M && (p += M.x, y += M.y, w++, x.push({
                pt: M,
                index: b
              }));
            }
          if (w !== 0)
            for (var k = new te(p / w, y / w, 0), E = 0, S = x; E < S.length; E++) {
              var F = S[E], O = F.pt, D = F.index, _ = mi(this.currentStyle.elements[D].color);
              i.trueColor = _;
              var L = new st(k, O);
              i.drawEntity(L);
            }
        }
      }
    }
  }, {
    key: "setIsClosed",
    value: function(i) {
      this.assertWrite(), this.isClosed = i;
    }
  }, {
    key: "getIsClosed",
    value: function() {
      return this.isClosed;
    }
  }]), r;
}(dl), kd = function() {
  return kd = Object.assign || function(t) {
    for (var r, n = 1, i = arguments.length; n < i; n++) {
      r = arguments[n];
      for (var a in r) Object.prototype.hasOwnProperty.call(r, a) && (t[a] = r[a]);
    }
    return t;
  }, kd.apply(this, arguments);
};
function Oi(e, t, r, n) {
  function i(a) {
    return a instanceof r ? a : new r(function(s) {
      s(a);
    });
  }
  return new (r || (r = Promise))(function(a, s) {
    function o(c) {
      try {
        l(n.next(c));
      } catch (f) {
        s(f);
      }
    }
    function u(c) {
      try {
        l(n.throw(c));
      } catch (f) {
        s(f);
      }
    }
    function l(c) {
      c.done ? a(c.value) : i(c.value).then(o, u);
    }
    l((n = n.apply(e, [])).next());
  });
}
function Ni(e, t) {
  var r = { label: 0, sent: function() {
    if (a[0] & 1) throw a[1];
    return a[1];
  }, trys: [], ops: [] }, n, i, a, s;
  return s = { next: o(0), throw: o(1), return: o(2) }, typeof Symbol == "function" && (s[Symbol.iterator] = function() {
    return this;
  }), s;
  function o(l) {
    return function(c) {
      return u([l, c]);
    };
  }
  function u(l) {
    if (n) throw new TypeError("Generator is already executing.");
    for (; s && (s = 0, l[0] && (r = 0)), r; ) try {
      if (n = 1, i && (a = l[0] & 2 ? i.return : l[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, l[1])).done) return a;
      switch (i = 0, a && (l = [l[0] & 2, a.value]), l[0]) {
        case 0:
        case 1:
          a = l;
          break;
        case 4:
          return r.label++, { value: l[1], done: !1 };
        case 5:
          r.label++, i = l[1], l = [0];
          continue;
        case 7:
          l = r.ops.pop(), r.trys.pop();
          continue;
        default:
          if (a = r.trys, !(a = a.length > 0 && a[a.length - 1]) && (l[0] === 6 || l[0] === 2)) {
            r = 0;
            continue;
          }
          if (l[0] === 3 && (!a || l[1] > a[0] && l[1] < a[3])) {
            r.label = l[1];
            break;
          }
          if (l[0] === 6 && r.label < a[1]) {
            r.label = a[1], a = l;
            break;
          }
          if (a && r.label < a[2]) {
            r.label = a[2], r.ops.push(l);
            break;
          }
          a[2] && r.ops.pop(), r.trys.pop();
          continue;
      }
      l = t.call(e, r);
    } catch (c) {
      l = [6, c], i = 0;
    } finally {
      n = a = 0;
    }
    if (l[0] & 5) throw l[1];
    return { value: l[0] ? l[1] : void 0, done: !0 };
  }
}
function M1(e, t, r) {
  for (var n = 0, i = t.length, a; n < i; n++)
    (a || !(n in t)) && (a || (a = Array.prototype.slice.call(t, 0, n)), a[n] = t[n]);
  return e.concat(a || Array.prototype.slice.call(t));
}
var E1 = "4.5.0";
function Yc(e, t) {
  return new Promise(function(r) {
    return setTimeout(r, e, t);
  });
}
function _x() {
  return new Promise(function(e) {
    var t = new MessageChannel();
    t.port1.onmessage = function() {
      return e();
    }, t.port2.postMessage(null);
  });
}
function Px(e, t) {
  t === void 0 && (t = 1 / 0);
  var r = window.requestIdleCallback;
  return r ? new Promise(function(n) {
    return r.call(window, function() {
      return n();
    }, { timeout: t });
  }) : Yc(Math.min(e, t));
}
function A1(e) {
  return !!e && typeof e.then == "function";
}
function Mm(e, t) {
  try {
    var r = e();
    A1(r) ? r.then(function(n) {
      return t(!0, n);
    }, function(n) {
      return t(!1, n);
    }) : t(!0, r);
  } catch (n) {
    t(!1, n);
  }
}
function Em(e, t, r) {
  return r === void 0 && (r = 16), Oi(this, void 0, void 0, function() {
    var n, i, a, s;
    return Ni(this, function(o) {
      switch (o.label) {
        case 0:
          n = Array(e.length), i = Date.now(), a = 0, o.label = 1;
        case 1:
          return a < e.length ? (n[a] = t(e[a], a), s = Date.now(), s >= i + r ? (i = s, [4, _x()]) : [3, 3]) : [3, 4];
        case 2:
          o.sent(), o.label = 3;
        case 3:
          return ++a, [3, 1];
        case 4:
          return [2, n];
      }
    });
  });
}
function Cu(e) {
  return e.then(void 0, function() {
  }), e;
}
function Bx(e, t) {
  for (var r = 0, n = e.length; r < n; ++r)
    if (e[r] === t)
      return !0;
  return !1;
}
function Lx(e, t) {
  return !Bx(e, t);
}
function qv(e) {
  return parseInt(e);
}
function si(e) {
  return parseFloat(e);
}
function $i(e, t) {
  return typeof e == "number" && isNaN(e) ? t : e;
}
function _n(e) {
  return e.reduce(function(t, r) {
    return t + (r ? 1 : 0);
  }, 0);
}
function T1(e, t) {
  if (t === void 0 && (t = 1), Math.abs(t) >= 1)
    return Math.round(e / t) * t;
  var r = 1 / t;
  return Math.round(e * r) / r;
}
function Fx(e) {
  for (var t, r, n = "Unexpected syntax '".concat(e, "'"), i = /^\s*([a-z-]*)(.*)$/i.exec(e), a = i[1] || void 0, s = {}, o = /([.:#][\w-]+|\[.+?\])/gi, u = function(h, d) {
    s[h] = s[h] || [], s[h].push(d);
  }; ; ) {
    var l = o.exec(i[2]);
    if (!l)
      break;
    var c = l[0];
    switch (c[0]) {
      case ".":
        u("class", c.slice(1));
        break;
      case "#":
        u("id", c.slice(1));
        break;
      case "[": {
        var f = /^\[([\w-]+)([~|^$*]?=("(.*?)"|([\w-]+)))?(\s+[is])?\]$/.exec(c);
        if (f)
          u(f[1], (r = (t = f[4]) !== null && t !== void 0 ? t : f[5]) !== null && r !== void 0 ? r : "");
        else
          throw new Error(n);
        break;
      }
      default:
        throw new Error(n);
    }
  }
  return [a, s];
}
function Ix(e) {
  for (var t = new Uint8Array(e.length), r = 0; r < e.length; r++) {
    var n = e.charCodeAt(r);
    if (n > 127)
      return new TextEncoder().encode(e);
    t[r] = n;
  }
  return t;
}
function ga(e, t) {
  var r = e[0] >>> 16, n = e[0] & 65535, i = e[1] >>> 16, a = e[1] & 65535, s = t[0] >>> 16, o = t[0] & 65535, u = t[1] >>> 16, l = t[1] & 65535, c = 0, f = 0, h = 0, d = 0;
  d += a + l, h += d >>> 16, d &= 65535, h += i + u, f += h >>> 16, h &= 65535, f += n + o, c += f >>> 16, f &= 65535, c += r + s, c &= 65535, e[0] = c << 16 | f, e[1] = h << 16 | d;
}
function Un(e, t) {
  var r = e[0] >>> 16, n = e[0] & 65535, i = e[1] >>> 16, a = e[1] & 65535, s = t[0] >>> 16, o = t[0] & 65535, u = t[1] >>> 16, l = t[1] & 65535, c = 0, f = 0, h = 0, d = 0;
  d += a * l, h += d >>> 16, d &= 65535, h += i * l, f += h >>> 16, h &= 65535, h += a * u, f += h >>> 16, h &= 65535, f += n * l, c += f >>> 16, f &= 65535, f += i * u, c += f >>> 16, f &= 65535, f += a * o, c += f >>> 16, f &= 65535, c += r * l + n * u + i * o + a * s, c &= 65535, e[0] = c << 16 | f, e[1] = h << 16 | d;
}
function Is(e, t) {
  var r = e[0];
  t %= 64, t === 32 ? (e[0] = e[1], e[1] = r) : t < 32 ? (e[0] = r << t | e[1] >>> 32 - t, e[1] = e[1] << t | r >>> 32 - t) : (t -= 32, e[0] = e[1] << t | r >>> 32 - t, e[1] = r << t | e[1] >>> 32 - t);
}
function kn(e, t) {
  t %= 64, t !== 0 && (t < 32 ? (e[0] = e[1] >>> 32 - t, e[1] = e[1] << t) : (e[0] = e[1] << t - 32, e[1] = 0));
}
function wr(e, t) {
  e[0] ^= t[0], e[1] ^= t[1];
}
var Rx = [4283543511, 3981806797], Ox = [3301882366, 444984403];
function Am(e) {
  var t = [0, e[0] >>> 1];
  wr(e, t), Un(e, Rx), t[1] = e[0] >>> 1, wr(e, t), Un(e, Ox), t[1] = e[0] >>> 1, wr(e, t);
}
var Pl = [2277735313, 289559509], Bl = [1291169091, 658871167], Tm = [0, 5], Nx = [0, 1390208809], Ux = [0, 944331445];
function Gx(e, t) {
  var r = Ix(e);
  t = t || 0;
  var n = [0, r.length], i = n[1] % 16, a = n[1] - i, s = [0, t], o = [0, t], u = [0, 0], l = [0, 0], c;
  for (c = 0; c < a; c = c + 16)
    u[0] = r[c + 4] | r[c + 5] << 8 | r[c + 6] << 16 | r[c + 7] << 24, u[1] = r[c] | r[c + 1] << 8 | r[c + 2] << 16 | r[c + 3] << 24, l[0] = r[c + 12] | r[c + 13] << 8 | r[c + 14] << 16 | r[c + 15] << 24, l[1] = r[c + 8] | r[c + 9] << 8 | r[c + 10] << 16 | r[c + 11] << 24, Un(u, Pl), Is(u, 31), Un(u, Bl), wr(s, u), Is(s, 27), ga(s, o), Un(s, Tm), ga(s, Nx), Un(l, Bl), Is(l, 33), Un(l, Pl), wr(o, l), Is(o, 31), ga(o, s), Un(o, Tm), ga(o, Ux);
  u[0] = 0, u[1] = 0, l[0] = 0, l[1] = 0;
  var f = [0, 0];
  switch (i) {
    case 15:
      f[1] = r[c + 14], kn(f, 48), wr(l, f);
    case 14:
      f[1] = r[c + 13], kn(f, 40), wr(l, f);
    case 13:
      f[1] = r[c + 12], kn(f, 32), wr(l, f);
    case 12:
      f[1] = r[c + 11], kn(f, 24), wr(l, f);
    case 11:
      f[1] = r[c + 10], kn(f, 16), wr(l, f);
    case 10:
      f[1] = r[c + 9], kn(f, 8), wr(l, f);
    case 9:
      f[1] = r[c + 8], wr(l, f), Un(l, Bl), Is(l, 33), Un(l, Pl), wr(o, l);
    case 8:
      f[1] = r[c + 7], kn(f, 56), wr(u, f);
    case 7:
      f[1] = r[c + 6], kn(f, 48), wr(u, f);
    case 6:
      f[1] = r[c + 5], kn(f, 40), wr(u, f);
    case 5:
      f[1] = r[c + 4], kn(f, 32), wr(u, f);
    case 4:
      f[1] = r[c + 3], kn(f, 24), wr(u, f);
    case 3:
      f[1] = r[c + 2], kn(f, 16), wr(u, f);
    case 2:
      f[1] = r[c + 1], kn(f, 8), wr(u, f);
    case 1:
      f[1] = r[c], wr(u, f), Un(u, Pl), Is(u, 31), Un(u, Bl), wr(s, u);
  }
  return wr(s, n), wr(o, n), ga(s, o), ga(o, s), Am(s), Am(o), ga(s, o), ga(o, s), ("00000000" + (s[0] >>> 0).toString(16)).slice(-8) + ("00000000" + (s[1] >>> 0).toString(16)).slice(-8) + ("00000000" + (o[0] >>> 0).toString(16)).slice(-8) + ("00000000" + (o[1] >>> 0).toString(16)).slice(-8);
}
function zx(e) {
  var t;
  return kd({ name: e.name, message: e.message, stack: (t = e.stack) === null || t === void 0 ? void 0 : t.split(`
`) }, e);
}
function Wx(e) {
  return /^function\s.*?\{\s*\[native code]\s*}$/.test(String(e));
}
function Vx(e) {
  return typeof e != "function";
}
function Hx(e, t) {
  var r = Cu(new Promise(function(n) {
    var i = Date.now();
    Mm(e.bind(null, t), function() {
      for (var a = [], s = 0; s < arguments.length; s++)
        a[s] = arguments[s];
      var o = Date.now() - i;
      if (!a[0])
        return n(function() {
          return { error: a[1], duration: o };
        });
      var u = a[1];
      if (Vx(u))
        return n(function() {
          return { value: u, duration: o };
        });
      n(function() {
        return new Promise(function(l) {
          var c = Date.now();
          Mm(u, function() {
            for (var f = [], h = 0; h < arguments.length; h++)
              f[h] = arguments[h];
            var d = o + Date.now() - c;
            if (!f[0])
              return l({ error: f[1], duration: d });
            l({ value: f[1], duration: d });
          });
        });
      });
    });
  }));
  return function() {
    return r.then(function(i) {
      return i();
    });
  };
}
function jx(e, t, r, n) {
  var i = Object.keys(e).filter(function(s) {
    return Lx(r, s);
  }), a = Cu(Em(i, function(s) {
    return Hx(e[s], t);
  }, n));
  return function() {
    return Oi(this, void 0, void 0, function() {
      var o, u, l, c, f;
      return Ni(this, function(h) {
        switch (h.label) {
          case 0:
            return [4, a];
          case 1:
            return o = h.sent(), [4, Em(o, function(d) {
              return Cu(d());
            }, n)];
          case 2:
            return u = h.sent(), [
              4,
              Promise.all(u)
              // Keeping the component keys order the same as the source keys order
            ];
          case 3:
            for (l = h.sent(), c = {}, f = 0; f < i.length; ++f)
              c[i[f]] = l[f];
            return [2, c];
        }
      });
    });
  };
}
function S1() {
  var e = window, t = navigator;
  return _n([
    "MSCSSMatrix" in e,
    "msSetImmediate" in e,
    "msIndexedDB" in e,
    "msMaxTouchPoints" in t,
    "msPointerEnabled" in t
  ]) >= 4;
}
function Xx() {
  var e = window, t = navigator;
  return _n(["msWriteProfilerMark" in e, "MSStream" in e, "msLaunchUri" in t, "msSaveBlob" in t]) >= 3 && !S1();
}
function Qf() {
  var e = window, t = navigator;
  return _n([
    "webkitPersistentStorage" in t,
    "webkitTemporaryStorage" in t,
    t.vendor.indexOf("Google") === 0,
    "webkitResolveLocalFileSystemURL" in e,
    "BatteryManager" in e,
    "webkitMediaStream" in e,
    "webkitSpeechGrammar" in e
  ]) >= 5;
}
function hi() {
  var e = window, t = navigator;
  return _n([
    "ApplePayError" in e,
    "CSSPrimitiveValue" in e,
    "Counter" in e,
    t.vendor.indexOf("Apple") === 0,
    "RGBColor" in e,
    "WebKitMediaKeys" in e
  ]) >= 4;
}
function $v() {
  var e = window, t = e.HTMLElement, r = e.Document;
  return _n([
    "safari" in e,
    !("ongestureend" in e),
    !("TouchEvent" in e),
    !("orientation" in e),
    t && !("autocapitalize" in t.prototype),
    r && "pointerLockElement" in r.prototype
  ]) >= 4;
}
function vl() {
  var e = window;
  return (
    // Filters-out Chrome, Yandex, DuckDuckGo (macOS and iOS), Edge
    Wx(e.print) && // Doesn't work in Safari < 15.4
    String(e.browser) === "[object WebPageNamespace]"
  );
}
function k1() {
  var e, t, r = window;
  return _n([
    "buildID" in navigator,
    "MozAppearance" in ((t = (e = document.documentElement) === null || e === void 0 ? void 0 : e.style) !== null && t !== void 0 ? t : {}),
    "onmozfullscreenchange" in r,
    "mozInnerScreenX" in r,
    "CSSMozDocumentRule" in r,
    "CanvasCaptureMediaStream" in r
  ]) >= 4;
}
function qx() {
  var e = window;
  return _n([
    !("MediaSettingsRange" in e),
    "RTCEncodedAudioFrame" in e,
    "" + e.Intl == "[object Intl]",
    "" + e.Reflect == "[object Reflect]"
  ]) >= 3;
}
function $x() {
  var e = window;
  return _n([
    "DOMRectList" in e,
    "RTCPeerConnectionIceEvent" in e,
    "SVGGeometryElement" in e,
    "ontransitioncancel" in e
  ]) >= 3;
}
function ml() {
  var e = window, t = navigator, r = e.CSS, n = e.HTMLButtonElement;
  return _n([
    !("getStorageUpdates" in t),
    n && "popover" in n.prototype,
    "CSSCounterStyleRule" in e,
    r.supports("font-size-adjust: ex-height 0.5"),
    r.supports("text-transform: full-width")
  ]) >= 4;
}
function Yx() {
  if (navigator.platform === "iPad")
    return !0;
  var e = screen, t = e.width / e.height;
  return _n([
    "MediaSource" in window,
    !!Element.prototype.webkitRequestFullscreen,
    // iPhone 4S that runs iOS 9 matches this, but it is not supported
    t > 0.65 && t < 1.53
  ]) >= 2;
}
function Kx() {
  var e = document;
  return e.fullscreenElement || e.msFullscreenElement || e.mozFullScreenElement || e.webkitFullscreenElement || null;
}
function Zx() {
  var e = document;
  return (e.exitFullscreen || e.msExitFullscreen || e.mozCancelFullScreen || e.webkitExitFullscreen).call(e);
}
function Yv() {
  var e = Qf(), t = k1(), r = window, n = navigator, i = "connection";
  return e ? _n([
    !("SharedWorker" in r),
    // `typechange` is deprecated, but it's still present on Android (tested on Chrome Mobile 117)
    // Removal proposal https://bugs.chromium.org/p/chromium/issues/detail?id=699892
    // Note: this expression returns true on ChromeOS, so additional detectors are required to avoid false-positives
    n[i] && "ontypechange" in n[i],
    !("sinkId" in new window.Audio())
  ]) >= 2 : t ? _n(["onorientationchange" in r, "orientation" in r, /android/i.test(navigator.appVersion)]) >= 2 : !1;
}
function Jx() {
  return tM() ? -4 : Qx();
}
function Qx() {
  var e = window, t = e.OfflineAudioContext || e.webkitOfflineAudioContext;
  if (!t)
    return -2;
  if (eM())
    return -1;
  var r = 4500, n = 5e3, i = new t(1, n, 44100), a = i.createOscillator();
  a.type = "triangle", a.frequency.value = 1e4;
  var s = i.createDynamicsCompressor();
  s.threshold.value = -50, s.knee.value = 40, s.ratio.value = 12, s.attack.value = 0, s.release.value = 0.25, a.connect(s), s.connect(i.destination), a.start(0);
  var o = rM(i), u = o[0], l = o[1], c = Cu(u.then(function(f) {
    return nM(f.getChannelData(0).subarray(r));
  }, function(f) {
    if (f.name === "timeout" || f.name === "suspended")
      return -3;
    throw f;
  }));
  return function() {
    return l(), c;
  };
}
function eM() {
  return hi() && !$v() && !$x();
}
function tM() {
  return hi() && ml() && vl();
}
function rM(e) {
  var t = 3, r = 500, n = 500, i = 5e3, a = function() {
  }, s = new Promise(function(o, u) {
    var l = !1, c = 0, f = 0;
    e.oncomplete = function(g) {
      return o(g.renderedBuffer);
    };
    var h = function() {
      setTimeout(function() {
        return u(Sm(
          "timeout"
          /* InnerErrorName.Timeout */
        ));
      }, Math.min(n, f + i - Date.now()));
    }, d = function() {
      try {
        var g = e.startRendering();
        switch (A1(g) && Cu(g), e.state) {
          case "running":
            f = Date.now(), l && h();
            break;
          case "suspended":
            document.hidden || c++, l && c >= t ? u(Sm(
              "suspended"
              /* InnerErrorName.Suspended */
            )) : setTimeout(d, r);
            break;
        }
      } catch (v) {
        u(v);
      }
    };
    d(), a = function() {
      l || (l = !0, f > 0 && h());
    };
  });
  return [s, a];
}
function nM(e) {
  for (var t = 0, r = 0; r < e.length; ++r)
    t += Math.abs(e[r]);
  return t;
}
function Sm(e) {
  var t = new Error(e);
  return t.name = e, t;
}
function C1(e, t, r) {
  var n, i, a;
  return r === void 0 && (r = 50), Oi(this, void 0, void 0, function() {
    var s, o;
    return Ni(this, function(u) {
      switch (u.label) {
        case 0:
          s = document, u.label = 1;
        case 1:
          return s.body ? [3, 3] : [4, Yc(r)];
        case 2:
          return u.sent(), [3, 1];
        case 3:
          o = s.createElement("iframe"), u.label = 4;
        case 4:
          return u.trys.push([4, , 10, 11]), [4, new Promise(function(l, c) {
            var f = !1, h = function() {
              f = !0, l();
            }, d = function(m) {
              f = !0, c(m);
            };
            o.onload = h, o.onerror = d;
            var g = o.style;
            g.setProperty("display", "block", "important"), g.position = "absolute", g.top = "0", g.left = "0", g.visibility = "hidden", t && "srcdoc" in o ? o.srcdoc = t : o.src = "about:blank", s.body.appendChild(o);
            var v = function() {
              var m, p;
              f || (((p = (m = o.contentWindow) === null || m === void 0 ? void 0 : m.document) === null || p === void 0 ? void 0 : p.readyState) === "complete" ? h() : setTimeout(v, 10));
            };
            v();
          })];
        case 5:
          u.sent(), u.label = 6;
        case 6:
          return !((i = (n = o.contentWindow) === null || n === void 0 ? void 0 : n.document) === null || i === void 0) && i.body ? [3, 8] : [4, Yc(r)];
        case 7:
          return u.sent(), [3, 6];
        case 8:
          return [4, e(o, o.contentWindow)];
        case 9:
          return [2, u.sent()];
        case 10:
          return (a = o.parentNode) === null || a === void 0 || a.removeChild(o), [
            7
            /*endfinally*/
          ];
        case 11:
          return [
            2
            /*return*/
          ];
      }
    });
  });
}
function iM(e) {
  for (var t = Fx(e), r = t[0], n = t[1], i = document.createElement(r != null ? r : "div"), a = 0, s = Object.keys(n); a < s.length; a++) {
    var o = s[a], u = n[o].join(" ");
    o === "style" ? aM(i.style, u) : i.setAttribute(o, u);
  }
  return i;
}
function aM(e, t) {
  for (var r = 0, n = t.split(";"); r < n.length; r++) {
    var i = n[r], a = /^\s*([\w-]+)\s*:\s*(.+?)(\s*!([\w-]+))?\s*$/.exec(i);
    if (a) {
      var s = a[1], o = a[2], u = a[4];
      e.setProperty(s, o, u || "");
    }
  }
}
function sM() {
  for (var e = window; ; ) {
    var t = e.parent;
    if (!t || t === e)
      return !1;
    try {
      if (t.location.origin !== e.location.origin)
        return !0;
    } catch (r) {
      if (r instanceof Error && r.name === "SecurityError")
        return !0;
      throw r;
    }
    e = t;
  }
}
var oM = "mmMwWLliI0O&1", uM = "48px", Rs = ["monospace", "sans-serif", "serif"], km = [
  // This is android-specific font from "Roboto" family
  "sans-serif-thin",
  "ARNO PRO",
  "Agency FB",
  "Arabic Typesetting",
  "Arial Unicode MS",
  "AvantGarde Bk BT",
  "BankGothic Md BT",
  "Batang",
  "Bitstream Vera Sans Mono",
  "Calibri",
  "Century",
  "Century Gothic",
  "Clarendon",
  "EUROSTILE",
  "Franklin Gothic",
  "Futura Bk BT",
  "Futura Md BT",
  "GOTHAM",
  "Gill Sans",
  "HELV",
  "Haettenschweiler",
  "Helvetica Neue",
  "Humanst521 BT",
  "Leelawadee",
  "Letter Gothic",
  "Levenim MT",
  "Lucida Bright",
  "Lucida Sans",
  "Menlo",
  "MS Mincho",
  "MS Outlook",
  "MS Reference Specialty",
  "MS UI Gothic",
  "MT Extra",
  "MYRIAD PRO",
  "Marlett",
  "Meiryo UI",
  "Microsoft Uighur",
  "Minion Pro",
  "Monotype Corsiva",
  "PMingLiU",
  "Pristina",
  "SCRIPTINA",
  "Segoe UI Light",
  "Serifa",
  "SimHei",
  "Small Fonts",
  "Staccato222 BT",
  "TRAJAN PRO",
  "Univers CE 55 Medium",
  "Vrinda",
  "ZWAdobeF"
];
function lM() {
  var e = this;
  return C1(function(t, r) {
    var n = r.document;
    return Oi(e, void 0, void 0, function() {
      var i, a, s, o, u, l, c, f, h, d, g, v;
      return Ni(this, function(m) {
        for (i = n.body, i.style.fontSize = uM, a = n.createElement("div"), a.style.setProperty("visibility", "hidden", "important"), s = {}, o = {}, u = function(p) {
          var y = n.createElement("span"), w = y.style;
          return w.position = "absolute", w.top = "0", w.left = "0", w.fontFamily = p, y.textContent = oM, a.appendChild(y), y;
        }, l = function(p, y) {
          return u("'".concat(p, "',").concat(y));
        }, c = function() {
          return Rs.map(u);
        }, f = function() {
          for (var p = {}, y = function(M) {
            p[M] = Rs.map(function(k) {
              return l(M, k);
            });
          }, w = 0, x = km; w < x.length; w++) {
            var b = x[w];
            y(b);
          }
          return p;
        }, h = function(p) {
          return Rs.some(function(y, w) {
            return p[w].offsetWidth !== s[y] || p[w].offsetHeight !== o[y];
          });
        }, d = c(), g = f(), i.appendChild(a), v = 0; v < Rs.length; v++)
          s[Rs[v]] = d[v].offsetWidth, o[Rs[v]] = d[v].offsetHeight;
        return [2, km.filter(function(p) {
          return h(g[p]);
        })];
      });
    });
  });
}
function cM() {
  var e = navigator.plugins;
  if (e) {
    for (var t = [], r = 0; r < e.length; ++r) {
      var n = e[r];
      if (n) {
        for (var i = [], a = 0; a < n.length; ++a) {
          var s = n[a];
          i.push({
            type: s.type,
            suffixes: s.suffixes
          });
        }
        t.push({
          name: n.name,
          description: n.description,
          mimeTypes: i
        });
      }
    }
    return t;
  }
}
function fM() {
  return hM(bM());
}
function hM(e) {
  var t, r = !1, n, i, a = dM(), s = a[0], o = a[1];
  return pM(s, o) ? (r = vM(o), e ? n = i = "skipped" : (t = mM(s, o), n = t[0], i = t[1])) : n = i = "unsupported", { winding: r, geometry: n, text: i };
}
function dM() {
  var e = document.createElement("canvas");
  return e.width = 1, e.height = 1, [e, e.getContext("2d")];
}
function pM(e, t) {
  return !!(t && e.toDataURL);
}
function vM(e) {
  return e.rect(0, 0, 10, 10), e.rect(2, 2, 6, 6), !e.isPointInPath(5, 5, "evenodd");
}
function mM(e, t) {
  gM(e, t);
  var r = _h(e), n = _h(e);
  if (r !== n)
    return [
      "unstable",
      "unstable"
      /* ImageStatus.Unstable */
    ];
  yM(e, t);
  var i = _h(e);
  return [i, r];
}
function gM(e, t) {
  e.width = 240, e.height = 60, t.textBaseline = "alphabetic", t.fillStyle = "#f60", t.fillRect(100, 1, 62, 20), t.fillStyle = "#069", t.font = '11pt "Times New Roman"';
  var r = "Cwm fjordbank gly ".concat(
    ""
    /*  */
  );
  t.fillText(r, 2, 15), t.fillStyle = "rgba(102, 204, 0, 0.2)", t.font = "18pt Arial", t.fillText(r, 4, 45);
}
function yM(e, t) {
  e.width = 122, e.height = 110, t.globalCompositeOperation = "multiply";
  for (var r = 0, n = [
    ["#f2f", 40, 40],
    ["#2ff", 80, 40],
    ["#ff2", 60, 80]
  ]; r < n.length; r++) {
    var i = n[r], a = i[0], s = i[1], o = i[2];
    t.fillStyle = a, t.beginPath(), t.arc(s, o, 40, 0, Math.PI * 2, !0), t.closePath(), t.fill();
  }
  t.fillStyle = "#f9c", t.arc(60, 60, 60, 0, Math.PI * 2, !0), t.arc(60, 60, 20, 0, Math.PI * 2, !0), t.fill("evenodd");
}
function _h(e) {
  return e.toDataURL();
}
function bM() {
  return hi() && ml() && vl();
}
function wM() {
  var e = navigator, t = 0, r;
  e.maxTouchPoints !== void 0 ? t = qv(e.maxTouchPoints) : e.msMaxTouchPoints !== void 0 && (t = e.msMaxTouchPoints);
  try {
    document.createEvent("TouchEvent"), r = !0;
  } catch (i) {
    r = !1;
  }
  var n = "ontouchstart" in window;
  return {
    maxTouchPoints: t,
    touchEvent: r,
    touchStart: n
  };
}
function xM() {
  return navigator.oscpu;
}
function MM() {
  var e = navigator, t = [], r = e.language || e.userLanguage || e.browserLanguage || e.systemLanguage;
  if (r !== void 0 && t.push([r]), Array.isArray(e.languages))
    Qf() && qx() || t.push(e.languages);
  else if (typeof e.languages == "string") {
    var n = e.languages;
    n && t.push(n.split(","));
  }
  return t;
}
function EM() {
  return window.screen.colorDepth;
}
function AM() {
  return $i(si(navigator.deviceMemory), void 0);
}
function TM() {
  if (!(hi() && ml() && vl()))
    return SM();
}
function SM() {
  var e = screen, t = function(n) {
    return $i(qv(n), null);
  }, r = [t(e.width), t(e.height)];
  return r.sort().reverse(), r;
}
var kM = 2500, CM = 10, wc, Ph;
function DM() {
  if (Ph === void 0) {
    var e = function() {
      var t = Cd();
      Dd(t) ? Ph = setTimeout(e, kM) : (wc = t, Ph = void 0);
    };
    e();
  }
}
function _M() {
  var e = this;
  return DM(), function() {
    return Oi(e, void 0, void 0, function() {
      var t;
      return Ni(this, function(r) {
        switch (r.label) {
          case 0:
            return t = Cd(), Dd(t) ? wc ? [2, M1([], wc)] : Kx() ? [4, Zx()] : [3, 2] : [3, 2];
          case 1:
            r.sent(), t = Cd(), r.label = 2;
          case 2:
            return Dd(t) || (wc = t), [2, t];
        }
      });
    });
  };
}
function PM() {
  var e = this;
  if (hi() && ml() && vl())
    return function() {
      return Promise.resolve(void 0);
    };
  var t = _M();
  return function() {
    return Oi(e, void 0, void 0, function() {
      var r, n;
      return Ni(this, function(i) {
        switch (i.label) {
          case 0:
            return [4, t()];
          case 1:
            return r = i.sent(), n = function(a) {
              return a === null ? null : T1(a, CM);
            }, [2, [n(r[0]), n(r[1]), n(r[2]), n(r[3])]];
        }
      });
    });
  };
}
function Cd() {
  var e = screen;
  return [
    $i(si(e.availTop), null),
    $i(si(e.width) - si(e.availWidth) - $i(si(e.availLeft), 0), null),
    $i(si(e.height) - si(e.availHeight) - $i(si(e.availTop), 0), null),
    $i(si(e.availLeft), null)
  ];
}
function Dd(e) {
  for (var t = 0; t < 4; ++t)
    if (e[t])
      return !1;
  return !0;
}
function BM() {
  return $i(qv(navigator.hardwareConcurrency), void 0);
}
function LM() {
  var e, t = (e = window.Intl) === null || e === void 0 ? void 0 : e.DateTimeFormat;
  if (t) {
    var r = new t().resolvedOptions().timeZone;
    if (r)
      return r;
  }
  var n = -FM();
  return "UTC".concat(n >= 0 ? "+" : "").concat(n);
}
function FM() {
  var e = (/* @__PURE__ */ new Date()).getFullYear();
  return Math.max(
    // `getTimezoneOffset` returns a number as a string in some unidentified cases
    si(new Date(e, 0, 1).getTimezoneOffset()),
    si(new Date(e, 6, 1).getTimezoneOffset())
  );
}
function IM() {
  try {
    return !!window.sessionStorage;
  } catch (e) {
    return !0;
  }
}
function RM() {
  try {
    return !!window.localStorage;
  } catch (e) {
    return !0;
  }
}
function OM() {
  if (!(S1() || Xx()))
    try {
      return !!window.indexedDB;
    } catch (e) {
      return !0;
    }
}
function NM() {
  return !!window.openDatabase;
}
function UM() {
  return navigator.cpuClass;
}
function GM() {
  var e = navigator.platform;
  return e === "MacIntel" && hi() && !$v() ? Yx() ? "iPad" : "iPhone" : e;
}
function zM() {
  return navigator.vendor || "";
}
function WM() {
  for (var e = [], t = 0, r = [
    // Blink and some browsers on iOS
    "chrome",
    // Safari on macOS
    "safari",
    // Chrome on iOS (checked in 85 on 13 and 87 on 14)
    "__crWeb",
    "__gCrWeb",
    // Yandex Browser on iOS, macOS and Android (checked in 21.2 on iOS 14, macOS and Android)
    "yandex",
    // Yandex Browser on iOS (checked in 21.2 on 14)
    "__yb",
    "__ybro",
    // Firefox on iOS (checked in 32 on 14)
    "__firefox__",
    // Edge on iOS (checked in 46 on 14)
    "__edgeTrackingPreventionStatistics",
    "webkit",
    // Opera Touch on iOS (checked in 2.6 on 14)
    "oprt",
    // Samsung Internet on Android (checked in 11.1)
    "samsungAr",
    // UC Browser on Android (checked in 12.10 and 13.0)
    "ucweb",
    "UCShellJava",
    // Puffin on Android (checked in 9.0)
    "puffinDevice"
    // UC on iOS and Opera on Android have no specific global variables
    // Edge for Android isn't checked
  ]; t < r.length; t++) {
    var n = r[t], i = window[n];
    i && typeof i == "object" && e.push(n);
  }
  return e.sort();
}
function VM() {
  var e = document;
  try {
    e.cookie = "cookietest=1; SameSite=Strict;";
    var t = e.cookie.indexOf("cookietest=") !== -1;
    return e.cookie = "cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT", t;
  } catch (r) {
    return !1;
  }
}
function HM() {
  var e = atob;
  return {
    abpIndo: [
      "#Iklan-Melayang",
      "#Kolom-Iklan-728",
      "#SidebarIklan-wrapper",
      '[title="ALIENBOLA" i]',
      e("I0JveC1CYW5uZXItYWRz")
    ],
    abpvn: [".quangcao", "#mobileCatfish", e("LmNsb3NlLWFkcw=="), '[id^="bn_bottom_fixed_"]', "#pmadv"],
    adBlockFinland: [
      ".mainostila",
      e("LnNwb25zb3JpdA=="),
      ".ylamainos",
      e("YVtocmVmKj0iL2NsaWNrdGhyZ2guYXNwPyJd"),
      e("YVtocmVmXj0iaHR0cHM6Ly9hcHAucmVhZHBlYWsuY29tL2FkcyJd")
    ],
    adBlockPersian: [
      "#navbar_notice_50",
      ".kadr",
      'TABLE[width="140px"]',
      "#divAgahi",
      e("YVtocmVmXj0iaHR0cDovL2cxLnYuZndtcm0ubmV0L2FkLyJd")
    ],
    adBlockWarningRemoval: [
      "#adblock-honeypot",
      ".adblocker-root",
      ".wp_adblock_detect",
      e("LmhlYWRlci1ibG9ja2VkLWFk"),
      e("I2FkX2Jsb2NrZXI=")
    ],
    adGuardAnnoyances: [
      ".hs-sosyal",
      "#cookieconsentdiv",
      'div[class^="app_gdpr"]',
      ".as-oil",
      '[data-cypress="soft-push-notification-modal"]'
    ],
    adGuardBase: [
      ".BetterJsPopOverlay",
      e("I2FkXzMwMFgyNTA="),
      e("I2Jhbm5lcmZsb2F0MjI="),
      e("I2NhbXBhaWduLWJhbm5lcg=="),
      e("I0FkLUNvbnRlbnQ=")
    ],
    adGuardChinese: [
      e("LlppX2FkX2FfSA=="),
      e("YVtocmVmKj0iLmh0aGJldDM0LmNvbSJd"),
      "#widget-quan",
      e("YVtocmVmKj0iLzg0OTkyMDIwLnh5eiJd"),
      e("YVtocmVmKj0iLjE5NTZobC5jb20vIl0=")
    ],
    adGuardFrench: [
      "#pavePub",
      e("LmFkLWRlc2t0b3AtcmVjdGFuZ2xl"),
      ".mobile_adhesion",
      ".widgetadv",
      e("LmFkc19iYW4=")
    ],
    adGuardGerman: ['aside[data-portal-id="leaderboard"]'],
    adGuardJapanese: [
      "#kauli_yad_1",
      e("YVtocmVmXj0iaHR0cDovL2FkMi50cmFmZmljZ2F0ZS5uZXQvIl0="),
      e("Ll9wb3BJbl9pbmZpbml0ZV9hZA=="),
      e("LmFkZ29vZ2xl"),
      e("Ll9faXNib29zdFJldHVybkFk")
    ],
    adGuardMobile: [
      e("YW1wLWF1dG8tYWRz"),
      e("LmFtcF9hZA=="),
      'amp-embed[type="24smi"]',
      "#mgid_iframe1",
      e("I2FkX2ludmlld19hcmVh")
    ],
    adGuardRussian: [
      e("YVtocmVmXj0iaHR0cHM6Ly9hZC5sZXRtZWFkcy5jb20vIl0="),
      e("LnJlY2xhbWE="),
      'div[id^="smi2adblock"]',
      e("ZGl2W2lkXj0iQWRGb3hfYmFubmVyXyJd"),
      "#psyduckpockeball"
    ],
    adGuardSocial: [
      e("YVtocmVmXj0iLy93d3cuc3R1bWJsZXVwb24uY29tL3N1Ym1pdD91cmw9Il0="),
      e("YVtocmVmXj0iLy90ZWxlZ3JhbS5tZS9zaGFyZS91cmw/Il0="),
      ".etsy-tweet",
      "#inlineShare",
      ".popup-social"
    ],
    adGuardSpanishPortuguese: ["#barraPublicidade", "#Publicidade", "#publiEspecial", "#queTooltip", ".cnt-publi"],
    adGuardTrackingProtection: [
      "#qoo-counter",
      e("YVtocmVmXj0iaHR0cDovL2NsaWNrLmhvdGxvZy5ydS8iXQ=="),
      e("YVtocmVmXj0iaHR0cDovL2hpdGNvdW50ZXIucnUvdG9wL3N0YXQucGhwIl0="),
      e("YVtocmVmXj0iaHR0cDovL3RvcC5tYWlsLnJ1L2p1bXAiXQ=="),
      "#top100counter"
    ],
    adGuardTurkish: [
      "#backkapat",
      e("I3Jla2xhbWk="),
      e("YVtocmVmXj0iaHR0cDovL2Fkc2Vydi5vbnRlay5jb20udHIvIl0="),
      e("YVtocmVmXj0iaHR0cDovL2l6bGVuemkuY29tL2NhbXBhaWduLyJd"),
      e("YVtocmVmXj0iaHR0cDovL3d3dy5pbnN0YWxsYWRzLm5ldC8iXQ==")
    ],
    bulgarian: [e("dGQjZnJlZW5ldF90YWJsZV9hZHM="), "#ea_intext_div", ".lapni-pop-over", "#xenium_hot_offers"],
    easyList: [
      ".yb-floorad",
      e("LndpZGdldF9wb19hZHNfd2lkZ2V0"),
      e("LnRyYWZmaWNqdW5reS1hZA=="),
      ".textad_headline",
      e("LnNwb25zb3JlZC10ZXh0LWxpbmtz")
    ],
    easyListChina: [
      e("LmFwcGd1aWRlLXdyYXBbb25jbGljayo9ImJjZWJvcy5jb20iXQ=="),
      e("LmZyb250cGFnZUFkdk0="),
      "#taotaole",
      "#aafoot.top_box",
      ".cfa_popup"
    ],
    easyListCookie: [
      ".ezmob-footer",
      ".cc-CookieWarning",
      "[data-cookie-number]",
      e("LmF3LWNvb2tpZS1iYW5uZXI="),
      ".sygnal24-gdpr-modal-wrap"
    ],
    easyListCzechSlovak: [
      "#onlajny-stickers",
      e("I3Jla2xhbW5pLWJveA=="),
      e("LnJla2xhbWEtbWVnYWJvYXJk"),
      ".sklik",
      e("W2lkXj0ic2tsaWtSZWtsYW1hIl0=")
    ],
    easyListDutch: [
      e("I2FkdmVydGVudGll"),
      e("I3ZpcEFkbWFya3RCYW5uZXJCbG9jaw=="),
      ".adstekst",
      e("YVtocmVmXj0iaHR0cHM6Ly94bHR1YmUubmwvY2xpY2svIl0="),
      "#semilo-lrectangle"
    ],
    easyListGermany: [
      "#SSpotIMPopSlider",
      e("LnNwb25zb3JsaW5rZ3J1ZW4="),
      e("I3dlcmJ1bmdza3k="),
      e("I3Jla2xhbWUtcmVjaHRzLW1pdHRl"),
      e("YVtocmVmXj0iaHR0cHM6Ly9iZDc0Mi5jb20vIl0=")
    ],
    easyListItaly: [
      e("LmJveF9hZHZfYW5udW5jaQ=="),
      ".sb-box-pubbliredazionale",
      e("YVtocmVmXj0iaHR0cDovL2FmZmlsaWF6aW9uaWFkcy5zbmFpLml0LyJd"),
      e("YVtocmVmXj0iaHR0cHM6Ly9hZHNlcnZlci5odG1sLml0LyJd"),
      e("YVtocmVmXj0iaHR0cHM6Ly9hZmZpbGlhemlvbmlhZHMuc25haS5pdC8iXQ==")
    ],
    easyListLithuania: [
      e("LnJla2xhbW9zX3RhcnBhcw=="),
      e("LnJla2xhbW9zX251b3JvZG9z"),
      e("aW1nW2FsdD0iUmVrbGFtaW5pcyBza3lkZWxpcyJd"),
      e("aW1nW2FsdD0iRGVkaWt1b3RpLmx0IHNlcnZlcmlhaSJd"),
      e("aW1nW2FsdD0iSG9zdGluZ2FzIFNlcnZlcmlhaS5sdCJd")
    ],
    estonian: [e("QVtocmVmKj0iaHR0cDovL3BheTRyZXN1bHRzMjQuZXUiXQ==")],
    fanboyAnnoyances: ["#ac-lre-player", ".navigate-to-top", "#subscribe_popup", ".newsletter_holder", "#back-top"],
    fanboyAntiFacebook: [".util-bar-module-firefly-visible"],
    fanboyEnhancedTrackers: [
      ".open.pushModal",
      "#issuem-leaky-paywall-articles-zero-remaining-nag",
      "#sovrn_container",
      'div[class$="-hide"][zoompage-fontsize][style="display: block;"]',
      ".BlockNag__Card"
    ],
    fanboySocial: ["#FollowUs", "#meteored_share", "#social_follow", ".article-sharer", ".community__social-desc"],
    frellwitSwedish: [
      e("YVtocmVmKj0iY2FzaW5vcHJvLnNlIl1bdGFyZ2V0PSJfYmxhbmsiXQ=="),
      e("YVtocmVmKj0iZG9rdG9yLXNlLm9uZWxpbmsubWUiXQ=="),
      "article.category-samarbete",
      e("ZGl2LmhvbGlkQWRz"),
      "ul.adsmodern"
    ],
    greekAdBlock: [
      e("QVtocmVmKj0iYWRtYW4ub3RlbmV0LmdyL2NsaWNrPyJd"),
      e("QVtocmVmKj0iaHR0cDovL2F4aWFiYW5uZXJzLmV4b2R1cy5nci8iXQ=="),
      e("QVtocmVmKj0iaHR0cDovL2ludGVyYWN0aXZlLmZvcnRobmV0LmdyL2NsaWNrPyJd"),
      "DIV.agores300",
      "TABLE.advright"
    ],
    hungarian: [
      "#cemp_doboz",
      ".optimonk-iframe-container",
      e("LmFkX19tYWlu"),
      e("W2NsYXNzKj0iR29vZ2xlQWRzIl0="),
      "#hirdetesek_box"
    ],
    iDontCareAboutCookies: [
      '.alert-info[data-block-track*="CookieNotice"]',
      ".ModuleTemplateCookieIndicator",
      ".o--cookies--container",
      "#cookies-policy-sticky",
      "#stickyCookieBar"
    ],
    icelandicAbp: [e("QVtocmVmXj0iL2ZyYW1ld29yay9yZXNvdXJjZXMvZm9ybXMvYWRzLmFzcHgiXQ==")],
    latvian: [
      e("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMjBweDsgaGVpZ2h0OiA0MHB4OyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogcmVsYXRpdmU7Il0="),
      e("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiA4OHB4OyBoZWlnaHQ6IDMxcHg7IG92ZXJmbG93OiBoaWRkZW47IHBvc2l0aW9uOiByZWxhdGl2ZTsiXQ==")
    ],
    listKr: [
      e("YVtocmVmKj0iLy9hZC5wbGFuYnBsdXMuY28ua3IvIl0="),
      e("I2xpdmVyZUFkV3JhcHBlcg=="),
      e("YVtocmVmKj0iLy9hZHYuaW1hZHJlcC5jby5rci8iXQ=="),
      e("aW5zLmZhc3R2aWV3LWFk"),
      ".revenue_unit_item.dable"
    ],
    listeAr: [
      e("LmdlbWluaUxCMUFk"),
      ".right-and-left-sponsers",
      e("YVtocmVmKj0iLmFmbGFtLmluZm8iXQ=="),
      e("YVtocmVmKj0iYm9vcmFxLm9yZyJd"),
      e("YVtocmVmKj0iZHViaXp6bGUuY29tL2FyLz91dG1fc291cmNlPSJd")
    ],
    listeFr: [
      e("YVtocmVmXj0iaHR0cDovL3Byb21vLnZhZG9yLmNvbS8iXQ=="),
      e("I2FkY29udGFpbmVyX3JlY2hlcmNoZQ=="),
      e("YVtocmVmKj0id2Vib3JhbWEuZnIvZmNnaS1iaW4vIl0="),
      ".site-pub-interstitiel",
      'div[id^="crt-"][data-criteo-id]'
    ],
    officialPolish: [
      "#ceneo-placeholder-ceneo-12",
      e("W2hyZWZePSJodHRwczovL2FmZi5zZW5kaHViLnBsLyJd"),
      e("YVtocmVmXj0iaHR0cDovL2Fkdm1hbmFnZXIudGVjaGZ1bi5wbC9yZWRpcmVjdC8iXQ=="),
      e("YVtocmVmXj0iaHR0cDovL3d3dy50cml6ZXIucGwvP3V0bV9zb3VyY2UiXQ=="),
      e("ZGl2I3NrYXBpZWNfYWQ=")
    ],
    ro: [
      e("YVtocmVmXj0iLy9hZmZ0cmsuYWx0ZXgucm8vQ291bnRlci9DbGljayJd"),
      e("YVtocmVmXj0iaHR0cHM6Ly9ibGFja2ZyaWRheXNhbGVzLnJvL3Ryay9zaG9wLyJd"),
      e("YVtocmVmXj0iaHR0cHM6Ly9ldmVudC4ycGVyZm9ybWFudC5jb20vZXZlbnRzL2NsaWNrIl0="),
      e("YVtocmVmXj0iaHR0cHM6Ly9sLnByb2ZpdHNoYXJlLnJvLyJd"),
      'a[href^="/url/"]'
    ],
    ruAd: [
      e("YVtocmVmKj0iLy9mZWJyYXJlLnJ1LyJd"),
      e("YVtocmVmKj0iLy91dGltZy5ydS8iXQ=="),
      e("YVtocmVmKj0iOi8vY2hpa2lkaWtpLnJ1Il0="),
      "#pgeldiz",
      ".yandex-rtb-block"
    ],
    thaiAds: [
      "a[href*=macau-uta-popup]",
      e("I2Fkcy1nb29nbGUtbWlkZGxlX3JlY3RhbmdsZS1ncm91cA=="),
      e("LmFkczMwMHM="),
      ".bumq",
      ".img-kosana"
    ],
    webAnnoyancesUltralist: [
      "#mod-social-share-2",
      "#social-tools",
      e("LmN0cGwtZnVsbGJhbm5lcg=="),
      ".zergnet-recommend",
      ".yt.btn-link.btn-md.btn"
    ]
  };
}
function jM(e) {
  var t = e === void 0 ? {} : e, r = t.debug;
  return Oi(this, void 0, void 0, function() {
    var n, i, a, s, o, u;
    return Ni(this, function(l) {
      switch (l.label) {
        case 0:
          return XM() ? (n = HM(), i = Object.keys(n), a = (u = []).concat.apply(u, i.map(function(c) {
            return n[c];
          })), [4, qM(a)]) : [2, void 0];
        case 1:
          return s = l.sent(), r && $M(n, s), o = i.filter(function(c) {
            var f = n[c], h = _n(f.map(function(d) {
              return s[d];
            }));
            return h > f.length * 0.6;
          }), o.sort(), [2, o];
      }
    });
  });
}
function XM() {
  return hi() || Yv();
}
function qM(e) {
  var t;
  return Oi(this, void 0, void 0, function() {
    var r, n, i, a, u, s, o, u;
    return Ni(this, function(l) {
      switch (l.label) {
        case 0:
          for (r = document, n = r.createElement("div"), i = new Array(e.length), a = {}, Cm(n), u = 0; u < e.length; ++u)
            s = iM(e[u]), s.tagName === "DIALOG" && s.show(), o = r.createElement("div"), Cm(o), o.appendChild(s), n.appendChild(o), i[u] = s;
          l.label = 1;
        case 1:
          return r.body ? [3, 3] : [4, Yc(50)];
        case 2:
          return l.sent(), [3, 1];
        case 3:
          r.body.appendChild(n);
          try {
            for (u = 0; u < e.length; ++u)
              i[u].offsetParent || (a[e[u]] = !0);
          } finally {
            (t = n.parentNode) === null || t === void 0 || t.removeChild(n);
          }
          return [2, a];
      }
    });
  });
}
function Cm(e) {
  e.style.setProperty("visibility", "hidden", "important"), e.style.setProperty("display", "block", "important");
}
function $M(e, t) {
  for (var r = "DOM blockers debug:\n```", n = 0, i = Object.keys(e); n < i.length; n++) {
    var a = i[n];
    r += `
`.concat(a, ":");
    for (var s = 0, o = e[a]; s < o.length; s++) {
      var u = o[s];
      r += `
  `.concat(t[u] ? "" : "", " ").concat(u);
    }
  }
  console.log("".concat(r, "\n```"));
}
function YM() {
  for (var e = 0, t = ["rec2020", "p3", "srgb"]; e < t.length; e++) {
    var r = t[e];
    if (matchMedia("(color-gamut: ".concat(r, ")")).matches)
      return r;
  }
}
function KM() {
  if (Dm("inverted"))
    return !0;
  if (Dm("none"))
    return !1;
}
function Dm(e) {
  return matchMedia("(inverted-colors: ".concat(e, ")")).matches;
}
function ZM() {
  if (_m("active"))
    return !0;
  if (_m("none"))
    return !1;
}
function _m(e) {
  return matchMedia("(forced-colors: ".concat(e, ")")).matches;
}
var JM = 100;
function QM() {
  if (matchMedia("(min-monochrome: 0)").matches) {
    for (var e = 0; e <= JM; ++e)
      if (matchMedia("(max-monochrome: ".concat(e, ")")).matches)
        return e;
    throw new Error("Too high value");
  }
}
function e5() {
  if (Os("no-preference"))
    return 0;
  if (Os("high") || Os("more"))
    return 1;
  if (Os("low") || Os("less"))
    return -1;
  if (Os("forced"))
    return 10;
}
function Os(e) {
  return matchMedia("(prefers-contrast: ".concat(e, ")")).matches;
}
function t5() {
  if (Pm("reduce"))
    return !0;
  if (Pm("no-preference"))
    return !1;
}
function Pm(e) {
  return matchMedia("(prefers-reduced-motion: ".concat(e, ")")).matches;
}
function r5() {
  if (Bm("reduce"))
    return !0;
  if (Bm("no-preference"))
    return !1;
}
function Bm(e) {
  return matchMedia("(prefers-reduced-transparency: ".concat(e, ")")).matches;
}
function n5() {
  if (Lm("high"))
    return !0;
  if (Lm("standard"))
    return !1;
}
function Lm(e) {
  return matchMedia("(dynamic-range: ".concat(e, ")")).matches;
}
var Yt = Math, cn = function() {
  return 0;
};
function i5() {
  var e = Yt.acos || cn, t = Yt.acosh || cn, r = Yt.asin || cn, n = Yt.asinh || cn, i = Yt.atanh || cn, a = Yt.atan || cn, s = Yt.sin || cn, o = Yt.sinh || cn, u = Yt.cos || cn, l = Yt.cosh || cn, c = Yt.tan || cn, f = Yt.tanh || cn, h = Yt.exp || cn, d = Yt.expm1 || cn, g = Yt.log1p || cn, v = function(E) {
    return Yt.pow(Yt.PI, E);
  }, m = function(E) {
    return Yt.log(E + Yt.sqrt(E * E - 1));
  }, p = function(E) {
    return Yt.log(E + Yt.sqrt(E * E + 1));
  }, y = function(E) {
    return Yt.log((1 + E) / (1 - E)) / 2;
  }, w = function(E) {
    return Yt.exp(E) - 1 / Yt.exp(E) / 2;
  }, x = function(E) {
    return (Yt.exp(E) + 1 / Yt.exp(E)) / 2;
  }, b = function(E) {
    return Yt.exp(E) - 1;
  }, M = function(E) {
    return (Yt.exp(2 * E) - 1) / (Yt.exp(2 * E) + 1);
  }, k = function(E) {
    return Yt.log(1 + E);
  };
  return {
    acos: e(0.12312423423423424),
    acosh: t(1e308),
    acoshPf: m(1e154),
    asin: r(0.12312423423423424),
    asinh: n(1),
    asinhPf: p(1),
    atanh: i(0.5),
    atanhPf: y(0.5),
    atan: a(0.5),
    sin: s(-1e300),
    sinh: o(1),
    sinhPf: w(1),
    cos: u(10.000000000123),
    cosh: l(1),
    coshPf: x(1),
    tan: c(-1e300),
    tanh: f(1),
    tanhPf: M(1),
    exp: h(1),
    expm1: d(1),
    expm1Pf: b(1),
    log1p: g(10),
    log1pPf: k(10),
    powPI: v(-100)
  };
}
var a5 = "mmMwWLliI0fiflO&1", Bh = {
  /**
   * The default font. User can change it in desktop Chrome, desktop Firefox, IE 11,
   * Android Chrome (but only when the size is  than the default) and Android Firefox.
   */
  default: [],
  /** OS font on macOS. User can change its size and weight. Applies after Safari restart. */
  apple: [{ font: "-apple-system-body" }],
  /** User can change it in desktop Chrome and desktop Firefox. */
  serif: [{ fontFamily: "serif" }],
  /** User can change it in desktop Chrome and desktop Firefox. */
  sans: [{ fontFamily: "sans-serif" }],
  /** User can change it in desktop Chrome and desktop Firefox. */
  mono: [{ fontFamily: "monospace" }],
  /**
   * Check the smallest allowed font size. User can change it in desktop Chrome, desktop Firefox and desktop Safari.
   * The height can be 0 in Chrome on a retina display.
   */
  min: [{ fontSize: "1px" }],
  /** Tells one OS from another in desktop Chrome. */
  system: [{ fontFamily: "system-ui" }]
};
function s5() {
  return o5(function(e, t) {
    for (var r = {}, n = {}, i = 0, a = Object.keys(Bh); i < a.length; i++) {
      var s = a[i], o = Bh[s], u = o[0], l = u === void 0 ? {} : u, c = o[1], f = c === void 0 ? a5 : c, h = e.createElement("span");
      h.textContent = f, h.style.whiteSpace = "nowrap";
      for (var d = 0, g = Object.keys(l); d < g.length; d++) {
        var v = g[d], m = l[v];
        m !== void 0 && (h.style[v] = m);
      }
      r[s] = h, t.append(e.createElement("br"), h);
    }
    for (var p = 0, y = Object.keys(Bh); p < y.length; p++) {
      var s = y[p];
      n[s] = r[s].getBoundingClientRect().width;
    }
    return n;
  });
}
function o5(e, t) {
  return t === void 0 && (t = 4e3), C1(function(r, n) {
    var i = n.document, a = i.body, s = a.style;
    s.width = "".concat(t, "px"), s.webkitTextSizeAdjust = s.textSizeAdjust = "none", Qf() ? a.style.zoom = "".concat(1 / n.devicePixelRatio) : hi() && (a.style.zoom = "reset");
    var o = i.createElement("div");
    return o.textContent = M1([], Array(t / 20 << 0)).map(function() {
      return "word";
    }).join(" "), a.appendChild(o), e(i, a);
  }, '<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">');
}
function u5() {
  return navigator.pdfViewerEnabled;
}
function l5() {
  var e = new Float32Array(1), t = new Uint8Array(e.buffer);
  return e[0] = 1 / 0, e[0] = e[0] - e[0], t[3];
}
function c5() {
  var e = window.ApplePaySession;
  if (typeof (e == null ? void 0 : e.canMakePayments) != "function")
    return -1;
  if (f5())
    return -3;
  try {
    return e.canMakePayments() ? 1 : 0;
  } catch (t) {
    return h5(t);
  }
}
var f5 = sM;
function h5(e) {
  if (e instanceof Error && e.name === "InvalidAccessError" && /\bfrom\b.*\binsecure\b/i.test(e.message))
    return -2;
  throw e;
}
function d5() {
  var e, t = document.createElement("a"), r = (e = t.attributionSourceId) !== null && e !== void 0 ? e : t.attributionsourceid;
  return r === void 0 ? void 0 : String(r);
}
var D1 = -1, _1 = -2, p5 = /* @__PURE__ */ new Set([
  10752,
  2849,
  2884,
  2885,
  2886,
  2928,
  2929,
  2930,
  2931,
  2932,
  2960,
  2961,
  2962,
  2963,
  2964,
  2965,
  2966,
  2967,
  2968,
  2978,
  3024,
  3042,
  3088,
  3089,
  3106,
  3107,
  32773,
  32777,
  32777,
  32823,
  32824,
  32936,
  32937,
  32938,
  32939,
  32968,
  32969,
  32970,
  32971,
  3317,
  33170,
  3333,
  3379,
  3386,
  33901,
  33902,
  34016,
  34024,
  34076,
  3408,
  3410,
  3411,
  3412,
  3413,
  3414,
  3415,
  34467,
  34816,
  34817,
  34818,
  34819,
  34877,
  34921,
  34930,
  35660,
  35661,
  35724,
  35738,
  35739,
  36003,
  36004,
  36005,
  36347,
  36348,
  36349,
  37440,
  37441,
  37443,
  7936,
  7937,
  7938
  // SAMPLE_ALPHA_TO_COVERAGE (32926) and SAMPLE_COVERAGE (32928) are excluded because they trigger a console warning
  // in IE, Chrome  59 and Safari  13 and give no entropy.
]), v5 = /* @__PURE__ */ new Set([
  34047,
  35723,
  36063,
  34852,
  34853,
  34854,
  34229,
  36392,
  36795,
  38449
  // MAX_VIEWS_OVR
]), m5 = ["FRAGMENT_SHADER", "VERTEX_SHADER"], g5 = ["LOW_FLOAT", "MEDIUM_FLOAT", "HIGH_FLOAT", "LOW_INT", "MEDIUM_INT", "HIGH_INT"], P1 = "WEBGL_debug_renderer_info", y5 = "WEBGL_polygon_mode";
function b5(e) {
  var t, r, n, i, a, s, o = e.cache, u = B1(o);
  if (!u)
    return D1;
  if (!F1(u))
    return _1;
  var l = L1() ? null : u.getExtension(P1);
  return {
    version: ((t = u.getParameter(u.VERSION)) === null || t === void 0 ? void 0 : t.toString()) || "",
    vendor: ((r = u.getParameter(u.VENDOR)) === null || r === void 0 ? void 0 : r.toString()) || "",
    vendorUnmasked: l ? (n = u.getParameter(l.UNMASKED_VENDOR_WEBGL)) === null || n === void 0 ? void 0 : n.toString() : "",
    renderer: ((i = u.getParameter(u.RENDERER)) === null || i === void 0 ? void 0 : i.toString()) || "",
    rendererUnmasked: l ? (a = u.getParameter(l.UNMASKED_RENDERER_WEBGL)) === null || a === void 0 ? void 0 : a.toString() : "",
    shadingLanguageVersion: ((s = u.getParameter(u.SHADING_LANGUAGE_VERSION)) === null || s === void 0 ? void 0 : s.toString()) || ""
  };
}
function w5(e) {
  var t = e.cache, r = B1(t);
  if (!r)
    return D1;
  if (!F1(r))
    return _1;
  var n = r.getSupportedExtensions(), i = r.getContextAttributes(), a = [], s = [], o = [], u = [], l = [];
  if (i)
    for (var c = 0, f = Object.keys(i); c < f.length; c++) {
      var h = f[c];
      s.push("".concat(h, "=").concat(i[h]));
    }
  for (var d = Fm(r), g = 0, v = d; g < v.length; g++) {
    var m = v[g], p = r[m];
    o.push("".concat(m, "=").concat(p).concat(p5.has(p) ? "=".concat(r.getParameter(p)) : ""));
  }
  if (n)
    for (var y = 0, w = n; y < w.length; y++) {
      var x = w[y];
      if (!(x === P1 && L1() || x === y5 && E5())) {
        var b = r.getExtension(x);
        if (!b) {
          a.push(x);
          continue;
        }
        for (var M = 0, k = Fm(b); M < k.length; M++) {
          var m = k[M], p = b[m];
          u.push("".concat(m, "=").concat(p).concat(v5.has(p) ? "=".concat(r.getParameter(p)) : ""));
        }
      }
    }
  for (var E = 0, S = m5; E < S.length; E++)
    for (var F = S[E], O = 0, D = g5; O < D.length; O++) {
      var _ = D[O], L = x5(r, F, _);
      l.push("".concat(F, ".").concat(_, "=").concat(L.join(",")));
    }
  return u.sort(), o.sort(), {
    contextAttributes: s,
    parameters: o,
    shaderPrecisions: l,
    extensions: n,
    extensionParameters: u,
    unsupportedExtensions: a
  };
}
function B1(e) {
  if (e.webgl)
    return e.webgl.context;
  var t = document.createElement("canvas"), r;
  t.addEventListener("webglCreateContextError", function() {
    return r = void 0;
  });
  for (var n = 0, i = ["webgl", "experimental-webgl"]; n < i.length; n++) {
    var a = i[n];
    try {
      r = t.getContext(a);
    } catch (s) {
    }
    if (r)
      break;
  }
  return e.webgl = { context: r }, r;
}
function x5(e, t, r) {
  var n = e.getShaderPrecisionFormat(e[t], e[r]);
  return n ? [n.rangeMin, n.rangeMax, n.precision] : [];
}
function Fm(e) {
  var t = Object.keys(e.__proto__);
  return t.filter(M5);
}
function M5(e) {
  return typeof e == "string" && !e.match(/[^A-Z0-9_x]/);
}
function L1() {
  return k1();
}
function E5() {
  return Qf() || hi();
}
function F1(e) {
  return typeof e.getParameter == "function";
}
function A5() {
  var e, t = Yv() || hi();
  return t ? window.AudioContext && (e = new AudioContext().baseLatency) !== null && e !== void 0 ? e : -1 : -2;
}
var T5 = {
  // READ FIRST:
  // See https://github.com/fingerprintjs/fingerprintjs/blob/master/contributing.md#how-to-make-an-entropy-source
  // to learn how entropy source works and how to make your own.
  // The sources run in this exact order.
  // The asynchronous sources are at the start to run in parallel with other sources.
  fonts: lM,
  domBlockers: jM,
  fontPreferences: s5,
  audio: Jx,
  screenFrame: PM,
  canvas: fM,
  osCpu: xM,
  languages: MM,
  colorDepth: EM,
  deviceMemory: AM,
  screenResolution: TM,
  hardwareConcurrency: BM,
  timezone: LM,
  sessionStorage: IM,
  localStorage: RM,
  indexedDB: OM,
  openDatabase: NM,
  cpuClass: UM,
  platform: GM,
  plugins: cM,
  touchSupport: wM,
  vendor: zM,
  vendorFlavors: WM,
  cookiesEnabled: VM,
  colorGamut: YM,
  invertedColors: KM,
  forcedColors: ZM,
  monochrome: QM,
  contrast: e5,
  reducedMotion: t5,
  reducedTransparency: r5,
  hdr: n5,
  math: i5,
  pdfViewerEnabled: u5,
  architecture: l5,
  applePay: c5,
  privateClickMeasurement: d5,
  audioBaseLatency: A5,
  // Some sources can affect other sources (e.g. WebGL can affect canvas), so it's important to run these sources
  // after other sources.
  webGlBasics: b5,
  webGlExtensions: w5
};
function S5(e) {
  return jx(T5, e, []);
}
var k5 = "$ if upgrade to Pro: https://fpjs.dev/pro";
function C5(e) {
  var t = D5(e), r = _5(t);
  return { score: t, comment: k5.replace(/\$/g, "".concat(r)) };
}
function D5(e) {
  if (Yv())
    return 0.4;
  if (hi())
    return $v() && !(ml() && vl()) ? 0.5 : 0.3;
  var t = "value" in e.platform ? e.platform.value : "";
  return /^Win/.test(t) ? 0.6 : /^Mac/.test(t) ? 0.5 : 0.7;
}
function _5(e) {
  return T1(0.99 + 0.01 * e, 1e-4);
}
function P5(e) {
  for (var t = "", r = 0, n = Object.keys(e).sort(); r < n.length; r++) {
    var i = n[r], a = e[i], s = "error" in a ? "error" : JSON.stringify(a.value);
    t += "".concat(t ? "|" : "").concat(i.replace(/([:|\\])/g, "\\$1"), ":").concat(s);
  }
  return t;
}
function B5(e) {
  return JSON.stringify(e, function(t, r) {
    return r instanceof Error ? zx(r) : r;
  }, 2);
}
function L5(e) {
  return Gx(P5(e));
}
function F5(e) {
  var t, r = C5(e);
  return {
    get visitorId() {
      return t === void 0 && (t = L5(this.components)), t;
    },
    set visitorId(n) {
      t = n;
    },
    confidence: r,
    components: e,
    version: E1
  };
}
function I5(e) {
  return e === void 0 && (e = 50), Px(e, e * 2);
}
function R5(e, t) {
  var r = Date.now();
  return {
    get: function(n) {
      return Oi(this, void 0, void 0, function() {
        var i, a, s;
        return Ni(this, function(o) {
          switch (o.label) {
            case 0:
              return i = Date.now(), [4, e()];
            case 1:
              return a = o.sent(), s = F5(a), (t || n != null && n.debug) && console.log("Copy the text below to get the debug data:\n\n```\nversion: ".concat(s.version, `
userAgent: `).concat(navigator.userAgent, `
timeBetweenLoadAndGet: `).concat(i - r, `
visitorId: `).concat(s.visitorId, `
components: `).concat(B5(a), "\n```")), [2, s];
          }
        });
      });
    }
  };
}
function O5() {
  if (!(window.__fpjs_d_m || Math.random() >= 1e-3))
    try {
      var e = new XMLHttpRequest();
      e.open("get", "https://m1.openfpcdn.io/fingerprintjs/v".concat(E1, "/npm-monitoring"), !0), e.send();
    } catch (t) {
      console.error(t);
    }
}
function N5(e) {
  var t;
  return e === void 0 && (e = {}), Oi(this, void 0, void 0, function() {
    var r, n, i;
    return Ni(this, function(a) {
      switch (a.label) {
        case 0:
          return (!((t = e.monitoring) !== null && t !== void 0) || t) && O5(), r = e.delayFallback, n = e.debug, [4, I5(r)];
        case 1:
          return a.sent(), i = S5({ cache: {}, debug: n }), [2, R5(i, n)];
      }
    });
  });
}
var U5 = function(t) {
  var r = null;
  if (typeof t == "string" && t.length > 0) {
    if (r = document.querySelector(t), !r)
      return t.replace(/^#/, "");
  } else t instanceof HTMLCanvasElement && (r = t);
  if (r)
    return r.id || (r.id = Math.random().toString(16).slice(2)), r.id;
}, G5 = function(t, r, n, i, a) {
  return new Promise(function(s, o) {
    try {
      Ue.createMxObject({
        canvasId: U5(t),
        isCPPMxCAD: !0,
        mapBox: n,
        callback: function(l) {
          l.initRendererParam({
            webgl2: i !== !0
          }), l.setViewMovementMethod(r === void 0 ? !0 : r), a && a.callEvent("init_before_mxdraw", l), l.addEvent("initObject", function() {
            l.isWebgl2() ? console.log("MxTip: use webgl2") : console.log("MxTip: use webgl1"), s(l);
          });
        }
      });
    } catch (u) {
      o(u);
    }
  });
}, z5 = function(t, r, n, i, a, s, o, u) {
  var l = t.CreateMxDraw(r, n, i, a, s, o);
  return u ? u.init(l) : u = new pl(l), l.McObject = u, l.McObject;
};
function Kv() {
  console.log(ie.App.getVersionString());
}
var eh = /* @__PURE__ */ function() {
  var e = ut(/* @__PURE__ */ be.mark(function t(r, n) {
    var i, a, s, o, u, l, c, f, h, d, g, v, m, p, y, w, x, b, M, k, E, S, F, O, D, _, L, G, V, H, U, R;
    return be.wrap(function(C) {
      for (; ; ) switch (C.prev = C.next) {
        case 0:
          if (cw.state.MxFun) {
            C.next = 3;
            break;
          }
          return C.next = 3, fw();
        case 3:
          return i = r || {}, a = i.openParameter, s = i.networkFonts, o = i.fontspath, u = i.locateFile, l = i.wasmBinary, c = i.canvas, f = i.onOpenFileComplete, h = i.fileUrl, d = i.onInit, g = i.middlePan, v = i.registdata, m = i.registfile, p = i.authorized_service, y = i.viewBackgroundColor, w = i.map, x = i.multipleSelect, b = i.enableUndo, M = i.enableIntelliSelect, k = i.browse, E = i.webgl1, C.next = 6, zv(function() {
          }, u, l, o, s, n);
        case 6:
          return Ue.initMxCpp(ie), Bt.init(), Ue.setIniset({
            EnableIntelliSelect: M === void 0 ? !0 : M
          }), b !== void 0 && ie.App.IniSet({
            EnableUndo: b
          }), y && ie.App.setDefaultViewBackgroundColor(y.red, y.green, y.blue), d && d(), n && n.callEvent("init"), C.next = 15, G5(c, g, w, E, n);
        case 15:
          if (S = C.sent, x !== void 0 && S.setMultipleSelect(x), y && S.setViewColor(y.red << 16 | y.green << 8 | y.blue), n && n.callEvent("init_mxdraw", S), F = Ue.getMxFunTHREE(), O = new F.Vector2(), S.getRenderer().getSize(O), D = z5(ie.App.getImp(), O.width, O.height, S.getCanvas().id, S.isWebgl2(), S.getId(), !!w, n), _ = ie.App.getImp().getCodeVersion(), !(_ != 1 && _ != 2)) {
            C.next = 35;
            break;
          }
          if (!(v && v.length > 0)) {
            C.next = 29;
            break;
          }
          D.initRegist(v), C.next = 35;
          break;
        case 29:
          return L = m, m && m.length > 0 || (L = "mxkey.json.frontpage.json"), C.next = 33, jf(L);
        case 33:
          G = C.sent, G && G.registdata ? (D.initRegist(G.registdata), p ? p == "same_current_page_url" && G.authorized_service && G.authorized_service.length > 0 ? D.iniAuthorizedService(G.authorized_service) : D.iniAuthorizedService(p) : G.authorized_service && G.authorized_service.length > 0 && D.iniAuthorizedService(G.authorized_service)) : (p && D.iniAuthorizedService(p), console.log("MxTip:empty regist data"));
        case 35:
          if (_ != 3) {
            C.next = 48;
            break;
          }
          if (V = localStorage.getItem("_mx_tmp_id_"), !(!V || V.length == 0)) {
            C.next = 47;
            break;
          }
          return H = window, H.__fpjs_d_m = !0, C.next = 42, N5();
        case 42:
          return U = C.sent, C.next = 45, U.get();
        case 45:
          V = C.sent.visitorId, localStorage.setItem("_mx_tmp_id_", V);
        case 47:
          ie.App.getImp().addFontsLoadOnInitialization(V, -121);
        case 48:
          return S.initMxCpp(D), S.addEvent("openFileComplete", function() {
            f && f(D);
          }), D && (k === !0 || k === 1 ? (D.setBrowse(!0), g === void 0 && (g = 0)) : k == 2 && (g === void 0 && (g = 0), Ue.setIniset({
            ForbiddenDynInput: !0,
            EnableCADEntityGripEdit: 0
          })), g !== void 0 && D.mxdraw.setMouseMiddlePan(g), D.callEvent("init_mxcad", D)), h && (R = 0, a && a && (R = a), D.openWebFile(h, void 0, !0, a, R)), C.abrupt("return", D);
        case 53:
        case "end":
          return C.stop();
      }
    }, t);
  }));
  return function(r, n) {
    return e.apply(this, arguments);
  };
}(), hn = /* @__PURE__ */ function(e) {
  return e[e.kByLayer = 1] = "kByLayer", e[e.kByBlock = 2] = "kByBlock", e[e.kByColor = 3] = "kByColor", e[e.kByACI = 4] = "kByACI", e[e.kByPen = 5] = "kByPen", e[e.kForeground = 6] = "kForeground", e[e.kLayerOff = 7] = "kLayerOff", e[e.kLayerFrozen = 8] = "kLayerFrozen", e[e.kNone = 9] = "kNone", e;
}(hn || {}), Ti = /* @__PURE__ */ function(e) {
  return e[e.kByblock = 0] = "kByblock", e[e.kRed = 1] = "kRed", e[e.kYellow = 2] = "kYellow", e[e.kGreen = 3] = "kGreen", e[e.KCyan = 4] = "KCyan", e[e.kBlue = 5] = "kBlue", e[e.kMagenta = 6] = "kMagenta", e[e.kWhite = 7] = "kWhite", e[e.kBylayer = 256] = "kBylayer", e;
}(Ti || {}), Ya, th = function() {
  if (!Ya) {
    var t = Ue.getMxFunTHREE();
    Ya = new t.Color();
  }
  for (var r = function(g) {
    return Er(g[0]) === "object" && g[0].isColor;
  }, n = function(g) {
    return typeof g[0] == "number" && g.length === 1;
  }, i = function(g) {
    return typeof g[0] == "string" && g.length === 1;
  }, a = function(g) {
    return g.length === 3;
  }, s = arguments.length, o = new Array(s), u = 0; u < s; u++)
    o[u] = arguments[u];
  if (a(o)) {
    var l;
    (l = Ya).setRGB.apply(l, o);
  } else if (r(o)) {
    var c;
    (c = Ya).set.apply(c, o);
  } else if (n(o)) {
    var f;
    (f = Ya).set.apply(f, o);
  } else if (i(o)) {
    var h;
    (h = Ya).set.apply(h, o);
  }
  return Ya;
}, W5 = function(t) {
  var r = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : ie.App.mcedRGB2Index(t.red, t.green, t.blue, !1);
  r === -1 ? t.method = 3 : t.setColorIndex(r), r === 7 ? t.method = 4 : r === 0 ? t.method = 2 : r === 256 ? t.method = 1 : r !== -1 && (t.method = 4), t.colorIndex = r;
}, I1 = function() {
  for (var t = new fr(), r = arguments.length, n = new Array(r), i = 0; i < r; i++)
    n[i] = arguments[i];
  return Zv.apply(void 0, [t].concat(n)), t;
}, Zv = function(t) {
  for (var r = function(h) {
    return h.length > 1 || Er(h[0]) === "object" && h[0].isColor || typeof h[0] == "string" || typeof h[0] == "number";
  }, n = function(h) {
    return Er(h[0]) === "object" && !(h[0] && h[0].isColor);
  }, i = arguments.length, a = new Array(i > 1 ? i - 1 : 0), s = 1; s < i; s++)
    a[s - 1] = arguments[s];
  if (r(a)) {
    var o = th.apply(void 0, a), u = o.r, l = o.g, c = o.b;
    t.red = u * 255, t.green = l * 255, t.blue = c * 255;
  }
  n(a) && (t = Object.assign(t, a[0])), W5(t);
};
function R1() {
  return _d.apply(this, arguments);
}
function _d() {
  return _d = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v, m;
    return be.wrap(function(y) {
      for (; ; ) switch (y.prev = y.next) {
        case 0:
          return a = function() {
            var x = new ps();
            return x.height = t || 100, x.textString = r || "", x.position = n || new te(), x.trueColor = new fr(ie.getCurrentMxCAD().getCurrentDatabaseDrawColor()), x.rotation = i || 0, x;
          }, s = new $f(), s.setMessage(""), y.next = 5, s.go();
        case 5:
          if (o = y.sent, o) {
            y.next = 8;
            break;
          }
          return y.abrupt("return");
        case 8:
          return r = o, u = new Zt(), u.clearLastInputPoint(), u.setMessage(""), u.setUserDraw(function(w, x) {
            n = w, x.drawMcDbEntity(a());
          }), y.next = 15, u.go();
        case 15:
          if (l = y.sent, l) {
            y.next = 18;
            break;
          }
          return y.abrupt("return");
        case 18:
          return n = l, c = new cr(), c.setBasePt(n), c.setMessage(Ot("Mx_Text_Height", "")), c.setUserDraw(function(w, x) {
            n && (t = w.distanceTo(n)), x.drawMcDbEntity(a());
          }), y.next = 25, c.go();
        case 25:
          if (f = y.sent, f) {
            y.next = 28;
            break;
          }
          return y.abrupt("return");
        case 28:
          return t = f, h = new Qi(), h.setBasePt(n), h.clearLastInputPoint(), h.setMessage(Ot("Mx_Text_Angle", "")), h.setUserDraw(function(w, x) {
            n && (i = Rr(w.x, w.y, n.x, n.y)), x.drawMcDbEntity(a());
          }), y.next = 36, h.go();
        case 36:
          return d = y.sent, d !== null && h.getDetailedResult() === 8 && (i = d), g = a(), v = ie.getCurrentMxCAD(), m = v.drawEntity(g), v.updateDisplay(), y.abrupt("return", m);
        case 43:
        case "end":
          return y.stop();
      }
    }, e);
  })), _d.apply(this, arguments);
}
function V5() {
  if (typeof Reflect == "undefined" || !Reflect.construct || Reflect.construct.sham) return !1;
  if (typeof Proxy == "function") return !0;
  try {
    return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    })), !0;
  } catch (e) {
    return !1;
  }
}
function mo(e, t, r) {
  return V5() ? mo = Reflect.construct.bind() : mo = function(i, a, s) {
    var o = [null];
    o.push.apply(o, a);
    var u = Function.bind.apply(i, o), l = new u();
    return s && Ac(l, s.prototype), l;
  }, mo.apply(null, arguments);
}
function Im(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = H5(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function H5(e, t) {
  if (e) {
    if (typeof e == "string") return Rm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? Rm(e, t) : void 0;
  }
}
function Rm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
function Om(e, t) {
  var r = e.endPoint.sub(e.startPoint).normalize(), n = new Ve(-r.y, r.x, 0), i = n.mult(t), a = e.startPoint.clone().addvec(i), s = e.endPoint.clone().addvec(i), o = e.startPoint.clone().subvec(i), u = e.endPoint.clone().subvec(i), l = new st(a, s), c = new st(o, u);
  return [l, c];
}
function Nm(e, t, r) {
  var n = function(m) {
    return [mo(zr, Xt(m.center.toVector3().toArray()).concat([Math.max(0, m.radius - t)])), mo(zr, Xt(m.center.toVector3().toArray()).concat([m.radius + t]))];
  };
  if (e instanceof ot && r) {
    var i = ku(e, r, 0.1) || {}, a = i.start, s = i.end, o = i.bulge;
    if (!a || !s) return [];
    if (!o || o === 0) {
      var u = new st(a, s);
      return Om(u, t);
    } else {
      var l = c2(a, s, o), c = mo(zr, Xt(l.toVector3().toArray()).concat([l.distanceTo(a)]));
      return n(c);
    }
  }
  if (e instanceof st) {
    var f = Om(e, t), h = rr(f, 2), d = h[0], g = h[1];
    return [d, g];
  }
  return e instanceof zr || e instanceof Di ? n(e) : [];
}
function j5(e, t, r, n, i) {
  var a = Nm(e, r, n), s = Nm(t, r, i), o = [], u = Im(a), l;
  try {
    for (u.s(); !(l = u.n()).done; ) {
      var c = l.value, f = Im(s), h;
      try {
        var d = function() {
          var v = h.value, m = [], p = c instanceof zr && v instanceof zr ? Ie.Intersect.kOnBothOperands : Ie.Intersect.kExtendBoth, y = c.IntersectWith(v, p);
          y.forEach(function(w) {
            m.push(w);
          }), o.push.apply(o, m);
        };
        for (f.s(); !(h = f.n()).done; )
          d();
      } catch (g) {
        f.e(g);
      } finally {
        f.f();
      }
    }
  } catch (g) {
    u.e(g);
  } finally {
    u.f();
  }
  return o;
}
var Um = function(t) {
  var r = rr(t, 3), n = r[0], i = r[1], a = r[2], s = n.x, o = n.y, u = n.z, l = i.x, c = i.y, f = i.z, h = a.x, d = a.y, g = a.z, v = o * f - c * u - o * g + d * u + c * g - d * f, m = -(s * f - l * u - s * g + h * u + l * g - h * f), p = s * c - l * o - s * d + h * o + l * d - h * c, y = -(s * c * g - s * d * f - l * o * g + l * d * u + h * o * f - h * c * u), w = 2 * (l - s), x = 2 * (c - o), b = 2 * (f - u), M = s * s + o * o + u * u - l * l - c * c - f * f, k = 2 * (h - s), E = 2 * (d - o), S = 2 * (g - u), F = s * s + o * o + u * u - h * h - d * d - g * g, O = -(m * b * F - m * S * M - x * p * F + x * S * y + E * p * M - E * b * y) / (v * x * S - v * E * b - w * m * S + w * E * p + k * m * b - k * x * p), D = (v * b * F - v * S * M - w * p * F + w * S * y + k * p * M - k * b * y) / (v * x * S - v * E * b - w * m * S + w * E * p + k * m * b - k * x * p), _ = -(v * x * F - v * E * M - w * m * F + w * E * y + k * m * M - k * x * y) / (v * x * S - v * E * b - w * m * S + w * E * p + k * m * b - k * x * p);
  return new te(O, D, _);
};
function Jv() {
  return Pd.apply(this, arguments);
}
function Pd() {
  return Pd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v;
    return be.wrap(function(p) {
      for (; ; ) switch (p.prev = p.next) {
        case 0:
          t = new Zt(), r = new zr(), n = ie.getCurrentMxCAD().getCurrentDatabaseDrawColor(), r.trueColor = new fr(n), d = new vr(), d.AddMcDbEntityTypes("ARC,LINE,LWPOLYLINE,CIRCLE"), g = /* @__PURE__ */ be.mark(function y() {
            var w, x, b, M, k, E, S, F, O, D, _, L, G, V, H, U, R, B, C, Z, W, J, Q, j, q, ae;
            return be.wrap(function($) {
              for (; ; ) switch ($.prev = $.next) {
                case 0:
                  if (typeof i == "undefined" && (t.setKeyWords("[(3P)/(2P)/(T)]"), i = "default"), i !== "default") {
                    $.next = 47;
                    break;
                  }
                  if (s) {
                    $.next = 19;
                    break;
                  }
                  return t.setMessage(`
`), $.next = 6, t.go();
                case 6:
                  if (w = $.sent, !t.isKeyWordPicked("3P")) {
                    $.next = 10;
                    break;
                  }
                  return i = "3P", $.abrupt("return", 0);
                case 10:
                  if (!t.isKeyWordPicked("2P")) {
                    $.next = 13;
                    break;
                  }
                  return i = "2P", $.abrupt("return", 0);
                case 13:
                  if (!t.isKeyWordPicked("T")) {
                    $.next = 16;
                    break;
                  }
                  return i = "T", $.abrupt("return", 0);
                case 16:
                  if (w) {
                    $.next = 18;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 18:
                  s = w;
                case 19:
                  if (o) {
                    $.next = 44;
                    break;
                  }
                  return x = new cr(), x.setBasePt(s), typeof a == "undefined" && (x.setKeyWords("[(D)]"), a = !0), x.setMessage(Ot("McDbCircle_Radius", "" + (a ? "" : ""))), x.setUserDraw(function(se, ve) {
                    if (s) {
                      var me = new zr(s.x, s.y, s.z, a ? s.distanceTo(se) : s.distanceTo(se) / 2);
                      ve.drawMcDbEntity(me), ve.drawLine(me.center.toVector3(), se.toVector3());
                    }
                  }), $.next = 27, x.go();
                case 27:
                  if (b = $.sent, !x.isKeyWordPicked("D")) {
                    $.next = 40;
                    break;
                  }
                  return a = !1, x.clearLastInputPoint(), x.setBasePt(s), x.setMessage(Ot("McDbCircle_Diameter", "")), x.setKeyWords(""), $.next = 36, x.go();
                case 36:
                  if (M = $.sent, M) {
                    $.next = 39;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 39:
                  o = M / 2;
                case 40:
                  if (o) {
                    $.next = 44;
                    break;
                  }
                  if (b) {
                    $.next = 43;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 43:
                  o = b;
                case 44:
                  return r.center = s, r.radius = o, $.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(r, !0)
                  });
                case 47:
                  if (i !== "3P") {
                    $.next = 77;
                    break;
                  }
                  if (u) {
                    $.next = 56;
                    break;
                  }
                  return t.setMessage(""), t.setKeyWords(""), $.next = 53, t.go();
                case 53:
                  if (u = $.sent, u) {
                    $.next = 56;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 56:
                  if (l) {
                    $.next = 65;
                    break;
                  }
                  return t.setMessage(""), t.setKeyWords(""), t.setUserDraw(function(se, ve) {
                    u && ve.drawLine(u.toVector3(), se.toVector3());
                  }), $.next = 62, t.go();
                case 62:
                  if (l = $.sent, l) {
                    $.next = 65;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 65:
                  if (c) {
                    $.next = 74;
                    break;
                  }
                  return t.setMessage(""), t.setKeyWords(""), t.setUserDraw(function(se, ve) {
                    if (u && l) {
                      var me = Um([u, l, se]);
                      if (me) {
                        var Ae = new zr(me.x, me.y, me.z, me.distanceTo(u));
                        ve.drawMcDbEntity(Ae);
                      }
                    }
                  }), $.next = 71, t.go();
                case 71:
                  if (c = $.sent, c) {
                    $.next = 74;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 74:
                  return k = Um([u, l, c]), E = new zr(k.x, k.y, k.z, k.distanceTo(u)), $.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(E, !0)
                  });
                case 77:
                  if (i !== "2P") {
                    $.next = 98;
                    break;
                  }
                  if (f) {
                    $.next = 86;
                    break;
                  }
                  return t.setMessage(""), t.setKeyWords(""), $.next = 83, t.go();
                case 83:
                  if (f = $.sent, f) {
                    $.next = 86;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 86:
                  if (h) {
                    $.next = 95;
                    break;
                  }
                  return t.setMessage(""), t.setKeyWords(""), t.setUserDraw(function(se, ve) {
                    f && (s = new te((se.x + f.x) / 2, (se.y + f.y) / 2, (se.z + f.z) / 2), o = s.distanceTo(f), ve.drawMcDbEntity(new zr(s.x, s.y, s.z, o)));
                  }), $.next = 92, t.go();
                case 92:
                  if (h = $.sent, h) {
                    $.next = 95;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 95:
                  return s = new te((h.x + f.x) / 2, (h.y + f.y) / 2, (h.z + f.z) / 2), o = s.distanceTo(f), $.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(new zr(s.x, s.y, s.z, o), !0)
                  });
                case 98:
                  if (i !== "T") {
                    $.next = 156;
                    break;
                  }
                  return t.setMessage(""), t.setKeyWords(""), $.next = 103, t.go();
                case 103:
                  if (S = $.sent, S) {
                    $.next = 106;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 106:
                  if (F = Bt.findEntAtPoint(S.x, S.y, S.z, -1, d), O = F.getMcDbCurve(), O) {
                    $.next = 110;
                    break;
                  }
                  return $.abrupt("return", 0);
                case 110:
                  return t.setMessage(""), t.clearLastInputPoint(), $.next = 114, t.go();
                case 114:
                  if (D = $.sent, D) {
                    $.next = 117;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 117:
                  if (_ = Bt.findEntAtPoint(D.x, D.y, D.z, -1, d), L = _.getMcDbCurve(), L) {
                    $.next = 121;
                    break;
                  }
                  return $.abrupt("return", 0);
                case 121:
                  return G = new cr(), G.setMessage(""), $.next = 125, G.go();
                case 125:
                  if (V = $.sent, V) {
                    $.next = 128;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 128:
                  if (H = j5(O, L, V, S, D), !(!H || H.length === 0)) {
                    $.next = 131;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 131:
                  if (H.length !== 1) {
                    $.next = 137;
                    break;
                  }
                  return U = rr(H, 1), R = U[0], B = new zr(R.x, R.y, R.z, V), $.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(B)
                  });
                case 137:
                  return C = new Zt(), C.clearLastInputPoint(), C.setMessage(""), Z = function(ve) {
                    var me = H.map(function(Ee) {
                      return Ee.distanceTo(ve);
                    }), Ae = Math.min.apply(Math, Xt(me)), Ce = me.indexOf(Ae);
                    return H[Ce];
                  }, C.setUserDraw(function(se, ve) {
                    var me = Z(se);
                    ve.drawCircle(me.toVector3(), V);
                  }), $.next = 144, C.go();
                case 144:
                  if (W = $.sent, C.getStatus() !== Gt.kCancel) {
                    $.next = 147;
                    break;
                  }
                  return $.abrupt("return", {
                    v: void 0
                  });
                case 147:
                  if (W) {
                    $.next = 153;
                    break;
                  }
                  return J = rr(H, 1), Q = J[0], j = new zr(Q.x, Q.y, Q.z, V), $.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(j)
                  });
                case 153:
                  return q = Z(W), ae = new zr(q.x, q.y, q.z, V), $.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(ae)
                  });
                case 156:
                case "end":
                  return $.stop();
              }
            }, y);
          });
        case 7:
          return p.delegateYield(g(), "t0", 9);
        case 9:
          if (v = p.t0, v !== 0) {
            p.next = 12;
            break;
          }
          return p.abrupt("continue", 7);
        case 12:
          if (!v) {
            p.next = 14;
            break;
          }
          return p.abrupt("return", v.v);
        case 14:
          p.next = 7;
          break;
        case 16:
        case "end":
          return p.stop();
      }
    }, e);
  })), Pd.apply(this, arguments);
}
Ue.on("init", function() {
  Ue.addCommand("Mx_Circle", Jv);
});
var Ll = null;
function Qv() {
  return Bd.apply(this, arguments);
}
function Bd() {
  return Bd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c;
    return be.wrap(function(h) {
      for (; ; ) switch (h.prev = h.next) {
        case 0:
          return t = new Zt(), t.setLastInputPoint, t.setMessage(`
:`), h.next = 5, t.go();
        case 5:
          if (r = h.sent, n = r, t.getDetailedResult() === dn.kMouseRightIn && (r = Ll), r) {
            h.next = 10;
            break;
          }
          return h.abrupt("return");
        case 10:
          t.setMessage(`
:`), i = 0, a = [];
        case 13:
          return i >= 2 ? t.setKeyWords("[(E)/(C)/(U)]") : i > 0 ? t.setKeyWords("[(E)/(U)]") : t.setKeyWords(""), t.setBasePt(r), h.next = 18, t.go();
        case 18:
          if (s = h.sent, !t.isKeyWordPicked("C")) {
            h.next = 26;
            break;
          }
          return Ll = r, o = new st(n, r), ie.getCurrentMxCAD().drawEntity(o), h.abrupt("return");
        case 26:
          if (!t.isKeyWordPicked("E")) {
            h.next = 30;
            break;
          }
          return h.abrupt("return");
        case 30:
          if (!t.isKeyWordPicked("U")) {
            h.next = 40;
            break;
          }
          if (a.length != 0) {
            h.next = 33;
            break;
          }
          return h.abrupt("continue", 13);
        case 33:
          return u = a[a.length - 1], a.pop(), i--, r = u.prvPoint, Ll = r, u.id.erase(), h.abrupt("continue", 13);
        case 40:
          if (s) {
            h.next = 42;
            break;
          }
          return h.abrupt("return");
        case 42:
          l = new st(r, s), i++, c = ie.getCurrentMxCAD().drawEntity(l), a.push({
            id: c,
            prvPoint: r
          }), r = s, Ll = s, h.next = 13;
          break;
        case 50:
        case "end":
          return h.stop();
      }
    }, e);
  })), Bd.apply(this, arguments);
}
function X5() {
  return Ld.apply(this, arguments);
}
function Ld() {
  return Ld = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r;
    return be.wrap(function(i) {
      for (; ; ) switch (i.prev = i.next) {
        case 0:
          t = new Zt(), t.setMessage("");
        case 2:
          return t.clearLastInputPoint(), i.next = 6, t.go();
        case 6:
          if (r = i.sent, r != null) {
            i.next = 9;
            break;
          }
          return i.abrupt("break", 12);
        case 9:
          ie.getCurrentMxCAD().drawEntity(new Tu(r)), i.next = 2;
          break;
        case 12:
        case "end":
          return i.stop();
      }
    }, e);
  })), Ld.apply(this, arguments);
}
function q5() {
  return Fd.apply(this, arguments);
}
function Fd() {
  return Fd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a;
    return be.wrap(function(o) {
      for (; ; ) switch (o.prev = o.next) {
        case 0:
          return t = new Zt(), t.setMessage(`
:`), o.next = 4, t.go();
        case 4:
          if (r = o.sent, r) {
            o.next = 7;
            break;
          }
          return o.abrupt("return");
        case 7:
          t.setMessage(`
:`), n = new Xr(), n.append(r);
        case 10:
          return t.setBasePt(r), n.length() == 1 ? t.setUseBasePt(!0) : (t.setUseBasePt(!1), t.setUserDraw(function(u, l) {
            var c = new Xr();
            c.copy(n), c.append(u);
            var f = new Eo();
            f.setFitPoints({
              degree: 3,
              fitTolerance: 1e-6,
              tangentsExist: !1,
              startTangent: Ve.kIdentity,
              endTangent: Ve.kIdentity,
              fitPoints: c
            }), l.drawMcDbEntity(f);
          })), o.next = 15, t.go();
        case 15:
          if (i = o.sent, i) {
            o.next = 18;
            break;
          }
          return o.abrupt("break", 22);
        case 18:
          n.append(i), r = i, o.next = 10;
          break;
        case 22:
          n.length() > 2 && (a = new Eo(), a.setFitPoints({
            degree: 3,
            fitTolerance: 1e-6,
            tangentsExist: !1,
            startTangent: Ve.kIdentity,
            endTangent: Ve.kIdentity,
            fitPoints: n
          }), ie.getCurrentMxCAD().drawEntity(a));
        case 23:
        case "end":
          return o.stop();
      }
    }, e);
  })), Fd.apply(this, arguments);
}
Ue.on("init", function() {
  Ue.addCommand("Mx_Line", Qv), Ue.addCommand("Mx_Point", X5), Ue.addCommand("Mx_About", Kv), Ue.addCommand("Mx_Spline", q5);
});
function O1() {
  return Id.apply(this, arguments);
}
function Id() {
  return Id = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v, m;
    return be.wrap(function(y) {
      for (; ; ) switch (y.prev = y.next) {
        case 0:
          return a = function() {
            var x = new Ia();
            return x.textHeight = t || 100, x.contents = r || "", x.location = n || new te(), x.trueColor = new fr(ie.getCurrentMxCAD().getCurrentDatabaseDrawColor()), x.rotation = i || 0, x;
          }, s = new $f(), s.setMessage(""), y.next = 5, s.go();
        case 5:
          if (o = y.sent, o) {
            y.next = 8;
            break;
          }
          return y.abrupt("return");
        case 8:
          return r = o, u = new Zt(), u.clearLastInputPoint(), u.setMessage(""), u.setUserDraw(function(w, x) {
            n = w, x.drawMcDbEntity(a());
          }), y.next = 15, u.go();
        case 15:
          if (l = y.sent, l) {
            y.next = 18;
            break;
          }
          return y.abrupt("return");
        case 18:
          return n = l, c = new cr(), c.setBasePt(n), c.setMessage(Ot("Mx_Text_Height", "")), c.setUserDraw(function(w, x) {
            n && (t = w.distanceTo(n)), x.drawMcDbEntity(a());
          }), y.next = 25, c.go();
        case 25:
          if (f = y.sent, f) {
            y.next = 28;
            break;
          }
          return y.abrupt("return");
        case 28:
          return t = f, h = new Qi(), h.setBasePt(n), h.clearLastInputPoint(), h.setMessage(Ot("Mx_MText_Angle", "")), h.setUserDraw(function(w, x) {
            n && (i = Rr(w.x, w.y, n.x, n.y)), x.drawMcDbEntity(a());
          }), y.next = 36, h.go();
        case 36:
          return d = y.sent, d !== null && h.getDetailedResult() === 8 && (i = d), g = a(), v = ie.getCurrentMxCAD(), m = v.drawEntity(g), v.updateDisplay(), y.abrupt("return", m);
        case 43:
        case "end":
          return y.stop();
      }
    }, e);
  })), Id.apply(this, arguments);
}
function cs(e, t, r) {
  if (e.isEqualTo(t)) return 0;
  var n = e.c().addvec(t.c().sub(e).mult(0.5)), i = t.c().sub(e);
  i.rotateBy(Math.PI / 2, Ve.kZAxis);
  var a = new st(n, n.c().addvec(i)), s = r.c();
  s.rotateBy(Math.PI / 2, Ve.kZAxis);
  var o = new st(e, e.c().addvec(s)), u = a.IntersectWith(o, Ie.Intersect.kExtendBoth);
  if (u.isEmpty()) return 0;
  var l = u.at(0), c = l.distanceTo(e);
  i.normalize(), i.mult(c);
  var f = l.c().addvec(i), h = l.c().subvec(i), d = f.c().sub(e), g = h.c().sub(e), v = f;
  return d.angleTo1(r) > g.angleTo1(r) && (v = h), Bt.calcBulge(e, v, t).val;
}
function e0() {
  return Rd.apply(this, arguments);
}
function Rd() {
  return Rd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v, m, p, y, w, x;
    return be.wrap(function(M) {
      for (; ; ) switch (M.prev = M.next) {
        case 0:
          return t = new Zt(), t.setMessage(`
:`), M.next = 4, t.go();
        case 4:
          if (r = M.sent, r !== null) {
            M.next = 7;
            break;
          }
          return M.abrupt("return");
        case 7:
          n = [], i = 0, a = {}, a.dStartWidth = i, a.dEndWidth = i, a.pt = r, a.dBulge = 0, n.push(a), s = !1, o = !0, u = !1, l = i, c = i, f = [], h = ie.getCurrentMxCAD(), Ue.acutPrintf(`
  {0}`, i + ""), d = !1, g = function(E) {
            E.key === "Control" && (d = !0);
          }, v = function() {
            return d = !1;
          }, window.addEventListener("keydown", g), window.addEventListener("keyup", v), m = /* @__PURE__ */ be.mark(function k() {
            var E, S, F, O, D, _, L, G, V, H, U, R, B, C, Z, W, J, Q, j, q, ae, pe, $, se, ve, me, Ae, Ce, Ee, Y, ee, Me, ye, De, Se, fe, ke, ne, Te, I, A, T, P, z, K, oe, ce, ge, Oe, Ge, We, $e, pt, tt, xt, ht, Vt, qe, ze, He, Ht, mt, vt, Ct, Rt, St, zt, nr, ir, ar, gt, Dt, Jt, dr, N, X, ue, we, Le, Ke, Re, at, Ne, Ye, Tt, kt, Mt, je, Xe, Lt, Ut, gr, yt, ct, pr, Gr, yr, Qr, jt, Cr, en, Kn, Gi, di, yn, bn, pi, Xa, Zn, Jn, Ss, da, Qn, on, un, ln, vi, Rn, On, ks, ei, zi, Cs, wn, Ds, pa, xn, _s, Ps, El, uh, Bs, qa, Al, $a, Tl;
            return be.wrap(function(he) {
              for (; ; ) switch (he.prev = he.next) {
                case 0:
                  if (!o) {
                    he.next = 107;
                    break;
                  }
                  return E = Ot("ID_ARX_PL2", ":"), S = "[(A)/(W)/(L)/(H)]", n.length >= 3 ? u ? S = "[(U)/(A)/(W)/(L)/(H)]" : S = "[(U)/(A)/(W)/(L)/(H)/(C)]" : n.length >= 2 && (S = "[(U)/(A)/(W)/(H)/(L)]"), F = new Zt(), F.setMessage(E), F.setKeyWords(S), O = n[n.length - 1], F.setUserDraw(function(Ft, $t) {
                    var _t = new ot();
                    _t.addVertexAt(O.pt, O.dBulge, O.dStartWidth, O.dEndWidth), _t.addVertexAt(Ft), $t.drawMcDbEntity(_t);
                  }), he.next = 11, F.go();
                case 11:
                  if (D = he.sent, D === null) {
                    he.next = 22;
                    break;
                  }
                  _ = {}, _.dStartWidth = l, _.dEndWidth = c, _.pt = D, _.dBulge = 0, n.push(_), n.length >= 2 && (L = new ot(), L.addVertexAt(n[n.length - 2].pt, 0, n[n.length - 2].dStartWidth, n[n.length - 2].dEndWidth), L.addVertexAt(n[n.length - 1].pt), f.push(h.drawEntity(L))), he.next = 105;
                  break;
                case 22:
                  if (F.getStatus() != Gt.kKeyWord) {
                    he.next = 104;
                    break;
                  }
                  if (!F.isKeyWordPicked("A")) {
                    he.next = 27;
                    break;
                  }
                  o = !1, he.next = 102;
                  break;
                case 27:
                  if (!F.isKeyWordPicked("W")) {
                    he.next = 49;
                    break;
                  }
                  return G = new cr(), G.setMessage(Ot("ID_ARX_PLGETSTARTWIDTH", "")), he.next = 32, G.go();
                case 32:
                  if (V = he.sent, V !== null) {
                    he.next = 35;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 35:
                  return l = G.value(), G.setMessage(Ot("ID_ARX_PLGETVERITXWIDTH", "")), he.next = 39, G.go();
                case 39:
                  if (V = he.sent, V !== null) {
                    he.next = 42;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 42:
                  c = G.value(), i = c, n[n.length - 1].dStartWidth = l, n[n.length - 1].dEndWidth = c, l = c, he.next = 102;
                  break;
                case 49:
                  if (!F.isKeyWordPicked("H")) {
                    he.next = 71;
                    break;
                  }
                  return H = new cr(), H.setMessage(Ot("ID_ARX_PLGETSTARTWIDTH", "")), he.next = 54, H.go();
                case 54:
                  if (U = he.sent, U !== null) {
                    he.next = 57;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 57:
                  return l = H.value() * 2, H.setMessage(Ot("ID_ARX_PLGETVERITXWIDTH", "")), he.next = 61, H.go();
                case 61:
                  if (U = he.sent, U !== null) {
                    he.next = 64;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 64:
                  c = H.value() * 2, i = c, n[n.length - 1].dStartWidth = l, n[n.length - 1].dEndWidth = c, l = c, he.next = 102;
                  break;
                case 71:
                  if (!F.isKeyWordPicked("C")) {
                    he.next = 76;
                    break;
                  }
                  return s = !0, he.abrupt("return", 0);
                case 76:
                  if (!F.isKeyWordPicked("U")) {
                    he.next = 80;
                    break;
                  }
                  n.length > 1 && (n.pop(), f[f.length - 1].erase(), f.pop(), n.length > 0 && F.setLastInputPoint(n[n.length - 1].pt)), he.next = 102;
                  break;
                case 80:
                  if (!F.isKeyWordPicked("L")) {
                    he.next = 102;
                    break;
                  }
                  return B = Ve.kXAxis, F.setMessage(""), F.setKeyWords(""), he.next = 86, F.go();
                case 86:
                  if (Z = he.sent, Z) {
                    he.next = 89;
                    break;
                  }
                  return he.abrupt("return", {
                    v: void 0
                  });
                case 89:
                  W = n[n.length - 1].pt, J = Z.distanceTo(W), Q = (R = n[n.length - 2]) === null || R === void 0 ? void 0 : R.pt, Q && (B = Q.sub(W)), C = W.clone().addvec(B.normalize().mult(-J)), j = {}, j.dStartWidth = l, j.dEndWidth = c, j.pt = C, j.dBulge = 0, n.push(j), F.setLastInputPoint(C), n.length >= 2 && (q = new ot(), q.addVertexAt(n[n.length - 2].pt, 0, n[n.length - 2].dStartWidth, n[n.length - 2].dEndWidth), q.addVertexAt(n[n.length - 1].pt), f.push(h.drawEntity(q)));
                case 102:
                  he.next = 105;
                  break;
                case 104:
                  return he.abrupt("return", 0);
                case 105:
                  he.next = 495;
                  break;
                case 107:
                  return ae = Ot("NO1_ID_ARX_PL5", "( Ctrl )"), pe = "[(A)/(S)/(CE)/(D)/(L)/(R)/(W)/(H)]", n.length >= 3 ? u ? pe = "[(A)/(S)/(CE)/(D)/(U)/(L)/(R)/(W)/(H)]" : pe = "[(A)/(S)/(CE)/(D)/(U)/(L)/(R)/(W)/(H)/(C)]" : n.length >= 2 && (pe = "[(A)/(S)/(CE)/(D)/(U)/(L)/(R)/(W)/(H)]"), $ = new Zt(), $.setMessage(ae), $.setKeyWords(pe), se = new Ve(), n.length < 2 ? se.copy(Ve.kXAxis) : (ve = n.length, me = n[ve - 2].pt, Ae = n[ve - 2].dBulge, Ce = n[ve - 1].pt, Xf(Ae) ? se = new te(Ce.x, Ce.y, 0).sub(new te(me.x, me.y, 0)) : (Ee = new ot(), Ee.addVertexAt(me, Ae), Ee.addVertexAt(Ce), Y = Ee.getFirstDeriv(new te(Ce.x, Ce.y, 0)), Y.ret ? se = Y.val : se.copy(Ve.kXAxis))), ee = n[n.length - 1], $.setUserDraw(function(Ft, $t) {
                    var _t = cs(ee.pt, Ft, d ? se.clone().negate() : se), Pt = new ot();
                    Pt.addVertexAt(ee.pt, _t, ee.dStartWidth, ee.dEndWidth), Pt.addVertexAt(Ft), $t.drawMcDbEntity(Pt);
                  }), he.next = 119, $.go();
                case 119:
                  if (Me = he.sent, Me === null) {
                    he.next = 132;
                    break;
                  }
                  ye = {}, ye.dStartWidth = l, ye.dEndWidth = c, ye.dBulge = 0, ye.pt = Me, n[n.length - 1].dBulge = cs(ee.pt, ye.pt, d ? se.clone().negate() : se), n.push(ye), De = n.length, De >= 2 && (Se = new ot(), Se.addVertexAt(n[De - 2].pt, n[De - 2].dBulge, n[De - 2].dStartWidth, n[De - 2].dEndWidth), Se.addVertexAt(n[De - 1].pt), f.push(h.drawEntity(Se))), he.next = 495;
                  break;
                case 132:
                  if ($.getStatus() != Gt.kKeyWord) {
                    he.next = 494;
                    break;
                  }
                  if (!$.isKeyWordPicked("A")) {
                    he.next = 215;
                    break;
                  }
                  return fe = new Qi(), fe.setBasePt(ee.pt), fe.setMessage(Ot("ID_ARX_PLGET_I_ANGLE", "")), he.next = 139, fe.go();
                case 139:
                  if (ke = he.sent, ke !== null) {
                    he.next = 142;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 142:
                  return $.setMessage("( Ctrl )"), $.setKeyWords("[(CE)/(R)]"), $.setLastInputPoint(ee.pt), ne = n[n.length - 1].pt, Te = function($t) {
                    var _t = Math.PI / 2 - ke / 2, Pt = new te(($t.x + ne.x) / 2, ($t.y + ne.y) / 2), Dr = Pt.distanceTo(ne), qr = Dr / Math.sin(_t), Sn = Dr / Math.tan(_t), tn = Pt.sub(ne).rotateBy(Math.PI / 2).normalize().mult(d ? -qr - Sn : qr - Sn), ti = Pt.addvec(tn);
                    return Bt.calcBulge(ne, ti, $t).val;
                  }, $.setUserDraw(function(Ft, $t) {
                    var _t = Te(Ft), Pt = new ot();
                    Pt.addVertexAt(ee.pt, _t, ee.dStartWidth, ee.dEndWidth), Pt.addVertexAt(Ft), $t.drawMcDbEntity(Pt);
                  }), he.next = 150, $.go();
                case 150:
                  if (I = he.sent, !$.isKeyWordPicked("CE")) {
                    he.next = 174;
                    break;
                  }
                  return $.setMessage(""), $.setKeyWords(""), $.setBasePt(ne), $.setUserDraw(function(Ft, $t) {
                    var _t = Ft.distanceTo(ne), Pt = Ft.addvec(Ft.sub(ne).rotateBy(ke).normalize().mult(_t)), Dr = Te(Pt), qr = new ot();
                    qr.addVertexAt(ee.pt, Dr, ee.dStartWidth, ee.dEndWidth), qr.addVertexAt(Pt), $t.drawMcDbEntity(qr);
                  }), he.next = 158, $.go();
                case 158:
                  if (A = he.sent, A) {
                    he.next = 161;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 161:
                  return T = A.distanceTo(ne), P = A.addvec(A.sub(ne).rotateBy(ke).normalize().mult(T)), z = {}, z.dStartWidth = l, z.dEndWidth = c, z.dBulge = 0, z.pt = P, n[n.length - 1].dBulge = Te(P), n.push(z), K = n.length, K >= 2 && (oe = new ot(), oe.addVertexAt(n[K - 2].pt, n[K - 2].dBulge, n[K - 2].dStartWidth, n[K - 2].dEndWidth), oe.addVertexAt(n[K - 1].pt), f.push(h.drawEntity(oe))), $.setLastInputPoint(P), he.abrupt("return", 1);
                case 174:
                  if (!$.isKeyWordPicked("R")) {
                    he.next = 204;
                    break;
                  }
                  return ce = new cr(), ce.setMessage(""), ce.setKeyWords(""), he.next = 180, ce.go();
                case 180:
                  if (ge = he.sent, typeof ge == "number") {
                    he.next = 183;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 183:
                  return Oe = ge * Math.sin(ke / 2), $.setBasePt(ne), $.setMessage("(Ctrl)"), $.setKeyWords(""), $.setUserDraw(function(Ft, $t) {
                    var _t = ne.clone().addvec(Ft.sub(ne).normalize().mult(Oe * 2)), Pt = Te(_t), Dr = new ot();
                    Dr.addVertexAt(ee.pt, Pt, ee.dStartWidth, ee.dEndWidth), Dr.addVertexAt(_t), $t.drawMcDbEntity(Dr);
                  }), he.next = 190, $.go();
                case 190:
                  if (Ge = he.sent, Ge) {
                    he.next = 193;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 193:
                  return We = ne.clone().addvec(Ge.sub(ne).normalize().mult(Oe * 2)), $e = {}, $e.dStartWidth = l, $e.dEndWidth = c, $e.dBulge = 0, $e.pt = We, n[n.length - 1].dBulge = Te(We), n.push($e), pt = n.length, pt >= 2 && (tt = new ot(), tt.addVertexAt(n[pt - 2].pt, n[pt - 2].dBulge, n[pt - 2].dStartWidth, n[pt - 2].dEndWidth), tt.addVertexAt(n[pt - 1].pt), f.push(h.drawEntity(tt))), he.abrupt("return", 1);
                case 204:
                  if (I) {
                    he.next = 206;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 206:
                  xt = {}, xt.dStartWidth = l, xt.dEndWidth = c, xt.dBulge = 0, xt.pt = I, n[n.length - 1].dBulge = Te(I), n.push(xt), ht = n.length, ht >= 2 && (Vt = new ot(), Vt.addVertexAt(n[ht - 2].pt, n[ht - 2].dBulge, n[ht - 2].dStartWidth, n[ht - 2].dEndWidth), Vt.addVertexAt(n[ht - 1].pt), f.push(h.drawEntity(Vt)));
                case 215:
                  if (!$.isKeyWordPicked("CE")) {
                    he.next = 311;
                    break;
                  }
                  return $.setMessage(""), $.setKeyWords(""), $.setUserDraw(function() {
                  }), he.next = 221, $.go();
                case 221:
                  if (qe = he.sent, qe) {
                    he.next = 224;
                    break;
                  }
                  return he.abrupt("return", {
                    v: void 0
                  });
                case 224:
                  return ze = ee.pt, He = qe.distanceTo(ze), $.setLastInputPoint(ze), $.setMessage("( Ctrl )"), $.setKeyWords("[(A)/(L)]"), $.clearLastInputPoint(), $.setUserDraw(function(Ft, $t) {
                    $t.drawLine(Ft.toVector3(), qe.toVector3());
                    var _t = qe.clone().addvec(Ft.sub(qe).normalize().mult(He)), Pt = qe.sub(ze).angleTo2(qe.sub(_t), Ve.kZAxis), Dr = new te((ze.x + _t.x) / 2, (ze.y + _t.y) / 2), qr = qe.sub(Dr).normalize().mult(-He), Sn = qe.clone().addvec((d ? Pt < Math.PI : Pt > Math.PI) ? qr.negate() : qr), tn = Bt.calcBulge(ze, Sn, _t).val, ti = new ot();
                    ti.addVertexAt(ee.pt, tn, ee.dStartWidth, ee.dEndWidth), ti.addVertexAt(_t), $t.drawMcDbEntity(ti);
                  }), he.next = 233, $.go();
                case 233:
                  if (Ht = he.sent, !$.isKeyWordPicked("A")) {
                    he.next = 261;
                    break;
                  }
                  return mt = new Qi(), mt.setBasePt(qe), mt.setMessage(Ot("ID_ARX_PLGET_I_ANGLE", "( Ctrl ")), mt.setKeyWords(""), mt.setUserDraw(function(Ft, $t) {
                    var _t = Ve.kXAxis.clone().angleTo2(Ft.sub(qe), Ve.kZAxis), Pt = d ? Math.PI * 2 - _t / 2 : _t / 2, Dr = ze.sub(qe).rotateBy(Pt).normalize().mult(He), qr = ze.sub(qe).rotateBy(_t).normalize().mult(He), Sn = qe.clone().addvec(Dr), tn = qe.clone().addvec(qr), ti = Bt.calcBulge(ze, Sn, tn).val, lh = new ot();
                    lh.addVertexAt(ee.pt, ti, ee.dStartWidth, ee.dEndWidth), lh.addVertexAt(tn), $t.drawMcDbEntity(lh);
                  }), he.next = 242, mt.go();
                case 242:
                  if (vt = he.sent, vt !== null) {
                    he.next = 245;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 245:
                  return Ct = d ? Math.PI * 2 - vt / 2 : vt / 2, Rt = ze.sub(qe).rotateBy(Ct).normalize().mult(He), St = ze.sub(qe).rotateBy(vt).normalize().mult(He), zt = qe.clone().addvec(Rt), nr = qe.clone().addvec(St), ir = Bt.calcBulge(ze, zt, nr).val, ar = {}, ar.dStartWidth = l, ar.dEndWidth = c, ar.dBulge = 0, ar.pt = nr, n[n.length - 1].dBulge = ir, n.push(ar), gt = n.length, gt >= 2 && (Dt = new ot(), Dt.addVertexAt(n[gt - 2].pt, n[gt - 2].dBulge, n[gt - 2].dStartWidth, n[gt - 2].dEndWidth), Dt.addVertexAt(n[gt - 1].pt), f.push(h.drawEntity(Dt))), he.abrupt("return", 1);
                case 261:
                  if (!$.isKeyWordPicked("L")) {
                    he.next = 292;
                    break;
                  }
                  return Jt = new cr(), Jt.setMessage("( Ctrl )"), Jt.setKeyWords(""), Jt.setBasePt(ze), Jt.setUserDraw(function(Ft, $t) {
                    var _t = Ft.distanceTo(ze);
                    if (!(_t > He * 2)) {
                      var Pt = Math.asin(_t / 2 / He) * 2, Dr = ze.sub(qe).normalize().mult(He), qr = qe.clone().addvec(Dr.clone().rotateBy(d ? Math.PI - Pt / 2 : Pt / 2)), Sn = qe.clone().addvec(Dr.clone().rotateBy(Pt)), tn = Bt.calcBulge(ze, qr, Sn).val, ti = new ot();
                      ti.addVertexAt(ee.pt, tn, ee.dStartWidth, ee.dEndWidth), ti.addVertexAt(Sn), $t.drawMcDbEntity(ti);
                    }
                  }), he.next = 269, Jt.go();
                case 269:
                  if (dr = he.sent, typeof dr == "number") {
                    he.next = 272;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 272:
                  if (!(dr > He * 2)) {
                    he.next = 276;
                    break;
                  }
                  return Ue.acutPrintf("* *"), $.setLastInputPoint(ze), he.abrupt("return", 1);
                case 276:
                  return N = Math.asin(dr / 2 / He) * 2, X = ze.sub(qe).normalize().mult(He), ue = qe.clone().addvec(X.clone().rotateBy(d ? Math.PI - N / 2 : N / 2)), we = qe.clone().addvec(X.clone().rotateBy(N)), Le = Bt.calcBulge(ze, ue, we).val, Ke = {}, Ke.dStartWidth = l, Ke.dEndWidth = c, Ke.dBulge = 0, Ke.pt = we, n[n.length - 1].dBulge = Le, n.push(Ke), Re = n.length, Re >= 2 && (at = new ot(), at.addVertexAt(n[Re - 2].pt, n[Re - 2].dBulge, n[Re - 2].dStartWidth, n[Re - 2].dEndWidth), at.addVertexAt(n[Re - 1].pt), f.push(h.drawEntity(at))), $.setLastInputPoint(we), he.abrupt("return", 1);
                case 292:
                  if (Ht) {
                    he.next = 294;
                    break;
                  }
                  return he.abrupt("return", {
                    v: void 0
                  });
                case 294:
                  return Ne = qe.clone().addvec(Ht.sub(qe).normalize().mult(He)), Ye = qe.sub(ze).angleTo2(qe.sub(Ne), Ve.kZAxis), Tt = new te((ze.x + Ne.x) / 2, (ze.y + Ne.y) / 2), kt = qe.sub(Tt).normalize().mult(-He), Mt = qe.clone().addvec((d ? Ye < Math.PI : Ye > Math.PI) ? kt.negate() : kt), je = Bt.calcBulge(ze, Mt, Ne).val, Xe = {}, Xe.dStartWidth = l, Xe.dEndWidth = c, Xe.dBulge = 0, Xe.pt = Ne, n[n.length - 1].dBulge = je, n.push(Xe), Lt = n.length, Lt >= 2 && (Ut = new ot(), Ut.addVertexAt(n[Lt - 2].pt, n[Lt - 2].dBulge, n[Lt - 2].dStartWidth, n[Lt - 2].dEndWidth), Ut.addVertexAt(n[Lt - 1].pt), f.push(h.drawEntity(Ut))), $.setLastInputPoint(Ne), he.abrupt("return", 1);
                case 311:
                  if (!$.isKeyWordPicked("R")) {
                    he.next = 383;
                    break;
                  }
                  return gr = new cr(), gr.setMessage(Ot("ID_ARX_PLGETSTARTRADIUS", "")), gr.setKeyWords(""), he.next = 317, gr.go();
                case 317:
                  if (yt = he.sent, yt !== null) {
                    he.next = 320;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 320:
                  return ct = ee.pt, $.setLastInputPoint(ct), $.setMessage("( Ctrl )"), $.setKeyWords("[(A)]"), $.setUserDraw(function(Ft, $t) {
                    if (yt) {
                      var _t = Ft.distanceTo(ct);
                      if (!(_t > yt * 2)) {
                        var Pt = Math.acos(_t / 2 / yt), Dr = ct.clone().addvec(Ft.sub(ct).rotateBy(Pt).normalize().mult(yt)), qr = Dr.clone().addvec(new te((ct.x + Ft.x) / 2, (ct.y + Ft.y) / 2).sub(Dr).normalize().mult(d ? -yt : yt)), Sn = Bt.calcBulge(ct, qr, Ft).val, tn = new ot();
                        tn.addVertexAt(ee.pt, Sn, ee.dStartWidth, ee.dEndWidth), tn.addVertexAt(Ft), $t.drawMcDbEntity(tn);
                      }
                    }
                  }), he.next = 327, $.go();
                case 327:
                  if (pr = he.sent, !$.isKeyWordPicked("A")) {
                    he.next = 363;
                    break;
                  }
                  return Gr = new Qi(), Gr.setMessage(Ot("ID_ARX_PLGET_I_ANGLE", "")), Gr.setKeyWords(""), Gr.setBasePt(ct), he.next = 335, Gr.go();
                case 335:
                  if (yr = he.sent, typeof yr == "number") {
                    he.next = 338;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 338:
                  return Qr = Math.sin(yr / 2) * yt * 2, $.setMessage("( Ctrl )"), $.setKeyWords(""), $.setBasePt(ct), $.setUserDraw(function(Ft, $t) {
                    if (yt) {
                      var _t = Ft.sub(ct).normalize(), Pt = ct.clone().addvec(_t.clone().mult(Qr)), Dr = Pt.clone().addvec(_t.clone().negate().rotateBy(-(Math.PI / 2 - yr / 2)).mult(yt)), qr = Dr.clone().addvec(Dr.sub(new te((ct.x + Pt.x) / 2, (ct.y + Pt.y) / 2)).normalize().mult(d ? yt : -yt)), Sn = Bt.calcBulge(ct, qr, Pt).val, tn = new ot();
                      tn.addVertexAt(ee.pt, Sn, ee.dStartWidth, ee.dEndWidth), tn.addVertexAt(Pt), $t.drawMcDbEntity(tn);
                    }
                  }), he.next = 345, $.go();
                case 345:
                  if (jt = he.sent, jt) {
                    he.next = 348;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 348:
                  return Cr = jt.sub(ct).normalize(), en = ct.clone().addvec(Cr.clone().mult(Qr)), Kn = en.clone().addvec(Cr.clone().negate().rotateBy(-(Math.PI / 2 - yr / 2)).mult(yt)), Gi = Kn.clone().addvec(Kn.sub(new te((ct.x + en.x) / 2, (ct.y + en.y) / 2)).normalize().mult(d ? yt : -yt)), di = Bt.calcBulge(ct, Gi, en).val, yn = {}, yn.dStartWidth = l, yn.dEndWidth = c, yn.dBulge = 0, yn.pt = en, n[n.length - 1].dBulge = di, n.push(yn), bn = n.length, bn >= 2 && (pi = new ot(), pi.addVertexAt(n[bn - 2].pt, n[bn - 2].dBulge, n[bn - 2].dStartWidth, n[bn - 2].dEndWidth), pi.addVertexAt(n[bn - 1].pt), f.push(h.drawEntity(pi))), he.abrupt("return", 1);
                case 363:
                  if (pr) {
                    he.next = 365;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 365:
                  if (Xa = pr.distanceTo(ct), !(Xa > yt * 2)) {
                    he.next = 369;
                    break;
                  }
                  return Ue.acutPrintf(" **"), he.abrupt("return", 1);
                case 369:
                  return Zn = Math.acos(Xa / 2 / yt), Jn = ct.clone().addvec(pr.sub(ct).rotateBy(Zn).normalize().mult(yt)), Ss = Jn.clone().addvec(new te((ct.x + pr.x) / 2, (ct.y + pr.y) / 2).sub(Jn).normalize().mult(d ? -yt : yt)), da = Bt.calcBulge(ct, Ss, pr).val, Qn = {}, Qn.dStartWidth = l, Qn.dEndWidth = c, Qn.dBulge = 0, Qn.pt = pr, n[n.length - 1].dBulge = da, n.push(Qn), on = n.length, on >= 2 && (un = new ot(), un.addVertexAt(n[on - 2].pt, n[on - 2].dBulge, n[on - 2].dStartWidth, n[on - 2].dEndWidth), un.addVertexAt(n[on - 1].pt), f.push(h.drawEntity(un))), he.abrupt("return", 1);
                case 383:
                  if (!$.isKeyWordPicked("H")) {
                    he.next = 404;
                    break;
                  }
                  return ln = new cr(), ln.setMessage(Ot("ID_ARX_PLGETSTARTWIDTH", "")), he.next = 388, ln.go();
                case 388:
                  if (vi = he.sent, vi !== null) {
                    he.next = 391;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 391:
                  return l = ln.value() * 2, ln.setMessage(Ot("ID_ARX_PLGETVERITXWIDTH", "")), he.next = 395, ln.go();
                case 395:
                  if (vi = he.sent, vi !== null) {
                    he.next = 398;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 398:
                  return c = ln.value() * 2, i = c, n[n.length - 1].dStartWidth = l, n[n.length - 1].dEndWidth = c, l = c, he.abrupt("return", 1);
                case 404:
                  if (!$.isKeyWordPicked("D")) {
                    he.next = 433;
                    break;
                  }
                  return $.setMessage(""), $.setKeyWords(""), $.setLastInputPoint(ee.pt), $.setUserDraw(function(Ft, $t) {
                    $t.drawLine(Ft.toVector3(), ee.pt.toVector3());
                  }), he.next = 411, $.go();
                case 411:
                  if (Rn = he.sent, Rn) {
                    he.next = 414;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 414:
                  return On = Rn.sub(ee.pt), $.setLastInputPoint(ee.pt), $.setBasePt(ee.pt), $.setMessage("( Ctrl )"), $.setKeyWords(""), $.setUserDraw(function(Ft, $t) {
                    var _t = cs(ee.pt, Ft, d ? On.clone().negate() : On), Pt = new ot();
                    Pt.addVertexAt(ee.pt, _t, ee.dStartWidth, ee.dEndWidth), Pt.addVertexAt(Ft), $t.drawMcDbEntity(Pt);
                  }), he.next = 422, $.go();
                case 422:
                  return ks = he.sent, ei = {}, ei.dStartWidth = l, ei.dEndWidth = c, ei.dBulge = 0, ei.pt = ks, n[n.length - 1].dBulge = cs(ee.pt, ei.pt, d ? On.clone().negate() : On), n.push(ei), zi = n.length, zi >= 2 && (Cs = new ot(), Cs.addVertexAt(n[zi - 2].pt, n[zi - 2].dBulge, n[zi - 2].dStartWidth, n[zi - 2].dEndWidth), Cs.addVertexAt(n[zi - 1].pt), f.push(h.drawEntity(Cs))), he.abrupt("return", 1);
                case 433:
                  if (!$.isKeyWordPicked("L")) {
                    he.next = 437;
                    break;
                  }
                  o = !0, he.next = 492;
                  break;
                case 437:
                  if (!$.isKeyWordPicked("S")) {
                    he.next = 463;
                    break;
                  }
                  return wn = new te(n[n.length - 1].pt.x, n[n.length - 1].pt.y, 0), Ds = new Zt(), Ds.setMessage(Ot("NO1_ID_SPECIFY_ARC2", "")), Ds.setBasePt(wn), he.next = 444, Ds.go();
                case 444:
                  if (pa = he.sent, pa !== null) {
                    he.next = 447;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 447:
                  return xn = new Zt(), xn.setMessage(Ot("ID_CIRCULAR_ENDPOINT", "( Ctrl )")), xn.setUserDraw(function(Ft, $t) {
                    var _t = new Di();
                    _t.computeArc(wn.x, wn.y, pa.x, pa.y, Ft.x, Ft.y);
                    var Pt = pa;
                    d && (Pt = _t.center.clone().addvec(_t.center.clone().sub(Pt)), _t.computeArc(wn.x, wn.y, Pt.x, Pt.y, Ft.x, Ft.y)), $t.drawMcDbEntity(_t);
                  }), he.next = 452, xn.go();
                case 452:
                  if (_s = he.sent, _s === null) {
                    he.next = 460;
                    break;
                  }
                  Ps = pa, d && (El = new Di(), El.computeArc(wn.x, wn.y, Ps.x, Ps.y, _s.x, _s.y), Ps = El.center.clone().addvec(El.center.clone().sub(Ps))), uh = Bt.calcBulge(wn, Ps, _s), uh.ret ? (Bs = {}, Bs.dStartWidth = l, Bs.dEndWidth = c, Bs.pt = _s, Bs.dBluge = 0, n[n.length - 1].dBulge = uh.val, n.push(Bs), qa = n.length, qa >= 2 && (Al = new ot(), Al.addVertexAt(n[qa - 2].pt, n[qa - 2].dBulge, n[qa - 2].dStartWidth, n[qa - 2].dEndWidth), Al.addVertexAt(n[qa - 1].pt), f.push(h.drawEntity(Al)))) : Ue.acutPrintf(Ot("ID_ENDPOINT_INVALID1", `
  **`)), he.next = 461;
                  break;
                case 460:
                  return he.abrupt("return", 0);
                case 461:
                  he.next = 492;
                  break;
                case 463:
                  if (!$.isKeyWordPicked("W")) {
                    he.next = 485;
                    break;
                  }
                  return $a = new cr(), $a.setMessage(Ot("ID_ARX_PLGETSTARTWIDTH", "")), he.next = 468, $a.go();
                case 468:
                  if (Tl = he.sent, Tl !== null) {
                    he.next = 471;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 471:
                  return l = $a.value(), $a.setMessage(Ot("ID_ARX_PLGETVERITXWIDTH", "")), he.next = 475, $a.go();
                case 475:
                  if (Tl = he.sent, Tl !== null) {
                    he.next = 478;
                    break;
                  }
                  return he.abrupt("return", 0);
                case 478:
                  c = $a.value(), i = c, n[n.length - 1].dStartWidth = l, n[n.length - 1].dEndWidth = c, l = c, he.next = 492;
                  break;
                case 485:
                  if (!$.isKeyWordPicked("C")) {
                    he.next = 491;
                    break;
                  }
                  return n[n.length - 1].dBulge = cs(ee.pt, r, d ? se.clone().negate() : se), s = !0, he.abrupt("return", 0);
                case 491:
                  $.isKeyWordPicked("U") && n.length > 1 && (n.pop(), f[f.length - 1].erase(), f.pop(), n.length > 0 && $.setLastInputPoint(n[n.length - 1].pt));
                case 492:
                  he.next = 495;
                  break;
                case 494:
                  return he.abrupt("return", 0);
                case 495:
                case "end":
                  return he.stop();
              }
            }, k);
          });
        case 29:
          return M.delegateYield(m(), "t0", 31);
        case 31:
          if (p = M.t0, p !== 0) {
            M.next = 34;
            break;
          }
          return M.abrupt("break", 40);
        case 34:
          if (p !== 1) {
            M.next = 36;
            break;
          }
          return M.abrupt("continue", 29);
        case 36:
          if (!p) {
            M.next = 38;
            break;
          }
          return M.abrupt("return", p.v);
        case 38:
          M.next = 29;
          break;
        case 40:
          for (u && (s = !0), y = 0; y < f.length; y++)
            f[y].erase();
          if (!(n.length > 1)) {
            M.next = 47;
            break;
          }
          for (w = new ot(), x = 0; x < n.length; x++)
            w.addVertexAt(n[x].pt, n[x].dBulge, n[x].dStartWidth, n[x].dEndWidth);
          return w.isClosed = s, M.abrupt("return", h.drawEntity(w));
        case 47:
          window.removeEventListener("keydown", g), window.removeEventListener("keyup", v);
        case 49:
        case "end":
          return M.stop();
      }
    }, e);
  })), Rd.apply(this, arguments);
}
Ue.on("init", function() {
  Ue.addCommand("Mx_Pline", e0);
});
function $5() {
  var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : new te(), t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : new te(), r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 3, n = [];
  r = Math.max(3, r), n.push(t);
  for (var i = Math.PI * 2 / r, a = 1; a < r; a++) {
    var s = Math.cos(i * a), o = Math.sin(i * a), u = e.clone(), l = t.clone(), c = l.x - u.x, f = l.y - u.y, h = c * s - f * o + u.x, d = c * o + f * s + u.y, g = new te(h, d);
    n.push(g);
  }
  return n;
}
function Y5() {
  for (var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : new te(), t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : new te(), r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 3, n = t.x, i = t.y, a = e.x, s = e.y, o = Math.max(3, r), u = Math.sqrt(Math.pow(n - a, 2) + Math.pow(i - s, 2)), l = u / Math.cos(Math.PI / o), c = Math.atan2(i - s, n - a) - Math.PI / o, f = [], h = 0; h < o; h++) {
    var d = c + h * 2 * Math.PI / o, g = a + l * Math.cos(d), v = s + l * Math.sin(d);
    f.push(new te(g, v));
  }
  return f;
}
function K5(e, t, r) {
  for (var n = t.x - e.x, i = t.y - e.y, a = Math.sqrt(n * n + i * i), s = Math.atan2(i, n), o = 2 * Math.PI / Math.max(3, r), u = [e, t], l = 0; l < r; l++) {
    var c = e.x + a * Math.cos(s + l * o), f = e.y + a * Math.sin(s + l * o);
    e = new te(c, f), u.push(e);
  }
  return u;
}
function t0() {
  return Od.apply(this, arguments);
}
function Od() {
  return Od = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g;
    return be.wrap(function(m) {
      for (; ; ) switch (m.prev = m.next) {
        case 0:
          if (o = new Zt(), t) {
            m.next = 11;
            break;
          }
          return u = new qf(), u.setMessage(`
 <5>`), m.next = 6, u.go();
        case 6:
          if (t = m.sent, u.getStatus() !== Gt.kCancel) {
            m.next = 9;
            break;
          }
          return m.abrupt("return");
        case 9:
          u.getStatus() === Gt.kNone && (t = 5), u.clearLastInputPoint();
        case 11:
          l = /* @__PURE__ */ function() {
            var p = ut(/* @__PURE__ */ be.mark(function y() {
              var w;
              return be.wrap(function(b) {
                for (; ; ) switch (b.prev = b.next) {
                  case 0:
                    if (w = function(k) {
                      var E = new ot(), S = K5(i, k, t || 5);
                      return S.forEach(function(F) {
                        E.addVertexAt(F);
                      }), E.isClosed = !0, E;
                    }, i) {
                      b.next = 10;
                      break;
                    }
                    return o.setMessage(`
`), o.setKeyWords(""), b.next = 6, o.go();
                  case 6:
                    if (i = b.sent, i) {
                      b.next = 9;
                      break;
                    }
                    return b.abrupt("return");
                  case 9:
                    o.setUserDraw(function(M, k) {
                      k.drawMcDbEntity(w(M));
                    });
                  case 10:
                    if (a) {
                      b.next = 15;
                      break;
                    }
                    return o.setMessage(`
`), b.next = 14, o.go();
                  case 14:
                    a = b.sent;
                  case 15:
                    if (a) {
                      b.next = 17;
                      break;
                    }
                    return b.abrupt("return");
                  case 17:
                    ie.getCurrentMxCAD().drawEntity(w(a));
                  case 18:
                  case "end":
                    return b.stop();
                }
              }, y);
            }));
            return function() {
              return p.apply(this, arguments);
            };
          }();
          {
            m.next = 16;
            break;
          }
        case 15:
          return m.abrupt("return", m.sent);
        case 16:
          if (o.setMessage(`
`), o.setKeyWords("[(E)]"), o.setCursorType(Vf.kCross), r) {
            m.next = 23;
            break;
          }
          return m.next = 22, o.go();
        case 22:
          r = m.sent;
        case 23:
          if (r) {
            m.next = 28;
            break;
          }
          if (!o.isKeyWordPicked("e")) {
            m.next = 27;
            break;
          }
          return m.next = 27, l();
        case 27:
          return m.abrupt("return");
        case 28:
          if (typeof n == "boolean") {
            m.next = 38;
            break;
          }
          return o.setMessage(`
`), o.setKeyWords("[(I)/(C)]"), o.clearLastInputPoint(), m.next = 34, o.go();
        case 34:
          if (o.getStatus() !== Gt.kCancel) {
            m.next = 36;
            break;
          }
          return m.abrupt("return");
        case 36:
          o.isKeyWordPicked("i") && (n = !1), o.isKeyWordPicked("c") && (n = !0);
        case 38:
          if (c = function(y) {
            var w = ie.getCurrentMxCAD().getCurrentDatabaseDrawColor(), x = new ot();
            x.trueColor = new fr(w);
            var b = n ? Y5(r, y, t) : $5(r, y, t);
            return b.forEach(function(M) {
              x.addVertexAt(M);
            }), x.isClosed = !0, x;
          }, h = new Ve(), s) {
            m.next = 52;
            break;
          }
          return d = new cr(), d.setBasePt(r), d.setUserDraw(function(p, y) {
            y.drawMcDbEntity(c(p)), r && (h = p.sub(r));
          }), d.setMessage(Ot("McDbPolyline_Radius", `
`)), d.setKeyWords(""), m.next = 48, d.go();
        case 48:
          if (g = m.sent, g) {
            m.next = 51;
            break;
          }
          return m.abrupt("return");
        case 51:
          s = g;
        case 52:
          h = h.normalize().mult(s), f = r.clone().addvec(h), ie.getCurrentMxCAD().drawEntity(c(f), !0);
        case 55:
        case "end":
          return m.stop();
      }
    }, e);
  })), Od.apply(this, arguments);
}
Ue.addCommand("Mx_Polygon", t0);
function Z5(e, t, r, n, i, a) {
  var s = r - e, o = n - t, u = i / a, l = s * Math.cos(u) - o * Math.sin(u), c = s * Math.sin(u) + o * Math.cos(u);
  return l += e, c += t, new te(l, c);
}
function J5(e, t, r) {
  var n = Math.sqrt(Math.pow(r, 2) - (Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)) / 4), i = {
    x: (e.x + t.x) / 2,
    y: (e.y + t.y) / 2
  };
  return new te(i.x - n * (t.y - e.y) / Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)), i.y - n * (e.x - t.x) / Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)));
}
function Q5(e, t, r, n) {
  var i = {
    x: t.x - e.x,
    y: t.y - e.y
  }, a = {
    x: r.x - e.x,
    y: r.y - e.y
  }, s = Math.atan2(i.y, i.x), o = Math.atan2(a.y, a.x), u = o - s;
  u < 0 && (u += 2 * Math.PI);
  var l = n + u;
  return l;
}
function e3(e, t, r, n) {
  var i = t + r;
  return new te(e.x + n * Math.cos(i), e.y + n * Math.sin(i));
}
function Gm(e, t, r) {
  var n = Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2)), i = {
    x: t.x - e.x,
    y: t.y - e.y
  }, a = {
    x: r.x - e.x,
    y: r.y - e.y
  }, s = i.x * a.x + i.y * a.y, o = i.x * a.y - i.y * a.x, u = Math.atan2(o, s), l = 2 * n * Math.sin(u / 2);
  return l;
}
function r0() {
  return Nd.apply(this, arguments);
}
function Nd() {
  return Nd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v, m, p, y, w, x, b, M, k, E, S;
    return be.wrap(function(O) {
      for (; ; ) switch (O.prev = O.next) {
        case 0:
          t = ie.getCurrentMxCAD(), r = new Zt(), n = new Di(), f = function() {
          }, h = `
:`, d = "[(C)]", g = !1, v = function(_) {
            _.ctrlKey && (g = !0);
          }, m = function() {
            g = !1;
          }, p = function() {
            window.removeEventListener("keydown", v), window.removeEventListener("keyup", m), window.addEventListener("keydown", v), window.addEventListener("keyup", m);
          }, y = new st(), w = new fr(), w.setRGB(255, 211, 13), y.trueColor = w, y.linetype = "ACAD_ISO02W100", x = !1, M = function(_, L) {
            g ? (n.startAngle = l, n.endAngle = u) : (n.startAngle = u, n.endAngle = l), n.radius = c, n.center = o, y.endPoint = _, L.drawMcDbEntity(n), L.drawMcDbEntity(y);
          }, k = function(_) {
            n.computeArc(i.x, i.y, a.x, a.y, s.x, s.y), _.drawMcDbEntity(n);
          }, E = /* @__PURE__ */ be.mark(function D() {
            var _, L, G, V, H, U, R, B, C;
            return be.wrap(function(W) {
              for (; ; ) switch (W.prev = W.next) {
                case 0:
                  return r.setUserDraw(f), r.setMessage(h), r.setKeyWords(d), W.next = 5, r.go();
                case 5:
                  if (_ = W.sent, !r.isKeyWordPicked("C")) {
                    W.next = 30;
                    break;
                  }
                  if (b = "C", x = !0, !i) {
                    W.next = 27;
                    break;
                  }
                  return r.setMessage(`
`), r.setKeyWords(""), W.next = 14, r.go();
                case 14:
                  if (L = W.sent, L) {
                    W.next = 17;
                    break;
                  }
                  return W.abrupt("return", {
                    v: void 0
                  });
                case 17:
                  o = L, h = `
( ctrl )`, d = "[(A)/(L)/(R)]", r.setLastInputPoint(o), y.startPoint = o, c = o.distanceTo(i), f = function(Q, j) {
                    u = Rr(o.x, o.y, i.x, i.y) - Math.PI, l = Rr(o.x, o.y, Q.x, Q.y) - Math.PI, y.endPoint = Q, M(Q, j);
                  }, p(), W.next = 29;
                  break;
                case 27:
                  h = `
`, d = "";
                case 29:
                  return W.abrupt("return", 0);
                case 30:
                  if (!x) {
                    W.next = 124;
                    break;
                  }
                  if (!r.isKeyWordPicked("R")) {
                    W.next = 55;
                    break;
                  }
                  if (b !== "E") {
                    W.next = 41;
                    break;
                  }
                  return G = 0, V = /* @__PURE__ */ function() {
                    var J = ut(/* @__PURE__ */ be.mark(function Q() {
                      var j;
                      return be.wrap(function(ae) {
                        for (; ; ) switch (ae.prev = ae.next) {
                          case 0:
                            return r.setLastInputPoint(i), r.setMessage(`
( ctrl )`), r.setKeyWords(""), r.setLastInputPoint(i), y.startPoint = i, p(), f = function($, se) {
                              G < 0 ? (y.endPoint = $, se.drawMcDbEntity(y), G = 0) : (c = $.distanceTo(i), o = J5(i, s, c), u = Rr(o.x, o.y, i.x, i.y) - Math.PI, l = Rr(o.x, o.y, s.x, s.y) - Math.PI, M($, se), G = Gm(o, i, s));
                            }, r.setUserDraw(f), ae.next = 10, r.go();
                          case 10:
                            if (j = ae.sent, j) {
                              ae.next = 13;
                              break;
                            }
                            return ae.abrupt("return", !0);
                          case 13:
                            if (G = Gm(o, i, s), !(G < 0)) {
                              ae.next = 20;
                              break;
                            }
                            return Ue.acutPrintf(`
` + G), G = 0, ae.next = 19, V();
                          case 19:
                            return ae.abrupt("return", ae.sent);
                          case 20:
                            t.drawEntity(n);
                          case 21:
                          case "end":
                            return ae.stop();
                        }
                      }, Q);
                    }));
                    return function() {
                      return J.apply(this, arguments);
                    };
                  }(), W.next = 37, V();
                case 37:
                  return W.t0 = W.sent, W.abrupt("return", {
                    v: W.t0
                  });
                case 41:
                  return r.setLastInputPoint(o), r.setMessage(Ot("draw_arc_id", "<" + n.radius + ">")), r.setKeyWords(""), r.setUserDraw(function(J, Q) {
                    y.startPoint = o, y.endPoint = J, Q.drawMcDbEntity(y);
                  }), W.next = 47, r.go();
                case 47:
                  if (H = W.sent, H) {
                    W.next = 50;
                    break;
                  }
                  return W.abrupt("return", {
                    v: void 0
                  });
                case 50:
                  c = H.distanceTo(o), h = `
( ctrl )`, d = "[(A)/(L)/(R)]", p();
                case 54:
                  return W.abrupt("return", 0);
                case 55:
                  if (!r.isKeyWordPicked("A")) {
                    W.next = 74;
                    break;
                  }
                  if (!(b === "C" || b === "L")) {
                    W.next = 66;
                    break;
                  }
                  return h = "( ctrl )", d = "[(R)]", u = Math.PI + Rr(o.x, o.y, i.x, i.y), r.setLastInputPoint(o), y.startPoint = o, c || (c = o.distanceTo(i)), f = function(Q, j) {
                    var q = Rr(o.x, o.y, Q.x, Q.y) - Math.PI;
                    s = e3(o, u, q, c), l = Q5(o, i, s, u), M(Q, j);
                  }, p(), W.abrupt("return", 0);
                case 66:
                  if (b !== "E") {
                    W.next = 74;
                    break;
                  }
                  return h = "( ctrl )", d = "", r.setLastInputPoint(i), y.startPoint = i, f = function(Q, j) {
                    var q = Rr(i.x, i.y, Q.x, Q.y) - Math.PI;
                    o = l2(i, s, q), c = o.distanceTo(i), u = Rr(o.x, o.y, i.x, i.y) - Math.PI, l = Rr(o.x, o.y, s.x, s.y) - Math.PI, M(Q, j);
                  }, p(), W.abrupt("return", 0);
                case 74:
                  if (!r.isKeyWordPicked("L")) {
                    W.next = 83;
                    break;
                  }
                  return b = "L", h = `
( ctrl )`, d = "[(R)]", r.setLastInputPoint(i), y.startPoint = i, f = function(Q, j) {
                    var q = Q.distanceTo(i);
                    if (q > c * 2) {
                      y.endPoint = Q, j.drawMcDbEntity(y);
                      return;
                    }
                    s = Z5(o.x, o.y, i.x, i.y, q, n.radius), l = Rr(o.x, o.y, s.x, s.y) - Math.PI, M(Q, j);
                  }, p(), W.abrupt("return", 0);
                case 83:
                  if (!r.isKeyWordPicked("D")) {
                    W.next = 98;
                    break;
                  }
                  return r.setMessage(`
( ctrl `), r.setKeyWords(""), r.setLastInputPoint(i), y.startPoint = i, U = new ot(), p(), r.setUserDraw(function(J, Q) {
                    i = i, s = s;
                    var j = J.sub(i), q = cs(g ? i : s, g ? s : i, j);
                    U = new ot(), U.addVertexAt(i, q), U.addVertexAt(s), y.endPoint = J, Q.drawMcDbEntity(U), Q.drawMcDbEntity(y);
                  }), W.next = 93, r.go();
                case 93:
                  if (R = W.sent, R) {
                    W.next = 96;
                    break;
                  }
                  return W.abrupt("return", {
                    v: void 0
                  });
                case 96:
                  return t.drawEntity(U), W.abrupt("return", {
                    v: void 0
                  });
                case 98:
                  if (_) {
                    W.next = 100;
                    break;
                  }
                  return W.abrupt("return", {
                    v: void 0
                  });
                case 100:
                  if (b !== "L") {
                    W.next = 106;
                    break;
                  }
                  if (B = _.distanceTo(i), !(B > c * 2)) {
                    W.next = 106;
                    break;
                  }
                  return r.clearLastInputPoint(), Ue.acutPrintf(`
` + c), W.abrupt("return", 0);
                case 106:
                  if (o) {
                    W.next = 111;
                    break;
                  }
                  return o = _, h = `
`, f = function(Q, j) {
                    j.drawLine(Q.toVector3(), o.toVector3());
                  }, W.abrupt("return", 0);
                case 111:
                  if (i) {
                    W.next = 122;
                    break;
                  }
                  return i = _, u = Rr(o.x, o.y, i.x, i.y) - Math.PI, c = i.distanceTo(o), h = `
( ctrl )`, d = "[(A)/(L)/(R)]", r.setLastInputPoint(o), y.startPoint = o, f = function(Q, j) {
                    l = Rr(o.x, o.y, Q.x, Q.y) - Math.PI, M(Q, j);
                  }, p(), W.abrupt("return", 0);
                case 122:
                  return t.drawEntity(n), W.abrupt("return", {
                    v: void 0
                  });
                case 124:
                  if (!r.isKeyWordPicked("E")) {
                    W.next = 146;
                    break;
                  }
                  return b = "E", r.clearLastInputPoint(), r.setMessage(`
`), r.setKeyWords(""), y.startPoint = i, i = i, r.setUserDraw(function(J, Q) {
                    y.endPoint = J, Q.drawMcDbEntity(y);
                  }), W.next = 134, r.go();
                case 134:
                  if (C = W.sent, C) {
                    W.next = 137;
                    break;
                  }
                  return W.abrupt("return", {
                    v: void 0
                  });
                case 137:
                  return s = C, x = !0, h = `
( ctrl )`, d = "[(A)/(D)/(R)]", r.setLastInputPoint(s), y.startPoint = s, f = function(Q, j) {
                    o = Q, c = o.distanceTo(i), u = Rr(o.x, o.y, i.x, i.y) - Math.PI, l = Rr(o.x, o.y, s.x, s.y) - Math.PI, M(Q, j);
                  }, p(), W.abrupt("return", 0);
                case 146:
                  if (_) {
                    W.next = 148;
                    break;
                  }
                  return W.abrupt("return", {
                    v: void 0
                  });
                case 148:
                  if (i) {
                    W.next = 155;
                    break;
                  }
                  return i = _, h = `
`, d = "[(C)/(E)]", f = function(Q, j) {
                    j.drawLine(i.toVector3(), Q.toVector3());
                  }, r.clearLastInputPoint(), W.abrupt("return", 0);
                case 155:
                  if (a) {
                    W.next = 161;
                    break;
                  }
                  return a = _, h = `
`, d = "", f = function(Q, j) {
                    s = Q, k(j);
                  }, W.abrupt("return", 0);
                case 161:
                  return f(a, {
                    drawMcDbEntity: function(Q) {
                      ie.getCurrentMxCAD().drawEntity(Q, !0);
                    }
                  }), W.abrupt("return", {
                    v: void 0
                  });
                case 163:
                case "end":
                  return W.stop();
              }
            }, D);
          });
        case 19:
          return O.delegateYield(E(), "t0", 21);
        case 21:
          if (S = O.t0, S !== 0) {
            O.next = 24;
            break;
          }
          return O.abrupt("continue", 19);
        case 24:
          if (!S) {
            O.next = 26;
            break;
          }
          return O.abrupt("return", S.v);
        case 26:
          O.next = 19;
          break;
        case 28:
        case "end":
          return O.stop();
      }
    }, e);
  })), Nd.apply(this, arguments);
}
Ue.on("init", function() {
  Ue.addCommand("Mx_Arc", r0);
});
function n0() {
  return Ud.apply(this, arguments);
}
function Ud() {
  return Ud = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c;
    return be.wrap(function(h) {
      for (; ; ) switch (h.prev = h.next) {
        case 0:
          i = 1, a = 0, s = Math.PI * 2, o = 0, u = function() {
            var g = new xo();
            return g.center = t, g.majorAxis = r, g.minorAxis = n, g.radiusRatio = i, g.startAngle = a, g.endAngle = s, g.rotate(t, o), g;
          }, l = /* @__PURE__ */ be.mark(function d() {
            var g, v, m, p, y, w, x, b, M, k, E, S, F;
            return be.wrap(function(D) {
              for (; ; ) switch (D.prev = D.next) {
                case 0:
                  return g = new Zt(), g.setMessage(""), g.setKeyWords("[(C)]"), D.next = 5, g.go();
                case 5:
                  if (v = D.sent, m = 0, p = null, !g.isKeyWordPicked("C")) {
                    D.next = 29;
                    break;
                  }
                  return g.setMessage(""), g.setKeyWords(""), g.clearLastInputPoint(), D.next = 14, g.go();
                case 14:
                  if (y = D.sent, y) {
                    D.next = 17;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 17:
                  return t = y, g.setMessage(""), g.setBasePt(t), D.next = 22, g.go();
                case 22:
                  if (p = D.sent, p) {
                    D.next = 25;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 25:
                  r = n = t.sub(p), m = t.distanceTo(p), D.next = 42;
                  break;
                case 29:
                  if (v) {
                    D.next = 31;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 31:
                  return g.setBasePt(v), g.setMessage(""), g.setKeyWords(""), D.next = 36, g.go();
                case 36:
                  if (p = D.sent, p) {
                    D.next = 39;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 39:
                  t = new te((v.x + p.x) / 2, (v.y + p.y) / 2), r = n = v.sub(p), m = v.distanceTo(p) / 2;
                case 42:
                  return w = new cr(), w.setMessage(Ot("McDbEllipse_lengh", "")), w.setKeyWords("[(R)]"), w.setBasePt(t), w.setUserDraw(function(_, L) {
                    var G = t.distanceTo(_) / 2;
                    i = G / m;
                    var V = u();
                    L.drawMcDbEntity(V);
                  }), D.next = 49, w.go();
                case 49:
                  if (x = D.sent, !w.isKeyWordPicked("R")) {
                    D.next = 63;
                    break;
                  }
                  return w.setMessage(Ot("McDbEllipse_Rotation", "")), w.setKeyWords(""), w.setBasePt(t), w.setUserDraw(function(_, L) {
                    var G = Math.abs(_.x - t.x), V = Math.abs(_.y - t.y), H = G / (G + V);
                    i = H;
                    var U = u();
                    L.drawMcDbEntity(U);
                  }), D.next = 57, w.go();
                case 57:
                  if (b = D.sent, b) {
                    D.next = 60;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 60:
                  w.getDetailedResult() === 8 && (i = b), D.next = 67;
                  break;
                case 63:
                  if (x) {
                    D.next = 65;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 65:
                  M = x / 2, i = M / m;
                case 67:
                  if (p) {
                    D.next = 69;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 69:
                  return k = Math.atan2(r.y, r.x) - Math.PI / 2, w.setMessage(Ot("McDbEllipse_startAngle", "")), w.setKeyWords(""), w.setBasePt(t), w.setUserDraw(function(_, L) {
                    var G = Math.atan2(_.y - t.y, _.x - t.x);
                    a = (G - k + Math.PI * 2) % (Math.PI * 2);
                    var V = u();
                    L.drawMcDbEntity(V);
                  }), D.next = 76, w.go();
                case 76:
                  if (E = D.sent, E) {
                    D.next = 79;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 79:
                  return w.getDetailedResult() === 8 && (a = E), w.clearLastInputPoint(), w.setBasePt(t), w.setMessage(Ot("McDbEllipse_endAngle", "")), w.setKeyWords("[(I)]"), w.setUserDraw(function(_, L) {
                    var G = Math.atan2(_.y - t.y, _.x - t.x);
                    s = (G - k + Math.PI * 2) % (Math.PI * 2), s < a && (s += Math.PI * 2);
                    var V = u();
                    L.drawMcDbEntity(V);
                  }), D.next = 87, w.go();
                case 87:
                  if (S = D.sent, !w.isKeyWordPicked("I")) {
                    D.next = 99;
                    break;
                  }
                  return w.setMessage(Ot("McDbEllipse_IncludedAngle", "")), w.setKeyWords(""), w.setUserDraw(function(_, L) {
                    s = Rr(t.x, t.y, _.x, _.y);
                    var G = u();
                    L.drawMcDbEntity(G);
                  }), D.next = 94, w.go();
                case 94:
                  if (F = D.sent, F) {
                    D.next = 97;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 97:
                  return w.getDetailedResult() === 8 && (s = F), D.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(u())
                  });
                case 99:
                  if (S) {
                    D.next = 101;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 101:
                  return w.getDetailedResult() === 8 && (s = S), D.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(u())
                  });
                case 103:
                case "end":
                  return D.stop();
              }
            }, d);
          });
        case 6:
          return h.delegateYield(l(), "t0", 8);
        case 8:
          if (c = h.t0, !c) {
            h.next = 11;
            break;
          }
          return h.abrupt("return", c.v);
        case 11:
          h.next = 6;
          break;
        case 13:
        case "end":
          return h.stop();
      }
    }, e);
  })), Ud.apply(this, arguments);
}
function t3() {
  return Gd.apply(this, arguments);
}
function Gd() {
  return Gd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c;
    return be.wrap(function(h) {
      for (; ; ) switch (h.prev = h.next) {
        case 0:
          t = new Zt(), a = 1, s = 0, o = Math.PI * 2, t.setMessage(`
`), t.setKeyWords("[(A)/(C)]"), u = function() {
            var g = new xo();
            return g.center = r, g.majorAxis = n, g.minorAxis = i, g.radiusRatio = a, g.startAngle = s, g.endAngle = o, g;
          }, l = /* @__PURE__ */ be.mark(function d() {
            var g, v, m, p, y, w, x, b, M, k, E, S, F, O, D, _, L, G;
            return be.wrap(function(H) {
              for (; ; ) switch (H.prev = H.next) {
                case 0:
                  return g = !1, v = !1, m = !1, H.next = 5, t.go();
                case 5:
                  if (p = H.sent, !t.isKeyWordPicked("A")) {
                    H.next = 17;
                    break;
                  }
                  return t.setMessage(`
`), t.setKeyWords("[(C)]"), H.next = 11, t.go();
                case 11:
                  if (y = H.sent, t.isKeyWordPicked("C") && (m = !0), !(!y && !m)) {
                    H.next = 15;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 15:
                  y && (p = y), g = !0;
                case 17:
                  if (!(t.isKeyWordPicked("C") || m)) {
                    H.next = 27;
                    break;
                  }
                  return t.setMessage(`
`), t.setKeyWords(""), H.next = 22, t.go();
                case 22:
                  if (w = H.sent, w) {
                    H.next = 25;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 25:
                  r = p = w, v = !0;
                case 27:
                  if (!(!p && !g && !v)) {
                    H.next = 29;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 29:
                  return t.setUserDraw(function(U, R) {
                    R.drawMcDbLine(p.x, p.y, p.z, U.x, U.y, U.z);
                  }), t.setMessage(v ? `
` : `
`), t.setKeyWords(""), H.next = 34, t.go();
                case 34:
                  if (x = H.sent, x) {
                    H.next = 37;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 37:
                  return r = v ? p : new te((p.x + x.x) / 2, (p.y + x.y) / 2), b = new cr(), b.setBasePt(r), M = p.distanceTo(x) / 2, i = n = p.sub(x), k = function(R, B) {
                    var C = u(), Z = new st(r, R);
                    Z.trueColor = new fr(), Z.trueColor.setRGB(255, 255, 0), B.drawMcDbEntity(Z), B.drawMcDbEntity(C);
                  }, b.setUserDraw(function(U, R) {
                    var B = r.distanceTo(U) / 2;
                    a = B / M, k(U, R);
                  }), b.setMessage(Ot("EllipticalArc_length", "")), b.setKeyWords(""), H.next = 48, b.go();
                case 48:
                  if (E = H.sent, E) {
                    H.next = 51;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 51:
                  if (b.getDetailedResult() === dn.kCoordIn && (S = E / 2, a = S / M), b.setLastInputPoint(r), !g) {
                    H.next = 86;
                    break;
                  }
                  return b.setMessage(Ot("EllipticalArc_startAngle", "")), b.setKeyWords(""), F = Math.atan2(n.y, n.x) - Math.PI / 2, b.setUserDraw(function(U, R) {
                    var B = Math.atan2(U.y - r.y, U.x - r.x);
                    s = (B - F + Math.PI * 2) % (Math.PI * 2), k(U, R);
                  }), H.next = 60, b.go();
                case 60:
                  if (O = H.sent, O) {
                    H.next = 63;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 63:
                  return b.getDetailedResult() == dn.kCoordIn && (s = O), b.setLastInputPoint(r), b.setMessage(Ot("EllipticalArc_endAngle", "")), b.setKeyWords("[(I)]"), b.setUserDraw(function(U, R) {
                    var B = Math.atan2(U.y - r.y, U.x - r.x);
                    o = (B - F + Math.PI * 2) % (Math.PI * 2), o < s && (o += Math.PI * 2), k(U, R);
                  }), H.next = 70, b.go();
                case 70:
                  if (D = H.sent, !b.isKeyWordPicked("I")) {
                    H.next = 83;
                    break;
                  }
                  return b.setMessage(`
`), b.setKeyWords(""), b.setUserDraw(function(U, R) {
                    o = Rr(r.x, r.y, U.x, U.y) - Math.PI, k(U, R);
                  }), H.next = 77, b.go();
                case 77:
                  if (_ = H.sent, _) {
                    H.next = 80;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 80:
                  return b.getDetailedResult() === dn.kCoordIn && (o = _), L = u(), H.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(L)
                  });
                case 83:
                  if (D) {
                    H.next = 85;
                    break;
                  }
                  return H.abrupt("return", {
                    v: void 0
                  });
                case 85:
                  b.getDetailedResult() === dn.kCoordIn && (o = D);
                case 86:
                  return G = u(), H.abrupt("return", {
                    v: ie.getCurrentMxCAD().drawEntity(G)
                  });
                case 88:
                case "end":
                  return H.stop();
              }
            }, d);
          });
        case 8:
          return h.delegateYield(l(), "t0", 10);
        case 10:
          if (c = h.t0, !c) {
            h.next = 13;
            break;
          }
          return h.abrupt("return", c.v);
        case 13:
          h.next = 8;
          break;
        case 15:
        case "end":
          return h.stop();
      }
    }, e);
  })), Gd.apply(this, arguments);
}
Ue.on("init", function() {
  Ue.addCommand("Mx_EllipseArc", n0), Ue.addCommand("Mx_Ellipse", t3);
});
function i0() {
  return zd.apply(this, arguments);
}
function zd() {
  return zd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r;
    return be.wrap(function(i) {
      for (; ; ) switch (i.prev = i.next) {
        case 0:
          if (t = Bt.getCurrentSelect(), !(t.length > 0)) {
            i.next = 4;
            break;
          }
          return t.forEach(function(a) {
            a.erase();
          }), i.abrupt("return");
        case 4:
          return r = new An(), i.next = 7, r.userSelect(`
`);
        case 7:
          if (i.sent) {
            i.next = 9;
            break;
          }
          return i.abrupt("return");
        case 9:
          r.forEach(function(a) {
            a.erase();
          });
        case 10:
        case "end":
          return i.stop();
      }
    }, e);
  })), zd.apply(this, arguments);
}
function gl(e) {
  var t = void 0, r = void 0;
  if (e.forEach(function(n) {
    var i = n.getMcDbEntity();
    if (i != null) {
      var a = i.getBoundingBox();
      a.ret && (!t || !r ? (t = new THREE.Vector3(a.minPt.x, a.minPt.y, 0), r = new THREE.Vector3(a.maxPt.x, a.maxPt.y, 0)) : (t.x > a.minPt.x && (t.x = a.minPt.x), t.y > a.minPt.y && (t.y = a.minPt.y), r.x < a.maxPt.x && (r.x = a.maxPt.x), r.y < a.maxPt.y && (r.y = a.maxPt.y)));
    }
  }), t && r)
    return {
      minPt: t,
      maxPt: r
    };
}
function r3() {
  return Wd.apply(this, arguments);
}
function Wd() {
  return Wd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h;
    return be.wrap(function(g) {
      for (; ; ) switch (g.prev = g.next) {
        case 0:
          if (t = Bt.getCurrentSelect(), !(t.length > 0)) {
            g.next = 4;
            break;
          }
          return g.abrupt("break", 15);
        case 4:
          return r = new An(), g.next = 7, r.userSelect(`
`);
        case 7:
          if (g.sent) {
            g.next = 9;
            break;
          }
          return g.abrupt("return");
        case 9:
          if (t = r.getIds(), t.length != 0) {
            g.next = 12;
            break;
          }
          return g.abrupt("return");
        case 12:
          return g.abrupt("break", 15);
        case 15:
          return t.length >= 10 && (a = gl(t), a && (n = a.minPt, i = a.maxPt)), s = new Zt(), s.setMessage(`
`), g.next = 20, s.go();
        case 20:
          if (o = g.sent, o) {
            g.next = 23;
            break;
          }
          return g.abrupt("return");
        case 23:
          s.setMessage(""), s.setBasePt(o), s.setUseBasePt(!0), s.setUserDraw(function(v, m) {
            if (n && i) {
              var p = v.x - o.x, y = v.y - o.y, w = new THREE.Vector3(n.x + p, i.y + y, 0), x = new THREE.Vector3(i.x + p, n.y + y, 0), b = new THREE.Vector3(w.x, x.y, 0), M = new THREE.Vector3(x.x, w.y, 0);
              w = qt.cad2doc2(w.x, w.y, w.z), x = qt.cad2doc2(x.x, x.y, x.z), b = qt.cad2doc2(b.x, b.y, b.z), M = qt.cad2doc2(M.x, M.y, M.z), m.drawLine(M, w), m.drawLine(w, b), m.drawLine(b, x), m.drawLine(x, M);
            }
            for (var k = 0; k < t.length && k < 10; k++) {
              var E = t[k].clone();
              E && (E.move(o, v), m.drawMcDbEntity(E));
            }
          });
        case 27:
          return g.next = 30, s.go();
        case 30:
          if (u = g.sent, u) {
            g.next = 33;
            break;
          }
          return g.abrupt("return");
        case 33:
          l = 0;
        case 34:
          if (!(l < t.length)) {
            g.next = 43;
            break;
          }
          if (c = t[l].clone(), c) {
            g.next = 38;
            break;
          }
          return g.abrupt("continue", 40);
        case 38:
          f = ie.getCurrentMxCAD().drawEntity(c).getMcDbEntity(), f && (f instanceof ta ? f.needToUpdateDimBlock(!1) : f instanceof wo && (h = t[l].getMcDbEntity(), h.copyAttribute(f)), f.move(o, u));
        case 40:
          l++, g.next = 34;
          break;
        case 43:
          g.next = 27;
          break;
        case 45:
        case "end":
          return g.stop();
      }
    }, e);
  })), Wd.apply(this, arguments);
}
function n3() {
  return Vd.apply(this, arguments);
}
function Vd() {
  return Vd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f;
    return be.wrap(function(d) {
      for (; ; ) switch (d.prev = d.next) {
        case 0:
          if (t = Bt.getCurrentSelect(), !(t.length > 0)) {
            d.next = 4;
            break;
          }
          return d.abrupt("break", 15);
        case 4:
          return r = new An(), d.next = 7, r.userSelect(`
`);
        case 7:
          if (d.sent) {
            d.next = 9;
            break;
          }
          return d.abrupt("return");
        case 9:
          if (t = r.getIds(), t.length != 0) {
            d.next = 12;
            break;
          }
          return d.abrupt("return");
        case 12:
          return d.abrupt("break", 15);
        case 15:
          return t.length >= 10 && (a = gl(t), a && (n = a.minPt, i = a.maxPt)), s = new Zt(), s.setMessage(""), s.clearLastInputPoint(), d.next = 21, s.go();
        case 21:
          if (o = d.sent, o) {
            d.next = 24;
            break;
          }
          return d.abrupt("return");
        case 24:
          return s.setMessage(""), s.setBasePt(o), s.setUseBasePt(!0), u = function(v) {
            for (var m = 0; m < t.length; m++) {
              var p = t[m].getMcDbEntity();
              p && p.highlight(v);
            }
          }, u(!0), s.setUserDraw(function(g, v) {
            if (n && i) {
              var m = g.x - o.x, p = g.y - o.y, y = new THREE.Vector3(n.x + m, i.y + p, 0), w = new THREE.Vector3(i.x + m, n.y + p, 0), x = new THREE.Vector3(y.x, w.y, 0), b = new THREE.Vector3(w.x, y.y, 0);
              y = qt.cad2doc2(y.x, y.y, y.z), w = qt.cad2doc2(w.x, w.y, w.z), x = qt.cad2doc2(x.x, x.y, x.z), b = qt.cad2doc2(b.x, b.y, b.z), v.drawLine(b, y), v.drawLine(y, x), v.drawLine(x, w), v.drawLine(w, b);
            }
            for (var M = 0; M < t.length && M < 10; M++) {
              var k = t[M].clone();
              k && (o && k.move(o, g), v.drawMcDbEntity(k));
            }
          }), d.next = 32, s.go();
        case 32:
          if (l = d.sent, l) {
            d.next = 35;
            break;
          }
          return d.abrupt("return", u(!1));
        case 35:
          u(!1), c = 0;
        case 37:
          if (!(c < t.length)) {
            d.next = 46;
            break;
          }
          if (f = t[c].getMcDbObject(), f) {
            d.next = 41;
            break;
          }
          return d.abrupt("continue", 43);
        case 41:
          f.move(o, l), f instanceof ta && f.needToUpdateDimBlock(!1);
        case 43:
          c++, d.next = 37;
          break;
        case 46:
        case "end":
          return d.stop();
      }
    }, e);
  })), Vd.apply(this, arguments);
}
function i3() {
  return Hd.apply(this, arguments);
}
function Hd() {
  return Hd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d;
    return be.wrap(function(v) {
      for (; ; ) switch (v.prev = v.next) {
        case 0:
          if (t = Bt.getCurrentSelect(), !(t.length > 0)) {
            v.next = 4;
            break;
          }
          return v.abrupt("break", 15);
        case 4:
          return r = new An(), v.next = 7, r.userSelect(`
`);
        case 7:
          if (v.sent) {
            v.next = 9;
            break;
          }
          return v.abrupt("return");
        case 9:
          if (t = r.getIds(), t.length != 0) {
            v.next = 12;
            break;
          }
          return v.abrupt("return");
        case 12:
          return v.abrupt("break", 15);
        case 15:
          return a = gl(t), a && (n = a.minPt, i = a.maxPt), s = new Zt(), s.setMessage(""), v.next = 21, s.go();
        case 21:
          if (o = v.sent, o != null) {
            v.next = 24;
            break;
          }
          return v.abrupt("return");
        case 24:
          u = !1, l = 0, c = new Qi(), c.setMessage(Ot("Entity_Rotate_Angle", "")), c.setKeyWords("[(C)/(R)]"), c.setBasePt(o), c.setUseBasePt(!0), f = function(p) {
            for (var y = 0; y < t.length; y++) {
              var w = t[y].getMcDbEntity();
              w && w.highlight(p);
            }
          }, f(!0), v.prev = 33, h = /* @__PURE__ */ be.mark(function m() {
            var p, y, w, x, b, M, k, E, S, F, O, D;
            return be.wrap(function(L) {
              for (; ; ) switch (L.prev = L.next) {
                case 0:
                  return c.setUserDraw(function(G, V) {
                    var H = G, U = o, R = H.sub(U), B = R.angleTo2(Ve.kXAxis, Ve.kNegateZAxis) - l, C = new Jr();
                    if (C.setToRotation(B, Ve.kZAxis, U), n && i) {
                      var Z = new te(n.x, i.y, 0), W = new te(i.x, n.y, 0), J = new te(Z.x, W.y, 0), Q = new te(W.x, Z.y, 0);
                      Z.transformBy(C), W.transformBy(C), J.transformBy(C), Q.transformBy(C), Z = qt.cad2doc(Z), W = qt.cad2doc(W), J = qt.cad2doc(J), Q = qt.cad2doc(Q), V.drawLine(Q.toVector3(), Z.toVector3()), V.drawLine(Z.toVector3(), J.toVector3()), V.drawLine(J.toVector3(), W.toVector3()), V.drawLine(W.toVector3(), Q.toVector3());
                    }
                    C.setToRotation(B, Ve.kZAxis, U);
                    for (var j = 0; j < t.length && j < 10; j++) {
                      var q = t[j].clone();
                      q && (q.transformBy(C), V.drawMcDbEntity(q));
                    }
                  }), L.next = 3, c.go();
                case 3:
                  if (p = L.sent, !c.isKeyWordPicked("C")) {
                    L.next = 8;
                    break;
                  }
                  return u = !0, f(!1), L.abrupt("return", 0);
                case 8:
                  if (!c.isKeyWordPicked("R")) {
                    L.next = 22;
                    break;
                  }
                  return y = new cr(), y.setMessage(Ot("Entity_Rotate_Ref_Angle", ":<" + (l / (Math.PI / 180)).toFixed(3) + ">")), y.setKeyWords(""), y.setUseBasePt(!1), w = 0, y.setUserDraw(function(G) {
                    if (o) {
                      var V = G.sub(o);
                      w = V.angleTo2(Ve.kXAxis, Ve.kNegateZAxis);
                    }
                  }), L.next = 17, y.go();
                case 17:
                  if (x = L.sent, typeof x == "number") {
                    L.next = 20;
                    break;
                  }
                  return L.abrupt("return", {
                    v: f(!1)
                  });
                case 20:
                  return y.getDetailedResult() === dn.kCoordIn ? l = THREE.MathUtils.degToRad(x) : w !== 0 && (l = w), L.abrupt("return", 0);
                case 22:
                  if (typeof p == "number") {
                    L.next = 24;
                    break;
                  }
                  return L.abrupt("return", {
                    v: f(!1)
                  });
                case 24:
                  if (b = o, M = new Jr(), M.setToRotation(p - l, Ve.kZAxis, b), k = function(V) {
                    return V instanceof xr;
                  }, !u) {
                    L.next = 42;
                    break;
                  }
                  E = [], S = 0;
                case 31:
                  if (!(S < t.length)) {
                    L.next = 39;
                    break;
                  }
                  if (F = t[S].clone(), F) {
                    L.next = 35;
                    break;
                  }
                  return L.abrupt("continue", 36);
                case 35:
                  k(F) && (F.transformBy(M), E.push(ie.getCurrentMxCAD().drawEntity(F)));
                case 36:
                  S++, L.next = 31;
                  break;
                case 39:
                  return L.abrupt("return", {
                    v: E
                  });
                case 42:
                  f(!1), O = 0;
                case 44:
                  if (!(O < t.length)) {
                    L.next = 52;
                    break;
                  }
                  if (D = t[O].getMcDbObject(), D) {
                    L.next = 48;
                    break;
                  }
                  return L.abrupt("continue", 49);
                case 48:
                  D.transformBy(M);
                case 49:
                  O++, L.next = 44;
                  break;
                case 52:
                  return L.abrupt("return", {
                    v: t
                  });
                case 53:
                case "end":
                  return L.stop();
              }
            }, m);
          });
        case 35:
          return v.delegateYield(h(), "t0", 37);
        case 37:
          if (d = v.t0, d !== 0) {
            v.next = 40;
            break;
          }
          return v.abrupt("continue", 35);
        case 40:
          if (!d) {
            v.next = 42;
            break;
          }
          return v.abrupt("return", d.v);
        case 42:
          v.next = 35;
          break;
        case 44:
          v.next = 50;
          break;
        case 46:
          v.prev = 46, v.t1 = v.catch(33), f(!1), console.error(v.t1);
        case 50:
        case "end":
          return v.stop();
      }
    }, e, null, [[33, 46]]);
  })), Hd.apply(this, arguments);
}
function a3() {
  return jd.apply(this, arguments);
}
function jd() {
  return jd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v, m, p, y, w, x, b, M, k, E, S, F, O;
    return be.wrap(function(_) {
      for (; ; ) switch (_.prev = _.next) {
        case 0:
          if (t = Bt.getCurrentSelect(), !(t.length > 0)) {
            _.next = 4;
            break;
          }
          return _.abrupt("break", 15);
        case 4:
          return r = new An(), _.next = 7, r.userSelect(`
`);
        case 7:
          if (_.sent) {
            _.next = 9;
            break;
          }
          return _.abrupt("return");
        case 9:
          if (t = r.getIds(), t.length != 0) {
            _.next = 12;
            break;
          }
          return _.abrupt("return");
        case 12:
          return _.abrupt("break", 15);
        case 15:
          if (a = gl(t), a) {
            _.next = 18;
            break;
          }
          return _.abrupt("return");
        case 18:
          return n = a.minPt, i = a.maxPt, s = i.x - n.x, o = i.y - n.y, u = (s + o) / 3, u < 1e-5 && (u = 1), l = new Zt(), l.setMessage(""), _.next = 28, l.go();
        case 28:
          if (c = _.sent, c) {
            _.next = 31;
            break;
          }
          return _.abrupt("return");
        case 31:
          f = 0, h = !1, d = function(G, V) {
            if (c) {
              var H = new te(G), U = new te(c), R = H.distanceTo(U);
              if (!(R < 1e-5)) {
                f = R / u, f > 1e5 && (f = 1e5);
                var B = new Jr();
                if (B.setToScaling(f, U), n && i) {
                  var C = new te(n.x, i.y, 0), Z = new te(i.x, n.y, 0), W = new te(C.x, Z.y, 0), J = new te(Z.x, C.y, 0);
                  C.transformBy(B), Z.transformBy(B), W.transformBy(B), J.transformBy(B), C = qt.cad2doc(C), Z = qt.cad2doc(Z), W = qt.cad2doc(W), J = qt.cad2doc(J), V.drawLine(J.toVector3(), C.toVector3()), V.drawLine(C.toVector3(), W.toVector3()), V.drawLine(W.toVector3(), Z.toVector3()), V.drawLine(Z.toVector3(), J.toVector3());
                }
                B.setToScaling(f, U);
                for (var Q = 0; Q < t.length && Q < 10; Q++) {
                  var j = t[Q].clone();
                  j && (j.transformBy(B), V.drawMcDbEntity(j));
                }
              }
            }
          }, g = function(G) {
            for (var V = 0; V < t.length; V++) {
              var H = t[V].getMcDbEntity();
              H && H.highlight(G);
            }
          }, g(!0), _.prev = 36;
        case 37:
          return v = new cr(), v.setMessage(""), v.setKeyWords("[(C)/(R)]"), v.setBasePt(c), v.setUseBasePt(!0), v.setUserDraw(d), _.next = 46, v.go();
        case 46:
          if (m = _.sent, !v.isKeyWordPicked("C")) {
            _.next = 51;
            break;
          }
          return h = !0, g(!1), _.abrupt("continue", 37);
        case 51:
          if (!v.isKeyWordPicked("R")) {
            _.next = 77;
            break;
          }
          return p = new cr(), p.setMessage(""), p.setBasePt(c), _.next = 57, p.go();
        case 57:
          if (y = _.sent, y) {
            _.next = 60;
            break;
          }
          return _.abrupt("return", g(!1));
        case 60:
          return u = y, p.setMessage(""), p.setKeyWords("[(P)]"), p.setBasePt(c), p.setUserDraw(d), _.next = 67, p.go();
        case 67:
          if (w = _.sent, !p.isKeyWordPicked("P")) {
            _.next = 74;
            break;
          }
          return x = new cr(), x.setMessage(""), _.next = 73, x.go();
        case 73:
          w = _.sent;
        case 74:
          if (w) {
            _.next = 76;
            break;
          }
          return _.abrupt("return", g(!1));
        case 76:
          m = w / y;
        case 77:
          if (m) {
            _.next = 79;
            break;
          }
          return _.abrupt("return", g(!1));
        case 79:
          if (v.getDetailedResult() === dn.kCoordIn && (f = m), f > 1e5 && (f = 1e5), b = new Jr(), b.setToScaling(f, c), !h) {
            _.next = 98;
            break;
          }
          M = [], k = function(G) {
            return G instanceof xr;
          }, E = 0;
        case 87:
          if (!(E < t.length)) {
            _.next = 95;
            break;
          }
          if (S = t[E].clone(), S) {
            _.next = 91;
            break;
          }
          return _.abrupt("continue", 92);
        case 91:
          k(S) && (S.transformBy(b), M.push(ie.getCurrentMxCAD().drawEntity(S)));
        case 92:
          E++, _.next = 87;
          break;
        case 95:
          return _.abrupt("return", M);
        case 98:
          g(!1), F = 0;
        case 100:
          if (!(F < t.length)) {
            _.next = 108;
            break;
          }
          if (O = t[F].getMcDbObject(), O) {
            _.next = 104;
            break;
          }
          return _.abrupt("continue", 105);
        case 104:
          O.transformBy(b);
        case 105:
          F++, _.next = 100;
          break;
        case 108:
          return _.abrupt("return", t);
        case 109:
          _.next = 37;
          break;
        case 111:
          _.next = 117;
          break;
        case 113:
          _.prev = 113, _.t0 = _.catch(36), console.error(_.t0), g(!1);
        case 117:
        case "end":
          return _.stop();
      }
    }, e, null, [[36, 113]]);
  })), jd.apply(this, arguments);
}
function s3() {
  return Xd.apply(this, arguments);
}
function Xd() {
  return Xd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i;
    return be.wrap(function(s) {
      for (; ; ) switch (s.prev = s.next) {
        case 0:
          return t = new Zt(), t.disableAllTrace(), t.setMessage(`
`), t.setDynamicInputType(pn.kDynTip), s.next = 6, t.go();
        case 6:
          if (r = s.sent, r != null) {
            s.next = 9;
            break;
          }
          return s.abrupt("return");
        case 9:
          return n = ie.getCurrentMxCAD(), t.setUserDraw(function(o, u) {
            u.drawRect(qt.cad2doc1(r), qt.cad2doc1(o));
          }), s.next = 13, t.go();
        case 13:
          if (i = s.sent, i != null) {
            s.next = 16;
            break;
          }
          return s.abrupt("return");
        case 16:
          n.zoomW(r, i);
        case 17:
        case "end":
          return s.stop();
      }
    }, e);
  })), Xd.apply(this, arguments);
}
function o3() {
  return qd.apply(this, arguments);
}
function qd() {
  return qd = ut(/* @__PURE__ */ be.mark(function e() {
    return be.wrap(function(r) {
      for (; ; ) switch (r.prev = r.next) {
        case 0:
          ie.getCurrentMxCAD().zoomAll(!0);
        case 1:
        case "end":
          return r.stop();
      }
    }, e);
  })), qd.apply(this, arguments);
}
function u3() {
  return $d.apply(this, arguments);
}
function $d() {
  return $d = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r;
    return be.wrap(function(i) {
      for (; ; ) switch (i.prev = i.next) {
        case 0:
          t = Ue.getCurrentDraw().getViewAngle(), t += Math.PI * 0.5, r = ie.getCurrentMxCAD(), r.zoomAngle(t);
        case 4:
        case "end":
          return i.stop();
      }
    }, e);
  })), $d.apply(this, arguments);
}
var Ka, Fl = !1, Ns = !0;
function l3() {
  return Yd.apply(this, arguments);
}
function Yd() {
  return Yd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c;
    return be.wrap(function(h) {
      for (; ; ) switch (h.prev = h.next) {
        case 0:
          t = new vr(), t.AddMcDbEntityTypes("LINE,CIRCLE,LWPOLYLINE,ARC"), r = new Zt(), n = !1, i = /* @__PURE__ */ function() {
            var d = ut(/* @__PURE__ */ be.mark(function g() {
              var v, m, p, y = arguments;
              return be.wrap(function(x) {
                for (; ; ) switch (x.prev = x.next) {
                  case 0:
                    v = y.length > 0 && y[0] !== void 0 ? y[0] : !1, m = /* @__PURE__ */ be.mark(function b() {
                      var M, k, E, S, F, O;
                      return be.wrap(function(_) {
                        for (; ; ) switch (_.prev = _.next) {
                          case 0:
                            if (S = Bt.getCurrentSelect(), !(S.length > 0 && v)) {
                              _.next = 5;
                              break;
                            }
                            E = S, _.next = 8;
                            break;
                          case 5:
                            return _.next = 7, Bt.selectEnt(`
`, t, !1, function(L) {
                              L.setKeyWords("[(E)/(U)]"), M = L;
                            }, function(L) {
                              k = L;
                            });
                          case 7:
                            E = _.sent;
                          case 8:
                            if (!M) {
                              _.next = 15;
                              break;
                            }
                            if (!M.isKeyWordPicked("E")) {
                              _.next = 11;
                              break;
                            }
                            return _.abrupt("return", {
                              v: void 0
                            });
                          case 11:
                            if (!M.isKeyWordPicked("U")) {
                              _.next = 13;
                              break;
                            }
                            return _.abrupt("return", 0);
                          case 13:
                            if (M.getStatus() !== Gt.kCancel) {
                              _.next = 15;
                              break;
                            }
                            return _.abrupt("return", {
                              v: void 0
                            });
                          case 15:
                            if (E.length != 0) {
                              _.next = 17;
                              break;
                            }
                            return _.abrupt("return", 0);
                          case 17:
                            F = /* @__PURE__ */ be.mark(function L() {
                              var G, V, H, U;
                              return be.wrap(function(B) {
                                for (; ; ) switch (B.prev = B.next) {
                                  case 0:
                                    return r.setDynamicInputType(pn.kXYCoordInput), v ? r.setMessage(`
` + (n ? " <>" : "")) : r.setMessage(`
`), r.setKeyWords(n ? "[(E)/(U)]" : "[(E)/(M)/(U)]"), r.disableAllTrace(), r.setUserDraw(function(C, Z) {
                                      var W = E.map(function(ae) {
                                        return ae.clone();
                                      }), J = W[0];
                                      if (J) {
                                        var Q = Ka;
                                        if (v) {
                                          var j = J.getClosestPointTo(C, !0);
                                          if (!j.ret) return;
                                          k = j.val, Q = C.distanceTo(k);
                                        }
                                        if (Q) {
                                          var q = J.offsetCurves(Q, C);
                                          q.empty() || q.forEach(function(ae) {
                                            ae instanceof xr && Z.drawMcDbEntity(ae);
                                          });
                                        }
                                      }
                                    }), B.next = 7, r.go();
                                  case 7:
                                    if (G = B.sent, !r.isKeyWordPicked("E")) {
                                      B.next = 10;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: {
                                        v: void 0
                                      }
                                    });
                                  case 10:
                                    if (!r.isKeyWordPicked("M")) {
                                      B.next = 13;
                                      break;
                                    }
                                    return n = !0, B.abrupt("return", 0);
                                  case 13:
                                    if (!r.isKeyWordPicked("U")) {
                                      B.next = 15;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: 1
                                    });
                                  case 15:
                                    if (G) {
                                      B.next = 17;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: {
                                        v: void 0
                                      }
                                    });
                                  case 17:
                                    if (V = E[0].getMcDbCurve(), V) {
                                      B.next = 20;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: {
                                        v: void 0
                                      }
                                    });
                                  case 20:
                                    if (!v) {
                                      B.next = 25;
                                      break;
                                    }
                                    if (H = V.getClosestPointTo(G, !0), H.ret) {
                                      B.next = 24;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: {
                                        v: void 0
                                      }
                                    });
                                  case 24:
                                    Ka = G.distanceTo(H.val);
                                  case 25:
                                    if (Ka) {
                                      B.next = 27;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: {
                                        v: void 0
                                      }
                                    });
                                  case 27:
                                    if (U = V.offsetCurves(Ka, G), !U.empty()) {
                                      B.next = 30;
                                      break;
                                    }
                                    return B.abrupt("return", {
                                      v: {
                                        v: void 0
                                      }
                                    });
                                  case 30:
                                    if (U.forEach(function(C) {
                                      C instanceof xr && (Ns && V !== null && V !== void 0 && V.layer && (C.layer = V.layer), Ns || (C.layer = ie.getCurrentMxCAD().getDatabase().getCurrentlyLayerName()), ie.getCurrentMxCAD().drawEntity(C));
                                    }), n) {
                                      B.next = 34;
                                      break;
                                    }
                                    return Fl && E[0].erase(!0), B.abrupt("return", 1);
                                  case 34:
                                  case "end":
                                    return B.stop();
                                }
                              }, L);
                            });
                          case 19:
                            return _.delegateYield(F(), "t0", 21);
                          case 21:
                            if (O = _.t0, O !== 0) {
                              _.next = 24;
                              break;
                            }
                            return _.abrupt("continue", 19);
                          case 24:
                            if (O !== 1) {
                              _.next = 26;
                              break;
                            }
                            return _.abrupt("break", 30);
                          case 26:
                            if (!O) {
                              _.next = 28;
                              break;
                            }
                            return _.abrupt("return", O.v);
                          case 28:
                            _.next = 19;
                            break;
                          case 30:
                          case "end":
                            return _.stop();
                        }
                      }, b);
                    });
                  case 2:
                    return x.delegateYield(m(), "t0", 4);
                  case 4:
                    if (p = x.t0, p !== 0) {
                      x.next = 7;
                      break;
                    }
                    return x.abrupt("continue", 2);
                  case 7:
                    if (p !== 1) {
                      x.next = 9;
                      break;
                    }
                    return x.abrupt("continue", 2);
                  case 9:
                    if (!p) {
                      x.next = 11;
                      break;
                    }
                    return x.abrupt("return", p.v);
                  case 11:
                    x.next = 2;
                    break;
                  case 13:
                  case "end":
                    return x.stop();
                }
              }, g);
            }));
            return function() {
              return d.apply(this, arguments);
            };
          }();
        case 5:
          return a = new cr(), a.setMessage(`
<`.concat((Ka || 0).toFixed(3), ">")), a.setKeyWords("[(T)/(E)/(L))]"), h.next = 11, a.go();
        case 11:
          if (s = h.sent, !(a.isKeyWordPicked("T") || a.getStatus() === Gt.kNone)) {
            h.next = 16;
            break;
          }
          return h.next = 15, i(!0);
        case 15:
          return h.abrupt("return");
        case 16:
          if (!a.isKeyWordPicked("E")) {
            h.next = 33;
            break;
          }
          return o = new ci(), o.setMessage("?<".concat(Fl ? "" : "", ">")), o.setKeyWords("[(Y)/(N)]"), h.next = 22, o.go();
        case 22:
          if (u = h.sent, o.getStatus() !== Gt.kCancel) {
            h.next = 25;
            break;
          }
          return h.abrupt("return");
        case 25:
          if (o.getStatus() !== Gt.kNone) {
            h.next = 27;
            break;
          }
          return h.abrupt("continue", 5);
        case 27:
          if ((u == null ? void 0 : u.toLocaleLowerCase()) !== "y") {
            h.next = 30;
            break;
          }
          return Fl = !0, h.abrupt("continue", 5);
        case 30:
          if ((u == null ? void 0 : u.toLocaleLowerCase()) !== "n") {
            h.next = 33;
            break;
          }
          return Fl = !1, h.abrupt("continue", 5);
        case 33:
          if (!a.isKeyWordPicked("L")) {
            h.next = 51;
            break;
          }
          return l = new ci(), l.setMessage("<".concat(Ns ? "" : "", ">")), l.setKeyWords("[(C)/(S)]"), h.next = 39, l.go();
        case 39:
          if (c = h.sent, l.getStatus() !== Gt.kCancel) {
            h.next = 42;
            break;
          }
          return h.abrupt("return");
        case 42:
          if (l.getStatus() !== Gt.kNone) {
            h.next = 45;
            break;
          }
          return Ns = !0, h.abrupt("continue", 5);
        case 45:
          if ((c == null ? void 0 : c.toLocaleLowerCase()) !== "c") {
            h.next = 48;
            break;
          }
          return Ns = !1, h.abrupt("continue", 5);
        case 48:
          if ((c == null ? void 0 : c.toLocaleUpperCase()) !== "s") {
            h.next = 51;
            break;
          }
          return Ns = !0, h.abrupt("continue", 5);
        case 51:
          if (s && (Ka = s), Ka) {
            h.next = 54;
            break;
          }
          return h.abrupt("return");
        case 54:
          return h.next = 56, i();
        case 56:
          return h.abrupt("break", 59);
        case 59:
        case "end":
          return h.stop();
      }
    }, e);
  })), Yd.apply(this, arguments);
}
function c3() {
  ie.getCurrentMxCAD().regen();
}
function f3() {
  return Kd.apply(this, arguments);
}
function Kd() {
  return Kd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h;
    return be.wrap(function(g) {
      for (; ; ) switch (g.prev = g.next) {
        case 0:
          return g.next = 2, Bt.userSelect("");
        case 2:
          if (t = g.sent, t.length != 0) {
            g.next = 6;
            break;
          }
          return Ue.acutPrintf(`
 `), g.abrupt("return");
        case 6:
          return i = gl(t), i && (r = i.minPt, n = i.maxPt), a = new Zt(), a.setMessage(""), g.next = 12, a.go();
        case 12:
          if (s = g.sent, s != null) {
            g.next = 15;
            break;
          }
          return g.abrupt("return");
        case 15:
          return a.setMessage(""), a.setBasePt(s), a.setUseBasePt(!0), a.setUserDraw(function(v, m) {
            if (r && n) {
              var p = new Jr();
              p.setMirror(s, v);
              var y = new te(r.x, n.y, 0), w = new te(n.x, r.y, 0), x = new te(y.x, w.y, 0), b = new te(w.x, y.y, 0);
              y.transformBy(p), w.transformBy(p), x.transformBy(p), b.transformBy(p), y = qt.cad2doc(y), w = qt.cad2doc(w), x = qt.cad2doc(x), b = qt.cad2doc(b), m.drawLine(b.toVector3(), y.toVector3()), m.drawLine(y.toVector3(), x.toVector3()), m.drawLine(x.toVector3(), w.toVector3()), m.drawLine(w.toVector3(), b.toVector3());
            }
            for (var M = 0; M < t.length && M < 10; M++) {
              var k = t[M].clone();
              k && (k.mirror(s, v), m.drawMcDbEntity(k));
            }
          }), a.setDynamicInputType(pn.kXYCoordInput), g.next = 22, a.go();
        case 22:
          if (o = g.sent, o) {
            g.next = 25;
            break;
          }
          return g.abrupt("return");
        case 25:
          return u = new ci(), u.clearLastInputPoint(), u.setMessage("<N>"), u.setKeyWords("[(Y)/(N)]"), g.next = 31, u.go();
        case 31:
          if (l = g.sent, u.getStatus() !== Gt.kCancel) {
            g.next = 34;
            break;
          }
          return g.abrupt("return");
        case 34:
          c = 0;
        case 35:
          if (!(c < t.length)) {
            g.next = 44;
            break;
          }
          if (f = t[c].clone(), f) {
            g.next = 39;
            break;
          }
          return g.abrupt("continue", 41);
        case 39:
          f.mirror(s, o), ie.getCurrentMxCAD().drawEntity(f);
        case 41:
          c++, g.next = 35;
          break;
        case 44:
          if ((l == null ? void 0 : l.toLocaleLowerCase()) === "y")
            for (h = 0; h < t.length; h++)
              t[h].erase();
        case 45:
        case "end":
          return g.stop();
      }
    }, e);
  })), Kd.apply(this, arguments);
}
var Du = function(t, r) {
  t.layer = r.layer, t.trueColor = r.trueColor, t.colorIndex = r.colorIndex, t.linetype = r.linetype, t.visible = r.visible, t.textStyle = r.textStyle, t.lineweight = r.lineweight, t.drawOrder = r.drawOrder, t.linetypeScale = r.linetypeScale;
}, Ji = !1, h3 = function(t) {
  Ji = t.shiftKey;
}, d3 = function(t) {
  Ji = t.shiftKey;
};
window.addEventListener("keydown", h3);
window.addEventListener("keyup", d3);
function p3() {
  return Zd.apply(this, arguments);
}
function Zd() {
  return Zd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h;
    return be.wrap(function(g) {
      for (; ; ) switch (g.prev = g.next) {
        case 0:
          t = Number(localStorage.getItem("mx_chamfer_dist")), r = Number(localStorage.getItem("mx_chamfer_dist1")), typeof t != "number" && (t = 0), typeof r != "number" && (r = 0), n = 0, i = 0, a = !1, s = !0, o = !1, Ue.acutPrintf(`
(`.concat(s ? "" : "", ") ").concat(a ? " = " + t.toFixed(4) + ",  = " + Math.trunc(i / (Math.PI / 180)) : "1 = " + t.toFixed(4) + ", 2 = " + r.toFixed(4), `
`)), u = /* @__PURE__ */ function() {
            var v = ut(/* @__PURE__ */ be.mark(function m() {
              var p, y, w;
              return be.wrap(function(b) {
                for (; ; ) switch (b.prev = b.next) {
                  case 0:
                    return p = new cr(), p.setDynamicInputType(pn.kXYCoordInput), p.setMessage("<".concat(t.toFixed(4), ">")), p.setKeyWords(""), b.next = 6, p.go();
                  case 6:
                    if (y = b.sent, typeof y == "number") {
                      b.next = 9;
                      break;
                    }
                    return b.abrupt("return");
                  case 9:
                    return t = y, p.setMessage("<".concat(r.toFixed(4), ">")), p.setKeyWords(""), b.next = 14, p.go();
                  case 14:
                    if (w = b.sent, typeof w == "number") {
                      b.next = 17;
                      break;
                    }
                    return b.abrupt("return");
                  case 17:
                    return r = w, localStorage.setItem("mx_chamfer_dist", t.toString()), localStorage.setItem("mx_chamfer_dist1", r.toString()), a = !1, b.abrupt("return", [t, r]);
                  case 22:
                  case "end":
                    return b.stop();
                }
              }, m);
            }));
            return function() {
              return v.apply(this, arguments);
            };
          }(), l = /* @__PURE__ */ function() {
            var v = ut(/* @__PURE__ */ be.mark(function m() {
              var p, y, w, x;
              return be.wrap(function(M) {
                for (; ; ) switch (M.prev = M.next) {
                  case 0:
                    return p = new cr(), p.setMessage("<".concat(n.toFixed(4), ">")), p.setKeyWords(""), p.clearLastInputPoint(), M.next = 6, p.go();
                  case 6:
                    if (y = M.sent, typeof y == "number") {
                      M.next = 9;
                      break;
                    }
                    return M.abrupt("return");
                  case 9:
                    return n = y, w = new Qi(), w.setMessage("<".concat(Math.trunc(i / (Math.PI / 180)), ">")), w.setKeyWords(""), p.clearLastInputPoint(), M.next = 16, w.go();
                  case 16:
                    if (x = M.sent, typeof x == "number") {
                      M.next = 19;
                      break;
                    }
                    return M.abrupt("return");
                  case 19:
                    return w.getDetailedResult() === dn.kCoordIn ? i = x * (Math.PI / 180) : i = x, a = !0, M.abrupt("return", [n, i]);
                  case 22:
                  case "end":
                    return M.stop();
                }
              }, m);
            }));
            return function() {
              return v.apply(this, arguments);
            };
          }(), c = function(m, p, y, w) {
            var x = m.startPoint.clone(), b = p.startPoint.clone(), M = p.endPoint.clone(), k = b.clone().addvec(b.sub(x).normalize().mult(-y)), E = k.sub(b).rotateBy(-w).mult(-y), S = k.clone().addvec(E), F = new st(k, S), O = new st(b, M.clone().addvec(b.sub(M).normalize().mult(-y))), D = F.IntersectWith(O, Ie.Intersect.kExtendBoth);
            if (!D.isEmpty()) {
              var _ = D.at(0);
              return _.distanceTo(b);
            }
          }, f = /* @__PURE__ */ be.mark(function v() {
            var m, p, y, w, x, b, M, k, E, S, F, O, D, _, L, G, V, H, U, R, B, C, Z, W, J, Q, j, q, ae, pe, $, se, ve, me, Ae, Ce, Ee, Y, ee, Me, ye, De, Se, fe;
            return be.wrap(function(ne) {
              for (; ; ) switch (ne.prev = ne.next) {
                case 0:
                  return m = new ki(), m.setDynamicInputType(pn.kNoInput), p = new vr(), p.AddMcDbEntityTypes("LINE,LWPOLYLINE"), m.setFilter(p), m.setMessage(""), m.setKeyWords("[(U)/(P)/(D)/(A)/(T)/(E)/(M)]"), ne.next = 9, m.go();
                case 9:
                  if (y = ne.sent, !m.isKeyWordPicked("U")) {
                    ne.next = 12;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 12:
                  if (!m.isKeyWordPicked("P")) {
                    ne.next = 77;
                    break;
                  }
                case 13:
                  return w = new ki(), w.setDynamicInputType(pn.kNoInput), x = new vr(), x.AddMcDbEntityTypes("LWPOLYLINE"), w.setMessage(""), w.setKeyWords("[(D)/(A)/(M)]"), b = function(I) {
                    var A = I.getMcDbEntity();
                    if (A instanceof ot) {
                      var T = A.numVerts();
                      if (T < 3)
                        return Ue.acutPrintf(`
`);
                      var P = t, z = r;
                      if (a) {
                        var K = A.getPointAt(0).val, oe = A.getPointAt(1).val, ce = A.getPointAt(2).val;
                        P = n;
                        var ge = c(new st(K, oe), new st(oe, ce), n, i);
                        if (typeof ge != "number")
                          return Ue.acutPrintf(`
`);
                        z = ge;
                      }
                      var Oe = new ot();
                      Oe.isClosed = A.isClosed;
                      for (var Ge = [], We = function(vt, Ct) {
                        var Rt = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1, St = vt.sub(Ct).normalize().mult(Rt ? -z : -P), zt = vt.clone().addvec(St), nr = Ct.sub(vt).normalize().mult(Rt ? -P : -z), ir = Ct.clone().addvec(nr);
                        return [zt, ir];
                      }, $e = function(vt, Ct) {
                        var Rt = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1, St = We(vt, Ct, Rt), zt = rr(St, 2), nr = zt[0], ir = zt[1];
                        s ? (Oe.addVertexAt(nr), Oe.addVertexAt(ir)) : Ge.push(nr, ir);
                      }, pt = 0; pt < T; pt++) {
                        var tt = A.getPointAt(pt).val, xt = A.getPointAt(pt + 1).val;
                        if (A.isClosed)
                          pt !== T - 1 && $e(tt, xt);
                        else if (pt === 0) {
                          Oe.addVertexAt(tt);
                          var ht = xt.sub(tt).normalize().mult(-P), Vt = xt.clone().addvec(ht);
                          Oe.addVertexAt(xt.clone().addvec(ht)), Ge.unshift(Vt);
                        } else if (pt === T - 2) {
                          var qe = tt.sub(xt).normalize().mult(-z), ze = tt.clone().addvec(qe);
                          Oe.addVertexAt(ze), Oe.addVertexAt(xt), Ge.push(ze);
                        } else
                          pt !== T - 1 && $e(tt, xt, !0);
                      }
                      if (A.isClosed && $e(A.getPointAt(T - 1).val, A.getPointAt(0).val), s)
                        return Du(Oe, A), Oe;
                      var He = [], Ht = [];
                      return A.isClosed && Ge.unshift(Ge[Ge.length - 1]), Ge.forEach(function(mt) {
                        if (He.push(mt), He.length === 2) {
                          var vt = new st(He[0], He[1]);
                          Du(vt, A), Ht.push(vt), He = [];
                        }
                      }), Ht;
                    }
                  }, ne.next = 23, w.go();
                case 23:
                  if (M = ne.sent, !w.isKeyWordPicked("D")) {
                    ne.next = 30;
                    break;
                  }
                  return ne.next = 27, u();
                case 27:
                  if (ne.sent) {
                    ne.next = 29;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 29:
                  return ne.abrupt("continue", 13);
                case 30:
                  if (!w.isKeyWordPicked("A")) {
                    ne.next = 36;
                    break;
                  }
                  return ne.next = 33, l();
                case 33:
                  if (ne.sent) {
                    ne.next = 35;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 35:
                  return ne.abrupt("continue", 13);
                case 36:
                  if (!w.isKeyWordPicked("M")) {
                    ne.next = 39;
                    break;
                  }
                  return o = !0, ne.abrupt("continue", 13);
                case 39:
                  if (w.getStatus() !== Gt.kCancel) {
                    ne.next = 41;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 41:
                  if (M) {
                    ne.next = 43;
                    break;
                  }
                  return ne.abrupt("continue", 13);
                case 43:
                  if (M.isValid()) {
                    ne.next = 45;
                    break;
                  }
                  return ne.abrupt("continue", 13);
                case 45:
                  if (k = b(M), k) {
                    ne.next = 52;
                    break;
                  }
                  if (!o) {
                    ne.next = 51;
                    break;
                  }
                  return ne.abrupt("continue", 13);
                case 51:
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 52:
                  if (E = M.getMcDbEntity(), E) {
                    ne.next = 59;
                    break;
                  }
                  if (!o) {
                    ne.next = 58;
                    break;
                  }
                  return ne.abrupt("continue", 13);
                case 58:
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 59:
                  if (!(k instanceof ot)) {
                    ne.next = 68;
                    break;
                  }
                  if (E instanceof ot) {
                    ne.next = 62;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 62:
                  for (S = E.numVerts(), F = 0; F < S; F++)
                    E.removeVertexAt(0);
                  for (O = k.numVerts(), D = 0; D < O; D++)
                    _ = k.getWidthsAt(D), L = _.val1, G = _.val2, E.addVertexAt(k.getPointAt(D).val, k.getBulgeAt(D), L, G);
                  ne.next = 70;
                  break;
                case 68:
                  k.forEach(function(Te) {
                    ie.getCurrentMxCAD().drawEntity(Te);
                  }), E.visible = !0;
                case 70:
                  if (!o) {
                    ne.next = 74;
                    break;
                  }
                  return ne.abrupt("continue", 13);
                case 74:
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 75:
                  ne.next = 13;
                  break;
                case 77:
                  if (!m.isKeyWordPicked("D")) {
                    ne.next = 83;
                    break;
                  }
                  return ne.next = 80, u();
                case 80:
                  if (ne.sent) {
                    ne.next = 82;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 82:
                  return ne.abrupt("return", 0);
                case 83:
                  if (!m.isKeyWordPicked("A")) {
                    ne.next = 89;
                    break;
                  }
                  return ne.next = 86, l();
                case 86:
                  if (ne.sent) {
                    ne.next = 88;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 88:
                  return ne.abrupt("return", 0);
                case 89:
                  if (!m.isKeyWordPicked("T")) {
                    ne.next = 108;
                    break;
                  }
                  return V = new ci(), V.setMessage("<".concat(s ? "" : "", ">")), V.setKeyWords("[(T)/(N)]"), ne.next = 95, V.go();
                case 95:
                  if (H = ne.sent, V.getStatus() !== Gt.kCancel) {
                    ne.next = 98;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 98:
                  if (V.getStatus() !== Gt.kNone) {
                    ne.next = 100;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 100:
                  if (H) {
                    ne.next = 102;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 102:
                  if (H.toLocaleLowerCase() !== "t") {
                    ne.next = 105;
                    break;
                  }
                  return s = !0, ne.abrupt("return", 0);
                case 105:
                  if (H.toLocaleLowerCase() !== "n") {
                    ne.next = 108;
                    break;
                  }
                  return s = !1, ne.abrupt("return", 0);
                case 108:
                  if (!m.isKeyWordPicked("E")) {
                    ne.next = 127;
                    break;
                  }
                  return U = new ci(), U.setMessage("<".concat(a ? "" : "", ">")), U.setKeyWords("[(D)/(A)]"), ne.next = 114, U.go();
                case 114:
                  if (R = ne.sent, U.getStatus() !== Gt.kCancel) {
                    ne.next = 117;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 117:
                  if (U.getStatus() !== Gt.kNone) {
                    ne.next = 119;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 119:
                  if (typeof R == "string") {
                    ne.next = 121;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 121:
                  if (R.toLocaleLowerCase() !== "d") {
                    ne.next = 124;
                    break;
                  }
                  return a = !1, ne.abrupt("return", 0);
                case 124:
                  if (R.toLocaleLowerCase() !== "a") {
                    ne.next = 127;
                    break;
                  }
                  return a = !0, ne.abrupt("return", 0);
                case 127:
                  if (!m.isKeyWordPicked("M")) {
                    ne.next = 130;
                    break;
                  }
                  return o = !0, ne.abrupt("return", 0);
                case 130:
                  if (m.getStatus() !== Gt.kCancel) {
                    ne.next = 132;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 132:
                  if (y) {
                    ne.next = 134;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 134:
                  if (y.isValid()) {
                    ne.next = 136;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 136:
                  if (B = m.pickPoint(), C = y.getMcDbEntity(), C) {
                    ne.next = 140;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 140:
                  if (Z = new vr(), Z.AddMcDbEntityTypes("LINE,LWPOLYLINE"), C instanceof st && C.highlight(!0), !(C instanceof ot)) {
                    ne.next = 147;
                    break;
                  }
                  if (W = ku(C, B, Ue.viewCoordLong2Cad(2)), W) {
                    ne.next = 147;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 147:
                  J = !1, Q = function(I) {
                    J && (Ue.acutPrintf(I), J = !1);
                  }, j = function() {
                    J = !0, C.highlight(!1);
                  }, q = function(I, A, T, P, z) {
                    var K = arguments.length > 5 && arguments[5] !== void 0 ? arguments[5] : function(mt) {
                      ie.getCurrentMxCAD().drawEntity(mt);
                    }, oe = I, ce = A, ge;
                    if (I instanceof ot && W) {
                      var Oe = W, Ge = Oe.start, We = Oe.end;
                      I = new st(Ge, We);
                    }
                    var $e;
                    if (A instanceof ot) {
                      if ($e = ku(A, T, 1), !$e) return j();
                      var pt = $e, tt = pt.start, xt = pt.end;
                      A = new st(tt, xt);
                    }
                    if (A = A.clone(), I = I.clone(), !A || !I) return j();
                    if (A instanceof st && I instanceof st) {
                      if (A.startPoint.isEqualTo(I.startPoint) && A.endPoint.isEqualTo(I.endPoint)) {
                        Q(`
`);
                        return;
                      }
                      var ht = A.IntersectWith(I, Ie.Intersect.kOnBothOperands), Vt = ht.isEmpty();
                      if (!Vt) {
                        var qe = ht.at(0);
                        if ((I.startPoint.isEqualTo(qe) || I.endPoint.isEqualTo(qe) || A.startPoint.isEqualTo(qe) || A.endPoint.isEqualTo(qe)) && P === 0 && z === 0)
                          return {
                            apply: function() {
                            }
                          };
                      }
                      var ze = I.IntersectWith(A, Ie.Intersect.kExtendBoth);
                      if (ze.isEmpty()) {
                        Q(`
`);
                        return;
                      }
                      var He = ze.at(0), Ht = function(vt, Ct, Rt, St, zt, nr) {
                        var ir = !1;
                        return Vt ? ir = Math.max(Rt.distanceTo(He), St.distanceTo(He)) < P && P > 0 || Math.max(zt.distanceTo(He), nr.distanceTo(He)) < z && z > 0 : ir = (vt ? Rt.distanceTo(He) : St.distanceTo(He)) < P && P > 0 || (Ct ? zt.distanceTo(He) : nr.distanceTo(He)) < z && z > 0, ir && Q(`
`), ir;
                      };
                      return ge = function() {
                        var vt = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : oe, Ct = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : ce, Rt = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : vt.getHandle() === Ct.getHandle();
                        if (vt instanceof st && Ct instanceof st) {
                          var St = Mi(vt.startPoint, vt.endPoint, He, B), zt = Mi(Ct.startPoint, Ct.endPoint, He, T);
                          if (Ht(St, zt, vt.startPoint, vt.endPoint, Ct.startPoint, Ct.endPoint)) return;
                          var nr = bc(vt, Ct, He, St, zt, P, z, s);
                          return nr && K(nr), !0;
                        }
                        var ir = function(gt, Dt, Jt, dr, N, X) {
                          var ue = gt.numVerts();
                          if (Rt || (gt.isClosed = !1), !!N) {
                            var we = N.start, Le = N.end, Ke = N.endIndex, Re = N.startIndex, at = N.isClosed, Ne = [], Ye = function(un, ln) {
                              var vi = un.getBulgeAt(ln), Rn = un.getPointAt(ln).val, On = un.getWidthsAt(ln), ks = On.val1, ei = On.val2;
                              return {
                                point: Rn,
                                bulge: vi,
                                startWidth: ks,
                                endWidth: ei
                              };
                            }, Tt = Mi(we.clone(), Le.clone(), He, Jt);
                            if (Dt instanceof st) {
                              if (Rt) {
                                Q(`
 `);
                                return;
                              }
                              var kt = Mi(Dt.startPoint.clone(), Dt.endPoint.clone(), He, dr);
                              if (Ht(Tt, kt, we, Le, Dt.startPoint, Dt.endPoint))
                                return;
                              var Mt = Dt.clone(), je = bc(new st(we.clone(), Le.clone()), Mt, He, Tt, kt, P, z, s);
                              if (Tt) {
                                for (var Xe = at ? gt.numVerts() : Ke, Lt = 0; Lt < Xe; Lt++)
                                  Ne.push(Ye(gt, Lt));
                                je ? s ? (Ne.push({
                                  point: je.startPoint
                                }), Ne.push({
                                  point: je.endPoint
                                })) : K(je) : Ne.push({
                                  point: He
                                }), kt ? Ne.push({
                                  point: Mt.startPoint.clone()
                                }) : Ne.push({
                                  point: Mt.endPoint.clone()
                                });
                              } else {
                                var Ut = gt.numVerts();
                                if (at)
                                  Ne.push(Ye(gt, 0));
                                else
                                  for (var gr = Ke; gr < Ut; gr++)
                                    Ne.push(Ye(gt, gr));
                                je ? s ? (Ne.unshift({
                                  point: je.startPoint
                                }), Ne.unshift({
                                  point: je.endPoint
                                })) : K(je) : Ne.unshift({
                                  point: He
                                }), kt ? Ne.unshift({
                                  point: Dt.startPoint.clone()
                                }) : Ne.unshift({
                                  point: Dt.endPoint.clone()
                                });
                              }
                            } else if (Dt instanceof ot && X) {
                              var yt = X.start, ct = X.end, pr = X.startIndex, Gr = X.endIndex, yr = X.isClosed, Qr = Mi(yt, ct, He, dr);
                              if (Ht(Tt, Qr, we, Le, yt, ct))
                                return;
                              var jt = bc(new st(we, Le), new st(yt, ct), He, Tt, Qr, P, z, s);
                              if (Rt) {
                                var Cr = gt.numVerts(), en = Dt.numVerts(), Kn = (Re === 0 || Re === Cr - (at ? 1 : 2)) && (pr === 0 || pr === en - (yr ? 1 : 2)) && Cr > (at || yr ? 2 : 4), Gi = pr - Re;
                                if (Kn)
                                  return jt ? s ? Re === 0 || pr === 0 ? (Re === 0 ? (gt.setPointAt(0, jt.startPoint), at || yr ? gt.addVertexAt(jt.endPoint) : gt.setPointAt(Cr - 1, jt.endPoint)) : (gt.setPointAt(0, jt.endPoint), at || yr ? gt.addVertexAt(jt.startPoint) : gt.setPointAt(Cr - 1, jt.startPoint)), gt.isClosed = !0) : s && (gt.setPointAt(Cr - 1, at ? jt.endPoint : jt.startPoint), gt.addVertexAt(at ? jt.startPoint : jt.endPoint)) : K(jt) : s && (gt.setPointAt(0, He), gt.removeVertexAt(Cr - 1), gt.isClosed = !0), !0;
                                if (Math.abs(Gi) > 2) {
                                  Q(`
 `);
                                  return;
                                } else
                                  Dt = Dt.clone();
                              }
                              if (!(Dt instanceof ot)) return;
                              if (Tt) {
                                for (var di = 0; di <= Re; di++)
                                  Ne.push(Ye(gt, di));
                                if (jt ? s ? (Ne.push({
                                  point: jt.startPoint
                                }), Ne.push({
                                  point: jt.endPoint
                                })) : K(jt) : Ne.push({
                                  point: He
                                }), Qr)
                                  for (var yn = pr; yn >= 0; yn--)
                                    Ne.push(Ye(Dt, yn));
                                else if (yr)
                                  Ne.push(Ye(Dt, 0));
                                else
                                  for (var bn = Dt.numVerts(), pi = Gr; pi < bn; pi++)
                                    Ne.push(Ye(Dt, pi));
                              } else {
                                var Xa = gt.numVerts();
                                if (at)
                                  Ne.push(Ye(gt, 0));
                                else
                                  for (var Zn = Ke; Zn < Xa; Zn++)
                                    Ne.push(Ye(gt, Zn));
                                if (jt ? s ? (Ne.unshift({
                                  point: jt.startPoint
                                }), Ne.unshift({
                                  point: jt.endPoint
                                })) : K(jt) : Ne.unshift({
                                  point: He
                                }), Qr)
                                  for (var Jn = pr; Jn >= 0; Jn--)
                                    Ne.unshift(Ye(Dt, Jn));
                                else if (yr)
                                  Ne.unshift(Ye(Dt, 0));
                                else
                                  for (var Ss = Dt.numVerts(), da = Gr; da < Ss; da++)
                                    Ne.unshift(Ye(Dt, da));
                              }
                            } else
                              return !1;
                            if (s) {
                              for (var Qn = 0; Qn < ue; Qn++)
                                gt.removeVertexAt(0);
                              Ne.forEach(function(on) {
                                var un = on.point, ln = on.bulge, vi = on.startWidth, Rn = on.endWidth;
                                gt.addVertexAt(un, ln, vi, Rn);
                              }), Dt.erase();
                            }
                            return !0;
                          }
                        };
                        return vt instanceof ot && W ? ir(vt, Ct, B, T, W, $e) : Ct instanceof ot && $e ? ir(Ct, vt, T, B, $e, W) : !1;
                      }, {
                        apply: ge,
                        line1: I,
                        line2: A
                      };
                    }
                  }, m.setUserDraw(function(Te, I) {
                    var A = C.clone(), T = Bt.findEntAtPoint(Te.x, Te.y, Te.z, -1, Z);
                    if (!T || !T.isValid()) return j();
                    var P = T.getMcDbEntity();
                    if (!P) return j();
                    var z = P == null ? void 0 : P.clone();
                    if (!z) return j();
                    var K = q(A, z, Te, Ji ? 0 : t, Ji ? 0 : r, function($e) {
                      I.drawMcDbEntity($e);
                    }) || {}, oe = K.line1, ce = K.line2, ge = K.apply, Oe = ge && ge(A, z, C.getHandle() === P.getHandle());
                    if (oe && ce && Oe) {
                      A.drawOrder = C.drawOrder + P.drawOrder + 102, oe.drawOrder = C.drawOrder + P.drawOrder + 101, ce.drawOrder = C.drawOrder + P.drawOrder + 101;
                      var Ge = new THREE.Color(Number(C.trueColor.getColorValue(C.layerId))), We = Ge.clone();
                      s && (Zy(We, 0.5), I.setColor(We)), I.drawMcDbEntity(oe), I.drawMcDbEntity(ce), I.setColor(Ge), I.drawMcDbEntity(A);
                    }
                  });
                case 152:
                  return m.setMessage("shift"), m.setKeyWords("[(D)/(A)/(M)]"), ne.next = 157, m.go();
                case 157:
                  if (ae = ne.sent, !m.isKeyWordPicked("D")) {
                    ne.next = 164;
                    break;
                  }
                  return ne.next = 161, u();
                case 161:
                  if (ne.sent) {
                    ne.next = 163;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 163:
                  return ne.abrupt("continue", 152);
                case 164:
                  if (!m.isKeyWordPicked("A")) {
                    ne.next = 170;
                    break;
                  }
                  return ne.next = 167, l();
                case 167:
                  if (ne.sent) {
                    ne.next = 169;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 169:
                  return ne.abrupt("continue", 152);
                case 170:
                  if (!m.isKeyWordPicked("M")) {
                    ne.next = 173;
                    break;
                  }
                  return o = !0, ne.abrupt("continue", 152);
                case 173:
                  if (m.getStatus() !== Gt.kCancel) {
                    ne.next = 175;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: void 0
                  });
                case 175:
                  if (ae) {
                    ne.next = 177;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 177:
                  if (ae.isValid()) {
                    ne.next = 179;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 179:
                  if (pe = ae.getMcDbEntity(), pe) {
                    ne.next = 182;
                    break;
                  }
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 182:
                  if ($ = C, se = m.pickPoint(), ve = $.clone(), ve) {
                    ne.next = 191;
                    break;
                  }
                  if (!o) {
                    ne.next = 190;
                    break;
                  }
                  return ne.abrupt("continue", 152);
                case 190:
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 191:
                  if (me = $.clone(), me) {
                    ne.next = 198;
                    break;
                  }
                  if (!o) {
                    ne.next = 197;
                    break;
                  }
                  return ne.abrupt("continue", 152);
                case 197:
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 198:
                  if (Ae = ve.IntersectWith(me, Ie.Intersect.kOnBothOperands), !Ae.isEmpty()) {
                    ne.next = 205;
                    break;
                  }
                  if (!o) {
                    ne.next = 204;
                    break;
                  }
                  return ne.abrupt("continue", 152);
                case 204:
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 205:
                  if (Ce = t, Ee = r, !a) {
                    ne.next = 219;
                    break;
                  }
                  if (Y = Ae.at(0), ee = c(new st(B, Y), new st(Y, se), n, i), typeof ee == "number") {
                    ne.next = 217;
                    break;
                  }
                  if (Ue.acutPrintf(`
`), !o) {
                    ne.next = 216;
                    break;
                  }
                  return ne.abrupt("continue", 152);
                case 216:
                  return ne.abrupt("return", {
                    v: j()
                  });
                case 217:
                  Ce = n, Ee = ee;
                case 219:
                  if (Me = q($, pe, se, Ji ? 0 : Ce, Ji ? 0 : Ee) || {}, ye = Me.line1, De = Me.line2, Se = Me.apply, !(ye && De && Jy(ye, De))) {
                    ne.next = 223;
                    break;
                  }
                  return Ue.acutPrintf(" "), ne.abrupt("return", {
                    v: j()
                  });
                case 223:
                  if (!Se) {
                    ne.next = 232;
                    break;
                  }
                  if (fe = Se(), !(o && typeof fe == "undefined")) {
                    ne.next = 229;
                    break;
                  }
                  return ne.abrupt("continue", 152);
                case 229:
                  return ne.abrupt("break", 240);
                case 230:
                  ne.next = 238;
                  break;
                case 232:
                  if (ie.App.MxCADAssist.MxChamfer(y.id, ae.id, B.x, B.y, se.x, se.y, Ce, Ee, s), !o) {
                    ne.next = 237;
                    break;
                  }
                  return ne.abrupt("continue", 152);
                case 237:
                  return ne.abrupt("break", 240);
                case 238:
                  ne.next = 152;
                  break;
                case 240:
                  if (C instanceof st && C.highlight(!1), !o) {
                    ne.next = 245;
                    break;
                  }
                  return ne.abrupt("return", 0);
                case 245:
                  return j(), ne.abrupt("return", 1);
                case 247:
                case "end":
                  return ne.stop();
              }
            }, v);
          });
        case 14:
          return g.delegateYield(f(), "t0", 16);
        case 16:
          if (h = g.t0, h !== 0) {
            g.next = 19;
            break;
          }
          return g.abrupt("continue", 14);
        case 19:
          if (h !== 1) {
            g.next = 21;
            break;
          }
          return g.abrupt("break", 25);
        case 21:
          if (!h) {
            g.next = 23;
            break;
          }
          return g.abrupt("return", h.v);
        case 23:
          g.next = 14;
          break;
        case 25:
        case "end":
          return g.stop();
      }
    }, e);
  })), Zd.apply(this, arguments);
}
function v3() {
  return Jd.apply(this, arguments);
}
function Jd() {
  return Jd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u;
    return be.wrap(function(c) {
      for (; ; ) switch (c.prev = c.next) {
        case 0:
          t = Number(localStorage.getItem("Mx_Fillet_radius")) || 0, r = localStorage.getItem("Mx_Fillet_isPruning") !== "false", n = !1, Ue.acutPrintf(`
:  = `.concat(r ? "" : "", ",  = ").concat(t.toFixed(4))), i = /* @__PURE__ */ function() {
            var f = ut(/* @__PURE__ */ be.mark(function h() {
              var d, g;
              return be.wrap(function(m) {
                for (; ; ) switch (m.prev = m.next) {
                  case 0:
                    return d = new cr(), d.setDynamicInputType(pn.kDistanceInput), d.setKeyWords("<".concat(t.toFixed(4), ">")), m.next = 5, d.go();
                  case 5:
                    if (g = m.sent, d.getStatus() !== Gt.kCancel) {
                      m.next = 8;
                      break;
                    }
                    return m.abrupt("return");
                  case 8:
                    if (d.getStatus() !== Gt.kNone) {
                      m.next = 10;
                      break;
                    }
                    return m.abrupt("return", t);
                  case 10:
                    if (typeof g == "number") {
                      m.next = 12;
                      break;
                    }
                    return m.abrupt("return");
                  case 12:
                    return t = g, localStorage.setItem("Mx_Fillet_radius", t.toString()), m.abrupt("return", t);
                  case 15:
                  case "end":
                    return m.stop();
                }
              }, h);
            }));
            return function() {
              return f.apply(this, arguments);
            };
          }(), a = new ki(), s = new vr(), s.AddMcDbEntityTypes("LINE,LWPOLYLINE"), o = /* @__PURE__ */ be.mark(function f() {
            var h, d, g, v, m, p, y, w, x, b, M, k, E, S, F, O, D, _, L, G, V, H, U, R;
            return be.wrap(function(C) {
              for (; ; ) switch (C.prev = C.next) {
                case 0:
                  return a.setDynamicInputType(pn.kNoInput), a.setFilter(s), a.setMessage(""), a.setKeyWords("[(U)/(P)/(R)/(T)/(M)]"), C.next = 6, a.go();
                case 6:
                  if (h = C.sent, a.getStatus() !== Gt.kCancel) {
                    C.next = 9;
                    break;
                  }
                  return C.abrupt("return", {
                    v: void 0
                  });
                case 9:
                  if (!a.isKeyWordPicked("U")) {
                    C.next = 11;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 11:
                  if (!a.isKeyWordPicked("P")) {
                    C.next = 24;
                    break;
                  }
                  d = /* @__PURE__ */ be.mark(function Z() {
                    var W, J, Q, j, q, ae, pe, $, se, ve, me, Ae, Ce, Ee, Y, ee, Me, ye, De, Se, fe, ke, ne, Te, I, A, T;
                    return be.wrap(function(z) {
                      for (; ; ) switch (z.prev = z.next) {
                        case 0:
                          return a.setMessage(""), a.setKeyWords("[(R)]"), W = new vr(), W.AddMcDbEntityTypes("LWPOLYLINE"), a.setFilter(W), z.next = 7, a.go();
                        case 7:
                          if (J = z.sent, a.getStatus() !== Gt.kCancel) {
                            z.next = 10;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 10:
                          if (!a.isKeyWordPicked("R")) {
                            z.next = 17;
                            break;
                          }
                          return z.next = 13, i();
                        case 13:
                          if (z.t0 = Er(z.sent), z.t0 === "number") {
                            z.next = 16;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 16:
                          return z.abrupt("return", 0);
                        case 17:
                          if (J) {
                            z.next = 19;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 19:
                          if (J.isValid()) {
                            z.next = 21;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 21:
                          if (Q = J.getMcDbEntity(), Q instanceof ot) {
                            z.next = 24;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 24:
                          j = Q.numVerts(), q = 0, ae = 0, pe = [], Q.isClosed || j--;
                        case 29:
                          if (!(q < j)) {
                            z.next = 82;
                            break;
                          }
                          if (q++, ae > j - 1 && (ae = 0), $ = Q.getPointAt(ae), se = $.val, se) {
                            z.next = 39;
                            break;
                          }
                          if (!n) {
                            z.next = 38;
                            break;
                          }
                          return z.abrupt("return", 1);
                        case 38:
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 39:
                          if (ae++, ae > j - 1 && (ae = 0), ve = Q.getPointAt(ae), me = ve.val, me) {
                            z.next = 48;
                            break;
                          }
                          if (!n) {
                            z.next = 47;
                            break;
                          }
                          return z.abrupt("return", 1);
                        case 47:
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 48:
                          if (ae++, ae > j - 1 && (ae = 0), Ae = Q.getPointAt(ae), Ce = Ae.val, Ce) {
                            z.next = 57;
                            break;
                          }
                          if (!n) {
                            z.next = 56;
                            break;
                          }
                          return z.abrupt("return", 1);
                        case 56:
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 57:
                          if (ae = q, Ee = Cl(t, new st(se, me), new st(me, Ce), me, !0, !1, r), Ee) {
                            z.next = 61;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: console.log("")
                            }
                          });
                        case 61:
                          if (Y = Ee.arc, ee = Ee.segmentLine, Me = Ee.bulge, ee) {
                            z.next = 64;
                            break;
                          }
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 64:
                          if (!r) {
                            z.next = 78;
                            break;
                          }
                          if (ye = Q.getWidthsAt(q), De = ye.ret, Se = ye.val1, fe = ye.val2, De) {
                            z.next = 74;
                            break;
                          }
                          if (!Q.isClosed) {
                            z.next = 73;
                            break;
                          }
                          if (ke = Q.getWidthsAt(0), ne = ke.ret, Te = ke.val1, I = ke.val2, ne) {
                            z.next = 71;
                            break;
                          }
                          return z.abrupt("continue", 29);
                        case 71:
                          pe.push({
                            width: Te,
                            width1: I,
                            bulge: Me,
                            point: ee.startPoint
                          }), pe.unshift({
                            width: Te,
                            width1: I,
                            bulge: Q.getBulgeAt(0),
                            point: ee.endPoint
                          });
                        case 73:
                          return z.abrupt("continue", 29);
                        case 74:
                          pe.push({
                            width: Se,
                            width1: fe,
                            bulge: Me,
                            point: ee.startPoint
                          }), pe.push({
                            width: Se,
                            width1: fe,
                            bulge: Q.getBulgeAt(q),
                            point: ee.endPoint
                          }), z.next = 80;
                          break;
                        case 78:
                          Du(Y, Q), ie.getCurrentMxCAD().drawEntity(Y);
                        case 80:
                          z.next = 29;
                          break;
                        case 82:
                          if (r) {
                            for (A = Q.numVerts(), T = 0; T < A; T++)
                              Q.removeVertexAt(0);
                            pe.forEach(function(K) {
                              var oe = K.point, ce = K.bulge, ge = K.width, Oe = K.width1;
                              Q.addVertexAt(oe, ce, ge, Oe);
                            });
                          }
                          if (!n) {
                            z.next = 87;
                            break;
                          }
                          return z.abrupt("return", 0);
                        case 87:
                          return z.abrupt("return", {
                            v: {
                              v: void 0
                            }
                          });
                        case 88:
                        case "end":
                          return z.stop();
                      }
                    }, Z);
                  });
                case 13:
                  return C.delegateYield(d(), "t0", 15);
                case 15:
                  if (g = C.t0, g !== 0) {
                    C.next = 18;
                    break;
                  }
                  return C.abrupt("continue", 13);
                case 18:
                  if (g !== 1) {
                    C.next = 20;
                    break;
                  }
                  return C.abrupt("continue", 13);
                case 20:
                  if (!g) {
                    C.next = 22;
                    break;
                  }
                  return C.abrupt("return", g.v);
                case 22:
                  C.next = 13;
                  break;
                case 24:
                  if (!a.isKeyWordPicked("R")) {
                    C.next = 31;
                    break;
                  }
                  return C.next = 27, i();
                case 27:
                  if (C.t1 = Er(C.sent), C.t1 === "number") {
                    C.next = 30;
                    break;
                  }
                  return C.abrupt("return", {
                    v: void 0
                  });
                case 30:
                  return C.abrupt("return", 0);
                case 31:
                  if (!a.isKeyWordPicked("T")) {
                    C.next = 53;
                    break;
                  }
                  return v = new ci(), v.setDynamicInputType(pn.kNoInput), v.setMessage("<".concat(r ? "" : "", ">")), v.setKeyWords("[(T)/(N)]"), C.next = 38, v.go();
                case 38:
                  if (m = C.sent, v.getStatus() !== Gt.kCancel) {
                    C.next = 41;
                    break;
                  }
                  return C.abrupt("return", {
                    v: void 0
                  });
                case 41:
                  if (v.getStatus() !== Gt.kNone) {
                    C.next = 43;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 43:
                  if (typeof m == "string") {
                    C.next = 45;
                    break;
                  }
                  return C.abrupt("return", {
                    v: void 0
                  });
                case 45:
                  if (m.toLocaleLowerCase() !== "t") {
                    C.next = 49;
                    break;
                  }
                  return r = !0, localStorage.setItem("Mx_Fillet_isPruning", "true"), C.abrupt("return", 0);
                case 49:
                  if (m.toLocaleLowerCase() !== "n") {
                    C.next = 53;
                    break;
                  }
                  return r = !1, localStorage.setItem("Mx_Fillet_isPruning", "false"), C.abrupt("return", 0);
                case 53:
                  if (!a.isKeyWordPicked("M")) {
                    C.next = 56;
                    break;
                  }
                  return n = !0, C.abrupt("return", 0);
                case 56:
                  if (h) {
                    C.next = 58;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 58:
                  if (h.isValid()) {
                    C.next = 60;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 60:
                  if (p = a.pickPoint(), y = new vr(), y.AddMcDbEntityTypes("LINE,LWPOLYLINE"), w = new ki(), w.setFilter(y), x = h.getMcDbEntity(), x) {
                    C.next = 68;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 68:
                  if (x instanceof st && x.highlight(!0), !(x instanceof ot)) {
                    C.next = 73;
                    break;
                  }
                  if (b = ku(x, p, Ue.viewCoordLong2Cad(2)), b) {
                    C.next = 73;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 73:
                  M = new ki(), M.setFilter(y), k = !1, E = function(W) {
                    k && (Ue.acutPrintf(W), k = !1);
                  }, S = function() {
                    k = !0, x.highlight(!1);
                  }, F = function(W, J, Q) {
                    var j = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : function(fe) {
                      ie.getCurrentMxCAD().drawEntity(fe);
                    }, q = W, ae = J, pe;
                    if (W instanceof ot && b) {
                      var $ = b, se = $.start, ve = $.end;
                      W = new st(se, ve);
                    }
                    var me;
                    if (J instanceof ot) {
                      if (me = ku(J, Q, 1), !me) return S();
                      var Ae = me, Ce = Ae.start, Ee = Ae.end;
                      J = new st(Ce, Ee);
                    }
                    if (J = J.clone(), W = W.clone(), !J || !W) return S();
                    if (J instanceof st && W instanceof st) {
                      if (J.startPoint.isEqualTo(W.startPoint) && J.endPoint.isEqualTo(W.endPoint)) {
                        E(`
`);
                        return;
                      }
                      var Y = J.IntersectWith(W, Ie.Intersect.kOnBothOperands), ee = Y.isEmpty();
                      if (!ee) {
                        var Me = Y.at(0);
                        if ((W.startPoint.isEqualTo(Me) || W.endPoint.isEqualTo(Me) || J.startPoint.isEqualTo(Me) || J.endPoint.isEqualTo(Me)) && t === 0)
                          return {
                            apply: function() {
                            }
                          };
                      }
                      var ye = W.IntersectWith(J, Ie.Intersect.kExtendBoth);
                      if (ye.isEmpty()) {
                        E(`
`);
                        return;
                      }
                      var De = ye.at(0), Se = function(ke, ne, Te, I, A, T, P) {
                        var z = !1;
                        return ee ? z = Math.max(Te.distanceTo(De), I.distanceTo(De)) < P && P > 0 || Math.max(A.distanceTo(De), T.distanceTo(De)) < P && P > 0 : z = (ke ? Te.distanceTo(De) : I.distanceTo(De)) < P && P > 0 || (ne ? A.distanceTo(De) : T.distanceTo(De)) < P && P > 0, z && E(`
`), z;
                      };
                      return pe = function() {
                        var ke = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : q, ne = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : ae, Te = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : ke.getHandle() === ne.getHandle();
                        if (ke instanceof st && ne instanceof st) {
                          var I = Mi(ke.startPoint, ke.endPoint, De, p), A = Mi(ne.startPoint, ne.endPoint, De, Q), T = Cl(t, ke, ne, De, I, A, r, Ji);
                          if (!T) {
                            E(`
`);
                            return;
                          }
                          var P = T.arc, z = T.chamferDist;
                          return Se(I, A, ke.startPoint, ke.endPoint, ne.startPoint, ne.endPoint, z) ? void 0 : (P && j(P), !0);
                        }
                        var K = function(ce, ge, Oe, Ge, We, $e) {
                          var pt = ce.numVerts();
                          if (Te || (ce.isClosed = !1), !!We) {
                            var tt = We.start, xt = We.end, ht = We.endIndex, Vt = We.startIndex, qe = We.isClosed, ze = [], He = function(jt, Cr) {
                              var en = jt.getBulgeAt(Cr), Kn = jt.getPointAt(Cr).val, Gi = jt.getWidthsAt(Cr), di = Gi.val1, yn = Gi.val2;
                              return {
                                point: Kn,
                                bulge: en,
                                startWidth: di,
                                endWidth: yn
                              };
                            }, Ht = Mi(tt.clone(), xt.clone(), De, Oe);
                            if (ge instanceof st) {
                              if (Te) {
                                E(`
 `);
                                return;
                              }
                              var mt = Mi(ge.startPoint.clone(), ge.endPoint.clone(), De, Ge), vt = ge.clone(), Ct = Cl(t, new st(tt.clone(), xt.clone()), vt, De, Ht, mt, r, Ji);
                              if (!Ct) {
                                E(`
`);
                                return;
                              }
                              var Rt = Ct.chamferDist, St = Ct.bulge, zt = Ct.segmentLine, nr = Ct.arc;
                              if (Se(Ht, mt, tt, xt, ge.startPoint, ge.endPoint, Rt))
                                return;
                              if (Ht) {
                                for (var ir = qe ? ce.numVerts() : ht, ar = 0; ar < ir; ar++)
                                  ze.push(He(ce, ar));
                                zt ? r ? (ze.push({
                                  point: zt.startPoint,
                                  bulge: St
                                }), ze.push({
                                  point: zt.endPoint
                                })) : j(nr) : ze.push({
                                  point: De
                                }), mt ? ze.push({
                                  point: vt.startPoint.clone()
                                }) : ze.push({
                                  point: vt.endPoint.clone()
                                });
                              } else {
                                var gt = ce.numVerts();
                                if (qe)
                                  ze.push(He(ce, 0));
                                else
                                  for (var Dt = ht; Dt < gt; Dt++)
                                    ze.push(He(ce, Dt));
                                zt ? r ? (ze.unshift({
                                  point: zt.startPoint
                                }), ze.unshift({
                                  point: zt.endPoint,
                                  bulge: -St
                                })) : j(zt) : ze.unshift({
                                  point: De
                                }), mt ? ze.unshift({
                                  point: ge.startPoint.clone()
                                }) : ze.unshift({
                                  point: ge.endPoint.clone()
                                });
                              }
                            } else if (ge instanceof ot && $e) {
                              var Jt = $e.start, dr = $e.end, N = $e.startIndex, X = $e.endIndex, ue = $e.isClosed, we = Mi(Jt, dr, De, Ge), Le = Cl(t, new st(tt, xt), new st(Jt, dr), De, Ht, we, r, Ji);
                              if (!Le) {
                                E(`
`);
                                return;
                              }
                              var Ke = Le.arc, Re = Le.segmentLine, at = Le.bulge, Ne = Le.chamferDist;
                              if (Se(Ht, we, tt, xt, Jt, dr, Ne))
                                return;
                              if (Te) {
                                var Ye = ce.numVerts(), Tt = ge.numVerts(), kt = (Vt === 0 || Vt === Ye - (qe ? 1 : 2)) && (N === 0 || N === Tt - (ue ? 1 : 2)) && Ye > (qe || ue ? 2 : 4), Mt = N - Vt;
                                if (kt)
                                  return Re ? r ? Vt === 0 || N === 0 ? (Vt === 0 ? (console.log("start1"), ce.setPointAt(0, Re.startPoint), qe || ue ? ce.addVertexAt(Re.endPoint, -at) : (ce.setPointAt(Ye - 1, Re.endPoint), ce.setBulgeAt(Ye - 1, at))) : (ce.setPointAt(0, Re.endPoint), qe || ue ? ce.addVertexAt(Re.startPoint, at) : (ce.setPointAt(Ye - 1, Re.startPoint), ce.setBulgeAt(Ye - 1, at))), ce.isClosed = !0) : r && (ce.setPointAt(Ye - 1, qe ? Re.endPoint : Re.startPoint), ce.setBulgeAt(Ye - 1, qe ? -at : at), ce.addVertexAt(qe ? Re.startPoint : Re.endPoint)) : j(Ke) : r && (ce.setPointAt(0, De), ce.removeVertexAt(Ye - 1), ce.isClosed = !0), !0;
                                if (Math.abs(Mt) > 2) {
                                  E(`
 `);
                                  return;
                                } else
                                  ge = ge.clone();
                              }
                              if (!(ge instanceof ot)) return;
                              if (Ht) {
                                for (var je = 0; je <= Vt; je++)
                                  ze.push(He(ce, je));
                                if (Re ? r ? (ze.push({
                                  point: Re.startPoint,
                                  bulge: at
                                }), ze.push({
                                  point: Re.endPoint
                                })) : j(Ke) : ze.push({
                                  point: De
                                }), we)
                                  for (var Xe = N; Xe >= 0; Xe--)
                                    ze.push(He(ge, Xe));
                                else if (ue)
                                  ze.push(He(ge, 0));
                                else
                                  for (var Lt = ge.numVerts(), Ut = X; Ut < Lt; Ut++)
                                    ze.push(He(ge, Ut));
                              } else {
                                var gr = ce.numVerts();
                                if (qe)
                                  ze.push(He(ce, 0));
                                else
                                  for (var yt = ht; yt < gr; yt++)
                                    ze.push(He(ce, yt));
                                if (Re ? r ? (ze.unshift({
                                  point: Re.startPoint
                                }), ze.unshift({
                                  point: Re.endPoint,
                                  bulge: -at
                                })) : j(Ke) : ze.unshift({
                                  point: De
                                }), we)
                                  for (var ct = N; ct >= 0; ct--)
                                    ze.unshift(He(ge, ct));
                                else if (ue)
                                  ze.unshift(He(ge, 0));
                                else
                                  for (var pr = ge.numVerts(), Gr = X; Gr < pr; Gr++)
                                    ze.unshift(He(ge, Gr));
                              }
                            } else
                              return !1;
                            if (r) {
                              for (var yr = 0; yr < pt; yr++)
                                ce.removeVertexAt(0);
                              ze.forEach(function(Qr) {
                                var jt = Qr.point, Cr = Qr.bulge, en = Qr.startWidth, Kn = Qr.endWidth;
                                ce.addVertexAt(jt, Cr, en, Kn);
                              }), ge.erase();
                            }
                            return !0;
                          }
                        };
                        return ke instanceof ot && b ? K(ke, ne, p, Q, b, me) : ne instanceof ot && me ? K(ne, ke, Q, p, me, b) : !1;
                      }, {
                        apply: pe,
                        line1: W,
                        line2: J
                      };
                    }
                  }, M.setUserDraw(function(Z, W) {
                    var J = x.clone(), Q = Bt.findEntAtPoint(Z.x, Z.y, Z.z, -1, y);
                    if (!Q || !Q.isValid()) return S();
                    var j = Q.getMcDbEntity();
                    if (!j) return S();
                    var q = j == null ? void 0 : j.clone();
                    if (!q) return S();
                    var ae = F(J, q, Z, function(Ce) {
                      console.log(121), W.drawMcDbEntity(Ce);
                    }) || {}, pe = ae.line1, $ = ae.line2, se = ae.apply, ve = se && se(J, q, x.getHandle() === j.getHandle());
                    if (pe && $ && ve) {
                      J.drawOrder = x.drawOrder + j.drawOrder + 102, pe.drawOrder = x.drawOrder + j.drawOrder + 101, $.drawOrder = x.drawOrder + j.drawOrder + 101;
                      var me = new THREE.Color(Number(x.trueColor.getColorValue(x.layerId))), Ae = me.clone();
                      r && (Zy(Ae, 0.5), W.setColor(Ae)), W.drawMcDbEntity(pe), W.drawMcDbEntity($), W.setColor(me), W.drawMcDbEntity(J);
                    }
                  });
                case 80:
                  return M.setMessage(""), M.setKeyWords("[(R)]"), C.next = 85, M.go();
                case 85:
                  if (O = C.sent, !M.isKeyWordPicked("R")) {
                    C.next = 93;
                    break;
                  }
                  return C.next = 89, i();
                case 89:
                  if (C.t2 = Er(C.sent), C.t2 === "number") {
                    C.next = 92;
                    break;
                  }
                  return C.abrupt("return", {
                    v: void 0
                  });
                case 92:
                  return C.abrupt("continue", 80);
                case 93:
                  if (O) {
                    C.next = 95;
                    break;
                  }
                  return C.abrupt("return", {
                    v: S()
                  });
                case 95:
                  if (O.isValid()) {
                    C.next = 97;
                    break;
                  }
                  return C.abrupt("return", {
                    v: S()
                  });
                case 97:
                  if (D = O.getMcDbEntity(), D) {
                    C.next = 100;
                    break;
                  }
                  return C.abrupt("return", {
                    v: S()
                  });
                case 100:
                  if (_ = x, L = M.pickPoint(), G = F(_, D, L) || {}, V = G.line1, H = G.line2, U = G.apply, !(V && H && Jy(V, H))) {
                    C.next = 106;
                    break;
                  }
                  return Ue.acutPrintf(" "), C.abrupt("return", {
                    v: S()
                  });
                case 106:
                  if (!U) {
                    C.next = 115;
                    break;
                  }
                  if (R = U(), !(n && typeof R == "undefined")) {
                    C.next = 112;
                    break;
                  }
                  return C.abrupt("continue", 80);
                case 112:
                  return C.abrupt("break", 123);
                case 113:
                  C.next = 121;
                  break;
                case 115:
                  if (ie.App.MxCADAssist.MxFillet(h.id, O.id, p.x, p.y, L.x, L.y, t, r), !n) {
                    C.next = 120;
                    break;
                  }
                  return C.abrupt("continue", 80);
                case 120:
                  return C.abrupt("break", 123);
                case 121:
                  C.next = 80;
                  break;
                case 123:
                  if (S(), !n) {
                    C.next = 128;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 128:
                  return C.abrupt("return", 1);
                case 129:
                case "end":
                  return C.stop();
              }
            }, f);
          });
        case 9:
          return c.delegateYield(o(), "t0", 11);
        case 11:
          if (u = c.t0, u !== 0) {
            c.next = 14;
            break;
          }
          return c.abrupt("continue", 9);
        case 14:
          if (u !== 1) {
            c.next = 16;
            break;
          }
          return c.abrupt("break", 20);
        case 16:
          if (!u) {
            c.next = 18;
            break;
          }
          return c.abrupt("return", u.v);
        case 18:
          c.next = 9;
          break;
        case 20:
        case "end":
          return c.stop();
      }
    }, e);
  })), Jd.apply(this, arguments);
}
var N1 = /* @__PURE__ */ function() {
  var e = ut(/* @__PURE__ */ be.mark(function t() {
    var r, n, i, a;
    return be.wrap(function(o) {
      for (; ; ) switch (o.prev = o.next) {
        case 0:
          r = [];
        case 1:
          return n = new Zt(), n.setMessage(r.length === 0 ? "" : ""), n.setKeyWords(r.length === 0 ? "" : "[(U)]"), n.setUserDraw(function(u, l) {
            var c = new ot();
            r.forEach(function(f) {
              c.addVertexAt(f);
            }), c.addVertexAt(u), l.drawMcDbEntity(c);
          }), o.next = 8, n.go();
        case 8:
          if (i = o.sent, !n.isKeyWordPicked("U")) {
            o.next = 13;
            break;
          }
          return a = r.pop(), a && n.setLastInputPoint(a), o.abrupt("continue", 1);
        case 13:
          if (n.getStatus() !== Gt.kCancel) {
            o.next = 15;
            break;
          }
          return o.abrupt("return", !1);
        case 15:
          if (n.getStatus() !== Gt.kNone) {
            o.next = 17;
            break;
          }
          return o.abrupt("break", 22);
        case 17:
          if (i) {
            o.next = 19;
            break;
          }
          return o.abrupt("return", r);
        case 19:
          r.push(i), o.next = 1;
          break;
        case 22:
          return o.abrupt("return", r);
        case 23:
        case "end":
          return o.stop();
      }
    }, t);
  }));
  return function() {
    return e.apply(this, arguments);
  };
}();
function m3() {
  return Qd.apply(this, arguments);
}
function Qd() {
  return Qd = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v;
    return be.wrap(function(p) {
      for (; ; ) switch (p.prev = p.next) {
        case 0:
          if (t = !1, r = !1, n = [], i = new vr(), i.AddMcDbEntityTypes("LINE,LWPOLYLINE,ELLIPSE,ARC,CIRCLE,SPLINE,XLINE"), o = Bt.getCurrentSelect(i), o.length !== 0) {
            p.next = 16;
            break;
          }
          return p.next = 10, Bt.userSelect("<>", i, function(y, w) {
            a = w, s = y;
          });
        case 10:
          if (o = p.sent, a.getStatus() !== Gt.kCancel) {
            p.next = 13;
            break;
          }
          return p.abrupt("return");
        case 13:
          if (a.getStatus() === Gt.kNone && o.length === 0 && (s.allSelect(i), s.forEach(function(y) {
            o.push(y);
          })), o.length !== 0) {
            p.next = 16;
            break;
          }
          return p.abrupt("return");
        case 16:
          if (u = new fa(), u.copyFormAryId(o), l = new ie.mxcadassemblyimp.MxDrawTrimAssist(), l.Init(u.imp)) {
            p.next = 21;
            break;
          }
          return p.abrupt("return");
        case 21:
          if (c = new ie.mxcadassemblyimp.MxDrawExtendAssist(), c.Init(u.imp)) {
            p.next = 24;
            break;
          }
          return p.abrupt("return");
        case 24:
          f = !1, h = function(w) {
            f = w.key === "Shift";
          }, window.addEventListener("keydown", h), d = function() {
            return f = !1;
          }, window.addEventListener("keyup", d), g = /* @__PURE__ */ be.mark(function y() {
            var w, x, b, M, k, E, S, F, O, D, _, L, G, V, H, U, R;
            return be.wrap(function(C) {
              for (; ; ) switch (C.prev = C.next) {
                case 0:
                  return w = new An(), w.isWhileSelect = !1, w.isSelectHighlight = !1, C.next = 5, w.userSelect(" Shift ", i, function(Z) {
                    x = Z, x.setKeyWords("[(F)/(C)/(E)/(R)".concat(n.length > 0 ? "/(U)" : "", "]"));
                  });
                case 5:
                  if (C.sent) {
                    C.next = 7;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 7:
                  if (!x.isKeyWordPicked("F")) {
                    C.next = 18;
                    break;
                  }
                  return C.next = 10, N1();
                case 10:
                  if (b = C.sent, b) {
                    C.next = 13;
                    break;
                  }
                  return C.abrupt("return", 0);
                case 13:
                  return M = new ot(), b.forEach(function(Z) {
                    M.addVertexAt(Z);
                  }), n.push([o, o.map(function(Z) {
                    return Z.clone();
                  })]), o.forEach(function(Z) {
                    var W = Z.getMcDbEntity();
                    if (W instanceof Zr) {
                      var J = W.IntersectWith(M, Ie.Intersect.kOnBothOperands);
                      J.isEmpty() || J.forEach(function(Q) {
                        u.copyFormAryId([Z]), f ? c.DoExtend(u.imp, Q.x, Q.y, Q.x, Q.y) : l.DoTrim(u.imp, Q.x, Q.y, Q.x, Q.y);
                      });
                    }
                  }), C.abrupt("return", 1);
                case 18:
                  if (!x.isKeyWordPicked("C")) {
                    C.next = 21;
                    break;
                  }
                  return t = !0, C.abrupt("return", 1);
                case 21:
                  if (!x.isKeyWordPicked("E")) {
                    C.next = 39;
                    break;
                  }
                  return k = new ci(), k.setMessage("<".concat(r ? "" : "", ">")), k.setKeyWords("[(E)/(N)]"), C.next = 27, k.go();
                case 27:
                  if (E = k.keyWordPicked(), k.getStatus() !== Gt.kCancel) {
                    C.next = 30;
                    break;
                  }
                  return C.abrupt("return", {
                    v: void 0
                  });
                case 30:
                  if (k.getStatus() !== Gt.kNone) {
                    C.next = 32;
                    break;
                  }
                  return C.abrupt("return", 1);
                case 32:
                  if (k.getStatus() !== Gt.kKeyWord) {
                    C.next = 39;
                    break;
                  }
                  if (E !== "E") {
                    C.next = 36;
                    break;
                  }
                  return r = !0, C.abrupt("return", 1);
                case 36:
                  if (E !== "N") {
                    C.next = 39;
                    break;
                  }
                  return r = !1, C.abrupt("return", 1);
                case 39:
                  if (!x.isKeyWordPicked("R")) {
                    C.next = 46;
                    break;
                  }
                  return C.next = 42, Bt.userSelect("", i);
                case 42:
                  return S = C.sent, n.push([S, S.map(function(Z) {
                    return Z.clone();
                  })]), S.forEach(function(Z) {
                    Z.erase();
                  }), C.abrupt("return", 1);
                case 46:
                  if (!x.isKeyWordPicked("U")) {
                    C.next = 52;
                    break;
                  }
                  return F = n.pop() || [], O = rr(F, 2), D = O[0], _ = O[1], D == null || D.forEach(function(Z) {
                    Z.erase();
                  }), L = ie.getCurrentMxCAD(), _ == null || _.forEach(function(Z) {
                    Z instanceof xr && L.drawEntity(Z);
                  }), C.abrupt("return", 1);
                case 52:
                  if (G = w.getIds(), G.length != 0) {
                    C.next = 55;
                    break;
                  }
                  return C.abrupt("return", 1);
                case 55:
                  if (V = w.getSelectPoint(), !t) {
                    C.next = 67;
                    break;
                  }
                  return H = V.pt1, U = V.pt2, R = new ot(), R.addVertexAt(H), R.addVertexAt(new te(H.x, U.y)), R.addVertexAt(U), R.addVertexAt(new te(U.x, H.y)), R.isClosed = !0, n.push([o, o.map(function(Z) {
                    return Z.clone();
                  })]), o.forEach(function(Z) {
                    var W = Z.getMcDbEntity();
                    if (W instanceof Zr) {
                      var J = W.IntersectWith(R, Ie.Intersect.kOnBothOperands);
                      J.isEmpty() || J.forEach(function(Q) {
                        u.copyFormAryId([Z]), f ? c.DoExtend(u.imp, Q.x, Q.y, Q.x, Q.y) : l.DoTrim(u.imp, Q.x, Q.y, Q.x, Q.y);
                      });
                    }
                  }), C.abrupt("return", 1);
                case 67:
                  n.push([G, o.map(function(Z) {
                    return Z.clone();
                  })]), u.copyFormAryId(G), f ? c.DoExtend(u.imp, V.pt1.x, V.pt1.y, V.pt2.x, V.pt2.y) : l.DoTrim(u.imp, V.pt1.x, V.pt1.y, V.pt2.x, V.pt2.y);
                case 70:
                case "end":
                  return C.stop();
              }
            }, y);
          });
        case 30:
          return p.delegateYield(g(), "t0", 32);
        case 32:
          if (v = p.t0, v !== 0) {
            p.next = 35;
            break;
          }
          return p.abrupt("break", 41);
        case 35:
          if (v !== 1) {
            p.next = 37;
            break;
          }
          return p.abrupt("continue", 30);
        case 37:
          if (!v) {
            p.next = 39;
            break;
          }
          return p.abrupt("return", v.v);
        case 39:
          p.next = 30;
          break;
        case 41:
          window.removeEventListener("keydown", h), window.removeEventListener("keyup", d), l.UnInit(), c.UnInit();
        case 45:
        case "end":
          return p.stop();
      }
    }, e);
  })), Qd.apply(this, arguments);
}
function g3() {
  return ep.apply(this, arguments);
}
function ep() {
  return ep = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h, d, g, v;
    return be.wrap(function(p) {
      for (; ; ) switch (p.prev = p.next) {
        case 0:
          if (t = new vr(), r = !1, a = !1, t.AddMcDbEntityTypes("LINE,LWPOLYLINE,ARC"), s = Bt.getCurrentSelect(t), s.length !== 0) {
            p.next = 15;
            break;
          }
          return p.next = 9, Bt.userSelect("<>", t, function(y, w) {
            n = w, i = y;
          });
        case 9:
          if (s = p.sent, n.getStatus() !== Gt.kCancel) {
            p.next = 12;
            break;
          }
          return p.abrupt("return");
        case 12:
          if (n.getStatus() === Gt.kNone && s.length === 0 && (i.allSelect(t), i.forEach(function(y) {
            s.push(y);
          })), s.length !== 0) {
            p.next = 15;
            break;
          }
          return p.abrupt("return");
        case 15:
          if (o = new fa(), o.copyFormAryId(s), u = new ie.mxcadassemblyimp.MxDrawExtendAssist(), u.Init(o.imp)) {
            p.next = 20;
            break;
          }
          return p.abrupt("return");
        case 20:
          if (l = new ie.mxcadassemblyimp.MxDrawTrimAssist(), l.Init(o.imp)) {
            p.next = 23;
            break;
          }
          return p.abrupt("return");
        case 23:
          c = [], f = !1, h = function(w) {
            f = w.key === "Shift";
          }, window.addEventListener("keydown", h), d = function() {
            return f = !1;
          }, window.addEventListener("keyup", d), g = /* @__PURE__ */ be.mark(function y() {
            var w, x, b, M, k, E, S, F, O, D, _, L, G, V, H, U;
            return be.wrap(function(B) {
              for (; ; ) switch (B.prev = B.next) {
                case 0:
                  return w = new An(), w.isWhileSelect = !1, w.isSelectHighlight = !1, B.next = 5, w.userSelect(" Shift ", t, function(C) {
                    x = C, x.setKeyWords("[(F)/(C)/(E)".concat(c.length > 0 ? "/(U)" : "", "]"));
                  });
                case 5:
                  if (B.sent) {
                    B.next = 7;
                    break;
                  }
                  return B.abrupt("return", 0);
                case 7:
                  if (!x.isKeyWordPicked("F")) {
                    B.next = 18;
                    break;
                  }
                  return B.next = 10, N1();
                case 10:
                  if (b = B.sent, b) {
                    B.next = 13;
                    break;
                  }
                  return B.abrupt("return", 0);
                case 13:
                  return M = new ot(), b.forEach(function(C) {
                    M.addVertexAt(C);
                  }), c.push([s, s.map(function(C) {
                    return C.clone();
                  })]), s.forEach(function(C) {
                    var Z = C.getMcDbEntity();
                    if (Z instanceof Zr) {
                      var W = Z.IntersectWith(M, Ie.Intersect.kOnBothOperands);
                      W.isEmpty() || W.forEach(function(J) {
                        o.copyFormAryId([C]), f ? l.DoTrim(o.imp, J.x, J.y, J.x, J.y) : u.DoExtend(o.imp, J.x, J.y, J.x, J.y);
                      });
                    }
                  }), B.abrupt("return", 1);
                case 18:
                  if (!x.isKeyWordPicked("C")) {
                    B.next = 21;
                    break;
                  }
                  return r = !0, B.abrupt("return", 1);
                case 21:
                  if (!x.isKeyWordPicked("E")) {
                    B.next = 39;
                    break;
                  }
                  return k = new ci(), k.setMessage("<".concat(a ? "" : "", ">")), k.setKeyWords("[(E)/(N)]"), B.next = 27, k.go();
                case 27:
                  if (E = k.keyWordPicked(), k.getStatus() !== Gt.kCancel) {
                    B.next = 30;
                    break;
                  }
                  return B.abrupt("return", {
                    v: void 0
                  });
                case 30:
                  if (k.getStatus() !== Gt.kNone) {
                    B.next = 32;
                    break;
                  }
                  return B.abrupt("return", 1);
                case 32:
                  if (k.getStatus() !== Gt.kKeyWord) {
                    B.next = 39;
                    break;
                  }
                  if (E !== "E") {
                    B.next = 36;
                    break;
                  }
                  return a = !0, B.abrupt("return", 1);
                case 36:
                  if (E !== "N") {
                    B.next = 39;
                    break;
                  }
                  return a = !1, B.abrupt("return", 1);
                case 39:
                  if (!x.isKeyWordPicked("U")) {
                    B.next = 46;
                    break;
                  }
                  return S = c.pop() || [], F = rr(S, 2), O = F[0], D = F[1], console.log(O), O == null || O.forEach(function(C) {
                    C.erase();
                  }), _ = ie.getCurrentMxCAD(), D == null || D.forEach(function(C) {
                    C instanceof xr && _.drawEntity(C);
                  }), B.abrupt("return", 1);
                case 46:
                  if (L = w.getIds(), L.length != 0) {
                    B.next = 49;
                    break;
                  }
                  return B.abrupt("return", 1);
                case 49:
                  if (G = w.getSelectPoint(), !r) {
                    B.next = 61;
                    break;
                  }
                  return V = G.pt1, H = G.pt2, U = new ot(), U.addVertexAt(V), U.addVertexAt(new te(V.x, H.y)), U.addVertexAt(H), U.addVertexAt(new te(H.x, V.y)), U.isClosed = !0, c.push([s, s.map(function(C) {
                    return C.clone();
                  })]), s.forEach(function(C) {
                    var Z = C.getMcDbEntity();
                    if (Z instanceof Zr) {
                      var W = Z.IntersectWith(U, Ie.Intersect.kOnBothOperands);
                      W.isEmpty() || W.forEach(function(J) {
                        o.copyFormAryId([C]), f ? l.DoTrim(o.imp, J.x, J.y, J.x, J.y) : u.DoExtend(o.imp, J.x, J.y, J.x, J.y);
                      });
                    }
                  }), B.abrupt("return", 1);
                case 61:
                  c.push([L, s.map(function(C) {
                    return C.clone();
                  })]), o.copyFormAryId(L), f ? l.DoTrim(o.imp, G.pt1.x, G.pt1.y, G.pt2.x, G.pt2.y) : u.DoExtend(o.imp, G.pt1.x, G.pt1.y, G.pt2.x, G.pt2.y);
                case 64:
                case "end":
                  return B.stop();
              }
            }, y);
          });
        case 30:
          return p.delegateYield(g(), "t0", 32);
        case 32:
          if (v = p.t0, v !== 0) {
            p.next = 35;
            break;
          }
          return p.abrupt("break", 41);
        case 35:
          if (v !== 1) {
            p.next = 37;
            break;
          }
          return p.abrupt("continue", 30);
        case 37:
          if (!v) {
            p.next = 39;
            break;
          }
          return p.abrupt("return", v.v);
        case 39:
          p.next = 30;
          break;
        case 41:
          window.removeEventListener("keydown", h), window.removeEventListener("keyup", d), l.UnInit(), u.UnInit();
        case 45:
        case "end":
          return p.stop();
      }
    }, e);
  })), ep.apply(this, arguments);
}
function y3() {
  return tp.apply(this, arguments);
}
function tp() {
  return tp = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n;
    return be.wrap(function(a) {
      for (; ; ) switch (a.prev = a.next) {
        case 0:
          return t = new vr(), t.AddMcDbEntityTypes("INSERT,MTEXT,ROTATEDDIMENSION,ALIGNEDDIMENSION,DIMENSION,LWPOLYLINE,CUSTOMENTITY,ACAD_PROXY_ENTITY"), a.next = 4, Bt.userSelect("", t);
        case 4:
          if (r = a.sent, r.length != 0) {
            a.next = 7;
            break;
          }
          return a.abrupt("return");
        case 7:
          n = new fa(), n.copyFormAryId(r), ie.App.MxCADAssist.MxExplode(n.imp);
        case 10:
        case "end":
          return a.stop();
      }
    }, e);
  })), tp.apply(this, arguments);
}
function b3() {
  return rp.apply(this, arguments);
}
function rp() {
  return rp = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n;
    return be.wrap(function(a) {
      for (; ; ) switch (a.prev = a.next) {
        case 0:
          return t = new vr(), t.AddMcDbEntityTypes("LWPOLYLINE,ARC,LINE"), a.next = 4, Bt.userSelect("", t);
        case 4:
          if (r = a.sent, r.length != 0) {
            a.next = 7;
            break;
          }
          return a.abrupt("return");
        case 7:
          n = new fa(), n.copyFormAryId(r), ie.App.MxCADAssist.MxJoin(n.imp);
        case 10:
        case "end":
          return a.stop();
      }
    }, e);
  })), rp.apply(this, arguments);
}
function w3() {
  return np.apply(this, arguments);
}
function np() {
  return np = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o;
    return be.wrap(function(l) {
      for (; ; ) switch (l.prev = l.next) {
        case 0:
          return t = new vr(), t.AddMcDbEntityTypes("LWPOLYLINE,ARC,LINE,CIRCLE"), r = new ki(), r.setFilter(t), r.setMessage(""), l.next = 7, r.go();
        case 7:
          if (n = l.sent, n.isValid()) {
            l.next = 10;
            break;
          }
          return l.abrupt("return");
        case 10:
          if (i = n.getMcDbCurve(), i) {
            l.next = 13;
            break;
          }
          return l.abrupt("return");
        case 13:
          a = r.pickPoint(), i.highlight(!0), s = /* @__PURE__ */ be.mark(function c() {
            var f, h, d, g, v, m, p, y, w, x, b, M, k, E, S, F, O, D;
            return be.wrap(function(L) {
              for (; ; ) switch (L.prev = L.next) {
                case 0:
                  return f = new Zt(), f.setMessage(`
`), f.setKeyWords("[(F)/(D)/(M)/(I)]"), f.setUserDraw(function(G, V) {
                    var H = i == null ? void 0 : i.clone();
                    if (H && H instanceof Zr) {
                      var U = [];
                      U.push(a), U.push(G);
                      var R = H.splitCurves(U);
                      R.empty() || R.forEach(function(B, C) {
                        C % 2 == 0 && V.drawMcDbEntity(B);
                      });
                    }
                  }), L.next = 6, f.go();
                case 6:
                  if (h = L.sent, !f.isKeyWordPicked("F")) {
                    L.next = 17;
                    break;
                  }
                  return f.setMessage(""), f.setKeyWords(""), L.next = 12, f.go();
                case 12:
                  if (d = L.sent, d) {
                    L.next = 15;
                    break;
                  }
                  return L.abrupt("return", {
                    v: void 0
                  });
                case 15:
                  return a = d, L.abrupt("return", 0);
                case 17:
                  if (g = !1, !f.isKeyWordPicked("D")) {
                    L.next = 33;
                    break;
                  }
                  return v = new cr(), v.setMessage(""), v.setKeyWords(""), L.next = 24, v.go();
                case 24:
                  if (m = L.sent, typeof m == "number") {
                    L.next = 27;
                    break;
                  }
                  return L.abrupt("return", {
                    v: void 0
                  });
                case 27:
                  if (a = i.getStartPoint().val, p = i.getPointAtDist(m), y = p.val, w = p.ret, w) {
                    L.next = 31;
                    break;
                  }
                  return L.abrupt("return", {
                    v: Ue.acutPrintf(`
`)
                  });
                case 31:
                  h = y, g = !0;
                case 33:
                  if (!f.isKeyWordPicked("M")) {
                    L.next = 40;
                    break;
                  }
                  if (a = i.getStartPoint().val, x = i.getPointAtDist(i.getLength().val / 2), b = x.val, M = x.ret, M) {
                    L.next = 38;
                    break;
                  }
                  return L.abrupt("return", {
                    v: void 0
                  });
                case 38:
                  h = b, g = !0;
                case 40:
                  if (!f.isKeyWordPicked("I")) {
                    L.next = 56;
                    break;
                  }
                  return L.next = 43, Bt.userSelect("");
                case 43:
                  if (k = L.sent, E = i.clone(), S = [], k.forEach(function(G) {
                    if (E instanceof Zr) {
                      var V = G.clone();
                      if (V instanceof Zr) {
                        var H = E.IntersectWith(V, Ie.Intersect.kOnBothOperands);
                        H.isEmpty() || H.forEach(function(U) {
                          return S.push(U);
                        });
                      }
                    }
                  }), S.length !== 0) {
                    L.next = 49;
                    break;
                  }
                  return L.abrupt("return", {
                    v: Ue.acutPrintf(`
`)
                  });
                case 49:
                  if (F = i.splitCurves(S), !F.empty()) {
                    L.next = 53;
                    break;
                  }
                  return i.highlight(!1), L.abrupt("return", {
                    v: void 0
                  });
                case 53:
                  return F.forEach(function(G) {
                    G instanceof xr && (i && Du(G, i), ie.getCurrentMxCAD().drawEntity(G));
                  }), i.erase(), L.abrupt("return", 1);
                case 56:
                  if (h) {
                    L.next = 59;
                    break;
                  }
                  return i.highlight(!1), L.abrupt("return", {
                    v: void 0
                  });
                case 59:
                  if (O = [], O.push(a), O.push(h), D = i.splitCurves(O), !D.empty()) {
                    L.next = 66;
                    break;
                  }
                  return i.highlight(!1), L.abrupt("return", {
                    v: void 0
                  });
                case 66:
                  return D.forEach(function(G, V) {
                    G instanceof xr && (i && Du(G, i), (V % 2 == 0 || g) && ie.getCurrentMxCAD().drawEntity(G));
                  }), i.erase(), L.abrupt("return", 1);
                case 69:
                case "end":
                  return L.stop();
              }
            }, c);
          });
        case 16:
          return l.delegateYield(s(), "t0", 18);
        case 18:
          if (o = l.t0, o !== 0) {
            l.next = 21;
            break;
          }
          return l.abrupt("continue", 16);
        case 21:
          if (o !== 1) {
            l.next = 23;
            break;
          }
          return l.abrupt("break", 27);
        case 23:
          if (!o) {
            l.next = 25;
            break;
          }
          return l.abrupt("return", o.v);
        case 25:
          l.next = 16;
          break;
        case 27:
        case "end":
          return l.stop();
      }
    }, e);
  })), np.apply(this, arguments);
}
function x3() {
  return ip.apply(this, arguments);
}
function ip() {
  return ip = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n;
    return be.wrap(function(a) {
      for (; ; ) switch (a.prev = a.next) {
        case 0:
          return t = new An(), a.next = 3, t.userSelect(`
`);
        case 3:
          if (a.sent) {
            a.next = 5;
            break;
          }
          return a.abrupt("return");
        case 5:
          r = ie.getCurrentDatabase().currentSpace.getMinMaxDrawOrder(), n = r.maxDrawOrder + 1, t.forEach(function(s) {
            var o = s.getMcDbEntity();
            o && (o.drawOrder = n);
          });
        case 8:
        case "end":
          return a.stop();
      }
    }, e);
  })), ip.apply(this, arguments);
}
function M3() {
  return ap.apply(this, arguments);
}
function ap() {
  return ap = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n;
    return be.wrap(function(a) {
      for (; ; ) switch (a.prev = a.next) {
        case 0:
          return t = new An(), a.next = 3, t.userSelect(`
`);
        case 3:
          if (a.sent) {
            a.next = 5;
            break;
          }
          return a.abrupt("return");
        case 5:
          r = ie.getCurrentDatabase().currentSpace.getMinMaxDrawOrder(), n = r.minDrawOrder - 1, t.forEach(function(s) {
            var o = s.getMcDbEntity();
            o && (o.drawOrder = n);
          });
        case 8:
        case "end":
          return a.stop();
      }
    }, e);
  })), ap.apply(this, arguments);
}
function E3() {
  return sp.apply(this, arguments);
}
function sp() {
  return sp = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a;
    return be.wrap(function(o) {
      for (; ; ) switch (o.prev = o.next) {
        case 0:
          return t = new An(), o.next = 3, t.userSelect(`
`);
        case 3:
          if (o.sent) {
            o.next = 5;
            break;
          }
          return o.abrupt("return");
        case 5:
          if (!t.isNull()) {
            o.next = 7;
            break;
          }
          return o.abrupt("return");
        case 7:
          return r = new ki(), r.setMessage(""), o.next = 11, r.go();
        case 11:
          if (n = o.sent, !n.isNull()) {
            o.next = 14;
            break;
          }
          return o.abrupt("return");
        case 14:
          if (i = n.getMcDbEntity(), i) {
            o.next = 17;
            break;
          }
          return o.abrupt("return");
        case 17:
          a = i.drawOrder + 1, t.forEach(function(u) {
            var l = u.getMcDbEntity();
            l && (l.drawOrder = a);
          });
        case 19:
        case "end":
          return o.stop();
      }
    }, e);
  })), sp.apply(this, arguments);
}
function A3() {
  return op.apply(this, arguments);
}
function op() {
  return op = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a;
    return be.wrap(function(o) {
      for (; ; ) switch (o.prev = o.next) {
        case 0:
          return t = new An(), o.next = 3, t.userSelect(`
`);
        case 3:
          if (o.sent) {
            o.next = 5;
            break;
          }
          return o.abrupt("return");
        case 5:
          if (!t.isNull()) {
            o.next = 7;
            break;
          }
          return o.abrupt("return");
        case 7:
          return r = new ki(), r.setMessage(""), o.next = 11, r.go();
        case 11:
          if (n = o.sent, !n.isNull()) {
            o.next = 14;
            break;
          }
          return o.abrupt("return");
        case 14:
          if (i = n.getMcDbEntity(), i) {
            o.next = 17;
            break;
          }
          return o.abrupt("return");
        case 17:
          a = i.drawOrder - 1, t.forEach(function(u) {
            var l = u.getMcDbEntity();
            l && (l.drawOrder = a);
          });
        case 19:
        case "end":
          return o.stop();
      }
    }, e);
  })), op.apply(this, arguments);
}
var _u = "mx_clip_file_data", T3 = 1;
function U1() {
  var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : T3;
  return new Promise(function(t, r) {
    var n = indexedDB.open("mx_clipboard", e);
    n.onerror = function(i) {
      r(new Error("Error opening database: " + i));
    }, n.onupgradeneeded = function(i) {
      var a = i.target.result;
      a.objectStoreNames.contains(_u) ? console.log("Object store mx_clip_file_data already exists.") : (a.createObjectStore(_u), console.log("Object store mx_clip_file_data created."));
    }, n.onsuccess = function(i) {
      var a = i.target.result;
      console.log("Database opened successfully."), t(a);
    };
  });
}
var go = "_mxcad_clipboard_file.mxweb";
function G1(e) {
  return up.apply(this, arguments);
}
function up() {
  return up = ut(/* @__PURE__ */ be.mark(function e(t) {
    var r, n, i, a, s, o, u, l, c;
    return be.wrap(function(h) {
      for (; ; ) switch (h.prev = h.next) {
        case 0:
          if (r = Bt.getCurrentSelect(null, !0, !1), r.length != 0) {
            h.next = 4;
            break;
          }
          return Ue.acutPrintf(`
 `), h.abrupt("return");
        case 4:
          if (n = ie.getCurrentDatabase(), i = new Va(), n.wblock(i, r)) {
            h.next = 9;
            break;
          }
          return Ue.acutPrintf(`
 `), h.abrupt("return");
        case 9:
          if (i.saveAs(go)) {
            h.next = 12;
            break;
          }
          return Ue.acutPrintf(`
 `), h.abrupt("return");
        case 12:
          return t && r.forEach(function(d) {
            d.erase();
          }), a = window.MX_WASM_FS, s = a.readFile(go), a.unlink(go), h.next = 18, U1();
        case 18:
          o = h.sent, u = o.transaction(_u, "readwrite"), l = u.objectStore(_u), c = l.put(s, "data"), c.onsuccess = function(d) {
            console.log("Data saved to IndexedDB"), console.log(d);
          }, c.onerror = function(d) {
            console.error("Error saving data:", d.target.errorCode), console.log(d);
          };
        case 24:
        case "end":
          return h.stop();
      }
    }, e);
  })), up.apply(this, arguments);
}
function S3() {
  G1(!1);
}
function k3() {
  G1(!0);
}
function C3() {
  return lp.apply(this, arguments);
}
function lp() {
  return lp = ut(/* @__PURE__ */ be.mark(function e() {
    var t, r, n, i, a, s, o, u, l, c, f, h;
    return be.wrap(function(g) {
      for (; ; ) switch (g.prev = g.next) {
        case 0:
          return r = function(m, p) {
            return new Promise(/* @__PURE__ */ function() {
              var y = ut(/* @__PURE__ */ be.mark(function w(x) {
                var b, M, k, E;
                return be.wrap(function(F) {
                  for (; ; ) switch (F.prev = F.next) {
                    case 0:
                      return F.next = 2, U1();
                    case 2:
                      b = F.sent, M = b.transaction(m, "readonly"), k = M.objectStore(m), E = k.get("data"), E.onerror = function() {
                        x(void 0);
                      }, E.onsuccess = function() {
                        var O = E.result, D = window.MX_WASM_FS;
                        D.writeFile(p, O), x(!0);
                      };
                    case 8:
                    case "end":
                      return F.stop();
                  }
                }, w);
              }));
              return function(w) {
                return y.apply(this, arguments);
              };
            }());
          }, t = ie.getCurrentMxCAD(), g.next = 4, r(_u, go);
        case 4:
          if (g.sent) {
            g.next = 7;
            break;
          }
          return Ue.acutPrintf(`
 `), g.abrupt("return");
        case 7:
          if (n = new Va(), n.readFile(go)) {
            g.next = 11;
            break;
          }
          return Ue.acutPrintf(`
 `), g.abrupt("return");
        case 11:
          if (i = window.MX_WASM_FS, i.unlink(go), a = ie.getCurrentDatabase(), s = a.insert(n, ""), !s.isNull()) {
            g.next = 17;
            break;
          }
          return g.abrupt("return");
        case 17:
          return o = s.getMcDbBlockTableRecord(), o && (u = o.getBoundingBox(), u.ret && (o.origin = u.minPt.addvec(u.maxPt.sub(u.minPt).mult(0.5)))), l = new wo(), l.blockTableRecordId = s, c = new Zt(), c.setMessage(""), c.setUserDraw(function(v, m) {
            l.position = v, m.drawMcDbEntity(l);
          }), g.next = 26, c.go();
        case 26:
          if (f = g.sent, f) {
            g.next = 29;
            break;
          }
          return g.abrupt("return");
        case 29:
          if (l.position = f, h = t.drawEntity(l), h.isValid) {
            g.next = 34;
            break;
          }
          return console.log("insert error"), g.abrupt("return");
        case 34:
        case "end":
          return g.stop();
      }
    }, e);
  })), lp.apply(this, arguments);
}
Ue.on("init", function() {
  Ue.addCommand("Mx_Erase", i0), Ue.addCommand("Mx_Copy", r3, no.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT), Ue.addCommand("Mx_Move", n3, no.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT), Ue.addCommand("Mx_Rotate", i3, no.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT), Ue.addCommand("Mx_Scale", a3, no.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT), Ue.addCommand("Mx_WindowZoom", s3), Ue.addCommand("Mx_ZoomE", o3), Ue.addCommand("Mx_Plan90CW", u3), Ue.addCommand("Mx_Offset", l3), Ue.addCommand("Mx_Regen", c3), Ue.addCommand("Mx_Mirror", f3, no.MxCommandFlag.MCRX_CMD_NO_CLEAR_SELECT), Ue.addCommand("Mx_Chamfer", p3), Ue.addCommand("Mx_Fillet", v3), Ue.addCommand("Mx_Trim", m3), Ue.addCommand("Mx_Extend", g3), Ue.addCommand("Mx_Explode", y3), Ue.addCommand("Mx_Join", b3), Ue.addCommand("Mx_Break", w3), Ue.addCommand("Mx_DrawOrderTopmost", x3), Ue.addCommand("Mx_DrawOrderButtomost", M3), Ue.addCommand("Mx_DrawOrderTop", E3), Ue.addCommand("Mx_DrawOrderButtom", A3), Ue.addCommand("Mx_CopyClipboard", S3), Ue.addCommand("Mx_PasteClipboard", C3), Ue.addCommand("Mx_CutClipboard", k3);
});
var cp = function(t, r) {
  return [r.x >= t.x && r.y >= t.y, r.x < t.x && r.y >= t.y, r.x < t.x && r.y < t.y, r.x >= t.x && r.y < t.y];
};
function zm(e, t, r) {
  if (t === 0 && r === 0) return e;
  var n = rr(e, 4), i = n[0], a = n[1], s = n[2], o = n[3], u = i.distanceTo(o), l = i.distanceTo(a), c = cp(i, s), f = rr(c, 4);
  f[0];
  var h = f[1], d = f[2], g = f[3], v = h || d ? -t : t, m = d || g ? -r : r;
  if (u - Math.abs(v) * 2 <= 0 || l - Math.abs(m) * 2 <= 0) return e;
  var p = new te(i.x + v, i.y, i.z), y = new te(i.x, i.y + m, i.z), w = new te(a.x, a.y - m, a.z), x = new te(a.x + v, a.y, a.z), b = new te(s.x - v, s.y, s.z), M = new te(s.x, a.y - m, s.z), k = new te(o.x, o.y + m, o.z), E = new te(o.x - v, o.y, o.z), S = [p, y, w, x, b, M, k, E];
  return S;
}
var Wm = function(t, r, n) {
  var i = Math.cos(n), a = Math.sin(n), s = r.x - t.x, o = r.y - t.y, u = s * i - o * a + t.x, l = s * a + o * i + t.y, c = r.z;
  return new te(u, l, c);
}, Lh = function(t, r) {
  var n = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0, i = new te((t.x + r.x) / 2, (t.y + r.y) / 2, (t.z + r.z) / 2), a = new te(t.x, r.y, t.z), s = new te(r.x, t.y, r.z), o = Wm(i, a, n), u = Wm(i, s, n);
  return [t, o, r, u];
}, a0 = /* @__PURE__ */ function() {
  var e = ut(/* @__PURE__ */ be.mark(function t() {
    var r, n, i, a, s, o, u, l, c, f, h, d, g, v;
    return be.wrap(function(p) {
      for (; ; ) switch (p.prev = p.next) {
        case 0:
          r = new Zt(), n = 0, i = 0, a = 0, s = 0, o = 0, u = 0, l = 200, c = 0, f = 0, h = 0, d = "default", g = /* @__PURE__ */ be.mark(function y() {
            var w, x, b, M, k, E, S, F;
            return be.wrap(function(D) {
              for (; ; ) switch (D.prev = D.next) {
                case 0:
                  return w = /* @__PURE__ */ function() {
                    var _ = ut(/* @__PURE__ */ be.mark(function L(G, V) {
                      var H, U;
                      return be.wrap(function(B) {
                        for (; ; ) switch (B.prev = B.next) {
                          case 0:
                            return H = new cr(), H.setMessage(Ot(G, V)), B.next = 4, H.go();
                          case 4:
                            if (U = B.sent, U) {
                              B.next = 7;
                              break;
                            }
                            throw "error getLength";
                          case 7:
                            return B.abrupt("return", H.value());
                          case 8:
                          case "end":
                            return B.stop();
                        }
                      }, L);
                    }));
                    return function(G, V) {
                      return _.apply(this, arguments);
                    };
                  }(), r.setUserDraw(function() {
                  }), r.clearLastInputPoint(), r.setMessage(`
`), r.setKeyWords("[(C)/(E)/(F)/(T)/(W)]"), D.next = 7, r.go();
                case 7:
                  if (x = D.sent, M = new ot(), D.prev = 9, !r.isKeyWordPicked("C")) {
                    D.next = 19;
                    break;
                  }
                  return D.next = 13, w("ID_ARX_RECTANG_CHAMFEr1LENGTH", `
:`);
                case 13:
                  return n = D.sent, D.next = 16, w("ID_ARX_RECTANG_CHAMFEr2LENGTH", `
`);
                case 16:
                  return i = D.sent, d = "chamfer", D.abrupt("return", 0);
                case 19:
                  if (!r.isKeyWordPicked("E")) {
                    D.next = 24;
                    break;
                  }
                  return D.next = 22, w("ID_ARX_RECTANG_ELEVATION", `
`);
                case 22:
                  return a = D.sent, D.abrupt("return", 0);
                case 24:
                  if (!r.isKeyWordPicked("F")) {
                    D.next = 30;
                    break;
                  }
                  return D.next = 27, w("ID_ARX_RECTANG_RADIUS", `
`);
                case 27:
                  return s = D.sent, d = "angleRounded", D.abrupt("return", 0);
                case 30:
                  if (!r.isKeyWordPicked("T")) {
                    D.next = 35;
                    break;
                  }
                  return D.next = 33, w("ID_ARX_RECTANG_THICKNESS", `
`);
                case 33:
                  return o = D.sent, D.abrupt("return", 0);
                case 35:
                  if (!r.isKeyWordPicked("W")) {
                    D.next = 40;
                    break;
                  }
                  return D.next = 38, w("ID_ARX_RECTANG_WIDTH", `
`);
                case 38:
                  return u = D.sent, D.abrupt("return", 0);
                case 40:
                  D.next = 45;
                  break;
                case 42:
                  return D.prev = 42, D.t0 = D.catch(9), D.abrupt("return", 1);
                case 45:
                  if (x) {
                    D.next = 47;
                    break;
                  }
                  return D.abrupt("return", {
                    v: void 0
                  });
                case 47:
                  return k = function(L, G) {
                    var V = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0;
                    M = new ot(), L.z = G.z = o;
                    var H = Lh(L, G, V), U = new te((L.x + G.x) / 2, (L.y + G.y) / 2, (L.z + G.z) / 2), R = H;
                    if (d === "chamfer" && (R = zm(Lh(L, G), n, i)), d === "angleRounded" && s !== 0) {
                      R = zm(Lh(L, G), s, s);
                      var B = cp(L, G), C = rr(B, 4);
                      C[0];
                      var Z = C[1], W = C[2], J = C[3];
                      if (R.length === 8) {
                        var Q = function(se, ve, me) {
                          var Ae = new Ve(me), Ce = cs(se, ve, Ae);
                          M.addVertexAt(se, Ce), M.addVertexAt(ve, 0);
                        }, j = new Ve(-1, 0), q = new Ve(0, 1), ae = new Ve(1, 0), pe = new Ve(0, -1);
                        J && (q.y = -1, ae.x = 1, pe.y = 1), Z && (j.x = 1, q.y = 1, ae.x = -1, pe.y = -1), W && (j.x = 1, q.y = -1, ae.x = -1, pe.y = 1), Q(R[0], R[1], j), Q(R[2], R[3], q), Q(R[4], R[5], ae), Q(R[6], R[7], pe);
                      } else
                        R.forEach(function($) {
                          M.addVertexAt($, 0);
                        });
                    } else
                      R.forEach(function($) {
                        M.addVertexAt($, 0, u, u);
                      });
                    return (d === "chamfer" || d === "angleRounded") && M.rotate(U, V), M.isClosed = !0, M.constantWidth = u, b = G, M;
                  }, E = function(L, G) {
                    if (x) {
                      var V = x, H = L;
                      M = k(V, H, h), G.drawMcDbEntity(M);
                    }
                  }, r.setUserDraw(E), S = /* @__PURE__ */ function() {
                    var _ = ut(/* @__PURE__ */ be.mark(function L() {
                      var G, V, H, U, R, B, C, Z, W, J, Q;
                      return be.wrap(function(q) {
                        for (; ; ) switch (q.prev = q.next) {
                          case 0:
                            return r.setMessage(`
`), r.setKeyWords("[(A)/(D)/(R)]"), q.next = 4, r.go();
                          case 4:
                            if (G = q.sent, V = function(pe, $) {
                              var se = cp(x, pe), ve = rr(se, 4), me = ve[0], Ae = ve[1], Ce = ve[2], Ee = ve[3];
                              me && (G = new te(x.x + c, x.y + f, o)), Ae && (G = new te(x.x - c, x.y + f, o)), Ce && (G = new te(x.x - c, x.y - f, o)), Ee && (G = new te(x.x + c, x.y - f, o)), G && (M = k(x, G, h), $.drawMcDbEntity(M));
                            }, !r.isKeyWordPicked("A")) {
                              q.next = 40;
                              break;
                            }
                            return r.setUserDraw(function() {
                            }), H = new qf(), H.setMessage("<" + l + ">"), q.next = 12, H.go();
                          case 12:
                            if (U = q.sent, U) {
                              q.next = 15;
                              break;
                            }
                            return q.abrupt("return");
                          case 15:
                            return l = U, R = new ci(), R.setMessage(""), R.setKeyWords("[(L)/(W)]"), q.next = 21, R.go();
                          case 21:
                            if (B = q.sent, B !== null) {
                              q.next = 24;
                              break;
                            }
                            return q.abrupt("return");
                          case 24:
                            if (B !== "w") {
                              q.next = 31;
                              break;
                            }
                            return q.next = 27, w("ID_ARX_RECTANG_AREA_WIDTH", "");
                          case 27:
                            c = q.sent, f = l / c, q.next = 35;
                            break;
                          case 31:
                            return q.next = 33, w("ID_ARX_RECTANG_AREA_LENGTH", "");
                          case 33:
                            f = q.sent, c = l / f;
                          case 35:
                            G = new te(x.x + c, x.y + f, o), M = k(x, G, h), ie.getCurrentMxCAD().drawEntity(M, !0), q.next = 98;
                            break;
                          case 40:
                            if (!r.isKeyWordPicked("D")) {
                              q.next = 62;
                              break;
                            }
                            return q.prev = 41, q.next = 44, w("ID_ARX_RECTANG_AREA_WIDTH", "");
                          case 44:
                            return c = q.sent, q.next = 47, w("ID_ARX_RECTANG_AREA_LENGTH", "");
                          case 47:
                            f = q.sent, q.next = 53;
                            break;
                          case 50:
                            return q.prev = 50, q.t0 = q.catch(41), q.abrupt("return");
                          case 53:
                            return r.clearLastInputPoint(), r.setUserDraw(V), q.next = 57, S();
                          case 57:
                            if (C = q.sent, typeof C != "undefined") {
                              q.next = 60;
                              break;
                            }
                            return q.abrupt("return");
                          case 60:
                            q.next = 98;
                            break;
                          case 62:
                            if (!r.isKeyWordPicked("R")) {
                              q.next = 97;
                              break;
                            }
                            return r.setMessage(`
`), r.setKeyWords("[(P)]"), r.setUserDraw(function(ae, pe) {
                              h = Rr(ae.x, ae.y, x.x, x.y), M = k(x, b), M.rotate(x, h), pe.drawMcDbEntity(M);
                            }), q.next = 68, r.go();
                          case 68:
                            if (Z = q.sent, !r.isKeyWordPicked("P")) {
                              q.next = 87;
                              break;
                            }
                            return r.clearLastInputPoint(), r.setUserDraw(function() {
                            }), r.setMessage(`
`), q.next = 75, r.go();
                          case 75:
                            if (W = q.sent, W) {
                              q.next = 78;
                              break;
                            }
                            return q.abrupt("return");
                          case 78:
                            return r.setUserDraw(function(ae, pe) {
                              pe.drawLine(ae.toVector3(), W.toVector3());
                            }), q.next = 81, r.go();
                          case 81:
                            if (J = q.sent, J) {
                              q.next = 84;
                              break;
                            }
                            return q.abrupt("return");
                          case 84:
                            h = Rr(W.x, W.y, J.x, J.y), q.next = 89;
                            break;
                          case 87:
                            if (Z) {
                              q.next = 89;
                              break;
                            }
                            return q.abrupt("return");
                          case 89:
                            return r.setUserDraw(E), q.next = 92, S();
                          case 92:
                            if (Q = q.sent, typeof Q != "undefined") {
                              q.next = 95;
                              break;
                            }
                            return q.abrupt("return");
                          case 95:
                            q.next = 98;
                            break;
                          case 97:
                            G && ie.getCurrentMxCAD().drawEntity(M, !0);
                          case 98:
                            M.setxDataDouble("BG", a);
                          case 99:
                          case "end":
                            return q.stop();
                        }
                      }, L, null, [[41, 50]]);
                    }));
                    return function() {
                      return _.apply(this, arguments);
                    };
                  }(), D.next = 53, S();
                case 53:
                  if (F = D.sent, typeof F != "undefined") {
                    D.next = 56;
                    break;
                  }
                  return D.abrupt("return", 1);
                case 56:
                case "end":
                  return D.stop();
              }
            }, y, null, [[9, 42]]);
          });
        case 13:
          return p.delegateYield(g(), "t0", 15);
        case 15:
          if (v = p.t0, v !== 0) {
            p.next = 18;
            break;
          }
          return p.abrupt("continue", 13);
        case 18:
          if (v !== 1) {
            p.next = 20;
            break;
          }
          return p.abrupt("break", 24);
        case 20:
          if (!v) {
            p.next = 22;
            break;
          }
          return p.abrupt("return", v.v);
        case 22:
          p.next = 13;
          break;
        case 24:
        case "end":
          return p.stop();
      }
    }, t);
  }));
  return function() {
    return e.apply(this, arguments);
  };
}();
Ue.on("init", function() {
  Ue.addCommand("Mx_Rectang", a0);
});
function D3(e) {
  if (e == null) throw new TypeError("Cannot destructure " + e);
}
var z1 = /* @__PURE__ */ function() {
  function e(t) {
    Pe(this, e), le(this, "imp", {}), le(this, "map", void 0), le(this, "originLngLatLike", [0, 0]), le(this, "originCAD", [0, 0]), le(this, "meterInCADUnits", 1), le(this, "modelAltitude", 0), le(this, "loadOldEditionMethod", !1), le(this, "mxcad", void 0), t ? this.mxcad = t : this.mxcad = new pl();
  }
  return Be(e, [{
    key: "setLoadOldEditionMethod",
    value: function() {
      this.loadOldEditionMethod = !0;
    }
  }, {
    key: "getMxDrawObject",
    value: function() {
      return this.mxcad.getMxDrawObject();
    }
  }, {
    key: "initMapbox",
    value: function(r) {
      this.map = r;
    }
  }, {
    key: "getMapbox",
    value: function() {
      return this.map;
    }
  }, {
    key: "mercatorCoord2CAD",
    value: function(r, n) {
      var i = new THREE.Vector3(r, n, 0);
      return i.applyMatrix4(this.imp.matMapToCad), i;
    }
  }, {
    key: "mercatorCoordToCAD",
    value: function(r, n) {
      var i = new THREE.Vector3(r, n, 0);
      return i.applyMatrix4(this.imp.matMapToCad), i;
    }
  }, {
    key: "cadToMercatorCoord",
    value: function(r) {
      return r.applyMatrix4(this.imp.matCadToMap), r;
    }
  }, {
    key: "lnglatToCAD",
    value: function(r, n) {
      var i = this.lnglat_to_mercator(r, n);
      return this.mercatorCoord2CAD(i.x, i.y);
    }
  }, {
    key: "cadTolnglat",
    value: function(r) {
      var n = this.cadToMercatorCoord(r);
      return this.mercator_to_lnglat(n.x, n.y, 0);
    }
  }, {
    key: "map_meters_to_lnglat",
    value: function(r, n) {
      return r = r / 200375083427892e-7 * 180, n = n / 200375083427892e-7 * 180, n = 180 / Math.PI * (2 * Math.atan(Math.exp(n * Math.PI / 180)) - Math.PI / 2), [r, n];
    }
  }, {
    key: "map_lnglat_to_meters",
    value: function(r, n) {
      var i = r * 200375083427892e-7 / 180, a = Math.log(Math.tan((90 + n) * Math.PI / 360)) / (Math.PI / 180);
      return a = a * 200375083427892e-7 / 180, [i, a];
    }
  }, {
    key: "lnglat_to_mercator",
    value: function(r, n) {
      var i = this.map.lnglat_to_mercator(r, n);
      return new THREE.Vector3(i.x, i.y, 0);
    }
  }, {
    key: "mercator_to_lnglat",
    value: function(r, n, i) {
      var a = this.map.mercator_to_lnglat(r, n, i);
      return [a.lng, a.lat];
    }
  }, {
    key: "outOfChina",
    value: function(r, n) {
      return !(r > 73.66 && r < 135.05 && n > 3.86 && n < 53.55);
    }
  }, {
    key: "cadLongToMercatorCoord",
    value: function(r) {
      var n = new THREE.Vector3(0, 0, 0), i = new THREE.Vector3(r, 0, 0);
      return n.applyMatrix4(this.imp.matCadToMap), i.applyMatrix4(this.imp.matCadToMap), n.distanceTo(i);
    }
  }, {
    key: "setCoordinatePointAlignment",
    value: function(r, n, i) {
      this.originCAD = n, this.originLngLatLike = r, this.meterInCADUnits = i;
    }
  }, {
    key: "create",
    value: function() {
      var t = ut(/* @__PURE__ */ be.mark(function n(i, a) {
        var s, o, u, l, c, f;
        return be.wrap(function(d) {
          for (; ; ) switch (d.prev = d.next) {
            case 0:
              this.map = i, a.middlePan !== void 0 && this.map.dragPan.useMouseMiddle(a.middlePan), a.viewBackgroundColor === void 0 && (a.viewBackgroundColor = {
                red: 255,
                green: 255,
                blue: 255
              }), s = this, o = i.mercatorCoordinate_from_LngLat(s.originLngLatLike, s.modelAltitude), u = o.meterInMercatorCoordinateUnits(), l = s.imp, l.map = i, l.elevation = this.modelAltitude, l.mapOrigin = new THREE.Vector3(o.x, o.y, o.z), l.cadOrigin = new THREE.Vector3(this.originCAD[0], this.originCAD[1], 0), l.mapLenInCADUnits = s.meterInCADUnits * u, f = {
                id: "3d-model",
                type: "custom",
                renderingMode: "3d",
                onAdd: function(v, m) {
                  return ut(/* @__PURE__ */ be.mark(function p() {
                    var y, w;
                    return be.wrap(function(b) {
                      for (; ; ) switch (b.prev = b.next) {
                        case 0:
                          try {
                            l.canvas = v.getCanvas(), l.gl = m, l.canvasContainer = v.getCanvasContainer(), s.loadOldEditionMethod ? (w = a, w.mapBox = l, w.isAutoResize = !0, w.callback = function(M, k) {
                              D3(k), M.addEvent("loadComplete", function() {
                                s.map.triggerRepaint();
                              }), M.emit("viewchange"), c = M;
                            }, Ue.createMxObject(w)) : (a.map = l, y = a.onOpenFileComplete, a.onOpenFileComplete = function(M) {
                              y && y(M), s.map.triggerRepaint(), c = M.mxdraw;
                            }, a.onInit = function() {
                              Ue.setIniset({
                                MapBox: !0
                              });
                            }, eh(a, s.mxcad));
                          } catch (M) {
                            console.log(M);
                          }
                        case 1:
                        case "end":
                          return b.stop();
                      }
                    }, p);
                  }))();
                },
                render: function(v, m) {
                  l.map.repaint = !1, l.render && l.render(v, m);
                }
              }, i.addLayer(f), i.on("resize", function() {
                l.onResize && l.onResize();
              }), i.on("move", function() {
                var g;
                (g = c) === null || g === void 0 || g.emit("viewchange");
              });
            case 16:
            case "end":
              return d.stop();
          }
        }, n, this);
      }));
      function r(n, i) {
        return t.apply(this, arguments);
      }
      return r;
    }()
  }]), e;
}();
function W1(e, t) {
  var r = typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (!r) {
    if (Array.isArray(e) || (r = _3(e)) || t) {
      r && (e = r);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] };
      }, e: function(l) {
        throw l;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a, s = !0, o = !1;
  return { s: function() {
    r = r.call(e);
  }, n: function() {
    var l = r.next();
    return s = l.done, l;
  }, e: function(l) {
    o = !0, a = l;
  }, f: function() {
    try {
      s || r.return == null || r.return();
    } finally {
      if (o) throw a;
    }
  } };
}
function _3(e, t) {
  if (e) {
    if (typeof e == "string") return Vm(e, t);
    var r = {}.toString.call(e).slice(8, -1);
    return r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set" ? Array.from(e) : r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? Vm(e, t) : void 0;
  }
}
function Vm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = Array(t); r < t; r++) n[r] = e[r];
  return n;
}
Object.freeze = function(e) {
  return e;
};
var P3 = Object.create || /* @__PURE__ */ function() {
  function e() {
  }
  return function(t) {
    return e.prototype = t, new e();
  };
}();
function B3(e, t) {
  e.hasOwnProperty("options") || (e.options = e.options ? P3(e.options) : {});
  for (var r in t)
    e.options[r] = t[r] || e.options[r];
  return e.options;
}
var L3 = /\{ *([\w_-]+) *\}/g;
function F3(e, t) {
  return e.replace(L3, function(r, n) {
    var i = t[n];
    if (i === void 0)
      throw new Error("No value provided for variable " + r);
    return typeof i == "function" && (i = i(t)), i;
  });
}
var rh = Array.isArray || function(e) {
  return Object.prototype.toString.call(e) === "[object Array]";
}, Ar = 3.141592653589793, Kc = 6378245, Zc = 0.006693421622965943, Jc = Ar * 3e3 / 180;
function Fh(e, t, r) {
  var n = Ar / 180 * t, i = Math.pow(2, r), a = parseInt((e + 180) / 360 * i), s = parseInt((1 - Math.asinh(Math.tan(n)) / Ar) / 2 * i);
  return [a, s];
}
function I3(e, t, r) {
  var n = Math.pow(2, r), i = e / n * 360 - 180, a = Math.atan(Math.sinh(Ar * (1 - 2 * t / n))), s = a * 180 / Ar;
  return [i, s];
}
function R3(e, t) {
  if (rh(e)) {
    var r = e[0];
    t = e[1], e = r;
  }
  if (e instanceof Object) {
    var r = e.lng;
    t = e.lat, e = r;
  }
  var n = N3(e, t), i = V1(n.lng, n.lat);
  return i;
}
function Hm(e, t) {
  if (rh(e)) {
    var r = e[0];
    t = e[1], e = r;
  }
  if (e instanceof Object) {
    var r = e.lng;
    t = e.lat, e = r;
  }
  var n = fp(e, t), i = O3(n.lng, n.lat);
  return i;
}
function fp(e, t) {
  if (rh(e)) {
    var r = e[0];
    t = e[1], e = r;
  }
  if (e instanceof Object) {
    var r = e.lng;
    t = e.lat, e = r;
  }
  var n = H1(e - 105, t - 35), i = j1(e - 105, t - 35), a = t / 180 * Ar, s = Math.sin(a);
  s = 1 - Zc * s * s;
  var o = Math.sqrt(s);
  n = n * 180 / (Kc * (1 - Zc) / (s * o) * Ar), i = i * 180 / (Kc / o * Math.cos(a) * Ar);
  var u = t + n, l = e + i, c = {
    lng: l,
    lat: u
  };
  return c;
}
function V1(e, t) {
  if (rh(e)) {
    var r = e[0];
    t = e[1], e = r;
  }
  if (e instanceof Object) {
    var r = e.lng;
    t = e.lat, e = r;
  }
  var n = U3(e, t), i = e * 2 - n.lng, a = t * 2 - n.lat, s = {
    lng: i,
    lat: a
  };
  return s;
}
function O3(e, t) {
  var r = Math.sqrt(e * e + t * t) + 2e-5 * Math.sin(t * Jc), n = Math.atan2(t, e) + 3e-6 * Math.cos(e * Jc), i = r * Math.cos(n) + 65e-4, a = r * Math.sin(n) + 6e-3, s = {
    lng: i,
    lat: a
  };
  return s;
}
function N3(e, t) {
  var r = e - 65e-4, n = t - 6e-3, i = Math.sqrt(r * r + n * n) - 2e-5 * Math.sin(n * Jc), a = Math.atan2(n, r) - 3e-6 * Math.cos(r * Jc), s = i * Math.cos(a), o = i * Math.sin(a), u = {
    lng: s,
    lat: o
  };
  return u;
}
function U3(e, t) {
  var r = H1(e - 105, t - 35), n = j1(e - 105, t - 35), i = t / 180 * Ar, a = Math.sin(i);
  a = 1 - Zc * a * a;
  var s = Math.sqrt(a);
  r = r * 180 / (Kc * (1 - Zc) / (a * s) * Ar), n = n * 180 / (Kc / s * Math.cos(i) * Ar);
  var o = t + r, u = e + n, l = {
    lng: u,
    lat: o
  };
  return l;
}
function H1(e, t) {
  var r = -100 + 2 * e + 3 * t + 0.2 * t * t + 0.1 * e * t + 0.2 * Math.sqrt(Math.abs(e));
  return r += (20 * Math.sin(6 * e * Ar) + 20 * Math.sin(2 * e * Ar)) * 2 / 3, r += (20 * Math.sin(t * Ar) + 40 * Math.sin(t / 3 * Ar)) * 2 / 3, r += (160 * Math.sin(t / 12 * Ar) + 320 * Math.sin(t * Ar / 30)) * 2 / 3, r;
}
function j1(e, t) {
  var r = 300 + e + 2 * t + 0.1 * e * e + 0.1 * e * t + 0.1 * Math.sqrt(Math.abs(e));
  return r += (20 * Math.sin(6 * e * Ar) + 20 * Math.sin(2 * e * Ar)) * 2 / 3, r += (20 * Math.sin(e * Ar) + 40 * Math.sin(e / 3 * Ar)) * 2 / 3, r += (150 * Math.sin(e / 12 * Ar) + 300 * Math.sin(e / 30 * Ar)) * 2 / 3, r;
}
function X1(e, t) {
  for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r]);
  return e;
}
function G3(e, t) {
  for (var r in t) e[r] = t[r];
}
function jm(e) {
  return typeof e == "string";
}
var Xm = void 0, Il = null;
function zn(e, t) {
  isNaN(e) && (e = Ib(e), e = isNaN(e) ? 0 : e), jm(e) && (e = parseFloat(e)), isNaN(t) && (t = Ib(t), t = isNaN(t) ? 0 : t), jm(t) && (t = parseFloat(t)), this.lng = e, this.lat = t;
}
zn.TL = function(e) {
  return e && 180 >= e.lng && -180 <= e.lng && 74 >= e.lat && -74 <= e.lat;
};
zn.prototype.lb = function(e) {
  return e && this.lat == e.lat && this.lng == e.lng;
};
function Qc(e, t) {
  this.x = e || 0, this.y = t || 0, this.x = this.x, this.y = this.y;
}
Qc.prototype.lb = function(e) {
  return e && e.x == this.x && e.y == this.y;
};
function s0() {
}
s0.prototype.nh = function() {
  aa("lngLatToPoint");
};
s0.prototype.wi = function() {
  aa("pointToLngLat");
};
function Ki() {
}
Ki.prototype = new s0();
X1(Ki, {
  $O: 637099681e-2,
  lG: [1289059486e-2, 836237787e-2, 5591021, 348198983e-2, 167804312e-2, 0],
  Au: [75, 60, 45, 30, 15, 0],
  fP: [[1410526172116255e-23, 898305509648872e-20, -1.9939833816331, 200.9824383106796, -187.2403703815547, 91.6087516669843, -23.38765649603339, 2.57121317296198, -0.03801003308653, 173379812e-1], [-7435856389565537e-24, 8983055097726239e-21, -0.78625201886289, 96.32687599759846, -1.85204757529826, -59.36935905485877, 47.40033549296737, -16.50741931063887, 2.28786674699375, 1026014486e-2], [-3030883460898826e-23, 898305509983578e-20, 0.30071316287616, 59.74293618442277, 7.357984074871, -25.38371002664745, 13.45380521110908, -3.29883767235584, 0.32710905363475, 685681737e-2], [-1981981304930552e-23, 8983055099779535e-21, 0.03278182852591, 40.31678527705744, 0.65659298677277, -4.44255534477492, 0.85341911805263, 0.12923347998204, -0.04625736007561, 448277706e-2], [309191371068437e-23, 8983055096812155e-21, 6995724062e-14, 23.10934304144901, -23663490511e-14, -0.6321817810242, -0.00663494467273, 0.03430082397953, -0.00466043876332, 25551644e-1], [2890871144776878e-24, 8983055095805407e-21, -3068298e-14, 7.47137025468032, -353937994e-14, -0.02145144861037, -1234426596e-14, 10322952773e-14, -323890364e-14, 826088.5]],
  iG: [[-0.0015702102444, 111320.7020616939, 1704480524535203, -10338987376042340, 26112667856603880, -35149669176653700, 26595700718403920, -10725012454188240, 1800819912950474, 82.5], [8277824516172526e-19, 111320.7020463578, 6477955746671607e-7, -4082003173641316e-6, 1077490566351142e-5, -1517187553151559e-5, 1205306533862167e-5, -5124939663577472e-6, 9133119359512032e-7, 67.5], [0.00337398766765, 111320.7020202162, 4481351045890365e-9, -2339375119931662e-8, 7968221547186455e-8, -1159649932797253e-7, 9723671115602145e-8, -4366194633752821e-8, 8477230501135234e-9, 52.5], [0.00220636496208, 111320.7020209128, 51751.86112841131, 3796837749470245e-9, 992013.7397791013, -122195221711287e-8, 1340652697009075e-9, -620943.6990984312, 144416.9293806241, 37.5], [-3441963504368392e-19, 111320.7020576856, 278.2353980772752, 2485758690035394e-9, 6070.750963243378, 54821.18345352118, 9540.606633304236, -2710.55326746645, 1405.483844121726, 22.5], [-3218135878613132e-19, 111320.7020701615, 0.00369383431289, 823725.6402795718, 0.46104986909093, 2351.343141331292, 1.58060784298199, 8.77738589078284, 0.37238884252424, 7.45]],
  Z1: function(a, r) {
    if (!a || !r) return 0;
    var n, i, a = this.Fb(a);
    return a ? (n = this.Tk(a.lng), i = this.Tk(a.lat), r = this.Fb(r), r ? this.Pe(n, this.Tk(r.lng), i, this.Tk(r.lat)) : 0) : 0;
  },
  Vo: function(t, r) {
    return !t || !r ? 0 : (t.lng = this.JD(t.lng, -180, 180), t.lat = this.ND(t.lat, -74, 74), r.lng = this.JD(r.lng, -180, 180), r.lat = this.ND(r.lat, -74, 74), this.Pe(this.Tk(t.lng), this.Tk(r.lng), this.Tk(t.lat), this.Tk(r.lat)));
  },
  Fb: function(t) {
    if (t === Il || t === Xm) return new zn(0, 0);
    var r, n;
    r = new zn(Math.abs(t.lng), Math.abs(t.lat));
    for (var i = 0; i < this.lG.length; i++) if (r.lat >= this.lG[i]) {
      n = this.fP[i];
      break;
    }
    return t = this.gK(t, n), t = new zn(t.lng.toFixed(6), t.lat.toFixed(6));
  },
  Eb: function(t) {
    if (t === Il || t === Xm || 180 < t.lng || -180 > t.lng || 90 < t.lat || -90 > t.lat) return new zn(0, 0);
    var r, n;
    t.lng = this.JD(t.lng, -180, 180), t.lat = this.ND(t.lat, -74, 74), r = new zn(t.lng, t.lat);
    for (var i = 0; i < this.Au.length; i++) if (r.lat >= this.Au[i]) {
      n = this.iG[i];
      break;
    }
    if (!n) {
      for (i = 0; i < this.Au.length; i++) if (r.lat <= -this.Au[i]) {
        n = this.iG[i];
        break;
      }
    }
    return t = this.gK(t, n), t = new zn(t.lng.toFixed(2), t.lat.toFixed(2));
  },
  gK: function(t, r) {
    if (t && r) {
      var n = r[0] + r[1] * Math.abs(t.lng), i = Math.abs(t.lat) / r[9], i = r[2] + r[3] * i + r[4] * i * i + r[5] * i * i * i + r[6] * i * i * i * i + r[7] * i * i * i * i * i + r[8] * i * i * i * i * i * i, n = n * (0 > t.lng ? -1 : 1), i = i * (0 > t.lat ? -1 : 1);
      return new zn(n, i);
    }
  },
  Pe: function(t, r, n, i) {
    return this.$O * Math.acos(Math.sin(n) * Math.sin(i) + Math.cos(n) * Math.cos(i) * Math.cos(r - t));
  },
  Tk: function(t) {
    return Math.PI * t / 180;
  },
  Z3: function(t) {
    return 180 * t / Math.PI;
  },
  ND: function(t, r, n) {
    return r != Il && (t = Math.max(t, r)), n != Il && (t = Math.min(t, n)), t;
  },
  JD: function(t, r, n) {
    for (; t > n; ) t -= n - r;
    for (; t < r; ) t += n - r;
    return t;
  }
});
X1(Ki.prototype, {
  Jm: function(t) {
    return Ki.Eb(t);
  },
  nh: function(t) {
    return t = Ki.Eb(t), new Qc(t.lng, t.lat);
  },
  qh: function(t) {
    return Ki.Fb(t);
  },
  wi: function(t) {
    return t = new zn(t.x, t.y), Ki.Fb(t);
  },
  fc: function(t, r, n, i, a) {
    if (t) return t = this.Jm(t, a), r = this.Lc(r), new Qc(Math.round((t.lng - n.lng) / r + i.width / 2), Math.round((n.lat - t.lat) / r + i.height / 2));
  },
  zb: function(t, r, n, i, a) {
    if (t) return r = this.Lc(r), this.qh(new zn(n.lng + r * (t.x - i.width / 2), n.lat - r * (t.y - i.height / 2)), a);
  },
  Lc: function(t) {
    return Math.pow(2, 18 - t);
  }
});
var Ih = Ki.prototype;
G3(Ih, {
  lngLatToPoint: Ih.nh,
  pointToLngLat: Ih.wi
});
var Rh = {
  Point: zn,
  Pixel: Qc,
  MercatorProjection: Ki
}, z3 = /* @__PURE__ */ function() {
  function e(t, r) {
    Pe(this, e), this.levelMax = t, this.levelMin = r, this.projection = new Rh.MercatorProjection();
  }
  return Be(e, [{
    key: "_getRetain",
    value: function(r) {
      return Math.pow(2, r - 18);
    }
    /*
     * (m)
     * 18(m)
     * {lng:180, lat:0}pointX
     */
  }, {
    key: "getResolution",
    value: function(r, n) {
      return Math.pow(2, 18 - n) * Math.cos(r);
    }
    /*
     * 
     */
  }, {
    key: "lnglatToPoint",
    value: function(r, n) {
      var i = new Rh.Point(r, n), a = this.projection.lngLatToPoint(i);
      return {
        pointX: a.x,
        pointY: a.y
      };
    }
    /*
     * 
     */
  }, {
    key: "pointToLnglat",
    value: function(r, n) {
      var i = new Rh.Pixel(r, n), a = this.projection.pointToLngLat(i);
      return {
        lng: a.lng,
        lat: a.lat
      };
    }
  }, {
    key: "_lngToTileX",
    value: function(r, n) {
      var i = this.lnglatToPoint(r, 0), a = Math.floor(i.pointX * this._getRetain(n) / 256);
      return a;
    }
  }, {
    key: "_latToTileY",
    value: function(r, n) {
      var i = this.lnglatToPoint(0, r), a = Math.floor(i.pointY * this._getRetain(n) / 256);
      return a;
    }
    /*
     * 
     */
  }, {
    key: "lnglatToTile",
    value: function(r, n, i) {
      var a = this._lngToTileX(r, i), s = this._latToTileY(n, i);
      return [a, s];
    }
  }, {
    key: "_lngToPixelX",
    value: function(r, n) {
      var i = this._lngToTileX(r, n), a = this.lnglatToPoint(r, 0), s = Math.floor(a.pointX * this._getRetain(n) - i * 256);
      return s;
    }
  }, {
    key: "_latToPixelY",
    value: function(r, n) {
      var i = this._latToTileY(r, n), a = this.lnglatToPoint(0, r), s = Math.floor(a.pointY * this._getRetain(n) - i * 256);
      return s;
    }
    /*
     * 
     */
  }, {
    key: "lnglatToPixel",
    value: function(r, n, i) {
      var a = this._lngToPixelX(r, i), s = this._latToPixelY(n, i);
      return {
        pixelX: a,
        pixelY: s
      };
    }
  }, {
    key: "_pixelXToLng",
    value: function(r, n, i) {
      var a = (n * 256 + r) / this._getRetain(i), s = this.pointToLnglat(a, 0);
      return s.lng;
    }
  }, {
    key: "_pixelYToLat",
    value: function(r, n, i) {
      var a = (n * 256 + r) / this._getRetain(i), s = this.pointToLnglat(0, a);
      return s.lat;
    }
    /*
     * 
     */
  }, {
    key: "pixelToLnglat",
    value: function(r, n, i, a, s) {
      var o = (i * 256 + r) / this._getRetain(s), u = (a * 256 + n) / this._getRetain(s), l = this.pointToLnglat(o, u);
      return [l.lng, l.lat];
    }
  }]), e;
}();
function q1(e, t) {
  if (!(e instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
function W3(e, t) {
  for (var r = 0; r < t.length; r++) {
    var n = t[r];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
  }
}
function $1(e, t, r) {
  return t && W3(e.prototype, t), Object.defineProperty(e, "prototype", {
    writable: !1
  }), e;
}
function hp(e) {
  "@babel/helpers - typeof";
  return hp = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, hp(e);
}
function du(e) {
  if (e === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return e;
}
function V3(e, t) {
  if (t && (hp(t) === "object" || typeof t == "function"))
    return t;
  if (t !== void 0)
    throw new TypeError("Derived constructors may only return object or undefined");
  return du(e);
}
function dp(e) {
  return dp = Object.setPrototypeOf ? Object.getPrototypeOf : function(r) {
    return r.__proto__ || Object.getPrototypeOf(r);
  }, dp(e);
}
function pp(e, t) {
  return pp = Object.setPrototypeOf || function(n, i) {
    return n.__proto__ = i, n;
  }, pp(e, t);
}
function H3(e, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Super expression must either be null or a function");
  e.prototype = Object.create(t && t.prototype, {
    constructor: {
      value: e,
      writable: !0,
      configurable: !0
    }
  }), Object.defineProperty(e, "prototype", {
    writable: !1
  }), t && pp(e, t);
}
function j3(e) {
  if (Array.isArray(e)) return e;
}
function X3(e, t) {
  var r = e == null ? null : typeof Symbol != "undefined" && e[Symbol.iterator] || e["@@iterator"];
  if (r != null) {
    var n = [], i = !0, a = !1, s, o;
    try {
      for (r = r.call(e); !(i = (s = r.next()).done) && (n.push(s.value), !(t && n.length === t)); i = !0)
        ;
    } catch (u) {
      a = !0, o = u;
    } finally {
      try {
        !i && r.return != null && r.return();
      } finally {
        if (a) throw o;
      }
    }
    return n;
  }
}
function qm(e, t) {
  (t == null || t > e.length) && (t = e.length);
  for (var r = 0, n = new Array(t); r < t; r++)
    n[r] = e[r];
  return n;
}
function q3(e, t) {
  if (e) {
    if (typeof e == "string") return qm(e, t);
    var r = Object.prototype.toString.call(e).slice(8, -1);
    if (r === "Object" && e.constructor && (r = e.constructor.name), r === "Map" || r === "Set") return Array.from(e);
    if (r === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)) return qm(e, t);
  }
}
function $3() {
  throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function jn(e, t) {
  return j3(e) || X3(e, t) || q3(e, t) || $3();
}
var rn = 1e-6, To = typeof Float32Array != "undefined" ? Float32Array : Array;
Math.hypot || (Math.hypot = function() {
  for (var e = 0, t = arguments.length; t--; )
    e += arguments[t] * arguments[t];
  return Math.sqrt(e);
});
function Y3() {
  var e = new To(4);
  return To != Float32Array && (e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 0), e;
}
function K3(e, t, r) {
  return e[0] = t[0] * r, e[1] = t[1] * r, e[2] = t[2] * r, e[3] = t[3] * r, e;
}
function Y1(e, t, r) {
  var n = t[0], i = t[1], a = t[2], s = t[3];
  return e[0] = r[0] * n + r[4] * i + r[8] * a + r[12] * s, e[1] = r[1] * n + r[5] * i + r[9] * a + r[13] * s, e[2] = r[2] * n + r[6] * i + r[10] * a + r[14] * s, e[3] = r[3] * n + r[7] * i + r[11] * a + r[15] * s, e;
}
(function() {
  var e = Y3();
  return function(t, r, n, i, a, s) {
    var o, u;
    for (r || (r = 4), n || (n = 0), i ? u = Math.min(i * r + n, t.length) : u = t.length, o = n; o < u; o += r)
      e[0] = t[o], e[1] = t[o + 1], e[2] = t[o + 2], e[3] = t[o + 3], a(e, e, s), t[o] = e[0], t[o + 1] = e[1], t[o + 2] = e[2], t[o + 3] = e[3];
    return t;
  };
})();
function bu() {
  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];
}
function xc(e, t) {
  var r = Y1([], t, e);
  return K3(r, r, 1 / r[3]), r;
}
function Z3(e, t) {
  var r = t[0], n = t[1], i = t[2], a = t[3], s = t[4], o = t[5], u = t[6], l = t[7], c = t[8], f = t[9], h = t[10], d = t[11], g = t[12], v = t[13], m = t[14], p = t[15], y = r * o - n * s, w = r * u - i * s, x = r * l - a * s, b = n * u - i * o, M = n * l - a * o, k = i * l - a * u, E = c * v - f * g, S = c * m - h * g, F = c * p - d * g, O = f * m - h * v, D = f * p - d * v, _ = h * p - d * m, L = y * _ - w * D + x * O + b * F - M * S + k * E;
  return L ? (L = 1 / L, e[0] = (o * _ - u * D + l * O) * L, e[1] = (i * D - n * _ - a * O) * L, e[2] = (v * k - m * M + p * b) * L, e[3] = (h * M - f * k - d * b) * L, e[4] = (u * F - s * _ - l * S) * L, e[5] = (r * _ - i * F + a * S) * L, e[6] = (m * x - g * k - p * w) * L, e[7] = (c * k - h * x + d * w) * L, e[8] = (s * D - o * F + l * E) * L, e[9] = (n * F - r * D - a * E) * L, e[10] = (g * M - v * x + p * y) * L, e[11] = (f * x - c * M - d * y) * L, e[12] = (o * S - s * O - u * E) * L, e[13] = (r * O - n * S + i * E) * L, e[14] = (v * w - g * b - m * y) * L, e[15] = (c * b - f * w + h * y) * L, e) : null;
}
function wu(e, t, r) {
  var n = t[0], i = t[1], a = t[2], s = t[3], o = t[4], u = t[5], l = t[6], c = t[7], f = t[8], h = t[9], d = t[10], g = t[11], v = t[12], m = t[13], p = t[14], y = t[15], w = r[0], x = r[1], b = r[2], M = r[3];
  return e[0] = w * n + x * o + b * f + M * v, e[1] = w * i + x * u + b * h + M * m, e[2] = w * a + x * l + b * d + M * p, e[3] = w * s + x * c + b * g + M * y, w = r[4], x = r[5], b = r[6], M = r[7], e[4] = w * n + x * o + b * f + M * v, e[5] = w * i + x * u + b * h + M * m, e[6] = w * a + x * l + b * d + M * p, e[7] = w * s + x * c + b * g + M * y, w = r[8], x = r[9], b = r[10], M = r[11], e[8] = w * n + x * o + b * f + M * v, e[9] = w * i + x * u + b * h + M * m, e[10] = w * a + x * l + b * d + M * p, e[11] = w * s + x * c + b * g + M * y, w = r[12], x = r[13], b = r[14], M = r[15], e[12] = w * n + x * o + b * f + M * v, e[13] = w * i + x * u + b * h + M * m, e[14] = w * a + x * l + b * d + M * p, e[15] = w * s + x * c + b * g + M * y, e;
}
function vp(e, t, r) {
  var n = r[0], i = r[1], a = r[2], s, o, u, l, c, f, h, d, g, v, m, p;
  return t === e ? (e[12] = t[0] * n + t[4] * i + t[8] * a + t[12], e[13] = t[1] * n + t[5] * i + t[9] * a + t[13], e[14] = t[2] * n + t[6] * i + t[10] * a + t[14], e[15] = t[3] * n + t[7] * i + t[11] * a + t[15]) : (s = t[0], o = t[1], u = t[2], l = t[3], c = t[4], f = t[5], h = t[6], d = t[7], g = t[8], v = t[9], m = t[10], p = t[11], e[0] = s, e[1] = o, e[2] = u, e[3] = l, e[4] = c, e[5] = f, e[6] = h, e[7] = d, e[8] = g, e[9] = v, e[10] = m, e[11] = p, e[12] = s * n + c * i + g * a + t[12], e[13] = o * n + f * i + v * a + t[13], e[14] = u * n + h * i + m * a + t[14], e[15] = l * n + d * i + p * a + t[15]), e;
}
function mp(e, t, r) {
  var n = r[0], i = r[1], a = r[2];
  return e[0] = t[0] * n, e[1] = t[1] * n, e[2] = t[2] * n, e[3] = t[3] * n, e[4] = t[4] * i, e[5] = t[5] * i, e[6] = t[6] * i, e[7] = t[7] * i, e[8] = t[8] * a, e[9] = t[9] * a, e[10] = t[10] * a, e[11] = t[11] * a, e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e;
}
function J3(e, t, r) {
  var n = Math.sin(r), i = Math.cos(r), a = t[4], s = t[5], o = t[6], u = t[7], l = t[8], c = t[9], f = t[10], h = t[11];
  return t !== e && (e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]), e[4] = a * i + l * n, e[5] = s * i + c * n, e[6] = o * i + f * n, e[7] = u * i + h * n, e[8] = l * i - a * n, e[9] = c * i - s * n, e[10] = f * i - o * n, e[11] = h * i - u * n, e;
}
function Q3(e, t, r) {
  var n = Math.sin(r), i = Math.cos(r), a = t[0], s = t[1], o = t[2], u = t[3], l = t[4], c = t[5], f = t[6], h = t[7];
  return t !== e && (e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15]), e[0] = a * i + l * n, e[1] = s * i + c * n, e[2] = o * i + f * n, e[3] = u * i + h * n, e[4] = l * i - a * n, e[5] = c * i - s * n, e[6] = f * i - o * n, e[7] = h * i - u * n, e;
}
function eE(e, t, r, n, i) {
  var a = 1 / Math.tan(t / 2), s;
  return e[0] = a / r, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = a, e[6] = 0, e[7] = 0, e[8] = 0, e[9] = 0, e[11] = -1, e[12] = 0, e[13] = 0, e[15] = 0, i != null && i !== 1 / 0 ? (s = 1 / (n - i), e[10] = (i + n) * s, e[14] = 2 * i * n * s) : (e[10] = -1, e[14] = -2 * n), e;
}
var tE = eE;
function $m(e, t) {
  var r = e[0], n = e[1], i = e[2], a = e[3], s = e[4], o = e[5], u = e[6], l = e[7], c = e[8], f = e[9], h = e[10], d = e[11], g = e[12], v = e[13], m = e[14], p = e[15], y = t[0], w = t[1], x = t[2], b = t[3], M = t[4], k = t[5], E = t[6], S = t[7], F = t[8], O = t[9], D = t[10], _ = t[11], L = t[12], G = t[13], V = t[14], H = t[15];
  return Math.abs(r - y) <= rn * Math.max(1, Math.abs(r), Math.abs(y)) && Math.abs(n - w) <= rn * Math.max(1, Math.abs(n), Math.abs(w)) && Math.abs(i - x) <= rn * Math.max(1, Math.abs(i), Math.abs(x)) && Math.abs(a - b) <= rn * Math.max(1, Math.abs(a), Math.abs(b)) && Math.abs(s - M) <= rn * Math.max(1, Math.abs(s), Math.abs(M)) && Math.abs(o - k) <= rn * Math.max(1, Math.abs(o), Math.abs(k)) && Math.abs(u - E) <= rn * Math.max(1, Math.abs(u), Math.abs(E)) && Math.abs(l - S) <= rn * Math.max(1, Math.abs(l), Math.abs(S)) && Math.abs(c - F) <= rn * Math.max(1, Math.abs(c), Math.abs(F)) && Math.abs(f - O) <= rn * Math.max(1, Math.abs(f), Math.abs(O)) && Math.abs(h - D) <= rn * Math.max(1, Math.abs(h), Math.abs(D)) && Math.abs(d - _) <= rn * Math.max(1, Math.abs(d), Math.abs(_)) && Math.abs(g - L) <= rn * Math.max(1, Math.abs(g), Math.abs(L)) && Math.abs(v - G) <= rn * Math.max(1, Math.abs(v), Math.abs(G)) && Math.abs(m - V) <= rn * Math.max(1, Math.abs(m), Math.abs(V)) && Math.abs(p - H) <= rn * Math.max(1, Math.abs(p), Math.abs(H));
}
function rE() {
  var e = new To(2);
  return To != Float32Array && (e[0] = 0, e[1] = 0), e;
}
function Ym(e, t, r) {
  return e[0] = t[0] + r[0], e[1] = t[1] + r[1], e;
}
function nE(e, t) {
  return e[0] = -t[0], e[1] = -t[1], e;
}
function iE(e, t, r, n) {
  var i = t[0], a = t[1];
  return e[0] = i + n * (r[0] - i), e[1] = a + n * (r[1] - a), e;
}
(function() {
  var e = rE();
  return function(t, r, n, i, a, s) {
    var o, u;
    for (r || (r = 2), n || (n = 0), i ? u = Math.min(i * r + n, t.length) : u = t.length, o = n; o < u; o += r)
      e[0] = t[o], e[1] = t[o + 1], a(e, e, s), t[o] = e[0], t[o + 1] = e[1];
    return t;
  };
})();
function aE() {
  var e = new To(3);
  return To != Float32Array && (e[0] = 0, e[1] = 0, e[2] = 0), e;
}
function sE(e, t) {
  return e[0] = -t[0], e[1] = -t[1], e[2] = -t[2], e;
}
(function() {
  var e = aE();
  return function(t, r, n, i, a, s) {
    var o, u;
    for (r || (r = 3), n || (n = 0), i ? u = Math.min(i * r + n, t.length) : u = t.length, o = n; o < u; o += r)
      e[0] = t[o], e[1] = t[o + 1], e[2] = t[o + 2], a(e, e, s), t[o] = e[0], t[o + 1] = e[1], t[o + 2] = e[2];
    return t;
  };
})();
function ms(e, t) {
  if (!e)
    throw new Error(t || "viewport-mercator-project: assertion failed.");
}
var ui = Math.PI, K1 = ui / 4, _a = ui / 180, Km = 180 / ui, o0 = 512, Zm = 4003e4, oE = 1.5;
function Z1(e) {
  return Math.pow(2, e);
}
function Oh(e, t) {
  var r = jn(e, 2), n = r[0], i = r[1];
  ms(Number.isFinite(n) && Number.isFinite(t)), ms(Number.isFinite(i) && i >= -90 && i <= 90, "invalid latitude"), t *= o0;
  var a = n * _a, s = i * _a, o = t * (a + ui) / (2 * ui), u = t * (ui - Math.log(Math.tan(K1 + s * 0.5))) / (2 * ui);
  return [o, u];
}
function Jm(e, t) {
  var r = jn(e, 2), n = r[0], i = r[1];
  t *= o0;
  var a = n / t * (2 * ui) - ui, s = 2 * (Math.atan(Math.exp(ui - i / t * (2 * ui))) - K1);
  return [a * Km, s * Km];
}
function uE(e) {
  var t = e.latitude, r = e.longitude, n = e.zoom, i = e.scale, a = e.highPrecision, s = a === void 0 ? !1 : a;
  i = i !== void 0 ? i : Z1(n), ms(Number.isFinite(t) && Number.isFinite(r) && Number.isFinite(i));
  var o = {}, u = o0 * i, l = Math.cos(t * _a), c = u / 360, f = c / l, h = u / Zm / l;
  if (o.pixelsPerMeter = [h, -h, h], o.metersPerPixel = [1 / h, -1 / h, 1 / h], o.pixelsPerDegree = [c, -f, h], o.degreesPerPixel = [1 / c, -1 / f, 1 / h], s) {
    var d = _a * Math.tan(t * _a) / l, g = c * d / 2, v = u / Zm * d, m = v / f * h;
    o.pixelsPerDegree2 = [0, -g, v], o.pixelsPerMeter2 = [m, 0, m];
  }
  return o;
}
function lE(e) {
  var t = e.height, r = e.pitch, n = e.bearing, i = e.altitude, a = e.center, s = a === void 0 ? null : a, o = bu();
  return vp(o, o, [0, 0, -i]), mp(o, o, [1, 1, 1 / t]), J3(o, o, -r * _a), Q3(o, o, n * _a), mp(o, o, [1, -1, 1]), s && vp(o, o, sE([], s)), o;
}
function cE(e) {
  var t = e.width, r = e.height, n = e.altitude, i = n === void 0 ? oE : n, a = e.pitch, s = a === void 0 ? 0 : a, o = e.nearZMultiplier, u = o === void 0 ? 1 : o, l = e.farZMultiplier, c = l === void 0 ? 1 : l, f = s * _a, h = Math.atan(0.5 / i), d = Math.sin(h) * i / Math.sin(Math.PI / 2 - f - h), g = Math.cos(Math.PI / 2 - f) * d + i;
  return {
    fov: 2 * Math.atan(r / 2 / i),
    aspect: t / r,
    focalDistance: i,
    near: u,
    far: g * c
  };
}
function fE(e) {
  var t = e.width, r = e.height, n = e.pitch, i = e.altitude, a = e.nearZMultiplier, s = e.farZMultiplier, o = cE({
    width: t,
    height: r,
    altitude: i,
    pitch: n,
    nearZMultiplier: a,
    farZMultiplier: s
  }), u = o.fov, l = o.aspect, c = o.near, f = o.far, h = tE([], u, l, c, f);
  return h;
}
function hE(e, t) {
  var r = jn(e, 3), n = r[0], i = r[1], a = r[2], s = a === void 0 ? 0 : a;
  return ms(Number.isFinite(n) && Number.isFinite(i) && Number.isFinite(s)), xc(t, [n, i, s, 1]);
}
function J1(e, t) {
  var r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0, n = jn(e, 3), i = n[0], a = n[1], s = n[2];
  if (ms(Number.isFinite(i) && Number.isFinite(a), "invalid pixel coordinate"), Number.isFinite(s)) {
    var o = xc(t, [i, a, s, 1]);
    return o;
  }
  var u = xc(t, [i, a, 0, 1]), l = xc(t, [i, a, 1, 1]), c = u[2], f = l[2], h = c === f ? 0 : ((r || 0) - c) / (f - c);
  return iE([], u, l, h);
}
var Qm = bu(), dE = function() {
  function e() {
    var t = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, r = t.width, n = t.height, i = t.viewMatrix, a = i === void 0 ? Qm : i, s = t.projectionMatrix, o = s === void 0 ? Qm : s;
    q1(this, e), this.width = r || 1, this.height = n || 1, this.scale = 1, this.pixelsPerMeter = 1, this.viewMatrix = a, this.projectionMatrix = o;
    var u = bu();
    wu(u, u, this.projectionMatrix), wu(u, u, this.viewMatrix), this.viewProjectionMatrix = u;
    var l = bu();
    mp(l, l, [this.width / 2, -this.height / 2, 1]), vp(l, l, [1, -1, 0]), wu(l, l, this.viewProjectionMatrix);
    var c = Z3(bu(), l);
    if (!c)
      throw new Error("Pixel project matrix not invertible");
    this.pixelProjectionMatrix = l, this.pixelUnprojectionMatrix = c, this.equals = this.equals.bind(this), this.project = this.project.bind(this), this.unproject = this.unproject.bind(this), this.projectPosition = this.projectPosition.bind(this), this.unprojectPosition = this.unprojectPosition.bind(this), this.projectFlat = this.projectFlat.bind(this), this.unprojectFlat = this.unprojectFlat.bind(this);
  }
  return $1(e, [{
    key: "equals",
    value: function(r) {
      return r instanceof e ? r.width === this.width && r.height === this.height && $m(r.projectionMatrix, this.projectionMatrix) && $m(r.viewMatrix, this.viewMatrix) : !1;
    }
  }, {
    key: "project",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, i = n.topLeft, a = i === void 0 ? !0 : i, s = this.projectPosition(r), o = hE(s, this.pixelProjectionMatrix), u = jn(o, 2), l = u[0], c = u[1], f = a ? c : this.height - c;
      return r.length === 2 ? [l, f] : [l, f, o[2]];
    }
  }, {
    key: "unproject",
    value: function(r) {
      var n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, i = n.topLeft, a = i === void 0 ? !0 : i, s = n.targetZ, o = jn(r, 3), u = o[0], l = o[1], c = o[2], f = a ? l : this.height - l, h = s && s * this.pixelsPerMeter, d = J1([u, f, c], this.pixelUnprojectionMatrix, h), g = this.unprojectPosition(d), v = jn(g, 3), m = v[0], p = v[1], y = v[2];
      return Number.isFinite(c) ? [m, p, y] : Number.isFinite(s) ? [m, p, s] : [m, p];
    }
  }, {
    key: "projectPosition",
    value: function(r) {
      var n = this.projectFlat(r), i = jn(n, 2), a = i[0], s = i[1], o = (r[2] || 0) * this.pixelsPerMeter;
      return [a, s, o];
    }
  }, {
    key: "unprojectPosition",
    value: function(r) {
      var n = this.unprojectFlat(r), i = jn(n, 2), a = i[0], s = i[1], o = (r[2] || 0) / this.pixelsPerMeter;
      return [a, s, o];
    }
  }, {
    key: "projectFlat",
    value: function(r) {
      return arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.scale, r;
    }
  }, {
    key: "unprojectFlat",
    value: function(r) {
      return arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.scale, r;
    }
  }]), e;
}();
function pE(e) {
  var t = e.width, r = e.height, n = e.bounds, i = e.minExtent, a = i === void 0 ? 0 : i, s = e.maxZoom, o = s === void 0 ? 24 : s, u = e.padding, l = u === void 0 ? 0 : u, c = e.offset, f = c === void 0 ? [0, 0] : c, h = jn(n, 2), d = jn(h[0], 2), g = d[0], v = d[1], m = jn(h[1], 2), p = m[0], y = m[1];
  if (Number.isFinite(l)) {
    var w = l;
    l = {
      top: w,
      bottom: w,
      left: w,
      right: w
    };
  } else
    ms(Number.isFinite(l.top) && Number.isFinite(l.bottom) && Number.isFinite(l.left) && Number.isFinite(l.right));
  var x = new Q1({
    width: t,
    height: r,
    longitude: 0,
    latitude: 0,
    zoom: 0
  }), b = x.project([g, y]), M = x.project([p, v]), k = [Math.max(Math.abs(M[0] - b[0]), a), Math.max(Math.abs(M[1] - b[1]), a)], E = [t - l.left - l.right - Math.abs(f[0]) * 2, r - l.top - l.bottom - Math.abs(f[1]) * 2];
  ms(E[0] > 0 && E[1] > 0);
  var S = E[0] / k[0], F = E[1] / k[1], O = (l.right - l.left) / 2 / S, D = (l.bottom - l.top) / 2 / F, _ = [(M[0] + b[0]) / 2 + O, (M[1] + b[1]) / 2 + D], L = x.unproject(_), G = x.zoom + Math.log2(Math.abs(Math.min(S, F)));
  return {
    longitude: L[0],
    latitude: L[1],
    zoom: Math.min(G, o)
  };
}
var Q1 = function(e) {
  H3(t, e);
  function t() {
    var r, n = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, i = n.width, a = n.height, s = n.latitude, o = s === void 0 ? 0 : s, u = n.longitude, l = u === void 0 ? 0 : u, c = n.zoom, f = c === void 0 ? 0 : c, h = n.pitch, d = h === void 0 ? 0 : h, g = n.bearing, v = g === void 0 ? 0 : g, m = n.altitude, p = m === void 0 ? 1.5 : m, y = n.nearZMultiplier, w = n.farZMultiplier;
    q1(this, t), i = i || 1, a = a || 1;
    var x = Z1(f);
    p = Math.max(0.75, p);
    var b = Oh([l, o], x);
    b[2] = 0;
    var M = fE({
      width: i,
      height: a,
      pitch: d,
      altitude: p,
      nearZMultiplier: y || 1 / a,
      farZMultiplier: w || 1.01
    }), k = lE({
      height: a,
      center: b,
      pitch: d,
      bearing: v,
      altitude: p
    });
    return r = V3(this, dp(t).call(this, {
      width: i,
      height: a,
      viewMatrix: k,
      projectionMatrix: M
    })), r.latitude = o, r.longitude = l, r.zoom = f, r.pitch = d, r.bearing = v, r.altitude = p, r.scale = x, r.center = b, r.pixelsPerMeter = uE(du(du(r))).pixelsPerMeter[2], Object.freeze(du(du(r))), r;
  }
  return $1(t, [{
    key: "projectFlat",
    value: function(n) {
      var i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.scale;
      return Oh(n, i);
    }
  }, {
    key: "unprojectFlat",
    value: function(n) {
      var i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.scale;
      return Jm(n, i);
    }
  }, {
    key: "getMapCenterByLngLatPosition",
    value: function(n) {
      var i = n.lngLat, a = n.pos, s = J1(a, this.pixelUnprojectionMatrix), o = Oh(i, this.scale), u = Ym([], o, nE([], s)), l = Ym([], this.center, u);
      return Jm(l, this.scale);
    }
  }, {
    key: "getLocationAtPoint",
    value: function(n) {
      var i = n.lngLat, a = n.pos;
      return this.getMapCenterByLngLatPosition({
        lngLat: i,
        pos: a
      });
    }
  }, {
    key: "fitBounds",
    value: function(n) {
      var i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, a = this.width, s = this.height, o = pE(Object.assign({
        width: a,
        height: s,
        bounds: n
      }, i)), u = o.longitude, l = o.latitude, c = o.zoom;
      return new t({
        width: a,
        height: s,
        longitude: u,
        latitude: l,
        zoom: c
      });
    }
  }]), t;
}(dE), vE = Math.PI, Nh = vE / 180, mE = 512, eg = 4003e4;
function eb(e) {
  return Math.pow(2, e);
}
function gE(e) {
  var t = e.latitude, r = t === void 0 ? 0 : t, n = e.zoom, i = n === void 0 ? 1 : n, a = e.scale;
  a = a !== void 0 ? a : eb(i);
  var s = {}, o = mE * a * window.devicePixelRatio, u = Math.cos(r * Nh), l = o / 360, c = l / u, f = o / eg / u;
  s.pixelsPerMeter = [f, -f, f], s.metersPerPixel = [1 / f, -1 / f, 1 / f], s.pixelsPerDegree = [l, -c, f], s.degreesPerPixel = [1 / l, -1 / c, 1 / f];
  {
    var h = Nh * Math.tan(r * Nh) / u, d = l * h / 2, g = o / eg * h, v = g / c * f;
    s.pixelsPerDegree2 = [0, -d, g], s.pixelsPerMeter2 = [v, 0, v];
  }
  return s;
}
var yE = /* @__PURE__ */ function() {
  function e(t, r, n) {
    Pe(this, e), this.id = t, this.type = "custom", this.renderingMode = "2d", this.url = r, this.options = {
      //
      subdomains: null,
      minZoom: 0,
      maxZoom: 24,
      tileType: "xyz"
      //bd09,xyz
    }, B3(this, n), this.program, this.showTiles = [], this.tileCache = {}, this.gridCache = {}, this.matrix, this.map, this.isLayerShow, this.transformBaidu = new z3();
  }
  return Be(e, [{
    key: "onAdd",
    value: function(r, n) {
      var i = this;
      this.map = r;
      var a = "uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_TextCoord;varying vec2 v_TextCoord;const float TILE_SIZE = 512.0;const float PI = 3.1415926536;const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);uniform float u_project_scale;uniform bool u_is_offset;uniform vec3 u_pixels_per_degree;uniform vec3 u_pixels_per_degree2;uniform vec3 u_pixels_per_meter;uniform vec2 u_viewport_center;uniform vec4 u_viewport_center_projection;uniform vec2 u_viewport_size;float project_scale(float meters) {    return meters * u_pixels_per_meter.z;}vec3 project_scale(vec3 position) {    return position * u_pixels_per_meter;}vec2 project_mercator(vec2 lnglat) {    float x = lnglat.x;    return vec2(    radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))    );}vec4 project_offset(vec4 offset) {    float dy = offset.y;    dy = clamp(dy, -1., 1.);    vec3 pixels_per_unit = u_pixels_per_degree + u_pixels_per_degree2 * dy;    return vec4(offset.xyz * pixels_per_unit, offset.w);}vec4 project_position(vec4 position) {    if (u_is_offset) {        float X = position.x - u_viewport_center.x;        float Y = position.y - u_viewport_center.y;        return project_offset(vec4(X, Y, position.z, position.w));    }    else {        return vec4(        project_mercator(position.xy) * WORLD_SCALE * u_project_scale, project_scale(position.z), position.w        );    }}vec4 project_to_clipping_space(vec3 position) {    vec4 project_pos = project_position(vec4(position, 1.0));    return u_matrix * project_pos + u_viewport_center_projection;}void main() {   vec4 project_pos = project_position(vec4(a_pos, 0.0, 1.0));   gl_Position = u_matrix * project_pos + u_viewport_center_projection;   v_TextCoord = a_TextCoord;}", s = "precision mediump float;uniform sampler2D u_Sampler; varying vec2 v_TextCoord; void main() {   gl_FragColor = texture2D(u_Sampler, v_TextCoord);}", o = n.createShader(n.VERTEX_SHADER);
      n.shaderSource(o, a), n.compileShader(o);
      var u = n.createShader(n.FRAGMENT_SHADER);
      n.shaderSource(u, s), n.compileShader(u), this.program = n.createProgram(), n.attachShader(this.program, o), n.attachShader(this.program, u), n.linkProgram(this.program), this.a_Pos = n.getAttribLocation(this.program, "a_pos"), this.a_TextCoord = n.getAttribLocation(this.program, "a_TextCoord"), this.isLayerShow = !0, r.on("move", function() {
        i.isLayerShow && i.update(n, r);
      }), this.update(n, r);
    }
  }, {
    key: "update",
    value: function(r, n) {
      var i = this, a = n.getCenter(), s, o = n.getBounds(), u, l;
      if (this.options.tileType === "xyz") {
        s = parseInt(n.getZoom() + 1.4);
        var c = fp(o.getNorthWest()), f = fp(o.getSouthEast());
        u = Fh(c.lng, c.lat, s), l = Fh(f.lng, f.lat, s);
      } else if (this.options.tileType === "bd09") {
        s = parseInt(n.getZoom() + 1.8);
        var h = Hm(o.getSouthWest()), d = Hm(o.getNorthEast());
        u = this.transformBaidu.lnglatToTile(h.lng, h.lat, s), l = this.transformBaidu.lnglatToTile(d.lng, d.lat, s);
      }
      for (var g = [], v = u[0]; v <= l[0]; v++)
        for (var m = u[1]; m <= l[1]; m++) {
          var p = {
            x: v,
            y: m,
            z: s
          };
          g.push(p), this.addGridCache(p, 0, 0), v === l[0] && this.addGridCache(p, 1, 0), m === l[1] && this.addGridCache(p, 0, 1), v === l[0] && m === l[1] && this.addGridCache(p, 1, 1);
        }
      if (this.options.tileType === "xyz") var y = Fh(a.lng, a.lat, s);
      else this.options.tileType === "bd09" && (y = this.transformBaidu.lnglatToTile(a.lng, a.lat, s));
      g.sort(function(M, k) {
        return i.tileDistance(M, y) - i.tileDistance(k, y);
      }), this.showTiles = [];
      for (var w = 0, x = g; w < x.length; w++) {
        var p = x[w];
        if (this.tileCache[this.createTileKey(p)])
          this.showTiles.push(this.tileCache[this.createTileKey(p)]);
        else {
          var b = this.createTile(r, p);
          this.showTiles.push(b), this.tileCache[this.createTileKey(p)] = b;
        }
      }
    }
    //
  }, {
    key: "addGridCache",
    value: function(r, n, i) {
      var a = this.createTileKey(r.x + n, r.y + i, r.z);
      this.gridCache[a] || (this.options.tileType === "xyz" ? this.gridCache[a] = V1(I3(r.x + n, r.y + i, r.z)) : this.options.tileType === "bd09" && (this.gridCache[a] = R3(this.transformBaidu.pixelToLnglat(0, 0, r.x + n, r.y + i, r.z))));
    }
    //
  }, {
    key: "tileDistance",
    value: function(r, n) {
      return Math.sqrt(Math.pow(r.x - n[0], 2) + Math.pow(r.y - n[1], 2));
    }
    //id
  }, {
    key: "createTileKey",
    value: function(r, n, i) {
      if (r instanceof Object)
        return r.z + "/" + r.x + "/" + r.y;
      var a = r;
      return i + "/" + a + "/" + n;
    }
    //
  }, {
    key: "createTile",
    value: function(r, n) {
      var i = this, a = F3(this.url, {
        s: this.options.subdomains[Math.abs(n.x + n.y) % this.options.subdomains.length],
        x: n.x,
        y: n.y,
        z: n.z
      }), s = {
        xyz: n
      }, o, u, l, c;
      this.options.tileType === "xyz" ? (o = this.gridCache[this.createTileKey(n)], u = this.gridCache[this.createTileKey(n.x + 1, n.y, n.z)], l = this.gridCache[this.createTileKey(n.x, n.y + 1, n.z)], c = this.gridCache[this.createTileKey(n.x + 1, n.y + 1, n.z)]) : this.options.tileType === "bd09" && (o = this.gridCache[this.createTileKey(n.x, n.y + 1, n.z)], u = this.gridCache[this.createTileKey(n.x + 1, n.y + 1, n.z)], l = this.gridCache[this.createTileKey(n)], c = this.gridCache[this.createTileKey(n.x + 1, n.y, n.z)]);
      var f = new Float32Array([o.lng, o.lat, 0, 1, l.lng, l.lat, 0, 0, u.lng, u.lat, 1, 1, c.lng, c.lat, 1, 0]), h = f.BYTES_PER_ELEMENT, d = r.createBuffer();
      r.bindBuffer(r.ARRAY_BUFFER, d), r.bufferData(r.ARRAY_BUFFER, f, r.STATIC_DRAW), s.buffer = d, s.PosParam = {
        size: 2,
        stride: h * 4,
        offset: 0
        //
      }, s.TextCoordParam = {
        size: 2,
        stride: h * 4,
        offset: h * 2
        //
      };
      var g = new Image();
      return g.onload = function() {
        s.texture = r.createTexture(), r.bindTexture(r.TEXTURE_2D, s.texture), r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL, 1), r.texImage2D(r.TEXTURE_2D, 0, r.RGBA, r.RGBA, r.UNSIGNED_BYTE, g), s.isLoad = !0, i.map.triggerRepaint();
      }, g.crossOrigin = !0, g.src = a, s;
    }
    //
  }, {
    key: "render",
    value: function(r, n) {
      if (!(this.map.getZoom() < this.options.minZoom || this.map.getZoom() > this.options.maxZoom)) {
        this.matrix = n, r.useProgram(this.program);
        var i = W1(this.showTiles), a;
        try {
          for (i.s(); !(a = i.n()).done; ) {
            var s = a.value;
            if (s.isLoad) {
              r.bindTexture(r.TEXTURE_2D, s.texture), r.activeTexture(r.TEXTURE0), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.LINEAR), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.MIRRORED_REPEAT);
              var o = r.getUniformLocation(this.program, "u_Sampler");
              r.uniform1i(o, 0), r.bindBuffer(r.ARRAY_BUFFER, s.buffer), r.vertexAttribPointer(this.a_Pos, s.PosParam.size, r.FLOAT, !1, s.PosParam.stride, s.PosParam.offset), r.vertexAttribPointer(this.a_TextCoord, s.TextCoordParam.size, r.FLOAT, !1, s.TextCoordParam.stride, s.TextCoordParam.offset), r.enableVertexAttribArray(this.a_Pos), r.enableVertexAttribArray(this.a_TextCoord), this.setVertex(r), r.enable(r.BLEND), r.blendFunc(r.SRC_ALPHA, r.ONE_MINUS_SRC_ALPHA), r.drawArrays(r.TRIANGLE_STRIP, 0, 4);
            }
          }
        } catch (u) {
          i.e(u);
        } finally {
          i.f();
        }
      }
    }
    // 
    //https://github.com/xiaoiver/custom-mapbox-layer/blob/master/src/layers/PointCloudLayer2.ts
  }, {
    key: "setVertex",
    value: function(r) {
      var n = this.map.getZoom(), i = this.map.getBearing(), a = this.map.getPitch(), s = this.map.getCenter(), o = new Q1({
        // width: gl.drawingBufferWidth*1.11,
        // height: gl.drawingBufferHeight*1.11,
        width: r.drawingBufferWidth,
        height: r.drawingBufferHeight,
        longitude: s.lng,
        latitude: s.lat,
        zoom: n,
        pitch: a,
        bearing: i
      }), u = o.viewProjectionMatrix, l = o.projectionMatrix, c = o.viewMatrix, f = o.viewMatrixUncentered, h = {
        // @ts-ignore
        u_matrix: u,
        u_point_size: this.pointSize,
        u_is_offset: !1,
        u_pixels_per_degree: [0, 0, 0],
        u_pixels_per_degree2: [0, 0, 0],
        u_viewport_center: [0, 0],
        u_pixels_per_meter: [0, 0, 0],
        u_project_scale: eb(n),
        u_viewport_center_projection: [0, 0, 0, 0]
      };
      if (n > 0) {
        var d = gE({
          longitude: s.lng,
          latitude: s.lat,
          zoom: n
        }), g = d.pixelsPerDegree, v = d.pixelsPerDegree2, m = o.projectFlat([Math.fround(s.lng), Math.fround(s.lat)], Math.pow(2, n)), p = Y1([], [m[0], m[1], 0, 1], u), y = f || c, w = wu([], l, y), x = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];
        w = wu([], w, x), h.u_matrix = w, h.u_is_offset = !0, h.u_viewport_center = [Math.fround(s.lng), Math.fround(s.lat)], h.u_viewport_center_projection = p, h.u_pixels_per_degree = g && g.map(function(b) {
          return Math.fround(b);
        }), h.u_pixels_per_degree2 = v && v.map(function(b) {
          return Math.fround(b);
        });
      }
      r.uniformMatrix4fv(r.getUniformLocation(this.program, "u_matrix"), !1, h.u_matrix), r.uniform1f(r.getUniformLocation(this.program, "u_project_scale"), h.u_project_scale), r.uniform1i(r.getUniformLocation(this.program, "u_is_offset"), h.u_is_offset ? 1 : 0), r.uniform3fv(r.getUniformLocation(this.program, "u_pixels_per_degree"), h.u_pixels_per_degree), r.uniform3fv(r.getUniformLocation(this.program, "u_pixels_per_degree2"), h.u_pixels_per_degree2), r.uniform3fv(r.getUniformLocation(this.program, "u_pixels_per_meter"), h.u_pixels_per_meter), r.uniform2fv(r.getUniformLocation(this.program, "u_viewport_center"), h.u_viewport_center), r.uniform4fv(r.getUniformLocation(this.program, "u_viewport_center_projection"), h.u_viewport_center_projection);
    }
    //map
  }, {
    key: "onRemove",
    value: function(r, n) {
      this.isLayerShow = !1;
    }
  }]), e;
}();
function bE(e, t, r, n) {
  var i = r || {};
  n || (n = {
    TianDiTu: {
      Normal: {
        Map: "http://t{s}.tianditu.com/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk={key}",
        Annotion: "http://t{s}.tianditu.com/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk={key}",
        minzoom: 0,
        maxzoom: 18
      },
      Satellite: {
        Map: "http://t{s}.tianditu.com/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk={key}",
        Annotion: "http://t{s}.tianditu.com/DataServer?T=cia_w&X={x}&Y={y}&L={z}&tk={key}",
        minzoom: 0,
        maxzoom: 18
      },
      Terrain: {
        Map: "http://t{s}.tianditu.com/DataServer?T=ter_w&X={x}&Y={y}&L={z}&tk={key}",
        Annotion: "http://t{s}.tianditu.com/DataServer?T=cta_w&X={x}&Y={y}&L={z}&tk={key}",
        minzoom: 0,
        maxzoom: 14
      },
      Subdomains: ["0", "1", "2", "3", "4", "5", "6", "7"],
      key: ""
    },
    GaoDe: {
      Normal: {
        Map: "http://webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",
        minzoom: 0,
        maxzoom: 18
      },
      Normal_NoTag: {
        Map: "https://wprd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&scl=1&ltype=11&x={x}&y={y}&z={z}",
        minzoom: 3,
        maxzoom: 18
      },
      Satellite: {
        Map: "http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",
        Annotion: "http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",
        minzoom: 3,
        maxzoom: 18
      },
      Subdomains: ["1", "2", "3", "4"]
    },
    Baidu: {
      Normal: {
        Map: "http://online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles=pl&scaler=1&p=1"
      },
      Satellite: {
        Map: "http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",
        Annotion: "http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=020"
      },
      Subdomains: "0123456789",
      tileType: "bd09"
    },
    Geoq: {
      Normal: {
        Map: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",
        PurplishBlue: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",
        Gray: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",
        Warm: "http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",
        minzoom: 3,
        maxzoom: 16
      },
      Subdomains: []
    },
    OSM: {
      Normal: {
        Map: "http://{s}.tile.osm.org/{z}/{x}/{y}.png",
        minzoom: 0,
        maxzoom: 18
      },
      Subdomains: ["a", "b", "c"]
    }
  });
  var a = t.split("."), s = a[0], o = a[1], u = a[2], l = n[s][o][u], c = n[s].Subdomains, f = n[s][o].minzoom, h = n[s][o].maxzoom, d = n[s].tileType, g;
  if (s === "TianDiTu" || s === "OSM") {
    var v = i.key || n[s].key, m = [], p = W1(c), y;
    try {
      for (p.s(); !(y = p.n()).done; ) {
        var w = y.value;
        m.push(l.replace("{s}", w).replace("{key}", v));
      }
    } catch (x) {
      p.e(x);
    } finally {
      p.f();
    }
    g = {
      id: e,
      type: "raster",
      source: {
        type: "raster",
        tiles: m,
        tileSize: 256,
        minzoom: f,
        maxzoom: h
      }
    };
  } else
    g = new yE(e, l, {
      subdomains: c,
      minZoom: f,
      maxZoom: h,
      tileType: d
    });
  return g;
}
var Uh = [];
function tb(e, t, r, n) {
  Uh.forEach(function(i) {
    e.getLayer(i) && e.removeLayer(i), e.getSource(i) && e.removeSource(i);
  }), Uh = [], t.forEach(function(i) {
    Uh.push(i[0]);
    var a = r ? {
      key: r
    } : null, s = bE(i[0], i[1], a, n);
    e.addLayer(s, "mx.layer.fill");
  });
}
function rb(e, t, r) {
  t.forEach(function(n, i) {
    if (n == "Image") {
      var a = "https://gac-geo.googlecnapps.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}";
      r && i < r.length && (a = r[i]), e.addLayer({
        id: "GoogleImageLayer",
        type: "raster",
        source: {
          type: "raster",
          tiles: [a],
          tileSize: 256
        }
      });
    } else if (n == "Lable") {
      var s = "https://gac-geo.googlecnapps.cn/maps/vt?lyrs=s,m&gl=CN&x={x}&y={y}&z={z}";
      r && i < r.length && (s = r[i]), e.addLayer({
        id: "GoogleImageLableLayer",
        type: "raster",
        source: {
          type: "raster",
          tiles: [s],
          tileSize: 256
        }
      });
    }
  });
}
var jr = 3.141592653589793, ef = 6378245, tf = 0.006693421622965943;
function nb(e, t) {
  var r = -100 + 2 * e + 3 * t + 0.2 * t * t + 0.1 * e * t + 0.2 * Math.sqrt(Math.abs(e));
  return r += (20 * Math.sin(6 * e * jr) + 20 * Math.sin(2 * e * jr)) * 2 / 3, r += (20 * Math.sin(t * jr) + 40 * Math.sin(t / 3 * jr)) * 2 / 3, r += (160 * Math.sin(t / 12 * jr) + 320 * Math.sin(t * jr / 30)) * 2 / 3, r;
}
function ib(e, t) {
  var r = 300 + e + 2 * t + 0.1 * e * e + 0.1 * e * t + 0.1 * Math.sqrt(Math.abs(e));
  return r += (20 * Math.sin(6 * e * jr) + 20 * Math.sin(2 * e * jr)) * 2 / 3, r += (20 * Math.sin(e * jr) + 40 * Math.sin(e / 3 * jr)) * 2 / 3, r += (150 * Math.sin(e / 12 * jr) + 300 * Math.sin(e / 30 * jr)) * 2 / 3, r;
}
function wE(e, t) {
  var r = nb(e - 105, t - 35), n = ib(e - 105, t - 35), i = t / 180 * jr, a = Math.sin(i);
  a = 1 - tf * a * a;
  var s = Math.sqrt(a);
  r = r * 180 / (ef * (1 - tf) / (a * s) * jr), n = n * 180 / (ef / s * Math.cos(i) * jr);
  var o = t + r, u = e + n, l = {
    lng: u,
    lat: o
  };
  return l;
}
function ab(e, t) {
  if (e instanceof Object) {
    var r = e.lng;
    t = e.lat, e = r;
  }
  var n = nb(e - 105, t - 35), i = ib(e - 105, t - 35), a = t / 180 * jr, s = Math.sin(a);
  s = 1 - tf * s * s;
  var o = Math.sqrt(s);
  n = n * 180 / (ef * (1 - tf) / (s * o) * jr), i = i * 180 / (ef / o * Math.cos(a) * jr);
  var u = t + n, l = e + i, c = {
    lng: l,
    lat: u
  };
  return c;
}
function sb(e, t) {
  if (e instanceof Object) {
    var r = e.lng;
    t = e.lat, e = r;
  }
  var n = wE(e, t), i = e * 2 - n.lng, a = t * 2 - n.lat, s = {
    lng: i,
    lat: a
  };
  return s;
}
Number.EPSILON === void 0 && (Number.EPSILON = Math.pow(2, -52));
Number.isInteger === void 0 && (Number.isInteger = function(e) {
  return typeof e == "number" && isFinite(e) && Math.floor(e) === e;
});
Math.sign === void 0 && (Math.sign = function(e) {
  return e < 0 ? -1 : e > 0 ? 1 : +e;
});
"name" in Function.prototype || Object.defineProperty(Function.prototype, "name", {
  get: function() {
    return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1];
  }
});
Object.assign === void 0 && (Object.assign = function(e) {
  if (e == null)
    throw new TypeError("Cannot convert undefined or null to object");
  for (var t = Object(e), r = 1; r < arguments.length; r++) {
    var n = arguments[r];
    if (n != null)
      for (var i in n)
        Object.prototype.hasOwnProperty.call(n, i) && (t[i] = n[i]);
  }
  return t;
});
var xE = "113", ME = 0, tg = 1, EE = 2, ob = 1, AE = 2, pu = 3, yl = 0, Hr = 1, nh = 2, ub = 1, lb = 0, TE = 1, bl = 2, Pa = 0, xu = 1, rg = 2, ng = 3, ig = 4, SE = 5, ao = 100, kE = 101, CE = 102, ag = 103, sg = 104, DE = 200, _E = 201, PE = 202, BE = 203, cb = 204, fb = 205, LE = 206, FE = 207, IE = 208, RE = 209, OE = 210, NE = 0, UE = 1, GE = 2, gp = 3, zE = 4, WE = 5, VE = 6, HE = 7, ih = 0, jE = 1, XE = 2, Mc = 0, u0 = 1, qE = 2, $E = 3, YE = 4, KE = 5, l0 = 300, c0 = 301, f0 = 302, hb = 303, h0 = 304, db = 305, wl = 306, d0 = 307, rf = 1e3, Mn = 1001, nf = 1002, Or = 1003, yp = 1004, bp = 1005, Vr = 1006, pb = 1007, xl = 1008, ah = 1009, ZE = 1010, JE = 1011, af = 1012, QE = 1013, vb = 1014, Pu = 1015, p0 = 1016, eA = 1017, tA = 1018, rA = 1019, sf = 1020, nA = 1021, gs = 1022, _i = 1023, iA = 1024, aA = 1025, sA = _i, yo = 1026, Bu = 1027, oA = 1028, uA = 1029, lA = 1030, cA = 1031, fA = 1032, hA = 1033, og = 33776, ug = 33777, lg = 33778, cg = 33779, fg = 35840, hg = 35841, dg = 35842, pg = 35843, dA = 36196, pA = 37808, vA = 37809, mA = 37810, gA = 37811, yA = 37812, bA = 37813, wA = 37814, xA = 37815, MA = 37816, EA = 37817, AA = 37818, TA = 37819, SA = 37820, kA = 37821, CA = 2200, DA = 2201, _A = 2202, of = 2300, Ec = 2301, Gh = 2302, So = 2400, uo = 2401, uf = 2402, PA = 0, Pn = 3e3, v0 = 3001, mb = 3007, m0 = 3002, BA = 3003, gb = 3004, yb = 3005, bb = 3006, LA = 3200, FA = 3201, qo = 0, IA = 1, zh = 7680, RA = 519, sh = 35044, Lu = 35048;
function ha() {
}
Object.assign(ha.prototype, {
  addEventListener: function(e, t) {
    this._listeners === void 0 && (this._listeners = {});
    var r = this._listeners;
    r[e] === void 0 && (r[e] = []), r[e].indexOf(t) === -1 && r[e].push(t);
  },
  hasEventListener: function(e, t) {
    if (this._listeners === void 0) return !1;
    var r = this._listeners;
    return r[e] !== void 0 && r[e].indexOf(t) !== -1;
  },
  removeEventListener: function(e, t) {
    if (this._listeners !== void 0) {
      var r = this._listeners, n = r[e];
      if (n !== void 0) {
        var i = n.indexOf(t);
        i !== -1 && n.splice(i, 1);
      }
    }
  },
  dispatchEvent: function(e) {
    if (this._listeners !== void 0) {
      var t = this._listeners, r = t[e.type];
      if (r !== void 0) {
        e.target = this;
        for (var n = r.slice(0), i = 0, a = n.length; i < a; i++)
          n[i].call(this, e);
      }
    }
  }
});
var $r = [];
for (var tu = 0; tu < 256; tu++)
  $r[tu] = (tu < 16 ? "0" : "") + tu.toString(16);
var It = {
  DEG2RAD: Math.PI / 180,
  RAD2DEG: 180 / Math.PI,
  generateUUID: function() {
    var e = Math.random() * 4294967295 | 0, t = Math.random() * 4294967295 | 0, r = Math.random() * 4294967295 | 0, n = Math.random() * 4294967295 | 0, i = $r[e & 255] + $r[e >> 8 & 255] + $r[e >> 16 & 255] + $r[e >> 24 & 255] + "-" + $r[t & 255] + $r[t >> 8 & 255] + "-" + $r[t >> 16 & 15 | 64] + $r[t >> 24 & 255] + "-" + $r[r & 63 | 128] + $r[r >> 8 & 255] + "-" + $r[r >> 16 & 255] + $r[r >> 24 & 255] + $r[n & 255] + $r[n >> 8 & 255] + $r[n >> 16 & 255] + $r[n >> 24 & 255];
    return i.toUpperCase();
  },
  clamp: function(e, t, r) {
    return Math.max(t, Math.min(r, e));
  },
  // compute euclidian modulo of m % n
  // https://en.wikipedia.org/wiki/Modulo_operation
  euclideanModulo: function(e, t) {
    return (e % t + t) % t;
  },
  // Linear mapping from range <a1, a2> to range <b1, b2>
  mapLinear: function(e, t, r, n, i) {
    return n + (e - t) * (i - n) / (r - t);
  },
  // https://en.wikipedia.org/wiki/Linear_interpolation
  lerp: function(e, t, r) {
    return (1 - r) * e + r * t;
  },
  // http://en.wikipedia.org/wiki/Smoothstep
  smoothstep: function(e, t, r) {
    return e <= t ? 0 : e >= r ? 1 : (e = (e - t) / (r - t), e * e * (3 - 2 * e));
  },
  smootherstep: function(e, t, r) {
    return e <= t ? 0 : e >= r ? 1 : (e = (e - t) / (r - t), e * e * e * (e * (e * 6 - 15) + 10));
  },
  // Random integer from <low, high> interval
  randInt: function(e, t) {
    return e + Math.floor(Math.random() * (t - e + 1));
  },
  // Random float from <low, high> interval
  randFloat: function(e, t) {
    return e + Math.random() * (t - e);
  },
  // Random float from <-range/2, range/2> interval
  randFloatSpread: function(e) {
    return e * (0.5 - Math.random());
  },
  degToRad: function(e) {
    return e * It.DEG2RAD;
  },
  radToDeg: function(e) {
    return e * It.RAD2DEG;
  },
  isPowerOfTwo: function(e) {
    return (e & e - 1) === 0 && e !== 0;
  },
  ceilPowerOfTwo: function(e) {
    return Math.pow(2, Math.ceil(Math.log(e) / Math.LN2));
  },
  floorPowerOfTwo: function(e) {
    return Math.pow(2, Math.floor(Math.log(e) / Math.LN2));
  },
  setQuaternionFromProperEuler: function(e, t, r, n, i) {
    var a = Math.cos, s = Math.sin, o = a(r / 2), u = s(r / 2), l = a((t + n) / 2), c = s((t + n) / 2), f = a((t - n) / 2), h = s((t - n) / 2), d = a((n - t) / 2), g = s((n - t) / 2);
    i === "XYX" ? e.set(o * c, u * f, u * h, o * l) : i === "YZY" ? e.set(u * h, o * c, u * f, o * l) : i === "ZXZ" ? e.set(u * f, u * h, o * c, o * l) : i === "XZX" ? e.set(o * c, u * g, u * d, o * l) : i === "YXY" ? e.set(u * d, o * c, u * g, o * l) : i === "ZYZ" ? e.set(u * g, u * d, o * c, o * l) : console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.");
  }
};
function _e(e, t) {
  this.x = e || 0, this.y = t || 0;
}
Object.defineProperties(_e.prototype, {
  width: {
    get: function() {
      return this.x;
    },
    set: function(e) {
      this.x = e;
    }
  },
  height: {
    get: function() {
      return this.y;
    },
    set: function(e) {
      this.y = e;
    }
  }
});
Object.assign(_e.prototype, {
  isVector2: !0,
  set: function(e, t) {
    return this.x = e, this.y = t, this;
  },
  setScalar: function(e) {
    return this.x = e, this.y = e, this;
  },
  setX: function(e) {
    return this.x = e, this;
  },
  setY: function(e) {
    return this.y = e, this;
  },
  setComponent: function(e, t) {
    switch (e) {
      case 0:
        this.x = t;
        break;
      case 1:
        this.y = t;
        break;
      default:
        throw new Error("index is out of range: " + e);
    }
    return this;
  },
  getComponent: function(e) {
    switch (e) {
      case 0:
        return this.x;
      case 1:
        return this.y;
      default:
        throw new Error("index is out of range: " + e);
    }
  },
  clone: function() {
    return new this.constructor(this.x, this.y);
  },
  copy: function(e) {
    return this.x = e.x, this.y = e.y, this;
  },
  add: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this);
  },
  addScalar: function(e) {
    return this.x += e, this.y += e, this;
  },
  addVectors: function(e, t) {
    return this.x = e.x + t.x, this.y = e.y + t.y, this;
  },
  addScaledVector: function(e, t) {
    return this.x += e.x * t, this.y += e.y * t, this;
  },
  sub: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this);
  },
  subScalar: function(e) {
    return this.x -= e, this.y -= e, this;
  },
  subVectors: function(e, t) {
    return this.x = e.x - t.x, this.y = e.y - t.y, this;
  },
  multiply: function(e) {
    return this.x *= e.x, this.y *= e.y, this;
  },
  multiplyScalar: function(e) {
    return this.x *= e, this.y *= e, this;
  },
  divide: function(e) {
    return this.x /= e.x, this.y /= e.y, this;
  },
  divideScalar: function(e) {
    return this.multiplyScalar(1 / e);
  },
  applyMatrix3: function(e) {
    var t = this.x, r = this.y, n = e.elements;
    return this.x = n[0] * t + n[3] * r + n[6], this.y = n[1] * t + n[4] * r + n[7], this;
  },
  min: function(e) {
    return this.x = Math.min(this.x, e.x), this.y = Math.min(this.y, e.y), this;
  },
  max: function(e) {
    return this.x = Math.max(this.x, e.x), this.y = Math.max(this.y, e.y), this;
  },
  clamp: function(e, t) {
    return this.x = Math.max(e.x, Math.min(t.x, this.x)), this.y = Math.max(e.y, Math.min(t.y, this.y)), this;
  },
  clampScalar: function(e, t) {
    return this.x = Math.max(e, Math.min(t, this.x)), this.y = Math.max(e, Math.min(t, this.y)), this;
  },
  clampLength: function(e, t) {
    var r = this.length();
    return this.divideScalar(r || 1).multiplyScalar(Math.max(e, Math.min(t, r)));
  },
  floor: function() {
    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this;
  },
  ceil: function() {
    return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this;
  },
  round: function() {
    return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
  },
  roundToZero: function() {
    return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this;
  },
  negate: function() {
    return this.x = -this.x, this.y = -this.y, this;
  },
  dot: function(e) {
    return this.x * e.x + this.y * e.y;
  },
  cross: function(e) {
    return this.x * e.y - this.y * e.x;
  },
  lengthSq: function() {
    return this.x * this.x + this.y * this.y;
  },
  length: function() {
    return Math.sqrt(this.x * this.x + this.y * this.y);
  },
  manhattanLength: function() {
    return Math.abs(this.x) + Math.abs(this.y);
  },
  normalize: function() {
    return this.divideScalar(this.length() || 1);
  },
  angle: function() {
    var e = Math.atan2(this.y, this.x);
    return e < 0 && (e += 2 * Math.PI), e;
  },
  distanceTo: function(e) {
    return Math.sqrt(this.distanceToSquared(e));
  },
  distanceToSquared: function(e) {
    var t = this.x - e.x, r = this.y - e.y;
    return t * t + r * r;
  },
  manhattanDistanceTo: function(e) {
    return Math.abs(this.x - e.x) + Math.abs(this.y - e.y);
  },
  setLength: function(e) {
    return this.normalize().multiplyScalar(e);
  },
  lerp: function(e, t) {
    return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this;
  },
  lerpVectors: function(e, t, r) {
    return this.subVectors(t, e).multiplyScalar(r).add(e);
  },
  equals: function(e) {
    return e.x === this.x && e.y === this.y;
  },
  fromArray: function(e, t) {
    return t === void 0 && (t = 0), this.x = e[t], this.y = e[t + 1], this;
  },
  toArray: function(e, t) {
    return e === void 0 && (e = []), t === void 0 && (t = 0), e[t] = this.x, e[t + 1] = this.y, e;
  },
  fromBufferAttribute: function(e, t, r) {
    return r !== void 0 && console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."), this.x = e.getX(t), this.y = e.getY(t), this;
  },
  rotateAround: function(e, t) {
    var r = Math.cos(t), n = Math.sin(t), i = this.x - e.x, a = this.y - e.y;
    return this.x = i * r - a * n + e.x, this.y = i * n + a * r + e.y, this;
  }
});
function an() {
  this.elements = [
    1,
    0,
    0,
    0,
    1,
    0,
    0,
    0,
    1
  ], arguments.length > 0 && console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.");
}
Object.assign(an.prototype, {
  isMatrix3: !0,
  set: function(e, t, r, n, i, a, s, o, u) {
    var l = this.elements;
    return l[0] = e, l[1] = n, l[2] = s, l[3] = t, l[4] = i, l[5] = o, l[6] = r, l[7] = a, l[8] = u, this;
  },
  identity: function() {
    return this.set(
      1,
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      1
    ), this;
  },
  clone: function() {
    return new this.constructor().fromArray(this.elements);
  },
  copy: function(e) {
    var t = this.elements, r = e.elements;
    return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t[4] = r[4], t[5] = r[5], t[6] = r[6], t[7] = r[7], t[8] = r[8], this;
  },
  setFromMatrix4: function(e) {
    var t = e.elements;
    return this.set(
      t[0],
      t[4],
      t[8],
      t[1],
      t[5],
      t[9],
      t[2],
      t[6],
      t[10]
    ), this;
  },
  multiply: function(e) {
    return this.multiplyMatrices(this, e);
  },
  premultiply: function(e) {
    return this.multiplyMatrices(e, this);
  },
  multiplyMatrices: function(e, t) {
    var r = e.elements, n = t.elements, i = this.elements, a = r[0], s = r[3], o = r[6], u = r[1], l = r[4], c = r[7], f = r[2], h = r[5], d = r[8], g = n[0], v = n[3], m = n[6], p = n[1], y = n[4], w = n[7], x = n[2], b = n[5], M = n[8];
    return i[0] = a * g + s * p + o * x, i[3] = a * v + s * y + o * b, i[6] = a * m + s * w + o * M, i[1] = u * g + l * p + c * x, i[4] = u * v + l * y + c * b, i[7] = u * m + l * w + c * M, i[2] = f * g + h * p + d * x, i[5] = f * v + h * y + d * b, i[8] = f * m + h * w + d * M, this;
  },
  multiplyScalar: function(e) {
    var t = this.elements;
    return t[0] *= e, t[3] *= e, t[6] *= e, t[1] *= e, t[4] *= e, t[7] *= e, t[2] *= e, t[5] *= e, t[8] *= e, this;
  },
  determinant: function() {
    var e = this.elements, t = e[0], r = e[1], n = e[2], i = e[3], a = e[4], s = e[5], o = e[6], u = e[7], l = e[8];
    return t * a * l - t * s * u - r * i * l + r * s * o + n * i * u - n * a * o;
  },
  getInverse: function(e, t) {
    e && e.isMatrix4 && console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");
    var r = e.elements, n = this.elements, i = r[0], a = r[1], s = r[2], o = r[3], u = r[4], l = r[5], c = r[6], f = r[7], h = r[8], d = h * u - l * f, g = l * c - h * o, v = f * o - u * c, m = i * d + a * g + s * v;
    if (m === 0) {
      var p = "THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";
      if (t === !0)
        throw new Error(p);
      return console.warn(p), this.identity();
    }
    var y = 1 / m;
    return n[0] = d * y, n[1] = (s * f - h * a) * y, n[2] = (l * a - s * u) * y, n[3] = g * y, n[4] = (h * i - s * c) * y, n[5] = (s * o - l * i) * y, n[6] = v * y, n[7] = (a * c - f * i) * y, n[8] = (u * i - a * o) * y, this;
  },
  transpose: function() {
    var e, t = this.elements;
    return e = t[1], t[1] = t[3], t[3] = e, e = t[2], t[2] = t[6], t[6] = e, e = t[5], t[5] = t[7], t[7] = e, this;
  },
  getNormalMatrix: function(e) {
    return this.setFromMatrix4(e).getInverse(this).transpose();
  },
  transposeIntoArray: function(e) {
    var t = this.elements;
    return e[0] = t[0], e[1] = t[3], e[2] = t[6], e[3] = t[1], e[4] = t[4], e[5] = t[7], e[6] = t[2], e[7] = t[5], e[8] = t[8], this;
  },
  setUvTransform: function(e, t, r, n, i, a, s) {
    var o = Math.cos(i), u = Math.sin(i);
    this.set(
      r * o,
      r * u,
      -r * (o * a + u * s) + a + e,
      -n * u,
      n * o,
      -n * (-u * a + o * s) + s + t,
      0,
      0,
      1
    );
  },
  scale: function(e, t) {
    var r = this.elements;
    return r[0] *= e, r[3] *= e, r[6] *= e, r[1] *= t, r[4] *= t, r[7] *= t, this;
  },
  rotate: function(e) {
    var t = Math.cos(e), r = Math.sin(e), n = this.elements, i = n[0], a = n[3], s = n[6], o = n[1], u = n[4], l = n[7];
    return n[0] = t * i + r * o, n[3] = t * a + r * u, n[6] = t * s + r * l, n[1] = -r * i + t * o, n[4] = -r * a + t * u, n[7] = -r * s + t * l, this;
  },
  translate: function(e, t) {
    var r = this.elements;
    return r[0] += e * r[2], r[3] += e * r[5], r[6] += e * r[8], r[1] += t * r[2], r[4] += t * r[5], r[7] += t * r[8], this;
  },
  equals: function(e) {
    for (var t = this.elements, r = e.elements, n = 0; n < 9; n++)
      if (t[n] !== r[n]) return !1;
    return !0;
  },
  fromArray: function(e, t) {
    t === void 0 && (t = 0);
    for (var r = 0; r < 9; r++)
      this.elements[r] = e[r + t];
    return this;
  },
  toArray: function(e, t) {
    e === void 0 && (e = []), t === void 0 && (t = 0);
    var r = this.elements;
    return e[t] = r[0], e[t + 1] = r[1], e[t + 2] = r[2], e[t + 3] = r[3], e[t + 4] = r[4], e[t + 5] = r[5], e[t + 6] = r[6], e[t + 7] = r[7], e[t + 8] = r[8], e;
  }
});
var Us, ys = {
  getDataURL: function(e) {
    var t;
    if (typeof HTMLCanvasElement == "undefined")
      return e.src;
    if (e instanceof HTMLCanvasElement)
      t = e;
    else {
      Us === void 0 && (Us = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas")), Us.width = e.width, Us.height = e.height;
      var r = Us.getContext("2d");
      e instanceof ImageData ? r.putImageData(e, 0, 0) : r.drawImage(e, 0, 0, e.width, e.height), t = Us;
    }
    return t.width > 2048 || t.height > 2048 ? t.toDataURL("image/jpeg", 0.6) : t.toDataURL("image/png");
  }
}, OA = 0;
function ur(e, t, r, n, i, a, s, o, u, l) {
  Object.defineProperty(this, "id", { value: OA++ }), this.uuid = It.generateUUID(), this.name = "", this.image = e !== void 0 ? e : ur.DEFAULT_IMAGE, this.mipmaps = [], this.mapping = t !== void 0 ? t : ur.DEFAULT_MAPPING, this.wrapS = r !== void 0 ? r : Mn, this.wrapT = n !== void 0 ? n : Mn, this.magFilter = i !== void 0 ? i : Vr, this.minFilter = a !== void 0 ? a : xl, this.anisotropy = u !== void 0 ? u : 1, this.format = s !== void 0 ? s : _i, this.internalFormat = null, this.type = o !== void 0 ? o : ah, this.offset = new _e(0, 0), this.repeat = new _e(1, 1), this.center = new _e(0, 0), this.rotation = 0, this.matrixAutoUpdate = !0, this.matrix = new an(), this.generateMipmaps = !0, this.premultiplyAlpha = !1, this.flipY = !0, this.unpackAlignment = 4, this.encoding = l !== void 0 ? l : Pn, this.version = 0, this.onUpdate = null;
}
ur.DEFAULT_IMAGE = void 0;
ur.DEFAULT_MAPPING = l0;
ur.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: ur,
  isTexture: !0,
  updateMatrix: function() {
    this.matrix.setUvTransform(this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y);
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.name = e.name, this.image = e.image, this.mipmaps = e.mipmaps.slice(0), this.mapping = e.mapping, this.wrapS = e.wrapS, this.wrapT = e.wrapT, this.magFilter = e.magFilter, this.minFilter = e.minFilter, this.anisotropy = e.anisotropy, this.format = e.format, this.internalFormat = e.internalFormat, this.type = e.type, this.offset.copy(e.offset), this.repeat.copy(e.repeat), this.center.copy(e.center), this.rotation = e.rotation, this.matrixAutoUpdate = e.matrixAutoUpdate, this.matrix.copy(e.matrix), this.generateMipmaps = e.generateMipmaps, this.premultiplyAlpha = e.premultiplyAlpha, this.flipY = e.flipY, this.unpackAlignment = e.unpackAlignment, this.encoding = e.encoding, this;
  },
  toJSON: function(e) {
    var t = e === void 0 || typeof e == "string";
    if (!t && e.textures[this.uuid] !== void 0)
      return e.textures[this.uuid];
    var r = {
      metadata: {
        version: 4.5,
        type: "Texture",
        generator: "Texture.toJSON"
      },
      uuid: this.uuid,
      name: this.name,
      mapping: this.mapping,
      repeat: [this.repeat.x, this.repeat.y],
      offset: [this.offset.x, this.offset.y],
      center: [this.center.x, this.center.y],
      rotation: this.rotation,
      wrap: [this.wrapS, this.wrapT],
      format: this.format,
      type: this.type,
      encoding: this.encoding,
      minFilter: this.minFilter,
      magFilter: this.magFilter,
      anisotropy: this.anisotropy,
      flipY: this.flipY,
      premultiplyAlpha: this.premultiplyAlpha,
      unpackAlignment: this.unpackAlignment
    };
    if (this.image !== void 0) {
      var n = this.image;
      if (n.uuid === void 0 && (n.uuid = It.generateUUID()), !t && e.images[n.uuid] === void 0) {
        var i;
        if (Array.isArray(n)) {
          i = [];
          for (var a = 0, s = n.length; a < s; a++)
            i.push(ys.getDataURL(n[a]));
        } else
          i = ys.getDataURL(n);
        e.images[n.uuid] = {
          uuid: n.uuid,
          url: i
        };
      }
      r.image = n.uuid;
    }
    return t || (e.textures[this.uuid] = r), r;
  },
  dispose: function() {
    this.dispatchEvent({ type: "dispose" });
  },
  transformUv: function(e) {
    if (this.mapping !== l0) return e;
    if (e.applyMatrix3(this.matrix), e.x < 0 || e.x > 1)
      switch (this.wrapS) {
        case rf:
          e.x = e.x - Math.floor(e.x);
          break;
        case Mn:
          e.x = e.x < 0 ? 0 : 1;
          break;
        case nf:
          Math.abs(Math.floor(e.x) % 2) === 1 ? e.x = Math.ceil(e.x) - e.x : e.x = e.x - Math.floor(e.x);
          break;
      }
    if (e.y < 0 || e.y > 1)
      switch (this.wrapT) {
        case rf:
          e.y = e.y - Math.floor(e.y);
          break;
        case Mn:
          e.y = e.y < 0 ? 0 : 1;
          break;
        case nf:
          Math.abs(Math.floor(e.y) % 2) === 1 ? e.y = Math.ceil(e.y) - e.y : e.y = e.y - Math.floor(e.y);
          break;
      }
    return this.flipY && (e.y = 1 - e.y), e;
  }
});
Object.defineProperty(ur.prototype, "needsUpdate", {
  set: function(e) {
    e === !0 && this.version++;
  }
});
function or(e, t, r, n) {
  this.x = e || 0, this.y = t || 0, this.z = r || 0, this.w = n !== void 0 ? n : 1;
}
Object.defineProperties(or.prototype, {
  width: {
    get: function() {
      return this.z;
    },
    set: function(e) {
      this.z = e;
    }
  },
  height: {
    get: function() {
      return this.w;
    },
    set: function(e) {
      this.w = e;
    }
  }
});
Object.assign(or.prototype, {
  isVector4: !0,
  set: function(e, t, r, n) {
    return this.x = e, this.y = t, this.z = r, this.w = n, this;
  },
  setScalar: function(e) {
    return this.x = e, this.y = e, this.z = e, this.w = e, this;
  },
  setX: function(e) {
    return this.x = e, this;
  },
  setY: function(e) {
    return this.y = e, this;
  },
  setZ: function(e) {
    return this.z = e, this;
  },
  setW: function(e) {
    return this.w = e, this;
  },
  setComponent: function(e, t) {
    switch (e) {
      case 0:
        this.x = t;
        break;
      case 1:
        this.y = t;
        break;
      case 2:
        this.z = t;
        break;
      case 3:
        this.w = t;
        break;
      default:
        throw new Error("index is out of range: " + e);
    }
    return this;
  },
  getComponent: function(e) {
    switch (e) {
      case 0:
        return this.x;
      case 1:
        return this.y;
      case 2:
        return this.z;
      case 3:
        return this.w;
      default:
        throw new Error("index is out of range: " + e);
    }
  },
  clone: function() {
    return new this.constructor(this.x, this.y, this.z, this.w);
  },
  copy: function(e) {
    return this.x = e.x, this.y = e.y, this.z = e.z, this.w = e.w !== void 0 ? e.w : 1, this;
  },
  add: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this.z += e.z, this.w += e.w, this);
  },
  addScalar: function(e) {
    return this.x += e, this.y += e, this.z += e, this.w += e, this;
  },
  addVectors: function(e, t) {
    return this.x = e.x + t.x, this.y = e.y + t.y, this.z = e.z + t.z, this.w = e.w + t.w, this;
  },
  addScaledVector: function(e, t) {
    return this.x += e.x * t, this.y += e.y * t, this.z += e.z * t, this.w += e.w * t, this;
  },
  sub: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this.z -= e.z, this.w -= e.w, this);
  },
  subScalar: function(e) {
    return this.x -= e, this.y -= e, this.z -= e, this.w -= e, this;
  },
  subVectors: function(e, t) {
    return this.x = e.x - t.x, this.y = e.y - t.y, this.z = e.z - t.z, this.w = e.w - t.w, this;
  },
  multiplyScalar: function(e) {
    return this.x *= e, this.y *= e, this.z *= e, this.w *= e, this;
  },
  applyMatrix4: function(e) {
    var t = this.x, r = this.y, n = this.z, i = this.w, a = e.elements;
    return this.x = a[0] * t + a[4] * r + a[8] * n + a[12] * i, this.y = a[1] * t + a[5] * r + a[9] * n + a[13] * i, this.z = a[2] * t + a[6] * r + a[10] * n + a[14] * i, this.w = a[3] * t + a[7] * r + a[11] * n + a[15] * i, this;
  },
  divideScalar: function(e) {
    return this.multiplyScalar(1 / e);
  },
  setAxisAngleFromQuaternion: function(e) {
    this.w = 2 * Math.acos(e.w);
    var t = Math.sqrt(1 - e.w * e.w);
    return t < 1e-4 ? (this.x = 1, this.y = 0, this.z = 0) : (this.x = e.x / t, this.y = e.y / t, this.z = e.z / t), this;
  },
  setAxisAngleFromRotationMatrix: function(e) {
    var t, r, n, i, a = 0.01, s = 0.1, o = e.elements, u = o[0], l = o[4], c = o[8], f = o[1], h = o[5], d = o[9], g = o[2], v = o[6], m = o[10];
    if (Math.abs(l - f) < a && Math.abs(c - g) < a && Math.abs(d - v) < a) {
      if (Math.abs(l + f) < s && Math.abs(c + g) < s && Math.abs(d + v) < s && Math.abs(u + h + m - 3) < s)
        return this.set(1, 0, 0, 0), this;
      t = Math.PI;
      var p = (u + 1) / 2, y = (h + 1) / 2, w = (m + 1) / 2, x = (l + f) / 4, b = (c + g) / 4, M = (d + v) / 4;
      return p > y && p > w ? p < a ? (r = 0, n = 0.707106781, i = 0.707106781) : (r = Math.sqrt(p), n = x / r, i = b / r) : y > w ? y < a ? (r = 0.707106781, n = 0, i = 0.707106781) : (n = Math.sqrt(y), r = x / n, i = M / n) : w < a ? (r = 0.707106781, n = 0.707106781, i = 0) : (i = Math.sqrt(w), r = b / i, n = M / i), this.set(r, n, i, t), this;
    }
    var k = Math.sqrt((v - d) * (v - d) + (c - g) * (c - g) + (f - l) * (f - l));
    return Math.abs(k) < 1e-3 && (k = 1), this.x = (v - d) / k, this.y = (c - g) / k, this.z = (f - l) / k, this.w = Math.acos((u + h + m - 1) / 2), this;
  },
  min: function(e) {
    return this.x = Math.min(this.x, e.x), this.y = Math.min(this.y, e.y), this.z = Math.min(this.z, e.z), this.w = Math.min(this.w, e.w), this;
  },
  max: function(e) {
    return this.x = Math.max(this.x, e.x), this.y = Math.max(this.y, e.y), this.z = Math.max(this.z, e.z), this.w = Math.max(this.w, e.w), this;
  },
  clamp: function(e, t) {
    return this.x = Math.max(e.x, Math.min(t.x, this.x)), this.y = Math.max(e.y, Math.min(t.y, this.y)), this.z = Math.max(e.z, Math.min(t.z, this.z)), this.w = Math.max(e.w, Math.min(t.w, this.w)), this;
  },
  clampScalar: function(e, t) {
    return this.x = Math.max(e, Math.min(t, this.x)), this.y = Math.max(e, Math.min(t, this.y)), this.z = Math.max(e, Math.min(t, this.z)), this.w = Math.max(e, Math.min(t, this.w)), this;
  },
  clampLength: function(e, t) {
    var r = this.length();
    return this.divideScalar(r || 1).multiplyScalar(Math.max(e, Math.min(t, r)));
  },
  floor: function() {
    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this.w = Math.floor(this.w), this;
  },
  ceil: function() {
    return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this.w = Math.ceil(this.w), this;
  },
  round: function() {
    return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this.w = Math.round(this.w), this;
  },
  roundToZero: function() {
    return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w), this;
  },
  negate: function() {
    return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this;
  },
  dot: function(e) {
    return this.x * e.x + this.y * e.y + this.z * e.z + this.w * e.w;
  },
  lengthSq: function() {
    return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
  },
  length: function() {
    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);
  },
  manhattanLength: function() {
    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);
  },
  normalize: function() {
    return this.divideScalar(this.length() || 1);
  },
  setLength: function(e) {
    return this.normalize().multiplyScalar(e);
  },
  lerp: function(e, t) {
    return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this.z += (e.z - this.z) * t, this.w += (e.w - this.w) * t, this;
  },
  lerpVectors: function(e, t, r) {
    return this.subVectors(t, e).multiplyScalar(r).add(e);
  },
  equals: function(e) {
    return e.x === this.x && e.y === this.y && e.z === this.z && e.w === this.w;
  },
  fromArray: function(e, t) {
    return t === void 0 && (t = 0), this.x = e[t], this.y = e[t + 1], this.z = e[t + 2], this.w = e[t + 3], this;
  },
  toArray: function(e, t) {
    return e === void 0 && (e = []), t === void 0 && (t = 0), e[t] = this.x, e[t + 1] = this.y, e[t + 2] = this.z, e[t + 3] = this.w, e;
  },
  fromBufferAttribute: function(e, t, r) {
    return r !== void 0 && console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."), this.x = e.getX(t), this.y = e.getY(t), this.z = e.getZ(t), this.w = e.getW(t), this;
  }
});
function vn(e, t, r) {
  this.width = e, this.height = t, this.scissor = new or(0, 0, e, t), this.scissorTest = !1, this.viewport = new or(0, 0, e, t), r = r || {}, this.texture = new ur(void 0, r.mapping, r.wrapS, r.wrapT, r.magFilter, r.minFilter, r.format, r.type, r.anisotropy, r.encoding), this.texture.image = {}, this.texture.image.width = e, this.texture.image.height = t, this.texture.generateMipmaps = r.generateMipmaps !== void 0 ? r.generateMipmaps : !1, this.texture.minFilter = r.minFilter !== void 0 ? r.minFilter : Vr, this.depthBuffer = r.depthBuffer !== void 0 ? r.depthBuffer : !0, this.stencilBuffer = r.stencilBuffer !== void 0 ? r.stencilBuffer : !0, this.depthTexture = r.depthTexture !== void 0 ? r.depthTexture : null;
}
vn.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: vn,
  isWebGLRenderTarget: !0,
  setSize: function(e, t) {
    (this.width !== e || this.height !== t) && (this.width = e, this.height = t, this.texture.image.width = e, this.texture.image.height = t, this.dispose()), this.viewport.set(0, 0, e, t), this.scissor.set(0, 0, e, t);
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.width = e.width, this.height = e.height, this.viewport.copy(e.viewport), this.texture = e.texture.clone(), this.depthBuffer = e.depthBuffer, this.stencilBuffer = e.stencilBuffer, this.depthTexture = e.depthTexture, this;
  },
  dispose: function() {
    this.dispatchEvent({ type: "dispose" });
  }
});
function vg(e, t, r) {
  vn.call(this, e, t, r), this.samples = 4;
}
vg.prototype = Object.assign(Object.create(vn.prototype), {
  constructor: vg,
  isWebGLMultisampleRenderTarget: !0,
  copy: function(e) {
    return vn.prototype.copy.call(this, e), this.samples = e.samples, this;
  }
});
function Tn(e, t, r, n) {
  this._x = e || 0, this._y = t || 0, this._z = r || 0, this._w = n !== void 0 ? n : 1;
}
Object.assign(Tn, {
  slerp: function(e, t, r, n) {
    return r.copy(e).slerp(t, n);
  },
  slerpFlat: function(e, t, r, n, i, a, s) {
    var o = r[n + 0], u = r[n + 1], l = r[n + 2], c = r[n + 3], f = i[a + 0], h = i[a + 1], d = i[a + 2], g = i[a + 3];
    if (c !== g || o !== f || u !== h || l !== d) {
      var v = 1 - s, m = o * f + u * h + l * d + c * g, p = m >= 0 ? 1 : -1, y = 1 - m * m;
      if (y > Number.EPSILON) {
        var w = Math.sqrt(y), x = Math.atan2(w, m * p);
        v = Math.sin(v * x) / w, s = Math.sin(s * x) / w;
      }
      var b = s * p;
      if (o = o * v + f * b, u = u * v + h * b, l = l * v + d * b, c = c * v + g * b, v === 1 - s) {
        var M = 1 / Math.sqrt(o * o + u * u + l * l + c * c);
        o *= M, u *= M, l *= M, c *= M;
      }
    }
    e[t] = o, e[t + 1] = u, e[t + 2] = l, e[t + 3] = c;
  }
});
Object.defineProperties(Tn.prototype, {
  x: {
    get: function() {
      return this._x;
    },
    set: function(e) {
      this._x = e, this._onChangeCallback();
    }
  },
  y: {
    get: function() {
      return this._y;
    },
    set: function(e) {
      this._y = e, this._onChangeCallback();
    }
  },
  z: {
    get: function() {
      return this._z;
    },
    set: function(e) {
      this._z = e, this._onChangeCallback();
    }
  },
  w: {
    get: function() {
      return this._w;
    },
    set: function(e) {
      this._w = e, this._onChangeCallback();
    }
  }
});
Object.assign(Tn.prototype, {
  isQuaternion: !0,
  set: function(e, t, r, n) {
    return this._x = e, this._y = t, this._z = r, this._w = n, this._onChangeCallback(), this;
  },
  clone: function() {
    return new this.constructor(this._x, this._y, this._z, this._w);
  },
  copy: function(e) {
    return this._x = e.x, this._y = e.y, this._z = e.z, this._w = e.w, this._onChangeCallback(), this;
  },
  setFromEuler: function(e, t) {
    if (!(e && e.isEuler))
      throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
    var r = e._x, n = e._y, i = e._z, a = e.order, s = Math.cos, o = Math.sin, u = s(r / 2), l = s(n / 2), c = s(i / 2), f = o(r / 2), h = o(n / 2), d = o(i / 2);
    return a === "XYZ" ? (this._x = f * l * c + u * h * d, this._y = u * h * c - f * l * d, this._z = u * l * d + f * h * c, this._w = u * l * c - f * h * d) : a === "YXZ" ? (this._x = f * l * c + u * h * d, this._y = u * h * c - f * l * d, this._z = u * l * d - f * h * c, this._w = u * l * c + f * h * d) : a === "ZXY" ? (this._x = f * l * c - u * h * d, this._y = u * h * c + f * l * d, this._z = u * l * d + f * h * c, this._w = u * l * c - f * h * d) : a === "ZYX" ? (this._x = f * l * c - u * h * d, this._y = u * h * c + f * l * d, this._z = u * l * d - f * h * c, this._w = u * l * c + f * h * d) : a === "YZX" ? (this._x = f * l * c + u * h * d, this._y = u * h * c + f * l * d, this._z = u * l * d - f * h * c, this._w = u * l * c - f * h * d) : a === "XZY" && (this._x = f * l * c - u * h * d, this._y = u * h * c - f * l * d, this._z = u * l * d + f * h * c, this._w = u * l * c + f * h * d), t !== !1 && this._onChangeCallback(), this;
  },
  setFromAxisAngle: function(e, t) {
    var r = t / 2, n = Math.sin(r);
    return this._x = e.x * n, this._y = e.y * n, this._z = e.z * n, this._w = Math.cos(r), this._onChangeCallback(), this;
  },
  setFromRotationMatrix: function(e) {
    var t = e.elements, r = t[0], n = t[4], i = t[8], a = t[1], s = t[5], o = t[9], u = t[2], l = t[6], c = t[10], f = r + s + c, h;
    return f > 0 ? (h = 0.5 / Math.sqrt(f + 1), this._w = 0.25 / h, this._x = (l - o) * h, this._y = (i - u) * h, this._z = (a - n) * h) : r > s && r > c ? (h = 2 * Math.sqrt(1 + r - s - c), this._w = (l - o) / h, this._x = 0.25 * h, this._y = (n + a) / h, this._z = (i + u) / h) : s > c ? (h = 2 * Math.sqrt(1 + s - r - c), this._w = (i - u) / h, this._x = (n + a) / h, this._y = 0.25 * h, this._z = (o + l) / h) : (h = 2 * Math.sqrt(1 + c - r - s), this._w = (a - n) / h, this._x = (i + u) / h, this._y = (o + l) / h, this._z = 0.25 * h), this._onChangeCallback(), this;
  },
  setFromUnitVectors: function(e, t) {
    var r = 1e-6, n = e.dot(t) + 1;
    return n < r ? (n = 0, Math.abs(e.x) > Math.abs(e.z) ? (this._x = -e.y, this._y = e.x, this._z = 0, this._w = n) : (this._x = 0, this._y = -e.z, this._z = e.y, this._w = n)) : (this._x = e.y * t.z - e.z * t.y, this._y = e.z * t.x - e.x * t.z, this._z = e.x * t.y - e.y * t.x, this._w = n), this.normalize();
  },
  angleTo: function(e) {
    return 2 * Math.acos(Math.abs(It.clamp(this.dot(e), -1, 1)));
  },
  rotateTowards: function(e, t) {
    var r = this.angleTo(e);
    if (r === 0) return this;
    var n = Math.min(1, t / r);
    return this.slerp(e, n), this;
  },
  inverse: function() {
    return this.conjugate();
  },
  conjugate: function() {
    return this._x *= -1, this._y *= -1, this._z *= -1, this._onChangeCallback(), this;
  },
  dot: function(e) {
    return this._x * e._x + this._y * e._y + this._z * e._z + this._w * e._w;
  },
  lengthSq: function() {
    return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;
  },
  length: function() {
    return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);
  },
  normalize: function() {
    var e = this.length();
    return e === 0 ? (this._x = 0, this._y = 0, this._z = 0, this._w = 1) : (e = 1 / e, this._x = this._x * e, this._y = this._y * e, this._z = this._z * e, this._w = this._w * e), this._onChangeCallback(), this;
  },
  multiply: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."), this.multiplyQuaternions(e, t)) : this.multiplyQuaternions(this, e);
  },
  premultiply: function(e) {
    return this.multiplyQuaternions(e, this);
  },
  multiplyQuaternions: function(e, t) {
    var r = e._x, n = e._y, i = e._z, a = e._w, s = t._x, o = t._y, u = t._z, l = t._w;
    return this._x = r * l + a * s + n * u - i * o, this._y = n * l + a * o + i * s - r * u, this._z = i * l + a * u + r * o - n * s, this._w = a * l - r * s - n * o - i * u, this._onChangeCallback(), this;
  },
  slerp: function(e, t) {
    if (t === 0) return this;
    if (t === 1) return this.copy(e);
    var r = this._x, n = this._y, i = this._z, a = this._w, s = a * e._w + r * e._x + n * e._y + i * e._z;
    if (s < 0 ? (this._w = -e._w, this._x = -e._x, this._y = -e._y, this._z = -e._z, s = -s) : this.copy(e), s >= 1)
      return this._w = a, this._x = r, this._y = n, this._z = i, this;
    var o = 1 - s * s;
    if (o <= Number.EPSILON) {
      var u = 1 - t;
      return this._w = u * a + t * this._w, this._x = u * r + t * this._x, this._y = u * n + t * this._y, this._z = u * i + t * this._z, this.normalize(), this._onChangeCallback(), this;
    }
    var l = Math.sqrt(o), c = Math.atan2(l, s), f = Math.sin((1 - t) * c) / l, h = Math.sin(t * c) / l;
    return this._w = a * f + this._w * h, this._x = r * f + this._x * h, this._y = n * f + this._y * h, this._z = i * f + this._z * h, this._onChangeCallback(), this;
  },
  equals: function(e) {
    return e._x === this._x && e._y === this._y && e._z === this._z && e._w === this._w;
  },
  fromArray: function(e, t) {
    return t === void 0 && (t = 0), this._x = e[t], this._y = e[t + 1], this._z = e[t + 2], this._w = e[t + 3], this._onChangeCallback(), this;
  },
  toArray: function(e, t) {
    return e === void 0 && (e = []), t === void 0 && (t = 0), e[t] = this._x, e[t + 1] = this._y, e[t + 2] = this._z, e[t + 3] = this._w, e;
  },
  _onChange: function(e) {
    return this._onChangeCallback = e, this;
  },
  _onChangeCallback: function() {
  }
});
var Wh = new re(), mg = new Tn();
function re(e, t, r) {
  this.x = e || 0, this.y = t || 0, this.z = r || 0;
}
Object.assign(re.prototype, {
  isVector3: !0,
  set: function(e, t, r) {
    return this.x = e, this.y = t, this.z = r, this;
  },
  setScalar: function(e) {
    return this.x = e, this.y = e, this.z = e, this;
  },
  setX: function(e) {
    return this.x = e, this;
  },
  setY: function(e) {
    return this.y = e, this;
  },
  setZ: function(e) {
    return this.z = e, this;
  },
  setComponent: function(e, t) {
    switch (e) {
      case 0:
        this.x = t;
        break;
      case 1:
        this.y = t;
        break;
      case 2:
        this.z = t;
        break;
      default:
        throw new Error("index is out of range: " + e);
    }
    return this;
  },
  getComponent: function(e) {
    switch (e) {
      case 0:
        return this.x;
      case 1:
        return this.y;
      case 2:
        return this.z;
      default:
        throw new Error("index is out of range: " + e);
    }
  },
  clone: function() {
    return new this.constructor(this.x, this.y, this.z);
  },
  copy: function(e) {
    return this.x = e.x, this.y = e.y, this.z = e.z, this;
  },
  add: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(e, t)) : (this.x += e.x, this.y += e.y, this.z += e.z, this);
  },
  addScalar: function(e) {
    return this.x += e, this.y += e, this.z += e, this;
  },
  addVectors: function(e, t) {
    return this.x = e.x + t.x, this.y = e.y + t.y, this.z = e.z + t.z, this;
  },
  addScaledVector: function(e, t) {
    return this.x += e.x * t, this.y += e.y * t, this.z += e.z * t, this;
  },
  sub: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(e, t)) : (this.x -= e.x, this.y -= e.y, this.z -= e.z, this);
  },
  subScalar: function(e) {
    return this.x -= e, this.y -= e, this.z -= e, this;
  },
  subVectors: function(e, t) {
    return this.x = e.x - t.x, this.y = e.y - t.y, this.z = e.z - t.z, this;
  },
  multiply: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."), this.multiplyVectors(e, t)) : (this.x *= e.x, this.y *= e.y, this.z *= e.z, this);
  },
  multiplyScalar: function(e) {
    return this.x *= e, this.y *= e, this.z *= e, this;
  },
  multiplyVectors: function(e, t) {
    return this.x = e.x * t.x, this.y = e.y * t.y, this.z = e.z * t.z, this;
  },
  applyEuler: function(e) {
    return e && e.isEuler || console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."), this.applyQuaternion(mg.setFromEuler(e));
  },
  applyAxisAngle: function(e, t) {
    return this.applyQuaternion(mg.setFromAxisAngle(e, t));
  },
  applyMatrix3: function(e) {
    var t = this.x, r = this.y, n = this.z, i = e.elements;
    return this.x = i[0] * t + i[3] * r + i[6] * n, this.y = i[1] * t + i[4] * r + i[7] * n, this.z = i[2] * t + i[5] * r + i[8] * n, this;
  },
  applyNormalMatrix: function(e) {
    return this.applyMatrix3(e).normalize();
  },
  applyMatrix4: function(e) {
    var t = this.x, r = this.y, n = this.z, i = e.elements, a = 1 / (i[3] * t + i[7] * r + i[11] * n + i[15]);
    return this.x = (i[0] * t + i[4] * r + i[8] * n + i[12]) * a, this.y = (i[1] * t + i[5] * r + i[9] * n + i[13]) * a, this.z = (i[2] * t + i[6] * r + i[10] * n + i[14]) * a, this;
  },
  applyQuaternion: function(e) {
    var t = this.x, r = this.y, n = this.z, i = e.x, a = e.y, s = e.z, o = e.w, u = o * t + a * n - s * r, l = o * r + s * t - i * n, c = o * n + i * r - a * t, f = -i * t - a * r - s * n;
    return this.x = u * o + f * -i + l * -s - c * -a, this.y = l * o + f * -a + c * -i - u * -s, this.z = c * o + f * -s + u * -a - l * -i, this;
  },
  project: function(e) {
    return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix);
  },
  unproject: function(e) {
    return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld);
  },
  transformDirection: function(e) {
    var t = this.x, r = this.y, n = this.z, i = e.elements;
    return this.x = i[0] * t + i[4] * r + i[8] * n, this.y = i[1] * t + i[5] * r + i[9] * n, this.z = i[2] * t + i[6] * r + i[10] * n, this.normalize();
  },
  divide: function(e) {
    return this.x /= e.x, this.y /= e.y, this.z /= e.z, this;
  },
  divideScalar: function(e) {
    return this.multiplyScalar(1 / e);
  },
  min: function(e) {
    return this.x = Math.min(this.x, e.x), this.y = Math.min(this.y, e.y), this.z = Math.min(this.z, e.z), this;
  },
  max: function(e) {
    return this.x = Math.max(this.x, e.x), this.y = Math.max(this.y, e.y), this.z = Math.max(this.z, e.z), this;
  },
  clamp: function(e, t) {
    return this.x = Math.max(e.x, Math.min(t.x, this.x)), this.y = Math.max(e.y, Math.min(t.y, this.y)), this.z = Math.max(e.z, Math.min(t.z, this.z)), this;
  },
  clampScalar: function(e, t) {
    return this.x = Math.max(e, Math.min(t, this.x)), this.y = Math.max(e, Math.min(t, this.y)), this.z = Math.max(e, Math.min(t, this.z)), this;
  },
  clampLength: function(e, t) {
    var r = this.length();
    return this.divideScalar(r || 1).multiplyScalar(Math.max(e, Math.min(t, r)));
  },
  floor: function() {
    return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this;
  },
  ceil: function() {
    return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this;
  },
  round: function() {
    return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this;
  },
  roundToZero: function() {
    return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this;
  },
  negate: function() {
    return this.x = -this.x, this.y = -this.y, this.z = -this.z, this;
  },
  dot: function(e) {
    return this.x * e.x + this.y * e.y + this.z * e.z;
  },
  // TODO lengthSquared?
  lengthSq: function() {
    return this.x * this.x + this.y * this.y + this.z * this.z;
  },
  length: function() {
    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
  },
  manhattanLength: function() {
    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);
  },
  normalize: function() {
    return this.divideScalar(this.length() || 1);
  },
  setLength: function(e) {
    return this.normalize().multiplyScalar(e);
  },
  lerp: function(e, t) {
    return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this.z += (e.z - this.z) * t, this;
  },
  lerpVectors: function(e, t, r) {
    return this.subVectors(t, e).multiplyScalar(r).add(e);
  },
  cross: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."), this.crossVectors(e, t)) : this.crossVectors(this, e);
  },
  crossVectors: function(e, t) {
    var r = e.x, n = e.y, i = e.z, a = t.x, s = t.y, o = t.z;
    return this.x = n * o - i * s, this.y = i * a - r * o, this.z = r * s - n * a, this;
  },
  projectOnVector: function(e) {
    var t = e.lengthSq();
    if (t === 0) return this.set(0, 0, 0);
    var r = e.dot(this) / t;
    return this.copy(e).multiplyScalar(r);
  },
  projectOnPlane: function(e) {
    return Wh.copy(this).projectOnVector(e), this.sub(Wh);
  },
  reflect: function(e) {
    return this.sub(Wh.copy(e).multiplyScalar(2 * this.dot(e)));
  },
  angleTo: function(e) {
    var t = Math.sqrt(this.lengthSq() * e.lengthSq());
    if (t === 0) return Math.PI / 2;
    var r = this.dot(e) / t;
    return Math.acos(It.clamp(r, -1, 1));
  },
  distanceTo: function(e) {
    return Math.sqrt(this.distanceToSquared(e));
  },
  distanceToSquared: function(e) {
    var t = this.x - e.x, r = this.y - e.y, n = this.z - e.z;
    return t * t + r * r + n * n;
  },
  manhattanDistanceTo: function(e) {
    return Math.abs(this.x - e.x) + Math.abs(this.y - e.y) + Math.abs(this.z - e.z);
  },
  setFromSpherical: function(e) {
    return this.setFromSphericalCoords(e.radius, e.phi, e.theta);
  },
  setFromSphericalCoords: function(e, t, r) {
    var n = Math.sin(t) * e;
    return this.x = n * Math.sin(r), this.y = Math.cos(t) * e, this.z = n * Math.cos(r), this;
  },
  setFromCylindrical: function(e) {
    return this.setFromCylindricalCoords(e.radius, e.theta, e.y);
  },
  setFromCylindricalCoords: function(e, t, r) {
    return this.x = e * Math.sin(t), this.y = r, this.z = e * Math.cos(t), this;
  },
  setFromMatrixPosition: function(e) {
    var t = e.elements;
    return this.x = t[12], this.y = t[13], this.z = t[14], this;
  },
  setFromMatrixScale: function(e) {
    var t = this.setFromMatrixColumn(e, 0).length(), r = this.setFromMatrixColumn(e, 1).length(), n = this.setFromMatrixColumn(e, 2).length();
    return this.x = t, this.y = r, this.z = n, this;
  },
  setFromMatrixColumn: function(e, t) {
    return this.fromArray(e.elements, t * 4);
  },
  setFromMatrix3Column: function(e, t) {
    return this.fromArray(e.elements, t * 3);
  },
  equals: function(e) {
    return e.x === this.x && e.y === this.y && e.z === this.z;
  },
  fromArray: function(e, t) {
    return t === void 0 && (t = 0), this.x = e[t], this.y = e[t + 1], this.z = e[t + 2], this;
  },
  toArray: function(e, t) {
    return e === void 0 && (e = []), t === void 0 && (t = 0), e[t] = this.x, e[t + 1] = this.y, e[t + 2] = this.z, e;
  },
  fromBufferAttribute: function(e, t, r) {
    return r !== void 0 && console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."), this.x = e.getX(t), this.y = e.getY(t), this.z = e.getZ(t), this;
  }
});
var Gs = new re(), ri = new Nt(), NA = new re(0, 0, 0), UA = new re(1, 1, 1), ya = new re(), Rl = new re(), Cn = new re();
function Nt() {
  this.elements = [
    1,
    0,
    0,
    0,
    0,
    1,
    0,
    0,
    0,
    0,
    1,
    0,
    0,
    0,
    0,
    1
  ], arguments.length > 0 && console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.");
}
Object.assign(Nt.prototype, {
  isMatrix4: !0,
  set: function(e, t, r, n, i, a, s, o, u, l, c, f, h, d, g, v) {
    var m = this.elements;
    return m[0] = e, m[4] = t, m[8] = r, m[12] = n, m[1] = i, m[5] = a, m[9] = s, m[13] = o, m[2] = u, m[6] = l, m[10] = c, m[14] = f, m[3] = h, m[7] = d, m[11] = g, m[15] = v, this;
  },
  identity: function() {
    return this.set(
      1,
      0,
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  clone: function() {
    return new Nt().fromArray(this.elements);
  },
  copy: function(e) {
    var t = this.elements, r = e.elements;
    return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t[4] = r[4], t[5] = r[5], t[6] = r[6], t[7] = r[7], t[8] = r[8], t[9] = r[9], t[10] = r[10], t[11] = r[11], t[12] = r[12], t[13] = r[13], t[14] = r[14], t[15] = r[15], this;
  },
  copyPosition: function(e) {
    var t = this.elements, r = e.elements;
    return t[12] = r[12], t[13] = r[13], t[14] = r[14], this;
  },
  extractBasis: function(e, t, r) {
    return e.setFromMatrixColumn(this, 0), t.setFromMatrixColumn(this, 1), r.setFromMatrixColumn(this, 2), this;
  },
  makeBasis: function(e, t, r) {
    return this.set(
      e.x,
      t.x,
      r.x,
      0,
      e.y,
      t.y,
      r.y,
      0,
      e.z,
      t.z,
      r.z,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  extractRotation: function(e) {
    var t = this.elements, r = e.elements, n = 1 / Gs.setFromMatrixColumn(e, 0).length(), i = 1 / Gs.setFromMatrixColumn(e, 1).length(), a = 1 / Gs.setFromMatrixColumn(e, 2).length();
    return t[0] = r[0] * n, t[1] = r[1] * n, t[2] = r[2] * n, t[3] = 0, t[4] = r[4] * i, t[5] = r[5] * i, t[6] = r[6] * i, t[7] = 0, t[8] = r[8] * a, t[9] = r[9] * a, t[10] = r[10] * a, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, this;
  },
  makeRotationFromEuler: function(e) {
    e && e.isEuler || console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
    var t = this.elements, r = e.x, n = e.y, i = e.z, a = Math.cos(r), s = Math.sin(r), o = Math.cos(n), u = Math.sin(n), l = Math.cos(i), c = Math.sin(i);
    if (e.order === "XYZ") {
      var f = a * l, h = a * c, d = s * l, g = s * c;
      t[0] = o * l, t[4] = -o * c, t[8] = u, t[1] = h + d * u, t[5] = f - g * u, t[9] = -s * o, t[2] = g - f * u, t[6] = d + h * u, t[10] = a * o;
    } else if (e.order === "YXZ") {
      var v = o * l, m = o * c, p = u * l, y = u * c;
      t[0] = v + y * s, t[4] = p * s - m, t[8] = a * u, t[1] = a * c, t[5] = a * l, t[9] = -s, t[2] = m * s - p, t[6] = y + v * s, t[10] = a * o;
    } else if (e.order === "ZXY") {
      var v = o * l, m = o * c, p = u * l, y = u * c;
      t[0] = v - y * s, t[4] = -a * c, t[8] = p + m * s, t[1] = m + p * s, t[5] = a * l, t[9] = y - v * s, t[2] = -a * u, t[6] = s, t[10] = a * o;
    } else if (e.order === "ZYX") {
      var f = a * l, h = a * c, d = s * l, g = s * c;
      t[0] = o * l, t[4] = d * u - h, t[8] = f * u + g, t[1] = o * c, t[5] = g * u + f, t[9] = h * u - d, t[2] = -u, t[6] = s * o, t[10] = a * o;
    } else if (e.order === "YZX") {
      var w = a * o, x = a * u, b = s * o, M = s * u;
      t[0] = o * l, t[4] = M - w * c, t[8] = b * c + x, t[1] = c, t[5] = a * l, t[9] = -s * l, t[2] = -u * l, t[6] = x * c + b, t[10] = w - M * c;
    } else if (e.order === "XZY") {
      var w = a * o, x = a * u, b = s * o, M = s * u;
      t[0] = o * l, t[4] = -c, t[8] = u * l, t[1] = w * c + M, t[5] = a * l, t[9] = x * c - b, t[2] = b * c - x, t[6] = s * l, t[10] = M * c + w;
    }
    return t[3] = 0, t[7] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, this;
  },
  makeRotationFromQuaternion: function(e) {
    return this.compose(NA, e, UA);
  },
  lookAt: function(e, t, r) {
    var n = this.elements;
    return Cn.subVectors(e, t), Cn.lengthSq() === 0 && (Cn.z = 1), Cn.normalize(), ya.crossVectors(r, Cn), ya.lengthSq() === 0 && (Math.abs(r.z) === 1 ? Cn.x += 1e-4 : Cn.z += 1e-4, Cn.normalize(), ya.crossVectors(r, Cn)), ya.normalize(), Rl.crossVectors(Cn, ya), n[0] = ya.x, n[4] = Rl.x, n[8] = Cn.x, n[1] = ya.y, n[5] = Rl.y, n[9] = Cn.y, n[2] = ya.z, n[6] = Rl.z, n[10] = Cn.z, this;
  },
  multiply: function(e, t) {
    return t !== void 0 ? (console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."), this.multiplyMatrices(e, t)) : this.multiplyMatrices(this, e);
  },
  premultiply: function(e) {
    return this.multiplyMatrices(e, this);
  },
  multiplyMatrices: function(e, t) {
    var r = e.elements, n = t.elements, i = this.elements, a = r[0], s = r[4], o = r[8], u = r[12], l = r[1], c = r[5], f = r[9], h = r[13], d = r[2], g = r[6], v = r[10], m = r[14], p = r[3], y = r[7], w = r[11], x = r[15], b = n[0], M = n[4], k = n[8], E = n[12], S = n[1], F = n[5], O = n[9], D = n[13], _ = n[2], L = n[6], G = n[10], V = n[14], H = n[3], U = n[7], R = n[11], B = n[15];
    return i[0] = a * b + s * S + o * _ + u * H, i[4] = a * M + s * F + o * L + u * U, i[8] = a * k + s * O + o * G + u * R, i[12] = a * E + s * D + o * V + u * B, i[1] = l * b + c * S + f * _ + h * H, i[5] = l * M + c * F + f * L + h * U, i[9] = l * k + c * O + f * G + h * R, i[13] = l * E + c * D + f * V + h * B, i[2] = d * b + g * S + v * _ + m * H, i[6] = d * M + g * F + v * L + m * U, i[10] = d * k + g * O + v * G + m * R, i[14] = d * E + g * D + v * V + m * B, i[3] = p * b + y * S + w * _ + x * H, i[7] = p * M + y * F + w * L + x * U, i[11] = p * k + y * O + w * G + x * R, i[15] = p * E + y * D + w * V + x * B, this;
  },
  multiplyScalar: function(e) {
    var t = this.elements;
    return t[0] *= e, t[4] *= e, t[8] *= e, t[12] *= e, t[1] *= e, t[5] *= e, t[9] *= e, t[13] *= e, t[2] *= e, t[6] *= e, t[10] *= e, t[14] *= e, t[3] *= e, t[7] *= e, t[11] *= e, t[15] *= e, this;
  },
  determinant: function() {
    var e = this.elements, t = e[0], r = e[4], n = e[8], i = e[12], a = e[1], s = e[5], o = e[9], u = e[13], l = e[2], c = e[6], f = e[10], h = e[14], d = e[3], g = e[7], v = e[11], m = e[15];
    return d * (+i * o * c - n * u * c - i * s * f + r * u * f + n * s * h - r * o * h) + g * (+t * o * h - t * u * f + i * a * f - n * a * h + n * u * l - i * o * l) + v * (+t * u * c - t * s * h - i * a * c + r * a * h + i * s * l - r * u * l) + m * (-n * s * l - t * o * c + t * s * f + n * a * c - r * a * f + r * o * l);
  },
  transpose: function() {
    var e = this.elements, t;
    return t = e[1], e[1] = e[4], e[4] = t, t = e[2], e[2] = e[8], e[8] = t, t = e[6], e[6] = e[9], e[9] = t, t = e[3], e[3] = e[12], e[12] = t, t = e[7], e[7] = e[13], e[13] = t, t = e[11], e[11] = e[14], e[14] = t, this;
  },
  setPosition: function(e, t, r) {
    var n = this.elements;
    return e.isVector3 ? (n[12] = e.x, n[13] = e.y, n[14] = e.z) : (n[12] = e, n[13] = t, n[14] = r), this;
  },
  getInverse: function(e, t) {
    var r = this.elements, n = e.elements, i = n[0], a = n[1], s = n[2], o = n[3], u = n[4], l = n[5], c = n[6], f = n[7], h = n[8], d = n[9], g = n[10], v = n[11], m = n[12], p = n[13], y = n[14], w = n[15], x = d * y * f - p * g * f + p * c * v - l * y * v - d * c * w + l * g * w, b = m * g * f - h * y * f - m * c * v + u * y * v + h * c * w - u * g * w, M = h * p * f - m * d * f + m * l * v - u * p * v - h * l * w + u * d * w, k = m * d * c - h * p * c - m * l * g + u * p * g + h * l * y - u * d * y, E = i * x + a * b + s * M + o * k;
    if (E === 0) {
      var S = "THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";
      if (t === !0)
        throw new Error(S);
      return console.warn(S), this.identity();
    }
    var F = 1 / E;
    return r[0] = x * F, r[1] = (p * g * o - d * y * o - p * s * v + a * y * v + d * s * w - a * g * w) * F, r[2] = (l * y * o - p * c * o + p * s * f - a * y * f - l * s * w + a * c * w) * F, r[3] = (d * c * o - l * g * o - d * s * f + a * g * f + l * s * v - a * c * v) * F, r[4] = b * F, r[5] = (h * y * o - m * g * o + m * s * v - i * y * v - h * s * w + i * g * w) * F, r[6] = (m * c * o - u * y * o - m * s * f + i * y * f + u * s * w - i * c * w) * F, r[7] = (u * g * o - h * c * o + h * s * f - i * g * f - u * s * v + i * c * v) * F, r[8] = M * F, r[9] = (m * d * o - h * p * o - m * a * v + i * p * v + h * a * w - i * d * w) * F, r[10] = (u * p * o - m * l * o + m * a * f - i * p * f - u * a * w + i * l * w) * F, r[11] = (h * l * o - u * d * o - h * a * f + i * d * f + u * a * v - i * l * v) * F, r[12] = k * F, r[13] = (h * p * s - m * d * s + m * a * g - i * p * g - h * a * y + i * d * y) * F, r[14] = (m * l * s - u * p * s - m * a * c + i * p * c + u * a * y - i * l * y) * F, r[15] = (u * d * s - h * l * s + h * a * c - i * d * c - u * a * g + i * l * g) * F, this;
  },
  scale: function(e) {
    var t = this.elements, r = e.x, n = e.y, i = e.z;
    return t[0] *= r, t[4] *= n, t[8] *= i, t[1] *= r, t[5] *= n, t[9] *= i, t[2] *= r, t[6] *= n, t[10] *= i, t[3] *= r, t[7] *= n, t[11] *= i, this;
  },
  getMaxScaleOnAxis: function() {
    var e = this.elements, t = e[0] * e[0] + e[1] * e[1] + e[2] * e[2], r = e[4] * e[4] + e[5] * e[5] + e[6] * e[6], n = e[8] * e[8] + e[9] * e[9] + e[10] * e[10];
    return Math.sqrt(Math.max(t, r, n));
  },
  makeTranslation: function(e, t, r) {
    return this.set(
      1,
      0,
      0,
      e,
      0,
      1,
      0,
      t,
      0,
      0,
      1,
      r,
      0,
      0,
      0,
      1
    ), this;
  },
  makeRotationX: function(e) {
    var t = Math.cos(e), r = Math.sin(e);
    return this.set(
      1,
      0,
      0,
      0,
      0,
      t,
      -r,
      0,
      0,
      r,
      t,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  makeRotationY: function(e) {
    var t = Math.cos(e), r = Math.sin(e);
    return this.set(
      t,
      0,
      r,
      0,
      0,
      1,
      0,
      0,
      -r,
      0,
      t,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  makeRotationZ: function(e) {
    var t = Math.cos(e), r = Math.sin(e);
    return this.set(
      t,
      -r,
      0,
      0,
      r,
      t,
      0,
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  makeRotationAxis: function(e, t) {
    var r = Math.cos(t), n = Math.sin(t), i = 1 - r, a = e.x, s = e.y, o = e.z, u = i * a, l = i * s;
    return this.set(
      u * a + r,
      u * s - n * o,
      u * o + n * s,
      0,
      u * s + n * o,
      l * s + r,
      l * o - n * a,
      0,
      u * o - n * s,
      l * o + n * a,
      i * o * o + r,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  makeScale: function(e, t, r) {
    return this.set(
      e,
      0,
      0,
      0,
      0,
      t,
      0,
      0,
      0,
      0,
      r,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  makeShear: function(e, t, r) {
    return this.set(
      1,
      t,
      r,
      0,
      e,
      1,
      r,
      0,
      e,
      t,
      1,
      0,
      0,
      0,
      0,
      1
    ), this;
  },
  compose: function(e, t, r) {
    var n = this.elements, i = t._x, a = t._y, s = t._z, o = t._w, u = i + i, l = a + a, c = s + s, f = i * u, h = i * l, d = i * c, g = a * l, v = a * c, m = s * c, p = o * u, y = o * l, w = o * c, x = r.x, b = r.y, M = r.z;
    return n[0] = (1 - (g + m)) * x, n[1] = (h + w) * x, n[2] = (d - y) * x, n[3] = 0, n[4] = (h - w) * b, n[5] = (1 - (f + m)) * b, n[6] = (v + p) * b, n[7] = 0, n[8] = (d + y) * M, n[9] = (v - p) * M, n[10] = (1 - (f + g)) * M, n[11] = 0, n[12] = e.x, n[13] = e.y, n[14] = e.z, n[15] = 1, this;
  },
  decompose: function(e, t, r) {
    var n = this.elements, i = Gs.set(n[0], n[1], n[2]).length(), a = Gs.set(n[4], n[5], n[6]).length(), s = Gs.set(n[8], n[9], n[10]).length(), o = this.determinant();
    o < 0 && (i = -i), e.x = n[12], e.y = n[13], e.z = n[14], ri.copy(this);
    var u = 1 / i, l = 1 / a, c = 1 / s;
    return ri.elements[0] *= u, ri.elements[1] *= u, ri.elements[2] *= u, ri.elements[4] *= l, ri.elements[5] *= l, ri.elements[6] *= l, ri.elements[8] *= c, ri.elements[9] *= c, ri.elements[10] *= c, t.setFromRotationMatrix(ri), r.x = i, r.y = a, r.z = s, this;
  },
  makePerspective: function(e, t, r, n, i, a) {
    a === void 0 && console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
    var s = this.elements, o = 2 * i / (t - e), u = 2 * i / (r - n), l = (t + e) / (t - e), c = (r + n) / (r - n), f = -(a + i) / (a - i), h = -2 * a * i / (a - i);
    return s[0] = o, s[4] = 0, s[8] = l, s[12] = 0, s[1] = 0, s[5] = u, s[9] = c, s[13] = 0, s[2] = 0, s[6] = 0, s[10] = f, s[14] = h, s[3] = 0, s[7] = 0, s[11] = -1, s[15] = 0, this;
  },
  makeOrthographic: function(e, t, r, n, i, a) {
    var s = this.elements, o = 1 / (t - e), u = 1 / (r - n), l = 1 / (a - i), c = (t + e) * o, f = (r + n) * u, h = (a + i) * l;
    return s[0] = 2 * o, s[4] = 0, s[8] = 0, s[12] = -c, s[1] = 0, s[5] = 2 * u, s[9] = 0, s[13] = -f, s[2] = 0, s[6] = 0, s[10] = -2 * l, s[14] = -h, s[3] = 0, s[7] = 0, s[11] = 0, s[15] = 1, this;
  },
  equals: function(e) {
    for (var t = this.elements, r = e.elements, n = 0; n < 16; n++)
      if (t[n] !== r[n]) return !1;
    return !0;
  },
  fromArray: function(e, t) {
    t === void 0 && (t = 0);
    for (var r = 0; r < 16; r++)
      this.elements[r] = e[r + t];
    return this;
  },
  toArray: function(e, t) {
    e === void 0 && (e = []), t === void 0 && (t = 0);
    var r = this.elements;
    return e[t] = r[0], e[t + 1] = r[1], e[t + 2] = r[2], e[t + 3] = r[3], e[t + 4] = r[4], e[t + 5] = r[5], e[t + 6] = r[6], e[t + 7] = r[7], e[t + 8] = r[8], e[t + 9] = r[9], e[t + 10] = r[10], e[t + 11] = r[11], e[t + 12] = r[12], e[t + 13] = r[13], e[t + 14] = r[14], e[t + 15] = r[15], e;
  }
});
var gg = new Nt(), yg = new Tn();
function $o(e, t, r, n) {
  this._x = e || 0, this._y = t || 0, this._z = r || 0, this._order = n || $o.DefaultOrder;
}
$o.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"];
$o.DefaultOrder = "XYZ";
Object.defineProperties($o.prototype, {
  x: {
    get: function() {
      return this._x;
    },
    set: function(e) {
      this._x = e, this._onChangeCallback();
    }
  },
  y: {
    get: function() {
      return this._y;
    },
    set: function(e) {
      this._y = e, this._onChangeCallback();
    }
  },
  z: {
    get: function() {
      return this._z;
    },
    set: function(e) {
      this._z = e, this._onChangeCallback();
    }
  },
  order: {
    get: function() {
      return this._order;
    },
    set: function(e) {
      this._order = e, this._onChangeCallback();
    }
  }
});
Object.assign($o.prototype, {
  isEuler: !0,
  set: function(e, t, r, n) {
    return this._x = e, this._y = t, this._z = r, this._order = n || this._order, this._onChangeCallback(), this;
  },
  clone: function() {
    return new this.constructor(this._x, this._y, this._z, this._order);
  },
  copy: function(e) {
    return this._x = e._x, this._y = e._y, this._z = e._z, this._order = e._order, this._onChangeCallback(), this;
  },
  setFromRotationMatrix: function(e, t, r) {
    var n = It.clamp, i = e.elements, a = i[0], s = i[4], o = i[8], u = i[1], l = i[5], c = i[9], f = i[2], h = i[6], d = i[10];
    return t = t || this._order, t === "XYZ" ? (this._y = Math.asin(n(o, -1, 1)), Math.abs(o) < 0.9999999 ? (this._x = Math.atan2(-c, d), this._z = Math.atan2(-s, a)) : (this._x = Math.atan2(h, l), this._z = 0)) : t === "YXZ" ? (this._x = Math.asin(-n(c, -1, 1)), Math.abs(c) < 0.9999999 ? (this._y = Math.atan2(o, d), this._z = Math.atan2(u, l)) : (this._y = Math.atan2(-f, a), this._z = 0)) : t === "ZXY" ? (this._x = Math.asin(n(h, -1, 1)), Math.abs(h) < 0.9999999 ? (this._y = Math.atan2(-f, d), this._z = Math.atan2(-s, l)) : (this._y = 0, this._z = Math.atan2(u, a))) : t === "ZYX" ? (this._y = Math.asin(-n(f, -1, 1)), Math.abs(f) < 0.9999999 ? (this._x = Math.atan2(h, d), this._z = Math.atan2(u, a)) : (this._x = 0, this._z = Math.atan2(-s, l))) : t === "YZX" ? (this._z = Math.asin(n(u, -1, 1)), Math.abs(u) < 0.9999999 ? (this._x = Math.atan2(-c, l), this._y = Math.atan2(-f, a)) : (this._x = 0, this._y = Math.atan2(o, d))) : t === "XZY" ? (this._z = Math.asin(-n(s, -1, 1)), Math.abs(s) < 0.9999999 ? (this._x = Math.atan2(h, l), this._y = Math.atan2(o, a)) : (this._x = Math.atan2(-c, d), this._y = 0)) : console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: " + t), this._order = t, r !== !1 && this._onChangeCallback(), this;
  },
  setFromQuaternion: function(e, t, r) {
    return gg.makeRotationFromQuaternion(e), this.setFromRotationMatrix(gg, t, r);
  },
  setFromVector3: function(e, t) {
    return this.set(e.x, e.y, e.z, t || this._order);
  },
  reorder: function(e) {
    return yg.setFromEuler(this), this.setFromQuaternion(yg, e);
  },
  equals: function(e) {
    return e._x === this._x && e._y === this._y && e._z === this._z && e._order === this._order;
  },
  fromArray: function(e) {
    return this._x = e[0], this._y = e[1], this._z = e[2], e[3] !== void 0 && (this._order = e[3]), this._onChangeCallback(), this;
  },
  toArray: function(e, t) {
    return e === void 0 && (e = []), t === void 0 && (t = 0), e[t] = this._x, e[t + 1] = this._y, e[t + 2] = this._z, e[t + 3] = this._order, e;
  },
  toVector3: function(e) {
    return e ? e.set(this._x, this._y, this._z) : new re(this._x, this._y, this._z);
  },
  _onChange: function(e) {
    return this._onChangeCallback = e, this;
  },
  _onChangeCallback: function() {
  }
});
function wb() {
  this.mask = 1;
}
Object.assign(wb.prototype, {
  set: function(e) {
    this.mask = 1 << e | 0;
  },
  enable: function(e) {
    this.mask |= 1 << e | 0;
  },
  enableAll: function() {
    this.mask = -1;
  },
  toggle: function(e) {
    this.mask ^= 1 << e | 0;
  },
  disable: function(e) {
    this.mask &= ~(1 << e | 0);
  },
  disableAll: function() {
    this.mask = 0;
  },
  test: function(e) {
    return (this.mask & e.mask) !== 0;
  }
});
var GA = 0, bg = new re(), zs = new Tn(), Vi = new Nt(), Ol = new re(), ru = new re(), zA = new re(), WA = new Tn(), wg = new re(1, 0, 0), xg = new re(0, 1, 0), Mg = new re(0, 0, 1), VA = { type: "added" }, HA = { type: "removed" };
function et() {
  Object.defineProperty(this, "id", { value: GA++ }), this.uuid = It.generateUUID(), this.name = "", this.type = "Object3D", this.parent = null, this.children = [], this.up = et.DefaultUp.clone();
  var e = new re(), t = new $o(), r = new Tn(), n = new re(1, 1, 1);
  function i() {
    r.setFromEuler(t, !1);
  }
  function a() {
    t.setFromQuaternion(r, void 0, !1);
  }
  t._onChange(i), r._onChange(a), Object.defineProperties(this, {
    position: {
      configurable: !0,
      enumerable: !0,
      value: e
    },
    rotation: {
      configurable: !0,
      enumerable: !0,
      value: t
    },
    quaternion: {
      configurable: !0,
      enumerable: !0,
      value: r
    },
    scale: {
      configurable: !0,
      enumerable: !0,
      value: n
    },
    modelViewMatrix: {
      value: new Nt()
    },
    normalMatrix: {
      value: new an()
    }
  }), this.matrix = new Nt(), this.matrixWorld = new Nt(), this.matrixAutoUpdate = et.DefaultMatrixAutoUpdate, this.matrixWorldNeedsUpdate = !1, this.layers = new wb(), this.visible = !0, this.castShadow = !1, this.receiveShadow = !1, this.frustumCulled = !0, this.renderOrder = 0, this.userData = {};
}
et.DefaultUp = new re(0, 1, 0);
et.DefaultMatrixAutoUpdate = !0;
et.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: et,
  isObject3D: !0,
  onBeforeRender: function() {
  },
  onAfterRender: function() {
  },
  applyMatrix4: function(e) {
    this.matrixAutoUpdate && this.updateMatrix(), this.matrix.premultiply(e), this.matrix.decompose(this.position, this.quaternion, this.scale);
  },
  applyQuaternion: function(e) {
    return this.quaternion.premultiply(e), this;
  },
  setRotationFromAxisAngle: function(e, t) {
    this.quaternion.setFromAxisAngle(e, t);
  },
  setRotationFromEuler: function(e) {
    this.quaternion.setFromEuler(e, !0);
  },
  setRotationFromMatrix: function(e) {
    this.quaternion.setFromRotationMatrix(e);
  },
  setRotationFromQuaternion: function(e) {
    this.quaternion.copy(e);
  },
  rotateOnAxis: function(e, t) {
    return zs.setFromAxisAngle(e, t), this.quaternion.multiply(zs), this;
  },
  rotateOnWorldAxis: function(e, t) {
    return zs.setFromAxisAngle(e, t), this.quaternion.premultiply(zs), this;
  },
  rotateX: function(e) {
    return this.rotateOnAxis(wg, e);
  },
  rotateY: function(e) {
    return this.rotateOnAxis(xg, e);
  },
  rotateZ: function(e) {
    return this.rotateOnAxis(Mg, e);
  },
  translateOnAxis: function(e, t) {
    return bg.copy(e).applyQuaternion(this.quaternion), this.position.add(bg.multiplyScalar(t)), this;
  },
  translateX: function(e) {
    return this.translateOnAxis(wg, e);
  },
  translateY: function(e) {
    return this.translateOnAxis(xg, e);
  },
  translateZ: function(e) {
    return this.translateOnAxis(Mg, e);
  },
  localToWorld: function(e) {
    return e.applyMatrix4(this.matrixWorld);
  },
  worldToLocal: function(e) {
    return e.applyMatrix4(Vi.getInverse(this.matrixWorld));
  },
  lookAt: function(e, t, r) {
    e.isVector3 ? Ol.copy(e) : Ol.set(e, t, r);
    var n = this.parent;
    this.updateWorldMatrix(!0, !1), ru.setFromMatrixPosition(this.matrixWorld), this.isCamera || this.isLight ? Vi.lookAt(ru, Ol, this.up) : Vi.lookAt(Ol, ru, this.up), this.quaternion.setFromRotationMatrix(Vi), n && (Vi.extractRotation(n.matrixWorld), zs.setFromRotationMatrix(Vi), this.quaternion.premultiply(zs.inverse()));
  },
  add: function(e) {
    if (arguments.length > 1) {
      for (var t = 0; t < arguments.length; t++)
        this.add(arguments[t]);
      return this;
    }
    return e === this ? (console.error("THREE.Object3D.add: object can't be added as a child of itself.", e), this) : (e && e.isObject3D ? (e.parent !== null && e.parent.remove(e), e.parent = this, this.children.push(e), e.dispatchEvent(VA)) : console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", e), this);
  },
  remove: function(e) {
    if (arguments.length > 1) {
      for (var t = 0; t < arguments.length; t++)
        this.remove(arguments[t]);
      return this;
    }
    var r = this.children.indexOf(e);
    return r !== -1 && (e.parent = null, this.children.splice(r, 1), e.dispatchEvent(HA)), this;
  },
  attach: function(e) {
    return this.updateWorldMatrix(!0, !1), Vi.getInverse(this.matrixWorld), e.parent !== null && (e.parent.updateWorldMatrix(!0, !1), Vi.multiply(e.parent.matrixWorld)), e.applyMatrix4(Vi), e.updateWorldMatrix(!1, !1), this.add(e), this;
  },
  getObjectById: function(e) {
    return this.getObjectByProperty("id", e);
  },
  getObjectByName: function(e) {
    return this.getObjectByProperty("name", e);
  },
  getObjectByProperty: function(e, t) {
    if (this[e] === t) return this;
    for (var r = 0, n = this.children.length; r < n; r++) {
      var i = this.children[r], a = i.getObjectByProperty(e, t);
      if (a !== void 0)
        return a;
    }
  },
  getWorldPosition: function(e) {
    return e === void 0 && (console.warn("THREE.Object3D: .getWorldPosition() target is now required"), e = new re()), this.updateMatrixWorld(!0), e.setFromMatrixPosition(this.matrixWorld);
  },
  getWorldQuaternion: function(e) {
    return e === void 0 && (console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"), e = new Tn()), this.updateMatrixWorld(!0), this.matrixWorld.decompose(ru, e, zA), e;
  },
  getWorldScale: function(e) {
    return e === void 0 && (console.warn("THREE.Object3D: .getWorldScale() target is now required"), e = new re()), this.updateMatrixWorld(!0), this.matrixWorld.decompose(ru, WA, e), e;
  },
  getWorldDirection: function(e) {
    e === void 0 && (console.warn("THREE.Object3D: .getWorldDirection() target is now required"), e = new re()), this.updateMatrixWorld(!0);
    var t = this.matrixWorld.elements;
    return e.set(t[8], t[9], t[10]).normalize();
  },
  raycast: function() {
  },
  traverse: function(e) {
    e(this);
    for (var t = this.children, r = 0, n = t.length; r < n; r++)
      t[r].traverse(e);
  },
  traverseVisible: function(e) {
    if (this.visible !== !1) {
      e(this);
      for (var t = this.children, r = 0, n = t.length; r < n; r++)
        t[r].traverseVisible(e);
    }
  },
  traverseAncestors: function(e) {
    var t = this.parent;
    t !== null && (e(t), t.traverseAncestors(e));
  },
  updateMatrix: function() {
    this.matrix.compose(this.position, this.quaternion, this.scale), this.matrixWorldNeedsUpdate = !0;
  },
  updateMatrixWorld: function(e) {
    this.matrixAutoUpdate && this.updateMatrix(), (this.matrixWorldNeedsUpdate || e) && (this.parent === null ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.matrixWorldNeedsUpdate = !1, e = !0);
    for (var t = this.children, r = 0, n = t.length; r < n; r++)
      t[r].updateMatrixWorld(e);
  },
  updateWorldMatrix: function(e, t) {
    var r = this.parent;
    if (e === !0 && r !== null && r.updateWorldMatrix(!0, !1), this.matrixAutoUpdate && this.updateMatrix(), this.parent === null ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), t === !0)
      for (var n = this.children, i = 0, a = n.length; i < a; i++)
        n[i].updateWorldMatrix(!1, !0);
  },
  toJSON: function(e) {
    var t = e === void 0 || typeof e == "string", r = {};
    t && (e = {
      geometries: {},
      materials: {},
      textures: {},
      images: {},
      shapes: {}
    }, r.metadata = {
      version: 4.5,
      type: "Object",
      generator: "Object3D.toJSON"
    });
    var n = {};
    n.uuid = this.uuid, n.type = this.type, this.name !== "" && (n.name = this.name), this.castShadow === !0 && (n.castShadow = !0), this.receiveShadow === !0 && (n.receiveShadow = !0), this.visible === !1 && (n.visible = !1), this.frustumCulled === !1 && (n.frustumCulled = !1), this.renderOrder !== 0 && (n.renderOrder = this.renderOrder), JSON.stringify(this.userData) !== "{}" && (n.userData = this.userData), n.layers = this.layers.mask, n.matrix = this.matrix.toArray(), this.matrixAutoUpdate === !1 && (n.matrixAutoUpdate = !1), this.isInstancedMesh && (n.type = "InstancedMesh", n.count = this.count, n.instanceMatrix = this.instanceMatrix.toJSON());
    function i(m, p) {
      return m[p.uuid] === void 0 && (m[p.uuid] = p.toJSON(e)), p.uuid;
    }
    if (this.isMesh || this.isLine || this.isPoints) {
      n.geometry = i(e.geometries, this.geometry);
      var a = this.geometry.parameters;
      if (a !== void 0 && a.shapes !== void 0) {
        var s = a.shapes;
        if (Array.isArray(s))
          for (var o = 0, u = s.length; o < u; o++) {
            var l = s[o];
            i(e.shapes, l);
          }
        else
          i(e.shapes, s);
      }
    }
    if (this.material !== void 0)
      if (Array.isArray(this.material)) {
        for (var c = [], o = 0, u = this.material.length; o < u; o++)
          c.push(i(e.materials, this.material[o]));
        n.material = c;
      } else
        n.material = i(e.materials, this.material);
    if (this.children.length > 0) {
      n.children = [];
      for (var o = 0; o < this.children.length; o++)
        n.children.push(this.children[o].toJSON(e).object);
    }
    if (t) {
      var f = v(e.geometries), h = v(e.materials), d = v(e.textures), g = v(e.images), s = v(e.shapes);
      f.length > 0 && (r.geometries = f), h.length > 0 && (r.materials = h), d.length > 0 && (r.textures = d), g.length > 0 && (r.images = g), s.length > 0 && (r.shapes = s);
    }
    return r.object = n, r;
    function v(m) {
      var p = [];
      for (var y in m) {
        var w = m[y];
        delete w.metadata, p.push(w);
      }
      return p;
    }
  },
  clone: function(e) {
    return new this.constructor().copy(this, e);
  },
  copy: function(e, t) {
    if (t === void 0 && (t = !0), this.name = e.name, this.up.copy(e.up), this.position.copy(e.position), this.quaternion.copy(e.quaternion), this.scale.copy(e.scale), this.matrix.copy(e.matrix), this.matrixWorld.copy(e.matrixWorld), this.matrixAutoUpdate = e.matrixAutoUpdate, this.matrixWorldNeedsUpdate = e.matrixWorldNeedsUpdate, this.layers.mask = e.layers.mask, this.visible = e.visible, this.castShadow = e.castShadow, this.receiveShadow = e.receiveShadow, this.frustumCulled = e.frustumCulled, this.renderOrder = e.renderOrder, this.userData = JSON.parse(JSON.stringify(e.userData)), t === !0)
      for (var r = 0; r < e.children.length; r++) {
        var n = e.children[r];
        this.add(n.clone());
      }
    return this;
  }
});
function Ra() {
  et.call(this), this.type = "Scene", this.background = null, this.environment = null, this.fog = null, this.overrideMaterial = null, this.autoUpdate = !0, typeof __THREE_DEVTOOLS__ != "undefined" && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe", { detail: this }));
}
Ra.prototype = Object.assign(Object.create(et.prototype), {
  constructor: Ra,
  isScene: !0,
  copy: function(e, t) {
    return et.prototype.copy.call(this, e, t), e.background !== null && (this.background = e.background.clone()), e.environment !== null && (this.environment = e.environment.clone()), e.fog !== null && (this.fog = e.fog.clone()), e.overrideMaterial !== null && (this.overrideMaterial = e.overrideMaterial.clone()), this.autoUpdate = e.autoUpdate, this.matrixAutoUpdate = e.matrixAutoUpdate, this;
  },
  toJSON: function(e) {
    var t = et.prototype.toJSON.call(this, e);
    return this.background !== null && (t.object.background = this.background.toJSON(e)), this.environment !== null && (t.object.environment = this.environment.toJSON(e)), this.fog !== null && (t.object.fog = this.fog.toJSON()), t;
  },
  dispose: function() {
    this.dispatchEvent({ type: "dispose" });
  }
});
var Hi = [
  new re(),
  new re(),
  new re(),
  new re(),
  new re(),
  new re(),
  new re(),
  new re()
], nu = new re(), Nl = new Ui(), Ws = new re(), Vs = new re(), Hs = new re(), ba = new re(), wa = new re(), Za = new re(), iu = new re(), Ul = new re(), Gl = new re(), Ja = new re();
function Ui(e, t) {
  this.min = e !== void 0 ? e : new re(1 / 0, 1 / 0, 1 / 0), this.max = t !== void 0 ? t : new re(-1 / 0, -1 / 0, -1 / 0);
}
Object.assign(Ui.prototype, {
  isBox3: !0,
  set: function(e, t) {
    return this.min.copy(e), this.max.copy(t), this;
  },
  setFromArray: function(e) {
    for (var t = 1 / 0, r = 1 / 0, n = 1 / 0, i = -1 / 0, a = -1 / 0, s = -1 / 0, o = 0, u = e.length; o < u; o += 3) {
      var l = e[o], c = e[o + 1], f = e[o + 2];
      l < t && (t = l), c < r && (r = c), f < n && (n = f), l > i && (i = l), c > a && (a = c), f > s && (s = f);
    }
    return this.min.set(t, r, n), this.max.set(i, a, s), this;
  },
  setFromBufferAttribute: function(e) {
    for (var t = 1 / 0, r = 1 / 0, n = 1 / 0, i = -1 / 0, a = -1 / 0, s = -1 / 0, o = 0, u = e.count; o < u; o++) {
      var l = e.getX(o), c = e.getY(o), f = e.getZ(o);
      l < t && (t = l), c < r && (r = c), f < n && (n = f), l > i && (i = l), c > a && (a = c), f > s && (s = f);
    }
    return this.min.set(t, r, n), this.max.set(i, a, s), this;
  },
  setFromPoints: function(e) {
    this.makeEmpty();
    for (var t = 0, r = e.length; t < r; t++)
      this.expandByPoint(e[t]);
    return this;
  },
  setFromCenterAndSize: function(e, t) {
    var r = nu.copy(t).multiplyScalar(0.5);
    return this.min.copy(e).sub(r), this.max.copy(e).add(r), this;
  },
  setFromObject: function(e) {
    return this.makeEmpty(), this.expandByObject(e);
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.min.copy(e.min), this.max.copy(e.max), this;
  },
  makeEmpty: function() {
    return this.min.x = this.min.y = this.min.z = 1 / 0, this.max.x = this.max.y = this.max.z = -1 / 0, this;
  },
  isEmpty: function() {
    return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z;
  },
  getCenter: function(e) {
    return e === void 0 && (console.warn("THREE.Box3: .getCenter() target is now required"), e = new re()), this.isEmpty() ? e.set(0, 0, 0) : e.addVectors(this.min, this.max).multiplyScalar(0.5);
  },
  getSize: function(e) {
    return e === void 0 && (console.warn("THREE.Box3: .getSize() target is now required"), e = new re()), this.isEmpty() ? e.set(0, 0, 0) : e.subVectors(this.max, this.min);
  },
  expandByPoint: function(e) {
    return this.min.min(e), this.max.max(e), this;
  },
  expandByVector: function(e) {
    return this.min.sub(e), this.max.add(e), this;
  },
  expandByScalar: function(e) {
    return this.min.addScalar(-e), this.max.addScalar(e), this;
  },
  expandByObject: function(e) {
    e.updateWorldMatrix(!1, !1);
    var t = e.geometry;
    t !== void 0 && (t.boundingBox === null && t.computeBoundingBox(), Nl.copy(t.boundingBox), Nl.applyMatrix4(e.matrixWorld), this.expandByPoint(Nl.min), this.expandByPoint(Nl.max));
    for (var r = e.children, n = 0, i = r.length; n < i; n++)
      this.expandByObject(r[n]);
    return this;
  },
  containsPoint: function(e) {
    return !(e.x < this.min.x || e.x > this.max.x || e.y < this.min.y || e.y > this.max.y || e.z < this.min.z || e.z > this.max.z);
  },
  containsBox: function(e) {
    return this.min.x <= e.min.x && e.max.x <= this.max.x && this.min.y <= e.min.y && e.max.y <= this.max.y && this.min.z <= e.min.z && e.max.z <= this.max.z;
  },
  getParameter: function(e, t) {
    return t === void 0 && (console.warn("THREE.Box3: .getParameter() target is now required"), t = new re()), t.set(
      (e.x - this.min.x) / (this.max.x - this.min.x),
      (e.y - this.min.y) / (this.max.y - this.min.y),
      (e.z - this.min.z) / (this.max.z - this.min.z)
    );
  },
  intersectsBox: function(e) {
    return !(e.max.x < this.min.x || e.min.x > this.max.x || e.max.y < this.min.y || e.min.y > this.max.y || e.max.z < this.min.z || e.min.z > this.max.z);
  },
  intersectsSphere: function(e) {
    return this.clampPoint(e.center, nu), nu.distanceToSquared(e.center) <= e.radius * e.radius;
  },
  intersectsPlane: function(e) {
    var t, r;
    return e.normal.x > 0 ? (t = e.normal.x * this.min.x, r = e.normal.x * this.max.x) : (t = e.normal.x * this.max.x, r = e.normal.x * this.min.x), e.normal.y > 0 ? (t += e.normal.y * this.min.y, r += e.normal.y * this.max.y) : (t += e.normal.y * this.max.y, r += e.normal.y * this.min.y), e.normal.z > 0 ? (t += e.normal.z * this.min.z, r += e.normal.z * this.max.z) : (t += e.normal.z * this.max.z, r += e.normal.z * this.min.z), t <= -e.constant && r >= -e.constant;
  },
  intersectsTriangle: function(e) {
    if (this.isEmpty())
      return !1;
    this.getCenter(iu), Ul.subVectors(this.max, iu), Ws.subVectors(e.a, iu), Vs.subVectors(e.b, iu), Hs.subVectors(e.c, iu), ba.subVectors(Vs, Ws), wa.subVectors(Hs, Vs), Za.subVectors(Ws, Hs);
    var t = [
      0,
      -ba.z,
      ba.y,
      0,
      -wa.z,
      wa.y,
      0,
      -Za.z,
      Za.y,
      ba.z,
      0,
      -ba.x,
      wa.z,
      0,
      -wa.x,
      Za.z,
      0,
      -Za.x,
      -ba.y,
      ba.x,
      0,
      -wa.y,
      wa.x,
      0,
      -Za.y,
      Za.x,
      0
    ];
    return !Vh(t, Ws, Vs, Hs, Ul) || (t = [1, 0, 0, 0, 1, 0, 0, 0, 1], !Vh(t, Ws, Vs, Hs, Ul)) ? !1 : (Gl.crossVectors(ba, wa), t = [Gl.x, Gl.y, Gl.z], Vh(t, Ws, Vs, Hs, Ul));
  },
  clampPoint: function(e, t) {
    return t === void 0 && (console.warn("THREE.Box3: .clampPoint() target is now required"), t = new re()), t.copy(e).clamp(this.min, this.max);
  },
  distanceToPoint: function(e) {
    var t = nu.copy(e).clamp(this.min, this.max);
    return t.sub(e).length();
  },
  getBoundingSphere: function(e) {
    return e === void 0 && console.error("THREE.Box3: .getBoundingSphere() target is now required"), this.getCenter(e.center), e.radius = this.getSize(nu).length() * 0.5, e;
  },
  intersect: function(e) {
    return this.min.max(e.min), this.max.min(e.max), this.isEmpty() && this.makeEmpty(), this;
  },
  union: function(e) {
    return this.min.min(e.min), this.max.max(e.max), this;
  },
  applyMatrix4: function(e) {
    return this.isEmpty() ? this : (Hi[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(e), Hi[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(e), Hi[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(e), Hi[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(e), Hi[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(e), Hi[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(e), Hi[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(e), Hi[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(e), this.setFromPoints(Hi), this);
  },
  translate: function(e) {
    return this.min.add(e), this.max.add(e), this;
  },
  equals: function(e) {
    return e.min.equals(this.min) && e.max.equals(this.max);
  }
});
function Vh(e, t, r, n, i) {
  var a, s;
  for (a = 0, s = e.length - 3; a <= s; a += 3) {
    Ja.fromArray(e, a);
    var o = i.x * Math.abs(Ja.x) + i.y * Math.abs(Ja.y) + i.z * Math.abs(Ja.z), u = t.dot(Ja), l = r.dot(Ja), c = n.dot(Ja);
    if (Math.max(-Math.max(u, l, c), Math.min(u, l, c)) > o)
      return !1;
  }
  return !0;
}
var jA = new Ui();
function ja(e, t) {
  this.center = e !== void 0 ? e : new re(), this.radius = t !== void 0 ? t : 0;
}
Object.assign(ja.prototype, {
  set: function(e, t) {
    return this.center.copy(e), this.radius = t, this;
  },
  setFromPoints: function(e, t) {
    var r = this.center;
    t !== void 0 ? r.copy(t) : jA.setFromPoints(e).getCenter(r);
    for (var n = 0, i = 0, a = e.length; i < a; i++)
      n = Math.max(n, r.distanceToSquared(e[i]));
    return this.radius = Math.sqrt(n), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.center.copy(e.center), this.radius = e.radius, this;
  },
  empty: function() {
    return this.radius <= 0;
  },
  containsPoint: function(e) {
    return e.distanceToSquared(this.center) <= this.radius * this.radius;
  },
  distanceToPoint: function(e) {
    return e.distanceTo(this.center) - this.radius;
  },
  intersectsSphere: function(e) {
    var t = this.radius + e.radius;
    return e.center.distanceToSquared(this.center) <= t * t;
  },
  intersectsBox: function(e) {
    return e.intersectsSphere(this);
  },
  intersectsPlane: function(e) {
    return Math.abs(e.distanceToPoint(this.center)) <= this.radius;
  },
  clampPoint: function(e, t) {
    var r = this.center.distanceToSquared(e);
    return t === void 0 && (console.warn("THREE.Sphere: .clampPoint() target is now required"), t = new re()), t.copy(e), r > this.radius * this.radius && (t.sub(this.center).normalize(), t.multiplyScalar(this.radius).add(this.center)), t;
  },
  getBoundingBox: function(e) {
    return e === void 0 && (console.warn("THREE.Sphere: .getBoundingBox() target is now required"), e = new Ui()), e.set(this.center, this.center), e.expandByScalar(this.radius), e;
  },
  applyMatrix4: function(e) {
    return this.center.applyMatrix4(e), this.radius = this.radius * e.getMaxScaleOnAxis(), this;
  },
  translate: function(e) {
    return this.center.add(e), this;
  },
  equals: function(e) {
    return e.center.equals(this.center) && e.radius === this.radius;
  }
});
var ji = new re(), Hh = new re(), zl = new re(), xa = new re(), jh = new re(), Wl = new re(), Xh = new re();
function Yo(e, t) {
  this.origin = e !== void 0 ? e : new re(), this.direction = t !== void 0 ? t : new re(0, 0, -1);
}
Object.assign(Yo.prototype, {
  set: function(e, t) {
    return this.origin.copy(e), this.direction.copy(t), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.origin.copy(e.origin), this.direction.copy(e.direction), this;
  },
  at: function(e, t) {
    return t === void 0 && (console.warn("THREE.Ray: .at() target is now required"), t = new re()), t.copy(this.direction).multiplyScalar(e).add(this.origin);
  },
  lookAt: function(e) {
    return this.direction.copy(e).sub(this.origin).normalize(), this;
  },
  recast: function(e) {
    return this.origin.copy(this.at(e, ji)), this;
  },
  closestPointToPoint: function(e, t) {
    t === void 0 && (console.warn("THREE.Ray: .closestPointToPoint() target is now required"), t = new re()), t.subVectors(e, this.origin);
    var r = t.dot(this.direction);
    return r < 0 ? t.copy(this.origin) : t.copy(this.direction).multiplyScalar(r).add(this.origin);
  },
  distanceToPoint: function(e) {
    return Math.sqrt(this.distanceSqToPoint(e));
  },
  distanceSqToPoint: function(e) {
    var t = ji.subVectors(e, this.origin).dot(this.direction);
    return t < 0 ? this.origin.distanceToSquared(e) : (ji.copy(this.direction).multiplyScalar(t).add(this.origin), ji.distanceToSquared(e));
  },
  distanceSqToSegment: function(e, t, r, n) {
    Hh.copy(e).add(t).multiplyScalar(0.5), zl.copy(t).sub(e).normalize(), xa.copy(this.origin).sub(Hh);
    var i = e.distanceTo(t) * 0.5, a = -this.direction.dot(zl), s = xa.dot(this.direction), o = -xa.dot(zl), u = xa.lengthSq(), l = Math.abs(1 - a * a), c, f, h, d;
    if (l > 0)
      if (c = a * o - s, f = a * s - o, d = i * l, c >= 0)
        if (f >= -d)
          if (f <= d) {
            var g = 1 / l;
            c *= g, f *= g, h = c * (c + a * f + 2 * s) + f * (a * c + f + 2 * o) + u;
          } else
            f = i, c = Math.max(0, -(a * f + s)), h = -c * c + f * (f + 2 * o) + u;
        else
          f = -i, c = Math.max(0, -(a * f + s)), h = -c * c + f * (f + 2 * o) + u;
      else
        f <= -d ? (c = Math.max(0, -(-a * i + s)), f = c > 0 ? -i : Math.min(Math.max(-i, -o), i), h = -c * c + f * (f + 2 * o) + u) : f <= d ? (c = 0, f = Math.min(Math.max(-i, -o), i), h = f * (f + 2 * o) + u) : (c = Math.max(0, -(a * i + s)), f = c > 0 ? i : Math.min(Math.max(-i, -o), i), h = -c * c + f * (f + 2 * o) + u);
    else
      f = a > 0 ? -i : i, c = Math.max(0, -(a * f + s)), h = -c * c + f * (f + 2 * o) + u;
    return r && r.copy(this.direction).multiplyScalar(c).add(this.origin), n && n.copy(zl).multiplyScalar(f).add(Hh), h;
  },
  intersectSphere: function(e, t) {
    ji.subVectors(e.center, this.origin);
    var r = ji.dot(this.direction), n = ji.dot(ji) - r * r, i = e.radius * e.radius;
    if (n > i) return null;
    var a = Math.sqrt(i - n), s = r - a, o = r + a;
    return s < 0 && o < 0 ? null : s < 0 ? this.at(o, t) : this.at(s, t);
  },
  intersectsSphere: function(e) {
    return this.distanceSqToPoint(e.center) <= e.radius * e.radius;
  },
  distanceToPlane: function(e) {
    var t = e.normal.dot(this.direction);
    if (t === 0)
      return e.distanceToPoint(this.origin) === 0 ? 0 : null;
    var r = -(this.origin.dot(e.normal) + e.constant) / t;
    return r >= 0 ? r : null;
  },
  intersectPlane: function(e, t) {
    var r = this.distanceToPlane(e);
    return r === null ? null : this.at(r, t);
  },
  intersectsPlane: function(e) {
    var t = e.distanceToPoint(this.origin);
    if (t === 0)
      return !0;
    var r = e.normal.dot(this.direction);
    return r * t < 0;
  },
  intersectBox: function(e, t) {
    var r, n, i, a, s, o, u = 1 / this.direction.x, l = 1 / this.direction.y, c = 1 / this.direction.z, f = this.origin;
    return u >= 0 ? (r = (e.min.x - f.x) * u, n = (e.max.x - f.x) * u) : (r = (e.max.x - f.x) * u, n = (e.min.x - f.x) * u), l >= 0 ? (i = (e.min.y - f.y) * l, a = (e.max.y - f.y) * l) : (i = (e.max.y - f.y) * l, a = (e.min.y - f.y) * l), r > a || i > n || ((i > r || r !== r) && (r = i), (a < n || n !== n) && (n = a), c >= 0 ? (s = (e.min.z - f.z) * c, o = (e.max.z - f.z) * c) : (s = (e.max.z - f.z) * c, o = (e.min.z - f.z) * c), r > o || s > n) || ((s > r || r !== r) && (r = s), (o < n || n !== n) && (n = o), n < 0) ? null : this.at(r >= 0 ? r : n, t);
  },
  intersectsBox: function(e) {
    return this.intersectBox(e, ji) !== null;
  },
  intersectTriangle: function(e, t, r, n, i) {
    jh.subVectors(t, e), Wl.subVectors(r, e), Xh.crossVectors(jh, Wl);
    var a = this.direction.dot(Xh), s;
    if (a > 0) {
      if (n) return null;
      s = 1;
    } else if (a < 0)
      s = -1, a = -a;
    else
      return null;
    xa.subVectors(this.origin, e);
    var o = s * this.direction.dot(Wl.crossVectors(xa, Wl));
    if (o < 0)
      return null;
    var u = s * this.direction.dot(jh.cross(xa));
    if (u < 0 || o + u > a)
      return null;
    var l = -s * xa.dot(Xh);
    return l < 0 ? null : this.at(l / a, i);
  },
  applyMatrix4: function(e) {
    return this.origin.applyMatrix4(e), this.direction.transformDirection(e), this;
  },
  equals: function(e) {
    return e.origin.equals(this.origin) && e.direction.equals(this.direction);
  }
});
var qh = new re(), XA = new re(), qA = new an();
function wi(e, t) {
  this.normal = e !== void 0 ? e : new re(1, 0, 0), this.constant = t !== void 0 ? t : 0;
}
Object.assign(wi.prototype, {
  isPlane: !0,
  set: function(e, t) {
    return this.normal.copy(e), this.constant = t, this;
  },
  setComponents: function(e, t, r, n) {
    return this.normal.set(e, t, r), this.constant = n, this;
  },
  setFromNormalAndCoplanarPoint: function(e, t) {
    return this.normal.copy(e), this.constant = -t.dot(this.normal), this;
  },
  setFromCoplanarPoints: function(e, t, r) {
    var n = qh.subVectors(r, t).cross(XA.subVectors(e, t)).normalize();
    return this.setFromNormalAndCoplanarPoint(n, e), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.normal.copy(e.normal), this.constant = e.constant, this;
  },
  normalize: function() {
    var e = 1 / this.normal.length();
    return this.normal.multiplyScalar(e), this.constant *= e, this;
  },
  negate: function() {
    return this.constant *= -1, this.normal.negate(), this;
  },
  distanceToPoint: function(e) {
    return this.normal.dot(e) + this.constant;
  },
  distanceToSphere: function(e) {
    return this.distanceToPoint(e.center) - e.radius;
  },
  projectPoint: function(e, t) {
    return t === void 0 && (console.warn("THREE.Plane: .projectPoint() target is now required"), t = new re()), t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e);
  },
  intersectLine: function(e, t) {
    t === void 0 && (console.warn("THREE.Plane: .intersectLine() target is now required"), t = new re());
    var r = e.delta(qh), n = this.normal.dot(r);
    if (n === 0)
      return this.distanceToPoint(e.start) === 0 ? t.copy(e.start) : void 0;
    var i = -(e.start.dot(this.normal) + this.constant) / n;
    if (!(i < 0 || i > 1))
      return t.copy(r).multiplyScalar(i).add(e.start);
  },
  intersectsLine: function(e) {
    var t = this.distanceToPoint(e.start), r = this.distanceToPoint(e.end);
    return t < 0 && r > 0 || r < 0 && t > 0;
  },
  intersectsBox: function(e) {
    return e.intersectsPlane(this);
  },
  intersectsSphere: function(e) {
    return e.intersectsPlane(this);
  },
  coplanarPoint: function(e) {
    return e === void 0 && (console.warn("THREE.Plane: .coplanarPoint() target is now required"), e = new re()), e.copy(this.normal).multiplyScalar(-this.constant);
  },
  applyMatrix4: function(e, t) {
    var r = t || qA.getNormalMatrix(e), n = this.coplanarPoint(qh).applyMatrix4(e), i = this.normal.applyMatrix3(r).normalize();
    return this.constant = -n.dot(i), this;
  },
  translate: function(e) {
    return this.constant -= e.dot(this.normal), this;
  },
  equals: function(e) {
    return e.normal.equals(this.normal) && e.constant === this.constant;
  }
});
var ai = new re(), qi = new re(), $h = new re(), Xi = new re(), js = new re(), Xs = new re(), Eg = new re(), Yh = new re(), Kh = new re(), Zh = new re();
function Yr(e, t, r) {
  this.a = e !== void 0 ? e : new re(), this.b = t !== void 0 ? t : new re(), this.c = r !== void 0 ? r : new re();
}
Object.assign(Yr, {
  getNormal: function(e, t, r, n) {
    n === void 0 && (console.warn("THREE.Triangle: .getNormal() target is now required"), n = new re()), n.subVectors(r, t), ai.subVectors(e, t), n.cross(ai);
    var i = n.lengthSq();
    return i > 0 ? n.multiplyScalar(1 / Math.sqrt(i)) : n.set(0, 0, 0);
  },
  // static/instance method to calculate barycentric coordinates
  // based on: http://www.blackpawn.com/texts/pointinpoly/default.html
  getBarycoord: function(e, t, r, n, i) {
    ai.subVectors(n, t), qi.subVectors(r, t), $h.subVectors(e, t);
    var a = ai.dot(ai), s = ai.dot(qi), o = ai.dot($h), u = qi.dot(qi), l = qi.dot($h), c = a * u - s * s;
    if (i === void 0 && (console.warn("THREE.Triangle: .getBarycoord() target is now required"), i = new re()), c === 0)
      return i.set(-2, -1, -1);
    var f = 1 / c, h = (u * o - s * l) * f, d = (a * l - s * o) * f;
    return i.set(1 - h - d, d, h);
  },
  containsPoint: function(e, t, r, n) {
    return Yr.getBarycoord(e, t, r, n, Xi), Xi.x >= 0 && Xi.y >= 0 && Xi.x + Xi.y <= 1;
  },
  getUV: function(e, t, r, n, i, a, s, o) {
    return this.getBarycoord(e, t, r, n, Xi), o.set(0, 0), o.addScaledVector(i, Xi.x), o.addScaledVector(a, Xi.y), o.addScaledVector(s, Xi.z), o;
  },
  isFrontFacing: function(e, t, r, n) {
    return ai.subVectors(r, t), qi.subVectors(e, t), ai.cross(qi).dot(n) < 0;
  }
});
Object.assign(Yr.prototype, {
  set: function(e, t, r) {
    return this.a.copy(e), this.b.copy(t), this.c.copy(r), this;
  },
  setFromPointsAndIndices: function(e, t, r, n) {
    return this.a.copy(e[t]), this.b.copy(e[r]), this.c.copy(e[n]), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.a.copy(e.a), this.b.copy(e.b), this.c.copy(e.c), this;
  },
  getArea: function() {
    return ai.subVectors(this.c, this.b), qi.subVectors(this.a, this.b), ai.cross(qi).length() * 0.5;
  },
  getMidpoint: function(e) {
    return e === void 0 && (console.warn("THREE.Triangle: .getMidpoint() target is now required"), e = new re()), e.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3);
  },
  getNormal: function(e) {
    return Yr.getNormal(this.a, this.b, this.c, e);
  },
  getPlane: function(e) {
    return e === void 0 && (console.warn("THREE.Triangle: .getPlane() target is now required"), e = new wi()), e.setFromCoplanarPoints(this.a, this.b, this.c);
  },
  getBarycoord: function(e, t) {
    return Yr.getBarycoord(e, this.a, this.b, this.c, t);
  },
  getUV: function(e, t, r, n, i) {
    return Yr.getUV(e, this.a, this.b, this.c, t, r, n, i);
  },
  containsPoint: function(e) {
    return Yr.containsPoint(e, this.a, this.b, this.c);
  },
  isFrontFacing: function(e) {
    return Yr.isFrontFacing(this.a, this.b, this.c, e);
  },
  intersectsBox: function(e) {
    return e.intersectsTriangle(this);
  },
  closestPointToPoint: function(e, t) {
    t === void 0 && (console.warn("THREE.Triangle: .closestPointToPoint() target is now required"), t = new re());
    var r = this.a, n = this.b, i = this.c, a, s;
    js.subVectors(n, r), Xs.subVectors(i, r), Yh.subVectors(e, r);
    var o = js.dot(Yh), u = Xs.dot(Yh);
    if (o <= 0 && u <= 0)
      return t.copy(r);
    Kh.subVectors(e, n);
    var l = js.dot(Kh), c = Xs.dot(Kh);
    if (l >= 0 && c <= l)
      return t.copy(n);
    var f = o * c - l * u;
    if (f <= 0 && o >= 0 && l <= 0)
      return a = o / (o - l), t.copy(r).addScaledVector(js, a);
    Zh.subVectors(e, i);
    var h = js.dot(Zh), d = Xs.dot(Zh);
    if (d >= 0 && h <= d)
      return t.copy(i);
    var g = h * u - o * d;
    if (g <= 0 && u >= 0 && d <= 0)
      return s = u / (u - d), t.copy(r).addScaledVector(Xs, s);
    var v = l * d - h * c;
    if (v <= 0 && c - l >= 0 && h - d >= 0)
      return Eg.subVectors(i, n), s = (c - l) / (c - l + (h - d)), t.copy(n).addScaledVector(Eg, s);
    var m = 1 / (v + g + f);
    return a = g * m, s = f * m, t.copy(r).addScaledVector(js, a).addScaledVector(Xs, s);
  },
  equals: function(e) {
    return e.a.equals(this.a) && e.b.equals(this.b) && e.c.equals(this.c);
  }
});
var xb = {
  aliceblue: 15792383,
  antiquewhite: 16444375,
  aqua: 65535,
  aquamarine: 8388564,
  azure: 15794175,
  beige: 16119260,
  bisque: 16770244,
  black: 0,
  blanchedalmond: 16772045,
  blue: 255,
  blueviolet: 9055202,
  brown: 10824234,
  burlywood: 14596231,
  cadetblue: 6266528,
  chartreuse: 8388352,
  chocolate: 13789470,
  coral: 16744272,
  cornflowerblue: 6591981,
  cornsilk: 16775388,
  crimson: 14423100,
  cyan: 65535,
  darkblue: 139,
  darkcyan: 35723,
  darkgoldenrod: 12092939,
  darkgray: 11119017,
  darkgreen: 25600,
  darkgrey: 11119017,
  darkkhaki: 12433259,
  darkmagenta: 9109643,
  darkolivegreen: 5597999,
  darkorange: 16747520,
  darkorchid: 10040012,
  darkred: 9109504,
  darksalmon: 15308410,
  darkseagreen: 9419919,
  darkslateblue: 4734347,
  darkslategray: 3100495,
  darkslategrey: 3100495,
  darkturquoise: 52945,
  darkviolet: 9699539,
  deeppink: 16716947,
  deepskyblue: 49151,
  dimgray: 6908265,
  dimgrey: 6908265,
  dodgerblue: 2003199,
  firebrick: 11674146,
  floralwhite: 16775920,
  forestgreen: 2263842,
  fuchsia: 16711935,
  gainsboro: 14474460,
  ghostwhite: 16316671,
  gold: 16766720,
  goldenrod: 14329120,
  gray: 8421504,
  green: 32768,
  greenyellow: 11403055,
  grey: 8421504,
  honeydew: 15794160,
  hotpink: 16738740,
  indianred: 13458524,
  indigo: 4915330,
  ivory: 16777200,
  khaki: 15787660,
  lavender: 15132410,
  lavenderblush: 16773365,
  lawngreen: 8190976,
  lemonchiffon: 16775885,
  lightblue: 11393254,
  lightcoral: 15761536,
  lightcyan: 14745599,
  lightgoldenrodyellow: 16448210,
  lightgray: 13882323,
  lightgreen: 9498256,
  lightgrey: 13882323,
  lightpink: 16758465,
  lightsalmon: 16752762,
  lightseagreen: 2142890,
  lightskyblue: 8900346,
  lightslategray: 7833753,
  lightslategrey: 7833753,
  lightsteelblue: 11584734,
  lightyellow: 16777184,
  lime: 65280,
  limegreen: 3329330,
  linen: 16445670,
  magenta: 16711935,
  maroon: 8388608,
  mediumaquamarine: 6737322,
  mediumblue: 205,
  mediumorchid: 12211667,
  mediumpurple: 9662683,
  mediumseagreen: 3978097,
  mediumslateblue: 8087790,
  mediumspringgreen: 64154,
  mediumturquoise: 4772300,
  mediumvioletred: 13047173,
  midnightblue: 1644912,
  mintcream: 16121850,
  mistyrose: 16770273,
  moccasin: 16770229,
  navajowhite: 16768685,
  navy: 128,
  oldlace: 16643558,
  olive: 8421376,
  olivedrab: 7048739,
  orange: 16753920,
  orangered: 16729344,
  orchid: 14315734,
  palegoldenrod: 15657130,
  palegreen: 10025880,
  paleturquoise: 11529966,
  palevioletred: 14381203,
  papayawhip: 16773077,
  peachpuff: 16767673,
  peru: 13468991,
  pink: 16761035,
  plum: 14524637,
  powderblue: 11591910,
  purple: 8388736,
  rebeccapurple: 6697881,
  red: 16711680,
  rosybrown: 12357519,
  royalblue: 4286945,
  saddlebrown: 9127187,
  salmon: 16416882,
  sandybrown: 16032864,
  seagreen: 3050327,
  seashell: 16774638,
  sienna: 10506797,
  silver: 12632256,
  skyblue: 8900331,
  slateblue: 6970061,
  slategray: 7372944,
  slategrey: 7372944,
  snow: 16775930,
  springgreen: 65407,
  steelblue: 4620980,
  tan: 13808780,
  teal: 32896,
  thistle: 14204888,
  tomato: 16737095,
  turquoise: 4251856,
  violet: 15631086,
  wheat: 16113331,
  white: 16777215,
  whitesmoke: 16119285,
  yellow: 16776960,
  yellowgreen: 10145074
}, ni = { h: 0, s: 0, l: 0 }, Vl = { h: 0, s: 0, l: 0 };
function nt(e, t, r) {
  return t === void 0 && r === void 0 ? this.set(e) : this.setRGB(e, t, r);
}
function Jh(e, t, r) {
  return r < 0 && (r += 1), r > 1 && (r -= 1), r < 1 / 6 ? e + (t - e) * 6 * r : r < 1 / 2 ? t : r < 2 / 3 ? e + (t - e) * 6 * (2 / 3 - r) : e;
}
function Qh(e) {
  return e < 0.04045 ? e * 0.0773993808 : Math.pow(e * 0.9478672986 + 0.0521327014, 2.4);
}
function ed(e) {
  return e < 31308e-7 ? e * 12.92 : 1.055 * Math.pow(e, 0.41666) - 0.055;
}
Object.assign(nt.prototype, {
  isColor: !0,
  r: 1,
  g: 1,
  b: 1,
  set: function(e) {
    return e && e.isColor ? this.copy(e) : typeof e == "number" ? this.setHex(e) : typeof e == "string" && this.setStyle(e), this;
  },
  setScalar: function(e) {
    return this.r = e, this.g = e, this.b = e, this;
  },
  setHex: function(e) {
    return e = Math.floor(e), this.r = (e >> 16 & 255) / 255, this.g = (e >> 8 & 255) / 255, this.b = (e & 255) / 255, this;
  },
  setRGB: function(e, t, r) {
    return this.r = e, this.g = t, this.b = r, this;
  },
  setHSL: function(e, t, r) {
    if (e = It.euclideanModulo(e, 1), t = It.clamp(t, 0, 1), r = It.clamp(r, 0, 1), t === 0)
      this.r = this.g = this.b = r;
    else {
      var n = r <= 0.5 ? r * (1 + t) : r + t - r * t, i = 2 * r - n;
      this.r = Jh(i, n, e + 1 / 3), this.g = Jh(i, n, e), this.b = Jh(i, n, e - 1 / 3);
    }
    return this;
  },
  setStyle: function(e) {
    function t(f) {
      f !== void 0 && parseFloat(f) < 1 && console.warn("THREE.Color: Alpha component of " + e + " will be ignored.");
    }
    var r;
    if (r = /^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)) {
      var n, i = r[1], a = r[2];
      switch (i) {
        case "rgb":
        case "rgba":
          if (n = /^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))
            return this.r = Math.min(255, parseInt(n[1], 10)) / 255, this.g = Math.min(255, parseInt(n[2], 10)) / 255, this.b = Math.min(255, parseInt(n[3], 10)) / 255, t(n[5]), this;
          if (n = /^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))
            return this.r = Math.min(100, parseInt(n[1], 10)) / 100, this.g = Math.min(100, parseInt(n[2], 10)) / 100, this.b = Math.min(100, parseInt(n[3], 10)) / 100, t(n[5]), this;
          break;
        case "hsl":
        case "hsla":
          if (n = /^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)) {
            var s = parseFloat(n[1]) / 360, o = parseInt(n[2], 10) / 100, u = parseInt(n[3], 10) / 100;
            return t(n[5]), this.setHSL(s, o, u);
          }
          break;
      }
    } else if (r = /^\#([A-Fa-f0-9]+)$/.exec(e)) {
      var l = r[1], c = l.length;
      if (c === 3)
        return this.r = parseInt(l.charAt(0) + l.charAt(0), 16) / 255, this.g = parseInt(l.charAt(1) + l.charAt(1), 16) / 255, this.b = parseInt(l.charAt(2) + l.charAt(2), 16) / 255, this;
      if (c === 6)
        return this.r = parseInt(l.charAt(0) + l.charAt(1), 16) / 255, this.g = parseInt(l.charAt(2) + l.charAt(3), 16) / 255, this.b = parseInt(l.charAt(4) + l.charAt(5), 16) / 255, this;
    }
    return e && e.length > 0 ? this.setColorName(e) : this;
  },
  setColorName: function(e) {
    var t = xb[e];
    return t !== void 0 ? this.setHex(t) : console.warn("THREE.Color: Unknown color " + e), this;
  },
  clone: function() {
    return new this.constructor(this.r, this.g, this.b);
  },
  copy: function(e) {
    return this.r = e.r, this.g = e.g, this.b = e.b, this;
  },
  copyGammaToLinear: function(e, t) {
    return t === void 0 && (t = 2), this.r = Math.pow(e.r, t), this.g = Math.pow(e.g, t), this.b = Math.pow(e.b, t), this;
  },
  copyLinearToGamma: function(e, t) {
    t === void 0 && (t = 2);
    var r = t > 0 ? 1 / t : 1;
    return this.r = Math.pow(e.r, r), this.g = Math.pow(e.g, r), this.b = Math.pow(e.b, r), this;
  },
  convertGammaToLinear: function(e) {
    return this.copyGammaToLinear(this, e), this;
  },
  convertLinearToGamma: function(e) {
    return this.copyLinearToGamma(this, e), this;
  },
  copySRGBToLinear: function(e) {
    return this.r = Qh(e.r), this.g = Qh(e.g), this.b = Qh(e.b), this;
  },
  copyLinearToSRGB: function(e) {
    return this.r = ed(e.r), this.g = ed(e.g), this.b = ed(e.b), this;
  },
  convertSRGBToLinear: function() {
    return this.copySRGBToLinear(this), this;
  },
  convertLinearToSRGB: function() {
    return this.copyLinearToSRGB(this), this;
  },
  getHex: function() {
    return this.r * 255 << 16 ^ this.g * 255 << 8 ^ this.b * 255 << 0;
  },
  getHexString: function() {
    return ("000000" + this.getHex().toString(16)).slice(-6);
  },
  getHSL: function(e) {
    e === void 0 && (console.warn("THREE.Color: .getHSL() target is now required"), e = { h: 0, s: 0, l: 0 });
    var t = this.r, r = this.g, n = this.b, i = Math.max(t, r, n), a = Math.min(t, r, n), s, o, u = (a + i) / 2;
    if (a === i)
      s = 0, o = 0;
    else {
      var l = i - a;
      switch (o = u <= 0.5 ? l / (i + a) : l / (2 - i - a), i) {
        case t:
          s = (r - n) / l + (r < n ? 6 : 0);
          break;
        case r:
          s = (n - t) / l + 2;
          break;
        case n:
          s = (t - r) / l + 4;
          break;
      }
      s /= 6;
    }
    return e.h = s, e.s = o, e.l = u, e;
  },
  getStyle: function() {
    return "rgb(" + (this.r * 255 | 0) + "," + (this.g * 255 | 0) + "," + (this.b * 255 | 0) + ")";
  },
  offsetHSL: function(e, t, r) {
    return this.getHSL(ni), ni.h += e, ni.s += t, ni.l += r, this.setHSL(ni.h, ni.s, ni.l), this;
  },
  add: function(e) {
    return this.r += e.r, this.g += e.g, this.b += e.b, this;
  },
  addColors: function(e, t) {
    return this.r = e.r + t.r, this.g = e.g + t.g, this.b = e.b + t.b, this;
  },
  addScalar: function(e) {
    return this.r += e, this.g += e, this.b += e, this;
  },
  sub: function(e) {
    return this.r = Math.max(0, this.r - e.r), this.g = Math.max(0, this.g - e.g), this.b = Math.max(0, this.b - e.b), this;
  },
  multiply: function(e) {
    return this.r *= e.r, this.g *= e.g, this.b *= e.b, this;
  },
  multiplyScalar: function(e) {
    return this.r *= e, this.g *= e, this.b *= e, this;
  },
  lerp: function(e, t) {
    return this.r += (e.r - this.r) * t, this.g += (e.g - this.g) * t, this.b += (e.b - this.b) * t, this;
  },
  lerpHSL: function(e, t) {
    this.getHSL(ni), e.getHSL(Vl);
    var r = It.lerp(ni.h, Vl.h, t), n = It.lerp(ni.s, Vl.s, t), i = It.lerp(ni.l, Vl.l, t);
    return this.setHSL(r, n, i), this;
  },
  equals: function(e) {
    return e.r === this.r && e.g === this.g && e.b === this.b;
  },
  fromArray: function(e, t) {
    return t === void 0 && (t = 0), this.r = e[t], this.g = e[t + 1], this.b = e[t + 2], this;
  },
  toArray: function(e, t) {
    return e === void 0 && (e = []), t === void 0 && (t = 0), e[t] = this.r, e[t + 1] = this.g, e[t + 2] = this.b, e;
  },
  toJSON: function() {
    return this.getHex();
  }
});
nt.NAMES = xb;
function lf(e, t, r, n, i, a) {
  this.a = e, this.b = t, this.c = r, this.normal = n && n.isVector3 ? n : new re(), this.vertexNormals = Array.isArray(n) ? n : [], this.color = i && i.isColor ? i : new nt(), this.vertexColors = Array.isArray(i) ? i : [], this.materialIndex = a !== void 0 ? a : 0;
}
Object.assign(lf.prototype, {
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    this.a = e.a, this.b = e.b, this.c = e.c, this.normal.copy(e.normal), this.color.copy(e.color), this.materialIndex = e.materialIndex;
    for (var t = 0, r = e.vertexNormals.length; t < r; t++)
      this.vertexNormals[t] = e.vertexNormals[t].clone();
    for (var t = 0, r = e.vertexColors.length; t < r; t++)
      this.vertexColors[t] = e.vertexColors[t].clone();
    return this;
  }
});
var $A = 0;
function wt() {
  Object.defineProperty(this, "id", { value: $A++ }), this.uuid = It.generateUUID(), this.name = "", this.type = "Material", this.fog = !0, this.blending = xu, this.side = yl, this.flatShading = !1, this.vertexTangents = !1, this.vertexColors = lb, this.opacity = 1, this.transparent = !1, this.blendSrc = cb, this.blendDst = fb, this.blendEquation = ao, this.blendSrcAlpha = null, this.blendDstAlpha = null, this.blendEquationAlpha = null, this.depthFunc = gp, this.depthTest = !0, this.depthWrite = !0, this.stencilWriteMask = 255, this.stencilFunc = RA, this.stencilRef = 0, this.stencilFuncMask = 255, this.stencilFail = zh, this.stencilZFail = zh, this.stencilZPass = zh, this.stencilWrite = !1, this.clippingPlanes = null, this.clipIntersection = !1, this.clipShadows = !1, this.shadowSide = null, this.colorWrite = !0, this.precision = null, this.polygonOffset = !1, this.polygonOffsetFactor = 0, this.polygonOffsetUnits = 0, this.dithering = !1, this.alphaTest = 0, this.premultipliedAlpha = !1, this.visible = !0, this.toneMapped = !0, this.userData = {}, this.version = 0;
}
wt.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: wt,
  isMaterial: !0,
  onBeforeCompile: function() {
  },
  setValues: function(e) {
    if (e !== void 0)
      for (var t in e) {
        var r = e[t];
        if (r === void 0) {
          console.warn("THREE.Material: '" + t + "' parameter is undefined.");
          continue;
        }
        if (t === "shading") {
          console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."), this.flatShading = r === ub;
          continue;
        }
        var n = this[t];
        if (n === void 0) {
          console.warn("THREE." + this.type + ": '" + t + "' is not a property of this material.");
          continue;
        }
        n && n.isColor ? n.set(r) : n && n.isVector3 && r && r.isVector3 ? n.copy(r) : this[t] = r;
      }
  },
  toJSON: function(e) {
    var t = e === void 0 || typeof e == "string";
    t && (e = {
      textures: {},
      images: {}
    });
    var r = {
      metadata: {
        version: 4.5,
        type: "Material",
        generator: "Material.toJSON"
      }
    };
    r.uuid = this.uuid, r.type = this.type, this.name !== "" && (r.name = this.name), this.color && this.color.isColor && (r.color = this.color.getHex()), this.roughness !== void 0 && (r.roughness = this.roughness), this.metalness !== void 0 && (r.metalness = this.metalness), this.sheen && this.sheen.isColor && (r.sheen = this.sheen.getHex()), this.emissive && this.emissive.isColor && (r.emissive = this.emissive.getHex()), this.emissiveIntensity && this.emissiveIntensity !== 1 && (r.emissiveIntensity = this.emissiveIntensity), this.specular && this.specular.isColor && (r.specular = this.specular.getHex()), this.shininess !== void 0 && (r.shininess = this.shininess), this.clearcoat !== void 0 && (r.clearcoat = this.clearcoat), this.clearcoatRoughness !== void 0 && (r.clearcoatRoughness = this.clearcoatRoughness), this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture && (r.clearcoatNormalMap = this.clearcoatNormalMap.toJSON(e).uuid, r.clearcoatNormalScale = this.clearcoatNormalScale.toArray()), this.map && this.map.isTexture && (r.map = this.map.toJSON(e).uuid), this.matcap && this.matcap.isTexture && (r.matcap = this.matcap.toJSON(e).uuid), this.alphaMap && this.alphaMap.isTexture && (r.alphaMap = this.alphaMap.toJSON(e).uuid), this.lightMap && this.lightMap.isTexture && (r.lightMap = this.lightMap.toJSON(e).uuid), this.aoMap && this.aoMap.isTexture && (r.aoMap = this.aoMap.toJSON(e).uuid, r.aoMapIntensity = this.aoMapIntensity), this.bumpMap && this.bumpMap.isTexture && (r.bumpMap = this.bumpMap.toJSON(e).uuid, r.bumpScale = this.bumpScale), this.normalMap && this.normalMap.isTexture && (r.normalMap = this.normalMap.toJSON(e).uuid, r.normalMapType = this.normalMapType, r.normalScale = this.normalScale.toArray()), this.displacementMap && this.displacementMap.isTexture && (r.displacementMap = this.displacementMap.toJSON(e).uuid, r.displacementScale = this.displacementScale, r.displacementBias = this.displacementBias), this.roughnessMap && this.roughnessMap.isTexture && (r.roughnessMap = this.roughnessMap.toJSON(e).uuid), this.metalnessMap && this.metalnessMap.isTexture && (r.metalnessMap = this.metalnessMap.toJSON(e).uuid), this.emissiveMap && this.emissiveMap.isTexture && (r.emissiveMap = this.emissiveMap.toJSON(e).uuid), this.specularMap && this.specularMap.isTexture && (r.specularMap = this.specularMap.toJSON(e).uuid), this.envMap && this.envMap.isTexture && (r.envMap = this.envMap.toJSON(e).uuid, r.reflectivity = this.reflectivity, r.refractionRatio = this.refractionRatio, this.combine !== void 0 && (r.combine = this.combine), this.envMapIntensity !== void 0 && (r.envMapIntensity = this.envMapIntensity)), this.gradientMap && this.gradientMap.isTexture && (r.gradientMap = this.gradientMap.toJSON(e).uuid), this.size !== void 0 && (r.size = this.size), this.sizeAttenuation !== void 0 && (r.sizeAttenuation = this.sizeAttenuation), this.blending !== xu && (r.blending = this.blending), this.flatShading === !0 && (r.flatShading = this.flatShading), this.side !== yl && (r.side = this.side), this.vertexColors !== lb && (r.vertexColors = this.vertexColors), this.opacity < 1 && (r.opacity = this.opacity), this.transparent === !0 && (r.transparent = this.transparent), r.depthFunc = this.depthFunc, r.depthTest = this.depthTest, r.depthWrite = this.depthWrite, r.stencilWrite = this.stencilWrite, r.stencilWriteMask = this.stencilWriteMask, r.stencilFunc = this.stencilFunc, r.stencilRef = this.stencilRef, r.stencilFuncMask = this.stencilFuncMask, r.stencilFail = this.stencilFail, r.stencilZFail = this.stencilZFail, r.stencilZPass = this.stencilZPass, this.rotation && this.rotation !== 0 && (r.rotation = this.rotation), this.polygonOffset === !0 && (r.polygonOffset = !0), this.polygonOffsetFactor !== 0 && (r.polygonOffsetFactor = this.polygonOffsetFactor), this.polygonOffsetUnits !== 0 && (r.polygonOffsetUnits = this.polygonOffsetUnits), this.linewidth && this.linewidth !== 1 && (r.linewidth = this.linewidth), this.dashSize !== void 0 && (r.dashSize = this.dashSize), this.gapSize !== void 0 && (r.gapSize = this.gapSize), this.scale !== void 0 && (r.scale = this.scale), this.dithering === !0 && (r.dithering = !0), this.alphaTest > 0 && (r.alphaTest = this.alphaTest), this.premultipliedAlpha === !0 && (r.premultipliedAlpha = this.premultipliedAlpha), this.wireframe === !0 && (r.wireframe = this.wireframe), this.wireframeLinewidth > 1 && (r.wireframeLinewidth = this.wireframeLinewidth), this.wireframeLinecap !== "round" && (r.wireframeLinecap = this.wireframeLinecap), this.wireframeLinejoin !== "round" && (r.wireframeLinejoin = this.wireframeLinejoin), this.morphTargets === !0 && (r.morphTargets = !0), this.morphNormals === !0 && (r.morphNormals = !0), this.skinning === !0 && (r.skinning = !0), this.visible === !1 && (r.visible = !1), this.toneMapped === !1 && (r.toneMapped = !1), JSON.stringify(this.userData) !== "{}" && (r.userData = this.userData);
    function n(s) {
      var o = [];
      for (var u in s) {
        var l = s[u];
        delete l.metadata, o.push(l);
      }
      return o;
    }
    if (t) {
      var i = n(e.textures), a = n(e.images);
      i.length > 0 && (r.textures = i), a.length > 0 && (r.images = a);
    }
    return r;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    this.name = e.name, this.fog = e.fog, this.blending = e.blending, this.side = e.side, this.flatShading = e.flatShading, this.vertexTangents = e.vertexTangents, this.vertexColors = e.vertexColors, this.opacity = e.opacity, this.transparent = e.transparent, this.blendSrc = e.blendSrc, this.blendDst = e.blendDst, this.blendEquation = e.blendEquation, this.blendSrcAlpha = e.blendSrcAlpha, this.blendDstAlpha = e.blendDstAlpha, this.blendEquationAlpha = e.blendEquationAlpha, this.depthFunc = e.depthFunc, this.depthTest = e.depthTest, this.depthWrite = e.depthWrite, this.stencilWriteMask = e.stencilWriteMask, this.stencilFunc = e.stencilFunc, this.stencilRef = e.stencilRef, this.stencilFuncMask = e.stencilFuncMask, this.stencilFail = e.stencilFail, this.stencilZFail = e.stencilZFail, this.stencilZPass = e.stencilZPass, this.stencilWrite = e.stencilWrite;
    var t = e.clippingPlanes, r = null;
    if (t !== null) {
      var n = t.length;
      r = new Array(n);
      for (var i = 0; i !== n; ++i)
        r[i] = t[i].clone();
    }
    return this.clippingPlanes = r, this.clipIntersection = e.clipIntersection, this.clipShadows = e.clipShadows, this.shadowSide = e.shadowSide, this.colorWrite = e.colorWrite, this.precision = e.precision, this.polygonOffset = e.polygonOffset, this.polygonOffsetFactor = e.polygonOffsetFactor, this.polygonOffsetUnits = e.polygonOffsetUnits, this.dithering = e.dithering, this.alphaTest = e.alphaTest, this.premultipliedAlpha = e.premultipliedAlpha, this.visible = e.visible, this.toneMapped = e.toneMapped, this.userData = JSON.parse(JSON.stringify(e.userData)), this;
  },
  dispose: function() {
    this.dispatchEvent({ type: "dispose" });
  }
});
Object.defineProperty(wt.prototype, "needsUpdate", {
  set: function(e) {
    e === !0 && this.version++;
  }
});
function fi(e) {
  wt.call(this), this.type = "MeshBasicMaterial", this.color = new nt(16777215), this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = ih, this.reflectivity = 1, this.refractionRatio = 0.98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.setValues(e);
}
fi.prototype = Object.create(wt.prototype);
fi.prototype.constructor = fi;
fi.prototype.isMeshBasicMaterial = !0;
fi.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.map = e.map, this.lightMap = e.lightMap, this.lightMapIntensity = e.lightMapIntensity, this.aoMap = e.aoMap, this.aoMapIntensity = e.aoMapIntensity, this.specularMap = e.specularMap, this.alphaMap = e.alphaMap, this.envMap = e.envMap, this.combine = e.combine, this.reflectivity = e.reflectivity, this.refractionRatio = e.refractionRatio, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.wireframeLinecap = e.wireframeLinecap, this.wireframeLinejoin = e.wireframeLinejoin, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this;
};
var tr = new re();
function Et(e, t, r) {
  if (Array.isArray(e))
    throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
  this.name = "", this.array = e, this.itemSize = t, this.count = e !== void 0 ? e.length / t : 0, this.normalized = r === !0, this.usage = sh, this.updateRange = { offset: 0, count: -1 }, this.version = 0;
}
Object.defineProperty(Et.prototype, "needsUpdate", {
  set: function(e) {
    e === !0 && this.version++;
  }
});
Object.assign(Et.prototype, {
  isBufferAttribute: !0,
  onUploadCallback: function() {
  },
  setUsage: function(e) {
    return this.usage = e, this;
  },
  copy: function(e) {
    return this.name = e.name, this.array = new e.array.constructor(e.array), this.itemSize = e.itemSize, this.count = e.count, this.normalized = e.normalized, this.usage = e.usage, this;
  },
  copyAt: function(e, t, r) {
    e *= this.itemSize, r *= t.itemSize;
    for (var n = 0, i = this.itemSize; n < i; n++)
      this.array[e + n] = t.array[r + n];
    return this;
  },
  copyArray: function(e) {
    return this.array.set(e), this;
  },
  copyColorsArray: function(e) {
    for (var t = this.array, r = 0, n = 0, i = e.length; n < i; n++) {
      var a = e[n];
      a === void 0 && (console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined", n), a = new nt()), t[r++] = a.r, t[r++] = a.g, t[r++] = a.b;
    }
    return this;
  },
  copyVector2sArray: function(e) {
    for (var t = this.array, r = 0, n = 0, i = e.length; n < i; n++) {
      var a = e[n];
      a === void 0 && (console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined", n), a = new _e()), t[r++] = a.x, t[r++] = a.y;
    }
    return this;
  },
  copyVector3sArray: function(e) {
    for (var t = this.array, r = 0, n = 0, i = e.length; n < i; n++) {
      var a = e[n];
      a === void 0 && (console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined", n), a = new re()), t[r++] = a.x, t[r++] = a.y, t[r++] = a.z;
    }
    return this;
  },
  copyVector4sArray: function(e) {
    for (var t = this.array, r = 0, n = 0, i = e.length; n < i; n++) {
      var a = e[n];
      a === void 0 && (console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined", n), a = new or()), t[r++] = a.x, t[r++] = a.y, t[r++] = a.z, t[r++] = a.w;
    }
    return this;
  },
  applyMatrix3: function(e) {
    for (var t = 0, r = this.count; t < r; t++)
      tr.x = this.getX(t), tr.y = this.getY(t), tr.z = this.getZ(t), tr.applyMatrix3(e), this.setXYZ(t, tr.x, tr.y, tr.z);
    return this;
  },
  applyMatrix4: function(e) {
    for (var t = 0, r = this.count; t < r; t++)
      tr.x = this.getX(t), tr.y = this.getY(t), tr.z = this.getZ(t), tr.applyMatrix4(e), this.setXYZ(t, tr.x, tr.y, tr.z);
    return this;
  },
  applyNormalMatrix: function(e) {
    for (var t = 0, r = this.count; t < r; t++)
      tr.x = this.getX(t), tr.y = this.getY(t), tr.z = this.getZ(t), tr.applyNormalMatrix(e), this.setXYZ(t, tr.x, tr.y, tr.z);
    return this;
  },
  transformDirection: function(e) {
    for (var t = 0, r = this.count; t < r; t++)
      tr.x = this.getX(t), tr.y = this.getY(t), tr.z = this.getZ(t), tr.transformDirection(e), this.setXYZ(t, tr.x, tr.y, tr.z);
    return this;
  },
  set: function(e, t) {
    return t === void 0 && (t = 0), this.array.set(e, t), this;
  },
  getX: function(e) {
    return this.array[e * this.itemSize];
  },
  setX: function(e, t) {
    return this.array[e * this.itemSize] = t, this;
  },
  getY: function(e) {
    return this.array[e * this.itemSize + 1];
  },
  setY: function(e, t) {
    return this.array[e * this.itemSize + 1] = t, this;
  },
  getZ: function(e) {
    return this.array[e * this.itemSize + 2];
  },
  setZ: function(e, t) {
    return this.array[e * this.itemSize + 2] = t, this;
  },
  getW: function(e) {
    return this.array[e * this.itemSize + 3];
  },
  setW: function(e, t) {
    return this.array[e * this.itemSize + 3] = t, this;
  },
  setXY: function(e, t, r) {
    return e *= this.itemSize, this.array[e + 0] = t, this.array[e + 1] = r, this;
  },
  setXYZ: function(e, t, r, n) {
    return e *= this.itemSize, this.array[e + 0] = t, this.array[e + 1] = r, this.array[e + 2] = n, this;
  },
  setXYZW: function(e, t, r, n, i) {
    return e *= this.itemSize, this.array[e + 0] = t, this.array[e + 1] = r, this.array[e + 2] = n, this.array[e + 3] = i, this;
  },
  onUpload: function(e) {
    return this.onUploadCallback = e, this;
  },
  clone: function() {
    return new this.constructor(this.array, this.itemSize).copy(this);
  },
  toJSON: function() {
    return {
      itemSize: this.itemSize,
      type: this.array.constructor.name,
      array: Array.prototype.slice.call(this.array),
      normalized: this.normalized
    };
  }
});
function wp(e, t, r) {
  Et.call(this, new Int8Array(e), t, r);
}
wp.prototype = Object.create(Et.prototype);
wp.prototype.constructor = wp;
function xp(e, t, r) {
  Et.call(this, new Uint8Array(e), t, r);
}
xp.prototype = Object.create(Et.prototype);
xp.prototype.constructor = xp;
function Mp(e, t, r) {
  Et.call(this, new Uint8ClampedArray(e), t, r);
}
Mp.prototype = Object.create(Et.prototype);
Mp.prototype.constructor = Mp;
function Ep(e, t, r) {
  Et.call(this, new Int16Array(e), t, r);
}
Ep.prototype = Object.create(Et.prototype);
Ep.prototype.constructor = Ep;
function Fu(e, t, r) {
  Et.call(this, new Uint16Array(e), t, r);
}
Fu.prototype = Object.create(Et.prototype);
Fu.prototype.constructor = Fu;
function Ap(e, t, r) {
  Et.call(this, new Int32Array(e), t, r);
}
Ap.prototype = Object.create(Et.prototype);
Ap.prototype.constructor = Ap;
function Iu(e, t, r) {
  Et.call(this, new Uint32Array(e), t, r);
}
Iu.prototype = Object.create(Et.prototype);
Iu.prototype.constructor = Iu;
function Qe(e, t, r) {
  Et.call(this, new Float32Array(e), t, r);
}
Qe.prototype = Object.create(Et.prototype);
Qe.prototype.constructor = Qe;
function Tp(e, t, r) {
  Et.call(this, new Float64Array(e), t, r);
}
Tp.prototype = Object.create(Et.prototype);
Tp.prototype.constructor = Tp;
function Mb() {
  this.vertices = [], this.normals = [], this.colors = [], this.uvs = [], this.uvs2 = [], this.groups = [], this.morphTargets = {}, this.skinWeights = [], this.skinIndices = [], this.boundingBox = null, this.boundingSphere = null, this.verticesNeedUpdate = !1, this.normalsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.uvsNeedUpdate = !1, this.groupsNeedUpdate = !1;
}
Object.assign(Mb.prototype, {
  computeGroups: function(e) {
    for (var t, r = [], n = void 0, i = e.faces, a = 0; a < i.length; a++) {
      var s = i[a];
      s.materialIndex !== n && (n = s.materialIndex, t !== void 0 && (t.count = a * 3 - t.start, r.push(t)), t = {
        start: a * 3,
        materialIndex: n
      });
    }
    t !== void 0 && (t.count = a * 3 - t.start, r.push(t)), this.groups = r;
  },
  fromGeometry: function(e) {
    var t = e.faces, r = e.vertices, n = e.faceVertexUvs, i = n[0] && n[0].length > 0, a = n[1] && n[1].length > 0, s = e.morphTargets, o = s.length, u;
    if (o > 0) {
      u = [];
      for (var l = 0; l < o; l++)
        u[l] = {
          name: s[l].name,
          data: []
        };
      this.morphTargets.position = u;
    }
    var c = e.morphNormals, f = c.length, h;
    if (f > 0) {
      h = [];
      for (var l = 0; l < f; l++)
        h[l] = {
          name: c[l].name,
          data: []
        };
      this.morphTargets.normal = h;
    }
    var d = e.skinIndices, g = e.skinWeights, v = d.length === r.length, m = g.length === r.length;
    r.length > 0 && t.length === 0 && console.error("THREE.DirectGeometry: Faceless geometries are not supported.");
    for (var l = 0; l < t.length; l++) {
      var p = t[l];
      this.vertices.push(r[p.a], r[p.b], r[p.c]);
      var y = p.vertexNormals;
      if (y.length === 3)
        this.normals.push(y[0], y[1], y[2]);
      else {
        var w = p.normal;
        this.normals.push(w, w, w);
      }
      var x = p.vertexColors;
      if (x.length === 3)
        this.colors.push(x[0], x[1], x[2]);
      else {
        var b = p.color;
        this.colors.push(b, b, b);
      }
      if (i === !0) {
        var M = n[0][l];
        M !== void 0 ? this.uvs.push(M[0], M[1], M[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ", l), this.uvs.push(new _e(), new _e(), new _e()));
      }
      if (a === !0) {
        var M = n[1][l];
        M !== void 0 ? this.uvs2.push(M[0], M[1], M[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ", l), this.uvs2.push(new _e(), new _e(), new _e()));
      }
      for (var k = 0; k < o; k++) {
        var E = s[k].vertices;
        u[k].data.push(E[p.a], E[p.b], E[p.c]);
      }
      for (var k = 0; k < f; k++) {
        var S = c[k].vertexNormals[l];
        h[k].data.push(S.a, S.b, S.c);
      }
      v && this.skinIndices.push(d[p.a], d[p.b], d[p.c]), m && this.skinWeights.push(g[p.a], g[p.b], g[p.c]);
    }
    return this.computeGroups(e), this.verticesNeedUpdate = e.verticesNeedUpdate, this.normalsNeedUpdate = e.normalsNeedUpdate, this.colorsNeedUpdate = e.colorsNeedUpdate, this.uvsNeedUpdate = e.uvsNeedUpdate, this.groupsNeedUpdate = e.groupsNeedUpdate, e.boundingSphere !== null && (this.boundingSphere = e.boundingSphere.clone()), e.boundingBox !== null && (this.boundingBox = e.boundingBox.clone()), this;
  }
});
function Eb(e) {
  if (e.length === 0) return -1 / 0;
  for (var t = e[0], r = 1, n = e.length; r < n; ++r)
    e[r] > t && (t = e[r]);
  return t;
}
var YA = 1, gi = new Nt(), td = new et(), qs = new re(), Dn = new Ui(), au = new Ui(), Ir = new re();
function it() {
  Object.defineProperty(this, "id", { value: YA += 2 }), this.uuid = It.generateUUID(), this.name = "", this.type = "BufferGeometry", this.index = null, this.attributes = {}, this.morphAttributes = {}, this.morphTargetsRelative = !1, this.groups = [], this.boundingBox = null, this.boundingSphere = null, this.drawRange = { start: 0, count: 1 / 0 }, this.userData = {};
}
it.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: it,
  isBufferGeometry: !0,
  getIndex: function() {
    return this.index;
  },
  setIndex: function(e) {
    Array.isArray(e) ? this.index = new (Eb(e) > 65535 ? Iu : Fu)(e, 1) : this.index = e;
  },
  getAttribute: function(e) {
    return this.attributes[e];
  },
  setAttribute: function(e, t) {
    return this.attributes[e] = t, this;
  },
  deleteAttribute: function(e) {
    return delete this.attributes[e], this;
  },
  addGroup: function(e, t, r) {
    this.groups.push({
      start: e,
      count: t,
      materialIndex: r !== void 0 ? r : 0
    });
  },
  clearGroups: function() {
    this.groups = [];
  },
  setDrawRange: function(e, t) {
    this.drawRange.start = e, this.drawRange.count = t;
  },
  applyMatrix4: function(e) {
    var t = this.attributes.position;
    t !== void 0 && (t.applyMatrix4(e), t.needsUpdate = !0);
    var r = this.attributes.normal;
    if (r !== void 0) {
      var n = new an().getNormalMatrix(e);
      r.applyNormalMatrix(n), r.needsUpdate = !0;
    }
    var i = this.attributes.tangent;
    return i !== void 0 && (i.transformDirection(e), i.needsUpdate = !0), this.boundingBox !== null && this.computeBoundingBox(), this.boundingSphere !== null && this.computeBoundingSphere(), this;
  },
  rotateX: function(e) {
    return gi.makeRotationX(e), this.applyMatrix4(gi), this;
  },
  rotateY: function(e) {
    return gi.makeRotationY(e), this.applyMatrix4(gi), this;
  },
  rotateZ: function(e) {
    return gi.makeRotationZ(e), this.applyMatrix4(gi), this;
  },
  translate: function(e, t, r) {
    return gi.makeTranslation(e, t, r), this.applyMatrix4(gi), this;
  },
  scale: function(e, t, r) {
    return gi.makeScale(e, t, r), this.applyMatrix4(gi), this;
  },
  lookAt: function(e) {
    return td.lookAt(e), td.updateMatrix(), this.applyMatrix4(td.matrix), this;
  },
  center: function() {
    return this.computeBoundingBox(), this.boundingBox.getCenter(qs).negate(), this.translate(qs.x, qs.y, qs.z), this;
  },
  setFromObject: function(e) {
    var t = e.geometry;
    if (e.isPoints || e.isLine) {
      var r = new Qe(t.vertices.length * 3, 3), n = new Qe(t.colors.length * 3, 3);
      if (this.setAttribute("position", r.copyVector3sArray(t.vertices)), this.setAttribute("color", n.copyColorsArray(t.colors)), t.lineDistances && t.lineDistances.length === t.vertices.length) {
        var i = new Qe(t.lineDistances.length, 1);
        this.setAttribute("lineDistance", i.copyArray(t.lineDistances));
      }
      t.boundingSphere !== null && (this.boundingSphere = t.boundingSphere.clone()), t.boundingBox !== null && (this.boundingBox = t.boundingBox.clone());
    } else e.isMesh && t && t.isGeometry && this.fromGeometry(t);
    return this;
  },
  setFromPoints: function(e) {
    for (var t = [], r = 0, n = e.length; r < n; r++) {
      var i = e[r];
      t.push(i.x, i.y, i.z || 0);
    }
    return this.setAttribute("position", new Qe(t, 3)), this;
  },
  updateFromObject: function(e) {
    var t = e.geometry;
    if (e.isMesh) {
      var r = t.__directGeometry;
      if (t.elementsNeedUpdate === !0 && (r = void 0, t.elementsNeedUpdate = !1), r === void 0)
        return this.fromGeometry(t);
      r.verticesNeedUpdate = t.verticesNeedUpdate, r.normalsNeedUpdate = t.normalsNeedUpdate, r.colorsNeedUpdate = t.colorsNeedUpdate, r.uvsNeedUpdate = t.uvsNeedUpdate, r.groupsNeedUpdate = t.groupsNeedUpdate, t.verticesNeedUpdate = !1, t.normalsNeedUpdate = !1, t.colorsNeedUpdate = !1, t.uvsNeedUpdate = !1, t.groupsNeedUpdate = !1, t = r;
    }
    var n;
    return t.verticesNeedUpdate === !0 && (n = this.attributes.position, n !== void 0 && (n.copyVector3sArray(t.vertices), n.needsUpdate = !0), t.verticesNeedUpdate = !1), t.normalsNeedUpdate === !0 && (n = this.attributes.normal, n !== void 0 && (n.copyVector3sArray(t.normals), n.needsUpdate = !0), t.normalsNeedUpdate = !1), t.colorsNeedUpdate === !0 && (n = this.attributes.color, n !== void 0 && (n.copyColorsArray(t.colors), n.needsUpdate = !0), t.colorsNeedUpdate = !1), t.uvsNeedUpdate && (n = this.attributes.uv, n !== void 0 && (n.copyVector2sArray(t.uvs), n.needsUpdate = !0), t.uvsNeedUpdate = !1), t.lineDistancesNeedUpdate && (n = this.attributes.lineDistance, n !== void 0 && (n.copyArray(t.lineDistances), n.needsUpdate = !0), t.lineDistancesNeedUpdate = !1), t.groupsNeedUpdate && (t.computeGroups(e.geometry), this.groups = t.groups, t.groupsNeedUpdate = !1), this;
  },
  fromGeometry: function(e) {
    return e.__directGeometry = new Mb().fromGeometry(e), this.fromDirectGeometry(e.__directGeometry);
  },
  fromDirectGeometry: function(e) {
    var t = new Float32Array(e.vertices.length * 3);
    if (this.setAttribute("position", new Et(t, 3).copyVector3sArray(e.vertices)), e.normals.length > 0) {
      var r = new Float32Array(e.normals.length * 3);
      this.setAttribute("normal", new Et(r, 3).copyVector3sArray(e.normals));
    }
    if (e.colors.length > 0) {
      var n = new Float32Array(e.colors.length * 3);
      this.setAttribute("color", new Et(n, 3).copyColorsArray(e.colors));
    }
    if (e.uvs.length > 0) {
      var i = new Float32Array(e.uvs.length * 2);
      this.setAttribute("uv", new Et(i, 2).copyVector2sArray(e.uvs));
    }
    if (e.uvs2.length > 0) {
      var a = new Float32Array(e.uvs2.length * 2);
      this.setAttribute("uv2", new Et(a, 2).copyVector2sArray(e.uvs2));
    }
    this.groups = e.groups;
    for (var s in e.morphTargets) {
      for (var o = [], u = e.morphTargets[s], l = 0, c = u.length; l < c; l++) {
        var f = u[l], h = new Qe(f.data.length * 3, 3);
        h.name = f.name, o.push(h.copyVector3sArray(f.data));
      }
      this.morphAttributes[s] = o;
    }
    if (e.skinIndices.length > 0) {
      var d = new Qe(e.skinIndices.length * 4, 4);
      this.setAttribute("skinIndex", d.copyVector4sArray(e.skinIndices));
    }
    if (e.skinWeights.length > 0) {
      var g = new Qe(e.skinWeights.length * 4, 4);
      this.setAttribute("skinWeight", g.copyVector4sArray(e.skinWeights));
    }
    return e.boundingSphere !== null && (this.boundingSphere = e.boundingSphere.clone()), e.boundingBox !== null && (this.boundingBox = e.boundingBox.clone()), this;
  },
  computeBoundingBox: function() {
    this.boundingBox === null && (this.boundingBox = new Ui());
    var e = this.attributes.position, t = this.morphAttributes.position;
    if (e !== void 0) {
      if (this.boundingBox.setFromBufferAttribute(e), t)
        for (var r = 0, n = t.length; r < n; r++) {
          var i = t[r];
          Dn.setFromBufferAttribute(i), this.morphTargetsRelative ? (Ir.addVectors(this.boundingBox.min, Dn.min), this.boundingBox.expandByPoint(Ir), Ir.addVectors(this.boundingBox.max, Dn.max), this.boundingBox.expandByPoint(Ir)) : (this.boundingBox.expandByPoint(Dn.min), this.boundingBox.expandByPoint(Dn.max));
        }
    } else
      this.boundingBox.makeEmpty();
    (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.', this);
  },
  computeBoundingSphere: function() {
    this.boundingSphere === null && (this.boundingSphere = new ja());
    var e = this.attributes.position, t = this.morphAttributes.position;
    if (e) {
      var r = this.boundingSphere.center;
      if (Dn.setFromBufferAttribute(e), t)
        for (var n = 0, i = t.length; n < i; n++) {
          var a = t[n];
          au.setFromBufferAttribute(a), this.morphTargetsRelative ? (Ir.addVectors(Dn.min, au.min), Dn.expandByPoint(Ir), Ir.addVectors(Dn.max, au.max), Dn.expandByPoint(Ir)) : (Dn.expandByPoint(au.min), Dn.expandByPoint(au.max));
        }
      Dn.getCenter(r);
      for (var s = 0, n = 0, i = e.count; n < i; n++)
        Ir.fromBufferAttribute(e, n), s = Math.max(s, r.distanceToSquared(Ir));
      if (t)
        for (var n = 0, i = t.length; n < i; n++)
          for (var a = t[n], o = this.morphTargetsRelative, u = 0, l = a.count; u < l; u++)
            Ir.fromBufferAttribute(a, u), o && (qs.fromBufferAttribute(e, u), Ir.add(qs)), s = Math.max(s, r.distanceToSquared(Ir));
      this.boundingSphere.radius = Math.sqrt(s), isNaN(this.boundingSphere.radius) && console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.', this);
    }
  },
  computeFaceNormals: function() {
  },
  computeVertexNormals: function() {
    var e = this.index, t = this.attributes;
    if (t.position) {
      var r = t.position.array;
      if (t.normal === void 0)
        this.setAttribute("normal", new Et(new Float32Array(r.length), 3));
      else
        for (var n = t.normal.array, i = 0, a = n.length; i < a; i++)
          n[i] = 0;
      var s = t.normal.array, o, u, l, c = new re(), f = new re(), h = new re(), d = new re(), g = new re();
      if (e)
        for (var v = e.array, i = 0, a = e.count; i < a; i += 3)
          o = v[i + 0] * 3, u = v[i + 1] * 3, l = v[i + 2] * 3, c.fromArray(r, o), f.fromArray(r, u), h.fromArray(r, l), d.subVectors(h, f), g.subVectors(c, f), d.cross(g), s[o] += d.x, s[o + 1] += d.y, s[o + 2] += d.z, s[u] += d.x, s[u + 1] += d.y, s[u + 2] += d.z, s[l] += d.x, s[l + 1] += d.y, s[l + 2] += d.z;
      else
        for (var i = 0, a = r.length; i < a; i += 9)
          c.fromArray(r, i), f.fromArray(r, i + 3), h.fromArray(r, i + 6), d.subVectors(h, f), g.subVectors(c, f), d.cross(g), s[i] = d.x, s[i + 1] = d.y, s[i + 2] = d.z, s[i + 3] = d.x, s[i + 4] = d.y, s[i + 5] = d.z, s[i + 6] = d.x, s[i + 7] = d.y, s[i + 8] = d.z;
      this.normalizeNormals(), t.normal.needsUpdate = !0;
    }
  },
  merge: function(e, t) {
    if (!(e && e.isBufferGeometry)) {
      console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", e);
      return;
    }
    t === void 0 && (t = 0, console.warn(
      "THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."
    ));
    var r = this.attributes;
    for (var n in r)
      if (e.attributes[n] !== void 0)
        for (var i = r[n], a = i.array, s = e.attributes[n], o = s.array, u = s.itemSize * t, l = Math.min(o.length, a.length - u), c = 0, f = u; c < l; c++, f++)
          a[f] = o[c];
    return this;
  },
  normalizeNormals: function() {
    for (var e = this.attributes.normal, t = 0, r = e.count; t < r; t++)
      Ir.x = e.getX(t), Ir.y = e.getY(t), Ir.z = e.getZ(t), Ir.normalize(), e.setXYZ(t, Ir.x, Ir.y, Ir.z);
  },
  toNonIndexed: function() {
    function e(v, m) {
      for (var p = v.array, y = v.itemSize, w = new p.constructor(m.length * y), x = 0, b = 0, M = 0, k = m.length; M < k; M++) {
        x = m[M] * y;
        for (var E = 0; E < y; E++)
          w[b++] = p[x++];
      }
      return new Et(w, y);
    }
    if (this.index === null)
      return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."), this;
    var t = new it(), r = this.index.array, n = this.attributes;
    for (var i in n) {
      var a = n[i], s = e(a, r);
      t.setAttribute(i, s);
    }
    var o = this.morphAttributes;
    for (i in o) {
      for (var u = [], l = o[i], c = 0, f = l.length; c < f; c++) {
        var a = l[c], s = e(a, r);
        u.push(s);
      }
      t.morphAttributes[i] = u;
    }
    t.morphTargetsRelative = this.morphTargetsRelative;
    for (var h = this.groups, c = 0, d = h.length; c < d; c++) {
      var g = h[c];
      t.addGroup(g.start, g.count, g.materialIndex);
    }
    return t;
  },
  toJSON: function() {
    var e = {
      metadata: {
        version: 4.5,
        type: "BufferGeometry",
        generator: "BufferGeometry.toJSON"
      }
    };
    if (e.uuid = this.uuid, e.type = this.type, this.name !== "" && (e.name = this.name), Object.keys(this.userData).length > 0 && (e.userData = this.userData), this.parameters !== void 0) {
      var t = this.parameters;
      for (var r in t)
        t[r] !== void 0 && (e[r] = t[r]);
      return e;
    }
    e.data = { attributes: {} };
    var n = this.index;
    n !== null && (e.data.index = {
      type: n.array.constructor.name,
      array: Array.prototype.slice.call(n.array)
    });
    var i = this.attributes;
    for (var r in i) {
      var a = i[r], s = a.toJSON();
      a.name !== "" && (s.name = a.name), e.data.attributes[r] = s;
    }
    var o = {}, u = !1;
    for (var r in this.morphAttributes) {
      for (var l = this.morphAttributes[r], c = [], f = 0, h = l.length; f < h; f++) {
        var a = l[f], s = a.toJSON();
        a.name !== "" && (s.name = a.name), c.push(s);
      }
      c.length > 0 && (o[r] = c, u = !0);
    }
    u && (e.data.morphAttributes = o, e.data.morphTargetsRelative = this.morphTargetsRelative);
    var d = this.groups;
    d.length > 0 && (e.data.groups = JSON.parse(JSON.stringify(d)));
    var g = this.boundingSphere;
    return g !== null && (e.data.boundingSphere = {
      center: g.center.toArray(),
      radius: g.radius
    }), e;
  },
  clone: function() {
    return new it().copy(this);
  },
  copy: function(e) {
    var t, r, n;
    this.index = null, this.attributes = {}, this.morphAttributes = {}, this.groups = [], this.boundingBox = null, this.boundingSphere = null, this.name = e.name;
    var i = e.index;
    i !== null && this.setIndex(i.clone());
    var a = e.attributes;
    for (t in a) {
      var s = a[t];
      this.setAttribute(t, s.clone());
    }
    var o = e.morphAttributes;
    for (t in o) {
      var u = [], l = o[t];
      for (r = 0, n = l.length; r < n; r++)
        u.push(l[r].clone());
      this.morphAttributes[t] = u;
    }
    this.morphTargetsRelative = e.morphTargetsRelative;
    var c = e.groups;
    for (r = 0, n = c.length; r < n; r++) {
      var f = c[r];
      this.addGroup(f.start, f.count, f.materialIndex);
    }
    var h = e.boundingBox;
    h !== null && (this.boundingBox = h.clone());
    var d = e.boundingSphere;
    return d !== null && (this.boundingSphere = d.clone()), this.drawRange.start = e.drawRange.start, this.drawRange.count = e.drawRange.count, this.userData = e.userData, this;
  },
  dispose: function() {
    this.dispatchEvent({ type: "dispose" });
  }
});
var Ag = new Nt(), Qa = new Yo(), rd = new ja(), es = new re(), ts = new re(), rs = new re(), nd = new re(), id = new re(), ad = new re(), Hl = new re(), jl = new re(), Xl = new re(), lo = new _e(), co = new _e(), fo = new _e(), Mu = new re(), ql = new re();
function Tr(e, t) {
  et.call(this), this.type = "Mesh", this.geometry = e !== void 0 ? e : new it(), this.material = t !== void 0 ? t : new fi(), this.updateMorphTargets();
}
Tr.prototype = Object.assign(Object.create(et.prototype), {
  constructor: Tr,
  isMesh: !0,
  copy: function(e) {
    return et.prototype.copy.call(this, e), e.morphTargetInfluences !== void 0 && (this.morphTargetInfluences = e.morphTargetInfluences.slice()), e.morphTargetDictionary !== void 0 && (this.morphTargetDictionary = Object.assign({}, e.morphTargetDictionary)), this;
  },
  updateMorphTargets: function() {
    var e = this.geometry, t, r, n;
    if (e.isBufferGeometry) {
      var i = e.morphAttributes, a = Object.keys(i);
      if (a.length > 0) {
        var s = i[a[0]];
        if (s !== void 0)
          for (this.morphTargetInfluences = [], this.morphTargetDictionary = {}, t = 0, r = s.length; t < r; t++)
            n = s[t].name || String(t), this.morphTargetInfluences.push(0), this.morphTargetDictionary[n] = t;
      }
    } else {
      var o = e.morphTargets;
      o !== void 0 && o.length > 0 && console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
    }
  },
  raycast: function(e, t) {
    var r = this.geometry, n = this.material, i = this.matrixWorld;
    if (n !== void 0 && (r.boundingSphere === null && r.computeBoundingSphere(), rd.copy(r.boundingSphere), rd.applyMatrix4(i), e.ray.intersectsSphere(rd) !== !1 && (Ag.getInverse(i), Qa.copy(e.ray).applyMatrix4(Ag), !(r.boundingBox !== null && Qa.intersectsBox(r.boundingBox) === !1)))) {
      var a;
      if (r.isBufferGeometry) {
        var s, o, u, l = r.index, c = r.attributes.position, f = r.morphAttributes.position, h = r.morphTargetsRelative, d = r.attributes.uv, g = r.attributes.uv2, v = r.groups, m = r.drawRange, p, y, w, x, b, M, k, E;
        if (l !== null)
          if (Array.isArray(n))
            for (p = 0, w = v.length; p < w; p++)
              for (b = v[p], M = n[b.materialIndex], k = Math.max(b.start, m.start), E = Math.min(b.start + b.count, m.start + m.count), y = k, x = E; y < x; y += 3)
                s = l.getX(y), o = l.getX(y + 1), u = l.getX(y + 2), a = $l(this, M, e, Qa, c, f, h, d, g, s, o, u), a && (a.faceIndex = Math.floor(y / 3), a.face.materialIndex = b.materialIndex, t.push(a));
          else
            for (k = Math.max(0, m.start), E = Math.min(l.count, m.start + m.count), p = k, w = E; p < w; p += 3)
              s = l.getX(p), o = l.getX(p + 1), u = l.getX(p + 2), a = $l(this, n, e, Qa, c, f, h, d, g, s, o, u), a && (a.faceIndex = Math.floor(p / 3), t.push(a));
        else if (c !== void 0)
          if (Array.isArray(n))
            for (p = 0, w = v.length; p < w; p++)
              for (b = v[p], M = n[b.materialIndex], k = Math.max(b.start, m.start), E = Math.min(b.start + b.count, m.start + m.count), y = k, x = E; y < x; y += 3)
                s = y, o = y + 1, u = y + 2, a = $l(this, M, e, Qa, c, f, h, d, g, s, o, u), a && (a.faceIndex = Math.floor(y / 3), a.face.materialIndex = b.materialIndex, t.push(a));
          else
            for (k = Math.max(0, m.start), E = Math.min(c.count, m.start + m.count), p = k, w = E; p < w; p += 3)
              s = p, o = p + 1, u = p + 2, a = $l(this, n, e, Qa, c, f, h, d, g, s, o, u), a && (a.faceIndex = Math.floor(p / 3), t.push(a));
      } else if (r.isGeometry) {
        var S, F, O, D = Array.isArray(n), _ = r.vertices, L = r.faces, G, V = r.faceVertexUvs[0];
        V.length > 0 && (G = V);
        for (var H = 0, U = L.length; H < U; H++) {
          var R = L[H], B = D ? n[R.materialIndex] : n;
          if (B !== void 0 && (S = _[R.a], F = _[R.b], O = _[R.c], a = Ab(this, B, e, Qa, S, F, O, Mu), a)) {
            if (G && G[H]) {
              var C = G[H];
              lo.copy(C[0]), co.copy(C[1]), fo.copy(C[2]), a.uv = Yr.getUV(Mu, S, F, O, lo, co, fo, new _e());
            }
            a.face = R, a.faceIndex = H, t.push(a);
          }
        }
      }
    }
  },
  clone: function() {
    return new this.constructor(this.geometry, this.material).copy(this);
  }
});
function Ab(e, t, r, n, i, a, s, o) {
  var u;
  if (t.side === Hr ? u = n.intersectTriangle(s, a, i, !0, o) : u = n.intersectTriangle(i, a, s, t.side !== nh, o), u === null) return null;
  ql.copy(o), ql.applyMatrix4(e.matrixWorld);
  var l = r.ray.origin.distanceTo(ql);
  return l < r.near || l > r.far ? null : {
    distance: l,
    point: ql.clone(),
    object: e
  };
}
function $l(e, t, r, n, i, a, s, o, u, l, c, f) {
  es.fromBufferAttribute(i, l), ts.fromBufferAttribute(i, c), rs.fromBufferAttribute(i, f);
  var h = e.morphTargetInfluences;
  if (t.morphTargets && a && h) {
    Hl.set(0, 0, 0), jl.set(0, 0, 0), Xl.set(0, 0, 0);
    for (var d = 0, g = a.length; d < g; d++) {
      var v = h[d], m = a[d];
      v !== 0 && (nd.fromBufferAttribute(m, l), id.fromBufferAttribute(m, c), ad.fromBufferAttribute(m, f), s ? (Hl.addScaledVector(nd, v), jl.addScaledVector(id, v), Xl.addScaledVector(ad, v)) : (Hl.addScaledVector(nd.sub(es), v), jl.addScaledVector(id.sub(ts), v), Xl.addScaledVector(ad.sub(rs), v)));
    }
    es.add(Hl), ts.add(jl), rs.add(Xl);
  }
  var p = Ab(e, t, r, n, es, ts, rs, Mu);
  if (p) {
    o && (lo.fromBufferAttribute(o, l), co.fromBufferAttribute(o, c), fo.fromBufferAttribute(o, f), p.uv = Yr.getUV(Mu, es, ts, rs, lo, co, fo, new _e())), u && (lo.fromBufferAttribute(u, l), co.fromBufferAttribute(u, c), fo.fromBufferAttribute(u, f), p.uv2 = Yr.getUV(Mu, es, ts, rs, lo, co, fo, new _e()));
    var y = new lf(l, c, f);
    Yr.getNormal(es, ts, rs, y.normal), p.face = y;
  }
  return p;
}
var KA = 0, yi = new Nt(), sd = new et(), Yl = new re();
function At() {
  Object.defineProperty(this, "id", { value: KA += 2 }), this.uuid = It.generateUUID(), this.name = "", this.type = "Geometry", this.vertices = [], this.colors = [], this.faces = [], this.faceVertexUvs = [[]], this.morphTargets = [], this.morphNormals = [], this.skinWeights = [], this.skinIndices = [], this.lineDistances = [], this.boundingBox = null, this.boundingSphere = null, this.elementsNeedUpdate = !1, this.verticesNeedUpdate = !1, this.uvsNeedUpdate = !1, this.normalsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.lineDistancesNeedUpdate = !1, this.groupsNeedUpdate = !1;
}
At.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: At,
  isGeometry: !0,
  applyMatrix4: function(e) {
    for (var t = new an().getNormalMatrix(e), r = 0, n = this.vertices.length; r < n; r++) {
      var i = this.vertices[r];
      i.applyMatrix4(e);
    }
    for (var r = 0, n = this.faces.length; r < n; r++) {
      var a = this.faces[r];
      a.normal.applyMatrix3(t).normalize();
      for (var s = 0, o = a.vertexNormals.length; s < o; s++)
        a.vertexNormals[s].applyMatrix3(t).normalize();
    }
    return this.boundingBox !== null && this.computeBoundingBox(), this.boundingSphere !== null && this.computeBoundingSphere(), this.verticesNeedUpdate = !0, this.normalsNeedUpdate = !0, this;
  },
  rotateX: function(e) {
    return yi.makeRotationX(e), this.applyMatrix4(yi), this;
  },
  rotateY: function(e) {
    return yi.makeRotationY(e), this.applyMatrix4(yi), this;
  },
  rotateZ: function(e) {
    return yi.makeRotationZ(e), this.applyMatrix4(yi), this;
  },
  translate: function(e, t, r) {
    return yi.makeTranslation(e, t, r), this.applyMatrix4(yi), this;
  },
  scale: function(e, t, r) {
    return yi.makeScale(e, t, r), this.applyMatrix4(yi), this;
  },
  lookAt: function(e) {
    return sd.lookAt(e), sd.updateMatrix(), this.applyMatrix4(sd.matrix), this;
  },
  fromBufferGeometry: function(e) {
    var t = this, r = e.index !== null ? e.index.array : void 0, n = e.attributes;
    if (n.position === void 0)
      return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."), this;
    var i = n.position.array, a = n.normal !== void 0 ? n.normal.array : void 0, s = n.color !== void 0 ? n.color.array : void 0, o = n.uv !== void 0 ? n.uv.array : void 0, u = n.uv2 !== void 0 ? n.uv2.array : void 0;
    u !== void 0 && (this.faceVertexUvs[1] = []);
    for (var l = 0; l < i.length; l += 3)
      t.vertices.push(new re().fromArray(i, l)), s !== void 0 && t.colors.push(new nt().fromArray(s, l));
    function c(p, y, w, x) {
      var b = s === void 0 ? [] : [
        t.colors[p].clone(),
        t.colors[y].clone(),
        t.colors[w].clone()
      ], M = a === void 0 ? [] : [
        new re().fromArray(a, p * 3),
        new re().fromArray(a, y * 3),
        new re().fromArray(a, w * 3)
      ], k = new lf(p, y, w, M, b, x);
      t.faces.push(k), o !== void 0 && t.faceVertexUvs[0].push([
        new _e().fromArray(o, p * 2),
        new _e().fromArray(o, y * 2),
        new _e().fromArray(o, w * 2)
      ]), u !== void 0 && t.faceVertexUvs[1].push([
        new _e().fromArray(u, p * 2),
        new _e().fromArray(u, y * 2),
        new _e().fromArray(u, w * 2)
      ]);
    }
    var f = e.groups;
    if (f.length > 0)
      for (var l = 0; l < f.length; l++)
        for (var h = f[l], d = h.start, g = h.count, v = d, m = d + g; v < m; v += 3)
          r !== void 0 ? c(r[v], r[v + 1], r[v + 2], h.materialIndex) : c(v, v + 1, v + 2, h.materialIndex);
    else if (r !== void 0)
      for (var l = 0; l < r.length; l += 3)
        c(r[l], r[l + 1], r[l + 2]);
    else
      for (var l = 0; l < i.length / 3; l += 3)
        c(l, l + 1, l + 2);
    return this.computeFaceNormals(), e.boundingBox !== null && (this.boundingBox = e.boundingBox.clone()), e.boundingSphere !== null && (this.boundingSphere = e.boundingSphere.clone()), this;
  },
  center: function() {
    return this.computeBoundingBox(), this.boundingBox.getCenter(Yl).negate(), this.translate(Yl.x, Yl.y, Yl.z), this;
  },
  normalize: function() {
    this.computeBoundingSphere();
    var e = this.boundingSphere.center, t = this.boundingSphere.radius, r = t === 0 ? 1 : 1 / t, n = new Nt();
    return n.set(
      r,
      0,
      0,
      -r * e.x,
      0,
      r,
      0,
      -r * e.y,
      0,
      0,
      r,
      -r * e.z,
      0,
      0,
      0,
      1
    ), this.applyMatrix4(n), this;
  },
  computeFaceNormals: function() {
    for (var e = new re(), t = new re(), r = 0, n = this.faces.length; r < n; r++) {
      var i = this.faces[r], a = this.vertices[i.a], s = this.vertices[i.b], o = this.vertices[i.c];
      e.subVectors(o, s), t.subVectors(a, s), e.cross(t), e.normalize(), i.normal.copy(e);
    }
  },
  computeVertexNormals: function(e) {
    e === void 0 && (e = !0);
    var t, r, n, i, a, s;
    for (s = new Array(this.vertices.length), t = 0, r = this.vertices.length; t < r; t++)
      s[t] = new re();
    if (e) {
      var o, u, l, c = new re(), f = new re();
      for (n = 0, i = this.faces.length; n < i; n++)
        a = this.faces[n], o = this.vertices[a.a], u = this.vertices[a.b], l = this.vertices[a.c], c.subVectors(l, u), f.subVectors(o, u), c.cross(f), s[a.a].add(c), s[a.b].add(c), s[a.c].add(c);
    } else
      for (this.computeFaceNormals(), n = 0, i = this.faces.length; n < i; n++)
        a = this.faces[n], s[a.a].add(a.normal), s[a.b].add(a.normal), s[a.c].add(a.normal);
    for (t = 0, r = this.vertices.length; t < r; t++)
      s[t].normalize();
    for (n = 0, i = this.faces.length; n < i; n++) {
      a = this.faces[n];
      var h = a.vertexNormals;
      h.length === 3 ? (h[0].copy(s[a.a]), h[1].copy(s[a.b]), h[2].copy(s[a.c])) : (h[0] = s[a.a].clone(), h[1] = s[a.b].clone(), h[2] = s[a.c].clone());
    }
    this.faces.length > 0 && (this.normalsNeedUpdate = !0);
  },
  computeFlatVertexNormals: function() {
    var e, t, r;
    for (this.computeFaceNormals(), e = 0, t = this.faces.length; e < t; e++) {
      r = this.faces[e];
      var n = r.vertexNormals;
      n.length === 3 ? (n[0].copy(r.normal), n[1].copy(r.normal), n[2].copy(r.normal)) : (n[0] = r.normal.clone(), n[1] = r.normal.clone(), n[2] = r.normal.clone());
    }
    this.faces.length > 0 && (this.normalsNeedUpdate = !0);
  },
  computeMorphNormals: function() {
    var e, t, r, n, i;
    for (r = 0, n = this.faces.length; r < n; r++)
      for (i = this.faces[r], i.__originalFaceNormal ? i.__originalFaceNormal.copy(i.normal) : i.__originalFaceNormal = i.normal.clone(), i.__originalVertexNormals || (i.__originalVertexNormals = []), e = 0, t = i.vertexNormals.length; e < t; e++)
        i.__originalVertexNormals[e] ? i.__originalVertexNormals[e].copy(i.vertexNormals[e]) : i.__originalVertexNormals[e] = i.vertexNormals[e].clone();
    var a = new At();
    for (a.faces = this.faces, e = 0, t = this.morphTargets.length; e < t; e++) {
      if (!this.morphNormals[e]) {
        this.morphNormals[e] = {}, this.morphNormals[e].faceNormals = [], this.morphNormals[e].vertexNormals = [];
        var s = this.morphNormals[e].faceNormals, o = this.morphNormals[e].vertexNormals, l, c;
        for (r = 0, n = this.faces.length; r < n; r++)
          l = new re(), c = { a: new re(), b: new re(), c: new re() }, s.push(l), o.push(c);
      }
      var u = this.morphNormals[e];
      a.vertices = this.morphTargets[e].vertices, a.computeFaceNormals(), a.computeVertexNormals();
      var l, c;
      for (r = 0, n = this.faces.length; r < n; r++)
        i = this.faces[r], l = u.faceNormals[r], c = u.vertexNormals[r], l.copy(i.normal), c.a.copy(i.vertexNormals[0]), c.b.copy(i.vertexNormals[1]), c.c.copy(i.vertexNormals[2]);
    }
    for (r = 0, n = this.faces.length; r < n; r++)
      i = this.faces[r], i.normal = i.__originalFaceNormal, i.vertexNormals = i.__originalVertexNormals;
  },
  computeBoundingBox: function() {
    this.boundingBox === null && (this.boundingBox = new Ui()), this.boundingBox.setFromPoints(this.vertices);
  },
  computeBoundingSphere: function() {
    this.boundingSphere === null && (this.boundingSphere = new ja()), this.boundingSphere.setFromPoints(this.vertices);
  },
  merge: function(e, t, r) {
    if (!(e && e.isGeometry)) {
      console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.", e);
      return;
    }
    var n, i = this.vertices.length, a = this.vertices, s = e.vertices, o = this.faces, u = e.faces, l = this.colors, c = e.colors;
    r === void 0 && (r = 0), t !== void 0 && (n = new an().getNormalMatrix(t));
    for (var f = 0, h = s.length; f < h; f++) {
      var d = s[f], g = d.clone();
      t !== void 0 && g.applyMatrix4(t), a.push(g);
    }
    for (var f = 0, h = c.length; f < h; f++)
      l.push(c[f].clone());
    for (f = 0, h = u.length; f < h; f++) {
      var v = u[f], m, p, y, w = v.vertexNormals, x = v.vertexColors;
      m = new lf(v.a + i, v.b + i, v.c + i), m.normal.copy(v.normal), n !== void 0 && m.normal.applyMatrix3(n).normalize();
      for (var b = 0, M = w.length; b < M; b++)
        p = w[b].clone(), n !== void 0 && p.applyMatrix3(n).normalize(), m.vertexNormals.push(p);
      m.color.copy(v.color);
      for (var b = 0, M = x.length; b < M; b++)
        y = x[b], m.vertexColors.push(y.clone());
      m.materialIndex = v.materialIndex + r, o.push(m);
    }
    for (var f = 0, h = e.faceVertexUvs.length; f < h; f++) {
      var k = e.faceVertexUvs[f];
      this.faceVertexUvs[f] === void 0 && (this.faceVertexUvs[f] = []);
      for (var b = 0, M = k.length; b < M; b++) {
        for (var E = k[b], S = [], F = 0, O = E.length; F < O; F++)
          S.push(E[F].clone());
        this.faceVertexUvs[f].push(S);
      }
    }
  },
  mergeMesh: function(e) {
    if (!(e && e.isMesh)) {
      console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.", e);
      return;
    }
    e.matrixAutoUpdate && e.updateMatrix(), this.merge(e.geometry, e.matrix);
  },
  /*
   * Checks for duplicate vertices with hashmap.
   * Duplicated vertices are removed
   * and faces' vertices are updated.
   */
  mergeVertices: function() {
    var e = {}, t = [], r = [], n, i, a = 4, s = Math.pow(10, a), o, u, l, c, f, h;
    for (o = 0, u = this.vertices.length; o < u; o++)
      n = this.vertices[o], i = Math.round(n.x * s) + "_" + Math.round(n.y * s) + "_" + Math.round(n.z * s), e[i] === void 0 ? (e[i] = o, t.push(this.vertices[o]), r[o] = t.length - 1) : r[o] = r[e[i]];
    var d = [];
    for (o = 0, u = this.faces.length; o < u; o++) {
      l = this.faces[o], l.a = r[l.a], l.b = r[l.b], l.c = r[l.c], c = [l.a, l.b, l.c];
      for (var g = 0; g < 3; g++)
        if (c[g] === c[(g + 1) % 3]) {
          d.push(o);
          break;
        }
    }
    for (o = d.length - 1; o >= 0; o--) {
      var v = d[o];
      for (this.faces.splice(v, 1), f = 0, h = this.faceVertexUvs.length; f < h; f++)
        this.faceVertexUvs[f].splice(v, 1);
    }
    var m = this.vertices.length - t.length;
    return this.vertices = t, m;
  },
  setFromPoints: function(e) {
    this.vertices = [];
    for (var t = 0, r = e.length; t < r; t++) {
      var n = e[t];
      this.vertices.push(new re(n.x, n.y, n.z || 0));
    }
    return this;
  },
  sortFacesByMaterialIndex: function() {
    for (var e = this.faces, t = e.length, r = 0; r < t; r++)
      e[r]._id = r;
    function n(l, c) {
      return l.materialIndex - c.materialIndex;
    }
    e.sort(n);
    var i = this.faceVertexUvs[0], a = this.faceVertexUvs[1], s, o;
    i && i.length === t && (s = []), a && a.length === t && (o = []);
    for (var r = 0; r < t; r++) {
      var u = e[r]._id;
      s && s.push(i[u]), o && o.push(a[u]);
    }
    s && (this.faceVertexUvs[0] = s), o && (this.faceVertexUvs[1] = o);
  },
  toJSON: function() {
    var e = {
      metadata: {
        version: 4.5,
        type: "Geometry",
        generator: "Geometry.toJSON"
      }
    };
    if (e.uuid = this.uuid, e.type = this.type, this.name !== "" && (e.name = this.name), this.parameters !== void 0) {
      var t = this.parameters;
      for (var r in t)
        t[r] !== void 0 && (e[r] = t[r]);
      return e;
    }
    for (var n = [], i = 0; i < this.vertices.length; i++) {
      var a = this.vertices[i];
      n.push(a.x, a.y, a.z);
    }
    for (var s = [], o = [], u = {}, l = [], c = {}, f = [], h = {}, i = 0; i < this.faces.length; i++) {
      var d = this.faces[i], g = !0, v = !1, m = this.faceVertexUvs[0][i] !== void 0, p = d.normal.length() > 0, y = d.vertexNormals.length > 0, w = d.color.r !== 1 || d.color.g !== 1 || d.color.b !== 1, x = d.vertexColors.length > 0, b = 0;
      if (b = S(b, 0, 0), b = S(b, 1, g), b = S(b, 2, v), b = S(b, 3, m), b = S(b, 4, p), b = S(b, 5, y), b = S(b, 6, w), b = S(b, 7, x), s.push(b), s.push(d.a, d.b, d.c), s.push(d.materialIndex), m) {
        var M = this.faceVertexUvs[0][i];
        s.push(
          D(M[0]),
          D(M[1]),
          D(M[2])
        );
      }
      if (p && s.push(F(d.normal)), y) {
        var k = d.vertexNormals;
        s.push(
          F(k[0]),
          F(k[1]),
          F(k[2])
        );
      }
      if (w && s.push(O(d.color)), x) {
        var E = d.vertexColors;
        s.push(
          O(E[0]),
          O(E[1]),
          O(E[2])
        );
      }
    }
    function S(_, L, G) {
      return G ? _ | 1 << L : _ & ~(1 << L);
    }
    function F(_) {
      var L = _.x.toString() + _.y.toString() + _.z.toString();
      return u[L] !== void 0 || (u[L] = o.length / 3, o.push(_.x, _.y, _.z)), u[L];
    }
    function O(_) {
      var L = _.r.toString() + _.g.toString() + _.b.toString();
      return c[L] !== void 0 || (c[L] = l.length, l.push(_.getHex())), c[L];
    }
    function D(_) {
      var L = _.x.toString() + _.y.toString();
      return h[L] !== void 0 || (h[L] = f.length / 2, f.push(_.x, _.y)), h[L];
    }
    return e.data = {}, e.data.vertices = n, e.data.normals = o, l.length > 0 && (e.data.colors = l), f.length > 0 && (e.data.uvs = [f]), e.data.faces = s, e;
  },
  clone: function() {
    return new At().copy(this);
  },
  copy: function(e) {
    var t, r, n, i, a, s;
    this.vertices = [], this.colors = [], this.faces = [], this.faceVertexUvs = [[]], this.morphTargets = [], this.morphNormals = [], this.skinWeights = [], this.skinIndices = [], this.lineDistances = [], this.boundingBox = null, this.boundingSphere = null, this.name = e.name;
    var o = e.vertices;
    for (t = 0, r = o.length; t < r; t++)
      this.vertices.push(o[t].clone());
    var u = e.colors;
    for (t = 0, r = u.length; t < r; t++)
      this.colors.push(u[t].clone());
    var l = e.faces;
    for (t = 0, r = l.length; t < r; t++)
      this.faces.push(l[t].clone());
    for (t = 0, r = e.faceVertexUvs.length; t < r; t++) {
      var c = e.faceVertexUvs[t];
      for (this.faceVertexUvs[t] === void 0 && (this.faceVertexUvs[t] = []), n = 0, i = c.length; n < i; n++) {
        var f = c[n], h = [];
        for (a = 0, s = f.length; a < s; a++) {
          var d = f[a];
          h.push(d.clone());
        }
        this.faceVertexUvs[t].push(h);
      }
    }
    var g = e.morphTargets;
    for (t = 0, r = g.length; t < r; t++) {
      var v = {};
      if (v.name = g[t].name, g[t].vertices !== void 0)
        for (v.vertices = [], n = 0, i = g[t].vertices.length; n < i; n++)
          v.vertices.push(g[t].vertices[n].clone());
      if (g[t].normals !== void 0)
        for (v.normals = [], n = 0, i = g[t].normals.length; n < i; n++)
          v.normals.push(g[t].normals[n].clone());
      this.morphTargets.push(v);
    }
    var m = e.morphNormals;
    for (t = 0, r = m.length; t < r; t++) {
      var p = {};
      if (m[t].vertexNormals !== void 0)
        for (p.vertexNormals = [], n = 0, i = m[t].vertexNormals.length; n < i; n++) {
          var y = m[t].vertexNormals[n], w = {};
          w.a = y.a.clone(), w.b = y.b.clone(), w.c = y.c.clone(), p.vertexNormals.push(w);
        }
      if (m[t].faceNormals !== void 0)
        for (p.faceNormals = [], n = 0, i = m[t].faceNormals.length; n < i; n++)
          p.faceNormals.push(m[t].faceNormals[n].clone());
      this.morphNormals.push(p);
    }
    var x = e.skinWeights;
    for (t = 0, r = x.length; t < r; t++)
      this.skinWeights.push(x[t].clone());
    var b = e.skinIndices;
    for (t = 0, r = b.length; t < r; t++)
      this.skinIndices.push(b[t].clone());
    var M = e.lineDistances;
    for (t = 0, r = M.length; t < r; t++)
      this.lineDistances.push(M[t]);
    var k = e.boundingBox;
    k !== null && (this.boundingBox = k.clone());
    var E = e.boundingSphere;
    return E !== null && (this.boundingSphere = E.clone()), this.elementsNeedUpdate = e.elementsNeedUpdate, this.verticesNeedUpdate = e.verticesNeedUpdate, this.uvsNeedUpdate = e.uvsNeedUpdate, this.normalsNeedUpdate = e.normalsNeedUpdate, this.colorsNeedUpdate = e.colorsNeedUpdate, this.lineDistancesNeedUpdate = e.lineDistancesNeedUpdate, this.groupsNeedUpdate = e.groupsNeedUpdate, this;
  },
  dispose: function() {
    this.dispatchEvent({ type: "dispose" });
  }
});
class ZA extends At {
  constructor(t, r, n, i, a, s) {
    super(), this.type = "BoxGeometry", this.parameters = {
      width: t,
      height: r,
      depth: n,
      widthSegments: i,
      heightSegments: a,
      depthSegments: s
    }, this.fromBufferGeometry(new oh(t, r, n, i, a, s)), this.mergeVertices();
  }
}
class oh extends it {
  constructor(t, r, n, i, a, s) {
    super(), this.type = "BoxBufferGeometry", this.parameters = {
      width: t,
      height: r,
      depth: n,
      widthSegments: i,
      heightSegments: a,
      depthSegments: s
    };
    var o = this;
    t = t || 1, r = r || 1, n = n || 1, i = Math.floor(i) || 1, a = Math.floor(a) || 1, s = Math.floor(s) || 1;
    var u = [], l = [], c = [], f = [], h = 0, d = 0;
    g("z", "y", "x", -1, -1, n, r, t, s, a, 0), g("z", "y", "x", 1, -1, n, r, -t, s, a, 1), g("x", "z", "y", 1, 1, t, n, r, i, s, 2), g("x", "z", "y", 1, -1, t, n, -r, i, s, 3), g("x", "y", "z", 1, -1, t, r, n, i, a, 4), g("x", "y", "z", -1, -1, t, r, -n, i, a, 5), this.setIndex(u), this.setAttribute("position", new Qe(l, 3)), this.setAttribute("normal", new Qe(c, 3)), this.setAttribute("uv", new Qe(f, 2));
    function g(v, m, p, y, w, x, b, M, k, E, S) {
      var F = x / k, O = b / E, D = x / 2, _ = b / 2, L = M / 2, G = k + 1, V = E + 1, H = 0, U = 0, R, B, C = new re();
      for (B = 0; B < V; B++) {
        var Z = B * O - _;
        for (R = 0; R < G; R++) {
          var W = R * F - D;
          C[v] = W * y, C[m] = Z * w, C[p] = L, l.push(C.x, C.y, C.z), C[v] = 0, C[m] = 0, C[p] = M > 0 ? 1 : -1, c.push(C.x, C.y, C.z), f.push(R / k), f.push(1 - B / E), H += 1;
        }
      }
      for (B = 0; B < E; B++)
        for (R = 0; R < k; R++) {
          var J = h + R + G * B, Q = h + R + G * (B + 1), j = h + (R + 1) + G * (B + 1), q = h + (R + 1) + G * B;
          u.push(J, Q, q), u.push(Q, j, q), U += 6;
        }
      o.addGroup(d, U, S), d += U, h += H;
    }
  }
}
function ko(e) {
  var t = {};
  for (var r in e) {
    t[r] = {};
    for (var n in e[r]) {
      var i = e[r][n];
      i && (i.isColor || i.isMatrix3 || i.isMatrix4 || i.isVector2 || i.isVector3 || i.isVector4 || i.isTexture) ? t[r][n] = i.clone() : Array.isArray(i) ? t[r][n] = i.slice() : t[r][n] = i;
    }
  }
  return t;
}
function nn(e) {
  for (var t = {}, r = 0; r < e.length; r++) {
    var n = ko(e[r]);
    for (var i in n)
      t[i] = n[i];
  }
  return t;
}
var JA = { clone: ko, merge: nn }, QA = `void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`, e4 = `void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;
function En(e) {
  wt.call(this), this.type = "ShaderMaterial", this.defines = {}, this.uniforms = {}, this.vertexShader = QA, this.fragmentShader = e4, this.linewidth = 1, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.clipping = !1, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.extensions = {
    derivatives: !1,
    // set to use derivatives
    fragDepth: !1,
    // set to use fragment depth values
    drawBuffers: !1,
    // set to use draw buffers
    shaderTextureLOD: !1
    // set to use shader texture LOD
  }, this.defaultAttributeValues = {
    color: [1, 1, 1],
    uv: [0, 0],
    uv2: [0, 0]
  }, this.index0AttributeName = void 0, this.uniformsNeedUpdate = !1, e !== void 0 && (e.attributes !== void 0 && console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."), this.setValues(e));
}
En.prototype = Object.create(wt.prototype);
En.prototype.constructor = En;
En.prototype.isShaderMaterial = !0;
En.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.fragmentShader = e.fragmentShader, this.vertexShader = e.vertexShader, this.uniforms = ko(e.uniforms), this.defines = Object.assign({}, e.defines), this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.lights = e.lights, this.clipping = e.clipping, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this.extensions = e.extensions, this;
};
En.prototype.toJSON = function(e) {
  var t = wt.prototype.toJSON.call(this, e);
  t.uniforms = {};
  for (var r in this.uniforms) {
    var n = this.uniforms[r], i = n.value;
    i && i.isTexture ? t.uniforms[r] = {
      type: "t",
      value: i.toJSON(e).uuid
    } : i && i.isColor ? t.uniforms[r] = {
      type: "c",
      value: i.getHex()
    } : i && i.isVector2 ? t.uniforms[r] = {
      type: "v2",
      value: i.toArray()
    } : i && i.isVector3 ? t.uniforms[r] = {
      type: "v3",
      value: i.toArray()
    } : i && i.isVector4 ? t.uniforms[r] = {
      type: "v4",
      value: i.toArray()
    } : i && i.isMatrix3 ? t.uniforms[r] = {
      type: "m3",
      value: i.toArray()
    } : i && i.isMatrix4 ? t.uniforms[r] = {
      type: "m4",
      value: i.toArray()
    } : t.uniforms[r] = {
      value: i
    };
  }
  Object.keys(this.defines).length > 0 && (t.defines = this.defines), t.vertexShader = this.vertexShader, t.fragmentShader = this.fragmentShader;
  var a = {};
  for (var s in this.extensions)
    this.extensions[s] === !0 && (a[s] = !0);
  return Object.keys(a).length > 0 && (t.extensions = a), t;
};
function ra() {
  et.call(this), this.type = "Camera", this.matrixWorldInverse = new Nt(), this.projectionMatrix = new Nt(), this.projectionMatrixInverse = new Nt();
}
ra.prototype = Object.assign(Object.create(et.prototype), {
  constructor: ra,
  isCamera: !0,
  copy: function(e, t) {
    return et.prototype.copy.call(this, e, t), this.matrixWorldInverse.copy(e.matrixWorldInverse), this.projectionMatrix.copy(e.projectionMatrix), this.projectionMatrixInverse.copy(e.projectionMatrixInverse), this;
  },
  getWorldDirection: function(e) {
    e === void 0 && (console.warn("THREE.Camera: .getWorldDirection() target is now required"), e = new re()), this.updateMatrixWorld(!0);
    var t = this.matrixWorld.elements;
    return e.set(-t[8], -t[9], -t[10]).normalize();
  },
  updateMatrixWorld: function(e) {
    et.prototype.updateMatrixWorld.call(this, e), this.matrixWorldInverse.getInverse(this.matrixWorld);
  },
  updateWorldMatrix: function(e, t) {
    et.prototype.updateWorldMatrix.call(this, e, t), this.matrixWorldInverse.getInverse(this.matrixWorld);
  },
  clone: function() {
    return new this.constructor().copy(this);
  }
});
function Wr(e, t, r, n) {
  ra.call(this), this.type = "PerspectiveCamera", this.fov = e !== void 0 ? e : 50, this.zoom = 1, this.near = r !== void 0 ? r : 0.1, this.far = n !== void 0 ? n : 2e3, this.focus = 10, this.aspect = t !== void 0 ? t : 1, this.view = null, this.filmGauge = 35, this.filmOffset = 0, this.updateProjectionMatrix();
}
Wr.prototype = Object.assign(Object.create(ra.prototype), {
  constructor: Wr,
  isPerspectiveCamera: !0,
  copy: function(e, t) {
    return ra.prototype.copy.call(this, e, t), this.fov = e.fov, this.zoom = e.zoom, this.near = e.near, this.far = e.far, this.focus = e.focus, this.aspect = e.aspect, this.view = e.view === null ? null : Object.assign({}, e.view), this.filmGauge = e.filmGauge, this.filmOffset = e.filmOffset, this;
  },
  /**
   * Sets the FOV by focal length in respect to the current .filmGauge.
   *
   * The default film gauge is 35, so that the focal length can be specified for
   * a 35mm (full frame) camera.
   *
   * Values for focal length and film gauge must have the same unit.
   */
  setFocalLength: function(e) {
    var t = 0.5 * this.getFilmHeight() / e;
    this.fov = It.RAD2DEG * 2 * Math.atan(t), this.updateProjectionMatrix();
  },
  /**
   * Calculates the focal length from the current .fov and .filmGauge.
   */
  getFocalLength: function() {
    var e = Math.tan(It.DEG2RAD * 0.5 * this.fov);
    return 0.5 * this.getFilmHeight() / e;
  },
  getEffectiveFOV: function() {
    return It.RAD2DEG * 2 * Math.atan(
      Math.tan(It.DEG2RAD * 0.5 * this.fov) / this.zoom
    );
  },
  getFilmWidth: function() {
    return this.filmGauge * Math.min(this.aspect, 1);
  },
  getFilmHeight: function() {
    return this.filmGauge / Math.max(this.aspect, 1);
  },
  /**
   * Sets an offset in a larger frustum. This is useful for multi-window or
   * multi-monitor/multi-machine setups.
   *
   * For example, if you have 3x2 monitors and each monitor is 1920x1080 and
   * the monitors are in grid like this
   *
   *   +---+---+---+
   *   | A | B | C |
   *   +---+---+---+
   *   | D | E | F |
   *   +---+---+---+
   *
   * then for each monitor you would call it like this
   *
   *   var w = 1920;
   *   var h = 1080;
   *   var fullWidth = w * 3;
   *   var fullHeight = h * 2;
   *
   *   --A--
   *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );
   *   --B--
   *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );
   *   --C--
   *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );
   *   --D--
   *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );
   *   --E--
   *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );
   *   --F--
   *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );
   *
   *   Note there is no reason monitors have to be the same size or in a grid.
   */
  setViewOffset: function(e, t, r, n, i, a) {
    this.aspect = e / t, this.view === null && (this.view = {
      enabled: !0,
      fullWidth: 1,
      fullHeight: 1,
      offsetX: 0,
      offsetY: 0,
      width: 1,
      height: 1
    }), this.view.enabled = !0, this.view.fullWidth = e, this.view.fullHeight = t, this.view.offsetX = r, this.view.offsetY = n, this.view.width = i, this.view.height = a, this.updateProjectionMatrix();
  },
  clearViewOffset: function() {
    this.view !== null && (this.view.enabled = !1), this.updateProjectionMatrix();
  },
  updateProjectionMatrix: function() {
    var e = this.near, t = e * Math.tan(It.DEG2RAD * 0.5 * this.fov) / this.zoom, r = 2 * t, n = this.aspect * r, i = -0.5 * n, a = this.view;
    if (this.view !== null && this.view.enabled) {
      var s = a.fullWidth, o = a.fullHeight;
      i += a.offsetX * n / s, t -= a.offsetY * r / o, n *= a.width / s, r *= a.height / o;
    }
    var u = this.filmOffset;
    u !== 0 && (i += e * u / this.getFilmWidth()), this.projectionMatrix.makePerspective(i, i + n, t, t - r, e, this.far), this.projectionMatrixInverse.getInverse(this.projectionMatrix);
  },
  toJSON: function(e) {
    var t = et.prototype.toJSON.call(this, e);
    return t.object.fov = this.fov, t.object.zoom = this.zoom, t.object.near = this.near, t.object.far = this.far, t.object.focus = this.focus, t.object.aspect = this.aspect, this.view !== null && (t.object.view = Object.assign({}, this.view)), t.object.filmGauge = this.filmGauge, t.object.filmOffset = this.filmOffset, t;
  }
});
var $s = 90, Ys = 1;
function Ru(e, t, r, n) {
  et.call(this), this.type = "CubeCamera";
  var i = new Wr($s, Ys, e, t);
  i.up.set(0, -1, 0), i.lookAt(new re(1, 0, 0)), this.add(i);
  var a = new Wr($s, Ys, e, t);
  a.up.set(0, -1, 0), a.lookAt(new re(-1, 0, 0)), this.add(a);
  var s = new Wr($s, Ys, e, t);
  s.up.set(0, 0, 1), s.lookAt(new re(0, 1, 0)), this.add(s);
  var o = new Wr($s, Ys, e, t);
  o.up.set(0, 0, -1), o.lookAt(new re(0, -1, 0)), this.add(o);
  var u = new Wr($s, Ys, e, t);
  u.up.set(0, -1, 0), u.lookAt(new re(0, 0, 1)), this.add(u);
  var l = new Wr($s, Ys, e, t);
  l.up.set(0, -1, 0), l.lookAt(new re(0, 0, -1)), this.add(l), n = n || { format: gs, magFilter: Vr, minFilter: Vr }, this.renderTarget = new Co(r, n), this.renderTarget.texture.name = "CubeCamera", this.update = function(c, f) {
    this.parent === null && this.updateMatrixWorld();
    var h = c.getRenderTarget(), d = this.renderTarget, g = d.texture.generateMipmaps;
    d.texture.generateMipmaps = !1, c.setRenderTarget(d, 0), c.render(f, i), c.setRenderTarget(d, 1), c.render(f, a), c.setRenderTarget(d, 2), c.render(f, s), c.setRenderTarget(d, 3), c.render(f, o), c.setRenderTarget(d, 4), c.render(f, u), d.texture.generateMipmaps = g, c.setRenderTarget(d, 5), c.render(f, l), c.setRenderTarget(h);
  }, this.clear = function(c, f, h, d) {
    for (var g = c.getRenderTarget(), v = this.renderTarget, m = 0; m < 6; m++)
      c.setRenderTarget(v, m), c.clear(f, h, d);
    c.setRenderTarget(g);
  };
}
Ru.prototype = Object.create(et.prototype);
Ru.prototype.constructor = Ru;
function Co(e, t, r) {
  Number.isInteger(t) && (console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"), t = r), vn.call(this, e, e, t);
}
Co.prototype = Object.create(vn.prototype);
Co.prototype.constructor = Co;
Co.prototype.isWebGLCubeRenderTarget = !0;
Co.prototype.fromEquirectangularTexture = function(e, t) {
  this.texture.type = t.type, this.texture.format = t.format, this.texture.encoding = t.encoding;
  var r = new Ra(), n = {
    uniforms: {
      tEquirect: { value: null }
    },
    vertexShader: [
      "varying vec3 vWorldDirection;",
      "vec3 transformDirection( in vec3 dir, in mat4 matrix ) {",
      "	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );",
      "}",
      "void main() {",
      "	vWorldDirection = transformDirection( position, modelMatrix );",
      "	#include <begin_vertex>",
      "	#include <project_vertex>",
      "}"
    ].join(`
`),
    fragmentShader: [
      "uniform sampler2D tEquirect;",
      "varying vec3 vWorldDirection;",
      "#define RECIPROCAL_PI 0.31830988618",
      "#define RECIPROCAL_PI2 0.15915494",
      "void main() {",
      "	vec3 direction = normalize( vWorldDirection );",
      "	vec2 sampleUV;",
      "	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;",
      "	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;",
      "	gl_FragColor = texture2D( tEquirect, sampleUV );",
      "}"
    ].join(`
`)
  }, i = new En({
    type: "CubemapFromEquirect",
    uniforms: ko(n.uniforms),
    vertexShader: n.vertexShader,
    fragmentShader: n.fragmentShader,
    side: Hr,
    blending: Pa
  });
  i.uniforms.tEquirect.value = t;
  var a = new Tr(new oh(5, 5, 5), i);
  r.add(a);
  var s = new Ru(1, 10, 1);
  return s.renderTarget = this, s.renderTarget.texture.name = "CubeCameraTexture", s.update(e, r), a.geometry.dispose(), a.material.dispose(), this;
};
function Do(e, t, r, n, i, a, s, o, u, l, c, f) {
  ur.call(this, null, a, s, o, u, l, n, i, c, f), this.image = { data: e || null, width: t || 1, height: r || 1 }, this.magFilter = u !== void 0 ? u : Or, this.minFilter = l !== void 0 ? l : Or, this.generateMipmaps = !1, this.flipY = !1, this.unpackAlignment = 1, this.needsUpdate = !0;
}
Do.prototype = Object.create(ur.prototype);
Do.prototype.constructor = Do;
Do.prototype.isDataTexture = !0;
var Ks = new ja(), Kl = new re();
function Ml(e, t, r, n, i, a) {
  this.planes = [
    e !== void 0 ? e : new wi(),
    t !== void 0 ? t : new wi(),
    r !== void 0 ? r : new wi(),
    n !== void 0 ? n : new wi(),
    i !== void 0 ? i : new wi(),
    a !== void 0 ? a : new wi()
  ];
}
Object.assign(Ml.prototype, {
  set: function(e, t, r, n, i, a) {
    var s = this.planes;
    return s[0].copy(e), s[1].copy(t), s[2].copy(r), s[3].copy(n), s[4].copy(i), s[5].copy(a), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    for (var t = this.planes, r = 0; r < 6; r++)
      t[r].copy(e.planes[r]);
    return this;
  },
  setFromProjectionMatrix: function(e) {
    var t = this.planes, r = e.elements, n = r[0], i = r[1], a = r[2], s = r[3], o = r[4], u = r[5], l = r[6], c = r[7], f = r[8], h = r[9], d = r[10], g = r[11], v = r[12], m = r[13], p = r[14], y = r[15];
    return t[0].setComponents(s - n, c - o, g - f, y - v).normalize(), t[1].setComponents(s + n, c + o, g + f, y + v).normalize(), t[2].setComponents(s + i, c + u, g + h, y + m).normalize(), t[3].setComponents(s - i, c - u, g - h, y - m).normalize(), t[4].setComponents(s - a, c - l, g - d, y - p).normalize(), t[5].setComponents(s + a, c + l, g + d, y + p).normalize(), this;
  },
  intersectsObject: function(e) {
    var t = e.geometry;
    return t.boundingSphere === null && t.computeBoundingSphere(), Ks.copy(t.boundingSphere).applyMatrix4(e.matrixWorld), this.intersectsSphere(Ks);
  },
  intersectsSprite: function(e) {
    return Ks.center.set(0, 0, 0), Ks.radius = 0.7071067811865476, Ks.applyMatrix4(e.matrixWorld), this.intersectsSphere(Ks);
  },
  intersectsSphere: function(e) {
    for (var t = this.planes, r = e.center, n = -e.radius, i = 0; i < 6; i++) {
      var a = t[i].distanceToPoint(r);
      if (a < n)
        return !1;
    }
    return !0;
  },
  intersectsBox: function(e) {
    for (var t = this.planes, r = 0; r < 6; r++) {
      var n = t[r];
      if (Kl.x = n.normal.x > 0 ? e.max.x : e.min.x, Kl.y = n.normal.y > 0 ? e.max.y : e.min.y, Kl.z = n.normal.z > 0 ? e.max.z : e.min.z, n.distanceToPoint(Kl) < 0)
        return !1;
    }
    return !0;
  },
  containsPoint: function(e) {
    for (var t = this.planes, r = 0; r < 6; r++)
      if (t[r].distanceToPoint(e) < 0)
        return !1;
    return !0;
  }
});
var Ze = {
  common: {
    diffuse: { value: new nt(15658734) },
    opacity: { value: 1 },
    map: { value: null },
    uvTransform: { value: new an() },
    uv2Transform: { value: new an() },
    alphaMap: { value: null }
  },
  specularmap: {
    specularMap: { value: null }
  },
  envmap: {
    envMap: { value: null },
    flipEnvMap: { value: -1 },
    reflectivity: { value: 1 },
    refractionRatio: { value: 0.98 },
    maxMipLevel: { value: 0 }
  },
  aomap: {
    aoMap: { value: null },
    aoMapIntensity: { value: 1 }
  },
  lightmap: {
    lightMap: { value: null },
    lightMapIntensity: { value: 1 }
  },
  emissivemap: {
    emissiveMap: { value: null }
  },
  bumpmap: {
    bumpMap: { value: null },
    bumpScale: { value: 1 }
  },
  normalmap: {
    normalMap: { value: null },
    normalScale: { value: new _e(1, 1) }
  },
  displacementmap: {
    displacementMap: { value: null },
    displacementScale: { value: 1 },
    displacementBias: { value: 0 }
  },
  roughnessmap: {
    roughnessMap: { value: null }
  },
  metalnessmap: {
    metalnessMap: { value: null }
  },
  gradientmap: {
    gradientMap: { value: null }
  },
  fog: {
    fogDensity: { value: 25e-5 },
    fogNear: { value: 1 },
    fogFar: { value: 2e3 },
    fogColor: { value: new nt(16777215) }
  },
  lights: {
    ambientLightColor: { value: [] },
    lightProbe: { value: [] },
    directionalLights: { value: [], properties: {
      direction: {},
      color: {},
      shadow: {},
      shadowBias: {},
      shadowRadius: {},
      shadowMapSize: {}
    } },
    directionalShadowMap: { value: [] },
    directionalShadowMatrix: { value: [] },
    spotLights: { value: [], properties: {
      color: {},
      position: {},
      direction: {},
      distance: {},
      coneCos: {},
      penumbraCos: {},
      decay: {},
      shadow: {},
      shadowBias: {},
      shadowRadius: {},
      shadowMapSize: {}
    } },
    spotShadowMap: { value: [] },
    spotShadowMatrix: { value: [] },
    pointLights: { value: [], properties: {
      color: {},
      position: {},
      decay: {},
      distance: {},
      shadow: {},
      shadowBias: {},
      shadowRadius: {},
      shadowMapSize: {},
      shadowCameraNear: {},
      shadowCameraFar: {}
    } },
    pointShadowMap: { value: [] },
    pointShadowMatrix: { value: [] },
    hemisphereLights: { value: [], properties: {
      direction: {},
      skyColor: {},
      groundColor: {}
    } },
    // TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src
    rectAreaLights: { value: [], properties: {
      color: {},
      position: {},
      width: {},
      height: {}
    } }
  },
  points: {
    diffuse: { value: new nt(15658734) },
    opacity: { value: 1 },
    size: { value: 1 },
    scale: { value: 1 },
    map: { value: null },
    alphaMap: { value: null },
    uvTransform: { value: new an() }
  },
  sprite: {
    diffuse: { value: new nt(15658734) },
    opacity: { value: 1 },
    center: { value: new _e(0.5, 0.5) },
    rotation: { value: 0 },
    map: { value: null },
    alphaMap: { value: null },
    uvTransform: { value: new an() }
  }
};
function Tb() {
  var e = null, t = !1, r = null;
  function n(i, a) {
    t !== !1 && (r(i, a), e.requestAnimationFrame(n));
  }
  return {
    start: function() {
      t !== !0 && r !== null && (e.requestAnimationFrame(n), t = !0);
    },
    stop: function() {
      t = !1;
    },
    setAnimationLoop: function(i) {
      r = i;
    },
    setContext: function(i) {
      e = i;
    }
  };
}
function t4(e, t) {
  var r = t.isWebGL2, n = /* @__PURE__ */ new WeakMap();
  function i(l, c) {
    var f = l.array, h = l.usage, d = e.createBuffer();
    e.bindBuffer(c, d), e.bufferData(c, f, h), l.onUploadCallback();
    var g = 5126;
    return f instanceof Float32Array ? g = 5126 : f instanceof Float64Array ? console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.") : f instanceof Uint16Array ? g = 5123 : f instanceof Int16Array ? g = 5122 : f instanceof Uint32Array ? g = 5125 : f instanceof Int32Array ? g = 5124 : f instanceof Int8Array ? g = 5120 : f instanceof Uint8Array && (g = 5121), {
      buffer: d,
      type: g,
      bytesPerElement: f.BYTES_PER_ELEMENT,
      version: l.version
    };
  }
  function a(l, c, f) {
    var h = c.array, d = c.updateRange;
    e.bindBuffer(f, l), d.count === -1 ? e.bufferSubData(f, 0, h) : (r ? e.bufferSubData(
      f,
      d.offset * h.BYTES_PER_ELEMENT,
      h,
      d.offset,
      d.count
    ) : e.bufferSubData(
      f,
      d.offset * h.BYTES_PER_ELEMENT,
      h.subarray(d.offset, d.offset + d.count)
    ), d.count = -1);
  }
  function s(l) {
    return l.isInterleavedBufferAttribute && (l = l.data), n.get(l);
  }
  function o(l) {
    l.isInterleavedBufferAttribute && (l = l.data);
    var c = n.get(l);
    c && (e.deleteBuffer(c.buffer), n.delete(l));
  }
  function u(l, c) {
    l.isInterleavedBufferAttribute && (l = l.data);
    var f = n.get(l);
    f === void 0 ? n.set(l, i(l, c)) : f.version < l.version && (a(f.buffer, l, c), f.version = l.version);
  }
  return {
    get: s,
    remove: o,
    update: u
  };
}
function cf(e, t, r, n) {
  At.call(this), this.type = "PlaneGeometry", this.parameters = {
    width: e,
    height: t,
    widthSegments: r,
    heightSegments: n
  }, this.fromBufferGeometry(new _o(e, t, r, n)), this.mergeVertices();
}
cf.prototype = Object.create(At.prototype);
cf.prototype.constructor = cf;
function _o(e, t, r, n) {
  it.call(this), this.type = "PlaneBufferGeometry", this.parameters = {
    width: e,
    height: t,
    widthSegments: r,
    heightSegments: n
  }, e = e || 1, t = t || 1;
  var i = e / 2, a = t / 2, s = Math.floor(r) || 1, o = Math.floor(n) || 1, u = s + 1, l = o + 1, c = e / s, f = t / o, h, d, g = [], v = [], m = [], p = [];
  for (d = 0; d < l; d++) {
    var y = d * f - a;
    for (h = 0; h < u; h++) {
      var w = h * c - i;
      v.push(w, -y, 0), m.push(0, 0, 1), p.push(h / s), p.push(1 - d / o);
    }
  }
  for (d = 0; d < o; d++)
    for (h = 0; h < s; h++) {
      var x = h + u * d, b = h + u * (d + 1), M = h + 1 + u * (d + 1), k = h + 1 + u * d;
      g.push(x, b, k), g.push(b, M, k);
    }
  this.setIndex(g), this.setAttribute("position", new Qe(v, 3)), this.setAttribute("normal", new Qe(m, 3)), this.setAttribute("uv", new Qe(p, 2));
}
_o.prototype = Object.create(it.prototype);
_o.prototype.constructor = _o;
var r4 = `#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`, n4 = `#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`, i4 = `#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`, a4 = `#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`, s4 = `#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`, o4 = "vec3 transformed = vec3( position );", u4 = `vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`, l4 = `vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`, c4 = `#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`, f4 = `#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif`, h4 = `#if NUM_CLIPPING_PLANES > 0
	#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`, d4 = `#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	varying vec3 vViewPosition;
#endif`, p4 = `#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	vViewPosition = - mvPosition.xyz;
#endif`, v4 = `#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`, m4 = `#ifdef USE_COLOR
	varying vec3 vColor;
#endif`, g4 = `#ifdef USE_COLOR
	varying vec3 vColor;
#endif`, y4 = `#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`, b4 = `#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}`, w4 = `#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);
    } else if (face == 1.0) {
      uv = vec2(direction.x, -direction.z) / abs(direction.y);
    } else if (face == 2.0) {
      uv = direction.xy / abs(direction.z);
    } else if (face == 3.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);
    } else if (face == 4.0) {
      uv = direction.xz / abs(direction.y);
    } else {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);
    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`, x4 = `vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	transformedNormal = mat3( instanceMatrix ) * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`, M4 = `#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`, E4 = `#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`, A4 = `#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`, T4 = `#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`, S4 = "gl_FragColor = linearToOutputTexel( gl_FragColor );", k4 = `
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`, C4 = `#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`, D4 = `#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`, _4 = `#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`, P4 = `#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`, B4 = `#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`, L4 = `#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`, F4 = `#ifdef USE_FOG
	varying float fogDepth;
#endif`, I4 = `#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`, R4 = `#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`, O4 = `#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`, N4 = `#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`, U4 = `#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`, G4 = `vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif`, z4 = `uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`, W4 = `#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`, V4 = `ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`, H4 = `varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`, j4 = `BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`, X4 = `varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`, q4 = `PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = saturate( clearcoat );	material.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`, $4 = `struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`, Y4 = `
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`, K4 = `#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`, Z4 = `#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`, J4 = `#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`, Q4 = `#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`, eT = `#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`, tT = `#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`, rT = `#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`, nT = `#ifdef USE_MAP
	uniform sampler2D map;
#endif`, iT = `#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`, aT = `#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`, sT = `float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`, oT = `#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`, uT = `#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`, lT = `#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`, cT = `#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`, fT = `#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`, hT = `#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`, dT = `#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`, pT = `#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`, vT = `#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`, mT = `#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`, gT = `vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`, yT = `#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`, bT = `vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`, wT = `#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`, xT = `#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`, MT = `float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`, ET = `#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`, AT = `#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`, TT = `#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`, ST = `#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif`, kT = `float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}`, CT = `#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`, DT = `#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`, _T = `#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`, PT = `#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`, BT = `float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`, LT = `#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`, FT = `#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`, IT = `#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`, RT = `#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`, OT = `#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`, NT = `#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`, UT = `#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`, GT = `#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`, zT = `#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`, WT = `#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`, VT = `uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`, HT = `varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`, jT = `#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`, XT = `varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`, qT = `#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}`, $T = `#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}`, YT = `#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`, KT = `#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`, ZT = `uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`, JT = `varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`, QT = `uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`, eS = `uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`, tS = `uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`, rS = `#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`, nS = `uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`, iS = `#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`, aS = `#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`, sS = `#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`, oS = `#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`, uS = `#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`, lS = `#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`, cS = `#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`, fS = `#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`, hS = `#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`, dS = `#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`, pS = `#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`, vS = `uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`, mS = `uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`, gS = `uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`, yS = `#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`, bS = `uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`, wS = `uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`, Wt = {
  alphamap_fragment: r4,
  alphamap_pars_fragment: n4,
  alphatest_fragment: i4,
  aomap_fragment: a4,
  aomap_pars_fragment: s4,
  begin_vertex: o4,
  beginnormal_vertex: u4,
  bsdfs: l4,
  bumpmap_pars_fragment: c4,
  clipping_planes_fragment: f4,
  clipping_planes_pars_fragment: h4,
  clipping_planes_pars_vertex: d4,
  clipping_planes_vertex: p4,
  color_fragment: v4,
  color_pars_fragment: m4,
  color_pars_vertex: g4,
  color_vertex: y4,
  common: b4,
  cube_uv_reflection_fragment: w4,
  defaultnormal_vertex: x4,
  displacementmap_pars_vertex: M4,
  displacementmap_vertex: E4,
  emissivemap_fragment: A4,
  emissivemap_pars_fragment: T4,
  encodings_fragment: S4,
  encodings_pars_fragment: k4,
  envmap_fragment: C4,
  envmap_common_pars_fragment: D4,
  envmap_pars_fragment: _4,
  envmap_pars_vertex: P4,
  envmap_physical_pars_fragment: W4,
  envmap_vertex: B4,
  fog_vertex: L4,
  fog_pars_vertex: F4,
  fog_fragment: I4,
  fog_pars_fragment: R4,
  gradientmap_pars_fragment: O4,
  lightmap_fragment: N4,
  lightmap_pars_fragment: U4,
  lights_lambert_vertex: G4,
  lights_pars_begin: z4,
  lights_toon_fragment: V4,
  lights_toon_pars_fragment: H4,
  lights_phong_fragment: j4,
  lights_phong_pars_fragment: X4,
  lights_physical_fragment: q4,
  lights_physical_pars_fragment: $4,
  lights_fragment_begin: Y4,
  lights_fragment_maps: K4,
  lights_fragment_end: Z4,
  logdepthbuf_fragment: J4,
  logdepthbuf_pars_fragment: Q4,
  logdepthbuf_pars_vertex: eT,
  logdepthbuf_vertex: tT,
  map_fragment: rT,
  map_pars_fragment: nT,
  map_particle_fragment: iT,
  map_particle_pars_fragment: aT,
  metalnessmap_fragment: sT,
  metalnessmap_pars_fragment: oT,
  morphnormal_vertex: uT,
  morphtarget_pars_vertex: lT,
  morphtarget_vertex: cT,
  normal_fragment_begin: fT,
  normal_fragment_maps: hT,
  normalmap_pars_fragment: dT,
  clearcoat_normal_fragment_begin: pT,
  clearcoat_normal_fragment_maps: vT,
  clearcoat_normalmap_pars_fragment: mT,
  packing: gT,
  premultiplied_alpha_fragment: yT,
  project_vertex: bT,
  dithering_fragment: wT,
  dithering_pars_fragment: xT,
  roughnessmap_fragment: MT,
  roughnessmap_pars_fragment: ET,
  shadowmap_pars_fragment: AT,
  shadowmap_pars_vertex: TT,
  shadowmap_vertex: ST,
  shadowmask_pars_fragment: kT,
  skinbase_vertex: CT,
  skinning_pars_vertex: DT,
  skinning_vertex: _T,
  skinnormal_vertex: PT,
  specularmap_fragment: BT,
  specularmap_pars_fragment: LT,
  tonemapping_fragment: FT,
  tonemapping_pars_fragment: IT,
  uv_pars_fragment: RT,
  uv_pars_vertex: OT,
  uv_vertex: NT,
  uv2_pars_fragment: UT,
  uv2_pars_vertex: GT,
  uv2_vertex: zT,
  worldpos_vertex: WT,
  background_frag: VT,
  background_vert: HT,
  cube_frag: jT,
  cube_vert: XT,
  depth_frag: qT,
  depth_vert: $T,
  distanceRGBA_frag: YT,
  distanceRGBA_vert: KT,
  equirect_frag: ZT,
  equirect_vert: JT,
  linedashed_frag: QT,
  linedashed_vert: eS,
  meshbasic_frag: tS,
  meshbasic_vert: rS,
  meshlambert_frag: nS,
  meshlambert_vert: iS,
  meshmatcap_frag: aS,
  meshmatcap_vert: sS,
  meshtoon_frag: oS,
  meshtoon_vert: uS,
  meshphong_frag: lS,
  meshphong_vert: cS,
  meshphysical_frag: fS,
  meshphysical_vert: hS,
  normal_frag: dS,
  normal_vert: pS,
  points_frag: vS,
  points_vert: mS,
  shadow_frag: gS,
  shadow_vert: yS,
  sprite_frag: bS,
  sprite_vert: wS
}, Yi = {
  basic: {
    uniforms: nn([
      Ze.common,
      Ze.specularmap,
      Ze.envmap,
      Ze.aomap,
      Ze.lightmap,
      Ze.fog
    ]),
    vertexShader: Wt.meshbasic_vert,
    fragmentShader: Wt.meshbasic_frag
  },
  lambert: {
    uniforms: nn([
      Ze.common,
      Ze.specularmap,
      Ze.envmap,
      Ze.aomap,
      Ze.lightmap,
      Ze.emissivemap,
      Ze.fog,
      Ze.lights,
      {
        emissive: { value: new nt(0) }
      }
    ]),
    vertexShader: Wt.meshlambert_vert,
    fragmentShader: Wt.meshlambert_frag
  },
  phong: {
    uniforms: nn([
      Ze.common,
      Ze.specularmap,
      Ze.envmap,
      Ze.aomap,
      Ze.lightmap,
      Ze.emissivemap,
      Ze.bumpmap,
      Ze.normalmap,
      Ze.displacementmap,
      Ze.fog,
      Ze.lights,
      {
        emissive: { value: new nt(0) },
        specular: { value: new nt(1118481) },
        shininess: { value: 30 }
      }
    ]),
    vertexShader: Wt.meshphong_vert,
    fragmentShader: Wt.meshphong_frag
  },
  standard: {
    uniforms: nn([
      Ze.common,
      Ze.envmap,
      Ze.aomap,
      Ze.lightmap,
      Ze.emissivemap,
      Ze.bumpmap,
      Ze.normalmap,
      Ze.displacementmap,
      Ze.roughnessmap,
      Ze.metalnessmap,
      Ze.fog,
      Ze.lights,
      {
        emissive: { value: new nt(0) },
        roughness: { value: 0.5 },
        metalness: { value: 0.5 },
        envMapIntensity: { value: 1 }
        // temporary
      }
    ]),
    vertexShader: Wt.meshphysical_vert,
    fragmentShader: Wt.meshphysical_frag
  },
  toon: {
    uniforms: nn([
      Ze.common,
      Ze.specularmap,
      Ze.aomap,
      Ze.lightmap,
      Ze.emissivemap,
      Ze.bumpmap,
      Ze.normalmap,
      Ze.displacementmap,
      Ze.gradientmap,
      Ze.fog,
      Ze.lights,
      {
        emissive: { value: new nt(0) },
        specular: { value: new nt(1118481) },
        shininess: { value: 30 }
      }
    ]),
    vertexShader: Wt.meshtoon_vert,
    fragmentShader: Wt.meshtoon_frag
  },
  matcap: {
    uniforms: nn([
      Ze.common,
      Ze.bumpmap,
      Ze.normalmap,
      Ze.displacementmap,
      Ze.fog,
      {
        matcap: { value: null }
      }
    ]),
    vertexShader: Wt.meshmatcap_vert,
    fragmentShader: Wt.meshmatcap_frag
  },
  points: {
    uniforms: nn([
      Ze.points,
      Ze.fog
    ]),
    vertexShader: Wt.points_vert,
    fragmentShader: Wt.points_frag
  },
  dashed: {
    uniforms: nn([
      Ze.common,
      Ze.fog,
      {
        scale: { value: 1 },
        dashSize: { value: 1 },
        totalSize: { value: 2 }
      }
    ]),
    vertexShader: Wt.linedashed_vert,
    fragmentShader: Wt.linedashed_frag
  },
  depth: {
    uniforms: nn([
      Ze.common,
      Ze.displacementmap
    ]),
    vertexShader: Wt.depth_vert,
    fragmentShader: Wt.depth_frag
  },
  normal: {
    uniforms: nn([
      Ze.common,
      Ze.bumpmap,
      Ze.normalmap,
      Ze.displacementmap,
      {
        opacity: { value: 1 }
      }
    ]),
    vertexShader: Wt.normal_vert,
    fragmentShader: Wt.normal_frag
  },
  sprite: {
    uniforms: nn([
      Ze.sprite,
      Ze.fog
    ]),
    vertexShader: Wt.sprite_vert,
    fragmentShader: Wt.sprite_frag
  },
  background: {
    uniforms: {
      uvTransform: { value: new an() },
      t2D: { value: null }
    },
    vertexShader: Wt.background_vert,
    fragmentShader: Wt.background_frag
  },
  /* -------------------------------------------------------------------------
  //	Cube map shader
   ------------------------------------------------------------------------- */
  cube: {
    uniforms: nn([
      Ze.envmap,
      {
        opacity: { value: 1 }
      }
    ]),
    vertexShader: Wt.cube_vert,
    fragmentShader: Wt.cube_frag
  },
  equirect: {
    uniforms: {
      tEquirect: { value: null }
    },
    vertexShader: Wt.equirect_vert,
    fragmentShader: Wt.equirect_frag
  },
  distanceRGBA: {
    uniforms: nn([
      Ze.common,
      Ze.displacementmap,
      {
        referencePosition: { value: new re() },
        nearDistance: { value: 1 },
        farDistance: { value: 1e3 }
      }
    ]),
    vertexShader: Wt.distanceRGBA_vert,
    fragmentShader: Wt.distanceRGBA_frag
  },
  shadow: {
    uniforms: nn([
      Ze.lights,
      Ze.fog,
      {
        color: { value: new nt(0) },
        opacity: { value: 1 }
      }
    ]),
    vertexShader: Wt.shadow_vert,
    fragmentShader: Wt.shadow_frag
  }
};
Yi.physical = {
  uniforms: nn([
    Yi.standard.uniforms,
    {
      transparency: { value: 0 },
      clearcoat: { value: 0 },
      clearcoatRoughness: { value: 0 },
      sheen: { value: new nt(0) },
      clearcoatNormalScale: { value: new _e(1, 1) },
      clearcoatNormalMap: { value: null }
    }
  ]),
  vertexShader: Wt.meshphysical_vert,
  fragmentShader: Wt.meshphysical_frag
};
function xS(e, t, r, n) {
  var i = new nt(0), a = 0, s, o, u = null, l = 0, c = null;
  function f(d, g, v, m) {
    var p = g.background, y = e.xr, w = y.getSession && y.getSession();
    if (w && w.environmentBlendMode === "additive" && (p = null), p === null ? h(i, a) : p && p.isColor && (h(p, 1), m = !0), (e.autoClear || m) && e.clear(e.autoClearColor, e.autoClearDepth, e.autoClearStencil), p && (p.isCubeTexture || p.isWebGLCubeRenderTarget || p.mapping === wl)) {
      o === void 0 && (o = new Tr(
        new oh(1, 1, 1),
        new En({
          type: "BackgroundCubeMaterial",
          uniforms: ko(Yi.cube.uniforms),
          vertexShader: Yi.cube.vertexShader,
          fragmentShader: Yi.cube.fragmentShader,
          side: Hr,
          depthTest: !1,
          depthWrite: !1,
          fog: !1
        })
      ), o.geometry.deleteAttribute("normal"), o.geometry.deleteAttribute("uv"), o.onBeforeRender = function(b, M, k) {
        this.matrixWorld.copyPosition(k.matrixWorld);
      }, Object.defineProperty(o.material, "envMap", {
        get: function() {
          return this.uniforms.envMap.value;
        }
      }), r.update(o));
      var x = p.isWebGLCubeRenderTarget ? p.texture : p;
      o.material.uniforms.envMap.value = x, o.material.uniforms.flipEnvMap.value = x.isCubeTexture ? -1 : 1, (u !== p || l !== x.version || c !== e.toneMapping) && (o.material.needsUpdate = !0, u = p, l = x.version, c = e.toneMapping), d.unshift(o, o.geometry, o.material, 0, 0, null);
    } else p && p.isTexture && (s === void 0 && (s = new Tr(
      new _o(2, 2),
      new En({
        type: "BackgroundMaterial",
        uniforms: ko(Yi.background.uniforms),
        vertexShader: Yi.background.vertexShader,
        fragmentShader: Yi.background.fragmentShader,
        side: yl,
        depthTest: !1,
        depthWrite: !1,
        fog: !1
      })
    ), s.geometry.deleteAttribute("normal"), Object.defineProperty(s.material, "map", {
      get: function() {
        return this.uniforms.t2D.value;
      }
    }), r.update(s)), s.material.uniforms.t2D.value = p, p.matrixAutoUpdate === !0 && p.updateMatrix(), s.material.uniforms.uvTransform.value.copy(p.matrix), (u !== p || l !== p.version || c !== e.toneMapping) && (s.material.needsUpdate = !0, u = p, l = p.version, c = e.toneMapping), d.unshift(s, s.geometry, s.material, 0, 0, null));
  }
  function h(d, g) {
    t.buffers.color.setClear(d.r, d.g, d.b, g, n);
  }
  return {
    getClearColor: function() {
      return i;
    },
    setClearColor: function(d, g) {
      i.set(d), a = g !== void 0 ? g : 1, h(i, a);
    },
    getClearAlpha: function() {
      return a;
    },
    setClearAlpha: function(d) {
      a = d, h(i, a);
    },
    render: f
  };
}
function MS(e, t, r, n) {
  var i = n.isWebGL2, a;
  function s(l) {
    a = l;
  }
  function o(l, c) {
    e.drawArrays(a, l, c), r.update(c, a);
  }
  function u(l, c, f, h) {
    if (h !== 0) {
      var d, g;
      if (i)
        d = e, g = "drawArraysInstanced";
      else if (d = t.get("ANGLE_instanced_arrays"), g = "drawArraysInstancedANGLE", d === null) {
        console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
        return;
      }
      d[g](a, c, f, h), r.update(f, a, h);
    }
  }
  this.setMode = s, this.render = o, this.renderInstances = u;
}
function ES(e, t, r) {
  var n;
  function i() {
    if (n !== void 0) return n;
    var M = t.get("EXT_texture_filter_anisotropic");
    return M !== null ? n = e.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : n = 0, n;
  }
  function a(M) {
    if (M === "highp") {
      if (e.getShaderPrecisionFormat(35633, 36338).precision > 0 && e.getShaderPrecisionFormat(35632, 36338).precision > 0)
        return "highp";
      M = "mediump";
    }
    return M === "mediump" && e.getShaderPrecisionFormat(35633, 36337).precision > 0 && e.getShaderPrecisionFormat(35632, 36337).precision > 0 ? "mediump" : "lowp";
  }
  var s = typeof WebGL2RenderingContext != "undefined" && e instanceof WebGL2RenderingContext || typeof WebGL2ComputeRenderingContext != "undefined" && e instanceof WebGL2ComputeRenderingContext, o = r.precision !== void 0 ? r.precision : "highp", u = a(o);
  u !== o && (console.warn("THREE.WebGLRenderer:", o, "not supported, using", u, "instead."), o = u);
  var l = r.logarithmicDepthBuffer === !0, c = e.getParameter(34930), f = e.getParameter(35660), h = e.getParameter(3379), d = e.getParameter(34076), g = e.getParameter(34921), v = e.getParameter(36347), m = e.getParameter(36348), p = e.getParameter(36349), y = f > 0, w = s || !!t.get("OES_texture_float"), x = y && w, b = s ? e.getParameter(36183) : 0;
  return {
    isWebGL2: s,
    getMaxAnisotropy: i,
    getMaxPrecision: a,
    precision: o,
    logarithmicDepthBuffer: l,
    maxTextures: c,
    maxVertexTextures: f,
    maxTextureSize: h,
    maxCubemapSize: d,
    maxAttributes: g,
    maxVertexUniforms: v,
    maxVaryings: m,
    maxFragmentUniforms: p,
    vertexTextures: y,
    floatFragmentTextures: w,
    floatVertexTextures: x,
    maxSamples: b
  };
}
function AS() {
  var e = this, t = null, r = 0, n = !1, i = !1, a = new wi(), s = new an(), o = { value: null, needsUpdate: !1 };
  this.uniform = o, this.numPlanes = 0, this.numIntersection = 0, this.init = function(c, f, h) {
    var d = c.length !== 0 || f || // enable state of previous frame - the clipping code has to
    // run another frame in order to reset the state:
    r !== 0 || n;
    return n = f, t = l(c, h, 0), r = c.length, d;
  }, this.beginShadows = function() {
    i = !0, l(null);
  }, this.endShadows = function() {
    i = !1, u();
  }, this.setState = function(c, f, h, d, g, v) {
    if (!n || c === null || c.length === 0 || i && !h)
      i ? l(null) : u();
    else {
      var m = i ? 0 : r, p = m * 4, y = g.clippingState || null;
      o.value = y, y = l(c, d, p, v);
      for (var w = 0; w !== p; ++w)
        y[w] = t[w];
      g.clippingState = y, this.numIntersection = f ? this.numPlanes : 0, this.numPlanes += m;
    }
  };
  function u() {
    o.value !== t && (o.value = t, o.needsUpdate = r > 0), e.numPlanes = r, e.numIntersection = 0;
  }
  function l(c, f, h, d) {
    var g = c !== null ? c.length : 0, v = null;
    if (g !== 0) {
      if (v = o.value, d !== !0 || v === null) {
        var m = h + g * 4, p = f.matrixWorldInverse;
        s.getNormalMatrix(p), (v === null || v.length < m) && (v = new Float32Array(m));
        for (var y = 0, w = h; y !== g; ++y, w += 4)
          a.copy(c[y]).applyMatrix4(p, s), a.normal.toArray(v, w), v[w + 3] = a.constant;
      }
      o.value = v, o.needsUpdate = !0;
    }
    return e.numPlanes = g, v;
  }
}
function TS(e) {
  var t = {};
  return {
    get: function(r) {
      if (t[r] !== void 0)
        return t[r];
      var n;
      switch (r) {
        case "WEBGL_depth_texture":
          n = e.getExtension("WEBGL_depth_texture") || e.getExtension("MOZ_WEBGL_depth_texture") || e.getExtension("WEBKIT_WEBGL_depth_texture");
          break;
        case "EXT_texture_filter_anisotropic":
          n = e.getExtension("EXT_texture_filter_anisotropic") || e.getExtension("MOZ_EXT_texture_filter_anisotropic") || e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
          break;
        case "WEBGL_compressed_texture_s3tc":
          n = e.getExtension("WEBGL_compressed_texture_s3tc") || e.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
          break;
        case "WEBGL_compressed_texture_pvrtc":
          n = e.getExtension("WEBGL_compressed_texture_pvrtc") || e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
          break;
        default:
          n = e.getExtension(r);
      }
      return n === null && console.warn("THREE.WebGLRenderer: " + r + " extension not supported."), t[r] = n, n;
    }
  };
}
function SS(e, t, r) {
  var n = /* @__PURE__ */ new WeakMap(), i = /* @__PURE__ */ new WeakMap();
  function a(c) {
    var f = c.target, h = n.get(f);
    h.index !== null && t.remove(h.index);
    for (var d in h.attributes)
      t.remove(h.attributes[d]);
    f.removeEventListener("dispose", a), n.delete(f);
    var g = i.get(h);
    g && (t.remove(g), i.delete(h)), r.memory.geometries--;
  }
  function s(c, f) {
    var h = n.get(f);
    return h || (f.addEventListener("dispose", a), f.isBufferGeometry ? h = f : f.isGeometry && (f._bufferGeometry === void 0 && (f._bufferGeometry = new it().setFromObject(c)), h = f._bufferGeometry), n.set(f, h), r.memory.geometries++, h);
  }
  function o(c) {
    var f = c.index, h = c.attributes;
    f !== null && t.update(f, 34963);
    for (var d in h)
      t.update(h[d], 34962);
    var g = c.morphAttributes;
    for (var d in g)
      for (var v = g[d], m = 0, p = v.length; m < p; m++)
        t.update(v[m], 34962);
  }
  function u(c) {
    var f = [], h = c.index, d = c.attributes.position, g = 0;
    if (h !== null) {
      var v = h.array;
      g = h.version;
      for (var m = 0, p = v.length; m < p; m += 3) {
        var y = v[m + 0], w = v[m + 1], x = v[m + 2];
        f.push(y, w, w, x, x, y);
      }
    } else {
      var v = d.array;
      g = d.version;
      for (var m = 0, p = v.length / 3 - 1; m < p; m += 3) {
        var y = m + 0, w = m + 1, x = m + 2;
        f.push(y, w, w, x, x, y);
      }
    }
    var b = new (Eb(f) > 65535 ? Iu : Fu)(f, 1);
    b.version = g, t.update(b, 34963);
    var M = i.get(c);
    M && t.remove(M), i.set(c, b);
  }
  function l(c) {
    var f = i.get(c);
    if (f) {
      var h = c.index;
      h !== null && f.version < h.version && u(c);
    } else
      u(c);
    return i.get(c);
  }
  return {
    get: s,
    update: o,
    getWireframeAttribute: l
  };
}
function kS(e, t, r, n) {
  var i = n.isWebGL2, a;
  function s(h) {
    a = h;
  }
  var o, u;
  function l(h) {
    o = h.type, u = h.bytesPerElement;
  }
  function c(h, d) {
    e.drawElements(a, d, o, h * u), r.update(d, a);
  }
  function f(h, d, g, v) {
    if (v !== 0) {
      var m, p;
      if (i)
        m = e, p = "drawElementsInstanced";
      else if (m = t.get("ANGLE_instanced_arrays"), p = "drawElementsInstancedANGLE", m === null) {
        console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
        return;
      }
      m[p](a, g, o, d * u, v), r.update(g, a, v);
    }
  }
  this.setMode = s, this.setIndex = l, this.render = c, this.renderInstances = f;
}
function CS(e) {
  var t = {
    geometries: 0,
    textures: 0
  }, r = {
    frame: 0,
    calls: 0,
    triangles: 0,
    points: 0,
    lines: 0
  };
  function n(a, s, o) {
    switch (o = o || 1, r.calls++, s) {
      case 4:
        r.triangles += o * (a / 3);
        break;
      case 1:
        r.lines += o * (a / 2);
        break;
      case 3:
        r.lines += o * (a - 1);
        break;
      case 2:
        r.lines += o * a;
        break;
      case 0:
        r.points += o * a;
        break;
      default:
        console.error("THREE.WebGLInfo: Unknown draw mode:", s);
        break;
    }
  }
  function i() {
    r.frame++, r.calls = 0, r.triangles = 0, r.points = 0, r.lines = 0;
  }
  return {
    memory: t,
    render: r,
    programs: null,
    autoReset: !0,
    reset: i,
    update: n
  };
}
function DS(e, t) {
  return Math.abs(t[1]) - Math.abs(e[1]);
}
function _S(e) {
  var t = {}, r = new Float32Array(8);
  function n(i, a, s, o) {
    var u = i.morphTargetInfluences, l = u === void 0 ? 0 : u.length, c = t[a.id];
    if (c === void 0) {
      c = [];
      for (var f = 0; f < l; f++)
        c[f] = [f, 0];
      t[a.id] = c;
    }
    for (var h = s.morphTargets && a.morphAttributes.position, d = s.morphNormals && a.morphAttributes.normal, f = 0; f < l; f++) {
      var g = c[f];
      g[1] !== 0 && (h && a.deleteAttribute("morphTarget" + f), d && a.deleteAttribute("morphNormal" + f));
    }
    for (var f = 0; f < l; f++) {
      var g = c[f];
      g[0] = f, g[1] = u[f];
    }
    c.sort(DS);
    for (var v = 0, f = 0; f < 8; f++) {
      var g = c[f];
      if (g) {
        var m = g[0], p = g[1];
        if (p) {
          h && a.setAttribute("morphTarget" + f, h[m]), d && a.setAttribute("morphNormal" + f, d[m]), r[f] = p, v += p;
          continue;
        }
      }
      r[f] = 0;
    }
    var y = a.morphTargetsRelative ? 1 : 1 - v;
    o.getUniforms().setValue(e, "morphTargetBaseInfluence", y), o.getUniforms().setValue(e, "morphTargetInfluences", r);
  }
  return {
    update: n
  };
}
function PS(e, t, r, n) {
  var i = {};
  function a(o) {
    var u = n.render.frame, l = o.geometry, c = t.get(o, l);
    return i[c.id] !== u && (l.isGeometry && c.updateFromObject(o), t.update(c), i[c.id] = u), o.isInstancedMesh && r.update(o.instanceMatrix, 34962), c;
  }
  function s() {
    i = {};
  }
  return {
    update: a,
    dispose: s
  };
}
function Oa(e, t, r, n, i, a, s, o, u, l) {
  e = e !== void 0 ? e : [], t = t !== void 0 ? t : c0, s = s !== void 0 ? s : gs, ur.call(this, e, t, r, n, i, a, s, o, u, l), this.flipY = !1;
}
Oa.prototype = Object.create(ur.prototype);
Oa.prototype.constructor = Oa;
Oa.prototype.isCubeTexture = !0;
Object.defineProperty(Oa.prototype, "images", {
  get: function() {
    return this.image;
  },
  set: function(e) {
    this.image = e;
  }
});
function Ou(e, t, r, n) {
  ur.call(this, null), this.image = { data: e || null, width: t || 1, height: r || 1, depth: n || 1 }, this.magFilter = Or, this.minFilter = Or, this.wrapR = Mn, this.generateMipmaps = !1, this.flipY = !1, this.needsUpdate = !0;
}
Ou.prototype = Object.create(ur.prototype);
Ou.prototype.constructor = Ou;
Ou.prototype.isDataTexture2DArray = !0;
function Nu(e, t, r, n) {
  ur.call(this, null), this.image = { data: e || null, width: t || 1, height: r || 1, depth: n || 1 }, this.magFilter = Or, this.minFilter = Or, this.wrapR = Mn, this.generateMipmaps = !1, this.flipY = !1, this.needsUpdate = !0;
}
Nu.prototype = Object.create(ur.prototype);
Nu.prototype.constructor = Nu;
Nu.prototype.isDataTexture3D = !0;
var Sb = new ur(), BS = new Ou(), LS = new Nu(), kb = new Oa(), Tg = [], Sg = [], kg = new Float32Array(16), Cg = new Float32Array(9), Dg = new Float32Array(4);
function Ko(e, t, r) {
  var n = e[0];
  if (n <= 0 || n > 0) return e;
  var i = t * r, a = Tg[i];
  if (a === void 0 && (a = new Float32Array(i), Tg[i] = a), t !== 0) {
    n.toArray(a, 0);
    for (var s = 1, o = 0; s !== t; ++s)
      o += r, e[s].toArray(a, o);
  }
  return a;
}
function qn(e, t) {
  if (e.length !== t.length) return !1;
  for (var r = 0, n = e.length; r < n; r++)
    if (e[r] !== t[r]) return !1;
  return !0;
}
function Bn(e, t) {
  for (var r = 0, n = t.length; r < n; r++)
    e[r] = t[r];
}
function Cb(e, t) {
  var r = Sg[t];
  r === void 0 && (r = new Int32Array(t), Sg[t] = r);
  for (var n = 0; n !== t; ++n)
    r[n] = e.allocateTextureUnit();
  return r;
}
function FS(e, t) {
  var r = this.cache;
  r[0] !== t && (e.uniform1f(this.addr, t), r[0] = t);
}
function IS(e, t) {
  var r = this.cache;
  if (t.x !== void 0)
    (r[0] !== t.x || r[1] !== t.y) && (e.uniform2f(this.addr, t.x, t.y), r[0] = t.x, r[1] = t.y);
  else {
    if (qn(r, t)) return;
    e.uniform2fv(this.addr, t), Bn(r, t);
  }
}
function RS(e, t) {
  var r = this.cache;
  if (t.x !== void 0)
    (r[0] !== t.x || r[1] !== t.y || r[2] !== t.z) && (e.uniform3f(this.addr, t.x, t.y, t.z), r[0] = t.x, r[1] = t.y, r[2] = t.z);
  else if (t.r !== void 0)
    (r[0] !== t.r || r[1] !== t.g || r[2] !== t.b) && (e.uniform3f(this.addr, t.r, t.g, t.b), r[0] = t.r, r[1] = t.g, r[2] = t.b);
  else {
    if (qn(r, t)) return;
    e.uniform3fv(this.addr, t), Bn(r, t);
  }
}
function OS(e, t) {
  var r = this.cache;
  if (t.x !== void 0)
    (r[0] !== t.x || r[1] !== t.y || r[2] !== t.z || r[3] !== t.w) && (e.uniform4f(this.addr, t.x, t.y, t.z, t.w), r[0] = t.x, r[1] = t.y, r[2] = t.z, r[3] = t.w);
  else {
    if (qn(r, t)) return;
    e.uniform4fv(this.addr, t), Bn(r, t);
  }
}
function NS(e, t) {
  var r = this.cache, n = t.elements;
  if (n === void 0) {
    if (qn(r, t)) return;
    e.uniformMatrix2fv(this.addr, !1, t), Bn(r, t);
  } else {
    if (qn(r, n)) return;
    Dg.set(n), e.uniformMatrix2fv(this.addr, !1, Dg), Bn(r, n);
  }
}
function US(e, t) {
  var r = this.cache, n = t.elements;
  if (n === void 0) {
    if (qn(r, t)) return;
    e.uniformMatrix3fv(this.addr, !1, t), Bn(r, t);
  } else {
    if (qn(r, n)) return;
    Cg.set(n), e.uniformMatrix3fv(this.addr, !1, Cg), Bn(r, n);
  }
}
function GS(e, t) {
  var r = this.cache, n = t.elements;
  if (n === void 0) {
    if (qn(r, t)) return;
    e.uniformMatrix4fv(this.addr, !1, t), Bn(r, t);
  } else {
    if (qn(r, n)) return;
    kg.set(n), e.uniformMatrix4fv(this.addr, !1, kg), Bn(r, n);
  }
}
function zS(e, t, r) {
  var n = this.cache, i = r.allocateTextureUnit();
  n[0] !== i && (e.uniform1i(this.addr, i), n[0] = i), r.safeSetTexture2D(t || Sb, i);
}
function WS(e, t, r) {
  var n = this.cache, i = r.allocateTextureUnit();
  n[0] !== i && (e.uniform1i(this.addr, i), n[0] = i), r.setTexture2DArray(t || BS, i);
}
function VS(e, t, r) {
  var n = this.cache, i = r.allocateTextureUnit();
  n[0] !== i && (e.uniform1i(this.addr, i), n[0] = i), r.setTexture3D(t || LS, i);
}
function HS(e, t, r) {
  var n = this.cache, i = r.allocateTextureUnit();
  n[0] !== i && (e.uniform1i(this.addr, i), n[0] = i), r.safeSetTextureCube(t || kb, i);
}
function jS(e, t) {
  var r = this.cache;
  r[0] !== t && (e.uniform1i(this.addr, t), r[0] = t);
}
function XS(e, t) {
  var r = this.cache;
  qn(r, t) || (e.uniform2iv(this.addr, t), Bn(r, t));
}
function qS(e, t) {
  var r = this.cache;
  qn(r, t) || (e.uniform3iv(this.addr, t), Bn(r, t));
}
function $S(e, t) {
  var r = this.cache;
  qn(r, t) || (e.uniform4iv(this.addr, t), Bn(r, t));
}
function YS(e, t) {
  var r = this.cache;
  r[0] !== t && (e.uniform1ui(this.addr, t), r[0] = t);
}
function KS(e) {
  switch (e) {
    case 5126:
      return FS;
    case 35664:
      return IS;
    case 35665:
      return RS;
    case 35666:
      return OS;
    case 35674:
      return NS;
    case 35675:
      return US;
    case 35676:
      return GS;
    case 5124:
    case 35670:
      return jS;
    case 35667:
    case 35671:
      return XS;
    case 35668:
    case 35672:
      return qS;
    case 35669:
    case 35673:
      return $S;
    case 5125:
      return YS;
    case 35678:
    case 36198:
    case 36298:
    case 36306:
    case 35682:
      return zS;
    case 35679:
    case 36299:
    case 36307:
      return VS;
    case 35680:
    case 36300:
    case 36308:
    case 36293:
      return HS;
    case 36289:
    case 36303:
    case 36311:
    case 36292:
      return WS;
  }
}
function ZS(e, t) {
  e.uniform1fv(this.addr, t);
}
function JS(e, t) {
  e.uniform1iv(this.addr, t);
}
function QS(e, t) {
  e.uniform2iv(this.addr, t);
}
function e6(e, t) {
  e.uniform3iv(this.addr, t);
}
function t6(e, t) {
  e.uniform4iv(this.addr, t);
}
function r6(e, t) {
  var r = Ko(t, this.size, 2);
  e.uniform2fv(this.addr, r);
}
function n6(e, t) {
  var r = Ko(t, this.size, 3);
  e.uniform3fv(this.addr, r);
}
function i6(e, t) {
  var r = Ko(t, this.size, 4);
  e.uniform4fv(this.addr, r);
}
function a6(e, t) {
  var r = Ko(t, this.size, 4);
  e.uniformMatrix2fv(this.addr, !1, r);
}
function s6(e, t) {
  var r = Ko(t, this.size, 9);
  e.uniformMatrix3fv(this.addr, !1, r);
}
function o6(e, t) {
  var r = Ko(t, this.size, 16);
  e.uniformMatrix4fv(this.addr, !1, r);
}
function u6(e, t, r) {
  var n = t.length, i = Cb(r, n);
  e.uniform1iv(this.addr, i);
  for (var a = 0; a !== n; ++a)
    r.safeSetTexture2D(t[a] || Sb, i[a]);
}
function l6(e, t, r) {
  var n = t.length, i = Cb(r, n);
  e.uniform1iv(this.addr, i);
  for (var a = 0; a !== n; ++a)
    r.safeSetTextureCube(t[a] || kb, i[a]);
}
function c6(e) {
  switch (e) {
    case 5126:
      return ZS;
    case 35664:
      return r6;
    case 35665:
      return n6;
    case 35666:
      return i6;
    case 35674:
      return a6;
    case 35675:
      return s6;
    case 35676:
      return o6;
    case 5124:
    case 35670:
      return JS;
    case 35667:
    case 35671:
      return QS;
    case 35668:
    case 35672:
      return e6;
    case 35669:
    case 35673:
      return t6;
    case 35678:
    case 36198:
    case 36298:
    case 36306:
    case 35682:
      return u6;
    case 35680:
    case 36300:
    case 36308:
    case 36293:
      return l6;
  }
}
function f6(e, t, r) {
  this.id = e, this.addr = r, this.cache = [], this.setValue = KS(t.type);
}
function Db(e, t, r) {
  this.id = e, this.addr = r, this.cache = [], this.size = t.size, this.setValue = c6(t.type);
}
Db.prototype.updateCache = function(e) {
  var t = this.cache;
  e instanceof Float32Array && t.length !== e.length && (this.cache = new Float32Array(e.length)), Bn(t, e);
};
function _b(e) {
  this.id = e, this.seq = [], this.map = {};
}
_b.prototype.setValue = function(e, t, r) {
  for (var n = this.seq, i = 0, a = n.length; i !== a; ++i) {
    var s = n[i];
    s.setValue(e, t[s.id], r);
  }
};
var od = /([\w\d_]+)(\])?(\[|\.)?/g;
function _g(e, t) {
  e.seq.push(t), e.map[t.id] = t;
}
function h6(e, t, r) {
  var n = e.name, i = n.length;
  for (od.lastIndex = 0; ; ) {
    var a = od.exec(n), s = od.lastIndex, o = a[1], u = a[2] === "]", l = a[3];
    if (u && (o = o | 0), l === void 0 || l === "[" && s + 2 === i) {
      _g(r, l === void 0 ? new f6(o, e, t) : new Db(o, e, t));
      break;
    } else {
      var c = r.map, f = c[o];
      f === void 0 && (f = new _b(o), _g(r, f)), r = f;
    }
  }
}
function Ba(e, t) {
  this.seq = [], this.map = {};
  for (var r = e.getProgramParameter(t, 35718), n = 0; n < r; ++n) {
    var i = e.getActiveUniform(t, n), a = e.getUniformLocation(t, i.name);
    h6(i, a, this);
  }
}
Ba.prototype.setValue = function(e, t, r, n) {
  var i = this.map[t];
  i !== void 0 && i.setValue(e, r, n);
};
Ba.prototype.setOptional = function(e, t, r) {
  var n = t[r];
  n !== void 0 && this.setValue(e, r, n);
};
Ba.upload = function(e, t, r, n) {
  for (var i = 0, a = t.length; i !== a; ++i) {
    var s = t[i], o = r[s.id];
    o.needsUpdate !== !1 && s.setValue(e, o.value, n);
  }
};
Ba.seqWithValue = function(e, t) {
  for (var r = [], n = 0, i = e.length; n !== i; ++n) {
    var a = e[n];
    a.id in t && r.push(a);
  }
  return r;
};
function Pg(e, t, r) {
  var n = e.createShader(t);
  return e.shaderSource(n, r), e.compileShader(n), n;
}
var d6 = 0;
function p6(e) {
  for (var t = e.split(`
`), r = 0; r < t.length; r++)
    t[r] = r + 1 + ": " + t[r];
  return t.join(`
`);
}
function Pb(e) {
  switch (e) {
    case Pn:
      return ["Linear", "( value )"];
    case v0:
      return ["sRGB", "( value )"];
    case m0:
      return ["RGBE", "( value )"];
    case gb:
      return ["RGBM", "( value, 7.0 )"];
    case yb:
      return ["RGBM", "( value, 16.0 )"];
    case bb:
      return ["RGBD", "( value, 256.0 )"];
    case mb:
      return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];
    case BA:
      return ["LogLuv", "( value )"];
    default:
      throw new Error("unsupported encoding: " + e);
  }
}
function Bg(e, t, r) {
  var n = e.getShaderParameter(t, 35713), i = e.getShaderInfoLog(t).trim();
  if (n && i === "") return "";
  var a = e.getShaderSource(t);
  return "THREE.WebGLShader: gl.getShaderInfoLog() " + r + `
` + i + p6(a);
}
function su(e, t) {
  var r = Pb(t);
  return "vec4 " + e + "( vec4 value ) { return " + r[0] + "ToLinear" + r[1] + "; }";
}
function v6(e, t) {
  var r = Pb(t);
  return "vec4 " + e + "( vec4 value ) { return LinearTo" + r[0] + r[1] + "; }";
}
function m6(e, t) {
  var r;
  switch (t) {
    case u0:
      r = "Linear";
      break;
    case qE:
      r = "Reinhard";
      break;
    case $E:
      r = "Uncharted2";
      break;
    case YE:
      r = "OptimizedCineon";
      break;
    case KE:
      r = "ACESFilmic";
      break;
    default:
      throw new Error("unsupported toneMapping: " + t);
  }
  return "vec3 " + e + "( vec3 color ) { return " + r + "ToneMapping( color ); }";
}
function g6(e) {
  var t = [
    e.extensionDerivatives || e.envMapCubeUV || e.bumpMap || e.tangentSpaceNormalMap || e.clearcoatNormalMap || e.flatShading || e.shaderID === "physical" ? "#extension GL_OES_standard_derivatives : enable" : "",
    (e.extensionFragDepth || e.logarithmicDepthBuffer) && e.rendererExtensionFragDepth ? "#extension GL_EXT_frag_depth : enable" : "",
    e.extensionDrawBuffers && e.rendererExtensionDrawBuffers ? "#extension GL_EXT_draw_buffers : require" : "",
    (e.extensionShaderTextureLOD || e.envMap) && e.rendererExtensionShaderTextureLod ? "#extension GL_EXT_shader_texture_lod : enable" : ""
  ];
  return t.filter(vu).join(`
`);
}
function y6(e) {
  var t = [];
  for (var r in e) {
    var n = e[r];
    n !== !1 && t.push("#define " + r + " " + n);
  }
  return t.join(`
`);
}
function b6(e, t) {
  for (var r = {}, n = e.getProgramParameter(t, 35721), i = 0; i < n; i++) {
    var a = e.getActiveAttrib(t, i), s = a.name;
    r[s] = e.getAttribLocation(t, s);
  }
  return r;
}
function vu(e) {
  return e !== "";
}
function Lg(e, t) {
  return e.replace(/NUM_DIR_LIGHTS/g, t.numDirLights).replace(/NUM_SPOT_LIGHTS/g, t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g, t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g, t.numPointLights).replace(/NUM_HEMI_LIGHTS/g, t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g, t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g, t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g, t.numPointLightShadows);
}
function Fg(e, t) {
  return e.replace(/NUM_CLIPPING_PLANES/g, t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g, t.numClippingPlanes - t.numClipIntersection);
}
var w6 = /^[ \t]*#include +<([\w\d./]+)>/gm;
function Sp(e) {
  return e.replace(w6, x6);
}
function x6(e, t) {
  var r = Wt[t];
  if (r === void 0)
    throw new Error("Can not resolve #include <" + t + ">");
  return Sp(r);
}
var M6 = /#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;
function Ig(e) {
  return e.replace(M6, E6);
}
function E6(e, t, r, n) {
  for (var i = "", a = parseInt(t); a < parseInt(r); a++)
    i += n.replace(/\[ i \]/g, "[ " + a + " ]").replace(/UNROLLED_LOOP_INDEX/g, a);
  return i;
}
function Rg(e) {
  var t = "precision " + e.precision + ` float;
precision ` + e.precision + " int;";
  return e.precision === "highp" ? t += `
#define HIGH_PRECISION` : e.precision === "mediump" ? t += `
#define MEDIUM_PRECISION` : e.precision === "lowp" && (t += `
#define LOW_PRECISION`), t;
}
function A6(e) {
  var t = "SHADOWMAP_TYPE_BASIC";
  return e.shadowMapType === ob ? t = "SHADOWMAP_TYPE_PCF" : e.shadowMapType === AE ? t = "SHADOWMAP_TYPE_PCF_SOFT" : e.shadowMapType === pu && (t = "SHADOWMAP_TYPE_VSM"), t;
}
function T6(e) {
  var t = "ENVMAP_TYPE_CUBE";
  if (e.envMap)
    switch (e.envMapMode) {
      case c0:
      case f0:
        t = "ENVMAP_TYPE_CUBE";
        break;
      case wl:
      case d0:
        t = "ENVMAP_TYPE_CUBE_UV";
        break;
      case hb:
      case h0:
        t = "ENVMAP_TYPE_EQUIREC";
        break;
      case db:
        t = "ENVMAP_TYPE_SPHERE";
        break;
    }
  return t;
}
function S6(e) {
  var t = "ENVMAP_MODE_REFLECTION";
  if (e.envMap)
    switch (e.envMapMode) {
      case f0:
      case h0:
        t = "ENVMAP_MODE_REFRACTION";
        break;
    }
  return t;
}
function k6(e) {
  var t = "ENVMAP_BLENDING_NONE";
  if (e.envMap)
    switch (e.combine) {
      case ih:
        t = "ENVMAP_BLENDING_MULTIPLY";
        break;
      case jE:
        t = "ENVMAP_BLENDING_MIX";
        break;
      case XE:
        t = "ENVMAP_BLENDING_ADD";
        break;
    }
  return t;
}
function C6(e, t, r) {
  var n = e.getContext(), i = r.defines, a = r.vertexShader, s = r.fragmentShader, o = A6(r), u = T6(r), l = S6(r), c = k6(r), f = e.gammaFactor > 0 ? e.gammaFactor : 1, h = r.isWebGL2 ? "" : g6(r), d = y6(i), g = n.createProgram(), v, m, p = r.numMultiviewViews;
  if (r.isRawShaderMaterial ? (v = [
    d
  ].filter(vu).join(`
`), v.length > 0 && (v += `
`), m = [
    h,
    d
  ].filter(vu).join(`
`), m.length > 0 && (m += `
`)) : (v = [
    Rg(r),
    "#define SHADER_NAME " + r.shaderName,
    d,
    r.instancing ? "#define USE_INSTANCING" : "",
    r.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "",
    "#define GAMMA_FACTOR " + f,
    "#define MAX_BONES " + r.maxBones,
    r.useFog && r.fog ? "#define USE_FOG" : "",
    r.useFog && r.fogExp2 ? "#define FOG_EXP2" : "",
    r.map ? "#define USE_MAP" : "",
    r.envMap ? "#define USE_ENVMAP" : "",
    r.envMap ? "#define " + l : "",
    r.lightMap ? "#define USE_LIGHTMAP" : "",
    r.aoMap ? "#define USE_AOMAP" : "",
    r.emissiveMap ? "#define USE_EMISSIVEMAP" : "",
    r.bumpMap ? "#define USE_BUMPMAP" : "",
    r.normalMap ? "#define USE_NORMALMAP" : "",
    r.normalMap && r.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "",
    r.normalMap && r.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "",
    r.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "",
    r.displacementMap && r.supportsVertexTextures ? "#define USE_DISPLACEMENTMAP" : "",
    r.specularMap ? "#define USE_SPECULARMAP" : "",
    r.roughnessMap ? "#define USE_ROUGHNESSMAP" : "",
    r.metalnessMap ? "#define USE_METALNESSMAP" : "",
    r.alphaMap ? "#define USE_ALPHAMAP" : "",
    r.vertexTangents ? "#define USE_TANGENT" : "",
    r.vertexColors ? "#define USE_COLOR" : "",
    r.vertexUvs ? "#define USE_UV" : "",
    r.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "",
    r.flatShading ? "#define FLAT_SHADED" : "",
    r.skinning ? "#define USE_SKINNING" : "",
    r.useVertexTexture ? "#define BONE_TEXTURE" : "",
    r.morphTargets ? "#define USE_MORPHTARGETS" : "",
    r.morphNormals && r.flatShading === !1 ? "#define USE_MORPHNORMALS" : "",
    r.doubleSided ? "#define DOUBLE_SIDED" : "",
    r.flipSided ? "#define FLIP_SIDED" : "",
    r.shadowMapEnabled ? "#define USE_SHADOWMAP" : "",
    r.shadowMapEnabled ? "#define " + o : "",
    r.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "",
    r.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "",
    r.logarithmicDepthBuffer && r.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "",
    "uniform mat4 modelMatrix;",
    "uniform mat4 modelViewMatrix;",
    "uniform mat4 projectionMatrix;",
    "uniform mat4 viewMatrix;",
    "uniform mat3 normalMatrix;",
    "uniform vec3 cameraPosition;",
    "uniform bool isOrthographic;",
    "#ifdef USE_INSTANCING",
    " attribute mat4 instanceMatrix;",
    "#endif",
    "attribute vec3 position;",
    "attribute vec3 normal;",
    "attribute vec2 uv;",
    "#ifdef USE_TANGENT",
    "	attribute vec4 tangent;",
    "#endif",
    "#ifdef USE_COLOR",
    "	attribute vec3 color;",
    "#endif",
    "#ifdef USE_MORPHTARGETS",
    "	attribute vec3 morphTarget0;",
    "	attribute vec3 morphTarget1;",
    "	attribute vec3 morphTarget2;",
    "	attribute vec3 morphTarget3;",
    "	#ifdef USE_MORPHNORMALS",
    "		attribute vec3 morphNormal0;",
    "		attribute vec3 morphNormal1;",
    "		attribute vec3 morphNormal2;",
    "		attribute vec3 morphNormal3;",
    "	#else",
    "		attribute vec3 morphTarget4;",
    "		attribute vec3 morphTarget5;",
    "		attribute vec3 morphTarget6;",
    "		attribute vec3 morphTarget7;",
    "	#endif",
    "#endif",
    "#ifdef USE_SKINNING",
    "	attribute vec4 skinIndex;",
    "	attribute vec4 skinWeight;",
    "#endif",
    `
`
  ].filter(vu).join(`
`), m = [
    h,
    Rg(r),
    "#define SHADER_NAME " + r.shaderName,
    d,
    r.alphaTest ? "#define ALPHATEST " + r.alphaTest + (r.alphaTest % 1 ? "" : ".0") : "",
    // add '.0' if integer
    "#define GAMMA_FACTOR " + f,
    r.useFog && r.fog ? "#define USE_FOG" : "",
    r.useFog && r.fogExp2 ? "#define FOG_EXP2" : "",
    r.map ? "#define USE_MAP" : "",
    r.matcap ? "#define USE_MATCAP" : "",
    r.envMap ? "#define USE_ENVMAP" : "",
    r.envMap ? "#define " + u : "",
    r.envMap ? "#define " + l : "",
    r.envMap ? "#define " + c : "",
    r.lightMap ? "#define USE_LIGHTMAP" : "",
    r.aoMap ? "#define USE_AOMAP" : "",
    r.emissiveMap ? "#define USE_EMISSIVEMAP" : "",
    r.bumpMap ? "#define USE_BUMPMAP" : "",
    r.normalMap ? "#define USE_NORMALMAP" : "",
    r.normalMap && r.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "",
    r.normalMap && r.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "",
    r.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "",
    r.specularMap ? "#define USE_SPECULARMAP" : "",
    r.roughnessMap ? "#define USE_ROUGHNESSMAP" : "",
    r.metalnessMap ? "#define USE_METALNESSMAP" : "",
    r.alphaMap ? "#define USE_ALPHAMAP" : "",
    r.sheen ? "#define USE_SHEEN" : "",
    r.vertexTangents ? "#define USE_TANGENT" : "",
    r.vertexColors ? "#define USE_COLOR" : "",
    r.vertexUvs ? "#define USE_UV" : "",
    r.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "",
    r.gradientMap ? "#define USE_GRADIENTMAP" : "",
    r.flatShading ? "#define FLAT_SHADED" : "",
    r.doubleSided ? "#define DOUBLE_SIDED" : "",
    r.flipSided ? "#define FLIP_SIDED" : "",
    r.shadowMapEnabled ? "#define USE_SHADOWMAP" : "",
    r.shadowMapEnabled ? "#define " + o : "",
    r.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "",
    r.physicallyCorrectLights ? "#define PHYSICALLY_CORRECT_LIGHTS" : "",
    r.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "",
    r.logarithmicDepthBuffer && r.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "",
    (r.extensionShaderTextureLOD || r.envMap) && r.rendererExtensionShaderTextureLod ? "#define TEXTURE_LOD_EXT" : "",
    "uniform mat4 viewMatrix;",
    "uniform vec3 cameraPosition;",
    "uniform bool isOrthographic;",
    r.toneMapping !== Mc ? "#define TONE_MAPPING" : "",
    r.toneMapping !== Mc ? Wt.tonemapping_pars_fragment : "",
    // this code is required here because it is used by the toneMapping() function defined below
    r.toneMapping !== Mc ? m6("toneMapping", r.toneMapping) : "",
    r.dithering ? "#define DITHERING" : "",
    r.outputEncoding || r.mapEncoding || r.matcapEncoding || r.envMapEncoding || r.emissiveMapEncoding || r.lightMapEncoding ? Wt.encodings_pars_fragment : "",
    // this code is required here because it is used by the various encoding/decoding function defined below
    r.mapEncoding ? su("mapTexelToLinear", r.mapEncoding) : "",
    r.matcapEncoding ? su("matcapTexelToLinear", r.matcapEncoding) : "",
    r.envMapEncoding ? su("envMapTexelToLinear", r.envMapEncoding) : "",
    r.emissiveMapEncoding ? su("emissiveMapTexelToLinear", r.emissiveMapEncoding) : "",
    r.lightMapEncoding ? su("lightMapTexelToLinear", r.lightMapEncoding) : "",
    r.outputEncoding ? v6("linearToOutputTexel", r.outputEncoding) : "",
    r.depthPacking ? "#define DEPTH_PACKING " + r.depthPacking : "",
    `
`
  ].filter(vu).join(`
`)), a = Sp(a), a = Lg(a, r), a = Fg(a, r), s = Sp(s), s = Lg(s, r), s = Fg(s, r), a = Ig(a), s = Ig(s), r.isWebGL2 && !r.isRawShaderMaterial) {
    var y = !1, w = /^\s*#version\s+300\s+es\s*\n/;
    r.isShaderMaterial && a.match(w) !== null && s.match(w) !== null && (y = !0, a = a.replace(w, ""), s = s.replace(w, "")), v = [
      `#version 300 es
`,
      "#define attribute in",
      "#define varying out",
      "#define texture2D texture"
    ].join(`
`) + `
` + v, m = [
      `#version 300 es
`,
      "#define varying in",
      y ? "" : "out highp vec4 pc_fragColor;",
      y ? "" : "#define gl_FragColor pc_fragColor",
      "#define gl_FragDepthEXT gl_FragDepth",
      "#define texture2D texture",
      "#define textureCube texture",
      "#define texture2DProj textureProj",
      "#define texture2DLodEXT textureLod",
      "#define texture2DProjLodEXT textureProjLod",
      "#define textureCubeLodEXT textureLod",
      "#define texture2DGradEXT textureGrad",
      "#define texture2DProjGradEXT textureProjGrad",
      "#define textureCubeGradEXT textureGrad"
    ].join(`
`) + `
` + m, p > 0 && (v = v.replace(
      `#version 300 es
`,
      [
        `#version 300 es
`,
        "#extension GL_OVR_multiview2 : require",
        "layout(num_views = " + p + ") in;",
        "#define VIEW_ID gl_ViewID_OVR"
      ].join(`
`)
    ), v = v.replace(
      [
        "uniform mat4 modelViewMatrix;",
        "uniform mat4 projectionMatrix;",
        "uniform mat4 viewMatrix;",
        "uniform mat3 normalMatrix;"
      ].join(`
`),
      [
        "uniform mat4 modelViewMatrices[" + p + "];",
        "uniform mat4 projectionMatrices[" + p + "];",
        "uniform mat4 viewMatrices[" + p + "];",
        "uniform mat3 normalMatrices[" + p + "];",
        "#define modelViewMatrix modelViewMatrices[VIEW_ID]",
        "#define projectionMatrix projectionMatrices[VIEW_ID]",
        "#define viewMatrix viewMatrices[VIEW_ID]",
        "#define normalMatrix normalMatrices[VIEW_ID]"
      ].join(`
`)
    ), m = m.replace(
      `#version 300 es
`,
      [
        `#version 300 es
`,
        "#extension GL_OVR_multiview2 : require",
        "#define VIEW_ID gl_ViewID_OVR"
      ].join(`
`)
    ), m = m.replace(
      "uniform mat4 viewMatrix;",
      [
        "uniform mat4 viewMatrices[" + p + "];",
        "#define viewMatrix viewMatrices[VIEW_ID]"
      ].join(`
`)
    ));
  }
  var x = v + a, b = m + s, M = Pg(n, 35633, x), k = Pg(n, 35632, b);
  if (n.attachShader(g, M), n.attachShader(g, k), r.index0AttributeName !== void 0 ? n.bindAttribLocation(g, 0, r.index0AttributeName) : r.morphTargets === !0 && n.bindAttribLocation(g, 0, "position"), n.linkProgram(g), e.debug.checkShaderErrors) {
    var E = n.getProgramInfoLog(g).trim(), S = n.getShaderInfoLog(M).trim(), F = n.getShaderInfoLog(k).trim(), O = !0, D = !0;
    if (n.getProgramParameter(g, 35714) === !1) {
      O = !1;
      var _ = Bg(n, M, "vertex"), L = Bg(n, k, "fragment");
      console.error("THREE.WebGLProgram: shader error: ", n.getError(), "35715", n.getProgramParameter(g, 35715), "gl.getProgramInfoLog", E, _, L);
    } else E !== "" ? console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()", E) : (S === "" || F === "") && (D = !1);
    D && (this.diagnostics = {
      runnable: O,
      programLog: E,
      vertexShader: {
        log: S,
        prefix: v
      },
      fragmentShader: {
        log: F,
        prefix: m
      }
    });
  }
  n.deleteShader(M), n.deleteShader(k);
  var G;
  this.getUniforms = function() {
    return G === void 0 && (G = new Ba(n, g)), G;
  };
  var V;
  return this.getAttributes = function() {
    return V === void 0 && (V = b6(n, g)), V;
  }, this.destroy = function() {
    n.deleteProgram(g), this.program = void 0;
  }, this.name = r.shaderName, this.id = d6++, this.cacheKey = t, this.usedTimes = 1, this.program = g, this.vertexShader = M, this.fragmentShader = k, this.numMultiviewViews = p, this;
}
function D6(e, t, r) {
  var n = [], i = r.isWebGL2, a = r.logarithmicDepthBuffer, s = r.floatVertexTextures, o = r.precision, u = r.maxVertexUniforms, l = r.vertexTextures, c = {
    MeshDepthMaterial: "depth",
    MeshDistanceMaterial: "distanceRGBA",
    MeshNormalMaterial: "normal",
    MeshBasicMaterial: "basic",
    MeshLambertMaterial: "lambert",
    MeshPhongMaterial: "phong",
    MeshToonMaterial: "toon",
    MeshStandardMaterial: "physical",
    MeshPhysicalMaterial: "physical",
    MeshMatcapMaterial: "matcap",
    LineBasicMaterial: "basic",
    LineDashedMaterial: "dashed",
    PointsMaterial: "points",
    ShadowMaterial: "shadow",
    SpriteMaterial: "sprite"
  }, f = [
    "precision",
    "isWebGL2",
    "supportsVertexTextures",
    "outputEncoding",
    "instancing",
    "numMultiviewViews",
    "map",
    "mapEncoding",
    "matcap",
    "matcapEncoding",
    "envMap",
    "envMapMode",
    "envMapEncoding",
    "envMapCubeUV",
    "lightMap",
    "lightMapEncoding",
    "aoMap",
    "emissiveMap",
    "emissiveMapEncoding",
    "bumpMap",
    "normalMap",
    "objectSpaceNormalMap",
    "tangentSpaceNormalMap",
    "clearcoatNormalMap",
    "displacementMap",
    "specularMap",
    "roughnessMap",
    "metalnessMap",
    "gradientMap",
    "alphaMap",
    "combine",
    "vertexColors",
    "vertexTangents",
    "vertexUvs",
    "uvsVertexOnly",
    "fog",
    "useFog",
    "fogExp2",
    "flatShading",
    "sizeAttenuation",
    "logarithmicDepthBuffer",
    "skinning",
    "maxBones",
    "useVertexTexture",
    "morphTargets",
    "morphNormals",
    "maxMorphTargets",
    "maxMorphNormals",
    "premultipliedAlpha",
    "numDirLights",
    "numPointLights",
    "numSpotLights",
    "numHemiLights",
    "numRectAreaLights",
    "numDirLightShadows",
    "numPointLightShadows",
    "numSpotLightShadows",
    "shadowMapEnabled",
    "shadowMapType",
    "toneMapping",
    "physicallyCorrectLights",
    "alphaTest",
    "doubleSided",
    "flipSided",
    "numClippingPlanes",
    "numClipIntersection",
    "depthPacking",
    "dithering",
    "sheen"
  ];
  function h(v, m) {
    var p;
    if (m) {
      var y = Yi[m];
      p = {
        name: v.type,
        uniforms: JA.clone(y.uniforms),
        vertexShader: y.vertexShader,
        fragmentShader: y.fragmentShader
      };
    } else
      p = {
        name: v.type,
        uniforms: v.uniforms,
        vertexShader: v.vertexShader,
        fragmentShader: v.fragmentShader
      };
    return p;
  }
  function d(v) {
    var m = v.skeleton, p = m.bones;
    if (s)
      return 1024;
    var y = u, w = Math.floor((y - 20) / 4), x = Math.min(w, p.length);
    return x < p.length ? (console.warn("THREE.WebGLRenderer: Skeleton has " + p.length + " bones. This GPU supports " + x + "."), 0) : x;
  }
  function g(v) {
    var m;
    return v ? v.isTexture ? m = v.encoding : v.isWebGLRenderTarget && (console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."), m = v.texture.encoding) : m = Pn, m;
  }
  this.getParameters = function(v, m, p, y, w, x, b) {
    var M = y.fog, k = v.isMeshStandardMaterial ? y.environment : null, E = v.envMap || k, S = c[v.type], F = b.isSkinnedMesh ? d(b) : 0;
    v.precision !== null && (o = r.getMaxPrecision(v.precision), o !== v.precision && console.warn("THREE.WebGLProgram.getParameters:", v.precision, "not supported, using", o, "instead."));
    var O = h(v, S);
    v.onBeforeCompile(O, e);
    var D = e.getRenderTarget(), _ = D && D.isWebGLMultiviewRenderTarget ? D.numViews : 0, L = {
      isWebGL2: i,
      shaderID: S,
      shaderName: O.name,
      uniforms: O.uniforms,
      vertexShader: O.vertexShader,
      fragmentShader: O.fragmentShader,
      defines: v.defines,
      isRawShaderMaterial: v.isRawShaderMaterial,
      isShaderMaterial: v.isShaderMaterial,
      precision: o,
      instancing: b.isInstancedMesh === !0,
      supportsVertexTextures: l,
      numMultiviewViews: _,
      outputEncoding: D !== null ? g(D.texture) : e.outputEncoding,
      map: !!v.map,
      mapEncoding: g(v.map),
      matcap: !!v.matcap,
      matcapEncoding: g(v.matcap),
      envMap: !!E,
      envMapMode: E && E.mapping,
      envMapEncoding: g(E),
      envMapCubeUV: !!E && (E.mapping === wl || E.mapping === d0),
      lightMap: !!v.lightMap,
      lightMapEncoding: g(v.lightMap),
      aoMap: !!v.aoMap,
      emissiveMap: !!v.emissiveMap,
      emissiveMapEncoding: g(v.emissiveMap),
      bumpMap: !!v.bumpMap,
      normalMap: !!v.normalMap,
      objectSpaceNormalMap: v.normalMapType === IA,
      tangentSpaceNormalMap: v.normalMapType === qo,
      clearcoatNormalMap: !!v.clearcoatNormalMap,
      displacementMap: !!v.displacementMap,
      roughnessMap: !!v.roughnessMap,
      metalnessMap: !!v.metalnessMap,
      specularMap: !!v.specularMap,
      alphaMap: !!v.alphaMap,
      gradientMap: !!v.gradientMap,
      sheen: !!v.sheen,
      combine: v.combine,
      vertexTangents: v.normalMap && v.vertexTangents,
      vertexColors: v.vertexColors,
      vertexUvs: !!v.map || !!v.bumpMap || !!v.normalMap || !!v.specularMap || !!v.alphaMap || !!v.emissiveMap || !!v.roughnessMap || !!v.metalnessMap || !!v.clearcoatNormalMap || !!v.displacementMap,
      uvsVertexOnly: !(v.map || v.bumpMap || v.normalMap || v.specularMap || v.alphaMap || v.emissiveMap || v.roughnessMap || v.metalnessMap || v.clearcoatNormalMap) && !!v.displacementMap,
      fog: !!M,
      useFog: v.fog,
      fogExp2: M && M.isFogExp2,
      flatShading: v.flatShading,
      sizeAttenuation: v.sizeAttenuation,
      logarithmicDepthBuffer: a,
      skinning: v.skinning && F > 0,
      maxBones: F,
      useVertexTexture: s,
      morphTargets: v.morphTargets,
      morphNormals: v.morphNormals,
      maxMorphTargets: e.maxMorphTargets,
      maxMorphNormals: e.maxMorphNormals,
      numDirLights: m.directional.length,
      numPointLights: m.point.length,
      numSpotLights: m.spot.length,
      numRectAreaLights: m.rectArea.length,
      numHemiLights: m.hemi.length,
      numDirLightShadows: m.directionalShadowMap.length,
      numPointLightShadows: m.pointShadowMap.length,
      numSpotLightShadows: m.spotShadowMap.length,
      numClippingPlanes: w,
      numClipIntersection: x,
      dithering: v.dithering,
      shadowMapEnabled: e.shadowMap.enabled && p.length > 0,
      shadowMapType: e.shadowMap.type,
      toneMapping: v.toneMapped ? e.toneMapping : Mc,
      physicallyCorrectLights: e.physicallyCorrectLights,
      premultipliedAlpha: v.premultipliedAlpha,
      alphaTest: v.alphaTest,
      doubleSided: v.side === nh,
      flipSided: v.side === Hr,
      depthPacking: v.depthPacking !== void 0 ? v.depthPacking : !1,
      index0AttributeName: v.index0AttributeName,
      extensionDerivatives: v.extensions && v.extensions.derivatives,
      extensionFragDepth: v.extensions && v.extensions.frawbuffers,
      extensionDrawbuffers: v.extensions && v.extensions.drawbuffers,
      extensionShaderTextureLOD: v.extensions && v.extensions.shaderTextureLOD,
      rendererExtensionFragDepth: i || t.get("EXT_frag_depth") !== null,
      rendererExtensionDrawBuffers: i || t.get("WEBGL_draw_buffers") !== null,
      rendererExtensionShaderTextureLod: i || t.get("EXT_shader_texture_lod") !== null,
      onBeforeCompile: v.onBeforeCompile
    };
    return L;
  }, this.getProgramCacheKey = function(v) {
    var m = [];
    if (v.shaderID ? m.push(v.shaderID) : (m.push(v.fragmentShader), m.push(v.vertexShader)), v.defines !== void 0)
      for (var p in v.defines)
        m.push(p), m.push(v.defines[p]);
    if (v.isRawShaderMaterial === void 0) {
      for (var y = 0; y < f.length; y++)
        m.push(v[f[y]]);
      m.push(e.outputEncoding), m.push(e.gammaFactor);
    }
    return m.push(v.onBeforeCompile.toString()), m.join();
  }, this.acquireProgram = function(v, m) {
    for (var p, y = 0, w = n.length; y < w; y++) {
      var x = n[y];
      if (x.cacheKey === m) {
        p = x, ++p.usedTimes;
        break;
      }
    }
    return p === void 0 && (p = new C6(e, m, v), n.push(p)), p;
  }, this.releaseProgram = function(v) {
    if (--v.usedTimes === 0) {
      var m = n.indexOf(v);
      n[m] = n[n.length - 1], n.pop(), v.destroy();
    }
  }, this.programs = n;
}
function _6() {
  var e = /* @__PURE__ */ new WeakMap();
  function t(a) {
    var s = e.get(a);
    return s === void 0 && (s = {}, e.set(a, s)), s;
  }
  function r(a) {
    e.delete(a);
  }
  function n(a, s, o) {
    e.get(a)[s] = o;
  }
  function i() {
    e = /* @__PURE__ */ new WeakMap();
  }
  return {
    get: t,
    remove: r,
    update: n,
    dispose: i
  };
}
function P6(e, t) {
  return e.groupOrder !== t.groupOrder ? e.groupOrder - t.groupOrder : e.renderOrder !== t.renderOrder ? e.renderOrder - t.renderOrder : e.program !== t.program ? e.program.id - t.program.id : e.material.id !== t.material.id ? e.material.id - t.material.id : e.z !== t.z ? e.z - t.z : e.id - t.id;
}
function B6(e, t) {
  return e.groupOrder !== t.groupOrder ? e.groupOrder - t.groupOrder : e.renderOrder !== t.renderOrder ? e.renderOrder - t.renderOrder : e.z !== t.z ? t.z - e.z : e.id - t.id;
}
function Og() {
  var e = [], t = 0, r = [], n = [], i = { id: -1 };
  function a() {
    t = 0, r.length = 0, n.length = 0;
  }
  function s(c, f, h, d, g, v) {
    var m = e[t];
    return m === void 0 ? (m = {
      id: c.id,
      object: c,
      geometry: f,
      material: h,
      program: h.program || i,
      groupOrder: d,
      renderOrder: c.renderOrder,
      z: g,
      group: v
    }, e[t] = m) : (m.id = c.id, m.object = c, m.geometry = f, m.material = h, m.program = h.program || i, m.groupOrder = d, m.renderOrder = c.renderOrder, m.z = g, m.group = v), t++, m;
  }
  function o(c, f, h, d, g, v) {
    var m = s(c, f, h, d, g, v);
    (h.transparent === !0 ? n : r).push(m);
  }
  function u(c, f, h, d, g, v) {
    var m = s(c, f, h, d, g, v);
    (h.transparent === !0 ? n : r).unshift(m);
  }
  function l(c, f) {
    r.length > 1 && r.sort(c || P6), n.length > 1 && n.sort(f || B6);
  }
  return {
    opaque: r,
    transparent: n,
    init: a,
    push: o,
    unshift: u,
    sort: l
  };
}
function L6() {
  var e = /* @__PURE__ */ new WeakMap();
  function t(i) {
    var a = i.target;
    a.removeEventListener("dispose", t), e.delete(a);
  }
  function r(i, a) {
    var s = e.get(i), o;
    return s === void 0 ? (o = new Og(), e.set(i, /* @__PURE__ */ new WeakMap()), e.get(i).set(a, o), i.addEventListener("dispose", t)) : (o = s.get(a), o === void 0 && (o = new Og(), s.set(a, o))), o;
  }
  function n() {
    e = /* @__PURE__ */ new WeakMap();
  }
  return {
    get: r,
    dispose: n
  };
}
function F6() {
  var e = {};
  return {
    get: function(t) {
      if (e[t.id] !== void 0)
        return e[t.id];
      var r;
      switch (t.type) {
        case "DirectionalLight":
          r = {
            direction: new re(),
            color: new nt(),
            shadow: !1,
            shadowBias: 0,
            shadowRadius: 1,
            shadowMapSize: new _e()
          };
          break;
        case "SpotLight":
          r = {
            position: new re(),
            direction: new re(),
            color: new nt(),
            distance: 0,
            coneCos: 0,
            penumbraCos: 0,
            decay: 0,
            shadow: !1,
            shadowBias: 0,
            shadowRadius: 1,
            shadowMapSize: new _e()
          };
          break;
        case "PointLight":
          r = {
            position: new re(),
            color: new nt(),
            distance: 0,
            decay: 0,
            shadow: !1,
            shadowBias: 0,
            shadowRadius: 1,
            shadowMapSize: new _e(),
            shadowCameraNear: 1,
            shadowCameraFar: 1e3
          };
          break;
        case "HemisphereLight":
          r = {
            direction: new re(),
            skyColor: new nt(),
            groundColor: new nt()
          };
          break;
        case "RectAreaLight":
          r = {
            color: new nt(),
            position: new re(),
            halfWidth: new re(),
            halfHeight: new re()
            // TODO (abelnation): set RectAreaLight shadow uniforms
          };
          break;
      }
      return e[t.id] = r, r;
    }
  };
}
var I6 = 0;
function R6(e, t) {
  return (t.castShadow ? 1 : 0) - (e.castShadow ? 1 : 0);
}
function O6() {
  for (var e = new F6(), t = {
    version: 0,
    hash: {
      directionalLength: -1,
      pointLength: -1,
      spotLength: -1,
      rectAreaLength: -1,
      hemiLength: -1,
      numDirectionalShadows: -1,
      numPointShadows: -1,
      numSpotShadows: -1
    },
    ambient: [0, 0, 0],
    probe: [],
    directional: [],
    directionalShadowMap: [],
    directionalShadowMatrix: [],
    spot: [],
    spotShadowMap: [],
    spotShadowMatrix: [],
    rectArea: [],
    point: [],
    pointShadowMap: [],
    pointShadowMatrix: [],
    hemi: [],
    numDirectionalShadows: -1,
    numPointShadows: -1,
    numSpotShadows: -1
  }, r = 0; r < 9; r++) t.probe.push(new re());
  var n = new re(), i = new Nt(), a = new Nt();
  function s(o, u, l) {
    for (var c = 0, f = 0, h = 0, d = 0; d < 9; d++) t.probe[d].set(0, 0, 0);
    var g = 0, v = 0, m = 0, p = 0, y = 0, w = 0, x = 0, b = 0, M = l.matrixWorldInverse;
    o.sort(R6);
    for (var d = 0, k = o.length; d < k; d++) {
      var E = o[d], S = E.color, F = E.intensity, O = E.distance, D = E.shadow && E.shadow.map ? E.shadow.map.texture : null;
      if (E.isAmbientLight)
        c += S.r * F, f += S.g * F, h += S.b * F;
      else if (E.isLightProbe)
        for (var _ = 0; _ < 9; _++)
          t.probe[_].addScaledVector(E.sh.coefficients[_], F);
      else if (E.isDirectionalLight) {
        var L = e.get(E);
        if (L.color.copy(E.color).multiplyScalar(E.intensity), L.direction.setFromMatrixPosition(E.matrixWorld), n.setFromMatrixPosition(E.target.matrixWorld), L.direction.sub(n), L.direction.transformDirection(M), L.shadow = E.castShadow, E.castShadow) {
          var G = E.shadow;
          L.shadowBias = G.bias, L.shadowRadius = G.radius, L.shadowMapSize = G.mapSize, t.directionalShadowMap[g] = D, t.directionalShadowMatrix[g] = E.shadow.matrix, w++;
        }
        t.directional[g] = L, g++;
      } else if (E.isSpotLight) {
        var L = e.get(E);
        if (L.position.setFromMatrixPosition(E.matrixWorld), L.position.applyMatrix4(M), L.color.copy(S).multiplyScalar(F), L.distance = O, L.direction.setFromMatrixPosition(E.matrixWorld), n.setFromMatrixPosition(E.target.matrixWorld), L.direction.sub(n), L.direction.transformDirection(M), L.coneCos = Math.cos(E.angle), L.penumbraCos = Math.cos(E.angle * (1 - E.penumbra)), L.decay = E.decay, L.shadow = E.castShadow, E.castShadow) {
          var G = E.shadow;
          L.shadowBias = G.bias, L.shadowRadius = G.radius, L.shadowMapSize = G.mapSize, t.spotShadowMap[m] = D, t.spotShadowMatrix[m] = E.shadow.matrix, b++;
        }
        t.spot[m] = L, m++;
      } else if (E.isRectAreaLight) {
        var L = e.get(E);
        L.color.copy(S).multiplyScalar(F), L.position.setFromMatrixPosition(E.matrixWorld), L.position.applyMatrix4(M), a.identity(), i.copy(E.matrixWorld), i.premultiply(M), a.extractRotation(i), L.halfWidth.set(E.width * 0.5, 0, 0), L.halfHeight.set(0, E.height * 0.5, 0), L.halfWidth.applyMatrix4(a), L.halfHeight.applyMatrix4(a), t.rectArea[p] = L, p++;
      } else if (E.isPointLight) {
        var L = e.get(E);
        if (L.position.setFromMatrixPosition(E.matrixWorld), L.position.applyMatrix4(M), L.color.copy(E.color).multiplyScalar(E.intensity), L.distance = E.distance, L.decay = E.decay, L.shadow = E.castShadow, E.castShadow) {
          var G = E.shadow;
          L.shadowBias = G.bias, L.shadowRadius = G.radius, L.shadowMapSize = G.mapSize, L.shadowCameraNear = G.camera.near, L.shadowCameraFar = G.camera.far, t.pointShadowMap[v] = D, t.pointShadowMatrix[v] = E.shadow.matrix, x++;
        }
        t.point[v] = L, v++;
      } else if (E.isHemisphereLight) {
        var L = e.get(E);
        L.direction.setFromMatrixPosition(E.matrixWorld), L.direction.transformDirection(M), L.direction.normalize(), L.skyColor.copy(E.color).multiplyScalar(F), L.groundColor.copy(E.groundColor).multiplyScalar(F), t.hemi[y] = L, y++;
      }
    }
    t.ambient[0] = c, t.ambient[1] = f, t.ambient[2] = h;
    var V = t.hash;
    (V.directionalLength !== g || V.pointLength !== v || V.spotLength !== m || V.rectAreaLength !== p || V.hemiLength !== y || V.numDirectionalShadows !== w || V.numPointShadows !== x || V.numSpotShadows !== b) && (t.directional.length = g, t.spot.length = m, t.rectArea.length = p, t.point.length = v, t.hemi.length = y, t.directionalShadowMap.length = w, t.pointShadowMap.length = x, t.spotShadowMap.length = b, t.directionalShadowMatrix.length = w, t.pointShadowMatrix.length = x, t.spotShadowMatrix.length = b, V.directionalLength = g, V.pointLength = v, V.spotLength = m, V.rectAreaLength = p, V.hemiLength = y, V.numDirectionalShadows = w, V.numPointShadows = x, V.numSpotShadows = b, t.version = I6++);
  }
  return {
    setup: s,
    state: t
  };
}
function Ng() {
  var e = new O6(), t = [], r = [];
  function n() {
    t.length = 0, r.length = 0;
  }
  function i(u) {
    t.push(u);
  }
  function a(u) {
    r.push(u);
  }
  function s(u) {
    e.setup(t, r, u);
  }
  var o = {
    lightsArray: t,
    shadowsArray: r,
    lights: e
  };
  return {
    init: n,
    state: o,
    setupLights: s,
    pushLight: i,
    pushShadow: a
  };
}
function N6() {
  var e = /* @__PURE__ */ new WeakMap();
  function t(i) {
    var a = i.target;
    a.removeEventListener("dispose", t), e.delete(a);
  }
  function r(i, a) {
    var s;
    return e.has(i) === !1 ? (s = new Ng(), e.set(i, /* @__PURE__ */ new WeakMap()), e.get(i).set(a, s), i.addEventListener("dispose", t)) : e.get(i).has(a) === !1 ? (s = new Ng(), e.get(i).set(a, s)) : s = e.get(i).get(a), s;
  }
  function n() {
    e = /* @__PURE__ */ new WeakMap();
  }
  return {
    get: r,
    dispose: n
  };
}
function bs(e) {
  wt.call(this), this.type = "MeshDepthMaterial", this.depthPacking = LA, this.skinning = !1, this.morphTargets = !1, this.map = null, this.alphaMap = null, this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.setValues(e);
}
bs.prototype = Object.create(wt.prototype);
bs.prototype.constructor = bs;
bs.prototype.isMeshDepthMaterial = !0;
bs.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.depthPacking = e.depthPacking, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.map = e.map, this.alphaMap = e.alphaMap, this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this;
};
function ws(e) {
  wt.call(this), this.type = "MeshDistanceMaterial", this.referencePosition = new re(), this.nearDistance = 1, this.farDistance = 1e3, this.skinning = !1, this.morphTargets = !1, this.map = null, this.alphaMap = null, this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.fog = !1, this.setValues(e);
}
ws.prototype = Object.create(wt.prototype);
ws.prototype.constructor = ws;
ws.prototype.isMeshDistanceMaterial = !0;
ws.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.referencePosition.copy(e.referencePosition), this.nearDistance = e.nearDistance, this.farDistance = e.farDistance, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.map = e.map, this.alphaMap = e.alphaMap, this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this;
};
var U6 = `uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`, G6 = `void main() {
	gl_Position = vec4( position, 1.0 );
}`;
function Bb(e, t, r) {
  var n = new Ml(), i = new _e(), a = new _e(), s = new or(), o = [], u = [], l = {}, c = { 0: Hr, 1: yl, 2: nh }, f = new En({
    defines: {
      SAMPLE_RATE: 2 / 8,
      HALF_SAMPLE_RATE: 1 / 8
    },
    uniforms: {
      shadow_pass: { value: null },
      resolution: { value: new _e() },
      radius: { value: 4 }
    },
    vertexShader: G6,
    fragmentShader: U6
  }), h = f.clone();
  h.defines.HORIZONAL_PASS = 1;
  var d = new it();
  d.setAttribute(
    "position",
    new Et(
      new Float32Array([-1, -1, 0.5, 3, -1, 0.5, -1, 3, 0.5]),
      3
    )
  );
  var g = new Tr(d, f), v = this;
  this.enabled = !1, this.autoUpdate = !0, this.needsUpdate = !1, this.type = ob, this.render = function(b, M, k) {
    if (v.enabled !== !1 && !(v.autoUpdate === !1 && v.needsUpdate === !1) && b.length !== 0) {
      var E = e.getRenderTarget(), S = e.getActiveCubeFace(), F = e.getActiveMipmapLevel(), O = e.state;
      O.setBlending(Pa), O.buffers.color.setClear(1, 1, 1, 1), O.buffers.depth.setTest(!0), O.setScissorTest(!1);
      for (var D = 0, _ = b.length; D < _; D++) {
        var L = b[D], G = L.shadow;
        if (G === void 0) {
          console.warn("THREE.WebGLShadowMap:", L, "has no shadow.");
          continue;
        }
        i.copy(G.mapSize);
        var V = G.getFrameExtents();
        if (i.multiply(V), a.copy(G.mapSize), (i.x > r || i.y > r) && (console.warn("THREE.WebGLShadowMap:", L, "has shadow exceeding max texture size, reducing"), i.x > r && (a.x = Math.floor(r / V.x), i.x = a.x * V.x, G.mapSize.x = a.x), i.y > r && (a.y = Math.floor(r / V.y), i.y = a.y * V.y, G.mapSize.y = a.y)), G.map === null && !G.isPointLightShadow && this.type === pu) {
          var H = { minFilter: Vr, magFilter: Vr, format: _i };
          G.map = new vn(i.x, i.y, H), G.map.texture.name = L.name + ".shadowMap", G.mapPass = new vn(i.x, i.y, H), G.camera.updateProjectionMatrix();
        }
        if (G.map === null) {
          var H = { minFilter: Or, magFilter: Or, format: _i };
          G.map = new vn(i.x, i.y, H), G.map.texture.name = L.name + ".shadowMap", G.camera.updateProjectionMatrix();
        }
        e.setRenderTarget(G.map), e.clear();
        for (var U = G.getViewportCount(), R = 0; R < U; R++) {
          var B = G.getViewport(R);
          s.set(
            a.x * B.x,
            a.y * B.y,
            a.x * B.z,
            a.y * B.w
          ), O.viewport(s), G.updateMatrices(L, R), n = G.getFrustum(), x(M, k, G.camera, L, this.type);
        }
        !G.isPointLightShadow && this.type === pu && m(G, k);
      }
      v.needsUpdate = !1, e.setRenderTarget(E, S, F);
    }
  };
  function m(b, M) {
    var k = t.update(g);
    f.uniforms.shadow_pass.value = b.map.texture, f.uniforms.resolution.value = b.mapSize, f.uniforms.radius.value = b.radius, e.setRenderTarget(b.mapPass), e.clear(), e.renderBufferDirect(M, null, k, f, g, null), h.uniforms.shadow_pass.value = b.mapPass.texture, h.uniforms.resolution.value = b.mapSize, h.uniforms.radius.value = b.radius, e.setRenderTarget(b.map), e.clear(), e.renderBufferDirect(M, null, k, h, g, null);
  }
  function p(b, M, k) {
    var E = b << 0 | M << 1 | k << 2, S = o[E];
    return S === void 0 && (S = new bs({
      depthPacking: FA,
      morphTargets: b,
      skinning: M
    }), o[E] = S), S;
  }
  function y(b, M, k) {
    var E = b << 0 | M << 1 | k << 2, S = u[E];
    return S === void 0 && (S = new ws({
      morphTargets: b,
      skinning: M
    }), u[E] = S), S;
  }
  function w(b, M, k, E, S, F) {
    var O = b.geometry, D = null, _ = p, L = b.customDepthMaterial;
    if (k.isPointLight === !0 && (_ = y, L = b.customDistanceMaterial), L === void 0) {
      var G = !1;
      M.morphTargets === !0 && (O.isBufferGeometry === !0 ? G = O.morphAttributes && O.morphAttributes.position && O.morphAttributes.position.length > 0 : O.isGeometry === !0 && (G = O.morphTargets && O.morphTargets.length > 0));
      var V = !1;
      b.isSkinnedMesh === !0 && (M.skinning === !0 ? V = !0 : console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:", b));
      var H = b.isInstancedMesh === !0;
      D = _(G, V, H);
    } else
      D = L;
    if (e.localClippingEnabled && M.clipShadows === !0 && M.clippingPlanes.length !== 0) {
      var U = D.uuid, R = M.uuid, B = l[U];
      B === void 0 && (B = {}, l[U] = B);
      var C = B[R];
      C === void 0 && (C = D.clone(), B[R] = C), D = C;
    }
    return D.visible = M.visible, D.wireframe = M.wireframe, F === pu ? D.side = M.shadowSide !== null ? M.shadowSide : M.side : D.side = M.shadowSide !== null ? M.shadowSide : c[M.side], D.clipShadows = M.clipShadows, D.clippingPlanes = M.clippingPlanes, D.clipIntersection = M.clipIntersection, D.wireframeLinewidth = M.wireframeLinewidth, D.linewidth = M.linewidth, k.isPointLight === !0 && D.isMeshDistanceMaterial === !0 && (D.referencePosition.setFromMatrixPosition(k.matrixWorld), D.nearDistance = E, D.farDistance = S), D;
  }
  function x(b, M, k, E, S) {
    if (b.visible !== !1) {
      var F = b.layers.test(M.layers);
      if (F && (b.isMesh || b.isLine || b.isPoints) && (b.castShadow || b.receiveShadow && S === pu) && (!b.frustumCulled || n.intersectsObject(b))) {
        b.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse, b.matrixWorld);
        var O = t.update(b), D = b.material;
        if (Array.isArray(D))
          for (var _ = O.groups, L = 0, G = _.length; L < G; L++) {
            var V = _[L], H = D[V.materialIndex];
            if (H && H.visible) {
              var U = w(b, H, E, k.near, k.far, S);
              e.renderBufferDirect(k, null, O, U, b, V);
            }
          }
        else if (D.visible) {
          var U = w(b, D, E, k.near, k.far, S);
          e.renderBufferDirect(k, null, O, U, b, null);
        }
      }
      for (var R = b.children, B = 0, C = R.length; B < C; B++)
        x(R[B], M, k, E, S);
    }
  }
}
function z6(e, t, r) {
  var n = r.isWebGL2;
  function i() {
    var P = !1, z = new or(), K = null, oe = new or(0, 0, 0, 0);
    return {
      setMask: function(ce) {
        K !== ce && !P && (e.colorMask(ce, ce, ce, ce), K = ce);
      },
      setLocked: function(ce) {
        P = ce;
      },
      setClear: function(ce, ge, Oe, Ge, We) {
        We === !0 && (ce *= Ge, ge *= Ge, Oe *= Ge), z.set(ce, ge, Oe, Ge), oe.equals(z) === !1 && (e.clearColor(ce, ge, Oe, Ge), oe.copy(z));
      },
      reset: function() {
        P = !1, K = null, oe.set(-1, 0, 0, 0);
      }
    };
  }
  function a() {
    var P = !1, z = null, K = null, oe = null;
    return {
      setTest: function(ce) {
        ce ? ae(2929) : pe(2929);
      },
      setMask: function(ce) {
        z !== ce && !P && (e.depthMask(ce), z = ce);
      },
      setFunc: function(ce) {
        if (K !== ce) {
          if (ce)
            switch (ce) {
              case NE:
                e.depthFunc(512);
                break;
              case UE:
                e.depthFunc(519);
                break;
              case GE:
                e.depthFunc(513);
                break;
              case gp:
                e.depthFunc(515);
                break;
              case zE:
                e.depthFunc(514);
                break;
              case WE:
                e.depthFunc(518);
                break;
              case VE:
                e.depthFunc(516);
                break;
              case HE:
                e.depthFunc(517);
                break;
              default:
                e.depthFunc(515);
            }
          else
            e.depthFunc(515);
          K = ce;
        }
      },
      setLocked: function(ce) {
        P = ce;
      },
      setClear: function(ce) {
        oe !== ce && (e.clearDepth(ce), oe = ce);
      },
      reset: function() {
        P = !1, z = null, K = null, oe = null;
      }
    };
  }
  function s() {
    var P = !1, z = null, K = null, oe = null, ce = null, ge = null, Oe = null, Ge = null, We = null;
    return {
      setTest: function($e) {
        P || ($e ? ae(2960) : pe(2960));
      },
      setMask: function($e) {
        z !== $e && !P && (e.stencilMask($e), z = $e);
      },
      setFunc: function($e, pt, tt) {
        (K !== $e || oe !== pt || ce !== tt) && (e.stencilFunc($e, pt, tt), K = $e, oe = pt, ce = tt);
      },
      setOp: function($e, pt, tt) {
        (ge !== $e || Oe !== pt || Ge !== tt) && (e.stencilOp($e, pt, tt), ge = $e, Oe = pt, Ge = tt);
      },
      setLocked: function($e) {
        P = $e;
      },
      setClear: function($e) {
        We !== $e && (e.clearStencil($e), We = $e);
      },
      reset: function() {
        P = !1, z = null, K = null, oe = null, ce = null, ge = null, Oe = null, Ge = null, We = null;
      }
    };
  }
  var o = new i(), u = new a(), l = new s(), c = e.getParameter(34921), f = new Uint8Array(c), h = new Uint8Array(c), d = new Uint8Array(c), g = {}, v = null, m = null, p = null, y = null, w = null, x = null, b = null, M = null, k = null, E = !1, S = null, F = null, O = null, D = null, _ = null, L = e.getParameter(35661), G = !1, V = 0, H = e.getParameter(7938);
  H.indexOf("WebGL") !== -1 ? (V = parseFloat(/^WebGL\ ([0-9])/.exec(H)[1]), G = V >= 1) : H.indexOf("OpenGL ES") !== -1 && (V = parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(H)[1]), G = V >= 2);
  var U = null, R = {}, B = new or(), C = new or();
  function Z(P, z, K) {
    var oe = new Uint8Array(4), ce = e.createTexture();
    e.bindTexture(P, ce), e.texParameteri(P, 10241, 9728), e.texParameteri(P, 10240, 9728);
    for (var ge = 0; ge < K; ge++)
      e.texImage2D(z + ge, 0, 6408, 1, 1, 0, 6408, 5121, oe);
    return ce;
  }
  var W = {};
  W[3553] = Z(3553, 3553, 1), W[34067] = Z(34067, 34069, 6), o.setClear(0, 0, 0, 1), u.setClear(1), l.setClear(0), ae(2929), u.setFunc(gp), Ee(!1), Y(tg), ae(2884), Ae(Pa);
  function J() {
    for (var P = 0, z = f.length; P < z; P++)
      f[P] = 0;
  }
  function Q(P) {
    j(P, 0);
  }
  function j(P, z) {
    if (f[P] = 1, h[P] === 0 && (e.enableVertexAttribArray(P), h[P] = 1), d[P] !== z) {
      var K = n ? e : t.get("ANGLE_instanced_arrays");
      K[n ? "vertexAttribDivisor" : "vertexAttribDivisorANGLE"](P, z), d[P] = z;
    }
  }
  function q() {
    for (var P = 0, z = h.length; P !== z; ++P)
      h[P] !== f[P] && (e.disableVertexAttribArray(P), h[P] = 0);
  }
  function ae(P) {
    g[P] !== !0 && (e.enable(P), g[P] = !0);
  }
  function pe(P) {
    g[P] !== !1 && (e.disable(P), g[P] = !1);
  }
  function $(P) {
    return v !== P ? (e.useProgram(P), v = P, !0) : !1;
  }
  var se = {
    [ao]: 32774,
    [kE]: 32778,
    [CE]: 32779
  };
  if (n)
    se[ag] = 32775, se[sg] = 32776;
  else {
    var ve = t.get("EXT_blend_minmax");
    ve !== null && (se[ag] = ve.MIN_EXT, se[sg] = ve.MAX_EXT);
  }
  var me = {
    [DE]: 0,
    [_E]: 1,
    [PE]: 768,
    [cb]: 770,
    [OE]: 776,
    [IE]: 774,
    [LE]: 772,
    [BE]: 769,
    [fb]: 771,
    [RE]: 775,
    [FE]: 773
  };
  function Ae(P, z, K, oe, ce, ge, Oe, Ge) {
    if (P === Pa) {
      m && (pe(3042), m = !1);
      return;
    }
    if (m || (ae(3042), m = !0), P !== SE) {
      if (P !== p || Ge !== E) {
        if ((y !== ao || b !== ao) && (e.blendEquation(32774), y = ao, b = ao), Ge)
          switch (P) {
            case xu:
              e.blendFuncSeparate(1, 771, 1, 771);
              break;
            case rg:
              e.blendFunc(1, 1);
              break;
            case ng:
              e.blendFuncSeparate(0, 0, 769, 771);
              break;
            case ig:
              e.blendFuncSeparate(0, 768, 0, 770);
              break;
            default:
              console.error("THREE.WebGLState: Invalid blending: ", P);
              break;
          }
        else
          switch (P) {
            case xu:
              e.blendFuncSeparate(770, 771, 1, 771);
              break;
            case rg:
              e.blendFunc(770, 1);
              break;
            case ng:
              e.blendFunc(0, 769);
              break;
            case ig:
              e.blendFunc(0, 768);
              break;
            default:
              console.error("THREE.WebGLState: Invalid blending: ", P);
              break;
          }
        w = null, x = null, M = null, k = null, p = P, E = Ge;
      }
      return;
    }
    ce = ce || z, ge = ge || K, Oe = Oe || oe, (z !== y || ce !== b) && (e.blendEquationSeparate(se[z], se[ce]), y = z, b = ce), (K !== w || oe !== x || ge !== M || Oe !== k) && (e.blendFuncSeparate(me[K], me[oe], me[ge], me[Oe]), w = K, x = oe, M = ge, k = Oe), p = P, E = null;
  }
  function Ce(P, z) {
    P.side === nh ? pe(2884) : ae(2884);
    var K = P.side === Hr;
    z && (K = !K), Ee(K), P.blending === xu && P.transparent === !1 ? Ae(Pa) : Ae(P.blending, P.blendEquation, P.blendSrc, P.blendDst, P.blendEquationAlpha, P.blendSrcAlpha, P.blendDstAlpha, P.premultipliedAlpha), u.setFunc(P.depthFunc), u.setTest(P.depthTest), u.setMask(P.depthWrite), o.setMask(P.colorWrite);
    var oe = P.stencilWrite;
    l.setTest(oe), oe && (l.setMask(P.stencilWriteMask), l.setFunc(P.stencilFunc, P.stencilRef, P.stencilFuncMask), l.setOp(P.stencilFail, P.stencilZFail, P.stencilZPass)), Me(P.polygonOffset, P.polygonOffsetFactor, P.polygonOffsetUnits);
  }
  function Ee(P) {
    S !== P && (P ? e.frontFace(2304) : e.frontFace(2305), S = P);
  }
  function Y(P) {
    P !== ME ? (ae(2884), P !== F && (P === tg ? e.cullFace(1029) : P === EE ? e.cullFace(1028) : e.cullFace(1032))) : pe(2884), F = P;
  }
  function ee(P) {
    P !== O && (G && e.lineWidth(P), O = P);
  }
  function Me(P, z, K) {
    P ? (ae(32823), (D !== z || _ !== K) && (e.polygonOffset(z, K), D = z, _ = K)) : pe(32823);
  }
  function ye(P) {
    P ? ae(3089) : pe(3089);
  }
  function De(P) {
    P === void 0 && (P = 33984 + L - 1), U !== P && (e.activeTexture(P), U = P);
  }
  function Se(P, z) {
    U === null && De();
    var K = R[U];
    K === void 0 && (K = { type: void 0, texture: void 0 }, R[U] = K), (K.type !== P || K.texture !== z) && (e.bindTexture(P, z || W[P]), K.type = P, K.texture = z);
  }
  function fe() {
    var P = R[U];
    P !== void 0 && P.type !== void 0 && (e.bindTexture(P.type, null), P.type = void 0, P.texture = void 0);
  }
  function ke() {
    try {
      e.compressedTexImage2D.apply(e, arguments);
    } catch (P) {
      console.error("THREE.WebGLState:", P);
    }
  }
  function ne() {
    try {
      e.texImage2D.apply(e, arguments);
    } catch (P) {
      console.error("THREE.WebGLState:", P);
    }
  }
  function Te() {
    try {
      e.texImage3D.apply(e, arguments);
    } catch (P) {
      console.error("THREE.WebGLState:", P);
    }
  }
  function I(P) {
    B.equals(P) === !1 && (e.scissor(P.x, P.y, P.z, P.w), B.copy(P));
  }
  function A(P) {
    C.equals(P) === !1 && (e.viewport(P.x, P.y, P.z, P.w), C.copy(P));
  }
  function T() {
    for (var P = 0; P < h.length; P++)
      h[P] === 1 && (e.disableVertexAttribArray(P), h[P] = 0);
    g = {}, U = null, R = {}, v = null, p = null, S = null, F = null, o.reset(), u.reset(), l.reset();
  }
  return {
    buffers: {
      color: o,
      depth: u,
      stencil: l
    },
    initAttributes: J,
    enableAttribute: Q,
    enableAttributeAndDivisor: j,
    disableUnusedAttributes: q,
    enable: ae,
    disable: pe,
    useProgram: $,
    setBlending: Ae,
    setMaterial: Ce,
    setFlipSided: Ee,
    setCullFace: Y,
    setLineWidth: ee,
    setPolygonOffset: Me,
    setScissorTest: ye,
    activeTexture: De,
    bindTexture: Se,
    unbindTexture: fe,
    compressedTexImage2D: ke,
    texImage2D: ne,
    texImage3D: Te,
    scissor: I,
    viewport: A,
    reset: T
  };
}
function W6(e, t, r, n, i, a, s) {
  var o = i.isWebGL2, u = i.maxTextures, l = i.maxCubemapSize, c = i.maxTextureSize, f = i.maxSamples, h = /* @__PURE__ */ new WeakMap(), d, g = !1;
  try {
    g = typeof OffscreenCanvas != "undefined" && new OffscreenCanvas(1, 1).getContext("2d") !== null;
  } catch (Y) {
  }
  function v(Y, ee) {
    return g ? new OffscreenCanvas(Y, ee) : document.createElementNS("http://www.w3.org/1999/xhtml", "canvas");
  }
  function m(Y, ee, Me, ye) {
    var De = 1;
    if ((Y.width > ye || Y.height > ye) && (De = ye / Math.max(Y.width, Y.height)), De < 1 || ee === !0)
      if (typeof HTMLImageElement != "undefined" && Y instanceof HTMLImageElement || typeof HTMLCanvasElement != "undefined" && Y instanceof HTMLCanvasElement || typeof ImageBitmap != "undefined" && Y instanceof ImageBitmap) {
        var Se = ee ? It.floorPowerOfTwo : Math.floor, fe = Se(De * Y.width), ke = Se(De * Y.height);
        d === void 0 && (d = v(fe, ke));
        var ne = Me ? v(fe, ke) : d;
        ne.width = fe, ne.height = ke;
        var Te = ne.getContext("2d");
        return Te.drawImage(Y, 0, 0, fe, ke), console.warn("THREE.WebGLRenderer: Texture has been resized from (" + Y.width + "x" + Y.height + ") to (" + fe + "x" + ke + ")."), ne;
      } else
        return "data" in Y && console.warn("THREE.WebGLRenderer: Image in DataTexture is too big (" + Y.width + "x" + Y.height + ")."), Y;
    return Y;
  }
  function p(Y) {
    return It.isPowerOfTwo(Y.width) && It.isPowerOfTwo(Y.height);
  }
  function y(Y) {
    return o ? !1 : Y.wrapS !== Mn || Y.wrapT !== Mn || Y.minFilter !== Or && Y.minFilter !== Vr;
  }
  function w(Y, ee) {
    return Y.generateMipmaps && ee && Y.minFilter !== Or && Y.minFilter !== Vr;
  }
  function x(Y, ee, Me, ye) {
    e.generateMipmap(Y);
    var De = n.get(ee);
    De.__maxMipLevel = Math.log(Math.max(Me, ye)) * Math.LOG2E;
  }
  function b(Y, ee, Me) {
    if (o === !1) return ee;
    if (Y !== null) {
      if (e[Y] !== void 0) return e[Y];
      console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '" + Y + "'");
    }
    var ye = ee;
    return ee === 6403 && (Me === 5126 && (ye = 33326), Me === 5131 && (ye = 33325), Me === 5121 && (ye = 33321)), ee === 6407 && (Me === 5126 && (ye = 34837), Me === 5131 && (ye = 34843), Me === 5121 && (ye = 32849)), ee === 6408 && (Me === 5126 && (ye = 34836), Me === 5131 && (ye = 34842), Me === 5121 && (ye = 32856)), ye === 33325 || ye === 33326 || ye === 34842 || ye === 34836 ? t.get("EXT_color_buffer_float") : (ye === 34843 || ye === 34837) && console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."), ye;
  }
  function M(Y) {
    return Y === Or || Y === yp || Y === bp ? 9728 : 9729;
  }
  function k(Y) {
    var ee = Y.target;
    ee.removeEventListener("dispose", k), S(ee), ee.isVideoTexture && h.delete(ee), s.memory.textures--;
  }
  function E(Y) {
    var ee = Y.target;
    ee.removeEventListener("dispose", E), F(ee), s.memory.textures--;
  }
  function S(Y) {
    var ee = n.get(Y);
    ee.__webglInit !== void 0 && (e.deleteTexture(ee.__webglTexture), n.remove(Y));
  }
  function F(Y) {
    var ee = n.get(Y), Me = n.get(Y.texture);
    if (Y) {
      if (Me.__webglTexture !== void 0 && e.deleteTexture(Me.__webglTexture), Y.depthTexture && Y.depthTexture.dispose(), Y.isWebGLCubeRenderTarget)
        for (var ye = 0; ye < 6; ye++)
          e.deleteFramebuffer(ee.__webglFramebuffer[ye]), ee.__webglDepthbuffer && e.deleteRenderbuffer(ee.__webglDepthbuffer[ye]);
      else
        e.deleteFramebuffer(ee.__webglFramebuffer), ee.__webglDepthbuffer && e.deleteRenderbuffer(ee.__webglDepthbuffer);
      if (Y.isWebGLMultiviewRenderTarget) {
        e.deleteTexture(ee.__webglColorTexture), e.deleteTexture(ee.__webglDepthStencilTexture), s.memory.textures -= 2;
        for (var ye = 0, De = ee.__webglViewFramebuffers.length; ye < De; ye++)
          e.deleteFramebuffer(ee.__webglViewFramebuffers[ye]);
      }
      n.remove(Y.texture), n.remove(Y);
    }
  }
  var O = 0;
  function D() {
    O = 0;
  }
  function _() {
    var Y = O;
    return Y >= u && console.warn("THREE.WebGLTextures: Trying to use " + Y + " texture units while this GPU supports only " + u), O += 1, Y;
  }
  function L(Y, ee) {
    var Me = n.get(Y);
    if (Y.isVideoTexture && ve(Y), Y.version > 0 && Me.__version !== Y.version) {
      var ye = Y.image;
      if (ye === void 0)
        console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");
      else if (ye.complete === !1)
        console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");
      else {
        W(Me, Y, ee);
        return;
      }
    }
    r.activeTexture(33984 + ee), r.bindTexture(3553, Me.__webglTexture);
  }
  function G(Y, ee) {
    var Me = n.get(Y);
    if (Y.version > 0 && Me.__version !== Y.version) {
      W(Me, Y, ee);
      return;
    }
    r.activeTexture(33984 + ee), r.bindTexture(35866, Me.__webglTexture);
  }
  function V(Y, ee) {
    var Me = n.get(Y);
    if (Y.version > 0 && Me.__version !== Y.version) {
      W(Me, Y, ee);
      return;
    }
    r.activeTexture(33984 + ee), r.bindTexture(32879, Me.__webglTexture);
  }
  function H(Y, ee) {
    if (Y.image.length === 6) {
      var Me = n.get(Y);
      if (Y.version > 0 && Me.__version !== Y.version) {
        Z(Me, Y), r.activeTexture(33984 + ee), r.bindTexture(34067, Me.__webglTexture), e.pixelStorei(37440, Y.flipY);
        for (var ye = Y && (Y.isCompressedTexture || Y.image[0].isCompressedTexture), De = Y.image[0] && Y.image[0].isDataTexture, Se = [], fe = 0; fe < 6; fe++)
          !ye && !De ? Se[fe] = m(Y.image[fe], !1, !0, l) : Se[fe] = De ? Y.image[fe].image : Y.image[fe];
        var ke = Se[0], ne = p(ke) || o, Te = a.convert(Y.format), I = a.convert(Y.type), A = b(Y.internalFormat, Te, I);
        C(34067, Y, ne);
        var T;
        if (ye) {
          for (var fe = 0; fe < 6; fe++) {
            T = Se[fe].mipmaps;
            for (var P = 0; P < T.length; P++) {
              var z = T[P];
              Y.format !== _i && Y.format !== gs ? Te !== null ? r.compressedTexImage2D(34069 + fe, P, A, z.width, z.height, 0, z.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()") : r.texImage2D(34069 + fe, P, A, z.width, z.height, 0, Te, I, z.data);
            }
          }
          Me.__maxMipLevel = T.length - 1;
        } else {
          T = Y.mipmaps;
          for (var fe = 0; fe < 6; fe++)
            if (De) {
              r.texImage2D(34069 + fe, 0, A, Se[fe].width, Se[fe].height, 0, Te, I, Se[fe].data);
              for (var P = 0; P < T.length; P++) {
                var z = T[P], K = z.image[fe].image;
                r.texImage2D(34069 + fe, P + 1, A, K.width, K.height, 0, Te, I, K.data);
              }
            } else {
              r.texImage2D(34069 + fe, 0, A, Te, I, Se[fe]);
              for (var P = 0; P < T.length; P++) {
                var z = T[P];
                r.texImage2D(34069 + fe, P + 1, A, Te, I, z.image[fe]);
              }
            }
          Me.__maxMipLevel = T.length;
        }
        w(Y, ne) && x(34067, Y, ke.width, ke.height), Me.__version = Y.version, Y.onUpdate && Y.onUpdate(Y);
      } else
        r.activeTexture(33984 + ee), r.bindTexture(34067, Me.__webglTexture);
    }
  }
  function U(Y, ee) {
    r.activeTexture(33984 + ee), r.bindTexture(34067, n.get(Y).__webglTexture);
  }
  var R = {
    [rf]: 10497,
    [Mn]: 33071,
    [nf]: 33648
  }, B = {
    [Or]: 9728,
    [yp]: 9984,
    [bp]: 9986,
    [Vr]: 9729,
    [pb]: 9985,
    [xl]: 9987
  };
  function C(Y, ee, Me) {
    Me ? (e.texParameteri(Y, 10242, R[ee.wrapS]), e.texParameteri(Y, 10243, R[ee.wrapT]), (Y === 32879 || Y === 35866) && e.texParameteri(Y, 32882, R[ee.wrapR]), e.texParameteri(Y, 10240, B[ee.magFilter]), e.texParameteri(Y, 10241, B[ee.minFilter])) : (e.texParameteri(Y, 10242, 33071), e.texParameteri(Y, 10243, 33071), (Y === 32879 || Y === 35866) && e.texParameteri(Y, 32882, 33071), (ee.wrapS !== Mn || ee.wrapT !== Mn) && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."), e.texParameteri(Y, 10240, M(ee.magFilter)), e.texParameteri(Y, 10241, M(ee.minFilter)), ee.minFilter !== Or && ee.minFilter !== Vr && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));
    var ye = t.get("EXT_texture_filter_anisotropic");
    if (ye) {
      if (ee.type === Pu && t.get("OES_texture_float_linear") === null || ee.type === p0 && (o || t.get("OES_texture_half_float_linear")) === null) return;
      (ee.anisotropy > 1 || n.get(ee).__currentAnisotropy) && (e.texParameterf(Y, ye.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(ee.anisotropy, i.getMaxAnisotropy())), n.get(ee).__currentAnisotropy = ee.anisotropy);
    }
  }
  function Z(Y, ee) {
    Y.__webglInit === void 0 && (Y.__webglInit = !0, ee.addEventListener("dispose", k), Y.__webglTexture = e.createTexture(), s.memory.textures++);
  }
  function W(Y, ee, Me) {
    var ye = 3553;
    ee.isDataTexture2DArray && (ye = 35866), ee.isDataTexture3D && (ye = 32879), Z(Y, ee), r.activeTexture(33984 + Me), r.bindTexture(ye, Y.__webglTexture), e.pixelStorei(37440, ee.flipY), e.pixelStorei(37441, ee.premultiplyAlpha), e.pixelStorei(3317, ee.unpackAlignment);
    var De = y(ee) && p(ee.image) === !1, Se = m(ee.image, De, !1, c), fe = p(Se) || o, ke = a.convert(ee.format), ne = a.convert(ee.type), Te = b(ee.internalFormat, ke, ne);
    C(ye, ee, fe);
    var I, A = ee.mipmaps;
    if (ee.isDepthTexture) {
      if (Te = 6402, ee.type === Pu) {
        if (o === !1) throw new Error("Float Depth Texture only supported in WebGL2.0");
        Te = 36012;
      } else o && (Te = 33189);
      ee.format === yo && Te === 6402 && ee.type !== af && ee.type !== vb && (console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."), ee.type = af, ne = a.convert(ee.type)), ee.format === Bu && (Te = 34041, ee.type !== sf && (console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."), ee.type = sf, ne = a.convert(ee.type))), r.texImage2D(3553, 0, Te, Se.width, Se.height, 0, ke, ne, null);
    } else if (ee.isDataTexture)
      if (A.length > 0 && fe) {
        for (var T = 0, P = A.length; T < P; T++)
          I = A[T], r.texImage2D(3553, T, Te, I.width, I.height, 0, ke, ne, I.data);
        ee.generateMipmaps = !1, Y.__maxMipLevel = A.length - 1;
      } else
        r.texImage2D(3553, 0, Te, Se.width, Se.height, 0, ke, ne, Se.data), Y.__maxMipLevel = 0;
    else if (ee.isCompressedTexture) {
      for (var T = 0, P = A.length; T < P; T++)
        I = A[T], ee.format !== _i && ee.format !== gs ? ke !== null ? r.compressedTexImage2D(3553, T, Te, I.width, I.height, 0, I.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : r.texImage2D(3553, T, Te, I.width, I.height, 0, ke, ne, I.data);
      Y.__maxMipLevel = A.length - 1;
    } else if (ee.isDataTexture2DArray)
      r.texImage3D(35866, 0, Te, Se.width, Se.height, Se.depth, 0, ke, ne, Se.data), Y.__maxMipLevel = 0;
    else if (ee.isDataTexture3D)
      r.texImage3D(32879, 0, Te, Se.width, Se.height, Se.depth, 0, ke, ne, Se.data), Y.__maxMipLevel = 0;
    else if (A.length > 0 && fe) {
      for (var T = 0, P = A.length; T < P; T++)
        I = A[T], r.texImage2D(3553, T, Te, ke, ne, I);
      ee.generateMipmaps = !1, Y.__maxMipLevel = A.length - 1;
    } else
      r.texImage2D(3553, 0, Te, ke, ne, Se), Y.__maxMipLevel = 0;
    w(ee, fe) && x(ye, ee, Se.width, Se.height), Y.__version = ee.version, ee.onUpdate && ee.onUpdate(ee);
  }
  function J(Y, ee, Me, ye) {
    var De = a.convert(ee.texture.format), Se = a.convert(ee.texture.type), fe = b(ee.texture.internalFormat, De, Se);
    r.texImage2D(ye, 0, fe, ee.width, ee.height, 0, De, Se, null), e.bindFramebuffer(36160, Y), e.framebufferTexture2D(36160, Me, ye, n.get(ee.texture).__webglTexture, 0), e.bindFramebuffer(36160, null);
  }
  function Q(Y, ee, Me) {
    if (e.bindRenderbuffer(36161, Y), ee.depthBuffer && !ee.stencilBuffer) {
      if (Me) {
        var ye = se(ee);
        e.renderbufferStorageMultisample(36161, ye, 33189, ee.width, ee.height);
      } else
        e.renderbufferStorage(36161, 33189, ee.width, ee.height);
      e.framebufferRenderbuffer(36160, 36096, 36161, Y);
    } else if (ee.depthBuffer && ee.stencilBuffer) {
      if (Me) {
        var ye = se(ee);
        e.renderbufferStorageMultisample(36161, ye, 35056, ee.width, ee.height);
      } else
        e.renderbufferStorage(36161, 34041, ee.width, ee.height);
      e.framebufferRenderbuffer(36160, 33306, 36161, Y);
    } else {
      var De = a.convert(ee.texture.format), Se = a.convert(ee.texture.type), fe = b(ee.texture.internalFormat, De, Se);
      if (Me) {
        var ye = se(ee);
        e.renderbufferStorageMultisample(36161, ye, fe, ee.width, ee.height);
      } else
        e.renderbufferStorage(36161, fe, ee.width, ee.height);
    }
    e.bindRenderbuffer(36161, null);
  }
  function j(Y, ee) {
    var Me = ee && ee.isWebGLCubeRenderTarget;
    if (Me) throw new Error("Depth Texture with cube render targets is not supported");
    if (e.bindFramebuffer(36160, Y), !(ee.depthTexture && ee.depthTexture.isDepthTexture))
      throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
    (!n.get(ee.depthTexture).__webglTexture || ee.depthTexture.image.width !== ee.width || ee.depthTexture.image.height !== ee.height) && (ee.depthTexture.image.width = ee.width, ee.depthTexture.image.height = ee.height, ee.depthTexture.needsUpdate = !0), L(ee.depthTexture, 0);
    var ye = n.get(ee.depthTexture).__webglTexture;
    if (ee.depthTexture.format === yo)
      e.framebufferTexture2D(36160, 36096, 3553, ye, 0);
    else if (ee.depthTexture.format === Bu)
      e.framebufferTexture2D(36160, 33306, 3553, ye, 0);
    else
      throw new Error("Unknown depthTexture format");
  }
  function q(Y) {
    var ee = n.get(Y), Me = Y.isWebGLCubeRenderTarget === !0;
    if (Y.depthTexture) {
      if (Me) throw new Error("target.depthTexture not supported in Cube render targets");
      j(ee.__webglFramebuffer, Y);
    } else if (Me) {
      ee.__webglDepthbuffer = [];
      for (var ye = 0; ye < 6; ye++)
        e.bindFramebuffer(36160, ee.__webglFramebuffer[ye]), ee.__webglDepthbuffer[ye] = e.createRenderbuffer(), Q(ee.__webglDepthbuffer[ye], Y);
    } else
      e.bindFramebuffer(36160, ee.__webglFramebuffer), ee.__webglDepthbuffer = e.createRenderbuffer(), Q(ee.__webglDepthbuffer, Y);
    e.bindFramebuffer(36160, null);
  }
  function ae(Y) {
    var ee = n.get(Y), Me = n.get(Y.texture);
    Y.addEventListener("dispose", E), Me.__webglTexture = e.createTexture(), s.memory.textures++;
    var ye = Y.isWebGLCubeRenderTarget === !0, De = Y.isWebGLMultisampleRenderTarget === !0, Se = Y.isWebGLMultiviewRenderTarget === !0, fe = p(Y) || o;
    if (ye) {
      ee.__webglFramebuffer = [];
      for (var ke = 0; ke < 6; ke++)
        ee.__webglFramebuffer[ke] = e.createFramebuffer();
    } else if (ee.__webglFramebuffer = e.createFramebuffer(), De)
      if (o) {
        ee.__webglMultisampledFramebuffer = e.createFramebuffer(), ee.__webglColorRenderbuffer = e.createRenderbuffer(), e.bindRenderbuffer(36161, ee.__webglColorRenderbuffer);
        var ne = a.convert(Y.texture.format), Te = a.convert(Y.texture.type), I = b(Y.texture.internalFormat, ne, Te), A = se(Y);
        e.renderbufferStorageMultisample(36161, A, I, Y.width, Y.height), e.bindFramebuffer(36160, ee.__webglMultisampledFramebuffer), e.framebufferRenderbuffer(36160, 36064, 36161, ee.__webglColorRenderbuffer), e.bindRenderbuffer(36161, null), Y.depthBuffer && (ee.__webglDepthRenderbuffer = e.createRenderbuffer(), Q(ee.__webglDepthRenderbuffer, Y, !0)), e.bindFramebuffer(36160, null);
      } else
        console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");
    else if (Se) {
      var T = Y.width, P = Y.height, z = Y.numViews;
      e.bindFramebuffer(36160, ee.__webglFramebuffer);
      var K = t.get("OVR_multiview2");
      s.memory.textures += 2;
      var oe = e.createTexture();
      e.bindTexture(35866, oe), e.texParameteri(35866, 10240, 9728), e.texParameteri(35866, 10241, 9728), e.texImage3D(35866, 0, 32856, T, P, z, 0, 6408, 5121, null), K.framebufferTextureMultiviewOVR(36160, 36064, oe, 0, 0, z);
      var ce = e.createTexture();
      e.bindTexture(35866, ce), e.texParameteri(35866, 10240, 9728), e.texParameteri(35866, 10241, 9728), e.texImage3D(35866, 0, 35056, T, P, z, 0, 34041, 34042, null), K.framebufferTextureMultiviewOVR(36160, 33306, ce, 0, 0, z);
      for (var ge = new Array(z), ke = 0; ke < z; ++ke)
        ge[ke] = e.createFramebuffer(), e.bindFramebuffer(36160, ge[ke]), e.framebufferTextureLayer(36160, 36064, oe, 0, ke);
      ee.__webglColorTexture = oe, ee.__webglDepthStencilTexture = ce, ee.__webglViewFramebuffers = ge, e.bindFramebuffer(36160, null), e.bindTexture(35866, null);
    }
    if (ye) {
      r.bindTexture(34067, Me.__webglTexture), C(34067, Y.texture, fe);
      for (var ke = 0; ke < 6; ke++)
        J(ee.__webglFramebuffer[ke], Y, 36064, 34069 + ke);
      w(Y.texture, fe) && x(34067, Y.texture, Y.width, Y.height), r.bindTexture(34067, null);
    } else Se || (r.bindTexture(3553, Me.__webglTexture), C(3553, Y.texture, fe), J(ee.__webglFramebuffer, Y, 36064, 3553), w(Y.texture, fe) && x(3553, Y.texture, Y.width, Y.height), r.bindTexture(3553, null));
    Y.depthBuffer && q(Y);
  }
  function pe(Y) {
    var ee = Y.texture, Me = p(Y) || o;
    if (w(ee, Me)) {
      var ye = Y.isWebGLCubeRenderTarget ? 34067 : 3553, De = n.get(ee).__webglTexture;
      r.bindTexture(ye, De), x(ye, ee, Y.width, Y.height), r.bindTexture(ye, null);
    }
  }
  function $(Y) {
    if (Y.isWebGLMultisampleRenderTarget)
      if (o) {
        var ee = n.get(Y);
        e.bindFramebuffer(36008, ee.__webglMultisampledFramebuffer), e.bindFramebuffer(36009, ee.__webglFramebuffer);
        var Me = Y.width, ye = Y.height, De = 16384;
        Y.depthBuffer && (De |= 256), Y.stencilBuffer && (De |= 1024), e.blitFramebuffer(0, 0, Me, ye, 0, 0, Me, ye, De, 9728);
      } else
        console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");
  }
  function se(Y) {
    return o && Y.isWebGLMultisampleRenderTarget ? Math.min(f, Y.samples) : 0;
  }
  function ve(Y) {
    var ee = s.render.frame;
    h.get(Y) !== ee && (h.set(Y, ee), Y.update());
  }
  var me = !1, Ae = !1;
  function Ce(Y, ee) {
    Y && Y.isWebGLRenderTarget && (me === !1 && (console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."), me = !0), Y = Y.texture), L(Y, ee);
  }
  function Ee(Y, ee) {
    Y && Y.isWebGLCubeRenderTarget && (Ae === !1 && (console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."), Ae = !0), Y = Y.texture), Y && Y.isCubeTexture || Array.isArray(Y.image) && Y.image.length === 6 ? H(Y, ee) : U(Y, ee);
  }
  this.allocateTextureUnit = _, this.resetTextureUnits = D, this.setTexture2D = L, this.setTexture2DArray = G, this.setTexture3D = V, this.setTextureCube = H, this.setTextureCubeDynamic = U, this.setupRenderTarget = ae, this.updateRenderTargetMipmap = pe, this.updateMultisampleRenderTarget = $, this.safeSetTexture2D = Ce, this.safeSetTextureCube = Ee;
}
function V6(e, t, r) {
  var n = r.isWebGL2;
  function i(a) {
    var s;
    if (a === ah) return 5121;
    if (a === eA) return 32819;
    if (a === tA) return 32820;
    if (a === rA) return 33635;
    if (a === ZE) return 5120;
    if (a === JE) return 5122;
    if (a === af) return 5123;
    if (a === QE) return 5124;
    if (a === vb) return 5125;
    if (a === Pu) return 5126;
    if (a === p0)
      return n ? 5131 : (s = t.get("OES_texture_half_float"), s !== null ? s.HALF_FLOAT_OES : null);
    if (a === nA) return 6406;
    if (a === gs) return 6407;
    if (a === _i) return 6408;
    if (a === iA) return 6409;
    if (a === aA) return 6410;
    if (a === yo) return 6402;
    if (a === Bu) return 34041;
    if (a === oA) return 6403;
    if (a === uA) return 36244;
    if (a === lA) return 33319;
    if (a === cA) return 33320;
    if (a === fA) return 36248;
    if (a === hA) return 36249;
    if (a === og || a === ug || a === lg || a === cg)
      if (s = t.get("WEBGL_compressed_texture_s3tc"), s !== null) {
        if (a === og) return s.COMPRESSED_RGB_S3TC_DXT1_EXT;
        if (a === ug) return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;
        if (a === lg) return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;
        if (a === cg) return s.COMPRESSED_RGBA_S3TC_DXT5_EXT;
      } else
        return null;
    if (a === fg || a === hg || a === dg || a === pg)
      if (s = t.get("WEBGL_compressed_texture_pvrtc"), s !== null) {
        if (a === fg) return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
        if (a === hg) return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
        if (a === dg) return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
        if (a === pg) return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;
      } else
        return null;
    if (a === dA)
      return s = t.get("WEBGL_compressed_texture_etc1"), s !== null ? s.COMPRESSED_RGB_ETC1_WEBGL : null;
    if (a === pA || a === vA || a === mA || a === gA || a === yA || a === bA || a === wA || a === xA || a === MA || a === EA || a === AA || a === TA || a === SA || a === kA)
      return s = t.get("WEBGL_compressed_texture_astc"), s !== null ? a : null;
    if (a === sf)
      return n ? 34042 : (s = t.get("WEBGL_depth_texture"), s !== null ? s.UNSIGNED_INT_24_8_WEBGL : null);
  }
  return { convert: i };
}
function kp(e, t, r, n) {
  vn.call(this, e, t, n), this.depthBuffer = !1, this.stencilBuffer = !1, this.numViews = r;
}
kp.prototype = Object.assign(Object.create(vn.prototype), {
  constructor: kp,
  isWebGLMultiviewRenderTarget: !0,
  copy: function(e) {
    return vn.prototype.copy.call(this, e), this.numViews = e.numViews, this;
  },
  setNumViews: function(e) {
    return this.numViews !== e && (this.numViews = e, this.dispose()), this;
  }
});
function H6(e, t) {
  var r = 2, n = e.extensions, i = e.properties, a, s, o, u, l, c, f, h = 0;
  function d() {
    if (f === void 0) {
      var k = n.get("OVR_multiview2");
      if (f = k !== null && t.getContextAttributes().antialias === !1, f) {
        h = t.getParameter(k.MAX_VIEWS_OVR), a = new kp(0, 0, r), c = new _e(), u = [], o = [], l = [];
        for (var E = 0; E < h; E++)
          u[E] = new Nt(), o[E] = new an();
      }
    }
    return f;
  }
  function g(k) {
    return k.isArrayCamera ? k.cameras : (l[0] = k, l);
  }
  function v(k, E) {
    for (var S = g(k), F = 0; F < S.length; F++)
      u[F].copy(S[F].projectionMatrix);
    E.setValue(t, "projectionMatrices", u);
  }
  function m(k, E) {
    for (var S = g(k), F = 0; F < S.length; F++)
      u[F].copy(S[F].matrixWorldInverse);
    E.setValue(t, "viewMatrices", u);
  }
  function p(k, E, S) {
    for (var F = g(E), O = 0; O < F.length; O++)
      u[O].multiplyMatrices(F[O].matrixWorldInverse, k.matrixWorld), o[O].getNormalMatrix(u[O]);
    S.setValue(t, "modelViewMatrices", u), S.setValue(t, "normalMatrices", o);
  }
  function y(k) {
    if (k.isArrayCamera === void 0) return !0;
    var E = k.cameras;
    if (E.length > h) return !1;
    for (var S = 1, F = E.length; S < F; S++)
      if (E[0].viewport.z !== E[S].viewport.z || E[0].viewport.w !== E[S].viewport.w) return !1;
    return !0;
  }
  function w(k) {
    if (s ? c.set(s.width, s.height) : e.getDrawingBufferSize(c), k.isArrayCamera) {
      var E = k.cameras[0].viewport;
      a.setSize(E.z, E.w), a.setNumViews(k.cameras.length);
    } else
      a.setSize(c.x, c.y), a.setNumViews(r);
  }
  function x(k) {
    y(k) !== !1 && (s = e.getRenderTarget(), w(k), e.setRenderTarget(a));
  }
  function b(k) {
    a === e.getRenderTarget() && (e.setRenderTarget(s), M(k));
  }
  function M(k) {
    var E = a, S = E.numViews, F = i.get(E).__webglViewFramebuffers, O = E.width, D = E.height;
    if (k.isArrayCamera)
      for (var _ = 0; _ < S; _++) {
        var L = k.cameras[_].viewport, G = L.x, V = L.y, H = G + L.z, U = V + L.w;
        t.bindFramebuffer(36008, F[_]), t.blitFramebuffer(0, 0, O, D, G, V, H, U, 16384, 9728);
      }
    else
      t.bindFramebuffer(36008, F[0]), t.blitFramebuffer(0, 0, O, D, 0, 0, c.x, c.y, 16384, 9728);
  }
  this.isAvailable = d, this.attachCamera = x, this.detachCamera = b, this.updateCameraProjectionMatricesUniform = v, this.updateCameraViewMatricesUniform = m, this.updateObjectMatricesUniforms = p;
}
function Cp(e) {
  Wr.call(this), this.cameras = e || [];
}
Cp.prototype = Object.assign(Object.create(Wr.prototype), {
  constructor: Cp,
  isArrayCamera: !0
});
function Uu() {
  et.call(this), this.type = "Group";
}
Uu.prototype = Object.assign(Object.create(et.prototype), {
  constructor: Uu,
  isGroup: !0
});
function Lb(e, t) {
  var r = this, n = null, i = null, a = "local-floor", s = null, o = [], u = /* @__PURE__ */ new Map(), l = new Wr();
  l.layers.enable(1), l.viewport = new or();
  var c = new Wr();
  c.layers.enable(2), c.viewport = new or();
  var f = new Cp([l, c]);
  f.layers.enable(1), f.layers.enable(2);
  var h = null, d = null;
  this.enabled = !1, this.isPresenting = !1, this.getController = function(S) {
    var F = o[S];
    return F === void 0 && (F = {}, o[S] = F), F.targetRay === void 0 && (F.targetRay = new Uu(), F.targetRay.matrixAutoUpdate = !1, F.targetRay.visible = !1), F.targetRay;
  }, this.getControllerGrip = function(S) {
    var F = o[S];
    return F === void 0 && (F = {}, o[S] = F), F.grip === void 0 && (F.grip = new Uu(), F.grip.matrixAutoUpdate = !1, F.grip.visible = !1), F.grip;
  };
  function g(S) {
    var F = u.get(S.inputSource);
    F && (F.targetRay && F.targetRay.dispatchEvent({ type: S.type }), F.grip && F.grip.dispatchEvent({ type: S.type }));
  }
  function v() {
    u.forEach(function(S, F) {
      S.targetRay && (S.targetRay.dispatchEvent({ type: "disconnected", data: F }), S.targetRay.visible = !1), S.grip && (S.grip.dispatchEvent({ type: "disconnected", data: F }), S.grip.visible = !1);
    }), u.clear(), e.setFramebuffer(null), e.setRenderTarget(e.getRenderTarget()), E.stop(), r.isPresenting = !1, r.dispatchEvent({ type: "sessionend" });
  }
  function m(S) {
    i = S, E.setContext(n), E.start(), r.isPresenting = !0, r.dispatchEvent({ type: "sessionstart" });
  }
  this.setFramebufferScaleFactor = function() {
  }, this.setReferenceSpaceType = function(S) {
    a = S;
  }, this.getReferenceSpace = function() {
    return i;
  }, this.getSession = function() {
    return n;
  }, this.setSession = function(S) {
    if (n = S, n !== null) {
      n.addEventListener("select", g), n.addEventListener("selectstart", g), n.addEventListener("selectend", g), n.addEventListener("squeeze", g), n.addEventListener("squeezestart", g), n.addEventListener("squeezeend", g), n.addEventListener("end", v);
      var F = t.getContextAttributes(), O = {
        antialias: F.antialias,
        alpha: F.alpha,
        depth: F.depth,
        stencil: F.stencil
      }, D = new XRWebGLLayer(n, t, O);
      n.updateRenderState({ baseLayer: D }), n.requestReferenceSpace(a).then(m), n.addEventListener("inputsourceschange", p);
    }
  };
  function p(S) {
    for (var F = n.inputSources, O = 0; O < o.length; O++)
      u.set(F[O], o[O]);
    for (var O = 0; O < S.removed.length; O++) {
      var D = S.removed[O], _ = u.get(D);
      _ && (_.targetRay && _.targetRay.dispatchEvent({ type: "disconnected", data: D }), _.grip && _.grip.dispatchEvent({ type: "disconnected", data: D }), u.delete(D));
    }
    for (var O = 0; O < S.added.length; O++) {
      var D = S.added[O], _ = u.get(D);
      _ && (_.targetRay && _.targetRay.dispatchEvent({ type: "connected", data: D }), _.grip && _.grip.dispatchEvent({ type: "connected", data: D }));
    }
  }
  var y = new re(), w = new re();
  function x(S, F, O) {
    y.setFromMatrixPosition(F.matrixWorld), w.setFromMatrixPosition(O.matrixWorld);
    var D = y.distanceTo(w), _ = F.projectionMatrix.elements, L = O.projectionMatrix.elements, G = _[14] / (_[10] - 1), V = _[14] / (_[10] + 1), H = (_[9] + 1) / _[5], U = (_[9] - 1) / _[5], R = (_[8] - 1) / _[0], B = (L[8] + 1) / L[0], C = G * R, Z = G * B, W = D / (-R + B), J = W * -R;
    F.matrixWorld.decompose(S.position, S.quaternion, S.scale), S.translateX(J), S.translateZ(W), S.matrixWorld.compose(S.position, S.quaternion, S.scale), S.matrixWorldInverse.getInverse(S.matrixWorld);
    var Q = G + W, j = V + W, q = C - J, ae = Z + (D - J), pe = H * V / j * Q, $ = U * V / j * Q;
    S.projectionMatrix.makePerspective(q, ae, pe, $, Q, j);
  }
  function b(S, F) {
    F === null ? S.matrixWorld.copy(S.matrix) : S.matrixWorld.multiplyMatrices(F.matrixWorld, S.matrix), S.matrixWorldInverse.getInverse(S.matrixWorld);
  }
  this.getCamera = function(S) {
    f.near = c.near = l.near = S.near, f.far = c.far = l.far = S.far, (h !== f.near || d !== f.far) && (n.updateRenderState({
      depthNear: f.near,
      depthFar: f.far
    }), h = f.near, d = f.far);
    var F = S.parent, O = f.cameras;
    b(f, F);
    for (var D = 0; D < O.length; D++)
      b(O[D], F);
    S.matrixWorld.copy(f.matrixWorld);
    for (var _ = S.children, D = 0, L = _.length; D < L; D++)
      _[D].updateMatrixWorld(!0);
    return x(f, l, c), f;
  };
  var M = null;
  function k(S, F) {
    if (s = F.getViewerPose(i), s !== null) {
      var O = s.views, D = n.renderState.baseLayer;
      e.setFramebuffer(D.framebuffer);
      for (var _ = 0; _ < O.length; _++) {
        var L = O[_], G = D.getViewport(L), V = f.cameras[_];
        V.matrix.fromArray(L.transform.matrix), V.projectionMatrix.fromArray(L.projectionMatrix), V.viewport.set(G.x, G.y, G.width, G.height), _ === 0 && f.matrix.copy(V.matrix);
      }
    }
    for (var H = n.inputSources, _ = 0; _ < o.length; _++) {
      var U = o[_], R = H[_], B = null, C = null;
      R && (U.targetRay && (B = F.getPose(R.targetRaySpace, i), B !== null && (U.targetRay.matrix.fromArray(B.transform.matrix), U.targetRay.matrix.decompose(U.targetRay.position, U.targetRay.rotation, U.targetRay.scale))), U.grip && R.gripSpace && (C = F.getPose(R.gripSpace, i), C !== null && (U.grip.matrix.fromArray(C.transform.matrix), U.grip.matrix.decompose(U.grip.position, U.grip.rotation, U.grip.scale)))), U.targetRay && (U.targetRay.visible = B !== null), U.grip && (U.grip.visible = C !== null);
    }
    M && M(S, F);
  }
  var E = new Tb();
  E.setAnimationLoop(k), this.setAnimationLoop = function(S) {
    M = S;
  }, this.dispose = function() {
  };
}
Object.assign(Lb.prototype, ha.prototype);
function Fb(e) {
  e = e || {};
  var t = e.canvas !== void 0 ? e.canvas : document.createElementNS("http://www.w3.org/1999/xhtml", "canvas"), r = e.context !== void 0 ? e.context : null, n = e.alpha !== void 0 ? e.alpha : !1, i = e.depth !== void 0 ? e.depth : !0, a = e.stencil !== void 0 ? e.stencil : !0, s = e.antialias !== void 0 ? e.antialias : !1, o = e.premultipliedAlpha !== void 0 ? e.premultipliedAlpha : !0, u = e.preserveDrawingBuffer !== void 0 ? e.preserveDrawingBuffer : !1, l = e.powerPreference !== void 0 ? e.powerPreference : "default", c = e.failIfMajorPerformanceCaveat !== void 0 ? e.failIfMajorPerformanceCaveat : !1, f = null, h = null;
  this.domElement = t, this.debug = {
    /**
     * Enables error checking and reporting when shader programs are being compiled
     * @type {boolean}
     */
    checkShaderErrors: !0
  }, this.autoClear = !0, this.autoClearColor = !0, this.autoClearDepth = !0, this.autoClearStencil = !0, this.sortObjects = !0, this.clippingPlanes = [], this.localClippingEnabled = !1, this.gammaFactor = 2, this.outputEncoding = Pn, this.physicallyCorrectLights = !1, this.toneMapping = u0, this.toneMappingExposure = 1, this.toneMappingWhitePoint = 1, this.maxMorphTargets = 8, this.maxMorphNormals = 4;
  var d = this, g = !1, v = null, m = 0, p = 0, y = null, w = null, x = -1, b = {
    geometry: null,
    program: null,
    wireframe: !1
  }, M = null, k = null, E = new or(), S = new or(), F = null, O = t.width, D = t.height, _ = 1, L = null, G = null, V = new or(0, 0, O, D), H = new or(0, 0, O, D), U = !1, R = new Ml(), B = new AS(), C = !1, Z = !1, W = new Nt(), J = new re();
  function Q() {
    return y === null ? _ : 1;
  }
  var j;
  try {
    var q = {
      alpha: n,
      depth: i,
      stencil: a,
      antialias: s,
      premultipliedAlpha: o,
      preserveDrawingBuffer: u,
      powerPreference: l,
      failIfMajorPerformanceCaveat: c,
      xrCompatible: !0
    };
    if (t.addEventListener("webglcontextlost", T, !1), t.addEventListener("webglcontextrestored", P, !1), j = r || t.getContext("webgl", q) || t.getContext("experimental-webgl", q), j === null)
      throw t.getContext("webgl") !== null ? new Error("Error creating WebGL context with your selected attributes.") : new Error("Error creating WebGL context.");
    j.getShaderPrecisionFormat === void 0 && (j.getShaderPrecisionFormat = function() {
      return { rangeMin: 1, rangeMax: 1, precision: 1 };
    });
  } catch (N) {
    throw console.error("THREE.WebGLRenderer: " + N.message), N;
  }
  var ae, pe, $, se, ve, me, Ae, Ce, Ee, Y, ee, Me, ye, De, Se, fe, ke;
  function ne() {
    ae = new TS(j), pe = new ES(j, ae, e), pe.isWebGL2 === !1 && (ae.get("WEBGL_depth_texture"), ae.get("OES_texture_float"), ae.get("OES_texture_half_float"), ae.get("OES_texture_half_float_linear"), ae.get("OES_standard_derivatives"), ae.get("OES_element_index_uint"), ae.get("ANGLE_instanced_arrays")), ae.get("OES_texture_float_linear"), ke = new V6(j, ae, pe), $ = new z6(j, ae, pe), $.scissor(S.copy(H).multiplyScalar(_).floor()), $.viewport(E.copy(V).multiplyScalar(_).floor()), se = new CS(), ve = new _6(), me = new W6(j, ae, $, ve, pe, ke, se), Ae = new t4(j, pe), Ce = new SS(j, Ae, se), Ee = new PS(j, Ce, Ae, se), De = new _S(j), Y = new D6(d, ae, pe), ee = new L6(), Me = new N6(), ye = new xS(d, $, Ee, o), Se = new MS(j, ae, se, pe), fe = new kS(j, ae, se, pe), se.programs = Y.programs, d.capabilities = pe, d.extensions = ae, d.properties = ve, d.renderLists = ee, d.state = $, d.info = se;
  }
  ne();
  var Te = new Lb(d, j);
  this.xr = Te;
  var I = new H6(d, j), A = new Bb(d, Ee, pe.maxTextureSize);
  this.shadowMap = A, this.getContext = function() {
    return j;
  }, this.getContextAttributes = function() {
    return j.getContextAttributes();
  }, this.forceContextLoss = function() {
    var N = ae.get("WEBGL_lose_context");
    N && N.loseContext();
  }, this.forceContextRestore = function() {
    var N = ae.get("WEBGL_lose_context");
    N && N.restoreContext();
  }, this.getPixelRatio = function() {
    return _;
  }, this.setPixelRatio = function(N) {
    N !== void 0 && (_ = N, this.setSize(O, D, !1));
  }, this.getSize = function(N) {
    return N === void 0 && (console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"), N = new _e()), N.set(O, D);
  }, this.setSize = function(N, X, ue) {
    if (Te.isPresenting) {
      console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");
      return;
    }
    O = N, D = X, t.width = Math.floor(N * _), t.height = Math.floor(X * _), ue !== !1 && (t.style.width = N + "px", t.style.height = X + "px"), this.setViewport(0, 0, N, X);
  }, this.getDrawingBufferSize = function(N) {
    return N === void 0 && (console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"), N = new _e()), N.set(O * _, D * _).floor();
  }, this.setDrawingBufferSize = function(N, X, ue) {
    O = N, D = X, _ = ue, t.width = Math.floor(N * ue), t.height = Math.floor(X * ue), this.setViewport(0, 0, N, X);
  }, this.getCurrentViewport = function(N) {
    return N === void 0 && (console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"), N = new or()), N.copy(E);
  }, this.getViewport = function(N) {
    return N.copy(V);
  }, this.setViewport = function(N, X, ue, we) {
    N.isVector4 ? V.set(N.x, N.y, N.z, N.w) : V.set(N, X, ue, we), $.viewport(E.copy(V).multiplyScalar(_).floor());
  }, this.getScissor = function(N) {
    return N.copy(H);
  }, this.setScissor = function(N, X, ue, we) {
    N.isVector4 ? H.set(N.x, N.y, N.z, N.w) : H.set(N, X, ue, we), $.scissor(S.copy(H).multiplyScalar(_).floor());
  }, this.getScissorTest = function() {
    return U;
  }, this.setScissorTest = function(N) {
    $.setScissorTest(U = N);
  }, this.setOpaqueSort = function(N) {
    L = N;
  }, this.setTransparentSort = function(N) {
    G = N;
  }, this.getClearColor = function() {
    return ye.getClearColor();
  }, this.setClearColor = function() {
    ye.setClearColor.apply(ye, arguments);
  }, this.getClearAlpha = function() {
    return ye.getClearAlpha();
  }, this.setClearAlpha = function() {
    ye.setClearAlpha.apply(ye, arguments);
  }, this.clear = function(N, X, ue) {
    var we = 0;
    (N === void 0 || N) && (we |= 16384), (X === void 0 || X) && (we |= 256), (ue === void 0 || ue) && (we |= 1024), j.clear(we);
  }, this.clearColor = function() {
    this.clear(!0, !1, !1);
  }, this.clearDepth = function() {
    this.clear(!1, !0, !1);
  }, this.clearStencil = function() {
    this.clear(!1, !1, !0);
  }, this.dispose = function() {
    t.removeEventListener("webglcontextlost", T, !1), t.removeEventListener("webglcontextrestored", P, !1), ee.dispose(), Me.dispose(), ve.dispose(), Ee.dispose(), Te.dispose(), $e.stop();
  };
  function T(N) {
    N.preventDefault(), console.log("THREE.WebGLRenderer: Context Lost."), g = !0;
  }
  function P() {
    console.log("THREE.WebGLRenderer: Context Restored."), g = !1, ne();
  }
  function z(N) {
    var X = N.target;
    X.removeEventListener("dispose", z), K(X);
  }
  function K(N) {
    oe(N), ve.remove(N);
  }
  function oe(N) {
    var X = ve.get(N).program;
    N.program = void 0, X !== void 0 && Y.releaseProgram(X);
  }
  function ce(N, X) {
    N.render(function(ue) {
      d.renderBufferImmediate(ue, X);
    });
  }
  this.renderBufferImmediate = function(N, X) {
    $.initAttributes();
    var ue = ve.get(N);
    N.hasPositions && !ue.position && (ue.position = j.createBuffer()), N.hasNormals && !ue.normal && (ue.normal = j.createBuffer()), N.hasUvs && !ue.uv && (ue.uv = j.createBuffer()), N.hasColors && !ue.color && (ue.color = j.createBuffer());
    var we = X.getAttributes();
    N.hasPositions && (j.bindBuffer(34962, ue.position), j.bufferData(34962, N.positionArray, 35048), $.enableAttribute(we.position), j.vertexAttribPointer(we.position, 3, 5126, !1, 0, 0)), N.hasNormals && (j.bindBuffer(34962, ue.normal), j.bufferData(34962, N.normalArray, 35048), $.enableAttribute(we.normal), j.vertexAttribPointer(we.normal, 3, 5126, !1, 0, 0)), N.hasUvs && (j.bindBuffer(34962, ue.uv), j.bufferData(34962, N.uvArray, 35048), $.enableAttribute(we.uv), j.vertexAttribPointer(we.uv, 2, 5126, !1, 0, 0)), N.hasColors && (j.bindBuffer(34962, ue.color), j.bufferData(34962, N.colorArray, 35048), $.enableAttribute(we.color), j.vertexAttribPointer(we.color, 3, 5126, !1, 0, 0)), $.disableUnusedAttributes(), j.drawArrays(4, 0, N.count), N.count = 0;
  };
  var ge = new Ra();
  this.renderBufferDirect = function(N, X, ue, we, Le, Ke) {
    X === null && (X = ge);
    var Re = Le.isMesh && Le.matrixWorld.determinant() < 0, at = Vt(N, X, we, Le);
    $.setMaterial(we, Re);
    var Ne = !1;
    (b.geometry !== ue.id || b.program !== at.id || b.wireframe !== (we.wireframe === !0)) && (b.geometry = ue.id, b.program = at.id, b.wireframe = we.wireframe === !0, Ne = !0), (we.morphTargets || we.morphNormals) && (De.update(Le, ue, we, at), Ne = !0);
    var Ye = ue.index, Tt = ue.attributes.position;
    if (Ye === null) {
      if (Tt === void 0 || Tt.count === 0) return;
    } else if (Ye.count === 0)
      return;
    var kt = 1;
    we.wireframe === !0 && (Ye = Ce.getWireframeAttribute(ue), kt = 2);
    var Mt, je = Se;
    Ye !== null && (Mt = Ae.get(Ye), je = fe, je.setIndex(Mt)), Ne && (Oe(Le, ue, we, at), Ye !== null && j.bindBuffer(34963, Mt.buffer));
    var Xe = Ye !== null ? Ye.count : Tt.count, Lt = ue.drawRange.start * kt, Ut = ue.drawRange.count * kt, gr = Ke !== null ? Ke.start * kt : 0, yt = Ke !== null ? Ke.count * kt : 1 / 0, ct = Math.max(Lt, gr), pr = Math.min(Xe, Lt + Ut, gr + yt) - 1, Gr = Math.max(0, pr - ct + 1);
    if (Gr !== 0) {
      if (Le.isMesh)
        we.wireframe === !0 ? ($.setLineWidth(we.wireframeLinewidth * Q()), je.setMode(1)) : je.setMode(4);
      else if (Le.isLine) {
        var yr = we.linewidth;
        yr === void 0 && (yr = 1), $.setLineWidth(yr * Q()), Le.isLineSegments ? je.setMode(1) : Le.isLineLoop ? je.setMode(2) : je.setMode(3);
      } else Le.isPoints ? je.setMode(0) : Le.isSprite && je.setMode(4);
      Le.isInstancedMesh ? je.renderInstances(ue, ct, Gr, Le.count) : ue.isInstancedBufferGeometry ? je.renderInstances(ue, ct, Gr, ue.maxInstancedCount) : je.render(ct, Gr);
    }
  };
  function Oe(N, X, ue, we) {
    if (!(pe.isWebGL2 === !1 && (N.isInstancedMesh || X.isInstancedBufferGeometry) && ae.get("ANGLE_instanced_arrays") === null)) {
      $.initAttributes();
      var Le = X.attributes, Ke = we.getAttributes(), Re = ue.defaultAttributeValues;
      for (var at in Ke) {
        var Ne = Ke[at];
        if (Ne >= 0) {
          var Ye = Le[at];
          if (Ye !== void 0) {
            var Tt = Ye.normalized, kt = Ye.itemSize, Mt = Ae.get(Ye);
            if (Mt === void 0) continue;
            var je = Mt.buffer, Xe = Mt.type, Lt = Mt.bytesPerElement;
            if (Ye.isInterleavedBufferAttribute) {
              var Ut = Ye.data, gr = Ut.stride, yt = Ye.offset;
              Ut && Ut.isInstancedInterleavedBuffer ? ($.enableAttributeAndDivisor(Ne, Ut.meshPerAttribute), X.maxInstancedCount === void 0 && (X.maxInstancedCount = Ut.meshPerAttribute * Ut.count)) : $.enableAttribute(Ne), j.bindBuffer(34962, je), j.vertexAttribPointer(Ne, kt, Xe, Tt, gr * Lt, yt * Lt);
            } else
              Ye.isInstancedBufferAttribute ? ($.enableAttributeAndDivisor(Ne, Ye.meshPerAttribute), X.maxInstancedCount === void 0 && (X.maxInstancedCount = Ye.meshPerAttribute * Ye.count)) : $.enableAttribute(Ne), j.bindBuffer(34962, je), j.vertexAttribPointer(Ne, kt, Xe, Tt, 0, 0);
          } else if (at === "instanceMatrix") {
            var Mt = Ae.get(N.instanceMatrix);
            if (Mt === void 0) continue;
            var je = Mt.buffer, Xe = Mt.type;
            $.enableAttributeAndDivisor(Ne + 0, 1), $.enableAttributeAndDivisor(Ne + 1, 1), $.enableAttributeAndDivisor(Ne + 2, 1), $.enableAttributeAndDivisor(Ne + 3, 1), j.bindBuffer(34962, je), j.vertexAttribPointer(Ne + 0, 4, Xe, !1, 64, 0), j.vertexAttribPointer(Ne + 1, 4, Xe, !1, 64, 16), j.vertexAttribPointer(Ne + 2, 4, Xe, !1, 64, 32), j.vertexAttribPointer(Ne + 3, 4, Xe, !1, 64, 48);
          } else if (Re !== void 0) {
            var ct = Re[at];
            if (ct !== void 0)
              switch (ct.length) {
                case 2:
                  j.vertexAttrib2fv(Ne, ct);
                  break;
                case 3:
                  j.vertexAttrib3fv(Ne, ct);
                  break;
                case 4:
                  j.vertexAttrib4fv(Ne, ct);
                  break;
                default:
                  j.vertexAttrib1fv(Ne, ct);
              }
          }
        }
      }
      $.disableUnusedAttributes();
    }
  }
  this.compile = function(N, X) {
    h = Me.get(N, X), h.init(), N.traverse(function(we) {
      we.isLight && (h.pushLight(we), we.castShadow && h.pushShadow(we));
    }), h.setupLights(X);
    var ue = {};
    N.traverse(function(we) {
      if (we.material)
        if (Array.isArray(we.material))
          for (var Le = 0; Le < we.material.length; Le++)
            we.material[Le].uuid in ue || (ht(we.material[Le], N, we), ue[we.material[Le].uuid] = !0);
        else we.material.uuid in ue || (ht(we.material, N, we), ue[we.material.uuid] = !0);
    });
  };
  var Ge = null;
  function We(N) {
    Te.isPresenting || Ge && Ge(N);
  }
  var $e = new Tb();
  $e.setAnimationLoop(We), typeof window != "undefined" && $e.setContext(window), this.setAnimationLoop = function(N) {
    Ge = N, Te.setAnimationLoop(N), $e.start();
  }, this.render = function(N, X) {
    var ue, we;
    if (arguments[2] !== void 0 && (console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."), ue = arguments[2]), arguments[3] !== void 0 && (console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."), we = arguments[3]), !(X && X.isCamera)) {
      console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
      return;
    }
    if (!g) {
      b.geometry = null, b.program = null, b.wireframe = !1, x = -1, M = null, N.autoUpdate === !0 && N.updateMatrixWorld(), X.parent === null && X.updateMatrixWorld(), Te.enabled && Te.isPresenting && (X = Te.getCamera(X)), h = Me.get(N, X), h.init(), N.onBeforeRender(d, N, X, ue || y), W.multiplyMatrices(X.projectionMatrix, X.matrixWorldInverse), R.setFromProjectionMatrix(W), Z = this.localClippingEnabled, C = B.init(this.clippingPlanes, Z, X), f = ee.get(N, X), f.init(), pt(N, X, 0, d.sortObjects), d.sortObjects === !0 && f.sort(L, G), C && B.beginShadows();
      var Le = h.state.shadowsArray;
      A.render(Le, N, X), h.setupLights(X), C && B.endShadows(), this.info.autoReset && this.info.reset(), ue !== void 0 && this.setRenderTarget(ue), Te.enabled && I.isAvailable() && I.attachCamera(X), ye.render(f, N, X, we);
      var Ke = f.opaque, Re = f.transparent;
      if (N.overrideMaterial) {
        var at = N.overrideMaterial;
        Ke.length && tt(Ke, N, X, at), Re.length && tt(Re, N, X, at);
      } else
        Ke.length && tt(Ke, N, X), Re.length && tt(Re, N, X);
      N.onAfterRender(d, N, X), y !== null && (me.updateRenderTargetMipmap(y), me.updateMultisampleRenderTarget(y)), $.buffers.depth.setTest(!0), $.buffers.depth.setMask(!0), $.buffers.color.setMask(!0), $.setPolygonOffset(!1), Te.enabled && I.isAvailable() && I.detachCamera(X), f = null, h = null;
    }
  };
  function pt(N, X, ue, we) {
    if (N.visible !== !1) {
      var Le = N.layers.test(X.layers);
      if (Le) {
        if (N.isGroup)
          ue = N.renderOrder;
        else if (N.isLOD)
          N.autoUpdate === !0 && N.update(X);
        else if (N.isLight)
          h.pushLight(N), N.castShadow && h.pushShadow(N);
        else if (N.isSprite) {
          if (!N.frustumCulled || R.intersectsSprite(N)) {
            we && J.setFromMatrixPosition(N.matrixWorld).applyMatrix4(W);
            var Ke = Ee.update(N), Re = N.material;
            Re.visible && f.push(N, Ke, Re, ue, J.z, null);
          }
        } else if (N.isImmediateRenderObject)
          we && J.setFromMatrixPosition(N.matrixWorld).applyMatrix4(W), f.push(N, null, N.material, ue, J.z, null);
        else if ((N.isMesh || N.isLine || N.isPoints) && (N.isSkinnedMesh && N.skeleton.frame !== se.render.frame && (N.skeleton.update(), N.skeleton.frame = se.render.frame), !N.frustumCulled || R.intersectsObject(N))) {
          we && J.setFromMatrixPosition(N.matrixWorld).applyMatrix4(W);
          var Ke = Ee.update(N), Re = N.material;
          if (Array.isArray(Re))
            for (var at = Ke.groups, Ne = 0, Ye = at.length; Ne < Ye; Ne++) {
              var Tt = at[Ne], kt = Re[Tt.materialIndex];
              kt && kt.visible && f.push(N, Ke, kt, ue, J.z, Tt);
            }
          else Re.visible && f.push(N, Ke, Re, ue, J.z, null);
        }
      }
      for (var Mt = N.children, Ne = 0, Ye = Mt.length; Ne < Ye; Ne++)
        pt(Mt[Ne], X, ue, we);
    }
  }
  function tt(N, X, ue, we) {
    for (var Le = 0, Ke = N.length; Le < Ke; Le++) {
      var Re = N[Le], at = Re.object, Ne = Re.geometry, Ye = we === void 0 ? Re.material : we, Tt = Re.group;
      if (ue.isArrayCamera)
        if (k = ue, Te.enabled && I.isAvailable())
          xt(at, X, ue, Ne, Ye, Tt);
        else
          for (var kt = ue.cameras, Mt = 0, je = kt.length; Mt < je; Mt++) {
            var Xe = kt[Mt];
            at.layers.test(Xe.layers) && ($.viewport(E.copy(Xe.viewport)), h.setupLights(Xe), xt(at, X, Xe, Ne, Ye, Tt));
          }
      else
        k = null, xt(at, X, ue, Ne, Ye, Tt);
    }
  }
  function xt(N, X, ue, we, Le, Ke) {
    if (N.onBeforeRender(d, X, ue, we, Le, Ke), h = Me.get(X, k || ue), N.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse, N.matrixWorld), N.normalMatrix.getNormalMatrix(N.modelViewMatrix), N.isImmediateRenderObject) {
      var Re = Vt(ue, X, Le, N);
      $.setMaterial(Le), b.geometry = null, b.program = null, b.wireframe = !1, ce(N, Re);
    } else
      d.renderBufferDirect(ue, X, we, Le, N, Ke);
    N.onAfterRender(d, X, ue, we, Le, Ke), h = Me.get(X, k || ue);
  }
  function ht(N, X, ue) {
    var we = ve.get(N), Le = h.state.lights, Ke = h.state.shadowsArray, Re = Le.state.version, at = Y.getParameters(N, Le.state, Ke, X, B.numPlanes, B.numIntersection, ue), Ne = Y.getProgramCacheKey(at), Ye = we.program, Tt = !0;
    if (Ye === void 0)
      N.addEventListener("dispose", z);
    else if (Ye.cacheKey !== Ne)
      oe(N);
    else if (we.lightsStateVersion !== Re)
      we.lightsStateVersion = Re, Tt = !1;
    else {
      if (at.shaderID !== void 0)
        return;
      Tt = !1;
    }
    Tt && (Ye = Y.acquireProgram(at, Ne), we.program = Ye, we.uniforms = at.uniforms, we.environment = N.isMeshStandardMaterial ? X.environment : null, we.outputEncoding = d.outputEncoding, N.program = Ye);
    var kt = Ye.getAttributes();
    if (N.morphTargets) {
      N.numSupportedMorphTargets = 0;
      for (var Mt = 0; Mt < d.maxMorphTargets; Mt++)
        kt["morphTarget" + Mt] >= 0 && N.numSupportedMorphTargets++;
    }
    if (N.morphNormals) {
      N.numSupportedMorphNormals = 0;
      for (var Mt = 0; Mt < d.maxMorphNormals; Mt++)
        kt["morphNormal" + Mt] >= 0 && N.numSupportedMorphNormals++;
    }
    var je = we.uniforms;
    (!N.isShaderMaterial && !N.isRawShaderMaterial || N.clipping === !0) && (we.numClippingPlanes = B.numPlanes, we.numIntersection = B.numIntersection, je.clippingPlanes = B.uniform), we.fog = X.fog, we.needsLights = dr(N), we.lightsStateVersion = Re, we.needsLights && (je.ambientLightColor.value = Le.state.ambient, je.lightProbe.value = Le.state.probe, je.directionalLights.value = Le.state.directional, je.spotLights.value = Le.state.spot, je.rectAreaLights.value = Le.state.rectArea, je.pointLights.value = Le.state.point, je.hemisphereLights.value = Le.state.hemi, je.directionalShadowMap.value = Le.state.directionalShadowMap, je.directionalShadowMatrix.value = Le.state.directionalShadowMatrix, je.spotShadowMap.value = Le.state.spotShadowMap, je.spotShadowMatrix.value = Le.state.spotShadowMatrix, je.pointShadowMap.value = Le.state.pointShadowMap, je.pointShadowMatrix.value = Le.state.pointShadowMatrix);
    var Xe = we.program.getUniforms(), Lt = Ba.seqWithValue(Xe.seq, je);
    we.uniformsList = Lt;
  }
  function Vt(N, X, ue, we) {
    me.resetTextureUnits();
    var Le = X.fog, Ke = ue.isMeshStandardMaterial ? X.environment : null, Re = ve.get(ue), at = h.state.lights;
    if (C && (Z || N !== M)) {
      var Ne = N === M && ue.id === x;
      B.setState(
        ue.clippingPlanes,
        ue.clipIntersection,
        ue.clipShadows,
        N,
        Re,
        Ne
      );
    }
    ue.version === Re.__version ? (Re.program === void 0 || ue.fog && Re.fog !== Le || Re.environment !== Ke || Re.needsLights && Re.lightsStateVersion !== at.state.version || Re.numClippingPlanes !== void 0 && (Re.numClippingPlanes !== B.numPlanes || Re.numIntersection !== B.numIntersection) || Re.outputEncoding !== d.outputEncoding) && ht(ue, X, we) : (ht(ue, X, we), Re.__version = ue.version);
    var Ye = !1, Tt = !1, kt = !1, Mt = Re.program, je = Mt.getUniforms(), Xe = Re.uniforms;
    if ($.useProgram(Mt.program) && (Ye = !0, Tt = !0, kt = !0), ue.id !== x && (x = ue.id, Tt = !0), Ye || M !== N) {
      if (Mt.numMultiviewViews > 0 ? I.updateCameraProjectionMatricesUniform(N, je) : je.setValue(j, "projectionMatrix", N.projectionMatrix), pe.logarithmicDepthBuffer && je.setValue(
        j,
        "logDepthBufFC",
        2 / (Math.log(N.far + 1) / Math.LN2)
      ), M !== N && (M = N, Tt = !0, kt = !0), ue.isShaderMaterial || ue.isMeshPhongMaterial || ue.isMeshToonMaterial || ue.isMeshStandardMaterial || ue.envMap) {
        var Lt = je.map.cameraPosition;
        Lt !== void 0 && Lt.setValue(
          j,
          J.setFromMatrixPosition(N.matrixWorld)
        );
      }
      (ue.isMeshPhongMaterial || ue.isMeshToonMaterial || ue.isMeshLambertMaterial || ue.isMeshBasicMaterial || ue.isMeshStandardMaterial || ue.isShaderMaterial) && je.setValue(j, "isOrthographic", N.isOrthographicCamera === !0), (ue.isMeshPhongMaterial || ue.isMeshToonMaterial || ue.isMeshLambertMaterial || ue.isMeshBasicMaterial || ue.isMeshStandardMaterial || ue.isShaderMaterial || ue.skinning) && (Mt.numMultiviewViews > 0 ? I.updateCameraViewMatricesUniform(N, je) : je.setValue(j, "viewMatrix", N.matrixWorldInverse));
    }
    if (ue.skinning) {
      je.setOptional(j, we, "bindMatrix"), je.setOptional(j, we, "bindMatrixInverse");
      var Ut = we.skeleton;
      if (Ut) {
        var gr = Ut.bones;
        if (pe.floatVertexTextures) {
          if (Ut.boneTexture === void 0) {
            var yt = Math.sqrt(gr.length * 4);
            yt = It.ceilPowerOfTwo(yt), yt = Math.max(yt, 4);
            var ct = new Float32Array(yt * yt * 4);
            ct.set(Ut.boneMatrices);
            var pr = new Do(ct, yt, yt, _i, Pu);
            Ut.boneMatrices = ct, Ut.boneTexture = pr, Ut.boneTextureSize = yt;
          }
          je.setValue(j, "boneTexture", Ut.boneTexture, me), je.setValue(j, "boneTextureSize", Ut.boneTextureSize);
        } else
          je.setOptional(j, Ut, "boneMatrices");
      }
    }
    return (Tt || Re.receiveShadow !== we.receiveShadow) && (Re.receiveShadow = we.receiveShadow, je.setValue(j, "receiveShadow", we.receiveShadow)), Tt && (je.setValue(j, "toneMappingExposure", d.toneMappingExposure), je.setValue(j, "toneMappingWhitePoint", d.toneMappingWhitePoint), Re.needsLights && Jt(Xe, kt), Le && ue.fog && vt(Xe, Le), ue.isMeshBasicMaterial ? qe(Xe, ue) : ue.isMeshLambertMaterial ? (qe(Xe, ue), Ct(Xe, ue)) : ue.isMeshToonMaterial ? (qe(Xe, ue), St(Xe, ue)) : ue.isMeshPhongMaterial ? (qe(Xe, ue), Rt(Xe, ue)) : ue.isMeshStandardMaterial ? (qe(Xe, ue, Ke), ue.isMeshPhysicalMaterial ? nr(Xe, ue, Ke) : zt(Xe, ue, Ke)) : ue.isMeshMatcapMaterial ? (qe(Xe, ue), ir(Xe, ue)) : ue.isMeshDepthMaterial ? (qe(Xe, ue), ar(Xe, ue)) : ue.isMeshDistanceMaterial ? (qe(Xe, ue), gt(Xe, ue)) : ue.isMeshNormalMaterial ? (qe(Xe, ue), Dt(Xe, ue)) : ue.isLineBasicMaterial ? (ze(Xe, ue), ue.isLineDashedMaterial && He(Xe, ue)) : ue.isPointsMaterial ? Ht(Xe, ue) : ue.isSpriteMaterial ? mt(Xe, ue) : ue.isShadowMaterial && (Xe.color.value.copy(ue.color), Xe.opacity.value = ue.opacity), Xe.ltc_1 !== void 0 && (Xe.ltc_1.value = Ze.LTC_1), Xe.ltc_2 !== void 0 && (Xe.ltc_2.value = Ze.LTC_2), Ba.upload(j, Re.uniformsList, Xe, me), ue.isShaderMaterial && (ue.uniformsNeedUpdate = !1)), ue.isShaderMaterial && ue.uniformsNeedUpdate === !0 && (Ba.upload(j, Re.uniformsList, Xe, me), ue.uniformsNeedUpdate = !1), ue.isSpriteMaterial && je.setValue(j, "center", we.center), Mt.numMultiviewViews > 0 ? I.updateObjectMatricesUniforms(we, N, je) : (je.setValue(j, "modelViewMatrix", we.modelViewMatrix), je.setValue(j, "normalMatrix", we.normalMatrix)), je.setValue(j, "modelMatrix", we.matrixWorld), Mt;
  }
  function qe(N, X, ue) {
    N.opacity.value = X.opacity, X.color && N.diffuse.value.copy(X.color), X.emissive && N.emissive.value.copy(X.emissive).multiplyScalar(X.emissiveIntensity), X.map && (N.map.value = X.map), X.alphaMap && (N.alphaMap.value = X.alphaMap), X.specularMap && (N.specularMap.value = X.specularMap);
    var we = X.envMap || ue;
    we && (N.envMap.value = we, N.flipEnvMap.value = we.isCubeTexture ? -1 : 1, N.reflectivity.value = X.reflectivity, N.refractionRatio.value = X.refractionRatio, N.maxMipLevel.value = ve.get(we).__maxMipLevel), X.lightMap && (N.lightMap.value = X.lightMap, N.lightMapIntensity.value = X.lightMapIntensity), X.aoMap && (N.aoMap.value = X.aoMap, N.aoMapIntensity.value = X.aoMapIntensity);
    var Le;
    X.map ? Le = X.map : X.specularMap ? Le = X.specularMap : X.displacementMap ? Le = X.displacementMap : X.normalMap ? Le = X.normalMap : X.bumpMap ? Le = X.bumpMap : X.roughnessMap ? Le = X.roughnessMap : X.metalnessMap ? Le = X.metalnessMap : X.alphaMap ? Le = X.alphaMap : X.emissiveMap && (Le = X.emissiveMap), Le !== void 0 && (Le.isWebGLRenderTarget && (Le = Le.texture), Le.matrixAutoUpdate === !0 && Le.updateMatrix(), N.uvTransform.value.copy(Le.matrix));
    var Ke;
    X.aoMap ? Ke = X.aoMap : X.lightMap && (Ke = X.lightMap), Ke !== void 0 && (Ke.isWebGLRenderTarget && (Ke = Ke.texture), Ke.matrixAutoUpdate === !0 && Ke.updateMatrix(), N.uv2Transform.value.copy(Ke.matrix));
  }
  function ze(N, X) {
    N.diffuse.value.copy(X.color), N.opacity.value = X.opacity;
  }
  function He(N, X) {
    N.dashSize.value = X.dashSize, N.totalSize.value = X.dashSize + X.gapSize, N.scale.value = X.scale;
  }
  function Ht(N, X) {
    N.diffuse.value.copy(X.color), N.opacity.value = X.opacity, N.size.value = X.size * _, N.scale.value = D * 0.5, X.map && (N.map.value = X.map), X.alphaMap && (N.alphaMap.value = X.alphaMap);
    var ue;
    X.map ? ue = X.map : X.alphaMap && (ue = X.alphaMap), ue !== void 0 && (ue.matrixAutoUpdate === !0 && ue.updateMatrix(), N.uvTransform.value.copy(ue.matrix));
  }
  function mt(N, X) {
    N.diffuse.value.copy(X.color), N.opacity.value = X.opacity, N.rotation.value = X.rotation, X.map && (N.map.value = X.map), X.alphaMap && (N.alphaMap.value = X.alphaMap);
    var ue;
    X.map ? ue = X.map : X.alphaMap && (ue = X.alphaMap), ue !== void 0 && (ue.matrixAutoUpdate === !0 && ue.updateMatrix(), N.uvTransform.value.copy(ue.matrix));
  }
  function vt(N, X) {
    N.fogColor.value.copy(X.color), X.isFog ? (N.fogNear.value = X.near, N.fogFar.value = X.far) : X.isFogExp2 && (N.fogDensity.value = X.density);
  }
  function Ct(N, X) {
    X.emissiveMap && (N.emissiveMap.value = X.emissiveMap);
  }
  function Rt(N, X) {
    N.specular.value.copy(X.specular), N.shininess.value = Math.max(X.shininess, 1e-4), X.emissiveMap && (N.emissiveMap.value = X.emissiveMap), X.bumpMap && (N.bumpMap.value = X.bumpMap, N.bumpScale.value = X.bumpScale, X.side === Hr && (N.bumpScale.value *= -1)), X.normalMap && (N.normalMap.value = X.normalMap, N.normalScale.value.copy(X.normalScale), X.side === Hr && N.normalScale.value.negate()), X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias);
  }
  function St(N, X) {
    N.specular.value.copy(X.specular), N.shininess.value = Math.max(X.shininess, 1e-4), X.gradientMap && (N.gradientMap.value = X.gradientMap), X.emissiveMap && (N.emissiveMap.value = X.emissiveMap), X.bumpMap && (N.bumpMap.value = X.bumpMap, N.bumpScale.value = X.bumpScale, X.side === Hr && (N.bumpScale.value *= -1)), X.normalMap && (N.normalMap.value = X.normalMap, N.normalScale.value.copy(X.normalScale), X.side === Hr && N.normalScale.value.negate()), X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias);
  }
  function zt(N, X, ue) {
    N.roughness.value = X.roughness, N.metalness.value = X.metalness, X.roughnessMap && (N.roughnessMap.value = X.roughnessMap), X.metalnessMap && (N.metalnessMap.value = X.metalnessMap), X.emissiveMap && (N.emissiveMap.value = X.emissiveMap), X.bumpMap && (N.bumpMap.value = X.bumpMap, N.bumpScale.value = X.bumpScale, X.side === Hr && (N.bumpScale.value *= -1)), X.normalMap && (N.normalMap.value = X.normalMap, N.normalScale.value.copy(X.normalScale), X.side === Hr && N.normalScale.value.negate()), X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias), (X.envMap || ue) && (N.envMapIntensity.value = X.envMapIntensity);
  }
  function nr(N, X, ue) {
    zt(N, X, ue), N.reflectivity.value = X.reflectivity, N.clearcoat.value = X.clearcoat, N.clearcoatRoughness.value = X.clearcoatRoughness, X.sheen && N.sheen.value.copy(X.sheen), X.clearcoatNormalMap && (N.clearcoatNormalScale.value.copy(X.clearcoatNormalScale), N.clearcoatNormalMap.value = X.clearcoatNormalMap, X.side === Hr && N.clearcoatNormalScale.value.negate()), N.transparency.value = X.transparency;
  }
  function ir(N, X) {
    X.matcap && (N.matcap.value = X.matcap), X.bumpMap && (N.bumpMap.value = X.bumpMap, N.bumpScale.value = X.bumpScale, X.side === Hr && (N.bumpScale.value *= -1)), X.normalMap && (N.normalMap.value = X.normalMap, N.normalScale.value.copy(X.normalScale), X.side === Hr && N.normalScale.value.negate()), X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias);
  }
  function ar(N, X) {
    X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias);
  }
  function gt(N, X) {
    X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias), N.referencePosition.value.copy(X.referencePosition), N.nearDistance.value = X.nearDistance, N.farDistance.value = X.farDistance;
  }
  function Dt(N, X) {
    X.bumpMap && (N.bumpMap.value = X.bumpMap, N.bumpScale.value = X.bumpScale, X.side === Hr && (N.bumpScale.value *= -1)), X.normalMap && (N.normalMap.value = X.normalMap, N.normalScale.value.copy(X.normalScale), X.side === Hr && N.normalScale.value.negate()), X.displacementMap && (N.displacementMap.value = X.displacementMap, N.displacementScale.value = X.displacementScale, N.displacementBias.value = X.displacementBias);
  }
  function Jt(N, X) {
    N.ambientLightColor.needsUpdate = X, N.lightProbe.needsUpdate = X, N.directionalLights.needsUpdate = X, N.pointLights.needsUpdate = X, N.spotLights.needsUpdate = X, N.rectAreaLights.needsUpdate = X, N.hemisphereLights.needsUpdate = X;
  }
  function dr(N) {
    return N.isMeshLambertMaterial || N.isMeshToonMaterial || N.isMeshPhongMaterial || N.isMeshStandardMaterial || N.isShadowMaterial || N.isShaderMaterial && N.lights === !0;
  }
  this.setFramebuffer = function(N) {
    v !== N && y === null && j.bindFramebuffer(36160, N), v = N;
  }, this.getActiveCubeFace = function() {
    return m;
  }, this.getActiveMipmapLevel = function() {
    return p;
  }, this.getRenderTarget = function() {
    return y;
  }, this.setRenderTarget = function(N, X, ue) {
    y = N, m = X, p = ue, N && ve.get(N).__webglFramebuffer === void 0 && me.setupRenderTarget(N);
    var we = v, Le = !1;
    if (N) {
      var Ke = ve.get(N).__webglFramebuffer;
      N.isWebGLCubeRenderTarget ? (we = Ke[X || 0], Le = !0) : N.isWebGLMultisampleRenderTarget ? we = ve.get(N).__webglMultisampledFramebuffer : we = Ke, E.copy(N.viewport), S.copy(N.scissor), F = N.scissorTest;
    } else
      E.copy(V).multiplyScalar(_).floor(), S.copy(H).multiplyScalar(_).floor(), F = U;
    if (w !== we && (j.bindFramebuffer(36160, we), w = we), $.viewport(E), $.scissor(S), $.setScissorTest(F), Le) {
      var Re = ve.get(N.texture);
      j.framebufferTexture2D(36160, 36064, 34069 + (X || 0), Re.__webglTexture, ue || 0);
    }
  }, this.readRenderTargetPixels = function(N, X, ue, we, Le, Ke, Re) {
    if (!(N && N.isWebGLRenderTarget)) {
      console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");
      return;
    }
    var at = ve.get(N).__webglFramebuffer;
    if (N.isWebGLCubeRenderTarget && Re !== void 0 && (at = at[Re]), at) {
      var Ne = !1;
      at !== w && (j.bindFramebuffer(36160, at), Ne = !0);
      try {
        var Ye = N.texture, Tt = Ye.format, kt = Ye.type;
        if (Tt !== _i && ke.convert(Tt) !== j.getParameter(35739)) {
          console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");
          return;
        }
        if (kt !== ah && ke.convert(kt) !== j.getParameter(35738) && // IE11, Edge and Chrome Mac < 52 (#9513)
        !(kt === Pu && (pe.isWebGL2 || ae.get("OES_texture_float") || ae.get("WEBGL_color_buffer_float"))) && // Chrome Mac >= 52 and Firefox
        !(kt === p0 && (pe.isWebGL2 ? ae.get("EXT_color_buffer_float") : ae.get("EXT_color_buffer_half_float")))) {
          console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");
          return;
        }
        j.checkFramebufferStatus(36160) === 36053 ? X >= 0 && X <= N.width - we && ue >= 0 && ue <= N.height - Le && j.readPixels(X, ue, we, Le, ke.convert(Tt), ke.convert(kt), Ke) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.");
      } finally {
        Ne && j.bindFramebuffer(36160, w);
      }
    }
  }, this.copyFramebufferToTexture = function(N, X, ue) {
    ue === void 0 && (ue = 0);
    var we = Math.pow(2, -ue), Le = Math.floor(X.image.width * we), Ke = Math.floor(X.image.height * we), Re = ke.convert(X.format);
    me.setTexture2D(X, 0), j.copyTexImage2D(3553, ue, Re, N.x, N.y, Le, Ke, 0), $.unbindTexture();
  }, this.copyTextureToTexture = function(N, X, ue, we) {
    var Le = X.image.width, Ke = X.image.height, Re = ke.convert(ue.format), at = ke.convert(ue.type);
    me.setTexture2D(ue, 0), X.isDataTexture ? j.texSubImage2D(3553, we || 0, N.x, N.y, Le, Ke, Re, at, X.image.data) : j.texSubImage2D(3553, we || 0, N.x, N.y, Re, at, X.image), $.unbindTexture();
  }, this.initTexture = function(N) {
    me.setTexture2D(N, 0), $.unbindTexture();
  }, typeof __THREE_DEVTOOLS__ != "undefined" && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe", { detail: this }));
}
function Dp(e, t) {
  this.name = "", this.color = new nt(e), this.density = t !== void 0 ? t : 25e-5;
}
Object.assign(Dp.prototype, {
  isFogExp2: !0,
  clone: function() {
    return new Dp(this.color, this.density);
  },
  toJSON: function() {
    return {
      type: "FogExp2",
      color: this.color.getHex(),
      density: this.density
    };
  }
});
function _p(e, t, r) {
  this.name = "", this.color = new nt(e), this.near = t !== void 0 ? t : 1, this.far = r !== void 0 ? r : 1e3;
}
Object.assign(_p.prototype, {
  isFog: !0,
  clone: function() {
    return new _p(this.color, this.near, this.far);
  },
  toJSON: function() {
    return {
      type: "Fog",
      color: this.color.getHex(),
      near: this.near,
      far: this.far
    };
  }
});
function Na(e, t) {
  this.array = e, this.stride = t, this.count = e !== void 0 ? e.length / t : 0, this.usage = sh, this.updateRange = { offset: 0, count: -1 }, this.version = 0;
}
Object.defineProperty(Na.prototype, "needsUpdate", {
  set: function(e) {
    e === !0 && this.version++;
  }
});
Object.assign(Na.prototype, {
  isInterleavedBuffer: !0,
  onUploadCallback: function() {
  },
  setUsage: function(e) {
    return this.usage = e, this;
  },
  copy: function(e) {
    return this.array = new e.array.constructor(e.array), this.count = e.count, this.stride = e.stride, this.usage = e.usage, this;
  },
  copyAt: function(e, t, r) {
    e *= this.stride, r *= t.stride;
    for (var n = 0, i = this.stride; n < i; n++)
      this.array[e + n] = t.array[r + n];
    return this;
  },
  set: function(e, t) {
    return t === void 0 && (t = 0), this.array.set(e, t), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  onUpload: function(e) {
    return this.onUploadCallback = e, this;
  }
});
var ns = new re();
function ff(e, t, r, n) {
  this.data = e, this.itemSize = t, this.offset = r, this.normalized = n === !0;
}
Object.defineProperties(ff.prototype, {
  count: {
    get: function() {
      return this.data.count;
    }
  },
  array: {
    get: function() {
      return this.data.array;
    }
  }
});
Object.assign(ff.prototype, {
  isInterleavedBufferAttribute: !0,
  applyMatrix4: function(e) {
    for (var t = 0, r = this.data.count; t < r; t++)
      ns.x = this.getX(t), ns.y = this.getY(t), ns.z = this.getZ(t), ns.applyMatrix4(e), this.setXYZ(t, ns.x, ns.y, ns.z);
    return this;
  },
  setX: function(e, t) {
    return this.data.array[e * this.data.stride + this.offset] = t, this;
  },
  setY: function(e, t) {
    return this.data.array[e * this.data.stride + this.offset + 1] = t, this;
  },
  setZ: function(e, t) {
    return this.data.array[e * this.data.stride + this.offset + 2] = t, this;
  },
  setW: function(e, t) {
    return this.data.array[e * this.data.stride + this.offset + 3] = t, this;
  },
  getX: function(e) {
    return this.data.array[e * this.data.stride + this.offset];
  },
  getY: function(e) {
    return this.data.array[e * this.data.stride + this.offset + 1];
  },
  getZ: function(e) {
    return this.data.array[e * this.data.stride + this.offset + 2];
  },
  getW: function(e) {
    return this.data.array[e * this.data.stride + this.offset + 3];
  },
  setXY: function(e, t, r) {
    return e = e * this.data.stride + this.offset, this.data.array[e + 0] = t, this.data.array[e + 1] = r, this;
  },
  setXYZ: function(e, t, r, n) {
    return e = e * this.data.stride + this.offset, this.data.array[e + 0] = t, this.data.array[e + 1] = r, this.data.array[e + 2] = n, this;
  },
  setXYZW: function(e, t, r, n, i) {
    return e = e * this.data.stride + this.offset, this.data.array[e + 0] = t, this.data.array[e + 1] = r, this.data.array[e + 2] = n, this.data.array[e + 3] = i, this;
  }
});
function xs(e) {
  wt.call(this), this.type = "SpriteMaterial", this.color = new nt(16777215), this.map = null, this.alphaMap = null, this.rotation = 0, this.sizeAttenuation = !0, this.transparent = !0, this.setValues(e);
}
xs.prototype = Object.create(wt.prototype);
xs.prototype.constructor = xs;
xs.prototype.isSpriteMaterial = !0;
xs.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.map = e.map, this.alphaMap = e.alphaMap, this.rotation = e.rotation, this.sizeAttenuation = e.sizeAttenuation, this;
};
var Zs, ou = new re(), Js = new re(), Qs = new re(), eo = new _e(), uu = new _e(), Rb = new Nt(), Zl = new re(), lu = new re(), Jl = new re(), Ug = new _e(), ud = new _e(), Gg = new _e();
function Pp(e) {
  if (et.call(this), this.type = "Sprite", Zs === void 0) {
    Zs = new it();
    var t = new Float32Array([
      -0.5,
      -0.5,
      0,
      0,
      0,
      0.5,
      -0.5,
      0,
      1,
      0,
      0.5,
      0.5,
      0,
      1,
      1,
      -0.5,
      0.5,
      0,
      0,
      1
    ]), r = new Na(t, 5);
    Zs.setIndex([0, 1, 2, 0, 2, 3]), Zs.setAttribute("position", new ff(r, 3, 0, !1)), Zs.setAttribute("uv", new ff(r, 2, 3, !1));
  }
  this.geometry = Zs, this.material = e !== void 0 ? e : new xs(), this.center = new _e(0.5, 0.5);
}
Pp.prototype = Object.assign(Object.create(et.prototype), {
  constructor: Pp,
  isSprite: !0,
  raycast: function(e, t) {
    e.camera === null && console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'), Js.setFromMatrixScale(this.matrixWorld), Rb.copy(e.camera.matrixWorld), this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse, this.matrixWorld), Qs.setFromMatrixPosition(this.modelViewMatrix), e.camera.isPerspectiveCamera && this.material.sizeAttenuation === !1 && Js.multiplyScalar(-Qs.z);
    var r = this.material.rotation, n, i;
    r !== 0 && (i = Math.cos(r), n = Math.sin(r));
    var a = this.center;
    Ql(Zl.set(-0.5, -0.5, 0), Qs, a, Js, n, i), Ql(lu.set(0.5, -0.5, 0), Qs, a, Js, n, i), Ql(Jl.set(0.5, 0.5, 0), Qs, a, Js, n, i), Ug.set(0, 0), ud.set(1, 0), Gg.set(1, 1);
    var s = e.ray.intersectTriangle(Zl, lu, Jl, !1, ou);
    if (!(s === null && (Ql(lu.set(-0.5, 0.5, 0), Qs, a, Js, n, i), ud.set(0, 1), s = e.ray.intersectTriangle(Zl, Jl, lu, !1, ou), s === null))) {
      var o = e.ray.origin.distanceTo(ou);
      o < e.near || o > e.far || t.push({
        distance: o,
        point: ou.clone(),
        uv: Yr.getUV(ou, Zl, lu, Jl, Ug, ud, Gg, new _e()),
        face: null,
        object: this
      });
    }
  },
  clone: function() {
    return new this.constructor(this.material).copy(this);
  },
  copy: function(e) {
    return et.prototype.copy.call(this, e), e.center !== void 0 && this.center.copy(e.center), this;
  }
});
function Ql(e, t, r, n, i, a) {
  eo.subVectors(e, r).addScalar(0.5).multiply(n), i !== void 0 ? (uu.x = a * eo.x - i * eo.y, uu.y = i * eo.x + a * eo.y) : uu.copy(eo), e.copy(t), e.x += uu.x, e.y += uu.y, e.applyMatrix4(Rb);
}
var ec = new re(), zg = new re();
function hf() {
  et.call(this), this.type = "LOD", Object.defineProperties(this, {
    levels: {
      enumerable: !0,
      value: []
    }
  }), this.autoUpdate = !0;
}
hf.prototype = Object.assign(Object.create(et.prototype), {
  constructor: hf,
  isLOD: !0,
  copy: function(e) {
    et.prototype.copy.call(this, e, !1);
    for (var t = e.levels, r = 0, n = t.length; r < n; r++) {
      var i = t[r];
      this.addLevel(i.object.clone(), i.distance);
    }
    return this.autoUpdate = e.autoUpdate, this;
  },
  addLevel: function(e, t) {
    t === void 0 && (t = 0), t = Math.abs(t);
    for (var r = this.levels, n = 0; n < r.length && !(t < r[n].distance); n++)
      ;
    return r.splice(n, 0, { distance: t, object: e }), this.add(e), this;
  },
  getObjectForDistance: function(e) {
    var t = this.levels;
    if (t.length > 0) {
      for (var r = 1, n = t.length; r < n && !(e < t[r].distance); r++)
        ;
      return t[r - 1].object;
    }
    return null;
  },
  raycast: function(e, t) {
    var r = this.levels;
    if (r.length > 0) {
      ec.setFromMatrixPosition(this.matrixWorld);
      var n = e.ray.origin.distanceTo(ec);
      this.getObjectForDistance(n).raycast(e, t);
    }
  },
  update: function(e) {
    var t = this.levels;
    if (t.length > 1) {
      ec.setFromMatrixPosition(e.matrixWorld), zg.setFromMatrixPosition(this.matrixWorld);
      var r = ec.distanceTo(zg);
      t[0].object.visible = !0;
      for (var n = 1, i = t.length; n < i && r >= t[n].distance; n++)
        t[n - 1].object.visible = !1, t[n].object.visible = !0;
      for (; n < i; n++)
        t[n].object.visible = !1;
    }
  },
  toJSON: function(e) {
    var t = et.prototype.toJSON.call(this, e);
    this.autoUpdate === !1 && (t.object.autoUpdate = !1), t.object.levels = [];
    for (var r = this.levels, n = 0, i = r.length; n < i; n++) {
      var a = r[n];
      t.object.levels.push({
        object: a.object.uuid,
        distance: a.distance
      });
    }
    return t;
  }
});
function df(e, t) {
  e && e.isGeometry && console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."), Tr.call(this, e, t), this.type = "SkinnedMesh", this.bindMode = "attached", this.bindMatrix = new Nt(), this.bindMatrixInverse = new Nt();
}
df.prototype = Object.assign(Object.create(Tr.prototype), {
  constructor: df,
  isSkinnedMesh: !0,
  bind: function(e, t) {
    this.skeleton = e, t === void 0 && (this.updateMatrixWorld(!0), this.skeleton.calculateInverses(), t = this.matrixWorld), this.bindMatrix.copy(t), this.bindMatrixInverse.getInverse(t);
  },
  pose: function() {
    this.skeleton.pose();
  },
  normalizeSkinWeights: function() {
    for (var e = new or(), t = this.geometry.attributes.skinWeight, r = 0, n = t.count; r < n; r++) {
      e.x = t.getX(r), e.y = t.getY(r), e.z = t.getZ(r), e.w = t.getW(r);
      var i = 1 / e.manhattanLength();
      i !== 1 / 0 ? e.multiplyScalar(i) : e.set(1, 0, 0, 0), t.setXYZW(r, e.x, e.y, e.z, e.w);
    }
  },
  updateMatrixWorld: function(e) {
    Tr.prototype.updateMatrixWorld.call(this, e), this.bindMode === "attached" ? this.bindMatrixInverse.getInverse(this.matrixWorld) : this.bindMode === "detached" ? this.bindMatrixInverse.getInverse(this.bindMatrix) : console.warn("THREE.SkinnedMesh: Unrecognized bindMode: " + this.bindMode);
  },
  clone: function() {
    return new this.constructor(this.geometry, this.material).copy(this);
  }
});
var Wg = new Nt(), j6 = new Nt();
function Bp(e, t) {
  if (e = e || [], this.bones = e.slice(0), this.boneMatrices = new Float32Array(this.bones.length * 16), this.frame = -1, t === void 0)
    this.calculateInverses();
  else if (this.bones.length === t.length)
    this.boneInverses = t.slice(0);
  else {
    console.warn("THREE.Skeleton boneInverses is the wrong length."), this.boneInverses = [];
    for (var r = 0, n = this.bones.length; r < n; r++)
      this.boneInverses.push(new Nt());
  }
}
Object.assign(Bp.prototype, {
  calculateInverses: function() {
    this.boneInverses = [];
    for (var e = 0, t = this.bones.length; e < t; e++) {
      var r = new Nt();
      this.bones[e] && r.getInverse(this.bones[e].matrixWorld), this.boneInverses.push(r);
    }
  },
  pose: function() {
    var e, t, r;
    for (t = 0, r = this.bones.length; t < r; t++)
      e = this.bones[t], e && e.matrixWorld.getInverse(this.boneInverses[t]);
    for (t = 0, r = this.bones.length; t < r; t++)
      e = this.bones[t], e && (e.parent && e.parent.isBone ? (e.matrix.getInverse(e.parent.matrixWorld), e.matrix.multiply(e.matrixWorld)) : e.matrix.copy(e.matrixWorld), e.matrix.decompose(e.position, e.quaternion, e.scale));
  },
  update: function() {
    for (var e = this.bones, t = this.boneInverses, r = this.boneMatrices, n = this.boneTexture, i = 0, a = e.length; i < a; i++) {
      var s = e[i] ? e[i].matrixWorld : j6;
      Wg.multiplyMatrices(s, t[i]), Wg.toArray(r, i * 16);
    }
    n !== void 0 && (n.needsUpdate = !0);
  },
  clone: function() {
    return new Bp(this.bones, this.boneInverses);
  },
  getBoneByName: function(e) {
    for (var t = 0, r = this.bones.length; t < r; t++) {
      var n = this.bones[t];
      if (n.name === e)
        return n;
    }
  }
});
function Vg() {
  et.call(this), this.type = "Bone";
}
Vg.prototype = Object.assign(Object.create(et.prototype), {
  constructor: Vg,
  isBone: !0
});
var Hg = new Nt(), jg = new Nt(), to = [], cu = new Tr();
function Lp(e, t, r) {
  Tr.call(this, e, t), this.instanceMatrix = new Et(new Float32Array(r * 16), 16), this.count = r, this.frustumCulled = !1;
}
Lp.prototype = Object.assign(Object.create(Tr.prototype), {
  constructor: Lp,
  isInstancedMesh: !0,
  getMatrixAt: function(e, t) {
    t.fromArray(this.instanceMatrix.array, e * 16);
  },
  raycast: function(e, t) {
    var r = this.matrixWorld, n = this.count;
    if (cu.geometry = this.geometry, cu.material = this.material, cu.material !== void 0)
      for (var i = 0; i < n; i++)
        this.getMatrixAt(i, Hg), jg.multiplyMatrices(r, Hg), cu.matrixWorld = jg, cu.raycast(e, to), to.length > 0 && (to[0].instanceId = i, to[0].object = this, t.push(to[0]), to.length = 0);
  },
  setMatrixAt: function(e, t) {
    t.toArray(this.instanceMatrix.array, e * 16);
  },
  updateMorphTargets: function() {
  }
});
function Fr(e) {
  wt.call(this), this.type = "LineBasicMaterial", this.color = new nt(16777215), this.linewidth = 1, this.linecap = "round", this.linejoin = "round", this.setValues(e);
}
Fr.prototype = Object.create(wt.prototype);
Fr.prototype.constructor = Fr;
Fr.prototype.isLineBasicMaterial = !0;
Fr.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.linewidth = e.linewidth, this.linecap = e.linecap, this.linejoin = e.linejoin, this;
};
var Xg = new re(), qg = new re(), $g = new Nt(), tc = new Yo(), rc = new ja();
function $n(e, t, r) {
  r === 1 && console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."), et.call(this), this.type = "Line", this.geometry = e !== void 0 ? e : new it(), this.material = t !== void 0 ? t : new Fr();
}
$n.prototype = Object.assign(Object.create(et.prototype), {
  constructor: $n,
  isLine: !0,
  computeLineDistances: function() {
    var e = this.geometry;
    if (e.isBufferGeometry)
      if (e.index === null) {
        for (var t = e.attributes.position, r = [0], n = 1, i = t.count; n < i; n++)
          Xg.fromBufferAttribute(t, n - 1), qg.fromBufferAttribute(t, n), r[n] = r[n - 1], r[n] += Xg.distanceTo(qg);
        e.setAttribute("lineDistance", new Qe(r, 1));
      } else
        console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
    else if (e.isGeometry) {
      var a = e.vertices, r = e.lineDistances;
      r[0] = 0;
      for (var n = 1, i = a.length; n < i; n++)
        r[n] = r[n - 1], r[n] += a[n - 1].distanceTo(a[n]);
    }
    return this;
  },
  raycast: function(e, t) {
    var r = e.linePrecision, n = this.geometry, i = this.matrixWorld;
    if (n.boundingSphere === null && n.computeBoundingSphere(), rc.copy(n.boundingSphere), rc.applyMatrix4(i), rc.radius += r, e.ray.intersectsSphere(rc) !== !1) {
      $g.getInverse(i), tc.copy(e.ray).applyMatrix4($g);
      var a = r / ((this.scale.x + this.scale.y + this.scale.z) / 3), s = a * a, o = new re(), u = new re(), l = new re(), c = new re(), f = this && this.isLineSegments ? 2 : 1;
      if (n.isBufferGeometry) {
        var h = n.index, d = n.attributes, g = d.position.array;
        if (h !== null)
          for (var v = h.array, m = 0, p = v.length - 1; m < p; m += f) {
            var y = v[m], w = v[m + 1];
            o.fromArray(g, y * 3), u.fromArray(g, w * 3);
            var x = tc.distanceSqToSegment(o, u, c, l);
            if (!(x > s)) {
              c.applyMatrix4(this.matrixWorld);
              var b = e.ray.origin.distanceTo(c);
              b < e.near || b > e.far || t.push({
                distance: b,
                // What do we want? intersection point on the ray or on the segment??
                // point: raycaster.ray.at( distance ),
                point: l.clone().applyMatrix4(this.matrixWorld),
                index: m,
                face: null,
                faceIndex: null,
                object: this
              });
            }
          }
        else
          for (var m = 0, p = g.length / 3 - 1; m < p; m += f) {
            o.fromArray(g, 3 * m), u.fromArray(g, 3 * m + 3);
            var x = tc.distanceSqToSegment(o, u, c, l);
            if (!(x > s)) {
              c.applyMatrix4(this.matrixWorld);
              var b = e.ray.origin.distanceTo(c);
              b < e.near || b > e.far || t.push({
                distance: b,
                // What do we want? intersection point on the ray or on the segment??
                // point: raycaster.ray.at( distance ),
                point: l.clone().applyMatrix4(this.matrixWorld),
                index: m,
                face: null,
                faceIndex: null,
                object: this
              });
            }
          }
      } else if (n.isGeometry)
        for (var M = n.vertices, k = M.length, m = 0; m < k - 1; m += f) {
          var x = tc.distanceSqToSegment(M[m], M[m + 1], c, l);
          if (!(x > s)) {
            c.applyMatrix4(this.matrixWorld);
            var b = e.ray.origin.distanceTo(c);
            b < e.near || b > e.far || t.push({
              distance: b,
              // What do we want? intersection point on the ray or on the segment??
              // point: raycaster.ray.at( distance ),
              point: l.clone().applyMatrix4(this.matrixWorld),
              index: m,
              face: null,
              faceIndex: null,
              object: this
            });
          }
        }
    }
  },
  clone: function() {
    return new this.constructor(this.geometry, this.material).copy(this);
  }
});
var nc = new re(), ic = new re();
function Ur(e, t) {
  $n.call(this, e, t), this.type = "LineSegments";
}
Ur.prototype = Object.assign(Object.create($n.prototype), {
  constructor: Ur,
  isLineSegments: !0,
  computeLineDistances: function() {
    var e = this.geometry;
    if (e.isBufferGeometry)
      if (e.index === null) {
        for (var t = e.attributes.position, r = [], n = 0, i = t.count; n < i; n += 2)
          nc.fromBufferAttribute(t, n), ic.fromBufferAttribute(t, n + 1), r[n] = n === 0 ? 0 : r[n - 1], r[n + 1] = r[n] + nc.distanceTo(ic);
        e.setAttribute("lineDistance", new Qe(r, 1));
      } else
        console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
    else if (e.isGeometry)
      for (var a = e.vertices, r = e.lineDistances, n = 0, i = a.length; n < i; n += 2)
        nc.copy(a[n]), ic.copy(a[n + 1]), r[n] = n === 0 ? 0 : r[n - 1], r[n + 1] = r[n] + nc.distanceTo(ic);
    return this;
  }
});
function Fp(e, t) {
  $n.call(this, e, t), this.type = "LineLoop";
}
Fp.prototype = Object.assign(Object.create($n.prototype), {
  constructor: Fp,
  isLineLoop: !0
});
function Ms(e) {
  wt.call(this), this.type = "PointsMaterial", this.color = new nt(16777215), this.map = null, this.alphaMap = null, this.size = 1, this.sizeAttenuation = !0, this.morphTargets = !1, this.setValues(e);
}
Ms.prototype = Object.create(wt.prototype);
Ms.prototype.constructor = Ms;
Ms.prototype.isPointsMaterial = !0;
Ms.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.map = e.map, this.alphaMap = e.alphaMap, this.size = e.size, this.sizeAttenuation = e.sizeAttenuation, this.morphTargets = e.morphTargets, this;
};
var Yg = new Nt(), Ip = new Yo(), ac = new ja(), sc = new re();
function Rp(e, t) {
  et.call(this), this.type = "Points", this.geometry = e !== void 0 ? e : new it(), this.material = t !== void 0 ? t : new Ms(), this.updateMorphTargets();
}
Rp.prototype = Object.assign(Object.create(et.prototype), {
  constructor: Rp,
  isPoints: !0,
  raycast: function(e, t) {
    var r = this.geometry, n = this.matrixWorld, i = e.params.Points.threshold;
    if (r.boundingSphere === null && r.computeBoundingSphere(), ac.copy(r.boundingSphere), ac.applyMatrix4(n), ac.radius += i, e.ray.intersectsSphere(ac) !== !1) {
      Yg.getInverse(n), Ip.copy(e.ray).applyMatrix4(Yg);
      var a = i / ((this.scale.x + this.scale.y + this.scale.z) / 3), s = a * a;
      if (r.isBufferGeometry) {
        var o = r.index, u = r.attributes, l = u.position.array;
        if (o !== null)
          for (var c = o.array, f = 0, h = c.length; f < h; f++) {
            var d = c[f];
            sc.fromArray(l, d * 3), ld(sc, d, s, n, e, t, this);
          }
        else
          for (var f = 0, g = l.length / 3; f < g; f++)
            sc.fromArray(l, f * 3), ld(sc, f, s, n, e, t, this);
      } else
        for (var v = r.vertices, f = 0, g = v.length; f < g; f++)
          ld(v[f], f, s, n, e, t, this);
    }
  },
  updateMorphTargets: function() {
    var e = this.geometry, t, r, n;
    if (e.isBufferGeometry) {
      var i = e.morphAttributes, a = Object.keys(i);
      if (a.length > 0) {
        var s = i[a[0]];
        if (s !== void 0)
          for (this.morphTargetInfluences = [], this.morphTargetDictionary = {}, t = 0, r = s.length; t < r; t++)
            n = s[t].name || String(t), this.morphTargetInfluences.push(0), this.morphTargetDictionary[n] = t;
      }
    } else {
      var o = e.morphTargets;
      o !== void 0 && o.length > 0 && console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.");
    }
  },
  clone: function() {
    return new this.constructor(this.geometry, this.material).copy(this);
  }
});
function ld(e, t, r, n, i, a, s) {
  var o = Ip.distanceSqToPoint(e);
  if (o < r) {
    var u = new re();
    Ip.closestPointToPoint(e, u), u.applyMatrix4(n);
    var l = i.ray.origin.distanceTo(u);
    if (l < i.near || l > i.far) return;
    a.push({
      distance: l,
      distanceToRay: Math.sqrt(o),
      point: u,
      index: t,
      face: null,
      object: s
    });
  }
}
function Kg(e, t, r, n, i, a, s, o, u) {
  ur.call(this, e, t, r, n, i, a, s, o, u), this.format = s !== void 0 ? s : gs, this.minFilter = a !== void 0 ? a : Vr, this.magFilter = i !== void 0 ? i : Vr, this.generateMipmaps = !1;
}
Kg.prototype = Object.assign(Object.create(ur.prototype), {
  constructor: Kg,
  isVideoTexture: !0,
  update: function() {
    var e = this.image;
    e.readyState >= e.HAVE_CURRENT_DATA && (this.needsUpdate = !0);
  }
});
function Gu(e, t, r, n, i, a, s, o, u, l, c, f) {
  ur.call(this, null, a, s, o, u, l, n, i, c, f), this.image = { width: t, height: r }, this.mipmaps = e, this.flipY = !1, this.generateMipmaps = !1;
}
Gu.prototype = Object.create(ur.prototype);
Gu.prototype.constructor = Gu;
Gu.prototype.isCompressedTexture = !0;
function pf(e, t, r, n, i, a, s, o, u) {
  ur.call(this, e, t, r, n, i, a, s, o, u), this.needsUpdate = !0;
}
pf.prototype = Object.create(ur.prototype);
pf.prototype.constructor = pf;
pf.prototype.isCanvasTexture = !0;
function vf(e, t, r, n, i, a, s, o, u, l) {
  if (l = l !== void 0 ? l : yo, l !== yo && l !== Bu)
    throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");
  r === void 0 && l === yo && (r = af), r === void 0 && l === Bu && (r = sf), ur.call(this, null, n, i, a, s, o, l, r, u), this.image = { width: e, height: t }, this.magFilter = s !== void 0 ? s : Or, this.minFilter = o !== void 0 ? o : Or, this.flipY = !1, this.generateMipmaps = !1;
}
vf.prototype = Object.create(ur.prototype);
vf.prototype.constructor = vf;
vf.prototype.isDepthTexture = !0;
function mf(e) {
  it.call(this), this.type = "WireframeGeometry";
  var t = [], r, n, i, a, s, o = [0, 0], u = {}, l, c, f, h, d = ["a", "b", "c"], g;
  if (e && e.isGeometry) {
    var v = e.faces;
    for (r = 0, i = v.length; r < i; r++) {
      var m = v[r];
      for (n = 0; n < 3; n++)
        c = m[d[n]], f = m[d[(n + 1) % 3]], o[0] = Math.min(c, f), o[1] = Math.max(c, f), h = o[0] + "," + o[1], u[h] === void 0 && (u[h] = { index1: o[0], index2: o[1] });
    }
    for (h in u)
      l = u[h], g = e.vertices[l.index1], t.push(g.x, g.y, g.z), g = e.vertices[l.index2], t.push(g.x, g.y, g.z);
  } else if (e && e.isBufferGeometry) {
    var p, y, w, x, b, M, k, E;
    if (g = new re(), e.index !== null) {
      for (p = e.attributes.position, y = e.index, w = e.groups, w.length === 0 && (w = [{ start: 0, count: y.count, materialIndex: 0 }]), a = 0, s = w.length; a < s; ++a)
        for (x = w[a], b = x.start, M = x.count, r = b, i = b + M; r < i; r += 3)
          for (n = 0; n < 3; n++)
            c = y.getX(r + n), f = y.getX(r + (n + 1) % 3), o[0] = Math.min(c, f), o[1] = Math.max(c, f), h = o[0] + "," + o[1], u[h] === void 0 && (u[h] = { index1: o[0], index2: o[1] });
      for (h in u)
        l = u[h], g.fromBufferAttribute(p, l.index1), t.push(g.x, g.y, g.z), g.fromBufferAttribute(p, l.index2), t.push(g.x, g.y, g.z);
    } else
      for (p = e.attributes.position, r = 0, i = p.count / 3; r < i; r++)
        for (n = 0; n < 3; n++)
          k = 3 * r + n, g.fromBufferAttribute(p, k), t.push(g.x, g.y, g.z), E = 3 * r + (n + 1) % 3, g.fromBufferAttribute(p, E), t.push(g.x, g.y, g.z);
  }
  this.setAttribute("position", new Qe(t, 3));
}
mf.prototype = Object.create(it.prototype);
mf.prototype.constructor = mf;
function gf(e, t, r) {
  At.call(this), this.type = "ParametricGeometry", this.parameters = {
    func: e,
    slices: t,
    stacks: r
  }, this.fromBufferGeometry(new zu(e, t, r)), this.mergeVertices();
}
gf.prototype = Object.create(At.prototype);
gf.prototype.constructor = gf;
function zu(e, t, r) {
  it.call(this), this.type = "ParametricBufferGeometry", this.parameters = {
    func: e,
    slices: t,
    stacks: r
  };
  var n = [], i = [], a = [], s = [], o = 1e-5, u = new re(), l = new re(), c = new re(), f = new re(), h = new re(), d, g;
  e.length < 3 && console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");
  var v = t + 1;
  for (d = 0; d <= r; d++) {
    var m = d / r;
    for (g = 0; g <= t; g++) {
      var p = g / t;
      e(p, m, l), i.push(l.x, l.y, l.z), p - o >= 0 ? (e(p - o, m, c), f.subVectors(l, c)) : (e(p + o, m, c), f.subVectors(c, l)), m - o >= 0 ? (e(p, m - o, c), h.subVectors(l, c)) : (e(p, m + o, c), h.subVectors(c, l)), u.crossVectors(f, h).normalize(), a.push(u.x, u.y, u.z), s.push(p, m);
    }
  }
  for (d = 0; d < r; d++)
    for (g = 0; g < t; g++) {
      var y = d * v + g, w = d * v + g + 1, x = (d + 1) * v + g + 1, b = (d + 1) * v + g;
      n.push(y, w, b), n.push(w, x, b);
    }
  this.setIndex(n), this.setAttribute("position", new Qe(i, 3)), this.setAttribute("normal", new Qe(a, 3)), this.setAttribute("uv", new Qe(s, 2));
}
zu.prototype = Object.create(it.prototype);
zu.prototype.constructor = zu;
function yf(e, t, r, n) {
  At.call(this), this.type = "PolyhedronGeometry", this.parameters = {
    vertices: e,
    indices: t,
    radius: r,
    detail: n
  }, this.fromBufferGeometry(new Ln(e, t, r, n)), this.mergeVertices();
}
yf.prototype = Object.create(At.prototype);
yf.prototype.constructor = yf;
function Ln(e, t, r, n) {
  it.call(this), this.type = "PolyhedronBufferGeometry", this.parameters = {
    vertices: e,
    indices: t,
    radius: r,
    detail: n
  }, r = r || 1, n = n || 0;
  var i = [], a = [];
  s(n), u(r), l(), this.setAttribute("position", new Qe(i, 3)), this.setAttribute("normal", new Qe(i.slice(), 3)), this.setAttribute("uv", new Qe(a, 2)), n === 0 ? this.computeVertexNormals() : this.normalizeNormals();
  function s(p) {
    for (var y = new re(), w = new re(), x = new re(), b = 0; b < t.length; b += 3)
      h(t[b + 0], y), h(t[b + 1], w), h(t[b + 2], x), o(y, w, x, p);
  }
  function o(p, y, w, x) {
    var b = Math.pow(2, x), M = [], k, E;
    for (k = 0; k <= b; k++) {
      M[k] = [];
      var S = p.clone().lerp(w, k / b), F = y.clone().lerp(w, k / b), O = b - k;
      for (E = 0; E <= O; E++)
        E === 0 && k === b ? M[k][E] = S : M[k][E] = S.clone().lerp(F, E / O);
    }
    for (k = 0; k < b; k++)
      for (E = 0; E < 2 * (b - k) - 1; E++) {
        var D = Math.floor(E / 2);
        E % 2 === 0 ? (f(M[k][D + 1]), f(M[k + 1][D]), f(M[k][D])) : (f(M[k][D + 1]), f(M[k + 1][D + 1]), f(M[k + 1][D]));
      }
  }
  function u(p) {
    for (var y = new re(), w = 0; w < i.length; w += 3)
      y.x = i[w + 0], y.y = i[w + 1], y.z = i[w + 2], y.normalize().multiplyScalar(p), i[w + 0] = y.x, i[w + 1] = y.y, i[w + 2] = y.z;
  }
  function l() {
    for (var p = new re(), y = 0; y < i.length; y += 3) {
      p.x = i[y + 0], p.y = i[y + 1], p.z = i[y + 2];
      var w = v(p) / 2 / Math.PI + 0.5, x = m(p) / Math.PI + 0.5;
      a.push(w, 1 - x);
    }
    d(), c();
  }
  function c() {
    for (var p = 0; p < a.length; p += 6) {
      var y = a[p + 0], w = a[p + 2], x = a[p + 4], b = Math.max(y, w, x), M = Math.min(y, w, x);
      b > 0.9 && M < 0.1 && (y < 0.2 && (a[p + 0] += 1), w < 0.2 && (a[p + 2] += 1), x < 0.2 && (a[p + 4] += 1));
    }
  }
  function f(p) {
    i.push(p.x, p.y, p.z);
  }
  function h(p, y) {
    var w = p * 3;
    y.x = e[w + 0], y.y = e[w + 1], y.z = e[w + 2];
  }
  function d() {
    for (var p = new re(), y = new re(), w = new re(), x = new re(), b = new _e(), M = new _e(), k = new _e(), E = 0, S = 0; E < i.length; E += 9, S += 6) {
      p.set(i[E + 0], i[E + 1], i[E + 2]), y.set(i[E + 3], i[E + 4], i[E + 5]), w.set(i[E + 6], i[E + 7], i[E + 8]), b.set(a[S + 0], a[S + 1]), M.set(a[S + 2], a[S + 3]), k.set(a[S + 4], a[S + 5]), x.copy(p).add(y).add(w).divideScalar(3);
      var F = v(x);
      g(b, S + 0, p, F), g(M, S + 2, y, F), g(k, S + 4, w, F);
    }
  }
  function g(p, y, w, x) {
    x < 0 && p.x === 1 && (a[y] = p.x - 1), w.x === 0 && w.z === 0 && (a[y] = x / 2 / Math.PI + 0.5);
  }
  function v(p) {
    return Math.atan2(p.z, -p.x);
  }
  function m(p) {
    return Math.atan2(-p.y, Math.sqrt(p.x * p.x + p.z * p.z));
  }
}
Ln.prototype = Object.create(it.prototype);
Ln.prototype.constructor = Ln;
function bf(e, t) {
  At.call(this), this.type = "TetrahedronGeometry", this.parameters = {
    radius: e,
    detail: t
  }, this.fromBufferGeometry(new Wu(e, t)), this.mergeVertices();
}
bf.prototype = Object.create(At.prototype);
bf.prototype.constructor = bf;
function Wu(e, t) {
  var r = [
    1,
    1,
    1,
    -1,
    -1,
    1,
    -1,
    1,
    -1,
    1,
    -1,
    -1
  ], n = [
    2,
    1,
    0,
    0,
    3,
    2,
    1,
    3,
    0,
    2,
    3,
    1
  ];
  Ln.call(this, r, n, e, t), this.type = "TetrahedronBufferGeometry", this.parameters = {
    radius: e,
    detail: t
  };
}
Wu.prototype = Object.create(Ln.prototype);
Wu.prototype.constructor = Wu;
function wf(e, t) {
  At.call(this), this.type = "OctahedronGeometry", this.parameters = {
    radius: e,
    detail: t
  }, this.fromBufferGeometry(new Po(e, t)), this.mergeVertices();
}
wf.prototype = Object.create(At.prototype);
wf.prototype.constructor = wf;
function Po(e, t) {
  var r = [
    1,
    0,
    0,
    -1,
    0,
    0,
    0,
    1,
    0,
    0,
    -1,
    0,
    0,
    0,
    1,
    0,
    0,
    -1
  ], n = [
    0,
    2,
    4,
    0,
    4,
    3,
    0,
    3,
    5,
    0,
    5,
    2,
    1,
    2,
    5,
    1,
    5,
    3,
    1,
    3,
    4,
    1,
    4,
    2
  ];
  Ln.call(this, r, n, e, t), this.type = "OctahedronBufferGeometry", this.parameters = {
    radius: e,
    detail: t
  };
}
Po.prototype = Object.create(Ln.prototype);
Po.prototype.constructor = Po;
function xf(e, t) {
  At.call(this), this.type = "IcosahedronGeometry", this.parameters = {
    radius: e,
    detail: t
  }, this.fromBufferGeometry(new Vu(e, t)), this.mergeVertices();
}
xf.prototype = Object.create(At.prototype);
xf.prototype.constructor = xf;
function Vu(e, t) {
  var r = (1 + Math.sqrt(5)) / 2, n = [
    -1,
    r,
    0,
    1,
    r,
    0,
    -1,
    -r,
    0,
    1,
    -r,
    0,
    0,
    -1,
    r,
    0,
    1,
    r,
    0,
    -1,
    -r,
    0,
    1,
    -r,
    r,
    0,
    -1,
    r,
    0,
    1,
    -r,
    0,
    -1,
    -r,
    0,
    1
  ], i = [
    0,
    11,
    5,
    0,
    5,
    1,
    0,
    1,
    7,
    0,
    7,
    10,
    0,
    10,
    11,
    1,
    5,
    9,
    5,
    11,
    4,
    11,
    10,
    2,
    10,
    7,
    6,
    7,
    1,
    8,
    3,
    9,
    4,
    3,
    4,
    2,
    3,
    2,
    6,
    3,
    6,
    8,
    3,
    8,
    9,
    4,
    9,
    5,
    2,
    4,
    11,
    6,
    2,
    10,
    8,
    6,
    7,
    9,
    8,
    1
  ];
  Ln.call(this, n, i, e, t), this.type = "IcosahedronBufferGeometry", this.parameters = {
    radius: e,
    detail: t
  };
}
Vu.prototype = Object.create(Ln.prototype);
Vu.prototype.constructor = Vu;
function Mf(e, t) {
  At.call(this), this.type = "DodecahedronGeometry", this.parameters = {
    radius: e,
    detail: t
  }, this.fromBufferGeometry(new Hu(e, t)), this.mergeVertices();
}
Mf.prototype = Object.create(At.prototype);
Mf.prototype.constructor = Mf;
function Hu(e, t) {
  var r = (1 + Math.sqrt(5)) / 2, n = 1 / r, i = [
    // (1, 1, 1)
    -1,
    -1,
    -1,
    -1,
    -1,
    1,
    -1,
    1,
    -1,
    -1,
    1,
    1,
    1,
    -1,
    -1,
    1,
    -1,
    1,
    1,
    1,
    -1,
    1,
    1,
    1,
    // (0, 1/, )
    0,
    -n,
    -r,
    0,
    -n,
    r,
    0,
    n,
    -r,
    0,
    n,
    r,
    // (1/, , 0)
    -n,
    -r,
    0,
    -n,
    r,
    0,
    n,
    -r,
    0,
    n,
    r,
    0,
    // (, 0, 1/)
    -r,
    0,
    -n,
    r,
    0,
    -n,
    -r,
    0,
    n,
    r,
    0,
    n
  ], a = [
    3,
    11,
    7,
    3,
    7,
    15,
    3,
    15,
    13,
    7,
    19,
    17,
    7,
    17,
    6,
    7,
    6,
    15,
    17,
    4,
    8,
    17,
    8,
    10,
    17,
    10,
    6,
    8,
    0,
    16,
    8,
    16,
    2,
    8,
    2,
    10,
    0,
    12,
    1,
    0,
    1,
    18,
    0,
    18,
    16,
    6,
    10,
    2,
    6,
    2,
    13,
    6,
    13,
    15,
    2,
    16,
    18,
    2,
    18,
    3,
    2,
    3,
    13,
    18,
    1,
    9,
    18,
    9,
    11,
    18,
    11,
    3,
    4,
    14,
    12,
    4,
    12,
    0,
    4,
    0,
    8,
    11,
    9,
    5,
    11,
    5,
    19,
    11,
    19,
    7,
    19,
    5,
    14,
    19,
    14,
    4,
    19,
    4,
    17,
    1,
    12,
    14,
    1,
    14,
    5,
    1,
    5,
    9
  ];
  Ln.call(this, i, a, e, t), this.type = "DodecahedronBufferGeometry", this.parameters = {
    radius: e,
    detail: t
  };
}
Hu.prototype = Object.create(Ln.prototype);
Hu.prototype.constructor = Hu;
function Ef(e, t, r, n, i, a) {
  At.call(this), this.type = "TubeGeometry", this.parameters = {
    path: e,
    tubularSegments: t,
    radius: r,
    radialSegments: n,
    closed: i
  }, a !== void 0 && console.warn("THREE.TubeGeometry: taper has been removed.");
  var s = new Bo(e, t, r, n, i);
  this.tangents = s.tangents, this.normals = s.normals, this.binormals = s.binormals, this.fromBufferGeometry(s), this.mergeVertices();
}
Ef.prototype = Object.create(At.prototype);
Ef.prototype.constructor = Ef;
function Bo(e, t, r, n, i) {
  it.call(this), this.type = "TubeBufferGeometry", this.parameters = {
    path: e,
    tubularSegments: t,
    radius: r,
    radialSegments: n,
    closed: i
  }, t = t || 64, r = r || 1, n = n || 8, i = i || !1;
  var a = e.computeFrenetFrames(t, i);
  this.tangents = a.tangents, this.normals = a.normals, this.binormals = a.binormals;
  var s = new re(), o = new re(), u = new _e(), l = new re(), c, f, h = [], d = [], g = [], v = [];
  m(), this.setIndex(v), this.setAttribute("position", new Qe(h, 3)), this.setAttribute("normal", new Qe(d, 3)), this.setAttribute("uv", new Qe(g, 2));
  function m() {
    for (c = 0; c < t; c++)
      p(c);
    p(i === !1 ? t : 0), w(), y();
  }
  function p(x) {
    l = e.getPointAt(x / t, l);
    var b = a.normals[x], M = a.binormals[x];
    for (f = 0; f <= n; f++) {
      var k = f / n * Math.PI * 2, E = Math.sin(k), S = -Math.cos(k);
      o.x = S * b.x + E * M.x, o.y = S * b.y + E * M.y, o.z = S * b.z + E * M.z, o.normalize(), d.push(o.x, o.y, o.z), s.x = l.x + r * o.x, s.y = l.y + r * o.y, s.z = l.z + r * o.z, h.push(s.x, s.y, s.z);
    }
  }
  function y() {
    for (f = 1; f <= t; f++)
      for (c = 1; c <= n; c++) {
        var x = (n + 1) * (f - 1) + (c - 1), b = (n + 1) * f + (c - 1), M = (n + 1) * f + c, k = (n + 1) * (f - 1) + c;
        v.push(x, b, k), v.push(b, M, k);
      }
  }
  function w() {
    for (c = 0; c <= t; c++)
      for (f = 0; f <= n; f++)
        u.x = c / t, u.y = f / n, g.push(u.x, u.y);
  }
}
Bo.prototype = Object.create(it.prototype);
Bo.prototype.constructor = Bo;
Bo.prototype.toJSON = function() {
  var e = it.prototype.toJSON.call(this);
  return e.path = this.parameters.path.toJSON(), e;
};
function Af(e, t, r, n, i, a, s) {
  At.call(this), this.type = "TorusKnotGeometry", this.parameters = {
    radius: e,
    tube: t,
    tubularSegments: r,
    radialSegments: n,
    p: i,
    q: a
  }, s !== void 0 && console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."), this.fromBufferGeometry(new ju(e, t, r, n, i, a)), this.mergeVertices();
}
Af.prototype = Object.create(At.prototype);
Af.prototype.constructor = Af;
function ju(e, t, r, n, i, a) {
  it.call(this), this.type = "TorusKnotBufferGeometry", this.parameters = {
    radius: e,
    tube: t,
    tubularSegments: r,
    radialSegments: n,
    p: i,
    q: a
  }, e = e || 1, t = t || 0.4, r = Math.floor(r) || 64, n = Math.floor(n) || 8, i = i || 2, a = a || 3;
  var s = [], o = [], u = [], l = [], c, f, h = new re(), d = new re(), g = new re(), v = new re(), m = new re(), p = new re(), y = new re();
  for (c = 0; c <= r; ++c) {
    var w = c / r * i * Math.PI * 2;
    for (O(w, i, a, e, g), O(w + 0.01, i, a, e, v), p.subVectors(v, g), y.addVectors(v, g), m.crossVectors(p, y), y.crossVectors(m, p), m.normalize(), y.normalize(), f = 0; f <= n; ++f) {
      var x = f / n * Math.PI * 2, b = -t * Math.cos(x), M = t * Math.sin(x);
      h.x = g.x + (b * y.x + M * m.x), h.y = g.y + (b * y.y + M * m.y), h.z = g.z + (b * y.z + M * m.z), o.push(h.x, h.y, h.z), d.subVectors(h, g).normalize(), u.push(d.x, d.y, d.z), l.push(c / r), l.push(f / n);
    }
  }
  for (f = 1; f <= r; f++)
    for (c = 1; c <= n; c++) {
      var k = (n + 1) * (f - 1) + (c - 1), E = (n + 1) * f + (c - 1), S = (n + 1) * f + c, F = (n + 1) * (f - 1) + c;
      s.push(k, E, F), s.push(E, S, F);
    }
  this.setIndex(s), this.setAttribute("position", new Qe(o, 3)), this.setAttribute("normal", new Qe(u, 3)), this.setAttribute("uv", new Qe(l, 2));
  function O(D, _, L, G, V) {
    var H = Math.cos(D), U = Math.sin(D), R = L / _ * D, B = Math.cos(R);
    V.x = G * (2 + B) * 0.5 * H, V.y = G * (2 + B) * U * 0.5, V.z = G * Math.sin(R) * 0.5;
  }
}
ju.prototype = Object.create(it.prototype);
ju.prototype.constructor = ju;
function Tf(e, t, r, n, i) {
  At.call(this), this.type = "TorusGeometry", this.parameters = {
    radius: e,
    tube: t,
    radialSegments: r,
    tubularSegments: n,
    arc: i
  }, this.fromBufferGeometry(new Xu(e, t, r, n, i)), this.mergeVertices();
}
Tf.prototype = Object.create(At.prototype);
Tf.prototype.constructor = Tf;
function Xu(e, t, r, n, i) {
  it.call(this), this.type = "TorusBufferGeometry", this.parameters = {
    radius: e,
    tube: t,
    radialSegments: r,
    tubularSegments: n,
    arc: i
  }, e = e || 1, t = t || 0.4, r = Math.floor(r) || 8, n = Math.floor(n) || 6, i = i || Math.PI * 2;
  var a = [], s = [], o = [], u = [], l = new re(), c = new re(), f = new re(), h, d;
  for (h = 0; h <= r; h++)
    for (d = 0; d <= n; d++) {
      var g = d / n * i, v = h / r * Math.PI * 2;
      c.x = (e + t * Math.cos(v)) * Math.cos(g), c.y = (e + t * Math.cos(v)) * Math.sin(g), c.z = t * Math.sin(v), s.push(c.x, c.y, c.z), l.x = e * Math.cos(g), l.y = e * Math.sin(g), f.subVectors(c, l).normalize(), o.push(f.x, f.y, f.z), u.push(d / n), u.push(h / r);
    }
  for (h = 1; h <= r; h++)
    for (d = 1; d <= n; d++) {
      var m = (n + 1) * h + d - 1, p = (n + 1) * (h - 1) + d - 1, y = (n + 1) * (h - 1) + d, w = (n + 1) * h + d;
      a.push(m, p, w), a.push(p, y, w);
    }
  this.setIndex(a), this.setAttribute("position", new Qe(s, 3)), this.setAttribute("normal", new Qe(o, 3)), this.setAttribute("uv", new Qe(u, 2));
}
Xu.prototype = Object.create(it.prototype);
Xu.prototype.constructor = Xu;
var X6 = {
  triangulate: function(e, t, r) {
    r = r || 2;
    var n = t && t.length, i = n ? t[0] * r : e.length, a = Ob(e, 0, i, r, !0), s = [];
    if (!a || a.next === a.prev) return s;
    var o, u, l, c, f, h, d;
    if (n && (a = Z6(e, t, a, r)), e.length > 80 * r) {
      o = l = e[0], u = c = e[1];
      for (var g = r; g < i; g += r)
        f = e[g], h = e[g + 1], f < o && (o = f), h < u && (u = h), f > l && (l = f), h > c && (c = h);
      d = Math.max(l - o, c - u), d = d !== 0 ? 1 / d : 0;
    }
    return $u(a, s, r, o, u, d), s;
  }
};
function Ob(e, t, r, n, i) {
  var a, s;
  if (i === ok(e, t, r, n) > 0)
    for (a = t; a < r; a += n) s = Zg(a, e[a], e[a + 1], s);
  else
    for (a = r - n; a >= t; a -= n) s = Zg(a, e[a], e[a + 1], s);
  return s && fs(s, s.next) && (Ku(s), s = s.next), s;
}
function qu(e, t) {
  if (!e) return e;
  t || (t = e);
  var r = e, n;
  do
    if (n = !1, !r.steiner && (fs(r, r.next) || Kr(r.prev, r, r.next) === 0)) {
      if (Ku(r), r = t = r.prev, r === r.next) break;
      n = !0;
    } else
      r = r.next;
  while (n || r !== t);
  return t;
}
function $u(e, t, r, n, i, a, s) {
  if (e) {
    !s && a && tk(e, n, i, a);
    for (var o = e, u, l; e.prev !== e.next; ) {
      if (u = e.prev, l = e.next, a ? $6(e, n, i, a) : q6(e)) {
        t.push(u.i / r), t.push(e.i / r), t.push(l.i / r), Ku(e), e = l.next, o = l.next;
        continue;
      }
      if (e = l, e === o) {
        s ? s === 1 ? (e = Y6(e, t, r), $u(e, t, r, n, i, a, 2)) : s === 2 && K6(e, t, r, n, i, a) : $u(qu(e), t, r, n, i, a, 1);
        break;
      }
    }
  }
}
function q6(e) {
  var t = e.prev, r = e, n = e.next;
  if (Kr(t, r, n) >= 0) return !1;
  for (var i = e.next.next; i !== e.prev; ) {
    if (ho(t.x, t.y, r.x, r.y, n.x, n.y, i.x, i.y) && Kr(i.prev, i, i.next) >= 0) return !1;
    i = i.next;
  }
  return !0;
}
function $6(e, t, r, n) {
  var i = e.prev, a = e, s = e.next;
  if (Kr(i, a, s) >= 0) return !1;
  for (var o = i.x < a.x ? i.x < s.x ? i.x : s.x : a.x < s.x ? a.x : s.x, u = i.y < a.y ? i.y < s.y ? i.y : s.y : a.y < s.y ? a.y : s.y, l = i.x > a.x ? i.x > s.x ? i.x : s.x : a.x > s.x ? a.x : s.x, c = i.y > a.y ? i.y > s.y ? i.y : s.y : a.y > s.y ? a.y : s.y, f = Op(o, u, t, r, n), h = Op(l, c, t, r, n), d = e.prevZ, g = e.nextZ; d && d.z >= f && g && g.z <= h; ) {
    if (d !== e.prev && d !== e.next && ho(i.x, i.y, a.x, a.y, s.x, s.y, d.x, d.y) && Kr(d.prev, d, d.next) >= 0 || (d = d.prevZ, g !== e.prev && g !== e.next && ho(i.x, i.y, a.x, a.y, s.x, s.y, g.x, g.y) && Kr(g.prev, g, g.next) >= 0)) return !1;
    g = g.nextZ;
  }
  for (; d && d.z >= f; ) {
    if (d !== e.prev && d !== e.next && ho(i.x, i.y, a.x, a.y, s.x, s.y, d.x, d.y) && Kr(d.prev, d, d.next) >= 0) return !1;
    d = d.prevZ;
  }
  for (; g && g.z <= h; ) {
    if (g !== e.prev && g !== e.next && ho(i.x, i.y, a.x, a.y, s.x, s.y, g.x, g.y) && Kr(g.prev, g, g.next) >= 0) return !1;
    g = g.nextZ;
  }
  return !0;
}
function Y6(e, t, r) {
  var n = e;
  do {
    var i = n.prev, a = n.next.next;
    !fs(i, a) && Nb(i, n, n.next, a) && Yu(i, a) && Yu(a, i) && (t.push(i.i / r), t.push(n.i / r), t.push(a.i / r), Ku(n), Ku(n.next), n = e = a), n = n.next;
  } while (n !== e);
  return n;
}
function K6(e, t, r, n, i, a) {
  var s = e;
  do {
    for (var o = s.next.next; o !== s.prev; ) {
      if (s.i !== o.i && ik(s, o)) {
        var u = Ub(s, o);
        s = qu(s, s.next), u = qu(u, u.next), $u(s, t, r, n, i, a), $u(u, t, r, n, i, a);
        return;
      }
      o = o.next;
    }
    s = s.next;
  } while (s !== e);
}
function Z6(e, t, r, n) {
  var i = [], a, s, o, u, l;
  for (a = 0, s = t.length; a < s; a++)
    o = t[a] * n, u = a < s - 1 ? t[a + 1] * n : e.length, l = Ob(e, o, u, n, !1), l === l.next && (l.steiner = !0), i.push(nk(l));
  for (i.sort(J6), a = 0; a < i.length; a++)
    Q6(i[a], r), r = qu(r, r.next);
  return r;
}
function J6(e, t) {
  return e.x - t.x;
}
function Q6(e, t) {
  if (t = ek(e, t), t) {
    var r = Ub(t, e);
    qu(r, r.next);
  }
}
function ek(e, t) {
  var r = t, n = e.x, i = e.y, a = -1 / 0, s;
  do {
    if (i <= r.y && i >= r.next.y && r.next.y !== r.y) {
      var o = r.x + (i - r.y) * (r.next.x - r.x) / (r.next.y - r.y);
      if (o <= n && o > a) {
        if (a = o, o === n) {
          if (i === r.y) return r;
          if (i === r.next.y) return r.next;
        }
        s = r.x < r.next.x ? r : r.next;
      }
    }
    r = r.next;
  } while (r !== t);
  if (!s) return null;
  if (n === a) return s.prev;
  var u = s, l = s.x, c = s.y, f = 1 / 0, h;
  for (r = s.next; r !== u; )
    n >= r.x && r.x >= l && n !== r.x && ho(i < c ? n : a, i, l, c, i < c ? a : n, i, r.x, r.y) && (h = Math.abs(i - r.y) / (n - r.x), (h < f || h === f && r.x > s.x) && Yu(r, e) && (s = r, f = h)), r = r.next;
  return s;
}
function tk(e, t, r, n) {
  var i = e;
  do
    i.z === null && (i.z = Op(i.x, i.y, t, r, n)), i.prevZ = i.prev, i.nextZ = i.next, i = i.next;
  while (i !== e);
  i.prevZ.nextZ = null, i.prevZ = null, rk(i);
}
function rk(e) {
  var t, r, n, i, a, s, o, u, l = 1;
  do {
    for (r = e, e = null, a = null, s = 0; r; ) {
      for (s++, n = r, o = 0, t = 0; t < l && (o++, n = n.nextZ, !!n); t++)
        ;
      for (u = l; o > 0 || u > 0 && n; )
        o !== 0 && (u === 0 || !n || r.z <= n.z) ? (i = r, r = r.nextZ, o--) : (i = n, n = n.nextZ, u--), a ? a.nextZ = i : e = i, i.prevZ = a, a = i;
      r = n;
    }
    a.nextZ = null, l *= 2;
  } while (s > 1);
  return e;
}
function Op(e, t, r, n, i) {
  return e = 32767 * (e - r) * i, t = 32767 * (t - n) * i, e = (e | e << 8) & 16711935, e = (e | e << 4) & 252645135, e = (e | e << 2) & 858993459, e = (e | e << 1) & 1431655765, t = (t | t << 8) & 16711935, t = (t | t << 4) & 252645135, t = (t | t << 2) & 858993459, t = (t | t << 1) & 1431655765, e | t << 1;
}
function nk(e) {
  var t = e, r = e;
  do
    (t.x < r.x || t.x === r.x && t.y < r.y) && (r = t), t = t.next;
  while (t !== e);
  return r;
}
function ho(e, t, r, n, i, a, s, o) {
  return (i - s) * (t - o) - (e - s) * (a - o) >= 0 && (e - s) * (n - o) - (r - s) * (t - o) >= 0 && (r - s) * (a - o) - (i - s) * (n - o) >= 0;
}
function ik(e, t) {
  return e.next.i !== t.i && e.prev.i !== t.i && !ak(e, t) && Yu(e, t) && Yu(t, e) && sk(e, t);
}
function Kr(e, t, r) {
  return (t.y - e.y) * (r.x - t.x) - (t.x - e.x) * (r.y - t.y);
}
function fs(e, t) {
  return e.x === t.x && e.y === t.y;
}
function Nb(e, t, r, n) {
  return fs(e, r) && fs(t, n) || fs(e, n) && fs(r, t) ? !0 : Kr(e, t, r) > 0 != Kr(e, t, n) > 0 && Kr(r, n, e) > 0 != Kr(r, n, t) > 0;
}
function ak(e, t) {
  var r = e;
  do {
    if (r.i !== e.i && r.next.i !== e.i && r.i !== t.i && r.next.i !== t.i && Nb(r, r.next, e, t)) return !0;
    r = r.next;
  } while (r !== e);
  return !1;
}
function Yu(e, t) {
  return Kr(e.prev, e, e.next) < 0 ? Kr(e, t, e.next) >= 0 && Kr(e, e.prev, t) >= 0 : Kr(e, t, e.prev) < 0 || Kr(e, e.next, t) < 0;
}
function sk(e, t) {
  var r = e, n = !1, i = (e.x + t.x) / 2, a = (e.y + t.y) / 2;
  do
    r.y > a != r.next.y > a && r.next.y !== r.y && i < (r.next.x - r.x) * (a - r.y) / (r.next.y - r.y) + r.x && (n = !n), r = r.next;
  while (r !== e);
  return n;
}
function Ub(e, t) {
  var r = new Np(e.i, e.x, e.y), n = new Np(t.i, t.x, t.y), i = e.next, a = t.prev;
  return e.next = t, t.prev = e, r.next = i, i.prev = r, n.next = r, r.prev = n, a.next = n, n.prev = a, n;
}
function Zg(e, t, r, n) {
  var i = new Np(e, t, r);
  return n ? (i.next = n.next, i.prev = n, n.next.prev = i, n.next = i) : (i.prev = i, i.next = i), i;
}
function Ku(e) {
  e.next.prev = e.prev, e.prev.next = e.next, e.prevZ && (e.prevZ.nextZ = e.nextZ), e.nextZ && (e.nextZ.prevZ = e.prevZ);
}
function Np(e, t, r) {
  this.i = e, this.x = t, this.y = r, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1;
}
function ok(e, t, r, n) {
  for (var i = 0, a = t, s = r - n; a < r; a += n)
    i += (e[s] - e[a]) * (e[a + 1] + e[s + 1]), s = a;
  return i;
}
var La = {
  // calculate area of the contour polygon
  area: function(e) {
    for (var t = e.length, r = 0, n = t - 1, i = 0; i < t; n = i++)
      r += e[n].x * e[i].y - e[i].x * e[n].y;
    return r * 0.5;
  },
  isClockWise: function(e) {
    return La.area(e) < 0;
  },
  triangulateShape: function(e, t) {
    var r = [], n = [], i = [];
    Jg(e), Qg(r, e);
    var a = e.length;
    t.forEach(Jg);
    for (var s = 0; s < t.length; s++)
      n.push(a), a += t[s].length, Qg(r, t[s]);
    for (var o = X6.triangulate(r, n), s = 0; s < o.length; s += 3)
      i.push(o.slice(s, s + 3));
    return i;
  }
};
function Jg(e) {
  var t = e.length;
  t > 2 && e[t - 1].equals(e[0]) && e.pop();
}
function Qg(e, t) {
  for (var r = 0; r < t.length; r++)
    e.push(t[r].x), e.push(t[r].y);
}
function Lo(e, t) {
  At.call(this), this.type = "ExtrudeGeometry", this.parameters = {
    shapes: e,
    options: t
  }, this.fromBufferGeometry(new na(e, t)), this.mergeVertices();
}
Lo.prototype = Object.create(At.prototype);
Lo.prototype.constructor = Lo;
Lo.prototype.toJSON = function() {
  var e = At.prototype.toJSON.call(this), t = this.parameters.shapes, r = this.parameters.options;
  return Gb(t, r, e);
};
function na(e, t) {
  it.call(this), this.type = "ExtrudeBufferGeometry", this.parameters = {
    shapes: e,
    options: t
  }, e = Array.isArray(e) ? e : [e];
  for (var r = this, n = [], i = [], a = 0, s = e.length; a < s; a++) {
    var o = e[a];
    u(o);
  }
  this.setAttribute("position", new Qe(n, 3)), this.setAttribute("uv", new Qe(i, 2)), this.computeVertexNormals();
  function u(l) {
    var c = [], f = t.curveSegments !== void 0 ? t.curveSegments : 12, h = t.steps !== void 0 ? t.steps : 1, d = t.depth !== void 0 ? t.depth : 100, g = t.bevelEnabled !== void 0 ? t.bevelEnabled : !0, v = t.bevelThickness !== void 0 ? t.bevelThickness : 6, m = t.bevelSize !== void 0 ? t.bevelSize : v - 2, p = t.bevelOffset !== void 0 ? t.bevelOffset : 0, y = t.bevelSegments !== void 0 ? t.bevelSegments : 3, w = t.extrudePath, x = t.UVGenerator !== void 0 ? t.UVGenerator : uk;
    t.amount !== void 0 && (console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."), d = t.amount);
    var b, M = !1, k, E, S, F;
    w && (b = w.getSpacedPoints(h), M = !0, g = !1, k = w.computeFrenetFrames(h, !1), E = new re(), S = new re(), F = new re()), g || (y = 0, v = 0, m = 0, p = 0);
    var O, D, _, L = l.extractPoints(f), G = L.shape, V = L.holes, H = !La.isClockWise(G);
    if (H)
      for (G = G.reverse(), D = 0, _ = V.length; D < _; D++)
        O = V[D], La.isClockWise(O) && (V[D] = O.reverse());
    var U = La.triangulateShape(G, V), R = G;
    for (D = 0, _ = V.length; D < _; D++)
      O = V[D], G = G.concat(O);
    function B(I, A, T) {
      return A || console.error("THREE.ExtrudeGeometry: vec does not exist"), A.clone().multiplyScalar(T).add(I);
    }
    var C, Z, W, J, Q, j = G.length, q, ae = U.length;
    function pe(I, A, T) {
      var P, z, K, oe = I.x - A.x, ce = I.y - A.y, ge = T.x - I.x, Oe = T.y - I.y, Ge = oe * oe + ce * ce, We = oe * Oe - ce * ge;
      if (Math.abs(We) > Number.EPSILON) {
        var $e = Math.sqrt(Ge), pt = Math.sqrt(ge * ge + Oe * Oe), tt = A.x - ce / $e, xt = A.y + oe / $e, ht = T.x - Oe / pt, Vt = T.y + ge / pt, qe = ((ht - tt) * Oe - (Vt - xt) * ge) / (oe * Oe - ce * ge);
        P = tt + oe * qe - I.x, z = xt + ce * qe - I.y;
        var ze = P * P + z * z;
        if (ze <= 2)
          return new _e(P, z);
        K = Math.sqrt(ze / 2);
      } else {
        var He = !1;
        oe > Number.EPSILON ? ge > Number.EPSILON && (He = !0) : oe < -Number.EPSILON ? ge < -Number.EPSILON && (He = !0) : Math.sign(ce) === Math.sign(Oe) && (He = !0), He ? (P = -ce, z = oe, K = Math.sqrt(Ge)) : (P = oe, z = ce, K = Math.sqrt(Ge / 2));
      }
      return new _e(P / K, z / K);
    }
    for (var $ = [], se = 0, ve = R.length, me = ve - 1, Ae = se + 1; se < ve; se++, me++, Ae++)
      me === ve && (me = 0), Ae === ve && (Ae = 0), $[se] = pe(R[se], R[me], R[Ae]);
    var Ce = [], Ee, Y = $.concat();
    for (D = 0, _ = V.length; D < _; D++) {
      for (O = V[D], Ee = [], se = 0, ve = O.length, me = ve - 1, Ae = se + 1; se < ve; se++, me++, Ae++)
        me === ve && (me = 0), Ae === ve && (Ae = 0), Ee[se] = pe(O[se], O[me], O[Ae]);
      Ce.push(Ee), Y = Y.concat(Ee);
    }
    for (C = 0; C < y; C++) {
      for (W = C / y, J = v * Math.cos(W * Math.PI / 2), Z = m * Math.sin(W * Math.PI / 2) + p, se = 0, ve = R.length; se < ve; se++)
        Q = B(R[se], $[se], Z), Se(Q.x, Q.y, -J);
      for (D = 0, _ = V.length; D < _; D++)
        for (O = V[D], Ee = Ce[D], se = 0, ve = O.length; se < ve; se++)
          Q = B(O[se], Ee[se], Z), Se(Q.x, Q.y, -J);
    }
    for (Z = m + p, se = 0; se < j; se++)
      Q = g ? B(G[se], Y[se], Z) : G[se], M ? (S.copy(k.normals[0]).multiplyScalar(Q.x), E.copy(k.binormals[0]).multiplyScalar(Q.y), F.copy(b[0]).add(S).add(E), Se(F.x, F.y, F.z)) : Se(Q.x, Q.y, 0);
    var ee;
    for (ee = 1; ee <= h; ee++)
      for (se = 0; se < j; se++)
        Q = g ? B(G[se], Y[se], Z) : G[se], M ? (S.copy(k.normals[ee]).multiplyScalar(Q.x), E.copy(k.binormals[ee]).multiplyScalar(Q.y), F.copy(b[ee]).add(S).add(E), Se(F.x, F.y, F.z)) : Se(Q.x, Q.y, d / h * ee);
    for (C = y - 1; C >= 0; C--) {
      for (W = C / y, J = v * Math.cos(W * Math.PI / 2), Z = m * Math.sin(W * Math.PI / 2) + p, se = 0, ve = R.length; se < ve; se++)
        Q = B(R[se], $[se], Z), Se(Q.x, Q.y, d + J);
      for (D = 0, _ = V.length; D < _; D++)
        for (O = V[D], Ee = Ce[D], se = 0, ve = O.length; se < ve; se++)
          Q = B(O[se], Ee[se], Z), M ? Se(Q.x, Q.y + b[h - 1].y, b[h - 1].x + J) : Se(Q.x, Q.y, d + J);
    }
    Me(), ye();
    function Me() {
      var I = n.length / 3;
      if (g) {
        var A = 0, T = j * A;
        for (se = 0; se < ae; se++)
          q = U[se], fe(q[2] + T, q[1] + T, q[0] + T);
        for (A = h + y * 2, T = j * A, se = 0; se < ae; se++)
          q = U[se], fe(q[0] + T, q[1] + T, q[2] + T);
      } else {
        for (se = 0; se < ae; se++)
          q = U[se], fe(q[2], q[1], q[0]);
        for (se = 0; se < ae; se++)
          q = U[se], fe(q[0] + j * h, q[1] + j * h, q[2] + j * h);
      }
      r.addGroup(I, n.length / 3 - I, 0);
    }
    function ye() {
      var I = n.length / 3, A = 0;
      for (De(R, A), A += R.length, D = 0, _ = V.length; D < _; D++)
        O = V[D], De(O, A), A += O.length;
      r.addGroup(I, n.length / 3 - I, 1);
    }
    function De(I, A) {
      var T, P;
      for (se = I.length; --se >= 0; ) {
        T = se, P = se - 1, P < 0 && (P = I.length - 1);
        var z = 0, K = h + y * 2;
        for (z = 0; z < K; z++) {
          var oe = j * z, ce = j * (z + 1), ge = A + T + oe, Oe = A + P + oe, Ge = A + P + ce, We = A + T + ce;
          ke(ge, Oe, Ge, We);
        }
      }
    }
    function Se(I, A, T) {
      c.push(I), c.push(A), c.push(T);
    }
    function fe(I, A, T) {
      ne(I), ne(A), ne(T);
      var P = n.length / 3, z = x.generateTopUV(r, n, P - 3, P - 2, P - 1);
      Te(z[0]), Te(z[1]), Te(z[2]);
    }
    function ke(I, A, T, P) {
      ne(I), ne(A), ne(P), ne(A), ne(T), ne(P);
      var z = n.length / 3, K = x.generateSideWallUV(r, n, z - 6, z - 3, z - 2, z - 1);
      Te(K[0]), Te(K[1]), Te(K[3]), Te(K[1]), Te(K[2]), Te(K[3]);
    }
    function ne(I) {
      n.push(c[I * 3 + 0]), n.push(c[I * 3 + 1]), n.push(c[I * 3 + 2]);
    }
    function Te(I) {
      i.push(I.x), i.push(I.y);
    }
  }
}
na.prototype = Object.create(it.prototype);
na.prototype.constructor = na;
na.prototype.toJSON = function() {
  var e = it.prototype.toJSON.call(this), t = this.parameters.shapes, r = this.parameters.options;
  return Gb(t, r, e);
};
var uk = {
  generateTopUV: function(e, t, r, n, i) {
    var a = t[r * 3], s = t[r * 3 + 1], o = t[n * 3], u = t[n * 3 + 1], l = t[i * 3], c = t[i * 3 + 1];
    return [
      new _e(a, s),
      new _e(o, u),
      new _e(l, c)
    ];
  },
  generateSideWallUV: function(e, t, r, n, i, a) {
    var s = t[r * 3], o = t[r * 3 + 1], u = t[r * 3 + 2], l = t[n * 3], c = t[n * 3 + 1], f = t[n * 3 + 2], h = t[i * 3], d = t[i * 3 + 1], g = t[i * 3 + 2], v = t[a * 3], m = t[a * 3 + 1], p = t[a * 3 + 2];
    return Math.abs(o - c) < 0.01 ? [
      new _e(s, 1 - u),
      new _e(l, 1 - f),
      new _e(h, 1 - g),
      new _e(v, 1 - p)
    ] : [
      new _e(o, 1 - u),
      new _e(c, 1 - f),
      new _e(d, 1 - g),
      new _e(m, 1 - p)
    ];
  }
};
function Gb(e, t, r) {
  if (r.shapes = [], Array.isArray(e))
    for (var n = 0, i = e.length; n < i; n++) {
      var a = e[n];
      r.shapes.push(a.uuid);
    }
  else
    r.shapes.push(e.uuid);
  return t.extrudePath !== void 0 && (r.options.extrudePath = t.extrudePath.toJSON()), r;
}
function Sf(e, t) {
  At.call(this), this.type = "TextGeometry", this.parameters = {
    text: e,
    parameters: t
  }, this.fromBufferGeometry(new Zu(e, t)), this.mergeVertices();
}
Sf.prototype = Object.create(At.prototype);
Sf.prototype.constructor = Sf;
function Zu(e, t) {
  t = t || {};
  var r = t.font;
  if (!(r && r.isFont))
    return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."), new At();
  var n = r.generateShapes(e, t.size);
  t.depth = t.height !== void 0 ? t.height : 50, t.bevelThickness === void 0 && (t.bevelThickness = 10), t.bevelSize === void 0 && (t.bevelSize = 8), t.bevelEnabled === void 0 && (t.bevelEnabled = !1), na.call(this, n, t), this.type = "TextBufferGeometry";
}
Zu.prototype = Object.create(na.prototype);
Zu.prototype.constructor = Zu;
function kf(e, t, r, n, i, a, s) {
  At.call(this), this.type = "SphereGeometry", this.parameters = {
    radius: e,
    widthSegments: t,
    heightSegments: r,
    phiStart: n,
    phiLength: i,
    thetaStart: a,
    thetaLength: s
  }, this.fromBufferGeometry(new Fo(e, t, r, n, i, a, s)), this.mergeVertices();
}
kf.prototype = Object.create(At.prototype);
kf.prototype.constructor = kf;
function Fo(e, t, r, n, i, a, s) {
  it.call(this), this.type = "SphereBufferGeometry", this.parameters = {
    radius: e,
    widthSegments: t,
    heightSegments: r,
    phiStart: n,
    phiLength: i,
    thetaStart: a,
    thetaLength: s
  }, e = e || 1, t = Math.max(3, Math.floor(t) || 8), r = Math.max(2, Math.floor(r) || 6), n = n !== void 0 ? n : 0, i = i !== void 0 ? i : Math.PI * 2, a = a !== void 0 ? a : 0, s = s !== void 0 ? s : Math.PI;
  var o = Math.min(a + s, Math.PI), u, l, c = 0, f = [], h = new re(), d = new re(), g = [], v = [], m = [], p = [];
  for (l = 0; l <= r; l++) {
    var y = [], w = l / r, x = 0;
    for (l == 0 && a == 0 ? x = 0.5 / t : l == r && o == Math.PI && (x = -0.5 / t), u = 0; u <= t; u++) {
      var b = u / t;
      h.x = -e * Math.cos(n + b * i) * Math.sin(a + w * s), h.y = e * Math.cos(a + w * s), h.z = e * Math.sin(n + b * i) * Math.sin(a + w * s), v.push(h.x, h.y, h.z), d.copy(h).normalize(), m.push(d.x, d.y, d.z), p.push(b + x, 1 - w), y.push(c++);
    }
    f.push(y);
  }
  for (l = 0; l < r; l++)
    for (u = 0; u < t; u++) {
      var M = f[l][u + 1], k = f[l][u], E = f[l + 1][u], S = f[l + 1][u + 1];
      (l !== 0 || a > 0) && g.push(M, k, S), (l !== r - 1 || o < Math.PI) && g.push(k, E, S);
    }
  this.setIndex(g), this.setAttribute("position", new Qe(v, 3)), this.setAttribute("normal", new Qe(m, 3)), this.setAttribute("uv", new Qe(p, 2));
}
Fo.prototype = Object.create(it.prototype);
Fo.prototype.constructor = Fo;
function Cf(e, t, r, n, i, a) {
  At.call(this), this.type = "RingGeometry", this.parameters = {
    innerRadius: e,
    outerRadius: t,
    thetaSegments: r,
    phiSegments: n,
    thetaStart: i,
    thetaLength: a
  }, this.fromBufferGeometry(new Ju(e, t, r, n, i, a)), this.mergeVertices();
}
Cf.prototype = Object.create(At.prototype);
Cf.prototype.constructor = Cf;
function Ju(e, t, r, n, i, a) {
  it.call(this), this.type = "RingBufferGeometry", this.parameters = {
    innerRadius: e,
    outerRadius: t,
    thetaSegments: r,
    phiSegments: n,
    thetaStart: i,
    thetaLength: a
  }, e = e || 0.5, t = t || 1, i = i !== void 0 ? i : 0, a = a !== void 0 ? a : Math.PI * 2, r = r !== void 0 ? Math.max(3, r) : 8, n = n !== void 0 ? Math.max(1, n) : 1;
  var s = [], o = [], u = [], l = [], c, f = e, h = (t - e) / n, d = new re(), g = new _e(), v, m;
  for (v = 0; v <= n; v++) {
    for (m = 0; m <= r; m++)
      c = i + m / r * a, d.x = f * Math.cos(c), d.y = f * Math.sin(c), o.push(d.x, d.y, d.z), u.push(0, 0, 1), g.x = (d.x / t + 1) / 2, g.y = (d.y / t + 1) / 2, l.push(g.x, g.y);
    f += h;
  }
  for (v = 0; v < n; v++) {
    var p = v * (r + 1);
    for (m = 0; m < r; m++) {
      c = m + p;
      var y = c, w = c + r + 1, x = c + r + 2, b = c + 1;
      s.push(y, w, b), s.push(w, x, b);
    }
  }
  this.setIndex(s), this.setAttribute("position", new Qe(o, 3)), this.setAttribute("normal", new Qe(u, 3)), this.setAttribute("uv", new Qe(l, 2));
}
Ju.prototype = Object.create(it.prototype);
Ju.prototype.constructor = Ju;
function Df(e, t, r, n) {
  At.call(this), this.type = "LatheGeometry", this.parameters = {
    points: e,
    segments: t,
    phiStart: r,
    phiLength: n
  }, this.fromBufferGeometry(new Qu(e, t, r, n)), this.mergeVertices();
}
Df.prototype = Object.create(At.prototype);
Df.prototype.constructor = Df;
function Qu(e, t, r, n) {
  it.call(this), this.type = "LatheBufferGeometry", this.parameters = {
    points: e,
    segments: t,
    phiStart: r,
    phiLength: n
  }, t = Math.floor(t) || 12, r = r || 0, n = n || Math.PI * 2, n = It.clamp(n, 0, Math.PI * 2);
  var i = [], a = [], s = [], o, u = 1 / t, l = new re(), c = new _e(), f, h;
  for (f = 0; f <= t; f++) {
    var d = r + f * u * n, g = Math.sin(d), v = Math.cos(d);
    for (h = 0; h <= e.length - 1; h++)
      l.x = e[h].x * g, l.y = e[h].y, l.z = e[h].x * v, a.push(l.x, l.y, l.z), c.x = f / t, c.y = h / (e.length - 1), s.push(c.x, c.y);
  }
  for (f = 0; f < t; f++)
    for (h = 0; h < e.length - 1; h++) {
      o = h + f * e.length;
      var m = o, p = o + e.length, y = o + e.length + 1, w = o + 1;
      i.push(m, p, w), i.push(p, y, w);
    }
  if (this.setIndex(i), this.setAttribute("position", new Qe(a, 3)), this.setAttribute("uv", new Qe(s, 2)), this.computeVertexNormals(), n === Math.PI * 2) {
    var x = this.attributes.normal.array, b = new re(), M = new re(), k = new re();
    for (o = t * e.length * 3, f = 0, h = 0; f < e.length; f++, h += 3)
      b.x = x[h + 0], b.y = x[h + 1], b.z = x[h + 2], M.x = x[o + h + 0], M.y = x[o + h + 1], M.z = x[o + h + 2], k.addVectors(b, M).normalize(), x[h + 0] = x[o + h + 0] = k.x, x[h + 1] = x[o + h + 1] = k.y, x[h + 2] = x[o + h + 2] = k.z;
  }
}
Qu.prototype = Object.create(it.prototype);
Qu.prototype.constructor = Qu;
function Io(e, t) {
  At.call(this), this.type = "ShapeGeometry", typeof t == "object" && (console.warn("THREE.ShapeGeometry: Options parameter has been removed."), t = t.curveSegments), this.parameters = {
    shapes: e,
    curveSegments: t
  }, this.fromBufferGeometry(new Ro(e, t)), this.mergeVertices();
}
Io.prototype = Object.create(At.prototype);
Io.prototype.constructor = Io;
Io.prototype.toJSON = function() {
  var e = At.prototype.toJSON.call(this), t = this.parameters.shapes;
  return zb(t, e);
};
function Ro(e, t) {
  it.call(this), this.type = "ShapeBufferGeometry", this.parameters = {
    shapes: e,
    curveSegments: t
  }, t = t || 12;
  var r = [], n = [], i = [], a = [], s = 0, o = 0;
  if (Array.isArray(e) === !1)
    l(e);
  else
    for (var u = 0; u < e.length; u++)
      l(e[u]), this.addGroup(s, o, u), s += o, o = 0;
  this.setIndex(r), this.setAttribute("position", new Qe(n, 3)), this.setAttribute("normal", new Qe(i, 3)), this.setAttribute("uv", new Qe(a, 2));
  function l(c) {
    var f, h, d, g = n.length / 3, v = c.extractPoints(t), m = v.shape, p = v.holes;
    for (La.isClockWise(m) === !1 && (m = m.reverse()), f = 0, h = p.length; f < h; f++)
      d = p[f], La.isClockWise(d) === !0 && (p[f] = d.reverse());
    var y = La.triangulateShape(m, p);
    for (f = 0, h = p.length; f < h; f++)
      d = p[f], m = m.concat(d);
    for (f = 0, h = m.length; f < h; f++) {
      var w = m[f];
      n.push(w.x, w.y, 0), i.push(0, 0, 1), a.push(w.x, w.y);
    }
    for (f = 0, h = y.length; f < h; f++) {
      var x = y[f], b = x[0] + g, M = x[1] + g, k = x[2] + g;
      r.push(b, M, k), o += 3;
    }
  }
}
Ro.prototype = Object.create(it.prototype);
Ro.prototype.constructor = Ro;
Ro.prototype.toJSON = function() {
  var e = it.prototype.toJSON.call(this), t = this.parameters.shapes;
  return zb(t, e);
};
function zb(e, t) {
  if (t.shapes = [], Array.isArray(e))
    for (var r = 0, n = e.length; r < n; r++) {
      var i = e[r];
      t.shapes.push(i.uuid);
    }
  else
    t.shapes.push(e.uuid);
  return t;
}
function _f(e, t) {
  it.call(this), this.type = "EdgesGeometry", this.parameters = {
    thresholdAngle: t
  }, t = t !== void 0 ? t : 1;
  var r = [], n = Math.cos(It.DEG2RAD * t), i = [0, 0], a = {}, s, o, u, l = ["a", "b", "c"], c;
  e.isBufferGeometry ? (c = new At(), c.fromBufferGeometry(e)) : c = e.clone(), c.mergeVertices(), c.computeFaceNormals();
  for (var f = c.vertices, h = c.faces, d = 0, g = h.length; d < g; d++)
    for (var v = h[d], m = 0; m < 3; m++)
      s = v[l[m]], o = v[l[(m + 1) % 3]], i[0] = Math.min(s, o), i[1] = Math.max(s, o), u = i[0] + "," + i[1], a[u] === void 0 ? a[u] = { index1: i[0], index2: i[1], face1: d, face2: void 0 } : a[u].face2 = d;
  for (u in a) {
    var p = a[u];
    if (p.face2 === void 0 || h[p.face1].normal.dot(h[p.face2].normal) <= n) {
      var y = f[p.index1];
      r.push(y.x, y.y, y.z), y = f[p.index2], r.push(y.x, y.y, y.z);
    }
  }
  this.setAttribute("position", new Qe(r, 3));
}
_f.prototype = Object.create(it.prototype);
_f.prototype.constructor = _f;
function Oo(e, t, r, n, i, a, s, o) {
  At.call(this), this.type = "CylinderGeometry", this.parameters = {
    radiusTop: e,
    radiusBottom: t,
    height: r,
    radialSegments: n,
    heightSegments: i,
    openEnded: a,
    thetaStart: s,
    thetaLength: o
  }, this.fromBufferGeometry(new Ua(e, t, r, n, i, a, s, o)), this.mergeVertices();
}
Oo.prototype = Object.create(At.prototype);
Oo.prototype.constructor = Oo;
function Ua(e, t, r, n, i, a, s, o) {
  it.call(this), this.type = "CylinderBufferGeometry", this.parameters = {
    radiusTop: e,
    radiusBottom: t,
    height: r,
    radialSegments: n,
    heightSegments: i,
    openEnded: a,
    thetaStart: s,
    thetaLength: o
  };
  var u = this;
  e = e !== void 0 ? e : 1, t = t !== void 0 ? t : 1, r = r || 1, n = Math.floor(n) || 8, i = Math.floor(i) || 1, a = a !== void 0 ? a : !1, s = s !== void 0 ? s : 0, o = o !== void 0 ? o : Math.PI * 2;
  var l = [], c = [], f = [], h = [], d = 0, g = [], v = r / 2, m = 0;
  p(), a === !1 && (e > 0 && y(!0), t > 0 && y(!1)), this.setIndex(l), this.setAttribute("position", new Qe(c, 3)), this.setAttribute("normal", new Qe(f, 3)), this.setAttribute("uv", new Qe(h, 2));
  function p() {
    var w, x, b = new re(), M = new re(), k = 0, E = (t - e) / r;
    for (x = 0; x <= i; x++) {
      var S = [], F = x / i, O = F * (t - e) + e;
      for (w = 0; w <= n; w++) {
        var D = w / n, _ = D * o + s, L = Math.sin(_), G = Math.cos(_);
        M.x = O * L, M.y = -F * r + v, M.z = O * G, c.push(M.x, M.y, M.z), b.set(L, E, G).normalize(), f.push(b.x, b.y, b.z), h.push(D, 1 - F), S.push(d++);
      }
      g.push(S);
    }
    for (w = 0; w < n; w++)
      for (x = 0; x < i; x++) {
        var V = g[x][w], H = g[x + 1][w], U = g[x + 1][w + 1], R = g[x][w + 1];
        l.push(V, H, R), l.push(H, U, R), k += 6;
      }
    u.addGroup(m, k, 0), m += k;
  }
  function y(w) {
    var x, b, M, k = new _e(), E = new re(), S = 0, F = w === !0 ? e : t, O = w === !0 ? 1 : -1;
    for (b = d, x = 1; x <= n; x++)
      c.push(0, v * O, 0), f.push(0, O, 0), h.push(0.5, 0.5), d++;
    for (M = d, x = 0; x <= n; x++) {
      var D = x / n, _ = D * o + s, L = Math.cos(_), G = Math.sin(_);
      E.x = F * G, E.y = v * O, E.z = F * L, c.push(E.x, E.y, E.z), f.push(0, O, 0), k.x = L * 0.5 + 0.5, k.y = G * 0.5 * O + 0.5, h.push(k.x, k.y), d++;
    }
    for (x = 0; x < n; x++) {
      var V = b + x, H = M + x;
      w === !0 ? l.push(H, H + 1, V) : l.push(H + 1, H, V), S += 3;
    }
    u.addGroup(m, S, w === !0 ? 1 : 2), m += S;
  }
}
Ua.prototype = Object.create(it.prototype);
Ua.prototype.constructor = Ua;
function Pf(e, t, r, n, i, a, s) {
  Oo.call(this, 0, e, t, r, n, i, a, s), this.type = "ConeGeometry", this.parameters = {
    radius: e,
    height: t,
    radialSegments: r,
    heightSegments: n,
    openEnded: i,
    thetaStart: a,
    thetaLength: s
  };
}
Pf.prototype = Object.create(Oo.prototype);
Pf.prototype.constructor = Pf;
function Bf(e, t, r, n, i, a, s) {
  Ua.call(this, 0, e, t, r, n, i, a, s), this.type = "ConeBufferGeometry", this.parameters = {
    radius: e,
    height: t,
    radialSegments: r,
    heightSegments: n,
    openEnded: i,
    thetaStart: a,
    thetaLength: s
  };
}
Bf.prototype = Object.create(Ua.prototype);
Bf.prototype.constructor = Bf;
function Lf(e, t, r, n) {
  At.call(this), this.type = "CircleGeometry", this.parameters = {
    radius: e,
    segments: t,
    thetaStart: r,
    thetaLength: n
  }, this.fromBufferGeometry(new el(e, t, r, n)), this.mergeVertices();
}
Lf.prototype = Object.create(At.prototype);
Lf.prototype.constructor = Lf;
function el(e, t, r, n) {
  it.call(this), this.type = "CircleBufferGeometry", this.parameters = {
    radius: e,
    segments: t,
    thetaStart: r,
    thetaLength: n
  }, e = e || 1, t = t !== void 0 ? Math.max(3, t) : 8, r = r !== void 0 ? r : 0, n = n !== void 0 ? n : Math.PI * 2;
  var i = [], a = [], s = [], o = [], u, l, c = new re(), f = new _e();
  for (a.push(0, 0, 0), s.push(0, 0, 1), o.push(0.5, 0.5), l = 0, u = 3; l <= t; l++, u += 3) {
    var h = r + l / t * n;
    c.x = e * Math.cos(h), c.y = e * Math.sin(h), a.push(c.x, c.y, c.z), s.push(0, 0, 1), f.x = (a[u] / e + 1) / 2, f.y = (a[u + 1] / e + 1) / 2, o.push(f.x, f.y);
  }
  for (u = 1; u <= t; u++)
    i.push(u, u + 1, 0);
  this.setIndex(i), this.setAttribute("position", new Qe(a, 3)), this.setAttribute("normal", new Qe(s, 3)), this.setAttribute("uv", new Qe(o, 2));
}
el.prototype = Object.create(it.prototype);
el.prototype.constructor = el;
var fn = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  WireframeGeometry: mf,
  ParametricGeometry: gf,
  ParametricBufferGeometry: zu,
  TetrahedronGeometry: bf,
  TetrahedronBufferGeometry: Wu,
  OctahedronGeometry: wf,
  OctahedronBufferGeometry: Po,
  IcosahedronGeometry: xf,
  IcosahedronBufferGeometry: Vu,
  DodecahedronGeometry: Mf,
  DodecahedronBufferGeometry: Hu,
  PolyhedronGeometry: yf,
  PolyhedronBufferGeometry: Ln,
  TubeGeometry: Ef,
  TubeBufferGeometry: Bo,
  TorusKnotGeometry: Af,
  TorusKnotBufferGeometry: ju,
  TorusGeometry: Tf,
  TorusBufferGeometry: Xu,
  TextGeometry: Sf,
  TextBufferGeometry: Zu,
  SphereGeometry: kf,
  SphereBufferGeometry: Fo,
  RingGeometry: Cf,
  RingBufferGeometry: Ju,
  PlaneGeometry: cf,
  PlaneBufferGeometry: _o,
  LatheGeometry: Df,
  LatheBufferGeometry: Qu,
  ShapeGeometry: Io,
  ShapeBufferGeometry: Ro,
  ExtrudeGeometry: Lo,
  ExtrudeBufferGeometry: na,
  EdgesGeometry: _f,
  ConeGeometry: Pf,
  ConeBufferGeometry: Bf,
  CylinderGeometry: Oo,
  CylinderBufferGeometry: Ua,
  CircleGeometry: Lf,
  CircleBufferGeometry: el,
  BoxGeometry: ZA,
  BoxBufferGeometry: oh
});
function No(e) {
  wt.call(this), this.type = "ShadowMaterial", this.color = new nt(0), this.transparent = !0, this.setValues(e);
}
No.prototype = Object.create(wt.prototype);
No.prototype.constructor = No;
No.prototype.isShadowMaterial = !0;
No.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this;
};
function Ga(e) {
  En.call(this, e), this.type = "RawShaderMaterial";
}
Ga.prototype = Object.create(En.prototype);
Ga.prototype.constructor = Ga;
Ga.prototype.isRawShaderMaterial = !0;
function ia(e) {
  wt.call(this), this.defines = { STANDARD: "" }, this.type = "MeshStandardMaterial", this.color = new nt(16777215), this.roughness = 1, this.metalness = 0, this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new nt(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalMapType = qo, this.normalScale = new _e(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.roughnessMap = null, this.metalnessMap = null, this.alphaMap = null, this.envMap = null, this.envMapIntensity = 1, this.refractionRatio = 0.98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e);
}
ia.prototype = Object.create(wt.prototype);
ia.prototype.constructor = ia;
ia.prototype.isMeshStandardMaterial = !0;
ia.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.defines = { STANDARD: "" }, this.color.copy(e.color), this.roughness = e.roughness, this.metalness = e.metalness, this.map = e.map, this.lightMap = e.lightMap, this.lightMapIntensity = e.lightMapIntensity, this.aoMap = e.aoMap, this.aoMapIntensity = e.aoMapIntensity, this.emissive.copy(e.emissive), this.emissiveMap = e.emissiveMap, this.emissiveIntensity = e.emissiveIntensity, this.bumpMap = e.bumpMap, this.bumpScale = e.bumpScale, this.normalMap = e.normalMap, this.normalMapType = e.normalMapType, this.normalScale.copy(e.normalScale), this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this.roughnessMap = e.roughnessMap, this.metalnessMap = e.metalnessMap, this.alphaMap = e.alphaMap, this.envMap = e.envMap, this.envMapIntensity = e.envMapIntensity, this.refractionRatio = e.refractionRatio, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.wireframeLinecap = e.wireframeLinecap, this.wireframeLinejoin = e.wireframeLinejoin, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this;
};
function Uo(e) {
  ia.call(this), this.defines = {
    STANDARD: "",
    PHYSICAL: ""
  }, this.type = "MeshPhysicalMaterial", this.reflectivity = 0.5, this.clearcoat = 0, this.clearcoatRoughness = 0, this.sheen = null, this.clearcoatNormalScale = new _e(1, 1), this.clearcoatNormalMap = null, this.transparency = 0, this.setValues(e);
}
Uo.prototype = Object.create(ia.prototype);
Uo.prototype.constructor = Uo;
Uo.prototype.isMeshPhysicalMaterial = !0;
Uo.prototype.copy = function(e) {
  return ia.prototype.copy.call(this, e), this.defines = {
    STANDARD: "",
    PHYSICAL: ""
  }, this.reflectivity = e.reflectivity, this.clearcoat = e.clearcoat, this.clearcoatRoughness = e.clearcoatRoughness, e.sheen ? this.sheen = (this.sheen || new nt()).copy(e.sheen) : this.sheen = null, this.clearcoatNormalMap = e.clearcoatNormalMap, this.clearcoatNormalScale.copy(e.clearcoatNormalScale), this.transparency = e.transparency, this;
};
function Es(e) {
  wt.call(this), this.type = "MeshPhongMaterial", this.color = new nt(16777215), this.specular = new nt(1118481), this.shininess = 30, this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new nt(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalMapType = qo, this.normalScale = new _e(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = ih, this.reflectivity = 1, this.refractionRatio = 0.98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e);
}
Es.prototype = Object.create(wt.prototype);
Es.prototype.constructor = Es;
Es.prototype.isMeshPhongMaterial = !0;
Es.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.specular.copy(e.specular), this.shininess = e.shininess, this.map = e.map, this.lightMap = e.lightMap, this.lightMapIntensity = e.lightMapIntensity, this.aoMap = e.aoMap, this.aoMapIntensity = e.aoMapIntensity, this.emissive.copy(e.emissive), this.emissiveMap = e.emissiveMap, this.emissiveIntensity = e.emissiveIntensity, this.bumpMap = e.bumpMap, this.bumpScale = e.bumpScale, this.normalMap = e.normalMap, this.normalMapType = e.normalMapType, this.normalScale.copy(e.normalScale), this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this.specularMap = e.specularMap, this.alphaMap = e.alphaMap, this.envMap = e.envMap, this.combine = e.combine, this.reflectivity = e.reflectivity, this.refractionRatio = e.refractionRatio, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.wireframeLinecap = e.wireframeLinecap, this.wireframeLinejoin = e.wireframeLinejoin, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this;
};
function Go(e) {
  wt.call(this), this.defines = { TOON: "" }, this.type = "MeshToonMaterial", this.color = new nt(16777215), this.specular = new nt(1118481), this.shininess = 30, this.map = null, this.gradientMap = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new nt(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalMapType = qo, this.normalScale = new _e(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.specularMap = null, this.alphaMap = null, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e);
}
Go.prototype = Object.create(wt.prototype);
Go.prototype.constructor = Go;
Go.prototype.isMeshToonMaterial = !0;
Go.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.specular.copy(e.specular), this.shininess = e.shininess, this.map = e.map, this.gradientMap = e.gradientMap, this.lightMap = e.lightMap, this.lightMapIntensity = e.lightMapIntensity, this.aoMap = e.aoMap, this.aoMapIntensity = e.aoMapIntensity, this.emissive.copy(e.emissive), this.emissiveMap = e.emissiveMap, this.emissiveIntensity = e.emissiveIntensity, this.bumpMap = e.bumpMap, this.bumpScale = e.bumpScale, this.normalMap = e.normalMap, this.normalMapType = e.normalMapType, this.normalScale.copy(e.normalScale), this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this.specularMap = e.specularMap, this.alphaMap = e.alphaMap, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.wireframeLinecap = e.wireframeLinecap, this.wireframeLinejoin = e.wireframeLinejoin, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this;
};
function zo(e) {
  wt.call(this), this.type = "MeshNormalMaterial", this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalMapType = qo, this.normalScale = new _e(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e);
}
zo.prototype = Object.create(wt.prototype);
zo.prototype.constructor = zo;
zo.prototype.isMeshNormalMaterial = !0;
zo.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.bumpMap = e.bumpMap, this.bumpScale = e.bumpScale, this.normalMap = e.normalMap, this.normalMapType = e.normalMapType, this.normalScale.copy(e.normalScale), this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this;
};
function Wo(e) {
  wt.call(this), this.type = "MeshLambertMaterial", this.color = new nt(16777215), this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new nt(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = ih, this.reflectivity = 1, this.refractionRatio = 0.98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e);
}
Wo.prototype = Object.create(wt.prototype);
Wo.prototype.constructor = Wo;
Wo.prototype.isMeshLambertMaterial = !0;
Wo.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.color.copy(e.color), this.map = e.map, this.lightMap = e.lightMap, this.lightMapIntensity = e.lightMapIntensity, this.aoMap = e.aoMap, this.aoMapIntensity = e.aoMapIntensity, this.emissive.copy(e.emissive), this.emissiveMap = e.emissiveMap, this.emissiveIntensity = e.emissiveIntensity, this.specularMap = e.specularMap, this.alphaMap = e.alphaMap, this.envMap = e.envMap, this.combine = e.combine, this.reflectivity = e.reflectivity, this.refractionRatio = e.refractionRatio, this.wireframe = e.wireframe, this.wireframeLinewidth = e.wireframeLinewidth, this.wireframeLinecap = e.wireframeLinecap, this.wireframeLinejoin = e.wireframeLinejoin, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this;
};
function Vo(e) {
  wt.call(this), this.defines = { MATCAP: "" }, this.type = "MeshMatcapMaterial", this.color = new nt(16777215), this.matcap = null, this.map = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalMapType = qo, this.normalScale = new _e(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.alphaMap = null, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(e);
}
Vo.prototype = Object.create(wt.prototype);
Vo.prototype.constructor = Vo;
Vo.prototype.isMeshMatcapMaterial = !0;
Vo.prototype.copy = function(e) {
  return wt.prototype.copy.call(this, e), this.defines = { MATCAP: "" }, this.color.copy(e.color), this.matcap = e.matcap, this.map = e.map, this.bumpMap = e.bumpMap, this.bumpScale = e.bumpScale, this.normalMap = e.normalMap, this.normalMapType = e.normalMapType, this.normalScale.copy(e.normalScale), this.displacementMap = e.displacementMap, this.displacementScale = e.displacementScale, this.displacementBias = e.displacementBias, this.alphaMap = e.alphaMap, this.skinning = e.skinning, this.morphTargets = e.morphTargets, this.morphNormals = e.morphNormals, this;
};
function Ho(e) {
  Fr.call(this), this.type = "LineDashedMaterial", this.scale = 1, this.dashSize = 3, this.gapSize = 1, this.setValues(e);
}
Ho.prototype = Object.create(Fr.prototype);
Ho.prototype.constructor = Ho;
Ho.prototype.isLineDashedMaterial = !0;
Ho.prototype.copy = function(e) {
  return Fr.prototype.copy.call(this, e), this.scale = e.scale, this.dashSize = e.dashSize, this.gapSize = e.gapSize, this;
};
var lk = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  ShadowMaterial: No,
  SpriteMaterial: xs,
  RawShaderMaterial: Ga,
  ShaderMaterial: En,
  PointsMaterial: Ms,
  MeshPhysicalMaterial: Uo,
  MeshStandardMaterial: ia,
  MeshPhongMaterial: Es,
  MeshToonMaterial: Go,
  MeshNormalMaterial: zo,
  MeshLambertMaterial: Wo,
  MeshDepthMaterial: bs,
  MeshDistanceMaterial: ws,
  MeshBasicMaterial: fi,
  MeshMatcapMaterial: Vo,
  LineDashedMaterial: Ho,
  LineBasicMaterial: Fr,
  Material: wt
}), Br = {
  // same as Array.prototype.slice, but also works on typed arrays
  arraySlice: function(e, t, r) {
    return Br.isTypedArray(e) ? new e.constructor(e.subarray(t, r !== void 0 ? r : e.length)) : e.slice(t, r);
  },
  // converts an array to a specific type
  convertArray: function(e, t, r) {
    return !e || // let 'undefined' and 'null' pass
    !r && e.constructor === t ? e : typeof t.BYTES_PER_ELEMENT == "number" ? new t(e) : Array.prototype.slice.call(e);
  },
  isTypedArray: function(e) {
    return ArrayBuffer.isView(e) && !(e instanceof DataView);
  },
  // returns an array by which times and values can be sorted
  getKeyframeOrder: function(e) {
    function t(a, s) {
      return e[a] - e[s];
    }
    for (var r = e.length, n = new Array(r), i = 0; i !== r; ++i) n[i] = i;
    return n.sort(t), n;
  },
  // uses the array previously returned by 'getKeyframeOrder' to sort data
  sortedArray: function(e, t, r) {
    for (var n = e.length, i = new e.constructor(n), a = 0, s = 0; s !== n; ++a)
      for (var o = r[a] * t, u = 0; u !== t; ++u)
        i[s++] = e[o + u];
    return i;
  },
  // function for parsing AOS keyframe formats
  flattenJSON: function(e, t, r, n) {
    for (var i = 1, a = e[0]; a !== void 0 && a[n] === void 0; )
      a = e[i++];
    if (a !== void 0) {
      var s = a[n];
      if (s !== void 0)
        if (Array.isArray(s))
          do
            s = a[n], s !== void 0 && (t.push(a.time), r.push.apply(r, s)), a = e[i++];
          while (a !== void 0);
        else if (s.toArray !== void 0)
          do
            s = a[n], s !== void 0 && (t.push(a.time), s.toArray(r, r.length)), a = e[i++];
          while (a !== void 0);
        else
          do
            s = a[n], s !== void 0 && (t.push(a.time), r.push(s)), a = e[i++];
          while (a !== void 0);
    }
  },
  subclip: function(e, t, r, n, i) {
    i = i || 30;
    var a = e.clone();
    a.name = t;
    for (var s = [], o = 0; o < a.tracks.length; ++o) {
      for (var u = a.tracks[o], l = u.getValueSize(), c = [], f = [], h = 0; h < u.times.length; ++h) {
        var d = u.times[h] * i;
        if (!(d < r || d >= n)) {
          c.push(u.times[h]);
          for (var g = 0; g < l; ++g)
            f.push(u.values[h * l + g]);
        }
      }
      c.length !== 0 && (u.times = Br.convertArray(c, u.times.constructor), u.values = Br.convertArray(f, u.values.constructor), s.push(u));
    }
    a.tracks = s;
    for (var v = 1 / 0, o = 0; o < a.tracks.length; ++o)
      v > a.tracks[o].times[0] && (v = a.tracks[o].times[0]);
    for (var o = 0; o < a.tracks.length; ++o)
      a.tracks[o].shift(-1 * v);
    return a.resetDuration(), a;
  }
};
function Xn(e, t, r, n) {
  this.parameterPositions = e, this._cachedIndex = 0, this.resultBuffer = n !== void 0 ? n : new t.constructor(r), this.sampleValues = t, this.valueSize = r;
}
Object.assign(Xn.prototype, {
  evaluate: function(e) {
    var t = this.parameterPositions, r = this._cachedIndex, n = t[r], i = t[r - 1];
    e: {
      t: {
        var a;
        r: {
          n: if (!(e < n)) {
            for (var s = r + 2; ; ) {
              if (n === void 0) {
                if (e < i) break n;
                return r = t.length, this._cachedIndex = r, this.afterEnd_(r - 1, e, i);
              }
              if (r === s) break;
              if (i = n, n = t[++r], e < n)
                break t;
            }
            a = t.length;
            break r;
          }
          if (!(e >= i)) {
            var o = t[1];
            e < o && (r = 2, i = o);
            for (var s = r - 2; ; ) {
              if (i === void 0)
                return this._cachedIndex = 0, this.beforeStart_(0, e, n);
              if (r === s) break;
              if (n = i, i = t[--r - 1], e >= i)
                break t;
            }
            a = r, r = 0;
            break r;
          }
          break e;
        }
        for (; r < a; ) {
          var u = r + a >>> 1;
          e < t[u] ? a = u : r = u + 1;
        }
        if (n = t[r], i = t[r - 1], i === void 0)
          return this._cachedIndex = 0, this.beforeStart_(0, e, n);
        if (n === void 0)
          return r = t.length, this._cachedIndex = r, this.afterEnd_(r - 1, i, e);
      }
      this._cachedIndex = r, this.intervalChanged_(r, i, n);
    }
    return this.interpolate_(r, i, e, n);
  },
  settings: null,
  // optional, subclass-specific settings structure
  // Note: The indirection allows central control of many interpolants.
  // --- Protected interface
  DefaultSettings_: {},
  getSettings_: function() {
    return this.settings || this.DefaultSettings_;
  },
  copySampleValue_: function(e) {
    for (var t = this.resultBuffer, r = this.sampleValues, n = this.valueSize, i = e * n, a = 0; a !== n; ++a)
      t[a] = r[i + a];
    return t;
  },
  // Template methods for derived classes:
  interpolate_: function() {
    throw new Error("call to abstract method");
  },
  intervalChanged_: function() {
  }
});
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Xn.prototype, {
  //( 0, t, t0 ), returns this.resultBuffer
  beforeStart_: Xn.prototype.copySampleValue_,
  //( N-1, tN-1, t ), returns this.resultBuffer
  afterEnd_: Xn.prototype.copySampleValue_
});
function Up(e, t, r, n) {
  Xn.call(this, e, t, r, n), this._weightPrev = -0, this._offsetPrev = -0, this._weightNext = -0, this._offsetNext = -0;
}
Up.prototype = Object.assign(Object.create(Xn.prototype), {
  constructor: Up,
  DefaultSettings_: {
    endingStart: So,
    endingEnd: So
  },
  intervalChanged_: function(e, t, r) {
    var n = this.parameterPositions, i = e - 2, a = e + 1, s = n[i], o = n[a];
    if (s === void 0)
      switch (this.getSettings_().endingStart) {
        case uo:
          i = e, s = 2 * t - r;
          break;
        case uf:
          i = n.length - 2, s = t + n[i] - n[i + 1];
          break;
        default:
          i = e, s = r;
      }
    if (o === void 0)
      switch (this.getSettings_().endingEnd) {
        case uo:
          a = e, o = 2 * r - t;
          break;
        case uf:
          a = 1, o = r + n[1] - n[0];
          break;
        default:
          a = e - 1, o = t;
      }
    var u = (r - t) * 0.5, l = this.valueSize;
    this._weightPrev = u / (t - s), this._weightNext = u / (o - r), this._offsetPrev = i * l, this._offsetNext = a * l;
  },
  interpolate_: function(e, t, r, n) {
    for (var i = this.resultBuffer, a = this.sampleValues, s = this.valueSize, o = e * s, u = o - s, l = this._offsetPrev, c = this._offsetNext, f = this._weightPrev, h = this._weightNext, d = (r - t) / (n - t), g = d * d, v = g * d, m = -f * v + 2 * f * g - f * d, p = (1 + f) * v + (-1.5 - 2 * f) * g + (-0.5 + f) * d + 1, y = (-1 - h) * v + (1.5 + h) * g + 0.5 * d, w = h * v - h * g, x = 0; x !== s; ++x)
      i[x] = m * a[l + x] + p * a[u + x] + y * a[o + x] + w * a[c + x];
    return i;
  }
});
function Ff(e, t, r, n) {
  Xn.call(this, e, t, r, n);
}
Ff.prototype = Object.assign(Object.create(Xn.prototype), {
  constructor: Ff,
  interpolate_: function(e, t, r, n) {
    for (var i = this.resultBuffer, a = this.sampleValues, s = this.valueSize, o = e * s, u = o - s, l = (r - t) / (n - t), c = 1 - l, f = 0; f !== s; ++f)
      i[f] = a[u + f] * c + a[o + f] * l;
    return i;
  }
});
function Gp(e, t, r, n) {
  Xn.call(this, e, t, r, n);
}
Gp.prototype = Object.assign(Object.create(Xn.prototype), {
  constructor: Gp,
  interpolate_: function(e) {
    return this.copySampleValue_(e - 1);
  }
});
function sn(e, t, r, n) {
  if (e === void 0) throw new Error("THREE.KeyframeTrack: track name is undefined");
  if (t === void 0 || t.length === 0) throw new Error("THREE.KeyframeTrack: no keyframes in track named " + e);
  this.name = e, this.times = Br.convertArray(t, this.TimeBufferType), this.values = Br.convertArray(r, this.ValueBufferType), this.setInterpolation(n || this.DefaultInterpolation);
}
Object.assign(sn, {
  // Serialization (in static context, because of constructor invocation
  // and automatic invocation of .toJSON):
  toJSON: function(e) {
    var t = e.constructor, r;
    if (t.toJSON !== void 0)
      r = t.toJSON(e);
    else {
      r = {
        name: e.name,
        times: Br.convertArray(e.times, Array),
        values: Br.convertArray(e.values, Array)
      };
      var n = e.getInterpolation();
      n !== e.DefaultInterpolation && (r.interpolation = n);
    }
    return r.type = e.ValueTypeName, r;
  }
});
Object.assign(sn.prototype, {
  constructor: sn,
  TimeBufferType: Float32Array,
  ValueBufferType: Float32Array,
  DefaultInterpolation: Ec,
  InterpolantFactoryMethodDiscrete: function(e) {
    return new Gp(this.times, this.values, this.getValueSize(), e);
  },
  InterpolantFactoryMethodLinear: function(e) {
    return new Ff(this.times, this.values, this.getValueSize(), e);
  },
  InterpolantFactoryMethodSmooth: function(e) {
    return new Up(this.times, this.values, this.getValueSize(), e);
  },
  setInterpolation: function(e) {
    var t;
    switch (e) {
      case of:
        t = this.InterpolantFactoryMethodDiscrete;
        break;
      case Ec:
        t = this.InterpolantFactoryMethodLinear;
        break;
      case Gh:
        t = this.InterpolantFactoryMethodSmooth;
        break;
    }
    if (t === void 0) {
      var r = "unsupported interpolation for " + this.ValueTypeName + " keyframe track named " + this.name;
      if (this.createInterpolant === void 0)
        if (e !== this.DefaultInterpolation)
          this.setInterpolation(this.DefaultInterpolation);
        else
          throw new Error(r);
      return console.warn("THREE.KeyframeTrack:", r), this;
    }
    return this.createInterpolant = t, this;
  },
  getInterpolation: function() {
    switch (this.createInterpolant) {
      case this.InterpolantFactoryMethodDiscrete:
        return of;
      case this.InterpolantFactoryMethodLinear:
        return Ec;
      case this.InterpolantFactoryMethodSmooth:
        return Gh;
    }
  },
  getValueSize: function() {
    return this.values.length / this.times.length;
  },
  // move all keyframes either forwards or backwards in time
  shift: function(e) {
    if (e !== 0)
      for (var t = this.times, r = 0, n = t.length; r !== n; ++r)
        t[r] += e;
    return this;
  },
  // scale all keyframe times by a factor (useful for frame <-> seconds conversions)
  scale: function(e) {
    if (e !== 1)
      for (var t = this.times, r = 0, n = t.length; r !== n; ++r)
        t[r] *= e;
    return this;
  },
  // removes keyframes before and after animation without changing any values within the range [startTime, endTime].
  // IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values
  trim: function(e, t) {
    for (var r = this.times, n = r.length, i = 0, a = n - 1; i !== n && r[i] < e; )
      ++i;
    for (; a !== -1 && r[a] > t; )
      --a;
    if (++a, i !== 0 || a !== n) {
      i >= a && (a = Math.max(a, 1), i = a - 1);
      var s = this.getValueSize();
      this.times = Br.arraySlice(r, i, a), this.values = Br.arraySlice(this.values, i * s, a * s);
    }
    return this;
  },
  // ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable
  validate: function() {
    var e = !0, t = this.getValueSize();
    t - Math.floor(t) !== 0 && (console.error("THREE.KeyframeTrack: Invalid value size in track.", this), e = !1);
    var r = this.times, n = this.values, i = r.length;
    i === 0 && (console.error("THREE.KeyframeTrack: Track is empty.", this), e = !1);
    for (var a = null, s = 0; s !== i; s++) {
      var o = r[s];
      if (typeof o == "number" && isNaN(o)) {
        console.error("THREE.KeyframeTrack: Time is not a valid number.", this, s, o), e = !1;
        break;
      }
      if (a !== null && a > o) {
        console.error("THREE.KeyframeTrack: Out of order keys.", this, s, o, a), e = !1;
        break;
      }
      a = o;
    }
    if (n !== void 0 && Br.isTypedArray(n))
      for (var s = 0, u = n.length; s !== u; ++s) {
        var l = n[s];
        if (isNaN(l)) {
          console.error("THREE.KeyframeTrack: Value is not a valid number.", this, s, l), e = !1;
          break;
        }
      }
    return e;
  },
  // removes equivalent sequential keys as common in morph target sequences
  // (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)
  optimize: function() {
    for (var e = Br.arraySlice(this.times), t = Br.arraySlice(this.values), r = this.getValueSize(), n = this.getInterpolation() === Gh, i = 1, a = e.length - 1, s = 1; s < a; ++s) {
      var o = !1, u = e[s], l = e[s + 1];
      if (u !== l && (s !== 1 || u !== u[0]))
        if (n)
          o = !0;
        else
          for (var c = s * r, f = c - r, h = c + r, d = 0; d !== r; ++d) {
            var g = t[c + d];
            if (g !== t[f + d] || g !== t[h + d]) {
              o = !0;
              break;
            }
          }
      if (o) {
        if (s !== i) {
          e[i] = e[s];
          for (var v = s * r, m = i * r, d = 0; d !== r; ++d)
            t[m + d] = t[v + d];
        }
        ++i;
      }
    }
    if (a > 0) {
      e[i] = e[a];
      for (var v = a * r, m = i * r, d = 0; d !== r; ++d)
        t[m + d] = t[v + d];
      ++i;
    }
    return i !== e.length ? (this.times = Br.arraySlice(e, 0, i), this.values = Br.arraySlice(t, 0, i * r)) : (this.times = e, this.values = t), this;
  },
  clone: function() {
    var e = Br.arraySlice(this.times, 0), t = Br.arraySlice(this.values, 0), r = this.constructor, n = new r(this.name, e, t);
    return n.createInterpolant = this.createInterpolant, n;
  }
});
function zp(e, t, r) {
  sn.call(this, e, t, r);
}
zp.prototype = Object.assign(Object.create(sn.prototype), {
  constructor: zp,
  ValueTypeName: "bool",
  ValueBufferType: Array,
  DefaultInterpolation: of,
  InterpolantFactoryMethodLinear: void 0,
  InterpolantFactoryMethodSmooth: void 0
  // Note: Actually this track could have a optimized / compressed
  // representation of a single value and a custom interpolant that
  // computes "firstValue ^ isOdd( index )".
});
function Wp(e, t, r, n) {
  sn.call(this, e, t, r, n);
}
Wp.prototype = Object.assign(Object.create(sn.prototype), {
  constructor: Wp,
  ValueTypeName: "color"
  // ValueBufferType is inherited
  // DefaultInterpolation is inherited
  // Note: Very basic implementation and nothing special yet.
  // However, this is the place for color space parameterization.
});
function tl(e, t, r, n) {
  sn.call(this, e, t, r, n);
}
tl.prototype = Object.assign(Object.create(sn.prototype), {
  constructor: tl,
  ValueTypeName: "number"
  // ValueBufferType is inherited
  // DefaultInterpolation is inherited
});
function Vp(e, t, r, n) {
  Xn.call(this, e, t, r, n);
}
Vp.prototype = Object.assign(Object.create(Xn.prototype), {
  constructor: Vp,
  interpolate_: function(e, t, r, n) {
    for (var i = this.resultBuffer, a = this.sampleValues, s = this.valueSize, o = e * s, u = (r - t) / (n - t), l = o + s; o !== l; o += 4)
      Tn.slerpFlat(i, 0, a, o - s, a, o, u);
    return i;
  }
});
function If(e, t, r, n) {
  sn.call(this, e, t, r, n);
}
If.prototype = Object.assign(Object.create(sn.prototype), {
  constructor: If,
  ValueTypeName: "quaternion",
  // ValueBufferType is inherited
  DefaultInterpolation: Ec,
  InterpolantFactoryMethodLinear: function(e) {
    return new Vp(this.times, this.values, this.getValueSize(), e);
  },
  InterpolantFactoryMethodSmooth: void 0
  // not yet implemented
});
function Hp(e, t, r, n) {
  sn.call(this, e, t, r, n);
}
Hp.prototype = Object.assign(Object.create(sn.prototype), {
  constructor: Hp,
  ValueTypeName: "string",
  ValueBufferType: Array,
  DefaultInterpolation: of,
  InterpolantFactoryMethodLinear: void 0,
  InterpolantFactoryMethodSmooth: void 0
});
function rl(e, t, r, n) {
  sn.call(this, e, t, r, n);
}
rl.prototype = Object.assign(Object.create(sn.prototype), {
  constructor: rl,
  ValueTypeName: "vector"
  // ValueBufferType is inherited
  // DefaultInterpolation is inherited
});
function oi(e, t, r) {
  this.name = e, this.tracks = r, this.duration = t !== void 0 ? t : -1, this.uuid = It.generateUUID(), this.duration < 0 && this.resetDuration();
}
function ck(e) {
  switch (e.toLowerCase()) {
    case "scalar":
    case "double":
    case "float":
    case "number":
    case "integer":
      return tl;
    case "vector":
    case "vector2":
    case "vector3":
    case "vector4":
      return rl;
    case "color":
      return Wp;
    case "quaternion":
      return If;
    case "bool":
    case "boolean":
      return zp;
    case "string":
      return Hp;
  }
  throw new Error("THREE.KeyframeTrack: Unsupported typeName: " + e);
}
function fk(e) {
  if (e.type === void 0)
    throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");
  var t = ck(e.type);
  if (e.times === void 0) {
    var r = [], n = [];
    Br.flattenJSON(e.keys, r, n, "value"), e.times = r, e.values = n;
  }
  return t.parse !== void 0 ? t.parse(e) : new t(e.name, e.times, e.values, e.interpolation);
}
Object.assign(oi, {
  parse: function(e) {
    for (var t = [], r = e.tracks, n = 1 / (e.fps || 1), i = 0, a = r.length; i !== a; ++i)
      t.push(fk(r[i]).scale(n));
    return new oi(e.name, e.duration, t);
  },
  toJSON: function(e) {
    for (var t = [], r = e.tracks, n = {
      name: e.name,
      duration: e.duration,
      tracks: t,
      uuid: e.uuid
    }, i = 0, a = r.length; i !== a; ++i)
      t.push(sn.toJSON(r[i]));
    return n;
  },
  CreateFromMorphTargetSequence: function(e, t, r, n) {
    for (var i = t.length, a = [], s = 0; s < i; s++) {
      var o = [], u = [];
      o.push(
        (s + i - 1) % i,
        s,
        (s + 1) % i
      ), u.push(0, 1, 0);
      var l = Br.getKeyframeOrder(o);
      o = Br.sortedArray(o, 1, l), u = Br.sortedArray(u, 1, l), !n && o[0] === 0 && (o.push(i), u.push(u[0])), a.push(
        new tl(
          ".morphTargetInfluences[" + t[s].name + "]",
          o,
          u
        ).scale(1 / r)
      );
    }
    return new oi(e, -1, a);
  },
  findByName: function(e, t) {
    var r = e;
    if (!Array.isArray(e)) {
      var n = e;
      r = n.geometry && n.geometry.animations || n.animations;
    }
    for (var i = 0; i < r.length; i++)
      if (r[i].name === t)
        return r[i];
    return null;
  },
  CreateClipsFromMorphTargetSequences: function(e, t, r) {
    for (var n = {}, i = /^([\w-]*?)([\d]+)$/, a = 0, s = e.length; a < s; a++) {
      var o = e[a], u = o.name.match(i);
      if (u && u.length > 1) {
        var l = u[1], c = n[l];
        c || (n[l] = c = []), c.push(o);
      }
    }
    var f = [];
    for (var l in n)
      f.push(oi.CreateFromMorphTargetSequence(l, n[l], t, r));
    return f;
  },
  // parse the animation.hierarchy format
  parseAnimation: function(e, t) {
    if (!e)
      return console.error("THREE.AnimationClip: No animation in JSONLoader data."), null;
    for (var r = function(w, x, b, M, k) {
      if (b.length !== 0) {
        var E = [], S = [];
        Br.flattenJSON(b, E, S, M), E.length !== 0 && k.push(new w(x, E, S));
      }
    }, n = [], i = e.name || "default", a = e.length || -1, s = e.fps || 30, o = e.hierarchy || [], u = 0; u < o.length; u++) {
      var l = o[u].keys;
      if (!(!l || l.length === 0))
        if (l[0].morphTargets) {
          for (var c = {}, f = 0; f < l.length; f++)
            if (l[f].morphTargets)
              for (var h = 0; h < l[f].morphTargets.length; h++)
                c[l[f].morphTargets[h]] = -1;
          for (var d in c) {
            for (var g = [], v = [], h = 0; h !== l[f].morphTargets.length; ++h) {
              var m = l[f];
              g.push(m.time), v.push(m.morphTarget === d ? 1 : 0);
            }
            n.push(new tl(".morphTargetInfluence[" + d + "]", g, v));
          }
          a = c.length * s;
        } else {
          var p = ".bones[" + t[u].name + "]";
          r(
            rl,
            p + ".position",
            l,
            "pos",
            n
          ), r(
            If,
            p + ".quaternion",
            l,
            "rot",
            n
          ), r(
            rl,
            p + ".scale",
            l,
            "scl",
            n
          );
        }
    }
    if (n.length === 0)
      return null;
    var y = new oi(i, a, n);
    return y;
  }
});
Object.assign(oi.prototype, {
  resetDuration: function() {
    for (var e = this.tracks, t = 0, r = 0, n = e.length; r !== n; ++r) {
      var i = this.tracks[r];
      t = Math.max(t, i.times[i.times.length - 1]);
    }
    return this.duration = t, this;
  },
  trim: function() {
    for (var e = 0; e < this.tracks.length; e++)
      this.tracks[e].trim(0, this.duration);
    return this;
  },
  validate: function() {
    for (var e = !0, t = 0; t < this.tracks.length; t++)
      e = e && this.tracks[t].validate();
    return e;
  },
  optimize: function() {
    for (var e = 0; e < this.tracks.length; e++)
      this.tracks[e].optimize();
    return this;
  },
  clone: function() {
    for (var e = [], t = 0; t < this.tracks.length; t++)
      e.push(this.tracks[t].clone());
    return new oi(this.name, this.duration, e);
  }
});
var jo = {
  enabled: !1,
  files: {},
  add: function(e, t) {
    this.enabled !== !1 && (this.files[e] = t);
  },
  get: function(e) {
    if (this.enabled !== !1)
      return this.files[e];
  },
  remove: function(e) {
    delete this.files[e];
  },
  clear: function() {
    this.files = {};
  }
};
function Wb(e, t, r) {
  var n = this, i = !1, a = 0, s = 0, o = void 0, u = [];
  this.onStart = void 0, this.onLoad = e, this.onProgress = t, this.onError = r, this.itemStart = function(l) {
    s++, i === !1 && n.onStart !== void 0 && n.onStart(l, a, s), i = !0;
  }, this.itemEnd = function(l) {
    a++, n.onProgress !== void 0 && n.onProgress(l, a, s), a === s && (i = !1, n.onLoad !== void 0 && n.onLoad());
  }, this.itemError = function(l) {
    n.onError !== void 0 && n.onError(l);
  }, this.resolveURL = function(l) {
    return o ? o(l) : l;
  }, this.setURLModifier = function(l) {
    return o = l, this;
  }, this.addHandler = function(l, c) {
    return u.push(l, c), this;
  }, this.removeHandler = function(l) {
    var c = u.indexOf(l);
    return c !== -1 && u.splice(c, 2), this;
  }, this.getHandler = function(l) {
    for (var c = 0, f = u.length; c < f; c += 2) {
      var h = u[c], d = u[c + 1];
      if (h.global && (h.lastIndex = 0), h.test(l))
        return d;
    }
    return null;
  };
}
var hk = new Wb();
function er(e) {
  this.manager = e !== void 0 ? e : hk, this.crossOrigin = "anonymous", this.path = "", this.resourcePath = "";
}
Object.assign(er.prototype, {
  load: function() {
  },
  parse: function() {
  },
  setCrossOrigin: function(e) {
    return this.crossOrigin = e, this;
  },
  setPath: function(e) {
    return this.path = e, this;
  },
  setResourcePath: function(e) {
    return this.resourcePath = e, this;
  }
});
var ii = {};
function Pi(e) {
  er.call(this, e);
}
Pi.prototype = Object.assign(Object.create(er.prototype), {
  constructor: Pi,
  load: function(e, t, r, n) {
    e === void 0 && (e = ""), this.path !== void 0 && (e = this.path + e), e = this.manager.resolveURL(e);
    var i = this, a = jo.get(e);
    if (a !== void 0)
      return i.manager.itemStart(e), setTimeout(function() {
        t && t(a), i.manager.itemEnd(e);
      }, 0), a;
    if (ii[e] !== void 0) {
      ii[e].push({
        onLoad: t,
        onProgress: r,
        onError: n
      });
      return;
    }
    var s = /^data:(.*?)(;base64)?,(.*)$/, o = e.match(s);
    if (o) {
      var u = o[1], l = !!o[2], c = o[3];
      c = decodeURIComponent(c), l && (c = atob(c));
      try {
        var f, h = (this.responseType || "").toLowerCase();
        switch (h) {
          case "arraybuffer":
          case "blob":
            for (var d = new Uint8Array(c.length), g = 0; g < c.length; g++)
              d[g] = c.charCodeAt(g);
            h === "blob" ? f = new Blob([d.buffer], { type: u }) : f = d.buffer;
            break;
          case "document":
            var v = new DOMParser();
            f = v.parseFromString(c, u);
            break;
          case "json":
            f = JSON.parse(c);
            break;
          default:
            f = c;
            break;
        }
        setTimeout(function() {
          t && t(f), i.manager.itemEnd(e);
        }, 0);
      } catch (y) {
        setTimeout(function() {
          n && n(y), i.manager.itemError(e), i.manager.itemEnd(e);
        }, 0);
      }
    } else {
      ii[e] = [], ii[e].push({
        onLoad: t,
        onProgress: r,
        onError: n
      });
      var m = new XMLHttpRequest();
      m.open("GET", e, !0), m.addEventListener("load", function(y) {
        var w = this.response, x = ii[e];
        if (delete ii[e], this.status === 200 || this.status === 0) {
          this.status === 0 && console.warn("THREE.FileLoader: HTTP Status 0 received."), jo.add(e, w);
          for (var b = 0, M = x.length; b < M; b++) {
            var k = x[b];
            k.onLoad && k.onLoad(w);
          }
          i.manager.itemEnd(e);
        } else {
          for (var b = 0, M = x.length; b < M; b++) {
            var k = x[b];
            k.onError && k.onError(y);
          }
          i.manager.itemError(e), i.manager.itemEnd(e);
        }
      }, !1), m.addEventListener("progress", function(y) {
        for (var w = ii[e], x = 0, b = w.length; x < b; x++) {
          var M = w[x];
          M.onProgress && M.onProgress(y);
        }
      }, !1), m.addEventListener("error", function(y) {
        var w = ii[e];
        delete ii[e];
        for (var x = 0, b = w.length; x < b; x++) {
          var M = w[x];
          M.onError && M.onError(y);
        }
        i.manager.itemError(e), i.manager.itemEnd(e);
      }, !1), m.addEventListener("abort", function(y) {
        var w = ii[e];
        delete ii[e];
        for (var x = 0, b = w.length; x < b; x++) {
          var M = w[x];
          M.onError && M.onError(y);
        }
        i.manager.itemError(e), i.manager.itemEnd(e);
      }, !1), this.responseType !== void 0 && (m.responseType = this.responseType), this.withCredentials !== void 0 && (m.withCredentials = this.withCredentials), m.overrideMimeType && m.overrideMimeType(this.mimeType !== void 0 ? this.mimeType : "text/plain");
      for (var p in this.requestHeader)
        m.setRequestHeader(p, this.requestHeader[p]);
      m.send(null);
    }
    return i.manager.itemStart(e), m;
  },
  setResponseType: function(e) {
    return this.responseType = e, this;
  },
  setWithCredentials: function(e) {
    return this.withCredentials = e, this;
  },
  setMimeType: function(e) {
    return this.mimeType = e, this;
  },
  setRequestHeader: function(e) {
    return this.requestHeader = e, this;
  }
});
function ey(e) {
  er.call(this, e);
}
ey.prototype = Object.assign(Object.create(er.prototype), {
  constructor: ey,
  load: function(e, t, r, n) {
    var i = this, a = new Pi(i.manager);
    a.setPath(i.path), a.load(e, function(s) {
      t(i.parse(JSON.parse(s)));
    }, r, n);
  },
  parse: function(e) {
    for (var t = [], r = 0; r < e.length; r++) {
      var n = oi.parse(e[r]);
      t.push(n);
    }
    return t;
  }
});
function ty(e) {
  er.call(this, e);
}
ty.prototype = Object.assign(Object.create(er.prototype), {
  constructor: ty,
  load: function(e, t, r, n) {
    var i = this, a = [], s = new Gu();
    s.image = a;
    var o = new Pi(this.manager);
    o.setPath(this.path), o.setResponseType("arraybuffer");
    function u(h) {
      o.load(e[h], function(d) {
        var g = i.parse(d, !0);
        a[h] = {
          width: g.width,
          height: g.height,
          format: g.format,
          mipmaps: g.mipmaps
        }, l += 1, l === 6 && (g.mipmapCount === 1 && (s.minFilter = Vr), s.format = g.format, s.needsUpdate = !0, t && t(s));
      }, r, n);
    }
    if (Array.isArray(e))
      for (var l = 0, c = 0, f = e.length; c < f; ++c)
        u(c);
    else
      o.load(e, function(h) {
        var d = i.parse(h, !0);
        if (d.isCubemap)
          for (var g = d.mipmaps.length / d.mipmapCount, v = 0; v < g; v++) {
            a[v] = { mipmaps: [] };
            for (var m = 0; m < d.mipmapCount; m++)
              a[v].mipmaps.push(d.mipmaps[v * d.mipmapCount + m]), a[v].format = d.format, a[v].width = d.width, a[v].height = d.height;
          }
        else
          s.image.width = d.width, s.image.height = d.height, s.mipmaps = d.mipmaps;
        d.mipmapCount === 1 && (s.minFilter = Vr), s.format = d.format, s.needsUpdate = !0, t && t(s);
      }, r, n);
    return s;
  }
});
function jp(e) {
  er.call(this, e);
}
jp.prototype = Object.assign(Object.create(er.prototype), {
  constructor: jp,
  load: function(e, t, r, n) {
    var i = this, a = new Do(), s = new Pi(this.manager);
    return s.setResponseType("arraybuffer"), s.setPath(this.path), s.load(e, function(o) {
      var u = i.parse(o);
      u && (u.image !== void 0 ? a.image = u.image : u.data !== void 0 && (a.image.width = u.width, a.image.height = u.height, a.image.data = u.data), a.wrapS = u.wrapS !== void 0 ? u.wrapS : Mn, a.wrapT = u.wrapT !== void 0 ? u.wrapT : Mn, a.magFilter = u.magFilter !== void 0 ? u.magFilter : Vr, a.minFilter = u.minFilter !== void 0 ? u.minFilter : Vr, a.anisotropy = u.anisotropy !== void 0 ? u.anisotropy : 1, u.format !== void 0 && (a.format = u.format), u.type !== void 0 && (a.type = u.type), u.mipmaps !== void 0 && (a.mipmaps = u.mipmaps, a.minFilter = xl), u.mipmapCount === 1 && (a.minFilter = Vr), a.needsUpdate = !0, t && t(a, u));
    }, r, n), a;
  }
});
function nl(e) {
  er.call(this, e);
}
nl.prototype = Object.assign(Object.create(er.prototype), {
  constructor: nl,
  load: function(e, t, r, n) {
    this.path !== void 0 && (e = this.path + e), e = this.manager.resolveURL(e);
    var i = this, a = jo.get(e);
    if (a !== void 0)
      return i.manager.itemStart(e), setTimeout(function() {
        t && t(a), i.manager.itemEnd(e);
      }, 0), a;
    var s = document.createElementNS("http://www.w3.org/1999/xhtml", "img");
    function o() {
      s.removeEventListener("load", o, !1), s.removeEventListener("error", u, !1), jo.add(e, this), t && t(this), i.manager.itemEnd(e);
    }
    function u(l) {
      s.removeEventListener("load", o, !1), s.removeEventListener("error", u, !1), n && n(l), i.manager.itemError(e), i.manager.itemEnd(e);
    }
    return s.addEventListener("load", o, !1), s.addEventListener("error", u, !1), e.substr(0, 5) !== "data:" && this.crossOrigin !== void 0 && (s.crossOrigin = this.crossOrigin), i.manager.itemStart(e), s.src = e, s;
  }
});
function Xp(e) {
  er.call(this, e);
}
Xp.prototype = Object.assign(Object.create(er.prototype), {
  constructor: Xp,
  load: function(e, t, r, n) {
    var i = new Oa(), a = new nl(this.manager);
    a.setCrossOrigin(this.crossOrigin), a.setPath(this.path);
    var s = 0;
    function o(l) {
      a.load(e[l], function(c) {
        i.images[l] = c, s++, s === 6 && (i.needsUpdate = !0, t && t(i));
      }, void 0, n);
    }
    for (var u = 0; u < e.length; ++u)
      o(u);
    return i;
  }
});
function qp(e) {
  er.call(this, e);
}
qp.prototype = Object.assign(Object.create(er.prototype), {
  constructor: qp,
  load: function(e, t, r, n) {
    var i = new ur(), a = new nl(this.manager);
    return a.setCrossOrigin(this.crossOrigin), a.setPath(this.path), a.load(e, function(s) {
      i.image = s;
      var o = e.search(/\.jpe?g($|\?)/i) > 0 || e.search(/^data\:image\/jpeg/) === 0;
      i.format = o ? gs : _i, i.needsUpdate = !0, t !== void 0 && t(i);
    }, r, n), i;
  }
});
function ft() {
  this.type = "Curve", this.arcLengthDivisions = 200;
}
Object.assign(ft.prototype, {
  // Virtual base class method to overwrite and implement in subclasses
  //	- t [0 .. 1]
  getPoint: function() {
    return console.warn("THREE.Curve: .getPoint() not implemented."), null;
  },
  // Get point at relative position in curve according to arc length
  // - u [0 .. 1]
  getPointAt: function(e, t) {
    var r = this.getUtoTmapping(e);
    return this.getPoint(r, t);
  },
  // Get sequence of points using getPoint( t )
  getPoints: function(e) {
    e === void 0 && (e = 5);
    for (var t = [], r = 0; r <= e; r++)
      t.push(this.getPoint(r / e));
    return t;
  },
  // Get sequence of points using getPointAt( u )
  getSpacedPoints: function(e) {
    e === void 0 && (e = 5);
    for (var t = [], r = 0; r <= e; r++)
      t.push(this.getPointAt(r / e));
    return t;
  },
  // Get total curve arc length
  getLength: function() {
    var e = this.getLengths();
    return e[e.length - 1];
  },
  // Get list of cumulative segment lengths
  getLengths: function(e) {
    if (e === void 0 && (e = this.arcLengthDivisions), this.cacheArcLengths && this.cacheArcLengths.length === e + 1 && !this.needsUpdate)
      return this.cacheArcLengths;
    this.needsUpdate = !1;
    var t = [], r, n = this.getPoint(0), i, a = 0;
    for (t.push(0), i = 1; i <= e; i++)
      r = this.getPoint(i / e), a += r.distanceTo(n), t.push(a), n = r;
    return this.cacheArcLengths = t, t;
  },
  updateArcLengths: function() {
    this.needsUpdate = !0, this.getLengths();
  },
  // Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant
  getUtoTmapping: function(e, t) {
    var r = this.getLengths(), n = 0, i = r.length, a;
    t ? a = t : a = e * r[i - 1];
    for (var s = 0, o = i - 1, u; s <= o; )
      if (n = Math.floor(s + (o - s) / 2), u = r[n] - a, u < 0)
        s = n + 1;
      else if (u > 0)
        o = n - 1;
      else {
        o = n;
        break;
      }
    if (n = o, r[n] === a)
      return n / (i - 1);
    var l = r[n], c = r[n + 1], f = c - l, h = (a - l) / f, d = (n + h) / (i - 1);
    return d;
  },
  // Returns a unit vector tangent at t
  // In case any sub curve does not implement its tangent derivation,
  // 2 points a small delta apart will be used to find its gradient
  // which seems to give a reasonable approximation
  getTangent: function(e) {
    var t = 1e-4, r = e - t, n = e + t;
    r < 0 && (r = 0), n > 1 && (n = 1);
    var i = this.getPoint(r), a = this.getPoint(n), s = a.clone().sub(i);
    return s.normalize();
  },
  getTangentAt: function(e) {
    var t = this.getUtoTmapping(e);
    return this.getTangent(t);
  },
  computeFrenetFrames: function(e, t) {
    var r = new re(), n = [], i = [], a = [], s = new re(), o = new Nt(), u, l, c;
    for (u = 0; u <= e; u++)
      l = u / e, n[u] = this.getTangentAt(l), n[u].normalize();
    i[0] = new re(), a[0] = new re();
    var f = Number.MAX_VALUE, h = Math.abs(n[0].x), d = Math.abs(n[0].y), g = Math.abs(n[0].z);
    for (h <= f && (f = h, r.set(1, 0, 0)), d <= f && (f = d, r.set(0, 1, 0)), g <= f && r.set(0, 0, 1), s.crossVectors(n[0], r).normalize(), i[0].crossVectors(n[0], s), a[0].crossVectors(n[0], i[0]), u = 1; u <= e; u++)
      i[u] = i[u - 1].clone(), a[u] = a[u - 1].clone(), s.crossVectors(n[u - 1], n[u]), s.length() > Number.EPSILON && (s.normalize(), c = Math.acos(It.clamp(n[u - 1].dot(n[u]), -1, 1)), i[u].applyMatrix4(o.makeRotationAxis(s, c))), a[u].crossVectors(n[u], i[u]);
    if (t === !0)
      for (c = Math.acos(It.clamp(i[0].dot(i[e]), -1, 1)), c /= e, n[0].dot(s.crossVectors(i[0], i[e])) > 0 && (c = -c), u = 1; u <= e; u++)
        i[u].applyMatrix4(o.makeRotationAxis(n[u], c * u)), a[u].crossVectors(n[u], i[u]);
    return {
      tangents: n,
      normals: i,
      binormals: a
    };
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.arcLengthDivisions = e.arcLengthDivisions, this;
  },
  toJSON: function() {
    var e = {
      metadata: {
        version: 4.5,
        type: "Curve",
        generator: "Curve.toJSON"
      }
    };
    return e.arcLengthDivisions = this.arcLengthDivisions, e.type = this.type, e;
  },
  fromJSON: function(e) {
    return this.arcLengthDivisions = e.arcLengthDivisions, this;
  }
});
function Yn(e, t, r, n, i, a, s, o) {
  ft.call(this), this.type = "EllipseCurve", this.aX = e || 0, this.aY = t || 0, this.xRadius = r || 1, this.yRadius = n || 1, this.aStartAngle = i || 0, this.aEndAngle = a || 2 * Math.PI, this.aClockwise = s || !1, this.aRotation = o || 0;
}
Yn.prototype = Object.create(ft.prototype);
Yn.prototype.constructor = Yn;
Yn.prototype.isEllipseCurve = !0;
Yn.prototype.getPoint = function(e, t) {
  for (var r = t || new _e(), n = Math.PI * 2, i = this.aEndAngle - this.aStartAngle, a = Math.abs(i) < Number.EPSILON; i < 0; ) i += n;
  for (; i > n; ) i -= n;
  i < Number.EPSILON && (a ? i = 0 : i = n), this.aClockwise === !0 && !a && (i === n ? i = -n : i = i - n);
  var s = this.aStartAngle + e * i, o = this.aX + this.xRadius * Math.cos(s), u = this.aY + this.yRadius * Math.sin(s);
  if (this.aRotation !== 0) {
    var l = Math.cos(this.aRotation), c = Math.sin(this.aRotation), f = o - this.aX, h = u - this.aY;
    o = f * l - h * c + this.aX, u = f * c + h * l + this.aY;
  }
  return r.set(o, u);
};
Yn.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.aX = e.aX, this.aY = e.aY, this.xRadius = e.xRadius, this.yRadius = e.yRadius, this.aStartAngle = e.aStartAngle, this.aEndAngle = e.aEndAngle, this.aClockwise = e.aClockwise, this.aRotation = e.aRotation, this;
};
Yn.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.aX = this.aX, e.aY = this.aY, e.xRadius = this.xRadius, e.yRadius = this.yRadius, e.aStartAngle = this.aStartAngle, e.aEndAngle = this.aEndAngle, e.aClockwise = this.aClockwise, e.aRotation = this.aRotation, e;
};
Yn.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.aX = e.aX, this.aY = e.aY, this.xRadius = e.xRadius, this.yRadius = e.yRadius, this.aStartAngle = e.aStartAngle, this.aEndAngle = e.aEndAngle, this.aClockwise = e.aClockwise, this.aRotation = e.aRotation, this;
};
function il(e, t, r, n, i, a) {
  Yn.call(this, e, t, r, r, n, i, a), this.type = "ArcCurve";
}
il.prototype = Object.create(Yn.prototype);
il.prototype.constructor = il;
il.prototype.isArcCurve = !0;
function g0() {
  var e = 0, t = 0, r = 0, n = 0;
  function i(a, s, o, u) {
    e = a, t = o, r = -3 * a + 3 * s - 2 * o - u, n = 2 * a - 2 * s + o + u;
  }
  return {
    initCatmullRom: function(a, s, o, u, l) {
      i(s, o, l * (o - a), l * (u - s));
    },
    initNonuniformCatmullRom: function(a, s, o, u, l, c, f) {
      var h = (s - a) / l - (o - a) / (l + c) + (o - s) / c, d = (o - s) / c - (u - s) / (c + f) + (u - o) / f;
      h *= c, d *= c, i(s, o, h, d);
    },
    calc: function(a) {
      var s = a * a, o = s * a;
      return e + t * a + r * s + n * o;
    }
  };
}
var oc = new re(), cd = new g0(), fd = new g0(), hd = new g0();
function Fn(e, t, r, n) {
  ft.call(this), this.type = "CatmullRomCurve3", this.points = e || [], this.closed = t || !1, this.curveType = r || "centripetal", this.tension = n || 0.5;
}
Fn.prototype = Object.create(ft.prototype);
Fn.prototype.constructor = Fn;
Fn.prototype.isCatmullRomCurve3 = !0;
Fn.prototype.getPoint = function(e, t) {
  var r = t || new re(), n = this.points, i = n.length, a = (i - (this.closed ? 0 : 1)) * e, s = Math.floor(a), o = a - s;
  this.closed ? s += s > 0 ? 0 : (Math.floor(Math.abs(s) / i) + 1) * i : o === 0 && s === i - 1 && (s = i - 2, o = 1);
  var u, l, c, f;
  if (this.closed || s > 0 ? u = n[(s - 1) % i] : (oc.subVectors(n[0], n[1]).add(n[0]), u = oc), l = n[s % i], c = n[(s + 1) % i], this.closed || s + 2 < i ? f = n[(s + 2) % i] : (oc.subVectors(n[i - 1], n[i - 2]).add(n[i - 1]), f = oc), this.curveType === "centripetal" || this.curveType === "chordal") {
    var h = this.curveType === "chordal" ? 0.5 : 0.25, d = Math.pow(u.distanceToSquared(l), h), g = Math.pow(l.distanceToSquared(c), h), v = Math.pow(c.distanceToSquared(f), h);
    g < 1e-4 && (g = 1), d < 1e-4 && (d = g), v < 1e-4 && (v = g), cd.initNonuniformCatmullRom(u.x, l.x, c.x, f.x, d, g, v), fd.initNonuniformCatmullRom(u.y, l.y, c.y, f.y, d, g, v), hd.initNonuniformCatmullRom(u.z, l.z, c.z, f.z, d, g, v);
  } else this.curveType === "catmullrom" && (cd.initCatmullRom(u.x, l.x, c.x, f.x, this.tension), fd.initCatmullRom(u.y, l.y, c.y, f.y, this.tension), hd.initCatmullRom(u.z, l.z, c.z, f.z, this.tension));
  return r.set(
    cd.calc(o),
    fd.calc(o),
    hd.calc(o)
  ), r;
};
Fn.prototype.copy = function(e) {
  ft.prototype.copy.call(this, e), this.points = [];
  for (var t = 0, r = e.points.length; t < r; t++) {
    var n = e.points[t];
    this.points.push(n.clone());
  }
  return this.closed = e.closed, this.curveType = e.curveType, this.tension = e.tension, this;
};
Fn.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  e.points = [];
  for (var t = 0, r = this.points.length; t < r; t++) {
    var n = this.points[t];
    e.points.push(n.toArray());
  }
  return e.closed = this.closed, e.curveType = this.curveType, e.tension = this.tension, e;
};
Fn.prototype.fromJSON = function(e) {
  ft.prototype.fromJSON.call(this, e), this.points = [];
  for (var t = 0, r = e.points.length; t < r; t++) {
    var n = e.points[t];
    this.points.push(new re().fromArray(n));
  }
  return this.closed = e.closed, this.curveType = e.curveType, this.tension = e.tension, this;
};
function ry(e, t, r, n, i) {
  var a = (n - t) * 0.5, s = (i - r) * 0.5, o = e * e, u = e * o;
  return (2 * r - 2 * n + a + s) * u + (-3 * r + 3 * n - 2 * a - s) * o + a * e + r;
}
function dk(e, t) {
  var r = 1 - e;
  return r * r * t;
}
function pk(e, t) {
  return 2 * (1 - e) * e * t;
}
function vk(e, t) {
  return e * e * t;
}
function Eu(e, t, r, n) {
  return dk(e, t) + pk(e, r) + vk(e, n);
}
function mk(e, t) {
  var r = 1 - e;
  return r * r * r * t;
}
function gk(e, t) {
  var r = 1 - e;
  return 3 * r * r * e * t;
}
function yk(e, t) {
  return 3 * (1 - e) * e * e * t;
}
function bk(e, t) {
  return e * e * e * t;
}
function Au(e, t, r, n, i) {
  return mk(e, t) + gk(e, r) + yk(e, n) + bk(e, i);
}
function Bi(e, t, r, n) {
  ft.call(this), this.type = "CubicBezierCurve", this.v0 = e || new _e(), this.v1 = t || new _e(), this.v2 = r || new _e(), this.v3 = n || new _e();
}
Bi.prototype = Object.create(ft.prototype);
Bi.prototype.constructor = Bi;
Bi.prototype.isCubicBezierCurve = !0;
Bi.prototype.getPoint = function(e, t) {
  var r = t || new _e(), n = this.v0, i = this.v1, a = this.v2, s = this.v3;
  return r.set(
    Au(e, n.x, i.x, a.x, s.x),
    Au(e, n.y, i.y, a.y, s.y)
  ), r;
};
Bi.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.v0.copy(e.v0), this.v1.copy(e.v1), this.v2.copy(e.v2), this.v3.copy(e.v3), this;
};
Bi.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.v0 = this.v0.toArray(), e.v1 = this.v1.toArray(), e.v2 = this.v2.toArray(), e.v3 = this.v3.toArray(), e;
};
Bi.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.v0.fromArray(e.v0), this.v1.fromArray(e.v1), this.v2.fromArray(e.v2), this.v3.fromArray(e.v3), this;
};
function sa(e, t, r, n) {
  ft.call(this), this.type = "CubicBezierCurve3", this.v0 = e || new re(), this.v1 = t || new re(), this.v2 = r || new re(), this.v3 = n || new re();
}
sa.prototype = Object.create(ft.prototype);
sa.prototype.constructor = sa;
sa.prototype.isCubicBezierCurve3 = !0;
sa.prototype.getPoint = function(e, t) {
  var r = t || new re(), n = this.v0, i = this.v1, a = this.v2, s = this.v3;
  return r.set(
    Au(e, n.x, i.x, a.x, s.x),
    Au(e, n.y, i.y, a.y, s.y),
    Au(e, n.z, i.z, a.z, s.z)
  ), r;
};
sa.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.v0.copy(e.v0), this.v1.copy(e.v1), this.v2.copy(e.v2), this.v3.copy(e.v3), this;
};
sa.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.v0 = this.v0.toArray(), e.v1 = this.v1.toArray(), e.v2 = this.v2.toArray(), e.v3 = this.v3.toArray(), e;
};
sa.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.v0.fromArray(e.v0), this.v1.fromArray(e.v1), this.v2.fromArray(e.v2), this.v3.fromArray(e.v3), this;
};
function In(e, t) {
  ft.call(this), this.type = "LineCurve", this.v1 = e || new _e(), this.v2 = t || new _e();
}
In.prototype = Object.create(ft.prototype);
In.prototype.constructor = In;
In.prototype.isLineCurve = !0;
In.prototype.getPoint = function(e, t) {
  var r = t || new _e();
  return e === 1 ? r.copy(this.v2) : (r.copy(this.v2).sub(this.v1), r.multiplyScalar(e).add(this.v1)), r;
};
In.prototype.getPointAt = function(e, t) {
  return this.getPoint(e, t);
};
In.prototype.getTangent = function() {
  var e = this.v2.clone().sub(this.v1);
  return e.normalize();
};
In.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.v1.copy(e.v1), this.v2.copy(e.v2), this;
};
In.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.v1 = this.v1.toArray(), e.v2 = this.v2.toArray(), e;
};
In.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.v1.fromArray(e.v1), this.v2.fromArray(e.v2), this;
};
function Li(e, t) {
  ft.call(this), this.type = "LineCurve3", this.v1 = e || new re(), this.v2 = t || new re();
}
Li.prototype = Object.create(ft.prototype);
Li.prototype.constructor = Li;
Li.prototype.isLineCurve3 = !0;
Li.prototype.getPoint = function(e, t) {
  var r = t || new re();
  return e === 1 ? r.copy(this.v2) : (r.copy(this.v2).sub(this.v1), r.multiplyScalar(e).add(this.v1)), r;
};
Li.prototype.getPointAt = function(e, t) {
  return this.getPoint(e, t);
};
Li.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.v1.copy(e.v1), this.v2.copy(e.v2), this;
};
Li.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.v1 = this.v1.toArray(), e.v2 = this.v2.toArray(), e;
};
Li.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.v1.fromArray(e.v1), this.v2.fromArray(e.v2), this;
};
function Fi(e, t, r) {
  ft.call(this), this.type = "QuadraticBezierCurve", this.v0 = e || new _e(), this.v1 = t || new _e(), this.v2 = r || new _e();
}
Fi.prototype = Object.create(ft.prototype);
Fi.prototype.constructor = Fi;
Fi.prototype.isQuadraticBezierCurve = !0;
Fi.prototype.getPoint = function(e, t) {
  var r = t || new _e(), n = this.v0, i = this.v1, a = this.v2;
  return r.set(
    Eu(e, n.x, i.x, a.x),
    Eu(e, n.y, i.y, a.y)
  ), r;
};
Fi.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.v0.copy(e.v0), this.v1.copy(e.v1), this.v2.copy(e.v2), this;
};
Fi.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.v0 = this.v0.toArray(), e.v1 = this.v1.toArray(), e.v2 = this.v2.toArray(), e;
};
Fi.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.v0.fromArray(e.v0), this.v1.fromArray(e.v1), this.v2.fromArray(e.v2), this;
};
function oa(e, t, r) {
  ft.call(this), this.type = "QuadraticBezierCurve3", this.v0 = e || new re(), this.v1 = t || new re(), this.v2 = r || new re();
}
oa.prototype = Object.create(ft.prototype);
oa.prototype.constructor = oa;
oa.prototype.isQuadraticBezierCurve3 = !0;
oa.prototype.getPoint = function(e, t) {
  var r = t || new re(), n = this.v0, i = this.v1, a = this.v2;
  return r.set(
    Eu(e, n.x, i.x, a.x),
    Eu(e, n.y, i.y, a.y),
    Eu(e, n.z, i.z, a.z)
  ), r;
};
oa.prototype.copy = function(e) {
  return ft.prototype.copy.call(this, e), this.v0.copy(e.v0), this.v1.copy(e.v1), this.v2.copy(e.v2), this;
};
oa.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  return e.v0 = this.v0.toArray(), e.v1 = this.v1.toArray(), e.v2 = this.v2.toArray(), e;
};
oa.prototype.fromJSON = function(e) {
  return ft.prototype.fromJSON.call(this, e), this.v0.fromArray(e.v0), this.v1.fromArray(e.v1), this.v2.fromArray(e.v2), this;
};
function Ii(e) {
  ft.call(this), this.type = "SplineCurve", this.points = e || [];
}
Ii.prototype = Object.create(ft.prototype);
Ii.prototype.constructor = Ii;
Ii.prototype.isSplineCurve = !0;
Ii.prototype.getPoint = function(e, t) {
  var r = t || new _e(), n = this.points, i = (n.length - 1) * e, a = Math.floor(i), s = i - a, o = n[a === 0 ? a : a - 1], u = n[a], l = n[a > n.length - 2 ? n.length - 1 : a + 1], c = n[a > n.length - 3 ? n.length - 1 : a + 2];
  return r.set(
    ry(s, o.x, u.x, l.x, c.x),
    ry(s, o.y, u.y, l.y, c.y)
  ), r;
};
Ii.prototype.copy = function(e) {
  ft.prototype.copy.call(this, e), this.points = [];
  for (var t = 0, r = e.points.length; t < r; t++) {
    var n = e.points[t];
    this.points.push(n.clone());
  }
  return this;
};
Ii.prototype.toJSON = function() {
  var e = ft.prototype.toJSON.call(this);
  e.points = [];
  for (var t = 0, r = this.points.length; t < r; t++) {
    var n = this.points[t];
    e.points.push(n.toArray());
  }
  return e;
};
Ii.prototype.fromJSON = function(e) {
  ft.prototype.fromJSON.call(this, e), this.points = [];
  for (var t = 0, r = e.points.length; t < r; t++) {
    var n = e.points[t];
    this.points.push(new _e().fromArray(n));
  }
  return this;
};
var $p = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  ArcCurve: il,
  CatmullRomCurve3: Fn,
  CubicBezierCurve: Bi,
  CubicBezierCurve3: sa,
  EllipseCurve: Yn,
  LineCurve: In,
  LineCurve3: Li,
  QuadraticBezierCurve: Fi,
  QuadraticBezierCurve3: oa,
  SplineCurve: Ii
});
function ka() {
  ft.call(this), this.type = "CurvePath", this.curves = [], this.autoClose = !1;
}
ka.prototype = Object.assign(Object.create(ft.prototype), {
  constructor: ka,
  add: function(e) {
    this.curves.push(e);
  },
  closePath: function() {
    var e = this.curves[0].getPoint(0), t = this.curves[this.curves.length - 1].getPoint(1);
    e.equals(t) || this.curves.push(new In(t, e));
  },
  // To get accurate point with reference to
  // entire path distance at time t,
  // following has to be done:
  // 1. Length of each sub path have to be known
  // 2. Locate and identify type of curve
  // 3. Get t for the curve
  // 4. Return curve.getPointAt(t')
  getPoint: function(e) {
    for (var t = e * this.getLength(), r = this.getCurveLengths(), n = 0; n < r.length; ) {
      if (r[n] >= t) {
        var i = r[n] - t, a = this.curves[n], s = a.getLength(), o = s === 0 ? 0 : 1 - i / s;
        return a.getPointAt(o);
      }
      n++;
    }
    return null;
  },
  // We cannot use the default THREE.Curve getPoint() with getLength() because in
  // THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath
  // getPoint() depends on getLength
  getLength: function() {
    var e = this.getCurveLengths();
    return e[e.length - 1];
  },
  // cacheLengths must be recalculated.
  updateArcLengths: function() {
    this.needsUpdate = !0, this.cacheLengths = null, this.getCurveLengths();
  },
  // Compute lengths and cache them
  // We cannot overwrite getLengths() because UtoT mapping uses it.
  getCurveLengths: function() {
    if (this.cacheLengths && this.cacheLengths.length === this.curves.length)
      return this.cacheLengths;
    for (var e = [], t = 0, r = 0, n = this.curves.length; r < n; r++)
      t += this.curves[r].getLength(), e.push(t);
    return this.cacheLengths = e, e;
  },
  getSpacedPoints: function(e) {
    e === void 0 && (e = 40);
    for (var t = [], r = 0; r <= e; r++)
      t.push(this.getPoint(r / e));
    return this.autoClose && t.push(t[0]), t;
  },
  getPoints: function(e) {
    e = e || 12;
    for (var t = [], r, n = 0, i = this.curves; n < i.length; n++)
      for (var a = i[n], s = a && a.isEllipseCurve ? e * 2 : a && (a.isLineCurve || a.isLineCurve3) ? 1 : a && a.isSplineCurve ? e * a.points.length : e, o = a.getPoints(s), u = 0; u < o.length; u++) {
        var l = o[u];
        r && r.equals(l) || (t.push(l), r = l);
      }
    return this.autoClose && t.length > 1 && !t[t.length - 1].equals(t[0]) && t.push(t[0]), t;
  },
  copy: function(e) {
    ft.prototype.copy.call(this, e), this.curves = [];
    for (var t = 0, r = e.curves.length; t < r; t++) {
      var n = e.curves[t];
      this.curves.push(n.clone());
    }
    return this.autoClose = e.autoClose, this;
  },
  toJSON: function() {
    var e = ft.prototype.toJSON.call(this);
    e.autoClose = this.autoClose, e.curves = [];
    for (var t = 0, r = this.curves.length; t < r; t++) {
      var n = this.curves[t];
      e.curves.push(n.toJSON());
    }
    return e;
  },
  fromJSON: function(e) {
    ft.prototype.fromJSON.call(this, e), this.autoClose = e.autoClose, this.curves = [];
    for (var t = 0, r = e.curves.length; t < r; t++) {
      var n = e.curves[t];
      this.curves.push(new $p[n.type]().fromJSON(n));
    }
    return this;
  }
});
function Ai(e) {
  ka.call(this), this.type = "Path", this.currentPoint = new _e(), e && this.setFromPoints(e);
}
Ai.prototype = Object.assign(Object.create(ka.prototype), {
  constructor: Ai,
  setFromPoints: function(e) {
    this.moveTo(e[0].x, e[0].y);
    for (var t = 1, r = e.length; t < r; t++)
      this.lineTo(e[t].x, e[t].y);
    return this;
  },
  moveTo: function(e, t) {
    return this.currentPoint.set(e, t), this;
  },
  lineTo: function(e, t) {
    var r = new In(this.currentPoint.clone(), new _e(e, t));
    return this.curves.push(r), this.currentPoint.set(e, t), this;
  },
  quadraticCurveTo: function(e, t, r, n) {
    var i = new Fi(
      this.currentPoint.clone(),
      new _e(e, t),
      new _e(r, n)
    );
    return this.curves.push(i), this.currentPoint.set(r, n), this;
  },
  bezierCurveTo: function(e, t, r, n, i, a) {
    var s = new Bi(
      this.currentPoint.clone(),
      new _e(e, t),
      new _e(r, n),
      new _e(i, a)
    );
    return this.curves.push(s), this.currentPoint.set(i, a), this;
  },
  splineThru: function(e) {
    var t = [this.currentPoint.clone()].concat(e), r = new Ii(t);
    return this.curves.push(r), this.currentPoint.copy(e[e.length - 1]), this;
  },
  arc: function(e, t, r, n, i, a) {
    var s = this.currentPoint.x, o = this.currentPoint.y;
    return this.absarc(
      e + s,
      t + o,
      r,
      n,
      i,
      a
    ), this;
  },
  absarc: function(e, t, r, n, i, a) {
    return this.absellipse(e, t, r, r, n, i, a), this;
  },
  ellipse: function(e, t, r, n, i, a, s, o) {
    var u = this.currentPoint.x, l = this.currentPoint.y;
    return this.absellipse(e + u, t + l, r, n, i, a, s, o), this;
  },
  absellipse: function(e, t, r, n, i, a, s, o) {
    var u = new Yn(e, t, r, n, i, a, s, o);
    if (this.curves.length > 0) {
      var l = u.getPoint(0);
      l.equals(this.currentPoint) || this.lineTo(l.x, l.y);
    }
    this.curves.push(u);
    var c = u.getPoint(1);
    return this.currentPoint.copy(c), this;
  },
  copy: function(e) {
    return ka.prototype.copy.call(this, e), this.currentPoint.copy(e.currentPoint), this;
  },
  toJSON: function() {
    var e = ka.prototype.toJSON.call(this);
    return e.currentPoint = this.currentPoint.toArray(), e;
  },
  fromJSON: function(e) {
    return ka.prototype.fromJSON.call(this, e), this.currentPoint.fromArray(e.currentPoint), this;
  }
});
function ds(e) {
  Ai.call(this, e), this.uuid = It.generateUUID(), this.type = "Shape", this.holes = [];
}
ds.prototype = Object.assign(Object.create(Ai.prototype), {
  constructor: ds,
  getPointsHoles: function(e) {
    for (var t = [], r = 0, n = this.holes.length; r < n; r++)
      t[r] = this.holes[r].getPoints(e);
    return t;
  },
  // get points of shape and holes (keypoints based on segments parameter)
  extractPoints: function(e) {
    return {
      shape: this.getPoints(e),
      holes: this.getPointsHoles(e)
    };
  },
  copy: function(e) {
    Ai.prototype.copy.call(this, e), this.holes = [];
    for (var t = 0, r = e.holes.length; t < r; t++) {
      var n = e.holes[t];
      this.holes.push(n.clone());
    }
    return this;
  },
  toJSON: function() {
    var e = Ai.prototype.toJSON.call(this);
    e.uuid = this.uuid, e.holes = [];
    for (var t = 0, r = this.holes.length; t < r; t++) {
      var n = this.holes[t];
      e.holes.push(n.toJSON());
    }
    return e;
  },
  fromJSON: function(e) {
    Ai.prototype.fromJSON.call(this, e), this.uuid = e.uuid, this.holes = [];
    for (var t = 0, r = e.holes.length; t < r; t++) {
      var n = e.holes[t];
      this.holes.push(new Ai().fromJSON(n));
    }
    return this;
  }
});
function mr(e, t) {
  et.call(this), this.type = "Light", this.color = new nt(e), this.intensity = t !== void 0 ? t : 1, this.receiveShadow = void 0;
}
mr.prototype = Object.assign(Object.create(et.prototype), {
  constructor: mr,
  isLight: !0,
  copy: function(e) {
    return et.prototype.copy.call(this, e), this.color.copy(e.color), this.intensity = e.intensity, this;
  },
  toJSON: function(e) {
    var t = et.prototype.toJSON.call(this, e);
    return t.object.color = this.color.getHex(), t.object.intensity = this.intensity, this.groundColor !== void 0 && (t.object.groundColor = this.groundColor.getHex()), this.distance !== void 0 && (t.object.distance = this.distance), this.angle !== void 0 && (t.object.angle = this.angle), this.decay !== void 0 && (t.object.decay = this.decay), this.penumbra !== void 0 && (t.object.penumbra = this.penumbra), this.shadow !== void 0 && (t.object.shadow = this.shadow.toJSON()), t;
  }
});
function Yp(e, t, r) {
  mr.call(this, e, r), this.type = "HemisphereLight", this.castShadow = void 0, this.position.copy(et.DefaultUp), this.updateMatrix(), this.groundColor = new nt(t);
}
Yp.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: Yp,
  isHemisphereLight: !0,
  copy: function(e) {
    return mr.prototype.copy.call(this, e), this.groundColor.copy(e.groundColor), this;
  }
});
function ua(e) {
  this.camera = e, this.bias = 0, this.radius = 1, this.mapSize = new _e(512, 512), this.map = null, this.mapPass = null, this.matrix = new Nt(), this._frustum = new Ml(), this._frameExtents = new _e(1, 1), this._viewportCount = 1, this._viewports = [
    new or(0, 0, 1, 1)
  ];
}
Object.assign(ua.prototype, {
  _projScreenMatrix: new Nt(),
  _lightPositionWorld: new re(),
  _lookTarget: new re(),
  getViewportCount: function() {
    return this._viewportCount;
  },
  getFrustum: function() {
    return this._frustum;
  },
  updateMatrices: function(e) {
    var t = this.camera, r = this.matrix, n = this._projScreenMatrix, i = this._lookTarget, a = this._lightPositionWorld;
    a.setFromMatrixPosition(e.matrixWorld), t.position.copy(a), i.setFromMatrixPosition(e.target.matrixWorld), t.lookAt(i), t.updateMatrixWorld(), n.multiplyMatrices(t.projectionMatrix, t.matrixWorldInverse), this._frustum.setFromProjectionMatrix(n), r.set(
      0.5,
      0,
      0,
      0.5,
      0,
      0.5,
      0,
      0.5,
      0,
      0,
      0.5,
      0.5,
      0,
      0,
      0,
      1
    ), r.multiply(t.projectionMatrix), r.multiply(t.matrixWorldInverse);
  },
  getViewport: function(e) {
    return this._viewports[e];
  },
  getFrameExtents: function() {
    return this._frameExtents;
  },
  copy: function(e) {
    return this.camera = e.camera.clone(), this.bias = e.bias, this.radius = e.radius, this.mapSize.copy(e.mapSize), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  toJSON: function() {
    var e = {};
    return this.bias !== 0 && (e.bias = this.bias), this.radius !== 1 && (e.radius = this.radius), (this.mapSize.x !== 512 || this.mapSize.y !== 512) && (e.mapSize = this.mapSize.toArray()), e.camera = this.camera.toJSON(!1).object, delete e.camera.matrix, e;
  }
});
function Kp() {
  ua.call(this, new Wr(50, 1, 0.5, 500));
}
Kp.prototype = Object.assign(Object.create(ua.prototype), {
  constructor: Kp,
  isSpotLightShadow: !0,
  updateMatrices: function(e) {
    var t = this.camera, r = It.RAD2DEG * 2 * e.angle, n = this.mapSize.width / this.mapSize.height, i = e.distance || t.far;
    (r !== t.fov || n !== t.aspect || i !== t.far) && (t.fov = r, t.aspect = n, t.far = i, t.updateProjectionMatrix()), ua.prototype.updateMatrices.call(this, e);
  }
});
function Zp(e, t, r, n, i, a) {
  mr.call(this, e, t), this.type = "SpotLight", this.position.copy(et.DefaultUp), this.updateMatrix(), this.target = new et(), Object.defineProperty(this, "power", {
    get: function() {
      return this.intensity * Math.PI;
    },
    set: function(s) {
      this.intensity = s / Math.PI;
    }
  }), this.distance = r !== void 0 ? r : 0, this.angle = n !== void 0 ? n : Math.PI / 3, this.penumbra = i !== void 0 ? i : 0, this.decay = a !== void 0 ? a : 1, this.shadow = new Kp();
}
Zp.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: Zp,
  isSpotLight: !0,
  copy: function(e) {
    return mr.prototype.copy.call(this, e), this.distance = e.distance, this.angle = e.angle, this.penumbra = e.penumbra, this.decay = e.decay, this.target = e.target.clone(), this.shadow = e.shadow.clone(), this;
  }
});
function Jp() {
  ua.call(this, new Wr(90, 1, 0.5, 500)), this._frameExtents = new _e(4, 2), this._viewportCount = 6, this._viewports = [
    // These viewports map a cube-map onto a 2D texture with the
    // following orientation:
    //
    //  xzXZ
    //   y Y
    //
    // X - Positive x direction
    // x - Negative x direction
    // Y - Positive y direction
    // y - Negative y direction
    // Z - Positive z direction
    // z - Negative z direction
    // positive X
    new or(2, 1, 1, 1),
    // negative X
    new or(0, 1, 1, 1),
    // positive Z
    new or(3, 1, 1, 1),
    // negative Z
    new or(1, 1, 1, 1),
    // positive Y
    new or(3, 0, 1, 1),
    // negative Y
    new or(1, 0, 1, 1)
  ], this._cubeDirections = [
    new re(1, 0, 0),
    new re(-1, 0, 0),
    new re(0, 0, 1),
    new re(0, 0, -1),
    new re(0, 1, 0),
    new re(0, -1, 0)
  ], this._cubeUps = [
    new re(0, 1, 0),
    new re(0, 1, 0),
    new re(0, 1, 0),
    new re(0, 1, 0),
    new re(0, 0, 1),
    new re(0, 0, -1)
  ];
}
Jp.prototype = Object.assign(Object.create(ua.prototype), {
  constructor: Jp,
  isPointLightShadow: !0,
  updateMatrices: function(e, t) {
    t === void 0 && (t = 0);
    var r = this.camera, n = this.matrix, i = this._lightPositionWorld, a = this._lookTarget, s = this._projScreenMatrix;
    i.setFromMatrixPosition(e.matrixWorld), r.position.copy(i), a.copy(r.position), a.add(this._cubeDirections[t]), r.up.copy(this._cubeUps[t]), r.lookAt(a), r.updateMatrixWorld(), n.makeTranslation(-i.x, -i.y, -i.z), s.multiplyMatrices(r.projectionMatrix, r.matrixWorldInverse), this._frustum.setFromProjectionMatrix(s);
  }
});
function Qp(e, t, r, n) {
  mr.call(this, e, t), this.type = "PointLight", Object.defineProperty(this, "power", {
    get: function() {
      return this.intensity * 4 * Math.PI;
    },
    set: function(i) {
      this.intensity = i / (4 * Math.PI);
    }
  }), this.distance = r !== void 0 ? r : 0, this.decay = n !== void 0 ? n : 1, this.shadow = new Jp();
}
Qp.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: Qp,
  isPointLight: !0,
  copy: function(e) {
    return mr.prototype.copy.call(this, e), this.distance = e.distance, this.decay = e.decay, this.shadow = e.shadow.clone(), this;
  }
});
function al(e, t, r, n, i, a) {
  ra.call(this), this.type = "OrthographicCamera", this.zoom = 1, this.view = null, this.left = e !== void 0 ? e : -1, this.right = t !== void 0 ? t : 1, this.top = r !== void 0 ? r : 1, this.bottom = n !== void 0 ? n : -1, this.near = i !== void 0 ? i : 0.1, this.far = a !== void 0 ? a : 2e3, this.updateProjectionMatrix();
}
al.prototype = Object.assign(Object.create(ra.prototype), {
  constructor: al,
  isOrthographicCamera: !0,
  copy: function(e, t) {
    return ra.prototype.copy.call(this, e, t), this.left = e.left, this.right = e.right, this.top = e.top, this.bottom = e.bottom, this.near = e.near, this.far = e.far, this.zoom = e.zoom, this.view = e.view === null ? null : Object.assign({}, e.view), this;
  },
  setViewOffset: function(e, t, r, n, i, a) {
    this.view === null && (this.view = {
      enabled: !0,
      fullWidth: 1,
      fullHeight: 1,
      offsetX: 0,
      offsetY: 0,
      width: 1,
      height: 1
    }), this.view.enabled = !0, this.view.fullWidth = e, this.view.fullHeight = t, this.view.offsetX = r, this.view.offsetY = n, this.view.width = i, this.view.height = a, this.updateProjectionMatrix();
  },
  clearViewOffset: function() {
    this.view !== null && (this.view.enabled = !1), this.updateProjectionMatrix();
  },
  updateProjectionMatrix: function() {
    var e = (this.right - this.left) / (2 * this.zoom), t = (this.top - this.bottom) / (2 * this.zoom), r = (this.right + this.left) / 2, n = (this.top + this.bottom) / 2, i = r - e, a = r + e, s = n + t, o = n - t;
    if (this.view !== null && this.view.enabled) {
      var u = (this.right - this.left) / this.view.fullWidth / this.zoom, l = (this.top - this.bottom) / this.view.fullHeight / this.zoom;
      i += u * this.view.offsetX, a = i + u * this.view.width, s -= l * this.view.offsetY, o = s - l * this.view.height;
    }
    this.projectionMatrix.makeOrthographic(i, a, s, o, this.near, this.far), this.projectionMatrixInverse.getInverse(this.projectionMatrix);
  },
  toJSON: function(e) {
    var t = et.prototype.toJSON.call(this, e);
    return t.object.zoom = this.zoom, t.object.left = this.left, t.object.right = this.right, t.object.top = this.top, t.object.bottom = this.bottom, t.object.near = this.near, t.object.far = this.far, this.view !== null && (t.object.view = Object.assign({}, this.view)), t;
  }
});
function ev() {
  ua.call(this, new al(-5, 5, 5, -5, 0.5, 500));
}
ev.prototype = Object.assign(Object.create(ua.prototype), {
  constructor: ev,
  isDirectionalLightShadow: !0,
  updateMatrices: function(e) {
    ua.prototype.updateMatrices.call(this, e);
  }
});
function tv(e, t) {
  mr.call(this, e, t), this.type = "DirectionalLight", this.position.copy(et.DefaultUp), this.updateMatrix(), this.target = new et(), this.shadow = new ev();
}
tv.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: tv,
  isDirectionalLight: !0,
  copy: function(e) {
    return mr.prototype.copy.call(this, e), this.target = e.target.clone(), this.shadow = e.shadow.clone(), this;
  }
});
function rv(e, t) {
  mr.call(this, e, t), this.type = "AmbientLight", this.castShadow = void 0;
}
rv.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: rv,
  isAmbientLight: !0
});
function nv(e, t, r, n) {
  mr.call(this, e, t), this.type = "RectAreaLight", this.width = r !== void 0 ? r : 10, this.height = n !== void 0 ? n : 10;
}
nv.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: nv,
  isRectAreaLight: !0,
  copy: function(e) {
    return mr.prototype.copy.call(this, e), this.width = e.width, this.height = e.height, this;
  },
  toJSON: function(e) {
    var t = mr.prototype.toJSON.call(this, e);
    return t.object.width = this.width, t.object.height = this.height, t;
  }
});
function iv(e) {
  er.call(this, e), this.textures = {};
}
iv.prototype = Object.assign(Object.create(er.prototype), {
  constructor: iv,
  load: function(e, t, r, n) {
    var i = this, a = new Pi(i.manager);
    a.setPath(i.path), a.load(e, function(s) {
      t(i.parse(JSON.parse(s)));
    }, r, n);
  },
  parse: function(e) {
    var t = this.textures;
    function r(u) {
      return t[u] === void 0 && console.warn("THREE.MaterialLoader: Undefined texture", u), t[u];
    }
    var n = new lk[e.type]();
    if (e.uuid !== void 0 && (n.uuid = e.uuid), e.name !== void 0 && (n.name = e.name), e.color !== void 0 && n.color.setHex(e.color), e.roughness !== void 0 && (n.roughness = e.roughness), e.metalness !== void 0 && (n.metalness = e.metalness), e.sheen !== void 0 && (n.sheen = new nt().setHex(e.sheen)), e.emissive !== void 0 && n.emissive.setHex(e.emissive), e.specular !== void 0 && n.specular.setHex(e.specular), e.shininess !== void 0 && (n.shininess = e.shininess), e.clearcoat !== void 0 && (n.clearcoat = e.clearcoat), e.clearcoatRoughness !== void 0 && (n.clearcoatRoughness = e.clearcoatRoughness), e.vertexColors !== void 0 && (n.vertexColors = e.vertexColors), e.fog !== void 0 && (n.fog = e.fog), e.flatShading !== void 0 && (n.flatShading = e.flatShading), e.blending !== void 0 && (n.blending = e.blending), e.combine !== void 0 && (n.combine = e.combine), e.side !== void 0 && (n.side = e.side), e.opacity !== void 0 && (n.opacity = e.opacity), e.transparent !== void 0 && (n.transparent = e.transparent), e.alphaTest !== void 0 && (n.alphaTest = e.alphaTest), e.depthTest !== void 0 && (n.depthTest = e.depthTest), e.depthWrite !== void 0 && (n.depthWrite = e.depthWrite), e.colorWrite !== void 0 && (n.colorWrite = e.colorWrite), e.stencilWrite !== void 0 && (n.stencilWrite = e.stencilWrite), e.stencilWriteMask !== void 0 && (n.stencilWriteMask = e.stencilWriteMask), e.stencilFunc !== void 0 && (n.stencilFunc = e.stencilFunc), e.stencilRef !== void 0 && (n.stencilRef = e.stencilRef), e.stencilFuncMask !== void 0 && (n.stencilFuncMask = e.stencilFuncMask), e.stencilFail !== void 0 && (n.stencilFail = e.stencilFail), e.stencilZFail !== void 0 && (n.stencilZFail = e.stencilZFail), e.stencilZPass !== void 0 && (n.stencilZPass = e.stencilZPass), e.wireframe !== void 0 && (n.wireframe = e.wireframe), e.wireframeLinewidth !== void 0 && (n.wireframeLinewidth = e.wireframeLinewidth), e.wireframeLinecap !== void 0 && (n.wireframeLinecap = e.wireframeLinecap), e.wireframeLinejoin !== void 0 && (n.wireframeLinejoin = e.wireframeLinejoin), e.rotation !== void 0 && (n.rotation = e.rotation), e.linewidth !== 1 && (n.linewidth = e.linewidth), e.dashSize !== void 0 && (n.dashSize = e.dashSize), e.gapSize !== void 0 && (n.gapSize = e.gapSize), e.scale !== void 0 && (n.scale = e.scale), e.polygonOffset !== void 0 && (n.polygonOffset = e.polygonOffset), e.polygonOffsetFactor !== void 0 && (n.polygonOffsetFactor = e.polygonOffsetFactor), e.polygonOffsetUnits !== void 0 && (n.polygonOffsetUnits = e.polygonOffsetUnits), e.skinning !== void 0 && (n.skinning = e.skinning), e.morphTargets !== void 0 && (n.morphTargets = e.morphTargets), e.morphNormals !== void 0 && (n.morphNormals = e.morphNormals), e.dithering !== void 0 && (n.dithering = e.dithering), e.visible !== void 0 && (n.visible = e.visible), e.toneMapped !== void 0 && (n.toneMapped = e.toneMapped), e.userData !== void 0 && (n.userData = e.userData), e.uniforms !== void 0)
      for (var i in e.uniforms) {
        var a = e.uniforms[i];
        switch (n.uniforms[i] = {}, a.type) {
          case "t":
            n.uniforms[i].value = r(a.value);
            break;
          case "c":
            n.uniforms[i].value = new nt().setHex(a.value);
            break;
          case "v2":
            n.uniforms[i].value = new _e().fromArray(a.value);
            break;
          case "v3":
            n.uniforms[i].value = new re().fromArray(a.value);
            break;
          case "v4":
            n.uniforms[i].value = new or().fromArray(a.value);
            break;
          case "m3":
            n.uniforms[i].value = new an().fromArray(a.value);
          case "m4":
            n.uniforms[i].value = new Nt().fromArray(a.value);
            break;
          default:
            n.uniforms[i].value = a.value;
        }
      }
    if (e.defines !== void 0 && (n.defines = e.defines), e.vertexShader !== void 0 && (n.vertexShader = e.vertexShader), e.fragmentShader !== void 0 && (n.fragmentShader = e.fragmentShader), e.extensions !== void 0)
      for (var s in e.extensions)
        n.extensions[s] = e.extensions[s];
    if (e.shading !== void 0 && (n.flatShading = e.shading === 1), e.size !== void 0 && (n.size = e.size), e.sizeAttenuation !== void 0 && (n.sizeAttenuation = e.sizeAttenuation), e.map !== void 0 && (n.map = r(e.map)), e.matcap !== void 0 && (n.matcap = r(e.matcap)), e.alphaMap !== void 0 && (n.alphaMap = r(e.alphaMap), n.transparent = !0), e.bumpMap !== void 0 && (n.bumpMap = r(e.bumpMap)), e.bumpScale !== void 0 && (n.bumpScale = e.bumpScale), e.normalMap !== void 0 && (n.normalMap = r(e.normalMap)), e.normalMapType !== void 0 && (n.normalMapType = e.normalMapType), e.normalScale !== void 0) {
      var o = e.normalScale;
      Array.isArray(o) === !1 && (o = [o, o]), n.normalScale = new _e().fromArray(o);
    }
    return e.displacementMap !== void 0 && (n.displacementMap = r(e.displacementMap)), e.displacementScale !== void 0 && (n.displacementScale = e.displacementScale), e.displacementBias !== void 0 && (n.displacementBias = e.displacementBias), e.roughnessMap !== void 0 && (n.roughnessMap = r(e.roughnessMap)), e.metalnessMap !== void 0 && (n.metalnessMap = r(e.metalnessMap)), e.emissiveMap !== void 0 && (n.emissiveMap = r(e.emissiveMap)), e.emissiveIntensity !== void 0 && (n.emissiveIntensity = e.emissiveIntensity), e.specularMap !== void 0 && (n.specularMap = r(e.specularMap)), e.envMap !== void 0 && (n.envMap = r(e.envMap)), e.envMapIntensity !== void 0 && (n.envMapIntensity = e.envMapIntensity), e.reflectivity !== void 0 && (n.reflectivity = e.reflectivity), e.refractionRatio !== void 0 && (n.refractionRatio = e.refractionRatio), e.lightMap !== void 0 && (n.lightMap = r(e.lightMap)), e.lightMapIntensity !== void 0 && (n.lightMapIntensity = e.lightMapIntensity), e.aoMap !== void 0 && (n.aoMap = r(e.aoMap)), e.aoMapIntensity !== void 0 && (n.aoMapIntensity = e.aoMapIntensity), e.gradientMap !== void 0 && (n.gradientMap = r(e.gradientMap)), e.clearcoatNormalMap !== void 0 && (n.clearcoatNormalMap = r(e.clearcoatNormalMap)), e.clearcoatNormalScale !== void 0 && (n.clearcoatNormalScale = new _e().fromArray(e.clearcoatNormalScale)), n;
  },
  setTextures: function(e) {
    return this.textures = e, this;
  }
});
var Vb = {
  decodeText: function(e) {
    if (typeof TextDecoder != "undefined")
      return new TextDecoder().decode(e);
    for (var t = "", r = 0, n = e.length; r < n; r++)
      t += String.fromCharCode(e[r]);
    try {
      return decodeURIComponent(escape(t));
    } catch (i) {
      return t;
    }
  },
  extractUrlBase: function(e) {
    var t = e.lastIndexOf("/");
    return t === -1 ? "./" : e.substr(0, t + 1);
  }
};
function av() {
  it.call(this), this.type = "InstancedBufferGeometry", this.maxInstancedCount = void 0;
}
av.prototype = Object.assign(Object.create(it.prototype), {
  constructor: av,
  isInstancedBufferGeometry: !0,
  copy: function(e) {
    return it.prototype.copy.call(this, e), this.maxInstancedCount = e.maxInstancedCount, this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  toJSON: function() {
    var e = it.prototype.toJSON.call(this);
    return e.maxInstancedCount = this.maxInstancedCount, e.isInstancedBufferGeometry = !0, e;
  }
});
function sv(e, t, r, n) {
  typeof r == "number" && (n = r, r = !1, console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")), Et.call(this, e, t, r), this.meshPerAttribute = n || 1;
}
sv.prototype = Object.assign(Object.create(Et.prototype), {
  constructor: sv,
  isInstancedBufferAttribute: !0,
  copy: function(e) {
    return Et.prototype.copy.call(this, e), this.meshPerAttribute = e.meshPerAttribute, this;
  },
  toJSON: function() {
    var e = Et.prototype.toJSON.call(this);
    return e.meshPerAttribute = this.meshPerAttribute, e.isInstancedBufferAttribute = !0, e;
  }
});
function ov(e) {
  er.call(this, e);
}
ov.prototype = Object.assign(Object.create(er.prototype), {
  constructor: ov,
  load: function(e, t, r, n) {
    var i = this, a = new Pi(i.manager);
    a.setPath(i.path), a.load(e, function(s) {
      t(i.parse(JSON.parse(s)));
    }, r, n);
  },
  parse: function(e) {
    var t = e.isInstancedBufferGeometry ? new av() : new it(), r = e.data.index;
    if (r !== void 0) {
      var n = new dd[r.type](r.array);
      t.setIndex(new Et(n, 1));
    }
    var i = e.data.attributes;
    for (var a in i) {
      var s = i[a], n = new dd[s.type](s.array), o = s.isInstancedBufferAttribute ? sv : Et, u = new o(n, s.itemSize, s.normalized);
      s.name !== void 0 && (u.name = s.name), t.setAttribute(a, u);
    }
    var l = e.data.morphAttributes;
    if (l)
      for (var a in l) {
        for (var c = l[a], f = [], h = 0, d = c.length; h < d; h++) {
          var s = c[h], n = new dd[s.type](s.array), u = new Et(n, s.itemSize, s.normalized);
          s.name !== void 0 && (u.name = s.name), f.push(u);
        }
        t.morphAttributes[a] = f;
      }
    var g = e.data.morphTargetsRelative;
    g && (t.morphTargetsRelative = !0);
    var v = e.data.groups || e.data.drawcalls || e.data.offsets;
    if (v !== void 0)
      for (var h = 0, m = v.length; h !== m; ++h) {
        var p = v[h];
        t.addGroup(p.start, p.count, p.materialIndex);
      }
    var y = e.data.boundingSphere;
    if (y !== void 0) {
      var w = new re();
      y.center !== void 0 && w.fromArray(y.center), t.boundingSphere = new ja(w, y.radius);
    }
    return e.name && (t.name = e.name), e.userData && (t.userData = e.userData), t;
  }
});
var dd = {
  Int8Array,
  Uint8Array,
  // Workaround for IE11 pre KB2929437. See #11440
  Uint8ClampedArray: typeof Uint8ClampedArray != "undefined" ? Uint8ClampedArray : Uint8Array,
  Int16Array,
  Uint16Array,
  Int32Array,
  Uint32Array,
  Float32Array,
  Float64Array
};
function uv(e) {
  er.call(this, e);
}
uv.prototype = Object.assign(Object.create(er.prototype), {
  constructor: uv,
  load: function(e, t, r, n) {
    var i = this, a = this.path === "" ? Vb.extractUrlBase(e) : this.path;
    this.resourcePath = this.resourcePath || a;
    var s = new Pi(i.manager);
    s.setPath(this.path), s.load(e, function(o) {
      var u = null;
      try {
        u = JSON.parse(o);
      } catch (c) {
        n !== void 0 && n(c), console.error("THREE:ObjectLoader: Can't parse " + e + ".", c.message);
        return;
      }
      var l = u.metadata;
      if (l === void 0 || l.type === void 0 || l.type.toLowerCase() === "geometry") {
        console.error("THREE.ObjectLoader: Can't load " + e);
        return;
      }
      i.parse(u, t);
    }, r, n);
  },
  parse: function(e, t) {
    var r = this.parseShape(e.shapes), n = this.parseGeometries(e.geometries, r), i = this.parseImages(e.images, function() {
      t !== void 0 && t(o);
    }), a = this.parseTextures(e.textures, i), s = this.parseMaterials(e.materials, a), o = this.parseObject(e.object, n, s);
    return e.animations && (o.animations = this.parseAnimations(e.animations)), (e.images === void 0 || e.images.length === 0) && t !== void 0 && t(o), o;
  },
  parseShape: function(e) {
    var t = {};
    if (e !== void 0)
      for (var r = 0, n = e.length; r < n; r++) {
        var i = new ds().fromJSON(e[r]);
        t[i.uuid] = i;
      }
    return t;
  },
  parseGeometries: function(e, t) {
    var r = {};
    if (e !== void 0)
      for (var n = new ov(), i = 0, a = e.length; i < a; i++) {
        var s, o = e[i];
        switch (o.type) {
          case "PlaneGeometry":
          case "PlaneBufferGeometry":
            s = new fn[o.type](
              o.width,
              o.height,
              o.widthSegments,
              o.heightSegments
            );
            break;
          case "BoxGeometry":
          case "BoxBufferGeometry":
          case "CubeGeometry":
            s = new fn[o.type](
              o.width,
              o.height,
              o.depth,
              o.widthSegments,
              o.heightSegments,
              o.depthSegments
            );
            break;
          case "CircleGeometry":
          case "CircleBufferGeometry":
            s = new fn[o.type](
              o.radius,
              o.segments,
              o.thetaStart,
              o.thetaLength
            );
            break;
          case "CylinderGeometry":
          case "CylinderBufferGeometry":
            s = new fn[o.type](
              o.radiusTop,
              o.radiusBottom,
              o.height,
              o.radialSegments,
              o.heightSegments,
              o.openEnded,
              o.thetaStart,
              o.thetaLength
            );
            break;
          case "ConeGeometry":
          case "ConeBufferGeometry":
            s = new fn[o.type](
              o.radius,
              o.height,
              o.radialSegments,
              o.heightSegments,
              o.openEnded,
              o.thetaStart,
              o.thetaLength
            );
            break;
          case "SphereGeometry":
          case "SphereBufferGeometry":
            s = new fn[o.type](
              o.radius,
              o.widthSegments,
              o.heightSegments,
              o.phiStart,
              o.phiLength,
              o.thetaStart,
              o.thetaLength
            );
            break;
          case "DodecahedronGeometry":
          case "DodecahedronBufferGeometry":
          case "IcosahedronGeometry":
          case "IcosahedronBufferGeometry":
          case "OctahedronGeometry":
          case "OctahedronBufferGeometry":
          case "TetrahedronGeometry":
          case "TetrahedronBufferGeometry":
            s = new fn[o.type](
              o.radius,
              o.detail
            );
            break;
          case "RingGeometry":
          case "RingBufferGeometry":
            s = new fn[o.type](
              o.innerRadius,
              o.outerRadius,
              o.thetaSegments,
              o.phiSegments,
              o.thetaStart,
              o.thetaLength
            );
            break;
          case "TorusGeometry":
          case "TorusBufferGeometry":
            s = new fn[o.type](
              o.radius,
              o.tube,
              o.radialSegments,
              o.tubularSegments,
              o.arc
            );
            break;
          case "TorusKnotGeometry":
          case "TorusKnotBufferGeometry":
            s = new fn[o.type](
              o.radius,
              o.tube,
              o.tubularSegments,
              o.radialSegments,
              o.p,
              o.q
            );
            break;
          case "TubeGeometry":
          case "TubeBufferGeometry":
            s = new fn[o.type](
              new $p[o.path.type]().fromJSON(o.path),
              o.tubularSegments,
              o.radius,
              o.radialSegments,
              o.closed
            );
            break;
          case "LatheGeometry":
          case "LatheBufferGeometry":
            s = new fn[o.type](
              o.points,
              o.segments,
              o.phiStart,
              o.phiLength
            );
            break;
          case "PolyhedronGeometry":
          case "PolyhedronBufferGeometry":
            s = new fn[o.type](
              o.vertices,
              o.indices,
              o.radius,
              o.details
            );
            break;
          case "ShapeGeometry":
          case "ShapeBufferGeometry":
            for (var f = [], u = 0, l = o.shapes.length; u < l; u++) {
              var c = t[o.shapes[u]];
              f.push(c);
            }
            s = new fn[o.type](
              f,
              o.curveSegments
            );
            break;
          case "ExtrudeGeometry":
          case "ExtrudeBufferGeometry":
            for (var f = [], u = 0, l = o.shapes.length; u < l; u++) {
              var c = t[o.shapes[u]];
              f.push(c);
            }
            var h = o.options.extrudePath;
            h !== void 0 && (o.options.extrudePath = new $p[h.type]().fromJSON(h)), s = new fn[o.type](
              f,
              o.options
            );
            break;
          case "BufferGeometry":
          case "InstancedBufferGeometry":
            s = n.parse(o);
            break;
          case "Geometry":
            if ("THREE" in window && "LegacyJSONLoader" in THREE) {
              var d = new THREE.LegacyJSONLoader();
              s = d.parse(o, this.resourcePath).geometry;
            } else
              console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');
            break;
          default:
            console.warn('THREE.ObjectLoader: Unsupported geometry type "' + o.type + '"');
            continue;
        }
        s.uuid = o.uuid, o.name !== void 0 && (s.name = o.name), s.isBufferGeometry === !0 && o.userData !== void 0 && (s.userData = o.userData), r[o.uuid] = s;
      }
    return r;
  },
  parseMaterials: function(e, t) {
    var r = {}, n = {};
    if (e !== void 0) {
      var i = new iv();
      i.setTextures(t);
      for (var a = 0, s = e.length; a < s; a++) {
        var o = e[a];
        if (o.type === "MultiMaterial") {
          for (var u = [], l = 0; l < o.materials.length; l++) {
            var c = o.materials[l];
            r[c.uuid] === void 0 && (r[c.uuid] = i.parse(c)), u.push(r[c.uuid]);
          }
          n[o.uuid] = u;
        } else
          r[o.uuid] === void 0 && (r[o.uuid] = i.parse(o)), n[o.uuid] = r[o.uuid];
      }
    }
    return n;
  },
  parseAnimations: function(e) {
    for (var t = [], r = 0; r < e.length; r++) {
      var n = e[r], i = oi.parse(n);
      n.uuid !== void 0 && (i.uuid = n.uuid), t.push(i);
    }
    return t;
  },
  parseImages: function(e, t) {
    var r = this, n = {};
    function i(v) {
      return r.manager.itemStart(v), s.load(v, function() {
        r.manager.itemEnd(v);
      }, void 0, function() {
        r.manager.itemError(v), r.manager.itemEnd(v);
      });
    }
    if (e !== void 0 && e.length > 0) {
      var a = new Wb(t), s = new nl(a);
      s.setCrossOrigin(this.crossOrigin);
      for (var o = 0, u = e.length; o < u; o++) {
        var l = e[o], c = l.url;
        if (Array.isArray(c)) {
          n[l.uuid] = [];
          for (var f = 0, h = c.length; f < h; f++) {
            var d = c[f], g = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(d) ? d : r.resourcePath + d;
            n[l.uuid].push(i(g));
          }
        } else {
          var g = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url) ? l.url : r.resourcePath + l.url;
          n[l.uuid] = i(g);
        }
      }
    }
    return n;
  },
  parseTextures: function(e, t) {
    function r(u, l) {
      return typeof u == "number" ? u : (console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.", u), l[u]);
    }
    var n = {};
    if (e !== void 0)
      for (var i = 0, a = e.length; i < a; i++) {
        var s = e[i];
        s.image === void 0 && console.warn('THREE.ObjectLoader: No "image" specified for', s.uuid), t[s.image] === void 0 && console.warn("THREE.ObjectLoader: Undefined image", s.image);
        var o;
        Array.isArray(t[s.image]) ? o = new Oa(t[s.image]) : o = new ur(t[s.image]), o.needsUpdate = !0, o.uuid = s.uuid, s.name !== void 0 && (o.name = s.name), s.mapping !== void 0 && (o.mapping = r(s.mapping, wk)), s.offset !== void 0 && o.offset.fromArray(s.offset), s.repeat !== void 0 && o.repeat.fromArray(s.repeat), s.center !== void 0 && o.center.fromArray(s.center), s.rotation !== void 0 && (o.rotation = s.rotation), s.wrap !== void 0 && (o.wrapS = r(s.wrap[0], ny), o.wrapT = r(s.wrap[1], ny)), s.format !== void 0 && (o.format = s.format), s.type !== void 0 && (o.type = s.type), s.encoding !== void 0 && (o.encoding = s.encoding), s.minFilter !== void 0 && (o.minFilter = r(s.minFilter, iy)), s.magFilter !== void 0 && (o.magFilter = r(s.magFilter, iy)), s.anisotropy !== void 0 && (o.anisotropy = s.anisotropy), s.flipY !== void 0 && (o.flipY = s.flipY), s.premultiplyAlpha !== void 0 && (o.premultiplyAlpha = s.premultiplyAlpha), s.unpackAlignment !== void 0 && (o.unpackAlignment = s.unpackAlignment), n[s.uuid] = o;
      }
    return n;
  },
  parseObject: function(e, t, r) {
    var n;
    function i(m) {
      return t[m] === void 0 && console.warn("THREE.ObjectLoader: Undefined geometry", m), t[m];
    }
    function a(m) {
      if (m !== void 0) {
        if (Array.isArray(m)) {
          for (var p = [], y = 0, w = m.length; y < w; y++) {
            var x = m[y];
            r[x] === void 0 && console.warn("THREE.ObjectLoader: Undefined material", x), p.push(r[x]);
          }
          return p;
        }
        return r[m] === void 0 && console.warn("THREE.ObjectLoader: Undefined material", m), r[m];
      }
    }
    switch (e.type) {
      case "Scene":
        n = new Ra(), e.background !== void 0 && Number.isInteger(e.background) && (n.background = new nt(e.background)), e.fog !== void 0 && (e.fog.type === "Fog" ? n.fog = new _p(e.fog.color, e.fog.near, e.fog.far) : e.fog.type === "FogExp2" && (n.fog = new Dp(e.fog.color, e.fog.density)));
        break;
      case "PerspectiveCamera":
        n = new Wr(e.fov, e.aspect, e.near, e.far), e.focus !== void 0 && (n.focus = e.focus), e.zoom !== void 0 && (n.zoom = e.zoom), e.filmGauge !== void 0 && (n.filmGauge = e.filmGauge), e.filmOffset !== void 0 && (n.filmOffset = e.filmOffset), e.view !== void 0 && (n.view = Object.assign({}, e.view));
        break;
      case "OrthographicCamera":
        n = new al(e.left, e.right, e.top, e.bottom, e.near, e.far), e.zoom !== void 0 && (n.zoom = e.zoom), e.view !== void 0 && (n.view = Object.assign({}, e.view));
        break;
      case "AmbientLight":
        n = new rv(e.color, e.intensity);
        break;
      case "DirectionalLight":
        n = new tv(e.color, e.intensity);
        break;
      case "PointLight":
        n = new Qp(e.color, e.intensity, e.distance, e.decay);
        break;
      case "RectAreaLight":
        n = new nv(e.color, e.intensity, e.width, e.height);
        break;
      case "SpotLight":
        n = new Zp(e.color, e.intensity, e.distance, e.angle, e.penumbra, e.decay);
        break;
      case "HemisphereLight":
        n = new Yp(e.color, e.groundColor, e.intensity);
        break;
      case "SkinnedMesh":
        console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");
      case "Mesh":
        var s = i(e.geometry), o = a(e.material);
        s.bones && s.bones.length > 0 ? n = new df(s, o) : n = new Tr(s, o);
        break;
      case "InstancedMesh":
        var s = i(e.geometry), o = a(e.material), u = e.count, l = e.instanceMatrix;
        n = new Lp(s, o, u), n.instanceMatrix = new Et(new Float32Array(l.array), 16);
        break;
      case "LOD":
        n = new hf();
        break;
      case "Line":
        n = new $n(i(e.geometry), a(e.material), e.mode);
        break;
      case "LineLoop":
        n = new Fp(i(e.geometry), a(e.material));
        break;
      case "LineSegments":
        n = new Ur(i(e.geometry), a(e.material));
        break;
      case "PointCloud":
      case "Points":
        n = new Rp(i(e.geometry), a(e.material));
        break;
      case "Sprite":
        n = new Pp(a(e.material));
        break;
      case "Group":
        n = new Uu();
        break;
      default:
        n = new et();
    }
    if (n.uuid = e.uuid, e.name !== void 0 && (n.name = e.name), e.matrix !== void 0 ? (n.matrix.fromArray(e.matrix), e.matrixAutoUpdate !== void 0 && (n.matrixAutoUpdate = e.matrixAutoUpdate), n.matrixAutoUpdate && n.matrix.decompose(n.position, n.quaternion, n.scale)) : (e.position !== void 0 && n.position.fromArray(e.position), e.rotation !== void 0 && n.rotation.fromArray(e.rotation), e.quaternion !== void 0 && n.quaternion.fromArray(e.quaternion), e.scale !== void 0 && n.scale.fromArray(e.scale)), e.castShadow !== void 0 && (n.castShadow = e.castShadow), e.receiveShadow !== void 0 && (n.receiveShadow = e.receiveShadow), e.shadow && (e.shadow.bias !== void 0 && (n.shadow.bias = e.shadow.bias), e.shadow.radius !== void 0 && (n.shadow.radius = e.shadow.radius), e.shadow.mapSize !== void 0 && n.shadow.mapSize.fromArray(e.shadow.mapSize), e.shadow.camera !== void 0 && (n.shadow.camera = this.parseObject(e.shadow.camera))), e.visible !== void 0 && (n.visible = e.visible), e.frustumCulled !== void 0 && (n.frustumCulled = e.frustumCulled), e.renderOrder !== void 0 && (n.renderOrder = e.renderOrder), e.userData !== void 0 && (n.userData = e.userData), e.layers !== void 0 && (n.layers.mask = e.layers), e.children !== void 0)
      for (var c = e.children, f = 0; f < c.length; f++)
        n.add(this.parseObject(c[f], t, r));
    if (e.type === "LOD") {
      e.autoUpdate !== void 0 && (n.autoUpdate = e.autoUpdate);
      for (var h = e.levels, d = 0; d < h.length; d++) {
        var g = h[d], v = n.getObjectByProperty("uuid", g.object);
        v !== void 0 && n.addLevel(v, g.distance);
      }
    }
    return n;
  }
});
var wk = {
  UVMapping: l0,
  CubeReflectionMapping: c0,
  CubeRefractionMapping: f0,
  EquirectangularReflectionMapping: hb,
  EquirectangularRefractionMapping: h0,
  SphericalReflectionMapping: db,
  CubeUVReflectionMapping: wl,
  CubeUVRefractionMapping: d0
}, ny = {
  RepeatWrapping: rf,
  ClampToEdgeWrapping: Mn,
  MirroredRepeatWrapping: nf
}, iy = {
  NearestFilter: Or,
  NearestMipmapNearestFilter: yp,
  NearestMipmapLinearFilter: bp,
  LinearFilter: Vr,
  LinearMipmapNearestFilter: pb,
  LinearMipmapLinearFilter: xl
};
function ay(e) {
  typeof createImageBitmap == "undefined" && console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."), typeof fetch == "undefined" && console.warn("THREE.ImageBitmapLoader: fetch() not supported."), er.call(this, e), this.options = void 0;
}
ay.prototype = Object.assign(Object.create(er.prototype), {
  constructor: ay,
  setOptions: function(t) {
    return this.options = t, this;
  },
  load: function(e, t, r, n) {
    e === void 0 && (e = ""), this.path !== void 0 && (e = this.path + e), e = this.manager.resolveURL(e);
    var i = this, a = jo.get(e);
    if (a !== void 0)
      return i.manager.itemStart(e), setTimeout(function() {
        t && t(a), i.manager.itemEnd(e);
      }, 0), a;
    fetch(e).then(function(s) {
      return s.blob();
    }).then(function(s) {
      return i.options === void 0 ? createImageBitmap(s) : createImageBitmap(s, i.options);
    }).then(function(s) {
      jo.add(e, s), t && t(s), i.manager.itemEnd(e);
    }).catch(function(s) {
      n && n(s), i.manager.itemError(e), i.manager.itemEnd(e);
    }), i.manager.itemStart(e);
  }
});
function Hb() {
  this.type = "ShapePath", this.color = new nt(), this.subPaths = [], this.currentPath = null;
}
Object.assign(Hb.prototype, {
  moveTo: function(e, t) {
    return this.currentPath = new Ai(), this.subPaths.push(this.currentPath), this.currentPath.moveTo(e, t), this;
  },
  lineTo: function(e, t) {
    return this.currentPath.lineTo(e, t), this;
  },
  quadraticCurveTo: function(e, t, r, n) {
    return this.currentPath.quadraticCurveTo(e, t, r, n), this;
  },
  bezierCurveTo: function(e, t, r, n, i, a) {
    return this.currentPath.bezierCurveTo(e, t, r, n, i, a), this;
  },
  splineThru: function(e) {
    return this.currentPath.splineThru(e), this;
  },
  toShapes: function(e, t) {
    function r(G) {
      for (var V = [], H = 0, U = G.length; H < U; H++) {
        var R = G[H], B = new ds();
        B.curves = R.curves, V.push(B);
      }
      return V;
    }
    function n(G, V) {
      for (var H = V.length, U = !1, R = H - 1, B = 0; B < H; R = B++) {
        var C = V[R], Z = V[B], W = Z.x - C.x, J = Z.y - C.y;
        if (Math.abs(J) > Number.EPSILON) {
          if (J < 0 && (C = V[B], W = -W, Z = V[R], J = -J), G.y < C.y || G.y > Z.y) continue;
          if (G.y === C.y) {
            if (G.x === C.x) return !0;
          } else {
            var Q = J * (G.x - C.x) - W * (G.y - C.y);
            if (Q === 0) return !0;
            if (Q < 0) continue;
            U = !U;
          }
        } else {
          if (G.y !== C.y) continue;
          if (Z.x <= G.x && G.x <= C.x || C.x <= G.x && G.x <= Z.x) return !0;
        }
      }
      return U;
    }
    var i = La.isClockWise, a = this.subPaths;
    if (a.length === 0) return [];
    if (t === !0) return r(a);
    var s, o, u, l = [];
    if (a.length === 1)
      return o = a[0], u = new ds(), u.curves = o.curves, l.push(u), l;
    var c = !i(a[0].getPoints());
    c = e ? !c : c;
    var f = [], h = [], d = [], g = 0, v;
    h[g] = void 0, d[g] = [];
    for (var m = 0, p = a.length; m < p; m++)
      o = a[m], v = o.getPoints(), s = i(v), s = e ? !s : s, s ? (!c && h[g] && g++, h[g] = { s: new ds(), p: v }, h[g].s.curves = o.curves, c && g++, d[g] = []) : d[g].push({ h: o, p: v[0] });
    if (!h[0]) return r(a);
    if (h.length > 1) {
      for (var y = !1, w = [], x = 0, b = h.length; x < b; x++)
        f[x] = [];
      for (var x = 0, b = h.length; x < b; x++)
        for (var M = d[x], k = 0; k < M.length; k++) {
          for (var E = M[k], S = !0, F = 0; F < h.length; F++)
            n(E.p, h[F].p) && (x !== F && w.push({ froms: x, tos: F, hole: k }), S ? (S = !1, f[F].push(E)) : y = !0);
          S && f[x].push(E);
        }
      w.length > 0 && (y || (d = f));
    }
    for (var O, m = 0, D = h.length; m < D; m++) {
      u = h[m].s, l.push(u), O = d[m];
      for (var _ = 0, L = O.length; _ < L; _++)
        u.holes.push(O[_].h);
    }
    return l;
  }
});
function jb(e) {
  this.type = "Font", this.data = e;
}
Object.assign(jb.prototype, {
  isFont: !0,
  generateShapes: function(e, t) {
    t === void 0 && (t = 100);
    for (var r = [], n = xk(e, t, this.data), i = 0, a = n.length; i < a; i++)
      Array.prototype.push.apply(r, n[i].toShapes());
    return r;
  }
});
function xk(e, t, r) {
  for (var n = Array.from ? Array.from(e) : String(e).split(""), i = t / r.resolution, a = (r.boundingBox.yMax - r.boundingBox.yMin + r.underlineThickness) * i, s = [], o = 0, u = 0, l = 0; l < n.length; l++) {
    var c = n[l];
    if (c === `
`)
      o = 0, u -= a;
    else {
      var f = Mk(c, i, o, u, r);
      o += f.offsetX, s.push(f.path);
    }
  }
  return s;
}
function Mk(e, t, r, n, i) {
  var a = i.glyphs[e] || i.glyphs["?"];
  if (!a) {
    console.error('THREE.Font: character "' + e + '" does not exists in font family ' + i.familyName + ".");
    return;
  }
  var s = new Hb(), o, u, l, c, f, h, d, g;
  if (a.o)
    for (var v = a._cachedOutline || (a._cachedOutline = a.o.split(" ")), m = 0, p = v.length; m < p; ) {
      var y = v[m++];
      switch (y) {
        case "m":
          o = v[m++] * t + r, u = v[m++] * t + n, s.moveTo(o, u);
          break;
        case "l":
          o = v[m++] * t + r, u = v[m++] * t + n, s.lineTo(o, u);
          break;
        case "q":
          l = v[m++] * t + r, c = v[m++] * t + n, f = v[m++] * t + r, h = v[m++] * t + n, s.quadraticCurveTo(f, h, l, c);
          break;
        case "b":
          l = v[m++] * t + r, c = v[m++] * t + n, f = v[m++] * t + r, h = v[m++] * t + n, d = v[m++] * t + r, g = v[m++] * t + n, s.bezierCurveTo(f, h, d, g, l, c);
          break;
      }
    }
  return { offsetX: a.ha * t, path: s };
}
function sy(e) {
  er.call(this, e);
}
sy.prototype = Object.assign(Object.create(er.prototype), {
  constructor: sy,
  load: function(e, t, r, n) {
    var i = this, a = new Pi(this.manager);
    a.setPath(this.path), a.load(e, function(s) {
      var o;
      try {
        o = JSON.parse(s);
      } catch (l) {
        console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."), o = JSON.parse(s.substring(65, s.length - 2));
      }
      var u = i.parse(o);
      t && t(u);
    }, r, n);
  },
  parse: function(e) {
    return new jb(e);
  }
});
var uc, Xb = {
  getContext: function() {
    return uc === void 0 && (uc = new (window.AudioContext || window.webkitAudioContext)()), uc;
  },
  setContext: function(e) {
    uc = e;
  }
};
function lv(e) {
  er.call(this, e);
}
lv.prototype = Object.assign(Object.create(er.prototype), {
  constructor: lv,
  load: function(e, t, r, n) {
    var i = new Pi(this.manager);
    i.setResponseType("arraybuffer"), i.setPath(this.path), i.load(e, function(a) {
      var s = a.slice(0), o = Xb.getContext();
      o.decodeAudioData(s, function(u) {
        t(u);
      });
    }, r, n);
  }
});
function y0() {
  this.coefficients = [];
  for (var e = 0; e < 9; e++)
    this.coefficients.push(new re());
}
Object.assign(y0.prototype, {
  isSphericalHarmonics3: !0,
  set: function(e) {
    for (var t = 0; t < 9; t++)
      this.coefficients[t].copy(e[t]);
    return this;
  },
  zero: function() {
    for (var e = 0; e < 9; e++)
      this.coefficients[e].set(0, 0, 0);
    return this;
  },
  // get the radiance in the direction of the normal
  // target is a Vector3
  getAt: function(e, t) {
    var r = e.x, n = e.y, i = e.z, a = this.coefficients;
    return t.copy(a[0]).multiplyScalar(0.282095), t.addScale(a[1], 0.488603 * n), t.addScale(a[2], 0.488603 * i), t.addScale(a[3], 0.488603 * r), t.addScale(a[4], 1.092548 * (r * n)), t.addScale(a[5], 1.092548 * (n * i)), t.addScale(a[6], 0.315392 * (3 * i * i - 1)), t.addScale(a[7], 1.092548 * (r * i)), t.addScale(a[8], 0.546274 * (r * r - n * n)), t;
  },
  // get the irradiance (radiance convolved with cosine lobe) in the direction of the normal
  // target is a Vector3
  // https://graphics.stanford.edu/papers/envmap/envmap.pdf
  getIrradianceAt: function(e, t) {
    var r = e.x, n = e.y, i = e.z, a = this.coefficients;
    return t.copy(a[0]).multiplyScalar(0.886227), t.addScale(a[1], 2 * 0.511664 * n), t.addScale(a[2], 2 * 0.511664 * i), t.addScale(a[3], 2 * 0.511664 * r), t.addScale(a[4], 2 * 0.429043 * r * n), t.addScale(a[5], 2 * 0.429043 * n * i), t.addScale(a[6], 0.743125 * i * i - 0.247708), t.addScale(a[7], 2 * 0.429043 * r * i), t.addScale(a[8], 0.429043 * (r * r - n * n)), t;
  },
  add: function(e) {
    for (var t = 0; t < 9; t++)
      this.coefficients[t].add(e.coefficients[t]);
    return this;
  },
  scale: function(e) {
    for (var t = 0; t < 9; t++)
      this.coefficients[t].multiplyScalar(e);
    return this;
  },
  lerp: function(e, t) {
    for (var r = 0; r < 9; r++)
      this.coefficients[r].lerp(e.coefficients[r], t);
    return this;
  },
  equals: function(e) {
    for (var t = 0; t < 9; t++)
      if (!this.coefficients[t].equals(e.coefficients[t]))
        return !1;
    return !0;
  },
  copy: function(e) {
    return this.set(e.coefficients);
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  fromArray: function(e, t) {
    t === void 0 && (t = 0);
    for (var r = this.coefficients, n = 0; n < 9; n++)
      r[n].fromArray(e, t + n * 3);
    return this;
  },
  toArray: function(e, t) {
    e === void 0 && (e = []), t === void 0 && (t = 0);
    for (var r = this.coefficients, n = 0; n < 9; n++)
      r[n].toArray(e, t + n * 3);
    return e;
  }
});
Object.assign(y0, {
  // evaluate the basis functions
  // shBasis is an Array[ 9 ]
  getBasisAt: function(e, t) {
    var r = e.x, n = e.y, i = e.z;
    t[0] = 0.282095, t[1] = 0.488603 * n, t[2] = 0.488603 * i, t[3] = 0.488603 * r, t[4] = 1.092548 * r * n, t[5] = 1.092548 * n * i, t[6] = 0.315392 * (3 * i * i - 1), t[7] = 1.092548 * r * i, t[8] = 0.546274 * (r * r - n * n);
  }
});
function Ci(e, t) {
  mr.call(this, void 0, t), this.sh = e !== void 0 ? e : new y0();
}
Ci.prototype = Object.assign(Object.create(mr.prototype), {
  constructor: Ci,
  isLightProbe: !0,
  copy: function(e) {
    return mr.prototype.copy.call(this, e), this.sh.copy(e.sh), this.intensity = e.intensity, this;
  },
  toJSON: function(e) {
    var t = mr.prototype.toJSON.call(this, e);
    return t;
  }
});
function oy(e, t, r) {
  Ci.call(this, void 0, r);
  var n = new nt().set(e), i = new nt().set(t), a = new re(n.r, n.g, n.b), s = new re(i.r, i.g, i.b), o = Math.sqrt(Math.PI), u = o * Math.sqrt(0.75);
  this.sh.coefficients[0].copy(a).add(s).multiplyScalar(o), this.sh.coefficients[1].copy(a).sub(s).multiplyScalar(u);
}
oy.prototype = Object.assign(Object.create(Ci.prototype), {
  constructor: oy,
  isHemisphereLightProbe: !0,
  copy: function(e) {
    return Ci.prototype.copy.call(this, e), this;
  },
  toJSON: function(e) {
    var t = Ci.prototype.toJSON.call(this, e);
    return t;
  }
});
function uy(e, t) {
  Ci.call(this, void 0, t);
  var r = new nt().set(e);
  this.sh.coefficients[0].set(r.r, r.g, r.b).multiplyScalar(2 * Math.sqrt(Math.PI));
}
uy.prototype = Object.assign(Object.create(Ci.prototype), {
  constructor: uy,
  isAmbientLightProbe: !0,
  copy: function(e) {
    return Ci.prototype.copy.call(this, e), this;
  },
  toJSON: function(e) {
    var t = Ci.prototype.toJSON.call(this, e);
    return t;
  }
});
var ly = new Nt(), cy = new Nt();
function Ek() {
  this.type = "StereoCamera", this.aspect = 1, this.eyeSep = 0.064, this.cameraL = new Wr(), this.cameraL.layers.enable(1), this.cameraL.matrixAutoUpdate = !1, this.cameraR = new Wr(), this.cameraR.layers.enable(2), this.cameraR.matrixAutoUpdate = !1, this._cache = {
    focus: null,
    fov: null,
    aspect: null,
    near: null,
    far: null,
    zoom: null,
    eyeSep: null
  };
}
Object.assign(Ek.prototype, {
  update: function(e) {
    var t = this._cache, r = t.focus !== e.focus || t.fov !== e.fov || t.aspect !== e.aspect * this.aspect || t.near !== e.near || t.far !== e.far || t.zoom !== e.zoom || t.eyeSep !== this.eyeSep;
    if (r) {
      t.focus = e.focus, t.fov = e.fov, t.aspect = e.aspect * this.aspect, t.near = e.near, t.far = e.far, t.zoom = e.zoom, t.eyeSep = this.eyeSep;
      var n = e.projectionMatrix.clone(), i = t.eyeSep / 2, a = i * t.near / t.focus, s = t.near * Math.tan(It.DEG2RAD * t.fov * 0.5) / t.zoom, o, u;
      cy.elements[12] = -i, ly.elements[12] = i, o = -s * t.aspect + a, u = s * t.aspect + a, n.elements[0] = 2 * t.near / (u - o), n.elements[8] = (u + o) / (u - o), this.cameraL.projectionMatrix.copy(n), o = -s * t.aspect - a, u = s * t.aspect - a, n.elements[0] = 2 * t.near / (u - o), n.elements[8] = (u + o) / (u - o), this.cameraR.projectionMatrix.copy(n);
    }
    this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cy), this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ly);
  }
});
function qb(e) {
  this.autoStart = e !== void 0 ? e : !0, this.startTime = 0, this.oldTime = 0, this.elapsedTime = 0, this.running = !1;
}
Object.assign(qb.prototype, {
  start: function() {
    this.startTime = (typeof performance == "undefined" ? Date : performance).now(), this.oldTime = this.startTime, this.elapsedTime = 0, this.running = !0;
  },
  stop: function() {
    this.getElapsedTime(), this.running = !1, this.autoStart = !1;
  },
  getElapsedTime: function() {
    return this.getDelta(), this.elapsedTime;
  },
  getDelta: function() {
    var e = 0;
    if (this.autoStart && !this.running)
      return this.start(), 0;
    if (this.running) {
      var t = (typeof performance == "undefined" ? Date : performance).now();
      e = (t - this.oldTime) / 1e3, this.oldTime = t, this.elapsedTime += e;
    }
    return e;
  }
});
var is = new re(), fy = new Tn(), Ak = new re(), as = new re();
function hy() {
  et.call(this), this.type = "AudioListener", this.context = Xb.getContext(), this.gain = this.context.createGain(), this.gain.connect(this.context.destination), this.filter = null, this.timeDelta = 0, this._clock = new qb();
}
hy.prototype = Object.assign(Object.create(et.prototype), {
  constructor: hy,
  getInput: function() {
    return this.gain;
  },
  removeFilter: function() {
    return this.filter !== null && (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination), this.gain.connect(this.context.destination), this.filter = null), this;
  },
  getFilter: function() {
    return this.filter;
  },
  setFilter: function(e) {
    return this.filter !== null ? (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination)) : this.gain.disconnect(this.context.destination), this.filter = e, this.gain.connect(this.filter), this.filter.connect(this.context.destination), this;
  },
  getMasterVolume: function() {
    return this.gain.gain.value;
  },
  setMasterVolume: function(e) {
    return this.gain.gain.setTargetAtTime(e, this.context.currentTime, 0.01), this;
  },
  updateMatrixWorld: function(e) {
    et.prototype.updateMatrixWorld.call(this, e);
    var t = this.context.listener, r = this.up;
    if (this.timeDelta = this._clock.getDelta(), this.matrixWorld.decompose(is, fy, Ak), as.set(0, 0, -1).applyQuaternion(fy), t.positionX) {
      var n = this.context.currentTime + this.timeDelta;
      t.positionX.linearRampToValueAtTime(is.x, n), t.positionY.linearRampToValueAtTime(is.y, n), t.positionZ.linearRampToValueAtTime(is.z, n), t.forwardX.linearRampToValueAtTime(as.x, n), t.forwardY.linearRampToValueAtTime(as.y, n), t.forwardZ.linearRampToValueAtTime(as.z, n), t.upX.linearRampToValueAtTime(r.x, n), t.upY.linearRampToValueAtTime(r.y, n), t.upZ.linearRampToValueAtTime(r.z, n);
    } else
      t.setPosition(is.x, is.y, is.z), t.setOrientation(as.x, as.y, as.z, r.x, r.y, r.z);
  }
});
function sl(e) {
  et.call(this), this.type = "Audio", this.listener = e, this.context = e.context, this.gain = this.context.createGain(), this.gain.connect(e.getInput()), this.autoplay = !1, this.buffer = null, this.detune = 0, this.loop = !1, this.loopStart = 0, this.loopEnd = 0, this.offset = 0, this.duration = void 0, this.playbackRate = 1, this.isPlaying = !1, this.hasPlaybackControl = !0, this.sourceType = "empty", this._startedAt = 0, this._pausedAt = 0, this.filters = [];
}
sl.prototype = Object.assign(Object.create(et.prototype), {
  constructor: sl,
  getOutput: function() {
    return this.gain;
  },
  setNodeSource: function(e) {
    return this.hasPlaybackControl = !1, this.sourceType = "audioNode", this.source = e, this.connect(), this;
  },
  setMediaElementSource: function(e) {
    return this.hasPlaybackControl = !1, this.sourceType = "mediaNode", this.source = this.context.createMediaElementSource(e), this.connect(), this;
  },
  setMediaStreamSource: function(e) {
    return this.hasPlaybackControl = !1, this.sourceType = "mediaStreamNode", this.source = this.context.createMediaStreamSource(e), this.connect(), this;
  },
  setBuffer: function(e) {
    return this.buffer = e, this.sourceType = "buffer", this.autoplay && this.play(), this;
  },
  play: function(e) {
    if (e === void 0 && (e = 0), this.isPlaying === !0) {
      console.warn("THREE.Audio: Audio is already playing.");
      return;
    }
    if (this.hasPlaybackControl === !1) {
      console.warn("THREE.Audio: this Audio has no playback control.");
      return;
    }
    this._startedAt = this.context.currentTime + e;
    var t = this.context.createBufferSource();
    return t.buffer = this.buffer, t.loop = this.loop, t.loopStart = this.loopStart, t.loopEnd = this.loopEnd, t.onended = this.onEnded.bind(this), t.start(this._startedAt, this._pausedAt + this.offset, this.duration), this.isPlaying = !0, this.source = t, this.setDetune(this.detune), this.setPlaybackRate(this.playbackRate), this.connect();
  },
  pause: function() {
    if (this.hasPlaybackControl === !1) {
      console.warn("THREE.Audio: this Audio has no playback control.");
      return;
    }
    return this.isPlaying === !0 && (this._pausedAt = (this.context.currentTime - this._startedAt) * this.playbackRate, this.source.stop(), this.source.onended = null, this.isPlaying = !1), this;
  },
  stop: function() {
    if (this.hasPlaybackControl === !1) {
      console.warn("THREE.Audio: this Audio has no playback control.");
      return;
    }
    return this._pausedAt = 0, this.source.stop(), this.source.onended = null, this.isPlaying = !1, this;
  },
  connect: function() {
    if (this.filters.length > 0) {
      this.source.connect(this.filters[0]);
      for (var e = 1, t = this.filters.length; e < t; e++)
        this.filters[e - 1].connect(this.filters[e]);
      this.filters[this.filters.length - 1].connect(this.getOutput());
    } else
      this.source.connect(this.getOutput());
    return this;
  },
  disconnect: function() {
    if (this.filters.length > 0) {
      this.source.disconnect(this.filters[0]);
      for (var e = 1, t = this.filters.length; e < t; e++)
        this.filters[e - 1].disconnect(this.filters[e]);
      this.filters[this.filters.length - 1].disconnect(this.getOutput());
    } else
      this.source.disconnect(this.getOutput());
    return this;
  },
  getFilters: function() {
    return this.filters;
  },
  setFilters: function(e) {
    return e || (e = []), this.isPlaying === !0 ? (this.disconnect(), this.filters = e, this.connect()) : this.filters = e, this;
  },
  setDetune: function(e) {
    if (this.detune = e, this.source.detune !== void 0)
      return this.isPlaying === !0 && this.source.detune.setTargetAtTime(this.detune, this.context.currentTime, 0.01), this;
  },
  getDetune: function() {
    return this.detune;
  },
  getFilter: function() {
    return this.getFilters()[0];
  },
  setFilter: function(e) {
    return this.setFilters(e ? [e] : []);
  },
  setPlaybackRate: function(e) {
    if (this.hasPlaybackControl === !1) {
      console.warn("THREE.Audio: this Audio has no playback control.");
      return;
    }
    return this.playbackRate = e, this.isPlaying === !0 && this.source.playbackRate.setTargetAtTime(this.playbackRate, this.context.currentTime, 0.01), this;
  },
  getPlaybackRate: function() {
    return this.playbackRate;
  },
  onEnded: function() {
    this.isPlaying = !1;
  },
  getLoop: function() {
    return this.hasPlaybackControl === !1 ? (console.warn("THREE.Audio: this Audio has no playback control."), !1) : this.loop;
  },
  setLoop: function(e) {
    if (this.hasPlaybackControl === !1) {
      console.warn("THREE.Audio: this Audio has no playback control.");
      return;
    }
    return this.loop = e, this.isPlaying === !0 && (this.source.loop = this.loop), this;
  },
  setLoopStart: function(e) {
    return this.loopStart = e, this;
  },
  setLoopEnd: function(e) {
    return this.loopEnd = e, this;
  },
  getVolume: function() {
    return this.gain.gain.value;
  },
  setVolume: function(e) {
    return this.gain.gain.setTargetAtTime(e, this.context.currentTime, 0.01), this;
  }
});
var ss = new re(), dy = new Tn(), Tk = new re(), os = new re();
function py(e) {
  sl.call(this, e), this.panner = this.context.createPanner(), this.panner.panningModel = "HRTF", this.panner.connect(this.gain);
}
py.prototype = Object.assign(Object.create(sl.prototype), {
  constructor: py,
  getOutput: function() {
    return this.panner;
  },
  getRefDistance: function() {
    return this.panner.refDistance;
  },
  setRefDistance: function(e) {
    return this.panner.refDistance = e, this;
  },
  getRolloffFactor: function() {
    return this.panner.rolloffFactor;
  },
  setRolloffFactor: function(e) {
    return this.panner.rolloffFactor = e, this;
  },
  getDistanceModel: function() {
    return this.panner.distanceModel;
  },
  setDistanceModel: function(e) {
    return this.panner.distanceModel = e, this;
  },
  getMaxDistance: function() {
    return this.panner.maxDistance;
  },
  setMaxDistance: function(e) {
    return this.panner.maxDistance = e, this;
  },
  setDirectionalCone: function(e, t, r) {
    return this.panner.coneInnerAngle = e, this.panner.coneOuterAngle = t, this.panner.coneOuterGain = r, this;
  },
  updateMatrixWorld: function(e) {
    if (et.prototype.updateMatrixWorld.call(this, e), !(this.hasPlaybackControl === !0 && this.isPlaying === !1)) {
      this.matrixWorld.decompose(ss, dy, Tk), os.set(0, 0, 1).applyQuaternion(dy);
      var t = this.panner;
      if (t.positionX) {
        var r = this.context.currentTime + this.listener.timeDelta;
        t.positionX.linearRampToValueAtTime(ss.x, r), t.positionY.linearRampToValueAtTime(ss.y, r), t.positionZ.linearRampToValueAtTime(ss.z, r), t.orientationX.linearRampToValueAtTime(os.x, r), t.orientationY.linearRampToValueAtTime(os.y, r), t.orientationZ.linearRampToValueAtTime(os.z, r);
      } else
        t.setPosition(ss.x, ss.y, ss.z), t.setOrientation(os.x, os.y, os.z);
    }
  }
});
function $b(e, t) {
  this.analyser = e.context.createAnalyser(), this.analyser.fftSize = t !== void 0 ? t : 2048, this.data = new Uint8Array(this.analyser.frequencyBinCount), e.getOutput().connect(this.analyser);
}
Object.assign($b.prototype, {
  getFrequencyData: function() {
    return this.analyser.getByteFrequencyData(this.data), this.data;
  },
  getAverageFrequency: function() {
    for (var e = 0, t = this.getFrequencyData(), r = 0; r < t.length; r++)
      e += t[r];
    return e / t.length;
  }
});
function Yb(e, t, r) {
  this.binding = e, this.valueSize = r;
  var n = Float64Array, i;
  switch (t) {
    case "quaternion":
      i = this._slerp;
      break;
    case "string":
    case "bool":
      n = Array, i = this._select;
      break;
    default:
      i = this._lerp;
  }
  this.buffer = new n(r * 4), this._mixBufferRegion = i, this.cumulativeWeight = 0, this.useCount = 0, this.referenceCount = 0;
}
Object.assign(Yb.prototype, {
  // accumulate data in the 'incoming' region into 'accu<i>'
  accumulate: function(e, t) {
    var r = this.buffer, n = this.valueSize, i = e * n + n, a = this.cumulativeWeight;
    if (a === 0) {
      for (var s = 0; s !== n; ++s)
        r[i + s] = r[s];
      a = t;
    } else {
      a += t;
      var o = t / a;
      this._mixBufferRegion(r, i, 0, o, n);
    }
    this.cumulativeWeight = a;
  },
  // apply the state of 'accu<i>' to the binding when accus differ
  apply: function(e) {
    var t = this.valueSize, r = this.buffer, n = e * t + t, i = this.cumulativeWeight, a = this.binding;
    if (this.cumulativeWeight = 0, i < 1) {
      var s = t * 3;
      this._mixBufferRegion(
        r,
        n,
        s,
        1 - i,
        t
      );
    }
    for (var o = t, u = t + t; o !== u; ++o)
      if (r[o] !== r[o + t]) {
        a.setValue(r, n);
        break;
      }
  },
  // remember the state of the bound property and copy it to both accus
  saveOriginalState: function() {
    var e = this.binding, t = this.buffer, r = this.valueSize, n = r * 3;
    e.getValue(t, n);
    for (var i = r, a = n; i !== a; ++i)
      t[i] = t[n + i % r];
    this.cumulativeWeight = 0;
  },
  // apply the state previously taken via 'saveOriginalState' to the binding
  restoreOriginalState: function() {
    var e = this.valueSize * 3;
    this.binding.setValue(this.buffer, e);
  },
  // mix functions
  _select: function(e, t, r, n, i) {
    if (n >= 0.5)
      for (var a = 0; a !== i; ++a)
        e[t + a] = e[r + a];
  },
  _slerp: function(e, t, r, n) {
    Tn.slerpFlat(e, t, e, t, e, r, n);
  },
  _lerp: function(e, t, r, n, i) {
    for (var a = 1 - n, s = 0; s !== i; ++s) {
      var o = t + s;
      e[o] = e[o] * a + e[r + s] * n;
    }
  }
});
var b0 = "\\[\\]\\.:\\/", Sk = new RegExp("[" + b0 + "]", "g"), w0 = "[^" + b0 + "]", kk = "[^" + b0.replace("\\.", "") + "]", Ck = /((?:WC+[\/:])*)/.source.replace("WC", w0), Dk = /(WCOD+)?/.source.replace("WCOD", kk), _k = /(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC", w0), Pk = /\.(WC+)(?:\[(.+)\])?/.source.replace("WC", w0), Bk = new RegExp(
  "^" + Ck + Dk + _k + Pk + "$"
), Lk = ["material", "materials", "bones"];
function Kb(e, t, r) {
  var n = r || mn.parseTrackName(t);
  this._targetGroup = e, this._bindings = e.subscribe_(t, n);
}
Object.assign(Kb.prototype, {
  getValue: function(e, t) {
    this.bind();
    var r = this._targetGroup.nCachedObjects_, n = this._bindings[r];
    n !== void 0 && n.getValue(e, t);
  },
  setValue: function(e, t) {
    for (var r = this._bindings, n = this._targetGroup.nCachedObjects_, i = r.length; n !== i; ++n)
      r[n].setValue(e, t);
  },
  bind: function() {
    for (var e = this._bindings, t = this._targetGroup.nCachedObjects_, r = e.length; t !== r; ++t)
      e[t].bind();
  },
  unbind: function() {
    for (var e = this._bindings, t = this._targetGroup.nCachedObjects_, r = e.length; t !== r; ++t)
      e[t].unbind();
  }
});
function mn(e, t, r) {
  this.path = t, this.parsedPath = r || mn.parseTrackName(t), this.node = mn.findNode(e, this.parsedPath.nodeName) || e, this.rootNode = e;
}
Object.assign(mn, {
  Composite: Kb,
  create: function(e, t, r) {
    return e && e.isAnimationObjectGroup ? new mn.Composite(e, t, r) : new mn(e, t, r);
  },
  /**
   * Replaces spaces with underscores and removes unsupported characters from
   * node names, to ensure compatibility with parseTrackName().
   *
   * @param {string} name Node name to be sanitized.
   * @return {string}
   */
  sanitizeNodeName: function(e) {
    return e.replace(/\s/g, "_").replace(Sk, "");
  },
  parseTrackName: function(e) {
    var t = Bk.exec(e);
    if (!t)
      throw new Error("PropertyBinding: Cannot parse trackName: " + e);
    var r = {
      // directoryName: matches[ 1 ], // (tschw) currently unused
      nodeName: t[2],
      objectName: t[3],
      objectIndex: t[4],
      propertyName: t[5],
      // required
      propertyIndex: t[6]
    }, n = r.nodeName && r.nodeName.lastIndexOf(".");
    if (n !== void 0 && n !== -1) {
      var i = r.nodeName.substring(n + 1);
      Lk.indexOf(i) !== -1 && (r.nodeName = r.nodeName.substring(0, n), r.objectName = i);
    }
    if (r.propertyName === null || r.propertyName.length === 0)
      throw new Error("PropertyBinding: can not parse propertyName from trackName: " + e);
    return r;
  },
  findNode: function(e, t) {
    if (!t || t === "" || t === "root" || t === "." || t === -1 || t === e.name || t === e.uuid)
      return e;
    if (e.skeleton) {
      var r = e.skeleton.getBoneByName(t);
      if (r !== void 0)
        return r;
    }
    if (e.children) {
      var n = function(a) {
        for (var s = 0; s < a.length; s++) {
          var o = a[s];
          if (o.name === t || o.uuid === t)
            return o;
          var u = n(o.children);
          if (u) return u;
        }
        return null;
      }, i = n(e.children);
      if (i)
        return i;
    }
    return null;
  }
});
Object.assign(mn.prototype, {
  // prototype, continued
  // these are used to "bind" a nonexistent property
  _getValue_unavailable: function() {
  },
  _setValue_unavailable: function() {
  },
  BindingType: {
    Direct: 0,
    EntireArray: 1,
    ArrayElement: 2,
    HasFromToArray: 3
  },
  Versioning: {
    None: 0,
    NeedsUpdate: 1,
    MatrixWorldNeedsUpdate: 2
  },
  GetterByBindingType: [
    function(t, r) {
      t[r] = this.node[this.propertyName];
    },
    function(t, r) {
      for (var n = this.resolvedProperty, i = 0, a = n.length; i !== a; ++i)
        t[r++] = n[i];
    },
    function(t, r) {
      t[r] = this.resolvedProperty[this.propertyIndex];
    },
    function(t, r) {
      this.resolvedProperty.toArray(t, r);
    }
  ],
  SetterByBindingTypeAndVersioning: [
    [
      // Direct
      function(t, r) {
        this.targetObject[this.propertyName] = t[r];
      },
      function(t, r) {
        this.targetObject[this.propertyName] = t[r], this.targetObject.needsUpdate = !0;
      },
      function(t, r) {
        this.targetObject[this.propertyName] = t[r], this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    ],
    [
      // EntireArray
      function(t, r) {
        for (var n = this.resolvedProperty, i = 0, a = n.length; i !== a; ++i)
          n[i] = t[r++];
      },
      function(t, r) {
        for (var n = this.resolvedProperty, i = 0, a = n.length; i !== a; ++i)
          n[i] = t[r++];
        this.targetObject.needsUpdate = !0;
      },
      function(t, r) {
        for (var n = this.resolvedProperty, i = 0, a = n.length; i !== a; ++i)
          n[i] = t[r++];
        this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    ],
    [
      // ArrayElement
      function(t, r) {
        this.resolvedProperty[this.propertyIndex] = t[r];
      },
      function(t, r) {
        this.resolvedProperty[this.propertyIndex] = t[r], this.targetObject.needsUpdate = !0;
      },
      function(t, r) {
        this.resolvedProperty[this.propertyIndex] = t[r], this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    ],
    [
      // HasToFromArray
      function(t, r) {
        this.resolvedProperty.fromArray(t, r);
      },
      function(t, r) {
        this.resolvedProperty.fromArray(t, r), this.targetObject.needsUpdate = !0;
      },
      function(t, r) {
        this.resolvedProperty.fromArray(t, r), this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    ]
  ],
  getValue: function(t, r) {
    this.bind(), this.getValue(t, r);
  },
  setValue: function(t, r) {
    this.bind(), this.setValue(t, r);
  },
  // create getter / setter pair for a property in the scene graph
  bind: function() {
    var e = this.node, t = this.parsedPath, r = t.objectName, n = t.propertyName, i = t.propertyIndex;
    if (e || (e = mn.findNode(this.rootNode, t.nodeName) || this.rootNode, this.node = e), this.getValue = this._getValue_unavailable, this.setValue = this._setValue_unavailable, !e) {
      console.error("THREE.PropertyBinding: Trying to update node for track: " + this.path + " but it wasn't found.");
      return;
    }
    if (r) {
      var a = t.objectIndex;
      switch (r) {
        case "materials":
          if (!e.material) {
            console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.", this);
            return;
          }
          if (!e.material.materials) {
            console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.", this);
            return;
          }
          e = e.material.materials;
          break;
        case "bones":
          if (!e.skeleton) {
            console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.", this);
            return;
          }
          e = e.skeleton.bones;
          for (var s = 0; s < e.length; s++)
            if (e[s].name === a) {
              a = s;
              break;
            }
          break;
        default:
          if (e[r] === void 0) {
            console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.", this);
            return;
          }
          e = e[r];
      }
      if (a !== void 0) {
        if (e[a] === void 0) {
          console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.", this, e);
          return;
        }
        e = e[a];
      }
    }
    var o = e[n];
    if (o === void 0) {
      var u = t.nodeName;
      console.error("THREE.PropertyBinding: Trying to update property for track: " + u + "." + n + " but it wasn't found.", e);
      return;
    }
    var l = this.Versioning.None;
    this.targetObject = e, e.needsUpdate !== void 0 ? l = this.Versioning.NeedsUpdate : e.matrixWorldNeedsUpdate !== void 0 && (l = this.Versioning.MatrixWorldNeedsUpdate);
    var c = this.BindingType.Direct;
    if (i !== void 0) {
      if (n === "morphTargetInfluences") {
        if (!e.geometry) {
          console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.", this);
          return;
        }
        if (e.geometry.isBufferGeometry) {
          if (!e.geometry.morphAttributes) {
            console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.", this);
            return;
          }
          for (var s = 0; s < this.node.geometry.morphAttributes.position.length; s++)
            if (e.geometry.morphAttributes.position[s].name === i) {
              i = s;
              break;
            }
        } else {
          if (!e.geometry.morphTargets) {
            console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.", this);
            return;
          }
          for (var s = 0; s < this.node.geometry.morphTargets.length; s++)
            if (e.geometry.morphTargets[s].name === i) {
              i = s;
              break;
            }
        }
      }
      c = this.BindingType.ArrayElement, this.resolvedProperty = o, this.propertyIndex = i;
    } else o.fromArray !== void 0 && o.toArray !== void 0 ? (c = this.BindingType.HasFromToArray, this.resolvedProperty = o) : Array.isArray(o) ? (c = this.BindingType.EntireArray, this.resolvedProperty = o) : this.propertyName = n;
    this.getValue = this.GetterByBindingType[c], this.setValue = this.SetterByBindingTypeAndVersioning[c][l];
  },
  unbind: function() {
    this.node = null, this.getValue = this._getValue_unbound, this.setValue = this._setValue_unbound;
  }
});
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(mn.prototype, {
  // initial state of these methods that calls 'bind'
  _getValue_unbound: mn.prototype.getValue,
  _setValue_unbound: mn.prototype.setValue
});
function Fk() {
  this.uuid = It.generateUUID(), this._objects = Array.prototype.slice.call(arguments), this.nCachedObjects_ = 0;
  var e = {};
  this._indicesByUUID = e;
  for (var t = 0, r = arguments.length; t !== r; ++t)
    e[arguments[t].uuid] = t;
  this._paths = [], this._parsedPaths = [], this._bindings = [], this._bindingsIndicesByPath = {};
  var n = this;
  this.stats = {
    objects: {
      get total() {
        return n._objects.length;
      },
      get inUse() {
        return this.total - n.nCachedObjects_;
      }
    },
    get bindingsPerObject() {
      return n._bindings.length;
    }
  };
}
Object.assign(Fk.prototype, {
  isAnimationObjectGroup: !0,
  add: function() {
    for (var e = this._objects, t = e.length, r = this.nCachedObjects_, n = this._indicesByUUID, i = this._paths, a = this._parsedPaths, s = this._bindings, o = s.length, u = void 0, l = 0, c = arguments.length; l !== c; ++l) {
      var f = arguments[l], h = f.uuid, d = n[h];
      if (d === void 0) {
        d = t++, n[h] = d, e.push(f);
        for (var g = 0, v = o; g !== v; ++g)
          s[g].push(new mn(f, i[g], a[g]));
      } else if (d < r) {
        u = e[d];
        var m = --r, p = e[m];
        n[p.uuid] = d, e[d] = p, n[h] = m, e[m] = f;
        for (var g = 0, v = o; g !== v; ++g) {
          var y = s[g], w = y[m], x = y[d];
          y[d] = w, x === void 0 && (x = new mn(f, i[g], a[g])), y[m] = x;
        }
      } else e[d] !== u && console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.");
    }
    this.nCachedObjects_ = r;
  },
  remove: function() {
    for (var e = this._objects, t = this.nCachedObjects_, r = this._indicesByUUID, n = this._bindings, i = n.length, a = 0, s = arguments.length; a !== s; ++a) {
      var o = arguments[a], u = o.uuid, l = r[u];
      if (l !== void 0 && l >= t) {
        var c = t++, f = e[c];
        r[f.uuid] = l, e[l] = f, r[u] = c, e[c] = o;
        for (var h = 0, d = i; h !== d; ++h) {
          var g = n[h], v = g[c], m = g[l];
          g[l] = v, g[c] = m;
        }
      }
    }
    this.nCachedObjects_ = t;
  },
  // remove & forget
  uncache: function() {
    for (var e = this._objects, t = e.length, r = this.nCachedObjects_, n = this._indicesByUUID, i = this._bindings, a = i.length, s = 0, o = arguments.length; s !== o; ++s) {
      var u = arguments[s], l = u.uuid, c = n[l];
      if (c !== void 0)
        if (delete n[l], c < r) {
          var f = --r, h = e[f], d = --t, g = e[d];
          n[h.uuid] = c, e[c] = h, n[g.uuid] = f, e[f] = g, e.pop();
          for (var v = 0, m = a; v !== m; ++v) {
            var p = i[v], y = p[f], w = p[d];
            p[c] = y, p[f] = w, p.pop();
          }
        } else {
          var d = --t, g = e[d];
          n[g.uuid] = c, e[c] = g, e.pop();
          for (var v = 0, m = a; v !== m; ++v) {
            var p = i[v];
            p[c] = p[d], p.pop();
          }
        }
    }
    this.nCachedObjects_ = r;
  },
  // Internal interface used by befriended PropertyBinding.Composite:
  subscribe_: function(e, t) {
    var r = this._bindingsIndicesByPath, n = r[e], i = this._bindings;
    if (n !== void 0) return i[n];
    var a = this._paths, s = this._parsedPaths, o = this._objects, u = o.length, l = this.nCachedObjects_, c = new Array(u);
    n = i.length, r[e] = n, a.push(e), s.push(t), i.push(c);
    for (var f = l, h = o.length; f !== h; ++f) {
      var d = o[f];
      c[f] = new mn(d, e, t);
    }
    return c;
  },
  unsubscribe_: function(e) {
    var t = this._bindingsIndicesByPath, r = t[e];
    if (r !== void 0) {
      var n = this._paths, i = this._parsedPaths, a = this._bindings, s = a.length - 1, o = a[s], u = e[s];
      t[u] = r, a[r] = o, a.pop(), i[r] = i[s], i.pop(), n[r] = n[s], n.pop();
    }
  }
});
function Zb(e, t, r) {
  this._mixer = e, this._clip = t, this._localRoot = r || null;
  for (var n = t.tracks, i = n.length, a = new Array(i), s = {
    endingStart: So,
    endingEnd: So
  }, o = 0; o !== i; ++o) {
    var u = n[o].createInterpolant(null);
    a[o] = u, u.settings = s;
  }
  this._interpolantSettings = s, this._interpolants = a, this._propertyBindings = new Array(i), this._cacheIndex = null, this._byClipCacheIndex = null, this._timeScaleInterpolant = null, this._weightInterpolant = null, this.loop = DA, this._loopCount = -1, this._startTime = null, this.time = 0, this.timeScale = 1, this._effectiveTimeScale = 1, this.weight = 1, this._effectiveWeight = 1, this.repetitions = 1 / 0, this.paused = !1, this.enabled = !0, this.clampWhenFinished = !1, this.zeroSlopeAtStart = !0, this.zeroSlopeAtEnd = !0;
}
Object.assign(Zb.prototype, {
  // State & Scheduling
  play: function() {
    return this._mixer._activateAction(this), this;
  },
  stop: function() {
    return this._mixer._deactivateAction(this), this.reset();
  },
  reset: function() {
    return this.paused = !1, this.enabled = !0, this.time = 0, this._loopCount = -1, this._startTime = null, this.stopFading().stopWarping();
  },
  isRunning: function() {
    return this.enabled && !this.paused && this.timeScale !== 0 && this._startTime === null && this._mixer._isActiveAction(this);
  },
  // return true when play has been called
  isScheduled: function() {
    return this._mixer._isActiveAction(this);
  },
  startAt: function(e) {
    return this._startTime = e, this;
  },
  setLoop: function(e, t) {
    return this.loop = e, this.repetitions = t, this;
  },
  // Weight
  // set the weight stopping any scheduled fading
  // although .enabled = false yields an effective weight of zero, this
  // method does *not* change .enabled, because it would be confusing
  setEffectiveWeight: function(e) {
    return this.weight = e, this._effectiveWeight = this.enabled ? e : 0, this.stopFading();
  },
  // return the weight considering fading and .enabled
  getEffectiveWeight: function() {
    return this._effectiveWeight;
  },
  fadeIn: function(e) {
    return this._scheduleFading(e, 0, 1);
  },
  fadeOut: function(e) {
    return this._scheduleFading(e, 1, 0);
  },
  crossFadeFrom: function(e, t, r) {
    if (e.fadeOut(t), this.fadeIn(t), r) {
      var n = this._clip.duration, i = e._clip.duration, a = i / n, s = n / i;
      e.warp(1, a, t), this.warp(s, 1, t);
    }
    return this;
  },
  crossFadeTo: function(e, t, r) {
    return e.crossFadeFrom(this, t, r);
  },
  stopFading: function() {
    var e = this._weightInterpolant;
    return e !== null && (this._weightInterpolant = null, this._mixer._takeBackControlInterpolant(e)), this;
  },
  // Time Scale Control
  // set the time scale stopping any scheduled warping
  // although .paused = true yields an effective time scale of zero, this
  // method does *not* change .paused, because it would be confusing
  setEffectiveTimeScale: function(e) {
    return this.timeScale = e, this._effectiveTimeScale = this.paused ? 0 : e, this.stopWarping();
  },
  // return the time scale considering warping and .paused
  getEffectiveTimeScale: function() {
    return this._effectiveTimeScale;
  },
  setDuration: function(e) {
    return this.timeScale = this._clip.duration / e, this.stopWarping();
  },
  syncWith: function(e) {
    return this.time = e.time, this.timeScale = e.timeScale, this.stopWarping();
  },
  halt: function(e) {
    return this.warp(this._effectiveTimeScale, 0, e);
  },
  warp: function(e, t, r) {
    var n = this._mixer, i = n.time, a = this._timeScaleInterpolant, s = this.timeScale;
    a === null && (a = n._lendControlInterpolant(), this._timeScaleInterpolant = a);
    var o = a.parameterPositions, u = a.sampleValues;
    return o[0] = i, o[1] = i + r, u[0] = e / s, u[1] = t / s, this;
  },
  stopWarping: function() {
    var e = this._timeScaleInterpolant;
    return e !== null && (this._timeScaleInterpolant = null, this._mixer._takeBackControlInterpolant(e)), this;
  },
  // Object Accessors
  getMixer: function() {
    return this._mixer;
  },
  getClip: function() {
    return this._clip;
  },
  getRoot: function() {
    return this._localRoot || this._mixer._root;
  },
  // Interna
  _update: function(e, t, r, n) {
    if (!this.enabled) {
      this._updateWeight(e);
      return;
    }
    var i = this._startTime;
    if (i !== null) {
      var a = (e - i) * r;
      if (a < 0 || r === 0)
        return;
      this._startTime = null, t = r * a;
    }
    t *= this._updateTimeScale(e);
    var s = this._updateTime(t), o = this._updateWeight(e);
    if (o > 0)
      for (var u = this._interpolants, l = this._propertyBindings, c = 0, f = u.length; c !== f; ++c)
        u[c].evaluate(s), l[c].accumulate(n, o);
  },
  _updateWeight: function(e) {
    var t = 0;
    if (this.enabled) {
      t = this.weight;
      var r = this._weightInterpolant;
      if (r !== null) {
        var n = r.evaluate(e)[0];
        t *= n, e > r.parameterPositions[1] && (this.stopFading(), n === 0 && (this.enabled = !1));
      }
    }
    return this._effectiveWeight = t, t;
  },
  _updateTimeScale: function(e) {
    var t = 0;
    if (!this.paused) {
      t = this.timeScale;
      var r = this._timeScaleInterpolant;
      if (r !== null) {
        var n = r.evaluate(e)[0];
        t *= n, e > r.parameterPositions[1] && (this.stopWarping(), t === 0 ? this.paused = !0 : this.timeScale = t);
      }
    }
    return this._effectiveTimeScale = t, t;
  },
  _updateTime: function(e) {
    var t = this.time + e, r = this._clip.duration, n = this.loop, i = this._loopCount, a = n === _A;
    if (e === 0)
      return i === -1 ? t : a && (i & 1) === 1 ? r - t : t;
    if (n === CA) {
      i === -1 && (this._loopCount = 0, this._setEndings(!0, !0, !1));
      e: {
        if (t >= r)
          t = r;
        else if (t < 0)
          t = 0;
        else {
          this.time = t;
          break e;
        }
        this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, this.time = t, this._mixer.dispatchEvent({
          type: "finished",
          action: this,
          direction: e < 0 ? -1 : 1
        });
      }
    } else {
      if (i === -1 && (e >= 0 ? (i = 0, this._setEndings(!0, this.repetitions === 0, a)) : this._setEndings(this.repetitions === 0, !0, a)), t >= r || t < 0) {
        var s = Math.floor(t / r);
        t -= r * s, i += Math.abs(s);
        var o = this.repetitions - i;
        if (o <= 0)
          this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, t = e > 0 ? r : 0, this.time = t, this._mixer.dispatchEvent({
            type: "finished",
            action: this,
            direction: e > 0 ? 1 : -1
          });
        else {
          if (o === 1) {
            var u = e < 0;
            this._setEndings(u, !u, a);
          } else
            this._setEndings(!1, !1, a);
          this._loopCount = i, this.time = t, this._mixer.dispatchEvent({
            type: "loop",
            action: this,
            loopDelta: s
          });
        }
      } else
        this.time = t;
      if (a && (i & 1) === 1)
        return r - t;
    }
    return t;
  },
  _setEndings: function(e, t, r) {
    var n = this._interpolantSettings;
    r ? (n.endingStart = uo, n.endingEnd = uo) : (e ? n.endingStart = this.zeroSlopeAtStart ? uo : So : n.endingStart = uf, t ? n.endingEnd = this.zeroSlopeAtEnd ? uo : So : n.endingEnd = uf);
  },
  _scheduleFading: function(e, t, r) {
    var n = this._mixer, i = n.time, a = this._weightInterpolant;
    a === null && (a = n._lendControlInterpolant(), this._weightInterpolant = a);
    var s = a.parameterPositions, o = a.sampleValues;
    return s[0] = i, o[0] = t, s[1] = i + e, o[1] = r, this;
  }
});
function vy(e) {
  this._root = e, this._initMemoryManager(), this._accuIndex = 0, this.time = 0, this.timeScale = 1;
}
vy.prototype = Object.assign(Object.create(ha.prototype), {
  constructor: vy,
  _bindAction: function(e, t) {
    var r = e._localRoot || this._root, n = e._clip.tracks, i = n.length, a = e._propertyBindings, s = e._interpolants, o = r.uuid, u = this._bindingsByRootAndName, l = u[o];
    l === void 0 && (l = {}, u[o] = l);
    for (var c = 0; c !== i; ++c) {
      var f = n[c], h = f.name, d = l[h];
      if (d !== void 0)
        a[c] = d;
      else {
        if (d = a[c], d !== void 0) {
          d._cacheIndex === null && (++d.referenceCount, this._addInactiveBinding(d, o, h));
          continue;
        }
        var g = t && t._propertyBindings[c].binding.parsedPath;
        d = new Yb(
          mn.create(r, h, g),
          f.ValueTypeName,
          f.getValueSize()
        ), ++d.referenceCount, this._addInactiveBinding(d, o, h), a[c] = d;
      }
      s[c].resultBuffer = d.buffer;
    }
  },
  _activateAction: function(e) {
    if (!this._isActiveAction(e)) {
      if (e._cacheIndex === null) {
        var t = (e._localRoot || this._root).uuid, r = e._clip.uuid, n = this._actionsByClip[r];
        this._bindAction(
          e,
          n && n.knownActions[0]
        ), this._addInactiveAction(e, r, t);
      }
      for (var i = e._propertyBindings, a = 0, s = i.length; a !== s; ++a) {
        var o = i[a];
        o.useCount++ === 0 && (this._lendBinding(o), o.saveOriginalState());
      }
      this._lendAction(e);
    }
  },
  _deactivateAction: function(e) {
    if (this._isActiveAction(e)) {
      for (var t = e._propertyBindings, r = 0, n = t.length; r !== n; ++r) {
        var i = t[r];
        --i.useCount === 0 && (i.restoreOriginalState(), this._takeBackBinding(i));
      }
      this._takeBackAction(e);
    }
  },
  // Memory manager
  _initMemoryManager: function() {
    this._actions = [], this._nActiveActions = 0, this._actionsByClip = {}, this._bindings = [], this._nActiveBindings = 0, this._bindingsByRootAndName = {}, this._controlInterpolants = [], this._nActiveControlInterpolants = 0;
    var e = this;
    this.stats = {
      actions: {
        get total() {
          return e._actions.length;
        },
        get inUse() {
          return e._nActiveActions;
        }
      },
      bindings: {
        get total() {
          return e._bindings.length;
        },
        get inUse() {
          return e._nActiveBindings;
        }
      },
      controlInterpolants: {
        get total() {
          return e._controlInterpolants.length;
        },
        get inUse() {
          return e._nActiveControlInterpolants;
        }
      }
    };
  },
  // Memory management for AnimationAction objects
  _isActiveAction: function(e) {
    var t = e._cacheIndex;
    return t !== null && t < this._nActiveActions;
  },
  _addInactiveAction: function(e, t, r) {
    var n = this._actions, i = this._actionsByClip, a = i[t];
    if (a === void 0)
      a = {
        knownActions: [e],
        actionByRoot: {}
      }, e._byClipCacheIndex = 0, i[t] = a;
    else {
      var s = a.knownActions;
      e._byClipCacheIndex = s.length, s.push(e);
    }
    e._cacheIndex = n.length, n.push(e), a.actionByRoot[r] = e;
  },
  _removeInactiveAction: function(e) {
    var t = this._actions, r = t[t.length - 1], n = e._cacheIndex;
    r._cacheIndex = n, t[n] = r, t.pop(), e._cacheIndex = null;
    var i = e._clip.uuid, a = this._actionsByClip, s = a[i], o = s.knownActions, u = o[o.length - 1], l = e._byClipCacheIndex;
    u._byClipCacheIndex = l, o[l] = u, o.pop(), e._byClipCacheIndex = null;
    var c = s.actionByRoot, f = (e._localRoot || this._root).uuid;
    delete c[f], o.length === 0 && delete a[i], this._removeInactiveBindingsForAction(e);
  },
  _removeInactiveBindingsForAction: function(e) {
    for (var t = e._propertyBindings, r = 0, n = t.length; r !== n; ++r) {
      var i = t[r];
      --i.referenceCount === 0 && this._removeInactiveBinding(i);
    }
  },
  _lendAction: function(e) {
    var t = this._actions, r = e._cacheIndex, n = this._nActiveActions++, i = t[n];
    e._cacheIndex = n, t[n] = e, i._cacheIndex = r, t[r] = i;
  },
  _takeBackAction: function(e) {
    var t = this._actions, r = e._cacheIndex, n = --this._nActiveActions, i = t[n];
    e._cacheIndex = n, t[n] = e, i._cacheIndex = r, t[r] = i;
  },
  // Memory management for PropertyMixer objects
  _addInactiveBinding: function(e, t, r) {
    var n = this._bindingsByRootAndName, i = n[t], a = this._bindings;
    i === void 0 && (i = {}, n[t] = i), i[r] = e, e._cacheIndex = a.length, a.push(e);
  },
  _removeInactiveBinding: function(e) {
    var t = this._bindings, r = e.binding, n = r.rootNode.uuid, i = r.path, a = this._bindingsByRootAndName, s = a[n], o = t[t.length - 1], u = e._cacheIndex;
    o._cacheIndex = u, t[u] = o, t.pop(), delete s[i], Object.keys(s).length === 0 && delete a[n];
  },
  _lendBinding: function(e) {
    var t = this._bindings, r = e._cacheIndex, n = this._nActiveBindings++, i = t[n];
    e._cacheIndex = n, t[n] = e, i._cacheIndex = r, t[r] = i;
  },
  _takeBackBinding: function(e) {
    var t = this._bindings, r = e._cacheIndex, n = --this._nActiveBindings, i = t[n];
    e._cacheIndex = n, t[n] = e, i._cacheIndex = r, t[r] = i;
  },
  // Memory management of Interpolants for weight and time scale
  _lendControlInterpolant: function() {
    var e = this._controlInterpolants, t = this._nActiveControlInterpolants++, r = e[t];
    return r === void 0 && (r = new Ff(
      new Float32Array(2),
      new Float32Array(2),
      1,
      this._controlInterpolantsResultBuffer
    ), r.__cacheIndex = t, e[t] = r), r;
  },
  _takeBackControlInterpolant: function(e) {
    var t = this._controlInterpolants, r = e.__cacheIndex, n = --this._nActiveControlInterpolants, i = t[n];
    e.__cacheIndex = n, t[n] = e, i.__cacheIndex = r, t[r] = i;
  },
  _controlInterpolantsResultBuffer: new Float32Array(1),
  // return an action for a clip optionally using a custom root target
  // object (this method allocates a lot of dynamic memory in case a
  // previously unknown clip/root combination is specified)
  clipAction: function(e, t) {
    var r = t || this._root, n = r.uuid, i = typeof e == "string" ? oi.findByName(r, e) : e, a = i !== null ? i.uuid : e, s = this._actionsByClip[a], o = null;
    if (s !== void 0) {
      var u = s.actionByRoot[n];
      if (u !== void 0)
        return u;
      o = s.knownActions[0], i === null && (i = o._clip);
    }
    if (i === null) return null;
    var l = new Zb(this, i, t);
    return this._bindAction(l, o), this._addInactiveAction(l, a, n), l;
  },
  // get an existing action
  existingAction: function(e, t) {
    var r = t || this._root, n = r.uuid, i = typeof e == "string" ? oi.findByName(r, e) : e, a = i ? i.uuid : e, s = this._actionsByClip[a];
    return s !== void 0 && s.actionByRoot[n] || null;
  },
  // deactivates all previously scheduled actions
  stopAllAction: function() {
    var e = this._actions, t = this._nActiveActions, r = this._bindings, n = this._nActiveBindings;
    this._nActiveActions = 0, this._nActiveBindings = 0;
    for (var i = 0; i !== t; ++i)
      e[i].reset();
    for (var i = 0; i !== n; ++i)
      r[i].useCount = 0;
    return this;
  },
  // advance the time and update apply the animation
  update: function(e) {
    e *= this.timeScale;
    for (var t = this._actions, r = this._nActiveActions, n = this.time += e, i = Math.sign(e), a = this._accuIndex ^= 1, s = 0; s !== r; ++s) {
      var o = t[s];
      o._update(n, e, i, a);
    }
    for (var u = this._bindings, l = this._nActiveBindings, s = 0; s !== l; ++s)
      u[s].apply(a);
    return this;
  },
  // Allows you to seek to a specific time in an animation.
  setTime: function(e) {
    this.time = 0;
    for (var t = 0; t < this._actions.length; t++)
      this._actions[t].time = 0;
    return this.update(e);
  },
  // return this mixer's root target object
  getRoot: function() {
    return this._root;
  },
  // free all resources specific to a particular clip
  uncacheClip: function(e) {
    var t = this._actions, r = e.uuid, n = this._actionsByClip, i = n[r];
    if (i !== void 0) {
      for (var a = i.knownActions, s = 0, o = a.length; s !== o; ++s) {
        var u = a[s];
        this._deactivateAction(u);
        var l = u._cacheIndex, c = t[t.length - 1];
        u._cacheIndex = null, u._byClipCacheIndex = null, c._cacheIndex = l, t[l] = c, t.pop(), this._removeInactiveBindingsForAction(u);
      }
      delete n[r];
    }
  },
  // free all resources specific to a particular root target object
  uncacheRoot: function(e) {
    var t = e.uuid, r = this._actionsByClip;
    for (var n in r) {
      var i = r[n].actionByRoot, a = i[t];
      a !== void 0 && (this._deactivateAction(a), this._removeInactiveAction(a));
    }
    var s = this._bindingsByRootAndName, o = s[t];
    if (o !== void 0)
      for (var u in o) {
        var l = o[u];
        l.restoreOriginalState(), this._removeInactiveBinding(l);
      }
  },
  // remove a targeted clip from the cache
  uncacheAction: function(e, t) {
    var r = this.existingAction(e, t);
    r !== null && (this._deactivateAction(r), this._removeInactiveAction(r));
  }
});
function cv(e) {
  typeof e == "string" && (console.warn("THREE.Uniform: Type parameter is no longer needed."), e = arguments[1]), this.value = e;
}
cv.prototype.clone = function() {
  return new cv(this.value.clone === void 0 ? this.value : this.value.clone());
};
function my(e, t, r) {
  Na.call(this, e, t), this.meshPerAttribute = r || 1;
}
my.prototype = Object.assign(Object.create(Na.prototype), {
  constructor: my,
  isInstancedInterleavedBuffer: !0,
  copy: function(e) {
    return Na.prototype.copy.call(this, e), this.meshPerAttribute = e.meshPerAttribute, this;
  }
});
function Ik(e, t, r, n) {
  this.ray = new Yo(e, t), this.near = r || 0, this.far = n || 1 / 0, this.camera = null, this.params = {
    Mesh: {},
    Line: {},
    LOD: {},
    Points: { threshold: 1 },
    Sprite: {}
  }, Object.defineProperties(this.params, {
    PointCloud: {
      get: function() {
        return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."), this.Points;
      }
    }
  });
}
function gy(e, t) {
  return e.distance - t.distance;
}
function fv(e, t, r, n) {
  if (e.visible !== !1 && (e.raycast(t, r), n === !0))
    for (var i = e.children, a = 0, s = i.length; a < s; a++)
      fv(i[a], t, r, !0);
}
Object.assign(Ik.prototype, {
  linePrecision: 1,
  set: function(e, t) {
    this.ray.set(e, t);
  },
  setFromCamera: function(e, t) {
    t && t.isPerspectiveCamera ? (this.ray.origin.setFromMatrixPosition(t.matrixWorld), this.ray.direction.set(e.x, e.y, 0.5).unproject(t).sub(this.ray.origin).normalize(), this.camera = t) : t && t.isOrthographicCamera ? (this.ray.origin.set(e.x, e.y, (t.near + t.far) / (t.near - t.far)).unproject(t), this.ray.direction.set(0, 0, -1).transformDirection(t.matrixWorld), this.camera = t) : console.error("THREE.Raycaster: Unsupported camera type.");
  },
  intersectObject: function(e, t, r) {
    var n = r || [];
    return fv(e, this, n, t), n.sort(gy), n;
  },
  intersectObjects: function(e, t, r) {
    var n = r || [];
    if (Array.isArray(e) === !1)
      return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."), n;
    for (var i = 0, a = e.length; i < a; i++)
      fv(e[i], this, n, t);
    return n.sort(gy), n;
  }
});
function Rk(e, t, r) {
  return this.radius = e !== void 0 ? e : 1, this.phi = t !== void 0 ? t : 0, this.theta = r !== void 0 ? r : 0, this;
}
Object.assign(Rk.prototype, {
  set: function(e, t, r) {
    return this.radius = e, this.phi = t, this.theta = r, this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.radius = e.radius, this.phi = e.phi, this.theta = e.theta, this;
  },
  // restrict phi to be betwee EPS and PI-EPS
  makeSafe: function() {
    var e = 1e-6;
    return this.phi = Math.max(e, Math.min(Math.PI - e, this.phi)), this;
  },
  setFromVector3: function(e) {
    return this.setFromCartesianCoords(e.x, e.y, e.z);
  },
  setFromCartesianCoords: function(e, t, r) {
    return this.radius = Math.sqrt(e * e + t * t + r * r), this.radius === 0 ? (this.theta = 0, this.phi = 0) : (this.theta = Math.atan2(e, r), this.phi = Math.acos(It.clamp(t / this.radius, -1, 1))), this;
  }
});
function Ok(e, t, r) {
  return this.radius = e !== void 0 ? e : 1, this.theta = t !== void 0 ? t : 0, this.y = r !== void 0 ? r : 0, this;
}
Object.assign(Ok.prototype, {
  set: function(e, t, r) {
    return this.radius = e, this.theta = t, this.y = r, this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.radius = e.radius, this.theta = e.theta, this.y = e.y, this;
  },
  setFromVector3: function(e) {
    return this.setFromCartesianCoords(e.x, e.y, e.z);
  },
  setFromCartesianCoords: function(e, t, r) {
    return this.radius = Math.sqrt(e * e + r * r), this.theta = Math.atan2(e, r), this.y = t, this;
  }
});
var yy = new _e();
function Jb(e, t) {
  this.min = e !== void 0 ? e : new _e(1 / 0, 1 / 0), this.max = t !== void 0 ? t : new _e(-1 / 0, -1 / 0);
}
Object.assign(Jb.prototype, {
  set: function(e, t) {
    return this.min.copy(e), this.max.copy(t), this;
  },
  setFromPoints: function(e) {
    this.makeEmpty();
    for (var t = 0, r = e.length; t < r; t++)
      this.expandByPoint(e[t]);
    return this;
  },
  setFromCenterAndSize: function(e, t) {
    var r = yy.copy(t).multiplyScalar(0.5);
    return this.min.copy(e).sub(r), this.max.copy(e).add(r), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.min.copy(e.min), this.max.copy(e.max), this;
  },
  makeEmpty: function() {
    return this.min.x = this.min.y = 1 / 0, this.max.x = this.max.y = -1 / 0, this;
  },
  isEmpty: function() {
    return this.max.x < this.min.x || this.max.y < this.min.y;
  },
  getCenter: function(e) {
    return e === void 0 && (console.warn("THREE.Box2: .getCenter() target is now required"), e = new _e()), this.isEmpty() ? e.set(0, 0) : e.addVectors(this.min, this.max).multiplyScalar(0.5);
  },
  getSize: function(e) {
    return e === void 0 && (console.warn("THREE.Box2: .getSize() target is now required"), e = new _e()), this.isEmpty() ? e.set(0, 0) : e.subVectors(this.max, this.min);
  },
  expandByPoint: function(e) {
    return this.min.min(e), this.max.max(e), this;
  },
  expandByVector: function(e) {
    return this.min.sub(e), this.max.add(e), this;
  },
  expandByScalar: function(e) {
    return this.min.addScalar(-e), this.max.addScalar(e), this;
  },
  containsPoint: function(e) {
    return !(e.x < this.min.x || e.x > this.max.x || e.y < this.min.y || e.y > this.max.y);
  },
  containsBox: function(e) {
    return this.min.x <= e.min.x && e.max.x <= this.max.x && this.min.y <= e.min.y && e.max.y <= this.max.y;
  },
  getParameter: function(e, t) {
    return t === void 0 && (console.warn("THREE.Box2: .getParameter() target is now required"), t = new _e()), t.set(
      (e.x - this.min.x) / (this.max.x - this.min.x),
      (e.y - this.min.y) / (this.max.y - this.min.y)
    );
  },
  intersectsBox: function(e) {
    return !(e.max.x < this.min.x || e.min.x > this.max.x || e.max.y < this.min.y || e.min.y > this.max.y);
  },
  clampPoint: function(e, t) {
    return t === void 0 && (console.warn("THREE.Box2: .clampPoint() target is now required"), t = new _e()), t.copy(e).clamp(this.min, this.max);
  },
  distanceToPoint: function(e) {
    var t = yy.copy(e).clamp(this.min, this.max);
    return t.sub(e).length();
  },
  intersect: function(e) {
    return this.min.max(e.min), this.max.min(e.max), this;
  },
  union: function(e) {
    return this.min.min(e.min), this.max.max(e.max), this;
  },
  translate: function(e) {
    return this.min.add(e), this.max.add(e), this;
  },
  equals: function(e) {
    return e.min.equals(this.min) && e.max.equals(this.max);
  }
});
var by = new re(), lc = new re();
function Qb(e, t) {
  this.start = e !== void 0 ? e : new re(), this.end = t !== void 0 ? t : new re();
}
Object.assign(Qb.prototype, {
  set: function(e, t) {
    return this.start.copy(e), this.end.copy(t), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  },
  copy: function(e) {
    return this.start.copy(e.start), this.end.copy(e.end), this;
  },
  getCenter: function(e) {
    return e === void 0 && (console.warn("THREE.Line3: .getCenter() target is now required"), e = new re()), e.addVectors(this.start, this.end).multiplyScalar(0.5);
  },
  delta: function(e) {
    return e === void 0 && (console.warn("THREE.Line3: .delta() target is now required"), e = new re()), e.subVectors(this.end, this.start);
  },
  distanceSq: function() {
    return this.start.distanceToSquared(this.end);
  },
  distance: function() {
    return this.start.distanceTo(this.end);
  },
  at: function(e, t) {
    return t === void 0 && (console.warn("THREE.Line3: .at() target is now required"), t = new re()), this.delta(t).multiplyScalar(e).add(this.start);
  },
  closestPointToPointParameter: function(e, t) {
    by.subVectors(e, this.start), lc.subVectors(this.end, this.start);
    var r = lc.dot(lc), n = lc.dot(by), i = n / r;
    return t && (i = It.clamp(i, 0, 1)), i;
  },
  closestPointToPoint: function(e, t, r) {
    var n = this.closestPointToPointParameter(e, t);
    return r === void 0 && (console.warn("THREE.Line3: .closestPointToPoint() target is now required"), r = new re()), this.delta(r).multiplyScalar(n).add(this.start);
  },
  applyMatrix4: function(e) {
    return this.start.applyMatrix4(e), this.end.applyMatrix4(e), this;
  },
  equals: function(e) {
    return e.start.equals(this.start) && e.end.equals(this.end);
  }
});
function Rf(e) {
  et.call(this), this.material = e, this.render = function() {
  };
}
Rf.prototype = Object.create(et.prototype);
Rf.prototype.constructor = Rf;
Rf.prototype.isImmediateRenderObject = !0;
var wy = new re();
function ol(e, t) {
  et.call(this), this.light = e, this.light.updateMatrixWorld(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.color = t;
  for (var r = new it(), n = [
    0,
    0,
    0,
    0,
    0,
    1,
    0,
    0,
    0,
    1,
    0,
    1,
    0,
    0,
    0,
    -1,
    0,
    1,
    0,
    0,
    0,
    0,
    1,
    1,
    0,
    0,
    0,
    0,
    -1,
    1
  ], i = 0, a = 1, s = 32; i < s; i++, a++) {
    var o = i / s * Math.PI * 2, u = a / s * Math.PI * 2;
    n.push(
      Math.cos(o),
      Math.sin(o),
      1,
      Math.cos(u),
      Math.sin(u),
      1
    );
  }
  r.setAttribute("position", new Qe(n, 3));
  var l = new Fr({ fog: !1 });
  this.cone = new Ur(r, l), this.add(this.cone), this.update();
}
ol.prototype = Object.create(et.prototype);
ol.prototype.constructor = ol;
ol.prototype.dispose = function() {
  this.cone.geometry.dispose(), this.cone.material.dispose();
};
ol.prototype.update = function() {
  this.light.updateMatrixWorld();
  var e = this.light.distance ? this.light.distance : 1e3, t = e * Math.tan(this.light.angle);
  this.cone.scale.set(t, t, e), wy.setFromMatrixPosition(this.light.target.matrixWorld), this.cone.lookAt(wy), this.color !== void 0 ? this.cone.material.color.set(this.color) : this.cone.material.color.copy(this.light.color);
};
var Ma = new re(), cc = new Nt(), pd = new Nt();
function ew(e) {
  var t = [];
  e && e.isBone && t.push(e);
  for (var r = 0; r < e.children.length; r++)
    t.push.apply(t, ew(e.children[r]));
  return t;
}
function ul(e) {
  for (var t = ew(e), r = new it(), n = [], i = [], a = new nt(0, 0, 1), s = new nt(0, 1, 0), o = 0; o < t.length; o++) {
    var u = t[o];
    u.parent && u.parent.isBone && (n.push(0, 0, 0), n.push(0, 0, 0), i.push(a.r, a.g, a.b), i.push(s.r, s.g, s.b));
  }
  r.setAttribute("position", new Qe(n, 3)), r.setAttribute("color", new Qe(i, 3));
  var l = new Fr({ vertexColors: bl, depthTest: !1, depthWrite: !1, transparent: !0 });
  Ur.call(this, r, l), this.root = e, this.bones = t, this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1;
}
ul.prototype = Object.create(Ur.prototype);
ul.prototype.constructor = ul;
ul.prototype.updateMatrixWorld = function(e) {
  var t = this.bones, r = this.geometry, n = r.getAttribute("position");
  pd.getInverse(this.root.matrixWorld);
  for (var i = 0, a = 0; i < t.length; i++) {
    var s = t[i];
    s.parent && s.parent.isBone && (cc.multiplyMatrices(pd, s.matrixWorld), Ma.setFromMatrixPosition(cc), n.setXYZ(a, Ma.x, Ma.y, Ma.z), cc.multiplyMatrices(pd, s.parent.matrixWorld), Ma.setFromMatrixPosition(cc), n.setXYZ(a + 1, Ma.x, Ma.y, Ma.z), a += 2);
  }
  r.getAttribute("position").needsUpdate = !0, et.prototype.updateMatrixWorld.call(this, e);
};
function ll(e, t, r) {
  this.light = e, this.light.updateMatrixWorld(), this.color = r;
  var n = new Fo(t, 4, 2), i = new fi({ wireframe: !0, fog: !1 });
  Tr.call(this, n, i), this.matrix = this.light.matrixWorld, this.matrixAutoUpdate = !1, this.update();
}
ll.prototype = Object.create(Tr.prototype);
ll.prototype.constructor = ll;
ll.prototype.dispose = function() {
  this.geometry.dispose(), this.material.dispose();
};
ll.prototype.update = function() {
  this.color !== void 0 ? this.material.color.set(this.color) : this.material.color.copy(this.light.color);
};
var Nk = new re(), xy = new nt(), My = new nt();
function cl(e, t, r) {
  et.call(this), this.light = e, this.light.updateMatrixWorld(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.color = r;
  var n = new Po(t);
  n.rotateY(Math.PI * 0.5), this.material = new fi({ wireframe: !0, fog: !1 }), this.color === void 0 && (this.material.vertexColors = bl);
  var i = n.getAttribute("position"), a = new Float32Array(i.count * 3);
  n.setAttribute("color", new Et(a, 3)), this.add(new Tr(n, this.material)), this.update();
}
cl.prototype = Object.create(et.prototype);
cl.prototype.constructor = cl;
cl.prototype.dispose = function() {
  this.children[0].geometry.dispose(), this.children[0].material.dispose();
};
cl.prototype.update = function() {
  var e = this.children[0];
  if (this.color !== void 0)
    this.material.color.set(this.color);
  else {
    var t = e.geometry.getAttribute("color");
    xy.copy(this.light.color), My.copy(this.light.groundColor);
    for (var r = 0, n = t.count; r < n; r++) {
      var i = r < n / 2 ? xy : My;
      t.setXYZ(r, i.r, i.g, i.b);
    }
    t.needsUpdate = !0;
  }
  e.lookAt(Nk.setFromMatrixPosition(this.light.matrixWorld).negate());
};
function hv(e, t, r, n) {
  e = e || 10, t = t || 10, r = new nt(r !== void 0 ? r : 4473924), n = new nt(n !== void 0 ? n : 8947848);
  for (var i = t / 2, a = e / t, s = e / 2, o = [], u = [], l = 0, c = 0, f = -s; l <= t; l++, f += a) {
    o.push(-s, 0, f, s, 0, f), o.push(f, 0, -s, f, 0, s);
    var h = l === i ? r : n;
    h.toArray(u, c), c += 3, h.toArray(u, c), c += 3, h.toArray(u, c), c += 3, h.toArray(u, c), c += 3;
  }
  var d = new it();
  d.setAttribute("position", new Qe(o, 3)), d.setAttribute("color", new Qe(u, 3));
  var g = new Fr({ vertexColors: bl });
  Ur.call(this, d, g);
}
hv.prototype = Object.assign(Object.create(Ur.prototype), {
  constructor: hv,
  copy: function(e) {
    return Ur.prototype.copy.call(this, e), this.geometry.copy(e.geometry), this.material.copy(e.material), this;
  },
  clone: function() {
    return new this.constructor().copy(this);
  }
});
function dv(e, t, r, n, i, a) {
  e = e || 10, t = t || 16, r = r || 8, n = n || 64, i = new nt(i !== void 0 ? i : 4473924), a = new nt(a !== void 0 ? a : 8947848);
  var s = [], o = [], u, l, c, f, h, d, g;
  for (f = 0; f <= t; f++)
    c = f / t * (Math.PI * 2), u = Math.sin(c) * e, l = Math.cos(c) * e, s.push(0, 0, 0), s.push(u, 0, l), g = f & 1 ? i : a, o.push(g.r, g.g, g.b), o.push(g.r, g.g, g.b);
  for (f = 0; f <= r; f++)
    for (g = f & 1 ? i : a, d = e - e / r * f, h = 0; h < n; h++)
      c = h / n * (Math.PI * 2), u = Math.sin(c) * d, l = Math.cos(c) * d, s.push(u, 0, l), o.push(g.r, g.g, g.b), c = (h + 1) / n * (Math.PI * 2), u = Math.sin(c) * d, l = Math.cos(c) * d, s.push(u, 0, l), o.push(g.r, g.g, g.b);
  var v = new it();
  v.setAttribute("position", new Qe(s, 3)), v.setAttribute("color", new Qe(o, 3));
  var m = new Fr({ vertexColors: bl });
  Ur.call(this, v, m);
}
dv.prototype = Object.create(Ur.prototype);
dv.prototype.constructor = dv;
var Ey = new re(), fc = new re(), Ay = new re();
function fl(e, t, r) {
  et.call(this), this.light = e, this.light.updateMatrixWorld(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.color = r, t === void 0 && (t = 1);
  var n = new it();
  n.setAttribute("position", new Qe([
    -t,
    t,
    0,
    t,
    t,
    0,
    t,
    -t,
    0,
    -t,
    -t,
    0,
    -t,
    t,
    0
  ], 3));
  var i = new Fr({ fog: !1 });
  this.lightPlane = new $n(n, i), this.add(this.lightPlane), n = new it(), n.setAttribute("position", new Qe([0, 0, 0, 0, 0, 1], 3)), this.targetLine = new $n(n, i), this.add(this.targetLine), this.update();
}
fl.prototype = Object.create(et.prototype);
fl.prototype.constructor = fl;
fl.prototype.dispose = function() {
  this.lightPlane.geometry.dispose(), this.lightPlane.material.dispose(), this.targetLine.geometry.dispose(), this.targetLine.material.dispose();
};
fl.prototype.update = function() {
  Ey.setFromMatrixPosition(this.light.matrixWorld), fc.setFromMatrixPosition(this.light.target.matrixWorld), Ay.subVectors(fc, Ey), this.lightPlane.lookAt(fc), this.color !== void 0 ? (this.lightPlane.material.color.set(this.color), this.targetLine.material.color.set(this.color)) : (this.lightPlane.material.color.copy(this.light.color), this.targetLine.material.color.copy(this.light.color)), this.targetLine.lookAt(fc), this.targetLine.scale.z = Ay.length();
};
var hc = new re(), Sr = new ra();
function Of(e) {
  var t = new it(), r = new Fr({ color: 16777215, vertexColors: TE }), n = [], i = [], a = {}, s = new nt(16755200), o = new nt(16711680), u = new nt(43775), l = new nt(16777215), c = new nt(3355443);
  f("n1", "n2", s), f("n2", "n4", s), f("n4", "n3", s), f("n3", "n1", s), f("f1", "f2", s), f("f2", "f4", s), f("f4", "f3", s), f("f3", "f1", s), f("n1", "f1", s), f("n2", "f2", s), f("n3", "f3", s), f("n4", "f4", s), f("p", "n1", o), f("p", "n2", o), f("p", "n3", o), f("p", "n4", o), f("u1", "u2", u), f("u2", "u3", u), f("u3", "u1", u), f("c", "t", l), f("p", "c", c), f("cn1", "cn2", c), f("cn3", "cn4", c), f("cf1", "cf2", c), f("cf3", "cf4", c);
  function f(d, g, v) {
    h(d, v), h(g, v);
  }
  function h(d, g) {
    n.push(0, 0, 0), i.push(g.r, g.g, g.b), a[d] === void 0 && (a[d] = []), a[d].push(n.length / 3 - 1);
  }
  t.setAttribute("position", new Qe(n, 3)), t.setAttribute("color", new Qe(i, 3)), Ur.call(this, t, r), this.camera = e, this.camera.updateProjectionMatrix && this.camera.updateProjectionMatrix(), this.matrix = e.matrixWorld, this.matrixAutoUpdate = !1, this.pointMap = a, this.update();
}
Of.prototype = Object.create(Ur.prototype);
Of.prototype.constructor = Of;
Of.prototype.update = function() {
  var e = this.geometry, t = this.pointMap, r = 1, n = 1;
  Sr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse), _r("c", t, e, Sr, 0, 0, -1), _r("t", t, e, Sr, 0, 0, 1), _r("n1", t, e, Sr, -r, -n, -1), _r("n2", t, e, Sr, r, -n, -1), _r("n3", t, e, Sr, -r, n, -1), _r("n4", t, e, Sr, r, n, -1), _r("f1", t, e, Sr, -r, -n, 1), _r("f2", t, e, Sr, r, -n, 1), _r("f3", t, e, Sr, -r, n, 1), _r("f4", t, e, Sr, r, n, 1), _r("u1", t, e, Sr, r * 0.7, n * 1.1, -1), _r("u2", t, e, Sr, -r * 0.7, n * 1.1, -1), _r("u3", t, e, Sr, 0, n * 2, -1), _r("cf1", t, e, Sr, -r, 0, 1), _r("cf2", t, e, Sr, r, 0, 1), _r("cf3", t, e, Sr, 0, -n, 1), _r("cf4", t, e, Sr, 0, n, 1), _r("cn1", t, e, Sr, -r, 0, -1), _r("cn2", t, e, Sr, r, 0, -1), _r("cn3", t, e, Sr, 0, -n, -1), _r("cn4", t, e, Sr, 0, n, -1), e.getAttribute("position").needsUpdate = !0;
};
function _r(e, t, r, n, i, a, s) {
  hc.set(i, a, s).unproject(n);
  var o = t[e];
  if (o !== void 0)
    for (var u = r.getAttribute("position"), l = 0, c = o.length; l < c; l++)
      u.setXYZ(o[l], hc.x, hc.y, hc.z);
}
var dc = new Ui();
function As(e, t) {
  this.object = e, t === void 0 && (t = 16776960);
  var r = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]), n = new Float32Array(8 * 3), i = new it();
  i.setIndex(new Et(r, 1)), i.setAttribute("position", new Et(n, 3)), Ur.call(this, i, new Fr({ color: t })), this.matrixAutoUpdate = !1, this.update();
}
As.prototype = Object.create(Ur.prototype);
As.prototype.constructor = As;
As.prototype.update = function(e) {
  if (e !== void 0 && console.warn("THREE.BoxHelper: .update() has no longer arguments."), this.object !== void 0 && dc.setFromObject(this.object), !dc.isEmpty()) {
    var t = dc.min, r = dc.max, n = this.geometry.attributes.position, i = n.array;
    i[0] = r.x, i[1] = r.y, i[2] = r.z, i[3] = t.x, i[4] = r.y, i[5] = r.z, i[6] = t.x, i[7] = t.y, i[8] = r.z, i[9] = r.x, i[10] = t.y, i[11] = r.z, i[12] = r.x, i[13] = r.y, i[14] = t.z, i[15] = t.x, i[16] = r.y, i[17] = t.z, i[18] = t.x, i[19] = t.y, i[20] = t.z, i[21] = r.x, i[22] = t.y, i[23] = t.z, n.needsUpdate = !0, this.geometry.computeBoundingSphere();
  }
};
As.prototype.setFromObject = function(e) {
  return this.object = e, this.update(), this;
};
As.prototype.copy = function(e) {
  return Ur.prototype.copy.call(this, e), this.object = e.object, this;
};
As.prototype.clone = function() {
  return new this.constructor().copy(this);
};
function Nf(e, t) {
  this.type = "Box3Helper", this.box = e, t = t || 16776960;
  var r = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]), n = [1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1], i = new it();
  i.setIndex(new Et(r, 1)), i.setAttribute("position", new Qe(n, 3)), Ur.call(this, i, new Fr({ color: t })), this.geometry.computeBoundingSphere();
}
Nf.prototype = Object.create(Ur.prototype);
Nf.prototype.constructor = Nf;
Nf.prototype.updateMatrixWorld = function(e) {
  var t = this.box;
  t.isEmpty() || (t.getCenter(this.position), t.getSize(this.scale), this.scale.multiplyScalar(0.5), et.prototype.updateMatrixWorld.call(this, e));
};
function Uf(e, t, r) {
  this.type = "PlaneHelper", this.plane = e, this.size = t === void 0 ? 1 : t;
  var n = r !== void 0 ? r : 16776960, i = [1, -1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0], a = new it();
  a.setAttribute("position", new Qe(i, 3)), a.computeBoundingSphere(), $n.call(this, a, new Fr({ color: n }));
  var s = [1, 1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, 1, -1, 1], o = new it();
  o.setAttribute("position", new Qe(s, 3)), o.computeBoundingSphere(), this.add(new Tr(o, new fi({ color: n, opacity: 0.2, transparent: !0, depthWrite: !1 })));
}
Uf.prototype = Object.create($n.prototype);
Uf.prototype.constructor = Uf;
Uf.prototype.updateMatrixWorld = function(e) {
  var t = -this.plane.constant;
  Math.abs(t) < 1e-8 && (t = 1e-8), this.scale.set(0.5 * this.size, 0.5 * this.size, t), this.children[0].material.side = t < 0 ? Hr : yl, this.lookAt(this.plane.normal), et.prototype.updateMatrixWorld.call(this, e);
};
var Ty = new re(), pc, vd;
function za(e, t, r, n, i, a) {
  et.call(this), e === void 0 && (e = new re(0, 0, 1)), t === void 0 && (t = new re(0, 0, 0)), r === void 0 && (r = 1), n === void 0 && (n = 16776960), i === void 0 && (i = 0.2 * r), a === void 0 && (a = 0.2 * i), pc === void 0 && (pc = new it(), pc.setAttribute("position", new Qe([0, 0, 0, 0, 1, 0], 3)), vd = new Ua(0, 0.5, 1, 5, 1), vd.translate(0, -0.5, 0)), this.position.copy(t), this.line = new $n(pc, new Fr({ color: n })), this.line.matrixAutoUpdate = !1, this.add(this.line), this.cone = new Tr(vd, new fi({ color: n })), this.cone.matrixAutoUpdate = !1, this.add(this.cone), this.setDirection(e), this.setLength(r, i, a);
}
za.prototype = Object.create(et.prototype);
za.prototype.constructor = za;
za.prototype.setDirection = function(e) {
  if (e.y > 0.99999)
    this.quaternion.set(0, 0, 0, 1);
  else if (e.y < -0.99999)
    this.quaternion.set(1, 0, 0, 0);
  else {
    Ty.set(e.z, 0, -e.x).normalize();
    var t = Math.acos(e.y);
    this.quaternion.setFromAxisAngle(Ty, t);
  }
};
za.prototype.setLength = function(e, t, r) {
  t === void 0 && (t = 0.2 * e), r === void 0 && (r = 0.2 * t), this.line.scale.set(1, Math.max(1e-4, e - t), 1), this.line.updateMatrix(), this.cone.scale.set(r, t, r), this.cone.position.y = e, this.cone.updateMatrix();
};
za.prototype.setColor = function(e) {
  this.line.material.color.set(e), this.cone.material.color.set(e);
};
za.prototype.copy = function(e) {
  return et.prototype.copy.call(this, e, !1), this.line.copy(e.line), this.cone.copy(e.cone), this;
};
za.prototype.clone = function() {
  return new this.constructor().copy(this);
};
function pv(e) {
  e = e || 1;
  var t = [
    0,
    0,
    0,
    e,
    0,
    0,
    0,
    0,
    0,
    0,
    e,
    0,
    0,
    0,
    0,
    0,
    0,
    e
  ], r = [
    1,
    0,
    0,
    1,
    0.6,
    0,
    0,
    1,
    0,
    0.6,
    1,
    0,
    0,
    0,
    1,
    0,
    0.6,
    1
  ], n = new it();
  n.setAttribute("position", new Qe(t, 3)), n.setAttribute("color", new Qe(r, 3));
  var i = new Fr({ vertexColors: bl });
  Ur.call(this, n, i);
}
pv.prototype = Object.create(Ur.prototype);
pv.prototype.constructor = pv;
var bo = 4, Fa = 8, Si = Math.pow(2, Fa), tw = [0.125, 0.215, 0.35, 0.446, 0.526, 0.582], rw = Fa - bo + 1 + tw.length, so = 20, Ri = {
  [Pn]: 0,
  [v0]: 1,
  [m0]: 2,
  [gb]: 3,
  [yb]: 4,
  [bb]: 5,
  [mb]: 6
}, x0 = new al(), Gf = Wk(so), Ea = null, Aa = null, { _lodPlanes: hl, _sizeLods: Sy, _sigmas: vc } = Uk(), zf = null, sr = null, vv = null, ls = (1 + Math.sqrt(5)) / 2, ro = 1 / ls, ky = [
  new re(1, 1, 1),
  new re(-1, 1, 1),
  new re(1, 1, -1),
  new re(-1, 1, -1),
  new re(0, ls, ro),
  new re(0, ls, -ro),
  new re(ro, 0, ls),
  new re(-ro, 0, ls),
  new re(ls, ro, 0),
  new re(-ls, ro, 0)
];
function Cy(e) {
  sr = e, mv(Gf);
}
Cy.prototype = {
  constructor: Cy,
  /**
   * Generates a PMREM from a supplied Scene, which can be faster than using an
   * image if networking bandwidth is low. Optional sigma specifies a blur radius
   * in radians to be applied to the scene before PMREM generation. Optional near
   * and far planes ensure the scene is rendered in its entirety (the cubeCamera
   * is placed at the origin).
   */
  fromScene: function(e, t = 0, r = 0.1, n = 100) {
    vv = sr.getRenderTarget();
    var i = Dy();
    return Gk(e, r, n, i), t > 0 && nw(i, 0, 0, t), By(i), _y(i), i;
  },
  /**
   * Generates a PMREM from an equirectangular texture, which can be either LDR
   * (RGBFormat) or HDR (RGBEFormat). The ideal input image size is 1k (1024 x 512),
   * as this matches best with the 256 x 256 cubemap output.
   */
  fromEquirectangular: function(e) {
    return e.magFilter = Or, e.minFilter = Or, e.generateMipmaps = !1, this.fromCubemap(e);
  },
  /**
   * Generates a PMREM from an cubemap texture, which can be either LDR
   * (RGBFormat) or HDR (RGBEFormat). The ideal input cube size is 256 x 256,
   * as this matches best with the 256 x 256 cubemap output.
   */
  fromCubemap: function(e) {
    vv = sr.getRenderTarget();
    var t = Dy(e);
    return zk(e, t), By(t), _y(t), t;
  },
  /**
   * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during
   * your texture's network fetch for increased concurrency.
   */
  compileCubemapShader: function() {
    Aa == null && (Aa = aw(), mv(Aa));
  },
  /**
   * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during
   * your texture's network fetch for increased concurrency.
   */
  compileEquirectangularShader: function() {
    Ea == null && (Ea = iw(), mv(Ea));
  },
  /**
   * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,
   * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on
   * one of them will cause any others to also become unusable.
   */
  dispose: function() {
    Gf.dispose(), Aa != null && Aa.dispose(), Ea != null && Ea.dispose();
    for (var e = 0; e < hl.length; e++)
      hl[e].dispose();
  }
};
function Uk() {
  for (var e = [], t = [], r = [], n = Fa, i = 0; i < rw; i++) {
    var a = Math.pow(2, n);
    t.push(a);
    var s = 1 / a;
    i > Fa - bo ? s = tw[i - Fa + bo - 1] : i == 0 && (s = 0), r.push(s);
    for (var o = 1 / (a - 1), u = -o / 2, l = 1 + o / 2, c = [u, u, l, u, l, l, u, u, l, l, u, l], f = 6, h = 6, d = 3, g = 2, v = 1, m = new Float32Array(d * h * f), p = new Float32Array(g * h * f), y = new Float32Array(v * h * f), w = 0; w < f; w++) {
      var x = w % 3 * 2 / 3 - 1, b = w > 2 ? 0 : -1, M = [
        x,
        b,
        0,
        x + 2 / 3,
        b,
        0,
        x + 2 / 3,
        b + 1,
        0,
        x,
        b,
        0,
        x + 2 / 3,
        b + 1,
        0,
        x,
        b + 1,
        0
      ];
      m.set(M, d * h * w), p.set(c, g * h * w);
      var k = [w, w, w, w, w, w];
      y.set(k, v * h * w);
    }
    var E = new it();
    E.setAttribute("position", new Et(m, d)), E.setAttribute("uv", new Et(p, g)), E.setAttribute("faceIndex", new Et(y, v)), e.push(E), n > bo && n--;
  }
  return { _lodPlanes: e, _sizeLods: t, _sigmas: r };
}
function Dy(e) {
  var t = {
    magFilter: Or,
    minFilter: Or,
    generateMipmaps: !1,
    type: e ? e.type : ah,
    format: e ? e.format : sA,
    encoding: e ? e.encoding : m0,
    depthBuffer: !1,
    stencilBuffer: !1
  }, r = Py(t);
  return r.depthBuffer = !e, zf = Py(t), r;
}
function _y(e) {
  zf.dispose(), sr.setRenderTarget(vv), e.scissorTest = !1, e.setSize(e.width, e.height);
}
function Gk(e, t, r, n) {
  var i = 90, a = 1, s = new Wr(i, a, t, r), o = [1, 1, 1, 1, -1, 1], u = [1, 1, -1, -1, -1, 1], l = sr.outputEncoding, c = sr.toneMapping, f = sr.toneMappingExposure, h = sr.getClearColor(), d = sr.getClearAlpha();
  sr.toneMapping = u0, sr.toneMappingExposure = 1, sr.outputEncoding = Pn, e.scale.z *= -1;
  var g = e.background;
  if (g && g.isColor) {
    g.convertSRGBToLinear();
    var v = Math.max(g.r, g.g, g.b), m = Math.min(Math.max(Math.ceil(Math.log2(v)), -128), 127);
    g = g.multiplyScalar(Math.pow(2, -m));
    var p = (m + 128) / 255;
    sr.setClearColor(g, p), e.background = null;
  }
  for (var y = 0; y < 6; y++) {
    var w = y % 3;
    w == 0 ? (s.up.set(0, o[y], 0), s.lookAt(u[y], 0, 0)) : w == 1 ? (s.up.set(0, 0, o[y]), s.lookAt(0, u[y], 0)) : (s.up.set(0, o[y], 0), s.lookAt(0, 0, u[y])), M0(
      n,
      w * Si,
      y > 2 ? Si : 0,
      Si,
      Si
    ), sr.setRenderTarget(n), sr.render(e, s);
  }
  sr.toneMapping = c, sr.toneMappingExposure = f, sr.outputEncoding = l, sr.setClearColor(h, d), e.scale.z *= -1;
}
function zk(e, t) {
  var r = new Ra();
  e.isCubeTexture ? Aa == null && (Aa = aw()) : Ea == null && (Ea = iw());
  var n = e.isCubeTexture ? Aa : Ea;
  r.add(new Tr(hl[0], n));
  var i = n.uniforms;
  i.envMap.value = e, e.isCubeTexture || i.texelSize.value.set(1 / e.image.width, 1 / e.image.height), i.inputEncoding.value = Ri[e.encoding], i.outputEncoding.value = Ri[e.encoding], M0(t, 0, 0, 3 * Si, 2 * Si), sr.setRenderTarget(t), sr.render(r, x0);
}
function mv(e) {
  var t = new Ra();
  t.add(new Tr(hl[0], e)), sr.compile(t, x0);
}
function Py(e) {
  var t = new vn(3 * Si, 3 * Si, e);
  return t.texture.mapping = wl, t.texture.name = "PMREM.cubeUv", t.scissorTest = !0, t;
}
function M0(e, t, r, n, i) {
  e.viewport.set(t, r, n, i), e.scissor.set(t, r, n, i);
}
function By(e) {
  var t = sr.autoClear;
  sr.autoClear = !1;
  for (var r = 1; r < rw; r++) {
    var n = Math.sqrt(
      vc[r] * vc[r] - vc[r - 1] * vc[r - 1]
    ), i = ky[(r - 1) % ky.length];
    nw(e, r - 1, r, n, i);
  }
  sr.autoClear = t;
}
function nw(e, t, r, n, i) {
  Ly(
    e,
    zf,
    t,
    r,
    n,
    "latitudinal",
    i
  ), Ly(
    zf,
    e,
    r,
    r,
    n,
    "longitudinal",
    i
  );
}
function Ly(e, t, r, n, i, a, s) {
  a !== "latitudinal" && a !== "longitudinal" && console.error(
    "blur direction must be either latitudinal or longitudinal!"
  );
  var o = 3, u = new Ra();
  u.add(new Tr(hl[n], Gf));
  var l = Gf.uniforms, c = Sy[r] - 1, f = isFinite(i) ? Math.PI / (2 * c) : 2 * Math.PI / (2 * so - 1), h = i / f, d = isFinite(i) ? 1 + Math.floor(o * h) : so;
  d > so && console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${d} samples when the maximum is set to ${so}`);
  for (var g = [], v = 0, m = 0; m < so; ++m) {
    var w = m / h, p = Math.exp(-w * w / 2);
    g.push(p), m == 0 ? v += p : m < d && (v += 2 * p);
  }
  for (var m = 0; m < g.length; m++)
    g[m] = g[m] / v;
  l.envMap.value = e.texture, l.samples.value = d, l.weights.value = g, l.latitudinal.value = a === "latitudinal", s && (l.poleAxis.value = s), l.dTheta.value = f, l.mipInt.value = Fa - r, l.inputEncoding.value = Ri[e.texture.encoding], l.outputEncoding.value = Ri[e.texture.encoding];
  var y = Sy[n], w = 3 * Math.max(0, Si - 2 * y), x = (n === 0 ? 0 : 2 * Si) + 2 * y * (n > Fa - bo ? n - Fa + bo : 0);
  M0(t, w, x, 3 * y, 2 * y), sr.setRenderTarget(t), sr.render(u, x0);
}
function Wk(e) {
  var t = new Float32Array(e), r = new re(0, 1, 0), n = new Ga({
    defines: { n: e },
    uniforms: {
      envMap: { value: null },
      samples: { value: 1 },
      weights: { value: t },
      latitudinal: { value: !1 },
      dTheta: { value: 0 },
      mipInt: { value: 0 },
      poleAxis: { value: r },
      inputEncoding: { value: Ri[Pn] },
      outputEncoding: { value: Ri[Pn] }
    },
    vertexShader: E0(),
    fragmentShader: `
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

${A0()}

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

void main() {
	gl_FragColor = vec4(0.0);
	for (int i = 0; i < n; i++) {
		if (i >= samples)
			break;
		for (int dir = -1; dir < 2; dir += 2) {
			if (i == 0 && dir == 1)
				continue;
			vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
			if (all(equal(axis, vec3(0.0))))
				axis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);
			axis = normalize(axis);
			float theta = dTheta * float(dir * i);
			float cosTheta = cos(theta);
			// Rodrigues' axis-angle rotation
			vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross(axis, vOutputDirection) * sin(theta)
					+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
			gl_FragColor.rgb +=
					weights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);
		}
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,
    blending: Pa,
    depthTest: !1,
    depthWrite: !1
  });
  return n.type = "SphericalGaussianBlur", n;
}
function iw() {
  var e = new _e(1, 1), t = new Ga({
    uniforms: {
      envMap: { value: null },
      texelSize: { value: e },
      inputEncoding: { value: Ri[Pn] },
      outputEncoding: { value: Ri[Pn] }
    },
    vertexShader: E0(),
    fragmentShader: `
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

${A0()}

#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv;
	uv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;
	uv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,
    blending: Pa,
    depthTest: !1,
    depthWrite: !1
  });
  return t.type = "EquirectangularToCubeUV", t;
}
function aw() {
  var e = new Ga({
    uniforms: {
      envMap: { value: null },
      inputEncoding: { value: Ri[Pn] },
      outputEncoding: { value: Ri[Pn] }
    },
    vertexShader: E0(),
    fragmentShader: `
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

${A0()}

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,
    blending: Pa,
    depthTest: !1,
    depthWrite: !1
  });
  return e.type = "CubemapToCubeUV", e;
}
function E0() {
  return `
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`;
}
function A0() {
  return `
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`;
}
ft.create = function(e, t) {
  return console.log("THREE.Curve.create() has been deprecated"), e.prototype = Object.create(ft.prototype), e.prototype.constructor = e, e.prototype.getPoint = t, e;
};
Object.assign(ka.prototype, {
  createPointsGeometry: function(e) {
    console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
    var t = this.getPoints(e);
    return this.createGeometry(t);
  },
  createSpacedPointsGeometry: function(e) {
    console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
    var t = this.getSpacedPoints(e);
    return this.createGeometry(t);
  },
  createGeometry: function(e) {
    console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
    for (var t = new At(), r = 0, n = e.length; r < n; r++) {
      var i = e[r];
      t.vertices.push(new re(i.x, i.y, i.z || 0));
    }
    return t;
  }
});
Object.assign(Ai.prototype, {
  fromPoints: function(e) {
    return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."), this.setFromPoints(e);
  }
});
Object.create(Fn.prototype);
Object.create(Fn.prototype);
function sw(e) {
  console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."), Fn.call(this, e), this.type = "catmullrom";
}
sw.prototype = Object.create(Fn.prototype);
Object.assign(sw.prototype, {
  initFromArray: function() {
    console.error("THREE.Spline: .initFromArray() has been removed.");
  },
  getControlPointsArray: function() {
    console.error("THREE.Spline: .getControlPointsArray() has been removed.");
  },
  reparametrizeByArcLength: function() {
    console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.");
  }
});
hv.prototype.setColors = function() {
  console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.");
};
ul.prototype.update = function() {
  console.error("THREE.SkeletonHelper: update() no longer needs to be called.");
};
Object.assign(er.prototype, {
  extractUrlBase: function(e) {
    return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."), Vb.extractUrlBase(e);
  }
});
er.Handlers = {
  add: function() {
    console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.");
  },
  get: function() {
    console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.");
  }
};
Object.assign(uv.prototype, {
  setTexturePath: function(e) {
    return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."), this.setResourcePath(e);
  }
});
Object.assign(Jb.prototype, {
  center: function(e) {
    return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."), this.getCenter(e);
  },
  empty: function() {
    return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."), this.isEmpty();
  },
  isIntersectionBox: function(e) {
    return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(e);
  },
  size: function(e) {
    return console.warn("THREE.Box2: .size() has been renamed to .getSize()."), this.getSize(e);
  }
});
Object.assign(Ui.prototype, {
  center: function(e) {
    return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."), this.getCenter(e);
  },
  empty: function() {
    return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."), this.isEmpty();
  },
  isIntersectionBox: function(e) {
    return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(e);
  },
  isIntersectionSphere: function(e) {
    return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(e);
  },
  size: function(e) {
    return console.warn("THREE.Box3: .size() has been renamed to .getSize()."), this.getSize(e);
  }
});
Ml.prototype.setFromMatrix = function(e) {
  return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."), this.setFromProjectionMatrix(e);
};
Qb.prototype.center = function(e) {
  return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."), this.getCenter(e);
};
Object.assign(It, {
  random16: function() {
    return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."), Math.random();
  },
  nearestPowerOfTwo: function(e) {
    return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."), It.floorPowerOfTwo(e);
  },
  nextPowerOfTwo: function(e) {
    return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."), It.ceilPowerOfTwo(e);
  }
});
Object.assign(an.prototype, {
  flattenToArrayOffset: function(e, t) {
    return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."), this.toArray(e, t);
  },
  multiplyVector3: function(e) {
    return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."), e.applyMatrix3(this);
  },
  multiplyVector3Array: function() {
    console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.");
  },
  applyToBufferAttribute: function(e) {
    return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."), e.applyMatrix3(this);
  },
  applyToVector3Array: function() {
    console.error("THREE.Matrix3: .applyToVector3Array() has been removed.");
  }
});
Object.assign(Nt.prototype, {
  extractPosition: function(e) {
    return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."), this.copyPosition(e);
  },
  flattenToArrayOffset: function(e, t) {
    return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."), this.toArray(e, t);
  },
  getPosition: function() {
    return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."), new re().setFromMatrixColumn(this, 3);
  },
  setRotationFromQuaternion: function(e) {
    return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."), this.makeRotationFromQuaternion(e);
  },
  multiplyToArray: function() {
    console.warn("THREE.Matrix4: .multiplyToArray() has been removed.");
  },
  multiplyVector3: function(e) {
    return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."), e.applyMatrix4(this);
  },
  multiplyVector4: function(e) {
    return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."), e.applyMatrix4(this);
  },
  multiplyVector3Array: function() {
    console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.");
  },
  rotateAxis: function(e) {
    console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."), e.transformDirection(this);
  },
  crossVector: function(e) {
    return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."), e.applyMatrix4(this);
  },
  translate: function() {
    console.error("THREE.Matrix4: .translate() has been removed.");
  },
  rotateX: function() {
    console.error("THREE.Matrix4: .rotateX() has been removed.");
  },
  rotateY: function() {
    console.error("THREE.Matrix4: .rotateY() has been removed.");
  },
  rotateZ: function() {
    console.error("THREE.Matrix4: .rotateZ() has been removed.");
  },
  rotateByAxis: function() {
    console.error("THREE.Matrix4: .rotateByAxis() has been removed.");
  },
  applyToBufferAttribute: function(e) {
    return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."), e.applyMatrix4(this);
  },
  applyToVector3Array: function() {
    console.error("THREE.Matrix4: .applyToVector3Array() has been removed.");
  },
  makeFrustum: function(e, t, r, n, i, a) {
    return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."), this.makePerspective(e, t, n, r, i, a);
  }
});
wi.prototype.isIntersectionLine = function(e) {
  return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."), this.intersectsLine(e);
};
Tn.prototype.multiplyVector3 = function(e) {
  return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."), e.applyQuaternion(this);
};
Object.assign(Yo.prototype, {
  isIntersectionBox: function(e) {
    return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(e);
  },
  isIntersectionPlane: function(e) {
    return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."), this.intersectsPlane(e);
  },
  isIntersectionSphere: function(e) {
    return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(e);
  }
});
Object.assign(Yr.prototype, {
  area: function() {
    return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."), this.getArea();
  },
  barycoordFromPoint: function(e, t) {
    return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."), this.getBarycoord(e, t);
  },
  midpoint: function(e) {
    return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."), this.getMidpoint(e);
  },
  normal: function(e) {
    return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."), this.getNormal(e);
  },
  plane: function(e) {
    return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."), this.getPlane(e);
  }
});
Object.assign(Yr, {
  barycoordFromPoint: function(e, t, r, n, i) {
    return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."), Yr.getBarycoord(e, t, r, n, i);
  },
  normal: function(e, t, r, n) {
    return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."), Yr.getNormal(e, t, r, n);
  }
});
Object.assign(ds.prototype, {
  extractAllPoints: function(e) {
    return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."), this.extractPoints(e);
  },
  extrude: function(e) {
    return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."), new Lo(this, e);
  },
  makeGeometry: function(e) {
    return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."), new Io(this, e);
  }
});
Object.assign(_e.prototype, {
  fromAttribute: function(e, t, r) {
    return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(e, t, r);
  },
  distanceToManhattan: function(e) {
    return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."), this.manhattanDistanceTo(e);
  },
  lengthManhattan: function() {
    return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength();
  }
});
Object.assign(re.prototype, {
  setEulerFromRotationMatrix: function() {
    console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.");
  },
  setEulerFromQuaternion: function() {
    console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.");
  },
  getPositionFromMatrix: function(e) {
    return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."), this.setFromMatrixPosition(e);
  },
  getScaleFromMatrix: function(e) {
    return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."), this.setFromMatrixScale(e);
  },
  getColumnFromMatrix: function(e, t) {
    return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."), this.setFromMatrixColumn(t, e);
  },
  applyProjection: function(e) {
    return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."), this.applyMatrix4(e);
  },
  fromAttribute: function(e, t, r) {
    return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(e, t, r);
  },
  distanceToManhattan: function(e) {
    return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."), this.manhattanDistanceTo(e);
  },
  lengthManhattan: function() {
    return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength();
  }
});
Object.assign(or.prototype, {
  fromAttribute: function(e, t, r) {
    return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(e, t, r);
  },
  lengthManhattan: function() {
    return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength();
  }
});
Object.assign(At.prototype, {
  computeTangents: function() {
    console.error("THREE.Geometry: .computeTangents() has been removed.");
  },
  computeLineDistances: function() {
    console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.");
  },
  applyMatrix: function(e) {
    return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."), this.applyMatrix4(e);
  }
});
Object.assign(et.prototype, {
  getChildByName: function(e) {
    return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."), this.getObjectByName(e);
  },
  renderDepth: function() {
    console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.");
  },
  translate: function(e, t) {
    return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."), this.translateOnAxis(t, e);
  },
  getWorldRotation: function() {
    console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.");
  },
  applyMatrix: function(e) {
    return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."), this.applyMatrix4(e);
  }
});
Object.defineProperties(et.prototype, {
  eulerOrder: {
    get: function() {
      return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order;
    },
    set: function(e) {
      console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order = e;
    }
  },
  useQuaternion: {
    get: function() {
      console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.");
    },
    set: function() {
      console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.");
    }
  }
});
Object.assign(Tr.prototype, {
  setDrawMode: function() {
    console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.");
  }
});
Object.defineProperties(Tr.prototype, {
  drawMode: {
    get: function() {
      return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."), PA;
    },
    set: function() {
      console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.");
    }
  }
});
Object.defineProperties(hf.prototype, {
  objects: {
    get: function() {
      return console.warn("THREE.LOD: .objects has been renamed to .levels."), this.levels;
    }
  }
});
Object.defineProperty(Bp.prototype, "useVertexTexture", {
  get: function() {
    console.warn("THREE.Skeleton: useVertexTexture has been removed.");
  },
  set: function() {
    console.warn("THREE.Skeleton: useVertexTexture has been removed.");
  }
});
df.prototype.initBones = function() {
  console.error("THREE.SkinnedMesh: initBones() has been removed.");
};
Object.defineProperty(ft.prototype, "__arcLengthDivisions", {
  get: function() {
    return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."), this.arcLengthDivisions;
  },
  set: function(e) {
    console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."), this.arcLengthDivisions = e;
  }
});
Wr.prototype.setLens = function(e, t) {
  console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."), t !== void 0 && (this.filmGauge = t), this.setFocalLength(e);
};
Object.defineProperties(mr.prototype, {
  onlyShadow: {
    set: function() {
      console.warn("THREE.Light: .onlyShadow has been removed.");
    }
  },
  shadowCameraFov: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."), this.shadow.camera.fov = e;
    }
  },
  shadowCameraLeft: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."), this.shadow.camera.left = e;
    }
  },
  shadowCameraRight: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."), this.shadow.camera.right = e;
    }
  },
  shadowCameraTop: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."), this.shadow.camera.top = e;
    }
  },
  shadowCameraBottom: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."), this.shadow.camera.bottom = e;
    }
  },
  shadowCameraNear: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."), this.shadow.camera.near = e;
    }
  },
  shadowCameraFar: {
    set: function(e) {
      console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."), this.shadow.camera.far = e;
    }
  },
  shadowCameraVisible: {
    set: function() {
      console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.");
    }
  },
  shadowBias: {
    set: function(e) {
      console.warn("THREE.Light: .shadowBias is now .shadow.bias."), this.shadow.bias = e;
    }
  },
  shadowDarkness: {
    set: function() {
      console.warn("THREE.Light: .shadowDarkness has been removed.");
    }
  },
  shadowMapWidth: {
    set: function(e) {
      console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."), this.shadow.mapSize.width = e;
    }
  },
  shadowMapHeight: {
    set: function(e) {
      console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."), this.shadow.mapSize.height = e;
    }
  }
});
Object.defineProperties(Et.prototype, {
  length: {
    get: function() {
      return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."), this.array.length;
    }
  },
  dynamic: {
    get: function() {
      return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."), this.usage === Lu;
    },
    set: function() {
      console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."), this.setUsage(Lu);
    }
  }
});
Object.assign(Et.prototype, {
  setDynamic: function(e) {
    return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."), this.setUsage(e === !0 ? Lu : sh), this;
  },
  copyIndicesArray: function() {
    console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.");
  },
  setArray: function() {
    console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers");
  }
});
Object.assign(it.prototype, {
  addIndex: function(e) {
    console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."), this.setIndex(e);
  },
  addAttribute: function(e, t) {
    return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."), !(t && t.isBufferAttribute) && !(t && t.isInterleavedBufferAttribute) ? (console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."), this.setAttribute(e, new Et(arguments[1], arguments[2]))) : e === "index" ? (console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."), this.setIndex(t), this) : this.setAttribute(e, t);
  },
  addDrawCall: function(e, t, r) {
    r !== void 0 && console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."), console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."), this.addGroup(e, t);
  },
  clearDrawCalls: function() {
    console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."), this.clearGroups();
  },
  computeTangents: function() {
    console.warn("THREE.BufferGeometry: .computeTangents() has been removed.");
  },
  computeOffsets: function() {
    console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.");
  },
  removeAttribute: function(e) {
    return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."), this.deleteAttribute(e);
  },
  applyMatrix: function(e) {
    return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."), this.applyMatrix4(e);
  }
});
Object.defineProperties(it.prototype, {
  drawcalls: {
    get: function() {
      return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."), this.groups;
    }
  },
  offsets: {
    get: function() {
      return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."), this.groups;
    }
  }
});
Object.defineProperties(Na.prototype, {
  dynamic: {
    get: function() {
      return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."), this.usage === Lu;
    },
    set: function(e) {
      console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."), this.setUsage(e);
    }
  }
});
Object.assign(Na.prototype, {
  setDynamic: function(e) {
    return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."), this.setUsage(e === !0 ? Lu : sh), this;
  },
  setArray: function() {
    console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers");
  }
});
Object.assign(na.prototype, {
  getArrays: function() {
    console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.");
  },
  addShapeList: function() {
    console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.");
  },
  addShape: function() {
    console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.");
  }
});
Object.defineProperties(cv.prototype, {
  dynamic: {
    set: function() {
      console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.");
    }
  },
  onUpdate: {
    value: function() {
      return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."), this;
    }
  }
});
Object.defineProperties(wt.prototype, {
  wrapAround: {
    get: function() {
      console.warn("THREE.Material: .wrapAround has been removed.");
    },
    set: function() {
      console.warn("THREE.Material: .wrapAround has been removed.");
    }
  },
  overdraw: {
    get: function() {
      console.warn("THREE.Material: .overdraw has been removed.");
    },
    set: function() {
      console.warn("THREE.Material: .overdraw has been removed.");
    }
  },
  wrapRGB: {
    get: function() {
      return console.warn("THREE.Material: .wrapRGB has been removed."), new nt();
    }
  },
  shading: {
    get: function() {
      console.error("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead.");
    },
    set: function(e) {
      console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."), this.flatShading = e === ub;
    }
  },
  stencilMask: {
    get: function() {
      return console.warn("THREE." + this.type + ": .stencilMask has been removed. Use .stencilFuncMask instead."), this.stencilFuncMask;
    },
    set: function(e) {
      console.warn("THREE." + this.type + ": .stencilMask has been removed. Use .stencilFuncMask instead."), this.stencilFuncMask = e;
    }
  }
});
Object.defineProperties(Es.prototype, {
  metal: {
    get: function() {
      return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."), !1;
    },
    set: function() {
      console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead");
    }
  }
});
Object.defineProperties(En.prototype, {
  derivatives: {
    get: function() {
      return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives;
    },
    set: function(e) {
      console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives = e;
    }
  }
});
Object.assign(Fb.prototype, {
  clearTarget: function(e, t, r, n) {
    console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."), this.setRenderTarget(e), this.clear(t, r, n);
  },
  animate: function(e) {
    console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."), this.setAnimationLoop(e);
  },
  getCurrentRenderTarget: function() {
    return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."), this.getRenderTarget();
  },
  getMaxAnisotropy: function() {
    return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."), this.capabilities.getMaxAnisotropy();
  },
  getPrecision: function() {
    return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."), this.capabilities.precision;
  },
  resetGLState: function() {
    return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."), this.state.reset();
  },
  supportsFloatTextures: function() {
    return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."), this.extensions.get("OES_texture_float");
  },
  supportsHalfFloatTextures: function() {
    return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."), this.extensions.get("OES_texture_half_float");
  },
  supportsStandardDerivatives: function() {
    return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."), this.extensions.get("OES_standard_derivatives");
  },
  supportsCompressedTextureS3TC: function() {
    return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."), this.extensions.get("WEBGL_compressed_texture_s3tc");
  },
  supportsCompressedTexturePVRTC: function() {
    return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."), this.extensions.get("WEBGL_compressed_texture_pvrtc");
  },
  supportsBlendMinMax: function() {
    return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."), this.extensions.get("EXT_blend_minmax");
  },
  supportsVertexTextures: function() {
    return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."), this.capabilities.vertexTextures;
  },
  supportsInstancedArrays: function() {
    return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."), this.extensions.get("ANGLE_instanced_arrays");
  },
  enableScissorTest: function(e) {
    console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."), this.setScissorTest(e);
  },
  initMaterial: function() {
    console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.");
  },
  addPrePlugin: function() {
    console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.");
  },
  addPostPlugin: function() {
    console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.");
  },
  updateShadowMap: function() {
    console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.");
  },
  setFaceCulling: function() {
    console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.");
  },
  allocTextureUnit: function() {
    console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.");
  },
  setTexture: function() {
    console.warn("THREE.WebGLRenderer: .setTexture() has been removed.");
  },
  setTexture2D: function() {
    console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.");
  },
  setTextureCube: function() {
    console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.");
  },
  getActiveMipMapLevel: function() {
    return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."), this.getActiveMipmapLevel();
  }
});
Object.defineProperties(Fb.prototype, {
  shadowMapEnabled: {
    get: function() {
      return this.shadowMap.enabled;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."), this.shadowMap.enabled = e;
    }
  },
  shadowMapType: {
    get: function() {
      return this.shadowMap.type;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."), this.shadowMap.type = e;
    }
  },
  shadowMapCullFace: {
    get: function() {
      console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.");
    },
    set: function() {
      console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.");
    }
  },
  context: {
    get: function() {
      return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."), this.getContext();
    }
  },
  vr: {
    get: function() {
      return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"), this.xr;
    }
  },
  gammaInput: {
    get: function() {
      return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."), !1;
    },
    set: function() {
      console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.");
    }
  },
  gammaOutput: {
    get: function() {
      return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."), !1;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."), this.outputEncoding = e === !0 ? v0 : Pn;
    }
  }
});
Object.defineProperties(Bb.prototype, {
  cullFace: {
    get: function() {
      console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.");
    },
    set: function() {
      console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.");
    }
  },
  renderReverseSided: {
    get: function() {
      console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.");
    },
    set: function() {
      console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.");
    }
  },
  renderSingleSided: {
    get: function() {
      console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.");
    },
    set: function() {
      console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.");
    }
  }
});
Object.defineProperties(vn.prototype, {
  wrapS: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS = e;
    }
  },
  wrapT: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT = e;
    }
  },
  magFilter: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter = e;
    }
  },
  minFilter: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter = e;
    }
  },
  anisotropy: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy = e;
    }
  },
  offset: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset = e;
    }
  },
  repeat: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat = e;
    }
  },
  format: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format = e;
    }
  },
  type: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type = e;
    }
  },
  generateMipmaps: {
    get: function() {
      return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps;
    },
    set: function(e) {
      console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps = e;
    }
  }
});
Object.defineProperties(sl.prototype, {
  load: {
    value: function(e) {
      console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");
      var t = this, r = new lv();
      return r.load(e, function(n) {
        t.setBuffer(n);
      }), this;
    }
  },
  startTime: {
    set: function() {
      console.warn("THREE.Audio: .startTime is now .play( delay ).");
    }
  }
});
$b.prototype.getData = function() {
  return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."), this.getFrequencyData();
};
Ru.prototype.updateCubeMap = function(e, t) {
  return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."), this.update(e, t);
};
ys.crossOrigin = void 0;
ys.loadTexture = function(e, t, r, n) {
  console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
  var i = new qp();
  i.setCrossOrigin(this.crossOrigin);
  var a = i.load(e, r, void 0, n);
  return t && (a.mapping = t), a;
};
ys.loadTextureCube = function(e, t, r, n) {
  console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
  var i = new Xp();
  i.setCrossOrigin(this.crossOrigin);
  var a = i.load(e, r, void 0, n);
  return t && (a.mapping = t), a;
};
ys.loadCompressedTexture = function() {
  console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.");
};
ys.loadCompressedTextureCube = function() {
  console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.");
};
typeof __THREE_DEVTOOLS__ != "undefined" && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register", { detail: {
  revision: xE
} }));
var de = {};
(function() {
  var e = function() {
    function i(a) {
      this.message = "JPEG error: " + a;
    }
    return i.prototype = new Error(), i.prototype.name = "JpegError", i.constructor = i, i;
  }(), t = function() {
    var i = new Uint8Array([0, 1, 8, 16, 9, 2, 3, 10, 17, 24, 32, 25, 18, 11, 4, 5, 12, 19, 26, 33, 40, 48, 41, 34, 27, 20, 13, 6, 7, 14, 21, 28, 35, 42, 49, 56, 57, 50, 43, 36, 29, 22, 15, 23, 30, 37, 44, 51, 58, 59, 52, 45, 38, 31, 39, 46, 53, 60, 61, 54, 47, 55, 62, 63]), a = 4017, s = 799, o = 3406, u = 2276, l = 1567, c = 3784, f = 5793, h = 2896;
    function d(x) {
      x == null && (x = {}), x.w == null && (x.w = -1), this.V = x.n, this.N = x.w;
    }
    function g(x, b) {
      for (var M = 0, k = [], E, S, F = 16, O; F > 0 && !x[F - 1]; )
        F--;
      k.push({
        children: [],
        index: 0
      });
      var D = k[0];
      for (E = 0; E < F; E++) {
        for (S = 0; S < x[E]; S++) {
          for (D = k.pop(), D.children[D.index] = b[M]; D.index > 0; )
            D = k.pop();
          for (D.index++, k.push(D); k.length <= E; )
            k.push(O = {
              children: [],
              index: 0
            }), D.children[D.index] = O.children, D = O;
          M++;
        }
        E + 1 < F && (k.push(O = {
          children: [],
          index: 0
        }), D.children[D.index] = O.children, D = O);
      }
      return k[0].children;
    }
    function v(x, b, M) {
      return 64 * ((x.P + 1) * b + M);
    }
    function m(x, b, M, k, E, S, F, O, D, _) {
      _ == null && (_ = !1);
      var L = M.m, G = M.Z, V = b, H = 0, U = 0, R = 0, B = 0, C, Z = 0, W, J, Q, j, q, ae, pe = 0, $, se, ve, me;
      function Ae() {
        if (U > 0)
          return U--, H >> U & 1;
        if (H = x[b++], H === 255) {
          var I = x[b++];
          if (I) {
            if (I === 220 && _) {
              b += 2;
              var A = r(x, b);
              if (b += 2, A > 0 && A !== M.s)
                throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data", A);
            } else if (I === 217) {
              if (_) {
                var T = Z * 8;
                if (T > 0 && T < M.s / 10)
                  throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter", T);
              }
              throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data");
            }
            throw new e("unexpected marker");
          }
        }
        return U = 7, H >>> 7;
      }
      function Ce(I) {
        for (var A = I; ; ) {
          switch (A = A[Ae()], Er(A)) {
            case "number":
              return A;
            case "object":
              continue;
          }
          throw new e("invalid huffman sequence");
        }
      }
      function Ee(I) {
        for (var A = 0; I > 0; )
          A = A << 1 | Ae(), I--;
        return A;
      }
      function Y(I) {
        if (I === 1)
          return Ae() === 1 ? 1 : -1;
        var A = Ee(I);
        return A >= 1 << I - 1 ? A : A + (-1 << I) + 1;
      }
      function ee(I, A) {
        var T = Ce(I.J), P = T === 0 ? 0 : Y(T), z = 1;
        for (I.D[A] = I.Q += P; z < 64; ) {
          var K = Ce(I.i), oe = K & 15, ce = K >> 4;
          if (oe === 0) {
            if (ce < 15)
              break;
            z += 16;
            continue;
          }
          z += ce;
          var ge = i[z];
          I.D[A + ge] = Y(oe), z++;
        }
      }
      function Me(I, A) {
        var T = Ce(I.J), P = T === 0 ? 0 : Y(T) << D;
        I.D[A] = I.Q += P;
      }
      function ye(I, A) {
        I.D[A] |= Ae() << D;
      }
      function De(I, A) {
        if (R > 0) {
          R--;
          return;
        }
        for (var T = S, P = F; T <= P; ) {
          var z = Ce(I.i), K = z & 15, oe = z >> 4;
          if (K === 0) {
            if (oe < 15) {
              R = Ee(oe) + (1 << oe) - 1;
              break;
            }
            T += 16;
            continue;
          }
          T += oe;
          var ce = i[T];
          I.D[A + ce] = Y(K) * (1 << D), T++;
        }
      }
      function Se(I, A) {
        for (var T = S, P = F, z = 0, K, oe; T <= P; ) {
          var ce = A + i[T], ge = I.D[ce] < 0 ? -1 : 1;
          switch (B) {
            case 0:
              if (oe = Ce(I.i), K = oe & 15, z = oe >> 4, K === 0)
                z < 15 ? (R = Ee(z) + (1 << z), B = 4) : (z = 16, B = 1);
              else {
                if (K !== 1)
                  throw new e("invalid ACn encoding");
                C = Y(K), B = z ? 2 : 3;
              }
              continue;
            case 1:
            case 2:
              I.D[ce] ? I.D[ce] += ge * (Ae() << D) : (z--, z === 0 && (B = B === 2 ? 3 : 0));
              break;
            case 3:
              I.D[ce] ? I.D[ce] += ge * (Ae() << D) : (I.D[ce] = C << D, B = 0);
              break;
            case 4:
              I.D[ce] && (I.D[ce] += ge * (Ae() << D));
              break;
          }
          T++;
        }
        B === 4 && (R--, R === 0 && (B = 0));
      }
      function fe(I, A, T, P, z) {
        var K = T / L | 0, oe = T % L;
        Z = K * I.A + P;
        var ce = oe * I.h + z, ge = v(I, Z, ce);
        A(I, ge);
      }
      function ke(I, A, T) {
        Z = T / I.P | 0;
        var P = T % I.P, z = v(I, Z, P);
        A(I, z);
      }
      var ne = k.length;
      for (G ? S === 0 ? ae = O === 0 ? Me : ye : ae = O === 0 ? De : Se : ae = ee, ne === 1 ? se = k[0].P * k[0].c : se = L * M.R; pe <= se; ) {
        var Te = E ? Math.min(se - pe, E) : se;
        if (Te > 0) {
          for (J = 0; J < ne; J++)
            k[J].Q = 0;
          if (R = 0, ne === 1)
            for (W = k[0], q = 0; q < Te; q++)
              ke(W, ae, pe), pe++;
          else
            for (q = 0; q < Te; q++) {
              for (J = 0; J < ne; J++)
                for (W = k[J], ve = W.h, me = W.A, Q = 0; Q < me; Q++)
                  for (j = 0; j < ve; j++)
                    fe(W, ae, pe, Q, j);
              pe++;
            }
        }
        if (U = 0, $ = w(x, b), !$)
          break;
        if ($.u && (b = $.offset), $.M >= 65488 && $.M <= 65495)
          b += 2;
        else
          break;
      }
      return b - V;
    }
    function p(x, b, M) {
      var k = x.$, E = x.D, S, F, O, D, _, L, G, V, H, U, R, B, C, Z, W, J, Q;
      if (!k)
        throw new e("missing required Quantization Table.");
      for (var j = 0; j < 64; j += 8) {
        if (H = E[b + j], U = E[b + j + 1], R = E[b + j + 2], B = E[b + j + 3], C = E[b + j + 4], Z = E[b + j + 5], W = E[b + j + 6], J = E[b + j + 7], H *= k[j], !(U | R | B | C | Z | W | J)) {
          Q = f * H + 512 >> 10, M[j] = Q, M[j + 1] = Q, M[j + 2] = Q, M[j + 3] = Q, M[j + 4] = Q, M[j + 5] = Q, M[j + 6] = Q, M[j + 7] = Q;
          continue;
        }
        U *= k[j + 1], R *= k[j + 2], B *= k[j + 3], C *= k[j + 4], Z *= k[j + 5], W *= k[j + 6], J *= k[j + 7], S = f * H + 128 >> 8, F = f * C + 128 >> 8, O = R, D = W, _ = h * (U - J) + 128 >> 8, V = h * (U + J) + 128 >> 8, L = B << 4, G = Z << 4, S = S + F + 1 >> 1, F = S - F, Q = O * c + D * l + 128 >> 8, O = O * l - D * c + 128 >> 8, D = Q, _ = _ + G + 1 >> 1, G = _ - G, V = V + L + 1 >> 1, L = V - L, S = S + D + 1 >> 1, D = S - D, F = F + O + 1 >> 1, O = F - O, Q = _ * u + V * o + 2048 >> 12, _ = _ * o - V * u + 2048 >> 12, V = Q, Q = L * s + G * a + 2048 >> 12, L = L * a - G * s + 2048 >> 12, G = Q, M[j] = S + V, M[j + 7] = S - V, M[j + 1] = F + G, M[j + 6] = F - G, M[j + 2] = O + L, M[j + 5] = O - L, M[j + 3] = D + _, M[j + 4] = D - _;
      }
      for (var q = 0; q < 8; ++q) {
        if (H = M[q], U = M[q + 8], R = M[q + 16], B = M[q + 24], C = M[q + 32], Z = M[q + 40], W = M[q + 48], J = M[q + 56], !(U | R | B | C | Z | W | J)) {
          Q = f * H + 8192 >> 14, Q < -2040 ? Q = 0 : Q >= 2024 ? Q = 255 : Q = Q + 2056 >> 4, E[b + q] = Q, E[b + q + 8] = Q, E[b + q + 16] = Q, E[b + q + 24] = Q, E[b + q + 32] = Q, E[b + q + 40] = Q, E[b + q + 48] = Q, E[b + q + 56] = Q;
          continue;
        }
        S = f * H + 2048 >> 12, F = f * C + 2048 >> 12, O = R, D = W, _ = h * (U - J) + 2048 >> 12, V = h * (U + J) + 2048 >> 12, L = B, G = Z, S = (S + F + 1 >> 1) + 4112, F = S - F, Q = O * c + D * l + 2048 >> 12, O = O * l - D * c + 2048 >> 12, D = Q, _ = _ + G + 1 >> 1, G = _ - G, V = V + L + 1 >> 1, L = V - L, S = S + D + 1 >> 1, D = S - D, F = F + O + 1 >> 1, O = F - O, Q = _ * u + V * o + 2048 >> 12, _ = _ * o - V * u + 2048 >> 12, V = Q, Q = L * s + G * a + 2048 >> 12, L = L * a - G * s + 2048 >> 12, G = Q, H = S + V, J = S - V, U = F + G, W = F - G, R = O + L, Z = O - L, B = D + _, C = D - _, H < 16 ? H = 0 : H >= 4080 ? H = 255 : H >>= 4, U < 16 ? U = 0 : U >= 4080 ? U = 255 : U >>= 4, R < 16 ? R = 0 : R >= 4080 ? R = 255 : R >>= 4, B < 16 ? B = 0 : B >= 4080 ? B = 255 : B >>= 4, C < 16 ? C = 0 : C >= 4080 ? C = 255 : C >>= 4, Z < 16 ? Z = 0 : Z >= 4080 ? Z = 255 : Z >>= 4, W < 16 ? W = 0 : W >= 4080 ? W = 255 : W >>= 4, J < 16 ? J = 0 : J >= 4080 ? J = 255 : J >>= 4, E[b + q] = H, E[b + q + 8] = U, E[b + q + 16] = R, E[b + q + 24] = B, E[b + q + 32] = C, E[b + q + 40] = Z, E[b + q + 48] = W, E[b + q + 56] = J;
      }
    }
    function y(x, b) {
      for (var M = b.P, k = b.c, E = new Int16Array(64), S = 0; S < k; S++)
        for (var F = 0; F < M; F++) {
          var O = v(b, S, F);
          p(b, O, E);
        }
      return b.D;
    }
    function w(x, b, M) {
      M == null && (M = b);
      var k = x.length - 1, E = M < b ? M : b;
      if (b >= k)
        return null;
      var S = r(x, b);
      if (S >= 65472 && S <= 65534)
        return {
          u: null,
          M: S,
          offset: b
        };
      for (var F = r(x, E); !(F >= 65472 && F <= 65534); ) {
        if (++E >= k)
          return null;
        F = r(x, E);
      }
      return {
        u: S.toString(16),
        M: F,
        offset: E
      };
    }
    return d.prototype = {
      parse: function(b, M) {
        M == null && (M = {});
        var k = M.F, E = 0, S = null, F = null, O, D, _ = 0;
        function L() {
          var ge = r(b, E);
          E += 2;
          var Oe = E + ge - 2, Ge = w(b, Oe, E);
          Ge && Ge.u && (Oe = Ge.offset);
          var We = b.subarray(E, Oe);
          return E += We.length, We;
        }
        function G(ge) {
          for (var Oe = Math.ceil(ge.o / 8 / ge.X), Ge = Math.ceil(ge.s / 8 / ge.B), We = 0; We < ge.W.length; We++) {
            fe = ge.W[We];
            var $e = Math.ceil(Math.ceil(ge.o / 8) * fe.h / ge.X), pt = Math.ceil(Math.ceil(ge.s / 8) * fe.A / ge.B), tt = Oe * fe.h, xt = Ge * fe.A, ht = 64 * xt * (tt + 1);
            fe.D = new Int16Array(ht), fe.P = $e, fe.c = pt;
          }
          ge.m = Oe, ge.R = Ge;
        }
        var V = [], H = [], U = [], R = r(b, E);
        if (E += 2, R !== 65496)
          throw new e("SOI not found");
        R = r(b, E), E += 2;
        e: for (; R !== 65497; ) {
          var B, C, Z;
          switch (R) {
            case 65504:
            case 65505:
            case 65506:
            case 65507:
            case 65508:
            case 65509:
            case 65510:
            case 65511:
            case 65512:
            case 65513:
            case 65514:
            case 65515:
            case 65516:
            case 65517:
            case 65518:
            case 65519:
            case 65534:
              var W = L();
              R === 65504 && W[0] === 74 && W[1] === 70 && W[2] === 73 && W[3] === 70 && W[4] === 0 && (S = {
                version: {
                  d: W[5],
                  T: W[6]
                },
                K: W[7],
                j: W[8] << 8 | W[9],
                H: W[10] << 8 | W[11],
                S: W[12],
                I: W[13],
                C: W.subarray(14, 14 + 3 * W[12] * W[13])
              }), R === 65518 && W[0] === 65 && W[1] === 100 && W[2] === 111 && W[3] === 98 && W[4] === 101 && (F = {
                version: W[5] << 8 | W[6],
                k: W[7] << 8 | W[8],
                q: W[9] << 8 | W[10],
                a: W[11]
              });
              break;
            case 65499:
              var J = r(b, E), Q;
              E += 2;
              for (var j = J + E - 2; E < j; ) {
                var q = b[E++], ae = new Uint16Array(64);
                if (q >> 4)
                  if (q >> 4 === 1)
                    for (C = 0; C < 64; C++)
                      Q = i[C], ae[Q] = r(b, E), E += 2;
                  else
                    throw new e("DQT - invalid table spec");
                else for (C = 0; C < 64; C++)
                  Q = i[C], ae[Q] = b[E++];
                V[q & 15] = ae;
              }
              break;
            case 65472:
            case 65473:
            case 65474:
              if (O)
                throw new e("Only single frame JPEGs supported");
              E += 2, O = {}, O.G = R === 65473, O.Z = R === 65474, O.precision = b[E++];
              var pe = r(b, E), $, se = 0, ve = 0;
              E += 2, O.s = k || pe, O.o = r(b, E), E += 2, O.W = [], O._ = {};
              var me = b[E++];
              for (B = 0; B < me; B++) {
                $ = b[E];
                var Ae = b[E + 1] >> 4, Ce = b[E + 1] & 15;
                se < Ae && (se = Ae), ve < Ce && (ve = Ce);
                var Ee = b[E + 2];
                Z = O.W.push({
                  h: Ae,
                  A: Ce,
                  L: Ee,
                  $: null
                }), O._[$] = Z - 1, E += 3;
              }
              O.X = se, O.B = ve, G(O);
              break;
            case 65476:
              var Y = r(b, E);
              for (E += 2, B = 2; B < Y; ) {
                var ee = b[E++], Me = new Uint8Array(16), ye = 0;
                for (C = 0; C < 16; C++, E++)
                  ye += Me[C] = b[E];
                var De = new Uint8Array(ye);
                for (C = 0; C < ye; C++, E++)
                  De[C] = b[E];
                B += 17 + ye, (ee >> 4 ? H : U)[ee & 15] = g(Me, De);
              }
              break;
            case 65501:
              E += 2, D = r(b, E), E += 2;
              break;
            case 65498:
              var Se = ++_ === 1 && !k, fe;
              E += 2;
              var ke = b[E++], ne = [];
              for (B = 0; B < ke; B++) {
                var Te = b[E++], I = O._[Te];
                fe = O.W[I], fe.index = Te;
                var A = b[E++];
                fe.J = U[A >> 4], fe.i = H[A & 15], ne.push(fe);
              }
              var T = b[E++], P = b[E++], z = b[E++];
              try {
                var K = m(b, E, O, ne, D, T, P, z >> 4, z & 15, Se);
                E += K;
              } catch (ge) {
                if (ge instanceof DNLMarkerError)
                  return this.parse(b, {
                    F: ge.s
                  });
                if (ge instanceof EOIMarkerError)
                  break e;
                throw ge;
              }
              break;
            case 65500:
              E += 4;
              break;
            case 65535:
              b[E] !== 255 && E--;
              break;
            default:
              var oe = w(b, E - 2, E - 3);
              if (oe && oe.u) {
                E = oe.offset;
                break;
              }
              if (E >= b.length - 1)
                break e;
              throw new e("JpegImage.parse - unknown marker: " + R.toString(16));
          }
          R = r(b, E), E += 2;
        }
        for (this.width = O.o, this.height = O.s, this.g = S, this.b = F, this.W = [], B = 0; B < O.W.length; B++) {
          fe = O.W[B];
          var ce = V[fe.L];
          ce && (fe.$ = ce), this.W.push({
            index: fe.index,
            e: y(O, fe),
            l: fe.h / O.X,
            t: fe.A / O.B,
            P: fe.P,
            c: fe.c
          });
        }
        this.p = this.W.length;
      },
      Y: function(b, M, k) {
        k == null && (k = !1);
        var E = this.width / b, S = this.height / M, F, O, D, _, L, G, V, H, U, R, B = 0, C, Z = this.W.length, W = b * M * Z, J = new Uint8ClampedArray(W), Q = new Uint32Array(b), j = 4294967288, q;
        for (V = 0; V < Z; V++) {
          if (F = this.W[V], O = F.l * E, D = F.t * S, B = V, C = F.e, _ = F.P + 1 << 3, O !== q) {
            for (L = 0; L < b; L++)
              H = 0 | L * O, Q[L] = (H & j) << 3 | H & 7;
            q = O;
          }
          for (G = 0; G < M; G++)
            for (H = 0 | G * D, R = _ * (H & j) | (H & 7) << 3, L = 0; L < b; L++)
              J[B] = C[R + Q[L]], B += Z;
        }
        var ae = this.V;
        if (!k && Z === 4 && !ae && (ae = new Int32Array([-256, 255, -256, 255, -256, 255, -256, 255])), ae)
          for (V = 0; V < W; )
            for (H = 0, U = 0; H < Z; H++, V++, U += 2)
              J[V] = (J[V] * ae[U] >> 8) + ae[U + 1];
        return J;
      },
      get f() {
        return this.b ? !!this.b.a : this.p === 3 ? this.N === 0 ? !1 : !(this.W[0].index === 82 && this.W[1].index === 71 && this.W[2].index === 66) : this.N === 1;
      },
      z: function(b) {
        for (var M, k, E, S = 0, F = b.length; S < F; S += 3)
          M = b[S], k = b[S + 1], E = b[S + 2], b[S] = M - 179.456 + 1.402 * E, b[S + 1] = M + 135.459 - 0.344 * k - 0.714 * E, b[S + 2] = M - 226.816 + 1.772 * k;
        return b;
      },
      O: function(b) {
        for (var M, k, E, S, F = 0, O = 0, D = b.length; O < D; O += 4)
          M = b[O], k = b[O + 1], E = b[O + 2], S = b[O + 3], b[F++] = -122.67195406894 + k * (-660635669420364e-19 * k + 437130475926232e-18 * E - 54080610064599e-18 * M + 48449797120281e-17 * S - 0.154362151871126) + E * (-957964378445773e-18 * E + 817076911346625e-18 * M - 0.00477271405408747 * S + 1.53380253221734) + M * (961250184130688e-18 * M - 0.00266257332283933 * S + 0.48357088451265) + S * (-336197177618394e-18 * S + 0.484791561490776), b[F++] = 107.268039397724 + k * (219927104525741e-19 * k - 640992018297945e-18 * E + 659397001245577e-18 * M + 426105652938837e-18 * S - 0.176491792462875) + E * (-778269941513683e-18 * E + 0.00130872261408275 * M + 770482631801132e-18 * S - 0.151051492775562) + M * (0.00126935368114843 * M - 0.00265090189010898 * S + 0.25802910206845) + S * (-318913117588328e-18 * S - 0.213742400323665), b[F++] = -20.810012546947 + k * (-570115196973677e-18 * k - 263409051004589e-19 * E + 0.0020741088115012 * M - 0.00288260236853442 * S + 0.814272968359295) + E * (-153496057440975e-19 * E - 132689043961446e-18 * M + 560833691242812e-18 * S - 0.195152027534049) + M * (0.00174418132927582 * M - 0.00255243321439347 * S + 0.116935020465145) + S * (-343531996510555e-18 * S + 0.24165260232407);
        return b.subarray(0, F);
      },
      r: function(b) {
        for (var M, k, E, S = 0, F = b.length; S < F; S += 4)
          M = b[S], k = b[S + 1], E = b[S + 2], b[S] = 434.456 - M - 1.402 * E, b[S + 1] = 119.541 - M + 0.344 * k + 0.714 * E, b[S + 2] = 481.816 - M - 1.772 * k;
        return b;
      },
      U: function(b) {
        for (var M, k, E, S, F = 0, O = 0, D = b.length; O < D; O += 4)
          M = b[O], k = b[O + 1], E = b[O + 2], S = b[O + 3], b[F++] = 255 + M * (-6747147073602441e-20 * M + 8379262121013727e-19 * k + 2894718188643294e-19 * E + 0.003264231057537806 * S - 1.1185611867203937) + k * (26374107616089405e-21 * k - 8626949158638572e-20 * E - 2748769067499491e-19 * S - 0.02155688794978967) + E * (-3878099212869363e-20 * E - 3267808279485286e-19 * S + 0.0686742238595345) - S * (3361971776183937e-19 * S + 0.7430659151342254), b[F++] = 255 + M * (13596372813588848e-20 * M + 924537132573585e-18 * k + 10567359618683593e-20 * E + 4791864687436512e-19 * S - 0.3109689587515875) + k * (-23545346108370344e-20 * k + 2702845253534714e-19 * E + 0.0020200308977307156 * S - 0.7488052167015494) + E * (6834815998235662e-20 * E + 15168452363460973e-20 * S - 0.09751927774728933) - S * (3189131175883281e-19 * S + 0.7364883807733168), b[F++] = 255 + M * (13598650411385307e-21 * M + 12423956175490851e-20 * k + 4751985097583589e-19 * E - 36729317476630422e-22 * S - 0.05562186980264034) + k * (16141380598724676e-20 * k + 9692239130725186e-19 * E + 7782692450036253e-19 * S - 0.44015232367526463) + E * (5068882914068769e-22 * E + 0.0017778369011375071 * S - 0.7591454649749609) - S * (3435319965105553e-19 * S + 0.7063770186160144);
        return b.subarray(0, F);
      },
      getData: function(b) {
        var M = b.width, k = b.height, E = b.forceRGB, S = b.isSourcePDF;
        if (this.p > 4)
          throw new e("Unsupported color mode");
        var F = this.Y(M, k, S);
        if (this.p === 1 && E) {
          for (var O = F.length, D = new Uint8ClampedArray(O * 3), _ = 0, L = 0; L < O; L++) {
            var G = F[L];
            D[_++] = G, D[_++] = G, D[_++] = G;
          }
          return D;
        } else {
          if (this.p === 3 && this.f)
            return this.z(F);
          if (this.p === 4) {
            if (this.f)
              return E ? this.O(F) : this.r(F);
            if (E)
              return this.U(F);
          }
        }
        return F;
      }
    }, d;
  }();
  function r(n, i) {
    return n[i] << 8 | n[i + 1];
  }
  de.JpegDecoder = t;
})();
de.encodeImage = function(e, t, r, n) {
  var i = {
    t256: [t],
    t257: [r],
    t258: [8, 8, 8, 8],
    t259: [1],
    t262: [2],
    t273: [1e3],
    // strips offset
    t277: [4],
    t278: [r],
    /* rows per strip */
    t279: [t * r * 4],
    // strip byte counts
    t282: [[72, 1]],
    t283: [[72, 1]],
    t284: [1],
    t286: [[0, 1]],
    t287: [[0, 1]],
    t296: [1],
    t305: ["Photopea (UTIF.js)"],
    t338: [1]
  };
  if (n) for (var a in n) i[a] = n[a];
  for (var s = new Uint8Array(de.encode([i])), o = new Uint8Array(e), u = new Uint8Array(1e3 + t * r * 4), a = 0; a < s.length; a++) u[a] = s[a];
  for (var a = 0; a < o.length; a++) u[1e3 + a] = o[a];
  return u.buffer;
};
de.encode = function(e) {
  var t = new Uint8Array(2e4), r = 4, n = de._binBE;
  t[0] = t[1] = 77, n.writeUshort(t, 2, 42);
  var i = 8;
  n.writeUint(t, r, i), r += 4;
  for (var a = 0; a < e.length; a++) {
    var s = de._writeIFD(n, de._types.basic, t, i, e[a]);
    i = s[1], a < e.length - 1 && (i & 3 && (i += 4 - (i & 3)), n.writeUint(t, s[0], i));
  }
  return t.slice(0, i).buffer;
};
de.decode = function(e, t) {
  t == null && (t = {
    parseMN: !0,
    debug: !1
  });
  var r = new Uint8Array(e), n = 0, i = de._binBE.readASCII(r, n, 2);
  n += 2;
  var a = i == "II" ? de._binLE : de._binBE;
  a.readUshort(r, n), n += 2;
  var s = a.readUint(r, n);
  n += 4;
  for (var o = []; ; ) {
    var u = a.readUshort(r, s), l = a.readUshort(r, s + 4);
    if (u != 0 && (l < 1 || 13 < l)) {
      log("error in TIFF");
      break;
    }
    if (de._readIFD(a, r, s, o, 0, t), s = a.readUint(r, s + 2 + u * 12), s == 0) break;
  }
  return o;
};
de.decodeImage = function(e, t, r) {
  if (!t.data) {
    var n = new Uint8Array(e), i = de._binBE.readASCII(n, 0, 2);
    if (t.t256 != null) {
      t.isLE = i == "II", t.width = t.t256[0], t.height = t.t257[0];
      var a = t.t259 ? t.t259[0] : 1, s = t.t266 ? t.t266[0] : 1;
      t.t284 && t.t284[0] == 2 && log("PlanarConfiguration 2 should not be used!"), a == 7 && t.t258 && t.t258.length > 3 && (t.t258 = t.t258.slice(0, 3));
      var o = t.t277 ? t.t277[0] : 1, u = t.t258 ? t.t258[0] : 1, l = u * o;
      a == 1 && t.t279 != null && t.t278 && t.t262[0] == 32803 && (l = Math.round(t.t279[0] * 8 / (t.width * t.t278[0]))), t.t50885 && t.t50885[0] == 4 && (l = t.t258[0] * 3);
      var c = Math.ceil(t.width * l / 8) * 8, f = t.t273;
      (f == null || t.t322) && (f = t.t324);
      var h = t.t279;
      a == 1 && f.length == 1 && (h = [t.height * (c >>> 3)]), (h == null || t.t322) && (h = t.t325);
      var d = new Uint8Array(t.height * (c >>> 3)), g = 0;
      if (t.t322 != null) {
        var v = t.t322[0], m = t.t323[0], p = Math.floor((t.width + v - 1) / v), y = Math.floor((t.height + m - 1) / m), w = new Uint8Array(Math.ceil(v * m * l / 8) | 0);
        console.log("====", p, y);
        for (var x = 0; x < y; x++) for (var b = 0; b < p; b++) {
          var M = x * p + b;
          w.fill(0), de.decode._decompress(t, r, n, f[M], h[M], a, w, 0, s, v, m), a == 6 ? d = w : de._copyTile(w, Math.ceil(v * l / 8) | 0, m, d, Math.ceil(t.width * l / 8) | 0, t.height, Math.ceil(b * v * l / 8) | 0, x * m);
        }
        g = d.length * 8;
      } else {
        if (f == null) return;
        var k = t.t278 ? t.t278[0] : t.height;
        k = Math.min(k, t.height);
        for (var M = 0; M < f.length; M++)
          de.decode._decompress(t, r, n, f[M], h[M], a, d, Math.ceil(g / 8) | 0, s, t.width, k), g += c * k;
        g = Math.min(g, d.length * 8);
      }
      t.data = new Uint8Array(d.buffer, 0, Math.ceil(g / 8) | 0);
    }
  }
};
de.decode._decompress = function(e, t, r, n, i, a, s, o, u, l, c) {
  if (e.t271 && e.t271[0] == "Panasonic" && e.t45 && e.t45[0] == 6 && (a = 34316), a == 1) for (var f = 0; f < i; f++) s[o + f] = r[n + f];
  else if (a == 2) de.decode._decodeG2(r, n, i, s, o, l, u);
  else if (a == 3) de.decode._decodeG3(r, n, i, s, o, l, u, e.t292 ? (e.t292[0] & 1) == 1 : !1);
  else if (a == 4) de.decode._decodeG4(r, n, i, s, o, l, u);
  else if (a == 5) de.decode._decodeLZW(r, n, i, s, o, 8);
  else if (a == 6) de.decode._decodeOldJPEG(e, r, n, i, s, o);
  else if (a == 7 || a == 34892) de.decode._decodeNewJPEG(e, r, n, i, s, o);
  else if (a == 8 || a == 32946) {
    var h = new Uint8Array(r.buffer, n + 2, i - 6), d = de._inflateRaw(h);
    o + d.length <= s.length && s.set(d, o);
  } else a == 9 ? de.decode._decodeVC5(r, n, i, s, o, e.t33422) : a == 32767 ? de.decode._decodeARW(e, r, n, i, s, o) : a == 32773 ? de.decode._decodePackBits(r, n, i, s, o) : a == 32809 ? de.decode._decodeThunder(r, n, i, s, o) : a == 34316 ? de.decode._decodePanasonic(e, r, n, i, s, o) : a == 34713 ? de.decode._decodeNikon(e, t, r, n, i, s, o) : a == 34676 ? de.decode._decodeLogLuv32(e, r, n, i, s, o) : log("Unknown compression", a);
  var g = e.t258 ? Math.min(32, e.t258[0]) : 1, v = e.t277 ? e.t277[0] : 1, m = g * v >>> 3, p = Math.ceil(g * v * l / 8);
  if (g == 16 && !e.isLE && e.t33422 == null)
    for (var y = 0; y < c; y++)
      for (var w = o + y * p, x = 1; x < p; x += 2) {
        var b = s[w + x];
        s[w + x] = s[w + x - 1], s[w + x - 1] = b;
      }
  if (e.t317 && e.t317[0] == 2)
    for (var y = 0; y < c; y++) {
      var M = o + y * p;
      if (g == 16) for (var f = m; f < p; f += 2) {
        var k = (s[M + f + 1] << 8 | s[M + f]) + (s[M + f - m + 1] << 8 | s[M + f - m]);
        s[M + f] = k & 255, s[M + f + 1] = k >>> 8 & 255;
      }
      else if (v == 3) for (var f = 3; f < p; f += 3)
        s[M + f] = s[M + f] + s[M + f - 3] & 255, s[M + f + 1] = s[M + f + 1] + s[M + f - 2] & 255, s[M + f + 2] = s[M + f + 2] + s[M + f - 1] & 255;
      else for (var f = m; f < p; f++) s[M + f] = s[M + f] + s[M + f - m] & 255;
    }
};
de.decode._decodePanasonic = function(e, t, r, n, i, a) {
  var s = t.buffer, o = e.t2[0], u = e.t3[0], l = e.t10[0], c = e.t45[0], f = 0, h = 0, d = 0, g = 0, v = c == 6 ? new Uint32Array(18) : new Uint8Array(16), m, p, y, w = [0, 0], x = [0, 0], b, M = 0, k, E, S, F, O = new Uint8Array(16384), D = new Uint16Array(i.buffer);
  function _(Ae) {
    if (d == 0) {
      var Ce = new Uint8Array(s, r + h + 8184, 8200), Ee = new Uint8Array(s, r + h, 8184);
      O.set(Ce), O.set(Ee, Ce.length), h += 16384;
    }
    if (c == 5)
      for (m = 0; m < 16; m++)
        v[m] = O[d++], d &= 16383;
    else
      return d = d - Ae & 131071, g = d >> 3 ^ 16368, (O[g] | O[g + 1] << 8) >> (d & 7) & ~(-1 << Ae);
  }
  function L(Ae) {
    return O[d + 15 - Ae];
  }
  function G() {
    v[0] = L(0) << 6 | L(1) >> 2, v[1] = ((L(1) & 3) << 12 | L(2) << 4 | L(3) >> 4) & 16383, v[2] = L(3) >> 2 & 3, v[3] = (L(3) & 3) << 8 | L(4), v[4] = L(5) << 2 | L(6) >> 6, v[5] = (L(6) & 63) << 4 | L(7) >> 4, v[6] = L(7) >> 2 & 3, v[7] = (L(7) & 3) << 8 | L(8), v[8] = L(9) << 2 & 1020 | L(10) >> 6, v[9] = (L(10) << 4 | L(11) >> 4) & 1023, v[10] = L(11) >> 2 & 3, v[11] = (L(11) & 3) << 8 | L(12), v[12] = (L(13) << 2 & 1020 | L(14) >> 6) & 1023, v[13] = (L(14) << 4 | L(15) >> 4) & 1023, d += 16, g = 0;
  }
  function V() {
    v[0] = L(0) << 4 | L(1) >> 4, v[1] = ((L(1) & 15) << 8 | L(2)) & 4095, v[2] = L(3) >> 6 & 3, v[3] = (L(3) & 63) << 2 | L(4) >> 6, v[4] = (L(4) & 63) << 2 | L(5) >> 6, v[5] = (L(5) & 63) << 2 | L(6) >> 6, v[6] = L(6) >> 4 & 3, v[7] = (L(6) & 15) << 4 | L(7) >> 4, v[8] = (L(7) & 15) << 4 | L(8) >> 4, v[9] = (L(8) & 15) << 4 | L(9) >> 4, v[10] = L(9) >> 2 & 3, v[11] = (L(9) & 3) << 6 | L(10) >> 2, v[12] = (L(10) & 3) << 6 | L(11) >> 2, v[13] = (L(11) & 3) << 6 | L(12) >> 2, v[14] = L(12) & 3, v[15] = L(13), v[16] = L(14), v[17] = L(15), d += 16, g = 0;
  }
  function H() {
    w[0] = 0, w[1] = 0, x[0] = 0, x[1] = 0;
  }
  if (c == 7)
    throw c;
  if (c == 6) {
    var U = l == 12, R = U ? V : G, B = U ? 14 : 11, C = U ? 128 : 512, Z = U ? 2048 : 8192, W = U ? 16383 : 65535, J = U ? 4095 : 16383, Q = o / B, j = Q * 16, q = U ? 18 : 14;
    for (E = 0; E < u - 15; E += 16) {
      var ae = Math.min(16, u - E), pe = j * ae;
      for (O = new Uint8Array(s, r + f, pe), d = 0, f += pe, F = 0, S = 0; F < ae; F++, S = 0) {
        M = (E + F) * o;
        for (var $ = 0; $ < Q; $++)
          for (R(), H(), y = 0, k = 0, m = 0; m < B; m++) {
            if (b = m & 1, m % 3 == 2) {
              var se = g < q ? v[g++] : 0;
              se == 3 && (se = 4), k = C << se, y = 1 << se;
            }
            var ve = g < q ? v[g++] : 0;
            w[b] ? (ve *= y, k < Z && x[b] > k && (ve += x[b] - k), x[b] = ve) : (w[b] = ve, ve ? x[b] = ve : ve = x[b]), D[M + S++] = ve - 15 <= W ? ve - 15 & W : ve + 2147483633 >> 31 & J;
          }
      }
    }
  } else if (c == 5) {
    var me = l == 12 ? 10 : 9;
    for (E = 0; E < u; E++)
      for (S = 0; S < o; S += me)
        _(0), l == 12 ? (D[M++] = ((v[1] & 15) << 8) + v[0], D[M++] = 16 * v[2] + (v[1] >> 4), D[M++] = ((v[4] & 15) << 8) + v[3], D[M++] = 16 * v[5] + (v[4] >> 4), D[M++] = ((v[7] & 15) << 8) + v[6], D[M++] = 16 * v[8] + (v[7] >> 4), D[M++] = ((v[10] & 15) << 8) + v[9], D[M++] = 16 * v[11] + (v[10] >> 4), D[M++] = ((v[13] & 15) << 8) + v[12], D[M++] = 16 * v[14] + (v[13] >> 4)) : l == 14 && (D[M++] = v[0] + ((v[1] & 63) << 8), D[M++] = (v[1] >> 6) + 4 * v[2] + ((v[3] & 15) << 10), D[M++] = (v[3] >> 4) + 16 * v[4] + ((v[5] & 3) << 12), D[M++] = ((v[5] & 252) >> 2) + (v[6] << 6), D[M++] = v[7] + ((v[8] & 63) << 8), D[M++] = (v[8] >> 6) + 4 * v[9] + ((v[10] & 15) << 10), D[M++] = (v[10] >> 4) + 16 * v[11] + ((v[12] & 3) << 12), D[M++] = ((v[12] & 252) >> 2) + (v[13] << 6), D[M++] = v[14] + ((v[15] & 63) << 8));
  } else if (c == 4)
    for (E = 0; E < u; E++)
      for (S = 0; S < o; S++)
        m = S % 14, b = m & 1, m == 0 && H(), m % 3 == 2 && (y = 4 >> 3 - _(2)), x[b] ? (p = _(8), p != 0 && (w[b] -= 128 << y, (w[b] < 0 || y == 4) && (w[b] &= ~(-1 << y)), w[b] += p << y)) : (x[b] = _(8), (x[b] || m > 11) && (w[b] = x[b] << 4 | _(4))), D[M++] = w[S & 1];
  else throw c;
};
de.decode._decodeVC5 = function() {
  var e = [1, 0, 1, 0, 2, 2, 1, 1, 3, 7, 1, 2, 5, 25, 1, 3, 6, 48, 1, 4, 6, 54, 1, 5, 7, 111, 1, 8, 7, 99, 1, 6, 7, 105, 12, 0, 7, 107, 1, 7, 8, 209, 20, 0, 8, 212, 1, 9, 8, 220, 1, 10, 9, 393, 1, 11, 9, 394, 32, 0, 9, 416, 1, 12, 9, 427, 1, 13, 10, 887, 1, 18, 10, 784, 1, 14, 10, 790, 1, 15, 10, 835, 60, 0, 10, 852, 1, 16, 10, 885, 1, 17, 11, 1571, 1, 19, 11, 1668, 1, 20, 11, 1669, 100, 0, 11, 1707, 1, 21, 11, 1772, 1, 22, 12, 3547, 1, 29, 12, 3164, 1, 24, 12, 3166, 1, 25, 12, 3140, 1, 23, 12, 3413, 1, 26, 12, 3537, 1, 27, 12, 3539, 1, 28, 13, 7093, 1, 35, 13, 6283, 1, 30, 13, 6331, 1, 31, 13, 6335, 180, 0, 13, 6824, 1, 32, 13, 7072, 1, 33, 13, 7077, 320, 0, 13, 7076, 1, 34, 14, 12565, 1, 36, 14, 12661, 1, 37, 14, 12669, 1, 38, 14, 13651, 1, 39, 14, 14184, 1, 40, 15, 28295, 1, 46, 15, 28371, 1, 47, 15, 25320, 1, 42, 15, 25336, 1, 43, 15, 25128, 1, 41, 15, 27300, 1, 44, 15, 28293, 1, 45, 16, 50259, 1, 48, 16, 50643, 1, 49, 16, 50675, 1, 50, 16, 56740, 1, 53, 16, 56584, 1, 51, 16, 56588, 1, 52, 17, 113483, 1, 61, 17, 113482, 1, 60, 17, 101285, 1, 55, 17, 101349, 1, 56, 17, 109205, 1, 57, 17, 109207, 1, 58, 17, 100516, 1, 54, 17, 113171, 1, 59, 18, 202568, 1, 62, 18, 202696, 1, 63, 18, 218408, 1, 64, 18, 218412, 1, 65, 18, 226340, 1, 66, 18, 226356, 1, 67, 18, 226358, 1, 68, 19, 402068, 1, 69, 19, 405138, 1, 70, 19, 405394, 1, 71, 19, 436818, 1, 72, 19, 436826, 1, 73, 19, 452714, 1, 75, 19, 452718, 1, 76, 19, 452682, 1, 74, 20, 804138, 1, 77, 20, 810279, 1, 78, 20, 810790, 1, 79, 20, 873638, 1, 80, 20, 873654, 1, 81, 20, 905366, 1, 82, 20, 905430, 1, 83, 20, 905438, 1, 84, 21, 1608278, 1, 85, 21, 1620557, 1, 86, 21, 1621582, 1, 87, 21, 1621583, 1, 88, 21, 1747310, 1, 89, 21, 1810734, 1, 90, 21, 1810735, 1, 91, 21, 1810863, 1, 92, 21, 1810879, 1, 93, 22, 3621725, 1, 99, 22, 3621757, 1, 100, 22, 3241112, 1, 94, 22, 3494556, 1, 95, 22, 3494557, 1, 96, 22, 3494622, 1, 97, 22, 3494623, 1, 98, 23, 6482227, 1, 102, 23, 6433117, 1, 101, 23, 6989117, 1, 103, 23, 6989119, 1, 105, 23, 6989118, 1, 104, 23, 7243449, 1, 106, 23, 7243512, 1, 107, 24, 13978233, 1, 111, 24, 12964453, 1, 109, 24, 12866232, 1, 108, 24, 14486897, 1, 113, 24, 13978232, 1, 110, 24, 14486896, 1, 112, 24, 14487026, 1, 114, 24, 14487027, 1, 115, 25, 25732598, 1, 225, 25, 25732597, 1, 189, 25, 25732596, 1, 188, 25, 25732595, 1, 203, 25, 25732594, 1, 202, 25, 25732593, 1, 197, 25, 25732592, 1, 207, 25, 25732591, 1, 169, 25, 25732590, 1, 223, 25, 25732589, 1, 159, 25, 25732522, 1, 235, 25, 25732579, 1, 152, 25, 25732575, 1, 192, 25, 25732489, 1, 179, 25, 25732573, 1, 201, 25, 25732472, 1, 172, 25, 25732576, 1, 149, 25, 25732488, 1, 178, 25, 25732566, 1, 120, 25, 25732571, 1, 219, 25, 25732577, 1, 150, 25, 25732487, 1, 127, 25, 25732506, 1, 211, 25, 25732548, 1, 125, 25, 25732588, 1, 158, 25, 25732486, 1, 247, 25, 25732467, 1, 238, 25, 25732508, 1, 163, 25, 25732552, 1, 228, 25, 25732603, 1, 183, 25, 25732513, 1, 217, 25, 25732587, 1, 168, 25, 25732520, 1, 122, 25, 25732484, 1, 128, 25, 25732562, 1, 249, 25, 25732505, 1, 187, 25, 25732504, 1, 186, 25, 25732483, 1, 136, 25, 25928905, 1, 181, 25, 25732560, 1, 255, 25, 25732500, 1, 230, 25, 25732482, 1, 135, 25, 25732555, 1, 233, 25, 25732568, 1, 222, 25, 25732583, 1, 145, 25, 25732481, 1, 134, 25, 25732586, 1, 167, 25, 25732521, 1, 248, 25, 25732518, 1, 209, 25, 25732480, 1, 243, 25, 25732512, 1, 216, 25, 25732509, 1, 164, 25, 25732547, 1, 140, 25, 25732479, 1, 157, 25, 25732544, 1, 239, 25, 25732574, 1, 191, 25, 25732564, 1, 251, 25, 25732478, 1, 156, 25, 25732546, 1, 139, 25, 25732498, 1, 242, 25, 25732557, 1, 133, 25, 25732477, 1, 162, 25, 25732515, 1, 213, 25, 25732584, 1, 165, 25, 25732514, 1, 212, 25, 25732476, 1, 227, 25, 25732494, 1, 198, 25, 25732531, 1, 236, 25, 25732530, 1, 234, 25, 25732529, 1, 117, 25, 25732528, 1, 215, 25, 25732527, 1, 124, 25, 25732526, 1, 123, 25, 25732525, 1, 254, 25, 25732524, 1, 253, 25, 25732523, 1, 148, 25, 25732570, 1, 218, 25, 25732580, 1, 146, 25, 25732581, 1, 147, 25, 25732569, 1, 224, 25, 25732533, 1, 143, 25, 25732540, 1, 184, 25, 25732541, 1, 185, 25, 25732585, 1, 166, 25, 25732556, 1, 132, 25, 25732485, 1, 129, 25, 25732563, 1, 250, 25, 25732578, 1, 151, 25, 25732501, 1, 119, 25, 25732502, 1, 193, 25, 25732536, 1, 176, 25, 25732496, 1, 245, 25, 25732553, 1, 229, 25, 25732516, 1, 206, 25, 25732582, 1, 144, 25, 25732517, 1, 208, 25, 25732558, 1, 137, 25, 25732543, 1, 241, 25, 25732466, 1, 237, 25, 25732507, 1, 190, 25, 25732542, 1, 240, 25, 25732551, 1, 131, 25, 25732554, 1, 232, 25, 25732565, 1, 252, 25, 25732475, 1, 171, 25, 25732493, 1, 205, 25, 25732492, 1, 204, 25, 25732491, 1, 118, 25, 25732490, 1, 214, 25, 25928904, 1, 180, 25, 25732549, 1, 126, 25, 25732602, 1, 182, 25, 25732539, 1, 175, 25, 25732545, 1, 141, 25, 25732559, 1, 138, 25, 25732537, 1, 177, 25, 25732534, 1, 153, 25, 25732503, 1, 194, 25, 25732606, 1, 160, 25, 25732567, 1, 121, 25, 25732538, 1, 174, 25, 25732497, 1, 246, 25, 25732550, 1, 130, 25, 25732572, 1, 200, 25, 25732474, 1, 170, 25, 25732511, 1, 221, 25, 25732601, 1, 196, 25, 25732532, 1, 142, 25, 25732519, 1, 210, 25, 25732495, 1, 199, 25, 25732605, 1, 155, 25, 25732535, 1, 154, 25, 25732499, 1, 244, 25, 25732510, 1, 220, 25, 25732600, 1, 195, 25, 25732607, 1, 161, 25, 25732604, 1, 231, 25, 25732473, 1, 173, 25, 25732599, 1, 226, 26, 51465122, 1, 116, 26, 51465123, 0, 1], t, r, n, i = [3, 3, 3, 3, 2, 2, 2, 1, 1, 1], a = 24576, s = 16384, o = 8192, u = s | o;
  function l(y) {
    var w = y[1], x = y[0][w >>> 3] >>> 7 - (w & 7) & 1;
    return y[1]++, x;
  }
  function c(y, w) {
    if (t == null) {
      t = {};
      for (var x = 0; x < e.length; x += 4) t[e[x + 1]] = e.slice(x, x + 4);
    }
    for (var b = l(y), M = t[b]; M == null; )
      b = b << 1 | l(y), M = t[b];
    var k = M[3];
    k != 0 && (k = l(y) == 0 ? k : -k), w[0] = M[2], w[1] = k;
  }
  function f(y, w) {
    for (var x = 0; x < w; x++)
      (y & 1) == 1 && y++, y = y >>> 1;
    return y;
  }
  function h(y, w) {
    return y >> w;
  }
  function d(y, w, x, b, M, k) {
    w[x] = h(h(11 * y[M] - 4 * y[M + k] + y[M + k + k] + 4, 3) + y[b], 1), w[x + k] = h(h(5 * y[M] + 4 * y[M + k] - y[M + k + k] + 4, 3) - y[b], 1);
  }
  function g(y, w, x, b, M, k) {
    var E = y[M - k] - y[M + k], S = y[M], F = y[b];
    w[x] = h(h(E + 4, 3) + S + F, 1), w[x + k] = h(h(-E + 4, 3) + S - F, 1);
  }
  function v(y, w, x, b, M, k) {
    w[x] = h(h(5 * y[M] + 4 * y[M - k] - y[M - k - k] + 4, 3) + y[b], 1), w[x + k] = h(h(11 * y[M] - 4 * y[M - k] + y[M - k - k] + 4, 3) - y[b], 1);
  }
  function m(y) {
    return y = y < 0 ? 0 : y > 4095 ? 4095 : y, y = n[y] >>> 2, y;
  }
  function p(y, w, x, b, M, k) {
    b = new Uint16Array(b.buffer);
    var E = Date.now(), S = de._binBE, F = w + x, O, D, _, L, G, V, H, U, R, B;
    w += 4;
    for (var C = k[0] == 1; w < F; ) {
      var Z = S.readShort(y, w), W = S.readUshort(y, w + 2);
      if (w += 4, Z == 12) O = W;
      else if (Z == 20) D = W;
      else if (Z == 21) _ = W;
      else if (Z == 48) L = W;
      else if (Z == 53) G = W;
      else if (Z != 35) {
        if (Z == 62) V = W;
        else if (Z != 101) {
          if (Z == 109) H = W;
          else if (Z != 84) {
            if (Z != 106) {
              if (Z != 107) {
                if (Z != 108) {
                  if (Z != 102) {
                    if (Z == 104) U = W;
                    else if (Z != 105) {
                      var J = Z < 0 ? -Z : Z, Q = J & 65280, j = 0;
                      if (J & u && (J & o ? (j = W & 65535, j += (J & 255) << 16) : j = W & 65535), (J & a) == a) {
                        if (R == null) {
                          R = [];
                          for (var q = 0; q < 4; q++) R[q] = new Int16Array((D >>> 1) * (_ >>> 1));
                          B = new Int16Array((D >>> 1) * (_ >>> 1)), r = new Int16Array(1024);
                          for (var q = 0; q < 1024; q++) {
                            var ae = q - 512, pe = Math.abs(ae), O = Math.floor(768 * pe * pe * pe / (255 * 255 * 255)) + pe;
                            r[q] = Math.sign(ae) * O;
                          }
                          n = new Uint16Array(4096);
                          for (var $ = 65535, q = 0; q < 4096; q++) {
                            var se = q, ve = $ * (Math.pow(113, se / 4095) - 1) / 112;
                            n[q] = Math.min(ve, $);
                          }
                        }
                        var me = R[V], Ae = f(D, 1 + i[L]), Ce = f(_, 1 + i[L]);
                        if (L == 0)
                          for (var Ee = 0; Ee < Ce; Ee++) for (var Y = 0; Y < Ae; Y++) {
                            var ee = w + (Ee * Ae + Y) * 2;
                            me[Ee * (D >>> 1) + Y] = y[ee] << 8 | y[ee + 1];
                          }
                        else {
                          for (var Me = [y, w * 8], ye = [], De = 0, Se = Ae * Ce, fe = [0, 0], ke = 0, W = 0; De < Se; )
                            for (c(Me, fe), ke = fe[0], W = fe[1]; ke > 0; )
                              ye[De++] = W, ke--;
                          for (var ne = (L - 1) % 3, Te = ne != 1 ? Ae : 0, I = ne != 0 ? Ce : 0, Ee = 0; Ee < Ce; Ee++)
                            for (var A = (Ee + I) * (D >>> 1) + Te, T = Ee * Ae, Y = 0; Y < Ae; Y++) me[A + Y] = r[ye[T + Y] + 512] * G;
                          if (ne == 2) {
                            for (var U = D >>> 1, P = Ae * 2, z = Ce * 2, Ee = 0; Ee < Ce; Ee++)
                              for (var Y = 0; Y < P; Y++) {
                                var q = Ee * 2 * U + Y, K = Ee * U + Y, oe = Ce * U + K;
                                Ee == 0 ? d(me, B, q, oe, K, U) : Ee == Ce - 1 ? v(me, B, q, oe, K, U) : g(me, B, q, oe, K, U);
                              }
                            var ce = me;
                            me = B, B = ce;
                            for (var Ee = 0; Ee < z; Ee++)
                              for (var Y = 0; Y < Ae; Y++) {
                                var q = Ee * U + 2 * Y, K = Ee * U + Y, oe = Ae + K;
                                Y == 0 ? d(me, B, q, oe, K, 1) : Y == Ae - 1 ? v(me, B, q, oe, K, 1) : g(me, B, q, oe, K, 1);
                              }
                            var ce = me;
                            me = B, B = ce;
                            for (var ge = [], Oe = 2 - ~~((L - 1) / 3), Ge = 0; Ge < 3; Ge++) ge[Ge] = H >> 14 - Ge * 2 & 3;
                            var We = ge[Oe];
                            if (We != 0) for (var Ee = 0; Ee < z; Ee++) for (var Y = 0; Y < P; Y++) {
                              var q = Ee * U + Y;
                              me[q] = me[q] << We;
                            }
                          }
                        }
                        if (L == 9 && V == 3)
                          for (var $e = R[0], pt = R[1], tt = R[2], xt = R[3], Ee = 0; Ee < _; Ee += 2) for (var Y = 0; Y < D; Y += 2) {
                            var ht = Ee * D + Y, ee = (Ee >>> 1) * (D >>> 1) + (Y >>> 1), Vt = $e[ee], qe = pt[ee] - 2048, ze = tt[ee] - 2048, He = xt[ee] - 2048, Ht = (qe << 1) + Vt, mt = (ze << 1) + Vt, vt = Vt + He, Ct = Vt - He;
                            C ? (b[ht] = m(vt), b[ht + 1] = m(mt), b[ht + D] = m(Ht), b[ht + D + 1] = m(Ct)) : (b[ht] = m(Ht), b[ht + 1] = m(vt), b[ht + D] = m(Ct), b[ht + D + 1] = m(mt));
                          }
                        w += j * 4;
                      } else if (J == 16388)
                        w += j * 4;
                      else if (!(Q == 8192 || Q == 8448 || Q == 9216)) throw J.toString(16);
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    console.log(Date.now() - E);
  }
  return p;
}();
de.decode._decodeLogLuv32 = function(e, t, r, n, i, a) {
  for (var s = e.width, o = s * 4, u = 0, l = new Uint8Array(o); u < n; ) {
    for (var c = 0; c < o; ) {
      var f = t[r + u];
      if (u++, f < 128) {
        for (var h = 0; h < f; h++) l[c + h] = t[r + u + h];
        c += f, u += f;
      } else {
        f = f - 126;
        for (var h = 0; h < f; h++) l[c + h] = t[r + u];
        c += f, u++;
      }
    }
    for (var d = 0; d < s; d++)
      i[a + 0] = l[d], i[a + 1] = l[d + s], i[a + 2] = l[d + s * 2], i[a + 4] = l[d + s * 3], a += 6;
  }
};
de.decode._ljpeg_diff = function(e, t, r) {
  var n = de.decode._getbithuff, i, a;
  return i = n(e, t, r[0], r), a = n(e, t, i, 0), a & 1 << i - 1 || (a -= (1 << i) - 1), a;
};
de.decode._decodeARW = function(e, t, r, n, i, a) {
  var s = e.t256[0], o = e.t257[0], u = e.t258[0], l = e.isLE ? de._binLE : de._binBE, c = s * o == n || s * o * 1.5 == n;
  if (!c) {
    o += 8;
    var f = [r, 0, 0, 0], h = new Uint16Array(32770), d = [3857, 3856, 3599, 3342, 3085, 2828, 2571, 2314, 2057, 1800, 1543, 1286, 1029, 772, 771, 768, 514, 513], H, g, v, S, E, m = 0, p = de.decode._ljpeg_diff;
    for (h[0] = 15, v = H = 0; H < 18; H++)
      for (var y = 32768 >>> (d[H] >>> 8), g = 0; g < y; g++) h[++v] = d[H];
    for (S = s; S--; ) for (E = 0; E < o + 1; E += 2)
      if (E == o && (E = 1), m += p(t, f, h), E < o) {
        var w = m & 4095;
        de.decode._putsF(i, (E * s + S) * u, w << 16 - u);
      }
    return;
  }
  if (s * o * 1.5 == n) {
    for (var H = 0; H < n; H += 3) {
      var x = t[r + H + 0], b = t[r + H + 1], M = t[r + H + 2];
      i[a + H] = b << 4 | x >>> 4, i[a + H + 1] = x << 4 | M >>> 4, i[a + H + 2] = M << 4 | b >>> 4;
    }
    return;
  }
  var k = new Uint16Array(16), E, S, F, O, D, _, L, G, V, H, U, R = new Uint8Array(s + 1);
  for (E = 0; E < o; E++) {
    for (var B = 0; B < s; B++) R[B] = t[r++];
    for (U = 0, S = 0; S < s - 30; U += 16) {
      for (O = 2047 & (F = l.readUint(R, U)), D = 2047 & F >>> 11, _ = 15 & F >>> 22, L = 15 & F >>> 26, G = 0; G < 4 && 128 << G <= O - D; G++) ;
      for (V = 30, H = 0; H < 16; H++) H == _ ? k[H] = O : H == L ? k[H] = D : (k[H] = ((l.readUshort(R, U + (V >> 3)) >>> (V & 7) & 127) << G) + D, k[H] > 2047 && (k[H] = 2047), V += 7);
      for (H = 0; H < 16; H++, S += 2) {
        var w = k[H] << 1;
        de.decode._putsF(i, (E * s + S) * u, w << 16 - u);
      }
      S -= S & 1 ? 1 : 31;
    }
  }
};
de.decode._decodeNikon = function(e, t, r, n, i, a, s) {
  var o = [[
    0,
    0,
    1,
    5,
    1,
    1,
    1,
    1,
    1,
    1,
    2,
    0,
    0,
    0,
    0,
    0,
    0,
    /* 12-bit lossy */
    5,
    4,
    3,
    6,
    2,
    7,
    1,
    0,
    8,
    9,
    11,
    10,
    12
  ], [
    0,
    0,
    1,
    5,
    1,
    1,
    1,
    1,
    1,
    1,
    2,
    0,
    0,
    0,
    0,
    0,
    0,
    /* 12-bit lossy after split */
    57,
    90,
    56,
    39,
    22,
    5,
    4,
    3,
    2,
    1,
    0,
    11,
    12,
    12
  ], [
    0,
    0,
    1,
    4,
    2,
    3,
    1,
    2,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    /* 12-bit lossless */
    5,
    4,
    6,
    3,
    7,
    2,
    8,
    1,
    9,
    0,
    10,
    11,
    12
  ], [
    0,
    0,
    1,
    4,
    3,
    1,
    1,
    1,
    1,
    1,
    2,
    0,
    0,
    0,
    0,
    0,
    0,
    /* 14-bit lossy */
    5,
    6,
    4,
    7,
    8,
    3,
    9,
    2,
    1,
    0,
    10,
    11,
    12,
    13,
    14
  ], [
    0,
    0,
    1,
    5,
    1,
    1,
    1,
    1,
    1,
    1,
    1,
    2,
    0,
    0,
    0,
    0,
    0,
    /* 14-bit lossy after split */
    8,
    92,
    75,
    58,
    41,
    7,
    6,
    5,
    4,
    3,
    2,
    1,
    0,
    13,
    14
  ], [
    0,
    0,
    1,
    4,
    2,
    2,
    3,
    1,
    2,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    /* 14-bit lossless */
    7,
    6,
    8,
    5,
    9,
    4,
    10,
    3,
    11,
    12,
    2,
    0,
    1,
    13,
    14
  ]], u = e.t256[0], l = e.t257[0], c = e.t258[0], f = 0, h = 0, d = de.decode._make_decoder, g = de.decode._getbithuff, v = t[0].exifIFD.makerNote, m = v.t150 ? v.t150 : v.t140, p = 0, y = m[p++], w = m[p++];
  (y == 73 || w == 88) && (p += 2110), y == 70 && (f = 2), c == 14 && (f += 3);
  for (var x = [[0, 0], [0, 0]], b = e.isLE ? de._binLE : de._binBE, F = 0; F < 2; F++) for (var M = 0; M < 2; M++)
    x[F][M] = b.readShort(m, p), p += 2;
  var k = 1 << c & 32767, E = 0, S = b.readShort(m, p);
  p += 2, S > 1 && (E = Math.floor(k / (S - 1))), y == 68 && w == 32 && E > 0 && (h = b.readShort(m, 562));
  var F, O, D, _, L, G, V = [0, 0], H = d(o[f]), U = [n, 0, 0, 0];
  for (O = 0; O < l; O++)
    for (h && O == h && (H = d(o[f + 1])), D = 0; D < u; D++) {
      F = g(r, U, H[0], H), _ = F & 15, L = F >>> 4, G = (g(r, U, _ - L, 0) << 1) + 1 << L >>> 1, G & 1 << _ - 1 || (G -= (1 << _) - (L == 0 ? 1 : 0)), D < 2 ? V[D] = x[O & 1][D] += G : V[D & 1] += G;
      var R = Math.min(Math.max(V[D & 1], 0), (1 << c) - 1), B = (O * u + D) * c;
      de.decode._putsF(a, B, R << 16 - c);
    }
};
de.decode._putsF = function(e, t, r) {
  r = r << 8 - (t & 7);
  var n = t >>> 3;
  e[n] |= r >>> 16, e[n + 1] |= r >>> 8, e[n + 2] |= r;
};
de.decode._getbithuff = function(e, t, r, n) {
  var i = 0;
  de.decode._get_byte;
  var a, s = t[0], o = t[1], u = t[2], l = t[3];
  if (r == 0 || u < 0) return 0;
  for (; !l && u < r && (a = e[s++]) != -1 && !(l = i); )
    o = (o << 8) + a, u += 8;
  if (a = o << 32 - u >>> 32 - r, n ? (u -= n[a + 1] >>> 8, a = n[a + 1] & 255) : u -= r, u < 0) throw "e";
  return t[0] = s, t[1] = o, t[2] = u, t[3] = l, a;
};
de.decode._make_decoder = function(e) {
  var t, r, n, i, a, s = [];
  for (t = 16; t != 0 && !e[t]; t--) ;
  var o = 17;
  for (s[0] = t, n = r = 1; r <= t; r++) for (i = 0; i < e[r]; i++, ++o) for (a = 0; a < 1 << t - r; a++) n <= 1 << t && (s[n++] = r << 8 | e[o]);
  return s;
};
de.decode._decodeNewJPEG = function(e, t, r, n, i, a) {
  n = Math.min(n, t.length - r);
  var s = e.t347, o = s ? s.length : 0, u = new Uint8Array(o + n);
  if (s) {
    for (var l = 216, c = 217, f = 0, h = 0; h < o - 1 && !(s[h] == 255 && s[h + 1] == c); h++)
      u[f++] = s[h];
    var d = t[r], g = t[r + 1];
    (d != 255 || g != l) && (u[f++] = d, u[f++] = g);
    for (var h = 2; h < n; h++) u[f++] = t[r + h];
  } else for (var h = 0; h < n; h++) u[h] = t[r + h];
  if (e.t262[0] == 32803 || e.t259[0] == 7 && e.t262[0] == 34892) {
    var v = e.t258[0], m = de.LosslessJpegDecode(u), p = m.length;
    if (v == 16)
      if (e.isLE) for (var h = 0; h < p; h++)
        i[a + (h << 1)] = m[h] & 255, i[a + (h << 1) + 1] = m[h] >>> 8;
      else for (var h = 0; h < p; h++)
        i[a + (h << 1)] = m[h] >>> 8, i[a + (h << 1) + 1] = m[h] & 255;
    else if (v == 14 || v == 12 || v == 10)
      for (var y = 16 - v, h = 0; h < p; h++) de.decode._putsF(i, h * v, m[h] << y);
    else if (v == 8)
      for (var h = 0; h < p; h++) i[a + h] = m[h];
    else throw new Error("unsupported bit depth " + v);
  } else {
    var w = new de.JpegDecoder();
    w.parse(u);
    for (var x = w.getData({
      width: w.width,
      height: w.height,
      forceRGB: !0,
      isSourcePDF: !1
    }), h = 0; h < x.length; h++) i[a + h] = x[h];
  }
  e.t262[0] == 6 && (e.t262[0] = 2);
};
de.decode._decodeOldJPEGInit = function(e, t, r, n) {
  var i = 216, a = 219, s = 196, o = 221, u = 192, l = 218, c = 0, f = 0, h, d, g = !1, v, m, p, y = e.t513, w = y ? y[0] : 0, x = e.t514, b = x ? x[0] : 0, M = e.t324 || e.t273 || y, k = e.t530, E = 0, S = 0, F = e.t277 ? e.t277[0] : 1, O = e.t515;
  if (M && (f = M[0], g = M.length > 1), !g) {
    if (t[r] == 255 && t[r + 1] == i) return {
      jpegOffset: r
    };
    if (y != null && (t[r + w] == 255 && t[r + w + 1] == i ? c = r + w : log("JPEGInterchangeFormat does not point to SOI"), x == null ? log("JPEGInterchangeFormatLength field is missing") : (w >= f || w + b <= f) && log("JPEGInterchangeFormatLength field value is invalid"), c != null))
      return {
        jpegOffset: c
      };
  }
  if (k != null && (E = k[0], S = k[1]), y != null && x != null) if (b >= 2 && w + b <= f) {
    for (t[r + w + b - 2] == 255 && t[r + w + b - 1] == i ? h = new Uint8Array(b - 2) : h = new Uint8Array(b), v = 0; v < h.length; v++) h[v] = t[r + w + v];
    log("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables");
  } else log("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");
  if (h == null) {
    var D = 0, _ = [];
    _[D++] = 255, _[D++] = i;
    var L = e.t519;
    if (L == null) throw new Error("JPEGQTables tag is missing");
    for (v = 0; v < L.length; v++)
      for (_[D++] = 255, _[D++] = a, _[D++] = 0, _[D++] = 67, _[D++] = v, m = 0; m < 64; m++) _[D++] = t[r + L[v] + m];
    for (p = 0; p < 2; p++) {
      var G = e[p == 0 ? "t520" : "t521"];
      if (G == null) throw new Error((p == 0 ? "JPEGDCTables" : "JPEGACTables") + " tag is missing");
      for (v = 0; v < G.length; v++) {
        _[D++] = 255, _[D++] = s;
        var V = 19;
        for (m = 0; m < 16; m++) V += t[r + G[v] + m];
        for (_[D++] = V >>> 8, _[D++] = V & 255, _[D++] = v | p << 4, m = 0; m < 16; m++) _[D++] = t[r + G[v] + m];
        for (m = 0; m < V; m++) _[D++] = t[r + G[v] + 16 + m];
      }
    }
    if (_[D++] = 255, _[D++] = u, _[D++] = 0, _[D++] = 8 + 3 * F, _[D++] = 8, _[D++] = e.height >>> 8 & 255, _[D++] = e.height & 255, _[D++] = e.width >>> 8 & 255, _[D++] = e.width & 255, _[D++] = F, F == 1)
      _[D++] = 1, _[D++] = 17, _[D++] = 0;
    else for (v = 0; v < 3; v++)
      _[D++] = v + 1, _[D++] = v != 0 ? 17 : (E & 15) << 4 | S & 15, _[D++] = v;
    O != null && O[0] != 0 && (_[D++] = 255, _[D++] = o, _[D++] = 0, _[D++] = 4, _[D++] = O[0] >>> 8 & 255, _[D++] = O[0] & 255), h = new Uint8Array(_);
  }
  var H = -1;
  for (v = 0; v < h.length - 1; ) {
    if (h[v] == 255 && h[v + 1] == u) {
      H = v;
      break;
    }
    v++;
  }
  if (H == -1) {
    var U = new Uint8Array(h.length + 10 + 3 * F);
    U.set(h);
    var R = h.length;
    if (H = h.length, h = U, h[R++] = 255, h[R++] = u, h[R++] = 0, h[R++] = 8 + 3 * F, h[R++] = 8, h[R++] = e.height >>> 8 & 255, h[R++] = e.height & 255, h[R++] = e.width >>> 8 & 255, h[R++] = e.width & 255, h[R++] = F, F == 1)
      h[R++] = 1, h[R++] = 17, h[R++] = 0;
    else for (v = 0; v < 3; v++)
      h[R++] = v + 1, h[R++] = v != 0 ? 17 : (E & 15) << 4 | S & 15, h[R++] = v;
  }
  if (t[f] == 255 && t[f + 1] == l) {
    var B = t[f + 2] << 8 | t[f + 3];
    for (d = new Uint8Array(B + 2), d[0] = t[f], d[1] = t[f + 1], d[2] = t[f + 2], d[3] = t[f + 3], v = 0; v < B - 2; v++) d[v + 4] = t[f + v + 4];
  } else {
    d = new Uint8Array(8 + 2 * F);
    var C = 0;
    if (d[C++] = 255, d[C++] = l, d[C++] = 0, d[C++] = 6 + 2 * F, d[C++] = F, F == 1)
      d[C++] = 1, d[C++] = 0;
    else for (v = 0; v < 3; v++)
      d[C++] = v + 1, d[C++] = v << 4 | v;
    d[C++] = 0, d[C++] = 63, d[C++] = 0;
  }
  return {
    jpegOffset: r,
    tables: h,
    sosMarker: d,
    sofPosition: H
  };
};
de.decode._decodeOldJPEG = function(e, t, r, n, i, a) {
  var s, o, u, l, c, f = de.decode._decodeOldJPEGInit(e, t, r, n);
  if (f.jpegOffset != null)
    for (o = r + n - f.jpegOffset, l = new Uint8Array(o), s = 0; s < o; s++) l[s] = t[f.jpegOffset + s];
  else {
    for (u = f.tables.length, l = new Uint8Array(u + f.sosMarker.length + n + 2), l.set(f.tables), c = u, l[f.sofPosition + 5] = e.height >>> 8 & 255, l[f.sofPosition + 6] = e.height & 255, l[f.sofPosition + 7] = e.width >>> 8 & 255, l[f.sofPosition + 8] = e.width & 255, (t[r] != 255 || t[r + 1] != SOS) && (l.set(f.sosMarker, c), c += sosMarker.length), s = 0; s < n; s++) l[c++] = t[r + s];
    l[c++] = 255, l[c++] = EOI;
  }
  var h = new de.JpegDecoder();
  h.parse(l);
  for (var d = h.getData({
    width: h.width,
    height: h.height,
    forceRGB: !0,
    isSourcePDF: !1
  }), s = 0; s < d.length; s++) i[a + s] = d[s];
  e.t262 && e.t262[0] == 6 && (e.t262[0] = 2);
};
de.decode._decodePackBits = function(e, t, r, n, i) {
  for (var a = new Int8Array(e.buffer), s = new Int8Array(n.buffer), o = t + r; t < o; ) {
    var u = a[t];
    if (t++, u >= 0 && u < 128) for (var l = 0; l < u + 1; l++)
      s[i] = a[t], i++, t++;
    if (u >= -127 && u < 0) {
      for (var l = 0; l < -u + 1; l++)
        s[i] = a[t], i++;
      t++;
    }
  }
  return i;
};
de.decode._decodeThunder = function(e, t, r, n, i) {
  for (var a = [0, 1, 0, -1], s = [0, 1, 2, 3, 0, -3, -2, -1], o = t + r, u = i * 2, l = 0; t < o; ) {
    var c = e[t], f = c >>> 6, h = c & 63;
    if (t++, f == 3 && (l = h & 15, n[u >>> 1] |= l << 4 * (1 - u & 1), u++), f == 0) for (var d = 0; d < h; d++)
      n[u >>> 1] |= l << 4 * (1 - u & 1), u++;
    if (f == 2) for (var d = 0; d < 2; d++) {
      var g = h >>> 3 * (1 - d) & 7;
      g != 4 && (l += s[g], n[u >>> 1] |= l << 4 * (1 - u & 1), u++);
    }
    if (f == 1) for (var d = 0; d < 3; d++) {
      var g = h >>> 2 * (2 - d) & 3;
      g != 2 && (l += a[g], n[u >>> 1] |= l << 4 * (1 - u & 1), u++);
    }
  }
};
de.decode._dmap = {
  1: 0,
  "011": 1,
  "000011": 2,
  "0000011": 3,
  "010": -1,
  "000010": -2,
  "0000010": -3
};
de.decode._lens = function() {
  var e = function(l, c, f, h) {
    for (var d = 0; d < c.length; d++) l[c[d]] = f + d * h;
  }, t = "00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100", r = "0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111", n = "11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011", i = "0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101", a = "00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";
  t = t.split(","), r = r.split(","), n = n.split(","), i = i.split(","), a = a.split(",");
  var s = {}, o = {};
  return e(s, t, 0, 1), e(s, n, 64, 64), e(s, a, 1792, 64), e(o, r, 0, 1), e(o, i, 64, 64), e(o, a, 1792, 64), [s, o];
}();
de.decode._decodeG4 = function(e, t, r, n, i, a, s) {
  for (var o = de.decode, u = t << 3, l = 0, c = "", f = [], h = [], d = 0; d < a; d++) h.push(0);
  h = o._makeDiff(h);
  for (var g = 0, v = 0, m = 0, p = 0, y = 0, w = 0, x = "", b = 0, M = Math.ceil(a / 8) * 8; u >>> 3 < t + r; ) {
    m = o._findDiff(h, g + (g == 0 ? 0 : 1), 1 - y), p = o._findDiff(h, m, y);
    var k = 0;
    if (s == 1 && (k = e[u >>> 3] >>> 7 - (u & 7) & 1), s == 2 && (k = e[u >>> 3] >>> (u & 7) & 1), u++, c += k, x == "H") {
      if (o._lens[y][c] != null) {
        var E = o._lens[y][c];
        c = "", l += E, E < 64 && (o._addNtimes(f, l, y), g += l, y = 1 - y, l = 0, b--, b == 0 && (x = ""));
      }
    } else
      c == "0001" && (c = "", o._addNtimes(f, p - g, y), g = p), c == "001" && (c = "", x = "H", b = 2), o._dmap[c] != null && (v = m + o._dmap[c], o._addNtimes(f, v - g, y), g = v, c = "", y = 1 - y);
    f.length == a && x == "" && (o._writeBits(f, n, i * 8 + w * M), y = 0, w++, g = 0, h = o._makeDiff(f), f = []);
  }
};
de.decode._findDiff = function(e, t, r) {
  for (var n = 0; n < e.length; n += 2) if (e[n] >= t && e[n + 1] == r) return e[n];
};
de.decode._makeDiff = function(e) {
  var t = [];
  e[0] == 1 && t.push(0, 1);
  for (var r = 1; r < e.length; r++) e[r - 1] != e[r] && t.push(r, e[r]);
  return t.push(e.length, 0, e.length, 1), t;
};
de.decode._decodeG2 = function(e, t, r, n, i, a, s) {
  for (var o = de.decode, u = t << 3, l = 0, c = "", f = [], h = 0, d = 0, g = Math.ceil(a / 8) * 8; u >>> 3 < t + r; ) {
    var v = 0;
    s == 1 && (v = e[u >>> 3] >>> 7 - (u & 7) & 1), s == 2 && (v = e[u >>> 3] >>> (u & 7) & 1), u++, c += v, l = o._lens[h][c], l != null && (o._addNtimes(f, l, h), c = "", l < 64 && (h = 1 - h), f.length == a && (o._writeBits(f, n, i * 8 + d * g), f = [], d++, h = 0, u & 7 && (u += 8 - (u & 7)), l >= 64 && (u += 8)));
  }
};
de.decode._decodeG3 = function(e, t, r, n, i, a, s, o) {
  for (var u = de.decode, l = t << 3, c = 0, f = "", h = [], d = [], g = 0; g < a; g++) h.push(0);
  for (var v = 0, m = 0, p = 0, y = 0, w = 0, x = -1, b = "", M = 0, k = !0, E = Math.ceil(a / 8) * 8; l >>> 3 < t + r; ) {
    p = u._findDiff(d, v + (v == 0 ? 0 : 1), 1 - w), y = u._findDiff(d, p, w);
    var S = 0;
    if (s == 1 && (S = e[l >>> 3] >>> 7 - (l & 7) & 1), s == 2 && (S = e[l >>> 3] >>> (l & 7) & 1), l++, f += S, k) {
      if (u._lens[w][f] != null) {
        var F = u._lens[w][f];
        f = "", c += F, F < 64 && (u._addNtimes(h, c, w), w = 1 - w, c = 0);
      }
    } else if (b == "H") {
      if (u._lens[w][f] != null) {
        var F = u._lens[w][f];
        f = "", c += F, F < 64 && (u._addNtimes(h, c, w), v += c, w = 1 - w, c = 0, M--, M == 0 && (b = ""));
      }
    } else
      f == "0001" && (f = "", u._addNtimes(h, y - v, w), v = y), f == "001" && (f = "", b = "H", M = 2), u._dmap[f] != null && (m = p + u._dmap[f], u._addNtimes(h, m - v, w), v = m, f = "", w = 1 - w);
    f.endsWith("000000000001") && (x >= 0 && u._writeBits(h, n, i * 8 + x * E), o && (s == 1 && (k = (e[l >>> 3] >>> 7 - (l & 7) & 1) == 1), s == 2 && (k = (e[l >>> 3] >>> (l & 7) & 1) == 1), l++), f = "", w = 0, x++, v = 0, d = u._makeDiff(h), h = []);
  }
  h.length == a && u._writeBits(h, n, i * 8 + x * E);
};
de.decode._addNtimes = function(e, t, r) {
  for (var n = 0; n < t; n++) e.push(r);
};
de.decode._writeBits = function(e, t, r) {
  for (var n = 0; n < e.length; n++) t[r + n >>> 3] |= e[n] << 7 - (r + n & 7);
};
de.decode._decodeLZW = de.decode._decodeLZW = function() {
  var e, t, r, n, i = 0, a = 0, s = 0, o = 0, u = function() {
    var p = e >>> 3, y = t[p] << 16 | t[p + 1] << 8 | t[p + 2], w = y >>> 24 - (e & 7) - a & (1 << a) - 1;
    return e += a, w;
  }, l = new Uint32Array(4096 * 4), c = 0, f = function(p) {
    if (p != c) {
      c = p, s = 1 << p, o = s + 1;
      for (var y = 0; y < o + 1; y++)
        l[4 * y] = l[4 * y + 3] = y, l[4 * y + 1] = 65535, l[4 * y + 2] = 1;
    }
  }, h = function(p) {
    a = p + 1, i = o + 1;
  }, d = function(p) {
    for (var y = p << 2, w = l[y + 2], x = n + w - 1; y != 65535; )
      r[x--] = l[y], y = l[y + 1];
    n += w;
  }, g = function(p, y) {
    var w = i << 2, x = p << 2;
    l[w] = l[(y << 2) + 3], l[w + 1] = x, l[w + 2] = l[x + 2] + 1, l[w + 3] = l[x + 3], i++, i + 1 == 1 << a && a != 12 && a++;
  }, v = function(p, y, w, x, b, M) {
    e = y << 3, t = p, r = x, n = b;
    var k = y + w << 3, E = 0, S = 0;
    for (f(M), h(M); e < k && (E = u()) != o; ) {
      if (E == s) {
        if (h(M), E = u(), E == o) break;
        d(E);
      } else
        E < i ? (d(E), g(S, E)) : (g(S, S), d(i - 1));
      S = E;
    }
    return n;
  };
  return v;
}();
de.tags = {};
de._types = function() {
  var e = new Array(250);
  e.fill(0), e = e.concat([0, 0, 0, 0, 4, 3, 3, 3, 3, 3, 0, 0, 3, 0, 0, 0, 3, 0, 0, 2, 2, 2, 2, 4, 3, 0, 0, 3, 4, 4, 3, 3, 5, 5, 3, 2, 5, 5, 0, 0, 0, 0, 4, 4, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 3, 5, 5, 3, 0, 3, 3, 4, 4, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
  var t = {
    33432: 2,
    33434: 5,
    33437: 5,
    34665: 4,
    34850: 3,
    34853: 4,
    34855: 3,
    34864: 3,
    34866: 4,
    36864: 7,
    36867: 2,
    36868: 2,
    37121: 7,
    37377: 10,
    37378: 5,
    37380: 10,
    37381: 5,
    37383: 3,
    37384: 3,
    37385: 3,
    37386: 5,
    37510: 7,
    37520: 2,
    37521: 2,
    37522: 2,
    40960: 7,
    40961: 3,
    40962: 4,
    40963: 4,
    40965: 4,
    41486: 5,
    41487: 5,
    41488: 3,
    41985: 3,
    41986: 3,
    41987: 3,
    41988: 5,
    41989: 3,
    41990: 3,
    41993: 3,
    41994: 3,
    41995: 7,
    41996: 3,
    42032: 2,
    42033: 2,
    42034: 5,
    42036: 2,
    42037: 2,
    59932: 7
  };
  return {
    basic: {
      main: e,
      rest: t
    },
    gps: {
      main: [1, 2, 5, 2, 5, 1, 5, 5, 0, 9],
      rest: {
        18: 2,
        29: 2
      }
    }
  };
}();
de._readIFD = function(e, t, r, n, i, a) {
  var s = e.readUshort(t, r);
  r += 2;
  var o = {};
  a.debug && log("   ".repeat(i), n.length - 1, ">>>----------------");
  for (var u = 0; u < s; u++) {
    var l = e.readUshort(t, r);
    r += 2;
    var c = e.readUshort(t, r);
    r += 2;
    var f = e.readUint(t, r);
    r += 4;
    var h = e.readUint(t, r);
    r += 4;
    var d = [];
    if (c == 1 || c == 7) {
      var g = f < 5 ? r - 4 : h;
      g + f > t.buffer.byteLength && (f = t.buffer.byteLength - g), d = new Uint8Array(t.buffer, g, f);
    }
    if (c == 2) {
      var v = f < 5 ? r - 4 : h, m = t[v], p = Math.max(0, Math.min(f - 1, t.length - v));
      m < 128 || p == 0 ? d.push(e.readASCII(t, v, p)) : d = new Uint8Array(t.buffer, v, p);
    }
    if (c == 3)
      for (var y = 0; y < f; y++) d.push(e.readUshort(t, (f < 3 ? r - 4 : h) + 2 * y));
    if (c == 4 || c == 13)
      for (var y = 0; y < f; y++) d.push(e.readUint(t, (f < 2 ? r - 4 : h) + 4 * y));
    if (c == 5 || c == 10)
      for (var w = c == 5 ? e.readUint : e.readInt, y = 0; y < f; y++) d.push([w(t, h + y * 8), w(t, h + y * 8 + 4)]);
    if (c == 8)
      for (var y = 0; y < f; y++) d.push(e.readShort(t, (f < 3 ? r - 4 : h) + 2 * y));
    if (c == 9)
      for (var y = 0; y < f; y++) d.push(e.readInt(t, (f < 2 ? r - 4 : h) + 4 * y));
    if (c == 11)
      for (var y = 0; y < f; y++) d.push(e.readFloat(t, h + y * 4));
    if (c == 12)
      for (var y = 0; y < f; y++) d.push(e.readDouble(t, h + y * 8));
    if (f != 0 && d.length == 0) {
      if (log(l, "unknown TIFF tag type: ", c, "num:", f), u == 0) return;
      continue;
    }
    if (a.debug && log("   ".repeat(i), l, c, de.tags[l], d), o["t" + l] = d, !(l == 330 && o.t272 && o.t272[0] == "DSLR-A100")) {
      if (l == 330 || l == 34665 || l == 34853 || l == 50740 && e.readUshort(t, e.readUint(d, 0)) < 300 || l == 61440) {
        for (var x = l == 50740 ? [e.readUint(d, 0)] : d, b = [], y = 0; y < x.length; y++) de._readIFD(e, t, x[y], b, i + 1, a);
        l == 330 && (o.subIFD = b), l == 34665 && (o.exifIFD = b[0]), l == 34853 && (o.gpsiIFD = b[0]), l == 50740 && (o.dngPrvt = b[0]), l == 61440 && (o.fujiIFD = b[0]);
      }
    }
    if (l == 37500 && a.parseMN) {
      var M = d;
      if (e.readASCII(M, 0, 5) == "Nikon") o.makerNote = de.decode(M.slice(10).buffer)[0];
      else if (e.readASCII(M, 0, 5) == "OLYMP" || e.readASCII(M, 0, 9) == "OM SYSTEM") {
        var k = [8208, 8224, 8240, 8256, 8272], E = [];
        de._readIFD(e, M, M[1] == 77 ? 16 : M[5] == 85 ? 12 : 8, E, i + 1, a);
        for (var S = o.makerNote = E.pop(), y = 0; y < k.length; y++) {
          var F = "t" + k[y];
          S[F] != null && (de._readIFD(e, M, S[F][0], E, i + 1, a), S[F] = E.pop());
        }
        S.t12288 && (de._readIFD(e, S.t12288, 0, E, i + 1, a), S.t12288 = E.pop());
      } else if (e.readUshort(t, h) < 300 && e.readUshort(t, h + 4) <= 12) {
        var E = [];
        de._readIFD(e, t, h, E, i + 1, a), o.makerNote = E[0];
      }
    }
  }
  return n.push(o), a.debug && log("   ".repeat(i), "<<<---------------"), r;
};
de._writeIFD = function(e, t, r, n, i) {
  var a = Object.keys(i), s = a.length;
  i.exifIFD && s--, i.gpsiIFD && s--, e.writeUshort(r, n, s), n += 2;
  for (var o = n + s * 12 + 4, u = 0; u < a.length; u++) {
    var l = a[u];
    if (!(l == "t34665" || l == "t34853")) {
      l == "exifIFD" && (l = "t34665"), l == "gpsiIFD" && (l = "t34853");
      var c = parseInt(l.slice(1)), f = t.main[c];
      if (f == null && (f = t.rest[c]), f == null || f == 0) throw new Error("unknown type of tag: " + c);
      var h = i[l];
      if (c == 34665) {
        var d = de._writeIFD(e, t, r, o, i.exifIFD);
        h = [o], o = d[1];
      }
      if (c == 34853) {
        var d = de._writeIFD(e, de._types.gps, r, o, i.gpsiIFD);
        h = [o], o = d[1];
      }
      f == 2 && (h = h[0] + "\0");
      var g = h.length;
      e.writeUshort(r, n, c), n += 2, e.writeUshort(r, n, f), n += 2, e.writeUint(r, n, g), n += 4;
      var v = [-1, 1, 1, 2, 4, 8, 0, 1, 0, 4, 8, 0, 8][f] * g, m = n;
      if (v > 4 && (e.writeUint(r, n, o), m = o), f == 1 || f == 7)
        for (var p = 0; p < g; p++) r[m + p] = h[p];
      else if (f == 2)
        e.writeASCII(r, m, h);
      else if (f == 3)
        for (var p = 0; p < g; p++) e.writeUshort(r, m + 2 * p, h[p]);
      else if (f == 4)
        for (var p = 0; p < g; p++) e.writeUint(r, m + 4 * p, h[p]);
      else if (f == 5 || f == 10)
        for (var y = f == 5 ? e.writeUint : e.writeInt, p = 0; p < g; p++) {
          var w = h[p], x = w[0], b = w[1];
          if (x == null) throw "e";
          y(r, m + 8 * p, x), y(r, m + 8 * p + 4, b);
        }
      else if (f == 9)
        for (var p = 0; p < g; p++) e.writeInt(r, m + 4 * p, h[p]);
      else if (f == 12)
        for (var p = 0; p < g; p++) e.writeDouble(r, m + 8 * p, h[p]);
      else throw f;
      v > 4 && (v += v & 1, o += v), n += 4;
    }
  }
  return [n, o];
};
de.toRGBA8 = function(e, t) {
  function r(ye) {
    return ye < 31308e-7 ? 12.92 * ye : 1.055 * Math.pow(ye, 1 / 2.4) - 0.055;
  }
  var n = e.width, i = e.height, a = n * i, s = e.data, o = new Uint8Array(a * 4), u = e.t262 ? e.t262[0] : 2, l = e.t258 ? Math.min(32, e.t258[0]) : 1;
  e.t262 == null && l == 1 && (u = 0);
  var c = e.t277 ? e.t277[0] : e.t258 ? e.t258.length : [1, 1, 3, 1, 1, 4, 3][u], f = e.t339 ? e.t339[0] : null;
  if (u == 1 && l == 32 && f != 3) throw "e";
  var h = Math.ceil(c * l * n / 8);
  if (u == 0) {
    t = 1 / 256;
    for (var d = 0; d < i; d++) {
      var g = d * h, v = d * n;
      if (l == 1) for (var m = 0; m < n; m++) {
        var p = v + m << 2, y = s[g + (m >> 3)] >> 7 - (m & 7) & 1;
        o[p] = o[p + 1] = o[p + 2] = (1 - y) * 255, o[p + 3] = 255;
      }
      if (l == 4) for (var m = 0; m < n; m++) {
        var p = v + m << 2, y = s[g + (m >> 1)] >> 4 - 4 * (m & 1) & 15;
        o[p] = o[p + 1] = o[p + 2] = (15 - y) * 17, o[p + 3] = 255;
      }
      if (l == 8) for (var m = 0; m < n; m++) {
        var p = v + m << 2, y = s[g + m];
        o[p] = o[p + 1] = o[p + 2] = 255 - y, o[p + 3] = 255;
      }
      if (l == 16) for (var m = 0; m < n; m++) {
        var p = v + m << 2, w = g + 2 * m, y = s[w + 1] << 8 | s[w];
        o[p] = o[p + 1] = o[p + 2] = Math.min(255, 255 - ~~(y * t)), o[p + 3] = 255;
      }
    }
  } else if (u == 1) {
    t == null && (t = 1 / 256);
    for (var x = s.length & 3 ? null : new Float32Array(s.buffer), d = 0; d < i; d++) {
      var g = d * h, v = d * n;
      if (l == 1) for (var m = 0; m < n; m++) {
        var p = v + m << 2, y = s[g + (m >> 3)] >> 7 - (m & 7) & 1;
        o[p] = o[p + 1] = o[p + 2] = y * 255, o[p + 3] = 255;
      }
      if (l == 2) for (var m = 0; m < n; m++) {
        var p = v + m << 2, y = s[g + (m >> 2)] >> 6 - 2 * (m & 3) & 3;
        o[p] = o[p + 1] = o[p + 2] = y * 85, o[p + 3] = 255;
      }
      if (l == 8) for (var m = 0; m < n; m++) {
        var p = v + m << 2, y = s[g + m * c];
        o[p] = o[p + 1] = o[p + 2] = y, o[p + 3] = 255;
      }
      if (l == 16) for (var m = 0; m < n; m++) {
        var p = v + m << 2, w = g + 2 * m, y = s[w + 1] << 8 | s[w];
        o[p] = o[p + 1] = o[p + 2] = Math.min(255, ~~(y * t)), o[p + 3] = 255;
      }
      if (l == 32) for (var m = 0; m < n; m++) {
        var p = v + m << 2, w = (g >>> 2) + m, y = x[w];
        o[p] = o[p + 1] = o[p + 2] = ~~(0.5 + 255 * y), o[p + 3] = 255;
      }
    }
  } else if (u == 2)
    if (l == 8) {
      if (c == 1) for (var m = 0; m < a; m++)
        o[4 * m] = o[4 * m + 1] = o[4 * m + 2] = s[m], o[4 * m + 3] = 255;
      if (c == 3) for (var m = 0; m < a; m++) {
        var p = m << 2, b = m * 3;
        o[p] = s[b], o[p + 1] = s[b + 1], o[p + 2] = s[b + 2], o[p + 3] = 255;
      }
      if (c >= 4) for (var m = 0; m < a; m++) {
        var p = m << 2, b = m * c;
        o[p] = s[b], o[p + 1] = s[b + 1], o[p + 2] = s[b + 2], o[p + 3] = s[b + 3];
      }
    } else if (l == 16) {
      if (c == 4) for (var m = 0; m < a; m++) {
        var p = m << 2, b = m * 8 + 1;
        o[p] = s[b], o[p + 1] = s[b + 2], o[p + 2] = s[b + 4], o[p + 3] = s[b + 6];
      }
      if (c == 3) for (var m = 0; m < a; m++) {
        var p = m << 2, b = m * 6 + 1;
        o[p] = s[b], o[p + 1] = s[b + 2], o[p + 2] = s[b + 4], o[p + 3] = 255;
      }
    } else if (l == 32) {
      for (var M = new Float32Array(s.buffer), k = 0, m = 0; m < M.length; m++) k = Math.min(k, M[m]);
      if (k < 0) for (var m = 0; m < s.length; m += 4) {
        var E = s[m];
        s[m] = s[m + 3], s[m + 3] = E, E = s[m + 1], s[m + 1] = s[m + 2], s[m + 2] = E;
      }
      for (var S = [], m = 0; m < 65536; m++) S.push(r(m / 65535));
      for (var m = 0; m < M.length; m++) {
        var F = Math.max(0, Math.min(1, M[m]));
        M[m] = S[~~(0.5 + F * 65535)];
      }
      if (c == 3) for (var m = 0; m < a; m++) {
        var p = m << 2, b = m * 3;
        o[p] = ~~(0.5 + M[b] * 255), o[p + 1] = ~~(0.5 + M[b + 1] * 255), o[p + 2] = ~~(0.5 + M[b + 2] * 255), o[p + 3] = 255;
      }
      else if (c == 4) for (var m = 0; m < a; m++) {
        var p = m << 2, b = m * 4;
        o[p] = ~~(0.5 + M[b] * 255), o[p + 1] = ~~(0.5 + M[b + 1] * 255), o[p + 2] = ~~(0.5 + M[b + 2] * 255), o[p + 3] = ~~(0.5 + M[b + 3] * 255);
      }
      else throw c;
    } else throw l;
  else if (u == 3)
    for (var O = e.t320, D = 1 << l, _ = l == 8 && c > 1 && e.t338 && e.t338[0] != 0, d = 0; d < i; d++) for (var L = 0; L < n; L++) {
      var m = d * n + L, p = m << 2, G = 0, V = d * h;
      if (l == 1) G = s[V + (L >>> 3)] >>> 7 - (L & 7) & 1;
      else if (l == 2) G = s[V + (L >>> 2)] >>> 6 - 2 * (L & 3) & 3;
      else if (l == 4) G = s[V + (L >>> 1)] >>> 4 - 4 * (L & 1) & 15;
      else if (l == 8) G = s[V + L * c];
      else throw l;
      o[p] = O[G] >> 8, o[p + 1] = O[D + G] >> 8, o[p + 2] = O[D + D + G] >> 8, o[p + 3] = _ ? s[V + L * c + 1] : 255;
    }
  else if (u == 5)
    for (var H = c > 4 ? 1 : 0, m = 0; m < a; m++) {
      var p = m << 2, U = m * c;
      if (window.UDOC) {
        var R = s[U], B = s[U + 1], C = s[U + 2], Z = s[U + 3], W = UDOC.C.cmykToRgb([R * (1 / 255), B * (1 / 255), C * (1 / 255), Z * (1 / 255)]);
        o[p] = ~~(0.5 + 255 * W[0]), o[p + 1] = ~~(0.5 + 255 * W[1]), o[p + 2] = ~~(0.5 + 255 * W[2]);
      } else {
        var R = 255 - s[U], B = 255 - s[U + 1], C = 255 - s[U + 2], Z = (255 - s[U + 3]) * (1 / 255);
        o[p] = ~~(R * Z + 0.5), o[p + 1] = ~~(B * Z + 0.5), o[p + 2] = ~~(C * Z + 0.5);
      }
      o[p + 3] = 255 * (1 - H) + s[U + 4] * H;
    }
  else if (u == 6 && e.t278)
    for (var J = e.t278[0], d = 0; d < i; d += J)
      for (var m = d * n, Q = J * n, j = 0; j < Q; j++) {
        var p = 4 * (m + j), U = 3 * m + 4 * (j >>> 1), C = s[U + (j & 1)], q = s[U + 2] - 128, ae = s[U + 3] - 128, pe = C + ((ae >> 2) + (ae >> 3) + (ae >> 5)), $ = C - ((q >> 2) + (q >> 4) + (q >> 5)) - ((ae >> 1) + (ae >> 3) + (ae >> 4) + (ae >> 5)), se = C + (q + (q >> 1) + (q >> 2) + (q >> 6));
        o[p] = Math.max(0, Math.min(255, pe)), o[p + 1] = Math.max(0, Math.min(255, $)), o[p + 2] = Math.max(0, Math.min(255, se)), o[p + 3] = 255;
      }
  else if (u == 32845)
    for (var d = 0; d < i; d++) for (var L = 0; L < n; L++) {
      var U = (d * n + L) * 6, p = (d * n + L) * 4, ve = s[U + 1] << 8 | s[U], ve = Math.pow(2, (ve + 0.5) / 256 - 64), me = (s[U + 3] + 0.5) / 410, Ae = (s[U + 5] + 0.5) / 410, Ce = 9 * me / (6 * me - 16 * Ae + 12), Ee = 4 * Ae / (6 * me - 16 * Ae + 12), Y = ve, ee = Ce * Y / Ee, C = Y, Me = (1 - Ce - Ee) * Y / Ee, pe = 2.69 * ee - 1.276 * C - 0.414 * Me, $ = -1.022 * ee + 1.978 * C + 0.044 * Me, se = 0.061 * ee - 0.224 * C + 1.163 * Me;
      o[p] = r(Math.min(pe, 1)) * 255, o[p + 1] = r(Math.min($, 1)) * 255, o[p + 2] = r(Math.min(se, 1)) * 255, o[p + 3] = 255;
    }
  else log("Unknown Photometric interpretation: " + u);
  return o;
};
de.replaceIMG = function(e) {
  e == null && (e = document.getElementsByTagName("img"));
  for (var t = ["tif", "tiff", "dng", "cr2", "nef"], r = 0; r < e.length; r++) {
    var n = e[r], i = n.getAttribute("src");
    if (i != null) {
      var a = i.split(".").pop().toLowerCase();
      if (t.indexOf(a) != -1) {
        var s = new XMLHttpRequest();
        de._xhrs.push(s), de._imgs.push(n), s.open("GET", i), s.responseType = "arraybuffer", s.onload = de._imgLoaded, s.send();
      }
    }
  }
};
de._xhrs = [];
de._imgs = [];
de._imgLoaded = function(e) {
  var t = de._xhrs.indexOf(e.target), r = de._imgs[t];
  de._xhrs.splice(t, 1), de._imgs.splice(t, 1), r.setAttribute("src", de.bufferToURI(e.target.response));
};
de.bufferToURI = function(e) {
  var t = de.decode(e), r = t, n = 0, i = r[0];
  t[0].subIFD && (r = r.concat(t[0].subIFD));
  for (var a = 0; a < r.length; a++) {
    var s = r[a];
    if (!(s.t258 == null || s.t258.length < 3)) {
      var o = s.t256 * s.t257;
      o > n && (n = o, i = s);
    }
  }
  de.decodeImage(e, i, t);
  var u = de.toRGBA8(i), l = i.width, c = i.height, f = document.createElement("canvas");
  f.width = l, f.height = c;
  var h = f.getContext("2d"), d = new ImageData(new Uint8ClampedArray(u.buffer), l, c);
  return h.putImageData(d, 0, 0), f.toDataURL();
};
de._binBE = {
  nextZero: function(t, r) {
    for (; t[r] != 0; ) r++;
    return r;
  },
  readUshort: function(t, r) {
    return t[r] << 8 | t[r + 1];
  },
  readShort: function(t, r) {
    var n = de._binBE.ui8;
    return n[0] = t[r + 1], n[1] = t[r + 0], de._binBE.i16[0];
  },
  readInt: function(t, r) {
    var n = de._binBE.ui8;
    return n[0] = t[r + 3], n[1] = t[r + 2], n[2] = t[r + 1], n[3] = t[r + 0], de._binBE.i32[0];
  },
  readUint: function(t, r) {
    var n = de._binBE.ui8;
    return n[0] = t[r + 3], n[1] = t[r + 2], n[2] = t[r + 1], n[3] = t[r + 0], de._binBE.ui32[0];
  },
  readASCII: function(t, r, n) {
    for (var i = "", a = 0; a < n; a++) i += String.fromCharCode(t[r + a]);
    return i;
  },
  readFloat: function(t, r) {
    for (var n = de._binBE.ui8, i = 0; i < 4; i++) n[i] = t[r + 3 - i];
    return de._binBE.fl32[0];
  },
  readDouble: function(t, r) {
    for (var n = de._binBE.ui8, i = 0; i < 8; i++) n[i] = t[r + 7 - i];
    return de._binBE.fl64[0];
  },
  writeUshort: function(t, r, n) {
    t[r] = n >> 8 & 255, t[r + 1] = n & 255;
  },
  writeInt: function(t, r, n) {
    var i = de._binBE.ui8;
    de._binBE.i32[0] = n, t[r + 3] = i[0], t[r + 2] = i[1], t[r + 1] = i[2], t[r + 0] = i[3];
  },
  writeUint: function(t, r, n) {
    t[r] = n >> 24 & 255, t[r + 1] = n >> 16 & 255, t[r + 2] = n >> 8 & 255, t[r + 3] = n >> 0 & 255;
  },
  writeASCII: function(t, r, n) {
    for (var i = 0; i < n.length; i++) t[r + i] = n.charCodeAt(i);
  },
  writeDouble: function(t, r, n) {
    de._binBE.fl64[0] = n;
    for (var i = 0; i < 8; i++) t[r + i] = de._binBE.ui8[7 - i];
  }
};
de._binBE.ui8 = new Uint8Array(8);
de._binBE.i16 = new Int16Array(de._binBE.ui8.buffer);
de._binBE.i32 = new Int32Array(de._binBE.ui8.buffer);
de._binBE.ui32 = new Uint32Array(de._binBE.ui8.buffer);
de._binBE.fl32 = new Float32Array(de._binBE.ui8.buffer);
de._binBE.fl64 = new Float64Array(de._binBE.ui8.buffer);
de._binLE = {
  nextZero: de._binBE.nextZero,
  readUshort: function(t, r) {
    return t[r + 1] << 8 | t[r];
  },
  readShort: function(t, r) {
    var n = de._binBE.ui8;
    return n[0] = t[r + 0], n[1] = t[r + 1], de._binBE.i16[0];
  },
  readInt: function(t, r) {
    var n = de._binBE.ui8;
    return n[0] = t[r + 0], n[1] = t[r + 1], n[2] = t[r + 2], n[3] = t[r + 3], de._binBE.i32[0];
  },
  readUint: function(t, r) {
    var n = de._binBE.ui8;
    return n[0] = t[r + 0], n[1] = t[r + 1], n[2] = t[r + 2], n[3] = t[r + 3], de._binBE.ui32[0];
  },
  readASCII: de._binBE.readASCII,
  readFloat: function(t, r) {
    for (var n = de._binBE.ui8, i = 0; i < 4; i++) n[i] = t[r + i];
    return de._binBE.fl32[0];
  },
  readDouble: function(t, r) {
    for (var n = de._binBE.ui8, i = 0; i < 8; i++) n[i] = t[r + i];
    return de._binBE.fl64[0];
  },
  writeUshort: function(t, r, n) {
    t[r] = n & 255, t[r + 1] = n >> 8 & 255;
  },
  writeInt: function(t, r, n) {
    var i = de._binBE.ui8;
    de._binBE.i32[0] = n, t[r + 0] = i[0], t[r + 1] = i[1], t[r + 2] = i[2], t[r + 3] = i[3];
  },
  writeUint: function(t, r, n) {
    t[r] = n >>> 0 & 255, t[r + 1] = n >>> 8 & 255, t[r + 2] = n >>> 16 & 255, t[r + 3] = n >>> 24 & 255;
  },
  writeASCII: de._binBE.writeASCII
};
de._copyTile = function(e, t, r, n, i, a, s, o) {
  for (var u = Math.min(t, i - s), l = Math.min(r, a - o), c = 0; c < l; c++)
    for (var f = (o + c) * i + s, h = c * t, d = 0; d < u; d++) n[f + d] = e[h + d];
};
de._inflateRaw = function() {
  var e = {};
  return e.H = {}, e.H.N = function(t, r) {
    var n = Uint8Array, i = 0, a = 0, s = 0, o = 0, u = 0, l = 0, c = 0, f = 0, h = 0, d, g;
    if (t[0] == 3 && t[1] == 0) return r || new n(0);
    var v = e.H, m = v.b, p = v.e, y = v.R, w = v.n, x = v.A, b = v.Z, M = v.m, k = r == null;
    for (k && (r = new n(t.length >>> 2 << 5)); i == 0; ) {
      if (i = m(t, h, 1), a = m(t, h + 1, 2), h += 3, a == 0) {
        h & 7 && (h += 8 - (h & 7));
        var E = (h >>> 3) + 4, S = t[E - 4] | t[E - 3] << 8;
        k && (r = e.H.W(r, f + S)), r.set(new n(t.buffer, t.byteOffset + E, S), f), h = E + S << 3, f += S;
        continue;
      }
      if (k && (r = e.H.W(r, f + (1 << 17))), a == 1 && (d = M.J, g = M.h, l = 511, c = 31), a == 2) {
        s = p(t, h, 5) + 257, o = p(t, h + 5, 5) + 1, u = p(t, h + 10, 4) + 4, h += 14;
        for (var F = 1, O = 0; O < 38; O += 2)
          M.Q[O] = 0, M.Q[O + 1] = 0;
        for (var O = 0; O < u; O++) {
          var D = p(t, h + O * 3, 3);
          M.Q[(M.X[O] << 1) + 1] = D, D > F && (F = D);
        }
        h += 3 * u, w(M.Q, F), x(M.Q, F, M.u), d = M.w, g = M.d, h = y(M.u, (1 << F) - 1, s + o, t, h, M.v);
        var _ = v.V(M.v, 0, s, M.C);
        l = (1 << _) - 1;
        var L = v.V(M.v, s, o, M.D);
        c = (1 << L) - 1, w(M.C, _), x(M.C, _, d), w(M.D, L), x(M.D, L, g);
      }
      for (; ; ) {
        var G = d[b(t, h) & l];
        h += G & 15;
        var V = G >>> 4;
        if (!(V >>> 8))
          r[f++] = V;
        else {
          if (V == 256)
            break;
          var H = f + V - 254;
          if (V > 264) {
            var U = M.q[V - 257];
            H = f + (U >>> 3) + p(t, h, U & 7), h += U & 7;
          }
          var R = g[b(t, h) & c];
          h += R & 15;
          var B = R >>> 4, C = M.c[B], Z = (C >>> 4) + m(t, h, C & 15);
          for (h += C & 15; f < H; )
            r[f] = r[f++ - Z], r[f] = r[f++ - Z], r[f] = r[f++ - Z], r[f] = r[f++ - Z];
          f = H;
        }
      }
    }
    return r.length == f ? r : r.slice(0, f);
  }, e.H.W = function(t, r) {
    var n = t.length;
    if (r <= n) return t;
    var i = new Uint8Array(n << 1);
    return i.set(t, 0), i;
  }, e.H.R = function(t, r, n, i, a, s) {
    for (var o = e.H.e, u = e.H.Z, l = 0; l < n; ) {
      var c = t[u(i, a) & r];
      a += c & 15;
      var f = c >>> 4;
      if (f <= 15)
        s[l] = f, l++;
      else {
        var h = 0, d = 0;
        f == 16 ? (d = 3 + o(i, a, 2), a += 2, h = s[l - 1]) : f == 17 ? (d = 3 + o(i, a, 3), a += 3) : f == 18 && (d = 11 + o(i, a, 7), a += 7);
        for (var g = l + d; l < g; )
          s[l] = h, l++;
      }
    }
    return a;
  }, e.H.V = function(t, r, n, i) {
    for (var a = 0, s = 0, o = i.length >>> 1; s < n; ) {
      var u = t[s + r];
      i[s << 1] = 0, i[(s << 1) + 1] = u, u > a && (a = u), s++;
    }
    for (; s < o; )
      i[s << 1] = 0, i[(s << 1) + 1] = 0, s++;
    return a;
  }, e.H.n = function(t, r) {
    for (var n = e.H.m, i = t.length, a, s, o, u, l, c = n.j, u = 0; u <= r; u++) c[u] = 0;
    for (u = 1; u < i; u += 2) c[t[u]]++;
    var f = n.K;
    for (a = 0, c[0] = 0, s = 1; s <= r; s++)
      a = a + c[s - 1] << 1, f[s] = a;
    for (o = 0; o < i; o += 2)
      l = t[o + 1], l != 0 && (t[o] = f[l], f[l]++);
  }, e.H.A = function(t, r, n) {
    for (var i = t.length, a = e.H.m, s = a.r, o = 0; o < i; o += 2) if (t[o + 1] != 0)
      for (var u = o >> 1, l = t[o + 1], c = u << 4 | l, f = r - l, h = t[o] << f, d = h + (1 << f); h != d; ) {
        var g = s[h] >>> 15 - r;
        n[g] = c, h++;
      }
  }, e.H.l = function(t, r) {
    for (var n = e.H.m.r, i = 15 - r, a = 0; a < t.length; a += 2) {
      var s = t[a] << r - t[a + 1];
      t[a] = n[s] >>> i;
    }
  }, e.H.M = function(t, r, n) {
    n = n << (r & 7);
    var i = r >>> 3;
    t[i] |= n, t[i + 1] |= n >>> 8;
  }, e.H.I = function(t, r, n) {
    n = n << (r & 7);
    var i = r >>> 3;
    t[i] |= n, t[i + 1] |= n >>> 8, t[i + 2] |= n >>> 16;
  }, e.H.e = function(t, r, n) {
    return (t[r >>> 3] | t[(r >>> 3) + 1] << 8) >>> (r & 7) & (1 << n) - 1;
  }, e.H.b = function(t, r, n) {
    return (t[r >>> 3] | t[(r >>> 3) + 1] << 8 | t[(r >>> 3) + 2] << 16) >>> (r & 7) & (1 << n) - 1;
  }, e.H.Z = function(t, r) {
    return (t[r >>> 3] | t[(r >>> 3) + 1] << 8 | t[(r >>> 3) + 2] << 16) >>> (r & 7);
  }, e.H.i = function(t, r) {
    return (t[r >>> 3] | t[(r >>> 3) + 1] << 8 | t[(r >>> 3) + 2] << 16 | t[(r >>> 3) + 3] << 24) >>> (r & 7);
  }, e.H.m = function() {
    var t = Uint16Array, r = Uint32Array;
    return {
      K: new t(16),
      j: new t(16),
      X: [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],
      S: [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 999, 999, 999],
      T: [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0],
      q: new t(32),
      p: [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 65535, 65535],
      z: [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0],
      c: new r(32),
      J: new t(512),
      _: [],
      h: new t(32),
      $: [],
      w: new t(32768),
      C: [],
      v: [],
      d: new t(32768),
      D: [],
      u: new t(512),
      Q: [],
      r: new t(32768),
      s: new r(286),
      Y: new r(30),
      a: new r(19),
      t: new r(15e3),
      k: new t(65536),
      g: new t(32768)
    };
  }(), function() {
    for (var t = e.H.m, r = 32768, n = 0; n < r; n++) {
      var i = n;
      i = (i & 2863311530) >>> 1 | (i & 1431655765) << 1, i = (i & 3435973836) >>> 2 | (i & 858993459) << 2, i = (i & 4042322160) >>> 4 | (i & 252645135) << 4, i = (i & 4278255360) >>> 8 | (i & 16711935) << 8, t.r[n] = (i >>> 16 | i << 16) >>> 17;
    }
    function a(s, o, u) {
      for (; o-- != 0; ) s.push(0, u);
    }
    for (var n = 0; n < 32; n++)
      t.q[n] = t.S[n] << 3 | t.T[n], t.c[n] = t.p[n] << 4 | t.z[n];
    a(t._, 144, 8), a(t._, 112, 9), a(t._, 24, 7), a(t._, 8, 8), e.H.n(t._, 9), e.H.A(t._, 9, t.J), e.H.l(t._, 9), a(t.$, 32, 5), e.H.n(t.$, 5), e.H.A(t.$, 5, t.h), e.H.l(t.$, 5), a(t.Q, 19, 0), a(t.C, 286, 0), a(t.D, 30, 0), a(t.v, 320, 0);
  }(), e.H.N;
}();
de.LosslessJpegDecode = /* @__PURE__ */ function() {
  var e, t;
  function r() {
    return e[t++];
  }
  function n() {
    return e[t++] << 8 | e[t++];
  }
  function i(m) {
    for (var p = r(), y = [0, 0, 0, 255], w = [], x = 8, b = 0; b < 16; b++) w[b] = r();
    for (var b = 0; b < 16; b++)
      for (var M = 0; M < w[b]; M++) {
        var k = a(y, 0, b + 1, 1);
        y[k + 3] = r();
      }
    var E = new Uint8Array(1 << x);
    m[p] = [new Uint8Array(y), E];
    for (var b = 0; b < 1 << x; b++) {
      for (var S = x, F = b, O = 0, D = 0; y[O + 3] == 255 && S != 0; )
        D = F >> --S & 1, O = y[O + D];
      E[b] = O;
    }
  }
  function a(m, p, y, w) {
    if (m[p + 3] != 255) return 0;
    if (y == 0) return p;
    for (var x = 0; x < 2; x++) {
      m[p + x] == 0 && (m[p + x] = m.length, m.push(0, 0, w, 255));
      var b = a(m, m[p + x], y - 1, w + 1);
      if (b != 0) return b;
    }
    return 0;
  }
  function s(m) {
    for (var p = m.b, y = m.f; p < 25 && m.a < m.d; ) {
      var w = m.data[m.a++];
      w == 255 && !m.c && m.a++, y = y << 8 | w, p += 8;
    }
    if (p < 0) throw "e";
    m.b = p, m.f = y;
  }
  function o(m, p) {
    return p.b < m && s(p), p.f >> (p.b -= m) & 65535 >> 16 - m;
  }
  function u(m, p) {
    var y = m[0], w = 0, x = 255, b = 0;
    p.b < 16 && s(p);
    var M = p.f >> p.b - 8 & 255;
    for (w = m[1][M], x = y[w + 3], p.b -= y[w + 2]; x == 255; )
      b = p.f >> --p.b & 1, w = y[w + b], x = y[w + 3];
    return x;
  }
  function l(m, p) {
    return m < 32768 >> 16 - p && (m += -(1 << p) + 1), m;
  }
  function c(m, p) {
    var y = u(m, p);
    if (y == 0) return 0;
    if (y == 16) return -32768;
    var w = o(y, p);
    return l(w, y);
  }
  function f(m, p, y, w, x, b) {
    for (var M = 0, k = 0; k < b; k++) {
      for (var E = k * p, S = 0; S < p; S += x) {
        M++;
        for (var F = 0; F < x; F++) m[E + S + F] = c(w[F], y);
      }
      if (y.e != 0 && M % y.e == 0 && k != 0) {
        for (var O = y.a, D = y.data; D[O] != 255 || !(208 <= D[O + 1] && D[O + 1] <= 215); ) O--;
        y.a = O + 2, y.f = 0, y.b = 0;
      }
    }
  }
  function h(m, p) {
    return l(o(m, p), m);
  }
  function d(m, p, y, w, x) {
    for (var b = e.length - t, M = 0; M < b; M += 4) {
      var k = e[t + M];
      e[t + M] = e[t + M + 3], e[t + M + 3] = k;
      var k = e[t + M + 1];
      e[t + M + 1] = e[t + M + 2], e[t + M + 2] = k;
    }
    for (var E = 0; E < x; E++)
      for (var S = 32768, F = 32768, O = 0; O < p; O += 2) {
        var D = u(w, y), _ = u(w, y);
        D != 0 && (S += h(D, y)), _ != 0 && (F += h(_, y)), m[E * p + O] = S & 65535, m[E * p + O + 1] = F & 65535;
      }
  }
  function g(m) {
    if (e = m, t = 0, n() != 65496) throw "e";
    for (var p = [], y = 0, w = 0, x = 0, b = [], M = [], k = [], E = 0, S = 0, F = 0; ; ) {
      var O = n();
      if (O == 65535) {
        t--;
        continue;
      }
      var D = n();
      if (O == 65475) {
        w = r(), S = n(), F = n(), E = r();
        for (var _ = 0; _ < E; _++) {
          var L = r(), G = r(), V = r();
          if (V != 0) throw "e";
          p[L] = [_, G >> 4, G & 15];
        }
      } else if (O == 65476)
        for (var H = t + D - 2; t < H; ) i(M);
      else if (O == 65498) {
        t++;
        for (var _ = 0; _ < E; _++) {
          var U = r(), R = p[U];
          k[R[0]] = M[r() >>> 4], b[R[0]] = R.slice(1);
        }
        y = r(), t += 2;
        break;
      } else O == 65501 ? x = n() : t += D - 2;
    }
    var B = w > 8 ? Uint16Array : Uint8Array, C = new B(S * F * E), Z = {
      b: 0,
      f: 0,
      c: y == 8,
      a: t,
      data: e,
      d: e.length,
      e: x
    };
    if (Z.c) d(C, F * E, Z, k[0], S);
    else {
      for (var W = [], J = 0, Q = 0, _ = 0; _ < E; _++) {
        var j = b[_], q = j[0], ae = j[1];
        q > J && (J = q), ae > Q && (Q = ae), W.push(q * ae);
      }
      if (J != 1 || Q != 1) {
        if (E != 3 || W[1] != 1 || W[2] != 1 || J != 2 || Q != 1 && Q != 2) throw "e";
        for (var pe = [], $ = 0, _ = 0; _ < E; _++) {
          for (var se = 0; se < W[_]; se++) pe.push(k[_]);
          $ += W[_];
        }
        var ve = F / J, me = S / Q, Ae = ve * me;
        f(C, ve * $, Z, pe, $, me), v(C, y, ve, me, $ - 2, $, $, w);
        var Ce = new Uint16Array(Ae * W[0]);
        if (J == 2 && Q == 2) {
          for (var _ = 0; _ < Ae; _++)
            Ce[4 * _] = C[6 * _], Ce[4 * _ + 1] = C[6 * _ + 1], Ce[4 * _ + 2] = C[6 * _ + 2], Ce[4 * _ + 3] = C[6 * _ + 3];
          v(Ce, y, ve * 4, me, 0, 1, 1, w);
          for (var _ = 0; _ < Ae; _++)
            C[6 * _] = Ce[4 * _], C[6 * _ + 1] = Ce[4 * _ + 1], C[6 * _ + 2] = Ce[4 * _ + 2], C[6 * _ + 3] = Ce[4 * _ + 3];
        }
        if (J == 2 && Q == 1) {
          for (var _ = 0; _ < Ae; _++)
            Ce[2 * _] = C[4 * _], Ce[2 * _ + 1] = C[4 * _ + 1];
          v(Ce, y, ve * 2, me, 0, 1, 1, w);
          for (var _ = 0; _ < Ae; _++)
            C[4 * _] = Ce[2 * _], C[4 * _ + 1] = Ce[2 * _ + 1];
        }
        for (var Ee = C.slice(0), ae = 0; ae < S; ae++)
          if (Q == 2) for (var q = 0; q < F; q++) {
            var Y = (ae * F + q) * E, ee = ((ae >>> 1) * ve + (q >>> 1)) * $, Me = (ae & 1) * 2 + (q & 1);
            C[Y] = Ee[ee + Me], C[Y + 1] = Ee[ee + 4], C[Y + 2] = Ee[ee + 5];
          }
          else for (var q = 0; q < F; q++) {
            var Y = (ae * F + q) * E, ee = (ae * ve + (q >>> 1)) * $, Me = q & 1;
            C[Y] = Ee[ee + Me], C[Y + 1] = Ee[ee + 2], C[Y + 2] = Ee[ee + 3];
          }
      } else if (f(C, F * E, Z, k, E, S), x == 0) v(C, y, F, S, 0, E, E, w);
      else
        for (var ye = Math.floor(x / F), ae = 0; ae < S; ae += ye) {
          var De = C.slice(ae * F * E, (ae + ye) * F * E);
          v(De, y, F, ye, 0, E, E, w), C.set(De, ae * F * E);
        }
    }
    return C;
  }
  function v(m, p, y, w, x, b, M, k) {
    for (var E = y * M, S = x; S < b; S++) m[S] += 1 << k - 1;
    for (var F = M; F < E; F += M) for (var S = x; S < b; S++) m[F + S] += m[F + S - M];
    for (var O = 1; O < w; O++) {
      for (var D = O * E, S = x; S < b; S++) m[D + S] += m[D + S - E];
      for (var F = M; F < E; F += M)
        for (var S = x; S < b; S++) {
          var _ = D + F + S, L = _ - E, G = m[_ - M], V = 0;
          if (p == 0) V = 0;
          else if (p == 1) V = G;
          else if (p == 2) V = m[L];
          else if (p == 3) V = m[L - M];
          else if (p == 4) V = G + (m[L] - m[L - M]);
          else if (p == 5) V = G + (m[L] - m[L - M] >>> 1);
          else if (p == 6) V = m[L] + (G - m[L - M] >>> 1);
          else if (p == 7) V = G + m[L] >>> 1;
          else throw p;
          m[_] += V;
        }
    }
  }
  return g;
}();
(function() {
  var e = 0, t = 1, r = 2, n = 3, i = 4, a = 5, s = 6, o = 7, u = 8, l = 9, c = 10, f = 11, h = 12, d = 13, g = 14, v = 15, m = 16, p = 17, y = 18;
  function w(U) {
    var R = de._binBE.readUshort, B = {
      b: R(U, 0),
      i: U[2],
      C: U[3],
      u: U[4],
      q: R(U, 5),
      k: R(U, 7),
      e: R(U, 9),
      l: R(U, 11),
      s: U[13],
      d: R(U, 14)
    };
    if (B.b != 18771 || B.i > 1 || B.q < 6 || B.q % 6 || B.e < 768 || B.e % 24 || B.l != 768 || B.k < B.l || B.k % B.l || B.k - B.e >= B.l || B.s > 16 || B.s != B.k / B.l || B.s != Math.ceil(B.e / B.l) || B.d != B.q / 6 || B.u != 12 && B.u != 14 && B.u != 16 || B.C != 16 && B.C != 0)
      throw "Invalid data";
    if (B.i == 0)
      throw "Not implemented. We need this file!";
    return B.h = B.C == 16, B.m = (B.h ? B.l * 2 / 3 : B.l >>> 1) | 0, B.A = B.m + 2, B.f = 64, B.g = (1 << B.u) - 1, B.n = 4 * B.u, B;
  }
  function x(U, R) {
    var B = new Array(R.s), C = 4 * R.s, Z = 16 + C;
    C & 12 && (Z += 16 - (C & 12));
    for (var W = 0, J = 16; W < R.s; J += 4) {
      var Q = de._binBE.readUint(U, J);
      B[W] = U.slice(Z, Z + Q), B[W].j = 0, B[W].a = 0, Z += Q, W++;
    }
    if (Z != U.length) throw "Invalid data";
    return B;
  }
  function b(U, R) {
    for (var B = -R[4], C = 0; B <= R[4]; C++, B++)
      U[C] = B <= -276 ? -4 : B <= -67 ? -3 : B <= -18 ? -2 : B < -0 ? -1 : B <= R[0] ? 0 : B < R[1] ? 1 : B < R[2] ? 2 : B < R[3] ? 3 : 4;
  }
  function M(U, R, B) {
    var C = [R, 3 * R + 18, 5 * R + 67, 7 * R + 276, B];
    U.o = R, U.w = (C[4] + 2 * R) / (2 * R + 1) + 1 | 0, U.v = Math.ceil(Math.log2(U.w)), U.t = 9, b(U.c, C);
  }
  function k(U) {
    var R = {
      c: new Int8Array(2 << U.u)
    };
    return M(R, 0, U.g), R;
  }
  function E(U) {
    for (var R = [[], [], []], B = Math.max(2, U.w + 32 >>> 6), C = 0; C < 3; C++)
      for (var Z = 0; Z < 41; Z++)
        R[C][Z] = [B, 1];
    return R;
  }
  function S(U) {
    for (var R = -1, B = 0; !B; R++)
      B = U[U.j] >>> 7 - U.a & 1, U.a++, U.a &= 7, U.a || U.j++;
    return R;
  }
  function F(U, R) {
    var B = 0, C = 8 - U.a;
    if (U.j, U.a, R) {
      if (R >= C)
        do
          B <<= C, R -= C, B |= U[U.j] & (1 << C) - 1, U.j++, C = 8;
        while (R >= 8);
      R && (B <<= R, C -= R, B |= U[U.j] >>> C & (1 << R) - 1), U.a = 8 - C;
    }
    return B;
  }
  function O(U, R) {
    var B = 0;
    if (R < U)
      for (; B <= 14 && R << ++B < U; ) ;
    return B;
  }
  function D(U, R, B, C, Z, W, J, Q) {
    Q == null && (Q = 0);
    var j = W + 1, q = j % 2, ae = 0, pe, $, se = C[Z], ve = C[Z - 1], me = C[Z - 2][j], Ae = ve[j - 1], Ce = ve[j], Ee = ve[j + 1], Y = se[j - 1], ee = se[j + 1], Me = Math.abs, ye, De, Se, fe;
    if (q && (ye = Me(Ee - Ce), De = Me(me - Ce), Se = Me(Ae - Ce)), q) {
      if (fe = ye > Se && De < ye ? me + Ae : ye < Se && De < Se ? me + Ee : Ee + Ae, fe = fe + 2 * Ce >>> 2, Q) {
        se[j] = fe;
        return;
      }
      pe = R.t * R.c[U.g + Ce - me] + R.c[U.g + Ae - Ce];
    } else
      fe = Ce > Ae && Ce > Ee || Ce < Ae && Ce < Ee ? ee + Y + 2 * Ce >>> 2 : Y + ee >>> 1, pe = R.t * R.c[U.g + Ce - Ae] + R.c[U.g + Ae - Y];
    $ = Me(pe);
    var ke = S(B);
    if (ke < U.n - R.v - 1) {
      var ne = O(J[$][0], J[$][1]);
      ae = F(B, ne) + (ke << ne);
    } else
      ae = F(B, R.v) + 1;
    ae = ae & 1 ? -1 - (ae >>> 1) : ae >>> 1, J[$][0] += Me(ae), J[$][1] == U.f && (J[$][0] >>>= 1, J[$][1] >>>= 1), J[$][1]++, fe = pe < 0 ? fe - ae : fe + ae, U.i && (fe < 0 ? fe += R.w : fe > U.g && (fe -= R.w)), se[j] = fe >= 0 ? Math.min(fe, U.g) : 0;
  }
  function _(U, R, B) {
    for (var C = U[0].length, Z = R; Z <= B; Z++)
      U[Z][0] = U[Z - 1][1], U[Z][C - 1] = U[Z - 1][C - 2];
  }
  function L(U) {
    _(U, o, h), _(U, r, i), _(U, v, p);
  }
  function G(U, R, B, C, Z, W, J, Q, j, q, ae, pe, $) {
    for (var se = 0, ve = 1, me = Z < d && Z > i; ve < U.m; )
      se < U.m && (D(U, R, B, C, Z, se, J[j], U.h && (me && q || !me && (ae || (se & pe) == $))), D(U, R, B, C, W, se, J[j], U.h && (!me && q || me && (ae || (se & pe) == $))), se += 2), se > 8 && (D(U, R, B, C, Z, ve, Q[j]), D(U, R, B, C, W, ve, Q[j]), ve += 2);
    L(C);
  }
  function V(U, R, B, C, Z, W) {
    G(U, R, B, C, r, o, Z, W, 0, 0, 1, 0, 8), G(U, R, B, C, u, v, Z, W, 1, 0, 1, 0, 8), G(U, R, B, C, n, l, Z, W, 2, 1, 0, 3, 0), G(U, R, B, C, c, m, Z, W, 0, 0, 0, 3, 2), G(U, R, B, C, i, f, Z, W, 1, 0, 0, 3, 2), G(U, R, B, C, h, p, Z, W, 2, 1, 0, 3, 0);
  }
  function H(U, R, B, C, Z, W) {
    var J = W.length, Q = U.l;
    Z + 1 == U.s && (Q = U.e - Z * U.l);
    for (var j = 6 * U.e * C + Z * U.l, q = 0; q < 6; q++) {
      for (var ae = 0; ae < Q; ae++) {
        var pe = W[q % J][ae % J], $;
        pe == 0 ? $ = r + (q >>> 1) : pe == 2 ? $ = v + (q >>> 1) : $ = o + q;
        var se = U.h ? (ae * 2 / 3 & 2147483646 | ae % 3 & 1) + (ae % 3 >>> 1) : ae >>> 1;
        R[j + ae] = B[$][se + 1];
      }
      j += U.e;
    }
  }
  de._decompressRAF = function(U, R) {
    var B = w(U), C = x(U, B), Z = k(B), W = new Int16Array(B.e * B.q);
    R == null && (R = B.h ? [[1, 1, 0, 1, 1, 2], [1, 1, 2, 1, 1, 0], [2, 0, 1, 0, 2, 1], [1, 1, 2, 1, 1, 0], [1, 1, 0, 1, 1, 2], [0, 2, 1, 2, 0, 1]] : [[0, 1], [3, 2]]);
    for (var J = [[e, n], [t, i], [a, f], [s, h], [d, m], [g, p]], Q = [], j = 0; j < y; j++)
      Q[j] = new Uint16Array(B.A);
    for (var q = 0; q < B.s; q++) {
      for (var ae = E(Z), pe = E(Z), j = 0; j < y; j++)
        for (var $ = 0; $ < B.A; $++)
          Q[j][$] = 0;
      for (var se = 0; se < B.d; se++) {
        V(B, Z, C[q], Q, ae, pe);
        for (var j = 0; j < 6; j++)
          for (var $ = 0; $ < B.A; $++)
            Q[J[j][0]][$] = Q[J[j][1]][$];
        H(B, W, Q, se, q, R);
        for (var j = r; j < y; j++)
          if ([a, s, d, g].indexOf(j) == -1)
            for (var $ = 0; $ < B.A; $++)
              Q[j][$] = 0;
        L(Q);
      }
    }
    return W;
  };
})();
function Vk(e) {
  var t = ow();
  return function() {
    var r, n = hr(e);
    if (t) {
      var i = hr(this).constructor;
      r = Reflect.construct(n, arguments, i);
    } else r = n.apply(this, arguments);
    return kr(this, r);
  };
}
function ow() {
  try {
    var e = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    }));
  } catch (t) {
  }
  return (ow = function() {
    return !!e;
  })();
}
var Hk = /* @__PURE__ */ function(e) {
  lt(r, e);
  var t = Vk(r);
  function r(n) {
    return Pe(this, r), t.call(this, n);
  }
  return Be(r, [{
    key: "parse",
    value: function(i) {
      var a = de.decode(i);
      de.decodeImage(i, a[0]);
      var s = de.toRGBA8(a[0]);
      return {
        width: a[0].width,
        height: a[0].height,
        data: s,
        flipY: !0,
        magFilter: Vr,
        minFilter: xl
      };
    }
  }]), r;
}(jp), uw = /* @__PURE__ */ function() {
  function e() {
    Pe(this, e), le(this, "imp", new Hk());
  }
  return Be(e, [{
    key: "load",
    value: function(r, n, i) {
      this.imp.load(r, n, void 0, i);
    }
  }]), e;
}();
const jk = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  b64Encode: yv,
  b64Decode: bv,
  crateHexString: Oy,
  saveAsFileDialog: wv,
  downloadFile: xv,
  downloadFileFromUrl: Mv,
  getJsonFromUrl: jf,
  getFileFromUrl: Ev,
  _ML_String: Ot,
  IsZero: Xf,
  postMemoryFile: Av,
  postEmscriptenIndexedDBFile: Tv,
  createCursor: Sv,
  MxTools: mu,
  MxCanvas2Image: Uy,
  McGePoint3d: te,
  McGeVector3d: Ve,
  McGeMatrix3d: Jr,
  McGeLongArray: fa,
  McGeStringArray: Ha,
  McGePoint3dArray: Xr,
  McGeDoubleArray: hs,
  McGeBound: o1,
  MxCoordConvertType: Pv,
  get MxCoordConvert() {
    return qt;
  },
  getFilterImp: Ta,
  MxCADResbuf: vr,
  MxCADUtilityClass: Bv,
  MxCADUtility: Bt,
  MxCADSelectionSetStatus: Lv,
  MxCADSelectionSet: An,
  MxCADUiPrBase: ca,
  MxCADUiPrPoint: Zt,
  MxCADUiPrDist: cr,
  MxCADUiPrAngle: Qi,
  MxCADUiPrInt: qf,
  MxCADUiPrKeyWord: ci,
  MxCADUiPrString: $f,
  MxCADUiPrEntity: ki,
  McRxObject: Xo,
  McObjectIdType: rt,
  McObjectId: Fe,
  McDbObject: Nr,
  McDbObjectArray: gu,
  DxfCode: Rv,
  get McDb() {
    return Ie;
  },
  McCmColor: fr,
  McDbLinetypeTableRecord: Fc,
  McDbDimStyleTableRecord: Ic,
  McDbTextStyleTableRecord: Rc,
  McDbLayerTableRecord: Oc,
  McDbLayerTable: Nc,
  McDbLinetypeTable: Uc,
  McDbDimStyleTable: Gc,
  McDbTextStyleTable: zc,
  McDbDatabase: Va,
  McDbBlockTableRecord: Ao,
  McDbBlockTable: Wc,
  McDbRasterImageDef: Vc,
  McDbDictionary: vs,
  McDbXrecord: Hc,
  McDbGroup: Su,
  McDbEntity: xr,
  McDbCurve: Zr,
  McDbLine: st,
  McDbText: ps,
  McDbAttribute: Tc,
  McDbAttributeDefinition: Sc,
  McDbMText: Ia,
  McDbCircle: zr,
  McDbPolyline: ot,
  McDbBlockReference: wo,
  McDbSpatialFilter: kc,
  McDbDimension: ta,
  McDbAlignedDimension: Cc,
  McDbRotatedDimension: Dc,
  McDb2LineAngularDimension: _c,
  McDbArc: Di,
  McDbEllipse: xo,
  McDbPoint: Tu,
  McDbHatch: Mo,
  McDbProxyEntity: Pc,
  McDbRasterImage: Bc,
  McDbWipeout: Lc,
  McDbBackgroundEntity: Fv,
  McDbSpline: Eo,
  FetchAttributes: Ov,
  McObject: pl,
  McAppType: Nv,
  MxCppType: Jf,
  MxCADPluginMapDefaultData: Qy,
  MxCADPluginSampleCode: e1,
  MxCADPluginBase: t1,
  MxPropertiesWindowCustomValueType: Uv,
  MxPropertiesWindowCustomValue: r1,
  MxPropertiesWindowCustom: Gv,
  MxCompare: n1,
  MxModifyColor: i1,
  MxCADTempForbiddenIntelliSelect: a1,
  MxCADCloneType: Yf,
  MxCADWorldDrawType: Kf,
  IMcDbDwgFiler: Zf,
  MxCADWorldDraw: Iv,
  McDbCustomEntity: dl,
  MxCADBaseCustomElement: Wv,
  MxCADBaseCustomText: y1,
  MxCADMText: bt,
  McDbXlsxTable: Hv,
  MLineJustificationType: jv,
  McDbMLine: Xv,
  get MxCpp() {
    return ie;
  },
  loadMxCADassembly: zv,
  MxCheckTheBrowser: s1,
  Mx_About: Kv,
  createMxCad: eh,
  ColorMethod: hn,
  ColorIndexType: Ti,
  getColorUtils: th,
  createMcCmColor: I1,
  setMcCmColor: Zv,
  drawText: R1,
  drawCircle: Jv,
  drawLine: Qv,
  drawMText: O1,
  drawPolyLine: e0,
  drawPolygon: t0,
  drawArc: r0,
  drawEllipticalArc: n0,
  Mx_Erase: i0,
  drawRectang: a0,
  MxMap: z1,
  MxMapAddRasterTileLayer: tb,
  MxMapAddGoogleCnLayer: rb,
  mx_gps84_To_gcj02: ab,
  mx_gcj02_To_gps84: sb,
  MxTIFFLoader: uw
}, Symbol.toStringTag, { value: "Module" }));
globalThis.Buffer = Ts.Buffer;
globalThis.Buffer.alloc = Ts.Buffer.alloc;
globalThis.Buffer.from = Ts.Buffer.from;
const Kk = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ColorIndexType: Ti,
  ColorMethod: hn,
  DxfCode: Rv,
  FetchAttributes: Ov,
  IMcDbDwgFiler: Zf,
  IsZero: Xf,
  MLineJustificationType: jv,
  McAppType: Nv,
  McCmColor: fr,
  get McDb() {
    return Ie;
  },
  McDb2LineAngularDimension: _c,
  McDbAlignedDimension: Cc,
  McDbArc: Di,
  McDbAttribute: Tc,
  McDbAttributeDefinition: Sc,
  McDbBackgroundEntity: Fv,
  McDbBlockReference: wo,
  McDbBlockTable: Wc,
  McDbBlockTableRecord: Ao,
  McDbCircle: zr,
  McDbCurve: Zr,
  McDbCustomEntity: dl,
  McDbDatabase: Va,
  McDbDictionary: vs,
  McDbDimStyleTable: Gc,
  McDbDimStyleTableRecord: Ic,
  McDbDimension: ta,
  McDbEllipse: xo,
  McDbEntity: xr,
  McDbGroup: Su,
  McDbHatch: Mo,
  McDbLayerTable: Nc,
  McDbLayerTableRecord: Oc,
  McDbLine: st,
  McDbLinetypeTable: Uc,
  McDbLinetypeTableRecord: Fc,
  McDbMLine: Xv,
  McDbMText: Ia,
  McDbObject: Nr,
  McDbObjectArray: gu,
  McDbPoint: Tu,
  McDbPolyline: ot,
  McDbProxyEntity: Pc,
  McDbRasterImage: Bc,
  McDbRasterImageDef: Vc,
  McDbRotatedDimension: Dc,
  McDbSpatialFilter: kc,
  McDbSpline: Eo,
  McDbText: ps,
  McDbTextStyleTable: zc,
  McDbTextStyleTableRecord: Rc,
  McDbWipeout: Lc,
  McDbXlsxTable: Hv,
  McDbXrecord: Hc,
  McGeBound: o1,
  McGeDoubleArray: hs,
  McGeLongArray: fa,
  McGeMatrix3d: Jr,
  McGePoint3d: te,
  McGePoint3dArray: Xr,
  McGeStringArray: Ha,
  McGeVector3d: Ve,
  McObject: pl,
  McObjectId: Fe,
  McObjectIdType: rt,
  McRxObject: Xo,
  MxCADBaseCustomElement: Wv,
  MxCADBaseCustomText: y1,
  MxCADCloneType: Yf,
  MxCADMText: bt,
  MxCADPluginBase: t1,
  MxCADPluginMapDefaultData: Qy,
  MxCADPluginSampleCode: e1,
  MxCADResbuf: vr,
  MxCADSelectionSet: An,
  MxCADSelectionSetStatus: Lv,
  MxCADTempForbiddenIntelliSelect: a1,
  MxCADUiPrAngle: Qi,
  MxCADUiPrBase: ca,
  MxCADUiPrDist: cr,
  MxCADUiPrEntity: ki,
  MxCADUiPrInt: qf,
  MxCADUiPrKeyWord: ci,
  MxCADUiPrPoint: Zt,
  MxCADUiPrString: $f,
  MxCADUtility: Bt,
  MxCADUtilityClass: Bv,
  MxCADWorldDraw: Iv,
  MxCADWorldDrawType: Kf,
  MxCanvas2Image: Uy,
  MxCheckTheBrowser: s1,
  MxCompare: n1,
  get MxCoordConvert() {
    return qt;
  },
  MxCoordConvertType: Pv,
  get MxCpp() {
    return ie;
  },
  MxCppType: Jf,
  MxMap: z1,
  MxMapAddGoogleCnLayer: rb,
  MxMapAddRasterTileLayer: tb,
  MxModifyColor: i1,
  MxPropertiesWindowCustom: Gv,
  MxPropertiesWindowCustomValue: r1,
  MxPropertiesWindowCustomValueType: Uv,
  MxTIFFLoader: uw,
  MxTools: mu,
  Mx_About: Kv,
  Mx_Erase: i0,
  _ML_String: Ot,
  b64Decode: bv,
  b64Encode: yv,
  crateHexString: Oy,
  createCursor: Sv,
  createMcCmColor: I1,
  createMxCad: eh,
  default: jk,
  downloadFile: xv,
  downloadFileFromUrl: Mv,
  drawArc: r0,
  drawCircle: Jv,
  drawEllipticalArc: n0,
  drawLine: Qv,
  drawMText: O1,
  drawPolyLine: e0,
  drawPolygon: t0,
  drawRectang: a0,
  drawText: R1,
  getColorUtils: th,
  getFileFromUrl: Ev,
  getFilterImp: Ta,
  getJsonFromUrl: jf,
  loadMxCADassembly: zv,
  mx_gcj02_To_gps84: sb,
  mx_gps84_To_gcj02: ab,
  postEmscriptenIndexedDBFile: Tv,
  postMemoryFile: Av,
  saveAsFileDialog: wv,
  setMcCmColor: Zv
}, Symbol.toStringTag, { value: "Module" }));
export {
  tb as $,
  Ti as A,
  vs as B,
  hn as C,
  Hc as D,
  vr as E,
  Hv as F,
  Mo as G,
  a1 as H,
  Xr as I,
  Sc as J,
  Eo as K,
  ki as L,
  ie as M,
  qf as N,
  $f as O,
  ci as P,
  pl as Q,
  Xv as R,
  fa as S,
  ta as T,
  Tu as U,
  xo as V,
  Kk as W,
  Bc as X,
  Jr as Y,
  Fe as Z,
  Ot as _,
  fr as a,
  z1 as a0,
  jf as a1,
  t1 as a2,
  wv as a3,
  _c as a4,
  qt as a5,
  Rv as a6,
  Ov as a7,
  Ic as a8,
  Ta as a9,
  rt as b,
  Zr as c,
  Bt as d,
  Va as e,
  wo as f,
  Zt as g,
  An as h,
  Ia as i,
  Ie as j,
  ps as k,
  Ao as l,
  Qi as m,
  st as n,
  te as o,
  ot as p,
  Di as q,
  cr as r,
  Ve as s,
  zr as t,
  s1 as u,
  Rc as v,
  bt as w,
  Wv as x,
  y1 as y,
  mu as z
};
