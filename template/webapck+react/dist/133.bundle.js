"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[133],{837:function(e,t,r){r.d(t,{u:function(){return a}});var n=r(9091),a=function(){return{dialog:n.bI}}},2566:function(e,t,r){r.d(t,{d:function(){return d},u:function(){return f}});var n=r(9417),a=r(9091),i=r(9295),s=r(5679),u=r(2898);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}r(8285);var o,l=!1,d=function(e){var t=o,r=t.setValue;t.setLayerList;var n=(0,s.s)(o).list;r("visible",e="boolean"==typeof e?e:l,n.value.map(function(e,t){return t})),l=!e},f=function(e){var t=e.onAddLayer;o=(0,a.x)();var r=(0,i.c)("Shift"),f=(0,i.c)("Control"),p=o,b=p.add,x=p.remove,g=p.putCurrent,v=p.toggle,k=p.setValue,h=p.setIndex,y=p.getIndex,w=p.stringifyJSON;p.create;var m,D,P,M=p.initLayerList,A=p.setLayerList,C=(0,s.s)(o),E=C.index,I=C.list,_=C.currentLayer,L=C.rootId,V=function(){return Array.isArray(E.value)&&E.value.length>1},S=function(e,t){if(t&&t.target&&W(t.target),r.value){void 0===m&&(m=E.value);var n=Math.max(m,e),i=n===e?m:e;h((0,a.aW)(i,n))}else if(f.value){var s=[];if(Array.isArray(E.value)){var u=E.value.indexOf(e);u>=0&&E.value.length>1?(s=(0,a.w)(E.value)).splice(u,1):s=[].concat((0,a.w)(E.value),[e])}else s=[E.value,e];h(s)}else h(e),m=e,T()},T=function(){D=Array.isArray(E.value)?E.value[E.value.length-1]:E.value},R=function(){t&&t(b()),r&&(m=I.value.length-1)},W=function(e){if(e)if("INPUT"===e.tagName)P=e;else{var t=null==e?void 0:e.getElementsByTagName("input")[0];t?P=t:W(e.parentNode)}},N=function(e){var t=y();if(!(Array.isArray(t)&&t.length>1)){var r=Array.isArray(t)?t[0]:t;_.value!==I.value[r]&&I.value[r].id!==L.value&&e&&setTimeout(function(){e.focus(),e.select()})}},O=function(){var e=Array.isArray(E.value)?E.value:[E.value],t=[];T(),v("isSelect",I.value.map(function(r,n){return e.includes(n)||t.push(n),n})),E.value=t},K=(0,a.aU)({hasIcon:!0,iconType:"svg-icon",menuList:[{label:(0,a.t)("213"),fn:function(){return g(void 0,!0)},disabled:V},{label:(0,a.t)("1674"),fn:function(){return R()}},{label:(0,a.t)("205"),fn:function(){return x()},disabled:function(){var e;if(V())return!1;var t=y(E.value);return t="number"==typeof t?t:t[0],(null===(e=I.value[t])||void 0===e?void 0:e.id)===L.value},icon:(0,a.aV)("youjianshanchu")},{label:(0,a.t)("4104"),tips:"F2",fn:function(){return N(P)},disabled:V,icon:(0,a.aV)("youjianzhongmingming")},{line:!0},{label:(0,a.t)("197"),fn:function(){h(I.value.map(function(e,t){return t}))}},{label:(0,a.t)("4262"),fn:function(){return h([]),void T()}},{label:(0,a.t)("4263"),fn:function(){return O()}}]}),z=(0,a.u)().createColor;(0,a.F)().createLineType;var B=(0,u.h)([{name:(0,a.t)("4264"),fun:function(){R()}},{name:(0,a.t)("4265"),fun:function(){return x()}},{name:(0,a.t)("213"),fun:function(){return g()}},{name:(0,a.t)("4266"),fun:function(){d(),B[3].name=l?(0,a.t)("4267"):(0,a.t)("4266")}}]);return{onClickLayer:S,onClickStopTD:function(e,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];var s=a[0],u=a[1],c=a[2];return r.value||f.value?e.preventDefault():t.isSelect?V()?(e.stopPropagation(),k(s,u),!1):void k(s,u,c):k(s,u,c)},onClickLayerName:function(e,t){P=e.target,E.value===t&&N(P)},resumeIndex:function(){D&&h(D),D=void 0},reverseSelection:O,selectColor:function(e){(0,a.c)("Mx_Color",{call:function(e,t){k("color",z(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){(0,n._)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},(0,a.aX)(e,t))),E)},color:e})},selectLineType:function(e){k("lineType",e,E)},setIndex:h,onRightClickLayer:function(e,t){(!V()||!I.value[e].isSelect)&&S(e,t)},initLayerList:M,setLayerList:function(){A(w())},list:I,bodyRightClickMenuOptions:K,isShiftKeyMultipleChoice:r,isCtrlKeyMultipleChoice:f,btnList:B,rootId:L}}},4174:function(e,t,r){r.d(t,{M:function(){return i},r:function(){return u}});var n=r(9091),a=r(8285);function i(){return s.apply(this,arguments)}function s(){return(s=(0,n._)(n.a.mark(function e(){var t,r,i,s,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.X).setMessage((0,n.t)("1595")+(0,n.t)("1678")+":"),t.setUserInputControls(a.aq.kNoZeroResponseAccepted|a.aq.kNoNegativeResponseAccepted),e.next=1,t.go();case 1:if(null!=(r=e.sent)){e.next=2;break}return e.abrupt("return");case 2:return t.setMessage((0,n.t)("1595")+(0,n.t)("1679")+":"),e.next=3,t.go();case 3:if(null!=(i=e.sent)){e.next=4;break}return e.abrupt("return");case 4:return e.next=5,a.f.getCorner((0,n.t)("1595")+(0,n.t)("1680"));case 5:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:return c=s.pt2.x-s.pt1.x,o=s.pt2.y-s.pt1.y,e.next=7,a.f.userSelect((0,n.t)("1581")+(0,n.t)("1681"));case 7:if(l=e.sent,d=a.f.getMcDbEntitysBoundingBox(l)){e.next=8;break}return e.abrupt("return");case 8:(f=new a.q).x=c>0?d.minPt.x:d.maxPt.x,f.y=o>0?d.minPt.y:d.maxPt.y,u({iColNum:i,iRowNum:r,dColOffset:c,dRowOffset:o,aryId:l,dAng:0});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var u=function(e){var t=e.iRowNum,r=void 0===t?0:t,i=e.iColNum,s=void 0===i?0:i,u=e.dColOffset,c=void 0===u?0:u,o=e.dRowOffset,l=void 0===o?0:o,d=e.aryId,f=void 0===d?[]:d,p=e.dAng,b=void 0===p?0:p,x=a.f.getMcDbEntitysBoundingBox(f);if(x){var g=new a.q;g.x=c>0?x.minPt.x:x.maxPt.x,g.y=l>0?x.minPt.y:x.maxPt.y;for(var v=(new a.a7).setToRotation(b*Math.PI/180,a.v.kZAxis,g),k=0,h=0;h<r;h++)for(var y=new a.v(0,l*h,0),w=(new a.a7).setToTranslation(y),m=0;m<s;m++)if(0!=h||0!=m){var D=new a.v(c*m,0,0),P=(new a.a7).setToTranslation(D),M=new a.q(g.x,g.y,g.z);M.transformBy(w),M.transformBy(P),M.transformBy(v);for(var A=(new a.a7).setToTranslation(new a.v(M.x-g.x,M.y-g.y,M.z-g.z)),C=0;C<f.length;C++){var E=f[C].clone();if(E&&(E.transformBy(A),a.M.getCurrentMxCAD().drawEntity(E),++k>5e4))return void a.b.acutPrintf((0,n.t)("1682")+5e4+(0,n.t)("1683")+"\n")}(0,n.Z)()}}}},4405:function(e,t,r){r.d(t,{u:function(){return i}});var n=r(9091),a=function(e){return new Promise(function(){var t=(0,n._)(n.a.mark(function t(r){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.bt.onConfirm(function(e){r(e)}),n.bt.cancel(function(){r(!1)}),n.bt.showDialog(!0,e);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},i=function(){return{dialog:n.bt,open:a}}},5582:function(e,t,r){r.d(t,{s:function(){return i},u:function(){return a}});var n=r(9091),a=function(){return{dialog:n.bH}},i=function(e){return n.bH&&n.bH.showDialog(!0,e,200)}},7133:function(e,t,r){r.r(t);var n=r(9091),a=r(8285),i=r(4174),s=r(5582),u=r(7917),c=r(6101),o=r(9417),l=r(2566),d=r(837),f=r(5679),p=r(4405),b=r(624),x=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(){var i=(0,n._)(n.a.mark(function i(s,u){var c,o,l;return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:0==(c=a.M.App.getCurrentMxCAD().getCurrentOriginaFileName()).length?c="temp_empty"+(0,n.g)(!0):(-1==c.indexOf(".")||c.substring(c.length-6)!=(0,n.g)(!0))&&(c+=(0,n.g)(!0)),o=c,i.next=2;break;case 1:o=i.sent;case 2:l=a.M.App.getCurrentMxCAD().saveFile(c,function(){var e=(0,n._)(n.a.mark(function e(t){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=a?new Blob([t.buffer],{type:"application/octet-stream"}):new Blob([t.buffer],{type:"application/octet-binary"});try{s({blob:r,data:t,filename:o})}catch(e){u(e),console.error(e)}case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),t,r,e?void 0:{compression:0}),!l&&u((0,n.t)("1697"));case 3:case"end":return i.stop()}},i)}));return function(e,t){return i.apply(this,arguments)}}())},g=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i,s,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.next=2;break;case 1:e.next=5;break;case 2:return t=(0,n.i)(),e.next=3,x(!0,!1,!1);case 3:return r=e.sent,i=r.filename,s=r.blob,r.data,e.next=4,(0,a.ah)({blob:s,filename:i,types:[{description:"webcad File",accept:{"application/octet-stream":[(0,n.g)(!0)]}}]});case 4:t&&(0,n.c)("MxFullScreen");case 5:e.next=7;break;case 6:e.prev=6,u=e.catch(0),console.error(u);case 7:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,n._)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=5;break;case 2:e.next=4;break;case 3:e.prev=3,t=e.catch(1),console.error(t);case 4:e.next=6;break;case 5:return e.next=6,g();case 6:case"end":return e.stop()}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}();function k(e,t){return h.apply(this,arguments)}function h(){return(h=(0,n._)(n.a.mark(function e(t,r){var i,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t+"_preloading.json",e.next=1,a.J.getJsonFromUrl(i);case 1:if(u=e.sent,c={ok:!0,tz:!1},u){e.next=2;break}return e.abrupt("return",new Promise(function(e,t){e(c)}));case 2:if(u.tz&&(c.tz=u.tz),o=[],u.images.forEach(function(e){"http:"!=e.substring(0,5)&&"https:"!=e.substring(0,6)&&o.push(e)}),u.images=o,0!==u.images.length||0!==u.externalReference.length){e.next=3;break}return e.abrupt("return",new Promise(function(e,t){e(c)}));case 3:return u.hash=r,e.next=4,(0,s.s)(u);case 4:return null!=(l=e.sent)&&l.data?c.ok=!0:c.ok=!1,e.abrupt("return",new Promise(function(e,t){e(c)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var y=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.W).setMessage((0,n.t)("1638")),t.setUserDraw(function(e){r=e}),e.next=1,t.go();case 1:if(i=e.sent){e.next=2;break}return e.abrupt("return");case 2:if(i.isValid()){e.next=3;break}return e.abrupt("return");case 3:if(s=i.getMcDbCurve()){e.next=4;break}return e.abrupt("return");case 4:if(s instanceof a.d){e.next=5;break}return e.abrupt("return");case 5:return(u=new a.i).setUserDraw(function(e,t){if(s&&r){var n=s.clone();n&&(n.move(r,e),t.drawMcDbEntity(n))}}),e.next=6,u.go();case 6:if(c=e.sent){e.next=7;break}return e.abrupt("return");case 7:if(o=s.clone()){e.next=8;break}return e.abrupt("return");case 8:if(o.move(r,c),!(s instanceof a.r)){e.next=9;break}l=a.M.getCurrentMxCAD().drawEntity(o),(d=new a.$).copyFormAryId([l]),a.M.App.MxCADAssist.MxExplode(d.imp),e.next=11;break;case 9:if(0!==(f=o.getSamplePoints(.1)).GetCount()){e.next=10;break}return e.abrupt("return");case 10:b=a.M.getCurrentMxCAD(),f.forEach(function(e,t){if(1010===t){var r=new a.q(e.x,e.y,e.z);if(p){var n=new a.p;n.startPoint=p,n.endPoint=r,n.colorIndex=o.colorIndex,n.trueColor=o.trueColor,n.drawOrder=o.drawOrder,n.layer=o.layer,n.layerId=o.layerId,n.linetype=o.linetype,n.linetypeScale=o.linetypeScale,n.lineweight=n.lineweight,n.textStyle=n.textStyle,b.drawEntity(n)}p=r}}),b.updateDisplay();case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function w(e,t,r){var n,a=t.clone(),i=r.clone(),s=e.clone(),u=s.sub(a),c=i.sub(a),o=s.sub(i),l=u.crossProduct(c).length()/c.length(),d=u.dotProduct(c),f=c.clone().mult(d/Math.pow(c.length(),2));return a.clone().addvec(f),n=d<0?u.length():d>Math.pow(c.length(),2)?o.length():l,Math.floor(n)}(0,n.b)("_SampleCurve",y);var m=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,m,D,P,M,A,C,E,I,_,L;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.M.getCurrentMxCAD(),(r=new a.i).setMessage((0,n.t)("1601")),r.setKeyWords(""),e.next=1,r.go();case 1:if(i=e.sent,r.getStatus()!==a.V.kNone){e.next=12;break}c=new a.W,(o=new a.O).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),d=function(e,t){l=e;var r=a.f.findEntAtPoint(e.x,e.y,e.z,-1,o);if(r&&r.isValid()){var n=r.getMcDbEntity();n&&(u&&u.highlight(!1),n.highlight(!0),u=n)}};case 2:return c.setMessage((0,n.t)("1603")),c.setUserDraw(d),c.setFilter(o),e.next=3,c.go();case 3:if(f=e.sent,p=f.getMcDbEntity(),u&&u.highlight(!1),c.getStatus()!==a.V.kCancel){e.next=4;break}return e.abrupt("return");case 4:if(!(p instanceof a.u)){e.next=6;break}if(b=p.getStartPoint().val,x=p.radius,g=a.v.kXAxis.clone().rotateBy(p.endAngle).mult(x),v=p.center,k=v.clone().addvec(g),b&&k){e.next=5;break}return e.abrupt("return");case 5:return i=b,s=k,e.abrupt("continue",12);case 6:if(!(p instanceof a.x)){e.next=8;break}if(h=p.center,y=p.getStartPoint().val){e.next=7;break}return e.abrupt("return");case 7:return i=y,s=y.clone().addvec(h.sub(y).mult(2)),e.abrupt("continue",12);case 8:if(!(p instanceof a.p)){e.next=9;break}return i=p.startPoint,s=p.endPoint,e.abrupt("continue",12);case 9:if(!(p instanceof a.r)){e.next=10;break}for(m=0;m<p.numVerts();m++)D=p.getPointAt(m).val,P=p.getPointAt(m+1).val,M=p.getClosestPointTo(l,!1).val,P&&0===w(M,D,P)&&(i=D,s=P);return e.abrupt("continue",12);case 10:return a.b.acutPrintf("\n"+(0,n.t)("1604")),e.abrupt("continue",2);case 11:e.next=2;break;case 12:if(i){e.next=13;break}return e.abrupt("return");case 13:if(s){e.next=15;break}return r.setMessage((0,n.t)("1605")),r.setUserDraw(function(e,t){i&&t.drawMcDbLine(i.x,i.y,i.z,e.x,e.y,e.z)}),e.next=14,r.go();case 14:if(s=e.sent){e.next=15;break}return e.abrupt("return");case 15:_=n.a.mark(function e(){var c,o,l,d,f,p,b,x,g,v,k,h,y,w;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1606")),r.setKeyWords("[".concat((0,n.t)("1607"),"(T)/").concat((0,n.t)("169"),"(A)").concat(void 0===I?(0,n.t)("1612")+"/(H)/"+(0,n.t)("1613")+"(V)":"","/").concat((0,n.t)("176"),"(R)]")),r.clearLastInputPoint(),o=i.clone(),l=s.clone(),r.setUserDraw(function(e){if(i&&s){c&&c.erase(),u instanceof a.x&&(d||(d=u.center.clone().addvec(a.v.kXAxis.clone().rotateBy(Math.PI/2).mult(u.radius))),f||(f=u.center.clone().addvec(a.v.kXAxis.clone().rotateBy(-Math.PI/2).mult(u.radius))),e.y<d.y&&e.y>f.y&&(e.x>i.x||e.x<s.x)&&(i=d,s=f),e.x<o.x&&e.x>l.x&&(e.y>d.y||e.y<f.y)&&(i=o,s=l)),"H"===I&&(e.x<i.x?e.x=i.x:e.x>s.x&&(e.x=s.x)),"V"===I&&(e.y<i.y&&(e.y=i.y),e.y>s.y&&(e.y=s.y));var r=(c=t.drawDimRotated(i.x,i.y,s.x,s.y,e.x,e.y,E||0)).getMcDbDimension();r&&(r.textPosition=e,r.useSetTextPosition(),A&&(r.dimensionText=A),C&&(r.textRotation=C),r.trueColor=new a.a(0,255,0))}}),e.next=1,r.go();case 1:if(p=e.sent,!r.isKeyWordPicked("T")){e.next=4;break}return(x=new a.Y).clearLastInputPoint(),x.setMessage("".concat((0,n.t)("1608"),"<").concat(A||(null===(b=c.getMcDbDimension())||void 0===b?void 0:b.dimensionText)||"",">")),x.setKeyWords(""),e.next=2,x.go();case 2:if("string"==typeof(g=e.sent)){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:return A=g,c&&c.erase(),e.abrupt("return",0);case 4:if(c&&c.erase(),!r.isKeyWordPicked("A")){e.next=8;break}return(v=new a.o).clearLastInputPoint(),v.setMessage((0,n.t)("1597")),e.next=5,v.go();case 5:if(k=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(v.getStatus()!==a.V.kCancel){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:return C=v.getDetailedResult()===a.D.kCoordIn?k*(Math.PI/180):k,e.abrupt("return",0);case 8:if(!r.isKeyWordPicked("H")){e.next=9;break}return I="H",e.abrupt("return",0);case 9:if(!r.isKeyWordPicked("V")){e.next=10;break}return I="V",e.abrupt("return",0);case 10:if(!r.isKeyWordPicked("R")){e.next=14;break}return(h=new a.o).clearLastInputPoint(),h.setMessage((0,n.t)("1615")),e.next=11,h.go();case 11:if(y=e.sent){e.next=12;break}return e.abrupt("return",{v:void 0});case 12:if(h.getStatus()!==a.V.kCancel){e.next=13;break}return e.abrupt("return",{v:void 0});case 13:return E=h.getDetailedResult()===a.D.kCoordIn?y*(Math.PI/180):y,e.abrupt("return",0);case 14:if(p){e.next=15;break}return e.abrupt("return",{v:void 0});case 15:if("H"===I&&(p.x<i.x?p.x=i.x:p.x>s.x&&(p.x=s.x)),"V"===I&&(p.y<i.y&&(p.y=i.y),p.y>s.y&&(p.y=s.y)),c=t.drawDimRotated(i.x,i.y,s.x,s.y,p.x,p.y,E||0),w=c.getMcDbDimension()){e.next=16;break}return e.abrupt("return",{v:void 0});case 16:return w.textPosition=p,w.useSetTextPosition(),A&&(w.dimensionText=A),C&&(w.textRotation=C),w.trueColor=new a.a(0,255,0),t.updateDisplay(),e.abrupt("return",1);case 17:case"end":return e.stop()}},e)});case 16:return e.delegateYield(_(),"t0",17);case 17:if(0!==(L=e.t0)){e.next=18;break}return e.abrupt("continue",16);case 18:if(1!==L){e.next=19;break}return e.abrupt("continue",21);case 19:if(!L){e.next=20;break}return e.abrupt("return",L.v);case 20:e.next=16;break;case 21:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();(0,n.b)("_DrawRotatedDimension",m);var D=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,m,D,P,M,A,C,E,I;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.M.getCurrentMxCAD(),console.log(t.drawDimStyle),(r=new a.i).setMessage("".concat((0,n.t)("1601"),"<").concat((0,n.t)("1602"),">")),r.setKeyWords(""),e.next=1,r.go();case 1:if(i=e.sent,r.getStatus()!==a.V.kNone){e.next=12;break}u=new a.W,(c=new a.O).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),d=function(e,t){o=e;var r=a.f.findEntAtPoint(e.x,e.y,e.z,-1,c);if(r&&r.isValid()){var n=r.getMcDbEntity();n&&(l&&l.highlight(!1),n.highlight(!0),l=n)}};case 2:return u.setMessage((0,n.t)("1603")),u.setUserDraw(d),u.setFilter(c),e.next=3,u.go();case 3:if(f=e.sent,p=f.getMcDbEntity(),l&&l.highlight(!1),u.getStatus()!==a.V.kCancel){e.next=4;break}return e.abrupt("return");case 4:if(!(p instanceof a.u)){e.next=6;break}if(b=p.getStartPoint().val,x=p.radius,g=a.v.kXAxis.clone().rotateBy(p.endAngle).mult(x),v=p.center,k=v.clone().addvec(g),b&&k){e.next=5;break}return e.abrupt("return");case 5:return i=b,s=k,e.abrupt("continue",12);case 6:if(!(p instanceof a.x)){e.next=8;break}if(h=p.center,y=p.getClosestPointTo(o,!1).val){e.next=7;break}return e.abrupt("return");case 7:return i=y,s=y.clone().addvec(h.sub(y).mult(2)),e.abrupt("continue",12);case 8:if(!(p instanceof a.p)){e.next=9;break}return i=p.startPoint,s=p.endPoint,e.abrupt("continue",12);case 9:if(!(p instanceof a.r)){e.next=10;break}for(m=0;m<p.numVerts();m++)D=p.getPointAt(m).val,P=p.getPointAt(m+1).val,M=p.getClosestPointTo(o,!1).val,P&&0===w(M,D,P)&&(i=D,s=P);return e.abrupt("continue",12);case 10:return a.b.acutPrintf("\n"+(0,n.t)("1604")),e.abrupt("continue",2);case 11:e.next=2;break;case 12:if(i){e.next=13;break}return e.abrupt("return");case 13:if(s){e.next=15;break}return r.setMessage((0,n.t)("1605")),r.setUserDraw(function(e,t){i&&t.drawMcDbLine(i.x,i.y,i.z,e.x,e.y,e.z)}),e.next=14,r.go();case 14:if(s=e.sent){e.next=15;break}return e.abrupt("return");case 15:E=n.a.mark(function e(){var u,c,o,l,d,f,p,b;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1606")),r.setKeyWords("[".concat((0,n.t)("1607"),"(T)/").concat((0,n.t)("169"),"(A)]")),r.clearLastInputPoint(),r.setUserDraw(function(e){if(i&&s){u&&u.erase();var r=(u=t.drawDimAligned(i.x,i.y,s.x,s.y,e.x,e.y)).getMcDbDimension();r&&(A&&(r.dimensionText=A),C&&(r.textRotation=C))}}),e.next=1,r.go();case 1:if(c=e.sent,!r.isKeyWordPicked("T")){e.next=4;break}return(l=new a.Y).clearLastInputPoint(),l.setMessage("".concat((0,n.t)("1608"),"<").concat(A||(null===(o=u.getMcDbDimension())||void 0===o?void 0:o.dimensionText)||"",">")),l.setKeyWords(""),e.next=2,l.go();case 2:if("string"==typeof(d=e.sent)){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:return A=d,u&&u.erase(),e.abrupt("return",0);case 4:if(u&&u.erase(),!r.isKeyWordPicked("A")){e.next=8;break}return(f=new a.o).clearLastInputPoint(),f.setMessage((0,n.t)("1597")),e.next=5,f.go();case 5:if(p=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(f.getStatus()!==a.V.kCancel){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:return C=f.getDetailedResult()===a.D.kCoordIn?p*(Math.PI/180):p,e.abrupt("return",0);case 8:if(c){e.next=9;break}return e.abrupt("return",{v:void 0});case 9:if(u=t.drawDimAligned(i.x,i.y,s.x,s.y,c.x,c.y),b=u.getMcDbDimension()){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:return b.textPosition=c,A&&(b.dimensionText=A),C&&(b.textRotation=C),t.updateDisplay(),e.abrupt("return",1);case 11:case"end":return e.stop()}},e)});case 16:return e.delegateYield(E(),"t0",17);case 17:if(0!==(I=e.t0)){e.next=18;break}return e.abrupt("continue",16);case 18:if(1!==I){e.next=19;break}return e.abrupt("continue",21);case 19:if(!I){e.next=20;break}return e.abrupt("return",I.v);case 20:e.next=16;break;case 21:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function P(){return(P=(0,n._)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.b.getCurrentDraw().getViewAngle(),t-=.5*Math.PI,a.M.getCurrentMxCAD().zoomAngle(t);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M(){return(M=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.Z).setMessage((0,n.t)("1564")),t.setKeyWords("[".concat((0,n.t)("1565")," UCS(C)/").concat((0,n.t)("1566"),"(W)/").concat((0,n.t)("169"),"(A)/").concat((0,n.t)("1567"),"(X)]")),e.next=1,t.go();case 1:if(null==(r=e.sent)||r.toLocaleLowerCase(),null==r||r.toLocaleLowerCase(),"a"!==(null==r?void 0:r.toLocaleLowerCase())){e.next=4;break}return(i=new a.o).clearLastInputPoint(),i.setMessage((0,n.t)("1568")),e.next=2,i.go();case 2:if(s=e.sent){e.next=3;break}return e.abrupt("return");case 3:i.getDetailedResult()===a.D.kCoordIn&&(s*=Math.PI/180),a.M.getCurrentMxCAD().zoomAngle(s);case 4:if("x"!==(null==r?void 0:r.toLocaleLowerCase())){e.next=7;break}return(u=new a.o).clearLastInputPoint(),u.setMessage((0,n.t)("1569")),e.next=5,u.go();case 5:if(c=e.sent){e.next=6;break}return e.abrupt("return");case 6:u.getDetailedResult()===a.D.kCoordIn&&(c*=Math.PI/180),o=a.b.getCurrentDraw().getViewAngle(),o+=c,a.M.getCurrentMxCAD().zoomAngle(o);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(e,t){var r=document.timeline?document.timeline.currentTime:performance.now(),n=!1;return function a(i){if(!n){var s=i-r,u=Math.round(s/e);t(u);var c=(u+1)*e+r,o=document.timeline?document.timeline.currentTime:performance.now();return setTimeout(function(){requestAnimationFrame(a)},c-o)}}(r),function(){n=!0}}function C(e,t,r){for(var n=t,a=r;a-n>1e-4;){var i=(n+a)/2;Math.floor(e/i)*i>e||i<t?a=i:n=i}return e/Math.floor(e/n)}function E(e,t,r,n){var a=e.distanceTo(t),i=[],s=C(a,r,n);if(isNaN(s))return i;for(var u=a/s,c=t.sub(e).normalize(),o=0;o<u;o++)i.push(e.clone().addvec(c.clone().mult(s*o)));return i}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new a.q,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.q,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI,i=[];r=Math.max(3,r),i.push(t);for(var s=n/r,u=1;u<r;u++){var c=Math.cos(s*u),o=Math.sin(s*u),l=e.clone(),d=t.clone(),f=d.x-l.x,p=d.y-l.y,b=f*c-p*o+l.x,x=f*o+p*c+l.y,g=new a.q(b,x);i.push(g)}return i}(0,n.b)("_DrawAlignedDimension",D),(0,n.b)("Mx_Plan90CCW",function(){return P.apply(this,arguments)}),(0,n.b)("Mx_Plan",function(){return M.apply(this,arguments)}),(0,n.b)("_ViewColor",function(){var e=a.M.getCurrentMxCAD(),t=e.mxdraw.getViewColor(),r=(0,n.u)().createColor;(0,n.c)("Mx_Color",{color:r({color:(0,u.C)(t).toString()}),call:function(t){var r=(0,u.C)(t),n=r.red(),i=r.green(),s=r.blue();e.setViewBackgroundColor(n,i,s),a.b.callEvent("updateBackgroundColor",new a.a(n,i,s))}})});var _=function(e,t){return[e,new a.q(e.x,t.y,e.z),t,new a.q(t.x,e.y,t.z)]};function L(){return L=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p=function(e,t){e.colorIndex=t.colorIndex,e.trueColor=t.trueColor,e.drawOrder=t.drawOrder,e.layer=t.layer,e.layerId=t.layerId,e.linetype=t.linetype,e.linetypeScale=t.linetypeScale,e.lineweight=t.lineweight,e.textStyle=t.textStyle},t=a.b.viewCoordLong2Cad(2),r=Number(localStorage.getItem("mx_revcloud_minArcLength")),i=Number(localStorage.getItem("mx_revcloud_maxArcLength")),(isNaN(r)||r<1e-4)&&(s=a.b.viewCoordLong2Cad(12),localStorage.setItem("mx_revcloud_minArcLength",s.toString())),(isNaN(i)||i<1e-4)&&(u=a.b.viewCoordLong2Cad(12),localStorage.setItem("mx_revcloud_maxArcLength",u.toString())),c=new a.i,o=-.45,l=!1,d=!1,f=!1,b=n.a.mark(function e(){var s,u,b,x,g,v,k,h,y,w,m,D,P,M,L,V,S,T,R,W,N,O,K,z,B,U,F,q,H,j;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,n.t)("1616"),l&&(s=(0,n.t)("1617")),d&&(s=(0,n.t)("1618")),c.setMessage(s),c.setKeyWords("[".concat((0,n.t)("1619"),"(A)/").concat((0,n.t)("177"),"(O)/").concat((0,n.t)("178"),"(R)/").concat((0,n.t)("179"),"(P)/").concat((0,n.t)("180"),"(F)/").concat((0,n.t)("1624"),"(S)]")),u=new a.r,c.clearLastInputPoint(),b=function(){var e=(0,n._)(n.a.mark(function e(t){var r,a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.clearLastInputPoint(),c.setMessage((0,n.t)("1625")),c.setKeyWords("[".concat((0,n.t)("1626"),"(Y)/").concat((0,n.t)("1627"),"(N)]")),e.next=1,c.go();case 1:if(c.isKeyWordPicked("Y"))for(r=t.numVerts(),a=0;a<r;a++)i=t.getBulgeAt(a),t.setBulgeAt(a,-i);return e.abrupt("return",!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),e.next=1,c.go();case 1:if(x=e.sent,!c.isKeyWordPicked("A")){e.next=7;break}return(g=new a.t).setMessage((0,n.t)("1628")),e.next=2,g.go();case 2:if("number"==typeof(v=e.sent)){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:if(!(v<1e-5)){e.next=4;break}return a.b.acutPrintf("\n"+(0,n.t)("1629")),e.abrupt("return",{v:void 0});case 4:return r=v,localStorage.setItem("mx_revcloud_minArcLength",v.toString()),k=function(){var e=(0,n._)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.setMessage((0,n.t)("1630")),e.next=1,g.go();case 1:if("number"==typeof(t=e.sent)){e.next=2;break}return e.abrupt("return",!1);case 2:if(!(t<1e-5)){e.next=3;break}return a.b.acutPrintf("\n"+(0,n.t)("1631")),e.abrupt("return");case 3:if(!(t<r)){e.next=5;break}return a.b.acutPrintf("\n"+(0,n.t)("1632")),e.next=4,k();case 4:return e.abrupt("return",e.sent);case 5:i=t,localStorage.setItem("mx_revcloud_maxArcLength",t.toString());case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),e.next=5,k();case 5:if(!1!==e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:return e.abrupt("return",0);case 7:if(!c.isKeyWordPicked("O")){e.next=16;break}return(h=new a.O).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE,ELLIPSE"),e.next=8,a.f.userSelect((0,n.t)("1602"),h);case 8:if(y=e.sent,w=y[0]){e.next=9;break}return e.abrupt("return",{v:void 0});case 9:if(m=w.getMcDbEntity()){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:if(!(m instanceof a.r)){e.next=12;break}for(u.isClosed=m.isClosed,u.constantWidth=m.constantWidth,p(u,m),D=m.numVerts(),M=0;M<D;M++)L=m.getPointAt(M).val,P&&L&&E(P,L,r,i).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}),P=L;return u.isClosed?E(P,m.getPointAt(0).val,r,i).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}):u.addVertexAt(P,o),e.next=11,b(u);case 11:return m.erase(),e.abrupt("return",{v:a.M.getCurrentMxCAD().drawEntity(u)});case 12:if(!(m instanceof a.p)){e.next=14;break}return p(u,m),E(m.startPoint,m.endPoint,r,i).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}),u.addVertexAt(m.endPoint,o,void 0,f?t:void 0),e.next=13,b(u);case 13:return m.erase(),e.abrupt("return",{v:a.M.getCurrentMxCAD().drawEntity(u)});case 14:if(!(m instanceof a.x)){e.next=16;break}return V=m.getLength().val,S=V/C(V,r,i),T=m.getStartPoint().val,I(m.center,T,S).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}),p(u,m),m instanceof a.x&&(u.isClosed=!0),e.next=15,b(u);case 15:return m.erase(),e.abrupt("return",{v:a.M.getCurrentMxCAD().drawEntity(u)});case 16:if(!c.isKeyWordPicked("R")){e.next=17;break}return l=!0,d=!1,e.abrupt("return",0);case 17:if(!c.isKeyWordPicked("P")){e.next=18;break}return d=!0,l=!1,e.abrupt("return",0);case 18:if(!c.isKeyWordPicked("F")){e.next=19;break}return d=!1,l=!1,e.abrupt("return",0);case 19:if(!c.isKeyWordPicked("S")){e.next=25;break}return c.setMessage((0,n.t)("1633")),c.setKeyWords("[".concat((0,n.t)("1634"),"(N)/").concat((0,n.t)("1635"),"(C)]")),e.next=20,c.go();case 20:if(c.getDetailedResult()!==a.D.kEcsIn){e.next=21;break}return e.abrupt("return",{v:void 0});case 21:if(c.getDetailedResult()!==a.D.kNewCommadIn){e.next=22;break}return e.abrupt("return",{v:void 0});case 22:if(c.getStatus()!==a.V.kNone){e.next=23;break}return e.abrupt("return",{v:void 0});case 23:if(c.getStatus()!==a.V.kCancel){e.next=24;break}return e.abrupt("return",{v:void 0});case 24:return c.isKeyWordPicked("N")&&(f=!1),c.isKeyWordPicked("C")&&(f=!0),e.abrupt("return",0);case 25:if(x){e.next=26;break}return e.abrupt("return",{v:void 0});case 26:if(!l){e.next=29;break}return c.setMessage((0,n.t)("1610")),c.setMessage(""),R=function(e,a){if(x){var s=_(x,a),u=(0,n.d)(s,4),c=u[0],l=u[1],d=u[2],p=u[3],b=x.x<a.x&&x.y<a.y||x.x>a.x&&x.y>a.y;[[c,l],[l,d],[d,p],[p,c]].forEach(function(a){var s=(0,n.d)(a,2);E(s[0],s[1],r,i).forEach(function(r){e.addVertexAt(r,b?o:-o,void 0,f?t:void 0)})}),e.isClosed=!0}},c.setUserDraw(function(e,t){var r=new a.r;R(r,e),t.drawMcDbEntity(r)}),e.next=27,c.go();case 27:if(W=e.sent){e.next=28;break}return e.abrupt("return",{v:void 0});case 28:return R(u,W),e.abrupt("return",{v:a.M.getCurrentMxCAD().drawEntity(u)});case 29:if(!d){e.next=37;break}(N=[]).push(x),O=function(e,n){var a;n.forEach(function(n){a&&E(a,n,r,i).forEach(function(r){e.addVertexAt(r,o,void 0,f?t:void 0)}),a=n}),n.length>2?(e.isClosed=!0,E(a,n[0],r,i).forEach(function(r){e.addVertexAt(r,o,void 0,f?t:void 0)})):e.addVertexAt(a,o,void 0,f?t:void 0)},c.setUserDraw(function(e,t){var r=new a.r;O(r,[].concat(N,[e])),t.drawMcDbEntity(r)});case 30:return c.setMessage((0,n.t)("1636")),c.setKeyWords(N.length<2?"":"[".concat((0,n.t)("1552"),"(U)]")),e.next=31,c.go();case 31:if(K=e.sent,!c.isKeyWordPicked("U")){e.next=32;break}return N.pop(),c.clearLastInputPoint(),e.abrupt("continue",30);case 32:if(c.getDetailedResult()!==a.D.kNullEnterIn&&c.getDetailedResult()!==a.D.kMouseRightIn){e.next=34;break}return O(u,N),e.next=33,b(u);case 33:return e.abrupt("return",{v:a.M.getCurrentMxCAD().drawEntity(u)});case 34:if(K){e.next=35;break}return e.abrupt("return",{v:void 0});case 35:return N.push(K),e.abrupt("continue",30);case 36:e.next=42;break;case 37:return u.addVertexAt(x,o,void 0,f?t:void 0),z=x.clone(),B=0,U=x,F=function(){var e=(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return H(),e.next=1,b(u);case 1:a.M.getCurrentMxCAD().drawEntity(u);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c.setMessage((0,n.t)("1637")+"..."),c.setKeyWords(""),c.setUserDraw(function(e,t){x&&(U=e,B=x.distanceTo(e),t.drawMcDbEntity(u.clone()),t.drawLine(x.toVector3(),e.toVector3()))}),c.clearLastInputPoint(),q=!1,H=A(20,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(B<r)){e.next=1;break}return e.abrupt("return");case 1:if(!(U.distanceTo(z)<r)){e.next=2;break}return u.isClosed=!0,a.b.stopRunCommand(),q=!0,e.abrupt("return");case 2:u.addVertexAt(U,o,void 0,f?t:void 0),x=U,B=0;case 3:case"end":return e.stop()}},e)}))),e.next=38,c.go();case 38:if(j=e.sent,c.getDetailedResult()!==a.D.kMouseRightIn&&c.getDetailedResult()!==a.D.kNullEnterIn){e.next=39;break}return e.next=39,F();case 39:if(j||q){e.next=40;break}return e.abrupt("return",{v:H()});case 40:return j&&u.addVertexAt(j,o,void 0,f?t:void 0),e.next=41,F();case 41:return e.abrupt("return",1);case 42:case"end":return e.stop()}},e)});case 1:return e.delegateYield(b(),"t0",2);case 2:if(0!==(x=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(1!==x){e.next=4;break}return e.abrupt("continue",6);case 4:if(!x){e.next=5;break}return e.abrupt("return",x.v);case 5:e.next=1;break;case 6:case"end":return e.stop()}},e)})),L.apply(this,arguments)}function V(){return V=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,o,l,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,n.i)(),r=function(){t&&(0,n.c)("MxFullScreen")},i=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:210,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:297,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=(0,n.e)()||{},l=o.baseUrl,d=void 0===l?"":l,f=o.mxfilepath,p=void 0===f?"":f,b=o.printPdfUrl,x=void 0===b?"":b,g={width:""+i,height:""+s,roate_angle:u,bd_pt1_x:""+e.x,bd_pt1_y:""+e.y,bd_pt2_x:""+t.x,bd_pt2_y:""+t.y};a.M.getCurrentMxCAD().saveFileToUrl(x,function(e,t){try{var n=JSON.parse(t);if("ok"==n.ret){var a=d+p+n.file;(0,c.p)(a),r()}else console.log(t)}catch(e){console.log("Mx: sserverResult error")}},void 0,JSON.stringify(g))},a.b.acutPrintf("\n"+(0,n.t)("1570")),s=a.M.getCurrentMxCAD(),u=!1,o=n.a.mark(function e(){var t,c,o,d,f,p,b,x,g,v,k,h,y,w,m,D;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.i).setMessage("\n"+(0,n.t)("1571")+":"),t.setKeyWords("[".concat((0,n.t)("1572"),"(S)/[").concat((0,n.t)("1573"),"(D)]")),t.disableAllTrace(),e.next=1,t.go();case 1:if(c=e.sent,!t.isKeyWordPicked("D")){e.next=2;break}u=!0,e.next=15;break;case 2:if(!t.isKeyWordPicked("S")){e.next=11;break}return(o=new a.Z).setMessage((0,n.t)("1574")),o.setKeyWords("[A1(A)/A2(B)/A3(C)/A4(D)/".concat((0,n.t)("170"),"16.55x23.90(E)]")),o.setDisableDynInput(!0),e.next=3,o.go();case 3:if(d=e.sent){e.next=4;break}return e.abrupt("return",{v:void 0});case 4:if((f={A:{w:594,h:841},B:{w:420,h:594},C:{w:297,h:420},D:{w:210,h:297},E:{w:165.5,h:239,nw:130,nh:190}})[d]){e.next=5;break}return e.abrupt("return",{v:void 0});case 5:return(p=new a.Y).setMessage("".concat((0,n.t)("1576"),"(").concat((0,n.t)("1577"),")")),e.next=6,p.go();case 6:if(b=e.sent){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:if(l=parseFloat(b),!isNaN(l)){e.next=8;break}return a.b.acutPrintf((0,n.t)("1578")),e.abrupt("return",{v:void 0});case 8:return x=f[d].w*l,g=f[d].h*l,v=0,k=0,f[d].nw&&(v=f[d].nw*l),f[d].nh&&(k=f[d].nh*l),u&&(h=x,x=g,g=h,h=v,v=k,k=h),(t=new a.i).disableAllTrace(),t.setMessage("\n"+(0,n.t)("1579")),t.setKeyWords(""),t.setUserDraw(function(e,t){t.setColor(16711680);var r=new a.r,n=new a.q(e.x-.5*x,e.y-.5*g),i=new a.q(e.x-.5*x,e.y+.5*g),u=new a.q(e.x+.5*x,e.y+.5*g),c=new a.q(e.x+.5*x,e.y-.5*g);r.addVertexAt(n),r.addVertexAt(i),r.addVertexAt(u),r.addVertexAt(c),r.constantWidth=a.b.screenCoordLong2Doc(2),r.isClosed=!0,t.drawMcDbEntity(r);var o=[];if(o.push(n.toVector3()),o.push(i.toVector3()),o.push(u.toVector3()),o.push(c.toVector3()),t.setColor(12868),t.drawSolid(o,.5),v>0&&k>0){var l=new a.q(e.x-.5*v,e.y-.5*k),d=new a.q(e.x-.5*v,e.y+.5*k),f=new a.q(e.x+.5*v,e.y+.5*k),p=new a.q(e.x+.5*v,e.y-.5*k),b=[];b.push(l.toVector3()),b.push(d.toVector3()),b.push(f.toVector3()),b.push(p.toVector3()),b.push(l.toVector3());var h=s.mxdraw.viewCoordLong2Cad(3),y=a.I.createDashedLines(b,16777215,2*h,h);t.drawEntity(y)}}),e.next=9,t.go();case 9:if(y=e.sent){e.next=10;break}return e.abrupt("return",{v:r()});case 10:return w=new a.q(y.x-.5*x,y.y-.5*g),m=new a.q(y.x+.5*x,y.y+.5*g),i(w,m,u?f[d].h:f[d].w,u?f[d].w:f[d].h,0),e.abrupt("return",{v:void 0});case 11:if(c){e.next=12;break}return e.abrupt("return",{v:r()});case 12:return t.setMessage("\n"+(0,n.t)("1580")+":"),t.setUserDraw(function(e,t){if(!c)return r();t.setColor(16711680);var n=new a.r;n.addVertexAt(c),n.addVertexAt(new a.q(c.x,e.y)),n.addVertexAt(e),n.addVertexAt(new a.q(e.x,c.y)),n.constantWidth=a.b.screenCoordLong2Doc(2),n.isClosed=!0,t.drawMcDbEntity(n);var i=[];i.push(c.toVector3()),i.push(new THREE.Vector3(c.x,e.y)),i.push(e.toVector3()),i.push(new THREE.Vector3(e.x,c.y)),t.setColor(12868),t.drawSolid(i,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(a.w.kXYCoordInput),e.next=13,t.go();case 13:if(D=e.sent){e.next=14;break}return e.abrupt("return",{v:r()});case 14:return i(c,D,u?297:210,u?210:297,0),e.abrupt("return",{v:void 0});case 15:case"end":return e.stop()}},e)});case 1:return e.delegateYield(o(),"t0",2);case 2:if(!(d=e.t0)){e.next=3;break}return e.abrupt("return",d.v);case 3:e.next=1;break;case 4:case"end":return e.stop()}},e)})),V.apply(this,arguments)}function S(){return(S=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.b.viewCoordLong2Cad(20),(r=new a.i).setDisableDynInput(!0),r.setDynamicInputType(a.w.kNoInput),e.next=1,r.go();case 1:if(i=e.sent){e.next=2;break}return e.abrupt("return");case 2:return s=new a.r,u=0,c=i,o=A(20,function(){u<t||(s.addVertexAt(c),i=c,u=0)}),r.setUserDraw(function(e,t){i&&(c=e,u=i.distanceTo(e),t.drawMcDbEntity(s.clone()),t.drawLine(i.toVector3(),e.toVector3()))}),e.next=3,r.go();case 3:if(l=e.sent){e.next=4;break}return e.abrupt("return",o());case 4:o(),s.addVertexAt(l),a.M.getCurrentMxCAD().drawEntity(s);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(){return(T=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.t).setMessage((0,n.t)("1598")),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:return t.setMessage((0,n.t)("1599")),e.next=3,t.go();case 3:if(i=e.sent){e.next=4;break}return e.abrupt("return");case 4:return(s=new a.i).clearLastInputPoint(),s.setMessage((0,n.t)("1600")),s.setUserDraw(function(e,t){var n=new a.x,s=new a.x;n.radius=r/2,s.radius=i/2,n.center=e,s.center=e,t.drawMcDbEntity(n),t.drawMcDbEntity(s)}),e.next=5,s.go();case 5:if(u=e.sent){e.next=6;break}return e.abrupt("return");case 6:c=Math.abs(r-i)/4,o=Math.min(r,i),l=u.clone().addvec(a.v.kXAxis.clone().mult(o/2+c)),d=u.clone().addvec(a.v.kXAxis.clone().negate().mult(o/2+c)),(f=new a.r).addVertexAt(l,1),f.addVertexAt(d,1),f.addVertexAt(l,1),f.isClosed=!0,f.constantWidth=2*c,a.M.getCurrentMxCAD().drawEntity(f);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.numVerts(),a=0;a<e.numVerts();a++){var i=e.getPointAt(a).val,s=e.getPointAt(a+1).val;if(0===e.getBulgeAt(a)){if(a+1===n&&e.isClosed&&(s=e.getPointAt(0).val),s&&w(t,i,s)<r)return{start:i,end:s,startIndex:a,endIndex:a+1}}else if(s){var u=e.getParamAtPoint(i).val,c=e.getParamAtPoint(s).val,o=e.getParamAtPoint(t).val;if(c>o&&o>u)return{start:i,end:s,startIndex:a,endIndex:a+1}}}if(e.isClosed){var l=e.getPointAt(0).val,d=e.getPointAt(e.numVerts()-1).val;if(w(t,d,l)<r)return{start:d,end:l,startIndex:e.numVerts()-1,endIndex:0,isClosed:!0}}}function W(){return(W=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,w,m,D,P,M,A,C;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.M.getCurrentMxCAD(),r=new a.W,(d=new a.O).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),b=function(e,t){f=e;var r=a.f.findEntAtPoint(e.x,e.y,e.z,-1,d);if(r&&r.isValid()){var n=r.getMcDbEntity();n&&(p&&p.highlight(!1),n.highlight(!0),p=n)}},x=n.a.mark(function e(){var t,x,g,v,k,h,y,w,m,D,P,M,A,C,E,I,_,L,V,S,T,W,N,O,K,z,B,U,F,q,H,j,Y;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage("".concat((0,n.t)("1581")).concat((0,n.t)("171"),"、").concat((0,n.t)("172"),"、").concat((0,n.t)("173")).concat((0,n.t)("1585")," <").concat((0,n.t)("1586"),">")),r.setUserDraw(b),r.setFilter(d),e.next=1,r.go();case 1:if(t=e.sent,x=t.getMcDbEntity(),p&&p.highlight(!1),r.getStatus()!==a.V.kCancel){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(r.getStatus()!==a.V.kNone){e.next=9;break}return(g=new a.i).clearLastInputPoint(),g.setMessage((0,n.t)("1587")),e.next=3,g.go();case 3:if(v=e.sent){e.next=4;break}return e.abrupt("return",{v:void 0});case 4:return g.setBasePt(v),g.setMessage((0,n.t)("1588")),e.next=5,g.go();case 5:if(k=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:return g.setMessage((0,n.t)("1589")),e.next=7,g.go();case 7:if(h=e.sent){e.next=8;break}return e.abrupt("return",{v:void 0});case 8:return i=v.x,s=v.y,u=k.x,c=k.y,o=h.x,l=h.y,e.abrupt("return",0);case 9:if(!(x instanceof a.u)){e.next=11;break}if(y=x.getStartPoint().val,w=x.radius,m=a.v.kXAxis.clone().rotateBy(x.endAngle).mult(w),D=x.center,P=D.clone().addvec(m),y&&P){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:return u=y.x,c=y.y,o=P.x,l=P.y,i=D.x,s=D.y,e.abrupt("return",0);case 11:if(!(x instanceof a.x)){e.next=14;break}return M=x.center,i=M.x,s=M.y,u=f.x,c=f.y,(A=new a.i).setMessage((0,n.t)("1589")),e.next=12,A.go();case 12:if(C=e.sent){e.next=13;break}return e.abrupt("return",{v:void 0});case 13:return E=x.getClosestPointTo(C,!1).val,o=E.x,l=E.y,e.abrupt("return",0);case 14:if(!(x instanceof a.p||x instanceof a.r)){e.next=26;break}if(I=new a.W,(_=new a.O).AddMcDbEntityTypes("LINE,LWPOLYLINE"),I.setFilter(_),p=null,I.setUserDraw(function(e,t){b(e),L=e}),V=x.getClosestPointTo(f,!1).val,u=V.x,c=V.y,x instanceof a.p?(S=x).highlight(!0):(T=R(x,V,2)||{},W=T.start,N=T.end,W&&N&&(S=new a.p(W,N)),x.highlight(!1)),S){e.next=15;break}return e.abrupt("return",{v:void 0});case 15:return I.setMessage((0,n.t)("1590")),e.next=16,I.go();case 16:if(K=e.sent,I.getStatus()!==a.V.kCancel){e.next=17;break}return e.abrupt("return",{v:S.highlight(!1)});case 17:if(K){e.next=18;break}return e.abrupt("continue",15);case 18:if(K.isValid()){e.next=19;break}return e.abrupt("continue",15);case 19:if(z=K.getMcDbEntity(),B=void 0,!(z instanceof a.r)){e.next=20;break}U=R(z,I.getDocPickPoint(),2)||{},F=U.start,q=U.end,B=new a.p(F,q),z.highlight(!1),e.next=22;break;case 20:if(!(z instanceof a.p)){e.next=21;break}B=z,e.next=22;break;case 21:return a.b.acutPrintf("\n"+(0,n.t)("1591")),e.abrupt("continue",15);case 22:if(B){e.next=23;break}return e.abrupt("return",{v:S.highlight(!1)});case 23:if(S.highlight(!1),B.highlight(!1),!(H=null===(O=S.clone())||void 0===O?void 0:O.IntersectWith(B.clone(),a.l.Intersect.kExtendBoth)).isEmpty()){e.next=24;break}return e.abrupt("continue",15);case 24:return j=H.at(0),Y=B.getClosestPointTo(L,!1).val,o=Y.x,l=Y.y,i=j.x,s=j.y,e.abrupt("continue",25);case 25:return e.abrupt("return",0);case 26:case"end":return e.stop()}},e)});case 1:return e.delegateYield(x(),"t0",2);case 2:if(0!==(g=e.t0)){e.next=3;break}return e.abrupt("continue",5);case 3:if(!g){e.next=4;break}return e.abrupt("return",g.v);case 4:e.next=1;break;case 5:if((v=new a.i).clearLastInputPoint(),![i,s,u,c,o,l].some(function(e){return"number"!=typeof e})){e.next=6;break}return e.abrupt("return");case 6:return v.setMessage((0,n.t)("1592")),v.setKeyWords("[".concat((0,n.t)("174"),"(T)/").concat((0,n.t)("169"),"(A)/").concat((0,n.t)("175"),"(Q)]")),v.setUserDraw(function(e,t){var r=new a.ai;r.compute(i,s,u,c,o,l,e.x,e.y),h&&(r.dimensionText=h),y&&(r.textRotation=y),t.drawMcDbEntity(r,!0)}),e.next=7,v.go();case 7:if(w=e.sent,!v.isKeyWordPicked("T")){e.next=10;break}return(D=new a.Y).clearLastInputPoint(),D.setMessage("".concat((0,n.t)("1595")).concat((0,n.t)("1596"),"<").concat(h||(null===(m=k.getMcDbDimension())||void 0===m?void 0:m.dimensionText)||"",">")),D.setKeyWords(""),e.next=8,D.go();case 8:if("string"==typeof(P=e.sent)){e.next=9;break}return e.abrupt("return");case 9:return h=P,e.abrupt("continue",6);case 10:if(!v.isKeyWordPicked("A")){e.next=14;break}return(M=new a.o).clearLastInputPoint(),M.setMessage((0,n.t)("1597")),e.next=11,M.go();case 11:if(A=e.sent){e.next=12;break}return e.abrupt("return");case 12:if(M.getStatus()!==a.V.kCancel){e.next=13;break}return e.abrupt("return");case 13:return y=M.getDetailedResult()===a.D.kCoordIn?A*(Math.PI/180):A,e.abrupt("continue",6);case 14:if(v.isKeyWordPicked("Q"),w){e.next=15;break}return e.abrupt("return");case 15:if(t.drawUseDefaultProperties=!0,k=t.drawDimAngular(i,s,u,c,o,l,w.x,w.y),C=k.getMcDbDimension()){e.next=16;break}return e.abrupt("return");case 16:return h&&(C.dimensionText=h),y&&(C.textRotation=y),e.abrupt("return");case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e,t,r,n,i){var s=t.sub(e),u=0===r.distanceTo(n),c=r.x>n.x;i.forEach(function(i){if(i)if(!c||u||i instanceof a.x||i instanceof a.a5&&(0===i.startAngle&&i.endAngle===2*Math.PI||0===i.endAngle&&i.startAngle===2*Math.PI))i.move(e,t);else{var o=i.getGripPoints();if(o.isEmpty())return;o.forEach(function(e,t){if(function(e,t,r){var n=t.x,a=t.y,i=r.x,s=r.y,u=e.x,c=e.y,o=Math.min(n,i),l=Math.min(a,s),d=Math.max(n,i),f=Math.max(a,s);return u>=o&&u<=d&&c>=l&&c<=f}(e,r,n)&&!(i instanceof a.u&&2===t)&&!(i instanceof a.p&&2===t)){if(i instanceof a.r&&o.length()!==i.numVerts())for(var u=i.numVerts(),c=0,l=0;l<u;l++){if(i.getPointAt(l).val,0!==i.getBulgeAt(l)&&++c===t)return;c++}i.moveGripPointsAt(t,s.x,s.y,s.z)}})}})}(0,n.b)("_Revcloud",function(){return L.apply(this,arguments)}),(0,n.b)("Plot",function(){return V.apply(this,arguments)}),(0,n.b)("MxET_Pencil",function(){return S.apply(this,arguments)}),window.addEventListener("keydown",function(e){122===e.keyCode&&(e.returnValue=!1,(0,n.c)("MxFullScreen"))},!0),n.k.register({key:{keyCode:"Escape"},when:function(e){return!e.isRunCommand&&(0,n.i)()},action:function(){(0,n.c)("MxFullScreen")}}),(0,n.b)("MxFullScreen",function(){var e;(0,n.i)()?((e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen)?e.call(document):((0,n.h)().error((0,n.t)("1546")+"!"),console.error((0,n.t)("1546")+"!")),"keyboard"in navigator&&navigator.keyboard.unlock()):(function(e){var t=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen;t?t.call(e):((0,n.h)().error((0,n.t)("1546")+"!"),console.error((0,n.t)("1546")+"!"))}((0,n.f)()||document.body),"keyboard"in navigator&&navigator.keyboard.lock())}),(0,n.b)("_donut",function(){return T.apply(this,arguments)}),(0,n.b)("_dimangular",function(){return W.apply(this,arguments)});var O=(0,n.j)(0,"_stretch_offsetX"),K=(0,n.j)(0,"_stretch_offsetY"),z=(0,n.j)(0,"_stretch_offsetZ");function B(){return B=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new a.j,!((r=a.f.getCurrentSelect()).length<=0)){e.next=3;break}return e.next=1,t.userSelect((0,n.t)("1639"));case 1:if(e.sent){e.next=2;break}return e.abrupt("return");case 2:r=t.getIds(),u=t.getSelectPoint(),i=u.pt1,s=u.pt2,e.next=4;break;case 3:c=a.f.getCurrentSelectPoints(),o=c.point1,l=c.point2,i=o,s=l;case 4:return(d=new a.i).setMessage("\n"+(0,n.t)("1640")),d.setKeyWords("[".concat((0,n.t)("1641"),"(D)]")),e.next=5,d.go();case 5:if(f=e.sent,p=function(){var e=(0,n._)(n.a.mark(function e(t){var u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return d.setMessage("\n".concat((0,n.t)("1642"),"<").concat(O.value,", ").concat(K.value,", ").concat(z.value,">")),d.setKeyWords(""),d.clearLastInputPoint(),e.next=1,d.go();case 1:if(t=e.sent){e.next=2;break}return e.abrupt("return");case 2:if(t){e.next=4;break}if(0!==O.value||0!==K.value||0!==z.value){e.next=3;break}return e.abrupt("return");case 3:t=new a.q(O.value,K.value,z.value),e.next=5;break;case 4:c=(u=t).x,o=u.y,l=u.z,O.value=c,K.value=o,z.value=l;case 5:N(new a.q,t,i,s,r.map(function(e){return e.getMcDbEntity()}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),!d.isKeyWordPicked("D")&&d.getStatus()!==a.V.kNone){e.next=7;break}return e.next=6,p();case 6:return e.abrupt("return",e.sent);case 7:if(f){e.next=8;break}return e.abrupt("return");case 8:return d.setMessage("\n".concat((0,n.t)("1643")).concat((0,n.t)("1585"),"<").concat((0,n.t)("1644"),">")),d.setBasePt(f),d.setKeyWords(""),d.setUserDraw(function(e,t){var n=r.map(function(e){return e.clone()});N(f,e,i,s,n),n.forEach(function(e,n){var a,i=null===(a=r[n])||void 0===a?void 0:a.getMcDbEntity();if(i){var s=i.trueColor.getColorValue(i.layerId);t.setColor(Number(s))}t.drawMcDbEntity(e)})}),e.next=9,d.go();case 9:if(b=e.sent,d.getStatus()!==a.V.kNone){e.next=11;break}return e.next=10,p(f);case 10:return e.abrupt("return",e.sent);case 11:if(b){e.next=12;break}return e.abrupt("return");case 12:x=r.map(function(e){return e.getMcDbEntity()}).filter(function(e){return!!e}),N(f,b,i,s,x);case 13:case"end":return e.stop()}},e)})),B.apply(this,arguments)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){(0,o._)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}(0,n.b)("_stretch",function(){return B.apply(this,arguments)});var q=function(){return(0,n.l)(function e(t){(0,n.m)(this,e),(0,o._)(this,"resizeObserver",null),(0,o._)(this,"mutationObserver",null),(0,o._)(this,"element",null),this.callback=t},[{key:"addListener",value:function(e){this.element=e,this.setupResizeObserver(),this.setupMutationObserver()}},{key:"removeListener",value:function(){this.resizeObserver&&(this.resizeObserver.unobserve(this.element),this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.element=null}},{key:"setupResizeObserver",value:function(){"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.callback),this.resizeObserver.observe(this.element))}},{key:"setupMutationObserver",value:function(){"undefined"!=typeof MutationObserver&&(this.mutationObserver=new MutationObserver(this.callback),this.mutationObserver.observe(this.element,{attributes:!0}))}}])}();function H(){return(H=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.M.getCurrentMxCAD();case 1:return(r=new a.W).setMessage((0,n.t)("1609")),e.next=2,r.go();case 2:if(i=e.sent,r.getStatus()!==a.V.kCancel){e.next=3;break}return e.abrupt("return");case 3:if(r.getStatus()!==a.V.kNone){e.next=4;break}return e.abrupt("return");case 4:if(!((s=i.getMcDbEntity())instanceof a.u||s instanceof a.x)){e.next=8;break}return(u=new a.i).setMessage((0,n.t)("1610")),e.next=5,u.go();case 5:if(c=e.sent,u.getStatus()!==a.V.kCancel){e.next=6;break}return e.abrupt("return");case 6:if(u.getStatus()!==a.V.kNone){e.next=7;break}return e.abrupt("return");case 7:return c&&(o=s.center.clone(),l=c.sub(o).normalize().mult(s.radius),d=o.clone().addvec(l),f=o.clone().addvec(l.clone().negate()),p=Math.min(f.distanceTo(c),d.distanceTo(c)),t.drawDimDiametric(d.x,d.y,f.x,f.y,p)),e.abrupt("continue",10);case 8:return a.b.acutPrintf((0,n.t)("1611")),e.abrupt("continue",1);case 9:e.next=1;break;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(){return(j=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.M.getCurrentMxCAD();case 1:return(r=new a.W).setMessage((0,n.t)("1609")),e.next=2,r.go();case 2:if(i=e.sent,r.getStatus()!==a.V.kCancel){e.next=3;break}return e.abrupt("return");case 3:if(r.getStatus()!==a.V.kNone){e.next=4;break}return e.abrupt("return");case 4:if(!((s=i.getMcDbEntity())instanceof a.u||s instanceof a.x)){e.next=5;break}return u=s.center.clone(),c=a.v.kXAxis.clone().mult(s.radius),o=u.clone().addvec(c),t.drawDimDiametric(u.x,u.y,o.x,o.y,s.radius),e.abrupt("continue",7);case 5:return a.b.acutPrintf((0,n.t)("1611")),e.abrupt("continue",1);case 6:e.next=1;break;case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y(e){return new Promise(function(t){var r=(0,n.o)(),i=r.hideLoading,s=r.showLoading;try{var u=(0,n.h)().info((0,n.t)("1801")+"..."),c=a.M.App.getCurrentMxCAD().openWebFile(e,function(e){0===e?((0,n.h)().success((0,n.t)("1802")),t(!0)):((0,n.h)().error((0,n.t)("1543")),t(!1)),i(),u()});(0,n.n)(e).then(function(e){e/1048576>1&&c&&s()}),t(c)}catch(e){i(),t(!1)}})}function X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(X=function(){return!!e})()}function G(e,t,r,a){var i=(0,n.q)((0,n.r)(e.prototype),t,r);return"function"==typeof i?function(e){return i.apply(r,e)}:i}(0,n.b)("_watermark",function(e){var t={watermark_txt:(0,n.t)("1645"),watermark_html:"",watermark_x:20,watermark_y:20,watermark_rows:200,watermark_cols:200,watermark_x_space:80,watermark_y_space:80,watermark_color:"#aaa",watermark_alpha:.4,watermark_fontsize:"15px",watermark_font:"微软雅黑",watermark_width:"auto",watermark_height:"auto",watermark_angle:15,watermark_className:"mx_mask_div"};t=F(F({},t),e);var r,i=a.M.getCurrentMxCAD().mxdraw.getCanvas(),s=null,u=null,c=function(){document.querySelectorAll("."+t.watermark_className).forEach(function(e){return e.remove()})},o=function(){var e=document.createDocumentFragment(),r=i.parentElement,n=r.clientWidth,a=r.clientHeight;if(n!==s||a!==u){s=n,u=a,c();var o=Math.max(r.scrollWidth,r.clientWidth),l=Math.max(r.scrollHeight,r.clientHeight);if("auto"===t.watermark_width||"auto"===t.watermark_height)if(""!==t.watermark_html){var d=function(e){var t=document.createElement("template");t.innerHTML=e.trim();var r=document.createElement("div");r.style.position="absolute",r.style.visibility="hidden",r.style.pointerEvents="none",r.appendChild(t.content.cloneNode(!0)),document.body.appendChild(r);var n=r.getBoundingClientRect(),a=n.width,i=n.height;return a=Math.ceil(a)+5,i=Math.ceil(i),document.body.removeChild(r),{width:a,height:i}}(t.watermark_html),f=d.width,p=d.height;"auto"===t.watermark_width&&(t.watermark_width=f),"auto"===t.watermark_height&&(t.watermark_height=p)}else{var b=t.watermark_txt.length,x=parseFloat(t.watermark_fontsize)||16,g=function(e,t,r){"string"==typeof t&&(t=parseFloat(t));var n=document.createElement("canvas"),a=n.getContext("2d");if(a){a.font=t+"px "+r;var i=a.measureText(e).width,s=1.2*t;return n.remove(),{width:i=Math.ceil(i),height:s=Math.ceil(s)}}}(t.watermark_txt,t.watermark_fontsize,t.watermark_font)||{},v=g.width,k=void 0===v?b*x:v,h=g.height,y=void 0===h?x+t.watermark_x_space+t.watermark_y_space:h;"auto"===t.watermark_width&&(t.watermark_width=k),"auto"===t.watermark_height&&(t.watermark_height=y)}t.watermark_cols=Math.ceil(o/(t.watermark_x_space+t.watermark_width)),t.watermark_rows=Math.ceil(l/(t.watermark_y_space+t.watermark_height));for(var w,m,D=0;D<t.watermark_rows;D++){m=t.watermark_y+(t.watermark_y_space+t.watermark_height)*D;for(var P=0;P<t.watermark_cols;P++){w=t.watermark_x+(t.watermark_width+t.watermark_x_space)*P;var M=document.createElement("div");M.id=(t.watermark_className||"")+D+P,M.className=t.watermark_className||"",""!==t.watermark_html?M.innerHTML=t.watermark_html:M.appendChild(document.createTextNode(t.watermark_txt)),M.style.webkitTransform="rotate(-"+t.watermark_angle+"deg)",M.style.MozTransform="rotate(-"+t.watermark_angle+"deg)",M.style.msTransform="rotate(-"+t.watermark_angle+"deg)",M.style.OTransform="rotate(-"+t.watermark_angle+"deg)",M.style.transform="rotate(-"+t.watermark_angle+"deg)",M.style.visibility="",M.style.position="absolute",M.style.left=w+"px",M.style.top=m+"px",M.style.overflow="hidden",M.style.zIndex="1050",M.style.pointerEvents="none",M.style.opacity=t.watermark_alpha.toString(),M.style.fontSize=t.watermark_fontsize,M.style.fontFamily=t.watermark_font,M.style.color=t.watermark_color,M.style.textAlign="center",M.style.width=t.watermark_width+"px",M.style.height=t.watermark_height+"px",M.style.display="block",e.appendChild(M)}}r.appendChild(e)}};return o(),r=function(e,t){var r=new q(t);return r.addListener(e),r}(i,function(e){var t;return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];clearTimeout(t),t=setTimeout(function(){return e.apply(void 0,n)},200)}}(o)),function(){c(),r&&function(e){e.removeListener()}(r)}}),(0,n.b)("_DrawDiametricDimension",function(){return H.apply(this,arguments)}),(0,n.b)("_DrawRadialDimension",function(){return j.apply(this,arguments)}),(0,n.b)("_openMxweb",function(e){Y(e)}),a.b.on("mxcadApplicationCreatedMxCADObject",function(){var e,t=[],r=a.M.getCurrentMxCAD().mxdraw.getOrbitControls();r.addEventListener("change",function(){clearTimeout(e),e=setTimeout(function(){var e=r.object.position.clone(),n=r.object.zoom,i=r.target.clone(),s=a.M.getCurrentMxCAD().mxdraw.getCamera();t.push({zoom:n,position:e,target:i,camera:s.clone(!1)})},500)});var i=function(e){if(!e)return!1;var r=a.M.getCurrentMxCAD().mxdraw,n=r.getOrbitControls(),s=n.object.position.clone(),u=n.object.zoom,c=n.target.clone(),o=a.M.getCurrentMxCAD().mxdraw.getCamera();return o.copy(e.camera,!1),o.updateProjectionMatrix(),u===e.zoom&&s.equals(e.position)&&c.equals(e.target)?i(t.pop()):(n.object.position.copy(e.position),n.object.zoom=e.zoom,n.target.copy(e.target),n.update(),r._mxdrawObj.mcObject.updateDisplayMatrixData(),!0)};(0,n.b)("Mx_WindowZoom",(0,n._)(n.a.mark(function e(){var r,s,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new a.i).setMessage("\n"+(0,n.t)("1698")),r.setKeyWords("[".concat((0,n.t)("182"),"(A)/").concat((0,n.t)("183"),"(E)/").concat((0,n.t)("184"),"(P)/").concat((0,n.t)("177"),"(O)]")),s=a.M.getCurrentMxCAD(),e.next=1,r.go();case 1:if(u=e.sent,!r.isKeyWordPicked("A")){e.next=2;break}return e.abrupt("return",s.mxdraw.zoomInitialStates());case 2:if(!r.isKeyWordPicked("E")){e.next=3;break}return e.abrupt("return",s.zoomAll(!0));case 3:if(!r.isKeyWordPicked("P")){e.next=4;break}return i(t.pop())||a.b.acutPrintf("\n"+(0,n.t)("1702")+"\n"+(0,n.t)("1703")),e.abrupt("return");case 4:if(!r.isKeyWordPicked("O")){e.next=8;break}return e.next=5,a.f.userSelect("ZOOM ".concat((0,n.t)("1602")));case 5:if(!((c=e.sent).length<=0)){e.next=6;break}return e.abrupt("return");case 6:if(o=a.f.getMcDbEntitysBoundingBox(c)){e.next=7;break}return e.abrupt("return");case 7:return l=o.minPt,d=o.maxPt,e.abrupt("return",s.zoomW(l,d));case 8:if(null!=u){e.next=9;break}return e.abrupt("return");case 9:return r.setUserDraw(function(e,t){t.drawRect(a.aj.cad2doc1(u),a.aj.cad2doc1(e))}),r.setKeyWords(""),e.next=10,r.go();case 10:if(null!=(f=e.sent)){e.next=11;break}return e.abrupt("return");case 11:s.zoomW(u,f);case 12:case"end":return e.stop()}},e)})))});var Z=function(e){function t(){var e;(0,n.m)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=function(e,t,r){return t=(0,n.r)(t),(0,n.s)(e,X()?Reflect.construct(t,r||[],(0,n.r)(e).constructor):t.apply(e,r))}(this,t,[].concat(a)),(0,o._)(e,"dDashArray",.03),(0,o._)(e,"dDashRatio",.1),(0,o._)(e,"isAligned",!1),(0,o._)(e,"fixedSize",!0),(0,o._)(e,"referenceAxis",new THREE.Vector3(0,1,1)),(0,o._)(e,"offsetHeight",void 0),(0,o._)(e,"isDrawsMallRound",!0),e}return(0,n.p)(t,e),(0,n.l)(t,[{key:"getTypeName",value:function(){return"MxAuxiliaryLine"}},{key:"create",value:function(){return new t}},{key:"onViewChange",value:function(){return!!this.fixedSize&&(this.setNeedUpdateDisplay(!1),!0)}},{key:"worldDraw",value:function(e){var t=this.getDash(),r=t.dDashArray,n=t.dDashRatio,i=e.getMxObject();e.setLineWidth(.7),e.setDash(r,n);var s=this.toSmallcoord(i,this.pt1),u=this.toSmallcoord(i,this.pt2),c=s,o=u;void 0===this.offsetHeight&&(this.offsetHeight=i.screenCoordLong2World(40));var l=this.offsetHeight;if(this.isAligned){s.x>u.x&&(s=this.pt2,u=this.pt1);var d=u.clone().sub(s).cross(this.referenceAxis.clone().normalize()).normalize();c=s.clone().add(d.clone().multiplyScalar(l)),o=u.clone().add(d.clone().multiplyScalar(l))}else{var f=Math.abs(this.referenceAxis.y?s.y-u.y:s.x-u.x)+l,p=l,b=f;(0!==this.referenceAxis.x&&s.x>u.x||0!==this.referenceAxis.y&&s.y>u.y)&&(s=this.pt2,u=this.pt1),this.referenceAxis.x>0&&(p=f,b=l),this.referenceAxis.y>0&&(p=f,b=l),c=s.clone().add(this.referenceAxis.clone().multiplyScalar(p)),o=u.clone().add(this.referenceAxis.clone().multiplyScalar(b))}c.setZ(s.z),o.setZ(u.z);var x=a.I.createDashedLines([s,c,o,u],8421504,.1,.1);if(e.drawEntity(x),this.isDrawsMallRound){var g=i.screenCoordLong2World(1);e.drawCircle(s,g),e.drawCircle(u,g),e.drawCircle(c,g),e.drawCircle(o,g)}var v=c.distanceTo(o).toFixed(3);if(e.getType()===a.ak.kWorldDraw){var k=new a.a2;k.opacity=1,k.text=v,k.backgroundColor=16777185,k.color=16,k.position=new THREE.Vector3((c.x+o.x)/2,(c.y+o.y)/2),k.setFontSize(36),k.height=i.screenCoordLong2World(16),k.setLineWidthByPixels(!0),k.setUseSmallcoordDisplay(this.use_smallcoord_display),k.worldDraw(e)}else{var h=a.I.creatTextSprite(v,new THREE.Vector3((c.x+o.x)/2,(c.y+o.y)/2),i.screenCoordLong2World(16),0,16777215);h&&e.drawEntity(h)}}},{key:"getGripPoints",value:function(){return[this.pt1,this.pt2]}},{key:"moveGripPointsAt",value:function(e,t){return 0===e&&this.pt1.add(t),1===e&&this.pt2.add(t),!0}},{key:"dwgIn",value:function(e){return G(t,"dwgIn",this)([e]),this.dwgInHelp(e,["referenceAxis","isAligned","offsetHeight","fixedSize","isDrawsMallRound"]),!0}},{key:"dwgOut",value:function(e){return e=G(t,"dwgOut",this)([e]),this.dwgOutHelp(e,["referenceAxis","isAligned","offsetHeight","fixedSize","isDrawsMallRound"]),e}}])}(a.al);function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(J=function(){return!!e})()}var Q=function(e){function t(){var e;(0,n.m)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=function(e,t,r){return t=(0,n.r)(t),(0,n.s)(e,J()?Reflect.construct(t,r||[],(0,n.r)(e).constructor):t.apply(e,r))}(this,t,[].concat(a)),(0,o._)(e,"dDashArray",.03),(0,o._)(e,"dDashRatio",.1),(0,o._)(e,"pt1",void 0),(0,o._)(e,"pt2",void 0),(0,o._)(e,"center",void 0),(0,o._)(e,"fixedSize",!0),(0,o._)(e,"offsetDist",void 0),(0,o._)(e,"isClockwise","auto"),(0,o._)(e,"isDrawsMallRound",!0),(0,o._)(e,"isMaxRadius",!1),(0,o._)(e,"radius",void 0),e}return(0,n.p)(t,e),(0,n.l)(t,[{key:"getTypeName",value:function(){return"MxAuxiliaryArc"}},{key:"create",value:function(){return new t}},{key:"onViewChange",value:function(){return!!this.fixedSize&&(this.setNeedUpdateDisplay(!1),!0)}},{key:"calculateLineAngle",value:function(e,t,r){var n=2*Math.PI/360;return{startAngle:180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI*n,endAngle:180*Math.atan2(r.y-e.y,r.x-e.x)/Math.PI*n}}},{key:"getClockwise",value:function(){var e=this.getStartPoint(),t=this.getEndPoint(),r=this.isClockwise;if("auto"===r){var n=e.clone().sub(this.center),a=t.clone().sub(this.center);r=n.x*a.y-n.y*a.x<0}return r}},{key:"getAngle",value:function(){var e=this.center,t=this.getStartPoint(),r=this.getEndPoint(),n=this.getClockwise(),a=this.calculateLineAngle(e,t,r),i=a.startAngle,s=a.endAngle-i;return!n&&s<0?s+=2*Math.PI:n&&s>0&&(s-=2*Math.PI),Math.abs(s)}},{key:"getRadius",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.radius?this.radius+(e&&this.offsetDist||0):this.isMaxRadius?Math.max(this.center.distanceTo(this.pt1),this.center.distanceTo(this.pt2)):this.center.distanceTo(this.pt2)+(e&&this.offsetDist||0)}},{key:"getStartPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.b.getCurrentDraw(),t=this.pt1;this.pt2;var r=this.center,n=t;void 0===this.offsetDist&&(this.offsetDist=e.screenCoordLong2World(40));var i=this.offsetDist,s=t.clone().sub(r).normalize(),u=this.getRadius()+i;return(n=r.clone().add(s.multiplyScalar(u))).setZ(t.z),n}},{key:"getEndPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.b.getCurrentDraw(),t=this.pt2,r=this.center,n=t;void 0===this.offsetDist&&(this.offsetDist=e.screenCoordLong2World(40));var i=this.offsetDist,s=t.clone().sub(r).normalize(),u=this.getRadius()+i;return(n=r.clone().add(s.multiplyScalar(u))).setZ(t.z),n}},{key:"worldDraw",value:function(e){var t=this.getDash(),r=t.dDashArray,n=t.dDashRatio,i=e.getMxObject();e.setDash(r,n),e.setLineWidth(.7),this.toSmallcoord(i,this.pt2);var s=this.center;void 0===this.offsetDist&&(this.offsetDist=i.screenCoordLong2World(40));var u=this.offsetDist,c=this.getStartPoint(),o=this.getEndPoint(),l=this.getRadius()+u,d=this.calculateLineAngle(s,c,o),f=d.startAngle,p=d.endAngle,b=this.getClockwise(),x=new THREE.ArcCurve(s.x,s.y,l,f,p,b),g=(new THREE.Geometry).setFromPoints(x.getPoints(50)),v=a.I.createDashedLines([c,s,o],8421504,.1,.1);if(e.setColor(8421504),e.drawEntity(v),e.drawGeometryLines(g),this.isDrawsMallRound){var k=i.screenCoordLong2World(2);e.drawCircle(c,k),e.drawCircle(o,k)}var h=this.getAngle(),y=THREE.MathUtils.radToDeg(h).toFixed(3)+"°",w=x.getPointAt(.5),m=w.x,D=w.y,P=new THREE.Vector3(m,D);if(e.getType()===a.ak.kWorldDraw){var M=new a.a2;M.opacity=1,M.text=y,M.backgroundColor=16777185,M.color=16,M.position=P,M.setFontSize(36),M.height=i.screenCoordLong2World(16),M.setLineWidthByPixels(!0),M.setUseSmallcoordDisplay(this.use_smallcoord_display),M.worldDraw(e)}else{var A=a.I.creatTextSprite(y,P,i.screenCoordLong2World(16),0,16777215);A&&e.drawEntity(A)}}},{key:"getGripPoints",value:function(){return[this.pt1,this.pt2,this.center]}},{key:"moveGripPointsAt",value:function(e,t){return 0===e&&this.pt1.add(t),1===e&&this.pt2.add(t),2===e&&this.center.add(t),!0}},{key:"dwgIn",value:function(e){return this.dwgInHelp(e,["fixedSize","isDrawsMallRound","offsetDist","pt1","pt2","center","isClockwise","isMaxRadius","radius"]),!0}},{key:"dwgOut",value:function(e){return this.dwgOutHelp(e,["fixedSize","isDrawsMallRound","offsetDist","pt1","pt2","center","isClockwise","isMaxRadius","radius"]),e}}])}(a.am);function $(e,t,r){if(e.isEqualTo(t))return 0;var n=e.c().addvec(t.c().sub(e).mult(.5)),i=t.c().sub(e);i.rotateBy(Math.PI/2,a.v.kZAxis);var s=new a.p(n,n.c().addvec(i)),u=r.c();u.rotateBy(Math.PI/2,a.v.kZAxis);var c=new a.p(e,e.c().addvec(u)),o=s.IntersectWith(c,a.l.Intersect.kExtendBoth);if(o.isEmpty())return 0;var l=o.at(0),d=l.distanceTo(e);i.normalize(),i.mult(d);var f=l.c().addvec(i),p=l.c().subvec(i),b=f.c().sub(e),x=p.c().sub(e),g=f;return b.angleTo1(r)>x.angleTo1(r)&&(g=p),a.f.calcBulge(e,g,t).val}var ee=function(){var e=(0,n._)(n.a.mark(function e(t,r){var i,s,u,c,o,l,d,f,p,b,x,g,v,k;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!0,s=new a.i,u=!1,c=function(e){"Control"===e.key&&(u=!0)},o=a.M.getCurrentMxCAD(),l=function(){return u=!1},window.addEventListener("keydown",c),window.addEventListener("keyup",l),d=function(){window.removeEventListener("keydown",c),window.removeEventListener("keyup",l)},t){e.next=4;break}return s.clearLastInputPoint(),s.setMessage((0,n.t)("1684")),e.next=1,s.go();case 1:if(f=e.sent,s.getDetailedResult()!==a.D.kNewCommadIn){e.next=2;break}return d(),e.abrupt("return",!1);case 2:if(f){e.next=3;break}return e.abrupt("return",d());case 3:t=f;case 4:p=[{point:t}],b=n.a.mark(function e(){var c,l,f,b,x,g,v,k,h,y,w,m,D,P,M,A,C,E,I,_,L,V,S,T,R,W,N,O,K,z,B,U,F,q,H,j,Y,X,G,Z,J,Q,ee,te,re,ne,ae,ie,se,ue,ce,oe,le,de,fe,pe,be,xe,ge,ve,ke,he,ye,we,me,De,Pe,Me,Ae,Ce,Ee,Ie,_e,Le,Ve,Se,Te,Re,We,Ne,Oe,Ke,ze,Be,Ue,Fe,qe,He,je,Ye,Xe,Ge,Ze,Je,Qe,$e,et,tt,rt,nt,at,it,st,ut,ct,ot;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=11;break}return s.setMessage((0,n.t)("1727")),s.setKeyWords("[".concat((0,n.t)("171"),"(A)/").concat(p.length>2?(0,n.t)("1728")+"(C)/":"").concat((0,n.t)("1552"),"(U)/").concat((0,n.t)("1549"),"(T)]")),s.setUserDraw(function(e,t){var r=new a.r;p.forEach(function(e){var t=e.point,n=e.bulge;r.addVertexAt(t,n)}),r.addVertexAt(e),t.drawMcDbEntity(r)}),e.next=1,s.go();case 1:if(c=e.sent,s.getDetailedResult()!==a.D.kNullEnterIn&&s.getDetailedResult()!==a.D.kNullSpaceIn){e.next=2;break}return l=new a.r,p.forEach(function(e){var t=e.point,r=e.bulge;l.addVertexAt(t,r)}),f=l.getLength().val,b=o.drawEntity(l),r&&r(p),e.abrupt("return",{v:{dist:f,pl:l,plId:b}});case 2:if(s.getDetailedResult()!==a.D.kNewCommadIn){e.next=3;break}return d(),e.abrupt("return",{v:!1});case 3:if(s.getStatus()!==a.V.kCancel){e.next=4;break}return e.abrupt("return",{v:d()});case 4:if(s.getStatus()!==a.V.kNone){e.next=5;break}return e.abrupt("return",{v:d()});case 5:if(!s.isKeyWordPicked("A")){e.next=6;break}return i=!1,e.abrupt("return",0);case 6:if(!s.isKeyWordPicked("U")){e.next=7;break}return 0===p.length?a.b.acutPrintf((0,n.t)("1729")):(p.pop(),!(null===(x=p[p.length-1])||void 0===x)&&x.point&&s.setLastInputPoint(p[p.length-1].point),r&&r(p)),e.abrupt("return",0);case 7:if(!s.isKeyWordPicked("T")){e.next=8;break}return g=new a.r,p.forEach(function(e){var t=e.point,r=e.bulge;g.addVertexAt(t,r)}),v=g.getLength().val,k=o.drawEntity(g),r&&r(p),e.abrupt("return",{v:{dist:v,pl:g,plId:k}});case 8:if(!s.isKeyWordPicked("C")){e.next=9;break}return(h=new a.r).isClosed=!0,p.forEach(function(e){var t=e.point,r=e.bulge;h.addVertexAt(t,r)}),y=h.getLength().val,r&&r(p),w=o.drawEntity(h),e.abrupt("return",{v:{dist:y,pl:h,plId:w}});case 9:if(!c){e.next=10;break}return p.push({point:c}),r&&r(p),e.abrupt("return",0);case 10:e.next=82;break;case 11:return(m=s).setMessage((0,a.a0)("NO1_ID_ARX_PL5","".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")"))),m.setKeyWords("[".concat((0,n.t)("169"),"(A)/").concat((0,n.t)("185"),"(CE)/").concat(p.length>2?(0,n.t)("1728")+"(C)/":"").concat((0,n.t)("186"),"(D)/").concat((0,n.t)("173"),"(L)/").concat((0,n.t)("187"),"(R)/").concat((0,n.t)("1735"),"(S)/").concat((0,n.t)("1552"),"(U)]")),D=new a.v,p.length<2?D.copy(a.v.kXAxis):(P=p.length,M=p[P-2].point,A=p[P-2].bulge,C=p[P-1].point,!A||Math.abs(A)<1e-7?D=new a.q(C.x,C.y,0).sub(new a.q(M.x,M.y,0)):((E=new a.r).addVertexAt(M,A),E.addVertexAt(C),(I=E.getFirstDeriv(new a.q(C.x,C.y,0))).ret?D=I.val:D.copy(a.v.kXAxis))),_=p[p.length-1],m.setUserDraw(function(e,t){var r=$(_.point,e,u?D.clone().negate():D),n=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;n.addVertexAt(t,r)}),n.addVertexAt(_.point,r),n.addVertexAt(e),t.drawMcDbEntity(n)}),e.next=12,m.go();case 12:if(L=e.sent,m.getDetailedResult()!==a.D.kNullEnterIn&&m.getDetailedResult()!==a.D.kNullSpaceIn){e.next=13;break}return V=new a.r,p.forEach(function(e){var t=e.point,r=e.bulge;V.addVertexAt(t,r)}),S=V.getLength().val,T=o.drawEntity(V),r&&r(p),e.abrupt("return",{v:{dist:S,pl:V,plId:T}});case 13:if(null===L){e.next=14;break}R={point:L,bulge:0},p[p.length-1].bulge=$(_.point,R.point,u?D.clone().negate():D),p.push(R),r&&r(p),e.next=82;break;case 14:if(m.getStatus()!=a.V.kKeyWord){e.next=80;break}if(!m.isKeyWordPicked("A")){e.next=31;break}return(W=new a.o).setBasePt(_.point),W.setMessage((0,a.a0)("ID_ARX_PLGET_I_ANGLE",(0,n.t)("1736"))),e.next=15,W.go();case 15:if(N=e.sent,W.getDetailedResult()!==a.D.kNewCommadIn){e.next=16;break}return d(),e.abrupt("return",{v:!1});case 16:if(null!==N){e.next=17;break}return e.abrupt("return",1);case 17:return m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords("[".concat((0,n.t)("185"),"(CE)/").concat((0,n.t)("187"),"(R)]")),m.setLastInputPoint(_.point),O=p[p.length-1].point,K=function(e){var t=Math.PI/2-N/2,r=new a.q((e.x+O.x)/2,(e.y+O.y)/2),n=r.distanceTo(O),i=n/Math.sin(t),s=n/Math.tan(t),c=r.sub(O).rotateBy(Math.PI/2).normalize().mult(u?-i-s:i-s),o=r.addvec(c);return a.f.calcBulge(O,o,e).val},m.setUserDraw(function(e,t){var r=K(e),n=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;n.addVertexAt(t,r)}),n.addVertexAt(_.point,r),n.addVertexAt(e),t.drawMcDbEntity(n)}),e.next=18,m.go();case 18:if(z=e.sent,!m.isKeyWordPicked("CE")){e.next=22;break}return m.setMessage((0,n.t)("1737")),m.setKeyWords(""),m.setBasePt(O),m.setUserDraw(function(e,t){var r=e.distanceTo(O),n=e.addvec(e.sub(O).rotateBy(N).normalize().mult(r)),i=K(n),s=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;s.addVertexAt(t,r)}),s.addVertexAt(_.point,i),s.addVertexAt(n),t.drawMcDbEntity(s)}),e.next=19,m.go();case 19:if(B=e.sent,m.getDetailedResult()!==a.D.kNewCommadIn){e.next=20;break}return d(),e.abrupt("return",{v:!1});case 20:if(B){e.next=21;break}return e.abrupt("return",1);case 21:return U=B.distanceTo(O),F=B.addvec(B.sub(O).rotateBy(N).normalize().mult(U)),(q={}).bulge=0,q.point=F,p[p.length-1].bulge=K(F),p.push(q),m.setLastInputPoint(F),r&&r(p),e.abrupt("return",0);case 22:if(!m.isKeyWordPicked("R")){e.next=29;break}return(H=new a.t).setMessage((0,n.t)("1738")),H.setKeyWords(""),e.next=23,H.go();case 23:if(j=e.sent,H.getDetailedResult()!==a.D.kNewCommadIn){e.next=24;break}return d(),e.abrupt("return",{v:!1});case 24:if("number"==typeof j){e.next=25;break}return e.abrupt("return",1);case 25:return Y=j*Math.sin(N/2),m.setBasePt(O),m.setMessage("".concat((0,n.t)("1739"),"(").concat((0,n.t)("1740"),")")),m.setKeyWords(""),m.setUserDraw(function(e,t){var r=O.clone().addvec(e.sub(O).normalize().mult(2*Y)),n=K(r),i=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;i.addVertexAt(t,r)}),i.addVertexAt(_.point,n),i.addVertexAt(r),t.drawMcDbEntity(i)}),e.next=26,m.go();case 26:if(X=e.sent,m.getDetailedResult()!==a.D.kNewCommadIn){e.next=27;break}return d(),e.abrupt("return",{v:!1});case 27:if(X){e.next=28;break}return e.abrupt("return",1);case 28:return G=O.clone().addvec(X.sub(O).normalize().mult(2*Y)),(Z={}).bulge=0,Z.point=G,p[p.length-1].bulge=K(G),p.push(Z),r&&r(p),e.abrupt("return",0);case 29:if(z){e.next=30;break}return e.abrupt("return",1);case 30:(J={}).bulge=0,J.point=z,p[p.length-1].bulge=K(z),p.push(J),r&&r(p);case 31:if(!m.isKeyWordPicked("CE")){e.next=47;break}return m.setMessage((0,n.t)("1737")),m.setKeyWords(""),m.setUserDraw(function(){}),e.next=32,m.go();case 32:if(Q=e.sent,m.getDetailedResult()!==a.D.kNewCommadIn){e.next=33;break}return d(),e.abrupt("return",{v:!1});case 33:if(Q){e.next=34;break}return e.abrupt("return",{v:d()});case 34:return ee=_.point,te=Q.distanceTo(ee),m.setLastInputPoint(ee),m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords("[".concat((0,n.t)("169"),"(A)/").concat((0,n.t)("188"),"(L)]")),m.clearLastInputPoint(),m.setUserDraw(function(e,t){t.drawLine(e.toVector3(),Q.toVector3());var r=Q.clone().addvec(e.sub(Q).normalize().mult(te)),n=Q.sub(ee).angleTo2(Q.sub(r),a.v.kZAxis),i=new a.q((ee.x+r.x)/2,(ee.y+r.y)/2),s=Q.sub(i).normalize().mult(-te),c=Q.clone().addvec((u?n<Math.PI:n>Math.PI)?s.negate():s),o=a.f.calcBulge(ee,c,r).val,l=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;l.addVertexAt(t,r)}),l.addVertexAt(_.point,o),l.addVertexAt(r),t.drawMcDbEntity(l)}),e.next=35,m.go();case 35:if(re=e.sent,!m.isKeyWordPicked("A")){e.next=39;break}return(ne=new a.o).setBasePt(Q),ne.setMessage((0,a.a0)("ID_ARX_PLGET_I_ANGLE","".concat((0,n.t)("1736"),"(").concat((0,n.t)("1731"),")"))),ne.setKeyWords(""),ne.setUserDraw(function(e,t){var r=a.v.kXAxis.clone().angleTo2(e.sub(Q),a.v.kZAxis),n=u?2*Math.PI-r/2:r/2,i=ee.sub(Q).rotateBy(n).normalize().mult(te),s=ee.sub(Q).rotateBy(r).normalize().mult(te),c=Q.clone().addvec(i),o=Q.clone().addvec(s),l=a.f.calcBulge(ee,c,o).val,d=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;d.addVertexAt(t,r)}),d.addVertexAt(_.point,l),d.addVertexAt(o),t.drawMcDbEntity(d)}),e.next=36,ne.go();case 36:if(ae=e.sent,ne.getDetailedResult()!==a.D.kNewCommadIn){e.next=37;break}return d(),e.abrupt("return",{v:!1});case 37:if(null!==ae){e.next=38;break}return e.abrupt("return",1);case 38:return ie=u?2*Math.PI-ae/2:ae/2,se=ee.sub(Q).rotateBy(ie).normalize().mult(te),ue=ee.sub(Q).rotateBy(ae).normalize().mult(te),ce=Q.clone().addvec(se),oe=Q.clone().addvec(ue),le=a.f.calcBulge(ee,ce,oe).val,(de={}).bulge=0,de.point=oe,p[p.length-1].bulge=le,p.push(de),new a.r,r&&r(p),e.abrupt("return",0);case 39:if(!m.isKeyWordPicked("L")){e.next=44;break}return(fe=new a.t).setMessage("".concat((0,n.t)("1742"),"(").concat((0,n.t)("1731"),")")),fe.setKeyWords(""),fe.setBasePt(ee),fe.setUserDraw(function(e,t){var r=e.distanceTo(ee);if(!(r>2*te)){var n=2*Math.asin(r/2/te),i=ee.sub(Q).normalize().mult(te),s=Q.clone().addvec(i.clone().rotateBy(u?Math.PI-n/2:n/2)),c=Q.clone().addvec(i.clone().rotateBy(n)),o=a.f.calcBulge(ee,s,c).val,l=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;l.addVertexAt(t,r)}),l.addVertexAt(_.point,o),l.addVertexAt(c),t.drawMcDbEntity(l)}}),e.next=40,fe.go();case 40:if(pe=e.sent,fe.getDetailedResult()!==a.D.kNewCommadIn){e.next=41;break}return d(),e.abrupt("return",{v:!1});case 41:if("number"==typeof pe){e.next=42;break}return e.abrupt("return",1);case 42:if(!(pe>2*te)){e.next=43;break}return a.b.acutPrintf("*".concat((0,n.t)("1743")," ").concat((0,n.t)("1744"),"*")),m.setLastInputPoint(ee),e.abrupt("return",0);case 43:return be=2*Math.asin(pe/2/te),xe=ee.sub(Q).normalize().mult(te),ge=Q.clone().addvec(xe.clone().rotateBy(u?Math.PI-be/2:be/2)),ve=Q.clone().addvec(xe.clone().rotateBy(be)),ke=a.f.calcBulge(ee,ge,ve).val,(he={}).bulge=0,he.point=ve,p[p.length-1].bulge=ke,p.push(he),m.setLastInputPoint(ve),r&&r(p),e.abrupt("return",0);case 44:if(m.getDetailedResult()!==a.D.kNewCommadIn){e.next=45;break}return d(),e.abrupt("return",{v:!1});case 45:if(re){e.next=46;break}return e.abrupt("return",{v:d()});case 46:return ye=Q.clone().addvec(re.sub(Q).normalize().mult(te)),we=Q.sub(ee).angleTo2(Q.sub(ye),a.v.kZAxis),me=new a.q((ee.x+ye.x)/2,(ee.y+ye.y)/2),De=Q.sub(me).normalize().mult(-te),Pe=Q.clone().addvec((u?we<Math.PI:we>Math.PI)?De.negate():De),Me=a.f.calcBulge(ee,Pe,ye).val,(Ae={}).bulge=0,Ae.point=ye,p[p.length-1].bulge=Me,p.push(Ae),m.setLastInputPoint(ye),r&&r(p),e.abrupt("return",0);case 47:if(!m.isKeyWordPicked("R")){e.next=62;break}return(Ce=new a.t).setMessage((0,a.a0)("ID_ARX_PLGETSTARTRADIUS",(0,n.t)("1745"))),Ce.setKeyWords(""),e.next=48,Ce.go();case 48:if(Ee=e.sent,Ce.getDetailedResult()!==a.D.kNewCommadIn){e.next=49;break}return d(),e.abrupt("return",{v:!1});case 49:if(null!==Ee){e.next=50;break}return e.abrupt("return",1);case 50:return Ie=_.point,m.setLastInputPoint(Ie),m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords("[".concat((0,n.t)("169"),"(A)]")),m.setUserDraw(function(e,t){if(Ee){var r=e.distanceTo(Ie);if(!(r>2*Ee)){var n=Math.acos(r/2/Ee),i=Ie.clone().addvec(e.sub(Ie).rotateBy(n).normalize().mult(Ee)),s=i.clone().addvec(new a.q((Ie.x+e.x)/2,(Ie.y+e.y)/2).sub(i).normalize().mult(u?-Ee:Ee)),c=a.f.calcBulge(Ie,s,e).val,o=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;o.addVertexAt(t,r)}),o.addVertexAt(_.point,c),o.addVertexAt(e),t.drawMcDbEntity(o)}}}),e.next=51,m.go();case 51:if(_e=e.sent,!m.isKeyWordPicked("A")){e.next=58;break}return(Le=new a.o).setMessage((0,a.a0)("ID_ARX_PLGET_I_ANGLE",(0,n.t)("1736"))),Le.setKeyWords(""),Le.setBasePt(Ie),e.next=52,Le.go();case 52:if(Ve=e.sent,Le.getDetailedResult()!==a.D.kNewCommadIn){e.next=53;break}return d(),e.abrupt("return",{v:!1});case 53:if("number"==typeof Ve){e.next=54;break}return e.abrupt("return",1);case 54:return Se=Math.sin(Ve/2)*Ee*2,m.setMessage("".concat((0,n.t)("1739"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords(""),m.setBasePt(Ie),m.setUserDraw(function(e,t){if(Ee){var r=e.sub(Ie).normalize(),n=Ie.clone().addvec(r.clone().mult(Se)),i=n.clone().addvec(r.clone().negate().rotateBy(-(Math.PI/2-Ve/2)).mult(Ee)),s=i.clone().addvec(i.sub(new a.q((Ie.x+n.x)/2,(Ie.y+n.y)/2)).normalize().mult(u?Ee:-Ee)),c=a.f.calcBulge(Ie,s,n).val,o=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;o.addVertexAt(t,r)}),o.addVertexAt(_.point,c),o.addVertexAt(n),t.drawMcDbEntity(o)}}),e.next=55,m.go();case 55:if(Te=e.sent,m.getDetailedResult()!==a.D.kNewCommadIn){e.next=56;break}return d(),e.abrupt("return",{v:!1});case 56:if(Te){e.next=57;break}return e.abrupt("return",1);case 57:return Re=Te.sub(Ie).normalize(),We=Ie.clone().addvec(Re.clone().mult(Se)),Ne=We.clone().addvec(Re.clone().negate().rotateBy(-(Math.PI/2-Ve/2)).mult(Ee)),Oe=Ne.clone().addvec(Ne.sub(new a.q((Ie.x+We.x)/2,(Ie.y+We.y)/2)).normalize().mult(u?Ee:-Ee)),Ke=a.f.calcBulge(Ie,Oe,We).val,(ze={}).bulge=0,ze.point=We,p[p.length-1].bulge=Ke,p.push(ze),r&&r(p),e.abrupt("return",0);case 58:if(m.getDetailedResult()!==a.D.kNewCommadIn){e.next=59;break}return d(),e.abrupt("return",{v:!1});case 59:if(_e){e.next=60;break}return e.abrupt("return",1);case 60:if(!((Be=_e.distanceTo(Ie))>2*Ee)){e.next=61;break}return a.b.acutPrintf("".concat((0,n.t)("1730")," *").concat((0,n.t)("1744"),"*")),e.abrupt("return",0);case 61:return Ue=Math.acos(Be/2/Ee),Fe=Ie.clone().addvec(_e.sub(Ie).rotateBy(Ue).normalize().mult(Ee)),qe=Fe.clone().addvec(new a.q((Ie.x+_e.x)/2,(Ie.y+_e.y)/2).sub(Fe).normalize().mult(u?-Ee:Ee)),He=a.f.calcBulge(Ie,qe,_e).val,(je={}).bulge=0,je.point=_e,p[p.length-1].bulge=He,p.push(je),r&&r(p),e.abrupt("return",0);case 62:if(!m.isKeyWordPicked("D")){e.next=68;break}return m.setMessage((0,n.t)("1746")),m.setKeyWords(""),m.setUserDraw(function(e,t){t.drawLine(e.toVector3(),_.point.toVector3())}),e.next=63,m.go();case 63:if(Ye=e.sent,m.getDetailedResult()!==a.D.kNewCommadIn){e.next=64;break}return d(),e.abrupt("return",{v:!1});case 64:if(Ye){e.next=65;break}return e.abrupt("return",1);case 65:return Xe=Ye.sub(_.point),m.setLastInputPoint(_.point),m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords(""),m.setUserDraw(function(e,t){var r=$(_.point,e,u?Xe.clone().negate():Xe),n=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;n.addVertexAt(t,r)}),n.addVertexAt(_.point,r),n.addVertexAt(e),t.drawMcDbEntity(n)}),e.next=66,m.go();case 66:if(Ge=e.sent,m.getDetailedResult()!==a.D.kNewCommadIn){e.next=67;break}return d(),e.abrupt("return",{v:!1});case 67:return(Ze={}).bulge=0,Ze.point=Ge,p[p.length-1].bulge=$(_.point,Ze.point,u?Xe.clone().negate():Xe),p.push(Ze),r&&r(p),e.abrupt("return",0);case 68:if(!m.isKeyWordPicked("L")){e.next=69;break}i=!0,e.next=79;break;case 69:if(!m.isKeyWordPicked("S")){e.next=77;break}return Je=new a.q(p[p.length-1].point.x,p[p.length-1].point.y,0),(Qe=new a.i).setMessage((0,a.a0)("NO1_ID_SPECIFY_ARC2",(0,n.t)("1747"))),Qe.setBasePt(Je),e.next=70,Qe.go();case 70:if($e=e.sent,Qe.getDetailedResult()!==a.D.kNewCommadIn){e.next=71;break}return d(),e.abrupt("return",{v:!1});case 71:if(null!==$e){e.next=72;break}return e.abrupt("return",1);case 72:return(et=new a.i).setMessage((0,a.a0)("ID_CIRCULAR_ENDPOINT","".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")"))),et.setUserDraw(function(e,t){var r=new a.u;r.computeArc(Je.x,Je.y,$e.x,$e.y,e.x,e.y);var n=$e;u&&(n=r.center.clone().addvec(r.center.clone().sub($e)));var i=a.f.calcBulge(Je,n,e).val,s=new a.r;p.forEach(function(e){var t=e.point,r=e.bulge;s.addVertexAt(t,r)}),s.addVertexAt(_.point,i),s.addVertexAt(e),t.drawMcDbEntity(s)}),e.next=73,et.go();case 73:if(null===(tt=e.sent)){e.next=74;break}rt=$e,u&&((nt=new a.u).computeArc(Je.x,Je.y,$e.x,$e.y,tt.x,tt.y),rt=nt.center.clone().addvec(nt.center.clone().sub($e))),(at=a.f.calcBulge(Je,rt,tt)).ret?((it={}).point=tt,it.dBluge=0,p[p.length-1].bulge=at.val,p.push(it),r&&r(p)):a.b.acutPrintf((0,a.a0)("ID_ENDPOINT_INVALID1","\n ".concat((0,n.t)("189")," *").concat((0,n.t)("1744"),"*"))),e.next=76;break;case 74:if(et.getDetailedResult()!==a.D.kNewCommadIn){e.next=75;break}return d(),e.abrupt("return",{v:!1});case 75:return e.abrupt("return",1);case 76:e.next=79;break;case 77:if(!m.isKeyWordPicked("C")){e.next=78;break}return p[p.length-1].bulge=$(_.point,t,u?D.clone().negate():D),(st=new a.r).isClosed=!0,p.forEach(function(e){var t=e.point,r=e.bulge;st.addVertexAt(t,r)}),ut=st.getLength().val,r&&r(p),ct=o.drawEntity(st),e.abrupt("return",{v:{dist:ut,pl:st,plId:ct}});case 78:m.isKeyWordPicked("U")&&p.length>1&&(p.pop(),ot=new a.r,p.forEach(function(e){var t=e.point,r=e.bulge;ot.addVertexAt(t,r)}),r&&r(p),p.length>0&&m.setLastInputPoint(p[p.length-1].point));case 79:e.next=82;break;case 80:if(m.getDetailedResult()!==a.D.kNewCommadIn){e.next=81;break}return d(),e.abrupt("return",{v:!1});case 81:return e.abrupt("return",1);case 82:case"end":return e.stop()}},e)});case 5:return e.delegateYield(b(),"t0",6);case 6:if(0!==(x=e.t0)){e.next=7;break}return e.abrupt("continue",5);case 7:if(1!==x){e.next=8;break}return e.abrupt("continue",10);case 8:if(!x){e.next=9;break}return e.abrupt("return",x.v);case 9:e.next=5;break;case 10:return g=new a.r,p.forEach(function(e){var t=e.point,r=e.bulge;g.addVertexAt(t,r)}),v=g.getLength().val,r&&r(p),k=o.drawEntity(g),e.abrupt("return",{dist:v,pl:g,plId:k});case 11:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}();function te(e,t){var r=t.x,n=t.y;return e.x>r&&e.y>n||e.x<r&&e.y<n}function re(e,t){var r=(e.x+t.x)/2,n=(e.y+t.y)/2;return new a.q(r,n)}function ne(e,t,r){var n=te(e,r),a=te(t,r);return n&&a}function ae(){return ie.apply(this,arguments)}function ie(){return ie=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,w,m,D,P=arguments;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=P.length>0&&void 0!==P[0]&&P[0],r=new a.i,i=[],r.clearLastInputPoint(),r.setMessage((0,n.t)("1684")),e.next=1,r.go();case 1:if(s=e.sent,r.getDetailedResult()!==a.D.kNewCommadIn){e.next=2;break}return e.abrupt("return",!1);case 2:if(s){e.next=3;break}return e.abrupt("return");case 3:return r.setUserDraw(function(e,t){t.drawLine(s.toVector3(),e.toVector3())}),r.setMessage((0,n.t)("1694")),r.setKeyWords("[".concat((0,n.t)("1769"),"(M)]")),e.next=4,r.go();case 4:if(u=e.sent,r.getDetailedResult()!==a.D.kNewCommadIn){e.next=5;break}return e.abrupt("return",!1);case 5:if(r.getStatus()!==a.V.kCancel){e.next=6;break}return e.abrupt("return");case 6:if(!r.isKeyWordPicked("M")){e.next=10;break}return e.next=7,ee(s,function(e){var t=new a.r;e.forEach(function(e){var r=e.point,n=e.bulge;t.addVertexAt(r,n)}),a.b.acutPrintf((0,n.t)("191")+" = "+t.getLength().val)});case 7:if(!1!==(c=e.sent)){e.next=8;break}return e.abrupt("return",c);case 8:if(o=(c||{}).plId){e.next=9;break}return e.abrupt("return");case 9:return(l=o.getMcDbEntity())&&i.push(l),e.abrupt("return",{markedLines:i});case 10:if(!u){e.next=11;break}return t&&(d=ne(s,u,re(s,u)),(f=new Z).referenceAxis=new THREE.Vector3(0,0,d?-1:1),f.isAligned=!0,f.pt1=s.toVector3(),f.pt2=u.toVector3(),a.b.addToCurrentSpace(f),i.push(f),Math.abs(s.x-u.x)>.001&&Math.abs(s.y-u.y)>.001&&((p=new Z).isAligned=!1,p.referenceAxis=new THREE.Vector3(0,s.y>u.y?1:-1,-1),p.pt1=s.toVector3(),p.pt2=u.toVector3(),a.b.addToCurrentSpace(p),i.push(p),(b=new Z).isAligned=!1,b.referenceAxis=new THREE.Vector3(s.x>u.x?1:-1,0,-1),b.pt1=s.toVector3(),b.pt2=u.toVector3(),a.b.addToCurrentSpace(b),i.push(b),(x=new Q).offsetDist=0,x.center=s.toVector3(),x.pt1=s.toVector3().add(new THREE.Vector3(1,0,0)),x.pt2=u.toVector3(),a.b.addToCurrentSpace(x),i.push(x)),(g=new a.al).pt1=s.toVector3(),g.pt2=u.toVector3(),a.b.addToCurrentSpace(g),i.push(g)),v=s.distanceTo(u),k=u.x-s.x,h=u.y-s.y,y=u.z-s.z,w=Math.atan2(h,k)*(180/Math.PI),m=Math.sqrt(k*k+h*h+y*y),D=0===m?0:Math.asin(y/m)*(180/Math.PI),a.b.acutPrintf("".concat((0,n.t)("191")," = ").concat((0,n.v)(v,4)," , XY ").concat((0,n.t)("1770")," = ").concat((0,n.v)(w,4)," , ").concat((0,n.t)("1771")," XY ").concat((0,n.t)("1772")," = ").concat((0,n.v)(D,4),"\n X 增量 = ").concat((0,n.v)(k,4),"，  Y 增量 = ").concat((0,n.v)(h,4),"，   Z 增量 = ").concat((0,n.v)(y,4))),e.abrupt("return",{dist:v,angleInDegrees:w,angleWithZAxis:D,deltaX:k,deltaY:h,deltaZ:y,markedLines:i});case 11:case"end":return e.stop()}},e)})),ie.apply(this,arguments)}function se(){return ue.apply(this,arguments)}function ue(){return ue=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p=arguments;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=p.length>0&&void 0!==p[0]&&p[0];case 1:return r=new a.W,(i=new a.O).AddMcDbEntityTypes("CIRCLE,ARC"),r.setFilter(i),r.setMessage((0,n.t)("1762")),e.next=2,r.go();case 2:if(s=e.sent,r.getDetailedResult()!==a.D.kCodeAbort){e.next=3;break}return e.abrupt("return");case 3:if(r.getDetailedResult()!==a.D.kEcsIn){e.next=4;break}return e.abrupt("return");case 4:if(r.getDetailedResult()!==a.D.kMouseRightIn){e.next=5;break}return e.abrupt("return");case 5:if(r.getDetailedResult()!==a.D.kNewCommadIn){e.next=6;break}return e.abrupt("return",!1);case 6:if(r.getDetailedResult()!==a.D.kNullSpaceIn){e.next=7;break}return e.abrupt("return");case 7:if(r.getDetailedResult()!==a.D.kNullEnterIn){e.next=8;break}return e.abrupt("return");case 8:if(s){e.next=9;break}return e.abrupt("return");case 9:if(!((u=s.getMcDbEntity())instanceof a.u||u instanceof a.x)){e.next=12;break}if(c=[],!t){e.next=11;break}if(o=u.getClosestPointTo(r.getDocPickPoint(),!1),l=o.val,o.ret&&l){e.next=10;break}return e.abrupt("return");case 10:d=u.center,(f=new Z).pt1=l.toVector3(),f.pt2=d.toVector3(),f.isAligned=!0,f.offsetHeight=0,a.b.addToCurrentSpace(f),c.push(f);case 11:return a.b.acutPrintf((0,n.t)("187")+" = "+u.radius+"\n"+(0,n.t)("190")+" = "+2*u.radius+"\n"),e.abrupt("return",{radius:u.radius,markedLines:c});case 12:e.next=1;break;case 13:case"end":return e.stop()}},e)})),ue.apply(this,arguments)}function ce(e,t,r,n){var a=w(n,e,r),i=w(n,t,r);return!!isNaN(i)||!isNaN(a)&&(i===a?r.distanceTo(e)>r.distanceTo(t):a<i)}function oe(){return le.apply(this,arguments)}function le(){return(le=(0,n._)(n.a.mark(function e(){var t,r,i,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new a.W,(r=new a.O).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),i=n.a.mark(function e(){var i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,w,m,D,P,M,A,C,E,I,_,L,V,S,T,W,N,O,K,z,B,U,F,q,H,j,Y,X,G,Z,J,$;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setFilter(r),t.setMessage("".concat((0,n.t)("1581")).concat((0,n.t)("171"),"、").concat((0,n.t)("172"),"、").concat((0,n.t)("173"),"<").concat((0,n.t)("1586"),">")),e.next=1,t.go();case 1:if(i=e.sent,s=t.getDetailedResult(),u=[],t.getDetailedResult()!==a.D.kNewCommadIn){e.next=2;break}return e.abrupt("return",{v:!1});case 2:if(t.getDetailedResult()!==a.D.kCodeAbort){e.next=3;break}return e.abrupt("return",{v:!1});case 3:if(t.getDetailedResult()!==a.D.kEcsIn){e.next=4;break}return e.abrupt("return",{v:void 0});case 4:if(s!==a.D.kNullEnterIn&&s!==a.D.kNullSpaceIn&&s!==a.D.kMouseRightIn){e.next=11;break}return c=new a.an,o=new Q,c.setMessage("\n".concat((0,n.t)("1750"))),e.next=5,c.go();case 5:if(l=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:return o.center=l,c.setMessage("\n${t('1588')}"),c.setUserDraw(function(e,t){t.drawLine(e,l)}),e.next=7,c.go();case 7:if(d=e.sent){e.next=8;break}return e.abrupt("return",{v:void 0});case 8:return o.pt1=d,c.setMessage("\n".concat((0,n.t)("1589"),":")),c.setUserDraw(function(e,t){t.drawLine(e,l),t.drawLine(d,l),o.offsetDist=0,o.pt2=e,t.drawCustomEntity(o)}),e.next=9,c.go();case 9:if(f=e.sent){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:return o.pt2=f,p=l.distanceTo(d)-l.distanceTo(f),o.offsetDist=p<0?0:p/2,(b=new a.al).pt1=l,b.pt2=d,(x=new a.al).pt1=l,x.pt2=f,a.b.addToCurrentSpace(b),a.b.addToCurrentSpace(x),a.b.addToCurrentSpace(o),g=o.getAngle(),a.b.acutPrintf((0,n.t)("169")+" = "+g+"°"),u.push(o,b,x),e.abrupt("return",{v:{angle:g,markedArcs:u}});case 11:if(i){e.next=12;break}return e.abrupt("return",0);case 12:if(v=i.getMcDbEntity()){e.next=13;break}return e.abrupt("return",0);case 13:if(!(v instanceof a.p||v instanceof a.r)){e.next=30;break}if(m=t.getDocPickPoint(),v instanceof a.r?(P=R(v,m,2)||{},M=P.start,A=P.end,k=M,h=A):(k=v.startPoint,h=v.endPoint),k){e.next=14;break}return e.abrupt("return",0);case 14:if(h){e.next=15;break}return e.abrupt("return",0);case 15:return(C=new a.O).AddMcDbEntityTypes("LINE,LWPOLYLINE"),t.setFilter(C),t.setMessage((0,n.t)("1590")),e.next=16,t.go();case 16:if(E=e.sent,D=t.getDocPickPoint(),t.getDetailedResult()!==a.D.kNewCommadIn){e.next=17;break}return e.abrupt("return",{v:!1});case 17:if(t.getDetailedResult()!==a.D.kCodeAbort){e.next=18;break}return e.abrupt("return",{v:!1});case 18:if(t.getDetailedResult()!==a.D.kEcsIn){e.next=19;break}return e.abrupt("return",{v:void 0});case 19:if(E){e.next=20;break}return e.abrupt("continue",15);case 20:if(E.isValid()){e.next=21;break}return e.abrupt("continue",15);case 21:if((I=E.getMcDbEntity())instanceof a.r?(_=R(I,D,2)||{},L=_.start,V=_.end,y=L,w=V):I instanceof a.p&&(y=I.startPoint,w=I.endPoint),!y||!w){e.next=22;break}return e.abrupt("continue",23);case 22:return e.abrupt("continue",15);case 23:if(!(S=new a.p(k,h).IntersectWith(new a.p(y,w),a.l.Intersect.kExtendBoth)).isEmpty()){e.next=24;break}return a.b.acutPrintf((0,n.t)("1751")),e.abrupt("return",{v:void 0});case 24:if(k){e.next=25;break}return e.abrupt("return",0);case 25:if(h){e.next=26;break}return e.abrupt("return",0);case 26:if(y){e.next=27;break}return e.abrupt("return",0);case 27:if(w){e.next=28;break}return e.abrupt("return",0);case 28:if(D){e.next=29;break}return e.abrupt("return",0);case 29:return T=S.at(0),W=ce(k,h,T,m),N=W?k:h,O=ce(y,w,T,m),K=O?y:w,(z=new Q).center=T.toVector3(),z.pt1=N.toVector3(),z.pt2=K.toVector3(),z.isMaxRadius=!0,z.offsetDist=0,a.b.addToCurrentSpace(z),B=z.getAngle(),a.b.acutPrintf((0,n.t)("169")+" = "+B+"°"),u.push(z),(U=new a.al).pt1=z.pt1,U.pt2=z.center,(F=new a.al).pt1=z.center,F.pt2=z.pt2,a.b.addToCurrentSpace(U),a.b.addToCurrentSpace(F),u.push(U,F),e.abrupt("return",{v:{angle:B,markedArcs:u}});case 30:if(!(v instanceof a.u)){e.next=31;break}return(q=new Q).offsetDist=v.radius,q.center=v.center.toVector3(),q.pt1=new THREE.Vector3(v.radius),q.pt1.applyAxisAngle(new THREE.Vector3(0,0,1),v.startAngle).add(v.center.toVector3()),q.pt2=new THREE.Vector3(v.radius),q.pt2.applyAxisAngle(new THREE.Vector3(0,0,1),v.endAngle).add(v.center.toVector3()),(H=v.endAngle-v.startAngle)>Math.PI?H-=2*Math.PI:H<-Math.PI&&(H+=2*Math.PI),q.isClockwise=Math.abs(H)>Math.PI&&H>0,a.b.addToCurrentSpace(q),j=q.getAngle(),a.b.acutPrintf((0,n.t)("169")+" = "+j+"°"),u.push(q),(Y=new a.al).pt1=q.pt1,Y.pt2=q.center,(X=new a.al).pt1=q.center,X.pt2=q.pt2,a.b.addToCurrentSpace(Y),a.b.addToCurrentSpace(X),u.push(Y,X),e.abrupt("return",{v:{angle:j,markedArcs:u}});case 31:if(!(v instanceof a.x)){e.next=35;break}return(G=new Q).center=v.center.toVector3(),G.pt1=t.getDocPickPoint().toVector3(),(Z=new a.i).setUserDraw(function(e,t){G.pt2=e.toVector3(),G.offsetDist=0,t.drawCustomEntity(G)}),Z.setMessage((0,n.t)("1752")),e.next=32,Z.go();case 32:if(J=e.sent,Z.getDetailedResult()!==a.D.kNewCommadIn){e.next=33;break}return e.abrupt("return",{v:!1});case 33:if(J){e.next=34;break}return e.abrupt("return",{v:void 0});case 34:return G.pt2=J.toVector3(),G.offsetDist=v.radius,a.b.addToCurrentSpace(G),$=G.getAngle(),a.b.acutPrintf((0,n.t)("169")+" = "+$+"°"),u.push(G),e.abrupt("return",{v:{angle:$,markedArcs:u}});case 35:case"end":return e.stop()}},e)});case 1:return e.delegateYield(i(),"t0",2);case 2:if(0!==(s=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(!s){e.next=4;break}return e.abrupt("return",s.v);case 4:e.next=1;break;case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}(0,n.b)("_MxMeasurementDistance",ae);var de=function(e){var t=e.numVerts(),r=[];if(t<3)return r;var n=a.M.getCurrentMxCAD(),i=e.getPointAt(0).val,s=e.getPointAt(t-1).val;if(!e.isClosed&&!i.isEqualTo(s))return r;n.pathMoveTo(i.x,i.y);for(var u=0;u<t;u++){var c=e.getPointAt(u).val,o=e.getBulgeAt(u),l=e.getWidthsAt(u),d=l.val1,f=l.val2;n.pathLineToEx(c.x,c.y,d,f,o)}n.pathLineTo(s.x,s.y);var p=n.drawPathToHatch().getMcDbEntity();return p&&r.push(p),r},fe=function(){var e=(0,n._)(n.a.mark(function e(t){var r,i,s,u,c,o,l,d,f,p,b,x,g,v,k;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.M.getCurrentMxCAD(),!(t instanceof a.r)){e.next=1;break}return e.abrupt("return",de(t));case 1:if(!(t instanceof a.x)){e.next=3;break}if(r.pathMoveTo(t.center.x,t.center.y),r.pathCircle(t.center.x,t.center.y,t.radius),i=r.drawPathToHatch(),!(s=i.getMcDbEntity())){e.next=2;break}return e.abrupt("return",[s]);case 2:e.next=5;break;case 3:return u=t.clone(),c=r.getDatabase().currentSpace.getBoundingBox(),o=c.minPt,l=c.maxPt,d=o.clone(),f=l.clone(),u.move(d,f),p=u.getBoundingBox(),b=new a.q((p.minPt.x+p.maxPt.x)/2,(p.minPt.y+p.maxPt.y)/2),x=r.drawEntity(u),e.next=4,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 4:if(g=a.f.builderHatchFromPoint(b),x.erase(),u.erase(),!g){e.next=5;break}if(g.move(f,d),v=r.drawEntity(g),!(k=v.getMcDbEntity())){e.next=5;break}return e.abrupt("return",[k]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,w,m;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new a.i,r=[],i=!1,s=!1,u=0;case 1:return t.setMessage((i?"(".concat((0,n.t)("1753"),")"):"")+(s?"(".concat((0,n.t)("1754"),")"):"")+"".concat((0,n.t)("1617"),"<").concat((0,n.t)("177"),">")),t.setKeyWords("[".concat((0,n.t)("177"),"(O)/").concat(i?"":(0,n.t)("1755")+"(A)/").concat(s?"":(0,n.t)("1756")+"(S)/").concat((0,n.t)("1757"),"(X)]")),e.next=2,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 2:return e.next=3,t.go();case 3:if(c=e.sent,t.getDetailedResult()!==a.D.kNewCommadIn){e.next=4;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 4:if(t.getDetailedResult()!==a.D.kCodeAbort){e.next=5;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 5:if(t.getDetailedResult()!==a.D.kEcsIn&&t.getDetailedResult()!==a.D.kMouseRightIn){e.next=6;break}return e.abrupt("return",r.length>0?{markedLines:r}:void 0);case 6:if(!t.isKeyWordPicked("O")&&t.getDetailedResult()!==a.D.kNullEnterIn&&t.getDetailedResult()!==a.D.kNullSpaceIn){e.next=18;break}case 7:return(o=new a.W).setMessage((0,n.t)("1602")),e.next=8,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 8:return e.next=9,o.go();case 9:if(l=e.sent,o.getDetailedResult()!==a.D.kNewCommadIn){e.next=10;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 10:if(o.getDetailedResult()!==a.D.kCodeAbort){e.next=11;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 11:if(o.getDetailedResult()!==a.D.kEcsIn){e.next=12;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 12:if(o.getDetailedResult()!==a.D.kNullEnterIn&&o.getDetailedResult()!==a.D.kNullSpaceIn&&o.getDetailedResult()!==a.D.kMouseRightIn){e.next=13;break}return e.abrupt("continue",18);case 13:if(l){e.next=14;break}return e.abrupt("continue",7);case 14:if(d=l.getMcDbEntity()){e.next=15;break}return e.abrupt("continue",7);case 15:return f=d.getArea().val,p=0,d instanceof a.d&&(p=d.getLength().val),e.next=16,fe(d);case 16:if((b=e.sent)&&r.push.apply(r,(0,n.w)(b)),0===f&&b&&(d instanceof a.x?f=Math.PI*Math.pow(d.radius,2):d instanceof a.a5&&0===d.startAngle&&d.endAngle===2*Math.PI?(x=Math.sqrt(d.majorAxis.x*d.majorAxis.x+d.majorAxis.y*d.majorAxis.y)/2,g=x*d.radiusRatio,f=Math.PI*x*g,v=Math.pow((x-g)/(x+g),2),p=Math.PI*(x+g)*(1+3*v/(10+Math.sqrt(4-3*v)))):f=b.reduce(function(e,t){return e+t.getArea().val},0)),0===f?a.b.acutPrintf((0,n.t)("1758")+"\n"):a.b.acutPrintf("".concat((0,n.t)("1759")," = ").concat(f,", ").concat((0,n.t)("1760")," = ").concat(p,"\n")),!i&&!s){e.next=17;break}return i?u+=f:u-=f,a.b.acutPrintf("".concat((0,n.t)("1761")," = ").concat(u,"\n")),e.abrupt("continue",7);case 17:return e.abrupt("return",{markedLines:r});case 18:if(!t.isKeyWordPicked("A")){e.next=19;break}return i=!0,s=!1,e.abrupt("continue",1);case 19:if(!t.isKeyWordPicked("S")){e.next=20;break}return s=!0,i=!1,e.abrupt("continue",1);case 20:if(!t.isKeyWordPicked("X")){e.next=21;break}return a.b.acutPrintf("".concat((0,n.t)("1761")," = ").concat(u,"\n")),e.abrupt("return",r.length>0?{markedLines:r}:void 0);case 21:if(!c){e.next=26;break}return e.next=22,ee(c);case 22:if(!1!==(k=e.sent)){e.next=23;break}return e.abrupt("return",r.length>0?{markedLines:r}:k);case 23:if(h=(k||{}).plId){e.next=24;break}return e.abrupt("return",r.length>0?{markedLines:r}:void 0);case 24:if(!((y=h.getMcDbEntity())instanceof a.r)){e.next=26;break}if(y.isClosed=!0,r.push(y),w=de(y),r.push.apply(r,(0,n.w)(w)),m=y.getArea().val,a.b.acutPrintf("".concat((0,n.t)("1759")," = ").concat(y.getArea().val,", ").concat((0,n.t)("1760")," = ").concat(y.getLength().val,"\n")),!i&&!s){e.next=25;break}return i?u+=m:u-=m,a.b.acutPrintf("".concat((0,n.t)("1761")," = ").concat(u,"\n")),e.abrupt("continue",1);case 25:return e.abrupt("return",{markedLines:r});case 26:e.next=1;break;case 27:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function be(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(be=function(){return!!e})()}var xe=function(e){function t(){return(0,n.m)(this,t),function(e,t,r){return t=(0,n.r)(t),(0,n.s)(e,be()?Reflect.construct(t,r||[],(0,n.r)(e).constructor):t.apply(e,r))}(this,t,arguments)}return(0,n.p)(t,e),(0,n.l)(t,[{key:"getTypeName",value:function(){return"MxSelectLine"}},{key:"worldDraw",value:function(e){e.setLineWidthByPixels(!0),e.setLineWidth(10),e.setColor(16737894),e.drawSelectLine(this.pt1,this.pt2)}}])}(a.al);function ge(e,t,r){var n=e.distanceTo(t)/2,i=n*r,s=(n*n+i*i)/(2*i),u=(e.x+t.x)/2,c=(e.y+t.y)/2;return new a.q(u,c).addvec(t.clone().sub(e).perpVector().normalize().mult(s-i))}function ve(e,t,r,n){var a=t.clone().sub(e),i=r.clone().sub(e),s=a.length(),u=(new THREE.Vector3).crossVectors(a,i);void 0===n&&(n=u.dot(new THREE.Vector3(0,0,1))<0);var c=a.clone().add(i);return n&&(c=c.negate()),c=c.normalize(),e.clone().add(c.multiplyScalar(s))}function ke(){return(ke=(0,n._)(n.a.mark(function e(){var t,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.i).setMessage((0,n.t)("1749")),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:a.b.acutPrintf("X = ".concat(r.x,"     Y = ").concat(r.y,"     Z = ").concat(r.z," \n"));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function he(e,t,r,n){var a=e-r,i=t-n,s=0;return s=0==a?Math.PI/2:Math.atan(Math.abs(i/a)),a<0&&i>=0?s=Math.PI-s:a<0&&i<0?s=Math.PI+s:a>=0&&i<0&&(s=2*Math.PI-s),s-Math.PI}function ye(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.x-e.x,s=t.y-e.y,u=r.x-e.x,c=r.y-e.y,o=i*i+s*s;if(0===o||n){var l=0===o?0:(u*i+c*s)/o;return new a.q(e.x+i*l,e.y+s*l)}var d=(u*i+c*s)/o;return d<0?e:d>1?t:new a.q(e.x+i*d,e.y+s*d)}function we(e,t,r){var n=t.x-e.x,a=t.y-e.y,i=r.x-e.x,s=r.y-e.y,u=n*n+a*a;if(0===u)return r.x===e.x&&r.y===e.y;var c=(i*n+s*a)/u;return c>=0&&c<=1||(c<0?{isStart:!0}:{isStart:!1})}(0,n.b)("_MEASUREGEOM",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=(0,n.t)("1764"),s=[],u=function(){s.forEach(function(e){e.erase()})},e.prev=1,c=n.a.mark(function e(){var c,o,l,d,f,p,b,x,g,v,k,h,y,w,m,D,P,M,A,C,E,I,_,L,V;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(b=new a.i).setCursorType(a.a1.kCross),b.disableAllTrace(),b.setDisableDynInput(!0),b.clearLastInputPoint(),b.setMessage(i),x="[".concat((0,n.t)("191"),"(D)/").concat((0,n.t)("187"),"(R)/").concat((0,n.t)("169"),"(A)/").concat((0,n.t)("192"),"(AR)/").concat((0,n.t)("1767"),"(Q)/").concat((0,n.t)("193"),"(M)/").concat((0,n.t)("1757"),"(X)]"),b.setKeyWords(x),g=a.M.getCurrentMxCAD(),v=new a.j,k=new a.O([a.ao.kEntityType,"LINE,ARC,CIRCLE,LWPOLYLINE,INSERT"]),h=function(e,t,r){for(var n,i,s,u,c=function(){var u=e[o].getMcDbEntity();if(!u)return 0;if(u instanceof a.h){var c=u.blockTableRecordId.getMcDbBlockTableRecord();return c?{v:h(c.getAllEntityId(),t.clone(),r.clone())}:0}if(!(u instanceof a.d))return 0;var l,d,f=u.IntersectWith(new a.p(t,r),a.l.Intersect.kOnBothOperands);if(u instanceof a.r&&u.isClosed){var p=u.numVerts()-1,b=u.getPointAt(0).val,x=u.getPointAt(p).val,g=new a.p(b,x).IntersectWith(new a.p(t,r),a.l.Intersect.kOnBothOperands);if(!g.isEmpty()){var v=g.at(0),k=v.distanceTo(t);(void 0===n||k<n)&&(i=u,n=k,s=v)}}if(f.isEmpty())return 0;f.forEach(function(e){var r=e.distanceTo(t);(void 0===d||r<d)&&(d=r,l=e)}),(void 0===n||d<n)&&(i=u,n=d,s=l)},o=0;o<e.length;o++)if(0!==(u=c())&&u)return u.v;if(i)return{minDistEnt:i,minDist:n,intersectPt:s}},y=function(e,t){if(v.crossingSelect(e.x,e.y,t.x,t.y,k),!v.isNull())return h(v.getIds(),e,t)},w=function(e,t,r,n){var i=t.clone().addvec(r.clone().mult(a.b.viewCoordLong2Cad(16))),s=a.I.createDashedLines([t.toVector3(),i.toVector3()],8421504,.1,.1),u=t.clone().addvec(r.clone().mult(a.b.viewCoordLong2Cad(28)));e.drawEntity(s),e.drawText(n,a.b.viewCoordLong2Cad(16),0,u.toVector3())},m=function(e,t,r,n,i){var s;if(t instanceof a.r||t instanceof a.p){var u,c;if(t instanceof a.p&&(u=t.startPoint,c=t.endPoint),t instanceof a.r){var o=R(t,i,10);if(!o)return;var l=t.getBulgeAt(o.startIndex);if(0===l)u=o.start,c=o.end;else{var d=t.getParamAtPoint(o.start).val,f=t.getParamAtPoint(o.end).val,p=t.getDistAtParam(d).val,b=t.getDistAtParam(f).val,x=ge(o.start,o.end,l);e.drawCircle(o.end.toVector3(),5);var g=ve(x.toVector3(),o.start.toVector3(),o.end.toVector3()),v=g.x,k=g.y,h=new a.q(v,k),y=h.clone().sub(x).normalize(),m=x.distanceTo(h);Math.abs(l)>1&&(h.addvec(x.clone().sub(h).normalize().mult(2*m)),y.negate()),w(e,h,y,Math.abs(b-p).toFixed(3))}}if(u&&c){var D=new xe;D.pt1=u.toVector3(),D.pt2=c.toVector3(),e.drawCustomEntity(D);var P=new Z;return P.pt1=u.toVector3(),P.pt2=c.toVector3(),P.isAligned=!0,s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.x>r.x||n.y<r.y;P.referenceAxis=new THREE.Vector3(0,0,t?1:-1),e.drawCustomEntity(P)},{draw:s,line:new a.p(u,c)}}}if(t instanceof a.x){var M=new a.v(-1,0,0),A=t.center.clone().addvec(M.clone().mult(t.radius));w(e,A,M,t.getLength().val.toFixed(3))}if(t instanceof a.u){var C=t.getGripPoints().at(2);w(e,C,C.sub(t.center).normalize(),t.getLength().val.toFixed(3))}},D=function(e,t,r,n,i){if(n&&i&&(!n.startPoint.isEqualTo(i.startPoint)||!n.endPoint.isEqualTo(i.endPoint))){var s=n.IntersectWith(i,a.l.Intersect.kOnBothOperands);if(!s.isEmpty()){var u=new Q;u.offsetDist=0;var c=s.at(0),o=ce(n.startPoint,n.endPoint,c,t),l=ce(i.startPoint,i.endPoint,c,r);u.pt1=o?n.startPoint.toVector3():n.endPoint.toVector3(),u.pt2=l?i.startPoint.toVector3():i.endPoint.toVector3(),u.center=c.toVector3();var d=u.getAngle();if(d===Math.PI/2){e.setColor(16760576),u.radius=Math.min(a.b.viewCoordLong2Cad(10),Math.min(n.getLength().val,i.getLength().val)/10);var f=u.getRadius(!0),p=u.getStartPoint().clone().add(u.center.clone().sub(u.pt1).normalize().negate().multiplyScalar(f)),b=u.getEndPoint().clone().add(u.center.clone().sub(u.pt2).normalize().negate().multiplyScalar(f)),x=new THREE.Vector3(p.x+b.x-u.center.x,p.y+b.y-u.center.y);e.drawLine(p,x),e.drawLine(b,x)}else u.radius=a.b.viewCoordLong2Cad(26),e.drawCustomEntity(u);return d}}},P=function(e,t,r,n,i,s){var u=new a.p(t,r),c=new a.p(t,n),o=new a.p(t,i),l=new a.p(t,s),d=y(t,r),f=y(t,n),p=y(t,i),b=y(t,s);d&&(u.endPoint=d.intersectPt),f&&(c.endPoint=f.intersectPt),p&&(o.endPoint=p.intersectPt),b&&(l.endPoint=b.intersectPt),e.setColor(16777215);var x=d&&m(e,d.minDistEnt,t,r,d.intersectPt)||{},g=x.line,v=x.draw,k=f&&m(e,f.minDistEnt,t,n,f.intersectPt)||{},h=k.line,w=k.draw,P=p&&m(e,p.minDistEnt,t,i,p.intersectPt)||{},M=P.line,A=P.draw,C=b&&m(e,b.minDistEnt,t,s,b.intersectPt)||{},E=C.line,I=C.draw,_=d&&p&&D(e,d.intersectPt,p.intersectPt,g,M),L=d&&b&&D(e,d.intersectPt,b.intersectPt,g,E),V=f&&p&&D(e,f.intersectPt,p.intersectPt,h,M),S=f&&b&&D(e,f.intersectPt,b.intersectPt,h,E);d&&f&&D(e,d.intersectPt,f.intersectPt,g,h),p&&b&&D(e,p.intersectPt,b.intersectPt,M,E);var T=Math.PI/2,R=_===T&&L===T&&V===T&&S===T;function W(e){return e.startPoint.x===e.endPoint.x?1/0:(e.endPoint.y-e.startPoint.y)/(e.endPoint.x-e.startPoint.x)}var N=function(e,t){return function(e,t){return W(e)===W(t)}(e,t)&&function(e,t){return e.getLength().val===t.getLength().val}(e,t)},O=[];g&&O.push({line:g,draw:v,info:d}),h&&O.push({line:h,draw:w,info:f}),M&&O.push({line:M,draw:A,info:p}),E&&O.push({line:E,draw:I,info:b}),O.reduce(function(e,t){for(var r=!1,n=0;n<e.length;n++){var a=e[n];if(N(a[0].line,t.line)){a.push(t),r=!0;break}}return r||e.push([t]),e},[]).forEach(function(e){if(1===e.length){if(N(e[0].line,new a.p(u.endPoint,c.endPoint))||N(e[0].line,new a.p(o.endPoint,l.endPoint)))return;e[0].draw&&e[0].draw()}else if(!R)if(2===e.length){if(N(e[1].line,new a.p(u.endPoint,c.endPoint))||N(e[1].line,new a.p(o.endPoint,l.endPoint)))return;d&&f||p&&b?(d&&f&&(d.intersectPt.distanceTo(t)<f.intersectPt.distanceTo(t)?v&&v(!0):w&&w()),p&&b&&(p.intersectPt.distanceTo(t)<b.intersectPt.distanceTo(t)?A&&A(!1):I&&I())):(e[0].draw&&e[0].draw(),e[1].draw&&e[1].draw())}else e.forEach(function(e){var t=e.draw;t&&t()})}),e.setColor(16760576),e.drawMcDbEntity(u),e.drawMcDbEntity(c),e.drawMcDbEntity(o),e.drawMcDbEntity(l);var K=a.b.viewCoordLong2Cad(16);if(d&&f){var z=u.endPoint.distanceTo(c.endPoint);u.endPoint.distanceTo(t)>c.endPoint.distanceTo(t)?e.drawText(z.toFixed(3),K,0,new THREE.Vector3((t.x+u.endPoint.x)/2,(t.y+u.endPoint.y)/2)):e.drawText(z.toFixed(3),K,0,new THREE.Vector3((t.x+c.endPoint.x)/2,(t.y+c.endPoint.y)/2))}if(p&&b){var B=o.endPoint.distanceTo(l.endPoint);o.endPoint.distanceTo(t)>l.endPoint.distanceTo(t)?e.drawText(B.toFixed(3),K,0,new THREE.Vector3((t.x+o.endPoint.x)/2,(t.y+o.endPoint.y)/2)):e.drawText(B.toFixed(3),K,0,new THREE.Vector3((t.x+l.endPoint.x)/2,(t.y+l.endPoint.y)/2))}},b.setUserDraw(function(e,t){var r=a.b.viewCoordLong2Cad(g.mxdraw.getViewWidth()),n=a.b.viewCoordLong2Cad(g.mxdraw.getViewHeight()),i=new a.q(-r,e.y),s=new a.q(e.x+r,e.y),u=new a.q(e.x,e.y+n),c=new a.q(e.x,-n);P(t,e,i,s,u,c)}),e.next=1,b.go();case 1:if(t=b.keyWordPicked(),b.getStatus()!==a.V.kCancel){e.next=2;break}return e.abrupt("return",0);case 2:if(b.getDetailedResult()!==a.D.kCodeAbort){e.next=3;break}return e.abrupt("return",0);case 3:if(b.getDetailedResult()!==a.D.kEcsIn){e.next=4;break}return e.abrupt("return",0);case 4:if((b.getDetailedResult()===a.D.kMouseRightIn||b.getDetailedResult()===a.D.kNullSpaceIn||b.getDetailedResult()===a.D.kNullEnterIn)&&(t=r),"D"!==(null===(c=t)||void 0===c?void 0:c.toLocaleUpperCase())){e.next=7;break}return u(),e.next=5,ae(!0);case 5:if(!1!==(M=e.sent)){e.next=6;break}return e.abrupt("return",0);case 6:return(A=(M||{}).markedLines)&&s.push.apply(s,(0,n.w)(A)),e.next=7,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 7:if("R"!==(null===(o=t)||void 0===o?void 0:o.toLocaleUpperCase())){e.next=10;break}return u(),e.next=8,se(!0);case 8:if(!1!==(C=e.sent)){e.next=9;break}return e.abrupt("return",0);case 9:return(E=(C||{}).markedLines)&&s.push.apply(s,(0,n.w)(E)),e.next=10,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 10:if("A"!==(null===(l=t)||void 0===l?void 0:l.toLocaleUpperCase())){e.next=13;break}return u(),e.next=11,oe();case 11:if(!1!==(I=e.sent)){e.next=12;break}return e.abrupt("return",0);case 12:return(_=(I||{}).markedArcs)&&s.push.apply(s,(0,n.w)(_)),e.next=13,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 13:if("AR"!==(null===(d=t)||void 0===d?void 0:d.toLocaleUpperCase())){e.next=16;break}return u(),e.next=14,pe();case 14:if(!1!==(L=e.sent)){e.next=15;break}return e.abrupt("return",0);case 15:return(V=(L||{}).markedLines)&&s.push.apply(s,(0,n.w)(V)),e.next=16,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 16:if("Q"===(null===(f=t)||void 0===f?void 0:f.toLocaleUpperCase())&&u(),"X"!==(null===(p=t)||void 0===p?void 0:p.toLocaleUpperCase())){e.next=17;break}return e.abrupt("return",0);case 17:return x.includes(t)&&""!==t&&(r=t),e.abrupt("return",1);case 18:case"end":return e.stop()}},e)});case 2:return e.delegateYield(c(),"t0",3);case 3:if(0!==(o=e.t0)){e.next=4;break}return e.abrupt("continue",6);case 4:if(1!==o){e.next=5;break}return e.abrupt("continue",2);case 5:e.next=2;break;case 6:e.next=8;break;case 7:e.prev=7,l=e.catch(1),console.warn(l);case 8:u();case 9:case"end":return e.stop()}},e,null,[[1,7]])}))),(0,n.b)("ID",function(){return ke.apply(this,arguments)});var me=0,De=0,Pe={DE:(0,n.t)("1547"),P:(0,n.t)("1548"),T:(0,n.t)("1549"),DY:(0,n.t)("1550")},Me="DE",Ae=function(e,t,r,n){var i,s,u,c,o,l,d,f,p,b,x,g=e.getLength().val,v=e.getDistAtPoint(r).val,k=e.getStartPoint().val,h=e.getEndPoint().val,y=v<g/2;if(e instanceof a.p){var w=e.startPoint,m=e.endPoint;return y?(e.startPoint=k.clone().addvec(k.sub(h).normalize().mult(t)),i=function(){e.startPoint=w}):(e.endPoint=e.endPoint.clone().addvec(h.sub(k).normalize().mult(t)),i=function(){e.endPoint=m}),{ent:e,fallback:i}}if(e instanceof a.u){var D=e.startAngle,P=e.endAngle,M=e.clone();y?(M.startAngle=e.startAngle,M.endAngle=e.startAngle-1e-7):(M.startAngle=e.endAngle,M.endAngle=e.endAngle-1e-7);var A,C=M.getLength().val,E=e.center,I=e.getGripPoints().at(2),_=a.f.calcBulge(k,I,h).val>0;if(y)if(A=M.getPointAtDist(_?C-t:t).val,_)e.startAngle=he(E.x,E.y,A.x,A.y),i=function(){e.startAngle=D};else{var L=e.endAngle;e.startAngle=L,e.endAngle=he(E.x,E.y,A.x,A.y),i=function(){e.startAngle=D,e.endAngle=P}}else if(A=M.getPointAtDist(_?t:C-t).val,_)e.endAngle=he(E.x,E.y,A.x,A.y),i=function(){e.endAngle=P};else{var V=e.startAngle;e.startAngle=he(E.x,E.y,A.x,A.y),e.endAngle=V,i=function(){e.startAngle=D,e.endAngle=P}}return{fallback:i,ent:e}}if(e instanceof a.a5){var S=e.clone();if(S.startAngle=0,S.endAngle=2*Math.PI,t>S.getLength().val-g)return;var T=S.getPointAtDist(0).val,W=S.getPointAtDist(y?S.getDistAtPoint(k).val-t:S.getDistAtPoint(h).val+t).val,N=T.sub(S.center),O=W.sub(S.center),K=Math.atan2(N.y,N.x),z=Math.atan2(O.y,O.x)-K;z<0&&(z+=2*Math.PI);var B=e.startAngle,U=e.endAngle;return y?e.startAngle=z:e.endAngle=z,{fallback:function(){y?e.startAngle=B:e.endAngle=U},ent:e}}if(e instanceof a.r){if(e.isClosed)return;var F=function(e){for(var t=[],r=0;r<e.numVerts();r++){var n=e.getWidthsAt(r),a=n.val1,i=n.val2;t.push({point:e.getPointAt(r).val,bulge:e.getBulgeAt(r),startWidth:a,endWidth:i})}return t},q=function(e,t){for(;e.removeVertexAt(0););for(var r=0;r<t.length;r++){var n=t[r];e.addVertexAt(n.point,n.bulge,n.startWidth,n.endWidth,r)}},H=function(e,t,r){var n=ge(e,t,r),i=new a.u;return i.center=n,i.radius=n.sub(e).length(),i.startAngle=he(n.x,n.y,e.x,e.y),i.endAngle=he(n.x,n.y,t.x,t.y),i},j=function(e,t,r,n){if(r)if(n)e.startAngle=he(e.center.x,e.center.y,t.x,t.y);else{var a=e.endAngle;e.startAngle=a,e.endAngle=he(e.center.x,e.center.y,t.x,t.y)}else if(n)e.endAngle=he(e.center.x,e.center.y,t.x,t.y);else{var i=e.startAngle;e.startAngle=he(e.center.x,e.center.y,t.x,t.y),e.endAngle=i}return e},Y=e.numVerts();if(t<0){var X=y?e.getPointAtDist(Math.abs(t)).val:e.getPointAtDist(g-Math.abs(t)).val,G=R(e,X,.1);if(!G)return;var Z=G.start,J=G.end,Q=G.startIndex,$=G.endIndex,ee=e.getBulgeAt(Q),te=0===ee?function(e,t,r,n){var a=n.startIndex,i=n.endIndex,s=n.numVerts,u=F(e);if(e.setPointAt(r?a:i,t),r)for(var c=0;c<a;c++)e.removeVertexAt(0);else for(var o=i+1;o<s;o++)e.removeVertexAt(i+1);return function(){return q(e,u)}}(e,X,y,{startIndex:Q,endIndex:$,numVerts:Y}):function(e,t,r,n){var i=n.start,s=n.end,u=n.startIndex,c=n.endIndex,o=n.numVerts,l=n.bulge,d=F(e),f=H(i,s,l);j(f,t,r,l>0);var p=f.getGripPoints().at(2),b=a.f.calcBulge(r?t:i,p,r?s:t).val;if(e.setPointAt(r?u:c,t),e.setBulgeAt(u,b),r)for(var x=0;x<u;x++)e.removeVertexAt(0);else for(var g=c+1;g<o;g++)e.removeVertexAt(c+1);return function(){return q(e,d)}}(e,X,y,{start:Z,end:J,startIndex:Q,endIndex:$,numVerts:Y,bulge:ee});return{ent:e,fallback:te}}h=y?e.getPointAt(1).val:h,k=y?k:e.getPointAt(Y-2).val;var re=y?e.getBulgeAt(0):e.getBulgeAt(Y-2),ne=0===re?(s=e,u=t,l=(o={startPoint:k,endPoint:h,numVerts:Y}).startPoint,d=o.endPoint,f=o.numVerts,p=(c=y)?l.clone().addvec(l.sub(d).normalize().mult(u)):d.clone().addvec(d.sub(l).normalize().mult(u)),b=c?0:f-1,x=c?l:d,s.setPointAt(b,p),function(){return s.setPointAt(b,x)}):function(e,t,r,n){var i=n.startPoint,s=n.endPoint,u=n.numVerts,c=n.bulge,o=H(i,s,c),l=o.clone();l.startAngle=r?o.startAngle:o.endAngle,l.endAngle=l.startAngle-1e-7;var d=l.getLength().val,f=c>0,p=t%d,b=l.getPointAtDist(r?f?d-p:p:f?p:d-p).val;j(o,b,r,f);var x=o.getGripPoints().at(2),g=a.f.calcBulge(r?b:i,x,r?s:b).val,v=r?0:u-1,k=r?0:u-2,h=r?i:s,y=c;return e.setPointAt(v,b),e.setBulgeAt(k,g),function(){e.setPointAt(v,h),e.setBulgeAt(k,y)}}(e,t,y,{startPoint:k,endPoint:h,numVerts:Y,bulge:re});return{ent:e,fallback:ne}}};(0,n.b)("Mx_lengthen",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=new a.W,(i=new a.O).AddMcDbEntityTypes("LWPOLYLINE,LINE,ARC,ELLIPSE"),r.setFilter(i),s=function(){var e=(0,n._)(n.a.mark(function e(s){var u,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=n.a.mark(function e(){var u,c,o,l,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1551")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),r.setUserDraw(function(e,t){var r=a.f.findEntAtPoint(e.x,e.y,e.z,void 0,i);u&&u.highlight(!1),u=r.getMcDbCurve();var n=r.clone();n&&n instanceof a.d&&Ae(n,"number"==typeof s?s:s(n,e),e)&&(u&&u.highlight(!0),t.setColor(Number(n.trueColor.getColorValue(n.layerId))),t.drawMcDbEntity(n))}),e.next=1,r.go();case 1:if(c=e.sent,u&&u.highlight(!1),r.getStatus()!==a.V.kCancel&&r.getStatus()!==a.V.kNone){e.next=2;break}return e.abrupt("return",{v:!0});case 2:if(!r.isKeyWordPicked("U")){e.next=3;break}return(o=t.pop())?null==o||o.fallback():a.b.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 3:if(null!==c){e.next=4;break}return e.abrupt("return",{v:!0});case 4:if(null!==(l=c.getMcDbCurve())){e.next=5;break}return e.abrupt("return",{v:!0});case 5:return(d=Ae(l,"number"==typeof s?s:s(l,r.pickPoint()),r.pickPoint()))&&t.push(d),e.abrupt("return",0);case 6:case"end":return e.stop()}},e)});case 1:return e.delegateYield(u(),"t0",2);case 2:if(0!==(c=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(!c){e.next=4;break}return e.abrupt("return",c.v);case 4:e.next=1;break;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=(0,n._)(n.a.mark(function e(i){var s,u,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=function(e){if(e instanceof a.u){var t=e.clone();return t.startAngle=0,t.endAngle=i,t.getLength().val}if(e instanceof a.a5){var r=e.clone(),n=r.getLength().val;return r.endAngle+=i,r.getLength().val-n}return 0},u=n.a.mark(function e(){var i,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1551")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),(u=new a.O).AddMcDbEntityTypes("LWPOLYLINE,ARC,ELLIPSE"),r.setUserDraw(function(e,t){var r=a.f.findEntAtPoint(e.x,e.y,e.z,void 0,u);i&&i.highlight(!1),i=r.getMcDbCurve();var n=r.clone();if(n&&n instanceof a.d){var c=s(n);Ae(n,c,e)&&(i&&i.highlight(!0),t.setColor(Number(n.trueColor.getColorValue(n.layerId))),t.drawMcDbEntity(n))}}),e.next=1,r.go();case 1:if(c=e.sent,i&&i.highlight(!1),r.getStatus()!==a.V.kCancel&&r.getStatus()!==a.V.kNone){e.next=2;break}return e.abrupt("return",{v:!0});case 2:if(!r.isKeyWordPicked("U")){e.next=3;break}return(o=t.pop())?null==o||o.fallback():a.b.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 3:if(null!==c){e.next=4;break}return e.abrupt("return",{v:!0});case 4:if(null!==(l=c.getMcDbCurve())){e.next=5;break}return e.abrupt("return",{v:!0});case 5:return d=s(l),(f=Ae(l,d,r.pickPoint()))&&t.push(f),e.abrupt("return",0);case 6:case"end":return e.stop()}},e)});case 1:return e.delegateYield(u(),"t0",2);case 2:if(0!==(c=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(!c){e.next=4;break}return e.abrupt("return",c.v);case 4:e.next=1;break;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c=n.a.mark(function e(){var i,c,l,d,f,p,b,x,g,v,k,h,y,w,m;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage("".concat((0,n.t)("1554"),"<").concat(Pe[Me],"(DE)>")),r.setKeyWords("[".concat((0,n.t)("1547"),"(DE)/").concat((0,n.t)("1548"),"(P)/").concat((0,n.t)("1549"),"(T)/").concat((0,n.t)("1550"),"(DY)]")),e.next=1,r.go();case 1:if(i=e.sent,r.getStatus()!==a.V.kCancel){e.next=2;break}return e.abrupt("return",0);case 2:if(r.getStatus()!==a.V.kNone){e.next=3;break}return setTimeout(function(){Me&&a.b.setCommandLineInputData(Me,13)}),e.abrupt("return",1);case 3:if(!r.isKeyWordPicked("DE")){e.next=14;break}return Me="DE",(c=new a.t).setMessage("".concat((0,n.t)("1555"),"<").concat(me.toFixed(4),">")),c.setKeyWords("[".concat((0,n.t)("169"),"(A)]")),e.next=4,c.go();case 4:if(l=e.sent,c.getStatus()!==a.V.kCancel){e.next=5;break}return e.abrupt("return",0);case 5:if(c.getStatus()===a.V.kNone&&"number"==typeof me&&(l=me),!c.isKeyWordPicked("A")){e.next=10;break}return(d=new a.o).setMessage((0,n.t)("1557")),e.next=6,d.go();case 6:if(f=e.sent,d.getStatus()===a.V.kNone&&(f=0),c.getStatus()!==a.V.kCancel){e.next=7;break}return e.abrupt("return",0);case 7:if("number"==typeof f){e.next=8;break}return e.abrupt("return",0);case 8:return e.next=9,u(f);case 9:if(!e.sent){e.next=10;break}return e.abrupt("return",0);case 10:if("number"!=typeof l){e.next=13;break}return me=l,e.next=11,s(l);case 11:if(!e.sent){e.next=12;break}return e.abrupt("return",0);case 12:e.next=14;break;case 13:return e.abrupt("return",0);case 14:if(!r.isKeyWordPicked("P")){e.next=23;break}Me="P";case 15:return(p=new a.X).setMessage("".concat((0,n.t)("1558"),"<").concat(De.toFixed(4),">")),e.next=16,p.go();case 16:if(b=e.sent,p.getStatus()!==a.V.kCancel){e.next=17;break}return e.abrupt("return",2);case 17:if(p.getStatus()===a.V.kNone&&"number"==typeof b&&(De=b),"number"!=typeof b){e.next=21;break}if(!(b<=0)){e.next=18;break}return a.b.acutPrintf("\n"+(0,n.t)("1559")),e.abrupt("continue",15);case 18:return De=b,e.next=19,s(function(e){var t=e.getLength().val;return t/100*De-t});case 19:if(!e.sent){e.next=20;break}return e.abrupt("return",2);case 20:e.next=22;break;case 21:return e.abrupt("continue",23);case 22:e.next=15;break;case 23:if(!r.isKeyWordPicked("T")){e.next=33;break}return Me="T",(x=new a.t).setMessage((0,n.t)("1560")+"<"+(0).toFixed(4)+">"),x.setKeyWords("[".concat((0,n.t)("169"),"(A)]")),e.next=24,x.go();case 24:if(g=e.sent,x.getStatus()===a.V.kNone&&(g=0),x.getStatus()!==a.V.kCancel){e.next=25;break}return e.abrupt("return",0);case 25:if(!x.isKeyWordPicked("A")){e.next=30;break}return(v=new a.o).setMessage((0,n.t)("1561")+"<"+(0).toFixed(4)+">"),e.next=26,v.go();case 26:if(k=e.sent,x.getStatus()!==a.V.kCancel){e.next=27;break}return e.abrupt("return",0);case 27:if(x.getStatus()===a.V.kNone&&(k=0),"number"==typeof k){e.next=28;break}return e.abrupt("return",0);case 28:return e.next=29,s(function(e){return 0});case 29:if(!e.sent){e.next=30;break}return e.abrupt("return",0);case 30:if("number"==typeof g){e.next=31;break}return e.abrupt("return",0);case 31:return e.next=32,s(function(e){return g-e.getLength().val});case 32:if(!e.sent){e.next=33;break}return e.abrupt("return",0);case 33:if(!r.isKeyWordPicked("DY")){e.next=38;break}Me="DY",h=function(e,t,r,n,i,s){if(!(e instanceof a.r)){if(e instanceof a.p){var u,c=ye(e.startPoint,e.endPoint,t,!0),l=we(e.startPoint,e.endPoint,c);if("object"===(0,o.a)(l)&&l.isStart!==r){var d=e.startPoint,f=e.endPoint;return l.isStart?(e.endPoint=d,e.startPoint=c):(e.startPoint=f,e.endPoint=c),{ent:e,fallback:function(){e.startPoint=d,e.endPoint=f}}}return u=r?c.distanceTo(e.endPoint)-n:c.distanceTo(e.startPoint)-n,Ae(e,u,i)}if(e instanceof a.u){var p,b=e.startAngle,x=e.endAngle,g=e.getClosestPointTo(t,!0).val,v=e.getGripPoints().at(2),k=a.f.calcBulge(e.getGripPoints().at(0),v,e.getGripPoints().at(1)).val>0,h=e.center;if(k)e.endAngle=he(h.x,h.y,g.x,g.y),p=function(){e.endAngle=x};else{var y=e.startAngle;e.startAngle=he(h.x,h.y,g.x,g.y),e.endAngle=y,p=function(){e.startAngle=b,e.endAngle=x}}return{ent:e,fallback:p}}if(e instanceof a.a5){var w=e.endAngle,m=e.center,D=(Math.atan2(t.y-m.y,t.x-m.x)-Math.atan2(e.majorAxis.y,e.majorAxis.x)+2*Math.PI)%(2*Math.PI);return D<e.startAngle&&(D+=2*Math.PI),e.endAngle=D,{ent:e,fallback:function(){e.endAngle=w}}}}},y=n.a.mark(function e(){var i,s,u,c,o,l,d,f,p,b,x;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1551")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),e.next=1,r.go();case 1:if(s=e.sent,!r.isKeyWordPicked("U")){e.next=2;break}return(u=t.pop())?null==u||u.fallback():a.b.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 2:if(r.getStatus()!==a.V.kCancel&&r.getStatus()!==a.V.kNone){e.next=3;break}return e.abrupt("return",{v:{v:!0}});case 3:if(s){e.next=4;break}return e.abrupt("return",0);case 4:if(i=s.getMcDbCurve()){e.next=5;break}return e.abrupt("return",0);case 5:return c=r.pickPoint(),o=i.getLength().val,l=i.getDistAtPoint(c).val,d=l<o/2,(f=new a.i).setMessage((0,n.t)("1562")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),f.setUserDraw(function(e,t){if(i){i.highlight(!1);var r=s.clone();r instanceof a.d&&h(r,e,d,o,c)&&(i.highlight(!0),t.setColor(Number(i.trueColor.getColorValue(i.layerId))),t.drawMcDbEntity(r))}}),e.next=6,f.go();case 6:if(p=e.sent,i&&i.highlight(!1),f.getStatus()!==a.V.kCancel&&r.getStatus()!==a.V.kNone){e.next=7;break}return e.abrupt("return",{v:{v:!0}});case 7:if(!f.isKeyWordPicked("U")){e.next=8;break}return(b=t.pop())?null==b||b.fallback():a.b.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 8:if(null!==p){e.next=9;break}return e.abrupt("return",{v:{v:!0}});case 9:return i&&(x=h(i,p,d,o,c))&&t.push(x),e.abrupt("return",0);case 10:case"end":return e.stop()}},e)});case 34:return e.delegateYield(y(),"t0",35);case 35:if(0!==(w=e.t0)){e.next=36;break}return e.abrupt("continue",34);case 36:if(!w){e.next=37;break}return e.abrupt("return",w.v);case 37:e.next=34;break;case 38:if(i){e.next=39;break}return e.abrupt("return",1);case 39:if(m=i.getMcDbCurve()){e.next=40;break}return e.abrupt("return",1);case 40:return a.b.acutPrintf("\n"+(0,n.t)("1563")+": "+m.getLength().val.toFixed(4)),e.abrupt("return",1);case 41:case"end":return e.stop()}},e)});case 1:return e.delegateYield(c(),"t0",2);case 2:if(0!==(l=e.t0)){e.next=3;break}return e.abrupt("continue",7);case 3:if(1!==l){e.next=4;break}return e.abrupt("continue",1);case 4:if(2!==l){e.next=5;break}return e.abrupt("continue",7);case 5:if(!l){e.next=6;break}return e.abrupt("return",l.v);case 6:e.next=1;break;case 7:case"end":return e.stop()}},e)}))),(0,n.b)("deselect",function(){var e=a.M.getCurrentMxCAD();e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()});var Ce=function(){var e=(0,n._)(n.a.mark(function e(t){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,d.u)(),(a=r.dialog).showDialog(!0,t),e.prev=1,e.next=2,function(){return new Promise(function(e,t){a.onConfirm(e),a.onCancel(t)})}();case 2:return e.abrupt("return",e.sent);case 3:return e.prev=3,e.catch(1),e.abrupt("return",[""]);case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=(0,n._)(n.a.mark(function e(t){var r,i,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择需要".concat(t?"锁定":"解锁","图层的对象"));case 1:r=e.sent,i=new Set,s=(0,n.x)(),u=s.setValue,c=(0,f.s)(s),o=c.list,r.forEach(function(e){if(e.type===a.e.kMxCAD){var t=e.getMcDbEntity();if(!t)return;var r=o.value.findIndex(function(e){return e.name===t.layer});r>=0&&i.add(r)}}),u("lock",t,Array.from(i),!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();(0,n.b)("_OpenAllLayer",function(){var e=(0,n.x)(),t=e.setLayerList,r=e.stringifyJSON;(0,l.d)(!0),t(r())}),(0,n.b)("_SelOffLayer",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择需要关闭图层的实体");case 1:t=e.sent,r=new Set,i=(0,n.x)(),s=i.setValue,u=i.setLayerList,c=i.stringifyJSON,o=(0,f.s)(i),l=o.list,t.forEach(function(e){if(e.type===a.e.kMxCAD){var t=e.getMcDbEntity();if(!t)return;var n=l.value.findIndex(function(e){return e.name===t.layer});n>=0&&r.add(n)}}),s("visible",!1,Array.from(r)),u(c());case 2:case"end":return e.stop()}},e)}))),(0,n.b)("_layer_recovery",function(){(0,(0,n.x)().recoveryLayerStateHistory)()}),(0,n.b)("_layer_putCurrent",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.W).setMessage("选择将使其图层将成为当前图层的对象"),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:if(r.isValid()){e.next=3;break}return e.abrupt("return");case 3:if(i=r.getMcDbEntity()){e.next=4;break}return e.abrupt("return");case 4:if(s=(0,n.x)(),u=s.putCurrent,c=(0,f.s)(s),o=c.list,!((l=o.value.findIndex(function(e){var t=e.name;return i.layer===t}))<0)){e.next=5;break}return e.abrupt("return");case 5:u(l);case 6:case"end":return e.stop()}},e)}))),(0,n.b)("_layer_matching",(0,n._)(n.a.mark(function e(){var t,r,i,s,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择需要修改图层的对象");case 1:return t=e.sent,(r=new a.W).setMessage("选择匹配图层的对象"),r.setKeyWords("[名称(N)]"),e.next=2,r.go();case 2:if(i=e.sent,s="",!r.isKeyWordPicked("N")){e.next=7;break}return(0,d.u)().dialog.showDialog(!0),e.prev=3,e.next=4,Ce();case 4:s=e.sent[0],e.next=6;break;case 5:return e.prev=5,e.catch(3),e.abrupt("return");case 6:e.next=11;break;case 7:if(i){e.next=8;break}return e.abrupt("return");case 8:if(i.isValid()){e.next=9;break}return e.abrupt("return");case 9:if(u=i.getMcDbEntity()){e.next=10;break}return e.abrupt("return");case 10:s=u.layer;case 11:if(""!==s){e.next=12;break}return e.abrupt("return");case 12:t.forEach(function(e){var t=e.getMcDbEntity();t&&(t.layer=s)}),a.M.getCurrentMxCAD().updateDisplay();case 13:case"end":return e.stop()}},e,null,[[3,5]])}))),(0,n.b)("_layer_setEntToCurrentLayer",(0,n._)(n.a.mark(function e(){var t,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择需要修改图层的对象");case 1:t=e.sent,r=(0,n.y)().getCurrentlyLayerName(),t.forEach(function(e){var t=e.getMcDbEntity();t&&(t.layer=r)}),a.M.getCurrentMxCAD().updateDisplay();case 2:case"end":return e.stop()}},e)}))),(0,n.b)("_layer_CopyObjectsToNewLayer",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择要复制的对象");case 1:return t=e.sent,(r=new a.W).setMessage("选择目标图层上的对象"),r.setKeyWords("[名称(N)]"),e.next=2,r.go();case 2:if(i=e.sent,s="",!r.isKeyWordPicked("N")){e.next=4;break}return e.next=3,Ce();case 3:s=e.sent[0],e.next=8;break;case 4:if(i){e.next=5;break}return e.abrupt("return");case 5:if(i.isValid()){e.next=6;break}return e.abrupt("return");case 6:if(u=i.getMcDbEntity()){e.next=7;break}return e.abrupt("return");case 7:s=u.layer;case 8:return(c=new a.i).setMessage("指定基点"),e.next=9,c.go();case 9:if(o=e.sent){e.next=10;break}return e.abrupt("return");case 10:return c.setMessage("指定位移的第二个点"),c.setUserDraw(function(e,r){t.forEach(function(t){if(o){var n=t.clone();n&&(n.layer=s,n.move(o,e),r.drawMcDbEntity(n))}})}),e.next=11,c.go();case 11:l=e.sent,t.forEach(function(e){if(o&&l){var t=e.clone();if(t){t.move(o,l);var r=a.M.getCurrentMxCAD().drawEntity(t).getMcDbEntity();r&&(r.layer=s)}}});case 12:case"end":return e.stop()}},e)}))),(0,n.b)("_layer_freeze",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择需要冻结图层的对象");case 1:t=e.sent,r=new Set,i=(0,n.x)(),s=i.setValue,u=(0,f.s)(i),c=u.list,t.forEach(function(e){if(e.type===a.e.kMxCAD){var t=e.getMcDbEntity();if(!t)return;var n=c.value.findIndex(function(e){return e.name===t.layer});n>=0&&r.add(n)}}),s("freeze",!0,Array.from(r),!0);case 2:case"end":return e.stop()}},e)}))),(0,n.b)("_layer_thawedAll",function(){var e=(0,n.x)();(0,e.setValue)("freeze",!1,(0,f.s)(e).list.value.map(function(e,t){return t}),!0)}),(0,n.b)("_layer_lock",function(){return Ee(!0)}),(0,n.b)("_layer_unlock",function(){return Ee(!1)}),(0,n.b)("_layer_combined",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,p,b,x,g,v,k,h,y,w;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择要合并的图层上的对象",null,function(){var e=(0,n._)(n.a.mark(function e(r,a){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a,a.setKeyWords("[命名(N)]");case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}());case 1:if(r=e.sent,i=[],!t||!t.isKeyWordPicked("N")){e.next=3;break}return e.next=2,Ce({isMultiple:!0});case 2:i=e.sent,e.next=4;break;case 3:r&&(s=new Set,r.forEach(function(e){var t=e.getMcDbEntity();t&&s.add(t.layer)}),i=Array.from(s));case 4:if(!(i.length>0&&""===i[0])){e.next=5;break}return e.abrupt("return");case 5:return a.b.acutPrintf("\n选定的图层:"+i.join(",")),(u=new a.W).setMessage("选择目标图层上的对象"),u.setKeyWords("名称(N)"),e.next=6,u.go();case 6:if(c=e.sent,o="",!u.isKeyWordPicked("N")){e.next=8;break}return e.next=7,Ce();case 7:o=e.sent[0],e.next=12;break;case 8:if(c){e.next=9;break}return e.abrupt("return");case 9:if(c.isValid()){e.next=10;break}return e.abrupt("return");case 10:if(l=c.getMcDbEntity()){e.next=11;break}return e.abrupt("return");case 11:o=l.layer;case 12:return a.b.acutPrintf("\n将要把"+i.length+'个图层合并到图层"'+o+'"中。'),(d=new a.Z).setMessage("是否继续?"),d.setKeyWords("[是(Y)/否(N)]"),e.next=13,d.go();case 13:"Y"===(null==(p=e.sent)?void 0:p.toLocaleUpperCase())&&((b=new a.j).allSelect(),b.forEach(function(e){var t=e.getMcDbEntity();t&&i.includes(t.layer)&&(t.layer=o)}),x=(0,n.x)(),g=x.remove,v=x.setLayerList,k=x.stringifyJSON,h=(0,f.s)(x),y=h.list,w=i.map(function(e){return y.value.findIndex(function(t){return t.name===e})}),g(w),v(k()));case 14:case"end":return e.stop()}},e)}))),(0,n.b)("_layer_remove",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,p,b,x,g,v,k,h,y,w;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.f.userSelect("选择要合并的图层上的对象",null,function(){var e=(0,n._)(n.a.mark(function e(r,a){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a,a.setKeyWords("[命名(N)]");case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}());case 1:if(r=e.sent,i=[],!t||!t.isKeyWordPicked("N")){e.next=3;break}return e.next=2,Ce({isMultiple:!0});case 2:i=e.sent,e.next=4;break;case 3:r&&(s=new Set,r.forEach(function(e){var t=e.getMcDbEntity();t&&s.add(t.layer)}),i=Array.from(s));case 4:if(!(i.length>0&&""===i[0])){e.next=5;break}return e.abrupt("return");case 5:return(u=new a.Z).setMessage("删除图层上的对象"),u.setKeyWords("[删除(D)/不删除对象改为当前图层(C)]"),e.next=6,u.go();case 6:if(c=e.sent,u.getStatus()!==a.V.kCancel){e.next=7;break}return e.abrupt("return");case 7:o="D"===(null==c?void 0:c.toLocaleUpperCase()),l=(0,n.y)().getCurrentlyLayerName(),d=(0,n.x)(),p=d.remove,b=d.setLayerList,x=d.stringifyJSON,g=(0,f.s)(d),v=g.list,k=i.map(function(e){return v.value.findIndex(function(t){return t.name===e})}),h=p(k),b(x()),h?((y=new a.j).allSelect(),w=h.map(function(e){return e.name}),y.forEach(function(e){var t=e.getMcDbEntity();t&&w.includes(t.layer)&&(o?t.erase():t.layer=l)}),a.b.acutPrintf("\n已删除的图层:"+w.join(",")+'"\n命令')):a.b.acutPrintf("删除图层失败\n命令");case 8:case"end":return e.stop()}},e)})));var Ie=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r=n.a.mark(function e(){var r,i,s,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=n.S.instance)||void 0===r||!r.isDialogOpen){e.next=1;break}return e.abrupt("return",{v:void 0});case 1:return(i=new a.i).clearLastInputPoint(),i.setMessage((0,n.t)("2105")+":"),i.setCursorType(a.a1.kCross),e.next=2,i.go();case 2:if(s=e.sent,i.getStatus()!==a.V.kCancel){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:if(s){e.next=4;break}return e.abrupt("return",0);case 4:if(0!==t){e.next=8;break}return(u=new a.t).setMessage((0,n.t)("2106")+":"),e.next=5,u.go();case 5:if(c=e.sent,u.getStatus()!==a.V.kCancel){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(null!==c){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:t=c;case 8:return(o=new a.m).textString="",o.position=s,o.alignmentPoint=o.position,o.height=t,l=a.M.getCurrentMxCAD().drawEntity(o),d=l.getMcDbEntity(),e.prev=9,e.next=10,new Promise(function(e){d instanceof a.m&&new n.S(d,s).onClose(function(t){t||o.erase(),e()})});case 10:return e.abrupt("return",0);case 11:return e.prev=11,f=e.catch(9),o.erase(),console.error(f),e.abrupt("return",1);case 12:case"end":return e.stop()}},e,null,[[9,11]])});case 1:return e.delegateYield(r(),"t0",2);case 2:if(0!==(i=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(1!==i){e.next=4;break}return e.abrupt("continue",6);case 4:if(!i){e.next=5;break}return e.abrupt("return",i.v);case 5:e.next=1;break;case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),_e=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=n.S.instance)||void 0===t||!t.isDialogOpen){e.next=1;break}return e.abrupt("return");case 1:r=n.a.mark(function e(){var t,r,i,s,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.O).AddMcDbEntityTypes("TEXT,MTEXT,CUSTOMENTITY"),(r=new a.W).setFilter(t),r.setMessage((0,n.t)("2107")),e.next=1,r.go();case 1:if(i=e.sent,r.getStatus()!==a.V.kCancel){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(i&&i.isValid()){e.next=3;break}return e.abrupt("return",0);case 3:if(!((s=i.getMcDbEntity())instanceof a.m)){e.next=7;break}return e.prev=4,e.next=5,new Promise(function(e){new n.S(s,r.pickPoint()).onClose(function(t){e()})});case 5:return e.abrupt("return",0);case 6:return e.prev=6,u=e.catch(4),console.error(u),e.abrupt("return",1);case 7:case"end":return e.stop()}},e,null,[[4,6]])});case 2:return e.delegateYield(r(),"t0",3);case 3:if(0!==(i=e.t0)){e.next=4;break}return e.abrupt("continue",2);case 4:if(1!==i){e.next=5;break}return e.abrupt("continue",7);case 5:if(!i){e.next=6;break}return e.abrupt("return",i.v);case 6:e.next=2;break;case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();(0,n.b)("Mx_EditText",_e),(0,n.b)("_DrawText",Ie);var Le=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f,p,b,x,g,v,k,h,y,w,m,D;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.M.getCurrentMxCAD(),(r=new a._).setStyleName(n.z.currentName),i=r.getJustification(),s=r.getScale(),r.setJustification(i),r.setScale(s),u=[],c=function(e,t){if(0!==u.length){var r=new a._;r.setJustification(i),r.setScale(s),r.setStyleName(n.z.currentName),u.forEach(function(e){r.addVertex(e)}),r.addVertex(e),t.drawMcDbEntity(r)}},o=function(){},e.prev=1;case 2:return(l=new a.i).clearLastInputPoint(),l.setMessage((0,n.t)("1684")),l.setKeyWords("[".concat((0,n.t)("1685"),"(J)/").concat((0,n.t)("1686"),"(M)/").concat((0,n.t)("1624"),"(S)]")),e.next=3,l.go();case 3:if(d=e.sent,l.getStatus()!==a.V.kCancel){e.next=4;break}return o(),e.abrupt("return",!1);case 4:if(l.getDetailedResult()!==a.D.kNewCommadIn){e.next=5;break}return o(),e.abrupt("return",!1);case 5:if(!l.isKeyWordPicked("J")){e.next=10;break}return(f=new a.i).setMessage((0,n.t)("1687")+"<"+(0,n.t)("1688")+">"),f.setKeyWords("[".concat((0,n.t)("1689"),"(T)/").concat((0,n.t)("1690"),"(M)/").concat((0,n.t)("1691"),"(B)/").concat((0,n.t)("1688"),"(A)]")),e.next=6,f.go();case 6:if(console.log(f.getStatus()),f.getStatus()!==a.V.kNone){e.next=7;break}i=1,e.next=8;break;case 7:if(f.getStatus()!==a.V.kCancel){e.next=8;break}return e.abrupt("continue",2);case 8:if(f.getDetailedResult()!==a.D.kNewCommadIn){e.next=9;break}return o(),e.abrupt("return",!1);case 9:return f.isKeyWordPicked("T")?i=0:f.isKeyWordPicked("M")?i=1:f.isKeyWordPicked("B")?i=2:f.isKeyWordPicked("A")&&(i=-1),r.setJustification(i),e.abrupt("continue",2);case 10:if(!l.isKeyWordPicked("M")){e.next=14;break}return(p=new a.X).setMessage((0,n.t)("1692")+"<"+s.toString()+">"),e.next=11,p.go();case 11:if(b=e.sent,p.getStatus()!==a.V.kCancel){e.next=12;break}return e.abrupt("continue",2);case 12:if(p.getDetailedResult()!==a.D.kNewCommadIn){e.next=13;break}return o(),e.abrupt("return",!1);case 13:return p.getStatus()===a.V.kOk&&"number"==typeof b&&(x=b,!isNaN(x)&&x>0&&(s=x,r.setScale(s))),e.abrupt("continue",2);case 14:if(!l.isKeyWordPicked("S")){e.next=16;break}return(g=new a.Y).setMessage((0,n.t)("1693")),e.next=15,g.go();case 15:return(v=e.sent)&&n.z.keys().includes(v)&&r.setStyleName(v),e.abrupt("continue",2);case 16:if(!d){e.next=17;break}return u.push(d.clone()),r.addVertex(d),e.abrupt("continue",18);case 17:e.next=2;break;case 18:k=!0;case 19:return h=k?(0,n.t)("1694"):(0,n.t)("1636"),(y=new a.i).setMessage(h),k||y.setKeyWords(u.length>2?"[".concat((0,n.t)("1728"),"(C)/").concat((0,n.t)("1654"),"(U)]"):"[".concat((0,n.t)("1654"),"(U)]")),w=u[u.length-1],y.setBasePt(w),y.setUserDraw(function(e,t){return c(e,t),1}),e.next=20,y.go();case 20:if(m=e.sent,y.getDetailedResult()!==a.D.kMouseRightIn){e.next=21;break}return e.abrupt("continue",28);case 21:if(y.getStatus()!==a.V.kCancel){e.next=23;break}if(!(u.length>1)){e.next=22;break}return e.abrupt("continue",28);case 22:return o(),e.abrupt("return",!1);case 23:if(y.getDetailedResult()!==a.D.kNewCommadIn){e.next=24;break}return o(),e.abrupt("return",!1);case 24:if(!y.isKeyWordPicked("U")){e.next=25;break}return u.length>1&&(u.pop(),r.removeVertexAt(r.getVertexCount()-1),k=1===u.length),e.abrupt("continue",19);case 25:if(!y.isKeyWordPicked("C")){e.next=27;break}if(!(u.length>=3)){e.next=26;break}return r.setIsClosed(!0),t.drawEntity(r),e.abrupt("return",!0);case 26:return a.b.acutPrintf((0,n.t)("3714")),e.abrupt("continue",19);case 27:m&&(u.push(m.clone()),r.addVertex(m),k=!1),e.next=19;break;case 28:if(!(u.length>=2)){e.next=29;break}return t.drawEntity(r),e.abrupt("return",!0);case 29:return e.abrupt("return",!1);case 30:return e.prev=30,D=e.catch(1),console.error("绘制多线出错:",D),e.abrupt("return",!1);case 31:return e.prev=31,o(),e.finish(31);case 32:case"end":return e.stop()}},e,null,[[1,30,31,32]])}));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log((0,n.t)("1695")),e.next=1,Le();case 1:return e.abrupt("return",!0);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function Se(e,t){return Te.apply(this,arguments)}function Te(){return Te=(0,n._)(n.a.mark(function e(t,r){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,n._)(n.a.mark(function e(i){var s,u,c,o,l,d,f,p,x,g,v,h,y,w,m,D,P,M,A,C;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=t.hash,u=t.type,c=t.file,o=(0,n.o)(),l=o.hideLoading,d=o.showLoading,e.next=2;break;case 1:return e.abrupt("return",i(!0));case 2:if(u!==(0,n.g)()){e.next=3;break}c.source.source.size/1048576>1&&d(),f=URL.createObjectURL(c.source.source),setTimeout(function(){Y(f),setTimeout(function(){URL.revokeObjectURL(f)},5e3)}),e.next=7;break;case 3:if(p=(0,n.D)()||{},x=p.mxfilepath,g=void 0===x?"":x,v=(0,n.L)(),h=v+g+s+"."+u+(0,n.g)(!0),y=v+g+s+"/___mx___tz___.dwg.mxweb",w=!1,t.isUseServerExistingFile){e.next=6;break}return e.next=4,k(h,s);case 4:if((m=e.sent).ok){e.next=5;break}return l(),e.abrupt("return",i(!1));case 5:m.tz&&(w=!0);case 6:(0,n.H)((0,n.t)("1541")+"..."),(0,n.I)(!0),D=(new Date).getTime(),P=0,r||(P=a.ap.EMSCRIPTEN_FETCH_LOAD_TO_MEMORY|a.ap.EMSCRIPTEN_FETCH_PERSIST_FILE|a.ap.EMSCRIPTEN_FETCH_REPLACE),M=a.M.App.getCurrentMxCAD(),A=!1,n.J.emit("startOpenFile"),C=M.openWebFile(h,function(e){if(l(),A=!0,(0,n.K)(),0===e){if(i(!0),(new Date).getTime()-D>5e3&&(0,n.h)().success((0,n.t)("1542")+"..."),w){var t=v+"/mxcad/files/tz";b.a.post(t,{fileHash:s}).then(function(e){e&&e.data&&0==e.data.code&&M.getImp().loadTz(y)})}}else i(!1),(0,n.h)().error((0,n.t)("1543"))},void 0,void 0,P,!w),(0,n.n)(h).then(function(e){e/1048576>1&&C&&!A&&d()}),i(!!C),i(!1);case 7:(0,n.G)(c.name);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)})),Te.apply(this,arguments)}(0,n.b)("MLINE",Ve),(0,n.B)(function(){(new n.M).rxInit()}),(0,n.A)();var Re=(0,n.i)();(0,n.b)("OpenDwg",(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=1;break;case 1:return Re=(0,n.i)(),e.next=2,(0,n.C)(!1,"OpenDwgImp");case 2:Re&&(0,n.c)("MxFullScreen");case 3:case"end":return e.stop()}},e)}))),(0,n.b)("OpenDwg_DoNotUseCache",(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=1;break;case 1:return Re=(0,n.i)(),e.next=2,(0,n.C)(!0,"OpenDwgImp_DoNotUseCache");case 2:Re&&(0,n.c)("MxFullScreen");case 3:case"end":return e.stop()}},e)}))),(0,n.b)("OpenDwgImp_DoNotUseCache",function(){var e=(0,n._)(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Se(t,!1);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),(0,n.b)("OpenDwgImp",function(){var e=(0,n._)(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Se(t,!0);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),(0,n.b)("Mx_SaveAs",g),(0,n.b)("Mx_QSave",v),(0,n.b)("Mx_Export_DWG",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 1:e.next=3;break;case 2:Re=(0,n.i)(),t=function(){Re&&(0,n.c)("MxFullScreen")},r=(0,n.D)()||{},i=r.baseUrl,s=void 0===i?"":i,u=r.saveDwgUrl,c=void 0===u?"":u,o=r.mxfilepath,l=void 0===o?"":o,"http://localhost"==s.substring(0,16)&&(s=(0,n.E)()+s.substring(16)),"http://localhost"==c.substring(0,16)&&(c=(0,n.E)()+c.substring(16)),(d=a.M.getCurrentMxCAD()).saveFileToUrl(c,function(e,r){try{var i=JSON.parse(r);if("ok"==i.ret){var u=s+l+i.file;fetch(u).then(function(){var e=(0,n._)(n.a.mark(function e(r){var i,s,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(e){var t=e.toLowerCase(),r=t.lastIndexOf(".");if(-1!==r){var a=t.substring(r);if(a===(0,n.g)(!0))return e.substring(0,r)+".dwg";if(".dwg"===a||".dxf"===a)return e}return e+".dwg"},e.next=1,r.blob();case 1:return i=e.sent,s=d.getCurrentOriginaFileName(),s=u(s),e.next=2,a.J.saveAsFileDialog({blob:i,filename:s,types:[{description:"dwg"+(0,n.t)("1544"),accept:{"application/octet-stream":[".dwg"]}}]});case 2:t();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}else console.log(r)}catch(e){console.log("Mx: sserverResult error")}});case 3:case"end":return e.stop()}},e)}))),(0,n.b)("Mx_debug",function(){}),(0,n.b)("Mx_clear_buf",function(){}),(0,n.b)("Mx_Array",i.M),(0,n.b)("Mx_NewFile",function(){a.M.getCurrentMxCAD().newFile();var e=(0,n.x)().initLayerList,t=(0,n.u)().initColorIndexList,r=(0,n.F)().initLineTypeList;e(),t(),r()}),(0,n.b)("Mx_NewFile_Template",function(){a.M.getCurrentMxCAD().openWebFile("empty_template.mxweb")}),(0,n.b)("MxPE_DrawMText_old",(0,n._)(n.a.mark(function e(){var t,r,i,s,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new a.i).setMessage((0,n.t)("1545")),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:return i=(0,p.u)(),s=i.open,e.next=3,s();case 3:if("boolean"!=typeof(u=e.sent)){e.next=4;break}return e.abrupt("return");case 4:return c=u.text,o=u.size,(l=new a.k).contents=c||"",o&&(l.textHeight=o),l.location=r,d=a.M.getCurrentMxCAD(),f=d.drawEntity(l),d.updateDisplay(),e.abrupt("return",f);case 5:case"end":return e.stop()}},e)})))}}]);