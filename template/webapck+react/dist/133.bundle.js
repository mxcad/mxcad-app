"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[133],{837:function(e,t,r){r.d(t,{u:function(){return a}});var n=r(8741),a=function(){return{dialog:n.dz}}},2566:function(e,t,r){r.d(t,{d:function(){return u},u:function(){return c}});var n=r(8741);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var i,s=!1,u=function(e){var t=i,r=t.setValue;t.setLayerList;var a=(0,n.a3)(i).list;r("visible",e="boolean"==typeof e?e:s,a.value.map(function(e,t){return t})),s=!e},c=function(e){var t=e.onAddLayer;i=(0,n.a2)();var r=(0,n.cz)("Shift"),c=(0,n.cz)("Control"),o=i,l=o.add,d=o.remove,f=o.putCurrent,p=o.toggle,x=o.setValue,b=o.setIndex,g=o.getIndex,v=o.stringifyJSON;o.create;var k,w,h,y=o.initLayerList,m=o.setLayerList,M=(0,n.a3)(i),D=M.index,P=M.list,A=M.currentLayer,C=M.rootId,E=function(){return Array.isArray(D.value)&&D.value.length>1},I=function(e,t){if(t&&t.target&&S(t.target),r.value){void 0===k&&(k=D.value);var a=Math.max(k,e),i=a===e?k:e;b((0,n.cC)(i,a))}else if(c.value){var s=[];if(Array.isArray(D.value)){var u=D.value.indexOf(e);u>=0&&D.value.length>1?(s=(0,n.Y)(D.value)).splice(u,1):s=[].concat((0,n.Y)(D.value),[e])}else s=[D.value,e];b(s)}else b(e),k=e,L()},L=function(){w=Array.isArray(D.value)?D.value[D.value.length-1]:D.value},_=function(){t&&t(l()),r&&(k=P.value.length-1)},S=function(e){if(e)if("INPUT"===e.tagName)h=e;else{var t=null==e?void 0:e.getElementsByTagName("input")[0];t?h=t:S(e.parentNode)}},T=function(e){var t=g();if(!(Array.isArray(t)&&t.length>1)){var r=Array.isArray(t)?t[0]:t;A.value!==P.value[r]&&P.value[r].id!==C.value&&e&&setTimeout(function(){e.focus(),e.select()})}},V=function(){var e=Array.isArray(D.value)?D.value:[D.value],t=[];L(),p("isSelect",P.value.map(function(r,n){return e.includes(n)||t.push(n),n})),D.value=t},R=(0,n.cA)({hasIcon:!0,iconType:"svg-icon",menuList:[{label:(0,n.t)("213"),fn:function(){return f(void 0,!0)},disabled:E},{label:(0,n.t)("1674"),fn:function(){return _()}},{label:(0,n.t)("205"),fn:function(){return d()},disabled:function(){var e;if(E())return!1;var t=g(D.value);return t="number"==typeof t?t:t[0],(null===(e=P.value[t])||void 0===e?void 0:e.id)===C.value},icon:(0,n.cB)("youjianshanchu")},{label:(0,n.t)("4104"),tips:"F2",fn:function(){return T(h)},disabled:E,icon:(0,n.cB)("youjianzhongmingming")},{line:!0},{label:(0,n.t)("197"),fn:function(){b(P.value.map(function(e,t){return t}))}},{label:(0,n.t)("4262"),fn:function(){return b([]),void L()}},{label:(0,n.t)("4263"),fn:function(){return V()}}]}),W=(0,n.y)().createColor;(0,n.ag)().createLineType;var N=(0,n.b8)([{name:(0,n.t)("4264"),fun:function(){_()}},{name:(0,n.t)("4265"),fun:function(){return d()}},{name:(0,n.t)("213"),fun:function(){return f()}},{name:(0,n.t)("4266"),fun:function(){u(),N[3].name=s?(0,n.t)("4267"):(0,n.t)("4266")}}]);return{onClickLayer:I,onClickStopTD:function(e,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];var s=a[0],u=a[1],o=a[2];return r.value||c.value?e.preventDefault():t.isSelect?E()?(e.stopPropagation(),x(s,u),!1):void x(s,u,o):x(s,u,o)},onClickLayerName:function(e,t){h=e.target,D.value===t&&T(h)},resumeIndex:function(){w&&b(w),w=void 0},reverseSelection:V,selectColor:function(e){(0,n.c)("Mx_Color",{call:function(e,t){x("color",W(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){(0,n.L)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},(0,n.cD)(e,t))),D)},color:e})},selectLineType:function(e){x("lineType",e,D)},setIndex:b,onRightClickLayer:function(e,t){(!E()||!P.value[e].isSelect)&&I(e,t)},initLayerList:y,setLayerList:function(){m(v())},list:P,bodyRightClickMenuOptions:R,isShiftKeyMultipleChoice:r,isCtrlKeyMultipleChoice:c,btnList:N,rootId:C}}},4174:function(e,t,r){r.d(t,{M:function(){return i},r:function(){return u}});var n=r(8741),a=r(8159);function i(){return s.apply(this,arguments)}function s(){return(s=(0,n._)(n.a.mark(function e(){var t,r,i,s,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.a0).setMessage((0,n.t)("1595")+(0,n.t)("1678")+":"),t.setUserInputControls(a.U.kNoZeroResponseAccepted|a.U.kNoNegativeResponseAccepted),e.next=1,t.go();case 1:if(null!=(r=e.sent)){e.next=2;break}return e.abrupt("return");case 2:return t.setMessage((0,n.t)("1595")+(0,n.t)("1679")+":"),e.next=3,t.go();case 3:if(null!=(i=e.sent)){e.next=4;break}return e.abrupt("return");case 4:return e.next=5,n.w.getCorner((0,n.t)("1595")+(0,n.t)("1680"));case 5:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:return c=s.pt2.x-s.pt1.x,o=s.pt2.y-s.pt1.y,e.next=7,n.w.userSelect((0,n.t)("1581")+(0,n.t)("1681"));case 7:if(l=e.sent,d=n.w.getMcDbEntitysBoundingBox(l)){e.next=8;break}return e.abrupt("return");case 8:(f=new n.e).x=c>0?d.minPt.x:d.maxPt.x,f.y=o>0?d.minPt.y:d.maxPt.y,u({iColNum:i,iRowNum:r,dColOffset:c,dRowOffset:o,aryId:l,dAng:0});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var u=function(e){var t=e.iRowNum,r=void 0===t?0:t,i=e.iColNum,s=void 0===i?0:i,u=e.dColOffset,c=void 0===u?0:u,o=e.dRowOffset,l=void 0===o?0:o,d=e.aryId,f=void 0===d?[]:d,p=e.dAng,x=void 0===p?0:p,b=n.w.getMcDbEntitysBoundingBox(f);if(b){var g=new n.e;g.x=c>0?b.minPt.x:b.maxPt.x,g.y=l>0?b.minPt.y:b.maxPt.y;for(var v=(new n.b5).setToRotation(x*Math.PI/180,n.u.kZAxis,g),k=0,w=0;w<r;w++)for(var h=new n.u(0,l*w,0),y=(new n.b5).setToTranslation(h),m=0;m<s;m++)if(0!=w||0!=m){var M=new n.u(c*m,0,0),D=(new n.b5).setToTranslation(M),P=new n.e(g.x,g.y,g.z);P.transformBy(y),P.transformBy(D),P.transformBy(v);for(var A=(new n.b5).setToTranslation(new n.u(P.x-g.x,P.y-g.y,P.z-g.z)),C=0;C<f.length;C++){var E=f[C].clone();if(E&&(E.transformBy(A),n.M.getCurrentMxCAD().drawEntity(E),++k>5e4))return void a.M.acutPrintf((0,n.t)("1682")+5e4+(0,n.t)("1683")+"\n")}(0,n.b6)()}}}},4405:function(e,t,r){r.d(t,{u:function(){return i}});var n=r(8741),a=function(e){return new Promise(function(){var t=(0,n._)(n.a.mark(function t(r){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.df.onConfirm(function(e){r(e)}),n.df.cancel(function(){r(!1)}),n.df.showDialog(!0,e);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},i=function(){return{dialog:n.df,open:a}}},5582:function(e,t,r){r.d(t,{s:function(){return i},u:function(){return a}});var n=r(8741),a=function(){return{dialog:n.dy}},i=function(e){return n.dy&&n.dy.showDialog(!0,e,200)}},7133:function(e,t,r){r.r(t);var n=r(8741),a=r(4174),i=r(5582),s=r(8159),u=r(1157),c=r(2566),o=r(837),l=r(4405),d=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(){var a=(0,n._)(n.a.mark(function a(i,s){var u,c,o;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:0==(u=n.M.App.getCurrentMxCAD().getCurrentOriginaFileName()).length?u="temp_empty"+(0,n.g)(!0):(-1==u.indexOf(".")||u.substring(u.length-6)!=(0,n.g)(!0))&&(u+=(0,n.g)(!0)),c=u,a.next=2;break;case 1:c=a.sent;case 2:o=n.M.App.getCurrentMxCAD().saveFile(u,function(){var e=(0,n._)(n.a.mark(function e(t){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=a?new Blob([t.buffer],{type:"application/octet-stream"}):new Blob([t.buffer],{type:"application/octet-binary"});try{i({blob:r,data:t,filename:c})}catch(e){s(e),console.error(e)}case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),t,r,e?void 0:{compression:0}),!o&&s((0,n.t)("1697"));case 3:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}())},f=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a,i,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.next=2;break;case 1:e.next=5;break;case 2:return t=(0,n.i)(),e.next=3,d(!0,!1,!1);case 3:return r=e.sent,a=r.filename,i=r.blob,r.data,e.next=4,(0,n.s)({blob:i,filename:a,types:[{description:"webcad File",accept:{"application/octet-stream":[(0,n.g)(!0)]}}]});case 4:t&&(0,n.c)("MxFullScreen");case 5:e.next=7;break;case 6:e.prev=6,s=e.catch(0),console.error(s);case 7:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,n._)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=5;break;case 2:e.next=4;break;case 3:e.prev=3,t=e.catch(1),console.error(t);case 4:e.next=6;break;case 5:return e.next=6,f();case 6:case"end":return e.stop()}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}();function x(e,t){return b.apply(this,arguments)}function b(){return(b=(0,n._)(n.a.mark(function e(t,r){var a,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t+"_preloading.json",e.next=1,n.b.getJsonFromUrl(a);case 1:if(s=e.sent,u={ok:!0,tz:!1},s){e.next=2;break}return e.abrupt("return",new Promise(function(e,t){e(u)}));case 2:if(s.tz&&(u.tz=s.tz),c=[],s.images.forEach(function(e){"http:"!=e.substring(0,5)&&"https:"!=e.substring(0,6)&&c.push(e)}),s.images=c,0!==s.images.length||0!==s.externalReference.length){e.next=3;break}return e.abrupt("return",new Promise(function(e,t){e(u)}));case 3:return s.hash=r,e.next=4,(0,i.s)(s);case 4:return null!=(o=e.sent)&&o.data?u.ok=!0:u.ok=!1,e.abrupt("return",new Promise(function(e,t){e(u)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var g=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o,l,d,f,p;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.l).setMessage((0,n.t)("1638")),t.setUserDraw(function(e){r=e}),e.next=1,t.go();case 1:if(a=e.sent){e.next=2;break}return e.abrupt("return");case 2:if(a.isValid()){e.next=3;break}return e.abrupt("return");case 3:if(i=a.getMcDbCurve()){e.next=4;break}return e.abrupt("return");case 4:if(i instanceof n.k){e.next=5;break}return e.abrupt("return");case 5:return(s=new n.j).setUserDraw(function(e,t){if(i&&r){var n=i.clone();n&&(n.move(r,e),t.drawMcDbEntity(n))}}),e.next=6,s.go();case 6:if(u=e.sent){e.next=7;break}return e.abrupt("return");case 7:if(c=i.clone()){e.next=8;break}return e.abrupt("return");case 8:if(c.move(r,u),!(i instanceof n.f)){e.next=9;break}o=n.M.getCurrentMxCAD().drawEntity(c),(l=new n.h).copyFormAryId([o]),n.M.App.MxCADAssist.MxExplode(l.imp),e.next=11;break;case 9:if(0!==(d=c.getSamplePoints(.1)).GetCount()){e.next=10;break}return e.abrupt("return");case 10:p=n.M.getCurrentMxCAD(),d.forEach(function(e,t){if(1010===t){var r=new n.e(e.x,e.y,e.z);if(f){var a=new n.m;a.startPoint=f,a.endPoint=r,a.colorIndex=c.colorIndex,a.trueColor=c.trueColor,a.drawOrder=c.drawOrder,a.layer=c.layer,a.layerId=c.layerId,a.linetype=c.linetype,a.linetypeScale=c.linetypeScale,a.lineweight=a.lineweight,a.textStyle=a.textStyle,p.drawEntity(a)}f=r}}),p.updateDisplay();case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function v(e,t,r){var n,a=t.clone(),i=r.clone(),s=e.clone(),u=s.sub(a),c=i.sub(a),o=s.sub(i),l=u.crossProduct(c).length()/c.length(),d=u.dotProduct(c),f=c.clone().mult(d/Math.pow(c.length(),2));return a.clone().addvec(f),n=d<0?u.length():d>Math.pow(c.length(),2)?o.length():l,Math.floor(n)}(0,n.d)("_SampleCurve",g);var k=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,k,w,h,y,m,M,D,P,A,C,E,I,L,_;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.M.getCurrentMxCAD(),(r=new n.j).setMessage((0,n.t)("1601")),r.setKeyWords(""),e.next=1,r.go();case 1:if(a=e.sent,r.getStatus()!==s.j.kNone){e.next=12;break}c=new n.l,(o=new n.v).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),d=function(e,t){l=e;var r=n.w.findEntAtPoint(e.x,e.y,e.z,-1,o);if(r&&r.isValid()){var a=r.getMcDbEntity();a&&(u&&u.highlight(!1),a.highlight(!0),u=a)}};case 2:return c.setMessage((0,n.t)("1603")),c.setUserDraw(d),c.setFilter(o),e.next=3,c.go();case 3:if(f=e.sent,p=f.getMcDbEntity(),u&&u.highlight(!1),c.getStatus()!==s.j.kCancel){e.next=4;break}return e.abrupt("return");case 4:if(!(p instanceof n.r)){e.next=6;break}if(x=p.getStartPoint().val,b=p.radius,g=n.u.kXAxis.clone().rotateBy(p.endAngle).mult(b),k=p.center,w=k.clone().addvec(g),x&&w){e.next=5;break}return e.abrupt("return");case 5:return a=x,i=w,e.abrupt("continue",12);case 6:if(!(p instanceof n.q)){e.next=8;break}if(h=p.center,y=p.getStartPoint().val){e.next=7;break}return e.abrupt("return");case 7:return a=y,i=y.clone().addvec(h.sub(y).mult(2)),e.abrupt("continue",12);case 8:if(!(p instanceof n.m)){e.next=9;break}return a=p.startPoint,i=p.endPoint,e.abrupt("continue",12);case 9:if(!(p instanceof n.f)){e.next=10;break}for(m=0;m<p.numVerts();m++)M=p.getPointAt(m).val,D=p.getPointAt(m+1).val,P=p.getClosestPointTo(l,!1).val,D&&0===v(P,M,D)&&(a=M,i=D);return e.abrupt("continue",12);case 10:return s.M.acutPrintf("\n"+(0,n.t)("1604")),e.abrupt("continue",2);case 11:e.next=2;break;case 12:if(a){e.next=13;break}return e.abrupt("return");case 13:if(i){e.next=15;break}return r.setMessage((0,n.t)("1605")),r.setUserDraw(function(e,t){a&&t.drawMcDbLine(a.x,a.y,a.z,e.x,e.y,e.z)}),e.next=14,r.go();case 14:if(i=e.sent){e.next=15;break}return e.abrupt("return");case 15:L=n.a.mark(function e(){var c,o,l,d,f,p,x,b,g,v,k,w,h,y;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1606")),r.setKeyWords("[".concat((0,n.t)("1607"),"(T)/").concat((0,n.t)("169"),"(A)").concat(void 0===I?(0,n.t)("1612")+"/(H)/"+(0,n.t)("1613")+"(V)":"","/").concat((0,n.t)("176"),"(R)]")),r.clearLastInputPoint(),o=a.clone(),l=i.clone(),r.setUserDraw(function(e){if(a&&i){c&&c.erase(),u instanceof n.q&&(d||(d=u.center.clone().addvec(n.u.kXAxis.clone().rotateBy(Math.PI/2).mult(u.radius))),f||(f=u.center.clone().addvec(n.u.kXAxis.clone().rotateBy(-Math.PI/2).mult(u.radius))),e.y<d.y&&e.y>f.y&&(e.x>a.x||e.x<i.x)&&(a=d,i=f),e.x<o.x&&e.x>l.x&&(e.y>d.y||e.y<f.y)&&(a=o,i=l)),"H"===I&&(e.x<a.x?e.x=a.x:e.x>i.x&&(e.x=i.x)),"V"===I&&(e.y<a.y&&(e.y=a.y),e.y>i.y&&(e.y=i.y));var r=(c=t.drawDimRotated(a.x,a.y,i.x,i.y,e.x,e.y,E||0)).getMcDbDimension();r&&(r.textPosition=e,r.useSetTextPosition(),A&&(r.dimensionText=A),C&&(r.textRotation=C),r.trueColor=new n.n(0,255,0))}}),e.next=1,r.go();case 1:if(p=e.sent,!r.isKeyWordPicked("T")){e.next=4;break}return(b=new n.p).clearLastInputPoint(),b.setMessage("".concat((0,n.t)("1608"),"<").concat(A||(null===(x=c.getMcDbDimension())||void 0===x?void 0:x.dimensionText)||"",">")),b.setKeyWords(""),e.next=2,b.go();case 2:if("string"==typeof(g=e.sent)){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:return A=g,c&&c.erase(),e.abrupt("return",0);case 4:if(c&&c.erase(),!r.isKeyWordPicked("A")){e.next=8;break}return(v=new n.o).clearLastInputPoint(),v.setMessage((0,n.t)("1597")),e.next=5,v.go();case 5:if(k=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(v.getStatus()!==s.j.kCancel){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:return C=v.getDetailedResult()===s.D.kCoordIn?k*(Math.PI/180):k,e.abrupt("return",0);case 8:if(!r.isKeyWordPicked("H")){e.next=9;break}return I="H",e.abrupt("return",0);case 9:if(!r.isKeyWordPicked("V")){e.next=10;break}return I="V",e.abrupt("return",0);case 10:if(!r.isKeyWordPicked("R")){e.next=14;break}return(w=new n.o).clearLastInputPoint(),w.setMessage((0,n.t)("1615")),e.next=11,w.go();case 11:if(h=e.sent){e.next=12;break}return e.abrupt("return",{v:void 0});case 12:if(w.getStatus()!==s.j.kCancel){e.next=13;break}return e.abrupt("return",{v:void 0});case 13:return E=w.getDetailedResult()===s.D.kCoordIn?h*(Math.PI/180):h,e.abrupt("return",0);case 14:if(p){e.next=15;break}return e.abrupt("return",{v:void 0});case 15:if("H"===I&&(p.x<a.x?p.x=a.x:p.x>i.x&&(p.x=i.x)),"V"===I&&(p.y<a.y&&(p.y=a.y),p.y>i.y&&(p.y=i.y)),c=t.drawDimRotated(a.x,a.y,i.x,i.y,p.x,p.y,E||0),y=c.getMcDbDimension()){e.next=16;break}return e.abrupt("return",{v:void 0});case 16:return y.textPosition=p,y.useSetTextPosition(),A&&(y.dimensionText=A),C&&(y.textRotation=C),y.trueColor=new n.n(0,255,0),t.updateDisplay(),e.abrupt("return",1);case 17:case"end":return e.stop()}},e)});case 16:return e.delegateYield(L(),"t0",17);case 17:if(0!==(_=e.t0)){e.next=18;break}return e.abrupt("continue",16);case 18:if(1!==_){e.next=19;break}return e.abrupt("continue",21);case 19:if(!_){e.next=20;break}return e.abrupt("return",_.v);case 20:e.next=16;break;case 21:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();(0,n.d)("_DrawRotatedDimension",k);var w=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,k,w,h,y,m,M,D,P,A,C,E,I;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.M.getCurrentMxCAD(),console.log(t.drawDimStyle),(r=new n.j).setMessage("".concat((0,n.t)("1601"),"<").concat((0,n.t)("1602"),">")),r.setKeyWords(""),e.next=1,r.go();case 1:if(a=e.sent,r.getStatus()!==s.j.kNone){e.next=12;break}u=new n.l,(c=new n.v).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),d=function(e,t){o=e;var r=n.w.findEntAtPoint(e.x,e.y,e.z,-1,c);if(r&&r.isValid()){var a=r.getMcDbEntity();a&&(l&&l.highlight(!1),a.highlight(!0),l=a)}};case 2:return u.setMessage((0,n.t)("1603")),u.setUserDraw(d),u.setFilter(c),e.next=3,u.go();case 3:if(f=e.sent,p=f.getMcDbEntity(),l&&l.highlight(!1),u.getStatus()!==s.j.kCancel){e.next=4;break}return e.abrupt("return");case 4:if(!(p instanceof n.r)){e.next=6;break}if(x=p.getStartPoint().val,b=p.radius,g=n.u.kXAxis.clone().rotateBy(p.endAngle).mult(b),k=p.center,w=k.clone().addvec(g),x&&w){e.next=5;break}return e.abrupt("return");case 5:return a=x,i=w,e.abrupt("continue",12);case 6:if(!(p instanceof n.q)){e.next=8;break}if(h=p.center,y=p.getClosestPointTo(o,!1).val){e.next=7;break}return e.abrupt("return");case 7:return a=y,i=y.clone().addvec(h.sub(y).mult(2)),e.abrupt("continue",12);case 8:if(!(p instanceof n.m)){e.next=9;break}return a=p.startPoint,i=p.endPoint,e.abrupt("continue",12);case 9:if(!(p instanceof n.f)){e.next=10;break}for(m=0;m<p.numVerts();m++)M=p.getPointAt(m).val,D=p.getPointAt(m+1).val,P=p.getClosestPointTo(o,!1).val,D&&0===v(P,M,D)&&(a=M,i=D);return e.abrupt("continue",12);case 10:return s.M.acutPrintf("\n"+(0,n.t)("1604")),e.abrupt("continue",2);case 11:e.next=2;break;case 12:if(a){e.next=13;break}return e.abrupt("return");case 13:if(i){e.next=15;break}return r.setMessage((0,n.t)("1605")),r.setUserDraw(function(e,t){a&&t.drawMcDbLine(a.x,a.y,a.z,e.x,e.y,e.z)}),e.next=14,r.go();case 14:if(i=e.sent){e.next=15;break}return e.abrupt("return");case 15:E=n.a.mark(function e(){var u,c,o,l,d,f,p,x;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1606")),r.setKeyWords("[".concat((0,n.t)("1607"),"(T)/").concat((0,n.t)("169"),"(A)]")),r.clearLastInputPoint(),r.setUserDraw(function(e){if(a&&i){u&&u.erase();var r=(u=t.drawDimAligned(a.x,a.y,i.x,i.y,e.x,e.y)).getMcDbDimension();r&&(A&&(r.dimensionText=A),C&&(r.textRotation=C))}}),e.next=1,r.go();case 1:if(c=e.sent,!r.isKeyWordPicked("T")){e.next=4;break}return(l=new n.p).clearLastInputPoint(),l.setMessage("".concat((0,n.t)("1608"),"<").concat(A||(null===(o=u.getMcDbDimension())||void 0===o?void 0:o.dimensionText)||"",">")),l.setKeyWords(""),e.next=2,l.go();case 2:if("string"==typeof(d=e.sent)){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:return A=d,u&&u.erase(),e.abrupt("return",0);case 4:if(u&&u.erase(),!r.isKeyWordPicked("A")){e.next=8;break}return(f=new n.o).clearLastInputPoint(),f.setMessage((0,n.t)("1597")),e.next=5,f.go();case 5:if(p=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(f.getStatus()!==s.j.kCancel){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:return C=f.getDetailedResult()===s.D.kCoordIn?p*(Math.PI/180):p,e.abrupt("return",0);case 8:if(c){e.next=9;break}return e.abrupt("return",{v:void 0});case 9:if(u=t.drawDimAligned(a.x,a.y,i.x,i.y,c.x,c.y),x=u.getMcDbDimension()){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:return x.textPosition=c,A&&(x.dimensionText=A),C&&(x.textRotation=C),t.updateDisplay(),e.abrupt("return",1);case 11:case"end":return e.stop()}},e)});case 16:return e.delegateYield(E(),"t0",17);case 17:if(0!==(I=e.t0)){e.next=18;break}return e.abrupt("continue",16);case 18:if(1!==I){e.next=19;break}return e.abrupt("continue",21);case 19:if(!I){e.next=20;break}return e.abrupt("return",I.v);case 20:e.next=16;break;case 21:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function h(){return(h=(0,n._)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=s.M.getCurrentDraw().getViewAngle(),t-=.5*Math.PI,n.M.getCurrentMxCAD().zoomAngle(t);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(){return(y=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.x).setMessage((0,n.t)("1564")),t.setKeyWords("[".concat((0,n.t)("1565")," UCS(C)/").concat((0,n.t)("1566"),"(W)/").concat((0,n.t)("169"),"(A)/").concat((0,n.t)("1567"),"(X)]")),e.next=1,t.go();case 1:if(null==(r=e.sent)||r.toLocaleLowerCase(),null==r||r.toLocaleLowerCase(),"a"!==(null==r?void 0:r.toLocaleLowerCase())){e.next=4;break}return(a=new n.o).clearLastInputPoint(),a.setMessage((0,n.t)("1568")),e.next=2,a.go();case 2:if(i=e.sent){e.next=3;break}return e.abrupt("return");case 3:a.getDetailedResult()===s.D.kCoordIn&&(i*=Math.PI/180),n.M.getCurrentMxCAD().zoomAngle(i);case 4:if("x"!==(null==r?void 0:r.toLocaleLowerCase())){e.next=7;break}return(u=new n.o).clearLastInputPoint(),u.setMessage((0,n.t)("1569")),e.next=5,u.go();case 5:if(c=e.sent){e.next=6;break}return e.abrupt("return");case 6:u.getDetailedResult()===s.D.kCoordIn&&(c*=Math.PI/180),o=s.M.getCurrentDraw().getViewAngle(),o+=c,n.M.getCurrentMxCAD().zoomAngle(o);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e,t){var r=document.timeline?document.timeline.currentTime:performance.now(),n=!1;return function a(i){if(!n){var s=i-r,u=Math.round(s/e);t(u);var c=(u+1)*e+r,o=document.timeline?document.timeline.currentTime:performance.now();return setTimeout(function(){requestAnimationFrame(a)},c-o)}}(r),function(){n=!0}}function M(e,t,r){for(var n=t,a=r;a-n>1e-4;){var i=(n+a)/2;Math.floor(e/i)*i>e||i<t?a=i:n=i}return e/Math.floor(e/n)}function D(e,t,r,n){var a=e.distanceTo(t),i=[],s=M(a,r,n);if(isNaN(s))return i;for(var u=a/s,c=t.sub(e).normalize(),o=0;o<u;o++)i.push(e.clone().addvec(c.clone().mult(s*o)));return i}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new n.e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI,i=[];r=Math.max(3,r),i.push(t);for(var s=a/r,u=1;u<r;u++){var c=Math.cos(s*u),o=Math.sin(s*u),l=e.clone(),d=t.clone(),f=d.x-l.x,p=d.y-l.y,x=f*c-p*o+l.x,b=f*o+p*c+l.y,g=new n.e(x,b);i.push(g)}return i}(0,n.d)("_DrawAlignedDimension",w),(0,n.d)("Mx_Plan90CCW",function(){return h.apply(this,arguments)}),(0,n.d)("Mx_Plan",function(){return y.apply(this,arguments)}),(0,n.d)("_ViewColor",function(){var e=n.M.getCurrentMxCAD(),t=e.mxdraw.getViewColor(),r=(0,n.y)().createColor;(0,n.c)("Mx_Color",{color:r({color:(0,n.C)(t).toString()}),call:function(t){var r=(0,n.C)(t),a=r.red(),i=r.green(),u=r.blue();e.setViewBackgroundColor(a,i,u),s.M.callEvent("updateBackgroundColor",new n.n(a,i,u))}})});var A=function(e,t){return[e,new n.e(e.x,t.y,e.z),t,new n.e(t.x,e.y,t.z)]};function C(){return C=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p=function(e,t){e.colorIndex=t.colorIndex,e.trueColor=t.trueColor,e.drawOrder=t.drawOrder,e.layer=t.layer,e.layerId=t.layerId,e.linetype=t.linetype,e.linetypeScale=t.linetypeScale,e.lineweight=t.lineweight,e.textStyle=t.textStyle},t=s.M.viewCoordLong2Cad(2),r=Number(localStorage.getItem("mx_revcloud_minArcLength")),a=Number(localStorage.getItem("mx_revcloud_maxArcLength")),(isNaN(r)||r<1e-4)&&(i=s.M.viewCoordLong2Cad(12),localStorage.setItem("mx_revcloud_minArcLength",i.toString())),(isNaN(a)||a<1e-4)&&(u=s.M.viewCoordLong2Cad(12),localStorage.setItem("mx_revcloud_maxArcLength",u.toString())),c=new n.j,o=-.45,l=!1,d=!1,f=!1,x=n.a.mark(function e(){var i,u,x,b,g,v,k,w,h,y,C,E,I,L,_,S,T,V,R,W,N,O,K,j,z,B,U,F,H,Y;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,n.t)("1616"),l&&(i=(0,n.t)("1617")),d&&(i=(0,n.t)("1618")),c.setMessage(i),c.setKeyWords("[".concat((0,n.t)("1619"),"(A)/").concat((0,n.t)("177"),"(O)/").concat((0,n.t)("178"),"(R)/").concat((0,n.t)("179"),"(P)/").concat((0,n.t)("180"),"(F)/").concat((0,n.t)("1624"),"(S)]")),u=new n.f,c.clearLastInputPoint(),x=function(){var e=(0,n._)(n.a.mark(function e(t){var r,a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.clearLastInputPoint(),c.setMessage((0,n.t)("1625")),c.setKeyWords("[".concat((0,n.t)("1626"),"(Y)/").concat((0,n.t)("1627"),"(N)]")),e.next=1,c.go();case 1:if(c.isKeyWordPicked("Y"))for(r=t.numVerts(),a=0;a<r;a++)i=t.getBulgeAt(a),t.setBulgeAt(a,-i);return e.abrupt("return",!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),e.next=1,c.go();case 1:if(b=e.sent,!c.isKeyWordPicked("A")){e.next=7;break}return(g=new n.z).setMessage((0,n.t)("1628")),e.next=2,g.go();case 2:if("number"==typeof(v=e.sent)){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:if(!(v<1e-5)){e.next=4;break}return s.M.acutPrintf("\n"+(0,n.t)("1629")),e.abrupt("return",{v:void 0});case 4:return r=v,localStorage.setItem("mx_revcloud_minArcLength",v.toString()),k=function(){var e=(0,n._)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g.setMessage((0,n.t)("1630")),e.next=1,g.go();case 1:if("number"==typeof(t=e.sent)){e.next=2;break}return e.abrupt("return",!1);case 2:if(!(t<1e-5)){e.next=3;break}return s.M.acutPrintf("\n"+(0,n.t)("1631")),e.abrupt("return");case 3:if(!(t<r)){e.next=5;break}return s.M.acutPrintf("\n"+(0,n.t)("1632")),e.next=4,k();case 4:return e.abrupt("return",e.sent);case 5:a=t,localStorage.setItem("mx_revcloud_maxArcLength",t.toString());case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),e.next=5,k();case 5:if(!1!==e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:return e.abrupt("return",0);case 7:if(!c.isKeyWordPicked("O")){e.next=16;break}return(w=new n.v).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE,ELLIPSE"),e.next=8,n.w.userSelect((0,n.t)("1602"),w);case 8:if(h=e.sent,y=h[0]){e.next=9;break}return e.abrupt("return",{v:void 0});case 9:if(C=y.getMcDbEntity()){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:if(!(C instanceof n.f)){e.next=12;break}for(u.isClosed=C.isClosed,u.constantWidth=C.constantWidth,p(u,C),E=C.numVerts(),L=0;L<E;L++)_=C.getPointAt(L).val,I&&_&&D(I,_,r,a).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}),I=_;return u.isClosed?D(I,C.getPointAt(0).val,r,a).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}):u.addVertexAt(I,o),e.next=11,x(u);case 11:return C.erase(),e.abrupt("return",{v:n.M.getCurrentMxCAD().drawEntity(u)});case 12:if(!(C instanceof n.m)){e.next=14;break}return p(u,C),D(C.startPoint,C.endPoint,r,a).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}),u.addVertexAt(C.endPoint,o,void 0,f?t:void 0),e.next=13,x(u);case 13:return C.erase(),e.abrupt("return",{v:n.M.getCurrentMxCAD().drawEntity(u)});case 14:if(!(C instanceof n.q)){e.next=16;break}return S=C.getLength().val,T=S/M(S,r,a),V=C.getStartPoint().val,P(C.center,V,T).forEach(function(e){u.addVertexAt(e,o,void 0,f?t:void 0)}),p(u,C),C instanceof n.q&&(u.isClosed=!0),e.next=15,x(u);case 15:return C.erase(),e.abrupt("return",{v:n.M.getCurrentMxCAD().drawEntity(u)});case 16:if(!c.isKeyWordPicked("R")){e.next=17;break}return l=!0,d=!1,e.abrupt("return",0);case 17:if(!c.isKeyWordPicked("P")){e.next=18;break}return d=!0,l=!1,e.abrupt("return",0);case 18:if(!c.isKeyWordPicked("F")){e.next=19;break}return d=!1,l=!1,e.abrupt("return",0);case 19:if(!c.isKeyWordPicked("S")){e.next=25;break}return c.setMessage((0,n.t)("1633")),c.setKeyWords("[".concat((0,n.t)("1634"),"(N)/").concat((0,n.t)("1635"),"(C)]")),e.next=20,c.go();case 20:if(c.getDetailedResult()!==s.D.kEcsIn){e.next=21;break}return e.abrupt("return",{v:void 0});case 21:if(c.getDetailedResult()!==s.D.kNewCommadIn){e.next=22;break}return e.abrupt("return",{v:void 0});case 22:if(c.getStatus()!==s.j.kNone){e.next=23;break}return e.abrupt("return",{v:void 0});case 23:if(c.getStatus()!==s.j.kCancel){e.next=24;break}return e.abrupt("return",{v:void 0});case 24:return c.isKeyWordPicked("N")&&(f=!1),c.isKeyWordPicked("C")&&(f=!0),e.abrupt("return",0);case 25:if(b){e.next=26;break}return e.abrupt("return",{v:void 0});case 26:if(!l){e.next=29;break}return c.setMessage((0,n.t)("1610")),c.setMessage(""),R=function(e,i){if(b){var s=A(b,i),u=(0,n.A)(s,4),c=u[0],l=u[1],d=u[2],p=u[3],x=b.x<i.x&&b.y<i.y||b.x>i.x&&b.y>i.y;[[c,l],[l,d],[d,p],[p,c]].forEach(function(i){var s=(0,n.A)(i,2);D(s[0],s[1],r,a).forEach(function(r){e.addVertexAt(r,x?o:-o,void 0,f?t:void 0)})}),e.isClosed=!0}},c.setUserDraw(function(e,t){var r=new n.f;R(r,e),t.drawMcDbEntity(r)}),e.next=27,c.go();case 27:if(W=e.sent){e.next=28;break}return e.abrupt("return",{v:void 0});case 28:return R(u,W),e.abrupt("return",{v:n.M.getCurrentMxCAD().drawEntity(u)});case 29:if(!d){e.next=37;break}(N=[]).push(b),O=function(e,n){var i;n.forEach(function(n){i&&D(i,n,r,a).forEach(function(r){e.addVertexAt(r,o,void 0,f?t:void 0)}),i=n}),n.length>2?(e.isClosed=!0,D(i,n[0],r,a).forEach(function(r){e.addVertexAt(r,o,void 0,f?t:void 0)})):e.addVertexAt(i,o,void 0,f?t:void 0)},c.setUserDraw(function(e,t){var r=new n.f;O(r,[].concat(N,[e])),t.drawMcDbEntity(r)});case 30:return c.setMessage((0,n.t)("1636")),c.setKeyWords(N.length<2?"":"[".concat((0,n.t)("1552"),"(U)]")),e.next=31,c.go();case 31:if(K=e.sent,!c.isKeyWordPicked("U")){e.next=32;break}return N.pop(),c.clearLastInputPoint(),e.abrupt("continue",30);case 32:if(c.getDetailedResult()!==s.D.kNullEnterIn&&c.getDetailedResult()!==s.D.kMouseRightIn){e.next=34;break}return O(u,N),e.next=33,x(u);case 33:return e.abrupt("return",{v:n.M.getCurrentMxCAD().drawEntity(u)});case 34:if(K){e.next=35;break}return e.abrupt("return",{v:void 0});case 35:return N.push(K),e.abrupt("continue",30);case 36:e.next=42;break;case 37:return u.addVertexAt(b,o,void 0,f?t:void 0),j=b.clone(),z=0,B=b,U=function(){var e=(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return H(),e.next=1,x(u);case 1:n.M.getCurrentMxCAD().drawEntity(u);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c.setMessage((0,n.t)("1637")+"..."),c.setKeyWords(""),c.setUserDraw(function(e,t){b&&(B=e,z=b.distanceTo(e),t.drawMcDbEntity(u.clone()),t.drawLine(b.toVector3(),e.toVector3()))}),c.clearLastInputPoint(),F=!1,H=m(20,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(z<r)){e.next=1;break}return e.abrupt("return");case 1:if(!(B.distanceTo(j)<r)){e.next=2;break}return u.isClosed=!0,s.M.stopRunCommand(),F=!0,e.abrupt("return");case 2:u.addVertexAt(B,o,void 0,f?t:void 0),b=B,z=0;case 3:case"end":return e.stop()}},e)}))),e.next=38,c.go();case 38:if(Y=e.sent,c.getDetailedResult()!==s.D.kMouseRightIn&&c.getDetailedResult()!==s.D.kNullEnterIn){e.next=39;break}return e.next=39,U();case 39:if(Y||F){e.next=40;break}return e.abrupt("return",{v:H()});case 40:return Y&&u.addVertexAt(Y,o,void 0,f?t:void 0),e.next=41,U();case 41:return e.abrupt("return",1);case 42:case"end":return e.stop()}},e)});case 1:return e.delegateYield(x(),"t0",2);case 2:if(0!==(b=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(1!==b){e.next=4;break}return e.abrupt("continue",6);case 4:if(!b){e.next=5;break}return e.abrupt("return",b.v);case 5:e.next=1;break;case 6:case"end":return e.stop()}},e)})),C.apply(this,arguments)}function E(){return E=(0,n._)(n.a.mark(function e(){var t,r,a,i,c,o,l,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,n.i)(),r=function(){t&&(0,n.c)("MxFullScreen")},a=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:210,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:297,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=(0,n.B)()||{},o=c.baseUrl,l=void 0===o?"":o,d=c.mxfilepath,f=void 0===d?"":d,p=c.printPdfUrl,x=void 0===p?"":p,b={width:""+a,height:""+i,roate_angle:s,bd_pt1_x:""+e.x,bd_pt1_y:""+e.y,bd_pt2_x:""+t.x,bd_pt2_y:""+t.y};n.M.getCurrentMxCAD().saveFileToUrl(x,function(e,t){try{var n=JSON.parse(t);if("ok"==n.ret){var a=l+f+n.file;(0,u.p)(a),r()}else console.log(t)}catch(e){console.log("Mx: sserverResult error")}},void 0,JSON.stringify(b))},s.M.acutPrintf("\n"+(0,n.t)("1570")),i=n.M.getCurrentMxCAD(),c=!1,o=n.a.mark(function e(){var t,u,o,d,f,p,x,b,g,v,k,w,h,y,m,M;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.j).setMessage("\n"+(0,n.t)("1571")+":"),t.setKeyWords("[".concat((0,n.t)("1572"),"(S)/[").concat((0,n.t)("1573"),"(D)]")),t.disableAllTrace(),e.next=1,t.go();case 1:if(u=e.sent,!t.isKeyWordPicked("D")){e.next=2;break}c=!0,e.next=15;break;case 2:if(!t.isKeyWordPicked("S")){e.next=11;break}return(o=new n.x).setMessage((0,n.t)("1574")),o.setKeyWords("[A1(A)/A2(B)/A3(C)/A4(D)/".concat((0,n.t)("170"),"16.55x23.90(E)]")),o.setDisableDynInput(!0),e.next=3,o.go();case 3:if(d=e.sent){e.next=4;break}return e.abrupt("return",{v:void 0});case 4:if((f={A:{w:594,h:841},B:{w:420,h:594},C:{w:297,h:420},D:{w:210,h:297},E:{w:165.5,h:239,nw:130,nh:190}})[d]){e.next=5;break}return e.abrupt("return",{v:void 0});case 5:return(p=new n.p).setMessage("".concat((0,n.t)("1576"),"(").concat((0,n.t)("1577"),")")),e.next=6,p.go();case 6:if(x=e.sent){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:if(l=parseFloat(x),!isNaN(l)){e.next=8;break}return s.M.acutPrintf((0,n.t)("1578")),e.abrupt("return",{v:void 0});case 8:return b=f[d].w*l,g=f[d].h*l,v=0,k=0,f[d].nw&&(v=f[d].nw*l),f[d].nh&&(k=f[d].nh*l),c&&(w=b,b=g,g=w,w=v,v=k,k=w),(t=new n.j).disableAllTrace(),t.setMessage("\n"+(0,n.t)("1579")),t.setKeyWords(""),t.setUserDraw(function(e,t){t.setColor(16711680);var r=new n.f,a=new n.e(e.x-.5*b,e.y-.5*g),u=new n.e(e.x-.5*b,e.y+.5*g),c=new n.e(e.x+.5*b,e.y+.5*g),o=new n.e(e.x+.5*b,e.y-.5*g);r.addVertexAt(a),r.addVertexAt(u),r.addVertexAt(c),r.addVertexAt(o),r.constantWidth=s.M.screenCoordLong2Doc(2),r.isClosed=!0,t.drawMcDbEntity(r);var l=[];if(l.push(a.toVector3()),l.push(u.toVector3()),l.push(c.toVector3()),l.push(o.toVector3()),t.setColor(12868),t.drawSolid(l,.5),v>0&&k>0){var d=new n.e(e.x-.5*v,e.y-.5*k),f=new n.e(e.x-.5*v,e.y+.5*k),p=new n.e(e.x+.5*v,e.y+.5*k),x=new n.e(e.x+.5*v,e.y-.5*k),w=[];w.push(d.toVector3()),w.push(f.toVector3()),w.push(p.toVector3()),w.push(x.toVector3()),w.push(d.toVector3());var h=i.mxdraw.viewCoordLong2Cad(3),y=s.r.createDashedLines(w,16777215,2*h,h);t.drawEntity(y)}}),e.next=9,t.go();case 9:if(h=e.sent){e.next=10;break}return e.abrupt("return",{v:r()});case 10:return y=new n.e(h.x-.5*b,h.y-.5*g),m=new n.e(h.x+.5*b,h.y+.5*g),a(y,m,c?f[d].h:f[d].w,c?f[d].w:f[d].h,0),e.abrupt("return",{v:void 0});case 11:if(u){e.next=12;break}return e.abrupt("return",{v:r()});case 12:return t.setMessage("\n"+(0,n.t)("1580")+":"),t.setUserDraw(function(e,t){if(!u)return r();t.setColor(16711680);var a=new n.f;a.addVertexAt(u),a.addVertexAt(new n.e(u.x,e.y)),a.addVertexAt(e),a.addVertexAt(new n.e(e.x,u.y)),a.constantWidth=s.M.screenCoordLong2Doc(2),a.isClosed=!0,t.drawMcDbEntity(a);var i=[];i.push(u.toVector3()),i.push(new THREE.Vector3(u.x,e.y)),i.push(e.toVector3()),i.push(new THREE.Vector3(e.x,u.y)),t.setColor(12868),t.drawSolid(i,.5)}),t.setDisableOsnap(!0),t.setDisableOrthoTrace(!0),t.setDynamicInputType(s.g.kXYCoordInput),e.next=13,t.go();case 13:if(M=e.sent){e.next=14;break}return e.abrupt("return",{v:r()});case 14:return a(u,M,c?297:210,c?210:297,0),e.abrupt("return",{v:void 0});case 15:case"end":return e.stop()}},e)});case 1:return e.delegateYield(o(),"t0",2);case 2:if(!(d=e.t0)){e.next=3;break}return e.abrupt("return",d.v);case 3:e.next=1;break;case 4:case"end":return e.stop()}},e)})),E.apply(this,arguments)}function I(){return(I=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.M.viewCoordLong2Cad(20),(r=new n.j).setDisableDynInput(!0),r.setDynamicInputType(s.g.kNoInput),e.next=1,r.go();case 1:if(a=e.sent){e.next=2;break}return e.abrupt("return");case 2:return i=new n.f,u=0,c=a,o=m(20,function(){u<t||(i.addVertexAt(c),a=c,u=0)}),r.setUserDraw(function(e,t){a&&(c=e,u=a.distanceTo(e),t.drawMcDbEntity(i.clone()),t.drawLine(a.toVector3(),e.toVector3()))}),e.next=3,r.go();case 3:if(l=e.sent){e.next=4;break}return e.abrupt("return",o());case 4:o(),i.addVertexAt(l),n.M.getCurrentMxCAD().drawEntity(i);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return(L=(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o,l,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.z).setMessage((0,n.t)("1598")),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:return t.setMessage((0,n.t)("1599")),e.next=3,t.go();case 3:if(a=e.sent){e.next=4;break}return e.abrupt("return");case 4:return(i=new n.j).clearLastInputPoint(),i.setMessage((0,n.t)("1600")),i.setUserDraw(function(e,t){var i=new n.q,s=new n.q;i.radius=r/2,s.radius=a/2,i.center=e,s.center=e,t.drawMcDbEntity(i),t.drawMcDbEntity(s)}),e.next=5,i.go();case 5:if(s=e.sent){e.next=6;break}return e.abrupt("return");case 6:u=Math.abs(r-a)/4,c=Math.min(r,a),o=s.clone().addvec(n.u.kXAxis.clone().mult(c/2+u)),l=s.clone().addvec(n.u.kXAxis.clone().negate().mult(c/2+u)),(d=new n.f).addVertexAt(o,1),d.addVertexAt(l,1),d.addVertexAt(o,1),d.isClosed=!0,d.constantWidth=2*u,n.M.getCurrentMxCAD().drawEntity(d);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.numVerts(),a=0;a<e.numVerts();a++){var i=e.getPointAt(a).val,s=e.getPointAt(a+1).val;if(0===e.getBulgeAt(a)){if(a+1===n&&e.isClosed&&(s=e.getPointAt(0).val),s&&v(t,i,s)<r)return{start:i,end:s,startIndex:a,endIndex:a+1}}else if(s){var u=e.getParamAtPoint(i).val,c=e.getParamAtPoint(s).val,o=e.getParamAtPoint(t).val;if(c>o&&o>u)return{start:i,end:s,startIndex:a,endIndex:a+1}}}if(e.isClosed){var l=e.getPointAt(0).val,d=e.getPointAt(e.numVerts()-1).val;if(v(t,d,l)<r)return{start:d,end:l,startIndex:e.numVerts()-1,endIndex:0,isClosed:!0}}}function S(){return(S=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h,y,m,M,D,P,A,C;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.M.getCurrentMxCAD(),r=new n.l,(d=new n.v).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),x=function(e,t){f=e;var r=n.w.findEntAtPoint(e.x,e.y,e.z,-1,d);if(r&&r.isValid()){var a=r.getMcDbEntity();a&&(p&&p.highlight(!1),a.highlight(!0),p=a)}},b=n.a.mark(function e(){var t,b,g,v,k,w,h,y,m,M,D,P,A,C,E,I,L,S,T,V,R,W,N,O,K,j,z,B,U,F,H,Y,X;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage("".concat((0,n.t)("1581")).concat((0,n.t)("171"),"、").concat((0,n.t)("172"),"、").concat((0,n.t)("173")).concat((0,n.t)("1585")," <").concat((0,n.t)("1586"),">")),r.setUserDraw(x),r.setFilter(d),e.next=1,r.go();case 1:if(t=e.sent,b=t.getMcDbEntity(),p&&p.highlight(!1),r.getStatus()!==s.j.kCancel){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(r.getStatus()!==s.j.kNone){e.next=9;break}return(g=new n.j).clearLastInputPoint(),g.setMessage((0,n.t)("1587")),e.next=3,g.go();case 3:if(v=e.sent){e.next=4;break}return e.abrupt("return",{v:void 0});case 4:return g.setBasePt(v),g.setMessage((0,n.t)("1588")),e.next=5,g.go();case 5:if(k=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:return g.setMessage((0,n.t)("1589")),e.next=7,g.go();case 7:if(w=e.sent){e.next=8;break}return e.abrupt("return",{v:void 0});case 8:return a=v.x,i=v.y,u=k.x,c=k.y,o=w.x,l=w.y,e.abrupt("return",0);case 9:if(!(b instanceof n.r)){e.next=11;break}if(h=b.getStartPoint().val,y=b.radius,m=n.u.kXAxis.clone().rotateBy(b.endAngle).mult(y),M=b.center,D=M.clone().addvec(m),h&&D){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:return u=h.x,c=h.y,o=D.x,l=D.y,a=M.x,i=M.y,e.abrupt("return",0);case 11:if(!(b instanceof n.q)){e.next=14;break}return P=b.center,a=P.x,i=P.y,u=f.x,c=f.y,(A=new n.j).setMessage((0,n.t)("1589")),e.next=12,A.go();case 12:if(C=e.sent){e.next=13;break}return e.abrupt("return",{v:void 0});case 13:return E=b.getClosestPointTo(C,!1).val,o=E.x,l=E.y,e.abrupt("return",0);case 14:if(!(b instanceof n.m||b instanceof n.f)){e.next=26;break}if(I=new n.l,(L=new n.v).AddMcDbEntityTypes("LINE,LWPOLYLINE"),I.setFilter(L),p=null,I.setUserDraw(function(e,t){x(e),S=e}),T=b.getClosestPointTo(f,!1).val,u=T.x,c=T.y,b instanceof n.m?(V=b).highlight(!0):(R=_(b,T,2)||{},W=R.start,N=R.end,W&&N&&(V=new n.m(W,N)),b.highlight(!1)),V){e.next=15;break}return e.abrupt("return",{v:void 0});case 15:return I.setMessage((0,n.t)("1590")),e.next=16,I.go();case 16:if(K=e.sent,I.getStatus()!==s.j.kCancel){e.next=17;break}return e.abrupt("return",{v:V.highlight(!1)});case 17:if(K){e.next=18;break}return e.abrupt("continue",15);case 18:if(K.isValid()){e.next=19;break}return e.abrupt("continue",15);case 19:if(j=K.getMcDbEntity(),z=void 0,!(j instanceof n.f)){e.next=20;break}B=_(j,I.getDocPickPoint(),2)||{},U=B.start,F=B.end,z=new n.m(U,F),j.highlight(!1),e.next=22;break;case 20:if(!(j instanceof n.m)){e.next=21;break}z=j,e.next=22;break;case 21:return s.M.acutPrintf("\n"+(0,n.t)("1591")),e.abrupt("continue",15);case 22:if(z){e.next=23;break}return e.abrupt("return",{v:V.highlight(!1)});case 23:if(V.highlight(!1),z.highlight(!1),!(H=null===(O=V.clone())||void 0===O?void 0:O.IntersectWith(z.clone(),n.H.Intersect.kExtendBoth)).isEmpty()){e.next=24;break}return e.abrupt("continue",15);case 24:return Y=H.at(0),X=z.getClosestPointTo(S,!1).val,o=X.x,l=X.y,a=Y.x,i=Y.y,e.abrupt("continue",25);case 25:return e.abrupt("return",0);case 26:case"end":return e.stop()}},e)});case 1:return e.delegateYield(b(),"t0",2);case 2:if(0!==(g=e.t0)){e.next=3;break}return e.abrupt("continue",5);case 3:if(!g){e.next=4;break}return e.abrupt("return",g.v);case 4:e.next=1;break;case 5:if((v=new n.j).clearLastInputPoint(),![a,i,u,c,o,l].some(function(e){return"number"!=typeof e})){e.next=6;break}return e.abrupt("return");case 6:return v.setMessage((0,n.t)("1592")),v.setKeyWords("[".concat((0,n.t)("174"),"(T)/").concat((0,n.t)("169"),"(A)/").concat((0,n.t)("175"),"(Q)]")),v.setUserDraw(function(e,t){var r=new n.G;r.compute(a,i,u,c,o,l,e.x,e.y),w&&(r.dimensionText=w),h&&(r.textRotation=h),t.drawMcDbEntity(r,!0)}),e.next=7,v.go();case 7:if(y=e.sent,!v.isKeyWordPicked("T")){e.next=10;break}return(M=new n.p).clearLastInputPoint(),M.setMessage("".concat((0,n.t)("1595")).concat((0,n.t)("1596"),"<").concat(w||(null===(m=k.getMcDbDimension())||void 0===m?void 0:m.dimensionText)||"",">")),M.setKeyWords(""),e.next=8,M.go();case 8:if("string"==typeof(D=e.sent)){e.next=9;break}return e.abrupt("return");case 9:return w=D,e.abrupt("continue",6);case 10:if(!v.isKeyWordPicked("A")){e.next=14;break}return(P=new n.o).clearLastInputPoint(),P.setMessage((0,n.t)("1597")),e.next=11,P.go();case 11:if(A=e.sent){e.next=12;break}return e.abrupt("return");case 12:if(P.getStatus()!==s.j.kCancel){e.next=13;break}return e.abrupt("return");case 13:return h=P.getDetailedResult()===s.D.kCoordIn?A*(Math.PI/180):A,e.abrupt("continue",6);case 14:if(v.isKeyWordPicked("Q"),y){e.next=15;break}return e.abrupt("return");case 15:if(t.drawUseDefaultProperties=!0,k=t.drawDimAngular(a,i,u,c,o,l,y.x,y.y),C=k.getMcDbDimension()){e.next=16;break}return e.abrupt("return");case 16:return w&&(C.dimensionText=w),h&&(C.textRotation=h),e.abrupt("return");case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(e,t,r,a,i){var s=t.sub(e),u=0===r.distanceTo(a),c=r.x>a.x;i.forEach(function(i){if(i)if(!c||u||i instanceof n.q||i instanceof n.K&&(0===i.startAngle&&i.endAngle===2*Math.PI||0===i.endAngle&&i.startAngle===2*Math.PI))i.move(e,t);else{var o=i.getGripPoints();if(o.isEmpty())return;o.forEach(function(e,t){if(function(e,t,r){var n=t.x,a=t.y,i=r.x,s=r.y,u=e.x,c=e.y,o=Math.min(n,i),l=Math.min(a,s),d=Math.max(n,i),f=Math.max(a,s);return u>=o&&u<=d&&c>=l&&c<=f}(e,r,a)&&!(i instanceof n.r&&2===t)&&!(i instanceof n.m&&2===t)){if(i instanceof n.f&&o.length()!==i.numVerts())for(var u=i.numVerts(),c=0,l=0;l<u;l++){if(i.getPointAt(l).val,0!==i.getBulgeAt(l)&&++c===t)return;c++}i.moveGripPointsAt(t,s.x,s.y,s.z)}})}})}(0,n.d)("_Revcloud",function(){return C.apply(this,arguments)}),(0,n.d)("Plot",function(){return E.apply(this,arguments)}),(0,n.d)("MxET_Pencil",function(){return I.apply(this,arguments)}),window.addEventListener("keydown",function(e){122===e.keyCode&&(e.returnValue=!1,(0,n.c)("MxFullScreen"))},!0),n.D.register({key:{keyCode:"Escape"},when:function(e){return!e.isRunCommand&&(0,n.i)()},action:function(){(0,n.c)("MxFullScreen")}}),(0,n.d)("MxFullScreen",function(){var e;(0,n.i)()?((e=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen)?e.call(document):((0,n.F)().error((0,n.t)("1546")+"!"),console.error((0,n.t)("1546")+"!")),"keyboard"in navigator&&navigator.keyboard.unlock()):(function(e){var t=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen;t?t.call(e):((0,n.F)().error((0,n.t)("1546")+"!"),console.error((0,n.t)("1546")+"!"))}((0,n.E)()||document.body),"keyboard"in navigator&&navigator.keyboard.lock())}),(0,n.d)("_donut",function(){return L.apply(this,arguments)}),(0,n.d)("_dimangular",function(){return S.apply(this,arguments)});var V=(0,n.I)(0,"_stretch_offsetX"),R=(0,n.I)(0,"_stretch_offsetY"),W=(0,n.I)(0,"_stretch_offsetZ");function N(){return N=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new n.J,!((r=n.w.getCurrentSelect()).length<=0)){e.next=3;break}return e.next=1,t.userSelect((0,n.t)("1639"));case 1:if(e.sent){e.next=2;break}return e.abrupt("return");case 2:r=t.getIds(),u=t.getSelectPoint(),a=u.pt1,i=u.pt2,e.next=4;break;case 3:c=n.w.getCurrentSelectPoints(),o=c.point1,l=c.point2,a=o,i=l;case 4:return(d=new n.j).setMessage("\n"+(0,n.t)("1640")),d.setKeyWords("[".concat((0,n.t)("1641"),"(D)]")),e.next=5,d.go();case 5:if(f=e.sent,p=function(){var e=(0,n._)(n.a.mark(function e(t){var s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return d.setMessage("\n".concat((0,n.t)("1642"),"<").concat(V.value,", ").concat(R.value,", ").concat(W.value,">")),d.setKeyWords(""),d.clearLastInputPoint(),e.next=1,d.go();case 1:if(t=e.sent){e.next=2;break}return e.abrupt("return");case 2:if(t){e.next=4;break}if(0!==V.value||0!==R.value||0!==W.value){e.next=3;break}return e.abrupt("return");case 3:t=new n.e(V.value,R.value,W.value),e.next=5;break;case 4:u=(s=t).x,c=s.y,o=s.z,V.value=u,R.value=c,W.value=o;case 5:T(new n.e,t,a,i,r.map(function(e){return e.getMcDbEntity()}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),!d.isKeyWordPicked("D")&&d.getStatus()!==s.j.kNone){e.next=7;break}return e.next=6,p();case 6:return e.abrupt("return",e.sent);case 7:if(f){e.next=8;break}return e.abrupt("return");case 8:return d.setMessage("\n".concat((0,n.t)("1643")).concat((0,n.t)("1585"),"<").concat((0,n.t)("1644"),">")),d.setBasePt(f),d.setKeyWords(""),d.setUserDraw(function(e,t){var n=r.map(function(e){return e.clone()});T(f,e,a,i,n),n.forEach(function(e,n){var a,i=null===(a=r[n])||void 0===a?void 0:a.getMcDbEntity();if(i){var s=i.trueColor.getColorValue(i.layerId);t.setColor(Number(s))}t.drawMcDbEntity(e)})}),e.next=9,d.go();case 9:if(x=e.sent,d.getStatus()!==s.j.kNone){e.next=11;break}return e.next=10,p(f);case 10:return e.abrupt("return",e.sent);case 11:if(x){e.next=12;break}return e.abrupt("return");case 12:b=r.map(function(e){return e.getMcDbEntity()}).filter(function(e){return!!e}),T(f,x,a,i,b);case 13:case"end":return e.stop()}},e)})),N.apply(this,arguments)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){(0,n.L)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}(0,n.d)("_stretch",function(){return N.apply(this,arguments)});var j=function(){return(0,n.N)(function e(t){(0,n.O)(this,e),(0,n.L)(this,"resizeObserver",null),(0,n.L)(this,"mutationObserver",null),(0,n.L)(this,"element",null),this.callback=t},[{key:"addListener",value:function(e){this.element=e,this.setupResizeObserver(),this.setupMutationObserver()}},{key:"removeListener",value:function(){this.resizeObserver&&(this.resizeObserver.unobserve(this.element),this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.element=null}},{key:"setupResizeObserver",value:function(){"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.callback),this.resizeObserver.observe(this.element))}},{key:"setupMutationObserver",value:function(){"undefined"!=typeof MutationObserver&&(this.mutationObserver=new MutationObserver(this.callback),this.mutationObserver.observe(this.element,{attributes:!0}))}}])}();function z(){return(z=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.M.getCurrentMxCAD();case 1:return(r=new n.l).setMessage((0,n.t)("1609")),e.next=2,r.go();case 2:if(a=e.sent,r.getStatus()!==s.j.kCancel){e.next=3;break}return e.abrupt("return");case 3:if(r.getStatus()!==s.j.kNone){e.next=4;break}return e.abrupt("return");case 4:if(!((i=a.getMcDbEntity())instanceof n.r||i instanceof n.q)){e.next=8;break}return(u=new n.j).setMessage((0,n.t)("1610")),e.next=5,u.go();case 5:if(c=e.sent,u.getStatus()!==s.j.kCancel){e.next=6;break}return e.abrupt("return");case 6:if(u.getStatus()!==s.j.kNone){e.next=7;break}return e.abrupt("return");case 7:return c&&(o=i.center.clone(),l=c.sub(o).normalize().mult(i.radius),d=o.clone().addvec(l),f=o.clone().addvec(l.clone().negate()),p=Math.min(f.distanceTo(c),d.distanceTo(c)),t.drawDimDiametric(d.x,d.y,f.x,f.y,p)),e.abrupt("continue",10);case 8:return s.M.acutPrintf((0,n.t)("1611")),e.abrupt("continue",1);case 9:e.next=1;break;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function B(){return(B=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.M.getCurrentMxCAD();case 1:return(r=new n.l).setMessage((0,n.t)("1609")),e.next=2,r.go();case 2:if(a=e.sent,r.getStatus()!==s.j.kCancel){e.next=3;break}return e.abrupt("return");case 3:if(r.getStatus()!==s.j.kNone){e.next=4;break}return e.abrupt("return");case 4:if(!((i=a.getMcDbEntity())instanceof n.r||i instanceof n.q)){e.next=5;break}return u=i.center.clone(),c=n.u.kXAxis.clone().mult(i.radius),o=u.clone().addvec(c),t.drawDimDiametric(u.x,u.y,o.x,o.y,i.radius),e.abrupt("continue",7);case 5:return s.M.acutPrintf((0,n.t)("1611")),e.abrupt("continue",1);case 6:e.next=1;break;case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(e){return new Promise(function(t){var r=(0,n.Q)(),a=r.hideLoading,i=r.showLoading;try{var s=(0,n.F)().info((0,n.t)("1801")+"..."),u=n.M.App.getCurrentMxCAD().openWebFile(e,function(e){0===e?((0,n.F)().success((0,n.t)("1802")),t(!0)):((0,n.F)().error((0,n.t)("1543")),t(!1)),a(),s()});(0,n.P)(e).then(function(e){e/1048576>1&&u&&i()}),t(u)}catch(e){a(),t(!1)}})}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(F=function(){return!!e})()}function H(e,t,r,a){var i=(0,n.T)((0,n.U)(e.prototype),t,r);return"function"==typeof i?function(e){return i.apply(r,e)}:i}(0,n.d)("_watermark",function(e){var t={watermark_txt:(0,n.t)("1645"),watermark_html:"",watermark_x:20,watermark_y:20,watermark_rows:200,watermark_cols:200,watermark_x_space:80,watermark_y_space:80,watermark_color:"#aaa",watermark_alpha:.4,watermark_fontsize:"15px",watermark_font:"微软雅黑",watermark_width:"auto",watermark_height:"auto",watermark_angle:15,watermark_className:"mx_mask_div"};t=K(K({},t),e);var r,a=n.M.getCurrentMxCAD().mxdraw.getCanvas(),i=null,s=null,u=function(){document.querySelectorAll("."+t.watermark_className).forEach(function(e){return e.remove()})},c=function(){var e=document.createDocumentFragment(),r=a.parentElement,n=r.clientWidth,c=r.clientHeight;if(n!==i||c!==s){i=n,s=c,u();var o=Math.max(r.scrollWidth,r.clientWidth),l=Math.max(r.scrollHeight,r.clientHeight);if("auto"===t.watermark_width||"auto"===t.watermark_height)if(""!==t.watermark_html){var d=function(e){var t=document.createElement("template");t.innerHTML=e.trim();var r=document.createElement("div");r.style.position="absolute",r.style.visibility="hidden",r.style.pointerEvents="none",r.appendChild(t.content.cloneNode(!0)),document.body.appendChild(r);var n=r.getBoundingClientRect(),a=n.width,i=n.height;return a=Math.ceil(a)+5,i=Math.ceil(i),document.body.removeChild(r),{width:a,height:i}}(t.watermark_html),f=d.width,p=d.height;"auto"===t.watermark_width&&(t.watermark_width=f),"auto"===t.watermark_height&&(t.watermark_height=p)}else{var x=t.watermark_txt.length,b=parseFloat(t.watermark_fontsize)||16,g=function(e,t,r){"string"==typeof t&&(t=parseFloat(t));var n=document.createElement("canvas"),a=n.getContext("2d");if(a){a.font=t+"px "+r;var i=a.measureText(e).width,s=1.2*t;return n.remove(),{width:i=Math.ceil(i),height:s=Math.ceil(s)}}}(t.watermark_txt,t.watermark_fontsize,t.watermark_font)||{},v=g.width,k=void 0===v?x*b:v,w=g.height,h=void 0===w?b+t.watermark_x_space+t.watermark_y_space:w;"auto"===t.watermark_width&&(t.watermark_width=k),"auto"===t.watermark_height&&(t.watermark_height=h)}t.watermark_cols=Math.ceil(o/(t.watermark_x_space+t.watermark_width)),t.watermark_rows=Math.ceil(l/(t.watermark_y_space+t.watermark_height));for(var y,m,M=0;M<t.watermark_rows;M++){m=t.watermark_y+(t.watermark_y_space+t.watermark_height)*M;for(var D=0;D<t.watermark_cols;D++){y=t.watermark_x+(t.watermark_width+t.watermark_x_space)*D;var P=document.createElement("div");P.id=(t.watermark_className||"")+M+D,P.className=t.watermark_className||"",""!==t.watermark_html?P.innerHTML=t.watermark_html:P.appendChild(document.createTextNode(t.watermark_txt)),P.style.webkitTransform="rotate(-"+t.watermark_angle+"deg)",P.style.MozTransform="rotate(-"+t.watermark_angle+"deg)",P.style.msTransform="rotate(-"+t.watermark_angle+"deg)",P.style.OTransform="rotate(-"+t.watermark_angle+"deg)",P.style.transform="rotate(-"+t.watermark_angle+"deg)",P.style.visibility="",P.style.position="absolute",P.style.left=y+"px",P.style.top=m+"px",P.style.overflow="hidden",P.style.zIndex="1050",P.style.pointerEvents="none",P.style.opacity=t.watermark_alpha.toString(),P.style.fontSize=t.watermark_fontsize,P.style.fontFamily=t.watermark_font,P.style.color=t.watermark_color,P.style.textAlign="center",P.style.width=t.watermark_width+"px",P.style.height=t.watermark_height+"px",P.style.display="block",e.appendChild(P)}}r.appendChild(e)}};return c(),r=function(e,t){var r=new j(t);return r.addListener(e),r}(a,function(e){var t;return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];clearTimeout(t),t=setTimeout(function(){return e.apply(void 0,n)},200)}}(c)),function(){u(),r&&function(e){e.removeListener()}(r)}}),(0,n.d)("_DrawDiametricDimension",function(){return z.apply(this,arguments)}),(0,n.d)("_DrawRadialDimension",function(){return B.apply(this,arguments)}),(0,n.d)("_openMxweb",function(e){U(e)}),s.M.on("mxcadApplicationCreatedMxCADObject",function(){var e,t=[],r=n.M.getCurrentMxCAD().mxdraw.getOrbitControls();r.addEventListener("change",function(){clearTimeout(e),e=setTimeout(function(){var e=r.object.position.clone(),a=r.object.zoom,i=r.target.clone(),s=n.M.getCurrentMxCAD().mxdraw.getCamera();t.push({zoom:a,position:e,target:i,camera:s.clone(!1)})},500)});var a=function(e){if(!e)return!1;var r=n.M.getCurrentMxCAD().mxdraw,i=r.getOrbitControls(),s=i.object.position.clone(),u=i.object.zoom,c=i.target.clone(),o=n.M.getCurrentMxCAD().mxdraw.getCamera();return o.copy(e.camera,!1),o.updateProjectionMatrix(),u===e.zoom&&s.equals(e.position)&&c.equals(e.target)?a(t.pop()):(i.object.position.copy(e.position),i.object.zoom=e.zoom,i.target.copy(e.target),i.update(),r._mxdrawObj.mcObject.updateDisplayMatrixData(),!0)};(0,n.d)("Mx_WindowZoom",(0,n._)(n.a.mark(function e(){var r,i,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new n.j).setMessage("\n"+(0,n.t)("1698")),r.setKeyWords("[".concat((0,n.t)("182"),"(A)/").concat((0,n.t)("183"),"(E)/").concat((0,n.t)("184"),"(P)/").concat((0,n.t)("177"),"(O)]")),i=n.M.getCurrentMxCAD(),e.next=1,r.go();case 1:if(u=e.sent,!r.isKeyWordPicked("A")){e.next=2;break}return e.abrupt("return",i.mxdraw.zoomInitialStates());case 2:if(!r.isKeyWordPicked("E")){e.next=3;break}return e.abrupt("return",i.zoomAll(!0));case 3:if(!r.isKeyWordPicked("P")){e.next=4;break}return a(t.pop())||s.M.acutPrintf("\n"+(0,n.t)("1702")+"\n"+(0,n.t)("1703")),e.abrupt("return");case 4:if(!r.isKeyWordPicked("O")){e.next=8;break}return e.next=5,n.w.userSelect("ZOOM ".concat((0,n.t)("1602")));case 5:if(!((c=e.sent).length<=0)){e.next=6;break}return e.abrupt("return");case 6:if(o=n.w.getMcDbEntitysBoundingBox(c)){e.next=7;break}return e.abrupt("return");case 7:return l=o.minPt,d=o.maxPt,e.abrupt("return",i.zoomW(l,d));case 8:if(null!=u){e.next=9;break}return e.abrupt("return");case 9:return r.setUserDraw(function(e,t){t.drawRect(n.R.cad2doc1(u),n.R.cad2doc1(e))}),r.setKeyWords(""),e.next=10,r.go();case 10:if(null!=(f=e.sent)){e.next=11;break}return e.abrupt("return");case 11:i.zoomW(u,f);case 12:case"end":return e.stop()}},e)})))});var Y=function(e){function t(){var e;(0,n.O)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=function(e,t,r){return t=(0,n.U)(t),(0,n.V)(e,F()?Reflect.construct(t,r||[],(0,n.U)(e).constructor):t.apply(e,r))}(this,t,[].concat(a)),(0,n.L)(e,"dDashArray",.03),(0,n.L)(e,"dDashRatio",.1),(0,n.L)(e,"isAligned",!1),(0,n.L)(e,"fixedSize",!0),(0,n.L)(e,"referenceAxis",new THREE.Vector3(0,1,1)),(0,n.L)(e,"offsetHeight",void 0),(0,n.L)(e,"isDrawsMallRound",!0),e}return(0,n.S)(t,e),(0,n.N)(t,[{key:"getTypeName",value:function(){return"MxAuxiliaryLine"}},{key:"create",value:function(){return new t}},{key:"onViewChange",value:function(){return!!this.fixedSize&&(this.setNeedUpdateDisplay(!1),!0)}},{key:"worldDraw",value:function(e){var t=this.getDash(),r=t.dDashArray,n=t.dDashRatio,a=e.getMxObject();e.setLineWidth(.7),e.setDash(r,n);var i=this.toSmallcoord(a,this.pt1),u=this.toSmallcoord(a,this.pt2),c=i,o=u;void 0===this.offsetHeight&&(this.offsetHeight=a.screenCoordLong2World(40));var l=this.offsetHeight;if(this.isAligned){i.x>u.x&&(i=this.pt2,u=this.pt1);var d=u.clone().sub(i).cross(this.referenceAxis.clone().normalize()).normalize();c=i.clone().add(d.clone().multiplyScalar(l)),o=u.clone().add(d.clone().multiplyScalar(l))}else{var f=Math.abs(this.referenceAxis.y?i.y-u.y:i.x-u.x)+l,p=l,x=f;(0!==this.referenceAxis.x&&i.x>u.x||0!==this.referenceAxis.y&&i.y>u.y)&&(i=this.pt2,u=this.pt1),this.referenceAxis.x>0&&(p=f,x=l),this.referenceAxis.y>0&&(p=f,x=l),c=i.clone().add(this.referenceAxis.clone().multiplyScalar(p)),o=u.clone().add(this.referenceAxis.clone().multiplyScalar(x))}c.setZ(i.z),o.setZ(u.z);var b=s.r.createDashedLines([i,c,o,u],8421504,.1,.1);if(e.drawEntity(b),this.isDrawsMallRound){var g=a.screenCoordLong2World(1);e.drawCircle(i,g),e.drawCircle(u,g),e.drawCircle(c,g),e.drawCircle(o,g)}var v=c.distanceTo(o).toFixed(3);if(e.getType()===s.v.kWorldDraw){var k=new s.t;k.opacity=1,k.text=v,k.backgroundColor=16777185,k.color=16,k.position=new THREE.Vector3((c.x+o.x)/2,(c.y+o.y)/2),k.setFontSize(36),k.height=a.screenCoordLong2World(16),k.setLineWidthByPixels(!0),k.setUseSmallcoordDisplay(this.use_smallcoord_display),k.worldDraw(e)}else{var w=s.r.creatTextSprite(v,new THREE.Vector3((c.x+o.x)/2,(c.y+o.y)/2),a.screenCoordLong2World(16),0,16777215);w&&e.drawEntity(w)}}},{key:"getGripPoints",value:function(){return[this.pt1,this.pt2]}},{key:"moveGripPointsAt",value:function(e,t){return 0===e&&this.pt1.add(t),1===e&&this.pt2.add(t),!0}},{key:"dwgIn",value:function(e){return H(t,"dwgIn",this)([e]),this.dwgInHelp(e,["referenceAxis","isAligned","offsetHeight","fixedSize","isDrawsMallRound"]),!0}},{key:"dwgOut",value:function(e){return e=H(t,"dwgOut",this)([e]),this.dwgOutHelp(e,["referenceAxis","isAligned","offsetHeight","fixedSize","isDrawsMallRound"]),e}}])}(s.w);function X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(X=function(){return!!e})()}var q=function(e){function t(){var e;(0,n.O)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=function(e,t,r){return t=(0,n.U)(t),(0,n.V)(e,X()?Reflect.construct(t,r||[],(0,n.U)(e).constructor):t.apply(e,r))}(this,t,[].concat(a)),(0,n.L)(e,"dDashArray",.03),(0,n.L)(e,"dDashRatio",.1),(0,n.L)(e,"pt1",void 0),(0,n.L)(e,"pt2",void 0),(0,n.L)(e,"center",void 0),(0,n.L)(e,"fixedSize",!0),(0,n.L)(e,"offsetDist",void 0),(0,n.L)(e,"isClockwise","auto"),(0,n.L)(e,"isDrawsMallRound",!0),(0,n.L)(e,"isMaxRadius",!1),(0,n.L)(e,"radius",void 0),e}return(0,n.S)(t,e),(0,n.N)(t,[{key:"getTypeName",value:function(){return"MxAuxiliaryArc"}},{key:"create",value:function(){return new t}},{key:"onViewChange",value:function(){return!!this.fixedSize&&(this.setNeedUpdateDisplay(!1),!0)}},{key:"calculateLineAngle",value:function(e,t,r){var n=2*Math.PI/360;return{startAngle:180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI*n,endAngle:180*Math.atan2(r.y-e.y,r.x-e.x)/Math.PI*n}}},{key:"getClockwise",value:function(){var e=this.getStartPoint(),t=this.getEndPoint(),r=this.isClockwise;if("auto"===r){var n=e.clone().sub(this.center),a=t.clone().sub(this.center);r=n.x*a.y-n.y*a.x<0}return r}},{key:"getAngle",value:function(){var e=this.center,t=this.getStartPoint(),r=this.getEndPoint(),n=this.getClockwise(),a=this.calculateLineAngle(e,t,r),i=a.startAngle,s=a.endAngle-i;return!n&&s<0?s+=2*Math.PI:n&&s>0&&(s-=2*Math.PI),Math.abs(s)}},{key:"getRadius",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.radius?this.radius+(e&&this.offsetDist||0):this.isMaxRadius?Math.max(this.center.distanceTo(this.pt1),this.center.distanceTo(this.pt2)):this.center.distanceTo(this.pt2)+(e&&this.offsetDist||0)}},{key:"getStartPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.M.getCurrentDraw(),t=this.pt1;this.pt2;var r=this.center,n=t;void 0===this.offsetDist&&(this.offsetDist=e.screenCoordLong2World(40));var a=this.offsetDist,i=t.clone().sub(r).normalize(),u=this.getRadius()+a;return(n=r.clone().add(i.multiplyScalar(u))).setZ(t.z),n}},{key:"getEndPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.M.getCurrentDraw(),t=this.pt2,r=this.center,n=t;void 0===this.offsetDist&&(this.offsetDist=e.screenCoordLong2World(40));var a=this.offsetDist,i=t.clone().sub(r).normalize(),u=this.getRadius()+a;return(n=r.clone().add(i.multiplyScalar(u))).setZ(t.z),n}},{key:"worldDraw",value:function(e){var t=this.getDash(),r=t.dDashArray,n=t.dDashRatio,a=e.getMxObject();e.setDash(r,n),e.setLineWidth(.7),this.toSmallcoord(a,this.pt2);var i=this.center;void 0===this.offsetDist&&(this.offsetDist=a.screenCoordLong2World(40));var u=this.offsetDist,c=this.getStartPoint(),o=this.getEndPoint(),l=this.getRadius()+u,d=this.calculateLineAngle(i,c,o),f=d.startAngle,p=d.endAngle,x=this.getClockwise(),b=new THREE.ArcCurve(i.x,i.y,l,f,p,x),g=(new THREE.Geometry).setFromPoints(b.getPoints(50)),v=s.r.createDashedLines([c,i,o],8421504,.1,.1);if(e.setColor(8421504),e.drawEntity(v),e.drawGeometryLines(g),this.isDrawsMallRound){var k=a.screenCoordLong2World(2);e.drawCircle(c,k),e.drawCircle(o,k)}var w=this.getAngle(),h=THREE.MathUtils.radToDeg(w).toFixed(3)+"°",y=b.getPointAt(.5),m=y.x,M=y.y,D=new THREE.Vector3(m,M);if(e.getType()===s.v.kWorldDraw){var P=new s.t;P.opacity=1,P.text=h,P.backgroundColor=16777185,P.color=16,P.position=D,P.setFontSize(36),P.height=a.screenCoordLong2World(16),P.setLineWidthByPixels(!0),P.setUseSmallcoordDisplay(this.use_smallcoord_display),P.worldDraw(e)}else{var A=s.r.creatTextSprite(h,D,a.screenCoordLong2World(16),0,16777215);A&&e.drawEntity(A)}}},{key:"getGripPoints",value:function(){return[this.pt1,this.pt2,this.center]}},{key:"moveGripPointsAt",value:function(e,t){return 0===e&&this.pt1.add(t),1===e&&this.pt2.add(t),2===e&&this.center.add(t),!0}},{key:"dwgIn",value:function(e){return this.dwgInHelp(e,["fixedSize","isDrawsMallRound","offsetDist","pt1","pt2","center","isClockwise","isMaxRadius","radius"]),!0}},{key:"dwgOut",value:function(e){return this.dwgOutHelp(e,["fixedSize","isDrawsMallRound","offsetDist","pt1","pt2","center","isClockwise","isMaxRadius","radius"]),e}}])}(s.x);function G(e,t,r){if(e.isEqualTo(t))return 0;var a=e.c().addvec(t.c().sub(e).mult(.5)),i=t.c().sub(e);i.rotateBy(Math.PI/2,n.u.kZAxis);var s=new n.m(a,a.c().addvec(i)),u=r.c();u.rotateBy(Math.PI/2,n.u.kZAxis);var c=new n.m(e,e.c().addvec(u)),o=s.IntersectWith(c,n.H.Intersect.kExtendBoth);if(o.isEmpty())return 0;var l=o.at(0),d=l.distanceTo(e);i.normalize(),i.mult(d);var f=l.c().addvec(i),p=l.c().subvec(i),x=f.c().sub(e),b=p.c().sub(e),g=f;return x.angleTo1(r)>b.angleTo1(r)&&(g=p),n.w.calcBulge(e,g,t).val}var J=function(){var e=(0,n._)(n.a.mark(function e(t,r){var a,i,u,c,o,l,d,f,p,x,b,g,v,k;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,i=new n.j,u=!1,c=function(e){"Control"===e.key&&(u=!0)},o=n.M.getCurrentMxCAD(),l=function(){return u=!1},window.addEventListener("keydown",c),window.addEventListener("keyup",l),d=function(){window.removeEventListener("keydown",c),window.removeEventListener("keyup",l)},t){e.next=4;break}return i.clearLastInputPoint(),i.setMessage((0,n.t)("1684")),e.next=1,i.go();case 1:if(f=e.sent,i.getDetailedResult()!==s.D.kNewCommadIn){e.next=2;break}return d(),e.abrupt("return",!1);case 2:if(f){e.next=3;break}return e.abrupt("return",d());case 3:t=f;case 4:p=[{point:t}],x=n.a.mark(function e(){var c,l,f,x,b,g,v,k,w,h,y,m,M,D,P,A,C,E,I,L,_,S,T,V,R,W,N,O,K,j,z,B,U,F,H,Y,X,q,J,Z,Q,$,ee,te,re,ne,ae,ie,se,ue,ce,oe,le,de,fe,pe,xe,be,ge,ve,ke,we,he,ye,me,Me,De,Pe,Ae,Ce,Ee,Ie,Le,_e,Se,Te,Ve,Re,We,Ne,Oe,Ke,je,ze,Be,Ue,Fe,He,Ye,Xe,qe,Ge,Je,Ze,Qe,$e,et,tt,rt,nt,at,it,st,ut,ct,ot;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}return i.setMessage((0,n.t)("1727")),i.setKeyWords("[".concat((0,n.t)("171"),"(A)/").concat(p.length>2?(0,n.t)("1728")+"(C)/":"").concat((0,n.t)("1552"),"(U)/").concat((0,n.t)("1549"),"(T)]")),i.setUserDraw(function(e,t){var r=new n.f;p.forEach(function(e){var t=e.point,n=e.bulge;r.addVertexAt(t,n)}),r.addVertexAt(e),t.drawMcDbEntity(r)}),e.next=1,i.go();case 1:if(c=e.sent,i.getDetailedResult()!==s.D.kNullEnterIn&&i.getDetailedResult()!==s.D.kNullSpaceIn){e.next=2;break}return l=new n.f,p.forEach(function(e){var t=e.point,r=e.bulge;l.addVertexAt(t,r)}),f=l.getLength().val,x=o.drawEntity(l),r&&r(p),e.abrupt("return",{v:{dist:f,pl:l,plId:x}});case 2:if(i.getDetailedResult()!==s.D.kNewCommadIn){e.next=3;break}return d(),e.abrupt("return",{v:!1});case 3:if(i.getStatus()!==s.j.kCancel){e.next=4;break}return e.abrupt("return",{v:d()});case 4:if(i.getStatus()!==s.j.kNone){e.next=5;break}return e.abrupt("return",{v:d()});case 5:if(!i.isKeyWordPicked("A")){e.next=6;break}return a=!1,e.abrupt("return",0);case 6:if(!i.isKeyWordPicked("U")){e.next=7;break}return 0===p.length?s.M.acutPrintf((0,n.t)("1729")):(p.pop(),!(null===(b=p[p.length-1])||void 0===b)&&b.point&&i.setLastInputPoint(p[p.length-1].point),r&&r(p)),e.abrupt("return",0);case 7:if(!i.isKeyWordPicked("T")){e.next=8;break}return g=new n.f,p.forEach(function(e){var t=e.point,r=e.bulge;g.addVertexAt(t,r)}),v=g.getLength().val,k=o.drawEntity(g),r&&r(p),e.abrupt("return",{v:{dist:v,pl:g,plId:k}});case 8:if(!i.isKeyWordPicked("C")){e.next=9;break}return(w=new n.f).isClosed=!0,p.forEach(function(e){var t=e.point,r=e.bulge;w.addVertexAt(t,r)}),h=w.getLength().val,r&&r(p),y=o.drawEntity(w),e.abrupt("return",{v:{dist:h,pl:w,plId:y}});case 9:if(!c){e.next=10;break}return p.push({point:c}),r&&r(p),e.abrupt("return",0);case 10:e.next=82;break;case 11:return(m=i).setMessage((0,n.W)("NO1_ID_ARX_PL5","".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")"))),m.setKeyWords("[".concat((0,n.t)("169"),"(A)/").concat((0,n.t)("185"),"(CE)/").concat(p.length>2?(0,n.t)("1728")+"(C)/":"").concat((0,n.t)("186"),"(D)/").concat((0,n.t)("173"),"(L)/").concat((0,n.t)("187"),"(R)/").concat((0,n.t)("1735"),"(S)/").concat((0,n.t)("1552"),"(U)]")),M=new n.u,p.length<2?M.copy(n.u.kXAxis):(D=p.length,P=p[D-2].point,A=p[D-2].bulge,C=p[D-1].point,!A||Math.abs(A)<1e-7?M=new n.e(C.x,C.y,0).sub(new n.e(P.x,P.y,0)):((E=new n.f).addVertexAt(P,A),E.addVertexAt(C),(I=E.getFirstDeriv(new n.e(C.x,C.y,0))).ret?M=I.val:M.copy(n.u.kXAxis))),L=p[p.length-1],m.setUserDraw(function(e,t){var r=G(L.point,e,u?M.clone().negate():M),a=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;a.addVertexAt(t,r)}),a.addVertexAt(L.point,r),a.addVertexAt(e),t.drawMcDbEntity(a)}),e.next=12,m.go();case 12:if(_=e.sent,m.getDetailedResult()!==s.D.kNullEnterIn&&m.getDetailedResult()!==s.D.kNullSpaceIn){e.next=13;break}return S=new n.f,p.forEach(function(e){var t=e.point,r=e.bulge;S.addVertexAt(t,r)}),T=S.getLength().val,V=o.drawEntity(S),r&&r(p),e.abrupt("return",{v:{dist:T,pl:S,plId:V}});case 13:if(null===_){e.next=14;break}R={point:_,bulge:0},p[p.length-1].bulge=G(L.point,R.point,u?M.clone().negate():M),p.push(R),r&&r(p),e.next=82;break;case 14:if(m.getStatus()!=s.j.kKeyWord){e.next=80;break}if(!m.isKeyWordPicked("A")){e.next=31;break}return(W=new n.o).setBasePt(L.point),W.setMessage((0,n.W)("ID_ARX_PLGET_I_ANGLE",(0,n.t)("1736"))),e.next=15,W.go();case 15:if(N=e.sent,W.getDetailedResult()!==s.D.kNewCommadIn){e.next=16;break}return d(),e.abrupt("return",{v:!1});case 16:if(null!==N){e.next=17;break}return e.abrupt("return",1);case 17:return m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords("[".concat((0,n.t)("185"),"(CE)/").concat((0,n.t)("187"),"(R)]")),m.setLastInputPoint(L.point),O=p[p.length-1].point,K=function(e){var t=Math.PI/2-N/2,r=new n.e((e.x+O.x)/2,(e.y+O.y)/2),a=r.distanceTo(O),i=a/Math.sin(t),s=a/Math.tan(t),c=r.sub(O).rotateBy(Math.PI/2).normalize().mult(u?-i-s:i-s),o=r.addvec(c);return n.w.calcBulge(O,o,e).val},m.setUserDraw(function(e,t){var r=K(e),a=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;a.addVertexAt(t,r)}),a.addVertexAt(L.point,r),a.addVertexAt(e),t.drawMcDbEntity(a)}),e.next=18,m.go();case 18:if(j=e.sent,!m.isKeyWordPicked("CE")){e.next=22;break}return m.setMessage((0,n.t)("1737")),m.setKeyWords(""),m.setBasePt(O),m.setUserDraw(function(e,t){var r=e.distanceTo(O),a=e.addvec(e.sub(O).rotateBy(N).normalize().mult(r)),i=K(a),s=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;s.addVertexAt(t,r)}),s.addVertexAt(L.point,i),s.addVertexAt(a),t.drawMcDbEntity(s)}),e.next=19,m.go();case 19:if(z=e.sent,m.getDetailedResult()!==s.D.kNewCommadIn){e.next=20;break}return d(),e.abrupt("return",{v:!1});case 20:if(z){e.next=21;break}return e.abrupt("return",1);case 21:return B=z.distanceTo(O),U=z.addvec(z.sub(O).rotateBy(N).normalize().mult(B)),(F={}).bulge=0,F.point=U,p[p.length-1].bulge=K(U),p.push(F),m.setLastInputPoint(U),r&&r(p),e.abrupt("return",0);case 22:if(!m.isKeyWordPicked("R")){e.next=29;break}return(H=new n.z).setMessage((0,n.t)("1738")),H.setKeyWords(""),e.next=23,H.go();case 23:if(Y=e.sent,H.getDetailedResult()!==s.D.kNewCommadIn){e.next=24;break}return d(),e.abrupt("return",{v:!1});case 24:if("number"==typeof Y){e.next=25;break}return e.abrupt("return",1);case 25:return X=Y*Math.sin(N/2),m.setBasePt(O),m.setMessage("".concat((0,n.t)("1739"),"(").concat((0,n.t)("1740"),")")),m.setKeyWords(""),m.setUserDraw(function(e,t){var r=O.clone().addvec(e.sub(O).normalize().mult(2*X)),a=K(r),i=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;i.addVertexAt(t,r)}),i.addVertexAt(L.point,a),i.addVertexAt(r),t.drawMcDbEntity(i)}),e.next=26,m.go();case 26:if(q=e.sent,m.getDetailedResult()!==s.D.kNewCommadIn){e.next=27;break}return d(),e.abrupt("return",{v:!1});case 27:if(q){e.next=28;break}return e.abrupt("return",1);case 28:return J=O.clone().addvec(q.sub(O).normalize().mult(2*X)),(Z={}).bulge=0,Z.point=J,p[p.length-1].bulge=K(J),p.push(Z),r&&r(p),e.abrupt("return",0);case 29:if(j){e.next=30;break}return e.abrupt("return",1);case 30:(Q={}).bulge=0,Q.point=j,p[p.length-1].bulge=K(j),p.push(Q),r&&r(p);case 31:if(!m.isKeyWordPicked("CE")){e.next=47;break}return m.setMessage((0,n.t)("1737")),m.setKeyWords(""),m.setUserDraw(function(){}),e.next=32,m.go();case 32:if($=e.sent,m.getDetailedResult()!==s.D.kNewCommadIn){e.next=33;break}return d(),e.abrupt("return",{v:!1});case 33:if($){e.next=34;break}return e.abrupt("return",{v:d()});case 34:return ee=L.point,te=$.distanceTo(ee),m.setLastInputPoint(ee),m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords("[".concat((0,n.t)("169"),"(A)/").concat((0,n.t)("188"),"(L)]")),m.clearLastInputPoint(),m.setUserDraw(function(e,t){t.drawLine(e.toVector3(),$.toVector3());var r=$.clone().addvec(e.sub($).normalize().mult(te)),a=$.sub(ee).angleTo2($.sub(r),n.u.kZAxis),i=new n.e((ee.x+r.x)/2,(ee.y+r.y)/2),s=$.sub(i).normalize().mult(-te),c=$.clone().addvec((u?a<Math.PI:a>Math.PI)?s.negate():s),o=n.w.calcBulge(ee,c,r).val,l=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;l.addVertexAt(t,r)}),l.addVertexAt(L.point,o),l.addVertexAt(r),t.drawMcDbEntity(l)}),e.next=35,m.go();case 35:if(re=e.sent,!m.isKeyWordPicked("A")){e.next=39;break}return(ne=new n.o).setBasePt($),ne.setMessage((0,n.W)("ID_ARX_PLGET_I_ANGLE","".concat((0,n.t)("1736"),"(").concat((0,n.t)("1731"),")"))),ne.setKeyWords(""),ne.setUserDraw(function(e,t){var r=n.u.kXAxis.clone().angleTo2(e.sub($),n.u.kZAxis),a=u?2*Math.PI-r/2:r/2,i=ee.sub($).rotateBy(a).normalize().mult(te),s=ee.sub($).rotateBy(r).normalize().mult(te),c=$.clone().addvec(i),o=$.clone().addvec(s),l=n.w.calcBulge(ee,c,o).val,d=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;d.addVertexAt(t,r)}),d.addVertexAt(L.point,l),d.addVertexAt(o),t.drawMcDbEntity(d)}),e.next=36,ne.go();case 36:if(ae=e.sent,ne.getDetailedResult()!==s.D.kNewCommadIn){e.next=37;break}return d(),e.abrupt("return",{v:!1});case 37:if(null!==ae){e.next=38;break}return e.abrupt("return",1);case 38:return ie=u?2*Math.PI-ae/2:ae/2,se=ee.sub($).rotateBy(ie).normalize().mult(te),ue=ee.sub($).rotateBy(ae).normalize().mult(te),ce=$.clone().addvec(se),oe=$.clone().addvec(ue),le=n.w.calcBulge(ee,ce,oe).val,(de={}).bulge=0,de.point=oe,p[p.length-1].bulge=le,p.push(de),new n.f,r&&r(p),e.abrupt("return",0);case 39:if(!m.isKeyWordPicked("L")){e.next=44;break}return(fe=new n.z).setMessage("".concat((0,n.t)("1742"),"(").concat((0,n.t)("1731"),")")),fe.setKeyWords(""),fe.setBasePt(ee),fe.setUserDraw(function(e,t){var r=e.distanceTo(ee);if(!(r>2*te)){var a=2*Math.asin(r/2/te),i=ee.sub($).normalize().mult(te),s=$.clone().addvec(i.clone().rotateBy(u?Math.PI-a/2:a/2)),c=$.clone().addvec(i.clone().rotateBy(a)),o=n.w.calcBulge(ee,s,c).val,l=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;l.addVertexAt(t,r)}),l.addVertexAt(L.point,o),l.addVertexAt(c),t.drawMcDbEntity(l)}}),e.next=40,fe.go();case 40:if(pe=e.sent,fe.getDetailedResult()!==s.D.kNewCommadIn){e.next=41;break}return d(),e.abrupt("return",{v:!1});case 41:if("number"==typeof pe){e.next=42;break}return e.abrupt("return",1);case 42:if(!(pe>2*te)){e.next=43;break}return s.M.acutPrintf("*".concat((0,n.t)("1743")," ").concat((0,n.t)("1744"),"*")),m.setLastInputPoint(ee),e.abrupt("return",0);case 43:return xe=2*Math.asin(pe/2/te),be=ee.sub($).normalize().mult(te),ge=$.clone().addvec(be.clone().rotateBy(u?Math.PI-xe/2:xe/2)),ve=$.clone().addvec(be.clone().rotateBy(xe)),ke=n.w.calcBulge(ee,ge,ve).val,(we={}).bulge=0,we.point=ve,p[p.length-1].bulge=ke,p.push(we),m.setLastInputPoint(ve),r&&r(p),e.abrupt("return",0);case 44:if(m.getDetailedResult()!==s.D.kNewCommadIn){e.next=45;break}return d(),e.abrupt("return",{v:!1});case 45:if(re){e.next=46;break}return e.abrupt("return",{v:d()});case 46:return he=$.clone().addvec(re.sub($).normalize().mult(te)),ye=$.sub(ee).angleTo2($.sub(he),n.u.kZAxis),me=new n.e((ee.x+he.x)/2,(ee.y+he.y)/2),Me=$.sub(me).normalize().mult(-te),De=$.clone().addvec((u?ye<Math.PI:ye>Math.PI)?Me.negate():Me),Pe=n.w.calcBulge(ee,De,he).val,(Ae={}).bulge=0,Ae.point=he,p[p.length-1].bulge=Pe,p.push(Ae),m.setLastInputPoint(he),r&&r(p),e.abrupt("return",0);case 47:if(!m.isKeyWordPicked("R")){e.next=62;break}return(Ce=new n.z).setMessage((0,n.W)("ID_ARX_PLGETSTARTRADIUS",(0,n.t)("1745"))),Ce.setKeyWords(""),e.next=48,Ce.go();case 48:if(Ee=e.sent,Ce.getDetailedResult()!==s.D.kNewCommadIn){e.next=49;break}return d(),e.abrupt("return",{v:!1});case 49:if(null!==Ee){e.next=50;break}return e.abrupt("return",1);case 50:return Ie=L.point,m.setLastInputPoint(Ie),m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords("[".concat((0,n.t)("169"),"(A)]")),m.setUserDraw(function(e,t){if(Ee){var r=e.distanceTo(Ie);if(!(r>2*Ee)){var a=Math.acos(r/2/Ee),i=Ie.clone().addvec(e.sub(Ie).rotateBy(a).normalize().mult(Ee)),s=i.clone().addvec(new n.e((Ie.x+e.x)/2,(Ie.y+e.y)/2).sub(i).normalize().mult(u?-Ee:Ee)),c=n.w.calcBulge(Ie,s,e).val,o=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;o.addVertexAt(t,r)}),o.addVertexAt(L.point,c),o.addVertexAt(e),t.drawMcDbEntity(o)}}}),e.next=51,m.go();case 51:if(Le=e.sent,!m.isKeyWordPicked("A")){e.next=58;break}return(_e=new n.o).setMessage((0,n.W)("ID_ARX_PLGET_I_ANGLE",(0,n.t)("1736"))),_e.setKeyWords(""),_e.setBasePt(Ie),e.next=52,_e.go();case 52:if(Se=e.sent,_e.getDetailedResult()!==s.D.kNewCommadIn){e.next=53;break}return d(),e.abrupt("return",{v:!1});case 53:if("number"==typeof Se){e.next=54;break}return e.abrupt("return",1);case 54:return Te=Math.sin(Se/2)*Ee*2,m.setMessage("".concat((0,n.t)("1739"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords(""),m.setBasePt(Ie),m.setUserDraw(function(e,t){if(Ee){var r=e.sub(Ie).normalize(),a=Ie.clone().addvec(r.clone().mult(Te)),i=a.clone().addvec(r.clone().negate().rotateBy(-(Math.PI/2-Se/2)).mult(Ee)),s=i.clone().addvec(i.sub(new n.e((Ie.x+a.x)/2,(Ie.y+a.y)/2)).normalize().mult(u?Ee:-Ee)),c=n.w.calcBulge(Ie,s,a).val,o=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;o.addVertexAt(t,r)}),o.addVertexAt(L.point,c),o.addVertexAt(a),t.drawMcDbEntity(o)}}),e.next=55,m.go();case 55:if(Ve=e.sent,m.getDetailedResult()!==s.D.kNewCommadIn){e.next=56;break}return d(),e.abrupt("return",{v:!1});case 56:if(Ve){e.next=57;break}return e.abrupt("return",1);case 57:return Re=Ve.sub(Ie).normalize(),We=Ie.clone().addvec(Re.clone().mult(Te)),Ne=We.clone().addvec(Re.clone().negate().rotateBy(-(Math.PI/2-Se/2)).mult(Ee)),Oe=Ne.clone().addvec(Ne.sub(new n.e((Ie.x+We.x)/2,(Ie.y+We.y)/2)).normalize().mult(u?Ee:-Ee)),Ke=n.w.calcBulge(Ie,Oe,We).val,(je={}).bulge=0,je.point=We,p[p.length-1].bulge=Ke,p.push(je),r&&r(p),e.abrupt("return",0);case 58:if(m.getDetailedResult()!==s.D.kNewCommadIn){e.next=59;break}return d(),e.abrupt("return",{v:!1});case 59:if(Le){e.next=60;break}return e.abrupt("return",1);case 60:if(!((ze=Le.distanceTo(Ie))>2*Ee)){e.next=61;break}return s.M.acutPrintf("".concat((0,n.t)("1730")," *").concat((0,n.t)("1744"),"*")),e.abrupt("return",0);case 61:return Be=Math.acos(ze/2/Ee),Ue=Ie.clone().addvec(Le.sub(Ie).rotateBy(Be).normalize().mult(Ee)),Fe=Ue.clone().addvec(new n.e((Ie.x+Le.x)/2,(Ie.y+Le.y)/2).sub(Ue).normalize().mult(u?-Ee:Ee)),He=n.w.calcBulge(Ie,Fe,Le).val,(Ye={}).bulge=0,Ye.point=Le,p[p.length-1].bulge=He,p.push(Ye),r&&r(p),e.abrupt("return",0);case 62:if(!m.isKeyWordPicked("D")){e.next=68;break}return m.setMessage((0,n.t)("1746")),m.setKeyWords(""),m.setUserDraw(function(e,t){t.drawLine(e.toVector3(),L.point.toVector3())}),e.next=63,m.go();case 63:if(Xe=e.sent,m.getDetailedResult()!==s.D.kNewCommadIn){e.next=64;break}return d(),e.abrupt("return",{v:!1});case 64:if(Xe){e.next=65;break}return e.abrupt("return",1);case 65:return qe=Xe.sub(L.point),m.setLastInputPoint(L.point),m.setMessage("".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")")),m.setKeyWords(""),m.setUserDraw(function(e,t){var r=G(L.point,e,u?qe.clone().negate():qe),a=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;a.addVertexAt(t,r)}),a.addVertexAt(L.point,r),a.addVertexAt(e),t.drawMcDbEntity(a)}),e.next=66,m.go();case 66:if(Ge=e.sent,m.getDetailedResult()!==s.D.kNewCommadIn){e.next=67;break}return d(),e.abrupt("return",{v:!1});case 67:return(Je={}).bulge=0,Je.point=Ge,p[p.length-1].bulge=G(L.point,Je.point,u?qe.clone().negate():qe),p.push(Je),r&&r(p),e.abrupt("return",0);case 68:if(!m.isKeyWordPicked("L")){e.next=69;break}a=!0,e.next=79;break;case 69:if(!m.isKeyWordPicked("S")){e.next=77;break}return Ze=new n.e(p[p.length-1].point.x,p[p.length-1].point.y,0),(Qe=new n.j).setMessage((0,n.W)("NO1_ID_SPECIFY_ARC2",(0,n.t)("1747"))),Qe.setBasePt(Ze),e.next=70,Qe.go();case 70:if($e=e.sent,Qe.getDetailedResult()!==s.D.kNewCommadIn){e.next=71;break}return d(),e.abrupt("return",{v:!1});case 71:if(null!==$e){e.next=72;break}return e.abrupt("return",1);case 72:return(et=new n.j).setMessage((0,n.W)("ID_CIRCULAR_ENDPOINT","".concat((0,n.t)("1730"),"(").concat((0,n.t)("1731"),")"))),et.setUserDraw(function(e,t){var r=new n.r;r.computeArc(Ze.x,Ze.y,$e.x,$e.y,e.x,e.y);var a=$e;u&&(a=r.center.clone().addvec(r.center.clone().sub($e)));var i=n.w.calcBulge(Ze,a,e).val,s=new n.f;p.forEach(function(e){var t=e.point,r=e.bulge;s.addVertexAt(t,r)}),s.addVertexAt(L.point,i),s.addVertexAt(e),t.drawMcDbEntity(s)}),e.next=73,et.go();case 73:if(null===(tt=e.sent)){e.next=74;break}rt=$e,u&&((nt=new n.r).computeArc(Ze.x,Ze.y,$e.x,$e.y,tt.x,tt.y),rt=nt.center.clone().addvec(nt.center.clone().sub($e))),(at=n.w.calcBulge(Ze,rt,tt)).ret?((it={}).point=tt,it.dBluge=0,p[p.length-1].bulge=at.val,p.push(it),r&&r(p)):s.M.acutPrintf((0,n.W)("ID_ENDPOINT_INVALID1","\n ".concat((0,n.t)("189")," *").concat((0,n.t)("1744"),"*"))),e.next=76;break;case 74:if(et.getDetailedResult()!==s.D.kNewCommadIn){e.next=75;break}return d(),e.abrupt("return",{v:!1});case 75:return e.abrupt("return",1);case 76:e.next=79;break;case 77:if(!m.isKeyWordPicked("C")){e.next=78;break}return p[p.length-1].bulge=G(L.point,t,u?M.clone().negate():M),(st=new n.f).isClosed=!0,p.forEach(function(e){var t=e.point,r=e.bulge;st.addVertexAt(t,r)}),ut=st.getLength().val,r&&r(p),ct=o.drawEntity(st),e.abrupt("return",{v:{dist:ut,pl:st,plId:ct}});case 78:m.isKeyWordPicked("U")&&p.length>1&&(p.pop(),ot=new n.f,p.forEach(function(e){var t=e.point,r=e.bulge;ot.addVertexAt(t,r)}),r&&r(p),p.length>0&&m.setLastInputPoint(p[p.length-1].point));case 79:e.next=82;break;case 80:if(m.getDetailedResult()!==s.D.kNewCommadIn){e.next=81;break}return d(),e.abrupt("return",{v:!1});case 81:return e.abrupt("return",1);case 82:case"end":return e.stop()}},e)});case 5:return e.delegateYield(x(),"t0",6);case 6:if(0!==(b=e.t0)){e.next=7;break}return e.abrupt("continue",5);case 7:if(1!==b){e.next=8;break}return e.abrupt("continue",10);case 8:if(!b){e.next=9;break}return e.abrupt("return",b.v);case 9:e.next=5;break;case 10:return g=new n.f,p.forEach(function(e){var t=e.point,r=e.bulge;g.addVertexAt(t,r)}),v=g.getLength().val,r&&r(p),k=o.drawEntity(g),e.abrupt("return",{dist:v,pl:g,plId:k});case 11:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}();function Z(e,t){var r=t.x,n=t.y;return e.x>r&&e.y>n||e.x<r&&e.y<n}function Q(e,t){var r=(e.x+t.x)/2,a=(e.y+t.y)/2;return new n.e(r,a)}function $(e,t,r){var n=Z(e,r),a=Z(t,r);return n&&a}function ee(){return te.apply(this,arguments)}function te(){return te=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h,y,m,M,D=arguments;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=D.length>0&&void 0!==D[0]&&D[0],r=new n.j,a=[],r.clearLastInputPoint(),r.setMessage((0,n.t)("1684")),e.next=1,r.go();case 1:if(i=e.sent,r.getDetailedResult()!==s.D.kNewCommadIn){e.next=2;break}return e.abrupt("return",!1);case 2:if(i){e.next=3;break}return e.abrupt("return");case 3:return r.setUserDraw(function(e,t){t.drawLine(i.toVector3(),e.toVector3())}),r.setMessage((0,n.t)("1694")),r.setKeyWords("[".concat((0,n.t)("1769"),"(M)]")),e.next=4,r.go();case 4:if(u=e.sent,r.getDetailedResult()!==s.D.kNewCommadIn){e.next=5;break}return e.abrupt("return",!1);case 5:if(r.getStatus()!==s.j.kCancel){e.next=6;break}return e.abrupt("return");case 6:if(!r.isKeyWordPicked("M")){e.next=10;break}return e.next=7,J(i,function(e){var t=new n.f;e.forEach(function(e){var r=e.point,n=e.bulge;t.addVertexAt(r,n)}),s.M.acutPrintf((0,n.t)("191")+" = "+t.getLength().val)});case 7:if(!1!==(c=e.sent)){e.next=8;break}return e.abrupt("return",c);case 8:if(o=(c||{}).plId){e.next=9;break}return e.abrupt("return");case 9:return(l=o.getMcDbEntity())&&a.push(l),e.abrupt("return",{markedLines:a});case 10:if(!u){e.next=11;break}return t&&(d=$(i,u,Q(i,u)),(f=new Y).referenceAxis=new THREE.Vector3(0,0,d?-1:1),f.isAligned=!0,f.pt1=i.toVector3(),f.pt2=u.toVector3(),s.M.addToCurrentSpace(f),a.push(f),Math.abs(i.x-u.x)>.001&&Math.abs(i.y-u.y)>.001&&((p=new Y).isAligned=!1,p.referenceAxis=new THREE.Vector3(0,i.y>u.y?1:-1,-1),p.pt1=i.toVector3(),p.pt2=u.toVector3(),s.M.addToCurrentSpace(p),a.push(p),(x=new Y).isAligned=!1,x.referenceAxis=new THREE.Vector3(i.x>u.x?1:-1,0,-1),x.pt1=i.toVector3(),x.pt2=u.toVector3(),s.M.addToCurrentSpace(x),a.push(x),(b=new q).offsetDist=0,b.center=i.toVector3(),b.pt1=i.toVector3().add(new THREE.Vector3(1,0,0)),b.pt2=u.toVector3(),s.M.addToCurrentSpace(b),a.push(b)),(g=new s.w).pt1=i.toVector3(),g.pt2=u.toVector3(),s.M.addToCurrentSpace(g),a.push(g)),v=i.distanceTo(u),k=u.x-i.x,w=u.y-i.y,h=u.z-i.z,y=Math.atan2(w,k)*(180/Math.PI),m=Math.sqrt(k*k+w*w+h*h),M=0===m?0:Math.asin(h/m)*(180/Math.PI),s.M.acutPrintf("".concat((0,n.t)("191")," = ").concat((0,n.X)(v,4)," , XY ").concat((0,n.t)("1770")," = ").concat((0,n.X)(y,4)," , ").concat((0,n.t)("1771")," XY ").concat((0,n.t)("1772")," = ").concat((0,n.X)(M,4),"\n X 增量 = ").concat((0,n.X)(k,4),"，  Y 增量 = ").concat((0,n.X)(w,4),"，   Z 增量 = ").concat((0,n.X)(h,4))),e.abrupt("return",{dist:v,angleInDegrees:y,angleWithZAxis:M,deltaX:k,deltaY:w,deltaZ:h,markedLines:a});case 11:case"end":return e.stop()}},e)})),te.apply(this,arguments)}function re(){return ne.apply(this,arguments)}function ne(){return ne=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p=arguments;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=p.length>0&&void 0!==p[0]&&p[0];case 1:return r=new n.l,(a=new n.v).AddMcDbEntityTypes("CIRCLE,ARC"),r.setFilter(a),r.setMessage((0,n.t)("1762")),e.next=2,r.go();case 2:if(i=e.sent,r.getDetailedResult()!==s.D.kCodeAbort){e.next=3;break}return e.abrupt("return");case 3:if(r.getDetailedResult()!==s.D.kEcsIn){e.next=4;break}return e.abrupt("return");case 4:if(r.getDetailedResult()!==s.D.kMouseRightIn){e.next=5;break}return e.abrupt("return");case 5:if(r.getDetailedResult()!==s.D.kNewCommadIn){e.next=6;break}return e.abrupt("return",!1);case 6:if(r.getDetailedResult()!==s.D.kNullSpaceIn){e.next=7;break}return e.abrupt("return");case 7:if(r.getDetailedResult()!==s.D.kNullEnterIn){e.next=8;break}return e.abrupt("return");case 8:if(i){e.next=9;break}return e.abrupt("return");case 9:if(!((u=i.getMcDbEntity())instanceof n.r||u instanceof n.q)){e.next=12;break}if(c=[],!t){e.next=11;break}if(o=u.getClosestPointTo(r.getDocPickPoint(),!1),l=o.val,o.ret&&l){e.next=10;break}return e.abrupt("return");case 10:d=u.center,(f=new Y).pt1=l.toVector3(),f.pt2=d.toVector3(),f.isAligned=!0,f.offsetHeight=0,s.M.addToCurrentSpace(f),c.push(f);case 11:return s.M.acutPrintf((0,n.t)("187")+" = "+u.radius+"\n"+(0,n.t)("190")+" = "+2*u.radius+"\n"),e.abrupt("return",{radius:u.radius,markedLines:c});case 12:e.next=1;break;case 13:case"end":return e.stop()}},e)})),ne.apply(this,arguments)}function ae(e,t,r,n){var a=v(n,e,r),i=v(n,t,r);return!!isNaN(i)||!isNaN(a)&&(i===a?r.distanceTo(e)>r.distanceTo(t):a<i)}function ie(){return se.apply(this,arguments)}function se(){return(se=(0,n._)(n.a.mark(function e(){var t,r,a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new n.l,(r=new n.v).AddMcDbEntityTypes("CIRCLE,ARC,LINE,LWPOLYLINE"),a=n.a.mark(function e(){var a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h,y,m,M,D,P,A,C,E,I,L,S,T,V,R,W,N,O,K,j,z,B,U,F,H,Y,X,G,J,Z,Q,$;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setFilter(r),t.setMessage("".concat((0,n.t)("1581")).concat((0,n.t)("171"),"、").concat((0,n.t)("172"),"、").concat((0,n.t)("173"),"<").concat((0,n.t)("1586"),">")),e.next=1,t.go();case 1:if(a=e.sent,i=t.getDetailedResult(),u=[],t.getDetailedResult()!==s.D.kNewCommadIn){e.next=2;break}return e.abrupt("return",{v:!1});case 2:if(t.getDetailedResult()!==s.D.kCodeAbort){e.next=3;break}return e.abrupt("return",{v:!1});case 3:if(t.getDetailedResult()!==s.D.kEcsIn){e.next=4;break}return e.abrupt("return",{v:void 0});case 4:if(i!==s.D.kNullEnterIn&&i!==s.D.kNullSpaceIn&&i!==s.D.kMouseRightIn){e.next=11;break}return c=new s.a,o=new q,c.setMessage("\n".concat((0,n.t)("1750"))),e.next=5,c.go();case 5:if(l=e.sent){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:return o.center=l,c.setMessage("\n${t('1588')}"),c.setUserDraw(function(e,t){t.drawLine(e,l)}),e.next=7,c.go();case 7:if(d=e.sent){e.next=8;break}return e.abrupt("return",{v:void 0});case 8:return o.pt1=d,c.setMessage("\n".concat((0,n.t)("1589"),":")),c.setUserDraw(function(e,t){t.drawLine(e,l),t.drawLine(d,l),o.offsetDist=0,o.pt2=e,t.drawCustomEntity(o)}),e.next=9,c.go();case 9:if(f=e.sent){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:return o.pt2=f,p=l.distanceTo(d)-l.distanceTo(f),o.offsetDist=p<0?0:p/2,(x=new s.w).pt1=l,x.pt2=d,(b=new s.w).pt1=l,b.pt2=f,s.M.addToCurrentSpace(x),s.M.addToCurrentSpace(b),s.M.addToCurrentSpace(o),g=o.getAngle(),s.M.acutPrintf((0,n.t)("169")+" = "+g+"°"),u.push(o,x,b),e.abrupt("return",{v:{angle:g,markedArcs:u}});case 11:if(a){e.next=12;break}return e.abrupt("return",0);case 12:if(v=a.getMcDbEntity()){e.next=13;break}return e.abrupt("return",0);case 13:if(!(v instanceof n.m||v instanceof n.f)){e.next=30;break}if(m=t.getDocPickPoint(),v instanceof n.f?(D=_(v,m,2)||{},P=D.start,A=D.end,k=P,w=A):(k=v.startPoint,w=v.endPoint),k){e.next=14;break}return e.abrupt("return",0);case 14:if(w){e.next=15;break}return e.abrupt("return",0);case 15:return(C=new n.v).AddMcDbEntityTypes("LINE,LWPOLYLINE"),t.setFilter(C),t.setMessage((0,n.t)("1590")),e.next=16,t.go();case 16:if(E=e.sent,M=t.getDocPickPoint(),t.getDetailedResult()!==s.D.kNewCommadIn){e.next=17;break}return e.abrupt("return",{v:!1});case 17:if(t.getDetailedResult()!==s.D.kCodeAbort){e.next=18;break}return e.abrupt("return",{v:!1});case 18:if(t.getDetailedResult()!==s.D.kEcsIn){e.next=19;break}return e.abrupt("return",{v:void 0});case 19:if(E){e.next=20;break}return e.abrupt("continue",15);case 20:if(E.isValid()){e.next=21;break}return e.abrupt("continue",15);case 21:if((I=E.getMcDbEntity())instanceof n.f?(L=_(I,M,2)||{},S=L.start,T=L.end,h=S,y=T):I instanceof n.m&&(h=I.startPoint,y=I.endPoint),!h||!y){e.next=22;break}return e.abrupt("continue",23);case 22:return e.abrupt("continue",15);case 23:if(!(V=new n.m(k,w).IntersectWith(new n.m(h,y),n.H.Intersect.kExtendBoth)).isEmpty()){e.next=24;break}return s.M.acutPrintf((0,n.t)("1751")),e.abrupt("return",{v:void 0});case 24:if(k){e.next=25;break}return e.abrupt("return",0);case 25:if(w){e.next=26;break}return e.abrupt("return",0);case 26:if(h){e.next=27;break}return e.abrupt("return",0);case 27:if(y){e.next=28;break}return e.abrupt("return",0);case 28:if(M){e.next=29;break}return e.abrupt("return",0);case 29:return R=V.at(0),W=ae(k,w,R,m),N=W?k:w,O=ae(h,y,R,m),K=O?h:y,(j=new q).center=R.toVector3(),j.pt1=N.toVector3(),j.pt2=K.toVector3(),j.isMaxRadius=!0,j.offsetDist=0,s.M.addToCurrentSpace(j),z=j.getAngle(),s.M.acutPrintf((0,n.t)("169")+" = "+z+"°"),u.push(j),(B=new s.w).pt1=j.pt1,B.pt2=j.center,(U=new s.w).pt1=j.center,U.pt2=j.pt2,s.M.addToCurrentSpace(B),s.M.addToCurrentSpace(U),u.push(B,U),e.abrupt("return",{v:{angle:z,markedArcs:u}});case 30:if(!(v instanceof n.r)){e.next=31;break}return(F=new q).offsetDist=v.radius,F.center=v.center.toVector3(),F.pt1=new THREE.Vector3(v.radius),F.pt1.applyAxisAngle(new THREE.Vector3(0,0,1),v.startAngle).add(v.center.toVector3()),F.pt2=new THREE.Vector3(v.radius),F.pt2.applyAxisAngle(new THREE.Vector3(0,0,1),v.endAngle).add(v.center.toVector3()),(H=v.endAngle-v.startAngle)>Math.PI?H-=2*Math.PI:H<-Math.PI&&(H+=2*Math.PI),F.isClockwise=Math.abs(H)>Math.PI&&H>0,s.M.addToCurrentSpace(F),Y=F.getAngle(),s.M.acutPrintf((0,n.t)("169")+" = "+Y+"°"),u.push(F),(X=new s.w).pt1=F.pt1,X.pt2=F.center,(G=new s.w).pt1=F.center,G.pt2=F.pt2,s.M.addToCurrentSpace(X),s.M.addToCurrentSpace(G),u.push(X,G),e.abrupt("return",{v:{angle:Y,markedArcs:u}});case 31:if(!(v instanceof n.q)){e.next=35;break}return(J=new q).center=v.center.toVector3(),J.pt1=t.getDocPickPoint().toVector3(),(Z=new n.j).setUserDraw(function(e,t){J.pt2=e.toVector3(),J.offsetDist=0,t.drawCustomEntity(J)}),Z.setMessage((0,n.t)("1752")),e.next=32,Z.go();case 32:if(Q=e.sent,Z.getDetailedResult()!==s.D.kNewCommadIn){e.next=33;break}return e.abrupt("return",{v:!1});case 33:if(Q){e.next=34;break}return e.abrupt("return",{v:void 0});case 34:return J.pt2=Q.toVector3(),J.offsetDist=v.radius,s.M.addToCurrentSpace(J),$=J.getAngle(),s.M.acutPrintf((0,n.t)("169")+" = "+$+"°"),u.push(J),e.abrupt("return",{v:{angle:$,markedArcs:u}});case 35:case"end":return e.stop()}},e)});case 1:return e.delegateYield(a(),"t0",2);case 2:if(0!==(i=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(!i){e.next=4;break}return e.abrupt("return",i.v);case 4:e.next=1;break;case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}(0,n.d)("_MxMeasurementDistance",ee);var ue=function(e){var t=e.numVerts(),r=[];if(t<3)return r;var a=n.M.getCurrentMxCAD(),i=e.getPointAt(0).val,s=e.getPointAt(t-1).val;if(!e.isClosed&&!i.isEqualTo(s))return r;a.pathMoveTo(i.x,i.y);for(var u=0;u<t;u++){var c=e.getPointAt(u).val,o=e.getBulgeAt(u),l=e.getWidthsAt(u),d=l.val1,f=l.val2;a.pathLineToEx(c.x,c.y,d,f,o)}a.pathLineTo(s.x,s.y);var p=a.drawPathToHatch().getMcDbEntity();return p&&r.push(p),r},ce=function(){var e=(0,n._)(n.a.mark(function e(t){var r,a,i,s,u,c,o,l,d,f,p,x,b,g,v;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.M.getCurrentMxCAD(),!(t instanceof n.f)){e.next=1;break}return e.abrupt("return",ue(t));case 1:if(!(t instanceof n.q)){e.next=3;break}if(r.pathMoveTo(t.center.x,t.center.y),r.pathCircle(t.center.x,t.center.y,t.radius),a=r.drawPathToHatch(),!(i=a.getMcDbEntity())){e.next=2;break}return e.abrupt("return",[i]);case 2:e.next=5;break;case 3:return s=t.clone(),u=r.getDatabase().currentSpace.getBoundingBox(),c=u.minPt,o=u.maxPt,l=c.clone(),d=o.clone(),s.move(l,d),f=s.getBoundingBox(),p=new n.e((f.minPt.x+f.maxPt.x)/2,(f.minPt.y+f.maxPt.y)/2),x=r.drawEntity(s),e.next=4,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 4:if(b=n.w.builderHatchFromPoint(p),x.erase(),s.erase(),!b){e.next=5;break}if(b.move(d,l),g=r.drawEntity(b),!(v=g.getMcDbEntity())){e.next=5;break}return e.abrupt("return",[v]);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h,y,m;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new n.j,r=[],a=!1,i=!1,u=0;case 1:return t.setMessage((a?"(".concat((0,n.t)("1753"),")"):"")+(i?"(".concat((0,n.t)("1754"),")"):"")+"".concat((0,n.t)("1617"),"<").concat((0,n.t)("177"),">")),t.setKeyWords("[".concat((0,n.t)("177"),"(O)/").concat(a?"":(0,n.t)("1755")+"(A)/").concat(i?"":(0,n.t)("1756")+"(S)/").concat((0,n.t)("1757"),"(X)]")),e.next=2,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 2:return e.next=3,t.go();case 3:if(c=e.sent,t.getDetailedResult()!==s.D.kNewCommadIn){e.next=4;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 4:if(t.getDetailedResult()!==s.D.kCodeAbort){e.next=5;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 5:if(t.getDetailedResult()!==s.D.kEcsIn&&t.getDetailedResult()!==s.D.kMouseRightIn){e.next=6;break}return e.abrupt("return",r.length>0?{markedLines:r}:void 0);case 6:if(!t.isKeyWordPicked("O")&&t.getDetailedResult()!==s.D.kNullEnterIn&&t.getDetailedResult()!==s.D.kNullSpaceIn){e.next=18;break}case 7:return(o=new n.l).setMessage((0,n.t)("1602")),e.next=8,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 8:return e.next=9,o.go();case 9:if(l=e.sent,o.getDetailedResult()!==s.D.kNewCommadIn){e.next=10;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 10:if(o.getDetailedResult()!==s.D.kCodeAbort){e.next=11;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 11:if(o.getDetailedResult()!==s.D.kEcsIn){e.next=12;break}return e.abrupt("return",r.length>0&&{markedLines:r});case 12:if(o.getDetailedResult()!==s.D.kNullEnterIn&&o.getDetailedResult()!==s.D.kNullSpaceIn&&o.getDetailedResult()!==s.D.kMouseRightIn){e.next=13;break}return e.abrupt("continue",18);case 13:if(l){e.next=14;break}return e.abrupt("continue",7);case 14:if(d=l.getMcDbEntity()){e.next=15;break}return e.abrupt("continue",7);case 15:return f=d.getArea().val,p=0,d instanceof n.k&&(p=d.getLength().val),e.next=16,ce(d);case 16:if((x=e.sent)&&r.push.apply(r,(0,n.Y)(x)),0===f&&x&&(d instanceof n.q?f=Math.PI*Math.pow(d.radius,2):d instanceof n.K&&0===d.startAngle&&d.endAngle===2*Math.PI?(b=Math.sqrt(d.majorAxis.x*d.majorAxis.x+d.majorAxis.y*d.majorAxis.y)/2,g=b*d.radiusRatio,f=Math.PI*b*g,v=Math.pow((b-g)/(b+g),2),p=Math.PI*(b+g)*(1+3*v/(10+Math.sqrt(4-3*v)))):f=x.reduce(function(e,t){return e+t.getArea().val},0)),0===f?s.M.acutPrintf((0,n.t)("1758")+"\n"):s.M.acutPrintf("".concat((0,n.t)("1759")," = ").concat(f,", ").concat((0,n.t)("1760")," = ").concat(p,"\n")),!a&&!i){e.next=17;break}return a?u+=f:u-=f,s.M.acutPrintf("".concat((0,n.t)("1761")," = ").concat(u,"\n")),e.abrupt("continue",7);case 17:return e.abrupt("return",{markedLines:r});case 18:if(!t.isKeyWordPicked("A")){e.next=19;break}return a=!0,i=!1,e.abrupt("continue",1);case 19:if(!t.isKeyWordPicked("S")){e.next=20;break}return i=!0,a=!1,e.abrupt("continue",1);case 20:if(!t.isKeyWordPicked("X")){e.next=21;break}return s.M.acutPrintf("".concat((0,n.t)("1761")," = ").concat(u,"\n")),e.abrupt("return",r.length>0?{markedLines:r}:void 0);case 21:if(!c){e.next=26;break}return e.next=22,J(c);case 22:if(!1!==(k=e.sent)){e.next=23;break}return e.abrupt("return",r.length>0?{markedLines:r}:k);case 23:if(w=(k||{}).plId){e.next=24;break}return e.abrupt("return",r.length>0?{markedLines:r}:void 0);case 24:if(!((h=w.getMcDbEntity())instanceof n.f)){e.next=26;break}if(h.isClosed=!0,r.push(h),y=ue(h),r.push.apply(r,(0,n.Y)(y)),m=h.getArea().val,s.M.acutPrintf("".concat((0,n.t)("1759")," = ").concat(h.getArea().val,", ").concat((0,n.t)("1760")," = ").concat(h.getLength().val,"\n")),!a&&!i){e.next=25;break}return a?u+=m:u-=m,s.M.acutPrintf("".concat((0,n.t)("1761")," = ").concat(u,"\n")),e.abrupt("continue",1);case 25:return e.abrupt("return",{markedLines:r});case 26:e.next=1;break;case 27:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function le(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(le=function(){return!!e})()}var de=function(e){function t(){return(0,n.O)(this,t),function(e,t,r){return t=(0,n.U)(t),(0,n.V)(e,le()?Reflect.construct(t,r||[],(0,n.U)(e).constructor):t.apply(e,r))}(this,t,arguments)}return(0,n.S)(t,e),(0,n.N)(t,[{key:"getTypeName",value:function(){return"MxSelectLine"}},{key:"worldDraw",value:function(e){e.setLineWidthByPixels(!0),e.setLineWidth(10),e.setColor(16737894),e.drawSelectLine(this.pt1,this.pt2)}}])}(s.w);function fe(e,t,r){var a=e.distanceTo(t)/2,i=a*r,s=(a*a+i*i)/(2*i),u=(e.x+t.x)/2,c=(e.y+t.y)/2;return new n.e(u,c).addvec(t.clone().sub(e).perpVector().normalize().mult(s-i))}function pe(e,t,r,n){var a=t.clone().sub(e),i=r.clone().sub(e),s=a.length(),u=(new THREE.Vector3).crossVectors(a,i);void 0===n&&(n=u.dot(new THREE.Vector3(0,0,1))<0);var c=a.clone().add(i);return n&&(c=c.negate()),c=c.normalize(),e.clone().add(c.multiplyScalar(s))}function xe(){return(xe=(0,n._)(n.a.mark(function e(){var t,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.j).setMessage((0,n.t)("1749")),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:s.M.acutPrintf("X = ".concat(r.x,"     Y = ").concat(r.y,"     Z = ").concat(r.z," \n"));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function be(e,t,r,n){var a=e-r,i=t-n,s=0;return s=0==a?Math.PI/2:Math.atan(Math.abs(i/a)),a<0&&i>=0?s=Math.PI-s:a<0&&i<0?s=Math.PI+s:a>=0&&i<0&&(s=2*Math.PI-s),s-Math.PI}function ge(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.x-e.x,s=t.y-e.y,u=r.x-e.x,c=r.y-e.y,o=i*i+s*s;if(0===o||a){var l=0===o?0:(u*i+c*s)/o;return new n.e(e.x+i*l,e.y+s*l)}var d=(u*i+c*s)/o;return d<0?e:d>1?t:new n.e(e.x+i*d,e.y+s*d)}function ve(e,t,r){var n=t.x-e.x,a=t.y-e.y,i=r.x-e.x,s=r.y-e.y,u=n*n+a*a;if(0===u)return r.x===e.x&&r.y===e.y;var c=(i*n+s*a)/u;return c>=0&&c<=1||(c<0?{isStart:!0}:{isStart:!1})}(0,n.d)("_MEASUREGEOM",(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,n.t)("1764"),i=[],u=function(){i.forEach(function(e){e.erase()})},e.prev=1,c=n.a.mark(function e(){var c,o,l,d,f,p,x,b,g,v,k,w,h,y,m,M,D,P,A,C,E,I,L,S,T;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(x=new n.j).setCursorType(s.h.kCross),x.disableAllTrace(),x.setDisableDynInput(!0),x.clearLastInputPoint(),x.setMessage(a),b="[".concat((0,n.t)("191"),"(D)/").concat((0,n.t)("187"),"(R)/").concat((0,n.t)("169"),"(A)/").concat((0,n.t)("192"),"(AR)/").concat((0,n.t)("1767"),"(Q)/").concat((0,n.t)("193"),"(M)/").concat((0,n.t)("1757"),"(X)]"),x.setKeyWords(b),g=n.M.getCurrentMxCAD(),v=new n.J,k=new n.v([n.Z.kEntityType,"LINE,ARC,CIRCLE,LWPOLYLINE,INSERT"]),w=function(e,t,r){for(var a,i,s,u,c=function(){var u=e[o].getMcDbEntity();if(!u)return 0;if(u instanceof n.$){var c=u.blockTableRecordId.getMcDbBlockTableRecord();return c?{v:w(c.getAllEntityId(),t.clone(),r.clone())}:0}if(!(u instanceof n.k))return 0;var l,d,f=u.IntersectWith(new n.m(t,r),n.H.Intersect.kOnBothOperands);if(u instanceof n.f&&u.isClosed){var p=u.numVerts()-1,x=u.getPointAt(0).val,b=u.getPointAt(p).val,g=new n.m(x,b).IntersectWith(new n.m(t,r),n.H.Intersect.kOnBothOperands);if(!g.isEmpty()){var v=g.at(0),k=v.distanceTo(t);(void 0===a||k<a)&&(i=u,a=k,s=v)}}if(f.isEmpty())return 0;f.forEach(function(e){var r=e.distanceTo(t);(void 0===d||r<d)&&(d=r,l=e)}),(void 0===a||d<a)&&(i=u,a=d,s=l)},o=0;o<e.length;o++)if(0!==(u=c())&&u)return u.v;if(i)return{minDistEnt:i,minDist:a,intersectPt:s}},h=function(e,t){if(v.crossingSelect(e.x,e.y,t.x,t.y,k),!v.isNull())return w(v.getIds(),e,t)},y=function(e,t,r,n){var a=t.clone().addvec(r.clone().mult(s.M.viewCoordLong2Cad(16))),i=s.r.createDashedLines([t.toVector3(),a.toVector3()],8421504,.1,.1),u=t.clone().addvec(r.clone().mult(s.M.viewCoordLong2Cad(28)));e.drawEntity(i),e.drawText(n,s.M.viewCoordLong2Cad(16),0,u.toVector3())},m=function(e,t,r,a,i){var s;if(t instanceof n.f||t instanceof n.m){var u,c;if(t instanceof n.m&&(u=t.startPoint,c=t.endPoint),t instanceof n.f){var o=_(t,i,10);if(!o)return;var l=t.getBulgeAt(o.startIndex);if(0===l)u=o.start,c=o.end;else{var d=t.getParamAtPoint(o.start).val,f=t.getParamAtPoint(o.end).val,p=t.getDistAtParam(d).val,x=t.getDistAtParam(f).val,b=fe(o.start,o.end,l);e.drawCircle(o.end.toVector3(),5);var g=pe(b.toVector3(),o.start.toVector3(),o.end.toVector3()),v=g.x,k=g.y,w=new n.e(v,k),h=w.clone().sub(b).normalize(),m=b.distanceTo(w);Math.abs(l)>1&&(w.addvec(b.clone().sub(w).normalize().mult(2*m)),h.negate()),y(e,w,h,Math.abs(x-p).toFixed(3))}}if(u&&c){var M=new de;M.pt1=u.toVector3(),M.pt2=c.toVector3(),e.drawCustomEntity(M);var D=new Y;return D.pt1=u.toVector3(),D.pt2=c.toVector3(),D.isAligned=!0,s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.x>r.x||a.y<r.y;D.referenceAxis=new THREE.Vector3(0,0,t?1:-1),e.drawCustomEntity(D)},{draw:s,line:new n.m(u,c)}}}if(t instanceof n.q){var P=new n.u(-1,0,0),A=t.center.clone().addvec(P.clone().mult(t.radius));y(e,A,P,t.getLength().val.toFixed(3))}if(t instanceof n.r){var C=t.getGripPoints().at(2);y(e,C,C.sub(t.center).normalize(),t.getLength().val.toFixed(3))}},M=function(e,t,r,a,i){if(a&&i&&(!a.startPoint.isEqualTo(i.startPoint)||!a.endPoint.isEqualTo(i.endPoint))){var u=a.IntersectWith(i,n.H.Intersect.kOnBothOperands);if(!u.isEmpty()){var c=new q;c.offsetDist=0;var o=u.at(0),l=ae(a.startPoint,a.endPoint,o,t),d=ae(i.startPoint,i.endPoint,o,r);c.pt1=l?a.startPoint.toVector3():a.endPoint.toVector3(),c.pt2=d?i.startPoint.toVector3():i.endPoint.toVector3(),c.center=o.toVector3();var f=c.getAngle();if(f===Math.PI/2){e.setColor(16760576),c.radius=Math.min(s.M.viewCoordLong2Cad(10),Math.min(a.getLength().val,i.getLength().val)/10);var p=c.getRadius(!0),x=c.getStartPoint().clone().add(c.center.clone().sub(c.pt1).normalize().negate().multiplyScalar(p)),b=c.getEndPoint().clone().add(c.center.clone().sub(c.pt2).normalize().negate().multiplyScalar(p)),g=new THREE.Vector3(x.x+b.x-c.center.x,x.y+b.y-c.center.y);e.drawLine(x,g),e.drawLine(b,g)}else c.radius=s.M.viewCoordLong2Cad(26),e.drawCustomEntity(c);return f}}},D=function(e,t,r,a,i,u){var c=new n.m(t,r),o=new n.m(t,a),l=new n.m(t,i),d=new n.m(t,u),f=h(t,r),p=h(t,a),x=h(t,i),b=h(t,u);f&&(c.endPoint=f.intersectPt),p&&(o.endPoint=p.intersectPt),x&&(l.endPoint=x.intersectPt),b&&(d.endPoint=b.intersectPt),e.setColor(16777215);var g=f&&m(e,f.minDistEnt,t,r,f.intersectPt)||{},v=g.line,k=g.draw,w=p&&m(e,p.minDistEnt,t,a,p.intersectPt)||{},y=w.line,D=w.draw,P=x&&m(e,x.minDistEnt,t,i,x.intersectPt)||{},A=P.line,C=P.draw,E=b&&m(e,b.minDistEnt,t,u,b.intersectPt)||{},I=E.line,L=E.draw,_=f&&x&&M(e,f.intersectPt,x.intersectPt,v,A),S=f&&b&&M(e,f.intersectPt,b.intersectPt,v,I),T=p&&x&&M(e,p.intersectPt,x.intersectPt,y,A),V=p&&b&&M(e,p.intersectPt,b.intersectPt,y,I);f&&p&&M(e,f.intersectPt,p.intersectPt,v,y),x&&b&&M(e,x.intersectPt,b.intersectPt,A,I);var R=Math.PI/2,W=_===R&&S===R&&T===R&&V===R;function N(e){return e.startPoint.x===e.endPoint.x?1/0:(e.endPoint.y-e.startPoint.y)/(e.endPoint.x-e.startPoint.x)}var O=function(e,t){return function(e,t){return N(e)===N(t)}(e,t)&&function(e,t){return e.getLength().val===t.getLength().val}(e,t)},K=[];v&&K.push({line:v,draw:k,info:f}),y&&K.push({line:y,draw:D,info:p}),A&&K.push({line:A,draw:C,info:x}),I&&K.push({line:I,draw:L,info:b}),K.reduce(function(e,t){for(var r=!1,n=0;n<e.length;n++){var a=e[n];if(O(a[0].line,t.line)){a.push(t),r=!0;break}}return r||e.push([t]),e},[]).forEach(function(e){if(1===e.length){if(O(e[0].line,new n.m(c.endPoint,o.endPoint))||O(e[0].line,new n.m(l.endPoint,d.endPoint)))return;e[0].draw&&e[0].draw()}else if(!W)if(2===e.length){if(O(e[1].line,new n.m(c.endPoint,o.endPoint))||O(e[1].line,new n.m(l.endPoint,d.endPoint)))return;f&&p||x&&b?(f&&p&&(f.intersectPt.distanceTo(t)<p.intersectPt.distanceTo(t)?k&&k(!0):D&&D()),x&&b&&(x.intersectPt.distanceTo(t)<b.intersectPt.distanceTo(t)?C&&C(!1):L&&L())):(e[0].draw&&e[0].draw(),e[1].draw&&e[1].draw())}else e.forEach(function(e){var t=e.draw;t&&t()})}),e.setColor(16760576),e.drawMcDbEntity(c),e.drawMcDbEntity(o),e.drawMcDbEntity(l),e.drawMcDbEntity(d);var j=s.M.viewCoordLong2Cad(16);if(f&&p){var z=c.endPoint.distanceTo(o.endPoint);c.endPoint.distanceTo(t)>o.endPoint.distanceTo(t)?e.drawText(z.toFixed(3),j,0,new THREE.Vector3((t.x+c.endPoint.x)/2,(t.y+c.endPoint.y)/2)):e.drawText(z.toFixed(3),j,0,new THREE.Vector3((t.x+o.endPoint.x)/2,(t.y+o.endPoint.y)/2))}if(x&&b){var B=l.endPoint.distanceTo(d.endPoint);l.endPoint.distanceTo(t)>d.endPoint.distanceTo(t)?e.drawText(B.toFixed(3),j,0,new THREE.Vector3((t.x+l.endPoint.x)/2,(t.y+l.endPoint.y)/2)):e.drawText(B.toFixed(3),j,0,new THREE.Vector3((t.x+d.endPoint.x)/2,(t.y+d.endPoint.y)/2))}},x.setUserDraw(function(e,t){var r=s.M.viewCoordLong2Cad(g.mxdraw.getViewWidth()),a=s.M.viewCoordLong2Cad(g.mxdraw.getViewHeight()),i=new n.e(-r,e.y),u=new n.e(e.x+r,e.y),c=new n.e(e.x,e.y+a),o=new n.e(e.x,-a);D(t,e,i,u,c,o)}),e.next=1,x.go();case 1:if(t=x.keyWordPicked(),x.getStatus()!==s.j.kCancel){e.next=2;break}return e.abrupt("return",0);case 2:if(x.getDetailedResult()!==s.D.kCodeAbort){e.next=3;break}return e.abrupt("return",0);case 3:if(x.getDetailedResult()!==s.D.kEcsIn){e.next=4;break}return e.abrupt("return",0);case 4:if((x.getDetailedResult()===s.D.kMouseRightIn||x.getDetailedResult()===s.D.kNullSpaceIn||x.getDetailedResult()===s.D.kNullEnterIn)&&(t=r),"D"!==(null===(c=t)||void 0===c?void 0:c.toLocaleUpperCase())){e.next=7;break}return u(),e.next=5,ee(!0);case 5:if(!1!==(P=e.sent)){e.next=6;break}return e.abrupt("return",0);case 6:return(A=(P||{}).markedLines)&&i.push.apply(i,(0,n.Y)(A)),e.next=7,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 7:if("R"!==(null===(o=t)||void 0===o?void 0:o.toLocaleUpperCase())){e.next=10;break}return u(),e.next=8,re(!0);case 8:if(!1!==(C=e.sent)){e.next=9;break}return e.abrupt("return",0);case 9:return(E=(C||{}).markedLines)&&i.push.apply(i,(0,n.Y)(E)),e.next=10,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 10:if("A"!==(null===(l=t)||void 0===l?void 0:l.toLocaleUpperCase())){e.next=13;break}return u(),e.next=11,ie();case 11:if(!1!==(I=e.sent)){e.next=12;break}return e.abrupt("return",0);case 12:return(L=(I||{}).markedArcs)&&i.push.apply(i,(0,n.Y)(L)),e.next=13,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 13:if("AR"!==(null===(d=t)||void 0===d?void 0:d.toLocaleUpperCase())){e.next=16;break}return u(),e.next=14,oe();case 14:if(!1!==(S=e.sent)){e.next=15;break}return e.abrupt("return",0);case 15:return(T=(S||{}).markedLines)&&i.push.apply(i,(0,n.Y)(T)),e.next=16,(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,1)}));case 1:case"end":return e.stop()}},e)}))();case 16:if("Q"===(null===(f=t)||void 0===f?void 0:f.toLocaleUpperCase())&&u(),"X"!==(null===(p=t)||void 0===p?void 0:p.toLocaleUpperCase())){e.next=17;break}return e.abrupt("return",0);case 17:return b.includes(t)&&""!==t&&(r=t),e.abrupt("return",1);case 18:case"end":return e.stop()}},e)});case 2:return e.delegateYield(c(),"t0",3);case 3:if(0!==(o=e.t0)){e.next=4;break}return e.abrupt("continue",6);case 4:if(1!==o){e.next=5;break}return e.abrupt("continue",2);case 5:e.next=2;break;case 6:e.next=8;break;case 7:e.prev=7,l=e.catch(1),console.warn(l);case 8:u();case 9:case"end":return e.stop()}},e,null,[[1,7]])}))),(0,n.d)("ID",function(){return xe.apply(this,arguments)});var ke=0,we=0,he={DE:(0,n.t)("1547"),P:(0,n.t)("1548"),T:(0,n.t)("1549"),DY:(0,n.t)("1550")},ye="DE",me=function(e,t,r,a){var i,s,u,c,o,l,d,f,p,x,b,g=e.getLength().val,v=e.getDistAtPoint(r).val,k=e.getStartPoint().val,w=e.getEndPoint().val,h=v<g/2;if(e instanceof n.m){var y=e.startPoint,m=e.endPoint;return h?(e.startPoint=k.clone().addvec(k.sub(w).normalize().mult(t)),i=function(){e.startPoint=y}):(e.endPoint=e.endPoint.clone().addvec(w.sub(k).normalize().mult(t)),i=function(){e.endPoint=m}),{ent:e,fallback:i}}if(e instanceof n.r){var M=e.startAngle,D=e.endAngle,P=e.clone();h?(P.startAngle=e.startAngle,P.endAngle=e.startAngle-1e-7):(P.startAngle=e.endAngle,P.endAngle=e.endAngle-1e-7);var A,C=P.getLength().val,E=e.center,I=e.getGripPoints().at(2),L=n.w.calcBulge(k,I,w).val>0;if(h)if(A=P.getPointAtDist(L?C-t:t).val,L)e.startAngle=be(E.x,E.y,A.x,A.y),i=function(){e.startAngle=M};else{var S=e.endAngle;e.startAngle=S,e.endAngle=be(E.x,E.y,A.x,A.y),i=function(){e.startAngle=M,e.endAngle=D}}else if(A=P.getPointAtDist(L?t:C-t).val,L)e.endAngle=be(E.x,E.y,A.x,A.y),i=function(){e.endAngle=D};else{var T=e.startAngle;e.startAngle=be(E.x,E.y,A.x,A.y),e.endAngle=T,i=function(){e.startAngle=M,e.endAngle=D}}return{fallback:i,ent:e}}if(e instanceof n.K){var V=e.clone();if(V.startAngle=0,V.endAngle=2*Math.PI,t>V.getLength().val-g)return;var R=V.getPointAtDist(0).val,W=V.getPointAtDist(h?V.getDistAtPoint(k).val-t:V.getDistAtPoint(w).val+t).val,N=R.sub(V.center),O=W.sub(V.center),K=Math.atan2(N.y,N.x),j=Math.atan2(O.y,O.x)-K;j<0&&(j+=2*Math.PI);var z=e.startAngle,B=e.endAngle;return h?e.startAngle=j:e.endAngle=j,{fallback:function(){h?e.startAngle=z:e.endAngle=B},ent:e}}if(e instanceof n.f){if(e.isClosed)return;var U=function(e){for(var t=[],r=0;r<e.numVerts();r++){var n=e.getWidthsAt(r),a=n.val1,i=n.val2;t.push({point:e.getPointAt(r).val,bulge:e.getBulgeAt(r),startWidth:a,endWidth:i})}return t},F=function(e,t){for(;e.removeVertexAt(0););for(var r=0;r<t.length;r++){var n=t[r];e.addVertexAt(n.point,n.bulge,n.startWidth,n.endWidth,r)}},H=function(e,t,r){var a=fe(e,t,r),i=new n.r;return i.center=a,i.radius=a.sub(e).length(),i.startAngle=be(a.x,a.y,e.x,e.y),i.endAngle=be(a.x,a.y,t.x,t.y),i},Y=function(e,t,r,n){if(r)if(n)e.startAngle=be(e.center.x,e.center.y,t.x,t.y);else{var a=e.endAngle;e.startAngle=a,e.endAngle=be(e.center.x,e.center.y,t.x,t.y)}else if(n)e.endAngle=be(e.center.x,e.center.y,t.x,t.y);else{var i=e.startAngle;e.startAngle=be(e.center.x,e.center.y,t.x,t.y),e.endAngle=i}return e},X=e.numVerts();if(t<0){var q=h?e.getPointAtDist(Math.abs(t)).val:e.getPointAtDist(g-Math.abs(t)).val,G=_(e,q,.1);if(!G)return;var J=G.start,Z=G.end,Q=G.startIndex,$=G.endIndex,ee=e.getBulgeAt(Q),te=0===ee?function(e,t,r,n){var a=n.startIndex,i=n.endIndex,s=n.numVerts,u=U(e);if(e.setPointAt(r?a:i,t),r)for(var c=0;c<a;c++)e.removeVertexAt(0);else for(var o=i+1;o<s;o++)e.removeVertexAt(i+1);return function(){return F(e,u)}}(e,q,h,{startIndex:Q,endIndex:$,numVerts:X}):function(e,t,r,a){var i=a.start,s=a.end,u=a.startIndex,c=a.endIndex,o=a.numVerts,l=a.bulge,d=U(e),f=H(i,s,l);Y(f,t,r,l>0);var p=f.getGripPoints().at(2),x=n.w.calcBulge(r?t:i,p,r?s:t).val;if(e.setPointAt(r?u:c,t),e.setBulgeAt(u,x),r)for(var b=0;b<u;b++)e.removeVertexAt(0);else for(var g=c+1;g<o;g++)e.removeVertexAt(c+1);return function(){return F(e,d)}}(e,q,h,{start:J,end:Z,startIndex:Q,endIndex:$,numVerts:X,bulge:ee});return{ent:e,fallback:te}}w=h?e.getPointAt(1).val:w,k=h?k:e.getPointAt(X-2).val;var re=h?e.getBulgeAt(0):e.getBulgeAt(X-2),ne=0===re?(s=e,u=t,l=(o={startPoint:k,endPoint:w,numVerts:X}).startPoint,d=o.endPoint,f=o.numVerts,p=(c=h)?l.clone().addvec(l.sub(d).normalize().mult(u)):d.clone().addvec(d.sub(l).normalize().mult(u)),x=c?0:f-1,b=c?l:d,s.setPointAt(x,p),function(){return s.setPointAt(x,b)}):function(e,t,r,a){var i=a.startPoint,s=a.endPoint,u=a.numVerts,c=a.bulge,o=H(i,s,c),l=o.clone();l.startAngle=r?o.startAngle:o.endAngle,l.endAngle=l.startAngle-1e-7;var d=l.getLength().val,f=c>0,p=t%d,x=l.getPointAtDist(r?f?d-p:p:f?p:d-p).val;Y(o,x,r,f);var b=o.getGripPoints().at(2),g=n.w.calcBulge(r?x:i,b,r?s:x).val,v=r?0:u-1,k=r?0:u-2,w=r?i:s,h=c;return e.setPointAt(v,x),e.setBulgeAt(k,g),function(){e.setPointAt(v,w),e.setBulgeAt(k,h)}}(e,t,h,{startPoint:k,endPoint:w,numVerts:X,bulge:re});return{ent:e,fallback:ne}}};(0,n.d)("Mx_lengthen",(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=new n.l,(a=new n.v).AddMcDbEntityTypes("LWPOLYLINE,LINE,ARC,ELLIPSE"),r.setFilter(a),i=function(){var e=(0,n._)(n.a.mark(function e(i){var u,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=n.a.mark(function e(){var u,c,o,l,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1551")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),r.setUserDraw(function(e,t){var r=n.w.findEntAtPoint(e.x,e.y,e.z,void 0,a);u&&u.highlight(!1),u=r.getMcDbCurve();var s=r.clone();s&&s instanceof n.k&&me(s,"number"==typeof i?i:i(s,e),e)&&(u&&u.highlight(!0),t.setColor(Number(s.trueColor.getColorValue(s.layerId))),t.drawMcDbEntity(s))}),e.next=1,r.go();case 1:if(c=e.sent,u&&u.highlight(!1),r.getStatus()!==s.j.kCancel&&r.getStatus()!==s.j.kNone){e.next=2;break}return e.abrupt("return",{v:!0});case 2:if(!r.isKeyWordPicked("U")){e.next=3;break}return(o=t.pop())?null==o||o.fallback():s.M.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 3:if(null!==c){e.next=4;break}return e.abrupt("return",{v:!0});case 4:if(null!==(l=c.getMcDbCurve())){e.next=5;break}return e.abrupt("return",{v:!0});case 5:return(d=me(l,"number"==typeof i?i:i(l,r.pickPoint()),r.pickPoint()))&&t.push(d),e.abrupt("return",0);case 6:case"end":return e.stop()}},e)});case 1:return e.delegateYield(u(),"t0",2);case 2:if(0!==(c=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(!c){e.next=4;break}return e.abrupt("return",c.v);case 4:e.next=1;break;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=(0,n._)(n.a.mark(function e(a){var i,u,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=function(e){if(e instanceof n.r){var t=e.clone();return t.startAngle=0,t.endAngle=a,t.getLength().val}if(e instanceof n.K){var r=e.clone(),i=r.getLength().val;return r.endAngle+=a,r.getLength().val-i}return 0},u=n.a.mark(function e(){var a,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1551")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),(u=new n.v).AddMcDbEntityTypes("LWPOLYLINE,ARC,ELLIPSE"),r.setUserDraw(function(e,t){var r=n.w.findEntAtPoint(e.x,e.y,e.z,void 0,u);a&&a.highlight(!1),a=r.getMcDbCurve();var s=r.clone();if(s&&s instanceof n.k){var c=i(s);me(s,c,e)&&(a&&a.highlight(!0),t.setColor(Number(s.trueColor.getColorValue(s.layerId))),t.drawMcDbEntity(s))}}),e.next=1,r.go();case 1:if(c=e.sent,a&&a.highlight(!1),r.getStatus()!==s.j.kCancel&&r.getStatus()!==s.j.kNone){e.next=2;break}return e.abrupt("return",{v:!0});case 2:if(!r.isKeyWordPicked("U")){e.next=3;break}return(o=t.pop())?null==o||o.fallback():s.M.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 3:if(null!==c){e.next=4;break}return e.abrupt("return",{v:!0});case 4:if(null!==(l=c.getMcDbCurve())){e.next=5;break}return e.abrupt("return",{v:!0});case 5:return d=i(l),(f=me(l,d,r.pickPoint()))&&t.push(f),e.abrupt("return",0);case 6:case"end":return e.stop()}},e)});case 1:return e.delegateYield(u(),"t0",2);case 2:if(0!==(c=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(!c){e.next=4;break}return e.abrupt("return",c.v);case 4:e.next=1;break;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c=n.a.mark(function e(){var a,c,o,l,d,f,p,x,b,g,v,k,w,h,y;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage("".concat((0,n.t)("1554"),"<").concat(he[ye],"(DE)>")),r.setKeyWords("[".concat((0,n.t)("1547"),"(DE)/").concat((0,n.t)("1548"),"(P)/").concat((0,n.t)("1549"),"(T)/").concat((0,n.t)("1550"),"(DY)]")),e.next=1,r.go();case 1:if(a=e.sent,r.getStatus()!==s.j.kCancel){e.next=2;break}return e.abrupt("return",0);case 2:if(r.getStatus()!==s.j.kNone){e.next=3;break}return setTimeout(function(){ye&&s.M.setCommandLineInputData(ye,13)}),e.abrupt("return",1);case 3:if(!r.isKeyWordPicked("DE")){e.next=14;break}return ye="DE",(c=new n.z).setMessage("".concat((0,n.t)("1555"),"<").concat(ke.toFixed(4),">")),c.setKeyWords("[".concat((0,n.t)("169"),"(A)]")),e.next=4,c.go();case 4:if(o=e.sent,c.getStatus()!==s.j.kCancel){e.next=5;break}return e.abrupt("return",0);case 5:if(c.getStatus()===s.j.kNone&&"number"==typeof ke&&(o=ke),!c.isKeyWordPicked("A")){e.next=10;break}return(l=new n.o).setMessage((0,n.t)("1557")),e.next=6,l.go();case 6:if(d=e.sent,l.getStatus()===s.j.kNone&&(d=0),c.getStatus()!==s.j.kCancel){e.next=7;break}return e.abrupt("return",0);case 7:if("number"==typeof d){e.next=8;break}return e.abrupt("return",0);case 8:return e.next=9,u(d);case 9:if(!e.sent){e.next=10;break}return e.abrupt("return",0);case 10:if("number"!=typeof o){e.next=13;break}return ke=o,e.next=11,i(o);case 11:if(!e.sent){e.next=12;break}return e.abrupt("return",0);case 12:e.next=14;break;case 13:return e.abrupt("return",0);case 14:if(!r.isKeyWordPicked("P")){e.next=23;break}ye="P";case 15:return(f=new n.a0).setMessage("".concat((0,n.t)("1558"),"<").concat(we.toFixed(4),">")),e.next=16,f.go();case 16:if(p=e.sent,f.getStatus()!==s.j.kCancel){e.next=17;break}return e.abrupt("return",2);case 17:if(f.getStatus()===s.j.kNone&&"number"==typeof p&&(we=p),"number"!=typeof p){e.next=21;break}if(!(p<=0)){e.next=18;break}return s.M.acutPrintf("\n"+(0,n.t)("1559")),e.abrupt("continue",15);case 18:return we=p,e.next=19,i(function(e){var t=e.getLength().val;return t/100*we-t});case 19:if(!e.sent){e.next=20;break}return e.abrupt("return",2);case 20:e.next=22;break;case 21:return e.abrupt("continue",23);case 22:e.next=15;break;case 23:if(!r.isKeyWordPicked("T")){e.next=33;break}return ye="T",(x=new n.z).setMessage((0,n.t)("1560")+"<"+(0).toFixed(4)+">"),x.setKeyWords("[".concat((0,n.t)("169"),"(A)]")),e.next=24,x.go();case 24:if(b=e.sent,x.getStatus()===s.j.kNone&&(b=0),x.getStatus()!==s.j.kCancel){e.next=25;break}return e.abrupt("return",0);case 25:if(!x.isKeyWordPicked("A")){e.next=30;break}return(g=new n.o).setMessage((0,n.t)("1561")+"<"+(0).toFixed(4)+">"),e.next=26,g.go();case 26:if(v=e.sent,x.getStatus()!==s.j.kCancel){e.next=27;break}return e.abrupt("return",0);case 27:if(x.getStatus()===s.j.kNone&&(v=0),"number"==typeof v){e.next=28;break}return e.abrupt("return",0);case 28:return e.next=29,i(function(e){return 0});case 29:if(!e.sent){e.next=30;break}return e.abrupt("return",0);case 30:if("number"==typeof b){e.next=31;break}return e.abrupt("return",0);case 31:return e.next=32,i(function(e){return b-e.getLength().val});case 32:if(!e.sent){e.next=33;break}return e.abrupt("return",0);case 33:if(!r.isKeyWordPicked("DY")){e.next=38;break}ye="DY",k=function(e,t,r,a,i,s){if(!(e instanceof n.f)){if(e instanceof n.m){var u,c=ge(e.startPoint,e.endPoint,t,!0),o=ve(e.startPoint,e.endPoint,c);if("object"===(0,n.a1)(o)&&o.isStart!==r){var l=e.startPoint,d=e.endPoint;return o.isStart?(e.endPoint=l,e.startPoint=c):(e.startPoint=d,e.endPoint=c),{ent:e,fallback:function(){e.startPoint=l,e.endPoint=d}}}return u=r?c.distanceTo(e.endPoint)-a:c.distanceTo(e.startPoint)-a,me(e,u,i)}if(e instanceof n.r){var f,p=e.startAngle,x=e.endAngle,b=e.getClosestPointTo(t,!0).val,g=e.getGripPoints().at(2),v=n.w.calcBulge(e.getGripPoints().at(0),g,e.getGripPoints().at(1)).val>0,k=e.center;if(v)e.endAngle=be(k.x,k.y,b.x,b.y),f=function(){e.endAngle=x};else{var w=e.startAngle;e.startAngle=be(k.x,k.y,b.x,b.y),e.endAngle=w,f=function(){e.startAngle=p,e.endAngle=x}}return{ent:e,fallback:f}}if(e instanceof n.K){var h=e.endAngle,y=e.center,m=(Math.atan2(t.y-y.y,t.x-y.x)-Math.atan2(e.majorAxis.y,e.majorAxis.x)+2*Math.PI)%(2*Math.PI);return m<e.startAngle&&(m+=2*Math.PI),e.endAngle=m,{ent:e,fallback:function(){e.endAngle=h}}}}},w=n.a.mark(function e(){var a,i,u,c,o,l,d,f,p,x,b;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setMessage((0,n.t)("1551")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),e.next=1,r.go();case 1:if(i=e.sent,!r.isKeyWordPicked("U")){e.next=2;break}return(u=t.pop())?null==u||u.fallback():s.M.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 2:if(r.getStatus()!==s.j.kCancel&&r.getStatus()!==s.j.kNone){e.next=3;break}return e.abrupt("return",{v:{v:!0}});case 3:if(i){e.next=4;break}return e.abrupt("return",0);case 4:if(a=i.getMcDbCurve()){e.next=5;break}return e.abrupt("return",0);case 5:return c=r.pickPoint(),o=a.getLength().val,l=a.getDistAtPoint(c).val,d=l<o/2,(f=new n.j).setMessage((0,n.t)("1562")),r.setKeyWords("[".concat((0,n.t)("1552"),"(U)]")),f.setUserDraw(function(e,t){if(a){a.highlight(!1);var r=i.clone();r instanceof n.k&&k(r,e,d,o,c)&&(a.highlight(!0),t.setColor(Number(a.trueColor.getColorValue(a.layerId))),t.drawMcDbEntity(r))}}),e.next=6,f.go();case 6:if(p=e.sent,a&&a.highlight(!1),f.getStatus()!==s.j.kCancel&&r.getStatus()!==s.j.kNone){e.next=7;break}return e.abrupt("return",{v:{v:!0}});case 7:if(!f.isKeyWordPicked("U")){e.next=8;break}return(x=t.pop())?null==x||x.fallback():s.M.acutPrintf("\n"+(0,n.t)("1553")),e.abrupt("return",0);case 8:if(null!==p){e.next=9;break}return e.abrupt("return",{v:{v:!0}});case 9:return a&&(b=k(a,p,d,o,c))&&t.push(b),e.abrupt("return",0);case 10:case"end":return e.stop()}},e)});case 34:return e.delegateYield(w(),"t0",35);case 35:if(0!==(h=e.t0)){e.next=36;break}return e.abrupt("continue",34);case 36:if(!h){e.next=37;break}return e.abrupt("return",h.v);case 37:e.next=34;break;case 38:if(a){e.next=39;break}return e.abrupt("return",1);case 39:if(y=a.getMcDbCurve()){e.next=40;break}return e.abrupt("return",1);case 40:return s.M.acutPrintf("\n"+(0,n.t)("1563")+": "+y.getLength().val.toFixed(4)),e.abrupt("return",1);case 41:case"end":return e.stop()}},e)});case 1:return e.delegateYield(c(),"t0",2);case 2:if(0!==(o=e.t0)){e.next=3;break}return e.abrupt("continue",7);case 3:if(1!==o){e.next=4;break}return e.abrupt("continue",1);case 4:if(2!==o){e.next=5;break}return e.abrupt("continue",7);case 5:if(!o){e.next=6;break}return e.abrupt("return",o.v);case 6:e.next=1;break;case 7:case"end":return e.stop()}},e)}))),(0,n.d)("deselect",function(){var e=n.M.getCurrentMxCAD();e.mxdraw.clearMxCurrentSelect(),e.updateDisplay()});var Me=function(){var e=(0,n._)(n.a.mark(function e(t){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,o.u)(),(a=r.dialog).showDialog(!0,t),e.prev=1,e.next=2,function(){return new Promise(function(e,t){a.onConfirm(e),a.onCancel(t)})}();case 2:return e.abrupt("return",e.sent);case 3:return e.prev=3,e.catch(1),e.abrupt("return",[""]);case 4:case"end":return e.stop()}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=(0,n._)(n.a.mark(function e(t){var r,a,i,s,u,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择需要".concat(t?"锁定":"解锁","图层的对象"));case 1:r=e.sent,a=new Set,i=(0,n.a2)(),s=i.setValue,u=(0,n.a3)(i),c=u.list,r.forEach(function(e){if(e.type===n.a4.kMxCAD){var t=e.getMcDbEntity();if(!t)return;var r=c.value.findIndex(function(e){return e.name===t.layer});r>=0&&a.add(r)}}),s("lock",t,Array.from(a),!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();(0,n.d)("_OpenAllLayer",function(){var e=(0,n.a2)(),t=e.setLayerList,r=e.stringifyJSON;(0,c.d)(!0),t(r())}),(0,n.d)("_SelOffLayer",(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择需要关闭图层的实体");case 1:t=e.sent,r=new Set,a=(0,n.a2)(),i=a.setValue,s=a.setLayerList,u=a.stringifyJSON,c=(0,n.a3)(a),o=c.list,t.forEach(function(e){if(e.type===n.a4.kMxCAD){var t=e.getMcDbEntity();if(!t)return;var a=o.value.findIndex(function(e){return e.name===t.layer});a>=0&&r.add(a)}}),i("visible",!1,Array.from(r)),s(u());case 2:case"end":return e.stop()}},e)}))),(0,n.d)("_layer_recovery",function(){(0,(0,n.a2)().recoveryLayerStateHistory)()}),(0,n.d)("_layer_putCurrent",(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.l).setMessage("选择将使其图层将成为当前图层的对象"),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:if(r.isValid()){e.next=3;break}return e.abrupt("return");case 3:if(a=r.getMcDbEntity()){e.next=4;break}return e.abrupt("return");case 4:if(i=(0,n.a2)(),s=i.putCurrent,u=(0,n.a3)(i),c=u.list,!((o=c.value.findIndex(function(e){var t=e.name;return a.layer===t}))<0)){e.next=5;break}return e.abrupt("return");case 5:s(o);case 6:case"end":return e.stop()}},e)}))),(0,n.d)("_layer_matching",(0,n._)(n.a.mark(function e(){var t,r,a,i,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择需要修改图层的对象");case 1:return t=e.sent,(r=new n.l).setMessage("选择匹配图层的对象"),r.setKeyWords("[名称(N)]"),e.next=2,r.go();case 2:if(a=e.sent,i="",!r.isKeyWordPicked("N")){e.next=7;break}return(0,o.u)().dialog.showDialog(!0),e.prev=3,e.next=4,Me();case 4:i=e.sent[0],e.next=6;break;case 5:return e.prev=5,e.catch(3),e.abrupt("return");case 6:e.next=11;break;case 7:if(a){e.next=8;break}return e.abrupt("return");case 8:if(a.isValid()){e.next=9;break}return e.abrupt("return");case 9:if(s=a.getMcDbEntity()){e.next=10;break}return e.abrupt("return");case 10:i=s.layer;case 11:if(""!==i){e.next=12;break}return e.abrupt("return");case 12:t.forEach(function(e){var t=e.getMcDbEntity();t&&(t.layer=i)}),n.M.getCurrentMxCAD().updateDisplay();case 13:case"end":return e.stop()}},e,null,[[3,5]])}))),(0,n.d)("_layer_setEntToCurrentLayer",(0,n._)(n.a.mark(function e(){var t,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择需要修改图层的对象");case 1:t=e.sent,r=(0,n.a5)().getCurrentlyLayerName(),t.forEach(function(e){var t=e.getMcDbEntity();t&&(t.layer=r)}),n.M.getCurrentMxCAD().updateDisplay();case 2:case"end":return e.stop()}},e)}))),(0,n.d)("_layer_CopyObjectsToNewLayer",(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择要复制的对象");case 1:return t=e.sent,(r=new n.l).setMessage("选择目标图层上的对象"),r.setKeyWords("[名称(N)]"),e.next=2,r.go();case 2:if(a=e.sent,i="",!r.isKeyWordPicked("N")){e.next=4;break}return e.next=3,Me();case 3:i=e.sent[0],e.next=8;break;case 4:if(a){e.next=5;break}return e.abrupt("return");case 5:if(a.isValid()){e.next=6;break}return e.abrupt("return");case 6:if(s=a.getMcDbEntity()){e.next=7;break}return e.abrupt("return");case 7:i=s.layer;case 8:return(u=new n.j).setMessage("指定基点"),e.next=9,u.go();case 9:if(c=e.sent){e.next=10;break}return e.abrupt("return");case 10:return u.setMessage("指定位移的第二个点"),u.setUserDraw(function(e,r){t.forEach(function(t){if(c){var n=t.clone();n&&(n.layer=i,n.move(c,e),r.drawMcDbEntity(n))}})}),e.next=11,u.go();case 11:o=e.sent,t.forEach(function(e){if(c&&o){var t=e.clone();if(t){t.move(c,o);var r=n.M.getCurrentMxCAD().drawEntity(t).getMcDbEntity();r&&(r.layer=i)}}});case 12:case"end":return e.stop()}},e)}))),(0,n.d)("_layer_freeze",(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择需要冻结图层的对象");case 1:t=e.sent,r=new Set,a=(0,n.a2)(),i=a.setValue,s=(0,n.a3)(a),u=s.list,t.forEach(function(e){if(e.type===n.a4.kMxCAD){var t=e.getMcDbEntity();if(!t)return;var a=u.value.findIndex(function(e){return e.name===t.layer});a>=0&&r.add(a)}}),i("freeze",!0,Array.from(r),!0);case 2:case"end":return e.stop()}},e)}))),(0,n.d)("_layer_thawedAll",function(){var e=(0,n.a2)();(0,e.setValue)("freeze",!1,(0,n.a3)(e).list.value.map(function(e,t){return t}),!0)}),(0,n.d)("_layer_lock",function(){return De(!0)}),(0,n.d)("_layer_unlock",function(){return De(!1)}),(0,n.d)("_layer_combined",(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择要合并的图层上的对象",null,function(){var e=(0,n._)(n.a.mark(function e(r,a){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a,a.setKeyWords("[命名(N)]");case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}());case 1:if(r=e.sent,a=[],!t||!t.isKeyWordPicked("N")){e.next=3;break}return e.next=2,Me({isMultiple:!0});case 2:a=e.sent,e.next=4;break;case 3:r&&(i=new Set,r.forEach(function(e){var t=e.getMcDbEntity();t&&i.add(t.layer)}),a=Array.from(i));case 4:if(!(a.length>0&&""===a[0])){e.next=5;break}return e.abrupt("return");case 5:return s.M.acutPrintf("\n选定的图层:"+a.join(",")),(u=new n.l).setMessage("选择目标图层上的对象"),u.setKeyWords("名称(N)"),e.next=6,u.go();case 6:if(c=e.sent,o="",!u.isKeyWordPicked("N")){e.next=8;break}return e.next=7,Me();case 7:o=e.sent[0],e.next=12;break;case 8:if(c){e.next=9;break}return e.abrupt("return");case 9:if(c.isValid()){e.next=10;break}return e.abrupt("return");case 10:if(l=c.getMcDbEntity()){e.next=11;break}return e.abrupt("return");case 11:o=l.layer;case 12:return s.M.acutPrintf("\n将要把"+a.length+'个图层合并到图层"'+o+'"中。'),(d=new n.x).setMessage("是否继续?"),d.setKeyWords("[是(Y)/否(N)]"),e.next=13,d.go();case 13:"Y"===(null==(f=e.sent)?void 0:f.toLocaleUpperCase())&&((p=new n.J).allSelect(),p.forEach(function(e){var t=e.getMcDbEntity();t&&a.includes(t.layer)&&(t.layer=o)}),x=(0,n.a2)(),b=x.remove,g=x.setLayerList,v=x.stringifyJSON,k=(0,n.a3)(x),w=k.list,h=a.map(function(e){return w.value.findIndex(function(t){return t.name===e})}),b(h),g(v()));case 14:case"end":return e.stop()}},e)}))),(0,n.d)("_layer_remove",(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,n.w.userSelect("选择要合并的图层上的对象",null,function(){var e=(0,n._)(n.a.mark(function e(r,a){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a,a.setKeyWords("[命名(N)]");case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}());case 1:if(r=e.sent,a=[],!t||!t.isKeyWordPicked("N")){e.next=3;break}return e.next=2,Me({isMultiple:!0});case 2:a=e.sent,e.next=4;break;case 3:r&&(i=new Set,r.forEach(function(e){var t=e.getMcDbEntity();t&&i.add(t.layer)}),a=Array.from(i));case 4:if(!(a.length>0&&""===a[0])){e.next=5;break}return e.abrupt("return");case 5:return(u=new n.x).setMessage("删除图层上的对象"),u.setKeyWords("[删除(D)/不删除对象改为当前图层(C)]"),e.next=6,u.go();case 6:if(c=e.sent,u.getStatus()!==s.j.kCancel){e.next=7;break}return e.abrupt("return");case 7:o="D"===(null==c?void 0:c.toLocaleUpperCase()),l=(0,n.a5)().getCurrentlyLayerName(),d=(0,n.a2)(),f=d.remove,p=d.setLayerList,x=d.stringifyJSON,b=(0,n.a3)(d),g=b.list,v=a.map(function(e){return g.value.findIndex(function(t){return t.name===e})}),k=f(v),p(x()),k?((w=new n.J).allSelect(),h=k.map(function(e){return e.name}),w.forEach(function(e){var t=e.getMcDbEntity();t&&h.includes(t.layer)&&(o?t.erase():t.layer=l)}),s.M.acutPrintf("\n已删除的图层:"+h.join(",")+'"\n命令')):s.M.acutPrintf("删除图层失败\n命令");case 8:case"end":return e.stop()}},e)})));var Pe=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r=n.a.mark(function e(){var r,a,i,u,c,o,l,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=n.a7.instance)||void 0===r||!r.isDialogOpen){e.next=1;break}return e.abrupt("return",{v:void 0});case 1:return(a=new n.j).clearLastInputPoint(),a.setMessage((0,n.t)("2105")+":"),a.setCursorType(s.h.kCross),e.next=2,a.go();case 2:if(i=e.sent,a.getStatus()!==s.j.kCancel){e.next=3;break}return e.abrupt("return",{v:void 0});case 3:if(i){e.next=4;break}return e.abrupt("return",0);case 4:if(0!==t){e.next=8;break}return(u=new n.z).setMessage((0,n.t)("2106")+":"),e.next=5,u.go();case 5:if(c=e.sent,u.getStatus()!==s.j.kCancel){e.next=6;break}return e.abrupt("return",{v:void 0});case 6:if(null!==c){e.next=7;break}return e.abrupt("return",{v:void 0});case 7:t=c;case 8:return(o=new n.a6).textString="",o.position=i,o.alignmentPoint=o.position,o.height=t,l=n.M.getCurrentMxCAD().drawEntity(o),d=l.getMcDbEntity(),e.prev=9,e.next=10,new Promise(function(e){d instanceof n.a6&&new n.a7(d,i).onClose(function(t){t||o.erase(),e()})});case 10:return e.abrupt("return",0);case 11:return e.prev=11,f=e.catch(9),o.erase(),console.error(f),e.abrupt("return",1);case 12:case"end":return e.stop()}},e,null,[[9,11]])});case 1:return e.delegateYield(r(),"t0",2);case 2:if(0!==(a=e.t0)){e.next=3;break}return e.abrupt("continue",1);case 3:if(1!==a){e.next=4;break}return e.abrupt("continue",6);case 4:if(!a){e.next=5;break}return e.abrupt("return",a.v);case 5:e.next=1;break;case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=n.a7.instance)||void 0===t||!t.isDialogOpen){e.next=1;break}return e.abrupt("return");case 1:r=n.a.mark(function e(){var t,r,a,i,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.v).AddMcDbEntityTypes("TEXT,MTEXT,CUSTOMENTITY"),(r=new n.l).setFilter(t),r.setMessage((0,n.t)("2107")),e.next=1,r.go();case 1:if(a=e.sent,r.getStatus()!==s.j.kCancel){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(a&&a.isValid()){e.next=3;break}return e.abrupt("return",0);case 3:if(!((i=a.getMcDbEntity())instanceof n.a6)){e.next=7;break}return e.prev=4,e.next=5,new Promise(function(e){new n.a7(i,r.pickPoint()).onClose(function(t){e()})});case 5:return e.abrupt("return",0);case 6:return e.prev=6,u=e.catch(4),console.error(u),e.abrupt("return",1);case 7:case"end":return e.stop()}},e,null,[[4,6]])});case 2:return e.delegateYield(r(),"t0",3);case 3:if(0!==(a=e.t0)){e.next=4;break}return e.abrupt("continue",2);case 4:if(1!==a){e.next=5;break}return e.abrupt("continue",7);case 5:if(!a){e.next=6;break}return e.abrupt("return",a.v);case 6:e.next=2;break;case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();(0,n.d)("Mx_EditText",Ae),(0,n.d)("_DrawText",Pe);var Ce=function(){var e=(0,n._)(n.a.mark(function e(){var t,r,a,i,u,c,o,l,d,f,p,x,b,g,v,k,w,h,y,m,M;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.M.getCurrentMxCAD(),(r=new n.a9).setStyleName(n.a8.currentName),a=r.getJustification(),i=r.getScale(),r.setJustification(a),r.setScale(i),u=[],c=function(e,t){if(0!==u.length){var r=new n.a9;r.setJustification(a),r.setScale(i),r.setStyleName(n.a8.currentName),u.forEach(function(e){r.addVertex(e)}),r.addVertex(e),t.drawMcDbEntity(r)}},o=function(){},e.prev=1;case 2:return(l=new n.j).clearLastInputPoint(),l.setMessage((0,n.t)("1684")),l.setKeyWords("[".concat((0,n.t)("1685"),"(J)/").concat((0,n.t)("1686"),"(M)/").concat((0,n.t)("1624"),"(S)]")),e.next=3,l.go();case 3:if(d=e.sent,l.getStatus()!==s.j.kCancel){e.next=4;break}return o(),e.abrupt("return",!1);case 4:if(l.getDetailedResult()!==s.D.kNewCommadIn){e.next=5;break}return o(),e.abrupt("return",!1);case 5:if(!l.isKeyWordPicked("J")){e.next=10;break}return(f=new n.j).setMessage((0,n.t)("1687")+"<"+(0,n.t)("1688")+">"),f.setKeyWords("[".concat((0,n.t)("1689"),"(T)/").concat((0,n.t)("1690"),"(M)/").concat((0,n.t)("1691"),"(B)/").concat((0,n.t)("1688"),"(A)]")),e.next=6,f.go();case 6:if(console.log(f.getStatus()),f.getStatus()!==s.j.kNone){e.next=7;break}a=1,e.next=8;break;case 7:if(f.getStatus()!==s.j.kCancel){e.next=8;break}return e.abrupt("continue",2);case 8:if(f.getDetailedResult()!==s.D.kNewCommadIn){e.next=9;break}return o(),e.abrupt("return",!1);case 9:return f.isKeyWordPicked("T")?a=0:f.isKeyWordPicked("M")?a=1:f.isKeyWordPicked("B")?a=2:f.isKeyWordPicked("A")&&(a=-1),r.setJustification(a),e.abrupt("continue",2);case 10:if(!l.isKeyWordPicked("M")){e.next=14;break}return(p=new n.a0).setMessage((0,n.t)("1692")+"<"+i.toString()+">"),e.next=11,p.go();case 11:if(x=e.sent,p.getStatus()!==s.j.kCancel){e.next=12;break}return e.abrupt("continue",2);case 12:if(p.getDetailedResult()!==s.D.kNewCommadIn){e.next=13;break}return o(),e.abrupt("return",!1);case 13:return p.getStatus()===s.j.kOk&&"number"==typeof x&&(b=x,!isNaN(b)&&b>0&&(i=b,r.setScale(i))),e.abrupt("continue",2);case 14:if(!l.isKeyWordPicked("S")){e.next=16;break}return(g=new n.p).setMessage((0,n.t)("1693")),e.next=15,g.go();case 15:return(v=e.sent)&&n.a8.keys().includes(v)&&r.setStyleName(v),e.abrupt("continue",2);case 16:if(!d){e.next=17;break}return u.push(d.clone()),r.addVertex(d),e.abrupt("continue",18);case 17:e.next=2;break;case 18:k=!0;case 19:return w=k?(0,n.t)("1694"):(0,n.t)("1636"),(h=new n.j).setMessage(w),k||h.setKeyWords(u.length>2?"[".concat((0,n.t)("1728"),"(C)/").concat((0,n.t)("1654"),"(U)]"):"[".concat((0,n.t)("1654"),"(U)]")),y=u[u.length-1],h.setBasePt(y),h.setUserDraw(function(e,t){return c(e,t),1}),e.next=20,h.go();case 20:if(m=e.sent,h.getDetailedResult()!==s.D.kMouseRightIn){e.next=21;break}return e.abrupt("continue",28);case 21:if(h.getStatus()!==s.j.kCancel){e.next=23;break}if(!(u.length>1)){e.next=22;break}return e.abrupt("continue",28);case 22:return o(),e.abrupt("return",!1);case 23:if(h.getDetailedResult()!==s.D.kNewCommadIn){e.next=24;break}return o(),e.abrupt("return",!1);case 24:if(!h.isKeyWordPicked("U")){e.next=25;break}return u.length>1&&(u.pop(),r.removeVertexAt(r.getVertexCount()-1),k=1===u.length),e.abrupt("continue",19);case 25:if(!h.isKeyWordPicked("C")){e.next=27;break}if(!(u.length>=3)){e.next=26;break}return r.setIsClosed(!0),t.drawEntity(r),e.abrupt("return",!0);case 26:return s.M.acutPrintf((0,n.t)("3714")),e.abrupt("continue",19);case 27:m&&(u.push(m.clone()),r.addVertex(m),k=!1),e.next=19;break;case 28:if(!(u.length>=2)){e.next=29;break}return t.drawEntity(r),e.abrupt("return",!0);case 29:return e.abrupt("return",!1);case 30:return e.prev=30,M=e.catch(1),console.error("绘制多线出错:",M),e.abrupt("return",!1);case 31:return e.prev=31,o(),e.finish(31);case 32:case"end":return e.stop()}},e,null,[[1,30,31,32]])}));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log((0,n.t)("1695")),e.next=1,Ce();case 1:return e.abrupt("return",!0);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function Ie(e,t){return Le.apply(this,arguments)}function Le(){return Le=(0,n._)(n.a.mark(function e(t,r){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,n._)(n.a.mark(function e(a){var i,s,u,c,o,l,d,f,p,b,g,v,k,w,h,y,m,M,D,P;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=t.hash,s=t.type,u=t.file,c=(0,n.Q)(),o=c.hideLoading,l=c.showLoading,e.next=2;break;case 1:return e.abrupt("return",a(!0));case 2:if(s!==(0,n.g)()){e.next=3;break}u.source.source.size/1048576>1&&l(),d=URL.createObjectURL(u.source.source),setTimeout(function(){U(d),setTimeout(function(){URL.revokeObjectURL(d)},5e3)}),e.next=7;break;case 3:if(f=(0,n.ae)()||{},p=f.mxfilepath,b=void 0===p?"":p,g=(0,n.ao)(),v=g+b+i+"."+s+(0,n.g)(!0),k=g+b+i+"/___mx___tz___.dwg.mxweb",w=!1,t.isUseServerExistingFile){e.next=6;break}return e.next=4,x(v,i);case 4:if((h=e.sent).ok){e.next=5;break}return o(),e.abrupt("return",a(!1));case 5:h.tz&&(w=!0);case 6:(0,n.aj)((0,n.t)("1541")+"..."),(0,n.ak)(!0),y=(new Date).getTime(),m=0,r||(m=n.al.EMSCRIPTEN_FETCH_LOAD_TO_MEMORY|n.al.EMSCRIPTEN_FETCH_PERSIST_FILE|n.al.EMSCRIPTEN_FETCH_REPLACE),M=n.M.App.getCurrentMxCAD(),D=!1,n.am.emit("startOpenFile"),P=M.openWebFile(v,function(e){if(o(),D=!0,(0,n.an)(),0===e){if(a(!0),(new Date).getTime()-y>5e3&&(0,n.F)().success((0,n.t)("1542")+"..."),w){var t=g+"/mxcad/files/tz";n.ap.post(t,{fileHash:i}).then(function(e){e&&e.data&&0==e.data.code&&M.getImp().loadTz(k)})}}else a(!1),(0,n.F)().error((0,n.t)("1543"))},void 0,void 0,m,!w),(0,n.P)(v).then(function(e){e/1048576>1&&P&&!D&&l()}),a(!!P),a(!1);case 7:(0,n.ai)(u.name);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)})),Le.apply(this,arguments)}(0,n.d)("MLINE",Ee),(0,n.ab)(function(){(new n.ac).rxInit()}),(0,n.aa)();var _e=(0,n.i)();(0,n.d)("OpenDwg",(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=1;break;case 1:return _e=(0,n.i)(),e.next=2,(0,n.ad)(!1,"OpenDwgImp");case 2:_e&&(0,n.c)("MxFullScreen");case 3:case"end":return e.stop()}},e)}))),(0,n.d)("OpenDwg_DoNotUseCache",(0,n._)(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=1;break;case 1:return _e=(0,n.i)(),e.next=2,(0,n.ad)(!0,"OpenDwgImp_DoNotUseCache");case 2:_e&&(0,n.c)("MxFullScreen");case 3:case"end":return e.stop()}},e)}))),(0,n.d)("OpenDwgImp_DoNotUseCache",function(){var e=(0,n._)(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Ie(t,!1);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),(0,n.d)("OpenDwgImp",function(){var e=(0,n._)(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Ie(t,!0);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),(0,n.d)("Mx_SaveAs",f),(0,n.d)("Mx_QSave",p),(0,n.d)("Mx_Export_DWG",(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 1:e.next=3;break;case 2:_e=(0,n.i)(),t=function(){_e&&(0,n.c)("MxFullScreen")},r=(0,n.ae)()||{},a=r.baseUrl,i=void 0===a?"":a,s=r.saveDwgUrl,u=void 0===s?"":s,c=r.mxfilepath,o=void 0===c?"":c,"http://localhost"==i.substring(0,16)&&(i=(0,n.af)()+i.substring(16)),"http://localhost"==u.substring(0,16)&&(u=(0,n.af)()+u.substring(16)),(l=n.M.getCurrentMxCAD()).saveFileToUrl(u,function(e,r){try{var a=JSON.parse(r);if("ok"==a.ret){var s=i+o+a.file;fetch(s).then(function(){var e=(0,n._)(n.a.mark(function e(r){var a,i,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e){var t=e.toLowerCase(),r=t.lastIndexOf(".");if(-1!==r){var a=t.substring(r);if(a===(0,n.g)(!0))return e.substring(0,r)+".dwg";if(".dwg"===a||".dxf"===a)return e}return e+".dwg"},e.next=1,r.blob();case 1:return a=e.sent,i=l.getCurrentOriginaFileName(),i=s(i),e.next=2,n.b.saveAsFileDialog({blob:a,filename:i,types:[{description:"dwg"+(0,n.t)("1544"),accept:{"application/octet-stream":[".dwg"]}}]});case 2:t();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}else console.log(r)}catch(e){console.log("Mx: sserverResult error")}});case 3:case"end":return e.stop()}},e)}))),(0,n.d)("Mx_debug",function(){}),(0,n.d)("Mx_clear_buf",function(){}),(0,n.d)("Mx_Array",a.M),(0,n.d)("Mx_NewFile",function(){n.M.getCurrentMxCAD().newFile();var e=(0,n.a2)().initLayerList,t=(0,n.y)().initColorIndexList,r=(0,n.ag)().initLineTypeList;e(),t(),r()}),(0,n.d)("Mx_NewFile_Template",function(){n.M.getCurrentMxCAD().openWebFile("empty_template.mxweb")}),(0,n.d)("MxPE_DrawMText_old",(0,n._)(n.a.mark(function e(){var t,r,a,i,s,u,c,o,d,f;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new n.j).setMessage((0,n.t)("1545")),e.next=1,t.go();case 1:if(r=e.sent){e.next=2;break}return e.abrupt("return");case 2:return a=(0,l.u)(),i=a.open,e.next=3,i();case 3:if("boolean"!=typeof(s=e.sent)){e.next=4;break}return e.abrupt("return");case 4:return u=s.text,c=s.size,(o=new n.ah).contents=u||"",c&&(o.textHeight=c),o.location=r,d=n.M.getCurrentMxCAD(),f=d.drawEntity(o),d.updateDisplay(),e.abrupt("return",f);case 5:case"end":return e.stop()}},e)})))}}]);