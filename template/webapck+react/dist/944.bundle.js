"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[944],{5582:function(e,t,a){a.d(t,{s:function(){return r},u:function(){return o}});var n=a(8741),o=function(){return{dialog:n.dy}},r=function(e){return n.dy&&n.dy.showDialog(!0,e,200)}},9944:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var n=a(8741),o=a(5582),r={class:"mt-2"},u={style:{width:"90px"}},l={class:"text-center"},i={class:"text-left"},c={style:{height:"26px"}},s={style:{width:"90px"}},d={class:"d-flex justify-center"},f={key:0,class:"border_box"},p={style:{width:"auto"}},h={style:{height:"3px"}};const m=(0,n.at)({__name:"index",setup:function(e){var t=(0,o.u)().dialog,a=(0,n.aq)([]),m=function(e){return 0===e?"class:iconfont gou":1===e?"class:iconfont cha":void 0},v=function(e){return 0===e?"#33CD2A":1===e?"#ff0000":void 0};t.onReveal(function(e){var t=[];e.externalReference.forEach(function(a){t.push({name:a,uploadState:3,progress:0,type:"ref",hash:e.hash})}),e.images.forEach(function(a){t.push({name:a,uploadState:3,progress:0,hash:e.hash,type:"img"})}),a.value=t});var g=(0,n.ar)(function(){return a.value.some(function(e){return 2===e.uploadState})}),w=[{name:"选择文件",fun:function(){var e=((0,n.ae)()||{}).baseUrl,t=void 0===e?"":e;"http://localhost"==t.substring(0,16)&&(t=(0,n.af)()+t.substring(16));var o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("accept",".dwg,image/*"),o.style.display="none",o.setAttribute("multiple","multiple"),o.setAttribute("capture","camera"),document.body.appendChild(o),o.onchange=function(){if(o.files&&!(o.files.length<1)){var e=Array.from(o.files);a.value.filter(function(t){return e.some(function(e){if(e.name===t.name)return t.source=e,!0})}).forEach(function(){var e=(0,n._)(n.a.mark(function e(a){var r,u,l,i,c,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=a.type,u=a.name,l=a.source,i=a.hash,a.uploadState=2,e.next=5;break;case 2:a.uploadState=0,e.next=4;break;case 3:e.prev=3,s=e.catch(1),a.uploadState=1,console.warn(s);case 4:e.next=6;break;case 5:c=new FormData,l&&c.append("file",l),c.append("src_dwgfile_hash",i),c.append("ext_ref_file",u),(0,n.ap)({url:t+("img"===r?"/mxcad/up_ext_reference_image":"/mxcad/up_ext_reference_dwg"),method:"post",headers:{"Content-Type":"multipart/form-data"},data:c,onUploadProgress:function(e){e.total&&(a.progress=e.loaded/e.total*100,console.log(a.progress))}}).then(function(e){0===e.data.code?(a.uploadState=0,o.remove()):(a.uploadState=1,o.remove())},function(){a.uploadState=1,o.remove()});case 6:case"end":return e.stop()}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}())}},setTimeout(function(){o.click()},100)},disabled:function(){return a.value.every(function(e){return 0===e.uploadState})}},{name:"取消",fun:function(){t.cancel(!1),t.showDialog(!1)}},{name:"继续打开文件",fun:function(){t.confirm(!0),t.showDialog(!1)}}];return function(e,o){return(0,n.aw)(),(0,n.ax)(n.aY,{title:e.t("2083"),width:"450",modelValue:(0,n.ay)(t).isShow.value,"onUpdate:modelValue":o[0]||(o[0]=function(e){return(0,n.ay)(t).isShow.value=e}),footerBtnList:w},{default:(0,n.aG)(function(){return[(0,n.aB)("div",r,[(0,n.aC)(n.ct,{height:"150",class:"mb-2",style:{overflow:"hidden"},hover:!1},{default:(0,n.aG)(function(){return[(0,n.aB)("thead",null,[(0,n.aB)("tr",null,[(0,n.aB)("th",u,(0,n.aF)(e.t("2084")),1),(0,n.aB)("th",l,(0,n.aF)(e.t("2085")),1)])]),(0,n.aB)("tbody",i,[((0,n.aw)(!0),(0,n.aA)(n.bt,null,(0,n.bu)(a.value,function(e,t){return(0,n.aw)(),(0,n.aA)("tr",c,[(0,n.aB)("td",s,[(0,n.aB)("div",d,[2!==e.uploadState?((0,n.aw)(),(0,n.aA)("div",f,[(0,n.aC)(n.aH,{icon:m(e.uploadState),color:v(e.uploadState),size:"16"},null,8,["icon","color"])])):((0,n.aw)(),(0,n.ax)(n.by,{key:1,rotate:360,size:16,width:2,"model-value":e.progress,color:"teal",indeterminate:100===e.progress},null,8,["model-value","indeterminate"]))])]),(0,n.aB)("td",p,[(0,n.aC)(n.dA,{class:"text-left",width:285,text:e.name,"slice-num":10},null,8,["text"])])])}),256))])]}),_:1}),(0,n.aB)("div",h,[g.value?((0,n.aw)(),(0,n.ax)(n.dB,{key:0,indeterminate:"",color:"green"})):(0,n.aO)("",!0)])])]}),_:1},8,["title","modelValue"])}}}),v=(0,n.aQ)(m,[["__scopeId","data-v-53cee13a"]])}}]);