"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[944],{5582:function(e,t,n){n.d(t,{s:function(){return r},u:function(){return o}});var a=n(9091),o=function(){return{dialog:a.bH}},r=function(e){return a.bH&&a.bH.showDialog(!0,e,200)}},9944:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var a=n(9091),o=n(2898),r=n(5582),u=n(2164),l=n(624),i={class:"mt-2"},c={style:{width:"90px"}},s={class:"text-center"},d={class:"text-left"},f={style:{height:"26px"}},p={style:{width:"90px"}},h={class:"d-flex justify-center"},m={key:0,class:"border_box"},v={style:{width:"auto"}},g={style:{height:"3px"}};const w=(0,o.e)({__name:"index",setup:function(e){var t=(0,r.u)().dialog,n=(0,o.f)([]),w=function(e){return 0===e?"class:iconfont gou":1===e?"class:iconfont cha":void 0},b=function(e){return 0===e?"#33CD2A":1===e?"#ff0000":void 0};t.onReveal(function(e){var t=[];e.externalReference.forEach(function(n){t.push({name:n,uploadState:3,progress:0,type:"ref",hash:e.hash})}),e.images.forEach(function(n){t.push({name:n,uploadState:3,progress:0,hash:e.hash,type:"img"})}),n.value=t});var x=(0,o.g)(function(){return n.value.some(function(e){return 2===e.uploadState})}),y=[{name:"选择文件",fun:function(){var e=((0,a.D)()||{}).baseUrl,t=void 0===e?"":e;"http://localhost"==t.substring(0,16)&&(t=(0,a.E)()+t.substring(16));var o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("accept",".dwg,image/*"),o.style.display="none",o.setAttribute("multiple","multiple"),o.setAttribute("capture","camera"),document.body.appendChild(o),o.onchange=function(){if(o.files&&!(o.files.length<1)){var e=Array.from(o.files);n.value.filter(function(t){return e.some(function(e){if(e.name===t.name)return t.source=e,!0})}).forEach(function(){var e=(0,a._)(a.a.mark(function e(n){var r,u,i,c,s,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.type,u=n.name,i=n.source,c=n.hash,n.uploadState=2,e.next=5;break;case 2:n.uploadState=0,e.next=4;break;case 3:e.prev=3,d=e.catch(1),n.uploadState=1,console.warn(d);case 4:e.next=6;break;case 5:s=new FormData,i&&s.append("file",i),s.append("src_dwgfile_hash",c),s.append("ext_ref_file",u),(0,l.a)({url:t+("img"===r?"/mxcad/up_ext_reference_image":"/mxcad/up_ext_reference_dwg"),method:"post",headers:{"Content-Type":"multipart/form-data"},data:s,onUploadProgress:function(e){e.total&&(n.progress=e.loaded/e.total*100,console.log(n.progress))}}).then(function(e){0===e.data.code?(n.uploadState=0,o.remove()):(n.uploadState=1,o.remove())},function(){n.uploadState=1,o.remove()});case 6:case"end":return e.stop()}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}())}},setTimeout(function(){o.click()},100)},disabled:function(){return n.value.every(function(e){return 0===e.uploadState})}},{name:"取消",fun:function(){t.cancel(!1),t.showDialog(!1)}},{name:"继续打开文件",fun:function(){t.confirm(!0),t.showDialog(!1)}}];return function(e,r){return(0,o.o)(),(0,o.m)(a.U,{title:e.t("2083"),width:"450",modelValue:(0,o.E)(t).isShow.value,"onUpdate:modelValue":r[0]||(r[0]=function(e){return(0,o.E)(t).isShow.value=e}),footerBtnList:y},{default:(0,o.w)(function(){return[(0,o.l)("div",i,[(0,o.a)(u._,{height:"150",class:"mb-2",style:{overflow:"hidden"},hover:!1},{default:(0,o.w)(function(){return[(0,o.l)("thead",null,[(0,o.l)("tr",null,[(0,o.l)("th",c,(0,o.t)(e.t("2084")),1),(0,o.l)("th",s,(0,o.t)(e.t("2085")),1)])]),(0,o.l)("tbody",d,[((0,o.o)(!0),(0,o.c)(o.F,null,(0,o.d)(n.value,function(e,t){return(0,o.o)(),(0,o.c)("tr",f,[(0,o.l)("td",p,[(0,o.l)("div",h,[2!==e.uploadState?((0,o.o)(),(0,o.c)("div",m,[(0,o.a)(u.a,{icon:w(e.uploadState),color:b(e.uploadState),size:"16"},null,8,["icon","color"])])):((0,o.o)(),(0,o.m)(u.G,{key:1,rotate:360,size:16,width:2,"model-value":e.progress,color:"teal",indeterminate:100===e.progress},null,8,["model-value","indeterminate"]))])]),(0,o.l)("td",v,[(0,o.a)(a.bJ,{class:"text-left",width:285,text:e.name,"slice-num":10},null,8,["text"])])])}),256))])]}),_:1}),(0,o.l)("div",g,[x.value?((0,o.o)(),(0,o.m)(u.x,{key:0,indeterminate:"",color:"green"})):(0,o.s)("",!0)])])]}),_:1},8,["title","modelValue"])}}}),b=(0,a.O)(w,[["__scopeId","data-v-53cee13a"]])}}]);