"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[698],{698:function(e,n,t){t.r(n),t.d(n,{SingleLineFindReplaceDialog:function(){return V},cleanup:function(){return P},default:function(){return A},hideSingleLineFindReplaceDialog:function(){return W},showSingleLineFindReplaceDialog:function(){return T},useSingleLineFindReplace:function(){return s}});var l=t(9091),o=t(2898),a=(t(7663),t(8285)),r=t(9295),i=t(2164),u=t(9417);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,l=Array(n);t<n;t++)l[t]=e[t];return l}var s=function(e,n){var t=(0,o.f)(!1),i=(0,o.f)(""),u=(0,o.f)(""),s=(0,o.f)(!1),d=(0,o.f)({matchCase:!1,matchWholeWord:!1,useWildcards:!1,matchDiacritics:!1,matchHalfFullWidth:!1}),f=(0,o.f)({current:0,total:0}),p=(0,o.f)([]),v=(0,o.f)(-1),h=(0,o.g)(function(){return!i.value}),g=(0,o.g)(function(){return!i.value||0===f.value.total}),m=function(e){return e.replace(/[\uFF01-\uFF5E]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})},E=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")},w=function(n){e.selectionStart=n.index,e.selectionEnd=n.index+n.length,e.isSelecting=!0,e.cursorPosition=n.index+n.length,e.updateCursorPosition(),e.updateSelectionHighlight(),e.cursor.focus()},b=function(){i.value&&(C(),0!==p.value.length&&(-1===v.value||v.value>=p.value.length-1?v.value=0:v.value++,f.value.current=v.value+1,w(p.value[v.value])))},y=function(n){if(!i.value||0===n.length)return 0;var t=e.mText.textString,o=(0,l.w)(n).sort(function(e,n){return n.index-e.index});e.saveToHistory();var r,s=t,d=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(e))||n){t&&(e=t);var l=0,o=function(){};return{s:o,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){i=!0,a=e},f:function(){try{r||null==t.return||t.return()}finally{if(i)throw a}}}}(o);try{for(d.s();!(r=d.n()).done;){var f=r.value;s=s.substring(0,f.index)+u.value+s.substring(f.index+f.length)}}catch(e){d.e(e)}finally{d.f()}return e.mText.textString=s,e.updateBox(),e.clearSelection(),v.value=-1,p.value=[],C(),a.M.getCurrentMxCAD().updateDisplay(),o.length},x=function(){v.value=-1,p.value=[],f.value={current:0,total:0},e.clearSelection()},C=(0,r.b)(function(){x(),i.value&&(p.value=function(){if(!i.value)return[];var n=[],t=e.mText.textString;if(!t)return[];var l=t,o=i.value;if(d.value.matchCase||(l=t.toLowerCase(),o=i.value.toLowerCase()),d.value.matchHalfFullWidth||(l=m(l),o=m(o)),d.value.matchDiacritics||(l=E(l),o=E(o)),d.value.useWildcards)return function(e,n){for(var t,l=[],o=n.replace(/\*/g,".*").replace(/\?/g,".").replace(/\./g,"\\."),a=new RegExp(o,"g");null!==(t=a.exec(e));)l.push({index:t.index,length:t[0].length}),t.index===a.lastIndex&&a.lastIndex++;return l}(l,o);for(var a,r=0;-1!==(a=l.indexOf(o,r));){if(d.value.matchWholeWord){var u=a>0?l[a-1]:null,c=a+o.length<l.length?l[a+o.length]:null,s=!u||!/\w/.test(u),f=!c||!/\w/.test(c);if(!s||!f){r=a+1;continue}}n.push({index:a,length:o.length}),r=a+1}return n}(),f.value.total=p.value.length,s.value=!0,p.value.length>0&&(v.value=0,f.value.current=1,w(p.value[0])))},300),S=function(){t.value=!1,e.clearSelection(),x(),null!=n&&n.onClose&&n.onClose()};return{isShow:t,findText:i,replaceText:u,optionsRef:d,resultStats:f,hasSearched:s,disableFind:h,disableReplace:g,findNext:b,findPrevious:function(){i.value&&(C(),0!==p.value.length&&(-1===v.value||v.value<=0?v.value=p.value.length-1:v.value--,f.value.current=v.value+1,w(p.value[v.value])))},replaceCurrent:function(){if(-1!==v.value&&0!==p.value.length){var e=p.value[v.value];y([e]),p.value.length>0&&b()}},replaceAll:function(){if(0!==p.value.length){var e=y(p.value);e>0&&console.log((0,l.t)("已替换 ".concat(e," 处文本")))}},refreshSearch:C,showDialog:function(){arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?S():function(){if(e.hasSelection()){var n=e.getSelectedText();n&&(i.value=n)}t.value=!0,setTimeout(function(){C()},100)}()},closeDialog:S}},d={class:"find-replace-header",id:"single_line_text_find_replace_dialog_header"},f={class:"dialog-title"},p={class:"find-replace-content"},v={class:"input-row find-row"},h={class:"label"},g={class:"input-row replace-row"},m={class:"label"},E={class:"options-area"},w={class:"option-row"},b={class:"option-row"},y={class:"option-row"},x={class:"option-row"},C={class:"option-row"},S={class:"right-buttons"},_={key:0,class:"search-stats mt-2"},k={key:1,class:"search-stats mt-2 error-text"};const D=(0,o.e)({__name:"index",props:{editor:{},onClose:{type:Function}},setup:function(e,n){var t=n.expose,a=e,r=s(a.editor,{onClose:a.onClose}),u=r.isShow,c=r.findText,D=r.replaceText,V=r.optionsRef,O=r.resultStats,R=r.hasSearched,j=r.disableFind,F=r.disableReplace,T=r.findNext,W=r.findPrevious,P=r.replaceCurrent,A=r.replaceAll,I=r.showDialog,L=r.closeDialog,U=r.refreshSearch,N=(0,o.f)(null),H=(0,o.f)(null),q=function(e){"Escape"===e.key?L():"Enter"===e.key&&e.ctrlKey&&T()},z=(0,o.f)(0),K=(0,o.f)(0),M=function(){setTimeout(function(){H.value&&H.value.focus()})};return(0,o.i)([c,function(){return V.value}],function(){U(),M()},{deep:!0}),(0,o.i)(u,function(e){e?(document.addEventListener("keydown",q),M()):document.removeEventListener("keydown",q)}),t({showDialog:I}),function(e,n){var t=(0,o.a6)("draggable");return(0,o.o)(),(0,o.m)(o.T,{to:"body"},[(0,o.E)(u)?(0,o.z)(((0,o.o)(),(0,o.c)("div",{key:0,ref_key:"dialogRef",ref:N,class:"find-replace-dialog",onKeydown:n[7]||(n[7]=(0,o.ad)(function(){return(0,o.E)(L)&&(0,o.E)(L).apply(void 0,arguments)},["esc"]))},[(0,o.l)("div",d,[(0,o.l)("div",f,[(0,o.a)(i.h,{src:(0,o.E)(l.N)(),alt:"logo",width:"24",height:"24",class:"mr-2"},null,8,["src"]),(0,o.l)("span",null,(0,o.t)((0,o.E)(l.t)("1823")),1)]),(0,o.a)(i.V,{icon:"",size:"x-small",variant:"text",onClick:(0,o.E)(L),class:"close-btn"},{default:(0,o.w)(function(){return[(0,o.a)(i.a,{icon:"cha",size:"small"})]}),_:1},8,["onClick"])]),(0,o.l)("div",p,[(0,o.l)("div",v,[(0,o.a)((0,o.E)(i.i),{modelValue:(0,o.E)(c),"onUpdate:modelValue":n[0]||(n[0]=function(e){return(0,o.R)(c)?c.value=e:null}),onKeyup:(0,o.ad)((0,o.E)(T),["enter"]),ref_key:"findInputRef",ref:H},{prepend:(0,o.w)(function(){return[(0,o.l)("label",h,(0,o.t)((0,o.E)(l.t)("2167"))+":",1)]}),append:(0,o.w)(function(){return[(0,o.a)(i.V,{onClick:(0,o.E)(T),width:"80",height:"21",disabled:(0,o.E)(j)},{default:(0,o.w)(function(){return[(0,o.q)((0,o.t)((0,o.E)(l.t)("2168")),1)]}),_:1},8,["onClick","disabled"])]}),_:1},8,["modelValue","onKeyup"])]),(0,o.l)("div",g,[(0,o.a)((0,o.E)(i.i),{modelValue:(0,o.E)(D),"onUpdate:modelValue":n[1]||(n[1]=function(e){return(0,o.R)(D)?D.value=e:null})},{prepend:(0,o.w)(function(){return[(0,o.l)("label",m,(0,o.t)((0,o.E)(l.t)("2169"))+":",1)]}),append:(0,o.w)(function(){return[(0,o.a)(i.V,{onClick:(0,o.E)(P),width:"80",height:"21",disabled:(0,o.E)(F)},{default:(0,o.w)(function(){return[(0,o.q)((0,o.t)((0,o.E)(l.t)("2170")),1)]}),_:1},8,["onClick","disabled"])]}),_:1},8,["modelValue"])]),(0,o.l)("div",E,[(0,o.l)("div",w,[(0,o.a)(i.j,{modelValue:(0,o.E)(V).matchCase,"onUpdate:modelValue":n[2]||(n[2]=function(e){return(0,o.E)(V).matchCase=e}),label:(0,o.E)(l.t)("2171")},null,8,["modelValue","label"])]),(0,o.l)("div",b,[(0,o.a)(i.j,{modelValue:(0,o.E)(V).matchWholeWord,"onUpdate:modelValue":n[3]||(n[3]=function(e){return(0,o.E)(V).matchWholeWord=e}),label:(0,o.E)(l.t)("2172")},null,8,["modelValue","label"])]),(0,o.l)("div",y,[(0,o.a)(i.j,{modelValue:(0,o.E)(V).useWildcards,"onUpdate:modelValue":n[4]||(n[4]=function(e){return(0,o.E)(V).useWildcards=e}),label:(0,o.E)(l.t)("2173")},null,8,["modelValue","label"])]),(0,o.l)("div",x,[(0,o.a)(i.j,{modelValue:(0,o.E)(V).matchDiacritics,"onUpdate:modelValue":n[5]||(n[5]=function(e){return(0,o.E)(V).matchDiacritics=e}),label:(0,o.E)(l.t)("2174")},null,8,["modelValue","label"])]),(0,o.l)("div",C,[(0,o.a)(i.j,{modelValue:(0,o.E)(V).matchHalfFullWidth,"onUpdate:modelValue":n[6]||(n[6]=function(e){return(0,o.E)(V).matchHalfFullWidth=e}),label:(0,o.E)(l.t)("2175")},null,8,["modelValue","label"])])]),(0,o.l)("div",S,[(0,o.a)(i.V,{onClick:(0,o.E)(W),width:"80",height:"21",disabled:(0,o.E)(j),class:"mb-2"},{default:(0,o.w)(function(){return[(0,o.q)((0,o.t)((0,o.E)(l.t)("184")),1)]}),_:1},8,["onClick","disabled"]),(0,o.a)(i.V,{onClick:(0,o.E)(A),width:"80",height:"21",disabled:(0,o.E)(F)},{default:(0,o.w)(function(){return[(0,o.q)((0,o.t)((0,o.E)(l.t)("2176")),1)]}),_:1},8,["onClick","disabled"]),(0,o.E)(O).total>0?((0,o.o)(),(0,o.c)("div",_,(0,o.t)((0,o.E)(O).current)+" / "+(0,o.t)((0,o.E)(O).total),1)):(0,o.E)(c)&&(0,o.E)(R)?((0,o.o)(),(0,o.c)("div",k,(0,o.t)((0,o.E)(l.t)("2177")),1)):(0,o.s)("",!0)])])],32)),[[t,{downEl:"#single_line_text_find_replace_dialog_header",x:z.value,y:K.value}]]):(0,o.s)("",!0)])}}}),V=(0,l.O)(D,[["__scopeId","data-v-7c747613"]]);function O(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,l)}return t}var R,j,F=!1,T=function(e){try{if(F&&R&&R.component){var n=R.component;return void(n&&n.exposed&&n.exposed.showDialog(!0))}W();var t=function(){try{return(0,l.P)()||null}catch(e){return console.error("获取应用实例失败:",e),null}}();j||(j=document.createElement("div"),document.body.appendChild(j)),R=(0,o.a)(V,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?O(Object(t),!0).forEach(function(n){(0,u._)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},e)),t&&t._context&&(R.appContext=t._context),j&&((0,o.C)(R,j),F=!0,setTimeout(function(){if(R&&R.component){var e=R.component;e&&e.exposed&&e.exposed.showDialog(!0)}},0))}catch(e){console.error("显示单行文本查找替换对话框时出错:",e)}},W=function(){try{if(R&&R.component){var e=R.component;e&&e.exposed&&e.exposed.showDialog(!1),e.props&&"function"==typeof e.props.onClose&&e.props.onClose(),setTimeout(function(){j&&((0,o.C)(null,j),F=!1)},300)}}catch(e){if(console.error("隐藏单行文本查找替换对话框时出错:",e),j){try{(0,o.C)(null,j)}catch(e){}F=!1}}},P=function(){try{j&&(R&&R.component&&(R.component.exposed&&R.component.exposed.showDialog(!1),R.component.props&&"function"==typeof R.component.props.onClose&&R.component.props.onClose()),(0,o.C)(null,j),j.parentNode&&j.parentNode.removeChild(j),j=void 0,R=void 0,F=!1)}catch(e){console.error("清理单行文本查找替换对话框资源时出错:",e)}};const A={SingleLineFindReplaceDialog:V,useSingleLineFindReplace:s,create:function(e){return s(e)},show:T,hide:W,cleanup:P}},7663:function(e,n,t){var l=t(9091),o=l.ae.f,a=l.ah,r=l.ai,i=l.aj,u=l.ak,c=l.as,s=l.at,d=l.ay,f=l.af.f,p=l.au,v=l.av,h=l.aw,g=l.ax,m=l.al,E=function(e,n,t){t in e||o(e,t,{configurable:!0,get:function(){return n[t]},set:function(e){n[t]=e}})},w=l.am,b=l.an,y=l.az,x=l.ag.enforce,C=l.ao,S=l.ap,_=l.aq,k=l.ar,D=S("match"),V=r.RegExp,O=V.prototype,R=r.SyntaxError,j=i(O.exec),F=i("".charAt),T=i("".replace),W=i("".indexOf),P=i("".slice),A=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,I=/a/g,L=/a/g,U=new V(I)!==I,N=m.MISSED_STICKY,H=m.UNSUPPORTED_Y;if(u("RegExp",a&&(!U||N||_||k||b(function(){return L[D]=!1,V(I)!==I||V(L)===L||"/a/i"!==String(V(I,"i"))})))){for(var q=function(e,n){var t,l,o,a,r,i,u=p(O,this),f=v(e),m=void 0===n,E=[],w=e;if(!u&&f&&m&&e.constructor===q)return e;if((f||p(O,e))&&(e=e.source,m&&(n=g(w))),e=void 0===e?"":h(e),n=void 0===n?"":h(n),w=e,_&&"dotAll"in I&&(l=!!n&&W(n,"s")>-1)&&(n=T(n,/s/g,"")),t=n,N&&"sticky"in I&&(o=!!n&&W(n,"y")>-1)&&H&&(n=T(n,/y/g,"")),k&&(a=function(e){for(var n,t=e.length,l=0,o="",a=[],r=d(null),i=!1,u=!1,c=0,s="";l<=t;l++){if("\\"===(n=F(e,l)))n+=F(e,++l);else if("]"===n)i=!1;else if(!i)switch(!0){case"["===n:i=!0;break;case"("===n:j(A,P(e,l+1))&&(l+=2,u=!0),o+=n,c++;continue;case">"===n&&u:if(""===s||y(r,s))throw new R("Invalid capture group name");r[s]=!0,a[a.length]=[s,c],u=!1,s="";continue}u?s+=n:o+=n}return[o,a]}(e),e=a[0],E=a[1]),r=c(V(e,n),u?this:O,q),(l||o||E.length)&&(i=x(r),l&&(i.dotAll=!0,i.raw=q(function(e){for(var n,t=e.length,l=0,o="",a=!1;l<=t;l++)"\\"!==(n=F(e,l))?a||"."!==n?("["===n?a=!0:"]"===n&&(a=!1),o+=n):o+="[\\s\\S]":o+=n+F(e,++l);return o}(e),t)),o&&(i.sticky=!0),E.length&&(i.groups=E)),e!==w)try{s(r,"source",""===w?"(?:)":w)}catch(e){}return r},z=f(V),K=0;z.length>K;)E(q,V,z[K++]);O.constructor=q,q.prototype=O,w(r,"RegExp",q,{constructor:!0})}C("RegExp")}}]);