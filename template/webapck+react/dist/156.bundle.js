"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[156],{6156:function(e,a,n){n.r(a),n.d(a,{default:function(){return i}});var t=n(8741),r={class:"d-flex flex-column"},u={class:"d-flex align-center justify-space-between mt-1"},l={for:"exportTableInputId",class:"d-flex align-center"},o={class:"d-flex justify-space-between mt-1"},s={class:"mt-1"},c={class:"d-flex align-center mt-1"};const i=(0,t.at)({__name:"index",setup:function(e){var a=t.dS.isShow,n=t.dS.showDialog,i=(0,t.aq)(4),d=(0,t.aq)(4),p=(0,t.aq)(50),f=(0,t.aq)(20),m=(0,t.aq)(""),v=(0,t.aq)(!1),y=function(){var e=(0,t._)(t.a.mark(function e(){var a,n;return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{(a=new t.dT).colWidth=p.value,a.rowHeight=f.value,n=x(d.value+(v.value?1:0),i.value),v.value&&m.value&&(n[0][0]=m.value,a.setMergeCells([{row:0,col:0,rowspan:1,colspan:i.value}])),a.setFromArray(n),requestAnimationFrame((0,t._)(t.a.mark(function e(){return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,b(a);case 1:case"end":return e.stop()}},e)})))}catch(e){console.error("创建表格失败:",e)}case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),w=function(){var e=(0,t._)(t.a.mark(function e(a){var r,u,l,o,s,c;return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=a.target).files&&0!==r.files.length){e.next=1;break}return e.abrupt("return");case 1:return u=r.files[0],e.prev=2,e.next=3,h(u);case 3:return l=e.sent,e.next=4,t.dU.readFromArrayBuffer(l);case 4:o=e.sent,(s=new t.dT).setFromWorkbook(o),n(!1),requestAnimationFrame((0,t._)(t.a.mark(function e(){return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,b(s);case 1:case"end":return e.stop()}},e)}))),e.next=6;break;case 5:e.prev=5,c=e.catch(2),console.error("导入表格失败:",c);case 6:return e.prev=6,r.value="",e.finish(6);case 7:case"end":return e.stop()}},e,null,[[2,5,6,7]])}));return function(a){return e.apply(this,arguments)}}(),x=function(e,a){for(var n=[],t=0;t<e;t++){for(var r=[],u=0;u<a;u++)r.push("");n.push(r)}return n},h=function(e){return new Promise(function(a,n){var t=new FileReader;t.onload=function(){return a(t.result)},t.onerror=n,t.readAsArrayBuffer(e)})},b=function(){var e=(0,t._)(t.a.mark(function e(a){var n,r,u,l;return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.M.getCurrentMxCAD(),(r=new t.j).setMessage("\n"+(0,t.t)("3858")),r.setUserDraw(function(e,n){var t=a.clone();t.position=e,n.drawMcDbEntity(t)}),e.next=1,r.go();case 1:if(u=e.sent){e.next=2;break}return e.abrupt("return");case 2:a.position=u,a.styleName=t.dV.currentName,n.drawEntity(a),n.updateDisplay(),console.log("表格插入成功!"),e.next=4;break;case 3:e.prev=3,l=e.catch(0),console.error("插入表格失败:",l);case 4:case"end":return e.stop()}},e,null,[[0,3]])}));return function(a){return e.apply(this,arguments)}}();return function(e,x){return(0,t.aw)(),(0,t.ax)(t.aY,{title:(0,t.ay)(t.t)("228"),"max-width":"500",modelValue:(0,t.ay)(a),"onUpdate:modelValue":x[6]||(x[6]=function(e){return(0,t.aK)(a)?a.value=e:null}),footerBtnList:[{name:(0,t.ay)(t.t)("1829"),fun:(h=(0,t._)(t.a.mark(function e(){return t.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,y();case 1:(0,t.ay)(n)(!1);case 2:case"end":return e.stop()}},e)})),function(){return h.apply(this,arguments)}),primary:!0},{name:(0,t.ay)(t.t)("2006"),fun:function(){return(0,t.ay)(n)(!1)}}]},{default:(0,t.aG)(function(){return[(0,t.aB)("div",r,[(0,t.aB)("div",u,[(0,t.aB)("label",l,[(0,t.aB)("div",null,(0,t.aF)((0,t.ay)(t.t)("2111"))+":",1),(0,t.aB)("input",{id:"exportTableInputId",class:"mb-1",accept:".xls,.xlsx,.xlsm,.csv,.xlsb",type:"file",onChange:w},null,32)])]),(0,t.aB)("div",o,[(0,t.aB)("div",null,[(0,t.aC)(t.aM,{modelValue:d.value,"onUpdate:modelValue":x[0]||(x[0]=function(e){return d.value=e}),type:"number",class:"pa-0"},{prepend:(0,t.aG)(function(){return[(0,t.aJ)((0,t.aF)((0,t.ay)(t.t)("2112"))+":",1)]}),_:1},8,["modelValue"]),(0,t.aC)(t.aM,{modelValue:i.value,"onUpdate:modelValue":x[1]||(x[1]=function(e){return i.value=e}),type:"number",class:"pa-0 mt-1"},{prepend:(0,t.aG)(function(){return[(0,t.aJ)((0,t.aF)((0,t.ay)(t.t)("2113"))+":",1)]}),_:1},8,["modelValue"])]),(0,t.aB)("div",s,[(0,t.aC)(t.aM,{modelValue:f.value,"onUpdate:modelValue":x[2]||(x[2]=function(e){return f.value=e}),type:"number",class:"pa-0",density:"compact","hide-details":""},{prepend:(0,t.aG)(function(){return[(0,t.aJ)((0,t.aF)((0,t.ay)(t.t)("2114"))+":",1)]}),_:1},8,["modelValue"]),(0,t.aC)(t.aM,{modelValue:p.value,"onUpdate:modelValue":x[3]||(x[3]=function(e){return p.value=e}),type:"number",class:"pa-0 mt-1",density:"compact","hide-details":""},{prepend:(0,t.aG)(function(){return[(0,t.aJ)((0,t.aF)((0,t.ay)(t.t)("2115"))+":",1)]}),_:1},8,["modelValue"])])]),(0,t.aB)("div",c,[(0,t.aC)(t.aN,{modelValue:v.value,"onUpdate:modelValue":x[4]||(x[4]=function(e){return v.value=e}),"hide-details":"",class:"ma-0 pa-0"},{label:(0,t.aG)(function(){return[(0,t.aB)("span",null,(0,t.aF)((0,t.ay)(t.t)("2116"))+":",1)]}),_:1},8,["modelValue"]),(0,t.aC)(t.aM,{modelValue:m.value,"onUpdate:modelValue":x[5]||(x[5]=function(e){return m.value=e}),class:"ml-2",disabled:!v.value,"hide-details":"",density:"compact"},null,8,["modelValue","disabled"])])])]}),_:1},8,["title","modelValue","footerBtnList"]);var h}}})}}]);