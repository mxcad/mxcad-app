"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[156],{6156:function(e,n,t){t.r(n),t.d(n,{default:function(){return d}});var r=t(9091),a=t(2898),u=t(8285),l=t(2164),o={class:"d-flex flex-column"},s={class:"d-flex align-center justify-space-between mt-1"},c={for:"exportTableInputId",class:"d-flex align-center"},i={class:"d-flex justify-space-between mt-1"},p={class:"mt-1"},f={class:"d-flex align-center mt-1"};const d=(0,a.e)({__name:"index",setup:function(e){var n=r.bW.isShow,t=r.bW.showDialog,d=(0,a.f)(4),m=(0,a.f)(4),v=(0,a.f)(50),w=(0,a.f)(20),x=(0,a.f)(""),b=(0,a.f)(!1),h=function(){var e=(0,r._)(r.a.mark(function e(){var n,t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{(n=new u.P).colWidth=v.value,n.rowHeight=w.value,t=V(m.value+(b.value?1:0),d.value),b.value&&x.value&&(t[0][0]=x.value,n.setMergeCells([{row:0,col:0,rowspan:1,colspan:d.value}])),n.setFromArray(t),requestAnimationFrame((0,r._)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,_(n);case 1:case"end":return e.stop()}},e)})))}catch(e){console.error("创建表格失败:",e)}case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,r._)(r.a.mark(function e(n){var a,l,o,s,c,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=n.target).files&&0!==a.files.length){e.next=1;break}return e.abrupt("return");case 1:return l=a.files[0],e.prev=2,e.next=3,k(l);case 3:return o=e.sent,e.next=4,r.bX.readFromArrayBuffer(o);case 4:s=e.sent,(c=new u.P).setFromWorkbook(s),t(!1),requestAnimationFrame((0,r._)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,_(c);case 1:case"end":return e.stop()}},e)}))),e.next=6;break;case 5:e.prev=5,i=e.catch(2),console.error("导入表格失败:",i);case 6:return e.prev=6,a.value="",e.finish(6);case 7:case"end":return e.stop()}},e,null,[[2,5,6,7]])}));return function(n){return e.apply(this,arguments)}}(),V=function(e,n){for(var t=[],r=0;r<e;r++){for(var a=[],u=0;u<n;u++)a.push("");t.push(a)}return t},k=function(e){return new Promise(function(n,t){var r=new FileReader;r.onload=function(){return n(r.result)},r.onerror=t,r.readAsArrayBuffer(e)})},_=function(){var e=(0,r._)(r.a.mark(function e(n){var t,a,l,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=u.M.getCurrentMxCAD(),(a=new u.i).setMessage("\n"+(0,r.t)("3858")),a.setUserDraw(function(e,t){var r=n.clone();r.position=e,t.drawMcDbEntity(r)}),e.next=1,a.go();case 1:if(l=e.sent){e.next=2;break}return e.abrupt("return");case 2:n.position=l,n.styleName=r.bY.currentName,t.drawEntity(n),t.updateDisplay(),console.log("表格插入成功!"),e.next=4;break;case 3:e.prev=3,o=e.catch(0),console.error("插入表格失败:",o);case 4:case"end":return e.stop()}},e,null,[[0,3]])}));return function(n){return e.apply(this,arguments)}}();return function(e,u){return(0,a.o)(),(0,a.m)(r.U,{title:(0,a.E)(r.t)("228"),"max-width":"500",modelValue:(0,a.E)(n),"onUpdate:modelValue":u[6]||(u[6]=function(e){return(0,a.R)(n)?n.value=e:null}),footerBtnList:[{name:(0,a.E)(r.t)("1829"),fun:(V=(0,r._)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,h();case 1:(0,a.E)(t)(!1);case 2:case"end":return e.stop()}},e)})),function(){return V.apply(this,arguments)}),primary:!0},{name:(0,a.E)(r.t)("2006"),fun:function(){return(0,a.E)(t)(!1)}}]},{default:(0,a.w)(function(){return[(0,a.l)("div",o,[(0,a.l)("div",s,[(0,a.l)("label",c,[(0,a.l)("div",null,(0,a.t)((0,a.E)(r.t)("2111"))+":",1),(0,a.l)("input",{id:"exportTableInputId",class:"mb-1",accept:".xls,.xlsx,.xlsm,.csv,.xlsb",type:"file",onChange:y},null,32)])]),(0,a.l)("div",i,[(0,a.l)("div",null,[(0,a.a)(l.i,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=function(e){return m.value=e}),type:"number",class:"pa-0"},{prepend:(0,a.w)(function(){return[(0,a.q)((0,a.t)((0,a.E)(r.t)("2112"))+":",1)]}),_:1},8,["modelValue"]),(0,a.a)(l.i,{modelValue:d.value,"onUpdate:modelValue":u[1]||(u[1]=function(e){return d.value=e}),type:"number",class:"pa-0 mt-1"},{prepend:(0,a.w)(function(){return[(0,a.q)((0,a.t)((0,a.E)(r.t)("2113"))+":",1)]}),_:1},8,["modelValue"])]),(0,a.l)("div",p,[(0,a.a)(l.i,{modelValue:w.value,"onUpdate:modelValue":u[2]||(u[2]=function(e){return w.value=e}),type:"number",class:"pa-0",density:"compact","hide-details":""},{prepend:(0,a.w)(function(){return[(0,a.q)((0,a.t)((0,a.E)(r.t)("2114"))+":",1)]}),_:1},8,["modelValue"]),(0,a.a)(l.i,{modelValue:v.value,"onUpdate:modelValue":u[3]||(u[3]=function(e){return v.value=e}),type:"number",class:"pa-0 mt-1",density:"compact","hide-details":""},{prepend:(0,a.w)(function(){return[(0,a.q)((0,a.t)((0,a.E)(r.t)("2115"))+":",1)]}),_:1},8,["modelValue"])])]),(0,a.l)("div",f,[(0,a.a)(l.j,{modelValue:b.value,"onUpdate:modelValue":u[4]||(u[4]=function(e){return b.value=e}),"hide-details":"",class:"ma-0 pa-0"},{label:(0,a.w)(function(){return[(0,a.l)("span",null,(0,a.t)((0,a.E)(r.t)("2116"))+":",1)]}),_:1},8,["modelValue"]),(0,a.a)(l.i,{modelValue:x.value,"onUpdate:modelValue":u[5]||(u[5]=function(e){return x.value=e}),class:"ml-2",disabled:!b.value,"hide-details":"",density:"compact"},null,8,["modelValue","disabled"])])])]}),_:1},8,["title","modelValue","footerBtnList"]);var V}}})}}]);