"use strict";(self.webpackChunkwebapck_react=self.webpackChunkwebapck_react||[]).push([[594],{3594:function(t,a,e){e.r(a),e.d(a,{default:function(){return V}});var n=e(8741),r=e(8159);function u(t){var a=[],e=null;return t.split("\n").forEach(function(t){if(""!==t.trim())if(t.startsWith("*")){e&&(e.value+=")",a.push(e));var r=t.substring(1).split(",").map(function(t){return t.trim()});e={id:r[0],name:r[1],value:"(",imgPath:new URL("imgs/".concat(r[0],".png"),(0,n.d0)()).href}}else{if(!e)return void console.error("Invalid pattern file format. Missing pattern start marker (*)");var u=t.trim().split(",").map(function(t){return t.startsWith(".")?"0"+t:t}).join(),l=("("===e.value?"(":" (")+u+")";e.value+=l}}),e&&a.push(e),a}var l=function(t){return t.ANSI="ANSI",t.ISO="ISO",t.ANY="ANY",t}(l||{}),i=(0,n.L)((0,n.L)((0,n.L)({},"ANSI",new URL("fonts/mx.pat",(0,n.d0)()).href),"ISO",new URL("fonts/mxiso.pat",(0,n.d0)()).href),"ANY",new URL("fonts/mxuser.pat",(0,n.d0)()).href),o=(0,n.aq)(),c=(0,n.aq)(0),s={};Object.keys(i).forEach(function(){var t=(0,n._)(n.a.mark(function t(a){var e,r,l,c;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=i[a],t.next=1,fetch(e);case 1:return r=t.sent,t.next=2,r.blob();case 2:return l=t.sent,t.next=3,(0,n.c$)(l);case 3:c=t.sent,s[a]=u(c),o.value||d(a);case 4:case"end":return t.stop()}},t)}));return function(a){return t.apply(this,arguments)}}());var f=(0,n.aq)(""),d=function(t){f.value=i[t],o.value=s[t];var a=0;v.value&&(a=o.value.indexOf(v.value)),v.value=o.value[a]},v=(0,n.aq)(),p=function(t){if(o.value){var a=o.value.indexOf(t);a>=0&&(c.value=a)}v.value=t},m={class:"px-3"},h={class:"d-flex algin-center mt-3"},b={class:"mt-2"},C={class:"fill_box"},_=["onClick"],y={class:"d-inline-block text-truncate"};const w=(0,n.at)({__name:"FillSelectDialog",emits:["change"],setup:function(t,a){var e=a.expose,r=a.emit,i=(0,n.ci)(!1),s=i.isShow,v=i.showDialog,p=(0,n.aq)(),w=function(){p.value&&p.value.click()},x=function(){var t=(0,n._)(n.a.mark(function t(a){var e,r,l,i,c;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.target,r=e.files){t.next=1;break}return t.abrupt("return");case 1:return l=r[0],t.next=2,(0,n.d1)(l);case 2:if(i=t.sent,"object"===(0,n.a1)(i)){t.next=3;break}return t.abrupt("return");case 3:return e.value="",t.next=4,(0,n.c$)(i);case 4:c=t.sent,o.value=u(c);case 5:case"end":return t.stop()}},t)}));return function(a){return t.apply(this,arguments)}}(),g=r,k=function(){if(o.value){var t=o.value[c.value];g("change",t)}v(!1)},G=[{name:"确定",fun:k,primary:!0},{name:"关闭",fun:function(){return v(!1)}}];return e({showDialog:v}),function(t,a){return(0,n.aw)(),(0,n.ax)(n.aY,{title:t.t("2040"),"max-width":"400",modelValue:(0,n.ay)(s),"onUpdate:modelValue":a[4]||(a[4]=function(t){return(0,n.aK)(s)?s.value=t:null}),footerBtnList:G},{default:(0,n.aG)(function(){return[(0,n.aB)("div",m,[(0,n.aB)("div",h,[(0,n.az)((0,n.aB)("input",{class:"form__inset w-100",disabled:!0,"onUpdate:modelValue":a[0]||(a[0]=function(t){return(0,n.aK)(f)?f.value=t:null})},null,512),[[n.cu,(0,n.ay)(f)]]),(0,n.aC)(n.bd,{onClick:w,class:"ml-1"},{default:(0,n.aG)(function(){return[(0,n.aJ)((0,n.aF)(t.t("219"))+"(F)...",1)]}),_:1})]),(0,n.aB)("input",{type:"file",ref_key:"fillFileSelect",ref:p,onChange:x,style:{display:"none"},accept:".pat"},null,544),(0,n.aB)("div",b,[(0,n.aC)(n.aI,{density:"compact",class:"mr-2",onClick:a[1]||(a[1]=function(t){return(0,n.ay)(d)((0,n.ay)(l).ANSI)})},{default:(0,n.aG)(function(){return a[5]||(a[5]=[(0,n.aJ)("ANSI")])}),_:1}),(0,n.aC)(n.aI,{density:"compact",class:"mr-2",onClick:a[2]||(a[2]=function(t){return(0,n.ay)(d)((0,n.ay)(l).ISO)})},{default:(0,n.aG)(function(){return a[6]||(a[6]=[(0,n.aJ)("ISO")])}),_:1}),(0,n.aC)(n.aI,{density:"compact",onClick:a[3]||(a[3]=function(t){return(0,n.ay)(d)((0,n.ay)(l).ANY)})},{default:(0,n.aG)(function(){return[(0,n.aJ)((0,n.aF)(t.t("2041")),1)]}),_:1})]),(0,n.aB)("div",C,[((0,n.aw)(!0),(0,n.aA)(n.bt,null,(0,n.bu)((0,n.ay)(o),function(t,a){return(0,n.aw)(),(0,n.ax)(n.bz,{text:t.id+" "+t.name,location:"bottom","open-delay":800},{activator:(0,n.aG)(function(e){var r=e.props;return[(0,n.aB)("div",(0,n.bA)({ref_for:!0},r,{class:["fill_pattern",(0,n.ay)(c)===a?"fill_pattern_active":""],onClick:function(t){return c.value=a},onDblclick:k}),[(0,n.aC)(n.aE,{src:t.imgPath||"",width:"32",height:"32"},null,8,["src"]),(0,n.aB)("span",y,(0,n.aF)(t.id),1)],16,_)]}),_:2},1032,["text"])}),256))])])]}),_:1},8,["title","modelValue"])}}}),x=(0,n.aQ)(w,[["__scopeId","data-v-0b03bfc9"]]);var g={class:"px-3"},k={class:"d-flex align-center"},G={class:"mr-2"};const V=(0,n.at)({__name:"index",setup:function(t){var a,e,u,l=n.di.isShow,i=n.di.showDialog,m=(0,n.aq)(),h={patContent:o,activeIndex:c,defaultPatContents:s,switchPath:d,filePath:f,item:v,onchange:p},b=h.patContent,C=h.onchange,_=h.item,y=(0,n.I)(0,"PatternFillingDialog_angle"),w=(0,n.I)(11,"PatternFillingDialog_proportion"),V=function(){var t=(0,n._)(n.a.mark(function t(){var r,u;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i(!1),(r=new n.j).clearLastInputPoint(),r.setMessage("\n"+(0,n.t)("指定填充区域内部一点")+":"),r.disableAllTrace(!0),r.setDisableOsnap(!0),t.next=1,r.go();case 1:(u=t.sent)&&(e=u,a="point"),i(!0);case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),I=function(){var t=(0,n._)(n.a.mark(function t(){var e,r,l;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i(!1),t.next=1,n.w.userSelect((0,n.t)("选择对象"));case 1:(e=t.sent)&&e.length>0&&(r=e[0],(l=r.getMcDbEntity())&&(u=l),a="object"),i(!0);case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),S=function(){var t=(0,n._)(n.a.mark(function t(){var l,o;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("point"!==a||!e){t.next=2;break}if(l=n.w.builderHatchFromPoint(e)){t.next=1;break}return r.M.acutPrintf((0,n.t)("没有找到闭合区域")+"\n"),(0,n.F)().error((0,n.t)("没有找到闭合区域")),t.abrupt("return");case 1:o=n.M.getCurrentMxCAD(),_.value&&(o.addPatternDefinition(_.value.id,_.value.value),o.drawPatternDefinition=_.value.id),l.patternAngle=y.value,o.drawHatch(l,10*w.value),i(!1),(0,n.b6)(),a=e=void 0;case 2:"object"===a&&u&&(u instanceof n.k&&new n.dj,u=a=void 0,i(!1));case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),F=function(){a=u=e=void 0,i(!1)},A=[{name:"确定",fun:S,primary:!0,disabled:function(){return void 0===a}},{name:"关闭",fun:F}],U={enter:function(){var t;"INPUT"!==(null===(t=document.activeElement)||void 0===t?void 0:t.tagName)&&S()},esc:F,k:V,b:I};return function(t,a){return(0,n.aw)(),(0,n.aA)(n.bt,null,[(0,n.aC)(n.aY,{title:t.t("2042"),"max-width":"360",modelValue:(0,n.ay)(l),"onUpdate:modelValue":a[4]||(a[4]=function(t){return(0,n.aK)(l)?l.value=t:null}),footerBtnList:A,keys:U},{default:(0,n.aG)(function(){return[(0,n.aB)("div",g,[(0,n.aC)(n.b1,{title:t.t("2043"),class:"mt-2"},{default:(0,n.aG)(function(){return[(0,n.aC)(n.aU,null,{default:(0,n.aG)(function(){return[(0,n.aC)(n.aV,{cols:"8"},{default:(0,n.aG)(function(){return[(0,n.aC)(n.b4,{items:(0,n.ay)(b),"item-title":"id",modelValue:(0,n.ay)(_),"onUpdate:modelValue":[a[0]||(a[0]=function(t){return(0,n.aK)(_)?_.value=t:null}),(0,n.ay)(C)],"return-object":""},{prepend:(0,n.aG)(function(){return[(0,n.aJ)((0,n.aF)(t.t("1624"))+": ",1)]}),_:1},8,["items","modelValue","onUpdate:modelValue"])]}),_:1}),(0,n.aC)(n.aV,{cols:"4"},{default:(0,n.aG)(function(){return[(0,n.aC)(n.bd,{style:{"min-width":"60px"},onClick:a[1]||(a[1]=function(t){return function(){var t;null===(t=m.value)||void 0===t||t.showDialog(!0)}()})},{default:(0,n.aG)(function(){return[(0,n.aC)(n.aH,{icon:"class:iconfont more"})]}),_:1})]}),_:1})]}),_:1}),(0,n.aC)(n.aU,null,{default:(0,n.aG)(function(){return[(0,n.aC)(n.aV,{cols:"8"},{default:(0,n.aG)(function(){var a;return[(0,n.aB)("div",k,[(0,n.aB)("span",G,(0,n.aF)(t.t("2044"))+":",1),(0,n.aC)(n.aE,{src:(null===(a=(0,n.ay)(_))||void 0===a?void 0:a.imgPath)||"",width:"32",height:"32",style:{flex:"unset"}},null,8,["src"])])]}),_:1}),(0,n.aC)(n.aV,{cols:"4"})]}),_:1})]}),_:1},8,["title"]),(0,n.aC)(n.b1,{title:t.t("2045"),class:"mt-2"},{default:(0,n.aG)(function(){return[(0,n.aC)(n.aU,null,{default:(0,n.aG)(function(){return[(0,n.aC)(n.aV,{cols:"6"},{default:(0,n.aG)(function(){return[(0,n.aC)(n.b0,{"key-name":"G",colon:""},{default:(0,n.aG)(function(){return[(0,n.aJ)((0,n.aF)(t.t("169")),1)]}),_:1}),(0,n.aC)(n.b9,{modelValue:(0,n.ay)(y),"onUpdate:modelValue":a[2]||(a[2]=function(t){return(0,n.aK)(y)?y.value=t:null}),items:[0,5,10,15,20,30,45,60,90,95,100,120,135,150]},null,8,["modelValue"])]}),_:1}),(0,n.aC)(n.aV,{cols:"6"},{default:(0,n.aG)(function(){return[(0,n.aC)(n.b0,{"key-name":"S",colon:""},{default:(0,n.aG)(function(){return[(0,n.aJ)((0,n.aF)(t.t("1686")),1)]}),_:1}),(0,n.aC)(n.b9,{modelValue:(0,n.ay)(w),"onUpdate:modelValue":a[3]||(a[3]=function(t){return(0,n.aK)(w)?w.value=t:null}),items:[.25,.5,.75,1,1.25,1.5,1.75,2,11]},null,8,["modelValue"])]}),_:1})]}),_:1})]}),_:1},8,["title"]),(0,n.aC)(n.b1,{title:t.t("2046"),class:"mt-2"},{default:(0,n.aG)(function(){return[(0,n.aB)("div",null,[(0,n.aC)(n.b2,{onClick:V}),(0,n.aC)(n.b0,{"key-name":"K"},{default:(0,n.aG)(function(){return[(0,n.aJ)((0,n.aF)(t.t("2047"))+": "+(0,n.aF)(t.t("1965")),1)]}),_:1})])]}),_:1},8,["title"])])]}),_:1},8,["title","modelValue"]),(0,n.aC)(x,{ref_key:"fillSelectDialog",ref:m,onChange:(0,n.ay)(C)},null,8,["onChange"])],64)}}})}}]);